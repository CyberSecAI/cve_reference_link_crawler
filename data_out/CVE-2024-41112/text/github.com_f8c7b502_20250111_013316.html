
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fblob%2F4b89495f3bdd481998aadf1fc74b10de0f71c237%2Fpages%2F1_%25F0%259F%2593%25B7_Timelapse.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopengeos%2Fstreamlit-geospatial%2Fblob%2F4b89495f3bdd481998aadf1fc74b10de0f71c237%2Fpages%2F1_%25F0%259F%2593%25B7_Timelapse.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=opengeos%2Fstreamlit-geospatial)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opengeos](/opengeos)
/
**[streamlit-geospatial](/opengeos/streamlit-geospatial)**
Public

* [Notifications](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial) You must be signed in to change notification settings
* [Fork
  403](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)
* [Star
   894](/login?return_to=%2Fopengeos%2Fstreamlit-geospatial)

* [Code](/opengeos/streamlit-geospatial)
* [Issues
  3](/opengeos/streamlit-geospatial/issues)
* [Pull requests
  1](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects
  0](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

Additional navigation options

* [Code](/opengeos/streamlit-geospatial)
* [Issues](/opengeos/streamlit-geospatial/issues)
* [Pull requests](/opengeos/streamlit-geospatial/pulls)
* [Discussions](/opengeos/streamlit-geospatial/discussions)
* [Actions](/opengeos/streamlit-geospatial/actions)
* [Projects](/opengeos/streamlit-geospatial/projects)
* [Security](/opengeos/streamlit-geospatial/security)
* [Insights](/opengeos/streamlit-geospatial/pulse)

## Files

Â 4b89495
## Breadcrumbs

1. [streamlit-geospatial](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237)
2. /[pages](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages)
/
# 1\_ðŸ“·\_Timelapse.py

Copy path Blame  Blame
## Latest commit

## History

[History](/opengeos/streamlit-geospatial/commits/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)1528 lines (1365 loc) Â· 64.4 KBÂ 4b89495
## Breadcrumbs

1. [streamlit-geospatial](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237)
2. /[pages](/opengeos/streamlit-geospatial/tree/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages)
/
# 1\_ðŸ“·\_Timelapse.py

Top
## File metadata and controls

* Code
* Blame

1528 lines (1365 loc) Â· 64.4 KB[Raw](https://github.com/opengeos/streamlit-geospatial/raw/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000import eeimport osimport warningsimport datetimeimport fionaimport geopandas as gpdimport foliumimport streamlit as stimport geemap.colormaps as cmimport geemap.foliumap as geemapfrom datetime import datefrom shapely.geometry import Polygon
st.set\_page\_config(layout="wide")warnings.filterwarnings("ignore")
@st.cache\_datadef ee\_authenticate(token\_name="EARTHENGINE\_TOKEN"): geemap.ee\_initialize(token\_name=token\_name)
st.sidebar.info( """ - Web App URL: <https://streamlit.geemap.org> - GitHub repository: <https://github.com/giswqs/streamlit-geospatial> """)
st.sidebar.title("Contact")st.sidebar.info( """ Qiusheng Wu: <https://wetlands.io> [GitHub](https://github.com/giswqs) | [Twitter](https://twitter.com/giswqs) | [YouTube](https://www.youtube.com/c/QiushengWu) | [LinkedIn](https://www.linkedin.com/in/qiushengwu) """)
goes\_rois = { "Creek Fire, CA (2020-09-05)": { "region": Polygon( [ [-121.003418, 36.848857], [-121.003418, 39.049052], [-117.905273, 39.049052], [-117.905273, 36.848857], [-121.003418, 36.848857], ] ), "start\_time": "2020-09-05T15:00:00", "end\_time": "2020-09-06T02:00:00", }, "Bomb Cyclone (2021-10-24)": { "region": Polygon( [ [-159.5954, 60.4088], [-159.5954, 24.5178], [-114.2438, 24.5178], [-114.2438, 60.4088], ] ), "start\_time": "2021-10-24T14:00:00", "end\_time": "2021-10-25T01:00:00", }, "Hunga Tonga Volcanic Eruption (2022-01-15)": { "region": Polygon( [ [-192.480469, -32.546813], [-192.480469, -8.754795], [-157.587891, -8.754795], [-157.587891, -32.546813], [-192.480469, -32.546813], ] ), "start\_time": "2022-01-15T03:00:00", "end\_time": "2022-01-15T07:00:00", }, "Hunga Tonga Volcanic Eruption Closer Look (2022-01-15)": { "region": Polygon( [ [-178.901367, -22.958393], [-178.901367, -17.85329], [-171.452637, -17.85329], [-171.452637, -22.958393], [-178.901367, -22.958393], ] ), "start\_time": "2022-01-15T03:00:00", "end\_time": "2022-01-15T07:00:00", },}
landsat\_rois = { "Aral Sea": Polygon( [ [57.667236, 43.834527], [57.667236, 45.996962], [61.12793, 45.996962], [61.12793, 43.834527], [57.667236, 43.834527], ] ), "Dubai": Polygon( [ [54.541626, 24.763044], [54.541626, 25.427152], [55.632019, 25.427152], [55.632019, 24.763044], [54.541626, 24.763044], ] ), "Hong Kong International Airport": Polygon( [ [113.825226, 22.198849], [113.825226, 22.349758], [114.085121, 22.349758], [114.085121, 22.198849], [113.825226, 22.198849], ] ), "Las Vegas, NV": Polygon( [ [-115.554199, 35.804449], [-115.554199, 36.558188], [-113.903503, 36.558188], [-113.903503, 35.804449], [-115.554199, 35.804449], ] ), "Pucallpa, Peru": Polygon( [ [-74.672699, -8.600032], [-74.672699, -8.254983], [-74.279938, -8.254983], [-74.279938, -8.600032], ] ), "Sierra Gorda, Chile": Polygon( [ [-69.315491, -22.837104], [-69.315491, -22.751488], [-69.190006, -22.751488], [-69.190006, -22.837104], [-69.315491, -22.837104], ] ),}
modis\_rois = { "World": Polygon( [ [-171.210938, -57.136239], [-171.210938, 79.997168], [177.539063, 79.997168], [177.539063, -57.136239], [-171.210938, -57.136239], ] ), "Africa": Polygon( [ [-18.6983, 38.1446], [-18.6983, -36.1630], [52.2293, -36.1630], [52.2293, 38.1446], ] ), "USA": Polygon( [ [-127.177734, 23.725012], [-127.177734, 50.792047], [-66.269531, 50.792047], [-66.269531, 23.725012], [-127.177734, 23.725012], ] ),}
ocean\_rois = { "Gulf of Mexico": Polygon( [ [-101.206055, 15.496032], [-101.206055, 32.361403], [-75.673828, 32.361403], [-75.673828, 15.496032], [-101.206055, 15.496032], ] ), "North Atlantic Ocean": Polygon( [ [-85.341797, 24.046464], [-85.341797, 45.02695], [-55.810547, 45.02695], [-55.810547, 24.046464], [-85.341797, 24.046464], ] ), "World": Polygon( [ [-171.210938, -57.136239], [-171.210938, 79.997168], [177.539063, 79.997168], [177.539063, -57.136239], [-171.210938, -57.136239], ] ),}
@st.cache\_datadef uploaded\_file\_to\_gdf(data): import tempfile import os import uuid
 \_, file\_extension = os.path.splitext(data.name) file\_id = str(uuid.uuid4()) file\_path = os.path.join(tempfile.gettempdir(), f"{file\_id}{file\_extension}")
 with open(file\_path, "wb") as file: file.write(data.getbuffer())
 if file\_path.lower().endswith(".kml"): fiona.drvsupport.supported\_drivers["KML"] = "rw" gdf = gpd.read\_file(file\_path, driver="KML") else: gdf = gpd.read\_file(file\_path)
 return gdf
def app():
 today = date.today()
 st.title("Create Satellite Timelapse")
 st.markdown( """ An interactive web app for creating [Landsat](https://developers.google.com/earth-engine/datasets/catalog/landsat)/[GOES](https://jstnbraaten.medium.com/goes-in-earth-engine-53fbc8783c16) timelapse for any location around the globe.  The app was built using [streamlit](https://streamlit.io), [geemap](https://geemap.org), and [Google Earth Engine](https://earthengine.google.com). For more info, check out my streamlit [blog post](https://blog.streamlit.io/creating-satellite-timelapse-with-streamlit-and-earth-engine).  """ )
 row1\_col1, row1\_col2 = st.columns([2, 1])
 if st.session\_state.get("zoom\_level") is None: st.session\_state["zoom\_level"] = 4
 st.session\_state["ee\_asset\_id"] = None st.session\_state["bands"] = None st.session\_state["palette"] = None st.session\_state["vis\_params"] = None
 with row1\_col1: ee\_authenticate(token\_name="EARTHENGINE\_TOKEN") m = geemap.Map( basemap="HYBRID", plugin\_Draw=True, Draw\_export=True, locate\_control=True, plugin\_LatLngPopup=False, ) m.add\_basemap("ROADMAP")
 with row1\_col2:
 keyword = st.text\_input("Search for a location:", "") if keyword: locations = geemap.geocode(keyword) if locations is not None and len(locations) > 0: str\_locations = [str(g)[1:-1] for g in locations] location = st.selectbox("Select a location:", str\_locations) loc\_index = str\_locations.index(location) selected\_loc = locations[loc\_index] lat, lng = selected\_loc.lat, selected\_loc.lng folium.Marker(location=[lat, lng], popup=location).add\_to(m) m.set\_center(lng, lat, 12) st.session\_state["zoom\_level"] = 12
 collection = st.selectbox( "Select a satellite image collection: ", [ "Any Earth Engine ImageCollection", "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", "Geostationary Operational Environmental Satellites (GOES)", "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", "MODIS Ocean Color SMI", "USDA National Agriculture Imagery Program (NAIP)", ], index=1, )
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: roi\_options = ["Uploaded GeoJSON"] + list(landsat\_rois.keys())
 elif collection == "Geostationary Operational Environmental Satellites (GOES)": roi\_options = ["Uploaded GeoJSON"] + list(goes\_rois.keys())
 elif collection in [ "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", ]: roi\_options = ["Uploaded GeoJSON"] + list(modis\_rois.keys()) elif collection == "MODIS Ocean Color SMI": roi\_options = ["Uploaded GeoJSON"] + list(ocean\_rois.keys()) else: roi\_options = ["Uploaded GeoJSON"]
 if collection == "Any Earth Engine ImageCollection": keyword = st.text\_input("Enter a keyword to search (e.g., MODIS):", "") if keyword:
 assets = geemap.search\_ee\_data(keyword) ee\_assets = [] for asset in assets: if asset["ee\_id\_snippet"].startswith("ee.ImageCollection"): ee\_assets.append(asset)
 asset\_titles = [x["title"] for x in ee\_assets] dataset = st.selectbox("Select a dataset:", asset\_titles) if len(ee\_assets) > 0: st.session\_state["ee\_assets"] = ee\_assets st.session\_state["asset\_titles"] = asset\_titles index = asset\_titles.index(dataset) ee\_id = ee\_assets[index]["id"] else: ee\_id = ""
 if dataset is not None: with st.expander("Show dataset details", False): index = asset\_titles.index(dataset) html = geemap.ee\_data\_html(st.session\_state["ee\_assets"][index]) st.markdown(html, True) # elif collection == "MODIS Gap filled Land Surface Temperature Daily": # ee\_id = "" else: ee\_id = ""
 asset\_id = st.text\_input("Enter an ee.ImageCollection asset ID:", ee\_id)
 if asset\_id: with st.expander("Customize band combination and color palette", True): try: col = ee.ImageCollection.load(asset\_id) st.session\_state["ee\_asset\_id"] = asset\_id except: st.error("Invalid Earth Engine asset ID.") st.session\_state["ee\_asset\_id"] = None return
 img\_bands = col.first().bandNames().getInfo() if len(img\_bands) >= 3: default\_bands = img\_bands[:3][::-1] else: default\_bands = img\_bands[:] bands = st.multiselect( "Select one or three bands (RGB):", img\_bands, default\_bands ) st.session\_state["bands"] = bands
 if len(bands) == 1: palette\_options = st.selectbox( "Color palette", cm.list\_colormaps(), index=2, ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write( cm.plot\_colormap(cmap=palette\_options, return\_fig=True) ) st.session\_state["palette"] = eval(palette)
 if bands: vis\_params = st.text\_area( "Enter visualization parameters", "{'bands': [" + ", ".join([f"'{band}'" for band in bands]) + "]}", ) else: vis\_params = st.text\_area( "Enter visualization parameters", "{}", ) try: st.session\_state["vis\_params"] = eval(vis\_params) st.session\_state["vis\_params"]["palette"] = st.session\_state[ "palette" ] except Exception as e: st.session\_state["vis\_params"] = None st.error( f"Invalid visualization parameters. It must be a dictionary." )
 elif collection == "MODIS Gap filled Land Surface Temperature Daily": with st.expander("Show dataset details", False): st.markdown( """ See the [Awesome GEE Community Datasets](https://samapriya.github.io/awesome-gee-community-datasets/projects/daily\_lst/). """ )
 MODIS\_options = ["Daytime (1:30 pm)", "Nighttime (1:30 am)"] MODIS\_option = st.selectbox("Select a MODIS dataset:", MODIS\_options) if MODIS\_option == "Daytime (1:30 pm)": st.session\_state[ "ee\_asset\_id" ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_day\_1km" else: st.session\_state[ "ee\_asset\_id" ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_night\_1km"
 palette\_options = st.selectbox( "Color palette", cm.list\_colormaps(), index=90, ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) st.session\_state["palette"] = eval(palette) elif collection == "MODIS Ocean Color SMI": with st.expander("Show dataset details", False): st.markdown( """ See the [Earth Engine Data Catalog](https://developers.google.com/earth-engine/datasets/catalog/NASA\_OCEANDATA\_MODIS-Aqua\_L3SMI). """ )
 MODIS\_options = ["Aqua", "Terra"] MODIS\_option = st.selectbox("Select a satellite:", MODIS\_options) st.session\_state["ee\_asset\_id"] = MODIS\_option # if MODIS\_option == "Daytime (1:30 pm)": # st.session\_state[ # "ee\_asset\_id" # ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_day\_1km" # else: # st.session\_state[ # "ee\_asset\_id" # ] = "projects/sat-io/open-datasets/gap-filled-lst/gf\_night\_1km"
 band\_dict = { "Chlorophyll a concentration": "chlor\_a", "Normalized fluorescence line height": "nflh", "Particulate organic carbon": "poc", "Sea surface temperature": "sst", "Remote sensing reflectance at band 412nm": "Rrs\_412", "Remote sensing reflectance at band 443nm": "Rrs\_443", "Remote sensing reflectance at band 469nm": "Rrs\_469", "Remote sensing reflectance at band 488nm": "Rrs\_488", "Remote sensing reflectance at band 531nm": "Rrs\_531", "Remote sensing reflectance at band 547nm": "Rrs\_547", "Remote sensing reflectance at band 555nm": "Rrs\_555", "Remote sensing reflectance at band 645nm": "Rrs\_645", "Remote sensing reflectance at band 667nm": "Rrs\_667", "Remote sensing reflectance at band 678nm": "Rrs\_678", }
 band\_options = list(band\_dict.keys()) band = st.selectbox( "Select a band", band\_options, band\_options.index("Sea surface temperature"), ) st.session\_state["band"] = band\_dict[band]
 colors = cm.list\_colormaps() palette\_options = st.selectbox( "Color palette", colors, index=colors.index("coolwarm"), ) palette\_values = cm.get\_palette(palette\_options, 15) palette = st.text\_area( "Enter a custom palette:", palette\_values, ) st.write(cm.plot\_colormap(cmap=palette\_options, return\_fig=True)) st.session\_state["palette"] = eval(palette)
 sample\_roi = st.selectbox( "Select a sample ROI or upload a GeoJSON file:", roi\_options, index=0, )
 add\_outline = st.checkbox( "Overlay an administrative boundary on timelapse", False )
 if add\_outline:
 with st.expander("Customize administrative boundary", True):
 overlay\_options = { "User-defined": None, "Continents": "continents", "Countries": "countries", "US States": "us\_states", "China": "china", }
 overlay = st.selectbox( "Select an administrative boundary:", list(overlay\_options.keys()), index=2, )
 overlay\_data = overlay\_options[overlay]
 if overlay\_data is None: overlay\_data = st.text\_input( "Enter an HTTP URL to a GeoJSON file or an ee.FeatureCollection asset id:", "https://raw.githubusercontent.com/giswqs/geemap/master/examples/data/countries.geojson", )
 overlay\_color = st.color\_picker( "Select a color for the administrative boundary:", "#000000" ) overlay\_width = st.slider( "Select a line width for the administrative boundary:", 1, 20, 1 ) overlay\_opacity = st.slider( "Select an opacity for the administrative boundary:", 0.0, 1.0, 1.0, 0.05, ) else: overlay\_data = None overlay\_color = "black" overlay\_width = 1 overlay\_opacity = 1
 with row1\_col1:
 with st.expander( "Steps: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Expand this tab to see a demo ðŸ‘‰" ): video\_empty = st.empty()
 data = st.file\_uploader( "Upload a GeoJSON file to use as an ROI. Customize timelapse parameters and then click the Submit button ðŸ˜‡ðŸ‘‡", type=["geojson", "kml", "zip"], )
 crs = "epsg:4326" if sample\_roi == "Uploaded GeoJSON": if data is None: # st.info( # "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click Submit button" # ) if collection in [ "Geostationary Operational Environmental Satellites (GOES)", "USDA National Agriculture Imagery Program (NAIP)", ] and (not keyword): m.set\_center(-100, 40, 3) # else: # m.set\_center(4.20, 18.63, zoom=2) else: if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[landsat\_rois[sample\_roi]] ) elif ( collection == "Geostationary Operational Environmental Satellites (GOES)" ): gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[goes\_rois[sample\_roi]["region"]] ) elif collection == "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km": gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[modis\_rois[sample\_roi]] )
 if sample\_roi != "Uploaded GeoJSON":
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[landsat\_rois[sample\_roi]] ) elif ( collection == "Geostationary Operational Environmental Satellites (GOES)" ): gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[goes\_rois[sample\_roi]["region"]] ) elif collection in [ "MODIS Vegetation Indices (NDVI/EVI) 16-Day Global 1km", "MODIS Gap filled Land Surface Temperature Daily", ]: gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[modis\_rois[sample\_roi]] ) elif collection == "MODIS Ocean Color SMI": gdf = gpd.GeoDataFrame( index=[0], crs=crs, geometry=[ocean\_rois[sample\_roi]] ) try: st.session\_state["roi"] = geemap.gdf\_to\_ee(gdf, geodesic=False) except Exception as e: st.error(e) st.error("Please draw another ROI and try again.") return m.add\_gdf(gdf, "ROI")
 elif data: gdf = uploaded\_file\_to\_gdf(data) try: st.session\_state["roi"] = geemap.gdf\_to\_ee(gdf, geodesic=False) m.add\_gdf(gdf, "ROI") except Exception as e: st.error(e) st.error("Please draw another ROI and try again.") return
 m.to\_streamlit(height=600)
 with row1\_col2:
 if collection in [ "Landsat TM-ETM-OLI Surface Reflectance", "Sentinel-2 MSI Surface Reflectance", ]:
 if collection == "Landsat TM-ETM-OLI Surface Reflectance": sensor\_start\_year = 1984 timelapse\_title = "Landsat Timelapse" timelapse\_speed = 5 elif collection == "Sentinel-2 MSI Surface Reflectance": sensor\_start\_year = 2015 timelapse\_title = "Sentinel-2 Timelapse" timelapse\_speed = 5 video\_empty.video("https://youtu.be/VVRK\_-dEjR4")
 with st.form("submit\_landsat\_form"):
 roi = None if st.session\_state.get("roi") is not None: roi = st.session\_state.get("roi") out\_gif = geemap.temp\_file\_path(".gif")
 title = st.text\_input( "Enter a title to show on the timelapse: ", timelapse\_title ) RGB = st.selectbox( "Select an RGB band combination:", [ "Red/Green/Blue", "NIR/Red/Green", "SWIR2/SWIR1/NIR", "NIR/SWIR1/Red", "SWIR2/NIR/Red", "SWIR2/SWIR1/Red", "SWIR1/NIR/Blue", "NIR/SWIR1/Blue", "SWIR2/NIR/Green", "SWIR1/NIR/Red", "SWIR2/NIR/SWIR1", "SWIR1/NIR/SWIR2", ], index=9, )
 frequency = st.selectbox( "Select a temporal frequency:", ["year", "quarter", "month"], index=0, )
 with st.expander("Customize timelapse"):
 speed = st.slider("Frames per second:", 1, 30, timelapse\_speed) dimensions = st.slider( "Maximum dimensions (Width\*Height) in pixels", 768, 2000, 768 ) progress\_bar\_color = st.color\_picker( "Progress bar color:", "#0000ff" ) years = st.slider( "Start and end year:", sensor\_start\_year, today.year, (sensor\_start\_year, today.year), ) months = st.slider("Start and end month:", 1, 12, (1, 12)) font\_size = st.slider("Font size:", 10, 50, 30) font\_color = st.color\_picker("Font color:", "#ffffff") apply\_fmask = st.checkbox( "Apply fmask (remove clouds, shadows, snow)", True ) font\_type = st.selectbox( "Select the font type for the title:", ["arial.ttf", "alibaba.otf"], index=0, ) fading = st.slider( "Fading duration (seconds) for each frame:", 0.0, 3.0, 0.0 ) mp4 = st.checkbox("Save timelapse as MP4", True)
 empty\_text = st.empty() empty\_image = st.empty() empty\_fire\_image = st.empty() empty\_video = st.container() submitted = st.form\_submit\_button("Submit") if submitted:
 if sample\_roi == "Uploaded GeoJSON" and data is None: empty\_text.warning( "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Alternatively, you can select a sample ROI from the dropdown list." ) else:
 empty\_text.text("Computing... Please wait...")
 start\_year = years[0] end\_year = years[1] start\_date = str(months[0]).zfill(2) + "-01" end\_date = str(months[1]).zfill(2) + "-30" bands = RGB.split("/")
 try: if collection == "Landsat TM-ETM-OLI Surface Reflectance": out\_gif = geemap.landsat\_timelapse( roi=roi, out\_gif=out\_gif, start\_year=start\_year, end\_year=end\_year, start\_date=start\_date, end\_date=end\_date, bands=bands, apply\_fmask=apply\_fmask, frames\_per\_second=speed, # dimensions=dimensions, dimensions=768, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, frequency=frequency, date\_format=None, title=title, title\_xy=("2%", "90%"), add\_text=True, text\_xy=("2%", "2%"), text\_sequence=None, font\_type=font\_type, font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=True, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, mp4=mp4, fading=fading, ) elif collection == "Sentinel-2 MSI Surface Reflectance": out\_gif = geemap.sentinel2\_timelapse( roi=roi, out\_gif=out\_gif, start\_year=start\_year, end\_year=end\_year, start\_date=start\_date, end\_date=end\_date, bands=bands, apply\_fmask=apply\_fmask, frames\_per\_second=speed, dimensions=768, # dimensions=dimensions, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, frequency=frequency, date\_format=None, title=title, title\_xy=("2%", "90%"), add\_text=True, text\_xy=("2%", "2%"), text\_sequence=None, font\_type=font\_type, font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=True, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, mp4=mp4, fading=fading, ) except: empty\_text.error( "An error occurred while computing the timelapse. Your probably requested too much data. Try reducing the ROI or timespan." ) st.stop()
 if out\_gif is not None and os.path.exists(out\_gif):
 empty\_text.text( "Right click the GIF to save it to your computerðŸ‘‡" ) empty\_image.image(out\_gif)
 out\_mp4 = out\_gif.replace(".gif", ".mp4") if mp4 and os.path.exists(out\_mp4): with empty\_video: st.text( "Right click the MP4 to save it to your computerðŸ‘‡" ) st.video(out\_gif.replace(".gif", ".mp4"))
 else: empty\_text.error( "Something went wrong. You probably requested too much data. Try reducing the ROI or timespan." )
 elif collection == "Geostationary Operational Environmental Satellites (GOES)":
 video\_empty.video("https://youtu.be/16fA2QORG4A")
 with st.form("submit\_goes\_form"):
 roi = None if st.session\_state.get("roi") is not None: roi = st.session\_state.get("roi") out\_gif = geemap.temp\_file\_path(".gif")
 satellite = st.selectbox("Select a satellite:", ["GOES-17", "GOES-16"]) earliest\_date = datetime.date(2017, 7, 10) latest\_date = datetime.date.today()
 if sample\_roi == "Uploaded GeoJSON": roi\_start\_date = today - datetime.timedelta(days=2) roi\_end\_date = today - datetime.timedelta(days=1) roi\_start\_time = datetime.time(14, 00) roi\_end\_time = datetime.time(1, 00) else: roi\_start = goes\_rois[sample\_roi]["start\_time"] roi\_end = goes\_rois[sample\_roi]["end\_time"] roi\_start\_date = datetime.datetime.strptime( roi\_start[:10], "%Y-%m-%d" ) roi\_end\_date = datetime.datetime.strptime(roi\_end[:10], "%Y-%m-%d") roi\_start\_time = datetime.time( int(roi\_start[11:13]), int(roi\_start[14:16]) ) roi\_end\_time = datetime.time( int(roi\_end[11:13]), int(roi\_end[14:16]) )
 start\_date = st.date\_input("Select the start date:", roi\_start\_date) end\_date = st.date\_input("Select the end date:", roi\_end\_date)
 with st.expander("Customize timelapse"):
 add\_fire = st.checkbox("Add Fire/Hotspot Characterization", False)
 scan\_type = st.selectbox( "Select a scan type:", ["Full Disk", "CONUS", "Mesoscale"] )
 start\_time = st.time\_input( "Select the start time of the start date:", roi\_start\_time )
 end\_time = st.time\_input( "Select the end time of the end date:", roi\_end\_time )
 start = ( start\_date.strftime("%Y-%m-%d") + "T" + start\_time.strftime("%H:%M:%S") ) end = ( end\_date.strftime("%Y-%m-%d") + "T" + end\_time.strftime("%H:%M:%S") )
 speed = st.slider("Frames per second:", 1, 30, 5) add\_progress\_bar = st.checkbox("Add a progress bar", True) progress\_bar\_color = st.color\_picker( "Progress bar color:", "#0000ff" ) font\_size = st.slider("Font size:", 10, 50, 20) font\_color = st.color\_picker("Font color:", "#ffffff") fading = st.slider( "Fading duration (seconds) for each frame:", 0.0, 3.0, 0.0 ) mp4 = st.checkbox("Save timelapse as MP4", True)
 empty\_text = st.empty() empty\_image = st.empty() empty\_video = st.container() empty\_fire\_text = st.empty() empty\_fire\_image = st.empty()
 submitted = st.form\_submit\_button("Submit") if submitted: if sample\_roi == "Uploaded GeoJSON" and data is None: empty\_text.warning( "Steps to create a timelapse: Draw a rectangle on the map -> Export it as a GeoJSON -> Upload it back to the app -> Click the Submit button. Alternatively, you can select a sample ROI from the dropdown list." ) else: empty\_text.text("Computing... Please wait...")
 geemap.goes\_timelapse( roi, out\_gif, start\_date=start, end\_date=end, data=satellite, scan=scan\_type.replace(" ", "\_").lower(), dimensions=768, framesPerSecond=speed, date\_format="YYYY-MM-dd HH:mm", xy=("3%", "3%"), text\_sequence=None, font\_type="arial.ttf", font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=add\_progress\_bar, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, overlay\_data=overlay\_data, overlay\_color=overlay\_color, overlay\_width=overlay\_width, overlay\_opacity=overlay\_opacity, mp4=mp4, fading=fading, )
 if out\_gif is not None and os.path.exists(out\_gif): empty\_text.text( "Right click the GIF to save it to your computerðŸ‘‡" ) empty\_image.image(out\_gif)
 out\_mp4 = out\_gif.replace(".gif", ".mp4") if mp4 and os.path.exists(out\_mp4): with empty\_video: st.text( "Right click the MP4 to save it to your computerðŸ‘‡" ) st.video(out\_gif.replace(".gif", ".mp4"))
 if add\_fire: out\_fire\_gif = geemap.temp\_file\_path(".gif") empty\_fire\_text.text( "Delineating Fire Hotspot... Please wait..." ) geemap.goes\_fire\_timelapse( out\_fire\_gif, start\_date=start, end\_date=end, data=satellite, scan=scan\_type.replace(" ", "\_").lower(), region=roi, dimensions=768, framesPerSecond=speed, date\_format="YYYY-MM-dd HH:mm", xy=("3%", "3%"), text\_sequence=None, font\_type="arial.ttf", font\_size=font\_size, font\_color=font\_color, add\_progress\_bar=add\_progress\_bar, progress\_bar\_color=progress\_bar\_color, progress\_bar\_height=5, loop=0, ) if os.path.exists(out\_fire\_gif): empty\_fire\_image.image(out\_fire\_gif) else:[View remainder of file in raw view](https://github.com/opengeos/streamlit-geospatial/raw/4b89495f3bdd481998aadf1fc74b10de0f71c237/pages/1_%F0%9F%93%B7_Timelapse.py)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.

