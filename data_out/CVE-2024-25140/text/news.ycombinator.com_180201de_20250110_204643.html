

| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D39256493) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [As HN: RustDesk Installs Chinese Root Certificates](item?id=39256493) | | --- | --- | --- | |  | | 68 points by [lobito14](user?id=lobito14) [11 months ago](item?id=39256493)  | [hide](hide?id=39256493&goto=item%3Fid%3D39256493) | [past](https://hn.algolia.com/?query=As%20HN%3A%20RustDesk%20Installs%20Chinese%20Root%20Certificates&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=39256493&auth=ebe99850a2648b9492440f98d309a18e95f72ab0) | [17 comments](item?id=39256493) | |  | |  | | I'm not an expert in security, but I noticed that the Windows version of RustDesk (https://rustdesk.com/), an open-source remote desktop software, installs a Chinese root certificate to the Windows `Trusted Root Certification Authorities` with all purposes enabled. There's a discussion on GitHub (https://github.com/rustdesk/rustdesk/discussions/6444) where one of the maintainers states the certificates are for driver code signing, but doesn't explain why they need to be placed in `Trusted Root Certification Authorities` with all purposes permissions instead of just for code signing. Does anyone more experienced in security have a take on this? |  | |  |  | [BandButcher](user?id=BandButcher) [11 months ago](item?id=39256590)   | [next](#39266403) [–]  Not a security expert, but this is a huge code smell. Always be cautious of trusting certs of any kind, especially test/dev certs with top level privileges lol personally i would avoid. Based on the issue there are too many weak points and the "response" given didnt seem to care about the vulnerabilities or user concerns, only said why its needed... The issue poster was smart in running in a sandbox and comparing files. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [BandButcher](user?id=BandButcher) [11 months ago](item?id=39256610)   | [parent](#39256590) | [next](#39266403) [–]  Never heard of this repo or library, but in the readme: "Yet another remote desktop software, written in Rust. Works out of the box, no configuration required. You have full control of your data, with no concerns about security".... Yikes. Please don't believe in every repo face value. Your best bet is to generate your own certs (<https://github.com/FiloSottile/mkcert>) and sign the dlls yourself. | | --- | --- | --- | | | |  |  | [ComputerGuru](user?id=ComputerGuru) [11 months ago](item?id=39266403)   | [prev](#39256590) | [next](#39266179) [–]  Placing a certificate in the Trusted Root Certification Authorities node – despite completely "owning" a machine – is ironically not enough for a certificate to be used for driver code signing as even those need to be cross-signed by Microsoft to be accepted for kernel-mode drivers. I'm not sure this explanation holds any water. (When it *does* suffice, the approach has *always* been generate a CA certificate on the device itself and install *that*, generate a cert signed by that CA to sign the code/driver with, then nuke the CA's private keys so they can't be used to sign anything else again. There would be *zero* need to *ever* use a real CA here.) | | --- | --- | --- | | | |  |  | [aaomidi](user?id=aaomidi) [11 months ago](item?id=39266179)   | [prev](#39266403) | [next](#39260030) [–]  Shame on Windows for just letting an application install a new root without express, and on-going user context. This is something that the OS should be at some regularity reminding the user that has happened. It is not reasonable for a user to assume that installing an application is just going to let that application completely switch the trusts on the computer. | | --- | --- | --- | | | |  |  | [cpach](user?id=cpach) [11 months ago](item?id=39268631)   | [parent](#39266179) | [next](#39260030) [–]  Does Windows really not show any warnings at all in such a case? I would assume it does, but I’m not sure. | | --- | --- | --- | | | |  |  | [lobito14](user?id=lobito14) [11 months ago](item?id=39272130)   | [root](#39266179) | [parent](#39268631) | [next](#39260030) [–]  Windows doesn't show any special warnings for the certificate installation, just the usual UAC prompt. | | --- | --- | --- | | | |  |  | [rmhrisk](user?id=rmhrisk) [11 months ago](item?id=39281815)   | [root](#39266179) | [parent](#39272130) | [next](#39260030) [–]  If a root/admin user installs a root there is no prompt, if a user does, it is scoped to the individual user profile and a prompt is displayed. No prompt as root would be meaningful because the root/admin user could just update the configuration without using the API. Long story short, don't give root/admin to applications you don't trust. | | --- | --- | --- | | | |  |  | [aaomidi](user?id=aaomidi) [11 months ago](item?id=39282694)   | [root](#39266179) | [parent](#39281815) | [next](#39260030) [–]  Right but basically all application installers basically require “root” on windows. This is an unfortunate side effect of how installation works on Windows I think. I really think we need to move closer to requesting permissions to specific things rather than a binary “admin or not”. | | --- | --- | --- | | | |  |  | [lobito14](user?id=lobito14) [11 months ago](item?id=39260030)   | [prev](#39266179) | [next](#39260577) [–]  I've decided to remove the hosted version of the software I was operating, as well as the client applications from all my devices, until the situation is clarified. An insecure certificate, such as the one RustDesk is utilizing, should not have the extensive permissions it currently holds. | | --- | --- | --- | | | |  |  | [foobarbaz33](user?id=foobarbaz33) [11 months ago](item?id=39260577)   | [prev](#39260030) | [next](#39296372) [–]  Maybe this app's real purpose is to be malware. Start off as a useful app to gain a large user base (trojan horses). Charge for it too, that makes it seem even more legit, but have a free tier to grow the user base. Then silently turn it into malware. | | --- | --- | --- | | | |  |  | [lobito14](user?id=lobito14) [11 months ago](item?id=39296372)   | [prev](#39260577) | [next](#39260241) [–]  User asked these questions ([https://github.com/rustdesk/rustdesk/discussions/6444#discus...](https://github.com/rustdesk/rustdesk/discussions/6444#discussioncomment-8378643)): ```     "why this certificat is in root store.     why this certificat have a validity of 10 years and only use SHA-1.     why this certificat is different from the DLL one."  ``` RustDesk's answer: "Frankly, as for 1,2, we do not know either, we are not expert in this field, maybe because it is test cert. As for 3, dll is OV cert, but the driversigning requires EV cert, we do not have EV cert, so we use test cert as a workaround. Someone in HN does not believe we do not have EV, but we really have not. :( But now I think it is time for us to get one." <https://i.ibb.co/bHjMYWH/2024-02-08-00h41-11.png> | | --- | --- | --- | | | |  |  | [cpach](user?id=cpach) [11 months ago](item?id=39260241)   | [prev](#39296372) | [next](#39258322) [–]  This is not acceptable. I would avoid this application, at all costs. You should never install a root certificate from someone, unless you want them to be able to silently MITM any TLS connection from your machine. | | --- | --- | --- | | | |  |  | [lobito14](user?id=lobito14) [11 months ago](item?id=39260326)   | [parent](#39260241) | [next](#39258322) [–]  Some Discord users claim that the certificate required to sign the video driver is a Windows WDK certificate and not a Chinese one. However, the administrative details on the certificate are in Chinese, and there are concerns about the certificate's location and its permissions. Additionally, there are opinions that a code signing certificate is costly, but I disagree. Given their size, they can afford to spend $290 on an EV certificate (<https://signmycode.com/ev-code-signing>). | | --- | --- | --- | | | |  |  | [cpach](user?id=cpach) [11 months ago](item?id=39260673)   | [root](#39260241) | [parent](#39260326) | [next](#39258322) [–]  It it really was a certificate from Microsoft, why would it not be bundled with Windows? | | --- | --- | --- | | | |  |  | [lobito14](user?id=lobito14) [11 months ago](item?id=39261987)   | [root](#39260241) | [parent](#39260673) | [next](#39258322) [–]  I don't know, but the certificate I found under Trusted Root Certification Authorities was set to "Enable all purposes for this certificate," which definitely shouldn't be the case. | | --- | --- | --- | | | |  |  | [pseudony](user?id=pseudony) [11 months ago](item?id=39258322)   | [prev](#39260241) | [next](#39260327) [–]  Oh lighten up, it's memory safe! /sic | | --- | --- | --- | | | |  |  | [lobito14](user?id=lobito14) [11 months ago](item?id=39260327)   | [prev](#39258322) [2 more]  [flagged] | | --- | --- | --- | | | |  |  | [thehamkercat](user?id=thehamkercat) [11 months ago](item?id=39266638)   | [parent](#39260327) [–]  Sounds like ChatGPT | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |

