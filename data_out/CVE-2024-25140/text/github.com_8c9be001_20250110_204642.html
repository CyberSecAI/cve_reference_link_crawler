
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frustdesk%2Frustdesk%2Fdiscussions%2F6444)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frustdesk%2Frustdesk%2Fdiscussions%2F6444)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fdiscussions_fragments%2Fdiscussion_layout&source=header-repo&source_repo=rustdesk%2Frustdesk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rustdesk](/rustdesk)
/
**[rustdesk](/rustdesk/rustdesk)**
Public

* [Notifications](/login?return_to=%2Frustdesk%2Frustdesk) You must be signed in to change notification settings
* [Fork
  11.1k](/login?return_to=%2Frustdesk%2Frustdesk)
* [Star
   79.1k](/login?return_to=%2Frustdesk%2Frustdesk)

* [Code](/rustdesk/rustdesk)
* [Issues
  48](/rustdesk/rustdesk/issues)
* [Pull requests
  9](/rustdesk/rustdesk/pulls)
* [Discussions](/rustdesk/rustdesk/discussions)
* [Actions](/rustdesk/rustdesk/actions)
* [Projects
  0](/rustdesk/rustdesk/projects)
* [Wiki](/rustdesk/rustdesk/wiki)
* [Security](/rustdesk/rustdesk/security)
* [Insights](/rustdesk/rustdesk/pulse)

Additional navigation options

* [Code](/rustdesk/rustdesk)
* [Issues](/rustdesk/rustdesk/issues)
* [Pull requests](/rustdesk/rustdesk/pulls)
* [Discussions](/rustdesk/rustdesk/discussions)
* [Actions](/rustdesk/rustdesk/actions)
* [Projects](/rustdesk/rustdesk/projects)
* [Wiki](/rustdesk/rustdesk/wiki)
* [Security](/rustdesk/rustdesk/security)
* [Insights](/rustdesk/rustdesk/pulse)

# Strange driversigning with untrusted test-certificate and certificate that signed the RustDeskIddDriver.dll is also not the same certificate #6444

[Answered](#discussioncomment-8521217)
by
[rustdesk](/rustdesk "rustdesk")

[vitusb](/vitusb)
asked this question in
[Q&A](/rustdesk/rustdesk/discussions/categories/q-a)

[Strange driversigning with untrusted test-certificate and certificate that signed the RustDeskIddDriver.dll is also not the same certificate](#top)
#6444

[![@vitusb](https://avatars.githubusercontent.com/u/83558069?s=40&v=4)
vitusb](/vitusb)

Nov 16, 2023
·
14 comments
·
54 replies

[Answered](#discussioncomment-8521217)
by
[rustdesk](/rustdesk "rustdesk")

 [Return to top](#top)

Discussion options

# {{title}}

Something went wrong.

Quote reply

## [vitusb](/vitusb) [Nov 16, 2023](#discussion-5860138)

 -

| Bug Description Hello ...  I've executed the Windows-Installer in a sandbox and examined the extracted-files (also the temp-files) and did a tiny check of the used certificates and the signed files and found some strange issues with the certficate-structure of this project: Strange installation of ROOT-CERTIFICATE in ROOT-store [cert-issues](https://private-user-images.githubusercontent.com/83558069/283520809-a0517017-e01b-4202-bcd2-799a23658b3c.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii84MzU1ODA2OS8yODM1MjA4MDktYTA1MTcwMTctZTAxYi00MjAyLWJjZDItNzk5YTIzNjU4YjNjLmpwZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRmMmM5NWIzZDRkMzJjNjc4OGJiZDllOTI2MDI2ZmVhMWU4ODcwYzdhMjQ4ZWUzZjQzYjQ2NGNkM2FhNTNmYTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.EMQ3_9XiO5AadSe8Kbz2460MqIrKpb0NdFQXCNTA1sY)  The certificate (fingerprint: d1dbb672d5a500b9809689caea1ce49e799767f0), that will be used to install and sign the driver under Windows ("rustdeskidddriver.cat") seems to be strange. It is a **self-signed test-certificate by an anonymous id: "WDKTestCert admin,133225435702113567" that will not use a trusted ROOT-CA and only uses SHA-1 with RSA 2048 (weak) with a timed validity of !! 10 Years !!, much too long for this weak algo !**  ```  Fingerprint: d1dbb672d5a500b9809689caea1ce49e799767f0  CN = WDKTestCert admin,133225435702113567  ``` The fact, that this certificate will be installed in the SYSTEM ROOT-CERTSORE is probably associated with a high risk ... Also the certificate, that signed the installed driver-dll **"RustDeskIddDriver.dll"** is not the same as the certifcate, that created / signed the catalog-file above:  ```  Fingerprint: b27892e774a8cbe382ba7ddcf4649a723b6532d8  CN = Zhou Huabing  O = Zhou Huabing  S = Central Singapore  C = SG  ```  This certificate was issued by "Sectigo Public Code Signing Root R46" ... How to Reproduce Check used certfile "RustDeskIddDriver.cer" of the installer and certificate of signed dll "RustDeskIddDriver.dll". Expected Behavior Usage of valid software-signatures, issued by a trusted ROOT-CA with "secure" algorithms for driver-installation and code-signing. Operating system(s) on local side and remote side Windows 10 RustDesk Version(s) on local side and remote side 1.2.3 Screenshots"RustDeskIddDriver.cer" [cert-issues](https://private-user-images.githubusercontent.com/83558069/283522662-f79774a0-3afe-43b5-99d6-eb1cf4f8ad30.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii84MzU1ODA2OS8yODM1MjI2NjItZjc5Nzc0YTAtM2FmZS00M2I1LTk5ZDYtZWIxY2Y0ZjhhZDMwLmpwZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWJlYWNiZmU2ZmI2MWMwMjhmODRjMzhhMDY2YjZhN2Q0NWYwYTI3NDdkMGI3MTQ3MDBiNjBmYzExODZlMjZmNjQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ItnBQVbaEUZbUngS3btiODZUVx1DALIqxRgZ2ooMIsA) RustDesk\_install.bat [cert-issues-02](https://private-user-images.githubusercontent.com/83558069/283522705-e7aa6a0c-5276-4cc7-bd1f-90af6c60368d.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii84MzU1ODA2OS8yODM1MjI3MDUtZTdhYTZhMGMtNTI3Ni00Y2M3LWJkMWYtOTBhZjZjNjAzNjhkLmpwZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTc2OThjNzEwMjM0NjMxNTFjMDI2OWU2NTFlMjMxNjZiMzg4YzZjMzMzMjQ5NjgzY2FkNTgzMTVjMTUzNDQ4OGEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.IuRI7mUo79CbRyHu0nK79QxIyduLz0ilo7Rk_kLrFoU) "RustDeskIddDriver.dll" [cert-issues-03](https://private-user-images.githubusercontent.com/83558069/283522734-b5af770e-8b7b-4a74-bef5-2e4fd889daa8.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii84MzU1ODA2OS8yODM1MjI3MzQtYjVhZjc3MGUtOGI3Yi00YTc0LWJlZjUtMmU0ZmQ4ODlkYWE4LmpwZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZhOTRmYjhmYjFjMjhjOTc0Y2IyNjM5MGIzNjA3MTQ0OGJkOWY1MDViODRhYTNlMDM5YWFlMDlkYjUyMjAwYjQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.820qCExHeva6s626wO4_QwKaoFz1TWgb0P-MBXFUBNQ) "rustdeskidddriver.cat" [cert-issues-04](https://private-user-images.githubusercontent.com/83558069/283522759-f91cb185-6355-4a1b-81e8-a04153ffe6e9.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii84MzU1ODA2OS8yODM1MjI3NTktZjkxY2IxODUtNjM1NS00YTFiLTgxZTgtYTA0MTUzZmZlNmU5LmpwZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTRhMjI0MWMwMTExM2Q1YmU2YzZiYWU4ZTkyZTc0NWQ2NjczNjNhY2M0NjRmMGFlODcyMzhhMjZhYmJiMzVjMmQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.g7tv5uquEHyn23Lr5KNXCN8pwMhH_xZDfPGhmVEgGrY) Additional Context *No response* |
| --- |

Beta
Was this translation helpful?
Give feedback.

12
 You must be logged in to vote

 👍
8
  😕
5
  🚀
1
  👀
8

All reactions

* 👍
  8
* 😕
  5
* 🚀
  1
* 👀
  8

Answered by
[rustdesk](/rustdesk)

[Feb 19, 2024](https://github.com/rustdesk/rustdesk/discussions/6444#discussioncomment-8521217)

Fixed in latest release by removing our virtual display driver and cert, <https://github.com/rustdesk/rustdesk/releases/latest>. It will be restored once we get an EV, 1 month or more. Thanks for everyone who are giving help on EV

> <https://techcommunity.microsoft.com/t5/windows-hardware-certification/driver-signing-changes-in-windows-10/ba-p/364859>
>
> <https://learn.microsoft.com/en-us/windows-hardware/drivers/dashboard/code-signing-reqs#ev-certificate-signed-drivers>
>
> <https://www.ssl.com/how-to/register-with-windows-hardware-developer-program/>
>
> <https://www.ssl.com/how-to/signing-kernel-mode-drivers-for-windows-using-evcs-or-ovcs-certificates/>
>
> [https://learn.microsoft.com/en-us/answers/questions/31…](https://learn.microsoft.com/en-us/answers/questions/313092/user-mode-driver-signing-process)

[View full answer](#discussioncomment-8521217)

## Replies: 14 comments · 54 replies

* [Oldest](/rustdesk/rustdesk/discussions/6444?sort=old)
* [Newest](/rustdesk/rustdesk/discussions/6444?sort=new)
* [Top](/rustdesk/rustdesk/discussions/6444?sort=top)

Comment options

# {{title}}

Something went wrong.

Quote reply

### [Dec 15, 2023](#discussioncomment-7859170)

 -

| I actually ended up here from searching online, after, seeing this weird Cert but mine was in Chinese. Same CN=WDKTestCert admin,133225435702113567 Thats all I can contribute. Except, maybe a bump to this lol |
| --- |

Beta
Was this translation helpful?
Give feedback.

2
 You must be logged in to vote

 😕
2
  👀
2

All reactions

* 😕
  2
* 👀
  2

3 replies

[![@rustdesk](https://avatars.githubusercontent.com/u/71636191?s=60&v=4)](/rustdesk)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [rustdesk](/rustdesk) [Feb 6, 2024](#discussioncomment-8378772) Maintainer

 -

| The certificate required to sign the video driver is a Windows WDK certificate and not a Chinese one |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👀
1

All reactions

* 👀
  1

[![@nOrphf](https://avatars.githubusercontent.com/u/54571822?s=60&v=4)](/nOrphf)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [nOrphf](/nOrphf) [Mar 13, 2024](#discussioncomment-8775554)

 -

| Hi  Glad to read that you have retrieved the EV certificate. But I also came to this tread after discovering a "Chinese certificate" [image](https://private-user-images.githubusercontent.com/54571822/312530072-6316a888-8e7c-4424-8bdb-1be5f384c5ad.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii81NDU3MTgyMi8zMTI1MzAwNzItNjMxNmE4ODgtOGU3Yy00NDI0LThiZGItMWJlNWYzODRjNWFkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM3NDM3ZTI4MTgyZTgxZGU5NmU5YjY3OGYyODUxODFkNWRlNTdmMzBkMjc1NWVmNmViY2NjNGUyOWU4NGU1YzMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.nGNOcPAa75bcqwLBlumJY-8ybSGScEyluGhOcCSI-yg)  Is this still RustDesk certificate?  Regards Lars |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@xlionjuan](https://avatars.githubusercontent.com/u/25243894?s=60&v=4)](/xlionjuan)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [xlionjuan](/xlionjuan) [Mar 13, 2024](#discussioncomment-8776610)

 -

| <https://github.com/rustdesk/rustdesk/wiki/Remove-RustDesk-test-certificate> |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

Comment options

# {{title}}

Something went wrong.

Quote reply

### [Dec 16, 2023](#discussioncomment-7872508)

 -

| The certificate (fingerprint: d1dbb672d5a500b9809689caea1ce49e799767f0) is automatically used to sign the driver <https://github.com/fufesou/RustDeskIddDriver/releases/download/v0.4/RustDeskIddDriver_x64.zip> from <https://github.com/fufesou/RustDeskIddDriver> All Windows drivers must be signed, this is mandatory.  The certificate (fingerprint: b27892e774a8cbe382ba7ddcf4649a723b6532d8) was used to sign .dll and .exe from the rustdesk package. <https://github.com/rustdesk/rustdesk> |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

 👎
3

All reactions

* 👎
  3

2 replies

[![@x011](https://avatars.githubusercontent.com/u/4313821?s=60&v=4)](/x011)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [x011](/x011) [Feb 5, 2024](#discussioncomment-8364322)

 -

| The certificate purposes option in `Trusted Root Certification Authorities` is checked as `Enabled for All Purposes`. Shouldn't it be only for Code Signing? |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👍
6
  👎
1
  😕
1
  👀
1

All reactions

* 👍
  6
* 👎
  1
* 😕
  1
* 👀
  1

[![@x011](https://avatars.githubusercontent.com/u/4313821?s=60&v=4)](/x011)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [x011](/x011) [Feb 6, 2024](#discussioncomment-8376606)

 -

| HN discussion: <https://news.ycombinator.com/item?id=39256493> |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [Staja](/Staja) [Feb 6, 2024](#discussioncomment-8376668)

 -

| I'm seeing this discussion spread over the internet like wildfire but, when I checked, the certificate only had an EKU for Code signing and KU for Key Encipherment and Data Encipherment; this is what I would expect to see from a certificate used for the stated purposes. TLS stacks (Eg: SChannel) should be adhering to those KU/EKU's; "Enabled for All Purposes" implies "-that are listed in KU/EKU's".  Regardless though, I think a certificate being pushed to end users should clearly identify itself and not use SHA-1, that should be rectified. |
| --- |

Beta
Was this translation helpful?
Give feedback.

5
 You must be logged in to vote

All reactions

1 reply

[![@Zakkaruu](https://avatars.githubusercontent.com/u/20016567?s=60&v=4)](/Zakkaruu)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [Zakkaruu](/Zakkaruu) [Feb 6, 2024](#discussioncomment-8377758)

 -

| To add to this, you can verify and limit "purposes" by going into the certificate properties. The driver certificate only has Code Signing as an option. [image](https://private-user-images.githubusercontent.com/20016567/302495485-c0d643ea-aeda-4f4d-8f5d-4d66aa0bd8b5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii8yMDAxNjU2Ny8zMDI0OTU0ODUtYzBkNjQzZWEtYWVkYS00ZjRkLThmNWQtNGQ2NmFhMGJkOGI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTcxNjlhMDFlOTczYWIxYWZmYjBlMTg3ZWM5YzRiYjFmNGE0MjYzMzZiM2M2MzZmNjlhNDI2YzQ4NWEyN2E2YjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Nx8vPVdOyxYx4vnV4WgHdn9e547k8hnmxBwplTsoKxw) Compare with an all purposes, all applications root certificate: [image](https://private-user-images.githubusercontent.com/20016567/302496346-a48e7d97-356a-4449-8277-15c1e6954e79.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii8yMDAxNjU2Ny8zMDI0OTYzNDYtYTQ4ZTdkOTctMzU2YS00NDQ5LTgyNzctMTVjMWU2OTU0ZTc5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTJkOTVhNmQyN2RjMmFkYzZlNTM5N2EzOGNjZjMzYTJjNjI3MGU1OTYwZTgwMzU0NmNkZTlhNTJkMzhiMWM4ZTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.zgM0ds-gN_nn1CGGOikro3-yWEfHDlbNP08zcESP-No) For MITM, Key Usage would need to have Certificate Signing. The RustDesk cert does not. [image](https://private-user-images.githubusercontent.com/20016567/302496959-34cfa73f-f6e5-4821-b644-303dc4bb02e8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii8yMDAxNjU2Ny8zMDI0OTY5NTktMzRjZmE3M2YtZjZlNS00ODIxLWI2NDQtMzAzZGM0YmIwMmU4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQwOWVmNDE1ZmNlYzZkZGM2ZTVmMDYyNGM2ZjA4Y2JmYzVhODU0MGRlMGM4ZjlkNWQxMmEzOTkzM2U5NzVmYTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NdUJ2_SYwBYi9qnbKjODcOJ1sKwTq91NG6zT4SXG_uI) So long as the properties are respected as Staja said. *(I tested with my own MITM/decryption cert, and they are respected in browsers--didn't test anything else)*  I am also inclined to believe that the certificate just needs some fine tuning for transparency and increased security. |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👍
6

All reactions

* 👍
  6

Comment options

# {{title}}

Something went wrong.

Quote reply

### [Feb 6, 2024](#discussioncomment-8378107) Maintainer

 -

| Ok, we will remove this idd driver since it brings so big trouble. Some functions (virtual display, privacy mode etc) will be lost. |
| --- |

Beta
Was this translation helpful?
Give feedback.

2
 You must be logged in to vote

All reactions

10 replies

Show 5 previous replies

[![@Hydro8](https://avatars.githubusercontent.com/u/5537697?s=60&v=4)](/Hydro8)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [Hydro8](/Hydro8) [Feb 7, 2024](#discussioncomment-8391447)

 -

| Do you know the list of features that will be lost ? |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@xlionjuan](https://avatars.githubusercontent.com/u/25243894?s=60&v=4)](/xlionjuan)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [xlionjuan](/xlionjuan) [Feb 7, 2024](#discussioncomment-8393309)

 -

| [@Hydro8](https://github.com/Hydro8) virtual display and privacy mode |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@danielmarschall](https://avatars.githubusercontent.com/u/28412477?s=60&v=4)](/danielmarschall)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [danielmarschall](/danielmarschall) [Feb 8, 2024](#discussioncomment-8401757)

 -

| When RustDesk is installed, there is a checkbox asking if the certificate should be installed or not. Wouldn't it be a solution to enable the features if the user chooses to install the cert, and disable the features if the user denies it? |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👍
1

All reactions

* 👍
  1

[![@danielmarschall](https://avatars.githubusercontent.com/u/28412477?s=60&v=4)](/danielmarschall)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [danielmarschall](/danielmarschall) [Feb 8, 2024](#discussioncomment-8401872)

 -

| If the Virtual Display feature is removed in the next version, would that mean that I can no longer establish an unattended connection to a terminal server that has no attached monitor and/or active user session? |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@florianbeisel](https://avatars.githubusercontent.com/u/591817?s=60&v=4)](/florianbeisel)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [florianbeisel](/florianbeisel) [Feb 8, 2024](#discussioncomment-8404861)

 -

| Frankly, as for 1,2, we do not know either, we are not expert in this field, maybe because it is test cert.  * why this certificat is in root store.  Because its explicitly installed there by `install_cert_runas_admin.bat` in the [RustDeskIddDriver](https://github.com/fufesou/RustDeskIddDriver).  ``` .\CertMgr.exe /add RustDeskIddDriver.cer /s /r localMachine root ``` |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [rustdesk](/rustdesk) [Feb 8, 2024](#discussioncomment-8402798) Maintainer

 -

| When RustDesk is installed, there is a checkbox asking if the certificate should be installed or not. Wouldn't it be a solution to enable the features if the user chooses to install the cert, and disable the features if the user denies it?  This is the current behavior, but it can not stop thread like this. |
| --- |

Beta
Was this translation helpful?
Give feedback.

2
 You must be logged in to vote

 👍
1
  😄
1

All reactions

* 👍
  1
* 😄
  1

1 reply

[![@danielmarschall](https://avatars.githubusercontent.com/u/28412477?s=60&v=4)](/danielmarschall)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [danielmarschall](/danielmarschall) [Feb 8, 2024](#discussioncomment-8405036)

 -

| [@rustdesk](https://github.com/rustdesk) Thank you for your quick reply. Can you please tell me if the Virtual Display feature is removed in the next version, would that mean that I can no longer establish an unattended connection to a terminal server that has no attached monitor and/or active user session? Or is the Virtual Display Driver just to make things a bit prettier (resolution, etc.)? |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👀
1

All reactions

* 👀
  1

Comment options

# {{title}}

Something went wrong.

Quote reply

### [joru1407](/joru1407) [Feb 15, 2024](#discussioncomment-8478181)

 -

| This driver which is only signed with the Test-Certificate also leads to issues with ESET for example. ESET detects the RustDeskIddDriver.dll under %LOCALAPPDATA%\rustdesk\RustDeskIddDriver as Suspicious Object, moves it to the Quarantine and warns the user about it. |
| --- |

Beta
Was this translation helpful?
Give feedback.

2
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [rustdesk](/rustdesk) [Feb 19, 2024](#discussioncomment-8521217) Maintainer

 -

| Fixed in latest release by removing our virtual display driver and cert, <https://github.com/rustdesk/rustdesk/releases/latest>. It will be restored once we get an EV, 1 month or more. Thanks for everyone who are giving help on EV  <https://techcommunity.microsoft.com/t5/windows-hardware-certification/driver-signing-changes-in-windows-10/ba-p/364859> <https://learn.microsoft.com/en-us/windows-hardware/drivers/dashboard/code-signing-reqs#ev-certificate-signed-drivers> <https://www.ssl.com/how-to/register-with-windows-hardware-developer-program/> <https://www.ssl.com/how-to/signing-kernel-mode-drivers-for-windows-using-evcs-or-ovcs-certificates/> <https://learn.microsoft.com/en-us/answers/questions/313092/user-mode-driver-signing-process> <https://partner.microsoft.com/en-us/dashboard/Registration/Tenant/Hardware?step=GetStarted?step=GetStarted> Though we can not provide virtual display driver (for those having no display) for the time being, you can still install from 3rd party. [#222 (comment)](https://github.com/rustdesk/rustdesk/issues/222#issuecomment-1145626102), you can find more virtual display in this [discussion](https://github.com/pavlobu/deskreen/discussions/86).  please do not use [#6682 (comment)](https://github.com/rustdesk/rustdesk/issues/6682#issuecomment-1888704092), since it uses test cert as us also. Or buy a HDMI plug. [#222 (comment)](https://github.com/rustdesk/rustdesk/issues/222#issuecomment-1145644431) |
| --- |

Beta
Was this translation helpful?
Give feedback.

Marked as answer

3
 You must be logged in to vote

 👍
2

All reactions

* 👍
  2

2 replies

[![@grenelt](https://avatars.githubusercontent.com/u/474834?s=60&v=4)](/grenelt)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [grenelt](/grenelt) [Feb 21, 2024](#discussioncomment-8541215)

 -

| *Virtual Display Drivers Knowledge Base | Getting Rid From Display Dummy Plugs*  [pavlobu/deskreen#86](https://github.com/pavlobu/deskreen/discussions/86) |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👍
1

All reactions

* 👍
  1

[![@grenelt](https://avatars.githubusercontent.com/u/474834?s=60&v=4)](/grenelt)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [grenelt](/grenelt) [Feb 21, 2024](#discussioncomment-8541243)

 -

| *(VGA Hack) How To Make a VGA Dummy Plug*  <https://www.geeks3d.com/20091230/vga-hack-how-to-make-a-vga-dummy-plug/> |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👍
2

All reactions

* 👍
  2

Answer selected by
[rustdesk](/rustdesk)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [fragtion](/fragtion) [Mar 2, 2024](#discussioncomment-8650972)

 -

| I'm using this on an internal LAN (no risks of exploiting) where I don't care about this vulnerability but the feature is essential for me / "I accept the risks". Very disappointed to install latest nightly and the feature is gone, and sadly I replaced old installer binary. Can someone please share nightly build from 18 February 2024 or thereabout? I have a build from Dec 2023 but I would prefer more recent build. Thanks |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

2 replies

[![@xlionjuan](https://avatars.githubusercontent.com/u/25243894?s=60&v=4)](/xlionjuan)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [xlionjuan](/xlionjuan) [Mar 2, 2024](#discussioncomment-8651397)

 -

| <https://github.com/itsmikethetech/Virtual-Display-Driver> |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@rustdesk](https://avatars.githubusercontent.com/u/71636191?s=60&v=4)](/rustdesk)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [rustdesk](/rustdesk) [Mar 22, 2024](#discussioncomment-8874832) Maintainer

 -

| This one is not verified and signed either, take your risk to use it. |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👍
2

All reactions

* 👍
  2

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [rustdesk](/rustdesk) [Mar 12, 2024](#discussioncomment-8762754) Maintainer

 -

| Update: we have got EV, now we are waiting for Microsoft hardware developer account ready, [@microsoft](https://github.com/microsoft) needs to verify the company profile and domain again, the process is very slow. |
| --- |

Beta
Was this translation helpful?
Give feedback.

6
 You must be logged in to vote

 👍
7
  😄
1
  🎉
1
  🚀
4

All reactions

* 👍
  7
* 😄
  1
* 🎉
  1
* 🚀
  4

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

### [vitusb](/vitusb) [Mar 20, 2024](#discussioncomment-8851127) Author

 -

| Thank you all for your support ! Good Job 🙏🏼 👍🏼 ... |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

 👍
1

All reactions

* 👍
  1

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [rustdesk](/rustdesk) [Mar 22, 2024](#discussioncomment-8872272) Maintainer

 -

| Update: <https://twitter.com/rustdesk/status/1770983662571733227> |
| --- |

Beta
Was this translation helpful?
Give feedback.

3
 You must be logged in to vote

 👍
1
  👀
3

All reactions

* 👍
  1
* 👀
  3

2 replies

[![@rustdesk](https://avatars.githubusercontent.com/u/71636191?s=60&v=4)](/rustdesk)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [rustdesk](/rustdesk) [Mar 28, 2024](#discussioncomment-8935775) Maintainer

 -

| Update: I have sent mail again and again, no reply so far about the progress. |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👍
1
  😕
2

All reactions

* 👍
  1
* 😕
  2

[![@vgcouso](https://avatars.githubusercontent.com/u/7522471?s=60&v=4)](/vgcouso)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [vgcouso](/vgcouso) [Mar 28, 2024](#discussioncomment-8938451)

 -

| Thank you for spending so much time on this. Luck |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

Comment options

# {{title}}

Something went wrong.

Quote reply

edited by rustdesk

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [TGeRi](/TGeRi) [Apr 4, 2024](#discussioncomment-9007009)

 -

| Hi! This bug is still present in a way! When I install Rustdesk (official build) v1.2.3-1 on a fresh PC (test PC is Win11 23H2 for me) the cert IS NOT installed, but a new CERTIFICATE STORE (with the chinese text as the name of this "certificate folder") IS created in Windows. It is empty, but Rustdesk install creates it nontheless.  [image](https://private-user-images.githubusercontent.com/16209303/319513051-16f0a75e-a747-422c-bf44-41d901a87e1f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii8xNjIwOTMwMy8zMTk1MTMwNTEtMTZmMGE3NWUtYTc0Ny00MjJjLWJmNDQtNDFkOTAxYTg3ZTFmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTAwMmQ0MmYwYjg3NzM2YjY4ZDUzNWUyYTI4MmRkMWM0YzQ0MWI1ZmIwOTE5YTZkNDM4MTVlNGZmZTU0YTFkMTgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.pzxG1DmmSs5G8UgTe9dxGjL3iOeLrX0Txok6W0Hf2WM)  It could be concerning for users as Google translate is this for that chinese text:  [image](https://private-user-images.githubusercontent.com/16209303/319513382-deb7d588-2b61-4467-b462-feb64c84c462.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii8xNjIwOTMwMy8zMTk1MTMzODItZGViN2Q1ODgtMmI2MS00NDY3LWI0NjItZmViNjRjODRjNDYyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNlNzYxZWI5NWZhMjI2MTNhZTRjNmE4NGQ4MDExYTY5OTQ5YjExMTEyNGNmMzYyMTkxNTQzZDgxODQ3OTIwMjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.4DdvKelMvzIOwntzkLfYzmpkzCpFYMMDPFjBjgQKB-4) :) Correct This is not chinese text, it is garble code. |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

5 replies

[![@fufesou](https://avatars.githubusercontent.com/u/13586388?s=60&v=4)](/fufesou)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

#### [fufesou](/fufesou) [Apr 4, 2024](#discussioncomment-9007561) Collaborator

 -

| This is so strange.  I checked the code of 1.2.3-1 again and it will not try install the cert.  Unless someone has administrator rights and manually executes the command, this is equivalent to using certmgr.exe.     [rustdesk/src/core\_main.rs](https://github.com/rustdesk/rustdesk/blob/a71ec3e0e740c69c188641d4818d606201bbe1b4/src/core_main.rs#L205)  Line 205 in [a71ec3e](/rustdesk/rustdesk/commit/a71ec3e0e740c69c188641d4818d606201bbe1b4)   |  | hbb\_common::allow\_err!(crate::platform::windows::install\_cert(&args[1])); | | --- | --- |      Did you only install 1.2.3-1 and no other versions of RustDesk on your fresh PC? 1.2.3-1 does not have a certificate file, and install\_cert will return at the entrance.     [rustdesk/src/platform/windows.rs](https://github.com/rustdesk/rustdesk/blob/a71ec3e0e740c69c188641d4818d606201bbe1b4/src/platform/windows.rs#L1923)  Line 1923 in [a71ec3e](/rustdesk/rustdesk/commit/a71ec3e0e740c69c188641d4818d606201bbe1b4)   |  | let mut cert\_bytes = std::fs::read(path)?; | | --- | --- |      Did you perform any other operations on your new computer? I think this is more likely due to other reasons. |
| --- | --- | --- | --- | --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@danielmarschall](https://avatars.githubusercontent.com/u/28412477?s=60&v=4)](/danielmarschall)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

#### [danielmarschall](/danielmarschall) [Apr 4, 2024](#discussioncomment-9008537)

 -

| Actually, I have this too. But I don't know when it was created. Could have been before 2.3.1-1. I have two roots, one with a certificate in it, and one without. I have now deleted the certificate, uninstalled rustdesk, and installed nightly, and it is NOT created again.  [image](https://private-user-images.githubusercontent.com/28412477/319566901-256b745d-aefc-4532-a949-363f3847cf14.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii8yODQxMjQ3Ny8zMTk1NjY5MDEtMjU2Yjc0NWQtYWVmYy00NTMyLWE5NDktMzYzZjM4NDdjZjE0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM5OGRiNTQ2MTQ2MjU5NGEyYTRkMmY3NzIxYjNiOWU2YTU0OTI1YmYwN2JhYmQzNGUwNmM3YjRkNzA0MDc4ZWUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.SFxI99ykgfru5mOHaLXMBCeSd0X2VRo7w_VY5lKZVqk)  Unfortunately, I cannot delete the branches! They are there, even if no certificate is inside. How can I delete them?  EDIT: Additional note: Actually, I had the WDKTest certificate in this Chinese Characters Certificate Store, as well as in the "Trusted Publishers Certificate Store". |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@fufesou](https://avatars.githubusercontent.com/u/13586388?s=60&v=4)](/fufesou)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

#### [fufesou](/fufesou) [Apr 4, 2024](#discussioncomment-9009763) Collaborator

 -

| Sorry for causing trouble to you guys.  You can delete strange branches by deleting the corresponding entries in regedit.   1. Open "certmgr.msc" 2. Open "regedit", delete the strange items. 3. Close and open "certmgr.msc".   If there're stille some strange items, you may not delete all items in "regedit". Refresh "regedit" and delete again.    b.mp4     **NOTE**  There should be more than one place, you may need to find "Ctrl + F" to search the registry.  ``` Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SystemCertificates Computer\HKEY_CURRENT_USER\Software\Microsoft\SystemCertificates Computer\HKEY_CURRENT_USER\Software\Microsoft\SystemCertificates\UserDS  ``` |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@fufesou](https://avatars.githubusercontent.com/u/13586388?s=60&v=4)](/fufesou)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

#### [fufesou](/fufesou) [Apr 4, 2024](#discussioncomment-9009933) Collaborator

 -

| [@TGeRi](https://github.com/TGeRi) Confirmed. My PC creates this strange "certificate folder" too, after installing 1.2.3-1.  I'll try find out what causes this strange behavior. |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@fufesou](https://avatars.githubusercontent.com/u/13586388?s=60&v=4)](/fufesou)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

#### [fufesou](/fufesou) [Apr 5, 2024](#discussioncomment-9017532) Collaborator

 -

| This code causes the strange cert directory.     [rustdesk/src/platform/windows.rs](https://github.com/rustdesk/rustdesk/blob/a71ec3e0e740c69c188641d4818d606201bbe1b4/src/platform/windows.rs#L1982)  Line 1982 in [a71ec3e](/rustdesk/rustdesk/commit/a71ec3e0e740c69c188641d4818d606201bbe1b4)   |  | let store\_handle = CertOpenSystemStoreW(0 as \_, "ROOT\0".as\_ptr() as \_); | | --- | --- |      The corresponding C++ code is  ``` #pragma comment(lib, "crypt32.lib")  #include <Windows.h> #include <iostream>  int main(int argc, char* argv) { 	HCERTSTORE handle = CertOpenSystemStoreW(NULL, (LPCWSTR)"ROOT"); 	return 0; } ```  1.2.3-1 will not install the cert. But it will try to remove the old test certs.  It tries to read the certs in `ROOT` , then find the issuer of `"CN=\"WDKTestCert admin,133225435702113567\"\0"`. Remove all it's related certs. It will found no certs, and do nothing. But the directory is created and left there.  I'll try the code [#6444 (reply in thread)](https://github.com/rustdesk/rustdesk/discussions/6444#discussioncomment-9014382) to remove the strange directories. |
| --- | --- | --- |

Beta
Was this translation helpful?
Give feedback.

 👀
1

All reactions

* 👀
  1

Comment options

# {{title}}

Something went wrong.

Quote reply

edited by rustdesk

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [hackgrid](/hackgrid) [Apr 4, 2024](#discussioncomment-9008628)

 -

| You can check in a freshly installed VM whether RustDesk really is responsible for that Chinese certificate! ## Correct This is not chinese certficate, it is garble code. |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

26 replies

Show 21 previous replies

[![@danielmarschall](https://avatars.githubusercontent.com/u/28412477?s=60&v=4)](/danielmarschall)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [danielmarschall](/danielmarschall) [Apr 6, 2024](#discussioncomment-9030797)

 -

| For my system(s) the test certs are in up to 4 locations:   * Trusted Publishers (only 1 system) * Trusted Root Certification Authorities * Short chinese dir * Long chinese dir (only 1 system)   this is why [ab07eb6](https://github.com/rustdesk/rustdesk/commit/ab07eb6f4a7df73aac12f295fb5b6775c1f14961) deletes the test certs from all stores of all users. This is very important. I don't know how it happened that the test certs spread in 4 different stores, but they did somehow. |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@fufesou](https://avatars.githubusercontent.com/u/13586388?s=60&v=4)](/fufesou)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [fufesou](/fufesou) [Apr 6, 2024](#discussioncomment-9031080) Collaborator

 -

| It would be very important that it gets deleted from all stores, because I still don't understand why on some of my machines the certificate was in "Trusted Publishers" (which is as bad as "Trusted Root Certification Authorities") And the Rust code, will it also delete the wrong certificates from other users? This would also be important, because only user "X" will install/uninstall/update RustDesk, but there might be users "Y" and "Z" on that system (maybe other users with admin rights on a Terminal Server, who have previously installed and old RustDesk version).  I'll find a better way to delete all the certificates. Because the fingerprint is SHA1 hash of the cert. Simply delete "D1DBB672D5A500B9809689CAEA1CE49E799767F0" in the correct stores is not safe.   1. Traverse the SystemStore and find all stores and fingerprints where the issuer is CN="WDKTestCert admin,133225435702113567". Then delete. 2. Delete the certificate in the wrong store. 3. Delete the empty wrong store. |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@danielmarschall](https://avatars.githubusercontent.com/u/28412477?s=60&v=4)](/danielmarschall)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

#### [danielmarschall](/danielmarschall) [Apr 6, 2024](#discussioncomment-9031153)

 -

| I am not familiar with the cryptapi, but I understand that CertOpenSystemStoreW() only opens HKLM but not any user store (and not other users stores)?  I wonder, would you feel more comfortable if the blob contents of the D1DBB672D5A500B9809689CAEA1CE49E799767F0 key are binary compared? The chance that a different certificate has the same SHA1 finger print is 2^160, so I think it is safe to assume the key with hash D1DBB672D5A500B9809689CAEA1CE49E799767F0 is the key we are looking for. Just parsing the cert and looking at the "CN" is much more ambiguous and can be freely chosen by humans.  If you want to make 100% sure, then you can analyze the Blob field. (Edit: see post below) |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

[![@danielmarschall](https://avatars.githubusercontent.com/u/28412477?s=60&v=4)](/danielmarschall)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

#### [danielmarschall](/danielmarschall) [Apr 6, 2024](#discussioncomment-9031321)

 -

| [@fufesou](https://github.com/fufesou) [@rustdesk](https://github.com/rustdesk)  What do you think about that? <https://gist.github.com/danielmarschall/0fadded4dbba7d790cc0f40723ec5990>  (Edit: Small change fixed in re management information. It now avoids to assume that the cert starts at offset 0x4C)  If you don't trust SHA1, then binary comparison is the way to go, then the tiny chance of collission changes from 2^160 to exactly 0.  I didn't look up the code how to read a blob from registry. I first wait if you like it or not. If you accept, than I will do the rest and implement it. |
| --- |

Beta
Was this translation helpful?
Give feedback.

 👍
2

All reactions

* 👍
  2

[![@rustdesk](https://avatars.githubusercontent.com/u/71636191?s=60&v=4)](/rustdesk)

Comment options

# {{title}}

Something went wrong.

Quote reply

#### [rustdesk](/rustdesk) [Apr 7, 2024](#discussioncomment-9033485) Maintainer

 -

| Thanks, [#7642](https://github.com/rustdesk/rustdesk/pull/7642) |
| --- |

Beta
Was this translation helpful?
Give feedback.

All reactions

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [rustdesk](/rustdesk) [Apr 10, 2024](#discussioncomment-9066178) Maintainer

 -

| Update, still no progress, you can email or call this [@microsoft](https://github.com/microsoft) support if you want to help.  [image](https://private-user-images.githubusercontent.com/71636191/321101635-d7e592ea-16a8-4c88-9541-24b1286acc9e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NDIzMDAsIm5iZiI6MTczNjU0MjAwMCwicGF0aCI6Ii83MTYzNjE5MS8zMjExMDE2MzUtZDdlNTkyZWEtMTZhOC00Yzg4LTk1NDEtMjRiMTI4NmFjYzllLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDIwNDY0MFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWYxZTBjYTBmODBhNGZmOGVjODJlZWU0NDA1NGQ0YTUzZDA3MGM1ZjcyY2QxZTdlNDA3YmJiNmE0NDkzY2E1NWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.B3PAUfHokgTEYy7P6F1g2Sn30Nl0mK33gzK2X1zrgLI) |
| --- |

Beta
Was this translation helpful?
Give feedback.

2
 You must be logged in to vote

 😕
1

All reactions

* 😕
  1

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

### [Apr 19, 2024](#discussioncomment-9164966) Maintainer

 -

| Update: <https://twitter.com/rustdesk/status/1781263566504653052> |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

 👀
1

All reactions

* 👀
  1

0 replies

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frustdesk%2Frustdesk%2Fdiscussions%2F6444)

Category

[🙏

Q&A](/rustdesk/rustdesk/discussions/categories/q-a)

Labels

[bug](/rustdesk/rustdesk/discussions?discussions_q=label%3Abug)
Something isn't working

19 participants

[![@vitusb](https://avatars.githubusercontent.com/u/83558069?s=48&v=4)](/vitusb) [![@hackgrid](https://avatars.githubusercontent.com/u/54060?s=48&v=4)](/hackgrid) [![@grenelt](https://avatars.githubusercontent.com/u/474834?s=48&v=4)](/grenelt) [![@florianbeisel](https://avatars.githubusercontent.com/u/591817?s=48&v=4)](/florianbeisel) [![@fragtion](https://avatars.githubusercontent.com/u/2876889?s=48&v=4)](/fragtion) [![@x011](https://avatars.githubusercontent.com/u/4313821?s=48&v=4)](/x011) [![@Hydro8](https://avatars.githubusercontent.com/u/5537697?s=48&v=4)](/Hydro8) [![@vgcouso](https://avatars.githubusercontent.com/u/7522471?s=48&v=4)](/vgcouso) [![@deep-soft](https://avatars.githubusercontent.com/u/10506197?s=48&v=4)](/deep-soft) [![@Staja](https://avatars.githubusercontent.com/u/11882223?s=48&v=4)](/Staja) [![@fufesou](https://avatars.githubusercontent.com/u/13586388?s=48&v=4)](/fufesou) [![@TGeRi](https://avatars.githubusercontent.com/u/16209303?s=48&v=4)](/TGeRi) [![@Zakkaruu](https://avatars.githubusercontent.com/u/20016567?s=48&v=4)](/Zakkaruu) [![@xlionjuan](https://avatars.githubusercontent.com/u/25243894?s=48&v=4)](/xlionjuan) [![@danielmarschall](https://avatars.githubusercontent.com/u/28412477?s=48&v=4)](/danielmarschall) [![@nOrphf](https://avatars.githubusercontent.com/u/54571822?s=48&v=4)](/nOrphf) [![@joru1407](https://avatars.githubusercontent.com/u/65429097?s=48&v=4)](/joru1407) [![@rustdesk](https://avatars.githubusercontent.com/u/71636191?s=48&v=4)](/rustdesk) [![@ForDefault](https://avatars.githubusercontent.com/u/106802923?s=48&v=4)](/ForDefault)

Converted from issue

This discussion was converted from issue #6437 on November 17, 2023 01:03.

Heading

Bold

Italic

Quote

Code

Link

---

Numbered list

Unordered list

Task list

---

Attach files

Mention

Reference

Menu

* Heading
* Bold
* Italic
* Quote
* Code
* Link
* Numbered list
* Unordered list
* Task list
* Attach files
* Mention
* Reference

# Select a reply

 Loading

  [Create a new saved reply](/settings/replies?return_to=1)

 👍
1
  reacted with thumbs up emoji

 👎
1
  reacted with thumbs down emoji

 😄
1
  reacted with laugh emoji

 🎉
1
  reacted with hooray emoji

 😕
1
  reacted with confused emoji

 ❤️
1
  reacted with heart emoji

 🚀
1
  reacted with rocket emoji

 👀
1
  reacted with eyes emoji

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

