
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstealjs%2Fsteal%2Fblob%2Fc9dd1eb19ed3f97aeb93cf9dcea5d68ad5d0ced9%2Fmain.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstealjs%2Fsteal%2Fblob%2Fc9dd1eb19ed3f97aeb93cf9dcea5d68ad5d0ced9%2Fmain.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=stealjs%2Fsteal)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stealjs](/stealjs)
/
**[steal](/stealjs/steal)**
Public

* [Notifications](/login?return_to=%2Fstealjs%2Fsteal) You must be signed in to change notification settings
* [Fork
  522](/login?return_to=%2Fstealjs%2Fsteal)
* [Star
   1.4k](/login?return_to=%2Fstealjs%2Fsteal)

* [Code](/stealjs/steal)
* [Issues
  95](/stealjs/steal/issues)
* [Pull requests
  2](/stealjs/steal/pulls)
* [Actions](/stealjs/steal/actions)
* [Projects
  0](/stealjs/steal/projects)
* [Wiki](/stealjs/steal/wiki)
* [Security](/stealjs/steal/security)
* [Insights](/stealjs/steal/pulse)

Additional navigation options

* [Code](/stealjs/steal)
* [Issues](/stealjs/steal/issues)
* [Pull requests](/stealjs/steal/pulls)
* [Actions](/stealjs/steal/actions)
* [Projects](/stealjs/steal/projects)
* [Wiki](/stealjs/steal/wiki)
* [Security](/stealjs/steal/security)
* [Insights](/stealjs/steal/pulse)

## Files

 c9dd1eb
## Breadcrumbs

1. [steal](/stealjs/steal/tree/c9dd1eb19ed3f97aeb93cf9dcea5d68ad5d0ced9)
/
# main.js

 Blame  Blame
## Latest commit

## History

[History](/stealjs/steal/commits/c9dd1eb19ed3f97aeb93cf9dcea5d68ad5d0ced9/main.js)4931 lines (4197 loc) · 139 KB c9dd1eb
## Breadcrumbs

1. [steal](/stealjs/steal/tree/c9dd1eb19ed3f97aeb93cf9dcea5d68ad5d0ced9)
/
# main.js

Top
## File metadata and controls

* Code
* Blame

4931 lines (4197 loc) · 139 KB[Raw](https://github.com/stealjs/steal/raw/c9dd1eb19ed3f97aeb93cf9dcea5d68ad5d0ced9/main.js)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000(function(global){
 // helpers var camelize = function(str){ return str.replace(/-+(.)?/g, function(match, chr){ return chr ? chr.toUpperCase() : '' }); }, each = function( o, cb){ var i, len;
 // weak array detection, but we only use this internally so don't // pass it weird stuff if ( typeof o.length == 'number' && (o.length - 1) in o) { for ( i = 0, len = o.length; i < len; i++ ) { cb.call(o[i], o[i], i, o); } } else { for ( i in o ) { if(o.hasOwnProperty(i)){ cb.call(o[i], o[i], i, o); } } } return o; }, map = function(o, cb) { var arr = []; each(o, function(item, i){ arr[i] = cb(item, i); }); return arr; }, isString = function(o) { return typeof o == "string"; }, extend = function(d,s){ each(s, function(v, p){ d[p] = v; }); return d; }, dir = function(uri){ var lastSlash = uri.lastIndexOf("/"); //if no / slashes, check for \ slashes since it might be a windows path if(lastSlash === -1) lastSlash = uri.lastIndexOf("\\"); if(lastSlash !== -1) { return uri.substr(0, lastSlash); } else { return uri; } }, last = function(arr){ return arr[arr.length - 1]; }, parseURI = function(url) { var m = String(url).replace(/^\s+|\s+$/g, '').match(/^([^:\/?#]+:)?(\/\/(?:[^:@\/]\*(?::[^:@\/]\*)?@)?(([^:\/?#]\*)(?::(\d\*))?))?([^?#]\*)(\?[^#]\*)?(#[\s\S]\*)?/); // authority = '//' + user + ':' + pass '@' + hostname + ':' port return (m ? { href : m[0] || '', protocol : m[1] || '', authority: m[2] || '', host : m[3] || '', hostname : m[4] || '', port : m[5] || '', pathname : m[6] || '', search : m[7] || '', hash : m[8] || '' } : null); }, joinURIs = function(base, href) { function removeDotSegments(input) { var output = []; input.replace(/^(\.\.?(\/|$))+/, '') .replace(/\/(\.(\/|$))+/g, '/') .replace(/\/\.\.$/, '/../') .replace(/\/?[^\/]\*/g, function (p) { if (p === '/..') { output.pop(); } else { output.push(p); } }); return output.join('').replace(/^\//, input.charAt(0) === '/' ? '/' : ''); }
 href = parseURI(href || ''); base = parseURI(base || '');
 return !href || !base ? null : (href.protocol || base.protocol) + (href.protocol || href.authority ? href.authority : base.authority) + removeDotSegments(href.protocol || href.authority || href.pathname.charAt(0) === '/' ? href.pathname : (href.pathname ? ((base.authority && !base.pathname ? '/' : '') + base.pathname.slice(0, base.pathname.lastIndexOf('/') + 1) + href.pathname) : base.pathname)) + (href.protocol || href.authority || href.pathname ? href.search : (href.search || base.search)) + href.hash; }, relativeURI = function(base, path) { var uriParts = path.split("/"), baseParts = base.split("/"), result = []; while ( uriParts.length && baseParts.length && uriParts[0] == baseParts[0] ) { uriParts.shift(); baseParts.shift(); } for(var i = 0 ; i< baseParts.length-1; i++) { result.push("../"); } return "./" + result.join("") + uriParts.join("/"); }, fBind = Function.prototype.bind, isFunction = function(obj) { return !!(obj && obj.constructor && obj.call && obj.apply); }, isWebWorker = typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope, isNode = typeof process === "object" && {}.toString.call(process) === "[object process]", isBrowserWithWindow = !isNode && typeof window !== "undefined", isNW = isNode && (function(){ try { return require("nw.gui") !== "undefined"; } catch(e) { return false; } })(), isElectron = isNode && !!process.versions["electron"], isNode = isNode && !isNW && !isElectron, hasAWindow = isBrowserWithWindow || isNW || isElectron, getStealScript = function(){ if(isBrowserWithWindow || isNW || isElectron) { if(document.currentScript) { return document.currentScript; } var scripts = document.scripts;
 if (scripts.length) { var currentScript = scripts[scripts.length - 1]; return currentScript; } } }, stealScript = getStealScript(), warn = typeof console === "object" ? fBind.call(console.warn, console) : function(){};
 var filename = function(uri){ var lastSlash = uri.lastIndexOf("/"); //if no / slashes, check for \ slashes since it might be a windows path if(lastSlash === -1) lastSlash = uri.lastIndexOf("\\"); var matches = ( lastSlash == -1 ? uri : uri.substr(lastSlash+1) ).match(/^[\w-\s\.!]+/); return matches ? matches[0] : ""; };
 var ext = function(uri){ var fn = filename(uri); var dot = fn.lastIndexOf("."); if(dot !== -1) { return fn.substr(dot+1); } else { return ""; } };
 var pluginCache = {};
 var normalize = function(unnormalizedName, loader){ var name = unnormalizedName;
 // Detech if this name contains a plugin part like: app.less!steal/less // and catch the plugin name so that when it is normalized we do not perform // Steal's normalization against it. var pluginIndex = name.lastIndexOf('!'); var pluginPart = ""; if (pluginIndex != -1) { // argumentName is the part before the ! var argumentName = name.substr(0, pluginIndex); var pluginName = name.substr(pluginIndex + 1); pluginPart = "!" + pluginName;
 // Set the name to the argument name so that we can normalize it alone. name = argumentName; }
 var last = filename(name), extension = ext(name); // if the name ends with / if( name[name.length -1] === "/" ) { return name+filename( name.substr(0, name.length-1) ) + pluginPart; } else if( !/^(\w+(?:s)?:\/\/|\.|file|\/)/.test(name) && // and doesn't end with a dot last.indexOf(".") === -1 ) { return name+"/"+last + pluginPart; } else { if(extension === "js") { return name.substr(0, name.lastIndexOf(".")) + pluginPart; } else { return name + pluginPart; } } };
var cloneSteal = function(System){ var loader = System || this.System; var steal = makeSteal(loader.clone()); steal.loader.set("@steal", steal.loader.newModule({ "default": steal, \_\_useDefault: true })); steal.clone = cloneSteal; return steal;};
var ArraySet;if(typeof Set === "function") { ArraySet = Set;} else { ArraySet = function(){ this.\_items = []; }; ArraySet.prototype.has = function(item) { return this.\_items.indexOf(item) !== -1; }; ArraySet.prototype.add = function(item) { if(!this.has(item)) { this.\_items.push(item); } };}
var makeSteal = function(System){ var addStealExtension = function (extensionFn) { if (typeof System !== "undefined" && isFunction(extensionFn)) { if (System.\_extensions) { System.\_extensions.push(extensionFn); } extensionFn(System, steal); } };
 System.set('@loader', System.newModule({ 'default': System, \_\_useDefault: true }));
 System.set("less", System.newModule({ \_\_useDefault: true, default: { fetch: function() { throw new Error( [ "steal-less plugin must be installed and configured properly", "See https://stealjs.com/docs/steal-less.html" ].join("\n") ); } } }));
 System.config({ map: { "@loader/@loader": "@loader", "@steal/@steal": "@steal" } });
 var configPromise, devPromise, appPromise;
 var steal = function(){ var args = arguments; var afterConfig = function(){ var imports = []; var factory; each(args, function(arg){ if(isString(arg)) { imports.push( steal.System['import']( normalize(arg) ) ); } else if(typeof arg === "function") { factory = arg; } });
 var modules = Promise.all(imports); if(factory) { return modules.then(function(modules) { return factory && factory.apply(null, modules); }); } else { return modules; } }; if(System.isEnv("production")) { return afterConfig(); } else { // wait until the config has loaded return configPromise.then(afterConfig,afterConfig); }
 };
 System.set("@steal", System.newModule({ "default": steal, \_\_useDefault:true })); System.Set = ArraySet;
 var loaderClone = System.clone; System.clone = function(){ var loader = loaderClone.apply(this, arguments); loader.set("@loader", loader.newModule({ "default": loader, \_\_useDefault: true })); loader.set("@steal", loader.newModule({ "default": steal, \_\_useDefault: true })); loader.Set = ArraySet; return loader; };
 // steal.System remains for backwards compat only steal.System = steal.loader = System; steal.parseURI = parseURI; steal.joinURIs = joinURIs; steal.normalize = normalize; steal.relativeURI = relativeURI; steal.addExtension = addStealExtension;
// System-Ext// This normalize-hook does 2 things.// 1. with specify a extension in your config// you can use the "!" (bang) operator to load// that file with the extension// System.ext = {bar: "path/to/bar"}// foo.bar! -> foo.bar!path/to/bar// 2. if you load a javascript file e.g. require("./foo.js")// normalize will remove the ".js" to load the moduleaddStealExtension(function addExt(loader) { loader.ext = {};
 var normalize = loader.normalize, endingExtension = /\.(\w+)!?$/;
 loader.normalize = function (name, parentName, parentAddress, pluginNormalize) { if (pluginNormalize) { return normalize.apply(this, arguments); }
 var matches = name.match(endingExtension); var outName = name;
 if (matches) { var hasBang = name[name.length - 1] === "!", ext = matches[1]; // load js-files nodd-like if (parentName && loader.configMain !== name && matches[0] === '.js') { outName = name.substr(0, name.lastIndexOf(".")); // matches ext mapping } else if (loader.ext[ext]) { outName = name + (hasBang ? "" : "!") + loader.ext[ext]; } } return normalize.call(this, outName, parentName, parentAddress); };});
// Steal Locate Extension// normalize a given path e.g.// "path/to/folder/" -> "path/to/folder/folder"addStealExtension(function addForwardSlash(loader) { var normalize = loader.normalize; var npmLike = /@.+#.+/;
 loader.normalize = function (name, parentName, parentAddress, pluginNormalize) { var lastPos = name.length - 1, secondToLast, folderName, newName = name;
 if (name[lastPos] === "/") { secondToLast = name.substring(0, lastPos).lastIndexOf("/"); folderName = name.substring(secondToLast + 1, lastPos); if (npmLike.test(folderName)) { folderName = folderName.substr(folderName.lastIndexOf("#") + 1); }
 newName += folderName; } return normalize.call(this, newName, parentName, parentAddress, pluginNormalize); };});
// override loader.translate to rewrite 'locate://' & 'pkg://' path schemes found// in resources loaded by supporting pluginsaddStealExtension(function addLocateProtocol(loader) { /\*\* \* @hide \* @function normalizeAndLocate \* @description Run a module identifier through Normalize and Locate hooks. \* @param {String} moduleName The module to run through normalize and locate. \* @return {Promise} A promise to resolve when the address is found. \*/ var normalizeAndLocate = function(moduleName, parentName){ var loader = this; return Promise.resolve(loader.normalize(moduleName, parentName)) .then(function(name){ return loader.locate({name: name, metadata: {}}); }).then(function(address){ var outAddress = address; if(address.substr(address.length - 3) === ".js") { outAddress = address.substr(0, address.length - 3); } return outAddress; }); };
 var relative = function(base, path){ var uriParts = path.split("/"), baseParts = base.split("/"), result = [];
 while ( uriParts.length && baseParts.length && uriParts[0] == baseParts[0] ) { uriParts.shift(); baseParts.shift(); }
 for(var i = 0 ; i< baseParts.length-1; i++) { result.push("../"); }
 return result.join("") + uriParts.join("/"); };
 var schemePattern = /(locate):\/\/([a-z0-9/.\_@-]\*)/ig, parsePathSchemes = function(source, parent) { var locations = []; source.replace(schemePattern, function(whole, scheme, path, index){ locations.push({ start: index, end: index+whole.length, name: path, postLocate: function(address){ return relative(parent, address); } }); }); return locations; };
 var \_translate = loader.translate; loader.translate = function(load){ var loader = this;
 // This only applies to plugin resources. if(!load.metadata.plugin) { return \_translate.call(this, load); }
 // Use the translator if this file path scheme is supported by the plugin var locateSupport = load.metadata.plugin.locateScheme; if(!locateSupport) { return \_translate.call(this, load); }
 // Parse array of module names var locations = parsePathSchemes(load.source, load.address);
 // no locations found if(!locations.length) { return \_translate.call(this, load); }
 // normalize and locate all of the modules found and then replace those instances in the source. var promises = []; for(var i = 0, len = locations.length; i < len; i++) { promises.push( normalizeAndLocate.call(this, locations[i].name, load.name) ); } return Promise.all(promises).then(function(addresses){ for(var i = locations.length - 1; i >= 0; i--) { load.source = load.source.substr(0, locations[i].start) + locations[i].postLocate(addresses[i]) + load.source.substr(locations[i].end, load.source.length); } return \_translate.call(loader, load); }); };});
addStealExtension(function addContextual(loader) { loader.\_contextualModules = {};
 loader.setContextual = function(moduleName, definer){ this.\_contextualModules[moduleName] = definer; };
 var normalize = loader.normalize; loader.normalize = function(name, parentName){ var loader = this; var pluginLoader = loader.pluginLoader || loader;
 if (parentName) { var definer = this.\_contextualModules[name];
 // See if `name` is a contextual module if (definer) { var localName = name + '/' + parentName;
 if(!loader.has(localName)) { // `definer` could be a function or could be a moduleName if (typeof definer === 'string') { definer = pluginLoader['import'](definer); }
 return Promise.resolve(definer) .then(function(modDefiner) { var definer = modDefiner; if (definer['default']) { definer = definer['default']; } var definePromise = Promise.resolve( definer.call(loader, parentName) ); return definePromise; }) .then(function(moduleDef){ loader.set(localName, loader.newModule(moduleDef)); return localName; }); } return Promise.resolve(localName); } }
 return normalize.apply(this, arguments); };});
/\*\* \* Steal Script-Module Extension \* \* Add a steal-module script to the page and it will run after Steal has been \* configured, e.g: \* \* <script type="text/steal-module">...</script> \* <script type="steal-module">...</script> \*/addStealExtension(function addStealModule(loader) { // taken from https://github.com/ModuleLoader/es6-module-loader/blob/master/src/module-tag.js function completed() { document.removeEventListener("DOMContentLoaded", completed, false); window.removeEventListener("load", completed, false); ready(); }
 function ready() { var scripts = document.getElementsByTagName("script"); for (var i = 0; i < scripts.length; i++) { var script = scripts[i]; if (script.type == "steal-module" || script.type == "text/steal-module") { var source = script.innerHTML; if (/\S/.test(source)) { loader.module(source)["catch"](function(err) { setTimeout(function() { throw err; }); }); } } } }
 loader.loadScriptModules = function() { if (isBrowserWithWindow) { if (document.readyState === "complete") { setTimeout(ready); } else if (document.addEventListener) { document.addEventListener("DOMContentLoaded", completed, false); window.addEventListener("load", completed, false); } } };});
// SystemJS Steal Format// Provides the Steal module format definition.addStealExtension(function addStealFormat(loader) { // Steal Module Format Detection RegEx // steal(module, ...) var stealRegEx = /(?:^\s\*|[}{\(\);,\n\?\&]\s\*)steal\s\*\(\s\*((?:"[^"]+"\s\*,|'[^']+'\s\*,\s\*)\*)/;
 // What we stole. var stealInstantiateResult;
 function createSteal(loader) { stealInstantiateResult = null;
 // ensure no NodeJS environment detection loader.global.module = undefined; loader.global.exports = undefined;
 function steal() { var deps = []; var factory;
 for( var i = 0; i < arguments.length; i++ ) { if (typeof arguments[i] === 'string') { deps.push( normalize(arguments[i]) ); } else { factory = arguments[i]; } }
 if (typeof factory !== 'function') { factory = (function(factory) { return function() { return factory; }; })(factory); }
 stealInstantiateResult = { deps: deps, execute: function(require, exports, moduleName) {
 var depValues = []; for (var i = 0; i < deps.length; i++) { depValues.push(require(deps[i])); }
 var output = factory.apply(loader.global, depValues);
 if (typeof output !== 'undefined') { return output; } } }; }
 loader.global.steal = steal; }
 var loaderInstantiate = loader.instantiate; loader.instantiate = function(load) { var loader = this;
 if (load.metadata.format === 'steal' || !load.metadata.format && load.source.match(stealRegEx)) { load.metadata.format = 'steal';
 var oldSteal = loader.global.steal;
 createSteal(loader);
 loader.\_\_exec(load);
 loader.global.steal = oldSteal;
 if (!stealInstantiateResult) { throw "Steal module " + load.name + " did not call steal"; }
 if (stealInstantiateResult) { load.metadata.deps = load.metadata.deps ? load.metadata.deps.concat(stealInstantiateResult.deps) : stealInstantiateResult.deps; load.metadata.execute = stealInstantiateResult.execute; } } return loaderInstantiate.call(loader, load); };});
addStealExtension(function addMetaDeps(loader) { var superTranspile = loader.transpile; var superDetermineFormat = loader.\_determineFormat;
 function prependDeps (loader, load, callback) { var meta = loader.meta[load.name]; if (meta && meta.deps && meta.deps.length) { var imports = meta.deps.map(callback).join('\n'); load.source = imports + "\n" + load.source; } }
 function createImport(dep) { return "import \"" + dep + "\";"; }
 function createRequire(dep) { return "require(\"" + dep + "\");"; }
 loader.transpile = function (load) { prependDeps(this, load, createImport); var result = superTranspile.apply(this, arguments); return result; }
 loader.\_determineFormat = function (load) { if(load.metadata.format === 'cjs') { prependDeps(this, load, createRequire); } var result = superDetermineFormat.apply(this, arguments); return result; };});
addStealExtension(function addStackTrace(loader) { function StackTrace(message, items) { this.message = message; this.items = items; }
 StackTrace.prototype.toString = function(){ var arr = ["Error: " + this.message]; var t, desc; for(var i = 0, len = this.items.length; i < len; i++) { t = this.items[i]; desc = " at "; if(t.fnName) { desc += (t.fnName + " "); } desc += StackTrace.positionLink(t); arr.push(desc); } return arr.join("\n"); };
 StackTrace.positionLink = function(t){ var line = t.line || 0; var col = t.column || 0; return "(" + t.url + ":" + line + ":" + col + ")"; };
 StackTrace.item = function(fnName, url, line, column) { return { method: fnName, fnName: fnName, url: url, line: line, column: column } };
 function parse(stack) { var rawLines = stack.split('\n');
 var v8Lines = compact(rawLines.map(parseV8Line)); if (v8Lines.length > 0) return v8Lines;
 var geckoLines = compact(rawLines.map(parseGeckoLine)); if (geckoLines.length > 0) return geckoLines;
 throw new Error('Unknown stack format: ' + stack); }
 // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\_Objects/Error/Stack var GECKO\_LINE = /^(?:([^@]\*)@)?(.\*?):(\d+)(?::(\d+))?$/;
 function parseGeckoLine(line) { var match = line.match(GECKO\_LINE); if (!match) return null; var meth = match[1] || '' return { method: meth, fnName: meth, url: match[2] || '', line: parseInt(match[3]) || 0, column: parseInt(match[4]) || 0, }; }
 // https://code.google.com/p/v8/wiki/JavaScriptStackTraceApi var V8\_OUTER1 = /^\s\*(eval )?at (.\*) \((.\*)\)$/; var V8\_OUTER2 = /^\s\*at()() (\S+)$/; var V8\_INNER = /^\(?([^\(]+):(\d+):(\d+)\)?$/;
 function parseV8Line(line) { var outer = line.match(V8\_OUTER1) || line.match(V8\_OUTER2); if (!outer) return null; var inner = outer[3].match(V8\_INNER); if (!inner) return null;
 var method = outer[2] || ''; if (outer[1]) method = 'eval at ' + method; return { method: method, fnName: method, url: inner[1] || '', line: parseInt(inner[2]) || 0, column: parseInt(inner[3]) || 0, }; }
 // Helpers
 function compact(array) { var result = []; array.forEach(function(value) { if (value) { result.push(value); } }); return result; }
 StackTrace.parse = function(error) { try { var lines = parse(error.stack || error); if(lines.length) { return new StackTrace(error.message, lines); } } catch(e) { return undefined; }
 };
 loader.StackTrace = StackTrace;
 function getPositionOfError(txt) { var res = /at position ([0-9]+)/.exec(txt); if(res && res.length > 1) { return Number(res[1]); } }
 loader.loadCodeFrame = function(){ if(!this.global.process) { this.global.process = { argv: '', env: {} }; }
 var loader = this.pluginLoader || this; var isProd = loader.isEnv("production"); var p = isProd ? Promise.resolve() : loader["import"]("@@babel-code-frame"); return p; };
 loader.\_parseJSONError = function(err, source){ var pos = getPositionOfError(err.message); if(pos) { return this.\_getLineAndColumnFromPosition(source, pos); } else { return {line: 0, column: 0}; } };
 var errPos = /at position( |:)([0-9]+)/; var errLine = /at line ([0-9]+) column ([0-9]+)/; loader.\_parseSyntaxErrorLocation = function(error, load){ // V8 and Edge var res = errPos.exec(error.message); if(res && res.length === 3) { var pos = Number(res[2]); return this.\_getLineAndColumnFromPosition(load.source, pos); }
 // Firefox res = errLine.exec(error.message); if(res && res.length === 3) { return { line: Number(res[1]), column: Number(res[2]) }; } }
 loader.\_addSourceInfoToError = function(err, pos, load, fnName){ return this.loadCodeFrame() .then(function(codeFrame){ if(codeFrame) { var src = load.metadata.originalSource || load.source; var codeSample = codeFrame(src, pos.line, pos.column); err.message += "\n\n" + codeSample + "\n"; } var stackTrace = new StackTrace(err.message, [ StackTrace.item(fnName, load.address, pos.line, pos.column) ]); err.stack = stackTrace.toString(); return Promise.reject(err); }); };
 function findStackFromAddress(st, address) { for(var i = 0; i < st.items.length; i++) { if(st.items[i].url === address) { return st.items[i]; } } }
 loader.rejectWithCodeFrame = function(error, load) { var st = StackTrace.parse(error);
 var item; if(error.onlyIncludeCodeFrameIfRootModule) { item = st && st.items[0] && st.items[0].url === load.address && st.items[0]; } else { item = findStackFromAddress(st, load.address); }
 if(item) { return this.loadCodeFrame() .then(function(codeFrame){ if(codeFrame) { var newError = new Error(error.message);
 var line = item.line; var column = item.column;
 // CommonJS adds 3 function wrappers if(load.metadata.format === "cjs") { line = line - 3; }
 var src = load.metadata.originalSource || load.source; var codeSample = codeFrame(src, line, column); if(!codeSample) return Promise.reject(error);
 newError.message += "\n\n" + codeSample + "\n"; st.message = newError.message; newError.stack = st.toString(); return Promise.reject(newError); } else { return Promise.reject(error); } }); }
 return Promise.reject(error); };});
addStealExtension(function addPrettyName(loader){ loader.prettyName = function(load){ var pnm = load.metadata.parsedModuleName; if(pnm) { return pnm.packageName + "/" + pnm.modulePath; } return load.name; };});
addStealExtension(function addTreeShaking(loader) { function treeShakingEnabled(loader, load) { return !loader.noTreeShaking && loader.treeShaking !== false; }
 function determineUsedExports(load) { var loader = this;
 // 1. Get any new dependencies that haven't been accounted for. var newDeps = newDependants.call(this, load); var usedExports = new loader.Set(); var allUsed = false; newDeps.forEach(function(depName) { var depLoad = loader.getModuleLoad(depName); var specifier = loader.moduleSpecifierFromName(depLoad, load.name); if (depLoad.metadata.format !== "es6") { allUsed = true; return; } });
 // Only walk the export tree if all are not being used. // This saves not needing to do the traversal. if(!allUsed) { allUsed = walkExports.call(loader, load, function(exps){ exps.forEach(function(name){ usedExports.add(name); }); }); }
 // Copy over existing exports if(load.metadata.usedExports) { load.metadata.usedExports.forEach(function(name){ usedExports.add(name); }); }
 if(!loader.treeShakeConfig[load.name]) { loader.treeShakeConfig[load.name] = Object.create(null); }
 load.metadata.usedExports = loader.treeShakeConfig[load.name].usedExports = usedExports; load.metadata.allExportsUsed = loader.treeShakeConfig[load.name].allExportsUsed = allUsed;
 return { all: allUsed, used: usedExports }; }
 // Determine if this load's dependants have changed, function newDependants(load) { var out = []; var deps = this.getDependants(load.name); var shakenParents = load.metadata.shakenParents;[View remainder of file in raw view](https://github.com/stealjs/steal/raw/c9dd1eb19ed3f97aeb93cf9dcea5d68ad5d0ced9/main.js)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

