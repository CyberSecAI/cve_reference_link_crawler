

* [Skip to main content](#content)
* [Skip to search](#top-nav-search-input)
* [Skip to select language](#languages-switcher-button)

[MDN Web Docs](/en-US/)Open main menu

* References[References](/en-US/docs/Web)
  + [Overview / Web Technology

    Web technology reference for developers](/en-US/docs/Web)
  + [HTML

    Structure of content on the web](/en-US/docs/Web/HTML)
  + [CSS

    Code used to describe document style](/en-US/docs/Web/CSS)
  + [JavaScript

    General-purpose scripting language](/en-US/docs/Web/JavaScript)
  + [HTTP

    Protocol for transmitting web resources](/en-US/docs/Web/HTTP)
  + [Web APIs

    Interfaces for building web applications](/en-US/docs/Web/API)
  + [Web Extensions

    Developing extensions for web browsers](/en-US/docs/Mozilla/Add-ons/WebExtensions)
  + [Accessibility

    Learn to make the web accessible to all](/en-US/docs/Web/Accessibility)
  + [Web Technology

    Web technology reference for developers](/en-US/docs/Web)
* Learn[Learn](/en-US/docs/Learn_web_development)
  + [Overview / MDN Learning Area

    Learn web development](/en-US/docs/Learn_web_development)
  + [MDN Learning Area

    Learn web development](/en-US/docs/Learn_web_development)
  + [HTML

    Learn to structure web content with HTML](/en-US/docs/Learn_web_development/Core/Structuring_content)
  + [CSS

    Learn to style content using CSS](/en-US/docs/Learn_web_development/Core/Styling_basics)
  + [JavaScript

    Learn to run scripts in the browser](/en-US/docs/Learn_web_development/Core/Scripting)
* Plus[Plus](/en-US/plus)
  + [Overview

    A customized MDN experience](/en-US/plus)
  + [AI Help

    Get real-time assistance and support](/en-US/plus/ai-help)
  + [Updates

    All browser compatibility updates at a glance](/en-US/plus/updates)
  + [Documentation

    Learn how to use MDN Plus](/en-US/plus/docs/features/overview)
  + [FAQ

    Frequently asked questions about MDN Plus](/en-US/plus/docs/faq)
* [Curriculum New](/en-US/curriculum/)
* [Blog](/en-US/blog/)
* Tools
  + [Playground

    Write, test and share your code](/en-US/play)
  + [HTTP Observatory

    Scan a website for free](/en-US/observatory)
  + [AI Help

    Get real-time assistance and support](/en-US/plus/ai-help)
Search MDNClear search inputSearchTheme

* [Log in](/users/fxa/login/authenticate/?next=%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FCSP)
* [Sign up for free](/users/fxa/login/authenticate/?next=%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FCSP)

1. [References](/en-US/docs/Web)
2. [HTTP](/en-US/docs/Web/HTTP)
3. [Content Security Policy (CSP)](/en-US/docs/Web/HTTP/CSP)
Article Actions

* English (US)
  + Remember language
  + [Deutsch](/de/docs/Web/HTTP/CSP)
  + [EspaÃ±ol](/es/docs/Web/HTTP/CSP)
  + [FranÃ§ais](/fr/docs/Web/HTTP/CSP)
  + [æ¥æ¬èª](/ja/docs/Web/HTTP/CSP)
  + [íêµ­ì´](/ko/docs/Web/HTTP/CSP)
  + [PortuguÃªs (doÂ Brasil)](/pt-BR/docs/Web/HTTP/CSP)
  + [Ð ÑÑÑÐºÐ¸Ð¹](/ru/docs/Web/HTTP/CSP)
  + [ä¸­æ (ç®ä½)](/zh-CN/docs/Web/HTTP/CSP)
Filter sidebarClear filter input
## In this article

* [CSP overview](#csp_overview)
* [Controlling resource loading](#controlling_resource_loading)
* [Clickjacking protection](#clickjacking_protection)
* [Upgrading insecure requests](#upgrading_insecure_requests)
* [Testing your policy](#testing_your_policy)
* [See also](#see_also)

1. [HTTP](/en-US/docs/Web/HTTP)
2. Guides
3. [An overview of HTTP](/en-US/docs/Web/HTTP/Overview)
4. [A typical HTTP session](/en-US/docs/Web/HTTP/Session)
5. [HTTP messages](/en-US/docs/Web/HTTP/Messages)
6. [MIME types (IANA media types)](/en-US/docs/Web/HTTP/MIME_types)
7. [Compression in HTTP](/en-US/docs/Web/HTTP/Compression)
8. [HTTP caching](/en-US/docs/Web/HTTP/Caching)
9. [HTTP authentication](/en-US/docs/Web/HTTP/Authentication)
10. [Using HTTP cookies](/en-US/docs/Web/HTTP/Cookies)
11. [Redirections in HTTP](/en-US/docs/Web/HTTP/Redirections)
12. [HTTP conditional requests](/en-US/docs/Web/HTTP/Conditional_requests)
13. [HTTP range requests](/en-US/docs/Web/HTTP/Range_requests)
14. [Content negotiation](/en-US/docs/Web/HTTP/Content_negotiation)
15. [Connection management in HTTP/1.x](/en-US/docs/Web/HTTP/Connection_management_in_HTTP_1.x)
16. [Evolution of HTTP](/en-US/docs/Web/HTTP/Evolution_of_HTTP)
17. [Protocol upgrade mechanism](/en-US/docs/Web/HTTP/Protocol_upgrade_mechanism)
18. [Proxy servers and tunneling](/en-US/docs/Web/HTTP/Proxy_servers_and_tunneling)
19. [HTTP Client hints](/en-US/docs/Web/HTTP/Client_hints)
20. Security and privacy
    1. [Practical security implementation guides](/en-US/docs/Web/Security/Practical_implementation_guides)
    2. [HTTP Observatory](/en-US/observatory)
    3. [Permissions Policy](/en-US/docs/Web/HTTP/Permissions_Policy)
       Experimental
    4. *[Content Security Policy (CSP)](/en-US/docs/Web/HTTP/CSP)*
    5. [Cross-Origin Resource Sharing (CORS)](/en-US/docs/Web/HTTP/CORS)
    6. [Cross-Origin Resource Policy (CORP)](/en-US/docs/Web/HTTP/Cross-Origin_Resource_Policy)
    7. [Headers](/en-US/docs/Web/HTTP/Headers)
21. References
22. HTTP headers
    1. [`Accept`](/en-US/docs/Web/HTTP/Headers/Accept)
    2. [`Accept-CH`](/en-US/docs/Web/HTTP/Headers/Accept-CH)
    3. [`Accept-Encoding`](/en-US/docs/Web/HTTP/Headers/Accept-Encoding)
    4. [`Accept-Language`](/en-US/docs/Web/HTTP/Headers/Accept-Language)
    5. [`Accept-Patch`](/en-US/docs/Web/HTTP/Headers/Accept-Patch)
    6. [`Accept-Post`](/en-US/docs/Web/HTTP/Headers/Accept-Post)
    7. [`Accept-Ranges`](/en-US/docs/Web/HTTP/Headers/Accept-Ranges)
    8. [`Access-Control-Allow-Credentials`](/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials)
    9. [`Access-Control-Allow-Headers`](/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Headers)
    10. [`Access-Control-Allow-Methods`](/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Methods)
    11. [`Access-Control-Allow-Origin`](/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)
    12. [`Access-Control-Expose-Headers`](/en-US/docs/Web/HTTP/Headers/Access-Control-Expose-Headers)
    13. [`Access-Control-Max-Age`](/en-US/docs/Web/HTTP/Headers/Access-Control-Max-Age)
    14. [`Access-Control-Request-Headers`](/en-US/docs/Web/HTTP/Headers/Access-Control-Request-Headers)
    15. [`Access-Control-Request-Method`](/en-US/docs/Web/HTTP/Headers/Access-Control-Request-Method)
    16. [`Age`](/en-US/docs/Web/HTTP/Headers/Age)
    17. [`Allow`](/en-US/docs/Web/HTTP/Headers/Allow)
    18. [`Alt-Svc`](/en-US/docs/Web/HTTP/Headers/Alt-Svc)
    19. [`Alt-Used`](/en-US/docs/Web/HTTP/Headers/Alt-Used)
    20. [`Attribution-Reporting-Eligible`](/en-US/docs/Web/HTTP/Headers/Attribution-Reporting-Eligible)
        Experimental
    21. [`Attribution-Reporting-Register-Source`](/en-US/docs/Web/HTTP/Headers/Attribution-Reporting-Register-Source)
        Experimental
    22. [`Attribution-Reporting-Register-Trigger`](/en-US/docs/Web/HTTP/Headers/Attribution-Reporting-Register-Trigger)
        Experimental
    23. [`Authorization`](/en-US/docs/Web/HTTP/Headers/Authorization)
    24. [`Cache-Control`](/en-US/docs/Web/HTTP/Headers/Cache-Control)
    25. [`Clear-Site-Data`](/en-US/docs/Web/HTTP/Headers/Clear-Site-Data)
    26. [`Connection`](/en-US/docs/Web/HTTP/Headers/Connection)
    27. [`Content-Digest`](/en-US/docs/Web/HTTP/Headers/Content-Digest)
    28. [`Content-Disposition`](/en-US/docs/Web/HTTP/Headers/Content-Disposition)
    29. [`Content-DPR`](/en-US/docs/Web/HTTP/Headers/Content-DPR)
        Non-standard
        Deprecated
    30. [`Content-Encoding`](/en-US/docs/Web/HTTP/Headers/Content-Encoding)
    31. [`Content-Language`](/en-US/docs/Web/HTTP/Headers/Content-Language)
    32. [`Content-Length`](/en-US/docs/Web/HTTP/Headers/Content-Length)
    33. [`Content-Location`](/en-US/docs/Web/HTTP/Headers/Content-Location)
    34. [`Content-Range`](/en-US/docs/Web/HTTP/Headers/Content-Range)
    35. [`Content-Security-Policy`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy)
    36. [`Content-Security-Policy-Report-Only`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only)
    37. [`Content-Type`](/en-US/docs/Web/HTTP/Headers/Content-Type)
    38. [`Cookie`](/en-US/docs/Web/HTTP/Headers/Cookie)
    39. [`Critical-CH`](/en-US/docs/Web/HTTP/Headers/Critical-CH)
        Experimental
    40. [`Cross-Origin-Embedder-Policy`](/en-US/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy)
    41. [`Cross-Origin-Opener-Policy`](/en-US/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy)
    42. [`Cross-Origin-Resource-Policy`](/en-US/docs/Web/HTTP/Headers/Cross-Origin-Resource-Policy)
    43. [`Date`](/en-US/docs/Web/HTTP/Headers/Date)
    44. [`Device-Memory`](/en-US/docs/Web/HTTP/Headers/Device-Memory)
    45. [`DNT`](/en-US/docs/Web/HTTP/Headers/DNT)
        Non-standard
        Deprecated
    46. [`Downlink`](/en-US/docs/Web/HTTP/Headers/Downlink)
        Experimental
    47. [`DPR`](/en-US/docs/Web/HTTP/Headers/DPR)
        Non-standard
        Deprecated
    48. [`Early-Data`](/en-US/docs/Web/HTTP/Headers/Early-Data)
        Experimental
    49. [`ECT`](/en-US/docs/Web/HTTP/Headers/ECT)
        Experimental
    50. [`ETag`](/en-US/docs/Web/HTTP/Headers/ETag)
    51. [`Expect`](/en-US/docs/Web/HTTP/Headers/Expect)
    52. [`Expect-CT`](/en-US/docs/Web/HTTP/Headers/Expect-CT)
        Deprecated
    53. [`Expires`](/en-US/docs/Web/HTTP/Headers/Expires)
    54. [`Forwarded`](/en-US/docs/Web/HTTP/Headers/Forwarded)
    55. [`From`](/en-US/docs/Web/HTTP/Headers/From)
    56. [`Host`](/en-US/docs/Web/HTTP/Headers/Host)
    57. [`If-Match`](/en-US/docs/Web/HTTP/Headers/If-Match)
    58. [`If-Modified-Since`](/en-US/docs/Web/HTTP/Headers/If-Modified-Since)
    59. [`If-None-Match`](/en-US/docs/Web/HTTP/Headers/If-None-Match)
    60. [`If-Range`](/en-US/docs/Web/HTTP/Headers/If-Range)
    61. [`If-Unmodified-Since`](/en-US/docs/Web/HTTP/Headers/If-Unmodified-Since)
    62. [`Keep-Alive`](/en-US/docs/Web/HTTP/Headers/Keep-Alive)
    63. [`Last-Modified`](/en-US/docs/Web/HTTP/Headers/Last-Modified)
    64. [`Link`](/en-US/docs/Web/HTTP/Headers/Link)
    65. [`Location`](/en-US/docs/Web/HTTP/Headers/Location)
    66. [`Max-Forwards`](/en-US/docs/Web/HTTP/Headers/Max-Forwards)
    67. [`NEL`](/en-US/docs/Web/HTTP/Headers/NEL)
        Experimental
    68. [`No-Vary-Search`](/en-US/docs/Web/HTTP/Headers/No-Vary-Search)
        Experimental
    69. [`Observe-Browsing-Topics`](/en-US/docs/Web/HTTP/Headers/Observe-Browsing-Topics)
        Experimental
        Non-standard
    70. [`Origin`](/en-US/docs/Web/HTTP/Headers/Origin)
    71. [`Origin-Agent-Cluster`](/en-US/docs/Web/HTTP/Headers/Origin-Agent-Cluster)
        Experimental
    72. [`Permissions-Policy`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy)
        Experimental
    73. [`Pragma`](/en-US/docs/Web/HTTP/Headers/Pragma)
        Deprecated
    74. [`Priority`](/en-US/docs/Web/HTTP/Headers/Priority)
    75. [`Proxy-Authenticate`](/en-US/docs/Web/HTTP/Headers/Proxy-Authenticate)
    76. [`Proxy-Authorization`](/en-US/docs/Web/HTTP/Headers/Proxy-Authorization)
    77. [`Range`](/en-US/docs/Web/HTTP/Headers/Range)
    78. [`Referer`](/en-US/docs/Web/HTTP/Headers/Referer)
    79. [`Referrer-Policy`](/en-US/docs/Web/HTTP/Headers/Referrer-Policy)
    80. [`Refresh`](/en-US/docs/Web/HTTP/Headers/Refresh)
    81. [`Report-To`](/en-US/docs/Web/HTTP/Headers/Report-To)
        Non-standard
        Deprecated
    82. [`Reporting-Endpoints`](/en-US/docs/Web/HTTP/Headers/Reporting-Endpoints)
        Experimental
    83. [`Repr-Digest`](/en-US/docs/Web/HTTP/Headers/Repr-Digest)
    84. [`Retry-After`](/en-US/docs/Web/HTTP/Headers/Retry-After)
    85. [`RTT`](/en-US/docs/Web/HTTP/Headers/RTT)
        Experimental
    86. [`Save-Data`](/en-US/docs/Web/HTTP/Headers/Save-Data)
        Experimental
    87. [`Sec-Browsing-Topics`](/en-US/docs/Web/HTTP/Headers/Sec-Browsing-Topics)
        Experimental
        Non-standard
    88. [`Sec-CH-Prefers-Color-Scheme`](/en-US/docs/Web/HTTP/Headers/Sec-CH-Prefers-Color-Scheme)
        Experimental
    89. [`Sec-CH-Prefers-Reduced-Motion`](/en-US/docs/Web/HTTP/Headers/Sec-CH-Prefers-Reduced-Motion)
        Experimental
    90. [`Sec-CH-Prefers-Reduced-Transparency`](/en-US/docs/Web/HTTP/Headers/Sec-CH-Prefers-Reduced-Transparency)
        Experimental
    91. [`Sec-CH-UA`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA)
        Experimental
    92. [`Sec-CH-UA-Arch`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA-Arch)
        Experimental
    93. [`Sec-CH-UA-Bitness`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA-Bitness)
        Experimental
    94. [`Sec-CH-UA-Full-Version`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA-Full-Version)
        Deprecated
    95. [`Sec-CH-UA-Full-Version-List`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA-Full-Version-List)
        Experimental
    96. [`Sec-CH-UA-Mobile`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA-Mobile)
        Experimental
    97. [`Sec-CH-UA-Model`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA-Model)
        Experimental
    98. [`Sec-CH-UA-Platform`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA-Platform)
        Experimental
    99. [`Sec-CH-UA-Platform-Version`](/en-US/docs/Web/HTTP/Headers/Sec-CH-UA-Platform-Version)
        Experimental
    100. [`Sec-Fetch-Dest`](/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Dest)
    101. [`Sec-Fetch-Mode`](/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Mode)
    102. [`Sec-Fetch-Site`](/en-US/docs/Web/HTTP/Headers/Sec-Fetch-Site)
    103. [`Sec-Fetch-User`](/en-US/docs/Web/HTTP/Headers/Sec-Fetch-User)
    104. [`Sec-GPC`](/en-US/docs/Web/HTTP/Headers/Sec-GPC)
         Experimental
    105. [`Sec-Purpose`](/en-US/docs/Web/HTTP/Headers/Sec-Purpose)
    106. [`Sec-WebSocket-Accept`](/en-US/docs/Web/HTTP/Headers/Sec-WebSocket-Accept)
    107. [`Sec-WebSocket-Extensions`](/en-US/docs/Web/HTTP/Headers/Sec-WebSocket-Extensions)
    108. [`Sec-WebSocket-Key`](/en-US/docs/Web/HTTP/Headers/Sec-WebSocket-Key)
    109. [`Sec-WebSocket-Protocol`](/en-US/docs/Web/HTTP/Headers/Sec-WebSocket-Protocol)
    110. [`Sec-WebSocket-Version`](/en-US/docs/Web/HTTP/Headers/Sec-WebSocket-Version)
    111. [`Server`](/en-US/docs/Web/HTTP/Headers/Server)
    112. [`Server-Timing`](/en-US/docs/Web/HTTP/Headers/Server-Timing)
    113. [`Service-Worker`](/en-US/docs/Web/HTTP/Headers/Service-Worker)
    114. [`Service-Worker-Allowed`](/en-US/docs/Web/HTTP/Headers/Service-Worker-Allowed)
    115. [`Service-Worker-Navigation-Preload`](/en-US/docs/Web/HTTP/Headers/Service-Worker-Navigation-Preload)
    116. [`Set-Cookie`](/en-US/docs/Web/HTTP/Headers/Set-Cookie)
    117. [`Set-Login`](/en-US/docs/Web/HTTP/Headers/Set-Login)
         Experimental
    118. [`SourceMap`](/en-US/docs/Web/HTTP/Headers/SourceMap)
    119. [`Speculation-Rules`](/en-US/docs/Web/HTTP/Headers/Speculation-Rules)
         Experimental
    120. [`Strict-Transport-Security`](/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security)
    121. [`Supports-Loading-Mode`](/en-US/docs/Web/HTTP/Headers/Supports-Loading-Mode)
         Experimental
    122. [`TE`](/en-US/docs/Web/HTTP/Headers/TE)
    123. [`Timing-Allow-Origin`](/en-US/docs/Web/HTTP/Headers/Timing-Allow-Origin)
    124. [`Tk`](/en-US/docs/Web/HTTP/Headers/Tk)
         Non-standard
         Deprecated
    125. [`Trailer`](/en-US/docs/Web/HTTP/Headers/Trailer)
    126. [`Transfer-Encoding`](/en-US/docs/Web/HTTP/Headers/Transfer-Encoding)
    127. [`Upgrade`](/en-US/docs/Web/HTTP/Headers/Upgrade)
    128. [`Upgrade-Insecure-Requests`](/en-US/docs/Web/HTTP/Headers/Upgrade-Insecure-Requests)
    129. [`User-Agent`](/en-US/docs/Web/HTTP/Headers/User-Agent)
    130. [`Vary`](/en-US/docs/Web/HTTP/Headers/Vary)
    131. [`Via`](/en-US/docs/Web/HTTP/Headers/Via)
    132. [`Viewport-Width`](/en-US/docs/Web/HTTP/Headers/Viewport-Width)
         Non-standard
         Deprecated
    133. [`Want-Content-Digest`](/en-US/docs/Web/HTTP/Headers/Want-Content-Digest)
    134. [`Want-Repr-Digest`](/en-US/docs/Web/HTTP/Headers/Want-Repr-Digest)
    135. [`Warning`](/en-US/docs/Web/HTTP/Headers/Warning)
         Deprecated
    136. [`Width`](/en-US/docs/Web/HTTP/Headers/Width)
         Non-standard
         Deprecated
    137. [`WWW-Authenticate`](/en-US/docs/Web/HTTP/Headers/WWW-Authenticate)
    138. [`X-Content-Type-Options`](/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options)
    139. [`X-DNS-Prefetch-Control`](/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control)
         Non-standard
    140. [`X-Forwarded-For`](/en-US/docs/Web/HTTP/Headers/X-Forwarded-For)
         Non-standard
    141. [`X-Forwarded-Host`](/en-US/docs/Web/HTTP/Headers/X-Forwarded-Host)
         Non-standard
    142. [`X-Forwarded-Proto`](/en-US/docs/Web/HTTP/Headers/X-Forwarded-Proto)
         Non-standard
    143. [`X-Frame-Options`](/en-US/docs/Web/HTTP/Headers/X-Frame-Options)
         Deprecated
    144. [`X-Permitted-Cross-Domain-Policies`](/en-US/docs/Web/HTTP/Headers/X-Permitted-Cross-Domain-Policies)
         Non-standard
    145. [`X-Powered-By`](/en-US/docs/Web/HTTP/Headers/X-Powered-By)
         Non-standard
    146. [`X-Robots-Tag`](/en-US/docs/Web/HTTP/Headers/X-Robots-Tag)
         Non-standard
    147. [`X-XSS-Protection`](/en-US/docs/Web/HTTP/Headers/X-XSS-Protection)
         Non-standard
         Deprecated
23. HTTP request methods
    1. [`CONNECT`](/en-US/docs/Web/HTTP/Methods/CONNECT)
    2. [`DELETE`](/en-US/docs/Web/HTTP/Methods/DELETE)
    3. [`GET`](/en-US/docs/Web/HTTP/Methods/GET)
    4. [`HEAD`](/en-US/docs/Web/HTTP/Methods/HEAD)
    5. [`OPTIONS`](/en-US/docs/Web/HTTP/Methods/OPTIONS)
    6. [`PATCH`](/en-US/docs/Web/HTTP/Methods/PATCH)
    7. [`POST`](/en-US/docs/Web/HTTP/Methods/POST)
    8. [`PUT`](/en-US/docs/Web/HTTP/Methods/PUT)
    9. [`TRACE`](/en-US/docs/Web/HTTP/Methods/TRACE)
24. HTTP response status codes
    1. [`100 Continue`](/en-US/docs/Web/HTTP/Status/100)
    2. [`101 Switching Protocols`](/en-US/docs/Web/HTTP/Status/101)
    3. [`102 Processing`](/en-US/docs/Web/HTTP/Status/102)
    4. [`103 Early Hints`](/en-US/docs/Web/HTTP/Status/103)
    5. [`200 OK`](/en-US/docs/Web/HTTP/Status/200)
    6. [`201 Created`](/en-US/docs/Web/HTTP/Status/201)
    7. [`202 Accepted`](/en-US/docs/Web/HTTP/Status/202)
    8. [`203 Non-Authoritative Information`](/en-US/docs/Web/HTTP/Status/203)
    9. [`204 No Content`](/en-US/docs/Web/HTTP/Status/204)
    10. [`205 Reset Content`](/en-US/docs/Web/HTTP/Status/205)
    11. [`206 Partial Content`](/en-US/docs/Web/HTTP/Status/206)
    12. [`207 Multi-Status`](/en-US/docs/Web/HTTP/Status/207)
    13. [`208 Already Reported`](/en-US/docs/Web/HTTP/Status/208)
    14. [`226 IM Used`](/en-US/docs/Web/HTTP/Status/226)
    15. [`300 Multiple Choices`](/en-US/docs/Web/HTTP/Status/300)
    16. [`301 Moved Permanently`](/en-US/docs/Web/HTTP/Status/301)
    17. [`302 Found`](/en-US/docs/Web/HTTP/Status/302)
    18. [`303 See Other`](/en-US/docs/Web/HTTP/Status/303)
    19. [`304 Not Modified`](/en-US/docs/Web/HTTP/Status/304)
    20. [`307 Temporary Redirect`](/en-US/docs/Web/HTTP/Status/307)
    21. [`308 Permanent Redirect`](/en-US/docs/Web/HTTP/Status/308)
    22. [`400 Bad Request`](/en-US/docs/Web/HTTP/Status/400)
    23. [`401 Unauthorized`](/en-US/docs/Web/HTTP/Status/401)
    24. [`402 Payment Required`](/en-US/docs/Web/HTTP/Status/402)
    25. [`403 Forbidden`](/en-US/docs/Web/HTTP/Status/403)
    26. [`404 Not Found`](/en-US/docs/Web/HTTP/Status/404)
    27. [`405 Method Not Allowed`](/en-US/docs/Web/HTTP/Status/405)
    28. [`406 Not Acceptable`](/en-US/docs/Web/HTTP/Status/406)
    29. [`407 Proxy Authentication Required`](/en-US/docs/Web/HTTP/Status/407)
    30. [`408 Request Timeout`](/en-US/docs/Web/HTTP/Status/408)
    31. [`409 Conflict`](/en-US/docs/Web/HTTP/Status/409)
    32. [`410 Gone`](/en-US/docs/Web/HTTP/Status/410)
    33. [`411 Length Required`](/en-US/docs/Web/HTTP/Status/411)
    34. [`412 Precondition Failed`](/en-US/docs/Web/HTTP/Status/412)
    35. [`413 Content Too Large`](/en-US/docs/Web/HTTP/Status/413)
    36. [`414 URI Too Long`](/en-US/docs/Web/HTTP/Status/414)
    37. [`415 Unsupported Media Type`](/en-US/docs/Web/HTTP/Status/415)
    38. [`416 Range Not Satisfiable`](/en-US/docs/Web/HTTP/Status/416)
    39. [`417 Expectation Failed`](/en-US/docs/Web/HTTP/Status/417)
    40. [`418 I'm a teapot`](/en-US/docs/Web/HTTP/Status/418)
    41. [`421 Misdirected Request`](/en-US/docs/Web/HTTP/Status/421)
    42. [`422 Unprocessable Content`](/en-US/docs/Web/HTTP/Status/422)
    43. [`423 Locked`](/en-US/docs/Web/HTTP/Status/423)
    44. [`424 Failed Dependency`](/en-US/docs/Web/HTTP/Status/424)
    45. [`425 Too Early`](/en-US/docs/Web/HTTP/Status/425)
    46. [`426 Upgrade Required`](/en-US/docs/Web/HTTP/Status/426)
    47. [`428 Precondition Required`](/en-US/docs/Web/HTTP/Status/428)
    48. [`429 Too Many Requests`](/en-US/docs/Web/HTTP/Status/429)
    49. [`431 Request Header Fields Too Large`](/en-US/docs/Web/HTTP/Status/431)
    50. [`451 Unavailable For Legal Reasons`](/en-US/docs/Web/HTTP/Status/451)
    51. [`500 Internal Server Error`](/en-US/docs/Web/HTTP/Status/500)
    52. [`501 Not Implemented`](/en-US/docs/Web/HTTP/Status/501)
    53. [`502 Bad Gateway`](/en-US/docs/Web/HTTP/Status/502)
    54. [`503 Service Unavailable`](/en-US/docs/Web/HTTP/Status/503)
    55. [`504 Gateway Timeout`](/en-US/docs/Web/HTTP/Status/504)
    56. [`505 HTTP Version Not Supported`](/en-US/docs/Web/HTTP/Status/505)
    57. [`506 Variant Also Negotiates`](/en-US/docs/Web/HTTP/Status/506)
    58. [`507 Insufficient Storage`](/en-US/docs/Web/HTTP/Status/507)
    59. [`508 Loop Detected`](/en-US/docs/Web/HTTP/Status/508)
    60. [`510 Not Extended`](/en-US/docs/Web/HTTP/Status/510)
    61. [`511 Network Authentication Required`](/en-US/docs/Web/HTTP/Status/511)
25. CSP directives
    1. [`CSP: base-uri`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/base-uri)
    2. [`CSP: block-all-mixed-content`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/block-all-mixed-content)
       Deprecated
    3. [`CSP: child-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/child-src)
    4. [`CSP: connect-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src)
    5. [`CSP: default-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/default-src)
    6. [`CSP: fenced-frame-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/fenced-frame-src)
       Experimental
    7. [`CSP: font-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/font-src)
    8. [`CSP: form-action`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/form-action)
    9. [`CSP: frame-ancestors`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors)
    10. [`CSP: frame-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-src)
    11. [`CSP: img-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/img-src)
    12. [`CSP: manifest-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/manifest-src)
    13. [`CSP: media-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/media-src)
    14. [`CSP: object-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/object-src)
    15. [`CSP: prefetch-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/prefetch-src)
        Non-standard
        Deprecated
    16. [`CSP: report-to`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to)
    17. [`CSP: report-uri`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri)
        Deprecated
    18. [`CSP: require-trusted-types-for`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/require-trusted-types-for)
        Experimental
    19. [`CSP: sandbox`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox)
    20. [`CSP: script-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src)
    21. [`CSP: script-src-attr`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src-attr)
    22. [`CSP: script-src-elem`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src-elem)
    23. [`CSP: style-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src)
    24. [`CSP: style-src-attr`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src-attr)
    25. [`CSP: style-src-elem`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src-elem)
    26. [`CSP: trusted-types`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/trusted-types)
        Experimental
    27. [`CSP: upgrade-insecure-requests`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/upgrade-insecure-requests)
    28. [`CSP: worker-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/worker-src)
26. CORS errors
    1. [`Reason: CORS disabled`](/en-US/docs/Web/HTTP/CORS/Errors/CORSDisabled)
    2. [`Reason: CORS header 'Access-Control-Allow-Origin' does not match 'xyz'`](/en-US/docs/Web/HTTP/CORS/Errors/CORSAllowOriginNotMatchingOrigin)
    3. [`Reason: CORS header 'Access-Control-Allow-Origin' missing`](/en-US/docs/Web/HTTP/CORS/Errors/CORSMissingAllowOrigin)
    4. [`Reason: CORS header 'Origin' cannot be added`](/en-US/docs/Web/HTTP/CORS/Errors/CORSOriginHeaderNotAdded)
    5. [`Reason: CORS preflight channel did not succeed`](/en-US/docs/Web/HTTP/CORS/Errors/CORSPreflightDidNotSucceed)
    6. [`Reason: CORS request did not succeed`](/en-US/docs/Web/HTTP/CORS/Errors/CORSDidNotSucceed)
    7. [`Reason: CORS request external redirect not allowed`](/en-US/docs/Web/HTTP/CORS/Errors/CORSExternalRedirectNotAllowed)
    8. [`Reason: CORS request not HTTP`](/en-US/docs/Web/HTTP/CORS/Errors/CORSRequestNotHttp)
    9. [`Reason: Credential is not supported if the CORS header 'Access-Control-Allow-Origin' is '*'`](/en-US/docs/Web/HTTP/CORS/Errors/CORSNotSupportingCredentials)
    10. [`Reason: Did not find method in CORS header 'Access-Control-Allow-Methods'`](/en-US/docs/Web/HTTP/CORS/Errors/CORSMethodNotFound)
    11. [`Reason: expected 'true' in CORS header 'Access-Control-Allow-Credentials'`](/en-US/docs/Web/HTTP/CORS/Errors/CORSMIssingAllowCredentials)
    12. [`Reason: invalid token 'xyz' in CORS header 'Access-Control-Allow-Headers'`](/en-US/docs/Web/HTTP/CORS/Errors/CORSInvalidAllowHeader)
    13. [`Reason: invalid token 'xyz' in CORS header 'Access-Control-Allow-Methods'`](/en-US/docs/Web/HTTP/CORS/Errors/CORSInvalidAllowMethod)
    14. [`Reason: missing token 'xyz' in CORS header 'Access-Control-Allow-Headers' from CORS preflight channel`](/en-US/docs/Web/HTTP/CORS/Errors/CORSMissingAllowHeaderFromPreflight)
    15. [`Reason: Multiple CORS header 'Access-Control-Allow-Origin' not allowed`](/en-US/docs/Web/HTTP/CORS/Errors/CORSMultipleAllowOriginNotAllowed)
27. Permissions-Policy directives
    1. [`Permissions-Policy: accelerometer`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/accelerometer)
       Experimental
    2. [`Permissions-Policy: ambient-light-sensor`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/ambient-light-sensor)
       Experimental
    3. [`Permissions-Policy: attribution-reporting`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/attribution-reporting)
       Experimental
    4. [`Permissions-Policy: autoplay`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/autoplay)
       Experimental
    5. [`Permissions-Policy: bluetooth`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/bluetooth)
       Experimental
    6. [`Permissions-Policy: browsing-topics`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/browsing-topics)
       Experimental
       Non-standard
    7. [`Permissions-Policy: camera`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/camera)
       Experimental
    8. [`Permissions-Policy: compute-pressure`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/compute-pressure)
       Experimental
    9. [`Permissions-Policy: cross-origin-isolated`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/cross-origin-isolated)
       Experimental
    10. [`Permissions-Policy: display-capture`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/display-capture)
        Experimental
    11. [`Permissions-Policy: document-domain`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/document-domain)
        Experimental
    12. [`Permissions-Policy: encrypted-media`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/encrypted-media)
        Experimental
    13. [`Permissions-Policy: fullscreen`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/fullscreen)
        Experimental
    14. [`Permissions-Policy: gamepad`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/gamepad)
        Experimental
    15. [`Permissions-Policy: geolocation`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/geolocation)
        Experimental
    16. [`Permissions-Policy: gyroscope`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/gyroscope)
        Experimental
    17. [`Permissions-Policy: hid`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/hid)
        Experimental
    18. [`Permissions-Policy: identity-credentials-get`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/identity-credentials-get)
        Experimental
    19. [`Permissions-Policy: idle-detection`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/idle-detection)
        Experimental
    20. [`Permissions-Policy: local-fonts`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/local-fonts)
        Experimental
    21. [`Permissions-Policy: magnetometer`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/magnetometer)
        Experimental
    22. [`Permissions-Policy: microphone`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/microphone)
        Experimental
    23. [`Permissions-Policy: midi`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/midi)
        Experimental
    24. [`Permissions-Policy: otp-credentials`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/otp-credentials)
        Experimental
    25. [`Permissions-Policy: payment`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/payment)
        Experimental
    26. [`Permissions-Policy: picture-in-picture`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/picture-in-picture)
        Experimental
    27. [`Permissions-Policy: publickey-credentials-create`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/publickey-credentials-create)
        Experimental
    28. [`Permissions-Policy: publickey-credentials-get`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/publickey-credentials-get)
        Experimental
    29. [`Permissions-Policy: screen-wake-lock`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/screen-wake-lock)
        Experimental
    30. [`Permissions-Policy: serial`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/serial)
        Experimental
    31. [`Permissions-Policy: speaker-selection`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/speaker-selection)
        Experimental
    32. [`Permissions-Policy: storage-access`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/storage-access)
        Experimental
    33. [`Permissions-Policy: usb`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/usb)
        Experimental
    34. [`Permissions-Policy: web-share`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/web-share)
        Experimental
    35. [`Permissions-Policy: window-management`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/window-management)
        Experimental
    36. [`Permissions-Policy: xr-spatial-tracking`](/en-US/docs/Web/HTTP/Headers/Permissions-Policy/xr-spatial-tracking)
        Experimental
28. [HTTP resources and specifications](/en-US/docs/Web/HTTP/Resources_and_specifications)
## In this article

* [CSP overview](#csp_overview)
* [Controlling resource loading](#controlling_resource_loading)
* [Clickjacking protection](#clickjacking_protection)
* [Upgrading insecure requests](#upgrading_insecure_requests)
* [Testing your policy](#testing_your_policy)
* [See also](#see_also)
# Content Security Policy (CSP)

**Content Security Policy** (CSP) is a feature that helps to prevent or minimize the risk of certain types of security threats. It consists of a series of instructions from a website to a browser, which instruct the browser to place restrictions on the things that the code comprising the site is allowed to do.

The primary use case for CSP is to control which resources, in particular JavaScript resources, a document is allowed to load. This is mainly used as a defense against [cross-site scripting](/en-US/docs/Glossary/Cross-site_scripting) (XSS) attacks, in which an attacker is able to inject malicious code into the victim's site.

A CSP can have other purposes as well, including defending against [clickjacking](/en-US/docs/Web/Security/Attacks/Clickjacking) and helping to ensure that a site's pages will be loaded over HTTPS.

In this guide we'll start by describing how a CSP is delivered to a browser and what it looks like at a high level.

Then we'll describe how it can be used to [control which resources are loaded](#controlling_resource_loading) to protect against XSS, and then other use cases such as [clickjacking protection](#clickjacking_protection) and [upgrading insecure requests](#upgrading_insecure_requests). Note that there's no dependency between the different use cases: if you want to add clickjacking protection but not XSS mitigation, you can just add the directives for that use case.

Finally we'll describe [strategies for deploying a CSP](#testing_your_policy) and tools that can help to make this process easier.

## [CSP overview](#csp_overview)

A CSP should be delivered to the browser in the [`Content-Security-Policy`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy) response header. It should be set on all responses to all requests, not just the main document.

You can also specify it using the [`http-equiv`](/en-US/docs/Web/HTML/Element/meta#http-equiv) attribute of your document's [`<meta>`](/en-US/docs/Web/HTML/Element/meta) element, and this is a useful option for some use cases, such as a client-side-rendered [single page app](/en-US/docs/Glossary/SPA) which has only static resources, because you can then avoid relying on any server infrastructure. However, this option does not support all CSP features.

The policy is specified as a series of *directives*, separated by semi-colons. Each directive controls a different aspect of the security policy. Each directive has a name, followed by a space, followed by a value. Different directives can have different syntaxes.

For example, consider the following CSP:

http
```
Content-Security-Policy: default-src 'self'; img-src 'self' example.com

```

It sets two directives:

* the `default-src` directive is set to `'self'`
* the `img-src` directive is set to `'self' example.com`.

![A CSP broken into its directives.](/en-US/docs/Web/HTTP/CSP/csp-overview.svg)

The first directive, `default-src`, tells the browser to load only resources that are same-origin with the document, unless other more specific directives set a different policy for other resource types. The second, `img-src`, tells the browser to load images that are same-origin or that are served from `example.com`.

In the next section, we'll look at the tools available to control resource loads, which is the main function of a CSP.

## [Controlling resource loading](#controlling_resource_loading)

A CSP can be used to control the resources that a document is allowed to load. This is primarily used for protection against cross-site scripting (XSS) attacks.

In this section we'll first see how controlling resource loads can help protect against XSS, then at the tools CSP provides to control what resources are loaded. Finally we'll describe one particular recommended strategy, which is called a "Strict CSP".

### [XSS and resource loading](#xss_and_resource_loading)

A cross-site scripting (XSS) attack is one in which an attacker is able to execute their code in the context of the target website. This code is then able to do anything that the website's own code could do, including, for example:

* access or modify the content of the site's loaded pages
* access or modify content in local storage
* make HTTP requests with the user's credentials, enabling them to impersonate the user or access sensitive data

An XSS attack is possible when a website accepts some input which might have been crafted by an attacker (for example, URL parameters, or a comment on a blog post) and then includes it in the page without *sanitizing* it: that is, without ensuring that it can't be executed as JavaScript.

Websites should protect themselves against XSS by sanitizing this input before including it in the page. A CSP provides a complementary protection, which can protect the website even if sanitization fails.

If sanitization does fail, there are various forms the injected malicious code can take in the document, including:

* A [`<script>`](/en-US/docs/Web/HTML/Element/script) tag that links to a malicious source:

  html
  ```
  <script src="https://evil.example.com/hacker.js"></script>

  ```
* A `<script>` tag that includes inline JavaScript:

  html
  ```
  <script>
    console.log("You've been hacked!");
  </script>

  ```
* An inline event handler:

  html
  ```
  <img onmouseover="console.log(`You've been hacked!`)" />

  ```
* A `javascript:` URL:

  html
  ```
  <iframe src="javascript:console.log(`You've been hacked!`)"></iframe>

  ```
* A string argument to an unsafe API like [`eval()`](/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval):

  js
  ```
  eval("console.log(`You've been hacked!`)");

  ```

A CSP can provide protection against all of these. With a CSP, you can:

* define the permitted sources for JavaScript files and other resources, effectively blocking loads from `https://evil.example.com`
* disable inline script tags
* allow only script tags which have the correct nonce or hash set
* disable inline event handlers
* disable `javascript:` URLs
* disable dangerous APIs like `eval()`

In the next section we'll go over the tools CSP provides to do these things.

**Note:**
Setting a CSP is not an alternative to sanitizing input. Websites should sanitize input *and* set a CSP, providing defense in depth against XSS.

### [Fetch directives](#fetch_directives)

Fetch directives are used to specify a particular category of resource that a document is allowed to load â such as JavaScript, CSS stylesheets, images, fonts, and so on.

There are different fetch directives for different types of resource. For example:

* [`script-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src) sets allowed sources for JavaScript.
* [`style-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/style-src) sets allowed sources for CSS stylesheets.
* [`img-src`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/img-src) sets allowed sources for images.

One special fetch directive is `default-src`, which sets a fallback policy for all resources whose directives are not explicitly listed.

For the complete set of fetch directives, see the [reference documentation](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#fetch_directives).

Each fetch directive is specified as either the single keyword `'none'` or one or more *source expressions*, separated by spaces. When more than one source expression is listed: if any of the methods allow the resource, then the resource is allowed.

For example, the CSP below sets two fetch directives:

* `default-src` is given the single source expression `'self'`
* `img-src` is given two source expressions: `'self'` and `example.com`

![CSP diagram showing source expressions](/en-US/docs/Web/HTTP/CSP/csp-source-expressions.svg)

The effect of this is that:

* images must be either same-origin with the document, or loaded from `example.com`
* all other resources must be same-origin with the document.

In the next few sections we'll describe some of the ways you can use source expressions to control resource loads. Note that although we're describing them separately, these expressions can in general be combined: for example, a single fetch directive may include nonces as well as hostnames.

#### Blocking resources

To block a resource type entirely, use the `'none'` keyword. For example, the following directive blocks all [`<object>`](/en-US/docs/Web/HTML/Element/object) and [`<embed>`](/en-US/docs/Web/HTML/Element/embed) resources:

http
```
Content-Security-Policy: object-src 'none'

```

Note that `'none'` cannot be combined with any other method in a particular directive: in practice, if any other source expressions are given alongside `'none'`, then they are ignored.

#### Nonces

A `nonce` is the recommended approach for restricting the loading of [`<script>`](/en-US/docs/Web/HTML/Element/script) and [`<style>`](/en-US/docs/Web/HTML/Element/style) resources.

With a nonce, the server generates a random value for every HTTP response, and includes it in a `script-src` and/or a `style-src` directive:

http
```
Content-Security-Policy:
  script-src 'nonce-416d1177-4d12-4e3b-b7c9-f6c409789fb8'

```

The server then includes this value as the value of the `nonce` attribute of all the `<script>` and/or `<style>` tags that they intend to include in the document.

The browser compares the two values, and loads the resource only if they match. The idea is that even if an attacker can insert some JavaScript into the page, they won't know which nonce the server is going to use, so the browser will refuse to run the script.

For this approach to work, it must not be possible for an attacker to guess the nonce.

**In practice this means that the nonce must be different for every HTTP response, and must not be predictable.**

This in turn means that the server cannot serve static HTML, because it must insert a new nonce each time. Typically the server would use a templating engine to insert the nonce.

Here's a snippet of [Express](/en-US/docs/Learn_web_development/Extensions/Server-side/Express_Nodejs) code to demonstrate:

js
```
function content(nonce) {
  return `
    <script nonce="${nonce}" src="/main.js"></script>
    <script nonce="${nonce}">console.log("hello!");</script>
    <h1>Hello world</h1>
    `;
}

app.get("/", (req, res) => {
  const nonce = crypto.randomUUID();
  res.setHeader("Content-Security-Policy", `script-src 'nonce-${nonce}'`);
  res.send(content(nonce));
});

```

On every request, the server generates a new nonce, inserts it into the CSP and into the [`<script>`](/en-US/docs/Web/HTML/Element/script) tags in the returned document. Note that the server:

* generates a new nonce for every request
* can use nonces with both external and inline scripts
* uses the same nonce for all `<script>` tags in the document

It's important that the server uses some kind of templating to insert nonces, and does not just insert them into all `<script>` tags: otherwise, the server might inadvertently insert nonces into scripts that were injected by an attacker.

Note that nonces can only be used for elements that have a `nonce` attribute: that is, only `<script>` and `<style>` elements.

#### Hashes

Fetch directives can also use a hash of the script to guarantee its integrity. With this method, the server:

1. calculates a hash of the script contents using a [cryptographic hash function](/en-US/docs/Glossary/Cryptographic_hash_function) (one of SHA-256, SHA-384, or SHA-512)
2. creates a [Base64](/en-US/docs/Glossary/Base64) encoding of the result
3. appends a prefix identifying the hash algorithm used (one of `sha256-`, `sha384-`, or `sha512-`).

It then adds the result to the directive:

http
```
Content-Security-Policy: script-src 'sha256-cd9827ad...'

```

When the browser receives the document, it hashes the script, compares the result with the value from the header, and loads the script only if they match.

External scripts must also include the [`integrity`](/en-US/docs/Web/HTML/Element/script#integrity) attribute for this method to work.

Here's a snippet of Express code, to demonstrate:

js
```
const hash1 = "sha256-ex2O7MWOzfczthhKm6azheryNVoERSFrPrdvxRtP8DI=";
const hash2 = "sha256-H/eahVJiG1zBXPQyXX0V6oaxkfiBdmanvfG9eZWSuEc=";

const csp = `script-src '${hash1}' '${hash2}'`;
const content = `
  <script src="./main.js" integrity="${hash2}"></script>
  <script>console.log("hello!");</script>
    <h1>Hello world</h1>
    `;

app.get("/", (req, res) => {
  res.setHeader("Content-Security-Policy", csp);
  res.send(content);
});

```

Note that:

* We have a separate hash for every script in the document.
* For the external script "main.js", we also include the `integrity` attribute, and give it the same value.
* Unlike the example using nonces, both the CSP and the content can be static, because the hashes stay the same. This makes hash-based policies more suitable for static pages or websites that rely on client-side rendering.

#### Scheme-based policies

Fetch directives can list a scheme, like `https:`, to allow resources that are served using that scheme. This, for example, allows a policy to require HTTPS for all resource loads:

http
```
Content-Security-Policy: default-src https:

```
#### Location-based policies

Fetch directives can control resource loads based on where the resource is located.

The keyword `'self'` allows resources which are same-origin with the document itself:

http
```
Content-Security-Policy: img-src 'self'

```

You can also specify one or more hostnames, potentially including wildcards, and only resources served from those hosts will be allowed. This might be used, for example, to allow content to be served from a trusted CDN.

http
```
Content-Security-Policy: img-src *.example.org

```

You can specify multiple locations. The following directive allows only images that are same-origin with the current document, or are served from a subdomain of "example.org", or are served from "example.com":

http
```
Content-Security-Policy: img-src 'self' *.example.org  example.com

```
#### Inline JavaScript

If a CSP contains either a `default-src` or a `script-src` directive, then inline JavaScript will not be allowed to execute unless extra measures are taken to enable it. This includes:

* JavaScript included inside a `<script>` element in the page:

  html
  ```
  <script>
    console.log("Hello from an inline script");
  </script>

  ```
* JavaScript in an inline event handler attribute:

  html
  ```
  <img src="x" onerror="console.log('Hello from an inline event handler')" />

  ```
* JavaScript in a `javascript:` URL:

  html
  ```
  <a href="javascript:console.log('Hello from a javascript: URL')"></a>

  ```

The `unsafe-inline` keyword can be used to override this restriction. For example, the following directive requires all resources to be same-origin, but allows inline JavaScript:

http
```
Content-Security-Policy: default-src 'self' 'unsafe-inline'

```

**Warning:**
Developers should avoid `'unsafe-inline'`, because it defeats much of the purpose of having a CSP. Inline JavaScript is one of the most common XSS vectors, and one of the most basic goals of a CSP is to prevent its uncontrolled use.

Inline `<script>` elements are allowed if they are protected by a nonce or a hash, as described above.

If a directive contains nonce or hash expressions, then the `unsafe-inline` keyword is ignored by browsers.

#### `eval()` and similar APIs

Like inline JavaScript, if a CSP contains either a `default-src` or a `script-src` directive, then `eval()` and similar APIs will not be allowed to execute. This includes, among other APIs:

* [`eval()`](/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval) itself:

  js
  ```
  eval('console.log("hello from eval()")');

  ```
* The [`Function()`](/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/Function) constructor:

  js
  ```
  const sum = new Function("a", "b", "return a + b");

  ```
* The string argument to [`setTimeout()`](/en-US/docs/Web/API/Window/setTimeout "setTimeout()") and [`setInterval()`](/en-US/docs/Web/API/Window/setInterval "setInterval()"):

  js
  ```
  setTimeout("console.log('hello from setTimeout')", 1);

  ```

The `unsafe-eval` keyword can be used to override this behavior, and as with `unsafe-inline`, and for the same reasons: **developers should avoid `unsafe-eval`**. Sometimes it can be difficult to remove usages of `eval()`: in these situations, the [Trusted Types API](/en-US/docs/Web/API/Trusted_Types_API) can make it safer, by ensuring that the input meets a defined policy.

Unlike `unsafe-inline`, the `unsafe-eval` keyword does still work in a directive that contains nonce or hash expressions.

### [Strict CSP](#strict_csp)

To control script loading as a mitigation against XSS, recommended practice is to use [nonce-](#nonces) or [hash-](#hashes) based fetch directives. This is called a *strict CSP*. This type of CSP has two main advantages over a location-based CSP (usually called an *allowlist CSP*):

* Allowlist CSPs are hard to get right and often policies inadvertently whitelist unsafe domains, and hence don't provide effective protection against XSS (see [CSP Is Dead, Long Live CSP! On the Insecurity of Whitelists and the Future of Content Security Policy](https://dl.acm.org/doi/pdf/10.1145/2976749.2978363)).
* Allowlist CSPs can be very large and hard to maintain, in particular when using scripts that are outside of your control. According to [How I learned to stop worrying and love the Content Security Policy](https://www.netlify.com/blog/general-availability-content-security-policy-csp-nonce-integration/), just to integrate Google Analytics, a developer is asked to add 187 Google domains to the allowlist.

A nonce-based strict CSP looks like this:

http
```
Content-Security-Policy:
  script-src 'nonce-{RANDOM}';
  object-src 'none';
  base-uri 'none';

```

In this CSP, we:

* use nonces to control which JavaScript resources are allowed to load
* block all object embeds
* block all uses of the `<base>` element to set a base URI.

A hash-based strict CSP is the same, except it uses hashes instead of nonces:

http
```
Content-Security-Policy:
  script-src 'sha256-{HASHED_SCRIPT}';
  object-src 'none';
  base-uri 'none';

```

Nonce-based directives are easier to maintain if you can generate responses, including the content itself, dynamically. Otherwise, you need to use hash-based directives. The problem with hash-based directives is that you need to recalculate and reapply the hash if any change is made to the script contents.

#### The `strict-dynamic` keyword

As presented above, the strict CSP is difficult to implement when you use scripts which are not under your control. If a third-party script loads any additional scripts, or uses any inline scripts, then this will fail, because the third-party script won't pass the nonce or hash through.

The `strict-dynamic` keyword is provided to help with this problem. It is a keyword that can be included in a fetch directive, and it has the effect that if a script has a nonce or a hash attached to it, then that script will be allowed to load further scripts which do not themselves have nonces or hashes. That is, the trust placed in a script by a nonce or hash is passed on to scripts that the original script loads (and scripts that *they* load, and so on).

For example, consider a document like this:

html
```
<html>
  <head>
    <script
      src="./main.js"
      integrity="sha256-gEh1+8U9S1vkEuQSmmUMTZjyNSu5tIoECP4UXIEjMTk="></script>
  </head>
  <body>
    <h1>Example page!</h1>
  </body>
</html>

```

It includes a script "main.js", which creates and adds another script, "main2.js":

js
```
console.log("hello");

const scriptElement = document.createElement("script");
scriptElement.src = `main2.js`;

document.head.appendChild(scriptElement);

```

We serve our document with a CSP like this:

http
```
Content-Security-Policy:
  script-src 'sha256-gEh1+8U9S1vkEuQSmmUMTZjyNSu5tIoECP4UXIEjMTk='

```

The "main.js" script will be allowed to load, because its hash matches the value in the CSP. But its attempt to load "main2.js" will fail.

If we add `'strict-dynamic'` to the CSP, then "main.js" will be allowed to load "main2.js":

http
```
Content-Security-Policy:
  script-src 'sha256-gEh1+8U9S1vkEuQSmmUMTZjyNSu5tIoECP4UXIEjMTk='
  strict-dynamic

```

The `'strict-dynamic'` keyword makes it much easier to create and maintain nonce- or hash-based CSPs, especially when a website uses third-party scripts. It does make your CSP less secure, though, because if the scripts you include create `<script>` elements based on potential sources of XSS, then the CSP will not protect them.

#### Refactoring inline JavaScript and `eval()`

We've seen above that inline JavaScript is disallowed by default in a CSP. With nonces or hashes, a developer can use inline `<script>` tags, but you'll still need to refactor code to remove other disallowed patterns, including inline event handlers, `javascript:` URLs, and uses of `eval()`. For example, inline event handlers should usually be replaced with calls to [`addEventListener()`](/en-US/docs/Web/API/EventTarget/addEventListener "addEventListener()"):

html
```
<p onclick="console.log('Hello from an inline event handler')">click me</p>

```

html
```
<!-- served with the following CSP:
 `script-src 'sha256-AjYfua7yQhrSlg807yyeaggxQ7rP9Lu0Odz7MZv8cL0='`
 -->
<p id="hello">click me</p>
<script>
  const hello = document.querySelector("#hello");
  hello.addEventListener("click", () => {
    console.log("Hello from an inline script");
  });
</script>

```
## [Clickjacking protection](#clickjacking_protection)

The [`frame-ancestors`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors) directive can be used to control which documents, if any, are allowed to embed this document in a nested browsing context such as an [`<iframe>`](/en-US/docs/Web/HTML/Element/iframe). This is an effective protection against clickjacking attacks, because these attacks depend on embedding the target site in a site controlled by the attacker.

The syntax of `frame-ancestors` is a subset of the fetch directive syntax: you can provide the single keyword value `'none'` or one or more source expressions. However, the only source expressions you can use are schemes, hostnames, or the `'self'` keyword value.

Unless you need your site to be embeddable, you should set `frame-ancestors` to `'none'`:

http
```
Content-Security-Policy: frame-ancestors 'none'

```

This directive is a more flexible replacement for the [`X-Frame-Options`](/en-US/docs/Web/HTTP/Headers/X-Frame-Options) header.

## [Upgrading insecure requests](#upgrading_insecure_requests)

Web developers are strongly encouraged to serve all their content over HTTPS. In the process of upgrading a site to HTTPS, a site sometimes serves the main document over HTTPS but serves its resources over HTTP, for example, using markup like this:

html
```
<script src="http://example.org/my-cat.js"></script>

```

This is called *mixed content*, and the presence of insecure resources greatly weakens the protection afforded by HTTPS. Under the [mixed content algorithm](/en-US/docs/Web/Security/Mixed_content) that browsers implement, if a document is served over HTTPS, insecure resources are categorized into "upgradable content" and "blockable content". Upgradable content is upgraded to HTTPS, and blockable content is blocked, potentially breaking the page.

The ultimate solution to mixed content is for developers to load all resources over HTTPS. However, even if a site is actually able to serve all content over HTTPS, it can still be very difficult (or even effectively impossible, where archived content is concerned) for a developer to rewrite all the URLs the site uses to load resources.

The [`upgrade-insecure-requests`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/upgrade-insecure-requests) directive is intended to solve this problem. This directive doesn't have any value: to set it, just include the directive name:

http
```
Content-Security-Policy: upgrade-insecure-requests

```

If this directive is set on a document, then the browser will automatically upgrade to HTTPS any HTTP URLs in the following cases:

* requests to load resources (such as images, scripts, or fonts)
* navigation requests (such as link targets) which are same-origin with the document
* navigation requests in nested browsing contexts, such as iframes
* form submissions

However, top-level navigation requests whose target is a different origin will not be upgraded.

For example, suppose the document at `https://example.org` is served with a CSP containing the `upgrade-insecure-requests` directive, and the document contains markup like this:

html
```
<script src="http://example.org/my-cat.js"></script>
<script src="http://not-example.org/another-cat.js"></script>

```

The browser will automatically upgrade both of these requests to HTTPS.

Suppose the document also contains this:

html
```
<a href="http://example.org/more-cats">See some more cats!</a>
<a href="http://not-example.org/even-more-cats">More cats, on another site!</a>

```

The browser will upgrade the first link to HTTPS, but not the second, as it is navigating to a different origin.

This directive is not a substitute for the [`Strict-Transport-Security`](/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security) header (also known as HSTS), because it does not upgrade external links to a site. Sites should include this directive and the `Strict-Transport-Security` header.

## [Testing your policy](#testing_your_policy)

To ease deployment, CSP can be deployed in report-only mode.
The policy is not enforced, but any violations are sent to the reporting endpoint specified in the policy. Additionally, a report-only header can be used to test a future revision to a policy without actually deploying it.

You can use the [`Content-Security-Policy-Report-Only`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only) HTTP header to specify your policy, like this:

http
```
Content-Security-Policy-Report-Only: policy

```

If both a [`Content-Security-Policy-Report-Only`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only) header and a [`Content-Security-Policy`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy) header are present in the same response, both policies are honored.
The policy specified in `Content-Security-Policy` headers is enforced while the `Content-Security-Policy-Report-Only` policy generates reports but is not enforced.

Note that unlike a normal content security policy, a report-only policy cannot be delivered in a `<meta>` element.

### [Violation reporting](#violation_reporting)

The recommended method for reporting CSP violations is to use the [Reporting API](/en-US/docs/Web/API/Reporting_API), declaring endpoints in [`Reporting-Endpoints`](/en-US/docs/Web/HTTP/Headers/Reporting-Endpoints) and specifying one of them as the CSP reporting target using the `Content-Security-Policy` header's [`report-to`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to) directive.

**Warning:**
You can also use the CSP [`report-uri`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri) directive to specify a target URL for CSP violation reports.
This sends a slightly different JSON report format via a `POST` operation with a [`Content-Type`](/en-US/docs/Web/HTTP/Headers/Content-Type) of `application/csp-report`.
This approach is deprecated, but you should declare both until [`report-to`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to) is supported in all browsers.
For more information about the approach see the [`report-uri`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri) topic.

A server can inform clients where to send reports using the [`Reporting-Endpoints`](/en-US/docs/Web/HTTP/Headers/Reporting-Endpoints) HTTP response header.
This header defines one or more endpoint URLs as a comma-separated list.
For example, to define a reporting endpoint named `csp-endpoint` which accepts reports at `https://example.com/csp-reports`, the server's response header could look like this:

http
```
Reporting-Endpoints: csp-endpoint="https://example.com/csp-reports"

```

If you want to have multiple endpoints that handle different types of reports, you would specify them like this:

http
```
Reporting-Endpoints: csp-endpoint="https://example.com/csp-reports",
                     hpkp-endpoint="https://example.com/hpkp-reports"

```

You can then use the `Content-Security-Policy` header's [`report-to`](/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to) directive to specify that a particular defined endpoint should be used for reporting.
For example, to send CSP violation reports to `https://example.com/csp-reports` for the `default-src`, you might send response headers that look like the following:

http
```
Reporting-Endpoints: csp-endpoint="https://example.com/csp-reports"
Content-Security-Policy: default-src 'self'; report-to csp-endpoint

```

When a CSP violation occurs, the browser sends the report as a JSON object to the specified endpoint via an HTTP `POST` operation, with a [`Content-Type`](/en-US/docs/Web/HTTP/Headers/Content-Type) of `application/reports+json`.
The report is a serialized form of the [`Report`](/en-US/docs/Web/API/Report) object containing a `type` property with a value of `"csp-violation"`, and a `body` that is the serialized form of a [`CSPViolationReportBody`](/en-US/docs/Web/API/CSPViolationReportBody) object.

A typical object might look like this:

json
```
{
  "age": 53531,
  "body": {
    "blockedURL": "inline",
    "columnNumber": 39,
    "disposition": "enforce",
    "documentURL": "https://example.com/csp-report",
    "effectiveDirective": "script-src-elem",
    "lineNumber": 121,
    "originalPolicy": "default-src 'self'; report-to csp-endpoint-name",
    "referrer": "https://www.google.com/",
    "sample": "console.log(\"lo\")",
    "sourceFile": "https://example.com/csp-report",
    "statusCode": 200
  },
  "type": "csp-violation",
  "url": "https://example.com/csp-report",
  "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"
}

```

You need to set up a server to receive reports with the given JSON format and content type.
The server handling these requests can then store or process the incoming reports in a way that best suits your needs.

## [See also](#see_also)

* [Mitigate cross-site scripting with a strict Content Security Policy](https://web.dev/articles/strict-csp) on web.dev (2024)
* [Content Security Policy: A successful mess between hardening and mitigation](https://infocondb.org/con/locomocosec/locomocosec-2019/content-security-policy-a-successful-mess-between-hardening-and-mitigation)
* [Content Security Policy Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html) on owasp.org
* [CSP Evaluator](https://csp-evaluator.withgoogle.com/)
## Help improve MDN

Was this page helpful to you?YesNo[Learn how to contribute](https://github.com/mdn/content/blob/main/CONTRIBUTING.md "This will take you to our contribution guidelines on GitHub.").

This page was last modified on Dec 19, 2024 by [MDN contributors](/en-US/docs/Web/HTTP/CSP/contributors.txt).

[View this page on GitHub](https://github.com/mdn/content/blob/main/files/en-us/web/http/csp/index.md?plain=1 "Folder: en-us/web/http/csp (Opens in a new tab)") â¢ [Report a problem with this content](https://github.com/mdn/content/issues/new?template=page-report.yml&mdn-url=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FCSP&metadata=%3C%21--+Do+not+make+changes+below+this+line+--%3E%0A%3Cdetails%3E%0A%3Csummary%3EPage+report+details%3C%2Fsummary%3E%0A%0A*+Folder%3A+%60en-us%2Fweb%2Fhttp%2Fcsp%60%0A*+MDN+URL%3A+https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FCSP%0A*+GitHub+URL%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fblob%2Fmain%2Ffiles%2Fen-us%2Fweb%2Fhttp%2Fcsp%2Findex.md%0A*+Last+commit%3A+https%3A%2F%2Fgithub.com%2Fmdn%2Fcontent%2Fcommit%2F5b20f5f4265f988f80f513db0e4b35c7e0cd70dc%0A*+Document+last+modified%3A+2024-12-19T15%3A37%3A45.000Z%0A%0A%3C%2Fdetails%3E "This will take you to GitHub to file a new issue.")[MDN logo](/)

Your blueprint for a better internet.

* [MDN on Mastodon](https://mastodon.social/%40mdn)
* [MDN on X (formerly Twitter)](https://twitter.com/mozdevnet)
* [MDN on GitHub](https://github.com/mdn/)
* [MDN Blog RSS Feed](/en-US/blog/rss.xml)
## MDN

* [About](/en-US/about)
* [Blog](/en-US/blog/)
* [Careers](https://www.mozilla.org/en-US/careers/listings/?team=ProdOps)
* [Advertise with us](/en-US/advertising)
## Support

* [Product help](https://support.mozilla.org/products/mdn-plus)
* [Report an issue](/en-US/docs/MDN/Community/Issues)
## Our communities

* [MDN Community](/en-US/community)
* [MDN Forum](https://discourse.mozilla.org/c/mdn/236)
* [MDN Chat](/discord)
## Developers

* [Web Technologies](/en-US/docs/Web)
* [Learn Web Development](/en-US/docs/Learn)
* [MDN Plus](/en-US/plus)
* [Hacks Blog](https://hacks.mozilla.org/)
[Mozilla logo](https://www.mozilla.org/)

* [Website Privacy Notice](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/terms/mozilla)
* [Community Participation Guidelines](https://www.mozilla.org/about/governance/policies/participation/)

Visit [Mozilla Corporationâs](https://www.mozilla.org) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/).
Portions of this content are Â©1998â2025 by individual mozilla.org contributors. Content available under [a Creative Commons license](/en-US/docs/MDN/Writing_guidelines/Attrib_copyright_license).

