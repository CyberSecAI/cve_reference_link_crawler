<html lang="en" op="item"><head><meta name="referrer" content="origin"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="news.css?Brdi972UYWdRcVgheWmW">
        <link rel="icon" href="y18.svg">
    <link rel="canonical" href="https://news.ycombinator.com/item?id=40284111"/>            <title>Novel attack against virtually all VPN apps neuters their entire purpose | Hacker News</title></head><body><center><table id="hnmain" border="0" cellpadding="0" cellspacing="0" width="85%" bgcolor="#f6f6ef">
        <tr><td bgcolor="#ff6600"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="padding:2px"><tr><td style="width:18px;padding-right:4px"><a href="https://news.ycombinator.com"><img src="y18.svg" width="18" height="18" style="border:1px white solid; display:block"></a></td>
                  <td style="line-height:12pt; height:10px;"><span class="pagetop"><b class="hnname"><a href="news">Hacker News</a></b>
                            <a href="newest">new</a> | <a href="front">past</a> | <a href="newcomments">comments</a> | <a href="ask">ask</a> | <a href="show">show</a> | <a href="jobs">jobs</a> | <a href="submit" rel="nofollow">submit</a>            </span></td><td style="text-align:right;padding-right:4px;"><span class="pagetop">
                              <a href="login?goto=item%3Fid%3D40284111">login</a>
                          </span></td>
              </tr></table></td></tr>
<tr id="pagespace" title="Novel attack against virtually all VPN apps neuters their entire purpose" style="height:10px"></tr><tr><td><table class="fatitem" border="0">
        <tr class='athing submission' id='40284111'>
      <td align="right" valign="top" class="title"><span class="rank"></span></td>      <td valign="top" class="votelinks"><center><a id='up_40284111' href='vote?id=40284111&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center></td><td class="title"><span class="titleline"><a href="https://arstechnica.com/security/2024/05/novel-attack-against-virtually-all-vpn-apps-neuters-their-entire-purpose/">Novel attack against virtually all VPN apps neuters their entire purpose</a><span class="sitebit comhead"> (<a href="from?site=arstechnica.com"><span class="sitestr">arstechnica.com</span></a>)</span></span></td></tr><tr><td colspan="2"></td><td class="subtext"><span class="subline">
          <span class="score" id="score_40284111">204 points</span> by <a href="user?id=quibuss" class="hnuser">quibuss</a> <span class="age" title="2024-05-07T10:47:46 1715078866"><a href="item?id=40284111">8 months ago</a></span> <span id="unv_40284111"></span> | <a href="hide?id=40284111&amp;goto=item%3Fid%3D40284111">hide</a> | <a href="https://hn.algolia.com/?query=Novel%20attack%20against%20virtually%20all%20VPN%20apps%20neuters%20their%20entire%20purpose&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0" class="hnpast">past</a> | <a href="fave?id=40284111&amp;auth=d649c524e8eb65f69a199acbd215611d618bf880">favorite</a> | <a href="item?id=40284111">76&nbsp;comments</a>        </span>
              </td></tr>
        </table><br><br><table border="0" class='comment-tree'>
            <tr class='athing comtr' id='40284312'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284312' href='vote?id=40284312&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=agwa" class="hnuser">agwa</a> <span class="age" title="2024-05-07T11:27:55 1715081275"><a href="item?id=40284312">8 months ago</a></span> <span id="unv_40284312"></span>          <span class='navs'>
             | <a href="#40284628" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284312" n="9" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I mentioned attacks using DHCP option 121 (aka &quot;classless static routes&quot;) nearly 9 years ago in my blog post about attacks on OpenVPN: <a href="https:&#x2F;&#x2F;www.agwa.name&#x2F;blog&#x2F;post&#x2F;hardening_openvpn_for_def_con" rel="nofollow">https:&#x2F;&#x2F;www.agwa.name&#x2F;blog&#x2F;post&#x2F;hardening_openvpn_for_def_co...</a> (under &quot;Attacks on redirect-gateway&quot;)<p>It&#x27;s really hard to make a robust VPN.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40287317'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40287317' href='vote?id=40287317&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=JeremyNT" class="hnuser">JeremyNT</a> <span class="age" title="2024-05-07T15:55:21 1715097321"><a href="item?id=40287317">8 months ago</a></span> <span id="unv_40287317"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">parent</a> | <a href="#40284904" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40287317" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Your writeup is IMO much better than the way this is being reported.<p>FWIW, I remember reading something similar years ago (I&#x27;m not certain it was your specific post, but it might have been). It&#x27;s strange to see this being described as &quot;novel&quot; now, unless there&#x27;s something new to it that I am missing.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40284904'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40284904' href='vote?id=40284904&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mycall" class="hnuser">mycall</a> <span class="age" title="2024-05-07T12:56:41 1715086601"><a href="item?id=40284904">8 months ago</a></span> <span id="unv_40284904"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">parent</a> | <a href="#40287317" class="clicky" aria-hidden="true">prev</a> | <a href="#40284628" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284904" n="7" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">How hard is it for a firewall to block option 121 (and 33)?<p>Cloudflare WARP made a robust VPN but is not cheap.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285603'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40285603' href='vote?id=40285603&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=gruez" class="hnuser">gruez</a> <span class="age" title="2024-05-07T14:05:41 1715090741"><a href="item?id=40285603">8 months ago</a></span> <span id="unv_40285603"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">root</a> | <a href="#40284904" class="clicky" aria-hidden="true">parent</a> | <a href="#40284950" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285603" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It&#x27;s probably more straightforward to have the firewall block all traffic from using the non-VPN interfaces (ie. blacklist approach) instead. In the other thread[1] there was disagreement about whether commercial VPN services actually implement their &#x27;killswitch&quot; in this way. Apparently NordVPN does not (hearsay), but neither side provided a good survey of other providers.<p>[1] <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40279632">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40279632</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40284950'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40284950' href='vote?id=40284950&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=agwa" class="hnuser">agwa</a> <span class="age" title="2024-05-07T13:01:53 1715086913"><a href="item?id=40284950">8 months ago</a></span> <span id="unv_40284950"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">root</a> | <a href="#40284904" class="clicky" aria-hidden="true">parent</a> | <a href="#40285603" class="clicky" aria-hidden="true">prev</a> | <a href="#40301769" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284950" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Ignoring or blocking these options is trivial but ineffective since the DHCP server can still send a malicious subnet mask.<p>(Edited to replace &quot;default gateway&quot; with &quot;subnet mask&quot;)</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285478'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_40285478' href='vote?id=40285478&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=peddling-brink" class="hnuser">peddling-brink</a> <span class="age" title="2024-05-07T13:53:51 1715090031"><a href="item?id=40285478">8 months ago</a></span> <span id="unv_40285478"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">root</a> | <a href="#40284950" class="clicky" aria-hidden="true">parent</a> | <a href="#40301769" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285478" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Forgive my ignorance, but what could a malicious gateway do in this instance?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285564'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_40285564' href='vote?id=40285564&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=agwa" class="hnuser">agwa</a> <span class="age" title="2024-05-07T14:01:59 1715090519"><a href="item?id=40285564">8 months ago</a></span> <span id="unv_40285564"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">root</a> | <a href="#40285478" class="clicky" aria-hidden="true">parent</a> | <a href="#40301769" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285564" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Whoops, I posted too early in the morning, I meant to say &quot;malicious subnet mask&quot; :-)<p>Basically, the DHCP server sends a subnet mask for an absolutely huge subnet (e.g. a &#x2F;2), and the route for that subnet takes precedence over the VPN route.   The attacker can only intercept 25% of the IPv4 address space with a &#x2F;2 but that&#x27;s still pretty bad.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40290768'><td><table border='0'>  <tr>    <td class='ind' indent='5'><img src="s.gif" height="1" width="200"></td><td valign="top" class="votelinks">
      <center><a id='up_40290768' href='vote?id=40290768&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=peddling-brink" class="hnuser">peddling-brink</a> <span class="age" title="2024-05-07T19:55:52 1715111752"><a href="item?id=40290768">8 months ago</a></span> <span id="unv_40290768"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">root</a> | <a href="#40285564" class="clicky" aria-hidden="true">parent</a> | <a href="#40301769" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40290768" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Clever, thanks!</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                              <tr class='athing comtr' id='40301769'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40301769' href='vote?id=40301769&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=felixg3" class="hnuser">felixg3</a> <span class="age" title="2024-05-08T19:05:49 1715195149"><a href="item?id=40301769">8 months ago</a></span> <span id="unv_40301769"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">root</a> | <a href="#40284904" class="clicky" aria-hidden="true">parent</a> | <a href="#40284950" class="clicky" aria-hidden="true">prev</a> | <a href="#40284628" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40301769" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Cloudflare Warp is free, I think - if you create a Zero Trust Organisation for free and configure the Warp client to use it, you can use unmetered Warp+ with Argo routing without charge.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='40284628'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284628' href='vote?id=40284628&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=dmm" class="hnuser">dmm</a> <span class="age" title="2024-05-07T12:23:27 1715084607"><a href="item?id=40284628">8 months ago</a></span> <span id="unv_40284628"></span>          <span class='navs'>
             | <a href="#40284312" class="clicky" aria-hidden="true">prev</a> | <a href="#40285079" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284628" n="5" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Would isolating a Wireguard interface using namespaces as described here[0] mitigate this?<p>[0] <a href="https:&#x2F;&#x2F;www.wireguard.com&#x2F;netns&#x2F;#the-new-namespace-solution" rel="nofollow">https:&#x2F;&#x2F;www.wireguard.com&#x2F;netns&#x2F;#the-new-namespace-solution</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285027'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285027' href='vote?id=40285027&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=agwa" class="hnuser">agwa</a> <span class="age" title="2024-05-07T13:11:49 1715087509"><a href="item?id=40285027">8 months ago</a></span> <span id="unv_40285027"></span>          <span class='navs'>
             | <a href="#40284628" class="clicky" aria-hidden="true">parent</a> | <a href="#40285079" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285027" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Yes, namespaces are the gold standard solution.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285566'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40285566' href='vote?id=40285566&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=bscphil" class="hnuser">bscphil</a> <span class="age" title="2024-05-07T14:02:08 1715090528"><a href="item?id=40285566">8 months ago</a></span> <span id="unv_40285566"></span>          <span class='navs'>
             | <a href="#40284628" class="clicky" aria-hidden="true">root</a> | <a href="#40285027" class="clicky" aria-hidden="true">parent</a> | <a href="#40285079" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285566" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">In addition, wg-quick appears to use the rule-based solution with multiple tables by default. As I understand it this should make Wireguard (with wg-quick) users on Linux immune to this attack. My default route sends traffic to my gateway, not my VPN:<p><pre><code>    default via &lt;gateway ip&gt; dev host0 proto static
</code></pre>
So there&#x27;s nothing for an attacker to do here. They could make themselves my gateway perhaps, but the `ip rule` would still send my traffic to Wireguard and the result would not be readable.<p>The issue described in the article is what happens if you take the most basic approach, which is described in the Wireguard article: &quot;instead of replacing the default route, we can just override it with two more specific rules that add up in sum to the default, but match before the default&quot;. This is historically what OpenVPN has done, and it&#x27;s vulnerable to this issue.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285693'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_40285693' href='vote?id=40285693&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=agwa" class="hnuser">agwa</a> <span class="age" title="2024-05-07T14:13:25 1715091205"><a href="item?id=40285693">8 months ago</a></span> <span id="unv_40285693"></span>          <span class='navs'>
             | <a href="#40284628" class="clicky" aria-hidden="true">root</a> | <a href="#40285566" class="clicky" aria-hidden="true">parent</a> | <a href="#40285079" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285693" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">In general, rule-based solutions are good if they use fwmark, but this gives me pause:<p>&gt; And finally we add a convenience feature for still accessing the local network, whereby we allow packets without the fwmark to use the main routing table, not the WireGuard interface&#x27;s routing table, if it matches any routes in it with a prefix length greater than zero, such as non-default local routes. [<a href="https:&#x2F;&#x2F;www.wireguard.com&#x2F;netns&#x2F;#improved-rule-based-routing" rel="nofollow">https:&#x2F;&#x2F;www.wireguard.com&#x2F;netns&#x2F;#improved-rule-based-routing</a>]<p>Doesn&#x27;t that completely neutralize the protection against a DHCP server sending malicious routes or a gigantic subnet mask?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40289244'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_40289244' href='vote?id=40289244&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=zokier" class="hnuser">zokier</a> <span class="age" title="2024-05-07T18:00:34 1715104834"><a href="item?id=40289244">8 months ago</a></span> <span id="unv_40289244"></span>          <span class='navs'>
             | <a href="#40284628" class="clicky" aria-hidden="true">root</a> | <a href="#40285693" class="clicky" aria-hidden="true">parent</a> | <a href="#40285079" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40289244" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">its just a default convenience feature from wg-quick, its not intended to be something that fits all usecases; on trusted networks split-tunneling like that makes lot of sense</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                                    <tr class='athing comtr' id='40285079'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40285079' href='vote?id=40285079&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=fxtentacle" class="hnuser">fxtentacle</a> <span class="age" title="2024-05-07T13:16:40 1715087800"><a href="item?id=40285079">8 months ago</a></span> <span id="unv_40285079"></span>          <span class='navs'>
             | <a href="#40284628" class="clicky" aria-hidden="true">prev</a> | <a href="#40284745" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285079" n="11" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&quot;there are no ways to prevent such attacks except when the user&#x27;s VPN runs on Linux or Android&quot;<p>I guess it really is the year of the Linux desktop :)</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285161'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285161' href='vote?id=40285161&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=51Cards" class="hnuser">51Cards</a> <span class="age" title="2024-05-07T13:25:27 1715088327"><a href="item?id=40285161">8 months ago</a></span> <span id="unv_40285161"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">parent</a> | <a href="#40285671" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285161" n="6" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Sadly, I&#x27;ve read similar comments for 10+ years now and yet, here we still are.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285711'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40285711' href='vote?id=40285711&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=999900000999" class="hnuser">999900000999</a> <span class="age" title="2024-05-07T14:14:34 1715091274"><a href="item?id=40285711">8 months ago</a></span> <span id="unv_40285711"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">root</a> | <a href="#40285161" class="clicky" aria-hidden="true">parent</a> | <a href="#40285626" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285711" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Do we want Linux going mainstream?<p>Do you want every distro turning into Ubuntu with cloud services and telemetry all over the place ?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40286428'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_40286428' href='vote?id=40286428&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=anthk" class="hnuser">anthk</a> <span class="age" title="2024-05-07T15:01:11 1715094071"><a href="item?id=40286428">8 months ago</a></span> <span id="unv_40286428"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">root</a> | <a href="#40285711" class="clicky" aria-hidden="true">parent</a> | <a href="#40285626" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286428" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">As long as Trisquel, Hyperbola or Guix exist, who cares.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40293682'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_40293682' href='vote?id=40293682&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=Zuiii" class="hnuser">Zuiii</a> <span class="age" title="2024-05-08T02:09:19 1715134159"><a href="item?id=40293682">8 months ago</a></span> <span id="unv_40293682"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">root</a> | <a href="#40286428" class="clicky" aria-hidden="true">parent</a> | <a href="#40285626" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40293682" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; who cares.<p>Oh most of us will definitely care once linux developers start targeting the Ubuntus instead of the Trisquels (like how developers now target &quot;android&quot; instead of AOSP). I mean just look at how Gnome behaves now that it is the default DE.<p>A truly mainstream distro would be the death of the Linux desktop. I hope that year never comes.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40295824'><td><table border='0'>  <tr>    <td class='ind' indent='5'><img src="s.gif" height="1" width="200"></td><td valign="top" class="votelinks">
      <center><a id='up_40295824' href='vote?id=40295824&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=anthk" class="hnuser">anthk</a> <span class="age" title="2024-05-08T09:03:25 1715159005"><a href="item?id=40295824">8 months ago</a></span> <span id="unv_40295824"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">root</a> | <a href="#40293682" class="clicky" aria-hidden="true">parent</a> | <a href="#40285626" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40295824" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">As long as the code is libre, the Ubuntu LTS releases will perfectly map the Trisquel ones.<p>Today, if some service needs propietary code, it&#x27;s doomed to rot.<p>For firmware with desktop users and programmers&#x2F;devops using Ubuntu at work -not an issue on servers- , it&#x27;s preferable to use  the Xanmod kernel with Trisquel than falling into thw whole cascade of propietary code in Ubuntu.<p>At least nonfree firmware it&#x27;s a non burnt hardware ROM; that setup it&#x27;s 90% free according to the FSF values. Also, you don&#x27;t get overlayed taxing crap as snaps.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                              <tr class='athing comtr' id='40285626'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40285626' href='vote?id=40285626&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=rokkitmensch" class="hnuser">rokkitmensch</a> <span class="age" title="2024-05-07T14:08:02 1715090882"><a href="item?id=40285626">8 months ago</a></span> <span id="unv_40285626"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">root</a> | <a href="#40285161" class="clicky" aria-hidden="true">parent</a> | <a href="#40285711" class="clicky" aria-hidden="true">prev</a> | <a href="#40285671" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285626" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Don&#x27;t worry: Apples desktop quality is degrading so quickly it will be The Year of Linux on the Desktop by the end of the decade!</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40285671'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285671' href='vote?id=40285671&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=coldtea" class="hnuser">coldtea</a> <span class="age" title="2024-05-07T14:11:39 1715091099"><a href="item?id=40285671">8 months ago</a></span> <span id="unv_40285671"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">parent</a> | <a href="#40285161" class="clicky" aria-hidden="true">prev</a> | <a href="#40286184" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285671" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">So, it sounds like something that can be trivially implemented just as well on Windows, macOS, iOS, and xBSD?<p>If Linux can do it, why not the others?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40289183'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40289183' href='vote?id=40289183&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=zokier" class="hnuser">zokier</a> <span class="age" title="2024-05-07T17:55:36 1715104536"><a href="item?id=40289183">8 months ago</a></span> <span id="unv_40289183"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">root</a> | <a href="#40285671" class="clicky" aria-hidden="true">parent</a> | <a href="#40286184" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40289183" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I&#x27;d imagine on openbsd rdomains might help here, but I&#x27;m not openbsd guru</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40286184'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40286184' href='vote?id=40286184&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=anon84873628" class="hnuser">anon84873628</a> <span class="age" title="2024-05-07T14:48:04 1715093284"><a href="item?id=40286184">8 months ago</a></span> <span id="unv_40286184"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">parent</a> | <a href="#40285671" class="clicky" aria-hidden="true">prev</a> | <a href="#40284745" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286184" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">And yet the article goes on to say that Linux doesn&#x27;t fully mitigate the issue. Confusing.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40287221'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40287221' href='vote?id=40287221&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=alexpc201" class="hnuser">alexpc201</a> <span class="age" title="2024-05-07T15:48:35 1715096915"><a href="item?id=40287221">8 months ago</a></span> <span id="unv_40287221"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">root</a> | <a href="#40286184" class="clicky" aria-hidden="true">parent</a> | <a href="#40284745" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40287221" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Linux doesn’t mitigate it out of the box, but you can do this: <a href="https:&#x2F;&#x2F;www.wireguard.com&#x2F;netns&#x2F;#the-new-namespace-solution" rel="nofollow">https:&#x2F;&#x2F;www.wireguard.com&#x2F;netns&#x2F;#the-new-namespace-solution</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='40284745'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284745' href='vote?id=40284745&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=this_user" class="hnuser">this_user</a> <span class="age" title="2024-05-07T12:36:22 1715085382"><a href="item?id=40284745">8 months ago</a></span> <span id="unv_40284745"></span>          <span class='navs'>
             | <a href="#40285079" class="clicky" aria-hidden="true">prev</a> | <a href="#40285154" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284745" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">The real problem with all of this is that DHCP has a lot of weird legacy options that most people are not aware off and that may or may not be fully implemented on most clients, but some of which that are pretty powerful. And in practice, clients  trust DHCP servers implicitly, because it&#x27;s an old protocol that didn&#x27;t really consider the possibility that you may be on a LAN where the DHCP cannot be trusted.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285018'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285018' href='vote?id=40285018&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=agwa" class="hnuser">agwa</a> <span class="age" title="2024-05-07T13:10:29 1715087429"><a href="item?id=40285018">8 months ago</a></span> <span id="unv_40285018"></span>          <span class='navs'>
             | <a href="#40284745" class="clicky" aria-hidden="true">parent</a> | <a href="#40285154" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285018" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">That&#x27;s not really the problem - DHCP&#x27;s subnet mask option is definitely not weird or legacy but can also be used to execute these attacks.<p>The real problem is that encrypted packets from the VPN client use the same routing table as unencrypted packets from applications.  This makes it very difficult to create a robust routing policy that says &quot;all unencrypted packets are routed via the VPN, and all encrypted packets are routed via the physical network interface&quot;.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40289167'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40289167' href='vote?id=40289167&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=zokier" class="hnuser">zokier</a> <span class="age" title="2024-05-07T17:54:25 1715104465"><a href="item?id=40289167">8 months ago</a></span> <span id="unv_40289167"></span>          <span class='navs'>
             | <a href="#40284745" class="clicky" aria-hidden="true">root</a> | <a href="#40285018" class="clicky" aria-hidden="true">parent</a> | <a href="#40285154" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40289167" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; The real problem is that encrypted packets from the VPN client use the same routing table as unencrypted packets from applications<p>worth noting that this really is very dependent on the specifics of your VPN implementation. For example StrongSwan (ipsec) and WireGuard by default afaik use separate route tables. In general using separate route tables for virtual vs physical networks is not exactly rocket science.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='40285154'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40285154' href='vote?id=40285154&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=jacob019" class="hnuser">jacob019</a> <span class="age" title="2024-05-07T13:24:33 1715088273"><a href="item?id=40285154">8 months ago</a></span> <span id="unv_40285154"></span>          <span class='navs'>
             | <a href="#40284745" class="clicky" aria-hidden="true">prev</a> | <a href="#40287027" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285154" n="6" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It seems that this is only an issue if there is a malicious actor present on the remote network.  I&#x27;ve always considered VPN services to be snakeoil, and this doesn&#x27;t really seem like a problem with VPN technology at all.  If you are connecting to an untrusted network, then you are at risk.  This has always been true.  From the VPN service providers perspective, can&#x27;t this be mitigated by blocking direct traffic between clients?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40289579'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40289579' href='vote?id=40289579&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=WirelessGigabit" class="hnuser">WirelessGigabit</a> <span class="age" title="2024-05-07T18:24:55 1715106295"><a href="item?id=40289579">8 months ago</a></span> <span id="unv_40289579"></span>          <span class='navs'>
             | <a href="#40285154" class="clicky" aria-hidden="true">parent</a> | <a href="#40285437" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40289579" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">But VPNs are sold as the solution for when you are on an untrusted network, like at Starbucks.<p>But, because of this someone can have a Pineapple with a Starbucks SSID, push option 121 and capture a WHOLE bunch of traffic, even though the person using it has configured NordVPN on their iPhone with the killswitch on.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40293295'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40293295' href='vote?id=40293295&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=ang_cire" class="hnuser">ang_cire</a> <span class="age" title="2024-05-08T01:01:36 1715130096"><a href="item?id=40293295">8 months ago</a></span> <span id="unv_40293295"></span>          <span class='navs'>
             | <a href="#40285154" class="clicky" aria-hidden="true">root</a> | <a href="#40289579" class="clicky" aria-hidden="true">parent</a> | <a href="#40285437" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40293295" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">My VPN is for my tunnel out of my home network, not for remote networks. This is definitely a major issue if mitigations aren&#x27;t implemented, but it&#x27;s not relevant to all use cases for VPNs.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40285437'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285437' href='vote?id=40285437&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=bscphil" class="hnuser">bscphil</a> <span class="age" title="2024-05-07T13:50:14 1715089814"><a href="item?id=40285437">8 months ago</a></span> <span id="unv_40285437"></span>          <span class='navs'>
             | <a href="#40285154" class="clicky" aria-hidden="true">parent</a> | <a href="#40289579" class="clicky" aria-hidden="true">prev</a> | <a href="#40287027" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285437" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">&gt; It seems that this is only an issue if there is a malicious actor present on the remote network.<p>As I understand it, the problem comes not from the remote network provided by the VPN, but by the local network - the physical link over which the user accesses the Internet.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285694'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40285694' href='vote?id=40285694&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=jacob019" class="hnuser">jacob019</a> <span class="age" title="2024-05-07T14:13:32 1715091212"><a href="item?id=40285694">8 months ago</a></span> <span id="unv_40285694"></span>          <span class='navs'>
             | <a href="#40285154" class="clicky" aria-hidden="true">root</a> | <a href="#40285437" class="clicky" aria-hidden="true">parent</a> | <a href="#40285616" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285694" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Ah, thanks for explaining. So this is only an issue if there is a malicious actor present on the local network.  I would say that you are already compromised at that point.  Say you are using public WIFI, a VPN service is pointless, you already have an anonymous public IP.  Anything sensitive is encrypted end-to-end.  And most public WIFI has client isolation.  I suppose it could be a problem in certain countries, if your ISP can find out that you&#x27;re visiting banned sites with a VPN.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40285616'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40285616' href='vote?id=40285616&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=gruez" class="hnuser">gruez</a> <span class="age" title="2024-05-07T14:06:47 1715090807"><a href="item?id=40285616">8 months ago</a></span> <span id="unv_40285616"></span>          <span class='navs'>
             | <a href="#40285154" class="clicky" aria-hidden="true">root</a> | <a href="#40285437" class="clicky" aria-hidden="true">parent</a> | <a href="#40285694" class="clicky" aria-hidden="true">prev</a> | <a href="#40287027" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285616" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">eg. malicious wifi hotspot</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='40287027'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40287027' href='vote?id=40287027&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=gz5" class="hnuser">gz5</a> <span class="age" title="2024-05-07T15:36:26 1715096186"><a href="item?id=40287027">8 months ago</a></span> <span id="unv_40287027"></span>          <span class='navs'>
             | <a href="#40285154" class="clicky" aria-hidden="true">prev</a> | <a href="#40284433" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40287027" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Encapsulate and encrypt in the app itself, or in the browser.<p>App (via the openziti sdk):
<a href="https:&#x2F;&#x2F;blog.openziti.io&#x2F;no-listening-ports" rel="nofollow">https:&#x2F;&#x2F;blog.openziti.io&#x2F;no-listening-ports</a><p>Browser (the openziti js sdk loads on the fly):
<a href="https:&#x2F;&#x2F;blog.openziti.io&#x2F;introducing-openziti-browzer" rel="nofollow">https:&#x2F;&#x2F;blog.openziti.io&#x2F;introducing-openziti-browzer</a><p>Disclosure: openziti (apache v2) maintainer</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40287280'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40287280' href='vote?id=40287280&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=russfink" class="hnuser">russfink</a> <span class="age" title="2024-05-07T15:52:02 1715097122"><a href="item?id=40287280">8 months ago</a></span> <span id="unv_40287280"></span>          <span class='navs'>
             | <a href="#40287027" class="clicky" aria-hidden="true">parent</a> | <a href="#40284433" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40287280" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Agree. The stated attack is not against an end to end solution.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40284433'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284433' href='vote?id=40284433&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=londons_explore" class="hnuser">londons_explore</a> <span class="age" title="2024-05-07T11:50:26 1715082626"><a href="item?id=40284433">8 months ago</a></span> <span id="unv_40284433"></span>          <span class='navs'>
             | <a href="#40287027" class="clicky" aria-hidden="true">prev</a> | <a href="#40285904" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284433" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It&#x27;s because networks&#x2F;routing tables aren&#x27;t really designed with security principles in mind.<p>If they were, it would be a simple setting to set an ACL on the network interface to say &quot;DENY all traffic except from VPN application&quot;.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40284614'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40284614' href='vote?id=40284614&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=ta1243" class="hnuser">ta1243</a> <span class="age" title="2024-05-07T12:21:33 1715084493"><a href="item?id=40284614">8 months ago</a></span> <span id="unv_40284614"></span>          <span class='navs'>
             | <a href="#40284433" class="clicky" aria-hidden="true">parent</a> | <a href="#40289203" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284614" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">You seem to be conflating routing and firewalling&#x2F;access control.<p>You can control your routing table using standard tools (ip route add). You can have helper applications work on it, and get hints from external sources like dhcp, where you can listen to its suggestions (IP, subnet, DNS, extra routes, and other options), or ignore them.<p>If you take those hints then that&#x27;s your choice.<p>With icmp redirects you can choose to allow them or not with settings like net.ipv4.conf.all.accept_redirects.<p>Then as a belt and braces you have iptables. If you want an ACL on the network interface to say &quot;DENY all traffic except from VPN application&quot;, then set your input&#x2F;output&#x2F;forward chains to default deny and have a rule to allow from pid=$vpn_pid. I believe you can use pid in pre&#x2F;postrouting chains.<p>Personally when I&#x27;m travelling I have rules which only allow access to my vpn targets, and from memory just DHCP and arp. Have to temporarily disable it for captive portals but then it&#x27;s back on. Sometimes a network won&#x27;t accept UDP, so I generally have to tether for normal response.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40289203'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40289203' href='vote?id=40289203&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=zokier" class="hnuser">zokier</a> <span class="age" title="2024-05-07T17:57:07 1715104627"><a href="item?id=40289203">8 months ago</a></span> <span id="unv_40289203"></span>          <span class='navs'>
             | <a href="#40284433" class="clicky" aria-hidden="true">parent</a> | <a href="#40284614" class="clicky" aria-hidden="true">prev</a> | <a href="#40285904" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40289203" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It is pretty simple to set routing like that on Linux.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40285904'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40285904' href='vote?id=40285904&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=flufluflufluffy" class="hnuser">flufluflufluffy</a> <span class="age" title="2024-05-07T14:28:39 1715092119"><a href="item?id=40285904">8 months ago</a></span> <span id="unv_40285904"></span>          <span class='navs'>
             | <a href="#40284433" class="clicky" aria-hidden="true">prev</a> | <a href="#40284695" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285904" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Not my area of expertise — can somebody clarify if the DHCP server runs on your router, or your local machine? The article keeps mentioning it needs to be on the “same network” but the graphic seems like it’s all on one device.<p>edit: ahh I’m dumb, it’s the router (correct me if I’m wrong!). So as others have said, you have to already be on a compromised network, yes?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40286883'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40286883' href='vote?id=40286883&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=numpad0" class="hnuser">numpad0</a> <span class="age" title="2024-05-07T15:27:02 1715095622"><a href="item?id=40286883">8 months ago</a></span> <span id="unv_40286883"></span>          <span class='navs'>
             | <a href="#40285904" class="clicky" aria-hidden="true">parent</a> | <a href="#40286090" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286883" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">DHCP is bit like hotel front and key slip. When a laptop connects to a Wi-Fi, it broadcasts DHCPDISCOVER message using the Wi-Fi card&#x27;s MAC address, to which local DHCP server responds with IP address + option strings, such as subnet mask, gateway IP, local timezone(but not time), local X Window Manager address, network FQDN, and so on. Every consumer Wi-Fi router has DHCP server program included and set to auto configure, and that is how it&#x27;s normally operated, but technically multiple servers can coexist within the same subnet, and the server computer doesn&#x27;t have to be itself the default gateway.<p>Among the options strings that DHCP server may provide is DHCP option 121 Classless Static Routes, added in 2002, that can &quot;push&quot; routing information to clients for convenience. Apparently this option 121 can be abused to trick your laptop into set and prioritize `route add [google.com] via [malicious_host] dev wlan0` over `route add [google.com] via [vpn_right] dev vpn0` which routes traffic to [google.com], or 0.0.0.0&#x2F;0 for that matter, through [malicious_host].<p>DHCP is more of a convenience feature for private IP address LANs, not strictly necessary for operating IP LAN. I&#x27;ve heard generations prior to ours sometimes leased clothespins labeled with IPs off the wall to guests, along instruction papers. DHCP completely automates that.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40286090'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40286090' href='vote?id=40286090&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=tithe" class="hnuser">tithe</a> <span class="age" title="2024-05-07T14:41:46 1715092906"><a href="item?id=40286090">8 months ago</a></span> <span id="unv_40286090"></span>          <span class='navs'>
             | <a href="#40285904" class="clicky" aria-hidden="true">parent</a> | <a href="#40286883" class="clicky" aria-hidden="true">prev</a> | <a href="#40284695" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286090" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">DHCP is a client-server protocol, so it &quot;runs&quot; both on the router (as a server program vending available IP addresses) and the local machine (as a client program initiating the request for an IP address, and ultimately accepting the given IP address from the DHCP server on the router).</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40284695'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284695' href='vote?id=40284695&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=jaggs" class="hnuser">jaggs</a> <span class="age" title="2024-05-07T12:31:12 1715085072"><a href="item?id=40284695">8 months ago</a></span> <span id="unv_40284695"></span>          <span class='navs'>
             | <a href="#40285904" class="clicky" aria-hidden="true">prev</a> | <a href="#40284820" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284695" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Android phones running VPNs are apparently still secure. They&#x27;re recommending using phone as hotspots if you can.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40284820'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284820' href='vote?id=40284820&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=gipsies" class="hnuser">gipsies</a> <span class="age" title="2024-05-07T12:45:57 1715085957"><a href="item?id=40284820">8 months ago</a></span> <span id="unv_40284820"></span>          <span class='navs'>
             | <a href="#40284695" class="clicky" aria-hidden="true">prev</a> | <a href="#40284591" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284820" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">There needs to be extra evidence before claiming that &quot;virtually all VPNs apps&quot; are vulnerable. From my understanding, they tested WireGuard on multiple platforms. However, other VPN clients may install extra firewall rules, I&#x27;ve seen that happen with VPNs on Windows&#x2F;macOS&#x2F;Linux.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40284591'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284591' href='vote?id=40284591&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=avsteele" class="hnuser">avsteele</a> <span class="age" title="2024-05-07T12:18:08 1715084288"><a href="item?id=40284591">8 months ago</a></span> <span id="unv_40284591"></span>          <span class='navs'>
             | <a href="#40284820" class="clicky" aria-hidden="true">prev</a> | <a href="#40285842" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284591" n="10" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">So every company who uses VPNs to allow their people to get into the network from offsite (customer site, airport, hotel) now can&#x27;t safely?<p>You basically have to trust everyone on the remote LAN to not act like a malicious DHCP server.<p>Reading the other thread, this wouldn&#x27;t even be just the gateway.. Sounds bad!</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40284706'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40284706' href='vote?id=40284706&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=skywhopper" class="hnuser">skywhopper</a> <span class="age" title="2024-05-07T12:32:11 1715085131"><a href="item?id=40284706">8 months ago</a></span> <span id="unv_40284706"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">parent</a> | <a href="#40284949" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284706" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Presumably most corporate VPNs are used to access specific resources on internal company networks, so if you were affected by this, those resources would fail to load entirely.<p>But also, if you were using more specific routes for your corporate VPN traffic and not just forwarding all traffic through it, then the simple attack of sending two &#x2F;1 rules wouldn’t interfere.<p>You’d still leak some metadata, but you leak a lot by using public networks anyway.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40284949'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40284949' href='vote?id=40284949&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=dspillett" class="hnuser">dspillett</a> <span class="age" title="2024-05-07T13:01:40 1715086900"><a href="item?id=40284949">8 months ago</a></span> <span id="unv_40284949"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">parent</a> | <a href="#40284706" class="clicky" aria-hidden="true">prev</a> | <a href="#40284606" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284949" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00"><i>&gt; You basically have to trust everyone on the remote LAN to not</i><p>More than that when connecting via WiFi as almost everyone on a laptop does these days: you have to be careful of “evil twin” attacks from random APs nearby.<p>Though if you are accessing a VPN to get access to internal network resources, and someone uses this hack to redirect you, you are not going to see those resources anyway and you&#x27;ll know something is wrong. Accessing any insecure resources is a risk (HTTP traffic can be monitored, fake servers could collect authentication credentials such as SSH user+pass info if not using key-based auth) but only if they are otherwise public because your redirected connection won&#x27;t be able to route to your corporate network&#x27;s internal hosts.<p>Unless I&#x27;m misreading (possible, I&#x27;ve only skimmed the details) those using VPNs because they already don&#x27;t trust their outgoing connection, or are otherwise wanting to disguise their ID and&#x2F;or location, are more at risk than road-worriers (or these days “home warriors” more likely) connecting to DayJob&#x27;s VPN.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285275'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40285275' href='vote?id=40285275&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=djbusby" class="hnuser">djbusby</a> <span class="age" title="2024-05-07T13:36:37 1715088997"><a href="item?id=40285275">8 months ago</a></span> <span id="unv_40285275"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">root</a> | <a href="#40284949" class="clicky" aria-hidden="true">parent</a> | <a href="#40284606" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285275" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">When I connect on SSH it verify the host-key. So, that would warn before submitting user&#x2F;pass (but also, user-key should be used)</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40297032'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_40297032' href='vote?id=40297032&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=dspillett" class="hnuser">dspillett</a> <span class="age" title="2024-05-08T12:03:13 1715169793"><a href="item?id=40297032">8 months ago</a></span> <span id="unv_40297032"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">root</a> | <a href="#40285275" class="clicky" aria-hidden="true">parent</a> | <a href="#40284606" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40297032" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">If doing SSH properly, yes.<p>Though for new hosts people often don&#x27;t verify the initial host key at all, just blindly accepting it, so that would be an extra risk vector.<p>Heck, I&#x27;m sure many don&#x27;t bother verifying a new key when they get the warning, instead just removing the old from .ssh&#x2F;known_hosts (or equivalent) to quiet the complaining! Though to be honest, with that security posture nothing is going to save them and our efforts are better spent securing others! I know at least one of our clients has automated systems that ignore key changes, because we once had a temporary config cockup that sent some connections to a host with the wrong key and some data was received there without any reported issues…</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='40284606'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40284606' href='vote?id=40284606&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=prmoustache" class="hnuser">prmoustache</a> <span class="age" title="2024-05-07T12:20:25 1715084425"><a href="item?id=40284606">8 months ago</a></span> <span id="unv_40284606"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">parent</a> | <a href="#40284949" class="clicky" aria-hidden="true">prev</a> | <a href="#40285337" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284606" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">On the other hand, it is fairly easy to obtain an ip, change your config to static ip reusing same ip, then and only then connect to the VPN.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40284616'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40284616' href='vote?id=40284616&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mschuster91" class="hnuser">mschuster91</a> <span class="age" title="2024-05-07T12:21:52 1715084512"><a href="item?id=40284616">8 months ago</a></span> <span id="unv_40284616"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">root</a> | <a href="#40284606" class="clicky" aria-hidden="true">parent</a> | <a href="#40297317" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284616" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It&#x27;s incredibly brittle. The more frequented a network is the shorter the DHCP leases will be, I&#x27;ve seen public hotspots with 10 minutes of lease time.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40284725'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_40284725' href='vote?id=40284725&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=prmoustache" class="hnuser">prmoustache</a> <span class="age" title="2024-05-07T12:34:21 1715085261"><a href="item?id=40284725">8 months ago</a></span> <span id="unv_40284725"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">root</a> | <a href="#40284616" class="clicky" aria-hidden="true">parent</a> | <a href="#40297317" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284725" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">That doesn&#x27;t mean the dhcp reuse the ip if it sees it used. Some old clients do not behave correctly and I believe DHCP servers take that into account.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40297317'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40297317' href='vote?id=40297317&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=dspillett" class="hnuser">dspillett</a> <span class="age" title="2024-05-08T12:33:57 1715171637"><a href="item?id=40297317">8 months ago</a></span> <span id="unv_40297317"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">root</a> | <a href="#40284606" class="clicky" aria-hidden="true">parent</a> | <a href="#40284616" class="clicky" aria-hidden="true">prev</a> | <a href="#40285337" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40297317" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">“Fairly easy” for those of us with a technical background. I&#x27;m not volunteering to explain that to the CEO when he hears about this and asks how he can access internal company resources safely while mobile!</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40285337'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285337' href='vote?id=40285337&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=jacob019" class="hnuser">jacob019</a> <span class="age" title="2024-05-07T13:41:10 1715089270"><a href="item?id=40285337">8 months ago</a></span> <span id="unv_40285337"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">parent</a> | <a href="#40284606" class="clicky" aria-hidden="true">prev</a> | <a href="#40285842" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285337" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">They could send a &#x2F;32 route for a single IP, just to decloak you.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40285842'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40285842' href='vote?id=40285842&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=betaby" class="hnuser">betaby</a> <span class="age" title="2024-05-07T14:24:03 1715091843"><a href="item?id=40285842">8 months ago</a></span> <span id="unv_40285842"></span>          <span class='navs'>
             | <a href="#40284591" class="clicky" aria-hidden="true">prev</a> | <a href="#40300812" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285842" n="12" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Attack assumes that someone already controls DHCP. If bad actor controls DHCP you have a bigger problem.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40287025'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40287025' href='vote?id=40287025&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=mehdix" class="hnuser">mehdix</a> <span class="age" title="2024-05-07T15:36:20 1715096180"><a href="item?id=40287025">8 months ago</a></span> <span id="unv_40287025"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">parent</a> | <a href="#40285932" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40287025" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">It&#x27;s a common scenario. Bars, coffee shops, trains, universities, etc. all offer free public wifi with DHCP outside your control.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40285932'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285932' href='vote?id=40285932&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=pid-1" class="hnuser">pid-1</a> <span class="age" title="2024-05-07T14:30:28 1715092228"><a href="item?id=40285932">8 months ago</a></span> <span id="unv_40285932"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">parent</a> | <a href="#40287025" class="clicky" aria-hidden="true">prev</a> | <a href="#40286604" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285932" n="4" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">If one is working from a non trusted network (idk, a coffee shop), isn&#x27;t that true?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40286048'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40286048' href='vote?id=40286048&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=betaby" class="hnuser">betaby</a> <span class="age" title="2024-05-07T14:38:49 1715092729"><a href="item?id=40286048">8 months ago</a></span> <span id="unv_40286048"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">root</a> | <a href="#40285932" class="clicky" aria-hidden="true">parent</a> | <a href="#40286604" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286048" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I would break it down in two parts.<p>1. Coffee shop Wi-Fi router is compromised. Than that&#x27;s a possible vector.<p>2. Bad actor sitting in the coffee shop and trying to carry out attack similar to the one described on the link. Fortunately that won&#x27;t work on any decent WiFi infra from Meraki, Ubiquiti or similar.<p>DHCP attacks are always a problem on dumb wired switches though.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40286709'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_40286709' href='vote?id=40286709&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=ls612" class="hnuser">ls612</a> <span class="age" title="2024-05-07T15:16:50 1715095010"><a href="item?id=40286709">8 months ago</a></span> <span id="unv_40286709"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">root</a> | <a href="#40286048" class="clicky" aria-hidden="true">parent</a> | <a href="#40286604" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286709" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Are there workarounds VPN clients can use to prevent this attack from working (or in the worst case, disconnect rather than send traffic outside the tunnel on a hostile network)?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40289910'><td><table border='0'>  <tr>    <td class='ind' indent='4'><img src="s.gif" height="1" width="160"></td><td valign="top" class="votelinks">
      <center><a id='up_40289910' href='vote?id=40289910&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=betaby" class="hnuser">betaby</a> <span class="age" title="2024-05-07T18:48:34 1715107714"><a href="item?id=40289910">8 months ago</a></span> <span id="unv_40289910"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">root</a> | <a href="#40286709" class="clicky" aria-hidden="true">parent</a> | <a href="#40286604" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40289910" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Yes. On Linux there are methods to put VPN in a namespace and thus avoid the issue.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                              <tr class='athing comtr' id='40286604'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40286604' href='vote?id=40286604&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=digitalsushi" class="hnuser">digitalsushi</a> <span class="age" title="2024-05-07T15:11:10 1715094670"><a href="item?id=40286604">8 months ago</a></span> <span id="unv_40286604"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">parent</a> | <a href="#40285932" class="clicky" aria-hidden="true">prev</a> | <a href="#40286984" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286604" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">If you dont run your network, you should assume there is a bad actor. Many wifi&#x2F;router combos have a password of &#x27;admin&#x27; or just as easy. Even if the coffee shop giving you wifi is innocent, the person that reconfigured their network in 10 seconds might not be.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40287315'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40287315' href='vote?id=40287315&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=russfink" class="hnuser">russfink</a> <span class="age" title="2024-05-07T15:55:09 1715097309"><a href="item?id=40287315">8 months ago</a></span> <span id="unv_40287315"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">root</a> | <a href="#40286604" class="clicky" aria-hidden="true">parent</a> | <a href="#40286984" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40287315" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">But the coffee shop is not offering VPN services, at least none that I would accept.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40293177'><td><table border='0'>  <tr>    <td class='ind' indent='3'><img src="s.gif" height="1" width="120"></td><td valign="top" class="votelinks">
      <center><a id='up_40293177' href='vote?id=40293177&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=ambichook" class="hnuser">ambichook</a> <span class="age" title="2024-05-08T00:40:07 1715128807"><a href="item?id=40293177">8 months ago</a></span> <span id="unv_40293177"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">root</a> | <a href="#40287315" class="clicky" aria-hidden="true">parent</a> | <a href="#40286984" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40293177" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">but you&#x27;re using a vpn <i>at</i> the coffee shop for privacy reasons, and the compromised dhcp server will allow a malicious actor to read all of your packets anyway</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='40286984'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40286984' href='vote?id=40286984&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=numpad0" class="hnuser">numpad0</a> <span class="age" title="2024-05-07T15:33:18 1715095998"><a href="item?id=40286984">8 months ago</a></span> <span id="unv_40286984"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">parent</a> | <a href="#40286604" class="clicky" aria-hidden="true">prev</a> | <a href="#40285975" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286984" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">DHCP servers aren&#x27;t connected to any IP routing mechanisms, so there can be arbitrary numbers of so long there aren&#x27;t duplicate assignments(but even that isn&#x27;t DHCP problem). IIRC the client randomly chooses one if multiple offers were received.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40285975'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285975' href='vote?id=40285975&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=harveyrook" class="hnuser">harveyrook</a> <span class="age" title="2024-05-07T14:34:01 1715092441"><a href="item?id=40285975">8 months ago</a></span> <span id="unv_40285975"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">parent</a> | <a href="#40286984" class="clicky" aria-hidden="true">prev</a> | <a href="#40286997" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285975" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Doesn&#x27;t this blow up the attack surface area to any isp and to any place that offers free wifi? With this attack, I can&#x27;t assume that it&#x27;s safe to bring my laptop to a coffee shop and enable the VPN.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40286997'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40286997' href='vote?id=40286997&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=whyleyc" class="hnuser">whyleyc</a> <span class="age" title="2024-05-07T15:34:46 1715096086"><a href="item?id=40286997">8 months ago</a></span> <span id="unv_40286997"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">parent</a> | <a href="#40285975" class="clicky" aria-hidden="true">prev</a> | <a href="#40300812" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286997" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c5A">It&#x27;s worse than that - an attacker on the same local network as the target machine can tie up the legitimate DHCP server by reserving all available addresses and then start advertising themselves as an alternate DHCP server (to inject the malicious routing to the target).</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40300812'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40300812' href='vote?id=40300812&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=PeterStuer" class="hnuser">PeterStuer</a> <span class="age" title="2024-05-08T17:34:45 1715189685"><a href="item?id=40300812">8 months ago</a></span> <span id="unv_40300812"></span>          <span class='navs'>
             | <a href="#40285842" class="clicky" aria-hidden="true">prev</a> | <a href="#40291764" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40300812" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">My VPN provider claims I&#x27;m not vulnerable to this by default (running this VPN endpoint on a spare  ASUS Router (<a href="https:&#x2F;&#x2F;www.expressvpn.com&#x2F;blog&#x2F;tunnelvision-expressvpns-statement-and-assessment-of-the-technique&#x2F;" rel="nofollow">https:&#x2F;&#x2F;www.expressvpn.com&#x2F;blog&#x2F;tunnelvision-expressvpns-sta...</a>)</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40291764'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40291764' href='vote?id=40291764&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=username135" class="hnuser">username135</a> <span class="age" title="2024-05-07T21:33:38 1715117618"><a href="item?id=40291764">8 months ago</a></span> <span id="unv_40291764"></span>          <span class='navs'>
             | <a href="#40300812" class="clicky" aria-hidden="true">prev</a> | <a href="#40286053" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40291764" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">One thing ive seen overlooked is the mention of trusted vs untrusted networks.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40286053'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40286053' href='vote?id=40286053&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=yencabulator" class="hnuser">yencabulator</a> <span class="age" title="2024-05-07T14:39:10 1715092750"><a href="item?id=40286053">8 months ago</a></span> <span id="unv_40286053"></span>          <span class='navs'>
             | <a href="#40291764" class="clicky" aria-hidden="true">prev</a> | <a href="#40295710" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286053" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Adding routes via DHCP does nothing to my VPN that is activated by fwmark.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40295710'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40295710' href='vote?id=40295710&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=M95D" class="hnuser">M95D</a> <span class="age" title="2024-05-08T08:40:56 1715157656"><a href="item?id=40295710">8 months ago</a></span> <span id="unv_40295710"></span>          <span class='navs'>
             | <a href="#40286053" class="clicky" aria-hidden="true">prev</a> | <a href="#40285794" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40295710" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">TLDR explanation:<p>- User connects to an untrusted network (public wifi).<p>- That network uses DHCP to assign IP address for the user.<p>- A malicious DHCP would push static routes via DHCP that are more specific than a common default route, and send traffic via a malicious gateway.<p>- User connects to his&#x2F;her VPN thinking his&#x2F;her traffic is secured over the insecure network.<p>- The malicious static routes, being more specific, take precedence over the default route added by the VPN.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            <tr class='athing comtr' id='40285794'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40285794' href='vote?id=40285794&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=betaby" class="hnuser">betaby</a> <span class="age" title="2024-05-07T14:20:58 1715091658"><a href="item?id=40285794">8 months ago</a></span> <span id="unv_40285794"></span>          <span class='navs'>
             | <a href="#40295710" class="clicky" aria-hidden="true">prev</a> | <a href="#40284763" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285794" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Wait til they learn you can initiate booting the whole OS through DHCP + tftp.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40286877'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40286877' href='vote?id=40286877&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=blueflow" class="hnuser">blueflow</a> <span class="age" title="2024-05-07T15:26:21 1715095581"><a href="item?id=40286877">8 months ago</a></span> <span id="unv_40286877"></span>          <span class='navs'>
             | <a href="#40285794" class="clicky" aria-hidden="true">parent</a> | <a href="#40284763" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286877" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">All of which has been common knowledge for network admins 20 years ago. Where did we go wrong?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                  <tr class='athing comtr' id='40284763'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284763' href='vote?id=40284763&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=bell-cot" class="hnuser">bell-cot</a> <span class="age" title="2024-05-07T12:38:02 1715085482"><a href="item?id=40284763">8 months ago</a></span> <span id="unv_40284763"></span>          <span class='navs'>
             | <a href="#40285794" class="clicky" aria-hidden="true">prev</a> | <a href="#40284403" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40284763" n="3" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">And yet another time when a strict policy of &quot;Always Ban the OhSoCoolConvenientKludgeTech for anything that could matter&quot; turns out to look like a genius move.  :(</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40285296'><td><table border='0'>  <tr>    <td class='ind' indent='1'><img src="s.gif" height="1" width="40"></td><td valign="top" class="votelinks">
      <center><a id='up_40285296' href='vote?id=40285296&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=hifromwork" class="hnuser">hifromwork</a> <span class="age" title="2024-05-07T13:38:16 1715089096"><a href="item?id=40285296">8 months ago</a></span> <span id="unv_40285296"></span>          <span class='navs'>
             | <a href="#40284763" class="clicky" aria-hidden="true">parent</a> | <a href="#40284403" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40285296" n="2" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I don&#x27;t understand your comment, can you explain? What is the &quot;OhSoCoolConvenientKludgeTech&quot; that should be banned in this case? VPN?</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                <tr class='athing comtr' id='40286075'><td><table border='0'>  <tr>    <td class='ind' indent='2'><img src="s.gif" height="1" width="80"></td><td valign="top" class="votelinks">
      <center><a id='up_40286075' href='vote?id=40286075&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=bell-cot" class="hnuser">bell-cot</a> <span class="age" title="2024-05-07T14:40:39 1715092839"><a href="item?id=40286075">8 months ago</a></span> <span id="unv_40286075"></span>          <span class='navs'>
             | <a href="#40284763" class="clicky" aria-hidden="true">root</a> | <a href="#40285296" class="clicky" aria-hidden="true">parent</a> | <a href="#40284403" class="clicky" aria-hidden="true">next</a> <a class="togg clicky" id="40286075" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">I was thinking of DHCP - though the VPN tech certainly doesn&#x27;t look good either.</div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
                        <tr class='athing comtr' id='40284403'><td><table border='0'>  <tr>    <td class='ind' indent='0'><img src="s.gif" height="1" width="0"></td><td valign="top" class="votelinks">
      <center><a id='up_40284403' href='vote?id=40284403&amp;how=up&amp;goto=item%3Fid%3D40284111'><div class='votearrow' title='upvote'></div></a></center>    </td><td class="default"><div style="margin-top:2px; margin-bottom:-10px;"><span class="comhead">
          <a href="user?id=yaris" class="hnuser">yaris</a> <span class="age" title="2024-05-07T11:44:30 1715082270"><a href="item?id=40284403">8 months ago</a></span> <span id="unv_40284403"></span>          <span class='navs'>
             | <a href="#40284763" class="clicky" aria-hidden="true">prev</a> <a class="togg clicky" id="40284403" n="1" href="javascript:void(0)">[–]</a><span class="onstory"></span>          </span>
                  </span></div><br><div class="comment">
                  <div class="commtext c00">Dupe? <a href="https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40279632">https:&#x2F;&#x2F;news.ycombinator.com&#x2F;item?id=40279632</a></div>
              <div class='reply'>        <p><font size="1">
                  </font>
      </div></div></td></tr>
        </table></td></tr>
            </table>
  <br><br>
</td></tr>
<tr><td><img src="s.gif" height="10" width="0"><table width="100%" cellspacing="0" cellpadding="1"><tr><td bgcolor="#ff6600"></td></tr></table><br>
<center><span class="yclinks"><a href="newsguidelines.html">Guidelines</a> | <a href="newsfaq.html">FAQ</a> | <a href="lists">Lists</a> | <a href="https://github.com/HackerNews/API">API</a> | <a href="security.html">Security</a> | <a href="https://www.ycombinator.com/legal/">Legal</a> | <a href="https://www.ycombinator.com/apply/">Apply to YC</a> | <a href="mailto:hn@ycombinator.com">Contact</a></span><br><br>
<form method="get" action="//hn.algolia.com/">Search: <input type="text" name="q" size="17" autocorrect="off" spellcheck="false" autocapitalize="off" autocomplete="off"></form></center></td></tr>      </table></center></body>
      <script type='text/javascript' src='hn.js?Brdi972UYWdRcVgheWmW'></script>
  </html>
