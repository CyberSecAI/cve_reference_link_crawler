<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><title>CVE-2024-3661 Impact of TunnelVision Vulnerability</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="keywords" content="psirt, PANW, PAN, CVE, Report Vulnerabilities, Palo Alto Networks"><meta name="og:site_name" content="Palo Alto Networks Product Security Assurance"><meta name="theme-color" content="#f0f8ff"><meta property="og:type" content="website"><link rel="apple-touch-icon" sizes="180x180" href="/icon-180x180.png"><link rel="icon" type="image/png" href="/icon-180x180.png" sizes="180x180"><link rel="shortcut icon" href="/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Montserrat:700&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/min.css"><script src="https://assets.adobedtm.com/9273d4aedcd2/fde2d38db50b/launch-4c3207301e79.min.js" async></script><meta name="description" content="Palo Alto Networks Security Advisory: CVE-2024-3661 Impact of TunnelVision Vulnerability The Palo Alto Networks Product Security Assurance team has evaluated the TunnelVision vulnerability as it relates to our products. This issue allows an attacker with the ability to send DHCP messages on the same local area network, such as a rogue Wi-Fi network, to leak traffic outside of the GlobalProtect tunnel, allowing the attacker to read, disrupt, or possibly modify network traffic that was expected to be protected by the GlobalProtect tunnel. However, this attack does not enable the attacker to decrypt HTTPS or other encrypted traffic.

Cloud NGFW, PAN-OS, and Prisma Access do not process DHCP option 121 and are therefore unaffected.

GlobalProtect app on Windows and macOS systems with Endpoint Traffic Policy Enforcement enabled are unaffected. Endpoint Traffic Policy Enforcement is disabled by default.

GlobalProtect app on Linux is affected. A fix will be released in an upcoming release.

GlobalProtect app on iOS with IncludeAllNetworks set to 1 is unaffected.

GlobalProtect app on Android is unaffected since the Android DHCP client does not process DHCP option 121."><meta property="og:title" content="CVE-2024-3661 Impact of TunnelVision Vulnerability"><meta property="og:description" content="The Palo Alto Networks Product Security Assurance team has evaluated the TunnelVision vulnerability as it relates to our products. This issue allows an attacker with the ability to send DHCP messages ..."><meta name="twitter:image" content="https://security.paloaltonetworks.com/LOW.png"><meta property="og:image" content="https://security.paloaltonetworks.com/LOW.png"><meta property="og:type" content="article"><meta property="article:publisher" content="Palo Alto Networks Product Security Assurance"><meta property="article:author" content="PAN PSIRT"><meta property="article:published_time" content="2024-05-16T16:00:00.000Z"><meta name="twitter:card" contet="summary"><meta name="twitter:label1" content="Severity"><meta name="twitter:data1" content="LOW"><meta name="twitter:label2" content="Published"><meta name="twitter:data2" content="2024-05-16"></head><body id="body"><nav id="nav"><a class="ico logo tsz" href="https://www.paloaltonetworks.com"></a><input class="hid" id="menu" type="checkbox"><label class="rt ico menu nsz" for="menu" onclick></label><ul><li><a href="https://support.paloaltonetworks.com/support" target="_blank" nav-track="true" nav-track-breadcrumb="nav:support">Get support</a></li><li><a href="/">Security advisories</a></li><li><a href="/report">Report vulnerabilities</a></li><li><a href="/scope">Bug Bounty</a></li><li><a href="https://support.paloaltonetworks.com/SupportAccount/Preferences"><span class="ico eml"></span>
<span>Subscribe</span></a></li><li><a href="/rss.xml"><span class="ico rss"></span>
<span>RSS feed</span></a></li></ul></nav><div class="pad" id="content"><a href="/">Palo Alto Networks Security Advisories</a> /
<a href="">CVE-2024-3661</a><h2>CVE-2024-3661 Impact of TunnelVision Vulnerability</h2><div class="sa_summary"><div class="pad rnd bg-blu sa_cvss"><div class="rnd tag CVSS MEDIUM"><span title="We suggest responding to this with reduced urgency.">Urgency
REDUCED</span></div><br><style>@keyframes rotate{0%{transform: rotate(0deg);} 100%{transform: rotate(66deg);} }</style><svg id="CVSSSVG" width="42mm" height="42mm" version="1.1" viewbox="0 0 42 42" xmlns="http://www.w3.org/2000/svg"><circle cx="21" cy="21" r="18.5" fill="#fff" fill-rule="evenodd" stroke="#000" stroke-width="1"></circle><g fill-rule="evenodd" shape-rendering="auto"><path d="m15.383 32.46-1.8893 3.5011c0.5329 0.26616 1.0775 0.5058 1.634 0.71365l1.2842-3.7672c-0.34867-0.13443-0.69246-0.28245-1.0289-0.44752z" fill="#00CC66"></path><path d="m27.258 32.107c-3.1418 1.7714-6.7034 2.0742-9.9002 1.1219l-1.2842 3.7651c4.2936 1.3207 9.1009 0.93103 13.285-1.4785z" fill="#dedede"></path><path d="m31.982 27.496c-0.94261 1.5912-2.245 2.9961-3.8731 4.0861l2.1001 3.4075c2.2361-1.4705 4.0115-3.4052 5.2772-5.6022z" fill="#FA582D"></path><path d="m35.515 12.642-3.4091 2.1006c2.1467 3.8069 2.1408 8.2319 0.35398 11.875l3.5011 1.8893c2.4288-4.8643 2.4604-10.818-0.44597-15.865z" fill="#FD911A"></path><path d="m11.792 7.0094c-7.3432 4.8289-9.7459 14.66-5.2968 22.366 1.5194 2.6317 3.6551 4.6912 6.119 6.1107l1.8914-3.5042c-1.824-1.0806-3.4064-2.6318-4.5465-4.6064-3.3873-5.8669-1.6124-13.247 3.9331-16.959z" fill="#BFCB1E"></path><path d="m21.353 4.2607c-2.9582-0.068747-5.9687 0.64401-8.7111 2.2231l2.1006 3.4091c5.8474-3.2966 13.152-1.5088 16.839 3.9992l3.4081-2.1001c-3.1076-4.7254-8.2855-7.407-13.637-7.5313z" fill="#FFCB06"></path></g><path d="m9.1779 41.476" fill="none" stroke="#000"></path><g fill="#b2b2b2" font-family="Montserrat,Arial" font-size="3px" font-weight="bold"><text x="15.7" y="32">0</text><text x="14.1" y="13.3">4</text><text x="29.2" y="17">7</text><text x="29.6" y="27">9</text><text x="24.6" y="31">10</text></g><g id="ndg"><path id="needle" d="m20.59 15.532-4.4675 16.877 9.1162-14.889-2.6053-0.33678z" fill="#000" transform="rotate(66 21 21)"></path><circle cx="21" cy="21" r="2" fill="#f5f5f5" stroke="#000"></circle></g></svg><br><a class="rnd tag CVSS LOW" href="https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:A/AC:H/AT:P/PR:N/UI:P/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/AU:Y/R:A/V:D/RE:M/U:Green" title="CVSS-BT: CVSS:4.0/AV:A/AC:H/AT:P/PR:N/UI:P/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/AU:Y/R:A/V:D/RE:M/U:Green">Severity
2.1 ·
LOW</a></div><div class="rnd pad1 bg-blu sa_vector v4"><div><small>Exploit Maturity
</small><b>N/A</b></div><div title="The actions required to respond to a vulnerability require some effort on behalf of the consumer and could cause minimal service impact to implement. Examples include: simple remote update, disabling of a subsystem, or a low-touch software upgrade such as a driver update."><small>Response Effort
</small><b>MODERATE</b></div><div title="The system recovers services automatically after an attack has been performed."><small>Recovery
</small><b>AUTOMATIC</b></div><div title="The vulnerable system has limited resources. That is, the resources that the attacker will gain control over with a single exploitation event are relatively small. An example of Diffuse (think: limited) Value Density would be an attack on a single email client vulnerability."><small>Value Density
</small><b>DIFFUSE</b></div><div><small>Attack Vector
</small><b>ADJACENT</b></div><div title="Bad: A successful attack depends on conditions beyond the attacker's control. That is, a successful attack cannot be accomplished at will, but requires the attacker to invest in some measurable amount of effort in preparation or execution against the vulnerable component before a successful attack can be expected."><small>Attack Complexity
</small><b>HIGH</b></div><div title="Bad: The successful attack depends on the presence of specific deployment and execution conditions of the vulnerable system that enable the attack. These include: a race condition must be won to successfully exploit the vulnerability (the successfulness of the attack is conditioned on execution conditions that are not under full control of the attacker, or the attack may need to be launched multiple times against a single target before being successful); the attacker must inject themselves into the logical network path between the target and the resource requested by the victim (e.g. vulnerabilities requiring an on-path attacker)."><small>Attack Requirements
</small><b>PRESENT</b></div><div title="Attackers can reliably automate all 4 steps of the kill chain. These steps are reconnaissance, weaponization, delivery, and exploitation (e.g., the vulnerability is “wormable”)."><small>Automatable
</small><b>YES</b></div><div title="Bad: Successful exploitation of this vulnerability requires limited interaction by the targeted user with the vulnerable system and the attacker’s payload. These interactions would be considered involuntary and do not require that the user actively subvert protections built into the vulnerable system."><small>User Interaction
</small><b>PASSIVE</b></div><div title="Bad: There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the Vulnerable System."><small>Product Confidentiality
</small><b>LOW</b></div><div title="Bad: Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact to the Vulnerable System."><small>Product Integrity
</small><b>LOW</b></div><div title="Bad: Performance is reduced or there are interruptions in resource availability. Even if repeated exploitation of the vulnerability is possible, the attacker does not have the ability to completely deny service to legitimate users. The resources in the Vulnerable System are either partially available all of the time, or fully available only some of the time, but overall there is no direct, serious consequence to the Vulnerable System."><small>Product Availability
</small><b>LOW</b></div><div title="Worst: The attacker is unauthorized before the attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack."><small>Privileges Required
</small><b>NONE</b></div><div title="Good: There is no loss of confidentiality within the Subsequent System or all confidentiality impact is constrained to the Vulnerable System."><small>Subsequent Confidentiality
</small><b>NONE</b></div><div title="Good: There is no loss of integrity within the Subsequent System or all integrity impact is constrained to the Vulnerable System."><small>Subsequent Integrity
</small><b>NONE</b></div><div title="Good: There is no impact to availability within the Subsequent System or all availability impact is constrained to the Vulnerable System."><small>Subsequent Availability
</small><b>NONE</b></div></div><div class="rnd pad1 bg-blu sa_expand"><div class="sa_links pull_right"><span><a class="tag blue" href="https://www.cve.org/CVERecord?id=CVE-2024-3661" target="_blank" title="See CVE.org record">CVE</a>
<a class="tag orange" href="/json/CVE-2024-3661" title="Download the information in this advisory in CVE-JSON format">JSON</a>
<a class="tag csaf" href="/csaf/CVE-2024-3661" title="Download the information in this advisory in CSAF format">CSAF</a>
<a class="btn blue" href="/CVE-2024-3661" title="Permanent link to this advisory"><span class="ico link"></span></a>
<a class="btn" title="Share this advisory in email" href="mailto:?subject=CVE-2024-3661 Impact of TunnelVision Vulnerability&amp;body=CVE-2024-3661 Impact of TunnelVision Vulnerability%0A%0Ahttps://security.paloaltonetworks.com/CVE-2024-3661"><span class="ico eml"></span></a></span><div><span class="ico date"></span><small> Published
</small><b><span class="date-tt" data-date="2024-05-16T16:00:00.000Z">2024-05-16</span></b></div><div><span class="ico date"></span><small> Updated
</small><b><span class="date-tt" data-date="2024-05-16T16:00:00.000Z">2024-05-16</span></b></div><div title="This issue was found during external security research or testing."><small>Discovered
</small><b>externally</b></div></div></div></div><h3>Description</h3><p><p>The Palo Alto Networks Product Security Assurance team has evaluated the TunnelVision vulnerability as it relates to our products. This issue allows an attacker with the ability to send DHCP messages on the same local area network, such as a rogue Wi-Fi network, to leak traffic outside of the GlobalProtect tunnel, allowing the attacker to read, disrupt, or possibly modify network traffic that was expected to be protected by the GlobalProtect tunnel. However, this attack does not enable the attacker to decrypt HTTPS or other encrypted traffic.</p><p>Cloud NGFW, PAN-OS, and Prisma Access do not process DHCP option 121 and are therefore unaffected.</p><p>GlobalProtect app on Windows and macOS systems with Endpoint Traffic Policy Enforcement enabled are unaffected. Endpoint Traffic Policy Enforcement is disabled by default.</p><p>GlobalProtect app on Linux is affected. A fix will be released in an upcoming release.</p><p>GlobalProtect app on iOS with IncludeAllNetworks set to 1 is unaffected.</p><p>GlobalProtect app on Android is unaffected since the Android DHCP client does not process DHCP option 121.</p></p><h3>Product Status</h3><table class="neat card"><colgroup><col><col class="affectedCol"></colgroup><tr><th>Versions</th><th>Affected</th><th>Unaffected</th></tr><tr><td>Cloud NGFW</td><td>None<br></td><td>All<br></td></tr><tr><td>GlobalProtect App</td><td>All without Endpoint Traffic Policy Enforcement set to All Traffic on Windows<br>All without Endpoint Traffic Policy Enforcement set to All Traffic on macOS<br>All on Linux<br>All without IncludeAllNetworks set to 1 on iOS<br>None on Android<br></td><td>All with Endpoint Traffic Policy Enforcement set to All Traffic on Windows<br>All with Endpoint Traffic Policy Enforcement set to All Traffic on macOS<br>Upcoming major release on Linux<br>All with IncludeAllNetworks set to 1 on iOS<br>All on Android<br></td></tr><tr><td>PAN-OS</td><td>None<br></td><td>All<br></td></tr><tr><td>Prisma Access</td><td>None<br></td><td>All<br></td></tr></table><h3>Required Configuration for Exposure</h3><p>No special configuration is required to be affected by this issue.</p><h3>Severity:
LOW, Suggested Urgency:
REDUCED</h3><p><span title="CVSS Base and Threat metrics">CVSS-BT:</span>
2.1 /
<span title="CVSS Base metrics">CVSS-B:</span>
2.1 (<a href="https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:A/AC:H/AT:P/PR:N/UI:P/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/AU:Y/R:A/V:D/RE:M/U:Green">CVSS:4.0/AV:A/AC:H/AT:P/PR:N/UI:P/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/AU:Y/R:A/V:D/RE:M/U:Green</a>)</p><h3>Exploitation Status</h3><p>Palo Alto Networks is not aware of any malicious exploitation of this issue in any of our products.</p><h3>Weakness Type</h3><p><a href="https://cwe.mitre.org/data/definitions/501" target="_blank" title="More at https://cwe.mitre.org/data/definitions/501">CWE-501 Trust Boundary Violation</a></p><p><a href="https://cwe.mitre.org/data/definitions/306" target="_blank" title="More at https://cwe.mitre.org/data/definitions/306">CWE-306 Missing Authentication for Critical Function</a></p><h3>Solution</h3><p><p>For Windows and macOS devices, ensure that Endpoint Traffic Policy Enforcement is set to All Traffic (Network → GlobalProtect Portals → &lt;portal-config&gt; → Agent → &lt;agent-config&gt; → App → Endpoint Traffic Policy Enforcement). Please see the following document for additional details: <a target="_blank" rel="nofollow" href="https://docs.paloaltonetworks.com/globalprotect/6-0/globalprotect-app-new-features/new-features-released-in-gp-app/endpoint-traffic-policy-enforcement">https://docs.paloaltonetworks.com/globalprotect/6-0/globalprotect-app-new-features/new-features-released-in-gp-app/endpoint-traffic-policy-enforcement</a>.</p><p>For iOS devices, ensure that IncludeAllNetworks is set to 1 using mobile device management. For additional guidance, please see our mobile device management documentation at <a target="_blank" rel="nofollow" href="https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/mobile-endpoint-management">https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/mobile-endpoint-management</a>&nbsp;and the Apple documentation at <a target="_blank" rel="nofollow" href="https://developer.apple.com/documentation/devicemanagement/vpn/vpn">https://developer.apple.com/documentation/devicemanagement/vpn/vpn</a>. To allow users to access their local network, ensure that ExcludeLocalNetwork is set to 1, so that the GlobalProtect app will route all local network traffic outside the tunnel.</p><p>Updates will be released for the GlobalProtect app on Linux in an upcoming major release.</p></p><h3>Workarounds and Mitigations</h3><p><p>For the GlobalProtect app on Windows, macOS, and Linux, this attack can be mitigated by enabling the "No direct access to local network" feature in the Split Tunnel tab on the firewall. Detailed information can be found at:</p><p></p><ul><li><a target="_blank" rel="nofollow" href="https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-web-interface-help/globalprotect/network-globalprotect-gateways/globalprotect-gateways-agent-tab/client-settings-tab">https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-web-interface-help/globalprotect/network-globalprotect-gateways/globalprotect-gateways-agent-tab/client-settings-tab</a></li><li><a target="_blank" rel="nofollow" href="https://docs.paloaltonetworks.com/prisma/prisma-access/3-0/prisma-access-panorama-admin/prisma-access-advanced-deployments/mobile-user-globalprotect-advanced-deployments/sinkhole-ipv6-traffic-from-mobile-users/configure-globalprotect-to-disable-direct-access-to-the-local-network">https://docs.paloaltonetworks.com/prisma/prisma-access/3-0/prisma-access-panorama-admin/prisma-access-advanced-deployments/mobile-user-globalprotect-advanced-deployments/sinkhole-ipv6-traffic-from-mobile-users/configure-globalprotect-to-disable-direct-access-to-the-local-network</a></li></ul><p></p><p>Note that enabling "No direct access to local network" prevents end users from connecting to local LAN devices such as home printers, network storage, or streaming devices. You can configure exceptions for specific users, operating systems, source addresses, destination domains, and applications by following the instructions at:</p><p></p><ul><li><a target="_blank" rel="nofollow" href="https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-access-route">https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-access-route</a></li><li><a target="_blank" rel="nofollow" href="https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-domain-and-application">https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-domain-and-application</a></li></ul><p></p><p>You can mitigate this attack for the GlobalProtect app on iOS devices by disabling Wi-Fi.</p></p><h3>Timeline</h3><div class="timeline"><div><label><span class="date-tt" data-date="2024-05-16T16:00:00.000Z">2024-05-16</span></label>
<span class="t">Initial publication</span></div></div><script>function localiseDates() {
  document.querySelectorAll("span[data-date]").forEach((elem) => {
    let localDate = new Date(elem.getAttribute("data-date"));
    let isoLocalDate = new Date(localDate.getTime() - localDate.getTimezoneOffset() * 60000).toISOString().slice(0, 10);
    elem.textContent = isoLocalDate;
    let fmtOpts = { dateStyle: "long", timeStyle: "long" };
    elem.setAttribute("title", new Intl.DateTimeFormat(undefined, fmtOpts).format(localDate));
  });
}

window.addEventListener("load", localiseDates);
</script></div><div class="footer"><a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of use</a><a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a><a href="https://paloaltonetworks.com/product-security-assurance">Product Security Assurance and Vulnerability Disclosure Policy</a><a href="/report">Report vulnerabilities</a><a href="https://support.paloaltonetworks.com/SupportAccount/Preferences">Manage subscriptions</a></div><div class="pad bg-blu"><div class="btop">© 2025 Palo Alto Networks, Inc. All rights reserved.</div></div></body></html>