
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYlianst%2FMeshCentral%2Fsecurity%2Fadvisories%2FGHSA-cp68-qrhr-g9h8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYlianst%2FMeshCentral%2Fsecurity%2Fadvisories%2FGHSA-cp68-qrhr-g9h8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Ylianst%2FMeshCentral)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Ylianst](/Ylianst)
/
**[MeshCentral](/Ylianst/MeshCentral)**
Public

* [Notifications](/login?return_to=%2FYlianst%2FMeshCentral) You must be signed in to change notification settings
* [Fork
  595](/login?return_to=%2FYlianst%2FMeshCentral)
* [Star
   4.5k](/login?return_to=%2FYlianst%2FMeshCentral)

* [Code](/Ylianst/MeshCentral)
* [Issues
  794](/Ylianst/MeshCentral/issues)
* [Pull requests
  4](/Ylianst/MeshCentral/pulls)
* [Discussions](/Ylianst/MeshCentral/discussions)
* [Actions](/Ylianst/MeshCentral/actions)
* [Wiki](/Ylianst/MeshCentral/wiki)
* [Security](/Ylianst/MeshCentral/security)
* [Insights](/Ylianst/MeshCentral/pulse)

Additional navigation options

* [Code](/Ylianst/MeshCentral)
* [Issues](/Ylianst/MeshCentral/issues)
* [Pull requests](/Ylianst/MeshCentral/pulls)
* [Discussions](/Ylianst/MeshCentral/discussions)
* [Actions](/Ylianst/MeshCentral/actions)
* [Wiki](/Ylianst/MeshCentral/wiki)
* [Security](/Ylianst/MeshCentral/security)
* [Insights](/Ylianst/MeshCentral/pulse)

# MeshCentral cross-site websocket hijacking (CSWSH) vulnerability

High

[Ylianst](/Ylianst)
published
GHSA-cp68-qrhr-g9h8
Feb 19, 2024

## Package

npm

meshcentral
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 1.1.21

## Patched versions

1.1.21

## Description

We have identified a cross-site websocket hijacking (CSWSH) vulnerability within the control.ashx endpoint of MeshCentral. This component is the primary mechanism used within MeshCentral to perform administrative actions on the server. To demonstrate the impact of the vulnerability we developed a proof-of-concept which leveraged the cross-site websocket hijacking vulnerability to read the server configuration file to leak the sessionKey variable, generating login tokens, and generating an authentication cookie.

The vulnerability is exploitable when an attacker is able to convince a victim end-user to click on a malicious link to a page hosting an attacker-controlled site. The attacker can then originate a cross-site websocket connection using client-side JavaScript code to connect to “control.ashx” as the victim user within MeshCentral. There are some caveats to exploiting this issue however as MeshCentral configures `SameSite=Lax` security setting on cookies which introduces some additional preconditions for exploitation which we cover in a subsequent section.

### MeshCentral Version Tested

We performed testing against MeshCentral version 1.1.20 which appears to be the latest supported version of the application. This appears to have been the latest version of MeshCentral available at the time we performed testing of the application in January and February 2024 (see Figure 1 and Figure 2).

[![image](https://private-user-images.githubusercontent.com/1319013/306087397-4a24fce2-5047-47a1-ac91-ae84c44ef3f1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzM5Ny00YTI0ZmNlMi01MDQ3LTQ3YTEtYWM5MS1hZTg0YzQ0ZWYzZjEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MTBiYTYyMTA1NzM5ZTA5ZmU4ZjFmOGRiNjhkM2U0ZjU5NGMyOGFhZjJjNTJkNTM4ZDljZTBjMDc3MTA2YmQxZSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.9iqzyUci_iR3j5VAYE4N1zAvFSVeIQJ-Ikppp3pBfyQ)](https://private-user-images.githubusercontent.com/1319013/306087397-4a24fce2-5047-47a1-ac91-ae84c44ef3f1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzM5Ny00YTI0ZmNlMi01MDQ3LTQ3YTEtYWM5MS1hZTg0YzQ0ZWYzZjEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MTBiYTYyMTA1NzM5ZTA5ZmU4ZjFmOGRiNjhkM2U0ZjU5NGMyOGFhZjJjNTJkNTM4ZDljZTBjMDc3MTA2YmQxZSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.9iqzyUci_iR3j5VAYE4N1zAvFSVeIQJ-Ikppp3pBfyQ)

Figure 1: We determined that MeshCentral version 1.1.20 was the latest version available at the time we performed testing of the application.

[![image](https://private-user-images.githubusercontent.com/1319013/306087446-4e347e91-6296-4b1a-a1d0-bb3587a82ea3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzQ0Ni00ZTM0N2U5MS02Mjk2LTRiMWEtYTFkMC1iYjM1ODdhODJlYTMucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZDI2YzI2NDRjYzkxNzliNzMwYWJmNTVhMzYzZjNjNjEzYmJlYmFkMmQ1YWU3YjhhNmQ4ZGM5MTJiNGUwNDBmZCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.l2UM9L3Ubw9FEGqO_4J04yun_F4vS0d0259nJsBT2Ys)](https://private-user-images.githubusercontent.com/1319013/306087446-4e347e91-6296-4b1a-a1d0-bb3587a82ea3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzQ0Ni00ZTM0N2U5MS02Mjk2LTRiMWEtYTFkMC1iYjM1ODdhODJlYTMucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZDI2YzI2NDRjYzkxNzliNzMwYWJmNTVhMzYzZjNjNjEzYmJlYmFkMmQ1YWU3YjhhNmQ4ZGM5MTJiNGUwNDBmZCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.l2UM9L3Ubw9FEGqO_4J04yun_F4vS0d0259nJsBT2Ys)

Figure 2: We configured our test environment on an Ubuntu server running version 1.1.20 of the MeshCentral application server.

### What about SameSite=Lax Cookie Settings?

One may make the counterpoint that the `SameSite=Lax` security setting (see Figure 4) effectively prevents cross-site websocket hijacking (CSWSH) issues as an attacker origin of attacker.com would not be within the same-site as the victim meshcentral server at say meshcentral.example.com. This means an attacker that is able to convince a user to click on a malicious link wouldn’t be able to successfully perform this attacker to the Lax setting with differing origins.

Unfortunately, this isn’t entirely correct as there is a core difference between same-site and same-origin policies within all modern browsers. In this case, while it’s valid to say that the attack wouldn’t work in the case of attacker.com targeting meshcentral.example.com when the SameSite setting is configured to Lax for session cookies, there are several other scenarios where an attacker could perform the attack successfully (see Figure 3).

[![image](https://private-user-images.githubusercontent.com/1319013/306087495-b108232d-7f85-4815-9439-431db0eeed85.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzQ5NS1iMTA4MjMyZC03Zjg1LTQ4MTUtOTQzOS00MzFkYjBlZWVkODUucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NjYxNzI2YzZkYjY5Y2U0ZDVmYzRlODhjNGVhNzFkNjZmZjY4YmFhMzJjN2I1ZmFjMTNiMGE0Y2E2NzI1ZjJjYiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.1FSpmNN9ckZ-Enq2wKQ60DpLO-FGxt5NLNgsq3kUEoA)](https://private-user-images.githubusercontent.com/1319013/306087495-b108232d-7f85-4815-9439-431db0eeed85.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzQ5NS1iMTA4MjMyZC03Zjg1LTQ4MTUtOTQzOS00MzFkYjBlZWVkODUucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NjYxNzI2YzZkYjY5Y2U0ZDVmYzRlODhjNGVhNzFkNjZmZjY4YmFhMzJjN2I1ZmFjMTNiMGE0Y2E2NzI1ZjJjYiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.1FSpmNN9ckZ-Enq2wKQ60DpLO-FGxt5NLNgsq3kUEoA)

Figure 3: A table from PortSwigger’s article on Bypassing SameSite Cookie Restrictions (source).

From our perspective, the most relevant scenario is when an attacker is able to compromise an adjacent subdomain either through a vector such as a system compromise, exploiting a subdomain takeover vulnerability, or through exploitation of a cross-site scripting vulnerability within an adjacent application running under the same domain. For example, if an attacker found a cross-site scripting issue on example.com or vulnerable.example.com they would then be able to leverage the cross-site scripting issues on those domains to target meshcentral.example.com. There are other factors which could also allow an attacker to bypass the SameSite=Lax setting to perform cross-site websocket hijacking. For a more comprehensive list please see Bypassing SameSite Cookie Restrictions from PortSwigger.

[![image](https://private-user-images.githubusercontent.com/1319013/306087572-8310a307-273f-44e5-948a-f1a2b49cf960.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzU3Mi04MzEwYTMwNy0yNzNmLTQ0ZTUtOTQ4YS1mMWEyYjQ5Y2Y5NjAucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NDNlNmQyOGExNzQ2YmFkYTUzMmVmOTA4Yzc4NDllZWIxMWMzNzlkNjI0OGIxNjcwMGNiMWIwOTJjYzYyZWM0MSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.WW9hwpkMLhOl1PjDYGLOdujNpuJcN6I5Tv4lVLZgSFs)](https://private-user-images.githubusercontent.com/1319013/306087572-8310a307-273f-44e5-948a-f1a2b49cf960.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzU3Mi04MzEwYTMwNy0yNzNmLTQ0ZTUtOTQ4YS1mMWEyYjQ5Y2Y5NjAucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NDNlNmQyOGExNzQ2YmFkYTUzMmVmOTA4Yzc4NDllZWIxMWMzNzlkNjI0OGIxNjcwMGNiMWIwOTJjYzYyZWM0MSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.WW9hwpkMLhOl1PjDYGLOdujNpuJcN6I5Tv4lVLZgSFs)

Figure 4: We observed that upon logging into MeshCentral the “xid” and “xid.sig” tokens were configured with the SameSite=Lax security settings.

### Developing an Initial Proof-of-Concept Exploit

At this point we had a testing deployment of MeshCentral configured at meshcentral.example.com and simulated an attacker-compromised adjacent subdomain at evil.example.com. In this scenario, we assume the attacker exploited a subdomain takeover vulnerability to host malicious content on evil.example.com. Next, we developed a simple proof-of-concept payload which originated a cross-site websocket connection from the evil.example.com origin to meshcentral.example.com (see Figure 5).

[![image](https://private-user-images.githubusercontent.com/1319013/306087612-725820ef-5e93-48f5-aa47-9e21b299f255.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzYxMi03MjU4MjBlZi01ZTkzLTQ4ZjUtYWE0Ny05ZTIxYjI5OWYyNTUucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MjdmZDNkNTg4ZmVlZGE3NzdlNWM0ODJjYWFiYTljOWQzNWVkMTc0MjFmMTA1MWI3ZjM1MTM3YmY5Zjg5ZjI5YyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.YEfA5lS1oup-sNd2ZL5jXtyGUA8Mv426GS3vmDTUI04)](https://private-user-images.githubusercontent.com/1319013/306087612-725820ef-5e93-48f5-aa47-9e21b299f255.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzYxMi03MjU4MjBlZi01ZTkzLTQ4ZjUtYWE0Ny05ZTIxYjI5OWYyNTUucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MjdmZDNkNTg4ZmVlZGE3NzdlNWM0ODJjYWFiYTljOWQzNWVkMTc0MjFmMTA1MWI3ZjM1MTM3YmY5Zjg5ZjI5YyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.YEfA5lS1oup-sNd2ZL5jXtyGUA8Mv426GS3vmDTUI04)

Figure 5: An initial proof-of-concept exploit we developed which simply sent a ping-message over the websocket connection from evil.example.com targeting meshcentral.example.com. We then triggered the exploit payload as a user that was logged into the MeshCentral application as an administrator by browsing to evil.example.com with a valid session on meshcentral.example.com. We

observed a cross-site websocket connection to meshcentral.example.com with an origin header set to evil.example.com as it originated from the attacker domain (see Figure 6). The response indicated the connection was successful and we received the expected pong response to our ping message sent to the server.

[![image](https://private-user-images.githubusercontent.com/1319013/306087660-9bcec329-4206-4ce6-bbba-a02a47c306d8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzY2MC05YmNlYzMyOS00MjA2LTRjZTYtYmJiYS1hMDJhNDdjMzA2ZDgucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NDE2NzY3ZTk3MjM5MDAwYTM1NTRjYTRmZWZjNjA0NWY5NzAxYTExODk3YTVlZTc5MTU1MDkzMTRkODczMTNjMCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.aWZX1alLOEh64yWngs8aTspNNaEnN3Z0sFdRo8uXOV4)](https://private-user-images.githubusercontent.com/1319013/306087660-9bcec329-4206-4ce6-bbba-a02a47c306d8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzY2MC05YmNlYzMyOS00MjA2LTRjZTYtYmJiYS1hMDJhNDdjMzA2ZDgucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NDE2NzY3ZTk3MjM5MDAwYTM1NTRjYTRmZWZjNjA0NWY5NzAxYTExODk3YTVlZTc5MTU1MDkzMTRkODczMTNjMCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.aWZX1alLOEh64yWngs8aTspNNaEnN3Z0sFdRo8uXOV4)

Figure 6: We observed that when originating a websocket connection across origins the origin header was sent by the browser to the MeshCentral server indicating the origin which originated the cross-site websocket connection.

### Demonstrating Impact

After confirming the vulnerability we then developed a more comprehensive exploit payload to demonstrate the impact of the vulnerability (see Figure 7). Our new payload sent the serverconfig, authcookie, and createLoginToken actions to the administrative component. The ability to issue a new login token then provided us with persistent access to the users account. The ability to read the serverconfig file allowed us to exfiltrate the session key used to sign sessions allowing the attacker to forge valid session tokens as arbitrary users on the system. Our payload then read the response from the server and exfiltrated the sensitive data exported from the system to an attacker-controlled system for storage purposes (see Figure 8).

[![image](https://private-user-images.githubusercontent.com/1319013/306087716-d42f8372-24c9-4786-bfaa-ed1f91915749.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzcxNi1kNDJmODM3Mi0yNGM5LTQ3ODYtYmZhYS1lZDFmOTE5MTU3NDkucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MTljOTZlOGYzYmIwYWU3Yzc3YWQ1NGQ3YjM2NjRkOGMwNDU2M2YwNTdhZDFlMWY1M2FlMmZkMDk1OGE3MTNhMyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.f9Z-txpBOVVdxiGAyl7vynYp4xgJE0QfulL54ZM-In4)](https://private-user-images.githubusercontent.com/1319013/306087716-d42f8372-24c9-4786-bfaa-ed1f91915749.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzcxNi1kNDJmODM3Mi0yNGM5LTQ3ODYtYmZhYS1lZDFmOTE5MTU3NDkucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MTljOTZlOGYzYmIwYWU3Yzc3YWQ1NGQ3YjM2NjRkOGMwNDU2M2YwNTdhZDFlMWY1M2FlMmZkMDk1OGE3MTNhMyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.f9Z-txpBOVVdxiGAyl7vynYp4xgJE0QfulL54ZM-In4)

Figure 7: A proof-of-concept exploit we developed for the cross-site websocket hijacking vulnerability resulting in complete compromise of the user’s account and persistent access to the MeshCentral application as the victim user.

[![image](https://private-user-images.githubusercontent.com/1319013/306087745-3e3977e1-a8c8-4856-9d27-f0307855049c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4Nzc0NS0zZTM5NzdlMS1hOGM4LTQ4NTYtOWQyNy1mMDMwNzg1NTA0OWMucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NjA3MzFlZmRiNDdkY2UzYmI1YmYzMzUzYTliN2YwMTRlYjRhNDVlOWQ1MTMwYTBkYmQ5MjU2ZDA4ZjM3MWVkYyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.1YYQ_819PuVlFVwhR-WUFEX1ZZ3xZDOW5cEIYIm0mfA)](https://private-user-images.githubusercontent.com/1319013/306087745-3e3977e1-a8c8-4856-9d27-f0307855049c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4Nzc0NS0zZTM5NzdlMS1hOGM4LTQ4NTYtOWQyNy1mMDMwNzg1NTA0OWMucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NjA3MzFlZmRiNDdkY2UzYmI1YmYzMzUzYTliN2YwMTRlYjRhNDVlOWQ1MTMwYTBkYmQ5MjU2ZDA4ZjM3MWVkYyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.1YYQ_819PuVlFVwhR-WUFEX1ZZ3xZDOW5cEIYIm0mfA)

Figure 8: We performed the attack using the exploit code shown in Figure AA to invoked the authcookie, serverconfig, and createLoginToken endpoints on the victim MeshCentral system leveraging the cross-site websocket hijacking vulnerability from evil.example.com.

After performing the attack successfully we used the issued login token to authenticate to MeshCental and access the console as the NT AUTHORITY\SYSTEM user for a windows agent which connected to the victim MeshCentral instance. This provided compromise of all the nodes within the impacted MeshCentral instance (see Figure 9 and Figure 10).

[![image](https://private-user-images.githubusercontent.com/1319013/306087797-95405b59-8073-483e-9527-e1d03b546f5a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4Nzc5Ny05NTQwNWI1OS04MDczLTQ4M2UtOTUyNy1lMWQwM2I1NDZmNWEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MmM5NzFkN2FhMjU0NDkzOTRlNzFjYTZhNGE4MjZmNjEzN2JkNTRhOTk5OTgyN2ViZGJhZGRiYmFkMzk5MmExMCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.pkN2KN5d-F0Vfy-yby3cAf3UIHYaibjjMp2rotBD-Mk)](https://private-user-images.githubusercontent.com/1319013/306087797-95405b59-8073-483e-9527-e1d03b546f5a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4Nzc5Ny05NTQwNWI1OS04MDczLTQ4M2UtOTUyNy1lMWQwM2I1NDZmNWEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MmM5NzFkN2FhMjU0NDkzOTRlNzFjYTZhNGE4MjZmNjEzN2JkNTRhOTk5OTgyN2ViZGJhZGRiYmFkMzk5MmExMCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.pkN2KN5d-F0Vfy-yby3cAf3UIHYaibjjMp2rotBD-Mk)

Figure 9: An attacker could leverage the login token created by the attacker to authenticate to MeshCentral and then leverage this access to compromise nodes managed by the impacted MeshCentral instance.

[![image](https://private-user-images.githubusercontent.com/1319013/306087829-605b909e-54eb-4ad0-b397-84fa3fb9455d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzgyOS02MDViOTA5ZS01NGViLTRhZDAtYjM5Ny04NGZhM2ZiOTQ1NWQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NmJiNWE1OWM3MjM1YmMwNDBmOTZjYTFhMmUzZmQ1Y2ZhYjg3MjMyZmFkNDY5N2FhMjJiYTM0MTdmOWJjZDE1ZSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.UKLWgOri3sFBz_uAx5j2gNC18DQ-4CsofLMFtDtrLv0)](https://private-user-images.githubusercontent.com/1319013/306087829-605b909e-54eb-4ad0-b397-84fa3fb9455d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1OTU4MTIsIm5iZiI6MTczNjU5NTUxMiwicGF0aCI6Ii8xMzE5MDEzLzMwNjA4NzgyOS02MDViOTA5ZS01NGViLTRhZDAtYjM5Ny04NGZhM2ZiOTQ1NWQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMTEzODMyWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NmJiNWE1OWM3MjM1YmMwNDBmOTZjYTFhMmUzZmQ1Y2ZhYjg3MjMyZmFkNDY5N2FhMjJiYTM0MTdmOWJjZDE1ZSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.UKLWgOri3sFBz_uAx5j2gNC18DQ-4CsofLMFtDtrLv0)

Figure 10: An attacker could leverage the cross-site websocket hijacking vulnerability to read the server configuration file of the MeshCentral system as an administrator to obtain the key used to encrypt sessions (sessionKey).

### Remediation

To remediate this vulnerability we recommend inspecting the origin header when websocket connections are established to control.ashx and other websocket endpoints. Verify that the origin header sent to the server matches an allowlisted origin. This would prevent an attacker from originating a cross-site websocket connection from an untrusted site.

### Severity

High

8.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H

### CVE ID

CVE-2024-26135

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

