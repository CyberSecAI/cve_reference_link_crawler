The provided content is a vulnerability report from Talos Intelligence, which includes details for CVE-2022-46295.

**Root cause of vulnerability:**

The vulnerability is an out-of-bounds write due to uncontrolled incrementing of an index within a loop while parsing the translation vectors in the Gaussian file format. The `translationVectors` array is allocated on the stack with a fixed size of 3, but the index `numTranslationVectors` is incremented without any bounds check, leading to writing outside the allocated memory region on the stack.

**Weaknesses/vulnerabilities present:**

-   **CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer:** The code fails to check the bounds of the `translationVectors` array when writing to it, allowing out-of-bounds writes.
-   **Uncontrolled loop:** The loop that processes translation vectors continues as long as a specific condition is met (more than 4 tokens on a line), without a check on the number of vectors read, allowing for an attacker-controlled number of writes.

**Impact of exploitation:**

-   **Arbitrary code execution:** The out-of-bounds write on the stack can overwrite other data or control flow information on the stack, potentially leading to arbitrary code execution. The report indicates that depending on how the code is compiled and how the stack is laid out, this can lead to code execution.
-   **Denial of Service:** If arbitrary code execution is not achieved, the vulnerability could still cause a crash due to the memory corruption, resulting in a denial of service.

**Attack vectors:**

-   **Malicious input file:** An attacker can provide a specially crafted Gaussian file that contains a large number of translation vectors, causing the `numTranslationVectors` index to exceed the bounds of the `translationVectors` array, triggering the out-of-bounds write.

**Required attacker capabilities/position:**

-   An attacker needs to be able to provide a malicious Gaussian file to the vulnerable application (Open Babel) either directly or via a service that uses the vulnerable library.

**Technical Details:**

-   The vulnerability is located in `GaussianOutputFormat::ReadMolecule` function, specifically while handling the "orientation:" block.
-   The code reads lines from the input file and tokenizes them. If the line contains the keyword "orientation:", the code parses it to retrieve coordinate data.
-   If the `atomicNum` read from the tokenized line is less or equal to 0, the code writes the x, y, and z values to the `translationVectors` array using the `numTranslationVectors` index. The index `numTranslationVectors` is not checked to be within the bounds of array `translationVectors` and gets incremented on every write.
-   The `translationVectors` array has a fixed size of 3, which is defined on the stack.
-   The crash information shows the stack-buffer-overflow occurring when calling `OpenBabel::vector3::Set` when writing out-of-bounds the `translationVectors` array.