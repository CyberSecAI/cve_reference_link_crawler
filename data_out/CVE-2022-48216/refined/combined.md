=== Content from media.dedaub.com_d8ddde83_20250108_111221.html ===
[Dedaub Security Suite New Features](https://dedaub.com/blog/blockchain-transaction-monitoring-security-suite-updates/)[Dedaub Security Suite New Features](https://dedaub.com/blog/blockchain-transaction-monitoring-security-suite-updates/)ServicesSecurity SuiteCompanyResources[Login](https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/auth?client_id=watchdog-client&scope=openid%20profile%20email&response_type=code&redirect_uri=https%3A%2F%2Fapp.dedaub.com%2Fapi%2Fauth%2Fcallback%2Fkeycloak&ref=null&state=ZdtsAWHhKLYQanUtHMR2A09JDjAoGX8rAseNvQGLB_0&code_challenge=YsXuPhez-hi_oR1gX9uQPgNL2AuYoMG-7pMTSCmMw5A&code_challenge_method=S256)[Signup](https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/registrations?client_id=watchdog-client&response_type=code&scope=openid%20email&kc_locale=en&redirect_uri=https://app.dedaub.com//)Tech Deep Dive![Dedaub Logo](/_next/image/?url=%2Fdedaub_logo.jpeg&w=640&q=75)YANNIS SMARAGDAKIS16 December 2022
# Uniswap Reentrancy Vulnerability Disclosure

By the [Dedaub](https://dedaub.com/) team

![Uniswap Reentrancy Vulnerability Disclosure](https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL.webp)

Uniswap Reentrancy | Uniswap Labs recently [advertised a boosted $3M bounty program](https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fbe6ec2554bf6b/bytecode) for bug reports over their smart contracts, and especially the new [UniversalRouter](https://github.com/Uniswap/universal-router) and [Permit2](https://github.com/Uniswap/permit2) functionality. We submitted a bug report and received a bounty — thank you! To our knowledge, ours was the only bug report that Uniswap acted upon (i.e., the only one to have apparently resulted in a [commit-fix to smart contract code](https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fbe6ec2554bf6b/bytecode) and a [new deployment of the UniversalRouter](https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fb%20e6ec2554bf6b/bytecode)).

The explanation of the issue is fairly straightforward, so we begin with the verbatim text of our bug report.

> Clearly, the UniversalRouter should not hold any balances between transactions, or these can be emptied by anyone (e.g., by calling `dispatch` with a `Commands.TRANSFER`, or `Commands.SWEEP`).
>
> This property is dangerous when combined with any possibility of untrusted parties gaining control in the middle of a user transaction. This can happen, e.g., with tainted ERC20 tokens in Uniswap pools, or with callbacks from token transfers (e.g., 721s). E.g., simple attack scenario: a user sends to the UniversalRouter funds and calls it with 3 commands:
>
> 1) `Commands.V3_SWAP_EXACT_IN`, swap to a specific token
> 2) `Commands.LOOKS_RARE_721` (or any of a large number of commands that trigger recipient callbacks), purchase NFT, send it to recipientX
> 3) sweep amount remaining after purchase to original caller.
>
> In this case, recipientX can easily reenter the contract (by calling `transfer` or `sweep` inside its `onERC721Received` handler) and drain the entire amount, i.e., also the amount of step 3.

In essence, the UniversalRouter is a scripting language for all sorts of token transfers, swaps, and NFT purchases. One can perform several actions in a row, by supplying the right sequence of commands. These commands could include transfers to untrusted recipients. In this case, it is natural to expect that the transfer should send to the recipient only what the call parameters specify, and nothing more.

However, this is not always what would happen. If untrusted code is invoked at any point in the transfer, the code can re-enter the UniversalRouter and claim any tokens already in the UniversalRouter contract. Such tokens can, for instance, exist because the user intends to later buy an NFT, or transfer tokens to a second recipient, or because the user swaps a larger amount than needed and intends to “sweep” the remainder to themselves at the end of the UniversalRouter call. And there is no shortage of scenarios in which an untrusted recipient may be called: WETH unwrapping triggers a callback, there are tokens that perform callbacks, and tokens could be themselves untrusted, executing arbitrary code when their functions get called.

Our proof-of-concept demonstrated an easy scenario:

> Attached are two files. One is a replacement (slight addition) to your foundry test file, universal-router/test/foundry-tests/UniversalRouter.t.sol. The other should be dropped into the “mock” subdirectory. If you then run your standard `forge test -vvv` you will see for the relevant test the output:
> ======
>
> [PASS] testSweepERC1155Attack() (gas: 126514)
> Logs:
> 1000000000000000000
>
> ======
>
> The last line is a console.log from the attacker showing that she got a balance in an erc20 token, although she was only sent an ERC1155 token.
>
> The test case is simply:

```
function testSweepERC1155Attack() public {
 bytes memory commands = abi.encodePacked(bytes1(uint8(Commands.SWEEP_ERC1155)));
 bytes[] memory inputs = new bytes[](1);
 uint256 id = 0;
 inputs[0] = abi.encode(address(erc1155), attacker, id, 0);

 erc1155.mint(address(router), id, AMOUNT);
 erc20.mint(address(router), AMOUNT);

 router.execute(commands, inputs);
}
```
> That is, the attacker is being sent an erc1155 token amount, but the router also has an erc20 token amount. (In reality, this would probably be due to other transfers, to happen later.) The attacker manages to steal the erc20 amount as well.

The remedy we suggested was easy:

> … add a Uniswap reentrancy lock, although inelegant: no dispatching commands while in the middle of dispatching commands.

We got immediate confirmation that the issue is being examined and will be assessed for the bounty program. A couple of weeks later, we received the bounty assessment:

> we would like to award you a one-time bounty of $40,000 (payable in USDC) for your contribution. This amount includes a $30,000 bounty for the report, as well as a 33% bonus for reporting the issue during our current bonus period. We have classified the issue as medium severity and appreciate your assistance in helping us improve the safety of our users and the web3 ecosystem as a whole.

Further communication clarified that the bug was assessed to have High impact and Low likelihood: the possibility of a user sending NFTs to an untrusted recipient directly (although present in the UniversalRouter unit tests) is considered “user error”. Therefore, only much more complex (and less likely) scenarios were considered valid for Uniswap reentrancy, resulting in the “low likelihood” rating.

We want to thank Uniswap Labs for the bounty and are happy to have helped!

### Related Posts

View all[Tech Deep Dive![]()
### Bedrock vulnerability disclosure and actions

A few hours ago, the Dedaub team discovered a smart contract vulnerability in a number of uniBTC vau ...

26 September 2024](/blog/bedrock-vulnerability-disclosure-and-actions/)[Tech Deep Dive![]()
### Rho Markets Incident

On July 19th, Rho Markets — a Compound V2 fork on Scroll — was involved in an incident that led to t ...

5 September 2024](/blog/rho-markets-incident/)[Tech Deep Dive![Web3 Audit Methodology]()
### Web 3 Audit Methodology by Dedaub

Dedaub’s Security Audit teams comprise at least two senior security researchers, as well as any supp ...

4 September 2024](/blog/web3-audit-methodology/)![Dedaub logo](/dedaub-large-logo.svg)
### Subscribe to our newsletter for industry insights and company news.

Security Suite[Overview](/products/security-suite/)[Pricing](/pricing/)[Book a Demo](https://meetings-eu1.hubspot.com/meetings/giorgio-bonuccelli/security-suite-demo)[Login](https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/auth?client_id=watchdog-client&scope=openid%20profile%20email&response_type=code&redirect_uri=https%3A%2F%2Fapp.dedaub.com%2Fapi%2Fauth%2Fcallback%2Fkeycloak&ref=null&state=VVwNPh_VxcTmpqKGecUI9mvNoMMGbv-aRDsQuLefUew&code_challenge=tWVI_EVDc6bDj-P2nBpywA5QIEKHdUr5n8J28dz2SlE&code_challenge_method=S256)[Sign Up](https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/registrations?client_id=watchdog-client&response_type=code&scope=openid%20email&kc_locale=en&redirect_uri=https://app.dedaub.com//)[Documentation](https://docs.dedaub.com/docs/welcome)[Trial | How-to](https://dedaub.com/blog/dedaub-security-suite-trial-how-to/)Company[About](/about/)[Careers](/career/)[News](/blog/category/news/)[Contact](/form/contact-us/)Audits[Reports](/audits/)[Smart Contract Audits](/smart-contract-audits/)[Focused Expertise](/focused-expertise/)[Request Audit](/forms/contact-us/)Resources[Brand Assets](https://dedlim.dreamhosters.com/wp-content/uploads/2024/05/%5EDedaub-Brand-Package.zip)[Blog](/blog/)[FAQ](/faq/)Dedaub 2025 ©[Legal](/legal/audits/)
### Subscribe to our newsletter for industry insights and company news.

![Dedaub logo](/dedaub-large-logo.svg)Security Suite[Overview](/products/security-suite/)[Pricing](/pricing/)[Book a Demo](https://meetings-eu1.hubspot.com/meetings/giorgio-bonuccelli/security-suite-demo)[Login](https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/auth?client_id=watchdog-client&scope=openid%20profile%20email&response_type=code&redirect_uri=https%3A%2F%2Fapp.dedaub.com%2Fapi%2Fauth%2Fcallback%2Fkeycloak&ref=null&state=VVwNPh_VxcTmpqKGecUI9mvNoMMGbv-aRDsQuLefUew&code_challenge=tWVI_EVDc6bDj-P2nBpywA5QIEKHdUr5n8J28dz2SlE&code_challenge_method=S256)[Sign Up](https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/registrations?client_id=watchdog-client&response_type=code&scope=openid%20email&kc_locale=en&redirect_uri=https://app.dedaub.com//)[Documentation](https://docs.dedaub.com/docs/welcome)[Trial | How-to](https://dedaub.com/blog/dedaub-security-suite-trial-how-to/)Company[About](/about/)[Careers](/career/)[News](/blog/category/news/)[Contact](/form/contact-us/)Audits[Reports](/audits/)[Smart Contract Audits](/smart-contract-audits/)[Focused Expertise](/focused-expertise/)[Request Audit](/forms/contact-us/)Resources[Brand Assets](https://dedlim.dreamhosters.com/wp-content/uploads/2024/05/%5EDedaub-Brand-Package.zip)[Blog](/blog/)[FAQ](/faq/)Dedaub 2025 ©[Legal](/legal/audits/)

=== Content from github.com_0f230416_20250108_111219.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniswap%2Funiversal-router%2Fcompare%2Fv1.0.1...v1.1.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniswap%2Funiversal-router%2Fcompare%2Fv1.0.1...v1.1.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=Uniswap%2Funiversal-router)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Uniswap](/Uniswap)
/
**[universal-router](/Uniswap/universal-router)**
Public

* [Notifications](/login?return_to=%2FUniswap%2Funiversal-router) You must be signed in to change notification settings
* [Fork
  223](/login?return_to=%2FUniswap%2Funiversal-router)
* [Star
   421](/login?return_to=%2FUniswap%2Funiversal-router)

* [Code](/Uniswap/universal-router)
* [Issues
  29](/Uniswap/universal-router/issues)
* [Pull requests
  16](/Uniswap/universal-router/pulls)
* [Actions](/Uniswap/universal-router/actions)
* [Projects
  0](/Uniswap/universal-router/projects)
* [Security](/Uniswap/universal-router/security)
* [Insights](/Uniswap/universal-router/pulse)

Additional navigation options

* [Code](/Uniswap/universal-router)
* [Issues](/Uniswap/universal-router/issues)
* [Pull requests](/Uniswap/universal-router/pulls)
* [Actions](/Uniswap/universal-router/actions)
* [Projects](/Uniswap/universal-router/projects)
* [Security](/Uniswap/universal-router/security)
* [Insights](/Uniswap/universal-router/pulse)

[Permalink](https://github.com/Uniswap/universal-router/compare/Uniswap%3A5e237de...Uniswap%3Acda697d)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
Uniswap/universal-router

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
v1.0.1

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/Uniswap/universal-router/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.1.0)

Could not load tags

Nothing to show

[{{ refName }}
default](/Uniswap/universal-router/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.1.0)

 Loading

...

*head repository:*
Uniswap/universal-router

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
v1.1.0

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/Uniswap/universal-router/compare/v1.0.1...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/Uniswap/universal-router/compare/v1.0.1...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

* 7

  commits
* 30

  files changed
* 4

  contributors

### Commits on Nov 21, 2022

1. [Update README.md with section about contributing (if contributing plz…](/Uniswap/universal-router/commit/27b597b332fc786b5ec0e176ba791207876e8e39)
    …

   ```
   … read) ([#179](https://github.com/Uniswap/universal-router/pull/179))
   ```

   [![@ewilz](https://avatars.githubusercontent.com/u/5539720?s=40&v=4)](/ewilz)

   [ewilz](/Uniswap/universal-router/commits?author=ewilz "View all commits by ewilz")
   authored
   Nov 21, 2022

   Configuration menu

   * [View commit details](/Uniswap/universal-router/commit/27b597b332fc786b5ec0e176ba791207876e8e39)
   * Copy full SHA for 27b597b
   * [Browse repository at this point](/Uniswap/universal-router/tree/27b597b332fc786b5ec0e176ba791207876e8e39)

   Copy the full SHA

    [27b597b](/Uniswap/universal-router/commit/27b597b332fc786b5ec0e176ba791207876e8e39)View commit details

   Browse the repository at this point in the history

### Commits on Nov 22, 2022

1. [fix contributions link in readme (](/Uniswap/universal-router/commit/49e93250f108d2dde284c7509915f73949952671)[#185](https://github.com/Uniswap/universal-router/pull/185)[)](/Uniswap/universal-router/commit/49e93250f108d2dde284c7509915f73949952671)

   [![@ewilz](https://avatars.githubusercontent.com/u/5539720?s=40&v=4)](/ewilz)

   [ewilz](/Uniswap/universal-router/commits?author=ewilz "View all commits by ewilz")
   authored
   Nov 22, 2022

   Configuration menu

   * [View commit details](/Uniswap/universal-router/commit/49e93250f108d2dde284c7509915f73949952671)
   * Copy full SHA for 49e9325
   * [Browse repository at this point](/Uniswap/universal-router/tree/49e93250f108d2dde284c7509915f73949952671)

   Copy the full SHA

    [49e9325](/Uniswap/universal-router/commit/49e93250f108d2dde284c7509915f73949952671)View commit details

   Browse the repository at this point in the history
2. [feat: add lite profile (](/Uniswap/universal-router/commit/3615111b58b467f86edbf5df8d4a160df6278944)[#182](https://github.com/Uniswap/universal-router/pull/182)[)](/Uniswap/universal-router/commit/3615111b58b467f86edbf5df8d4a160df6278944)
    …

   ```
   For quick testing, add FOUNDRY_PROFILE=lite to get ~8s compilation times
   instead of ~45s
   ```

   [![@marktoda](https://avatars.githubusercontent.com/u/40770586?s=40&v=4)](/marktoda)

   [marktoda](/Uniswap/universal-router/commits?author=marktoda "View all commits by marktoda")
   authored
   Nov 22, 2022

   Configuration menu

   * [View commit details](/Uniswap/universal-router/commit/3615111b58b467f86edbf5df8d4a160df6278944)
   * Copy full SHA for 3615111
   * [Browse repository at this point](/Uniswap/universal-router/tree/3615111b58b467f86edbf5df8d4a160df6278944)

   Copy the full SHA

    [3615111](/Uniswap/universal-router/commit/3615111b58b467f86edbf5df8d4a160df6278944)View commit details

   Browse the repository at this point in the history

### Commits on Nov 28, 2022

1. [[to consider] dirty reentrancy lock (](/Uniswap/universal-router/commit/d82c6685ef566d9b280651c99f4b93a8454c08a8)[#189](https://github.com/Uniswap/universal-router/pull/189)[)](/Uniswap/universal-router/commit/d82c6685ef566d9b280651c99f4b93a8454c08a8)
    …

   ```
   * Gas costs for clean reentrancy lock

   * Gas costs for direct reentrancy lock

   * Reentrancy test

   * bytecode increase
   ```

   [![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&v=4)](/hensha256)

   [hensha256](/Uniswap/universal-router/commits?author=hensha256 "View all commits by hensha256")
   authored
   Nov 28, 2022

   Configuration menu

   * [View commit details](/Uniswap/universal-router/commit/d82c6685ef566d9b280651c99f4b93a8454c08a8)
   * Copy full SHA for d82c668
   * [Browse repository at this point](/Uniswap/universal-router/tree/d82c6685ef566d9b280651c99f4b93a8454c08a8)

   Copy the full SHA

    [d82c668](/Uniswap/universal-router/commit/d82c6685ef566d9b280651c99f4b93a8454c08a8)View commit details

   Browse the repository at this point in the history

### Commits on Nov 30, 2022

1. [Alternative nesting logic (](/Uniswap/universal-router/commit/2e8dd948289fe19fac713c0c0055d314ffe1795d)[#183](https://github.com/Uniswap/universal-router/pull/183)[)](/Uniswap/universal-router/commit/2e8dd948289fe19fac713c0c0055d314ffe1795d)
    …

   ```
   * Alternative nesting logic

   * linting

   * Update deploy contract
   ```

   [![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&v=4)](/hensha256)

   [hensha256](/Uniswap/universal-router/commits?author=hensha256 "View all commits by hensha256")
   authored
   Nov 30, 2022

   Configuration menu

   * [View commit details](/Uniswap/universal-router/commit/2e8dd948289fe19fac713c0c0055d314ffe1795d)
   * Copy full SHA for 2e8dd94
   * [Browse repository at this point](/Uniswap/universal-router/tree/2e8dd948289fe19fac713c0c0055d314ffe1795d)

   Copy the full SHA

    [2e8dd94](/Uniswap/universal-router/commit/2e8dd948289fe19fac713c0c0055d314ffe1795d)View commit details

   Browse the repository at this point in the history
2. [New deploy addresses (](/Uniswap/universal-router/commit/d2575ff41223d2766ee17f99ae7258545405ef9f)[#191](https://github.com/Uniswap/universal-router/pull/191)[)](/Uniswap/universal-router/commit/d2575ff41223d2766ee17f99ae7258545405ef9f)

   [![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&v=4)](/hensha256)

   [hensha256](/Uniswap/universal-router/commits?author=hensha256 "View all commits by hensha256")
   authored
   Nov 30, 2022

   Configuration menu

   * [View commit details](/Uniswap/universal-router/commit/d2575ff41223d2766ee17f99ae7258545405ef9f)
   * Copy full SHA for d2575ff
   * [Browse repository at this point](/Uniswap/universal-router/tree/d2575ff41223d2766ee17f99ae7258545405ef9f)

   Copy the full SHA

    [d2575ff](/Uniswap/universal-router/commit/d2575ff41223d2766ee17f99ae7258545405ef9f)View commit details

   Browse the repository at this point in the history
3. [1.1.0](/Uniswap/universal-router/commit/cda697da221e24ca143bc4f55023694a2a16796f)

   [![@willpote](https://avatars.githubusercontent.com/u/81638931?s=40&v=4)](/willpote)

   [willpote](/Uniswap/universal-router/commits?author=willpote "View all commits by willpote")
   committed
   Nov 30, 2022

   Configuration menu

   * [View commit details](/Uniswap/universal-router/commit/cda697da221e24ca143bc4f55023694a2a16796f)
   * Copy full SHA for cda697d
   * [Browse repository at this point](/Uniswap/universal-router/tree/cda697da221e24ca143bc4f55023694a2a16796f)

   Copy the full SHA

    [cda697d](/Uniswap/universal-router/commit/cda697da221e24ca143bc4f55023694a2a16796f)View commit details

   Browse the repository at this point in the history

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff v1.0.1...v1.1.0`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e7a84d4d_20250108_111218.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniswap%2Funiversal-router%2Fcommit%2Fd82c6685ef566d9b280651c99f4b93a8454c08a8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniswap%2Funiversal-router%2Fcommit%2Fd82c6685ef566d9b280651c99f4b93a8454c08a8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Uniswap%2Funiversal-router)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Uniswap](/Uniswap)
/
**[universal-router](/Uniswap/universal-router)**
Public

* [Notifications](/login?return_to=%2FUniswap%2Funiversal-router) You must be signed in to change notification settings
* [Fork
  223](/login?return_to=%2FUniswap%2Funiversal-router)
* [Star
   421](/login?return_to=%2FUniswap%2Funiversal-router)

* [Code](/Uniswap/universal-router)
* [Issues
  29](/Uniswap/universal-router/issues)
* [Pull requests
  16](/Uniswap/universal-router/pulls)
* [Actions](/Uniswap/universal-router/actions)
* [Projects
  0](/Uniswap/universal-router/projects)
* [Security](/Uniswap/universal-router/security)
* [Insights](/Uniswap/universal-router/pulse)

Additional navigation options

* [Code](/Uniswap/universal-router)
* [Issues](/Uniswap/universal-router/issues)
* [Pull requests](/Uniswap/universal-router/pulls)
* [Actions](/Uniswap/universal-router/actions)
* [Projects](/Uniswap/universal-router/projects)
* [Security](/Uniswap/universal-router/security)
* [Insights](/Uniswap/universal-router/pulse)

## Commit

[Permalink](/Uniswap/universal-router/commit/d82c6685ef566d9b280651c99f4b93a8454c08a8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[to consider] dirty reentrancy lock ([#189](https://github.com/Uniswap/universal-router/pull/189))

[Browse files](/Uniswap/universal-router/tree/d82c6685ef566d9b280651c99f4b93a8454c08a8)
Browse the repository at this point in the history

```
* Gas costs for clean reentrancy lock

* Gas costs for direct reentrancy lock

* Reentrancy test

* bytecode increase
```

* Loading branch information

[![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&v=4)](/hensha256)

[hensha256](/Uniswap/universal-router/commits?author=hensha256 "View all commits by hensha256")
authored
Nov 28, 2022

1 parent
[3615111](/Uniswap/universal-router/commit/3615111b58b467f86edbf5df8d4a160df6278944)

commit d82c668

 Show file tree

 Hide file tree

Showing
**19 changed files**
with
**136 additions**
and
**91 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* contracts

  + contracts/UniversalRouter.sol
    [UniversalRouter.sol](#diff-b6e1c12783aafee7dcb1a9cbceb488ad3413b1e2a0540188a5b7dddc683b03c8)
  + base

    - contracts/base/ReentrancyLock.sol
      [ReentrancyLock.sol](#diff-373fec25e0d114d8b0380c3ed3a1f30d66c950ce97490e2f7cdd447b8d5ac8db)
  + test

    - contracts/test/ReenteringProtocol.sol
      [ReenteringProtocol.sol](#diff-427f48c0d00bd00bb64aea84079b72478884647c43353d8c814a707cfa5af5c5)
* test/integration-tests

  + test/integration-tests/UniversalRouter.test.ts
    [UniversalRouter.test.ts](#diff-18befb40f174e7241aaa27dde4ce1124fb368312ab86956e0efe9c38ee1b6fcb)
  + gas-tests/\_\_snapshots\_\_

    - test/integration-tests/gas-tests/\_\_snapshots\_\_/CheckOwnership.gas.test.ts.snap
      [CheckOwnership.gas.test.ts.snap](#diff-4a224092ecb3059f9602f468f38ba434761713ed15aa9f03aec8aa0f1ae4a17b)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/CryptoPunk.gas.test.ts.snap
      [CryptoPunk.gas.test.ts.snap](#diff-4a818c8a3688894a7aabe57ef38e52f162b2ff5acdc7e87a3e8764664f592cdf)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/Foundation.gas.test.ts.snap
      [Foundation.gas.test.ts.snap](#diff-443b2773090028ad0398deda50c4ad9cea0a536bd599c8a3052f655b6df4e8b0)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/LooksRare.gas.test.ts.snap
      [LooksRare.gas.test.ts.snap](#diff-33434b10224b2012fffc6de47cc148b99f59cd422f19f4c75f13af9e3c1e22fb)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/NFT20.gas.test.ts.snap
      [NFT20.gas.test.ts.snap](#diff-e24a22e709e44346c7f6038a23b8c1b737c52bac697c32a807bc2b07497388d1)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/NFTX.gas.test.ts.snap
      [NFTX.gas.test.ts.snap](#diff-eeb506886ab160e8acef165a62a2416eccdf9a330c7541710cdb3f573df1075d)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/Payments.gas.test.ts.snap
      [Payments.gas.test.ts.snap](#diff-6da3bd501f3fcb089f72895468e26c8602d17a8594d256dbee65f9070cf8d8da)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/Router.gas.test.ts.snap
      [Router.gas.test.ts.snap](#diff-7c0d4256bbd8536dd83914124e15f5acd0db8508b9ff6eb951c6997a86c4b059)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/Seaport.gas.test.ts.snap
      [Seaport.gas.test.ts.snap](#diff-9d4c23bf3d41e1070f0311a105e18327a041b6cb7b5c3a533ceacc8bbe6728d7)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/Sudoswap.gas.test.ts.snap
      [Sudoswap.gas.test.ts.snap](#diff-ce3060e31c1c71b0b3ed45dda887bd03c8fdb5e48a3d8daeaee38f5a0252cbd3)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/Uniswap.gas.test.ts.snap
      [Uniswap.gas.test.ts.snap](#diff-d308bb89e2eab6aeed21a7e8de78d5ed1d907a036b28a47fc7f0c6b33db3b9a7)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/UniversalRouter.gas.test.ts.snap
      [UniversalRouter.gas.test.ts.snap](#diff-e96b85dceb9c580edfa7af9e0168a7d618af4bfc91b2bbc3025c324f33968680)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/UniversalVSSwapRouter.gas.test.ts.snap
      [UniversalVSSwapRouter.gas.test.ts.snap](#diff-c30ffc8c5e2afdb5912fd6e60624af4c414834cd7b39ea0c2b2987ed29b0ce2b)
    - test/integration-tests/gas-tests/\_\_snapshots\_\_/X2Y2.gas.test.ts.snap
      [X2Y2.gas.test.ts.snap](#diff-c40bb391071b4c4d3e0792d0c31f4e896812917f2ca96af48c007b563285337e)
  + shared

    - test/integration-tests/shared/deployUniversalRouter.ts
      [deployUniversalRouter.ts](#diff-de1e6b6e7236c29e5eee40f75588b2eab9e1baf5632990b8b39e2e5e04ab6cb4)

## There are no files selected for viewing

5 changes: 3 additions & 2 deletions

5
[contracts/UniversalRouter.sol](#diff-b6e1c12783aafee7dcb1a9cbceb488ad3413b1e2a0540188a5b7dddc683b03c8 "contracts/UniversalRouter.sol")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/contracts/UniversalRouter.sol)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,8 +7,9 @@ import {RouterParameters, RouterImmutables} from './base/RouterImmutables.sol'; |
|  |  | import {Constants} from './libraries/Constants.sol'; |
|  |  | import {Commands} from './libraries/Commands.sol'; |
|  |  | import {IUniversalRouter} from './interfaces/IUniversalRouter.sol'; |
|  |  | import {ReentrancyLock} from './base/ReentrancyLock.sol'; |
|  |  |  |
|  |  | contract UniversalRouter is RouterImmutables, IUniversalRouter, Dispatcher, RewardsCollector { |
|  |  | contract UniversalRouter is RouterImmutables, IUniversalRouter, Dispatcher, RewardsCollector, ReentrancyLock { |
|  |  | modifier checkDeadline(uint256 deadline) { |
|  |  | if (block.timestamp > deadline) revert TransactionDeadlinePassed(); |
|  |  | \_; |
| Expand All | | @@ -26,7 +27,7 @@ contract UniversalRouter is RouterImmutables, IUniversalRouter, Dispatcher, Rewa |
|  |  | } |
|  |  |  |
|  |  | /// @inheritdoc IUniversalRouter |
|  |  | function execute(bytes calldata commands, bytes[] calldata inputs) public payable { |
|  |  | function execute(bytes calldata commands, bytes[] calldata inputs) public payable isNotLocked { |
|  |  | bool success; |
|  |  | bytes memory output; |
|  |  | uint256 numCommands = commands.length; |
| Expand Down | |  |

15 changes: 15 additions & 0 deletions

15
[contracts/base/ReentrancyLock.sol](#diff-373fec25e0d114d8b0380c3ed3a1f30d66c950ce97490e2f7cdd447b8d5ac8db "contracts/base/ReentrancyLock.sol")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/contracts/base/ReentrancyLock.sol)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,15 @@ |
|  |  | // SPDX-License-Identifier: GPL-3.0-or-later |
|  |  | pragma solidity ^0.8.17; |
|  |  |  |
|  |  | contract ReentrancyLock { |
|  |  | error ContractLocked(); |
|  |  |  |
|  |  | uint256 private isLocked = 1; |
|  |  |  |
|  |  | modifier isNotLocked() { |
|  |  | if (isLocked != 1) revert ContractLocked(); |
|  |  | isLocked = 2; |
|  |  | \_; |
|  |  | isLocked = 1; |
|  |  | } |
|  |  | } |

11 changes: 11 additions & 0 deletions

11
[contracts/test/ReenteringProtocol.sol](#diff-427f48c0d00bd00bb64aea84079b72478884647c43353d8c814a707cfa5af5c5 "contracts/test/ReenteringProtocol.sol")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/contracts/test/ReenteringProtocol.sol)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,11 @@ |
|  |  | // SPDX-License-Identifier: GPL-3.0-or-later |
|  |  | pragma solidity ^0.8.15; |
|  |  |  |
|  |  | contract ReenteringProtocol { |
|  |  | error NotAllowedReenter(); |
|  |  |  |
|  |  | function callAndReenter(address universalRouter, bytes calldata data) public payable { |
|  |  | (bool success,) = universalRouter.call(data); |
|  |  | if (!success) revert NotAllowedReenter(); |
|  |  | } |
|  |  | } |

34 changes: 34 additions & 0 deletions

34
[test/integration-tests/UniversalRouter.test.ts](#diff-18befb40f174e7241aaa27dde4ce1124fb368312ab86956e0efe9c38ee1b6fcb "test/integration-tests/UniversalRouter.test.ts")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/UniversalRouter.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,7 @@ import { UniversalRouter, Permit2, ERC20, MockLooksRareRewardsDistributor, ERC72 |
|  |  | import { BigNumber, BigNumberish } from 'ethers' |
|  |  | import { Pair } from '@uniswap/v2-sdk' |
|  |  | import { expect } from './shared/expect' |
|  |  | import { abi as ROUTER\_ABI } from '../../artifacts/contracts/UniversalRouter.sol/UniversalRouter.json' |
|  |  | import { abi as TOKEN\_ABI } from '../../artifacts/solmate/tokens/ERC20.sol/ERC20.json' |
|  |  | import NFTX\_ZAP\_ABI from './shared/abis/NFTXZap.json' |
|  |  | import deployUniversalRouter, { deployPermit2 } from './shared/deployUniversalRouter' |
| Expand All | | @@ -16,6 +17,7 @@ import { |
|  |  | SOURCE\_MSG\_SENDER, |
|  |  | MAX\_UINT160, |
|  |  | MAX\_UINT, |
|  |  | ETH\_ADDRESS, |
|  |  | } from './shared/constants' |
|  |  | import { |
|  |  | seaportOrders, |
| Expand All | | @@ -34,6 +36,7 @@ import hre from 'hardhat' |
|  |  |  |
|  |  | const { ethers } = hre |
|  |  | const nftxZapInterface = new ethers.utils.Interface(NFTX\_ZAP\_ABI) |
|  |  | const routerInterface = new ethers.utils.Interface(ROUTER\_ABI) |
|  |  |  |
|  |  | describe('UniversalRouter', () => { |
|  |  | let alice: SignerWithAddress |
| Expand Down  Expand Up | | @@ -131,6 +134,37 @@ describe('UniversalRouter', () => { |
|  |  | await expect(router['execute(bytes,bytes[])'](commands, inputs)).to.be.revertedWith('InvalidBips()') |
|  |  | }) |
|  |  |  |
|  |  | it('reverts if a malicious contract tries to reenter', async () => { |
|  |  | const reentrantProtocol = await (await ethers.getContractFactory('ReenteringProtocol')).deploy() |
|  |  |  |
|  |  | router = ( |
|  |  | await deployUniversalRouter( |
|  |  | permit2, |
|  |  | mockLooksRareRewardsDistributor.address, |
|  |  | mockLooksRareToken.address, |
|  |  | reentrantProtocol.address |
|  |  | ) |
|  |  | ).connect(alice) as UniversalRouter |
|  |  |  |
|  |  | planner.addCommand(CommandType.SWEEP, [ETH\_ADDRESS, alice.address, 0]) |
|  |  | let { commands, inputs } = planner |
|  |  |  |
|  |  | const sweepCalldata = routerInterface.encodeFunctionData('execute(bytes,bytes[])', [commands, inputs]) |
|  |  | const reentrantCalldata = reentrantProtocol.interface.encodeFunctionData('callAndReenter', [ |
|  |  | router.address, |
|  |  | sweepCalldata, |
|  |  | ]) |
|  |  |  |
|  |  | planner = new RoutePlanner() |
|  |  | planner.addCommand(CommandType.NFTX, [0, reentrantCalldata]) |
|  |  | ;({ commands, inputs } = planner) |
|  |  |  |
|  |  | const notAllowedReenterSelector = '0xb418cb98' |
|  |  | await expect(router['execute(bytes,bytes[])'](commands, inputs)).to.be.revertedWith( |
|  |  | `ExecutionFailed(0, "` + notAllowedReenterSelector + `")` |
|  |  | ) |
|  |  | }) |
|  |  |  |
|  |  | describe('partial fills', async () => { |
|  |  | let nftxValue: BigNumber |
|  |  | let numCovens: number |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[test/integration-tests/gas-tests/\_\_snapshots\_\_/CheckOwnership.gas.test.ts.snap](#diff-4a224092ecb3059f9602f468f38ba434761713ed15aa9f03aec8aa0f1ae4a17b "test/integration-tests/gas-tests/__snapshots__/CheckOwnership.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/CheckOwnership.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,27 +3,27 @@ |
|  |  | exports[`Check Ownership Gas gas: checks ownership after a seaport trade, one NFT 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 2212, |
|  |  | "gasUsed": 203708, |
|  |  | "gasUsed": 206020, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Check Ownership Gas gas: checks ownership after a seaport trade, two NFTs 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 5028, |
|  |  | "gasUsed": 339196, |
|  |  | "gasUsed": 341508, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Check Ownership Gas gas: does not check ownership after a seaport trade, one NFT 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 2052, |
|  |  | "gasUsed": 200173, |
|  |  | "gasUsed": 202485, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Check Ownership Gas gas: just ownership check 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 356, |
|  |  | "gasUsed": 30615, |
|  |  | "gasUsed": 32927, |
|  |  | } |
|  |  | `; |

2 changes: 1 addition & 1 deletion

2
[test/integration-tests/gas-tests/\_\_snapshots\_\_/CryptoPunk.gas.test.ts.snap](#diff-4a818c8a3688894a7aabe57ef38e52f162b2ff5acdc7e87a3e8764664f592cdf "test/integration-tests/gas-tests/__snapshots__/CryptoPunk.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/CryptoPunk.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,6 @@ |
|  |  | exports[`Cryptopunks purchases 1 cryptopunk gas 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 356, |
|  |  | "gasUsed": 105779, |
|  |  | "gasUsed": 109868, |
|  |  | } |
|  |  | `; |

2 changes: 1 addition & 1 deletion

2
[test/integration-tests/gas-tests/\_\_snapshots\_\_/Foundation.gas.test.ts.snap](#diff-443b2773090028ad0398deda50c4ad9cea0a536bd599c8a3052f655b6df4e8b0 "test/integration-tests/gas-tests/__snapshots__/Foundation.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/Foundation.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,6 @@ |
|  |  | exports[`Foundation Gas Tests Buy a mental worlds NFT from Foundation gas: token id 32 of mental worlds 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 612, |
|  |  | "gasUsed": 179658, |
|  |  | "gasUsed": 183748, |
|  |  | } |
|  |  | `; |

4 changes: 2 additions & 2 deletions

4
[test/integration-tests/gas-tests/\_\_snapshots\_\_/LooksRare.gas.test.ts.snap](#diff-33434b10224b2012fffc6de47cc148b99f59cd422f19f4c75f13af9e3c1e22fb "test/integration-tests/gas-tests/__snapshots__/LooksRare.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/LooksRare.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,13 +3,13 @@ |
|  |  | exports[`LooksRare Gas Tests ERC-721 Purchase gas: buy 1 ERC-721 on looks rare 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 1316, |
|  |  | "gasUsed": 246469, |
|  |  | "gasUsed": 248781, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`LooksRare Gas Tests ERC-1155 Purchase gas: buy 1 ERC-1155 on looks rare 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 1348, |
|  |  | "gasUsed": 266494, |
|  |  | "gasUsed": 268806, |
|  |  | } |
|  |  | `; |

2 changes: 1 addition & 1 deletion

2
[test/integration-tests/gas-tests/\_\_snapshots\_\_/NFT20.gas.test.ts.snap](#diff-e24a22e709e44346c7f6038a23b8c1b737c52bac697c32a807bc2b07497388d1 "test/integration-tests/gas-tests/__snapshots__/NFT20.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/NFT20.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,6 @@ |
|  |  | exports[`NFT20 Buy 3 alphabetties from NFT20 gas: purchases token ids 129, 193, 278 of Alphabetties 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 836, |
|  |  | "gasUsed": 391360, |
|  |  | "gasUsed": 393672, |
|  |  | } |
|  |  | `; |

2 changes: 1 addition & 1 deletion

2
[test/integration-tests/gas-tests/\_\_snapshots\_\_/NFTX.gas.test.ts.snap](#diff-eeb506886ab160e8acef165a62a2416eccdf9a330c7541710cdb3f573df1075d "test/integration-tests/gas-tests/__snapshots__/NFTX.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/NFTX.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,6 @@ |
|  |  | exports[`NFTX Gas Tests gas: buyAndRedeem w/ specific selection 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 740, |
|  |  | "gasUsed": 490835, |
|  |  | "gasUsed": 494924, |
|  |  | } |
|  |  | `; |

14 changes: 7 additions & 7 deletions

14
[test/integration-tests/gas-tests/\_\_snapshots\_\_/Payments.gas.test.ts.snap](#diff-6da3bd501f3fcb089f72895468e26c8602d17a8594d256dbee65f9070cf8d8da "test/integration-tests/gas-tests/__snapshots__/Payments.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/Payments.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,48 +3,48 @@ |
|  |  | exports[`Payments Gas Tests Individual Command Tests gas: SWEEP with ERC20 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 356, |
|  |  | "gasUsed": 37194, |
|  |  | "gasUsed": 39506, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Payments Gas Tests Individual Command Tests gas: SWEEP\_WITH\_FEE 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 516, |
|  |  | "gasUsed": 66436, |
|  |  | "gasUsed": 68748, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Payments Gas Tests Individual Command Tests gas: TRANSFER with ERC20 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 356, |
|  |  | "gasUsed": 36168, |
|  |  | "gasUsed": 38480, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Payments Gas Tests Individual Command Tests gas: TRANSFER with ETH 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 356, |
|  |  | "gasUsed": 31759, |
|  |  | "gasUsed": 34071, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Payments Gas Tests Individual Command Tests gas: UNWRAP\_WETH 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 324, |
|  |  | "gasUsed": 44647, |
|  |  | "gasUsed": 46959, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Payments Gas Tests Individual Command Tests gas: UNWRAP\_WETH\_WITH\_FEE 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 644, |
|  |  | "gasUsed": 52003, |
|  |  | "gasUsed": 54315, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Payments Gas Tests Individual Command Tests gas: WRAP\_ETH 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 324, |
|  |  | "gasUsed": 53491, |
|  |  | "gasUsed": 57580, |
|  |  | } |
|  |  | `; |

17 changes: 0 additions & 17 deletions

17
[test/integration-tests/gas-tests/\_\_snapshots\_\_/Router.gas.test.ts.snap](#diff-7c0d4256bbd8536dd83914124e15f5acd0db8508b9ff6eb951c6997a86c4b059 "test/integration-tests/gas-tests/__snapshots__/Router.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/3615111b58b467f86edbf5df8d4a160df6278944/test/integration-tests/gas-tests/__snapshots__/Router.gas.test.ts.snap)
Edit file

Delete file

Load diff

This file was deleted.

Oops, something went wrong.

Retry

4 changes: 2 additions & 2 deletions

4
[test/integration-tests/gas-tests/\_\_snapshots\_\_/Seaport.gas.test.ts.snap](#diff-9d4c23bf3d41e1070f0311a105e18327a041b6cb7b5c3a533ceacc8bbe6728d7 "test/integration-tests/gas-tests/__snapshots__/Seaport.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/Seaport.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,13 +3,13 @@ |
|  |  | exports[`Seaport Gas Tests gas: fulfillAdvancedOrder 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 2052, |
|  |  | "gasUsed": 200173, |
|  |  | "gasUsed": 202485, |
|  |  | } |
|  |  | `; |
|  |  |  |
|  |  | exports[`Seaport Gas Tests gas: fulfillAvailableAdvancedOrders 1 orders 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 4708, |
|  |  | "gasUsed": 332120, |
|  |  | "gasUsed": 334432, |
|  |  | } |
|  |  | `; |

2 changes: 1 addition & 1 deletion

2
[test/integration-tests/gas-tests/\_\_snapshots\_\_/Sudoswap.gas.test.ts.snap](#diff-ce3060e31c1c71b0b3ed45dda887bd03c8fdb5e48a3d8daeaee38f5a0252cbd3 "test/integration-tests/gas-tests/__snapshots__/Sudoswap.gas.test.ts.snap")

Show comments

[View file](/Uniswap/universal-router/blob/d82c6685ef566d9b280651c99f4b93a8454c08a8/test/integration-tests/gas-tests/__snapshots__/Sudoswap.gas.test.ts.snap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,6 +3,6 @@ |
|  |  | exports[`Sudoswap Gas Tests Buy 3 sudolets from sudoswap gas: purchases token ids 80, 35, 93 of Sudolets 1`] = ` |
|  |  | Object { |
|  |  | "calldataByteLength": 836, |
|  |  | "gasUsed": 190323, |
|  |  | "gasUsed": 192635, |
|  |  | } |
|  |  | `; |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d82c668`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniswap%2Funiversal-router%2Fcommit%2Fd82c6685ef566d9b280651c99f4b93a8454c08a8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from twitter.com_c9173ebc_20250108_111221.html ===



=== Content from github.com_7cdd9301_20250108_111219.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniswap%2Funiversal-router%2Fpull%2F189)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUniswap%2Funiversal-router%2Fpull%2F189)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=Uniswap%2Funiversal-router)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Uniswap](/Uniswap)
/
**[universal-router](/Uniswap/universal-router)**
Public

* [Notifications](/login?return_to=%2FUniswap%2Funiversal-router) You must be signed in to change notification settings
* [Fork
  223](/login?return_to=%2FUniswap%2Funiversal-router)
* [Star
   421](/login?return_to=%2FUniswap%2Funiversal-router)

* [Code](/Uniswap/universal-router)
* [Issues
  29](/Uniswap/universal-router/issues)
* [Pull requests
  16](/Uniswap/universal-router/pulls)
* [Actions](/Uniswap/universal-router/actions)
* [Projects
  0](/Uniswap/universal-router/projects)
* [Security](/Uniswap/universal-router/security)
* [Insights](/Uniswap/universal-router/pulse)

Additional navigation options

* [Code](/Uniswap/universal-router)
* [Issues](/Uniswap/universal-router/issues)
* [Pull requests](/Uniswap/universal-router/pulls)
* [Actions](/Uniswap/universal-router/actions)
* [Projects](/Uniswap/universal-router/projects)
* [Security](/Uniswap/universal-router/security)
* [Insights](/Uniswap/universal-router/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FUniswap%2Funiversal-router%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FUniswap%2Funiversal-router%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [to consider] dirty reentrancy lock #189

 Merged

[hensha256](/hensha256)
merged 4 commits into
[main](/Uniswap/universal-router/tree/main "Uniswap/universal-router:main")
from
[reentrancy-lock-clean](/Uniswap/universal-router/tree/reentrancy-lock-clean "Uniswap/universal-router:reentrancy-lock-clean")

Nov 28, 2022

 Merged

# [[to consider] dirty reentrancy lock](#top) #189

[hensha256](/hensha256)
merged 4 commits into
[main](/Uniswap/universal-router/tree/main "Uniswap/universal-router:main")
from
[reentrancy-lock-clean](/Uniswap/universal-router/tree/reentrancy-lock-clean "Uniswap/universal-router:reentrancy-lock-clean")

Nov 28, 2022

[Conversation
1](/Uniswap/universal-router/pull/189)
[Commits
4](/Uniswap/universal-router/pull/189/commits)
[Checks
0](/Uniswap/universal-router/pull/189/checks)
[Files changed](/Uniswap/universal-router/pull/189/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![hensha256](https://avatars.githubusercontent.com/u/34962750?s=60&v=4)](/hensha256)

Copy link

Collaborator

### @hensha256 **[hensha256](/hensha256)** commented [Nov 28, 2022](#issue-1466898015)

Gas is better for our contracts with a dirty lock not a clean one - you can see this in the 2 commits

Sorry, something went wrong.

All reactions

 [hensha256](/hensha256)
added 2 commits
[November 28, 2022 15:21](#commits-pushed-2aee55f)

[![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&v=4)](/hensha256)

`[Gas costs for clean reentrancy lock](/Uniswap/universal-router/pull/189/commits/2aee55f0c05da0ae82aef72c5a648a589894e29f "Gas costs for clean reentrancy lock")`

`[2aee55f](/Uniswap/universal-router/pull/189/commits/2aee55f0c05da0ae82aef72c5a648a589894e29f)`

[![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&v=4)](/hensha256)

`[Gas costs for direct reentrancy lock](/Uniswap/universal-router/pull/189/commits/1ccef42f597ecb40678f6e54f63cced9f328e7ff "Gas costs for direct reentrancy lock")`

`[1ccef42](/Uniswap/universal-router/pull/189/commits/1ccef42f597ecb40678f6e54f63cced9f328e7ff)`

[![snreynolds](https://avatars.githubusercontent.com/u/30504811?s=60&v=4)](/snreynolds)

**[snreynolds](/snreynolds)**
approved these changes
[Nov 28, 2022](#pullrequestreview-1196502421)

 [View reviewed changes](/Uniswap/universal-router/pull/189/files/1ccef42f597ecb40678f6e54f63cced9f328e7ff)

Copy link

Member

### @snreynolds **[snreynolds](/snreynolds)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

lgtm

just maybe worth adding a test with a malicious nft contract that tries to re-enter?

Sorry, something went wrong.

 👍
1
 hensha256 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&v=4)](/hensha256)

`[Reentrancy test](/Uniswap/universal-router/pull/189/commits/42aabb1eb3c4f3085bd5c87de0ef8921088d05af "Reentrancy test")`

`[42aabb1](/Uniswap/universal-router/pull/189/commits/42aabb1eb3c4f3085bd5c87de0ef8921088d05af)`

[![snreynolds](https://avatars.githubusercontent.com/u/30504811?s=60&v=4)](/snreynolds)

**[snreynolds](/snreynolds)**
approved these changes
[Nov 28, 2022](#pullrequestreview-1196584655)

 [View reviewed changes](/Uniswap/universal-router/pull/189/files/42aabb1eb3c4f3085bd5c87de0ef8921088d05af)

[![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&v=4)](/hensha256)

`[bytecode increase](/Uniswap/universal-router/pull/189/commits/aeee36be34829ec2ff1b346abe2cfb4b737bd75b "bytecode increase")`

`[aeee36b](/Uniswap/universal-router/pull/189/commits/aeee36be34829ec2ff1b346abe2cfb4b737bd75b)`

[![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&u=97912f36e9de6c4dab2c1bdf11c25d9a244b8afe&v=4)](/hensha256)
[hensha256](/hensha256)
merged commit [`d82c668`](/Uniswap/universal-router/commit/d82c6685ef566d9b280651c99f4b93a8454c08a8)
into
main

[Nov 28, 2022](https://github.com/Uniswap/universal-router/pull/189#event-7907068592)

 [![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=40&u=97912f36e9de6c4dab2c1bdf11c25d9a244b8afe&v=4)](/hensha256)
[hensha256](/hensha256)
deleted the
reentrancy-lock-clean

branch
[November 28, 2022 21:42](#event-7907068755)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FUniswap%2Funiversal-router%2Fpull%2F189)

Reviewers

[![@snreynolds](https://avatars.githubusercontent.com/u/30504811?s=40&v=4)](/snreynolds) [snreynolds](/snreynolds)

snreynolds approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@hensha256](https://avatars.githubusercontent.com/u/34962750?s=52&v=4)](/hensha256) [![@snreynolds](https://avatars.githubusercontent.com/u/30504811?s=52&v=4)](/snreynolds)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


