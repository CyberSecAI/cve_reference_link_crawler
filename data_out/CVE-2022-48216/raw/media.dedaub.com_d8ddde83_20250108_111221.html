<!DOCTYPE html><html lang="en"><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="icon" href="/favicon/favicon.ico"/><title>Uniswap Reentrancy Vulnerability Disclosure</title><meta name="robots" content="index,follow"/><meta name="description" content="Uniswap Reentrancy | Uniswap Labs recently advertised a boosted $3M bounty program for bug reports over their smart contracts."/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@dedaub"/><meta property="og:title" content="Uniswap Reentrancy Vulnerability Disclosure"/><meta property="og:description" content="Uniswap Reentrancy | Uniswap Labs recently advertised a boosted $3M bounty program for bug reports over their smart contracts."/><meta property="og:url" content="https://dedaub.com/blog/uniswap-reentrancy/"/><meta property="og:image" content="https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure.webp"/><meta property="og:locale" content="en"/><meta property="og:site_name" content="Dedaub"/><meta name="keywords" content=""/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/c6150f0a7d48ad39.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c6150f0a7d48ad39.css" data-n-g=""/><link rel="preload" href="/_next/static/css/f2c285b6c43f087a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f2c285b6c43f087a.css" data-n-p=""/><link rel="preload" href="/_next/static/css/417e09a107edbaa9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/417e09a107edbaa9.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-e0c568da6ae0f3da.js" defer=""></script><script src="/_next/static/chunks/framework-c60c8852a0c94c9d.js" defer=""></script><script src="/_next/static/chunks/main-e33d7eb511082b98.js" defer=""></script><script src="/_next/static/chunks/pages/_app-caaaf10bf2b5cfac.js" defer=""></script><script src="/_next/static/chunks/175675d1-33dfb21363865681.js" defer=""></script><script src="/_next/static/chunks/8159-9485196307999ba1.js" defer=""></script><script src="/_next/static/chunks/1664-74478490706a50e4.js" defer=""></script><script src="/_next/static/chunks/5675-84d77b33da8de434.js" defer=""></script><script src="/_next/static/chunks/9801-92928d829037b491.js" defer=""></script><script src="/_next/static/chunks/9332-53eeb5a3f5d0b2b0.js" defer=""></script><script src="/_next/static/chunks/9167-bbbca6916d90f355.js" defer=""></script><script src="/_next/static/chunks/6389-f8a05ab6cbbedac5.js" defer=""></script><script src="/_next/static/chunks/3981-0c81e88a6527ac8c.js" defer=""></script><script src="/_next/static/chunks/4333-d6d502c40615ce77.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-3afcbc6474b0ed8f.js" defer=""></script><script src="/_next/static/7pEoSVJ1Fu0ErvDXetltn/_buildManifest.js" defer=""></script><script src="/_next/static/7pEoSVJ1Fu0ErvDXetltn/_ssgManifest.js" defer=""></script></head><body class="antialiased"><div id="__next"><div class="__variable_35a09f __variable_e2f468 __variable_a17b92"><div class="grid min-h-screen grid-rows-1 font-primary"><div class="flex-1"><div class="sticky top-0 z-10 border-b border-border lg:hidden"><div class="mono flex w-screen items-center justify-center gap-2 bg-purple px-[15px] py-[8px] uppercase text-white"><a href="https://dedaub.com/blog/blockchain-transaction-monitoring-security-suite-updates/"><div class="hidden-scrollbar overflow-x-auto whitespace-nowrap hover:underline">Dedaub Security Suite New Features</div></a><div class="h-[13px] w-[13px]"><a href="https://dedaub.com/blog/blockchain-transaction-monitoring-security-suite-updates/"><svg xmlns="http://www.w3.org/2000/svg" width="13" height="12" fill="none" class="fill-white"><g clip-path="url(#right_arrow_svg__a)"><path d="M12.42 4.68 7.74 0l-.71.71 4.53 4.53v.31H0v1h11.56v.23l-4.53 4.53.71.71 4.68-4.68a.5.5 0 0 0 .15-.35V5.04a.47.47 0 0 0-.15-.35z"></path></g><defs><clipPath id="right_arrow_svg__a"><path fill="#fff" d="M0 0h12.56v12.01H0z"></path></clipPath></defs></svg></a></div></div><div class="flex items-stretch justify-between  bg-background"><a class="px-[10px] py-[20px]" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="179" height="18" fill="none"><g fill="#fff"><path d="M26.783 9.004a3.62 3.62 0 0 1-1.368 2.98l-5.102 4.612a4.72 4.72 0 0 1-3.473 1.41H0V.002h16.834a4.8 4.8 0 0 1 3.473 1.41l5.102 4.613a3.56 3.56 0 0 1 1.368 2.98zm-4.569-.725c0-2.58-2.037-4.676-4.557-4.676H3.827v10.801h13.768c2.551-.006 4.613-2.128 4.619-4.74zM87.259 9.004a3.61 3.61 0 0 1-1.375 2.98l-5.101 4.612a4.72 4.72 0 0 1-3.474 1.41H60.477V.002h16.84a4.8 4.8 0 0 1 3.473 1.41l5.102 4.613a3.56 3.56 0 0 1 1.368 2.98m-4.57-.725c0-2.58-2.036-4.676-4.556-4.676H64.296v10.801h13.769c2.55-.006 4.612-2.128 4.618-4.74V8.28zM38.522 3.603h17.595V.001H39.283c-1.3-.039-2.55.47-3.473 1.41l-5.102 4.613a3.6 3.6 0 0 0-1.368 2.98 3.58 3.58 0 0 0 1.368 2.98l5.102 4.612a4.83 4.83 0 0 0 3.473 1.41h16.84v-3.595H38.46c-2.111 0-3.95-1.493-4.433-3.603h22.096V7.212H34.04c.514-2.11 2.365-3.596 4.483-3.603zM177.625 6.024l-5.101-4.613a4.83 4.83 0 0 0-3.473-1.41h-16.834v18h16.834c1.3.038 2.55-.47 3.473-1.411l5.101-4.613a3.6 3.6 0 0 0 1.369-2.98 3.59 3.59 0 0 0-1.369-2.98zm-7.751-2.42c2.111 0 3.95 1.492 4.433 3.602h-18.27V3.603zm-.062 10.8h-13.769v-3.602h18.252c-.52 2.11-2.365 3.59-4.483 3.596zM144.032 0v14.398h-14.71c-2.452 0-4.439-2.04-4.439-4.556l.012-9.848h-3.826v8.92a5 5 0 0 0 1.368 3.565l4.062 4.105a4.78 4.78 0 0 0 3.473 1.41h17.88V0h-3.826zM99.257 0a4.72 4.72 0 0 0-3.473 1.411l-4.061 4.105a5.05 5.05 0 0 0-1.375 3.564V18h3.826v-7.198h14.141a4.72 4.72 0 0 0 3.473-1.41l1.517-1.532V18h3.826V0h-17.88zm9.838 7.2h-14.94c.44-2.097 2.248-3.603 4.34-3.603h14.94c-.439 2.103-2.247 3.602-4.34 3.602"></path></g></svg></a><div class="flex items-center justify-center border-s border-border px-[20px]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" fill="none" class="cursor-pointer" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R55d6:" data-state="closed"><path fill="#fff" fill-rule="evenodd" d="M15.085 4.5H0v2h19.034l-.834-.748c-.886-.786-1.772-1.252-3.115-1.252m8.798 7H0v2h23.88c.083-.299.12-.625.12-1 0-.371-.037-.7-.117-1m-4.85 7H0v2h15.085c1.343 0 2.229-.436 3.114-1.25z" clip-rule="evenodd"></path></svg></div></div></div><div class="top-0 z-10 hidden border-b  border-border  lg:sticky lg:block"><div class="mono flex w-screen items-center justify-center gap-2 bg-purple px-[15px] py-[4px] uppercase text-white"><a href="https://dedaub.com/blog/blockchain-transaction-monitoring-security-suite-updates/"><div class="hidden-scrollbar overflow-x-auto whitespace-nowrap hover:underline">Dedaub Security Suite New Features</div></a><div class="h-[13px] w-[13px]"><a href="https://dedaub.com/blog/blockchain-transaction-monitoring-security-suite-updates/"><svg xmlns="http://www.w3.org/2000/svg" width="13" height="12" fill="none" class="fill-white"><g clip-path="url(#right_arrow_svg__a)"><path d="M12.42 4.68 7.74 0l-.71.71 4.53 4.53v.31H0v1h11.56v.23l-4.53 4.53.71.71 4.68-4.68a.5.5 0 0 0 .15-.35V5.04a.47.47 0 0 0-.15-.35z"></path></g><defs><clipPath id="right_arrow_svg__a"><path fill="#fff" d="M0 0h12.56v12.01H0z"></path></clipPath></defs></svg></a></div></div><div class="bg-background"><div class="mx-auto flex max-w-6xl"><a class="border-e border-border px-[40px] py-[20px]" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="179" height="18" fill="none"><g fill="#fff"><path d="M26.783 9.004a3.62 3.62 0 0 1-1.368 2.98l-5.102 4.612a4.72 4.72 0 0 1-3.473 1.41H0V.002h16.834a4.8 4.8 0 0 1 3.473 1.41l5.102 4.613a3.56 3.56 0 0 1 1.368 2.98zm-4.569-.725c0-2.58-2.037-4.676-4.557-4.676H3.827v10.801h13.768c2.551-.006 4.613-2.128 4.619-4.74zM87.259 9.004a3.61 3.61 0 0 1-1.375 2.98l-5.101 4.612a4.72 4.72 0 0 1-3.474 1.41H60.477V.002h16.84a4.8 4.8 0 0 1 3.473 1.41l5.102 4.613a3.56 3.56 0 0 1 1.368 2.98m-4.57-.725c0-2.58-2.036-4.676-4.556-4.676H64.296v10.801h13.769c2.55-.006 4.612-2.128 4.618-4.74V8.28zM38.522 3.603h17.595V.001H39.283c-1.3-.039-2.55.47-3.473 1.41l-5.102 4.613a3.6 3.6 0 0 0-1.368 2.98 3.58 3.58 0 0 0 1.368 2.98l5.102 4.612a4.83 4.83 0 0 0 3.473 1.41h16.84v-3.595H38.46c-2.111 0-3.95-1.493-4.433-3.603h22.096V7.212H34.04c.514-2.11 2.365-3.596 4.483-3.603zM177.625 6.024l-5.101-4.613a4.83 4.83 0 0 0-3.473-1.41h-16.834v18h16.834c1.3.038 2.55-.47 3.473-1.411l5.101-4.613a3.6 3.6 0 0 0 1.369-2.98 3.59 3.59 0 0 0-1.369-2.98zm-7.751-2.42c2.111 0 3.95 1.492 4.433 3.602h-18.27V3.603zm-.062 10.8h-13.769v-3.602h18.252c-.52 2.11-2.365 3.59-4.483 3.596zM144.032 0v14.398h-14.71c-2.452 0-4.439-2.04-4.439-4.556l.012-9.848h-3.826v8.92a5 5 0 0 0 1.368 3.565l4.062 4.105a4.78 4.78 0 0 0 3.473 1.41h17.88V0h-3.826zM99.257 0a4.72 4.72 0 0 0-3.473 1.411l-4.061 4.105a5.05 5.05 0 0 0-1.375 3.564V18h3.826v-7.198h14.141a4.72 4.72 0 0 0 3.473-1.41l1.517-1.532V18h3.826V0h-17.88zm9.838 7.2h-14.94c.44-2.097 2.248-3.603 4.34-3.603h14.94c-.439 2.103-2.247 3.602-4.34 3.602"></path></g></svg></a><div role="menubar" class="flex grow items-center justify-center gap-x-[48px] rounded-md p-1" tabindex="-1" data-orientation="horizontal" style="outline:none"><button type="button" role="menuitem" id="radix-:Rl9d6H1:" aria-haspopup="menu" aria-expanded="false" data-state="closed" class="underline-slide body group peer flex cursor-pointer select-none items-center whitespace-nowrap rounded-sm px-3 py-1.5 outline-none before:bottom-[-9px]" tabindex="-1" data-orientation="horizontal" data-radix-collection-item="">Services<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg><div class="fixed left-0 top-[96px] hidden h-screen w-screen bg-black opacity-75 group-data-[state=open]:block group-data-[state=closed]:hidden"></div></button><button type="button" role="menuitem" id="radix-:R159d6H1:" aria-haspopup="menu" aria-expanded="false" data-state="closed" class="underline-slide body group peer flex cursor-pointer select-none items-center whitespace-nowrap rounded-sm px-3 py-1.5 outline-none before:bottom-[-9px]" tabindex="-1" data-orientation="horizontal" data-radix-collection-item="">Security Suite<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg><div class="fixed left-0 top-[96px] hidden h-screen w-screen bg-black opacity-75 group-data-[state=open]:block group-data-[state=closed]:hidden"></div></button><button type="button" role="menuitem" id="radix-:R1l9d6H1:" aria-haspopup="menu" aria-expanded="false" data-state="closed" class="underline-slide body group peer flex cursor-pointer select-none items-center whitespace-nowrap rounded-sm px-3 py-1.5 outline-none before:bottom-[-9px]" tabindex="-1" data-orientation="horizontal" data-radix-collection-item="">Company<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg><div class="fixed left-0 top-[96px] hidden h-screen w-screen bg-black opacity-75 group-data-[state=open]:block group-data-[state=closed]:hidden"></div></button><button type="button" role="menuitem" id="radix-:R259d6H1:" aria-haspopup="menu" aria-expanded="false" data-state="closed" class="underline-slide body group peer flex cursor-pointer select-none items-center whitespace-nowrap rounded-sm px-3 py-1.5 outline-none before:bottom-[-9px]" tabindex="-1" data-orientation="horizontal" data-radix-collection-item="">Resources<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg><div class="fixed left-0 top-[96px] hidden h-screen w-screen bg-black opacity-75 group-data-[state=open]:block group-data-[state=closed]:hidden"></div></button></div><a class="my-auto ps-[20px]" href="https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/auth?client_id=watchdog-client&amp;scope=openid%20profile%20email&amp;response_type=code&amp;redirect_uri=https%3A%2F%2Fapp.dedaub.com%2Fapi%2Fauth%2Fcallback%2Fkeycloak&amp;ref=null&amp;state=ZdtsAWHhKLYQanUtHMR2A09JDjAoGX8rAseNvQGLB_0&amp;code_challenge=YsXuPhez-hi_oR1gX9uQPgNL2AuYoMG-7pMTSCmMw5A&amp;code_challenge_method=S256"><button class="group inline-flex items-center justify-center gap-3 rounded-[30px] border border-highlight py-1.5 pl-[19px] pr-[7px] transition-colors duration-300 hover:bg-highlight whitespace-nowrap"><div class="text-center font-mono text-sm font-normal uppercase leading-[30px] text-highlight transition-colors duration-300 group-hover:text-background">Login</div><div class="flex h-[30px] w-[30px] items-center justify-center rounded-full border border-highlight bg-highlight transition-colors duration-300 group-hover:bg-background"><svg xmlns="http://www.w3.org/2000/svg" width="13" height="12" fill="none" class="fill-black stroke-1 transition-colors duration-300 group-hover:fill-highlight"><g clip-path="url(#right_arrow_svg__a)"><path d="M12.42 4.68 7.74 0l-.71.71 4.53 4.53v.31H0v1h11.56v.23l-4.53 4.53.71.71 4.68-4.68a.5.5 0 0 0 .15-.35V5.04a.47.47 0 0 0-.15-.35z"></path></g><defs><clipPath id="right_arrow_svg__a"><path fill="#fff" d="M0 0h12.56v12.01H0z"></path></clipPath></defs></svg></div></button></a><a class="my-auto pe-[40px] ps-[20px]" href="https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/registrations?client_id=watchdog-client&amp;response_type=code&amp;scope=openid%20email&amp;kc_locale=en&amp;redirect_uri=https://app.dedaub.com//"><button style="font-family:IBM Plex Mono, monospace" class="group inline-flex items-center justify-center gap-3 rounded-[30px] border border-highlight bg-highlight py-1.5 pl-[19px] pr-[7px] transition-colors duration-300 hover:bg-inherit whitespace-nowrap"><div class="mono text-ellipsis whitespace-nowrap text-center text-neutral-900 transition-colors duration-300 group-hover:text-highlight">Signup</div><div class="flex h-[30px] w-[30px] items-center justify-center rounded-full border border-highlight bg-background transition-colors duration-300 group-hover:bg-highlight"><svg xmlns="http://www.w3.org/2000/svg" width="13" height="12" fill="none" class="fill-highlight transition-colors duration-300 group-hover:fill-black"><g clip-path="url(#right_arrow_svg__a)"><path d="M12.42 4.68 7.74 0l-.71.71 4.53 4.53v.31H0v1h11.56v.23l-4.53 4.53.71.71 4.68-4.68a.5.5 0 0 0 .15-.35V5.04a.47.47 0 0 0-.15-.35z"></path></g><defs><clipPath id="right_arrow_svg__a"><path fill="#fff" d="M0 0h12.56v12.01H0z"></path></clipPath></defs></svg></div></button></a></div></div></div><main><div class="sticky top-[96px] z-10 h-1 w-full"><div id="progressbar" style="width:0%" class="h-full bg-highlight-blue"></div></div><div class="relative justify-end border-b border-border lg:flex"><div id="post-details" class="top-[96px] flex grow flex-col lg:sticky lg:items-end"><div id="post-detail-spacer" class="hidden lg:block" style="height:0"></div><div class="top-[96px] hidden w-full border-b border-border lg:block lg:sticky"></div><div class="mono top-[97px] w-full max-w-[378px] py-[16px] ps-[40px] uppercase text-muted lg:sticky">Tech Deep Dive</div><div class="top-[159px] w-full border-b border-border lg:sticky"></div><div id="author-details" class="mono top-[160px] flex w-full max-w-[378px] gap-4 py-[32px] ps-[40px] text-white lg:sticky"><img alt="Dedaub Logo" loading="lazy" width="200" height="200" decoding="async" data-nimg="1" class="h-[80px] w-[80px]" style="color:transparent" srcSet="/_next/image/?url=%2Fdedaub_logo.jpeg&amp;w=256&amp;q=75 1x, /_next/image/?url=%2Fdedaub_logo.jpeg&amp;w=640&amp;q=75 2x" src="/_next/image/?url=%2Fdedaub_logo.jpeg&amp;w=640&amp;q=75"/><div class="flex flex-col justify-center"><div class="uppercase">YANNIS SMARAGDAKIS</div><div class="small max-w-[114px] truncate text-muted"></div></div></div><div class="top-[304px] w-full border-b border-border lg:sticky"></div><div class="mono top-[305px] w-full max-w-[378px] py-[16px] ps-[40px] text-muted lg:sticky">16 December 2022</div><div class="top-[367px] w-full border-b border-border lg:sticky"></div></div><div class="half-margin-right max-w-[1134px] border-border lg:w-9/12 lg:border-s"><div id="post-content" class="flex justify-center border-border px-[40px] py-[50px] lg:border-s"><article class="w-full max-w-[826px]"><h1 class="heading2 top-[98px] mb-[60px]">Uniswap Reentrancy Vulnerability Disclosure</h1><div class=""><div class="PostBody_content__NKGcM">
<p>By the <a href="https://dedaub.com/">Dedaub</a> team</p>



<figure class="wp-block-image size-full"><img sizes="auto, (max-width: 512px) 100vw, 512px" srcSet="https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL.webp 512w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL-300x300.webp 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL-150x150.webp 150w" class="wp-image-634" alt="Uniswap Reentrancy Vulnerability Disclosure" src="https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL.webp" height="512" width="512" decoding="async" loading="lazy"/></figure>



<p id="71fe">Uniswap Reentrancy | Uniswap Labs recently <a href="https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fbe6ec2554bf6b/bytecode">advertised a boosted $3M bounty program</a> for bug reports over their smart contracts, and especially the new <a href="https://github.com/Uniswap/universal-router">UniversalRouter</a> and <a href="https://github.com/Uniswap/permit2">Permit2</a> functionality. We submitted a bug report and received a bounty — thank you! To our knowledge, ours was the only bug report that Uniswap acted upon (i.e., the only one to have apparently resulted in a <a href="https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fbe6ec2554bf6b/bytecode">commit-fix to smart contract code</a> and a <a href="https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fb e6ec2554bf6b/bytecode">new deployment of the UniversalRouter</a>).</p>



<p id="c6aa">The explanation of the issue is fairly straightforward, so we begin with the verbatim text of our bug report.</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p id="2925">Clearly, the UniversalRouter should not hold any balances between transactions, or these can be emptied by anyone (e.g., by calling <code>dispatch</code> with a <code>Commands.TRANSFER</code>, or <code>Commands.SWEEP</code>).</p>



<p id="70b0">This property is dangerous when combined with any possibility of untrusted parties gaining control in the middle of a user transaction. This can happen, e.g., with tainted ERC20 tokens in Uniswap pools, or with callbacks from token transfers (e.g., 721s). E.g., simple attack scenario: a user sends to the UniversalRouter funds and calls it with 3 commands:</p>



<p id="62ed">1) <code>Commands.V3_SWAP_EXACT_IN</code>, swap to a specific token<br/>2) <code>Commands.LOOKS_RARE_721</code> (or any of a large number of commands that trigger recipient callbacks), purchase NFT, send it to recipientX<br/>3) sweep amount remaining after purchase to original caller.</p>



<p id="2a92">In this case, recipientX can easily reenter the contract (by calling <code>transfer</code> or <code>sweep</code> inside its <code>onERC721Received</code> handler) and drain the entire amount, i.e., also the amount of step 3.</p>
</blockquote>



<p id="d40b">In essence, the UniversalRouter is a scripting language for all sorts of token transfers, swaps, and NFT purchases. One can perform several actions in a row, by supplying the right sequence of commands. These commands could include transfers to untrusted recipients. In this case, it is natural to expect that the transfer should send to the recipient only what the call parameters specify, and nothing more.</p>



<p id="812d">However, this is not always what would happen. If untrusted code is invoked at any point in the transfer, the code can re-enter the UniversalRouter and claim any tokens already in the UniversalRouter contract. Such tokens can, for instance, exist because the user intends to later buy an NFT, or transfer tokens to a second recipient, or because the user swaps a larger amount than needed and intends to “sweep” the remainder to themselves at the end of the UniversalRouter call. And there is no shortage of scenarios in which an untrusted recipient may be called: WETH unwrapping triggers a callback, there are tokens that perform callbacks, and tokens could be themselves untrusted, executing arbitrary code when their functions get called.</p>



<p id="e9af">Our proof-of-concept demonstrated an easy scenario:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p id="a902">Attached are two files. One is a replacement (slight addition) to your foundry test file, universal-router/test/foundry-tests/UniversalRouter.t.sol. The other should be dropped into the “mock” subdirectory. If you then run your standard `forge test -vvv` you will see for the relevant test the output:<br/>======</p>



<p id="4402">[PASS] testSweepERC1155Attack() (gas: 126514)<br/>Logs:<br/>1000000000000000000</p>



<p id="be11">======</p>



<p id="d7d7">The last line is a console.log from the attacker showing that she got a balance in an erc20 token, although she was only sent an ERC1155 token.</p>



<p id="c302">The test case is simply:</p>
</blockquote>



<pre class="wp-block-prismatic-blocks"><code class="language-javascript">function testSweepERC1155Attack() public {
 bytes memory commands = abi.encodePacked(bytes1(uint8(Commands.SWEEP_ERC1155)));
 bytes[] memory inputs = new bytes[](1);
 uint256 id = 0;
 inputs[0] = abi.encode(address(erc1155), attacker, id, 0);
 
 erc1155.mint(address(router), id, AMOUNT);
 erc20.mint(address(router), AMOUNT);
 
 router.execute(commands, inputs);
}</code></pre>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p id="4b0c">That is, the attacker is being sent an erc1155 token amount, but the router also has an erc20 token amount. (In reality, this would probably be due to other transfers, to happen later.) The attacker manages to steal the erc20 amount as well.</p>
</blockquote>



<p id="7108">The remedy we suggested was easy:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p id="1d80">… add a Uniswap reentrancy lock, although inelegant: no dispatching commands while in the middle of dispatching commands.</p>
</blockquote>



<p id="08e3">We got immediate confirmation that the issue is being examined and will be assessed for the bounty program. A couple of weeks later, we received the bounty assessment:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p id="d409">we would like to award you a one-time bounty of $40,000 (payable in USDC) for your contribution. This amount includes a $30,000 bounty for the report, as well as a 33% bonus for reporting the issue during our current bonus period. We have classified the issue as medium severity and appreciate your assistance in helping us improve the safety of our users and the web3 ecosystem as a whole.</p>
</blockquote>



<p id="b92d">Further communication clarified that the bug was assessed to have High impact and Low likelihood: the possibility of a user sending NFTs to an untrusted recipient directly (although present in the UniversalRouter unit tests) is considered “user error”. Therefore, only much more complex (and less likely) scenarios were considered valid for Uniswap reentrancy, resulting in the “low likelihood” rating.</p>



<p id="af41">We want to thank Uniswap Labs for the bounty and are happy to have helped!</p>
</div></div></article></div></div></div><div><div class="border-b border-border"><div class="mx-auto flex max-w-6xl items-center justify-between px-[40px] py-[32px]"><h3 class="heading3">Related Posts</h3><button class="font-mono text-sm font-normal uppercase leading-[30px] tracking-wide text-highlight" type="button"><span class="underline-slide inline-block">View all</span><div class=" blinking ml-2 inline-block w-3 border-b border-highlight"></div></button></div></div><div class=""><div class="mx-auto grid max-w-6xl border-collapse py-[90px] md:grid-cols-3 md:py-0"><a class="group justify-center border-border px-[20px] py-[60px] md:border-r md:px-[40px] md:pb-[120px] md:pt-[100px] max-md:border-0 max-md:border-b" href="/blog/bedrock-vulnerability-disclosure-and-actions/"><div class="mono mb-[20px] text-grey-200">Tech Deep Dive</div><img srcSet="https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-300x169.jpg 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-1024x576.jpg 1024w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-768x432.jpg 768w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-1536x864.jpg 1536w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-500x281.jpg 500w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity.jpg 1920w" alt="" class="mb-[32px]"/><h3 class="heading3 mb-[16px] text-white decoration-1 underline-offset-4 group-hover:underline">Bedrock vulnerability disclosure and actions</h3><p class="heading4 mb-[16px] text-muted">A few hours ago, the Dedaub team discovered a smart contract vulnerability in a number of uniBTC vau ...</p><p class="smallest text-grey-200">26 September 2024</p></a><a class="group justify-center border-border px-[20px] py-[60px] md:border-r md:px-[40px] md:pb-[120px] md:pt-[100px] max-md:border-0 max-md:border-b" href="/blog/rho-markets-incident/"><div class="mono mb-[20px] text-grey-200">Tech Deep Dive</div><img srcSet="https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-300x169.jpg 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-1024x576.jpg 1024w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-768x432.jpg 768w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-1536x864.jpg 1536w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-500x281.jpg 500w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2.jpg 1920w" alt="" class="mb-[32px]"/><h3 class="heading3 mb-[16px] text-white decoration-1 underline-offset-4 group-hover:underline">Rho Markets Incident</h3><p class="heading4 mb-[16px] text-muted">On July 19th, Rho Markets — a Compound V2 fork on Scroll — was involved in an incident that led to t ...</p><p class="smallest text-grey-200">5 September 2024</p></a><a class="group justify-center border-border px-[20px] py-[60px] md:border-r md:px-[40px] md:pb-[120px] md:pt-[100px]" href="/blog/web3-audit-methodology/"><div class="mono mb-[20px] text-grey-200">Tech Deep Dive</div><img srcSet="https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-300x169.jpg 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-1024x576.jpg 1024w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-768x432.jpg 768w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-1536x864.jpg 1536w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-500x281.jpg 500w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology.jpg 1920w" alt="Web3 Audit Methodology" class="mb-[32px]"/><h3 class="heading3 mb-[16px] text-white decoration-1 underline-offset-4 group-hover:underline">Web 3 Audit Methodology by Dedaub</h3><p class="heading4 mb-[16px] text-muted">Dedaub’s Security Audit teams comprise at least two senior security researchers, as well as any supp ...</p><p class="smallest text-grey-200">4 September 2024</p></a></div></div></div></main></div><footer class="block md:hidden"><div class="border-y border-border px-[50px] py-[80px]"><img alt="Dedaub logo" loading="lazy" width="400" height="400" decoding="async" data-nimg="1" class="h-auto w-full" style="color:transparent" src="/dedaub-large-logo.svg"/></div><div class="flex flex-col items-center justify-center gap-12 border-b border-border px-[10px] py-[60px]"><h3 class="text-xl font-[200]">Subscribe to our newsletter for industry insights and company news.</h3><div class="w-full"><div id="newsletter-mobile"></div></div></div><div class="grid grid-cols-2 border-b border-border"><div class="px-[10px] py-[40px]"><div class="mb-[30px] text-xs font-semibold uppercase text-muted">Security Suite</div><a class="block text-sm text-white hover:text-highlight hover:underline" href="/products/security-suite/">Overview</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/pricing/">Pricing</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="https://meetings-eu1.hubspot.com/meetings/giorgio-bonuccelli/security-suite-demo">Book a Demo</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/auth?client_id=watchdog-client&amp;scope=openid%20profile%20email&amp;response_type=code&amp;redirect_uri=https%3A%2F%2Fapp.dedaub.com%2Fapi%2Fauth%2Fcallback%2Fkeycloak&amp;ref=null&amp;state=VVwNPh_VxcTmpqKGecUI9mvNoMMGbv-aRDsQuLefUew&amp;code_challenge=tWVI_EVDc6bDj-P2nBpywA5QIEKHdUr5n8J28dz2SlE&amp;code_challenge_method=S256">Login</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/registrations?client_id=watchdog-client&amp;response_type=code&amp;scope=openid%20email&amp;kc_locale=en&amp;redirect_uri=https://app.dedaub.com//">Sign Up</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="https://docs.dedaub.com/docs/welcome">Documentation</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="https://dedaub.com/blog/dedaub-security-suite-trial-how-to/">Trial | How-to</a></div><div class="px-[10px] py-[40px]"><div class="mb-[30px] text-xs font-semibold uppercase text-muted">Company</div><a class="block text-sm text-white hover:text-highlight hover:underline" href="/about/">About</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/career/">Careers</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/blog/category/news/">News</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/form/contact-us/">Contact</a></div><div class="px-[10px] py-[40px]"><div class="mb-[30px] text-xs font-semibold uppercase text-muted">Audits</div><a class="block text-sm text-white hover:text-highlight hover:underline" href="/audits/">Reports</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/smart-contract-audits/">Smart Contract Audits</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/focused-expertise/">Focused Expertise</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/forms/contact-us/">Request Audit</a></div><div class="px-[10px] py-[40px]"><div class="mb-[30px] text-xs font-semibold uppercase text-muted">Resources</div><a class="block text-sm text-white hover:text-highlight hover:underline" href="https://dedlim.dreamhosters.com/wp-content/uploads/2024/05/^Dedaub-Brand-Package.zip">Brand Assets</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/blog/">Blog</a><a class="block text-sm text-white hover:text-highlight hover:underline" href="/faq/">FAQ</a></div></div><div class="flex items-center justify-evenly border-b border-border px-[10px] py-[30px]"><a target="_blank" href="https://github.com/Dedaub"><svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="none" class="fill-white"><path fill="#576471" fill-rule="evenodd" d="M24.987 7C14.47 7.018 5.982 15.307 6 25.493c0 7.92 5.249 14.946 12.977 17.475.96.175 1.304-.404 1.304-.896 0-.439 0-1.598-.018-3.144-5.286 1.125-6.408-2.476-6.408-2.476-.344-1.124-1.104-2.072-2.117-2.704-1.72-1.142.126-1.124.126-1.124 1.231.158 2.299.86 2.914 1.896 1.068 1.897 3.53 2.6 5.484 1.563 0 0 .037 0 .055-.017.09-.931.507-1.81 1.212-2.459-4.235-.474-8.67-2.055-8.67-9.132-.035-1.827.67-3.6 1.956-4.953a6.43 6.43 0 0 1 .18-4.882s1.593-.492 5.231 1.896a18.6 18.6 0 0 1 9.52 0c3.639-2.388 5.231-1.896 5.231-1.896a6.43 6.43 0 0 1 .181 4.882c1.285 1.352 1.991 3.126 1.955 4.953 0 7.095-4.452 8.658-8.688 9.115.924.913 1.394 2.16 1.285 3.424 0 2.459-.018 4.461-.018 5.058 0 .492.344 1.072 1.303.896 9.973-3.232 15.349-13.681 12.019-23.358C40.425 12.076 33.149 7 24.968 7z" clip-rule="evenodd"></path></svg></a><a target="_blank" href="http://t.me/dedaub"><svg xmlns="http://www.w3.org/2000/svg" width="51" height="50" fill="none" class="fill-white"><path fill="#576471" d="M40.185 9.453c-.081 1.512-.778 6.815-1.474 12.561l-2.17 16.997s-.178 2.48-1.652 2.924-3.919-1.512-4.34-1.956c-.34-.322-6.526-5.202-8.777-7.581-.761-.645-.955-1.916-.437-2.843.13-.242.324-.464.518-.605 3.125-3.569 6.866-8.004 9.133-10.827 1.037-1.29 2.09-4.335-2.267-.646L16.46 27.761c-1.263.705-2.704.746-4 .1-2.607-.968-5.651-2.278-5.651-2.278s-2.09-1.633 1.473-3.347l20.26-10.384c1.991-1.089 8.776-4.537 8.776-4.537s3.126-1.532 2.867 2.158z"></path></svg></a><a target="_blank" href="https://twitter.com/dedaub"><svg xmlns="http://www.w3.org/2000/svg" width="51" height="50" fill="none" class="fill-white"><path fill="#576471" d="M29.262 22.245 42.662 7h-3.171L27.862 20.247 18.548 7H7.834L21.89 27.013 7.834 43h3.171l12.286-13.989L33.119 43h10.715zM12.148 9.341h4.886L39.49 40.773h-4.886z"></path></svg></a><a target="_blank" href="https://discord.gg/F5X4HugTbc"><svg xmlns="http://www.w3.org/2000/svg" width="51" height="50" fill="none" class="fill-white"><path fill="#576471" d="M42.45 9.932A41.4 41.4 0 0 0 32.56 7a26 26 0 0 0-1.272 2.49 38.7 38.7 0 0 0-10.975 0A26 26 0 0 0 19.04 7a41.5 41.5 0 0 0-9.91 2.932c-5.592 7.61-8.117 16.907-7.115 26.185a40.4 40.4 0 0 0 12.143 5.863 28.7 28.7 0 0 0 2.608-4.036 25 25 0 0 1-4.09-1.868q.533-.36 1.002-.723a29.55 29.55 0 0 0 24.266 0q.501.392 1.002.723a27 27 0 0 1-4.11 1.888A28 28 0 0 0 37.442 42a40.4 40.4 0 0 0 12.144-5.864c1.001-9.277-1.545-18.594-7.136-26.204M17.83 30.855c-2.503-.14-4.423-2.188-4.319-4.618-.146-2.43 1.795-4.478 4.298-4.618 2.504.12 4.445 2.148 4.32 4.558v.06c.104 2.41-1.816 4.458-4.32 4.618zm15.941 0c-2.504-.14-4.423-2.188-4.319-4.618-.146-2.43 1.794-4.478 4.298-4.618 2.504.12 4.423 2.148 4.32 4.558v.06c.124 2.41-1.816 4.478-4.32 4.618z"></path></svg></a><a target="_blank" href="https://www.linkedin.com/company/dedaub/"><svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="none" class="fill-white"><path fill="#576471" d="M42.982 40h-7.483V28.295c0-2.796-.054-6.385-3.886-6.385s-4.5 3.048-4.5 6.168v11.904H19.63V15.94h7.193v3.282h.109a7.86 7.86 0 0 1 7.085-3.877c7.591 0 8.983 4.978 8.983 11.453V40zM11.17 12.657A4.323 4.323 0 0 1 6.833 8.33 4.323 4.323 0 0 1 11.171 4a4.323 4.323 0 0 1 4.338 4.329 4.323 4.323 0 0 1-4.338 4.328M14.912 40H7.43V15.94h7.483z"></path></svg></a></div><div class="mx-auto flex max-w-6xl items-center justify-between px-[10px] py-[20px] text-grey-200"><div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="39" height="26" fill="none"><g clip-path="url(#d-logo_svg__a)"><path fill="#2C3640" d="M0 .036h24.514c2.182 0 3.621.727 5.06 1.956L37.003 8.4C38.443 9.627 39 10.763 39 12.536s-.557 2.862-1.997 4.136l-7.429 6.409c-1.439 1.273-2.878 1.955-5.06 1.955H0v-5h25.625c3.7 0 6.723-2.963 6.723-6.585V11.53c0-3.586-2.97-6.494-6.632-6.494H0z"></path></g><defs><clipPath id="d-logo_svg__a"><path fill="#fff" d="M0 .036h39v25H0z"></path></clipPath></defs></svg><div class="ms-4 text-xs">Dedaub <!-- -->2025<!-- --> ©</div></div><a class="text-xs" href="/legal/audits/"><div class="text-xs">Legal</div></a></div></footer><footer class="hidden md:block"><div class="border-y border-border"><div class="flex"><div class="half-margin-left"><div class="flex h-full max-w-[630px] flex-col items-center justify-center gap-12 border-e border-border px-[40px] py-[60px]"><h3 class="heading3">Subscribe to our newsletter for industry insights and company news.</h3><div class="w-full"><div id="newsletter-desktop"></div></div></div></div><div class="flex grow flex-col items-start"><div class="flex w-full max-w-[882px] items-center justify-evenly py-[80px]"><a target="_blank" href="https://github.com/Dedaub"><svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="none" class="fill-white"><path fill="#576471" fill-rule="evenodd" d="M24.987 7C14.47 7.018 5.982 15.307 6 25.493c0 7.92 5.249 14.946 12.977 17.475.96.175 1.304-.404 1.304-.896 0-.439 0-1.598-.018-3.144-5.286 1.125-6.408-2.476-6.408-2.476-.344-1.124-1.104-2.072-2.117-2.704-1.72-1.142.126-1.124.126-1.124 1.231.158 2.299.86 2.914 1.896 1.068 1.897 3.53 2.6 5.484 1.563 0 0 .037 0 .055-.017.09-.931.507-1.81 1.212-2.459-4.235-.474-8.67-2.055-8.67-9.132-.035-1.827.67-3.6 1.956-4.953a6.43 6.43 0 0 1 .18-4.882s1.593-.492 5.231 1.896a18.6 18.6 0 0 1 9.52 0c3.639-2.388 5.231-1.896 5.231-1.896a6.43 6.43 0 0 1 .181 4.882c1.285 1.352 1.991 3.126 1.955 4.953 0 7.095-4.452 8.658-8.688 9.115.924.913 1.394 2.16 1.285 3.424 0 2.459-.018 4.461-.018 5.058 0 .492.344 1.072 1.303.896 9.973-3.232 15.349-13.681 12.019-23.358C40.425 12.076 33.149 7 24.968 7z" clip-rule="evenodd"></path></svg></a><a target="_blank" href="http://t.me/dedaub"><svg xmlns="http://www.w3.org/2000/svg" width="51" height="50" fill="none" class="fill-white"><path fill="#576471" d="M40.185 9.453c-.081 1.512-.778 6.815-1.474 12.561l-2.17 16.997s-.178 2.48-1.652 2.924-3.919-1.512-4.34-1.956c-.34-.322-6.526-5.202-8.777-7.581-.761-.645-.955-1.916-.437-2.843.13-.242.324-.464.518-.605 3.125-3.569 6.866-8.004 9.133-10.827 1.037-1.29 2.09-4.335-2.267-.646L16.46 27.761c-1.263.705-2.704.746-4 .1-2.607-.968-5.651-2.278-5.651-2.278s-2.09-1.633 1.473-3.347l20.26-10.384c1.991-1.089 8.776-4.537 8.776-4.537s3.126-1.532 2.867 2.158z"></path></svg></a><a target="_blank" href="https://twitter.com/dedaub"><svg xmlns="http://www.w3.org/2000/svg" width="51" height="50" fill="none" class="fill-white"><path fill="#576471" d="M29.262 22.245 42.662 7h-3.171L27.862 20.247 18.548 7H7.834L21.89 27.013 7.834 43h3.171l12.286-13.989L33.119 43h10.715zM12.148 9.341h4.886L39.49 40.773h-4.886z"></path></svg></a><a target="_blank" href="https://discord.gg/F5X4HugTbc"><svg xmlns="http://www.w3.org/2000/svg" width="51" height="50" fill="none" class="fill-white"><path fill="#576471" d="M42.45 9.932A41.4 41.4 0 0 0 32.56 7a26 26 0 0 0-1.272 2.49 38.7 38.7 0 0 0-10.975 0A26 26 0 0 0 19.04 7a41.5 41.5 0 0 0-9.91 2.932c-5.592 7.61-8.117 16.907-7.115 26.185a40.4 40.4 0 0 0 12.143 5.863 28.7 28.7 0 0 0 2.608-4.036 25 25 0 0 1-4.09-1.868q.533-.36 1.002-.723a29.55 29.55 0 0 0 24.266 0q.501.392 1.002.723a27 27 0 0 1-4.11 1.888A28 28 0 0 0 37.442 42a40.4 40.4 0 0 0 12.144-5.864c1.001-9.277-1.545-18.594-7.136-26.204M17.83 30.855c-2.503-.14-4.423-2.188-4.319-4.618-.146-2.43 1.795-4.478 4.298-4.618 2.504.12 4.445 2.148 4.32 4.558v.06c.104 2.41-1.816 4.458-4.32 4.618zm15.941 0c-2.504-.14-4.423-2.188-4.319-4.618-.146-2.43 1.794-4.478 4.298-4.618 2.504.12 4.423 2.148 4.32 4.558v.06c.124 2.41-1.816 4.478-4.32 4.618z"></path></svg></a><a target="_blank" href="https://www.linkedin.com/company/dedaub/"><svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="none" class="fill-white"><path fill="#576471" d="M42.982 40h-7.483V28.295c0-2.796-.054-6.385-3.886-6.385s-4.5 3.048-4.5 6.168v11.904H19.63V15.94h7.193v3.282h.109a7.86 7.86 0 0 1 7.085-3.877c7.591 0 8.983 4.978 8.983 11.453V40zM11.17 12.657A4.323 4.323 0 0 1 6.833 8.33 4.323 4.323 0 0 1 11.171 4a4.323 4.323 0 0 1 4.338 4.329 4.323 4.323 0 0 1-4.338 4.328M14.912 40H7.43V15.94h7.483z"></path></svg></a></div><div class="w-full border-b border-border"></div><div class="flex max-w-[882px] justify-center px-[50px] py-[80px]"><img alt="Dedaub logo" loading="lazy" width="400" height="400" decoding="async" data-nimg="1" class="h-auto w-full" style="color:transparent" src="/dedaub-large-logo.svg"/></div></div></div></div><div class="border-b border-border md:block"><div class="mx-auto flex max-w-6xl justify-between px-[40px] py-[90px]"><div class=""><div class="small-mono mb-[30px] text-grey-200">Security Suite</div><a class="small block text-muted hover:text-muted" href="/products/security-suite/">Overview</a><a class="small block text-muted hover:text-muted" href="/pricing/">Pricing</a><a class="small block text-muted hover:text-muted" href="https://meetings-eu1.hubspot.com/meetings/giorgio-bonuccelli/security-suite-demo">Book a Demo</a><a class="small block text-muted hover:text-muted" href="https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/auth?client_id=watchdog-client&amp;scope=openid%20profile%20email&amp;response_type=code&amp;redirect_uri=https%3A%2F%2Fapp.dedaub.com%2Fapi%2Fauth%2Fcallback%2Fkeycloak&amp;ref=null&amp;state=VVwNPh_VxcTmpqKGecUI9mvNoMMGbv-aRDsQuLefUew&amp;code_challenge=tWVI_EVDc6bDj-P2nBpywA5QIEKHdUr5n8J28dz2SlE&amp;code_challenge_method=S256">Login</a><a class="small block text-muted hover:text-muted" href="https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/registrations?client_id=watchdog-client&amp;response_type=code&amp;scope=openid%20email&amp;kc_locale=en&amp;redirect_uri=https://app.dedaub.com//">Sign Up</a><a class="small block text-muted hover:text-muted" href="https://docs.dedaub.com/docs/welcome">Documentation</a><a class="small block text-muted hover:text-muted" href="https://dedaub.com/blog/dedaub-security-suite-trial-how-to/">Trial | How-to</a></div><div class=""><div class="small-mono mb-[30px] text-grey-200">Company</div><a class="small block text-muted hover:text-muted" href="/about/">About</a><a class="small block text-muted hover:text-muted" href="/career/">Careers</a><a class="small block text-muted hover:text-muted" href="/blog/category/news/">News</a><a class="small block text-muted hover:text-muted" href="/form/contact-us/">Contact</a></div><div class=""><div class="small-mono mb-[30px] text-grey-200">Audits</div><a class="small block text-muted hover:text-muted" href="/audits/">Reports</a><a class="small block text-muted hover:text-muted" href="/smart-contract-audits/">Smart Contract Audits</a><a class="small block text-muted hover:text-muted" href="/focused-expertise/">Focused Expertise</a><a class="small block text-muted hover:text-muted" href="/forms/contact-us/">Request Audit</a></div><div class=""><div class="small-mono mb-[30px] text-grey-200">Resources</div><a class="small block text-muted hover:text-muted" href="https://dedlim.dreamhosters.com/wp-content/uploads/2024/05/^Dedaub-Brand-Package.zip">Brand Assets</a><a class="small block text-muted hover:text-muted" href="/blog/">Blog</a><a class="small block text-muted hover:text-muted" href="/faq/">FAQ</a></div></div></div><div class="mx-auto flex max-w-6xl items-center justify-between p-[40px] text-grey-200"><div class="flex items-center"><svg xmlns="http://www.w3.org/2000/svg" width="39" height="26" fill="none"><g clip-path="url(#d-logo_svg__a)"><path fill="#2C3640" d="M0 .036h24.514c2.182 0 3.621.727 5.06 1.956L37.003 8.4C38.443 9.627 39 10.763 39 12.536s-.557 2.862-1.997 4.136l-7.429 6.409c-1.439 1.273-2.878 1.955-5.06 1.955H0v-5h25.625c3.7 0 6.723-2.963 6.723-6.585V11.53c0-3.586-2.97-6.494-6.632-6.494H0z"></path></g><defs><clipPath id="d-logo_svg__a"><path fill="#fff" d="M0 .036h39v25H0z"></path></clipPath></defs></svg><div class="ms-4 text-xs">Dedaub <!-- -->2025<!-- --> ©</div></div><a class="text-xs" href="/legal/audits/"><div class="text-xs">Legal</div></a></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"__typename":"Post","author":{"avatar":{"height":96,"sourceUrl":"https://secure.gravatar.com/avatar/d0dc91c7bb34e96a849352538ff854ef?s=96\u0026d=mm\u0026r=g","width":96,"altText":"YANNIS SMARAGDAKIS"},"id":"dXNlcjo4","name":"YANNIS SMARAGDAKIS","slug":"yanniss"},"id":"cG9zdDo2MzM=","categories":["Tech Deep Dive"],"tags":[],"content":"\n\u003cp\u003eBy the\u0026nbsp;\u003ca href=\"https://dedaub.com/\" target=\"_blank\" rel=\"noreferrer noopener\"\u003eDedaub\u003c/a\u003e\u0026nbsp;team\u003c/p\u003e\n\n\n\n\u003cfigure class=\"wp-block-image size-full\"\u003e\u003cimg loading=\"lazy\" decoding=\"async\" width=\"512\" height=\"512\" src=\"https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL.webp\" alt=\"Uniswap Reentrancy Vulnerability Disclosure\" class=\"wp-image-634\" srcset=\"https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL.webp 512w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL-300x300.webp 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/04/0_7IPwUGN33nWZeNLL-150x150.webp 150w\" sizes=\"auto, (max-width: 512px) 100vw, 512px\" /\u003e\u003c/figure\u003e\n\n\n\n\u003cp id=\"71fe\"\u003eUniswap Reentrancy | Uniswap Labs recently\u0026nbsp;\u003ca href=\"https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fbe6ec2554bf6b/bytecode\" target=\"_blank\" rel=\"noreferrer noopener\"\u003eadvertised a boosted $3M bounty program\u003c/a\u003e\u0026nbsp;for bug reports over their smart contracts, and especially the new\u0026nbsp;\u003ca href=\"https://github.com/Uniswap/universal-router\" target=\"_blank\" rel=\"noreferrer noopener\"\u003eUniversalRouter\u003c/a\u003e\u0026nbsp;and\u0026nbsp;\u003ca href=\"https://github.com/Uniswap/permit2\" target=\"_blank\" rel=\"noreferrer noopener\"\u003ePermit2\u003c/a\u003e\u0026nbsp;functionality. We submitted a bug report and received a bounty — thank you! To our knowledge, ours was the only bug report that Uniswap acted upon (i.e., the only one to have apparently resulted in a\u0026nbsp;\u003ca href=\"https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fbe6ec2554bf6b/bytecode\" target=\"_blank\" rel=\"noreferrer noopener\"\u003ecommit-fix to smart contract code\u003c/a\u003e\u0026nbsp;and a\u0026nbsp;\u003ca href=\"https://app.dedaub.com/ethereum/address/0xef1c6e67703c7bd7107eed8303fb e6ec2554bf6b/bytecode\" target=\"_blank\" rel=\"noreferrer noopener\"\u003enew deployment of the UniversalRouter\u003c/a\u003e).\u003c/p\u003e\n\n\n\n\u003cp id=\"c6aa\"\u003eThe explanation of the issue is fairly straightforward, so we begin with the verbatim text of our bug report.\u003c/p\u003e\n\n\n\n\u003cblockquote class=\"wp-block-quote is-layout-flow wp-block-quote-is-layout-flow\"\u003e\n\u003cp id=\"2925\"\u003eClearly, the UniversalRouter should not hold any balances between transactions, or these can be emptied by anyone (e.g., by calling \u003ccode\u003edispatch\u003c/code\u003e with a \u003ccode\u003eCommands.TRANSFER\u003c/code\u003e, or \u003ccode\u003eCommands.SWEEP\u003c/code\u003e).\u003c/p\u003e\n\n\n\n\u003cp id=\"70b0\"\u003eThis property is dangerous when combined with any possibility of untrusted parties gaining control in the middle of a user transaction. This can happen, e.g., with tainted ERC20 tokens in Uniswap pools, or with callbacks from token transfers (e.g., 721s). E.g., simple attack scenario: a user sends to the UniversalRouter funds and calls it with 3 commands:\u003c/p\u003e\n\n\n\n\u003cp id=\"62ed\"\u003e1)\u0026nbsp;\u003ccode\u003eCommands.V3_SWAP_EXACT_IN\u003c/code\u003e, swap to a specific token\u003cbr\u003e2)\u0026nbsp;\u003ccode\u003eCommands.LOOKS_RARE_721\u003c/code\u003e\u0026nbsp;(or any of a large number of commands that trigger recipient callbacks), purchase NFT, send it to recipientX\u003cbr\u003e3) sweep amount remaining after purchase to original caller.\u003c/p\u003e\n\n\n\n\u003cp id=\"2a92\"\u003eIn this case, recipientX can easily reenter the contract (by calling\u0026nbsp;\u003ccode\u003etransfer\u003c/code\u003e\u0026nbsp;or\u0026nbsp;\u003ccode\u003esweep\u003c/code\u003e\u0026nbsp;inside its\u0026nbsp;\u003ccode\u003eonERC721Received\u003c/code\u003e\u0026nbsp;handler) and drain the entire amount, i.e., also the amount of step 3.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\n\n\u003cp id=\"d40b\"\u003eIn essence, the UniversalRouter is a scripting language for all sorts of token transfers, swaps, and NFT purchases. One can perform several actions in a row, by supplying the right sequence of commands. These commands could include transfers to untrusted recipients. In this case, it is natural to expect that the transfer should send to the recipient only what the call parameters specify, and nothing more.\u003c/p\u003e\n\n\n\n\u003cp id=\"812d\"\u003eHowever, this is not always what would happen. If untrusted code is invoked at any point in the transfer, the code can re-enter the UniversalRouter and claim any tokens already in the UniversalRouter contract. Such tokens can, for instance, exist because the user intends to later buy an NFT, or transfer tokens to a second recipient, or because the user swaps a larger amount than needed and intends to “sweep” the remainder to themselves at the end of the UniversalRouter call. And there is no shortage of scenarios in which an untrusted recipient may be called: WETH unwrapping triggers a callback, there are tokens that perform callbacks, and tokens could be themselves untrusted, executing arbitrary code when their functions get called.\u003c/p\u003e\n\n\n\n\u003cp id=\"e9af\"\u003eOur proof-of-concept demonstrated an easy scenario:\u003c/p\u003e\n\n\n\n\u003cblockquote class=\"wp-block-quote is-layout-flow wp-block-quote-is-layout-flow\"\u003e\n\u003cp id=\"a902\"\u003eAttached are two files. One is a replacement (slight addition) to your foundry test file, universal-router/test/foundry-tests/UniversalRouter.t.sol. The other should be dropped into the “mock” subdirectory. If you then run your standard `forge test -vvv` you will see for the relevant test the output:\u003cbr\u003e======\u003c/p\u003e\n\n\n\n\u003cp id=\"4402\"\u003e[PASS] testSweepERC1155Attack() (gas: 126514)\u003cbr\u003eLogs:\u003cbr\u003e1000000000000000000\u003c/p\u003e\n\n\n\n\u003cp id=\"be11\"\u003e======\u003c/p\u003e\n\n\n\n\u003cp id=\"d7d7\"\u003eThe last line is a console.log from the attacker showing that she got a balance in an erc20 token, although she was only sent an ERC1155 token.\u003c/p\u003e\n\n\n\n\u003cp id=\"c302\"\u003eThe test case is simply:\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\n\n\u003cpre class=\"wp-block-prismatic-blocks\"\u003e\u003ccode class=\"language-javascript\"\u003efunction testSweepERC1155Attack() public {\n bytes memory commands = abi.encodePacked(bytes1(uint8(Commands.SWEEP_ERC1155)));\n bytes[] memory inputs = new bytes[](1);\n uint256 id = 0;\n inputs[0] = abi.encode(address(erc1155), attacker, id, 0);\n \n erc1155.mint(address(router), id, AMOUNT);\n erc20.mint(address(router), AMOUNT);\n \n router.execute(commands, inputs);\n}\u003c/code\u003e\u003c/pre\u003e\n\n\n\n\u003cblockquote class=\"wp-block-quote is-layout-flow wp-block-quote-is-layout-flow\"\u003e\n\u003cp id=\"4b0c\"\u003eThat is, the attacker is being sent an erc1155 token amount, but the router also has an erc20 token amount. (In reality, this would probably be due to other transfers, to happen later.) The attacker manages to steal the erc20 amount as well.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\n\n\u003cp id=\"7108\"\u003eThe remedy we suggested was easy:\u003c/p\u003e\n\n\n\n\u003cblockquote class=\"wp-block-quote is-layout-flow wp-block-quote-is-layout-flow\"\u003e\n\u003cp id=\"1d80\"\u003e… add a Uniswap reentrancy lock, although inelegant: no dispatching commands while in the middle of dispatching commands.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\n\n\u003cp id=\"08e3\"\u003eWe got immediate confirmation that the issue is being examined and will be assessed for the bounty program. A couple of weeks later, we received the bounty assessment:\u003c/p\u003e\n\n\n\n\u003cblockquote class=\"wp-block-quote is-layout-flow wp-block-quote-is-layout-flow\"\u003e\n\u003cp id=\"d409\"\u003ewe would like to award you a one-time bounty of $40,000 (payable in USDC) for your contribution. This amount includes a $30,000 bounty for the report, as well as a 33% bonus for reporting the issue during our current bonus period. We have classified the issue as medium severity and appreciate your assistance in helping us improve the safety of our users and the web3 ecosystem as a whole.\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\n\n\u003cp id=\"b92d\"\u003eFurther communication clarified that the bug was assessed to have High impact and Low likelihood: the possibility of a user sending NFTs to an untrusted recipient directly (although present in the UniversalRouter unit tests) is considered “user error”. Therefore, only much more complex (and less likely) scenarios were considered valid for Uniswap reentrancy, resulting in the “low likelihood” rating.\u003c/p\u003e\n\n\n\n\u003cp id=\"af41\"\u003eWe want to thank Uniswap Labs for the bounty and are happy to have helped!\u003c/p\u003e\n","date":"2022-12-16T04:56:00","excerpt":"\u003cp\u003eBy the\u0026nbsp;Dedaub\u0026nbsp;team Uniswap Reentrancy | Uniswap Labs recently\u0026nbsp;advertised a boosted $3M bounty program\u0026nbsp;for bug reports over their smart contracts, and especially the new\u0026nbsp;UniversalRouter\u0026nbsp;and\u0026nbsp;Permit2\u0026nbsp;functionality. We submitted a bug report and received a bounty — thank you! To our knowledge, ours was \u0026hellip; \u003ca href=\"https://dedlim.dreamhosters.com/2022/12/16/uniswap-reentrancy/\"\u003eContinue reading \u003cspan class=\"meta-nav\"\u003e\u0026rarr;\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\n","featuredImage":{"sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure.webp","altText":"","srcSet":"https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure-300x169.webp 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure-1024x576.webp 1024w, https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure-768x432.webp 768w, https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure-1536x864.webp 1536w, https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure-500x281.webp 500w, https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure.webp 1920w","height":1080,"width":1920},"modified":"2024-08-22T08:05:51","databaseId":633,"title":"Uniswap Reentrancy Vulnerability Disclosure","slug":"uniswap-reentrancy","isSticky":false,"categoryIds":[20]},"seo":{"__typename":"PostTypeSEO","canonical":"https://dedlim.dreamhosters.com/2022/12/16/uniswap-reentrancy/","metaDesc":"Uniswap Reentrancy | Uniswap Labs recently advertised a boosted $3M bounty program for bug reports over their smart contracts.","metaRobotsNofollow":"follow","metaRobotsNoindex":"index","opengraphAuthor":"","opengraphDescription":"Uniswap Reentrancy | Uniswap Labs recently advertised a boosted $3M bounty program for bug reports over their smart contracts.","opengraphModifiedTime":"2024-08-22T08:05:51+00:00","opengraphPublishedTime":"2022-12-16T04:56:00+00:00","opengraphPublisher":"","opengraphTitle":"Uniswap Reentrancy Vulnerability Disclosure","opengraphType":"article","readingTime":3,"title":"Uniswap Reentrancy Vulnerability Disclosure","twitterDescription":"","twitterTitle":"","twitterImage":null,"opengraphImage":{"__typename":"MediaItem","altText":"","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2022/12/Uniswap-reentrancy-vulnerability-disclosure.webp","mediaDetails":{"__typename":"MediaDetails","height":1080,"width":1920}}},"navbarItems":[{"title":"Services","leftSubtitle":null,"leftItems":[{"label":"Smart Contract Audits","link":"/smart-contract-audit/","icon":null},{"label":"Focused Expertise","link":"/focused-expertise","icon":null},{"label":"Audit Reports","link":"/audits","icon":null}],"cta":{"__typename":"AcfLink","title":"Request An Audit","url":"/form/request-an-audit/"},"rightSubtitle":null,"rightItems":null,"order":null},{"title":"Security Suite","leftSubtitle":"Explore","leftItems":[{"label":"Overview","link":"/products/security-suite","icon":null},{"label":"Pricing","link":"https://app.dedaub.com/pricing","icon":null},{"label":"Decompiler API","link":"/feature/api/","icon":null},{"label":"Book a Demo","link":"https://meetings-eu1.hubspot.com/meetings/giorgio-bonuccelli/security-suite-demo","icon":null},{"label":"Login","link":"https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/auth?client_id=watchdog-client\u0026scope=openid%20profile%20email\u0026response_type=code\u0026redirect_uri=https%3A%2F%2Fapp.dedaub.com%2Fapi%2Fauth%2Fcallback%2Fkeycloak\u0026ref=null\u0026state=-gtqZ1hEKWK0xi2-WIX95sLtNyHL28lyIavVMP6lcv4\u0026code_challenge=ui5OqvDZCAyhfvdEWpl-_AydnF92XY8v9mlFl_vEpVA\u0026code_challenge_method=S256","icon":null},{"label":"Signup","link":"https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/registrations?client_id=watchdog-client\u0026response_type=code\u0026scope=openid%20email\u0026kc_locale=en\u0026redirect_uri=https://app.dedaub.com//","icon":null}],"cta":null,"rightSubtitle":"Features","rightItems":[{"label":"Monitor","description":"Continuous, real-time auditing for operational security that never sleeps","link":"/feature/smart-contract-monitoring","icon":{"__typename":"MediaItem","altText":"monitor icon","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/03/features-monitor-icon.svg"}},{"label":"Analyzer","description":"Static analysis tooling for smart contracts","link":"/feature/static-analysis-tools","icon":{"__typename":"MediaItem","altText":"static analysis icon","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/03/features-analyzer-icon.svg"}},{"label":"Decompiler","description":" Understand the logic behind no-source contracts by decompiling bytecode","link":"/feature/bytecode-decompiler","icon":{"__typename":"MediaItem","altText":"decompiler icon","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/03/features-decompiler-icon.svg"}}],"order":1},{"title":"Company","leftSubtitle":null,"leftItems":[{"label":"About","link":"/about","icon":{"__typename":"MediaItem","altText":"","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/03/About-icon.svg"}},{"label":"Careers","link":"/careers","icon":{"__typename":"MediaItem","altText":"","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/03/Careers-icon.svg"}},{"label":"News","link":"/blog/category/news/","icon":{"__typename":"MediaItem","altText":"","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/03/News-icon.svg"}},{"label":"Contact","link":"/forms/contact-us","icon":{"__typename":"MediaItem","altText":"","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/03/Contact-icon.svg"}},{"label":"Partners","link":"/partners/","icon":{"__typename":"MediaItem","altText":"","sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/08/partners.svg"}}],"cta":null,"rightSubtitle":null,"rightItems":null,"order":3},{"title":"Resources","leftSubtitle":null,"leftItems":[{"label":"Blog","link":"/blog/","icon":null},{"label":"FAQ","link":"/faq","icon":null}],"cta":null,"rightSubtitle":null,"rightItems":null,"order":4}],"footerCategories":[{"name":"Security Suite","links":[{"__typename":"AcfLink","title":"Overview","url":"/products/security-suite","order":1},{"__typename":"AcfLink","title":"Pricing","url":"/pricing","order":2},{"__typename":"AcfLink","title":"Book a Demo","url":"https://meetings-eu1.hubspot.com/meetings/giorgio-bonuccelli/security-suite-demo","order":3},{"__typename":"AcfLink","title":"Login","url":"https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/auth?client_id=watchdog-client\u0026scope=openid%20profile%20email\u0026response_type=code\u0026redirect_uri=https%3A%2F%2Fapp.dedaub.com%2Fapi%2Fauth%2Fcallback%2Fkeycloak\u0026ref=null\u0026state=VVwNPh_VxcTmpqKGecUI9mvNoMMGbv-aRDsQuLefUew\u0026code_challenge=tWVI_EVDc6bDj-P2nBpywA5QIEKHdUr5n8J28dz2SlE\u0026code_challenge_method=S256","order":4},{"__typename":"AcfLink","title":"Sign Up","url":"https://auth.dedaub.com/realms/dedaub/protocol/openid-connect/registrations?client_id=watchdog-client\u0026response_type=code\u0026scope=openid%20email\u0026kc_locale=en\u0026redirect_uri=https://app.dedaub.com//","order":5},{"__typename":"AcfLink","title":"Documentation","url":"https://docs.dedaub.com/docs/welcome","order":6},{"__typename":"AcfLink","title":"Trial | How-to","url":"https://dedaub.com/blog/dedaub-security-suite-trial-how-to/","order":7}]},{"name":"Company","links":[{"__typename":"AcfLink","title":"About","url":"/about","order":1},{"__typename":"AcfLink","title":"Careers","url":"/career","order":2},{"__typename":"AcfLink","title":"News","url":"/blog/category/news/","order":3},{"__typename":"AcfLink","title":"Contact","url":"/form/contact-us","order":4}]},{"name":"Audits","links":[{"__typename":"AcfLink","title":"Reports","url":"/audits","order":1},{"__typename":"AcfLink","title":"Smart Contract Audits","url":"/smart-contract-audits","order":2},{"__typename":"AcfLink","title":"Focused Expertise","url":"/focused-expertise/","order":3},{"__typename":"AcfLink","title":"Request Audit","url":"/forms/contact-us","order":4}]},{"name":"Resources","links":[{"__typename":"AcfLink","title":"Brand Assets","url":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/05/^Dedaub-Brand-Package.zip","order":-4},{"__typename":"AcfLink","title":"Blog","url":"/blog","order":1},{"__typename":"AcfLink","title":"FAQ","url":"/faq","order":3}]}],"banner":{"__typename":"AcfLink","title":"Dedaub Security Suite New Features","url":"https://dedaub.com/blog/blockchain-transaction-monitoring-security-suite-updates/"},"relatedPosts":[{"__typename":"Post","author":{"avatar":{"height":96,"sourceUrl":"https://secure.gravatar.com/avatar/a1171ef011da6cab01e784ec310313e2?s=96\u0026d=mm\u0026r=g","width":96,"altText":"Dedaub"},"id":"dXNlcjox","name":"Dedaub","slug":"dedlim_ulk8k1"},"excerpt":"\u003cp\u003eA few hours ago, the Dedaub team discovered a smart contract vulnerability in a number of uniBTC vault smart contracts in the Bedrock project. We disclosed the issue to the Bedrock account on Twitter and soon thereafter (after no response \u0026hellip; \u003ca href=\"https://dedlim.dreamhosters.com/2024/09/26/bedrock-vulnerability-disclosure-and-actions/\"\u003eContinue reading \u003cspan class=\"meta-nav\"\u003e\u0026rarr;\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\n","id":"cG9zdDoxODA3","categories":["Tech Deep Dive"],"tags":["bedrock","hacks","solidity","uniBTC","vulnerability"],"featuredImage":{"sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity.jpg","altText":"","srcSet":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-300x169.jpg 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-1024x576.jpg 1024w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-768x432.jpg 768w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-1536x864.jpg 1536w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity-500x281.jpg 500w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Bedrocks-vulnerabity.jpg 1920w","height":1080,"width":1920},"databaseId":1807,"date":"2024-09-26T22:53:22","isSticky":false,"postId":1807,"slug":"bedrock-vulnerability-disclosure-and-actions","title":"Bedrock vulnerability disclosure and actions","categoryIds":[20]},{"__typename":"Post","author":{"avatar":{"height":96,"sourceUrl":"https://secure.gravatar.com/avatar/425e3d29ae6a1205cf6e27d2b0d35faf?s=96\u0026d=mm\u0026r=g","width":96,"altText":"YANNIS BOLLANOS"},"id":"dXNlcjo1","name":"YANNIS BOLLANOS","slug":"yannis"},"excerpt":"\u003cp\u003eOn July 19th, Rho Markets — a Compound V2 fork on Scroll — was involved in an incident that led to the creation of $7.5mil in bad debt. The root cause of the vulnerability was the misconfiguration of the oracle \u0026hellip; \u003ca href=\"https://dedlim.dreamhosters.com/2024/09/05/rho-markets-incident/\"\u003eContinue reading \u003cspan class=\"meta-nav\"\u003e\u0026rarr;\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\n","id":"cG9zdDoxNjcz","categories":["Tech Deep Dive"],"tags":[],"featuredImage":{"sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2.jpg","altText":"","srcSet":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-300x169.jpg 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-1024x576.jpg 1024w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-768x432.jpg 768w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-1536x864.jpg 1536w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2-500x281.jpg 500w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Rho-Markets-Accident-Review-2.jpg 1920w","height":1080,"width":1920},"databaseId":1673,"date":"2024-09-05T13:35:44","isSticky":false,"postId":1673,"slug":"rho-markets-incident","title":"Rho Markets Incident","categoryIds":[20]},{"__typename":"Post","author":{"avatar":{"height":96,"sourceUrl":"https://secure.gravatar.com/avatar/d0dc91c7bb34e96a849352538ff854ef?s=96\u0026d=mm\u0026r=g","width":96,"altText":"YANNIS SMARAGDAKIS"},"id":"dXNlcjo4","name":"YANNIS SMARAGDAKIS","slug":"yanniss"},"excerpt":"\u003cp\u003eDedaub’s Security Audit teams comprise at least two senior security researchers, as well as any support they may need (e.g., cryptography expertise, financial modeling, testing) from the rest of our team. We carefully match the team\u0026#8217;s expertise to your project\u0026#8217;s \u0026hellip; \u003ca href=\"https://dedlim.dreamhosters.com/2024/09/04/web3-audit-methodology/\"\u003eContinue reading \u003cspan class=\"meta-nav\"\u003e\u0026rarr;\u003c/span\u003e\u003c/a\u003e\u003c/p\u003e\n","id":"cG9zdDoxNjQ3","categories":["Tech Deep Dive"],"tags":["Security Audit"],"featuredImage":{"sourceUrl":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology.jpg","altText":"Web3 Audit Methodology","srcSet":"https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-300x169.jpg 300w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-1024x576.jpg 1024w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-768x432.jpg 768w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-1536x864.jpg 1536w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology-500x281.jpg 500w, https://dedlim.dreamhosters.com/wp-content/uploads/2024/09/Audit-Methodology.jpg 1920w","height":1080,"width":1920},"databaseId":1647,"date":"2024-09-04T09:52:02","isSticky":false,"postId":1647,"slug":"web3-audit-methodology","title":"Web 3 Audit Methodology by Dedaub","categoryIds":[20]}]},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"uniswap-reentrancy"},"buildId":"7pEoSVJ1Fu0ErvDXetltn","isFallback":false,"isExperimentalCompile":false,"gsp":true,"scriptLoader":[]}</script></body></html>