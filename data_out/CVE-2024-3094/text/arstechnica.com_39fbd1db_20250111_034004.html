

[Skip to content](#main)

[Ars Technica home](https://arstechnica.com/)

Sections

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

* [Feature](/features/)
* [Reviews](/reviews/)
* [Store](/store/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Pin to story

Theme

* HyperLight
* Day & Night
* Dark
* System

Search dialog...

Sign In

Sign in dialog...

Sign in

SUPPLY CHAIN ATTACK

# Backdoor found in widely used Linux utility targets encrypted SSH connections

Malicious code planted in xz Utils has been circulating for more than a month.

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
–
Mar 29, 2024 2:50 pm

| [237](https://arstechnica.com/security/2024/03/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections/#comments "237 comments")

[![](https://cdn.arstechnica.net/wp-content/uploads/2024/03/backdoor-1.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2024/03/backdoor-1.jpg)

Internet Backdoor in a string of binary code in a shape of an eye.
Credit:
Getty Images

Internet Backdoor in a string of binary code in a shape of an eye.
Credit:
Getty Images

Text
settings

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Minimize to nav

Researchers have found a malicious backdoor in a compression tool that made its way into widely used Linux distributions, including those from Red Hat and Debian.

The compression utility, known as [xz Utils](https://github.com/tukaani-project/xz), introduced the malicious code in versions ​​5.6.0 and 5.6.1, [according to](https://www.openwall.com/lists/oss-security/2024/03/29/4) Andres Freund, the developer who discovered it. There are no known reports of those versions being incorporated into any production releases for major Linux distributions, but both [Red Hat](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users) and [Debian](https://lists.debian.org/debian-security-announce/2024/msg00057.html) reported that recently published beta releases used at least one of the backdoored versions—specifically, in Fedora Rawhide and Debian testing, unstable and experimental distributions. A stable release of Arch Linux is also affected. That distribution, however, isn't used in production systems.

Because the backdoor was discovered before the malicious versions of xz Utils were added to production versions of Linux, “it's not really affecting anyone in the real world,” Will Dormann, a senior vulnerability analyst at security firm Analygence, said in an online interview. “BUT that's only because it was discovered early due to bad actor sloppiness. Had it not been discovered, it would have been catastrophic to the world.”

Several people, including two Ars readers, reported that the multiple apps included in the HomeBrew package manager for macOS rely on the backdoored 5.6.1 version of xz Utils. HomeBrew has now rolled back the utility to version 5.4.6. Maintainers have more details available [here](https://github.com/orgs/Homebrew/discussions/5243#discussioncomment-8954951).

## Targeting sshd

The first signs of the backdoor were introduced in a February 23 update that added obfuscated code, officials from Red Hat said in an email. An update the following day included a malicious install script that injected itself into functions used by sshd, the binary file that makes SSH work. The malicious code has resided only in the archived releases—known as tarballs—which are released upstream. So-called GIT code available in repositories aren’t affected, although they do contain second-stage artifacts allowing the injection during the build time. In the event the obfuscated code introduced on February 23 is present, the artifacts in the GIT version allow the backdoor to operate.

The malicious changes were submitted by JiaT75, one of the two main xz Utils developers with years of contributions to the project.

“Given the activity over several weeks, the committer is either directly involved or there was some quite severe compromise of their system,” Freund wrote. “Unfortunately the latter looks like the less likely explanation, given they communicated on various lists about the ‘fixes’” provided in recent updates. Those updates and fixes can be found [here](https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad), [here](https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f), [here](https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92), and [here](https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89).

On Thursday, someone using the developer's name took to a developer site for Ubuntu to ask that the backdoored version 5.6.1 be [incorporated into production versions](https://bugs.launchpad.net/ubuntu/%2Bsource/xz-utils/%2Bbug/2059417) because it fixed bugs that caused a tool known as Valgrind to malfunction.

“This could break build scripts and test pipelines that expect specific output from Valgrind in order to pass,” the person warned, from an account that was created the same day.

One of maintainers for Fedora [said Friday](https://news.ycombinator.com/item?id=39866275) that the same developer approached them in recent weeks to ask that Fedora 40, a beta release, incorporate one of the backdoored utility versions.

“We even worked with him to fix the valgrind issue (which it turns out now was caused by the backdoor he had added),” the Ubuntu maintainer said. "He has been part of the xz project for two years, adding all sorts of binary test files, and with this level of sophistication, we would be suspicious of even older versions of xz until proven otherwise."

Maintainers for xz Utils didn’t immediately respond to emails asking questions.

The malicious versions, researchers said, intentionally interfere with authentication performed by SSH, a commonly used protocol for connecting remotely to systems. SSH provides robust encryption to ensure that only authorized parties connect to a remote system. The backdoor is designed to allow a malicious actor to break the authentication and, from there, gain unauthorized access to the entire system. The backdoor works by injecting code during a key phase of the login process.

“I have not yet analyzed precisely what is being checked for in the injected code, to allow unauthorized access,” Freund wrote. “Since this is running in a pre-authentication context, it seems likely to allow some form of access or other form of remote code execution.”

[**Update:** Researchers who spent the weekend reverse engineering the updates say that the backdoor injected malicious code during SSH operations, rather than bypassed authenticatiion.]

In some cases, the backdoor has been unable to work as intended. The build environment on Fedora 40, for example, contains incompatibilities that prevent the injection from correctly occurring. Fedora 40 has now reverted to the 5.4.x versions of xz Utils.

Xz Utils is available for most if not all Linux distributions, but not all of them include it by default. Anyone using Linux should check with their distributor immediately to determine if their system is affected. Freund provided a script for detecting if an SSH system is vulnerable.

Listing image:
Getty Images

[![Photo of Dan Goodin](/wp-content/uploads/2018/10/Dang.jpg)](https://arstechnica.com/author/dan-goodin/)
[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

Dan Goodin is Senior Security Editor at Ars Technica, where he oversees coverage of malware, computer espionage, botnets, hardware hacking, encryption, and passwords. In his spare time, he enjoys gardening, cooking, and following the independent music scene. Dan is based in San Francisco. Follow him at [here](https://infosec.exchange/%40dangoodin) on Mastodon and [here](https://bsky.app/profile/dangoodin.bsky.social) on Bluesky. Contact him on Signal at DanArs.82.

[237 Comments](https://arstechnica.com/security/2024/03/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections/#comments "237 comments")

Staff Picks

![adamsc](https://cdn.arstechnica.net/civis/data/avatars/m/15/15625.jpg?1668050701)
[adamsc](https://arstechnica.com/civis/members/adamsc.15625/)

> Oh, so having one init to rule them all and take over every function of your system was a great idea right?

Please take the systemd trolling back to Reddit. The only connection here is that they call sd\_notify to report when the process is healthy so the systemd status is accurate and can be used to trigger other things:

[March 29, 2024 at 8:25 pm](https://arstechnica.com/civis/posts/42712026/)

![adamsc](https://cdn.arstechnica.net/civis/data/avatars/m/15/15625.jpg?1668050701)
[adamsc](https://arstechnica.com/civis/members/adamsc.15625/)

> While this is particularly pernicious in open source since anybody can see the code, who contributed, etc., I don't believe it would be difficult to do this with corporate code.
>
>
>
> With a little social engineering you could figure out who works on what bits of Windows and/or OSX.
>
>
>
> With the right convincing said developer could sneak code into those projects. Particularly if they're messing with macros, changing flags to valgrind or its equivalent, etc.

Yeah, my point wasn't that closed source is better but simply that open source projects are exposed because there are many projects which are widely used, accept contributions from anyone on the internet, but have only a handful of maintainers. Microsoft doesn't accept pull requests for Windows on GitHub but if they did, they'd also have the budget to hire people whose full-time job would be to review things.

As a long-time open source contributor, this trend has been fairly sad because so much of the internet used to run on a community trust model that frankly isn't sustainable. Most of the ways we could combat this are going to directly impact one of the things I used to like the most: people are going to rely more on reputation, which means someone with a contribution from, say, @google.com is going to get their stuff merged faster than someone at [@Gmail.com](https://arstechnica.com/civis/members/870841/), which I don't like even if I completely understand why that will happen.

[March 29, 2024 at 8:31 pm](https://arstechnica.com/civis/posts/42712045/)

G
[GolbatsEverywhere](https://arstechnica.com/civis/members/golbatseverywhere.755805/)

This might have been the worst Linux backdoor in history except that it was caught so soon. An SSH authentication backdoor is surely worse than the Debian weak keys incident and also worse than Heartbleed, the two most notorious Linux security incidents that I can think of. Probably this would have been abused to hack most if not all of the Fortune 500, except Mr. Freund decided to investigate some small performance issue that anybody else would have dismissed as unimportant. We are spared only due to sheer dumb luck. This guy has probably just averted *at least* billions of dollars worth of damages. Cannot emphasize enough how grateful we should be to him right now.

But who knows how many other Linux packages are backdoored by other malicious upstream software developers. If it can be done to one project, it can be done to others just the same.

P.S. Address sanitizer really does need to be disabled when working with ifuncs, <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=110442>. Maybe valgrind has a similar bug? (Not sure; that's pure speculation.) That could explain why the other developers were not more suspicious of the malicious commits that hid the problems.

[March 29, 2024 at 11:25 pm](https://arstechnica.com/civis/posts/42712447/)

Comments

[Forum view](https://arstechnica.com/civis/threads/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections.1499791/)

![Loading](https://arstechnica.com/wp-content/themes/ars-v9/public/images/firework-loader.75ab30.gif)
Loading comments...

[Prev story](https://arstechnica.com/tech-policy/2024/03/jails-banned-family-visits-to-make-more-money-on-video-calls-lawsuits-claim/ "Go to: Jails banned visits in “quid pro quo” with prison phone companies, lawsuits say")

[Next story](https://arstechnica.com/ai/2024/03/nycs-government-chatbot-is-lying-about-city-laws-and-regulations/ "Go to: NYC’s government chatbot is lying about city laws and regulations")

Most Read

1. [![Listing image for first story in Most Read: Judge ends man’s 11-year quest to dig up landfill and recover $765M in bitcoin](https://cdn.arstechnica.net/wp-content/uploads/2025/01/newport-landfill-768x432-1736530527.jpg)](https://arstechnica.com/tech-policy/2025/01/judge-ends-mans-11-year-quest-to-dig-up-landfill-and-recover-765m-in-bitcoin/)

   1.
   [Judge ends man’s 11-year quest to dig up landfill and recover $765M in bitcoin](https://arstechnica.com/tech-policy/2025/01/judge-ends-mans-11-year-quest-to-dig-up-landfill-and-recover-765m-in-bitcoin/)
2. 2.
   [A glowing ring of metal fell to Earth, and no one has any idea what it is](https://arstechnica.com/space/2025/01/a-glowing-ring-of-metal-fell-to-earth-and-no-one-has-any-idea-what-it-is/)
3. 3.
   [A taller, heavier, smarter version of SpaceX’s Starship is almost ready to fly](https://arstechnica.com/space/2025/01/a-taller-heavier-smarter-version-of-spacexs-starship-is-almost-ready-to-fly/)
4. 4.
   [Why I’m disappointed with the TVs at CES 2025](https://arstechnica.com/gadgets/2025/01/ces-2025-teases-alarming-smart-tv-future-loaded-with-unwanted-software-gimmicks/)
5. 5.
   [US selling 69K seized bitcoins could mess with Trump plans for crypto reserve](https://arstechnica.com/tech-policy/2025/01/us-selling-69k-seized-bitcoins-could-mess-with-trump-plans-for-crypto-reserve/)

Customize

Ars Technica has been separating the signal from
the noise for over 25 years. With our unique combination of
technical savvy and wide-ranging interest in the technological arts
and sciences, Ars is the trusted source in a sea of information. After
all, you don’t need to know everything, only what’s important.

More
from Ars

* [About Us](https://arstechnica.com/about-us/)
* [Staff Directory](https://arstechnica.com/staff-directory/)
* [Newsletters](https://arstechnica.com/newsletters/)
* [Ars Videos](https://arstechnica.com/video/)
* [General FAQ](https://arstechnica.com/general-faq/)
* [RSS Feeds](https://arstechnica.com/rss-feeds/)

Contact

* [Contact us](https://arstechnica.com/contact-us/)
* [Advertise with us](https://www.condenast.com/brands/ars-technica)
* [Reprints](https://arstechnica.com/reprints/)

Do Not Sell My Personal
Information

© 2025 Condé Nast. All rights reserved. Use of and/or
registration on any portion of this site constitutes acceptance of our [User Agreement](https://www.condenast.com/user-agreement/) and
[Privacy Policy and
Cookie Statement](https://www.condenast.com/privacy-policy/) and [Ars
Technica Addendum](/amendment-to-conde-nast-user-agreement-privacy-policy/) and [Your
California Privacy Rights](https://www.condenast.com/privacy-policy/#california). Ars Technica may earn compensation on
sales from links on this site. [Read our
affiliate link policy](/affiliate-link-policy/). The material on this site may not be
reproduced, distributed, transmitted, cached or otherwise used, except
with the prior written permission of Condé Nast. [Ad
Choices](https://www.aboutads.info/)

