=== Content from securitylab.github.com_df4162ef_20250110_134517.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

June 29, 2023
# GHSL-2023-139: Use After Free (UAF) in accountsservice - CVE-2023-3297

[![Author avatar](https://avatars.githubusercontent.com/u/4358136)
Kevin Backhouse](https://github.com/kevinbackhouse)

## Coordinated Disclosure Timeline

* 2023-06-16: reported to Ubuntu: https://bugs.launchpad.net/ubuntu/+source/accountsservice/+bug/2024182
* 2023-06-16: [reply received](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/1)
* 2023-06-16: CVE-2023-3297 [assigned](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/2)
* 2023-06-16: [fix proposed](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/3)
* 2023-06-28: [CVE-2023-3297 disclosed](https://ubuntu.com/security/CVE-2023-3297)

## Summary

An unprivileged local attacker can trigger a use-after-free vulnerability in accountsservice by sending a D-Bus message to the accounts-daemon process.

## Product

accountsservice

## Tested Version

[22.08.8-1ubuntu7](https://launchpad.net/ubuntu/%2Bsource/accountsservice/22.08.8-1ubuntu7)

The bug is easier to observe on Ubuntu 23.04 than on Ubuntu 22.04 LTS, but it is present on both.

## Details

### Use-after-free when `throw_error` is called (`GHSL-2023-139`)

After receiving a D-Bus [method call](https://dbus.freedesktop.org/doc/dbus-specification.html#message-protocol-types), a D-Bus server is expected to send either a `METHOD_RETURN` or a `ERROR` message back to the client, *but not both*. This is done incorrectly in several places in accountsservice. For example, in [`user_change_language_authorized_cb`](https://git.launchpad.net/ubuntu/%2Bsource/accountsservice/tree/debian/patches/0010-set-language.patch?h=import/22.08.8-1ubuntu7#n427):

```
static void
user_change_language_authorized_cb (Daemon                *daemon,
                                    User                  *user,
                                    GDBusMethodInvocation *context,
                                    gpointer               data)

{
        const gchar *language = data;

        if (!user_HOME_available (user)) {

                /* SetLanguage was probably called from a login greeter,
                   and HOME not mounted and/or not decrypted.
                   Hence don't save anything, or else accountsservice
                   and ~/.pam_environment would become out of sync. */
                throw_error (context, ERROR_FAILED, "not access to HOME yet so language not saved");  <===== 1
                goto out;
        }

        <snip>

out:
        accounts_user_complete_set_language (ACCOUNTS_USER (user), context);  <===== 2
}

```

If `user_HOME_available` returns an error, then `throw_error` is called at 1 to send an `ERROR` message, but a regular `METHOD_RETURN` is also sent at 2. This is incorrect D-Bus protocol, but the more serious problem is that it causes a use-after-free because both `throw_error` and `accounts_user_complete_set_language` decrease the reference count on `context`. In other words, `context` is freed by `throw_error` and a UAF occurs in `accounts_user_complete_set_language`.

An attacker can trigger the bug above by causing `user_HOME_available` to fail, which they can do by deleting all the files from their home directory. But there are other incorrect uses of `throw_error` in `user.c` which are less inconvenient to trigger. For example, this command triggers a call to `throw_error` in `user_update_environment` due to the invalid characters in the string:

```
dbus-send --system --print-reply --dest=org.freedesktop.Accounts /org/freedesktop/Accounts/User`id -u` org.freedesktop.Accounts.User.SetLanguage string:'**'

```

On Ubuntu 23.04, the above command causes `accounts-daemon` to crash with a `SIGSEGV`. But on Ubuntu 22.04 LTS it doesn’t cause any visible harm. The difference is due to a recent [change in GLib’s](https://gitlab.gnome.org/GNOME/glib/-/commit/69e9ba80e2f4d2061a1a68d72bae1c32c1e4f8fa) memory allocation: older versions of GLib used the “slice” allocator, but newer version uses the system allocator. The system allocator trashes the memory when it’s freed in a way that causes the use-after-free to trigger a SIGSEGV, whereas the “slice” allocator trashes the memory in a way that causes the UAF to go unnoticed.

#### Impact

Exploitation is likely to be difficult, but this bug could potentially enable a local unprivileged attacker to gain root privileges.

## CVE

* CVE-2023-3297

## Credit

This issue was discovered and reported by GHSL team member [@kevinbackhouse (Kevin Backhouse)](https://github.com/kevinbackhouse).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2023-139` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from bugs.launchpad.net_f72283ff_20250110_134517.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[accountsservice package](https://launchpad.net/ubuntu/%2Bsource/accountsservice)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/accountsservice)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/accountsservice)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/accountsservice)

# GHSL-2023-139: use-after-free in user.c

Bug #2024182 reported by
[kev](https://launchpad.net/~kbackhouse2000)
on 2023-06-16

[262](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [accountsservice (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice "Latest release: 23.13.9-7ubuntu1, uploaded to main on 2024-11-13 10:40:11.335841+00:00 by Alessandro Astone (aleasto), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Medium | [Marc Deslauriers](https://launchpad.net/~mdeslaur) |  |
|  | [Focal](https://bugs.launchpad.net/ubuntu/focal/%2Bsource/accountsservice) | Fix Released | Medium | [Marc Deslauriers](https://launchpad.net/~mdeslaur) |  |
|  | [Jammy](https://bugs.launchpad.net/ubuntu/jammy/%2Bsource/accountsservice) | Fix Released | Medium | [Marc Deslauriers](https://launchpad.net/~mdeslaur) |  |
|  | [Kinetic](https://bugs.launchpad.net/ubuntu/kinetic/%2Bsource/accountsservice) | Fix Released | Medium | [Marc Deslauriers](https://launchpad.net/~mdeslaur) |  |
|  | [Lunar](https://bugs.launchpad.net/ubuntu/lunar/%2Bsource/accountsservice) | Fix Released | Medium | [Marc Deslauriers](https://launchpad.net/~mdeslaur) |  |
|  | [Mantic](https://bugs.launchpad.net/ubuntu/mantic/%2Bsource/accountsservice) | Fix Released | Medium | [Marc Deslauriers](https://launchpad.net/~mdeslaur) |  |

### Bug Description

# GitHub Security Lab (GHSL) Vulnerability Report, accountsservice: `GHSL-2023-139`

The [GitHub Security Lab](<https://securitylab.github.com>) team has identified a potential security vulnerability in [accountsservice]([https://code.launchpad.net/ubuntu/+source/accountsservice](https://code.launchpad.net/ubuntu/%2Bsource/accountsservice)).

We are committed to working with you to help resolve this issue. In this report you will find everything you need to effectively coordinate a resolution of this issue with the GHSL team.

If at any point you have concerns or questions about this process, please do not hesitate to reach out to us at `<email address hidden>` (please include `GHSL-2023-139` as a reference).

If you are \_NOT\_ the correct point of contact for this report, please let us know!

## Summary

An unprivileged local attacker can trigger a use-after-free vulnerability in accountsservice by sending a D-Bus message to the accounts-daemon process.

## Product

accountsservice

## Tested Version

[22.08.8-1ubuntu7]([https://launchpad.net/ubuntu/+source/accountsservice/22.08.8-1ubuntu7](https://launchpad.net/ubuntu/%2Bsource/accountsservice/22.08.8-1ubuntu7))

The bug is easier to observe on Ubuntu 23.04 than on Ubuntu 22.04 LTS, but it is present on both.

## Details

### Use-after-free when `throw\_error` is called (`GHSL-2023-139`)

After receiving a D-Bus [method call](<https://dbus.freedesktop.org/doc/dbus-specification.html#message-protocol-types>), a D-Bus server is expected to send either a `METHOD\_RETURN` or a `ERROR` message back to the client, \_but not both\_. This is done incorrectly in several places in accountsservice. For example, in [`user\_change\_language\_authorized\_cb`]([https://git.launchpad.net/ubuntu/+source/accountsservice/tree/debian/patches/0010-set-language.patch?h=import/22.08.8-1ubuntu7#n427](https://git.launchpad.net/ubuntu/%2Bsource/accountsservice/tree/debian/patches/0010-set-language.patch?h=import/22.08.8-1ubuntu7#n427)):

```c

static void

user\_change\_language\_authorized\_cb (Daemon \*daemon,

                                    User \*user,

                                    GDBusMethodInvocation \*context,

                                    gpointer data)

{

        const gchar \*language = data;

if (!user\_HOME\_available (user)) {

/\* SetLanguage was probably called from a login greeter,

                   and HOME not mounted and/or not decrypted.

                   Hence don't save anything, or else accountsservice

                   and ~/.pam\_environment would become out of sync. \*/

                throw\_error (context, ERROR\_FAILED, "not access to HOME yet so language not saved"); <===== 1

                goto out;

        }

<snip>

out:

        accounts\_user\_complete\_set\_language (ACCOUNTS\_USER (user), context); <===== 2

}

```

If `user\_HOME\_available` returns an error, then `throw\_error` is called at 1 to send an `ERROR` message, but a regular `METHOD\_RETURN` is also sent at 2. This is incorrect D-Bus protocol, but the more serious problem is that it causes a use-after-free because both `throw\_error` and `accounts\_user\_complete\_set\_language` decrease the reference count on `context`. In other words, `context` is freed by `throw\_error` and a UAF occurs in `accounts\_user\_complete\_set\_language`.

An attacker can trigger the bug above by causing `user\_HOME\_available` to fail, which they can do by deleting all the files from their home directory. But there are other incorrect uses of `throw\_error` in `user.c` which are less inconvenient to trigger. For example, this command triggers a call to `throw\_error` in `user\_update\_environment` due to the invalid characters in the string.

```bash

dbus-send --system --print-reply --dest=org.freedesktop.Accounts /org/freedesktop/Accounts/User`id -u` org.freedesktop.Accounts.User.SetLanguage string:'\*\*'

```

On Ubuntu 23.04, the above command causes `accounts-daemon` to crash with a `SIGSEGV`. But on Ubuntu 22.04 LTS it doesn't cause any visible harm. The difference is due to a recent [change in GLib's](<https://gitlab.gnome.org/GNOME/glib/-/commit/69e9ba80e2f4d2061a1a68d72bae1c32c1e4f8fa>) memory allocation: older versions of GLib used the "slice" allocator, but newer version uses the system allocator. The system allocator trashes the memory when it's freed in a way that causes the use-after-free to trigger a SIGSEGV, whereas the "slice" allocator doesn't trash the memory so the UAF goes unnoticed.

#### Impact

Exploitation is likely to be difficult, but this bug could potentially enable a local unprivileged attacker to gain root privileges.

#### Remediation

Always return immediately after calling `throw\_error`. For example, it is done correctly in `user\_change\_background\_file\_authorized\_cb`:

```c

if (type != G\_FILE\_TYPE\_REGULAR) {

        g\_debug ("not a regular file\n");

        throw\_error (context, ERROR\_FAILED, "file '%s' is not a regular file", filename);

        return;

}

```

## GitHub Security Advisories

We recommend you create a private [GitHub Security Advisory](<https://help.github.com/en/github/managing-security-vulnerabilities/creating-a-security-advisory>) for this finding. This also allows you to invite the GHSL team to collaborate and further discuss this finding in private before it is [published](<https://help.github.com/en/github/managing-security-vulnerabilities/publishing-a-security-advisory>).

## Credit

This issue was discovered and reported by GHSL team member [@kevinbackhouse (Kevin Backhouse)](<https://github.com/kevinbackhouse>).

## Contact

You can contact the GHSL team at `<email address hidden>`, please include a reference to `GHSL-2023-139` in any communication regarding this issue.

## Disclosure Policy

This report is subject to our [coordinated disclosure policy](<https://securitylab.github.com/advisories#policy>).

Tags:

[patch](/ubuntu/%2Bsource/accountsservice/%2Bbugs?field.tag=patch)

## CVE References

* [2023-3297](/bugs/cve/2023-3297 "In Ubuntu's accountsservice an unpriv...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2023-06-16: |  |  | [#1](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/1) |
| --- | --- | --- | --- |

Hi Kevin,

Thanks for reporting this issue!

I see the multiple instances of the problematic code were added by the Ubuntu-specific 0010-set-language.patch patch.

We'll investigate this issue shortly and will get back to you with a proposed fix, a proposed CRD, and a CVE number.

Hi Kevin,
Thanks for reporting this issue!
I see the multiple instances of the problematic code were added by the Ubuntu-specific 0010-set-language.patch patch.
We'll investigate this issue shortly and will get back to you with a proposed fix, a proposed CRD, and a CVE number.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2023-06-16: |  |  | [#2](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/2) |
| --- | --- | --- | --- |

Please refer to this issue as CVE-2023-3297.

Thank you for your report!

Please refer to this issue as CVE-2023-3297.
Thank you for your report!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2023-06-16: |  |  | [#3](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/3) |
| --- | --- | --- | --- |

* [accountsservice\_22.08.8-1ubuntu8~test1.debdiff](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Battachment/5680297/%2Bfiles/accountsservice_22.08.8-1ubuntu8~test1.debdiff)
  [Edit](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Battachment/5680297)
  (5.6 KiB,
  text/plain)

Here is a proposed debdiff for mantic for review by the desktop team

Here is a proposed debdiff for mantic for review by the desktop team

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Ancell (robert-ancell)](https://launchpad.net/~robert-ancell) wrote on 2023-06-20: |  |  | [#4](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/4) |
| --- | --- | --- | --- |

I applied the debdiff and reviewed that changes to src/user.c - these look good, thanks!

I applied the debdiff and reviewed that changes to src/user.c - these look good, thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2023-06-20: |  |  | [#5](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/5) |
| --- | --- | --- | --- |

Thanks for the review Robert!

Thanks for the review Robert!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2023-06-20: |  |  | [#6](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/6) |
| --- | --- | --- | --- |

I propose a CRD of 2023-06-28 12:00:00 UTC. Unless anyone objects, I will be publishing updates for this issue at that time.

Thanks!

I propose a CRD of 2023-06-28 12:00:00 UTC. Unless anyone objects, I will be publishing updates for this issue at that time.
Thanks!

| Changed in accountsservice (Ubuntu Focal): | |
| --- | --- |
| **assignee**: | nobody → Marc Deslauriers (mdeslaur) |
| Changed in accountsservice (Ubuntu Jammy): | |
| **assignee**: | nobody → Marc Deslauriers (mdeslaur) |
| Changed in accountsservice (Ubuntu Kinetic): | |
| **assignee**: | nobody → Marc Deslauriers (mdeslaur) |
| Changed in accountsservice (Ubuntu Lunar): | |
| **assignee**: | nobody → Marc Deslauriers (mdeslaur) |
| Changed in accountsservice (Ubuntu Mantic): | |
| **assignee**: | nobody → Marc Deslauriers (mdeslaur) |
| Changed in accountsservice (Ubuntu Focal): | |
| **status**: | New → In Progress |
| Changed in accountsservice (Ubuntu Jammy): | |
| **status**: | New → In Progress |
| Changed in accountsservice (Ubuntu Kinetic): | |
| **status**: | New → In Progress |
| Changed in accountsservice (Ubuntu Lunar): | |
| **status**: | New → In Progress |
| Changed in accountsservice (Ubuntu Mantic): | |
| **status**: | New → In Progress |
| Changed in accountsservice (Ubuntu Focal): | |
| **importance**: | Undecided → Medium |
| Changed in accountsservice (Ubuntu Jammy): | |
| **importance**: | Undecided → Medium |
| Changed in accountsservice (Ubuntu Kinetic): | |
| **importance**: | Undecided → Medium |
| Changed in accountsservice (Ubuntu Lunar): | |
| **importance**: | Undecided → Medium |
| Changed in accountsservice (Ubuntu Mantic): | |
| **importance**: | Undecided → Medium |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2023-06-28: |  |  | [#7](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/7) |
| --- | --- | --- | --- |

This bug was fixed in the package accountsservice - 22.08.8-1ubuntu7.1

---------------

accountsservice (22.08.8-1ubuntu7.1) lunar-security; urgency=medium

\* SECURITY UPDATE: use-after-free in user.c (LP: [#2024182](/bugs/2024182))

    - debian/patches/0010-set-language.patch: updated to properly return

      from functions after throw\_error() has been called.

    - CVE-2023-3297

-- Marc Deslauriers <email address hidden> Tue, 20 Jun 2023 07:23:47 -0400

This bug was fixed in the package accountsservice - 22.08.8-1ubuntu7.1
---------------
accountsservice (22.08.8-1ubuntu7.1) lunar-security; urgency=medium
\* SECURITY UPDATE: use-after-free in user.c (LP: #2024182)
- debian/patches/0010-set-language.patch: updated to properly return
from functions after throw\_error() has been called.
- CVE-2023-3297
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Tue, 20 Jun 2023 07:23:47 -0400

| Changed in accountsservice (Ubuntu Lunar): | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2023-06-28: |  |  | [#8](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/8) |
| --- | --- | --- | --- |

This bug was fixed in the package accountsservice - 22.07.5-2ubuntu1.4

---------------

accountsservice (22.07.5-2ubuntu1.4) jammy-security; urgency=medium

\* SECURITY UPDATE: use-after-free in user.c (LP: [#2024182](/bugs/2024182))

    - debian/patches/0010-set-language.patch: updated to properly return

      from functions after throw\_error() has been called.

    - CVE-2023-3297

-- Marc Deslauriers <email address hidden> Tue, 20 Jun 2023 07:25:34 -0400

This bug was fixed in the package accountsservice - 22.07.5-2ubuntu1.4
---------------
accountsservice (22.07.5-2ubuntu1.4) jammy-security; urgency=medium
\* SECURITY UPDATE: use-after-free in user.c (LP: #2024182)
- debian/patches/0010-set-language.patch: updated to properly return
from functions after throw\_error() has been called.
- CVE-2023-3297
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Tue, 20 Jun 2023 07:25:34 -0400

| Changed in accountsservice (Ubuntu Jammy): | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2023-06-28: |  |  | [#9](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/9) |
| --- | --- | --- | --- |

This bug was fixed in the package accountsservice - 0.6.55-0ubuntu12~20.04.6

---------------

accountsservice (0.6.55-0ubuntu12~20.04.6) focal-security; urgency=medium

\* SECURITY UPDATE: use-after-free in user.c (LP: [#2024182](/bugs/2024182))

    - debian/patches/0010-set-language.patch: updated to properly return

      from functions after throw\_error() has been called.

    - CVE-2023-3297

-- Marc Deslauriers <email address hidden> Tue, 20 Jun 2023 07:26:26 -0400

This bug was fixed in the package accountsservice - 0.6.55-0ubuntu12~20.04.6
---------------
accountsservice (0.6.55-0ubuntu12~20.04.6) focal-security; urgency=medium
\* SECURITY UPDATE: use-after-free in user.c (LP: #2024182)
- debian/patches/0010-set-language.patch: updated to properly return
from functions after throw\_error() has been called.
- CVE-2023-3297
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Tue, 20 Jun 2023 07:26:26 -0400

| Changed in accountsservice (Ubuntu Focal): | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2023-06-28: |  |  | [#10](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/10) |
| --- | --- | --- | --- |

This bug was fixed in the package accountsservice - 22.08.8-1ubuntu1.1

---------------

accountsservice (22.08.8-1ubuntu1.1) kinetic-security; urgency=medium

\* SECURITY UPDATE: use-after-free in user.c (LP: [#2024182](/bugs/2024182))

    - debian/patches/0010-set-language.patch: updated to properly return

      from functions after throw\_error() has been called.

    - CVE-2023-3297

-- Marc Deslauriers <email address hidden> Tue, 20 Jun 2023 07:24:53 -0400

This bug was fixed in the package accountsservice - 22.08.8-1ubuntu1.1
---------------
accountsservice (22.08.8-1ubuntu1.1) kinetic-security; urgency=medium
\* SECURITY UPDATE: use-after-free in user.c (LP: #2024182)
- debian/patches/0010-set-language.patch: updated to properly return
from functions after throw\_error() has been called.
- CVE-2023-3297
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Tue, 20 Jun 2023 07:24:53 -0400

| Changed in accountsservice (Ubuntu Kinetic): | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2023-06-28

| **information type**: | Private Security → Public Security |
| --- | --- |

[Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton)
on 2023-06-28

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2023-06-29: |  |  | [#11](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/comments/11) |
| --- | --- | --- | --- |

This bug was fixed in the package accountsservice - 23.13.9-2ubuntu2

---------------

accountsservice (23.13.9-2ubuntu2) mantic; urgency=medium

\* SECURITY UPDATE: use-after-free in user.c (LP: [#2024182](/bugs/2024182))

    - debian/patches/0010-set-language.patch: updated to properly return

      from functions after throw\_error() has been called.

    - CVE-2023-3297

-- Marc Deslauriers <email address hidden> Wed, 28 Jun 2023 11:10:09 -0400

This bug was fixed in the package accountsservice - 23.13.9-2ubuntu2
---------------
accountsservice (23.13.9-2ubuntu2) mantic; urgency=medium
\* SECURITY UPDATE: use-after-free in user.c (LP: #2024182)
- debian/patches/0010-set-language.patch: updated to properly return
from functions after throw\_error() has been called.
- CVE-2023-3297
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Wed, 28 Jun 2023 11:10:09 -0400

| Changed in accountsservice (Ubuntu Mantic): | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/accountsservice/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [accountsservice\_22.08.8-1ubuntu8~test1.debdiff](https://bugs.launchpad.net/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Battachment/5680297/%2Bfiles/accountsservice_22.08.8-1ubuntu8~test1.debdiff)
  [Edit](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Battachment/5680297 "Change patch details")

* [Add patch](/ubuntu/%2Bsource/accountsservice/%2Bbug/2024182/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from ubuntu.com_a43178ea_20250110_134517.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-6190-1: AccountsService vulnerability

28 June 2023

AccountsService could be made to crash or run programs if it received
specially crafted messages.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 23.04](/security/notices?release=lunar)
* [Ubuntu 22.10](/security/notices?release=kinetic)
* [Ubuntu 22.04 LTS](/security/notices?release=jammy)
* [Ubuntu 20.04 LTS](/security/notices?release=focal)

## Packages

* [accountsservice](/security/cves?package=accountsservice) - query and manipulate user account information

## Details

Kevin Backhouse discovered that AccountsService incorrectly handled certain

D-Bus messages. A local attacker could use this issue to cause

AccountsService to crash, resulting in a denial of service, or possibly

execute arbitrary code.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 23.04

* [accountsservice](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
  -
  [22.08.8-1ubuntu7.1](https://launchpad.net/ubuntu/%2Bsource/accountsservice/22.08.8-1ubuntu7.1)
* [libaccountsservice0](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
  -
  [22.08.8-1ubuntu7.1](https://launchpad.net/ubuntu/%2Bsource/accountsservice/22.08.8-1ubuntu7.1)

##### Ubuntu 22.10

* [accountsservice](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
  -
  [22.08.8-1ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/accountsservice/22.08.8-1ubuntu1.1)
* [libaccountsservice0](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
  -
  [22.08.8-1ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/accountsservice/22.08.8-1ubuntu1.1)

##### Ubuntu 22.04

* [accountsservice](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
  -
  [22.07.5-2ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/accountsservice/22.07.5-2ubuntu1.4)
* [libaccountsservice0](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
  -
  [22.07.5-2ubuntu1.4](https://launchpad.net/ubuntu/%2Bsource/accountsservice/22.07.5-2ubuntu1.4)

##### Ubuntu 20.04

* [accountsservice](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
  -
  [0.6.55-0ubuntu12~20.04.6](https://launchpad.net/ubuntu/%2Bsource/accountsservice/0.6.55-0ubuntu12~20.04.6)
* [libaccountsservice0](https://launchpad.net/ubuntu/%2Bsource/accountsservice)
  -
  [0.6.55-0ubuntu12~20.04.6](https://launchpad.net/ubuntu/%2Bsource/accountsservice/0.6.55-0ubuntu12~20.04.6)

After a standard system update you need to reboot your computer to make all

the necessary changes.

## References

* [CVE-2023-3297](/security/CVE-2023-3297)

## Related notices

* [USN-6190-2](/security/notices/USN-6190-2)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


