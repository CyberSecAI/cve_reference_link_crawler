

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3032596%2540booking%26old%3D3032596%2540booking)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3021787/booking "Changeset 3021787 for booking")
* [Next Change](/changeset/3032598/booking "Changeset 3032598 for booking") →

---

# Changeset [3032596](/changeset/3032596 "Show full changeset") for [booking](/browser/booking?rev=3032596 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/07/2024 08:44:43 AM
([11 months](/timeline?from=2024-02-07T08%3A44%3A43Z&precision=second "See timeline at 02/07/2024 08:44:43 AM") ago)

Author:
wpdevelop
Message:

Update 9.9.1

Location:
[booking/trunk](/browser/booking/trunk?rev=3032596)
Files:

7 edited

* [core/any/class-admin-page-structure.php](/browser/booking/trunk/core/any/class-admin-page-structure.php?rev=3032596 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [css/admin-skin-modern\_1.css](/browser/booking/trunk/css/admin-skin-modern_1.css?rev=3032596 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [includes/\_capacity/capacity.php](/browser/booking/trunk/includes/_capacity/capacity.php?rev=3032596 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [includes/\_capacity/create\_booking.php](/browser/booking/trunk/includes/_capacity/create_booking.php?rev=3032596 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [includes/\_request/wpbc\_request.php](/browser/booking/trunk/includes/_request/wpbc_request.php?rev=3032596 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [readme.txt](/browser/booking/trunk/readme.txt?rev=3032596 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [wpdev-booking.php](/browser/booking/trunk/wpdev-booking.php?rev=3032596 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [booking/trunk/core/any/class-admin-page-structure.php](/changeset/3032596/booking/trunk/core/any/class-admin-page-structure.php "Show the changeset 3032596 restricted to booking/trunk/core/any/class-admin-page-structure.php")

  | [r3021784](/browser/booking/trunk/core/any/class-admin-page-structure.php?rev=3021784#L204 "Show revision 3021784 of this file in browser") | [r3032596](/browser/booking/trunk/core/any/class-admin-page-structure.php?rev=3032596#L204 "Show revision 3032596 of this file in browser") |  |
  | --- | --- | --- |
  | 204 | 204 | ><?php |
  | 205 | 205 | ?><h1 class="wpbc\_header wpdvlp-top-tabs"><?php |
  | 206 |  | ?><div class="wpbc\_header\_menu\_tabs"><?php |
  | 207 |  | $this->show\_tabs\_line( $page\_tag );                     // T O P    T A B S    in  Header |
  | 208 |  | ?></div><?php |
  | 209 |  | ~~make\_bk\_action( 'wpbc\_h1\_header\_content\_end', $page\_tag, $active\_page\_tab, $active\_page\_subtab );~~//FixIn: 9.9.0.10 |
  |  | 206 | ?><div class="wpbc\_header\_menu\_tabs"><?php |
  |  | 207 | $this->show\_tabs\_line( $page\_tag );                     // T O P    T A B S    in  Header |
  |  | 208 | ?></div><?php |
  |  | 209 | make\_bk\_action( 'wpbc\_h1\_header\_content\_end', $page\_tag, $active\_page\_tab, $active\_page\_subtab );   //FixIn: 9.9.0.10 |
  | 210 | 210 | ?></h1><?php |
  | 211 | 211 | ?></div><?php |
* ## [booking/trunk/css/admin-skin-modern\_1.css](/changeset/3032596/booking/trunk/css/admin-skin-modern_1.css "Show the changeset 3032596 restricted to booking/trunk/css/admin-skin-modern_1.css")

  | [r3021784](/browser/booking/trunk/css/admin-skin-modern_1.css?rev=3021784#L382 "Show revision 3021784 of this file in browser") | [r3032596](/browser/booking/trunk/css/admin-skin-modern_1.css?rev=3032596#L382 "Show revision 3032596 of this file in browser") |  |
  | --- | --- | --- |
  | 382 | 382 | \* |
  | 383 | 383 | \*/ |
  | 384 |  | ~~/\* TOP Message shift in version 9.9 //FixIn: 9.9.0.10 \*/~~ |
  | 385 | 384 | .wpbc\_header\_menu\_tabs{ |
  | 386 | 385 | flex:1; |
  | […](/browser/booking/trunk/css/admin-skin-modern_1.css?rev=3021784#L391) | […](/browser/booking/trunk/css/admin-skin-modern_1.css?rev=3032596#L390) |  |
  | 391 | 390 | height: auto; |
  | 392 | 391 | } |
  |  | 392 | /\* TOP Message shift in version 9.9 //FixIn: 9.9.0.10 \*/ |
  | 393 | 393 | .wpbc\_header .wpbc\_message\_wrapper { |
  | 394 | 394 | margin-top:10px; |
* ## [booking/trunk/includes/\_capacity/capacity.php](/changeset/3032596/booking/trunk/includes/_capacity/capacity.php "Show the changeset 3032596 restricted to booking/trunk/includes/_capacity/capacity.php")

  | [r3021784](/browser/booking/trunk/includes/_capacity/capacity.php?rev=3021784#L576 "Show revision 3021784 of this file in browser") | [r3032596](/browser/booking/trunk/includes/_capacity/capacity.php?rev=3032596#L576 "Show revision 3032596 of this file in browser") |  |
  | --- | --- | --- |
  | 576 | 576 |  |
  | 577 | 577 | //FixIn: 9.8.15.10  Aggregate or not Aggregate Booking > Availability ?     aggregate\_type = 'all' | 'bookings\_only' |
  | 578 |  | if ( ~~'bookings\_only' === $params['aggregate\_type'] ) {~~ |
  |  | 578 | if ( ( ! empty( $params['aggregate\_type'] ) ) && ( 'bookings\_only' === $params['aggregate\_type'] ) ) {              //FixIn: 9.9.0.16 |
  | 579 | 579 | $unavailable\_dates\_\_per\_resources\_\_arr = wpbc\_for\_resources\_arr\_\_get\_unavailable\_dates( |
  | 580 | 580 | $resource\_id\_\_with\_children\_\_arr,                       // Only One Primary Resource !! |
* ## [booking/trunk/includes/\_capacity/create\_booking.php](/changeset/3032596/booking/trunk/includes/_capacity/create_booking.php "Show the changeset 3032596 restricted to booking/trunk/includes/_capacity/create_booking.php")

  | [r3021784](/browser/booking/trunk/includes/_capacity/create_booking.php?rev=3021784#L44 "Show revision 3021784 of this file in browser") | [r3032596](/browser/booking/trunk/includes/_capacity/create_booking.php?rev=3032596#L44 "Show revision 3032596 of this file in browser") |  |
  | --- | --- | --- |
  | 44 | 44 | 'aggregate\_resource\_id\_arr' => array( 'validate' => 'digit\_or\_csd', 'default' => '' ), |
  | 45 | 45 |  |
  | 46 |  | 'dates\_ddmmyy\_csv' => array( 'validate' => '~~strong', 'default' => '' ),~~ |
  |  | 46 | 'dates\_ddmmyy\_csv' => array( 'validate' => 'csv\_dates', 'default' => '' ),     //FixIn: 9.9.1.1 |
  | 47 | 47 | 'formdata'         => array( 'validate' => 'strong', 'default' => '' ), |
  | 48 | 48 | 'booking\_hash'     => array( 'validate' => 'strong', 'default' => '' ), |
  | […](/browser/booking/trunk/includes/_capacity/create_booking.php?rev=3021784#L229) | […](/browser/booking/trunk/includes/_capacity/create_booking.php?rev=3032596#L229) |  |
  | 229 | 229 | $validate\_arr\_rules = array( |
  | 230 | 230 | 'resource\_id'           => array( 'validate' => 'd',      'default' => 1 ),             // INT |
  | 231 |  | 'dates\_ddmmyy\_csv'      => array( 'validate' => '~~strong', 'default' => '' ),            // String~~ |
  |  | 231 | 'dates\_ddmmyy\_csv'      => array( 'validate' => 'csv\_dates', 'default' => '' ),         //FixIn: 9.9.1.1 |
  | 232 | 232 | 'form\_data'             => array( 'validate' => 'strong', 'default' => '' ), |
  | 233 | 233 | 'booking\_hash'          => array( 'validate' => 'strong', 'default' => '' ), |
* ## [booking/trunk/includes/\_request/wpbc\_request.php](/changeset/3032596/booking/trunk/includes/_request/wpbc_request.php "Show the changeset 3032596 restricted to booking/trunk/includes/_request/wpbc_request.php")

  | [r3021784](/browser/booking/trunk/includes/_request/wpbc_request.php?rev=3021784#L580 "Show revision 3021784 of this file in browser") | [r3032596](/browser/booking/trunk/includes/_request/wpbc_request.php?rev=3032596#L580 "Show revision 3032596 of this file in browser") |  |
  | --- | --- | --- |
  | 580 | 580 | break; |
  | 581 | 581 |  |
  |  | 582 | case 'csv\_dates':                                                   // CSV Dates: '11.11.2025, 12.11.2025, 13.11.2025'  or  '2024-02-06, 2024-02-10' |
  |  | 583 | $clean\_params[ $request\_key\_name ] = wpbc\_sanitize\_csv\_dates( $request\_value\_check );               //FixIn: 9.9.1.1 |
  |  | 584 | break; |
  |  | 585 |  |
  | 582 | 586 | case 'digit\_or\_date':                                            // digit or Date |
  | 583 | 587 | $clean\_params[ $request\_key\_name ] = wpbc\_sanitize\_digit\_or\_date( $request\_value\_check ); |
  | […](/browser/booking/trunk/includes/_request/wpbc_request.php?rev=3021784#L734) | […](/browser/booking/trunk/includes/_request/wpbc_request.php?rev=3032596#L738) |  |
  | 734 | 738 | } |
  | 735 | 739 |  |
  |  | 740 | //FixIn: 9.9.1.1 |
  |  | 741 | /\*\* |
  |  | 742 | \* Check about Valid date, like '31.05.2022 and return this date or '' |
  |  | 743 | \* |
  |  | 744 | \* @param string $value |
  |  | 745 | \* |
  |  | 746 | \* @return string '31.05.2022' or '' |
  |  | 747 | \*/ |
  |  | 748 | function wpbc\_sanitize\_date\_dmy( $value ) { |
  |  | 749 |  |
  |  | 750 | if ( $value === '' ) return $value; |
  |  | 751 |  |
  |  | 752 | if ( preg\_match("/^(0[1-9]|[1-2][0-9]|3[0-1]).(0[1-9]|1[0-2]).[0-9]{4}$/", $value ) ) { |
  |  | 753 |  |
  |  | 754 | return $value;                                                      // Date is valid in format: 31.05.2022 |
  |  | 755 | } else { |
  |  | 756 | return ''; |
  |  | 757 | } |
  |  | 758 |  |
  |  | 759 | } |
  |  | 760 |  |
  |  | 761 |  |
  |  | 762 | //FixIn: 9.9.1.1 |
  |  | 763 | /\*\* |
  |  | 764 | \* Check about Valid date(s), like CSV Dates:  such  as: '11.11.2025, 12.11.2025, 13.11.2025'  or  '2024-02-06, 2024-02-10'    and then return them sanitized dates or '' |
  |  | 765 | \* |
  |  | 766 | \* @param string $value |
  |  | 767 | \* |
  |  | 768 | \* @return string '2022-05-31' or '' |
  |  | 769 | \*/ |
  |  | 770 | function wpbc\_sanitize\_csv\_dates( $value ) { |
  |  | 771 |  |
  |  | 772 | if ( '' === $value ) { return $value; } |
  |  | 773 |  |
  |  | 774 | $value         = str\_replace( ';', ',', $value ); |
  |  | 775 | $array\_of\_nums = explode( ',', $value ); |
  |  | 776 |  |
  |  | 777 | $result = array(); |
  |  | 778 |  |
  |  | 779 | foreach ( $array\_of\_nums as $single\_date ) { |
  |  | 780 |  |
  |  | 781 | $single\_date = trim( $single\_date ); |
  |  | 782 |  |
  |  | 783 | // Check  for date '2024-02-06 |
  |  | 784 | $date\_ymd = wpbc\_sanitize\_date( $single\_date ); |
  |  | 785 |  |
  |  | 786 | if ( '' !== $date\_ymd ) { |
  |  | 787 | $result[] = $date\_ymd; |
  |  | 788 | } else { |
  |  | 789 |  |
  |  | 790 | // Otherwise check  for date: '06.02.2024' |
  |  | 791 | $date\_dmy = wpbc\_sanitize\_date\_dmy( $single\_date ); |
  |  | 792 | if ( '' !== $date\_dmy ) { |
  |  | 793 | $result[] = $date\_dmy; |
  |  | 794 | } |
  |  | 795 | } |
  |  | 796 | } |
  |  | 797 |  |
  |  | 798 | $result = implode( ',', $result ); |
  |  | 799 |  |
  |  | 800 | return $result; |
  |  | 801 | } |
  |  | 802 |  |
  |  | 803 |  |
  |  | 804 |  |
  | 736 | 805 |  |
  | 737 | 806 | /\*\* |
* ## [booking/trunk/readme.txt](/changeset/3032596/booking/trunk/readme.txt "Show the changeset 3032596 restricted to booking/trunk/readme.txt")

  | [r3021784](/browser/booking/trunk/readme.txt?rev=3021784#L6 "Show revision 3021784 of this file in browser") | [r3032596](/browser/booking/trunk/readme.txt?rev=3032596#L6 "Show revision 3032596 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Requires PHP: 5.6 |
  | 7 | 7 | Tested up to: 6.4 |
  | 8 |  | Stable tag: 9.9 |
  |  | 8 | Stable tag: 9.9.1 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/booking/trunk/readme.txt?rev=3021784#L287) | […](/browser/booking/trunk/readme.txt?rev=3032596#L287) |  |
  | 287 | 287 |  |
  | 288 | 288 | == Changelog == |
  |  | 289 | = 9.9.1 = |
  |  | 290 | - Changes in \*\*all\*\* versions: |
  |  | 291 | \* \*\*Fix\*\* Resolve the issue of showing Notice: Undefined index: aggregate\_type in ../includes/\_capacity/capacity.php (9.9.0.16) |
  |  | 292 | \* \*\*Fix\*\* vulnerability of possible unauthenticated sql injection (9.9.1.1). |
  |  | 293 | - Changes in \*\*Personal / Business Small / Business Medium / Business Large / MultiUser\*\* versions: |
  |  | 294 | \* \*\*Improvement\*\* Server performance improvement by preventing of sending request to server for cost calculations, if in the booking form there is no dates or cost hints. It's prevent from 504 Error at some servers (9.9.0.20)  \*(Business Medium/Large, MultiUser)\* |
  |  | 295 |  |
  | 289 | 296 | = 9.9 = |
  | 290 | 297 | - Changes in \*\*all\*\* versions: |
* ## [booking/trunk/wpdev-booking.php](/changeset/3032596/booking/trunk/wpdev-booking.php "Show the changeset 3032596 restricted to booking/trunk/wpdev-booking.php")

  | [r3021784](/browser/booking/trunk/wpdev-booking.php?rev=3021784#L8 "Show revision 3021784 of this file in browser") | [r3032596](/browser/booking/trunk/wpdev-booking.php?rev=3032596#L8 "Show revision 3032596 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | Text Domain: booking |
  | 9 | 9 | Domain Path: /languages/ |
  | 10 |  | Version: 9.9 |
  |  | 10 | Version: 9.9.1 |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
  | 13 |  | /\*  Copyright 2009 - 202~~3~~  www.wpbookingcalendar.com  (email: info@wpbookingcalendar.com), |
  |  | 13 | /\*  Copyright 2009 - 2024  www.wpbookingcalendar.com  (email: info@wpbookingcalendar.com), |
  | 14 | 14 |  |
  | 15 | 15 | This program is free software: you can redistribute it and/or modify |
  | […](/browser/booking/trunk/wpdev-booking.php?rev=3021784#L30) | […](/browser/booking/trunk/wpdev-booking.php?rev=3032596#L30) |  |
  | 30 | 30 |  |
  | 31 | 31 |  |
  | 32 |  | if ( ! defined( 'WP\_BK\_VERSION\_NUM' ) ) {       define( 'WP\_BK\_VERSION\_NUM',    '9.9' ); } |
  | 33 |  | if ( ! defined( 'WP\_BK\_MINOR\_UPDATE' ) ) {      define( 'WP\_BK\_MINOR\_UPDATE',   ~~!~~true    ); } |
  |  | 32 | if ( ! defined( 'WP\_BK\_VERSION\_NUM' ) ) {       define( 'WP\_BK\_VERSION\_NUM',    '9.9.1' ); } |
  |  | 33 | if ( ! defined( 'WP\_BK\_MINOR\_UPDATE' ) ) {      define( 'WP\_BK\_MINOR\_UPDATE',   true    ); } |
  | 34 | 34 |  |
  | 35 | 35 |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3032596)
* [Zip Archive](?format=zip&new=3032596)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

