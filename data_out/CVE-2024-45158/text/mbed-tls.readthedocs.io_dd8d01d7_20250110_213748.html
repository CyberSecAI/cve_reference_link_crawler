
[Mbed TLS](../../)

Contents

* [Getting Started](../../getting_started/)
* [API Reference](https://mbed-tls.readthedocs.io/projects/api)
* [Project](../../project/)
* [Reviews](../../reviews/)
* [Security Advisories](../)
  + [Buffer underrun in pkwrite when writing an opaque key pair](../mbedtls-security-advisory-2024-10-1/)
  + [Limited authentication bypass in TLS 1.3 optional client authentication](../mbedtls-security-advisory-2024-08-3/)
  + Stack buffer overflow in ECDSA signature conversion functions
    - [Vulnerability](#vulnerability)
    - [Impact](#impact)
    - [Resolution](#resolution)
    - [Work-around](#work-around)
  + [CTR\_DRBG prioritized over HMAC\_DRBG as the PSA DRBG](../mbedtls-security-advisory-2024-08-1/)
  + [Insecure handling of shared memory in PSA Crypto APIs](../mbedtls-security-advisory-2024-03/)
  + [Buffer overflow in mbedtls\_x509\_set\_extension()](../mbedtls-security-advisory-2024-01-2/)
  + [Timing side channel in private key RSA operations.](../mbedtls-security-advisory-2024-01-1/)
  + [Buffer overflow in TLS handshake parsing with ECDH](../mbedtls-security-advisory-2023-10-2/)
  + [Buffer overread in TLS stream cipher suites](../mbedtls-security-advisory-2023-10-1/)
  + [Buffer overread in DTLS ClientHello parsing](../mbedtls-security-advisory-2022-07/)
  + [Double Free in `mbedtls_ssl_set_session()` in an error case.](../mbedtls-security-advisory-2021-12/)
  + [Local side channel attack on static Diffie-Hellman with Montgomery curves](../mbedtls-security-advisory-2021-07-2/)
  + [Local side channel attack on RSA](../mbedtls-security-advisory-2021-07-1/)
  + [Protocol weakness in DHE-PSK key exchange](../mbedtls-security-advisory-2020-09-3/)
  + [Local side channel attack on RSA and static Diffie-Hellman](../mbedtls-security-advisory-2020-09-2/)
  + [Local side channel attack on classical CBC decryption in (D)TLS](../mbedtls-security-advisory-2020-09-1/)
  + [Side-channel attack on ECC key import and validation](../mbedtls-security-advisory-2020-07/)
  + [Side channel attack on ECDSA](../mbedtls-security-advisory-2020-04/)
  + [Cache attack against RSA key import in SGX](../mbedtls-security-advisory-2020-02/)
  + [Side channel attack on ECDSA](../mbedtls-security-advisory-2019-12/)
  + [Side channel attack on deterministic ECDSA](../mbedtls-security-advisory-2019-10/)
  + [Mbed TLS Security Advisory 2018-03](../mbedtls-security-advisory-2018-03/)
  + [Mbed TLS Security Advisory 2018-02](../mbedtls-security-advisory-2018-02/)
  + [mbed TLS Security Advisory 2018-01](../mbedtls-security-advisory-2018-01/)
  + [mbed TLS Security Advisory 2017-02](../mbedtls-security-advisory-2017-02/)
  + [mbed TLS Security Advisory 2017-01](../mbedtls-security-advisory-2017-01/)
  + [mbed TLS Security Advisory 2015-01](../mbedtls-security-advisory-2015-01/)
  + [PolarSSL Security Advisory 2014-04](../polarssl-security-advisory-2014-04/)
  + [PolarSSL Security Advisory 2014-03](../polarssl-security-advisory-2014-03-poodle-attack-on-ssl-v3/)
  + [PolarSSL Security Advisory 2014-02](../polarssl-security-advisory-2014-02/)
  + [PolarSSL Security Advisory 2014-01](../polarssl-security-advisory-2014-01/)
  + [PolarSSL Security Advisory 2013-05](../polarssl-security-advisory-2013-05/)
  + [PolarSSL Security Advisory 2013-04](../polarssl-security-advisory-2013-04/)
  + [PolarSSL Security Advisory 2013-03](../polarssl-security-advisory-2013-03/)
  + [PolarSSL Security Advisory 2013-02](../polarssl-security-advisory-2013-02/)
  + [PolarSSL Security Advisory 2013-01](../polarssl-security-advisory-2013-01/)
  + [PolarSSL Security Advisory 2012-01](../polarssl-security-advisory-2012-01/)
  + [PolarSSL Security Advisory 2011-02](../polarssl-security-advisory-2011-02/)
  + [PolarSSL Security Advisory 2011-01](../polarssl-security-advisory-2011-01/)
* [Contributing to This Documentation](../../CONTRIBUTING/)
* [Knowledge Base](../../kb/)

[Mbed TLS](../../)

* [Security Advisories](../)
* Stack buffer overflow in ECDSA signature conversion functions
* [View page source](../../_sources/security-advisories/mbedtls-security-advisory-2024-08-2.md.txt)

---

# Stack buffer overflow in ECDSA signature conversion functions[](#stack-buffer-overflow-in-ecdsa-signature-conversion-functions "Permalink to this heading")

| **Title** | Stack buffer overflow in ECDSA signature conversion functions |
| --- | --- |
| **CVE** | CVE-2024-45158 |
| **Date** | 30 August 2024 |
| **Affects** | Mbed TLS 3.6.0 |
| **Severity** | High |

## Vulnerability[](#vulnerability "Permalink to this heading")

In Mbed TLS 3.6.0, the functions `mbedtls_ecdsa_der_to_raw()` and `mbedtls_ecdsa_raw_to_der()` do not correctly validate their `bits` argument. If the value of that argument is larger than the bit-length of the largest supported curve, these functions may overflow a buffer on the stack with content copied from their input parameter.

When `MBEDTLS_PSA_CRYPTO_C` is enabled, the maximum safe value of `bits` is the size of the largest curve supported by the PSA API. All curves supported by the legacy API (`ecp.h`, `ecdh.h`, `ecdsa.h`, `ecjpake.h`, `pk.h`) are also supported by the PSA API, thus any curve size supported in Mbed TLS is safe. However, code that calls these functions without ensuring that `bits` corresponds to a supported curve is vulnerable.

When `MBEDTLS_PSA_CRYPTO_C` is disabled, in some configurations, the functions use a 0-size buffer internally. If this is not detected at compile time, the functions would overflow their internal buffer for all correct inputs. These functions are declared in `mbedtls/psa_util.h` and were intended for use together with the PSA API, but they were not excluded from builds without PSA.

All the calls to these functions made inside Mbed TLS are safe.

## Impact[](#impact "Permalink to this heading")

Applications that call `mbedtls_ecdsa_der_to_raw()` or `mbedtls_ecdsa_raw_to_der()` on attacker-controlled input are vulnerable to a stack buffer overflow with attacker-chosen content. Note that to provoke the attack, the attacker needs to control the declared curve bit-size, not just the buffer size and content.

## Resolution[](#resolution "Permalink to this heading")

Affected users will want to upgrade to Mbed TLS 3.6.1.

## Work-around[](#work-around "Permalink to this heading")

Code that calls `mbedtls_ecdsa_der_to_raw()` and `mbedtls_ecdsa_raw_to_der()` in Mbed TLS 3.6.0 is safe if `MBEDTLS_PSA_CRYPTO_C` is enabled and the calling code first ensures that the `bits` parameter is the bit-size of a curve that is supported in the build of Mbed TLS.

 [Previous](../mbedtls-security-advisory-2024-08-3/ "Limited authentication bypass in TLS 1.3 optional client authentication")
[Next](../mbedtls-security-advisory-2024-08-1/ "CTR_DRBG prioritized over HMAC_DRBG as the PSA DRBG")

---

© Copyright The Mbed TLS Contributors.

Built with [Sphinx](https://www.sphinx-doc.org/) using a
[theme](https://github.com/readthedocs/sphinx_rtd_theme)
provided by [Read the Docs](https://readthedocs.org).

