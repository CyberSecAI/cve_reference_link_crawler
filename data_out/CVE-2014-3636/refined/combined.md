=== Content from secunia.com_9f88b4ec_20250110_161056.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

SVG
 ![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

SVG
 ![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

SVG
 ![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

SVG
 ![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2024 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from advisories.mageia.org_73bc190f_20250110_161055.html ===

# [Advisories](index.html) » MGASA-2014-0395

## Updated dbus packages fix multiple security vulnerabilities

Publication date: 07 Oct 2014

Modification date: 07 Oct 2014

Type: security

Affected Mageia releases :
[3](3.html)
,
[4](4.html)

CVE:
[CVE-2014-3635](CVE-2014-3635.html)
,
[CVE-2014-3636](CVE-2014-3636.html)
,
[CVE-2014-3637](CVE-2014-3637.html)
,
[CVE-2014-3638](CVE-2014-3638.html)
,
[CVE-2014-3639](CVE-2014-3639.html)

## Description

```
Updated dbus packages fixes the following security issues:

Alban Crequy and Simon McVittie discovered several vulnerabilities in the
D-Bus message daemon:

On 64-bit platforms, file descriptor passing could be abused by local users
to cause heap corruption in dbus-daemon, leading to a crash, or potentially
to arbitrary code execution (CVE-2014-3635).

A denial-of-service vulnerability in dbus-daemon allowed local attackers to
prevent new connections to dbus-daemon, or disconnect existing clients, by
exhausting descriptor limits (CVE-2014-3636).

Malicious local users could create D-Bus connections to dbus-daemon which
could not be terminated by killing the participating processes, resulting
in a denial-of-service vulnerability (CVE-2014-3637).

dbus-daemon suffered from a denial-of-service vulnerability in the code
which tracks which messages expect a reply, allowing local attackers to
reduce the performance of dbus-daemon (CVE-2014-3638).

dbus-daemon did not properly reject malicious connections from local users,
resulting in a denial-of-service vulnerability (CVE-2014-3639).

```

## References

* <https://bugs.mageia.org/show_bug.cgi?id=14102>
* <http://openwall.com/lists/oss-security/2014/09/16/9>
* <https://www.debian.org/security/2014/dsa-3026>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3635>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3636>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3637>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3638>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3639>

## SRPMS

### 3/core

* dbus-1.6.8-4.5.mga3

### 4/core

* dbus-1.6.18-1.4.mga4



=== Content from lists.opensuse.org_407bde4d_20250110_161055.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

# openSUSE-SU-2014:1239-1: moderate: dbus-1: update to 1.6.24

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

28 Sep
2014

28 Sep
'14

10:09

openSUSE Security Update: dbus-1: update to 1.6.24
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:1239-1
Rating: moderate
References: #896453
Cross-References: CVE-2014-3635 CVE-2014-3636 CVE-2014-3637
CVE-2014-3638 CVE-2014-3639
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 5 vulnerabilities is now available.
Description:
The DBUS-1 service and libraries were updated to upstream release 1.6.24
fixing security issues and bugs.
Upstream changes since dbus 1.6.8
+ Security fixes
- Do not accept an extra fd in the padding of a cmsg message, which
could lead to a 4-byte heap buffer overrun. (CVE-2014-3635,
fdo#83622; Simon McVittie)
- Reduce default for maximum Unix file descriptors passed per message
from 1024 to 16, preventing a uid with the default maximum number of
connections from exhausting the system bus' file descriptors under
Linux's default rlimit. Distributors or system administrators with a
more restrictive fd limit may wish to reduce these limits further.
Additionally, on Linux this prevents a second denial of service in
which the dbus-daemon can be made to exceed the maximum number of
fds per sendmsg() and disconnect the process that would have
received them. (CVE-2014-3636, fdo#82820; Alban Crequy)
- Disconnect connections that still have a fd pending unmarshalling
after a new configurable limit, pending\_fd\_timeout (defaulting to
150 seconds), removing the possibility of creating an abusive
connection that cannot be disconnected by setting up a circular
reference to a connection's file descriptor. (CVE-2014-3637,
fdo#80559; Alban Crequy)
- Reduce default for maximum pending replies per connection from 8192
to 128, mitigating an algorithmic complexity denial-of-service
attack (CVE-2014-3638, fdo#81053; Alban Crequy)
- Reduce default for authentication timeout on the system bus from 30
seconds to 5 seconds, avoiding denial of service by using up all
unauthenticated connection slots; and when all unauthenticated
connection slots are used up, make new connection attempts block
instead of disconnecting them. (CVE-2014-3639, fdo#80919; Alban
Crequy)
- On Linux >= 2.6.37-rc4, if sendmsg() fails with ETOOMANYREFS,
silently drop the message. This prevents an attack in which a
malicious client can make dbus-daemon disconnect a system service,
which is a local denial of service. (fdo#80163, CVE-2014-3532; Alban
Crequy)
- Track remaining Unix file descriptors correctly when more than one
message in quick succession contains fds. This prevents another
attack which a malicious client can make dbus-daemon disconnect a
system service. (fdo#79694, fdo#80469, CVE-2014-3533; Alejandro
Martínez Suárez, Simon McVittie, Alban Crequy)
- Alban Crequy at Collabora Ltd. discovered and fixed a
denial-of-service flaw in dbus-daemon, part of the reference
implementation of D-Bus. Additionally, in highly unusual
environments the same flaw could lead to a side channel between
processes that should not be able to communicate. (CVE-2014-3477,
fdo#78979)
- CVE-2013-2168: Fix misuse of va\_list that could be used as a denial
of service for system services. Vulnerability reported by Alexandru
Cornea. (Simon)
+ Other fixes
- Don't leak memory on out-of-memory while listing activatable or
active services (fdo#71526, Radoslaw Pajak)
- fix undefined behaviour in a regression test (fdo#69924, DreamNik)
- path\_namespace='/' in match rules incorrectly matched nothing; it
now matches everything. (fdo#70799, Simon McVittie)
- Make dbus\_connection\_set\_route\_peer\_messages(x, FALSE) behave as
documented. Previously, it assumed its second parameter was TRUE.
(fdo#69165, Chengwei Yang)
- Fix a NULL pointer dereference on an unlikely error path (fdo#69327,
Sviatoslav Chagaev)
- If accept4() fails with EINVAL, as it can on older Linux kernels
with newer glibc, try accept() instead of going into a busy-loop.
(fdo#69026, Chengwei Yang)
- If socket() or socketpair() fails with EINVAL or EPROTOTYPE, for
instance on Hurd or older Linux with a new glibc, try without
SOCK\_CLOEXEC. (fdo#69073; Pino Toscano, Chengwei Yang)
- Fix a file descriptor leak on an error code path. (fdo#69182,
Sviatoslav Chagaev)
- Fix compilation if writev() is unavailable (fdo#69409, Vasiliy
Balyasnyy)
- Avoid an infinite busy-loop if a signal interrupts waitpid()
(fdo#68945, Simon McVittie)
- Escape addresses containing non-ASCII characters correctly
(fdo#53499, Chengwei Yang)
- If malloc() returns NULL in \_dbus\_string\_init() or similar, don't
free an invalid pointer if the string is later freed (fdo#65959,
Chengwei Yang)
- If malloc() returns NULL in dbus\_set\_error(), don't va\_end() a
va\_list that was never va\_start()ed (fdo#66300, Chengwei Yang)
- Fix a regression test on platforms with strict alignment (fdo#67279,
Colin Walters)
- Avoid calling function parameters "interface" since certain Windows
headers have a namespace-polluting macro of that name (fdo#66493,
Ivan Romanov)
- Make "make -j check" work (fdo#68852, Simon McVittie)
- In dbus-daemon, don't crash if a .service file starts with key=value
(fdo#60853, Chengwei Yang)
- Fix an assertion failure if we try to activate systemd services
before systemd connects to the bus (fdo#50199, Chengwei Yang)
- Avoid compiler warnings for ignoring the return from write()
(Chengwei Yang)
- Following Unicode Corrigendum #9, the noncharacters U+nFFFE,
U+nFFFF, U+FDD0..U+FDEF are allowed in UTF-8 strings again.
(fdo#63072, Simon McVittie)
- Diagnose incorrect use of dbus\_connection\_get\_data() with negative
slot (i.e. before allocating the slot) rather than returning junk
(fdo#63127, Dan Williams)
- In the activation helper, when compiled for tests, do not reset the
system bus address, fixing the regression tests. (fdo#52202, Simon)
- Fix building with Valgrind 3.8, at the cost of causing harmless
warnings with Valgrind 3.6 on some compilers (fdo#55932, Arun
Raghavan)
- Don't leak temporary fds pointing to /dev/null (fdo#56927, Michel
HERMIER)
- Create session.d, system.d directories under CMake (fdo#41319, Ralf
Habacker)
- Include alloca.h for alloca() if available, fixing compilation on
Solaris 10 (fdo#63071, Dagobert Michelsen)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2014-557
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
dbus-1-1.6.24-2.26.1
dbus-1-debuginfo-1.6.24-2.26.1
dbus-1-debugsource-1.6.24-2.26.1
dbus-1-devel-1.6.24-2.26.1
dbus-1-x11-1.6.24-2.26.1
dbus-1-x11-debuginfo-1.6.24-2.26.1
dbus-1-x11-debugsource-1.6.24-2.26.1
libdbus-1-3-1.6.24-2.26.1
libdbus-1-3-debuginfo-1.6.24-2.26.1
- openSUSE 12.3 (x86\_64):
dbus-1-32bit-1.6.24-2.26.1
dbus-1-debuginfo-32bit-1.6.24-2.26.1
dbus-1-devel-32bit-1.6.24-2.26.1
libdbus-1-3-32bit-1.6.24-2.26.1
libdbus-1-3-debuginfo-32bit-1.6.24-2.26.1
- openSUSE 12.3 (noarch):
dbus-1-devel-doc-1.6.24-2.26.1
References:
<http://support.novell.com/security/cve/CVE-2014-3635.html>
<http://support.novell.com/security/cve/CVE-2014-3636.html>
<http://support.novell.com/security/cve/CVE-2014-3637.html>
<http://support.novell.com/security/cve/CVE-2014-3638.html>
<http://support.novell.com/security/cve/CVE-2014-3639.html>
<https://bugzilla.suse.com/show_bug.cgi?id=896453>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V/#F6KVOGOTXGQM2NKWETREXAOIDVHSGF4V)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugs.freedesktop.org_f9e6e46c_20250110_161103.html ===


Bugzilla – Bug 82820
CVE-2014-3636: using all available file descriptors in dbus-daemon: limit DEFAULT\_MESSAGE\_UNIX\_FDS
Last modified: 2014-09-16 16:37:02 UTC

* [Home](./)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

[**Bug 82820**](show_bug.cgi?id=82820)
- CVE-2014-3636: using all available file descriptors in dbus-daemon: limit DEFAULT\_MESSAGE\_UNIX\_FDS

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2014-3636: using all available file descriptors in dbus-daemon: limit DEF...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | dbus | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=dbus "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | core ([show other bugs](buglist.cgi?component=core&product=dbus&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other All | |  | | | [Importance](page.cgi?id=fields.html#importance): | medium normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Simon McVittie | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sjoerd Simons | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | review+ | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | patch, security | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2014-08-19 15:21 UTC by Alban Crequy | | --- | --- | | Modified: | 2014-09-16 16:37 UTC ([History](show_activity.cgi?id=82820)) | | CC List: | 2 users (show)  thiago walters | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [i915 platform:](page.cgi?id=fields.html#cf_i915_platform "Intel platforms affected by the bug") |  | | [i915 features:](page.cgi?id=fields.html#cf_i915_features "Features of the i915 driver affected by the bug.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**[PATCH] config: set DEFAULT\_MESSAGE\_UNIX\_FDS to 16**](attachment.cgi?id=104901 "View the content of the attachment") (2.50 KB, patch)  [2014-08-19 15:21 UTC](#attach_104901 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=104901&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=82820&attachment=104901) | | [**[PATCH v2] config: set DEFAULT\_MESSAGE\_UNIX\_FDS to 16**](attachment.cgi?id=104969 "View the content of the attachment") (2.58 KB, patch)  [2014-08-20 10:13 UTC](#attach_104969 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=104969&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=82820&attachment=104969) | | [**[PATCH v3] config: reduce DEFAULT\_MESSAGE\_UNIX\_FDS to 16**](attachment.cgi?id=105987 "View the content of the attachment") (3.55 KB, patch)  [2014-09-09 14:53 UTC](#attach_105987 "Go to the comment associated with the attachment"), Alban Crequy | [Details](attachment.cgi?id=105987&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=82820&attachment=105987) | | [**[patch v4] config: change DEFAULT\_MESSAGE\_UNIX\_FDS to 16**](attachment.cgi?id=106189 "View the content of the attachment") (6.43 KB, patch)  [2014-09-12 15:02 UTC](#attach_106189 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106189&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=82820&attachment=106189) | | [**[patch v4 backport to 1.6] config: change DEFAULT\_MESSAGE\_UNIX\_FDS to 16**](attachment.cgi?id=106190 "View the content of the attachment") (6.43 KB, patch)  [2014-09-12 15:36 UTC](#attach_106190 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106190&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=82820&attachment=106190) | | [**[patch v4 backport to 1.6] config: change DEFAULT\_MESSAGE\_UNIX\_FDS to 16**](attachment.cgi?id=106196 "View the content of the attachment") (6.08 KB, patch)  [2014-09-12 16:12 UTC](#attach_106196 "Go to the comment associated with the attachment"), Simon McVittie | [Details](attachment.cgi?id=106196&action=edit) | [Splinter Review](https://bugs.freedesktop.org/page.cgi?id=splinter.html&bug=82820&attachment=106196) | | [Show Obsolete](#a0) (4) [View All](attachment.cgi?bugid=82820&action=viewall&hide_obsolete=1) | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=82820#c0)  Alban Crequy    2014-08-19 15:21:55 UTC  ``` Created [attachment 104901](attachment.cgi?id=104901 "[PATCH] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=104901&action=edit "[PATCH] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=104901) [PATCH] config: set DEFAULT_MESSAGE_UNIX_FDS to 16  Before this patch, the system bus had the following default configuration: - max_connections_per_user: 256 - DBUS_DEFAULT_MESSAGE_UNIX_FDS: usually 1024 (or 256 on QNX, see fd.o#61176)   as defined by configure.ac - max_incoming_unix_fds: DBUS_DEFAULT_MESSAGE_UNIX_FDS*4 = usually 4096 - max_outgoing_unix_fds: DBUS_DEFAULT_MESSAGE_UNIX_FDS*4 = usually 4096 - max_message_unix_fds: DBUS_DEFAULT_MESSAGE_UNIX_FDS = usually 1024  This means that a single user could create 256 connections and transmit 256*4096 = 1048576 file descriptors.  The file descriptors stay attached to the dbus-daemon process while they are in the message loader, in the outgoing queue or waiting to be dispatched before D-Bus activation.  dbus-daemon is usually limited to 65536 file descriptors (ulimit -n). If the limit is reached and dbus-daemon needs to receive a message with a file descriptor attached, this is signalled by recvfrom with the flag MSG_CTRUNC. Dbus-daemon cannot recover from that error because the kernel does not have any API to retrieve a file descriptor which has been discarded with MSG_CTRUNC. Therefore, it closes the connection of the sender. This is not necessarily the connection which generated the most file descriptors so it can lead to denial-of-service attacks.  In order to prevent DoS issues, this patch reduces DEFAULT_MESSAGE_UNIX_FDS to 16:  max_connections_per_user * max_incoming_unix_fds = 256 * 64 = 16384  This is less than the usual "ulimit -n" (65536) with a good margin to accomodate the other sources of file descriptors (stdin/stdout/stderr, listening sockets, message loader, etc.) ```  [Comment 1](show_bug.cgi?id=82820#c1)  Thiago Macieira    2014-08-19 15:54:27 UTC  ``` Comment on [attachment 104901](attachment.cgi?id=104901 "[PATCH] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=104901&action=edit "[PATCH] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=104901) [PATCH] config: set DEFAULT_MESSAGE_UNIX_FDS to 16  Review of [attachment 104901](attachment.cgi?id=104901 "[PATCH] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=104901&action=edit "[PATCH] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=104901): -----------------------------------------------------------------  Looks good, but I'd remove the QNX extra case altogether.  ::: configure.ac @@ +1241,3 @@ >  # Determine maximum number of Unix fds which may be passed >  AS_CASE([$host_os], >    [*qnx*],  You should remove the case altogether. ```  [Comment 2](show_bug.cgi?id=82820#c2)  Alban Crequy    2014-08-20 10:13:56 UTC  ``` Created [attachment 104969](attachment.cgi?id=104969 "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=104969&action=edit "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=104969) [PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16  Thanks for the review.  v2: - remove the case, as per Thiago's review - add a reference to bugzilla in the commit log ```  [Comment 3](show_bug.cgi?id=82820#c3)  Thiago Macieira    2014-08-20 17:31:06 UTC  ``` Comment on [attachment 104969](attachment.cgi?id=104969 "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=104969&action=edit "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=104969) [PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16  Review of [attachment 104969](attachment.cgi?id=104969 "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=104969&action=edit "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=104969): -----------------------------------------------------------------  Looks good, ship it. ```  [Comment 4](show_bug.cgi?id=82820#c4)  Simon McVittie    2014-09-03 17:12:50 UTC  ``` Comment on [attachment 104969](attachment.cgi?id=104969 "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=104969&action=edit "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=104969) [PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16  Review of [attachment 104969](attachment.cgi?id=104969 "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=104969&action=edit "[PATCH v2] config: set DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=104969): -----------------------------------------------------------------  (I'm back from "nowhere near dbus" and hoping to have considerably more time to deal with Alban's recent security work now.)  dbus-daemon does attempt to raise its fd limit to at least      max_completed_connections +     max_incomplete_connections +     32 /* arbitrary number for pipes, inotify, misc */  but indeed that does not take into account that fd-passing can also increase the number of fds it needs.  If we're going to be doing an embargoed security release for at least one of Alban's embargoed things, which seems likely, then I think it makes sense to queue this for that release. ```  [Comment 5](show_bug.cgi?id=82820#c5)  Simon McVittie    2014-09-05 17:44:49 UTC  ``` (In reply to [comment #0](show_bug.cgi?id=82820#c0)) > This means that a single user could create 256 connections and transmit > 256*4096 = 1048576 file descriptors.  I was about to say: I think it's actually more complicated than that. The byte-limit on incoming messages is allowed to be exceeded by up to 1 read cycle (2 KiB) or 1 entire message, whichever is greater, minus 1 byte - this means we can still make forward progress if the limit on the size of a message is greater than the limit on incoming messages.  However, while investigating this I found that the same logic is not applied particularly consistently to fds, and that if you send a lot of fds in quick succession, you can end up with less space to read fds into than max_message_unix_fds (possibly down to zero), because _dbus_message_loader_get_unix_fds does not allocate (currently queued number + max_message_unix_fds) but just (max_message_unix_fds) of space in total; so you're more likely to get MSG_CTRUNC and be disconnected. I don't think this is a security bug, but it is potentially an ordinary functionality bug, and dropping this limit seems likely to exacerbate it. I'm not sure whether the author of our fd-passing code (Lennart?) had realised that for performance, we "eagerly" fill the DBusMessageLoader with as many messages as we can, rather than stopping at exactly 1 message.  If we go for the same "may exceed by up to 1 maximal message" logic, Alban's figures for the number of fds a uid can consume need to be multiplied by 5/4.  Alternatively, we could drop max_incoming_unix_fds to be closer to max_message_unix_fds? ```  [Comment 6](show_bug.cgi?id=82820#c6)  Alban Crequy    2014-09-08 10:27:38 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=82820#c4)) > dbus-daemon does attempt to raise its fd limit to at least >  >     max_completed_connections + >     max_incomplete_connections + >     32 /* arbitrary number for pipes, inotify, misc */  I have not seen that. This is in bus/bus.c raise_file_descriptor_limit(). But on my system, dbus-daemon runs as user "messagebus" and raise_file_descriptor_limit() skips the attempt when getuid () != 0. ```  [Comment 7](show_bug.cgi?id=82820#c7)  Simon McVittie    2014-09-08 11:07:13 UTC  ``` (In reply to [comment #6](show_bug.cgi?id=82820#c6)) > I have not seen that. This is in bus/bus.c raise_file_descriptor_limit(). > But on my system, dbus-daemon runs as user "messagebus" and > raise_file_descriptor_limit() skips the attempt when getuid () != 0.  Hmm, yes. The systemd unit starts it as root and lets it do its own setuid() to messagebus, but the Debian sysvinit script starts it as messagebus.  I should maybe change the sysvinit script in Debian to start as root too. ```  [Comment 8](show_bug.cgi?id=82820#c8)  Alban Crequy    2014-09-08 14:07:59 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=82820#c5)) > If we go for the same "may exceed by up to 1 maximal message" logic, Alban's > figures for the number of fds a uid can consume need to be multiplied by 5/4.  I am not sure I understand this correctly... With the patch applied, we have:  max_connections_per_user * max_incoming_unix_fds  = 256 * DBUS_DEFAULT_MESSAGE_UNIX_FDS * 4  = 256 * 16 * 4  = 16384  Even multiplied by 5/4, we get 20480, which is less than 65536 ("ulimit -n"), so it's fine. Is it correct? ```  [Comment 9](show_bug.cgi?id=82820#c9)  Alban Crequy    2014-09-08 14:14:48 UTC  ``` This patch might fix two security issues for the price of one :)  There is a limit I didn't know before: on Linux, it's not possible to send more than 253 fds in a single sendmsg() system call: sendmsg() would return -EINVAL. #define SCM_MAX_FD      253 <http://lxr.free-electrons.com/source/include/net/scm.h#L13>  Imagine a malicious D-Bus client sending a single D-Bus message by calling sendmsg() two times to send the two halves of the message separately. If the D-Bus message has 256 fds attached in total but each halves of the message has 128 fds attached, then the two sendmsg() calls will succeed. Dbus-daemon will receive the message successfully and attempt to forward it to the recipient in a single sendmsg() call. It will fail with -EINVAL and dbus-daemon will disconnect the recipient instead of blaming the sender. So a random client could disconnect a system service by sending this crafted message in two parts...  Do we need to add -EINVAL along with ETOOMANYREFS as explained in [Bug #80163 Comment #3](show_bug.cgi?id=80163#c3 "RESOLVED FIXED - CVE-2014-3532: kick any connection off the bus with fdpassing: denial of service")? If we keep max_incoming_unix_fds lower than SCM_MAX_FD, then we don't have to change the error management.  Do we need a new bug for that, or can I just edit the commit log in this patch? ```  [Comment 10](show_bug.cgi?id=82820#c10)  Simon McVittie    2014-09-08 14:29:04 UTC  ``` (In reply to [comment #8](show_bug.cgi?id=82820#c8)) > Even multiplied by 5/4, we get 20480, which is less than 65536 ("ulimit > -n"), so it's fine. Is it correct?  Yes, I think so.  I think I need to do some testing on this stuff, it isn't sufficiently clear what's going on.  (In reply to [comment #9](show_bug.cgi?id=82820#c9)) > This patch might fix two security issues for the price of one :) ... > Imagine a malicious D-Bus client sending a single D-Bus message by calling > sendmsg() two times to send the two halves of the message separately.  I can also imagine a malicious D-Bus client calling sendmsg() once per byte, so we can be given one fd per byte of message (header + padding + payload). We certainly want to allow multi-KiB messages.  > Dbus-daemon > will receive the message successfully and attempt to forward it to the > recipient in a single sendmsg() call. It will fail with -EINVAL and > dbus-daemon will disconnect the recipient instead of blaming the sender.  Yes, I think you're right. So we need the limit on fds per message to be 253 or less, if we want dbus-daemon to be able to forward it in a single sendmsg(), which we do.  > Do we need to add -EINVAL along with ETOOMANYREFS as explained in [Bug #80163](show_bug.cgi?id=80163 "RESOLVED FIXED - CVE-2014-3532: kick any connection off the bus with fdpassing: denial of service") > [Comment #3](show_bug.cgi?id=82820#c3)? If we keep max_incoming_unix_fds lower than SCM_MAX_FD, then we > don't have to change the error management.  More precisely, we want to keep max_message_unix_fds <= SCM_MAX_FD.  I don't think we need to add -EINVAL to the -ETOOMANYREFS handling for this reason, because your patch would already address this; and I don't really want to make -EINVAL non-fatal for the connection, because it's such a generic error code that it's anyone's guess what it means.  > Do we need a new bug for that, or can I just edit the commit log in this > patch?  I think an edited commit message is fine. ```  [Comment 11](show_bug.cgi?id=82820#c11)  Simon McVittie    2014-09-08 19:08:30 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=82820#c5)) > However, while investigating this I found that the same logic is not applied > particularly consistently to fds, and that if you send a lot of fds in quick > succession, you can end up with less space to read fds into than > max_message_unix_fds (possibly down to zero), because > _dbus_message_loader_get_unix_fds does not allocate (currently queued number > + max_message_unix_fds) but just (max_message_unix_fds) of space in total; > so you're more likely to get MSG_CTRUNC and be disconnected.  In practice, as long as you start each new message with a new sendmsg(), I don't think you can hit this problem. So I think we're OK here. ```  [Comment 12](show_bug.cgi?id=82820#c12)  Alban Crequy    2014-09-09 14:33:23 UTC  ``` (In reply to [comment #10](show_bug.cgi?id=82820#c10)) > More precisely, we want to keep max_message_unix_fds <= SCM_MAX_FD.  SCM_MAX_FD changed value during Linux history: - it used to be (OPEN_MAX-1) - commit c09edd6eb (Jul 2007) changed it to 255 - commit bba14de98 (Nov 2010) changed it to 253  And it is not exported to userspace.  But I think that with the new value max_message_unix_fds=16, we are safe: even if SCM_MAX_FD is further reduced, we have some margin. ```  [Comment 13](show_bug.cgi?id=82820#c13)  Alban Crequy    2014-09-09 14:53:37 UTC  ``` Created [attachment 105987](attachment.cgi?id=105987 "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=105987&action=edit "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=105987) [PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16  v3: edit commit log to explain the two denials of service ```  [Comment 14](show_bug.cgi?id=82820#c14)  Simon McVittie    2014-09-09 18:13:27 UTC  ``` Comment on [attachment 105987](attachment.cgi?id=105987 "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=105987&action=edit "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=105987) [PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16  Review of [attachment 105987](attachment.cgi?id=105987 "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=105987&action=edit "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=105987): -----------------------------------------------------------------  Looks good to me. ```  [Comment 15](show_bug.cgi?id=82820#c15)  Simon McVittie    2014-09-12 14:54:14 UTC  ``` Comment on [attachment 105987](attachment.cgi?id=105987 "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=105987&action=edit "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=105987) [PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16  Review of [attachment 105987](attachment.cgi?id=105987 "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=105987&action=edit "[PATCH v3] config: reduce DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=105987): -----------------------------------------------------------------  ::: configure.ac @@ +1238,5 @@ >    AC_DEFINE([WITH_VALGRIND], [1], [Define to add Valgrind instrumentation]) >  fi >   > +# Keep the default low to avoid DoS issues, see fd.o #82820 > +DEFAULT_MESSAGE_UNIX_FDS=16  While backporting this to 1.6 I noticed that you didn't change the corresponding value in the cmake build system.  Now that we're not distinguishing between QNX and other Unixes, we can just hard-code, which is a simplification. ```  [Comment 16](show_bug.cgi?id=82820#c16)  Simon McVittie    2014-09-12 15:02:22 UTC  ``` Created [attachment 106189](attachment.cgi?id=106189 "[patch v4] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=106189&action=edit "[patch v4] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=106189) [patch v4] config: change DEFAULT_MESSAGE_UNIX_FDS to 16  Based on a patch by Alban Crequy. Now that it's the same on all platforms, there's little point in it being set by configure/cmake.  This change fixes two distinct denials of service:  fd.o#82820, part A ------------------  Before this patch, the system bus had the following default configuration:  [... what Alban said ...]  This is less than the usual "ulimit -n" (65536) with a good margin to accomodate the other sources of file descriptors (stdin/stdout/stderr, listening sockets, message loader, etc.).  Distributors on non-Linux may need to configure a smaller limit in system.conf, if their limit on the number of fds is smaller than Linux's.  fd.o#82820, part B ------------------  On Linux, it's not possible to send more than 253 fds in a single sendmsg() call: [... what Alban said ...]  ---  v4: * define DBUS_DEFAULT_MESSAGE_UNIX_FDS in dbus-sysdeps.h instead of   configure.ac   - already included by bus/config-parser.c   - explicitly include that header in dbus/dbus-message.c  * make bus/session.conf.in just not override the default,   so it doesn't have to get @DEFAULT_MESSAGE_UNIX_FDS@ substituted  * mention in the commit message that non-Linux may need further reductions ```  [Comment 17](show_bug.cgi?id=82820#c17)  Simon McVittie    2014-09-12 15:36:57 UTC  ``` Created [attachment 106190](attachment.cgi?id=106190 "[patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=106190&action=edit "[patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=106190) [patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16  ---  That constant is new in 1.8 so introduce it into 1.6. ```  [Comment 18](show_bug.cgi?id=82820#c18)  Alban Crequy    2014-09-12 15:51:10 UTC  ``` Comment on [attachment 106189](attachment.cgi?id=106189 "[patch v4] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=106189&action=edit "[patch v4] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=106189) [patch v4] config: change DEFAULT_MESSAGE_UNIX_FDS to 16  Review of [attachment 106189](attachment.cgi?id=106189 "[patch v4] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=106189&action=edit "[patch v4] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=106189): -----------------------------------------------------------------  When applying the patch on the master branch, a trivial conflict on configure.ac will need to be fixed.  The patch looks good to me. ```  [Comment 19](show_bug.cgi?id=82820#c19)  Alban Crequy    2014-09-12 15:56:46 UTC  ``` Comment on [attachment 106190](attachment.cgi?id=106190 "[patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=106190&action=edit "[patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=106190) [patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16  Review of [attachment 106190](attachment.cgi?id=106190 "[patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=106190&action=edit "[patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=106190): -----------------------------------------------------------------  > [patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16  It does not seem to be the correct attachment for a backport to 1.6. ```  [Comment 20](show_bug.cgi?id=82820#c20)  Simon McVittie    2014-09-12 16:10:05 UTC  ``` (In reply to [comment #18](show_bug.cgi?id=82820#c18)) > When applying the patch on the master branch, a trivial conflict on > configure.ac will need to be fixed.  I'm treating dbus-1.8 as the canonical version since that's what I'll have to use for the security release. ```  [Comment 21](show_bug.cgi?id=82820#c21)  Simon McVittie    2014-09-12 16:10:56 UTC  ``` (In reply to [comment #19](show_bug.cgi?id=82820#c19)) > It does not seem to be the correct attachment for a backport to 1.6.  Oh, sorry, you're right. One moment. ```  [Comment 22](show_bug.cgi?id=82820#c22)  Simon McVittie    2014-09-12 16:12:06 UTC  ``` Created [attachment 106196](attachment.cgi?id=106196 "[patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[details]](attachment.cgi?id=106196&action=edit "[patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16") [[review]](page.cgi?id=splinter.html&bug=82820&attachment=106196) [patch v4 backport to 1.6] config: change DEFAULT_MESSAGE_UNIX_FDS to 16  ---  Actually the 1.6 version this time, not the 1.8 version.  Might assume that [Bug #81053](show_bug.cgi?id=81053 "RESOLVED FIXED - CVE-2014-3638: Flooding dbus-daemon with pending replies: denial of service") has been fixed first. ```  [Comment 23](show_bug.cgi?id=82820#c23)  Simon McVittie    2014-09-12 22:17:10 UTC  ``` CVE-2014-3636 has been allocated for this vulnerability (including both part A, described in [Comment #0](show_bug.cgi?id=82820#c0), and part B, covered in [Comment #9](show_bug.cgi?id=82820#c9)). ```  [Comment 24](show_bug.cgi?id=82820#c24)  Simon McVittie    2014-09-16 16:37:02 UTC  ``` Vulnerability fixed in 1.8.8, making public ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=82820)
* - Top of page

* + [Home](./)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

Use of freedesktop.org services, including Bugzilla, is subject to our [Code of Conduct](https://www.freedesktop.org/wiki/CodeOfConduct/). How we collect and use information is described in our [Privacy Policy](https://www.freedesktop.org/wiki/PrivacyPolicy).



=== Content from www.ubuntu.com_b4015ba8_20250110_161059.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2352-1: DBus vulnerabilities

22 September 2014

Several security issues were fixed in DBus.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [dbus](/security/cves?package=dbus) - simple interprocess messaging system

## Details

Simon McVittie discovered that DBus incorrectly handled the file

descriptors message limit. A local attacker could use this issue to cause

DBus to crash, resulting in a denial of service, or possibly execute

arbitrary code. This issue only applied to Ubuntu 12.04 LTS and Ubuntu

14.04 LTS. ([CVE-2014-3635](/security/CVE-2014-3635))

Alban Crequy discovered that DBus incorrectly handled a large number of

file descriptor messages. A local attacker could use this issue to cause

DBus to stop responding, resulting in a denial of service. This issue only

applied to Ubuntu 12.04 LTS and Ubuntu 14.04 LTS. ([CVE-2014-3636](/security/CVE-2014-3636))

Alban Crequy discovered that DBus incorrectly handled certain file

descriptor messages. A local attacker could use this issue to cause DBus

to maintain persistent connections, possibly resulting in a denial of

service. This issue only applied to Ubuntu 12.04 LTS and Ubuntu 14.04 LTS.

([CVE-2014-3637](/security/CVE-2014-3637))

Alban Crequy discovered that DBus incorrectly handled a large number of

parallel connections and parallel message calls. A local attacker could use

this issue to cause DBus to consume resources, possibly resulting in a

denial of service. ([CVE-2014-3638](/security/CVE-2014-3638))

Alban Crequy discovered that DBus incorrectly handled incomplete

connections. A local attacker could use this issue to cause DBus to fail

legitimate connection attempts, resulting in a denial of service.

([CVE-2014-3639](/security/CVE-2014-3639))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 14.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.6.18-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/dbus/1.6.18-0ubuntu4.2)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.6.18-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/dbus/1.6.18-0ubuntu4.2)

##### Ubuntu 12.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.4.18-1ubuntu1.6](https://launchpad.net/ubuntu/%2Bsource/dbus/1.4.18-1ubuntu1.6)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.4.18-1ubuntu1.6](https://launchpad.net/ubuntu/%2Bsource/dbus/1.4.18-1ubuntu1.6)

##### Ubuntu 10.04

* [dbus](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.2.16-2ubuntu4.8](https://launchpad.net/ubuntu/%2Bsource/dbus/1.2.16-2ubuntu4.8)
* [libdbus-1-3](https://launchpad.net/ubuntu/%2Bsource/dbus)
  -
  [1.2.16-2ubuntu4.8](https://launchpad.net/ubuntu/%2Bsource/dbus/1.2.16-2ubuntu4.8)

After a standard system update you need to reboot your computer to make all

the necessary changes.

## References

* [CVE-2014-3635](/security/CVE-2014-3635)
* [CVE-2014-3636](/security/CVE-2014-3636)
* [CVE-2014-3637](/security/CVE-2014-3637)
* [CVE-2014-3638](/security/CVE-2014-3638)
* [CVE-2014-3639](/security/CVE-2014-3639)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.debian.org_232d5a33_20250110_161056.html ===


---

[[Date Prev](msg00212.html)][[Date Next](msg00214.html)]
[[Thread Prev](msg00212.html)][[Thread Next](msg00214.html)]
[[Date Index](maillist.html#00213)]
[[Thread Index](threads.html#00213)]

# [SECURITY] [DSA 3026-1] dbus security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3026-1] dbus security update
* *From*: Florian Weimer <fw@deneb.enyo.de>
* *Date*: Tue, 16 Sep 2014 20:34:09 +0200
* *Message-id*: <[[🔎]](/msgid-search/87bnqf9zz2.fsf%40mid.deneb.enyo.de) [87bnqf9zz2.fsf@mid.deneb.enyo.de](msg00213.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3026-1                   security@debian.org
<http://www.debian.org/security/>                            Florian Weimer
September 16, 2014                     <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : dbus
CVE ID         : CVE-2014-3635 CVE-2014-3636 CVE-2014-3637 CVE-2014-3638
                 CVE-2014-3639

Alban Crequy and Simon McVittie discovered several vulnerabilities in
the D-Bus message daemon.

CVE-2014-3635

    On 64-bit platforms, file descriptor passing could be abused by
    local users to cause heap corruption in the dbus-daemon crash,
    leading to a crash, or potentially to arbitrary code execution.

CVE-2014-3636

    A denial-of-service vulnerability in dbus-daemon allowed local
    attackers to prevent new connections to dbus-daemon, or disconnect
    existing clients, by exhausting descriptor limits.

CVE-2014-3637

    Malicious local users could create D-Bus connections to
    dbus-daemon which could not be terminated by killing the
    participating processes, resulting in a denial-of-service
    vulnerability.

CVE-2014-3638

    dbus-daemon suffered from a denial-of-service vulnerability in the
    code which tracks which messages expect a reply, allowing local
    attackers to reduce the performance of dbus-daemon.

CVE-2014-3639

    dbus-daemon did not properly reject malicious connections from
    local users, resulting in a denial-of-service vulnerability.

For the stable distribution (wheezy), these problems have been fixed in
version 1.6.8-1+deb7u4.

For the unstable distribution (sid), these problems have been fixed in
version 1.8.8-1.

We recommend that you upgrade your dbus packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQEcBAEBAgAGBQJUGIrzAAoJEL97/wQC1SS+bgAH/2v7suJ3q6QQ9r8dpK3wlYtC
n6DrrqHvzECB0oEro51cvkHY9cl8HSYlKZoRXdbluEaHGCu+8f/IZ0aQIC2hkz1e
Cqh62l4Gzo+CZRmnDk4oTi2PcqnEXkIJgOo7pEDT4C9+4c5sF+vbLkAJ+x4VoRbf
eneYNgwIPGh8pyvw9VrMzTJAE81j5fZC5g6jxFfQCCOfo6IZlxKhn+d5XCElDz1f
yO4oeczxOkH0oHUo0Jo6Kd2RllbTbO9F+f2PVTOPRAvr1yqEj1zRtll0kA2vXZ0p
13pcZd3F/AWYDF8O5slOPZulx8GmVDETir2Jd8bPCduv7C4DPN9x8MA2IoYV668=
=Cvxc
-----END PGP SIGNATURE-----

```

---



=== Content from www.mandriva.com_882a8d89_20250110_161059.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.openwall.com_e530aef7_20250110_161059.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <54185FAF.6010601@collabora.co.uk>
Date: Tue, 16 Sep 2014 17:05:03 +0100
From: Simon McVittie <simon.mcvittie@...labora.co.uk>
To: oss-security@...ts.openwall.com
Subject: CVE-2014-3635 to 3639: security issues in D-Bus < 1.8.8

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

D-Bus <<http://www.freedesktop.org/wiki/Software/dbus/>> is an
asynchronous inter-process communication system, commonly used
for system services or within a desktop session on Linux and other
operating systems.

Alban Crequy and Simon McVittie at Collabora Ltd. discovered and fixed
several security flaws in the reference implementation of
dbus-daemon, the D-Bus message bus daemon. fd.o #83622 is a heap
overflow and could potentially be exploited to alter data or executable
code; the rest are denial-of-service issues.

For the stable branch these are fixed in dbus 1.8.8.

For the old stable branch, these are fixed in dbus 1.6.24. Older
branches are not supported.

CVE-2014-3635 (fd.o #83622)
- ---------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=83622>
Category: CWE-805: Buffer Access with Incorrect Length Value
Impact: heap data corruption, worst-case: arbitrary code execution
Access required: local
Mitigation: 32-bit platforms are not vulnerable
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Simon McVittie

When using the default Unix-socket-based transport, dbus-daemon accepts
and forwards file descriptors (fds) attached to D-Bus messages
("fd-passing"). If the max_message_unix_fds limit is set to an odd
number on 64-bit platforms, a malicious message-sender could pass one
more fd through the kernel than the recipient is expecting. This causes
an assertion failure and dbus-daemon crash if assertions are enabled, or
a buffer overrun by sizeof (int) otherwise.

This has been resolved by passing the desired maximum size to the
syscall instead of the rounded-up size of the cmsg buffer, and
discarding any excess fds if the syscall fills the cmsg buffer anyway.

CVE-2014-3636 (fd.o#82820, parts A and B)
- -----------------------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=82820>
Category: CWE-774: Allocation of File Descriptors or Handles
Without Limits or Throttling
Impact: denial of service
Access required: local
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Alban Crequy

The default limits for the system bus allowed each uid to open 256
connections to the system bus, and allowed up to 1024 fds per message,
and up to 4096 fds queued in total on each connection.

(Part A) By queuing up the maximum allowed number of fds, a malicious
sender could reach the dbus-daemon's RLIMIT_NOFILE (ulimit -n, typically
65536 on Linux). This would act as a denial of service in two ways:

* new clients would be unable to connect to the dbus-daemon
* when receiving a subsequent message from a non-malicious client that
  contained a fd, dbus-daemon would receive the MSG_CTRUNC flag,
  indicating that the list of fds was truncated; kernel fd-passing APIs
  do not provide any way to recover from that, so dbus-daemon responds
  to MSG_CTRUNC by disconnecting the sender, causing denial of service
  to that sender

(Part B) Additionally, Linux allows up to 253 fds to be sent in a single
sendmsg() call; libdbus always sends all of a message's fds, and the
beginning of the message itself, in a single sendmsg() call. Combining
these two, a malicious sender could split a message across two or more
sendmsg() calls to construct a composite message with 254 or more fds.
When dbus-daemon attempted to relay that message to its
recipient in a single sendmsg() call, it would receive EINVAL,
interpret that as a fatal socket error and disconnect the recipient,
resulting in denial of service.

Both of these related issues have been resolved by changing the defaults
so up to 16 fds are allowed per message, and up to 64 on each
connection. This means that each uid can only queue up to 16384 fds, and
denial of service is only possible if several uids cooperate.

Since this limit might be changed further in future, the D-Bus
maintainers recommend that designers of D-Bus APIs, particularly on the
system bus, do not rely on being able to send more than one fd per
message.

Distributors on operating systems with a smaller default RLIMIT_NOFILE
should consider adjusting either that limit, or the defaults in
system.conf.

CVE-2014-3637 (fd.o#80559)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80559>
Category: CWE-775: Missing Release of File Descriptor or Handle after
Effective Lifetime
Impact: denial of service
Access required: local
Versions believed to be vulnerable: dbus >= 1.3.0
Credit: discovered and fixed by Alban Crequy

By attaching the file descriptor of a D-Bus connection to a D-Bus
message and sending that message via the dbus-daemon, a malicious
process can create D-Bus connections that persist after the process that
created them has terminated. This exacerbates various patterns of
undesirable/abusive behaviour by making it impossible to terminate them
by killing processes.

This has been addressed by closing any connection that has incoming file
descriptors queued for deserialization for more than a configurable
timeout, defaulting to 2.5 minutes.

CVE-2014-3638 (fd.o#81053)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=81053>
Category: CWE-407: Algorithmic Complexity
Impact: denial of service
Access required: local
Versions believed to be vulnerable: all dbus releases
Credit: discovered and fixed by Alban Crequy

dbus-daemon tracks whether method call messages expect a reply, so that
unsolicited replies can be dropped. As currently implemented, if there
are n parallel method calls in progress, each method reply takes O(n)
CPU time. A malicious user can exploit this by opening the maximum
allowed number of parallel connections and sending the maximum number of
parallel method calls on each one, causing subsequent method calls to be
unreasonably slow, a denial of service.

For the short term, this has been resolved by amending the default
system bus configuration to reduce the number of parallel method calls
allowed per connection, from 8192 to 128 (i.e. from 2097152 to 32768 per
uid).

Longer-term, we plan to use better data structures to make dbus-daemon
more scalable, but this was not felt to be suitable for a minimal
security patch.

CVE-2014-3639 (fd.o#80919)
- --------------------------

Bug: <https://bugs.freedesktop.org/show_bug.cgi?id=80919>
Category: CWE-774: Allocation of File Descriptors or Handles Without
Limits or Throttling
Impact: denial of service
Access required: local
Versions believed to be vulnerable: all dbus releases
Credit: discovered and fixed by Alban Crequy

dbus-daemon allows a small number of "incomplete" connections (64 by
default) whose identity has not yet been confirmed. When this limit has
been reached, subsequent connections are dropped. Alban's testing
indicates that one malicious process that makes repeated connection
attempts, but never completes the authentication handshake and instead
waits for dbus-daemon to time out and disconnect it, can cause the
majority of legitimate connection attempts to fail.

This has been resolved by reducing the default authentication timeout
from 30 seconds to 5 seconds, and pausing calls to accept() when the
maximum number of incomplete connections is reached, resulting in
subsequent connections being queued in the kernel (blocking in
connect()) instead of being dropped.

- --
Simon McVittie, Collabora Ltd.
on behalf of the D-Bus maintainers

-----BEGIN PGP SIGNATURE-----

iQIVAwUBVBhfoE3o/ypjx8yQAQiqjw//T5IZyg8ZTzJZWybeZfaSCkLymcYf+7rf
uCavmRs507UtDhqRkd0cuFuM0GdEZVRQsFp4jiDOyZTPLr6SWmZJuBisHBzlFsTd
1zwX72mZL5rYEvkIgnq22Jhs0RHg50Ok+tL8Ld8Lcdhm2SR4SnCubGoV+pwmid5+
1rjBZc3/YVJ38vMPJDddYKfMidIdprnbpkGtq2jP+IVZFBab2VcHY5I6oB9OzKF/
EyT4a760TJOug5aAT5Yog++lvZ+UoRf7QOLlsvgARi8HHY7rWXikbs1/Eh3I2O//
3YadlgrsgibnmnCNYMCSKaR806FaUPD9AYe0G6u8AAcOKvMBg531RSMlENkmPOW5
WklMyCyfIFMJeOFdc6Vc6G3fAaSc9KX3pbJPVb7cfnuzHWhRnye3quHo1pEWP6EL
liFBDAtRg51EaD6bMgAEvsFkUSPEltMX2i0piQ7Uh6vTXTJvndq2APlW1w8hHKKn
MoJ/z1IEwCdYD34H48ddvJZptvZgbEGnTXxhQcs23kKvWt8vYnnidKbvWxctchmC
EvPv+6Clpnyp5cSkK0UJPxV1Bcc3rzsNK+JX5HMbSadoxwOBYj2efEdedqJ0ZapZ
430xawijqcFp9jB+tEztGyK/gnHclIUKeFyawCh2DQqGsoD9tSaHYeFz3C8SxssV
hnPsLAl1KbI=
=U6YK
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


