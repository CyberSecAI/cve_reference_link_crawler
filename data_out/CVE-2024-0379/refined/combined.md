=== Content from www.wordfence.com_16971a7e_20250110_190253.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Custom Twitter Feeds – A Tweets Widget or X Feed Widget <= 2.2.1 - Cross-Site Request Forgery to Plugin Options Update

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Custom Twitter Feeds – A Tweets Widget or X Feed Widget <= 2.2.1 - Cross-Site Request Forgery to Plugin Options Update

4.3

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)

| CVE | [CVE-2024-0379](https://www.cve.org/CVERecord?id=CVE-2024-0379) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | February 6, 2024 |
| Last Updated | February 20, 2024 |
| Researchers | [Rhynorater - Critical Thinking Podcast](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/rhynorater)  [kodaichodai](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/kodai-kubono) |

### Description

The Custom Twitter Feeds – A Tweets Widget or X Feed Widget plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.2.1. This is due to missing or incorrect nonce validation on the ctf\_auto\_save\_tokens function. This makes it possible for unauthenticated attackers to update the site's twitter API token and secret via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3032345%40custom-twitter-feeds%2Ftrunk&new=3032345%40custom-twitter-feeds%2Ftrunk&sfp_email=&sfph_mail=#file3)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcustom-twitter-feeds%2Fcustom-twitter-feeds-a-tweets-widget-or-x-feed-widget-221-cross-site-request-forgery-to-plugin-options-update&t=Custom%20Twitter%20Feeds%20%E2%80%93%20A%20Tweets%20Widget%20or%20X%20Feed%20Widget%20%3C%3D%202.2.1%20-%20Cross-Site%20Request%20Forgery%20to%20Plugin%20Options%20Update "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcustom-twitter-feeds%2Fcustom-twitter-feeds-a-tweets-widget-or-x-feed-widget-221-cross-site-request-forgery-to-plugin-options-update&text=Custom%20Twitter%20Feeds%20%E2%80%93%20A%20Tweets%20Widget%20or%20X%20Feed%20Widget%20%3C%3D%202.2.1%20-%20Cross-Site%20Request%20Forgery%20to%20Plugin%20Options%20Update "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcustom-twitter-feeds%2Fcustom-twitter-feeds-a-tweets-widget-or-x-feed-widget-221-cross-site-request-forgery-to-plugin-options-update "LinkedIn")
Email

## Vulnerability Details for Custom Twitter Feeds – A Tweets Widget or X Feed Widget

#### [Custom Twitter Feeds – A Tweets Widget or X Feed Widget](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/custom-twitter-feeds)

| Software Type | Plugin |
| --- | --- |
| Software Slug | custom-twitter-feeds [(view on wordpress.org)](https://wordpress.org/plugins/custom-twitter-feeds) |
| Patched? | Yes |
| Remediation | Update to version 2.2.2, or a newer patched version |
| Affected Version | * <= 2.2.1 |
| Patched Version | * 2.2.2 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_0ac05ab9_20250110_190250.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fcustom-twitter-feeds%2Ftrunk%2Fcustom-twitter-feed.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=3162196 "Revision 3162196")
* Next Revision →
* [Blame](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/custom-twitter-feeds/trunk/custom-twitter-feed.php)

---

# [source:](/browser?order=name "Go to repository root") [custom-twitter-feeds](/browser/custom-twitter-feeds?order=name "View custom-twitter-feeds")/[trunk](/browser/custom-twitter-feeds/trunk?order=name "View trunk")/[custom-twitter-feed.php](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?order=name "View custom-twitter-feed.php")

View diff against:

View revision:

| [Last change](/changeset/3192546/custom-twitter-feeds/trunk/custom-twitter-feed.php "View differences") on this file was [3192546](/changeset/3192546/ "View changeset 3192546"), checked in by nabilsmashballoon, [7 weeks ago](/timeline?from=2024-11-19T18%3A06%3A13Z&precision=second "See timeline at 11/19/2024 06:06:13 PM") |
| --- |
| * Tweak: Added support for our new [Feed Analytics]([​https://smashballoon.com/?utm\_campaign=twitter-free-readme&utm\_source=changelog&utm\_medium=feedanalyticsannouncement](https://smashballoon.com/?utm_campaign=twitter-free-readme&utm_source=changelog&utm_medium=feedanalyticsannouncement)) product. Get insights as to how your feeds are being used by site visitors. |
| **File size:** 44.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: Custom Twitter Feeds |
| [4](#L4) | Plugin URI: https://smashballoon.com/custom-twitter-feeds |
| [5](#L5) | Description: Customizable X Feeds, formerly known as Twitter feeds, for your website |
| [6](#L6) | Version: 2.2.5 |
| [7](#L7) | Author: Smash Balloon |
| [8](#L8) | Author URI: https://smashballoon.com/ |
| [9](#L9) | Text Domain: custom-twitter-feeds |
| [10](#L10) | \*/ |
| [11](#L11) | /\* |
| [12](#L12) | Copyright 2024 Smash Balloon LLC (email : hey@smashballoon.com) |
| [13](#L13) | This program is free software; you can redistribute it and/or modify |
| [14](#L14) | it under the terms of the GNU General Public License as published by |
| [15](#L15) | the Free Software Foundation; either version 2 of the License, or |
| [16](#L16) | (at your option) any later version. |
| [17](#L17) | This program is distributed in the hope that it will be useful, |
| [18](#L18) | but WITHOUT ANY WARRANTY; without even the implied warranty of |
| [19](#L19) | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the |
| [20](#L20) | GNU General Public License for more details. |
| [21](#L21) | You should have received a copy of the GNU General Public License |
| [22](#L22) | along with this program; if not, write to the Free Software |
| [23](#L23) | Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA |
| [24](#L24) | \*/ |
| [25](#L25) |  |
| [26](#L26) | if ( ! defined( 'CTF\_URL' ) ) { |
| [27](#L27) | // Use smash Twitter if API V2 credentials are not defined. |
| [28](#L28) | $ctf\_options = get\_option('ctf\_options', array()); |
| [29](#L29) | define( 'CTF\_DOING\_SMASH\_TWITTER', empty($ctf\_options['consumer\_key']) && empty($ctf\_options['consumer\_secret'])); |
| [30](#L30) |  |
| [31](#L31) | define( 'CTF\_URL', plugin\_dir\_path( \_\_FILE\_\_ )  ); |
| [32](#L32) | define( 'CTF\_VERSION', '2.2.5' ); |
| [33](#L33) | define( 'CTF\_TITLE', 'Custom Twitter Feeds' ); |
| [34](#L34) | define( 'CTF\_JS\_URL', plugins\_url( '/js/ctf-scripts.min.js?ver=' . CTF\_VERSION , \_\_FILE\_\_ ) ); |
| [35](#L35) | define( 'CTF\_PRODUCT\_NAME', 'Custom Twitter Feeds' ); |
| [36](#L36) | } |
| [37](#L37) |  |
| [38](#L38) | if ( ! defined( 'CTF\_SITE\_ACCESS\_TOKEN\_KEY' ) ) { |
| [39](#L39) | define( 'CTF\_SITE\_ACCESS\_TOKEN\_KEY', 'site\_access\_token\_free' ); |
| [40](#L40) | } |
| [41](#L41) | if ( ! defined( 'SMASH\_TWITTER\_URL' ) ) { |
| [42](#L42) | define( 'SMASH\_TWITTER\_URL', 'https://ctf.smashballoon.com/api/' ); |
| [43](#L43) | } |
| [44](#L44) | if ( ! defined( 'SMASH\_TWITTER\_TIMELINE\_PATH' ) ) { |
| [45](#L45) | define( 'SMASH\_TWITTER\_TIMELINE\_PATH', '1.1/timeline' ); |
| [46](#L46) | } |
| [47](#L47) |  |
| [48](#L48) | if ( ! defined( 'SMASH\_TWITTER\_URL\_EXTRA\_GET\_PARAMS' ) ) { |
| [49](#L49) | define( 'SMASH\_TWITTER\_URL\_EXTRA\_GET\_PARAMS', '' ); |
| [50](#L50) | } |
| [51](#L51) |  |
| [52](#L52) | if ( ! defined( 'OAUTH\_PROCESSOR\_URL' ) ) { |
| [53](#L53) | define( 'OAUTH\_PROCESSOR\_URL', 'https://connect.smashballoon.com/auth/tw/' ); |
| [54](#L54) | } |
| [55](#L55) |  |
| [56](#L56) | if ( ! defined( 'CTF\_PLUGIN\_NAME' ) ) { |
| [57](#L57) | define( 'CTF\_PLUGIN\_NAME', 'Custom Twitter Feeds' ); |
| [58](#L58) | } |
| [59](#L59) |  |
| [60](#L60) | // Plugin Folder Path. |
| [61](#L61) | if ( ! defined( 'CTF\_PLUGIN\_DIR' ) ) { |
| [62](#L62) | define( 'CTF\_PLUGIN\_DIR', plugin\_dir\_path( \_\_FILE\_\_ ) ); |
| [63](#L63) | } |
| [64](#L64) | // Plugin Folder URL. |
| [65](#L65) | if ( ! defined( 'CTF\_PLUGIN\_URL' ) ) { |
| [66](#L66) | define( 'CTF\_PLUGIN\_URL', plugin\_dir\_url( \_\_FILE\_\_ ) ); |
| [67](#L67) | } |
| [68](#L68) | // Db version. |
| [69](#L69) | if ( ! defined( 'CTF\_DBVERSION' ) ) { |
| [70](#L70) | define( 'CTF\_DBVERSION', '1.5' ); |
| [71](#L71) | } |
| [72](#L72) | if ( ! defined( 'CTF\_FEED\_LOCATOR' ) ) { |
| [73](#L73) | define( 'CTF\_FEED\_LOCATOR', 'ctf\_feed\_locator' ); |
| [74](#L74) | } |
| [75](#L75) |  |
| [76](#L76) | if ( ! defined( 'CTF\_BUILDER\_DIR' ) ) { |
| [77](#L77) | define( 'CTF\_BUILDER\_DIR', CTF\_PLUGIN\_DIR . 'admin/builder/' ); |
| [78](#L78) | } |
| [79](#L79) | if ( ! defined( 'CTF\_BUILDER\_URL' ) ) { |
| [80](#L80) | define( 'CTF\_BUILDER\_URL', CTF\_PLUGIN\_URL . 'admin/builder/' ); |
| [81](#L81) | } |
| [82](#L82) | if ( ! defined( 'CTF\_UPLOADS\_NAME' ) ) { |
| [83](#L83) | define( 'CTF\_UPLOADS\_NAME', 'sb-twitter-feed-images' ); |
| [84](#L84) | } |
| [85](#L85) |  |
| [86](#L86) | if ( ! defined( 'CTF\_PLUGIN\_NAME' ) ) { |
| [87](#L87) | define( 'CTF\_PLUGIN\_NAME', 'Custom Twitter Feed Free' ); |
| [88](#L88) | } |
| [89](#L89) | if ( ! defined( 'CTF\_FEEDS\_POSTS\_TABLE' ) ) { |
| [90](#L90) | define( 'CTF\_FEEDS\_POSTS\_TABLE', 'ctf\_feeds\_posts' ); |
| [91](#L91) | } |
| [92](#L92) | if ( ! defined( 'CTF\_POSTS\_TABLE' ) ) { |
| [93](#L93) | define( 'CTF\_POSTS\_TABLE', 'ctf\_posts' ); |
| [94](#L94) | } |
| [95](#L95) | if ( ! defined( 'CTF\_LICENSE\_URL' ) ) { |
| [96](#L96) | define( 'CTF\_LICENSE\_URL', 'https://smashballoon.com/' ); |
| [97](#L97) | } |
| [98](#L98) |  |
| [99](#L99) | if ( ! defined( 'CTF\_PLUGIN\_BASENAME' ) ) { |
| [100](#L100) | define( 'CTF\_PLUGIN\_BASENAME', plugin\_basename( \_\_FILE\_\_ ) ); |
| [101](#L101) | } |
| [102](#L102) |  |
| [103](#L103) | if ( ! defined( 'ABSPATH' ) ) exit; // Exit if accessed directly |
| [104](#L104) |  |
| [105](#L105) | if ( version\_compare( phpversion(), '5.6', '<' ) ) { |
| [106](#L106) | if( !function\_exists( 'ctf\_check\_php\_notice' ) ){ |
| [107](#L107) | function ctf\_check\_php\_notice(){ ?> |
| [108](#L108) | <div class="notice notice-error"> |
| [109](#L109) | <div> |
| [110](#L110) | <p><strong><?php echo esc\_html\_\_('Important:','custom-twitter-feeds') ?> </strong><?php echo esc\_html\_\_('Your website is using an outdated version of PHP. The Custom Twitter Feeds plugin requires PHP version 5.6 or higher and so has been temporarily deactivated.','custom-twitter-feeds') ?></p> |
| [111](#L111) |  |
| [112](#L112) | <p> |
| [113](#L113) | <?php |
| [114](#L114) | echo esc\_html\_\_('To continue using the plugin','custom-twitter-feeds') . ', '; |
| [115](#L115) |  |
| [116](#L116) | echo \_\_('you can either manually reinstall the previous version of the plugin ','custom-twitter-feeds' ); |
| [117](#L117) |  |
| [118](#L118) | echo esc\_html\_\_('or contact your host to request that they upgrade your PHP version to 5.6 or higher.','custom-twitter-feeds'); |
| [119](#L119) | ?> |
| [120](#L120) | </p> |
| [121](#L121) | </div> |
| [122](#L122) | </div> |
| [123](#L123) | <?php |
| [124](#L124) | } |
| [125](#L125) | } |
| [126](#L126) | add\_action( 'admin\_notices', 'ctf\_check\_php\_notice' ); |
| [127](#L127) | return; //Stop until PHP version is fixed |
| [128](#L128) | } |
| [129](#L129) |  |
| [130](#L130) | require\_once( CTF\_URL . '/inc/widget.php' ); |
| [131](#L131) |  |
| [132](#L132) | require\_once( CTF\_URL . '/inc/admin-hooks.php' ); |
| [133](#L133) |  |
| [134](#L134) | function ctf\_plugin\_init() { |
| [135](#L135) | require\_once trailingslashit( CTF\_PLUGIN\_DIR ) . 'inc/blocks/class-ctf-blocks.php'; |
| [136](#L136) |  |
| [137](#L137) | $ctf\_blocks = new CTF\_Blocks(); |
| [138](#L138) |  |
| [139](#L139) | if ( $ctf\_blocks->allow\_load() ) { |
| [140](#L140) | $ctf\_blocks->load(); |
| [141](#L141) | } |
| [142](#L142) |  |
| [143](#L143) | require                         trailingslashit( CTF\_PLUGIN\_DIR ) . 'vendor/autoload.php'; |
| [144](#L144) | include\_once            trailingslashit( CTF\_PLUGIN\_DIR ) . '/inc/ctf-functions.php'; |
| [145](#L145) |  |
| [146](#L146) | if ( is\_admin() ) { |
| [147](#L147) | if ( version\_compare( PHP\_VERSION,  '5.3.0' ) >= 0 |
| [148](#L148) | && version\_compare( get\_bloginfo('version'), '4.6' , '>' ) ) { |
| [149](#L149) | $ctf\_notifications = new TwitterFeed\Admin\CTF\_Notifications(); |
| [150](#L150) | $ctf\_notifications->init(); |
| [151](#L151) |  |
| [152](#L152) | $ctf\_new\_user = new TwitterFeed\Admin\CTF\_New\_User(); |
| [153](#L153) | $ctf\_new\_user->init(); |
| [154](#L154) |  |
| [155](#L155) | $ctf\_global\_settings    = new TwitterFeed\Admin\CTF\_Global\_Settings(); |
| [156](#L156) | $ctf\_admin\_notices              = new TwitterFeed\Admin\CTF\_Admin\_Notices(); |
| [157](#L157) | $ctf\_tooltip\_wizard             = new TwitterFeed\Builder\CTF\_Tooltip\_Wizard(); |
| [158](#L158) | $ctf\_support                    = new TwitterFeed\Admin\CTF\_Support(); |
| [159](#L159) | $ctf\_admin\_notices              = new TwitterFeed\Admin\CTF\_Admin\_Notices(); |
| [160](#L160) | $ctf\_about\_us                   = new TwitterFeed\Admin\CTF\_About\_Us(); |
| [161](#L161) |  |
| [162](#L162) |  |
| [163](#L163) | require\_once trailingslashit( CTF\_PLUGIN\_DIR ) . 'inc/Admin/addon-functions.php'; |
| [164](#L164) | } |
| [165](#L165) | } |
| [166](#L166) | require\_once trailingslashit( CTF\_PLUGIN\_DIR ) . 'inc/Admin/CTF\_Upgrader.php'; |
| [167](#L167) | $ctf\_upgrader = new TwitterFeed\Admin\CTF\_Upgrader(); |
| [168](#L168) | $ctf\_upgrader->hooks(); |
| [169](#L169) |  |
| [170](#L170) |  |
| [171](#L171) | $cron\_update\_manager = new \TwitterFeed\SmashTwitter\CronUpdaterManager(); |
| [172](#L172) | $cron\_update\_manager->hooks(); |
| [173](#L173) |  |
| [174](#L174) | $error\_reporter = new \TwitterFeed\SmashTwitter\Services\ErrorReporterService(); |
| [175](#L175) | $error\_reporter->init\_hooks(); |
| [176](#L176) | } |
| [177](#L177) | add\_action( 'plugins\_loaded', 'ctf\_plugin\_init' ); |
| [178](#L178) |  |
| [179](#L179) | include\_once trailingslashit( CTF\_PLUGIN\_DIR ) . '/inc/Builder/CTF\_Feed\_Builder.php'; |
| [180](#L180) |  |
| [181](#L181) |  |
| [182](#L182) | function ctf\_update\_settings() { |
| [183](#L183) | $existing\_deprecated\_options = get\_option( 'ctf\_configure' ); |
| [184](#L184) | $existing\_options = get\_option( 'ctf\_options' ); |
| [185](#L185) |  |
| [186](#L186) | update\_option( 'ctf\_version', CTF\_VERSION ); |
| [187](#L187) |  |
| [188](#L188) | if ( ! empty( $existing\_deprecated\_options ) && empty( $existing\_options ) ) { |
| [189](#L189) | $merged\_options = $existing\_deprecated\_options; |
| [190](#L190) | $merged\_options = array\_merge( $merged\_options, get\_option( 'ctf\_customize', array() ) ); |
| [191](#L191) | $merged\_options = array\_merge( $merged\_options, get\_option( 'ctf\_style', array() ) ); |
| [192](#L192) |  |
| [193](#L193) | update\_option( 'ctf\_options', $merged\_options ); |
| [194](#L194) | } |
| [195](#L195) | } |
| [196](#L196) |  |
| [197](#L197) | function ctf\_check\_for\_db\_updates() { |
| [198](#L198) |  |
| [199](#L199) | $db\_ver = get\_option( 'ctf\_db\_version', 0 ); |
| [200](#L200) |  |
| [201](#L201) | if ( (float) $db\_ver < 1.0 ) { |
| [202](#L202) | global $wp\_roles; |
| [203](#L203) | $wp\_roles->add\_cap( 'administrator', 'manage\_twitter\_feed\_options' ); |
| [204](#L204) |  |
| [205](#L205) | $ctf\_statuses\_option = get\_option( 'ctf\_statuses', array() ); |
| [206](#L206) |  |
| [207](#L207) | if ( ! isset( $ctf\_statuses\_option['first\_install'] ) ) { |
| [208](#L208) |  |
| [209](#L209) | $options\_set = get\_option( 'ctf\_options', false ); |
| [210](#L210) |  |
| [211](#L211) | if ( $options\_set ) { |
| [212](#L212) | $ctf\_statuses\_option['first\_install'] = 'from\_update'; |
| [213](#L213) | } else { |
| [214](#L214) | $ctf\_statuses\_option['first\_install'] = time(); |
| [215](#L215) | } |
| [216](#L216) |  |
| [217](#L217) | $ctf\_rating\_notice\_option = get\_option( 'ctf\_rating\_notice', false ); |
| [218](#L218) |  |
| [219](#L219) | if ( $ctf\_rating\_notice\_option === 'dismissed' ) { |
| [220](#L220) | $ctf\_statuses\_option['rating\_notice\_dismissed'] = time(); |
| [221](#L221) | } |
| [222](#L222) |  |
| [223](#L223) | $ctf\_rating\_notice\_waiting = get\_transient( 'custom\_twitter\_feeds\_rating\_notice\_waiting' ); |
| [224](#L224) |  |
| [225](#L225) | if ( $ctf\_rating\_notice\_waiting === false |
| [226](#L226) | && $ctf\_rating\_notice\_option === false ) { |
| [227](#L227) | $time = 2 \* WEEK\_IN\_SECONDS; |
| [228](#L228) | set\_transient( 'custom\_twitter\_feeds\_rating\_notice\_waiting', 'waiting', $time ); |
| [229](#L229) | update\_option( 'ctf\_rating\_notice', 'pending', false ); |
| [230](#L230) | } |
| [231](#L231) |  |
| [232](#L232) | update\_option( 'ctf\_statuses', $ctf\_statuses\_option, false ); |
| [233](#L233) |  |
| [234](#L234) | } |
| [235](#L235) |  |
| [236](#L236) | update\_option( 'ctf\_db\_version', CTF\_DBVERSION ); |
| [237](#L237) | } |
| [238](#L238) |  |
| [239](#L239) | if ( version\_compare( $db\_ver, '1.0.1', '<' ) ) { |
| [240](#L240) | TwitterFeed\CTF\_Feed\_Locator::create\_table(); |
| [241](#L241) | update\_option( 'ctf\_db\_version', CTF\_DBVERSION ); |
| [242](#L242) | } |
| [243](#L243) |  |
| [244](#L244) | // For v2.0 |
| [245](#L245) | if ( version\_compare( $db\_ver, '1.4', '<' ) ) { |
| [246](#L246) | update\_option( 'ctf\_db\_version', CTF\_DBVERSION ); |
| [247](#L247) | \TwitterFeed\Builder\CTF\_Db::create\_tables(); |
| [248](#L248) | $ctf\_statuses\_option = get\_option( 'ctf\_statuses', array() ); |
| [249](#L249) | $ctf\_options         = get\_option( 'ctf\_options', array() ); |
| [250](#L250) |  |
| [251](#L251) | if ( ! isset( $ctf\_statuses\_option['first\_install'] ) ) { |
| [252](#L252) |  |
| [253](#L253) | $options\_set = get\_option( 'ctf\_options', false ); |
| [254](#L254) |  |
| [255](#L255) | if ( $options\_set ) { |
| [256](#L256) | $ctf\_statuses\_option['first\_install'] = 'from\_update'; |
| [257](#L257) | } else { |
| [258](#L258) | $ctf\_statuses\_option['first\_install'] = time(); |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | $ctf\_rating\_notice\_option = get\_option( 'ctf\_rating\_notice', false ); |
| [262](#L262) |  |
| [263](#L263) | if ( $ctf\_rating\_notice\_option === 'dismissed' ) { |
| [264](#L264) | $ctf\_statuses\_option['rating\_notice\_dismissed'] = time(); |
| [265](#L265) | } |
| [266](#L266) |  |
| [267](#L267) | $ctf\_rating\_notice\_waiting = get\_transient( 'custom\_twitter\_feeds\_rating\_notice\_waiting' ); |
| [268](#L268) |  |
| [269](#L269) | if ( $ctf\_rating\_notice\_waiting === false |
| [270](#L270) | && $ctf\_rating\_notice\_option === false ) { |
| [271](#L271) | $time = 2 \* WEEK\_IN\_SECONDS; |
| [272](#L272) | set\_transient( 'custom\_twitter\_feeds\_rating\_notice\_waiting', 'waiting', $time ); |
| [273](#L273) | update\_option( 'ctf\_rating\_notice', 'pending', false ); |
| [274](#L274) | } |
| [275](#L275) | } |
| [276](#L276) |  |
| [277](#L277) | //Legacy feeds |
| [278](#L278) | $options\_support\_legacy = false; |
| [279](#L279) |  |
| [280](#L280) | if ( isset( $ctf\_options['access\_token'] ) && ! empty( $ctf\_options['access\_token'] ) ) { |
| [281](#L281) | $options\_support\_legacy = true; |
| [282](#L282) | $base\_settings = \TwitterFeed\CTF\_Settings::legacy\_shortcode\_atts( array(), $ctf\_options ); |
| [283](#L283) | update\_option( 'ctf\_legacy\_feed\_settings', ctf\_json\_encode( $base\_settings ), false ); |
| [284](#L284) | } |
| [285](#L285) | // how many legacy feeds? |
| [286](#L286) | $args = array( |
| [287](#L287) | 'html\_location' => array( 'header', 'footer', 'sidebar', 'content', 'unknown' ), |
| [288](#L288) | 'group\_by'      => 'shortcode\_atts', |
| [289](#L289) | 'page'          => 1, |
| [290](#L290) | ); |
| [291](#L291) |  |
| [292](#L292) | $feeds\_data                                      = \TwitterFeed\CTF\_Feed\_Locator::legacy\_twitter\_feed\_locator\_query( $args ); |
| [293](#L293) | $num\_legacy                                      = count( $feeds\_data ); |
| [294](#L294) | $ctf\_statuses\_option['support\_legacy\_shortcode'] = $options\_support\_legacy; |
| [295](#L295) | if ( $num\_legacy > 0 ) { |
| [296](#L296) | if ( $num\_legacy > 1 ) { |
| [297](#L297) | $ctf\_statuses\_option['legacy\_onboarding']        = array( |
| [298](#L298) | 'active' => true, |
| [299](#L299) | 'type'   => 'multiple', |
| [300](#L300) | ); |
| [301](#L301) | $ctf\_statuses\_option['support\_legacy\_shortcode'] = true; |
| [302](#L302) | } else { |
| [303](#L303) | $ctf\_statuses\_option['legacy\_onboarding'] = array( |
| [304](#L304) | 'active' => true, |
| [305](#L305) | 'type'   => 'single', |
| [306](#L306) | ); |
| [307](#L307) |  |
| [308](#L308) | $shortcode\_atts = ! empty( $feeds\_data[0] ) && $feeds\_data[0]['shortcode\_atts'] != '[""]' ? json\_decode( $feeds\_data[0]['shortcode\_atts'], true ) : array(); |
| [309](#L309) | $shortcode\_atts = is\_array( $shortcode\_atts ) ? $shortcode\_atts : array(); |
| [310](#L310) |  |
| [311](#L311) | $ctf\_statuses\_option['support\_legacy\_shortcode'] = $shortcode\_atts; |
| [312](#L312) |  |
| [313](#L313) | $shortcode\_atts['from\_update'] = true; |
| [314](#L314) |  |
| [315](#L315) | $db = ctf\_get\_database\_settings(); |
| [316](#L316) | $base\_settings = \TwitterFeed\CTF\_Settings::legacy\_shortcode\_atts( $shortcode\_atts, $db ); |
| [317](#L317) |  |
| [318](#L318) | $feed\_saver = new \TwitterFeed\Builder\CTF\_Feed\_Saver( false ); |
| [319](#L319) | $feed\_saver->set\_data( $base\_settings ); |
| [320](#L320) |  |
| [321](#L321) | $feed\_name = 'My Feed'; |
| [322](#L322) | $feed\_saver->set\_feed\_name( $feed\_name ); |
| [323](#L323) |  |
| [324](#L324) | $new\_feed\_id = $feed\_saver->update\_or\_insert(); |
| [325](#L325) |  |
| [326](#L326) | $args = array( |
| [327](#L327) | 'new\_feed\_id'    => $new\_feed\_id, |
| [328](#L328) | 'legacy\_feed\_id' => $feeds\_data[0]['feed\_id'], |
| [329](#L329) | ); |
| [330](#L330) |  |
| [331](#L331) | \TwitterFeed\CTF\_Feed\_Locator::update\_legacy\_to\_builder( $args ); |
| [332](#L332) | } |
| [333](#L333) | } elseif ( $num\_legacy === 0 && $options\_support\_legacy ) { |
| [334](#L334) | $ctf\_statuses\_option['support\_legacy\_shortcode'] = true; |
| [335](#L335) | } |
| [336](#L336) |  |
| [337](#L337) | update\_option( 'ctf\_statuses', $ctf\_statuses\_option, false ); |
| [338](#L338) | update\_option( 'ctf\_db\_version', CTF\_DBVERSION ); |
| [339](#L339) |  |
| [340](#L340) | if ( ! wp\_next\_scheduled( 'ctf\_feed\_update' ) ) { |
| [341](#L341) | wp\_schedule\_event( time() + 60, 'twicedaily', 'ctf\_feed\_update' ); |
| [342](#L342) | } |
| [343](#L343) |  |
| [344](#L344) | global $wp\_roles; |
| [345](#L345) | $wp\_roles->add\_cap( 'administrator', 'manage\_twitter\_feed\_options' ); |
| [346](#L346) |  |
| [347](#L347) | } |
| [348](#L348) |  |
| [349](#L349) | // For Smash Twitter |
| [350](#L350) | if ( version\_compare( $db\_ver, '1.5', '<' ) ) { |
| [351](#L351) | update\_option( 'ctf\_db\_version', CTF\_DBVERSION ); |
| [352](#L352) | global $wpdb; |
| [353](#L353) | ctf\_create\_database\_table(); |
| [354](#L354) | $table\_name = $wpdb->prefix . CTF\_FEEDS\_POSTS\_TABLE; |
| [355](#L355) |  |
| [356](#L356) | $wpdb->query( "ALTER TABLE $table\_name ADD COLUMN type VARCHAR(1000) DEFAULT '' NOT NULL" ); |
| [357](#L357) | $wpdb->query( "ALTER TABLE $table\_name ADD COLUMN term VARCHAR(1000) DEFAULT '' NOT NULL" ); |
| [358](#L358) | $wpdb->query( "ALTER TABLE $table\_name ADD INDEX type\_term (term(140),type(51))" ); |
| [359](#L359) |  |
| [360](#L360) | \TwitterFeed\SmashTwitter\CronUpdaterManager::schedule\_cron\_job(); |
| [361](#L361) |  |
| [362](#L362) | $ctf\_statuses\_option = get\_option( 'ctf\_statuses', array() ); |
| [363](#L363) | // to space out the API requests, we have the initial cron update scheduled a day + random number of hours. |
| [364](#L364) | $ctf\_statuses\_option['first\_cron\_update'] = mt\_rand(0,23) \* 3600 + time() + DAY\_IN\_SECONDS; |
| [365](#L365) | update\_option( 'ctf\_statuses', $ctf\_statuses\_option, false ); |
| [366](#L366) |  |
| [367](#L367) | update\_option( 'ctf\_db\_version', CTF\_DBVERSION ); |
| [368](#L368) |  |
| [369](#L369) | } |
| [370](#L370) |  |
| [371](#L371) | } |
| [372](#L372) | add\_action( 'wp\_loaded', 'ctf\_check\_for\_db\_updates' ); |
| [373](#L373) |  |
| [374](#L374) |  |
| [375](#L375) | /\*\* |
| [376](#L376) | \* include the admin files only if in the admin area |
| [377](#L377) | \*/ |
| [378](#L378) | if ( is\_admin() ) { |
| [379](#L379) |  |
| [380](#L380) | $ctf\_version = get\_option( 'ctf\_version', false ); |
| [381](#L381) |  |
| [382](#L382) | if ( ! $ctf\_version ) { |
| [383](#L383) | ctf\_update\_settings(); |
| [384](#L384) | } |
| [385](#L385) | require\_once( CTF\_URL . '/inc/CtfAdmin.php' ); |
| [386](#L386) | require\_once( CTF\_URL . '/inc/notices.php' ); |
| [387](#L387) |  |
| [388](#L388) | $admin = new CtfAdmin; |
| [389](#L389) | } |
| [390](#L390) |  |
| [391](#L391) | /\*\* |
| [392](#L392) | \* Generates the Twitter feed wherever the shortcode is placed |
| [393](#L393) | \* |
| [394](#L394) | \* @param $atts array shortcode arguments |
| [395](#L395) | \* |
| [396](#L396) | \* @return string |
| [397](#L397) | \*/ |
| [398](#L398) | function ctf\_init( $atts, $preview\_settings = false  ) { |
| [399](#L399) | wp\_enqueue\_script( 'ctf\_scripts' ); |
| [400](#L400) | $twitter\_feed = TwitterFeed\CtfFeed::init( $atts, null, 0, array(), 1, $preview\_settings); |
| [401](#L401) | if ( isset( $twitter\_feed->feed\_options['feederror'] ) && ! empty( $twitter\_feed->feed\_options['feederror'] ) ) { |
| [402](#L402) | return "<span id='ctf-no-id'>" . sprintf( \_\_( 'No feed found with the ID %1$s. Go to the %2$sAll Feeds page%3$s and select an ID from an existing feed.', 'custom-twitter-feeds' ), esc\_html( $twitter\_feed->feed\_options['feed'] ), '<a href="' . esc\_url( admin\_url( 'admin.php?page=ctf-feed-builder' ) ) . '">', '</a>' ) . '</span><br /><br />'; |
| [403](#L403) | } else { |
| [404](#L404) | // if there is an error, display the error html, otherwise the feed |
| [405](#L405) | if ( ! $twitter\_feed->tweet\_set || ($twitter\_feed->missing\_credentials && ! CTF\_DOING\_SMASH\_TWITTER) || ! isset( $twitter\_feed->tweet\_set[0]['created\_at'] ) ) { |
| [406](#L406) | if ( ! empty( $twitter\_feed->tweet\_set['errors'] ) ) { |
| [407](#L407) | $twitter\_feed->maybeCacheTweets(); |
| [408](#L408) | } else { |
| [409](#L409) | $twitter\_feed->maybeCacheTweets(true); |
| [410](#L410) | } |
| [411](#L411) | $feed\_html  = ''; |
| [412](#L412) | $feed\_html .= $twitter\_feed->getTweetSetHtml(); |
| [413](#L413) |  |
| [414](#L414) | return $feed\_html; |
| [415](#L415) | } else { |
| [416](#L416) | if ( ! $twitter\_feed->feed\_options['persistentcache'] ) { |
| [417](#L417) | $twitter\_feed->maybeCacheTweets(); |
| [418](#L418) | } |
| [419](#L419) | $feed\_html  = ''; |
| [420](#L420) | $feed\_html .= $twitter\_feed->getTweetSetHtml(); |
| [421](#L421) |  |
| [422](#L422) | return $feed\_html; |
| [423](#L423) | } |
| [424](#L424) | } |
| [425](#L425) | } |
| [426](#L426) | add\_shortcode( 'custom-twitter-feed', 'ctf\_init' ); |
| [427](#L427) | add\_shortcode( 'custom-twitter-feeds', 'ctf\_init' ); |
| [428](#L428) |  |
| [429](#L429) | /\*\* |
| [430](#L430) | \* Called via ajax to get more posts after the "load more" button is clicked |
| [431](#L431) | \*/ |
| [432](#L432) | function ctf\_get\_more\_posts() { |
| [433](#L433) | $shortcode\_data = json\_decode( str\_replace( '\"', '"', sanitize\_text\_field( $\_POST['shortcode\_data'] ) ), true ); // necessary to unescape quotes |
| [434](#L434) | $last\_id\_data = isset( $\_POST['last\_id\_data'] ) ? sanitize\_text\_field( $\_POST['last\_id\_data'] ) : ''; |
| [435](#L435) | $num\_needed = isset( $\_POST['num\_needed'] ) ? (int)$\_POST['num\_needed'] : 0; |
| [436](#L436) | $ids\_to\_remove = isset( $\_POST['ids\_to\_remove'] ) ? $\_POST['ids\_to\_remove'] : array(); |
| [437](#L437) | $feed           = isset( $\_POST['v2feed'] ) ? sanitize\_key( $\_POST['v2feed'] ) : ''; |
| [438](#L438) | if ( empty( $shortcode\_data ) ) { |
| [439](#L439) | $shortcode\_data = array(); |
| [440](#L440) | } |
| [441](#L441) | $shortcode\_data['feed'] = $feed; |
| [442](#L442) |  |
| [443](#L443) | $is\_pagination = empty( $last\_id\_data ) ? 0 : 1; |
| [444](#L444) | $persistent\_index = isset( $\_POST['persistent\_index'] ) ? sanitize\_text\_field( $\_POST['persistent\_index'] ) : ''; |
| [445](#L445) |  |
| [446](#L446) | $twitter\_feed = TwitterFeed\CtfFeed::init( $shortcode\_data, $last\_id\_data, $num\_needed, $ids\_to\_remove, $persistent\_index ); |
| [447](#L447) |  |
| [448](#L448) | if ( ! CTF\_DOING\_SMASH\_TWITTER && ! $twitter\_feed->feed\_options['persistentcache'] ) { |
| [449](#L449) | $twitter\_feed->maybeCacheTweets(); |
| [450](#L450) | } |
| [451](#L451) |  |
| [452](#L452) | $atts = $shortcode\_data; |
| [453](#L453) | $feed\_id = isset( $\_POST['feed\_id'] ) ? sanitize\_text\_field( $\_POST['feed\_id'] ) : 'unknown'; |
| [454](#L454) | $location = isset( $\_POST['location'] ) && in\_array( $\_POST['location'], array( 'header', 'footer', 'sidebar', 'content' ), true ) ? sanitize\_text\_field( $\_POST['location'] ) : 'unknown'; |
| [455](#L455) | $post\_id = isset( $\_POST['post\_id'] ) && $\_POST['post\_id'] !== 'unknown' ? (int)$\_POST['post\_id'] : 'unknown'; |
| [456](#L456) | $feed\_details = array( |
| [457](#L457) | 'feed\_id' => $feed\_id, |
| [458](#L458) | 'atts' => $atts, |
| [459](#L459) | 'location' => array( |
| [460](#L460) | 'post\_id' => $post\_id, |
| [461](#L461) | 'html' => $location |
| [462](#L462) | ) |
| [463](#L463) | ); |
| [464](#L464) |  |
| [465](#L465) | ctf\_do\_background\_tasks( $feed\_details ); |
| [466](#L466) |  |
| [467](#L467) | echo $twitter\_feed->getItemSetHtml( $is\_pagination ); |
| [468](#L468) |  |
| [469](#L469) | die(); |
| [470](#L470) | } |
| [471](#L471) | add\_action( 'wp\_ajax\_nopriv\_ctf\_get\_more\_posts', 'ctf\_get\_more\_posts' ); |
| [472](#L472) | add\_action( 'wp\_ajax\_ctf\_get\_more\_posts', 'ctf\_get\_more\_posts' ); |
| [473](#L473) |  |
| [474](#L474) | function ctf\_do\_locator() { |
| [475](#L475) | if ( ! isset( $\_POST['feed\_id'] ) || strpos( $\_POST['feed\_id'], 'ctf' ) === false ) { |
| [476](#L476) | die( 'invalid feed ID'); |
| [477](#L477) | } |
| [478](#L478) |  |
| [479](#L479) | $feed\_id = sanitize\_text\_field( $\_POST['feed\_id'] ); |
| [480](#L480) |  |
| [481](#L481) | $atts\_raw = isset( $\_POST['atts'] ) ? json\_decode( stripslashes( $\_POST['atts'] ), true ) : array(); |
| [482](#L482) | if ( is\_array( $atts\_raw ) ) { |
| [483](#L483) | array\_map( 'sanitize\_text\_field', $atts\_raw ); |
| [484](#L484) | } else { |
| [485](#L485) | $atts\_raw = array(); |
| [486](#L486) | } |
| [487](#L487) | $atts = $atts\_raw; // now sanitized |
| [488](#L488) |  |
| [489](#L489) | $location = isset( $\_POST['location'] ) && in\_array( $\_POST['location'], array( 'header', 'footer', 'sidebar', 'content' ), true ) ? sanitize\_text\_field( $\_POST['location'] ) : 'unknown'; |
| [490](#L490) | $post\_id = isset( $\_POST['post\_id'] ) && $\_POST['post\_id'] !== 'unknown' ? (int)$\_POST['post\_id'] : 'unknown'; |
| [491](#L491) | $feed\_details = array( |
| [492](#L492) | 'feed\_id' => $feed\_id, |
| [493](#L493) | 'atts' => $atts, |
| [494](#L494) | 'location' => array( |
| [495](#L495) | 'post\_id' => $post\_id, |
| [496](#L496) | 'html' => $location |
| [497](#L497) | ) |
| [498](#L498) | ); |
| [499](#L499) |  |
| [500](#L500) | ctf\_do\_background\_tasks( $feed\_details ); |
| [501](#L501) |  |
| [502](#L502) | wp\_die( 'locating success' ); |
| [503](#L503) | } |
| [504](#L504) | add\_action( 'wp\_ajax\_ctf\_do\_locator', 'ctf\_do\_locator' ); |
| [505](#L505) | add\_action( 'wp\_ajax\_nopriv\_ctf\_do\_locator', 'ctf\_do\_locator' ); |
| [506](#L506) |  |
| [507](#L507) | function ctf\_do\_background\_tasks( $feed\_details ) { |
| [508](#L508) | $locator = new TwitterFeed\CTF\_Feed\_Locator( $feed\_details ); |
| [509](#L509) | $locator->add\_or\_update\_entry(); |
| [510](#L510) | if ( $locator->should\_clear\_old\_locations() ) { |
| [511](#L511) | $locator->delete\_old\_locations(); |
| [512](#L512) | } |
| [513](#L513) | } |
| [514](#L514) |  |
| [515](#L515) | function ctf\_plugin\_action\_links( $links ) { |
| [516](#L516) | $pro\_link = '<a href="https://smashballoon.com/custom-twitter-feeds/demo/?utm\_campaign=twitter-free&utm\_source=plugins-page&utm\_medium=upgrade-link" target="\_blank" style="font-weight: bold; color: #1da867;">' . \_\_( 'Try the Pro Demo', 'custom-twitter-feeds' ) . '</a>'; |
| [517](#L517) | $settings\_link = '<a href="'. esc\_url( admin\_url( 'admin.php?page=ctf-feed-builder' ) ) .'">' . \_\_( 'Settings' ) . '</a>'; |
| [518](#L518) | array\_unshift( $links, $pro\_link, $settings\_link ); |
| [519](#L519) |  |
| [520](#L520) | return $links; |
| [521](#L521) | } |
| [522](#L522) | add\_filter( 'plugin\_action\_links\_' . plugin\_basename(\_\_FILE\_\_), 'ctf\_plugin\_action\_links' ); |
| [523](#L523) |  |
| [524](#L524) | function ctf\_json\_encode( $thing ) { |
| [525](#L525) | if ( function\_exists( 'wp\_json\_encode' ) ) { |
| [526](#L526) | return wp\_json\_encode( $thing ); |
| [527](#L527) | } else { |
| [528](#L528) | return json\_encode( $thing ); |
| [529](#L529) | } |
| [530](#L530) | } |
| [531](#L531) |  |
| [532](#L532) | /\*\* |
| [533](#L533) | \* the html output is controlled by the user selecting which portions of tweets to show |
| [534](#L534) | \* |
| [535](#L535) | \* @param $part string          part of the feed in the html |
| [536](#L536) | \* @param $feed\_options array   options that contain what parts of the tweet to show |
| [537](#L537) | \* @return bool                 whether or not to show the tweet |
| [538](#L538) | \*/ |
| [539](#L539) | function ctf\_show( $part, $feed\_options ) { |
| [540](#L540) | if ( ctf\_doing\_customizer( $feed\_options ) ) { |
| [541](#L541) | return true; |
| [542](#L542) | } |
| [543](#L543) |  |
| [544](#L544) | $tweet\_excludes = isset( $feed\_options['tweet\_excludes'] ) ? $feed\_options['tweet\_excludes'] : ''; |
| [545](#L545) | $tweet\_includes = isset( $feed\_options['tweet\_includes'] ) ? $feed\_options['tweet\_includes'] : ''; |
| [546](#L546) |  |
| [547](#L547) | // if part is in the array of excluded parts or not in the array of included parts, don't show |
| [548](#L548) | if ( ! empty( $tweet\_excludes ) ) { |
| [549](#L549) | return ( in\_array( $part, (array) $tweet\_excludes ) === false ); |
| [550](#L550) | } else { |
| [551](#L551) | return ( in\_array( $part, (array) $tweet\_includes ) === true ); |
| [552](#L552) | } |
| [553](#L553) | } |
| [554](#L554) |  |
| [555](#L555) | /\*\* |
| [556](#L556) | \* this function returns the properly formatted date string based on user input |
| [557](#L557) | \* |
| [558](#L558) | \* @param $raw\_date string      the date from the Twitter api |
| [559](#L559) | \* @param $feed\_options array   options for the feed that contain date formatting settings |
| [560](#L560) | \* @param $utc\_offset int       offset in seconds for the time display based on timezone |
| [561](#L561) | \* @return string               formatted date |
| [562](#L562) | \*/ |
| [563](#L563) | function ctf\_get\_formatted\_date( $raw\_date, $feed\_options, $utc\_offset ) { |
| [564](#L564) |  |
| [565](#L565) | $options  = get\_option( 'ctf\_options' ); |
| [566](#L566) | $timezone = isset( $options['timezone'] ) ? $options['timezone'] : 'default'; |
| [567](#L567) | // use php \DateTimeZone class to handle the date formatting and offsets |
| [568](#L568) | $date\_obj = new \DateTime($raw\_date, new \DateTimeZone('UTC')); |
| [569](#L569) |  |
| [570](#L570) | if ( $timezone != 'default' ) { |
| [571](#L571) | $date\_obj->setTimeZone( new \DateTimeZone( $timezone ) ); |
| [572](#L572) | $utc\_offset = $date\_obj->getOffset(); |
| [573](#L573) | } |
| [574](#L574) | $tz\_offset\_timestamp = $date\_obj->getTimestamp() + $utc\_offset; |
| [575](#L575) |  |
| [576](#L576) | // use the custom date format if set, otherwise use from the selected defaults |
| [577](#L577) | if ( ! empty( $feed\_options['datecustom'] ) ) { |
| [578](#L578) | $date\_str = date\_i18n( $feed\_options['datecustom'], $tz\_offset\_timestamp ); |
| [579](#L579) | } else { |
| [580](#L580) |  |
| [581](#L581) | switch ( $feed\_options['dateformat'] ) { |
| [582](#L582) | case '2': |
| [583](#L583) | $date\_str = date\_i18n( 'F j', $tz\_offset\_timestamp ); |
| [584](#L584) | break; |
| [585](#L585) | case '3': |
| [586](#L586) | $date\_str = date\_i18n( 'F j, Y', $tz\_offset\_timestamp ); |
| [587](#L587) | break; |
| [588](#L588) | case '4': |
| [589](#L589) | $date\_str = date\_i18n( 'm.d', $tz\_offset\_timestamp ); |
| [590](#L590) | break; |
| [591](#L591) | case '5': |
| [592](#L592) | $date\_str = date\_i18n( 'm.d.y', $tz\_offset\_timestamp ); |
| [593](#L593) | break; |
| [594](#L594) | case '6': |
| [595](#L595) | $date\_str = date\_i18n( 'D M jS, Y', $tz\_offset\_timestamp ); |
| [596](#L596) | break; |
| [597](#L597) | case '7': |
| [598](#L598) | $date\_str = date\_i18n( 'l F jS, Y', $tz\_offset\_timestamp ); |
| [599](#L599) | break; |
| [600](#L600) | case '8': |
| [601](#L601) | $date\_str = date\_i18n( 'l F jS, Y - g:i a', $tz\_offset\_timestamp ); |
| [602](#L602) | break; |
| [603](#L603) | case '9': |
| [604](#L604) | $date\_str = date\_i18n( "l M jS, 'y", $tz\_offset\_timestamp ); |
| [605](#L605) | break; |
| [606](#L606) | case '10': |
| [607](#L607) | $date\_str = date\_i18n( 'm.d.y', $tz\_offset\_timestamp ); |
| [608](#L608) | break; |
| [609](#L609) | case '18': |
| [610](#L610) | $date\_str = date\_i18n( 'm.d.y - G:i', $tz\_offset\_timestamp ); |
| [611](#L611) | break; |
| [612](#L612) | case '11': |
| [613](#L613) | $date\_str = date\_i18n( 'm/d/y', $tz\_offset\_timestamp ); |
| [614](#L614) | break; |
| [615](#L615) | case '12': |
| [616](#L616) | $date\_str = date\_i18n( 'd.m.y', $tz\_offset\_timestamp ); |
| [617](#L617) | break; |
| [618](#L618) | case '19': |
| [619](#L619) | date\_i18n( 'd.m.y - G:i', $tz\_offset\_timestamp ); |
| [620](#L620) | break; |
| [621](#L621) | case '13': |
| [622](#L622) | $date\_str = date\_i18n( 'd/m/y', $tz\_offset\_timestamp ); |
| [623](#L623) | break; |
| [624](#L624) | case '14': |
| [625](#L625) | $date\_str = date\_i18n( 'd-m-Y, G:i', $tz\_offset\_timestamp ); |
| [626](#L626) | break; |
| [627](#L627) | case '15': |
| [628](#L628) | $date\_str = date\_i18n( 'jS F Y, G:i', $tz\_offset\_timestamp ); |
| [629](#L629) | break; |
| [630](#L630) | case '16': |
| [631](#L631) | $date\_str = date\_i18n( 'd M Y, G:i', $tz\_offset\_timestamp ); |
| [632](#L632) | break; |
| [633](#L633) | case '17': |
| [634](#L634) | $date\_str = date\_i18n( 'l jS F Y, G:i', $tz\_offset\_timestamp ); |
| [635](#L635) | break; |
| [636](#L636) | case '18': |
| [637](#L637) | $date\_str = date\_i18n( 'Y-m-d', $tz\_offset\_timestamp ); |
| [638](#L638) | break; |
| [639](#L639) | default: |
| [640](#L640) | // default format is similar to Twitter |
| [641](#L641) | $ctf\_minute = ! empty( $options['mtime'] ) ? $options['mtime'] : 'm'; |
| [642](#L642) | $ctf\_hour = ! empty( $options['htime'] ) ? $options['htime'] : 'h'; |
| [643](#L643) | $ctf\_now\_str = ! empty( $options['nowtime'] ) ? $options['nowtime'] : 'now'; |
| [644](#L644) |  |
| [645](#L645) | $now = time() + $utc\_offset; |
| [646](#L646) |  |
| [647](#L647) | $difference = $now - $tz\_offset\_timestamp; |
| [648](#L648) | if ( $difference < 60 ) { |
| [649](#L649) | $date\_str = $ctf\_now\_str; |
| [650](#L650) | } elseif ( $difference < 60\*60 ) { |
| [651](#L651) | $date\_str = round( $difference/60 ) . $ctf\_minute; |
| [652](#L652) | } elseif ( $difference < 60\*60\*24 ) { |
| [653](#L653) | $date\_str = round( $difference/3600 ) . $ctf\_hour; |
| [654](#L654) | } else  { |
| [655](#L655) | $one\_year\_from\_date = new \DateTime( $raw\_date, new \DateTimeZone( "UTC" ) ); |
| [656](#L656) | $one\_year\_from\_date->modify('+1 year'); |
| [657](#L657) | $one\_year\_from\_date\_timestamp = $one\_year\_from\_date->getTimestamp(); |
| [658](#L658) | if ( $now > $one\_year\_from\_date\_timestamp ) { |
| [659](#L659) | $date\_str = date\_i18n( 'j M Y', $tz\_offset\_timestamp ); |
| [660](#L660) | } else { |
| [661](#L661) | $date\_str = date\_i18n( 'j M', $tz\_offset\_timestamp ); |
| [662](#L662) | } |
| [663](#L663) | } |
| [664](#L664) |  |
| [665](#L665) | break; |
| [666](#L666) | } |
| [667](#L667) | } |
| [668](#L668) |  |
| [669](#L669) | return $date\_str; |
| [670](#L670) | } |
| [671](#L671) |  |
| [672](#L672) | function ctf\_maybe\_shorten\_text( $string, $feed\_settings ) { |
| [673](#L673) | #if( !ctf\_doing\_customizer($feed\_settings) ){ |
| [674](#L674) | $limit = is\_array( $feed\_settings ) ? $feed\_settings['textlength'] : $feed\_settings; |
| [675](#L675) |  |
| [676](#L676) | if ( strlen( $string ) <= $limit |
| [677](#L677) | || $limit >= 280 ) { |
| [678](#L678) | return $string; |
| [679](#L679) | } |
| [680](#L680) |  |
| [681](#L681) | $parts       = preg\_split( '/([\s\n\r]+)/', $string, null, PREG\_SPLIT\_DELIM\_CAPTURE ); |
| [682](#L682) | $parts\_count = count( $parts ); |
| [683](#L683) |  |
| [684](#L684) | $length      = 0; |
| [685](#L685) | $last\_part   = 0; |
| [686](#L686) | $first\_parts = array(); |
| [687](#L687) | $end\_parts   = array(); |
| [688](#L688) | for ( ; $last\_part < $parts\_count; $last\_part++ ) { |
| [689](#L689) | $length += strlen( $parts[ $last\_part ] ); |
| [690](#L690) | if ( $length < $limit ) { |
| [691](#L691) | $first\_parts[] = $parts[ $last\_part ]; |
| [692](#L692) | } else { |
| [693](#L693) | $end\_parts[] = $parts[ $last\_part ]; |
| [694](#L694) | } |
| [695](#L695) | } |
| [696](#L696) | $return = implode( ' ', $first\_parts ) . '<a href="#" class="ctf\_more">...</a><span class="ctf\_remaining">'; |
| [697](#L697) |  |
| [698](#L698) | $return .= implode( ' ', $end\_parts ) . '</span>'; |
| [699](#L699) |  |
| [700](#L700) | return $return; |
| [701](#L701) | #} |
| [702](#L702) | #return $string; |
| [703](#L703) | } |
| [704](#L704) | add\_filter( 'ctf\_tweet\_text', 'ctf\_maybe\_shorten\_text', 10, 2 ); |
| [705](#L705) |  |
| [706](#L706) | function ctf\_replace\_urls( $string, $feed\_settings, $post ) { |
| [707](#L707) |  |
| [708](#L708) | if ( $feed\_settings['shorturls'] ) { |
| [709](#L709) | return $string; |
| [710](#L710) | } |
| [711](#L711) |  |
| [712](#L712) | if ( isset( $post['entities']['urls'][0] ) ) { |
| [713](#L713) | foreach ( $post['entities']['urls'] as $url ) { |
| [714](#L714) | if ( isset( $url['url'] ) ) { |
| [715](#L715) | $string = str\_replace( $url['url'], $url['expanded\_url'], $string ); |
| [716](#L716) | } |
| [717](#L717) | } |
| [718](#L718) | } |
| [719](#L719) |  |
| [720](#L720) | return $string; |
| [721](#L721) | } |
| [722](#L722) | add\_filter( 'ctf\_tweet\_text', 'ctf\_replace\_urls', 9, 3 ); |
| [723](#L723) | add\_filter( 'ctf\_quoted\_tweet\_text', 'ctf\_replace\_urls', 9, 3 ); |
| [724](#L724) |  |
| [725](#L725) | function ctf\_get\_fa\_el( $icon ) { |
| [726](#L726) | $options = get\_option( 'ctf\_options' ); |
| [727](#L727) | $font\_method = 'svg'; |
| [728](#L728) |  |
| [729](#L729) | $elems = array( |
| [730](#L730) | 'fa-arrows-alt' => array( |
| [731](#L731) | 'icon' => '<span class="fa fa-arrows-alt"></span>', |
| [732](#L732) | 'svg' => '<svg class="svg-inline--fa fa-arrows-alt fa-w-16" aria-hidden="true" aria-label="expand" data-fa-processed="" data-prefix="fa" data-icon="arrows-alt" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M352.201 425.775l-79.196 79.196c-9.373 9.373-24.568 9.373-33.941 0l-79.196-79.196c-15.119-15.119-4.411-40.971 16.971-40.97h51.162L228 284H127.196v51.162c0 21.382-25.851 32.09-40.971 16.971L7.029 272.937c-9.373-9.373-9.373-24.569 0-33.941L86.225 159.8c15.119-15.119 40.971-4.411 40.971 16.971V228H228V127.196h-51.23c-21.382 0-32.09-25.851-16.971-40.971l79.196-79.196c9.373-9.373 24.568-9.373 33.941 0l79.196 79.196c15.119 15.119 4.411 40.971-16.971 40.971h-51.162V228h100.804v-51.162c0-21.382 25.851-32.09 40.97-16.971l79.196 79.196c9.373 9.373 9.373 24.569 0 33.941L425.773 352.2c-15.119 15.119-40.971 4.411-40.97-16.971V284H284v100.804h51.23c21.382 0 32.09 25.851 16.971 40.971z"></path></svg>' |
| [733](#L733) | ), |
| [734](#L734) | 'fa-check-circle' => array( |
| [735](#L735) | 'icon' => '<span class="fa fa-check-circle"></span>', |
| [736](#L736) | 'svg' => '<svg class="svg-inline--fa fa-check-circle fa-w-16" aria-hidden="true" aria-label="verified" data-fa-processed="" data-prefix="fa" data-icon="check-circle" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"></path></svg>' |
| [737](#L737) | ), |
| [738](#L738) | 'fa-reply' => array( |
| [739](#L739) | 'icon' => '<span class="fa fa-reply"></span>', |
| [740](#L740) | 'svg' => '<svg class="svg-inline--fa fa-w-16" viewBox="0 0 24 24" aria-label="reply" role="img" xmlns="http://www.w3.org/2000/svg"><g><path fill="currentColor" d="M14.046 2.242l-4.148-.01h-.002c-4.374 0-7.8 3.427-7.8 7.802 0 4.098 3.186 7.206 7.465 7.37v3.828c0 .108.044.286.12.403.142.225.384.347.632.347.138 0 .277-.038.402-.118.264-.168 6.473-4.14 8.088-5.506 1.902-1.61 3.04-3.97 3.043-6.312v-.017c-.006-4.367-3.43-7.787-7.8-7.788zm3.787 12.972c-1.134.96-4.862 3.405-6.772 4.643V16.67c0-.414-.335-.75-.75-.75h-.396c-3.66 0-6.318-2.476-6.318-5.886 0-3.534 2.768-6.302 6.3-6.302l4.147.01h.002c3.532 0 6.3 2.766 6.302 6.296-.003 1.91-.942 3.844-2.514 5.176z"></path></g></svg>' |
| [741](#L741) | ), |
| [742](#L742) | 'fa-retweet' => array( |
| [743](#L743) | 'icon' => '<span class="fa fa-retweet"></span>', |
| [744](#L744) | 'svg' => '<svg class="svg-inline--fa fa-w-16" viewBox="0 0 24 24" aria-hidden="true" aria-label="retweet" role="img"><path fill="currentColor" d="M23.77 15.67c-.292-.293-.767-.293-1.06 0l-2.22 2.22V7.65c0-2.068-1.683-3.75-3.75-3.75h-5.85c-.414 0-.75.336-.75.75s.336.75.75.75h5.85c1.24 0 2.25 1.01 2.25 2.25v10.24l-2.22-2.22c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06l3.5 3.5c.145.147.337.22.53.22s.383-.072.53-.22l3.5-3.5c.294-.292.294-.767 0-1.06zm-10.66 3.28H7.26c-1.24 0-2.25-1.01-2.25-2.25V6.46l2.22 2.22c.148.147.34.22.532.22s.384-.073.53-.22c.293-.293.293-.768 0-1.06l-3.5-3.5c-.293-.294-.768-.294-1.06 0l-3.5 3.5c-.294.292-.294.767 0 1.06s.767.293 1.06 0l2.22-2.22V16.7c0 2.068 1.683 3.75 3.75 3.75h5.85c.414 0 .75-.336.75-.75s-.337-.75-.75-.75z"></path></svg>' |
| [745](#L745) | ), |
| [746](#L746) | 'fa-x'      => array( |
| [747](#L747) | 'icon' => '<span class="fa fab fa-twitter"></span>', |
| [748](#L748) | 'svg'  => '<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21.1161 6.27344H24.2289L17.4284 14.0459L25.4286 24.6225H19.1645L14.2583 18.2079L8.6444 24.6225H5.52976L12.8035 16.309L5.12891 6.27344H11.552L15.9868 12.1367L21.1161 6.27344ZM20.0236 22.7594H21.7484L10.6148 8.03871H8.7639L20.0236 22.7594Z" fill="black"/> |
| [749](#L749) | </svg>', |
| [750](#L750) | ), |
| [751](#L751) | 'fa-heart' => array( |
| [752](#L752) | 'icon' => '<span class="fa fa-heart"></span>', |
| [753](#L753) | 'svg' => '<svg class="svg-inline--fa fa-w-16" viewBox="0 0 24 24" aria-hidden="true" aria-label="like" role="img" xmlns="http://www.w3.org/2000/svg"><g><path fill="currentColor" d="M12 21.638h-.014C9.403 21.59 1.95 14.856 1.95 8.478c0-3.064 2.525-5.754 5.403-5.754 2.29 0 3.83 1.58 4.646 2.73.814-1.148 2.354-2.73 4.645-2.73 2.88 0 5.404 2.69 5.404 5.755 0 6.376-7.454 13.11-10.037 13.157H12zM7.354 4.225c-2.08 0-3.903 1.988-3.903 4.255 0 5.74 7.034 11.596 8.55 11.658 1.518-.062 8.55-5.917 8.55-11.658 0-2.267-1.823-4.255-3.903-4.255-2.528 0-3.94 2.936-3.952 2.965-.23.562-1.156.562-1.387 0-.014-.03-1.425-2.965-3.954-2.965z"></path></g></svg>' |
| [754](#L754) | ), |
| [755](#L755) | 'fa-twitter' => array( |
| [756](#L756) | 'icon' => '<span class="fa fab fa-twitter"></span>', |
| [757](#L757) | 'svg' => '<svg class="svg-inline--fa fa-twitter fa-w-16" aria-hidden="true" aria-label="twitter logo" data-fa-processed="" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>' |
| [758](#L758) | ), |
| [759](#L759) | 'fa-user' => array( |
| [760](#L760) | 'icon' => '<span class="fa fa-user"></span>', |
| [761](#L761) | 'svg' => '<svg class="svg-inline--fa fa-user fa-w-16" aria-hidden="true" aria-label="followers" data-fa-processed="" data-prefix="fa" data-icon="user" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M96 160C96 71.634 167.635 0 256 0s160 71.634 160 160-71.635 160-160 160S96 248.366 96 160zm304 192h-28.556c-71.006 42.713-159.912 42.695-230.888 0H112C50.144 352 0 402.144 0 464v24c0 13.255 10.745 24 24 24h464c13.255 0 24-10.745 24-24v-24c0-61.856-50.144-112-112-112z"></path></svg>' |
| [762](#L762) | ), |
| [763](#L763) | 'ctf\_playbtn' => array( |
| [764](#L764) | 'icon' => '', |
| [765](#L765) | 'svg' => '<svg aria-label="play button" style="color: rgba(255,255,255,1)" class="svg-inline--fa fa-play fa-w-14 ctf\_playbtn" aria-hidden="true" data-fa-processed="" data-prefix="fa" data-icon="play" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"></path></svg>' |
| [766](#L766) | ), |
| [767](#L767) | 'fa-file-video-o'  => array( |
| [768](#L768) | 'icon' => '<span class="fa fa-file-video-o ctf-tweet-text-media" aria-hidden="true"></span>', |
| [769](#L769) | 'svg' => '<svg aria-hidden="true" aria-label="video in tweet" focusable="false" data-prefix="far" data-icon="file-video" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="svg-inline--fa fa-file-video fa-w-12 fa-9x ctf-tweet-text-media"><path fill="currentColor" d="M369.941 97.941l-83.882-83.882A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zM332.118 128H256V51.882L332.118 128zM48 464V48h160v104c0 13.255 10.745 24 24 24h104v288H48zm228.687-211.303L224 305.374V268c0-11.046-8.954-20-20-20H100c-11.046 0-20 8.954-20 20v104c0 11.046 8.954 20 20 20h104c11.046 0 20-8.954 20-20v-37.374l52.687 52.674C286.704 397.318 304 390.28 304 375.986V264.011c0-14.311-17.309-21.319-27.313-11.314z" class=""></path></svg>' |
| [770](#L770) | ), |
| [771](#L771) | 'fa-picture-o'  => array( |
| [772](#L772) | 'icon' => '<span class="fa fa-picture-o ctf-tweet-text-media" aria-hidden="true"></span>', |
| [773](#L773) | 'svg' => '<svg aria-hidden="true" aria-label="images in tweet" focusable="false" data-prefix="far" data-icon="image" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-image fa-w-16 fa-9x ctf-tweet-text-media"><path fill="currentColor" d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 336H54a6 6 0 0 1-6-6V118a6 6 0 0 1 6-6h404a6 6 0 0 1 6 6v276a6 6 0 0 1-6 6zM128 152c-22.091 0-40 17.909-40 40s17.909 40 40 40 40-17.909 40-40-17.909-40-40-40zM96 352h320v-80l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L192 304l-39.515-39.515c-4.686-4.686-12.284-4.686-16.971 0L96 304v48z" class=""></path></svg>' |
| [774](#L774) | ), |
| [775](#L775) | ); |
| [776](#L776) |  |
| [777](#L777) | if ( $font\_method !== 'fontfile' ){ |
| [778](#L778) | return $elems[ $icon ]['svg']; |
| [779](#L779) | } |
| [780](#L780) |  |
| [781](#L781) | return $elems[ $icon ]['icon']; |
| [782](#L782) | } |
| [783](#L783) |  |
| [784](#L784) | /\*\* |
| [785](#L785) | \* manually clears the cached tweets in case of error or user preference |
| [786](#L786) | \* |
| [787](#L787) | \* @return mixed bool whether or not it was successful |
| [788](#L788) | \*/ |
| [789](#L789) | function ctf\_clear\_cache() { |
| [790](#L790) |  |
| [791](#L791) | //Delete all transients |
| [792](#L792) | global $wpdb; |
| [793](#L793) | $table\_name = $wpdb->prefix . "options"; |
| [794](#L794) | $result = $wpdb->query(" |
| [795](#L795) | DELETE |
| [796](#L796) | FROM $table\_name |
| [797](#L797) | WHERE `option\_name` LIKE ('%\\_transient\\_ctf\\_%') |
| [798](#L798) | "); |
| [799](#L799) | $wpdb->query(" |
| [800](#L800) | DELETE |
| [801](#L801) | FROM $table\_name |
| [802](#L802) | WHERE `option\_name` LIKE ('%\\_transient\\_timeout\\_ctf\\_%') |
| [803](#L803) | "); |
| [804](#L804) |  |
| [805](#L805) | ctf\_clear\_page\_caches(); |
| [806](#L806) |  |
| [807](#L807) | } |
| [808](#L808) | add\_action( 'ctf\_cron\_job', 'ctf\_clear\_cache' ); |
| [809](#L809) |  |
| [810](#L810) | function ctf\_clear\_cache\_admin() { |
| [811](#L811) | if ( ! ctf\_current\_user\_can( 'manage\_twitter\_feed\_options' ) ) { |
| [812](#L812) | wp\_send\_json\_error(); |
| [813](#L813) | } |
| [814](#L814) |  |
| [815](#L815) | //Delete all transients |
| [816](#L816) | global $wpdb; |
| [817](#L817) | $table\_name = $wpdb->prefix . "options"; |
| [818](#L818) | $result = $wpdb->query(" |
| [819](#L819) | DELETE |
| [820](#L820) | FROM $table\_name |
| [821](#L821) | WHERE `option\_name` LIKE ('%\\_transient\\_ctf\\_%') |
| [822](#L822) | "); |
| [823](#L823) | $wpdb->query(" |
| [824](#L824) | DELETE |
| [825](#L825) | FROM $table\_name |
| [826](#L826) | WHERE `option\_name` LIKE ('%\\_transient\\_timeout\\_ctf\\_%') |
| [827](#L827) | "); |
| [828](#L828) |  |
| [829](#L829) | ctf\_clear\_page\_caches(); |
| [830](#L830) |  |
| [831](#L831) | wp\_send\_json\_success(); |
| [832](#L832) | } |
| [833](#L833) | add\_action( 'wp\_ajax\_ctf\_clear\_cache\_admin', 'ctf\_clear\_cache\_admin' ); |
| [834](#L834) |  |
| [835](#L835) | function ctf\_activate() { |
| [836](#L836) | // set usage tracking to false if fresh install. |
| [837](#L837) | $usage\_tracking = get\_option( 'ctf\_usage\_tracking', false ); |
| [838](#L838) |  |
| [839](#L839) | global $wp\_roles; |
| [840](#L840) | $wp\_roles->add\_cap( 'administrator', 'manage\_twitter\_feed\_options' ); |
| [841](#L841) |  |
| [842](#L842) | if ( ! is\_array( $usage\_tracking ) ) { |
| [843](#L843) | $usage\_tracking = array( |
| [844](#L844) | 'enabled' => false, |
| [845](#L845) | 'last\_send' => 0 |
| [846](#L846) | ); |
| [847](#L847) |  |
| [848](#L848) | update\_option( 'ctf\_usage\_tracking', $usage\_tracking, false ); |
| [849](#L849) | } |
| [850](#L850) | global $wp\_roles; |
| [851](#L851) | $wp\_roles->add\_cap( 'administrator', 'manage\_twitter\_feed\_options' ); |
| [852](#L852) | } |
| [853](#L853) | register\_activation\_hook( \_\_FILE\_\_, 'ctf\_activate' ); |
| [854](#L854) |  |
| [855](#L855) | /\*\* |
| [856](#L856) | \* clear the cache and unschedule an cron jobs when deactivated |
| [857](#L857) | \*/ |
| [858](#L858) | function ctf\_deactivate() { |
| [859](#L859) | ctf\_clear\_cache(); |
| [860](#L860) |  |
| [861](#L861) | wp\_clear\_scheduled\_hook( 'ctf\_cron\_job' ); |
| [862](#L862) | } |
| [863](#L863) | register\_deactivation\_hook( \_\_FILE\_\_, 'ctf\_deactivate' ); |
| [864](#L864) |  |
| [865](#L865) | /\*\* |
| [866](#L866) | \* Loads the javascript for the plugin front-end. Also localizes the admin-ajax file location for use in ajax calls |
| [867](#L867) | \*/ |
| [868](#L868) | function ctf\_scripts\_and\_styles( $enqueue = false ) { |
| [869](#L869) | $options = get\_option( 'ctf\_options' ); |
| [870](#L870) | $not\_ajax\_theme = (! isset( $options['ajax\_theme'] ) || ! $options['ajax\_theme']); |
| [871](#L871) | $font\_method = 'svg'; |
| [872](#L872) |  |
| [873](#L873) | $loacalize\_args = array( |
| [874](#L874) | 'ajax\_url' => admin\_url( 'admin-ajax.php' ) |
| [875](#L875) | ); |
| [876](#L876) |  |
| [877](#L877) | wp\_enqueue\_style( 'ctf\_styles', plugins\_url( '/css/ctf-styles.min.css', \_\_FILE\_\_ ), array(), CTF\_VERSION ); |
| [878](#L878) | wp\_register\_script( 'ctf\_scripts', CTF\_JS\_URL, array( 'jquery' ), CTF\_VERSION, true ); |
| [879](#L879) |  |
| [880](#L880) | if ( $not\_ajax\_theme ) { |
| [881](#L881) | wp\_localize\_script( 'ctf\_scripts', 'ctf', $loacalize\_args ); |
| [882](#L882) | } else { |
| [883](#L883) | wp\_localize\_script( 'jquery', 'ctf', $loacalize\_args ); |
| [884](#L884) | } |
| [885](#L885) |  |
| [886](#L886) | if ( $enqueue ) { |
| [887](#L887) | wp\_enqueue\_style( 'ctf\_styles' ); |
| [888](#L888) | wp\_enqueue\_script( 'ctf\_scripts' ); |
| [889](#L889) | } |
| [890](#L890) | } |
| [891](#L891) | add\_action( 'wp\_enqueue\_scripts', 'ctf\_scripts\_and\_styles' ); |
| [892](#L892) |  |
| [893](#L893) | /\*\* |
| [894](#L894) | \* outputs the custom js from the "Customize" tab on the Settings page |
| [895](#L895) | \*/ |
| [896](#L896) | function ctf\_custom\_js() { |
| [897](#L897) | $options = get\_option( 'ctf\_options' ); |
| [898](#L898) | $ctf\_custom\_js = isset( $options[ 'custom\_js' ] ) ? $options[ 'custom\_js' ] : ''; |
| [899](#L899) |  |
| [900](#L900) | if ( ! empty( $ctf\_custom\_js ) ) { |
| [901](#L901) | ?> |
| [902](#L902) | <!-- Custom Twitter Feeds JS --> |
| [903](#L903) | <script type="text/javascript"> |
| [904](#L904) | <?php echo "window.ctf\_custom\_js = function($){" . stripslashes( $ctf\_custom\_js ) . "}\r\n"; ?> |
| [905](#L905) | </script> |
| [906](#L906) | <?php |
| [907](#L907) | } |
| [908](#L908) | } |
| [909](#L909) | add\_action( 'wp\_footer', 'ctf\_custom\_js' ); |
| [910](#L910) |  |
| [911](#L911) | /\*\* |
| [912](#L912) | \* outputs the custom css from the "Customize" tab on the Settings page |
| [913](#L913) | \*/ |
| [914](#L914) | function ctf\_custom\_css() { |
| [915](#L915) | $options = get\_option( 'ctf\_options' ); |
| [916](#L916) | $ctf\_custom\_css = isset( $options[ 'custom\_css' ] ) ? $options[ 'custom\_css' ] : ''; |
| [917](#L917) |  |
| [918](#L918) | if ( ! empty( $ctf\_custom\_css ) ) { |
| [919](#L919) | ?> |
| [920](#L920) | <!-- Custom Twitter Feeds CSS --> |
| [921](#L921) | <style type="text/css"> |
| [922](#L922) | <?php echo stripslashes( $ctf\_custom\_css ) . "\r\n"; ?> |
| [923](#L923) | </style> |
| [924](#L924) | <?php |
| [925](#L925) | } |
| [926](#L926) | } |
| [927](#L927) | add\_action( 'wp\_head', 'ctf\_custom\_css' ); |
| [928](#L928) |  |
| [929](#L929) | /\*\* |
| [930](#L930) | \* Some CSS and JS needed in the admin area as well |
| [931](#L931) | \*/ |
| [932](#L932) | function ctf\_admin\_scripts\_and\_styles() { |
| [933](#L933) | wp\_enqueue\_style( |
| [934](#L934) | 'feed-global-style', |
| [935](#L935) | CTF\_PLUGIN\_URL . 'admin/builder/assets/css/global.css', |
| [936](#L936) | false, |
| [937](#L937) | CTF\_VERSION |
| [938](#L938) | ); |
| [939](#L939) | wp\_enqueue\_style( 'ctf\_admin\_styles', plugins\_url( '/css/ctf-admin-styles.css', \_\_FILE\_\_ ), array(), CTF\_VERSION ); |
| [940](#L940) | wp\_enqueue\_style( 'sb-font-awesome', 'https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' ); |
| [941](#L941) | wp\_enqueue\_script( 'ctf\_admin\_scripts', plugins\_url( '/js/ctf-admin-scripts.js', \_\_FILE\_\_ ) , array( 'jquery' ), CTF\_VERSION, false ); |
| [942](#L942) | wp\_localize\_script( 'ctf\_admin\_scripts', 'ctf', array( |
| [943](#L943) | 'ajax\_url' => admin\_url( 'admin-ajax.php' ), |
| [944](#L944) | 'sb\_nonce' => wp\_create\_nonce( 'ctf-smash-balloon' ), |
| [945](#L945) | 'nonce' => wp\_create\_nonce( 'ctf-admin' ) |
| [946](#L946) | ) |
| [947](#L947) | ); |
| [948](#L948) | $strings = array( |
| [949](#L949) | 'addon\_activate'                  => esc\_html\_\_( 'Activate', 'custom-twitter-feeds' ), |
| [950](#L950) | 'addon\_activated'                 => esc\_html\_\_( 'Activated', 'custom-twitter-feeds' ), |
| [951](#L951) | 'addon\_active'                    => esc\_html\_\_( 'Active', 'custom-twitter-feeds' ), |
| [952](#L952) | 'addon\_deactivate'                => esc\_html\_\_( 'Deactivate', 'custom-twitter-feeds' ), |
| [953](#L953) | 'addon\_inactive'                  => esc\_html\_\_( 'Inactive', 'custom-twitter-feeds' ), |
| [954](#L954) | 'addon\_install'                   => esc\_html\_\_( 'Install Addon', 'custom-twitter-feeds' ), |
| [955](#L955) | 'addon\_error'                     => esc\_html\_\_( 'Could not install addon. Please download from wpforms.com and install manually.', 'custom-twitter-feeds' ), |
| [956](#L956) | 'plugin\_error'                    => esc\_html\_\_( 'Could not install a plugin. Please download from WordPress.org and install manually.', 'custom-twitter-feeds' ), |
| [957](#L957) | 'addon\_search'                    => esc\_html\_\_( 'Searching Addons', 'custom-twitter-feeds' ), |
| [958](#L958) | 'ajax\_url'                        => admin\_url( 'admin-ajax.php' ), |
| [959](#L959) | 'cancel'                          => esc\_html\_\_( 'Cancel', 'custom-twitter-feeds' ), |
| [960](#L960) | 'close'                           => esc\_html\_\_( 'Close', 'custom-twitter-feeds' ), |
| [961](#L961) | 'nonce'                           => wp\_create\_nonce( 'ctf-admin' ), |
| [962](#L962) | 'almost\_done'                     => esc\_html\_\_( 'Almost Done', 'custom-twitter-feeds' ), |
| [963](#L963) | 'oops'                            => esc\_html\_\_( 'Oops!', 'custom-twitter-feeds' ), |
| [964](#L964) | 'ok'                              => esc\_html\_\_( 'OK', 'custom-twitter-feeds' ), |
| [965](#L965) | 'plugin\_install\_activate\_btn'     => esc\_html\_\_( 'Install and Activate', 'custom-twitter-feeds' ), |
| [966](#L966) | 'plugin\_install\_activate\_confirm' => esc\_html\_\_( 'needs to be installed and activated to import its forms. Would you like us to install and activate it for you?', 'custom-twitter-feeds' ), |
| [967](#L967) | 'plugin\_activate\_btn'             => esc\_html\_\_( 'Activate', 'custom-twitter-feeds' ), |
| [968](#L968) | ); |
| [969](#L969) | $strings = apply\_filters( 'ctf\_admin\_strings', $strings ); |
| [970](#L970) |  |
| [971](#L971) | wp\_localize\_script( |
| [972](#L972) | 'ctf\_admin\_scripts', |
| [973](#L973) | 'ctf\_admin\_strings', |
| [974](#L974) | $strings |
| [975](#L975) | ); |
| [976](#L976) | wp\_enqueue\_style( 'wp-color-picker' ); |
| [977](#L977) | wp\_enqueue\_script( 'wp-color-picker' ); |
| [978](#L978) | wp\_enqueue\_script( |
| [979](#L979) | 'jquery-matchheight', |
| [980](#L980) | CTF\_PLUGIN\_URL . 'js/jquery.matchHeight-min.js', |
| [981](#L981) | array( 'jquery' ), |
| [982](#L982) | '0.7.0', |
| [983](#L983) | false |
| [984](#L984) | ); |
| [985](#L985) | } |
| [986](#L986) | add\_action( 'admin\_enqueue\_scripts', 'ctf\_admin\_scripts\_and\_styles' ); |
| [987](#L987) |  |
| [988](#L988) |  |
| [989](#L989) | function ctf\_is\_pro\_version() { |
| [990](#L990) | return defined( 'CTF\_STORE\_URL' ); |
| [991](#L991) | } |
| [992](#L992) |  |
| [993](#L993) |  |
| [994](#L994) | function ctf\_get\_database\_settings() { |
| [995](#L995) | $options = get\_option( 'ctf\_options', array() ); |
| [996](#L996) | $options = set\_global\_default\_settings( $options ); |
| [997](#L997) | return $options; |
| [998](#L998) | } |
| [999](#L999) |  |
| [1000](#L1000) | function set\_global\_default\_settings( $options ) { |
| [1001](#L1001) | $defaults = array( |
| [1002](#L1002) | 'disableintents' => false, |
| [1003](#L1003) | 'creditctf'      => false, |
| [1004](#L1004) | 'ajax\_theme'     => false, |
| [1005](#L1005) | ); |
| [1006](#L1006) | foreach ( $defaults as $key => $value ) { |
| [1007](#L1007) | if ( ! isset( $options[ $key ] ) ) { |
| [1008](#L1008) | $options[ $key ] = $value; |
| [1009](#L1009) | } |
| [1010](#L1010) | } |
| [1011](#L1011) | return $options; |
| [1012](#L1012) | } |
| [1013](#L1013) |  |
| [1014](#L1014) | function ctf\_clear\_page\_caches() { |
| [1015](#L1015) | //Clear cache of major caching plugins |
| [1016](#L1016) | if(isset($GLOBALS['wp\_fastest\_cache']) && method\_exists($GLOBALS['wp\_fastest\_cache'], 'deleteCache')){ |
| [1017](#L1017) | $GLOBALS['wp\_fastest\_cache']->deleteCache(); |
| [1018](#L1018) | } |
| [1019](#L1019) | //WP Super Cache |
| [1020](#L1020) | if (function\_exists('wp\_cache\_clear\_cache')) { |
| [1021](#L1021) | wp\_cache\_clear\_cache(); |
| [1022](#L1022) | } |
| [1023](#L1023) | //W3 Total Cache |
| [1024](#L1024) | if (function\_exists('w3tc\_flush\_all')) { |
| [1025](#L1025) | w3tc\_flush\_all(); |
| [1026](#L1026) | } |
| [1027](#L1027) | if (function\_exists('sg\_cachepress\_purge\_cache')) { |
| [1028](#L1028) | sg\_cachepress\_purge\_cache(); |
| [1029](#L1029) | } |
| [1030](#L1030) |  |
| [1031](#L1031) | // Litespeed Cache (older method) |
| [1032](#L1032) | if ( method\_exists( 'LiteSpeed\_Cache\_API', 'purge' ) ) { |
| [1033](#L1033) | LiteSpeed\_Cache\_API::purge( 'esi.custom-twitter-feeds' ); |
| [1034](#L1034) | } |
| [1035](#L1035) |  |
| [1036](#L1036) | // Litespeed Cache (new method) |
| [1037](#L1037) | if(has\_action('litespeed\_purge')) { |
| [1038](#L1038) | do\_action( 'litespeed\_purge', 'esi.custom-twitter-feeds' ); |
| [1039](#L1039) | } |
| [1040](#L1040) | } |
| [1041](#L1041) |  |
| [1042](#L1042) | /\*\* |
| [1043](#L1043) | \* Add the custom interval of 30 minutes for cron caching |
| [1044](#L1044) | \* |
| [1045](#L1045) | \* @param  array $schedules current list of cron intervals |
| [1046](#L1046) | \* |
| [1047](#L1047) | \* @return array |
| [1048](#L1048) | \* |
| [1049](#L1049) | \* @since  2.0 |
| [1050](#L1050) | \*/ |
| [1051](#L1051) | function ctf\_cron\_custom\_interval( $schedules ) { |
| [1052](#L1052) | $schedules['ctf30mins'] = array( |
| [1053](#L1053) | 'interval' => 30 \* 60, |
| [1054](#L1054) | 'display'  => \_\_( 'Every 30 minutes' ) |
| [1055](#L1055) | ); |
| [1056](#L1056) | $schedules['ctfweekly'] = array( |
| [1057](#L1057) | 'interval' => 3600 \* 24 \* 7, |
| [1058](#L1058) | 'display'  => \_\_( 'Weekly' ) |
| [1059](#L1059) | ); |
| [1060](#L1060) |  |
| [1061](#L1061) | return $schedules; |
| [1062](#L1062) | } |
| [1063](#L1063) |  |
| [1064](#L1064) | add\_filter( 'cron\_schedules', 'ctf\_cron\_custom\_interval' ); |
| [1065](#L1065) |  |
| [1066](#L1066) | function ctf\_create\_database\_table() { |
| [1067](#L1067) | global $wpdb; |
| [1068](#L1068) | global $wp\_version; |
| [1069](#L1069) |  |
| [1070](#L1070) | $table\_name = esc\_sql( $wpdb->prefix . CTF\_POSTS\_TABLE ); |
| [1071](#L1071) | $feeds\_posts\_table\_name = esc\_sql( $wpdb->prefix . CTF\_FEEDS\_POSTS\_TABLE ); |
| [1072](#L1072) | $charset\_collate = ''; |
| [1073](#L1073) |  |
| [1074](#L1074) | if ( version\_compare( $wp\_version, '3.5', '>' ) ) { |
| [1075](#L1075) | $charset\_collate = $wpdb->get\_charset\_collate(); |
| [1076](#L1076) | } |
| [1077](#L1077) |  |
| [1078](#L1078) | if ( $wpdb->get\_var( "show tables like '$table\_name'" ) != $table\_name ) { |
| [1079](#L1079) | $sql = "CREATE TABLE " . $table\_name . " ( |
| [1080](#L1080) | id INT(11) UNSIGNED NOT NULL AUTO\_INCREMENT PRIMARY KEY, |
| [1081](#L1081) | twitter\_id VARCHAR(1000) DEFAULT '' NOT NULL, |
| [1082](#L1082) | created\_on DATETIME, |
| [1083](#L1083) | last\_requested DATE, |
| [1084](#L1084) | time\_stamp DATETIME, |
| [1085](#L1085) | json\_data LONGTEXT DEFAULT '' NOT NULL, |
| [1086](#L1086) | media\_id VARCHAR(1000) DEFAULT '' NOT NULL, |
| [1087](#L1087) | sizes VARCHAR(1000) DEFAULT '' NOT NULL, |
| [1088](#L1088) | aspect\_ratio DECIMAL (4,2) DEFAULT 0 NOT NULL, |
| [1089](#L1089) | images\_done TINYINT(1) DEFAULT 0 NOT NULL |
| [1090](#L1090) | ) $charset\_collate;"; |
| [1091](#L1091) | $wpdb->query( $sql ); |
| [1092](#L1092) | } |
| [1093](#L1093) |  |
| [1094](#L1094) | if ( $wpdb->get\_var( "show tables like '$feeds\_posts\_table\_name'" ) != $feeds\_posts\_table\_name ) { |
| [1095](#L1095) | $sql = "CREATE TABLE " . $feeds\_posts\_table\_name . " ( |
| [1096](#L1096) | record\_id INT(11) UNSIGNED NOT NULL AUTO\_INCREMENT PRIMARY KEY, |
| [1097](#L1097) | id INT(11) UNSIGNED NOT NULL, |
| [1098](#L1098) | feed\_id VARCHAR(1000) DEFAULT '' NOT NULL, |
| [1099](#L1099) | INDEX feed\_id (feed\_id(100)) |
| [1100](#L1100) | ) $charset\_collate;"; |
| [1101](#L1101) | $wpdb->query( $sql ); |
| [1102](#L1102) | } |
| [1103](#L1103) |  |
| [1104](#L1104) | return $wpdb->get\_var( "show tables like '$table\_name'" ) === $table\_name; |
| [1105](#L1105) | } |
| [1106](#L1106) |  |
| [1107](#L1107) | function ctf\_text\_domain() { |
| [1108](#L1108) | load\_plugin\_textdomain( 'custom-twitter-feeds', false, basename( dirname(\_\_FILE\_\_) ) . '/languages' ); |
| [1109](#L1109) | } |
| [1110](#L1110) |  |
| [1111](#L1111) | add\_action( 'init', 'ctf\_text\_domain' ); |
| [1112](#L1112) |  |
| [1113](#L1113) | //BUILDER CODE |
| [1114](#L1114) | function ctf\_builder() { |
| [1115](#L1115) | return \TwitterFeed\Builder\CTF\_Feed\_Builder::instance(); |
| [1116](#L1116) | } |
| [1117](#L1117) | ctf\_builder(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?format=txt)
* [Original Format](/export/3220402/custom-twitter-feeds/trunk/custom-twitter-feed.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_196899be_20250110_190252.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3032345%2540custom-twitter-feeds%252Ftrunk%26old%3D3032345%2540custom-twitter-feeds%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2992366/custom-twitter-feeds/trunk "Changeset 2992366 for custom-twitter-feeds/trunk")
* [Next Change](/changeset/3063930/custom-twitter-feeds/trunk "Changeset 3063930 for custom-twitter-feeds/trunk") →

---

# Changeset [3032345](/changeset/3032345 "Show full changeset") for [custom-twitter-feeds/trunk](/browser/custom-twitter-feeds/trunk?rev=3032345 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/06/2024 05:57:14 PM
([11 months](/timeline?from=2024-02-06T17%3A57%3A14Z&precision=second "See timeline at 02/06/2024 05:57:14 PM") ago)

Author:
Craig at Smash Balloon
Message:

* Tweak: Removed CtfDateTime class as PHP 5.2 and lower is no longer supported.
* Fix: Plugin hardening.

Location:
[custom-twitter-feeds/trunk](/browser/custom-twitter-feeds/trunk?rev=3032345)
Files:

4 added
4 deleted
17 edited

* [README.txt](/browser/custom-twitter-feeds/trunk/README.txt?rev=3032345 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [changelog.txt](/browser/custom-twitter-feeds/trunk/changelog.txt?rev=2858477 "Show what was removed (content at revision 3032344)")
  (deleted)
* [composer.json](/browser/custom-twitter-feeds/trunk/composer.json?rev=2983190 "Show what was removed (content at revision 3032344)")
  (deleted)
* [custom-twitter-feed.php](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=3032345 "Show entry in browser")
  (modified)
  ([6 diffs](#file3 "Show differences"))
* [inc/CtfDateTime.php](/browser/custom-twitter-feeds/trunk/inc/CtfDateTime.php?rev=2742372 "Show what was removed (content at revision 3032344)")
  (deleted)
* [js/ctf-admin-scripts.js](/browser/custom-twitter-feeds/trunk/js/ctf-admin-scripts.js?rev=3032345 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [languages/custom-twitter-feeds-de\_DE.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-de_DE.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-de_DE.mo?rev=2991034 "Show previous version in browser"))
* [languages/custom-twitter-feeds-es\_ES.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-es_ES.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-es_ES.mo?rev=2991034 "Show previous version in browser"))
* [languages/custom-twitter-feeds-fr\_FR.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-fr_FR.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-fr_FR.mo?rev=2991034 "Show previous version in browser"))
* [languages/custom-twitter-feeds-it\_IT.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-it_IT.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-it_IT.mo?rev=2991034 "Show previous version in browser"))
* [languages/custom-twitter-feeds-ja.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-ja.mo?rev=3032345 "Show entry in browser")
  (added)
* [languages/custom-twitter-feeds-ja\_JA.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-ja_JA.mo?rev=2991034 "Show what was removed (content at revision 3032344)")
  (deleted)
* [languages/custom-twitter-feeds-nl\_NL.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-nl_NL.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-nl_NL.mo?rev=2991034 "Show previous version in browser"))
* [languages/custom-twitter-feeds-pl\_PL.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-pl_PL.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-pl_PL.mo?rev=2991034 "Show previous version in browser"))
* [languages/custom-twitter-feeds-pt\_BR.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-pt_BR.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-pt_BR.mo?rev=2991034 "Show previous version in browser"))
* [languages/custom-twitter-feeds-ru\_RU.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-ru_RU.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-ru_RU.mo?rev=2991034 "Show previous version in browser"))
* [languages/custom-twitter-feeds-tr\_TR.mo](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-tr_TR.mo?rev=3032345 "Show entry in browser")
  (modified)
  ([previous](/browser/custom-twitter-feeds/trunk/languages/custom-twitter-feeds-tr_TR.mo?rev=2991034 "Show previous version in browser"))
* [vendor/autoload.php](/browser/custom-twitter-feeds/trunk/vendor/autoload.php?rev=3032345 "Show entry in browser")
  (modified)
  ([1 diff](#file17 "Show differences"))
* [vendor/composer/InstalledVersions.php](/browser/custom-twitter-feeds/trunk/vendor/composer/InstalledVersions.php?rev=3032345 "Show entry in browser")
  (added)
* [vendor/composer/autoload\_classmap.php](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_classmap.php?rev=3032345 "Show entry in browser")
  (modified)
  ([1 diff](#file19 "Show differences"))
* [vendor/composer/autoload\_namespaces.php](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_namespaces.php?rev=3032345 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [vendor/composer/autoload\_psr4.php](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_psr4.php?rev=3032345 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [vendor/composer/autoload\_real.php](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_real.php?rev=3032345 "Show entry in browser")
  (modified)
  ([1 diff](#file22 "Show differences"))
* [vendor/composer/installed.json](/browser/custom-twitter-feeds/trunk/vendor/composer/installed.json?rev=3032345 "Show entry in browser")
  (added)
* [vendor/composer/installed.php](/browser/custom-twitter-feeds/trunk/vendor/composer/installed.php?rev=3032345 "Show entry in browser")
  (added)

### Legend:

Unmodified
Added
Removed

* ## [custom-twitter-feeds/trunk/README.txt](/changeset/3032345/custom-twitter-feeds/trunk/README.txt "Show the changeset 3032345 restricted to custom-twitter-feeds/trunk/README.txt")

  | [r2992366](/browser/custom-twitter-feeds/trunk/README.txt?rev=2992366#L2 "Show revision 2992366 of this file in browser") | [r3032345](/browser/custom-twitter-feeds/trunk/README.txt?rev=3032345#L2 "Show revision 3032345 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | Author: Smash Balloon |
  | 3 | 3 | Contributors: smashballoon, craig-at-smash-balloon, am, smub |
  | 4 |  | Support Website: http://smashballoon/custom-twitter-feeds/ |
  |  | 4 | Support Website: https://smashballoon/custom-twitter-feeds/ |
  | 5 | 5 | Tags: Twitter, Twitter feed, X feed, Twitter widget, Custom Twitter Feed |
  | 6 | 6 | Requires at least: 4.1 |
  | 7 | 7 | Tested up to: 6.4 |
  | 8 |  | Stable tag: 2.2.~~1~~ |
  |  | 8 | Stable tag: 2.2.2 |
  | 9 | 9 | Requires PHP: 5.6 |
  | 10 | 10 | License: GPLv2 or later |
  | 11 |  | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  |  | 11 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | 12 | 12 |  |
  | 13 | 13 | Display X posts (Twitter tweets) from any public user account in a clean, attractive looking feed that updates weekly. |
  | […](/browser/custom-twitter-feeds/trunk/README.txt?rev=2992366#L234) | […](/browser/custom-twitter-feeds/trunk/README.txt?rev=3032345#L234) |  |
  | 234 | 234 |  |
  | 235 | 235 | == Changelog == |
  |  | 236 | = 2.2.2 = |
  |  | 237 | \* Tweak: Removed CtfDateTime class as PHP 5.2 and lower is no longer supported. |
  |  | 238 | \* Fix: Plugin hardening. |
  |  | 239 |  |
  | 236 | 240 | = 2.2.1 = |
  | 237 | 241 | \* New: Added translation files for German, Spanish, Italian and more. |
* ## [custom-twitter-feeds/trunk/custom-twitter-feed.php](/changeset/3032345/custom-twitter-feeds/trunk/custom-twitter-feed.php "Show the changeset 3032345 restricted to custom-twitter-feeds/trunk/custom-twitter-feed.php")

  | [r2991034](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=2991034#L4 "Show revision 2991034 of this file in browser") | [r3032345](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=3032345#L4 "Show revision 3032345 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://smashballoon.com/custom-twitter-feeds |
  | 5 | 5 | Description: Customizable X Feeds, formerly known as Twitter feeds, for your website |
  | 6 |  | Version: 2.2.~~1~~ |
  |  | 6 | Version: 2.2.2 |
  | 7 | 7 | Author: Smash Balloon |
  | 8 | 8 | Author URI: https://smashballoon.com/ |
  | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=2991034#L10) | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=3032345#L10) |  |
  | 10 | 10 | \*/ |
  | 11 | 11 | /\* |
  | 12 |  | Copyright 202~~3~~ Smash Balloon LLC (email : hey@smashballoon.com) |
  |  | 12 | Copyright 2024 Smash Balloon LLC (email : hey@smashballoon.com) |
  | 13 | 13 | This program is free software; you can redistribute it and/or modify |
  | 14 | 14 | it under the terms of the GNU General Public License as published by |
  | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=2991034#L30) | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=3032345#L30) |  |
  | 30 | 30 |  |
  | 31 | 31 | define( 'CTF\_URL', plugin\_dir\_path( \_\_FILE\_\_ )  ); |
  | 32 |  | define( 'CTF\_VERSION', '2.2.~~1~~' ); |
  |  | 32 | define( 'CTF\_VERSION', '2.2.2' ); |
  | 33 | 33 | define( 'CTF\_TITLE', 'Custom Twitter Feeds' ); |
  | 34 | 34 | define( 'CTF\_JS\_URL', plugins\_url( '/js/ctf-scripts.min.js?ver=' . CTF\_VERSION , \_\_FILE\_\_ ) ); |
  | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=2991034#L566) | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=3032345#L566) |  |
  | 566 | 566 | $timezone = isset( $options['timezone'] ) ? $options['timezone'] : 'default'; |
  | 567 | 567 | // use php \DateTimeZone class to handle the date formatting and offsets |
  | 568 |  | $date\_obj = new ~~TwitterFeed\CtfDateTime( $raw\_date, new \DateTimeZone( 'UTC' )~~ ); |
  |  | 568 | $date\_obj = new \DateTime($raw\_date, new \DateTimeZone('UTC')); |
  | 569 | 569 |  |
  | 570 | 570 | if ( $timezone != 'default' ) { |
  | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=2991034#L653) | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=3032345#L653) |  |
  | 653 | 653 | $date\_str = round( $difference/3600 ) . $ctf\_hour; |
  | 654 | 654 | } else  { |
  | 655 |  | $one\_year\_from\_date = new ~~TwitterFeed\Ctf~~DateTime( $raw\_date, new \DateTimeZone( "UTC" ) ); |
  |  | 655 | $one\_year\_from\_date = new \DateTime( $raw\_date, new \DateTimeZone( "UTC" ) ); |
  | 656 | 656 | $one\_year\_from\_date->modify('+1 year'); |
  | 657 | 657 | $one\_year\_from\_date\_timestamp = $one\_year\_from\_date->getTimestamp(); |
  | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=2991034#L783) | […](/browser/custom-twitter-feeds/trunk/custom-twitter-feed.php?rev=3032345#L783) |  |
  | 783 | 783 |  |
  | 784 | 784 | /\*\* |
  | 785 |  | ~~\* Called via ajax to automatically save access token and access token secret~~ |
  | 786 |  | ~~\* retrieved with the big blue button~~ |
  | 787 |  | ~~\*/~~ |
  | 788 |  | ~~function ctf\_auto\_save\_tokens() {~~ |
  | 789 |  | ~~if ( ! ctf\_current\_user\_can( 'manage\_twitter\_feed\_options' ) ) {~~ |
  | 790 |  | ~~wp\_send\_json\_error();~~ |
  | 791 |  | ~~}~~ |
  | 792 |  | ~~wp\_cache\_delete ( 'alloptions', 'options' );~~ |
  | 793 |  |  |
  | 794 |  | ~~$options = get\_option( 'ctf\_options', array() );~~ |
  | 795 |  |  |
  | 796 |  | ~~$options['access\_token'] = sanitize\_text\_field( $\_POST['access\_token'] );~~ |
  | 797 |  | ~~$options['access\_token\_secret'] = sanitize\_text\_field( $\_POST['access\_token\_secret'] );~~ |
  | 798 |  |  |
  | 799 |  | ~~update\_option( 'ctf\_options', $options );~~ |
  | 800 |  | ~~delete\_transient( 'ctf\_reauthenticate' );~~ |
  | 801 |  | ~~die();~~ |
  | 802 |  | ~~}~~ |
  | 803 |  | ~~add\_action( 'wp\_ajax\_ctf\_auto\_save\_tokens', 'ctf\_auto\_save\_tokens' );~~ |
  | 804 |  |  |
  | 805 |  | ~~/\*\*~~ |
  | 806 | 785 | \* manually clears the cached tweets in case of error or user preference |
  | 807 | 786 | \* |
* ## [custom-twitter-feeds/trunk/js/ctf-admin-scripts.js](/changeset/3032345/custom-twitter-feeds/trunk/js/ctf-admin-scripts.js "Show the changeset 3032345 restricted to custom-twitter-feeds/trunk/js/ctf-admin-scripts.js")

  | [r2742372](/browser/custom-twitter-feeds/trunk/js/ctf-admin-scripts.js?rev=2742372#L1 "Show revision 2742372 of this file in browser") | [r3032345](/browser/custom-twitter-feeds/trunk/js/ctf-admin-scripts.js?rev=3032345#L1 "Show revision 3032345 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | jQuery(document).ready(function($){ |
  | 2 |  | ~~// access token retrieving~~ |
  | 3 |  | ~~var $ctfRetrievedAccessToken = $('#ctf-retrieved-access-token'),~~ |
  | 4 |  | ~~$ctfRetrievedAccessTokenSecret = $('#ctf-retrieved-access-token-secret'),~~ |
  | 5 |  | ~~$ctfRetrievedDefaultScreenName = $('#ctf-retrieved-default-screen-name'),~~ |
  | 6 |  |  |
  | 7 | 2 | // toggle token input fields |
  | 8 | 3 | $ctfConsumerFields = $('.ctf-toggle-consumer'), |
  | 9 | 4 | $ctfAccessFields = $('.ctf-toggle-access'), |
  | 10 | 5 | $ctfHaveOwnTokens = $('#ctf\_have\_own\_tokens'); |
  | 11 |  |  |
  | 12 |  | ~~if ( $ctfRetrievedAccessToken.length ) {~~ |
  | 13 |  | ~~$('#ctf\_access\_token').val($ctfRetrievedAccessToken.val());~~ |
  | 14 |  | ~~$('#ctf\_access\_token\_secret').val($ctfRetrievedAccessTokenSecret.val());~~ |
  | 15 |  | ~~if($('#ctf\_usertimeline\_text').val() == '') {~~ |
  | 16 |  | ~~$('#ctf\_usertimeline\_text').val($ctfRetrievedDefaultScreenName.val());~~ |
  | 17 |  | ~~}~~ |
  | 18 |  |  |
  | 19 |  | ~~if (!$ctfHaveOwnTokens.is(':checked')) {~~ |
  | 20 |  | ~~$.ajax({~~ |
  | 21 |  | ~~url: ctf.ajax\_url,~~ |
  | 22 |  | ~~type: 'post',~~ |
  | 23 |  | ~~data: {~~ |
  | 24 |  | ~~action: 'ctf\_auto\_save\_tokens',~~ |
  | 25 |  | ~~security: ctf.sb\_nonce,~~ |
  | 26 |  | ~~access\_token: $ctfRetrievedAccessToken.val(),~~ |
  | 27 |  | ~~access\_token\_secret: $ctfRetrievedAccessTokenSecret.val(),~~ |
  | 28 |  | ~~just\_tokens: true~~ |
  | 29 |  | ~~},~~ |
  | 30 |  | ~~success: function (data) {~~ |
  | 31 |  | ~~$('#ctf\_access\_token').after('<span class="ctf-success"><span class="fa fa-check-circle"></span> saved</span>');~~ |
  | 32 |  | ~~$('#ctf\_access\_token\_secret').after('<span class="ctf-success"><span class="fa fa-check-circle"></span> saved</span>');~~ |
  | 33 |  | ~~}~~ |
  | 34 |  | ~~});~~ |
  | 35 |  | ~~}~~ |
  | 36 |  | ~~}~~ |
  | 37 |  |  |
  | 38 |  | ~~function toggleAccessInputs() {~~ |
  | 39 |  | ~~if($ctfHaveOwnTokens.is(':checked')) {~~ |
  | 40 |  | ~~$ctfAccessFields.show();~~ |
  | 41 |  | ~~$ctfConsumerFields.show();~~ |
  | 42 |  | ~~} else {~~ |
  | 43 |  | ~~$ctfConsumerFields.hide();~~ |
  | 44 |  | ~~if($ctfAccessFields.find('#ctf\_access\_token').val() == '' && $ctfAccessFields.find('#ctf\_access\_token\_secret').val() == '') {~~ |
  | 45 |  | ~~$ctfAccessFields.hide();~~ |
  | 46 |  | ~~$ctfConsumerFields.hide();~~ |
  | 47 |  | ~~}~~ |
  | 48 |  | ~~}~~ |
  | 49 |  | ~~}~~ |
  | 50 |  | ~~toggleAccessInputs();~~ |
  | 51 |  |  |
  | 52 |  | ~~$ctfHaveOwnTokens.on('change', function() {~~ |
  | 53 |  | ~~toggleAccessInputs();~~ |
  | 54 |  | ~~});~~ |
  | 55 | 6 |  |
  | 56 | 7 | // variables for time triggered validator |
* ## [custom-twitter-feeds/trunk/vendor/autoload.php](/changeset/3032345/custom-twitter-feeds/trunk/vendor/autoload.php "Show the changeset 3032345 restricted to custom-twitter-feeds/trunk/vendor/autoload.php")

  | [r2742372](/browser/custom-twitter-feeds/trunk/vendor/autoload.php?rev=2742372#L3 "Show revision 2742372 of this file in browser") | [r3032345](/browser/custom-twitter-feeds/trunk/vendor/autoload.php?rev=3032345#L3 "Show revision 3032345 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | ~~if (PHP\_VERSION\_ID < 50600) {~~ |
  | 6 |  | ~~echo 'Composer 2.3.0 dropped support for autoloading on PHP <5.6 and you are running '.PHP\_VERSION.', please upgrade PHP or use Composer 2.2 LTS via "composer self-update --2.2". Aborting.'.PHP\_EOL;~~ |
  | 7 |  | ~~exit(1);~~ |
  | 8 |  | ~~}~~ |
  | 9 |  |  |
  | 10 | 5 | require\_once \_\_DIR\_\_ . '/composer/autoload\_real.php'; |
  | 11 | 6 |  |
* ## [custom-twitter-feeds/trunk/vendor/composer/autoload\_classmap.php](/changeset/3032345/custom-twitter-feeds/trunk/vendor/composer/autoload_classmap.php "Show the changeset 3032345 restricted to custom-twitter-feeds/trunk/vendor/composer/autoload_classmap.php")

  | [r2742372](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_classmap.php?rev=2742372#L3 "Show revision 2742372 of this file in browser") | [r3032345](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_classmap.php?rev=3032345#L3 "Show revision 3032345 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_classmap.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | $vendorDir = dirname(~~\_\_DIR\_\_~~); |
  |  | 5 | $vendorDir = dirname(dirname(\_\_FILE\_\_)); |
  | 6 | 6 | $baseDir = dirname($vendorDir); |
  | 7 | 7 |  |
* ## [custom-twitter-feeds/trunk/vendor/composer/autoload\_namespaces.php](/changeset/3032345/custom-twitter-feeds/trunk/vendor/composer/autoload_namespaces.php "Show the changeset 3032345 restricted to custom-twitter-feeds/trunk/vendor/composer/autoload_namespaces.php")

  | [r2742372](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_namespaces.php?rev=2742372#L3 "Show revision 2742372 of this file in browser") | [r3032345](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_namespaces.php?rev=3032345#L3 "Show revision 3032345 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_namespaces.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | $vendorDir = dirname(~~\_\_DIR\_\_~~); |
  |  | 5 | $vendorDir = dirname(dirname(\_\_FILE\_\_)); |
  | 6 | 6 | $baseDir = dirname($vendorDir); |
  | 7 | 7 |  |
* ## [custom-twitter-feeds/trunk/vendor/composer/autoload\_psr4.php](/changeset/3032345/custom-twitter-feeds/trunk/vendor/composer/autoload_psr4.php "Show the changeset 3032345 restricted to custom-twitter-feeds/trunk/vendor/composer/autoload_psr4.php")

  | [r2742372](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_psr4.php?rev=2742372#L3 "Show revision 2742372 of this file in browser") | [r3032345](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_psr4.php?rev=3032345#L3 "Show revision 3032345 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_psr4.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | $vendorDir = dirname(~~\_\_DIR\_\_~~); |
  |  | 5 | $vendorDir = dirname(dirname(\_\_FILE\_\_)); |
  | 6 | 6 | $baseDir = dirname($vendorDir); |
  | 7 | 7 |  |
* ## [custom-twitter-feeds/trunk/vendor/composer/autoload\_real.php](/changeset/3032345/custom-twitter-feeds/trunk/vendor/composer/autoload_real.php "Show the changeset 3032345 restricted to custom-twitter-feeds/trunk/vendor/composer/autoload_real.php")

  | [r2742372](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_real.php?rev=2742372#L24 "Show revision 2742372 of this file in browser") | [r3032345](/browser/custom-twitter-feeds/trunk/vendor/composer/autoload_real.php?rev=3032345#L24 "Show revision 3032345 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 |  |
  | 25 | 25 | spl\_autoload\_register(array('ComposerAutoloaderInitf720bd162e47b485b49d9885e7cae2a3', 'loadClassLoader'), true, true); |
  | 26 |  | self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(~~\_\_DIR\_\_~~)); |
  |  | 26 | self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(\dirname(\_\_FILE\_\_))); |
  | 27 | 27 | spl\_autoload\_unregister(array('ComposerAutoloaderInitf720bd162e47b485b49d9885e7cae2a3', 'loadClassLoader')); |
  | 28 | 28 |  |
  | 29 |  | require \_\_DIR\_\_ . '/autoload\_static.php'; |
  | 30 |  | call\_user\_func(\Composer\Autoload\ComposerStaticInitf720bd162e47b485b49d9885e7cae2a3::getInitializer($loader)); |
  |  | 29 | $useStaticLoader = PHP\_VERSION\_ID >= 50600 && !defined('HHVM\_VERSION') && (!function\_exists('zend\_loader\_file\_encoded') || !zend\_loader\_file\_encoded()); |
  |  | 30 | if ($useStaticLoader) { |
  |  | 31 | require \_\_DIR\_\_ . '/autoload\_static.php'; |
  |  | 32 |  |
  |  | 33 | call\_user\_func(\Composer\Autoload\ComposerStaticInitf720bd162e47b485b49d9885e7cae2a3::getInitializer($loader)); |
  |  | 34 | } else { |
  |  | 35 | $map = require \_\_DIR\_\_ . '/autoload\_namespaces.php'; |
  |  | 36 | foreach ($map as $namespace => $path) { |
  |  | 37 | $loader->set($namespace, $path); |
  |  | 38 | } |
  |  | 39 |  |
  |  | 40 | $map = require \_\_DIR\_\_ . '/autoload\_psr4.php'; |
  |  | 41 | foreach ($map as $namespace => $path) { |
  |  | 42 | $loader->setPsr4($namespace, $path); |
  |  | 43 | } |
  |  | 44 |  |
  |  | 45 | $classMap = require \_\_DIR\_\_ . '/autoload\_classmap.php'; |
  |  | 46 | if ($classMap) { |
  |  | 47 | $loader->addClassMap($classMap); |
  |  | 48 | } |
  |  | 49 | } |
  | 31 | 50 |  |
  | 32 | 51 | $loader->register(true); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3032345)
* [Zip Archive](?format=zip&new=3032345)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


