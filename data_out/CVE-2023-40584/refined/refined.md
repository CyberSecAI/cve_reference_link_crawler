The provided content is related to CVE-2023-40584.

**Root cause of vulnerability:**
The ArgoCD repo-server component extracts user-controlled tar.gz files without validating the size of their inner files, leading to a potential denial-of-service attack. Additionally, the repo-server does not check extracted file permissions before attempting deletion, which can also be exploited.

**Weaknesses/vulnerabilities present:**
1.  **Unvalidated tar.gz extraction:** The repo-server extracts tar.gz archives without proper validation of inner file sizes.
2.  **Insecure file deletion:** The repo-server attempts to delete extracted files without first verifying their permissions.

**Impact of exploitation:**
1.  **Denial of Service (DoS):** A malicious user can send a specially crafted tar.gz archive that, when extracted, exhausts system resources, leading to a denial of service.
2.  **File deletion prevention:** An attacker can craft a tar.gz archive in a way that prevents the deletion of its inner files, potentially leading to storage issues.

**Attack vectors:**
A malicious, low-privileged user sends a crafted tar.gz archive to the ArgoCD repo-server.

**Required attacker capabilities/position:**
The attacker needs to have the ability to interact with the Argo CD repo-server and send a malicious tar.gz archive. The attacker requires low privileges.

**Additional details:**
- The vulnerability is present in all ArgoCD versions starting from v2.4.
- Patched versions include v2.6.15, 2.7.14, and 2.8.3.
- The CVSS score is 6.5 (Moderate) with base metrics: Attack Vector Network, Attack Complexity Low, Privileges Required Low, User Interaction None, Scope Unchanged, Confidentiality None, Integrity None, Availability High.
- The vulnerability was found and reported by GE Vernova â€“ Amit Laish.
- The fix includes adding a size limit to the extraction process, and ensuring that permissions are set correctly for the extracted files before deleting them.