

[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2021-04-07

This advisory announces vulnerabilities in the following Jenkins deliverables:

* Jenkins (core)
* [OpenText Application Automation Tools
  Plugin](https://plugins.jenkins.io/hp-application-automation-tools-plugin)
* [promoted builds
  Plugin](https://plugins.jenkins.io/promoted-builds)

## Descriptions

### Lack of type validation in agent related REST API

**SECURITY-1721
/
CVE-2021-21639**

**Severity (CVSS):**
[Low](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Description:**

Jenkins 2.286 and earlier, LTS 2.277.1 and earlier does not validate the type of object created after loading the data submitted to the `config.xml` REST API endpoint of a node.

This allows attackers with Computer/Configure permission to replace a node with one of a different type.

Jenkins 2.287, LTS 2.277.2 validates the type of object created and rejects objects of unexpected types.

### View name validation bypass

**SECURITY-1871
/
CVE-2021-21640**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Description:**

Jenkins 2.286 and earlier, LTS 2.277.1 and earlier does not properly check that a newly created view has an allowed name.
When a form to create a view is submitted, the name is included twice in the submission.
One instance is validated, but the other instance is used to create the value.

This allows attackers with View/Create permission to create views with invalid or already-used names.

Jenkins 2.287, LTS 2.277.2 uses the same submitted value for validation and view creation.

### CSRF vulnerability in promoted builds Plugin

**SECURITY-2293
/
CVE-2021-21641**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Affected plugin:
[`promoted-builds`](https://plugins.jenkins.io/promoted-builds)**

**Description:**

promoted builds Plugin 3.9 and earlier does not require POST requests for HTTP endpoints implementing promotion (regular, forced, and re-execute), resulting in cross-site request forgery (CSRF) vulnerabilities.

These vulnerabilities allow attackers to promote builds.

promoted builds Plugin 3.9.1 requires POST requests for the affected HTTP endpoints.

|  | A security hardening since Jenkins 2.287 and LTS 2.277.2 prevents exploitation of this vulnerability. |
| --- | --- |

### CSRF vulnerability and missing permission checks in OpenText Application Automation Tools Plugin

**SECURITY-2132
/
CVE-2021-22512 (CSRF), CVE-2021-22513 (permission check)**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Affected plugin:
[`hp-application-automation-tools-plugin`](https://plugins.jenkins.io/hp-application-automation-tools-plugin)**

**Description:**

OpenText Application Automation Tools Plugin 6.7 and earlier does not perform permission checks in methods implementing form validation.

This allows attackers with Overall/Read permission to connect to attacker-specified URLs using attacker-specified username and password.

Additionally, these form validation methods do not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.

OpenText Application Automation Tools Plugin 6.8 requires POST requests and Overall/Administer permission for the affected form validation methods.

### Reflected XSS vulnerability in OpenText Application Automation Tools Plugin

**SECURITY-2175
/
CVE-2021-22510**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Affected plugin:
[`hp-application-automation-tools-plugin`](https://plugins.jenkins.io/hp-application-automation-tools-plugin)**

**Description:**

OpenText Application Automation Tools Plugin 6.7 and earlier does not escape user input in a form validation response.

This results in a reflected cross-site scripting (XSS) vulnerability.

OpenText Application Automation Tools Plugin 6.8 escapes user input in the affected form validation response.

|  | A security hardening since Jenkins 2.275 and LTS 2.263.2 prevents exploitation of this vulnerability. |
| --- | --- |

### SSL/TLS certificate validation unconditionally disabled by OpenText Application Automation Tools Plugin

**SECURITY-2176
/
CVE-2021-22511**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N)

**Affected plugin:
[`hp-application-automation-tools-plugin`](https://plugins.jenkins.io/hp-application-automation-tools-plugin)**

**Description:**

OpenText Application Automation Tools Plugin 6.7 and earlier unconditionally disables SSL/TLS certificate validation for connections to Service Virtualization servers.

OpenText Application Automation Tools Plugin 6.8 no longer disables SSL/TLS certificate validation unconditionally by default.
It provides an option to disable SSL/TLS certification validation for connections to Service Virtualization servers.

## Severity

* SECURITY-1721:
  [Low](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N)
* SECURITY-1871:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)
* SECURITY-2132:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)
* SECURITY-2175:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-2176:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N)
* SECURITY-2293:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

## Affected Versions

* **Jenkins weekly**
  up to and including
  2.286
* **Jenkins LTS**
  up to and including
  2.277.1
* **OpenText Application Automation Tools
  Plugin**
  up to and including
  6.7
* **promoted builds
  Plugin**
  up to and including
  3.9

## Fix

* **Jenkins weekly**
  should be updated to version
  2.287
* **Jenkins LTS**
  should be updated to version
  2.277.2
* **OpenText Application Automation Tools
  Plugin**
  should be updated to version
  6.8
* **promoted builds
  Plugin**
  should be updated to version
  3.9.1

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Ildefonso Montero PÃ©rez, CloudBees, Inc. and Daniel Beck, CloudBees, Inc.**
  for
  SECURITY-2293
* **Jeff Thompson, CloudBees, Inc.**
  for
  SECURITY-1721
* **Long Nguyen, Viettel Cyber Security**
  for
  SECURITY-2132
* **Wadeck Follonier, CloudBees, Inc.**
  for
  SECURITY-2175, SECURITY-2176

