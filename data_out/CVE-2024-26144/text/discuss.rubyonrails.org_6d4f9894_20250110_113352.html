

![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [Possible Sensitive Session Information Leak in Active Storage](/t/possible-sensitive-session-information-leak-in-active-storage/84945)

[Security Announcements](/c/security-announcements/9)

[patch](https://discuss.rubyonrails.org/tag/patch),
[announcement](https://discuss.rubyonrails.org/tag/announcement)

[tenderlove](https://discuss.rubyonrails.org/u/tenderlove)
(Aaron Patterson)

February 21, 2024, 8:39pm

1

There is a possible sensitive session information leak in Active Storage. By
default, Active Storage sends a `Set-Cookie` header along with the user’s
session cookie when serving blobs. It also sets `Cache-Control` to public.
Certain proxies may cache the Set-Cookie, leading to an information leak.

This vulnerability has been assigned the CVE identifier CVE-2024-26144.

Versions Affected: >= 5.2.0, < 7.1.0
Not affected: < 5.2.0, >= 7.1.0
Fixed Versions: 7.0.8.1, 6.1.7.7

## Impact

A proxy which chooses to caches this request can cause users to share
sessions. This may include a user receiving an attacker’s session or vice
versa.

This was patched in 7.1.0 but not previously identified as a security
vulnerability.

All users running an affected release should either upgrade or use one of the
workarounds immediately.

## Releases

The fixed releases are available at the normal locations.

## Workarounds

Upgrade to Rails 7.1.X, or configure caching proxies not to cache the
Set-Cookie headers.

## Patches

To aid users who aren’t able to upgrade immediately we have provided patches for
the two supported release series. They are in git-am format and consist of a
single changeset.

* 6-1-VULN.patch - Patch for 6.1 series
* 7-0-VULN.patch - Patch for 7.0 series

## Credits

Thanks to [tyage](https://hackerone.com/tyage) for reporting this!

[6-1-active-storage-cookie.patch](/uploads/short-url/4oaTs9JI0uaiRi1UehbsGYlysjk.patch) (3.2 KB)
[7-0-active-storage-cookie.patch](/uploads/short-url/1nRwyoPzjB8yqFZxDIy9cQhkejP.patch) (3.2 KB)

2 Likes

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [ActiveStorage: Cache-Control: max-age=3155695200, public and Set-Cookie: \_app\_session=](https://discuss.rubyonrails.org/t/activestorage-cache-control-max-age-3155695200-public-and-set-cookie-app-session/81918)  [rubyonrails-core](/c/rubyonrails-core/5) [activestorage](https://discuss.rubyonrails.org/tag/activestorage) | 1 | 1135 | March 27, 2023 |
| [[CVE-2022-21831] Possible code injection vulnerability in Rails / Active Storage](https://discuss.rubyonrails.org/t/cve-2022-21831-possible-code-injection-vulnerability-in-rails-active-storage/80199)  [Security Announcements](/c/security-announcements/9) | 0 | 10510 | March 8, 2022 |
| [[CVE-2022-22577] Possible XSS Vulnerability in Action Pack](https://discuss.rubyonrails.org/t/cve-2022-22577-possible-xss-vulnerability-in-action-pack/80533)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) | 0 | 11545 | April 26, 2022 |
| [[CVE-2022-23633] Possible exposure of information vulnerability in Action Pack](https://discuss.rubyonrails.org/t/cve-2022-23633-possible-exposure-of-information-vulnerability-in-action-pack/80016)  [Security Announcements](/c/security-announcements/9) | 0 | 9519 | February 11, 2022 |
| [[CVE-2023-28120] Possible XSS Security Vulnerability in SafeBuffer#bytesplice](https://discuss.rubyonrails.org/t/cve-2023-28120-possible-xss-security-vulnerability-in-safebuffer-bytesplice/82469)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [patch](https://discuss.rubyonrails.org/tag/patch) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 8269 | March 13, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

