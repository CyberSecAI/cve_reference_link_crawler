=== Content from www.wordfence.com_e7b21e8d_20250110_131925.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Zita Elementor Site Library <= 1.6.3 - Authenticated (Author+) Stored Cross-Site Scripting via SVG File Upload

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Zita Elementor Site Library <= 1.6.3 - Authenticated (Author+) Stored Cross-Site Scripting via SVG File Upload

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-8921](https://www.cve.org/CVERecord?id=CVE-2024-8921) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | October 15, 2024 |
| Last Updated | October 16, 2024 |
| Researcher | [Francesco Carlucci](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/francesco-carlucci) |

### Description

The Zita Elementor Site Library plugin for WordPress is vulnerable to Stored Cross-Site Scripting via SVG File uploads in all versions up to, and including, 1.6.3 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with Author-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses the SVG file.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/zita-site-library/trunk/importer/wxr-importer.php#L160)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/zita-site-library/trunk/inc/importer.php#L148)
* [wordpress.org](https://wordpress.org/plugins/zita-site-library/#developers)
* [wpzita.com](https://wpzita.com/changelog/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3168327/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fzita-site-library%2Fzita-elementor-site-library-163-authenticated-author-stored-cross-site-scripting-via-svg-file-upload&t=Zita%20Elementor%20Site%20Library%20%3C%3D%201.6.3%20-%20Authenticated%20%28Author%2B%29%20Stored%20Cross-Site%20Scripting%20via%20SVG%20File%20Upload "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fzita-site-library%2Fzita-elementor-site-library-163-authenticated-author-stored-cross-site-scripting-via-svg-file-upload&text=Zita%20Elementor%20Site%20Library%20%3C%3D%201.6.3%20-%20Authenticated%20%28Author%2B%29%20Stored%20Cross-Site%20Scripting%20via%20SVG%20File%20Upload "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fzita-site-library%2Fzita-elementor-site-library-163-authenticated-author-stored-cross-site-scripting-via-svg-file-upload "LinkedIn")
Email

## Vulnerability Details for Zita Elementor Site Library

#### [Zita Elementor Site Library](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/zita-site-library)

| Software Type | Plugin |
| --- | --- |
| Software Slug | zita-site-library [(view on wordpress.org)](https://wordpress.org/plugins/zita-site-library) |
| Patched? | Yes |
| Remediation | Update to version 1.6.4, or a newer patched version |
| Affected Version | * <= 1.6.3 |
| Patched Version | * 1.6.4 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_9d4fbcb1_20250110_131919.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fzita-site-library%2Ftrunk%2Fimporter%2Fwxr-importer.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/zita-site-library/trunk/importer/wxr-importer.php?rev=3105478 "Revision 3105478")
* Next Revision →
* [Blame](/browser/zita-site-library/trunk/importer/wxr-importer.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/zita-site-library/trunk/importer/wxr-importer.php)

---

# [source:](/browser?order=name "Go to repository root") [zita-site-library](/browser/zita-site-library?order=name "View zita-site-library")/[trunk](/browser/zita-site-library/trunk?order=name "View trunk")/[importer](/browser/zita-site-library/trunk/importer?order=name "View importer")/[wxr-importer.php](/browser/zita-site-library/trunk/importer/wxr-importer.php?order=name "View wxr-importer.php")

View diff against:

View revision:

| [Last change](/changeset/3168327/zita-site-library/trunk/importer/wxr-importer.php "View differences") on this file was [3168327](/changeset/3168327/ "View changeset 3168327"), checked in by wpzita, [3 months ago](/timeline?from=2024-10-14T08%3A16%3A10Z&precision=second "See timeline at 10/14/2024 08:16:10 AM") |
| --- |
| version 1.6.4 updated |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 10.1 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Class Zita WXR Importer |
| [4](#L4) | \* |
| [5](#L5) | \* @since  1.0.0 |
| [6](#L6) | \*/ |
| [7](#L7) |  |
| [8](#L8) | defined( 'ABSPATH' ) or exit; |
| [9](#L9) |  |
| [10](#L10) | class Zita\_Site\_Library\_WXR\_Importer { |
| [11](#L11) |  |
| [12](#L12) | /\*\* |
| [13](#L13) | \* Instance of Zita\_Site\_Library\_WXR\_Importer |
| [14](#L14) | \* |
| [15](#L15) | \* @since  1.0.0 |
| [16](#L16) | \* @var Zita\_Site\_Library\_WXR\_Importer |
| [17](#L17) | \*/ |
| [18](#L18) | private static $\_instance = null; |
| [19](#L19) |  |
| [20](#L20) | /\*\* |
| [21](#L21) | \* Instantiate Zita\_Site\_Library\_WXR\_Importer |
| [22](#L22) | \* |
| [23](#L23) | \* @since  1.0.0 |
| [24](#L24) | \* @return (Object) Zita\_Site\_Library\_WXR\_Importer. |
| [25](#L25) | \*/ |
| [26](#L26) | public static function instance() { |
| [27](#L27) | if ( ! isset( self::$\_instance ) ) { |
| [28](#L28) | self::$\_instance = new self(); |
| [29](#L29) | } |
| [30](#L30) |  |
| [31](#L31) | return self::$\_instance; |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* Constructor. |
| [36](#L36) | \* |
| [37](#L37) | \* @since  1.0.0 |
| [38](#L38) | \*/ |
| [39](#L39) | private function \_\_construct() { |
| [40](#L40) |  |
| [41](#L41) | if ( ! class\_exists( 'WP\_Importer' ) ) { |
| [42](#L42) | defined( 'WP\_LOAD\_IMPORTERS' ) || define( 'WP\_LOAD\_IMPORTERS', true ); |
| [43](#L43) | require ABSPATH . '/wp-admin/includes/class-wp-importer.php'; |
| [44](#L44) | } |
| [45](#L45) |  |
| [46](#L46) | if ( ! class\_exists( 'WP\_Importer\_Logger' ) ) { |
| [47](#L47) | require\_once ZITA\_SITE\_LIBRARY\_DIR . 'importer/class-logger.php'; |
| [48](#L48) | } |
| [49](#L49) |  |
| [50](#L50) | if ( ! class\_exists( 'WP\_Importer\_Logger\_ServerSentEvents' ) ) { |
| [51](#L51) | require\_once ZITA\_SITE\_LIBRARY\_DIR . 'importer/class-wp-importer-logger-serversentevents.php'; |
| [52](#L52) | } |
| [53](#L53) |  |
| [54](#L54) | $this->elementor\_competibilty(); |
| [55](#L55) | if ( ! class\_exists( 'WXR\_Importer' ) ) { |
| [56](#L56) | require\_once ZITA\_SITE\_LIBRARY\_DIR . 'importer/class-wxr-importer.php'; |
| [57](#L57) | } |
| [58](#L58) |  |
| [59](#L59) | if ( ! class\_exists( 'WXR\_Import\_Info' ) ) { |
| [60](#L60) | require\_once ZITA\_SITE\_LIBRARY\_DIR . 'importer/class-wxr-import-info.php'; |
| [61](#L61) | } |
| [62](#L62) |  |
| [63](#L63) | add\_filter( 'upload\_mimes', array( $this, 'custom\_upload\_mimes' ) ); |
| [64](#L64) | add\_action( 'wp\_ajax\_zita-wxr-import', array( $this, 'xml\_data\_import' ) ); |
| [65](#L65) | add\_filter( 'wxr\_importer.pre\_process.user', '\_\_return\_null' ); |
| [66](#L66) | } |
| [67](#L67) |  |
| [68](#L68) | /\*\* |
| [69](#L69) | \* Constructor. |
| [70](#L70) | \* |
| [71](#L71) | \* @since  1.1.0 |
| [72](#L72) | \*/ |
| [73](#L73) | function xml\_data\_import() { |
| [74](#L74) | if ( isset( $\_REQUEST['zita\_nonce'] ) && wp\_verify\_nonce( $\_REQUEST['zita\_nonce'], 'zita\_sl\_nonce' ) ) { |
| [75](#L75) |  |
| [76](#L76) |  |
| [77](#L77) | if ( ! current\_user\_can( 'manage\_options' ) ) { |
| [78](#L78) | wp\_send\_json\_error( \_\_( 'You have not "customize" access to import the Zita site library.', 'zita-site-library' ) ); |
| [79](#L79) | } |
| [80](#L80) |  |
| [81](#L81) |  |
| [82](#L82) | // Nonce is valid; process form data |
| [83](#L83) | // Start the event stream. |
| [84](#L84) | header( 'Content-Type: text/event-stream' ); |
| [85](#L85) |  |
| [86](#L86) | // Turn off PHP output compression. |
| [87](#L87) | $previous = error\_reporting( error\_reporting() ^ E\_WARNING ); |
| [88](#L88) | ini\_set( 'output\_buffering', 'off' ); |
| [89](#L89) | ini\_set( 'zlib.output\_compression', false ); |
| [90](#L90) | error\_reporting( $previous ); |
| [91](#L91) |  |
| [92](#L92) | if ( $GLOBALS['is\_nginx'] ) { |
| [93](#L93) | // Setting this header instructs Nginx to disable fastcgi\_buffering |
| [94](#L94) | // and disable gzip for this request. |
| [95](#L95) | header( 'X-Accel-Buffering: no' ); |
| [96](#L96) | header( 'Content-Encoding: none' ); |
| [97](#L97) | } |
| [98](#L98) |  |
| [99](#L99) | $xml\_url = urldecode( $\_REQUEST['xml\_url'] ); |
| [100](#L100) | if ( empty( $xml\_url ) ) { |
| [101](#L101) | exit; |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) | // 2KB padding for IE |
| [105](#L105) | echo ':' . str\_repeat( ' ', 2048 ) . "\n\n"; |
| [106](#L106) |  |
| [107](#L107) | // Time to run the import! |
| [108](#L108) | set\_time\_limit( 0 ); |
| [109](#L109) |  |
| [110](#L110) | // Ensure we're not buffered. |
| [111](#L111) | wp\_ob\_end\_flush\_all(); |
| [112](#L112) | flush(); |
| [113](#L113) |  |
| [114](#L114) | // Are we allowed to create users? |
| [115](#L115) | add\_filter( 'wxr\_importer.pre\_process.user', '\_\_return\_null' ); |
| [116](#L116) |  |
| [117](#L117) | // Keep track of our progress. |
| [118](#L118) | add\_action( 'wxr\_importer.processed.post', array( $this, 'imported\_post' ), 10, 2 ); |
| [119](#L119) | add\_action( 'wxr\_importer.process\_failed.post', array( $this, 'imported\_post' ), 10, 2 ); |
| [120](#L120) | add\_action( 'wxr\_importer.process\_already\_imported.post', array( $this, 'already\_imported\_post' ), 10, 2 ); |
| [121](#L121) | add\_action( 'wxr\_importer.process\_skipped.post', array( $this, 'already\_imported\_post' ), 10, 2 ); |
| [122](#L122) | add\_action( 'wxr\_importer.processed.comment', array( $this, 'imported\_comment' ) ); |
| [123](#L123) | add\_action( 'wxr\_importer.process\_already\_imported.comment', array( $this, 'imported\_comment' ) ); |
| [124](#L124) | add\_action( 'wxr\_importer.processed.term', array( $this, 'imported\_term' ) ); |
| [125](#L125) | add\_action( 'wxr\_importer.process\_failed.term', array( $this, 'imported\_term' ) ); |
| [126](#L126) | add\_action( 'wxr\_importer.process\_already\_imported.term', array( $this, 'imported\_term' ) ); |
| [127](#L127) | add\_action( 'wxr\_importer.processed.user', array( $this, 'imported\_user' ) ); |
| [128](#L128) | add\_action( 'wxr\_importer.process\_failed.user', array( $this, 'imported\_user' ) ); |
| [129](#L129) | // Flush once more. |
| [130](#L130) | flush(); |
| [131](#L131) |  |
| [132](#L132) | $importer = $this->get\_importer(); |
| [133](#L133) | $response = $importer->import( $xml\_url ); |
| [134](#L134) |  |
| [135](#L135) | // Let the browser know we're done. |
| [136](#L136) | $complete = array( |
| [137](#L137) | 'action' => 'complete', |
| [138](#L138) | 'error'  => false, |
| [139](#L139) | ); |
| [140](#L140) | if ( is\_wp\_error( $response ) ) { |
| [141](#L141) | $complete['error'] = $response->get\_error\_message(); |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | $this->emit\_sse\_message( $complete ); |
| [145](#L145) | exit; |
| [146](#L146) |  |
| [147](#L147) | } |
| [148](#L148) |  |
| [149](#L149) | } |
| [150](#L150) |  |
| [151](#L151) | /\*\* |
| [152](#L152) | \* Add .xml files as supported format in the uploader. |
| [153](#L153) | \* |
| [154](#L154) | \* @since 1.1.5 Added SVG file support. |
| [155](#L155) | \* |
| [156](#L156) | \* @since 1.0.0 |
| [157](#L157) | \* |
| [158](#L158) | \* @param array $mimes Already supported mime types. |
| [159](#L159) | \*/ |
| [160](#L160) | public function custom\_upload\_mimes( $mimes ) { |
| [161](#L161) | if ( current\_user\_can( 'manage\_options' ) ) { |
| [162](#L162) | // Allow SVG files. |
| [163](#L163) | $mimes['svg']  = 'image/svg+xml'; |
| [164](#L164) | $mimes['svgz'] = 'image/svg+xml'; |
| [165](#L165) |  |
| [166](#L166) | // Allow XML files. |
| [167](#L167) | $mimes['xml'] = 'application/xml'; |
| [168](#L168) | } |
| [169](#L169) | return $mimes; |
| [170](#L170) | } |
| [171](#L171) |  |
| [172](#L172) | /\*\* |
| [173](#L173) | \* Start the xml import. |
| [174](#L174) | \* |
| [175](#L175) | \* @since  1.0.0 |
| [176](#L176) | \* |
| [177](#L177) | \* @param  (String) $path Absolute path to the XML file. |
| [178](#L178) | \*/ |
| [179](#L179) | public function get\_xml\_data( $path ) { |
| [180](#L180) |  |
| [181](#L181) | $args = array( |
| [182](#L182) | 'action'  => 'zita-wxr-import', |
| [183](#L183) | 'id'      => '1', |
| [184](#L184) | 'xml\_url' => $path, |
| [185](#L185) | 'zita\_nonce' => wp\_create\_nonce('zita\_sl\_nonce'), |
| [186](#L186) | ); |
| [187](#L187) |  |
| [188](#L188) | $url  = add\_query\_arg( urlencode\_deep( $args ), admin\_url( 'admin-ajax.php' ) ); |
| [189](#L189) |  |
| [190](#L190) | $data = $this->get\_data( $path ); |
| [191](#L191) |  |
| [192](#L192) | return array( |
| [193](#L193) | 'count'   => array( |
| [194](#L194) | 'posts'    => $data->post\_count, |
| [195](#L195) | 'media'    => $data->media\_count, |
| [196](#L196) | 'users'    => count( $data->users ), |
| [197](#L197) | 'comments' => $data->comment\_count, |
| [198](#L198) | 'terms'    => $data->term\_count, |
| [199](#L199) | ), |
| [200](#L200) | 'url'     => $url, |
| [201](#L201) | 'strings' => array( |
| [202](#L202) | 'complete' => \_\_( 'Import complete!', 'zita-templates' ), |
| [203](#L203) | ), |
| [204](#L204) | ); |
| [205](#L205) | } |
| [206](#L206) |  |
| [207](#L207) | /\*\* |
| [208](#L208) | \* Get XML data. |
| [209](#L209) | \* |
| [210](#L210) | \* @since 1.1.0 |
| [211](#L211) | \* @param  string $url Downloaded XML file absolute URL. |
| [212](#L212) | \* @return array  XML file data. |
| [213](#L213) | \*/ |
| [214](#L214) | function get\_data( $url ) { |
| [215](#L215) | $importer = $this->get\_importer(); |
| [216](#L216) | $data     = $importer->get\_preliminary\_information( $url ); |
| [217](#L217) | if ( is\_wp\_error( $data ) ) { |
| [218](#L218) | return $data; |
| [219](#L219) | } |
| [220](#L220) | return $data; |
| [221](#L221) | } |
| [222](#L222) |  |
| [223](#L223) | /\*\* |
| [224](#L224) | \* Get Importer |
| [225](#L225) | \* |
| [226](#L226) | \* @since 1.1.0 |
| [227](#L227) | \* @return object   Importer object. |
| [228](#L228) | \*/ |
| [229](#L229) | public function get\_importer() { |
| [230](#L230) | $options  = apply\_filters( |
| [231](#L231) | 'zita\_site\_library\_xml\_import\_options', array( |
| [232](#L232) | 'fetch\_attachments' => true, |
| [233](#L233) | 'default\_author'    => get\_current\_user\_id(), |
| [234](#L234) | ) |
| [235](#L235) | ); |
| [236](#L236) | $importer = new WXR\_Importer( $options ); |
| [237](#L237) | $logger   = new WP\_Importer\_Logger\_ServerSentEvents(); |
| [238](#L238) |  |
| [239](#L239) | $importer->set\_logger( $logger ); |
| [240](#L240) | return $importer; |
| [241](#L241) | } |
| [242](#L242) |  |
| [243](#L243) | /\*\* |
| [244](#L244) | \* Send message when a post has been imported. |
| [245](#L245) | \* |
| [246](#L246) | \* @since 1.1.0 |
| [247](#L247) | \* @param int   $id Post ID. |
| [248](#L248) | \* @param array $data Post data saved to the DB. |
| [249](#L249) | \*/ |
| [250](#L250) | public function imported\_post( $id, $data ) { |
| [251](#L251) | $this->emit\_sse\_message( |
| [252](#L252) | array( |
| [253](#L253) | 'action' => 'updateDelta', |
| [254](#L254) | 'type'   => ( 'attachment' === $data['post\_type'] ) ? 'media' : 'posts', |
| [255](#L255) | 'delta'  => 1, |
| [256](#L256) | ) |
| [257](#L257) | ); |
| [258](#L258) | } |
| [259](#L259) |  |
| [260](#L260) | /\*\* |
| [261](#L261) | \* Send message when a post is marked as already imported. |
| [262](#L262) | \* |
| [263](#L263) | \* @since 1.1.0 |
| [264](#L264) | \* @param array $data Post data saved to the DB. |
| [265](#L265) | \*/ |
| [266](#L266) | public function already\_imported\_post( $data ) { |
| [267](#L267) | $this->emit\_sse\_message( |
| [268](#L268) | array( |
| [269](#L269) | 'action' => 'updateDelta', |
| [270](#L270) | 'type'   => ( 'attachment' === $data['post\_type'] ) ? 'media' : 'posts', |
| [271](#L271) | 'delta'  => 1, |
| [272](#L272) | ) |
| [273](#L273) | ); |
| [274](#L274) | } |
| [275](#L275) |  |
| [276](#L276) | /\*\* |
| [277](#L277) | \* Send message when a comment has been imported. |
| [278](#L278) | \* |
| [279](#L279) | \* @since 1.1.0 |
| [280](#L280) | \*/ |
| [281](#L281) | public function imported\_comment() { |
| [282](#L282) | $this->emit\_sse\_message( |
| [283](#L283) | array( |
| [284](#L284) | 'action' => 'updateDelta', |
| [285](#L285) | 'type'   => 'comments', |
| [286](#L286) | 'delta'  => 1, |
| [287](#L287) | ) |
| [288](#L288) | ); |
| [289](#L289) | } |
| [290](#L290) |  |
| [291](#L291) | /\*\* |
| [292](#L292) | \* Send message when a term has been imported. |
| [293](#L293) | \* |
| [294](#L294) | \* @since 1.1.0 |
| [295](#L295) | \*/ |
| [296](#L296) | public function imported\_term() { |
| [297](#L297) | $this->emit\_sse\_message( |
| [298](#L298) | array( |
| [299](#L299) | 'action' => 'updateDelta', |
| [300](#L300) | 'type'   => 'terms', |
| [301](#L301) | 'delta'  => 1, |
| [302](#L302) | ) |
| [303](#L303) | ); |
| [304](#L304) | } |
| [305](#L305) |  |
| [306](#L306) | /\*\* |
| [307](#L307) | \* Send message when a user has been imported. |
| [308](#L308) | \* |
| [309](#L309) | \* @since 1.1.0 |
| [310](#L310) | \*/ |
| [311](#L311) | public function imported\_user() { |
| [312](#L312) | $this->emit\_sse\_message( |
| [313](#L313) | array( |
| [314](#L314) | 'action' => 'updateDelta', |
| [315](#L315) | 'type'   => 'users', |
| [316](#L316) | 'delta'  => 1, |
| [317](#L317) | ) |
| [318](#L318) | ); |
| [319](#L319) | } |
| [320](#L320) |  |
| [321](#L321) | /\*\* |
| [322](#L322) | \* Emit a Server-Sent Events message. |
| [323](#L323) | \* |
| [324](#L324) | \* @since 1.1.0 |
| [325](#L325) | \* @param mixed $data Data to be JSON-encoded and sent in the message. |
| [326](#L326) | \*/ |
| [327](#L327) | public function emit\_sse\_message( $data ) { |
| [328](#L328) | echo "event: message\n"; |
| [329](#L329) | echo 'data: ' . wp\_json\_encode( $data ) . "\n\n"; |
| [330](#L330) |  |
| [331](#L331) | // Extra padding. |
| [332](#L332) | echo ':' . str\_repeat( ' ', 2048 ) . "\n\n"; |
| [333](#L333) |  |
| [334](#L334) | flush(); |
| [335](#L335) | } |
| [336](#L336) |  |
| [337](#L337) |  |
| [338](#L338) |  |
| [339](#L339) |  |
| [340](#L340) | public function elementor\_competibilty() { |
| [341](#L341) |  |
| [342](#L342) | /\*\* |
| [343](#L343) | \* Add Slashes |
| [344](#L344) | \* |
| [345](#L345) | \* @todo    Elementor already have below code which works on defining the constant `WP\_LOAD\_IMPORTERS`. |
| [346](#L346) | \*          After defining the constant `WP\_LOAD\_IMPORTERS` in WP CLI it was not works. |
| [347](#L347) | \*          Try to remove below duplicate code in future. |
| [348](#L348) | \*/ |
| [349](#L349) | if ( defined( 'WP\_CLI' ) || ( defined( 'ELEMENTOR\_VERSION' ) && version\_compare( ELEMENTOR\_VERSION, '3.0.0', '>=' ) ) ) { |
| [350](#L350) | remove\_filter( 'wp\_import\_post\_meta', array( 'Elementor\Compatibility', 'wp\_import\_post\_meta' ) ); |
| [351](#L351) | remove\_filter( 'wxr\_importer.pre\_process.post\_meta', array( 'Elementor\Compatibility', 'wxr\_importer\_process\_post\_meta' ) ); |
| [352](#L352) |  |
| [353](#L353) | add\_filter( 'wp\_import\_post\_meta', array( $this, 'wp\_import\_post\_meta' ) ); |
| [354](#L354) | add\_filter( 'wxr\_importer.pre\_process.post\_meta', array( $this, 'wxr\_importer\_process\_post\_meta' ) ); |
| [355](#L355) | } |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | /\*\* |
| [359](#L359) | \* Process post meta before WP importer. |
| [360](#L360) | \* |
| [361](#L361) | \* Normalize Elementor post meta on import, We need the `wp\_slash` in order |
| [362](#L362) | \* to avoid the unslashing during the `add\_post\_meta`. |
| [363](#L363) | \*/ |
| [364](#L364) | public function wp\_import\_post\_meta( $post\_meta ) { |
| [365](#L365) | foreach ( $post\_meta as &$meta ) { |
| [366](#L366) | if ( '\_elementor\_data' === $meta['key'] ) { |
| [367](#L367) | $meta['value'] = wp\_slash( $meta['value'] ); |
| [368](#L368) | break; |
| [369](#L369) | } |
| [370](#L370) | } |
| [371](#L371) |  |
| [372](#L372) | return $post\_meta; |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | /\*\* |
| [376](#L376) | \* Process post meta before WXR importer. |
| [377](#L377) | \* |
| [378](#L378) | \*/ |
| [379](#L379) | public function wxr\_importer\_process\_post\_meta( $post\_meta ) { |
| [380](#L380) | if ( '\_elementor\_data' === $post\_meta['key'] ) { |
| [381](#L381) | $post\_meta['value'] = wp\_slash( $post\_meta['value'] ); |
| [382](#L382) | } |
| [383](#L383) |  |
| [384](#L384) | return $post\_meta; |
| [385](#L385) | } |
| [386](#L386) |  |
| [387](#L387) |  |
| [388](#L388) |  |
| [389](#L389) |  |
| [390](#L390) | } |
| [391](#L391) |  |
| [392](#L392) | Zita\_Site\_Library\_WXR\_Importer::instance(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/zita-site-library/trunk/importer/wxr-importer.php?format=txt)
* [Original Format](/export/3220224/zita-site-library/trunk/importer/wxr-importer.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_e9482c12_20250110_131923.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3168327)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3168326 "Changeset 3168326")
* [Next Changeset](/changeset/3168328 "Changeset 3168328") →

---

# Changeset 3168327

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/14/2024 08:16:10 AM
([3 months](/timeline?from=2024-10-14T08%3A16%3A10Z&precision=second "See timeline at 10/14/2024 08:16:10 AM") ago)

Author:
wpzita
Message:

version 1.6.4 updated

Location:
[zita-site-library](/browser/zita-site-library?rev=3168327)
Files:

8 edited
1 copied

* [tags/1.6.4](/browser/zita-site-library/tags/1.6.4?rev=3168327 "Show entry in browser")
  (copied)
  *(copied from [zita-site-library/trunk](/browser/zita-site-library/trunk?rev=3105478 "Show original file (revision 3168308)"))*
* [tags/1.6.4/importer/wxr-importer.php](/browser/zita-site-library/tags/1.6.4/importer/wxr-importer.php?rev=3168327 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [tags/1.6.4/inc/importer.php](/browser/zita-site-library/tags/1.6.4/inc/importer.php?rev=3168327 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [tags/1.6.4/readme.txt](/browser/zita-site-library/tags/1.6.4/readme.txt?rev=3168327 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [tags/1.6.4/zita-site-library.php](/browser/zita-site-library/tags/1.6.4/zita-site-library.php?rev=3168327 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [trunk/importer/wxr-importer.php](/browser/zita-site-library/trunk/importer/wxr-importer.php?rev=3168327 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [trunk/inc/importer.php](/browser/zita-site-library/trunk/inc/importer.php?rev=3168327 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [trunk/readme.txt](/browser/zita-site-library/trunk/readme.txt?rev=3168327 "Show entry in browser")
  (modified)
  ([2 diffs](#file7 "Show differences"))
* [trunk/zita-site-library.php](/browser/zita-site-library/trunk/zita-site-library.php?rev=3168327 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [zita-site-library/tags/1.6.4/importer/wxr-importer.php](/changeset/3168327/zita-site-library/tags/1.6.4/importer/wxr-importer.php "Show the changeset 3168327 restricted to zita-site-library/tags/1.6.4/importer/wxr-importer.php")

  | [r3105478](/browser/zita-site-library/trunk/importer/wxr-importer.php?rev=3105478#L159 "Show revision 3105478 of this file in browser") | [r3168327](/browser/zita-site-library/tags/1.6.4/importer/wxr-importer.php?rev=3168327#L159 "Show revision 3168327 of this file in browser") |  |
  | --- | --- | --- |
  | 159 | 159 | \*/ |
  | 160 | 160 | public function custom\_upload\_mimes( $mimes ) { |
  | 161 |  |  |
  |  | 161 | if ( current\_user\_can( 'manage\_options' ) ) { |
  | 162 | 162 | // Allow SVG files. |
  | 163 | 163 | $mimes['svg']  = 'image/svg+xml'; |
  | […](/browser/zita-site-library/trunk/importer/wxr-importer.php?rev=3105478#L166) | […](/browser/zita-site-library/tags/1.6.4/importer/wxr-importer.php?rev=3168327#L166) |  |
  | 166 | 166 | // Allow XML files. |
  | 167 | 167 | $mimes['xml'] = 'application/xml'; |
  | 168 |  |  |
  |  | 168 | } |
  | 169 | 169 | return $mimes; |
  | 170 | 170 | } |
* ## [zita-site-library/tags/1.6.4/inc/importer.php](/changeset/3168327/zita-site-library/tags/1.6.4/inc/importer.php "Show the changeset 3168327 restricted to zita-site-library/tags/1.6.4/inc/importer.php")

  | [r1949595](/browser/zita-site-library/trunk/inc/importer.php?rev=1949595#L147 "Show revision 1949595 of this file in browser") | [r3168327](/browser/zita-site-library/tags/1.6.4/inc/importer.php?rev=3168327#L147 "Show revision 3168327 of this file in browser") |  |
  | --- | --- | --- |
  | 147 | 147 | \*/ |
  | 148 | 148 | public function custom\_upload\_mimes( $mimes ) { |
  | 149 |  |  |
  | 150 |  | // Allow SVG files. |
  | 151 |  | $mimes['svg']  = 'image/svg+xml'; |
  | 152 |  | $mimes['svgz'] = 'image/svg+xml'; |
  | 153 |  |  |
  | 154 |  | // Allow XML files. |
  | 155 |  | $mimes['xml'] = 'application/xml'; |
  | 156 |  |  |
  |  | 149 | if ( current\_user\_can( 'manage\_options' ) ) { |
  |  | 150 | // Allow SVG files. |
  |  | 151 | $mimes['svg']  = 'image/svg+xml'; |
  |  | 152 | $mimes['svgz'] = 'image/svg+xml'; |
  |  | 153 |  |
  |  | 154 | // Allow XML files. |
  |  | 155 | $mimes['xml'] = 'application/xml'; |
  |  | 156 | } |
  | 157 | 157 | return $mimes; |
  | 158 | 158 | } |
* ## [zita-site-library/tags/1.6.4/readme.txt](/changeset/3168327/zita-site-library/tags/1.6.4/readme.txt "Show the changeset 3168327 restricted to zita-site-library/tags/1.6.4/readme.txt")

  | [r3103907](/browser/zita-site-library/trunk/readme.txt?rev=3103907#L4 "Show revision 3103907 of this file in browser") | [r3168327](/browser/zita-site-library/tags/1.6.4/readme.txt?rev=3168327#L4 "Show revision 3168327 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags: demo, theme demos, one click import |
  | 5 | 5 | Requires at least: 5.5 |
  | 6 |  | Tested up to: 6.~~5~~ |
  | 7 |  | Stable tag: 1.6.~~3~~ |
  |  | 6 | Tested up to: 6.6 |
  |  | 7 | Stable tag: 1.6.4 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/zita-site-library/trunk/readme.txt?rev=3103907#L29) | […](/browser/zita-site-library/tags/1.6.4/readme.txt?rev=3168327#L29) |  |
  | 29 | 29 |  |
  | 30 | 30 | == Changelog == |
  |  | 31 | = Version 1.6.4 14/10/2024 = |
  |  | 32 | \* SVG upload user security has been added. |
  | 31 | 33 |  |
  | 32 | 34 | = Version 1.6.3 18/06/2024 = |
* ## [zita-site-library/tags/1.6.4/zita-site-library.php](/changeset/3168327/zita-site-library/tags/1.6.4/zita-site-library.php "Show the changeset 3168327 restricted to zita-site-library/tags/1.6.4/zita-site-library.php")

  | [r3103907](/browser/zita-site-library/trunk/zita-site-library.php?rev=3103907#L4 "Show revision 3103907 of this file in browser") | [r3168327](/browser/zita-site-library/tags/1.6.4/zita-site-library.php?rev=3168327#L4 "Show revision 3168327 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wpzita.com/zita-site-library |
  | 5 | 5 | \* Description: Zita site library is a addon plugin for Zita WordPress theme. This plugin contain lot of pre made sites for nearly all niches (like : Corporate, E-commerce, Small businesses ). You can import these sites with a single click. |
  | 6 |  | \* Version: 1.6.~~3~~ |
  |  | 6 | \* Version: 1.6.4 |
  | 7 | 7 | \* Author: WPZita |
  | 8 | 8 | \* Author URI: https://wpzita.com |
* ## [zita-site-library/trunk/importer/wxr-importer.php](/changeset/3168327/zita-site-library/trunk/importer/wxr-importer.php "Show the changeset 3168327 restricted to zita-site-library/trunk/importer/wxr-importer.php")

  | [r3105478](/browser/zita-site-library/trunk/importer/wxr-importer.php?rev=3105478#L159 "Show revision 3105478 of this file in browser") | [r3168327](/browser/zita-site-library/trunk/importer/wxr-importer.php?rev=3168327#L159 "Show revision 3168327 of this file in browser") |  |
  | --- | --- | --- |
  | 159 | 159 | \*/ |
  | 160 | 160 | public function custom\_upload\_mimes( $mimes ) { |
  | 161 |  |  |
  |  | 161 | if ( current\_user\_can( 'manage\_options' ) ) { |
  | 162 | 162 | // Allow SVG files. |
  | 163 | 163 | $mimes['svg']  = 'image/svg+xml'; |
  | […](/browser/zita-site-library/trunk/importer/wxr-importer.php?rev=3105478#L166) | […](/browser/zita-site-library/trunk/importer/wxr-importer.php?rev=3168327#L166) |  |
  | 166 | 166 | // Allow XML files. |
  | 167 | 167 | $mimes['xml'] = 'application/xml'; |
  | 168 |  |  |
  |  | 168 | } |
  | 169 | 169 | return $mimes; |
  | 170 | 170 | } |
* ## [zita-site-library/trunk/inc/importer.php](/changeset/3168327/zita-site-library/trunk/inc/importer.php "Show the changeset 3168327 restricted to zita-site-library/trunk/inc/importer.php")

  | [r1949595](/browser/zita-site-library/trunk/inc/importer.php?rev=1949595#L147 "Show revision 1949595 of this file in browser") | [r3168327](/browser/zita-site-library/trunk/inc/importer.php?rev=3168327#L147 "Show revision 3168327 of this file in browser") |  |
  | --- | --- | --- |
  | 147 | 147 | \*/ |
  | 148 | 148 | public function custom\_upload\_mimes( $mimes ) { |
  | 149 |  |  |
  | 150 |  | // Allow SVG files. |
  | 151 |  | $mimes['svg']  = 'image/svg+xml'; |
  | 152 |  | $mimes['svgz'] = 'image/svg+xml'; |
  | 153 |  |  |
  | 154 |  | // Allow XML files. |
  | 155 |  | $mimes['xml'] = 'application/xml'; |
  | 156 |  |  |
  |  | 149 | if ( current\_user\_can( 'manage\_options' ) ) { |
  |  | 150 | // Allow SVG files. |
  |  | 151 | $mimes['svg']  = 'image/svg+xml'; |
  |  | 152 | $mimes['svgz'] = 'image/svg+xml'; |
  |  | 153 |  |
  |  | 154 | // Allow XML files. |
  |  | 155 | $mimes['xml'] = 'application/xml'; |
  |  | 156 | } |
  | 157 | 157 | return $mimes; |
  | 158 | 158 | } |
* ## [zita-site-library/trunk/readme.txt](/changeset/3168327/zita-site-library/trunk/readme.txt "Show the changeset 3168327 restricted to zita-site-library/trunk/readme.txt")

  | [r3103907](/browser/zita-site-library/trunk/readme.txt?rev=3103907#L4 "Show revision 3103907 of this file in browser") | [r3168327](/browser/zita-site-library/trunk/readme.txt?rev=3168327#L4 "Show revision 3168327 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags: demo, theme demos, one click import |
  | 5 | 5 | Requires at least: 5.5 |
  | 6 |  | Tested up to: 6.~~5~~ |
  | 7 |  | Stable tag: 1.6.~~3~~ |
  |  | 6 | Tested up to: 6.6 |
  |  | 7 | Stable tag: 1.6.4 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/zita-site-library/trunk/readme.txt?rev=3103907#L29) | […](/browser/zita-site-library/trunk/readme.txt?rev=3168327#L29) |  |
  | 29 | 29 |  |
  | 30 | 30 | == Changelog == |
  |  | 31 | = Version 1.6.4 14/10/2024 = |
  |  | 32 | \* SVG upload user security has been added. |
  | 31 | 33 |  |
  | 32 | 34 | = Version 1.6.3 18/06/2024 = |
* ## [zita-site-library/trunk/zita-site-library.php](/changeset/3168327/zita-site-library/trunk/zita-site-library.php "Show the changeset 3168327 restricted to zita-site-library/trunk/zita-site-library.php")

  | [r3103907](/browser/zita-site-library/trunk/zita-site-library.php?rev=3103907#L4 "Show revision 3103907 of this file in browser") | [r3168327](/browser/zita-site-library/trunk/zita-site-library.php?rev=3168327#L4 "Show revision 3168327 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wpzita.com/zita-site-library |
  | 5 | 5 | \* Description: Zita site library is a addon plugin for Zita WordPress theme. This plugin contain lot of pre made sites for nearly all niches (like : Corporate, E-commerce, Small businesses ). You can import these sites with a single click. |
  | 6 |  | \* Version: 1.6.~~3~~ |
  |  | 6 | \* Version: 1.6.4 |
  | 7 | 7 | \* Author: WPZita |
  | 8 | 8 | \* Author URI: https://wpzita.com |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3168327)
* [Zip Archive](?format=zip&new=3168327)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_d0c53ca2_20250110_131923.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Zita Elementor Site Library

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fzita-site-library&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fzita-site-library&locale=en_US)

Search plugins

![](https://ps.w.org/zita-site-library/assets/banner-772x250.png?rev=2123123)
![](https://ps.w.org/zita-site-library/assets/icon-256x256.png?rev=1949595)
# Zita Elementor Site Library

By [WPZita](https://wpzita.com)

[Download](https://downloads.wordpress.org/plugin/zita-site-library.1.6.4.zip)

* [Details](https://wordpress.org/plugins/zita-site-library/#description)
* [Reviews](https://wordpress.org/plugins/zita-site-library/#reviews)
* [Installation](https://wordpress.org/plugins/zita-site-library/#installation)
* [Development](https://wordpress.org/plugins/zita-site-library/#developers)

[Support](https://wordpress.org/support/plugin/zita-site-library/)

## Description

Zita site library is a addon plugin for Zita WordPress theme. This plugin contain 21+ ready to use sites for nearly all niches (like : corporate, store, agency, blog, portfolio, restaurant, wedding, construction, hospital, school, interior, car workshop, life coach, wine shop, barber shop, furniture shop, yoga, resume, charity, digital marketing etc ). You can import these sites with a single click. [Please check doc for more info :](https://wpzita.com/docs/how-to-install-zita-site-library-plugin/)

## Screenshots

* [![](https://ps.w.org/zita-site-library/assets/screenshot-1.png?rev=1993505)](https://ps.w.org/zita-site-library/assets/screenshot-1.png?rev=1993505)

  Choose your desired demo.
* [![](https://ps.w.org/zita-site-library/assets/screenshot-2.jpg?rev=1993505)](https://ps.w.org/zita-site-library/assets/screenshot-2.jpg?rev=1993505)

  Install and Activate required plugin.
* [![](https://ps.w.org/zita-site-library/assets/screenshot-3.jpg?rev=1993505)](https://ps.w.org/zita-site-library/assets/screenshot-3.jpg?rev=1993505)

  Import website.
* [![](https://ps.w.org/zita-site-library/assets/screenshot-5.jpg?rev=1993505)](https://ps.w.org/zita-site-library/assets/screenshot-5.jpg?rev=1993505)

## Installation

1. Upload the plugin files to the `/wp-content/plugins/zita-site-library` directory, or install the plugin through the WordPress Dashboard > Plugins > Add New, Search for “Zita site library”.
2. Install and activate plugin.
3. Now go to the Appearance > Zita site library and import desired site.

## Reviews

![](https://secure.gravatar.com/avatar/5df2133dd808e0700897f0fbe690defc37b9ae5eb8983ea9c87fde2e2a5dec83?s=60&d=retro&r=g)
### [Best Plugin](https://wordpress.org/support/topic/best-plugin-727/)

[satyendra](https://profiles.wordpress.org/satyendra61/ "Posts by satyendra")
June 11, 2019

Unique Elementor demo.

[Read all 2 reviews](https://wordpress.org/support/plugin/zita-site-library/reviews/)
## Contributors & Developers

“Zita Elementor Site Library” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/a7a4a5b744bf77d251063b7edfb594232e7ebed8e127169ef5f6fccfbbfc57f1?s=32&d=mm&r=g) [wpzita](https://profiles.wordpress.org/wpzita/)

“Zita Elementor Site Library” has been translated into 1 locale. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/zita-site-library/contributors) for their contributions.

[Translate “Zita Elementor Site Library” into your language.](https://translate.wordpress.org/projects/wp-plugins/zita-site-library)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/zita-site-library/), check out the [SVN repository](https://plugins.svn.wordpress.org/zita-site-library/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/zita-site-library/) by [RSS](https://plugins.trac.wordpress.org/log/zita-site-library/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### Version 1.6.4 14/10/2024

* SVG upload user security has been added.

#### Version 1.6.3 18/06/2024

* Xml import nonce issue fixed.

#### Version 1.6.2 10/06/2024

* Security issue fixed.

#### Version 1.6.1 19/01/2023

* buy link change

#### Version 1.6.0 28/05/2022

* Preview css added in importer.

#### Version 1.5.12 28/01/2022

* Th Shop Mania – Banner added.

#### Version 1.5.11 28/10/2021

* beaver plugin remove.

#### Version 1.5.10 31/07/2021

* bug fixed.

#### Version 1.5.9 03/06/2021

* Theme notify new feature add.

#### Version 1.5.8 21/04/2021

* theme notify add.

#### Version 1.5.7 17/04/2021

* LicenseChecker file remove.

#### Version 1.5.6 15/04/2021

* class and constant prefix issue fixed.

#### Version 1.5.5 14/04/2021

* sanitize issue fixed.

#### Version 1.5.4 13/04/2021

* escaping and sanitize issue fixed.

#### Version 1.5.3 07/04/2021

* Vulnerability security issue fixed.

#### Version 1.5.2 26/03/2021

* Licenses key issue fixed.

#### Version 1.5.1 03/09/2020

* post pro addons issue fixed.

#### Version 1.5.0 02/09/2020

* Theme demo import issue fixed.

#### Version 1.4.9 13/08/2020

* demo plugin import issue fixed.

#### Version 1.4.8 18/06/2020

* version issue fixed 1.4.8.

#### Version 1.4.7 18/06/2020

* version issue fixed.

#### Version 1.4.6 18/06/2020

* Demo import and display issue fixed.

#### Version 1.4.5 06/04/2020

* elementor addon – heading icon issue fixed.

#### Version 1.4.4 30/12/2019

* Beaver Builder Demo Added.

#### Version 1.4.3 16/11/2019

* style issue fixed.
* dropdown option removed.

#### Version 1.4.2 15/07/2019

* New screenshot added.
* style issue fixed.

#### Version 1.4.1 18/06/2019

* New addon added.

#### Version 1.4.0 11/06/2019

* siteOrigin Demo section added.
* Dropdown page bulder style improved.

#### Version 1.3.13 30/05/2019

* Js error issue fixed.
* Style issue fixed,

#### Version 1.3.12 07/05/2019

* style file added.

#### Version 1.3.11 27/04/2019

* Tab style issue fixed.

#### Version 1.3.10 13/04/2019

* Tab issue fixed.

#### Version 1.3.9 09/04/2019

* Dashboard notification

#### Version 1.3.8 15/03/2019

* addon tab added.

#### Version 1.3.7 15/03/2019

* bug fixed.

#### Version 1.3.6 07/03/2019

* bug fixed.

#### Version 1.3.5 02/03/2019

* issue fixed.

#### Version 1.3.4 19/02/2019

* addon issue fixed.

#### Version 1.3.3 07/02/2019

* addon issue fixed.

#### Version 1.3.2 05/02/2019

* Instagram addon issue fixed.
* addon issue fixed.

#### Version 1.3.1 31/01/2019

* Error fixed.

#### Version 1.3.0 29/01/2019

* Elementor counter and countdown addon added

#### Version 1.2.0 19/01/2019

* New Feature added.
* error fixed.

#### Version 1.1.9 08/01/2019

* Error fixed.

#### Version 1.1.8 04/01/2019

* Style issue fixed.

#### Version 1.1.7 04/01/2019

* Brizy demo section added.

#### Version 1.1.6 21/12/2018

* Style issue fixed.
* Add docs link.

#### Version 1.1.5 19/12/2018

* Bug fixed.

#### Version 1.1.2 19/12/2018

* Elementor Addons added.

#### Version 1.1.1 14/12/2018

* Demo import issue fixed.

#### Version 1.1.0 13/12/2018

* New screenshots added.
* Latest version bug fixed.

#### Version 1.0.9 3/12/2018

* Pro category tab added.
* Pro activated color change.

#### Version 1.0.8 1/12/2018

* License Key and activate pro template feature added.

#### Version 1.0.7 1/12/2018

* Pro class add.
* Bug bixed.

#### Version 1.0.6 26/11/2018

* Customizer import issue fixed.

#### Version 1.0.5 17/10/2018

* style issue fixed.

#### Version 1.0.4 17/10/2018

* All elementor demo import.
* js bug fixed.

#### Version 1.0.3 17/10/2018

* customizer Bug fixed.

#### Version 1.0.2 05/10/2018

* All plugin install issue fixed.
* Dashboard text change.

#### Version 1.0.1 01/10/2018

* Readme text issue fixed.

#### Version 1.0.0 01/10/2018

* Initial release

## Meta

* Version **1.6.4**
* Last updated **3 months ago**
* Active installations **1,000+**
* WordPress version **5.5 or higher**
* Tested up to **6.6.2**
* Languages
  See all 2

  Close

  [English (US)](https://wordpress.org/plugins/zita-site-library/) and [French (France)](https://fr.wordpress.org/plugins/zita-site-library/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/zita-site-library)
* Tags [demo](https://wordpress.org/plugins/tags/demo/)[one click import](https://wordpress.org/plugins/tags/one-click-import/)[theme demos](https://wordpress.org/plugins/tags/theme-demos/)
* [Advanced View](https://wordpress.org/plugins/zita-site-library/advanced/)

## Ratings

5 out of 5 stars.

* [1 5-star review
  5 stars

  1](https://wordpress.org/support/plugin/zita-site-library/reviews/?filter=5)
* [0 4-star reviews
  4 stars

  0](https://wordpress.org/support/plugin/zita-site-library/reviews/?filter=4)
* [0 3-star reviews
  3 stars

  0](https://wordpress.org/support/plugin/zita-site-library/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/zita-site-library/reviews/?filter=2)
* [0 1-star reviews
  1 star

  0](https://wordpress.org/support/plugin/zita-site-library/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/zita-site-library/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/zita-site-library/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/a7a4a5b744bf77d251063b7edfb594232e7ebed8e127169ef5f6fccfbbfc57f1?s=32&d=mm&r=g) [wpzita](https://profiles.wordpress.org/wpzita/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/zita-site-library/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://wpzita.com/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wpzita.com_6289e68a_20250110_131924.html ===


[![WordPress Site Builder](https://150697238.v2.pressablecdn.com/wp-content/uploads/2023/10/zita-whiste-logo-32.png)](https://wpzita.com/)

* [Home](https://wpzita.com/)
* [Premium](https://wpzita.com/premium/)
* [Documentation](https://wpzita.com/docs/install-free-zita-site-builder/)
* [Blog](https://wpzita.com/blog/)
* [Suggestions](https://wpzita.com/suggestions/)
* [Help & Support](https://wpzita.com/builder-support/)
* [Members](https://members.themehunk.com/login)

![](https://150697238.v2.pressablecdn.com/wp-content/uploads/2023/11/zita-changelog-31.jpg)

## Zita Site Builder

Version 1.0.0

Latest Release Date: 11 NOV 2023

[Buy Now](https://wpzita.com/#pricing)

## Changelog

Latest Version: 1.0.0

* Current Version- Latest Relese

[* ![](https://150697238.v2.pressablecdn.com/wp-content/uploads/2018/09/f-b-community1.png) Join Facebook Group (For User Discussion)](https://www.facebook.com/groups/2098900630396072/)

### Company

* [Affiliates Program](https://wpzita.com/affiliate/)
* [Pricing](https://wpzita.com/pricing/)
* [Blog](https://wpzita.com/blog/)
* [Site Map](https://wpzita.com/site-map/)
* [Install & Download](https://wpzita.com/free-download/)

### Help Desk

* [Documentation](https://wpzita.com/docs)
* [Contact Us](https://wpzita.com/contact-us/)
* [Recommendations](https://wpzita.com/recommendations/)
* [Help](https://wpzita.com/help/)
* [FAQ](https://wpzita.com/pricing/#faq)
* [Changelog](https://wpzita.com/changelog/)

### Services We Offer

* [WordPress Installation](https://wpzita.com/services/#wpinstall)
* [Site Transfer](https://wpzita.com/services/#site-transfer)
* [Custom Websites](https://wpzita.com/services/#customweb)
### Legal

* [Terms of use](https://wpzita.com/terms-of-use/)
* [Privacy Policy](https://wpzita.com/privacy-policy/)

### Join Us

## News Letter

 You agree with the storage of your data.

Thank you for subscribing!

© Copyright 2024 Zita Site Builder

![](https://150697238.v2.pressablecdn.com/wp-content/uploads/2019/06/Secure-Zita1.png)



=== Content from plugins.trac.wordpress.org_d4262f9d_20250110_131922.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fzita-site-library%2Ftrunk%2Finc%2Fimporter.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/zita-site-library/trunk/inc/importer.php?rev=1949595 "Revision 1949595")
* Next Revision →
* [Blame](/browser/zita-site-library/trunk/inc/importer.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/zita-site-library/trunk/inc/importer.php)

---

# [source:](/browser?order=name "Go to repository root") [zita-site-library](/browser/zita-site-library?order=name "View zita-site-library")/[trunk](/browser/zita-site-library/trunk?order=name "View trunk")/[inc](/browser/zita-site-library/trunk/inc?order=name "View inc")/[importer.php](/browser/zita-site-library/trunk/inc/importer.php?order=name "View importer.php")

View diff against:

View revision:

| [Last change](/changeset/3168327/zita-site-library/trunk/inc/importer.php "View differences") on this file was [3168327](/changeset/3168327/ "View changeset 3168327"), checked in by wpzita, [3 months ago](/timeline?from=2024-10-14T08%3A16%3A10Z&precision=second "See timeline at 10/14/2024 08:16:10 AM") |
| --- |
| version 1.6.4 updated |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 8.0 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Class Zita WXR Importer |
| [4](#L4) | \* |
| [5](#L5) | \* @since  1.0.0 |
| [6](#L6) | \*/ |
| [7](#L7) |  |
| [8](#L8) | defined( 'ABSPATH' ) or exit; |
| [9](#L9) |  |
| [10](#L10) | class Zita\_Site\_Library\_WXR\_Importer { |
| [11](#L11) |  |
| [12](#L12) | /\*\* |
| [13](#L13) | \* Instance of Zita\_Site\_Library\_WXR\_Importer |
| [14](#L14) | \* |
| [15](#L15) | \* @since  1.0.0 |
| [16](#L16) | \* @var Zita\_Site\_Library\_WXR\_Importer |
| [17](#L17) | \*/ |
| [18](#L18) | private static $\_instance = null; |
| [19](#L19) |  |
| [20](#L20) | /\*\* |
| [21](#L21) | \* Instantiate Zita\_Site\_Library\_WXR\_Importer |
| [22](#L22) | \* |
| [23](#L23) | \* @since  1.0.0 |
| [24](#L24) | \* @return (Object) Zita\_Site\_Library\_WXR\_Importer. |
| [25](#L25) | \*/ |
| [26](#L26) | public static function instance() { |
| [27](#L27) | if ( ! isset( self::$\_instance ) ) { |
| [28](#L28) | self::$\_instance = new self(); |
| [29](#L29) | } |
| [30](#L30) |  |
| [31](#L31) | return self::$\_instance; |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* Constructor. |
| [36](#L36) | \* |
| [37](#L37) | \* @since  1.0.0 |
| [38](#L38) | \*/ |
| [39](#L39) | private function \_\_construct() { |
| [40](#L40) |  |
| [41](#L41) | if ( ! class\_exists( 'WP\_Importer' ) ) { |
| [42](#L42) | defined( 'WP\_LOAD\_IMPORTERS' ) || define( 'WP\_LOAD\_IMPORTERS', true ); |
| [43](#L43) | require ABSPATH . '/wp-admin/includes/class-wp-importer.php'; |
| [44](#L44) | } |
| [45](#L45) |  |
| [46](#L46) | if ( ! class\_exists( 'WP\_Importer\_Logger' ) ) { |
| [47](#L47) | require\_once ZITA\_SITE\_LIBRARY\_DIR . 'wxr-importer/class-logger.php'; |
| [48](#L48) | } |
| [49](#L49) |  |
| [50](#L50) | if ( ! class\_exists( 'WP\_Importer\_Logger\_ServerSentEvents' ) ) { |
| [51](#L51) | require\_once ZITA\_SITE\_LIBRARY\_DIR . 'wxr-importer/class-wp-importer-logger-serversentevents.php'; |
| [52](#L52) | } |
| [53](#L53) |  |
| [54](#L54) | if ( ! class\_exists( 'WXR\_Importer' ) ) { |
| [55](#L55) | require\_once ZITA\_SITE\_LIBRARY\_DIR . 'wxr-importer/class-wxr-importer.php'; |
| [56](#L56) | } |
| [57](#L57) |  |
| [58](#L58) | if ( ! class\_exists( 'WXR\_Import\_Info' ) ) { |
| [59](#L59) | require\_once ZITA\_SITE\_LIBRARY\_DIR . 'wxr-importer/class-wxr-import-info.php'; |
| [60](#L60) | } |
| [61](#L61) |  |
| [62](#L62) | add\_filter( 'upload\_mimes', array( $this, 'custom\_upload\_mimes' ) ); |
| [63](#L63) | add\_action( 'wp\_ajax\_zita-wxr-import', array( $this, 'sse\_import' ) ); |
| [64](#L64) | add\_filter( 'wxr\_importer.pre\_process.user', '\_\_return\_null' ); |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | /\*\* |
| [68](#L68) | \* Constructor. |
| [69](#L69) | \* |
| [70](#L70) | \* @since  1.1.0 |
| [71](#L71) | \*/ |
| [72](#L72) | function sse\_import() { |
| [73](#L73) |  |
| [74](#L74) | // Start the event stream. |
| [75](#L75) | header( 'Content-Type: text/event-stream' ); |
| [76](#L76) |  |
| [77](#L77) | // Turn off PHP output compression. |
| [78](#L78) | $previous = error\_reporting( error\_reporting() ^ E\_WARNING ); |
| [79](#L79) | ini\_set( 'output\_buffering', 'off' ); |
| [80](#L80) | ini\_set( 'zlib.output\_compression', false ); |
| [81](#L81) | error\_reporting( $previous ); |
| [82](#L82) |  |
| [83](#L83) | if ( $GLOBALS['is\_nginx'] ) { |
| [84](#L84) | // Setting this header instructs Nginx to disable fastcgi\_buffering |
| [85](#L85) | // and disable gzip for this request. |
| [86](#L86) | header( 'X-Accel-Buffering: no' ); |
| [87](#L87) | header( 'Content-Encoding: none' ); |
| [88](#L88) | } |
| [89](#L89) |  |
| [90](#L90) | $xml\_url = urldecode( $\_REQUEST['xml\_url'] ); |
| [91](#L91) | if ( empty( $xml\_url ) ) { |
| [92](#L92) | exit; |
| [93](#L93) | } |
| [94](#L94) |  |
| [95](#L95) | // 2KB padding for IE |
| [96](#L96) | echo ':' . str\_repeat( ' ', 2048 ) . "\n\n"; |
| [97](#L97) |  |
| [98](#L98) | // Time to run the import! |
| [99](#L99) | set\_time\_limit( 0 ); |
| [100](#L100) |  |
| [101](#L101) | // Ensure we're not buffered. |
| [102](#L102) | wp\_ob\_end\_flush\_all(); |
| [103](#L103) | flush(); |
| [104](#L104) |  |
| [105](#L105) | // Are we allowed to create users? |
| [106](#L106) | add\_filter( 'wxr\_importer.pre\_process.user', '\_\_return\_null' ); |
| [107](#L107) |  |
| [108](#L108) | // Keep track of our progress. |
| [109](#L109) | add\_action( 'wxr\_importer.processed.post', array( $this, 'imported\_post' ), 10, 2 ); |
| [110](#L110) | add\_action( 'wxr\_importer.process\_failed.post', array( $this, 'imported\_post' ), 10, 2 ); |
| [111](#L111) | add\_action( 'wxr\_importer.process\_already\_imported.post', array( $this, 'already\_imported\_post' ), 10, 2 ); |
| [112](#L112) | add\_action( 'wxr\_importer.process\_skipped.post', array( $this, 'already\_imported\_post' ), 10, 2 ); |
| [113](#L113) | add\_action( 'wxr\_importer.processed.comment', array( $this, 'imported\_comment' ) ); |
| [114](#L114) | add\_action( 'wxr\_importer.process\_already\_imported.comment', array( $this, 'imported\_comment' ) ); |
| [115](#L115) | add\_action( 'wxr\_importer.processed.term', array( $this, 'imported\_term' ) ); |
| [116](#L116) | add\_action( 'wxr\_importer.process\_failed.term', array( $this, 'imported\_term' ) ); |
| [117](#L117) | add\_action( 'wxr\_importer.process\_already\_imported.term', array( $this, 'imported\_term' ) ); |
| [118](#L118) | add\_action( 'wxr\_importer.processed.user', array( $this, 'imported\_user' ) ); |
| [119](#L119) | add\_action( 'wxr\_importer.process\_failed.user', array( $this, 'imported\_user' ) ); |
| [120](#L120) | // Flush once more. |
| [121](#L121) | flush(); |
| [122](#L122) |  |
| [123](#L123) | $importer = $this->get\_importer(); |
| [124](#L124) | $response = $importer->import( $xml\_url ); |
| [125](#L125) |  |
| [126](#L126) | // Let the browser know we're done. |
| [127](#L127) | $complete = array( |
| [128](#L128) | 'action' => 'complete', |
| [129](#L129) | 'error'  => false, |
| [130](#L130) | ); |
| [131](#L131) | if ( is\_wp\_error( $response ) ) { |
| [132](#L132) | $complete['error'] = $response->get\_error\_message(); |
| [133](#L133) | } |
| [134](#L134) |  |
| [135](#L135) | $this->emit\_sse\_message( $complete ); |
| [136](#L136) | exit; |
| [137](#L137) | } |
| [138](#L138) |  |
| [139](#L139) | /\*\* |
| [140](#L140) | \* Add .xml files as supported format in the uploader. |
| [141](#L141) | \* |
| [142](#L142) | \* @since 1.1.5 Added SVG file support. |
| [143](#L143) | \* |
| [144](#L144) | \* @since 1.0.0 |
| [145](#L145) | \* |
| [146](#L146) | \* @param array $mimes Already supported mime types. |
| [147](#L147) | \*/ |
| [148](#L148) | public function custom\_upload\_mimes( $mimes ) { |
| [149](#L149) | if ( current\_user\_can( 'manage\_options' ) ) { |
| [150](#L150) | // Allow SVG files. |
| [151](#L151) | $mimes['svg']  = 'image/svg+xml'; |
| [152](#L152) | $mimes['svgz'] = 'image/svg+xml'; |
| [153](#L153) |  |
| [154](#L154) | // Allow XML files. |
| [155](#L155) | $mimes['xml'] = 'application/xml'; |
| [156](#L156) | } |
| [157](#L157) | return $mimes; |
| [158](#L158) | } |
| [159](#L159) |  |
| [160](#L160) | /\*\* |
| [161](#L161) | \* Start the xml import. |
| [162](#L162) | \* |
| [163](#L163) | \* @since  1.0.0 |
| [164](#L164) | \* |
| [165](#L165) | \* @param  (String) $path Absolute path to the XML file. |
| [166](#L166) | \*/ |
| [167](#L167) | public function get\_xml\_data( $path ) { |
| [168](#L168) |  |
| [169](#L169) | $args = array( |
| [170](#L170) | 'action'  => 'zita-wxr-import', |
| [171](#L171) | 'id'      => '1', |
| [172](#L172) | 'xml\_url' => $path, |
| [173](#L173) | ); |
| [174](#L174) |  |
| [175](#L175) | $url  = add\_query\_arg( urlencode\_deep( $args ), admin\_url( 'admin-ajax.php' ) ); |
| [176](#L176) |  |
| [177](#L177) | $data = $this->get\_data( $path ); |
| [178](#L178) |  |
| [179](#L179) | return array( |
| [180](#L180) | 'count'   => array( |
| [181](#L181) | 'posts'    => $data->post\_count, |
| [182](#L182) | 'media'    => $data->media\_count, |
| [183](#L183) | 'users'    => count( $data->users ), |
| [184](#L184) | 'comments' => $data->comment\_count, |
| [185](#L185) | 'terms'    => $data->term\_count, |
| [186](#L186) | ), |
| [187](#L187) | 'url'     => $url, |
| [188](#L188) | 'strings' => array( |
| [189](#L189) | 'complete' => \_\_( 'Import complete!', 'zita-templates' ), |
| [190](#L190) | ), |
| [191](#L191) | ); |
| [192](#L192) | } |
| [193](#L193) |  |
| [194](#L194) | /\*\* |
| [195](#L195) | \* Get XML data. |
| [196](#L196) | \* |
| [197](#L197) | \* @since 1.1.0 |
| [198](#L198) | \* @param  string $url Downloaded XML file absolute URL. |
| [199](#L199) | \* @return array  XML file data. |
| [200](#L200) | \*/ |
| [201](#L201) | function get\_data( $url ) { |
| [202](#L202) | $importer = $this->get\_importer(); |
| [203](#L203) | $data     = $importer->get\_preliminary\_information( $url ); |
| [204](#L204) | if ( is\_wp\_error( $data ) ) { |
| [205](#L205) | return $data; |
| [206](#L206) | } |
| [207](#L207) | return $data; |
| [208](#L208) | } |
| [209](#L209) |  |
| [210](#L210) | /\*\* |
| [211](#L211) | \* Get Importer |
| [212](#L212) | \* |
| [213](#L213) | \* @since 1.1.0 |
| [214](#L214) | \* @return object   Importer object. |
| [215](#L215) | \*/ |
| [216](#L216) | public function get\_importer() { |
| [217](#L217) | $options  = apply\_filters( |
| [218](#L218) | 'zita\_site\_library\_xml\_import\_options', array( |
| [219](#L219) | 'fetch\_attachments' => true, |
| [220](#L220) | 'default\_author'    => get\_current\_user\_id(), |
| [221](#L221) | ) |
| [222](#L222) | ); |
| [223](#L223) | $importer = new WXR\_Importer( $options ); |
| [224](#L224) | $logger   = new WP\_Importer\_Logger\_ServerSentEvents(); |
| [225](#L225) |  |
| [226](#L226) | $importer->set\_logger( $logger ); |
| [227](#L227) | return $importer; |
| [228](#L228) | } |
| [229](#L229) |  |
| [230](#L230) | /\*\* |
| [231](#L231) | \* Send message when a post has been imported. |
| [232](#L232) | \* |
| [233](#L233) | \* @since 1.1.0 |
| [234](#L234) | \* @param int   $id Post ID. |
| [235](#L235) | \* @param array $data Post data saved to the DB. |
| [236](#L236) | \*/ |
| [237](#L237) | public function imported\_post( $id, $data ) { |
| [238](#L238) | $this->emit\_sse\_message( |
| [239](#L239) | array( |
| [240](#L240) | 'action' => 'updateDelta', |
| [241](#L241) | 'type'   => ( 'attachment' === $data['post\_type'] ) ? 'media' : 'posts', |
| [242](#L242) | 'delta'  => 1, |
| [243](#L243) | ) |
| [244](#L244) | ); |
| [245](#L245) | } |
| [246](#L246) |  |
| [247](#L247) | /\*\* |
| [248](#L248) | \* Send message when a post is marked as already imported. |
| [249](#L249) | \* |
| [250](#L250) | \* @since 1.1.0 |
| [251](#L251) | \* @param array $data Post data saved to the DB. |
| [252](#L252) | \*/ |
| [253](#L253) | public function already\_imported\_post( $data ) { |
| [254](#L254) | $this->emit\_sse\_message( |
| [255](#L255) | array( |
| [256](#L256) | 'action' => 'updateDelta', |
| [257](#L257) | 'type'   => ( 'attachment' === $data['post\_type'] ) ? 'media' : 'posts', |
| [258](#L258) | 'delta'  => 1, |
| [259](#L259) | ) |
| [260](#L260) | ); |
| [261](#L261) | } |
| [262](#L262) |  |
| [263](#L263) | /\*\* |
| [264](#L264) | \* Send message when a comment has been imported. |
| [265](#L265) | \* |
| [266](#L266) | \* @since 1.1.0 |
| [267](#L267) | \*/ |
| [268](#L268) | public function imported\_comment() { |
| [269](#L269) | $this->emit\_sse\_message( |
| [270](#L270) | array( |
| [271](#L271) | 'action' => 'updateDelta', |
| [272](#L272) | 'type'   => 'comments', |
| [273](#L273) | 'delta'  => 1, |
| [274](#L274) | ) |
| [275](#L275) | ); |
| [276](#L276) | } |
| [277](#L277) |  |
| [278](#L278) | /\*\* |
| [279](#L279) | \* Send message when a term has been imported. |
| [280](#L280) | \* |
| [281](#L281) | \* @since 1.1.0 |
| [282](#L282) | \*/ |
| [283](#L283) | public function imported\_term() { |
| [284](#L284) | $this->emit\_sse\_message( |
| [285](#L285) | array( |
| [286](#L286) | 'action' => 'updateDelta', |
| [287](#L287) | 'type'   => 'terms', |
| [288](#L288) | 'delta'  => 1, |
| [289](#L289) | ) |
| [290](#L290) | ); |
| [291](#L291) | } |
| [292](#L292) |  |
| [293](#L293) | /\*\* |
| [294](#L294) | \* Send message when a user has been imported. |
| [295](#L295) | \* |
| [296](#L296) | \* @since 1.1.0 |
| [297](#L297) | \*/ |
| [298](#L298) | public function imported\_user() { |
| [299](#L299) | $this->emit\_sse\_message( |
| [300](#L300) | array( |
| [301](#L301) | 'action' => 'updateDelta', |
| [302](#L302) | 'type'   => 'users', |
| [303](#L303) | 'delta'  => 1, |
| [304](#L304) | ) |
| [305](#L305) | ); |
| [306](#L306) | } |
| [307](#L307) |  |
| [308](#L308) | /\*\* |
| [309](#L309) | \* Emit a Server-Sent Events message. |
| [310](#L310) | \* |
| [311](#L311) | \* @since 1.1.0 |
| [312](#L312) | \* @param mixed $data Data to be JSON-encoded and sent in the message. |
| [313](#L313) | \*/ |
| [314](#L314) | public function emit\_sse\_message( $data ) { |
| [315](#L315) | echo "event: message\n"; |
| [316](#L316) | echo 'data: ' . wp\_json\_encode( $data ) . "\n\n"; |
| [317](#L317) |  |
| [318](#L318) | // Extra padding. |
| [319](#L319) | echo ':' . str\_repeat( ' ', 2048 ) . "\n\n"; |
| [320](#L320) |  |
| [321](#L321) | flush(); |
| [322](#L322) | } |
| [323](#L323) |  |
| [324](#L324) | } |
| [325](#L325) |  |
| [326](#L326) | Zita\_Site\_Library\_WXR\_Importer::instance(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/zita-site-library/trunk/inc/importer.php?format=txt)
* [Original Format](/export/3220224/zita-site-library/trunk/inc/importer.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


