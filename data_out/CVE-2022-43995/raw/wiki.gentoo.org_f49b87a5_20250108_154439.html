<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>doas - Gentoo wiki</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":!1,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"658b2125fce6806109b63ac3","wgCSPNonce":!1,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":0,"wgPageName":"Doas","wgTitle":"Doas","wgCurRevisionId":1325055,"wgRevisionId":1325055,"wgArticleId":268704,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Command line tools"],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Doas","wgRelevantArticleId":268704,"wgIsProbablyEditable":!1,"wgRelevantPageIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgULSCurrentAutonym":"English","wgPageFormsTargetName":null,
"wgPageFormsAutocompleteValues":[],"wgPageFormsAutocompleteOnAllChars":!1,"wgPageFormsFieldProperties":[],"wgPageFormsCargoFields":[],"wgPageFormsDependentFields":[],"wgPageFormsCalendarValues":[],"wgPageFormsCalendarParams":[],"wgPageFormsCalendarHTML":null,"wgPageFormsGridValues":[],"wgPageFormsGridParams":[],"wgPageFormsContLangYes":null,"wgPageFormsContLangNo":null,"wgPageFormsContLangMonths":[],"wgPageFormsHeightForMinimizingInstances":800,"wgPageFormsShowOnSelect":[],"wgPageFormsScriptPath":"/extensions/PageForms","edgValues":null,"wgPageFormsEDSettings":null,"wgAmericanDates":!1,"srfFilteredConfig":null,"wgULSPosition":"personal","wgULSisCompactLinksEnabled":!0};RLSTATE={"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.pygments":"ready","mediawiki.toc.styles":"ready","ext.smw.style":"ready","ext.smw.tooltip.styles":"ready","ext.uls.pt":"ready","ext.srf.styles":"ready","mediawiki.skinning.interface":"ready",
"mediawiki.skinning.content.externallinks":"ready","skins.tyrian.styles":"ready","skins.tyrian.icons":"ready"};RLPAGEMODULES=["ext.gentooPackages","ext.smw.style","ext.smw.tooltips","smw.entityexaminer","site","mediawiki.page.startup","mediawiki.page.ready","mediawiki.toc","ext.uls.compactlinks","ext.uls.interface"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1hzgi",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});});</script>
<link rel="stylesheet" href="/load.php?lang=en&amp;modules=ext.pygments%7Cext.smw.style%7Cext.smw.tooltip.styles%7Cext.uls.pt%7Cmediawiki.skinning.content.externallinks%7Cmediawiki.skinning.interface%7Cmediawiki.toc.styles%7Cskins.tyrian.icons%2Cstyles&amp;only=styles&amp;skin=tyrian"/>
<link rel="stylesheet" href="/load.php?lang=en&amp;modules=ext.srf.styles&amp;only=styles&amp;skin=tyrian"/>
<script async="" src="/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=tyrian"></script>
<link rel="stylesheet" href="https://assets.gentoo.org/tyrian/bootstrap.min.css"/><link rel="stylesheet" href="https://assets.gentoo.org/tyrian/tyrian.min.css"/><style>#mw-indicator-mw-helplink {display:none;}</style>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=tyrian"/>
<meta name="generator" content="MediaWiki 1.35.9"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="theme-color" content="#54487a"/>
<link rel="alternate" type="application/rdf+xml" title="Doas" href="/index.php?title=Special:ExportRDF/Doas&amp;xmlmime=rdf"/>
<link rel="shortcut icon" href="https://www.gentoo.org/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="Gentoo Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.gentoo.org/api.php?action=rsd"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>
<!--[if lt IE 9]><script src="/resources/lib/html5shiv/html5shiv.js"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Doas rootpage-Doas skin-tyrian action-view">	<div class="mw-jump sr-only">
		Jump to:		<a href="#top">content</a>
	</div>
	<header>
		<div class="site-title">
			<div class="container">
				<div class="row">
					<div class="site-title-buttons">
						<div class="btn-group btn-group-sm">
							<a href="https://get.gentoo.org/" role="button" class="btn get-gentoo"><span class="fa fa-fw fa-download"></span> <strong>Get Gentoo!</strong></a>
							<div class="btn-group btn-group-sm">
								<a class="btn gentoo-org-sites dropdown-toggle" data-toggle="dropdown" data-target="#" href="#">
									<span class="fa fa-fw fa-map-o"></span> <span class="hidden-xs">gentoo.org sites</span> <span class="caret"></span>
								</a>
								<ul class="dropdown-menu dropdown-menu-right">
									<li><a href="https://www.gentoo.org/" title="Gentoo's main website"><span class="fa fa-home fa-fw"></span> gentoo.org</a></li>
									<li><a href="https://wiki.gentoo.org/" title="Find and contribute documentation"><span class="fa fa-file-text-o fa-fw"></span> Wiki</a></li>
									<li><a href="https://bugs.gentoo.org/" title="Discover and report issues with Gentoo"><span class="fa fa-bug fa-fw"></span> Bugs</a></li>
									<li><a href="https://packages.gentoo.org/" title="Find software to install"><span class="fa fa-hdd-o fa-fw"></span> Packages</a></li>
									<li><a href="https://forums.gentoo.org/" title="Discuss with the community"><span class="fa fa-comments-o fa-fw"></span> Forums</a></li>
									<li class="divider"></li>
									<li><a href="https://planet.gentoo.org/" title="Find out what's going on in the dev community"><span class="fa fa-rss fa-fw"></span> Planet</a></li>
									<li><a href="https://archives.gentoo.org/" title="Read up on past discussions"><span class="fa fa-archive fa-fw"></span> Archives</a></li>
									<li><a href="https://devmanual.gentoo.org/" title="Read the development guide"><span class="fa fa-book fa-fw"></span> Devmanual</a></li>
									<li><a href="https://gitweb.gentoo.org/" title="Browse our source code in Gitweb"><span class="fa fa-code fa-fw"></span> Gitweb</a></li>
									<li class="divider"></li>
									<li><a href="https://infra-status.gentoo.org/" title="Get updates on the services provided by the Gentoo infra team"><span class="fa fa-server fa-fw"></span> Infra status</a></li>
								</ul>
							</div>
						</div>
					</div>
					<div class="logo">
						<a href="/" title="Back to the homepage" class="site-logo">
							<img src="https://assets.gentoo.org/tyrian/site-logo.png"  alt="Gentoo Linux Logo" srcset="https://assets.gentoo.org/tyrian/site-logo.svg">
						</a>
						<span class="site-label">Wiki</span>
					</div>
				</div>
			</div>
		</div>
		<nav class="tyrian-navbar" role="navigation">
			<div class="container">
				<div class="row">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
					</div>
					<div class="collapse navbar-collapse navbar-main-collapse">
						<ul class="nav navbar-nav">
							<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-help"><a href="/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li><li id="n-Contribute.21"><a href="/wiki/Gentoo_Wiki:Contributor%27s_guide">Contribute!</a></li>			<li class="dropdown">
				<a href="/wiki/Gentoo_Wiki:Menu-Documentation" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Documentation <span class="caret"></span></a>
				<ul class="dropdown-menu" role="menu"><li id="n-Gentoo-Handbook"><a href="/wiki/Handbook:Main_Page">Gentoo Handbook</a></li><li id="n-Gentoo-FAQ"><a href="/wiki/FAQ">Gentoo FAQ</a></li><li role="presentation" class="divider"></li><li id="n-Core-system"><a href="/wiki/Category:Core_system">Core system</a></li><li id="n-Hardware"><a href="/wiki/Category:Hardware">Hardware</a></li><li id="n-Software"><a href="/wiki/Category:Software">Software</a></li><li id="n-Desktop"><a href="/wiki/Category:Desktop">Desktop</a></li><li id="n-Server-.26-Security"><a href="/wiki/Category:Server_and_Security">Server &amp; Security</a></li><li id="n-Project-.26-Community"><a href="/wiki/Category:Project_and_Community">Project &amp; Community</a></li><li role="presentation" class="divider"></li><li id="n-Gentoo-Projects"><a href="/wiki/Project:Gentoo">Gentoo Projects</a></li>				</ul>
			</li>						</ul>
						<ul class="nav navbar-nav navbar-right hidden-xs">
									<li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-cog"></i> Tools <span class="caret"></span></a>
			<ul class="dropdown-menu" role="menu">
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Doas" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Doas" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="/index.php?title=Doas&amp;oldid=1325055" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="/index.php?title=Doas&amp;action=info" title="More information about this page">Page information</a></li><li id="t-smwbrowselink"><a href="/wiki/Special:Browse/:Doas" rel="search">Browse properties</a></li>			</ul>
		</li>
			<li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
				<span class="fa fa-user" aria-label="Personal tools"></span>
				User				<span class="caret"></span>
			</a>
			<ul class="dropdown-menu" role="menu">
				<li id="pt-uls" class="active"><a href="#" class="uls-trigger">English</a></li><li id="pt-createaccount"><a href="/index.php?title=Special:CreateAccount&amp;returnto=Doas" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/index.php?title=Special:UserLogin&amp;returnto=Doas" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>			</ul>
		</li>
								</ul>
					</div>
				</div>
			</div>
		</nav>
		
		<nav class="navbar navbar-grey navbar-stick" id="wiki-actions" role="navigation">
			<div class="container"><div class="row">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#gw-toolbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>
				<div class="collapse navbar-collapse" id="gw-toolbar">
					<ul class="nav navbar-nav">
					<li id="ca-nstab-main" class="selected active"><a href="/wiki/Doas" title="View the content page [c]" accesskey="c">Page</a></li><li id="ca-talk" class="new"><a href="/index.php?title=Talk:Doas&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t">Discussion</a></li>					</ul>
							<form action="/index.php" id="searchform" class="navbar-form navbar-right" role="search">
			<input type='hidden' name="title" value="Special:Search"/>

				<div class="input-group">
					<input type="search" name="search" placeholder="Search" title="Search Gentoo Wiki [f]" accesskey="f" id="searchInput" class="form-control"/>					<div class="input-group-btn"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton btn btn-default"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton btn btn-default"/></div>
				</div>
		</form>
						<ul class="nav navbar-nav navbar-right hidden-xs">
					<li id="ca-viewsource"><a href="/index.php?title=Doas&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">more <span class="caret"></span></a>
						<ul class="dropdown-menu" role="menu">
					<li id="ca-history"><a href="/index.php?title=Doas&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>							</ul>
						</li>
					</ul>
				</div>
			</div></div>
		</nav>
		</header>
	
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div id="content" class="mw-body" role="main">
						<a id="top"></a>
						
						<h1 id="firstHeading" class="first-header" lang="en">
							<span dir="auto">doas</span>
						</h1>

						<div id="bodyContent" class="mw-body-content">
							<div id="siteSub">From Gentoo Wiki</div>
							<div id="contentSub">
															</div>
												                <div id="jump-to-nav"></div>
					                <a class="mw-jump-link" href="#mw-head">Jump to:navigation</a>
					                <a class="mw-jump-link" href="#searchInput">Jump to:search</a>

							<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><span></span>
</p>
<div id="infobox-stack" class="list-group" style="width: 25em; float: right; clear: right; font-size: 90%; margin-left: 1em;">
<div class="list-group-item text-center" style="padding-top: 3px; padding-bottom: 3px; background-color: #463C65; color: white;"><b>Resources</b></div>
<div id="infobox" class="list-group-item" style="display: flex; align-items: center; padding: 5px; min-height: 3em;"><span style="display: inline-block; width: 3em; overflow: hidden; text-align: center;"><span class="fa fa-hdd-o fa-fw fa-2x"></span></span><span><a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/doas">Package information</a></span></div>
<div id="infobox" class="list-group-item" style="display: flex; align-items: center; padding: 5px; min-height: 3em;"><span style="display: inline-block; width: 3em; overflow: hidden; text-align: center;"><span class="fa fa-wikipedia-w fa-fw fa-2x"></span></span><span><a href="https://en.wikipedia.org/wiki/Doas" class="extiw" title="wikipedia:Doas">Wikipedia</a></span></div>
<div id="infobox" class="list-group-item" style="display: flex; align-items: center; padding: 5px; min-height: 3em;"><span style="display: inline-block; width: 3em; overflow: hidden; text-align: center;"><span class="fa fa-github fa-fw fa-2x"></span></span><span><a rel="nofollow" class="external text" href="https://github.com/Duncaen/OpenDoas">GitHub</a></span></div>
<div id="infobox" class="list-group-item" style="display: flex; align-items: center; padding: 5px; min-height: 3em;"><span style="display: inline-block; width: 3em; overflow: hidden; text-align: center;"><img alt="Ohloh Logo" src="/images/thumb/c/c1/Ohloh-logo.png/30px-Ohloh-logo.png" decoding="async" width="30" height="30" srcset="/images/c/c1/Ohloh-logo.png 1.5x" /></span><span><a rel="nofollow" class="external text" href="https://www.openhub.net/p/OpenDoas">Open Hub</a></span></div>
<div id="infobox" class="list-group-item" style="display: flex; align-items: center; padding: 5px; min-height: 3em;"><span style="display: inline-block; width: 3em; overflow: hidden; text-align: center;"><span class="fa fa-wrench fa-fw fa-2x"></span></span><span><a rel="nofollow" class="external text" href="https://man.openbsd.org/doas">doas(1)</a></span></div>
<div id="infobox" class="list-group-item" style="display: flex; align-items: center; padding: 5px; min-height: 3em;"><span style="display: inline-block; width: 3em; overflow: hidden; text-align: center;"><span class="fa fa-wrench fa-fw fa-2x"></span></span><span><a rel="nofollow" class="external text" href="https://man.openbsd.org/doas.conf">doas.conf(5)</a></span></div>
</div>
<p>The <b>doas</b> command provides a way to perform commands as another user. It aims to be a a simplified and lightweight replacement for <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator"><a href="/wiki/Sudo" title="Sudo">sudo</a></span>. The <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> tool was originally written for <a rel="nofollow" class="external text" href="https://www.openbsd.org/">OpenBSD</a> by Ted Unangst. <i>OpenDoas</i> is a port of <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> for Linux, which is available as the <span style="white-space: nowrap;" class="plainlinks" title="External link to https&#58;//packages.gentoo.org for the app-admin/doas package."><a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/doas"><span style="font-family: monospace; font-size: 95%; color: MidnightBlue;">app-admin/doas</span></a><span style="color: grey; margin-left: 0.1em; font-size: 70%;" class="fa fa-hdd-o fa-fw"></span></span> package.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#USE_flags"><span class="tocnumber">1.1</span> <span class="toctext">USE flags</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Emerge"><span class="tocnumber">1.2</span> <span class="toctext">Emerge</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Configuration"><span class="tocnumber">2</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Permissions"><span class="tocnumber">2.1</span> <span class="toctext">Permissions</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Basic_configuration"><span class="tocnumber">2.2</span> <span class="toctext">Basic configuration</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Authentication"><span class="tocnumber">2.3</span> <span class="toctext">Authentication</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Persist"><span class="tocnumber">2.3.1</span> <span class="toctext">Persist</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#Commands"><span class="tocnumber">2.4</span> <span class="toctext">Commands</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Environment_variables"><span class="tocnumber">2.5</span> <span class="toctext">Environment variables</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Testing"><span class="tocnumber">2.6</span> <span class="toctext">Testing</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Targets"><span class="tocnumber">2.7</span> <span class="toctext">Targets</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Bash_tab_completion"><span class="tocnumber">2.8</span> <span class="toctext">Bash tab completion</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#Usage"><span class="tocnumber">3</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#See_also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#External_resources"><span class="tocnumber">5</span> <span class="toctext">External resources</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<h3><span class="mw-headline" id="USE_flags">USE flags</span></h3>
<p class="mw-empty-elt">      </p><div class="panel panel-default gp-panel">
        <div class="panel-heading gp-panel-heading">
          <h3 class="panel-title">
            <span class="text-muted">USE flags for</span>
            <a href="https://packages.gentoo.org/packages/app-admin/doas">app-admin/doas</a>
            <small><span class="fa fa-external-link-square"></span></small>
            <small class="gp-pkg-desc">Run commands as super/another user (alt sudo) (unofficial port from OpenBSD)</small>
          </h3>
        </div>
        <div class="table-responsive gp-useflag-table-container">
                <table class="table gp-useflag-table">        <tbody><tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/pam">pam</a></code>
          </td>
          <td>
            Add support for PAM (Pluggable Authentication Modules) - DANGEROUS to arbitrarily flip
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/persist">persist</a></code>
          </td>
          <td>
            Adds support for &quot;persist&quot; feature (experimental)
          </td>
        </tr>      </tbody></table>
        </div>
        <div class="panel-footer gp-panel-footer">
          <small class="pull-right">
            Data provided by the <a href="https://packages.gentoo.org">Gentoo Package Database</a>
            &#183;
            Last update: 2024-09-12 18:37
          </small>
          <small>
            <a href="/wiki/Handbook:AMD64/Working/USE">More information about USE flags</a>
          </small>
        </div>
      </div>
<p class="mw-empty-elt"></p>
<h3><span class="mw-headline" id="Emerge">Emerge</span></h3>
<div class="cmd-box"><div><code style="color: #ef2929; user-select: none; font-weight: bold;">root <span style="color:royalblue;">#</span></code><code>emerge --ask app-admin/doas</code></div></div> 
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>The <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> tool is configured by the ruleset specified in <span style="font-family: monospace; font-size: 95%; color: #3c763d; font-weight: 600;">/etc/doas.conf</span>. By using an empty configuration file the default ruleset will be applied which denies all actions.
</p>
<h3><span class="mw-headline" id="Permissions">Permissions</span></h3>
<p>Create a empty <span style="font-family: monospace; font-size: 95%; color: #3c763d; font-weight: 600;">/etc/doas.conf</span> file:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; user-select: none; font-weight: bold;">root <span style="color:royalblue;">#</span></code><code>touch /etc/doas.conf</code></div></div>
<p>Set the recommended ownership and permissions for the <span style="font-family: monospace; font-size: 95%; color: #3c763d; font-weight: 600;">/etc/doas.conf</span> file:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; user-select: none; font-weight: bold;">root <span style="color:royalblue;">#</span></code><code>chown -c root:root /etc/doas.conf</code></div></div>
<div class="cmd-box"><div><code style="color: #ef2929; user-select: none; font-weight: bold;">root <span style="color:royalblue;">#</span></code><code>chmod -c 0400 /etc/doas.conf</code></div></div>
<h3><span class="mw-headline" id="Basic_configuration">Basic configuration</span></h3>
<p>A simple skeleton configuration could be to specify a rule which allows all users in the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">wheel</span> group to perform any action as root.
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Allow all users in the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">wheel</span> group to execute any command as root</strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit :wheel
</pre></div>
<p>It's also possible to deny certain actions to specified users. The ruleset is evaluated in a hierarchical manner, thus adding a new rule can override the previous one:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Deny a user to execute a command</strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit :wheel
deny larry cmd fdisk
</pre></div>
<p>The user <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">larry</span> is part of the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">wheel</span> group and therefore may perform actions available to root, but the second rule denies this user access to the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">fdisk</span> command.
</p>
<h3><span class="mw-headline" id="Authentication">Authentication</span></h3>
<p>The <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">nopass</span> keyword provides the ability for users in a certain group to perform elevated actions without having to enter a password:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Allow all users in the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">wheel</span> group to perform actions as root without authentication</strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit nopass :wheel
</pre></div>
<h4><span class="mw-headline" id="Persist">Persist</span></h4>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />Due to OpenBSD-specific kernel API required by <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> to set and clear timeouts, the persist feature is disabled by default in the <i>OpenDoas</i> port.</div>
<p>Using the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">persist</span> keyword <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> can remember an authenticated user and will not require confirmation by password for a time period of five minutes after the last <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> command was entered in the terminal window:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Do not require passwords for five minutes for all users in the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">wheel</span> group</strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit persist :wheel
</pre></div>
<p>Note: Persist support is enabled via the <code>persist</code> USE flag on <span style="white-space: nowrap;" class="plainlinks" title="External link to https&#58;//packages.gentoo.org for the app-admin/doas package."><a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/doas"><span style="font-family: monospace; font-size: 95%; color: MidnightBlue;">app-admin/doas</span></a><span style="color: grey; margin-left: 0.1em; font-size: 70%;" class="fa fa-hdd-o fa-fw"></span></span>
</p>
<h3><span class="mw-headline" id="Commands">Commands</span></h3>
<p>The <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> tool allows the creation of rules which only apply to certain commands.
</p><p>A rule can be specified to allow a certain user to use a command only available to root:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Allow a user to use the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">reboot</span> command without a password</strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit nopass larry cmd /sbin/reboot
</pre></div>
<div class="alert alert-success gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-check-circle"></i> Tip</strong><br />For security reasons, <i>OpenDoas</i> recommends specifying absolute paths like shown above. However, <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> can use the target user's <a href="/wiki/Handbook:X86/Working/EnvVar" title="Handbook:X86/Working/EnvVar">PATH</a> in execution. When configuring <code>permit nopass larry cmd reboot</code> instead, <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">larry</span> does not need to specify the directory path.</div>
<p>This allows the user <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">larry</span> to execute <kbd>doas /sbin/reboot</kbd> without having to enter a password. This may allow users to use restricted commands without providing complete root access.
</p>
<h3><span class="mw-headline" id="Environment_variables">Environment variables</span></h3>
<p>By default, <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> creates a new environment for the program. This behavior may be overridden with the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">setenv</span> and <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">keepenv</span> keywords:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Preserve <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">LANG</span>, <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">LC_ALL</span>, and <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">PATH</span></strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit setenv { LANG LC_ALL PATH } :wheel
</pre></div>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Override <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">PATH</span></strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit setenv { PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin } :wheel
</pre></div>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Preserve all environment variables</strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit keepenv :wheel
</pre></div>
<h3><span class="mw-headline" id="Testing">Testing</span></h3>
<p>A configuration file can be tested as follows:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; user-select: none; font-weight: bold;">user <span style="color:royalblue;">$</span></code><code>doas -C /etc/doas.conf</code></div></div>
<p>Specifying a command to test if the currently running user has permissions to perform a specific command:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; user-select: none; font-weight: bold;">user <span style="color:royalblue;">$</span></code><code>doas -C /etc/doas.conf cat</code></div></div>
<p>This test will output <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">deny</span> if the currently running user does not have the permissions to execute the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">cat</span> command.
</p><p>Permissions can be checked for a specified user via:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; user-select: none; font-weight: bold;">user <span style="color:royalblue;">$</span></code><code>doas -C /etc/doas.conf cat -u larry</code></div></div>
<p>If the user <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">larry</span> has permissions to access <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">cat</span> it may output <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">permit</span>.
</p>
<h3><span class="mw-headline" id="Targets">Targets</span></h3>
<p>The <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> can not only be used to perform actions with root privileges, it also allows to target certain users.
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/doas.conf</code></strong><strong>Allow a user to perform actions as another user</strong></div> <div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>permit nopass larry as postgres
</pre></div>
<p>By adding this rule, the user <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">larry</span> is allowed to perform actions as the <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">postgres</span> user without having to enter a password.
</p>
<h3><span class="mw-headline" id="Bash_tab_completion">Bash tab completion</span></h3>
<p>By default <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">bash</span> will only tab complete files and directories within the current or referenced directory. To tell bash to complete arguments as if they were separate commands (also leveraging the tab completion settings of other commands) the following can be added to either the users <span style="font-family: monospace; font-size: 95%; color: #3c763d; font-weight: 600;">.bashrc</span>, or the global <span style="font-family: monospace; font-size: 95%; color: #3c763d; font-weight: 600;">/etc/bashrc</span>.
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">~/.bashrc</code></strong><strong>Configure tab completion</strong></div> <div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">#     Complete arguments as if they were commands</span>
<span class="c1">#     (eg: `doas emer&lt;tab&gt;` -&gt; `doas emerge`)</span>
<span class="c1">#     (eg: `doas dd status=p&lt;tab&gt;` -&gt; `doas dd status=progress`)</span>
<span class="c1">#    Complete arguments as if they were directory names (default behavior)</span>
<span class="c1">#     (eg: `doas /bi&lt;tab&gt;` -&gt; `doas /bin/`)</span>
<span class="c1"># If you have app-shells/bash-completion installed</span>
<span class="nb">complete</span><span class="w"> </span>-F<span class="w"> </span>_root_command<span class="w"> </span>doas
<span class="c1"># Alternative that doesn&#39;t require app-shells/bash-completion</span>
<span class="c1"># However this doesn&#39;t complete arguments, among other things</span>
<span class="nb">complete</span><span class="w"> </span>-cf<span class="w"> </span>doas
</pre></div>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>The <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">doas</span> command can be used like <span style="font-family: monospace; font-size: 95%; font-weight: bold;" class="tripleclick-separator">sudo</span>:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; user-select: none; font-weight: bold;">user <span style="color:royalblue;">$</span></code><code>doas emerge -uDN @world</code></div></div>
<p>See <a rel="nofollow" class="external text" href="https://man.openbsd.org/doas">doas(1)</a> for more information.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a href="/wiki/Su" title="Su">su</a> — used to adopt the privileges of other users from the system</li>
<li><a href="/wiki/Sudo" title="Sudo">sudo</a> — provides a simple and secure way to configure privilege escalation</li></ul>
<h2><span class="mw-headline" id="External_resources">External resources</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://man.openbsd.org/doas.conf.5">doas configuration file man page</a></li></ul>
<!-- 
NewPP limit report
Cached time: 20250108032449
Cache expiry: 86400
Dynamic content: false
Complications: []
[SMW] In‐text annotation parser time: 0.001 seconds
CPU time usage: 0.136 seconds
Real time usage: 1.032 seconds
Preprocessor visited node count: 2245/1000000
Post‐expand include size: 50378/4194304 bytes
Template argument size: 15805/4194304 bytes
Highest expansion depth: 17/40
Expensive parser function count: 2/150
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 4390/5000000 bytes
Lua time usage: 0.050/7 seconds
Lua virtual size: 4.76 MB/50 MB
Lua estimated memory usage: 0 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  999.119      1 -total
 84.71%  846.307     10 Template:FileBox
 84.43%  843.516     10 Template:PreBox
  9.55%   95.444      1 Template:InfoBox_stack
  8.31%   82.978      6 Template:InfoBox
  7.48%   74.757      8 Template:Anchor
  6.80%   67.932      1 Template:InfoBox_package
  5.58%   55.728      1 Template:InfoBox_header
  1.81%   18.042      2 Template:See_also
  0.88%    8.833      8 Template:GenericCmd
-->

<!-- Saved in parser cache with key gentoo?hwiki:pcache:idhash:268704-0!dateformat=default and timestamp 20250108032448 and revision id 1325055
 -->
</div></div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.gentoo.org/index.php?title=Doas&amp;oldid=1325055">https://wiki.gentoo.org/index.php?title=Doas&amp;oldid=1325055</a>"</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/wiki/Category:Command_line_tools" title="Category:Command line tools">Command line tools</a></li></ul></div></div>						</div>
					</div>
				</div>
			</div>
		</div>

			<footer>
		<div class="container">
			<div class="row">
				<div class="col-xs-12 col-md-offset-2 col-md-7">
											<div class="spacer"></div>
						<ul id="f-list">
							<li id="lastmod>"> This page was last edited on 22 December 2024, at 19:00.</li><li id="privacy>"><a href="/wiki/Gentoo_Wiki:Privacy_policy" class="mw-redirect" title="Gentoo Wiki:Privacy policy">Privacy policy</a></li><li id="about>"><a href="/wiki/Gentoo_Wiki:About" title="Gentoo Wiki:About">About Gentoo Wiki</a></li><li id="disclaimer>"><a href="/wiki/Gentoo_Wiki:General_disclaimer" title="Gentoo Wiki:General disclaimer">Disclaimers</a></li>						</ul>
									</div>
				<div class="col-xs-12 col-md-3">
					<!-- No questions or comments, the Wiki has enough information on how to contact us. -->
				</div>
			</div>
			<div class="row">
				<div class="col-xs-3 col-md-2">
					<ul class="footerlinks three-icons">
						<li><a href="https://twitter.com/gentoo" title="@Gentoo on Twitter"><span class="fa fa-twitter fa-fw"></span></a></li>
						<li><a href="https://www.facebook.com/gentoo.org" title="Gentoo on Facebook"><span class="fa fa-facebook fa-fw"></span></a></li>
						<li></li>
					</ul>
				</div>
				<div class="col-xs-9 col-md-9">
					<strong>&copy; 2001&ndash;2025 Gentoo Authors</strong><br />
					<small>
						Gentoo is a trademark of the Gentoo Foundation, Inc. and of Förderverein Gentoo e.V.
						The contents of this document, unless otherwise expressly stated, are licensed under the
						<a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="license">CC-BY-SA-4.0</a> license.
						The <a href="https://www.gentoo.org/inside-gentoo/foundation/name-logo-guidelines.html">Gentoo Name and Logo Usage Guidelines</a> apply.
					</small>
				</div>
			</div>
		</div>
	</footer>
	
<script>
function defer(method) {
    if (window.jQuery) {
        method();
    } else {
        setTimeout(function() { defer(method) }, 50);
    }
}
defer(function() { mw.loader.load( 'https://assets.gentoo.org/tyrian/bootstrap.min.js'); });
</script>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"smw":{"limitreport-intext-parsertime":0.001},"limitreport":{"cputime":"0.136","walltime":"1.032","ppvisitednodes":{"value":2245,"limit":1000000},"postexpandincludesize":{"value":50378,"limit":4194304},"templateargumentsize":{"value":15805,"limit":4194304},"expansiondepth":{"value":17,"limit":40},"expensivefunctioncount":{"value":2,"limit":150},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":4390,"limit":5000000},"timingprofile":["100.00%  999.119      1 -total"," 84.71%  846.307     10 Template:FileBox"," 84.43%  843.516     10 Template:PreBox","  9.55%   95.444      1 Template:InfoBox_stack","  8.31%   82.978      6 Template:InfoBox","  7.48%   74.757      8 Template:Anchor","  6.80%   67.932      1 Template:InfoBox_package","  5.58%   55.728      1 Template:InfoBox_header","  1.81%   18.042      2 Template:See_also","  0.88%    8.833      8 Template:GenericCmd"]},"scribunto":{"limitreport-timeusage":{"value":"0.050","limit":"7"},"limitreport-virtmemusage":{"value":4993024,"limit":52428800},"limitreport-estmemusage":0},"cachereport":{"timestamp":"20250108032449","ttl":86400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":92});});</script></body></html>