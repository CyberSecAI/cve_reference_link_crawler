

* [Home](https://archlinux.org/)
* [Packages](https://archlinux.org/packages/)
* [Forums](https://bbs.archlinux.org/)
* [Wiki](https://wiki.archlinux.org/)
* [GitLab](https://gitlab.archlinux.org/archlinux)
* [Security](https://security.archlinux.org/)
* [AUR](https://aur.archlinux.org/)
* [Download](https://archlinux.org/download/)

[Jump to content](#bodyContent)

Main menu

Main menu
move to sidebar
hide

Navigation

* [Main page](/title/Main_page "Visit the main page [z]")
* [Table of contents](/title/Table_of_contents)
* [Getting involved](/title/Getting_involved "Various ways Archers can contribute to the community")
* [Wiki news](/title/ArchWiki%3ANews "The latest lowdown on the wiki")
* [Random page](/title/Special%3ARandom "Load a random page [x]")

Interaction

* [Help](/title/Category%3AHelp "Wiki navigation, reading, and editing help")
* [Contributing](/title/ArchWiki%3AContributing)
* [Recent changes](/title/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent talks](https://wiki.archlinux.org/index.php?title=Special:RecentChanges&namespace=all-discussions)
* [New pages](/title/Special%3ANewPages)
* [Statistics](/title/ArchWiki%3AStatistics)
* [Requests](/title/ArchWiki_talk%3ARequests)

[**ArchWiki**](/title/Main_page)

[Search](/title/Special%3ASearch "Search ArchWiki [f]")

Search

* [Create account](/index.php?title=Special:CreateAccount&returnto=Doas "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/index.php?title=Special:UserLogin&returnto=Doas "You are encouraged to log in; however, it is not mandatory [o]")

Personal tools

* [Create account](/index.php?title=Special:CreateAccount&returnto=Doas "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/index.php?title=Special:UserLogin&returnto=Doas "You are encouraged to log in; however, it is not mandatory [o]")
* Dark mode

## Contents

move to sidebar
hide

* Beginning
* [1Installation](#Installation)
* [2Usage](#Usage)
* [3Configuration](#Configuration)
* [4Tips and tricks](#Tips_and_tricks)

  Toggle Tips and tricks subsection
  + [4.1doas persist feature](#doas_persist_feature)
  + [4.2Smooth transition sudo to doas](#Smooth_transition_sudo_to_doas)
  + [4.3Bash tab completion](#Bash_tab_completion)

Toggle the table of contents

# doas

3 languages

* [日本語](https://wiki.archlinux.jp/index.php/Doas "Doas – 日本語")
* [Русский](https://wiki.archlinux.org/title/Doas_%28%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9%29 "Doas – русский")
* [中文（简体）](https://wiki.archlinuxcn.org/wiki/Doas "Doas – 中文（简体）")

* [Page](/title/Doas "View the content page [c]")
* [Discussion](/title/Talk%3ADoas "Discussion about the content page [t]")

English

* [Read](/title/Doas)
* [View source](/index.php?title=Doas&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=Doas&action=history "Past revisions of this page [h]")

Tools

Tools
move to sidebar
hide

Actions

* [Read](/title/Doas)
* [View source](/index.php?title=Doas&action=edit)
* [View history](/index.php?title=Doas&action=history)

General

* [What links here](/title/Special%3AWhatLinksHere/Doas "A list of all wiki pages that link here [j]")
* [Related changes](/title/Special%3ARecentChangesLinked/Doas "Recent changes in pages linked from this page [k]")
* [Special pages](/title/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=Doas&oldid=820859 "Permanent link to this revision of this page")
* [Page information](/index.php?title=Doas&action=info "More information about this page")

From ArchWiki

Related articles

* [Users and groups](/title/Users_and_groups "Users and groups")
* [sudo](/title/Sudo "Sudo")
* [List of applications/Security#Privilege elevation](/title/List_of_applications/Security#Privilege_elevation "List of applications/Security")

[OpenDoas](https://en.wikipedia.org/wiki/doas "wikipedia:doas") is a portable version of OpenBSD's doas command, known for being substantially smaller in size compared to [sudo](/title/Sudo "Sudo"). Like *sudo*, *doas* is used to assume the identity of another user on the system.

## Installation

Install the [opendoas](https://archlinux.org/packages/?name=opendoas) package.

## Usage

To begin using *doas* as a non-privileged user, it must be properly configured. See <#Configuration>.

To use *doas*, simply prefix a command and its arguments with `doas` and a space:

```
$ doas cmd

```

For example, to use [pacman](/title/Pacman "Pacman"):

```
$ doas pacman -Syu

```

To get to an interactive shell as an other user (omitting `-u user` will default to root):

```
$ doas -su user

```

Logging in as an other user is needed for some commands, see [Sudo#Login shell](/title/Sudo#Login_shell "Sudo").

For more information, see [doas(1)](https://man.archlinux.org/man/doas.1).

## Configuration

After installing OpenDoas, it will be attached with [PAM](/title/PAM "PAM"), but no default configuration or examples are included.

To allow members of group [wheel](/title/Wheel "Wheel") to run commands as other users, create a configuration file with the following content:

```
/etc/doas.conf
```
```
permit setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :wheel

```
**Note:**

* The configuration file must end with a newline.
* The `setenv` option works around an [issue](https://github.com/Duncaen/OpenDoas/issues/117) arising from OpenDoas's BSD origin where additional system packages are stored under `/usr/local/bin`. In Linux `/usr/local/bin` is generally used to override executables so it comes before `/usr/bin` which contains executables from packages.

The owner and group for `/etc/doas.conf` should both be `0`, file permissions should be set to `0400`:

```
# chown -c root:root /etc/doas.conf
# chmod -c 0400 /etc/doas.conf

```

To check `/etc/doas.conf` for syntax errors, run:

```
# if doas -C /etc/doas.conf; then echo "config ok"; else echo "config error"; fi

```
**Warning:** It is imperative that `/etc/doas.conf` is free of syntax errors!

To allow members of the `plugdev` group to run [smartctl](/title/Smartctl "Smartctl") without password as [Root user](/title/Root_user "Root user"):

```
/etc/doas.conf
```
```
permit nopass :plugdev as root cmd /usr/bin/smartctl

```

The general syntax form of `/etc/doas.conf` is:

```
permit|deny [options] identity [as target] [cmd command [args ...]]

```

The last matching rule determines the action taken, so rules must be ordered accordingly.

For more details please read [doas.conf(5)](https://man.archlinux.org/man/doas.conf.5).

## Tips and tricks

### doas persist feature

*doas* provides a persist feature: after the user successfully authenticates, they will not be prompted for a password again for 5 minutes. It is disabled by default, enable it with the `persist` option:

```
/etc/doas.conf
```
```
permit persist setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :wheel

```

Executing `doas -L` clears a persisted authentication prior to its automatic timeout.

**Note:** The persist feature is disabled by default, because it is potentially dangerous. In the original *doas*, a kernel API is used to set and clear timeouts. This API is OpenBSD specific and no similar API is available on other operating systems. As a workaround, the persist feature is implemented using timestamp files similar to *sudo*.
### Smooth transition sudo to doas

For a smooth transition from *sudo* to *doas* and to stay downward compatible, you could add to your environment:

```
alias sudo='doas'
alias sudoedit='doas rnano'

```

Or alternatively, symlink *doas* to where *sudo* would normally be (but it does not provide `sudoedit` command):

```
# ln -s $(which doas) /usr/bin/sudo

```

Another way is to install [doas-sudo-shim](https://aur.archlinux.org/packages/doas-sudo-shim/)AUR, which emulates a couple of sudo's options.

**Note:** By default *sudo* preserves some environment variables while *doas* does not, most notably XAUTHORITY, LANG and LC\_ALL. This means you will not be able to start graphical applications under X nor to access the user's locale without further configuration. For instance, to allow members of the *wheel* group to run graphical applications and to access the user's locale using the setenv option:
```
/etc/doas.conf
```
```
permit setenv { XAUTHORITY LANG LC_ALL } :wheel

```
### Bash tab completion

By default Bash will only tab complete files and directories within the current or referenced directory. To tell Bash to complete arguments as if they were separate commands (also leveraging the tab completion settings of other commands) the following can be added to either the users `.bashrc`, or the global `/etc/bash.bashrc`:

```
~/.bashrc
```
```
complete -cf doas

```

If [bash-completion](https://archlinux.org/packages/?name=bash-completion) is installed, the following can be used instead to allow for additional completion of the target command:

```
~/.bashrc
```
```
complete -F _command doas

```

Retrieved from "<https://wiki.archlinux.org/index.php?title=Doas&oldid=820859>"
[Categories](/title/Special%3ACategories "Special:Categories"):

* [Security](/title/Category%3ASecurity "Category:Security")
* [Commands](/title/Category%3ACommands "Category:Commands")

* This page was last edited on 17 November 2024, at 03:39.
* Content is available under [GNU Free Documentation License 1.3 or later](https://www.gnu.org/copyleft/fdl.html) unless otherwise noted.

* [Privacy policy](https://terms.archlinux.org/docs/privacy-policy/)
* [About ArchWiki](/title/ArchWiki%3AAbout)
* [Disclaimers](/title/ArchWiki%3AGeneral_disclaimer)
* [Code of conduct](https://terms.archlinux.org/docs/code-of-conduct/ "archlinux-service-agreements:code-of-conduct")
* [Terms of service](https://terms.archlinux.org/docs/terms-of-service/ "archlinux-service-agreements:terms-of-service")

* [![GNU Free Documentation License 1.3 or later](/resources/assets/licenses/gnu-fdl.png)](https://www.gnu.org/copyleft/fdl.html)
* ![](/resources/assets/poweredby_mediawiki_88x31.png)

* Toggle limited content width

