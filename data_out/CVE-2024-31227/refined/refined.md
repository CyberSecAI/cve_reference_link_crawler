The content is related to CVE-2024-31227.

**Root cause of vulnerability:** A malformed ACL selector can cause a server panic. The issue lies in the parsing logic of the ACL selector where it does not handle certain invalid combinations of read/write permissions properly. Specifically, the code was not properly validating that a '%' rule contains at least one of the R (read) or W (write) permissions.

**Weaknesses/vulnerabilities present:**
- Improper input validation when creating ACL selectors.
- Lack of checks for correct permission usage within the selector string.
- Insufficient error handling, leading to a server panic when a malformed selector is accessed.

**Impact of exploitation:**
- Denial of service (DoS) due to server panic.
- Server becomes unavailable, disrupting services relying on it.

**Attack vectors:**
- Maliciously crafted ACL selector via `ACL SETUSER` command.

**Required attacker capabilities/position:**
- Authenticated user with sufficient privileges to create ACL selectors.
- The attacker needs to be able to connect to the Redis server and execute commands.