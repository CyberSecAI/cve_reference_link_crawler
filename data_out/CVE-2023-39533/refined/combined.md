=== Content from github.com_20cada92_20250111_051310.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fcommit%2F2350afd2e8ab054390e284c95d5b089c142db017)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fcommit%2F2350afd2e8ab054390e284c95d5b089c142db017)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=golang%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[go](/golang/go)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fgo) You must be signed in to change notification settings
* [Fork
  17.8k](/login?return_to=%2Fgolang%2Fgo)
* [Star
   125k](/login?return_to=%2Fgolang%2Fgo)

* [Code](/golang/go)
* [Issues
  5k+](/golang/go/issues)
* [Pull requests
  507](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects
  4](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

Additional navigation options

* [Code](/golang/go)
* [Issues](/golang/go/issues)
* [Pull requests](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

## Commit

[Permalink](/golang/go/commit/2350afd2e8ab054390e284c95d5b089c142db017)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

crypto/tls: restrict RSA keys in certificates to <= 8192 bits

[Browse files](/golang/go/tree/2350afd2e8ab054390e284c95d5b089c142db017)
Browse the repository at this point in the history

```
Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Fixes [#61460](https://github.com/golang/go/issues/61460)
Fixes [CVE-2023-29409](https://github.com/advisories/GHSA-xc82-5m89-g4jv "CVE-2023-29409")

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/1912161](https://team-review.git.corp.google.com/c/golang/go-private/%2B/1912161)
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/515257](https://go-review.googlesource.com/c/go/%2B/515257)
TryBot-Result: Gopher Robot <gobot@golang.org>
Auto-Submit: David Chase <drchase@google.com>
Run-TryBot: David Chase <drchase@google.com>
```

* Loading branch information

[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&v=4)](/rolandshoemaker) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

[rolandshoemaker](/golang/go/commits?author=rolandshoemaker "View all commits by rolandshoemaker")
authored and
[gopherbot](/golang/go/commits?author=gopherbot "View all commits by gopherbot")
committed
Aug 2, 2023

1 parent
[fb6f38d](/golang/go/commit/fb6f38dda15d4155b500f6b3e1a311a951a22b69)

commit 2350afd

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**90 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/crypto/tls

  + src/crypto/tls/handshake\_client.go
    [handshake\_client.go](#diff-ab85793b9432fb5bea1142f2582e0c8bba9bec59a90913f95baf35560fdb9d7d)
  + src/crypto/tls/handshake\_client\_test.go
    [handshake\_client\_test.go](#diff-fe7bd8bf0cd02be883ad36aa73b6eee6903a47578f9a1ae6e10da4d5314da8a4)
  + src/crypto/tls/handshake\_server.go
    [handshake\_server.go](#diff-b99af81cc87357c6e332ac9056da4fd30f36d6875758b4a27b86532bf82a066f)

## There are no files selected for viewing

8 changes: 8 additions & 0 deletions

8
[src/crypto/tls/handshake\_client.go](#diff-ab85793b9432fb5bea1142f2582e0c8bba9bec59a90913f95baf35560fdb9d7d "src/crypto/tls/handshake_client.go")

Show comments

[View file](/golang/go/blob/2350afd2e8ab054390e284c95d5b089c142db017/src/crypto/tls/handshake_client.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -936,6 +936,10 @@ func (hs \*clientHandshakeState) sendFinished(out []byte) error { |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | // maxRSAKeySize is the maximum RSA key size in bits that we are willing |
|  |  | // to verify the signatures of during a TLS handshake. |
|  |  | const maxRSAKeySize = 8192 |
|  |  |  |
|  |  | // verifyServerCertificate parses and verifies the provided chain, setting |
|  |  | // c.verifiedChains and c.peerCertificates or sending the appropriate alert. |
|  |  | func (c \*Conn) verifyServerCertificate(certificates [][]byte) error { |
| Expand All | | @@ -947,6 +951,10 @@ func (c \*Conn) verifyServerCertificate(certificates [][]byte) error { |
|  |  | c.sendAlert(alertBadCertificate) |
|  |  | return errors.New("tls: failed to parse certificate from server: " + err.Error()) |
|  |  | } |
|  |  | if cert.cert.PublicKeyAlgorithm == x509.RSA && cert.cert.PublicKey.(\*rsa.PublicKey).N.BitLen() > maxRSAKeySize { |
|  |  | c.sendAlert(alertBadCertificate) |
|  |  | return fmt.Errorf("tls: server sent certificate containing RSA key larger than %d bits", maxRSAKeySize) |
|  |  | } |
|  |  | activeHandles[i] = cert |
|  |  | certs[i] = cert.cert |
|  |  | } |
| Expand Down | |  |

78 changes: 78 additions & 0 deletions

78
[src/crypto/tls/handshake\_client\_test.go](#diff-fe7bd8bf0cd02be883ad36aa73b6eee6903a47578f9a1ae6e10da4d5314da8a4 "src/crypto/tls/handshake_client_test.go")

Show comments

[View file](/golang/go/blob/2350afd2e8ab054390e284c95d5b089c142db017/src/crypto/tls/handshake_client_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2721,3 +2721,81 @@ func testTLS13OnlyClientHelloCipherSuite(t \*testing.T, ciphers []uint16) { |
|  |  | t.Fatalf("handshake failed: %s", err) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // discardConn wraps a net.Conn but discards all writes, but reports that they happened. |
|  |  | type discardConn struct { |
|  |  | net.Conn |
|  |  | } |
|  |  |  |
|  |  | func (dc \*discardConn) Write(data []byte) (int, error) { |
|  |  | return len(data), nil |
|  |  | } |
|  |  |  |
|  |  | // largeRSAKeyCertPEM contains a 8193 bit RSA key |
|  |  | const largeRSAKeyCertPEM = `-----BEGIN CERTIFICATE----- |
|  |  | MIIInjCCBIWgAwIBAgIBAjANBgkqhkiG9w0BAQsFADASMRAwDgYDVQQDEwd0ZXN0 |
|  |  | aW5nMB4XDTIzMDYwNzIxMjMzNloXDTIzMDYwNzIzMjMzNlowEjEQMA4GA1UEAxMH |
|  |  | dGVzdGluZzCCBCIwDQYJKoZIhvcNAQEBBQADggQPADCCBAoCggQBAWdHsf6Rh2Ca |
|  |  | n2SQwn4t4OQrOjbLLdGE1pM6TBKKrHUFy62uEL8atNjlcfXIsa4aEu3xNGiqxqur |
|  |  | ZectlkZbm0FkaaQ1Wr9oikDY3KfjuaXdPdO/XC/h8AKNxlDOylyXwUSK/CuYb+1j |
|  |  | gy8yF5QFvVfwW/xwTlHmhUeSkVSQPosfQ6yXNNsmMzkd+ZPWLrfq4R+wiNtwYGu0 |
|  |  | WSBcI/M9o8/vrNLnIppoiBJJ13j9CR1ToEAzOFh9wwRWLY10oZhoh1ONN1KQURx4 |
|  |  | qedzvvP2DSjZbUccdvl2rBGvZpzfOiFdm1FCnxB0c72Cqx+GTHXBFf8bsa7KHky9 |
|  |  | sNO1GUanbq17WoDNgwbY6H51bfShqv0CErxatwWox3we4EcAmFHPVTCYL1oWVMGo |
|  |  | a3Eth91NZj+b/nGhF9lhHKGzXSv9brmLLkfvM1jA6XhNhA7BQ5Vz67lj2j3XfXdh |
|  |  | t/BU5pBXbL4Ut4mIhT1YnKXAjX2/LF5RHQTE8Vwkx5JAEKZyUEGOReD/B+7GOrLp |
|  |  | HduMT9vZAc5aR2k9I8qq1zBAzsL69lyQNAPaDYd1BIAjUety9gAYaSQffCgAgpRO |
|  |  | Gt+DYvxS+7AT/yEd5h74MU2AH7KrAkbXOtlwupiGwhMVTstncDJWXMJqbBhyHPF8 |
|  |  | 3UmZH0hbL4PYmzSj9LDWQQXI2tv6vrCpfts3Cqhqxz9vRpgY7t1Wu6l/r+KxYYz3 |
|  |  | 1pcGpPvRmPh0DJm7cPTiXqPnZcPt+ulSaSdlxmd19OnvG5awp0fXhxryZVwuiT8G |
|  |  | VDkhyARrxYrdjlINsZJZbQjO0t8ketXAELJOnbFXXzeCOosyOHkLwsqOO96AVJA8 |
|  |  | 45ZVL5m95ClGy0RSrjVIkXsxTAMVG6SPAqKwk6vmTdRGuSPS4rhgckPVDHmccmuq |
|  |  | dfnT2YkX+wB2/M3oCgU+s30fAHGkbGZ0pCdNbFYFZLiH0iiMbTDl/0L/z7IdK0nH |
|  |  | GLHVE7apPraKC6xl6rPWsD2iSfrmtIPQa0+rqbIVvKP5JdfJ8J4alI+OxFw/znQe |
|  |  | V0/Rez0j22Fe119LZFFSXhRv+ZSvcq20xDwh00mzcumPWpYuCVPozA18yIhC9tNn |
|  |  | ALHndz0tDseIdy9vC71jQWy9iwri3ueN0DekMMF8JGzI1Z6BAFzgyAx3DkHtwHg7 |
|  |  | B7qD0jPG5hJ5+yt323fYgJsuEAYoZ8/jzZ01pkX8bt+UsVN0DGnSGsI2ktnIIk3J |
|  |  | l+8krjmUy6EaW79nITwoOqaeHOIp8m3UkjEcoKOYrzHRKqRy+A09rY+m/cAQaafW |
|  |  | 4xp0Zv7qZPLwnu0jsqB4jD8Ll9yPB02ndsoV6U5PeHzTkVhPml19jKUAwFfs7TJg |
|  |  | kXy+/xFhYVUCAwEAATANBgkqhkiG9w0BAQsFAAOCBAIAAQnZY77pMNeypfpba2WK |
|  |  | aDasT7dk2JqP0eukJCVPTN24Zca+xJNPdzuBATm/8SdZK9lddIbjSnWRsKvTnO2r |
|  |  | /rYdlPf3jM5uuJtb8+Uwwe1s+gszelGS9G/lzzq+ehWicRIq2PFcs8o3iQMfENiv |
|  |  | qILJ+xjcrvms5ZPDNahWkfRx3KCg8Q+/at2n5p7XYjMPYiLKHnDC+RE2b1qT20IZ |
|  |  | FhuK/fTWLmKbfYFNNga6GC4qcaZJ7x0pbm4SDTYp0tkhzcHzwKhidfNB5J2vNz6l |
|  |  | Ur6wiYwamFTLqcOwWo7rdvI+sSn05WQBv0QZlzFX+OAu0l7WQ7yU+noOxBhjvHds |
|  |  | 14+r9qcQZg2q9kG+evopYZqYXRUNNlZKo9MRBXhfrISulFAc5lRFQIXMXnglvAu+ |
|  |  | Ipz2gomEAOcOPNNVldhKAU94GAMJd/KfN0ZP7gX3YvPzuYU6XDhag5RTohXLm18w |
|  |  | 5AF+ES3DOQ6ixu3DTf0D+6qrDuK+prdX8ivcdTQVNOQ+MIZeGSc6NWWOTaMGJ3lg |
|  |  | aZIxJUGdo6E7GBGiC1YTjgFKFbHzek1LRTh/LX3vbSudxwaG0HQxwsU9T4DWiMqa |
|  |  | Fkf2KteLEUA6HrR+0XlAZrhwoqAmrJ+8lCFX3V0gE9lpENfVHlFXDGyx10DpTB28 |
|  |  | DdjnY3F7EPWNzwf9P3oNT69CKW3Bk6VVr3ROOJtDxVu1ioWo3TaXltQ0VOnap2Pu |
|  |  | sa5wfrpfwBDuAS9JCDg4ttNp2nW3F7tgXC6xPqw5pvGwUppEw9XNrqV8TZrxduuv |
|  |  | rQ3NyZ7KSzIpmFlD3UwV/fGfz3UQmHS6Ng1evrUID9DjfYNfRqSGIGjDfxGtYD+j |
|  |  | Z1gLJZuhjJpNtwBkKRtlNtrCWCJK2hidK/foxwD7kwAPo2I9FjpltxCRywZUs07X |
|  |  | KwXTfBR9v6ij1LV6K58hFS+8ezZyZ05CeVBFkMQdclTOSfuPxlMkQOtjp8QWDj+F |
|  |  | j/MYziT5KBkHvcbrjdRtUJIAi4N7zCsPZtjik918AK1WBNRVqPbrgq/XSEXMfuvs |
|  |  | 6JbfK0B76vdBDRtJFC1JsvnIrGbUztxXzyQwFLaR/AjVJqpVlysLWzPKWVX6/+SJ |
|  |  | u1NQOl2E8P6ycyBsuGnO89p0S4F8cMRcI2X1XQsZ7/q0NBrOMaEp5T3SrWo9GiQ3 |
|  |  | o2SBdbs3Y6MBPBtTu977Z/0RO63J3M5i2tjUiDfrFy7+VRLKr7qQ7JibohyB8QaR |
|  |  | 9tedgjn2f+of7PnP/PEl1cCphUZeHM7QKUMPT8dbqwmKtlYY43EHXcvNOT5IBk3X |
|  |  | 9lwJoZk/B2i+ZMRNSP34ztAwtxmasPt6RAWGQpWCn9qmttAHAnMfDqe7F7jVR6rS |
|  |  | u58= |
|  |  | -----END CERTIFICATE-----` |
|  |  |  |
|  |  | func TestHandshakeRSATooBig(t \*testing.T) { |
|  |  | testCert, \_ := pem.Decode([]byte(largeRSAKeyCertPEM)) |
|  |  |  |
|  |  | c := &Conn{conn: &discardConn{}, config: testConfig.Clone()} |
|  |  |  |
|  |  | expectedErr := "tls: server sent certificate containing RSA key larger than 8192 bits" |
|  |  | err := c.verifyServerCertificate([][]byte{testCert.Bytes}) |
|  |  | if err == nil || err.Error() != expectedErr { |
|  |  | t.Errorf("Conn.verifyServerCertificate unexpected error: want %q, got %q", expectedErr, err) |
|  |  | } |
|  |  |  |
|  |  | expectedErr = "tls: client sent certificate containing RSA key larger than 8192 bits" |
|  |  | err = c.processCertsFromClient(Certificate{Certificate: [][]byte{testCert.Bytes}}) |
|  |  | if err == nil || err.Error() != expectedErr { |
|  |  | t.Errorf("Conn.processCertsFromClient unexpected error: want %q, got %q", expectedErr, err) |
|  |  | } |
|  |  | } |

4 changes: 4 additions & 0 deletions

4
[src/crypto/tls/handshake\_server.go](#diff-b99af81cc87357c6e332ac9056da4fd30f36d6875758b4a27b86532bf82a066f "src/crypto/tls/handshake_server.go")

Show comments

[View file](/golang/go/blob/2350afd2e8ab054390e284c95d5b089c142db017/src/crypto/tls/handshake_server.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -864,6 +864,10 @@ func (c \*Conn) processCertsFromClient(certificate Certificate) error { |
|  |  | c.sendAlert(alertBadCertificate) |
|  |  | return errors.New("tls: failed to parse client certificate: " + err.Error()) |
|  |  | } |
|  |  | if certs[i].PublicKeyAlgorithm == x509.RSA && certs[i].PublicKey.(\*rsa.PublicKey).N.BitLen() > maxRSAKeySize { |
|  |  | c.sendAlert(alertBadCertificate) |
|  |  | return fmt.Errorf("tls: client sent certificate containing RSA key larger than %d bits", maxRSAKeySize) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if len(certs) == 0 && requiresClientCert(c.config.ClientAuth) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2350afd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fcommit%2F2350afd2e8ab054390e284c95d5b089c142db017) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f84ddb6f_20250111_051312.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2F445be526aea4ee0b1fa5388aa65d32b2816d3a00)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2F445be526aea4ee0b1fa5388aa65d32b2816d3a00)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=libp2p%2Fgo-libp2p)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libp2p](/libp2p)
/
**[go-libp2p](/libp2p/go-libp2p)**
Public

* [Notifications](/login?return_to=%2Flibp2p%2Fgo-libp2p) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Flibp2p%2Fgo-libp2p)
* [Star
   6.2k](/login?return_to=%2Flibp2p%2Fgo-libp2p)

* [Code](/libp2p/go-libp2p)
* [Issues
  234](/libp2p/go-libp2p/issues)
* [Pull requests
  31](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects
  0](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

Additional navigation options

* [Code](/libp2p/go-libp2p)
* [Issues](/libp2p/go-libp2p/issues)
* [Pull requests](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

## Commit

[Permalink](/libp2p/go-libp2p/commit/445be526aea4ee0b1fa5388aa65d32b2816d3a00)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

core/crypto: restrict RSA keys to <= 8192 bits ([#2454](https://github.com/libp2p/go-libp2p/pull/2454))

[Browse files](/libp2p/go-libp2p/tree/445be526aea4ee0b1fa5388aa65d32b2816d3a00)
Browse the repository at this point in the history

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

* Loading branch information

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&v=4)](/marten-seemann)

[MarcoPolo](/libp2p/go-libp2p/commits?author=MarcoPolo "View all commits by MarcoPolo")
and
[marten-seemann](/libp2p/go-libp2p/commits?author=marten-seemann "View all commits by marten-seemann")
committed
Aug 3, 2023

1 parent
[c358b81](/libp2p/go-libp2p/commit/c358b81919f6b58081162d46c65970a0917f377d)

commit 445be52

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**50 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core/crypto

  + core/crypto/rsa\_common.go
    [rsa\_common.go](#diff-9093cb6aa21268076b0f42d7849ab7542c410512983a54beb6c5d4d3ef9f913a)
  + core/crypto/rsa\_go.go
    [rsa\_go.go](#diff-0fd3dcf0023458711422a1cee41fd29005de6d8b196a41ceaebeca293a5213f8)
  + core/crypto/rsa\_test.go
    [rsa\_test.go](#diff-ef23c5ce318037e38cd3dd13152682ab5e3fec354a18441e4738a386833433c3)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[core/crypto/rsa\_common.go](#diff-9093cb6aa21268076b0f42d7849ab7542c410512983a54beb6c5d4d3ef9f913a "core/crypto/rsa_common.go")

Show comments

[View file](/libp2p/go-libp2p/blob/445be526aea4ee0b1fa5388aa65d32b2816d3a00/core/crypto/rsa_common.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,9 +12,12 @@ const WeakRsaKeyEnv = "LIBP2P\_ALLOW\_WEAK\_RSA\_KEYS" |
|  |  |  |
|  |  | var MinRsaKeyBits = 2048 |
|  |  |  |
|  |  | var maxRsaKeyBits = 8192 |
|  |  |  |
|  |  | // ErrRsaKeyTooSmall is returned when trying to generate or parse an RSA key |
|  |  | // that's smaller than MinRsaKeyBits bits. In test |
|  |  | var ErrRsaKeyTooSmall error |
|  |  | var ErrRsaKeyTooBig error = fmt.Errorf("rsa keys must be <= %d bits", maxRsaKeyBits) |
|  |  |  |
|  |  | func init() { |
|  |  | if \_, ok := os.LookupEnv(WeakRsaKeyEnv); ok { |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[core/crypto/rsa\_go.go](#diff-0fd3dcf0023458711422a1cee41fd29005de6d8b196a41ceaebeca293a5213f8 "core/crypto/rsa_go.go")

Show comments

[View file](/libp2p/go-libp2p/blob/445be526aea4ee0b1fa5388aa65d32b2816d3a00/core/crypto/rsa_go.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,6 +31,9 @@ func GenerateRSAKeyPair(bits int, src io.Reader) (PrivKey, PubKey, error) { |
|  |  | if bits < MinRsaKeyBits { |
|  |  | return nil, nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if bits > maxRsaKeyBits { |
|  |  | return nil, nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  | priv, err := rsa.GenerateKey(src, bits) |
|  |  | if err != nil { |
|  |  | return nil, nil, err |
| Expand Down  Expand Up | | @@ -124,6 +127,9 @@ func UnmarshalRsaPrivateKey(b []byte) (key PrivKey, err error) { |
|  |  | if sk.N.BitLen() < MinRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if sk.N.BitLen() > maxRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  | return &RsaPrivateKey{sk: \*sk}, nil |
|  |  | } |
|  |  |  |
| Expand All | | @@ -141,6 +147,9 @@ func UnmarshalRsaPublicKey(b []byte) (key PubKey, err error) { |
|  |  | if pk.N.BitLen() < MinRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if pk.N.BitLen() > maxRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  |  |
|  |  | return &RsaPublicKey{k: \*pk}, nil |
|  |  | } |

38 changes: 38 additions & 0 deletions

38
[core/crypto/rsa\_test.go](#diff-ef23c5ce318037e38cd3dd13152682ab5e3fec354a18441e4738a386833433c3 "core/crypto/rsa_test.go")

Show comments

[View file](/libp2p/go-libp2p/blob/445be526aea4ee0b1fa5388aa65d32b2816d3a00/core/crypto/rsa_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -68,6 +68,44 @@ func TestRSASmallKey(t \*testing.T) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSABigKeyFailsToGenerate(t \*testing.T) { |
|  |  | \_, \_, err := GenerateRSAKeyPair(maxRsaKeyBits\*2, rand.Reader) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to create too big RSA key") |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSABigKey(t \*testing.T) { |
|  |  | // Make the global limit smaller for this test to run faster. |
|  |  | // Note we also change the limit below, but this is different |
|  |  | origSize := maxRsaKeyBits |
|  |  | maxRsaKeyBits = 2048 |
|  |  | defer func() { maxRsaKeyBits = origSize }() // |
|  |  |  |
|  |  | maxRsaKeyBits \*= 2 |
|  |  | badPriv, badPub, err := GenerateRSAKeyPair(maxRsaKeyBits, rand.Reader) |
|  |  | if err != nil { |
|  |  | t.Fatalf("should have succeeded, got: %s", err) |
|  |  | } |
|  |  | pubBytes, err := MarshalPublicKey(badPub) |
|  |  | if err != nil { |
|  |  | t.Fatal(err) |
|  |  | } |
|  |  | privBytes, err := MarshalPrivateKey(badPriv) |
|  |  | if err != nil { |
|  |  | t.Fatal(err) |
|  |  | } |
|  |  | maxRsaKeyBits /= 2 |
|  |  | \_, err = UnmarshalPublicKey(pubBytes) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to unmarshal a too big key") |
|  |  | } |
|  |  | \_, err = UnmarshalPrivateKey(privBytes) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to unmarshal a too big key") |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSASignZero(t \*testing.T) { |
|  |  | priv, pub, err := GenerateRSAKeyPair(2048, rand.Reader) |
|  |  | if err != nil { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `445be52`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2F445be526aea4ee0b1fa5388aa65d32b2816d3a00) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_933b20f7_20250111_051313.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2Fe30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2Fe30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=libp2p%2Fgo-libp2p)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libp2p](/libp2p)
/
**[go-libp2p](/libp2p/go-libp2p)**
Public

* [Notifications](/login?return_to=%2Flibp2p%2Fgo-libp2p) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Flibp2p%2Fgo-libp2p)
* [Star
   6.2k](/login?return_to=%2Flibp2p%2Fgo-libp2p)

* [Code](/libp2p/go-libp2p)
* [Issues
  234](/libp2p/go-libp2p/issues)
* [Pull requests
  31](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects
  0](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

Additional navigation options

* [Code](/libp2p/go-libp2p)
* [Issues](/libp2p/go-libp2p/issues)
* [Pull requests](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

## Commit

[Permalink](/libp2p/go-libp2p/commit/e30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

core/crypto: restrict RSA keys to <= 8192 bits ([#2454](https://github.com/libp2p/go-libp2p/pull/2454))

[Browse files](/libp2p/go-libp2p/tree/e30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d)
Browse the repository at this point in the history

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

* Loading branch information

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&v=4)](/marten-seemann)

[MarcoPolo](/libp2p/go-libp2p/commits?author=MarcoPolo "View all commits by MarcoPolo")
and
[marten-seemann](/libp2p/go-libp2p/commits?author=marten-seemann "View all commits by marten-seemann")
committed
Aug 3, 2023

1 parent
[636a096](/libp2p/go-libp2p/commit/636a0966a69a90d54128288465fb48c148741399)

commit e30fcf7

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**50 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core/crypto

  + core/crypto/rsa\_common.go
    [rsa\_common.go](#diff-9093cb6aa21268076b0f42d7849ab7542c410512983a54beb6c5d4d3ef9f913a)
  + core/crypto/rsa\_go.go
    [rsa\_go.go](#diff-0fd3dcf0023458711422a1cee41fd29005de6d8b196a41ceaebeca293a5213f8)
  + core/crypto/rsa\_test.go
    [rsa\_test.go](#diff-ef23c5ce318037e38cd3dd13152682ab5e3fec354a18441e4738a386833433c3)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[core/crypto/rsa\_common.go](#diff-9093cb6aa21268076b0f42d7849ab7542c410512983a54beb6c5d4d3ef9f913a "core/crypto/rsa_common.go")

Show comments

[View file](/libp2p/go-libp2p/blob/e30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d/core/crypto/rsa_common.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,9 +12,12 @@ const WeakRsaKeyEnv = "LIBP2P\_ALLOW\_WEAK\_RSA\_KEYS" |
|  |  |  |
|  |  | var MinRsaKeyBits = 2048 |
|  |  |  |
|  |  | var maxRsaKeyBits = 8192 |
|  |  |  |
|  |  | // ErrRsaKeyTooSmall is returned when trying to generate or parse an RSA key |
|  |  | // that's smaller than MinRsaKeyBits bits. In test |
|  |  | var ErrRsaKeyTooSmall error |
|  |  | var ErrRsaKeyTooBig error = fmt.Errorf("rsa keys must be <= %d bits", maxRsaKeyBits) |
|  |  |  |
|  |  | func init() { |
|  |  | if \_, ok := os.LookupEnv(WeakRsaKeyEnv); ok { |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[core/crypto/rsa\_go.go](#diff-0fd3dcf0023458711422a1cee41fd29005de6d8b196a41ceaebeca293a5213f8 "core/crypto/rsa_go.go")

Show comments

[View file](/libp2p/go-libp2p/blob/e30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d/core/crypto/rsa_go.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,6 +31,9 @@ func GenerateRSAKeyPair(bits int, src io.Reader) (PrivKey, PubKey, error) { |
|  |  | if bits < MinRsaKeyBits { |
|  |  | return nil, nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if bits > maxRsaKeyBits { |
|  |  | return nil, nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  | priv, err := rsa.GenerateKey(src, bits) |
|  |  | if err != nil { |
|  |  | return nil, nil, err |
| Expand Down  Expand Up | | @@ -124,6 +127,9 @@ func UnmarshalRsaPrivateKey(b []byte) (key PrivKey, err error) { |
|  |  | if sk.N.BitLen() < MinRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if sk.N.BitLen() > maxRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  | return &RsaPrivateKey{sk: \*sk}, nil |
|  |  | } |
|  |  |  |
| Expand All | | @@ -141,6 +147,9 @@ func UnmarshalRsaPublicKey(b []byte) (key PubKey, err error) { |
|  |  | if pk.N.BitLen() < MinRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if pk.N.BitLen() > maxRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  |  |
|  |  | return &RsaPublicKey{k: \*pk}, nil |
|  |  | } |

38 changes: 38 additions & 0 deletions

38
[core/crypto/rsa\_test.go](#diff-ef23c5ce318037e38cd3dd13152682ab5e3fec354a18441e4738a386833433c3 "core/crypto/rsa_test.go")

Show comments

[View file](/libp2p/go-libp2p/blob/e30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d/core/crypto/rsa_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -68,6 +68,44 @@ func TestRSASmallKey(t \*testing.T) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSABigKeyFailsToGenerate(t \*testing.T) { |
|  |  | \_, \_, err := GenerateRSAKeyPair(maxRsaKeyBits\*2, rand.Reader) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to create too big RSA key") |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSABigKey(t \*testing.T) { |
|  |  | // Make the global limit smaller for this test to run faster. |
|  |  | // Note we also change the limit below, but this is different |
|  |  | origSize := maxRsaKeyBits |
|  |  | maxRsaKeyBits = 2048 |
|  |  | defer func() { maxRsaKeyBits = origSize }() // |
|  |  |  |
|  |  | maxRsaKeyBits \*= 2 |
|  |  | badPriv, badPub, err := GenerateRSAKeyPair(maxRsaKeyBits, rand.Reader) |
|  |  | if err != nil { |
|  |  | t.Fatalf("should have succeeded, got: %s", err) |
|  |  | } |
|  |  | pubBytes, err := MarshalPublicKey(badPub) |
|  |  | if err != nil { |
|  |  | t.Fatal(err) |
|  |  | } |
|  |  | privBytes, err := MarshalPrivateKey(badPriv) |
|  |  | if err != nil { |
|  |  | t.Fatal(err) |
|  |  | } |
|  |  | maxRsaKeyBits /= 2 |
|  |  | \_, err = UnmarshalPublicKey(pubBytes) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to unmarshal a too big key") |
|  |  | } |
|  |  | \_, err = UnmarshalPrivateKey(privBytes) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to unmarshal a too big key") |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSASignZero(t \*testing.T) { |
|  |  | priv, pub, err := GenerateRSAKeyPair(2048, rand.Reader) |
|  |  | if err != nil { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e30fcf7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2Fe30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_29e20f14_20250111_051315.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fsecurity%2Fadvisories%2FGHSA-876p-8259-xjgg)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fsecurity%2Fadvisories%2FGHSA-876p-8259-xjgg)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=libp2p%2Fgo-libp2p)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libp2p](/libp2p)
/
**[go-libp2p](/libp2p/go-libp2p)**
Public

* [Notifications](/login?return_to=%2Flibp2p%2Fgo-libp2p) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Flibp2p%2Fgo-libp2p)
* [Star
   6.2k](/login?return_to=%2Flibp2p%2Fgo-libp2p)

* [Code](/libp2p/go-libp2p)
* [Issues
  234](/libp2p/go-libp2p/issues)
* [Pull requests
  31](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects
  0](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

Additional navigation options

* [Code](/libp2p/go-libp2p)
* [Issues](/libp2p/go-libp2p/issues)
* [Pull requests](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

# libp2p nodes vulnerable to attack using large RSA keys

Moderate

[p-shahi](/p-shahi)
published
GHSA-876p-8259-xjgg
Aug 8, 2023

## Package

gomod

go-libp2p
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 0.27.8, < 0.28.2, and < 0.29.1

## Patched versions

>=v0.27.8, >=v0.28.2, and >=v0.29.1

## Description

### Impact

A malicious peer can use large RSA keys to run a resource exhaustion attack & force a node to spend time doing signature verification of the large key. This vulnerability is present in the core/crypto module of go-libp2p and can occur during the Noise handshake and the libp2p x509 extension verification step.

To prevent this attack, go-libp2p now restricts RSA keys to <= 8192 bits.

### Patches

Users should upgrade their go-libp2p versions to >=v0.27.8, >= v0.28.2, or >=v0.29.1

To protect your application, it's necessary to update to these patch releases **AND** to use the updated Go compiler (1.20.7 or 1.19.12, respectively)

### Workarounds

There are no known workarounds

### References

The Golang crypto/tls package also had this vulnerability ("verifying certificate chains containing large RSA keys is slow” [golang/go#61460](https://github.com/golang/go/issues/61460))

Fix in golang/go crypto/tls: [golang/go@2350afd](https://github.com/golang/go/commit/2350afd2e8ab054390e284c95d5b089c142db017)

Fix in quic-go [quic-go/quic-go#4012](https://github.com/quic-go/quic-go/pull/4012)

### Severity

Moderate

### CVE ID

CVE-2023-39533

### Weaknesses

No CWEs

### Credits

* [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&v=4)](/marten-seemann)
  [marten-seemann](/marten-seemann)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2c632d11_20250111_051316.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquic-go%2Fquic-go%2Fpull%2F4012)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquic-go%2Fquic-go%2Fpull%2F4012)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=quic-go%2Fquic-go)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[quic-go](/quic-go)
/
**[quic-go](/quic-go/quic-go)**
Public

* [Notifications](/login?return_to=%2Fquic-go%2Fquic-go) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fquic-go%2Fquic-go)
* [Star
   10.3k](/login?return_to=%2Fquic-go%2Fquic-go)

* [Code](/quic-go/quic-go)
* [Issues
  162](/quic-go/quic-go/issues)
* [Pull requests
  37](/quic-go/quic-go/pulls)
* [Actions](/quic-go/quic-go/actions)
* [Wiki](/quic-go/quic-go/wiki)
* [Security](/quic-go/quic-go/security)
* [Insights](/quic-go/quic-go/pulse)

Additional navigation options

* [Code](/quic-go/quic-go)
* [Issues](/quic-go/quic-go/issues)
* [Pull requests](/quic-go/quic-go/pulls)
* [Actions](/quic-go/quic-go/actions)
* [Wiki](/quic-go/quic-go/wiki)
* [Security](/quic-go/quic-go/security)
* [Insights](/quic-go/quic-go/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fquic-go%2Fquic-go%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fquic-go%2Fquic-go%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# update qtls to restrict RSA keys in certificates to <= 8192 bits #4012

 Merged

[marten-seemann](/marten-seemann)
merged 1 commit into
[master](/quic-go/quic-go/tree/master "quic-go/quic-go:master")
from
[restrict-rsa-key-sizes](/quic-go/quic-go/tree/restrict-rsa-key-sizes "quic-go/quic-go:restrict-rsa-key-sizes")

Aug 3, 2023

 Merged

# [update qtls to restrict RSA keys in certificates to <= 8192 bits](#top) #4012

[marten-seemann](/marten-seemann)
merged 1 commit into
[master](/quic-go/quic-go/tree/master "quic-go/quic-go:master")
from
[restrict-rsa-key-sizes](/quic-go/quic-go/tree/restrict-rsa-key-sizes "quic-go/quic-go:restrict-rsa-key-sizes")

Aug 3, 2023

[Conversation
2](/quic-go/quic-go/pull/4012)
[Commits
1](/quic-go/quic-go/pull/4012/commits)
[Checks
0](/quic-go/quic-go/pull/4012/checks)
[Files changed](/quic-go/quic-go/pull/4012/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=60&v=4)](/marten-seemann)

Copy link

Member

### @marten-seemann **[marten-seemann](/marten-seemann)** commented [Aug 2, 2023](#issue-1834027618)

This is a backport of the Go standard library fix that triggered the Go 1.20.7 release. It's only needed for the quic-go version built with Go 1.20, as Go 1.21 uses the standard library crypto/tls.

[@mholt](https://github.com/mholt) Just a heads-up, there will be a v0.37.2 patch release very soon.

Sorry, something went wrong.

 👍
1
 mholt reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&v=4)](/marten-seemann)

`[update qtls to restrict RSA keys in certificates to <= 8192 bits](/quic-go/quic-go/pull/4012/commits/61b7ad750614a919283f7b6052b0f1138c5f21e2 "update qtls to restrict RSA keys in certificates to <= 8192 bits")`

`[61b7ad7](/quic-go/quic-go/pull/4012/commits/61b7ad750614a919283f7b6052b0f1138c5f21e2)`

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Aug 2, 2023](#issuecomment-1663103066) • edited Loading

| [Codecov](https://app.codecov.io/gh/quic-go/quic-go/pull/4012?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) Report Merging [#4012](https://app.codecov.io/gh/quic-go/quic-go/pull/4012?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) ([61b7ad7](https://github.com/quic-go/quic-go/commit/61b7ad750614a919283f7b6052b0f1138c5f21e2)) into [master](https://app.codecov.io/gh/quic-go/quic-go/commit/1c47ebefc0660eb82bada449a5365e2aedd1e686?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) ([1c47ebe](https://github.com/quic-go/quic-go/commit/1c47ebefc0660eb82bada449a5365e2aedd1e686)) will **increase** coverage by `0.02%`. The diff coverage is `n/a`.  ``` @@            Coverage Diff             @@ ##           master    #4012      +/-   ## ========================================== + Coverage   82.80%   82.82%   +0.02%      ==========================================   Files         147      147                 Lines       14758    14758               ========================================== + Hits        12220    12223       +3      + Misses       2036     2033       -3        Partials      502      502               ```  [see 1 file with indirect coverage changes](https://app.codecov.io/gh/quic-go/quic-go/pull/4012/indirect-changes?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=None) |
| --- |

All reactions

Sorry, something went wrong.

[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)
[marten-seemann](/marten-seemann)
mentioned this pull request
[Aug 3, 2023](#ref-issue-1833936265)

[Infinite loop on goroutine with http.ResponseController changes
caddyserver/caddy#5671](/caddyserver/caddy/issues/5671)

Closed

[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)
[marten-seemann](/marten-seemann)
merged commit [`f9f6b9d`](/quic-go/quic-go/commit/f9f6b9df6ec6769ec6bb7d4fd0b29177cbc2bf55)
into
master

[Aug 3, 2023](https://github.com/quic-go/quic-go/pull/4012#event-10000353044)

[marten-seemann](/marten-seemann)
added a commit
that referenced
this pull request
[Aug 3, 2023](#ref-commit-b8aa6a8)
[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)

`[update qtls to restrict RSA keys in certificates to <= 8192 bits (](/quic-go/quic-go/commit/b8aa6a8286c5d4d881745134550e2dbe2a2ec91d "update qtls to restrict RSA keys in certificates to <= 8192 bits (#4012)")[#4012](https://github.com/quic-go/quic-go/pull/4012)[)](/quic-go/quic-go/commit/b8aa6a8286c5d4d881745134550e2dbe2a2ec91d "update qtls to restrict RSA keys in certificates to <= 8192 bits (#4012)")`

`[b8aa6a8](/quic-go/quic-go/commit/b8aa6a8286c5d4d881745134550e2dbe2a2ec91d)`

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

Contributor

### **[mholt](/mholt)** commented [Aug 3, 2023](#issuecomment-1664279401)

| Thanks Marten. I really had to cut a Caddy release yesterday but we will likely cut another one soon-ish, so I'll be sure to include this then. |
| --- |

All reactions

Sorry, something went wrong.

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Aug 8, 2023](#ref-issue-1842002008)

[x/vulndb: potential Go vuln in github.com/libp2p/go-libp2p: CVE-2023-39533
golang/vulndb#2000](/golang/vulndb/issues/2000)

Closed

 [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)
[marten-seemann](/marten-seemann)
deleted the
restrict-rsa-key-sizes

branch
[September 1, 2023 10:07](#event-10255580321)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fquic-go%2Fquic-go%2Fpull%2F4012)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=52&v=4)](/marten-seemann) [![@mholt](https://avatars.githubusercontent.com/u/1128849?s=52&v=4)](/mholt)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ce0b6deb_20250111_051312.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2F0cce607219f3710addc7e18672cffd1f1d912fbb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2F0cce607219f3710addc7e18672cffd1f1d912fbb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=libp2p%2Fgo-libp2p)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libp2p](/libp2p)
/
**[go-libp2p](/libp2p/go-libp2p)**
Public

* [Notifications](/login?return_to=%2Flibp2p%2Fgo-libp2p) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Flibp2p%2Fgo-libp2p)
* [Star
   6.2k](/login?return_to=%2Flibp2p%2Fgo-libp2p)

* [Code](/libp2p/go-libp2p)
* [Issues
  234](/libp2p/go-libp2p/issues)
* [Pull requests
  31](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects
  0](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

Additional navigation options

* [Code](/libp2p/go-libp2p)
* [Issues](/libp2p/go-libp2p/issues)
* [Pull requests](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

## Commit

[Permalink](/libp2p/go-libp2p/commit/0cce607219f3710addc7e18672cffd1f1d912fbb)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

core/crypto: restrict RSA keys to <= 8192 bits ([#2454](https://github.com/libp2p/go-libp2p/pull/2454))

[Browse files](/libp2p/go-libp2p/tree/0cce607219f3710addc7e18672cffd1f1d912fbb)
Browse the repository at this point in the history

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

* Loading branch information

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&v=4)](/marten-seemann)

[MarcoPolo](/libp2p/go-libp2p/commits?author=MarcoPolo "View all commits by MarcoPolo")
and
[marten-seemann](/libp2p/go-libp2p/commits?author=marten-seemann "View all commits by marten-seemann")
committed
Aug 4, 2023

1 parent
[68ad5ea](/libp2p/go-libp2p/commit/68ad5ea717cc48f6d9732ba7fa4c0dff68854a5d)

commit 0cce607

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**50 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core/crypto

  + core/crypto/rsa\_common.go
    [rsa\_common.go](#diff-9093cb6aa21268076b0f42d7849ab7542c410512983a54beb6c5d4d3ef9f913a)
  + core/crypto/rsa\_go.go
    [rsa\_go.go](#diff-0fd3dcf0023458711422a1cee41fd29005de6d8b196a41ceaebeca293a5213f8)
  + core/crypto/rsa\_test.go
    [rsa\_test.go](#diff-ef23c5ce318037e38cd3dd13152682ab5e3fec354a18441e4738a386833433c3)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[core/crypto/rsa\_common.go](#diff-9093cb6aa21268076b0f42d7849ab7542c410512983a54beb6c5d4d3ef9f913a "core/crypto/rsa_common.go")

Show comments

[View file](/libp2p/go-libp2p/blob/0cce607219f3710addc7e18672cffd1f1d912fbb/core/crypto/rsa_common.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,9 +12,12 @@ const WeakRsaKeyEnv = "LIBP2P\_ALLOW\_WEAK\_RSA\_KEYS" |
|  |  |  |
|  |  | var MinRsaKeyBits = 2048 |
|  |  |  |
|  |  | var maxRsaKeyBits = 8192 |
|  |  |  |
|  |  | // ErrRsaKeyTooSmall is returned when trying to generate or parse an RSA key |
|  |  | // that's smaller than MinRsaKeyBits bits. In test |
|  |  | var ErrRsaKeyTooSmall error |
|  |  | var ErrRsaKeyTooBig error = fmt.Errorf("rsa keys must be <= %d bits", maxRsaKeyBits) |
|  |  |  |
|  |  | func init() { |
|  |  | if \_, ok := os.LookupEnv(WeakRsaKeyEnv); ok { |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[core/crypto/rsa\_go.go](#diff-0fd3dcf0023458711422a1cee41fd29005de6d8b196a41ceaebeca293a5213f8 "core/crypto/rsa_go.go")

Show comments

[View file](/libp2p/go-libp2p/blob/0cce607219f3710addc7e18672cffd1f1d912fbb/core/crypto/rsa_go.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,6 +31,9 @@ func GenerateRSAKeyPair(bits int, src io.Reader) (PrivKey, PubKey, error) { |
|  |  | if bits < MinRsaKeyBits { |
|  |  | return nil, nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if bits > maxRsaKeyBits { |
|  |  | return nil, nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  | priv, err := rsa.GenerateKey(src, bits) |
|  |  | if err != nil { |
|  |  | return nil, nil, err |
| Expand Down  Expand Up | | @@ -124,6 +127,9 @@ func UnmarshalRsaPrivateKey(b []byte) (key PrivKey, err error) { |
|  |  | if sk.N.BitLen() < MinRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if sk.N.BitLen() > maxRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  | return &RsaPrivateKey{sk: \*sk}, nil |
|  |  | } |
|  |  |  |
| Expand All | | @@ -141,6 +147,9 @@ func UnmarshalRsaPublicKey(b []byte) (key PubKey, err error) { |
|  |  | if pk.N.BitLen() < MinRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooSmall |
|  |  | } |
|  |  | if pk.N.BitLen() > maxRsaKeyBits { |
|  |  | return nil, ErrRsaKeyTooBig |
|  |  | } |
|  |  |  |
|  |  | return &RsaPublicKey{k: \*pk}, nil |
|  |  | } |

38 changes: 38 additions & 0 deletions

38
[core/crypto/rsa\_test.go](#diff-ef23c5ce318037e38cd3dd13152682ab5e3fec354a18441e4738a386833433c3 "core/crypto/rsa_test.go")

Show comments

[View file](/libp2p/go-libp2p/blob/0cce607219f3710addc7e18672cffd1f1d912fbb/core/crypto/rsa_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -68,6 +68,44 @@ func TestRSASmallKey(t \*testing.T) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSABigKeyFailsToGenerate(t \*testing.T) { |
|  |  | \_, \_, err := GenerateRSAKeyPair(maxRsaKeyBits\*2, rand.Reader) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to create too big RSA key") |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSABigKey(t \*testing.T) { |
|  |  | // Make the global limit smaller for this test to run faster. |
|  |  | // Note we also change the limit below, but this is different |
|  |  | origSize := maxRsaKeyBits |
|  |  | maxRsaKeyBits = 2048 |
|  |  | defer func() { maxRsaKeyBits = origSize }() // |
|  |  |  |
|  |  | maxRsaKeyBits \*= 2 |
|  |  | badPriv, badPub, err := GenerateRSAKeyPair(maxRsaKeyBits, rand.Reader) |
|  |  | if err != nil { |
|  |  | t.Fatalf("should have succeeded, got: %s", err) |
|  |  | } |
|  |  | pubBytes, err := MarshalPublicKey(badPub) |
|  |  | if err != nil { |
|  |  | t.Fatal(err) |
|  |  | } |
|  |  | privBytes, err := MarshalPrivateKey(badPriv) |
|  |  | if err != nil { |
|  |  | t.Fatal(err) |
|  |  | } |
|  |  | maxRsaKeyBits /= 2 |
|  |  | \_, err = UnmarshalPublicKey(pubBytes) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to unmarshal a too big key") |
|  |  | } |
|  |  | \_, err = UnmarshalPrivateKey(privBytes) |
|  |  | if err != ErrRsaKeyTooBig { |
|  |  | t.Fatal("should have refused to unmarshal a too big key") |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestRSASignZero(t \*testing.T) { |
|  |  | priv, pub, err := GenerateRSAKeyPair(2048, rand.Reader) |
|  |  | if err != nil { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0cce607`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fcommit%2F0cce607219f3710addc7e18672cffd1f1d912fbb) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0f8a7e65_20250111_051314.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fpull%2F2454)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fpull%2F2454)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=libp2p%2Fgo-libp2p)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[libp2p](/libp2p)
/
**[go-libp2p](/libp2p/go-libp2p)**
Public

* [Notifications](/login?return_to=%2Flibp2p%2Fgo-libp2p) You must be signed in to change notification settings
* [Fork
  1.1k](/login?return_to=%2Flibp2p%2Fgo-libp2p)
* [Star
   6.2k](/login?return_to=%2Flibp2p%2Fgo-libp2p)

* [Code](/libp2p/go-libp2p)
* [Issues
  234](/libp2p/go-libp2p/issues)
* [Pull requests
  31](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects
  0](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

Additional navigation options

* [Code](/libp2p/go-libp2p)
* [Issues](/libp2p/go-libp2p/issues)
* [Pull requests](/libp2p/go-libp2p/pulls)
* [Discussions](/libp2p/go-libp2p/discussions)
* [Actions](/libp2p/go-libp2p/actions)
* [Projects](/libp2p/go-libp2p/projects)
* [Security](/libp2p/go-libp2p/security)
* [Insights](/libp2p/go-libp2p/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flibp2p%2Fgo-libp2p%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flibp2p%2Fgo-libp2p%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# core/crypto: restrict RSA keys to <= 8192 bits #2454

 Merged

[marten-seemann](/marten-seemann)
merged 5 commits into
[master](/libp2p/go-libp2p/tree/master "libp2p/go-libp2p:master")
from
[marco/limit-rsa-key-size](/libp2p/go-libp2p/tree/marco/limit-rsa-key-size "libp2p/go-libp2p:marco/limit-rsa-key-size")

Aug 3, 2023

 Merged

# [core/crypto: restrict RSA keys to <= 8192 bits](#top) #2454

[marten-seemann](/marten-seemann)
merged 5 commits into
[master](/libp2p/go-libp2p/tree/master "libp2p/go-libp2p:master")
from
[marco/limit-rsa-key-size](/libp2p/go-libp2p/tree/marco/limit-rsa-key-size "libp2p/go-libp2p:marco/limit-rsa-key-size")

Aug 3, 2023

[Conversation
4](/libp2p/go-libp2p/pull/2454)
[Commits
5](/libp2p/go-libp2p/pull/2454/commits)
[Checks
0](/libp2p/go-libp2p/pull/2454/checks)
[Files changed](/libp2p/go-libp2p/pull/2454/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=60&v=4)](/MarcoPolo)

Copy link

Collaborator

### @MarcoPolo **[MarcoPolo](/MarcoPolo)** commented [Aug 2, 2023](#issue-1834025102)

At a certain point these become too much effort to compute. This limits the max size.

Sorry, something went wrong.

All reactions

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&v=4)](/MarcoPolo)

`[Error if RSA key is too big](/libp2p/go-libp2p/pull/2454/commits/3d4ca78f5b0674b9e94f126606cea91f4c9dd15a "Error if RSA key is too big")`

`[3d4ca78](/libp2p/go-libp2p/pull/2454/commits/3d4ca78f5b0674b9e94f126606cea91f4c9dd15a)`

 [![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo)
[MarcoPolo](/MarcoPolo)
requested a review
from [marten-seemann](/marten-seemann)
[August 2, 2023 23:34](#event-9993147234)

[![marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=60&v=4)](/marten-seemann)

**[marten-seemann](/marten-seemann)**
reviewed
[Aug 2, 2023](#pullrequestreview-1559975907)

 [View reviewed changes](/libp2p/go-libp2p/pull/2454/files/3d4ca78f5b0674b9e94f126606cea91f4c9dd15a)

Copy link

Contributor

### @marten-seemann **[marten-seemann](/marten-seemann)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Could it be that you missed a few cases? I'm less worried about the code path where you generate the RSA key yourself (although we should prevent that footgun as well), but more about those where the peer sends us its pubkey. What could path would be taken during the TLS / Noise handshake when we receive the peer's key?

[![image](https://private-user-images.githubusercontent.com/1478487/257965122-a529db2d-4ca4-477b-b2df-560be65f63eb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzI2OTQsIm5iZiI6MTczNjU3MjM5NCwicGF0aCI6Ii8xNDc4NDg3LzI1Nzk2NTEyMi1hNTI5ZGIyZC00Y2E0LTQ3N2ItYjJkZi01NjBiZTY1ZjYzZWIucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDUxMzE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZWNkNjA5M2ViNjkzNTdjNWRjZTY5MjQ0ODU1OWM4NGRmYTYzNmIyYzg1NDU3YmNkMGUwYzkxNmJkY2Y0ZmJiYyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.MDfCbzv8SQrKN_Dxu6vqjsMu5Mhlfg7zL1j69UWeCRg)](https://private-user-images.githubusercontent.com/1478487/257965122-a529db2d-4ca4-477b-b2df-560be65f63eb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzI2OTQsIm5iZiI6MTczNjU3MjM5NCwicGF0aCI6Ii8xNDc4NDg3LzI1Nzk2NTEyMi1hNTI5ZGIyZC00Y2E0LTQ3N2ItYjJkZi01NjBiZTY1ZjYzZWIucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMSUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTFUMDUxMzE0WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZWNkNjA5M2ViNjkzNTdjNWRjZTY5MjQ0ODU1OWM4NGRmYTYzNmIyYzg1NDU3YmNkMGUwYzkxNmJkY2Y0ZmJiYyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.MDfCbzv8SQrKN_Dxu6vqjsMu5Mhlfg7zL1j69UWeCRg)

Sorry, something went wrong.

All reactions

[core/crypto/rsa\_common.go](/libp2p/go-libp2p/pull/2454/files/3d4ca78f5b0674b9e94f126606cea91f4c9dd15a#diff-9093cb6aa21268076b0f42d7849ab7542c410512983a54beb6c5d4d3ef9f913a)
Outdated

Show resolved

Hide resolved

[core/crypto/rsa\_common.go](/libp2p/go-libp2p/pull/2454/files/3d4ca78f5b0674b9e94f126606cea91f4c9dd15a#diff-9093cb6aa21268076b0f42d7849ab7542c410512983a54beb6c5d4d3ef9f913a)
Outdated

Show resolved

Hide resolved

[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)
[marten-seemann](/marten-seemann)
changed the title
~~Error if RSA key is too big~~
core/crypto: restrict RSA keys to <= 8192 bits
[Aug 2, 2023](#event-9993206361)

 [MarcoPolo](/MarcoPolo)
and others
added 2 commits
[August 2, 2023 16:51](#commits-pushed-5774d42)

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&v=4)](/marten-seemann)

`[Update core/crypto/rsa_common.go](/libp2p/go-libp2p/pull/2454/commits/5774d422ae64ce48286b95ce46e82090a925b353 "Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")`
 …

`[5774d42](/libp2p/go-libp2p/pull/2454/commits/5774d422ae64ce48286b95ce46e82090a925b353)`

```
Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&v=4)](/marten-seemann)

`[Update core/crypto/rsa_common.go](/libp2p/go-libp2p/pull/2454/commits/b836e9efebb9468b07d93c02837c63a2756575af "Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")`
 …

`[b836e9e](/libp2p/go-libp2p/pull/2454/commits/b836e9efebb9468b07d93c02837c63a2756575af)`

```
Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=80&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo)

Copy link

Collaborator

Author

### **[MarcoPolo](/MarcoPolo)** commented [Aug 2, 2023](#issuecomment-1663108245)

| Could it be that you missed a few cases? I'm less worried about the code path where you generate the RSA key yourself (although we should prevent that footgun as well), but more about those where the peer sends us its pubkey. What could path would be taken during the TLS / Noise handshake when we receive the peer's key? [image](https://user-images.githubusercontent.com/1478487/257965122-a529db2d-4ca4-477b-b2df-560be65f63eb.png)  PublicKeyFromProto uses `UnmarshalRsaPublicKey` under the hood which is covered by this patch. I think only `UnmarshalRsaPublicKey` and `GenerateRSAKeyPair` give you an RSA public key. |
| --- |

All reactions

Sorry, something went wrong.

 [MarcoPolo](/MarcoPolo)
added 2 commits
[August 2, 2023 16:57](#commits-pushed-ed40bd8)

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&v=4)](/MarcoPolo)

`[Fix rename](/libp2p/go-libp2p/pull/2454/commits/ed40bd8c7543c3908f9c00bdb41f572c35ab869c "Fix rename")`

`[ed40bd8](/libp2p/go-libp2p/pull/2454/commits/ed40bd8c7543c3908f9c00bdb41f572c35ab869c)`

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&v=4)](/MarcoPolo)

`[Make this var again so the tests work](/libp2p/go-libp2p/pull/2454/commits/73c53dd466af3fd63dc644fd16c771672f132d4a "Make this var again so the tests work")`

`[73c53dd](/libp2p/go-libp2p/pull/2454/commits/73c53dd466af3fd63dc644fd16c771672f132d4a)`

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo)
[MarcoPolo](/MarcoPolo)
enabled auto-merge (squash)
[August 3, 2023 00:26](#event-9993349660)

[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)
[marten-seemann](/marten-seemann)
disabled auto-merge
[August 3, 2023 14:26](#event-9999746054)

[![marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=60&v=4)](/marten-seemann)

**[marten-seemann](/marten-seemann)**
approved these changes
[Aug 3, 2023](#pullrequestreview-1561237255)

 [View reviewed changes](/libp2p/go-libp2p/pull/2454/files/73c53dd466af3fd63dc644fd16c771672f132d4a)

[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)
[marten-seemann](/marten-seemann)
merged commit [`9e01af8`](/libp2p/go-libp2p/commit/9e01af883f0b559551cbae417d5d6f883f45f39c)
into
master

[Aug 3, 2023](https://github.com/libp2p/go-libp2p/pull/2454#event-9999777316)

[marten-seemann](/marten-seemann)
added a commit
that referenced
this pull request
[Aug 3, 2023](#ref-commit-d73e06d)
[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)

`[core/crypto: restrict RSA keys to <= 8192 bits (](/libp2p/go-libp2p/commit/d73e06de501bb7f2a0dfaae98b1b7420a9495e88 "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")[#2454](https://github.com/libp2p/go-libp2p/pull/2454)[)](/libp2p/go-libp2p/commit/d73e06de501bb7f2a0dfaae98b1b7420a9495e88 "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")`
…

`[d73e06d](/libp2p/go-libp2p/commit/d73e06de501bb7f2a0dfaae98b1b7420a9495e88)`

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

[marten-seemann](/marten-seemann)
added a commit
that referenced
this pull request
[Aug 3, 2023](#ref-commit-b79194a)
[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)

`[core/crypto: restrict RSA keys to <= 8192 bits (](/libp2p/go-libp2p/commit/b79194a5a301e57f837c3bbe28154933ef325321 "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")[#2454](https://github.com/libp2p/go-libp2p/pull/2454)[)](/libp2p/go-libp2p/commit/b79194a5a301e57f837c3bbe28154933ef325321 "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")`
…

`[b79194a](/libp2p/go-libp2p/commit/b79194a5a301e57f837c3bbe28154933ef325321)`

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

[marten-seemann](/marten-seemann)
added a commit
that referenced
this pull request
[Aug 3, 2023](#ref-commit-445be52)
[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)

`[core/crypto: restrict RSA keys to <= 8192 bits (](/libp2p/go-libp2p/commit/445be526aea4ee0b1fa5388aa65d32b2816d3a00 "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")[#2454](https://github.com/libp2p/go-libp2p/pull/2454)[)](/libp2p/go-libp2p/commit/445be526aea4ee0b1fa5388aa65d32b2816d3a00 "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")`
…

`[445be52](/libp2p/go-libp2p/commit/445be526aea4ee0b1fa5388aa65d32b2816d3a00)`

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

[marten-seemann](/marten-seemann)
added a commit
that referenced
this pull request
[Aug 3, 2023](#ref-commit-e30fcf7)
[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)

`[core/crypto: restrict RSA keys to <= 8192 bits (](/libp2p/go-libp2p/commit/e30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")[#2454](https://github.com/libp2p/go-libp2p/pull/2454)[)](/libp2p/go-libp2p/commit/e30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")`
…

`[e30fcf7](/libp2p/go-libp2p/commit/e30fcf7dfd4715ed89a5e68d7a4f774d3b9aa92d)`

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

[marten-seemann](/marten-seemann)
added a commit
that referenced
this pull request
[Aug 3, 2023](#ref-commit-e51ee72)
[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)

`[core/crypto: restrict RSA keys to <= 8192 bits (](/libp2p/go-libp2p/commit/e51ee722686ef2b42674f31b9c69916d6ae13b7f "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")[#2454](https://github.com/libp2p/go-libp2p/pull/2454)[)](/libp2p/go-libp2p/commit/e51ee722686ef2b42674f31b9c69916d6ae13b7f "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")`
…

`[e51ee72](/libp2p/go-libp2p/commit/e51ee722686ef2b42674f31b9c69916d6ae13b7f)`

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo)
[MarcoPolo](/MarcoPolo)
mentioned this pull request
[Aug 3, 2023](#ref-pullrequest-1835849250)

[fix(crypto): limit RSA key size to <= 8192 bits
libp2p/js-libp2p#1931](/libp2p/js-libp2p/pull/1931)
 Merged

[marten-seemann](/marten-seemann)
added a commit
that referenced
this pull request
[Aug 4, 2023](#ref-commit-0cce607)
[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&u=78c36949a2df9de4daf4cee4206a3bc1ccda97ac&v=4)](/marten-seemann)

`[core/crypto: restrict RSA keys to <= 8192 bits (](/libp2p/go-libp2p/commit/0cce607219f3710addc7e18672cffd1f1d912fbb "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")[#2454](https://github.com/libp2p/go-libp2p/pull/2454)[)](/libp2p/go-libp2p/commit/0cce607219f3710addc7e18672cffd1f1d912fbb "core/crypto: restrict RSA keys to <= 8192 bits (#2454)

* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>")`
…

`[0cce607](/libp2p/go-libp2p/commit/0cce607219f3710addc7e18672cffd1f1d912fbb)`

```
* Error if RSA key is too big

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Update core/crypto/rsa_common.go

Co-authored-by: Marten Seemann <martenseemann@gmail.com>

* Fix rename

* Make this var again so the tests work

---------

Co-authored-by: Marten Seemann <martenseemann@gmail.com>
```

[achingbrain](/achingbrain)
added a commit
to libp2p/js-libp2p
that referenced
this pull request
[Aug 4, 2023](#ref-commit-58421e1)
[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=40&u=0e0177824fc8375a5db856e32761363b7af17017&v=4)](/MarcoPolo) [![@achingbrain](https://avatars.githubusercontent.com/u/665810?s=40&u=5f3f870f7fd8d15b11f9441ada20b5d0c18e38e5&v=4)](/achingbrain)

`[fix(crypto): limit RSA key size to <= 8192 bits (](/libp2p/js-libp2p/commit/58421e112e7217b36dea27e995f5cfe804387187 "fix(crypto): limit RSA key size to <= 8192 bits (#1931)

Restrict the RSA key sizes we expect from peers. Protects us from spending a lot of compute on verifying signatures from big keys. Similar to https://github.com/libp2p/go-libp2p/pull/2454

---------

Co-authored-by: achingbrain <alex@achingbrain.net>")[#1931](https://github.com/libp2p/js-libp2p/pull/1931)[)](/libp2p/js-libp2p/commit/58421e112e7217b36dea27e995f5cfe804387187 "fix(crypto): limit RSA key size to <= 8192 bits (#1931)

Restrict the RSA key sizes we expect from peers. Protects us from spending a lot of compute on verifying signatures from big keys. Similar to https://github.com/libp2p/go-libp2p/pull/2454

---------

Co-authored-by: achingbrain <alex@achingbrain.net>")`
…

`[58421e1](/libp2p/js-libp2p/commit/58421e112e7217b36dea27e995f5cfe804387187)`

```
Restrict the RSA key sizes we expect from peers. Protects us from spending a lot of compute on verifying signatures from big keys. Similar to [libp2p/go-libp2p#2454](https://github.com/libp2p/go-libp2p/pull/2454)

---------

Co-authored-by: achingbrain <alex@achingbrain.net>
```

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[Aug 8, 2023](#ref-issue-1842002008)

[x/vulndb: potential Go vuln in github.com/libp2p/go-libp2p: CVE-2023-39533
golang/vulndb#2000](/golang/vulndb/issues/2000)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Flibp2p%2Fgo-libp2p%2Fpull%2F2454)

Reviewers

[![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=40&v=4)](/marten-seemann) [marten-seemann](/marten-seemann)

marten-seemann approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@MarcoPolo](https://avatars.githubusercontent.com/u/594035?s=52&v=4)](/MarcoPolo) [![@marten-seemann](https://avatars.githubusercontent.com/u/1478487?s=52&v=4)](/marten-seemann)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_70d0fb03_20250111_051311.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F61460)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F61460)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=golang%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[go](/golang/go)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fgo) You must be signed in to change notification settings
* [Fork
  17.8k](/login?return_to=%2Fgolang%2Fgo)
* [Star
   125k](/login?return_to=%2Fgolang%2Fgo)

* [Code](/golang/go)
* [Issues
  5k+](/golang/go/issues)
* [Pull requests
  507](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects
  4](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

Additional navigation options

* [Code](/golang/go)
* [Issues](/golang/go/issues)
* [Pull requests](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# crypto/tls: verifying certificate chains containing large RSA keys is slow [CVE-2023-29409] #61460

Closed

[rolandshoemaker](/rolandshoemaker) opened this issue
Jul 19, 2023
· 27 comments

Closed

# [crypto/tls: verifying certificate chains containing large RSA keys is slow [CVE-2023-29409]](#top) #61460

[rolandshoemaker](/rolandshoemaker) opened this issue
Jul 19, 2023
· 27 comments

Labels
[NeedsFix](/golang/go/labels/NeedsFix)
The path to resolution is known, but the work has not been done.
[release-blocker](/golang/go/labels/release-blocker)
[Security](/golang/go/labels/Security)

Milestone
[Go1.21](/golang/go/milestone/279 "Go1.21")

## Comments

[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=80&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker)

Copy link

Member

### **[rolandshoemaker](/rolandshoemaker)** commented [Jul 19, 2023](#issue-1812839412) • edited by neild Loading

| Clients and servers which request and verify client certificates can be forced to expend a large amount of time verifying certificate chains which contain very large RSA keys during TLS handshakes.  Thanks to Mateusz Poliwczak for reporting this issue.  This is [CVE-2023-29409](https://github.com/advisories/GHSA-xc82-5m89-g4jv "CVE-2023-29409").   ---   This is a [PRIVATE](https://go.dev/security/policy#private) issue for [CVE-2023-29409](https://github.com/advisories/GHSA-xc82-5m89-g4jv "CVE-2023-29409"), tracked in <http://b/282987216> and fixed by <http://tg/1912161>.  /cc @golang/security and @golang/release |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker)
[rolandshoemaker](/rolandshoemaker)
added
[Security](/golang/go/labels/Security)
[release-blocker](/golang/go/labels/release-blocker)
labels
[Jul 19, 2023](#event-9867988669)

[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker)
[rolandshoemaker](/rolandshoemaker)
added this to the [Go1.21](/golang/go/milestone/279) milestone
[Jul 19, 2023](#event-9867988680)

[![@heschi](https://avatars.githubusercontent.com/u/24611692?s=40&v=4)](/heschi)
[heschi](/heschi)
added
the
[NeedsFix](/golang/go/labels/NeedsFix)
The path to resolution is known, but the work has not been done.
label
[Jul 20, 2023](#event-9877215031)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

### **[neild](/neild)** commented [Jul 25, 2023](#issuecomment-1650430891)

| [@gopherbot](https://github.com/gopherbot) please open backport issues |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Jul 25, 2023

[security: fix CVE-2023-29409 [1.19 backport]
#61579](/golang/go/issues/61579)

Closed

[security: fix CVE-2023-29409 [1.20 backport]
#61580](/golang/go/issues/61580)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jul 25, 2023](#issuecomment-1650431545)

| Backport issue(s) opened: [#61579](https://github.com/golang/go/issues/61579) (for 1.19), [#61580](https://github.com/golang/go/issues/61580) (for 1.20).  Remember to create the cherry-pick CL(s) as soon as the patch is submitted to master, according to <https://go.dev/wiki/MinorReleases>. |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Aug 1, 2023](#issuecomment-1660878108)

| Change <https://go.dev/cl/514915> mentions this issue: `[release-branch.go1.19] crypto/tls: restrict RSA keys in certificates to <= 8192 bits` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Aug 1, 2023](#issuecomment-1660878740)

| Change <https://go.dev/cl/514900> mentions this issue: `[release-branch.go1.20] crypto/tls: restrict RSA keys in certificates to <= 8192 bits` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Aug 1, 2023](#ref-commit-659f2a2)
[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker) [![@dr2chase](https://avatars.githubusercontent.com/u/1928999?s=40&v=4)](/dr2chase)

`[[release-branch.go1.20] crypto/tls: restrict RSA keys in certificates…](/golang/go/commit/659f2a22076713bd2500adc82e026b6a746d8ba1 "[release-branch.go1.20] crypto/tls: restrict RSA keys in certificates to <= 8192 bits

Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Updates #61460
Fixes #61580
Fixes CVE-2023-29409

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1912161
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
(cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1965747
TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/514900
Run-TryBot: David Chase <drchase@google.com>
Reviewed-by: Matthew Dempsky <mdempsky@google.com>
TryBot-Result: Gopher Robot <gobot@golang.org>")`
…

`[659f2a2](/golang/go/commit/659f2a22076713bd2500adc82e026b6a746d8ba1)`

```
… to <= 8192 bits

Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Updates [#61460](https://github.com/golang/go/issues/61460)
Fixes [#61580](https://github.com/golang/go/issues/61580)
Fixes [CVE-2023-29409](https://github.com/advisories/GHSA-xc82-5m89-g4jv "CVE-2023-29409")

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/1912161](https://team-review.git.corp.google.com/c/golang/go-private/%2B/1912161)
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
(cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/1965747](https://team-review.git.corp.google.com/c/golang/go-private/%2B/1965747)
TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/514900](https://go-review.googlesource.com/c/go/%2B/514900)
Run-TryBot: David Chase <drchase@google.com>
Reviewed-by: Matthew Dempsky <mdempsky@google.com>
TryBot-Result: Gopher Robot <gobot@golang.org>
```

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Aug 1, 2023](#ref-commit-2300f7e)
[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker) [![@dr2chase](https://avatars.githubusercontent.com/u/1928999?s=40&v=4)](/dr2chase)

`[[release-branch.go1.19] crypto/tls: restrict RSA keys in certificates…](/golang/go/commit/2300f7ef07718f6be4d8aa8486c7de99836e233f "[release-branch.go1.19] crypto/tls: restrict RSA keys in certificates to <= 8192 bits

Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Updates #61460
Fixes #61579
Fixes CVE-2023-29409

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1912161
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
(cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1965487
Reviewed-on: https://go-review.googlesource.com/c/go/+/514915
Run-TryBot: David Chase <drchase@google.com>
Reviewed-by: Matthew Dempsky <mdempsky@google.com>
TryBot-Bypass: David Chase <drchase@google.com>")`
…

`[2300f7e](/golang/go/commit/2300f7ef07718f6be4d8aa8486c7de99836e233f)`

```
… to <= 8192 bits

Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Updates [#61460](https://github.com/golang/go/issues/61460)
Fixes [#61579](https://github.com/golang/go/issues/61579)
Fixes [CVE-2023-29409](https://github.com/advisories/GHSA-xc82-5m89-g4jv "CVE-2023-29409")

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/1912161](https://team-review.git.corp.google.com/c/golang/go-private/%2B/1912161)
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
(cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/1965487](https://team-review.git.corp.google.com/c/golang/go-private/%2B/1965487)
Reviewed-on: [https://go-review.googlesource.com/c/go/+/514915](https://go-review.googlesource.com/c/go/%2B/514915)
Run-TryBot: David Chase <drchase@google.com>
Reviewed-by: Matthew Dempsky <mdempsky@google.com>
TryBot-Bypass: David Chase <drchase@google.com>
```

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Aug 1, 2023](#issuecomment-1661141176)

| Change <https://go.dev/cl/515056> mentions this issue: `[release-branch.go1.21] crypto/tls: restrict RSA keys in certificates to <= 8192 bits` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Aug 1, 2023](#issuecomment-1661155955)

| Closed by merging [a51957f](https://github.com/golang/go/commit/a51957fb0b20bb6c91d0415efca222cc9ecdb770) to release-branch.go1.21. |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
closed this as [completed](/golang/go/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Aug 1, 2023](#event-9981511416)

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Aug 1, 2023](#ref-commit-a51957f)
[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker) [![@dr2chase](https://avatars.githubusercontent.com/u/1928999?s=40&v=4)](/dr2chase)

`[[release-branch.go1.21] crypto/tls: restrict RSA keys in certificates…](/golang/go/commit/a51957fb0b20bb6c91d0415efca222cc9ecdb770 "[release-branch.go1.21] crypto/tls: restrict RSA keys in certificates to <= 8192 bits

Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Updates #61460
Fixes CVE-2023-29409

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1912161
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
(cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
Reviewed-on: https://go-review.googlesource.com/c/go/+/515056
Run-TryBot: David Chase <drchase@google.com>
TryBot-Result: Gopher Robot <gobot@golang.org>")`
…

`[a51957f](/golang/go/commit/a51957fb0b20bb6c91d0415efca222cc9ecdb770)`

```
… to <= 8192 bits

Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Updates [#61460](https://github.com/golang/go/issues/61460)
Fixes [CVE-2023-29409](https://github.com/advisories/GHSA-xc82-5m89-g4jv "CVE-2023-29409")

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/1912161](https://team-review.git.corp.google.com/c/golang/go-private/%2B/1912161)
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
(cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
Reviewed-on: [https://go-review.googlesource.com/c/go/+/515056](https://go-review.googlesource.com/c/go/%2B/515056)
Run-TryBot: David Chase <drchase@google.com>
TryBot-Result: Gopher Robot <gobot@golang.org>
```

[![@dmitshur](https://avatars.githubusercontent.com/u/1924134?s=80&u=db52e479359b3b7237ca14e22f87ff067e231769&v=4)](/dmitshur)

Copy link

Contributor

### **[dmitshur](/dmitshur)** commented [Aug 2, 2023](#issuecomment-1661280220) • edited Loading

| This is fixed on release-branch.go1.21, but still needs to be fixed on the main branch for Go 1.22. Reopening for that.  ([CL 515056](https://go.dev/cl/515056) said "Updates #​61460", not "Fixes #​61460", but this got closed ahead of time due anyway due to [#29599](https://github.com/golang/go/issues/29599).) |
| --- |

All reactions

Sorry, something went wrong.

[![@dmitshur](https://avatars.githubusercontent.com/u/1924134?s=40&u=db52e479359b3b7237ca14e22f87ff067e231769&v=4)](/dmitshur)
[dmitshur](/dmitshur)
reopened this
[Aug 2, 2023](#event-9982211910)

[![@dmitshur](https://avatars.githubusercontent.com/u/1924134?s=40&u=db52e479359b3b7237ca14e22f87ff067e231769&v=4)](/dmitshur)
[dmitshur](/dmitshur)
modified the milestones:
[Go1.21](/golang/go/milestone/279),
[Go1.22](/golang/go/milestone/298)
[Aug 2, 2023](#event-9982212506)

[bradfitz](/bradfitz)
pushed a commit
to tailscale/go
that referenced
this issue
[Aug 2, 2023](#ref-commit-f3d3b06)
[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=40&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker) [![@bradfitz](https://avatars.githubusercontent.com/u/2621?s=40&v=4)](/bradfitz)

`[[release-branch.go1.21] crypto/tls: restrict RSA keys in certificates…](/tailscale/go/commit/f3d3b06826ba8f9da6b0c170be5fbaf81cecd468 "[release-branch.go1.21] crypto/tls: restrict RSA keys in certificates to <= 8192 bits

Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Updates #61460
Fixes CVE-2023-29409

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1912161
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
(cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
Reviewed-on: https://go-review.googlesource.com/c/go/+/515056
Run-TryBot: David Chase <drchase@google.com>
TryBot-Result: Gopher Robot <gobot@golang.org>")`
…

`[f3d3b06](/tailscale/go/commit/f3d3b06826ba8f9da6b0c170be5fbaf81cecd468)`

```
… to <= 8192 bits

Extremely large RSA keys in certificate chains can cause a client/server
to expend significant CPU time verifying signatures. Limit this by
restricting the size of RSA keys transmitted during handshakes to <=
8192 bits.

Based on a survey of publicly trusted RSA keys, there are currently only
three certificates in circulation with keys larger than this, and all
three appear to be test certificates that are not actively deployed. It
is possible there are larger keys in use in private PKIs, but we target
the web PKI, so causing breakage here in the interests of increasing the
default safety of users of crypto/tls seems reasonable.

Thanks to Mateusz Poliwczak for reporting this issue.

Updates [golang#61460](https://github.com/golang/go/issues/61460)
Fixes [CVE-2023-29409](https://github.com/advisories/GHSA-xc82-5m89-g4jv "CVE-2023-29409")

Change-Id: Ie35038515a649199a36a12fc2c5df3af855dca6c
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/1912161](https://team-review.git.corp.google.com/c/golang/go-private/%2B/1912161)
Reviewed-by: Damien Neil <dneil@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Run-TryBot: Roland Shoemaker <bracewell@google.com>
(cherry picked from commit d865c715d92887361e4bd5596e19e513f27781b7)
Reviewed-on: [https://go-review.googlesource.com/c/go/+/515056](https://go-review.googlesource.com/c/go/%2B/515056)
Run-TryBot: David Chase <drchase@google.com>
TryBot-Result: Gopher Robot <gobot@golang.org>
```

[![@geofffranks](https://avatars.githubusercontent.com/u/7180882?s=80&u=53445805d8d10e33837b5d2c3232b8fba69804fb&v=4)](/geofffranks)

Copy link

### **[geofffranks](/geofffranks)** commented [Aug 2, 2023](#issuecomment-1662231728)

| Why was this implemented as a breaking change when backported in patch releases to existing golang versions? Usually y'all implement some sort of environment variable flag to allow code to opt in/out of changes like this until the next minor version. |
| --- |

 👍
2
 tcdowney and Gerg reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Aug 2, 2023](#issuecomment-1662250102)

| Change <https://go.dev/cl/515257> mentions this issue: `crypto/tls: restrict RSA keys in certificates to <= 8192 bits` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
closed this as [completed](/golang/go/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[2350afd](/golang/go/commit/2350afd2e8ab054390e284c95d5b089c142db017)`
[Aug 2, 2023](#event-9988958450)

[![@FiloSottile](https://avatars.githubusercontent.com/u/1225294?s=80&u=f9186107b90a6f746f8e7192ee7b1d5a68f4ab07&v=4)](/FiloSottile)

Copy link

Contributor

### **[FiloSottile](/FiloSottile)** commented [Aug 2, 2023](#issuecomment-1662344782)

| Note that the golang-announce announcement is missing a reference to this issue, or to the CVE number. |
| --- |

 👍
1
 dmitshur reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@dmitshur](https://avatars.githubusercontent.com/u/1924134?s=80&u=db52e479359b3b7237ca14e22f87ff067e231769&v=4)](/dmitshur)

Copy link

Contributor

### **[dmitshur](/dmitshur)** commented [Aug 2, 2023](#issuecomment-1662351973) • edited Loading

| The fix has now landed both to release-branch.go1.21 (for the upcoming go1.21.0 release, and already included in go1.21rc4) and to the main branch (for the eventual go1.22.0 release). Moving the milestone back to Go1.21 since that's the earlier of the two. (We don't have dedicated backport issues for Go1.21 during early thaw.)  The title and description of this issue still need to be updated though. (CC [@dr2chase](https://github.com/dr2chase).) |
| --- |

All reactions

Sorry, something went wrong.

[![@dmitshur](https://avatars.githubusercontent.com/u/1924134?s=40&u=db52e479359b3b7237ca14e22f87ff067e231769&v=4)](/dmitshur)
[dmitshur](/dmitshur)
modified the milestones:
[Go1.22](/golang/go/milestone/298),
[Go1.21](/golang/go/milestone/279)
[Aug 2, 2023](#event-9989105826)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
changed the title
~~security: fix CVE-2023-29409~~
crypto/tls: verifying certificate chains containing large RSA keys is slow [CVE-2023-29409]
[Aug 2, 2023](#event-9989856851)

[![@rsc](https://avatars.githubusercontent.com/u/104030?s=80&u=7776f9d68ea1bc349af0227c03fca30350a05477&v=4)](/rsc)

Copy link

Contributor

### **[rsc](/rsc)** commented [Aug 2, 2023](#issuecomment-1662563915)

| [@geofffranks](https://github.com/geofffranks) Generally speaking we use GODEBUGs for behavior changes that we expect to break people, and in security fixes we limit ourselves to changes we do *not* expect to break people. Are you using RSA keys > 8192-bit, or do you know of any common use of keys that large? Thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@doncicuto](https://avatars.githubusercontent.com/u/30386061?s=40&v=4)](/doncicuto)
[doncicuto](/doncicuto)
mentioned this issue
[Aug 2, 2023](#ref-issue-626580646)

[Update badge
zitadel/zitadel#151](/zitadel/zitadel/issues/151)

Open

3 tasks

[![@Gerg](https://avatars.githubusercontent.com/u/875892?s=80&u=7fd0eea279c73fb01863aaab76f7eae4d9de18cb&v=4)](/Gerg)

Copy link

### **[Gerg](/Gerg)** commented [Aug 2, 2023](#issuecomment-1662727771)

| For us, we distribute software built with Golang that is intended to be run in our customers' private networks. It is unlikely that any of our customers use such large RSA keys, but it's difficult to prove that they don't.  Without an "escape hatch" for this change, we probably have to pass this on to our customers as a breaking change, which complicates our release/support process. |
| --- |

All reactions

Sorry, something went wrong.

[![@geofffranks](https://avatars.githubusercontent.com/u/7180882?s=80&u=53445805d8d10e33837b5d2c3232b8fba69804fb&v=4)](/geofffranks)

Copy link

### **[geofffranks](/geofffranks)** commented [Aug 2, 2023](#issuecomment-1662786065)

| The CVE for this hasn't been published yet, so maybe there's information forthcomming that changes how this appears, but this change seems analogous to if a hard limit to reads on a TCP connection were implemented at some arbitrary value, in the interest of preventing clients from denying service by issuing infinite data streams.  Similar caps to protect servers from malicious client behavior exist, but they're all configurable by the server. This cap is arbitrary, and hardcoded in the language. For users wanting to use 16K RSA keys for a client or server (testing, research, extreme paranoia for highly sensitive material), golang is no longer an option. |
| --- |

 👍
1
 ankon reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=80&u=c9a1ba53e27929b8d12ab031c053f540a9693db3&v=4)](/rolandshoemaker)

Copy link

Member

Author

### **[rolandshoemaker](/rolandshoemaker)** commented [Aug 2, 2023](#issuecomment-1662902407)

| The 8192 bit limit was picked as it was considered an upper reasonable limit for acceptable verification latency, and because it was the upper limit of observed deployed keys. Surveying the web PKI, we found only two publicly trusted certificates containing 8192 bit or larger keys (both being 8192 bits). Since we primarily target the web PKI, this was considered an acceptable limit, since there were no known deployed publicly trusted keys above the limit.  Clearly people using private PKIs may use extremely large RSA keys, but it was my assumption that it would be extremely rare for anyone to be using keys larger than 8K, since that is already 2x the largest keys you typically see.  We generally try to avoid introducing GODEBUG flags in security changes (and in minor releases in general), but if it is clear that there are people relying on this behavior in the wild, we can look into introducing a flag that configures this behavior in the next minor release. |
| --- |

All reactions

Sorry, something went wrong.

[![@geofffranks](https://avatars.githubusercontent.com/u/7180882?s=80&u=53445805d8d10e33837b5d2c3232b8fba69804fb&v=4)](/geofffranks)

Copy link

### **[geofffranks](/geofffranks)** commented [Aug 3, 2023](#issuecomment-1663994474)

| We generally try to avoid introducing GODEBUG flags in security changes (and in minor releases in general), but if it is clear that there are people relying on this behavior in the wild, we can look into introducing a flag that configures this behavior in the next minor release.  My point is that golang has allowed users to customize via code which ciphers and TLS versions to use (including less secure options to a point). It has allowed users to customers to customize via code timeouts and maximum request sizes. Why was this any different? |
| --- |

All reactions

Sorry, something went wrong.

[![@FiloSottile](https://avatars.githubusercontent.com/u/1225294?s=80&u=f9186107b90a6f746f8e7192ee7b1d5a68f4ab07&v=4)](/FiloSottile)

Copy link

Contributor

### **[FiloSottile](/FiloSottile)** commented [Aug 3, 2023](#issuecomment-1664108112)

| Some things in crypto/tls are configurable for legacy or compatibility reasons, but conversely there are a number of things that are *not* configurable in crypto/tls. In particular, we don't support testing and research use cases through the public API, encouraging instead forks like uTLS, zcrypto/ztls, and BoGo.  To put the "extreme paranoia" angle in perspective, the NSA Commercial National Security Algorithm Suite requires 3072-bit keys all the way to Top Secret. The WebPKI root CAs have 4096-bit keys. Using keys larger than 8192 bits has no security justification, even in "extreme paranoia" threat models. |
| --- |

 👍
1
 afriza reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Astaoth](https://avatars.githubusercontent.com/u/505166?s=80&v=4)](/Astaoth)

Copy link

### **[Astaoth](/Astaoth)** commented [Aug 22, 2023](#issuecomment-1688256508)

| Hi,  I would like to underline that 16k TLS keys is the standard upper limit in most OS for at least a decade. By making an arbitrary hardcoded limit to 8k keys breaks the standard compatibility. This should be a parameter and not hardcoded.  Also, limiting the RSA key size is a weird way to fix this issue. It's like "your car AC sometime leaks ? Well I'll fix this by removing the AC of all the cars of the same brand. Now there is no AC leak anymore, but you can't have fresh air when it's warm outside.". It's not a fix at all, it's limiting/removing a functionality because for a large minority of users, sometime, it takes a "long time" (whatever this means) to check the RSA key.  On a side note, qualifying 16k RSA keys of "extreme paranoia" is kind of condescendant with the users using them : you don't know the use cases, you can't make any kind of judgement.  Kind regards |
| --- |

All reactions

Sorry, something went wrong.

[![@mateusz834](https://avatars.githubusercontent.com/u/19653795?s=80&u=e5b383d1989f4100bb3fabb835bbfe7a0d04bb06&v=4)](/mateusz834)

Copy link

Member

### **[mateusz834](/mateusz834)** commented [Aug 22, 2023](#issuecomment-1688261568)

| [@Astaoth](https://github.com/Astaoth) [#61965](https://github.com/golang/go/issues/61965) |
| --- |

All reactions

Sorry, something went wrong.

[![@Astaoth](https://avatars.githubusercontent.com/u/505166?s=40&v=4)](/Astaoth)
[Astaoth](/Astaoth)
mentioned this issue
[Aug 22, 2023](#ref-issue-1861599620)

[By default, GO breaks the TLS with 16k RSA keys compatibility
influxdata/telegraf#13817](/influxdata/telegraf/issues/13817)

Closed

[![@Astaoth](https://avatars.githubusercontent.com/u/505166?s=80&v=4)](/Astaoth)

Copy link

### **[Astaoth](/Astaoth)** commented [Aug 22, 2023](#issuecomment-1689018280)

| That's not really an answer. What you suggest can be done only at the building time and not at the execution time. |
| --- |

All reactions

Sorry, something went wrong.

[![@Astaoth](https://avatars.githubusercontent.com/u/505166?s=80&v=4)](/Astaoth)

Copy link

### **[Astaoth](/Astaoth)** commented [Aug 31, 2023](#issuecomment-1701729343)

| [@mateusz834](https://github.com/mateusz834) [@rolandshoemaker](https://github.com/rolandshoemaker)  Well, as this issue isn't really fixed but only hidden, out of curiosity, how will you react when the same issue will be reported to you with RSA 8k keys and light servers ? Will you rull out RSA 8k keys as well and states that you don't support light hardware ? And next, when the same issue will be reported to you with IOT devices and RSA 4k keys, will you state that you don't support IOT devices and you will drop RSA support as well ?  The way this issue is fixed is ridiculous and against good developpement and security pratices. |
| --- |

All reactions

Sorry, something went wrong.

[![@heschi](https://avatars.githubusercontent.com/u/24611692?s=80&v=4)](/heschi)

Copy link

Contributor

### **[heschi](/heschi)** commented [Aug 31, 2023](#issuecomment-1701738759)

| [@Astaoth](https://github.com/Astaoth) Please follow the [Code of Conduct](https://go.dev/conduct).  For the record, you're incorrect: GODEBUGs can be applied at runtime. |
| --- |

All reactions

Sorry, something went wrong.

[![@Astaoth](https://avatars.githubusercontent.com/u/505166?s=80&v=4)](/Astaoth)

Copy link

### **[Astaoth](/Astaoth)** commented [Aug 31, 2023](#issuecomment-1701749886)

| Hi [@heschi](https://github.com/heschi),  Thank you for the information about the GODEBUG.  Apologies but I fail to see how I've broken the code of conduct. The questions about 8k keys and IOT seem to be legitimate ones and their answers would allow me a better understanding of the GO team philosophy, especially about the security vision. |
| --- |

All reactions

Sorry, something went wrong.

[![@ianlancetaylor](https://avatars.githubusercontent.com/u/3194333?s=80&v=4)](/ianlancetaylor)

Copy link

Member

### **[ianlancetaylor](/ianlancetaylor)** commented [Aug 31, 2023](#issuecomment-1701774505)

| [@Astaoth](https://github.com/Astaoth) The code of conduct asks people to be charitable and respectful. There are ways to ask questions about Go development choices that do not predict what the response will be, and do not refer to what people are doing as ridiculous. Thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@Astaoth](https://avatars.githubusercontent.com/u/505166?s=80&v=4)](/Astaoth)

Copy link

### **[Astaoth](/Astaoth)** commented [Aug 31, 2023](#issuecomment-1701809401) • edited Loading

| [@ianlancetaylor](https://github.com/ianlancetaylor) That's interresting : in this case how would judging people and organizations in a condescending manner without knowing the context or judging the people intents respect the Code of Conduct ? Or unwelcoming 15 char messages ?  Also may I underline that I would haven't made any more noise than necessary here if an appropriate answer would have been provided in first place ? |
| --- |

All reactions

Sorry, something went wrong.

[![@ianlancetaylor](https://avatars.githubusercontent.com/u/3194333?s=80&v=4)](/ianlancetaylor)

Copy link

Member

### **[ianlancetaylor](/ianlancetaylor)** commented [Aug 31, 2023](#issuecomment-1701819714) • edited Loading

| I apologize on behalf of other open source contributors for making you feel condescended to or unwelcome. That is not a pleasant feeling, and I'm sorry that it happened. My only defense is that I'm sure it was not intended. The principle of charity applies here in particular: please assume that people responding to you have good intentions.  Nobody is asking you to not make noise. We are asking you to make noise respectfully and charitably.  Finally, note that this is not a support forum; for appropriate forums for questions about using Go please see <https://go.dev/wiki/Questions>. |
| --- |

 ❤️
1
 Astaoth reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

This was referenced Sep 1, 2023

[[release-1.12] Bump to Go 1.20.7
cert-manager/cert-manager#6318](/cert-manager/cert-manager/pull/6318)
 Merged

[[release-1.11] Bump to Go 1.19.12
cert-manager/cert-manager#6317](/cert-manager/cert-manager/pull/6317)
 Merged

[![@mateusz834](https://avatars.githubusercontent.com/u/19653795?s=40&u=e5b383d1989f4100bb3fabb835bbfe7a0d04bb06&v=4)](/mateusz834)
[mateusz834](/mateusz834)
mentioned this issue
[Feb 10, 2024](#ref-pullrequest-2128650475)

[crypto/x509: document that Verify does not restrict key sizes
#65651](/golang/go/pull/65651)
 Open

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Feb 10, 2024](#issuecomment-1937093905)

| Change <https://go.dev/cl/563136> mentions this issue: `crypto/x509: document that Verify does not restrict key sizes` |
| --- |

All reactions

Sorry, something went wrong.

[![@bk2204](https://avatars.githubusercontent.com/u/497054?s=40&v=4)](/bk2204)
[bk2204](/bk2204)
mentioned this issue
[Jun 12, 2024](#ref-issue-2348094236)

[Unable to check out git lfs repo hosting large files in Nexus
git-lfs/git-lfs#5798](/git-lfs/git-lfs/issues/5798)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F61460)

Assignees

No one assigned

Labels

[NeedsFix](/golang/go/labels/NeedsFix)
The path to resolution is known, but the work has not been done.
[release-blocker](/golang/go/labels/release-blocker)
[Security](/golang/go/labels/Security)

Projects

None yet

Milestone

 [**Go1.21**](/golang/go/milestone/279 "Go1.21")

Development

No branches or pull requests

12 participants

[![@neild](https://avatars.githubusercontent.com/u/52544?s=52&v=4)](/neild) [![@rsc](https://avatars.githubusercontent.com/u/104030?s=52&v=4)](/rsc) [![@Astaoth](https://avatars.githubusercontent.com/u/505166?s=52&v=4)](/Astaoth) [![@Gerg](https://avatars.githubusercontent.com/u/875892?s=52&v=4)](/Gerg) [![@FiloSottile](https://avatars.githubusercontent.com/u/1225294?s=52&v=4)](/FiloSottile) [![@dmitshur](https://avatars.githubusercontent.com/u/1924134?s=52&v=4)](/dmitshur) [![@ianlancetaylor](https://avatars.githubusercontent.com/u/3194333?s=52&v=4)](/ianlancetaylor) [![@rolandshoemaker](https://avatars.githubusercontent.com/u/5080674?s=52&v=4)](/rolandshoemaker) [![@geofffranks](https://avatars.githubusercontent.com/u/7180882?s=52&v=4)](/geofffranks) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=52&v=4)](/gopherbot) [![@mateusz834](https://avatars.githubusercontent.com/u/19653795?s=52&v=4)](/mateusz834) [![@heschi](https://avatars.githubusercontent.com/u/24611692?s=52&v=4)](/heschi)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


