=== Content from git.kernel.org_73169c83_20250111_043857.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuansheng Liu <chuansheng.liu@intel.com> | 2022-02-23 08:20:24 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-02 11:42:56 +0100 |
| commit | [e098933866f9e1dd3ef4eebbe2e3d504f970f599](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599)) | |
| tree | [dbdf10415415da7a8a851c3908fa8e3d4c79f1d0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599) | |
| parent | [5b1cef5798b4fd6e4fd5522e7b8a26248beeacaa](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5b1cef5798b4fd6e4fd5522e7b8a26248beeacaa) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599&id2=5b1cef5798b4fd6e4fd5522e7b8a26248beeacaa)) | |
| download | [linux-e098933866f9e1dd3ef4eebbe2e3d504f970f599.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e098933866f9e1dd3ef4eebbe2e3d504f970f599.tar.gz) | |

thermal: int340x: fix memory leak in int3400\_notify()commit 3abea10e6a8f0e7804ed4c124bea2d15aca977c8 upstream.
It is easy to hit the below memory leaks in my TigerLake platform:
unreferenced object 0xffff927c8b91dbc0 (size 32):
comm "kworker/0:2", pid 112, jiffies 4294893323 (age 83.604s)
hex dump (first 32 bytes):
4e 41 4d 45 3d 49 4e 54 33 34 30 30 20 54 68 65 NAME=INT3400 The
72 6d 61 6c 00 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b a5 rmal.kkkkkkkkkk.
backtrace:
[<ffffffff9c502c3e>] \_\_kmalloc\_track\_caller+0x2fe/0x4a0
[<ffffffff9c7b7c15>] kvasprintf+0x65/0xd0
[<ffffffff9c7b7d6e>] kasprintf+0x4e/0x70
[<ffffffffc04cb662>] int3400\_notify+0x82/0x120 [int3400\_thermal]
[<ffffffff9c8b7358>] acpi\_ev\_notify\_dispatch+0x54/0x71
[<ffffffff9c88f1a7>] acpi\_os\_execute\_deferred+0x17/0x30
[<ffffffff9c2c2c0a>] process\_one\_work+0x21a/0x3f0
[<ffffffff9c2c2e2a>] worker\_thread+0x4a/0x3b0
[<ffffffff9c2cb4dd>] kthread+0xfd/0x130
[<ffffffff9c201c1f>] ret\_from\_fork+0x1f/0x30
Fix it by calling kfree() accordingly.
Fixes: 38e44da59130 ("thermal: int3400\_thermal: process "thermal table changed" event")
Signed-off-by: Chuansheng Liu <chuansheng.liu@intel.com>
Cc: 4.14+ <stable@vger.kernel.org> # 4.14+
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599)

| -rw-r--r-- | [drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c b/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.cindex 0966551cbaaa0a..793d7b58fc6501 100644--- a/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=5b1cef5798b4fd6e4fd5522e7b8a26248beeacaa)+++ b/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=e098933866f9e1dd3ef4eebbe2e3d504f970f599)@@ -402,6 +402,10 @@ static void int3400\_notify(acpi\_handle handle, thermal\_prop[3] = kasprintf(GFP\_KERNEL, "EVENT=%d", therm\_event); thermal\_prop[4] = NULL; kobject\_uevent\_env(&priv->thermal->device.kobj, KOBJ\_CHANGE, thermal\_prop);+ kfree(thermal\_prop[0]);+ kfree(thermal\_prop[1]);+ kfree(thermal\_prop[2]);+ kfree(thermal\_prop[3]); }  static int int3400\_thermal\_get\_temp(struct thermal\_zone\_device \*thermal, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:37:34 +0000



=== Content from git.kernel.org_2ca4056b_20250111_043854.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuansheng Liu <chuansheng.liu@intel.com> | 2022-02-23 08:20:24 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-02 11:48:07 +0100 |
| commit | [ba9efbbf6745750d34c1e87c9539ce9db645ca0a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a)) | |
| tree | [1ea84b7cc08d1859b658f3e51ab926e4154eec25](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a) | |
| parent | [00265efbd3e5705038c9492a434fda8cf960c8a2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=00265efbd3e5705038c9492a434fda8cf960c8a2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a&id2=00265efbd3e5705038c9492a434fda8cf960c8a2)) | |
| download | [linux-ba9efbbf6745750d34c1e87c9539ce9db645ca0a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ba9efbbf6745750d34c1e87c9539ce9db645ca0a.tar.gz) | |

thermal: int340x: fix memory leak in int3400\_notify()commit 3abea10e6a8f0e7804ed4c124bea2d15aca977c8 upstream.
It is easy to hit the below memory leaks in my TigerLake platform:
unreferenced object 0xffff927c8b91dbc0 (size 32):
comm "kworker/0:2", pid 112, jiffies 4294893323 (age 83.604s)
hex dump (first 32 bytes):
4e 41 4d 45 3d 49 4e 54 33 34 30 30 20 54 68 65 NAME=INT3400 The
72 6d 61 6c 00 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b a5 rmal.kkkkkkkkkk.
backtrace:
[<ffffffff9c502c3e>] \_\_kmalloc\_track\_caller+0x2fe/0x4a0
[<ffffffff9c7b7c15>] kvasprintf+0x65/0xd0
[<ffffffff9c7b7d6e>] kasprintf+0x4e/0x70
[<ffffffffc04cb662>] int3400\_notify+0x82/0x120 [int3400\_thermal]
[<ffffffff9c8b7358>] acpi\_ev\_notify\_dispatch+0x54/0x71
[<ffffffff9c88f1a7>] acpi\_os\_execute\_deferred+0x17/0x30
[<ffffffff9c2c2c0a>] process\_one\_work+0x21a/0x3f0
[<ffffffff9c2c2e2a>] worker\_thread+0x4a/0x3b0
[<ffffffff9c2cb4dd>] kthread+0xfd/0x130
[<ffffffff9c201c1f>] ret\_from\_fork+0x1f/0x30
Fix it by calling kfree() accordingly.
Fixes: 38e44da59130 ("thermal: int3400\_thermal: process "thermal table changed" event")
Signed-off-by: Chuansheng Liu <chuansheng.liu@intel.com>
Cc: 4.14+ <stable@vger.kernel.org> # 4.14+
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a)

| -rw-r--r-- | [drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c b/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.cindex 19926beeb3b712..176b8e5d21246c 100644--- a/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=00265efbd3e5705038c9492a434fda8cf960c8a2)+++ b/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=ba9efbbf6745750d34c1e87c9539ce9db645ca0a)@@ -405,6 +405,10 @@ static void int3400\_notify(acpi\_handle handle, thermal\_prop[3] = kasprintf(GFP\_KERNEL, "EVENT=%d", therm\_event); thermal\_prop[4] = NULL; kobject\_uevent\_env(&priv->thermal->device.kobj, KOBJ\_CHANGE, thermal\_prop);+ kfree(thermal\_prop[0]);+ kfree(thermal\_prop[1]);+ kfree(thermal\_prop[2]);+ kfree(thermal\_prop[3]); }  static int int3400\_thermal\_get\_temp(struct thermal\_zone\_device \*thermal, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:37:31 +0000



=== Content from git.kernel.org_87d72abd_20250111_043851.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2e798814e01827871938ff172d2b2ccf1e74b355)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2e798814e01827871938ff172d2b2ccf1e74b355)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2e798814e01827871938ff172d2b2ccf1e74b355)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2e798814e01827871938ff172d2b2ccf1e74b355)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuansheng Liu <chuansheng.liu@intel.com> | 2022-02-23 08:20:24 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-28 08:46:44 +0200 |
| commit | [2e798814e01827871938ff172d2b2ccf1e74b355](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2e798814e01827871938ff172d2b2ccf1e74b355) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2e798814e01827871938ff172d2b2ccf1e74b355)) | |
| tree | [1b22ecc045f8920f6fcb29cfe219fa4f83ead253](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2e798814e01827871938ff172d2b2ccf1e74b355) | |
| parent | [5ff048f4ab5cf6338fccbcc6354205287189c43c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5ff048f4ab5cf6338fccbcc6354205287189c43c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2e798814e01827871938ff172d2b2ccf1e74b355&id2=5ff048f4ab5cf6338fccbcc6354205287189c43c)) | |
| download | [linux-2e798814e01827871938ff172d2b2ccf1e74b355.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2e798814e01827871938ff172d2b2ccf1e74b355.tar.gz) | |

thermal: int340x: fix memory leak in int3400\_notify()commit 3abea10e6a8f0e7804ed4c124bea2d15aca977c8 upstream.
It is easy to hit the below memory leaks in my TigerLake platform:
unreferenced object 0xffff927c8b91dbc0 (size 32):
comm "kworker/0:2", pid 112, jiffies 4294893323 (age 83.604s)
hex dump (first 32 bytes):
4e 41 4d 45 3d 49 4e 54 33 34 30 30 20 54 68 65 NAME=INT3400 The
72 6d 61 6c 00 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b a5 rmal.kkkkkkkkkk.
backtrace:
[<ffffffff9c502c3e>] \_\_kmalloc\_track\_caller+0x2fe/0x4a0
[<ffffffff9c7b7c15>] kvasprintf+0x65/0xd0
[<ffffffff9c7b7d6e>] kasprintf+0x4e/0x70
[<ffffffffc04cb662>] int3400\_notify+0x82/0x120 [int3400\_thermal]
[<ffffffff9c8b7358>] acpi\_ev\_notify\_dispatch+0x54/0x71
[<ffffffff9c88f1a7>] acpi\_os\_execute\_deferred+0x17/0x30
[<ffffffff9c2c2c0a>] process\_one\_work+0x21a/0x3f0
[<ffffffff9c2c2e2a>] worker\_thread+0x4a/0x3b0
[<ffffffff9c2cb4dd>] kthread+0xfd/0x130
[<ffffffff9c201c1f>] ret\_from\_fork+0x1f/0x30
Fix it by calling kfree() accordingly.
Fixes: 38e44da59130 ("thermal: int3400\_thermal: process "thermal table changed" event")
Signed-off-by: Chuansheng Liu <chuansheng.liu@intel.com>
Cc: 4.14+ <stable@vger.kernel.org> # 4.14+
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
[sudip: adjust context]
Signed-off-by: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2e798814e01827871938ff172d2b2ccf1e74b355)

| -rw-r--r-- | [drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=2e798814e01827871938ff172d2b2ccf1e74b355) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c b/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.cindex 3517883b5cdb92..a31163547fbaa9 100644--- a/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=5ff048f4ab5cf6338fccbcc6354205287189c43c)+++ b/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=2e798814e01827871938ff172d2b2ccf1e74b355)@@ -216,6 +216,10 @@ static void int3400\_notify(acpi\_handle handle, thermal\_prop[4] = NULL; kobject\_uevent\_env(&priv->thermal->device.kobj, KOBJ\_CHANGE, thermal\_prop);+ kfree(thermal\_prop[0]);+ kfree(thermal\_prop[1]);+ kfree(thermal\_prop[2]);+ kfree(thermal\_prop[3]); break; default: /\* Ignore unknown notification codes sent to INT3400 device \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:37:28 +0000



=== Content from git.kernel.org_ce49531a_20250111_043853.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuansheng Liu <chuansheng.liu@intel.com> | 2022-02-23 08:20:24 +0800 |
| --- | --- | --- |
| committer | Rafael J. Wysocki <rafael.j.wysocki@intel.com> | 2022-02-24 20:14:19 +0100 |
| commit | [3abea10e6a8f0e7804ed4c124bea2d15aca977c8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8)) | |
| tree | [98e96a3e76815427afdf292c0e0c59d31d329039](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8) | |
| parent | [cfb92440ee71adcc2105b0890bb01ac3cddb8507](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cfb92440ee71adcc2105b0890bb01ac3cddb8507) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8&id2=cfb92440ee71adcc2105b0890bb01ac3cddb8507)) | |
| download | [linux-3abea10e6a8f0e7804ed4c124bea2d15aca977c8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3abea10e6a8f0e7804ed4c124bea2d15aca977c8.tar.gz) | |

thermal: int340x: fix memory leak in int3400\_notify()It is easy to hit the below memory leaks in my TigerLake platform:
unreferenced object 0xffff927c8b91dbc0 (size 32):
comm "kworker/0:2", pid 112, jiffies 4294893323 (age 83.604s)
hex dump (first 32 bytes):
4e 41 4d 45 3d 49 4e 54 33 34 30 30 20 54 68 65 NAME=INT3400 The
72 6d 61 6c 00 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b a5 rmal.kkkkkkkkkk.
backtrace:
[<ffffffff9c502c3e>] \_\_kmalloc\_track\_caller+0x2fe/0x4a0
[<ffffffff9c7b7c15>] kvasprintf+0x65/0xd0
[<ffffffff9c7b7d6e>] kasprintf+0x4e/0x70
[<ffffffffc04cb662>] int3400\_notify+0x82/0x120 [int3400\_thermal]
[<ffffffff9c8b7358>] acpi\_ev\_notify\_dispatch+0x54/0x71
[<ffffffff9c88f1a7>] acpi\_os\_execute\_deferred+0x17/0x30
[<ffffffff9c2c2c0a>] process\_one\_work+0x21a/0x3f0
[<ffffffff9c2c2e2a>] worker\_thread+0x4a/0x3b0
[<ffffffff9c2cb4dd>] kthread+0xfd/0x130
[<ffffffff9c201c1f>] ret\_from\_fork+0x1f/0x30
Fix it by calling kfree() accordingly.
Fixes: 38e44da59130 ("thermal: int3400\_thermal: process "thermal table changed" event")
Signed-off-by: Chuansheng Liu <chuansheng.liu@intel.com>
Cc: 4.14+ <stable@vger.kernel.org> # 4.14+
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8)

| -rw-r--r-- | [drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c b/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.cindex 72acb1f6184970..4f478812cb5144 100644--- a/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=cfb92440ee71adcc2105b0890bb01ac3cddb8507)+++ b/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=3abea10e6a8f0e7804ed4c124bea2d15aca977c8)@@ -404,6 +404,10 @@ static void int3400\_notify(acpi\_handle handle, thermal\_prop[3] = kasprintf(GFP\_KERNEL, "EVENT=%d", therm\_event); thermal\_prop[4] = NULL; kobject\_uevent\_env(&priv->thermal->device.kobj, KOBJ\_CHANGE, thermal\_prop);+ kfree(thermal\_prop[0]);+ kfree(thermal\_prop[1]);+ kfree(thermal\_prop[2]);+ kfree(thermal\_prop[3]); }  static int int3400\_thermal\_get\_temp(struct thermal\_zone\_device \*thermal, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:37:30 +0000



=== Content from git.kernel.org_1cc24dfc_20250111_043858.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuansheng Liu <chuansheng.liu@intel.com> | 2022-02-23 08:20:24 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-28 08:22:26 +0200 |
| commit | [f0ddc5184b0127038d05008e2a69f89d1e13f980](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980)) | |
| tree | [324f05b39b1beda017268fb611360be7152d7d8b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980) | |
| parent | [97f4a463902ca5f3246dad32100962d00816e1ec](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=97f4a463902ca5f3246dad32100962d00816e1ec) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980&id2=97f4a463902ca5f3246dad32100962d00816e1ec)) | |
| download | [linux-f0ddc5184b0127038d05008e2a69f89d1e13f980.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f0ddc5184b0127038d05008e2a69f89d1e13f980.tar.gz) | |

thermal: int340x: fix memory leak in int3400\_notify()commit 3abea10e6a8f0e7804ed4c124bea2d15aca977c8 upstream.
It is easy to hit the below memory leaks in my TigerLake platform:
unreferenced object 0xffff927c8b91dbc0 (size 32):
comm "kworker/0:2", pid 112, jiffies 4294893323 (age 83.604s)
hex dump (first 32 bytes):
4e 41 4d 45 3d 49 4e 54 33 34 30 30 20 54 68 65 NAME=INT3400 The
72 6d 61 6c 00 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b a5 rmal.kkkkkkkkkk.
backtrace:
[<ffffffff9c502c3e>] \_\_kmalloc\_track\_caller+0x2fe/0x4a0
[<ffffffff9c7b7c15>] kvasprintf+0x65/0xd0
[<ffffffff9c7b7d6e>] kasprintf+0x4e/0x70
[<ffffffffc04cb662>] int3400\_notify+0x82/0x120 [int3400\_thermal]
[<ffffffff9c8b7358>] acpi\_ev\_notify\_dispatch+0x54/0x71
[<ffffffff9c88f1a7>] acpi\_os\_execute\_deferred+0x17/0x30
[<ffffffff9c2c2c0a>] process\_one\_work+0x21a/0x3f0
[<ffffffff9c2c2e2a>] worker\_thread+0x4a/0x3b0
[<ffffffff9c2cb4dd>] kthread+0xfd/0x130
[<ffffffff9c201c1f>] ret\_from\_fork+0x1f/0x30
Fix it by calling kfree() accordingly.
Fixes: 38e44da59130 ("thermal: int3400\_thermal: process "thermal table changed" event")
Signed-off-by: Chuansheng Liu <chuansheng.liu@intel.com>
Cc: 4.14+ <stable@vger.kernel.org> # 4.14+
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
[sudip: change in old path]
Signed-off-by: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0ddc5184b0127038d05008e2a69f89d1e13f980)

| -rw-r--r-- | [drivers/thermal/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/thermal/int340x_thermal/int3400_thermal.c?id=f0ddc5184b0127038d05008e2a69f89d1e13f980) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/thermal/int340x\_thermal/int3400\_thermal.c b/drivers/thermal/int340x\_thermal/int3400\_thermal.cindex 4a20f4d47b1de2..d7cd861160844d 100644--- a/[drivers/thermal/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/int340x_thermal/int3400_thermal.c?id=97f4a463902ca5f3246dad32100962d00816e1ec)+++ b/[drivers/thermal/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/int340x_thermal/int3400_thermal.c?id=f0ddc5184b0127038d05008e2a69f89d1e13f980)@@ -223,6 +223,10 @@ static void int3400\_notify(acpi\_handle handle, thermal\_prop[4] = NULL; kobject\_uevent\_env(&priv->thermal->device.kobj, KOBJ\_CHANGE, thermal\_prop);+ kfree(thermal\_prop[0]);+ kfree(thermal\_prop[1]);+ kfree(thermal\_prop[2]);+ kfree(thermal\_prop[3]); break; default: dev\_err(&priv->adev->dev, "Unsupported event [0x%x]\n", event); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:37:35 +0000



=== Content from git.kernel.org_b3a36c99_20250111_043852.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=33c73a4d7e7b19313a6b417152f5365016926418)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=33c73a4d7e7b19313a6b417152f5365016926418)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=33c73a4d7e7b19313a6b417152f5365016926418)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=33c73a4d7e7b19313a6b417152f5365016926418)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuansheng Liu <chuansheng.liu@intel.com> | 2022-02-23 08:20:24 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-02 11:51:18 +0100 |
| commit | [33c73a4d7e7b19313a6b417152f5365016926418](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=33c73a4d7e7b19313a6b417152f5365016926418) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=33c73a4d7e7b19313a6b417152f5365016926418)) | |
| tree | [243796ca810b785efcfdced7cb271a571db60f2f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=33c73a4d7e7b19313a6b417152f5365016926418) | |
| parent | [d350724795c7a48b05bf921d94699fbfecf7da0b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d350724795c7a48b05bf921d94699fbfecf7da0b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=33c73a4d7e7b19313a6b417152f5365016926418&id2=d350724795c7a48b05bf921d94699fbfecf7da0b)) | |
| download | [linux-33c73a4d7e7b19313a6b417152f5365016926418.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-33c73a4d7e7b19313a6b417152f5365016926418.tar.gz) | |

thermal: int340x: fix memory leak in int3400\_notify()commit 3abea10e6a8f0e7804ed4c124bea2d15aca977c8 upstream.
It is easy to hit the below memory leaks in my TigerLake platform:
unreferenced object 0xffff927c8b91dbc0 (size 32):
comm "kworker/0:2", pid 112, jiffies 4294893323 (age 83.604s)
hex dump (first 32 bytes):
4e 41 4d 45 3d 49 4e 54 33 34 30 30 20 54 68 65 NAME=INT3400 The
72 6d 61 6c 00 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b a5 rmal.kkkkkkkkkk.
backtrace:
[<ffffffff9c502c3e>] \_\_kmalloc\_track\_caller+0x2fe/0x4a0
[<ffffffff9c7b7c15>] kvasprintf+0x65/0xd0
[<ffffffff9c7b7d6e>] kasprintf+0x4e/0x70
[<ffffffffc04cb662>] int3400\_notify+0x82/0x120 [int3400\_thermal]
[<ffffffff9c8b7358>] acpi\_ev\_notify\_dispatch+0x54/0x71
[<ffffffff9c88f1a7>] acpi\_os\_execute\_deferred+0x17/0x30
[<ffffffff9c2c2c0a>] process\_one\_work+0x21a/0x3f0
[<ffffffff9c2c2e2a>] worker\_thread+0x4a/0x3b0
[<ffffffff9c2cb4dd>] kthread+0xfd/0x130
[<ffffffff9c201c1f>] ret\_from\_fork+0x1f/0x30
Fix it by calling kfree() accordingly.
Fixes: 38e44da59130 ("thermal: int3400\_thermal: process "thermal table changed" event")
Signed-off-by: Chuansheng Liu <chuansheng.liu@intel.com>
Cc: 4.14+ <stable@vger.kernel.org> # 4.14+
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=33c73a4d7e7b19313a6b417152f5365016926418)

| -rw-r--r-- | [drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=33c73a4d7e7b19313a6b417152f5365016926418) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c b/drivers/thermal/intel/int340x\_thermal/int3400\_thermal.cindex 8502b7d8df8962..68f61a7389303a 100644--- a/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=d350724795c7a48b05bf921d94699fbfecf7da0b)+++ b/[drivers/thermal/intel/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/intel/int340x_thermal/int3400_thermal.c?id=33c73a4d7e7b19313a6b417152f5365016926418)@@ -404,6 +404,10 @@ static void int3400\_notify(acpi\_handle handle, thermal\_prop[3] = kasprintf(GFP\_KERNEL, "EVENT=%d", therm\_event); thermal\_prop[4] = NULL; kobject\_uevent\_env(&priv->thermal->device.kobj, KOBJ\_CHANGE, thermal\_prop);+ kfree(thermal\_prop[0]);+ kfree(thermal\_prop[1]);+ kfree(thermal\_prop[2]);+ kfree(thermal\_prop[3]); }  static int int3400\_thermal\_get\_temp(struct thermal\_zone\_device \*thermal, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:37:29 +0000



=== Content from git.kernel.org_86dc574c_20250111_043855.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuansheng Liu <chuansheng.liu@intel.com> | 2022-02-23 08:20:24 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-28 08:41:43 +0200 |
| commit | [c3fa6d1937a8d0828131a04ae2cd2c30d0668693](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693)) | |
| tree | [0621ab6833784980bda1e070c5a4e4a5c5143530](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693) | |
| parent | [d1641f57a1687206d1703605c8e960d716c96144](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d1641f57a1687206d1703605c8e960d716c96144) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693&id2=d1641f57a1687206d1703605c8e960d716c96144)) | |
| download | [linux-c3fa6d1937a8d0828131a04ae2cd2c30d0668693.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c3fa6d1937a8d0828131a04ae2cd2c30d0668693.tar.gz) | |

thermal: int340x: fix memory leak in int3400\_notify()commit 3abea10e6a8f0e7804ed4c124bea2d15aca977c8 upstream.
It is easy to hit the below memory leaks in my TigerLake platform:
unreferenced object 0xffff927c8b91dbc0 (size 32):
comm "kworker/0:2", pid 112, jiffies 4294893323 (age 83.604s)
hex dump (first 32 bytes):
4e 41 4d 45 3d 49 4e 54 33 34 30 30 20 54 68 65 NAME=INT3400 The
72 6d 61 6c 00 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b a5 rmal.kkkkkkkkkk.
backtrace:
[<ffffffff9c502c3e>] \_\_kmalloc\_track\_caller+0x2fe/0x4a0
[<ffffffff9c7b7c15>] kvasprintf+0x65/0xd0
[<ffffffff9c7b7d6e>] kasprintf+0x4e/0x70
[<ffffffffc04cb662>] int3400\_notify+0x82/0x120 [int3400\_thermal]
[<ffffffff9c8b7358>] acpi\_ev\_notify\_dispatch+0x54/0x71
[<ffffffff9c88f1a7>] acpi\_os\_execute\_deferred+0x17/0x30
[<ffffffff9c2c2c0a>] process\_one\_work+0x21a/0x3f0
[<ffffffff9c2c2e2a>] worker\_thread+0x4a/0x3b0
[<ffffffff9c2cb4dd>] kthread+0xfd/0x130
[<ffffffff9c201c1f>] ret\_from\_fork+0x1f/0x30
Fix it by calling kfree() accordingly.
Fixes: 38e44da59130 ("thermal: int3400\_thermal: process "thermal table changed" event")
Signed-off-by: Chuansheng Liu <chuansheng.liu@intel.com>
Cc: 4.14+ <stable@vger.kernel.org> # 4.14+
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
[sudip: change in old path]
Signed-off-by: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693)

| -rw-r--r-- | [drivers/thermal/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/thermal/int340x_thermal/int3400_thermal.c?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 0 deletions

| diff --git a/drivers/thermal/int340x\_thermal/int3400\_thermal.c b/drivers/thermal/int340x\_thermal/int3400\_thermal.cindex e9d58de8b5da60..77967da5d4061f 100644--- a/[drivers/thermal/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/int340x_thermal/int3400_thermal.c?id=d1641f57a1687206d1703605c8e960d716c96144)+++ b/[drivers/thermal/int340x\_thermal/int3400\_thermal.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/thermal/int340x_thermal/int3400_thermal.c?id=c3fa6d1937a8d0828131a04ae2cd2c30d0668693)@@ -223,6 +223,10 @@ static void int3400\_notify(acpi\_handle handle, thermal\_prop[4] = NULL; kobject\_uevent\_env(&priv->thermal->device.kobj, KOBJ\_CHANGE, thermal\_prop);+ kfree(thermal\_prop[0]);+ kfree(thermal\_prop[1]);+ kfree(thermal\_prop[2]);+ kfree(thermal\_prop[3]); break; default: /\* Ignore unknown notification codes sent to INT3400 device \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:37:32 +0000


