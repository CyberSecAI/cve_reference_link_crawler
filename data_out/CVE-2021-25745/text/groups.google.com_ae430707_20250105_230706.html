[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## kubernetes-security-announce

[Conversations](./g/kubernetes-security-announce)[About](./g/kubernetes-security-announce/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)


# [Security Advisory] CVE-2021-25745: Ingress-nginx `path` can be pointed to service account token file

 544 viewsSkip to first unread message![CJ Cullen's profile photo](//lh3.googleusercontent.com/a-/ALV-UjX2KGGWGDb-UBSl0fAd0_cNKxSUKyakFqk0fDalxdTQaNBiGeNw=s40-c)
### CJ Cullen

unread,Apr 22, 2022, 5:31:36 PM4/22/22Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto kubernete...@googlegroups.com, kubernetes-dev, kubernetes-sec...@googlegroups.com, kubernetes-se...@googlegroups.com, distributo...@kubernetes.io, kubernetes+a...@discoursemail.com
### Issue Details

A security issue was discovered in [ingress-nginx](https://github.com/kubernetes/ingress-nginx) where a user that can create or update ingress objects can use the `spec.rules[].http.paths[].path` field of an Ingress object (in the `[networking.k8s.io](http://networking.k8s.io)` or `extensions` API group) to obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.

This issue has been rated High ([CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L)), and assigned CVE-2021-25745.

### Affected Components and Configurations

This bug affects ingress-nginx. If you do not have ingress-nginx installed on your cluster, you are not affected. You can check this by running `kubectl get po -n ingress-nginx`.

Multitenant environments where non-admin users have permissions to create Ingress objects are most affected by this issue.

### Affected Versions

* <v1.2.0

### Fixed Versions

* v1.2.0-beta.0
* v1.2.0

### Mitigation

If you are unable to roll out the fix, this vulnerability can be mitigated by implementing an admission policy that restricts the `spec.rules[].http.paths[].path` field on the [networking.k8s.io/Ingress](http://networking.k8s.io/Ingress) resource to known safe characters (see the newly added [rules](https://github.com/kubernetes/ingress-nginx/blame/main/internal/ingress/inspector/rules.go), or the suggested value for [annotation-value-word-blocklist](https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#annotation-value-word-blocklist)).

### Detection

If you find evidence that this vulnerability has been exploited, please contact secu...@kubernetes.io

### Additional Details

See ingress-nginx Issue [#8502](https://github.com/kubernetes/ingress-nginx/issues/8502) for more details.

### Acknowledgements

This vulnerability was reported by Gafnit Amiga.

Thank You,

CJ Cullen on behalf of the Kubernetes Security Response Committee

Reply allReply to authorForward0 new messages