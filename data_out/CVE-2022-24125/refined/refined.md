Based on the provided content, here's an analysis of CVE-2022-24125 and CVE-2022-24126:

**CVE-2022-24125 & CVE-2022-24126**

*   **Root Cause of Vulnerability:**
    *   **CVE-2022-24126:** Improper bounds checking when parsing `NRSessionSearchResult` data, specifically a stack buffer overflow when copying the host name, coupled with a lack of size validation when processing variable-length data entries. This allows for overwriting the `vftable_ptr` of a `DLMemoryInputStream` object, leading to arbitrary code redirection.
    *   **CVE-2022-24125:** A vulnerability in the matchmaking server that allows any client to send arbitrary push messages to other players, bypassing intended restrictions. The `RequestSendMessageToPlayers` request, which is intended to send messages only to invaders, can be abused to target any player.

*   **Weaknesses/Vulnerabilities Present:**
    *   **Stack Buffer Overflow:** A fixed-size stack buffer is used without bounds checking to read player names, allowing an attacker to overwrite stack memory.
    *   **Out-of-Bounds Read:** The parser blindly trusts the size field of a data entry, leading to out-of-bounds read which can cause game crashes or be used for exploitation by manipulating the size field when creating a `DLMemoryInputSteam` object on the stack
    *   **Arbitrary Push Message Sending:** The `RequestSendMessageToPlayers` request can be used to impersonate the matchmaking server and send exploits via `PushRequestVisit` to other players, leading to remote code execution.

*   **Impact of Exploitation:**
    *   **Remote Code Execution (RCE):** By overflowing the stack buffer, overwriting the `vftable_ptr`, and manipulating the data size field of the `DLMemoryInputStream`, an attacker can redirect execution and achieve arbitrary code execution on the victim's machine.
    *   **Widespread Vulnerability:** Due to the vulnerability being linked to matchmaking and arbitrary push message distribution, the attacker can target a large number of players simultaneously. A malicious attacker abusing this would have been able to reliably execute a payload of up to 1.3MiB of shellcode on every online player's machine within seconds
    *   **Game crashes:** An attacker can cause a game crash by triggering an out-of-bounds read with an extremely large size.
    *   **Save Corruption (fixed):** Although fixed, the exploit also initially allowed save corruption.

*   **Attack Vectors:**
    *   **Matchmaking Push Requests:** The primary attack vector involves manipulating matchmaking push requests containing `NRSessionSearchResult` information. These messages can be triggered through various in-game scenarios: summons, dark spirit invasions, covenant joining, and arena matches.
    *   **`RequestSendMessageToPlayers`:** This request is used to send arbitrary push messages to players, making it possible to target any player as long as their player ID is known.

*   **Required Attacker Capabilities/Position:**
    *   **Network Access:** The attacker needs to be able to send requests to the game server, which implies being online in the game.
    *   **Player ID (For Specific Targeting):** To target a specific player, the attacker needs to know their player ID.
    *   **Ability to Craft Malicious Packets:** The attacker must be able to craft packets containing malicious `NRSessionSearchResult` data and specific sizes.

**Additional Information:**

*   **Affected Games:** The vulnerability affected Dark Souls 1 PTDE, Dark Souls Remastered, Dark Souls 2 (including Scholar), Dark Souls 3 (up to version 1.15.0), and Sekiro (though it was not triggerable in Sekiro). It was also present in a closed network test for Elden Ring, but the vulnerability was patched in the release version.
*   **Patch:** Dark Souls III update 1.15.1 fixed both CVE-2022-24125 and CVE-2022-24126, along with a variety of other security issues.
*   **Exploitation Details:** The attacker exploits the `DLMemoryInputStream` object's structure and data size field to achieve arbitrary code redirection. The provided proof of concept uses a chain of three virtual calls to achieve RCE in Dark Souls III.
*   **Misconception:** The exploit is not a peer-to-peer networking exploit, but rather is related to the matchmaking server, making it more severe.

This content provides significantly more detail about the technical aspects of the vulnerabilities than the typical CVE description. It includes the specific code gadgets and memory structures involved in the exploit, as well as the means of distribution.