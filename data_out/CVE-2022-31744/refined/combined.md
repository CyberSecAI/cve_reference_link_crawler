=== Content from bugzilla.mozilla.org_e13eebc1_20250108_124344.html ===


![](/static/v20241211.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1757604)
* [XML](/show_bug.cgi?ctype=xml&id=1757604)

Closed
[Bug 1757604](/show_bug.cgi?id=1757604)
(CVE-2022-31744)

Opened 3 years ago
Closed 3 years ago

# Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken

## Categories

### (Core :: DOM: Security, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
▾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

60 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

101 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr91 | [102+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=102%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified) |
| firefox100 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=wontfix) |
| firefox101 | [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr91 | 102+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox100 |  | wontfix |
| firefox101 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: Gijs, Assigned: emilio)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

25 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input"), [1489875](/show_bug.cgi?id=1489875 "RESOLVED DUPLICATE - Decentraleyes WebExtension stopped working"), [1489882](/show_bug.cgi?id=1489882 "RESOLVED WONTFIX - Beta and Nightly completely break Decentraleyes by preventing redirections to Web Accessible Resources")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1757604&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1757604)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1767358](/show_bug.cgi?id=1767358 "RESOLVED FIXED - perma comm/mail/base/test/performance/browser_preferences_usage.js | helpers.private_mime_types_file should not be accessed more than 40 times. - 104 <= 40")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-other, sec-moderate, Whiteboard: [domsecurity-active][post-critsmash-triage][adv-main101+][adv-esr91.11+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2022-31744

[Keywords:](/describekeywords.cgi)

[csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[domsecurity-active][post-critsmash-triage][adv-main101+][adv-esr91.11+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Bug 1757604 - Make content-type guess override content-type hint for JAR channels. r=Gijs](/attachment.cgi?id=9266054)  [3 years ago](#c4)  [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9266054&action=edit) | [Review](/attachment.cgi?id=9266054) |
| --- | --- | --- |
| [Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs](/attachment.cgi?id=9274452)  [3 years ago](#c11)  [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr91+](#c30 "3 years ago") | [Details](/attachment.cgi?id=9274452&action=edit) | [Review](/attachment.cgi?id=9274452) |
| [advisory.txt](/attachment.cgi?id=9278353)  [3 years ago](#c25)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   212 bytes, text/plain |  | [Details](/attachment.cgi?id=9278353&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1757604#c0)• 3 years ago |
|  | |

+++ This bug was initially created as a clone of [Bug #1460538](/show_bug.cgi?id=1460538 "RESOLVED FIXED") +++

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:60.0) Gecko/20100101 Firefox/60.0

Build ID: 20180503143129

Steps to reproduce:

By using the reflected URL in some special resource URIs it is possible to inject CSS and bypass CSP: <http://demo.vwzq.net/php/ff_chrome.php>

Stylesheet injection is not XSS, but still harmful.

Content:

<link rel="stylesheet" href="chrome://browser/content/places/?'*{}*{color:red}">

Actual results:

The reflected stylesheet is interpreted bypassing the strict CSP policy.

Expected results:

I guess the mitigation here should be to avoid reflecting any user content, or at least avoid loading directories.

---

This appears to still be broken.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1757604#c1)• 3 years ago |
|  | |

So the fix from [bug 1460538](/show_bug.cgi?id=1460538 "RESOLVED FIXED") [tried to use the content type in comparison with the request type](https://hg.mozilla.org/mozilla-central/rev/64696387b4b0) to block requests where the two didn't match.

This didn't work because in a packaged build, we hit `Loader::LoadSheet` which [explicitly sets the content type "hint" to `text/css`](https://searchfox.org/mozilla-central/rev/8f42809e51cb07aa4f5739932a06d14581e9dd4a/layout/style/Loader.cpp#1500-1502), so then the content type is what you'd expect for stylesheets, and the load passes, even though the loaded URL really *isn't* a `text/css` document.

In a non-packaged local build, it turns out we don't hit this code path because we strip the query params in `file` URLs so the exploit doesn't work anyway.

We could work around this by having the nsJARChannel code explicitly check for directory entries but that feels very ugly. Emilio, do you know why the stylesheet code is forcing the mimetype here, and/or if there is some other getter we should be using to get a "real" content type? Blame on those lines is nearly 20 years old so I'm not sure where to go from there. :-(

As noted in my last comments in [bug 1460538](/show_bug.cgi?id=1460538 "RESOLVED FIXED"), the change in [bug 1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input") then also didn't work because it changes the HTML output but not the indexed stream - to fix things that way we need to change <https://searchfox.org/mozilla-central/rev/8f42809e51cb07aa4f5739932a06d14581e9dd4a/netwerk/base/nsDirectoryIndexStream.cpp#100,102-103> to strip query params for `file` and/or `jar` and/or `chrome` (or rather, only include it for... well, for what, exactly?)

Flags: needinfo?(emilio)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1757604#c2)• 3 years ago |
|  | |

We also escape HTML-entities in the `chrome://browser/content/places/?` reflection, but not CSS-relevant characters. That's also something we could change.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1757604#c3)• 3 years ago |
|  | |

So I'm missing some context because I'm not cc'd on those bugs mentioned in [comment 1](/show_bug.cgi?id=1757604#c1 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"), but IIUC the issue is that directory entries have the whole URI including query string in the response, like:

```
300: jar:file:///home/emilio/firefox/browser/omni.ja!/chrome/browser/content/browser/places/?fwaefwafwafwafwaefw
200: filename content-length last-modified file-type
201: bookmarkProperties.js 18045 Thu,%2031%20Dec%202009%2023:00:00%20GMT FILE
201: bookmarkProperties.xhtml 7644 Thu,%2031%20Dec%202009%2023:00:00%20GMT FILE
...

```

And that causes a CSS injection if interpreted as a stylesheet. My question is, why is the load not failing before? For example trying to `fetch("chrome://browser/content/places/")` fails with a `SecurityError` which comes from [here](https://searchfox.org/mozilla-central/rev/292d17c13daa61016fd082e2337297091d53a015/caps/nsScriptSecurityManager.cpp#897), is any similar check not working?

Anyways, [bug 120789](/show_bug.cgi?id=120789 "RESOLVED FIXED - checking for text/css sheets should only happen for http with a type header") is what introduced that code. From taking a look, if the `nsIChannel` overrides the content-type post-response, we'd reject the load [here](https://searchfox.org/mozilla-central/rev/292d17c13daa61016fd082e2337297091d53a015/layout/style/Loader.cpp#772-800). However it seems the JAR channel is intentionally always respecting the content type set as a hint:

<https://searchfox.org/mozilla-central/rev/292d17c13daa61016fd082e2337297091d53a015/modules/libjar/nsJARChannel.cpp#767-768>

So in terms of potential fixes, the easiest one is to perhaps use the content-type hint only if the guess is unknown?

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1757604#c4)• 3 years ago |
|  | |

Attached file
[Bug 1757604 - Make content-type guess override content-type hint for JAR channels. r=Gijs](attachment.cgi?id=9266054) (obsolete)
— [Details](attachment.cgi?id=9266054&action=edit)

Make the script loader fail to load non-JS internal loads too, like the

CSS loader does for all cross-origin files.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1757604#c5)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1757604&comment_id=15797426 "1 revision") |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #3](/show_bug.cgi?id=1757604#c3 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))

> So I'm missing some context because I'm not cc'd on those bugs mentioned in [comment 1](/show_bug.cgi?id=1757604#c1 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"),

Gah, sorry, copied you in.

> but IIUC the issue is that directory entries have the whole URI including query string in the response, like:
>
> ```
> 300: jar:file:///home/emilio/firefox/browser/omni.ja!/chrome/browser/content/browser/places/?fwaefwafwafwafwaefw
> 200: filename content-length last-modified file-type
> 201: bookmarkProperties.js 18045 Thu,%2031%20Dec%202009%2023:00:00%20GMT FILE
> 201: bookmarkProperties.xhtml 7644 Thu,%2031%20Dec%202009%2023:00:00%20GMT FILE
> ...
>
> ```
>
> And that causes a CSS injection if interpreted as a stylesheet. My question is, why is the load not failing before? For example trying to `fetch("chrome://browser/content/places/")` fails with a `SecurityError` which comes from [here](https://searchfox.org/mozilla-central/rev/292d17c13daa61016fd082e2337297091d53a015/caps/nsScriptSecurityManager.cpp#897), is any similar check not working?

I'm confused. My understanding is that style and script loads are allowed to be cross-origin, whereas `fetch` needs CORS support for that. As a result, I don't think the two are the same.

A lot of the chrome/toolkit packaged styling and script can be referenced from the web because it's marked as `contentaccessible`. We should fix that separately but it's not really the root issue here (ie as long as any web-reference-able chrome/resource URI would exist, any of them would facilitate this attack).

> Anyways, [bug 120789](/show_bug.cgi?id=120789 "RESOLVED FIXED - checking for text/css sheets should only happen for http with a type header") is what introduced that code. From taking a look, if the `nsIChannel` overrides the content-type post-response, we'd reject the load [here](https://searchfox.org/mozilla-central/rev/292d17c13daa61016fd082e2337297091d53a015/layout/style/Loader.cpp#772-800). However it seems the JAR channel is intentionally always respecting the content type set as a hint:
>
> <https://searchfox.org/mozilla-central/rev/292d17c13daa61016fd082e2337297091d53a015/modules/libjar/nsJARChannel.cpp#767-768>
>
> So in terms of potential fixes, the easiest one is to perhaps use the content-type hint only if the guess is unknown?

Makes sense to me.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1757604#c6)• 3 years ago |
|  | |

Passing the assignee to Emilio as he's put up a patch - thank you!

Assignee: gijskruitbosch+bugs → emilio

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1757604#c7)• 3 years ago |
|  | |

@emilio: Can you try and nudge this along? It seems (almost) done?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1757604#c8)• 3 years ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #7](/show_bug.cgi?id=1757604#c7 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))

> @emilio: Can you try and nudge this along? It seems (almost) done?

Flags: needinfo?(emilio)

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a4915594_363267)• 3 years ago |

Status: NEW → ASSIGNEDPriority: -- → P3Whiteboard: [domsecurity-backlog1] → [domsecurity-active]

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1757604#c9)• 3 years ago |
|  | |

I would lean towards simply making it impossible to load those stylesheets except when they were inserted by privileged callers.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1757604#c10)• 3 years ago |
|  | |

(In reply to Kris Maglione [:kmag] from [comment #9](/show_bug.cgi?id=1757604#c9 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))

> I would lean towards simply making it impossible to load those stylesheets except when they were inserted by privileged callers.

This would effectively "undo" `contentaccessible`, right? And would need a carve-out for some `about` pages in addition to the system principal case...

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1757604#c11)• 3 years ago |
|  | |

Attached file
[Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs](attachment.cgi?id=9274452)
— [Details](attachment.cgi?id=9274452&action=edit)

That is, treat it as a hint if called before open, and as an override if

called after. Override the hint on open.

This is a less invasive change that is green on try and also fixes the

issue.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a5087337_546716)• 3 years ago |

Flags: needinfo?(emilio)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1757604#c12)• 3 years ago |
|  | |

Make content-type on JAR channels behave the same as HTTP channels. r=Gijs

<https://hg.mozilla.org/integration/autoland/rev/6192634b7401c3d4f1ee8abfe310bd68dcd5ac1f>

<https://hg.mozilla.org/mozilla-central/rev/6192634b7401>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 3 years ago
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 101 Branch

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a5248743_600971)• 3 years ago |

[Attachment #9266054](/attachment.cgi?id=9266054&action=edit "Bug 1757604 - Make content-type guess override content-type hint for JAR channels. r=Gijs") -
Attachment is obsolete: true

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1757604#c13)• 3 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1757604#c10 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))

> (In reply to Kris Maglione [:kmag] from [comment #9](/show_bug.cgi?id=1757604#c9 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))
>
> > I would lean towards simply making it impossible to load those stylesheets except when they were inserted by privileged callers.
>
> This would effectively "undo" `contentaccessible`, right? And would need a carve-out for some `about` pages in addition to the system principal case...

Yes, for a large part. But I think we probably want that, anyway. Allowing for `about:` pages would be easy. I mostly just don't think that content should be directly injectable by web content. Especially now that we have the infrastructure to make it injectable by a privileged caller without allowing web content.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a5471892_75935)• 3 years ago |

[status-firefox100](/buglist.cgi?f1=cf_status_firefox100&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox100&o1=equals&v1=wontfix)
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=affected)
[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected)
[tracking-firefox101](/buglist.cgi?f1=cf_tracking_firefox101&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox101&o1=equals&v1=%2B)
[tracking-firefox102](/buglist.cgi?f1=cf_tracking_firefox102&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B)
[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
--- → [101+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=101%2B)Target Milestone: 101 Branch → 102 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1757604#c14)• 3 years ago |
|  | |

Changing the priority to P1 as the bug is tracked by a release manager for the current beta.

See [Triage for Bugzilla](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html#automatic-bug-updates) for more information.

If you disagree, please discuss with a release manager.

Priority: P3 → P1

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1757604#c15)• 3 years ago |
|  | |

The patch landed in nightly and beta is affected.

:emilio, is this bug important enough to require an uplift?

If not please set `status_beta` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1757604#c16)• 3 years ago |
|  | |

Gijs, your call.

Flags: needinfo?(gijskruitbosch+bugs)Flags: needinfo?(fbraun)Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1757604#c17)• 3 years ago |
|  | |

Wanted to write Gijs / Freddy, d'oh :-)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1757604#c18)• 3 years ago |
|  | |

Sure, if it applies cleanly. Why not?

Flags: needinfo?(fbraun)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1757604#c19)• 3 years ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #18](/show_bug.cgi?id=1757604#c18 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))

> Sure, if it applies cleanly. Why not?

I think my only reservation is risk. I don't feel like I have a great understanding of potential fall-out, e.g. for add-ons. But it's super early in beta and we're likely not going to find out about fallout on nightly anyway - and on the flip side, this is fixing a publicly-disclosed issue, so on the whole uplifting seems like a good idea to me.

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(emilio)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1757604#c20)• 3 years ago |
|  | |

(In reply to Kris Maglione [:kmag] from [comment #13](/show_bug.cgi?id=1757604#c13 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))

> (In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1757604#c10 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))
>
> > (In reply to Kris Maglione [:kmag] from [comment #9](/show_bug.cgi?id=1757604#c9 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))
> >
> > > I would lean towards simply making it impossible to load those stylesheets except when they were inserted by privileged callers.
> >
> > This would effectively "undo" `contentaccessible`, right? And would need a carve-out for some `about` pages in addition to the system principal case...
>
> Yes, for a large part. But I think we probably want that, anyway. Allowing for `about:` pages would be easy. I mostly just don't think that content should be directly injectable by web content. Especially now that we have the infrastructure to make it injectable by a privileged caller without allowing web content.

OK. I think there are other reasons we want this (e.g. [bug 1530499](/show_bug.cgi?id=1530499 "NEW")). I'll follow up there.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1757604#c21)• 3 years ago |
|  | |

Comment on [attachment 9274452](/attachment.cgi?id=9274452 "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs") [[details]](/attachment.cgi?id=9274452&action=edit "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs")

[Bug 1757604](/show_bug.cgi?id=1757604 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken") - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs

### Beta/Release Uplift Approval Request

* **User impact if declined**: see [comment 19](/show_bug.cgi?id=1757604#c19 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"). I don't think risk is too big fwiw. We already heavily restrict add-on script extensions and so on.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: Load <https://demo.vwzq.net/php/ff_chrome.php>, there should be no red.
* **List of other uplifts needed**: none
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: See above.
* **String changes made/needed**: none
* **Is Android affected?**: Unknown
Flags: needinfo?(emilio)
[Attachment #9274452](/attachment.cgi?id=9274452&action=edit "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs") -
Flags: approval-mozilla-beta?

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a5595639_546716)• 3 years ago |

Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1757604#c22)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1757604&comment_id=15885825 "1 revision") |
|  | |

Comment on [attachment 9274452](/attachment.cgi?id=9274452 "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs") [[details]](/attachment.cgi?id=9274452&action=edit "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs")

[Bug 1757604](/show_bug.cgi?id=1757604 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken") - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs

Fun fact, this actually landed on 101 prior to the merge. And I was able to confirm that 101.0b2 shows the expected rendering for the testcase referenced in the approval request.

[Attachment #9274452](/attachment.cgi?id=9274452&action=edit "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a5599584_75935)• 3 years ago |

[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed)
[status-firefox102](/buglist.cgi?f1=cf_status_firefox102&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox102&o1=equals&v1=fixed) → ---
[tracking-firefox102](/buglist.cgi?f1=cf_tracking_firefox102&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox102&o1=equals&v1=%2B) → ---Target Milestone: 102 Branch → 101 Branch

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a6295354_553429)• 3 years ago |

Whiteboard: [domsecurity-active] → [domsecurity-active][post-critsmash-triage]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a6314176_75935)• 3 years ago |

[tracking-firefox-esr91](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=isnotempty):
[101+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=101%2B) → [102+](/buglist.cgi?f1=cf_tracking_firefox_esr91&o1=equals&v1=102%2B)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1757604#c23)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1757604&comment_id=15906173 "1 revision") |
|  | |

I've reproduced this bug using the STR from [comment 21](/show_bug.cgi?id=1757604#c21 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"), on an affected build, Firefox 100.0.1 running Win 10 x64.

The issue is verified as fixed on latest Beta 101.0b8, across platforms: Win 10 x64, macOS 11 and Ubuntu 18.04 x64.

Status: RESOLVED → VERIFIED
[status-firefox101](/buglist.cgi?f1=cf_status_firefox101&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox101&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a7341075_578488)• 3 years ago |

Whiteboard: [domsecurity-active][post-critsmash-triage] → [domsecurity-active][post-critsmash-triage][adv-main101+]

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1757604#c24)• 3 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #1](/show_bug.cgi?id=1757604#c1 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken"))

> As noted in my last comments in [bug 1460538](/show_bug.cgi?id=1460538 "RESOLVED FIXED"), the change in [bug 1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input") then also didn't work because it changes the HTML output but not the indexed stream - to fix things that way we need to change <https://searchfox.org/mozilla-central/rev/8f42809e51cb07aa4f5739932a06d14581e9dd4a/netwerk/base/nsDirectoryIndexStream.cpp#100,102-103> to strip query params for `file` and/or `jar` and/or `chrome` (or rather, only include it for... well, for what, exactly?)

I'd like a second opinion on whether it's still useful to try and fix `nsDirectoryIndexStream` so it doesn't include query/hash info in the echo'd content? I'm thinking yes, as a belt + suspenders kinda thing... Freddy, does that seem reasonable?

Flags: needinfo?(fbraun)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1757604#c25)• 3 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9278353)
— [Details](attachment.cgi?id=9278353&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a7427793_578488)• 3 years ago |

Alias: CVE-2022-31744

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1757604#c26)• 3 years ago |
|  | |

Yeah, I believe we should try and improve upon [bug 1488061](/show_bug.cgi?id=1488061 "VERIFIED FIXED - Directory indices shouldn't just echo all URL input") and also strip the stuff from the `nsDirectoryIndexStream`. Should be simple enough and likely worth the effort (before someone finds another kind of injection that isn't script or style :)).

Flags: needinfo?(fbraun)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1757604#c27)• 3 years ago |
|  | |

Filed [bug 1771774](/show_bug.cgi?id=1771774 "VERIFIED FIXED - Directory indices plaintext serialization (nsDirectoryIndexStream) shouldn't just echo all URL input") for the directory stream improvement.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1757604#c28)• 3 years ago |
|  | |

Is this ready for an ESR91 uplift? It grafts cleanly.

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1757604#c29)• 3 years ago |
|  | |

Comment on [attachment 9274452](/attachment.cgi?id=9274452 "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs") [[details]](/attachment.cgi?id=9274452&action=edit "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs")

[Bug 1757604](/show_bug.cgi?id=1757604 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken") - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: simple enough sec-moderate
* **User impact if declined**: see [comment 0](/show_bug.cgi?id=1757604#c0 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken")
* **Fix Landed on Version**: 101
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: It behaves the same as HTTP channels, so shouldn't cause much trouble.
Flags: needinfo?(emilio)
[Attachment #9274452](/attachment.cgi?id=9274452&action=edit "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs") -
Flags: approval-mozilla-esr91?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1757604#c30)• 3 years ago |
|  | |

Comment on [attachment 9274452](/attachment.cgi?id=9274452 "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs") [[details]](/attachment.cgi?id=9274452&action=edit "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs")

[Bug 1757604](/show_bug.cgi?id=1757604 "VERIFIED FIXED - Stylesheet's CSP bypass via reflected URL in chrome:// directories still broken") - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs

Approved for 91.11esr.

[Attachment #9274452](/attachment.cgi?id=9274452&action=edit "Bug 1757604 - Make content-type on JAR channels behave the same as HTTP channels. r=Gijs") -
Flags: approval-mozilla-esr91? → approval-mozilla-esr91+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1757604#c31)• 3 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr91/rev/dddc25fd9e03>

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1757604#c32)• 3 years ago |
|  | |

This is also verified as fixed on 91.11.0esr across platforms: Win 10 x64, macOS 11 and Ubuntu 22.04 x64.

[status-firefox-esr91](/buglist.cgi?f1=cf_status_firefox_esr91&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr91&o1=equals&v1=verified)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a9934207_578488)• 3 years ago |

Whiteboard: [domsecurity-active][post-critsmash-triage][adv-main101+] → [domsecurity-active][post-critsmash-triage][adv-main101+][adv-esr91.11+]

|  | [Geoff Lankow (:darktrojan)](/user_profile?user_id=158464) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a11352879_158464)• 2 years ago |

Regressions: [1767358](/show_bug.cgi?id=1767358 "RESOLVED FIXED - perma comm/mail/base/test/performance/browser_preferences_usage.js | helpers.private_mime_types_file should not be accessed more than 40 times. - 104 <= 40")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1757604#a27773025_1689)• 2 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1757604&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_b68de4a0_20250108_124344.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-20

## Security Vulnerabilities fixed in Firefox 101

Announced
May 31, 2022
Impact
high
Products
Firefox
Fixed in

* Firefox 101

#### [#CVE-2022-31736: Cross-Origin resource's length leaked](#CVE-2022-31736)

Reporter
Luan Herrera
Impact
high
##### Description

A malicious website could have learned the size of a cross-origin resource that supported Range requests.

##### References

* [Bug 1735923](https://bugzilla.mozilla.org/show_bug.cgi?id=1735923)

#### [#CVE-2022-31737: Heap buffer overflow in WebGL](#CVE-2022-31737)

Reporter
Atte Kettunen
Impact
high
##### Description

A malicious webpage could have caused an out-of-bounds write in WebGL, leading to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1743767](https://bugzilla.mozilla.org/show_bug.cgi?id=1743767)

#### [#CVE-2022-31738: Browser window spoof using fullscreen mode](#CVE-2022-31738)

Reporter
Irvan Kurniawan
Impact
high
##### Description

When exiting fullscreen mode, an iframe could have confused the browser about the current state of fullscreen, resulting in potential user confusion or spoofing attacks.

##### References

* [Bug 1756388](https://bugzilla.mozilla.org/show_bug.cgi?id=1756388)

#### [#CVE-2022-31739: Attacker-influenced path traversal when saving downloaded files](#CVE-2022-31739)

Reporter
Chaobin Zhang
Impact
high
##### Description

When downloading files on Windows, the % character was not escaped, which could have lead to a download incorrectly being saved to attacker-influenced paths that used variables such as %HOMEPATH% or %APPDATA%.
*This bug only affects Firefox for Windows. Other operating systems are unaffected.*

##### References

* [Bug 1765049](https://bugzilla.mozilla.org/show_bug.cgi?id=1765049)

#### [#CVE-2022-31740: Register allocation problem in WASM on arm64](#CVE-2022-31740)

Reporter
Gary Kwong
Impact
high
##### Description

On arm64, WASM code could have resulted in incorrect assembly generation leading to a register allocation problem, and a potentially exploitable crash.

##### References

* [Bug 1766806](https://bugzilla.mozilla.org/show_bug.cgi?id=1766806)

#### [#CVE-2022-31741: Uninitialized variable leads to invalid memory read](#CVE-2022-31741)

Reporter
Cybeats PSI Team
Impact
high
##### Description

A crafted CMS message could have been processed incorrectly, leading to an invalid memory read, and potentially further memory corruption.

##### References

* [Bug 1767590](https://bugzilla.mozilla.org/show_bug.cgi?id=1767590)

#### [#CVE-2022-31742: Querying a WebAuthn token with a large number of allowCredential entries may have leaked cross-origin information](#CVE-2022-31742)

Reporter
Michal
Impact
moderate
##### Description

An attacker could have exploited a timing attack by sending a large number of allowCredential entries and detecting the difference between invalid key handles and cross-origin key handles. This could have led to cross-origin account linking in violation of WebAuthn goals.

##### References

* [Bug 1730434](https://bugzilla.mozilla.org/show_bug.cgi?id=1730434)

#### [#CVE-2022-31743: HTML Parsing incorrectly ended HTML comments prematurely](#CVE-2022-31743)

Reporter
Linus Särud
Impact
moderate
##### Description

Firefox's HTML parser did not correctly interpret HTML comment tags, resulting in an incongruity with other browsers. This could have been used to escape HTML comments on pages that put user-controlled data in them.

##### References

* [Bug 1747388](https://bugzilla.mozilla.org/show_bug.cgi?id=1747388)

#### [#CVE-2022-31744: CSP bypass enabling stylesheet injection](#CVE-2022-31744)

Reporter
Gertjan
Impact
moderate
##### Description

An attacker could have injected CSS into stylesheets accessible via internal URIs, such as resource:, and in doing so bypass a page's Content Security Policy.

##### References

* [Bug 1757604](https://bugzilla.mozilla.org/show_bug.cgi?id=1757604)

#### [#CVE-2022-31745: Incorrect Assertion caused by unoptimized array shift operations](#CVE-2022-31745)

Reporter
Lukas Bernhard
Impact
moderate
##### Description

If array shift operations are not used, the Garbage Collector may have become confused about valid objects.

##### References

* [Bug 1760944](https://bugzilla.mozilla.org/show_bug.cgi?id=1760944)

#### [#CVE-2022-1919: Memory Corruption when manipulating webp images](#CVE-2022-1919)

Reporter
Irvan Kurniawan
Impact
low
##### Description

An attacker could have caused an uninitialized variable on the stack to be mistakenly freed, causing a potentially exploitable crash.

##### References

* [Bug 1761275](https://bugzilla.mozilla.org/show_bug.cgi?id=1761275)

#### [#CVE-2022-31747: Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](#CVE-2022-31747)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Andrew McCreight, Nicolas B. Pierron, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 100 and Firefox ESR 91.9. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 101 and Firefox ESR 91.10](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1760765%2C1765610%2C1766283%2C1767365%2C1768559%2C1768734)

#### [#CVE-2022-31748: Memory safety bugs fixed in Firefox 101](#CVE-2022-31748)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Gabriele Svelto, Timothy Nikkel, Randell Jesup, Jon Coppeard, and the Mozilla Fuzzing Team reported memory safety bugs present in Firefox 100. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 101](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1713773%2C1762201%2C1762469%2C1762770%2C1764878%2C1765226%2C1765782%2C1765973%2C1767177%2C1767181%2C1768232%2C1768251%2C1769869)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_5284e496_20250108_124345.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-25

## Security Vulnerabilities fixed in Firefox ESR 91.11

Announced
June 28, 2022
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 91.11

*Note*: While [Bug 1771084](https://bugzilla.mozilla.org/show_bug.cgi?id=1771084) does not represent a specific vulnerability that was fixed, we recommend anyone rebasing patches to include it. 102 branch: Patch [1](https://hg.mozilla.org/releases/mozilla-beta/rev/82e3067ad2e7) and [2](https://hg.mozilla.org/releases/mozilla-beta/rev/6e4639dc3614). 91 Branch: Patch [1](https://hg.mozilla.org/releases/mozilla-esr91/rev/72bca7a337e4) and [2](https://hg.mozilla.org/releases/mozilla-esr91/rev/befef01949f2) (Despite saying Parts 2 and 3, there is no Part 1)

#### [#CVE-2022-34479: A popup window could be resized in a way to overlay the address bar with web content](#CVE-2022-34479)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A malicious website that could create a popup could have resized the popup to overlay the address bar with its own content, resulting in potential user confusion or spoofing attacks.
*This bug only affects Firefox for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1745595](https://bugzilla.mozilla.org/show_bug.cgi?id=1745595)

#### [#CVE-2022-34470: Use-after-free in nsSHistory](#CVE-2022-34470)

Reporter
Armin Ebert
Impact
high
##### Description

Session history navigations may have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1765951](https://bugzilla.mozilla.org/show_bug.cgi?id=1765951)

#### [#CVE-2022-34468: CSP sandbox header without "allow-scripts" can be bypassed via retargeted javascript: URI](#CVE-2022-34468)

Reporter
Armin Ebert
Impact
high
##### Description

An iframe that was not permitted to run scripts could do so if the user clicked on a `javascript:` link.

##### References

* [Bug 1768537](https://bugzilla.mozilla.org/show_bug.cgi?id=1768537)

#### [#CVE-2022-34481: Potential integer overflow in ReplaceElementsAt](#CVE-2022-34481)

Reporter
Ronald Crane
Impact
moderate
##### Description

In the `nsTArray_Impl::ReplaceElementsAt()` function, an integer overflow could have occurred when the number of elements to replace was too large for the container.

##### References

* [Bug 1497246](https://bugzilla.mozilla.org/show_bug.cgi?id=1497246)

#### [#CVE-2022-31744: CSP bypass enabling stylesheet injection](#CVE-2022-31744)

Reporter
Gertjan
Impact
moderate
##### Description

An attacker could have injected CSS into stylesheets accessible via internal URIs, such as resource:, and in doing so bypass a page's Content Security Policy.

##### References

* [Bug 1757604](https://bugzilla.mozilla.org/show_bug.cgi?id=1757604)

#### [#CVE-2022-34472: Unavailable PAC file resulted in OCSP requests being blocked](#CVE-2022-34472)

Reporter
Laurent Bigonville
Impact
moderate
##### Description

If there was a PAC URL set and the server that hosts the PAC was not reachable, OCSP requests would have been blocked, resulting in incorrect error pages being shown.

##### References

* [Bug 1770123](https://bugzilla.mozilla.org/show_bug.cgi?id=1770123)

#### [#CVE-2022-34478: Microsoft protocols can be attacked if a user accepts a prompt](#CVE-2022-34478)

Reporter
Gijs
Impact
moderate
##### Description

The `ms-msdt`, `search`, and `search-ms` protocols deliver content to Microsoft applications, bypassing the browser, when a user accepts a prompt. These applications have had known vulnerabilities, exploited in the wild (although we know of none exploited through Firefox), so in this release Firefox has blocked these protocols from prompting the user to open them.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1773717](https://bugzilla.mozilla.org/show_bug.cgi?id=1773717)

#### [#CVE-2022-2200: Undesired attributes could be set as part of prototype pollution](#CVE-2022-2200)

Reporter
Manfred Paul via Trend Micro's Zero Day Initiative
Impact
moderate
##### Description

If an object prototype was corrupted by an attacker, they would have been able to set undesired attributes on a JavaScript object, leading to privileged code execution.

##### References

* [Bug 1771381](https://bugzilla.mozilla.org/show_bug.cgi?id=1771381)

#### [#CVE-2022-34484: Memory safety bugs fixed in Firefox 102 and Firefox ESR 91.11](#CVE-2022-34484)

Reporter
Mozilla developers and community
Impact
high
##### Description

The Mozilla Fuzzing Team reported potential vulnerabilities present in Firefox 101 and Firefox ESR 91.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 102 and Firefox ESR 91.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763634%2C1772651)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_da77736f_20250108_124346.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2022-26

## Security Vulnerabilities fixed in Thunderbird 91.11 and Thunderbird 102

Announced
June 28, 2022
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 102
* Thunderbird 91.11

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*
*Note*: While [Bug 1771084](https://bugzilla.mozilla.org/show_bug.cgi?id=1771084) does not represent a specific vulnerability that was fixed, we recommend anyone rebasing patches to include it. 102 branch: Patch [1](https://hg.mozilla.org/releases/mozilla-beta/rev/82e3067ad2e7) and [2](https://hg.mozilla.org/releases/mozilla-beta/rev/6e4639dc3614). 91 Branch: Patch [1](https://hg.mozilla.org/releases/mozilla-esr91/rev/72bca7a337e4) and [2](https://hg.mozilla.org/releases/mozilla-esr91/rev/befef01949f2) (Despite saying Parts 2 and 3, there is no Part 1)

#### [#CVE-2022-34479: A popup window could be resized in a way to overlay the address bar with web content](#CVE-2022-34479)

Reporter
Irvan Kurniawan
Impact
high
##### Description

A malicious website that could create a popup could have resized the popup to overlay the address bar with its own content, resulting in potential user confusion or spoofing attacks.
*This bug only affects Thunderbird for Linux. Other operating systems are unaffected.*

##### References

* [Bug 1745595](https://bugzilla.mozilla.org/show_bug.cgi?id=1745595)

#### [#CVE-2022-34470: Use-after-free in nsSHistory](#CVE-2022-34470)

Reporter
Armin Ebert
Impact
high
##### Description

Session history navigations may have led to a use-after-free and potentially exploitable crash.

##### References

* [Bug 1765951](https://bugzilla.mozilla.org/show_bug.cgi?id=1765951)

#### [#CVE-2022-34468: CSP sandbox header without "allow-scripts" can be bypassed via retargeted javascript: URI](#CVE-2022-34468)

Reporter
Armin Ebert
Impact
high
##### Description

An iframe that was not permitted to run scripts could do so if the user clicked on a `javascript:` link.

##### References

* [Bug 1768537](https://bugzilla.mozilla.org/show_bug.cgi?id=1768537)

#### [#CVE-2022-2226: An email with a mismatching OpenPGP signature date was accepted as valid](#CVE-2022-2226)

Reporter
Nickolay Olshevsky
Impact
moderate
##### Description

An OpenPGP digital signature includes information about the date when the signature was created. When displaying an email that contains a digital signature, the email's date will be shown. If the dates were different, then Thunderbird didn't report the email as having an invalid signature. If an attacker performed a replay attack, in which an old email with old contents are resent at a later time, it could lead the victim to believe that the statements in the email are current. Fixed versions of Thunderbird will require that the signature's date roughly matches the displayed date of the email.

##### References

* [Bug 1775441](https://bugzilla.mozilla.org/show_bug.cgi?id=1775441)

#### [#CVE-2022-34481: Potential integer overflow in ReplaceElementsAt](#CVE-2022-34481)

Reporter
Ronald Crane
Impact
moderate
##### Description

In the `nsTArray_Impl::ReplaceElementsAt()` function, an integer overflow could have occurred when the number of elements to replace was too large for the container.

##### References

* [Bug 1497246](https://bugzilla.mozilla.org/show_bug.cgi?id=1497246)

#### [#CVE-2022-31744: CSP bypass enabling stylesheet injection](#CVE-2022-31744)

Reporter
Gertjan
Impact
moderate
##### Description

An attacker could have injected CSS into stylesheets accessible via internal URIs, such as resource:, and in doing so bypass a page's Content Security Policy.

##### References

* [Bug 1757604](https://bugzilla.mozilla.org/show_bug.cgi?id=1757604)

#### [#CVE-2022-34472: Unavailable PAC file resulted in OCSP requests being blocked](#CVE-2022-34472)

Reporter
Laurent Bigonville
Impact
moderate
##### Description

If there was a PAC URL set and the server that hosts the PAC was not reachable, OCSP requests would have been blocked, resulting in incorrect error pages being shown.

##### References

* [Bug 1770123](https://bugzilla.mozilla.org/show_bug.cgi?id=1770123)

#### [#CVE-2022-34478: Microsoft protocols can be attacked if a user accepts a prompt](#CVE-2022-34478)

Reporter
Gijs
Impact
moderate
##### Description

The `ms-msdt`, `search`, and `search-ms` protocols deliver content to Microsoft applications, bypassing the browser, when a user accepts a prompt. These applications have had known vulnerabilities, exploited in the wild (although we know of none exploited through Thunderbird), so in this release Thunderbird has blocked these protocols from prompting the user to open them.
*This bug only affects Thunderbird on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1773717](https://bugzilla.mozilla.org/show_bug.cgi?id=1773717)

#### [#CVE-2022-2200: Undesired attributes could be set as part of prototype pollution](#CVE-2022-2200)

Reporter
Manfred Paul via Trend Micro's Zero Day Initiative
Impact
moderate
##### Description

If an object prototype was corrupted by an attacker, they would have been able to set undesired attributes on a JavaScript object, leading to privileged code execution.

##### References

* [Bug 1771381](https://bugzilla.mozilla.org/show_bug.cgi?id=1771381)

#### [#CVE-2022-34484: Memory safety bugs fixed in Thunderbird 91.11 and Thunderbird 102](#CVE-2022-34484)

Reporter
Mozilla developers and community
Impact
high
##### Description

The Mozilla Fuzzing Team reported potential vulnerabilities present in Thunderbird 91.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 91.11 and Thunderbird 102](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1763634%2C1772651)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


