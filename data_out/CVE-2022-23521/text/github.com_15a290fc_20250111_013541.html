
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgit%2Fgit%2Fcommit%2F508386c6c5857b4faa2c3e491f422c98cc69ae76)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgit%2Fgit%2Fcommit%2F508386c6c5857b4faa2c3e491f422c98cc69ae76)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=git%2Fgit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[git](/git)
/
**[git](/git/git)**
Public

* [Notifications](/login?return_to=%2Fgit%2Fgit) You must be signed in to change notification settings
* [Fork
  25.8k](/login?return_to=%2Fgit%2Fgit)
* [Star
   53.1k](/login?return_to=%2Fgit%2Fgit)

* [Code](/git/git)
* [Pull requests
  192](/git/git/pulls)
* [Actions](/git/git/actions)
* [Security](/git/git/security)
* [Insights](/git/git/pulse)

Additional navigation options

* [Code](/git/git)
* [Pull requests](/git/git/pulls)
* [Actions](/git/git/actions)
* [Security](/git/git/security)
* [Insights](/git/git/pulse)

## Commit

[Permalink](/git/git/commit/508386c6c5857b4faa2c3e491f422c98cc69ae76)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Sync with 2.39.1

[Browse files](/git/git/tree/508386c6c5857b4faa2c3e491f422c98cc69ae76)
Browse the repository at this point in the history

* Loading branch information

[![@gitster](https://avatars.githubusercontent.com/u/54884?s=40&v=4)](/gitster)

[gitster](/git/git/commits?author=gitster "View all commits by gitster")
committed
Jan 16, 2023

2 parents
[262c45b](/git/git/commit/262c45b6a17d971cd440c6cd2fdeff1e0d081e47)
+
[01443f0](/git/git/commit/01443f01b7c6a3c6ef03268b649b119027743115)

commit 508386c

 Show file tree

 Hide file tree

Showing
**22 changed files**
with
**572 additions**
and
**125 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Documentation/RelNotes

  + Documentation/RelNotes/2.30.7.txt
    [2.30.7.txt](#diff-86faf135f2fa1508e172f761a5eebb0fa95b2c479c20ce27b94e6864de2a6eaa)
  + Documentation/RelNotes/2.31.6.txt
    [2.31.6.txt](#diff-e69252a778f5921660de68faeebba6ddc902759a28d15bb898297b0395c850ff)
  + Documentation/RelNotes/2.32.5.txt
    [2.32.5.txt](#diff-dc25c268c7abfd166cada33ec4e1a4db4bc096107e1a5bccd3abeec40c2edb7e)
  + Documentation/RelNotes/2.33.6.txt
    [2.33.6.txt](#diff-ac634d03d1736c51d68b93eda85b54c8f6230eb61c95c1589744c099a1766097)
  + Documentation/RelNotes/2.34.6.txt
    [2.34.6.txt](#diff-716536a2a4a2fb67d9667326b9a6bf0d08020771fc2c46e9aba0e7ed16410016)
  + Documentation/RelNotes/2.35.6.txt
    [2.35.6.txt](#diff-2b5faac7ebf613326d1a78206c0d6309432f6eba3161ac60247475388420ebb0)
  + Documentation/RelNotes/2.36.4.txt
    [2.36.4.txt](#diff-42780d271ba33d0aed8777155c4da30358f9e5bb2741a26d2a6baef9142f4948)
  + Documentation/RelNotes/2.37.5.txt
    [2.37.5.txt](#diff-943f3b9376ade541445e12551b9ca3314ae32584d3d1b2c4649c93de7a2762aa)
  + Documentation/RelNotes/2.38.3.txt
    [2.38.3.txt](#diff-c2895098c5f44e08756a815ac1918fc4fb2d2688e38335830a82ad1d45a279b4)
  + Documentation/RelNotes/2.39.1.txt
    [2.39.1.txt](#diff-26168b39fb80aadc099bcd25b83d321101a691e99947bd04edd5ac559907be53)
* attr.c
  [attr.c](#diff-f89b08f027f583c8719c7a22dba3ccc888b98aafc084c40df006c4e82a0ca278)
* attr.h
  [attr.h](#diff-3e5dce4801948fa3b9609714ca6b4c316c1ca143ed8430eb2809e8bda157a760)
* column.c
  [column.c](#diff-868b9634a3981e8547a828d2889775a7e433aa1af21145793f8d3bbf37ec37dc)
* fsck.c
  [fsck.c](#diff-49f47cb6112cfe90a35e275fb4c710b2ba22d56a54852ca38c2deac4f03610e5)
* fsck.h
  [fsck.h](#diff-0c527f5aa9b4d2d8876f28037c71ca96599198f3cdbb42394f456d864d8df941)
* git-compat-util.h
  [git-compat-util.h](#diff-1c67f843ddfdfea5499e634c6f3e9ee34fabb6e020aaad9188ba38771edd833d)
* pretty.c
  [pretty.c](#diff-63ca34c353f87c64f48647510e1499ed7236038c676ede8fa05ecc0d1c0ee804)
* t

  + t/t0003-attributes.sh
    [t0003-attributes.sh](#diff-3aa67fd2d1f7355ac7c67730df01f417756bf1f102a315d342ae4df83d6bfec6)
  + t/t1450-fsck.sh
    [t1450-fsck.sh](#diff-d168505dfc8af343da7b379e9a9a07f299143b0b6f5c7159586b38449b875d1a)
  + t/t4205-log-pretty-formats.sh
    [t4205-log-pretty-formats.sh](#diff-f77d2ab096233eaf58f4eb2e3d09428f4439c93c82a7d4782a952433d15f3349)
* utf8.c
  [utf8.c](#diff-5c08b53d950774a1e69852de5ba0662b178f6811e52db817fbd794fa519b619d)
* utf8.h
  [utf8.h](#diff-8bee4b28f81f3f2704b86c9bfba5b7f3c4edff3864898ecc9e48e445ceac982c)

## There are no files selected for viewing

86 changes: 86 additions & 0 deletions

86
[Documentation/RelNotes/2.30.7.txt](#diff-86faf135f2fa1508e172f761a5eebb0fa95b2c479c20ce27b94e6864de2a6eaa "Documentation/RelNotes/2.30.7.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.30.7.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,86 @@ |
|  |  | Git v2.30.7 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release addresses the security issues CVE-2022-41903 and |
|  |  | CVE-2022-23521. |
|  |  |  |
|  |  |  |
|  |  | Fixes since v2.30.6 |
|  |  | ------------------- |
|  |  |  |
|  |  | \* CVE-2022-41903: |
|  |  |  |
|  |  | git log has the ability to display commits using an arbitrary |
|  |  | format with its --format specifiers. This functionality is also |
|  |  | exposed to git archive via the export-subst gitattribute. |
|  |  |  |
|  |  | When processing the padding operators (e.g., %<(, %<|(, %>(, |
|  |  | %>>(, or %><( ), an integer overflow can occur in |
|  |  | pretty.c::format\_and\_pad\_commit() where a size\_t is improperly |
|  |  | stored as an int, and then added as an offset to a subsequent |
|  |  | memcpy() call. |
|  |  |  |
|  |  | This overflow can be triggered directly by a user running a |
|  |  | command which invokes the commit formatting machinery (e.g., git |
|  |  | log --format=...). It may also be triggered indirectly through |
|  |  | git archive via the export-subst mechanism, which expands format |
|  |  | specifiers inside of files within the repository during a git |
|  |  | archive. |
|  |  |  |
|  |  | This integer overflow can result in arbitrary heap writes, which |
|  |  | may result in remote code execution. |
|  |  |  |
|  |  | \* CVE-2022-23521: |
|  |  |  |
|  |  | gitattributes are a mechanism to allow defining attributes for |
|  |  | paths. These attributes can be defined by adding a `.gitattributes` |
|  |  | file to the repository, which contains a set of file patterns and |
|  |  | the attributes that should be set for paths matching this pattern. |
|  |  |  |
|  |  | When parsing gitattributes, multiple integer overflows can occur |
|  |  | when there is a huge number of path patterns, a huge number of |
|  |  | attributes for a single pattern, or when the declared attribute |
|  |  | names are huge. |
|  |  |  |
|  |  | These overflows can be triggered via a crafted `.gitattributes` file |
|  |  | that may be part of the commit history. Git silently splits lines |
|  |  | longer than 2KB when parsing gitattributes from a file, but not when |
|  |  | parsing them from the index. Consequentially, the failure mode |
|  |  | depends on whether the file exists in the working tree, the index or |
|  |  | both. |
|  |  |  |
|  |  | This integer overflow can result in arbitrary heap reads and writes, |
|  |  | which may result in remote code execution. |
|  |  |  |
|  |  | Credit for finding CVE-2022-41903 goes to Joern Schneeweisz of GitLab. |
|  |  | An initial fix was authored by Markus Vervier of X41 D-Sec. Credit for |
|  |  | finding CVE-2022-23521 goes to Markus Vervier and Eric Sesterhenn of X41 |
|  |  | D-Sec. This work was sponsored by OSTIF. |
|  |  |  |
|  |  | The proposed fixes have been polished and extended to cover additional |
|  |  | findings by Patrick Steinhardt of GitLab, with help from others on the |
|  |  | Git security mailing list. |
|  |  |  |
|  |  | Patrick Steinhardt (21): |
|  |  | attr: fix overflow when upserting attribute with overly long name |
|  |  | attr: fix out-of-bounds read with huge attribute names |
|  |  | attr: fix integer overflow when parsing huge attribute names |
|  |  | attr: fix out-of-bounds write when parsing huge number of attributes |
|  |  | attr: fix out-of-bounds read with unreasonable amount of patterns |
|  |  | attr: fix integer overflow with more than INT\_MAX macros |
|  |  | attr: harden allocation against integer overflows |
|  |  | attr: fix silently splitting up lines longer than 2048 bytes |
|  |  | attr: ignore attribute lines exceeding 2048 bytes |
|  |  | attr: ignore overly large gitattributes files |
|  |  | pretty: fix out-of-bounds write caused by integer overflow |
|  |  | pretty: fix out-of-bounds read when left-flushing with stealing |
|  |  | pretty: fix out-of-bounds read when parsing invalid padding format |
|  |  | pretty: fix adding linefeed when placeholder is not expanded |
|  |  | pretty: fix integer overflow in wrapping format |
|  |  | utf8: fix truncated string lengths in `utf8\_strnwidth()` |
|  |  | utf8: fix returning negative string width |
|  |  | utf8: fix overflow when returning string width |
|  |  | utf8: fix checking for glyph width in `strbuf\_utf8\_replace()` |
|  |  | utf8: refactor `strbuf\_utf8\_replace` to not rely on preallocated buffer |
|  |  | pretty: restrict input lengths for padding and wrapping formats |
|  |  |  |

5 changes: 5 additions & 0 deletions

5
[Documentation/RelNotes/2.31.6.txt](#diff-e69252a778f5921660de68faeebba6ddc902759a28d15bb898297b0395c850ff "Documentation/RelNotes/2.31.6.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.31.6.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,5 @@ |
|  |  | Git v2.31.6 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |

8 changes: 8 additions & 0 deletions

8
[Documentation/RelNotes/2.32.5.txt](#diff-dc25c268c7abfd166cada33ec4e1a4db4bc096107e1a5bccd3abeec40c2edb7e "Documentation/RelNotes/2.32.5.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.32.5.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,8 @@ |
|  |  | Git v2.32.5 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |
|  |  |  |
|  |  | In addition, included are additional code for "git fsck" to check |
|  |  | for questionable .gitattributes files. |

5 changes: 5 additions & 0 deletions

5
[Documentation/RelNotes/2.33.6.txt](#diff-ac634d03d1736c51d68b93eda85b54c8f6230eb61c95c1589744c099a1766097 "Documentation/RelNotes/2.33.6.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.33.6.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,5 @@ |
|  |  | Git v2.33.6 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |

5 changes: 5 additions & 0 deletions

5
[Documentation/RelNotes/2.34.6.txt](#diff-716536a2a4a2fb67d9667326b9a6bf0d08020771fc2c46e9aba0e7ed16410016 "Documentation/RelNotes/2.34.6.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.34.6.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,5 @@ |
|  |  | Git v2.34.6 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |

5 changes: 5 additions & 0 deletions

5
[Documentation/RelNotes/2.35.6.txt](#diff-2b5faac7ebf613326d1a78206c0d6309432f6eba3161ac60247475388420ebb0 "Documentation/RelNotes/2.35.6.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.35.6.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,5 @@ |
|  |  | Git v2.35.6 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |

5 changes: 5 additions & 0 deletions

5
[Documentation/RelNotes/2.36.4.txt](#diff-42780d271ba33d0aed8777155c4da30358f9e5bb2741a26d2a6baef9142f4948 "Documentation/RelNotes/2.36.4.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.36.4.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,5 @@ |
|  |  | Git v2.36.4 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |

5 changes: 5 additions & 0 deletions

5
[Documentation/RelNotes/2.37.5.txt](#diff-943f3b9376ade541445e12551b9ca3314ae32584d3d1b2c4649c93de7a2762aa "Documentation/RelNotes/2.37.5.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.37.5.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,5 @@ |
|  |  | Git v2.37.5 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |

5 changes: 5 additions & 0 deletions

5
[Documentation/RelNotes/2.38.3.txt](#diff-c2895098c5f44e08756a815ac1918fc4fb2d2688e38335830a82ad1d45a279b4 "Documentation/RelNotes/2.38.3.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.38.3.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,5 @@ |
|  |  | Git v2.38.3 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |

5 changes: 5 additions & 0 deletions

5
[Documentation/RelNotes/2.39.1.txt](#diff-26168b39fb80aadc099bcd25b83d321101a691e99947bd04edd5ac559907be53 "Documentation/RelNotes/2.39.1.txt")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/Documentation/RelNotes/2.39.1.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,5 @@ |
|  |  | Git v2.39.1 Release Notes |
|  |  | ========================= |
|  |  |  |
|  |  | This release merges the security fix that appears in v2.30.7; see |
|  |  | the release notes for that version for details. |

91 changes: 56 additions & 35 deletions

91
[attr.c](#diff-f89b08f027f583c8719c7a22dba3ccc888b98aafc084c40df006c4e82a0ca278 "attr.c")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/attr.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,7 +24,7 @@ static const char git\_attr\_\_unknown[] = "(builtin)unknown"; |
|  |  | #define ATTR\_\_UNKNOWN git\_attr\_\_unknown |
|  |  |  |
|  |  | struct git\_attr { |
|  |  | int attr\_nr; /\* unique attribute number \*/ |
|  |  | unsigned int attr\_nr; /\* unique attribute number \*/ |
|  |  | char name[FLEX\_ARRAY]; /\* attribute name \*/ |
|  |  | }; |
|  |  |  |
| Expand Down  Expand Up | | @@ -206,7 +206,7 @@ static void report\_invalid\_attr(const char \*name, size\_t len, |
|  |  | \* dictionary. If no entry is found, create a new attribute and store it in |
|  |  | \* the dictionary. |
|  |  | \*/ |
|  |  | static const struct git\_attr \*git\_attr\_internal(const char \*name, int namelen) |
|  |  | static const struct git\_attr \*git\_attr\_internal(const char \*name, size\_t namelen) |
|  |  | { |
|  |  | struct git\_attr \*a; |
|  |  |  |
| Expand All | | @@ -222,8 +222,8 @@ static const struct git\_attr \*git\_attr\_internal(const char \*name, int namelen) |
|  |  | a->attr\_nr = hashmap\_get\_size(&g\_attr\_hashmap.map); |
|  |  |  |
|  |  | attr\_hashmap\_add(&g\_attr\_hashmap, a->name, namelen, a); |
|  |  | assert(a->attr\_nr == |
|  |  | (hashmap\_get\_size(&g\_attr\_hashmap.map) - 1)); |
|  |  | if (a->attr\_nr != hashmap\_get\_size(&g\_attr\_hashmap.map) - 1) |
|  |  | die(\_("unable to add additional attribute")); |
|  |  | } |
|  |  |  |
|  |  | hashmap\_unlock(&g\_attr\_hashmap); |
| Expand Down  Expand Up | | @@ -268,7 +268,7 @@ struct match\_attr { |
|  |  | const struct git\_attr \*attr; |
|  |  | } u; |
|  |  | char is\_macro; |
|  |  | unsigned num\_attr; |
|  |  | size\_t num\_attr; |
|  |  | struct attr\_state state[FLEX\_ARRAY]; |
|  |  | }; |
|  |  |  |
| Expand All | | @@ -289,7 +289,7 @@ static const char \*parse\_attr(const char \*src, int lineno, const char \*cp, |
|  |  | struct attr\_state \*e) |
|  |  | { |
|  |  | const char \*ep, \*equals; |
|  |  | int len; |
|  |  | size\_t len; |
|  |  |  |
|  |  | ep = cp + strcspn(cp, blank); |
|  |  | equals = strchr(cp, '='); |
| Expand Down  Expand Up | | @@ -333,8 +333,7 @@ static const char \*parse\_attr(const char \*src, int lineno, const char \*cp, |
|  |  | static struct match\_attr \*parse\_attr\_line(const char \*line, const char \*src, |
|  |  | int lineno, unsigned flags) |
|  |  | { |
|  |  | int namelen; |
|  |  | int num\_attr, i; |
|  |  | size\_t namelen, num\_attr, i; |
|  |  | const char \*cp, \*name, \*states; |
|  |  | struct match\_attr \*res = NULL; |
|  |  | int is\_macro; |
| Expand All | | @@ -345,6 +344,11 @@ static struct match\_attr \*parse\_attr\_line(const char \*line, const char \*src, |
|  |  | return NULL; |
|  |  | name = cp; |
|  |  |  |
|  |  | if (strlen(line) >= ATTR\_MAX\_LINE\_LENGTH) { |
|  |  | warning(\_("ignoring overly long attributes line %d"), lineno); |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | if (\*cp == '"' && !unquote\_c\_style(&pattern, name, &states)) { |
|  |  | name = pattern.buf; |
|  |  | namelen = pattern.len; |
| Expand Down  Expand Up | | @@ -381,10 +385,9 @@ static struct match\_attr \*parse\_attr\_line(const char \*line, const char \*src, |
|  |  | goto fail\_return; |
|  |  | } |
|  |  |  |
|  |  | res = xcalloc(1, |
|  |  | sizeof(\*res) + |
|  |  | sizeof(struct attr\_state) \* num\_attr + |
|  |  | (is\_macro ? 0 : namelen + 1)); |
|  |  | res = xcalloc(1, st\_add3(sizeof(\*res), |
|  |  | st\_mult(sizeof(struct attr\_state), num\_attr), |
|  |  | is\_macro ? 0 : namelen + 1)); |
|  |  | if (is\_macro) { |
|  |  | res->u.attr = git\_attr\_internal(name, namelen); |
|  |  | } else { |
| Expand Down  Expand Up | | @@ -447,11 +450,12 @@ struct attr\_stack { |
|  |  |  |
|  |  | static void attr\_stack\_free(struct attr\_stack \*e) |
|  |  | { |
|  |  | int i; |
|  |  | unsigned i; |
|  |  | free(e->origin); |
|  |  | for (i = 0; i < e->num\_matches; i++) { |
|  |  | struct match\_attr \*a = e->attrs[i]; |
|  |  | int j; |
|  |  | size\_t j; |
|  |  |  |
|  |  | for (j = 0; j < a->num\_attr; j++) { |
|  |  | const char \*setto = a->state[j].setto; |
|  |  | if (setto == ATTR\_\_TRUE || |
| Expand Down  Expand Up | | @@ -660,8 +664,8 @@ static void handle\_attr\_line(struct attr\_stack \*res, |
|  |  | a = parse\_attr\_line(line, src, lineno, flags); |
|  |  | if (!a) |
|  |  | return; |
|  |  | ALLOC\_GROW(res->attrs, res->num\_matches + 1, res->alloc); |
|  |  | res->attrs[res->num\_matches++] = a; |
|  |  | ALLOC\_GROW\_BY(res->attrs, res->num\_matches, 1, res->alloc); |
|  |  | res->attrs[res->num\_matches - 1] = a; |
|  |  | } |
|  |  |  |
|  |  | static struct attr\_stack \*read\_attr\_from\_array(const char \*\*list) |
| Expand Down  Expand Up | | @@ -701,11 +705,12 @@ void git\_attr\_set\_direction(enum git\_attr\_direction new\_direction) |
|  |  |  |
|  |  | static struct attr\_stack \*read\_attr\_from\_file(const char \*path, unsigned flags) |
|  |  | { |
|  |  | struct strbuf buf = STRBUF\_INIT; |
|  |  | int fd; |
|  |  | FILE \*fp; |
|  |  | struct attr\_stack \*res; |
|  |  | char buf[2048]; |
|  |  | int lineno = 0; |
|  |  | struct stat st; |
|  |  |  |
|  |  | if (flags & READ\_ATTR\_NOFOLLOW) |
|  |  | fd = open\_nofollow(path, O\_RDONLY); |
| Expand All | | @@ -717,15 +722,26 @@ static struct attr\_stack \*read\_attr\_from\_file(const char \*path, unsigned flags) |
|  |  | return NULL; |
|  |  | } |
|  |  | fp = xfdopen(fd, "r"); |
|  |  | if (fstat(fd, &st)) { |
|  |  | warning\_errno(\_("cannot fstat gitattributes file '%s'"), path); |
|  |  | fclose(fp); |
|  |  | return NULL; |
|  |  | } |
|  |  | if (st.st\_size >= ATTR\_MAX\_FILE\_SIZE) { |
|  |  | warning(\_("ignoring overly large gitattributes file '%s'"), path); |
|  |  | fclose(fp); |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | CALLOC\_ARRAY(res, 1); |
|  |  | while (fgets(buf, sizeof(buf), fp)) { |
|  |  | char \*bufp = buf; |
|  |  | if (!lineno) |
|  |  | skip\_utf8\_bom(&bufp, strlen(bufp)); |
|  |  | handle\_attr\_line(res, bufp, path, ++lineno, flags); |
|  |  | while (strbuf\_getline(&buf, fp) != EOF) { |
|  |  | if (!lineno && starts\_with(buf.buf, utf8\_bom)) |
|  |  | strbuf\_remove(&buf, 0, strlen(utf8\_bom)); |
|  |  | handle\_attr\_line(res, buf.buf, path, ++lineno, flags); |
|  |  | } |
|  |  |  |
|  |  | fclose(fp); |
|  |  | strbuf\_release(&buf); |
|  |  | return res; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -736,6 +752,7 @@ static struct attr\_stack \*read\_attr\_from\_index(struct index\_state \*istate, |
|  |  | struct attr\_stack \*res; |
|  |  | char \*buf, \*sp; |
|  |  | int lineno = 0; |
|  |  | size\_t size; |
|  |  |  |
|  |  | if (!istate) |
|  |  | return NULL; |
| Expand All | | @@ -754,9 +771,13 @@ static struct attr\_stack \*read\_attr\_from\_index(struct index\_state \*istate, |
|  |  | if (!path\_in\_cone\_mode\_sparse\_checkout(path, istate)) |
|  |  | return NULL; |
|  |  |  |
|  |  | buf = read\_blob\_data\_from\_index(istate, path, NULL); |
|  |  | buf = read\_blob\_data\_from\_index(istate, path, &size); |
|  |  | if (!buf) |
|  |  | return NULL; |
|  |  | if (size >= ATTR\_MAX\_FILE\_SIZE) { |
|  |  | warning(\_("ignoring overly large gitattributes blob '%s'"), path); |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | CALLOC\_ARRAY(res, 1); |
|  |  | for (sp = buf; \*sp; ) { |
| Expand Down  Expand Up | | @@ -999,12 +1020,12 @@ static int macroexpand\_one(struct all\_attrs\_item \*all\_attrs, int nr, int rem); |
|  |  | static int fill\_one(struct all\_attrs\_item \*all\_attrs, |
|  |  | const struct match\_attr \*a, int rem) |
|  |  | { |
|  |  | int i; |
|  |  | size\_t i; |
|  |  |  |
|  |  | for (i = a->num\_attr - 1; rem > 0 && i >= 0; i--) { |
|  |  | const struct git\_attr \*attr = a->state[i].attr; |
|  |  | for (i = a->num\_attr; rem > 0 && i > 0; i--) { |
|  |  | const struct git\_attr \*attr = a->state[i - 1].attr; |
|  |  | const char \*\*n = &(all\_attrs[attr->attr\_nr].value); |
|  |  | const char \*v = a->state[i].setto; |
|  |  | const char \*v = a->state[i - 1].setto; |
|  |  |  |
|  |  | if (\*n == ATTR\_\_UNKNOWN) { |
|  |  | \*n = v; |
| Expand All | | @@ -1020,11 +1041,11 @@ static int fill(const char \*path, int pathlen, int basename\_offset, |
|  |  | struct all\_attrs\_item \*all\_attrs, int rem) |
|  |  | { |
|  |  | for (; rem > 0 && stack; stack = stack->prev) { |
|  |  | int i; |
|  |  | unsigned i; |
|  |  | const char \*base = stack->origin ? stack->origin : ""; |
|  |  |  |
|  |  | for (i = stack->num\_matches - 1; 0 < rem && 0 <= i; i--) { |
|  |  | const struct match\_attr \*a = stack->attrs[i]; |
|  |  | for (i = stack->num\_matches; 0 < rem && 0 < i; i--) { |
|  |  | const struct match\_attr \*a = stack->attrs[i - 1]; |
|  |  | if (a->is\_macro) |
|  |  | continue; |
|  |  | if (path\_matches(path, pathlen, basename\_offset, |
| Expand Down  Expand Up | | @@ -1055,11 +1076,11 @@ static void determine\_macros(struct all\_attrs\_item \*all\_attrs, |
|  |  | const struct attr\_stack \*stack) |
|  |  | { |
|  |  | for (; stack; stack = stack->prev) { |
|  |  | int i; |
|  |  | for (i = stack->num\_matches - 1; i >= 0; i--) { |
|  |  | const struct match\_attr \*ma = stack->attrs[i]; |
|  |  | unsigned i; |
|  |  | for (i = stack->num\_matches; i > 0; i--) { |
|  |  | const struct match\_attr \*ma = stack->attrs[i - 1]; |
|  |  | if (ma->is\_macro) { |
|  |  | int n = ma->u.attr->attr\_nr; |
|  |  | unsigned int n = ma->u.attr->attr\_nr; |
|  |  | if (!all\_attrs[n].macro) { |
|  |  | all\_attrs[n].macro = ma; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1111,7 +1132,7 @@ void git\_check\_attr(struct index\_state \*istate, |
|  |  | collect\_some\_attrs(istate, path, check); |
|  |  |  |
|  |  | for (i = 0; i < check->nr; i++) { |
|  |  | size\_t n = check->items[i].attr->attr\_nr; |
|  |  | unsigned int n = check->items[i].attr->attr\_nr; |
|  |  | const char \*value = check->all\_attrs[n].value; |
|  |  | if (value == ATTR\_\_UNKNOWN) |
|  |  | value = ATTR\_\_UNSET; |
| Expand Down | |  |

12 changes: 12 additions & 0 deletions

12
[attr.h](#diff-3e5dce4801948fa3b9609714ca6b4c316c1ca143ed8430eb2809e8bda157a760 "attr.h")

Show comments

[View file](/git/git/blob/508386c6c5857b4faa2c3e491f422c98cc69ae76/attr.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -107,6 +107,18 @@ |
|  |  | \* - Free the `attr\_check` struct by calling `attr\_check\_free()`. |
|  |  | \*/ |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The maximum line length for a gitattributes file. If the line exceeds this |
|  |  | \* length we will ignore it. |
|  |  | \*/ |
|  |  | #define ATTR\_MAX\_LINE\_LENGTH 2048 |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The maximum size of the giattributes file. If the file exceeds this size we |
|  |  | \* will ignore it. |
|  |  | \*/ |
|  |  | #define ATTR\_MAX\_FILE\_SIZE (100 \* 1024 \* 1024) |
|  |  |  |
|  |  | struct index\_state; |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `508386c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgit%2Fgit%2Fcommit%2F508386c6c5857b4faa2c3e491f422c98cc69ae76) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

