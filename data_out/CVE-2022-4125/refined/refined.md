- **Root cause of vulnerability:** The plugin lacks authorization and CSRF checks when creating or updating popups. Additionally, it doesn't sanitize or escape user-supplied input.
- **Weaknesses/vulnerabilities present:**
  - Unauthenticated Stored Cross-Site Scripting (XSS) vulnerability.
  - Missing authorization checks for popup creation/update actions.
  - Missing CSRF protection for popup creation/update actions.
  - Lack of input sanitization and output escaping.
- **Impact of exploitation:** An unauthenticated attacker can create or modify popups to inject arbitrary JavaScript code. This could lead to various malicious activities, such as:
    - Redirecting users to malicious websites.
    - Stealing user session cookies.
    - Defacing the website.
    - Performing actions on behalf of an authenticated user.
- **Attack vectors:**
  - The vulnerability can be exploited through an HTTP POST request to the `/wp-admin/admin-ajax.php` endpoint.
  - The attacker can send the `pm_save_data` action along with malicious parameters to create or update popups.
- **Required attacker capabilities/position:**
  - The attacker doesn't need authentication, therefore they can be an anonymous user.
  - The attacker needs to be able to send HTTP POST requests to the WordPress site.