=== Content from seclists.org_c478f37d_20250110_170204.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](23)
[By Date](date.html#24)
[![Next](/images/right-icon-16x16.png)](25)

[![Previous](/images/left-icon-16x16.png)](23)
[By Thread](index.html#24)
[![Next](/images/right-icon-16x16.png)](25)

![](/shared/images/nst-icons.svg#search)

# MindManager 23 - full disclosure

---

*From*: Pawel Karwowski via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Fri, 19 Apr 2024 13:46:08 +0000

---

```
Resending! Thank you for your efforts.

GitHub - pawlokk/mindmanager-poc: public disclosure<<https://github.com/pawlokk/mindmanager-poc>>

Affected application: MindManager23_setup.exe

Platform: Windows

Issue: Local Privilege Escalation via MSI installer Repair Mode (EXE hijacking race condition)

Discovered and reported by: Pawel Karwowski and Julian Horoszkiewicz (Eviden Red Team)

Proposed mitigation: <https://learn.microsoft.com/en-us/windows/win32/msi/disablemsi>

Reasoning for public disclosure: Sitting on this indefinitely in the long run benefits threat actors (the issue is
trivial to find), while keeping users and administrators in the dark, unaware of the risk.

What is the vendor's position? According to the vendor it is not their responsibility, as the vulnerability lies in a
3rd party component (CVE-2021-41526). This doesn't mean that their software isn't vulnerable, though. We originally
reported this issue to vendor on 22.08.2023. Since then, we could not convince them to release a fix, even despite
involving US CERT into coordination efforts. After prolonged period of exchanging messages back and forth, we agreed
with CERT that in this situation public disclosure is the proper course of action.

What's the vulnerability? On systems with MindManager23 installed, it is possible for regular users to trigger the
installer in "repair" mode, by issuing the following command: msiexec.exe /fa PATH_TO_INSTALLER_FILE.msi

This triggers the msiexec service, which carries the repair process, running multiple actions and, among others,
creates files inside of the C:\Users\pk\AppData\Local\Temp directory, which have their filenames dynamically generated,
in the following pattern: "wac.tmp", for example, wac98DF.tmp. The process then uses the generated wac****.tmp file
(executable) running as NT AUTHORITY/SYSTEM to write to, and load an image of itself.

Since the C:\Users\pk\AppData\Local\ directory is owned by the regular user, the C:\Users\pk\AppData\Local\Temp\
directory inherits the permissions, making it possible for the regular user to interfere with the contents of the
directory, for example by overwriting the dynamically generated DLL\EXE files.

The privilege escalation in Mind Manager installer is caused by its use of a known vulnerable component - Flexera
Installshield, affected by CVE-2021-41526. Mind Manager should use an up-to-date version of the Flexera Installshield -
or repacakge the MSI so it does not support "repair mode", or requires administrative privileges to run it.

What is the exploitation process? Exploitation is done with the use of a powershell script that runs the .MSI file,
checks for the presence and creation of our legit DLL\EXE of interest, and repeatedly copies the Proof of Concept
DLL\EXE into the Appdata\Local\Temp directory, effectively overwriting the legit DLL\EXE file. After being ran, the PoC
DLL\EXE file creates a poc.txt file in C:\Users\Public, together with the command line that called it, and whoami
output.

Kind regards,

[Eviden logo]

Pawe≈Ç Karwowski
Security Engineer - Red Team
Eviden CERT
eviden.com

```

[![](att-24/image001.png)](att-24/image001.png)

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](23)
[By Date](date.html#24)
[![Next](/images/right-icon-16x16.png)](25)

[![Previous](/images/left-icon-16x16.png)](23)
[By Thread](index.html#24)
[![Next](/images/right-icon-16x16.png)](25)

### Current thread:

* **MindManager 23 - full disclosure** *Pawel Karwowski via Fulldisclosure (Apr 19)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_57229732_20250110_170205.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiant%2FVulnerability-Disclosures%2Fblob%2Fmaster%2FMNDT-2021-0011%2FMNDT-2021-0011.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmandiant%2FVulnerability-Disclosures%2Fblob%2Fmaster%2FMNDT-2021-0011%2FMNDT-2021-0011.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mandiant%2FVulnerability-Disclosures)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mandiant](/mandiant)
/
**[Vulnerability-Disclosures](/mandiant/Vulnerability-Disclosures)**
Public

* [Notifications](/login?return_to=%2Fmandiant%2FVulnerability-Disclosures) You must be signed in to change notification settings
* [Fork
  66](/login?return_to=%2Fmandiant%2FVulnerability-Disclosures)
* [Star
   196](/login?return_to=%2Fmandiant%2FVulnerability-Disclosures)

* [Code](/mandiant/Vulnerability-Disclosures)
* [Issues
  0](/mandiant/Vulnerability-Disclosures/issues)
* [Pull requests
  0](/mandiant/Vulnerability-Disclosures/pulls)
* [Actions](/mandiant/Vulnerability-Disclosures/actions)
* [Projects
  0](/mandiant/Vulnerability-Disclosures/projects)
* [Security](/mandiant/Vulnerability-Disclosures/security)
* [Insights](/mandiant/Vulnerability-Disclosures/pulse)

Additional navigation options

* [Code](/mandiant/Vulnerability-Disclosures)
* [Issues](/mandiant/Vulnerability-Disclosures/issues)
* [Pull requests](/mandiant/Vulnerability-Disclosures/pulls)
* [Actions](/mandiant/Vulnerability-Disclosures/actions)
* [Projects](/mandiant/Vulnerability-Disclosures/projects)
* [Security](/mandiant/Vulnerability-Disclosures/security)
* [Insights](/mandiant/Vulnerability-Disclosures/pulse)

## Files

¬†master
## Breadcrumbs

1. [Vulnerability-Disclosures](/mandiant/Vulnerability-Disclosures/tree/master)
2. /[MNDT-2021-0011](/mandiant/Vulnerability-Disclosures/tree/master/MNDT-2021-0011)
/
# MNDT-2021-0011.md

Copy path Blame  Blame
## Latest commit

## History

[History](/mandiant/Vulnerability-Disclosures/commits/master/MNDT-2021-0011/MNDT-2021-0011.md)32 lines (22 loc) ¬∑ 1.67 KB¬†master
## Breadcrumbs

1. [Vulnerability-Disclosures](/mandiant/Vulnerability-Disclosures/tree/master)
2. /[MNDT-2021-0011](/mandiant/Vulnerability-Disclosures/tree/master/MNDT-2021-0011)
/
# MNDT-2021-0011.md

Top
## File metadata and controls

* Preview
* Code
* Blame

32 lines (22 loc) ¬∑ 1.67 KB[Raw](https://github.com/mandiant/Vulnerability-Disclosures/raw/refs/heads/master/MNDT-2021-0011/MNDT-2021-0011.md)
# MNDT-2021-0011

Flexera Revenera InstallShield for Windows prior to version 2021 R2 contains a privilege escalation vulnerability during MSI repair for the MSI built with InstallScript custom action.

## Impact

High - Exploiting the vulnerability will give a local unprivileged attacker SYSTEM level privileges.

## Exploitability

Medium - Any authenticated local user can exploit the vulnerability and an exploit is trivial to produce.

## CVE Reference

CVE-2021-41526

## Technical Details

During MSI repair, InstallScript custom actions, if configured in the project, will be executed by extracting the InstallScript engine files to a unique folder in the user‚Äôs TEMP directory and then executed.

InstallScript engine files contain an executable named ISBEW64.EXE, which will be executed during the InstallScript code execution. As a result, during MSI repair, a low privilege user can invoke the operation and attain privilege escalation to ‚ÄúNT Authority/SYSTEM‚Äù by replacing ISBEW64.EXE in the TEMP folder with a malicious one.

## Resolution

The issue was fixed in version 2021 R2. Update to this version to address the vulnerability.

## Discovery Credits

* Ronnie Salomonsen, Mandiant

## Disclosure Timeline

* 18-Nov-2021 - Issue reported to Flexera Revenera
* 24-Nov-2021 - Issue confirmed by Flexera Revenera and a fix scheduled for December 17
* 17-Dec-2021 - Patched version released by Flexera Revenera

## References

* <https://community.flexera.com/t5/InstallShield-Knowledge-Base/CVE-2021-41526-Privilege-escalation-vulnerability-during-MSI/ta-p/218137/jump-to/first-unread-message>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41526>

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


