- **Root cause of vulnerability**: The vulnerability stems from the improper handling of user-supplied input in the `cert` and `key` parameters within the `xml_submit_x509_overwrite_mvpn_self` function. These parameters are directly incorporated into OS commands without sufficient sanitization, specifically within the `/usr/local/ilink/bin/certificate_helper` calls, allowing for OS command injection.
- **Weaknesses/vulnerabilities present**: OS Command Injection (CWE-78). The `cert` and `key` parameters are not properly sanitized before being used in shell commands executed by the `system()` function.
- **Impact of exploitation**: A successful attack allows an attacker to execute arbitrary OS commands with root privileges on the affected device. This can lead to a complete compromise of the system, potentially enabling data theft, system modification, or denial of service.
- **Attack vectors**: An attacker can exploit the vulnerability by sending a specially crafted HTTP POST request to the `/cgi-bin/MANGA/api.cgi` endpoint with the `func` parameter set to `cmd.mvpn.x509.write` and malicious values in the `cert` and `key` parameters.
- **Required attacker capabilities/position**: The attacker needs to be authenticated as a user with write privileges on the device to access the vulnerable endpoint.