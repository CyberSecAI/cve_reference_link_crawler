```json
{
  "vulnerability_details": {
    "root_cause": "The `shttpd` program uses the `Uci_Set_Str` function to set configuration values. This function concatenates parameters using `snprintf` before passing them to the `CsteSystem` function for execution, allowing for command injection.",
    "weaknesses": [
      "Command Injection",
      "Insecure use of `snprintf`",
      "Unsanitized user input passed to system commands"
    ],
    "impact": "Arbitrary command execution on the target device.",
    "attack_vectors": "Sending a crafted HTTP POST request to the `/cgi-bin/cstecgi.cgi` endpoint with a malicious `lang` parameter.",
      "required_capabilities": "Attacker needs to be able to send HTTP requests to the device. No specific authentication requirements are mentioned in the provided text."
  },
  "affected_product": {
    "name": "TOTOLINK X6000R",
    "version": "V9.4.0cu.852_B20230719"
  },
    "poc": "The provided POC shows how to inject the `ls > /1.txt` command by sending a POST request to the `/cgi-bin/cstecgi.cgi` endpoint. The malicious command is injected through the `lang` parameter in the POST data. The result of the `ls` command will be stored in a file named `1.txt` at the root of the filesystem."
}
```