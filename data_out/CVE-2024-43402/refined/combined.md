=== Content from learn.microsoft.com_9d45d9f3_20250111_194513.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to Plan
[Edit](https://github.com/MicrosoftDocs/SupportArticles-docs/blob/main/support/windows-client/shell-experience/file-folder-name-whitespace-characters.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Support for Whitespace characters in File and Folder names for Windows

* Article
* 12/26/2023
* 3 contributors

Feedback

## In this article

This article describes support for whitespace characters in file and folder names.

*Original KB number:*   2829981

## Summary

File and Folder names that begin or end with the ASCII Space (0x20) will be saved without these characters. File and Folder names that end with the ASCII Period (0x2E) character will also be saved without this character. All other trailing or leading whitespace characters are retained.

For example:

* If a file is saved as ' Foo.txt', where the leading character(s) is an ASCII Space (0x20), it will be saved to the file system as 'Foo.txt'.
* If a file is saved as 'Foo.txt ', where the trailing character(s) is an ASCII Space (0x20), it will be saved to the file system as 'Foo.txt'.
* If a file is saved as '.Foo.txt', where the leading character(s) is an ASCII Period (0x2E), it will be saved to the file system as '.Foo.txt'.
* If a file is saved as 'Foo.txt.', where the trailing character(s) is an ASCII Period (0x2E), it will be saved to the file system as 'Foo.txt'.
* If a file is saved as ' Foo.txt', where the leading character(s) is an alternate whitespace character, such as the Ideographic Space (0x3000), it will be saved to the file system as ' Foo.txt '. The leading whitespace characters are not removed.
* If a file is saved as 'Foo.txt ', where the trailing character(s) is an alternate whitespace character, such as the Ideographic Space (0x3000), it will be saved to the file system as 'Foo.txt '. The trailing whitespace characters are *not* removed.File and Folder names that begin or end with a whitespace character are enumerated differently by the Win32 and WinRT APIs due to ecosystem requirements.

## More information

### Whitespace Characters

There are various whitespace characters representing various 'space' widths (glyphs). Only the ASCII Space (0x20) and ASCII Period (0x24) characters are handled specially by the Object Manager. Although the Ideographic Space character (0x3000) is also generated by using the Spacebar (when IME is enabled), it is not handled specially.

* 0x0020 SPACE
* 0x00A0 NO-BREAK SPACE
* 0x1680 OGHAM SPACE MARK
* 0x180E MONGOLIAN VOWEL SEPARATOR
* 0x2000 EN QUAD
* 0x2001 EM QUAD
* 0x2002 EN SPACE
* 0x2003 EM SPACE
* 0x2004 THREE-PER-EM SPACE
* 0x2005 FOUR-PER-EM SPACE
* 0x2006 SIX-PER-EM SPACE
* 0x2007 FIGURE SPACE
* 0x2008 PUNCTUATION SPACE
* 0x2009 THIN SPACE
* 0x200A HAIR SPACE
* 0x200B ZERO WIDTH SPACE
* 0x202F NARROW NO-BREAK SPACE
* 0x205F MEDIUM MATHEMATICAL SPACE
* 0x3000 IDEOGRAPHIC SPACE
* 0xFEFF ZERO WIDTH NO-BREAK SPACE

### Object Manager

ASCII Space (0x20) characters at the beginning or end of a file or folder name are removed by the Object Manager upon creation.

ASCII Period (0x2E) characters at the end of a file or folder name are removed by the Object Manager upon creation.

All other leading or trailing whitespace characters are retained by the Object Manager.

### API Enumeration

#### Win32 API

The Win32 API ([CreateFile](/en-us/windows/win32/api/fileapi/nf-fileapi-createfilea), [FindFirstFile](/en-us/windows/win32/api/fileapi/nf-fileapi-findfirstfilea), etc.) uses a direct method to enumerate the files and folders on a local or remote file system. All files and folders are discoverable regardless of the inclusion or location of whitespace characters.

#### WinRT API

The WinRT API is designed to support multiple data providers (Physical Drives, OneDrive, Facebook, etc.). To achieve this, WinRT API uses a search engine to enumerate files and folders. Due to the search approach to enumeration, the WinRT API ([StorageFile](/en-us/uwp/api/Windows.Storage.StorageFile), [StorageFolder](/en-us/uwp/api/Windows.Storage.StorageFolder), etc.) does not handle file and folder names with trailing whitespace characters other than ASCII Space (0x20) and ASCII Period (0x2E) residing on a local or remote file system. It does handle leading non-ASCII whitespace characters.

### Observed Behavior

#### File Explorer and Desktop applications

All files and folders are visible within File Explorer and Desktop applications regardless of inclusion or location of whitespace characters.

#### Microsoft Store applications

When using the File Picker, files with a trailing non-ASCII whitespace character do not appear. The contents of subfolders with trailing non-ASCII whitespace characters are not displayed in the File Picker. Files or folders containing a leading non-ASCII whitespace character are displayed.

---

## Feedback

Was this page helpful?

Yes

No

[Provide product feedback](https://support.microsoft.com/windows/f59187f8-8739-22d6-ba93-f66612949332)

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2024
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2024



=== Content from github.com_c0f63233_20250111_194513.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frust-lang%2Frust%2Fsecurity%2Fadvisories%2FGHSA-2xg3-7mm6-98jj)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frust-lang%2Frust%2Fsecurity%2Fadvisories%2FGHSA-2xg3-7mm6-98jj)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=rust-lang%2Frust)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rust-lang](/rust-lang)
/
**[rust](/rust-lang/rust)**
Public

* [Notifications](/login?return_to=%2Frust-lang%2Frust) You must be signed in to change notification settings
* [Fork
  13k](/login?return_to=%2Frust-lang%2Frust)
* [Star
   100k](/login?return_to=%2Frust-lang%2Frust)

* [Code](/rust-lang/rust)
* [Issues
  5k+](/rust-lang/rust/issues)
* [Pull requests
  661](/rust-lang/rust/pulls)
* [Actions](/rust-lang/rust/actions)
* [Projects
  7](/rust-lang/rust/projects)
* [Security](/rust-lang/rust/security)
* [Insights](/rust-lang/rust/pulse)

Additional navigation options

* [Code](/rust-lang/rust)
* [Issues](/rust-lang/rust/issues)
* [Pull requests](/rust-lang/rust/pulls)
* [Actions](/rust-lang/rust/actions)
* [Projects](/rust-lang/rust/projects)
* [Security](/rust-lang/rust/security)
* [Insights](/rust-lang/rust/pulse)

# `std::process::Command` batch files argument escaping could be bypassed with trailing whitespace or periods

Low

[pietroalbini](/pietroalbini)
published
GHSA-2xg3-7mm6-98jj
Sep 4, 2024

## Package

cargo

std
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

< 1.81.0

## Patched versions

1.81.0

## Description

On April 9th, 2024, the Rust Security Response WG disclosed [CVE-2024-24576](https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html), where `std::process::Command` incorrectly escaped arguments when invoking batch files on Windows. We were notified that our fix for the vulnerability was incomplete, and it was possible to bypass the fix when the batch file name had trailing whitespace or periods (which are ignored and stripped by Windows).

The severity of the incomplete fix is **low**, due to the niche conditions needed to trigger it. Note that calculating the CVSS score might assign a higher severity to this, but that doesn't take into account what is required to trigger the incomplete fix.

The incomplete fix is identified by CVE-2024-43402.

## Overview

Refer to [the advisory for CVE-2024-24576](https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html) for details on the original vulnerability.

To determine whether to apply the `cmd.exe` escaping rules, the original fix for the vulnerability checked whether the command name ended with `.bat` or `.cmd`. At the time that seemed enough, as we refuse to invoke batch scripts with no file extension.

Unfortunately, [Windows removes trailing whitespace and periods](https://learn.microsoft.com/en-us/troubleshoot/windows-client/shell-experience/file-folder-name-whitespace-characters) when parsing file paths. For example, `.bat. .` is interpreted by Windows as `.bat`, but our original fix didn't check for that.

## Mitigations

If you are affected by this, and you are using Rust 1.77.2 or greater, you can remove the trailing whitespace (ASCII 0x20) and trailing periods (ASCII 0x2E) from the batch file name to bypass the incomplete fix and enable the mitigations.

Rust 1.81.0, due to be released on September 5th 2024, will update the standard library to apply the [CVE-2024-24576](https://blog.rust-lang.org/2024/04/09/cve-2024-24576.html) mitigations to all batch files invocations, regardless of the trailing chars in the file name.

## Affected versions

All Rust versions before 1.81.0 are affected, if your code or one of your dependencies invoke a batch script on Windows with trailing whitespace or trailing periods in the name, and pass untrusted arguments to it.

## Acknowledgements

We want to thank Kainan Zhang ([@4xpl0r3r](https://github.com/4xpl0r3r)) for responsibly disclosing this to us according to the [Rust security policy](https://www.rust-lang.org/policies/security).

We also want to thank the members of the Rust project who helped us disclose the incomplete fix: Chris Denton for developing the fix, Amanieu D'Antras for reviewing the fix; Pietro Albini for writing this advisory; Pietro Albini, Manish Goregaokar and Josh Stone for coordinating this disclosure.

### Severity

Low

### CVE ID

CVE-2024-43402

### Weaknesses

[CWE-78](/advisories?query=cwe%3A78) [CWE-88](/advisories?query=cwe%3A88)

### Credits

* [![@ChrisDenton](https://avatars.githubusercontent.com/u/4459874?s=40&v=4)](/ChrisDenton)
  [ChrisDenton](/ChrisDenton)
  Remediation developer
* [![@Amanieu](https://avatars.githubusercontent.com/u/278509?s=40&v=4)](/Amanieu)
  [Amanieu](/Amanieu)
  Remediation reviewer
* [![@pietroalbini](https://avatars.githubusercontent.com/u/2299951?s=40&v=4)](/pietroalbini)
  [pietroalbini](/pietroalbini)
  Coordinator
* [![@cuviper](https://avatars.githubusercontent.com/u/36186?s=40&v=4)](/cuviper)
  [cuviper](/cuviper)
  Coordinator
* [![@Manishearth](https://avatars.githubusercontent.com/u/1617736?s=40&v=4)](/Manishearth)
  [Manishearth](/Manishearth)
  Coordinator
* [![@4xpl0r3r](https://avatars.githubusercontent.com/u/20693041?s=40&v=4)](/4xpl0r3r)
  [4xpl0r3r](/4xpl0r3r)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.rust-lang.org_7588dd67_20250111_194512.html ===

[![Rust Logo](../../../images/rust-logo-blk.svg)
Rust Blog](../../../)

* [Rust](https://www.rust-lang.org)
* [Install](https://www.rust-lang.org/tools/install)
* [Learn](https://www.rust-lang.org/learn)
* [Tools](https://www.rust-lang.org/tools)
* [Governance](https://www.rust-lang.org/governance)
* [Community](https://www.rust-lang.org/community)
🖌

+ Light
+ Dark
+ System

## Security advisory for the standard library (CVE-2024-24576)

Apr. 9, 2024 · The Rust Security Response WG

The Rust Security Response WG was notified that the Rust standard library did
not properly escape arguments when invoking batch files (with the `bat` and
`cmd` extensions) on Windows using the [`Command`](https://doc.rust-lang.org/std/process/struct.Command.html) API. An attacker able to
control the arguments passed to the spawned process could execute arbitrary
shell commands by bypassing the escaping.

The severity of this vulnerability is **critical** if you are invoking batch
files on Windows with untrusted arguments. No other platform or use is
affected.

This vulnerability is identified by CVE-2024-24576.

## Overview

The [`Command::arg`](https://doc.rust-lang.org/std/process/struct.Command.html#method.arg) and [`Command::args`](https://doc.rust-lang.org/std/process/struct.Command.html#method.args) APIs state in their
documentation that the arguments will be passed to the spawned process as-is,
regardless of the content of the arguments, and will not be evaluated by a
shell. This means it should be safe to pass untrusted input as an argument.

On Windows, the implementation of this is more complex than other platforms,
because the Windows API only provides a single string containing all the
arguments to the spawned process, and it's up to the spawned process to split
them. Most programs use the standard C run-time argv, which in practice results
in a mostly consistent way arguments are splitted.

One exception though is `cmd.exe` (used among other things to execute batch
files), which has its own argument splitting logic. That forces the standard
library to implement custom escaping for arguments passed to batch files.
Unfortunately it was reported that our escaping logic was not thorough enough,
and it was possible to pass malicious arguments that would result in arbitrary
shell execution.

## Mitigations

Due to the complexity of `cmd.exe`, we didn't identify a solution that would
correctly escape arguments in all cases. To maintain our API guarantees, we
improved the robustness of the escaping code, and changed the `Command` API to
return an [`InvalidInput`](https://doc.rust-lang.org/std/io/enum.ErrorKind.html#variant.InvalidInput) error when it cannot safely escape an argument.
This error will be emitted when spawning the process.

The fix will be included in Rust 1.77.2, to be released later today.

If you implement the escaping yourself or only handle trusted inputs, on
Windows you can also use the [`CommandExt::raw_arg`](https://doc.rust-lang.org/std/os/windows/process/trait.CommandExt.html#tymethod.raw_arg) method to bypass the
standard library's escaping logic.

## Affected Versions

All Rust versions before 1.77.2 on Windows are affected, if your code or one of
your dependencies executes batch files with untrusted arguments. Other
platforms or other uses on Windows are not affected.

## Acknowledgments

We want to thank RyotaK for responsibly disclosing this to us according to the
[Rust security policy](https://www.rust-lang.org/policies/security), and Simon Sawicki (Grub4K) for identifying some of
the escaping rules we adopted in our fix.

We also want to thank the members of the Rust project who helped us disclose
the vulnerability: Chris Denton for developing the fix; Mara Bos for reviewing
the fix; Pietro Albini for writing this advisory; Pietro Albini, Manish
Goregaokar and Josh Stone for coordinating this disclosure; Amanieu d'Antras
for advising during the disclosure.

#### Get help!

* [Documentation](https://doc.rust-lang.org)
* Contact the Rust Team

#### Terms and policies

* [Code of Conduct](https://www.rust-lang.org/policies/code-of-conduct)
* [Licenses](https://www.rust-lang.org/policies/licenses)
* [Logo Policy and Media Guide](https://www.rust-lang.org/policies/media-guide)
* [Security Disclosures](https://www.rust-lang.org/policies/security)
* [All Policies](https://www.rust-lang.org/policies)

#### Social

[![mastodon logo](../../../images/mastodon.svg "Mastodon")](https://social.rust-lang.org/%40rust)
[![twitter logo](../../../images/twitter.svg "Twitter")](https://twitter.com/rustlang)
[![youtube logo](../../../images/youtube.svg "YouTube")](https://www.youtube.com/channel/UCaYhcUwRBNscFNUKTjgPFiA)
[![discord logo](../../../images/discord.svg "Discord")](https://discord.gg/rust-lang)
[![github logo](../../../images/github.svg "GitHub")](https://github.com/rust-lang)
#### RSS

* [Main Blog](../../../feed.xml)
* ["Inside Rust" Blog](../../../inside-rust/feed.xml)

Maintained by the Rust Team. See a typo?
[Send a fix here](https://github.com/rust-lang/blog.rust-lang.org)!


