

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19869)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19869)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19869](/browse/XWIKI-19869)

# Password reset stores passwords in plaintext

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19869 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [14.6-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.6-rc-1 "14.6-rc-1 "), [13.10.8](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+13.10.8 "13.10.8 "), [14.4.3](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.4.3 "14.4.3 ")
* **Affects Version/s:**
  13.1-rc-1
* **Component/s:**
  [Authentication](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+Authentication "Authentication ")
* **Labels:**
  + [attack\_dataleak](/issues/?jql=labels+%3D+attack_dataleak "attack_dataleak")
  + [attacker\_admin](/issues/?jql=labels+%3D+attacker_admin "attacker_admin")
  + [bugfixingday](/issues/?jql=labels+%3D+bugfixingday "bugfixingday")
  + [regression](/issues/?jql=labels+%3D+regression "regression")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Development Priority:**
  High
* **Difficulty:**
  Easy
* **Documentation:**
  <https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q2hm-2h45-v5g3>
* **Documentation in Release Notes:**
  <https://www.xwiki.org/xwiki/bin/view/ReleaseNotes/Data/XWiki/14.6RC1/#HMigrationsendingemails>
* **Similar issues:**

#### Description

Tested on 14.4.1 but according to github the current state is still affected.

When the the reset password form is used the new password is stored in plaintext.

xwiki-platform-core/xwiki-platform-security/xwiki-platform-security-authentication/xwiki-platform-security-authentication-default/src/main/java/org/xwiki/security/authentication/internal/DefaultResetPasswordManager.java - Line 317:

```

userXObject.setStringValue("password", newPassword);

```

After fixing this a migration will be needed to convert passwords that are currently stored in plaintext into hashes.

Furthermore, this indicates that the authentication check works against a stored plaintext password. This should not be possible.

#### Attachments

#### Issue Links

causes

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-20067](/browse/XWIKI-20067)
Misleading logs suggesting that the security mails about clear passwords were not sent

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19945](/browse/XWIKI-19945)
Reset password and forgot username features are not working for subwiki users

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-11205](/browse/XWIKI-11205)
If view rights are not allowed for guest users then ResetPassword doesn't work

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

#### Activity

#### People

Assignee:

![surli](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Simon Urli

Reporter:

![yoksner](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Yana Oksner

Votes:
0
Vote for this issue

Watchers:
3
Start watching this issue

#### Dates

Created:

23/Jun/22 13:37

Updated:

21/Nov/22 10:31

Resolved:

08/Jul/22 14:03

Date of First Response:

24/Jun/22 9:00 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

