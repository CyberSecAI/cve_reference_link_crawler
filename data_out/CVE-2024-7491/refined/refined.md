**Root cause of vulnerability:**
The vulnerability is due to a missing validation on the 'key' parameter within the `woof_messenger_remove_subscr` AJAX action. This allows attackers to unsubscribe users from product notifications by manipulating the 'key' value.

**Weaknesses/vulnerabilities present:**
- Insecure Direct Object Reference (IDOR): The lack of proper authorization checks on the 'key' parameter allows attackers to directly manipulate data (user subscriptions) by referencing the internal key.
- Missing authorization: The AJAX action `woof_messenger_remove_subscr` does not properly validate if the user making the request has the permission to unsubscribe the targeted user.
- Insufficient input validation: The 'key' parameter is sanitized with `sanitize_key` function but not validated against the user ID before unsubscription.

**Impact of exploitation:**
An authenticated attacker (with subscriber-level access or higher) can unsubscribe other users from product notification sign-ups. This can disrupt the notification service and potentially affect a large number of users who rely on those notifications.

**Attack vectors:**
- The attacker needs to send a crafted AJAX request to `woof_messenger_remove_subscr` action with the user ID and the targeted user's subscription 'key'.
- The attacker can try to brute-force the 'key' values, if they are not generated with sufficient randomness.

**Required attacker capabilities/position:**
- The attacker needs to be authenticated on the WordPress site with at least subscriber-level access.
- The Products Messenger extension of the plugin must be enabled on the WordPress site.
- The attacker needs to obtain or brute-force the key value associated with the user's subscription.

**Additional details from the provided content:**
- The vulnerability was discovered by shaman0x01 from Shaman Red Team.
- The vulnerability is fixed in version 1.3.6.2 and later.
- The fix includes an additional check in the  `woof_messenger_remove_subscr` function in `ext/products_messenger/index.php` to compare the current user's id to the `user_id` parameter in the request before proceeding with the unsubscription.
- The `readme.txt` and `index.php` files confirm the change in version number from 1.3.6.2 to 1.3.6.3, indicating a patch was released.