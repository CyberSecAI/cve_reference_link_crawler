The provided content describes a stored Cross-Site Scripting (XSS) vulnerability in ChurchCRM, leading to potential Remote File Inclusion (RFI).

**Root cause of vulnerability:**
- The application does not properly sanitize user input in the 'Deposit Comment' field within the 'Add new Deposit' module. This lack of input sanitization allows an attacker to inject malicious JavaScript code.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability: Malicious JavaScript code is stored in the database and executed when a user views the 'View All Deposits' page.
- Lack of input sanitization: The application fails to sanitize or encode user-provided input in the 'Deposit Comment' field.

**Impact of exploitation:**
- Cookie/session token hijacking: An attacker can steal user cookies or session tokens, allowing them to impersonate the user.
- User redirection: The attacker can redirect the user to a malicious website.
- Malicious file downloads: The attacker can force the user's browser to download malicious files from a remote server.
- Unintended browser actions: The attacker can perform various malicious actions in the context of the user's browser.

**Attack vectors:**
- The attacker injects malicious JavaScript code into the 'Deposit Comment' field when adding a new deposit.
- When another user views the 'View All Deposits' page, the stored JavaScript code is executed within the context of the user's browser.

**Required attacker capabilities/position:**
- The attacker needs to have an authenticated user account with the ability to add new deposits.
- No specific user privileges are mentioned beyond the ability to add deposits.
- The attacker needs to be able to access the application's interface.

**Additional details:**
- The vulnerability affects ChurchCRM version 4.2.1 and below.
- The provided payload demonstrates how to force a browser to download an executable file from a remote server.
- The vulnerability is present in multiple locations of the application beyond just the deposit module.
- The issue has been marked as `stale` and closed multiple times due to inactivity, then re-opened, and is currently in a `stale` state again.
- A suggested mitigation is to implement proper input validation and encoding.
- The issue is linked to another similar reported issue: #5478