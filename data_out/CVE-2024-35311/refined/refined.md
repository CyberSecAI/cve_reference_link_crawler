- **Root cause of vulnerability**: An issue in the RP (Relying Party) enumeration commands implementation in the YubiKey firmware allows an attacker to enumerate the relying parties for which a user has registered discoverable FIDO2 credentials without a user verification prompt. This bypasses the intended behavior where a PIN prompt should be required for such disclosure when using "userVerificationOptionalWithCredentialIDList" or "userVerificationRequired" credential protection policies.
- **Weaknesses/vulnerabilities present**: The vulnerability stems from a flaw in the firmware that doesn't enforce the user verification prompt when disclosing RP information for discoverable FIDO2 credentials.
- **Impact of exploitation**: An attacker with physical access to the YubiKey or local access to the user's computer or phone can discover a subset of the applications and services the user has registered with discoverable FIDO2 credentials on that YubiKey. This could lead to a privacy breach by revealing the user's online accounts linked to the key. It's important to note that it does not expose the credential or any other associated data on the secure element itself. The impact is limited to applications and services using FIDO2 discoverable credentials.
- **Attack vectors**: Physical access to the YubiKey or local access to the user's computer or phone.
- **Required attacker capabilities/position**: Requires physical possession of the YubiKey or local access to the user's system where the YubiKey is used. The attacker must have the ability to programmatically interact with the YubiKey to exploit the vulnerability.