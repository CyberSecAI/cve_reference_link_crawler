[![Tomcat Home](res/images/tomcat.png)](http://tomcat.apache.org/)
# Apache Tomcat®

[![Support Apache](https://www.apache.org/images/SupportApache-small.png)](https://www.apache.org/foundation/contributing.html)[![The Apache Software Foundation](res/images/asf_logo.svg)](http://www.apache.org/)GO
## Apache Tomcat

* [Home](./index.html)
* [Taglibs](./taglibs.html)
* [Maven Plugin](./maven-plugin.html)
## Download

* [Which version?](./whichversion.html)
* [Tomcat 11](https://tomcat.apache.org/download-11.cgi)
* [Tomcat 10](https://tomcat.apache.org/download-10.cgi)
* [Tomcat 9](https://tomcat.apache.org/download-90.cgi)
* [Tomcat Migration Tool for Jakarta EE](https://tomcat.apache.org/download-migration.cgi)
* [Tomcat Connectors](https://tomcat.apache.org/download-connectors.cgi)
* [Tomcat Native](https://tomcat.apache.org/download-native.cgi)
* [Taglibs](https://tomcat.apache.org/download-taglibs.cgi)
* [Archives](https://archive.apache.org/dist/tomcat/)
## Documentation

* [Tomcat 11.0](./tomcat-11.0-doc/index.html)
* [Tomcat 10.1](./tomcat-10.1-doc/index.html)
* [Tomcat 9.0](./tomcat-9.0-doc/index.html)
* [Upgrading](./upgrading.html)
* [Tomcat Connectors](./connectors-doc/index.html)
* [Tomcat Native 2](./native-doc/index.html)
* [Tomcat Native 1.3](./native-1.3-doc/index.html)
* [Wiki](https://cwiki.apache.org/confluence/display/TOMCAT)
* [Migration Guide](./migration.html)
* [Presentations](./presentations.html)
* [Specifications](https://cwiki.apache.org/confluence/x/Bi8lBg)
## Problems?

* [Security Reports](./security.html)
* [Find help](./findhelp.html)
* [FAQ](https://cwiki.apache.org/confluence/display/TOMCAT/FAQ)
* [Mailing Lists](./lists.html)
* [Bug Database](./bugreport.html)
* [IRC](./irc.html)
## Get Involved

* [Overview](./getinvolved.html)
* [Source code](./source.html)
* [Buildbot](./ci.html)
* [Tools](./tools.html)
## Media

* [Twitter](https://twitter.com/theapachetomcat)
* [YouTube](https://www.youtube.com/c/ApacheTomcatOfficial)
* [Blog](https://blogs.apache.org/tomcat/)
## Misc

* [Who We Are](./whoweare.html)
* [Swag](https://www.redbubble.com/people/comdev/works/30885254-apache-tomcat)
* [Heritage](./heritage.html)
* [Apache Home](http://www.apache.org)
* [Resources](./resources.html)
* [Contact](./contact.html)
* [Legal](./legal.html)
* [Privacy](https://privacy.apache.org/policies/privacy-policy-public.html)
* [Support Apache](https://www.apache.org/foundation/contributing.html)
* [Sponsorship](https://www.apache.org/foundation/sponsorship.html)
* [Thanks](http://www.apache.org/foundation/thanks.html)
* [License](http://www.apache.org/licenses/)
## Content

### Apache Tomcat 9.x vulnerabilities

This page lists all security vulnerabilities fixed in released versions
of Apache Tomcat® 9.x. Each vulnerability is given a
[security impact rating](security-impact.html) by the Apache
Tomcat security team — please note that this rating may vary from
platform to platform. We also list the versions of Apache Tomcat the flaw
is known to affect, and where a flaw has not been verified list the
version with a question mark.

**Note:** Vulnerabilities that are not Tomcat vulnerabilities
but have either been incorrectly reported against Tomcat or where Tomcat
provides a workaround are listed at the end of this page.

Please note that binary patches are never provided. If you need to
apply a source code patch, use the building instructions for the
Apache Tomcat version that you are using. For Tomcat 9.0 those are
[`building.html`](/tomcat-9.0-doc/building.html) and
[`BUILDING.txt`](/tomcat-9.0-doc/BUILDING.txt).
Both files can be found in the `webapps/docs` subdirectory
of a binary distribution. You may also want to review the
[Security Considerations](/tomcat-9.0-doc/security-howto.html)
page in the documentation.

If you need help on building or configuring Tomcat or other help on
following the instructions to mitigate the known vulnerabilities listed
here, please send your questions to the public
[Tomcat Users mailing list](lists.html)

If you have encountered an unlisted security vulnerability or other
unexpected behaviour that has [security
impact](security-impact.html), or if the descriptions here are incomplete,
please report them privately to the
[Tomcat Security Team](security.html). Thank you.

### Table of Contents

* [Fixed in Apache Tomcat 9.0.98](#Fixed_in_Apache_Tomcat_9.0.98)
* [Fixed in Apache Tomcat 9.0.97](#Fixed_in_Apache_Tomcat_9.0.97)
* [Fixed in Apache Tomcat 9.0.96](#Fixed_in_Apache_Tomcat_9.0.96)
* [Fixed in Apache Tomcat 9.0.90](#Fixed_in_Apache_Tomcat_9.0.90)
* [Fixed in Apache Tomcat 9.0.86](#Fixed_in_Apache_Tomcat_9.0.86)
* [Fixed in Apache Tomcat 9.0.83](#Fixed_in_Apache_Tomcat_9.0.83)
* [Fixed in Apache Tomcat 9.0.81](#Fixed_in_Apache_Tomcat_9.0.81)
* [Fixed in Apache Tomcat 9.0.80](#Fixed_in_Apache_Tomcat_9.0.80)
* [Fixed in Apache Tomcat 9.0.75](#Fixed_in_Apache_Tomcat_9.0.75)
* [Fixed in Apache Tomcat 9.0.74](#Fixed_in_Apache_Tomcat_9.0.74)
* [Fixed in Apache Tomcat 9.0.72](#Fixed_in_Apache_Tomcat_9.0.72)
* [Fixed in Apache Tomcat 9.0.71](#Fixed_in_Apache_Tomcat_9.0.71)
* [Fixed in Apache Tomcat 9.0.69](#Fixed_in_Apache_Tomcat_9.0.69)
* [Fixed in Apache Tomcat 9.0.68](#Fixed_in_Apache_Tomcat_9.0.68)
* [Fixed in Apache Tomcat 9.0.65](#Fixed_in_Apache_Tomcat_9.0.65)
* [Fixed in Apache Tomcat 9.0.63](#Fixed_in_Apache_Tomcat_9.0.63)
* [Fixed in Apache Tomcat 9.0.62](#Fixed_in_Apache_Tomcat_9.0.62)
* [Fixed in Apache Tomcat 9.0.58](#Fixed_in_Apache_Tomcat_9.0.58)
* [Fixed in Apache Tomcat 9.0.54](#Fixed_in_Apache_Tomcat_9.0.54)
* [Fixed in Apache Tomcat 9.0.48](#Fixed_in_Apache_Tomcat_9.0.48)
* [Fixed in Apache Tomcat 9.0.46](#Fixed_in_Apache_Tomcat_9.0.46)
* [Fixed in Apache Tomcat 9.0.45](#Fixed_in_Apache_Tomcat_9.0.45)
* [Fixed in Apache Tomcat 9.0.44](#Fixed_in_Apache_Tomcat_9.0.44)
* [Fixed in Apache Tomcat 9.0.43](#Fixed_in_Apache_Tomcat_9.0.43)
* [Fixed in Apache Tomcat 9.0.40](#Fixed_in_Apache_Tomcat_9.0.40)
* [Fixed in Apache Tomcat 9.0.38](#Fixed_in_Apache_Tomcat_9.0.38)
* [Fixed in Apache Tomcat 9.0.37](#Fixed_in_Apache_Tomcat_9.0.37)
* [Fixed in Apache Tomcat 9.0.36](#Fixed_in_Apache_Tomcat_9.0.36)
* [Fixed in Apache Tomcat 9.0.35](#Fixed_in_Apache_Tomcat_9.0.35)
* [Fixed in Apache Tomcat 9.0.31](#Fixed_in_Apache_Tomcat_9.0.31)
* [Fixed in Apache Tomcat 9.0.30](#Fixed_in_Apache_Tomcat_9.0.30)
* [Fixed in Apache Tomcat 9.0.29](#Fixed_in_Apache_Tomcat_9.0.29)
* [Fixed in Apache Tomcat 9.0.21](#Fixed_in_Apache_Tomcat_9.0.21)
* [Fixed in Apache Tomcat 9.0.20](#Fixed_in_Apache_Tomcat_9.0.20)
* [Fixed in Apache Tomcat 9.0.19](#Fixed_in_Apache_Tomcat_9.0.19)
* [Fixed in Apache Tomcat 9.0.16](#Fixed_in_Apache_Tomcat_9.0.16)
* [Fixed in Apache Tomcat 9.0.12](#Fixed_in_Apache_Tomcat_9.0.12)
* [Fixed in Apache Tomcat 9.0.10](#Fixed_in_Apache_Tomcat_9.0.10)
* [Fixed in Apache Tomcat 9.0.9](#Fixed_in_Apache_Tomcat_9.0.9)
* [Fixed in Apache Tomcat 9.0.8](#Fixed_in_Apache_Tomcat_9.0.8)
* [Fixed in Apache Tomcat 9.0.5](#Fixed_in_Apache_Tomcat_9.0.5)
* [Fixed in Apache Tomcat 9.0.2](#Fixed_in_Apache_Tomcat_9.0.2)
* [Fixed in Apache Tomcat 9.0.1](#Fixed_in_Apache_Tomcat_9.0.1)
* [Fixed in Apache Tomcat 9.0.0.M22](#Fixed_in_Apache_Tomcat_9.0.0.M22)
* [Fixed in Apache Tomcat 9.0.0.M21](#Fixed_in_Apache_Tomcat_9.0.0.M21)
* [Fixed in Apache Tomcat 9.0.0.M19](#Fixed_in_Apache_Tomcat_9.0.0.M19)
* [Fixed in Apache Tomcat 9.0.0.M18](#Fixed_in_Apache_Tomcat_9.0.0.M18)
* [Fixed in Apache Tomcat 9.0.0.M17](#Fixed_in_Apache_Tomcat_9.0.0.M17)
* [Fixed in Apache Tomcat 9.0.0.M15](#Fixed_in_Apache_Tomcat_9.0.0.M15)
* [Fixed in Apache Tomcat 9.0.0.M13](#Fixed_in_Apache_Tomcat_9.0.0.M13)
* [Fixed in Apache Tomcat 9.0.0.M10](#Fixed_in_Apache_Tomcat_9.0.0.M10)
* [Fixed in Apache Tomcat 9.0.0.M8](#Fixed_in_Apache_Tomcat_9.0.0.M8)
* [Fixed in Apache Tomcat 9.0.0.M3](#Fixed_in_Apache_Tomcat_9.0.0.M3)
* [Not a vulnerability in Tomcat](#Not_a_vulnerability_in_Tomcat)
### 2024-12-09 Fixed in Apache Tomcat 9.0.98

**Important: Remote Code Execution via write enabled Default
Servlet. Mitigation for CVE-2024-50379 was incomplete -**
[CVE-2024-56337](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-56337)

The previous mitigation for [CVE-2024-50379](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50379) was incomplete. In
addition to upgrading to 9.0.98 or later, users running Tomcat on a case
insensitive file system with the default servlet write enabled may need
additional configuration depending on the version of Java being used:

* running on Java 8 or Java 11: the system property
  `sun.io.useCanonCaches` must be explicitly set to
  `false` (it defaults to `true`)
* running on Java 17: the system property
  `sun.io.useCanonCaches`, if set, must be set to
  `false` (it defaults to `false`)
* running on Java 21 onwards: no further configuration is required (the
  system property and the problematic cache have been removed)

The issue was made public on 20 December 2024.

Affects: 9.0.0.M1 to 9.0.97

**Low: DoS in examples web application**
[CVE-2024-54677](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-54677)

Numerous examples in the examples web application did not place limits on
uploaded data enabling an OutOfMemoryError to be triggered causing a
denial of service.

This was fixed with commits
[1d88dd3f](https://github.com/apache/tomcat/commit/1d88dd3ffaed76188dd4ee32ce77709ce6e153cd),
[721544ea](https://github.com/apache/tomcat/commit/721544ea28e92549824b106be954a9f411867a1c),
[84065e26](https://github.com/apache/tomcat/commit/84065e26ca4555e63a922bb29b13b0a1c86b7654),
[3315a902](https://github.com/apache/tomcat/commit/3315a9027a7eaab18f42625b97b569940ff1365d),
[c2f7ce21](https://github.com/apache/tomcat/commit/c2f7ce21c3fb12caefee87c517a8bb4f80700044),
[75ff7e86](https://github.com/apache/tomcat/commit/75ff7e8622edcc024b268677aa789ee8f0880ecc),
[4d5cc653](https://github.com/apache/tomcat/commit/4d5cc6538d91386f950373ac8120e98c2c78ed3a),
[84c4af76](https://github.com/apache/tomcat/commit/84c4af76e7a10fc7f8630ce62e6a46632ea4a90e) and
[9ffd23fc](https://github.com/apache/tomcat/commit/9ffd23fc27f5d1fc95bf97e5cea175c8968f4533).

The issue was made public on 17 December 2024.

Affects: 9.0.0.M1 to 9.0.97

**Important: Remote Code Execution via write enabled Default Servlet**
[CVE-2024-50379](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50379)

If the default servlet is write enabled (`readonly`
initialisation parameter set to the non-default value of
`false`) for a case insensitive file system, concurrent read
and upload under load of the same file can bypass Tomcat's case
sensitivity checks and cause an uploaded file to be treated as a JSP
leading to remote code execution.

This was fixed with commits
[43b507eb](https://github.com/apache/tomcat/commit/43b507ebac9d268b1ea3d908e296cc6e46795c00) and
[631500b0](https://github.com/apache/tomcat/commit/631500b0c9b2a2a2abb707e3de2e10a5936e5d41).

The issue was made public on 17 December 2024.

Affects: 9.0.0.M1 to 9.0.97

### 2024-11-09 Fixed in Apache Tomcat 9.0.97

**Important: XSS in generated JSPs**
[CVE-2024-52318](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-52318)

The fix for improvement [69333](https://bz.apache.org/bugzilla/show_bug.cgi?id=69333) caused pooled JSP tags not to be
released after use which in turn could cause output of some tags not to
escaped as expected. This unescaped output could lead to XSS.

This was fixed with commit
[9813c5dd](https://github.com/apache/tomcat/commit/9813c5dd3259183f659bbb83312a5cf673cc1ebf).

The issue was made public on 18 November 2024.

Affects: 9.0.96

### 2024-10-09 Fixed in Apache Tomcat 9.0.96

**Important: Request and/or response mix-up**
[CVE-2024-52317](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-52317)

Incorrect recycling of the request and response used by HTTP/2 requests
could lead to request and/or response mix-up between users.

This was fixed with commit
[47307ee2](https://github.com/apache/tomcat/commit/47307ee27abcdea2ee40e33897aca760083de46a).

This issue was identified by the Tomcat Security Team on 1 October 2024.
The issue was made public on 18 November 2024.

Affects: 9.0.92 to 9.0.95

**Low: Authentication Bypass**
[CVE-2024-52316](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-52316)

If Tomcat was configured to use a custom Jakarta Authentication (formerly
JASPIC) ServerAuthContext component which may throw an exception during
the authentication process without explicitly setting an HTTP status to
indicate failure, the authentication may not have failed, allowing the
user to bypass the authentication process. There are no known Jakarta
Authentication components that behave in this way.

This was fixed with commit
[7532f9dc](https://github.com/apache/tomcat/commit/7532f9dc4a8c37ec958f79dc82c4924a6c539223).

This issue was identified by the Tomcat Security Team on 19 September
2024. The issue was made public on 18 November 2024.

Affects: 9.0.0-M1 to 9.0.95

### 2024-06-19 Fixed in Apache Tomcat 9.0.90

**Important: Denial of Service**
[CVE-2024-34750](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-34750)

When processing an HTTP/2 stream, Tomcat did not handle some cases of
excessive HTTP headers correctly. This led to a miscounting of active
HTTP/2 streams which in turn led to the use of an incorrect infinite
timeout which allowed connections to remain open which should have been
closed.

This was fixed with commit
[9fec9a82](https://github.com/apache/tomcat/commit/9fec9a82887853402833a80b584e3762c7423f5f).

This issue was reported to the Tomcat Security Team on 4 May 2024. The
issue was made public on 3 July 2024.

Affects: 9.0.0-M1 to 9.0.89

**Important: Denial of Service**
[CVE-2024-38286](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-38286)

Tomcat, under certain configurations on any platform, allows an attacker
to cause an OutOfMemoryError by abusing the TLS handshake process.

This was fixed with commit
[76c5cce6](https://github.com/apache/tomcat/commit/76c5cce6f0bcef14b0c21c38910371ca7d322d13).

This issue was reported to the Tomcat Security Team on 4 June 2024. The
issue was made public on 23 September 2024.

Affects: 9.0.13 to 9.0.89

### 2024-02-19 Fixed in Apache Tomcat 9.0.86

**Important: Denial of Service**
[CVE-2024-23672](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-23672)

It was possible for a WebSocket client to keep a WebSocket connection
open leading to increased resource consumption.

This was fixed with commit
[52d6650e](https://github.com/apache/tomcat/commit/52d6650e062d880704898d7d8c1b2b7a3efe8068).

This issue was identified by the Tomcat Security Team on 17 January 2024.
The issue was made public on 13 March 2024.

Affects: 9.0.0-M1 to 9.0.85

**Important: Denial of Service**
[CVE-2024-24549](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-24549)

When processing an HTTP/2 request, if the request exceeded any of the
configured limits for headers, the associated HTTP/2 stream was not reset
until after all of the headers had been processed.

This was fixed with commit
[8e03be9f](https://github.com/apache/tomcat/commit/8e03be9f2698f2da9027d40b9e9c0c9429b74dc0).

This issue was reported to the Tomcat Security Team on 24 January 2024. The
issue was made public on 13 March 2024.

Affects: 9.0.0-M1 to 9.0.85

### 2023-11-15 Fixed in Apache Tomcat 9.0.83

**Important: Request smuggling**
[CVE-2023-46589](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46589)

Tomcat did not correctly parse HTTP trailer headers. A specially crafted
trailer header that exceeded the header size limit could cause Tomcat to
treat a single request as multiple requests leading to the possibility of
request smuggling when behind a reverse proxy.

This was fixed with commit
[7a2d8818](https://github.com/apache/tomcat/commit/7a2d8818fcea0b51747a67af9510ce7977245ebd).

This issue was reported to the Tomcat Security Team on 20 October 2023.
The issue was made public on 28 November 2023.

Affects: 9.0.0-M1 to 9.0.82

### 2023-10-10 Fixed in Apache Tomcat 9.0.81

**Important: Request smuggling**
[CVE-2023-45648](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45648)

Tomcat did not correctly parse HTTP trailer headers. A specially crafted,
invalid trailer header could cause Tomcat to treat a single request as
multiple requests leading to the possibility of request smuggling when
behind a reverse proxy.

This was fixed with commit
[59583245](https://github.com/apache/tomcat/commit/59583245639d8c42ae0009f4a4a70464d3ea70a0).

This issue was reported to the Tomcat Security Team on 12 September 2023.
The issue was made public on 10 October 2023.

Affects: 9.0.0-M1 to 9.0.80

**Important: Denial of Service**
[CVE-2023-44487](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-44487)

Tomcat's HTTP/2 implementation was vulnerable to the rapid reset
attack. The denial of service typically manifested as an
`OutOfMemoryError`.

This was fixed with commit
[6d1a9fd6](https://github.com/apache/tomcat/commit/6d1a9fd6642387969e4410b9989c85856b74917a).

This issue was reported to the Tomcat Security Team on 14 September 2023.
The issue was made public on 10 October 2023.

Affects: 9.0.0-M1 to 9.0.80

**Important: Information Disclosure**
[CVE-2023-42795](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42795)

When recycling various internal objects, including the request and the
response, prior to re-use by the next request/response, an error could
cause Tomcat to skip some parts of the recycling process leading to
information leaking from the current request/response to the next.

This was fixed with commit
[44d05d75](https://github.com/apache/tomcat/commit/44d05d75d696ca10ce251e4e370511e38f20ae75).

This issue was identified by the Tomcat Security Team on 13 September
2023. The issue was made public on 10 October 2023.

Affects: 9.0.0-M1 to 9.0.80

**Low: Denial of Service**
[CVE-2023-42794](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42794)

Tomcat's internal fork of a Commons FileUpload included an unreleased, in
progress refactoring that exposed a potential denial of service on
Windows if a web application opened a stream for an uploaded file but
failed to close the stream. The file would never be deleted from disk
creating the possibility of an eventual denial of service due to the disk
being full.

This was fixed with commit
[43b882b8](https://github.com/apache/tomcat/commit/43b882b8a577684498ab9b8851aa0427216784f7).

This issue was reported to the Tomcat Security Team on 1 September
2023. The issue was made public on 10 October 2023.

Affects: 9.0.70 to 9.0.80

### 2023-08-25 Fixed in Apache Tomcat 9.0.80

**Moderate: Open redirect**
[CVE-2023-41080](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41080)

If the ROOT (default) web application is configured to use FORM
authentication then it is possible that a specially crafted URL could be
used to trigger a redirect to an URL of the attackers choice.

This was fixed with commit
[77c0ce2d](https://github.com/apache/tomcat/commit/77c0ce2d169efa248b64b992e547aad549ec906b).

This issue was reported to the Tomcat Security Team on 17 August 2023. The
issue was made public on 22 August 2023.

Affects: 9.0.0-M1 to 9.0.79

### 2023-05-10 Fixed in Apache Tomcat 9.0.75

**Important: Information disclosure**
[CVE-2023-34981](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-34981)

The fix for bug [66512](https://bz.apache.org/bugzilla/show_bug.cgi?id=66512) introduced a regression that was fixed
as bug [66591](https://bz.apache.org/bugzilla/show_bug.cgi?id=66591). The regression meant that, if a response did not
have any HTTP headers set, no AJP `SEND_HEADERS` message would
be sent which in turn meant that at least one AJP based proxy
(mod\_proxy\_ajp) would use the response headers from the previous request
for the current request leading to an information leak.

This was fixed with commit
[2f0ca237](https://github.com/apache/tomcat/commit/2f0ca2378415f4cf0748f4bc8fa955f41f803fa5).

This issue was reported to the Tomcat Security Team on 24 May 2023. The
issue was made public on 21 June 2023.

Affects: 9.0.74

### 2023-04-18 Fixed in Apache Tomcat 9.0.74

**Moderate: Apache Tomcat denial of service**
[CVE-2023-28709](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-28709)

The fix for [CVE-2023-24998](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-24998) was incomplete. If non-default HTTP
connector settings were used such that the `maxParameterCount`
could be reached using query string parameters and a request was
submitted that supplied exactly `maxParameterCount` parameters
in the query string, the limit for uploaded request parts could be
bypassed with the potential for a denial of service to occur.

This was fixed with commit
[fbd81421](https://github.com/apache/tomcat/commit/fbd81421629afe8b8a3922d59020cde81caea861).

This issue was reported to the Tomcat Security Team on 13 March 2023. The
issue was made public on 22 May 2023.

Affects: 9.0.71 to 9.0.73

### 2023-02-23 Fixed in Apache Tomcat 9.0.72

**Important: Apache Tomcat information disclosure**
[CVE-2023-28708](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-28708)

When using the `RemoteIpFilter` with requests received from a
reverse proxy via HTTP that include the `X-Forwarded-Proto`
header set to `https`, session cookies created by Tomcat did not
include the secure attribute. This could result in the user agent
transmitting the session cookie over an insecure channel.

This was fixed with commit
[3b512307](https://github.com/apache/tomcat/commit/3b51230764da595bb19e8d0962dd8c69ab40dfab).

[66471](https://bz.apache.org/bugzilla/show_bug.cgi?id=66471) was reported publicly on 8 February 2023. The security
implications were identified by the Tomcat Security team on 9 February
2023. The issue was made public on 22 March 2023.

Affects: 9.0.0-M1 to 9.0.71

### 2023-01-13 Fixed in Apache Tomcat 9.0.71

**Important: Apache Tomcat denial of service**
[CVE-2023-24998](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-24998)

Apache Tomcat uses a packaged renamed copy of Apache Commons FileUpload
to provide the file upload functionality defined in the Jakarta Servlet
specification. Apache Tomcat was, therefore, also vulnerable to the
Apache Commons FileUpload vulnerability [CVE-2023-24998](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-24998) as
there was no limit to the number of request parts processed. This
resulted in the possibility of an attacker triggering a DoS with a
malicious upload or series of uploads.

This was fixed with commit
[cf77cc54](https://github.com/apache/tomcat/commit/cf77cc545de0488fb89e24294151504a7432df74).

This issue was reported to the Apache Tomcat Security team on 11
December 2022. The issue was made public on 20 February 2023.

Affects: 9.0.0-M1 to 9.0.70

### 2022-11-14 Fixed in Apache Tomcat 9.0.69

**Low: Apache Tomcat JsonErrorReportValve injection**
[CVE-2022-45143](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-45143)

The `JsonErrorReportValve` did not escape the
`type`, `message` or `description`
values. In some circumstances these are constructed from user provided
data and it was therefore possible for users to supply values that
invalidated or manipulated the JSON output.

This was fixed with commit
[b336f4e5](https://github.com/apache/tomcat/commit/b336f4e58893ea35114f1e4a415657f723b1298e).

This issue was identified by the Apache Tomcat Security team on 2
September 2022. The issue was made public on 3 January 2023.

Affects: 9.0.40 to 9.0.68

### 2022-10-07 Fixed in Apache Tomcat 9.0.68

**Low: Apache Tomcat request smuggling**
[CVE-2022-42252](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-42252)

If Tomcat was configured to ignore invalid HTTP headers via setting
`rejectIllegalHeader` to `false` (not the default),
Tomcat did not reject a request containing an invalid
`Content-Length` header making a request smuggling attack
possible if Tomcat was located behind a reverse proxy that also failed to
reject the request with the invalid header.

This was fixed with commit
[4c7f4fd0](https://github.com/apache/tomcat/commit/4c7f4fd09d2cc1692112ef70b8ee23a7a037ae77).

This issue was reported to the Apache Tomcat Security team on 29
September 2022. The issue was made public on 31 October 2022.

Affects: 9.0.0-M1 to 9.0.67

### 2022-07-20 Fixed in Apache Tomcat 9.0.65

**Low: Apache Tomcat XSS in examples web application**
[CVE-2022-34305](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34305)

The Form authentication example in the examples web application displayed
user provided data without filtering, exposing a XSS vulnerability.

This was fixed with commit
[8b60af90](https://github.com/apache/tomcat/commit/8b60af90b99945379c2d1003277e0cabc6776bac).

This issue was reported to the Apache Tomcat Security team on 22 June
2022. The issue was made public on 23 June 2022.

Affects: 9.0.30 to 9.0.64

### 2022-05-16 Fixed in Apache Tomcat 9.0.63

**Low: Apache Tomcat EncryptInterceptor DoS**
[CVE-2022-29885](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29885)

The documentation for the EncryptInterceptor incorrectly stated it
enabled Tomcat clustering to run over an untrusted network. This was not
correct. While the EncryptInterceptor does provide confidentiality and
integrity protection, it does not protect against all risks associated
with running over any untrusted network, particularly DoS risks.

This was fixed with commit
[eaafd282](https://github.com/apache/tomcat/commit/eaafd28296c54d983e28a47953c1f5cb2c334f48).

This issue was reported to the Apache Tomcat Security team by 4ra1n on 17
April 2022. The issue was made public on 10 May 2022.

Affects: 9.0.13 to 9.0.62

### 1 April 2022 Fixed in Apache Tomcat 9.0.62

*Note: The issue below was fixed in Apache Tomcat 9.0.61 but the
release vote for the 9.0.61 release candidate did not pass. Therefore,
although users must download 9.0.62 to obtain a version that includes a
fix for these issues, version 9.0.61 is not included in the list of
affected versions.*

**High: Information Disclosure**
[CVE-2021-43980](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43980)

The simplified implementation of blocking reads and writes introduced in
Tomcat 10 and back-ported to Tomcat 9.0.47 onwards exposed a long
standing (but extremely hard to trigger) concurrency bug that could cause
client connections to share an Http11Processor instance resulting in
responses, or part responses, to be received by the wrong client.

This was fixed with commit
[170e0f79](https://github.com/apache/tomcat/commit/170e0f792bd18ff031677890ba2fe50eb7a376c1).

This issue was reported to the Apache Tomcat Security team by Adam
Thomas, Richard Hernandez and Ryan Schmitt on 11 November 2021. The issue
was made public on 28 September 2022.

Affects: 9.0.0-M1 to 9.0.60

### 20 January 2022 Fixed in Apache Tomcat 9.0.58

*Note: The issue below was fixed in Apache Tomcat 9.0.57 but the
release vote for the 9.0.57 release candidate did not pass. Therefore,
although users must download 9.0.58 to obtain a version that includes a
fix for these issues, version 9.0.57 is not included in the list of
affected versions.*

**Low: Local Privilege Escalation**
[CVE-2022-23181](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23181)

The fix for bug [CVE-2020-9484](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9484) introduced a time of check, time
of use vulnerability that allowed a local attacker to perform actions
with the privileges of the user that the Tomcat process is using. This
issue is only exploitable when Tomcat is configured to persist sessions
using the FileStore.

This was fixed with commit
[1385c624](https://github.com/apache/tomcat/commit/1385c624b4a1e994426e810075c850edc38a700e).

This issue was reported to the Apache Tomcat Security team by Trung Pham
of Viettel Cyber Security on 10 December 2021. The issue was made public
on 26 January 2022.

Affects: 9.0.35 to 9.0.56

### 1 October 2021 Fixed in Apache Tomcat 9.0.54

**Important: Denial of Service**
[CVE-2021-42340](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42340)

The fix for bug [63362](https://bz.apache.org/bugzilla/show_bug.cgi?id=63362) introduced a memory leak. The object
introduced to collect metrics for HTTP upgrade connections was not
released for WebSocket connections once the WebSocket connection was
closed. This created a memory leak that, over time, could lead to a
denial of service via an OutOfMemoryError.

This was fixed with commit
[80f1438e](https://github.com/apache/tomcat/commit/80f1438ec45e77a07b96419808971838d259eb47).

The memory leak was reported publicly via the users mailing list on 23
September 2021. The security implications were identified by the Tomcat
Security team the same day. The issue was made public on 14 October
2021.

Affects: 9.0.40 to 9.0.53

### 15 June 2021 Fixed in Apache Tomcat 9.0.48

*Note: The issue below was fixed in Apache Tomcat 9.0.47 but the
release vote for the 9.0.47 release candidate did not pass. Therefore,
although users must download 9.0.48 to obtain a version that includes a
fix for this issue, version 9.0.47 is not included in the list of
affected versions.*

**Important: Request Smuggling**
[CVE-2021-33037](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33037)

Apache Tomcat did not correctly parse the HTTP transfer-encoding request
header in some circumstances leading to the possibility of request
smuggling when used with a reverse proxy. Specifically: Tomcat
incorrectly ignored the transfer-encoding header if the client declared
it would only accept an HTTP/1.0 response; Tomcat honoured the identify
encoding; and Tomcat did not ensure that, if present, the chunked
encoding was the final encoding.

This was fixed with commits
[45d70a86](https://github.com/apache/tomcat/commit/45d70a86a901cbd534f8f570bed2aec9f7f7b88e),
[05f9e8b0](https://github.com/apache/tomcat/commit/05f9e8b00f5d9251fcd3c95dcfd6cf84177f46c8) and
[a2c3dc4c](https://github.com/apache/tomcat/commit/a2c3dc4c96168743ac0bab613709a5bbdaec41d0).

This issue was reported to the Apache Tomcat Security team by Bahruz
Jabiyev, Steven Sprecher and Kaan Onarlioglu of NEU seclab on 7 May 2021.
The issue was made public on 12 July 2021.

Affects: 9.0.0.M1 to 9.0.46

### 12 May 2021 Fixed in Apache Tomcat 9.0.46

**Low: Authentication weakness**
[CVE-2021-30640](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-30640)

Queries made by the JNDI Realm did not always correctly escape
parameters. Parameter values could be sourced from user provided data (eg
user names) as well as configuration data provided by an administrator.
In limited circumstances it was possible for users to authenticate using
variations of their user name and/or to bypass some of the protection
provided by the LockOut Realm.

This was fixed with commits
[c4df8d44](https://github.com/apache/tomcat/commit/c4df8d44a959a937d507d15e5b1ca35c3dbc41eb),
[749f3cc1](https://github.com/apache/tomcat/commit/749f3cc192c68c34f2375509aea087be45fc4434),
[c6b6e101](https://github.com/apache/tomcat/commit/c6b6e1015ae44c936971b6bf8bce70987935b92e),
[91ecdc61](https://github.com/apache/tomcat/commit/91ecdc61ce3420054c04114baaaf1c1e0cbd5d56),
[e5006748](https://github.com/apache/tomcat/commit/e50067486cf86564175ca0cfdcbf7d209c6df862),
[b5585a9e](https://github.com/apache/tomcat/commit/b5585a9e5d4fec020cc5ebadb82f899fae22bc43),
[32993201](https://github.com/apache/tomcat/commit/329932012d3a9b95fde0b18618416e659ecffdc0) and
[3ce84512](https://github.com/apache/tomcat/commit/3ce84512ed8783577d9945df28da5a033465b945).

This issue was reported publicly as [65224](https://bz.apache.org/bugzilla/show_bug.cgi?id=65224).

Affects: 9.0.0.M1 to 9.0.45

### 6 April 2021 Fixed in Apache Tomcat 9.0.45

**Important: Denial of Service**
[CVE-2021-30639](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-30639)

An error introduced as part of a change to improve error handling during
non-blocking I/O meant that the error flag associated with the Request
object was not reset between requests. This meant that once a
non-blocking I/O error occurred, all future requests handled by that
request object would fail. Users were able to trigger non-blocking I/O
errors, e.g. by dropping a connection, thereby creating the possibility
of triggering a DoS.

Applications that do not use non-blocking I/O are not exposed to this
vulnerability.

This was fixed with commit
[8ece47c4](https://github.com/apache/tomcat/commit/8ece47c4a9fb9349e8862c84358a4dd23c643a24).

This issue was reported publicly as [65203](https://bz.apache.org/bugzilla/show_bug.cgi?id=65203).

Affects: 9.0.44

### 10 March 2021 Fixed in Apache Tomcat 9.0.44

**Important: Denial of Service**
[CVE-2021-41079](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41079)

When Tomcat was configured to use NIO+OpenSSL or NIO2+OpenSSL for TLS, a
specially crafted packet could be used to trigger an infinite loop
resulting in a denial of service.

This was fixed with commit
[d4b340fa](https://github.com/apache/tomcat/commit/d4b340fa8feaf55831f9a59350578f7b6ca048b8).

This issue was first reported to the Apache Tomcat Security Team by
Thomas Wozenilek on 26 February 2021 but could not be confirmed. A
speculative fix was applied on 3 March 2021. On 14 September 2021 David
Frankson of Infinite Campus independently reported the issue and included
a test case. This allowed both the issue and the speculative fix to be
verified. The issue was made public on 15 September 2021.

Affects: 9.0.0-M1 to 9.0.43

**Important: Information Disclosure**
[CVE-2024-21733](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-21733)

Incomplete POST requests triggered an error response that could contain
data from a previous request from another user.

This was fixed with commit
[86ccc439](https://github.com/apache/tomcat/commit/86ccc43940861703c2be96a5f35384407522125a).

This issue was reported to the Apache Tomcat Security Team by xer0dayz
from Sn1perSecurity LLC on 20 December 2023. The issue was made public on
19 January 2024.

Affects: 9.0.0-M11 to 9.0.43

### 2 February 2021 Fixed in Apache Tomcat 9.0.43

*Note: The issues below were fixed in Apache Tomcat 9.0.42 but the
release vote for the 9.0.42 release candidate did not pass. Therefore,
although users must download 9.0.43 to obtain a version that includes a
fix for these issues, version 9.0.42 is not included in the list of
affected versions.*

**Low: Fix for [CVE-2020-9484](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9484) was incomplete**
[CVE-2021-25329](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25329)

The fix for [CVE-2020-9484](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9484) was incomplete. When using a
highly unlikely configuration edge case, the Tomcat instance was still
vulnerable to [CVE-2020-9484](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9484). Note that both the previously
published prerequisites for [CVE-2020-9484](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9484) and the previously
published non-upgrade mitigations for [CVE-2020-9484](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9484) also apply to
this issue.

This was fixed with commit
[4785433a](https://github.com/apache/tomcat/commit/4785433a226a20df6acbea49296e1ce7e23de453).

This issue was reported to the Apache Tomcat Security team by Trung Pham
of Viettel Cyber Security on 12 January 2021. The issue was made public
on 1 March 2021.

Affects: 9.0.0.M1 to 9.0.41

**Important: Request mix-up with h2c**
[CVE-2021-25122](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25122)

When responding to new h2c connection requests, Apache Tomcat could
duplicate request headers and a limited amount of request body from one
request to another meaning user A and user B could both see the results of
user A's request.

This was fixed with commit
[d47c20a7](https://github.com/apache/tomcat/commit/d47c20a776e8919eaca8da9390a32bc8bf8210b1).

This issue was identified by the Apache Tomcat Security team on 11
January 2021. The issue was made public on 1 March 2021.

Affects: 9.0.0.M1 to 9.0.41

### 17 November 2020 Fixed in Apache Tomcat 9.0.40

**Important: Information disclosure**
[CVE-2021-24122](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24122)

When serving resources from a network location using the NTFS file system
it was possible to bypass security constraints and/or view the source
code for JSPs in some configurations. The root cause was the unexpected
behaviour of the JRE API `File.getCanonicalPath()` which in
turn was caused by the inconsistent behaviour of the Windows API
(`FindFirstFileW`) in some circumstances.

This was fixed with commit
[935fc558](https://github.com/apache/tomcat/commit/935fc5582dc25ae10bab6f9d5629ff8d996cb533).

This issue was reported the Apache Tomcat Security team by Ilja Brander
on 26 October 2020. The issue was made public on 14 January 2021.

Affects: 9.0.0.M1 to 9.0.39

**Moderate: HTTP/2 request header mix-up**
[CVE-2020-17527](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-17527)

While investigating issue [64830](https://bz.apache.org/bugzilla/show_bug.cgi?id=64830) it was discovered that Apache
Tomcat could re-use an HTTP request header value from the previous stream
received on an HTTP/2 connection for the request associated with the
subsequent stream. While this would most likely lead to an error and the
closure of the HTTP/2 connection, it is possible that information could
leak between requests.

This was fixed with commit
[d56293f8](https://github.com/apache/tomcat/commit/d56293f816d6dc9e2b47107f208fa9e95db58c65).

This issue was identified by the Apache Tomcat Security team on 10
November 2020. The issue was made public on 3 December 2020.

Affects: 9.0.0-M1 to 9.0.39

### 15 September 2020 Fixed in Apache Tomcat 9.0.38

**Moderate: HTTP/2 request mix-up**
[CVE-2020-13943](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13943)

If an HTTP/2 client exceeded the agreed maximum number of concurrent
streams for a connection (in violation of the HTTP/2 protocol), it was
possible that a subsequent request made on that connection could contain
HTTP headers - including HTTP/2 pseudo headers - from a previous request
rather than the intended headers. This could lead to users seeing
responses for unexpected resources.

This was fixed with commit
[55911430](https://github.com/apache/tomcat/commit/55911430df13f8c9998fbdee1f9716994d2db59b).

This issue was identified by the Apache Tomcat Security team on 23 July
2020. The issue was made public on 12 October 2020.

Affects: 9.0.0.M1 to 9.0.37

### 5 July 2020 Fixed in Apache Tomcat 9.0.37

**Important: WebSocket DoS**
[CVE-2020-13935](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13935)

The payload length in a WebSocket frame was not correctly validated.
Invalid payload lengths could trigger an infinite loop. Multiple requests
with invalid payload lengths could lead to a denial of service.

This was fixed with commit
[40fa74c7](https://github.com/apache/tomcat/commit/40fa74c74822711ab878079d0a69f7357926723d).

This issue was reported publicly via the Apache Bugzilla instance on 28
June 2020 and included references to high CPU but no specific reference
to denial of service. The associated DoS risks were identified by the
Apache Tomcat Security Team the same day. The issue was made public on 14
July 2020.

Affects: 9.0.0.M1 to 9.0.36

**Moderate: HTTP/2 DoS**
[CVE-2020-13934](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13934)

An h2c direct connection did not release the HTTP/1.1 processor after the
upgrade to HTTP/2. If a sufficient number of such requests were made, an
OutOfMemoryException could occur leading to a denial of service.

This was fixed with commit
[172977f0](https://github.com/apache/tomcat/commit/172977f04a5215128f1e278a688983dcd230f399).

This issue was reported publicly via the Apache Tomcat Users mailing list
on 22 June 2020 without reference to the potential for DoS. After further
discussion to identify the steps necessary to reproduce the issue, the
root cause of the issue and the associated DoS risks were identified by
the Apache Tomcat Security Team on 26 June 2020. The issue was made
public on 14 July 2020.

Affects: 9.0.0.M5 to 9.0.36

### 7 June 2020 Fixed in Apache Tomcat 9.0.36

**Important: HTTP/2 DoS**
[CVE-2020-11996](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11996)

A specially crafted sequence of HTTP/2 requests could trigger high CPU
usage for several seconds. If a sufficient number of such requests were
made on concurrent HTTP/2 connections, the server could become
unresponsive.

This was fixed with commit
[9a023168](https://github.com/apache/tomcat/commit/9a0231683a77e2957cea0fdee88b193b30b0c976).

This issue was reported publicly via the Apache Tomcat Users mailing list
on 21 May 2020 without reference to the potential for DoS. The DoS risks
were identified by the Apache Tomcat Security Team the same day. The
issue was made public on 25 June 2020.

Affects: 9.0.0.M1 to 9.0.35

### 11 May 2020 Fixed in Apache Tomcat 9.0.35

**Important: Remote Code Execution via session persistence**
[CVE-2020-9484](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9484)

If:

* an attacker is able to control the contents and name of a file on the
  server; and
* the server is configured to use the `PersistenceManager`
  with a `FileStore`; and
* the `PersistenceManager` is configured with
  `sessionAttributeValueClassNameFilter="null"` (the default
  unless a `SecurityManager` is used) or a sufficiently lax
  filter to allow the attacker provided object to be deserialized;
  and
* the attacker knows the relative file path from the storage location
  used by `FileStore` to the file the attacker has control
  over;

then, using a specifically crafted request, the attacker will be able to
trigger remote code execution via deserialization of the file under their
control.

**Note:** All of conditions above must be true for the
attack to succeed.

As an alternative to upgrading to 9.0.35 or later, users may configure
the `PersistenceManager` with an appropriate value for
`sessionAttributeValueClassNameFilter` to ensure that only
application provided attributes are serialized and deserialized.

This was fixed with commit
[3aa8f28d](https://github.com/apache/tomcat/commit/3aa8f28db7efb311cdd1b6fe15a9cd3b167a2222).

This issue was reported to the Apache Tomcat Security Team by by jarvis
threedr3am of pdd security research on 12 April 2020. The issue was made
public on 20 May 2020.

Affects: 9.0.0.M1 to 9.0.34

### 11 February 2020 Fixed in Apache Tomcat 9.0.31

**Important: AJP Request Injection and potential Remote Code Execution**
[CVE-2020-1938](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938)

When using the Apache JServ Protocol (AJP), care must be taken when
trusting incoming connections to Apache Tomcat. Tomcat treats AJP
connections as having higher trust than, for example, a similar HTTP
connection. If such connections are available to an attacker, they can be
exploited in ways that may be surprising. Prior to Tomcat 9.0.31, Tomcat
shipped with an AJP Connector enabled by default that listened on all
configured IP addresses. It was expected (and recommended in the security
guide) that this Connector would be disabled if not required.

Prior to this vulnerability report, the known risks of an attacker being
able to access the AJP port directly were:

* bypassing security checks based on client IP address
* bypassing user authentication if Tomcat was configured to trust
  authentication data provided by the reverse proxy

This vulnerability report identified a mechanism that allowed the
following:

* returning arbitrary files from anywhere in the web application
  including under the WEB-INF and META-INF directories or any other
  location reachable via ServletContext.getResourceAsStream()
* processing any file in the web application as a JSP

Further, if the web application allowed file upload and stored those
files within the web application (or the attacker was able to control
the content of the web application by some other means) then this, along
with the ability to process a file as a JSP, made remote code execution
possible.

It is important to note that mitigation is only required if an AJP port
is accessible to untrusted users. Users wishing to take a
defence-in-depth approach and block the vector that permits returning
arbitrary files and execution as JSP may upgrade to Apache Tomcat 9.0.31
or later. Users should note that a number of changes were made to the
default AJP Connector configuration in 9.0.31 to harden the default
configuration. It is likely that users upgrading to 9.0.31 or later
will need to make small changes to their configurations as a result.

This was fixed with commits
[0e8a50f0](https://github.com/apache/tomcat/commit/0e8a50f0a5958744bea1fd6768c862e04d3b7e75),
[9ac90532](https://github.com/apache/tomcat/commit/9ac90532e9a7d239f90952edb229b07c80a9a3eb),
[64fa5b99](https://github.com/apache/tomcat/commit/64fa5b99442589ef0bf2a7fcd71ad2bc68b35fad),
[7a1406a3](https://github.com/apache/tomcat/commit/7a1406a3cd20fdd90656add6cd8f27ef8f24e957) and
[49ad3f95](https://github.com/apache/tomcat/commit/49ad3f954f69c6e838c8cd112ad79aa5fa8e7153).

This issue was reported to the Apache Tomcat Security Team on 3 January
2020. The issue was made public on 24 February 2020.

Affects: 9.0.0.M1 to 9.0.30

**Low: HTTP Request Smuggling**
[CVE-2020-1935](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1935)

The HTTP header parsing code used an approach to end-of-line (EOL)
parsing that allowed some invalid HTTP headers to be parsed as valid. This
led to a possibility of HTTP Request Smuggling if Tomcat was
located behind a reverse proxy that incorrectly handled the invalid
Transfer-Encoding header in a particular manner. Such a reverse proxy is
considered unlikely.

This was fixed with commit
[8bfb0ff7](https://github.com/apache/tomcat/commit/8bfb0ff7f25fe7555a5eb2f7984f73546c11aa26).

This issue was reported to the Apache Tomcat Security Team by @ZeddYu
on 25 December 2019. The issue was made public on 24
February 2020.

Affects: 9.0.0.M1 to 9.0.30

**Low: HTTP Request Smuggling**
[CVE-2019-17569](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17569)

The refactoring in 9.0.28 introduced a regression. The result of the
regression was that invalid Transfer-Encoding headers were incorrectly
processed leading to a possibility of HTTP Request Smuggling if Tomcat was
located behind a reverse proxy that incorrectly handled the invalid
Transfer-Encoding header in a particular manner. Such a reverse proxy is
considered unlikely.

This was fixed with commit
[060ecc5e](https://github.com/apache/tomcat/commit/060ecc5eb839208687b7fcc9e35287ac8eb46998).

This issue was reported to the Apache Tomcat Security Team by @ZeddYu
on 12 December 2019. The issue was made public on 24
February 2020.

Affects: 9.0.28 to 9.0.30

### 12 December 2019 Fixed in Apache Tomcat 9.0.30

**Low: Session fixation**
[CVE-2019-17563](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17563)

When using FORM authentication there was a narrow window where an
attacker could perform a session fixation attack. The window was
considered too narrow for an exploit to be practical but, erring on the
side of caution, this issue has been treated as a security
vulnerability.

This was fixed with commit
[1ecba14e](https://github.com/apache/tomcat/commit/1ecba14e690cf5f3f143eef6ae7037a6d3c16652).

This issue was reported to the Apache Tomcat Security Team by William
Marlow (IBM) on 19 November 2019. The issue was made public on 18
December 2019.

Affects: 9.0.0.M1 to 9.0.29

### 21 November 2019 Fixed in Apache Tomcat 9.0.29

**Moderate: Local Privilege Escalation**
[CVE-2019-12418](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12418)

When Tomcat is configured with the JMX Remote Lifecycle Listener, a local
attacker without access to the Tomcat process or configuration files is
able to manipulate the RMI registry to perform a man-in-the-middle attack
to capture user names and passwords used to access the JMX interface. The
attacker can then use these credentials to access the JMX interface and
gain complete control over the Tomcat instance.

The JMX Remote Lifecycle Listener will be deprecated in future Tomcat
releases, will be removed for Tomcat 10 and may be removed from all
Tomcat releases some time after 31 December 2020.

Users should also be aware of [CVE-2019-2684](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2684), a JRE
vulnerability that enables this issue to be exploited remotely.

This was fixed with commit
[1fc9f589](https://github.com/apache/tomcat/commit/1fc9f589dbdd8295cf313b2667ab041c425f99c3).

This issue was reported to the Apache Tomcat Security Team by An Trinh of
Viettel Cyber Security on 10 October 2019. The issue was made public on 18
December 2019.

Affects: 9.0.0.M1 to 9.0.28

### 7 June 2019 Fixed in Apache Tomcat 9.0.21

**Important: Request mix-up**
[CVE-2022-25762](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-25762)

If a web application sends a WebSocket message concurrently with the
WebSocket connection closing, it is possible that the application will
continue to use the socket after it has been closed. The error handling
triggered in this case could cause the a pooled object to be placed in
the pool twice. This could result in subsequent connections using the
same object concurrently which could result in data being returned to the
wrong use and/or other errors.

This was fixed with commits
[e2d5a040](https://github.com/apache/tomcat/commit/e2d5a040b962a904db5264b3cb3282c6b05f823c),
[7046644b](https://github.com/apache/tomcat/commit/7046644bf361b89afc246b6643e24ce2ae60cacc),
[339b40bc](https://github.com/apache/tomcat/commit/339b40bc07bdba9ded565929b9a3448c5a78f015) and
[65fb1ee5](https://github.com/apache/tomcat/commit/65fb1ee548111021edde247f3b3c409ec95a5183).

This issue was identified by the Apache Tomcat Security Team on 21
December 2021. The issue was made public on 12 May 2022.

Affects: 9.0.0.M1 to 9.0.20

### 13 May 2019 Fixed in Apache Tomcat 9.0.20

**Important: Denial of Service**
[CVE-2019-10072](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10072)

The fix for [CVE-2019-0199](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0199) was incomplete and did not address
HTTP/2 connection window exhaustion on write. By not sending
WINDOW\_UPDATE messages for the connection window (stream 0) clients were
able to cause server-side threads to block eventually leading to thread
exhaustion and a DoS.

This was fixed with commits
[7f748eb6](https://github.com/apache/tomcat/commit/7f748eb6bfaba5207c89dbd7d5adf50fae847145) and
[ada725a5](https://github.com/apache/tomcat/commit/ada725a50a60867af3422c8e612aecaeea856a9a).

This issue was reported to the Apache Tomcat Security Team by John
Simpson of Trend Micro Security Research working with Trend Micro's Zero
Day Initiative on 26 April 2019. The issue was made public on 20 June
2019.

Affects: 9.0.0.M1 to 9.0.19

### 13 April 2019 Fixed in Apache Tomcat 9.0.19

*Note: The issues below were fixed in Apache Tomcat 9.0.18 but the
release vote for the 9.0.18 release candidate did not pass. Therefore,
although users must download 9.0.19 to obtain a version that includes a
fix for these issues, version 9.0.18 is not included in the list of
affected versions.*

**Important: Remote Code Execution on Windows**
[CVE-2019-0232](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0232)

When running on Windows with enableCmdLineArguments enabled, the CGI
Servlet is vulnerable to Remote Code Execution due to a bug in the way
the JRE passes command line arguments to Windows. The CGI Servlet is
disabled by default. The CGI option enableCmdLineArguments is disabled by
default in Tomcat 9.0.x. For a detailed explanation of the JRE behaviour,
see
[Markus
Wulftange's blog](https://codewhitesec.blogspot.com/2016/02/java-and-command-line-injections-in-windows.html) and this archived
[MSDN
blog](https://web.archive.org/web/20161228144344/https%3A//blogs.msdn.microsoft.com/twistylittlepassagesallalike/2011/04/23/everyone-quotes-command-line-arguments-the-wrong-way/).

This was fixed with commit
[4b244d82](https://github.com/apache/tomcat/commit/4b244d827ade2a36ef3b8734939541207b78f35c).

This issue was identified by Nightwatch Cybersecurity Research and
reported to the Apache Tomcat security team via the bug bounty program
sponsored by the EU FOSSA-2 project on 3rd March 2019. The issue was made
public on 10 April 2019.

Affects: 9.0.0.M1 to 9.0.17

**Low: XSS in SSI printenv**
[CVE-2019-0221](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0221)

The SSI printenv command echoes user provided data without escaping and
is, therefore, vulnerable to XSS. SSI is disabled by default. The
printenv command is intended for debugging and is unlikely to be present
in a production website.

This was fixed with commit
[15fcd166](https://github.com/apache/tomcat/commit/15fcd166ea2c1bb79e8541b8e1a43da9c452ceea).

This issue was identified by Nightwatch Cybersecurity Research and
reported to the Apache Tomcat security team via the bug bounty program
sponsored by the EU FOSSA-2 project on 7th March 2019. The issue was made
public on 17 May 2019.

Affects: 9.0.0.M1 to 9.0.17

### 8 February 2019 Fixed in Apache Tomcat 9.0.16

*Note: The issue below was fixed in Apache Tomcat 9.0.15 but the
release vote for the 9.0.15 release candidate did not pass. Therefore,
although users must download 9.0.16 to obtain a version that includes a
fix for these issues, version 9.0.15 is not included in the list of
affected versions.*

**Important: Denial of Service**
[CVE-2019-0199](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0199)

The HTTP/2 implementation accepted streams with excessive numbers of
`SETTINGS` frames and also permitted clients to keep streams
open without reading/writing request/response data. By keeping streams
open for requests that utilised the Servlet API's blocking I/O, clients
were able to cause server-side threads to block eventually leading to
thread exhaustion and a DoS.

This was fixed in revisions [1852698](https://svn.apache.org/viewvc?view=rev&rev=1852698),
[1852699](https://svn.apache.org/viewvc?view=rev&rev=1852699),
[1852700](https://svn.apache.org/viewvc?view=rev&rev=1852700),
[1852701](https://svn.apache.org/viewvc?view=rev&rev=1852701),
[1852702](https://svn.apache.org/viewvc?view=rev&rev=1852702),
[1852703](https://svn.apache.org/viewvc?view=rev&rev=1852703),
[1852704](https://svn.apache.org/viewvc?view=rev&rev=1852704),
[1852705](https://svn.apache.org/viewvc?view=rev&rev=1852705),
[1852706](https://svn.apache.org/viewvc?view=rev&rev=1852706) and
[a1cb1ac7](https://github.com/apache/tomcat/commit/a1cb1ac77e3a8fec1b00eb0e944842555da14f7d).

This issue was reported to the Apache Tomcat Security Team by Michal Karm
Babacek from Red Hat, Inc on 4 January 2019 with additional issues
identified by the Tomcat Security Team. The issue was made public on 25
March 2019.

Affects: 9.0.0.M1 to 9.0.14

### 10 September 2018 Fixed in Apache Tomcat 9.0.12

**Moderate: Open Redirect**
[CVE-2018-11784](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11784)

When the default servlet returned a redirect to a directory (e.g.
redirecting to `/foo/` when the user requested
`/foo`) a specially crafted URL could be used to cause the
redirect to be generated to any URI of the attackers choice.

This was fixed in revision [1840055](https://svn.apache.org/viewvc?view=rev&rev=1840055).

This issue was reported to the Apache Tomcat Security Team by Sergey
Bobrov on 28 August 2018 and made public on 3 October 2018.

Affects: 9.0.0.M1 to 9.0.11

### 25 June 2018 Fixed in Apache Tomcat 9.0.10

**Low: host name verification missing in WebSocket client**
[CVE-2018-8034](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8034)

The host name verification when using TLS with the WebSocket client was
missing. It is now enabled by default.

This was fixed in revision [1833757](https://svn.apache.org/viewvc?view=rev&rev=1833757).

This issue was reported publicly on 11 June 2018 and formally announced as
a vulnerability on 22 July 2018.

Affects: 9.0.0.M1 to 9.0.9

**Important: Information Disclosure**
[CVE-2018-8037](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8037)

If an async request was completed by the application at the same time as
the container triggered the async timeout, a race condition existed that
could result in a user seeing a response intended for a different user.
An additional issue was present in the NIO and NIO2 connectors that did
not correctly track the closure of the connection when an async request
was completed by the application and timed out by the container at the
same time. This could also result in a user seeing a response intended
for another user.

This was fixed in revisions [1833825](https://svn.apache.org/viewvc?view=rev&rev=1833825),
[1833831](https://svn.apache.org/viewvc?view=rev&rev=1833831),
[1837530](https://svn.apache.org/viewvc?view=rev&rev=1837530) and
[1833906](https://svn.apache.org/viewvc?view=rev&rev=1833906).

This issue was reported to the Apache Tomcat Security Team by Dmitry
Treskunov on 16 June 2018 and made public on 22 July 2018.

Affects: 9.0.0.M9 to 9.0.9

### not released Fixed in Apache Tomcat 9.0.9

**Low: CORS filter has insecure defaults**
[CVE-2018-8014](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8014)

The defaults settings for the CORS filter are insecure and enable
`supportsCredentials` for all origins. It is expected that
users of the CORS filter will have configured it appropriately for their
environment rather than using it in the default configuration. Therefore,
it is expected that most users will not be impacted by this issue.

This was fixed in revision [1831726](https://svn.apache.org/viewvc?view=rev&rev=1831726).

This issue was reported publicly on 1 May 2018 and formally announced as
a vulnerability on 16 May 2018.

### 3 May 2018 Fixed in Apache Tomcat 9.0.8

**Important: A bug in the UTF-8 decoder can lead to DoS**
[CVE-2018-1336](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1336)

An improper handing of overflow in the UTF-8 decoder with
supplementary characters can lead to an infinite loop in the
decoder causing a Denial of Service.

This was fixed in revision [1830373](https://svn.apache.org/viewvc?view=rev&rev=1830373).

This issue was reported publicly on 6 April 2018 and formally announced as
a vulnerability on 22 July 2018.

Affects: 9.0.0.M1 to 9.0.7

### 11 February 2018 Fixed in Apache Tomcat 9.0.5

**Important: Security constraint annotations applied too
late** [CVE-2018-1305](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1305)

Security constraints defined by annotations of Servlets were only applied
once a Servlet had been loaded. Because security constraints defined in
this way apply to the URL pattern and any URLs below that point, it was
possible - depending on the order Servlets were loaded - for some
security constraints not to be applied. This could have exposed resources
to users who were not authorised to access them.

This was fixed in revisions [1823310](https://svn.apache.org/viewvc?view=rev&rev=1823310) and
[1824323](https://svn.apache.org/viewvc?view=rev&rev=1824323).

This issue was identified by the Apache Tomcat Security on 1 February
2018 and made public on 23 February 2018.

Affects: 9.0.0.M1 to 9.0.4

**Important: Security constraints mapped to context root are
ignored** [CVE-2018-1304](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1304)

The URL pattern of "" (the empty string) which exactly maps to the
context root was not correctly handled when used as part of a security
constraint definition. This caused the constraint to be ignored. It was,
therefore, possible for unauthorised users to gain access to web
application resources that should have been protected. Only security
constraints with a URL pattern of the empty string were affected.

This was fixed in revision [1823306](https://svn.apache.org/viewvc?view=rev&rev=1823306).

This issue was reported publicly as [62067](https://bz.apache.org/bugzilla/show_bug.cgi?id=62067) on 31 January 2018
and the security implications identified by the Apache Tomcat Security
Team the same day. It was made public on 23 February 2018.

Affects: 9.0.0.M1 to 9.0.4

### 30 November 2017 Fixed in Apache Tomcat 9.0.2

**Low: Incorrectly documented CGI search algorithm**
[CVE-2017-15706](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15706)

As part of the fix for bug [61201](https://bz.apache.org/bugzilla/show_bug.cgi?id=61201), the description of the
search algorithm used by the CGI Servlet to identify which script to
execute was updated. The update was not correct. As a result, some
scripts may have failed to execute as expected and other scripts may have
been executed unexpectedly. Note that the behaviour of the CGI servlet
has remained unchanged in this regard. It is only the documentation of
the behaviour that was wrong and has been corrected.

This was fixed in revision [1814825](https://svn.apache.org/viewvc?view=rev&rev=1814825).

This issue was reported to the Apache Tomcat Security Team by Jan Michael
Greiner on 17 September 2017 and made public on 31 January 2018.

Affects: 9.0.0.M22 to 9.0.1

### 30 September 2017 Fixed in Apache Tomcat 9.0.1

**Important: Remote Code Execution**
[CVE-2017-12617](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12617)

When running with HTTP PUTs enabled (e.g. via setting the
`readonly` initialisation parameter of the Default servlet to
false) it was possible to upload a JSP file to the server via a specially
crafted request. This JSP could then be requested and any code it
contained would be executed by the server.

This was fixed in revisions [1809669](https://svn.apache.org/viewvc?view=rev&rev=1809669),
[1809674](https://svn.apache.org/viewvc?view=rev&rev=1809674),
[1809684](https://svn.apache.org/viewvc?view=rev&rev=1809684) and
[1809711](https://svn.apache.org/viewvc?view=rev&rev=1809711).

This issue was first reported publicly followed by multiple reports to
the Apache Tomcat Security Team on 20 September 2017.

Affects: 9.0.0.M1 to 9.0.0

### 26 June 2017 Fixed in Apache Tomcat 9.0.0.M22

**Important: Security Constraint Bypass**
[CVE-2017-7675](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7675)

The HTTP/2 implementation bypassed a number of security checks that
prevented directory traversal attacks. It was therefore possible to
bypass security constraints using an specially crafted URL.

This was fixed in revision [1796090](https://svn.apache.org/viewvc?view=rev&rev=1796090).

The issue was originally reported as a failure to process URL path
parameters in bug [61120](https://bz.apache.org/bugzilla/show_bug.cgi?id=61120) on 24 May 2017. The full implications
of this issue were identified by the Tomcat Security Team the same day.
This issue was made public on 10 August 2017.

Affects: 9.0.0.M1 to 9.0.0.M21

**Moderate: Cache Poisoning**
[CVE-2017-7674](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7674)

The CORS Filter did not add an HTTP Vary header indicating that the
response varies depending on Origin. This permitted client and server
side cache poisoning in some circumstances.

This was fixed in revision [1795813](https://svn.apache.org/viewvc?view=rev&rev=1795813).

The issue was reported as bug [61101](https://bz.apache.org/bugzilla/show_bug.cgi?id=61101) on 16 May 2017. The full
implications of this issue were identified by the Tomcat Security Team
the same day. This issue was made public on 10 August 2017.

Affects: 9.0.0.M1 to 9.0.0.M21

### 10 May 2017 Fixed in Apache Tomcat 9.0.0.M21

**Important: Security Constraint Bypass**
[CVE-2017-5664](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5664)

The error page mechanism of the Java Servlet Specification requires that,
when an error occurs and an error page is configured for the error that
occurred, the original request and response are forwarded to the error
page. This means that the request is presented to the error page with the
original HTTP method.

If the error page is a static file, expected behaviour is to serve content
of the file as if processing a GET request, regardless of the actual HTTP
method. Tomcat's Default Servlet did not do this. Depending on the
original request this could lead to unexpected and undesirable results for
static error pages including, if the DefaultServlet is configured to
permit writes, the replacement or removal of the custom error page.

Notes for other user provided error pages:

* Unless explicitly coded otherwise, JSPs ignore the HTTP method.
  JSPs used as error pages must ensure that they handle any error
  dispatch as a GET request, regardless of the actual method.
* By default, the response generated by a Servlet does depend on the
  HTTP method. Custom Servlets used as error pages must ensure that
  they handle any error dispatch as a GET request, regardless of the
  actual method.

This was fixed in revisions [1793468](https://svn.apache.org/viewvc?view=rev&rev=1793468) and
[1793487](https://svn.apache.org/viewvc?view=rev&rev=1793487).

This issue was reported responsibly to the Apache Tomcat Security Team by
Aniket Nandkishor Kulkarni from Tata Consultancy Services Ltd, Mumbai,
India as a vulnerability that allowed the restrictions on OPTIONS and
TRACE requests to be bypassed on 21 April 2017. The full implications of
this issue were identified by the Tomcat Security Team on 24 April 2017.
This issue was made public on 6 June 2017.

Affects: 9.0.0.M1 to 9.0.0.M20

### 30 March 2017 Fixed in Apache Tomcat 9.0.0.M19

**Important: Information Disclosure**
[CVE-2017-5651](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5651)

The refactoring of the HTTP connectors for 8.5.x onwards, introduced a
regression in the send file processing. If the send file processing
completed quickly, it was possible for the Processor to be added to the
processor cache twice. This could result in the same Processor being used
for multiple requests which in turn could lead to unexpected errors
and/or response mix-up.

This was fixed in revision [1788544](https://svn.apache.org/viewvc?view=rev&rev=1788544).

This issue was identified by the Apache Tomcat Security Team on 24
March 2017 and made public on 10 April 2017.

Affects: 9.0.0.M1 to 9.0.0.M18

**Important: Denial of Service**
[CVE-2017-5650](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5650)

The handling of an HTTP/2 GOAWAY frame for a connection did not close
streams associated with that connection that were currently waiting for a
WINDOW\_UPDATE before allowing the application to write more data. These
waiting streams each consumed a thread. A malicious client could
therefore construct a series of HTTP/2 requests that would consume all
available processing threads.

This was fixed in revision [1788460](https://svn.apache.org/viewvc?view=rev&rev=1788460).

This issue was reported to the Apache Tomcat Security Team by Chun Han
Hsiao on 11 March 2017 and made public on 10 April 2017.

Affects: 9.0.0.M1 to 9.0.0.M18

**Important: Information Disclosure**
[CVE-2017-5647](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5647)

A bug in the handling of the pipelined requests when send file was used
resulted in the pipelined request being lost when send file processing of
the previous request completed. This could result in responses appearing
to be sent for the wrong request. For example, a user agent that sent
requests A, B and C could see the correct response for request A, the
response for request C for request B and no response for request C.

This was fixed in revision [1788890](https://svn.apache.org/viewvc?view=rev&rev=1788890).

This issue was identified by the Apache Tomcat Security Team on 20
March 2017 and made public on 10 April 2017.

Affects: 9.0.0.M1 to 9.0.0.M18

### 13 March 2017 Fixed in Apache Tomcat 9.0.0.M18

**Low: Information Disclosure**
[CVE-2017-5648](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5648)

While investigating bug 60718, it was noticed that some calls to
application listeners did not use the appropriate facade object. When
running an untrusted application under a SecurityManager, it was
therefore possible for that untrusted application to retain a reference
to the request or response object and thereby access and/or modify
information associated with another web application.

This was fixed in revision [1785774](https://svn.apache.org/viewvc?view=rev&rev=1785774).

This issue was identified by the Apache Tomcat Security Team on 20
March 2017 and made public on 10 April 2017.

Affects: 9.0.0.M1 to 9.0.0.M17

### 16 January 2017 Fixed in Apache Tomcat 9.0.0.M17

*Note: The issue below was fixed in Apache Tomcat 9.0.0.M16 but the
release vote for the 9.0.0.M16 release candidate did not pass. Therefore,
although users must download 9.0.0.M17 to obtain a version that includes
the fix for this issue, version 9.0.0.M16 is not included in the list of
affected versions.*

**Moderate: Information Disclosure**
[CVE-2016-8747](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8747)

The refactoring to make wider use of ByteBuffer introduced a regression
that could cause information to leak between requests on the same
connection. When running behind a reverse proxy, this could result in
information leakage between users. All HTTP connector variants are
affected but HTTP/2 and AJP are not affected.

This was fixed in revision [1774161](https://svn.apache.org/viewvc?view=rev&rev=1774161).

This issue was identified by the Apache Tomcat Security Team on 14
December 2016 and made public on 13 March 2017.

Affects: 9.0.0.M11 to 9.0.0.M15

### 8 December 2016 Fixed in Apache Tomcat 9.0.0.M15

*Note: The issue below was fixed in Apache Tomcat 9.0.0.M14 but the
release vote for the 9.0.0.M14 release candidate did not pass. Therefore,
although users must download 9.0.0.M15 to obtain a version that includes
the fix for this issue, version 9.0.0.M14 is not included in the list of
affected versions.*

**Important: Information Disclosure**
[CVE-2016-8745](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8745)

A bug in the error handling of the send file code for the NIO HTTP
connector resulted in the current Processor object being added to the
Processor cache multiple times. This in turn meant that the same
Processor could be used for concurrent requests. Sharing a Processor can
result in information leakage between requests including, but not limited
to, session ID and the response body.

This was fixed in revision [1771853](https://svn.apache.org/viewvc?view=rev&rev=1771853).

This issue was identified by the Apache Tomcat Security Team on 8 December
2016 and made public on 12 December 2016.

Affects: 9.0.0.M1 to 9.0.0.M13

### 8 November 2016 Fixed in Apache Tomcat 9.0.0.M13

*Note: The issues below were fixed in Apache Tomcat 9.0.0.M12 but the
release vote for the 9.0.0.M12 release candidate did not pass. Therefore,
although users must download 9.0.0.M13 to obtain a version that includes
fixes for these issues, version 9.0.0.M12 is not included in the list of
affected versions.*

**Important: Remote Code Execution**
[CVE-2016-8735](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8735)

The `JmxRemoteLifecycleListener` was not updated to take
account of Oracle's fix for [CVE-2016-3427](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3427). Therefore, Tomcat
installations using this listener remained vulnerable to a similar remote
code execution vulnerability. This issue has been rated as important
rather than critical due to the small number of installations using this
listener and that it would be highly unusual for the JMX ports to be
accessible to an attacker even when the listener is used.

This was fixed in revision [1767644](https://svn.apache.org/viewvc?view=rev&rev=1767644).

This issue was reported to the Apache Tomcat Security Team on 19 October
2016 and made public on 22 November 2016.

Affects: 9.0.0.M1 to 9.0.0.M11

**Important: Denial of Service**
[CVE-2016-6817](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6817)

The HTTP/2 header parser entered an infinite loop if a header was
received that was larger than the available buffer. This made a denial of
service attack possible.

This was fixed in revision [1765794](https://svn.apache.org/viewvc?view=rev&rev=1765794).

This issue was reported as [60232](https://bz.apache.org/bugzilla/show_bug.cgi?id=60232) on 10 October 2016 and the
security implications identified by the Apache Tomcat Security Team on
the same day. It was made public on 22 November 2016.

Affects: 9.0.0.M1 to 9.0.0.M11

**Important: Information Disclosure**
[CVE-2016-6816](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6816)

The code that parsed the HTTP request line permitted invalid characters.
This could be exploited, in conjunction with a proxy that also permitted
the invalid characters but with a different interpretation, to inject
data into the HTTP response. By manipulating the HTTP response the
attacker could poison a web-cache, perform an XSS attack and/or obtain
sensitive information from requests other then their own.

This was fixed in revision [1767641](https://svn.apache.org/viewvc?view=rev&rev=1767641).

This issue was reported to the Apache Tomcat Security Team on 11 October
2016 and made public on 22 November 2016.

Affects: 9.0.0.M1 to 9.0.0.M11

### 5 September 2016 Fixed in Apache Tomcat 9.0.0.M10

**Low: Unrestricted Access to Global Resources**
[CVE-2016-6797](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6797)

The ResourceLinkFactory did not limit web application access to global
JNDI resources to those resources explicitly linked to the web
application. Therefore, it was possible for a web application to access
any global JNDI resource whether an explicit ResourceLink had been
configured or not.

This was fixed in revision [1757271](https://svn.apache.org/viewvc?view=rev&rev=1757271).

This issue was identified by the Apache Tomcat Security Team on 18
January 2016 and made public on 27 October 2016.

Affects: 9.0.0.M1 to 9.0.0.M9

**Low: Security Manager Bypass**
[CVE-2016-6796](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6796)

A malicious web application was able to bypass a configured
SecurityManager via manipulation of the configuration parameters for the
JSP Servlet.

This was fixed in revisions [1758487](https://svn.apache.org/viewvc?view=rev&rev=1758487) and
[1763232](https://svn.apache.org/viewvc?view=rev&rev=1763232).

This issue was identified by the Apache Tomcat Security Team on 27
December 2015 and made public on 27 October 2016.

Affects: 9.0.0.M1 to 9.0.0.M9

**Low: System Property Disclosure**
[CVE-2016-6794](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6794)

When a SecurityManager is configured, a web application's ability to read
system properties should be controlled by the SecurityManager. Tomcat's
system property replacement feature for configuration files could be used
by a malicious web application to bypass the SecurityManager and read
system properties that should not be visible.

This was fixed in revision [1754445](https://svn.apache.org/viewvc?view=rev&rev=1754445).

This issue was identified by the Apache Tomcat Security Team on 27
December 2015 and made public on 27 October 2016.

Affects: 9.0.0.M1 to 9.0.0.M9

**Low: Security Manager Bypass**
[CVE-2016-5018](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5018)

A malicious web application was able to bypass a configured
SecurityManager via a Tomcat utility method that was accessible to web
applications.

This was fixed in revisions [1754714](https://svn.apache.org/viewvc?view=rev&rev=1754714) and
[1760300](https://svn.apache.org/viewvc?view=rev&rev=1760300).

This issue was discovered by Alvaro Munoz and Alexander Mirosh of the HP
Enterprise Security Team and reported to the Apache Tomcat Security Team
on 5 July 2016. It was made public on 27 October 2016.

Affects: 9.0.0.M1 to 9.0.0.M9

**Low: Timing Attack**
[CVE-2016-0762](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0762)

The Realm implementations did not process the supplied password if the
supplied user name did not exist. This made a timing attack possible to
determine valid user names. Note that the default configuration includes
the LockOutRealm which makes exploitation of this vulnerability
harder.

This was fixed in revision [1758499](https://svn.apache.org/viewvc?view=rev&rev=1758499).

This issue was identified by the Apache Tomcat Security Team on 1 January
2016 and made public on 27 October 2016.

Affects: 9.0.0.M1 to 9.0.0.M9

### 13 June 2016 Fixed in Apache Tomcat 9.0.0.M8

*Note: The issue below was fixed in Apache Tomcat 9.0.0.M7 but the
release vote for the 9.0.0.M7 release candidate did not pass. Therefore,
although users must download 9.0.0.M8 to obtain a version that includes
fixes for these issues, version 9.0.0.M7 is not included in the list of
affected versions.*

**Moderate: Denial of Service**
[CVE-2016-3092](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3092)

Apache Tomcat uses a package renamed copy of Apache Commons FileUpload to
implement the file upload requirements of the Servlet specification. A
denial of service vulnerability was identified in Commons FileUpload that
occurred when the length of the multipart boundary was just below the
size of the buffer (4096 bytes) used to read the uploaded file. This
caused the file upload process to take several orders of magnitude
longer than if the boundary was the typical tens of bytes long.

This was fixed in revision [1743700](https://svn.apache.org/viewvc?view=rev&rev=1743700).

This issue was identified by the TERASOLUNA Framework Development Team
and reported to the Apache Commons team via JPCERT on 9 May 2016. It was
made public on 21 June 2016.

Affects: 9.0.0.M1 to 9.0.0.M6

### 5 January 2016 Fixed in Apache Tomcat 9.0.0.M3

**Moderate: Security Manager bypass**
[CVE-2016-0763](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0763)

This issue only affects users running untrusted web applications under a
security manager.

`ResourceLinkFactory.setGlobalContext()` is a public method
and was accessible to web applications even when running under a security
manager. This allowed a malicious web application to inject a malicious
global context that could in turn be used to disrupt other web
applications and/or read and write data owned by other web
applications.

This was fixed in revision [1725926](https://svn.apache.org/viewvc?view=rev&rev=1725926).

This issue was identified by the Tomcat security team on 18 January 2016
and made public on 22 February 2016.

Affects: 9.0.0.M1 to 9.0.0.M2

*Note: The issues below were fixed in Apache Tomcat 9.0.0.M2 but the
release vote for the 9.0.0.M2 release candidate did not pass. Therefore,
although users must download 9.0.0.M3 to obtain a version that includes
fixes for these issues, version 9.0.0.M2 is not included in the list of
affected versions.*

**Low: Directory disclosure**
[CVE-2015-5345](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5345)

When accessing a directory protected by a security constraint with a URL
that did not end in a slash, Tomcat would redirect to the URL with the
trailing slash thereby confirming the presence of the directory before
processing the security constraint. It was therefore possible for a user
to determine if a directory existed or not, even if the user was not
permitted to view the directory. The issue also occurred at the root of a
web application in which case the presence of the web application was
confirmed, even if a user did not have access.

The solution was to implement the redirect in the DefaultServlet so that
any security constraints and/or security enforcing Filters were processed
before the redirect. The Tomcat team recognised that moving the redirect
could cause regressions so two new Context configuration options
(`mapperContextRootRedirectEnabled` and
`mapperDirectoryRedirectEnabled`) were introduced. The initial
default was `false` for both since this was more secure.
However, due to regressions such as
[Bug
58765](https://bz.apache.org/bugzilla/show_bug.cgi?id=58765) the default for `mapperContextRootRedirectEnabled`
was later changed to true since it was viewed that the regression was
more serious than the security risk of associated with being able to
determine if a web application was deployed at a given path.

This was fixed in revisions [1715206](https://svn.apache.org/viewvc?view=rev&rev=1715206),
[1716882](https://svn.apache.org/viewvc?view=rev&rev=1716882) and
[1716894](https://svn.apache.org/viewvc?view=rev&rev=1716894).

This issue was identified by Mark Koek of QCSec on 12 October 2015 and
made public on 22 February 2016.

Affects: 9.0.0.M1

**Low: Session Fixation**
[CVE-2015-5346](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5346)

When recycling the `Request` object to use for a new request,
the `requestedSessionSSL` field was not recycled. This meant that
a session ID provided in the next request to be processed using the recycled
`Request` object could be used when it should not have been. This
gave the client the ability to control the session ID. In theory, this could
have been used as part of a session fixation attack but it would have been
hard to achieve as the attacker would not have been able to force the victim
to use the 'correct' `Request` object. It was also necessary for
at least one web application to be configured to use the SSL session ID as
the HTTP session ID. This is not a common configuration.

This was fixed in revisions [1713184](https://svn.apache.org/viewvc?view=rev&rev=1713184) and
[1723414](https://svn.apache.org/viewvc?view=rev&rev=1723414).

This issue was identified by the Tomcat security team on 22 June 2014
and made public on 22 February 2016.

Affects: 9.0.0.M1

**Moderate: CSRF token leak**
[CVE-2015-5351](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5351)

The index page of the Manager and Host Manager applications included a
valid CSRF token when issuing a redirect as a result of an
unauthenticated request to the root of the web application. If an
attacker had access to the Manager or Host Manager applications
(typically these applications are only accessible to internal users, not
exposed to the Internet), this token could then be used by the attacker
to construct a CSRF attack.

This was fixed in revisions [1720652](https://svn.apache.org/viewvc?view=rev&rev=1720652) and
[1720655](https://svn.apache.org/viewvc?view=rev&rev=1720655).

This issue was identified by the Tomcat security team on 8 December 2015
and made public on 22 February 2016.

Affects: 9.0.0.M1

**Low: Security Manager bypass**
[CVE-2016-0706](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0706)

This issue only affects users running untrusted web applications under a
security manager.

The internal StatusManagerServlet could be loaded by a malicious web
application when a security manager was configured. This servlet could
then provide the malicious web application with a list of all deployed
applications and a list of the HTTP request lines for all requests
currently being processed. This could have exposed sensitive information
from other web applications, such as session IDs, to the web
application.

This was fixed in revision [1722799](https://svn.apache.org/viewvc?view=rev&rev=1722799).

This issue was identified by the Tomcat security team on 27 December 2015
and made public on 22 February 2016.

Affects: 9.0.0.M1

**Moderate: Security Manager bypass**
[CVE-2016-0714](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0714)

This issue only affects users running untrusted web applications under a
security manager.

Tomcat provides several session persistence mechanisms. The
`StandardManager` persists session over a restart. The
`PersistentManager` is able to persist sessions to files, a
database or a custom `Store`. The cluster implementation
persists sessions to one or more additional nodes in the cluster. All of
these mechanisms could be exploited to bypass a security manager. Session
persistence is performed by Tomcat code with the permissions assigned to
Tomcat internal code. By placing a carefully crafted object into a
session, a malicious web application could trigger the execution of
arbitrary code.

This was fixed in revisions [1725263](https://svn.apache.org/viewvc?view=rev&rev=1725263) and
[1725914](https://svn.apache.org/viewvc?view=rev&rev=1725914).

This issue was identified by the Tomcat security team on 12 November 2015
and made public on 22 February 2016.

Affects: 9.0.0.M1

### Not a vulnerability in Tomcat

**Critical: Remote Code Execution via log4j**
[CVE-2021-44228](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228)

Apache Tomcat 9.0.x has no dependency on any version of log4j.

Web applications deployed on Apache Tomcat may have a dependency on
log4j. You should seek support from the application vendor in this
instance.

It is possible to configure Apache Tomcat 9.0.x to use log4j 2.x for
Tomcat's internal logging. This requires explicit configuration and the
addition of the log4j 2.x library. Anyone who has switched Tomcat's
internal logging to log4j 2.x is likely to need to address this
vulnerability.

In most cases, disabling the problematic feature will be the simplest
solution. Exactly how to do that depends on the exact version of log4j
2.x being used. Details are provided on the
[log4j 2.x
security page](https://logging.apache.org/log4j/2.x/security.html).

Copyright © 1999-2024, The Apache Software Foundation

Apache Tomcat, Tomcat, Apache, the Apache Tomcat logo and the Apache logo
are either registered trademarks or trademarks of the Apache Software
Foundation.
