<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>GhostRace - vusec</title>
	<link rel="profile" href="https://gmpg.org/xfn/11">
	
	<!--[if lt IE 9]>
	<script src="/wp-content/themes/twentyfourteen/js/html5.js?ver=3.7.0"></script>
	<![endif]-->
	<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

	<!-- This site is optimized with the Yoast SEO plugin v23.5 - https://yoast.com/wordpress/plugins/seo/ -->
	<link rel="canonical" href="https://www.vusec.net/projects/ghostrace/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="GhostRace - vusec" />
	<meta property="og:description" content="Exploiting and Mitigating Speculative Race Conditions GhostRace: CVE-2024-2193 Race conditions arise when multiple threads attempt to access a shared resource without proper synchronization, often leading to vulnerabilities such as concurrent use-after-free. To mitigate their occurrence, operating systems rely on synchronization primitives such as mutexes, spinlocks, etc. In this work, we present GhostRace, the first security &hellip; Continue reading GhostRace &rarr;" />
	<meta property="og:url" content="https://www.vusec.net/projects/ghostrace/" />
	<meta property="og:site_name" content="vusec" />
	<meta property="article:modified_time" content="2024-03-13T08:59:44+00:00" />
	<meta property="og:image" content="https://lh7-us.googleusercontent.com/A5mtFcjtk0myeLsZ-QqmBi7iFv_h_3wrIdzAVSwGwRiFe35KkzdgkIIiCjko7ORcEoCf7B8-PvbAlpf8nJ92oFNDS3uFdaVSm24VCzdK5dSBPSK-WUKDkXSRf-bWNxK6-Bru6g4W0iC8zA8x3UFcy9Q" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@vu5ec" />
	<meta name="twitter:label1" content="Est. reading time" />
	<meta name="twitter:data1" content="6 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.vusec.net/projects/ghostrace/","url":"https://www.vusec.net/projects/ghostrace/","name":"GhostRace - vusec","isPartOf":{"@id":"https://www.vusec.net/#website"},"primaryImageOfPage":{"@id":"https://www.vusec.net/projects/ghostrace/#primaryimage"},"image":{"@id":"https://www.vusec.net/projects/ghostrace/#primaryimage"},"thumbnailUrl":"https://lh7-us.googleusercontent.com/A5mtFcjtk0myeLsZ-QqmBi7iFv_h_3wrIdzAVSwGwRiFe35KkzdgkIIiCjko7ORcEoCf7B8-PvbAlpf8nJ92oFNDS3uFdaVSm24VCzdK5dSBPSK-WUKDkXSRf-bWNxK6-Bru6g4W0iC8zA8x3UFcy9Q","datePublished":"2024-03-12T16:08:59+00:00","dateModified":"2024-03-13T08:59:44+00:00","breadcrumb":{"@id":"https://www.vusec.net/projects/ghostrace/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.vusec.net/projects/ghostrace/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.vusec.net/projects/ghostrace/#primaryimage","url":"https://lh7-us.googleusercontent.com/A5mtFcjtk0myeLsZ-QqmBi7iFv_h_3wrIdzAVSwGwRiFe35KkzdgkIIiCjko7ORcEoCf7B8-PvbAlpf8nJ92oFNDS3uFdaVSm24VCzdK5dSBPSK-WUKDkXSRf-bWNxK6-Bru6g4W0iC8zA8x3UFcy9Q","contentUrl":"https://lh7-us.googleusercontent.com/A5mtFcjtk0myeLsZ-QqmBi7iFv_h_3wrIdzAVSwGwRiFe35KkzdgkIIiCjko7ORcEoCf7B8-PvbAlpf8nJ92oFNDS3uFdaVSm24VCzdK5dSBPSK-WUKDkXSRf-bWNxK6-Bru6g4W0iC8zA8x3UFcy9Q"},{"@type":"BreadcrumbList","@id":"https://www.vusec.net/projects/ghostrace/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.vusec.net/"},{"@type":"ListItem","position":2,"name":"Projects","item":"https://www.vusec.net/projects/"},{"@type":"ListItem","position":3,"name":"GhostRace"}]},{"@type":"WebSite","@id":"https://www.vusec.net/#website","url":"https://www.vusec.net/","name":"vusec","description":"Systems and Network Security Group at VU Amsterdam","publisher":{"@id":"https://www.vusec.net/#organization"},"alternateName":"vusec","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.vusec.net/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://www.vusec.net/#organization","name":"VUSec Systems Security Research Group at VU University Amsterdam","url":"https://www.vusec.net/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.vusec.net/#/schema/logo/image/","url":"/wp-content/uploads/2016/04/13334048894_6e8b421c4e_o-e1461588681568.jpg","contentUrl":"/wp-content/uploads/2016/04/13334048894_6e8b421c4e_o-e1461588681568.jpg","width":1260,"height":463,"caption":"VUSec Systems Security Research Group at VU University Amsterdam"},"image":{"@id":"https://www.vusec.net/#/schema/logo/image/"},"sameAs":["https://x.com/vu5ec","https://www.youtube.com/c/VusecNetwork"]}]}</script>
	<!-- / Yoast SEO plugin. -->


		<!-- This site uses the Google Analytics by MonsterInsights plugin v9.1.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="//www.googletagmanager.com/gtag/js?id=G-0WL49V0JEN"  data-cfasync="false" data-wpfc-render="false" async></script>
			<script data-cfasync="false" data-wpfc-render="false">
				var mi_version = '9.1.0';
				var mi_track_user = true;
				var mi_no_track_reason = '';
								var MonsterInsightsDefaultLocations = {"page_location":"https:\/\/www.vusec.net\/projects\/ghostrace\/"};
				if ( typeof MonsterInsightsPrivacyGuardFilter === 'function' ) {
					var MonsterInsightsLocations = (typeof MonsterInsightsExcludeQuery === 'object') ? MonsterInsightsPrivacyGuardFilter( MonsterInsightsExcludeQuery ) : MonsterInsightsPrivacyGuardFilter( MonsterInsightsDefaultLocations );
				} else {
					var MonsterInsightsLocations = (typeof MonsterInsightsExcludeQuery === 'object') ? MonsterInsightsExcludeQuery : MonsterInsightsDefaultLocations;
				}

								var disableStrs = [
										'ga-disable-G-0WL49V0JEN',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for (var index = 0; index < disableStrs.length; index++) {
						if (document.cookie.indexOf(disableStrs[index] + '=true') > -1) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if (__gtagTrackerIsOptedOut()) {
					for (var index = 0; index < disableStrs.length; index++) {
						window[disableStrs[index]] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for (var index = 0; index < disableStrs.length; index++) {
						document.cookie = disableStrs[index] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[disableStrs[index]] = true;
					}
				}

				if ('undefined' === typeof gaOptout) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if (mi_track_user) {
					function __gtagDataLayer() {
						dataLayer.push(arguments);
					}

					function __gtagTracker(type, name, parameters) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply(null, arguments);
							return;
						}

						if (type === 'event') {
														parameters.send_to = monsterinsights_frontend.v4_id;
							var hookName = name;
							if (typeof parameters['event_category'] !== 'undefined') {
								hookName = parameters['event_category'] + ':' + name;
							}

							if (typeof MonsterInsightsDualTracker.trackers[hookName] !== 'undefined') {
								MonsterInsightsDualTracker.trackers[hookName](parameters);
							} else {
								__gtagDataLayer('event', name, parameters);
							}
							
						} else {
							__gtagDataLayer.apply(null, arguments);
						}
					}

					__gtagTracker('js', new Date());
					__gtagTracker('set', {
						'developer_id.dZGIzZG': true,
											});
					if ( MonsterInsightsLocations.page_location ) {
						__gtagTracker('set', MonsterInsightsLocations);
					}
										__gtagTracker('config', 'G-0WL49V0JEN', {"forceSSL":"true"} );
															window.gtag = __gtagTracker;										(function () {
						/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
						/* ga and __gaTracker compatibility shim. */
						var noopfn = function () {
							return null;
						};
						var newtracker = function () {
							return new Tracker();
						};
						var Tracker = function () {
							return null;
						};
						var p = Tracker.prototype;
						p.get = noopfn;
						p.set = noopfn;
						p.send = function () {
							var args = Array.prototype.slice.call(arguments);
							args.unshift('send');
							__gaTracker.apply(null, args);
						};
						var __gaTracker = function () {
							var len = arguments.length;
							if (len === 0) {
								return;
							}
							var f = arguments[len - 1];
							if (typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function') {
								if ('send' === arguments[0]) {
									var hitConverted, hitObject = false, action;
									if ('event' === arguments[1]) {
										if ('undefined' !== typeof arguments[3]) {
											hitObject = {
												'eventAction': arguments[3],
												'eventCategory': arguments[2],
												'eventLabel': arguments[4],
												'value': arguments[5] ? arguments[5] : 1,
											}
										}
									}
									if ('pageview' === arguments[1]) {
										if ('undefined' !== typeof arguments[2]) {
											hitObject = {
												'eventAction': 'page_view',
												'page_path': arguments[2],
											}
										}
									}
									if (typeof arguments[2] === 'object') {
										hitObject = arguments[2];
									}
									if (typeof arguments[5] === 'object') {
										Object.assign(hitObject, arguments[5]);
									}
									if ('undefined' !== typeof arguments[1].hitType) {
										hitObject = arguments[1];
										if ('pageview' === hitObject.hitType) {
											hitObject.eventAction = 'page_view';
										}
									}
									if (hitObject) {
										action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
										hitConverted = mapArgs(hitObject);
										__gtagTracker('event', action, hitConverted);
									}
								}
								return;
							}

							function mapArgs(args) {
								var arg, hit = {};
								var gaMap = {
									'eventCategory': 'event_category',
									'eventAction': 'event_action',
									'eventLabel': 'event_label',
									'eventValue': 'event_value',
									'nonInteraction': 'non_interaction',
									'timingCategory': 'event_category',
									'timingVar': 'name',
									'timingValue': 'value',
									'timingLabel': 'event_label',
									'page': 'page_path',
									'location': 'page_location',
									'title': 'page_title',
									'referrer' : 'page_referrer',
								};
								for (arg in args) {
																		if (!(!args.hasOwnProperty(arg) || !gaMap.hasOwnProperty(arg))) {
										hit[gaMap[arg]] = args[arg];
									} else {
										hit[arg] = args[arg];
									}
								}
								return hit;
							}

							try {
								f.hitCallback();
							} catch (ex) {
							}
						};
						__gaTracker.create = newtracker;
						__gaTracker.getByName = newtracker;
						__gaTracker.getAll = function () {
							return [];
						};
						__gaTracker.remove = noopfn;
						__gaTracker.loaded = true;
						window['__gaTracker'] = __gaTracker;
					})();
									} else {
										console.log("");
					(function () {
						function __gtagTracker() {
							return null;
						}

						window['__gtagTracker'] = __gtagTracker;
						window['gtag'] = __gtagTracker;
					})();
									}
			</script>
				<!-- / Google Analytics by MonsterInsights -->
		<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.vusec.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='/wp-includes/css/dist/block-library/style.min.css?ver=6.6.2' media='all' />
<style id='wp-block-library-theme-inline-css'>
.wp-block-audio :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-audio :where(figcaption){color:#ffffffa6}.wp-block-audio{margin:0 0 1em}.wp-block-code{border:1px solid #ccc;border-radius:4px;font-family:Menlo,Consolas,monaco,monospace;padding:.8em 1em}.wp-block-embed :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-embed :where(figcaption){color:#ffffffa6}.wp-block-embed{margin:0 0 1em}.blocks-gallery-caption{color:#555;font-size:13px;text-align:center}.is-dark-theme .blocks-gallery-caption{color:#ffffffa6}:root :where(.wp-block-image figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme :root :where(.wp-block-image figcaption){color:#ffffffa6}.wp-block-image{margin:0 0 1em}.wp-block-pullquote{border-bottom:4px solid;border-top:4px solid;color:currentColor;margin-bottom:1.75em}.wp-block-pullquote cite,.wp-block-pullquote footer,.wp-block-pullquote__citation{color:currentColor;font-size:.8125em;font-style:normal;text-transform:uppercase}.wp-block-quote{border-left:.25em solid;margin:0 0 1.75em;padding-left:1em}.wp-block-quote cite,.wp-block-quote footer{color:currentColor;font-size:.8125em;font-style:normal;position:relative}.wp-block-quote.has-text-align-right{border-left:none;border-right:.25em solid;padding-left:0;padding-right:1em}.wp-block-quote.has-text-align-center{border:none;padding-left:0}.wp-block-quote.is-large,.wp-block-quote.is-style-large,.wp-block-quote.is-style-plain{border:none}.wp-block-search .wp-block-search__label{font-weight:700}.wp-block-search__button{border:1px solid #ccc;padding:.375em .625em}:where(.wp-block-group.has-background){padding:1.25em 2.375em}.wp-block-separator.has-css-opacity{opacity:.4}.wp-block-separator{border:none;border-bottom:2px solid;margin-left:auto;margin-right:auto}.wp-block-separator.has-alpha-channel-opacity{opacity:1}.wp-block-separator:not(.is-style-wide):not(.is-style-dots){width:100px}.wp-block-separator.has-background:not(.is-style-dots){border-bottom:none;height:1px}.wp-block-separator.has-background:not(.is-style-wide):not(.is-style-dots){height:2px}.wp-block-table{margin:0 0 1em}.wp-block-table td,.wp-block-table th{word-break:normal}.wp-block-table :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-table :where(figcaption){color:#ffffffa6}.wp-block-video :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-video :where(figcaption){color:#ffffffa6}.wp-block-video{margin:0 0 1em}:root :where(.wp-block-template-part.has-background){margin-bottom:0;margin-top:0;padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--green: #24890d;--wp--preset--color--dark-gray: #2b2b2b;--wp--preset--color--medium-gray: #767676;--wp--preset--color--light-gray: #f5f5f5;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='eeb-css-frontend-css' href='/wp-content/plugins/email-encoder-bundle/core/includes/assets/css/style.css?ver=240923-211030' media='all' />
<link rel='stylesheet' id='twentyfourteen-lato-css' href='/wp-content/themes/twentyfourteen/fonts/font-lato.css?ver=20230328' media='all' />
<link rel='stylesheet' id='genericons-css' href='/wp-content/themes/twentyfourteen/genericons/genericons.css?ver=3.0.3' media='all' />
<link rel='stylesheet' id='twentyfourteen-style-css' href='/wp-content/themes/twentyfourteen/style.css?ver=20240716' media='all' />
<link rel='stylesheet' id='twentyfourteen-block-style-css' href='/wp-content/themes/twentyfourteen/css/blocks.css?ver=20240613' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfourteen-ie-css' href='/wp-content/themes/twentyfourteen/css/ie.css?ver=20140711' media='all' />
<![endif]-->
<link rel='stylesheet' id='tmm-css' href='/wp-content/plugins/team-members/inc/css/tmm_style.css?ver=6.6.2' media='all' />
<script src="/wp-content/plugins/google-analytics-for-wordpress/assets/js/frontend-gtag.min.js?ver=9.1.0" id="monsterinsights-frontend-script-js" async data-wp-strategy="async"></script>
<script data-cfasync="false" data-wpfc-render="false" id='monsterinsights-frontend-script-js-extra'>var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/www.vusec.net","hash_tracking":"false","v4_id":"G-0WL49V0JEN"};</script>
<script src="/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script src="/wp-content/plugins/email-encoder-bundle/core/includes/assets/js/custom.js?ver=240923-211030" id="eeb-js-frontend-js"></script>
<script src="/wp-content/themes/twentyfourteen/js/functions.js?ver=20230526" id="twentyfourteen-script-js" defer data-wp-strategy="defer"></script>
<meta name="generator" content="WordPress 6.6.2" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-140026814-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140026814-1');
</script>

<script type="text/javascript">
/* Handle bib=$something url parameter to initialize Bibbase filter (if any). */
function getParameterByName(name, url = window.location.href) {
    name = name.replace(/[\[\]]/g, '\\$&');
    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return null;
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
}

if (window.addEventListener) { // Mozilla, Netscape, Firefox
    window.addEventListener('load', WindowLoad, false);
} else if (window.attachEvent) { // IE
    window.attachEvent('onload', WindowLoad);
}

function WindowLoad(event) {
    var bib = getParameterByName('bib');
    if (!bib)
        return;
    var els = document.getElementsByClassName('form-control');
    if (!els)
        return;
    els[0].value = bib;
    handleSearch(bib);
}
</script>

<style type="text/css">
/* Expand the theme's max-width to something reasonable. */
.site-content .entry-header,
.site-content .entry-content,
.site-content .entry-summary,
.site-content .entry-meta,
.page-content .post-navigation,
.image-navigation .archive-header,
.page-header .contributor-info,
.comments-area .site-main,
.mu_register,
.widecolumn > h2,
.widecolumn > form {
	max-width: 674px;
}

/* Zotpress: hide loading icon. */
.zp-List.loading {
background: none !important;
padding-bottom: 0em !important;
}

/* Remove "Powered by Wordpress" footer. */
.site-info {
   display: none;
}

/* Remove Feedgrabbr banner. */
.uw-w-branding {
  display: none !important;
}

/* BibBase: prettify awards. */
.bibbase_paper .note {
  font-style: italic;
  color: blue;
}

/* People page style. */
.tmm_photo {
	-webkit-filter: grayscale(0);
	filter: grayscale(0);
	-webkit-transition: .2s ease-in-out;
	transition: .2s ease-in-out;
}
.tmm_photo:hover {
	-webkit-filter: grayscale(100%);
	filter: grayscale(100%);
}

.tmm_fname:after { 
     content:"\A"; white-space:pre; 
}
</style>

<link rel="stylesheet" href="https://download.vusec.net/wordpress/prism.css"><style id="custom-background-css">
body.custom-background { background-color: #000000; }
</style>
	<link rel="icon" href="/wp-content/uploads/2016/09/cropped-vusec-logo_small-32x32.png" sizes="32x32" />
<link rel="icon" href="/wp-content/uploads/2016/09/cropped-vusec-logo_small-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="/wp-content/uploads/2016/09/cropped-vusec-logo_small-180x180.png" />
<meta name="msapplication-TileImage" content="/wp-content/uploads/2016/09/cropped-vusec-logo_small-270x270.png" />
		<style id="wp-custom-css">
			/* disable weird word breaks and justify text instead */
.entry-content, .entry-summary, .page-content {
	hyphens: manual;
	text-align: justify;
	text-justify: inter-word;
}

html {
  --vusec-blue: #1287c9;
  --vusec-darkblue: #042030;
	--vusec-brightblue: #1ba1ec;
	--vusec-bg: black;
	--vusec-content-bg: white;
	
	background-color: var(--vusec-bg);
}

body {
	background-color: var(--vusec-bg);
}

#primary {
	background-color: var(--vusec-content-bg);
}

.site-content .entry-content, .site-content .entry-summary, .page-content, .entry-title, .page {
	background-color: var(--vusec-content-bg);
}

.header-main {
	background-color: var(--vusec-blue);
}

#site-header {
	background-color: var(--vusec-bg);
}

.site:before {
	background-color: var(--vusec-bg);
}

#secondary {
	background-color: var(--vusec-bg);
}

@media screen and (min-width: 1080px) {
	#secondary {
		width: 232px;
    padding-top: 0px;
    padding-right: 10px;
    padding-bottom: 0px;
    padding-left: 10px;
	}
}

a {
	color: var(--vusec-blue);
}

a:hover {
	color: var(--vusec-brightblue);
}

.site-navigation .current_page_item > a, .site-navigation .current_page_ancestor > a, .site-navigation .current-menu-item > a, .site-navigation .current-menu-ancestor > a  {
	color: white;
}

.site-navigation a:hover {
  color: white;
}

.primary-navigation ul ul a, .primary-navigation ul ul li > a {
  background-color: var(--vusec-blue);
}

.primary-navigation ul ul a:hover, .primary-navigation ul ul li.focus > a {
  background-color: var(--vusec-brightblue);
}

.search-toggle {
  background-color: var(--vusec-blue);
}
.search-toggle:hover {
  background-color: var(--vusec-brightblue);
}
.search-toggle.active {
  background-color: var(--vusec-brightblue);
}

.search-box {
  background-color: var(--vusec-blue);
}

.menu-toggle {
  background-color: var(--vusec-blue);
}

.menu-toggle:active, .menu-toggle:focus, .menu-toggle:hover {
    background-color: var(--vusec-brightblue);
}

.primary-navigation li:hover > a, .primary-navigation li.focus > a {
  background-color: var(--vusec-brightblue);
}

::selection {
	background:  var(--vusec-brightblue);
	color: #fff;
	text-shadow: none;
}

/* Center the page */
#page {
	margin: 0 auto;
}

#site-header > a > img {
	width: 50%;
	padding-left: 25%;
	padding-right: 25%;
	padding-top: 1em;
	margin-bottom: 1em;
}

#custom_html-6 {
	padding-left: 1em;
	margin-bottom: 0em;
}

.site-description {
	padding: 1em 1em 0em 1em;
	font-style: bold;
	text-align: center;
}

.navbar-form input {
    max-width: 40vw;
}		</style>
		</head>

<body class="page-template-default page page-id-2940 page-child parent-pageid-15 custom-background wp-embed-responsive group-blog header-image full-width singular">
<div id="page" class="hfeed site">
		<div id="site-header">
		<a href="/" rel="home">
			<img src="/wp-content/uploads/2022/09/cropped-vusec.png" width="1260" height="343" alt="vusec" srcset="/wp-content/uploads/2022/09/cropped-vusec.png 1260w, /wp-content/uploads/2022/09/cropped-vusec-768x209.png 768w" sizes="(max-width: 1260px) 100vw, 1260px" decoding="async" fetchpriority="high" />		</a>
	</div>
	
	<header id="masthead" class="site-header">
		<div class="header-main">
			<h1 class="site-title"><a href="/" rel="home">vusec</a></h1>

			<div class="search-toggle">
				<a href="#search-container" class="screen-reader-text" aria-expanded="false" aria-controls="search-container">
					Search				</a>
			</div>

			<nav id="primary-navigation" class="site-navigation primary-navigation">
				<button class="menu-toggle">Primary Menu</button>
				<a class="screen-reader-text skip-link" href="#content">
					Skip to content				</a>
				<div class="menu-menu-1-container"><ul id="primary-menu" class="nav-menu"><li id="menu-item-123" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-123"><a href="/">About VUSec</a></li>
<li id="menu-item-127" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-127"><a href="/people/">People</a>
<ul class="sub-menu">
	<li id="menu-item-159" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-159"><a href="/people#faculty">Faculty</a></li>
	<li id="menu-item-161" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-161"><a href="/people#phd-students">PhD Students</a></li>
	<li id="menu-item-245" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-245"><a href="/people#support">Support</a></li>
	<li id="menu-item-246" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-246"><a href="/people#alumni">Alumni</a></li>
</ul>
</li>
<li id="menu-item-133" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-has-children menu-item-133"><a href="/projects/">Projects</a>
<ul class="sub-menu">
	<li id="menu-item-162" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-162"><a href="/projects#armoring">Binary Armoring</a></li>
	<li id="menu-item-163" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-163"><a href="/projects#bama">Binary and Malware Analysis</a></li>
	<li id="menu-item-168" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-168"><a href="/projects#hardware-vulnerabilities">Hardware Vulnerabilities</a></li>
	<li id="menu-item-166" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-166"><a href="/projects#mobile">Mobile Security</a></li>
	<li id="menu-item-167" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-167"><a href="/projects#side-channels">Side Channels</a></li>
	<li id="menu-item-772" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-772"><a href="/projects#software-exploitation">Software Exploitation</a></li>
	<li id="menu-item-164" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-164"><a href="/projects#reliability">Software Reliability</a></li>
	<li id="menu-item-165" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-165"><a href="/projects#testing">Software Testing</a></li>
</ul>
</li>
<li id="menu-item-1956" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1956"><a href="/highlights/">Highlights</a></li>
<li id="menu-item-135" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-135"><a href="/publications/">Publications</a></li>
<li id="menu-item-136" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-136"><a href="/news/">News</a></li>
<li id="menu-item-388" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-388"><a href="/join/">Join</a></li>
<li id="menu-item-507" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-507"><a href="/student-projects/">Student projects</a></li>
<li id="menu-item-137" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-137"><a href="/funding/">Funding</a></li>
<li id="menu-item-139" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-139"><a href="/contacts/">Contacts</a></li>
</ul></div>			</nav>
		</div>

		<div id="search-container" class="search-box-wrapper hide">
			<div class="search-box">
				<form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>			</div>
		</div>
	</header><!-- #masthead -->

	<div id="main" class="site-main">

<div id="main-content" class="main-content">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

			
<article id="post-2940" class="post-2940 page type-page status-publish hentry">
	<header class="entry-header"><h1 class="entry-title">GhostRace</h1></header><!-- .entry-header -->
	<div class="entry-content">
		
<p class="has-text-align-left has-medium-gray-color has-text-color has-link-color has-medium-font-size wp-elements-3f38c846d514775aad82b2da605144c1"><strong>Exploiting and Mitigating Speculative Race Conditions</strong></p>



<h3 class="wp-block-heading"><a href="https://www.cve.org/CVERecord?id=CVE-2024-2193" target="_blank" rel="noreferrer noopener">GhostRace: CVE-2024-2193</a></h3>



<p>Race conditions arise when multiple threads attempt to access a shared resource without proper synchronization, often leading to vulnerabilities such as concurrent use-after-free. To mitigate their occurrence, operating systems rely on synchronization primitives such as mutexes, spinlocks, etc.</p>



<p><strong>In this work, we present GhostRace, the first security analysis of these primitives on speculatively executed code paths.</strong></p>



<p><strong>Our key finding is that all the common synchronization primitives implemented using conditional branches (<a href="#mutex-lock">Figure 1</a>) can be microarchitecturally bypassed on speculative paths using a Spectre-v1 attack, turning all architecturally race-free critical regions into Speculative Race Conditions (SRCs), allowing attackers to leak information from the target software.</strong></p>


<div class="wp-block-image">
<figure class="aligncenter is-resized" id="mutex-lock"><img decoding="async" src="https://lh7-us.googleusercontent.com/A5mtFcjtk0myeLsZ-QqmBi7iFv_h_3wrIdzAVSwGwRiFe35KkzdgkIIiCjko7ORcEoCf7B8-PvbAlpf8nJ92oFNDS3uFdaVSm24VCzdK5dSBPSK-WUKDkXSRf-bWNxK6-Bru6g4W0iC8zA8x3UFcy9Q" alt="Figure 1: Top part: The core implementation of the mutex_lock synchronization primitive in the Linux x86-64 kernel, with the conditional branch that can be abused to craft SRCs in red. Bottom part: The branch ultimately checks the outcome of the lock cmpxchgq instruction, which does not serialize the execution." style="width:434px;height:auto" title="Figure 1"/><figcaption class="wp-element-caption"><em>Figure 1: Top part: The core implementation of the mutex_lock synchronization primitive in the Linux x86-64 kernel, with the conditional branch that can be abused to craft SRCs in red. Bottom part: The branch ultimately checks the outcome of the lock cmpxchgq instruction, which does not serialize the execution.</em></figcaption></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Our <a href="http://download.vusec.net/papers/ghostrace_sec24.pdf" target="_blank" rel="noreferrer noopener">GhostRace Paper (PDF)</a> is accepted for publication at the 33rd USENIX Security Symposium 2024.</strong> <strong>This is a joint project with the <a href="https://ibm.github.io/system-security-research-updates/2024/03/12/ghostrace" target="_blank" rel="noreferrer noopener">Systems Security Research Group</a> at IBM Research Europe</strong>.</p>



<script src="https://bibbase.org/show?bib=https%3A%2F%2Fdownload.vusec.net%2Fpapers%2Fzotero.php%3FitemKey%3DDB6B792Q%26full%3D%26format%3Dbibtex%26sort%3Ddate%26limit%3D1000&theme=default&jsonp=1&owner=none&filter="></script>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h2 class="wp-block-heading">Speculative Synchronization Primitives</h2>



<p><strong>Our analysis shows <em>all </em>the other common write-side synchronization primitives in the Linux kernel are ultimately implemented through a conditional branch and are therefore vulnerable to speculative race conditions. </strong></p>



<p>To experimentally confirm this intuition, we tested all such synchronization primitives under speculative execution after mistraining the vulnerable branch. <strong>In all cases, we confirmed transient execution of the guarded critical region despite another victim thread already architecturally executing in the region.</strong> To determine the transient window size, we measured the maximum number of speculative load instructions we could speculatively execute inside the critical region (<a href="#speculative-window">Figure 2</a>).</p>


<div class="wp-block-image">
<figure class="aligncenter is-resized" id="speculative-window"><img decoding="async" src="https://lh7-us.googleusercontent.com/W2JoafY-Chy0JQdu9ihuVmr0G2gq3U4P4RAjvjVbZXGSqvG6Qy2MDPB6SUWb1UnYEHwM0rWRbl33eND2PK9oIS0mGWPxvPy7KfOca9oGK5Ewfe8MFPMYkz2TM6rjmAX6x4pZA7O_aGcACISPdxgYo1U" alt="Figure 2: Transient window size for different write-side synchronization mechanisms, i.e., the number of speculative loads that leave an observable microarchitectural trace." style="width:454px;height:auto" title="Figure 2"/><figcaption class="wp-element-caption"><em>Figure 2: Speculative window size for different write-side synchronization mechanisms, i.e., the number of speculative loads that leave an observable microarchitectural trace.</em></figcaption></figure></div>


<h2 class="wp-block-heading">SCUAF Gadget Scanner</h2>



<p>To investigate the severity of SRCs, <strong>we concentrate on Speculative Concurrent Use-After-Free (SCUAF) and statically scan the Linux kernel with Coccinelle (<a href="#cocci-script">Figure 3</a>),</strong> <strong>discovering 1,283 potentially exploitable gadgets</strong>.</p>


<div class="wp-block-image">
<figure class="aligncenter" id="cocci-script"><img decoding="async" src="https://lh7-us.googleusercontent.com/k-oVgKvuKIRcC7XY9rj2RwuZKN54Dri-xlgnKnGXf5fDlNeptlXJI8F-yZSkpfi_1r3x2RnsCxjyAynYRgt_jCOBKOUskRZfC2Rxpy1ko3hWRSVZo_mr0JdMV34y235LlLOVpOQ9K01R_rckQ-0AFWE" alt="Figure 3: Simplified Cocci scripts (left Free and right Use) scanning for SCUAF gadgets in the Linux kernel." title="Figure 3"/><figcaption class="wp-element-caption"><em>Figure 3: Simplified Cocci scripts (left Free and right Use) scanning for SCUAF gadgets in the Linux kernel.</em></figcaption></figure></div>


<h3 class="wp-block-heading"><a href="https://lore.kernel.org/lkml/2024022614-unhappily-python-2cd0@gregkh/" target="_blank" rel="noreferrer noopener">IPI Storming: CVE-2024-26602</a></h3>



<p>To win an SRC, we need to interrupt the execution of the victim process at the right point (i.e., when the dangling pointer is created), and keep the victim there forever so that the attacker can perform the SCUAF attack. In order to achieve this, we created a new exploitation technique called Inter-Process Interrupt (IPI) Storming, which consists of infinitely flooding the victim process&#8217;s CPU core with IPIs once interrupted so that it never finishes handling the incoming interrupts, <strong>resulting in creating an unbounded exploitation window that allows the attacker to execute an arbitrary number of SCUAF invocations to mount an end-to-end attack within a single race window.</strong> In <a href="#IPI-storming">Figure 4</a> we show how the increasing number of storming SMTs widens the UAF exploitation window.</p>


<div class="wp-block-image">
<figure class="aligncenter is-resized" id="IPI-storming"><img decoding="async" src="https://lh7-us.googleusercontent.com/MKaHNmZBeMuo9s0UQxTYuDHsvBHGF5ESIx38LAav9IXwcfpG_CG3UULkDrWFNzyjjrydVIHnFz6O172oktSAiegAkwsqeSHiv_NsTjtdFYM1SVsBsStW4TpdawvWe12sXRrIuhBoiBjINO969rMiI4k" alt="Figure 4: Size of the UAF exploitation window vs. number of IPI storming cores targeting the victim core." style="width:460px;height:auto" title="Figure 4"/><figcaption class="wp-element-caption"><em>Figure 4: Size of the UAF exploitation window vs. number of IPI storming cores targeting the victim core.</em> Our test CPU contains 16 cores and 24 SMTs.</figcaption></figure></div>


<h3 class="wp-block-heading">SCUAF Information Disclosure Attacks</h3>



<p>Furthermore, we show that SCUAF information disclosure attacks (<a href="#SCUAF-attack">Figure 5</a>) on the kernel are feasible and can match the reliability of typical Spectre attacks, with <strong>our proof of concept leaking kernel memory at 12 KB/s</strong>.</p>


<div class="wp-block-image">
<figure class="aligncenter is-resized" id="SCUAF-attack"><img decoding="async" src="https://lh7-us.googleusercontent.com/fwbNm1aDJw8BM6BTUTesMeblQ3_umrNPB86olhS8i8HDwionIkY1lXfnzn6DhPXp4SDQRjdYeqO1YK2ry_j-A5DPqYOrhlQRBbEEzVgq9P-OikA5ZBc6gTx0FKHoP86RgRCvlQ_q1MhE8PdPZE0lEbg" alt="Figure 5: Speculative information disclosure attack exploiting a speculative race condition. Steps 1-4 and 8-10 run in user mode, issuing syscalls to trigger the relevant kernel code. The other steps run in kernel mode. Our gadget scanner identified the nfc_hci_msg_tx_work function as a SCUAF gadget in the Linux kernel." style="width:746px;height:auto" title="Figure 5"/><figcaption class="wp-element-caption"><em>Figure 5: Speculative information disclosure attack exploiting a speculative race condition. Steps 1-4 and 8-10 run in user mode, issuing syscalls to trigger the relevant kernel code. The other steps run in kernel mode. Our gadget scanner identified the nfc_hci_msg_tx_work function as a SCUAF gadget in the Linux kernel.</em></figcaption></figure></div>


<h2 class="wp-block-heading" id="code">Code</h2>



<p>You can find a minimalistic PoC exemplifying the concept of SRC in a step-by-step single-threaded fashion, Coccinelle SCUAF-scanning scripts, and 1200+ SCUAF gadgets found in the Linux kernel at <a href="https://github.com/vusec/ghostrace" target="_blank" rel="noreferrer noopener">https://github.com/vusec/ghostrace</a></p>



<h2 class="wp-block-heading" id="affected-hw-sw">Affected Hardware &amp; Software</h2>



<p>While we have explicitly focused on x86 and Linux in the paper, SRCs also affect other hardware and software targets.</p>



<p><strong>Hardware</strong>: We have confirmed that all the major hardware vendors are affected by SRCs since, regardless of the particular compare-and-exchange instruction implementation, the conditional branch that follows is subject to branch (mis)prediction. In other words, all the microarchitectures affected by Spectre-v1 are also affected by SRCs.</p>



<p><strong>Software</strong>: Any target relying on conditional branches to determine whether to enter critical regions—a common design pattern that extends well beyond Linux—is vulnerable to SRCs.</p>



<p><strong>In summary, any software, e.g., operating system, hypervisor, etc., implementing synchronization primitives through conditional branches without any serializing instruction on that path and running on any microarchitecture (e.g., x86, ARM, RISC-V, etc.), which allows conditional branches to be speculatively executed, is vulnerable to SRCs. As in other speculative execution attacks, this allows leaking data from the target software.</strong></p>



<h2 class="wp-block-heading" id="mitigation">Mitigation</h2>



<p>To address the new attack surface,<strong> we also propose a generic SRC mitigation to serialize all the affected synchronization primitives on Linux </strong>(i.e., adding an <code>lfence</code> instruction after the <code>lock cmpxchq</code> in <a href="#mutex-lock">Figure 1</a>)<strong>.</strong> Our mitigation requires minimal kernel changes <strong>(i.e., 2 LoC)</strong> <strong>and incurs only ≈5% geomean performance overhead on LMBench.</strong></p>



<h2 class="wp-block-heading" id="disclosure">Disclosure</h2>



<p>We disclosed Speculative Race Conditions to the major hardware vendors (Intel, AMD, ARM, and IBM) and the Linux kernel in late 2023.</p>



<p>Hardware vendors have further notified other affected software (OS/hypervisors) vendors, and all parties have acknowledged the reported issue (<a href="https://www.cve.org/CVERecord?id=CVE-2024-2193" target="_blank" rel="noreferrer noopener"><strong>CVE-2024-2193</strong></a>). Specifically, AMD responded with an explicit impact statement (i.e., “existing [Spectre-v1] mitigations apply”), pointing to the attacks relying on conditional branch mis-speculation, like Spectre-v1.</p>



<p><strong>The Linux kernel developers have no immediate plans to implement our proposed serialization of synchronization primitives due to performance concerns</strong>. However, they confirmed the IPI storming issue (<a href="https://lore.kernel.org/lkml/2024022614-unhappily-python-2cd0@gregkh/" target="_blank" rel="noreferrer noopener"><strong>CVE-2024-26602</strong></a>) and <strong>implemented an </strong><a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=944d5fe50f3f03daacfea16300e656a1691c4a23" target="_blank" rel="noreferrer noopener"><strong>IPI rate-limiting feature</strong></a> to address the CPU saturation issue by adding a synchronization mutex on the path of sys_membarrier and avoiding its concurrent execution on multiple cores. <strong>Unfortunately, as our experiments show (Figure 4), hindering IPI storming primitives (i.e., 0 storming cores) is insufficient to close the attack surface completely.</strong></p>



<h2 class="wp-block-heading">Acknowledgments</h2>



<p>We would like to thank the anonymous reviewers for their feedback, Andrew Cooper for his early comments on the paper, Julia Lawall for the Coccinelle clarifications, and Alessandro Sorniotti for the early discussions about the project. This work was partially supported by Intel Corporation through the “Allocamelus” project, by the Dutch Research Council (NWO) through project “INTERSECT”, and by the European Union’s Horizon Europe program under grant agreement No. 101120962 (“Rescale”).</p>
	</div><!-- .entry-content -->
</article><!-- #post-2940 -->

		</div><!-- #content -->
	</div><!-- #primary -->
	</div><!-- #main-content -->

<div id="secondary">
		<h2 class="site-description">Systems and Network Security Group at VU Amsterdam</h2>
	
	
		<div id="primary-sidebar" class="primary-sidebar widget-area" role="complementary">
		<aside id="custom_html-6" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="display:flex;flex-wrap:wrap"><a href="https://twitter.com/vu5ec" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:none;outline:none;width:26px;height:26px;padding:2px;margin:5px;color:#ffffff;border-radius:15%;background-color:#55acee;transition:all 0.2s ease;" onmouseover="this.style.webkitTransform='scale(1.3)';this.style.msTransform ='scale(1.3)';this.style.transform='scale(1.3)';" onmouseout="this.style.webkitTransform='scale(1.0)';this.style.msTransform ='scale(1.0)';this.style.transform='scale(1.0)';"><svg class="niftybutton-twitter" style="display:block;fill:currentColor" data-tag="twi" data-name="Twitter" viewbox="0 0 512 512" preserveaspectratio="xMidYMid meet">
	<path d="M419.6 168.6c-11.7 5.2-24.2 8.7-37.4 10.2 13.4-8.1 23.8-20.8 28.6-36 -12.6 7.5-26.5 12.9-41.3 15.8 -11.9-12.6-28.8-20.6-47.5-20.6 -42 0-72.9 39.2-63.4 79.9 -54.1-2.7-102.1-28.6-134.2-68 -17 29.2-8.8 67.5 20.1 86.9 -10.7-0.3-20.7-3.3-29.5-8.1 -0.7 30.2 20.9 58.4 52.2 64.6 -9.2 2.5-19.2 3.1-29.4 1.1 8.3 25.9 32.3 44.7 60.8 45.2 -27.4 21.4-61.8 31-96.4 27 28.8 18.5 63 29.2 99.8 29.2 120.8 0 189.1-102.1 185-193.6C399.9 193.1 410.9 181.7 419.6 168.6z"></path>
</svg></a>

<a href="https://www.youtube.com/c/VusecNetwork" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:none;outline:none;width:26px;height:26px;padding:2px;margin:5px;color:#ffffff;border-radius:15%;background-color:#e02a20;transition:all 0.2s ease;" onmouseover="this.style.webkitTransform='scale(1.3)';this.style.msTransform ='scale(1.3)';this.style.transform='scale(1.3)';" onmouseout="this.style.webkitTransform='scale(1.0)';this.style.msTransform ='scale(1.0)';this.style.transform='scale(1.0)';"><svg class="niftybutton-youtube" style="display:block;fill:currentColor" data-donate="true" data-tag="you" data-name="YouTube" viewbox="0 0 512 512" preserveaspectratio="xMidYMid meet">
	<path d="M422.6 193.6c-5.3-45.3-23.3-51.6-59-54 -50.8-3.5-164.3-3.5-215.1 0 -35.7 2.4-53.7 8.7-59 54 -4 33.6-4 91.1 0 124.8 5.3 45.3 23.3 51.6 59 54 50.9 3.5 164.3 3.5 215.1 0 35.7-2.4 53.7-8.7 59-54C426.6 284.8 426.6 227.3 422.6 193.6zM222.2 303.4v-94.6l90.7 47.3L222.2 303.4z"></path>
</svg></a>

<a href="https://github.com/vusec" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:none;outline:none;width:26px;height:26px;padding:2px;margin:5px;color:#ffffff;border-radius:15%;background-color:#454545;transition:all 0.2s ease;" onmouseover="this.style.webkitTransform='scale(1.3)';this.style.msTransform ='scale(1.3)';this.style.transform='scale(1.3)';" onmouseout="this.style.webkitTransform='scale(1.0)';this.style.msTransform ='scale(1.0)';this.style.transform='scale(1.0)';"><svg class="niftybutton-github" style="display:block;fill:currentColor" data-donate="true" data-tag="git" data-name="Github" viewbox="0 0 512 512" preserveaspectratio="xMidYMid meet">
	<path d="M256 70.7c-102.6 0-185.9 83.2-185.9 185.9 0 82.1 53.3 151.8 127.1 176.4 9.3 1.7 12.3-4 12.3-8.9V389.4c-51.7 11.3-62.5-21.9-62.5-21.9 -8.4-21.5-20.6-27.2-20.6-27.2 -16.9-11.5 1.3-11.3 1.3-11.3 18.7 1.3 28.5 19.2 28.5 19.2 16.6 28.4 43.5 20.2 54.1 15.4 1.7-12 6.5-20.2 11.8-24.9 -41.3-4.7-84.7-20.6-84.7-91.9 0-20.3 7.3-36.9 19.2-49.9 -1.9-4.7-8.3-23.6 1.8-49.2 0 0 15.6-5 51.1 19.1 14.8-4.1 30.7-6.2 46.5-6.3 15.8 0.1 31.7 2.1 46.6 6.3 35.5-24 51.1-19.1 51.1-19.1 10.1 25.6 3.8 44.5 1.8 49.2 11.9 13 19.1 29.6 19.1 49.9 0 71.4-43.5 87.1-84.9 91.7 6.7 5.8 12.8 17.1 12.8 34.4 0 24.9 0 44.9 0 51 0 4.9 3 10.7 12.4 8.9 73.8-24.6 127-94.3 127-176.4C441.9 153.9 358.6 70.7 256 70.7z"></path>
</svg></a>

<a href="javascript:;" data-enc-email="vasb[at]ihfrp.arg" target="_blank" rel="noopener noreferrer" style="text-decoration:none;border:none;outline:none;width:26px;height:26px;padding:2px;margin:5px;color:#ffffff;border-radius:15%;background-color:#0066bf;transition:all 0.2s ease;" onmouseover="this.style.webkitTransform='scale(1.3)';this.style.msTransform ='scale(1.3)';this.style.transform='scale(1.3)';" onmouseout="this.style.webkitTransform='scale(1.0)';this.style.msTransform ='scale(1.0)';this.style.transform='scale(1.0)';" class="mail-link" data-wpel-link="ignore"><svg class="niftybutton-email" style="display:block;fill:currentColor" data-donate="true" data-tag="ema" data-name="Email" viewbox="0 0 512 512" preserveaspectratio="xMidYMid meet">
	<path d="M101.3 141.6v228.9h0.3 308.4 0.8V141.6H101.3zM375.7 167.8l-119.7 91.5 -119.6-91.5H375.7zM127.6 194.1l64.1 49.1 -64.1 64.1V194.1zM127.8 344.2l84.9-84.9 43.2 33.1 43-32.9 84.7 84.7L127.8 344.2 127.8 344.2zM384.4 307.8l-64.4-64.4 64.4-49.3V307.8z"></path>
</svg></a>

</div></div></aside><aside id="block-2" class="widget widget_block">
<h2 class="wp-block-heading">Recent Tweets</h2>
</aside><aside id="block-3" class="widget widget_block"><p><a class="twitter-timeline" data-theme="dark" data-chrome="nofooter noheader transparent noborders" data-dnt="true" data-border-color="#000000" data-tweet-limit="3" href="https://twitter.com/vu5ec?ref_src=twsrc%5Etfw">Recent Tweets</a> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p></aside><aside id="block-4" class="widget widget_block">
<h2 class="wp-block-heading">Recent Posts</h2>
</aside><aside id="block-5" class="widget widget_block"><div class="feedgrabbr_widget" id="fgid_477dab24ea8ddea2b6ce33ff6"></div>
<p><script>if (typeof (fg_widgets) === "undefined") fg_widgets = new Array(); fg_widgets.push("fgid_477dab24ea8ddea2b6ce33ff6");</script><br>
<script async="" src="https://www.feedgrabbr.com/widget/fgwidget.js"></script></p></aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1><nav aria-label="Archives">
			<ul>
					<li><a href='/2021/08/'>August 2021</a></li>
	<li><a href='/2020/12/'>December 2020</a></li>
	<li><a href='/2020/08/'>August 2020</a></li>
	<li><a href='/2020/05/'>May 2020</a></li>
	<li><a href='/2020/03/'>March 2020</a></li>
	<li><a href='/2020/01/'>January 2020</a></li>
	<li><a href='/2019/11/'>November 2019</a></li>
	<li><a href='/2019/05/'>May 2019</a></li>
	<li><a href='/2019/03/'>March 2019</a></li>
	<li><a href='/2018/11/'>November 2018</a></li>
	<li><a href='/2018/07/'>July 2018</a></li>
	<li><a href='/2018/05/'>May 2018</a></li>
	<li><a href='/2018/03/'>March 2018</a></li>
	<li><a href='/2018/01/'>January 2018</a></li>
	<li><a href='/2017/12/'>December 2017</a></li>
	<li><a href='/2017/11/'>November 2017</a></li>
	<li><a href='/2017/10/'>October 2017</a></li>
	<li><a href='/2017/09/'>September 2017</a></li>
	<li><a href='/2017/08/'>August 2017</a></li>
	<li><a href='/2017/07/'>July 2017</a></li>
	<li><a href='/2017/04/'>April 2017</a></li>
	<li><a href='/2017/03/'>March 2017</a></li>
	<li><a href='/2017/02/'>February 2017</a></li>
	<li><a href='/2017/01/'>January 2017</a></li>
	<li><a href='/2016/12/'>December 2016</a></li>
	<li><a href='/2016/11/'>November 2016</a></li>
	<li><a href='/2016/10/'>October 2016</a></li>
	<li><a href='/2016/09/'>September 2016</a></li>
	<li><a href='/2016/08/'>August 2016</a></li>
	<li><a href='/2016/07/'>July 2016</a></li>
	<li><a href='/2016/05/'>May 2016</a></li>
	<li><a href='/2016/04/'>April 2016</a></li>
	<li><a href='/2016/02/'>February 2016</a></li>
	<li><a href='/2016/01/'>January 2016</a></li>
	<li><a href='/2014/06/'>June 2014</a></li>
			</ul>

			</nav></aside><aside id="categories-4" class="widget widget_categories"><h1 class="widget-title">Categories</h1><nav aria-label="Categories">
			<ul>
					<li class="cat-item cat-item-73"><a href="/category/award/">award</a>
</li>
	<li class="cat-item cat-item-76"><a href="/category/grant/">grant</a>
</li>
	<li class="cat-item cat-item-74"><a href="/category/presentation/">presentation</a>
</li>
	<li class="cat-item cat-item-2"><a href="/category/press/">press</a>
</li>
	<li class="cat-item cat-item-4"><a href="/category/publication/">publication</a>
</li>
	<li class="cat-item cat-item-77"><a href="/category/statement/">statement</a>
</li>
	<li class="cat-item cat-item-72"><a href="/category/strategy/">strategy</a>
</li>
	<li class="cat-item cat-item-1"><a href="/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-75"><a href="/category/uptake/">uptake</a>
</li>
			</ul>

			</nav></aside>	</div><!-- #primary-sidebar -->
	</div><!-- #secondary -->

		</div><!-- #main -->

		<footer id="colophon" class="site-footer">

			
			<div class="site-info">
												<a href="https://wordpress.org/" class="imprint">
					Proudly powered by WordPress				</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	<script defer src="https://download.vusec.net/wordpress/prism.js"></script>			<script type="text/javascript">function showhide_toggle(e,t,r,g){var a=jQuery("#"+e+"-link-"+t),s=jQuery("a",a),i=jQuery("#"+e+"-content-"+t),l=jQuery("#"+e+"-toggle-"+t);a.toggleClass("sh-show sh-hide"),i.toggleClass("sh-show sh-hide").toggle(),"true"===s.attr("aria-expanded")?s.attr("aria-expanded","false"):s.attr("aria-expanded","true"),l.text()===r?(l.text(g),a.trigger("sh-link:more")):(l.text(r),a.trigger("sh-link:less")),a.trigger("sh-link:toggle")}</script>
	<style id='core-block-supports-inline-css'>
.wp-elements-3f38c846d514775aad82b2da605144c1 a:where(:not(.wp-element-button)){color:var(--wp--preset--color--medium-gray);}
</style>
<script src="/wp-content/plugins/simple-share-buttons-adder/js/ssba.js?ver=1727126364" id="simple-share-buttons-adder-ssba-js"></script>
<script id="simple-share-buttons-adder-ssba-js-after">
Main.boot( [] );
</script>
</body>
</html>

<!-- created by Shifter Generator ver.2.5.4 (production) (Dec 16th 2024, 6:04:22 pm +00:00) (md5:1619821501789c0ea243ae9e68b1a8d7) --->