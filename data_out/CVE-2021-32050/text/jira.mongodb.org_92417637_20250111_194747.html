

[Log in](/login.jsp?os_destination=%2Fbrowse%2FCDRIVER-3797)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![MongoDB Jira](/s/ub562g/9160001/fy41z4/_/jira-logo-scaled.png)](https://jira.mongodb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [eazyBI](/plugins/servlet/eazybi)

* Give feedback to Atlassian
* [Help](/secure/ViewKeyboardShortcuts%21default.jspa "Help")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FCDRIVER-3797)
  + [Acknowledged notifications](/plugins/servlet/wittified/profile/notifications)

![Uploaded image for project: 'C Driver'](https://jira.mongodb.org/secure/projectavatar?pid=10030&avatarId=14108)

1. [C Driver](/browse/CDRIVER)
2. [CDRIVER-3797](/browse/CDRIVER-3797)

## Redact sensitive commands from command monitoring

Schedule Issue[Undo Transition](/secure/UndoTransition%21default.jspa?id=1474103)ClosedExportnullXMLWordPrintableJSON
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Major - P3](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.") Major - P3
* **Fix Version/s:**
  [1.17.7](/issues/?jql=project+%3D+CDRIVER+AND+fixVersion+%3D+1.17.7 "1.17.7 Command monitoring redaction, OpenSSL entropy, DNS error improvement")
* **Affects Version/s:**
  None
* **Component/s:**
  None
* **Labels:**
  None
### Description

**CVE ID:** CVE-2021-32050

**Title:** Some MongoDB Drivers may publish events containing authentication-related data to a command listener configured by an application

**Description**:

Some MongoDB Drivers may erroneously publish events containing authentication-related data to a command listener configured by an application. The published events may contain security-sensitive data when specific authentication-related commands are executed.

Without due care, an application may inadvertently expose this sensitive information, e.g., by writing it to a log file. This issue only arises if an application enables the command listener feature (this is not enabled by default).

This issue affects the MongoDB C Driver 1.0.0 prior to 1.17.7, MongoDB PHP Driver 1.0.0 prior to 1.9.2, MongoDB Swift Driver 1.0.0 prior to 1.1.1, MongoDB Node.js Driver 3.6 prior to 3.6.10, MongoDB Node.js Driver 4.0 prior to 4.17.0 and MongoDB Node.js Driver 5.0 prior to 5.8.0. This issue also affects users of the MongoDB C++ Driver dependent on the C driver 1.0.0 prior to 1.17.7 (C++ driver prior to 3.7.0).

**CVSS Score:** 4.2

CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N

**CWE ID:** CWE-200 Exposure of Sensitive Information to an Unauthorized Actor

**Exact affected versions:**

MongoDB C Driver 1.0.0 prior to 1.17.7

MongoDB C++ Driver 3.0.0 prior to 3.7.0

MongoDB PHP Driver 1.0.0 prior to 1.9.2

MongoDB Swift Driver 1.0.0 prior to 1.1.1

MongoDB Node.js Driver 3.6 prior to  3.6.10

MongoDB Node.js Driver 4.0 prior to 4.17.0

MongoDB Node.js Driver 5.0 prior to 5.8.0

**Is fixed version available:**  Yes

**How the issue was discovered:** Internally

### Attachments

### Attachments

* Options
  + - [Sort By Name](/browse/CDRIVER-3797?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
    - [Sort By Date](/browse/CDRIVER-3797?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
    - [Ascending](/browse/CDRIVER-3797?attachmentOrder=asc#attachmentmodule "Ascending")
    - [Descending](/browse/CDRIVER-3797?attachmentOrder=desc#attachmentmodule "Descending")
    - [Thumbnails](/browse/CDRIVER-3797?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
    - [List](/browse/CDRIVER-3797?attachmentViewMode=list#attachmentmodule "List")
    - [Download All](/secure/attachmentzip/1474103.zip "Download all attachments as a ZIP file")

1. [no-redaction.c](/secure/attachment/319552/no-redaction.c "no-redaction.c - Latest Jun 09 2021 04:51:48 PM UTC - Kevin Albertson")3 kBJun 09 2021 04:51:48 PM UTC
### Issue Links

is depended on by

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[PHPC-1869](/browse/PHPC-1869)
Redact sensitive commands from command monitoring

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[CDRIVER-2669](/browse/CDRIVER-2669)
APM events for auth commands

* ![Minor - P4 - Minor loss of function, or other problem where easy workaround is present.](/images/icons/priorities/minor.svg "Minor - P4 - Minor loss of function, or other problem where easy workaround is present.")
* Backlog

![Task - A task that needs to be done.](/secure/viewavatar?size=xsmall&avatarId=14718&avatarType=issuetype "Task - A task that needs to be done.")
[CDRIVER-4038](/browse/CDRIVER-4038)
Test redaction of replies to security-sensitive commands

* ![Major - P3 - Major loss of function.](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.")
* Closed

![Improvement - An improvement or enhancement to an existing feature or task.](/secure/viewavatar?size=xsmall&avatarId=14710&avatarType=issuetype "Improvement - An improvement or enhancement to an existing feature or task.")
[CDRIVER-4000](/browse/CDRIVER-4000)
Add test for security-sensitive command monitoring event redaction

* ![Critical - P2 - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - P2 - Crashes, loss of data, severe memory leak.")
* Closed

### Activity

### People

Assignee:
![andreas.braun@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Andreas Braun

Reporter:
![kevin.albertson@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Kevin Albertson

Votes:
0
Vote for this issue

Watchers:
5
Start watching this issue

### Dates

Created:

Sep 14 2020 10:23:34 PM UTC

Updated:

Oct 28 2023 11:28:38 AM UTC

Resolved:

Jul 05 2021 06:58:11 PM UTC

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MongoDB. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

