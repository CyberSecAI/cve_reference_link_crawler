- **Root cause of vulnerability:** The `domlsd()` function in `ls.c` does not properly check if the `base` pointer has reached the end of the `cmd` buffer before incrementing it in a `while` loop used to skip spaces or non-spaces. This leads to an out-of-bounds read when processing a crafted input.
- **Weaknesses/vulnerabilities present:** Out-of-bounds read. The code uses a `while` loop with a post-incrementing pointer to skip spaces or non-space characters within a buffer without verifying if the pointer is still within the bounds of the buffer.
- **Impact of exploitation:** An attacker can cause an out-of-bounds read which can lead to application crashes and possibly sensitive information disclosure.
- **Attack vectors:** Sending a specially crafted `MLSD` command with a long string of non-space characters will trigger the vulnerability in the `domlsd()` function.
- **Required attacker capabilities/position:** The attacker needs to be able to send commands to the FTP server. They need to be able to send a crafted `MLSD` command. The attacker needs to be able to connect to the FTP server, authenticate and send commands.