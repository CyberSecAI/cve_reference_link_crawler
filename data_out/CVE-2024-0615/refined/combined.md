=== Content from plugins.trac.wordpress.org_e9b14ff7_20250111_155913.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3052982%2540content-control%252Ftrunk%26old%3D3007200%2540content-control%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3007200/content-control/trunk?old=3052982&old_path=%2Fcontent-control%2Ftrunk)

---

# Changes in [content-control/trunk](/browser/content-control/trunk?rev=3052982 "Show entry in browser") [[3007200:3052982]](/log/content-control/trunk?rev=3052982&stop_rev=3007200 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[content-control/trunk](/browser/content-control/trunk?rev=3052982)
Files:

7 added
65 edited

* [classes/Controllers/Admin/Upgrades.php](/browser/content-control/trunk/classes/Controllers/Admin/Upgrades.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [classes/Controllers/Assets.php](/browser/content-control/trunk/classes/Controllers/Assets.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [classes/Controllers/Frontend/Blocks.php](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3052982 "Show entry in browser")
  (modified)
  ([4 diffs](#file2 "Show differences"))
* [classes/Controllers/Frontend/Restrictions.php](/browser/content-control/trunk/classes/Controllers/Frontend/Restrictions.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [classes/Controllers/Frontend/Restrictions/QueryTerms.php](/browser/content-control/trunk/classes/Controllers/Frontend/Restrictions/QueryTerms.php?rev=3052982 "Show entry in browser")
  (added)
* [classes/Controllers/Frontend/Restrictions/RestAPI.php](/browser/content-control/trunk/classes/Controllers/Frontend/Restrictions/RestAPI.php?rev=3052982 "Show entry in browser")
  (added)
* [classes/Controllers/Frontend/Widgets.php](/browser/content-control/trunk/classes/Controllers/Frontend/Widgets.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))
* [classes/RestAPI/License.php](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3052982 "Show entry in browser")
  (modified)
  ([4 diffs](#file7 "Show differences"))
* [classes/Upgrades/PluginMeta\_2.php](/browser/content-control/trunk/classes/Upgrades/PluginMeta_2.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [classes/Upgrades/UserMeta\_2.php](/browser/content-control/trunk/classes/Upgrades/UserMeta_2.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [content-control.php](/browser/content-control/trunk/content-control.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file10 "Show differences"))
* [dist/core-data.asset.php](/browser/content-control/trunk/dist/core-data.asset.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [dist/core-data.js](/browser/content-control/trunk/dist/core-data.js?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [dist/fields.asset.php](/browser/content-control/trunk/dist/fields.asset.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [dist/fields.js](/browser/content-control/trunk/dist/fields.js?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [dist/settings-page.asset.php](/browser/content-control/trunk/dist/settings-page.asset.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))
* [dist/settings-page.js](/browser/content-control/trunk/dist/settings-page.js?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [inc/functions.php](/browser/content-control/trunk/inc/functions.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file17 "Show differences"))
* [inc/functions/compatibility.php](/browser/content-control/trunk/inc/functions/compatibility.php?rev=3052982 "Show entry in browser")
  (modified)
  ([3 diffs](#file18 "Show differences"))
* [inc/functions/developers.php](/browser/content-control/trunk/inc/functions/developers.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file19 "Show differences"))
* [inc/functions/query.php](/browser/content-control/trunk/inc/functions/query.php?rev=3052982 "Show entry in browser")
  (modified)
  ([8 diffs](#file20 "Show differences"))
* [inc/functions/restrictions.php](/browser/content-control/trunk/inc/functions/restrictions.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [inc/functions/rule-callbacks.php](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982 "Show entry in browser")
  (modified)
  ([20 diffs](#file22 "Show differences"))
* [inc/functions/utils.php](/browser/content-control/trunk/inc/functions/utils.php?rev=3052982 "Show entry in browser")
  (added)
* [readme.txt](/browser/content-control/trunk/readme.txt?rev=3052981 "Show entry in browser")
  (modified)
  ([3 diffs](#file24 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Container.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Container.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file25 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Exception/ExpectedInvokableException.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/ExpectedInvokableException.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file26 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Exception/FrozenServiceException.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/FrozenServiceException.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file27 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Exception/InvalidServiceIdentifierException.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/InvalidServiceIdentifierException.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file28 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Exception/UnknownIdentifierException.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/UnknownIdentifierException.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file29 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Psr11/Container.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/Container.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file30 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Psr11/ServiceLocator.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/ServiceLocator.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file31 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/ServiceIterator.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceIterator.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file32 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/ServiceProviderInterface.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceProviderInterface.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file33 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Invokable.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Invokable.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file34 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/NonInvokable.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/NonInvokable.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file35 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/PimpleServiceProvider.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/PimpleServiceProvider.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file36 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Service.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Service.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file37 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleServiceProviderInterfaceTest.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleServiceProviderInterfaceTest.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file38 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleTest.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleTest.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file39 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ContainerTest.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ContainerTest.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file40 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ServiceLocatorTest.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ServiceLocatorTest.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file41 "Show differences"))
* [vendor-prefixed/pimple/pimple/src/Pimple/Tests/ServiceIteratorTest.php](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/ServiceIteratorTest.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file42 "Show differences"))
* [vendor-prefixed/psr/container/src/ContainerExceptionInterface.php](/browser/content-control/trunk/vendor-prefixed/psr/container/src/ContainerExceptionInterface.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file43 "Show differences"))
* [vendor-prefixed/psr/container/src/ContainerInterface.php](/browser/content-control/trunk/vendor-prefixed/psr/container/src/ContainerInterface.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file44 "Show differences"))
* [vendor-prefixed/psr/container/src/NotFoundExceptionInterface.php](/browser/content-control/trunk/vendor-prefixed/psr/container/src/NotFoundExceptionInterface.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file45 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Admin.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Admin.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file46 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Ajax.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Ajax.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file47 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Client.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php?rev=3052982 "Show entry in browser")
  (modified)
  ([3 diffs](#file48 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Config.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Config.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file49 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Cron.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Cron.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file50 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Encryption.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3052982 "Show entry in browser")
  (modified)
  ([4 diffs](#file51 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Endpoint.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3052982 "Show entry in browser")
  (modified)
  ([6 diffs](#file52 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Envelope.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Envelope.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file53 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Form.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Form.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file54 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Logger.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logger.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file55 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Logging.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logging.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file56 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Remote.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Remote.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file57 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/SecurityChecks.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3052982 "Show entry in browser")
  (modified)
  ([6 diffs](#file58 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/SiteAccess.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SiteAccess.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file59 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/SupportRole.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportRole.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file60 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/SupportUser.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportUser.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file61 "Show differences"))
* [vendor-prefixed/trustedlogin/client/src/Utils.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Utils.php?rev=3052982 "Show entry in browser")
  (added)
* [vendor-prefixed/trustedlogin/client/src/assets/index.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/assets/index.php?rev=3052982 "Show entry in browser")
  (added)
* [vendor-prefixed/trustedlogin/client/src/assets/src/index.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/assets/src/index.php?rev=3052982 "Show entry in browser")
  (added)
* [vendor-prefixed/trustedlogin/client/src/index.php](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/index.php?rev=3052982 "Show entry in browser")
  (added)
* [vendor/autoload.php](/browser/content-control/trunk/vendor/autoload.php?rev=3052982 "Show entry in browser")
  (modified)
  ([1 diff](#file66 "Show differences"))
* [vendor/composer/autoload\_classmap.php](/browser/content-control/trunk/vendor/composer/autoload_classmap.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file67 "Show differences"))
* [vendor/composer/autoload\_real.php](/browser/content-control/trunk/vendor/composer/autoload_real.php?rev=3052982 "Show entry in browser")
  (modified)
  ([2 diffs](#file68 "Show differences"))
* [vendor/composer/autoload\_static.php](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3052982 "Show entry in browser")
  (modified)
  ([4 diffs](#file69 "Show differences"))
* [vendor/composer/installed.json](/browser/content-control/trunk/vendor/composer/installed.json?rev=3052982 "Show entry in browser")
  (modified)
  ([3 diffs](#file70 "Show differences"))
* [vendor/composer/installed.php](/browser/content-control/trunk/vendor/composer/installed.php?rev=3052982 "Show entry in browser")
  (modified)
  ([3 diffs](#file71 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [content-control/trunk/classes/Controllers/Admin/Upgrades.php](/changeset/3052982/content-control/trunk/classes/Controllers/Admin/Upgrades.php?old=2974933&old_path=content-control%2Ftrunk%2Fclasses%2FControllers%2FAdmin%2FUpgrades.php "Show the [3007200:3052982] differences restricted to content-control/trunk/classes/Controllers/Admin/Upgrades.php")

  | [r3007200](/browser/content-control/trunk/classes/Controllers/Admin/Upgrades.php?rev=2974933#L390 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/classes/Controllers/Admin/Upgrades.php?rev=3052982#L390 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 390 | 390 | \*/ |
  | 391 | 391 | public function admin\_notices() { |
  | 392 |  | if ( ! is\_admin() ) { |
  |  | 392 | if ( ! is\_admin() || ! current\_user\_can( $this->container->get\_permission( 'manage\_settings' ) ) ) { |
  | 393 | 393 | return; |
  | 394 | 394 | } |
  | […](/browser/content-control/trunk/classes/Controllers/Admin/Upgrades.php?rev=2974933#L471) | […](/browser/content-control/trunk/classes/Controllers/Admin/Upgrades.php?rev=3052982#L471) |  |
  | 471 | 471 | \*/ |
  | 472 | 472 | public function localize\_vars( $vars ) { |
  | 473 |  | if ( ! is\_admin() ) { |
  |  | 473 | if ( ! is\_admin() || ! current\_user\_can( $this->container->get\_permission( 'manage\_settings' ) ) ) { |
  | 474 | 474 | return $vars; |
  | 475 | 475 | } |
* ## [content-control/trunk/classes/Controllers/Assets.php](/changeset/3052982/content-control/trunk/classes/Controllers/Assets.php?old=3007200&old_path=content-control%2Ftrunk%2Fclasses%2FControllers%2FAssets.php "Show the [3007200:3052982] differences restricted to content-control/trunk/classes/Controllers/Assets.php")

  | [r3007200](/browser/content-control/trunk/classes/Controllers/Assets.php?rev=3007200#L48 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/classes/Controllers/Assets.php?rev=3052982#L48 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | // Strip last number from version as they won't be breaking changes. |
  | 49 | 49 | $wp\_version = preg\_replace( '/\.\d+$/', '', $wp\_version ); |
  |  | 50 |  |
  |  | 51 | $is\_pro\_installed = \ContentControl\is\_plugin\_installed( 'content-control-pro/content-control-pro.php' ); |
  | 50 | 52 |  |
  | 51 | 53 | $packages = [ |
  | […](/browser/content-control/trunk/classes/Controllers/Assets.php?rev=3007200#L111) | […](/browser/content-control/trunk/classes/Controllers/Assets.php?rev=3052982#L113) |  |
  | 111 | 113 | 'varsName' => 'contentControlSettingsPage', |
  | 112 | 114 | 'vars'     => [ |
  | 113 |  | 'pluginUrl'    => $this->container->get( 'url' ), |
  | 114 |  | 'wpVersion'    => $wp\_version, |
  | 115 |  | 'adminUrl'     => admin\_url(), |
  | 116 |  | 'restBase'     => 'content-control/v2', |
  | 117 |  | 'userRoles'    => allowed\_user\_roles(), |
  | 118 |  | 'logUrl'       => current\_user\_can( 'manage\_options' ) ? $this->container->get( 'logging' )->get\_file\_url() : false, |
  | 119 |  | 'rolesAndCaps' => wp\_roles()->roles, |
  | 120 |  | 'version'      => $this->container->get( 'version' ), |
  | 121 |  | 'permissions'  => $permissions, |
  |  | 115 | 'pluginUrl'      => $this->container->get( 'url' ), |
  |  | 116 | 'wpVersion'      => $wp\_version, |
  |  | 117 | 'adminUrl'       => admin\_url(), |
  |  | 118 | 'restBase'       => 'content-control/v2', |
  |  | 119 | 'userRoles'      => allowed\_user\_roles(), |
  |  | 120 | 'logUrl'         => current\_user\_can( 'manage\_options' ) ? $this->container->get( 'logging' )->get\_file\_url() : false, |
  |  | 121 | 'rolesAndCaps'   => wp\_roles()->roles, |
  |  | 122 | 'version'        => $this->container->get( 'version' ), |
  |  | 123 | 'permissions'    => $permissions, |
  |  | 124 | 'isProInstalled' => $is\_pro\_installed, |
  |  | 125 | 'isProActivated' => $is\_pro\_installed && is\_plugin\_active( 'content-control-pro/content-control-pro.php' ), |
  | 122 | 126 | ], |
  | 123 | 127 | 'styles'   => true, |
* ## [content-control/trunk/classes/Controllers/Frontend/Blocks.php](/changeset/3052982/content-control/trunk/classes/Controllers/Frontend/Blocks.php?old=3007200&old_path=content-control%2Ftrunk%2Fclasses%2FControllers%2FFrontend%2FBlocks.php "Show the [3007200:3052982] differences restricted to content-control/trunk/classes/Controllers/Frontend/Blocks.php")

  | [r3007200](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3007200#L92 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3052982#L92 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 92 | 92 |  |
  | 93 | 93 | /\*\* |
  | 94 |  | \* Short curcuit block rendering for hidden blocks. |
  | 95 |  | \* |
  | 96 |  | \* @param string|null         $pre\_render   The pre-rendered content. Default null. |
  | 97 |  | \* @param array<string,mixed> $parsed\_block The block being rendered. |
  | 98 |  | \* @param \WP\_Block|null      $parent\_block If this is a nested block, a reference to the parent block. |
  | 99 |  | \* |
  | 100 |  | \* @return string|null |
  | 101 |  | \*/ |
  | 102 |  | public function pre\_render\_block( $pre\_render, $parsed\_block, $parent\_block ) { |
  | 103 |  | if ( 'core/navigation' === $parsed\_block['blockName'] ) { |
  | 104 |  | $nav\_menu\_ref = ! empty( $parsed\_block['attrs']['ref'] ) ? $parsed\_block['attrs']['ref'] : 0; |
  | 105 |  |  |
  | 106 |  | if ( $nav\_menu\_ref ) { |
  | 107 |  | $navigation\_post = get\_post( $nav\_menu\_ref ); |
  | 108 |  | $parsed\_blocks   = parse\_blocks( $navigation\_post->post\_content ); |
  | 109 |  | } |
  | 110 |  |  |
  | 111 |  | // TODO for some reason, controls applied to core/navigation-link are not being saved, or not appearing in attrs. |
  | 112 |  | } |
  | 113 |  |  |
  | 114 |  | if ( ! isset( $parsed\_block['attrs']['contentControls'] ) ) { |
  | 115 |  | return $pre\_render; |
  | 116 |  | } |
  | 117 |  |  |
  |  | 94 | \* Check block rules to see if it should be hidden from user. |
  |  | 95 | \* |
  |  | 96 | \* @param array<string,mixed> $block Block to be checked. |
  |  | 97 | \* |
  |  | 98 | \* @return boolean Whether the block should be hidden. |
  |  | 99 | \*/ |
  |  | 100 | public function should\_hide\_block( $block ) { |
  | 118 | 101 | if ( protection\_is\_disabled() ) { |
  | 119 |  | return $pre\_render; |
  | 120 |  | } |
  | 121 |  |  |
  | 122 |  | $controls = wp\_parse\_args( $parsed\_block['attrs']['contentControls'], [ |
  | 123 |  | 'enabled' => false, |
  | 124 |  | 'rules'   => [], |
  | 125 |  | ] ); |
  |  | 102 | return false; |
  |  | 103 | } |
  |  | 104 |  |
  |  | 105 | if ( ! $this->has\_block\_controls( $block ) ) { |
  |  | 106 | return false; |
  |  | 107 | } |
  |  | 108 |  |
  |  | 109 | $controls = $this->get\_block\_controls( $block ); |
  | 126 | 110 |  |
  | 127 | 111 | if ( ! $controls['enabled'] ) { |
  | 128 |  | return ~~$pre\_render~~; |
  |  | 112 | return false; |
  | 129 | 113 | } |
  | 130 | 114 |  |
  | […](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3007200#L134) | […](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3052982#L118) |  |
  | 134 | 118 | \* @param bool  $should\_hide Whether the block should be hidden. |
  | 135 | 119 | \* @param array $rules  Rules to check. |
  | 136 |  | \* @param array $~~parsed\_~~block  The block being rendered. |
  |  | 120 | \* @param array $block  The block being rendered. |
  | 137 | 121 | \* @return bool |
  | 138 | 122 | \*/ |
  | […](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3007200#L141) | […](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3052982#L125) |  |
  | 141 | 125 | false, |
  | 142 | 126 | $controls['rules'], |
  | 143 |  | $~~parsed\_~~block |
  |  | 127 | $block |
  | 144 | 128 | ); |
  | 145 | 129 |  |
  | 146 |  | return $should\_hide ? '' : $pre\_render; |
  |  | 130 | return $should\_hide; |
  |  | 131 | } |
  |  | 132 |  |
  |  | 133 | /\*\* |
  |  | 134 | \* Short curcuit block rendering for hidden blocks. |
  |  | 135 | \* |
  |  | 136 | \* @param string|null         $pre\_render   The pre-rendered content. Default null. |
  |  | 137 | \* @param array<string,mixed> $parsed\_block The block being rendered. |
  |  | 138 | \* @param \WP\_Block|null      $parent\_block If this is a nested block, a reference to the parent block. |
  |  | 139 | \* |
  |  | 140 | \* @return string|null |
  |  | 141 | \*/ |
  |  | 142 | public function pre\_render\_block( $pre\_render, $parsed\_block, $parent\_block ) { |
  |  | 143 | return $this->should\_hide\_block( $parsed\_block ) ? '' : $pre\_render; |
  | 147 | 144 | } |
  | 148 | 145 |  |
  | […](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3007200#L237) | […](/browser/content-control/trunk/classes/Controllers/Frontend/Blocks.php?rev=3052982#L234) |  |
  | 237 | 234 | if ( ! $this->has\_block\_controls( $block ) ) { |
  | 238 | 235 | return $block\_content; |
  |  | 236 | } |
  |  | 237 |  |
  |  | 238 | // If the block should be hidden, return an empty string. |
  |  | 239 | // This catches blocks that should be hidden but were missed by pre\_render\_block. |
  |  | 240 | // This applies to core/navigation-link blocks for example. |
  |  | 241 | if ( $this->should\_hide\_block( $block ) ) { |
  |  | 242 | return ''; |
  | 239 | 243 | } |
  | 240 | 244 |  |
* ## [content-control/trunk/classes/Controllers/Frontend/Restrictions.php](/changeset/3052982/content-control/trunk/classes/Controllers/Frontend/Restrictions.php?old=2968104&old_path=content-control%2Ftrunk%2Fclasses%2FControllers%2FFrontend%2FRestrictions.php "Show the [3007200:3052982] differences restricted to content-control/trunk/classes/Controllers/Frontend/Restrictions.php")

  | [r3007200](/browser/content-control/trunk/classes/Controllers/Frontend/Restrictions.php?rev=2968104#L13 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/classes/Controllers/Frontend/Restrictions.php?rev=3052982#L13 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | use ContentControl\Controllers\Frontend\Restrictions\QueryPosts; |
  | 14 | 14 | use ContentControl\Controllers\Frontend\Restrictions\PostContent; |
  |  | 15 | use ContentControl\Controllers\Frontend\Restrictions\QueryTerms; |
  |  | 16 | use ContentControl\Controllers\Frontend\Restrictions\RestAPI; |
  | 15 | 17 |  |
  | 16 | 18 | defined( 'ABSPATH' ) || exit; |
  | […](/browser/content-control/trunk/classes/Controllers/Frontend/Restrictions.php?rev=2968104#L30) | […](/browser/content-control/trunk/classes/Controllers/Frontend/Restrictions.php?rev=3052982#L32) |  |
  | 30 | 32 | 'Frontend\Restrictions\MainQuery'   => new MainQuery( $this->container ), |
  | 31 | 33 | 'Frontend\Restrictions\QueryPosts'  => new QueryPosts( $this->container ), |
  |  | 34 | 'Frontend\Restrictions\QueryTerms'  => new QueryTerms( $this->container ), |
  | 32 | 35 | 'Frontend\Restrictions\PostContent' => new PostContent( $this->container ), |
  |  | 36 | 'Frontend\Restrictions\RestAPI'     => new RestAPI( $this->container ), |
  | 33 | 37 | ] ); |
  | 34 | 38 | } |
* ## [content-control/trunk/classes/Controllers/Frontend/Widgets.php](/changeset/3052982/content-control/trunk/classes/Controllers/Frontend/Widgets.php?old=2969631&old_path=content-control%2Ftrunk%2Fclasses%2FControllers%2FFrontend%2FWidgets.php "Show the [3007200:3052982] differences restricted to content-control/trunk/classes/Controllers/Frontend/Widgets.php")

  | [r3007200](/browser/content-control/trunk/classes/Controllers/Frontend/Widgets.php?rev=2969631#L15 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/classes/Controllers/Frontend/Widgets.php?rev=3052982#L15 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | use WP\_Customize\_Manager; |
  | 16 | 16 |  |
  |  | 17 | use function ContentControl\is\_rest; |
  | 17 | 18 | use function ContentControl\protection\_is\_disabled; |
  | 18 | 19 | use function ContentControl\user\_meets\_requirements; |
  | […](/browser/content-control/trunk/classes/Controllers/Frontend/Widgets.php?rev=2969631#L39) | […](/browser/content-control/trunk/classes/Controllers/Frontend/Widgets.php?rev=3052982#L40) |  |
  | 39 | 40 | \*/ |
  | 40 | 41 | public function exclude\_widgets( $widget\_areas ) { |
  | 41 |  | if ( ~~protection\_is\_disabled(~~) || $this->is\_customize\_preview() ) { |
  |  | 42 | if ( ( ! is\_rest() && protection\_is\_disabled() ) || $this->is\_customize\_preview() ) { |
  | 42 | 43 | return $widget\_areas; |
  | 43 | 44 | } |
* ## [content-control/trunk/classes/RestAPI/License.php](/changeset/3052982/content-control/trunk/classes/RestAPI/License.php?old=3007200&old_path=content-control%2Ftrunk%2Fclasses%2FRestAPI%2FLicense.php "Show the [3007200:3052982] differences restricted to content-control/trunk/classes/RestAPI/License.php")

  | [r3007200](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3007200#L56 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3052982#L56 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 56 | 56 | 'licenseKey' => [ |
  | 57 | 57 | 'required'          => true, |
  | 58 |  | 'validate\_callback' => function ( $param, $request, $key ) { |
  |  | 58 | 'validate\_callback' => function ( $param, $request, $key ) { // phpcs:ignore Generic.CodeAnalysis.UnusedFunctionParameter |
  | 59 | 59 | return is\_string( $param ); |
  | 60 | 60 | }, |
  | […](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3007200#L81) | […](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3052982#L81) |  |
  | 81 | 81 | 'licenseKey' => [ |
  | 82 | 82 | 'required'          => false, |
  | 83 |  | 'validate\_callback' => function ( $param, $request, $key ) { |
  |  | 83 | 'validate\_callback' => function ( $param, $request, $key ) { // phpcs:ignore Generic.CodeAnalysis.UnusedFunctionParameter |
  | 84 | 84 | return is\_string( $param ); |
  | 85 | 85 | }, |
  | […](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3007200#L117) | […](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3052982#L117) |  |
  | 117 | 117 | ], |
  | 118 | 118 | ] |
  |  | 119 | ); |
  |  | 120 |  |
  |  | 121 | register\_rest\_route( |
  |  | 122 | $this->namespace, |
  |  | 123 | '/' . $this->base . '/activate-pro', |
  |  | 124 | [ |
  |  | 125 | [ |
  |  | 126 | 'methods'             => WP\_REST\_Server::EDITABLE, |
  |  | 127 | 'callback'            => [ $this, 'activate\_pro' ], |
  |  | 128 | 'permission\_callback' => [ $this, 'manage\_license\_permissions' ], |
  |  | 129 | ], |
  |  | 130 | ], |
  | 119 | 131 | ); |
  | 120 | 132 | } |
  | […](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3007200#L271) | […](/browser/content-control/trunk/classes/RestAPI/License.php?rev=3052982#L283) |  |
  | 271 | 283 |  |
  | 272 | 284 | /\*\* |
  |  | 285 | \* Activate pro plugin. |
  |  | 286 | \* |
  |  | 287 | \* @return \WP\_Error|\WP\_REST\_Response |
  |  | 288 | \*/ |
  |  | 289 | public function activate\_pro() { |
  |  | 290 | // Check if its installed. |
  |  | 291 | if ( ! plugin()->is\_pro\_installed() ) { |
  |  | 292 | return new WP\_Error( '404', \_\_( 'Pro plugin is not installed.', 'content-control' ), [ 'status' => 404 ] ); |
  |  | 293 | } |
  |  | 294 |  |
  |  | 295 | // Check if its active. |
  |  | 296 | if ( plugin()->is\_pro\_active() ) { |
  |  | 297 | return new WP\_Error( '404', \_\_( 'Pro plugin is already active.', 'content-control' ), [ 'status' => 404 ] ); |
  |  | 298 | } |
  |  | 299 |  |
  |  | 300 | // // Activate pro plugin. |
  |  | 301 | if ( ! function\_exists( 'activate\_plugin' ) ) { |
  |  | 302 | require\_once ABSPATH . 'wp-admin/includes/plugin.php'; |
  |  | 303 | } |
  |  | 304 |  |
  |  | 305 | $activate = \activate\_plugin( 'content-control-pro/content-control-pro.php', '', false, true ); |
  |  | 306 |  |
  |  | 307 | if ( is\_wp\_error( $activate ) ) { |
  |  | 308 | return new WP\_Error( '404', \_\_( 'Something went wrong, the pro plugin could not be activated.', 'content-control' ), [ 'status' => 404 ] ); |
  |  | 309 | } |
  |  | 310 |  |
  |  | 311 | return new WP\_REST\_Response( true, 200 ); |
  |  | 312 | } |
  |  | 313 |  |
  |  | 314 | /\*\* |
  | 273 | 315 | \* Deactivate plugin license. |
  | 274 | 316 | \* |
* ## [content-control/trunk/classes/Upgrades/PluginMeta\_2.php](/changeset/3052982/content-control/trunk/classes/Upgrades/PluginMeta_2.php?old=3007200&old_path=content-control%2Ftrunk%2Fclasses%2FUpgrades%2FPluginMeta_2.php "Show the [3007200:3052982] differences restricted to content-control/trunk/classes/Upgrades/PluginMeta_2.php")

  | [r3007200](/browser/content-control/trunk/classes/Upgrades/PluginMeta_2.php?rev=3007200#L39 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/classes/Upgrades/PluginMeta_2.php?rev=3052982#L39 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 39 | 39 |  |
  | 40 | 40 | /\*\* |
  |  | 41 | \* Get the remaps for this upgrade. |
  |  | 42 | \* |
  |  | 43 | \* @var array<string,string> |
  |  | 44 | \*/ |
  |  | 45 | private $remaps = [ |
  |  | 46 | 'jp\_cc\_reviews\_installed\_on' => 'content\_control\_installed\_on', |
  |  | 47 | ]; |
  |  | 48 |  |
  |  | 49 | /\*\* |
  |  | 50 | \* Check if the upgrade is required. |
  |  | 51 | \* |
  |  | 52 | \* @return bool |
  |  | 53 | \*/ |
  |  | 54 | public function is\_required() { |
  |  | 55 | $remaps = $this->remaps; |
  |  | 56 |  |
  |  | 57 | foreach ( $remaps as $key => $new\_key ) { |
  |  | 58 | $value = \get\_option( $key, null ); |
  |  | 59 |  |
  |  | 60 | if ( null !== $value ) { |
  |  | 61 | return true; |
  |  | 62 | } |
  |  | 63 | } |
  |  | 64 |  |
  |  | 65 | return false; |
  |  | 66 | } |
  |  | 67 |  |
  |  | 68 | /\*\* |
  | 41 | 69 | \* Run the upgrade. |
  | 42 | 70 | \* |
  | […](/browser/content-control/trunk/classes/Upgrades/PluginMeta_2.php?rev=3007200#L49) | […](/browser/content-control/trunk/classes/Upgrades/PluginMeta_2.php?rev=3052982#L77) |  |
  | 49 | 77 | $stream->start\_task( \_\_( 'Migrating plugin meta', 'content-control' ) ); |
  | 50 | 78 |  |
  | 51 |  | $remaps = [ |
  | 52 |  | 'jp\_cc\_reviews\_installed\_on' => 'content\_control\_installed\_on', |
  | 53 |  | ]; |
  |  | 79 | $remaps = $this->remaps; |
  | 54 | 80 |  |
  | 55 | 81 | foreach ( $remaps as $key => $new\_key ) { |
* ## [content-control/trunk/classes/Upgrades/UserMeta\_2.php](/changeset/3052982/content-control/trunk/classes/Upgrades/UserMeta_2.php?old=3007200&old_path=content-control%2Ftrunk%2Fclasses%2FUpgrades%2FUserMeta_2.php "Show the [3007200:3052982] differences restricted to content-control/trunk/classes/Upgrades/UserMeta_2.php")

  | [r3007200](/browser/content-control/trunk/classes/Upgrades/UserMeta_2.php?rev=3007200#L41 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/classes/Upgrades/UserMeta_2.php?rev=3052982#L41 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 41 | 41 |  |
  | 42 | 42 | /\*\* |
  |  | 43 | \* Get the remaps for this upgrade. |
  |  | 44 | \* |
  |  | 45 | \* @var array<string,string> |
  |  | 46 | \*/ |
  |  | 47 | private $remaps = [ |
  |  | 48 | '\_jp\_cc\_reviews\_already\_did'        => 'content\_control\_reviews\_already\_did', |
  |  | 49 | '\_jp\_cc\_reviews\_dismissed\_triggers' => 'content\_control\_reviews\_dismissed\_triggers', |
  |  | 50 | '\_jp\_cc\_reviews\_last\_dismissed'     => 'content\_control\_reviews\_last\_dismissed', |
  |  | 51 | ]; |
  |  | 52 |  |
  |  | 53 | /\*\* |
  |  | 54 | \* Check if the upgrade is required. |
  |  | 55 | \* |
  |  | 56 | \* @return bool |
  |  | 57 | \*/ |
  |  | 58 | public function is\_required() { |
  |  | 59 | $remaps = $this->remaps; |
  |  | 60 |  |
  |  | 61 | foreach ( $remaps as $key => $new\_key ) { |
  |  | 62 | $value = \get\_user\_meta( get\_current\_user\_id(), $key, true ); |
  |  | 63 |  |
  |  | 64 | if ( [] !== $value && '' !== $value && ! is\_null( $value ) ) { |
  |  | 65 | return true; |
  |  | 66 | } |
  |  | 67 | } |
  |  | 68 |  |
  |  | 69 | return false; |
  |  | 70 | } |
  |  | 71 |  |
  |  | 72 | /\*\* |
  | 43 | 73 | \* Run the migration. |
  | 44 | 74 | \* |
  | […](/browser/content-control/trunk/classes/Upgrades/UserMeta_2.php?rev=3007200#L53) | […](/browser/content-control/trunk/classes/Upgrades/UserMeta_2.php?rev=3052982#L83) |  |
  | 53 | 83 | $stream->start\_task( \_\_( 'Migrating user meta', 'content-control' ) ); |
  | 54 | 84 |  |
  | 55 |  | $remapped\_keys = [ |
  | 56 |  | '\_jp\_cc\_reviews\_already\_did'        => 'content\_control\_reviews\_already\_did', |
  | 57 |  | '\_jp\_cc\_reviews\_dismissed\_triggers' => 'content\_control\_reviews\_dismissed\_triggers', |
  | 58 |  | '\_jp\_cc\_reviews\_last\_dismissed'     => 'content\_control\_reviews\_last\_dismissed', |
  | 59 |  | ]; |
  |  | 85 | $remapped\_keys = $this->remaps; |
  | 60 | 86 |  |
  | 61 | 87 | // Update all keys via $wpdb. |
* ## [content-control/trunk/content-control.php](/changeset/3052982/content-control/trunk/content-control.php?old=3007200&old_path=content-control%2Ftrunk%2Fcontent-control.php "Show the [3007200:3052982] differences restricted to content-control/trunk/content-control.php")

  | [r3007200](/browser/content-control/trunk/content-control.php?rev=3007200#L4 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/content-control.php?rev=3052982#L4 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://contentcontrolplugin.com/?utm\_campaign=plugin-info&utm\_source=php-file-header&utm\_medium=plugin-ui&utm\_content=plugin-uri |
  | 5 | 5 | \* Description: Restrict content to logged in/out users or specific user roles. Restrict access to certain parts of a page/post. Control the visibility of widgets. |
  | 6 |  | \* Version: 2.~~1~~.0 |
  |  | 6 | \* Version: 2.2.0 |
  | 7 | 7 | \* Author: Code Atlantic |
  | 8 | 8 | \* Author URI: https://code-atlantic.com/?utm\_campaign=plugin-info&utm\_source=php-file-header&utm\_medium=plugin-ui&utm\_content=author-uri |
  | […](/browser/content-control/trunk/content-control.php?rev=3007200#L31) | […](/browser/content-control/trunk/content-control.php?rev=3052982#L31) |  |
  | 31 | 31 | 'name'          => \\_\_( 'Content Control', 'content-control' ), |
  | 32 | 32 | 'slug'          => 'content-control', |
  | 33 |  | 'version'       => '2.~~1~~.0', |
  |  | 33 | 'version'       => '2.2.0', |
  | 34 | 34 | 'option\_prefix' => 'content\_control', |
  | 35 | 35 | // Maybe remove this and simply prefix `name` with `'Popup Maker'`. |
* ## [content-control/trunk/dist/core-data.asset.php](/changeset/3052982/content-control/trunk/dist/core-data.asset.php?old=3007200&old_path=content-control%2Ftrunk%2Fdist%2Fcore-data.asset.php "Show the [3007200:3052982] differences restricted to content-control/trunk/dist/core-data.asset.php")

  | [r3007200](/browser/content-control/trunk/dist/core-data.asset.php?rev=3007200#L1 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/dist/core-data.asset.php?rev=3052982#L1 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('wp-api-fetch', 'wp-data', 'wp-data-controls', 'wp-element', 'wp-hooks', 'wp-i18n'), 'version' => '~~986cffa0b032dbefc10b~~'); |
  |  | 1 | <?php return array('dependencies' => array('wp-api-fetch', 'wp-data', 'wp-data-controls', 'wp-element', 'wp-hooks', 'wp-i18n'), 'version' => '018160e9f67aeba5f540'); |
* ## [content-control/trunk/dist/core-data.js](/changeset/3052982/content-control/trunk/dist/core-data.js?old=3007200&old_path=content-control%2Ftrunk%2Fdist%2Fcore-data.js "Show the [3007200:3052982] differences restricted to content-control/trunk/dist/core-data.js")

  | [r3007200](/browser/content-control/trunk/dist/core-data.js?rev=3007200#L1 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/dist/core-data.js?rev=3052982#L1 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | !function(){"use strict";var e={n:function(t){var n=t&&t.\_\_esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})}},t={};e.r(t),e.d(t,{LICENSE\_STORE:function(){return I},RESTRICTION\_STORE:function(){return ~~ot},SETTINGS\_STORE:function(){return pe},Status:function(){return v},URL\_SEARCH\_STORE:function(){return un},appendUrlParams:function(){return f},fetch:function(){return \_},fetchCredOpts:function(){return p},fetchWithCreds:function(){return T},getErrorMessage:function(){return A},licenseDefaults:function(){return m},licenseStore:function(){return Se},localControls:function(){return y},restBase:function(){return S},restUrl:function(){return g},restrictionDefaults:function(){return dt},restrictionsStore:function(){return an},settingsDefaults:function(){return Te},settingsStore:function(){return nt},urlSearchStore:function(){return Gn},useLicense:function(){return Kn},useSettings:function(){return xn},validateRestriction:function(){return ct}});var n={};e.r(n),e.d(n,{activateLicense:function(){return V},changeActionStatus:function(){return x},checkLicenseStatus:function(){return F},deactivateLicense:function(){return Y},hydrate:function(){return j},removeLicense:function(){return M},updateLicenseKey:function(){return B}});var r={};e.r(r),e.d(r,{getLicenseData:function(){return ne},getLicenseKey:function(){return re},getLicenseStatus:function(){return se}});var s={};e.r(s),e.d(s,{getConnectInfo:function(){return ae},getDispatchError:function(){return Ee},getDispatchStatus:function(){return ue},getLicenseData:function(){return ie},getLicenseKey:function(){return ce},getLicenseStatus:function(){return oe},hasDispatched:function(){return le},isDispatching:function(){return de}});var i={};e.r(i),e.d(i,{changeActionStatus:function(){return De},hydrate:function(){return He},hydrateBlockTypes:function(){return Ue},saveSettings:function(){return Oe},stageUnsavedChanges:function(){return Le},updateSettings:function(){return me}});var c={};e.r(c),e.d(c,{getKnownBlockTypes:function(){return Me},getSettings:function(){return Be}});var o={};e.r(o),e.d(o,{getDispatchError:function(){return tt},getDispatchStatus:function(){return ze},getExcludedBlocks:function(){return Je},getKnownBlockTypes:function(){return Qe},getReqPermission:function(){return Xe},getSetting:function(){return $e},getSettings:function(){return je},getUnsavedChanges:function(){return qe},hasDispatched:function(){return et},hasUnsavedChanges:function(){return We},isDispatching:function(){return Ze}});var a={};e.r(a),e.d(a,{addNotice:function(){return Rt},changeActionStatus:function(){return ht},changeEditorId:function(){return Nt},clearEditorData:function(){return mt},clearNotice:function(){return vt},clearNotices:function(){return It},createRestriction:function(){return Ot},deleteRestriction:function(){return Ht},hydrate:function(){return Ut},updateEditorValues:function(){return Dt},updateRestriction:function(){return Lt}});var u={};e.r(u),e.d(u,{getRestriction:function(){return qt},getRestrictions:function(){return $t}});var d={};e.r(d),e.d(d,{getDispatchError:function(){return on},getDispatchStatus:function(){return rn},getEditorId:function(){return Zt},getEditorValues:function(){return en},getNextPriority:function(){return tn},getNotices:function(){return Wt},getRestriction:function(){return Xt},getRestrictionDefaults:function(){return nn},getRestrictions:function(){return Jt},hasDispatched:function(){return cn},isDispatching:function(){return sn},isEditorActive:function(){return zt}});var l={};e.r(l),e.d(l,{changeActionStatus:function(){return Nn},searchError:function(){return In},searchRequest:function(){return Rn},searchSuccess:function(){return vn},updateSuggestions:function(){return hn}});var E={};e.r(E),e.d(E,{getDispatchError:function(){return Pn},getDispatchStatus:function(){return Un},getSuggestions:function(){return Hn},hasDispatched:function(){return bn},isDispatching:function(){return wn}});const S="content-control/v2",g=`${wpApiSettings.root}${S}/`,p=(e={})=>({...e,headers:{...e.headers,"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce},credentials:"same-origin"}),\_=(e,t={})=>(t.body&&(t.body=JSON.stringify(t.body)),wpApiSettings.root.includes("?")&&(e=e.replace("?","&")),{type:"FETCH",path:`${wpApiSettings.root}${e}`,options:p(t)}),T=(e,t)=>new Promise(((n,r)=>{window.fetch(e,p(t)).then((e=>e.json())).then((e=>n(e))).catch((e=>r(e)))}));var y={FETCH({path:e,options:t}){return new Promise(((n,r)=>{window.fetch(e,t).then((e=>e.json())).then((e=>n(e))).catch((e=>r(e)))}))}};const f=(e,t)=>{const n=Object.fromEntries(Object.entries(t).filter((([,e])=>!!e)));return`${e}?${new URLSearchParams({...n})}`},A=e=>e instanceof Error?e.message:String(e);var C=window.wp.data,h=window.wp.dataControls,R=window.wp.i18n;let v=function(e){return e.Idle="IDLE",e.Resolving="RESOLVING",e.Error="ERROR",e.Success="SUCCESS",e}({});const I="content-control/license",N={ACTIVATE\_LICENSE:"ACTIVATE\_LICENSE",CONNECT\_SITE:"CONNECT\_SITE",DEACTIVATE\_LICENSE:"DEACTIVATE\_LICENSE",REMOVE\_LICENSE:"REMOVE\_LICENSE",UPDATE\_LICENSE\_KEY:"UPDATE\_LICENSE\_KEY",CHECK\_LICENSE\_STATUS:"CHECK\_LICENSE\_STATUS",CHANGE\_ACTION\_STATUS:"CHANGE\_ACTION\_STATUS",HYDRATE\_LICENSE\_DATA:"HYDRATE\_LICENSE\_DATA",LICENSE\_FETCH\_ERROR:"LICENSE\_FETCH\_ERROR"},D={success:!1,license:"invalid",license\_limit:1,site\_count:0,expires:"",activations\_left:0,price\_id:0,error:void 0,error\_message:void 0},m={key:"",status:D},O={license:m},L=(e="")=>(e&&(e=`/${e}`),`content-control/v2/license${e}`),{ACTIVATE\_LICENSE:H,CONNECT\_SITE:U,DEACTIVATE\_LICENSE:w,UPDATE\_LICENSE\_KEY:b,REMOVE\_LICENSE:P,CHECK\_LICENSE\_STATUS:G,HYDRATE\_LICENSE\_DATA:k,CHANGE\_ACTION\_STATUS:K}=N,x=(e,t,n)=>(n&&console.log(e,n),{type:K,actionName:e,status:t,message:n});function\*V(e){const t="activateLicense";try{yield x(t,v.Resolving);const n=yield \_(L("activate"),{method:"POST",body:{licenseKey:e}});if(n){const{status:e,connectInfo:r}=n;return yield x(t,v.Success),void 0!==r?{type:U,licenseStatus:e,connectInfo:r}:{type:H,licenseStatus:e}}return x(t,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(e){return x(t,v.Error,A(e))}}function\*Y(){const e="deactivateLicense";try{yield x(e,v.Resolving);const t=yield \_(L("deactivate"),{method:"POST"});return t?(yield x(e,v.Success),{type:w,licenseStatus:t.status}):x(e,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}function\*F(){const e="checkLicenseStatus";try{yield x(e,v.Resolving);const t=yield \_(L("status"),{method:"POST"});return t?(yield x(e,v.Success),{type:G,licenseStatus:t.status}):x(e,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}function\*B(e){const t="updateLicenseKey";if((yield(0,C.resolveSelect)(I,"getLicenseKey"))===e)return x(t,v.Error,(0,R.\_\_)("The license key is the same as the current one.","content-control"));try{yield x(t,v.Resolving);const n=yield \_(L(),{method:"POST",body:{licenseKey:e}});return n?(yield x(t,v.Success),{type:b,licenseKey:e,licenseStatus:n.status}):x(t,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(e){return x(t,v.Error,A(e))}}function\*M(){const e="removeLicense";try{return yield x(e,v.Resolving),(yield \_(L(),{method:"DELETE"}))?(yield x(e,v.Success),{type:P}):x(e,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}const j=e=>({type:k,license:e}),{ACTIVATE\_LICENSE:Q,CONNECT\_SITE:$,DEACTIVATE\_LICENSE:q,REMOVE\_LICENSE:W,UPDATE\_LICENSE\_KEY:J,CHECK\_LICENSE\_STATUS:X,HYDRATE\_LICENSE\_DATA:z,CHANGE\_ACTION\_STATUS:Z,LICENSE\_FETCH\_ERROR:ee}=N;const{LICENSE\_FETCH\_ERROR:te}=N;function\*ne(){try{const e=yield \_(L(),{method:"GET"});return e?j(e):{type:te,message:(0,R.\_\_)("An error occurred, license data was not loaded.","content-control")}}catch(e){return{type:te,message:A(e)}}}function\*re(){const{key:e}=yield(0,h.select)(I,"getLicenseData");return e}function\*se(){const{status:e}=yield(0,h.select)(I,"getLicenseData");return e}const ie=e=>e.license,ce=e=>{const{key:t}=ie(e);return t},oe=e=>{const{status:t}=ie(e);return{...D,...t}},ae=e=>e.connectInfo,ue=(e,t)=>e?.dispatchStatus?.[t]?.status,de=(e,t)=>{if(!Array.isArray(t))return ue(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=ue(e,t[r])===v.Resolving,n)return!0;return n},le=(e,t)=>{const n=ue(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},Ee=(e,t)=>e?.dispatchStatus?.[t]?.error,Se=(0,C.createReduxStore)(I,{initialState:O,selectors:s,actions:n,reducer:(e,{type:t,license:n,licenseKey:r,licenseStatus:s,connectInfo:i,actionName:c,status:o,message:a})=>{switch(t){case Q:case q:case X:return{...e,license:{...e.license,status:s}};case $:return{...e,license:{...e.license,status:s},connectInfo:i};case J:return{...e,license:{...e.license,key:r,status:s}};case W:return{...e,license:{key:"",status:{}}};case z:return{...e,license:n};case ee:return{...e,error:a};case Z:return{...e,dispatchStatus:{...e.dispatchStatus,[c]:{...e?.dispatchStatus?.[c],status:o,error:a}}};default:return e}},resolvers:r,controls:{...h.controls,...y}});var ge=window.wp.hooks;const pe="content-control/settings",\_e={UPDATE:"UPDATE",STAGE\_CHANGES:"STAGE\_CHANGES",SAVE\_CHANGES:"SAVE\_CHANGES",HYDRATE:"HYDRATE",CHANGE\_ACTION\_STATUS:"CHANGE\_ACTION\_STATUS",SETTINGS\_FETCH\_ERROR:"SETTINGS\_FETCH\_ERROR",HYDRATE\_BLOCK\_TYPES:"HYDRATE\_BLOCK\_TYPES",BLOCK\_TYPES\_FETCH\_ERROR:"BLOCK\_TYPES\_FETCH\_ERROR"},Te=(0,ge.applyFilters)("contentControl.defaultSettings",{defaultDenialMessage:"",excludeAdmins:!0,excludedBlocks:[],permissions:{view\_block\_controls:"edit\_posts",edit\_block\_controls:"edit\_posts",edit\_restrictions:"manage\_options",manage\_settings:"manage\_options"},mediaQueries:{mobile:{override:!1,breakpoint:640},tablet:{override:!1,breakpoint:920},desktop:{override:!1,breakpoint:1440}}}),{currentSettings:ye=Te}=contentControlCoreData,fe={settings:ye,unsavedChanges:{}},Ae=()=>"content-control/v2/settings",{UPDATE:Ce,SAVE\_CHANGES:he,STAGE\_CHANGES:Re,HYDRATE:ve,CHANGE\_ACTION\_STATUS:Ie,HYDRATE\_BLOCK\_TYPES:Ne}=\_e,De=(e,t,n)=>(n&&console.log(e,n),{type:Ie,actionName:e,status:t,message:n});function\*me(e){const t="updateSettings";try{yield De(t,v.Resolving);const n=yield(0,h.select)(pe,"getSettings"),r=yield \_(Ae(),{method:"PUT",body:{settings:{...n,...e}}});return r?(yield De(t,v.Success),{type:Ce,settings:r}):De(t,v.Error,(0,R.\_\_)("An error occurred, settings were not saved.","content-control"))}catch(e){return De(t,v.Error,A(e))}}function\*Oe(){const e="saveSettings";try{yield De(e,v.Resolving);const t=yield(0,h.select)(pe,"getSettings"),n=yield(0,h.select)(pe,"getUnsavedChanges"),r=yield \_(Ae(),{method:"PUT",body:{settings:{...t,...n}}});return r?(yield De(e,v.Success),{type:he,settings:r}):De(e,v.Error,(0,R.\_\_)("An error occurred, settings were not saved.","content-control"))}catch(t){return De(e,v.Error,A(t))}}const Le=e=>({type:Re,settings:e}),He=e=>({type:ve,settings:e}),Ue=e=>({type:Ne,blockTypes:e}),{UPDATE:we,STAGE\_CHANGES:be,SAVE\_CHANGES:Pe,HYDRATE:Ge,HYDRATE\_BLOCK\_TYPES:ke,CHANGE\_ACTION\_STATUS:Ke,SETTINGS\_FETCH\_ERROR:xe,BLOCK\_TYPES\_FETCH\_ERROR:Ve}=\_e;const{SETTINGS\_FETCH\_ERROR:Ye,BLOCK\_TYPES\_FETCH\_ERROR:Fe}=\_e;function\*Be(){try{const{settings:e}=yield \_(Ae(),{method:"GET"});return e?He(e):{type:Ye,message:(0,R.\_\_)("An error occurred, settings were not loaded.","content-control")}}catch(e){return{type:Ye,message:A(e)}}}function\*Me(){try{const e=yield \_(`${S}/blockTypes`,{method:"GET"});return e?Ue(e):{type:Fe,message:(0,R.\_\_)("An error occurred, block types were not loaded.","content-control")}}catch(e){return{type:Fe,message:A(e)}}}const je=e=>e.settings,Qe=e=>e.knownBlockTypes,$e=(e,t,n)=>{var r;return null!==(r=je(e)[t])&&void 0!==r?r:n},qe=e=>{var t;return null!==(t=e?.unsavedChanges)&&void 0!==t?t:{}},We=e=>{var t;return Object.keys(null!==(t=e?.unsavedChanges)&&void 0!==t?t:{}).length>0},Je=e=>$e(e,"excludedBlocks",Te.excludedBlocks),Xe=(e,t)=>{const n=$e(e,"permissions",Te.permissions)[t];return"string"==typeof n?n:"manage\_options"},ze=(e,t)=>e?.dispatchStatus?.[t]?.status,Ze=(e,t)=>{if(!Array.isArray(t))return ze(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=ze(e,t[r])===v.Resolving,n)return!0;return n},et=(e,t)=>{const n=ze(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},tt=(e,t)=>e?.dispatchStatus?.[t]?.error,nt=(0,C.createReduxStore)(pe,{initialState:fe,selectors:o,actions:i,reducer:(e,{type:t,settings:n,actionName:r,status:s,message:i,blockTypes:c})=>{var o;switch(t){case Ge:return{...e,settings:n};case ke:return{...e,knownBlockTypes:c};case Ve:case xe:return{...e,error:i};case be:return{...e,unsavedChanges:{...null!==(o=e.unsavedChanges)&&void 0!==o?o:{},...n}};case Pe:return{...e,settings:{...e.settings,...n},unsavedChanges:{}};case we:return{...e,settings:{...e.settings,...n}};case Ke:return{...e,dispatchStatus:{...e.dispatchStatus,[r]:{...e?.dispatchStatus?.[r],status:s,error:i}}};default:return e}},resolvers:c,controls:{...h.controls,...y}}),rt=(e=void 0)=>{const t="content-control/v2/restrictions";return e?`${t}/${e}`:t},st=({title:e,excerpt:t,...n})=>({...n,title:"string"==typeof e?e:e.raw,description:"string"==typeof t?t:t.raw}),it=({description:e,...t})=>({...t,excerpt:e}),ct=e=>!!e&&(e.title.length?!(!e.settings?.conditions?.items?.length&&"publish"===e.status)||{message:(0,R.\_\_)("Please provide at least one condition for this restriction before enabling it.","content-control"),tabName:"content"}:{message:(0,R.\_\_)("Please provide a name for this restriction.","content-control"),tabName:"general",field:"title"}),ot="content-control/restrictions",at={CREATE:"CREATE",UPDATE:"UPDATE",DELETE:"DELETE",HYDRATE:"HYDRATE",ADD\_NOTICE:"ADD\_NOTICE",CLEAR\_NOTICE:"CLEAR\_NOTICE",CLEAR\_NOTICES:"CLEAR\_NOTICES",EDITOR\_CHANGE\_ID:"EDITOR\_CHANGE\_ID",EDITOR\_CLEAR\_DATA:"EDITOR\_CLEAR\_DATA",EDITOR\_UPDATE\_VALUES:"EDITOR\_UPDATE\_VALUES",CHANGE\_ACTION\_STATUS:"CHANGE\_ACTION\_STATUS",RESTRICTIONS\_FETCH\_ERROR:"RESTRICTIONS\_FETCH\_ERROR"},ut={restrictions:[],editor:{},notices:[]},dt={id:0,title:"",description:"",status:"draft",priority:0,settings:{userStatus:"logged\_in",roleMatch:"any",userRoles:[],protectionMethod:"redirect",redirectType:"login",redirectUrl:"",replacementType:"message",replacementPage:void 0,archiveHandling:"filter\_post\_content",archiveReplacementPage:void 0,archiveRedirectType:"login",archiveRedirectUrl:"",additionalQueryHandling:"filter\_post\_content",showExcerpts:!1,overrideMessage:!1,customMessage:"",conditions:{logicalOperator:"or",items:[]}}},{CREATE:lt,DELETE:Et,UPDATE:St,HYDRATE:gt,ADD\_NOTICE:pt,CLEAR\_NOTICE:\_t,CLEAR\_NOTICES:Tt,CHANGE\_ACTION\_STATUS:yt,EDITOR\_CHANGE\_ID:ft,EDITOR\_CLEAR\_DATA:At,EDITOR\_UPDATE\_VALUES:Ct}=at,ht=(e,t,n)=>(n&&console.log(e,n),{type:yt,actionName:e,status:t,message:n}),Rt=e=>({type:pt,notice:e}),vt=e=>({type:\_t,noticeId:e}),It=()=>({type:Tt});function\*Nt(e){try{if(void 0===e)return{type:ft,editorId:void 0,editorValues:void 0};const t=yield(0,h.select)(ot,"getRestrictionDefaults");let n="new"===e?t:void 0;return"number"==typeof e&&e>0&&(n=yield(0,h.select)(ot,"getRestriction",e)),{type:ft,editorId:e,editorValues:n}}catch(e){return console.log(e),ht("changeEditorId",v.Error,A(e))}}const Dt=e=>({type:Ct,editorValues:e}),mt=()=>({type:At});function\*Ot(e){const t="createRestriction";try{yield ht(t,v.Resolving);const{id:n,...r}=e,s=ct(e);if(!0!==s)return yield ht(t,v.Error,s||(0,R.\_\_)("An error occurred, restriction was not saved.")),Rt({id:"restriction-error",type:"error",message:"object"==typeof s?s.message:"",closeDelay:5e3});const i=yield \_(rt(),{method:"POST",body:it(r)});if(i){yield ht(t,v.Success);const n=yield(0,h.select)(ot,"getEditorId"),r={type:lt,restriction:st(i)};return"new"===n?(yield r,void(yield Nt(i.id))):(yield R~~t({id:"restriction-saved",type:"success",message:(0,R.sprintf)( |
  |  | 1 | !function(){"use strict";var e={n:function(t){var n=t&&t.\_\_esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})}},t={};e.r(t),e.d(t,{LICENSE\_STORE:function(){return I},RESTRICTION\_STORE:function(){return at},SETTINGS\_STORE:function(){return \_e},Status:function(){return v},URL\_SEARCH\_STORE:function(){return dn},appendUrlParams:function(){return f},fetch:function(){return \_},fetchCredOpts:function(){return p},fetchWithCreds:function(){return y},getErrorMessage:function(){return A},licenseDefaults:function(){return m},licenseStore:function(){return ge},localControls:function(){return T},restBase:function(){return S},restUrl:function(){return g},restrictionDefaults:function(){return lt},restrictionsStore:function(){return un},settingsDefaults:function(){return Te},settingsStore:function(){return rt},urlSearchStore:function(){return kn},useLicense:function(){return xn},useSettings:function(){return Vn},validateRestriction:function(){return ot}});var n={};e.r(n),e.d(n,{activateLicense:function(){return V},activatePro:function(){return j},changeActionStatus:function(){return x},checkLicenseStatus:function(){return F},deactivateLicense:function(){return Y},hydrate:function(){return Q},removeLicense:function(){return M},updateLicenseKey:function(){return B}});var r={};e.r(r),e.d(r,{getLicenseData:function(){return re},getLicenseKey:function(){return se},getLicenseStatus:function(){return ie}});var s={};e.r(s),e.d(s,{getConnectInfo:function(){return ue},getDispatchError:function(){return Se},getDispatchStatus:function(){return de},getLicenseData:function(){return ce},getLicenseKey:function(){return oe},getLicenseStatus:function(){return ae},hasDispatched:function(){return Ee},isDispatching:function(){return le}});var i={};e.r(i),e.d(i,{changeActionStatus:function(){return me},hydrate:function(){return Ue},hydrateBlockTypes:function(){return we},saveSettings:function(){return Le},stageUnsavedChanges:function(){return He},updateSettings:function(){return Oe}});var c={};e.r(c),e.d(c,{getKnownBlockTypes:function(){return je},getSettings:function(){return Me}});var o={};e.r(o),e.d(o,{getDispatchError:function(){return nt},getDispatchStatus:function(){return Ze},getExcludedBlocks:function(){return Xe},getKnownBlockTypes:function(){return $e},getReqPermission:function(){return ze},getSetting:function(){return qe},getSettings:function(){return Qe},getUnsavedChanges:function(){return We},hasDispatched:function(){return tt},hasUnsavedChanges:function(){return Je},isDispatching:function(){return et}});var a={};e.r(a),e.d(a,{addNotice:function(){return vt},changeActionStatus:function(){return Rt},changeEditorId:function(){return Dt},clearEditorData:function(){return Ot},clearNotice:function(){return It},clearNotices:function(){return Nt},createRestriction:function(){return Lt},deleteRestriction:function(){return Ut},hydrate:function(){return wt},updateEditorValues:function(){return mt},updateRestriction:function(){return Ht}});var u={};e.r(u),e.d(u,{getRestriction:function(){return Wt},getRestrictions:function(){return qt}});var d={};e.r(d),e.d(d,{getDispatchError:function(){return an},getDispatchStatus:function(){return sn},getEditorId:function(){return en},getEditorValues:function(){return tn},getNextPriority:function(){return nn},getNotices:function(){return Jt},getRestriction:function(){return zt},getRestrictionDefaults:function(){return rn},getRestrictions:function(){return Xt},hasDispatched:function(){return on},isDispatching:function(){return cn},isEditorActive:function(){return Zt}});var l={};e.r(l),e.d(l,{changeActionStatus:function(){return Dn},searchError:function(){return Nn},searchRequest:function(){return vn},searchSuccess:function(){return In},updateSuggestions:function(){return Rn}});var E={};e.r(E),e.d(E,{getDispatchError:function(){return Gn},getDispatchStatus:function(){return wn},getSuggestions:function(){return Un},hasDispatched:function(){return bn},isDispatching:function(){return Pn}});const S="content-control/v2",g=`${wpApiSettings.root}${S}/`,p=(e={})=>({...e,headers:{...e.headers,"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce},credentials:"same-origin"}),\_=(e,t={})=>(t.body&&(t.body=JSON.stringify(t.body)),wpApiSettings.root.includes("?")&&(e=e.replace("?","&")),{type:"FETCH",path:`${wpApiSettings.root}${e}`,options:p(t)}),y=(e,t)=>new Promise(((n,r)=>{window.fetch(e,p(t)).then((e=>e.json())).then((e=>n(e))).catch((e=>r(e)))}));var T={FETCH({path:e,options:t}){return new Promise(((n,r)=>{window.fetch(e,t).then((e=>e.json())).then((e=>n(e))).catch((e=>r(e)))}))}};const f=(e,t)=>{const n=Object.fromEntries(Object.entries(t).filter((([,e])=>!!e)));return`${e}?${new URLSearchParams({...n})}`},A=e=>e instanceof Error?e.message:String(e);var h=window.wp.data,C=window.wp.dataControls,R=window.wp.i18n;let v=function(e){return e.Idle="IDLE",e.Resolving="RESOLVING",e.Error="ERROR",e.Success="SUCCESS",e}({});const I="content-control/license",N={ACTIVATE\_LICENSE:"ACTIVATE\_LICENSE",CONNECT\_SITE:"CONNECT\_SITE",DEACTIVATE\_LICENSE:"DEACTIVATE\_LICENSE",REMOVE\_LICENSE:"REMOVE\_LICENSE",UPDATE\_LICENSE\_KEY:"UPDATE\_LICENSE\_KEY",CHECK\_LICENSE\_STATUS:"CHECK\_LICENSE\_STATUS",CHANGE\_ACTION\_STATUS:"CHANGE\_ACTION\_STATUS",HYDRATE\_LICENSE\_DATA:"HYDRATE\_LICENSE\_DATA",LICENSE\_FETCH\_ERROR:"LICENSE\_FETCH\_ERROR"},D={success:!1,license:"invalid",license\_limit:1,site\_count:0,expires:"",activations\_left:0,price\_id:0,error:void 0,error\_message:void 0},m={key:"",status:D},O={license:m},L=(e="")=>(e&&(e=`/${e}`),`content-control/v2/license${e}`),{ACTIVATE\_LICENSE:H,CONNECT\_SITE:U,DEACTIVATE\_LICENSE:w,UPDATE\_LICENSE\_KEY:P,REMOVE\_LICENSE:b,CHECK\_LICENSE\_STATUS:G,HYDRATE\_LICENSE\_DATA:k,CHANGE\_ACTION\_STATUS:K}=N,x=(e,t,n)=>(n&&console.log(e,n),{type:K,actionName:e,status:t,message:n});function\*V(e){const t="activateLicense";try{yield x(t,v.Resolving);const n=yield \_(L("activate"),{method:"POST",body:{licenseKey:e}});if(n){const{status:e,connectInfo:r}=n;return yield x(t,v.Success),void 0!==r?{type:U,licenseStatus:e,connectInfo:r}:{type:H,licenseStatus:e}}return x(t,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(e){return x(t,v.Error,A(e))}}function\*Y(){const e="deactivateLicense";try{yield x(e,v.Resolving);const t=yield \_(L("deactivate"),{method:"POST"});return t?(yield x(e,v.Success),{type:w,licenseStatus:t.status}):x(e,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}function\*F(){const e="checkLicenseStatus";try{yield x(e,v.Resolving);const t=yield \_(L("status"),{method:"POST"});return t?(yield x(e,v.Success),{type:G,licenseStatus:t.status}):x(e,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}function\*B(e){const t="updateLicenseKey";if((yield(0,h.resolveSelect)(I,"getLicenseKey"))===e)return x(t,v.Error,(0,R.\_\_)("The license key is the same as the current one.","content-control"));try{yield x(t,v.Resolving);const n=yield \_(L(),{method:"POST",body:{licenseKey:e}});return n?(yield x(t,v.Success),{type:P,licenseKey:e,licenseStatus:n.status}):x(t,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(e){return x(t,v.Error,A(e))}}function\*M(){const e="removeLicense";try{return yield x(e,v.Resolving),(yield \_(L(),{method:"DELETE"}))?(yield x(e,v.Success),{type:b}):x(e,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}function\*j(){const e="activatePro";try{return yield x(e,v.Resolving),(yield \_(L("activate-pro"),{method:"POST"}))?x(e,v.Success):x(e,v.Error,(0,R.\_\_)("An error occurred, license were not saved.","content-control"))}catch(t){return x(e,v.Error,A(t))}}const Q=e=>({type:k,license:e}),{ACTIVATE\_LICENSE:$,CONNECT\_SITE:q,DEACTIVATE\_LICENSE:W,REMOVE\_LICENSE:J,UPDATE\_LICENSE\_KEY:X,CHECK\_LICENSE\_STATUS:z,HYDRATE\_LICENSE\_DATA:Z,CHANGE\_ACTION\_STATUS:ee,LICENSE\_FETCH\_ERROR:te}=N;const{LICENSE\_FETCH\_ERROR:ne}=N;function\*re(){try{const e=yield \_(L(),{method:"GET"});return e?Q(e):{type:ne,message:(0,R.\_\_)("An error occurred, license data was not loaded.","content-control")}}catch(e){return{type:ne,message:A(e)}}}function\*se(){const{key:e}=yield(0,C.select)(I,"getLicenseData");return e}function\*ie(){const{status:e}=yield(0,C.select)(I,"getLicenseData");return e}const ce=e=>e.license,oe=e=>{const{key:t}=ce(e);return t},ae=e=>{const{status:t}=ce(e);return{...D,...t}},ue=e=>e.connectInfo,de=(e,t)=>e?.dispatchStatus?.[t]?.status,le=(e,t)=>{if(!Array.isArray(t))return de(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=de(e,t[r])===v.Resolving,n)return!0;return n},Ee=(e,t)=>{const n=de(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},Se=(e,t)=>e?.dispatchStatus?.[t]?.error,ge=(0,h.createReduxStore)(I,{initialState:O,selectors:s,actions:n,reducer:(e,{type:t,license:n,licenseKey:r,licenseStatus:s,connectInfo:i,actionName:c,status:o,message:a})=>{switch(t){case $:case W:case z:return{...e,license:{...e.license,status:s}};case q:return{...e,license:{...e.license,status:s},connectInfo:i};case X:return{...e,license:{...e.license,key:r,status:s}};case J:return{...e,license:{key:"",status:{}}};case Z:return{...e,license:n};case te:return{...e,error:a};case ee:return{...e,dispatchStatus:{...e.dispatchStatus,[c]:{...e?.dispatchStatus?.[c],status:o,error:a}}};default:return e}},resolvers:r,controls:{...C.controls,...T}});var pe=window.wp.hooks;const \_e="content-control/settings",ye={UPDATE:"UPDATE",STAGE\_CHANGES:"STAGE\_CHANGES",SAVE\_CHANGES:"SAVE\_CHANGES",HYDRATE:"HYDRATE",CHANGE\_ACTION\_STATUS:"CHANGE\_ACTION\_STATUS",SETTINGS\_FETCH\_ERROR:"SETTINGS\_FETCH\_ERROR",HYDRATE\_BLOCK\_TYPES:"HYDRATE\_BLOCK\_TYPES",BLOCK\_TYPES\_FETCH\_ERROR:"BLOCK\_TYPES\_FETCH\_ERROR"},Te=(0,pe.applyFilters)("contentControl.defaultSettings",{defaultDenialMessage:"",excludeAdmins:!0,excludedBlocks:[],permissions:{view\_block\_controls:"edit\_posts",edit\_block\_controls:"edit\_posts",edit\_restrictions:"manage\_options",manage\_settings:"manage\_options"},mediaQueries:{mobile:{override:!1,breakpoint:640},tablet:{override:!1,breakpoint:920},desktop:{override:!1,breakpoint:1440}}}),{currentSettings:fe=Te}=contentControlCoreData,Ae={settings:fe,unsavedChanges:{}},he=()=>"content-control/v2/settings",{UPDATE:Ce,SAVE\_CHANGES:Re,STAGE\_CHANGES:ve,HYDRATE:Ie,CHANGE\_ACTION\_STATUS:Ne,HYDRATE\_BLOCK\_TYPES:De}=ye,me=(e,t,n)=>(n&&console.log(e,n),{type:Ne,actionName:e,status:t,message:n});function\*Oe(e){const t="updateSettings";try{yield me(t,v.Resolving);const n=yield(0,C.select)(\_e,"getSettings"),r=yield \_(he(),{method:"PUT",body:{settings:{...n,...e}}});return r?(yield me(t,v.Success),{type:Ce,settings:r}):me(t,v.Error,(0,R.\_\_)("An error occurred, settings were not saved.","content-control"))}catch(e){return me(t,v.Error,A(e))}}function\*Le(){const e="saveSettings";try{yield me(e,v.Resolving);const t=yield(0,C.select)(\_e,"getSettings"),n=yield(0,C.select)(\_e,"getUnsavedChanges"),r=yield \_(he(),{method:"PUT",body:{settings:{...t,...n}}});return r?(yield me(e,v.Success),{type:Re,settings:r}):me(e,v.Error,(0,R.\_\_)("An error occurred, settings were not saved.","content-control"))}catch(t){return me(e,v.Error,A(t))}}const He=e=>({type:ve,settings:e}),Ue=e=>({type:Ie,settings:e}),we=e=>({type:De,blockTypes:e}),{UPDATE:Pe,STAGE\_CHANGES:be,SAVE\_CHANGES:Ge,HYDRATE:ke,HYDRATE\_BLOCK\_TYPES:Ke,CHANGE\_ACTION\_STATUS:xe,SETTINGS\_FETCH\_ERROR:Ve,BLOCK\_TYPES\_FETCH\_ERROR:Ye}=ye;const{SETTINGS\_FETCH\_ERROR:Fe,BLOCK\_TYPES\_FETCH\_ERROR:Be}=ye;function\*Me(){try{const{settings:e}=yield \_(he(),{method:"GET"});return e?Ue(e):{type:Fe,message:(0,R.\_\_)("An error occurred, settings were not loaded.","content-control")}}catch(e){return{type:Fe,message:A(e)}}}function\*je(){try{const e=yield \_(`${S}/blockTypes`,{method:"GET"});return e?we(e):{type:Be,message:(0,R.\_\_)("An error occurred, block types were not loaded.","content-control")}}catch(e){return{type:Be,message:A(e)}}}const Qe=e=>e.settings,$e=e=>e.knownBlockTypes,qe=(e,t,n)=>{var r;return null!==(r=Qe(e)[t])&&void 0!==r?r:n},We=e=>{var t;return null!==(t=e?.unsavedChanges)&&void 0!==t?t:{}},Je=e=>{var t;return Object.keys(null!==(t=e?.unsavedChanges)&&void 0!==t?t:{}).length>0},Xe=e=>qe(e,"excludedBlocks",Te.excludedBlocks),ze=(e,t)=>{const n=qe(e,"permissions",Te.permissions)[t];return"string"==typeof n?n:"manage\_options"},Ze=(e,t)=>e?.dispatchStatus?.[t]?.status,et=(e,t)=>{if(!Array.isArray(t))return Ze(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=Ze(e,t[r])===v.Resolving,n)return!0;return n},tt=(e,t)=>{const n=Ze(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},nt=(e,t)=>e?.dispatchStatus?.[t]?.error,rt=(0,h.createReduxStore)(\_e,{initialState:Ae,selectors:o,actions:i,reducer:(e,{type:t,settings:n,actionName:r,status:s,message:i,blockTypes:c})=>{var o;switch(t){case ke:return{...e,settings:n};case Ke:return{...e,knownBlockTypes:c};case Ye:case Ve:return{...e,error:i};case be:return{...e,unsavedChanges:{...null!==(o=e.unsavedChanges)&&void 0!==o?o:{},...n}};case Ge:return{...e,settings:{...e.settings,...n},unsavedChanges:{}};case Pe:return{...e,settings:{...e.settings,...n}};case xe:return{...e,dispatchStatus:{...e.dispatchStatus,[r]:{...e?.dispatchStatus?.[r],status:s,error:i}}};default:return e}},resolvers:c,controls:{...C.controls,...T}}),st=(e=void 0)=>{const t="content-control/v2/restrictions";return e?`${t}/${e}`:t},it=({title:e,excerpt:t,...n})=>({...n,title:"string"==typeof e?e:e.raw,description:"string"==typeof t?t:t.raw}),ct=({description:e,...t})=>({...t,excerpt:e}),ot=e=>!!e&&(e.title.length?!(!e.settings?.conditions?.items?.length&&"publish"===e.status)||{message:(0,R.\_\_)("Please provide at least one condition for this restriction before enabling it.","content-control"),tabName:"content"}:{message:(0,R.\_\_)("Please provide a name for this restriction.","content-control"),tabName:"general",field:"title"}),at="content-control/restrictions",ut={CREATE:"CREATE",UPDATE:"UPDATE",DELETE:"DELETE",HYDRATE:"HYDRATE",ADD\_NOTICE:"ADD\_NOTICE",CLEAR\_NOTICE:"CLEAR\_NOTICE",CLEAR\_NOTICES:"CLEAR\_NOTICES",EDITOR\_CHANGE\_ID:"EDITOR\_CHANGE\_ID",EDITOR\_CLEAR\_DATA:"EDITOR\_CLEAR\_DATA",EDITOR\_UPDATE\_VALUES:"EDITOR\_UPDATE\_VALUES",CHANGE\_ACTION\_STATUS:"CHANGE\_ACTION\_STATUS",RESTRICTIONS\_FETCH\_ERROR:"RESTRICTIONS\_FETCH\_ERROR"},dt={restrictions:[],editor:{},notices:[]},lt={id:0,title:"",description:"",status:"draft",priority:0,settings:{userStatus:"logged\_in",roleMatch:"any",userRoles:[],protectionMethod:"redirect",redirectType:"login",redirectUrl:"",replacementType:"message",replacementPage:void 0,archiveHandling:"filter\_post\_content",archiveReplacementPage:void 0,archiveRedirectType:"login",archiveRedirectUrl:"",additionalQueryHandling:"filter\_post\_content",showExcerpts:!1,overrideMessage:!1,customMessage:"",conditions:{logicalOperator:"or",items:[]}}},{CREATE:Et,DELETE:St,UPDATE:gt,HYDRATE:pt,ADD\_NOTICE:\_t,CLEAR\_NOTICE:yt,CLEAR\_NOTICES:Tt,CHANGE\_ACTION\_STATUS:ft,EDITOR\_CHANGE\_ID:At,EDITOR\_CLEAR\_DATA:ht,EDITOR\_UPDATE\_VALUES:Ct}=ut,Rt=(e,t,n)=>(n&&console.log(e,n),{type:ft,actionName:e,status:t,message:n}),vt=e=>({type:\_t,notice:e}),It=e=>({type:yt,noticeId:e}),Nt=()=>({type:Tt});function\*Dt(e){try{if(void 0===e)return{type:At,editorId:void 0,editorValues:void 0};const t=yield(0,C.select)(at,"getRestrictionDefaults");let n="new"===e?t:void 0;return"number"==typeof e&&e>0&&(n=yield(0,C.select)(at,"getRestriction",e)),{type:At,editorId:e,editorValues:n}}catch(e){return console.log(e),Rt("changeEditorId",v.Error,A(e))}}const mt=e=>({type:Ct,editorValues:e}),Ot=()=>({type:ht});function\*Lt(e){const t="createRestriction";try{yield Rt(t,v.Resolving);const{id:n,...r}=e,s=ot(e);if(!0!==s)return yield Rt(t,v.Error,s||(0,R.\_\_)("An error occurred, restriction was not saved.")),vt({id:"restriction-error",type:"error",message:"object"==typeof s?s.message:"",closeDelay:5e3});const i=yield \_(st(),{method:"POST",body:ct(r)});if(i){yield Rt(t,v.Success);const n=yield(0,C.select)(at,"getEditorId"),r={type:Et,restriction:it(i)};return"new"===n?(yield r,void(yield Dt(i.id))):(yield vt({id:"restriction-saved",type:"success",message:(0,R.sprintf)( |
  | 2 | 2 | // translators: %s: restriction title. |
  | 3 |  | (0,R.\_\_)('Restriction "%s" saved successfully.',"content-control"),e?.title),closeDelay:5e3}),r)}return ~~ht(t,v.Error,(0,R.\_\_)("An error occurred, restriction was not saved.","content-control"))}catch(e){return ht(t,v.Error,A(e))}}function\*Lt(e){const t="updateRestriction";try{yield ht(t,v.Resolving);const n=ct(e);if(!0!==n)return yield ht(t,v.Error,n||(0,R.\_\_)("An error occurred, restriction was not saved.")),Rt({id:"restriction-error",type:"error",message:"object"==typeof n?n.message:"",closeDelay:5e3});const r=yield(0,h.select)(ot,"getRestriction",e.id),s=yield \_(rt(r.id),{method:"POST",body:it(e)});return s?(yield ht(t,v.Success),yield R~~t({id:"restriction-saved",type:"success",message:(0,R.sprintf)( |
  |  | 3 | (0,R.\_\_)('Restriction "%s" saved successfully.',"content-control"),e?.title),closeDelay:5e3}),r)}return Rt(t,v.Error,(0,R.\_\_)("An error occurred, restriction was not saved.","content-control"))}catch(e){return Rt(t,v.Error,A(e))}}function\*Ht(e){const t="updateRestriction";try{yield Rt(t,v.Resolving);const n=ot(e);if(!0!==n)return yield Rt(t,v.Error,n||(0,R.\_\_)("An error occurred, restriction was not saved.")),vt({id:"restriction-error",type:"error",message:"object"==typeof n?n.message:"",closeDelay:5e3});const r=yield(0,C.select)(at,"getRestriction",e.id),s=yield \_(st(r.id),{method:"POST",body:ct(e)});return s?(yield Rt(t,v.Success),yield vt({id:"restriction-saved",type:"success",message:(0,R.sprintf)( |
  | 4 | 4 | // translators: %s: restriction title. |
  | 5 |  | (0,R.\_\_)('Restriction "%s" saved successfully.',"content-control"),e?.title),closeDelay:5e3}),{type:~~St,restriction:st(s)}):ht(t,v.Error,(0,R.\_\_)("An error occurred, restriction was not saved.","content-control"))}catch(e){return ht(t,v.Error,A(e))}}function\*Ht(e,t=!1){const n="deleteRestriction";try{yield ht(n,v.Resolving);const r=yield(0,h.select)(ot,"getRestriction",e),s=t?"?force=true":"",i=rt(r.id)+s;return(yield \_(i,{method:"DELETE"}))?(yield ht(n,v.Success),t?{type:Et,restrictionId:e}:{type:St,restriction:{...r,status:"trash"}}):ht(n,v.Error,(0,R.\_\_)("An error occurred, restriction was not deleted.","content-control"))}catch(e){return ht(n,v.Error,A(e))}}const Ut=e=>({type:gt,restrictions:e}),{CREATE:wt,DELETE:bt,UPDATE:Pt,HYDRATE:Gt,ADD\_NOTICE:kt,CLEAR\_NOTICE:Kt,CLEAR\_NOTICES:xt,CHANGE\_ACTION\_STATUS:Vt,EDITOR\_CHANGE\_ID:Yt,EDITOR\_CLEAR\_DATA:Ft,EDITOR\_UPDATE\_VALUES:Bt,RESTRICTIONS\_FETCH\_ERROR:Mt}=at;const{UPDATE:jt,RESTRICTIONS\_FETCH\_ERROR:Qt}=at;function\*$t(){try{const e=yield \_(f(rt(),{status:["any","trash","auto-draft"],per\_page:100,context:"edit"}));if(e){const t=e.map(st);return Ut(t)}return{type:Qt,message:(0,R.\_\_)("An error occurred, restrictions were not loaded.","content-control")}}catch(e){return{type:Qt,message:A(e)}}}function\*qt(e){try{const t=yield \_(f(rt(e),{context:"edit"}));return t?{type:jt,restriction:st(t)}:{type:Q~~t,message:(0,R.sprintf)(/\* translators: 1: restriction id \*/ |
  | 6 |  | (0,R.\_\_)("An error occurred, restriction %d were not loaded.","content-control"),e)}}catch(e){return{type:~~Qt,message:A(e)}}}const Wt=e=>e.notices||[],Jt=e=>e.restrictions||[],Xt=(e,t)=>Jt(e).find((e=>e.id===t)),zt=e=>{const t=e?.editor?.id;return"string"==typeof t&&"new"===t||"number"==typeof t&&t>0},Zt=e=>e?.editor?.id,en=e=>e?.editor?.values,tn=e=>{const t=Jt(e);return 0===t.length?0:t.reduce(((e,t)=>t.priority>e?t.priority:e),0)+1},nn=e=>{const t=tn(e);return{...(0,ge.applyFilters)("contentControl.defaultRestrictionValues",dt),priority:t}},rn=(e,t)=>e?.dispatchStatus?.[t]?.status,sn=(e,t)=>{if(!Array.isArray(t))return rn(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=rn(e,t[r])===v.Resolving,n)return!0;return n},cn=(e,t)=>{const n=rn(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},on=(e,t)=>e?.dispatchStatus?.[t]?.error,an=(0,C.createReduxStore)(ot,{initialState:ut,selectors:d,actions:a,reducer:(e=ut,{restrictions:t,restriction:n,restrictionId:r,type:s,editorId:i,editorValues:c,actionName:o,status:a,message:u,notice:d,noticeId:l})=>{switch(s){case wt:return{...e,restrictions:[...e.restrictions,n]};case Pt:return{...e,restrictions:e.restrictions.filter((e=>e.id!==n.id)).concat([n])};case bt:return{...e,restrictions:e.restrictions.filter((e=>e.id!==r))};case Gt:return{...e,restrictions:t};case kt:return{...e,notices:[...e.notices.filter((({id:e})=>e!==d.id)),d]};case Kt:return{...e,notices:e.notices.filter((({id:e})=>e!==l))};case xt:return{...e,notices:[]};case Mt:return{...e,error:u};case Yt:return{...e,editor:{...e.editor,id:i,values:c}};case Bt:return{...e,editor:{...e.editor,values:{...e.editor?.values,...c}}};case Ft:return{...e,editor:{}};case Vt:return{...e,dispatchStatus:{...e.dispatchStatus,[o]:{...e?.dispatchStatus?.[o],status:a,error:u}}};default:return e}},resolvers:u,controls:{...h.controls,...y}}),un="content-control/url-search",dn={SEARCH\_REQUEST:"SEARCH\_REQUEST",SEARCH\_SUCCESS:"SEARCH\_SUCCESS",SEARCH\_ERROR:"SEARCH\_ERROR",UPDATE\_SUGGESTIONS:"UPDATE\_SUGGESTIONS",CHANGE\_ACTION\_STATUS:"CHANGE\_ACTION\_STATUS"},ln={currentQuery:"",searchResults:[],queries:{}};var En=window.wp.apiFetch,Sn=e.n(En);const gn=(e={search:""})=>f("wp/v2/search",e),pn=(e,t={})=>({type:"FETCH\_LINK\_SUGGESTIONS",search:e,searchOptions:t});var Tn={async FETCH\_LINK\_SUGGESTIONS({search:e,searchOptions:t={},settings:n={disablePostFormats:!1}}){const{isInitialSuggestions:r=!1,type:s,subtype:i,page:c,perPage:o=(r?3:20)}=t,{disablePostFormats:a=!1}=n,u=[],d=e=>!s||s===e||Array.isArray(s)&&s.indexOf(e)>=0;return d("post")&&u.push(Sn()({path:gn({search:e,page:c,per\_page:o,type:"post",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"post-type",subtype:i}}))))).catch((()=>[]))),d("term")&&u.push(Sn()({path:gn({search:e,page:c,per\_page:o,type:"term",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"taxonomy",subtype:i}}))))).catch((()=>[]))),!a&&d("post-format")&&u.push(Sn()({path:gn({search:e,page:c,per\_page:o,type:"post-format",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"taxonomy",subtype:i}}))))).catch((()=>[]))),d("attachment")&&u.push(Sn()({path:gn({search:e,page:c,per\_page:o}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"media"}}))))).catch((()=>[]))),Promise.all(u).then((e=>e.reduce(((e,t)=>e.concat(t)),[]).filter((e=>!!e.id)).slice(0,o).map((e=>{var t;const n="attachment"===e.type;return{id:e.id,url:n?e.source\_url:e.url,title:n?null!==(t=e.title.rendered)&&void 0!==t?t:suggestion.title.raw:e.title||(0,R.\_\_)("(no title)"),type:e?.subtype||e.type,kind:e?.meta?.kind}}))))}};const{SEARCH\_REQUEST:yn,SEARCH\_SUCCESS:fn,SEARCH\_ERROR:An,CHANGE\_ACTION\_STATUS:Cn}=dn;function\*hn(e,t){const n="updateSuggestions";try{yield Nn(n,v.Resolving),yield Rn(e);const r=yield pn(e,t);if(r)return yield Nn(n,v.Success),vn(e,r);const s=(0,R.\_\_)("No results returned","content-control");return yield Nn(n,v.Error,s),In(e,s)}catch(t){const r=A(t);return yield Nn(n,v.Error,r),In(e,r)}}function Rn(e){return{type:yn,queryText:e}}function vn(e,t){return{type:fn,queryText:e,results:t}}function In(e,t){return{type:An,queryText:e,error:t}}const Nn=(e,t,n)=>(n&&console.log(e,n),{type:Cn,actionName:e,status:t,message:n}),{SEARCH\_ERROR:Dn,SEARCH\_REQUEST:mn,SEARCH\_SUCCESS:On,CHANGE\_ACTION\_STATUS:Ln}=dn;const Hn=e=>e.searchResults||[],Un=(e,t)=>e?.dispatchStatus?.[t]?.status,wn=(e,t)=>{if(!Array.isArray(t))return Un(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=Un(e,t[r])===v.Resolving,n)return!0;return n},bn=(e,t)=>{const n=Un(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},Pn=(e,t)=>e?.dispatchStatus?.[t]?.error,Gn=(0,C.createReduxStore)(un,{initialState:ln,selectors:E,actions:l,reducer:(e=ln,{type:t,queryText:n,results:r,error:s,actionName:i,status:c,message:o})=>{var a;switch(t){case mn:return{...e,currentQuery:n};case On:return e.currentQuery===n?{searchResults:r}:e;case Dn:return e.currentQuery===n?{...e,error:s}:e;case Ln:return{...e,dispatchStatus:{...e.dispatchStatus,[i]:{...null!==(a=e?.dispatchStatus?.[i])&&void 0!==a?a:{},status:c,error:o}}};default:return e}},controls:{...h.controls,...y,...Tn}});var kn=window.wp.element,Kn=()=>{var e,t,n,r;const{connectInfo:s,licenseKey:i,licenseStatus:c,isSaving:o}=(0,C.useSelect)((e=>{const t=e(Se);return{connectInfo:t.getConnectInfo(),licenseKey:t.getLicenseKey(),licenseStatus:t.getLicenseStatus(),isSaving:t.isDispatching("activateLicense")||t.isDispatching("deactivateLicense")||t.isDispatching("checkLicenseStatus")||t.isDispatching("updateLicenseKey")||t.isDispatching("removeLicense")}}),[]),{activateLicense:a,deactivateLicense:u,checkLicenseStatus:d,updateLicenseKey:l,removeLicense:E}=(0,C.useDispatch)(Se),S="valid"===c?.license,g=["deactivated","site\_inactive","inactive"].includes(null!==(e=c?.license)&&void 0!==e?e:""),p=["invalid","failed"].includes(c?.license),\_=p&&["","missing"].includes(null!==(t=c?.error)&&void 0!==t?t:""),T="expired"===c?.license||["invalid","failed"].includes(null!==(n=c?.license)&&void 0!==n?n:"")&&"expired"===c?.error,y="disabled"===c?.license||p&&"disabled"===c?.error,f="no\_activations\_left"===c?.error,A=!!c?.error,h=p&&A&&!["missing","expired","disabled"].includes(null!==(r=c?.error)&&void 0!==r?r:""),R=(0,kn.useMemo)((()=>S||g||T||y||f),[S,g,T,y,f]),v=(0,kn.useMemo)((()=>S?"active":T?"expired":\_?"missing":g?"deactivated":y?"disabled":h?"error":"unknown"),[S,T,\_,g,y,h]),I=(0,kn.useMemo)((()=>{var e;let t=null!==(e=c?.price\_id)&&void 0!==e?e:null;if(null===t)return-1;switch("string"==typeof t&&(t=parseInt(t,10)),t){default:return-1;case!1:case 0:return 0;case 1:case 2:case 3:case 4:return t}}),[c?.price\_id]);return{connectInfo:s,licenseKey:i,licenseStatus:c,licenseLevel:I,activateLicense:a,deactivateLicense:u,checkLicenseStatus:d,updateLicenseKey:l,removeLicense:E,getLicenseStatusName:v,isSaving:o,isLicenseKeyValid:R,isLicenseActive:S,isLicenseDeactivated:g,isLicenseMissing:\_,isLicenseExpired:T,isLicenseInvalid:p,isLicenseDisabled:y,isLicenseOverQuota:f,isGeneralError:h,hasError:A}},xn=()=>{const{currentSettings:e,unsavedChanges:t,hasUnsavedChanges:n,isSaving:r}=(0,C.useSelect)((e=>{const t=e(nt);return{unsavedChanges:t.getUnsavedChanges(),hasUnsavedChanges:t.hasUnsavedChanges(),currentSettings:t.getSettings(),isSaving:t.isDispatching("updateSettings")||t.isDispatching("saveSettings")}}),[]),{updateSettings:s,saveSettings:i,stageUnsavedChanges:c}=(0,C.useDispatch)(nt),o=(0,k~~n.useMemo)((()=>({...e,...t})),[e,t]);return{currentSettings:e,settings:o,getSetting:(e,t)=>{var n;return null!==(n=o[e])&&void 0!==n?n:t},updateSettings:s,saveSettings:i,isSaving:r,hasUnsavedChanges:n,stageUnsavedChanges:c,unsavedChanges:t}};(window.contentControl=window.contentControl||{}).coreData=t}(); |
  |  | 5 | (0,R.\_\_)('Restriction "%s" saved successfully.',"content-control"),e?.title),closeDelay:5e3}),{type:gt,restriction:it(s)}):Rt(t,v.Error,(0,R.\_\_)("An error occurred, restriction was not saved.","content-control"))}catch(e){return Rt(t,v.Error,A(e))}}function\*Ut(e,t=!1){const n="deleteRestriction";try{yield Rt(n,v.Resolving);const r=yield(0,C.select)(at,"getRestriction",e),s=t?"?force=true":"",i=st(r.id)+s;return(yield \_(i,{method:"DELETE"}))?(yield Rt(n,v.Success),t?{type:St,restrictionId:e}:{type:gt,restriction:{...r,status:"trash"}}):Rt(n,v.Error,(0,R.\_\_)("An error occurred, restriction was not deleted.","content-control"))}catch(e){return Rt(n,v.Error,A(e))}}const wt=e=>({type:pt,restrictions:e}),{CREATE:Pt,DELETE:bt,UPDATE:Gt,HYDRATE:kt,ADD\_NOTICE:Kt,CLEAR\_NOTICE:xt,CLEAR\_NOTICES:Vt,CHANGE\_ACTION\_STATUS:Yt,EDITOR\_CHANGE\_ID:Ft,EDITOR\_CLEAR\_DATA:Bt,EDITOR\_UPDATE\_VALUES:Mt,RESTRICTIONS\_FETCH\_ERROR:jt}=ut;const{UPDATE:Qt,RESTRICTIONS\_FETCH\_ERROR:$t}=ut;function\*qt(){try{const e=yield \_(f(st(),{status:["any","trash","auto-draft"],per\_page:100,context:"edit"}));if(e){const t=e.map(it);return wt(t)}return{type:$t,message:(0,R.\_\_)("An error occurred, restrictions were not loaded.","content-control")}}catch(e){return{type:$t,message:A(e)}}}function\*Wt(e){try{const t=yield \_(f(st(e),{context:"edit"}));return t?{type:Qt,restriction:it(t)}:{type:$t,message:(0,R.sprintf)(/\* translators: 1: restriction id \*/ |
  |  | 6 | (0,R.\_\_)("An error occurred, restriction %d were not loaded.","content-control"),e)}}catch(e){return{type:$t,message:A(e)}}}const Jt=e=>e.notices||[],Xt=e=>e.restrictions||[],zt=(e,t)=>Xt(e).find((e=>e.id===t)),Zt=e=>{const t=e?.editor?.id;return"string"==typeof t&&"new"===t||"number"==typeof t&&t>0},en=e=>e?.editor?.id,tn=e=>e?.editor?.values,nn=e=>{const t=Xt(e);return 0===t.length?0:t.reduce(((e,t)=>t.priority>e?t.priority:e),0)+1},rn=e=>{const t=nn(e);return{...(0,pe.applyFilters)("contentControl.defaultRestrictionValues",lt),priority:t}},sn=(e,t)=>e?.dispatchStatus?.[t]?.status,cn=(e,t)=>{if(!Array.isArray(t))return sn(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=sn(e,t[r])===v.Resolving,n)return!0;return n},on=(e,t)=>{const n=sn(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},an=(e,t)=>e?.dispatchStatus?.[t]?.error,un=(0,h.createReduxStore)(at,{initialState:dt,selectors:d,actions:a,reducer:(e=dt,{restrictions:t,restriction:n,restrictionId:r,type:s,editorId:i,editorValues:c,actionName:o,status:a,message:u,notice:d,noticeId:l})=>{switch(s){case Pt:return{...e,restrictions:[...e.restrictions,n]};case Gt:return{...e,restrictions:e.restrictions.filter((e=>e.id!==n.id)).concat([n])};case bt:return{...e,restrictions:e.restrictions.filter((e=>e.id!==r))};case kt:return{...e,restrictions:t};case Kt:return{...e,notices:[...e.notices.filter((({id:e})=>e!==d.id)),d]};case xt:return{...e,notices:e.notices.filter((({id:e})=>e!==l))};case Vt:return{...e,notices:[]};case jt:return{...e,error:u};case Ft:return{...e,editor:{...e.editor,id:i,values:c}};case Mt:return{...e,editor:{...e.editor,values:{...e.editor?.values,...c}}};case Bt:return{...e,editor:{}};case Yt:return{...e,dispatchStatus:{...e.dispatchStatus,[o]:{...e?.dispatchStatus?.[o],status:a,error:u}}};default:return e}},resolvers:u,controls:{...C.controls,...T}}),dn="content-control/url-search",ln={SEARCH\_REQUEST:"SEARCH\_REQUEST",SEARCH\_SUCCESS:"SEARCH\_SUCCESS",SEARCH\_ERROR:"SEARCH\_ERROR",UPDATE\_SUGGESTIONS:"UPDATE\_SUGGESTIONS",CHANGE\_ACTION\_STATUS:"CHANGE\_ACTION\_STATUS"},En={currentQuery:"",searchResults:[],queries:{}};var Sn=window.wp.apiFetch,gn=e.n(Sn);const pn=(e={search:""})=>f("wp/v2/search",e),yn=(e,t={})=>({type:"FETCH\_LINK\_SUGGESTIONS",search:e,searchOptions:t});var Tn={async FETCH\_LINK\_SUGGESTIONS({search:e,searchOptions:t={},settings:n={disablePostFormats:!1}}){const{isInitialSuggestions:r=!1,type:s,subtype:i,page:c,perPage:o=(r?3:20)}=t,{disablePostFormats:a=!1}=n,u=[],d=e=>!s||s===e||Array.isArray(s)&&s.indexOf(e)>=0;return d("post")&&u.push(gn()({path:pn({search:e,page:c,per\_page:o,type:"post",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"post-type",subtype:i}}))))).catch((()=>[]))),d("term")&&u.push(gn()({path:pn({search:e,page:c,per\_page:o,type:"term",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"taxonomy",subtype:i}}))))).catch((()=>[]))),!a&&d("post-format")&&u.push(gn()({path:pn({search:e,page:c,per\_page:o,type:"post-format",subtype:i}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"taxonomy",subtype:i}}))))).catch((()=>[]))),d("attachment")&&u.push(gn()({path:pn({search:e,page:c,per\_page:o}),cache:"no-cache"}).then((e=>e.map((e=>({...e,meta:{kind:"media"}}))))).catch((()=>[]))),Promise.all(u).then((e=>e.reduce(((e,t)=>e.concat(t)),[]).filter((e=>!!e.id)).slice(0,o).map((e=>{var t;const n="attachment"===e.type;return{id:e.id,url:n?e.source\_url:e.url,title:n?null!==(t=e.title.rendered)&&void 0!==t?t:suggestion.title.raw:e.title||(0,R.\_\_)("(no title)"),type:e?.subtype||e.type,kind:e?.meta?.kind}}))))}};const{SEARCH\_REQUEST:fn,SEARCH\_SUCCESS:An,SEARCH\_ERROR:hn,CHANGE\_ACTION\_STATUS:Cn}=ln;function\*Rn(e,t){const n="updateSuggestions";try{yield Dn(n,v.Resolving),yield vn(e);const r=yield yn(e,t);if(r)return yield Dn(n,v.Success),In(e,r);const s=(0,R.\_\_)("No results returned","content-control");return yield Dn(n,v.Error,s),Nn(e,s)}catch(t){const r=A(t);return yield Dn(n,v.Error,r),Nn(e,r)}}function vn(e){return{type:fn,queryText:e}}function In(e,t){return{type:An,queryText:e,results:t}}function Nn(e,t){return{type:hn,queryText:e,error:t}}const Dn=(e,t,n)=>(n&&console.log(e,n),{type:Cn,actionName:e,status:t,message:n}),{SEARCH\_ERROR:mn,SEARCH\_REQUEST:On,SEARCH\_SUCCESS:Ln,CHANGE\_ACTION\_STATUS:Hn}=ln;const Un=e=>e.searchResults||[],wn=(e,t)=>e?.dispatchStatus?.[t]?.status,Pn=(e,t)=>{if(!Array.isArray(t))return wn(e,t)===v.Resolving;let n=!1;for(let r=0;t.length>r;r++)if(n=wn(e,t[r])===v.Resolving,n)return!0;return n},bn=(e,t)=>{const n=wn(e,t);return!!(n&&[v.Success,v.Error].indexOf(n)>=0)},Gn=(e,t)=>e?.dispatchStatus?.[t]?.error,kn=(0,h.createReduxStore)(dn,{initialState:En,selectors:E,actions:l,reducer:(e=En,{type:t,queryText:n,results:r,error:s,actionName:i,status:c,message:o})=>{var a;switch(t){case On:return{...e,currentQuery:n};case Ln:return e.currentQuery===n?{searchResults:r}:e;case mn:return e.currentQuery===n?{...e,error:s}:e;case Hn:return{...e,dispatchStatus:{...e.dispatchStatus,[i]:{...null!==(a=e?.dispatchStatus?.[i])&&void 0!==a?a:{},status:c,error:o}}};default:return e}},controls:{...C.controls,...T,...Tn}});var Kn=window.wp.element,xn=()=>{var e,t,n,r;const{connectInfo:s,licenseKey:i,licenseStatus:c,isSaving:o,proWasActivated:a,isActivatingPro:u}=(0,h.useSelect)((e=>{const t=e(ge);return{connectInfo:t.getConnectInfo(),licenseKey:t.getLicenseKey(),licenseStatus:t.getLicenseStatus(),isSaving:t.isDispatching("activateLicense")||t.isDispatching("deactivateLicense")||t.isDispatching("checkLicenseStatus")||t.isDispatching("updateLicenseKey")||t.isDispatching("removeLicense"),isActivatingPro:t.isDispatching("activatePro"),proWasActivated:t.hasDispatched("activatePro")}}),[]),{activateLicense:d,deactivateLicense:l,checkLicenseStatus:E,updateLicenseKey:S,removeLicense:g,activatePro:p}=(0,h.useDispatch)(ge),\_="valid"===c?.license,y=["deactivated","site\_inactive","inactive"].includes(null!==(e=c?.license)&&void 0!==e?e:""),T=["invalid","failed"].includes(c?.license),f=T&&["","missing"].includes(null!==(t=c?.error)&&void 0!==t?t:""),A="expired"===c?.license||["invalid","failed"].includes(null!==(n=c?.license)&&void 0!==n?n:"")&&"expired"===c?.error,C="disabled"===c?.license||T&&"disabled"===c?.error,R="no\_activations\_left"===c?.error,v=!!c?.error,I=T&&v&&!["missing","expired","disabled"].includes(null!==(r=c?.error)&&void 0!==r?r:""),N=(0,Kn.useMemo)((()=>\_||y||A||C||R),[\_,y,A,C,R]),D=(0,Kn.useMemo)((()=>\_?"active":A?"expired":f?"missing":y?"deactivated":C?"disabled":I?"error":"unknown"),[\_,A,f,y,C,I]),m=(0,Kn.useMemo)((()=>{var e;let t=null!==(e=c?.price\_id)&&void 0!==e?e:null;if(null===t)return-1;switch("string"==typeof t&&(t=parseInt(t,10)),t){default:return-1;case!1:case 0:return 0;case 1:case 2:case 3:case 4:return t}}),[c?.price\_id]);return{connectInfo:s,licenseKey:i,licenseStatus:c,licenseLevel:m,activateLicense:d,deactivateLicense:l,checkLicenseStatus:E,updateLicenseKey:S,removeLicense:g,activatePro:p,getLicenseStatusName:D,isSaving:o,isActivatingPro:u,proWasActivated:a,isLicenseKeyValid:N,isLicenseActive:\_,isLicenseDeactivated:y,isLicenseMissing:f,isLicenseExpired:A,isLicenseInvalid:T,isLicenseDisabled:C,isLicenseOverQuota:R,isGeneralError:I,hasError:v}},Vn=()=>{const{currentSettings:e,unsavedChanges:t,hasUnsavedChanges:n,isSaving:r}=(0,h.useSelect)((e=>{const t=e(rt);return{unsavedChanges:t.getUnsavedChanges(),hasUnsavedChanges:t.hasUnsavedChanges(),currentSettings:t.getSettings(),isSaving:t.isDispatching("updateSettings")||t.isDispatching("saveSettings")}}),[]),{updateSettings:s,saveSettings:i,stageUnsavedChanges:c}=(0,h.useDispatch)(rt),o=(0,Kn.useMemo)((()=>({...e,...t})),[e,t]);return{currentSettings:e,settings:o,getSetting:(e,t)=>{var n;return null!==(n=o[e])&&void 0!==n?n:t},updateSettings:s,saveSettings:i,isSaving:r,hasUnsavedChanges:n,stageUnsavedChanges:c,unsavedChanges:t}};(window.contentControl=window.contentControl||{}).coreData=t}(); |
* ## [content-control/trunk/dist/fields.asset.php](/changeset/3052982/content-control/trunk/dist/fields.asset.php?old=3007200&old_path=content-control%2Ftrunk%2Fdist%2Ffields.asset.php "Show the [3007200:3052982] differences restricted to content-control/trunk/dist/fields.asset.php")

  | [r3007200](/browser/content-control/trunk/dist/fields.asset.php?rev=3007200#L1 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/dist/fields.asset.php?rev=3052982#L1 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('content-control-components', 'content-control-utils', 'react', 'wp-components', 'wp-compose', 'wp-core-data', 'wp-data', 'wp-element', 'wp-hooks', 'wp-html-entities', 'wp-i18n'), 'version' => '~~76028d6e0747859bb1ab~~'); |
  |  | 1 | <?php return array('dependencies' => array('content-control-components', 'content-control-utils', 'react', 'wp-components', 'wp-compose', 'wp-core-data', 'wp-data', 'wp-element', 'wp-hooks', 'wp-html-entities', 'wp-i18n'), 'version' => 'b80778b8bb769e7642fe'); |
* ## [content-control/trunk/dist/fields.js](/changeset/3052982/content-control/trunk/dist/fields.js?old=3007200&old_path=content-control%2Ftrunk%2Fdist%2Ffields.js "Show the [3007200:3052982] differences restricted to content-control/trunk/dist/fields.js")

  | [r3007200](/browser/content-control/trunk/dist/fields.js?rev=3007200#L1 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/dist/fields.js?rev=3052982#L1 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | !function(){var e={184:function(e,t){var n;!function(){"use strict";var o={}.hasOwnProperty;function ~~l(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"===r||"number"===r)e.push(n);else if(Array.isArray(n)){if(n.length){var a=l.apply(null,n);a&&e.push(a)}}else if("object"===r){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)o.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(l.default=l,e.exports=l):void 0===(n=function(){return l}.apply(t,[]))||(e.exports=n)}()}},t={};function n(o){var l=t[o];if(void 0!==l)return l.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.n=function(e){var t=e&&e.\_\_esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})};var o={};!function(){"use strict";n.r(o),n.d(o,{CheckboxField:function(){return l},ColorField:function(){return r},DateField:function(){return a},Field:function(){return v},FieldContextProvider:function(){return P},Fields:function(){return g},FieldsContext:function(){return I},MeasureField:function(){return f},MulticheckField:function(){return h},NumberField:function(){return b},ObjectSelectField:function(){return \_},RadioField:function(){return F},RangeSliderField:function(){return S},SelectField:function(){return T},TextAreaField:function(){return N},TextField:function(){return O},TokenSelectField:function(){return M},useFields:function(){return B}});var e=window.React,t=window.wp.components,l=({value:n,onChange:o,label:l,...r})=>(0,e.createElement)(t.CheckboxControl,{...r,label:l,checked:n,onChange:o}),r=({value:n="",onChange:o,...l})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.ColorIndicator,{colorValue:n}),(0,e.createElement)(t.ColorPicker,{...l,color:n,onChangeComplete:e=>{var t;return o(null!==(t=e?.hex)&&void 0!==t?t:e)}}),(0,e.createElement)(t.ColorPalette,{value:n,onChange:e=>{o(null!=e?e:"")},colors:[{name:"red",color:"#f00"},{name:"white",color:"#fff"},{name:"blue",color:"#00f"}],clearable:!0})),a=({value:n,onChange:o,...l})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.BaseControl,{...l,\_\_nextHasNoMarginBottom:!0,hideLabelFromVision:!0},(0,e.createElement)("input",{type:"date",value:n,onChange:e=>o(e.target.value)}))),s=n(184),i=n.n(s),c=window.wp.i18n,u=window.contentControl.utils;window.wp.htmlEntities;const p=e=>"string"==typeof e?e.split(",").map((e=>({label:e,value:e}))):Array.isArray(e)||"object"!=typeof e?e.map((e=>"string"==typeof e?{label:e,value:e}:e)):Object.entries(e).map((([e,t])=>({label:t,value:e}))),d=t=>{var n,o,l,r,a,s;let c;switch(c=function(e){const t={...e};return!(!t||"object"!=typeof t||void 0===t?.std&&void 0===t?.taxonomy&&void 0===t?.post\_type)}(t)?(t=>{var n,o,l,r,a,s,c;const d={type:"select2"!==t.type?t.type:"select",default:t.std,id:null!==(n=null!==(o=t.id)&&void 0!==o?o:t.name)&&void 0!==n?n:"",...(0,u.pick)(t,"id","name","label","value","required","dependencies")},m=[];switch(void 0!==t.classes&&("string"==typeof t.classes?m.push(...t.classes.split(" ")):Array.isArray(t.classes)&&m.push(...t.classes)),void 0!==t.class&&m.push(t.class),d.className=i()(m),t.dynamic\_desc?d.help=(0,e.createElement)(e.Fragment,null,t.dynamic\_desc):t.desc&&(d.help=t.desc),d.type){case"checkbox":case"hidden":case"license\_key":return d;case"color":return{...d,default:null!==(l=t.value)&&void 0!==l?l:""};case"text":case"email":case"tel":case"password":default:return{...d,...d.type===t.type&&{size:t?.size,placeholder:t?.placeholder}};case"radio":case"multicheck":return{...d,options:[],...d.type===t.type&&{options:null!==(r=t.options)&&void 0!==r?r:[]}};case"select":case"multiselect":var v;return d.type!==t.type&&"select2"!==t.type||(d.options=p(null!==(v=t.options)&&void 0!==v?v:[]),d.searchable="select2"===t.type,d.multiple="multiselect"===d.type||t.multiple),{options:[],...d};case"tokenselect":return{value:[],options:{},...d};case"number":case"rangeslider":return{...d,...d.type===t.type&&{size:t?.size,placeholder:t?.placeholder,min:t?.min,max:t?.max,step:t?.step}};case"measure":return{...d,units:{},...d.type===t.type&&{size:t?.size,placeholder:t?.placeholder,min:t?.min,max:t?.max,step:t?.step,units:null!==(a=t?.units)&&void 0!==a?a:{}}};case"objectselect":case"postselect":case"taxonomyselect":d.type="objectselect",d.multiple=null!==(s=t?.multiple)&&void 0!==s&&s,d.placeholder=null!==(c=t?.placeholder)&&void 0!==c?c:"";let e="postType",n="";var g;if("postselect"===t.type)e="postType",n=null!==(g=t?.post\_type)&&void 0!==g?g:"post";else if("taxonomyselect"===t.type){var y;e="taxonomy",n=null!==(y=t?.taxonomy)&&void 0!==y?y:"category"}else{var f;e=t?.post\_type?"postType":"taxonomy",n=null!==(f=t?.post\_type)&&void 0!==f?f:t?.taxonomy}return{...d,entityKind:e,entityType:n};case"textarea":return{...d,...d.type===t.type&&{allowHtml:t?.allow\_html}}}})(t):t,c.type){case"checkbox":case"color":case"radio":case"rangeslider":case"number":default:case"email":case"tel":case"hidden":case"text":case"password":case"license\_key":case"measure":case"textarea":return{...c};case"multicheck":return{...c,options:null!==(n=c.options)&&void 0!==n?n:[]};case"select":return{...c,options:null!==(o=c.options)&&void 0!==o?o:[]};case"multiselect":return{...c,options:null!==(l=c.options)&&void 0!==l?l:[],multiple:!0};case"objectselect":case"postselect":case"taxonomyselect":return{...c,entityKind:null!==(r=c.entityKind)&&void 0!==r?r:""};case"tokenselect":return{...c,value:null!==(a=c.value)&&void 0!==a?a:[],options:null!==(s=c.options)&&void 0!==s?s:[]}}},m=t=>{const{type:n}=t;switch(n){case"checkbox":return(0,e.createElement)(l,{...t});case"color":return(0,e.createElement)(r,{...t});case"date":return(0,e.createElement)(a,{...t});case"measure":return(0,e.createElement)(f,{...t});case"multicheck":return(0,e.createElement)(h,{...t});case"select":case"multiselect":return(0,e.createElement)(T,{...t});case"objectselect":case"postselect":case"taxonomy~~select":return(0,e.createElement)(\_,{...t});case"radio":return(0,e.createElement)(F,{...t});case"rangeslider":return(0,e.createElement)(S,{...t});case"number":return(0,e.createElement)(b,{...t});case"email":case"tel":case"hidden":case"text":case"password":return(0,e.createElement)(O,{...t});case"textarea":return(0,e.createElement)(N,{...t});case"tokenselect":return(0,e.createElement)(M,{...t})}return(0,e.createElement)(e.Fragment,null,(0,c.sprintf)(/\* translators: 1. type of field not found. \*/ |
  | 2 |  | (0,c.\_\_)("Field type `%s` not found","content-control"),n))};var v=t=>{const{type:n,className:o,onChange:~~l}=t;return(0,e.createElement)("div",{className:i()(["cc-field",`cc-field--${n}`,o])},(0,e.createElement)(m,{onChange:l,...d(t)}))},g=t=>{const{fields:n}=t;return(0,e.createElement)(e.Fragment,null,n.map(((t,n)=>(0,e.createElement)(v,{key:n,...t}))))},y=window.wp.element,f=({value:n,onChange:o,units:l,...r})=>{var a;const s=n?parseInt(n):"",[i,c]=(0,y.useState)({number:s,unit:null!==(a=n?.replace(`${s}`,""))&&void 0!==a?a:""});(0,y.useEffect)((()=>{o(`${i.number}${i.unit}`)}),[i,o]);const u=Object.entries(l).map((([e,t])=>({value:e,label:t})));return(0,e.createElement)(t.\_\_experimentalUnitControl,{...r,value:n,onChange:(e="0")=>c({...i,number:e}),disableUnits:0===u.length,units:u,onUnitChange:(e="")=>c({...i,unit:e}),\_\_nextHasNoMarginBottom:!0})},h=({value:n,onChange:o,...l})=>{const r=null!=n?n:[],a=p(l.options),s=null!=n?n:[];return(0,e.createElement)((()=>(0,e.createElement)(e.Fragment,null,a.map((({label:n,value:l})=>{const a=r.indexOf(l)>=0;return(0,e.createElement)(t.CheckboxControl,{key:l,label:n,checked:a,onChange:()=>o(a?s.filter((e=>l!==e)):[...s,l])})})))),null)},b=({value:n,onChange:o,...l})=>(0,e.createElement)(t.\_\_experimentalNumberControl,{...l,value:n,onChange:(e="0")=>o(parseInt(e,10)),\_\_nextHasNoMarginBottom:!0}),C=window.wp.data,x=window.wp.compose,w=window.wp.coreData,E=window.contentControl.components,\_=({label:t,value:n,onChange:o,entityKind:l="postType",entityType:r="post",multiple:a=!1})=>{const[s,i]=(0,y.useState)(""),u=(0,x.useDebounce)((e=>{i(e)}),300),{prefill:p=[]}=(0,C.useSelect)((e=>({prefill:n?e(w.store).getEntityRecords(l,r,{context:"view",include:n,per\_page:-1}):[]})),[n,l,r]),{suggestions:d=[],isSearching:m=!1}=(0,C.useSelect)((e=>({suggestions:e(w.store).getEntityRecords(l,r,{context:"view",search:s,per\_page:-1}),isSearching:e("core/data").isResolving("core","getEntityRecords",[l,r,{context:"view",search:s,per\_page:-1}])})),[s,l,r~~]),v=e=>d&&d.find((t=>t.id.toString()===e.toString()))||p&&p.find((t=>t.id.toString()===e.toString())),g=n?"number"==typeof n||"string"==typeof n?[n]:n:[],f=e=>"object"==typeof e?e.value:e;return(0,e.createElement)("div",{className:"cc-object-search-field"},(0,e.createElement)(E.SmartTokenControl,{label:t||(0,c.sprintf)( |
  |  | 1 | !function(){var e={184:function(e,t){var n;!function(){"use strict";var o={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var l=typeof n;if("string"===l||"number"===l)e.push(n);else if(Array.isArray(n)){if(n.length){var a=r.apply(null,n);a&&e.push(a)}}else if("object"===l){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)o.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,n),l.exports}n.n=function(e){var t=e&&e.\_\_esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})};var o={};!function(){"use strict";n.r(o),n.d(o,{CheckboxField:function(){return r},ColorField:function(){return l},DateField:function(){return a},Field:function(){return v},FieldContextProvider:function(){return P},Fields:function(){return g},FieldsContext:function(){return I},MeasureField:function(){return f},MulticheckField:function(){return h},NumberField:function(){return b},ObjectSelectField:function(){return \_},RadioField:function(){return F},RangeSliderField:function(){return S},SelectField:function(){return T},TextAreaField:function(){return N},TextField:function(){return O},TokenSelectField:function(){return M},useFields:function(){return R}});var e=window.React,t=window.wp.components,r=({value:n,onChange:o,label:r,...l})=>(0,e.createElement)(t.CheckboxControl,{...l,label:r,checked:n,onChange:o}),l=({value:n="",onChange:o,...r})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.ColorIndicator,{colorValue:n}),(0,e.createElement)(t.ColorPicker,{...r,color:n,onChangeComplete:e=>{var t;return o(null!==(t=e?.hex)&&void 0!==t?t:e)}}),(0,e.createElement)(t.ColorPalette,{value:n,onChange:e=>{o(null!=e?e:"")},colors:[{name:"red",color:"#f00"},{name:"white",color:"#fff"},{name:"blue",color:"#00f"}],clearable:!0})),a=({value:n,onChange:o,...r})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.BaseControl,{...r,\_\_nextHasNoMarginBottom:!0,hideLabelFromVision:!0},(0,e.createElement)("input",{type:"date",value:n,onChange:e=>o(e.target.value)}))),s=n(184),i=n.n(s),c=window.wp.i18n,u=window.contentControl.utils;window.wp.htmlEntities;const p=e=>"string"==typeof e?e.split(",").map((e=>({label:e,value:e}))):Array.isArray(e)||"object"!=typeof e?e.map((e=>"string"==typeof e?{label:e,value:e}:e)):Object.entries(e).map((([e,t])=>({label:t,value:e}))),d=t=>{var n,o,r,l,a,s;let c;switch(c=function(e){const t={...e};return!(!t||"object"!=typeof t||void 0===t?.std&&void 0===t?.user\_roles&&(void 0===t?.type||"userselect"!==t?.type)&&void 0===t?.taxonomy&&void 0===t?.post\_type)}(t)?(t=>{var n,o,r,l,a,s,c;const d={type:"select2"!==t.type?t.type:"select",default:t.std,id:null!==(n=null!==(o=t.id)&&void 0!==o?o:t.name)&&void 0!==n?n:"",...(0,u.pick)(t,"id","name","label","value","required","dependencies")},m=[];switch(void 0!==t.classes&&("string"==typeof t.classes?m.push(...t.classes.split(" ")):Array.isArray(t.classes)&&m.push(...t.classes)),void 0!==t.class&&m.push(t.class),d.className=i()(m),t.dynamic\_desc?d.help=(0,e.createElement)(e.Fragment,null,t.dynamic\_desc):t.desc&&(d.help=t.desc),d.type){case"checkbox":case"hidden":case"license\_key":return d;case"color":return{...d,default:null!==(r=t.value)&&void 0!==r?r:""};case"text":case"email":case"tel":case"password":default:return{...d,...d.type===t.type&&{size:t?.size,placeholder:t?.placeholder}};case"radio":case"multicheck":return{...d,options:[],...d.type===t.type&&{options:null!==(l=t.options)&&void 0!==l?l:[]}};case"select":case"multiselect":var v;return d.type!==t.type&&"select2"!==t.type||(d.options=p(null!==(v=t.options)&&void 0!==v?v:[]),d.searchable="select2"===t.type,d.multiple="multiselect"===d.type||t.multiple),{options:[],...d};case"tokenselect":return{value:[],options:{},...d};case"number":case"rangeslider":return{...d,...d.type===t.type&&{size:t?.size,placeholder:t?.placeholder,min:t?.min,max:t?.max,step:t?.step}};case"measure":return{...d,units:{},...d.type===t.type&&{size:t?.size,placeholder:t?.placeholder,min:t?.min,max:t?.max,step:t?.step,units:null!==(a=t?.units)&&void 0!==a?a:{}}};case"objectselect":case"postselect":case"taxonomyselect":case"userselect":d.type="objectselect",d.multiple=null!==(s=t?.multiple)&&void 0!==s&&s,d.placeholder=null!==(c=t?.placeholder)&&void 0!==c?c:"";let e="postType",n="";var g;if("postselect"===t.type)e="postType",n=null!==(g=t?.post\_type)&&void 0!==g?g:"post";else if("taxonomyselect"===t.type){var y;e="taxonomy",n=null!==(y=t?.taxonomy)&&void 0!==y?y:"category"}else if("userselect"===t.type)e="user",n="user";else{var f;e=t?.post\_type?"postType":"taxonomy",n=null!==(f=t?.post\_type)&&void 0!==f?f:t?.taxonomy}return{...d,entityKind:e,entityType:n};case"textarea":return{...d,...d.type===t.type&&{allowHtml:t?.allow\_html}}}})(t):t,c.type){case"checkbox":case"color":case"radio":case"rangeslider":case"number":default:case"email":case"tel":case"hidden":case"text":case"password":case"license\_key":case"measure":case"textarea":return{...c};case"multicheck":return{...c,options:null!==(n=c.options)&&void 0!==n?n:[]};case"select":return{...c,options:null!==(o=c.options)&&void 0!==o?o:[]};case"multiselect":return{...c,options:null!==(r=c.options)&&void 0!==r?r:[],multiple:!0};case"objectselect":case"postselect":case"taxonomyselect":case"userselect":return{...c,entityKind:null!==(l=c.entityKind)&&void 0!==l?l:""};case"tokenselect":return{...c,value:null!==(a=c.value)&&void 0!==a?a:[],options:null!==(s=c.options)&&void 0!==s?s:[]}}},m=t=>{const{type:n}=t;switch(n){case"checkbox":return(0,e.createElement)(r,{...t});case"color":return(0,e.createElement)(l,{...t});case"date":return(0,e.createElement)(a,{...t});case"measure":return(0,e.createElement)(f,{...t});case"multicheck":return(0,e.createElement)(h,{...t});case"select":case"multiselect":return(0,e.createElement)(T,{...t});case"objectselect":case"postselect":case"taxonomyselect":case"userselect":return(0,e.createElement)(\_,{...t});case"radio":return(0,e.createElement)(F,{...t});case"rangeslider":return(0,e.createElement)(S,{...t});case"number":return(0,e.createElement)(b,{...t});case"email":case"tel":case"hidden":case"text":case"password":return(0,e.createElement)(O,{...t});case"textarea":return(0,e.createElement)(N,{...t});case"tokenselect":return(0,e.createElement)(M,{...t})}return(0,e.createElement)(e.Fragment,null,(0,c.sprintf)(/\* translators: 1. type of field not found. \*/ |
  |  | 2 | (0,c.\_\_)("Field type `%s` not found","content-control"),n))};var v=t=>{const{type:n,className:o,onChange:r}=t;return(0,e.createElement)("div",{className:i()(["cc-field",`cc-field--${n}`,o])},(0,e.createElement)(m,{onChange:r,...d(t)}))},g=t=>{const{fields:n}=t;return(0,e.createElement)(e.Fragment,null,n.map(((t,n)=>(0,e.createElement)(v,{key:n,...t}))))},y=window.wp.element,f=({value:n,onChange:o,units:r,...l})=>{var a;const s=n?parseInt(n):"",[i,c]=(0,y.useState)({number:s,unit:null!==(a=n?.replace(`${s}`,""))&&void 0!==a?a:""});(0,y.useEffect)((()=>{o(`${i.number}${i.unit}`)}),[i,o]);const u=Object.entries(r).map((([e,t])=>({value:e,label:t})));return(0,e.createElement)(t.\_\_experimentalUnitControl,{...l,value:n,onChange:(e="0")=>c({...i,number:e}),disableUnits:0===u.length,units:u,onUnitChange:(e="")=>c({...i,unit:e}),\_\_nextHasNoMarginBottom:!0})},h=({value:n,onChange:o,...r})=>{const l=null!=n?n:[],a=p(r.options),s=null!=n?n:[];return(0,e.createElement)((()=>(0,e.createElement)(e.Fragment,null,a.map((({label:n,value:r})=>{const a=l.indexOf(r)>=0;return(0,e.createElement)(t.CheckboxControl,{key:r,label:n,checked:a,onChange:()=>o(a?s.filter((e=>r!==e)):[...s,r])})})))),null)},b=({value:n,onChange:o,...r})=>(0,e.createElement)(t.\_\_experimentalNumberControl,{...r,value:n,onChange:(e="0")=>o(parseInt(e,10)),\_\_nextHasNoMarginBottom:!0}),C=window.wp.data,x=window.wp.compose,w=window.wp.coreData,E=window.contentControl.components,\_=({label:t,value:n,onChange:o,entityKind:r="postType",entityType:l="post",multiple:a=!1})=>{const[s,i]=(0,y.useState)(""),u=(0,x.useDebounce)((e=>{i(e)}),300),{prefill:p=[]}=(0,C.useSelect)((e=>({prefill:n?e(w.store).getEntityRecords(r,l,{context:"view",include:n,per\_page:-1}):[]})),[n,r,l]),{suggestions:d=[],isSearching:m=!1}=(0,C.useSelect)((e=>({suggestions:"user"===r?e(w.store).getUsers({context:"view",search:s,per\_page:-1}):e(w.store).getEntityRecords(r,l,{context:"view",search:s,per\_page:-1}),isSearching:"user"===r?e("core/data").isResolving("core","getUsers",[r,l,{context:"view",search:s,per\_page:-1}]):e("core/data").isResolving("core","getEntityRecords",[r,l,{context:"view",search:s,per\_page:-1}])})),[s,r,l]),v=e=>d&&d.find((t=>t.id.toString()===e.toString()))||p&&p.find((t=>t.id.toString()===e.toString())),g=n?"number"==typeof n||"string"==typeof n?[n]:n:[],f=e=>"object"==typeof e?e.value:e;return(0,e.createElement)("div",{className:"cc-object-search-field"},(0,e.createElement)(E.SmartTokenControl,{label:t||(0,c.sprintf)( |
  | 3 | 3 | // translators: %s: entity type. |
  | 4 |  | (0,c.\_\_)("%s(s)","content-control"),~~r.replace(/\_/g," ").charAt(0).toUpperCase()+r~~.replace(/\_/g," ").slice(1)),hideLabelFromVision:!0,multiple:a,placeholder:(0,c.sprintf)( |
  |  | 4 | (0,c.\_\_)("%s(s)","content-control"),l.replace(/\_/g," ").charAt(0).toUpperCase()+l.replace(/\_/g," ").slice(1)),hideLabelFromVision:!0,multiple:a,placeholder:(0,c.sprintf)( |
  | 5 | 5 | // translators: %s: entity type. |
  | 6 |  | (0,c.\_\_)("Select %s(s)","content-control"),~~r.replace(/\_/g," ").toLowerCase()),tokenOnComma:!0,value:g.map((e=>e.toString())),onInputChange:u,onChange:e=>{o(e.map((e=>parseInt(f(e),10))).filter((e=>!isNaN(e))))},renderToken:e=>{const t=v(f(e));return t?"postType"===l?t.title.rendered:t.name:f(e)},renderSuggestion:t=>{var n;const o=v(t);return o?(0,e.createElement)(e.Fragment,null,"postType"===l?null!==(n=o.title.rendered)&&void 0!==n?n:o.title.raw:o.name):t},suggestions:d?d.map((e=>{var t;return null!==(t=e?.id.toString())&&void 0!==t&&t})):[],messages:m?{noSuggestions:(0,c.\_\_)("Searching…","content-control")}:void 0}))},F=({value:n,onChange:o,...l})=>{const r=l.options;return(0,e.createElement)(t.RadioControl,{...l,selected:n?.toString(),options:r,onChange:o,\_\_nextHasNoMarginBottom:!0})},S=({value:n,onChange:o,initialPosition:l=0,...r})=>{const{step:a}=r;return(0,e.createElement)(t.RangeControl,{value:null!=n?n:l,onChange:(e=0)=>o(e),withInputField:!0,\_\_nextHasNoMarginBottom:!0,type:a?"stepper":void 0})};const k=({options:t})=>(0,e.createElement)(e.Fragment,null,p(t).map((({label:t,value:n})=>(0,e.createElement)("option",{key:n,value:n},t)))),j=({optGroups:t})=>(0,e.createElement)(e.Fragment,null,Object.entries(t).map((([t,n])=>(0,e.createElement)("optgroup",{key:t,label:t},(0,e.createElement)(k,{options:n})))));var T=({value:n,onChange:o,...l})=>{var r;const{multiple:a=!1}=l,s=null!==(r=l.options)&&void 0!==r?r:{};return(0,e.createElement)(t.SelectControl,{...l,multiple:a,value:a&&"string"==typeof n?n.split(","):n,onChange:o,\_\_nextHasNoMarginBottom:!0},(e=>Object.entries(e).reduce(((e,[t,n])=>!0===e?e:"string"==typeof t&&!(parseInt(t)>=0)&&"object"==typeof n),!1))(s)?(0,e.createElement)(j,{optGroups:s}):(0,e.createElement)(k,{options:s}))},N=({value:n,onChange:o,rows:l=5,...r})=>(0,e.createElement)(t.TextareaControl,{...r,value:null!=n?n:"",onChange:o,rows:l,\_\_nextHasNoMarginBottom:!0}),O=({type:n,value:o,onChange:l,...r})=>(0,e.createElement)(t.TextControl,{...r,type:"hidden"!==n?n:void 0,value:null!=o?o:"",onChange:l,\_\_nextHasNoMarginBottom:!0}),M=({label:t,value:n,onChange:o,multiple:l=!1,placeholder:r=(0,c.\_\_)("Search","content-control"),options:a={}})=>{const[s,i]=(0,y.useState)(""),u=n?"number"==typeof n||"string"==typeof n?[n]:n:[],p=Object.keys(a).filter((e=>!s||e.toLowerCase().includes(s.toLowerCase()))),d=e=>{var t;const n="object"==typeof e?e.value:e;return(null!==(t=a[n])&&void 0!==t?t:null)||n};return(0,e.createElement)("div",{className:"cc-token-select-field"},(0,e.createElement)(E.SmartTokenControl,{label:t,hideLabelFromVision:!0,multiple:l,placeholder:r,value:u.map((e=>e.toString())),onInputChange:i,onChange:e=>o(e),renderToken:d,renderSuggestion:d,suggestions:p}))},V=window.wp.hooks;const I=(0,y.createContext)({context:"",fields:[],values:{},setValues:()=>{}}),P=({context:t,fields:n,values:o,setValues:l,children:r})=>(0,e.createElement)(I.Provider,{value:{context:t,fields:n,values:o,setValues:l}},r);var B=()=>{const{context:e,fields:t=[],values:n,setValues:o}=(0,y.useContext)(I),l=t=>{const o=(0,V.applyFilters)(`${e}.fieldIsVisible`,void 0,t,n);return void 0===o||o};return{context:e,fields:t,values:n,setValues:o,getFields:(n={visible:!0})=>{const o=(null!=t?t:[]).filter((e=>!(n?.tab&&e.tab!==n.tab||n?.section&&e.section!==n.section||n?.panel&&e.panel!==n.panel||n?.visible&&!l(e.id)))).sort(((e,t)=>e.priority-t.priority)).map((t=>{const n=(0,V.applyFilters)(`${e}.renderField`,t.component,t.id,t);return{...t,component:n}}));return(0,V.applyFilters)(`${e}.getFields`,o,n)},updateField:(e,t)=>{o({...n,[e]:t})},fieldIsVisible:l~~}}}(),(window.contentControl=window.contentControl||{}).fields=o}(); |
  |  | 6 | (0,c.\_\_)("Select %s(s)","content-control"),l.replace(/\_/g," ").toLowerCase()),tokenOnComma:!0,value:g.map((e=>e.toString())),onInputChange:u,onChange:e=>{o(e.map((e=>parseInt(f(e),10))).filter((e=>!isNaN(e))))},renderToken:e=>{const t=v(f(e));return t?"postType"===r?t.title.rendered:t.name:f(e)},renderSuggestion:t=>{var n;const o=v(t);return o?(0,e.createElement)(e.Fragment,null,"postType"===r?null!==(n=o.title.rendered)&&void 0!==n?n:o.title.raw:o.name):t},suggestions:d?d.map((e=>{var t;return null!==(t=e?.id.toString())&&void 0!==t&&t})):[],messages:m?{noSuggestions:(0,c.\_\_)("Searching…","content-control")}:void 0}))},F=({value:n,onChange:o,...r})=>{const l=r.options;return(0,e.createElement)(t.RadioControl,{...r,selected:n?.toString(),options:l,onChange:o,\_\_nextHasNoMarginBottom:!0})},S=({value:n,onChange:o,initialPosition:r=0,...l})=>{const{step:a}=l;return(0,e.createElement)(t.RangeControl,{value:null!=n?n:r,onChange:(e=0)=>o(e),withInputField:!0,\_\_nextHasNoMarginBottom:!0,type:a?"stepper":void 0})};const k=({options:t})=>(0,e.createElement)(e.Fragment,null,p(t).map((({label:t,value:n})=>(0,e.createElement)("option",{key:n,value:n},t)))),j=({optGroups:t})=>(0,e.createElement)(e.Fragment,null,Object.entries(t).map((([t,n])=>(0,e.createElement)("optgroup",{key:t,label:t},(0,e.createElement)(k,{options:n})))));var T=({value:n,onChange:o,...r})=>{var l;const{multiple:a=!1}=r,s=null!==(l=r.options)&&void 0!==l?l:{};return(0,e.createElement)(t.SelectControl,{...r,multiple:a,value:a&&"string"==typeof n?n.split(","):n,onChange:o,\_\_nextHasNoMarginBottom:!0},(e=>Object.entries(e).reduce(((e,[t,n])=>!0===e?e:"string"==typeof t&&!(parseInt(t)>=0)&&"object"==typeof n),!1))(s)?(0,e.createElement)(j,{optGroups:s}):(0,e.createElement)(k,{options:s}))},N=({value:n,onChange:o,rows:r=5,...l})=>(0,e.createElement)(t.TextareaControl,{...l,value:null!=n?n:"",onChange:o,rows:r,\_\_nextHasNoMarginBottom:!0}),O=({type:n,value:o,onChange:r,...l})=>(0,e.createElement)(t.TextControl,{...l,type:"hidden"!==n?n:void 0,value:null!=o?o:"",onChange:r,\_\_nextHasNoMarginBottom:!0}),M=({label:t,value:n,onChange:o,multiple:r=!1,placeholder:l=(0,c.\_\_)("Search","content-control"),options:a={}})=>{const[s,i]=(0,y.useState)(""),u=n?"number"==typeof n||"string"==typeof n?[n]:n:[],p=Object.keys(a).filter((e=>!s||e.toLowerCase().includes(s.toLowerCase()))),d=e=>{var t;const n="object"==typeof e?e.value:e;return(null!==(t=a[n])&&void 0!==t?t:null)||n};return(0,e.createElement)("div",{className:"cc-token-select-field"},(0,e.createElement)(E.SmartTokenControl,{label:t,hideLabelFromVision:!0,multiple:r,placeholder:l,value:u.map((e=>e.toString())),onInputChange:i,onChange:e=>o(e),renderToken:d,renderSuggestion:d,suggestions:p}))},V=window.wp.hooks;const I=(0,y.createContext)({context:"",fields:[],values:{},setValues:()=>{}}),P=({context:t,fields:n,values:o,setValues:r,children:l})=>(0,e.createElement)(I.Provider,{value:{context:t,fields:n,values:o,setValues:r}},l);var R=()=>{const{context:e,fields:t=[],values:n,setValues:o}=(0,y.useContext)(I),r=t=>{const o=(0,V.applyFilters)(`${e}.fieldIsVisible`,void 0,t,n);return void 0===o||o};return{context:e,fields:t,values:n,setValues:o,getFields:(n={visible:!0})=>{const o=(null!=t?t:[]).filter((e=>!(n?.tab&&e.tab!==n.tab||n?.section&&e.section!==n.section||n?.panel&&e.panel!==n.panel||n?.visible&&!r(e.id)))).sort(((e,t)=>e.priority-t.priority)).map((t=>{const n=(0,V.applyFilters)(`${e}.renderField`,t.component,t.id,t);return{...t,component:n}}));return(0,V.applyFilters)(`${e}.getFields`,o,n)},updateField:(e,t)=>{o({...n,[e]:t})},fieldIsVisible:r}}}(),(window.contentControl=window.contentControl||{}).fields=o}(); |
* ## [content-control/trunk/dist/settings-page.asset.php](/changeset/3052982/content-control/trunk/dist/settings-page.asset.php?old=3007200&old_path=content-control%2Ftrunk%2Fdist%2Fsettings-page.asset.php "Show the [3007200:3052982] differences restricted to content-control/trunk/dist/settings-page.asset.php")

  | [r3007200](/browser/content-control/trunk/dist/settings-page.asset.php?rev=3007200#L1 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/dist/settings-page.asset.php?rev=3052982#L1 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('content-control-components', 'content-control-core-data', 'content-control-data', 'content-control-fields', 'content-control-icons', 'content-control-rule-engine', 'content-control-utils', 'react', 'wp-components', 'wp-compose', 'wp-data', 'wp-element', 'wp-hooks', 'wp-i18n', 'wp-primitives'), 'version' => '~~5919f65ebfb638f75358~~'); |
  |  | 1 | <?php return array('dependencies' => array('content-control-components', 'content-control-core-data', 'content-control-data', 'content-control-fields', 'content-control-icons', 'content-control-rule-engine', 'content-control-utils', 'react', 'wp-components', 'wp-compose', 'wp-data', 'wp-element', 'wp-hooks', 'wp-i18n', 'wp-primitives'), 'version' => '6d4e12d639d9151e1ced'); |
* ## [content-control/trunk/dist/settings-page.js](/changeset/3052982/content-control/trunk/dist/settings-page.js?old=3007200&old_path=content-control%2Ftrunk%2Fdist%2Fsettings-page.js "Show the [3007200:3052982] differences restricted to content-control/trunk/dist/settings-page.js")

  | [r3007200](/browser/content-control/trunk/dist/settings-page.js?rev=3007200#L1 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/dist/settings-page.js?rev=3052982#L1 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | !function(){var e={184:function(e,t){var n;!function(){"use strict";var o={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var l=typeof n;if("string"===l||"number"===l)e.push(n);else if(Array.isArray(n)){if(n.length){var a=r.apply(null,n);a&&e.push(a)}}else if("object"===l){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var c in n)o.call(n,c)&&n[c]&&e.push(c)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,n),l.exports}n.n=function(e){var t=e&&e.\_\_esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})};var o={};!function(){"use strict";n.r(o),n.d(o,{init:function(){return mn}});var e,t,r=window.React;function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l.apply(this,arguments)}(t=e||(e={})).Pop="POP",t.Push="PUSH",t.Replace="REPLACE";const a="popstate";function c(e,t){if(!1===e||null==e)throw new Error(t)}function s(e,t){return{usr:e.state,key:e.key,idx:t}}function i(e,t,n,o){return void 0===n&&(n=null),l({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?d(t):t,{state:n,key:t&&t.key||o||Math.random().toString(36).substr(2,8)})}function u(e){let{pathname:t="/",search:n="",hash:o=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),o&&"#"!==o&&(t+="#"===o.charAt(0)?o:"#"+o),t}function d(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let o=e.indexOf("?");o>=0&&(t.search=e.substr(o),e=e.substr(0,o)),e&&(t.pathname=e)}return t}var m;function p(e,t,n,o){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(o)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(m||(m={})),new Set(["lazy","caseSensitive","path","id","index","children"]);const g=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",h=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;const \_=["post","put","patch","delete"],v=(new Set(\_),["get",...\_]);new Set(v),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement,Symbol("deferred");const E="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},{useState:f,useEffect:b,useLayoutEffect:y,useDebugValue:w}=r;function C(e){const t=e.getSnapshot,n=e.value;try{const e=t();return!E(n,e)}catch(e){return!0}}"undefined"==typeof window||void 0===window.document||window.document.createElement;"useSyncExternalStore"in r&&r.useSyncExternalStore;const S=r.createContext(null),k=r.createContext(null),x=r.createContext(null),N=r.createContext({outlet:null,matches:[]});function ~~R(){return null!=r.useContext(x)}function P(){return R()||c(!1),r.useContext(x).location}function T(){R()||c(!1);let{basename:e,navigator:t}=r.useContext(k),{matches:n}=r.useContext(N),{pathname:o}=P(),a=JSON.stringify(function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(n).map((e=>e.pathnameBase))),s=r.useRef(!1);r.useEffect((()=>{s.current=!0}));let i=r.useCallback((function(n,r){if(void 0===r&&(r={}),!s.current)return;if("number"==typeof n)return void t.go(n);let i=function(e,t,n,o){let r;void 0===o&&(o=!1),"string"==typeof e?r=d(e):(r=l({},e),c(!r.pathname||!r.pathname.includes("?"),p("?","pathname","search",r)),c(!r.pathname||!r.pathname.includes("#"),p("#","pathname","hash",r)),c(!r.search||!r.search.includes("#"),p("#","search","hash",r)));let a,s=""===e||""===r.pathname,i=s?"/":r.pathname;if(o||null==i)a=n;else{let e=t.length-1;if(i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}a=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:o="",hash:r=""}="string"==typeof e?d(e):e,l=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:l,search:g(o),hash:h(r)}}(r,a),m=i&&"/"!==i&&i.endsWith("/"),\_=(s||"."===i)&&n.endsWith("/");return u.pathname.endsWith("/")||!m&&!\_||(u.pathname+="/"),u}(n,JSON.parse(a),o,"path"===r.relative);"/"!==e&&(i.pathname="/"===i.pathname?e:[e,i.pathname].join("/").replace(/\/\/+/g,"/")),(r.replace?t.replace:t.push)(i,r.state,r)}),[e,t,a,o]);return i}var L,M,B,D,F;function O(t){let{basename:n="/",children:o=null,location:l,navigationType:a=e.Pop,navigator:s,static:i=!1}=t;R()&&c(!1);let u=n.replace(/^\/\*/,"/"),m=r.useMemo((()=>({basename:u,navigator:s,static:i})),[u,s,i]);"string"==typeof l&&(l=d(l));let{pathname:p="/",search:g="",hash:h="",state:\_=null,key:v="default"}=l,E=r.useMemo((()=>{let e=function(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,o=e.charAt(n);return o&&"/"!==o?null:e.slice(n)||"/"}(p,u);return null==e?null:{location:{pathname:e,search:g,hash:h,state:\_,key:v},navigationType:a}}),[u,p,g,h,\_,v,a]);return null==E?null:r.createElement(k.Provider,{value:m},r.createElement(x.Provider,{children:o,value:E}))}function A(t){let{basename:n,children:o,window:d}=t,m=r.useRef();null==m.current&&(m.current=function(t){return void 0===t&&(t={}),function(t,n,o,r){void 0===r&&(r={});let{window:d=document.defaultView,v5Compat:m=!1}=r,p=d.history,g=e.Pop,h=null,\_=v();function v(){return(p.state||{idx:null}).idx}function E(){g=e.Pop;let t=v(),n=null==t?null:t-\_;\_=t,h&&h({action:g,location:b.location,delta:n})}function f(e){let t="null"!==d.location.origin?d.location.origin:d.location.href,n="string"==typeof e?e:u(e);return c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==\_&&(\_=0,p.replaceState(l({},p.state,{idx:\_}),""));let b={get action(){return g},get location(){return t(d,p)},listen(e){if(h)throw new Error("A history only accepts one active listener");return d.addEventListener(a,E),h=e,()=>{d.removeEventListener(a,E),h=null}},createHref(e){return n(d,e)},createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){g=e.Push;let r=i(b.location,t,n);o&&o(r,t),\_=v()+1;let l=s(r,\_),a=b.createHref(r);try{p.pushState(l,"",a)}catch(e){d.location.assign(a)}m&&h&&h({action:g,location:b.location,delta:1})},replace:function(t,n){g=e.Replace;let r=i(b.location,t,n);o&&o(r,t),\_=v();let l=s(r,\_),a=b.createHref(r);p.replaceState(l,"",a),m&&h&&h({action:g,location:b.location,delta:0})},go(e){return p.go(e)}};return b}((function(e,t){let{pathname:n,search:o,hash:r}=e.location;return i("",{pathname:n,search:o,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"==typeof t?t:u(t)}),null,t)}({window:d,v5Compat:!0}));let p=m.current,[g,h]=r.useState({action:p.action,location:p.location});return r.useLayoutEffect((()=>p.listen(h)),[p]),r.createElement(O,{basename:n,children:o,location:g.location,navigationType:g.action,navigator:p})}function U(e,t,n=!0){return{...e,default:t,decode:(...o)=>{const r=e.decode(...o);return void 0===r||n&&null===r?t:r}}}function V(e,t){if(null==e)return e;if(0===e.length&&(!t||t&&""!==e))return null;const n=e instanceof Array?e[0]:e;return null==n||t||""!==n?n:null}r.Component,function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"}(L||(L={})),function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(M||(M={})),function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(B||(B={})),new Promise((()=>{})),r.Component,"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement,function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"}(D||(D={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(F||(F={}));const z={encode:function(e){return null==e?e:String(e)},decode:function(e){const t=V(e,!0);return null==t?t:String(t)}},I={encode:function(e){return null==e?e:String(e)},decode:function(e){const t=V(e);return null==t?t:""===t?null:+t}},j={encode:function(e){return null==e?e:e?"1":"0"},decode:function(e){const t=V(e);return null==t?t:"1"===t||"0"!==t&&null}};'{}[],":'.split("").map((e=>[e,encodeURIComponent(e)]));const H=new class{constructor(){this.paramsMap=new Map,this.registeredParams=new Map}set(e,t,n,o){this.paramsMap.set(e,{stringified:t,decoded:n,decode:o})}has(e,t,n){if(!this.paramsMap.has(e))return!1;const o=this.paramsMap.get(e);return!!o&&o.stringified===t&&(null==n||o.decode===n)}get(e){var t;if(this.paramsMap.has(e))return null==(t=this.paramsMap.get(e))?void 0:t.decoded}registerParams(e){for(const t of e){const e=this.registeredParams.get(t)||0;this.registeredParams.set(t,e+1)}}unregisterParams(e){for(const t of e){const e=(this.registeredParams.get(t)||0)-1;e<=0?(this.registeredParams.delete(t),this.paramsMap.has(t)&&this.paramsMap.delete(t)):this.registeredParams.set(t,e)}}clear(){this.paramsMap.clear(),this.registeredParams.clear()}};function $(e,t,n,o){var r;if(!n||!t.length)return e;let l={...e},a=!1;for(const e of t)Object.prototype.hasOwnProperty.call(l,e)||(l[e]=null!=(r=n[e])?r:o,a=!0);return a?l:e}const G=Object.prototype.hasOwnProperty;function W(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function q(e,t,n){var o,r;if(W(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const l=Object.keys(e),a=Object.keys(t);if(l.length!==a.length)return!1;for(let a=0;a<l.length;a++){const c=null!=(r=null==(o=null==n?void 0:n[l[a]])?void 0:o.equals)?r:W;if(!G.call(t,l[a])||!c(e[l[a]],t[l[a]]))return!1}return!0}function Q(e,t,n){const o={},r=Object.keys(t);for(const l of r){const r=t[l],a=e[l];let c;if(n.has(l,a,r.decode))c=n.get(l);else{if(c=r.decode(a),r.equals&&n.has(l,a)){const e=n.get(l);r.equals(c,e)&&(c=e)}void 0!==c&&n.set(l,a,c,r.decode)}void 0===c&&void 0!==r.default&&(c=r.default),o[l]=c}return o}function Y(){let e;return function(t,n,o){const r=Q(t,n,o);return null!=e&&q(e,r)?e:(e=r,r)}}let K,J,Z,X={};const ee=(e,t,n)=>{if(K===t&&Z===e&&J===n)return X;K=t,Z=e;const o=e(null!=t?t:"");J=n;const r=function(e){if(e)return Object.fromEntries(e.split("\n").map((e=>e.split("\0"))))}(n);for(let[e,t]of Object.entries(o)){(null==r?void 0:r[e])&&(delete o[e],e=r[e],o[e]=t);const n=X[e];q(t,n)&&(o[e]=n)}return X=o,o};function te(e,t){null==t&&(t={});const n={...e,...t};return t.params&&e.params&&(n.params={...e.params,...t.params}),n}const ne={adapter:{},options:{searchStringToObject:function(e){const t=new URLSearchParams(e),n={};for(let[e,o]of t)Object.prototype.hasOwnProperty.call(n,e)?Array.isArray(n[e])?n[e].push(o):n[e]=[n[e],o]:n[e]=o;return n},objectToSearchString:function(e){const t=new URLSearchParams,n=Object.entries(e);for(const[e,o]of n)if(null!=o)if(Array.isArray(o))for(const n of o)t.append(e,null!=n?n:"");else t.append(e,o);return t.toString()},updateType:"pushIn",includeKnownParams:void 0,includeAllParams:!1,removeDefaultsFromUrl:!1,enableBatching:!1,skipUpdateWhenNoChange:!0}},oe=r.createContext(ne);function re({children:e,adapter:t,options:n}){const{adapter:o,options:l}=r.useContext(oe),a=r.useMemo((()=>({adapter:null!=t?t:o,options:te(l,n)})),[t,n,o,l]);return r.createElement(oe.Provider,{value:a},e)}function le({children:e,adapter:t,options:n}){const o=t;return o?r.createElement(o,null,(t=>r.createElement(re,{adapter:t,options:n},e))):r.createElement(re,{options:n},e)}function ae({changes:e,updateType:t,currentSearchString:n,paramConfigMap:o,options:r}){const{searchStringToObject:l,objectToSearchString:a}=r;let c;null==t&&(t=r.updateType);const s=ee(l,n),i=$(o,Object.keys(e),r.params);let u,d;return u="function"==typeof e?e(Q(s,i,H)):e,c=function(e,t){const n={},o=Object.keys(t);for(const r of o){const o=t[r];e[r]?n[r]=e[r].encode(t[r]):n[r]=null==o?o:String(o)}return n}(i,u),r.removeDefaultsFromUrl&&function(e,t){var n;for(const o in e)void 0!==(null==(n=t[o])?void 0:n.default)&&void 0!==e[o]&&t[o].encode(t[o].default)===e[o]&&(e[o]=void 0)}(c,i),c=function(e,t){var n;let o={};for(const r in e)null!=(null==(n=t[r])?void 0:n.urlName)?o[t[r].urlName]=e[r]:o[r]=e[r];return o}(c,i),d=a("push"===t||"replace"===t?c:{...s,...c}),(null==d?void 0:d.length)&&"?"!==d[0]&&(d=`?${d}`),null!=d?d:""}const ce=e=>e(),se=e=>setTimeout((()=>e()),0),ie=[];function ue(e,t){const{adapter:n,options:o}=function(){const e=r.useContext(oe);if(void 0===e||e===ne)throw new Error("useQueryParams must be used within a QueryParamProvider");return e}(),[l]=(0,r.useState)(Y),{paramConfigMap:a,options:c}=function(e,t){let n,o;return void 0===e?(n={},o=t):Array.isArray(e)?(n=Object.fromEntries(e.map((e=>[e,"inherit"]))),o=t):(n=e,o=t),{paramConfigMap:n,options:o}}(e,t),s=(0,r.useMemo)((()=>te(o,c)),[o,c]);let i=function(e,t){var n,o,r;const l={};let a=!1;const c=Object.keys(e);let s=c;if(t.includeKnownParams||!1!==t.includeKnownParams&&0===c.length){const e=Object.keys(null!=(n=t.params)?n:{});s.push(...e)}for(const n of s){const c=e[n];null==c||"object"!=typeof c?(a=!0,l[n]=null!=(r=null==(o=t.params)?void 0:o[n])?r:z):l[n]=c}return a?l:e}(a,s);const u=ee(s.searchStringToObject,n.location.search,function(e){let t;for(const n in e)if(e[n].urlName){const o=`${e[n].urlName}\0${n}`;t?t.push(o):t=[o]}return t?t.join("\n"):void 0}(i));s.includeAllParams&&(i=$(i,Object.keys(u),s.params,z));const d=l(u,i,H),m=Object.keys(i).join("\0");(0,r.useEffect)((()=>{const e=m.split("\0");return H.registerParams(e),()=>{H.unregisterParams(e)}}),[m]);const p={adapter:n,paramConfigMap:i,options:s},g=(0,r.useRef)(p);null==g.current&&(g.current=p),(0,r.useEffect)((()=>{g.current.adapter=n,g.current.paramConfigMap=i,g.current.options=s}),[n,i,s]);const[h]=(0,r.useState)((()=>(e,t)=>{const{adapter:n,paramConfigMap:o,options:r}=g.current;null==t&&(t=r.updateType),function(e,{immediate:t}={}){ie.push(e);let n=t?ce:se;1===ie.length&&n((()=>{const t=ie.slice();ie.length=0;const n=t[0].currentSearchString;let o;for(let e=0;e<t.length;++e)o=ae(0===e?t[e]:{...t[e],currentSearchString:o});e.options.skipUpdateWhenNoChange&&o===n||function({searchString:e,adapter:t,navigate:n,updateType:o}){const r={...t.location,search:e};n&&("string"==typeof o&&o.startsWith("replace")?t.replace(r):t.push(r))}({searchString:null!=o?o:"",adapter:t[t.length-1].adapter,navigate:!0,updateType:t[t.length-1].updateType})}))}({changes:e,updateType:t,currentSearchString:n.location.search,paramConfigMap:o,options:r,adapter:n},{immediate:!r.enableBatching})}));return[d,h]}var de=ue;const me=(e,t,n)=>{const o=(0,r.useMemo)((()=>({[e]:null!=t?t:"inherit"})),[e,t]),[l,a]=de(o,n);return[l[e],(0,r.useCallback)(((t,n)=>a("function"==typeof t?n=>{const o=t(n[e]);return{[e]:o}}:{[e]:t},n)),[e,a])]},pe=({children:e})=>{var t;const{navigator:n}=(0,r.useContext)(k),o=T(),l=null==(t=(0,r.useContext)(S))?void 0:t.router,a=P();return e({replace(e){o(e.search||"?",{replace:!0,state:e.state})},push(e){o(e.search||"?",{replace:!1,state:e.state})},get location(){var e,t,o;return null!=(o=null!=(t=null==(e=null==l?void 0:l.state)?void 0:e.location)?t:null==n?void 0:n.location)?o:a}})};var ge=window.contentControl.data,he=window.wp.data,\_e=window.wp.element,ve=n(184),Ee=n.n(ve),fe=window.wp.i18n,be=window.wp.hooks,ye=window.contentControl.icons,we=window.wp.components,Ce=window.contentControl.coreData,Se=window.contentControl.components,ke=window.wp.primitives,xe=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{fillRule:"evenodd",d:"M17.375 15.656A6.47 6.47 0 0018.5 12a6.47 6.47 0 00-.943-3.374l-1.262.813c.448.749.705 1.625.705 2.561a4.977 4.977 0 01-.887 2.844l1.262.813zm-1.951 1.87l-.813-1.261A4.976 4.976 0 0112 17c-.958 0-1.852-.27-2.613-.736l-.812 1.261A6.47 6.47 0 0012 18.5a6.47 6.47 0 003.424-.974zm-8.8-1.87A6.47 6.47 0 015.5 12c0-1.235.344-2.39.943-3.373l1.261.812A4.977 4.977 0 007 12c0 1.056.328 2.036.887 2.843l-1.262.813zm2.581-7.803A4.977 4.977 0 0112 7c1.035 0 1.996.314 2.794.853l.812-1.262A6.47 6.47 0 0012 5.5a6.47 6.47 0 00-3.607 1.092l.812 1.261zM12 20a8 8 0 100-16 8 8 0 000 16zm0-4.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z",clipRule:"evenodd"})),Ne=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M7 13.8h6v-1.5H7v1.5zM18 16V4c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2zM5.5 16V4c0-.3.2-.5.5-.5h10c.3 0 .5.2.5.5v12c0 .3-.2.5-.5.5H6c-.3 0-.5-.2-.5-.5zM7 10.5h8V9H7v1.5zm0-3.3h8V5.8H7v1.4zM20.2 6v13c0 .7-.6 1.2-1.2 1.2H8v1.5h11c1.5 0 2.7-1.2 2.7-2.8V6h-1.5z"})),Re=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})),Pe=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M11 14.5l1.1 1.1 3-3 .5-.5-.6-.6-3-3-1 1 1.7 1.7H5v1.5h7.7L11 14.5zM16.8 5h-7c-1.1 0-2 .9-2 2v1.5h1.5V7c0-.3.2-.5.5-.5h7c.3 0 .5.2.5.5v10c0 .3-.2.5-.5.5h-7c-.3 0-.5-.2-.5-.5v-1.5H7.8V17c0 1.1.9 2 2 2h7c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2z"}));const{pluginUrl:Te,adminUrl:Le,wpVersion:Me}=contentControlSettingsPage,Be={showNotice:!1,ignoreNotice:!1,retryView:""};var De=({tabs:e})=>{const[t="restrictions",n]=me("view",z),o=(0,\_e.useRef)(null),[l,a]=(0,\_e.useState)(Be),{showNotice:c,ignoreNotice:s,retryView:i}=l,u=()=>a(Be),d=(0,he.useSelect)((e=>e(Ce.settingsStore).hasUnsavedChanges()),[]),{saveSettings:m}=(0,he.useDispatch)(Ce.settingsStore);return(0,\_e.useEffect)((()=>{const e=e=>{d&&(e.preventDefault(),e.returnValue=!1)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[d]),(0,\_e.useEffect)((()=>(d||u(),d&&!s||!i||n(i),()=>u())),[d,s]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"cc-settings-page\_\_header"},(0,r.createElement)("h1",{className:"branding wp-heading-inline"},(0,r.createElement)("a",{href:"https://contentcontrolplugin.com?utm\_campaign=plugin-info&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=header-logo",target:"\_blank"},(0,r.createElement)("img",{src:`${Te}assets/images/logo.svg`}),(0,fe.\_\_)("Content Control","content-control"))),(0,r.createElement)(Se.ControlledTabPanel,{className:"tabs",orientation:"horizontal",selected:null!==t?t:void 0,onSelect:o=>{const r=e.find((e=>e.name===o));var c;r?.onClick&&!1===r.onClick()||(c=o,"settings"!==t||!d||s?n(c):a({...l,showNotice:!0,retryView:c}))},tabs:e}),(0,r.createElement)(we.DropdownMenu,{label:(0,fe.\_\_)("Support","content-control"),icon:xe,toggleProps:Me>=6.2?{as:({onClick:e})=>(0,r.createElement)(we.Button,{icon:xe,variant:"link",onClick:e,className:"components-tab-panel\_\_tabs-item support-link"},(0,r.createElement)("span",{ref:o},(0,fe.\_\_)("Support","content-control")))}:void 0,popoverProps:{noArrow:!1,position:"bottom left",className:"cc-settings-page\_\_support-menu",anchor:Me>=6.2?{getBoundingClientRect:()=>o?.current?.getBoundingClientRect()}:void 0}},(({onClose:e})=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.MenuGroup,null,(0,r.createElement)(we.MenuItem,{icon:Ne,href:"https://contentcontrolplugin.com/docs/?utm\_campaign=plugin-support&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=view-documentation-link",target:"\_blank"},(0,fe.\_\_)("View Documentation","content-control")),(0,r.createElement)(we.MenuItem,{icon:Re,href:"https://contentcontrolplugin.com/support/?utm\_campaign=plugin-support&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=get-support-link",target:"\_blank"},(0,fe.\_\_)("Get Support","content-control"))),(0,r.createElement)(we.MenuGroup,null,(0,r.createElement)(we.MenuItem,{icon:Pe,onClick:()=>{window.location.href=`${Le}options-general.php?page=grant-content-control-access`,e()}},(0,fe.\_\_)("Grant Support Access","content-control"))))))),c&&(0,r.createElement)(we.Modal,{title:(0,fe.\_\_)("Unsaved changes","content-control"),onRequestClose:()=>u()},(0,r.createElement)("p",null,(0,fe.\_\_)("Changes you made may not be saved.","content-control")),(0,r.createElement)(we.Flex,{justify:"right"},(0,r.createElement)(we.Button,{isDestructive:!0,onClick:()=>a({...l,showNotice:!1,ignoreNotice:!0}),text:(0,fe.\_\_)("Ignore","content-control")}),(0,r.createElement)(we.Button,{variant:"primary",onClick:()=>m(),text:(0,fe.\_\_)("Save Settings","content-control")}))))},Fe=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M10 17.389H8.444A5.194 5.194 0 1 1 8.444 7H10v1.5H8.444a3.694 3.694 0 0 0 0 7.389H10v1.5ZM14 7h1.556a5.194 5.194 0 0 1 0 10.39H14v-1.5h1.556a3.694 3.694 0 0 0 0-7.39H14V7Zm-4.5 6h5v-1.5h-5V13Z"})),Oe=window.contentControl.ruleEngine,Ae=n.n(Oe),Ue=()=>{const{isEditorActive:e,editorId:t}=(0,he.useSelect)((e=>{const t=e(Ce.restrictionsStore);return{editorId:t.getEditorId(),isEditorActive:t.isEditorActive()}}),[]),{changeEditorId:n}=(0,he.useDispatch)(Ce.restrictionsStore),[o,r]=ue({edit:I,add:j,tab:z}),l=()=>r({add:void 0,edit:void 0,tab:void 0}),{edit:a,add:c,tab:s}=o;return(0,\_e.useEffect)((()=>{let e=a&&a>0?a:void 0;c&&(e="new"),e!==t&&n(e)}),[a,c,t,n]),(0,\_e.useEffect)((()=>{c||a||e||l()}),[e,c,a]),{tab:s,setTab:e=>r({tab:e}),setEditorId:e=>{r({add:"new"===e||void 0,edit:"number"==typeof e&&e>0?e:void 0}),n(e)},clearEditorParams:l}},Ve=({values:e,updateSettings:t})=>(0,r.createElement)("div",{className:"content-tab"},(0,r.createElement)("h3",null,(0,fe.\_\_)("Apply this restriction if the user views content that is:","content-control")),(0,r.createElement)("p",null,(0,fe.\_\_)("When users visit your site, the plugin will check the viewed content against your selection below and permit or deny access.","content-control")),(0,r.createElement)(Ae(),{value:e.settings.conditions,onChange:e=>t({conditions:e}),options:{features:{notOperand:!0,groups:!0},rulesFilter:e=>(Array.isArray(e.context)?e.context:e.context.split(" ")).indexOf("content")>=0}})),ze=window.contentControl.utils,Ie=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M13 5c-3.3 0-6 2.7-6 6 0 1.4.5 2.7 1.3 3.7l-3.8 3.8 1.1 1.1 3.8-3.8c1 .8 2.3 1.3 3.7 1.3 3.3 0 6-2.7 6-6S16.3 5 13 5zm0 10.5c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z"})),je=window.wp.compose,He=()=>{const{updateEditorValues:e}=(0,he.useDispatch)(Ce.restrictionsStore),{values:t={}}=(0,he.useSelect)((e=>({values:e(Ce.restrictionsStore).getEditorValues(),isEditorActive:e(Ce.restrictionsStore).isEditorActive()})),[]),{settings:n}=t,o=(0,\_e.useCallback)((n=>{e({...t,settings:{...t?.settings,...n}})}),[e,t]),r=(e,t)=>{const o=(0,be.applyFilters)("contentControl.restrictionEditor.fieldIsVisible",void 0,e,n,t);return void 0===o||o},l=(0,\_e.useMemo)((()=>(0,be.applyFilters)("contentControl.restrictionEditor.tabFields",{},n,o)),[n,o]);return{values:t,fieldIsVisible:r,getTabFields:e=>{var t;return(0,be.applyFilters)(`contentControl.restrictionEditor.tabFields.${e}`,null!==(t=l[e])&&void 0!==t?t:[]).sort(((e,t)=>e.priority-t.priority)).filter((t=>r(t.id,e))).map((t=>{const n=(0,be.applyFilters)("contentControl.restrictionEditor.renderField",t.component,t.id,e);return{...t,component:n}}))},updateSettings:o,updateField:(e,t)=>{o({[e]:t})}}},$e=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M12 4L4 7.9V20h16V7.9L12 4zm6.5 14.5H14V13h-4v5.5H5.5V8.8L12 5.7l6.5 3.1v9.7z"}));const Ge=[{value:"redirect",label:(0,fe.\_\_)("Redirect","content-control"),icon:ye.protectedRedirect},{value:"replace",label:(0,fe.\_\_)("Replace Content","content-control"),icon:ye.protectedMessage}],We=[{value:"login",label:(0,fe.\_\_)("Login & Back","content-control"),icon:Pe},{value:"home",label:(0,fe.\_\_)("Home Page","content-control"),icon:$e},{value:"custom",label:(0,fe.\_\_)("Custom URL","content-control"),icon:Fe}],qe=[{value:"message",label:(0,fe.\_\_)("Custom Message","content-control")},{value:"page",label:(0,fe.\_\_)("Use Existing Page","content-control")}],Qe=[{label:(0,fe.\_\_)("Filter the restricted items' title, excerpt, and content.","content-control"),value:"filter\_post\_content"},{label:(0,fe.\_\_)("Hide the restricted items from the archive page.","content-control"),value:"hide"},{label:(0,fe.\_\_)("Replace the entire archive page with a custom page.","content-control"),value:"replace\_archive\_page"},{label:(0,fe.\_\_)("Redirect to a different page.","content-control"),value:"redirect"}],Ye=[{label:(0,fe.\_\_)("Filter the restricted items' title, excerpt, and content.","content-control"),value:"filter\_post\_content"},{label:(0,fe.\_\_)("Hide the restricted items from the list page.","content-control"),value:"hide"}],{userRoles:Ke}=contentControlSettingsPage,Je=({settings:e,updateSettings:t})=>{var n;const o=(0,je.useInstanceId)(Je);let l=[];return Array.isArray(e.userRoles)?l=e.userRoles:"object"==typeof e.userRoles&&(l=Object.entries(e.userRoles).map((([e])=>e))),(0,r.createElement)(Se.FieldPanel,{title:(0,fe.\_\_)("User Status","content-control")},(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("Who can see this content?","content-control"),value:e.userStatus,onChange:e=>t({userStatus:e}),options:(0,be.applyFilters)("contentControl.restrictionEditor.userStatusOptions",[{value:"logged\_in",label:(0,fe.\_\_)("Logged In Users","content-control"),icon:ye.lockedUser},{value:"logged\_out",label:(0,fe.\_\_)("Logged Out Users","content-control"),icon:ye.incognito}]),className:"userStatus-field"}),"logged\_in"===e.userStatus&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("br",null),(0,r.createElement)("hr",null),(0,r.createElement)(Se.FieldRow,{id:`content-control-role-match-${o}`,label:(0,fe.\_\_)("User Role","content-control"),description:(0,fe.\_\_)("Which user roles should be allowed to see this content.","content-control"),className:"components-base-control\_\_label"},(0,r.createElement)(we.SelectControl,{id:`content-control-role-match-${o}`,label:(0,fe.\_\_)("User Role","content-control"),value:null!==(n=e.roleMatch)&&void 0!==n?n:"any",options:[{label:(0,fe.\_\_)("Any","content-control"),value:"any"},{label:(0,fe.\_\_)("Matching","content-control"),value:"match"},{label:(0,fe.\_\_)("Excluding","content-control"),value:"exclude"}],onChange:e=>t({roleMatch:e}),className:"is-large roleMatch-field",hideLabelFromVision:!0,\_\_next40pxDefaultSize:!0,\_\_nextHasNoMarginBottom:!0})),"any"!==e.roleMatch&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("hr",null),(0,r.createElement)("br",null),(0,r.createElement)(Se.SearchableMulticheckControl,{label:"exclude"===e.roleMatch?(0,fe.\_\_)("Roles to exclude","content-control"):(0,fe.\_\_)("Roles to include","content-control"),searchIcon:Ie,placeholder:(0,fe.\_\_)("Search roles…","content-control"),className:"is-large userRoles-field",value:l,onChange:e=>t({userRoles:e}),options:Object.entries(Ke).map((([e,t])=>({value:e,label:t})))}))))};(0,be.addFilter)("contentControl.restrictionEditor.tabFields","content-control",((e,t,n)=>{const o={settings:t,updateSettings:n};return{...e,general:[{id:"userStatus",priority:3,component:(0,r.createElement)(Je,{...o})}]}}));var Ze=({values:e,updateValues:t})=>{const{getTabFields:n}=He(),o=e.description.length/80,l=(0,ze.clamp)(o,1,5);return(0,r.createElement)("div",{className:"general-tab"},(0,r.createElement)(we.TextControl,{label:(0,fe.\_\_)("Restriction label","content-control"),hideLabelFromVision:!0,placeholder:(0,fe.\_\_)("Name…","content-control"),className:"title-field",value:e.title,onChange:e=>t({title:e})}),(0,r.createElement)(we.TextareaControl,{rows:l,scrolling:l>5?"auto":"no",label:(0,fe.\_\_)("Restriction description","content-control"),hideLabelFromVision:!0,placeholder:(0,fe.\_\_)("Add description…","content-control"),className:"description-field",value:e.description,onChange:e=>t({description:e})}),e.title.length<=0&&(0,r.createElement)(we.Notice,{status:"warning",isDismissible:!1,className:"title-field-notice"},(0,fe.\_\_)("Enter a label for this set.","content-control")),n("general").map((e=>(0,r.createElement)("div",{key:e.id},e.component))))};(0,be.addFilter)("contentControl.restrictionEditor.tabFields","content-control",((e,t,n)=>{var o;const l=t.customMessage?.length/80,a=(0,ze.clamp)(l,4,20);return{...e,protection:[{id:"protectionMethod",priority:1,component:(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("How do you want to protect your content?","content-control"),value:t.protectionMethod,onChange:e=>n({protectionMethod:e}),options:(0,be.applyFilters)("contentControl.restrictionEditor.protectionMethodOptions",Ge)})},{id:"redirectType",priority:2,component:(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("Where will the user be taken?","content-control"),value:t.redirectType,onChange:e=>n({redirectType:e}),options:We})},{id:"redirectUrl",priority:3,component:(0,r.createElement)(Se.URLControl,{label:(0,fe.\_\_)("Custom Redirect URL","content-control"),className:"is-large",value:t.redirectUrl,onChange:({url:e})=>{n({redirectUrl:e})}})},{id:"replacementType",priority:4,component:(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("Replacement Type","content-control"),value:t.replacementType,options:qe,onChange:e=>n({replacementType:e})})},{id:"replacementPage",priority:5,component:(0,r.createElement)(Se.EntitySelectControl,{label:(0,fe.\_\_)("Choose a page to replace the content with.","content-control"),placeholder:(0,fe.\_\_)("Choose a page to replace the content with.","content-control"),value:t.replacementPage,multiple:!1,onChange:e=>n({replacementPage:e}),entityKind:"postType",entityType:"page",closeOnSelect:!0})},{id:"showExcerpts",priority:6,component:(0,r.createElement)(we.CheckboxControl,{label:(0,fe.\_\_)("Show excerpts above access denied message?","content-control"),checked:t.showExcerpts,onChange:e=>n({showExcerpts:e})})},{id:"overrideMessage",priority:7,component:(0,r.createElement)(we.CheckboxControl,{label:(0,fe.\_\_)("Override the default message?","content-control"),checked:t.overrideMessage,onChange:e=>n({overrideMessage:e}),help:(0,fe.\_\_)("Edit the default message via the plugin's Settings page.","content-control")})},{id:"customMessage",priority:8,component:(0,r.createElement)(we.TextareaControl,{label:(0,fe.\_\_)("Enter a custom message to display to restricted users","content-control"),rows:a,value:t.customMessage,onChange:e=>n({customMessage:e})})},{id:"archiveHandling",priority:9,component:(0,r.createElement)(we.RadioControl,{label:(0,fe.\_\_)("Handling matches within archives","content-control"),help:(0,fe.\_\_)("Choose how to handle matched content found within archive pages. This option applies to restricted content within the archive page, not the archive page itself.","content-control"),selected:t.archiveHandling,options:Qe,onChange:e=>n({archiveHandling:e})})},{id:"archiveReplacementPage",priority:10,component:(0,r.createElement)(Se.EntitySelectControl,{label:(0,fe.\_\_)("Choose a page to replace the archive with","content-control"),placeholder:(0,fe.\_\_)("Choose a page to replace the archive with","content-control"),value:t.archiveReplacementPage,multiple:!1,onChange:e=>n({archiveReplacementPage:e}),entityKind:"postType",entityType:"page",closeOnSelect:!0})},{id:"archiveRedirectType",priority:11,component:(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("Where will the user be taken?","content-control"),value:t.archiveRedirectType,onChange:e=>n({archiveRedirectType:e}),options:We})},{id:"archiveRedirectUrl",priority:12,component:(0,r.createElement)(Se.URLControl,{label:(0,fe.\_\_)("Custom Redirect URL","content-control"),className:"is-large",value:t.archiveRedirectUrl,onChange:({url:e})=>{n({archiveRedirectUrl:e})}})},{id:"additionalQueryHandling",priority:13,component:(0,r.createElement)(we.RadioControl,{label:(0,fe.\_\_)("Handling matches everywhere else","content-control"),help:(0,fe.\_\_)("Choose how to handle matched content in all other areas outside the main content. This option applies to restricted content found in non-main queries, sidebars, widgets, footers, or within the page content itself.","content-control"),selected:t.additionalQueryHandling,options:Ye,onChange:e=>n({additionalQueryHandling:e})})},...null!==(o=e.protection)&&void 0!==o?o:[]]}})),(0,be.addFilter)("contentControl.restrictionEditor.fieldIsVisible","content-control",((e,t,n)=>{switch(t){case"redirectType":return"redirect"===n.protectionMethod;case"redirectUrl":return"redirect"===n.protectionMethod&&"custom"===n.redirectType;case"replacementType":return"replace"===n.protectionMethod;case"replacementPage":return"replace"===n.protectionMethod&&"page"===n.replacementType;case"showExcerpts":case"overrideMessage":return"replace"===n.protectionMethod&&"message"===n.replacementType;case"customMessage":return"replace"===n.protectionMethod&&"message"===n.replacementType&&n.overrideMessage;case"archiveReplacementPage":return"replace\_archive\_page"===n.archiveHandling;case"archiveRedirectType":return"redirect"===n.archiveHandling;case"archiveRedirectUrl":return"redirect"===n.archiveHandling&&"custom"===n.archiveRedirectType;default:return e}}));var Xe=e=>{const{getTabFields:t}=He();return(0,r.createElement)("div",{className:"protection-tab"},(0,r.createElement)("h3",null,(0,fe.\_\_)("Protecting Content","content-control")),(0,r.createElement)("p",null,(0,fe.\_\_)("When a user does not have access, the following options help control their experience.","content-control")),t("protection").map((e=>(0,r.createElement)("div",{key:e.id},e.component))))};const et=()=>{};var tt=({onSave:e=et,onClose:t=et})=>{const{tab:n,setTab:o,clearEditorParams:l}=Ue(),[a,c]=(0,\_e.useState)(!1),[s,i]=(0,\_e.useState)(null),{editorId:u,isEditorActive:d,values:m,isSaving:p,dispatchStatus:g,dispatchErrors:h}=(0,he.useSelect)((e=>({editorId:e(Ce.restrictionsStore).getEditorId(),values:e(Ce.restrictionsStore).getEditorValues(),isEditorActive:e(Ce.restrictionsStore).isEditorActive(),isSaving:e(Ce.restrictionsStore).isDispatching(["createRestriction","updateRestriction"]),dispatchStatus:{create:e(Ce.restrictionsStore).getDispatchStatus("createRestriction"),update:e(Ce.restrictionsStore).getDispatchStatus("updateRestriction")},dispatchErrors:{create:e(Ce.restrictionsStore).getDispatchError("createRestriction"),update:e(Ce.restrictionsStore).getDispatchError("updateRestriction")}})),[]),{updateEditorValues:\_,createRestriction:v,updateRestriction:E,clearEditorData:f}=(0,he.useDispatch)(Ce.restrictionsStore);if((0,\_e.useEffect)((()=>l),[]),(0,\_e.useEffect)((()=>{var e;if(!a)return;if(Ce.Status.Success===g.create||Ce.Status.Success===g.update)return void b();const t=null!==(e=h.create)&&void 0!==e?e:h.update;void 0!==t&&i(t)}),[g,h]),!d)return null;if(!u)return(0,r.createElement)(r.Fragment,null,(0,fe.\_\_)("Editor requires a valid id","content-control"));if(!m)return(0,r.createElement)(r.Fragment,null,(0,fe.\_\_)("Editor requires a valid restriction.","content-control"));const b=()=>{f(),t()},y={values:m,updateValues:\_,updateSettings:e=>{\_({...m,settings:{...m?.settings,...e}})},onSave:e,onClose:t},w=(0,be.applyFilters)("contentControl.restrictionEditor.tabs",[{name:"general",title:(0,fe.\_\_)("General","content-control"),comp:()=>(0,r.createElement)(Ze,{...y})},{name:"protection",title:(0,fe.\_\_)("Protection","content-control"),comp:()=>(0,r.createElement)(Xe,{...y})},{name:"content",title:(0,fe.\_\_)("Content","content-control"),comp:()=>(0,r.createElement)(V~~e,{...y})}]);if("object"==typeof s&&s?.tabName?.length){const e=w.find((e=>e.name===s.tabName));e&&(w[w.indexOf(e)].className=w[w.indexOf(e)].className?w[w.indexOf(e)].className+" error":"error")}const C=(0,fe.sprintf)( |
  |  | 1 | !function(){var e={184:function(e,t){var n;!function(){"use strict";var o={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var l=typeof n;if("string"===l||"number"===l)e.push(n);else if(Array.isArray(n)){if(n.length){var a=r.apply(null,n);a&&e.push(a)}}else if("object"===l){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var c in n)o.call(n,c)&&n[c]&&e.push(c)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,n),l.exports}n.n=function(e){var t=e&&e.\_\_esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"\_\_esModule",{value:!0})};var o={};!function(){"use strict";n.r(o),n.d(o,{init:function(){return mn}});var e,t,r=window.React;function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l.apply(this,arguments)}(t=e||(e={})).Pop="POP",t.Push="PUSH",t.Replace="REPLACE";const a="popstate";function c(e,t){if(!1===e||null==e)throw new Error(t)}function s(e,t){return{usr:e.state,key:e.key,idx:t}}function i(e,t,n,o){return void 0===n&&(n=null),l({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?d(t):t,{state:n,key:t&&t.key||o||Math.random().toString(36).substr(2,8)})}function u(e){let{pathname:t="/",search:n="",hash:o=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),o&&"#"!==o&&(t+="#"===o.charAt(0)?o:"#"+o),t}function d(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let o=e.indexOf("?");o>=0&&(t.search=e.substr(o),e=e.substr(0,o)),e&&(t.pathname=e)}return t}var m;function p(e,t,n,o){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(o)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(m||(m={})),new Set(["lazy","caseSensitive","path","id","index","children"]);const g=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",h=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;const \_=["post","put","patch","delete"],v=(new Set(\_),["get",...\_]);new Set(v),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement,Symbol("deferred");const E="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},{useState:f,useEffect:b,useLayoutEffect:y,useDebugValue:w}=r;function C(e){const t=e.getSnapshot,n=e.value;try{const e=t();return!E(n,e)}catch(e){return!0}}"undefined"==typeof window||void 0===window.document||window.document.createElement;"useSyncExternalStore"in r&&r.useSyncExternalStore;const S=r.createContext(null),k=r.createContext(null),x=r.createContext(null),N=r.createContext({outlet:null,matches:[]});function P(){return null!=r.useContext(x)}function R(){return P()||c(!1),r.useContext(x).location}function T(){P()||c(!1);let{basename:e,navigator:t}=r.useContext(k),{matches:n}=r.useContext(N),{pathname:o}=R(),a=JSON.stringify(function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(n).map((e=>e.pathnameBase))),s=r.useRef(!1);r.useEffect((()=>{s.current=!0}));let i=r.useCallback((function(n,r){if(void 0===r&&(r={}),!s.current)return;if("number"==typeof n)return void t.go(n);let i=function(e,t,n,o){let r;void 0===o&&(o=!1),"string"==typeof e?r=d(e):(r=l({},e),c(!r.pathname||!r.pathname.includes("?"),p("?","pathname","search",r)),c(!r.pathname||!r.pathname.includes("#"),p("#","pathname","hash",r)),c(!r.search||!r.search.includes("#"),p("#","search","hash",r)));let a,s=""===e||""===r.pathname,i=s?"/":r.pathname;if(o||null==i)a=n;else{let e=t.length-1;if(i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}a=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:o="",hash:r=""}="string"==typeof e?d(e):e,l=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:l,search:g(o),hash:h(r)}}(r,a),m=i&&"/"!==i&&i.endsWith("/"),\_=(s||"."===i)&&n.endsWith("/");return u.pathname.endsWith("/")||!m&&!\_||(u.pathname+="/"),u}(n,JSON.parse(a),o,"path"===r.relative);"/"!==e&&(i.pathname="/"===i.pathname?e:[e,i.pathname].join("/").replace(/\/\/+/g,"/")),(r.replace?t.replace:t.push)(i,r.state,r)}),[e,t,a,o]);return i}var L,M,B,D,F;function A(t){let{basename:n="/",children:o=null,location:l,navigationType:a=e.Pop,navigator:s,static:i=!1}=t;P()&&c(!1);let u=n.replace(/^\/\*/,"/"),m=r.useMemo((()=>({basename:u,navigator:s,static:i})),[u,s,i]);"string"==typeof l&&(l=d(l));let{pathname:p="/",search:g="",hash:h="",state:\_=null,key:v="default"}=l,E=r.useMemo((()=>{let e=function(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,o=e.charAt(n);return o&&"/"!==o?null:e.slice(n)||"/"}(p,u);return null==e?null:{location:{pathname:e,search:g,hash:h,state:\_,key:v},navigationType:a}}),[u,p,g,h,\_,v,a]);return null==E?null:r.createElement(k.Provider,{value:m},r.createElement(x.Provider,{children:o,value:E}))}function O(t){let{basename:n,children:o,window:d}=t,m=r.useRef();null==m.current&&(m.current=function(t){return void 0===t&&(t={}),function(t,n,o,r){void 0===r&&(r={});let{window:d=document.defaultView,v5Compat:m=!1}=r,p=d.history,g=e.Pop,h=null,\_=v();function v(){return(p.state||{idx:null}).idx}function E(){g=e.Pop;let t=v(),n=null==t?null:t-\_;\_=t,h&&h({action:g,location:b.location,delta:n})}function f(e){let t="null"!==d.location.origin?d.location.origin:d.location.href,n="string"==typeof e?e:u(e);return c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==\_&&(\_=0,p.replaceState(l({},p.state,{idx:\_}),""));let b={get action(){return g},get location(){return t(d,p)},listen(e){if(h)throw new Error("A history only accepts one active listener");return d.addEventListener(a,E),h=e,()=>{d.removeEventListener(a,E),h=null}},createHref(e){return n(d,e)},createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){g=e.Push;let r=i(b.location,t,n);o&&o(r,t),\_=v()+1;let l=s(r,\_),a=b.createHref(r);try{p.pushState(l,"",a)}catch(e){d.location.assign(a)}m&&h&&h({action:g,location:b.location,delta:1})},replace:function(t,n){g=e.Replace;let r=i(b.location,t,n);o&&o(r,t),\_=v();let l=s(r,\_),a=b.createHref(r);p.replaceState(l,"",a),m&&h&&h({action:g,location:b.location,delta:0})},go(e){return p.go(e)}};return b}((function(e,t){let{pathname:n,search:o,hash:r}=e.location;return i("",{pathname:n,search:o,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"==typeof t?t:u(t)}),null,t)}({window:d,v5Compat:!0}));let p=m.current,[g,h]=r.useState({action:p.action,location:p.location});return r.useLayoutEffect((()=>p.listen(h)),[p]),r.createElement(A,{basename:n,children:o,location:g.location,navigationType:g.action,navigator:p})}function I(e,t,n=!0){return{...e,default:t,decode:(...o)=>{const r=e.decode(...o);return void 0===r||n&&null===r?t:r}}}function U(e,t){if(null==e)return e;if(0===e.length&&(!t||t&&""!==e))return null;const n=e instanceof Array?e[0]:e;return null==n||t||""!==n?n:null}r.Component,function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"}(L||(L={})),function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(M||(M={})),function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(B||(B={})),new Promise((()=>{})),r.Component,"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement,function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"}(D||(D={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(F||(F={}));const V={encode:function(e){return null==e?e:String(e)},decode:function(e){const t=U(e,!0);return null==t?t:String(t)}},z={encode:function(e){return null==e?e:String(e)},decode:function(e){const t=U(e);return null==t?t:""===t?null:+t}},j={encode:function(e){return null==e?e:e?"1":"0"},decode:function(e){const t=U(e);return null==t?t:"1"===t||"0"!==t&&null}};'{}[],":'.split("").map((e=>[e,encodeURIComponent(e)]));const H=new class{constructor(){this.paramsMap=new Map,this.registeredParams=new Map}set(e,t,n,o){this.paramsMap.set(e,{stringified:t,decoded:n,decode:o})}has(e,t,n){if(!this.paramsMap.has(e))return!1;const o=this.paramsMap.get(e);return!!o&&o.stringified===t&&(null==n||o.decode===n)}get(e){var t;if(this.paramsMap.has(e))return null==(t=this.paramsMap.get(e))?void 0:t.decoded}registerParams(e){for(const t of e){const e=this.registeredParams.get(t)||0;this.registeredParams.set(t,e+1)}}unregisterParams(e){for(const t of e){const e=(this.registeredParams.get(t)||0)-1;e<=0?(this.registeredParams.delete(t),this.paramsMap.has(t)&&this.paramsMap.delete(t)):this.registeredParams.set(t,e)}}clear(){this.paramsMap.clear(),this.registeredParams.clear()}};function $(e,t,n,o){var r;if(!n||!t.length)return e;let l={...e},a=!1;for(const e of t)Object.prototype.hasOwnProperty.call(l,e)||(l[e]=null!=(r=n[e])?r:o,a=!0);return a?l:e}const G=Object.prototype.hasOwnProperty;function W(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function q(e,t,n){var o,r;if(W(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const l=Object.keys(e),a=Object.keys(t);if(l.length!==a.length)return!1;for(let a=0;a<l.length;a++){const c=null!=(r=null==(o=null==n?void 0:n[l[a]])?void 0:o.equals)?r:W;if(!G.call(t,l[a])||!c(e[l[a]],t[l[a]]))return!1}return!0}function Q(e,t,n){const o={},r=Object.keys(t);for(const l of r){const r=t[l],a=e[l];let c;if(n.has(l,a,r.decode))c=n.get(l);else{if(c=r.decode(a),r.equals&&n.has(l,a)){const e=n.get(l);r.equals(c,e)&&(c=e)}void 0!==c&&n.set(l,a,c,r.decode)}void 0===c&&void 0!==r.default&&(c=r.default),o[l]=c}return o}function Y(){let e;return function(t,n,o){const r=Q(t,n,o);return null!=e&&q(e,r)?e:(e=r,r)}}let K,J,Z,X={};const ee=(e,t,n)=>{if(K===t&&Z===e&&J===n)return X;K=t,Z=e;const o=e(null!=t?t:"");J=n;const r=function(e){if(e)return Object.fromEntries(e.split("\n").map((e=>e.split("\0"))))}(n);for(let[e,t]of Object.entries(o)){(null==r?void 0:r[e])&&(delete o[e],e=r[e],o[e]=t);const n=X[e];q(t,n)&&(o[e]=n)}return X=o,o};function te(e,t){null==t&&(t={});const n={...e,...t};return t.params&&e.params&&(n.params={...e.params,...t.params}),n}const ne={adapter:{},options:{searchStringToObject:function(e){const t=new URLSearchParams(e),n={};for(let[e,o]of t)Object.prototype.hasOwnProperty.call(n,e)?Array.isArray(n[e])?n[e].push(o):n[e]=[n[e],o]:n[e]=o;return n},objectToSearchString:function(e){const t=new URLSearchParams,n=Object.entries(e);for(const[e,o]of n)if(null!=o)if(Array.isArray(o))for(const n of o)t.append(e,null!=n?n:"");else t.append(e,o);return t.toString()},updateType:"pushIn",includeKnownParams:void 0,includeAllParams:!1,removeDefaultsFromUrl:!1,enableBatching:!1,skipUpdateWhenNoChange:!0}},oe=r.createContext(ne);function re({children:e,adapter:t,options:n}){const{adapter:o,options:l}=r.useContext(oe),a=r.useMemo((()=>({adapter:null!=t?t:o,options:te(l,n)})),[t,n,o,l]);return r.createElement(oe.Provider,{value:a},e)}function le({children:e,adapter:t,options:n}){const o=t;return o?r.createElement(o,null,(t=>r.createElement(re,{adapter:t,options:n},e))):r.createElement(re,{options:n},e)}function ae({changes:e,updateType:t,currentSearchString:n,paramConfigMap:o,options:r}){const{searchStringToObject:l,objectToSearchString:a}=r;let c;null==t&&(t=r.updateType);const s=ee(l,n),i=$(o,Object.keys(e),r.params);let u,d;return u="function"==typeof e?e(Q(s,i,H)):e,c=function(e,t){const n={},o=Object.keys(t);for(const r of o){const o=t[r];e[r]?n[r]=e[r].encode(t[r]):n[r]=null==o?o:String(o)}return n}(i,u),r.removeDefaultsFromUrl&&function(e,t){var n;for(const o in e)void 0!==(null==(n=t[o])?void 0:n.default)&&void 0!==e[o]&&t[o].encode(t[o].default)===e[o]&&(e[o]=void 0)}(c,i),c=function(e,t){var n;let o={};for(const r in e)null!=(null==(n=t[r])?void 0:n.urlName)?o[t[r].urlName]=e[r]:o[r]=e[r];return o}(c,i),d=a("push"===t||"replace"===t?c:{...s,...c}),(null==d?void 0:d.length)&&"?"!==d[0]&&(d=`?${d}`),null!=d?d:""}const ce=e=>e(),se=e=>setTimeout((()=>e()),0),ie=[];function ue(e,t){const{adapter:n,options:o}=function(){const e=r.useContext(oe);if(void 0===e||e===ne)throw new Error("useQueryParams must be used within a QueryParamProvider");return e}(),[l]=(0,r.useState)(Y),{paramConfigMap:a,options:c}=function(e,t){let n,o;return void 0===e?(n={},o=t):Array.isArray(e)?(n=Object.fromEntries(e.map((e=>[e,"inherit"]))),o=t):(n=e,o=t),{paramConfigMap:n,options:o}}(e,t),s=(0,r.useMemo)((()=>te(o,c)),[o,c]);let i=function(e,t){var n,o,r;const l={};let a=!1;const c=Object.keys(e);let s=c;if(t.includeKnownParams||!1!==t.includeKnownParams&&0===c.length){const e=Object.keys(null!=(n=t.params)?n:{});s.push(...e)}for(const n of s){const c=e[n];null==c||"object"!=typeof c?(a=!0,l[n]=null!=(r=null==(o=t.params)?void 0:o[n])?r:V):l[n]=c}return a?l:e}(a,s);const u=ee(s.searchStringToObject,n.location.search,function(e){let t;for(const n in e)if(e[n].urlName){const o=`${e[n].urlName}\0${n}`;t?t.push(o):t=[o]}return t?t.join("\n"):void 0}(i));s.includeAllParams&&(i=$(i,Object.keys(u),s.params,V));const d=l(u,i,H),m=Object.keys(i).join("\0");(0,r.useEffect)((()=>{const e=m.split("\0");return H.registerParams(e),()=>{H.unregisterParams(e)}}),[m]);const p={adapter:n,paramConfigMap:i,options:s},g=(0,r.useRef)(p);null==g.current&&(g.current=p),(0,r.useEffect)((()=>{g.current.adapter=n,g.current.paramConfigMap=i,g.current.options=s}),[n,i,s]);const[h]=(0,r.useState)((()=>(e,t)=>{const{adapter:n,paramConfigMap:o,options:r}=g.current;null==t&&(t=r.updateType),function(e,{immediate:t}={}){ie.push(e);let n=t?ce:se;1===ie.length&&n((()=>{const t=ie.slice();ie.length=0;const n=t[0].currentSearchString;let o;for(let e=0;e<t.length;++e)o=ae(0===e?t[e]:{...t[e],currentSearchString:o});e.options.skipUpdateWhenNoChange&&o===n||function({searchString:e,adapter:t,navigate:n,updateType:o}){const r={...t.location,search:e};n&&("string"==typeof o&&o.startsWith("replace")?t.replace(r):t.push(r))}({searchString:null!=o?o:"",adapter:t[t.length-1].adapter,navigate:!0,updateType:t[t.length-1].updateType})}))}({changes:e,updateType:t,currentSearchString:n.location.search,paramConfigMap:o,options:r,adapter:n},{immediate:!r.enableBatching})}));return[d,h]}var de=ue;const me=(e,t,n)=>{const o=(0,r.useMemo)((()=>({[e]:null!=t?t:"inherit"})),[e,t]),[l,a]=de(o,n);return[l[e],(0,r.useCallback)(((t,n)=>a("function"==typeof t?n=>{const o=t(n[e]);return{[e]:o}}:{[e]:t},n)),[e,a])]},pe=({children:e})=>{var t;const{navigator:n}=(0,r.useContext)(k),o=T(),l=null==(t=(0,r.useContext)(S))?void 0:t.router,a=R();return e({replace(e){o(e.search||"?",{replace:!0,state:e.state})},push(e){o(e.search||"?",{replace:!1,state:e.state})},get location(){var e,t,o;return null!=(o=null!=(t=null==(e=null==l?void 0:l.state)?void 0:e.location)?t:null==n?void 0:n.location)?o:a}})};var ge=window.contentControl.data,he=window.wp.data,\_e=window.wp.element,ve=n(184),Ee=n.n(ve),fe=window.wp.i18n,be=window.wp.hooks,ye=window.contentControl.icons,we=window.wp.components,Ce=window.contentControl.coreData,Se=window.contentControl.components,ke=window.wp.primitives,xe=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{fillRule:"evenodd",d:"M17.375 15.656A6.47 6.47 0 0018.5 12a6.47 6.47 0 00-.943-3.374l-1.262.813c.448.749.705 1.625.705 2.561a4.977 4.977 0 01-.887 2.844l1.262.813zm-1.951 1.87l-.813-1.261A4.976 4.976 0 0112 17c-.958 0-1.852-.27-2.613-.736l-.812 1.261A6.47 6.47 0 0012 18.5a6.47 6.47 0 003.424-.974zm-8.8-1.87A6.47 6.47 0 015.5 12c0-1.235.344-2.39.943-3.373l1.261.812A4.977 4.977 0 007 12c0 1.056.328 2.036.887 2.843l-1.262.813zm2.581-7.803A4.977 4.977 0 0112 7c1.035 0 1.996.314 2.794.853l.812-1.262A6.47 6.47 0 0012 5.5a6.47 6.47 0 00-3.607 1.092l.812 1.261zM12 20a8 8 0 100-16 8 8 0 000 16zm0-4.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z",clipRule:"evenodd"})),Ne=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M7 13.8h6v-1.5H7v1.5zM18 16V4c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2zM5.5 16V4c0-.3.2-.5.5-.5h10c.3 0 .5.2.5.5v12c0 .3-.2.5-.5.5H6c-.3 0-.5-.2-.5-.5zM7 10.5h8V9H7v1.5zm0-3.3h8V5.8H7v1.4zM20.2 6v13c0 .7-.6 1.2-1.2 1.2H8v1.5h11c1.5 0 2.7-1.2 2.7-2.8V6h-1.5z"})),Pe=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})),Re=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M11 14.5l1.1 1.1 3-3 .5-.5-.6-.6-3-3-1 1 1.7 1.7H5v1.5h7.7L11 14.5zM16.8 5h-7c-1.1 0-2 .9-2 2v1.5h1.5V7c0-.3.2-.5.5-.5h7c.3 0 .5.2.5.5v10c0 .3-.2.5-.5.5h-7c-.3 0-.5-.2-.5-.5v-1.5H7.8V17c0 1.1.9 2 2 2h7c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2z"}));const{pluginUrl:Te,adminUrl:Le,wpVersion:Me}=contentControlSettingsPage,Be={showNotice:!1,ignoreNotice:!1,retryView:""};var De=({tabs:e})=>{const[t="restrictions",n]=me("view",V),o=(0,\_e.useRef)(null),[l,a]=(0,\_e.useState)(Be),{showNotice:c,ignoreNotice:s,retryView:i}=l,u=()=>a(Be),d=(0,he.useSelect)((e=>e(Ce.settingsStore).hasUnsavedChanges()),[]),{saveSettings:m}=(0,he.useDispatch)(Ce.settingsStore);return(0,\_e.useEffect)((()=>{const e=e=>{d&&(e.preventDefault(),e.returnValue=!1)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[d]),(0,\_e.useEffect)((()=>(d||u(),d&&!s||!i||n(i),()=>u())),[d,s]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)("div",{className:"cc-settings-page\_\_header"},(0,r.createElement)("h1",{className:"branding wp-heading-inline"},(0,r.createElement)("a",{href:"https://contentcontrolplugin.com?utm\_campaign=plugin-info&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=header-logo",target:"\_blank"},(0,r.createElement)("img",{src:`${Te}assets/images/logo.svg`}),(0,fe.\_\_)("Content Control","content-control"))),(0,r.createElement)(Se.ControlledTabPanel,{className:"tabs",orientation:"horizontal",selected:null!==t?t:void 0,onSelect:o=>{const r=e.find((e=>e.name===o));var c;r?.onClick&&!1===r.onClick()||(c=o,"settings"!==t||!d||s?n(c):a({...l,showNotice:!0,retryView:c}))},tabs:e}),(0,r.createElement)(we.DropdownMenu,{label:(0,fe.\_\_)("Support","content-control"),icon:xe,toggleProps:Me>=6.2?{as:({onClick:e})=>(0,r.createElement)(we.Button,{icon:xe,variant:"link",onClick:e,className:"components-tab-panel\_\_tabs-item support-link"},(0,r.createElement)("span",{ref:o},(0,fe.\_\_)("Support","content-control")))}:void 0,popoverProps:{noArrow:!1,position:"bottom left",className:"cc-settings-page\_\_support-menu",anchor:Me>=6.2?{getBoundingClientRect:()=>o?.current?.getBoundingClientRect()}:void 0}},(({onClose:e})=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.MenuGroup,null,(0,r.createElement)(we.MenuItem,{icon:Ne,href:"https://contentcontrolplugin.com/docs/?utm\_campaign=plugin-support&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=view-documentation-link",target:"\_blank"},(0,fe.\_\_)("View Documentation","content-control")),(0,r.createElement)(we.MenuItem,{icon:Pe,href:"https://contentcontrolplugin.com/support/?utm\_campaign=plugin-support&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=get-support-link",target:"\_blank"},(0,fe.\_\_)("Get Support","content-control"))),(0,r.createElement)(we.MenuGroup,null,(0,r.createElement)(we.MenuItem,{icon:Re,onClick:()=>{window.location.href=`${Le}options-general.php?page=grant-content-control-access`,e()}},(0,fe.\_\_)("Grant Support Access","content-control"))))))),c&&(0,r.createElement)(we.Modal,{title:(0,fe.\_\_)("Unsaved changes","content-control"),onRequestClose:()=>u()},(0,r.createElement)("p",null,(0,fe.\_\_)("Changes you made may not be saved.","content-control")),(0,r.createElement)(we.Flex,{justify:"right"},(0,r.createElement)(we.Button,{isDestructive:!0,onClick:()=>a({...l,showNotice:!1,ignoreNotice:!0}),text:(0,fe.\_\_)("Ignore","content-control")}),(0,r.createElement)(we.Button,{variant:"primary",onClick:()=>m(),text:(0,fe.\_\_)("Save Settings","content-control")}))))},Fe=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M10 17.389H8.444A5.194 5.194 0 1 1 8.444 7H10v1.5H8.444a3.694 3.694 0 0 0 0 7.389H10v1.5ZM14 7h1.556a5.194 5.194 0 0 1 0 10.39H14v-1.5h1.556a3.694 3.694 0 0 0 0-7.39H14V7Zm-4.5 6h5v-1.5h-5V13Z"})),Ae=window.contentControl.ruleEngine,Oe=n.n(Ae),Ie=()=>{const{isEditorActive:e,editorId:t}=(0,he.useSelect)((e=>{const t=e(Ce.restrictionsStore);return{editorId:t.getEditorId(),isEditorActive:t.isEditorActive()}}),[]),{changeEditorId:n}=(0,he.useDispatch)(Ce.restrictionsStore),[o,r]=ue({edit:z,add:j,tab:V}),l=()=>r({add:void 0,edit:void 0,tab:void 0}),{edit:a,add:c,tab:s}=o;return(0,\_e.useEffect)((()=>{let e=a&&a>0?a:void 0;c&&(e="new"),e!==t&&n(e)}),[a,c,t,n]),(0,\_e.useEffect)((()=>{c||a||e||l()}),[e,c,a]),{tab:s,setTab:e=>r({tab:e}),setEditorId:e=>{r({add:"new"===e||void 0,edit:"number"==typeof e&&e>0?e:void 0}),n(e)},clearEditorParams:l}},Ue=({values:e,updateSettings:t})=>(0,r.createElement)("div",{className:"content-tab"},(0,r.createElement)("h3",null,(0,fe.\_\_)("Apply this restriction if the user views content that is:","content-control")),(0,r.createElement)("p",null,(0,fe.\_\_)("When users visit your site, the plugin will check the viewed content against your selection below and permit or deny access.","content-control")),(0,r.createElement)(Oe(),{value:e.settings.conditions,onChange:e=>t({conditions:e}),options:{features:{notOperand:!0,groups:!0},rulesFilter:e=>(Array.isArray(e.context)?e.context:e.context.split(" ")).indexOf("content")>=0}})),Ve=window.contentControl.utils,ze=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M13 5c-3.3 0-6 2.7-6 6 0 1.4.5 2.7 1.3 3.7l-3.8 3.8 1.1 1.1 3.8-3.8c1 .8 2.3 1.3 3.7 1.3 3.3 0 6-2.7 6-6S16.3 5 13 5zm0 10.5c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z"})),je=window.wp.compose,He=()=>{const{updateEditorValues:e}=(0,he.useDispatch)(Ce.restrictionsStore),{values:t={}}=(0,he.useSelect)((e=>({values:e(Ce.restrictionsStore).getEditorValues(),isEditorActive:e(Ce.restrictionsStore).isEditorActive()})),[]),{settings:n}=t,o=(0,\_e.useCallback)((n=>{e({...t,settings:{...t?.settings,...n}})}),[e,t]),r=(e,t)=>{const o=(0,be.applyFilters)("contentControl.restrictionEditor.fieldIsVisible",void 0,e,n,t);return void 0===o||o},l=(0,\_e.useMemo)((()=>(0,be.applyFilters)("contentControl.restrictionEditor.tabFields",{},n,o)),[n,o]);return{values:t,fieldIsVisible:r,getTabFields:e=>{var t;return(0,be.applyFilters)(`contentControl.restrictionEditor.tabFields.${e}`,null!==(t=l[e])&&void 0!==t?t:[]).sort(((e,t)=>e.priority-t.priority)).filter((t=>r(t.id,e))).map((t=>{const n=(0,be.applyFilters)("contentControl.restrictionEditor.renderField",t.component,t.id,e);return{...t,component:n}}))},updateSettings:o,updateField:(e,t)=>{o({[e]:t})}}},$e=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M12 4L4 7.9V20h16V7.9L12 4zm6.5 14.5H14V13h-4v5.5H5.5V8.8L12 5.7l6.5 3.1v9.7z"}));const Ge=[{value:"redirect",label:(0,fe.\_\_)("Redirect","content-control"),icon:ye.protectedRedirect},{value:"replace",label:(0,fe.\_\_)("Replace Content","content-control"),icon:ye.protectedMessage}],We=[{value:"login",label:(0,fe.\_\_)("Login & Back","content-control"),icon:Re},{value:"home",label:(0,fe.\_\_)("Home Page","content-control"),icon:$e},{value:"custom",label:(0,fe.\_\_)("Custom URL","content-control"),icon:Fe}],qe=[{value:"message",label:(0,fe.\_\_)("Custom Message","content-control")},{value:"page",label:(0,fe.\_\_)("Use Existing Page","content-control")}],Qe=[{label:(0,fe.\_\_)("Filter the restricted items' title, excerpt, and content.","content-control"),value:"filter\_post\_content"},{label:(0,fe.\_\_)("Hide the restricted items from the archive page.","content-control"),value:"hide"},{label:(0,fe.\_\_)("Replace the entire archive page with a custom page.","content-control"),value:"replace\_archive\_page"},{label:(0,fe.\_\_)("Redirect to a different page.","content-control"),value:"redirect"}],Ye=[{label:(0,fe.\_\_)("Filter the restricted items' title, excerpt, and content.","content-control"),value:"filter\_post\_content"},{label:(0,fe.\_\_)("Hide the restricted items from the list page.","content-control"),value:"hide"}],{userRoles:Ke}=contentControlSettingsPage,Je=({settings:e,updateSettings:t})=>{var n;const o=(0,je.useInstanceId)(Je);let l=[];return Array.isArray(e.userRoles)?l=e.userRoles:"object"==typeof e.userRoles&&(l=Object.entries(e.userRoles).map((([e])=>e))),(0,r.createElement)(Se.FieldPanel,{title:(0,fe.\_\_)("User Status","content-control")},(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("Who can see this content?","content-control"),value:e.userStatus,onChange:e=>t({userStatus:e}),options:(0,be.applyFilters)("contentControl.restrictionEditor.userStatusOptions",[{value:"logged\_in",label:(0,fe.\_\_)("Logged In Users","content-control"),icon:ye.lockedUser},{value:"logged\_out",label:(0,fe.\_\_)("Logged Out Users","content-control"),icon:ye.incognito}]),className:"userStatus-field"}),"logged\_in"===e.userStatus&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("br",null),(0,r.createElement)("hr",null),(0,r.createElement)(Se.FieldRow,{id:`content-control-role-match-${o}`,label:(0,fe.\_\_)("User Role","content-control"),description:(0,fe.\_\_)("Which user roles should be allowed to see this content.","content-control"),className:"components-base-control\_\_label"},(0,r.createElement)(we.SelectControl,{id:`content-control-role-match-${o}`,label:(0,fe.\_\_)("User Role","content-control"),value:null!==(n=e.roleMatch)&&void 0!==n?n:"any",options:[{label:(0,fe.\_\_)("Any","content-control"),value:"any"},{label:(0,fe.\_\_)("Matching","content-control"),value:"match"},{label:(0,fe.\_\_)("Excluding","content-control"),value:"exclude"}],onChange:e=>t({roleMatch:e}),className:"is-large roleMatch-field",hideLabelFromVision:!0,\_\_next40pxDefaultSize:!0,\_\_nextHasNoMarginBottom:!0})),"any"!==e.roleMatch&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("hr",null),(0,r.createElement)("br",null),(0,r.createElement)(Se.SearchableMulticheckControl,{label:"exclude"===e.roleMatch?(0,fe.\_\_)("Roles to exclude","content-control"):(0,fe.\_\_)("Roles to include","content-control"),searchIcon:ze,placeholder:(0,fe.\_\_)("Search roles…","content-control"),className:"is-large userRoles-field",value:l,onChange:e=>t({userRoles:e}),options:Object.entries(Ke).map((([e,t])=>({value:e,label:t})))}))))};(0,be.addFilter)("contentControl.restrictionEditor.tabFields","content-control",((e,t,n)=>{const o={settings:t,updateSettings:n};return{...e,general:[{id:"userStatus",priority:3,component:(0,r.createElement)(Je,{...o})}]}}));var Ze=({values:e,updateValues:t})=>{const{getTabFields:n}=He(),o=e.description.length/80,l=(0,Ve.clamp)(o,1,5);return(0,r.createElement)("div",{className:"general-tab"},(0,r.createElement)(we.TextControl,{label:(0,fe.\_\_)("Restriction label","content-control"),hideLabelFromVision:!0,placeholder:(0,fe.\_\_)("Name…","content-control"),className:"title-field",value:e.title,onChange:e=>t({title:e})}),(0,r.createElement)(we.TextareaControl,{rows:l,scrolling:l>5?"auto":"no",label:(0,fe.\_\_)("Restriction description","content-control"),hideLabelFromVision:!0,placeholder:(0,fe.\_\_)("Add description…","content-control"),className:"description-field",value:e.description,onChange:e=>t({description:e})}),e.title.length<=0&&(0,r.createElement)(we.Notice,{status:"warning",isDismissible:!1,className:"title-field-notice"},(0,fe.\_\_)("Enter a label for this set.","content-control")),n("general").map((e=>(0,r.createElement)("div",{key:e.id},e.component))))};(0,be.addFilter)("contentControl.restrictionEditor.tabFields","content-control",((e,t,n)=>{var o;const l=t.customMessage?.length/80,a=(0,Ve.clamp)(l,4,20);return{...e,protection:[{id:"protectionMethod",priority:1,component:(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("How do you want to protect your content?","content-control"),value:t.protectionMethod,onChange:e=>n({protectionMethod:e}),options:(0,be.applyFilters)("contentControl.restrictionEditor.protectionMethodOptions",Ge)})},{id:"redirectType",priority:2,component:(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("Where will the user be taken?","content-control"),value:t.redirectType,onChange:e=>n({redirectType:e}),options:We})},{id:"redirectUrl",priority:3,component:(0,r.createElement)(Se.URLControl,{label:(0,fe.\_\_)("Custom Redirect URL","content-control"),className:"is-large",value:t.redirectUrl,onChange:({url:e})=>{n({redirectUrl:e})}})},{id:"replacementType",priority:4,component:(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("Replacement Type","content-control"),value:t.replacementType,options:qe,onChange:e=>n({replacementType:e})})},{id:"replacementPage",priority:5,component:(0,r.createElement)(Se.EntitySelectControl,{label:(0,fe.\_\_)("Choose a page to replace the content with.","content-control"),placeholder:(0,fe.\_\_)("Choose a page to replace the content with.","content-control"),value:t.replacementPage,multiple:!1,onChange:e=>n({replacementPage:e}),entityKind:"postType",entityType:"page",closeOnSelect:!0})},{id:"showExcerpts",priority:6,component:(0,r.createElement)(we.CheckboxControl,{label:(0,fe.\_\_)("Show excerpts above access denied message?","content-control"),checked:t.showExcerpts,onChange:e=>n({showExcerpts:e})})},{id:"overrideMessage",priority:7,component:(0,r.createElement)(we.CheckboxControl,{label:(0,fe.\_\_)("Override the default message?","content-control"),checked:t.overrideMessage,onChange:e=>n({overrideMessage:e}),help:(0,fe.\_\_)("Edit the default message via the plugin's Settings page.","content-control")})},{id:"customMessage",priority:8,component:(0,r.createElement)(we.TextareaControl,{label:(0,fe.\_\_)("Enter a custom message to display to restricted users","content-control"),rows:a,value:t.customMessage,onChange:e=>n({customMessage:e})})},{id:"archiveHandling",priority:9,component:(0,r.createElement)(we.RadioControl,{label:(0,fe.\_\_)("Handling matches within archives","content-control"),help:(0,fe.\_\_)("Choose how to handle matched content found within archive pages. This option applies to restricted content within the archive page, not the archive page itself.","content-control"),selected:t.archiveHandling,options:Qe,onChange:e=>n({archiveHandling:e})})},{id:"archiveReplacementPage",priority:10,component:(0,r.createElement)(Se.EntitySelectControl,{label:(0,fe.\_\_)("Choose a page to replace the archive with","content-control"),placeholder:(0,fe.\_\_)("Choose a page to replace the archive with","content-control"),value:t.archiveReplacementPage,multiple:!1,onChange:e=>n({archiveReplacementPage:e}),entityKind:"postType",entityType:"page",closeOnSelect:!0})},{id:"archiveRedirectType",priority:11,component:(0,r.createElement)(Se.RadioButtonControl,{label:(0,fe.\_\_)("Where will the user be taken?","content-control"),value:t.archiveRedirectType,onChange:e=>n({archiveRedirectType:e}),options:We})},{id:"archiveRedirectUrl",priority:12,component:(0,r.createElement)(Se.URLControl,{label:(0,fe.\_\_)("Custom Redirect URL","content-control"),className:"is-large",value:t.archiveRedirectUrl,onChange:({url:e})=>{n({archiveRedirectUrl:e})}})},{id:"additionalQueryHandling",priority:13,component:(0,r.createElement)(we.RadioControl,{label:(0,fe.\_\_)("Handling matches everywhere else","content-control"),help:(0,fe.\_\_)("Choose how to handle matched content in all other areas outside the main content. This option applies to restricted content found in non-main queries, sidebars, widgets, footers, or within the page content itself.","content-control"),selected:t.additionalQueryHandling,options:Ye,onChange:e=>n({additionalQueryHandling:e})})},{id:"restApiQueryHandling",priority:13,component:(0,r.createElement)(we.BaseControl,{label:(0,fe.\_\_)("Handling matches in REST API requests","content-control")},(0,r.createElement)("p",null,(0,r.createElement)("strong",null,(0,fe.\_\_)('By default restricted posts in a REST API list will follow "everywhere else" rules set above, single posts & taxonomies will show restricted access notices.',"content-control"))),(0,r.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:(0,fe.sprintf)((0,fe.\_\_)("If you need more control over your REST API, try %sContent Control Pro%s:"),'<a href="https://contentcontrolplugin.com/features/rest-api/" target="\_blank">',"</a>")}}))},...null!==(o=e.protection)&&void 0!==o?o:[]]}})),(0,be.addFilter)("contentControl.restrictionEditor.fieldIsVisible","content-control",((e,t,n)=>{switch(t){case"redirectType":return"redirect"===n.protectionMethod;case"redirectUrl":return"redirect"===n.protectionMethod&&"custom"===n.redirectType;case"replacementType":return"replace"===n.protectionMethod;case"replacementPage":return"replace"===n.protectionMethod&&"page"===n.replacementType;case"showExcerpts":case"overrideMessage":return"replace"===n.protectionMethod&&"message"===n.replacementType;case"customMessage":return"replace"===n.protectionMethod&&"message"===n.replacementType&&n.overrideMessage;case"archiveReplacementPage":return"replace\_archive\_page"===n.archiveHandling;case"archiveRedirectType":return"redirect"===n.archiveHandling;case"archiveRedirectUrl":return"redirect"===n.archiveHandling&&"custom"===n.archiveRedirectType;default:return e}}));var Xe=e=>{const{getTabFields:t}=He();return(0,r.createElement)("div",{className:"protection-tab"},(0,r.createElement)("h3",null,(0,fe.\_\_)("Protecting Content","content-control")),(0,r.createElement)("p",null,(0,fe.\_\_)("When a user does not have access, the following options help control their experience.","content-control")),t("protection").map((e=>(0,r.createElement)("div",{key:e.id},e.component))))};const et=()=>{};var tt=({onSave:e=et,onClose:t=et})=>{const{tab:n,setTab:o,clearEditorParams:l}=Ie(),[a,c]=(0,\_e.useState)(!1),[s,i]=(0,\_e.useState)(null),{editorId:u,isEditorActive:d,values:m,isSaving:p,dispatchStatus:g,dispatchErrors:h}=(0,he.useSelect)((e=>({editorId:e(Ce.restrictionsStore).getEditorId(),values:e(Ce.restrictionsStore).getEditorValues(),isEditorActive:e(Ce.restrictionsStore).isEditorActive(),isSaving:e(Ce.restrictionsStore).isDispatching(["createRestriction","updateRestriction"]),dispatchStatus:{create:e(Ce.restrictionsStore).getDispatchStatus("createRestriction"),update:e(Ce.restrictionsStore).getDispatchStatus("updateRestriction")},dispatchErrors:{create:e(Ce.restrictionsStore).getDispatchError("createRestriction"),update:e(Ce.restrictionsStore).getDispatchError("updateRestriction")}})),[]),{updateEditorValues:\_,createRestriction:v,updateRestriction:E,clearEditorData:f}=(0,he.useDispatch)(Ce.restrictionsStore);if((0,\_e.useEffect)((()=>l),[]),(0,\_e.useEffect)((()=>{var e;if(!a)return;if(Ce.Status.Success===g.create||Ce.Status.Success===g.update)return void b();const t=null!==(e=h.create)&&void 0!==e?e:h.update;void 0!==t&&i(t)}),[g,h]),!d)return null;if(!u)return(0,r.createElement)(r.Fragment,null,(0,fe.\_\_)("Editor requires a valid id","content-control"));if(!m)return(0,r.createElement)(r.Fragment,null,(0,fe.\_\_)("Editor requires a valid restriction.","content-control"));const b=()=>{f(),t()},y={values:m,updateValues:\_,updateSettings:e=>{\_({...m,settings:{...m?.settings,...e}})},onSave:e,onClose:t},w=(0,be.applyFilters)("contentControl.restrictionEditor.tabs",[{name:"general",title:(0,fe.\_\_)("General","content-control"),comp:()=>(0,r.createElement)(Ze,{...y})},{name:"protection",title:(0,fe.\_\_)("Protection","content-control"),comp:()=>(0,r.createElement)(Xe,{...y})},{name:"content",title:(0,fe.\_\_)("Content","content-control"),comp:()=>(0,r.createElement)(Ue,{...y})}]);if("object"==typeof s&&s?.tabName?.length){const e=w.find((e=>e.name===s.tabName));e&&(w[w.indexOf(e)].className=w[w.indexOf(e)].className?w[w.indexOf(e)].className+" error":"error")}const C=(0,fe.sprintf)( |
  | 2 | 2 | // translators: 1. Id of set to edit. |
  | 3 |  | (0,fe.\_\_)("Restriction Editor%s","content-control"),"new"===u?": "+(0,fe.\_\_)("New Restriction","content-control"):`: #${m.id} - ${m.title}`);return(0,r.createElement)(we.Modal,{title:C,className:"restriction-editor",onRequestClose:()=>b(),shouldCloseOnClickOutside:!1},(0,r.createElement)("div",{className:Ee()(["restriction-enabled-toggle","publish"===m.status?"enabled":"disabled"])},(0,r.createElement)(we.ToggleControl,{label:"publish"===m.status?(0,fe.\_\_)("Enabled","content-control"):(0,fe.\_\_)("Disabled","content-control"),checked:"publish"===m.status,onChange:e=>\_({...m,status:e?"publish":"draft"})})),s&&(0,r.createElement)(we.Notice,{status:"error",className:"restriction-editor-error",onDismiss:()=>{i(null)}},"string"==typeof s?s:s.message),(0,r.createElement)(we.TabPanel,{orientation:"vertical",initialTabName:null!=n?n:"general",onSelect:o,tabs:w,className:"editor-tabs"},(({title:e,comp:t})=>void 0===t?e:t())),(0,r.createElement)("div",{className:"modal-actions"},(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Cancel","content-control"),variant:"tertiary",isDestructive:!0,onClick:()=>b(),disabled:p,className:"cancel-button"}),(0,r.createElement)(we.Button,{variant:"primary",disabled:p,onClick:()=>{const t=(0,Ce.validateRestriction)(m);!0===t?function(){if(!u||!m)return;const t="new"!==u&&u>0,n={...m,settings:{...m.settings,conditions:(0,~~Oe.removeEmptyItems)(m.settings.conditions)}};t?E(n):v(n),c(!0),i(null),e(n)}():"object"==typeof t&&i(t)}},p&&(0,r.createElement)(we.Spinner,null),"new"===u?(0,fe.\_\_)("Add Restriction","content-control"):(0,fe.\_\_)("Save Restriction","content-control")),(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Documentation","content-control"),href:"https://contentcontrolplugin.com/docs/?utm\_campaign=documentation&utm\_source=restriction-editor&utm\_medium=plugin-ui&utm\_content=footer-documentation-link",target:"\_blank",icon:Fe,iconSize:20})))},nt=()=>{const{setEditorId:e}=U~~e(),{restrictions:t,isLoading:n}=(0,he.useSelect)((e=>{const t=e(Ce.restrictionsStore);return{restrictions:t.getRestrictions(),isLoading:t.isResolving("getRestrictions")}}),[]),o=t.length;return(0,r.createElement)("header",{className:"cc-settings-view\_\_header"},(0,r.createElement)("h1",{className:"view-title wp-heading-inline"},(0,fe.\_\_)("Restrictions","content-control")),(0,r.createElement)("span",{className:"item-count"},n?(0,r.createElement)(we.Spinner,null):(0,fe.sprintf)(/\* translators: 1. Number of items \*/ |
  | 4 |  | (0,fe.\_n)("%d item","%d items",o,"content-control"),o)),(0,r.createElement)(we.Button,{className:"add-restriction",onClick:()=>e("new"),variant:"primary"},(0,fe.\_\_)("Add Restriction","content-control")))},ot=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})),rt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M20 5h-5.7c0-1.3-1-2.3-2.3-2.3S9.7 3.7 9.7 5H4v2h1.5v.3l1.7 11.1c.1 1 1 1.7 2 1.7h5.7c1 0 1.8-.7 2-1.7l1.7-11.1V7H20V5zm-3.2 2l-1.7 11.1c0 .1-.1.2-.3.2H9.1c-.1 0-.3-.1-.3-.2L7.2 7h9.6z"})),lt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M12 3.9 6.5 9.5l1 1 3.8-3.7V20h1.5V6.8l3.7 3.7 1-1z"})),at=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"m16.5 13.5-3.7 3.7V4h-1.5v13.2l-3.8-3.7-1 1 5.5 5.6 5.5-5.6z"}));const ct=()=>{},st={restrictions:[],filteredRestrictions:[],bulkSelection:[],setBulkSelection:ct,updateRestriction:ct,deleteRestriction:ct,increasePriority:ct,decreasePriority:ct,swapPriority:ct,updatePrioritySortOrder:ct,isLoading:!1,isDeleting:!1,filters:{roles:"",status:"all",searchText:"",restrictedTo:""},setFilters:ct},it=(0,\_e.createContext)(st),{Provider:ut,Consumer:dt}=it,mt=({value:e={},children:t})=>{const[n,o]=(0,\_e.useState)([]),[l,a]=ue({roles:~~U(z,""),status:U(z,"all"),searchText:U(z,""),restrictedTo:U(z~~,"")}),c=()=>a({status:void 0,searchText:void 0});(0,\_e.useEffect)((()=>c),[]);const{restrictions:s,isLoading:i,isDeleting:u}=(0,he.useSelect)((e=>{const t=e(Ce.restrictionsStore);return{restrictions:t.getRestrictions(),isLoading:t.isResolving("getRestrictions"),isDeleting:t.isDispatching("deleteRestriction")}}),[]),{updateRestriction:d,deleteRestriction:m}=(0,he.useDispatch)(Ce.restrictionsStore),p=(0,\_e.useMemo)((()=>{var e;const t=""===l?.roles?[]:null!==(e=l?.roles?.trim().split(","))&&void 0!==e?e:[];return s.filter((e=>!t.length||t.some((t=>e.settings.userRoles?.includes(t))))).filter((e=>""===l.restrictedTo||e.settings.userStatus===l.restrictedTo)).filter((e=>"all"===l.status||l.status===e.status)).filter((e=>!l.searchText||!l.searchText.length||e.title.toLowerCase().indexOf(l.searchText.toLowerCase())>=0||e.description.toLowerCase().indexOf(l.searchText.toLowerCase())>=0))}),[s,l]),g=(e,t)=>{const n=[...p],o=n[e],r=n[t];o&&r&&(n[e]=r,n[t]=o,h(n))},h=e=>{let t=!1;const n=(e||p).map(((e,n)=>e.priority!==n?(t=!0,{...e,priority:n}):e));t&&n.forEach((e=>d(e)))};return(0,r.createElement)(ut,{value:{...e,filters:l,setFilters:a,bulkSelection:n,setBulkSelection:o,restrictions:s,filteredRestrictions:p,updateRestriction:d,deleteRestriction:m,increasePriority:e=>{g(e,e-1)},decreasePriority:e=>{g(e,e+1)},swapPriority:g,updatePrioritySortOrder:h,isLoading:i,isDeleting:u}},t)},pt=()=>(0,\_e.useContext)(it);var gt=(0,r.createElement)(ke.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)(ke.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),ht=(0,r.createElement)(ke.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)(ke.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),\_t=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M18 11.3l-1-1.1-4 4V3h-1.5v11.3L7 10.2l-1 1.1 6.2 5.8 5.8-5.8zm.5 3.7v3.5h-13V15H4v5h16v-5h-1.5z"})),vt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M17.031 4.703 15.576 4l-1.56 3H14v.03l-2.324 4.47H9.5V13h1.396l-1.502 2.889h-.95a3.694 3.694 0 0 1 0-7.389H10V7H8.444a5.194 5.194 0 1 0 0 10.389h.17L7.5 19.53l1.416.719L15.049 8.5h.507a3.694 3.694 0 0 1 0 7.39H14v1.5h1.556a5.194 5.194 0 0 0 .273-10.383l1.202-2.304Z"})),Et=(0,r.createElement)(ke.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)(ke.Path,{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM15.5303 8.46967C15.8232 8.76256 15.8232 9.23744 15.5303 9.53033L13.0607 12L15.5303 14.4697C15.8232 14.7626 15.8232 15.2374 15.5303 15.5303C15.2374 15.8232 14.7626 15.8232 14.4697 15.5303L12 13.0607L9.53033 15.5303C9.23744 15.8232 8.76256 15.8232 8.46967 15.5303C8.17678 15.2374 8.17678 14.7626 8.46967 14.4697L10.9393 12L8.46967 9.53033C8.17678 9.23744 8.17678 8.76256 8.46967 8.46967C8.76256 8.17678 9.23744 8.17678 9.53033 8.46967L12 10.9393L14.4697 8.46967C14.7626 8.17678 15.2374 8.17678 15.5303 8.46967Z"}));const ft=e=>{const{id:t,slug:n,status:o,title:r,description:l,settings:a}=e;return{id:t,slug:n,status:o,title:r,description:l,settings:a}},{version:bt}=contentControlSettingsPage;var yt=()=>{const e=(0,he.useRegistry)(),{bulkSelection:t=[],setBulkSelection:n,restrictions:o=[],deleteRestriction:l,updateRestriction:a}=pt(),{getRestriction:c}=(0,he.useSelect)((e=>({getRestriction:e(Ce.restrictionsStore).getRestriction})),[]),{addNotice:s}=(0,he.useDispatch)(Ce.restrictionsStore),[i,u]=(0,\_e.useState)(),d=(0,\_e.useRef)();return 0===t.length?null:(0,r.createElement)(r.Fragment,null,(0,r.createElement)(Se.ConfirmDialogue,{...i,onClose:()=>u(void 0)}),(0,r.createElement)(we.Dropdown,{className:"list-table-bulk-actions",contentClassName:"list-table-bulk-actions\_\_popover",placement:"bottom left",focusOnMount:"firstElement",popoverProps:{noArrow:!1,anchor:{getBoundingClientRect:()=>d?.current?.getBoundingClientRect()}},renderToggle:({isOpen:e,onToggle:n})=>(0,r.createElement)(we.Flex,null,(0,r.createElement)("span",{className:"selected-items"},(0,fe.sprintf)( |
  |  | 3 | (0,fe.\_\_)("Restriction Editor%s","content-control"),"new"===u?": "+(0,fe.\_\_)("New Restriction","content-control"):`: #${m.id} - ${m.title}`);return(0,r.createElement)(we.Modal,{title:C,className:"restriction-editor",onRequestClose:()=>b(),shouldCloseOnClickOutside:!1},(0,r.createElement)("div",{className:Ee()(["restriction-enabled-toggle","publish"===m.status?"enabled":"disabled"])},(0,r.createElement)(we.ToggleControl,{label:"publish"===m.status?(0,fe.\_\_)("Enabled","content-control"):(0,fe.\_\_)("Disabled","content-control"),checked:"publish"===m.status,onChange:e=>\_({...m,status:e?"publish":"draft"})})),s&&(0,r.createElement)(we.Notice,{status:"error",className:"restriction-editor-error",onDismiss:()=>{i(null)}},"string"==typeof s?s:s.message),(0,r.createElement)(we.TabPanel,{orientation:"vertical",initialTabName:null!=n?n:"general",onSelect:o,tabs:w,className:"editor-tabs"},(({title:e,comp:t})=>void 0===t?e:t())),(0,r.createElement)("div",{className:"modal-actions"},(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Cancel","content-control"),variant:"tertiary",isDestructive:!0,onClick:()=>b(),disabled:p,className:"cancel-button"}),(0,r.createElement)(we.Button,{variant:"primary",disabled:p,onClick:()=>{const t=(0,Ce.validateRestriction)(m);!0===t?function(){if(!u||!m)return;const t="new"!==u&&u>0,n={...m,settings:{...m.settings,conditions:(0,Ae.removeEmptyItems)(m.settings.conditions)}};t?E(n):v(n),c(!0),i(null),e(n)}():"object"==typeof t&&i(t)}},p&&(0,r.createElement)(we.Spinner,null),"new"===u?(0,fe.\_\_)("Add Restriction","content-control"):(0,fe.\_\_)("Save Restriction","content-control")),(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Documentation","content-control"),href:"https://contentcontrolplugin.com/docs/?utm\_campaign=documentation&utm\_source=restriction-editor&utm\_medium=plugin-ui&utm\_content=footer-documentation-link",target:"\_blank",icon:Fe,iconSize:20})))},nt=()=>{const{setEditorId:e}=Ie(),{restrictions:t,isLoading:n}=(0,he.useSelect)((e=>{const t=e(Ce.restrictionsStore);return{restrictions:t.getRestrictions(),isLoading:t.isResolving("getRestrictions")}}),[]),o=t.length;return(0,r.createElement)("header",{className:"cc-settings-view\_\_header"},(0,r.createElement)("h1",{className:"view-title wp-heading-inline"},(0,fe.\_\_)("Restrictions","content-control")),(0,r.createElement)("span",{className:"item-count"},n?(0,r.createElement)(we.Spinner,null):(0,fe.sprintf)(/\* translators: 1. Number of items \*/ |
  |  | 4 | (0,fe.\_n)("%d item","%d items",o,"content-control"),o)),(0,r.createElement)(we.Button,{className:"add-restriction",onClick:()=>e("new"),variant:"primary"},(0,fe.\_\_)("Add Restriction","content-control")))},ot=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})),rt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M20 5h-5.7c0-1.3-1-2.3-2.3-2.3S9.7 3.7 9.7 5H4v2h1.5v.3l1.7 11.1c.1 1 1 1.7 2 1.7h5.7c1 0 1.8-.7 2-1.7l1.7-11.1V7H20V5zm-3.2 2l-1.7 11.1c0 .1-.1.2-.3.2H9.1c-.1 0-.3-.1-.3-.2L7.2 7h9.6z"})),lt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M12 3.9 6.5 9.5l1 1 3.8-3.7V20h1.5V6.8l3.7 3.7 1-1z"})),at=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"m16.5 13.5-3.7 3.7V4h-1.5v13.2l-3.8-3.7-1 1 5.5 5.6 5.5-5.6z"}));const ct=()=>{},st={restrictions:[],filteredRestrictions:[],bulkSelection:[],setBulkSelection:ct,updateRestriction:ct,deleteRestriction:ct,increasePriority:ct,decreasePriority:ct,swapPriority:ct,updatePrioritySortOrder:ct,isLoading:!1,isDeleting:!1,filters:{roles:"",status:"all",searchText:"",restrictedTo:""},setFilters:ct},it=(0,\_e.createContext)(st),{Provider:ut,Consumer:dt}=it,mt=({value:e={},children:t})=>{const[n,o]=(0,\_e.useState)([]),[l,a]=ue({roles:I(V,""),status:I(V,"all"),searchText:I(V,""),restrictedTo:I(V,"")}),c=()=>a({status:void 0,searchText:void 0});(0,\_e.useEffect)((()=>c),[]);const{restrictions:s,isLoading:i,isDeleting:u}=(0,he.useSelect)((e=>{const t=e(Ce.restrictionsStore);return{restrictions:t.getRestrictions(),isLoading:t.isResolving("getRestrictions"),isDeleting:t.isDispatching("deleteRestriction")}}),[]),{updateRestriction:d,deleteRestriction:m}=(0,he.useDispatch)(Ce.restrictionsStore),p=(0,\_e.useMemo)((()=>{var e;const t=""===l?.roles?[]:null!==(e=l?.roles?.trim().split(","))&&void 0!==e?e:[];return s.filter((e=>!t.length||t.some((t=>e.settings.userRoles?.includes(t))))).filter((e=>""===l.restrictedTo||e.settings.userStatus===l.restrictedTo)).filter((e=>"all"===l.status||l.status===e.status)).filter((e=>!l.searchText||!l.searchText.length||e.title.toLowerCase().indexOf(l.searchText.toLowerCase())>=0||e.description.toLowerCase().indexOf(l.searchText.toLowerCase())>=0))}),[s,l]),g=(e,t)=>{const n=[...p],o=n[e],r=n[t];o&&r&&(n[e]=r,n[t]=o,h(n))},h=e=>{let t=!1;const n=(e||p).map(((e,n)=>e.priority!==n?(t=!0,{...e,priority:n}):e));t&&n.forEach((e=>d(e)))};return(0,r.createElement)(ut,{value:{...e,filters:l,setFilters:a,bulkSelection:n,setBulkSelection:o,restrictions:s,filteredRestrictions:p,updateRestriction:d,deleteRestriction:m,increasePriority:e=>{g(e,e-1)},decreasePriority:e=>{g(e,e+1)},swapPriority:g,updatePrioritySortOrder:h,isLoading:i,isDeleting:u}},t)},pt=()=>(0,\_e.useContext)(it);var gt=(0,r.createElement)(ke.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)(ke.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),ht=(0,r.createElement)(ke.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)(ke.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),\_t=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M18 11.3l-1-1.1-4 4V3h-1.5v11.3L7 10.2l-1 1.1 6.2 5.8 5.8-5.8zm.5 3.7v3.5h-13V15H4v5h16v-5h-1.5z"})),vt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M17.031 4.703 15.576 4l-1.56 3H14v.03l-2.324 4.47H9.5V13h1.396l-1.502 2.889h-.95a3.694 3.694 0 0 1 0-7.389H10V7H8.444a5.194 5.194 0 1 0 0 10.389h.17L7.5 19.53l1.416.719L15.049 8.5h.507a3.694 3.694 0 0 1 0 7.39H14v1.5h1.556a5.194 5.194 0 0 0 .273-10.383l1.202-2.304Z"})),Et=(0,r.createElement)(ke.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)(ke.Path,{d:"M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21ZM15.5303 8.46967C15.8232 8.76256 15.8232 9.23744 15.5303 9.53033L13.0607 12L15.5303 14.4697C15.8232 14.7626 15.8232 15.2374 15.5303 15.5303C15.2374 15.8232 14.7626 15.8232 14.4697 15.5303L12 13.0607L9.53033 15.5303C9.23744 15.8232 8.76256 15.8232 8.46967 15.5303C8.17678 15.2374 8.17678 14.7626 8.46967 14.4697L10.9393 12L8.46967 9.53033C8.17678 9.23744 8.17678 8.76256 8.46967 8.46967C8.76256 8.17678 9.23744 8.17678 9.53033 8.46967L12 10.9393L14.4697 8.46967C14.7626 8.17678 15.2374 8.17678 15.5303 8.46967Z"}));const ft=e=>{const{id:t,slug:n,status:o,title:r,description:l,settings:a}=e;return{id:t,slug:n,status:o,title:r,description:l,settings:a}},{version:bt}=contentControlSettingsPage;var yt=()=>{const e=(0,he.useRegistry)(),{bulkSelection:t=[],setBulkSelection:n,restrictions:o=[],deleteRestriction:l,updateRestriction:a}=pt(),{getRestriction:c}=(0,he.useSelect)((e=>({getRestriction:e(Ce.restrictionsStore).getRestriction})),[]),{addNotice:s}=(0,he.useDispatch)(Ce.restrictionsStore),[i,u]=(0,\_e.useState)(),d=(0,\_e.useRef)();return 0===t.length?null:(0,r.createElement)(r.Fragment,null,(0,r.createElement)(Se.ConfirmDialogue,{...i,onClose:()=>u(void 0)}),(0,r.createElement)(we.Dropdown,{className:"list-table-bulk-actions",contentClassName:"list-table-bulk-actions\_\_popover",placement:"bottom left",focusOnMount:"firstElement",popoverProps:{noArrow:!1,anchor:{getBoundingClientRect:()=>d?.current?.getBoundingClientRect()}},renderToggle:({isOpen:e,onToggle:n})=>(0,r.createElement)(we.Flex,null,(0,r.createElement)("span",{className:"selected-items"},(0,fe.sprintf)( |
  | 5 | 5 | // translators: 1. number of items. |
  | 6 |  | (0,fe.\_n)("%d item selected","%d items selected",t.length,"content-control"),t.length)),(0,r.createElement)(we.Button,{className:"popover-toggle",ref:e=>{d.current=e},"aria-label":(0,fe.\_\_)("Bulk Actions","content-control"),variant:"secondary",onClick:n,"aria-expanded":e,icon:ye.checkAll,iconSize:20},(0,fe.\_\_)("Bulk Actions","content-control"),(0,r.createElement)(we.Icon,{className:"toggle-icon",icon:e?gt:ht}))),renderContent:()=>(0,r.createElement)(we.NavigableMenu,{orientation:"vertical"},(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Export Selected","content-control"),icon:\_t,onClick:()=>{const e={version:bt,restrictions:o.filter((({id:e})=>t.indexOf(e)>=0)).map(ft)};(0,~~z~~e.saveFile)(JSON.stringify(e),"content-control-restrictions.json","text/json")}}),(0,r.createElement)("hr",null),(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Enable","content-control"),icon:Fe,onClick:()=>{e.batch((()=>{const e=t.length;t.forEach((e=>{const t=c(e);t?.id===e&&a({...t,status:"publish"})})),n([]),s({id:"bulk-enable",type:"success",message:(0,fe.sprintf)( |
  |  | 6 | (0,fe.\_n)("%d item selected","%d items selected",t.length,"content-control"),t.length)),(0,r.createElement)(we.Button,{className:"popover-toggle",ref:e=>{d.current=e},"aria-label":(0,fe.\_\_)("Bulk Actions","content-control"),variant:"secondary",onClick:n,"aria-expanded":e,icon:ye.checkAll,iconSize:20},(0,fe.\_\_)("Bulk Actions","content-control"),(0,r.createElement)(we.Icon,{className:"toggle-icon",icon:e?gt:ht}))),renderContent:()=>(0,r.createElement)(we.NavigableMenu,{orientation:"vertical"},(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Export Selected","content-control"),icon:\_t,onClick:()=>{const e={version:bt,restrictions:o.filter((({id:e})=>t.indexOf(e)>=0)).map(ft)};(0,Ve.saveFile)(JSON.stringify(e),"content-control-restrictions.json","text/json")}}),(0,r.createElement)("hr",null),(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Enable","content-control"),icon:Fe,onClick:()=>{e.batch((()=>{const e=t.length;t.forEach((e=>{const t=c(e);t?.id===e&&a({...t,status:"publish"})})),n([]),s({id:"bulk-enable",type:"success",message:(0,fe.sprintf)( |
  | 7 | 7 | // translators: 1. number of items |
  | 8 | 8 | (0,fe.\_n)("%d restriction enabled.","%d restrictions enabled.",e,"content-control"),e),closeDelay:3e3})}))}}),(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Disable","content-control"),icon:vt,onClick:()=>{e.batch((()=>{const e=t.length;t.forEach((e=>{const t=c(e);t?.id===e&&a({...t,status:"draft"})})),n([]),s({id:"bulk-disable",type:"success",message:(0,fe.sprintf)( |
  | […](/browser/content-control/trunk/dist/settings-page.js?rev=3007200#L16) | […](/browser/content-control/trunk/dist/settings-page.js?rev=3052982#L16) |  |
  | 16 | 16 | (0,fe.\_\_)("Are you sure you want to premanently delete %d items?","content-control"),t.length),callback:()=>{e.batch((()=>{const e=t.length;t.forEach((e=>l(e,!0))),n([]),s({id:"bulk-delete",type:"success",message:(0,fe.sprintf)( |
  | 17 | 17 | // translators: 1. number of items |
  | 18 |  | (0,fe.\_n)("%d restriction deleted.","%d restrictions deleted.",e),e),closeDelay:3e3})}))}})}}))}))},wt=window.contentControl.fields;const{userRoles:Ct}=contentControlSettingsPage,St={all:(0,fe.\_\_)("All","content-control"),publish:(0,fe.\_\_)("Enabled","content-control"),draft:(0,fe.\_\_)("Disabled","content-control"),pending:(0,fe.\_\_)("Pending","content-control"),trash:(0,fe.\_\_)("Trash","content-control")};var kt=()=>{var e,t,n,o,l;const{filters:a={},setFilters:c,bulkSelection:s=[],restrictions:i=[],filteredRestrictions:u=[]}=pt(),[d,m]=(0,\_e.useState)(""),p=(0,\_e.useRef)({}),g=(0,\_e.useMemo)((()=>i.reduce(((e,t)=>{var n;return e[t.status]=(null!==(n=e[t.status])&&void 0!==n?n:0)+1,e.all++,e}),{all:0})),[i]),h=(0,\_e.useMemo)((()=>u.reduce(((e,t)=>{var n;return e[t.status]=(null!==(n=e[t.status])&&void 0!==n?n:0)+1,e.all++,e}),{all:0})),[u]);if(s.length>0)return null;const \_=({name:e,label:t,currentSelection:n,children:o})=>{const l=d===e;return(0,r.createElement)("div",{className:Ee()([`list-table-filter list-table-filter--${e}`,l?"is-active":""])},(0,r.createElement)(we.Button,{className:"filter-button",onClick:()=>m(l?"":e),ref:t=>{p.current[e]=t}},(0,r.createElement)("span",{className:"filter-label"},t,":")," ",(0,r.createElement)("span",{className:"filter-selection"},n),(0,r.createElement)(we.Icon,{className:"filter-icon",icon:l?gt:ht})),l&&(0,r.createElement)(we.Popover,{className:"list-table-filters\_\_popover",anchor:{getBoundingClientRect:()=>p.current[e].getBoundingClientRect()},onClose:()=>m(""),position:"bottom right",onFocusOutside:()=>m("")},o))},v=""===a?.roles?[]:null!==(e=a?.roles?.trim().split(","))&&void 0!==e?e:[],E=[{label:(0,fe.\_\_)("All","content-control"),value:""},{label:(0,fe.\_\_)("Logged In","content-control"),value:"logged\_in"},{label:(0,fe.\_\_)("Logged Out","content-control"),value:"logged\_out"}];return(0,r.createElement)("div",{className:"list-table-filters"},(0,r.createElement)(\_,{name:"role",label:(0,fe.\_\_)("Role","content-control"),currentSelection:(()=>{switch(v.length){case 0:return(0,fe.\_\_)("All","content-control");case 1:return Ct[v[0]];case 2:return v.map((e=>{var t;return null!==(t=Ct[e])&&void 0!==t?t:""})).join(", ");default:return v.slice(0,1).map((e=>{var t;return null!==(t=Ct[e])&&void 0!==t?t:""})).join(", ")+` +${v.length-1} more`}})()},(0,r.createElement)(wt.MulticheckField,{label:(0,fe.\_\_)("Role","content-control"),value:v,options:Object.entries(Ct).map((([e,t])=>({value:e,label:t}))),onChange:e=>{c({roles:e.join(",")}),m("")},type:"multicheck",id:""})),(0,r.createElement)(\_,{name:"who",label:(0,fe.\_\_)("Restricted To","content-control"),currentSelection:null!==(t=E.find((e=>e.value===a?.restrictedTo))?.label)&&void 0!==t?t:""},(0,r.createElement)(we.RadioControl,{label:(0,fe.\_\_)("Restricted To","content-control"),selected:null!==(n=a?.restrictedTo)&&void 0!==n?n:"",options:E,onChange:e=>{c({restrictedTo:e}),m("")}})),(0,r.createElement)(\_,{name:"status",label:(0,fe.\_\_)("Status","content-control"),currentSelection:St[null!==(o=a?.status)&&void 0!==o?o:""]},(0,r.createElement)(we.RadioControl,{label:(0,fe.\_\_)("Status","content-control"),hideLabelFromVision:!0,selected:null!==(l=a?.status)&&void 0!==l?l:"",options:Object.entries(St).filter((([e])=>{var t,n;return g[null!==(t=a?.status)&&void 0!==t?t:""]>0?(n=e,h?.[n]>0):g[e]>0})).map((([e,t])=>{var n;return{label:`${t} (${null!==(n=h[e])&&void 0!==n?n:0})`,value:e}})),onChange:e=>{c({status:e}),m("")}})))},xt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})),Nt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M18.5 15v3.5H13V6.7l4.5 4.1 1-1.1-6.2-5.8-5.8 5.8 1 1.1 4-4v11.7h-6V15H4v5h16v-5z"})),~~R~~t=()=>{const{createRestriction:e,addNotice:t}=(0,he.useDispatch)(Ce.restrictionsStore),{getNextPriority:n}=(0,he.useSelect)((e=>({getNextPriority:e(Ce.restrictionsStore).getNextPriority})),[]),o=o=>{const r=JSON.parse(o);if(!r?.restrictions?.length)return;let l=0,a=n();if(r.restrictions.forEach((t=>{try{e({...t,status:"draft",priority:a})}catch(e){l++}a++})),l&&t({id:"content-control-import-error",type:"error",message:(0,fe.sprintf)( |
  |  | 18 | (0,fe.\_n)("%d restriction deleted.","%d restrictions deleted.",e),e),closeDelay:3e3})}))}})}}))}))},wt=window.contentControl.fields;const{userRoles:Ct}=contentControlSettingsPage,St={all:(0,fe.\_\_)("All","content-control"),publish:(0,fe.\_\_)("Enabled","content-control"),draft:(0,fe.\_\_)("Disabled","content-control"),pending:(0,fe.\_\_)("Pending","content-control"),trash:(0,fe.\_\_)("Trash","content-control")};var kt=()=>{var e,t,n,o,l;const{filters:a={},setFilters:c,bulkSelection:s=[],restrictions:i=[],filteredRestrictions:u=[]}=pt(),[d,m]=(0,\_e.useState)(""),p=(0,\_e.useRef)({}),g=(0,\_e.useMemo)((()=>i.reduce(((e,t)=>{var n;return e[t.status]=(null!==(n=e[t.status])&&void 0!==n?n:0)+1,e.all++,e}),{all:0})),[i]),h=(0,\_e.useMemo)((()=>u.reduce(((e,t)=>{var n;return e[t.status]=(null!==(n=e[t.status])&&void 0!==n?n:0)+1,e.all++,e}),{all:0})),[u]);if(s.length>0)return null;const \_=({name:e,label:t,currentSelection:n,children:o})=>{const l=d===e;return(0,r.createElement)("div",{className:Ee()([`list-table-filter list-table-filter--${e}`,l?"is-active":""])},(0,r.createElement)(we.Button,{className:"filter-button",onClick:()=>m(l?"":e),ref:t=>{p.current[e]=t}},(0,r.createElement)("span",{className:"filter-label"},t,":")," ",(0,r.createElement)("span",{className:"filter-selection"},n),(0,r.createElement)(we.Icon,{className:"filter-icon",icon:l?gt:ht})),l&&(0,r.createElement)(we.Popover,{className:"list-table-filters\_\_popover",anchor:{getBoundingClientRect:()=>p.current[e].getBoundingClientRect()},onClose:()=>m(""),position:"bottom right",onFocusOutside:()=>m("")},o))},v=""===a?.roles?[]:null!==(e=a?.roles?.trim().split(","))&&void 0!==e?e:[],E=[{label:(0,fe.\_\_)("All","content-control"),value:""},{label:(0,fe.\_\_)("Logged In","content-control"),value:"logged\_in"},{label:(0,fe.\_\_)("Logged Out","content-control"),value:"logged\_out"}];return(0,r.createElement)("div",{className:"list-table-filters"},(0,r.createElement)(\_,{name:"role",label:(0,fe.\_\_)("Role","content-control"),currentSelection:(()=>{switch(v.length){case 0:return(0,fe.\_\_)("All","content-control");case 1:return Ct[v[0]];case 2:return v.map((e=>{var t;return null!==(t=Ct[e])&&void 0!==t?t:""})).join(", ");default:return v.slice(0,1).map((e=>{var t;return null!==(t=Ct[e])&&void 0!==t?t:""})).join(", ")+` +${v.length-1} more`}})()},(0,r.createElement)(wt.MulticheckField,{label:(0,fe.\_\_)("Role","content-control"),value:v,options:Object.entries(Ct).map((([e,t])=>({value:e,label:t}))),onChange:e=>{c({roles:e.join(",")}),m("")},type:"multicheck",id:""})),(0,r.createElement)(\_,{name:"who",label:(0,fe.\_\_)("Restricted To","content-control"),currentSelection:null!==(t=E.find((e=>e.value===a?.restrictedTo))?.label)&&void 0!==t?t:""},(0,r.createElement)(we.RadioControl,{label:(0,fe.\_\_)("Restricted To","content-control"),selected:null!==(n=a?.restrictedTo)&&void 0!==n?n:"",options:E,onChange:e=>{c({restrictedTo:e}),m("")}})),(0,r.createElement)(\_,{name:"status",label:(0,fe.\_\_)("Status","content-control"),currentSelection:St[null!==(o=a?.status)&&void 0!==o?o:""]},(0,r.createElement)(we.RadioControl,{label:(0,fe.\_\_)("Status","content-control"),hideLabelFromVision:!0,selected:null!==(l=a?.status)&&void 0!==l?l:"",options:Object.entries(St).filter((([e])=>{var t,n;return g[null!==(t=a?.status)&&void 0!==t?t:""]>0?(n=e,h?.[n]>0):g[e]>0})).map((([e,t])=>{var n;return{label:`${t} (${null!==(n=h[e])&&void 0!==n?n:0})`,value:e}})),onChange:e=>{c({status:e}),m("")}})))},xt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})),Nt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M18.5 15v3.5H13V6.7l4.5 4.1 1-1.1-6.2-5.8-5.8 5.8 1 1.1 4-4v11.7h-6V15H4v5h16v-5z"})),Pt=()=>{const{createRestriction:e,addNotice:t}=(0,he.useDispatch)(Ce.restrictionsStore),{getNextPriority:n}=(0,he.useSelect)((e=>({getNextPriority:e(Ce.restrictionsStore).getNextPriority})),[]),o=o=>{const r=JSON.parse(o);if(!r?.restrictions?.length)return;let l=0,a=n();if(r.restrictions.forEach((t=>{try{e({...t,status:"draft",priority:a})}catch(e){l++}a++})),l&&t({id:"content-control-import-error",type:"error",message:(0,fe.sprintf)( |
  | 19 | 19 | // translators: %d is the number of restrictions that failed to import. |
  | 20 | 20 | (0,fe.\_n)("%d Restriction failed to import.","%d Restrictions failed to import.",l,"content-control"),l),isDismissible:!0}),l===r?.restrictions?.length)return;const c=r?.restrictions?.length-l;t({id:"content-control-import-success",type:"success",message:(0,fe.sprintf)( |
  | 21 | 21 | // translators: %d is the number of restrictions imported. |
  | 22 |  | (0,fe.\_n)("%d Restriction imported successfully.","%d Restrictions imported successfully.",c,"content-control"),c),isDismissible:!0,closeDelay:5e3})};return(0,r.createElement)(we.Dropdown,{className:"list-table-options-menu",contentClassName:"list-table-options-menu\_\_popover",placement:"bottom left",focusOnMount:"firstElement",popoverProps:{noArrow:!1},renderToggle:({isOpen:e,onToggle:t})=>(0,r.createElement)(we.Button,{className:"popover-toggle","aria-label":(0,fe.\_\_)("Additional options","content-control"),onClick:t,"aria-expanded":e,icon:xt}),renderContent:({onClose:e})=>(0,r.createElement)(we.NavigableMenu,{orientation:"vertical"},(0,r.createElement)(we.FormFileUpload,{icon:Nt,text:(0,fe.\_\_)("Import","content-control"),accept:"text/json",onChange:t=>{var n;const r=null!==(n=t.currentTarget.files?.length)&&void 0!==n?n:0;for(let e=0;e<r;e++)t.currentTarget.files?.[e].text().then(o);e()}}))})},~~Pt=()=>{const{setEditorId:e}=Ue(),[t,n]=(0,\_e.useState)(!1),[o,l]=(0,\_e.useState)(),a=()=>l(void 0);return(0,r.createElement)(mt,null,(0,r.createElement)(dt,null,(({isLoading:c,isDeleting:s,bulkSelection:i=[],setBulkSelection:u=ze.noop,filteredRestrictions:d=[],updateRestriction:m=ze.noop,deleteRestriction:p=ze.noop,increasePriority:g=ze.noop,decreasePriority:h=ze.noop,filters:{searchText:\_=""},setFilters:v})=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(Se.ConfirmDialogue,{...o,onClose:a}),(0,r.createElement)("div",{className:"list-table-container"},c&&(0,r.createElement)("div",{className:"is-loading"},(0,r.createElement)(we.Spinner,null)),(0,r.createElement)("div",{className:"list-table-header"},(0,r.createElement)("div",{className:"list-search"},(0,r.createElement)(we.Icon,{icon:Ie}),(0,r.createElement)(we.TextControl,{placeholder:(0,fe.\_\_)("Search Restrictions…","content-control"),value:null!=\_?\_:"",onChange:e=>v({searchText:""!==e?e:void 0})})),(0,r.createElement)(yt,null),0===i.length&&(0,r.createElement)(we.Button,{className:"filters-toggle",variant:"secondary",onClick:()=>{n(!t)},"aria-expanded":t,icon:ye.filterLines,iconSize:20,text:t?(0,fe.\_\_)("Hide Filters","content-control"):(0,fe.\_\_)("Filters","content-control")}),(0,r.createElement)(Rt,null)),t&&(0,r.createElement)(kt,null),(0,r.createElement)(Se.ListTable,{selectedItems:i,onSelectItems:e=>u(e),items:c?[]:d,columns:{enabled:()=>(0,r.createElement)(we.Tooltip,{text:(0,fe.\_\_)("Enable or disable the restriction","content-control"),position:"top right"},(0,r.createElement)("span",null,(0,r.createElement)(we.Icon,{icon:ot}))),title:(0,fe.\_\_)("Name","content-control"),description:(0,fe.\_\_)("Description","content-control"),restrictedTo:(0,fe.\_\_)("Restricted to","content-control"),status:(0,fe.\_\_)("Status","content-control"),roles:(0,fe.\_\_)("Roles","content-control"),priority:(0,fe.\_\_)("Priority","content-control")},sortableColumns:["priority","title"],rowClasses:e=>[`restriction-${e.id}`,`status-${e.status}`],renderCell:(t,n)=>{var o,a,c;const i=n.status,u="trash"===i,\_="publish"===i;switch(t){case"enabled":return(0,r.createElement)(we.ToggleControl,{label:"","aria-label":(0,fe.\_\_)("Enable or disable the restriction","content-control"),checked:\_,disabled:u,onChange:e=>{m({...n,status:e?"publish":"draft"})}});case"status":return u?(0,r.createElement)(we.Icon,{"aria-label":(0,fe.\_\_)("In Trash","content-control"),icon:rt,size:20}):(0,r.createElement)("span",null,\_?(0,fe.\_\_)("Enabled","content-control"):(0,fe.\_\_)("Disabled","content-control"));case"title":return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.Button,{variant:"link",onClick:()=>e(n.id)},n.title),(0,r.createElement)("div",{className:"item-actions"},`${(0,fe.\_\_)("ID","content-control")}: ${n.id}`,(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Edit","content-control"),variant:"link",onClick:()=>e(n.id)}),(0,r.createElement)(we.Button,{text:u?(0,fe.\_\_)("Untrash","content-control"):(0,fe.\_\_)("Trash","content-control"),variant:"link",isDestructive:!0,isBusy:!!s,onClick:()=>u?m({...n,status:"draft"}):p(n.id)}),u&&(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Delete Permanently","content-control"),variant:"link",isDestructive:!0,isBusy:!!s,onClick:()=>l({message:(0,fe.\_\_)("Are you sure you want to premanently delete this restriction?"),callback:()=>{p(n.id,!0)},isDestructive:!0})})));case"restrictedTo":return"logged\_in"===n.settings.userStatus?(0,r.createElement)(we.Flex,null,(0,r.createElement)(we.Icon,{icon:ye.lockedUser,size:20}),(0,r.createElement)("span",null,(0,fe.\_\_)("Logged in users","content-control"))):(0,r.createElement)(we.Flex,null,(0,r.createElement)(we.Icon,{icon:ye.incognito,size:20}),(0,r.createElement)("span",null,(0,fe.\_\_)("Logged out users","content-control")));case"roles":{const{userRoles:e,userStatus:t,roleMatch:o="any"}=n.settings;return"logged\_out"===t||"any"===o||0===e.length?(0,r.createElement)(we.Flex,null,(0,r.createElement)("span",null,(0,fe.\_\_)("Everyone","content-control"))):(0,r.createElement)(we.Flex,null,"exclude"===o&&(0,fe.\_n)("Exclude:","Excludes:",e.length,"content-control"),e.slice(0,2).map((e=>(0,r.createElement)("span",{key:e},e))),e.length>2&&(0,r.createElement)("span",{className:"remaining"},"+"+(e.length-2)))}case"priority":return(0,r.createElement)(we.Flex,{gap:0},(0,r.createElement)("strong",null,(null!==(o=n.priority)&&void 0!==o?o:0)+1),(0,r.createElement)(we.Button,{className:"priority-up",variant:"link",disabled:0===n.priority,iconSize:18,icon:lt,onClick:()=>{g(n.priority)}}),(0,r.createElement)(we.Button,{className:"priority-down",variant:"link",disabled:d.length-1===n.priority,iconSize:18,icon:at,onClick:()=>{h(n.priority)}}));default:return null!==(a=null!==(c=n[t])&&void 0!==c?c:n.settings[t])&&void 0!==a?a:""}}}))))))},Tt=()=>{const e=(0,\_e.useRef)({}),{notices:t}=(0,he.useSelect)((e=>({notices:e(Ce.restrictionsStore).getNotices()})),[]),{clearNotice:n}=(0,he.useDispatch)(Ce.restrictionsStore),o=(0,\_e.useCallback)((t=>{e.current[t]&&(clearTimeout(e.current[t]),delete e.current[t]),n(t)}),[n]);return(0,\_e.useLayoutEffect)((()=>{t.forEach((t=>{if(t.closeDelay){if(e.current[t.id])return;e.current[t.id]=setTimeout((()=>{o(t.id)}),t.closeDelay)}}))}),[t,o]),t.length?(0,r.createElement)("div",{className:"notices"},t.map((e=>(0,r.createElement)(we.Notice,{key:e.id,status:e.type,isDismissible:e.isDismissible,onRemove:()=>o(e.id)},e.message)))):null};const{hasSettingsUpgrades:Lt,hasRestrictionUpgrades:Mt}=contentControlSettingsPage;var Bt=e=>{const{type:t}=e,n="settings"===t?Lt:Mt;return(0,r.createElement)(r.Fragment,null,n&&(0,r.createElement)("div",{className:"has-upgrades"},(0,r.createElement)("span",null,(()=>{switch(t){case"settings":return(0,fe.\_\_)("You have upgrades available for your plugin settings.","content-control");case"restrictions":return(0,fe.\_\_)("You have upgrades available for your restrictions.","content-control");default:return""}})()," ⤴")))};const{permissions:{edit\_restrictions:Dt}}=contentControlSettingsPage;var Ft=()=>{const e=(0,he.useSelect)((e=>e(Ce.restrictionsStore).isEditorActive()),[]);return Dt?(0,r.createElement)("div",{className:"restriction-list"},(0,r.createElement)(Bt,{type:"restrictions"}),(0,r.createElement)(Tt,null),(0,r.createElement)(nt,null),(0,r.createElement)(Pt,null),e&&(0,r.createElement)(tt,null)):(0,r.createElement)("div",{className:"restriction-list permission-denied"},(0,r.createElement)(Tt,null),(0,r.createElement)("h3",null,(0,fe.\_\_)("Permission Denied","content-control")),(0,r.createElement)("p",null,(0,r.createElement)("strong",null,(0,fe.\_\_)("You do not have permission to manage Content Control settings.","content-control"))))},Ot=({tabs:e})=>{const[t,n]=me("tab",z),{isSaving:o,saveSettings:l,hasUnsavedChanges:a}=(0,Ce.useSettings)();return(0,r.createElement)("div",{className:"cc-settings-view\_\_header"},(0,r.createElement)("div",{className:"header-top-bar"},(0,r.createElement)("h1",{className:"wp-heading-inline"},(0,fe.\_\_)("Settings","content-control")),(0,r.createElement)(we.Button,{variant:"primary",disabled:o||!a,className:"save-settings",onClick:()=>l()},o&&(0,r.createElement)(we.Spinner,null),(0,fe.\_\_)("Save Settings","content-control"))),(0,r.createElement)(Se.ControlledTabPanel,{className:"tabs",orientation:"horizontal",selected:null!==t?t:void 0,onSelect:t=>{const o=e.find((e=>e.name===t));o?.onClick&&!1===o.onClick()||n(t)},tabs:e},(()=>(0,r.createElement)(r.Fragment,null))))},At=({name:e,title:t,badge:n,icon:o,children:l})=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.Panel,{className:Ee()("settings-section-panel",e?`settings-section-panel--${e}`:"")},(0,r.createElement)("div",{className:"components-panel\_\_header"},o&&(0,r.createElement)("span",{className:"panel-icon"},(0,r.createElement)(we.Icon,{icon:o})),(0,r.createElement)("span",{className:"panel-title"},t),n&&(0,r.createElement)("span",{className:"panel-badge"},n)),(0,r.createElement)(we.PanelBody,null,l))),Ut=()=>{const{settings:{excludedBlocks:e=[]},stageUnsavedChanges:t}=(0,Ce.useSettings)(),{knownBlockTypes:n=[]}=(0,he.useSelect)((e=>({knownBlockTypes:e(Ce.settingsStore).getKnownBlockTypes()})),[]),[o,l]=(0,\_e.useState)(""),a=t=>e?.indexOf(t)>=0,c=(0,be.applyFilters)("contentControl.settingsPage.knownBlockTypes",n),s=(0,\_e.useMemo)((()=>o&&0!==o.length?c.filter((({title:e,description:t="",keywords:n,category:r=""})=>-1===[...o.split(" ").map((o=>{const l=o.trim().toLowerCase();return e.trim().toLowerCase().indexOf(l)>=0||t.trim().toLowerCase().indexOf(l)>=0||r.trim().toLowerCase().indexOf(l)>=0||void 0!==n?.find((e=>e.trim().toLowerCase().indexOf(l)>=0))}))].indexOf(!1))):c),[o,c]);return(0,r.createElement)(r.Fragment,null,(0,r.createElement)("header",null,(0,r.createElement)("div",{className:"block-info"},(0,r.createElement)("h3",null,(0,fe.\_\_)("Available Blocks","content-control")),(0,r.createElement)("p",null,(0,fe.\_\_)("Control which blocks controls will be available for.","content-control"))),(0,r.createElement)("div",{className:"block-search"},(0,r.createElement)(we.Icon,{icon:Ie}),(0,r.createElement)(we.TextControl,{placeholder:(0,fe.\_\_)("Search Blocks…","content-control"),value:o,onChange:l}),(0,r.createElement)(we.Flex,{justify:"space-around"},(0,r.createElement)(we.Button,{variant:"link",onClick:()=>{const n=s.map((e=>e.name)).filter((t=>a(t)&&e.includes(t)));t({excludedBlocks:e.filter((e=>!n.includes(e)))})}},(0,fe.\_\_)("Enable All","content-control")),(0,r.createElement)(we.Button,{variant:"link",onClick:()=>{const n=s.map((e=>e.name)).filter((t=>!a(t)&&!e.includes(t)));t({excludedBlocks:[...e.filter((e=>!n.includes(e))),...n]})}},(0,fe.\_\_)("Disable All","content-control"))))),(0,r.createElement)("div",{className:"block-list"},c.length>0?s.map((({name:n,title:o,description:l})=>{const c=a(n);return(0,r.createElement)("div",{key:n,className:Ee()("block-list-item",c&&"is-disabled")},(0,r.createElement)("div",{className:"block-icon"},(0,r.createElement)(we.Icon,{icon:ye.block,size:30})),(0,r.createElement)("div",{className:"block-info"},(0,r.createElement)("h4",{className:"block-name"},o),l&&(0,r.createElement)("p",{className:"block-description"},l)),(0,r.createElement)("div",{className:"block-toggle"},(0,r.createElement)(we.ToggleControl,{label:c?(0,fe.\_\_)("Disabled","content-control"):(0,fe.\_\_)("Enabled","content-control"),hideLabelFromVision:!0,checked:!c,onChange:()=>{return t({excludedBlocks:a(o=n)?e.filter((e=>o!==e)):[...e,o]});var o}})))})):(0,r.createElement)(we.Notice,{status:"warning",isDismissible:!1},(0,fe.\_\_)("If there are no blocks shown when you load this page, you may need to open the editor for a few different pages & posts to index the list of block types.","content-control"))))},Vt=()=>{const[,e]=ue({tab:z,view:z}),{settings:t,stageUnsavedChanges:n}=(0,Ce.useSettings)(),o=(0,be.applyFilters)("contentControl.settingsPage.customMediaQueries",[{id:"mobile",name:(0,fe.\_\_)("Mobile","content-control"),description:"",type:"\_\_built\_in"},{id:"tablet",name:(0,fe.\_\_)("Tablet","content-control"),description:"",type:"\_\_built\_in"},{id:"desktop",name:(0,fe.\_\_)("Desktop","content-control"),description:"",type:"\_\_built\_in"}]);return(0,r.createElement)(r.Fragment,null,o.map((({id:e,name:o,description:l,type:a})=>{var c;const s=null!==(c=t.mediaQueries?.[e])&&void 0!==c?c:{},{override:i=!1,breakpoint:u=""}=s;return(0,r.createElement)("div",{key:o,className:"field-group"},(0,r.createElement)("div",{className:"field-group\_\_label"},(0,r.createElement)("h3",null,o),l&&(0,r.createElement)("p",null,l)),(0,r.createElement)("div",{className:"field-group\_\_controls"},(0,r.createElement)(we.ToggleControl,{label:(0,fe.\_\_)("Customize Breakpoint","content-control"),checked:i,onChange:o=>n({mediaQueries:{...t.mediaQueries,[e]:{...s,override:o}}})}),i&&(0,r.createElement)(we.TextControl,{type:"number",label:(0,fe.\_\_)("Breakpoint (px)","content-control"),autoComplete:"off",value:u,onChange:o=>n({mediaQueries:{...t.mediaQueries,[e]:{...s,breakpoint:parseInt(o)}}})})))})),!1)},zt=()=>{const e=(0,be.applyFilters)("contentControl.settingsPage.blockControlSections",[{name:"media-queries",title:(0,fe.\_\_)("Device & Media Queries","content-control"),icon:ye.monitor,comp:Vt},{name:"block-manager",title:(0,fe.\_\_)("Block Manager","content-control"),icon:ye.blockManager,comp:Ut}]);return(0,r.createElement)(r.Fragment,null,e.map((({name:e,title:t,badge:n,icon:o,comp:l})=>(0,r.createElement)(At,{key:e,name:e,badge:n,title:t,icon:o},l?(0,r.createElement)(l,null):t))))};const{rolesAndCaps:It}=contentControlSettingsPage,jt=(()=>{const e=[];return Object.entries(It).forEach((([t,{name:n}])=>{void 0===e.find((e=>e.value===t))&&e.push({label:n,value:t})})),Object.values(I~~t).forEach((({capabilities:t})=>{Object.keys(t).forEach((t=>{void 0===e.find((({value:e})=>t===e))&&e.push({label:t,value:t})}))})),e})();var Ht=()=>{const{settings:e,stageUnsavedChanges:t}=(0,Ce.useSettings)(),n=(0,be.applyFilters)("contentControl.settingsPage.pluginPermissionLabels",[{name:"view\_block\_controls",label:(0,fe.\_\_)("View Block Controls","content-control"),default:"edit\_posts",description:(0,fe.\_\_)("Choose who can view block controls in the block editor. These users will see the settings created by others.","content-control")},{name:"edit\_block\_controls",label:(0,fe.\_\_)("Edit Block Controls","content-control"),default:"edit\_posts",description:(0,fe.\_\_)("Choose who can edit block controls in the block editor. Users with this role can add or edit controls on blocks.","content-control")},{name:"edit\_restrictions",label:(0,fe.\_\_)("Edit Restriction","content-control"),default:"manage\_options",description:(0,fe.\_\_)("Choose who can manage global restrictions. These users can create, edit, and delete restrictions.","content-control")},{name:"manage\_settings",label:(0,fe.\_\_)("Manage Settings","content-control"),default:"manage\_options",description:(0,fe.\_\_)("Choose who can manage the plugin settings. These users will see the settings page and can change the plugin settings.","content-control")}]),o=(n,o)=>{t({permissions:{...e.permissions,[n]:o}})};return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.Notice,{status:"warning",isDismissible:!1},(0,r.createElement)(we.Icon,{icon:"warning"})," ",(0,fe.\_\_)("Note: Administrators always have access.","content-control")),n.map((({name:t,label:n,description:l,default:a})=>{const c=e?.permissions?.[t],s=void 0!==jt.find((({value:e})=>e===c)),i=c&&!s;return(0,r.createElement)("div",{key:t,className:"field-group"},(0,r.createElement)("div",{className:"field-group\_\_label"},(0,r.createElement)("h3",null,n),l&&(0,r.createElement)("p",null,l)),(0,r.createElement)("div",{className:"field-group\_\_controls"},(0,r.createElement)(we.ToggleControl,{label:(0,fe.sprintf)( |
  |  | 22 | (0,fe.\_n)("%d Restriction imported successfully.","%d Restrictions imported successfully.",c,"content-control"),c),isDismissible:!0,closeDelay:5e3})};return(0,r.createElement)(we.Dropdown,{className:"list-table-options-menu",contentClassName:"list-table-options-menu\_\_popover",placement:"bottom left",focusOnMount:"firstElement",popoverProps:{noArrow:!1},renderToggle:({isOpen:e,onToggle:t})=>(0,r.createElement)(we.Button,{className:"popover-toggle","aria-label":(0,fe.\_\_)("Additional options","content-control"),onClick:t,"aria-expanded":e,icon:xt}),renderContent:({onClose:e})=>(0,r.createElement)(we.NavigableMenu,{orientation:"vertical"},(0,r.createElement)(we.FormFileUpload,{icon:Nt,text:(0,fe.\_\_)("Import","content-control"),accept:"text/json",onChange:t=>{var n;const r=null!==(n=t.currentTarget.files?.length)&&void 0!==n?n:0;for(let e=0;e<r;e++)t.currentTarget.files?.[e].text().then(o);e()}}))})},Rt=()=>{const{setEditorId:e}=Ie(),[t,n]=(0,\_e.useState)(!1),[o,l]=(0,\_e.useState)(),a=()=>l(void 0);return(0,r.createElement)(mt,null,(0,r.createElement)(dt,null,(({isLoading:c,isDeleting:s,bulkSelection:i=[],setBulkSelection:u=Ve.noop,filteredRestrictions:d=[],updateRestriction:m=Ve.noop,deleteRestriction:p=Ve.noop,increasePriority:g=Ve.noop,decreasePriority:h=Ve.noop,filters:{searchText:\_=""},setFilters:v})=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(Se.ConfirmDialogue,{...o,onClose:a}),(0,r.createElement)("div",{className:"list-table-container"},c&&(0,r.createElement)("div",{className:"is-loading"},(0,r.createElement)(we.Spinner,null)),(0,r.createElement)("div",{className:"list-table-header"},(0,r.createElement)("div",{className:"list-search"},(0,r.createElement)(we.Icon,{icon:ze}),(0,r.createElement)(we.TextControl,{placeholder:(0,fe.\_\_)("Search Restrictions…","content-control"),value:null!=\_?\_:"",onChange:e=>v({searchText:""!==e?e:void 0})})),(0,r.createElement)(yt,null),0===i.length&&(0,r.createElement)(we.Button,{className:"filters-toggle",variant:"secondary",onClick:()=>{n(!t)},"aria-expanded":t,icon:ye.filterLines,iconSize:20,text:t?(0,fe.\_\_)("Hide Filters","content-control"):(0,fe.\_\_)("Filters","content-control")}),(0,r.createElement)(Pt,null)),t&&(0,r.createElement)(kt,null),(0,r.createElement)(Se.ListTable,{selectedItems:i,onSelectItems:e=>u(e),items:c?[]:d,columns:{enabled:()=>(0,r.createElement)(we.Tooltip,{text:(0,fe.\_\_)("Enable or disable the restriction","content-control"),position:"top right"},(0,r.createElement)("span",null,(0,r.createElement)(we.Icon,{icon:ot}))),title:(0,fe.\_\_)("Name","content-control"),description:(0,fe.\_\_)("Description","content-control"),restrictedTo:(0,fe.\_\_)("Restricted to","content-control"),status:(0,fe.\_\_)("Status","content-control"),roles:(0,fe.\_\_)("Roles","content-control"),priority:(0,fe.\_\_)("Priority","content-control")},sortableColumns:["priority","title"],rowClasses:e=>[`restriction-${e.id}`,`status-${e.status}`],renderCell:(t,n)=>{var o,a,c;const i=n.status,u="trash"===i,\_="publish"===i;switch(t){case"enabled":return(0,r.createElement)(we.ToggleControl,{label:"","aria-label":(0,fe.\_\_)("Enable or disable the restriction","content-control"),checked:\_,disabled:u,onChange:e=>{m({...n,status:e?"publish":"draft"})}});case"status":return u?(0,r.createElement)(we.Icon,{"aria-label":(0,fe.\_\_)("In Trash","content-control"),icon:rt,size:20}):(0,r.createElement)("span",null,\_?(0,fe.\_\_)("Enabled","content-control"):(0,fe.\_\_)("Disabled","content-control"));case"title":return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.Button,{variant:"link",onClick:()=>e(n.id)},n.title),(0,r.createElement)("div",{className:"item-actions"},`${(0,fe.\_\_)("ID","content-control")}: ${n.id}`,(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Edit","content-control"),variant:"link",onClick:()=>e(n.id)}),(0,r.createElement)(we.Button,{text:u?(0,fe.\_\_)("Untrash","content-control"):(0,fe.\_\_)("Trash","content-control"),variant:"link",isDestructive:!0,isBusy:!!s,onClick:()=>u?m({...n,status:"draft"}):p(n.id)}),u&&(0,r.createElement)(we.Button,{text:(0,fe.\_\_)("Delete Permanently","content-control"),variant:"link",isDestructive:!0,isBusy:!!s,onClick:()=>l({message:(0,fe.\_\_)("Are you sure you want to premanently delete this restriction?"),callback:()=>{p(n.id,!0)},isDestructive:!0})})));case"restrictedTo":return"logged\_in"===n.settings.userStatus?(0,r.createElement)(we.Flex,null,(0,r.createElement)(we.Icon,{icon:ye.lockedUser,size:20}),(0,r.createElement)("span",null,(0,fe.\_\_)("Logged in users","content-control"))):(0,r.createElement)(we.Flex,null,(0,r.createElement)(we.Icon,{icon:ye.incognito,size:20}),(0,r.createElement)("span",null,(0,fe.\_\_)("Logged out users","content-control")));case"roles":{const{userRoles:e,userStatus:t,roleMatch:o="any"}=n.settings;return"logged\_out"===t||"any"===o||0===e.length?(0,r.createElement)(we.Flex,null,(0,r.createElement)("span",null,(0,fe.\_\_)("Everyone","content-control"))):(0,r.createElement)(we.Flex,null,"exclude"===o&&(0,fe.\_n)("Exclude:","Excludes:",e.length,"content-control"),e.slice(0,2).map((e=>(0,r.createElement)("span",{key:e},e))),e.length>2&&(0,r.createElement)("span",{className:"remaining"},"+"+(e.length-2)))}case"priority":return(0,r.createElement)(we.Flex,{gap:0},(0,r.createElement)("strong",null,(null!==(o=n.priority)&&void 0!==o?o:0)+1),(0,r.createElement)(we.Button,{className:"priority-up",variant:"link",disabled:0===n.priority,iconSize:18,icon:lt,onClick:()=>{g(n.priority)}}),(0,r.createElement)(we.Button,{className:"priority-down",variant:"link",disabled:d.length-1===n.priority,iconSize:18,icon:at,onClick:()=>{h(n.priority)}}));default:return null!==(a=null!==(c=n[t])&&void 0!==c?c:n.settings[t])&&void 0!==a?a:""}}}))))))},Tt=()=>{const e=(0,\_e.useRef)({}),{notices:t}=(0,he.useSelect)((e=>({notices:e(Ce.restrictionsStore).getNotices()})),[]),{clearNotice:n}=(0,he.useDispatch)(Ce.restrictionsStore),o=(0,\_e.useCallback)((t=>{e.current[t]&&(clearTimeout(e.current[t]),delete e.current[t]),n(t)}),[n]);return(0,\_e.useLayoutEffect)((()=>{t.forEach((t=>{if(t.closeDelay){if(e.current[t.id])return;e.current[t.id]=setTimeout((()=>{o(t.id)}),t.closeDelay)}}))}),[t,o]),t.length?(0,r.createElement)("div",{className:"notices"},t.map((e=>(0,r.createElement)(we.Notice,{key:e.id,status:e.type,isDismissible:e.isDismissible,onRemove:()=>o(e.id)},e.message)))):null};const{hasSettingsUpgrades:Lt,hasRestrictionUpgrades:Mt}=contentControlSettingsPage;var Bt=e=>{const{type:t}=e,n="settings"===t?Lt:Mt;return(0,r.createElement)(r.Fragment,null,n&&(0,r.createElement)("div",{className:"has-upgrades"},(0,r.createElement)("span",null,(()=>{switch(t){case"settings":return(0,fe.\_\_)("You have upgrades available for your plugin settings.","content-control");case"restrictions":return(0,fe.\_\_)("You have upgrades available for your restrictions.","content-control");default:return""}})()," ⤴")))};const{permissions:{edit\_restrictions:Dt}}=contentControlSettingsPage;var Ft=()=>{const e=(0,he.useSelect)((e=>e(Ce.restrictionsStore).isEditorActive()),[]);return Dt?(0,r.createElement)("div",{className:"restriction-list"},(0,r.createElement)(Bt,{type:"restrictions"}),(0,r.createElement)(Tt,null),(0,r.createElement)(nt,null),(0,r.createElement)(Rt,null),e&&(0,r.createElement)(tt,null)):(0,r.createElement)("div",{className:"restriction-list permission-denied"},(0,r.createElement)(Tt,null),(0,r.createElement)("h3",null,(0,fe.\_\_)("Permission Denied","content-control")),(0,r.createElement)("p",null,(0,r.createElement)("strong",null,(0,fe.\_\_)("You do not have permission to manage Content Control settings.","content-control"))))},At=({tabs:e})=>{const[t,n]=me("tab",V),{isSaving:o,saveSettings:l,hasUnsavedChanges:a}=(0,Ce.useSettings)();return(0,r.createElement)("div",{className:"cc-settings-view\_\_header"},(0,r.createElement)("div",{className:"header-top-bar"},(0,r.createElement)("h1",{className:"wp-heading-inline"},(0,fe.\_\_)("Settings","content-control")),(0,r.createElement)(we.Button,{variant:"primary",disabled:o||!a,className:"save-settings",onClick:()=>l()},o&&(0,r.createElement)(we.Spinner,null),(0,fe.\_\_)("Save Settings","content-control"))),(0,r.createElement)(Se.ControlledTabPanel,{className:"tabs",orientation:"horizontal",selected:null!==t?t:void 0,onSelect:t=>{const o=e.find((e=>e.name===t));o?.onClick&&!1===o.onClick()||n(t)},tabs:e},(()=>(0,r.createElement)(r.Fragment,null))))},Ot=({name:e,title:t,badge:n,icon:o,children:l})=>(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.Panel,{className:Ee()("settings-section-panel",e?`settings-section-panel--${e}`:"")},(0,r.createElement)("div",{className:"components-panel\_\_header"},o&&(0,r.createElement)("span",{className:"panel-icon"},(0,r.createElement)(we.Icon,{icon:o})),(0,r.createElement)("span",{className:"panel-title"},t),n&&(0,r.createElement)("span",{className:"panel-badge"},n)),(0,r.createElement)(we.PanelBody,null,l))),It=()=>{const{settings:{excludedBlocks:e=[]},stageUnsavedChanges:t}=(0,Ce.useSettings)(),{knownBlockTypes:n=[]}=(0,he.useSelect)((e=>({knownBlockTypes:e(Ce.settingsStore).getKnownBlockTypes()})),[]),[o,l]=(0,\_e.useState)(""),a=t=>e?.indexOf(t)>=0,c=(0,be.applyFilters)("contentControl.settingsPage.knownBlockTypes",n),s=(0,\_e.useMemo)((()=>o&&0!==o.length?c.filter((({title:e,description:t="",keywords:n,category:r=""})=>-1===[...o.split(" ").map((o=>{const l=o.trim().toLowerCase();return e.trim().toLowerCase().indexOf(l)>=0||t.trim().toLowerCase().indexOf(l)>=0||r.trim().toLowerCase().indexOf(l)>=0||void 0!==n?.find((e=>e.trim().toLowerCase().indexOf(l)>=0))}))].indexOf(!1))):c),[o,c]);return(0,r.createElement)(r.Fragment,null,(0,r.createElement)("header",null,(0,r.createElement)("div",{className:"block-info"},(0,r.createElement)("h3",null,(0,fe.\_\_)("Available Blocks","content-control")),(0,r.createElement)("p",null,(0,fe.\_\_)("Control which blocks controls will be available for.","content-control"))),(0,r.createElement)("div",{className:"block-search"},(0,r.createElement)(we.Icon,{icon:ze}),(0,r.createElement)(we.TextControl,{placeholder:(0,fe.\_\_)("Search Blocks…","content-control"),value:o,onChange:l}),(0,r.createElement)(we.Flex,{justify:"space-around"},(0,r.createElement)(we.Button,{variant:"link",onClick:()=>{const n=s.map((e=>e.name)).filter((t=>a(t)&&e.includes(t)));t({excludedBlocks:e.filter((e=>!n.includes(e)))})}},(0,fe.\_\_)("Enable All","content-control")),(0,r.createElement)(we.Button,{variant:"link",onClick:()=>{const n=s.map((e=>e.name)).filter((t=>!a(t)&&!e.includes(t)));t({excludedBlocks:[...e.filter((e=>!n.includes(e))),...n]})}},(0,fe.\_\_)("Disable All","content-control"))))),(0,r.createElement)("div",{className:"block-list"},c.length>0?s.map((({name:n,title:o,description:l})=>{const c=a(n);return(0,r.createElement)("div",{key:n,className:Ee()("block-list-item",c&&"is-disabled")},(0,r.createElement)("div",{className:"block-icon"},(0,r.createElement)(we.Icon,{icon:ye.block,size:30})),(0,r.createElement)("div",{className:"block-info"},(0,r.createElement)("h4",{className:"block-name"},o),l&&(0,r.createElement)("p",{className:"block-description"},l)),(0,r.createElement)("div",{className:"block-toggle"},(0,r.createElement)(we.ToggleControl,{label:c?(0,fe.\_\_)("Disabled","content-control"):(0,fe.\_\_)("Enabled","content-control"),hideLabelFromVision:!0,checked:!c,onChange:()=>{return t({excludedBlocks:a(o=n)?e.filter((e=>o!==e)):[...e,o]});var o}})))})):(0,r.createElement)(we.Notice,{status:"warning",isDismissible:!1},(0,fe.\_\_)("If there are no blocks shown when you load this page, you may need to open the editor for a few different pages & posts to index the list of block types.","content-control"))))},Ut=()=>{const[,e]=ue({tab:V,view:V}),{settings:t,stageUnsavedChanges:n}=(0,Ce.useSettings)(),o=(0,be.applyFilters)("contentControl.settingsPage.customMediaQueries",[{id:"mobile",name:(0,fe.\_\_)("Mobile","content-control"),description:"",type:"\_\_built\_in"},{id:"tablet",name:(0,fe.\_\_)("Tablet","content-control"),description:"",type:"\_\_built\_in"},{id:"desktop",name:(0,fe.\_\_)("Desktop","content-control"),description:"",type:"\_\_built\_in"}]);return(0,r.createElement)(r.Fragment,null,o.map((({id:e,name:o,description:l,type:a})=>{var c;const s=null!==(c=t.mediaQueries?.[e])&&void 0!==c?c:{},{override:i=!1,breakpoint:u=""}=s;return(0,r.createElement)("div",{key:o,className:"field-group"},(0,r.createElement)("div",{className:"field-group\_\_label"},(0,r.createElement)("h3",null,o),l&&(0,r.createElement)("p",null,l)),(0,r.createElement)("div",{className:"field-group\_\_controls"},(0,r.createElement)(we.ToggleControl,{label:(0,fe.\_\_)("Customize Breakpoint","content-control"),checked:i,onChange:o=>n({mediaQueries:{...t.mediaQueries,[e]:{...s,override:o}}})}),i&&(0,r.createElement)(we.TextControl,{type:"number",label:(0,fe.\_\_)("Breakpoint (px)","content-control"),autoComplete:"off",value:u,onChange:o=>n({mediaQueries:{...t.mediaQueries,[e]:{...s,breakpoint:parseInt(o)}}})})))})),!1)},Vt=()=>{const e=(0,be.applyFilters)("contentControl.settingsPage.blockControlSections",[{name:"media-queries",title:(0,fe.\_\_)("Device & Media Queries","content-control"),icon:ye.monitor,comp:Ut},{name:"block-manager",title:(0,fe.\_\_)("Block Manager","content-control"),icon:ye.blockManager,comp:It}]);return(0,r.createElement)(r.Fragment,null,e.map((({name:e,title:t,badge:n,icon:o,comp:l})=>(0,r.createElement)(Ot,{key:e,name:e,badge:n,title:t,icon:o},l?(0,r.createElement)(l,null):t))))};const{rolesAndCaps:zt}=contentControlSettingsPage,jt=(()=>{const e=[];return Object.entries(zt).forEach((([t,{name:n}])=>{void 0===e.find((e=>e.value===t))&&e.push({label:n,value:t})})),Object.values(zt).forEach((({capabilities:t})=>{Object.keys(t).forEach((t=>{void 0===e.find((({value:e})=>t===e))&&e.push({label:t,value:t})}))})),e})();var Ht=()=>{const{settings:e,stageUnsavedChanges:t}=(0,Ce.useSettings)(),n=(0,be.applyFilters)("contentControl.settingsPage.pluginPermissionLabels",[{name:"view\_block\_controls",label:(0,fe.\_\_)("View Block Controls","content-control"),default:"edit\_posts",description:(0,fe.\_\_)("Choose who can view block controls in the block editor. These users will see the settings created by others.","content-control")},{name:"edit\_block\_controls",label:(0,fe.\_\_)("Edit Block Controls","content-control"),default:"edit\_posts",description:(0,fe.\_\_)("Choose who can edit block controls in the block editor. Users with this role can add or edit controls on blocks.","content-control")},{name:"edit\_restrictions",label:(0,fe.\_\_)("Edit Restriction","content-control"),default:"manage\_options",description:(0,fe.\_\_)("Choose who can manage global restrictions. These users can create, edit, and delete restrictions.","content-control")},{name:"manage\_settings",label:(0,fe.\_\_)("Manage Settings","content-control"),default:"manage\_options",description:(0,fe.\_\_)("Choose who can manage the plugin settings. These users will see the settings page and can change the plugin settings.","content-control")}]),o=(n,o)=>{t({permissions:{...e.permissions,[n]:o}})};return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.Notice,{status:"warning",isDismissible:!1},(0,r.createElement)(we.Icon,{icon:"warning"})," ",(0,fe.\_\_)("Note: Administrators always have access.","content-control")),n.map((({name:t,label:n,description:l,default:a})=>{const c=e?.permissions?.[t],s=void 0!==jt.find((({value:e})=>e===c)),i=c&&!s;return(0,r.createElement)("div",{key:t,className:"field-group"},(0,r.createElement)("div",{className:"field-group\_\_label"},(0,r.createElement)("h3",null,n),l&&(0,r.createElement)("p",null,l)),(0,r.createElement)("div",{className:"field-group\_\_controls"},(0,r.createElement)(we.ToggleControl,{label:(0,fe.sprintf)( |
  | 23 | 23 | // translators: %s: default capability |
  | 24 |  | (0,fe.\_\_)("Override the default (%s)","content-control"),a),checked:!!c,onChange:e=>o(t,!!e&&a)}),c&&(0,r.createElement)(we.ComboboxControl,{"aria-label":(0,fe.\_\_)("Choose the role or cap to use","content-control"),value:i?"other":null!=c?c:a,onChange:e=>o(t,"other"===e?"custom\_cap":null!=e?e:a),options:[...jt,{label:(0,fe.\_\_)("Other (custom)","content-control"),value:"other"}]}),i&&(0,r.createElement)(we.TextControl,{label:(0,fe.\_\_)("Enter custom role or cap here","content-control"),help:(0,fe.\_\_)("Be certain you know what you are doing, this can prevent you from accessing the given feature.","content-control"),value:c,onChange:e=>o(t,e)})))})))};const{logUrl:$t=!1}=contentControlSettingsPage;var Gt=()=>{const[e,t]=(0,\_e.useState)("");return(0,\_e.useEffect)((()=>{!1!==$t&&$t.length&&fetch($t).then((e=>e.text())).then((e=>t(e))).catch((e=>console.error(e)))}),[]),(0,r.createElement)(we.TextareaControl,{label:"Log Contents",value:e,onChange:e=>t(e)})},Wt=()=>{const{settings:e,stageUnsavedChanges:t}=(0,Ce.useSettings)(),{defaultDenialMessage:n,excludeAdmins:o}=e;return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.TextareaControl,{label:(0,fe.\_\_)("Default Denial Message","content-control"),help:(0,fe.\_\_)("This message will be shown to users when they do not have access to content.","content-control"),value:n,onChange:e=>t({defaultDenialMessage:e})}),(0,r.createElement)(we.CheckboxControl,{label:(0,fe.\_\_)("Exclude administrators from being restricted.","content-control"),help:(0,fe.\_\_)("Administrators will not be restricted by any restrictions.","content-control"),checked:o,onChange:e=>t({excludeAdmins:e})}))};const{logUrl:qt=!1}=contentControlSettingsPage;(0,be.addFilter)("contentControl.settingsPage.generalSections","content-control/general-settings/restriction-options",(e=>[...e,{name:"restrictions",title:(0,fe.\_\_)("Restriction Settings","content-control"),icon:ye.permissions,comp:Wt}]),5),(0,be.addFilter)("contentControl.settingsPage.generalSections","content-control/general-settings/permissions-options",(e=>[...e,{name:"permissions",title:(0,fe.\_\_)("Plugin Permissions","content-control"),icon:ye.permissions,comp:Ht}]),10),(0,be.addFilter)("contentControl.settingsPage.generalSections","content-control/general-settings/log-viewer",(e=>[...e,!1!==qt&&{name:"log",title:(0,fe.\_\_)("Log Viewer","content-control"),icon:"editor-code",comp:Gt}]),50);var Qt=()=>{const e=(0,be.applyFilters)("contentControl.settingsPage.generalSections",[]);return(0,r.createElement)(r.Fragment,null,e.map((({name:e,title:t,badge:n,icon:o,comp:l})=>(0,r.createElement)(~~A~~t,{key:e,name:e,badge:n,title:t,icon:o},l?(0,r.createElement)(l,null):t))))},Yt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})),Kt=()=>(0,r.createElement)("div",{className:"upgrade-features"},(0,r.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:(0,fe.sprintf)( |
  |  | 24 | (0,fe.\_\_)("Override the default (%s)","content-control"),a),checked:!!c,onChange:e=>o(t,!!e&&a)}),c&&(0,r.createElement)(we.ComboboxControl,{"aria-label":(0,fe.\_\_)("Choose the role or cap to use","content-control"),value:i?"other":null!=c?c:a,onChange:e=>o(t,"other"===e?"custom\_cap":null!=e?e:a),options:[...jt,{label:(0,fe.\_\_)("Other (custom)","content-control"),value:"other"}]}),i&&(0,r.createElement)(we.TextControl,{label:(0,fe.\_\_)("Enter custom role or cap here","content-control"),help:(0,fe.\_\_)("Be certain you know what you are doing, this can prevent you from accessing the given feature.","content-control"),value:c,onChange:e=>o(t,e)})))})))};const{logUrl:$t=!1}=contentControlSettingsPage;var Gt=()=>{const[e,t]=(0,\_e.useState)("");return(0,\_e.useEffect)((()=>{!1!==$t&&$t.length&&fetch($t).then((e=>e.text())).then((e=>t(e))).catch((e=>console.error(e)))}),[]),(0,r.createElement)(we.TextareaControl,{label:"Log Contents",value:e,onChange:e=>t(e)})},Wt=()=>{const{settings:e,stageUnsavedChanges:t}=(0,Ce.useSettings)(),{defaultDenialMessage:n,excludeAdmins:o}=e;return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.TextareaControl,{label:(0,fe.\_\_)("Default Denial Message","content-control"),help:(0,fe.\_\_)("This message will be shown to users when they do not have access to content.","content-control"),value:n,onChange:e=>t({defaultDenialMessage:e})}),(0,r.createElement)(we.CheckboxControl,{label:(0,fe.\_\_)("Exclude administrators from being restricted.","content-control"),help:(0,fe.\_\_)("Administrators will not be restricted by any restrictions.","content-control"),checked:o,onChange:e=>t({excludeAdmins:e})}))};const{logUrl:qt=!1}=contentControlSettingsPage;(0,be.addFilter)("contentControl.settingsPage.generalSections","content-control/general-settings/restriction-options",(e=>[...e,{name:"restrictions",title:(0,fe.\_\_)("Restriction Settings","content-control"),icon:ye.permissions,comp:Wt}]),5),(0,be.addFilter)("contentControl.settingsPage.generalSections","content-control/general-settings/permissions-options",(e=>[...e,{name:"permissions",title:(0,fe.\_\_)("Plugin Permissions","content-control"),icon:ye.permissions,comp:Ht}]),10),(0,be.addFilter)("contentControl.settingsPage.generalSections","content-control/general-settings/log-viewer",(e=>[...e,!1!==qt&&{name:"log",title:(0,fe.\_\_)("Log Viewer","content-control"),icon:"editor-code",comp:Gt}]),50);var Qt=()=>{const e=(0,be.applyFilters)("contentControl.settingsPage.generalSections",[]);return(0,r.createElement)(r.Fragment,null,e.map((({name:e,title:t,badge:n,icon:o,comp:l})=>(0,r.createElement)(Ot,{key:e,name:e,badge:n,title:t,icon:o},l?(0,r.createElement)(l,null):t))))},Yt=(0,r.createElement)(ke.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,r.createElement)(ke.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})),Kt=()=>(0,r.createElement)("div",{className:"upgrade-features"},(0,r.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:(0,fe.sprintf)( |
  | 25 | 25 | // translators: %s: Upgrade link. |
  | 26 |  | (0,fe.\_\_)('To unlock the following features, <a href="%s" target="\_blank">upgrade to Pro</a> and enter your license key above.',"content-control"),"https://contentcontrolplugin.com/pricing/?utm\_campaign=upgrade-to-pro&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-tab-upgrade-text")}}),(0,r.createElement)(we.Flex,{justify:"flex-start",align:"flex-start",wrap:!1,gap:10},(0,r.createElement)(we.Flex,{direction:"column",style:{maxWidth:"40%"}},(0,r.createElement)("div",{className:"upgrade-notice\_\_feature"},(0,r.createElement)("h3",null,"Monetizing Content Has Never Been So Easy"),(0,r.createElement)("ul",null,(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Content Teasers: "),"Effortlessly create engaging, high-quality content teasers akin to those seen in the New York Times or WSJ."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"WooCommerce Integration: "),"Build exclusive membership sites and tailor content access based on user purchase history, cart contents, and more."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Easy Digital Downloads: "),"Limit access to users with active licenses or subscriptions, adding an extra layer of content protection."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Enhanced User Restrictions:"),"Expand control beyond standard logins & user roles for more precise management."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Customized Login URLs: "),"Redirect users seamlessly to tailored login and registration pages, enhancing user experience and site security.")))),(0,r.createElement)(we.Flex,{direction:"column",style:{maxWidth:"40%"}},(0,r.createElement)("div",{className:"upgrade-notice\_\_feature"},(0,r.createElement)("h3",null,"Advanced Block Controls:"),(0,r.createElement)("ul",null,(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Block Scheduling: "),"Schedule content blocks for specific dates, times, or on a recurring basis, ensuring your site stays dynamic and relevant."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"WooCommerce Rules: "),"Utilize rules based on customer purchase history or subscription status for targeted content delivery."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Easy Digital Download Rules: "),"Manage content access based on digital cart contents and purchase history for a more personalized user experience."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Boolean Logic: "),"Employ AND, OR, NOT operations to create sophisticated and tailored content rules."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"More Rules: "),"Advanced rule types, giving you unparalleled control over your content.")))))),Jt=()=>{const{connectInfo:e,licenseKey:t,licenseStatus:n,isSaving:o,activateLicense:l,deactivateLicense:a,checkLicenseStatus:c,removeLicense:s,~~getLicenseStatusName:i,isLicenseKeyValid:u,isLicenseActive:d,isLicenseDeactivated:m,isLicenseMissing:p,isLicenseExpired:g,isLicenseOverQuota:h,isLicenseDisabled:\_,hasError:v}=(0,Ce.useLicense)(),{expires:E,error\_message:f}=n,[b,y]=(0,\_e.useState)(t),[w,C]=(0,\_e.useState)(!1),S=(0,\_e.useRef)(null),[k,x]=(0,\_e.useState)(!1),N=b!==t;return(0,\_e.useEffect)((()=>{if(void 0===e)return S.current?.close(),void(S.current=null);x(!0),S.current=window.open(e.url,"content-control-license-connect","width=580,height=600");const t=setInterval((()=>{S.current?.closed&&(clearInterval(t),c(),x(!1),setTimeout((()=>{window.location.reload()}),1e3))}),1e3)}),[e,c]),(0,\_e.useEffect)((()=>{N&&y(t)}),[t,N]),(0,\_e.useEffect)((()=>{w&&!o&&C(!1)}),[o,w]),(0,r.createElement)(r.Fragment,null,k&&(0,r.createElement)(we.Popover,{className:"content-control-license-connect-notice",position:"middle center"},(0,r.createElement)("p",null,(0,fe.\_\_)("Please wait while we connect to the license store…","content-control"))),(0,r.createElement)("div",{className:"content-control\_\_upgrade-notice"},(0,r.createElement)("h3",{className:"upgrade-notice\_\_title"},(0,fe.\_\_)("Enter your Content Control License Key","content-control")),(0,r.createElement)("p",{className:"upgrade-notice\_\_description",dangerouslySetInnerHTML:{\_\_html:d~~?(0,fe.\_\_)("You are currently using Content Control Pro. Thanks for supporting us! <span>😄</span>","content-control"):(0,fe.\_\_)("You are currently using Content Control Lite — no license key required. Enjoy! <span>😄</span>","content-control")}}),(0,r.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:(0,fe.sprintf)( |
  |  | 26 | (0,fe.\_\_)('To unlock the following features, <a href="%s" target="\_blank">upgrade to Pro</a> and enter your license key above.',"content-control"),"https://contentcontrolplugin.com/pricing/?utm\_campaign=upgrade-to-pro&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-tab-upgrade-text")}}),(0,r.createElement)(we.Flex,{justify:"flex-start",align:"flex-start",wrap:!1,gap:10},(0,r.createElement)(we.Flex,{direction:"column",style:{maxWidth:"40%"}},(0,r.createElement)("div",{className:"upgrade-notice\_\_feature"},(0,r.createElement)("h3",null,"Monetizing Content Has Never Been So Easy"),(0,r.createElement)("ul",null,(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Content Teasers: "),"Effortlessly create engaging, high-quality content teasers akin to those seen in the New York Times or WSJ."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"WooCommerce Integration: "),"Build exclusive membership sites and tailor content access based on user purchase history, cart contents, and more."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Easy Digital Downloads: "),"Limit access to users with active licenses or subscriptions, adding an extra layer of content protection."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Enhanced User Restrictions:"),"Expand control beyond standard logins & user roles for more precise management."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Customized Login URLs: "),"Redirect users seamlessly to tailored login and registration pages, enhancing user experience and site security.")))),(0,r.createElement)(we.Flex,{direction:"column",style:{maxWidth:"40%"}},(0,r.createElement)("div",{className:"upgrade-notice\_\_feature"},(0,r.createElement)("h3",null,"Advanced Block Controls:"),(0,r.createElement)("ul",null,(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Block Scheduling: "),"Schedule content blocks for specific dates, times, or on a recurring basis, ensuring your site stays dynamic and relevant."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"WooCommerce Rules: "),"Utilize rules based on customer purchase history or subscription status for targeted content delivery."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Easy Digital Download Rules: "),"Manage content access based on digital cart contents and purchase history for a more personalized user experience."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"Boolean Logic: "),"Employ AND, OR, NOT operations to create sophisticated and tailored content rules."),(0,r.createElement)("li",null,(0,r.createElement)(we.Icon,{icon:Yt,size:28}),(0,r.createElement)("strong",null,"More Rules: "),"Advanced rule types, giving you unparalleled control over your content.")))))),Jt=()=>{const{connectInfo:e,licenseKey:t,licenseStatus:n,isSaving:o,activateLicense:l,deactivateLicense:a,checkLicenseStatus:c,removeLicense:s,activatePro:i,isActivatingPro:u,proWasActivated:d,getLicenseStatusName:m,isLicenseKeyValid:p,isLicenseActive:g,isLicenseDeactivated:h,isLicenseMissing:\_,isLicenseExpired:v,isLicenseOverQuota:E,isLicenseDisabled:f,hasError:b}=(0,Ce.useLicense)(),{expires:y,error\_message:w}=n,[C,S]=(0,\_e.useState)(t),[k,x]=(0,\_e.useState)(!1),[N,P]=(0,\_e.useState)(!1),R=(0,\_e.useRef)(null),[T,L]=(0,\_e.useState)(!1),[M,B]=(0,\_e.useState)({installed:"1"===contentControlSettingsPage?.isProInstalled,activated:"1"===contentControlSettingsPage?.isProInstalled&&"1"===contentControlSettingsPage?.isProActivated}),D=C!==t;(0,\_e.useEffect)((()=>{if(void 0===e)return R.current?.close(),void(R.current=null);L(!0),R.current=window.open(e.url,"content-control-license-connect","width=580,height=600");const t=setInterval((()=>{R.current?.closed&&(clearInterval(t),c(),L(!1),setTimeout((()=>{window.location.reload()}),1e3))}),1e3)}),[e,c]),(0,\_e.useEffect)((()=>{d&&setTimeout((()=>{window.location.reload()}),1e3)}),[d]),(0,\_e.useEffect)((()=>{D&&S(t)}),[t,D]),(0,\_e.useEffect)((()=>{k&&!o&&x(!1)}),[o,k]),(0,\_e.useEffect)((()=>{N&&!o&&(P(!1),B({...M,installed:!0}))}),[o,N]);const F=M.installed&&!M.activated;return(0,r.createElement)(r.Fragment,null,T&&(0,r.createElement)(we.Popover,{className:"content-control-license-connect-notice",position:"middle center"},(0,r.createElement)("p",null,(0,fe.\_\_)("Please wait while we connect to the license store…","content-control"))),(0,r.createElement)("div",{className:"content-control\_\_upgrade-notice"},(0,r.createElement)("h3",{className:"upgrade-notice\_\_title"},(0,fe.\_\_)("Enter your Content Control License Key","content-control")),(0,r.createElement)("p",{className:"upgrade-notice\_\_description",dangerouslySetInnerHTML:{\_\_html:g?(0,fe.\_\_)("You are currently using Content Control Pro. Thanks for supporting us! <span>😄</span>","content-control"):(0,fe.\_\_)("You are currently using Content Control Lite — no license key required. Enjoy! <span>😄</span>","content-control")}}),(0,r.createElement)("p",{dangerouslySetInnerHTML:{\_\_html:(0,fe.sprintf)( |
  | 27 | 27 | // translators: 1: opening strong tag, 2: closing strong tag. |
  | 28 |  | (0,fe.\_\_)("Enter your license key below to activate %1$sContent Control Pro%2$s!","content-control"),"<strong>","</strong>")}}),(0,r.createElement)("div",{className:Ee()(["content-control-license-controls","content-control-license-controls--"+~~i])},(0,r.createElement)(we.TextControl,{label:(0,fe.\_\_)("Enter your license key.","content-control"),hideLabelFromVision:!0,placeholder:(0,fe.\_\_)("Paste or enter your license key here.","content-control"),value:u?b.replace(/^(.{3})(.\*)(.{5})$/,((e,t,n,o)=>t+n.replace(/./g,"\*")+o)):b,maxLength:32,width:500,onChange:y,readOnly:w||u,tabIndex:w||u?-1:0,onPaste:e=>{e.preventDefault();const t=e.clipboardData.getData("text");o||(C(!0),l(t),y(t))}}),(0,r.createElement)(we.ButtonGroup,null,(0,r.createElement)(we.Button,{className:"activate-license",variant:"primary",onClick:()=>{C(!0),l(p?b:void 0)},disabled:(o||!N)&&!m,title:(0,fe.\_\_)("Activate","content-control")},w?(0,r.createElement)(r.Fragment,null,(0,r.createElement)("span",null,(0,fe.\_\_)("Activating…","content-control")),(0,r.createElement)(we.Spinner,null)):(0,r.createElement)("span",null,(0,fe.\_\_)("Activate","content-control"))),(0,r.createElement)(we.Button,{className:"deactivate-license",variant:"tertiary",onClick:()=>a(),disabled:o||!d,title:(0,fe.\_\_)("Deactivate","content-control")},(0,r.createElement)("span",null,(0,fe.\_\_)("Deactivate","content-control"))),(0,r.createElement)(we.Button,{className:"remove-license",variant:"tertiary",isDestructive:!0,onClick:()=>s(),disabled:o||!u,title:(0,fe.\_\_)("Delete","content-control")},(0,r.createElement)(we.Icon,{icon:rt}),(0,r.createElement)("span",null,(0,fe.\_\_)("Delete","content-control"))))),(0,r.createElement)("div",{className:"content-control-license-status",dangerouslySetInnerHTML:{\_\_html:p~~?(0,fe.sprintf)( |
  |  | 28 | (0,fe.\_\_)("Enter your license key below to activate %1$sContent Control Pro%2$s!","content-control"),"<strong>","</strong>")}}),(0,r.createElement)("div",{className:Ee()(["content-control-license-controls","content-control-license-controls--"+m])},(0,r.createElement)(we.TextControl,{label:(0,fe.\_\_)("Enter your license key.","content-control"),hideLabelFromVision:!0,placeholder:(0,fe.\_\_)("Paste or enter your license key here.","content-control"),value:p?C.replace(/^(.{3})(.\*)(.{5})$/,((e,t,n,o)=>t+n.replace(/./g,"\*")+o)):C,maxLength:32,width:500,onChange:S,readOnly:k||p,tabIndex:k||p?-1:0,onPaste:e=>{e.preventDefault();const t=e.clipboardData.getData("text");o||(x(!0),l(t),S(t))}}),(0,r.createElement)(we.ButtonGroup,null,g&&(0,r.createElement)(r.Fragment,null,!M.installed&&(0,r.createElement)(we.Button,{className:"install-pro",variant:"primary",onClick:()=>{P(!0),l(\_?C:void 0)},title:(0,fe.\_\_)("Install Pro","content-control")},N?(0,r.createElement)(r.Fragment,null,(0,r.createElement)("span",null,(0,fe.\_\_)("Installing…","content-control")),(0,r.createElement)(we.Spinner,null)):(0,r.createElement)("span",null,(0,fe.\_\_)("Install Pro","content-control"))),F&&(0,r.createElement)(we.Button,{className:"activate-pro",variant:"primary",onClick:()=>{i()},title:(0,fe.\_\_)("Activate Pro","content-control")},u||d?(0,r.createElement)(r.Fragment,null,(0,r.createElement)("span",null,(0,fe.\_\_)("Activating…","content-control")),(0,r.createElement)(we.Spinner,null)):(0,r.createElement)("span",null,(0,fe.\_\_)("Activate Pro","content-control")))),(0,r.createElement)(we.Button,{className:"activate-license",variant:"primary",onClick:()=>{x(!0),l(\_?C:void 0)},disabled:(o||!D)&&!h,title:(0,fe.\_\_)("Activate","content-control")},k?(0,r.createElement)(r.Fragment,null,(0,r.createElement)("span",null,(0,fe.\_\_)("Activating…","content-control")),(0,r.createElement)(we.Spinner,null)):(0,r.createElement)("span",null,(0,fe.\_\_)("Activate","content-control"))),(0,r.createElement)(we.Button,{className:"deactivate-license",variant:"tertiary",onClick:()=>a(),disabled:o||!g,title:(0,fe.\_\_)("Deactivate","content-control")},(0,r.createElement)("span",null,(0,fe.\_\_)("Deactivate","content-control"))),(0,r.createElement)(we.Button,{className:"remove-license",variant:"tertiary",isDestructive:!0,onClick:()=>s(),disabled:o||!p,title:(0,fe.\_\_)("Delete","content-control")},(0,r.createElement)(we.Icon,{icon:rt}),(0,r.createElement)("span",null,(0,fe.\_\_)("Delete","content-control"))))),(0,r.createElement)("div",{className:"content-control-license-status",dangerouslySetInnerHTML:{\_\_html:\_?(0,fe.sprintf)( |
  | 29 | 29 | // translators: 1: opening a tag, 2: closing a tag. |
  | 30 |  | (0,fe.\_\_)("Enter your license key to activate. If you do not have a license key, you can %1$spurchase one here%2$s","content-control"),'<a href="https://contentcontrolplugin.com/pricing/?utm\_campaign=upgrade-to-pro&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-field-upgrade-text" target="\_blank">',"</a>"):~~d~~?(0,fe.sprintf)( |
  |  | 30 | (0,fe.\_\_)("Enter your license key to activate. If you do not have a license key, you can %1$spurchase one here%2$s","content-control"),'<a href="https://contentcontrolplugin.com/pricing/?utm\_campaign=upgrade-to-pro&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-field-upgrade-text" target="\_blank">',"</a>"):g?(0,fe.sprintf)( |
  | 31 | 31 | // translators: 1: date |
  | 32 |  | (0,fe.\_\_)("Your license key is active%1$s. Thank you for supporting Content Control!","content-control"),"lifetime"!==~~E?" until "+new Date(E).toLocaleDateString():" and never expires"):g~~?(0,fe.sprintf)( |
  |  | 32 | (0,fe.\_\_)("Your license key is active%1$s. Thank you for supporting Content Control!","content-control"),"lifetime"!==y?" until "+new Date(y).toLocaleDateString():" and never expires"):v?(0,fe.sprintf)( |
  | 33 | 33 | // translators: 1: date, 2: opening a tag, 3: closing a tag. |
  | 34 |  | (0,fe.\_\_)("Your license key has expired on %1$s. Please %2$srenew your license$3$s to continue receiving updates and support.","content-control"),new Date(~~E).toLocaleDateString(),'<a href="https://contentcontrolplugin.com/checkout/?edd\_license\_key='+t+'&utm\_campaign=renew-license&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-tab-renew-link" target="\_blank">',"</a>"):h~~?(0,fe.sprintf)( |
  |  | 34 | (0,fe.\_\_)("Your license key has expired on %1$s. Please %2$srenew your license$3$s to continue receiving updates and support.","content-control"),new Date(y).toLocaleDateString(),'<a href="https://contentcontrolplugin.com/checkout/?edd\_license\_key='+t+'&utm\_campaign=renew-license&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-tab-renew-link" target="\_blank">',"</a>"):E?(0,fe.sprintf)( |
  | 35 | 35 | // translators: 1: opening a tag, 2: closing a tag, 3: opening a tag, 4: closing a tag. |
  | 36 |  | (0,fe.\_\_)("Your license key has reached its site limit. %1$sUpgrade your license%2$s to add more sites, or %3$slog in%4$s to manage current activations.","content-control"),'<a href="https://contentcontrolplugin.com/checkout/?edd\_license\_key='+t+'&utm\_campaign=upgrade-to-pro&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-tab-upgrade-link" target="\_blank">',"</a>",'<a href="https://contentcontrolplugin.com/your-account/?utm\_campaign=manage-activations&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-tab-login-link" target="\_blank">',"</a>"):~~m?(0,fe.\_\_)("Your license key is currently deactivated. Click the button above to activate now.","content-control"):\_?(0,fe.\_\_)("Your license key has been disabled. Please contact support.","content-control"):v~~?(0,fe.sprintf)( |
  |  | 36 | (0,fe.\_\_)("Your license key has reached its site limit. %1$sUpgrade your license%2$s to add more sites, or %3$slog in%4$s to manage current activations.","content-control"),'<a href="https://contentcontrolplugin.com/checkout/?edd\_license\_key='+t+'&utm\_campaign=upgrade-to-pro&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-tab-upgrade-link" target="\_blank">',"</a>",'<a href="https://contentcontrolplugin.com/your-account/?utm\_campaign=manage-activations&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=license-tab-login-link" target="\_blank">',"</a>"):h?(0,fe.\_\_)("Your license key is currently deactivated. Click the button above to activate now.","content-control"):f?(0,fe.\_\_)("Your license key has been disabled. Please contact support.","content-control"):b?(0,fe.sprintf)( |
  | 37 | 37 | // translators: 1: error message. |
  | 38 |  | (0,fe.\_\_)("Your license key failed to activate with the following error: %1$s","content-control"),~~f):(0,fe.\_\_)("There was an error with your license key. Please check your key and try again.","content-control")}}),!u&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("br",null),(0,r.createElement)("hr",null),(0,r.createElement)(Kt,null))))};(0,be.addFilter)("contentControl.settingsPage.upgradeSections","content-control/general-settings/license-options",(e=>{const{isLicenseActive:t}=(0,Ce.useLicense)();return[...e,{name:"license",title:(0,fe.\_\_)("Pro Licensing","content-control"),badge:(0,r.createElement)(r.Fragment,null,t&&(0,r.createElement)("span",{className:"license-status-bubble"},(0,fe.\_\_)("Activated","content-control"))),icon:ye.licenseKey,comp:Jt}]}),5);var Zt=()=>{const e=(0,be.applyFilters)("contentControl.settingsPage.upgradeSections",[]);return(0,r.createElement)(r.Fragment,null,e.map((({name:e,title:t,badge:n,icon:o,comp:l})=>(0,r.createElement)(At,{key:e,name:e,badge:n,title:t,icon:o},l?(0,r.createElement)(l,null):t))))};const{permissions:{manage\_settings:Xt}}=contentControlSettingsPage;var en=()=>{var e;const[{tab:t="general"}]=ue({tab:z,view:z}),n=(0,be.applyFilters)("contentControl.settingsPage.tabs",[{name:"general",title:(0,fe.\_\_)("General","content-control"),comp:Qt},{name:"block-controls",title:(0,fe.\_\_)("Block Controls","content-control"),comp:zt},{name:"license-and-updates",title:(0,fe.\_\_)("Licensing","content-control"),comp:Zt}]),{title:o,comp:l}=null!==(e=n.find((e=>e.name===t)))&&void 0!==e?e:{};return Xt?(0,r.createElement)("div",{className:Ee()(["cc-settings-view",`tab-${t}`])},(0,r.createElement)("div",{className:"plugin-settings"},(0,r.createElement)(Bt,{type:"settings"}),(0,r.createElement)(Ot,{tabs:n}),(0,r.createElement)("div",{className:"cc-settings-view\_\_content"},l?(0,r.createElement)(l,null):o))):(0,r.createElement)("div",{className:"cc-settings-view permission-denied"},(0,r.createElement)("h3",null,(0,fe.\_\_)("Permission Denied","content-control")),(0,r.createElement)("p",null,(0,r.createElement)("strong",null,(0,fe.\_\_)("You do not have permission to access this page.","content-control"))))};const tn={total:1,progress:0,currentTask:void 0,error:void 0},{hasUpgrades:nn,upgradeNonce:on,upgradeUrl:rn}=contentControlSettingsPage;var ln=()=>{const e=(0,\_e.useRef)(null),[t,n]=(0,\_e.useState)({running:!1,done:!1,logs:[],showLogs:!1,status:tn}),[o,l]=(0,\_e.useState)(-1),{running:a,done:c,logs:s,showLogs:i,status:u}=t,[d]=function(e,t,n=EventSource){const o=(0,r.useRef)(null),[l,a]=(0,r.useState)("init");return(0,r.useEffect)((()=>{if(e){const r=new n(e,{withCredentials:t});return o.current=r,r.addEventListener("open",(()=>a("open"))),r.addEventListener("error",(()=>a("error"))),()=>{o.current=null,r.close()}}a("closed")}),[e,t,n]),[o.current,l]}(a?`${rn}&nonce=${on}`:"",!0);!function(e,t,n,o=[]){(0,r.useEffect)((()=>{if(e)return t.forEach((t=>e.addEventListener(t,n))),()=>t.forEach((t=>e.removeEventListener(t,n)))}),[e,...o])}(d,["upgrades:start","upgrades:progress","upgrades:complete","upgrades:error","task:start","task:progress","task:complete","task:retry","task:error"],(({type:e,data:o})=>{const r=JSON.parse(o),{message:a="",status:c}=r,i={...t,status:c,logs:a.length?[...s,a]:s};switch(e){case"upgrades:start":case"upgrades:progress":case"upgrades:complete":case"task:retry":case"task:start":case"task:complete":case"task:progress":"upgrades:complete"===e&&(i.done=!0,l(15),d?.close()),n(i);break;case"upgrades:error":case"task:error":case"error":console.log("Error:",a,r),"upgrades:error"===e&&(i.done=!0,d?.close(),i.status={...i.status,error:a}),n({...i,logs:[...s,`ERROR: ${a}`,JSON.stringify(r)]});break;default:console.log("Unknown event:",e)}}),[t]);const{total:m,progress:p,currentTask:g}=u,{progress:h=NaN,total:\_=NaN}=g||{};(0,\_e.useEffect)((()=>{a&&c&&o>=0&&(e.current=setTimeout((()=>{0===o?window.location.reload():l(o-1)}),1e3))}),[c,o,a]);const v=p+1,E=m-p-1,f=(0,ze.clamp)(p/m\*100,0,100),b=(0,ze.clamp)(v/m\*100,0,100),y=h/\_,w=f,C=(0,\_e.useMemo)((()=>100-w-E/m\*100),[w,E,m]),S=(0,\_e.useMemo)((()=>u.currentTask?y\*C:0),[y,C,u.currentTask]);return nn?(0,r.createElement)("div",{className:"content-control-upgrades-panel"},a?(0,r.createElement)("div",{className:Ee()(["upgrade-progress",u.error?"upgrade-errors":""])},(0,r.createElement)("div",{className:"upgrade-progress\_\_header"},(0,r.createElement)("h3",{className:"upgrade-progress\_\_title"},(0,fe.\_\_)("Upgrade Progress","content-control")),(0,r.createElement)("div",{className:"upgrade-progress\_\_task-percentage"},c?(0,r.createElement)(we.Button,{onClick:()=>{var t;clearTimeout(null!==(t=e.current)&&void 0!==t?t:0),window.location.reload()},variant:"link"},`${(0,fe.\_\_)("Reload","content-control")} (${o})`):`${Math.round(f)}%`)),(0,r.createElement)("div",{className:"upgrade-progress\_\_bar"},(0,r.createElement)("div",{className:Ee()("upgrade-progress\_\_bar\_\_fill","upgrade-progress\_\_bar\_\_fill--next",b>=100?"complete":""),style:{width:`${b}%`}}),(0,r.createElement)("div",{className:Ee()("upgrade-progress\_\_bar\_\_fill","upgrade-progress\_\_bar\_\_fill--current",f>=100?"complete":""),style:{width:`${f}%`}}),(0,r.createElement)("div",{className:Ee()("upgrade-progress\_\_bar\_\_fill","upgrade-progress\_\_bar\_\_fill--task",y>=1?"complete":""),style:{left:`${w}%`,width:`${(0,ze.clamp)(S,0,100)}%`}},(0,r.createElement)("div",{className:"task-progress"},y>0?Math.round(100\*y):0,"%"))),(0,r.createElement)("div",{className:"upgrade-progress\_\_logs\_\_header"},(0,r.createElement)("div",{className:"upgrade-progress\_\_logs\_\_header\_\_status"},s[s.length-1]),(0,r.createElement)(we.Button,{variant:"link",onClick:()=>{n({...t,showLogs:!i})}},i?(0,fe.\_\_)("Hide Logs","content-control"):(0,fe.\_\_)("Show Logs","content-control"))),i&&(0,r.createElement)("div",{className:"upgrade-progress\_\_logs"},(0,r.createElement)("div",{className:"upgrade-progress\_\_logs\_\_content"},s.map(((e,t)=>(0,r.createElement)("div",{key:t},e)))))):(0,r.createElement)("div",{className:"upgrade-notice"},(0,r.createElement)("div",{className:"notice-icon"},(0,r.createElement)("img",{alt:(0,fe.\_\_)("Content Control requires an upgrade to the database.","content-control"),src:`${contentControlSettingsPage.pluginUrl}assets/images/illustration-check.svg`})),(0,r.createElement)("div",{className:"notice-content"},(0,r.createElement)("h2",null,(0,fe.\_\_)("Content Control requires an upgrade to the database.","content-control")),(0,r.createElement)("p",null,(0,fe.\_\_)("Click the button below to start the upgrade process.","content-control"))),(0,r.createElement)(we.Button,{variant:"secondary",onClick:()=>{n({...t,running:!0})}},(0,fe.\_\_)("Start Upgrades","content-control")))):null};const{permissions:{manage\_settings:an,edit\_restrictions:cn}}=contentControlSettingsPage;var sn=()=>{const{isLicenseActive:e,isLicenseKeyValid:t,licenseLevel:n}=(0,Ce.useLicense)(),[{view:o="restrictions"},l]=ue({tab:z,view:z}),a=(0,\_e.useMemo)((()=>{let a=[];return cn&&a.push({name:"restrictions",title:(0,fe.\_\_)("Restrictions","content-control"),className:"restrictions",pageTitle:(0,fe.\_\_)("Content Control - Global Restrictions","content-control"),heading:(0,fe.\_\_)("Content Control - Global Restrictions","content-control"),comp:Ft}),an&&a.push({name:"settings",title:(0,fe.\_\_)("Settings","content-control"),className:"settings",pageTitle:(0,fe.\_\_)("Content Control - Plugin Settings","content-control"),heading:(0,fe.\_\_)("Plugin Settings","content-control"),comp:en}),a=(0,be.applyFilters)("contentControl.adminViews",[...a,{name:"upgrade",className:"upgrade",title:(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.Icon,{size:20,icon:ye.upgrade}),e?(0,fe.\_\_)("License Status","content-control"):(0,fe.\_\_)("Upgrade to Pro","content-control")),pageTitle:(0,fe.\_\_)("Content Control - Upgrade to Pro","content-control"),heading:(0,fe.\_\_)("Content Control - Upgrade to Pro","content-control"),href:t?void 0:"https://contentcontrolplugin.com/pricing/?utm\_campaign=upgrade-to-pro&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=main-menu-upgrade-button",target:"\_blank",onClick:()=>(l({view:"settings",tab:"license-and-updates"}),!1)}],{view:o,setParams:l,isLicenseActive:e,isLicenseKeyValid:t,licenseLevel:n}),a}),[e,t,n,l]),c=a.find((e=>e.name===o)),s=c?.comp?c.comp:()=>(0,r.createElement)(r.Fragment,null);return(0,\_e.useEffect)((()=>{var e;document.title=null!==(e=a.find((e=>e.name===o))?.pageTitle)&&void 0!==e?e:(0,fe.\_\_)("Content Control","content-control")}),[o,a]),(0,r.createElement)(we.SlotFillProvider,null,(0,r.createElement)("div",{className:Ee()(["cc-settings-page",`view-${o}`])},(0,r.createElement)(ln,null),(0,r.createElement)(De,{tabs:a}),(0,r.createElement)("div",{className:"cc-settings-page\_\_content"},(0,r.createElement)(s,null)),(0,r.createElement)(we.Popover.Slot,null)))};const{wpVersion:un}=contentControlSettingsPage,dn=()=>(0,r.createElement)(A~~,null,(0,r.createElement)(le,{adapter:pe},(0,r.createElement)(he.RegistryProvider,{value:ge.registry},(0,r.createElement)(sn,null)))),mn=()=>{const e=document.getElementById("content-control-root-container");e&&(un>=6.2||"function"==typeof \_e.createRoot?(0,\_e.createRoot)(e).render(dn()):(0,\_e.render)(dn(),e))}}(),(window.contentControl=window.contentControl||{}).settingsPage=o}(); |
  |  | 38 | (0,fe.\_\_)("Your license key failed to activate with the following error: %1$s","content-control"),w):(0,fe.\_\_)("There was an error with your license key. Please check your key and try again.","content-control")}}),!p&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)("br",null),(0,r.createElement)("hr",null),(0,r.createElement)(Kt,null))))};(0,be.addFilter)("contentControl.settingsPage.upgradeSections","content-control/general-settings/license-options",(e=>{const{isLicenseActive:t}=(0,Ce.useLicense)();return[...e,{name:"license",title:(0,fe.\_\_)("Pro Licensing","content-control"),badge:(0,r.createElement)(r.Fragment,null,t&&(0,r.createElement)("span",{className:"license-status-bubble"},(0,fe.\_\_)("Activated","content-control"))),icon:ye.licenseKey,comp:Jt}]}),5);var Zt=()=>{const e=(0,be.applyFilters)("contentControl.settingsPage.upgradeSections",[]);return(0,r.createElement)(r.Fragment,null,e.map((({name:e,title:t,badge:n,icon:o,comp:l})=>(0,r.createElement)(Ot,{key:e,name:e,badge:n,title:t,icon:o},l?(0,r.createElement)(l,null):t))))};const{permissions:{manage\_settings:Xt}}=contentControlSettingsPage;var en=()=>{var e;const[{tab:t="general"}]=ue({tab:V,view:V}),n=(0,be.applyFilters)("contentControl.settingsPage.tabs",[{name:"general",title:(0,fe.\_\_)("General","content-control"),comp:Qt},{name:"block-controls",title:(0,fe.\_\_)("Block Controls","content-control"),comp:Vt},{name:"license-and-updates",title:(0,fe.\_\_)("Licensing","content-control"),comp:Zt}]),{title:o,comp:l}=null!==(e=n.find((e=>e.name===t)))&&void 0!==e?e:{};return Xt?(0,r.createElement)("div",{className:Ee()(["cc-settings-view",`tab-${t}`])},(0,r.createElement)("div",{className:"plugin-settings"},(0,r.createElement)(Bt,{type:"settings"}),(0,r.createElement)(At,{tabs:n}),(0,r.createElement)("div",{className:"cc-settings-view\_\_content"},l?(0,r.createElement)(l,null):o))):(0,r.createElement)("div",{className:"cc-settings-view permission-denied"},(0,r.createElement)("h3",null,(0,fe.\_\_)("Permission Denied","content-control")),(0,r.createElement)("p",null,(0,r.createElement)("strong",null,(0,fe.\_\_)("You do not have permission to access this page.","content-control"))))};const tn={total:1,progress:0,currentTask:void 0,error:void 0},{hasUpgrades:nn,upgradeNonce:on,upgradeUrl:rn}=contentControlSettingsPage;var ln=()=>{const e=(0,\_e.useRef)(null),[t,n]=(0,\_e.useState)({running:!1,done:!1,logs:[],showLogs:!1,status:tn}),[o,l]=(0,\_e.useState)(-1),{running:a,done:c,logs:s,showLogs:i,status:u}=t,[d]=function(e,t,n=EventSource){const o=(0,r.useRef)(null),[l,a]=(0,r.useState)("init");return(0,r.useEffect)((()=>{if(e){const r=new n(e,{withCredentials:t});return o.current=r,r.addEventListener("open",(()=>a("open"))),r.addEventListener("error",(()=>a("error"))),()=>{o.current=null,r.close()}}a("closed")}),[e,t,n]),[o.current,l]}(a?`${rn}&nonce=${on}`:"",!0);!function(e,t,n,o=[]){(0,r.useEffect)((()=>{if(e)return t.forEach((t=>e.addEventListener(t,n))),()=>t.forEach((t=>e.removeEventListener(t,n)))}),[e,...o])}(d,["upgrades:start","upgrades:progress","upgrades:complete","upgrades:error","task:start","task:progress","task:complete","task:retry","task:error"],(({type:e,data:o})=>{const r=JSON.parse(o),{message:a="",status:c}=r,i={...t,status:c,logs:a.length?[...s,a]:s};switch(e){case"upgrades:start":case"upgrades:progress":case"upgrades:complete":case"task:retry":case"task:start":case"task:complete":case"task:progress":"upgrades:complete"===e&&(i.done=!0,l(15),d?.close()),n(i);break;case"upgrades:error":case"task:error":case"error":console.log("Error:",a,r),"upgrades:error"===e&&(i.done=!0,d?.close(),i.status={...i.status,error:a}),n({...i,logs:[...s,`ERROR: ${a}`,JSON.stringify(r)]});break;default:console.log("Unknown event:",e)}}),[t]);const{total:m,progress:p,currentTask:g}=u,{progress:h=NaN,total:\_=NaN}=g||{};(0,\_e.useEffect)((()=>{a&&c&&o>=0&&(e.current=setTimeout((()=>{0===o?window.location.reload():l(o-1)}),1e3))}),[c,o,a]);const v=p+1,E=m-p-1,f=(0,Ve.clamp)(p/m\*100,0,100),b=(0,Ve.clamp)(v/m\*100,0,100),y=h/\_,w=f,C=(0,\_e.useMemo)((()=>100-w-E/m\*100),[w,E,m]),S=(0,\_e.useMemo)((()=>u.currentTask?y\*C:0),[y,C,u.currentTask]);return nn?(0,r.createElement)("div",{className:"content-control-upgrades-panel"},a?(0,r.createElement)("div",{className:Ee()(["upgrade-progress",u.error?"upgrade-errors":""])},(0,r.createElement)("div",{className:"upgrade-progress\_\_header"},(0,r.createElement)("h3",{className:"upgrade-progress\_\_title"},(0,fe.\_\_)("Upgrade Progress","content-control")),(0,r.createElement)("div",{className:"upgrade-progress\_\_task-percentage"},c?(0,r.createElement)(we.Button,{onClick:()=>{var t;clearTimeout(null!==(t=e.current)&&void 0!==t?t:0),window.location.reload()},variant:"link"},`${(0,fe.\_\_)("Reload","content-control")} (${o})`):`${Math.round(f)}%`)),(0,r.createElement)("div",{className:"upgrade-progress\_\_bar"},(0,r.createElement)("div",{className:Ee()("upgrade-progress\_\_bar\_\_fill","upgrade-progress\_\_bar\_\_fill--next",b>=100?"complete":""),style:{width:`${b}%`}}),(0,r.createElement)("div",{className:Ee()("upgrade-progress\_\_bar\_\_fill","upgrade-progress\_\_bar\_\_fill--current",f>=100?"complete":""),style:{width:`${f}%`}}),(0,r.createElement)("div",{className:Ee()("upgrade-progress\_\_bar\_\_fill","upgrade-progress\_\_bar\_\_fill--task",y>=1?"complete":""),style:{left:`${w}%`,width:`${(0,Ve.clamp)(S,0,100)}%`}},(0,r.createElement)("div",{className:"task-progress"},y>0?Math.round(100\*y):0,"%"))),(0,r.createElement)("div",{className:"upgrade-progress\_\_logs\_\_header"},(0,r.createElement)("div",{className:"upgrade-progress\_\_logs\_\_header\_\_status"},s[s.length-1]),(0,r.createElement)(we.Button,{variant:"link",onClick:()=>{n({...t,showLogs:!i})}},i?(0,fe.\_\_)("Hide Logs","content-control"):(0,fe.\_\_)("Show Logs","content-control"))),i&&(0,r.createElement)("div",{className:"upgrade-progress\_\_logs"},(0,r.createElement)("div",{className:"upgrade-progress\_\_logs\_\_content"},s.map(((e,t)=>(0,r.createElement)("div",{key:t},e)))))):(0,r.createElement)("div",{className:"upgrade-notice"},(0,r.createElement)("div",{className:"notice-icon"},(0,r.createElement)("img",{alt:(0,fe.\_\_)("Content Control requires an upgrade to the database.","content-control"),src:`${contentControlSettingsPage.pluginUrl}assets/images/illustration-check.svg`})),(0,r.createElement)("div",{className:"notice-content"},(0,r.createElement)("h2",null,(0,fe.\_\_)("Content Control requires an upgrade to the database.","content-control")),(0,r.createElement)("p",null,(0,fe.\_\_)("Click the button below to start the upgrade process.","content-control"))),(0,r.createElement)(we.Button,{variant:"secondary",onClick:()=>{n({...t,running:!0})}},(0,fe.\_\_)("Start Upgrades","content-control")))):null};const{permissions:{manage\_settings:an,edit\_restrictions:cn}}=contentControlSettingsPage;var sn=()=>{const{isLicenseActive:e,isLicenseKeyValid:t,licenseLevel:n}=(0,Ce.useLicense)(),[{view:o="restrictions"},l]=ue({tab:V,view:V}),a=(0,\_e.useMemo)((()=>{let a=[];return cn&&a.push({name:"restrictions",title:(0,fe.\_\_)("Restrictions","content-control"),className:"restrictions",pageTitle:(0,fe.\_\_)("Content Control - Global Restrictions","content-control"),heading:(0,fe.\_\_)("Content Control - Global Restrictions","content-control"),comp:Ft}),an&&a.push({name:"settings",title:(0,fe.\_\_)("Settings","content-control"),className:"settings",pageTitle:(0,fe.\_\_)("Content Control - Plugin Settings","content-control"),heading:(0,fe.\_\_)("Plugin Settings","content-control"),comp:en}),a=(0,be.applyFilters)("contentControl.adminViews",[...a,{name:"upgrade",className:"upgrade",title:(0,r.createElement)(r.Fragment,null,(0,r.createElement)(we.Icon,{size:20,icon:ye.upgrade}),e?(0,fe.\_\_)("License Status","content-control"):(0,fe.\_\_)("Upgrade to Pro","content-control")),pageTitle:(0,fe.\_\_)("Content Control - Upgrade to Pro","content-control"),heading:(0,fe.\_\_)("Content Control - Upgrade to Pro","content-control"),href:t?void 0:"https://contentcontrolplugin.com/pricing/?utm\_campaign=upgrade-to-pro&utm\_source=plugin-settings-page&utm\_medium=plugin-ui&utm\_content=main-menu-upgrade-button",target:"\_blank",onClick:()=>(l({view:"settings",tab:"license-and-updates"}),!1)}],{view:o,setParams:l,isLicenseActive:e,isLicenseKeyValid:t,licenseLevel:n}),a}),[e,t,n,l]),c=a.find((e=>e.name===o)),s=c?.comp?c.comp:()=>(0,r.createElement)(r.Fragment,null);return(0,\_e.useEffect)((()=>{var e;document.title=null!==(e=a.find((e=>e.name===o))?.pageTitle)&&void 0!==e?e:(0,fe.\_\_)("Content Control","content-control")}),[o,a]),(0,r.createElement)(we.SlotFillProvider,null,(0,r.createElement)("div",{className:Ee()(["cc-settings-page",`view-${o}`])},(0,r.createElement)(ln,null),(0,r.createElement)(De,{tabs:a}),(0,r.createElement)("div",{className:"cc-settings-page\_\_content"},(0,r.createElement)(s,null)),(0,r.createElement)(we.Popover.Slot,null)))};const{wpVersion:un}=contentControlSettingsPage,dn=()=>(0,r.createElement)(O,null,(0,r.createElement)(le,{adapter:pe},(0,r.createElement)(he.RegistryProvider,{value:ge.registry},(0,r.createElement)(sn,null)))),mn=()=>{const e=document.getElementById("content-control-root-container");e&&(un>=6.2||"function"==typeof \_e.createRoot?(0,\_e.createRoot)(e).render(dn()):(0,\_e.render)(dn(),e))}}(),(window.contentControl=window.contentControl||{}).settingsPage=o}(); |
* ## [content-control/trunk/inc/functions.php](/changeset/3052982/content-control/trunk/inc/functions.php?old=2973448&old_path=content-control%2Ftrunk%2Finc%2Ffunctions.php "Show the [3007200:3052982] differences restricted to content-control/trunk/inc/functions.php")

  | [r3007200](/browser/content-control/trunk/inc/functions.php?rev=2973448#L21 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/inc/functions.php?rev=3052982#L21 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | require\_once 'functions/rule-callbacks.php'; |
  | 22 | 22 | require\_once 'functions/upgrades.php'; |
  |  | 23 | require\_once 'functions/utils.php'; |
  | 23 | 24 | require\_once 'functions/widgets.php'; |
* ## [content-control/trunk/inc/functions/compatibility.php](/changeset/3052982/content-control/trunk/inc/functions/compatibility.php?old=3007200&old_path=content-control%2Ftrunk%2Finc%2Ffunctions%2Fcompatibility.php "Show the [3007200:3052982] differences restricted to content-control/trunk/inc/functions/compatibility.php")

  | [r3007200](/browser/content-control/trunk/inc/functions/compatibility.php?rev=3007200#L71 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/inc/functions/compatibility.php?rev=3052982#L71 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 71 | 71 |  |
  | 72 | 72 | /\*\* |
  |  | 73 | \* Check if this is a core WP REST namespace. |
  |  | 74 | \* |
  |  | 75 | \* @return boolean |
  |  | 76 | \* |
  |  | 77 | \* @since 2.2.0 |
  |  | 78 | \*/ |
  |  | 79 | function is\_wp\_core\_rest\_namespace() { |
  |  | 80 | if ( ! is\_rest() ) { |
  |  | 81 | return false; |
  |  | 82 | } |
  |  | 83 |  |
  |  | 84 | global $wp; |
  |  | 85 |  |
  |  | 86 | $rest\_route = isset( $wp->query\_vars['rest\_route'] ) ? $wp->query\_vars['rest\_route'] : ''; |
  |  | 87 |  |
  |  | 88 | // Check if this is core WP REST namespace. |
  |  | 89 | return strpos( $rest\_route, '/wp/v2' ) === 0; |
  |  | 90 | } |
  |  | 91 |  |
  |  | 92 | /\*\* |
  | 73 | 93 | \* Check if this is a cron request. |
  | 74 | 94 | \* |
  | […](/browser/content-control/trunk/inc/functions/compatibility.php?rev=3007200#L94) | […](/browser/content-control/trunk/inc/functions/compatibility.php?rev=3052982#L114) |  |
  | 94 | 114 | \*/ |
  | 95 | 115 | function is\_frontend() { |
  | 96 |  | ~~global $wp\_rewrite;~~ |
  | 97 |  |  |
  | 98 | 116 | $query = get\_query(); |
  | 99 | 117 |  |
  | […](/browser/content-control/trunk/inc/functions/compatibility.php?rev=3007200#L111) | […](/browser/content-control/trunk/inc/functions/compatibility.php?rev=3052982#L129) |  |
  | 111 | 129 | ( $query && $query->is\_robots() ) || |
  | 112 | 130 | strpos( $request\_uri, 'favicon.ico' ) !== false || |
  | 113 |  | strpos( $request\_uri, 'robots.txt' ) !== false || |
  | 114 |  | ( $wp\_rewrite && is\_rest() ) |
  |  | 131 | strpos( $request\_uri, 'robots.txt' ) !== false |
  | 115 | 132 | ) { |
  | 116 | 133 | return false; |
* ## [content-control/trunk/inc/functions/developers.php](/changeset/3052982/content-control/trunk/inc/functions/developers.php?old=2974933&old_path=content-control%2Ftrunk%2Finc%2Ffunctions%2Fdevelopers.php "Show the [3007200:3052982] differences restricted to content-control/trunk/inc/functions/developers.php")

  | [r3007200](/browser/content-control/trunk/inc/functions/developers.php?rev=2974933#L234 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/inc/functions/developers.php?rev=3052982#L234 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 234 | 234 |  |
  | 235 | 235 | /\*\* |
  |  | 236 | \* Check if query has restrictions. |
  |  | 237 | \* |
  |  | 238 | \* @param \WP\_Term\_Query $query Query object. |
  |  | 239 | \* |
  |  | 240 | \* @return array<array{restriction:\ContentControl\Models\Restriction,term\_ids:int[]}>|false |
  |  | 241 | \* |
  |  | 242 | \* @since 2.0.0 |
  |  | 243 | \*/ |
  |  | 244 | function get\_restriction\_matches\_for\_queried\_terms( $query ) { |
  |  | 245 | if ( empty( $query->terms ) ) { |
  |  | 246 | return false; |
  |  | 247 | } |
  |  | 248 |  |
  |  | 249 | static $restrictions; |
  |  | 250 |  |
  |  | 251 | // Generate cache key from hasing $wp\_query. |
  |  | 252 | $cache\_key = md5( (string) wp\_json\_encode( $query ) ); |
  |  | 253 |  |
  |  | 254 | if ( isset( $restrictions[ $cache\_key ] ) ) { |
  |  | 255 | return $restrictions[ $cache\_key ]; |
  |  | 256 | } |
  |  | 257 |  |
  |  | 258 | set\_rules\_query( $query ); |
  |  | 259 |  |
  |  | 260 | foreach ( $query->terms as $term ) { |
  |  | 261 | if ( content\_is\_restricted( $term->term\_id ) ) { |
  |  | 262 | $restriction = get\_applicable\_restriction( $term->term\_id ); |
  |  | 263 |  |
  |  | 264 | if ( ! isset( $restrictions[ $cache\_key ][ $restriction->priority ] ) ) { |
  |  | 265 | // Handles deduplication & sorting. |
  |  | 266 | $restrictions[ $cache\_key ][ $restriction->priority ] = [ |
  |  | 267 | 'restriction' => $restriction, |
  |  | 268 | 'term\_ids'    => [], |
  |  | 269 | ]; |
  |  | 270 | } |
  |  | 271 |  |
  |  | 272 | // Add term to restriction. |
  |  | 273 | $restrictions[ $cache\_key ][ $restriction->priority ]['term\_ids'][] = $term->term\_id; |
  |  | 274 | } |
  |  | 275 | } |
  |  | 276 |  |
  |  | 277 | set\_rules\_query( null ); |
  |  | 278 |  |
  |  | 279 | if ( empty( $restrictions[ $cache\_key ] ) ) { |
  |  | 280 | $restrictions[ $cache\_key ] = false; |
  |  | 281 | } else { |
  |  | 282 | // Sort by priority. |
  |  | 283 | ksort( $restrictions[ $cache\_key ] ); |
  |  | 284 | // Remove priority keys. |
  |  | 285 | $restrictions[ $cache\_key ] = array\_values( $restrictions[ $cache\_key ] ); |
  |  | 286 | } |
  |  | 287 |  |
  |  | 288 | return $restrictions[ $cache\_key ]; |
  |  | 289 | } |
  |  | 290 |  |
  |  | 291 | /\*\* |
  |  | 292 | \* Check if the referrer is the sites admin area. |
  |  | 293 | \* |
  |  | 294 | \* @return bool |
  |  | 295 | \* |
  |  | 296 | \* @since 2.2.0 |
  |  | 297 | \*/ |
  |  | 298 | function check\_referrer\_is\_admin() { |
  |  | 299 | $ref = wp\_get\_raw\_referer(); |
  |  | 300 |  |
  |  | 301 | if ( empty( $ref ) ) { |
  |  | 302 | return false; |
  |  | 303 | } |
  |  | 304 |  |
  |  | 305 | $ref = wp\_parse\_url( $ref ); |
  |  | 306 |  |
  |  | 307 | if ( empty( $ref['host'] ) ) { |
  |  | 308 | return false; |
  |  | 309 | } |
  |  | 310 |  |
  |  | 311 | $ref\_host = strtolower( $ref['host'] ); |
  |  | 312 |  |
  |  | 313 | $admin\_url = strtolower( wp\_parse\_url( admin\_url(), PHP\_URL\_HOST ) ); |
  |  | 314 |  |
  |  | 315 | return $ref\_host === $admin\_url; |
  |  | 316 | } |
  |  | 317 |  |
  |  | 318 | /\*\* |
  | 236 | 319 | \* Check if protection methods should be disabled. |
  | 237 | 320 | \* |
  | […](/browser/content-control/trunk/inc/functions/developers.php?rev=2974933#L245) | […](/browser/content-control/trunk/inc/functions/developers.php?rev=3052982#L328) |  |
  | 245 | 328 | $checks = [ |
  | 246 | 329 | // Disable protection when not on the frontend. |
  | 247 |  | ! \ContentControl\is\_frontend(), |
  |  | 330 | ! \ContentControl\is\_frontend() && ! \ContentControl\is\_rest(), |
  | 248 | 331 | // Disable protection when user is excluded. |
  | 249 | 332 | user\_is\_excluded(), |
  | 250 | 333 | // Disable protection when viewing post previews. |
  | 251 | 334 | is\_preview() && current\_user\_can( 'edit\_post', get\_the\_ID() ), |
  |  | 335 | // If this is rest request and not core wp namespace. |
  |  | 336 | is\_rest() && ! is\_wp\_core\_rest\_namespace(), |
  |  | 337 | // Check if doing ADMIN AJAX from valid admin referrer. |
  |  | 338 | defined( 'DOING\_AJAX' ) && DOING\_AJAX && check\_referrer\_is\_admin(), |
  |  | 339 | // Check if doing REST API from valid admin referrer. |
  |  | 340 | is\_rest() && check\_referrer\_is\_admin(), |
  | 252 | 341 | ]; |
  | 253 | 342 |  |
* ## [content-control/trunk/inc/functions/query.php](/changeset/3052982/content-control/trunk/inc/functions/query.php?old=2970833&old_path=content-control%2Ftrunk%2Finc%2Ffunctions%2Fquery.php "Show the [3007200:3052982] differences restricted to content-control/trunk/inc/functions/query.php")

  | [r3007200](/browser/content-control/trunk/inc/functions/query.php?rev=2970833#L133 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/inc/functions/query.php?rev=3052982#L133 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 133 | 133 |  |
  | 134 | 134 | $query   = get\_query( $query ); |
  | 135 |  | $is\_main = $query->is\_main\_query(); |
  |  | 135 | $is\_main = is\_a( $query, '\WP\_Query' ) && $query->is\_main\_query(); |
  | 136 | 136 |  |
  | 137 | 137 | // Blocks in the main page or other locations. |
  | […](/browser/content-control/trunk/inc/functions/query.php?rev=2970833#L145) | […](/browser/content-control/trunk/inc/functions/query.php?rev=3052982#L145) |  |
  | 145 | 145 | } |
  | 146 | 146 |  |
  |  | 147 | if ( is\_rest() ) { |
  |  | 148 | if ( doing\_filter( 'get\_terms' ) ) { |
  |  | 149 | return 'restapi/terms'; |
  |  | 150 | } |
  |  | 151 |  |
  |  | 152 | if ( doing\_filter( 'pre\_get\_posts' ) || doing\_filter( 'the\_posts' ) ) { |
  |  | 153 | return 'restapi/posts'; |
  |  | 154 | } |
  |  | 155 |  |
  |  | 156 | return 'restapi'; |
  |  | 157 | } |
  |  | 158 |  |
  | 147 | 159 | if ( doing\_filter( 'pre\_get\_posts' ) || doing\_filter( 'the\_posts' ) ) { |
  | 148 | 160 | return $is\_main ? 'main/posts' : 'posts'; |
  | […](/browser/content-control/trunk/inc/functions/query.php?rev=2970833#L159) | […](/browser/content-control/trunk/inc/functions/query.php?rev=3052982#L171) |  |
  | 159 | 171 | \* has been set yet, so we need to manage global state ourselves. |
  | 160 | 172 | \* |
  | 161 |  | \* @param \WP\_Query|null $query WP\_Query object. |
  |  | 173 | \* @param \WP\_Query|\WP\_Term\_Query|null $query WP\_Query object. |
  | 162 | 174 | \* |
  | 163 | 175 | \* @return void |
  | […](/browser/content-control/trunk/inc/functions/query.php?rev=2970833#L167) | […](/browser/content-control/trunk/inc/functions/query.php?rev=3052982#L179) |  |
  | 167 | 179 | \* Current query object. |
  | 168 | 180 | \* |
  | 169 |  | \* @var null|\WP\_Query $cc\_current\_query |
  |  | 181 | \* @var null|\WP\_Query|\WP\_Term\_Query $cc\_current\_query |
  | 170 | 182 | \*/ |
  | 171 | 183 | global $cc\_current\_query; |
  | […](/browser/content-control/trunk/inc/functions/query.php?rev=2970833#L183) | […](/browser/content-control/trunk/inc/functions/query.php?rev=3052982#L195) |  |
  | 183 | 195 | \*/ |
  | 184 | 196 | function setup\_post( $post\_id = null ) { |
  |  | 197 | $context = current\_query\_context(); |
  |  | 198 |  |
  |  | 199 | if ( 'restapi/terms' === $context || 'terms' === $context ) { |
  |  | 200 | return setup\_tax\_object( $post\_id ); |
  |  | 201 | } |
  |  | 202 |  |
  | 185 | 203 | global $post, $content\_control\_last\_post; |
  | 186 | 204 |  |
  | […](/browser/content-control/trunk/inc/functions/query.php?rev=2970833#L210) | […](/browser/content-control/trunk/inc/functions/query.php?rev=3052982#L228) |  |
  | 210 | 228 |  |
  | 211 | 229 | /\*\* |
  |  | 230 | \* Check and overload global term if needed. |
  |  | 231 | \* |
  |  | 232 | \* This has no effect when checking global queries ($term\_id = null). |
  |  | 233 | \* |
  |  | 234 | \* @param int|\WP\_Term|null $term\_id Term ID. |
  |  | 235 | \* |
  |  | 236 | \* @return bool |
  |  | 237 | \*/ |
  |  | 238 | function setup\_tax\_object( $term\_id = null ) { |
  |  | 239 | global $cc\_term, $content\_control\_last\_term; |
  |  | 240 |  |
  |  | 241 | if ( ! isset( $content\_control\_last\_term ) ) { |
  |  | 242 | $content\_control\_last\_term = []; |
  |  | 243 | } |
  |  | 244 |  |
  |  | 245 | if ( is\_null( $term\_id ) ) { |
  |  | 246 | return false; |
  |  | 247 | } |
  |  | 248 |  |
  |  | 249 | $current\_term\_id = isset( $cc\_term ) ? $cc\_term->term\_id : null; |
  |  | 250 |  |
  |  | 251 | $overload\_term = |
  |  | 252 | ( is\_object( $term\_id ) && $term\_id->term\_id !== $current\_term\_id ) || |
  |  | 253 | ( is\_int( $term\_id ) && $term\_id !== $current\_term\_id ); |
  |  | 254 |  |
  |  | 255 | if ( $overload\_term ) { |
  |  | 256 | $content\_control\_last\_term[] = isset( $cc\_term ) ? $cc\_term : $current\_term\_id; |
  |  | 257 | // phpcs:ignore WordPress.WP.GlobalVariablesOverride.Prohibited |
  |  | 258 | $cc\_term = get\_term( $term\_id ); |
  |  | 259 | } |
  |  | 260 |  |
  |  | 261 | return $overload\_term; |
  |  | 262 | } |
  |  | 263 |  |
  |  | 264 | /\*\* |
  | 212 | 265 | \* Check and clear global post if needed. |
  | 213 | 266 | \* |
  | […](/browser/content-control/trunk/inc/functions/query.php?rev=2970833#L215) | […](/browser/content-control/trunk/inc/functions/query.php?rev=3052982#L268) |  |
  | 215 | 268 | \*/ |
  | 216 | 269 | function clear\_post() { |
  |  | 270 | $context = current\_query\_context(); |
  |  | 271 |  |
  |  | 272 | if ( 'restapi/terms' === $context || 'terms' === $context ) { |
  |  | 273 | clear\_tax\_object(); |
  |  | 274 | } |
  |  | 275 |  |
  | 217 | 276 | global $post, $content\_control\_last\_post; |
  | 218 | 277 | if ( ! empty( $content\_control\_last\_post ) ) { |
  | […](/browser/content-control/trunk/inc/functions/query.php?rev=2970833#L225) | […](/browser/content-control/trunk/inc/functions/query.php?rev=3052982#L284) |  |
  | 225 | 284 | } |
  | 226 | 285 | } |
  |  | 286 |  |
  |  | 287 | /\*\* |
  |  | 288 | \* Check and clear global term if needed. |
  |  | 289 | \* |
  |  | 290 | \* @return void |
  |  | 291 | \*/ |
  |  | 292 | function clear\_tax\_object() { |
  |  | 293 | global $cc\_term, $content\_control\_last\_term; |
  |  | 294 | if ( ! empty( $content\_control\_last\_term ) ) { |
  |  | 295 | // Get the last post ID from the array. |
  |  | 296 | // phpcs:ignore WordPress.WP.GlobalVariablesOverride.Prohibited |
  |  | 297 | $cc\_term = array\_pop( $content\_control\_last\_term ); |
  |  | 298 | } |
  |  | 299 | } |
  |  | 300 |  |
  |  | 301 | /\*\* |
  |  | 302 | \* Get the endpoints for a registered post types. |
  |  | 303 | \* |
  |  | 304 | \* @return array<string,string> |
  |  | 305 | \*/ |
  |  | 306 | function get\_post\_type\_endpoints() { |
  |  | 307 | $endpoints  = []; |
  |  | 308 | $post\_types = get\_post\_types(); |
  |  | 309 |  |
  |  | 310 | foreach ( $post\_types as $post\_type ) { |
  |  | 311 | $object                                     = get\_post\_type\_object( $post\_type ); |
  |  | 312 | $endpoints[ "/wp/v2/{$object->rest\_base}" ] = $post\_type; |
  |  | 313 | } |
  |  | 314 |  |
  |  | 315 | return $endpoints; |
  |  | 316 | } |
  |  | 317 |  |
  |  | 318 | /\*\* |
  |  | 319 | \* Get the endpoints for a registered taxonomies. |
  |  | 320 | \* |
  |  | 321 | \* @return array<string,string> |
  |  | 322 | \*/ |
  |  | 323 | function get\_taxonomy\_endpoints() { |
  |  | 324 | $endpoints  = []; |
  |  | 325 | $taxonomies = get\_taxonomies(); |
  |  | 326 |  |
  |  | 327 | foreach ( $taxonomies as $taxonomy ) { |
  |  | 328 | $object                                     = get\_taxonomy( $taxonomy ); |
  |  | 329 | $endpoints[ "/wp/v2/{$object->rest\_base}" ] = $taxonomy; |
  |  | 330 | } |
  |  | 331 |  |
  |  | 332 | return $endpoints; |
  |  | 333 | } |
  |  | 334 |  |
  |  | 335 | /\*\* |
  |  | 336 | \* Get the intent of the current REST API request. |
  |  | 337 | \* |
  |  | 338 | \* @param string|null $key     Key to return. |
  |  | 339 | \* @param mixed       $\_default Default value. |
  |  | 340 | \* |
  |  | 341 | \* @return array{type:string,name:string,id:bool,index:bool,search:bool}|string|bool |
  |  | 342 | \*/ |
  |  | 343 | function get\_rest\_api\_intent( $key = null, $\_default = null ) { |
  |  | 344 | global $wp; |
  |  | 345 |  |
  |  | 346 | $result = [ |
  |  | 347 | 'type'   => 'unknown', |
  |  | 348 | 'name'   => '', |
  |  | 349 | 'id'     => false, |
  |  | 350 | 'index'  => false, |
  |  | 351 | 'search' => false, |
  |  | 352 | ]; |
  |  | 353 |  |
  |  | 354 | if ( ! empty( $wp->query\_vars['rest\_route'] ) ) { |
  |  | 355 | $rest\_route          = $wp->query\_vars['rest\_route']; |
  |  | 356 | $post\_type\_endpoints = get\_post\_type\_endpoints(); |
  |  | 357 | $taxonomy\_endpoints  = get\_taxonomy\_endpoints(); |
  |  | 358 |  |
  |  | 359 | if ( strpos( $rest\_route, '/wp/v2/' ) !== 0 ) { |
  |  | 360 | // We have no way of really dealing with non WP REST requests. |
  |  | 361 | return $result; |
  |  | 362 | } |
  |  | 363 |  |
  |  | 364 | $endpoint\_parts = explode( '/', str\_replace( '/wp/v2/', '', $rest\_route ) ); |
  |  | 365 |  |
  |  | 366 | // If we have a post type or taxonomy, the name is the first part (posts, categories). |
  |  | 367 | $result['name'] = $endpoint\_parts[0]; |
  |  | 368 |  |
  |  | 369 | if ( count( $endpoint\_parts ) > 1 ) { |
  |  | 370 | // If we have an ID, then the second part is the ID. |
  |  | 371 | $result['id'] = $endpoint\_parts[1]; |
  |  | 372 | } else { |
  |  | 373 | // If we have no ID, then we are either searching or indexing. |
  |  | 374 | $result['index']  = true; |
  |  | 375 | $result['search'] = isset( $wp->query\_vars['s'] ) ? $wp->query\_vars['s'] : false; |
  |  | 376 | } |
  |  | 377 |  |
  |  | 378 | // Build a matching route. |
  |  | 379 | $endpoint\_route = "/wp/v2/{$endpoint\_parts[0]}"; |
  |  | 380 |  |
  |  | 381 | if ( isset( $post\_type\_endpoints[ $endpoint\_route ] ) ) { |
  |  | 382 | $result['type'] = 'post\_type'; |
  |  | 383 | } |
  |  | 384 |  |
  |  | 385 | if ( isset( $taxonomy\_endpoints[ $endpoint\_route ] ) ) { |
  |  | 386 | $result['type'] = 'taxonomy'; |
  |  | 387 | } |
  |  | 388 | } |
  |  | 389 |  |
  |  | 390 | if ( is\_null( $key ) ) { |
  |  | 391 | return $result; |
  |  | 392 | } |
  |  | 393 |  |
  |  | 394 | return isset( $result[ $key ] ) ? $result[ $key ] : $\_default; |
  |  | 395 | } |
* ## [content-control/trunk/inc/functions/restrictions.php](/changeset/3052982/content-control/trunk/inc/functions/restrictions.php?old=2973448&old_path=content-control%2Ftrunk%2Finc%2Ffunctions%2Frestrictions.php "Show the [3007200:3052982] differences restricted to content-control/trunk/inc/functions/restrictions.php")

  | [r3007200](/browser/content-control/trunk/inc/functions/restrictions.php?rev=2973448#L120 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/inc/functions/restrictions.php?rev=3052982#L120 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 120 | 120 | \* Check if a given query can be ignored. |
  | 121 | 121 | \* |
  | 122 |  | \* @param \WP\_Query $query Query object. |
  |  | 122 | \* @param \WP\_Query|\WP\_Term\_Query $query Query object. |
  | 123 | 123 | \* |
  | 124 | 124 | \* @return bool True if query can be ignored, false if not. |
  |  | 125 | \* |
  |  | 126 | \* @since 2.2.0 Added support for WP\_Term\_Query. |
  | 125 | 127 | \*/ |
  | 126 | 128 | function query\_can\_be\_ignored( $query = null ) { |
  | 127 |  | if ( $query->get( 'ignore\_restrictions', false ) ) { |
  | 128 |  | return true; |
  |  | 129 | if ( is\_a( $query, '\WP\_Query' ) ) { |
  |  | 130 | if ( $query->get( 'ignore\_restrictions', false ) ) { |
  |  | 131 | return true; |
  |  | 132 | } |
  |  | 133 |  |
  |  | 134 | $post\_types\_to\_ignore = \apply\_filters( 'content\_control/post\_types\_to\_ignore', [ |
  |  | 135 | 'cc\_restriction', |
  |  | 136 | 'wp\_template', |
  |  | 137 | 'wp\_template\_part', |
  |  | 138 | 'wp\_global\_styles', |
  |  | 139 | 'oembed\_cache', |
  |  | 140 | ] ); |
  |  | 141 |  |
  |  | 142 | // Ignore specific core post types. |
  |  | 143 | if ( in\_array( $query->get( 'post\_type' ), $post\_types\_to\_ignore, true ) ) { |
  |  | 144 | return true; |
  |  | 145 | } |
  | 129 | 146 | } |
  | 130 | 147 |  |
  | 131 |  | $post\_types\_to\_ignore = \apply\_filters( 'content\_control/post\_types\_to\_ignore', [ |
  | 132 |  | 'cc\_restriction', |
  | 133 |  | 'wp\_template', |
  | 134 |  | 'wp\_template\_part', |
  | 135 |  | 'wp\_global\_styles', |
  | 136 |  | 'oembed\_cache', |
  | 137 |  | ] ); |
  |  | 148 | if ( is\_a( $query, '\WP\_Term\_Query' ) ) { |
  |  | 149 | // Ignore specific core taxonomies. |
  |  | 150 | $test                 = '123'; |
  |  | 151 | $taxonomies\_to\_ignore = \apply\_filters( 'content\_control/taxonomies\_to\_ignore', [ |
  |  | 152 | 'nav\_menu', |
  |  | 153 | 'link\_category', |
  |  | 154 | 'post\_format', |
  |  | 155 | 'wp\_theme', |
  |  | 156 | ] ); |
  | 138 | 157 |  |
  | 139 |  | // Ignore specific core post types. |
  | 140 |  | if ( in\_array( $query->get( 'post\_type' ), $post\_types\_to\_ignore, true ) ) { |
  | 141 |  | return true; |
  |  | 158 | foreach ( (array) $taxonomies\_to\_ignore as $taxonomy ) { |
  |  | 159 | if ( in\_array( $taxonomy, $query->query\_vars['taxonomy'], true ) ) { |
  |  | 160 | return true; |
  |  | 161 | } |
  |  | 162 | } |
  | 142 | 163 | } |
  | 143 | 164 |  |
* ## [content-control/trunk/inc/functions/rule-callbacks.php](/changeset/3052982/content-control/trunk/inc/functions/rule-callbacks.php?old=2969631&old_path=content-control%2Ftrunk%2Finc%2Ffunctions%2Frule-callbacks.php "Show the [3007200:3052982] differences restricted to content-control/trunk/inc/functions/rule-callbacks.php")

  | [r3007200](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L15 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L15 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | use function ContentControl\Rules\get\_rule\_option; |
  | 16 | 16 | use function ContentControl\current\_query\_context; |
  |  | 17 | use function ContentControl\get\_rest\_api\_intent; |
  | 17 | 18 | use function ContentControl\Rules\allowed\_user\_roles; |
  | 18 | 19 |  |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L120) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L121) |  |
  | 120 | 121 | \* |
  | 121 | 122 | \* @since 2.0.0 |
  |  | 123 | \* @since 2.2.0 Added support for REST API. |
  | 122 | 124 | \*/ |
  | 123 | 125 | function content\_is\_post\_type\_archive() { |
  |  | 126 | $context = current\_query\_context(); |
  |  | 127 |  |
  | 124 | 128 | $query = get\_main\_wp\_query(); |
  | 125 | 129 |  |
  | 126 | 130 | $post\_type = get\_rule\_extra( 'post\_type', '' ); |
  | 127 | 131 |  |
  | 128 |  | // For posts we need to check a few different things. |
  | 129 |  | if ( 'post' === $post\_type ) { |
  | 130 |  | return ( $query->is\_home() || $query->is\_category() || $query->is\_tag() || $query->is\_date() || $query->is\_author() ); |
  | 131 |  | } |
  | 132 |  |  |
  | 133 |  | // Context doesn't matter for this check. |
  | 134 |  | return $query->is\_post\_type\_archive( $post\_type ); |
  |  | 132 | switch ( $context ) { |
  |  | 133 | default: |
  |  | 134 | // For posts we need to check a few different things. |
  |  | 135 | if ( 'post' === $post\_type ) { |
  |  | 136 | return ( $query->is\_home() || $query->is\_category() || $query->is\_tag() || $query->is\_date() || $query->is\_author() ); |
  |  | 137 | } |
  |  | 138 |  |
  |  | 139 | // Context doesn't matter for this check. |
  |  | 140 | return $query->is\_post\_type\_archive( $post\_type ); |
  |  | 141 |  |
  |  | 142 | case 'restapi': |
  |  | 143 | $rest\_intent = get\_rest\_api\_intent(); |
  |  | 144 |  |
  |  | 145 | if ( ! $rest\_intent['index'] ) { |
  |  | 146 | return false; |
  |  | 147 | } |
  |  | 148 |  |
  |  | 149 | $post\_type\_objeect = get\_post\_type\_object( $post\_type ); |
  |  | 150 |  |
  |  | 151 | // First be sure this is for a post type of the right kind. |
  |  | 152 | if ( 'post\_type' !== $rest\_intent['type'] || $post\_type\_objeect->rest\_base !== $rest\_intent['name'] ) { |
  |  | 153 | return false; |
  |  | 154 | } |
  |  | 155 |  |
  |  | 156 | return true; |
  |  | 157 |  |
  |  | 158 | case 'restapi/posts': |
  |  | 159 | // This is for main query only. |
  |  | 160 | return false; |
  |  | 161 | } |
  | 135 | 162 | } |
  | 136 | 163 |  |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L141) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L168) |  |
  | 141 | 168 | \* |
  | 142 | 169 | \* @since 2.0.0 |
  |  | 170 | \* @since 2.2.0 Added support for REST API. |
  | 143 | 171 | \*/ |
  | 144 | 172 | function content\_is\_post\_type() { |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L157) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L185) |  |
  | 157 | 185 | case 'blocks': |
  | 158 | 186 | return is\_post\_type( $post\_type ); |
  |  | 187 |  |
  |  | 188 | case 'restapi': |
  |  | 189 | $rest\_intent       = get\_rest\_api\_intent(); |
  |  | 190 | $post\_type\_objeect = get\_post\_type\_object( $post\_type ); |
  |  | 191 |  |
  |  | 192 | // First be sure this is for a singular post type of the right kind. |
  |  | 193 | if ( 'post\_type' !== $rest\_intent['type'] || $post\_type\_objeect->rest\_base !== $rest\_intent['name'] ) { |
  |  | 194 | return false; |
  |  | 195 | } |
  |  | 196 |  |
  |  | 197 | if ( true === $rest\_intent['index'] ) { |
  |  | 198 | return true; |
  |  | 199 | } |
  |  | 200 |  |
  |  | 201 | return get\_post\_type( $rest\_intent['id'] > 0 ? $rest\_intent['id'] : 0 ) === $post\_type; |
  |  | 202 |  |
  |  | 203 | case 'restapi/posts': |
  |  | 204 | global $post; |
  |  | 205 |  |
  |  | 206 | return $post && $post->post\_type === $post\_type; |
  | 159 | 207 | } |
  | 160 | 208 | } |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L166) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L214) |  |
  | 166 | 214 | \* |
  | 167 | 215 | \* @since 2.0.0 |
  |  | 216 | \* @since 2.2.0 Added support for REST API. |
  | 168 | 217 | \*/ |
  | 169 | 218 | function content\_is\_selected\_post() { |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L189) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L238) |  |
  | 189 | 238 | case 'blocks': |
  | 190 | 239 | return is\_post\_type( $post\_type ) && in\_array( $post->ID, $selected, true ); |
  |  | 240 |  |
  |  | 241 | case 'restapi': |
  |  | 242 | case 'restapi/posts': |
  |  | 243 | $rest\_intent = get\_rest\_api\_intent(); |
  |  | 244 |  |
  |  | 245 | $post\_type\_objeect = get\_post\_type\_object( $post\_type ); |
  |  | 246 |  |
  |  | 247 | // First be sure this is for a singular post type of the right kind. |
  |  | 248 | if ( 'post\_type' !== $rest\_intent['type'] || $post\_type\_objeect->rest\_base !== $rest\_intent['name'] ) { |
  |  | 249 | return false; |
  |  | 250 | } |
  |  | 251 |  |
  |  | 252 | $post\_id = null; |
  |  | 253 |  |
  |  | 254 | if ( 'restapi' === $context ) { |
  |  | 255 | if ( $rest\_intent['id'] > 0 ) { |
  |  | 256 | $post\_id = (int) $rest\_intent['id']; |
  |  | 257 | } |
  |  | 258 | } elseif ( $post && $post->ID > 0 ) { |
  |  | 259 | $post\_id = $post->ID; |
  |  | 260 | } |
  |  | 261 |  |
  |  | 262 | return in\_array( $post\_id, $selected, true ); |
  | 191 | 263 | } |
  | 192 | 264 | } |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L198) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L270) |  |
  | 198 | 270 | \* |
  | 199 | 271 | \* @since 2.0.0 |
  |  | 272 | \* @since 2.2.0 Added support for REST API. |
  | 200 | 273 | \*/ |
  | 201 | 274 | function content\_is\_child\_of\_post() { |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L214) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L287) |  |
  | 214 | 287 | } |
  | 215 | 288 |  |
  |  | 289 | $the\_post = isset( $post ) ? $post : null; |
  |  | 290 |  |
  | 216 | 291 | switch ( $context ) { |
  | 217 | 292 | case 'main': |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L228) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L303) |  |
  | 228 | 303 | case 'posts': |
  | 229 | 304 | case 'blocks': |
  |  | 305 | case 'restapi/posts': |
  | 230 | 306 | // Check if current post is a post type. |
  | 231 | 307 | if ( ! is\_post\_type( $post\_type ) ) { |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L233) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L309) |  |
  | 233 | 309 | } |
  | 234 | 310 | break; |
  |  | 311 |  |
  |  | 312 | case 'restapi': |
  |  | 313 | $rest\_intent = get\_rest\_api\_intent(); |
  |  | 314 |  |
  |  | 315 | $post\_type\_objeect = get\_post\_type\_object( $post\_type ); |
  |  | 316 |  |
  |  | 317 | // First be sure this is for a singular post type of the right kind. |
  |  | 318 | if ( 'post\_type' !== $rest\_intent['type'] || $post\_type\_objeect->rest\_base !== $rest\_intent['name'] ) { |
  |  | 319 | return false; |
  |  | 320 | } |
  |  | 321 |  |
  |  | 322 | if ( $rest\_intent['id'] > 0 ) { |
  |  | 323 | $the\_post = get\_post( (int) $rest\_intent['id'] ); |
  |  | 324 | } |
  |  | 325 | break; |
  |  | 326 | } |
  |  | 327 |  |
  |  | 328 | if ( ! $the\_post ) { |
  |  | 329 | return false; |
  | 235 | 330 | } |
  | 236 | 331 |  |
  | 237 | 332 | foreach ( $selected as $id ) { |
  | 238 |  | if ( $post->post\_parent === $id ) { |
  |  | 333 | if ( $the\_post->post\_parent === $id ) { |
  | 239 | 334 | return true; |
  | 240 | 335 | } |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L250) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L345) |  |
  | 250 | 345 | \* |
  | 251 | 346 | \* @since 2.0.0 |
  |  | 347 | \* @since 2.2.0 Added support for REST API. |
  | 252 | 348 | \*/ |
  | 253 | 349 | function content\_is\_ancestor\_of\_post() { |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L266) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L362) |  |
  | 266 | 362 | } |
  | 267 | 363 |  |
  |  | 364 | $the\_post = isset( $post ) ? $post : null; |
  |  | 365 |  |
  | 268 | 366 | switch ( $context ) { |
  | 269 | 367 | case 'main': |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L280) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L378) |  |
  | 280 | 378 | case 'posts': |
  | 281 | 379 | case 'blocks': |
  |  | 380 | case 'restapi/posts': |
  | 282 | 381 | // Check if current post is a post type. |
  | 283 | 382 | if ( ! is\_post\_type( $post\_type ) ) { |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L285) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L384) |  |
  | 285 | 384 | } |
  | 286 | 385 | break; |
  |  | 386 |  |
  |  | 387 | case 'restapi': |
  |  | 388 | $rest\_intent = get\_rest\_api\_intent(); |
  |  | 389 |  |
  |  | 390 | $post\_type\_objeect = get\_post\_type\_object( $post\_type ); |
  |  | 391 |  |
  |  | 392 | // First be sure this is for a singular post type of the right kind. |
  |  | 393 | if ( 'post\_type' !== $rest\_intent['type'] || $post\_type\_objeect->rest\_base !== $rest\_intent['name'] ) { |
  |  | 394 | return false; |
  |  | 395 | } |
  |  | 396 |  |
  |  | 397 | if ( $rest\_intent['id'] > 0 ) { |
  |  | 398 | $the\_post = get\_post( (int) $rest\_intent['id'] ); |
  |  | 399 | } |
  |  | 400 |  |
  |  | 401 | break; |
  | 287 | 402 | } |
  | 288 | 403 |  |
  | 289 | 404 | // Ancestors of the current page. |
  | 290 |  | $ancestors = ~~\get\_post\_ancestors( $post->ID )~~; |
  |  | 405 | $ancestors = $the\_post ? \get\_post\_ancestors( $the\_post->ID ) : []; |
  | 291 | 406 |  |
  | 292 | 407 | foreach ( $selected as $id ) { |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L348) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L463) |  |
  | 348 | 463 | \* |
  | 349 | 464 | \* @since 2.0.0 |
  |  | 465 | \* @since 2.2.0 Added support for REST API. |
  | 350 | 466 | \*/ |
  | 351 | 467 | function content\_is\_post\_with\_tax\_term() { |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L362) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L478) |  |
  | 362 | 478 | ); |
  | 363 | 479 |  |
  |  | 480 | $post\_id = null; |
  |  | 481 |  |
  | 364 | 482 | switch ( $context ) { |
  | 365 | 483 | case 'main': |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L373) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L491) |  |
  | 373 | 491 | // Ensure we are using the main query object ID. |
  | 374 | 492 | $post\_id = $main\_query->get\_queried\_object\_id(); |
  |  | 493 | break; |
  |  | 494 |  |
  |  | 495 | case 'restapi': |
  |  | 496 | case 'restapi/posts': |
  |  | 497 | global $post; |
  |  | 498 |  |
  |  | 499 | $rest\_intent = get\_rest\_api\_intent(); |
  |  | 500 |  |
  |  | 501 | $post\_type\_objeect = get\_post\_type\_object( $post\_type ); |
  |  | 502 |  |
  |  | 503 | // First be sure this is for a singular post type of the right kind. |
  |  | 504 | if ( 'post\_type' !== $rest\_intent['type'] || $post\_type\_objeect->rest\_base !== $rest\_intent['name'] ) { |
  |  | 505 | return false; |
  |  | 506 | } |
  |  | 507 |  |
  |  | 508 | if ( 'restapi' === $context ) { |
  |  | 509 | if ( $rest\_intent['id'] > 0 ) { |
  |  | 510 | $post\_id = (int) $rest\_intent['id']; |
  |  | 511 | } |
  |  | 512 | } elseif ( $post && $post->ID > 0 ) { |
  |  | 513 | $post\_id = $post->ID; |
  |  | 514 | } |
  | 375 | 515 | break; |
  | 376 | 516 |  |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L403) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L543) |  |
  | 403 | 543 | \* |
  | 404 | 544 | \* @since 2.0.0 |
  |  | 545 | \* @since 2.2.0 Added support for REST API. |
  | 405 | 546 | \*/ |
  | 406 | 547 | function content\_is\_taxonomy\_archive() { |
  |  | 548 | // Get settings from the current rule. |
  | 407 | 549 | $taxonomy = get\_rule\_extra( 'taxonomy', '' ); |
  | 408 | 550 |  |
  | 409 |  | $main\_query = get\_main\_wp\_query(); |
  | 410 |  |  |
  | 411 |  | // No context needed, always looking for main query only. |
  | 412 |  | switch ( $taxonomy ) { |
  | 413 |  | case 'category': |
  | 414 |  | return $main\_query->is\_category(); |
  | 415 |  | case 'post\_tag': |
  | 416 |  | return $main\_query->is\_tag(); |
  | 417 |  | default: |
  | 418 |  | return $main\_query->is\_tax( $taxonomy ); |
  |  | 551 | // Get query context. |
  |  | 552 | $context = current\_query\_context(); |
  |  | 553 |  |
  |  | 554 | switch ( $context ) { |
  |  | 555 | // Handle detection of rest taxonomy endpoint. |
  |  | 556 | case 'restapi': |
  |  | 557 | $rest\_intent = get\_rest\_api\_intent(); |
  |  | 558 |  |
  |  | 559 | if ( 'taxonomy' !== $rest\_intent['type'] ) { |
  |  | 560 | return false; |
  |  | 561 | } |
  |  | 562 |  |
  |  | 563 | $taxonomy\_object = get\_taxonomy( $taxonomy ); |
  |  | 564 |  |
  |  | 565 | return $taxonomy\_object && $rest\_intent['name'] === $taxonomy\_object->rest\_base; |
  |  | 566 |  |
  |  | 567 | case 'restapi/terms': |
  |  | 568 | // This is a term query, so we we aren't checking against a taxonomy archive. |
  |  | 569 | return false; |
  |  | 570 |  |
  |  | 571 | default: |
  |  | 572 | $main\_query = get\_main\_wp\_query(); |
  |  | 573 |  |
  |  | 574 | // No context needed, always looking for main query only. |
  |  | 575 | switch ( $taxonomy ) { |
  |  | 576 | case 'category': |
  |  | 577 | return $main\_query->is\_category(); |
  |  | 578 | case 'post\_tag': |
  |  | 579 | return $main\_query->is\_tag(); |
  |  | 580 | default: |
  |  | 581 | return $main\_query->is\_tax( $taxonomy ); |
  |  | 582 | } |
  | 419 | 583 | } |
  | 420 | 584 | } |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L426) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L590) |  |
  | 426 | 590 | \* |
  | 427 | 591 | \* @since 2.0.0 |
  |  | 592 | \* @since 2.2.0 Added support for REST API. |
  | 428 | 593 | \*/ |
  | 429 | 594 | function content\_is\_selected\_term() { |
  | 430 |  | $main\_query = get\_main\_wp\_query(); |
  | 431 |  |  |
  |  | 595 | // Get settings from the current rule. |
  | 432 | 596 | $taxonomy = get\_rule\_extra( 'taxonomy', '' ); |
  | 433 | 597 | // Handle array of string or int, and comman list. |
  | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=2969631#L436) | […](/browser/content-control/trunk/inc/functions/rule-callbacks.php?rev=3052982#L600) |  |
  | 436 | 600 | ); |
  | 437 | 601 |  |
  | 438 |  | switch ( $taxonomy ) { |
  | 439 |  | case 'category': |
  | 440 |  | return $main\_query->is\_category( $selected ); |
  | 441 |  | case 'post\_tag': |
  | 442 |  | return $main\_query->is\_tag( $selected ); |
  | 443 |  | default: |
  | 444 |  | return $main\_query->is\_tax( $taxonomy, $selected ); |
  | 445 |  | } |
  | 446 |  | } |
  |  | 602 | // Get query context. |
  |  | 603 | $context = current\_query\_context(); |
  |  | 604 |  |
  |  | 605 | // Handle detection of rest taxonomy endpoint. |
  |  | 606 | switch ( $context ) { |
  |  | 607 | default: |
  |  | 608 | // Get main query for 'main' context. |
  |  | 609 | $main\_query = get\_main\_wp\_query(); |
  |  | 610 |  |
  |  | 611 | // Handle everything else. |
  |  | 612 | switch ( $taxonomy ) { |
  |  | 613 | case 'category': |
  |  | 614 | return $main\_query->is\_category( $selected ); |
  |  | 615 | case 'post\_tag': |
  |  | 616 | return $main\_query->is\_tag( $selected ); |
  |  | 617 | default: |
  |  | 618 | return $main\_query->is\_tax( $taxonomy, $selected ); |
  |  | 619 | } |
  |  | 620 |  |
  |  | 621 | // Handles REST API querys. |
  |  | 622 | case 'restapi': |
  |  | 623 | case 'restapi/terms': |
  |  | 624 | global $cc\_term; |
  |  | 625 | $rest\_intent = get\_rest\_api\_intent(); |
  |  | 626 |  |
  |  | 627 | // Check if this is a taxonomy endpoint. |
  |  | 628 | if ( 'taxonomy' !== $rest\_intent['type'] ) { |
  |  | 629 | return false; |
  |  | 630 | } |
  |  | 631 |  |
  |  | 632 | // Get taxonomy object for the rest base. |
  |  | 633 | $taxonomy\_object = get\_taxonomy( $taxonomy ); |
  |  | 634 |  |
  |  | 635 | if ( ! $taxonomy\_object || $rest\_intent['name'] !== $taxonomy\_object->rest\_base ) { |
  |  | 636 | return false; |
  |  | 637 | } |
  |  | 638 |  |
  |  | 639 | // Check if we have a term ID from the rest intent. |
  |  | 640 | if ( $rest\_intent['id'] > 0 ) { |
  |  | 641 | return in\_array( (int) $rest\_intent['id'], $selected, true ); |
  |  | 642 | } |
  |  | 643 |  |
  |  | 644 | // Check if we have a term object from the term query. |
  |  | 645 | if ( $cc\_term && $cc\_term->term\_id > 0 ) { |
  |  | 646 | return in\_array( (int) $cc\_term->term\_id, $selected, true ); |
  |  | 647 | } |
  |  | 648 |  |
  |  | 649 | // Always return false if no ID is set. |
  |  | 650 | return false; |
  |  | 651 | } |
  |  | 652 | } |
* ## [content-control/trunk/readme.txt](/changeset/3052981/content-control/trunk/readme.txt?old=3007198&old_path=content-control%2Ftrunk%2Freadme.txt "Show the [3007200:3052982] differences restricted to content-control/trunk/readme.txt")

  | [r3007200](/browser/content-control/trunk/readme.txt?rev=3007198#L1 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/readme.txt?rev=3052981#L1 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === Content Control - The Ultimate Content Restriction Plugin! Restrict Content, Create Conditional Blocks & More === |
  | 2 | 2 | Contributors: codeatlantic, danieliser |
  | 3 |  | ~~Author~~ URI: https://code-atlantic.com/?utm\_campaign=upgrade-to-pro&utm\_source=plugins-page&utm\_medium=plugin-ui&utm\_content=action-links-upgrade-text |
  | 4 |  | ~~Plugin~~ URI: https://contentcontrolplugin.com/?utm\_campaign=plugin-info&utm\_source=readme-header&utm\_medium=plugin-ui&utm\_content=author-uri |
  |  | 3 | Plugin URI: https://code-atlantic.com/?utm\_campaign=upgrade-to-pro&utm\_source=plugins-page&utm\_medium=plugin-ui&utm\_content=action-links-upgrade-text |
  |  | 4 | Author URI: https://contentcontrolplugin.com/?utm\_campaign=plugin-info&utm\_source=readme-header&utm\_medium=plugin-ui&utm\_content=author-uri |
  | 5 | 5 | Donate link: https://code-atlantic.com/donate/?utm\_campaign=donations&utm\_source=readme-header&utm\_medium=plugin-ui&utm\_content=donate-link |
  | 6 | 6 | Tags: access control, content, content restriction, permission, private, restrict, restrict access, restriction, user, visibility, widget, block visibility, user access, coming soon, maintenance mode, access manager, paywall |
  | 7 | 7 | Requires at least: 6.2 |
  | 8 |  | Tested up to: 6.~~4~~ |
  | 9 |  | Stable tag: 2.~~1~~.0 |
  |  | 8 | Tested up to: 6.5.0 |
  |  | 9 | Stable tag: 2.2.0 |
  | 10 | 10 | Requires PHP: 7.4 |
  | 11 | 11 | License: GPLv3 (or later) |
  | […](/browser/content-control/trunk/readme.txt?rev=3007198#L43) | […](/browser/content-control/trunk/readme.txt?rev=3052981#L43) |  |
  | 43 | 43 | - Control widget visibility by selecting the user type that can view each widget. |
  | 44 | 44 | - Conditionally show coming soon or maintenance mode pages based on various rules. |
  |  | 45 | - Restrict access to your site's REST API endpoints. |
  | 45 | 46 |  |
  | 46 | 47 | [Content Control Documentation](https://contentcontrolplugin.com/docs/?utm\_campaign=plugin-info&utm\_source=readme-description&utm\_medium=wordpress&utm\_content=documentation-link) |
  | […](/browser/content-control/trunk/readme.txt?rev=3007198#L104) | […](/browser/content-control/trunk/readme.txt?rev=3052981#L105) |  |
  | 104 | 105 |  |
  | 105 | 106 | == Changelog == |
  |  | 107 |  |
  |  | 108 | = v2.2.0 - 03/17/2024 = |
  |  | 109 |  |
  |  | 110 | - Feature: Add support for [restricing content in the REST API](https://contentcontrolplugin.com/features/rest-api/). |
  |  | 111 | - Feature: Add support for terms in WP term queries. |
  |  | 112 | - Fix: Nav Menu Link user rule not working properly. |
  |  | 113 | - Fix: Prevent "Required Upgrade" notices on new installs. |
  |  | 114 | - Tweak: Only show "Required Upgrade" notices to admins with plugin management permissions. |
  |  | 115 | - Dev:: Added new field type `userselect` for choosing users with search. |
  | 106 | 116 |  |
  | 107 | 117 | = v2.1.0 - 12/08/2023 = |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Container.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Container.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FContainer.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Container.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Container.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Container.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/ExpectedInvokableException.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/ExpectedInvokableException.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FException%2FExpectedInvokableException.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/ExpectedInvokableException.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/ExpectedInvokableException.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/ExpectedInvokableException.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/FrozenServiceException.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/FrozenServiceException.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FException%2FFrozenServiceException.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/FrozenServiceException.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/FrozenServiceException.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/FrozenServiceException.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/InvalidServiceIdentifierException.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/InvalidServiceIdentifierException.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FException%2FInvalidServiceIdentifierException.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/InvalidServiceIdentifierException.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/InvalidServiceIdentifierException.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/InvalidServiceIdentifierException.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/UnknownIdentifierException.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/UnknownIdentifierException.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FException%2FUnknownIdentifierException.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/UnknownIdentifierException.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/UnknownIdentifierException.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Exception/UnknownIdentifierException.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/Container.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/Container.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FPsr11%2FContainer.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/Container.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/Container.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/Container.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/ServiceLocator.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/ServiceLocator.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FPsr11%2FServiceLocator.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/ServiceLocator.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/ServiceLocator.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Psr11/ServiceLocator.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceIterator.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceIterator.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FServiceIterator.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceIterator.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceIterator.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceIterator.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceProviderInterface.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceProviderInterface.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FServiceProviderInterface.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceProviderInterface.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceProviderInterface.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/ServiceProviderInterface.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Invokable.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Invokable.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FFixtures%2FInvokable.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Invokable.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Invokable.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Invokable.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/NonInvokable.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/NonInvokable.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FFixtures%2FNonInvokable.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/NonInvokable.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/NonInvokable.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/NonInvokable.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/PimpleServiceProvider.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/PimpleServiceProvider.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FFixtures%2FPimpleServiceProvider.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/PimpleServiceProvider.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/PimpleServiceProvider.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/PimpleServiceProvider.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Service.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Service.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FFixtures%2FService.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Service.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Service.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Fixtures/Service.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleServiceProviderInterfaceTest.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleServiceProviderInterfaceTest.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FPimpleServiceProviderInterfaceTest.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleServiceProviderInterfaceTest.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleServiceProviderInterfaceTest.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleServiceProviderInterfaceTest.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleTest.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleTest.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FPimpleTest.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleTest.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleTest.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/PimpleTest.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ContainerTest.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ContainerTest.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FPsr11%2FContainerTest.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ContainerTest.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ContainerTest.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ContainerTest.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ServiceLocatorTest.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ServiceLocatorTest.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FPsr11%2FServiceLocatorTest.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ServiceLocatorTest.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ServiceLocatorTest.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/Psr11/ServiceLocatorTest.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/ServiceIteratorTest.php](/changeset/3052982/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/ServiceIteratorTest.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpimple%2Fpimple%2Fsrc%2FPimple%2FTests%2FServiceIteratorTest.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/ServiceIteratorTest.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/ServiceIteratorTest.php?rev=3007200#L24 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/pimple/pimple/src/Pimple/Tests/ServiceIteratorTest.php?rev=3052982#L24 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | \* THE SOFTWARE. |
  | 25 | 25 | \* |
  | 26 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 26 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 27 | 27 | \*/ |
  | 28 | 28 |  |
* ## [content-control/trunk/vendor-prefixed/psr/container/src/ContainerExceptionInterface.php](/changeset/3052982/content-control/trunk/vendor-prefixed/psr/container/src/ContainerExceptionInterface.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpsr%2Fcontainer%2Fsrc%2FContainerExceptionInterface.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/psr/container/src/ContainerExceptionInterface.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/psr/container/src/ContainerExceptionInterface.php?rev=3007200#L3 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/psr/container/src/ContainerExceptionInterface.php?rev=3052982#L3 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @license MIT |
  | 4 | 4 | \* |
  | 5 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 5 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 6 | 6 | \*/ |
  | 7 | 7 |  |
* ## [content-control/trunk/vendor-prefixed/psr/container/src/ContainerInterface.php](/changeset/3052982/content-control/trunk/vendor-prefixed/psr/container/src/ContainerInterface.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpsr%2Fcontainer%2Fsrc%2FContainerInterface.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/psr/container/src/ContainerInterface.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/psr/container/src/ContainerInterface.php?rev=3007200#L3 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/psr/container/src/ContainerInterface.php?rev=3052982#L3 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @license MIT |
  | 4 | 4 | \* |
  | 5 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 5 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 6 | 6 | \*/ |
  | 7 | 7 |  |
* ## [content-control/trunk/vendor-prefixed/psr/container/src/NotFoundExceptionInterface.php](/changeset/3052982/content-control/trunk/vendor-prefixed/psr/container/src/NotFoundExceptionInterface.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Fpsr%2Fcontainer%2Fsrc%2FNotFoundExceptionInterface.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/psr/container/src/NotFoundExceptionInterface.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/psr/container/src/NotFoundExceptionInterface.php?rev=3007200#L3 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/psr/container/src/NotFoundExceptionInterface.php?rev=3052982#L3 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @license MIT |
  | 4 | 4 | \* |
  | 5 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 5 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 6 | 6 | \*/ |
  | 7 | 7 |  |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Admin.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Admin.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FAdmin.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Admin.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Admin.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Admin.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Ajax.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Ajax.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FAjax.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Ajax.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Ajax.php?rev=3007200#L3 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Ajax.php?rev=3052982#L3 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @license GPL-2.0-or-later |
  | 4 | 4 | \* |
  | 5 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 5 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 6 | 6 | \*/ |
  | 7 | 7 |  |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FClient.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php?rev=3007200#L19 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php?rev=3052982#L19 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 | \* |
  | 20 | 20 | \* @license GPL-2.0-or-later |
  | 21 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 21 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 22 | 22 | \*/ |
  | 23 | 23 |  |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php?rev=3007200#L41) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php?rev=3052982#L41) |  |
  | 41 | 41 | \* @since 1.0.0 |
  | 42 | 42 | \*/ |
  | 43 |  | const VERSION = '1.~~6.1~~'; |
  |  | 43 | const VERSION = '1.7.0'; |
  | 44 | 44 |  |
  | 45 | 45 | /\*\* |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php?rev=3007200#L529) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Client.php?rev=3052982#L529) |  |
  | 529 | 529 |  |
  | 530 | 530 | foreach ( $users as $user ) { |
  | 531 |  | $this->revoke\_access( $this->support\_user->get\_user\_identifier( $user ) ); |
  |  | 531 | $user\_identifier = $this->support\_user->get\_user\_identifier( $user ); |
  |  | 532 |  |
  |  | 533 | // Errors are already logged in the get\_user\_identifier() method. |
  |  | 534 | if ( is\_wp\_error( $user\_identifier ) ) { |
  |  | 535 | continue; |
  |  | 536 | } |
  |  | 537 |  |
  |  | 538 | $this->revoke\_access( $user\_identifier ); |
  | 532 | 539 | } |
  | 533 | 540 | } |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Config.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Config.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FConfig.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Config.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Config.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Config.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Cron.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Cron.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FCron.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Cron.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Cron.php?rev=3007200#L3 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Cron.php?rev=3052982#L3 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @license GPL-2.0-or-later |
  | 4 | 4 | \* |
  | 5 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 5 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 6 | 6 | \*/ |
  | 7 | 7 |  |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FEncryption.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 | namespace ContentControl\Vendor\TrustedLogin; |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3007200#L48) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3052982#L48) |  |
  | 48 | 48 | \*/ |
  | 49 | 49 | private $vendor\_public\_key\_endpoint = '/trustedlogin/v1/public\_key'; |
  |  | 50 |  |
  |  | 51 | /\*\* |
  |  | 52 | \* @var int How long to store the Vendor public key in the database. |
  |  | 53 | \* @since 1.7.0 |
  |  | 54 | \*/ |
  |  | 55 | const VENDOR\_PUBLIC\_KEY\_EXPIRY = 60 \* 10; // 10 minutes. |
  | 50 | 56 |  |
  | 51 | 57 | /\*\* |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3007200#L209) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3052982#L215) |  |
  | 209 | 215 |  |
  | 210 | 216 | // Already stored as transient |
  | 211 |  | $public\_key = ~~get\_site~~\_transient( $this->vendor\_public\_key\_option ); |
  |  | 217 | $public\_key = Utils::get\_transient( $this->vendor\_public\_key\_option ); |
  | 212 | 218 |  |
  | 213 | 219 | if ( $public\_key ) { |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3007200#L226) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Encryption.php?rev=3052982#L232) |  |
  | 226 | 232 | } |
  | 227 | 233 |  |
  | 228 |  | // ~~Attempt to store Vendor public key in the DB for ten minutes (may be overridden by caching plugins)~~ |
  | 229 |  | $saved = ~~set\_site\_transient( $this->vendor\_public\_key\_option, $remote\_key, 60 \* 10~~ ); |
  |  | 234 | // Store Vendor public key in the DB for ten minutes. |
  |  | 235 | $saved = Utils::set\_transient( $this->vendor\_public\_key\_option, $remote\_key, self::VENDOR\_PUBLIC\_KEY\_EXPIRY ); |
  | 230 | 236 |  |
  | 231 | 237 | if ( ! $saved ) { |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FEndpoint.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3007200#L107) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3052982#L107) |  |
  | 107 | 107 |  |
  | 108 | 108 | /\*\* |
  | 109 |  | \* Check if the endpoint is hit and has a valid identifier before automatically logging in support agent |
  |  | 109 | \* Check if the endpoint is hit and has a valid identifier before automatically logging in support agent. |
  | 110 | 110 | \* |
  | 111 | 111 | \* @since 1.0.0 |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3007200#L142) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3052982#L142) |  |
  | 142 | 142 |  |
  | 143 | 143 | /\*\* |
  | 144 |  | \* Runs before the support user is (maybe) logged-in |
  | 145 |  | \* |
  | 146 |  | \* @param string $user\_identifier Unique identifier for support user. |
  |  | 144 | \* Runs before the support user is (maybe) logged-in, but after the endpoint is verified. |
  |  | 145 | \* |
  |  | 146 | \* @param string $user\_identifier Unique identifier for support user, sanitized using {@see sanitize\_text\_field}. |
  | 147 | 147 | \*/ |
  | 148 | 148 | do\_action( 'trustedlogin/' . $this->config->ns() . '/login/before', $user\_identifier ); |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3007200#L156) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3052982#L156) |  |
  | 156 | 156 |  |
  | 157 | 157 | /\*\* |
  | 158 |  | \* Runs after the identifier fails security checks |
  |  | 158 | \* Runs after the identifier fails security checks. |
  | 159 | 159 | \* |
  | 160 | 160 | \* @param string $user\_identifier Unique identifier for support user. |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3007200#L182) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3052982#L182) |  |
  | 182 | 182 |  |
  | 183 | 183 | /\*\* |
  | 184 |  | \* Runs after the support user is logged-in |
  |  | 184 | \* Runs after the support user is logged-in. |
  | 185 | 185 | \* |
  | 186 | 186 | \* @param string $user\_identifier Unique Identifier for support user. |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3007200#L239) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Endpoint.php?rev=3052982#L239) |  |
  | 239 | 239 | \* Trigger action to revoke access based on Support User identifier. |
  | 240 | 240 | \* |
  | 241 |  | \* ~~Hooked into~~ by Cron::revoke |
  |  | 241 | \* @used-by Cron::revoke |
  | 242 | 242 | \* |
  | 243 | 243 | \* @param string $user\_identifier Unique ID for TrustedLogin support user or "all". |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Envelope.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Envelope.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FEnvelope.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Envelope.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Envelope.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Envelope.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 | namespace ContentControl\Vendor\TrustedLogin; |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Form.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Form.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FForm.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Form.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Form.php?rev=3007200#L3 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Form.php?rev=3052982#L3 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @license GPL-2.0-or-later |
  | 4 | 4 | \* |
  | 5 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 5 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 6 | 6 | \*/ |
  | 7 | 7 |  |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logger.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logger.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FLogger.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logger.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logger.php?rev=3007200#L3 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logger.php?rev=3052982#L3 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* @license GPL-2.0-or-later |
  | 4 | 4 | \* |
  | 5 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 5 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 6 | 6 | \*/ |
  | 7 | 7 | namespace ContentControl\Vendor\TrustedLogin; |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logging.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logging.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FLogging.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logging.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logging.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Logging.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 | namespace ContentControl\Vendor\TrustedLogin; |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/Remote.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Remote.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FRemote.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/Remote.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Remote.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/Remote.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FSecurityChecks.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 | namespace ContentControl\Vendor\TrustedLogin; |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3007200#L166) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3052982#L166) |  |
  | 166 | 166 | private function maybe\_add\_used\_accesskey( $user\_identifier = '' ) { |
  | 167 | 167 |  |
  | 168 |  | $used\_accesskeys = (array) ~~get\_site~~\_transient( $this->used\_accesskey\_transient ); |
  |  | 168 | $used\_accesskeys = (array) Utils::get\_transient( $this->used\_accesskey\_transient ); |
  | 169 | 169 |  |
  | 170 | 170 | // This is a new access key |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3007200#L173) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3052982#L173) |  |
  | 173 | 173 | $used\_accesskeys[] = $user\_identifier; |
  | 174 | 174 |  |
  | 175 |  | $transient\_set = ~~set\_site~~\_transient( $this->used\_accesskey\_transient, $used\_accesskeys, self::ACCESSKEY\_LIMIT\_EXPIRY ); |
  |  | 175 | $transient\_set = Utils::set\_transient( $this->used\_accesskey\_transient, $used\_accesskeys, self::ACCESSKEY\_LIMIT\_EXPIRY ); |
  | 176 | 176 |  |
  | 177 | 177 | if ( ! $transient\_set ) { |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3007200#L295) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3052982#L295) |  |
  | 295 | 295 | $this->logging->log( 'Brute force is detected; starting lockdown.', \_\_METHOD\_\_, 'emergency' ); |
  | 296 | 296 |  |
  | 297 |  | $transient\_set = ~~set\_site~~\_transient( $this->in\_lockdown\_transient, time(), self::LOCKDOWN\_EXPIRY ); |
  |  | 297 | $transient\_set = Utils::set\_transient( $this->in\_lockdown\_transient, time(), self::LOCKDOWN\_EXPIRY ); |
  | 298 | 298 |  |
  | 299 | 299 | if ( ! $transient\_set ) { |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3007200#L308) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3052982#L308) |  |
  | 308 | 308 |  |
  | 309 | 309 | /\*\* |
  | 310 |  | \* Runs after the site is locked down to access from the Vendor |
  |  | 310 | \* Runs after the site is locked down to access from the Vendor. |
  | 311 | 311 | \*/ |
  | 312 | 312 | do\_action( 'trustedlogin/' . $this->config->ns() . '/lockdown/after' ); |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3007200#L362) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SecurityChecks.php?rev=3052982#L362) |  |
  | 362 | 362 | } |
  | 363 | 363 |  |
  | 364 |  | return ~~get\_site~~\_transient( $this->in\_lockdown\_transient ); |
  |  | 364 | return Utils::get\_transient( $this->in\_lockdown\_transient ); |
  | 365 | 365 | } |
  | 366 | 366 |  |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/SiteAccess.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SiteAccess.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FSiteAccess.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/SiteAccess.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SiteAccess.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SiteAccess.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SiteAccess.php?rev=3007200#L200) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SiteAccess.php?rev=3052982#L200) |  |
  | 200 | 200 | } |
  | 201 | 201 |  |
  | 202 |  | $body = array( |
  | 203 |  | 'publicKey' => $this->config->get\_setting( 'auth/api\_key' ), |
  | 204 |  | ); |
  | 205 |  |  |
  | 206 |  | $api\_response = $remote->send( 'sites/' . $secret\_id, $body, 'DELETE' ); |
  |  | 202 | $api\_response = $remote->send( 'sites/' . $secret\_id, array(), 'DELETE' ); |
  | 207 | 203 |  |
  | 208 | 204 | if ( is\_wp\_error( $api\_response ) ) { |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportRole.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportRole.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FSupportRole.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportRole.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportRole.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportRole.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 | namespace ContentControl\Vendor\TrustedLogin; |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportRole.php?rev=3007200#L177) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportRole.php?rev=3052982#L177) |  |
  | 177 | 177 | \* @return string |
  | 178 | 178 | \*/ |
  | 179 |  | static p~~rivate~~ function get\_capability\_flag( $ns ) { |
  |  | 179 | static public function get\_capability\_flag( $ns ) { |
  | 180 | 180 | return str\_replace( '{ns}', $ns, self::CAPABILITY\_FLAG ); |
  | 181 | 181 | } |
* ## [content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportUser.php](/changeset/3052982/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportUser.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor-prefixed%2Ftrustedlogin%2Fclient%2Fsrc%2FSupportUser.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportUser.php")

  | [r3007200](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportUser.php?rev=3007200#L8 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportUser.php?rev=3052982#L8 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | \* |
  | 9 | 9 | \* @license GPL-2.0-or-later |
  | 10 |  | \* Modified by code-atlantic on ~~08-December-2023~~ using {@see https://github.com/BrianHenryIE/strauss}. |
  |  | 10 | \* Modified by code-atlantic on 17-March-2024 using {@see https://github.com/BrianHenryIE/strauss}. |
  | 11 | 11 | \*/ |
  | 12 | 12 | namespace ContentControl\Vendor\TrustedLogin; |
  | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportUser.php?rev=3007200#L103) | […](/browser/content-control/trunk/vendor-prefixed/trustedlogin/client/src/SupportUser.php?rev=3052982#L103) |  |
  | 103 | 103 | case 'created\_by\_meta\_key': |
  | 104 | 104 | return $this->{$name}; |
  | 105 |  | ~~break;~~ |
  | 106 | 105 | } |
  | 107 | 106 |  |
* ## [content-control/trunk/vendor/autoload.php](/changeset/3052982/content-control/trunk/vendor/autoload.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor%2Fautoload.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor/autoload.php")

  | [r3007200](/browser/content-control/trunk/vendor/autoload.php?rev=3007200#L23 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor/autoload.php?rev=3052982#L23 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | require\_once \_\_DIR\_\_ . '/composer/autoload\_real.php'; |
  | 24 | 24 |  |
  | 25 |  | return ComposerAutoloaderInit~~cdb71d3d3b2a90ce94d4553380a52504~~::getLoader(); |
  |  | 25 | return ComposerAutoloaderInit853ae0679741ef2cc10dcfede9bac995::getLoader(); |
* ## [content-control/trunk/vendor/composer/autoload\_classmap.php](/changeset/3052982/content-control/trunk/vendor/composer/autoload_classmap.php?old=2974933&old_path=content-control%2Ftrunk%2Fvendor%2Fcomposer%2Fautoload_classmap.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor/composer/autoload_classmap.php")

  | [r3007200](/browser/content-control/trunk/vendor/composer/autoload_classmap.php?rev=2974933#L126 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor/composer/autoload_classmap.php?rev=3052982#L126 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 126 | 126 | 'ContentControl\\Controllers\\Frontend\\Restrictions\\PostContent' => $baseDir . '/classes/Controllers/Frontend/Restrictions/PostContent.php', |
  | 127 | 127 | 'ContentControl\\Controllers\\Frontend\\Restrictions\\QueryPosts' => $baseDir . '/classes/Controllers/Frontend/Restrictions/QueryPosts.php', |
  |  | 128 | 'ContentControl\\Controllers\\Frontend\\Restrictions\\QueryTerms' => $baseDir . '/classes/Controllers/Frontend/Restrictions/QueryTerms.php', |
  |  | 129 | 'ContentControl\\Controllers\\Frontend\\Restrictions\\RestAPI' => $baseDir . '/classes/Controllers/Frontend/Restrictions/RestAPI.php', |
  | 128 | 130 | 'ContentControl\\Controllers\\Frontend\\Widgets' => $baseDir . '/classes/Controllers/Frontend/Widgets.php', |
  | 129 | 131 | 'ContentControl\\Controllers\\PostTypes' => $baseDir . '/classes/Controllers/PostTypes.php', |
  | […](/browser/content-control/trunk/vendor/composer/autoload_classmap.php?rev=2974933#L205) | […](/browser/content-control/trunk/vendor/composer/autoload_classmap.php?rev=3052982#L207) |  |
  | 205 | 207 | 'ContentControl\\Vendor\\TrustedLogin\\SupportRole' => $baseDir . '/vendor-prefixed/trustedlogin/client/src/SupportRole.php', |
  | 206 | 208 | 'ContentControl\\Vendor\\TrustedLogin\\SupportUser' => $baseDir . '/vendor-prefixed/trustedlogin/client/src/SupportUser.php', |
  |  | 209 | 'ContentControl\\Vendor\\TrustedLogin\\Utils' => $baseDir . '/vendor-prefixed/trustedlogin/client/src/Utils.php', |
  | 207 | 210 | ); |
* ## [content-control/trunk/vendor/composer/autoload\_real.php](/changeset/3052982/content-control/trunk/vendor/composer/autoload_real.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor%2Fcomposer%2Fautoload_real.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor/composer/autoload_real.php")

  | [r3007200](/browser/content-control/trunk/vendor/composer/autoload_real.php?rev=3007200#L3 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor/composer/autoload_real.php?rev=3052982#L3 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | // autoload\_real.php @generated by Composer |
  | 4 | 4 |  |
  | 5 |  | class ComposerAutoloaderInit~~cdb71d3d3b2a90ce94d4553380a52504~~ |
  |  | 5 | class ComposerAutoloaderInit853ae0679741ef2cc10dcfede9bac995 |
  | 6 | 6 | { |
  | 7 | 7 | private static $loader; |
  | […](/browser/content-control/trunk/vendor/composer/autoload_real.php?rev=3007200#L25) | […](/browser/content-control/trunk/vendor/composer/autoload_real.php?rev=3052982#L25) |  |
  | 25 | 25 | require \_\_DIR\_\_ . '/platform\_check.php'; |
  | 26 | 26 |  |
  | 27 |  | spl\_autoload\_register(array('ComposerAutoloaderInit~~cdb71d3d3b2a90ce94d4553380a52504~~', 'loadClassLoader'), true, true); |
  |  | 27 | spl\_autoload\_register(array('ComposerAutoloaderInit853ae0679741ef2cc10dcfede9bac995', 'loadClassLoader'), true, true); |
  | 28 | 28 | self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(\_\_DIR\_\_)); |
  | 29 |  | spl\_autoload\_unregister(array('ComposerAutoloaderInit~~cdb71d3d3b2a90ce94d4553380a52504~~', 'loadClassLoader')); |
  |  | 29 | spl\_autoload\_unregister(array('ComposerAutoloaderInit853ae0679741ef2cc10dcfede9bac995', 'loadClassLoader')); |
  | 30 | 30 |  |
  | 31 | 31 | require \_\_DIR\_\_ . '/autoload\_static.php'; |
  | 32 |  | call\_user\_func(\Composer\Autoload\ComposerStaticInit~~cdb71d3d3b2a90ce94d4553380a52504~~::getInitializer($loader)); |
  |  | 32 | call\_user\_func(\Composer\Autoload\ComposerStaticInit853ae0679741ef2cc10dcfede9bac995::getInitializer($loader)); |
  | 33 | 33 |  |
  | 34 | 34 | $loader->register(true); |
* ## [content-control/trunk/vendor/composer/autoload\_static.php](/changeset/3052982/content-control/trunk/vendor/composer/autoload_static.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor%2Fcomposer%2Fautoload_static.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor/composer/autoload_static.php")

  | [r3007200](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3007200#L5 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3052982#L5 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | namespace Composer\Autoload; |
  | 6 | 6 |  |
  | 7 |  | class ComposerStaticInit~~cdb71d3d3b2a90ce94d4553380a52504~~ |
  |  | 7 | class ComposerStaticInit853ae0679741ef2cc10dcfede9bac995 |
  | 8 | 8 | { |
  | 9 | 9 | public static $prefixLengthsPsr4 = array ( |
  | […](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3007200#L146) | […](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3052982#L146) |  |
  | 146 | 146 | 'ContentControl\\Controllers\\Frontend\\Restrictions\\PostContent' => \_\_DIR\_\_ . '/../..' . '/classes/Controllers/Frontend/Restrictions/PostContent.php', |
  | 147 | 147 | 'ContentControl\\Controllers\\Frontend\\Restrictions\\QueryPosts' => \_\_DIR\_\_ . '/../..' . '/classes/Controllers/Frontend/Restrictions/QueryPosts.php', |
  |  | 148 | 'ContentControl\\Controllers\\Frontend\\Restrictions\\QueryTerms' => \_\_DIR\_\_ . '/../..' . '/classes/Controllers/Frontend/Restrictions/QueryTerms.php', |
  |  | 149 | 'ContentControl\\Controllers\\Frontend\\Restrictions\\RestAPI' => \_\_DIR\_\_ . '/../..' . '/classes/Controllers/Frontend/Restrictions/RestAPI.php', |
  | 148 | 150 | 'ContentControl\\Controllers\\Frontend\\Widgets' => \_\_DIR\_\_ . '/../..' . '/classes/Controllers/Frontend/Widgets.php', |
  | 149 | 151 | 'ContentControl\\Controllers\\PostTypes' => \_\_DIR\_\_ . '/../..' . '/classes/Controllers/PostTypes.php', |
  | […](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3007200#L225) | […](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3052982#L227) |  |
  | 225 | 227 | 'ContentControl\\Vendor\\TrustedLogin\\SupportRole' => \_\_DIR\_\_ . '/../..' . '/vendor-prefixed/trustedlogin/client/src/SupportRole.php', |
  | 226 | 228 | 'ContentControl\\Vendor\\TrustedLogin\\SupportUser' => \_\_DIR\_\_ . '/../..' . '/vendor-prefixed/trustedlogin/client/src/SupportUser.php', |
  |  | 229 | 'ContentControl\\Vendor\\TrustedLogin\\Utils' => \_\_DIR\_\_ . '/../..' . '/vendor-prefixed/trustedlogin/client/src/Utils.php', |
  | 227 | 230 | ); |
  | 228 | 231 |  |
  | […](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3007200#L230) | […](/browser/content-control/trunk/vendor/composer/autoload_static.php?rev=3052982#L233) |  |
  | 230 | 233 | { |
  | 231 | 234 | return \Closure::bind(function () use ($loader) { |
  | 232 |  | $loader->prefixLengthsPsr4 = ComposerStaticInit~~cdb71d3d3b2a90ce94d4553380a52504~~::$prefixLengthsPsr4; |
  | 233 |  | $loader->prefixDirsPsr4 = ComposerStaticInit~~cdb71d3d3b2a90ce94d4553380a52504~~::$prefixDirsPsr4; |
  | 234 |  | $loader->classMap = ComposerStaticInit~~cdb71d3d3b2a90ce94d4553380a52504~~::$classMap; |
  |  | 235 | $loader->prefixLengthsPsr4 = ComposerStaticInit853ae0679741ef2cc10dcfede9bac995::$prefixLengthsPsr4; |
  |  | 236 | $loader->prefixDirsPsr4 = ComposerStaticInit853ae0679741ef2cc10dcfede9bac995::$prefixDirsPsr4; |
  |  | 237 | $loader->classMap = ComposerStaticInit853ae0679741ef2cc10dcfede9bac995::$classMap; |
  | 235 | 238 |  |
  | 236 | 239 | }, null, ClassLoader::class); |
* ## [content-control/trunk/vendor/composer/installed.json](/changeset/3052982/content-control/trunk/vendor/composer/installed.json?old=2984302&old_path=content-control%2Ftrunk%2Fvendor%2Fcomposer%2Finstalled.json "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor/composer/installed.json")

  | [r3007200](/browser/content-control/trunk/vendor/composer/installed.json?rev=2984302#L263 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor/composer/installed.json?rev=3052982#L263 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 263 | 263 | { |
  | 264 | 264 | "name": "trustedlogin/client", |
  | 265 |  | "version": "v1.~~6.1~~", |
  | 266 |  | "version\_normalized": "1.~~6.1~~.0", |
  |  | 265 | "version": "v1.7.0", |
  |  | 266 | "version\_normalized": "1.7.0.0", |
  | 267 | 267 | "source": { |
  | 268 | 268 | "type": "git", |
  | 269 | 269 | "url": "https://github.com/trustedlogin/client.git", |
  | 270 |  | "reference": "~~1c924f8dee1b10624223741b72e5ce83f1e45ce3~~" |
  |  | 270 | "reference": "35938a4bd9749f475518b88d4ce593d27970024c" |
  | 271 | 271 | }, |
  | 272 | 272 | "dist": { |
  | 273 | 273 | "type": "zip", |
  | 274 |  | "url": "https://api.github.com/repos/trustedlogin/client/zipball/~~1c924f8dee1b10624223741b72e5ce83f1e45ce3~~", |
  | 275 |  | "reference": "~~1c924f8dee1b10624223741b72e5ce83f1e45ce3~~", |
  |  | 274 | "url": "https://api.github.com/repos/trustedlogin/client/zipball/35938a4bd9749f475518b88d4ce593d27970024c", |
  |  | 275 | "reference": "35938a4bd9749f475518b88d4ce593d27970024c", |
  | 276 | 276 | "shasum": "" |
  | 277 | 277 | }, |
  | […](/browser/content-control/trunk/vendor/composer/installed.json?rev=2984302#L280) | […](/browser/content-control/trunk/vendor/composer/installed.json?rev=3052982#L280) |  |
  | 280 | 280 | "ext-json": "\*", |
  | 281 | 281 | "php": ">=5.3.0", |
  | 282 |  | "yoast/phpunit-polyfills": "^1.0" |
  | 283 |  | }, |
  | 284 |  | "time": "2023-09-22T17:54:18+00:00", |
  |  | 282 | "spatie/phpunit-watcher": "^1.23", |
  |  | 283 | "yoast/phpunit-polyfills": "^1.1.0" |
  |  | 284 | }, |
  |  | 285 | "time": "2024-01-29T20:51:28+00:00", |
  | 285 | 286 | "bin": [ |
  | 286 | 287 | "bin/build-sass" |
  | […](/browser/content-control/trunk/vendor/composer/installed.json?rev=2984302#L313) | […](/browser/content-control/trunk/vendor/composer/installed.json?rev=3052982#L314) |  |
  | 313 | 314 | "support": { |
  | 314 | 315 | "issues": "https://github.com/trustedlogin/client/issues", |
  | 315 |  | "source": "https://github.com/trustedlogin/client/tree/v1.~~6.1~~" |
  |  | 316 | "source": "https://github.com/trustedlogin/client/tree/v1.7.0" |
  | 316 | 317 | }, |
  | 317 | 318 | "install-path": "../trustedlogin/client" |
* ## [content-control/trunk/vendor/composer/installed.php](/changeset/3052982/content-control/trunk/vendor/composer/installed.php?old=3007200&old_path=content-control%2Ftrunk%2Fvendor%2Fcomposer%2Finstalled.php "Show the [3007200:3052982] differences restricted to content-control/trunk/vendor/composer/installed.php")

  | [r3007200](/browser/content-control/trunk/vendor/composer/installed.php?rev=3007200#L2 "Show revision 3007200 of this file in browser") | [r3052982](/browser/content-control/trunk/vendor/composer/installed.php?rev=3052982#L2 "Show revision 3052982 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | 'root' => array( |
  | 3 | 3 | 'name' => 'code-atlantic/content-control', |
  | 4 |  | 'pretty\_version' => '2.~~1~~.0', |
  | 5 |  | 'version' => '2.~~1~~.0.0', |
  | 6 |  | 'reference' => ~~NULL~~, |
  |  | 4 | 'pretty\_version' => '2.2.0', |
  |  | 5 | 'version' => '2.2.0.0', |
  |  | 6 | 'reference' => null, |
  | 7 | 7 | 'type' => 'wordpress-plugin', |
  | 8 | 8 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/content-control/trunk/vendor/composer/installed.php?rev=3007200#L12) | […](/browser/content-control/trunk/vendor/composer/installed.php?rev=3052982#L12) |  |
  | 12 | 12 | 'versions' => array( |
  | 13 | 13 | 'code-atlantic/content-control' => array( |
  | 14 |  | 'pretty\_version' => '2.~~1~~.0', |
  | 15 |  | 'version' => '2.~~1~~.0.0', |
  | 16 |  | 'reference' => ~~NULL~~, |
  |  | 14 | 'pretty\_version' => '2.2.0', |
  |  | 15 | 'version' => '2.2.0.0', |
  |  | 16 | 'reference' => null, |
  | 17 | 17 | 'type' => 'wordpress-plugin', |
  | 18 | 18 | 'install\_path' => \_\_DIR\_\_ . '/../../', |
  | […](/browser/content-control/trunk/vendor/composer/installed.php?rev=3007200#L48) | […](/browser/content-control/trunk/vendor/composer/installed.php?rev=3052982#L48) |  |
  | 48 | 48 | ), |
  | 49 | 49 | 'trustedlogin/client' => array( |
  | 50 |  | 'pretty\_version' => 'v1.~~6.1~~', |
  | 51 |  | 'version' => '1.~~6.1~~.0', |
  | 52 |  | 'reference' => '~~1c924f8dee1b10624223741b72e5ce83f1e45ce3~~', |
  |  | 50 | 'pretty\_version' => 'v1.7.0', |
  |  | 51 | 'version' => '1.7.0.0', |
  |  | 52 | 'reference' => '35938a4bd9749f475518b88d4ce593d27970024c', |
  | 53 | 53 | 'type' => 'library', |
  | 54 | 54 | 'install\_path' => \_\_DIR\_\_ . '/../trustedlogin/client', |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3052982&old=3007200&new_path=%2Fcontent-control%2Ftrunk&old_path=%2Fcontent-control%2Ftrunk)
* [Zip Archive](?format=zip&new=3052982&old=3007200&new_path=%2Fcontent-control%2Ftrunk&old_path=%2Fcontent-control%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_363d886b_20250111_155914.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Content Control <= 2.1.0 - Missing Authorization to Sensitive Information Exposure

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Content Control <= 2.1.0 - Missing Authorization to Sensitive Information Exposure

5.3

**Exposure of Sensitive Information to an Unauthorized Actor**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

| CVE | [CVE-2024-0615](https://www.cve.org/CVERecord?id=CVE-2024-0615) |
| --- | --- |
| CVSS | 5.3 (Medium) |
| Publicly Published | April 16, 2024 |
| Last Updated | May 2, 2024 |
| Researcher | [Francesco Carlucci](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/francesco-carlucci) |

### Description

The Content Control – The Ultimate Content Restriction Plugin! Restrict Content, Create Conditional Blocks & More plugin for WordPress is vulnerable to Sensitive Information Exposure in all versions up to, and including, 2.1.0 via the API. This makes it possible for unauthenticated attackers to extract post titles, IDs, slugs, statuses and other information including post content. This includes published content only.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3052982%40content-control%2Ftrunk&old=3007200%40content-control%2Ftrunk&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontent-control%2Fcontent-control-210-missing-authorization-to-sensitive-information-exposure&t=Content%20Control%20%3C%3D%202.1.0%20-%20Missing%20Authorization%20to%20Sensitive%20Information%20Exposure "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontent-control%2Fcontent-control-210-missing-authorization-to-sensitive-information-exposure&text=Content%20Control%20%3C%3D%202.1.0%20-%20Missing%20Authorization%20to%20Sensitive%20Information%20Exposure "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontent-control%2Fcontent-control-210-missing-authorization-to-sensitive-information-exposure "LinkedIn")
Email

## Vulnerability Details for Content Control – The Ultimate Content Restriction Plugin! Restrict Content, Create Conditional Blocks & More

#### [Content Control – The Ultimate Content Restriction Plugin! Restrict Content, Create Conditional Blocks & More](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/content-control)

| Software Type | Plugin |
| --- | --- |
| Software Slug | content-control [(view on wordpress.org)](https://wordpress.org/plugins/content-control) |
| Patched? | Yes |
| Remediation | Update to version 2.2.0, or a newer patched version |
| Affected Version | * <= 2.1.0 |
| Patched Version | * 2.2.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


