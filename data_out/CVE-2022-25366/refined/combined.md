=== Content from medium.com_35747f00_20250108_130608.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8004a1e90b26&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftehwinsam.medium.com%2Fcryptomator-1-6-5-dylib-injection-8004a1e90b26&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ftehwinsam.medium.com%2Fcryptomator-1-6-5-dylib-injection-8004a1e90b26&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Cryptomator 1.6.5 Dylib Injection

[![AppleBois](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*U8U1aT69j5xcrlbM)](/?source=post_page---byline--8004a1e90b26--------------------------------)

[AppleBois](/?source=post_page---byline--8004a1e90b26--------------------------------)

¬∑

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F78c54ef5d86b&operation=register&redirect=https%3A%2F%2Ftehwinsam.medium.com%2Fcryptomator-1-6-5-dylib-injection-8004a1e90b26&user=AppleBois&userId=78c54ef5d86b&source=post_page-78c54ef5d86b--byline--8004a1e90b26---------------------post_header-----------)

2 min read¬∑Feb 17, 2022

--

Listen

Share

This module we will learn about Dylib Injection for Cryptomator 1.6.5 in MacOS Application.

First we will just run a codesign on the Cryptomator app, we can see that it‚Äôs has the flag of 0x1000 runtime hardened flag. But, there are interesting entitlement that was set to TRUE. For Dylib Injection, we are interested in Disable Library Validation and Allow Dylib Environment Variable.

![]()

Codesign output

If you are un-familiar with Dylib Injection, I will include several references for the reading.

When we see the entitlement of ‚Äúcom.apple.security.cs.disable-library-validation‚Äù we will know that this allow Dylib Injection, but due to the nature of the application, it will load specific third parties dylib. Which mean we can look for Dylib Proxying or Dylib Hijacking. However, I did not managed to find path for Dylib Proxying or Hijacking.

![]()

Feedback from them

But, since we have another entitlement called ‚Äúcom.apple.security.cs.allow-dyld-environment-variables‚Äù we can specify the ENV variable (DYLD\_INSERT\_LIBRARIES) to the path of our malicious dylib.

Below screenshot is the Source Code of the malicious Dylib

![]()

Source code of the malicious Dylib written in Objective C

Specify the Environment Variable and trigger te Cryptomator Application.

On the terminal we will able to see [+]dylib constructor called from /Applications/Cryptmator.app/Contents/MacOS/Cryptomator.

![]()

Dylib Injection is success

The impact will be it will turn into a code injection, method swizzling, interposting.

The fix should be remove low hanging fruits. Remove the entitlement ‚Äúcom.apple.security.cs.allow-dyld-environment-variables‚Äù

Reference:
<https://wojciechregula.blog/post/dangerous-get-task-allow-entitlement/>
<https://theevilbit.github.io/posts/dyld_insert_libraries_dylib_injection_in_macos_osx_deep_dive/>
<https://cryptomator.org/>

--

--

[![AppleBois](https://miro.medium.com/v2/resize:fill:96:96/0*U8U1aT69j5xcrlbM)](/?source=post_page---post_author_info--8004a1e90b26--------------------------------)[![AppleBois](https://miro.medium.com/v2/resize:fill:128:128/0*U8U1aT69j5xcrlbM)](/?source=post_page---post_author_info--8004a1e90b26--------------------------------)Follow[## Written by AppleBois](/?source=post_page---post_author_info--8004a1e90b26--------------------------------)[23 Followers](/followers?source=post_page---post_author_info--8004a1e90b26--------------------------------)¬∑[1 Following](/following?source=post_page---post_author_info--8004a1e90b26--------------------------------)

Exploit Writer

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----8004a1e90b26--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----8004a1e90b26--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----8004a1e90b26--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----8004a1e90b26--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----8004a1e90b26--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----8004a1e90b26--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8004a1e90b26--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8004a1e90b26--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----8004a1e90b26--------------------------------)[Teams](https://medium.com/business?source=post_page-----8004a1e90b26--------------------------------)



=== Content from cryptomator.org_7757866d_20250108_130607.html ===


[![Logo](/img/logo.svg)
CRYPTOMATOR](/)

* Products

  [Downloads](/downloads/)
  [Cryptomator Hub](/hub/)
* [Pricing](/pricing/)
* [Blog](/blog/)
* Support Us

  [Supporter Certificate](/supporter-cert/)
  [Donate](/donate/)
  [Sponsors](/sponsors/)
* Learn More

  [How Open Source Strengthens Security](/open-source/)
  [Encrypt Your Dropbox](/encrypt-dropbox/)
  [Alternative to Boxcryptor](/boxcryptor-alternative/)
  [Our Cooperation Partners](/coop/)
  [Customizations for Your Enterprise](/enterprise/)
  [GDPR Compliancy](/gdpr/)
  [NIS-2-Guideline](/nis-2-guideline/)
  [Protecting Cloud Data Against AI](/protecting-data-against-ai/)

* [Get Started](/#get-started)

* EN

  Deutsch

Products

[Downloads](/downloads/)
[Cryptomator Hub](/hub/)

---

[Pricing](/pricing/)
[Blog](/blog/)

---

Support Us

[Supporter Certificate](/supporter-cert/)
[Donate](/donate/)
[Sponsors](/sponsors/)

---

Learn More

[How Open Source Strengthens Security](/open-source/)
[Encrypt Your Dropbox](/encrypt-dropbox/)
[Alternative to Boxcryptor](/boxcryptor-alternative/)
[Our Cooperation Partners](/coop/)
[Customizations for Your Enterprise](/enterprise/)
[GDPR Compliancy](/gdpr/)
[NIS-2-Guideline](/nis-2-guideline/)
[Protecting Cloud Data Against AI](/protecting-data-against-ai/)

---

 EN

Deutsch

---

[Cryptomator on GitHub](https://github.com/cryptomator)

![Relaxed woman on a cloud secured by a lock]()

# Encrypt¬†your¬†cloud, protect¬†your¬†privacy

With Cryptomator, the key to your data is in your hands. Cryptomator encrypts your data quickly and easily. Afterwards you upload them protected to your favorite cloud service.

For Individuals

[Download Now](/downloads/)

For Teams

[Set Up Now](/hub/)

## Take the security of your data into your own hands

Cryptomator is a simple tool for digital self-defense. It allows you to protect your cloud data by yourself and independently.

Most cloud providers encrypt data only during transmission or they keep the keys for decryption for themselves. These keys can be stolen, copied, or misused. Thanks to Cryptomator, only you have the key to your data in your hand.

Cryptomator allows you to access your files from all your devices. It's easy to use and integrates seamlessly between your data and the cloud.

![Person holding the key to a very secure vault]()

## How does Cryptomator protect your data?

Cryptomator's technology meets the latest standards and encrypts both files and filenames with AES and 256 bit key length.

To start with Cryptomator, you assign a password for a folder - we call it a vault - within your cloud. That is all. No complicated key creation, no registration, no configuration!

To access the vault, simply enter the password again. You will be provided with a virtual encrypted drive to which you can move your data - just like a USB flash drive. Every time you store something on this drive, Cryptomator encrypts the data automatically. Pretty simple, right?

The technology behind this is state-of-the-art and encrypts both files and filenames with AES and 256 bit key length. This means: if someone looks into the folder in your cloud, they cannot draw any conclusions about your data.

![Person sitting in front of a laptop while Cryptobot next to the person is pointing at the laptop]()

## Optimal protection thanks to the latest technology standards

![Comparison of encrypted and decrypted data in a Cryptomator vault]()

If someone looks into the folder in your cloud, they cannot draw any conclusions about your data.

## Why is Cryptomator secure and trustworthy?

### No backdoors, no expiration date thanks to open source

You don't have to trust Cryptomator blindly, because [it is open source software](/open-source/). For you as a user, this means that everyone can see the code.

### Audited by security researchers

In addition to [independent security audits](https://community.cryptomator.org/t/has-there-been-a-security-review-audit-of-cryptomator/44), the software is continuously and publicly tested in an automated way and has a measurable code quality and test coverage that is far above the industry average.

### GDPR-compliant synchronization with your entire team via the cloud

When using Cryptomator and a cloud service with an appropriate DPA, you can [synchronize data GDPR-compliant](/gdpr/) over the cloud with an entire team.

![Two people joyfully jumping around their giant smartphone running a trustworthy app]()

## How will you use Cryptomator?

### Logo CRYPTOMATOR

For Individuals

#### Secure Your Personal Files

* Encrypt your data locally with client-side encryption
* Access your files securely using a vault password
* Keep your files safe, regardless of storage location

[Download Now](/downloads/)

### Logo CRYPTOMATOR HUB

For Teams

#### Manage Team Access

* Secure team access with zero-knowledge key management
* Unlock your shared vaults using individual team member accounts
* Integrate your existing identity management easily

[Set Up Now](/hub/)

## Let's stay in touch

Subscribe to our mailing list or follow us on social media.

 Subscribe

I agree to get updates from Cryptomator and accept the [Privacy Policy](/privacy/).

üíå Thank you for subscribing! A confirmation link has been sent to your email address.

## Brands Trusting our Technology

[![WEB.DE Logo]()](/coop/webde/)
[![GMX Logo]()](/coop/gmx/)
[![1&1 Logo]()](/coop/1und1/)
[![connect2id Logo]()](https://connect2id.com/blog/deterministic-encryption-with-aes-siv)

## Want to Become an Official Sponsor?

[Become a Sponsor](/sponsors/)

## What our Users Say

* [![Profile picture of @calia1120]()](https://twitter.com/calia1120)
  [Amy (Calia)

  @calia1120](https://twitter.com/calia1120)

   For anyone using cloud storage, this is an absolute MUST in my opinion, especially these days. Yes, Dropbox is encrypted to begin with, but has stated that they will comply with government requests. Nevermind the possibility of a compromised account.
* [![Profile picture of @iaaaan]()](https://twitter.com/iaaaan)
  [Ian Ardouin-Fumat

  @iaaaan](https://twitter.com/iaaaan)

   Over the past 6 months I have dropped my phone in water, got my laptop stolen, had a hard drive failure, and dropped another hard drive on the floor. I could either buy a new pair of hands and hope for the best, or move all my stuff to dropbox, and secure it with cryptomator.
* [![Profile picture of @mrcl_mrvls]()](https://twitter.com/mrcl_mrvls)
  [Marcel Richters

  @mrcl\_mrvls](https://twitter.com/mrcl_mrvls)

   Wer von euch gerne seine Daten verschl√ºsselt und trotzdem Cloud-Dienste nutzt: Ich habe mit @Cryptomator gute Erfahrungen gemacht.
  Sehr einfach, Verschl√ºsselung findet lokal statt, f√ºr Android, Mac und Windows (sicher auch Linux).
  Plus: Auf Spendenbasis f√ºr Desktop.
* [![Profile picture of @bassetension]()](https://twitter.com/bassetension)
  [Basse Tension

  @bassetension](https://twitter.com/bassetension)

   I couldn't live with peace of mind without @Cryptomator
  Now I am in control.
* [![Profile picture of @daveoli]()](https://twitter.com/daveoli)
  [Random Dave w/no authority or relevant exp.

  @daveoli](https://twitter.com/daveoli)

   If you are storing files in the cloud on Dropbox, Google Drive, M$ Skydrive, iCloud or Amazon highly recommend @Cryptomator for client side encryption and privacy for all your stuff.
* [![Profile picture of @4billionyears]()](https://twitter.com/4billionyears)
  [Denis Serebryakov

  @4billionyears](https://twitter.com/4billionyears)

   If you use cloud storage (#Dropbox, #GoogleDrive) #encrypt your files seamlessly with @cryptomator. It's free, #opensource, #zero-knowledge. Just like #Bitcoin.
* [![Profile picture of @DDJr9]()](https://twitter.com/DDJr9)
  [Dennis Downing Jr.

  @DDJr9](https://twitter.com/DDJr9)

   This is by far one of the best apps I have installed. You guys Rock!!üí™

## Reception

[![TNW Logo]()](https://thenextweb.com/news/new-ios-desktop-app-cryptomator-encrypts-cloud-files-locally-upload)

Cryptomator is a 'pay what you want' proposition. I've been using it for quite some time, [‚Ä¶], it's a handy tool if you're serious about keeping your files safe from prying eyes.

[![HostingAdvice Logo]()](https://www.hostingadvice.com/blog/cryptomator-brings-open-source-encryption-to-the-cloud-storage-realm/)

Skymatic's Cryptomator empowers cloud storage users to protect themselves against unauthorized access through free, transparent, client-side encryption.

[![CardRates Logo]()](https://www.cardrates.com/news/cryptomator-secures-sensitive-financial-data/)

Cryptomator is more accessible than other solutions because its desktop version is free, and it only charges a small fee for using its mobile app. And even if a hacker accesses a user's vault, Cryptomator's encrypted files are useless without the proper key to decode them.

[![CeBIT Innovation Award 2016]()](https://web.archive.org/web/20190525164100id_/https%3A//www.cebitaward.de/de/sonderpreis-cryptomator-1759.html)

## Awardee of the CeBIT Innovation Award 2016

Cryptomator won the Special Award for Usable Security and Privacy.

#### Cryptomator

* [Downloads](/downloads/)
* [Merchandise](https://cryptomator.redbubble.com/)
* [Press Kit](/presskit/)

#### Contribute

* [GitHub](https://github.com/cryptomator)
* [Donate](/donate/)
* [Translate](https://translate.cryptomator.org/)

#### Support

* [Docs](https://docs.cryptomator.org/)
* [Community](https://community.cryptomator.org/)
* [Contact](/contact/)

#### Follow Us

* [Mastodon](https://mastodon.online/%40cryptomator)
* [LinkedIn](https://linkedin.com/company/skymatic)
* [RSS Feed](/feed.xml)

#### Legal

* [Impressum](/impressum/)
* [Privacy Policy](/privacy/)
* [Terms & Conditions](/terms/)


