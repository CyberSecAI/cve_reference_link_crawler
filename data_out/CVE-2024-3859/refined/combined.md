=== Content from lists.debian.org_cd5431e1_20250110_211032.html ===


---

[[Date Prev](msg00012.html)][[Date Next](msg00014.html)]
[[Thread Prev](msg00012.html)][[Thread Next](msg00014.html)]
[[Date Index](maillist.html#00013)]
[[Thread Index](threads.html#00013)]

# [SECURITY] [DLA 3791-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3791-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Mon, 22 Apr 2024 10:49:04 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240422084904.60FCF2A5A98%40andromeda)Â [20240422084904.60FCF2A5A98@andromeda](msg00013.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3791-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
April 22, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.10.1-1~deb10u1
CVE ID         : CVE-2024-2609 CVE-2024-3302 CVE-2024-3852 CVE-2024-3854
                 CVE-2024-3857 CVE-2024-3859 CVE-2024-3861 CVE-2024-3864

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.10.1-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmYmJH0ACgkQnUbEiOQ2
gwIQ1A//TyjC/KoCSUceHOil+UKFnoxBl+7AG0khIFn7gT+roJRgKtkBUFni/10a
Bbo4SbbZNZwQo6QVQEtCtvYvHsWqYKkPOOFUGODCXPkPbwGzTXVlcHRY+BR+Gsf1
YIv8AxkkVdgAQdu53acvLUXfkQuOVbjYAGdvZQmppjWPh32Frp0f0V4LaUWrI3uF
MBowGM2J4kUC/KIrPjec7EGo+otnHzcSTyl9xO/RQDISHLc8xqenI6hBVAxW9EaC
/kBdDRku/wC6mwYRIKJMvekwC5NI21y1Qa0VcvrSdzk8tCwetpzaKAeucJFfAl0C
sqz8vI0OF1BgBph6Jif3Rwc99Up9tSc8BUkqvISONJeKb9x3gbtAN90hDicP+aF6
3MPQLNuebLn/zJWyL9EPzIQ5V02hXk2s3YXJlS+aXuCjyQf6VV6bd5ISYgyRHe8u
UhBxFaKDhcrDoAC55FPOE4Ywx9fyvCD1uXzHjeqIj29jARLWRHP9rq8bqPFpxHXq
XX3te9jDewzWeu7Uze483cSNf/izSUmZNbaB+iHZsScI7im7PYw92RLBKuxJ46hT
PJNLVKPu9dW2EI9ugibDoDIoblEDndDQRUtFZn1P0Trk7zaPhlGKQn4zgL9y5kEL
fy2DxO0N3XFz2XijCgyAYTz5CQUlGtR2ARXba6E8+Skrxs5oy1k=
=QHOD
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_88b131fe_20250110_211031.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1874489)
* [XML](/show_bug.cgi?ctype=xml&id=1874489)

Closed
[Bug 1874489](/show_bug.cgi?id=1874489)
(CVE-2024-3859)

Opened 1 year ago
Closed 10 months ago

# Read beyond bounds in OpenTypeSTAT::Parse()

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Read beyond bounds in OpenTypeSTAT::Parse()

## Categories

### (Core :: Graphics: Text, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20Text#Graphics%3A%20Text)

Graphics: Text
â–¾

Core :: Graphics: Text

Issues with glyph rasterization and painting, font format support, and interfacing with platform font APIs. For issues with font selection, text shaping, and glyph selection, see the Layout: Text and Fonts component.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20Text&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20Text&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20Text)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 121

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Other

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [125+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=125%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 125+ | fixed |
| firefox-esr128 | --- | --- |
| firefox124 |  | wontfix |
| firefox125 | + | fixed |
| firefox126 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mozillabugs, Assigned: jfkthame)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e0f9759e1d7514ae4adfd806869e3c5d?d=mm&size=40)  [jfkthame](/user_profile?user_id=329583)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d5c63f9bd72a6704ada7f9ca71771d8b?d=mm&size=40)  [mozillabugs](/user_profile?user_id=608633)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/029a38b9773f1943419c24b7c3d93761?d=mm&size=40)  [lsalzman](/user_profile?user_id=536714)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1518885 "https://bugs.chromium.org/p/chromium/issues/detail?id=1518885")

[crbug.com/41491859](https://crbug.com/41491859 "https://crbug.com/41491859")

[github.com/khaledhosny/ots/pull/279](https://github.com/khaledhosny/ots/pull/279 "https://github.com/khaledhosny/ots/pull/279")

## Details

### (4 keywords, Whiteboard: [adv-main125+][adv-esr115.10+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-3859

[Keywords:](/describekeywords.cgi)

[csectype-intoverflow](/buglist.cgi?keywords=csectype-intoverflow&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---),
[sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main125+][adv-esr115.10+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

no

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a6389692_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a6301914_488993 "10 months ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (12 files)

| [ffbug\_2218.htm](/attachment.cgi?id=9372749)  [1 year ago](#c12)  [mozillabugs](/user_profile?user_id=608633)   491 bytes, text/html |  | [Details](/attachment.cgi?id=9372749&action=edit) |
| --- | --- | --- |
| [Montserrat-VariableFont\_wght-hacked.ttf](/attachment.cgi?id=9372750)  [1 year ago](#c13)  [mozillabugs](/user_profile?user_id=608633)   384.90 KB, application/octet-stream |  | [Details](/attachment.cgi?id=9372750&action=edit) |
| [Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero. r=#gfx-reviewers](/attachment.cgi?id=9391757)  [10 months ago](#c19)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9391757&action=edit) | [Review](/attachment.cgi?id=9391757) |
| [Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations. r=#gfx-reviewers](/attachment.cgi?id=9391758)  [10 months ago](#c20)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9391758&action=edit) | [Review](/attachment.cgi?id=9391758) |
| [Bug 1874489 - patch 3 - More careful range checks in STAT parsing. r=#gfx-reviewers](/attachment.cgi?id=9391759)  [10 months ago](#c21)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9391759&action=edit) | [Review](/attachment.cgi?id=9391759) |
| [Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero.](/attachment.cgi?id=9393097)  [10 months ago](#c26)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a6298867_600971 "10 months ago") | [Details](/attachment.cgi?id=9393097&action=edit) | [Review](/attachment.cgi?id=9393097) |
| [Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations.](/attachment.cgi?id=9393098)  [10 months ago](#c27)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a6298878_600971 "10 months ago") | [Details](/attachment.cgi?id=9393098&action=edit) | [Review](/attachment.cgi?id=9393098) |
| [Bug 1874489 - patch 3 - More careful range checks in STAT parsing.](/attachment.cgi?id=9393099)  [10 months ago](#c28)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a6298888_600971 "10 months ago") | [Details](/attachment.cgi?id=9393099&action=edit) | [Review](/attachment.cgi?id=9393099) |
| [Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero.](/attachment.cgi?id=9393941)  [10 months ago](#c33)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-esr115+](#a6731890_600971 "10 months ago") | [Details](/attachment.cgi?id=9393941&action=edit) | [Review](/attachment.cgi?id=9393941) |
| [Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations.](/attachment.cgi?id=9394082)  [10 months ago](#c35)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-esr115+](#a6731900_600971 "10 months ago") | [Details](/attachment.cgi?id=9394082&action=edit) | [Review](/attachment.cgi?id=9394082) |
| [Bug 1874489 - patch 3 - More careful range checks in STAT parsing.](/attachment.cgi?id=9394083)  [10 months ago](#c36)  [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-esr115+](#a6731904_600971 "10 months ago") | [Details](/attachment.cgi?id=9394083&action=edit) | [Review](/attachment.cgi?id=9394083) |
| [advisory.txt](/attachment.cgi?id=9396575)  [9 months ago](#c39)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   233 bytes, text/plain |  | [Details](/attachment.cgi?id=9396575&action=edit) |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1874489#c0)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1874489&comment_id=16748116 "1 revision") |
|  | |

`OpenTypeSTAT::Parse()` (`gfx\ots\src\stat.cc`) can read beyond bounds if a font header contains specially-crafted values for `designAxisSize`, `designAxisCount`, and `designAxisOffset`. The bug can be reached only on 32-bit platforms, and it appears to be latent -- Searchfox indicates that `OpenTypeSTAT::Parse()` is not called anywhere, though it is built into the Firefox executable.

The bug is on lines 62-68 (FIREFOX\_121\_0\_RELEASE):

```
 31: bool OpenTypeSTAT::Parse(const uint8_t* data, size_t length) {
 32:   Buffer table(data, length);
 33:   if (!table.ReadU16(&this->majorVersion) ||
 34:       !table.ReadU16(&this->minorVersion) ||
 35:       !table.ReadU16(&this->designAxisSize) ||
 36:       !table.ReadU16(&this->designAxisCount) ||
 37:       !table.ReadU32(&this->designAxesOffset) ||
 38:       !table.ReadU16(&this->axisValueCount) ||
 39:       !table.ReadU32(&this->offsetToAxisValueOffsets) ||
 40:       !(this->minorVersion < 1 || table.ReadU16(&this->elidedFallbackNameID))) {
 41:     return Drop("Failed to read table header");
 42:   }
 ...
 51:   if (this->designAxisSize < sizeof(AxisRecord)) {
 52:     return Drop("Invalid designAxisSize");
 53:   }
 54:
 55:   size_t headerEnd = table.offset();
 56:
 57:   if (this->designAxisCount == 0) {
 58:     if (this->designAxesOffset != 0) {
 59:       Warning("Unexpected non-zero designAxesOffset");
 60:       this->designAxesOffset = 0;
 61:     }
 62:   } else {
 63:     if (this->designAxesOffset < headerEnd ||
 64:         size_t(this->designAxesOffset) +
 65:           size_t(this->designAxisCount) * size_t(this->designAxisSize) > length) {
 66:       return Drop("Invalid designAxesOffset");
 67:     }
 68:   }

```

The issue is that the calculation on lines 64-5 can overflow on 32-bit builds, because in those builds, `size_t` is 32 bits. So, for example, if `designAxesOffset` is `0xffffffff`, `designAxisCount` is `16`, and `designAxisSize` is `8`, the calculation yields `0x7f` in 32 bits. This would then pass the length check on line 65. Once that occurs, line 71 sets `table.offset_` to `0xffffffff`. The `table.Readxxx()` functions on lines 74-6 then read from `buffer_ + 0xffffffff`, then wrap back to `0`...:

```
 69:
 70:   for (size_t i = 0; i < this->designAxisCount; i++) {
 71:     table.set_offset(this->designAxesOffset + i * this->designAxisSize);
 72:     this->designAxes.emplace_back();
 73:     auto& axis = this->designAxes[i];
 74:     if (!table.ReadU32(&axis.axisTag) ||
 75:         !table.ReadU16(&axis.axisNameID) ||
 76:         !table.ReadU16(&axis.axisOrdering)) {
 77:       return Drop("Failed to read design axis");
 78:     }
 79:     if (!CheckTag(axis.axisTag)) {
 80:       return Drop("Bad design axis tag");
 81:     }
 82:     if (!ValidateNameId(axis.axisNameID)) {
 83:       return true;
 84:     }
 85:   }

```

because the `ReadUxxx()` functions' checks also overflow, e.g., `ReadU32()` (`gfx/ots/src/ots.h`) does:

```
 135: bool ReadU32(uint32_t *value) {
 136:   if (offset_ + 4 > length_) {
 137:     return OTS_FAILURE();
 138:   }
 139:   std::memcpy(value, buffer_ + offset_, sizeof(uint32_t));
 140:   *value = ots_ntohl(*value);
 141:   offset_ += 4;
 142:   return true;
 143: }

```

where `offset_` isa `size_t`, so lines 136 and 141 overflow from `0xffffffff` to `3` on the first call to `ReadU32()`, passing the check on lines 136-38 and corrupting the value of `offset` on line 141.

There appears also to be a similar bug involving `offsetToAxisValueOffsets` in the same code.

Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a2896_406194)â€¢ 1 year ago |

Group: core-security â†’ gfx-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1874489#c1)â€¢ 1 year ago |
|  | |

FWIW, code coverage data on SearchFox says we are running at least some of the code in OpenTypeSTAT::Parse.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1874489#c2)â€¢ 1 year ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #1](/show_bug.cgi?id=1874489#c1 "RESOLVED FIXED - Read beyond bounds in OpenTypeSTAT::Parse()"))

> FWIW, code coverage data on SearchFox says we are running at least some of the code in OpenTypeSTAT::Parse.

This is interesting, as SearchFox search says it's not called, yet it gets built into the executable, so something must reference it (the linker should remove unreferenced code). Aha! It gets called when visiting...wait for it....google.com . So this isn't latent.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1874489#c3)â€¢ 1 year ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

(In reply to mozillabugs from [comment #2](/show_bug.cgi?id=1874489#c2 "RESOLVED FIXED - Read beyond bounds in OpenTypeSTAT::Parse()"))

> (In reply to Andrew McCreight [:mccr8] from [comment #1](/show_bug.cgi?id=1874489#c1 "RESOLVED FIXED - Read beyond bounds in OpenTypeSTAT::Parse()"))
>
> > FWIW, code coverage data on SearchFox says we are running at least some of the code in OpenTypeSTAT::Parse.
>
> This is interesting, as SearchFox search says it's not called, yet it gets built into the executable, so something must reference it (the linker should remove unreferenced code). Aha! It gets called when visiting...wait for it....google.com . So this isn't latent. The caller in this case is `Font::ParseTable()` in `gfx\ots\src\ots.cc`, so SearchFox is missing a live one.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1874489#c4)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1874489&comment_id=16748198 "2 revisions") |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

(In reply to mozillabugs from [comment #3](/show_bug.cgi?id=1874489#c3 "RESOLVED FIXED - Read beyond bounds in OpenTypeSTAT::Parse()"))

> (In reply to mozillabugs from [comment #2](/show_bug.cgi?id=1874489#c2 "RESOLVED FIXED - Read beyond bounds in OpenTypeSTAT::Parse()"))
>
> > (In reply to Andrew McCreight [:mccr8] from [comment #1](/show_bug.cgi?id=1874489#c1 "RESOLVED FIXED - Read beyond bounds in OpenTypeSTAT::Parse()"))
> >
> > > FWIW, code coverage data on SearchFox says we are running at least some of the code in OpenTypeSTAT::Parse.
> >
> > This is interesting, as SearchFox search says it's not called, yet it gets built into the executable, so something must reference it (the linker should remove unreferenced code). Aha! It gets called when visiting...wait for it....google.com . So this isn't latent. The caller in this case is `Font::ParseTable()` in `gfx\ots\src\ots.cc`, so SearchFox is missing a live one. I'll try to get a POC working soon.

Sorry about the multiple replies; I clicked the wrong icon.

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1874489#c5)â€¢ 1 year ago |
|  | |

Has this been reported to Chrome?

Flags: needinfo?(mozillabugs)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1874489#c6)â€¢ 1 year ago |
|  | |

(In reply to Jeff Muizelaar [:jrmuizel] from [comment #5](/show_bug.cgi?id=1874489#c5 "RESOLVED FIXED - Read beyond bounds in OpenTypeSTAT::Parse()"))

> Has this been reported to Chrome?

No. Does the Chrome team own OTS? Would Mozilla like me to report it there while this bug is pending here?

Flags: needinfo?(mozillabugs)

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1874489#c7)â€¢ 1 year ago |
|  | |

I'm not sure it's exact ownership, but it's originally from Google. I think reporting it there probably makes sense.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1874489#c8)â€¢ 1 year ago |
|  | |

(In reply to Jeff Muizelaar [:jrmuizel] from [comment #7](/show_bug.cgi?id=1874489#c7 "RESOLVED FIXED - Read beyond bounds in OpenTypeSTAT::Parse()"))

> I'm not sure it's exact ownership, but it's originally from Google. I think reporting it there probably makes sense.

I'll report it to the Chromium team. It seems to be widely-used, but I'm not sure who (if anyone) is actually the official maintainer at this point. <https://bugzilla.mozilla.org/show_bug.cgi?id=1341088> seems to indicate that <https://github.com/khaledhosny/ots> was/is(?) the official repository for it, but the "security" tab there has no content, so reporting it there doesn't seem safe.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1874489#c9)â€¢ 1 year ago |
|  | |

Khaled is (and has always been, IIRC) the primary maintainer, though others (including myself) sometimes contribute. But I'm not sure what his preference would be for reporting potentially sensitive issues.

I do have an email address for him, if you'd like me to reach out directly. Though in this case, I'd be inclined to simply open a PR to use 64-bit arithmetic in the problematic calculation, and it'd probably get merged pretty quickly.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1874489#c10)â€¢ 1 year ago |
|  | |

If (as seems likely) this bug turns out to be exploitable, I'd like to minimize the number of projects that get 0-dayed. Does Mozilla have a policy on this issue?

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1874489#c11)â€¢ 1 year ago |
|  | |

The data that can be forced to be read using this mechanism could be unowned heap if the `STAT` table in the font file is compressed. If the `STAT` table is uncompressed, the data is from a preceding part of the font file, (See `GetTableData()` in `gfx/ots/src/ots.cc` for details)

Here's a POC that demonstrates the read beyond bounds. Use it thusly:

1. Build FF for a 32-bit architecture (I used Win32).
2. Copy `ffbug_2218.htm` to a webserver in `<root>/ffbug_2218/ffbug_2218.htm` .
3. Copy `Montserrat-VariableFont_wght-hacked.ttf` to `<root>/resources/fonts/Montserrat/Montserrat-VariableFont_wght-hacked.ttf` (or put it somewhere else and modify the path in `ffbug_2218.htm` appropriately.
4. Start FF and attach a debugger to it.
5. Set a BP on `OpenTypeSTAT::Parse()`.
6. Load `ffbug_2218.htm` .
7. When the BP fires, step lines 33-42.
8. Examine `this->designAxesOffset` and `this->offsetToAxisValueOffsets` . Notice that they're `0xfffffffc` and `0xfffffffe`, respectively.
9. Step lines 62-8 and notice that the check doesn't detect the invalid value for `this->designAxesOffset` .
10. Step into line 71 and notice that it sets `table.offset_` to `0xfffffffc`.
11. Step into line 74 and notice that `ReadU32()`'s check overflows, and that the `memcpy()` reads from `buffer+0xfffffffc` , which wraps to `buffer-4` (where `buffer` is the lowest valid address here).
12. Set execution to line 91 to demonstrate the second, similar read beyond bounds.
13. Notice that the check on lines 96-102 doesn't detect the broken value of `this->offsetToAxisValueOffsets`.
14. Step the first iteration of the loop beginning on line 104 and notice that line 107 reads from `buffer-2` instead of from `buffer`.

There are also some other overflow-vulnerable computations in this file, such as line 110. Really this code should be using `CheckedInt` or something like it.

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1874489#c12)â€¢ 1 year ago |
|  | |

Attached file
[ffbug\_2218.htm](attachment.cgi?id=9372749)
â€” [Details](attachment.cgi?id=9372749&action=edit)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1874489#c13)â€¢ 1 year ago |
|  | |

Attached file
[Montserrat-VariableFont\_wght-hacked.ttf](attachment.cgi?id=9372750)
â€” [Details](attachment.cgi?id=9372750&action=edit)

|  | [mozillabugs](/user_profile?user_id=608633)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1874489#c14)â€¢ 1 year ago |
|  | |

Reported to Google at <https://bugs.chromium.org/p/chromium/issues/detail?id=1518885> .

Summary: Latent(?) read beyond bounds in OpenTypeSTAT::Parse() â†’ Read beyond bounds in OpenTypeSTAT::Parse()

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a340765_406194)â€¢ 1 year ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---)See Also: â†’ <https://bugs.chromium.org/p/chromium/issues/detail?id=1518885>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a439726_1689)â€¢ 1 year ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---) â†’ [csectype-intoverflow](/buglist.cgi?keywords=csectype-intoverflow&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1874489#c15)â€¢ 1 year ago |
|  | |

cc'ing Dominik, who has received the corresponding report to chromium.

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a849383_309398)â€¢ 1 year ago |

Assignee: nobody â†’ jfkthame

|  | [Bob Hood [:bhood]](/user_profile?user_id=697075) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1874489#c16)â€¢ 1 year ago |
|  | |

Jonathan, could you please assign a Severity to this?

Also, are we dependent on movement upstream for this one, or is there anything we can do to mitigate it?

Flags: needinfo?(jfkthame)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1874489#c17)â€¢ 1 year ago |
|  | |

The potential consequences of the out-of-bounds reads would be either (a) crash (so this could be a DoS vector), or (b) allowing an invalid STAT table to pass validation, so we pass it through to the rasterizer. In theory that should be harmless, as the rasterizer should handle it safely, but we prefer not to rely on that (especially as we can't audit/fix issues there might be in Core Text or DirectWrite) which is why we validate the resources before using them.

So while this is clearly a valid issue, I don't think it's higher than S3 at this point, though if there were actually an exploitable STAT-based bug in CT or DW, that could make it more significant.

I'd be fine with patching this locally, if we want to fix it in gecko ahead of upstream.

Severity: -- â†’ S3Flags: needinfo?(jfkthame)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1874489#c18)â€¢ 1 year ago |
|  | |

The severity field for this bug is set to S3. However, the bug is flagged with the `sec-high` keyword.

:jfkthame, could you consider increasing the severity of this security bug?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#severity_high_security.py).

Flags: needinfo?(jfkthame)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a1470378_406194)â€¢ 1 year ago |

Flags: needinfo?(jfkthame)Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) â†’ [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1874489#c19)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero. r=#gfx-reviewers](attachment.cgi?id=9391757)
â€” [Details](attachment.cgi?id=9391757&action=edit)

This is just <https://github.com/khaledhosny/ots/pull/277> from upstream, not really part

of this issue but touching the same code, so simplest to include it here.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1874489#c20)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations. r=#gfx-reviewers](attachment.cgi?id=9391758)
â€” [Details](attachment.cgi?id=9391758&action=edit)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1874489#c21)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 3 - More careful range checks in STAT parsing. r=#gfx-reviewers](attachment.cgi?id=9391759)
â€” [Details](attachment.cgi?id=9391759&action=edit)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1874489#c22)â€¢ 10 months ago |
|  | |

Once we take these patches locally, I'll also open a PR to land them upstream in OTS.

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1874489#c23)â€¢ 10 months ago |
|  | |

Pushed by jkew@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/dfd86e34e53f>
patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero. r=gfx-reviewers,lsalzman
<https://hg.mozilla.org/integration/autoland/rev/eed1acdcdfbd>
patch 2 - Avoid potential arithmetic overflow during Buffer read operations. r=gfx-reviewers,lsalzman
<https://hg.mozilla.org/integration/autoland/rev/df5fdbb9e3ec>
patch 3 - More careful range checks in STAT parsing. r=gfx-reviewers,lsalzman

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1874489#c24)â€¢ 10 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/dfd86e34e53f>

<https://hg.mozilla.org/mozilla-central/rev/eed1acdcdfbd>

<https://hg.mozilla.org/mozilla-central/rev/df5fdbb9e3ec>

Group: gfx-core-security â†’ core-security-releaseStatus: NEW â†’ RESOLVEDClosed: 10 months ago
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 126 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a5983495_75935)â€¢ 10 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox125](/buglist.cgi?f1=cf_tracking_firefox125&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- â†’ [125+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=125%2B)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1874489#c25)â€¢ 10 months ago |
|  | |

The patch landed in nightly and beta is affected.

:jfkthame, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox125` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(jfkthame)

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1874489#c26)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero.](attachment.cgi?id=9393097)
â€” [Details](attachment.cgi?id=9393097&action=edit)

This is just <https://github.com/khaledhosny/ots/pull/277> from upstream, not really part

of this issue but touching the same code, so simplest to include it here.

Original Revision: <https://phabricator.services.mozilla.com/D204916>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6293203_600971)â€¢ 10 months ago |

[Attachment #9393097](/attachment.cgi?id=9393097&action=edit "Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero.") -
Flags: approval-mozilla-beta?

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1874489#c27)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations.](attachment.cgi?id=9393098)
â€” [Details](attachment.cgi?id=9393098&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D204917>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6293317_600971)â€¢ 10 months ago |

[Attachment #9393098](/attachment.cgi?id=9393098&action=edit "Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations.") -
Flags: approval-mozilla-beta?

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1874489#c28)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 3 - More careful range checks in STAT parsing.](attachment.cgi?id=9393099)
â€” [Details](attachment.cgi?id=9393099&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D204918>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6293327_600971)â€¢ 10 months ago |

[Attachment #9393099](/attachment.cgi?id=9393099&action=edit "Bug 1874489 - patch 3 - More careful range checks in STAT parsing.") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1874489#c29)â€¢ 10 months ago |
|  | |

# Uplift Approval Request

* **Explanation of risk level**: just makes bounds-checking arithmetic more careful to avoid potential overflow
* **User impact if declined**: potential for out-of-bounds accesses during font validation; could result in crash, unclear whether more serious consequences
* **Code covered by automated testing**: no
* **Is Android affected?**: yes
* **Needs manual QE test**: no
* **String changes made/needed**: none
* **Risk associated with taking this patch**: low risk
* **Fix verified in Nightly**: no
* **Steps to reproduce for manual QE testing**: n/a

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6298867_600971)â€¢ 10 months ago |

[Attachment #9393097](/attachment.cgi?id=9393097&action=edit "Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero.") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6298878_600971)â€¢ 10 months ago |

[Attachment #9393098](/attachment.cgi?id=9393098&action=edit "Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations.") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6298888_600971)â€¢ 10 months ago |

[Attachment #9393099](/attachment.cgi?id=9393099&action=edit "Bug 1874489 - patch 3 - More careful range checks in STAT parsing.") -
Flags: approval-mozilla-beta? â†’ approval-mozilla-beta+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6299126_640478)â€¢ 10 months ago |

[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1874489#c30)â€¢ 10 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/3f194d132c92>
<https://hg.mozilla.org/releases/mozilla-beta/rev/cae7c94e1e11>
<https://hg.mozilla.org/releases/mozilla-beta/rev/3d3e1580db15>

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6301914_488993)â€¢ 10 months ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6389692_1689)â€¢ 10 months ago |

Flags: sec-bounty? â†’ sec-bounty+Keywords: [sec-vector](/buglist.cgi?keywords=sec-vector&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6547617_75935)â€¢ 10 months ago |

Flags: needinfo?(jfkthame)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1874489#c31)â€¢ 10 months ago |
|  | |

Is this something we're going to want on ESR also?

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1874489#c32)â€¢ 10 months ago |
|  | |

I'd suggest we take it, yes. I'll do the `moz-phab uplift` thing...

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1874489#c33)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero.](attachment.cgi?id=9393941)
â€” [Details](attachment.cgi?id=9393941&action=edit)

This is just <https://github.com/khaledhosny/ots/pull/277> from upstream, not really part

of this issue but touching the same code, so simplest to include it here.

Original Revision: <https://phabricator.services.mozilla.com/D204916>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6610989_600971)â€¢ 10 months ago |

[Attachment #9393941](/attachment.cgi?id=9393941&action=edit "Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero.") -
Flags: approval-mozilla-esr115?

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1874489#c34)â€¢ 10 months ago |
|  | |

Huh, looks like that `uplift` only did the first patch, which doesn't actually address the issue.... I'll try again.

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1874489#c35)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations.](attachment.cgi?id=9394082)
â€” [Details](attachment.cgi?id=9394082&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D204917>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6701503_600971)â€¢ 10 months ago |

[Attachment #9394082](/attachment.cgi?id=9394082&action=edit "Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations.") -
Flags: approval-mozilla-esr115?

|  | [Jonathan Kew [:jfkthame]](/user_profile?user_id=329583)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1874489#c36)â€¢ 10 months ago |
|  | |

Attached file
[Bug 1874489 - patch 3 - More careful range checks in STAT parsing.](attachment.cgi?id=9394083)
â€” [Details](attachment.cgi?id=9394083&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D204918>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6701524_600971)â€¢ 10 months ago |

[Attachment #9394083](/attachment.cgi?id=9394083&action=edit "Bug 1874489 - patch 3 - More careful range checks in STAT parsing.") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1874489#c37)â€¢ 10 months ago |
|  | |

### esr115 Uplift Approval Request

* **User impact if declined**: potential for out-of-bounds accesses during font validation
* **Code covered by automated testing**: no
* **Fix verified in Nightly**: no
* **Needs manual QE test**: no
* **Steps to reproduce for manual QE testing**: n/a
* **Risk associated with taking this patch**: low
* **Explanation of risk level**: just makes bounds-checking arithmetic more careful to avoid potential overflow
* **String changes made/needed**: none
* **Is Android affected?**: yes

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6731890_600971)â€¢ 10 months ago |

[Attachment #9393941](/attachment.cgi?id=9393941&action=edit "Bug 1874489 - patch 1 - Don't check STAT designAxisSize if the designAxisCount is zero.") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6731900_600971)â€¢ 10 months ago |

[Attachment #9394082](/attachment.cgi?id=9394082&action=edit "Bug 1874489 - patch 2 - Avoid potential arithmetic overflow during Buffer read operations.") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6731904_600971)â€¢ 10 months ago |

[Attachment #9394083](/attachment.cgi?id=9394083&action=edit "Bug 1874489 - patch 3 - More careful range checks in STAT parsing.") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1874489#c38)â€¢ 10 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/59182ff3f684>
<https://hg.mozilla.org/releases/mozilla-esr115/rev/e28125870322>
<https://hg.mozilla.org/releases/mozilla-esr115/rev/2cb4e79a2ac0>

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a6732088_640478)â€¢ 10 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a7735670_1689)â€¢ 9 months ago |

Whiteboard: [adv-main125+][adv-esr115.10+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1874489#c39)â€¢ 9 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9396575)
â€” [Details](attachment.cgi?id=9396575&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a8053808_1689)â€¢ 9 months ago |

See Also: â†’ <https://crbug.com/41491859>,
<https://github.com/khaledhosny/ots/pull/279>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a8119355_1689)â€¢ 9 months ago |

Alias: CVE-2024-3859

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a11999667_5898)â€¢ 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1874489#a21619938_1689)â€¢ 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1874489&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [mozillabugs](/user_profile?user_id=608633)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_5e413429_20250110_211033.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-18

## Security Vulnerabilities fixed in Firefox 125

Announced
April 16, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 125

This advisory was updated June 11, 2024 to add XXX which was included in the original release of Firefox 125, but did not appear in the advisory published at that time.

#### [#CVE-2024-3852: GetBoundName in the JIT returned the wrong object](#CVE-2024-3852)

Reporter
Logan Stratton
Impact
high
##### Description

GetBoundName could return the wrong version of an object when JIT optimizations were applied.

##### References

* [Bug 1883542](https://bugzilla.mozilla.org/show_bug.cgi?id=1883542)

#### [#CVE-2024-5702: Use-after-free in networking](#CVE-2024-5702)

Reporter
Kershaw Chang
Impact
high
##### Description

Memory corruption in the networking stack could have led to a potentially exploitable crash.

##### References

* [Bug 1193389](https://bugzilla.mozilla.org/show_bug.cgi?id=1193389)

#### [#CVE-2024-3853: Use-after-free if garbage collection runs during realm initialization](#CVE-2024-3853)

Reporter
Gary Kwong
Impact
high
##### Description

A use-after-free could result if a JavaScript realm was in the process of being initialized when a garbage collection started.

##### References

* [Bug 1884427](https://bugzilla.mozilla.org/show_bug.cgi?id=1884427)

#### [#CVE-2024-3854: Out-of-bounds-read after mis-optimized switch statement](#CVE-2024-3854)

Reporter
Lukas Bernhard
Impact
high
##### Description

In some code patterns the JIT incorrectly optimized switch statements and generated code with out-of-bounds-reads.

##### References

* [Bug 1884552](https://bugzilla.mozilla.org/show_bug.cgi?id=1884552)

#### [#CVE-2024-3855: Incorrect JIT optimization of MSubstr leads to out-of-bounds reads](#CVE-2024-3855)

Reporter
Lukas Bernhard
Impact
high
##### Description

In certain cases the JIT incorrectly optimized MSubstr operations, which led to out-of-bounds reads.

##### References

* [Bug 1885828](https://bugzilla.mozilla.org/show_bug.cgi?id=1885828)

#### [#CVE-2024-3856: Use-after-free in WASM garbage collection](#CVE-2024-3856)

Reporter
Nan Wang
Impact
high
##### Description

A use-after-free could occur during WASM execution if garbage collection ran during the creation of an array.

##### References

* [Bug 1885829](https://bugzilla.mozilla.org/show_bug.cgi?id=1885829)

#### [#CVE-2024-3857: Incorrect JITting of arguments led to use-after-free during garbage collection](#CVE-2024-3857)

Reporter
Lukas Bernhard
Impact
high
##### Description

The JIT created incorrect code for arguments in certain cases. This led to potential use-after-free crashes during garbage collection.

##### References

* [Bug 1886683](https://bugzilla.mozilla.org/show_bug.cgi?id=1886683)

#### [#CVE-2024-3858: Corrupt pointer dereference in js::CheckTracedThing<js::Shape>](#CVE-2024-3858)

Reporter
Lukas Bernhard
Impact
high
##### Description

It was possible to mutate a JavaScript object so that the JIT could crash while tracing it.

##### References

* [Bug 1888892](https://bugzilla.mozilla.org/show_bug.cgi?id=1888892)

#### [#CVE-2024-3859: Integer-overflow led to out-of-bounds-read in the OpenType sanitizer](#CVE-2024-3859)

Reporter
Ronald Crane
Impact
moderate
##### Description

On 32-bit versions there were integer-overflows that led to an out-of-bounds-read that potentially could be triggered by a malformed OpenType font.

##### References

* [Bug 1874489](https://bugzilla.mozilla.org/show_bug.cgi?id=1874489)

#### [#CVE-2024-3860: Crash when tracing empty shape lists](#CVE-2024-3860)

Reporter
Gary Kwong
Impact
moderate
##### Description

An out-of-memory condition during object initialization could result in an empty shape list. If the JIT subsequently traced the object it would crash.

##### References

* [Bug 1881417](https://bugzilla.mozilla.org/show_bug.cgi?id=1881417)

#### [#CVE-2024-3861: Potential use-after-free due to AlignedBuffer self-move](#CVE-2024-3861)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an AlignedBuffer were assigned to itself, the subsequent self-move could result in an incorrect reference count and later use-after-free.

##### References

* [Bug 1883158](https://bugzilla.mozilla.org/show_bug.cgi?id=1883158)

#### [#CVE-2024-3862: Potential use of uninitialized memory in MarkStack assignment operator on self-assignment](#CVE-2024-3862)

Reporter
Ronald Crane
Impact
moderate
##### Description

The MarkStack assignment operator, part of the JavaScript engine, could access uninitialized memory if it were used in a self-assignment.

##### References

* [Bug 1884457](https://bugzilla.mozilla.org/show_bug.cgi?id=1884457)

#### [#CVE-2024-3863: Download Protections were bypassed by .xrm-ms files on Windows](#CVE-2024-3863)

Reporter
Eduardo Braun Prado working with Trend Micro Zero Day Initiative
Impact
moderate
##### Description

The executable file warning was not presented when downloading .xrm-ms files.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1885855](https://bugzilla.mozilla.org/show_bug.cgi?id=1885855)

#### [#CVE-2024-3302: Denial of Service using HTTP/2 CONTINUATION frames](#CVE-2024-3302)

Reporter
Bartek Nowotarski via CERT
Impact
low
##### Description

There was no limit to the number of HTTP/2 CONTINUATION frames that would be processed. A server could abuse this to create an Out of Memory condition in the browser.

##### References

* [Bug 1881183](https://bugzilla.mozilla.org/show_bug.cgi?id=1881183)
* [VU#421644 - HTTP/2 CONTINUATION frames can be utilized for DoS attacks](https://kb.cert.org/vuls/id/421644)

#### [#CVE-2024-3864: Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](#CVE-2024-3864)

Reporter
Paul Bone
Impact
high
##### Description

Memory safety bug present in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9. This bug showed evidence of memory corruption and we presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](https://bugzilla.mozilla.org/show_bug.cgi?id=1888333)

#### [#CVE-2024-3865: Memory safety bugs fixed in Firefox 125](#CVE-2024-3865)

Reporter
the Mozilla Fuzzing Team, Simon Friedberger, Andrew McCreight
Impact
high
##### Description

Memory safety bugs present in Firefox 124. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 125](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1881076%2C1884887%2C1885359%2C1889049)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_63abf701_20250110_211032.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DLA 3790-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3790-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Fri, 19 Apr 2024 12:39:37 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240419103937.C85162A590B%40andromeda)Â [20240419103937.C85162A590B@andromeda](msg00012.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3790-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
April 19, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.10.0esr-1~deb10u1
CVE ID         : CVE-2024-2609 CVE-2024-3302 CVE-2024-3852 CVE-2024-3854
                 CVE-2024-3857 CVE-2024-3859 CVE-2024-3861 CVE-2024-3864

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code or clickjacking.

For Debian 10 buster, these problems have been fixed in version
115.10.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmYiSekACgkQnUbEiOQ2
gwLDdw//Se9KFK8DGedq3gALJsodnMHsth1qAzwv6g23XTPCq+Jsl69fZXwT0pM5
VXB5wg5XbPa622MtrEPUJqwjfEB7iAd3Jchb2mPkeI3MyaSZXChduCxwE6G4zHrT
mkF++OVNyqehEWEYnN4tM9jo0xKG2j2duo2NnFgBwAMjYUkizjvRARrdvOVHqst4
v+1QMCQlbRitl7pNpe+elcXXXXTaA4e+5WIheN3jS+Y6Nd5k67ZCd80TSsw+JhkN
VuQRLqP4PVG2S9pTMBbZVF06FYhEAJSIfHZ0UmokgEXKo0SyDTdQW1oqyTid9iVu
iwu6cSxknAetqvKHa2hk45Z1VdD3RCqZB/i7n8ybGBW9Ol9jXfVpbLpSR4BZkCSs
2Ffl1amXwmyI1OAR95c4aaekEzGyHlebDrOJ2WWnnbdzF2tagJC3dCNjYSiYiwvl
rSeAOmBiqvd8HrX6z4yCAvhN3mn2VCG0+IY3z0ex+YZdm7+jGoeC1g87lgWLcGt3
ynQ9mnrS2c9Jiw+GhhpS4chEDUVF+KNbeU1/3ozQeb5KAssBcJY3isXWx89Nf1TG
kAQbsGxVCLqQuTUJOk6miE8BwmPSCbatKUETZ2PP8zlOpENc2toSbvtgA7/RZzdP
MKn7L/bYE/G7B3UiJ1czAmfO13/xXhUC/icjyml9yvTVkNjqywA=
=pOlm
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_4f08cf9c_20250110_211034.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-19

## Security Vulnerabilities fixed in Firefox ESR 115.10

Announced
April 16, 2024
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.10

#### [#CVE-2024-3852: GetBoundName in the JIT returned the wrong object](#CVE-2024-3852)

Reporter
Logan Stratton
Impact
high
##### Description

GetBoundName could return the wrong version of an object when JIT optimizations were applied.

##### References

* [Bug 1883542](https://bugzilla.mozilla.org/show_bug.cgi?id=1883542)

#### [#CVE-2024-3854: Out-of-bounds-read after mis-optimized switch statement](#CVE-2024-3854)

Reporter
Lukas Bernhard
Impact
high
##### Description

In some code patterns the JIT incorrectly optimized switch statements and generated code with out-of-bounds-reads.

##### References

* [Bug 1884552](https://bugzilla.mozilla.org/show_bug.cgi?id=1884552)

#### [#CVE-2024-3857: Incorrect JITting of arguments led to use-after-free during garbage collection](#CVE-2024-3857)

Reporter
Lukas Bernhard
Impact
high
##### Description

The JIT created incorrect code for arguments in certain cases. This led to potential use-after-free crashes during garbage collection.

##### References

* [Bug 1886683](https://bugzilla.mozilla.org/show_bug.cgi?id=1886683)

#### [#CVE-2024-2609: Permission prompt input delay could expire when not in focus](#CVE-2024-2609)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

The permission prompt input delay could expire while the window is not in focus. This makes it vulnerable to clickjacking by malicious websites.

##### References

* [Bug 1866100](https://bugzilla.mozilla.org/show_bug.cgi?id=1866100)

#### [#CVE-2024-3859: Integer-overflow led to out-of-bounds-read in the OpenType sanitizer](#CVE-2024-3859)

Reporter
Ronald Crane
Impact
moderate
##### Description

On 32-bit versions there were integer-overflows that led to an out-of-bounds-read that potentially could be triggered by a malformed OpenType font.

##### References

* [Bug 1874489](https://bugzilla.mozilla.org/show_bug.cgi?id=1874489)

#### [#CVE-2024-3861: Potential use-after-free due to AlignedBuffer self-move](#CVE-2024-3861)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an AlignedBuffer were assigned to itself, the subsequent self-move could result in an incorrect reference count and later use-after-free.

##### References

* [Bug 1883158](https://bugzilla.mozilla.org/show_bug.cgi?id=1883158)

#### [#CVE-2024-3863: Download Protections were bypassed by .xrm-ms files on Windows](#CVE-2024-3863)

Reporter
Eduardo Braun Prado working with Trend Micro Zero Day Initiative
Impact
moderate
##### Description

The executable file warning was not presented when downloading .xrm-ms files.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1885855](https://bugzilla.mozilla.org/show_bug.cgi?id=1885855)

#### [#CVE-2024-3302: Denial of Service using HTTP/2 CONTINUATION frames](#CVE-2024-3302)

Reporter
Bartek Nowotarski via CERT
Impact
low
##### Description

There was no limit to the number of HTTP/2 CONTINUATION frames that would be processed. A server could abuse this to create an Out of Memory condition in the browser.

##### References

* [Bug 1881183](https://bugzilla.mozilla.org/show_bug.cgi?id=1881183)
* [VU#421644 - HTTP/2 CONTINUATION frames can be utilized for DoS attacks](https://kb.cert.org/vuls/id/421644)

#### [#CVE-2024-3864: Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](#CVE-2024-3864)

Reporter
Paul Bone
Impact
high
##### Description

Memory safety bug present in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9. This bug showed evidence of memory corruption and we presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](https://bugzilla.mozilla.org/show_bug.cgi?id=1888333)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_9fd816d7_20250110_211034.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-20

## Security Vulnerabilities fixed in Thunderbird 115.10

Announced
April 16, 2024
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.10

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2024-3852: GetBoundName in the JIT returned the wrong object](#CVE-2024-3852)

Reporter
Logan Stratton
Impact
high
##### Description

GetBoundName could return the wrong version of an object when JIT optimizations were applied.

##### References

* [Bug 1883542](https://bugzilla.mozilla.org/show_bug.cgi?id=1883542)

#### [#CVE-2024-3854: Out-of-bounds-read after mis-optimized switch statement](#CVE-2024-3854)

Reporter
Lukas Bernhard
Impact
high
##### Description

In some code patterns the JIT incorrectly optimized switch statements and generated code with out-of-bounds-reads.

##### References

* [Bug 1884552](https://bugzilla.mozilla.org/show_bug.cgi?id=1884552)

#### [#CVE-2024-3857: Incorrect JITting of arguments led to use-after-free during garbage collection](#CVE-2024-3857)

Reporter
Lukas Bernhard
Impact
high
##### Description

The JIT created incorrect code for arguments in certain cases. This led to potential use-after-free crashes during garbage collection.

##### References

* [Bug 1886683](https://bugzilla.mozilla.org/show_bug.cgi?id=1886683)

#### [#CVE-2024-2609: Permission prompt input delay could expire when not in focus](#CVE-2024-2609)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

The permission prompt input delay could expire while the window is not in focus. This makes it vulnerable to clickjacking by malicious websites.

##### References

* [Bug 1866100](https://bugzilla.mozilla.org/show_bug.cgi?id=1866100)

#### [#CVE-2024-3859: Integer-overflow led to out-of-bounds-read in the OpenType sanitizer](#CVE-2024-3859)

Reporter
Ronald Crane
Impact
moderate
##### Description

On 32-bit versions there were integer-overflows that led to an out-of-bounds-read that potentially could be triggered by a malformed OpenType font.

##### References

* [Bug 1874489](https://bugzilla.mozilla.org/show_bug.cgi?id=1874489)

#### [#CVE-2024-3861: Potential use-after-free due to AlignedBuffer self-move](#CVE-2024-3861)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an AlignedBuffer were assigned to itself, the subsequent self-move could result in an incorrect reference count and later use-after-free.

##### References

* [Bug 1883158](https://bugzilla.mozilla.org/show_bug.cgi?id=1883158)

#### [#CVE-2024-3863: Download Protections were bypassed by .xrm-ms files on Windows](#CVE-2024-3863)

Reporter
Eduardo Braun Prado working with Trend Micro Zero Day Initiative
Impact
moderate
##### Description

The executable file warning was not presented when downloading .xrm-ms files.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1885855](https://bugzilla.mozilla.org/show_bug.cgi?id=1885855)

#### [#CVE-2024-3302: Denial of Service using HTTP/2 CONTINUATION frames](#CVE-2024-3302)

Reporter
Bartek Nowotarski via CERT
Impact
low
##### Description

There was no limit to the number of HTTP/2 CONTINUATION frames that would be processed. A server could abuse this to create an Out of Memory condition in the browser.

##### References

* [Bug 1881183](https://bugzilla.mozilla.org/show_bug.cgi?id=1881183)
* [VU#421644 - HTTP/2 CONTINUATION frames can be utilized for DoS attacks](https://kb.cert.org/vuls/id/421644)

#### [#CVE-2024-3864: Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](#CVE-2024-3864)

Reporter
Paul Bone
Impact
high
##### Description

Memory safety bug present in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9. This bug showed evidence of memory corruption and we presume that with enough effort this could have been exploited to run arbitrary code.

##### References

* [Memory safety bug fixed in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10](https://bugzilla.mozilla.org/show_bug.cgi?id=1888333)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


