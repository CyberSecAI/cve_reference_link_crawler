

[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241223074306759-703982459.jpg)](https://www.marscode.cn/?utm_source=advertising&utm_medium=cnblogs.com_ug_cpa&utm_term=hw_marscode_cnblogs&utm_content=home)
[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241201073014811-1847930772.jpg)](https://www.doubao.com?channel=cnblogs&source=hw_db_cnblogs)

* [![博客园Logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [周边](https://cnblogs.vip/store)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/18341478)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)
  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)
  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  简洁模式 ![](/images/lite-mode-check.svg)...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

## Loading

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/Rainy-Day/)
# [Rainy-Day](https://www.cnblogs.com/Rainy-Day)

##

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/Rainy-Day/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/_rainyday)
* 订阅
* [管理](https://i.cnblogs.com/)

# [0day-seeyonOA-zipslip（win）](https://www.cnblogs.com/Rainy-Day/p/18061399 "发布于 2024-03-08 16:59")

Incorrect decompression exists in **seeyonOA v8**. An attacker can gain access to the server through zipslip after obtaining ordinary user privileges.

# Route

![image.png](https://cdn.nlark.com/yuque/0/2024/png/26281757/1709886090174-ad5022dc-23ea-40d0-950d-260970603a26.png#averageHue=%23282b30&clientId=ua2b9fcf0-47b0-4&from=paste&height=360&id=u74c7b888&originHeight=720&originWidth=1944&originalType=binary&ratio=2&rotation=0&showTitle=false&size=216790&status=done&style=none&taskId=u4f5b0957-ac9d-4295-ba26-8586a22a847&title=&width=972)

# Analyse

The vulnerability lies in `WorkFlowDesignerController.class` 's `importProcess` method, which constructs multipart upload to upload malicious zip compressed files and writes shell to the web directory via`.. /`

1. get the input zipfile

![image.png](https://cdn.nlark.com/yuque/0/2024/png/26281757/1709886538258-d948d2d6-49f0-4774-8222-1dc3a1eb0aca.png#averageHue=%23212225&clientId=ua2b9fcf0-47b0-4&from=paste&height=694&id=u8919e483&originHeight=1388&originWidth=2086&originalType=binary&ratio=2&rotation=0&showTitle=false&size=289318&status=done&style=none&taskId=u94d5b626-a90c-42ad-8e04-8db55b14ea6&title=&width=1043)

2. create the temporary file and directory

![image.png](https://cdn.nlark.com/yuque/0/2024/png/26281757/1709886616813-18247336-2ac8-48d7-80a4-01bdb92a3b33.png#averageHue=%23202125&clientId=ua2b9fcf0-47b0-4&from=paste&height=475&id=ufd523b95&originHeight=950&originWidth=1952&originalType=binary&ratio=2&rotation=0&showTitle=false&size=122929&status=done&style=none&taskId=u0a4de9e5-9419-48a7-809a-107c69863e2&title=&width=976)

write the input to `tempZipFile`

![image.png](https://cdn.nlark.com/yuque/0/2024/png/26281757/1709886686976-82e548b1-f15b-4bc7-81ee-eb52633bbf2a.png#averageHue=%23212226&clientId=ua2b9fcf0-47b0-4&from=paste&height=536&id=u70dcfc7d&originHeight=1072&originWidth=1670&originalType=binary&ratio=2&rotation=0&showTitle=false&size=160341&status=done&style=none&taskId=ubcf5acbc-7d54-42a9-9c57-1b498afb996&title=&width=835)

3. Extract zipfile and write to the file

![image.png](https://cdn.nlark.com/yuque/0/2024/png/26281757/1709886817993-958941fe-f26e-439f-bc2f-81681243aa30.png#averageHue=%23212225&clientId=ua2b9fcf0-47b0-4&from=paste&height=615&id=u08cce4f8&originHeight=1230&originWidth=1918&originalType=binary&ratio=2&rotation=0&showTitle=false&size=211050&status=done&style=none&taskId=u72a5c1c1-bfe8-491e-bfd0-2ea1b67557b&title=&width=959)

```
CtpLocalFile newFile = new CtpLocalFile(savepath + entryName);

```

As can be seen from this code, the file name in the package is not checked during decompression, so that files can be written across directories.

# POC

![image.png](https://cdn.nlark.com/yuque/0/2024/png/26281757/1709887581347-44f7c1b2-4a5b-457f-8327-3938bb3b771b.png#averageHue=%23303030&clientId=ua2b9fcf0-47b0-4&from=paste&height=638&id=u09930014&originHeight=1276&originWidth=2386&originalType=binary&ratio=2&rotation=0&showTitle=false&size=391762&status=done&style=none&taskId=u86ad8244-ceba-4157-8a85-a3c8933c21e&title=&width=1193)

![image.png](https://cdn.nlark.com/yuque/0/2024/png/26281757/1709887646708-a238e66f-8ff3-47ce-ab1e-ec6855da1712.png#averageHue=%2322252b&clientId=ua2b9fcf0-47b0-4&from=paste&height=417&id=u92828989&originHeight=834&originWidth=2362&originalType=binary&ratio=2&rotation=0&showTitle=false&size=218352&status=done&style=none&taskId=u4d841384-bb18-46b4-af4a-695c3313e49&title=&width=1181)

![image.png](https://cdn.nlark.com/yuque/0/2024/png/26281757/1709887761641-88af079f-3838-4902-89be-936a9a10374e.png#averageHue=%234a4a4a&clientId=ua2b9fcf0-47b0-4&from=paste&height=143&id=uf4058c4c&originHeight=286&originWidth=1276&originalType=binary&ratio=2&rotation=0&showTitle=false&size=22717&status=done&style=none&taskId=u231a8a0f-2717-4c37-95b1-4543b3673af&title=&width=638)

posted @
2024-03-08 16:59
[\_rainyday](https://www.cnblogs.com/Rainy-Day)
阅读(411)
评论(0)
[编辑](https://i.cnblogs.com/EditPosts.aspx?postid=18061399)
收藏
举报

刷新页面[返回顶部](#top)

[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241201072501456-2052907165.jpg)](https://www.doubao.com?channel=cnblogs&source=hw_db_cnblogs)

### 公告

Copyright © 2025 \_rainyday

