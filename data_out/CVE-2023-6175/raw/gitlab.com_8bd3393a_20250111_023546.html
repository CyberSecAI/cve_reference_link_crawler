





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>NetScreen File Parsing Heap-based Buffer Overflow (#19404) · Issues · Wireshark Foundation / Wireshark · GitLab</title>
<script nonce="06OCyi5KZtoc34XwxxYR+Q==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="35056b58a87";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":false,"workItemsBeta":false,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="06OCyi5KZtoc34XwxxYR+Q==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/wireshark/wireshark/-/issues/19404/related_branches":{},"/wireshark/wireshark/-/issues/19404/discussions.json?per_page=20":{},"/wireshark/wireshark/-/issues/19404.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"1A7uQ9_SiIBXcLA8lCWqLT6LDVpR3rfjWAK2h-QIRbwWVbevn0vGcmmvGeefi4L2OjOLQ45zNtwvoeveR1MkXQ","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" />
<link rel="stylesheet" href="/assets/tailwind-e004e28eba8aa7ab9946870893dbaa4961cf178d8f976367b60e77aeb3ae342c.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.3753ae21.bundle.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/main.ab6b0ac3.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/tracker.493c474d.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/analytics.4c4c0b50.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script nonce="06OCyi5KZtoc34XwxxYR+Q==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JH9KFBJREK6BH8KNJGH513Z4","plan":"opensource","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":3421856,"project_id":7898047,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-webservice-web-c5fd47bf7-w55sl","instance_version":"17.8.0","context_generated_at":"2025-01-11T02:35:45.843Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace3421856/project7898047/-/issues/19404";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" as="style" type="text/css" nonce="7ebXYiEkpe2FLeLv/GKv6Q==">
<link rel="preload" href="/assets/application-3ac16694767839eb5e86660635af7a58d98adbf48dd11dbf3d42f80beff008ee.css" as="style" type="text/css" nonce="7ebXYiEkpe2FLeLv/GKv6Q==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="7ebXYiEkpe2FLeLv/GKv6Q==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="7ebXYiEkpe2FLeLv/GKv6Q==">



<script src="/assets/webpack/sentry.b707854c.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>

<script src="/assets/webpack/10.983bd1ac.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/12.0b1b07c1.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/14.629d03c2.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ec7189d6.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.570d5e43.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.f7a558c9.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/super_sidebar.566fc613.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.33350df1.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>
<script src="/assets/webpack/pages.projects.issues.show.3ad61df3.chunk.js" defer="defer" nonce="06OCyi5KZtoc34XwxxYR+Q=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="NetScreen File Parsing Heap-based Buffer Overflow (#19404) · Issues · Wireshark Foundation / Wireshark · GitLab" property="og:title">
<meta content="Trend Micro&#39;s Zero Day Initiative reported the following: ZDI-CAN-22164: Wireshark NetScreen File Parsing Heap-based Buffer Overflow Remote Code Execution Vulnerability -- CVSS ----------------------------------------- " property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/7898047/wsicon180.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/wireshark/wireshark/-/issues/19404" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="NetScreen File Parsing Heap-based Buffer Overflow (#19404) · Issues · Wireshark Foundation / Wireshark · GitLab" property="twitter:title">
<meta content="Trend Micro&#39;s Zero Day Initiative reported the following: ZDI-CAN-22164: Wireshark NetScreen File Parsing Heap-based Buffer Overflow Remote Code Execution Vulnerability -- CVSS ----------------------------------------- " property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/7898047/wsicon180.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="Gerald Combs">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="oBXO4N4j5s9ysn3suyLDFeP_Fr-b5W1roY7HSiR06d9iTpcMnrqoPUxt1DewjOvO50eQpkRI7FTWLZoThy-IPg" />
<meta name="csp-nonce" content="06OCyi5KZtoc34XwxxYR+Q==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-72a2cad5025aa931d6ea56c3201d1f18e68a8cd39788c7c80d5b2b82aa5143ef.png" id="favicon" data-original-href="/assets/favicon-72a2cad5025aa931d6ea56c3201d1f18e68a8cd39788c7c80d5b2b82aa5143ef.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="Trend Micro&#39;s Zero Day Initiative reported the following: ZDI-CAN-22164: Wireshark NetScreen File Parsing Heap-based Buffer Overflow Remote Code Execution Vulnerability -- CVSS ----------------------------------------- " name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="wireshark" data-group-full-path="wireshark" data-namespace-id="3421856" data-page="projects:issues:show" data-page-type-id="19404" data-project="wireshark" data-project-full-path="wireshark/wireshark" data-project-id="7898047">
<script nonce="06OCyi5KZtoc34XwxxYR+Q==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/wireshark/wireshark/-/autocomplete_sources/epics","iterations":"/wireshark/wireshark/-/autocomplete_sources/iterations","vulnerabilities":"/wireshark/wireshark/-/autocomplete_sources/vulnerabilities","members":"/wireshark/wireshark/-/autocomplete_sources/members?type=Issue\u0026type_id=19404","issues":"/wireshark/wireshark/-/autocomplete_sources/issues","mergeRequests":"/wireshark/wireshark/-/autocomplete_sources/merge_requests","labels":"/wireshark/wireshark/-/autocomplete_sources/labels?type=Issue\u0026type_id=19404","milestones":"/wireshark/wireshark/-/autocomplete_sources/milestones","commands":"/wireshark/wireshark/-/autocomplete_sources/commands?type=Issue\u0026type_id=19404","snippets":"/wireshark/wireshark/-/autocomplete_sources/snippets","contacts":"/wireshark/wireshark/-/autocomplete_sources/contacts?type=Issue\u0026type_id=19404","wikis":"/wireshark/wireshark/-/autocomplete_sources/wikis"};


//]]>
</script>
<script nonce="06OCyi5KZtoc34XwxxYR+Q==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/wireshark/wireshark/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/wireshark/wireshark/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;Wireshark&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/7898047/wsicon180.png&quot;,&quot;entity_id&quot;:7898047,&quot;link&quot;:&quot;/wireshark/wireshark&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_wiki&quot;,&quot;title&quot;:&quot;Wiki&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/wikis/home&quot;,&quot;link_classes&quot;:&quot;shortcuts-wiki&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;external_wiki&quot;,&quot;title&quot;:&quot;External wiki&quot;,&quot;link&quot;:&quot;https://wiki.wireshark.org/&quot;,&quot;link_classes&quot;:&quot;shortcuts-external_wiki&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/wireshark/wireshark/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:3421856,&quot;name&quot;:&quot;Wireshark Foundation&quot;,&quot;full_name&quot;:&quot;Wireshark Foundation&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/wireshark/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/wireshark/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:7898047,&quot;name&quot;:&quot;Wireshark&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/wireshark/wireshark/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/wireshark/wireshark/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Wireshark Foundation","item":"https://gitlab.com/wireshark"},{"@type":"ListItem","position":2,"name":"Wireshark","item":"https://gitlab.com/wireshark/wireshark"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/wireshark/wireshark/-/issues"},{"@type":"ListItem","position":4,"name":"#19404","item":"https://gitlab.com/wireshark/wireshark/-/issues/19404"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;Wireshark Foundation&quot;,&quot;href&quot;:&quot;/wireshark&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/3421856/wsicon180.png&quot;},{&quot;text&quot;:&quot;Wireshark&quot;,&quot;href&quot;:&quot;/wireshark/wireshark&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/7898047/wsicon180.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/wireshark/wireshark/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#19404&quot;,&quot;href&quot;:&quot;/wireshark/wireshark/-/issues/19404&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/wireshark/wireshark/-/issues/19404&quot;,&quot;new_issue_path&quot;:&quot;/wireshark/wireshark/-/issues/new?add_related_issue=19404&quot;,&quot;project_path&quot;:&quot;wireshark/wireshark&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:860017,&quot;reported_from_url&quot;:&quot;https://gitlab.com/wireshark/wireshark/-/issues/19404&quot;,&quot;submit_as_spam_path&quot;:&quot;/wireshark/wireshark/-/issues/19404/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/wireshark/wireshark/-/issues/19404&quot;,&quot;updateEndpoint&quot;:&quot;/wireshark/wireshark/-/issues/19404.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#19404&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/wireshark/wireshark/-/preview_markdown?target_id=19404\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:0,&quot;issuableTemplateNamesPath&quot;:&quot;/wireshark/wireshark/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;NetScreen File Parsing Heap-based Buffer Overflow&quot;,&quot;initialTitleText&quot;:&quot;NetScreen File Parsing Heap-based Buffer Overflow&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:57\&quot; dir=\&quot;auto\&quot;\u003eTrend Micro&#39;s Zero Day Initiative reported the following:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:110\&quot; dir=\&quot;auto\&quot;\u003eZDI-CAN-22164: Wireshark NetScreen File Parsing Heap-based Buffer Overflow Remote Code Execution Vulnerability\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;7:1-7:49\&quot; dir=\&quot;auto\&quot;\u003e-- CVSS -----------------------------------------\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-9:40\&quot; dir=\&quot;auto\&quot;\u003e7.8: AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;11:1-11:49\&quot; dir=\&quot;auto\&quot;\u003e-- ABSTRACT -------------------------------------\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-14:21\&quot; dir=\&quot;auto\&quot;\u003eTrend Micro&#39;s Zero Day Initiative has identified a vulnerability affecting the following products:\u0026#x000A;Wireshark - Wireshark\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;16:1-16:49\&quot; dir=\&quot;auto\&quot;\u003e-- VULNERABILITY DETAILS ------------------------\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;17:1-20:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;17:1-17:23\&quot;\u003eVersion tested: 4.0.8\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;18:1-18:43\&quot;\u003eInstaller file: Wireshark-win64-4.0.8.exe\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;19:1-20:0\&quot;\u003ePlatform tested: windows 2H22 22621.2283\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003chr data-sourcepos=\&quot;21:1-22:0\&quot;\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;23:1-23:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-analysis\&quot; class=\&quot;anchor\&quot; href=\&quot;#analysis\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAnalysis\u003c/h3\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;24:1-79:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThe vulnerability is inside the `netscreen` packet capture parser, the vulnerability will be triggered when a victim will open up a packet capture of type `netscreen`.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e`cf_read -\u0026gt; wtap_read -\u0026gt; netscreen_read`.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThe first function handle opening of a file, and then all the `netscreen` parsing function will be called.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThe vulnerability is placed inside the `parse_netscreen_packet` function, this function will try to parse each and every netscreen packet.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eIt will read from the file a line containing metadata of the packet:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eif (sscanf(line, \&quot;%9d.%9d: %15[a-z0-9/:.-](%1[io]) len=%9d:%12s-\u0026gt;%12s/\&quot;,\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u0026amp;sec, \u0026amp;dsec, cap_int, direction, \u0026amp;pkt_len, cap_src, cap_dst) \u0026lt; 5) {\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e*err = WTAP_ERR_BAD_FILE;\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e*err_info = g_strdup(\&quot;netscreen: Can&#39;t parse packet-header\&quot;);\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ereturn -1;\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e}\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eHere we can see that we read the pkt_len, this will be important later on.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThen we are going to enlarge the packet buffer to the pkt_len:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ews_buffer_assure_space(buf, pkt_len);\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003epd = ws_buffer_start_ptr(buf);\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThen we are having a loop that will read each line of a packet data until the end of the packet, and each iteration we are going to call to the `parse_single_hex_dump_line`:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003en = parse_single_hex_dump_line(p, pd, offset);\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThen in the function of `parse_single_hex_dump_line`, we are going to try to extract 16 hex dumped bytes and insert them into the buffer.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ebuf[byte_offset + num_items_scanned] = byte;\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC36\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC37\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC38\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThe `byte_offset` is the offset from the function, and the `num_items_scanned` is an iterator from 0 - 16.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC39\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThe vulnerability is that the parser does not have proper bound check, the function check in the end of the loop if the `offset` is not in bound of the `pkt_size`.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC40\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC41\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eif (offset \u0026gt; pkt_len) {\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC42\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e*err = WTAP_ERR_BAD_FILE;\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC43\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e*err_info = g_strdup(\&quot;netscreen: too much hex-data\&quot;);\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC44\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ereturn FALSE;\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC45\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e}\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC46\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC47\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC48\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ebut... the function `parse_single_hex_dump_line` will try to parse 16 bytes without checking inside it for any bounds! so what will happen if we hit the `parse_single_hex_dump_line` with the following conditions:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC49\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e`offset == 2047`\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC50\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e`line == 00 11 22 33 44 55 66 77`\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC51\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eWhat will happen is that we will write all the line bytes(from index 1) out bounded on the `buf` object!\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC52\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC53\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ePOC is to set the offset to 2047 and the line to size of 16 bytes, this will trigger the overflow.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC54\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;82:1-82:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-debug\&quot; class=\&quot;anchor\&quot; href=\&quot;#debug\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eDebug\u003c/h3\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;85:1-145:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eTurn on page heap.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ereg.exe add \&quot;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Wireshark.exe\&quot; /v \&quot;GlobalFlag\&quot; /t REG_SZ /d \&quot;0x02000000\&quot; /f\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eThen open pcap file with wireshark.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0:000\u0026gt; .exr -1\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eExceptionAddress: 00007ffd22c76577 (libwiretap+0x0000000000026577)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   ExceptionCode: c0000005 (Access violation)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  ExceptionFlags: 00000000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eNumberParameters: 2\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   Parameter[0]: 0000000000000001\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e   Parameter[1]: 000001ec28373000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eAttempt to write to address 000001ec28373000\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0:000\u0026gt; k\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e # Child-SP          RetAddr               Call Site\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e00 000000d7`7f8f9ef8 00007ffd`22c763a2     libwiretap+0x26577\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e01 000000d7`7f8f9f00 00007ffd`22c75fb8     libwiretap+0x263a2\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e02 000000d7`7f8fa000 00007ffd`22c9d09f     libwiretap+0x25fb8\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e03 000000d7`7f8fa100 00007ff6`5d026f01     libwiretap!wtap_read+0x4f\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e04 000000d7`7f8fa150 00007ff6`5d1e0518     Wireshark+0x6f01\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e05 000000d7`7f8fa710 00007ff6`5d1bb1a7     Wireshark+0x1c0518\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e06 000000d7`7f8fa880 00007ff6`5d315920     Wireshark+0x19b1a7\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e07 000000d7`7f8fa8e0 00007ffc`e1761da7     Wireshark+0x2f5920\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e08 000000d7`7f8fa960 00007ff6`5d33f803     Qt5Core!QObject::qt_static_metacall+0x1467\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e09 000000d7`7f8faab0 00007ff6`5d1a890d     Wireshark+0x31f803\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0a 000000d7`7f8faaf0 00007ffc`e1761da7     Wireshark+0x18890d\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0b 000000d7`7f8fab30 00007ffc`e246a0fb     Qt5Core!QObject::qt_static_metacall+0x1467\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0c 000000d7`7f8fac80 00007ffc`e1761da7     Qt5Widgets!QListWidget::qt_static_metacall+0x3cb\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0d 000000d7`7f8face0 00007ffc`e242b4ca     Qt5Core!QObject::qt_static_metacall+0x1467\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0e 000000d7`7f8fae30 00007ffc`e24315f6     Qt5Widgets!QAbstractItemView::activated+0x2a\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0f 000000d7`7f8fae70 00007ffc`e22379c8     Qt5Widgets!QAbstractItemView::mouseDoubleClickEvent+0x166\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e10 000000d7`7f8fafb0 00007ffc`e22d8ee0     Qt5Widgets!QWidget::event+0x148\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e11 000000d7`7f8fb040 00007ffc`e2438378     Qt5Widgets!QFrame::event+0x30\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC36\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e12 000000d7`7f8fb070 00007ffc`e1744b5a     Qt5Widgets!QAbstractItemView::viewportEvent+0x308\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC37\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e13 000000d7`7f8fb1c0 00007ffc`e221497c     Qt5Core!QCoreApplicationPrivate::sendThroughObjectEventFilters+0xda\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC38\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e14 000000d7`7f8fb220 00007ffc`e22128b0     Qt5Widgets!QApplicationPrivate::notify_helper+0xfc\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC39\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e15 000000d7`7f8fb250 00007ffc`e1742aca     Qt5Widgets!QApplication::notify+0x750\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC40\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e16 000000d7`7f8fb790 00007ffc`e2215b95     Qt5Core!QCoreApplication::notifyInternal2+0xba\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC41\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e17 000000d7`7f8fb800 00007ffc`e226040a     Qt5Widgets!QApplicationPrivate::sendMouseEvent+0x3c5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC42\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e18 000000d7`7f8fb8c0 00007ffc`e225e38e     Qt5Widgets!QSizePolicy::QSizePolicy+0x2d3a\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC43\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e19 000000d7`7f8fbc50 00007ffc`e2214990     Qt5Widgets!QSizePolicy::QSizePolicy+0xcbe\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC44\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e1a 000000d7`7f8fbd20 00007ffc`e2213a13     Qt5Widgets!QApplicationPrivate::notify_helper+0x110\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC45\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e1b 000000d7`7f8fbd50 00007ffc`e1742aca     Qt5Widgets!QApplication::notify+0x18b3\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC46\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e1c 000000d7`7f8fc290 00007ffc`e1b83896     Qt5Core!QCoreApplication::notifyInternal2+0xba\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC47\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e1d 000000d7`7f8fc300 00007ffc`e1b6ecb0     Qt5Gui!QGuiApplicationPrivate::processMouseEvent+0xf16\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC48\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e1e 000000d7`7f8fc7b0 00007ffc`e178ba5a     Qt5Gui!QWindowSystemInterface::sendWindowSystemEvents+0x90\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC49\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e1f 000000d7`7f8fc7e0 00007ffc`e0c32dd9     Qt5Core!QEventDispatcherWin32::processEvents+0x6a\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC50\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e20 000000d7`7f8ff910 00007ffc`e173ef2c     qwindows!qt_plugin_query_metadata+0x1f99\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC51\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e21 000000d7`7f8ff940 00007ffc`e1741a94     Qt5Core!QEventLoop::exec+0x1bc\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC52\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e22 000000d7`7f8ff9a0 00007ff6`5d103c0f     Qt5Core!QCoreApplication::exec+0x154\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC53\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e23 000000d7`7f8ffa00 00007ff6`5d3877c7     Wireshark+0xe3c0f\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC54\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e24 000000d7`7f8ffbf0 00007ff6`5d381276     Wireshark+0x3677c7\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC55\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e25 000000d7`7f8ffc80 00007ffd`ae2e257d     Wireshark+0x361276\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC56\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e26 000000d7`7f8ffcc0 00007ffd`af32aa68     KERNEL32!BaseThreadInitThunk+0x1d\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC57\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e27 000000d7`7f8ffcf0 00000000`00000000     ntdll!RtlUserThreadStart+0x28\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC58\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC59\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;148:1-150:54\&quot; dir=\&quot;auto\&quot;\u003e-- CREDIT ---------------------------------------\u0026#x000A;This vulnerability was discovered by:\u0026#x000A;Anonymous working with Trend Micro Zero Day Initiative\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;152:1-152:49\&quot; dir=\&quot;auto\&quot;\u003e-- FURTHER DETAILS ------------------------------\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;154:1-154:17\&quot; dir=\&quot;auto\&quot;\u003eSupporting files:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;157:1-157:203\&quot; dir=\&quot;auto\&quot;\u003eIf supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;159:1-159:599\&quot; dir=\&quot;auto\&quot;\u003ePlease confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 120 days of the reported date. If you are ready to release a patch at any point leading up to the deadline, please coordinate with us so that we may release our advisory detailing the issue. If the 120-day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations, so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;161:1-162:30\&quot; dir=\&quot;auto\&quot;\u003eZero Day Initiative\u0026#x000A;\u003ca href=\&quot;mailto:zdi-disclosures@trendmicro.com\&quot;\u003ezdi-disclosures@trendmicro.com\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;164:1-164:69\&quot; dir=\&quot;auto\&quot;\u003eThe PGP key used for all ZDI vendor communications is available from:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;166:3-166:68\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;http://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttp://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;168:1-169:469\&quot; dir=\&quot;auto\&quot;\u003e-- INFORMATION ABOUT THE ZDI --------------------\u0026#x000A;Established by TippingPoint and acquired by Trend Micro, the Zero Day Initiative (ZDI) neither re-sells vulnerability details nor exploit code. Instead, upon notifying the affected product vendor, the ZDI provides its Trend Micro TippingPoint customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;171:1-171:50\&quot; dir=\&quot;auto\&quot;\u003ePlease contact us for further details or refer to:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;173:3-173:34\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;http://www.zerodayinitiative.com\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttp://www.zerodayinitiative.com\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;175:1-175:49\&quot; dir=\&quot;auto\&quot;\u003e-- DISCLOSURE POLICY ----------------------------\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;177:1-177:59\&quot; dir=\&quot;auto\&quot;\u003eOur vulnerability disclosure policy is available online at:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;179:3-179:64\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;http://www.zerodayinitiative.com/advisories/disclosure_policy/\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttp://www.zerodayinitiative.com/advisories/disclosure_policy/\u003c/a\u003e\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;Trend Micro&#39;s Zero Day Initiative reported the following:\n\n\n\nZDI-CAN-22164: Wireshark NetScreen File Parsing Heap-based Buffer Overflow Remote Code Execution Vulnerability\n\n-- CVSS -----------------------------------------\n\n7.8: AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H\n\n-- ABSTRACT -------------------------------------\n\nTrend Micro&#39;s Zero Day Initiative has identified a vulnerability affecting the following products:\nWireshark - Wireshark\n\n-- VULNERABILITY DETAILS ------------------------\n* Version tested: 4.0.8\n* Installer file: Wireshark-win64-4.0.8.exe\n* Platform tested: windows 2H22 22621.2283\n\n---\n\n### Analysis\n```\n\n\nThe vulnerability is inside the `netscreen` packet capture parser, the vulnerability will be triggered when a victim will open up a packet capture of type `netscreen`.\n\n\n`cf_read -\u003e wtap_read -\u003e netscreen_read`.\nThe first function handle opening of a file, and then all the `netscreen` parsing function will be called.\n\nThe vulnerability is placed inside the `parse_netscreen_packet` function, this function will try to parse each and every netscreen packet.\nIt will read from the file a line containing metadata of the packet:\n\nif (sscanf(line, \&quot;%9d.%9d: %15[a-z0-9/:.-](%1[io]) len=%9d:%12s-\u003e%12s/\&quot;,\n\u0026sec, \u0026dsec, cap_int, direction, \u0026pkt_len, cap_src, cap_dst) \u003c 5) {\n*err = WTAP_ERR_BAD_FILE;\n*err_info = g_strdup(\&quot;netscreen: Can&#39;t parse packet-header\&quot;);\nreturn -1;\n}\n\n\nHere we can see that we read the pkt_len, this will be important later on.\n\nThen we are going to enlarge the packet buffer to the pkt_len:\n\nws_buffer_assure_space(buf, pkt_len);\npd = ws_buffer_start_ptr(buf);\n\nThen we are having a loop that will read each line of a packet data until the end of the packet, and each iteration we are going to call to the `parse_single_hex_dump_line`:\n\nn = parse_single_hex_dump_line(p, pd, offset);\n\n\nThen in the function of `parse_single_hex_dump_line`, we are going to try to extract 16 hex dumped bytes and insert them into the buffer.\n\n\nbuf[byte_offset + num_items_scanned] = byte;\n\n\nThe `byte_offset` is the offset from the function, and the `num_items_scanned` is an iterator from 0 - 16.\nThe vulnerability is that the parser does not have proper bound check, the function check in the end of the loop if the `offset` is not in bound of the `pkt_size`.\n\nif (offset \u003e pkt_len) {\n*err = WTAP_ERR_BAD_FILE;\n*err_info = g_strdup(\&quot;netscreen: too much hex-data\&quot;);\nreturn FALSE;\n}\n\n\nbut... the function `parse_single_hex_dump_line` will try to parse 16 bytes without checking inside it for any bounds! so what will happen if we hit the `parse_single_hex_dump_line` with the following conditions:\n`offset == 2047`\n`line == 00 11 22 33 44 55 66 77`\nWhat will happen is that we will write all the line bytes(from index 1) out bounded on the `buf` object!\n\nPOC is to set the offset to 2047 and the line to size of 16 bytes, this will trigger the overflow.\n\n```\n\n\n### Debug\n\n\n```\n\nTurn on page heap.\n\nreg.exe add \&quot;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Wireshark.exe\&quot; /v \&quot;GlobalFlag\&quot; /t REG_SZ /d \&quot;0x02000000\&quot; /f\n\nThen open pcap file with wireshark.\n\n0:000\u003e .exr -1\nExceptionAddress: 00007ffd22c76577 (libwiretap+0x0000000000026577)\n   ExceptionCode: c0000005 (Access violation)\n  ExceptionFlags: 00000000\nNumberParameters: 2\n   Parameter[0]: 0000000000000001\n   Parameter[1]: 000001ec28373000\nAttempt to write to address 000001ec28373000\n0:000\u003e k\n # Child-SP          RetAddr               Call Site\n00 000000d7`7f8f9ef8 00007ffd`22c763a2     libwiretap+0x26577\n01 000000d7`7f8f9f00 00007ffd`22c75fb8     libwiretap+0x263a2\n02 000000d7`7f8fa000 00007ffd`22c9d09f     libwiretap+0x25fb8\n03 000000d7`7f8fa100 00007ff6`5d026f01     libwiretap!wtap_read+0x4f\n04 000000d7`7f8fa150 00007ff6`5d1e0518     Wireshark+0x6f01\n05 000000d7`7f8fa710 00007ff6`5d1bb1a7     Wireshark+0x1c0518\n06 000000d7`7f8fa880 00007ff6`5d315920     Wireshark+0x19b1a7\n07 000000d7`7f8fa8e0 00007ffc`e1761da7     Wireshark+0x2f5920\n08 000000d7`7f8fa960 00007ff6`5d33f803     Qt5Core!QObject::qt_static_metacall+0x1467\n09 000000d7`7f8faab0 00007ff6`5d1a890d     Wireshark+0x31f803\n0a 000000d7`7f8faaf0 00007ffc`e1761da7     Wireshark+0x18890d\n0b 000000d7`7f8fab30 00007ffc`e246a0fb     Qt5Core!QObject::qt_static_metacall+0x1467\n0c 000000d7`7f8fac80 00007ffc`e1761da7     Qt5Widgets!QListWidget::qt_static_metacall+0x3cb\n0d 000000d7`7f8face0 00007ffc`e242b4ca     Qt5Core!QObject::qt_static_metacall+0x1467\n0e 000000d7`7f8fae30 00007ffc`e24315f6     Qt5Widgets!QAbstractItemView::activated+0x2a\n0f 000000d7`7f8fae70 00007ffc`e22379c8     Qt5Widgets!QAbstractItemView::mouseDoubleClickEvent+0x166\n10 000000d7`7f8fafb0 00007ffc`e22d8ee0     Qt5Widgets!QWidget::event+0x148\n11 000000d7`7f8fb040 00007ffc`e2438378     Qt5Widgets!QFrame::event+0x30\n12 000000d7`7f8fb070 00007ffc`e1744b5a     Qt5Widgets!QAbstractItemView::viewportEvent+0x308\n13 000000d7`7f8fb1c0 00007ffc`e221497c     Qt5Core!QCoreApplicationPrivate::sendThroughObjectEventFilters+0xda\n14 000000d7`7f8fb220 00007ffc`e22128b0     Qt5Widgets!QApplicationPrivate::notify_helper+0xfc\n15 000000d7`7f8fb250 00007ffc`e1742aca     Qt5Widgets!QApplication::notify+0x750\n16 000000d7`7f8fb790 00007ffc`e2215b95     Qt5Core!QCoreApplication::notifyInternal2+0xba\n17 000000d7`7f8fb800 00007ffc`e226040a     Qt5Widgets!QApplicationPrivate::sendMouseEvent+0x3c5\n18 000000d7`7f8fb8c0 00007ffc`e225e38e     Qt5Widgets!QSizePolicy::QSizePolicy+0x2d3a\n19 000000d7`7f8fbc50 00007ffc`e2214990     Qt5Widgets!QSizePolicy::QSizePolicy+0xcbe\n1a 000000d7`7f8fbd20 00007ffc`e2213a13     Qt5Widgets!QApplicationPrivate::notify_helper+0x110\n1b 000000d7`7f8fbd50 00007ffc`e1742aca     Qt5Widgets!QApplication::notify+0x18b3\n1c 000000d7`7f8fc290 00007ffc`e1b83896     Qt5Core!QCoreApplication::notifyInternal2+0xba\n1d 000000d7`7f8fc300 00007ffc`e1b6ecb0     Qt5Gui!QGuiApplicationPrivate::processMouseEvent+0xf16\n1e 000000d7`7f8fc7b0 00007ffc`e178ba5a     Qt5Gui!QWindowSystemInterface::sendWindowSystemEvents+0x90\n1f 000000d7`7f8fc7e0 00007ffc`e0c32dd9     Qt5Core!QEventDispatcherWin32::processEvents+0x6a\n20 000000d7`7f8ff910 00007ffc`e173ef2c     qwindows!qt_plugin_query_metadata+0x1f99\n21 000000d7`7f8ff940 00007ffc`e1741a94     Qt5Core!QEventLoop::exec+0x1bc\n22 000000d7`7f8ff9a0 00007ff6`5d103c0f     Qt5Core!QCoreApplication::exec+0x154\n23 000000d7`7f8ffa00 00007ff6`5d3877c7     Wireshark+0xe3c0f\n24 000000d7`7f8ffbf0 00007ff6`5d381276     Wireshark+0x3677c7\n25 000000d7`7f8ffc80 00007ffd`ae2e257d     Wireshark+0x361276\n26 000000d7`7f8ffcc0 00007ffd`af32aa68     KERNEL32!BaseThreadInitThunk+0x1d\n27 000000d7`7f8ffcf0 00000000`00000000     ntdll!RtlUserThreadStart+0x28\n\n\n```\n\n\n-- CREDIT ---------------------------------------\nThis vulnerability was discovered by:\nAnonymous working with Trend Micro Zero Day Initiative\n\n-- FURTHER DETAILS ------------------------------\n\nSupporting files:\n\n\nIf supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number.\n\nPlease confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 120 days of the reported date. If you are ready to release a patch at any point leading up to the deadline, please coordinate with us so that we may release our advisory detailing the issue. If the 120-day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations, so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time:\n\nZero Day Initiative\nzdi-disclosures@trendmicro.com\n\nThe PGP key used for all ZDI vendor communications is available from:\n\n  http://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc\n\n-- INFORMATION ABOUT THE ZDI --------------------\nEstablished by TippingPoint and acquired by Trend Micro, the Zero Day Initiative (ZDI) neither re-sells vulnerability details nor exploit code. Instead, upon notifying the affected product vendor, the ZDI provides its Trend Micro TippingPoint customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available.\n\nPlease contact us for further details or refer to:\n\n  http://www.zerodayinitiative.com\n\n-- DISCLOSURE POLICY ----------------------------\n\nOur vulnerability disclosure policy is available online at:\n\n  http://www.zerodayinitiative.com/advisories/disclosure_policy/&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;wireshark/wireshark&quot;,&quot;iid&quot;:19404,&quot;issuableId&quot;:136581826,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:860017,&quot;authorName&quot;:&quot;Gerald Combs&quot;,&quot;authorUsername&quot;:&quot;geraldcombs&quot;,&quot;authorWebUrl&quot;:&quot;/geraldcombs&quot;,&quot;createdAt&quot;:&quot;2023-10-17T18:36:44+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:7898047,&quot;projectPath&quot;:&quot;wireshark&quot;,&quot;projectNamespace&quot;:&quot;wireshark&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">NetScreen File Parsing Heap-based Buffer Overflow</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:57" dir="auto">Trend Micro's Zero Day Initiative reported the following:</p>&#x000A;<p data-sourcepos="5:1-5:110" dir="auto">ZDI-CAN-22164: Wireshark NetScreen File Parsing Heap-based Buffer Overflow Remote Code Execution Vulnerability</p>&#x000A;<p data-sourcepos="7:1-7:49" dir="auto">-- CVSS -----------------------------------------</p>&#x000A;<p data-sourcepos="9:1-9:40" dir="auto">7.8: AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H</p>&#x000A;<p data-sourcepos="11:1-11:49" dir="auto">-- ABSTRACT -------------------------------------</p>&#x000A;<p data-sourcepos="13:1-14:21" dir="auto">Trend Micro's Zero Day Initiative has identified a vulnerability affecting the following products:&#x000A;Wireshark - Wireshark</p>&#x000A;<p data-sourcepos="16:1-16:49" dir="auto">-- VULNERABILITY DETAILS ------------------------</p>&#x000A;<ul data-sourcepos="17:1-20:0" dir="auto">&#x000A;<li data-sourcepos="17:1-17:23">Version tested: 4.0.8</li>&#x000A;<li data-sourcepos="18:1-18:43">Installer file: Wireshark-win64-4.0.8.exe</li>&#x000A;<li data-sourcepos="19:1-20:0">Platform tested: windows 2H22 22621.2283</li>&#x000A;</ul>&#x000A;<hr data-sourcepos="21:1-22:0">&#x000A;<h3 data-sourcepos="23:1-23:12" dir="auto">&#x000A;<a id="user-content-analysis" class="anchor" href="#analysis" aria-hidden="true"></a>Analysis</h3>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="24:1-79:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext"></span>&#x000A;<span id="LC2" class="line" lang="plaintext"></span>&#x000A;<span id="LC3" class="line" lang="plaintext">The vulnerability is inside the `netscreen` packet capture parser, the vulnerability will be triggered when a victim will open up a packet capture of type `netscreen`.</span>&#x000A;<span id="LC4" class="line" lang="plaintext"></span>&#x000A;<span id="LC5" class="line" lang="plaintext"></span>&#x000A;<span id="LC6" class="line" lang="plaintext">`cf_read -&gt; wtap_read -&gt; netscreen_read`.</span>&#x000A;<span id="LC7" class="line" lang="plaintext">The first function handle opening of a file, and then all the `netscreen` parsing function will be called.</span>&#x000A;<span id="LC8" class="line" lang="plaintext"></span>&#x000A;<span id="LC9" class="line" lang="plaintext">The vulnerability is placed inside the `parse_netscreen_packet` function, this function will try to parse each and every netscreen packet.</span>&#x000A;<span id="LC10" class="line" lang="plaintext">It will read from the file a line containing metadata of the packet:</span>&#x000A;<span id="LC11" class="line" lang="plaintext"></span>&#x000A;<span id="LC12" class="line" lang="plaintext">if (sscanf(line, "%9d.%9d: %15[a-z0-9/:.-](%1[io]) len=%9d:%12s-&gt;%12s/",</span>&#x000A;<span id="LC13" class="line" lang="plaintext">&amp;sec, &amp;dsec, cap_int, direction, &amp;pkt_len, cap_src, cap_dst) &lt; 5) {</span>&#x000A;<span id="LC14" class="line" lang="plaintext">*err = WTAP_ERR_BAD_FILE;</span>&#x000A;<span id="LC15" class="line" lang="plaintext">*err_info = g_strdup("netscreen: Can't parse packet-header");</span>&#x000A;<span id="LC16" class="line" lang="plaintext">return -1;</span>&#x000A;<span id="LC17" class="line" lang="plaintext">}</span>&#x000A;<span id="LC18" class="line" lang="plaintext"></span>&#x000A;<span id="LC19" class="line" lang="plaintext"></span>&#x000A;<span id="LC20" class="line" lang="plaintext">Here we can see that we read the pkt_len, this will be important later on.</span>&#x000A;<span id="LC21" class="line" lang="plaintext"></span>&#x000A;<span id="LC22" class="line" lang="plaintext">Then we are going to enlarge the packet buffer to the pkt_len:</span>&#x000A;<span id="LC23" class="line" lang="plaintext"></span>&#x000A;<span id="LC24" class="line" lang="plaintext">ws_buffer_assure_space(buf, pkt_len);</span>&#x000A;<span id="LC25" class="line" lang="plaintext">pd = ws_buffer_start_ptr(buf);</span>&#x000A;<span id="LC26" class="line" lang="plaintext"></span>&#x000A;<span id="LC27" class="line" lang="plaintext">Then we are having a loop that will read each line of a packet data until the end of the packet, and each iteration we are going to call to the `parse_single_hex_dump_line`:</span>&#x000A;<span id="LC28" class="line" lang="plaintext"></span>&#x000A;<span id="LC29" class="line" lang="plaintext">n = parse_single_hex_dump_line(p, pd, offset);</span>&#x000A;<span id="LC30" class="line" lang="plaintext"></span>&#x000A;<span id="LC31" class="line" lang="plaintext"></span>&#x000A;<span id="LC32" class="line" lang="plaintext">Then in the function of `parse_single_hex_dump_line`, we are going to try to extract 16 hex dumped bytes and insert them into the buffer.</span>&#x000A;<span id="LC33" class="line" lang="plaintext"></span>&#x000A;<span id="LC34" class="line" lang="plaintext"></span>&#x000A;<span id="LC35" class="line" lang="plaintext">buf[byte_offset + num_items_scanned] = byte;</span>&#x000A;<span id="LC36" class="line" lang="plaintext"></span>&#x000A;<span id="LC37" class="line" lang="plaintext"></span>&#x000A;<span id="LC38" class="line" lang="plaintext">The `byte_offset` is the offset from the function, and the `num_items_scanned` is an iterator from 0 - 16.</span>&#x000A;<span id="LC39" class="line" lang="plaintext">The vulnerability is that the parser does not have proper bound check, the function check in the end of the loop if the `offset` is not in bound of the `pkt_size`.</span>&#x000A;<span id="LC40" class="line" lang="plaintext"></span>&#x000A;<span id="LC41" class="line" lang="plaintext">if (offset &gt; pkt_len) {</span>&#x000A;<span id="LC42" class="line" lang="plaintext">*err = WTAP_ERR_BAD_FILE;</span>&#x000A;<span id="LC43" class="line" lang="plaintext">*err_info = g_strdup("netscreen: too much hex-data");</span>&#x000A;<span id="LC44" class="line" lang="plaintext">return FALSE;</span>&#x000A;<span id="LC45" class="line" lang="plaintext">}</span>&#x000A;<span id="LC46" class="line" lang="plaintext"></span>&#x000A;<span id="LC47" class="line" lang="plaintext"></span>&#x000A;<span id="LC48" class="line" lang="plaintext">but... the function `parse_single_hex_dump_line` will try to parse 16 bytes without checking inside it for any bounds! so what will happen if we hit the `parse_single_hex_dump_line` with the following conditions:</span>&#x000A;<span id="LC49" class="line" lang="plaintext">`offset == 2047`</span>&#x000A;<span id="LC50" class="line" lang="plaintext">`line == 00 11 22 33 44 55 66 77`</span>&#x000A;<span id="LC51" class="line" lang="plaintext">What will happen is that we will write all the line bytes(from index 1) out bounded on the `buf` object!</span>&#x000A;<span id="LC52" class="line" lang="plaintext"></span>&#x000A;<span id="LC53" class="line" lang="plaintext">POC is to set the offset to 2047 and the line to size of 16 bytes, this will trigger the overflow.</span>&#x000A;<span id="LC54" class="line" lang="plaintext"></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h3 data-sourcepos="82:1-82:9" dir="auto">&#x000A;<a id="user-content-debug" class="anchor" href="#debug" aria-hidden="true"></a>Debug</h3>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="85:1-145:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext"></span>&#x000A;<span id="LC2" class="line" lang="plaintext">Turn on page heap.</span>&#x000A;<span id="LC3" class="line" lang="plaintext"></span>&#x000A;<span id="LC4" class="line" lang="plaintext">reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\Wireshark.exe" /v "GlobalFlag" /t REG_SZ /d "0x02000000" /f</span>&#x000A;<span id="LC5" class="line" lang="plaintext"></span>&#x000A;<span id="LC6" class="line" lang="plaintext">Then open pcap file with wireshark.</span>&#x000A;<span id="LC7" class="line" lang="plaintext"></span>&#x000A;<span id="LC8" class="line" lang="plaintext">0:000&gt; .exr -1</span>&#x000A;<span id="LC9" class="line" lang="plaintext">ExceptionAddress: 00007ffd22c76577 (libwiretap+0x0000000000026577)</span>&#x000A;<span id="LC10" class="line" lang="plaintext">   ExceptionCode: c0000005 (Access violation)</span>&#x000A;<span id="LC11" class="line" lang="plaintext">  ExceptionFlags: 00000000</span>&#x000A;<span id="LC12" class="line" lang="plaintext">NumberParameters: 2</span>&#x000A;<span id="LC13" class="line" lang="plaintext">   Parameter[0]: 0000000000000001</span>&#x000A;<span id="LC14" class="line" lang="plaintext">   Parameter[1]: 000001ec28373000</span>&#x000A;<span id="LC15" class="line" lang="plaintext">Attempt to write to address 000001ec28373000</span>&#x000A;<span id="LC16" class="line" lang="plaintext">0:000&gt; k</span>&#x000A;<span id="LC17" class="line" lang="plaintext"> # Child-SP          RetAddr               Call Site</span>&#x000A;<span id="LC18" class="line" lang="plaintext">00 000000d7`7f8f9ef8 00007ffd`22c763a2     libwiretap+0x26577</span>&#x000A;<span id="LC19" class="line" lang="plaintext">01 000000d7`7f8f9f00 00007ffd`22c75fb8     libwiretap+0x263a2</span>&#x000A;<span id="LC20" class="line" lang="plaintext">02 000000d7`7f8fa000 00007ffd`22c9d09f     libwiretap+0x25fb8</span>&#x000A;<span id="LC21" class="line" lang="plaintext">03 000000d7`7f8fa100 00007ff6`5d026f01     libwiretap!wtap_read+0x4f</span>&#x000A;<span id="LC22" class="line" lang="plaintext">04 000000d7`7f8fa150 00007ff6`5d1e0518     Wireshark+0x6f01</span>&#x000A;<span id="LC23" class="line" lang="plaintext">05 000000d7`7f8fa710 00007ff6`5d1bb1a7     Wireshark+0x1c0518</span>&#x000A;<span id="LC24" class="line" lang="plaintext">06 000000d7`7f8fa880 00007ff6`5d315920     Wireshark+0x19b1a7</span>&#x000A;<span id="LC25" class="line" lang="plaintext">07 000000d7`7f8fa8e0 00007ffc`e1761da7     Wireshark+0x2f5920</span>&#x000A;<span id="LC26" class="line" lang="plaintext">08 000000d7`7f8fa960 00007ff6`5d33f803     Qt5Core!QObject::qt_static_metacall+0x1467</span>&#x000A;<span id="LC27" class="line" lang="plaintext">09 000000d7`7f8faab0 00007ff6`5d1a890d     Wireshark+0x31f803</span>&#x000A;<span id="LC28" class="line" lang="plaintext">0a 000000d7`7f8faaf0 00007ffc`e1761da7     Wireshark+0x18890d</span>&#x000A;<span id="LC29" class="line" lang="plaintext">0b 000000d7`7f8fab30 00007ffc`e246a0fb     Qt5Core!QObject::qt_static_metacall+0x1467</span>&#x000A;<span id="LC30" class="line" lang="plaintext">0c 000000d7`7f8fac80 00007ffc`e1761da7     Qt5Widgets!QListWidget::qt_static_metacall+0x3cb</span>&#x000A;<span id="LC31" class="line" lang="plaintext">0d 000000d7`7f8face0 00007ffc`e242b4ca     Qt5Core!QObject::qt_static_metacall+0x1467</span>&#x000A;<span id="LC32" class="line" lang="plaintext">0e 000000d7`7f8fae30 00007ffc`e24315f6     Qt5Widgets!QAbstractItemView::activated+0x2a</span>&#x000A;<span id="LC33" class="line" lang="plaintext">0f 000000d7`7f8fae70 00007ffc`e22379c8     Qt5Widgets!QAbstractItemView::mouseDoubleClickEvent+0x166</span>&#x000A;<span id="LC34" class="line" lang="plaintext">10 000000d7`7f8fafb0 00007ffc`e22d8ee0     Qt5Widgets!QWidget::event+0x148</span>&#x000A;<span id="LC35" class="line" lang="plaintext">11 000000d7`7f8fb040 00007ffc`e2438378     Qt5Widgets!QFrame::event+0x30</span>&#x000A;<span id="LC36" class="line" lang="plaintext">12 000000d7`7f8fb070 00007ffc`e1744b5a     Qt5Widgets!QAbstractItemView::viewportEvent+0x308</span>&#x000A;<span id="LC37" class="line" lang="plaintext">13 000000d7`7f8fb1c0 00007ffc`e221497c     Qt5Core!QCoreApplicationPrivate::sendThroughObjectEventFilters+0xda</span>&#x000A;<span id="LC38" class="line" lang="plaintext">14 000000d7`7f8fb220 00007ffc`e22128b0     Qt5Widgets!QApplicationPrivate::notify_helper+0xfc</span>&#x000A;<span id="LC39" class="line" lang="plaintext">15 000000d7`7f8fb250 00007ffc`e1742aca     Qt5Widgets!QApplication::notify+0x750</span>&#x000A;<span id="LC40" class="line" lang="plaintext">16 000000d7`7f8fb790 00007ffc`e2215b95     Qt5Core!QCoreApplication::notifyInternal2+0xba</span>&#x000A;<span id="LC41" class="line" lang="plaintext">17 000000d7`7f8fb800 00007ffc`e226040a     Qt5Widgets!QApplicationPrivate::sendMouseEvent+0x3c5</span>&#x000A;<span id="LC42" class="line" lang="plaintext">18 000000d7`7f8fb8c0 00007ffc`e225e38e     Qt5Widgets!QSizePolicy::QSizePolicy+0x2d3a</span>&#x000A;<span id="LC43" class="line" lang="plaintext">19 000000d7`7f8fbc50 00007ffc`e2214990     Qt5Widgets!QSizePolicy::QSizePolicy+0xcbe</span>&#x000A;<span id="LC44" class="line" lang="plaintext">1a 000000d7`7f8fbd20 00007ffc`e2213a13     Qt5Widgets!QApplicationPrivate::notify_helper+0x110</span>&#x000A;<span id="LC45" class="line" lang="plaintext">1b 000000d7`7f8fbd50 00007ffc`e1742aca     Qt5Widgets!QApplication::notify+0x18b3</span>&#x000A;<span id="LC46" class="line" lang="plaintext">1c 000000d7`7f8fc290 00007ffc`e1b83896     Qt5Core!QCoreApplication::notifyInternal2+0xba</span>&#x000A;<span id="LC47" class="line" lang="plaintext">1d 000000d7`7f8fc300 00007ffc`e1b6ecb0     Qt5Gui!QGuiApplicationPrivate::processMouseEvent+0xf16</span>&#x000A;<span id="LC48" class="line" lang="plaintext">1e 000000d7`7f8fc7b0 00007ffc`e178ba5a     Qt5Gui!QWindowSystemInterface::sendWindowSystemEvents+0x90</span>&#x000A;<span id="LC49" class="line" lang="plaintext">1f 000000d7`7f8fc7e0 00007ffc`e0c32dd9     Qt5Core!QEventDispatcherWin32::processEvents+0x6a</span>&#x000A;<span id="LC50" class="line" lang="plaintext">20 000000d7`7f8ff910 00007ffc`e173ef2c     qwindows!qt_plugin_query_metadata+0x1f99</span>&#x000A;<span id="LC51" class="line" lang="plaintext">21 000000d7`7f8ff940 00007ffc`e1741a94     Qt5Core!QEventLoop::exec+0x1bc</span>&#x000A;<span id="LC52" class="line" lang="plaintext">22 000000d7`7f8ff9a0 00007ff6`5d103c0f     Qt5Core!QCoreApplication::exec+0x154</span>&#x000A;<span id="LC53" class="line" lang="plaintext">23 000000d7`7f8ffa00 00007ff6`5d3877c7     Wireshark+0xe3c0f</span>&#x000A;<span id="LC54" class="line" lang="plaintext">24 000000d7`7f8ffbf0 00007ff6`5d381276     Wireshark+0x3677c7</span>&#x000A;<span id="LC55" class="line" lang="plaintext">25 000000d7`7f8ffc80 00007ffd`ae2e257d     Wireshark+0x361276</span>&#x000A;<span id="LC56" class="line" lang="plaintext">26 000000d7`7f8ffcc0 00007ffd`af32aa68     KERNEL32!BaseThreadInitThunk+0x1d</span>&#x000A;<span id="LC57" class="line" lang="plaintext">27 000000d7`7f8ffcf0 00000000`00000000     ntdll!RtlUserThreadStart+0x28</span>&#x000A;<span id="LC58" class="line" lang="plaintext"></span>&#x000A;<span id="LC59" class="line" lang="plaintext"></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="148:1-150:54" dir="auto">-- CREDIT ---------------------------------------&#x000A;This vulnerability was discovered by:&#x000A;Anonymous working with Trend Micro Zero Day Initiative</p>&#x000A;<p data-sourcepos="152:1-152:49" dir="auto">-- FURTHER DETAILS ------------------------------</p>&#x000A;<p data-sourcepos="154:1-154:17" dir="auto">Supporting files:</p>&#x000A;<p data-sourcepos="157:1-157:203" dir="auto">If supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number.</p>&#x000A;<p data-sourcepos="159:1-159:599" dir="auto">Please confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 120 days of the reported date. If you are ready to release a patch at any point leading up to the deadline, please coordinate with us so that we may release our advisory detailing the issue. If the 120-day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations, so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time:</p>&#x000A;<p data-sourcepos="161:1-162:30" dir="auto">Zero Day Initiative&#x000A;<a href="mailto:zdi-disclosures@trendmicro.com">zdi-disclosures@trendmicro.com</a></p>&#x000A;<p data-sourcepos="164:1-164:69" dir="auto">The PGP key used for all ZDI vendor communications is available from:</p>&#x000A;<p data-sourcepos="166:3-166:68" dir="auto"><a href="http://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc" rel="nofollow noreferrer noopener" target="_blank">http://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc</a></p>&#x000A;<p data-sourcepos="168:1-169:469" dir="auto">-- INFORMATION ABOUT THE ZDI --------------------&#x000A;Established by TippingPoint and acquired by Trend Micro, the Zero Day Initiative (ZDI) neither re-sells vulnerability details nor exploit code. Instead, upon notifying the affected product vendor, the ZDI provides its Trend Micro TippingPoint customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available.</p>&#x000A;<p data-sourcepos="171:1-171:50" dir="auto">Please contact us for further details or refer to:</p>&#x000A;<p data-sourcepos="173:3-173:34" dir="auto"><a href="http://www.zerodayinitiative.com" rel="nofollow noreferrer noopener" target="_blank">http://www.zerodayinitiative.com</a></p>&#x000A;<p data-sourcepos="175:1-175:49" dir="auto">-- DISCLOSURE POLICY ----------------------------</p>&#x000A;<p data-sourcepos="177:1-177:59" dir="auto">Our vulnerability disclosure policy is available online at:</p>&#x000A;<p data-sourcepos="179:3-179:64" dir="auto"><a href="http://www.zerodayinitiative.com/advisories/disclosure_policy/" rel="nofollow noreferrer noopener" target="_blank">http://www.zerodayinitiative.com/advisories/disclosure_policy/</a></p></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/7898047/issues/19404/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-default gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="wireshark/wireshark" data-issuable-id="136581826" data-issuable-iid="19404" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/wireshark/-/epics" data-wi-full-path="wireshark/wireshark" data-wi-group-id="3421856" data-wi-group-issues-path="/groups/wireshark/-/issues" data-wi-group-path="wireshark" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/wireshark/wireshark/-/issues" data-wi-labels-fetch-path="/groups/wireshark/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/wireshark/wireshark/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=3421856" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/wireshark/wireshark/-/issues/19404/links" data-full-path="wireshark/wireshark" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/wireshark/-/epics" data-wi-full-path="wireshark/wireshark" data-wi-group-id="3421856" data-wi-group-issues-path="/groups/wireshark/-/issues" data-wi-group-path="wireshark" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/wireshark/wireshark/-/issues" data-wi-labels-fetch-path="/groups/wireshark/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/wireshark/wireshark/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=3421856" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="true" data-iid="19404" data-project-path="wireshark/wireshark" id="js-related-merge-requests"></div>
<div data-url="/wireshark/wireshark/-/issues/19404/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:136581826,&quot;iid&quot;:19404,&quot;description&quot;:&quot;Trend Micro&#39;s Zero Day Initiative reported the following:\n\n\n\nZDI-CAN-22164: Wireshark NetScreen File Parsing Heap-based Buffer Overflow Remote Code Execution Vulnerability\n\n-- CVSS -----------------------------------------\n\n7.8: AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H\n\n-- ABSTRACT -------------------------------------\n\nTrend Micro&#39;s Zero Day Initiative has identified a vulnerability affecting the following products:\nWireshark - Wireshark\n\n-- VULNERABILITY DETAILS ------------------------\n* Version tested: 4.0.8\n* Installer file: Wireshark-win64-4.0.8.exe\n* Platform tested: windows 2H22 22621.2283\n\n---\n\n### Analysis\n```\n\n\nThe vulnerability is inside the `netscreen` packet capture parser, the vulnerability will be triggered when a victim will open up a packet capture of type `netscreen`.\n\n\n`cf_read -\u003e wtap_read -\u003e netscreen_read`.\nThe first function handle opening of a file, and then all the `netscreen` parsing function will be called.\n\nThe vulnerability is placed inside the `parse_netscreen_packet` function, this function will try to parse each and every netscreen packet.\nIt will read from the file a line containing metadata of the packet:\n\nif (sscanf(line, \&quot;%9d.%9d: %15[a-z0-9/:.-](%1[io]) len=%9d:%12s-\u003e%12s/\&quot;,\n\u0026sec, \u0026dsec, cap_int, direction, \u0026pkt_len, cap_src, cap_dst) \u003c 5) {\n*err = WTAP_ERR_BAD_FILE;\n*err_info = g_strdup(\&quot;netscreen: Can&#39;t parse packet-header\&quot;);\nreturn -1;\n}\n\n\nHere we can see that we read the pkt_len, this will be important later on.\n\nThen we are going to enlarge the packet buffer to the pkt_len:\n\nws_buffer_assure_space(buf, pkt_len);\npd = ws_buffer_start_ptr(buf);\n\nThen we are having a loop that will read each line of a packet data until the end of the packet, and each iteration we are going to call to the `parse_single_hex_dump_line`:\n\nn = parse_single_hex_dump_line(p, pd, offset);\n\n\nThen in the function of `parse_single_hex_dump_line`, we are going to try to extract 16 hex dumped bytes and insert them into the buffer.\n\n\nbuf[byte_offset + num_items_scanned] = byte;\n\n\nThe `byte_offset` is the offset from the function, and the `num_items_scanned` is an iterator from 0 - 16.\nThe vulnerability is that the parser does not have proper bound check, the function check in the end of the loop if the `offset` is not in bound of the `pkt_size`.\n\nif (offset \u003e pkt_len) {\n*err = WTAP_ERR_BAD_FILE;\n*err_info = g_strdup(\&quot;netscreen: too much hex-data\&quot;);\nreturn FALSE;\n}\n\n\nbut... the function `parse_single_hex_dump_line` will try to parse 16 bytes without checking inside it for any bounds! so what will happen if we hit the `parse_single_hex_dump_line` with the following conditions:\n`offset == 2047`\n`line == 00 11 22 33 44 55 66 77`\nWhat will happen is that we will write all the line bytes(from index 1) out bounded on the `buf` object!\n\nPOC is to set the offset to 2047 and the line to size of 16 bytes, this will trigger the overflow.\n\n```\n\n\n### Debug\n\n\n```\n\nTurn on page heap.\n\nreg.exe add \&quot;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Wireshark.exe\&quot; /v \&quot;GlobalFlag\&quot; /t REG_SZ /d \&quot;0x02000000\&quot; /f\n\nThen open pcap file with wireshark.\n\n0:000\u003e .exr -1\nExceptionAddress: 00007ffd22c76577 (libwiretap+0x0000000000026577)\n   ExceptionCode: c0000005 (Access violation)\n  ExceptionFlags: 00000000\nNumberParameters: 2\n   Parameter[0]: 0000000000000001\n   Parameter[1]: 000001ec28373000\nAttempt to write to address 000001ec28373000\n0:000\u003e k\n # Child-SP          RetAddr               Call Site\n00 000000d7`7f8f9ef8 00007ffd`22c763a2     libwiretap+0x26577\n01 000000d7`7f8f9f00 00007ffd`22c75fb8     libwiretap+0x263a2\n02 000000d7`7f8fa000 00007ffd`22c9d09f     libwiretap+0x25fb8\n03 000000d7`7f8fa100 00007ff6`5d026f01     libwiretap!wtap_read+0x4f\n04 000000d7`7f8fa150 00007ff6`5d1e0518     Wireshark+0x6f01\n05 000000d7`7f8fa710 00007ff6`5d1bb1a7     Wireshark+0x1c0518\n06 000000d7`7f8fa880 00007ff6`5d315920     Wireshark+0x19b1a7\n07 000000d7`7f8fa8e0 00007ffc`e1761da7     Wireshark+0x2f5920\n08 000000d7`7f8fa960 00007ff6`5d33f803     Qt5Core!QObject::qt_static_metacall+0x1467\n09 000000d7`7f8faab0 00007ff6`5d1a890d     Wireshark+0x31f803\n0a 000000d7`7f8faaf0 00007ffc`e1761da7     Wireshark+0x18890d\n0b 000000d7`7f8fab30 00007ffc`e246a0fb     Qt5Core!QObject::qt_static_metacall+0x1467\n0c 000000d7`7f8fac80 00007ffc`e1761da7     Qt5Widgets!QListWidget::qt_static_metacall+0x3cb\n0d 000000d7`7f8face0 00007ffc`e242b4ca     Qt5Core!QObject::qt_static_metacall+0x1467\n0e 000000d7`7f8fae30 00007ffc`e24315f6     Qt5Widgets!QAbstractItemView::activated+0x2a\n0f 000000d7`7f8fae70 00007ffc`e22379c8     Qt5Widgets!QAbstractItemView::mouseDoubleClickEvent+0x166\n10 000000d7`7f8fafb0 00007ffc`e22d8ee0     Qt5Widgets!QWidget::event+0x148\n11 000000d7`7f8fb040 00007ffc`e2438378     Qt5Widgets!QFrame::event+0x30\n12 000000d7`7f8fb070 00007ffc`e1744b5a     Qt5Widgets!QAbstractItemView::viewportEvent+0x308\n13 000000d7`7f8fb1c0 00007ffc`e221497c     Qt5Core!QCoreApplicationPrivate::sendThroughObjectEventFilters+0xda\n14 000000d7`7f8fb220 00007ffc`e22128b0     Qt5Widgets!QApplicationPrivate::notify_helper+0xfc\n15 000000d7`7f8fb250 00007ffc`e1742aca     Qt5Widgets!QApplication::notify+0x750\n16 000000d7`7f8fb790 00007ffc`e2215b95     Qt5Core!QCoreApplication::notifyInternal2+0xba\n17 000000d7`7f8fb800 00007ffc`e226040a     Qt5Widgets!QApplicationPrivate::sendMouseEvent+0x3c5\n18 000000d7`7f8fb8c0 00007ffc`e225e38e     Qt5Widgets!QSizePolicy::QSizePolicy+0x2d3a\n19 000000d7`7f8fbc50 00007ffc`e2214990     Qt5Widgets!QSizePolicy::QSizePolicy+0xcbe\n1a 000000d7`7f8fbd20 00007ffc`e2213a13     Qt5Widgets!QApplicationPrivate::notify_helper+0x110\n1b 000000d7`7f8fbd50 00007ffc`e1742aca     Qt5Widgets!QApplication::notify+0x18b3\n1c 000000d7`7f8fc290 00007ffc`e1b83896     Qt5Core!QCoreApplication::notifyInternal2+0xba\n1d 000000d7`7f8fc300 00007ffc`e1b6ecb0     Qt5Gui!QGuiApplicationPrivate::processMouseEvent+0xf16\n1e 000000d7`7f8fc7b0 00007ffc`e178ba5a     Qt5Gui!QWindowSystemInterface::sendWindowSystemEvents+0x90\n1f 000000d7`7f8fc7e0 00007ffc`e0c32dd9     Qt5Core!QEventDispatcherWin32::processEvents+0x6a\n20 000000d7`7f8ff910 00007ffc`e173ef2c     qwindows!qt_plugin_query_metadata+0x1f99\n21 000000d7`7f8ff940 00007ffc`e1741a94     Qt5Core!QEventLoop::exec+0x1bc\n22 000000d7`7f8ff9a0 00007ff6`5d103c0f     Qt5Core!QCoreApplication::exec+0x154\n23 000000d7`7f8ffa00 00007ff6`5d3877c7     Wireshark+0xe3c0f\n24 000000d7`7f8ffbf0 00007ff6`5d381276     Wireshark+0x3677c7\n25 000000d7`7f8ffc80 00007ffd`ae2e257d     Wireshark+0x361276\n26 000000d7`7f8ffcc0 00007ffd`af32aa68     KERNEL32!BaseThreadInitThunk+0x1d\n27 000000d7`7f8ffcf0 00000000`00000000     ntdll!RtlUserThreadStart+0x28\n\n\n```\n\n\n-- CREDIT ---------------------------------------\nThis vulnerability was discovered by:\nAnonymous working with Trend Micro Zero Day Initiative\n\n-- FURTHER DETAILS ------------------------------\n\nSupporting files:\n\n\nIf supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number.\n\nPlease confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 120 days of the reported date. If you are ready to release a patch at any point leading up to the deadline, please coordinate with us so that we may release our advisory detailing the issue. If the 120-day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations, so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time:\n\nZero Day Initiative\nzdi-disclosures@trendmicro.com\n\nThe PGP key used for all ZDI vendor communications is available from:\n\n  http://www.zerodayinitiative.com/documents/disclosures-pgp-key.asc\n\n-- INFORMATION ABOUT THE ZDI --------------------\nEstablished by TippingPoint and acquired by Trend Micro, the Zero Day Initiative (ZDI) neither re-sells vulnerability details nor exploit code. Instead, upon notifying the affected product vendor, the ZDI provides its Trend Micro TippingPoint customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available.\n\nPlease contact us for further details or refer to:\n\n  http://www.zerodayinitiative.com\n\n-- DISCLOSURE POLICY ----------------------------\n\nOur vulnerability disclosure policy is available online at:\n\n  http://www.zerodayinitiative.com/advisories/disclosure_policy/&quot;,&quot;title&quot;:&quot;NetScreen File Parsing Heap-based Buffer Overflow&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:860017,&quot;created_at&quot;:&quot;2023-10-17T18:36:44Z&quot;,&quot;updated_at&quot;:&quot;2023-11-16T16:41:36Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[{&quot;id&quot;:16040090,&quot;title&quot;:&quot;crash&quot;,&quot;color&quot;:&quot;#CC0033&quot;,&quot;description&quot;:&quot;Crash or hang in a Wireshark executable&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-08-24T00:08:45.509Z&quot;,&quot;updated_at&quot;:&quot;2020-08-24T00:08:45.509Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:7898047,&quot;template&quot;:false},{&quot;id&quot;:16040056,&quot;title&quot;:&quot;lib::wiretap&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;The library that reads and writes different capture file formats (libwiretap).&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-08-24T00:08:32.300Z&quot;,&quot;updated_at&quot;:&quot;2020-08-24T00:08:32.300Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:7898047,&quot;template&quot;:false}],&quot;lock_version&quot;:0,&quot;author_id&quot;:860017,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[],&quot;due_date&quot;:null,&quot;project_id&quot;:7898047,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/wireshark/wireshark/-/issues/19404&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/wireshark/wireshark/notes?target_id=136581826\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/wireshark/wireshark/-/preview_markdown?target_id=19404\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:136581826,&quot;projectId&quot;:7898047,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/wireshark/wireshark/-/issues/19404/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/wireshark/wireshark/-/issues/19404.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/wireshark/wireshark/-/issues/19404.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/wireshark/wireshark/noteable/issue/136581826/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736562945000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/wireshark/wireshark/-/issues/19404.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="wireshark" data-issue-id="136581826" data-issue-iid="19404" data-project-path="wireshark/wireshark"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="19404" data-issuable-type="issue" data-labels-fetch-path="/wireshark/wireshark/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/wireshark/wireshark/-/labels" data-project-issues-path="/wireshark/wireshark/-/issues" data-project-path="wireshark/wireshark" data-selected-labels="[{&quot;id&quot;:16040090,&quot;title&quot;:&quot;crash&quot;,&quot;color&quot;:&quot;#CC0033&quot;,&quot;description&quot;:&quot;Crash or hang in a Wireshark executable&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-08-24T00:08:45.509Z&quot;,&quot;updated_at&quot;:&quot;2020-08-24T00:08:45.509Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:7898047,&quot;template&quot;:false},{&quot;id&quot;:16040056,&quot;title&quot;:&quot;lib::wiretap&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;The library that reads and writes different capture file formats (libwiretap).&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-08-24T00:08:32.300Z&quot;,&quot;updated_at&quot;:&quot;2020-08-24T00:08:32.300Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:7898047,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="19404" data-project-path="wireshark/wireshark"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="wireshark" data-issue-id="136581826" data-issue-iid="19404" data-project-path="wireshark/wireshark"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="19404" data-project-path="wireshark/wireshark"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="wireshark/wireshark" data-iid="19404" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/wireshark/wireshark/-/issues/19404.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/wireshark/wireshark/-/issues/19404/toggle_subscription","moveIssueEndpoint":"/wireshark/wireshark/-/issues/19404/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=7898047","editable":"","currentUser":{},"rootPath":"/","fullPath":"wireshark/wireshark","iid":19404,"id":136581826,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="06OCyi5KZtoc34XwxxYR+Q==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="06OCyi5KZtoc34XwxxYR+Q==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

