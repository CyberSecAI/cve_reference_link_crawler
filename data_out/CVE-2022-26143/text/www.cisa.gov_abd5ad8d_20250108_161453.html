
[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Election Threat Updates](/topics/election-security/election-threat-updates)[#protect2024](/protect2024)[Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Culture](/about/culture)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Election Threat Updates](/topics/election-security/election-threat-updates)[#protect2024](/protect2024)[Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [Alert](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A93)

Share:

Alert
# UDP-Based Amplification Attacks

Last RevisedDecember 18, 2019
Alert CodeTA14-017A

### Systems Affected

Certain application-layer protocols that rely on the User Datagram Protocol (UDP) have been identified as potential attack vectors. These include

* Domain Name System (DNS),
* Network Time Protocol (NTP),
* Connection-less Lightweight Directory Access Protocol (CLDAP),
* Character Generator Protocol (CharGEN),
* Simple Service Discovery Protocol (SSDP),
* BitTorrent,
* Simple Network Management Protocol version 2 (SNMPv2),
* Kad,
* Portmap/Remote Procedure Call (RPC),
* Quote of the Day (QOTD),
* Multicast Domain Name System (mDNS),
* Network Basic Input/Output System (NetBIOS),
* Quake Network Protocol,
* Steam Protocol,
* Routing Information Protocol version 1 (RIPv1),
* Lightweight Directory Access Protocol (LDAP),
* Trivial File Transfer Protocol (TFTP), and
* Memcached,
* and Web Services Dynamic Discovery (WS-Discovery).

### Overview

A distributed reflective denial-of-service (DRDoS) is a form of distributed denial-of-service (DDoS) attack that relies on publicly accessible UDP servers and bandwidth amplification factors (BAFs) to overwhelm a victim’s system with UDP traffic.

By design, UDP is a connection-less protocol that does not validate source Internet Protocol (IP) addresses. Unless the application-layer protocol uses countermeasures such as session initiation in Voice over Internet Protocol, an attacker can easily forge the IP packet datagram (a basic transfer unit associated with a packet-switched network) to include an arbitrary source IP address. [[1](https://tools.ietf.org/html/rfc3261)] When many UDP packets have their source IP address forged to the victim IP address, the destination server (or amplifier) responds to the victim (instead of the attacker), creating a reflected denial-of-service (DoS) attack.

Certain commands to UDP protocols elicit responses that are much larger than the initial request. Previously, attackers were limited by the linear number of packets directly sent to the target to conduct a DoS attack; now a single packet can generate between 10 and 100 times the original bandwidth. This is called an amplification attack, and when combined with a reflective DoS attack on a large scale, using multiple amplifiers and targeting a single victim, DDoS attacks can be conducted with relative ease.

The potential effect of an amplification attack can be measured by BAF, which can be calculated as the number of UDP payload bytes that an amplifier sends to answer a request, compared to the number of UDP payload bytes of the request. [[2](http://www.christian-rossow.de/articles/Amplification_DDoS.php)] [[3](http://www.christian-rossow.de/publications/amplification-ndss2014.pdf)]

The following is a list of known protocols and their associated BAFs. CISA offers thanks to Christian Rossow for providing this information. For more information on BAFs, please see Christian's [blog](http://www.christian-rossow.de/articles/Amplification_DDoS.php) and associated [research paper](http://www.christian-rossow.de/publications/amplification-ndss2014.pdf).

| **Protocol** | **Bandwidth Amplification Factor** | **Vulnerable Command** |
| --- | --- | --- |
| DNS | 28 to 54 | see: [TA13-088A](/ncas/alerts/TA13-088A) [[4](/ncas/alerts/TA13-088A)] |
| NTP | 556.9 | see: [TA14-013A](/ncas/alerts/TA14-013A) [[5](/ncas/alerts/TA14-013A)] |
| SNMPv2 | 6.3 | GetBulk request |
| NetBIOS | 3.8 | Name resolution |
| SSDP | 30.8 | SEARCH request |
| CharGEN | 358.8 | Character generation request |
| QOTD | 140.3 | Quote request |
| BitTorrent | 3.8 | File search |
| Kad | 16.3 | Peer list exchange |
| Quake Network Protocol | 63.9 | Server info exchange |
| Steam Protocol | 5.5 | Server info exchange |
| Multicast DNS (mDNS) | 2 to 10 | Unicast query |
| RIPv1 | 131.24 | Malformed request |
| Portmap (RPCbind) | 7 to 28 | Malformed request |
| LDAP | 46 to 55 | [Malformed request](https://ldapscan.shadowserver.org) [[6](https://ldapscan.shadowserver.org/)] |
| CLDAP [[7](https://www.akamai.com/us/en/about/our-thinking/threat-advisories/connection-less-lightweight-directory-access-protocol-reflection-ddos-threat-advisory.jsp)] | 56 to 70 | — |
| TFTP [[23](https://www.researchgate.net/publication/284077229_TFTP_DDoS_amplification_attack)] | 60 | — |
| Memcached [[25](https://memcachedscan.shadowserver.org/)] | 10,000 to 51,000 | — |
| WS-Discovery | 10 to 500 | — |

In March 2015, the CERT Coordination Center of the Software Engineering Institute issued Vulnerability Note VU#550620 describing the use of mDNS in DRDoS attacks. Attackers can leverage mDNS by sending more information than can be handled by the device, thereby causing a DoS condition. [[8](https://www.kb.cert.org/vuls/id/550620)]

In July 2015, Akamai Technologies' Prolexic Security Engineering and Research Team (PLXsert) issued a threat advisory describing a surge in DRDoS attacks using RIPv1. Malicious actors are leveraging the behavior of RIPv1 for DDoS reflection through specially crafted request queries. [[9](http://www.stateoftheinternet.com/)]

In August 2015, Level 3 Threat Research Labs reported a new form of DRDoS attack that uses portmap. Attackers are leveraging the behavior of the portmap service through spoofed requests to flood a victim’s network with UDP traffic. [[10](http://blog.level3.com/security/a-new-ddos-reflection-attack-portmapper-an-early-warning-to-the-industry/)]

In October 2016, Corero Network Security reported a new DDoS amplification attack exploiting LDAP directory services servers against its customers. [[11](https://www.corero.com/company/newsroom/press-releases/corero-warns-of-powerful-new-ddos-attack-vector-with-potential-for-terabit-scale-ddos-events/%5D)]

In November 2017, Netlab 360 reported that CLDAP is now the third most common DRDoS attack, behind DNS and NTP attacks. [[12](http://blog.netlab.360.com/cldap-is-now-the-3rd-reflection-amplified-ddos-attack-vector-surpassing-ssdp-and-chargen-en)]

In February 2018, SENKI reported an increase in Memcached-based reflection DDoS attacks (via UDP/TCP port 11211) with an unprecedented amplification factor. [[24](http://www.senki.org/memcached-on-port-11211-udp-tcp-being-exploited/)]

In September 2019, Akamai reported DDoS attacks exploiting WS-Discovery protocol (via TCP/UDP port 3702. [[26](https://blogs.akamai.com/sitr/2019/09/new-ddos-vector-observed-in-the-wild-wsd-attacks-hitting-35gbps.html/)]

### Impact

Attackers can use the bandwidth and relative trust of large servers that provide the UDP protocols provided in this alert to flood victims with unwanted traffic and create a DDoS attack.

### Solution

#### Detection

Detection of DRDoS attacks is not easy because of their use of large, trusted servers that provide UDP services. Network operators of these exploitable services may apply traditional DoS mitigation techniques. To detect a DRDoS attack, watch out for abnormally large responses to a particular IP address, which may indicate that an attacker is using the service.

There are a few things victims of DRDoS attacks can do to detect such activity and respond:

1. Detect and alert large UDP packets to higher order ports.
2. Detect and alert on any non-stateful UDP packets. (A simple Snort example is below. The approach will need to be customized to each environment with a whitelist and known services.)
   Simple Snort rule example for stateless UDP check
   var HOME\_NET [10.10.10.20]

   preprocessor stream5\_global: track\_ip yes, track\_tcp yes,track\_udp yes,track\_icmp no,max\_tcp 262144, max\_udp 131072

   preprocessor stream5\_ip: timeout 180

   preprocessor stream5\_tcp: policy first, use\_static\_footprint\_sizes

   preprocessor stream5\_udp: timeout 180, ignore\_any\_rules

   alert udp HOME\_NET 1024: -> any any (msg:"UDP Session start"; flowbits:set,logged\_in; flowbits:noalert; sid: 1001;)

   alert udp any any -> HOME\_NET 1024: (msg:"UDP Stateless"; flowbits:isnotset,logged\_in; sid: 1002)
3. Upstream providers should maintain updated contacts and methods with downstream customers to send alerts by network.

In general, network and server administrators for internet service providers (ISPs) should use the following best practices to avoid becoming amplifier nodes:

1. Use network flow to detect spoofed packets. (See the Mitigation section below for information on verifying spoofed traffic before blocking that traffic.)
2. Use network flow or other summarized network data to monitor for an unusual number of requests to at-risk UDP services.
3. Use network flow to detect service anomalies (e.g., bytes-per-packet and packets-per-second anomalies).

#### Mitigation

The following steps can help mitigate a DRDoS attack:

1. Use stateful UDP inspections—such as reflexive access control lists—to reduce the impact to critical services on border firewalls or border routers. [[13](https://www.cisco.com/c/en/us/td/docs/ios/12_2/security/configuration/guide/fsecur_c/scfreflx.html)]
2. Use a Border Gateway Protocol (BGP) to create a Remotely Triggered Blackhole, preferably in coordination with upstream providers or ISPs. [[14](http://packetlife.net/blog/2009/jul/6/remotely-triggered-black-hole-rtbh-routing/)]
3. Maintain a list of primary upstream provider emergency contacts to coordinate responses to attacks. Upstream providers should conduct mitigation in coordination with downstream customers.

In general, ISP network and server administrators should use the following best practices to avoid becoming amplifier nodes:

1. Regularly update software and configurations to deny or limit abuse (e.g., DNS response rate limit). [[15](https://kb.isc.org/article/AA-01000/0/A-Quick-Introduction-to-Response-Rate-Limiting.html)] [[16](https://tools.ietf.org/html/bcp38)] [[17](https://tools.ietf.org/html/bcp84)]
2. Disable and remove unwanted services, or deny access to local services over the internet.
3. Use UDP-based protocols—e.g., quality of service (QoS) on switching and routing devices—to enable network-based rate-limiting to legitimate services provided over the internet.
4. Work with Customer Provider Edge manufacturers for secure configuration and software. [[18](https://resources.sei.cmu.edu/asset_files/WhitePaper/2014_019_001_312679.pdf)]

As a service provider, to avoid any misuse of internet resources:

1. Use ingress filtering to block spoofed packets (See the Spoofer Project [[19](https://spoofer.caida.org/)], and IETF BCP 38 and BCP 84 guidelines). [[20](https://resources.sei.cmu.edu/asset_files/WhitePaper/2014_019_001_312679.pdf)]
2. Use traffic shaping on UDP service requests to ensure repeated access to over-the-Internet resources is not abusive. [[21](https://tools.ietf.org/html/rfc2475)] [[22](https://tools.ietf.org/html/rfc3260)]

### References

[[1] SIP: Session Initiation Protocol](https://tools.ietf.org/html/rfc3261)
[[2] Amplification Hell: Abusing Network Protocols for DDoS](http://www.christian-rossow.de/articles/Amplification_DDoS.php)
[[3] Ampliﬁcation Hell: Revisiting Network Protocols for DDoS Abuse](http://www.christian-rossow.de/publications/amplification-ndss2014.pdf)
[[4] DNS Amplification Attacks](https://www.us-cert.gov/ncas/alerts/TA13-088A)
[[5] NTP Amplification Attacks Using CVE-2013-5211](https://www.us-cert.gov/ncas/alerts/TA14-013A)
[[6] Open LDAP Scanning Project](https://ldapscan.shadowserver.org)
[[7] CLDAP Reflection DDoS](https://www.akamai.com/us/en/about/our-thinking/threat-advisories/connection-less-lightweight-directory-access-protocol-reflection-ddos-threat-advisory.jsp)
[[8] VU#550620: Multicast DNS (mDNS) implementations may respond to unicast queries originating outside the local link](https://www.kb.cert.org/vuls/id/550620)
[[9] RIPv1 Reflection DDoS [Medium Risk]](https://www.akamai.com/us/en/multimedia/documents/state-of-the-internet/ripv1-reflection-ddos-threat-advisory.pdf)
[[10] A New DDoS Reflection Attack: Portmapper; An Early Warning to the Industry](http://blog.level3.com/security/a-new-ddos-reflection-attack-portmapper-an-early-warning-to-the-industry)
[[11] Corero Warns of Powerful New DDoS Attack Vector](https://www.corero.com/company/newsroom/press-releases/corero-warns-of-powerful-new-ddos-attack-vector-with-potential-for-terabit-scale-ddos-events)
[[12] CLDAP is Now the No.3 Reflection Amplified DDoS Attack Vector, Surpassing SSDP and CharGen](http://blog.netlab.360.com/cldap-is-now-the-3rd-reflection-amplified-ddos-attack-vector-surpassing-ssdp-and-chargen-en)
[[13] Configuring IP Session Filtering (Reflexive Access Lists)](https://www.cisco.com/c/en/us/td/docs/ios/12_2/security/configuration/guide/fsecur_c/scfreflx.html)
[[14] Remotely-Triggered Black Hole (RTBH) Routing](http://packetlife.net/blog/2009/jul/6/remotely-triggered-black-hole-rtbh-routing)
[[15] A Quick Introduction to Response Rate Limiting](https://kb.isc.org/article/AA-01000/0/A-Quick-Introduction-to-Response-Rate-Limiting.html)
[[16] Network Ingress Filtering: Defeating Denial of Service Attacks Which Employ IP Source Address Spoofing](https://tools.ietf.org/html/bcp38)
[[17] Ingress Filtering for Multihomed Networks](https://tools.ietf.org/html/bcp84)
[[18] Abuse of Customer Premise Equipment and Recommended Actions](https://resources.sei.cmu.edu/asset_files/WhitePaper/2014_019_001_312679.pdf)
[[19] The Spoofer Project](https://spoofer.caida.org)
[[20] Abuse of Customer Premise Equipment and Recommended Actions](https://resources.sei.cmu.edu/asset_files/WhitePaper/2014_019_001_312679.pdf)
[[21] An Architecture for Differentiated Services](https://tools.ietf.org/html/rfc2475)
[[22] New Terminology and Clarifications for Diffserv](https://tools.ietf.org/html/rfc3260)
[[23] TFTP DDoS Amplification Attack](https://www.researchgate.net/publication/284077229_TFTP_DDoS_amplification_attack)
[[24] Memcached on Port 11211 UDP & TCP Being Exploited](http://www.senki.org/memcached-on-port-11211-udp-tcp-being-exploited)
[[25] Open Memcached Key-Value Store Scanning Project](https://memcachedscan.shadowserver.org)
[[26] New DDoS Vector Observed in the Wild: WSD attacks hitting 35/Gbps](https://blogs.akamai.com/sitr/2019/09/new-ddos-vector-observed-in-the-wild-wsd-attacks-hitting-35gbps.html)
### Revisions

February 9, 2014 – Initial Release|March 7, 2014 – Updated page to include research links|July 13, 2015 – Added RIPv1 as an attack vector|August 19, 2015 – Added Multicast DNS (mDNS) and Portmap (RPCbind) as attack vectors|April 13, 2016 – Updated detection and mitigation information|November 4, 2016 – Updated for LDAP attack vector|December 4, 2017 – Added information on CLDAP as an attack vector|December 6, 2017 – Added information on TFTP as an attack vector|February 27, 2018 – Added information on Memcached as an attack vector|March 2, 2018 – Updated information on Memcached as an attack vector|December 18, 2019 – Added information on WS-Discovery as an attack vector

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/alerts/2014/01/17/udp-based-amplification-attacks); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [Equal Opportunity & Accessibility](/oedia "Equal Opportunity & Accessibility")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")

