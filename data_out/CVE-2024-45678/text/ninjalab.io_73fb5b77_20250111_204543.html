

[NinjaLab](https://ninjalab.io "NinjaLab")

* [Home](https://ninjalab.io)
* [News](https://ninjalab.io/news/)
* [About](https://ninjalab.io/about)
* [Offer](https://ninjalab.io/offer)
* [Research](https://ninjalab.io/research)
* [Team](https://ninjalab.io/team)
* [Careers](https://ninjalab.io/careers/)
* [Contact](https://ninjalab.io#contact-us)

* [Home](https://ninjalab.io)
* [News](https://ninjalab.io/news/)
* [About](https://ninjalab.io/about)
* [Offer](https://ninjalab.io/offer)
* [Research](https://ninjalab.io/research)
* [Team](https://ninjalab.io/team)
* [Careers](https://ninjalab.io/careers/)
* [Contact](https://ninjalab.io#contact-us)

# EUCLEAK

### [Download the Writeup](https://ninjalab.io/wp-content/uploads/2024/10/20241022_eucleak.pdf)

*Illustration [Romain Flamand](https://www.artstation.com/dka) – Flamingo Studio – flamandromain@gmail.com*

### Abstract

Secure elements are small microcontrollers whose main purpose is to generate/store secrets and then execute cryptographic operations. They undergo the highest level of security evaluations that exists (Common Criteria) and are often considered inviolable, even in the worst-case attack scenarios. Hence, complex secure systems build their security upon them.

FIDO hardware tokens are strong authentication factors to sign in to applications (any web service supporting FIDO); they often embed a secure element and the FIDO protocol uses Elliptic Curve Digital Signature Algorithm (ECDSA for short) as its core cryptographic primitive. YubiKey 5 Series are certainly the most widespread FIDO hardware tokens, their secure element is an Infineon SLE78.

This document shows how – finding a JavaCard open platform (the Feitian A22) based on a similar Infineon SLE78 – we understood the Infineon ECDSA implementation, found a side-channel vulnerability and designed a practical side-channel attack. The attack is then demonstrated on a YubiKey 5Ci. Finally, we show that the vulnerability extends to the more recent Infineon Optiga Trust M and Infineon Optiga TPM security microcontrollers.

Our work unearths a side-channel vulnerability in the cryptographic library of Infineon Technologies, one of the biggest secure element manufacturers. This vulnerability – that went unnoticed for 14 years and about 80 highest-level Common Criteria certification evaluations – is due to a non constant-time modular inversion.

**The attack requires physical access to the secure element** (few local electromagnetic side-channel acquisitions, i.e. few minutes, are enough) **in order to extract the ECDSA secret key.** In the case of the FIDO protocol, this allows to create a clone of the FIDO device.

**All YubiKey 5 Series (with firmware version below 5.7) are impacted by the attack and in fact all Infineon security microcontrollers (including TPMs) that run the Infineon cryptographic library (as far as we know, any existing version) are vulnerable to the attack.** These security microcontrollers are present in a vast variety of secure systems – often relying on ECDSA – like electronic passports and crypto-currency hardware wallets but also smart cars or homes. However, we did not check (yet) that the EUCLEAK attack applies to any of these products.

### Cautionary Note

Authentication tokens (like FIDO hardware devices) primary goal is
to fight the scourge of phishing attacks. The EUCLEAK attack requires physical access to
the device, expensive equipment, custom software and technical skills. **Thus, as far as the work presented here goes, it is still safer to use your YubiKey or other impacted products as FIDO hardware authentication token to sign in to applications rather than not using one.**

### Discovered By

 Thomas Roche (NinjaLab)

### List of Impacted Products

* All Infineon security microcontrollers embedding Infineon cryptographic library (any existing version). For instance, all existing versions of Infineon TPMs are affected.

* All YubiKey 5 Series (with firmware version below 5.7)

### Further Notes

1. The impacted Feitian A22 Javacard used in this work is an old product no more available for sale. All Feitian products currently available on their webstore (and based on an Infineon security microcontroller) use Feitian own cryptographic library, and are not impacted by our work to our knowledge.

2. The new YubiKey firmware 5.7 update (May 6th, 2024) switches the YubiKeys from Infineon cryptographic library to Yubico new cryptographic library. To our knowledge, this new cryptographic library is not impacted by our work.

3. Infineon has already a patch for their cryptographic library, to our knowledge it did not yet pass a Common Criteria certification evaluation.

### CVE

Our CVE request was rejected.

Instead, MITRE went with [CVE-2024-45678](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-45678).

Our request for a description update is pending.

### Official Statements From Stakeholders

* 3rd Sept. 2024 – [Yubico Security Advisory](https://www.yubico.com/support/security-advisories/ysa-2024-03/)
* 9th Sept. 2024 – BSI Press Release [(German)](https://www.bsi.bund.de/DE/Service-Navi/Presse/Alle-Meldungen-News/Meldungen/EUCLEAK_Seitenkanalangriff_240909.html) / [(Google Translated Version)](https://translate.google.com/translate?js=n&sl=auto&tl=english&u=https://www.bsi.bund.de/DE/Service-Navi/Presse/Alle-Meldungen-News/Meldungen/EUCLEAK_Seitenkanalangriff_240909.html)

### Press Coverage

* [Ars Technica](https://arstechnica.com/security/2024/09/yubikeys-are-vulnerable-to-cloning-attacks-thanks-to-newly-discovered-side-channel/)
* [Lawrence Systems](https://www.youtube.com/watch?v=jHbyxG6Cc74)
* [Cyber Security News](https://cybersecuritynews.com/yubikeys-clone-device-secret-key/)
* [BleepingComputer](https://www.bleepingcomputer.com/news/security/new-eucleak-attack-lets-threat-actors-clone-yubikey-fido-keys/)
* [Coinspect](https://www.coinspect.com/blog/hardware-wallet-security/)
* [Wirecutter (NYTimes)](https://www.nytimes.com/wirecutter/reviews/best-security-keys/)

##### Site map

* [About us](https://ninjalab.io/about/)
* [Careers](https://ninjalab.io/careers/)
* [Home](https://ninjalab.io/)
* [News](https://ninjalab.io/news/)
* [Our Offer](https://ninjalab.io/offer/)
* [Research](https://ninjalab.io/research/)
* [The Team](https://ninjalab.io/team/)

Theme: [Illdy](http://colorlib.com/wp/themes/illdy "Illdy").
© Copyright 2024 NinjaLab. All Rights Reserved.

