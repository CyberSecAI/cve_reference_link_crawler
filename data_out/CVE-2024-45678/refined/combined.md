=== Content from www.yubico.com_258675ec_20250111_204549.html ===


[Skip to content](#wp--skip-link--target)
EnglishFrançaisDeutsch日本語EspañolSvenska

* [Contact Sales](/contact-us/)
* [Resellers](/support/resellers/)
* [Support](https://support.yubico.com/hc/en-us/)

menu![X icon](https://www.yubico.com/wp-content/themes/yubicool/img/icons/close.svg)[![Yubico Header Text Logo](https://www.yubico.com/wp-content/themes/yubicool/img/logos/logo.svg)](https://www.yubico.com)
Why Yubicoexpand\_more
[Why Yubico](https://www.yubico.com/why-yubico/)
How we help

* [Enterprises](https://www.yubico.com/why-yubico/for-business/)
* [SMBs](https://www.yubico.com/why-yubico/yubico-and-smbs/)
* [Individuals](https://www.yubico.com/why-yubico/for-individuals/)
* [Developers](https://www.yubico.com/why-yubico/for-developers/)

Work with us

* [Careers](https://www.yubico.com/careers/)
* [Partner programs](https://www.yubico.com/why-yubico/partners/)

Connect & learn

* [Contact Sales](https://www.yubico.com/contact-us/)
* [Events](https://www.yubico.com/events/)
* [Press room](https://www.yubico.com/press/)
* [About us](/why-yubico/about-us/)
* [The team](/why-yubico/team/)
* [Investors](https://investors.yubico.com/)
* [Innovation history](https://www.yubico.com/why-yubico/yubico-innovation-history/)
* [Secure it Forward](https://www.yubico.com/why-yubico/secure-it-forward/)

![](https://www.yubico.com/wp-content/uploads/2023/03/WhyY-nav-easy-to-use-1.jpg)Easy-to-use, secure authenticationWith YubiKey there’s no tradeoff between great security and usabilityWhy YubiKeysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/WhyY-nav-google-1.jpg)Proven at scale at GoogleGoogle defends against account takeovers and reduces IT costsGoogle Case Studysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-passwordless-nav-5-1.jpg)Protecting vulnerable organizationsSecure it Forward: Yubico matches up to 5% of the number of YubiKeys purchased on Yubico.comSecure it Forwardsecurity-advisory
Productsexpand\_more
[All products](/products/)
Hardware

* [YubiKey 5 Series](https://www.yubico.com/products/yubikey-5-overview/)
* [YubiKey 5 FIPS Series](https://www.yubico.com/products/yubikey-fips/)
* [YubiKey Bio Series](https://www.yubico.com/products/yubikey-bio-series/)
* [Security Key Series](/products/security-key/)
* [YubiHSM 2 & YubiHSM 2 FIPS](https://www.yubico.com/products/hardware-security-module/)

Services

* [YubiKey as a Service](https://www.yubico.com/products/yubikey-as-a-service/)
* [YubiEnterprise Delivery](https://www.yubico.com/products/yubienterprise-delivery/)
* [Yubico Enrollment Suite](https://www.yubico.com/products/yubicoenrollmentsuite/)
* [YubiCloud](https://www.yubico.com/products/yubicloud/)

Software and tools

* [Yubico Authenticator](https://www.yubico.com/products/yubico-authenticator/)
* [Computer login tools](https://www.yubico.com/products/computer-login-tools/)
* [Software Development Toolkits](https://www.yubico.com/products/software-development-toolkits-sdks/)

Discover the YubiKey

* [Using YubiKey is easy](https://www.yubico.com/products/ease-of-use/)
* [Find the right YubiKey](/quiz/)
* [Works with YubiKey](/works-with-yubikey/catalog/)
* [Compare YubiKeys](https://www.yubico.com/store/compare/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-hundreds-services-nav-3-1.jpg)One key for hundreds of apps and servicesYubiKey works out-of-the-box and has no client software or batteryYubico protects yousecurity-advisory
![See YubiKeys as a Service](https://www.yubico.com/wp-content/uploads/2023/03/img-YubiEnterprise-nav-3-1.jpg)YubiKey as a Service delivers scale and savingsGain a future-proofed solution and faster MFA rolloutsYubiKey as a Servicesecurity-advisory
Solutionsexpand\_more
[Solutions overview](/solutions/)
Initiatives

* [Zero Trust](https://www.yubico.com/solutions/zero-trust/)
* [Executive Order OMB M-22-09](https://www.yubico.com/solutions/executive-order-hub/)
* [Phishing-resistant MFA](https://www.yubico.com/solutions/multi-factor-authentication/)
* [Passwordless](https://www.yubico.com/solutions/passwordless/)
* [Compliance](https://www.yubico.com/solutions/cybersecurity-compliance/)
* [Cyber Insurance](https://www.yubico.com/solutions/cyber-insurance/)
* [Critical infrastructure](https://www.yubico.com/solutions/critical-infrastructure-security/)
* [Secure supply chain](/solutions/supply-chain-security/)
* [Protect call centers](https://www.yubico.com/solutions/call-centers/)

Use cases

* [Hybrid & remote workers](/solutions/secure-hybrid-and-remote-workers/)
* [Secure privileged users](https://www.yubico.com/solutions/privileged-users/)
* [Mobile restricted environments](https://www.yubico.com/solutions/mobile-restricted-environment/)
* [Shared workstations](https://www.yubico.com/solutions/shared-workstations/)

Technologies

* [Microsoft ecosystem](https://www.yubico.com/solutions/microsoft-365-mfa/)
* [Salesforce workspace](https://www.yubico.com/solutions/yubico-and-salesforce/)
* [IAM solutions](https://www.yubico.com/solutions/identity-access-management/)
* [AWS environment](https://www.yubico.com/solutions/yubico-and-amazon-web-services/)
* [HYPR experience](https://www.yubico.com/solutions/hypr-and-yubico/)
* [Okta identity solutions](https://www.yubico.com/solutions/okta-and-yubico/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-passwordless-nav-5-1.jpg)The Bridge to PasswordlessBegin the journey to make your organization passwordless Get the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-zero-trust-nav-3.jpg)Accelerate your Zero Trust Strategy7 best authentication practices to jumpstart your Zero Trust programGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-federal-nav-3.jpg)Federal cybersecurity requirements Guidance for leaders to prepare for the modern cyber threat eraGet the white papersecurity-advisory
Industriesexpand\_more
[Industries overview](https://www.yubico.com/industries/)
Industries

* [High tech](https://www.yubico.com/industries/technology/)
* [Federal government](https://www.yubico.com/industries/federal/)
* [Department of Defense](https://www.yubico.com/industries/us-department-of-defense/)
* [Federal systems integrators](https://www.yubico.com/industries/federal-systems-integrators/)
* [State & local government](https://www.yubico.com/industries/state-local-government/)
* [Education](https://www.yubico.com/industries/education/)
* [Financial services](https://www.yubico.com/industries/finance/)

* [Retail & hospitality](https://www.yubico.com/industries/retail-and-hospitality/)
* [Telecommunications](/industries/telecommunications/)
* [Healthcare](https://www.yubico.com/industries/healthcare/)
* [Pharmaceuticals](https://www.yubico.com/industries/pharmaceuticals/)
* [Cryptocurrency](https://www.yubico.com/industries/cryptocurrency/)
* [Energy & natural resources](https://www.yubico.com/industries/energy-and-natural-resources/)
* [Manufacturing](https://www.yubico.com/industries/manufacturing/)
* [Elections & campaigns](https://www.yubico.com/industries/political-campaigns/)
* [Insurance organizations](https://www.yubico.com/industries/phishing-resistant-mfa-and-passwordless-for-insurance-organizations/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-mfg-nav.jpg)Manufacturing and supply chain security Authentication best practices for manufacturingGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-phishing-nav.jpg)Phishing-resistant MFA: Fact vs. FictionMeet requirements for phishing-resistant MFA in OMB M-22-09 guidelinesGet the white papersecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-nat-resources-nav.jpg)Secure energy and natural resources from cyber threats Best practices for phishing-resistant MFA to protect infrastructureGet the white papersecurity-advisory
Resourcesexpand\_more
[All resources](/resources/)
Learn

* [Yubico Blog](https://www.yubico.com/blog/)
* [Cybersecurity glossary](https://www.yubico.com/resources/glossary/)
* [Authentication standards](https://www.yubico.com/authentication-standards/)
* [Resource library](https://www.yubico.com/resources/library/)
* [Developer program](https://developers.yubico.com/)
* [Product briefs](https://www.yubico.com/resource_categories/product-briefs/)
* [Solution briefs](https://www.yubico.com/resource_categories/solution-briefs/)
* [Passkeys](https://www.yubico.com/passkeys/)

Best practices

* [Case studies](https://www.yubico.com/resources/reference-customers/)
* [Get a pilot started](https://www.yubico.com/resources/getting-started/)
* [White papers and reports](https://www.yubico.com/resource_categories/white-papers/)
* [Webinars](https://www.yubico.com/resource_categories/webinars/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-beyondTrust-nav.jpg)BeyondTrust: secured with a subscriptionPrivileged Access Management leader simplifies deploymentSee case studysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/04/DCT-608-Navigation-promotional-image-for-451-webinar-390x216-1.jpg)S&P Global Market Intelligence report: old habits die hardOnly 46% of orgs protect their applications with MFA. How about yours?Read the reportsecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/08/img-Ebook-nav.jpg)Considering Passkeys for your Enterprise?Learn how to avoid common passkey pitfallsVisit Passkey Hubsecurity-advisory
Supportexpand\_more
 [Support home](https://support.yubico.com/hc/en-us)
Get started

* [Find the right YubiKey](/quiz/)
* [Set up your YubiKey](/setup/)
* [Downloads](https://www.yubico.com/support/download/)
* [Product documentation](https://docs.yubico.com/)
* [Support articles](https://support.yubico.com/hc/en-us/)

Services

* [Support Services](https://www.yubico.com/support/support-services/)
* [Professional Services](https://www.yubico.com/support/yubico-for-professional-services/)
* [YubiKey as a Service](https://www.yubico.com/products/yubikey-as-a-service/)

Additional resources

* [Works with YubiKey Program](https://www.yubico.com/works-with-yubikey/catalog/?sort=popular)
* [Buying and shipping information](https://www.yubico.com/support/shipping-and-buying-information/)
* [Security advisories](https://www.yubico.com/support/security-advisories/)
* [Help center](https://support.yubico.com/hc/en-us/)

![](https://www.yubico.com/wp-content/uploads/2023/03/img-setup-nav-3.jpg)How to set up your YubiKeyFollow our guided tutorials to start protecting your servicesSet up your YubiKeysecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-find-nav-3.jpg)Find the best YubiKey for your needsTake the guided quiz and see which YubiKeys fit your needsTake the quizsecurity-advisory
![](https://www.yubico.com/wp-content/uploads/2023/03/img-accelerate-nav-3.jpg)Accelerate your YubiKey deploymentTechnical and operational guidance for your YubiKey rolloutProfessional Servicessecurity-advisory
Search![X icon](https://www.yubico.com/wp-content/themes/yubicool/img/icons/close.svg)[Subscribe](/products/yubienterprise-subscription/)[Store](/store/)

* # ******Security Advisory YSA-2024-0******3

  ## **Security Advisory YSA-2024-03 Infineon ECDSA Private Key Recovery**

  Published Date: 2024-09-03
  Tracking IDs: YSA-2024-03
  CVE: In Process
  CVSS Severity: [4.9](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:P/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N&version=3.1)

  ### Summary

  A vulnerability was discovered in Infineon’s cryptographic library, which is utilized in YubiKey 5 Series, and Security Key Series with firmware prior to 5.7.0 and YubiHSM 2 with firmware prior to 2.4.0. The severity of the issue in Yubico devices is moderate.

  An attacker could exploit this issue as part of a sophisticated and targeted attack to recover affected private keys. The attacker would need physical possession of the YubiKey, Security Key, or YubiHSM, knowledge of the accounts they want to target, and specialized equipment to perform the necessary attack. Depending on the use case, the attacker may also require additional knowledge including username, PIN, account password, or authentication key. See Affected Use Cases and Mitigations for more details.

  The moderate vulnerability primarily impacts FIDO use cases because the FIDO standard relies on the affected functionality by default. YubiKey PIV and OpenPGP applications and YubiHSM 2 usage may also be impacted depending on configuration and algorithm choices by the end user.

  As part of ongoing improvements in Yubico products and to reduce exposure to our supply chain, the dependency on Infineon’s cryptographic library has been removed in favor of Yubico’s own cryptographic library.

  For more details by use case, see Affected Use Cases below:

  ### Not Affected Products

  YubiKey 5 Series version 5.7.0 and newer

  YubiKey 5 FIPS Series 5.7 and newer (FIPS submission in process)

  YubiKey Bio Series versions 5.7.2 and newer

  Security Key Series versions 5.7.0 and newer

  YubiHSM 2 versions 2.4.0 and newer

  YubiHSM 2 FIPS versions 2.4.0 and newer

  ### Affected

  YubiKey 5 Series versions prior to 5.7

  YubiKey 5 FIPS Series prior to 5.7

  YubiKey 5 CSPN Series prior to 5.7

  YubiKey Bio Series versions prior to 5.7.2

  Security Key Series all versions prior to 5.7

  YubiHSM 2 versions prior to 2.4.0

  YubiHSM 2 FIPS versions prior to 2.4.0

  ### How To Tell If You Are Affected

  #### Identify YubiKey Version

  To identify the YubiKey, use [Yubico Authenticator](/products/yubico-authenticator/) to identify the model and version of the YubiKey. The series and model of the key will be listed in the upper left corner of the Home screen. In the following example, the YubiKey is a YubiKey 5C NFC version 5.7.0.

  ![](https://www.dev.yubico.com/wp-content/uploads/2024/05/Yubico-Authenticator-Screenshot-1.png)
  #### Identify YubiHSM 2 Version

  Using the YubiHSM SDK, connect to the YubiHSM 2 and use the get deviceinfo command with the following steps:

  $ yubihsm-connector -d

  $ yubihsm-shell

  $ yubihsm> connect

  $ yubihsm> get deviceinfo

  ### Affected Use Cases and Mitigations

  This issue is a [side-channel vulnerability](https://csrc.nist.gov/glossary/term/side_channel_attack) in the ECDSA implementation in the Infineon cryptographic library. In the YubiKey and YubiHSM, ECDSA is used for generating cryptographic signatures based on elliptic curves. ECDSA is heavily used in FIDO, however this could also impact PIV and OpenPGP use cases if ECC keys are used. YubiHSM 2 signing and attestation may also be impacted if ECC keys are used.

  A sophisticated attacker could use this vulnerability to recover ECDSA private keys. An attacker requires physical possession and the ability to observe the vulnerable operation with specialized equipment to perform this attack. In order to observe the vulnerable operation, the attacker may also require additional knowledge such as account name, account password, device PIN, or YubiHSM authentication key.

  ### YubiKey FIDO

  #### **Authentication**

  An attacker with physical possession of the YubiKey could recover FIDO credentials.

  In order to exploit this issue against credentials made with strict user verification requirements via credential protection policy userVerificationRequired, an attacker would also need to have possession of the user verification (UV) factor as well (i.e. PIN or biometric).

  In order to exploit this issue against credentials made with credential protection policy userVerificationOptionalWithCredentialIDList would require either the user verification factor (PIN or biometric) or the FIDO credentialID. The FIDO credentialID can be obtained by observing a relying party prompt for the YubiKey credential. For example, if a relying party requires username, password, and a FIDO credential, the attacker would need username and password in order to proceed far enough into the authentication workflow to discover the FIDO credentialID. However, if a relying party only requires username before prompting for a FIDO credential, then an attacker only needs the username in order to discover the FIDO credentialID.

  Organizations may consider using identity provider settings to lessen session length and require more frequent FIDO authentication. Frequent usage of the YubiKey can help identify lost or stolen YubiKeys more quickly and reduce the window of exposure for attackers in the event of a lost or stolen YubiKey.

  For more details around FIDO controls, see the related [support article](https://support.yubico.com/hc/en-us/articles/15705749884444).

  #### **Attestation**

  Attestation is built-in to the FIDO and WebAuthn protocols. This feature enables each relying party to use a cryptographically verified chain of trust from the device’s manufacturer to choose which security keys to trust. This feature is shown as allow lists and disallow lists of [AAGUIDs](https://support.yubico.com/hc/en-us/articles/360016648959-YubiKey-Hardware-FIDO2-AAGUIDs) in an identity provider that may be customizable for organizations.

  An attacker could exploit this issue to create a fraudulent YubiKey using the recovered attestation key. This would produce a valid FIDO attestation statement during the make credential resulting in a bypass of an organization’s authenticator model preference controls for affected YubiKey versions.

  Organizations relying on FIDO attestation to ensure genuine YubiKeys are in use may consider supplementing FIDO login with other credentials such as YubiOTP or RSA attestation statements from PIV or OpenPGP. For more information about FIDO attestation and detailed instructions, see the related [support article](https://support.yubico.com/hc/en-us/articles/15705749884444).

  ### YubiKey PIV and OpenPGP

  #### **Signing**

  An attacker could duplicate elliptic curve signing keys. For PIV signing keys, the attacker requires a PIN to perform and observe a signing operation. The attacker may require the PIN in the OpenPGP use case depending on the OpenPGP PIN configuration.

  Users can mitigate by using RSA or ed25519 signing keys. For more information about PIV and OpenPGP configuration options as well as detailed instructions, see the related [support article](https://support.yubico.com/hc/en-us/articles/15705749884444).

  #### **Attestation**

  YubiKeys are all made with a PIV attestation certificate and a separate OpenPGP attestation certificate. These are signed by Yubico CAs and can be used to produce a cryptographic statement that a PIV or OpenPGP key was created on the YubiKey. By default both the PIV attestation certificate and OpenPGP attestation certificate are RSA keys, if a user has replaced the key(s) with their own elliptic curve key(s), an attacker could produce a valid attestation statement for a key made outside of the YubiKey. The attacker does not require the PIN to perform and observe an attestation operation.

  Users can mitigate by using RSA attestation certificates.

  ### YubiHSM

  For all YubiHSM cases, the attacker would also require an authentication key that has the appropriate capabilities to perform signing actions with the affected elliptic curve key.

  There are authentication methods available on the YubiHSM 2. One is using a password and the other is using [YubiHSM Auth](https://docs.yubico.com/hardware/yubihsm-2/hsm-2-user-guide/hsm2-sdk-tools-libraries.html#yubihsm-auth) which stores an authentication key in a YubiKey. Authenticating to a YubiHSM with either method does not rely on ECDSA and is unaffected by this issue.

  For more information about HSM configuration and detailed instructions, see the related [support article](https://support.yubico.com/hc/en-us/articles/15705749884444).

  #### **Signing**

  An attacker could duplicate elliptic curve signing keys. The attacker would need to be able to authenticate to the HSM with sufficient capabilities to perform signing actions.

  Users can mitigate by using RSA or ed25519 signing keys.

  #### **Attestation**

  If a user is attesting with their own elliptic curve key instead of the Yubico provided YubiHSM attestation key an attacker could produce a valid attestation statement for a key made outside of the YubiHSM. The attacker requires an authentication key with sign attestation capabilities to perform and observe an attestation operation.

  Users can mitigate by using RSA attestation certificates.

  # **Additional Resources**

  Support Article: <https://support.yubico.com/hc/en-us/articles/15705749884444>

  Research:[https://ninjalab.io/eucleak](https://ninjalab.io/eucleak/)/

  # **Severity**

  Yubico has rated this issue as Moderate. It has a CVSS score of [4.9](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:P/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N&version=3.1)

  # **Acknowledgements**

  On April 19, 2024, Dr. Thomas Roche from NinjaLab notified Yubico of this security issue. We thank them for reporting it and working with us under coordinated vulnerability disclosure.

  ### **Timeline**

  | April 19, 2024 | NinjaLab informs Yubico of their research |
  | --- | --- |
  | May 21, 2024 | Yubico releases YubiKey 5.7 |
  | September 2, 2024 | Yubico announces YubiHSM 2.4 |
  | September 3, 2024 | Yubico releases advisory YSA-2024-03 |

  # **Frequently Asked Questions**

  **Are all of Yubico’s devices affected?**

  No. Our latest YubiKey 5 Series and Security Key Series, which started shipping on May 21, 2024 are not affected by Infineon’s cryptographic library vulnerability. These devices come with the new 5.7 firmware, which contains Yubico’s own cryptographic library. This means that the vulnerability discovered in Infineon’s library does not impact these new devices in any way.

  **How easy is this vulnerability to exploit?**

  It’s important to note that while the vulnerability exists in previous YubiKey series, exploiting it is complex. According to the researchers, any attempt to exploit this vulnerability would require significant resources and knowledge. The attacker would need physical possession of the YubiKey, Security Key, or YubiHSM, knowledge of the accounts they want to target, and specialized equipment to perform the necessary attack. Depending on the use case, the attacker may also require additional knowledge including username, PIN, account password, or authentication key.

  Even with this potential risk, by maintaining possession of your YubiKey and if it is lost or stolen, deregistering it promptly from applications and services that it is registered with, you effectively mitigate this vulnerability.

  **Is FIDO authentication still recommended over other authentication methods like OTP or SMS?**

  Yes, FIDO remains the strongest, most phishing-resistant authentication protocol available. Both Yubico and the researchers who discovered this vulnerability strongly recommend the continued use of FIDO authenticators over weaker authentication methods like OTP or SMS. Using a YubiKey remains significantly safer than not using one at all.

  **What should I do if my YubiKey is lost or stolen?**

  To maximize security, we advise all users to take precautions to maintain physical control of their YubiKeys. If your YubiKey is ever lost or stolen, promptly deregister the key from all associated applications and services. This is an effective way to immediately mitigate risks associated with this type of vulnerability. This also supports the best practice of having both a primary and a backup key.

  **Why doesn’t Yubico allow firmware updates for its devices?**

  We understand there are questions about why Yubico does not allow firmware updates for our keys. We believe that not allowing firmware updates is the best practice to maximize the security of your keys. Firmware updates, while potentially convenient, can introduce new vulnerabilities. By preventing firmware updates, we ensure that your firmware remains secure from the moment it is programmed. More details on our position can be found in our [knowledge base article](https://support.yubico.com/hc/en-us/articles/360013708760-YubiKey-Firmware-is-Not-Upgradable), which we encourage you to read for a deeper understanding.

  **Where do the FIPS keys fit into this scenario?**

  As with other YubiKey models, for current FIPS devices, we similarly advise to take precautions to maintain physical control of your YubiKeys and promptly deregister the key from all associated applications and services if lost or stolen.

  **Will Yubico be doing a key replacement program?**

  As this risk has been rated as “moderate” according to the Common Vulnerability Scoring System (CVSS) and as maintaining possession of your YubiKey and deregistering it promptly if it is lost or stolen, can effectively mitigate this risk, we do not have an active key replacement program. If you have concerns about your YubiKey, please reach out to our [customer support team](https://support.yubico.com/hc/en-us), and we will do our best to address your needs in a timely manner.

[![Yubico Text Logo](https://www.yubico.com/wp-content/themes/yubicool/img/logos/logo.svg)](https://www.yubico.com)

* [RSS Feed](https://www.yubico.com/feed/)
* [X](https://x.com/Yubico)
* [LinkedIn](https://www.linkedin.com/company/Yubico)
* [Facebook](https://www.facebook.com/Yubikey)
* [Instagram](https://www.instagram.com/Yubico)
* [YouTube](https://www.youtube.com/c/Yubico)
* [GitHub](https://www.github.com/Yubico)

Find

* [Product finder quiz](/quiz/)

Set up

* [Find set-up guides](/setup/)

Buy

* [Buy online](/store)
* [Contact sales](/contact-us/)

Sign up

* [Get Yubico updates](https://www.yubico.com/email-subscription/)

Why Yubico

* [Careers](https://www.yubico.com/careers/)
* [Events](https://www.yubico.com/events/)
* [Press room](https://www.yubico.com/press/)
* [About us](https://www.yubico.com/why-yubico/about-us/)
* [Investors](https://investors.yubico.com)
* [Partner programs](https://www.yubico.com/why-yubico/partners/)

Products

* [YubiKey 5 Series](https://www.yubico.com/products/yubikey-5-overview/)
* [YubiKey 5 FIPS Series](https://www.yubico.com/products/yubikey-fips/)
* [YubiKey Bio Series](https://www.yubico.com/products/yubikey-bio-series/)
* [Security Key Series](https://www.yubico.com/products/security-key/)
* [YubiHSM 2 & YubiHSM 2 FIPS](https://www.yubico.com/products/hardware-security-module/)

* [Yubico Authenticator](https://www.yubico.com/products/yubico-authenticator/)

Solutions

* [Zero Trust](https://www.yubico.com/solutions/zero-trust/)
* [Phishing-resistant MFA](https://www.yubico.com/solutions/multi-factor-authentication/)
* [Passwordless](https://www.yubico.com/solutions/passwordless/)
* [Cyber insurance](https://www.yubico.com/solutions/cyber-insurance/)
* [More solutions](https://www.yubico.com/solutions/)

Industries

* [Industries overview](https://www.yubico.com/industries/)

Resources

* [Yubico blog](https://www.yubico.com/blog/)
* [Resource library](https://www.yubico.com/resources/library/)
* [Cybersecurity glossary](https://www.yubico.com/resources/glossary/)
* [Authentication standards](https://www.yubico.com/authentication-standards/)
* [Developer program](https://developers.yubico.com/)

Support

* [Works with YubiKey](https://www.yubico.com/works-with-yubikey/catalog/?sort=popular/)
* [Help center](https://support.yubico.com/hc/en-us/)
* [Downloads](https://www.yubico.com/support/download/)
* [Product documentation](https://docs.yubico.com/)
* [Support Services](https://www.yubico.com/support-services/)
* [Professional Services](https://www.yubico.com/support/yubico-for-professional-services/)
* [Contact support](https://support.yubico.com/hc/en-us/requests/new/)

EnglishFrançaisDeutsch日本語EspañolSvenska
 Yubico © 2025 All Rights Reserved.

* [Sitemap](/sitemap_index.xml)
* [Cookies](/support/terms-conditions/cookie-notice/)
* [Legal](/support/terms-conditions/)
* [Privacy](/support/terms-conditions/privacy-notice/)
* [Patents](https://www.yubico.com/why-yubico/patents/)
* [Terms of use](/support/terms-conditions/yubico-website-terms-conditions/)
* [Trust](/trust/)



=== Content from arstechnica.com_9f6c3ea2_20250111_204540.html ===


[Skip to content](#main)

[Ars Technica home](https://arstechnica.com/)

Sections

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

* [Feature](/features/)
* [Reviews](/reviews/)
* [Store](/store/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Pin to story

Theme

* HyperLight
* Day & Night
* Dark
* System

Search dialog...

Sign In

Sign in dialog...

Sign in

ATTACK OF THE CLONES

# YubiKeys are vulnerable to cloning attacks thanks to newly discovered side channel

Sophisticated attack breaks security assurances of the most popular FIDO key.

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
–
Sep 3, 2024 1:58 pm

| [188](https://arstechnica.com/security/2024/09/yubikeys-are-vulnerable-to-cloning-attacks-thanks-to-newly-discovered-side-channel/#comments "188 comments")

[![](https://cdn.arstechnica.net/wp-content/uploads/2024/09/yubikeys.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2024/09/yubikeys.jpg)

Credit:
Yubico

Credit:
Yubico

Text
settings

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Minimize to nav

The YubiKey 5, the most widely used hardware token for two-factor authentication based on the [FIDO standard](https://fidoalliance.org/how-fido-works/), contains a cryptographic flaw that makes the finger-size device vulnerable to cloning when an attacker gains temporary physical access to it, researchers said Tuesday.

The cryptographic flaw, known as a [side channel](https://en.wikipedia.org/wiki/Side-channel_attack), resides in a small microcontroller used in a large number of other authentication devices, including smartcards used in banking, electronic passports, and the accessing of secure areas. While the researchers have confirmed all YubiKey 5 series models can be cloned, they haven’t tested other devices using the microcontroller, such as the SLE78 made by Infineon and successor microcontrollers known as the Infineon Optiga Trust M and the Infineon Optiga TPM. The researchers suspect that any device using any of these three microcontrollers and the Infineon cryptographic library contains the same vulnerability.

## Patching not possible

YubiKey-maker Yubico issued an [advisory](https://www.yubico.com/support/security-advisories-ysa-2024-03/) in coordination with a [detailed disclosure report](https://ninjalab.io/wp-content/uploads/2024/09/20240903_eucleak.pdf) from NinjaLab, the security firm that reverse-engineered the YubiKey 5 series and devised the cloning attack. All YubiKeys running firmware prior to version 5.7—which was released in May and replaces the Infineon cryptolibrary with a custom one—are vulnerable. Updating key firmware on the YubiKey isn’t possible. That leaves all affected YubiKeys permanently vulnerable.

“An attacker could exploit this issue as part of a sophisticated and targeted attack to recover affected private keys,” the advisory confirmed. “The attacker would need physical possession of the YubiKey, Security Key, or YubiHSM, knowledge of the accounts they want to target and specialized equipment to perform the necessary attack. Depending on the use case, the attacker may also require additional knowledge including username, PIN, account password, or authentication key.”

Side channels are the result of clues left in physical manifestations such as electromagnetic emanations, data caches, or the time required to complete a task that leaks cryptographic secrets. In this case, the side channel is the amount of time taken during a mathematical calculation known as a modular inversion. The Infineon cryptolibrary failed to implement a common side-channel defense known as constant time as it performs modular inversion operations involving the Elliptic Curve Digital Signature Algorithm. Constant time ensures the time sensitive cryptographic operations execute is uniform rather than variable depending on the specific keys.

More precisely, the side channel is located in the Infineon implementation of the Extended Euclidean Algorithm, a method for, among other things, computing the modular inverse. By using an oscilloscope to measure the electromagnetic radiation while the token is authenticating itself, the researchers can detect tiny execution time differences that reveal a token’s ephemeral ECDSA key, also known as a nonce. Further analysis allows the researchers to extract the secret ECDSA key that underpins the entire security of the token.

In Tuesday’s report, NinjaLab co-founder Thomas Roche wrote:

> In the present work, NinjaLab unveils a new side-channel vulnerability in the ECDSA implementation of Infineon 9 on any security microcontroller family of the manufacturer.This vulnerability lies in the ECDSA ephemeral key (or nonce) modular inversion, and, more precisely, in the Infineon implementation of the Extended Euclidean Algorithm (EEA for short). To our knowledge, this is the first time an implementation of the EEA is shown to be vulnerable to side-channel analysis (contrarily to the EEA binary version). The exploitation of this vulnerability is demonstrated through realistic experiments and we show that an adversary only needs to have access to the device for a few minutes. The offline phase took us about 24 hours; with more engineering work in the attack development, it would take less than one hour.
>
> After a long phase of understanding Infineon implementation through side-channel analysis on a Feitian 10 open JavaCard smartcard, the attack is tested on a YubiKey 5Ci, a FIDO hardware token from Yubico. All YubiKey 5 Series (before the firmware update 5.7 11 of May 6th, 2024) are affected by the attack. In fact all products relying on the ECDSA of Infineon cryptographic library running on an Infineon security microcontroller are affected by the attack. We estimate that the vulnerability exists for more than 14 years in Infineon top secure chips. These chips and the vulnerable part of the cryptographic library went through about 80 CC certification evaluations of level AVA VAN 4 (for TPMs) or AVA VAN 5 (for the others) from 2010 to 2024 (and a bit less than 30 certificate maintenances).

In an online interview, Roche elaborated:

> Infineon produces “security microcontrollers” or “secure elements.” You can find many of them out there. Some of them (and this is the case for YubiKey 5 Series) run the Infineon cryptographic library (that Infineon develops for their customers that do not want to develop their own).
>
> This cryptolibrary is highly confidential (even its API is secret, you need to sign an NDA with Infineon just to know the API). Nobody, but Infineon, knows the cryptolibrary details and notably its countermeasures choices.
>
> This cryptolibrary, as many others, implement the ECDSA (core crypto function of FIDO, but also used in many different applications/protocols). Inside the ECDSA scheme, there are several sub-functions calls, one of them is the modular inversion of the ECDSA ephemeral key. This is a very sensitive operation: any information leaking about the ECDSA ephemeral key would eventually reveal the ECDSA secret key.
>
> In the Infineon cryptolibrary the modular inversion is not constant time: different ephemeral key will lead to different inversion execution time. When acquiring the electromagnetic radiation of a chip running this function one can extract tiny differences of execution times throughout the inversion computation. These small timing leakages allow us to extract the ephemeral key and then the secret key.

The attacks require about $11,000 worth of equipment and a sophisticated understanding of electrical and cryptographic engineering. The difficulty of the attack means it would likely be carried out only by nation-states or other entities with comparable resources and then only in highly targeted scenarios. The likelihood of such an attack being used widely in the wild is extremely low. Roche said that two-factor-authentication and one-time password functionalities aren't affected: because they don't use the vulnerable part of the library.

Tuesday's report from NinjaLab outlines the full flow of the cloning attack as:

1. The adversary steals the login and password of a victim’s application account protected with FIDO (e.g., via a phishing attack).
2. The adversary gets physical access to the victim’s device during a limited time frame without the victim noticing.
3. Thanks to the stolen victim’s login and password (for a given application account), the adversary sends the authentication request to the device as many times as is necessary while performing side-channel measurements.
4. The adversary quietly gives back the FIDO device to the victim.
5. The adversary performs a side-channel attack over the measurements and succeeds in extracting the ECDSA private key linked to the victim’s application account.
6. The adversary can sign in to the victim’s application account without the FIDO device and without the victim noticing. In other words, the adversary created a clone of the FIDO device for the victim’s application account. This clone will give access to the application account as long as the legitimate user does not revoke its authentication credentials.

The list, however, omits a key step, which is tearing down the YubiKey and exposing the logic board housed inside. This likely would be done by using a hot air gun and a scalpel to remove the plastic key casing and expose the part of the logic board that acts as a secure element storing the cryptographic secrets. From there, the attacker would connect the chip to hardware and software that take measurements as the key is being used to authenticate an existing account. Once the measurement-taking is finished, the attacker would seal the chip in a new casing and return it to the victim.

[![](https://cdn.arstechnica.net/wp-content/uploads/2024/09/ybikey-tear-down-01-640x337.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2024/09/ybikey-tear-down-01.jpg)
Left: a YubiKey 5Ci intact; Right: the logic board found inside.
NinjaLab

Left: a YubiKey 5Ci intact; Right: the logic board found inside.
NinjaLab

[![](https://cdn.arstechnica.net/wp-content/uploads/2024/09/yubikey-tear-down-02-640x370.jpg)](https://cdn.arstechnica.net/wp-content/uploads/2024/09/yubikey-tear-down-02.jpg)
Two images showing the how the electromagnetic radiation is measure using a probe.
NinjaLab

Two images showing the how the electromagnetic radiation is measure using a probe.
NinjaLab

Left: a YubiKey 5Ci intact; Right: the logic board found inside.
NinjaLab

Two images showing the how the electromagnetic radiation is measure using a probe.
NinjaLab

The attack and underlying vulnerability that makes it possible are almost entirely the same as that allowed NinjaLab to [clone Google Titan keys](https://arstechnica.com/information-technology/2021/01/hackers-can-clone-google-titan-2fa-keys-using-a-side-channel-in-nxp-chips/) in 2021. That attack required physical access to the token for about 10 hours.

The attacks violate a fundamental guarantee of FIDO-compliant keys, which is that the secret cryptographic material they store can’t be read or copied by any other device. This assurance is crucial because FIDO keys are used in various security-critical environments, such as those in the military and corporate networks.

That said, FIDO-compliant authentication is among the most robust forms of authentication, one that’s not susceptible to credential phishing or adversary-in-the-middle attacks. As long as the key stays out of the hands of a highly skilled and well-equipped attacker, it remains among the strongest forms of authentication. It’s also worth noting that cloning the token is only one of two major steps required to gain unauthorized access to an account or device. An attacker also must obtain the user password used for the first factor of authentication. These requirements mean that physical keys remain among the most secure authentication methods.

To uncover the side channel, the researchers reverse-engineered the Infineon cryptographic library, a heavily fortified collection of code that the manufacturer takes great pains to keep confidential. The detailed description of the library is likely to be of intense interest to cryptography researchers analyzing how it works in other security devices.

People who want to know what firmware version their YubiKey runs can use the [Yubico Authenticator](https://www.yubico.com/products/yubico-authenticator/) app. The upper-left corner of the home screen displays the series and model of the key. In the example below, from Tuesday’s advisory, the YubiKey is a YubiKey 5C NFC version 5.7.0.

![](https://cdn.arstechnica.net/wp-content/uploads/2024/09/Yubico-Authenticator-Screenshot-1.png)

Credit:
Yubico

YubiKeys provide optional [user authentication protections](https://developers.yubico.com/Passkeys/Passkey_concepts/User_verification.html), including the requirement for a user-supplied PIN code or a fingerprint or face scan. For the cloning attack to work against YubiKeys using these additional measures, an attacker would need to possess the user verification factor as well. More information about using these additional measures to lock down YubiKeys further is [available here](https://support.yubico.com/hc/en-us/articles/15705749884444-Infineon-ECDSA-Private-Key-Recovery-Customer-Resources).

A key question that remains unanswered at the moment is what other security devices rely on the three vulnerable Infineon secure modules and use the Infineon cryptolibrary? Infineon has yet to issue an advisory and didn't respond to an email asking for one. At the moment, there is no known CVE for tracking the vulnerability.

Related Stories

[![](https://cdn.arstechnica.net/wp-content/uploads/2021/01/google-titan-keys-150x150.jpg)](https://arstechnica.com/information-technology/2021/01/hackers-can-clone-google-titan-2fa-keys-using-a-side-channel-in-nxp-chips/)

[Hackers can clone Google Titan 2FA keys using a side channel in NXP chips](https://arstechnica.com/information-technology/2021/01/hackers-can-clone-google-titan-2fa-keys-using-a-side-channel-in-nxp-chips/)

Yubico and Feitian keys that use the same chip are likely susceptible, too.

Listing image:
Yubico

[![Photo of Dan Goodin](/wp-content/uploads/2018/10/Dang.jpg)](https://arstechnica.com/author/dan-goodin/)
[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

Dan Goodin is Senior Security Editor at Ars Technica, where he oversees coverage of malware, computer espionage, botnets, hardware hacking, encryption, and passwords. In his spare time, he enjoys gardening, cooking, and following the independent music scene. Dan is based in San Francisco. Follow him at [here](https://infosec.exchange/%40dangoodin) on Mastodon and [here](https://bsky.app/profile/dangoodin.bsky.social) on Bluesky. Contact him on Signal at DanArs.82.

[188 Comments](https://arstechnica.com/security/2024/09/yubikeys-are-vulnerable-to-cloning-attacks-thanks-to-newly-discovered-side-channel/#comments "188 comments")

Comments

[Forum view](https://arstechnica.com/civis/threads/yubikeys-are-vulnerable-to-cloning-attacks-thanks-to-newly-discovered-side-channel.1502709/)

![Loading](https://arstechnica.com/wp-content/themes/ars-v9/public/images/firework-loader.75ab30.gif)

[Prev story](https://arstechnica.com/cars/2024/09/hyundai-ioniq-5s-will-be-made-in-usa-with-native-tesla-style-ports/ "Go to: Hyundai updates Ioniq 5 with bigger battery, Tesla-style port")

[Next story](https://arstechnica.com/tech-policy/2024/09/clearview-ai-fined-33m-for-building-illegal-database-of-face-images/ "Go to: Cops’ favorite face image search engine fined $33M for privacy violation")

Most Read

1. [![Listing image for first story in Most Read: Judge ends man’s 11-year quest to dig up landfill and recover $765M in bitcoin](https://cdn.arstechnica.net/wp-content/uploads/2025/01/newport-landfill-768x432-1736530527.jpg)](https://arstechnica.com/tech-policy/2025/01/judge-ends-mans-11-year-quest-to-dig-up-landfill-and-recover-765m-in-bitcoin/)

   1.
   [Judge ends man’s 11-year quest to dig up landfill and recover $765M in bitcoin](https://arstechnica.com/tech-policy/2025/01/judge-ends-mans-11-year-quest-to-dig-up-landfill-and-recover-765m-in-bitcoin/)
2. 2.
   [A glowing ring of metal fell to Earth, and no one has any idea what it is](https://arstechnica.com/space/2025/01/a-glowing-ring-of-metal-fell-to-earth-and-no-one-has-any-idea-what-it-is/)
3. 3.
   [German router maker is latest company to inadvertently clarify the LGPL license](https://arstechnica.com/gadgets/2025/01/suing-wi-fi-router-makers-remains-a-necessary-part-of-open-source-license-law/)
4. 4.
   [Man turns irreversibly gray from an unidentified silver exposure](https://arstechnica.com/health/2025/01/man-turns-irreversibly-gray-from-an-unidentified-silver-exposure/)
5. 5.
   [A taller, heavier, smarter version of SpaceX’s Starship is almost ready to fly](https://arstechnica.com/space/2025/01/a-taller-heavier-smarter-version-of-spacexs-starship-is-almost-ready-to-fly/)

Customize

Ars Technica has been separating the signal from
the noise for over 25 years. With our unique combination of
technical savvy and wide-ranging interest in the technological arts
and sciences, Ars is the trusted source in a sea of information. After
all, you don’t need to know everything, only what’s important.

More
from Ars

* [About Us](https://arstechnica.com/about-us/)
* [Staff Directory](https://arstechnica.com/staff-directory/)
* [Newsletters](https://arstechnica.com/newsletters/)
* [Ars Videos](https://arstechnica.com/video/)
* [General FAQ](https://arstechnica.com/general-faq/)
* [RSS Feeds](https://arstechnica.com/rss-feeds/)

Contact

* [Contact us](https://arstechnica.com/contact-us/)
* [Advertise with us](https://www.condenast.com/brands/ars-technica)
* [Reprints](https://arstechnica.com/reprints/)

Do Not Sell My Personal
Information

© 2025 Condé Nast. All rights reserved. Use of and/or
registration on any portion of this site constitutes acceptance of our [User Agreement](https://www.condenast.com/user-agreement/) and
[Privacy Policy and
Cookie Statement](https://www.condenast.com/privacy-policy/) and [Ars
Technica Addendum](/amendment-to-conde-nast-user-agreement-privacy-policy/) and [Your
California Privacy Rights](https://www.condenast.com/privacy-policy/#california). Ars Technica may earn compensation on
sales from links on this site. [Read our
affiliate link policy](/affiliate-link-policy/). The material on this site may not be
reproduced, distributed, transmitted, cached or otherwise used, except
with the prior written permission of Condé Nast. [Ad
Choices](https://www.aboutads.info/)



=== Content from ninjalab.io_73fb5b77_20250111_204543.html ===


[NinjaLab](https://ninjalab.io "NinjaLab")

* [Home](https://ninjalab.io)
* [News](https://ninjalab.io/news/)
* [About](https://ninjalab.io/about)
* [Offer](https://ninjalab.io/offer)
* [Research](https://ninjalab.io/research)
* [Team](https://ninjalab.io/team)
* [Careers](https://ninjalab.io/careers/)
* [Contact](https://ninjalab.io#contact-us)

* [Home](https://ninjalab.io)
* [News](https://ninjalab.io/news/)
* [About](https://ninjalab.io/about)
* [Offer](https://ninjalab.io/offer)
* [Research](https://ninjalab.io/research)
* [Team](https://ninjalab.io/team)
* [Careers](https://ninjalab.io/careers/)
* [Contact](https://ninjalab.io#contact-us)

# EUCLEAK

### [Download the Writeup](https://ninjalab.io/wp-content/uploads/2024/10/20241022_eucleak.pdf)

*Illustration [Romain Flamand](https://www.artstation.com/dka) – Flamingo Studio – flamandromain@gmail.com*

### Abstract

Secure elements are small microcontrollers whose main purpose is to generate/store secrets and then execute cryptographic operations. They undergo the highest level of security evaluations that exists (Common Criteria) and are often considered inviolable, even in the worst-case attack scenarios. Hence, complex secure systems build their security upon them.

FIDO hardware tokens are strong authentication factors to sign in to applications (any web service supporting FIDO); they often embed a secure element and the FIDO protocol uses Elliptic Curve Digital Signature Algorithm (ECDSA for short) as its core cryptographic primitive. YubiKey 5 Series are certainly the most widespread FIDO hardware tokens, their secure element is an Infineon SLE78.

This document shows how – finding a JavaCard open platform (the Feitian A22) based on a similar Infineon SLE78 – we understood the Infineon ECDSA implementation, found a side-channel vulnerability and designed a practical side-channel attack. The attack is then demonstrated on a YubiKey 5Ci. Finally, we show that the vulnerability extends to the more recent Infineon Optiga Trust M and Infineon Optiga TPM security microcontrollers.

Our work unearths a side-channel vulnerability in the cryptographic library of Infineon Technologies, one of the biggest secure element manufacturers. This vulnerability – that went unnoticed for 14 years and about 80 highest-level Common Criteria certification evaluations – is due to a non constant-time modular inversion.

**The attack requires physical access to the secure element** (few local electromagnetic side-channel acquisitions, i.e. few minutes, are enough) **in order to extract the ECDSA secret key.** In the case of the FIDO protocol, this allows to create a clone of the FIDO device.

**All YubiKey 5 Series (with firmware version below 5.7) are impacted by the attack and in fact all Infineon security microcontrollers (including TPMs) that run the Infineon cryptographic library (as far as we know, any existing version) are vulnerable to the attack.** These security microcontrollers are present in a vast variety of secure systems – often relying on ECDSA – like electronic passports and crypto-currency hardware wallets but also smart cars or homes. However, we did not check (yet) that the EUCLEAK attack applies to any of these products.

### Cautionary Note

Authentication tokens (like FIDO hardware devices) primary goal is
to fight the scourge of phishing attacks. The EUCLEAK attack requires physical access to
the device, expensive equipment, custom software and technical skills. **Thus, as far as the work presented here goes, it is still safer to use your YubiKey or other impacted products as FIDO hardware authentication token to sign in to applications rather than not using one.**

### Discovered By

 Thomas Roche (NinjaLab)

### List of Impacted Products

* All Infineon security microcontrollers embedding Infineon cryptographic library (any existing version). For instance, all existing versions of Infineon TPMs are affected.

* All YubiKey 5 Series (with firmware version below 5.7)

### Further Notes

1. The impacted Feitian A22 Javacard used in this work is an old product no more available for sale. All Feitian products currently available on their webstore (and based on an Infineon security microcontroller) use Feitian own cryptographic library, and are not impacted by our work to our knowledge.

2. The new YubiKey firmware 5.7 update (May 6th, 2024) switches the YubiKeys from Infineon cryptographic library to Yubico new cryptographic library. To our knowledge, this new cryptographic library is not impacted by our work.

3. Infineon has already a patch for their cryptographic library, to our knowledge it did not yet pass a Common Criteria certification evaluation.

### CVE

Our CVE request was rejected.

Instead, MITRE went with [CVE-2024-45678](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2024-45678).

Our request for a description update is pending.

### Official Statements From Stakeholders

* 3rd Sept. 2024 – [Yubico Security Advisory](https://www.yubico.com/support/security-advisories/ysa-2024-03/)
* 9th Sept. 2024 – BSI Press Release [(German)](https://www.bsi.bund.de/DE/Service-Navi/Presse/Alle-Meldungen-News/Meldungen/EUCLEAK_Seitenkanalangriff_240909.html) / [(Google Translated Version)](https://translate.google.com/translate?js=n&sl=auto&tl=english&u=https://www.bsi.bund.de/DE/Service-Navi/Presse/Alle-Meldungen-News/Meldungen/EUCLEAK_Seitenkanalangriff_240909.html)

### Press Coverage

* [Ars Technica](https://arstechnica.com/security/2024/09/yubikeys-are-vulnerable-to-cloning-attacks-thanks-to-newly-discovered-side-channel/)
* [Lawrence Systems](https://www.youtube.com/watch?v=jHbyxG6Cc74)
* [Cyber Security News](https://cybersecuritynews.com/yubikeys-clone-device-secret-key/)
* [BleepingComputer](https://www.bleepingcomputer.com/news/security/new-eucleak-attack-lets-threat-actors-clone-yubikey-fido-keys/)
* [Coinspect](https://www.coinspect.com/blog/hardware-wallet-security/)
* [Wirecutter (NYTimes)](https://www.nytimes.com/wirecutter/reviews/best-security-keys/)

##### Site map

* [About us](https://ninjalab.io/about/)
* [Careers](https://ninjalab.io/careers/)
* [Home](https://ninjalab.io/)
* [News](https://ninjalab.io/news/)
* [Our Offer](https://ninjalab.io/offer/)
* [Research](https://ninjalab.io/research/)
* [The Team](https://ninjalab.io/team/)

Theme: [Illdy](http://colorlib.com/wp/themes/illdy "Illdy").
© Copyright 2024 NinjaLab. All Rights Reserved.



=== Content from ninjalab.io_363ef0ab_20250111_204548.html ===
EUCLEAK

Side-Channel Attack on the YubiKey 5 Series

(Revealing and Breaking Inﬁneon ECDSA Implementation on the Way)

Thomas Roche

NinjaLab, Montpellier, France
thomas@ninjalab.io

September 3rd, 2024

ABSTRACT

Secure elements are small microcontrollers whose main purpose is to generate/store secrets
and then execute cryptographic operations. They undergo the highest level of security evalua-
tions that exists (Common Criteria) and are often considered inviolable, even in the worst-case
attack scenarios. Hence, complex secure systems build their security upon them.

FIDO hardware tokens are strong authentication factors to sign in to applications (any web
service supporting FIDO); they often embed a secure element and the FIDO protocol uses El-
liptic Curve Digital Signature Algorithm (ECDSA for short) as its core cryptographic primitive.
YubiKey 5 Series are certainly the most widespread FIDO hardware tokens, their secure ele-
ment is an Inﬁneon SLE78.

This document shows how – ﬁnding a JavaCard open platform (the Feitian A22) based on
a similar Inﬁneon SLE78 – we understood the Inﬁneon ECDSA implementation, found a side-
channel vulnerability and designed a practical side-channel attack. The attack is then demon-
strated on a YubiKey 5Ci. Finally, we show that the vulnerability extends to the more recent
Inﬁneon Optiga Trust M and Inﬁneon Optiga TPM security microcontrollers.

Our work unearths a side-channel vulnerability in the cryptographic library of Inﬁneon Tech-
nologies, one of the biggest secure element manufacturers. This vulnerability – that went unno-
ticed for 14 years and about 80 highest-level Common Criteria certiﬁcation evaluations – is due
to a non constant-time modular inversion.

The attack requires physical access to the secure element (few local electromagnetic
few minutes, are enough) in order to extract the ECDSA
side-channel acquisitions, i.e.
secret key. In the case of the FIDO protocol, this allows to create a clone of the FIDO device.

All YubiKey 5 Series (with ﬁrmware version below 5.7) are impacted by the attack
and in fact all Inﬁneon security microcontrollers (including TPMs) that run the In-
ﬁneon cryptographic library (as far as we know, any existing version) are vulnerable
to the attack. These security microcontrollers are present in a vast variety of secure systems
– often relying on ECDSA – like electronic passports and crypto-currency hardware wallets but
also smart cars or homes. However, we did not check (yet) that the EUCLEAK attack applies
to any of these products.

Cautionary Note: Authentication tokens (like FIDO hardware devices) primary goal is to
ﬁght the scourge of phishing attacks. The EUCLEAK attack requires physical access to the
device, expensive equipment, custom software and technical skills. Thus, as far as the work
presented here goes, it is still safer to use your YubiKey or other impacted products
as FIDO hardware authentication token to sign in to applications rather than not
using one.

1

Contents

1 Introduction

1.1 Context . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 FIDO Hardware Tokens . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Inﬁneon SLE78 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.3
Feitian A22 JavaCard . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.3.1
1.4 Elliptic Curve Digital Signature Algorithm . . . . . . . . . . . . . . . . . . . . .
1.4.1 ECDSA Signature Scheme . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4.2 ECDSA Signature Veriﬁcation Scheme . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . .
Side-Channel Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.5.1
YubiKey 5Ci . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.5.2
Feitian A22 JavaCard . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.5.3
1.5.4 Focus on the Nonce Modular Inversion . . . . . . . . . . . . . . . . . . . .

1.5 Side-Channel Setup and First Observations

2 Reverse-Engineering of the Modular Inversion

2.1 ECDSA Signature Traces

2.2 ECDSA Signature Veriﬁcation Traces

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1.1 Acquisition Campaign . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1.2
Side-Channel Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1.3 First Hypothesis: Extended Euclidean Algorithm . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . .
2.2.1 Acquisition Campaign . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2.2
Side-Channel Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2.3 A Timing Leakage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.3 Reverse-Engineering of the Modular Inversion Countermeasure . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.3.1 Hypothesis
2.3.2 Brute-force Experiments . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 Input-Recovery Attack on the Extended Euclidean Algorithm

3.1 First Observations
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.2 Building a Generic Attack Algorithm . . . . . . . . . . . . . . . . . . . . . . . . .
3.3 Simulation Experiments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Full Reverse-Engineering of Inﬁneon EEA

4.1 More Timing Leakages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.2 A Deep Dive into Euclidean Division Algorithms . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.2.1 First Steps

2

8
8
10
12
13
13
14
14
15
15
16
17
19

20
20
20
21
24
26
26
27
29
31
31
32
33

34
34
36
40
41

42
42
45
45

4.2.2 Failed Attempts
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.2.3 Perseverance is the Key . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Inﬁneon Euclidean Division Algorithm . . . . . . . . . . . . . . . . . . . .
4.2.4
4.3 Summary of the Timing Leakages . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 Key-Recovery Attack on ECDSA

5.1

Input-Recovery Attack on the EEA . . . . . . . . . . . . . . . . . . . . . . . . . .
Simulation Experiments . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.1.1
5.2 From Blinded Nonce to ECDSA Long Term Private Key . . . . . . . . . . . . . .
5.3 Application to Feitian A22 JavaCard . . . . . . . . . . . . . . . . . . . . . . . .
5.3.1 Leakage Extraction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.3.2 Attack Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.4 Application to YubiKey 5Ci . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.4.1
Side-Channel Acquisitions . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.4.2 Leakage Extraction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.4.3 Attack Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.5 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6 Beyond SLE78

6.1
6.2

6.3

Inﬁneon Security Microcontrollers . . . . . . . . . . . . . . . . . . . . . . . . . . .
Inﬁneon Optiga Trust M . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.2.1
Side-Channel Acquisitions . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.2.2 Leakage Observation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Inﬁneon Optiga TPM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Side-Channel Acquisitions . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.3.1

7 Conclusions

7.2.1
7.2.2
7.2.3

Impact on Inﬁneon Security Microcontrollers

. . . . . . . . . . . . . . . . . . . .
7.1
7.2 Conﬁrmed Vulnerable End-User Products . . . . . . . . . . . . . . . . . . . . . .
YubiKey 5 Series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Feitian A22 JavaCard . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Inﬁneon TPMs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.3 Potentially Vulnerable Products . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.4 Attack Mitigations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.4.1 Hardening the Inﬁneon Cryptographic Library . . . . . . . . . . . . . . .
7.4.2 High-Level Mitigations . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.5 Avenues of Research . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.6 Project Timeline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

A YubiKey 5C Case Opening

B Inﬁneon Security Microcontrollers

3

50
51
52
52

54
54
55
56
56
56
57
57
57
59
62
62

63
63
64
65
68
71
71

75
76
76
77
77
77
77
78
78
78
79
79
81

84

86

List of Figures

1.1 YubiKey 5 Series Teardowns
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Feitian A22 JavaCard – Screenshot from SmartCard Focus . . . . . . . . . . .
1.3 YubiKey 5Ci – Teardown . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4 YubiKey 5Ci – EM Acquisition Setup . . . . . . . . . . . . . . . . . . . . . . . .
1.5 YubiKey 5Ci – EM Traces – ECDSA Signature . . . . . . . . . . . . . . . . . . .
1.6 Feitian A22 JavaCard – EM Acquisition Setup . . . . . . . . . . . . . . . . . .
1.7 Feitian A22 JavaCard – EM Traces – ECDSA Signature . . . . . . . . . . . . .
1.8 Feitian A22 JavaCard – EM Traces – ECDSA Signature – (r, s) Computation .

Zoom on Few Iterations (Bottom)

ruptions Detection (Top) - Cleaned Trace (Bottom)

2.1 Feitian A22 JavaCard – ECDSA Signature – Full Trace (Top) - (r, s) Compu-
tation (Middle) - k−1 mod N Computation (Bottom) . . . . . . . . . . . . . . . .
2.2 Feitian A22 JavaCard – ECDSA Signature – k−1 mod N Computation (Top) -
. . . . . . . . . . . . . . . . . . . . . . . . . .
2.3 Feitian A22 JavaCard – ECDSA Signature – k−1 mod N Computation – Inter-
. . . . . . . . . . . . . . . .
2.4 Feitian A22 JavaCard – ECDSA Signature – k−1 mod N Computation – Itera-
tions Detection (Top) - Zoom on Few Iterations (Bottom) . . . . . . . . . . . . .
2.5 Feitian A22 JavaCard – ECDSA Signature – k−1 mod N Computation – Dis-
tribution of the Number of Iterations – Observations (Blue) - EEA Simulations
(Orange) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.6 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – Full Trace . . . . . .
2.7 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – Full Trace (Top) -
Zoom Between the Scalar Multiplications (Middle) - s−1 mod N Computation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
(Bottom)
2.8 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – s−1 mod N Computa-
tion – Interruptions Detection (Top) - Cleaned Trace (Bottom) . . . . . . . . . .
2.9 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – s−1 mod N Computa-
tion – Iterations Detection (Top) - Zoom on Few Iterations (Bottom) . . . . . . .
2.10 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – s−1 mod N – Four
Consecutive Iterations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.11 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – 100 Superposed Odd
. . . .
Iterations – ∆r0,r1 = 0 (Top) - ∆r0,r1 = 1 (Middle) - ∆r0,r1 = 2 (Bottom)
2.12 Feitian A22 JavaCard – Modular Inversion Multiplicative Mask Brute Force –
Pearson Correlation Results ρ({∆r0,r1 i}0<i≤n, {Li}0<i≤n) . . . . . . . . . . . . .

3.1 A Generic Input-Recovery Side-Channel Attack on the EEA . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . .
3.2 Simulation of the Generic Attack – Li = qi

4

12
13
16
17
17
18
19
19

21

22

23

24

25
26

27

28

29

30

31

33

36
41

4.1 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – ∆r0,r1 = 2 – 100 Su-
perposed Odd Iterations (Top) - A Single Trace, Zoom on the New Leakage Area
(Bottom)
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.2 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – Odd Iteration with
∆r0,r1 = 2 – Various Shapes in the EM Signal . . . . . . . . . . . . . . . . . . . .
4.3 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Full Trace (Top) - Zoom around the First Iterations (Bottom) . . . . . . . . . . .
4.4 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation
Pattern Detection – Two Consecutive Iterations (Top) - Several Iterations (Mid-
dle) - Full Trace (Bottom) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.5 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Resynchronized Iteration – Full Iteration (Top) - Zoom (Bottom) . . . . . . . . .
4.6 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Resynchronized Iteration – Compact Iteration (Top) - Regular Iteration (Bottom)
4.7 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Full Trace with Compact Areas . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.8 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Resynchronized Iteration – ∆r0,r1 = 2, quotient = 2 – Case 1 (Top) - Case 2
(Middle) - Case 3 (Bottom) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.9 Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Resynchronized Iteration – ∆r0,r1 = 3, quotient = 6 (Top) - ∆r0,r1 = 3, quotient
= 4 (Bottom) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5.1 Simulation of the Generic Attack – Comparison Between Li = qi and Inﬁneon
Leakage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.2 YubiKey 5Ci – ECDSA Signature – k−1 mod N Computation . . . . . . . . . . .
5.3 YubiKey 5Ci – ECDSA Signature – Cleaned k−1 mod N Computation (Top) -

43

44

45

46

47

48

48

49

50

55
58

Zoom on Several Iterations (Middle) - Zoom on Two Consecutive Iterations (Bottom) 59

tion (Top) - Zoom on Few Iterations (Bottom)

5.4 YubiKey 5Ci – ECDSA Signature – k−1 mod N Computation – Iterations Detec-
. . . . . . . . . . . . . . . . . . .
5.5 YubiKey 5Ci – ECDSA Signature – k−1 mod N Computation – Odd Iteration
Subtrace . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.6 YubiKey 5Ci – ECDSA Signature – k−1 mod N Computation – Single Iteration
– 2 Diﬀerent Odd Iterations (First and Third) - After Averaging Rolling Window
(Second and Last)
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

60

60

61

Inﬁneon Security Microcontroller Families . . . . . . . . . . . . . . . . . . . . . .
6.1
6.2 Optiga Trust M – PSoCTM 62S2 evaluation kit (CY8CEVAL-062S2)
. . . . . .
6.3 Optiga Trust M – Acquisition Setup . . . . . . . . . . . . . . . . . . . . . . . . .
6.4 Optiga Trust M – EM Probe Position . . . . . . . . . . . . . . . . . . . . . . . .
6.5 Optiga Trust M – ECDSA Signature – Full Trace (Top) - Zoom in Computation
End (Middle) - k−1 mod N Computation (Bottom) . . . . . . . . . . . . . . . . .
6.6 Optiga Trust M – ECDSA Signature Veriﬁcation – Full Trace (Top) - Zoom be-
fore Double Scalar Mult. (Middle) - s−1 mod N Computation (Bottom) . . . . .
6.7 Optiga Trust M – ECDSA Signature Veriﬁcation – Full Trace
. . . . . . . . . .
6.8 Optiga Trust M – ECDSA Signature Veriﬁcation – Cleaned s−1 mod N Compu-
tation (Top) - Single Odd Iteration after Splitting (Bottom) . . . . . . . . . . . .
70
6.9 Optiga Trust M – ECDSA Signature Veriﬁcation – 100 superposed Odd Iterations) 70
6.10 Optiga TPM – OPTIGA TPM 9673 RPI EVAL . . . . . . . . . . . . . . . . . . .
71

64
65
65
66

68
69

67

5

6.11 Optiga TPM – Acquisition Setup . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.12 Optiga TPM – ECDSA Signature Veriﬁcation – Full Trace (Top) - Zoom on ECDSA
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.13 Optiga TPM – ECDSA Signature Veriﬁcation – Full Computation (Top) - Zoom
on s−1 mod N Computation (Middle) - Zoom on Few Iterations (Bottom) . . . .

Operation (Bottom)

A.1 Brand New YubiKey 5C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
A.2 YubiKey 5C – First Opening
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
A.3 YubiKey 5C – Second Opening . . . . . . . . . . . . . . . . . . . . . . . . . . . .

72

73

74

84
85
85

6

List of Tables

2.1 Acquisition parameters on Feitian A22 JavaCard – ECDSA Signature . . . . .
20
2.2 Acquisition parameters on Feitian A22 JavaCard – ECDSA Signature Veriﬁcation 26

5.1 Number of Diﬀerent Sets of Iterations w.r.t. ∆r0,r1 . . . . . . . . . . . . . . . . .
5.2 Acquisition parameters on YubiKey 5Ci – ECDSA Signature . . . . . . . . . . .

6.1 Acquisition parameters on Optiga Trust M – ECDSA Signature . . . . . . . . .
6.2 Acquisition parameters on Optiga Trust M – ECDSA Signature Veriﬁcation . .
6.3 Acquisition parameters on Optiga TPM – ECDSA Signature Veriﬁcation . . . . .

B.1 Inﬁneon Security Microcontrollers – M78XX (SLE78) – 16-bit, 90 nm . . . . . .
B.2 Inﬁneon Security Microcontrollers – IFX CCI 0-0Xh – 16-bit, 65 nm . . . . . . .
B.3 Inﬁneon Security Microcontrollers – IFX CCI 0-0XYh – ARM SC300, 40 nm . .
B.4 Inﬁneon Security Microcontrollers – IFX CCI 00007Dh – Armv8-M, 28 nm . . .

List of Algorithms

1

1
2
3

4

Extended Euclidean Algorithm for Modular Inversion . . . . . . . . . . . . . . . .

Extended Euclidean Algorithm for Modular Inversion (repeated from page 25) . .
A Generic Attack Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Truncated Extended Euclidean Algorithm . . . . . . . . . . . . . . . . . . . . . . .

Euclidean Division Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

57
58

66
69
73

86
87
87
87

25

34
38
39

52

7

Chapter 1

Introduction

1.1 Context

Secure elements are the root of trust of secure systems. These little pieces of hardware should
be able to generate, store and manipulate secrets while ensuring their full conﬁdentiality and
integrity. And, more importantly, they must be able to do so even when falling inside the adver-
sary hands. To fulﬁll this requirement, the secure elements follow the simpler-is-safer rule: keep
the hardware simple, keep the software simple, keep the communication protocols simple. By
keeping the functionalities to a bare minimum (generate and store cryptographic keys and cer-
tiﬁcates, sign documents, verify signatures and wrap secret keys), secure elements manufacturers
must ﬁght the endless urge of making things more powerful, more complex, more everything.

By keeping things simple, the attack surface is small and easier to audit. The most stringent
certiﬁcation scheme of security devices is under the umbrella of Common Criteria (CC for short)
and was preliminary designed for smart cards evaluation 1. This evaluation, organized around
certiﬁcation bodies (public institutions from the signatory countries of the SOGIS 2), is exe-
cuted by an independent and accredited ITSEF laboratory. These evaluations are tedious and
extremely time consuming, especially when aiming at the highest security level: AVA VAN 5 3.
Hence, secure elements manufacturers must face the marketing challenge of selling what might
seem outdated hardware technology 4 along with epsilonesque functionality updates but for a
important time-to-market production due to certiﬁcation delays.

Integrated in a public key infrastructure, secure elements allow to safely – with unparalleled
security guarantees – authenticate a genuine product (e.g. for access control) or validate that a
piece of software was not modiﬁed (e.g. for boot purpose). Secure elements are then everywhere,
from the Trusted Platform Modules (TPM for short) that can be found managing the secure
boot of most computers (personal or server), to the banking or ID cards that can be found in
everybody’s pocket. They are also omnipresent in high-end smartphones (notably for payment
purpose), in cars and more generally in any IoT device that requires (or advertises) high level of
security.

1https://www.commoncriteriaportal.org/files/ppfiles/ssvgpp01.pdf
2https://www.sogis.eu/
3The Vulnerability Assessment Number, it goes from 1 to 5. The CC EAL level aggregates, among other

things, the AVA VAN X level

4Most common technology node for smart cards is 40nm nowadays.

8

In the last decade secure elements made their way inside two new kind of products: crypto-
currency hardware wallets and FIDO hardware tokens. Both of these products claim high level of
security while being easily in the hand of an adversary: the perfect use case for secure elements.
As secure elements penetration testers, NinjaLab is obviously interested in these products and
more particularly into FIDO hardware tokens. Indeed, while undergoing the most thorough se-
curity evaluations from highly skilled ITSEF laboratories, some vulnerabilities have been found
in the past by independent security researchers. The ROCA attack [22] and the TPM-Fail at-
tack [21] are certainly the most important ones in the recent years.

In 2021 NinjaLab published A Side Journey to Titan [19, 27], reporting a side-channel vul-
nerability in the P5x family of security microcontrollers. The P5x are old secure elements from
NXP 5 manufacturer that still could be found in some products (they are slowly replaced by the
P6 and P7 families from the same manufacturer), and notably in the Google FIDO hardware
token: the Google Titan Security Key 6. Note that the Google Titan Security Key was recently
updated to support passkey 7: passwordless FIDO authentication. In [19], NinjaLab reported a
side-channel vulnerability in the Elliptic Curve Digital Signature Algorithm (ECDSA for short)
implementation of NXP that could be exploited with a physical access to the device 8 for about
10 hours (and an oﬄine phase of about 6 hours, that can be done when the device is already
given back to the legitimate user).

In the present work, NinjaLab unveils a new side-channel vulnerability in the ECDSA im-
plementation of Inﬁneon 9 on any security microcontroller family of the manufacturer.This vul-
nerability lies in the ECDSA ephemeral key (or nonce) modular inversion, and, more precisely,
in the Inﬁneon implementation of the Extended Euclidean Algorithm (EEA for short). To our
knowledge, this is the ﬁrst time an implementation of the EEA is shown to be vulnerable to
side-channel analysis (contrarily to the EEA binary version, e.g.
[9, 2, 1]). The exploitation of
this vulnerability is demonstrated through realistic experiments and we show that an adver-
sary only needs to have access to the device for few minutes. The oﬄine phase took us about
24 hours; with more engineering work in the attack development, it would take less than one hour.

After a long phase of understanding Inﬁneon implementation through side-channel analy-
sis on a Feitian 10 open JavaCard smartcard, the attack is tested on a YubiKey 5Ci, a FIDO
hardware token from Yubico. All YubiKey 5 Series (before the ﬁrmware update 5.7 11 of May
6th, 2024) are aﬀected by the attack. In fact all products relying on the ECDSA of Inﬁneon
cryptographic library running on an Inﬁneon security microcontroller are aﬀected by the attack.
We estimate that the vulnerability exists for more than 14 years in Inﬁneon top secure chips.
These chips and the vulnerable part of the cryptographic library went through about 80 CC
certiﬁcation evaluations of level AVA VAN 4 (for TPMs) or AVA VAN 5 (for the others) from 2010
to 2024 (and a bit less than 30 certiﬁcate maintenances).

A coordinated responsible disclosure has been conducted with Inﬁneon (we naturally included

5https://www.nxp.com/
6https://store.google.com/fr/product/titan_security_key?hl=fr
7See https://blog.google/technology/safety-security/titan-security-key-google-store/
8or more generally any device running the ECDSA on a P5x secure element
9https://www.infineon.com/
10https://www.ftsafe.com/Products/Card_OS
11https://www.yubico.com/blog/empowering-enterprise-security-at-scale-with-new-product-

innovations-yubikey-5-7-and-yubico-authenticator-7/

9

Yubico and Feitian, as well as the certiﬁcation bodies BSI 12 and ANSSI 13 in the responsible
disclosure). The responsible disclosure started on April the 19th 2024 and Inﬁneon conﬁrmed
(July 26th, 2024) that they have implemented and tested a patch to their library, eliminating
the attack threat.

Necessary information about FIDO protocol, ECDSA and our side-channel acquisition chain
are presented in the remainder of this introduction while the following chapters present, in all
technical details:

• a ﬁrst side-channel reverse-engineering of the ECDSA implementation, and more partic-
ularly of the nonce modular inversion, leading to the identiﬁcation of a sensitive leakage
(Chapter 2);

• the design of a generic and ﬂexible side-channel attack on the Extended Euclidean Algo-

rithm (Chapter 3);

• a deeper reverse-engineering of Inﬁneon implementation to uncover stronger sensitive leak-

ages (Chapter 4);

• the successful application of the attack on Feitian A22 JavaCard and YubiKey 5Ci prod-

ucts (Chapter 5);

• the demonstration that this vulnerability is not limited to SLE78 but also to all the subse-

quent families of Inﬁneon security microcontrollers (Chapter 6).

Finally, Chapter 7 presents the attack impact analysis (by no means comprehensive), a simple
mitigation solution that Inﬁneon chose to follow, several directions of research opened by this
work and ﬁnally the whole project timeline.

1.2 FIDO Hardware Tokens

FIDO Hardware tokens are USB and/or NFC devices (sometimes Bluetooth) that allow a user
to setup a factor of authentication while sign in to a web service account that supports FIDO
protocol 14 (e.g. a Google account). This authentication factor can be added to a traditional
login/password authentication (in that case our attack requires that the attacker also knows the
login/password of the target, e.g. using phishing) or as a unique factor of authentication (as
speciﬁed in the FIDO2 protocol and often refereed to as the FIDO2 Passwordless Authentication
or Passkey functionality).

For the purpose of this document, we do not need to go into the details of the FIDO protocol –
interested readers can have a look to [19] where we took some time to explain the basic principles.
Here, what we need to know can be summarized as follows 15:

• when registering a new FIDO token in the user account, an ECDSA key pair is generated
inside the device. The device sends to the remote server the public key and stores the
private key;

12https://www.bsi.bund.de/DE/Home/home_node.html
13https://cyber.gouv.fr/
14See https://www.yubico.com/works-with-yubikey/catalog/ for a list of almost all applications supporting

FIDO protocol

15The ECDSA scheme is formally described in Section 1.4

10

• when signing in, the remote sever sends a challenge that is signed by the FIDO token using
the associated private key. The remote server can conﬁrm the presence of the token by
verifying the signature (using the public key shared during the registration phase).

Side-channel attack scenario Here is a natural side-channel attack scenario (as proposed
initially in [19]):

1. the adversary steals the login and password of a victim’s application account protected

with FIDO (e.g. via a phishing attack);

2. the adversary gets physical access to the victim’s device during a limited time frame,

without the victim noticing;

3. thanks to the stolen victim’s login and password (for a given application account), the
adversary sends the authentication request to the device as many time as necessary16 while
performing side-channel measurements;

4. the adversary quietly gives back the FIDO device to the victim;

5. the adversary performs a side-channel attack over the measurements, and succeeds in ex-

tracting the ECDSA private key linked to the victim’s application account;

6. the adversary can sign in to the victim’s application account without the FIDO device,
and without the victim noticing. In other words the adversary created a clone of the FIDO
device for the victim’s application account. This clone will give access to the application
account as long as the legitimate user does not revoke its authentication credentials.

While the ﬁrst version of the Google Titan security key embeds a P5x secure element from
NXP, Yubico – the leader of FIDO hardware tokens – relies on the more recent SLE78 secure
element from Inﬁneon. One of the advantages of the SLE78 chip is that there exists a USB
version, allowing to build a USB secure token with a single chip (the SLE78 handling both the
secure element functionalities and the USB communication). This is the ”industry’s ﬁrst FIDO2
certiﬁed Reference Design based on the SLE78 single-chip solution” 17 and seems pretty attractive
for designing FIDO hardware token. Also, compared to NXP P5x secure elements, the SLE78
family is more recent and has still active AVA VAN 5 (and in fact EAL 6+) CC certiﬁcates.

For the interested readers of an overview of the internals of many FIDO hardware tokens,
we strongly encourage to have a look to Victor Lomn´e presentation at Hardwear.io NL 2022
conference [18]. Figure 1.1 is directly taken from this presentation and shows the teardown of
all YubiKey 5 Series. All of them embed an Inﬁneon SLE78CLUFX5000 secure microcontroller,
this will be our new target of investigation. However, the FIDO protocol does not allow to
choose (or even know) any private key generated inside the device. To ease the understanding of
Inﬁneon implementation and the research of a vulnerability, we ﬁrst need to ﬁnd a product where
one can know the private key, also called a training device (this was also the direction chosen
in [19], with success). We then ﬁrst look for a JavaCard open platform that embed a SLE78,
indeed JavaCard open platforms oﬀer a richer user cryptographic API through the development
of JavaCard applets.

16This can be done while actually signing in to the remote server or not. In the former case, this would make
the FIDO counter countermeasure useless but necessitate to have either a small number of ECDSA executions to
perform or a lot of time.

17https://fidoalliance.org/tech-industry-leaders-ship-fido2-certified-solutions-to-reduce-

password-use-on-the-web/

11

Figure 1.1: YubiKey 5 Series Teardowns

1.3

Inﬁneon SLE78

When considering only AVA VAN 5 secure elements (i.e. the most secure chips that exist), the
Inﬁneon SLE78 family is one of the most common in the ﬁeld. It has been designed for banking
and ID applications and successfully took an important market share. The microcontroller is a
proprietary design from Inﬁneon, from the many public CC certiﬁcation reports of chips from
the SL78 family 18, we have:

”The [SLE78] provides a real 16-bit CPU-architecture and is compatible to the
Intel 80251 architecture. The major components of the core system are the dual
CPU (Central Processing Units), the MMU (Memory Management Unit) and MED
(Memory Encryption/Decryption Unit). The dual interface controller is able to com-
municate using either the contact based or the contactless interface.”

Inﬁneon SLE78, like any secure element, embeds several dedicated hardware cryptographic
co-processors, notably a modular arithmetic co-processor which can be used, though a crypto-
graphic library (we will sometimes use cryptolib, for short), to securly (and eﬃciently) execute
public-key cryptography like RSA or ECC. Inﬁneon provides an optional cryptolib implementing
such cryptographic operations.

The YubiKey 5 Series are based on a SLE78 IC version M7893 B11 with Inﬁneon EC
cryptolib version 1.03.006 19, information that can be found in the ANSSI CSPN (Certiﬁcat de
S´ecurit´e de Premier Niveau) security target document 20.

18See e.g.
0782V5a_pdf

https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Zertifizierung/Reporte/Reporte07/

19M7893 B11 with EC library v1.03.006: last CC certiﬁcation (EAL6+) in 2018, https://www.bsi.bund.de/

SharedDocs/Downloads/DE/BSI/Zertifizierung/Reporte/Reporte08/0879V3a_pdf

20https://cyber.gouv.fr/sites/default/files/2021/09/anssi-cible-cspn-2021_18en.pdf, page 18, Table

5

12

1.3.1

Feitian A22 JavaCard

When looking for JavaCard open platforms that embed a SLE78, the Feitian A22 JavaCard
product was cheap and easy to purchase (see Figure 1.2 from SmartCard Focus reseller site 21).

Figure 1.2: Feitian A22 JavaCard – Screenshot from SmartCard Focus

On a JavaCard open platform, we can develop and push our own JavaCard applet and run
all cryptographic primitives supported by the JavaCard API and implemented by the JavaCard
OS of the card. This JavaCard (or a similar one from Feitian) has been certiﬁed EAL5+ under
Common Criteria 22. This certiﬁcation is from 2018 and involves SLE78 IC version M7892 B11
with Inﬁneon EC cryptolib version 1.02.013 23.

This is not exactly the same SLE78 hardware version nor cryptolib version than the YubiKey

5 Series, we will assume it is close enough.

On Feitian A22 JavaCard, the JavaCard OS happens to follow JavaCard 2.2.2 speciﬁca-
tions [24], we hence developed and loaded a custom JavaCard applet 24 allowing us to freely
control the JavaCard ECDSA signature engine on Feitian A22 JavaCard. More precisely, we
can load chosen long term ECDSA private keys, perform ECDSA signatures and ECDSA signa-
ture veriﬁcations.

1.4 Elliptic Curve Digital Signature Algorithm

In this section we recall some basic information about ECDSA as well as introduce the notations
we will use in this document. It is worth noting here that the FIDO protocol is speciﬁed on the
256-bit elliptic curve P256 [23], and then, w.l.o.g., all our tests are done on this curve. Hence,
for our simulations, the elliptic curve order N is that of P256 curve and the nonce k is always a
random of binary size up to 256 bits.

21https://www.smartcardfocus.com/shop/ilp/id~712/javacos-a22-dual-interface-java-card-150k/p/
22https://www.commoncriteriaportal.org/files/epfiles/SERTIT-091CRFeitianv1.0.pdf
23M7892 B11 with EC library v1.02.013: last CC certiﬁcation (EAL6+) in 2020, https://www.bsi.bund.de/

SharedDocs/Downloads/DE/BSI/Zertifizierung/Reporte/Reporte07/0782V5a_pdf

24Thanks notably to the great open-source project for building JavaCard applets [20]

13

1.4.1 ECDSA Signature Scheme

The ECDSA signature scheme is the main target of our attack. Here is a rough sketch of the
scheme (taken from [19] with slightly diﬀerent notations):

• elliptic curve E over prime ﬁeld Fp, elliptic curve base point is G(x,y) of order N
• inputs: long term private key d, hash digest of the input message to sign h = H(m)

1. randomly generate a nonce k in Z/N Z

2. scalar multiplication Q(x,y) = [k]G(x,y)

3. denote by r the x-coordinate of Q: r = Qx

4. compute s = k−1(h + rd) mod N

• output: (r,s)

First Remark: We can ﬁnd the nonce k from the signature (r, s) of digest h with the knowledge
of the private key d:

k = s−1(h + rd) mod N

(1.1)

Inversely, knowing the nonce k is enough to ﬁnd the private key d:

d = r−1(ks − h) mod N

Second Remark: An usual countermeasure against side-channel analysis is to randomize the
base point at each scalar multiplication (see [3]). So instead of computing directly the scalar
multiplication [k]G(x,y) on the aﬃne coordinates of G, one might uses the projective coordinates
of G:

1. randomly generate a random z in Fp

2. send G(x,y) to its projective coordinates (xz, yz, z)

3. compute Q(x,y,z) = [k]G(x,y,z)

4. get the x aﬃne coordinate of Q(x,y,z): r = x/z mod p

1.4.2 ECDSA Signature Veriﬁcation Scheme

As mentioned before, one great advantage of working on the Feitian A22 JavaCard is the possi-
bility to run the ECDSA signature veriﬁcation algorithm (and not only the signature algorithm as
on YubiKey 5 Series). As we will see, the signature veriﬁcation algorithm requires to compute
similar operations than in the signature algorithm, this might provide additional information
on their implementation. Moreover, developers might downgrade countermeasures to improve
the execution time. Indeed, the signature veriﬁcation algorithm does not involve any secret and
then side-channel or fault injection countermeasures seem useless speed reducers. For reverse
engineering however, such a countermeasure downgrade is a windfall, it provides the opportunity
to learn a lot on the implementation and its countermeasures.

Here is a rough sketch of the ECDSA signature veriﬁcation scheme (taken from [19] with

slightly diﬀerent notations):

14

• elliptic curve E over prime ﬁeld Fp, elliptic curve base point is G(x,y) and order is N
• inputs: public key P(x,y), the hash of the signed input message h = H(m)
• inputs: the signature to be veriﬁed (r, s)

1. compute ﬁrst scalar k(1) = s−1r mod N

2. compute second scalar k(2) = s−1h mod N

3. ﬁrst scalar multiplication Q(1)

(x,y) = [k(1)]P(x,y)

4. second scalar multiplication Q(2)

(x,y) = [k(2)]G(x,y)

5. compute ¯r = Q(1)

x + Q(2)

x mod N

6. check that ¯r = r

First Remark: One can compute k(1) and k(2) from the public inputs.

Second Remark: The two scalar multiplications can be executed in a single pass using a double
scalar multiplication approach. One way to do so is to pre-compute Q(x,y) = P(x,y) + G(x,y) and
then follow a simple double-and-add algorithm where, at each iteration, one bit of k(1) and one
bit of k(2) are processed.

1.5 Side-Channel Setup and First Observations

Let us brieﬂy present the side-channel setup we used for our analysis.

1.5.1 Side-Channel Setup

In order to perform electromagnetic (EM for short) side-channel measurements over the two
targets, we used the following hardware parts:

• Langer ICR HH 500-6 near-ﬁeld EM probe with an horizontal coil of diameter 500µm and

a frequency bandwidth from 2MHz to 6GHz with its Langer BT 706 bias-tee [15];

• Thorlabs PT3/M three axes (X-Y-Z) manual micro-manipulator with a precision of 10µm [28];

• Dino-Lite digital microscope AM4113TL [4];

• Pico Technology PicoScope 6424E oscilloscope [25], with a 500MHz frequency bandwidth,
sampling rate up to 5GSa/s, 4 channels, a shared channel memory of 4G samples max.
and 8-bit to 12-bit ADC resolution;

• LeCroy WavePro 254HD oscilloscope, with a 2.5GHz frequency bandwidth, sampling rate
up to 20GSa/s, 4 channels and a memory of 5G samples max. per channel with 12-bit
ADC resolution [16];

• Ledger Scaﬀold electronic board [17].

15

Note that the cost of this setup is about 10ke (including the cost of the computer used for
processing side-channel measurements). The LeCroy WavePro oscilloscope with 12-bit resolution
raises the cost (it has been used for the Yubikey acquisitions) by about 30ke, but we are conﬁdent
that the PicoScope set with 8-bit ADC resolution would have been completely suﬃcient for the
attack.

1.5.2

YubiKey 5Ci

Accessing the SLE78 on a YubiKey requires to open the plastic case and access the logic board.
From Victor Lomn´e teardowns of the whole family of YubiKey 5 Series (see Figure 1.1 and
[18]), the YubiKey 5Ci seemed in good shape, so we selected it (see Figure 1.3). At the end of
this project, we wanted to estimate the diﬃculty for an attacker to remove the plastic case of a
YubiKey. However, by that time (two years have passed), Victor did not remember how hard it
was. From Figure 1.1 one can tell that the NFC and FIPS version of the YubiKey were quite
diﬃcult to open and the result leads (in the case of Victor’s not so careful opening) to destroy
the product. However, for the rest, it is diﬃcult to tell. So we bought two new YubiKey 5C from
Yubico. The package opening of these two devices is presented in Annex A. This study was done
after the YubiKey 5.7 ﬁrmware update of the 6th May 2024 that moves the ﬁrmware to a new
cryptography library 25.

We hence could validate, by the observation of the side-channel execution traces of these new
devices, that the new implementation is not vulnerable to the attack presented in this report.

Figure 1.3: YubiKey 5Ci – Teardown

The EM acquisition setup is depicted on Figure 1.4, with the correct position of the EM

probe to acquire the signal.

25https://www.yubico.com/blog/empowering-enterprise-security-at-scale-with-new-product-

innovations-yubikey-5-7-and-yubico-authenticator-7/

16

Figure 1.4: YubiKey 5Ci – EM Acquisition Setup

Figure 1.5 shows a side-channel execution trace of an ECDSA signature acquired with the
above setup. The acquisition is triggered directly from the EM signal, on a pattern present
at the beginning of the EM activity of the command processing the authentication request
message of the FIDO protocol.

Figure 1.5: YubiKey 5Ci – EM Traces – ECDSA Signature

1.5.3

Feitian A22 JavaCard

To communicate and acquire both power and EM side-channels from the Feitian A22 JavaCard,
we use the Ledger Scaﬀold electronic board [17]. It provides several features really useful for
side-channel attacks:

• native support of ISO7816, with possibility to easily spy all digital signals of the protocol

thanks to SMA connectors (RESET, CLOCK and DATA);

• triggering capabilities easily conﬁgurable either on the APDU header processing, or on the

APDU command processing;

17

• power measurement capabilities thanks to a clean PCB design, and a potentiometer al-
lowing to manually adapt the gain of the measured power consumption thanks to a screw.
Furthermore it is possible to activate 1kOhm resistors placed in serial on the ISO7816
digital signals, allowing to reduce the activity of the ISO7816 clock in the measured power
consumption;

• the Ledger Scaﬀold is physically made of two parts: one motherboard (main part of Scaf-
fold including the FPGA driving the board, all the electronic circuitry and the diﬀerent
connectors) and one daughter board (used to connect the target, and being interchange-
able). Thus one can easily develop new daughter boards, for instance for having access to
the diﬀerent sides of the target. This is what NinjaLab has done with a custom smartcard
daughter board that gives access to the opened side of the smartcard (see Figure 1.6).

The full setup is shown on Figure 1.6, to access the die we simply remove the white plastic
of the smartcard above the die with a scalpel, we hence have access to its front side. The right
subﬁgure shows the EM probe position over the die.

Figure 1.6: Feitian A22 JavaCard – EM Acquisition Setup

Figure 1.7 depicts a side-channel execution trace of an ECDSA signature acquired with the
above setup. The acquisition is triggered thanks to the Scaﬀold board on the last byte of the
ECDSA signature APDU command sent. On the ﬁgure, we identiﬁed the three major steps of
ECDSA signature:

1. Initialization and generation of nonce k and random projective coordinate z

2. Scalar multiplication Q(x,y,z) = [k]G(x,y,z)

3. Computation of the signature (r, s) from Q(x,y,z), h, d, k

18

z, k

Q = [k]G(x,y,z)

(r, s)

Figure 1.7: Feitian A22 JavaCard – EM Traces – ECDSA Signature

The Feitian A22 JavaCard and YubiKey 5Ci ECDSA signature EM activities look very
similar, we will then work on Feitian A22 JavaCard and try to ﬁnd a weakness in Inﬁneon
implementation. After fruitless attempts to ﬁnd a vulnerability in the scalar multiplication, we
focused our eﬀort on the end of the computation and more precisely the nonce modular inversion
because of a surprisingly not constant-time operation.

1.5.4 Focus on the Nonce Modular Inversion

Figure 1.8 is a zoom into the end of the ECDSA signature EM activity. The computation of
(r, s) from [k]G(x,y,z), k, h, d amounts to:

• r = z−1x mod p

• s = k−1(h + rd) mod N

It seems pretty obvious to us that the two similar shaped operations (identiﬁed on Figure 1.8)
correspond to the two modular inversions (which are the most complicated operations in the
computation of (r, s)). Moreover, when observing several ECDSA signature executions, these
operations seem to have diﬀerent execution times.

z−1 mod p

k−1 mod N

Figure 1.8: Feitian A22 JavaCard – EM Traces – ECDSA Signature – (r, s) Computation

This observation is the beginning of a journey that will take two years to complete and a lot
of eﬀorts and disappointments but ﬁnally a success. This document tries to report this journey
in its many details.

19

Chapter 2

Reverse-Engineering of the
Modular Inversion

As mentioned in Chapter 1, we decided to analyze the nonce modular inversion of the Inﬁneon
ECDSA implementation due to the presence of a timing leakage. A timing leakage does not
necessary mean that there is a vulnerability but it is surprising for such a sensitive operation.
Indeed, revealing even a small number of bits of the nonce for several ECDSA signatures is enough
for a complete key-recovery attack thanks to lattice reduction techniques (initially proposed in
[10] and applied in many practical attacks since).

2.1 ECDSA Signature Traces

First, 1000 EM side-channel traces of ECDSA signature are acquired with the Feitian A22
JavaCard setup. For completeness, the acquisition details are given in Table 2.1. 1000 EM
side-channel traces of the full ECDSA signature execution are acquired in about 7 hours.

2.1.1 Acquisition Campaign

operation
equipment
inputs
number of operations
length
sampling rate
samples per trace
channel(s)
channel(s) parameters
ﬁle size
acquisition time

ECDSA signature
PicoScope 6424E, Langer ICR HH 500-06
Messages are random, Key is constant (randomly chosen)
1000
120ms
5GSa/s
600MSamples
EM activity
DC 50ohms, [−120, 80]mV
600GB
about 7 hours

Table 2.1: Acquisition parameters on Feitian A22 JavaCard – ECDSA Signature

20

Figure 2.1 shows a single side-channel execution trace, where the modular inversion patterns
are identiﬁed. We suppose that the second pattern corresponds to the nonce inversion and the
ﬁrst one (the closest to the scalar multiplication) relates to the inversion of the third projective
coordinate of the resulting point Q. It just makes more sense but the operations could be done
the other way around.

z, k

Q = [k]G(x,y,z)

(r, s)

zoom

z−1 mod p

k−1 mod N

zoom

Figure 2.1: Feitian A22 JavaCard – ECDSA Signature – Full Trace (Top) - (r, s) Computation
(Middle) - k−1 mod N Computation (Bottom)

2.1.2 Side-Channel Analysis

Now that we have many executions for various values of the nonce k (which is known here since
the private key d is known, thanks to equation 1.1), let us look into the EM signal. Figure 2.2
bottom subﬁgure shows that the computation is an iterative process. Moreover, the process is
regularly paused (as we can see on the ﬁgure). These pauses are quite easy to automatically
detect (specially because they occur at a pretty stable period), the two black dots on the ﬁgure
illustrate this automatic detection.

21

k−1 mod N

zoom

Figure 2.2: Feitian A22 JavaCard – ECDSA Signature – k−1 mod N Computation (Top) -
Zoom on Few Iterations (Bottom)

Figure 2.3 shows the result of this detection over the whole operation (top subﬁgure). Our
ﬁrst step is simply to remove these pauses as we suspect they are not related to the computation
but to regular interrupts of the microcontroller. The second subﬁgure depicts a single subtrace
(corresponding to the suspected modular inversion) after the removal of all pauses.

22

k−1 mod N

Figure 2.3: Feitian A22 JavaCard – ECDSA Signature – k−1 mod N Computation – Interrup-
tions Detection (Top) - Cleaned Trace (Bottom)

The next step is to detect all the operation iterations, this is done over all the 1000 ECDSA
executions. The result is illustrated on Figure 2.4 ﬁrst subﬁgure where each iteration is detected
through the research of two anchors: the blue and black dots (see the second subﬁgure). This
detection process is simply based on the amplitude of the signal and approximate length of an
iteration. We cannot tell if the detection works perfectly over the whole set of 1000 traces but
random visual checks over some traces make us pretty conﬁdent that we are not too wrong. One
can also remark that some iterations are longer than others (or are preceded by pauses), as we
can see in the middle of the second subﬁgure.

23

k−1 mod N

zoom

Figure 2.4: Feitian A22 JavaCard – ECDSA Signature – k−1 mod N Computation – Iterations
Detection (Top) - Zoom on Few Iterations (Bottom)

Now we have a precise estimate of the number of iterations of a modular iteration, we can
validate that this number changes from one ECDSA execution to the other. When considering
a modular inversion that is not constant time, our ﬁrst hypothesis is the Extended Euclidean
Algorithm (EEA for short).

2.1.3 First Hypothesis: Extended Euclidean Algorithm

Algorithm 1 recalls the computation of a modular inversion with the textbook EEA (there are
many versions of the EEA and notably the binary version, but here the number of iterations
observed would better match the classical EEA). If our hypothesis is correct, then the number
of iterations detected previously should match the Algorithm 1 while loop iteration number (for
the right inputs (k, N ), where k is the nonce and N is the order of the elliptic curve). However,
while the iteration count of EEA(k, N ) (based on Algorithm 1) is always close to the number of
detected iterations in the side-channel traces, it does not match exactly.

24

Algorithm 1: Extended Euclidean Algorithm for Modular Inversion
Input : v, n: two positive integers with v ≤ n and gcd(v, n) = 1
Output: v−1 mod n: the inverse of v modulo n

1 r0, r1 ← n, v
2 t0, t1 ← 0, 1
3 while r1 ̸= 0 do
4

5

q ← div(r0, r1)
r0, r1 ← r1, r0 − q.r1
t0, t1 ← t1, t0 − q.t1

6
7 end
8 if t0 < 0 then
t0 ← t0 + n
9
10 end
11 return t0

When plotting the distribution of the number of iterations over the 1000 observed operations
with regard to the distribution of the number of iterations of random calls to EEA(x, N ) with x
a random value of same size as k, one can tell that the distribution matches. This is illustrated
on Figure 2.5, conﬁrming that we are observing the execution of an EEA, but not with the value
of k.

Figure 2.5: Feitian A22 JavaCard – ECDSA Signature – k−1 mod N Computation – Distribu-
tion of the Number of Iterations – Observations (Blue) - EEA Simulations (Orange)

After checking that the ﬁrst modular inversion pattern was not the correct one (the inversion
of z and k could have been done in the unnatural way), the next hypothesis is the presence of a
side-channel countermeasure:

25

Hypothesis: k is blinded before its inversion.

This would make an attack much harder (and maybe impossible if the mask is large enough).
Validating this hypothesis seems quite far-reaching, we rather ﬁrst validate once for all that the
identiﬁed operation is really a modular inversion using EEA before going deeper in this direction.
One way to do so is to study the ECDSA signature veriﬁcation execution.

2.2 ECDSA Signature Veriﬁcation Traces

The ECDSA signature veriﬁcation scheme involves the modular inversion of a public value (see
the s−1 mod N operation in the introductory chapter, Section 1.4.2). Let us bet that the devel-
oper did not protect this operation since it does not involve any secret.

2.2.1 Acquisition Campaign

The acquisition campaign for the ECDSA signature veriﬁcation operation is quite similar to that
of the ECDSA signature operation, full details are given in Table 2.2. A single side-channel
execution trace is displayed in Figure 2.6.

operation
equipment
inputs
number of operations
length
sampling rate
samples per trace
channel(s)
channel(s) parameters
ﬁle size
acquisition time

ECDSA signature veriﬁcation
PicoScope 6424E, Langer ICR HH 500-06
Messages are random, Signature generated from a constant Key
1000
160ms
5GSa/s
800MSamples
EM activity
DC 50ohms, [−120, 80]mV
800GB
about 7 hours

Table 2.2: Acquisition parameters on Feitian A22 JavaCard – ECDSA Signature Veriﬁcation

Figure 2.6: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – Full Trace

26

2.2.2 Side-Channel Analysis

The analysis of the side-channel traces tells us the following (as illustrated in Figure 2.7):

• the ﬁrst long operation is a secure scalar multiplication (very similar to the one observed
in the ECDSA signature traces), we do not know its purpose. Maybe to check that the
point P is on the curve (even though this seems a bit overkill);

• knowing the values k(1) and k(2) and observing the sequence of doubling and addition
operations, it was easy to conﬁrm that the last operation is a double scalar multiplication
based on an unbalanced (i.e. naive) double-and-add algorithm;

• between the two scalar multiplication operations lies two modular inversion patterns similar
to those of the signature algorithm. The ﬁrst one is certainly owned by the previous scalar
multiplication while the second one should be the computation of s−1 mod N .

[q]P(x,y,z) = O

Q(x,y) = [k(1)]G(x,y) + [k(2)]P(x,y)

zoom

z−1 mod p

s−1 mod N

zoom

Figure 2.7: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – Full Trace (Top) - Zoom
Between the Scalar Multiplications (Middle) - s−1 mod N Computation (Bottom)

27

After the cleaning process of removing the interrupts (see Figure 2.8) and detecting each
iteration (as illustrated in Figure 2.9) we could validate that the number of iterations perfectly
matches the EEA number of iterations. This conﬁrms without any doubt that the observed process
is the EEA and let the hypothesis of a blinding countermeasure in the signature algorithm open.

s−1 mod N

Figure 2.8: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – s−1 mod N Computation
– Interruptions Detection (Top) - Cleaned Trace (Bottom)

28

s−1 mod N

zoom

Figure 2.9: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – s−1 mod N Computation
– Iterations Detection (Top) - Zoom on Few Iterations (Bottom)

Before coming back to the signature algorithm, we could relate the large iterations occurrence
(as identiﬁed by the orange boxes on Figure 2.9, second subﬁgure) to the inner values of the EEA
computation: the iteration is large if (and only if) the binary length diﬀerence between r0 and
r1 (as computed in Algorithm 1, line 4) is larger than 5. In all the following we will denote the
binary length diﬀerence between r0 and r1 as:

∆r0,r1 = len(r0) − len(r1).

2.2.3 A Timing Leakage

We have seen that the computation length of the inner iterations of the EEA is related to the
value ∆r0,r1 taken at the beginning of the iteration: the iteration is larger when ∆r0,r1 > 5.
In fact, the timing leakage is stronger than that. Figure 2.10 shows four consecutive iterations
(none of them are large, i.e. ∆r0,r1 ≤ 5), two observations can be made:

• Odd versus Even iterations are diﬀerent, we will have to treat them diﬀerently (and have

no explanation for this observation);

• a small part at the beginning of each iteration is varying in length (identiﬁed with orange

boxes).

29

Even

Odd

Even

Odd

Figure 2.10: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – s−1 mod N – Four Con-
secutive Iterations

Thanks to the ∆r0,r1 > 5 timing leakage that stands out clearly, we easily found out that
the execution time is directly proportional to the value ∆r0,r1 as displayed on Figure 2.11 where
iterations are synchronized and regrouped with constant values of ∆r0,r1 .

30

∆r0,r1 = 0

∆r0,r1 = 1

∆r0,r1 = 2

Figure 2.11: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – 100 Superposed Odd
Iterations – ∆r0,r1 = 0 (Top) - ∆r0,r1 = 1 (Middle) - ∆r0,r1 = 2 (Bottom)

2.3 Reverse-Engineering of the Modular Inversion Coun-

termeasure

Let us now get back to the blinding countermeasure hypothesis and try to conﬁrm and better
understand it.

2.3.1 Hypothesis

A simple and cost-eﬀective way to protect the modular inversion of the nonce in ECDSA is to use
a multiplicative mask. Hence, instead of computing directly the inverse of k, one can compute
the inverse of k′ deﬁned as:

k′ = m × k mod N,

where m is a non-null positive integer. Once inverted, k−1 mod N can be easily computed from
k′−1 mod N by another modular multiplication by m.

31

This countermeasure seems really interesting because it only costs 2 modular multiplica-
tions (a quite cheap operation when the secure microcontroller embeds a modular arithmetic
co-processor) to protect a modular inversion (a much more expensive operation). Also, if we
consider that m is generated with a similar entropy than k itself, retrieving k′ by side-channel
analysis would provide zero information about the nonce value k and then the attack would be
meaningless. However, the real cost of the countermeasure lies in the generation of m and if the
random number generator is expensive, it might be tempting to reduce the size of m.

Now, let us suppose that Inﬁneon developers decided to reduce the length of m to something
small enough to be brute-forced, then by retrieving k′ by side-channel analysis one could brute
force the value of k and then recover the ECDSA long term private key. So let us hope for the
best (adversary-wise) and try to validate this.

2.3.2 Brute-force Experiments

We build an experiment that would validate that the multiplicative mask is small:

Since the private key is known on the Feitian A22 JavaCard setup, we can compute, for
each ECDSA execution, the nonce value k (as per equation 1.1). We are looking for the value
of the mask m such that k′ = m × k mod N . To discriminate the possible values of m we have
the information extracted from the side-channel execution traces of EEA(k′, N ). In a preliminary
test, we decided to test all non-zero values of m of binary length 32 or less. We then select a
mask candidate m if EEA(m × k mod N, N ) has the exact same number of iterations than the
side-channel execution trace of EEA(k′, N ) and if the number and positions of the large iterations
(i.e. iterations for which ∆r0,r1 > 5) also matche. We apply this process to the ﬁrst 10 traces of
the signature acquisition campaign. At the end of this 32-bit brute-force, we end-up with:

• 3 mask candidates for the ﬁrst trace;

• 38035 mask candidates for the 10th trace;

• a unique mask candidate for the other 8 traces.

The 10th trace only shows a single large iteration (∆r0,r1 > 5), the ﬁrst trace has 4 such
iterations, all other traces have 4 or more large iterations. Since our mask detection is mainly
based on the position of these large iterations, it makes quite sense that the more an EEA execu-
tion shows large iterations, the fewer mask candidates are left. The fact that, for all 10 traces,
there exists at least one mask candidate left is very promising and comforts ourselves in the
assumption that Inﬁneon uses a multiplicative mask countermeasure with a 32-bit mask.

Now we have seen in the previous section that a ﬁner-grain timing leakage appears for each
iteration. We can use this leakage to try and discriminate one mask candidate among several.
To do so, we automatically identify the timing leakage start and end positions (as illustrated
in Figure 2.11) for each iteration of the ﬁrst 10 ECDSA side-channel execution traces. This
detection, without being perfect, works well enoug for our test. We then have, for all iterations,
the length (in time samples) of the timing leakage area. We previously observed that this area
length is proportional to the value ∆r0,r1 . A good way to capture this linear relation is to use
the Pearson correlation [8], we then compute the Pearson correlation ρ between the sequence
of ∆r0,r1 values computed from the execution simulation of EEA(m × k mod N, N ) for a mask
candidate m and the observed sequence of time sample lengths extracted from the side-channel

32

execution trace of EEA(k′, N ) (and denoted {Li}0<i≤n for an n iterations EEA).

Figure 2.12 displays the Pearson correlation results for each candidate of each trace 1 (each
trace has a diﬀerent color, e.g. the blue dots represent the 10th trace with all its 38K mask
candidates). It appears clearly that, for each trace, a single mask candidate stands out clearly
with a high correlation (ρ > 0.7) while all other candidates stays well below ρ < 0.5.

Figure 2.12: Feitian A22 JavaCard – Modular Inversion Multiplicative Mask Brute Force –
Pearson Correlation Results ρ({∆r0,r1 i}0<i≤n, {Li}0<i≤n)

This experiment, without being a formal proof, ﬁnishes to convince us that we have under-

stood the masking countermeasure of Inﬁneon to protect the modular inversion of the nonce.

2.4 Conclusions

Algorithm 1 is validated, the nonce is blinded with a multiplicative mask of size 32 bits (and
odd). Moreover, we identiﬁed a timing leakage proportional with ∆r0,r1 = len(r0) − len(r1) (r0
and r1 appearing in line 4 of Algorithm 1). In the next chapter, we will consider a side-channel
attacker able to soundly (i.e. without error) extract the value ∆r0,r1 for each and every iteration
of an EEA execution.

1We randomly spread the correlation results over the y-axis following a Gaussian distribution of mean 0 and

standard deviation 10−2 for illustration purpose.

33

Chapter 3

Input-Recovery Attack on the
Extended Euclidean Algorithm

Let us recall the EEA algorithm here:

Algorithm 1: Extended Euclidean Algorithm for Modular Inversion (repeated from
page 25)

Input : v, n: two positive integers with v ≤ n and gcd(v, n) = 1
Output: v−1 mod n: the inverse of v modulo n

1 r0, r1 ← n, v
2 t0, t1 ← 0, 1
3 while r1 ̸= 0 do
4

5

q ← div(r0, r1)
r0, r1 ← r1, r0 − q.r1
t0, t1 ← t1, t0 − q.t1

6
7 end
8 if t0 < 0 then
t0 ← t0 + n
9
10 end
11 return t0

This algorithm is applied to the input pair (k′, N ), where k′ is the unknown masked nonce

and N is the public elliptic curve order (of elliptic curve P256 [23] for our tests).

3.1 First Observations

In the previous chapter, we identiﬁed a timing leakage that gives us, for each iteration of the
EEA, the binary length diﬀerence between r0 and r1 (appearing as inputs of the div call in Al-
gorithm 1, line 4) denoted ∆r0,r1 . Let us take a step back and consider the more general case
where the side-channel adversary is able to recover a function f of the input-pair (r0, r1) for each
iteration of the while loop.

It is quite easy to see that if the function f outputs enough information then an attacker
would be able to recover the two inputs (v, n) of the EEA. For instance, a simple case is when

34

the attacker is able to recover the quotient q (appearing in Algorithm 1, line 4) of the euclidean
division of r0 by r1 without error (i.e. f (r0, r1) = r0
= q). From the sequence of quotients
r1
{qi}0<i≤ℓ, there is a simple way to recover the two inputs (v, n) of the EEA:

In fact, since one of the two inputs is already known to the attacker (n = N , the order of
the elliptic curve), one can do even better than that. We only need about half of the quotient
2 ⌉ as they are enough to estimate a good approximation of the rational number
sequence {qi}0<i≤⌈ ℓ
n
v using continued fractions:

ℓ

n
v

(cid:18)

(cid:19)

=

i=1 (cid:18)
Y

qi
1

1
1
0
0
(cid:19) (cid:18)
(cid:19)

n
v

∼ q1 +

1

q2 + 1

q3+ 1
...

Since n is known, v can be correctly estimated by computing the right hand side of the equation
(up to q⌈ ℓ

2 ⌉) and estimating the value of v with a small margin of error 1.

However the above solution requires that the attacker has, at least, the knowledge of half of
the quotient sequence. Also, this information should not contain too many errors: a brute force
could cope with only a small amount of erroneous or missing quotients.

In the case where the attacker has less information (as in our case where f (r0, r1) = ∆r0,r1 )
or an information that does not contains the quotient value, there is no clear way to mount
an attack. Worse, if the attacker has access to more information than the quotient value, the
solution is to reduce this information to the quotient value and somehow loose the extra infor-
mation that could be helpful to handle some errors. When considering side-channel attack, the
information is often noisy (even with timing leakages) and handling errors is usually critical for
the practicality of the attack.

We then created a more ﬂexible attack process that can take a large class of leakage functions
f . It is based on the following assumption: the leakage function f (r0, r1) can be properly esti-
mated with the knowledge of the most-signiﬁcant-bits (msb for short) of r0 and r1. For instance
this is the case for f (r0, r1) = ∆r0,r1 or f (r0, r1) = q where, for long integers r0, r1, only their
msb will dictate the output of f (with high probability).

With this assumption, an attacker would be able to run through all the possible values that
the s-msb of k′ can take (i.e. 2s candidates) and, for each of them, predict the leakage (given a
leakage function f ) for the few ﬁrst iterations of EEA(k′, N ). By comparing the predicted leakage
to the observed leakage, the attacker might descriminate a small enough set of candidates. The
ℓ remaining candidates are then extended with all possible values for the next s bits, creating
a new list of candidates of size 2sℓ, each candidate being of length 2s bits. The prediction can
now go further through the iterations of EEA(k′, N ), and so on.

Before materializing this idea into an attack process, let us ﬁrst recall the Jebelean’s stop
condition in the following Theorem 1. It will be very useful in telling us, for each candidate msb
of k′, up to which EEA iteration we can predict meaningful leakage. In Theorem 1:

1This solution was actually proposed by Franck Rondepierre and Gu´ena¨el Renault from ANSSI, during the

responsible disclosure.

35

• the quotient sequence refers to the EEA quotient sequence;

• the {(ai, ai+1)} pairs sequence are the value taken by (r0, r1) in Algorithm 1;
• the {(vi, vi+1)} pairs sequence are the value taken by (t0, t1) in Algorithm 1;
• the {(ui, ui+1)} pairs sequence are the second B´ezout coeﬃcients sequence.

Theorem 1 ([14]’ Theorem 1) Let a > b > 0 be integers. Then
the k-length quotient sequences of (a, b) and (a2h + A′, b2h + B′) match
for any h > 0 and any A′, B′ < 2h

if and only if, for all i ≤ k

ai+1 ≥ −ui+1 and ai − ai+1 ≥ vi+1 − vi and i even
or
ai+1 ≥ −vi+1 and ai − ai+1 ≥ ui+1 − ui and i odd

From Theorem 1, one can easily tell when the EEA on the s-msb of (k′, N ) coincide (at least
in terms of quotient sequence) with the EEA on (k′, N ) without needing more knowledge than
the s-msb of (k′, N ).

3.2 Building a Generic Attack Algorithm

From the above observations, a basic attack algorithm can be sketched.

1. Select the brute-force parameter: a positive integer m.

2. Initialize an integer t = m and a list of integers L = {0}.

3. Denote by Nt the integer composed by the t most-signiﬁcant-bits of N and L′ an empty

list.

4. For all x ∈ L, for all g ∈ {0, · · · , 2m − 1}:

(a) v = x.2m + g;
(b) execute the EEA on (Nt, v) and, iﬀ Nt < N , stop when the Jebelean’s stop condition

is met;

(c) for each executed iteration of the truncated EEA, predict the leakage and compare it

to the extracted leakage;

(d) if the comparison is successful, add v to L′.

5. If Nt = N (i.e. t equals the bit length of N ) then return L′,
else t is increased by m, L takes L′ and go back to step 3.

Figure 3.1: A Generic Input-Recovery Side-Channel Attack on the EEA

Although arguably lacking elegance, the above attack algorithm has many advantages:

• it is completely generic with respect to the extracted leakages (one does not need to relate
the leakage to the EEA inputs as it was necessary with the previous analytical approach);

36

• the matching process between the extracted leakage and the predicted leakage can be
easily done so that some reasonable margin of errors is acceptable (in exchange to some
computational eﬀort). For instance, if for an iteration the leakage information is not
extractable (say the side-channel trace is not readable), all v candidates for this iteration
are accepted;

• at step 3, when t equals the bit length of n, the algorithm has merely checked the ﬁrst half
of the EEA iterations 2. The second half is then checked in a single pass and then, with
overwhelming probability, a unique element is added to L′ during this last pass (or none,
if there are too many errors in the extracted leakages) 3.

Let us now remark that this algorithm is more eﬃcient as m is small. Intuitively, one can
see that a small m provides a ﬁner grain: by setting m = 1, the algorithm will remove wrong
candidates as soon as possible and avoid unnecessary calls to the truncated EEA. Our simulations
show that for small values of m, the impact is not huge but gets more and more important as m
increases (m = 8 is already much more expensive than m = 4). So on the one hand, m = 1 should
be the most interesting choice but on the other hand, the 2m inner loop (step 4.) is the easiest
part of the algorithm for parallelization. Hence, in our practical tests, m = 4 was the best choice.

This basic attack algorithm has however three issues that all come from the use of the

Jebelean’s stop condition:

• in [14, Theorem 1], the (a, b) integers must be strictly greater than zero. In our attack
algorithm this means that – for the ﬁrst iteration – m must be greater than the binary
length diﬀerence between the two inputs (k′, N ) of the EEA, denoted ∆N,k. This binary
length diﬀerence might not be known (depending on the leaked information), a ﬁrst solution
would be to set m to be large enough so that it has great chances to be larger than ∆N,k.
However, as mentioned before, m should stay small (and is set to 4 in our tests). Our
solution will then be to test the attack iteratively for an increasing value of ∆N,k and handle
the ﬁrst iteration diﬀerently than the others (with a larger value for m when necessary);

• for speciﬁc choices of (a, b) the Jebelean’s stop condition is met too soon and the leakage
is not tested against the prediction. This artiﬁcially increases the candidate set with
pathological cases and then the overall attack complexity. Since the attack algorithm is
virtually scanning over all possible values of the unknown EEA input k′, these pathological
cases will necessary arise. This happens when a = b; when the case arises, we simply remove
a candidate v if v = Nt for t > 232 (we could increase to 264). The other pathological case
is when very large quotients appear at the end of the quotient sequence. Similarly to the
ﬁrst case, we can add a threshold Tq on the quotient value and remove a candidate that
creates a quotient sequence where a quotient is larger than Tq. Another, more subtle, way
to bypass this issue is to select the next candidate based on its last quotient value (the
smallest ﬁrst). This is what is presented in the next algorithm 2;

• Jebelean’s stop condition ensures that the quotient sequence is preserved. However, when
dealing with leaked information diﬀerent from the quotient values, (e.g. ∆r0,r1 ), this might
not be enough. This is the most problematic issue of using Jebelean’s stop condition and
we did not ﬁnd a perfect solution for that. Our idea is to estimate when we are far from

2This is actually a corollary of [14, Theorem 1] since, during the EEA (see Algorithm 1), |t1| will become
greater than r1 around the middle of execution and then the stop condition will always be met, whatever the
number of msb considered.

3This observation has led us to actually use a depth-ﬁrst version of the attack algorithm.

37

the stop condition with a simple metric. If we are far enough, one can check the leakage
against the prediction. Otherwise, if we are too close to the stop condition, then we can
only rely on the quotient values: we extract the list of all possible quotient values that
could lead to the observed leakage and check if the predicted quotient is in the list. For
instance, for a leakage function f (r0, r1) = ∆r0,r1 , all predicted quotients of binary length
∆r0,r1 or ∆r0,r1 + 1 are accepted.

Taking all these diﬀerent remarks into account, the following Algorithm 2 describes the full
attack process. It is based on the so called Truncated Extended Euclidean Algorithm, deﬁned in
Algorithm 3, that stops when the Jebelean stop condition is met.

Algorithm 2: A Generic Attack Algorithm

Input : {mstart, mnext}: a pair of brute-force parameters,
Input : {Li}0≤i<n: the leaked information from the execution of EEA(k′, N )
Input : f (.): the leakage function
Output: c: a candidate for k or Error if none found

1 L ← {(0, 0, −1)}
2 while True do
3

(c, t, q) ← L.pop()
if t = len(N ) then

// pop the first element of the list L
// len(x) returns the binary length of x

return c

else if t = 0 then
s, m ← 1, mstart

else

s, m ← 0, min(mnext, len(N ) − t)

end
Nt+m ← msbt+m(N )
for x ∈ [start, 2m] do
v ← c.2m + x
success, ˆq ← TEEA(v, Nt+m, {Li}0≤i<n, f )
if success then

// t + m msb of N

// call to Algorithm 3

Add tuple (v, t + m, ˆq) to L such that L stays sorted w.r.t. last element of the
tuple (ˆq).

end

4

5

6

7

8

9

10

11

12

13

14

15

16

17

end

18
19 end
20 return Error

38

Algorithm 3: Truncated Extended Euclidean Algorithm

Input : v: a candidate integer
Input : Nt: the t msb of N
Input : {Li}0≤i<n: the leaked information from the execution of EEA(k′, N )
Input : f (.): the leakage function
Output: success: True if the leakage matches the prediction, False otherwise
Output: ˆq: the last quotient of the predicted quotient sequence

if t > 32 then return (False, -1)
else return (True, 1)

1 t ← len(Nt)
2 T ← len(N )
3 if Nt = v then
4

5
6 end
7 r0, r1 ← Nt, v
8 t0, t1 ← 0, 1
9 s0, s1 ← 1, 0
10 step ← 0
11 F ailure ← 0
12 while r1 ̸= 0 do
13

q ← r0//r1
ˆL ← f (r0, r1)
r0, r1 ← r1, r0 − q.r1
t0, t1 ← t1, t0 − q.t1
s0, s1 ← s1, s0 − q.s1
if t < T then

// len(x) returns the binary length of x

// Leakage Prediction from (r0, r1)

// Test Jebelean’s stop condition

if step mod 2 = 1 then

stop cond ← not ((r1 ≥ −s1) and ((r0 − r1) ≥ (t1 − t0)))
stop dist ← min(len(r1) − len(−s1), len(r0 − r1) − len(t1 − t0))

else

stop cond ← not ((r1 ≥ −t1) and ((r0 − r1) ≥ (s1 − s0)))
stop dist ← min(len(r1) − len(−t1), len(r0 − r1) − len(s1 − s0))

end
if stop cond then

return (True, q)

end

end
if stop dist > T hr dist then

if ˆL ̸= Lstep then F ailure ← F ailure + 1

else

Lq ← {ˆq s.t. Lstep} // List all possible quotients compatible with Lstep
if q /∈ Lq then F ailure ← F ailure + 1

end
if (t < T and F ailure > T hr F ailure F H) or (t = T and F ailure > T hr F ailure)
then return (False, -1)

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

31

32

33

34

35

36

step ← step + 1

37
38 end
39 if step = n then return (True, 0)
40 else return (False, -1)

39

In Algorithm 2, adding a new tuple to the list is done such that the list stays sorted with
respect to the last quotient value. For equal values of quotients, the strategy is last added ﬁrst
out, but it is not clear if this is the best approach.

In Algorithm 3, three threshold values must be chosen (the T hr dist,

line 30, the
T hr F ailure F H and T hr F ailure, line 36). The choice of these thresholds is clearly dependent
on the nature (and quantity) of leaked information. In all our tests, we set T hr dist value to 8,
which seems to be enough in our cases. T hr F ailure F H, the number of accepted errors during
the ﬁrst half for the EEA iterations was set to 0 while T hr F ailure, the total number of accepted
errors was arbitrary set to 10 (as mentioned before, many leakage extraction errors in the second
half of the EEA execution can be tolerated).

3.3 Simulation Experiments

With the above attack process we can simulate the attack on random inputs k′ of size 256 bits. We
did that assuming the leakage of the quotient sequence (i.e. at iteration i, f (r0, r1) = Li = qi).
The attack process was always successful (which is not so surprising since we already have seen
that the quotient sequence if enough to recover the EEA inputs), the complexity of the attack is
given with respect to the number of calls to the Truncated EEA in Figure 3.2. In about 500 tests,
the observed attack complexity ranges from 220 to 230 calls. Interestingly, this complexity seems
to be directly related to the maximum quotient value appearing in the ﬁrst half of the quotient
sequence, more precisely the log complexity seems proportional to the log of the maximum
quotient value.

40

Figure 3.2: Simulation of the Generic Attack – Li = qi

Of course, we also simulated the attack assuming f (r0, r1) = ∆r0,r1 . None of these simula-
tions ever ended: the attack with less information than the quotient seems out of reach of our
computational power.

3.4 Conclusions

We have built a generic side-channel attack algorithm targeting the EEA. However, the identiﬁed
leakage does not seem to be enough for a practical input recovery. We let for future work the
theoretical analysis of this attack algorithm and the study of the minimum quantity of leaked
information necessary for the attack to succeed in practice.

So while all this was incredibly fun to do, at this point it seems a complete waste of our time!

Fortunately this attack process was not built in vain.

Indeed we eventually were able to
improve our understanding of the side-channel traces and Inﬁneon EEA implementation. This is
described in the next chapter.

41

Chapter 4

Full Reverse-Engineering of
Inﬁneon EEA

While working on a generic side-channel attack process, we realized that the identiﬁed leak will
not be enough for the attack to work in practice. We then came back to the side-channel traces
and looked for additional leakages.

4.1 More Timing Leakages

In fact, it was pretty clear that other timing leakages were present in the traces. Figure 4.1 ﬁrst
subﬁgure shows 100 superposed subtraces corresponding only to odd iterations of EEA executions
where ∆r0,r1 = 2. Similar behavior can be found with the even iterations. One can see that, if
the beginning of the subtraces are correctly aligned, the end of the iteration is desynchronized.

42

∆r0,r1 = 2

zoom

Figure 4.1: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – ∆r0,r1 = 2 – 100 Super-
posed Odd Iterations (Top) - A Single Trace, Zoom on the New Leakage Area (Bottom)

Focusing on the end of the computation, Figure 4.2 displays various shapes that can be found
at the end of the odd iterations with ∆r0,r1 = 2. This might well be additional leakage, but also
could come from another side-channel countermeasure that forces de-synchronization. Again, let
us hope for the best (adversary-wise) and try to give some sense to this behavior.

43

Figure 4.2: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – Odd Iteration with
∆r0,r1 = 2 – Various Shapes in the EM Signal

44

4.2 A Deep Dive into Euclidean Division Algorithms

4.2.1 First Steps

Let us ﬁrst prepare the subtraces for the analysis, we will need to have well aligned subtraces and
therefore improve our resynchronization algorithm. Figure 4.3 displays the side-channel trace
of the ﬁrst iterations of an EEA execution. One can see that the ﬁrst iteration does not have
the same shape as the others. This is always the case, we decided to remove the ﬁrst subtrace
from our analysis, in fact we will always consider that no information is extracted from the ﬁrst
iteration 1.

zoom

Figure 4.3: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation – Full
Trace (Top) - Zoom around the First Iterations (Bottom)

Figure 4.4 illustrates the new detection algorithm:

it now enters inside the iterations to
automatically detect eight diﬀerent anchors related to the four diﬀerent patterns contained in
an iteration. The ﬁrst anchor (the blue dot) represent the start of the iteration. This process is
more costly than before but also much more precise.

1In fact, working speciﬁcally on the ﬁrst iteration would certainly show some sensitive leakage, this would

require extra work to correctly capture it.

45

zoom

zoom

Figure 4.4: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation Pat-
tern Detection – Two Consecutive Iterations (Top) - Several Iterations (Middle) - Full Trace
(Bottom)

Thanks to the iteration detection algorithm, the EEA execution trace can be split into sub-
traces, each of them has its sub-patterns realigned. Figure 4.5 displays the re-alignment result.
The four patterns are identiﬁed in the ﬁrst subﬁgure. The ﬁrst one is already known, its length
is directly related to the value ∆r0,r1 . The second one appears to be constant-time (for all odd
and for all even operations). The two last patterns are not constant time and they are the focus
of our analysis. We ﬁrst restrict our work to the ﬁrst one, as selected on the second subﬁgure.
Furthermore, we will ﬁrst only consider odd iterations as they seem to give a richer information
than the even ones.

46

∆r0,r1

Cst Time

Timing
Leakage

zoom

Timing
Leakage

Figure 4.5: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Resynchronized Iteration – Full Iteration (Top) - Zoom (Bottom)

For reasons beyond our understanding, the shapes of two similar iterations (in terms of
number of peaks) are sometimes diﬀerent. It indeed happens that an iteration is more compact
than it should be. Figure 4.6 depicts two similar iterations, the ﬁrst one being the compact
version and the second one being the regular version. In fact this appears at very speciﬁc places
in the EEA sequence.

47

Figure 4.6: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Resynchronized Iteration – Compact Iteration (Top) - Regular Iteration (Bottom)

We observed that compact iterations occur when the following condition is met:

r1 < 231 or r1 > 2256−16

Figure 4.7 illustrates, on a full EEA execution, the parts where compact iterations are found.
These iterations bear the same information as regular ones, however we also remove them from
the analysis for now as they would just make things more complicated.

r1 > 2256−16

Selected Iterations

r1 < 231

Figure 4.7: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation – Full
Trace with Compact Areas

Finally, our experimental data is ready for the analysis, cleaned from artifacts and limited
to a single case: odd regular iterations. Our next observation gives us some new information
about the new leakage. Figure 4.8 shows three iterations (limited to the unknown leakage area)

48

for which both ∆r0,r1 and q are equal to 2. These three iterations have clearly diﬀerent shapes.
Hence, the leakage provides more information than the value of q (at least in this case). This is
pretty promising as we know already that if q is leaked, the attack will work.

∆r0,r1 = 2, q = 2

∆r0,r1 = 2, q = 2

∆r0,r1 = 2, q = 2

Figure 4.8: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Resynchronized Iteration – ∆r0,r1 = 2, quotient = 2 – Case 1 (Top) - Case 2 (Middle) - Case 3
(Bottom)

This good news is diminished by the observation depicted in Figure 4.9 where two iterations
look similar but are related to diﬀerent values of q. It means that the new leakage (and in fact
the entire leakage, including ∆r0,r1 ) does not allow to fully distinguish the quotient q.

49

∆r0,r1 = 3, q = 6

∆r0,r1 = 3, q = 4

Figure 4.9: Feitian A22 JavaCard – ECDSA Signature Veriﬁcation – EEA Computation –
Resynchronized Iteration – ∆r0,r1 = 3, quotient = 6 (Top) - ∆r0,r1 = 3, quotient = 4 (Bottom)

4.2.2 Failed Attempts

Only considering the ﬁrst 100 EEA traces from the ECDSA signature veriﬁcation acqui-
there is a total of 13893 EEA iterations), we manually regroup
sition campaign (i.e.
matching subtraces (for odd resynchronized iterations) for some small parameters choices
(∆r0,r1 , q) ∈ {(1, 1), (1, 2), (1, 3), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7)}.

This is a long and error prone process:

• for a parameter choice (∆r0,r1 , q), we extract all subtraces that match the parameters

(omitting the compact iterations, and only selecting the odd iterations);

• from this set of subtraces, manually divide them into matching groups where all subtraces
look alike (this step requires a comfortable visualization tool). For our parameter choices,
the number of groups can be 1 (e.g. (∆r0,r1 , q) = (2, 7)), 2 (e.g. (∆r0,r1 , q) = (1, 1)) or 3
(e.g. (∆r0,r1 , q) = (2, 2), see Figure 4.8).

Our ﬁrst direction of research was to enumerate all euclidean division algorithms we could
think of and see if one of them could explain these groups. By running a candidate division
algorithm on the inputs (r0, r1) corresponding to all iterations of a set of subtraces, we produced
labels (according to some inner computation or state of the candidate division).

We started with classical textbook divisions (long division, binary divisions, Knuth D
algorithm, etc.) and for each one, tried to tweak it into something that would divide our sets
into correct groups. It sometimes worked for some groups but always failed to scale. We even
dug up an old patent from Inﬁneon [6, 7] that explains how to execute the EEA without directly
manipulating the sequence of quotients by leveraging the access to a long integer modular

50

reduction hardware co-processor. This patent seemed like a great clue and we tried everything
to squeeze it into what we observed . . . proﬁtless.

The most promising results were found with the most simple approach. The basic idea
(which is at the basis of fast long division algorithms) is that when dividing two long integers,
we get a good approximation of the quotient with the division of their most-signiﬁcant-bits
(msb for short). Depending on the number of msb selected for the approximate division, the
approximation of the quotient is more of less precise and the eﬀort to correct it into the real
quotient could be the source of the timing leakage. This eﬀort would be related to the distance
between the real quotient and ﬁrst approximation. Based on this simple idea we could properly
divide some sets of subtraces and ﬁnd quite good success with the other sets (the groups are
not perfectly found but the error is small). However this approach does not scale: the more
complicated become the sets (i.e.
the larger the parameters (∆r0,r1 , q)) the further go our
observations from the simulations.

These attempts were excessively time consuming and did not allow to conclude on the real
source of leakage. They however demonstrated that the observed timing leakages were clearly
depending on the inputs values (r0, r1) since we managed to divide some sets almost perfectly.
This was enough for us to not give up.

However the only reasonable direction left to us seemed even longer and more painful...

4.2.3 Perseverance is the Key

When we are not smart enough we need to be persevering. Our next approach was to:

1. for each parameters choice (∆r0,r1 , q), enumerate all groups {G(∆r0 ,r1 ,q),i}i (as before);

2. for each group G(∆r0 ,r1 ,q),i, identify all associated inputs pairs (r0, r1);

3. try and ﬁnd a function f of (r0, r1) that outputs its correct group label i, otherwise just

keep the list of all input pairs.

This process looks actually very close to the our previous attempts, the crucial diﬀerence is
that the function f does not have to be an euclidean division and the simplest the better. Here
we are not trying to bridge the gap between the observation and a division algorithm, we are
simply looking for a (set of) leakage function.

Of course, we started with the most simple set of subtraces, which happen to be (∆r0,r1 , q) ∈
{(1, 1), (1, 2)}. These two sets have exactly 2 groups and we quickly found the following matching
function:

f : (r0, r1) →

(

len(r1) > len(r0 − 2∆r0 ,r1 ∗ r1)

0
1 otherwise

In fact the function works for all our observations for the following sets (∆r0,r1 , q) ∈
{(1, 1), (1, 2), (1, 3), (2, 3), (2, 4), (2, 5), (2, 7), (3, 7)} (where the sets (1, 3) and (2, 7) have only a
single group).

51

Then we found, for (∆r0,r1 , q) ∈ {(2, 6), (3, 4), (3, 6), (3, 8), (3, 11), (3, 12)}, that the following

function does the trick.

f : (r0, r1) → 


len(r1) − len(r0 − 2∆r0 ,r1 ∗ r1) = ∆r0,r1
len(r1) − len(r0 − (2∆r0 ,r1 + 2∆r0 ,r1 −1) ∗ r1) = ∆r0,r1

0
1
2 otherwise

Furthermore, we managed to handle the more complex set (2, 2) (with three diﬀerent groups)



by adding another case to the function:

len(r1) − len(r0 − 2∆r0 ,r1 ∗ r1) = ∆r0,r1
len(r1) − len(r0 − (2∆r0 ,r1 + 2∆r0 ,r1 −1) ∗ r1) = ∆r0,r1
len(r1) − len(r0 − (2∆r0 ,r1 − 2∆r0 ,r1 −1) ∗ r1) = ∆r0,r1

0
1
2
3 otherwise

f : (r0, r1) → 



Once we get there, and even though many more sets had to be investigated, we could see a
pattern in building a generic function f . Funny enough, when trying to write down the generic
function f , we ended up with an euclidean division !

4.2.4

Inﬁneon Euclidean Division Algorithm

Algorithm 4: Euclidean Division Algorithm

Input : a, b: two positive integers
Output: q: the quotient of the division of a by b

1 r ← a
2 ℓ ← len(r) − len(b)
3 q ← 0
4 while ℓ ≥ 0 do
5

g ← sign(r).2ℓ
r ← r − g.b
q ← q + g
ℓ ← len(r) − len(b)

6

7

8
9 end
10 if r < 0 then
q ← q − 1
11
r ← r + b

12
13 end
14 return q

// len(x) returns the binary length of x

// sign(x) returns -1 if x < 0, 1 otherwise

// q is the quotient
// r is the remainder

Algorithm 4 is a slightly tweaked schoolbook long division algorithm in base 2, where inter-
mediate remainders are allowed to be negative. We could not ﬁnd a reference to this speciﬁc
algorithm in the literature.

4.3 Summary of the Timing Leakages

The leaked sensitive information relates to the execution time of Algorithms 1 and 4. We sum-
marize here the information inferred directly from the side-channel traces:

52

• the successive patterns of the side-channel trace allow to identify the iterations of Algo-

rithm 1 while loop (and then their number);

• for each such iteration, a ﬁrst timing leakage is proportional to the binary length diﬀerence
of the (a, b) inputs of Algorithm 4, i.e. the value ℓ computed at line 2 of Algorithm 4,
so-called ∆r0,r1 in the previous chapters;

• in the cases where this value ℓ is greater than 5, the process is slightly modiﬁed, the iteration
takes signiﬁcantly more time (these are the large iterations identiﬁed in Chapter 2). One
interpretation might be that Algorithm 4 is executed only on the most-signiﬁcant-bits of
its inputs a and b. If ℓ > 5, then the number of most-signiﬁcant-bits considered is increased
such that the result of Algorithm 4 stays correct;

• then, for all iterations of Algorithm 4 while loop, the side-channel trace shape changes

when:

– ℓ = 0 compared to ℓ > 0 (line 8 of Algorithm 4);

– r < 0 compared to r ≥ 0 (lines 5 and 10 of Algorithm 4);

• for reasons beyond our understanding, the odd and even EEA iterations are slightly diﬀerent.
For the even iterations, there is less information leaked (or it is harder to extract): the
sign of r only leaks when ℓ > 0 otherwise we do not get it.

53

Chapter 5

Key-Recovery Attack on ECDSA

We have ﬁnally understood the details of Inﬁneon EEA implementation, making sense to the
observed timing leakages. Let us try to apply the attack process developed in Chapter 3 on the
newly identiﬁed leakages.

5.1

Input-Recovery Attack on the EEA

In the previous chapter, Section 4.3, we have precisely identiﬁed the sensitive leakage that we are
able to extract from the side-channel traces. The generic attack algorithm decribed in Chapter 3,
Section 3.2, Algorithms 2 and 3 can be applied straightforwardly. We ﬁrst need to choose a way
to correctly encode the leaked information. We simply use a tuple of variable length:

• the ﬁrst cell encodes the iteration parity (0 for even iterations, 1 otherwise);

• the second cell encodes the ∆r0,r1 value;
• then, for each iteration of Algorithm 4, a cell stores the value s ∗ v. where s = sign(r) and

v = 1 if ℓ = 0 and v = 2 otherwise 1;

• the encoding supports the two following erasure cases (that can be simultaneous):

– an encoding tuple of length 2 means that only the iteration parity and ∆r0,r1 value
are known, the remaining is not readable (hence any simulated leakage matching with
the ∆r0,r1 value is acceptable for this iteration);

– if the ∆r0,r1 value is set to −1, this means that we could not properly extract the

∆r0,r1 value (then any value for ∆r0,r1 is acceptable).

Also, as observed in Section 4.2.1, the ﬁrst iteration is considered unreadable and then is
encoded as (0, ∆N,k), where ∆N,k is the ﬁrst (unknown) value of ∆r0,r1 . As explained in Sec-
tion 3.2, the attack is iterated over increasing values of ∆N,k.

With this encoding we can run simulations and see if the leaked information allows for prac-

tical input-recovery attacks.

1Note that for even iterations, the leaked information is slightly diﬀerent. The encoding follows a similar idea.

54

5.1.1 Simulation Experiments

The simulation experiments results are displayed in the following Figure 5.1, they represent about
50 attacks with the leakage function deﬁned in the previous section. They appear in orange on
the ﬁgure while the blue dots are the simulation results when the leakage function is directly the
quotient value, taken from Chapter 3, Section 3.3, Figure 3.2.

As one can see, we limited our simulations to the case where the maximum quotient value in
the ﬁrst half of the EEA iterations is small (in fact we ensured that for the ﬁrst half of the EEA
iterations, ∆r0,r1 ≤ 5), so that the complexity of the attack stays small.

The attack is always successful in all our tests but, as we can see on the ﬁgure, it is slightly

more expensive than the Li = qi case.

Figure 5.1: Simulation of the Generic Attack – Comparison Between Li = qi and Inﬁneon
Leakage

These positive simulation results call for practical validation. Before going there, let us brieﬂy
explain how to ﬁnd the real nonce k when the blinded nonce k′ is recovered by the side-channel
attack.

55

5.2 From Blinded Nonce to ECDSA Long Term Private

Key

Since the multiplicative mask is 32-bit long, one could simply brute-force it: for each mask can-
didate ˆm compute [k′/m]Gx and compare it to the ﬁrst part of the ECDSA signature r. They
would match for the correct candidate.

There is a much more eﬃcient way to ﬁnd the mask:

• From the signature (r, s), infer the two points A(x,y) and B(x,y) on the curve such that

Ax = Bx = r (and, in fact A = −B).

• From k′ compute Q(x,y) = [k′]G(x,y) = [m][k]G(x,y)
• ﬁnally we have [m]A = Q or [m]B = Q

Hence, ﬁnding m corresponds to solve the discreet logarithm on the elliptic curve. The Pol-
). Since there is a bit of uncertainty

lard’s kangaroo algorithm [26] will ﬁnd the mask in O(2
on the point (A or B), the Pollard’s kangaroo algorithm might need to be run twice.

len(m)
2

For 32-bit odd masks (as in Inﬁneon implementation), this computation is not necessary
(since the naive brute-force approach would work) but it tells us that the mask should not just
be doubled for security guaranty. Ideally, the mask should be as long as the nonce; that way it
would be as hard to ﬁnd k from k′ than to ﬁnd k directly from r.

Finally, from the value of k it is immediate to ﬁnd the value of the ECDSA long term private

key d as per equation 1.1.

Now that we have a complete key-recovery attack on the paper, let us test it in practice.

5.3 Application to Feitian A22 JavaCard

First, we apply the attack to an ECDSA signature execution on the Feitian A22 JavaCard
acquisition campaign. We selected the 10th ECDSA execution for two reasons:

• we brute-forced the multiplicative mask for this ECDSA execution in Chapter 2, Sec-
tion 2.3.2. Hence, if the attack does not succeed, we can easily check were the error comes
from;

• among the 10 ﬁrst traces (for which we have the mask), the 10th has one single iteration
with ∆r0,r1 > 5 and it appears in the second half of the EEA sequence. From our simulations,
this trace should be the easiest to attack.

5.3.1 Leakage Extraction

To extract the leakage information about each and every iteration of the EEA side-channel execu-
tion trace, we ﬁrst created a dictionary of leakage traces. From the ECDSA signature veriﬁcation
campaign, where we know the EEA inputs (see Chapter 2, Section 2.2), we can list and classify
all iterations (and then side-channel subtraces) according to their leakage value (following the
encoding described in Section 5.1).

56

Since we do not have any iteration with ∆r0,r1 > 5 in our target EEA execution (at least not
in the ﬁrst half of the EEA), we simply build this dictionary for all iterations such that ∆r0,r1 ≤ 5
(for even and odd iterations separately since we have seen that these two cases behave diﬀerently).

At the end of this proﬁling step, we end up with 179 sets for every leakage information that an
iteration can provide (when ∆r0,r1 ≤ 5). We then select a unique reference subtrace for each of
these sets. The number of diﬀerent sets, with respect to the value of ∆r0,r1 is given in Table 5.1,
we clearly see that odd iterations give away more information as they are divided in more sets
than even iterations.

∆r0,r1
0
1
2
3
4
5

odd
1
5
12
22
34
51

even
1
2
6
9
15
21

Table 5.1: Number of Diﬀerent Sets of Iterations w.r.t. ∆r0,r1

For the attack phase, we ﬁrst regrouped the subtraces that looked similar (this was done
using an smoothing process in order remove small jitters, it presented in the attack on YubiKey
5Ci, Section 5.4). Then, by hand (there is a total of 156 iterations in the target EEA execution),
we looked for wrongly regrouped subtraces. Finally, for each group (again by hand), we tried
to match the group with a reference set (by visual comparison with the reference subtraces
obtained in the proﬁling step). This by-hand step took hours of work and would necessitate to
be automatized if this attack were to be taken outside a laboratory. For our purpose (demonstrate
that the attack is possible) it was the (painful but) shortest path.

5.3.2 Attack Results

The attack succeeded in about 222 calls to the truncated EEA algorithm (see Algorithms 2 and 3).
Since the multiplicative mask was already known to us, we could easily check that the recovered
blinded nonce was correct.

5.4 Application to YubiKey 5Ci

Now that the attack has been successfully tested on the training device (the Feitian A22
JavaCard), we can ﬁnally go back to our primary target, the YubiKey 5Ci. On which an un-
known long term private key has been generated and where we can run ECDSA signatures with
chosen messages. By opposition to the Feitian A22 JavaCard, we have no access to the private
key value and we cannot run ECDSA signature veriﬁcations (and then proﬁle the iterations).

5.4.1 Side-Channel Acquisitions

The acquisition setup is presented in Chapter 1, Section 1.5.2, the ﬁrst acquired trace of the full
ECDSA is displayed in Figure 1.5. For the attack, we restrict our acquisition to the end of the
ECDSA signature algorithm, the details are given in the following table 5.2, one of the acquired

57

trace is displayed in Figure 5.2 after a slight re-centering around the masked nonce modular
inversion.

operation
equipment
inputs
number of operations
length
sampling rate
samples per trace
channel(s)
channel(s) parameters
ﬁle size
acquisition time

ECDSA signature
LeCroy WavePro 254HD (12-bit), Langer ICR HH 500-06
Messages are random, Key is constant (unknown)
200
5ms
10GSa/s
50MSamples (16-bit)
EM activity
DC 50ohms, [−40, 40]mV
20GB
about 5 minutes

Table 5.2: Acquisition parameters on YubiKey 5Ci – ECDSA Signature

k−1 mod N

Figure 5.2: YubiKey 5Ci – ECDSA Signature – k−1 mod N Computation

After detecting and removing the interrupts (as for the Feitian A22 JavaCard traces, see
Chapter 2, Section 2.1.2), we get the cleaned trace as depicted in Figure 5.3 ﬁrst subﬁgure. When
zooming into the trace, we recognize the diﬀerent iterations of the EEA. If the EM signal is a bit
diﬀerent, we get very similar patterns as for the Feitian A22 JavaCard for the odd and even
iterations. The implementation of the EEA seems to be exactly the same (recall that the Inﬁneon
EC cryptolib is not the same version on the YubiKey and then the implementation might have
been updated).

58

k−1 mod N

zoom

zoom

Odd

Even

Figure 5.3: YubiKey 5Ci – ECDSA Signature – Cleaned k−1 mod N Computation (Top) - Zoom
on Several Iterations (Middle) - Zoom on Two Consecutive Iterations (Bottom)

Since the iterations subtraces are similar, we decide to use the dictionary of subtraces built in
the previous section and use it directly to attack the YubiKey 5Ci traces. Since this dictionary
has been built for ∆r0,r1 ≤ 5 iterations, our ﬁrst step is to select EEA side-channel execution
traces where the ﬁrst half of the iterations are all small iterations (as illustrated on the middle
subﬁgure of Figure 5.3 the large iterations appear and are quite easy to spot).

5.4.2 Leakage Extraction

So our ﬁrst step is to develop a detection algorithm (adapted to the YubiKey 5Ci EM signal)
to soundly detect all iterations of the side-channel traces and identify the traces without large
iterations (i.e. ∆r0,r1 > 5) for the ﬁrst half of the iterations. Over the 200 acquired traces, 6 are
identiﬁed. For each of the 6 selected traces, the iteration detection algorithm is applied and the
result is illustrated on Figure 5.4.

59

k−1 mod N

zoom

Figure 5.4: YubiKey 5Ci – ECDSA Signature – k−1 mod N Computation – Iterations Detection
(Top) - Zoom on Few Iterations (Bottom)

Thanks to the iteration detection, we can split the side-channel trace into subtraces corre-
sponding to single iterations. Figure 5.5 shows a single, resynchronized, iteration. As identiﬁed
on the ﬁgure, the ∆r0,r1 timing leakage is a bit diﬀerent in shape than in the Feitian A22
JavaCard traces, but it is still visible and quite easy to extract. For the rest of the leakage (the
Inﬁneon euclidean division leakages), we proceed as for the Feitian A22 JavaCard traces.

∆r0,r1

Euclidean Division Leakages

Figure 5.5: YubiKey 5Ci – ECDSA Signature – k−1 mod N Computation – Odd Iteration Sub-
trace

The subtraces are smoothed with an averaging rolling window of 1500 samples. The result of
this step is depicted on Figure 5.6 for two diﬀerent odd iterations. The smoothing of the traces
allows to easily regroup iterations with similar signal even in the presence of a small jitter.

60

Figure 5.6: YubiKey 5Ci – ECDSA Signature – k−1 mod N Computation – Single Iteration – 2
Diﬀerent Odd Iterations (First and Third) - After Averaging Rolling Window (Second and Last)

Once the (odd and even) iterations subtraces are automatically regrouped for the 6 selected
EEA executions, each group is by hand matched with a proﬁle group. Again, this step should be
automatized, as it is a long eﬀort and subject to errors. This step took a bit less than 24 hours.

61

5.4.3 Attack Results

Finally, the attack was run over the 6 EEA executions with the extracted leakages (and erasures
in case of unreadable subtraces). Five out of the six attacks were successful with complexity
below 228 calls to the truncated EEA. For these ﬁve successful attacks, a single blinded nonce was
found and the Pollard’s kangaroo algorithm ﬁnished the work by ﬁnding the nonce from which
we deduced the long term private key (as explained in Section 5.2).

From the private key, we could roll back to the EEA execution where the attack did not
work. We computed the nonce, brute-forced the multiplicative mask and simulated the leaked
information from the blinded nonce. It appeared that two diﬀerent errors of leakage extraction
were made in the ﬁrst half of the EEA iterations. This is due to our error prone step of leakage
extraction, we strongly believe that with some engineer work, this step could be greatly improved
in time and reliability.

5.5 Conclusions

The attack was demonstrated on two diﬀerent devices, one of which the long term private key
was unknown to us. The overall attack time can be divided in two steps:

• the online phase, where the device must be in the adversary hands.

In this phase, the
adversary needs to open the device to access the Inﬁneon secure element, put an EM probe
and run several ECDSA signatures. Then the device must be re-packaged and quietly
returned to the legitimate user. Since the acquisition phase takes few minutes, we estimate
to less than an hour the whole process (assuming one can ﬁnd a reliable way to open and
close the device, we did not work on this part);

• the oﬄine phase took about 24 hours in total for us. The vast majority of this time is
spent in a by-hand process that should be automatized. The rest is the iteration detection
and splitting of the traces (few seconds), the attack process on the extracted leakages (few
minutes) and the discreet logarithm computation (few seconds). With enough engineering
work, this oﬄine step should take less than an hour.

Finally, for the attack on the YubiKey 5Ci, we used 200 ECDSA signatures to produce 5
successful attacks. Hence, in average, our attack cost about 40 ECDSA signatures. The main
limitations to reduce this number are (1) the learning phase must be extended to the ∆r0,r1 > 5
iterations, there does not seem to be any reason for this to be a problem (but we did not do it,
so we never know) and (2) the attack process cost will increase with large ∆r0,r1 iterations. This
would impact the oﬄine phase of the attack, and certainly be acceptable for most of the EEA
executions 2.

2EEA executions with many large ∆r0,r1 iterations do not appear very often

62

Chapter 6

Beyond SLE78

6.1

Inﬁneon Security Microcontrollers

It is not that easy to get a proper picture of the Inﬁneon security microcontrollers families 1
(and this is also true for the other big secure element manufacturers). The CC certiﬁcates pub-
lication of these chips is certainly the best way to keep track with the diﬀerent chips hardware
and embedded ﬁrmware versions.

One thing that helps with Inﬁneon security microcontrollers is that they are all certiﬁed
by the German certiﬁcation body (BSI 2) except for two of them certiﬁed by the Netherlands
certiﬁcation body (NSCIB 3). All of these CC evaluations were performed by the same ITSEF,
T ¨UVIT 4 which happens to be accredited for CC hardware certiﬁcations by both BSI and NSCIB.

All of these CC certiﬁcates are public and come along with public security target and certiﬁca-
tion report documents that contains valuable information about the chip and ﬁrmware versions.
Furthermore, the BSI has a quite nice database search engine 5 that helps in ﬁnding the diﬀerent
documents. We also must mention the great SEC-CERTS initiative [13, 12] that ended up in a
powerful CC documents search engine 6.

Thanks to these certiﬁcations, we were able to identify 4 large families of Inﬁneon security mi-
crocontrollers. Figure 6.1 illustrates these 4 families along with the number of CC certiﬁcations
(AVA VAN 4 for TPMs and AVA VAN 5 for security microcontrollers with optional cryptographic
library 7). These 4 families distinguish from each other by the technological node of the chips:
from 90nm for the SLE78 to 28nm for the most recent family. While the two oldest families
are based on proprietary 16-bit microcontrollers from Inﬁneon, the two most recent ones are
ARM-based 32-bit microcontrollers: the ﬁrst one is based on an ARM SecureCore SC300 8 while

1https://www.infineon.com/cms/en/product/security-smart-card-solutions/
2https://www.bsi.bund.de/
3https://trustcb.com/common-criteria/nscib/
4https://www.tuvit.de/en/home/
5https://www.bsi.bund.de/SiteGlobals/Forms/Suche/EN/Expertensuche_Formular.html
6www.sec-certs.org
7We limit ourselves to the lowest level of certiﬁcations that includes the vulnerable Inﬁneon cryptolib. JavaC-
ard OSes and Applets (banking, passport, etc.) will be certiﬁed on top of IC certiﬁcations and will rely on them
for security guaranties using the handful composite certiﬁcation process of CC. The TPM is a special case in CC
certiﬁcation, they usually are certiﬁed as a single block including both IC and top ﬁrmware levels.

8https://developer.arm.com/Processors/SecurCore%20SC300

63

the second one is certainly based on the more recent ARM Cortex-M35P 9.

Figure 6.1 gives, for each family of security microcontrollers, the number of identiﬁed IC
models along with the number of CC certiﬁcates and CC maintenance certiﬁcates. We also show
the date of the ﬁrst and last certiﬁcate that was published. Note that for the SLE78 family, a
certiﬁcate was produced on July the 3rd 2024 (i.e. during the EUCLEAK responsible disclosure
period) where all cryptolibs are removed from the scope 10. The detailed information about each
IC model and certiﬁcate is provided in Annex B.

Armv8-M, 28 nm
IFX CCI 00007Dh

SC300, 40 nm
IFX CCI 0-0XYh

16-bit, 65 nm
IFX CCI 0-0Xh

16-bit, 90 nm
M78XX

1 (1,0)

4 (16,1)

3 (19,7)

Optiga TPM

Optiga Trust M

11 (41,19)

2009 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022 2023 2024

FEITIAN A22

YubiKey 5Ci

Legend: # IC Model (# CC Certiﬁcation Reports, # CC Maintenance Reports)

Figure 6.1: Inﬁneon Security Microcontroller Families

In Figure 6.1, we identiﬁed the two targets of our attack as being part of the SLE78 family (the
oldest one), the YubiKey being slightly more recent than the Feitian A22 JavaCard. We could
identify two other products: the Optiga Trust M and the Optiga TPM chips that are part of
more recent families of Inﬁneon security microcontrollers. The good thing about these products
is that development boards to play with them are available. The chips are not completely open
but in both cases one can send commands that will trigger an ECDSA signature / veriﬁcation
computation. Let us have a look at these products.

6.2

Inﬁneon Optiga Trust M

In order to run cryptographic commands on the Optiga Trust M chip, we acquired a PSoCTM
62S2 evaluation kit (CY8CEVAL-062S2) (see Figure 6.2). Source code and documentation is
freely available 11, we strictly followed Inﬁneon examples to get started with Optiga Trust M
cryptographic commands 12. We could easily develop a simple code that sends ECDSA signature
and ECDSA signature veriﬁcation commands to the Optiga Trust M and could even control
GPIOs that will tell our oscilloscope that the ECDSA operation is starting.

9https://developer.arm.com/Processors/Cortex-M35P
10See https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/SmartCards_IC_Cryptolib/0891
11https://github.com/Infineon/optiga-trust-m
12https://github.com/Infineon/mtb-example-optiga-crypto

64

Figure 6.2: Optiga Trust M – PSoCTM 62S2 evaluation kit (CY8CEVAL-062S2)

6.2.1 Side-Channel Acquisitions

Figure 6.3 shows the side-channel setup, the green wire is there to catch the GPIO signal that
will trig the acquisition right before the ECDSA operation. Figure 6.4 displays the EM probe
position we used over the Inﬁneon chip.

Figure 6.3: Optiga Trust M – Acquisition Setup

65

Figure 6.4: Optiga Trust M – EM Probe Position

For the record, the acquisition details for the ECDSA signature operations are given in
Table 6.1. We did not change the parameters for few ECDSA signature veriﬁcation operations.

operation
equipment
inputs
number of operations
length
sampling rate
samples per trace
channel(s)
channel(s) parameters
ﬁle size
acquisition time

ECDSA signature
LeCroy WavePro 254HD (12-bit), Langer ICR HH 500-06
Messages are random, Key is constant (randomly chosen)
10
200ms
1GSa/s
200MSamples (16-bit)
EM activity
DC 50ohms, [−200, 200]mV
4GB
about 1 minute

Table 6.1: Acquisition parameters on Optiga Trust M – ECDSA Signature

Figure 6.5 (resp. Figure 6.6) displays a full side-channel ECDSA signature (resp. signature
veriﬁcation) execution trace. These execution traces are very similar to what was observed on
the SLE78 experiments and ﬁnding the nonce modular inversion was quite straightforward (as
illustrated on the ﬁgures).

66

zoom

zoom

Figure 6.5: Optiga Trust M – ECDSA Signature – Full Trace (Top) - Zoom in Computation
End (Middle) - k−1 mod N Computation (Bottom)

67

zoom

zoom

Figure 6.6: Optiga Trust M – ECDSA Signature Veriﬁcation – Full Trace (Top) - Zoom before
Double Scalar Mult. (Middle) - s−1 mod N Computation (Bottom)

These observations tend to show that Inﬁneon modular inversion implementation did not
change in these more recent chips. We will go one step further to completely validate this
assumption.

6.2.2 Leakage Observation

In order to acquire more executions and more precisely, we reduced the acquisition time span
by selecting the area before the Double Scalar Multiplication in ECDSA signature veriﬁcation
operation. We could then reduce the y-axis dynamic and increase the sampling rate and the
number of acquired ECDSA signature veriﬁcation executions. Details are given in Table 6.2. An
example of the acquired traces is displayed in Figure 6.7.

68

operation
equipment
inputs
number of operations
length
sampling rate
samples per trace
channel(s)
channel(s) parameters
ﬁle size
acquisition time

ECDSA signature veriﬁcation
LeCroy WavePro 254HD (12-bit), Langer ICR HH 500-06
Messages are random, Signature generated from a constant Key
200
10ms
5GSa/s
50MSamples (16-bit)
EM activity
DC 50ohms, [−80, 80]mV
15GB
about 9 minute

Table 6.2: Acquisition parameters on Optiga Trust M – ECDSA Signature Veriﬁcation

Figure 6.7: Optiga Trust M – ECDSA Signature Veriﬁcation – Full Trace

With this new acquisition, we ﬁrst cleaned the interrupts and detected each iteration of
the EEA execution as this was done before on Feitian A22 JavaCard and YubiKey 5Ci traces.
Figure 6.8 shows a cleaned trace (ﬁrst subﬁgure) and an iteration subtrace (second subﬁgure).

69

Figure 6.8: Optiga Trust M – ECDSA Signature Veriﬁcation – Cleaned s−1 mod N Computa-
tion (Top) - Single Odd Iteration after Splitting (Bottom)

Since we are working on the modular inversion of the known s (the second part of the ECDSA
signature), and that Inﬁneon did not add side-channel countermeasures to this operation, we can
predict the Inﬁneon leakages (see Chapter 4, Section 4.3) from the value of s. We could then
validate that the subtraces still show the same leakages as before. Figure 6.9 illustrates this
veriﬁcation: 100 odd iterations subtraces are superposed, the color of the subtrace is dictated by
the values of ∆r0,r1 , one can clearly see that the subtraces are naturally grouped by color.

Figure 6.9: Optiga Trust M – ECDSA Signature Veriﬁcation – 100 superposed Odd Iterations)

Hence, we validated that the implementation did not change. However, since we did not do
the attack completely on the ECDSA signature operation, we cannot fully conclude. For in-
stance, Inﬁneon might have simply increased the size of the multiplicative mask used to protect
the nonce modular inversion.

70

After this test we contacted Inﬁneon and the other stakeholders to start the responsible dis-
closure. We explained our experiments on Optiga Trust M and that we supposed that the mask
length was still 32 bits. Inﬁneon neither conﬁrmed nor denied and went on with implementing
a countermeasure: increase the size of the multiplicative mask up to the size of the nonce. We
can then safely conclude that the Optiga Trust M is vulnerable to the EUCLEAK attack.

6.3

Inﬁneon Optiga TPM

It is only after the start of the responsible disclosure that we remarked that the Optiga TPM
was available (and part of a family that we did not analyze yet). So we ordered on Farnell the
OPTIGA TPM 9673 RPI evaluation kit the 5th May 2024.

Figure 6.10: Optiga TPM – OPTIGA TPM 9673 RPI EVAL

We followed Inﬁneon examples to get started with TPM cryptographic commands 13 and
easily developed a simple code to send ECDSA signature and signature veriﬁcation commands
to the TPM.

6.3.1 Side-Channel Acquisitions

Figure 6.11 shows the side-channel setup with the EM probe position we used over the Inﬁneon
chip.

13https://github.com/Infineon/optiga-tpm

71

Figure 6.11: Optiga TPM – Acquisition Setup

First we acquired few side-channel traces of the whole TPM ECDSA signature veriﬁcation
command with low sampling rate because of the command length (about 1 second). The result-
ing traces have 1.25G samples and, at ﬁrst sight, it is not so easy to ﬁnd the actual ECDSA
computations (see ﬁrst subﬁgure of Figure 6.12). Indeed, on the TPM board we do not have a
handy GPIO signal telling us when the ECDSA operation is starting.

Nevertheless, by changing the elliptic curve size (to 384 bits), the cryptographic operation
stands out (as it changes signiﬁcantly its execution time while the rest of the command does
not). We hence could isolate the ECDSA signature veriﬁcation operation (as shown in the
second subﬁgure of Figure 6.12)

72

zoom

Figure 6.12: Optiga TPM – ECDSA Signature Veriﬁcation – Full Trace (Top) - Zoom on ECDSA
Operation (Bottom)

Interestingly the ECDSA signature veriﬁcation on the Optiga TPM does not match the execu-
tion we have seen on SLE78 or Optiga Trust M. It seems that the ﬁrst part of the computation is
missing and only the double scalar multiplication is left. This might mean that the cryptographic
library has been updated.

In order to improve our understanding of the traces, we acquired a new set of traces, around
the double scalar multiplication. For the record, the acquisition details for the ECDSA signature
veriﬁcation operation are given in Table 6.3.

operation
equipment
inputs
number of operations
length
sampling rate
samples per trace
channel(s)
channel(s) parameters
ﬁle size
acquisition time

ECDSA signature veriﬁcation
PicoScope 6424E, Langer ICR HH 500-06
Messages are random, Signature generated from a constant Key
200
200ms
5GSa/s
1GSamples
EM activity
DC 50ohms, [−20, 20]mV
200GB
about 20 minutes

Table 6.3: Acquisition parameters on Optiga TPM – ECDSA Signature Veriﬁcation

The acquired traces are displayed in Figure 6.13, one can see that the double scalar mul-
tiplication is preceded by a pattern that looks very much like the modular inversion of s (and

73

indeed this operation needs to be executed prior to the double scalar multiplication). When
zooming into the modular inversion trace, one can guess the EEA iterations (see last subﬁgure)
and a quick count of these iterations shows that their number matches what is expected from
the EEA iterations. The signal is weaker than before and to better see the iterations, the signal
on the last subﬁgure went through a bandpass ﬁlter (few MHz to 200MHz).

zoom

zoom

Figure 6.13: Optiga TPM – ECDSA Signature Veriﬁcation – Full Computation (Top) - Zoom on
s−1 mod N Computation (Middle) - Zoom on Few Iterations (Bottom)

From this observation, one cannot really prove that the sensitive leakage still exists and is
exploitable. However, we have good reasons to believe that the implementation of the modular
inversion did not change. At the end of May 2024, and then during the responsible disclosure, we
described our experiments on the Optiga TPM to Inﬁneon. We hence considered that, without
new inputs, all Inﬁneon security microcontrollers and all Inﬁneon EC cryptolib versions are
susceptible to the EUCLEAK attack. Inﬁneon neither conﬁrmed nor denied.

74

Chapter 7

Conclusions

To conclude, we present the impact analysis of the EUCLEAK attack, then the attack mitiga-
tions and avenues of research that follow this work. Finally, the project timeline is also provided.

First, let us summarize what are the basic requirements for the EUCLEAK attack to be

feasible in practice:

• A secure system using an Inﬁneon security microcontroller that embeds the Inﬁneon cryp-
tographic library and runs cryptographic operations involving the modular inversion of a
secret (e.g. ECDSA).

• The attacker should have physical access to the device. This is the online phase of the

attack. Concretely, the attacker needs:

– to open the device in order to access to the Inﬁneon security microcontroller chip
package. Depending on the diﬃculty of this opening procedure, the online phase can
take more or less time;

– an electromagnetic probe, an oscilloscope and a computer to capture the electro-
magnetic side-channel signal of the chip during the cryptographic computations, by
putting the electromagnetic probe just above the chip package during the executions
(few minutes). Note that the side-channel setup can be mobile (e.g. by using a
PicoScope [25] and a laptop which ﬁt in a case or a backpack).

• Later, the oﬄine phase will take one hour to one day for the attacker to retrieve the secret

from the captured side-channel traces.

Note that the side-channel capture must be reproduced for every diﬀerent secret stored in
the chip (for instance in FIDO, for every web service protected by FIDO, a dedicated key pair is
associated – one must then capture a set of side-channel acquisitions for each diﬀerent targeted
secret – the device however has to be opened only once). The oﬄine phase also has to be
reproduced for every secret.

75

7.1

Impact on Inﬁneon Security Microcontrollers

We suspect that all Inﬁneon security microcontrollers embedding Inﬁneon cryptolib 1 are aﬀected
by the attack. We reproduce below Figure 6.1: our understanding of Inﬁneon security microcon-
trollers families, it was built upon the public documents produced by the Common Criteria (CC
for short) certiﬁcation process, details are given in Annex B.

Figure 6.1 reads as follows: the 65nm family of Inﬁneon security microcontrollers (in blue)
possesses three diﬀerent IC models (or conﬁgurations), they went through 19 CC certiﬁcations
and 7 CC maintenances from 2017 (ﬁrst certiﬁcate) to 2023 (last certiﬁcate at the time of writing
this report).

Armv8-M, 28 nm
IFX CCI 00007Dh

SC300, 40 nm
IFX CCI 0-0XYh

16-bit, 65 nm
IFX CCI 0-0Xh

16-bit, 90 nm
M78XX

1 (1,0)

4 (16,1)

3 (19,7)

Optiga TPM

Optiga Trust M

11 (41,19)

2009 2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 2020 2021 2022 2023 2024

FEITIAN A22

YubiKey 5Ci

Legend: # IC Model (# CC Certiﬁcation Reports, # CC Maintenance Reports)

Figure 6.1: Inﬁneon Security Microcontroller Families (repeated from page 64)

The four identiﬁed products on the ﬁgure (Feitian A22 JavaCard, YubiKey 5Ci, Optiga
Trust M and Optiga TPM) were analyzed in our work. The EUCLEAK attack was fully demon-
strated on Feitian A22 JavaCard and YubiKey 5Ci (see Chapter 5). Strong arguments that
the attack is also applicable to Optiga Trust M and Optiga TPM were presented (see Chapter 6).

Inﬁneon did not clearly conﬁrm nor deny our suspicion but went on to develop a patch for
their cryptolib (see the mitigation in Section 7.4). To our knowledge, at the time of writing this
report, the patched cryptolib did not yet pass a CC certiﬁcation. Anyhow, in the vast majority of
cases, the security microcontrollers cryptolib cannot be upgraded on the ﬁeld, so the vulnerable
devices will stay that way until device roll-out.

7.2 Conﬁrmed Vulnerable End-User Products

So far, here is the list of products where the impact is conﬁrmed.

1Remark that this is not always the case, e.g. large smartcard manufacturers, like Thales-DIS, IDEMIA or

G+D, usually develop their own cryptolibs instead of using the ones from the secure element manufacturer.

76

7.2.1

YubiKey 5 Series

All YubiKey 5 Series with ﬁrmware version below 5.7 are vulnerable to the attack. YubiKey
ﬁrmware is not upgradable 2, only the security keys shipped with ﬁrmware 5.7 or later are
resistant. EUCLEAK vulnerability impacts FIDO/FIDO2 and most certainly PGP and PIV
(when ECDSA is used).

7.2.2

Feitian A22 JavaCard

Feitian claims that the Feitian A22 JavaCard analyzed in this work does not exist anymore, the
new versions as well as all other Feitian products based on an Inﬁneon security microcontroller
embed a cryptolib developed by Feitian. We could partially verify this claim by looking at the
side-channel traces of an Feitian K44 device running ECDSA (see slides 23 to 27 of [18] for
more details about Feitian FIDO hardware tokens), it is indeed quite diﬀerent from Inﬁneon
implementation.

7.2.3

Inﬁneon TPMs

All Inﬁneon TPMs from the SLB96xx version (see the TPMs listed in Annex B) are impacted
by the attack.

7.3 Potentially Vulnerable Products

Secure elements, and at a good place Inﬁneon’s, are involved in many large secure systems.
Building a comprehensive list of the impacted systems is clearly out of NinjaLab reach.

Any system whose security relies on ECDSA (or the modular inversion of a secret) that is
run on an Inﬁneon security microcontroller (at least starting with the ﬁrst version of the SLE78),
embedding Inﬁneon cryptographic library (any version until the patch is out and shipped) might
be at risk.

We have already discussed FIDO/FIDO2 hardware tokens and TPMs, mentioned PIV

and PGP, many more products can be considered:

• Crypto-Currency Hardware Wallets:

They naturally rely on ECDSA (for signing transactions). Several embed an Inﬁneon chip
with Inﬁneon cryptolib 3.

• ID cards/Passports/Health cards:

In this area, Inﬁneon security microcontrollers are omnipresent.
for obvious reason, it
is quite complicated for small independent research companies like NinjaLab to attack
governmental-critical products, even for demonstration purposes.
Nevertheless, recent electronic passports [11] support either the Active Authentication pro-
tocol (that involves ECDSA computation) or the more recent PACE-CAM protocol (that
involves the modular inversion of the long term secret) for anti-cloning and therefore might
be subject to the EUCLEAK attack.

2See
Upgradable

https://support.yubico.com/hc/en-us/articles/360013708760-YubiKey-Firmware-is-Not-

3See for instance https://bitcointalk.org/index.php?topic=5304483.0 for a list of the secure elements used

in diﬀerent crypto-currency hardware wallets.

77

For instance, from the BSI CC certiﬁcation database, several passport applet develop-
ers directly use Inﬁneon cryptolib when running on an Inﬁneon security microcontroller
(MaskTech, Eviden, Universal Information Technology LLC, cryptovision GmbH).

• Matter:

The Matter standard for IoT devices relies on ECDSA 4, Inﬁneon products are involved in
this initiative 5.

• V2X:

Cars are also a good example where secure elements show themselves very useful and where
Inﬁneon is present 6. The associated protocols naturally involve ECDSA 7.

7.4 Attack Mitigations

Several measures can be implemented to thwart the proposed attack, at diﬀerent levels.

7.4.1 Hardening the Inﬁneon Cryptographic Library

The simplest mitigation to the EUCLEAK attack at the cryptolib level would be to improve the
Inﬁneon nonce blinding countermeasure by increasing the size of the multiplicative mask to the
size of the elliptic curve.

According to Inﬁneon, this is the mitigation they have chosen to develop and they already
have a working implementation. They oﬀered to send us an Optiga TPM with the patched version
of the EC library, but we declined. Indeed, it would be quite hard to validate that they did what
they say without access to the source code of the library. We then let the CC ITSEF check the
new countermeasure implementation as they do have access to the source code during the CC
evaluation.

Another mitigation would be to change the modular inversion algorithm and, e.g., switch to

a modular exponentiation instead of the EEA.

7.4.2 High-Level Mitigations

Let us emphasize here that we strongly encourage to continue to use an EUCLEAK vulnerable
product rather than switching to a solution that does not involve a secure element. So in cases
where a vulnerable product has to be used (e.g. it cannot be patched and roll-out is not coming
fast enough), some temporary mitigations might exist:

• Avoid ECDSA: Many protocols/applications oﬀer the possibility to choose the crypto-

graphic primitive from a list. This is for instance the case for FIDO2, PIV or PGP.

• Defense in Depth: When this is possible activate all defense layers, e.g. enforce the use

of a PIN (or any biometrics) to access to the device.

4See https://csa-iot.org/wp-content/uploads/2022/03/Matter_Security_and_Privacy_WP_March-2022.

pdf

5https://www.nagra.com/kudelski-iot-partners-infineon-enhance-smart-home-device-security-new-

matter-certified-solution

6https://globalplatform.org/wp-content/uploads/2023/12/5.-Antoaneta-Kondeva_eSE_in_Automotive_

GP_automotive.pdf

7See e.g. https://www.commoncriteriaportal.org/files/ppfiles/pp0114b_pdf.pdf

78

• Protocol Speciﬁc Mitigations: For FIDO devices, a mitigation exists that can be im-
plemented to reduce the attack threat without changing the device. As explained in section
8.1 of [5], a counter may be used as a signal for detecting cloned FIDO device. Thus if a
web service protected with FIDO receives a cryptographically correct authentication mes-
sage, but with a counter value smaller or equal to the previous counter value recorded, it
means that a clone of the FIDO device has been created and used. Then the web service
should not validate the authentication request, and lock the account.

This countermeasure would reduce the usability of the clone to a unique time after giving
the security key back to the legitimate user. Once the clone has been used, the account
will be locked by the next access from the legitimate user.

7.5 Avenues of Research

Many diﬀerent directions of research could be investigated, this report leaves open the following
questions:

• Sensitive modular inversions are not exclusively found in the ECDSA scheme. It would be
interesting to look at the RSA (and especially the key generation) and study the application
of EUCLEAK there.

• The proposed attack process should be studied in more depth, starting with a theoret-
ical analysis of its performances. More generally, the study of the minimal quantity of
information leaked necessary for attacking the EEA would be quite interesting.

• On a more practical side, pushing the attack eﬀectiveness to make it a proper single-
trace attack would also be interesting. As well as working on the side-channel acquisition:
capturing the signal a bit farther from the chip or capturing the signal on a contactless-only
product (like a passport) would both be interesting directions.

• If the side-channel analysis of the EEA is not quite common in the literature (we did not
ﬁnd any reference), there are few papers on the side-channel analysis of the Binary EEA
(certainly because the algorithm is more often used in practice), see e.g. [9, 2, 1]. It might
be interesting to confront this literature with the generic attack approach proposed in our
work.

• In [1], one can read ”LibreSSL uses [the EEA] as a side-channel hardened modular inversion
function, even though the execution ﬂow of this algorithm also depends on its inputs. No
evidence of a side-channel attack on this algorithm variant has been published yet, so its
resilience against SCA remains as an open problem. Therefore, to the best of our knowledge,
this algorithm is considered safe in this context.” We believe that this assumption should
be re-considered in light of the EUCLEAK attack.

7.6 Project Timeline

The project spreads over 2 years, with large pauses and small, often intense, work slots. The
project timeline is then a bit fuzzy. Most of what is presented in Chapter 2 – the ﬁrst reverse
engineering phase – was done at the beginning of 2022.

79

Then the project was paused until spring 2023 where the generic attack (or at least its ﬁrst
version) was developed and tested with the negative conclusion of Chapter 3. The project was
then deﬁnitely closed during the summer 2023.

The project reopened itself early 2024, as deﬁnitely-closed projects sometimes do, and the
longest part of the project started, we tried to describe it in Chapter 4. After that, everything
went much faster:

• March 21st, 2024:

– Attack validated on Feitian A22 JavaCard.

• April 5th, 2024:

– Attack validated on YubiKey 5Ci.

• April 18th, 2024:

– Leakage Validation on Optiga Trust M.

• April 19th, 2024:

– Contact Inﬁneon, Yubico, Feitian , CERT-FR (ANSSI), CERT-BUND (BSI), with
a short technical description of our work and our coordinated responsible disclosure
plan (expected to end at the beginning of September 2024).

– Acknowledgment of reception from Yubico Security team and ANSSI CERT-FR.

• April 22nd to 24th, 2024:

– Acknowledgment of reception from BSI CERT-BUND, Inﬁneon and Feitian

– Feitian explains that the Feitian A22 JavaCard has been updated years ago and

none of their products is impacted.

• April 25th, 2024:

– Meeting with Yubico security team, they acknowledge that all YubiKey 5 Series
are impacted by the attack. Yubico explains that they are actually in the middle of
switching from Inﬁneon cryptolib to their own.

• May 2nd, 2024:

– At the request of Inﬁneon, NinjaLab sends more technical details of the attack.

• May 6th, 2024:

– YubiKey ﬁrmware 5.7 update 8, Yubico switches to its own cryptolib.

• May 15th, 2024:

– Optiga TPM evaluation kit ordered on Farnell.

• May 30th, 2024:

– Notiﬁcation to Inﬁneon that Optiga TPM is also impacted.

8https://yubi.co/yubikey-5-7-authenticator-7-blog

80

• June 24th, 2024:

– Meeting with ANSSI to present our work and discuss technical details.

• July 18th, 2024:

– Meeting with BSI to discuss technical details.

• July 26th, 2024:

– Inﬁneon shares with us the news that they have a patch working; they oﬀer that
NinjaLab checks the leakage of a Optiga TPM with the patched library, we decline the
oﬀer.

• August 27th, 2024:

– CVE ID requested. We are still waiting for one.

• September 3rd, 2024:

– publication of this report on the NinjaLab website.

Acknowledgements

I would like to thank Victor Lomn´e for his help and support throughout this project, notably
unearthing Inﬁneon Optiga Trust M and Optiga TPM dev kits and the careful proof-reading of
this report. Also Laurent Imbert and Cyril Bouvier for insightful discussions about the Extended
Euclidean Algorithm. Finally, special thanks to Marine for keeping our little monsters busy, I
owe you one! Ready for your HDR yet?

81

Bibliography

[1] A. C. Aldaya, C. P. Garc´ıa, and B. B. Brumley. From A to Z: Projective coordinates leakage

in the wild. IACR Trans. Cryptogr. Hardw. Embed. Syst., 2020(3):428–453, 2020.

[2] A. C. Aldaya, C. P. Garc´ıa, L. M. A. Tapia, and B. B. Brumley. Cache-Timing Attacks on
RSA Key Generation. IACR Trans. Cryptogr. Hardw. Embed. Syst., 2019(4):213–242, 2019.

[3] J. Coron. Resistance against Diﬀerential Power Analysis for Elliptic Curve Cryptosystems.
In C¸ . K. Ko¸c and C. Paar, editors, Cryptographic Hardware and Embedded Systems, First
International Workshop, CHES’99, Worcester, MA, USA, August 12-13, 1999, Proceedings,
volume 1717 of Lecture Notes in Computer Science, pages 292–302. Springer, 1999.

[4] Dino-Lite. Dino-Lite digital microscope AM4113TL. https://www.dino-lite.eu/en/

am4113tl, 2019. [online; accessed 2-September-2024].

[5] FIDO Alliance. Universal 2nd Factor (U2F) Overview. https://fidoalliance.org/
specs/fido-u2f-v1.2-ps-20170411/fido-u2f-overview-v1.2-ps-20170411.pdf.
[on-
line; accessed 31-December-2020].

[6] W. Fischer. Device and method for determining an inverse of a value related to a modulus,

U.S. Patent 08290151B2, Oct. 2012.

[7] W. Fischer. Device and method for determining an inverse of a value related to a modulus,

U.S. Patent 10318245B2, Jun. 2019.

[8] D. Freedman, R. Pisani, and R. Purves. Statistics. Pisani, R. Purves, 4th edn. WW Norton

& Company, New York, 2007.

[9] C. P. Garc´ıa and B. B. Brumley. Constant-Time Callees with Variable-Time Callers. In
26th USENIX Security Symposium (USENIX Security 17), pages 83–98, Vancouver, BC,
Aug. 2017. USENIX Association.

[10] N. Howgrave-Graham and N. P. Smart. Lattice Attacks on Digital Signature Schemes. Des.

Codes Cryptogr., 23(3):283–290, 2001.

[11] International Civil Aviation Organization (ICAO). Machine readable travel documents. part
11: Security mechanisms for MRTDs. Technical report Doc 9303. https://www.icao.int/
publications/Documents/9303_p11_cons_en.pdf, Eighth Edition, 2021. [online; accessed
2-September-2024].

[12] A. Janovsky,  L. Chmielewski, P. Svenda, J. Jancar, and V. Matyas. Chain of Trust: Unrav-
eling References Among Common Criteria Certiﬁed Products. In N. Pitropakis, S. Katsikas,
S. Furnell, and K. Markantonakis, editors, ICT Systems Security and Privacy Protection,
pages 191–205, Cham, 2024. Springer Nature Switzerland.

82

[13] A. Janovsky, J. Jancar, P. Svenda,  Lukasz Chmielewski, J. Michalik, and V. Matyas. sec-
certs: Examining the security certiﬁcation practice for better vulnerability mitigation. Com-
puters & Security, 143:103895, 2024.

[14] T. Jebelean. A Double-Digit Lehmer-Euclid Algorithm for Finding the GCD of Long Inte-

gers. Journal of Symbolic Computation, 19(1):145–157, 1995.

[15] Langer.

ICR HH 500-6.

https://www.langer-emv.de/en/product/near-field-

microprobes-icr-hh-h-field/26/icr-hh500-6-near-field-microprobe-2-mhz-to-
6-ghz/108, 2019. [online; accessed 2-September-2024].

[16] LeCroy. WavePro HD Oscilloscope datasheet. https://cdn.teledynelecroy.com/files/

pdf/waveprohd-datasheet.pdf, 2023. [online; accessed 2-September-2024].

[17] Ledger Donjon. Ledger Scaﬀold Documentation. https://donjonscaffold.readthedocs.

io/en/latest/index.html, 2020. [online; accessed 2-September-2024].

[18] V. Lomn´e. An Overview of the Security of Some Hardware FIDO(2) Tokens – Hardwear.io
Netherlands 2022 conference. https://hardwear.io/netherlands-2022/presentation/
security-of-Hardware-FIDO(2)-tokens.pdf, Oct. 2022.

[19] V. Lomn´e and T. Roche. A Side Journey to Titan. https://ninjalab.io/wp-content/

uploads/2022/05/a_side_journey_to_titan.pdf, Feb. 2021.

[20] Martin Paljak.

Ant JavaCard Project Github repository.

https://github.com/

martinpaljak/ant-javacard. [online; accessed 2-September-2024].

[21] D. Moghimi, B. Sunar, T. Eisenbarth, and N. Heninger. TPM-FAIL: TPM meets Timing
and Lattice Attacks. In 29th USENIX Security Symposium (USENIX Security 20), Boston,
MA, Aug. 2020. USENIX Association.

[22] M. Nemec, M. Sys, P. Svenda, D. Klinec, and V. Matyas. The Return of Coppersmith’s
Attack: Practical Factorization of Widely Used RSA Moduli. In 24th ACM Conference on
Computer and Communications Security (CCS’2017), pages 1631–1648. ACM, 2017.

[23] NIST. FIPS 186-2, Digital Signature Standard (DSS). https://csrc.nist.gov/csrc/
media/publications/fips/186/2/archive/2000-01-27/documents/fips186-2.pdf,
2001. [online; accessed 2-September-2024].

[24] Oracle. JavaCard Connected Platform Speciﬁcations 2.2.2. https://www.oracle.com/
[online; accessed

java/technologies/java-card/platform-specification-v222.html.
2-September-2024].

[25] Pico Technology.

PicoScope 6000E Series datasheet.

download/manuals/picoscope-6000e-series-data-sheet.pdf, 2019.
2-September-2024].

https://www.picotech.com/
[online; accessed

[26] B. J. M. Pollard. Monte Carlo methods for index computation (). Mathematics of Compu-

tation, 32:918–924, 1978.

[27] T. Roche, V. Lomn´e, C. Mutschler, and L. Imbert. A Side Journey To Titan.

In 30th
USENIX Security Symposium (USENIX Security 21), pages 231–248. USENIX Association,
Aug. 2021.

[28] Thorlabs. Manual 3-axes Stage PT3/M. https://www.thorlabs.com/thorproduct.cfm?

partnumber=PT3/M#ad-image-0, 2019. [online; accessed 2-September-2024].

83

Appendix A

YubiKey 5C Case Opening

The EUCLEAK attack relies on timing leakages and then does not need ultra-high quality side-
channel traces. In fact, during this work, we never needed to open a chip package to put our EM
probe very close to the die 1.

Nevertheless, capturing the EM signal with a small EM probe would not work if this probe is
too far from the chip. We hence have to open the YubiKey plastic case to access its logic board.
We bought two YubiKey 5C (see Figure A.1) and tried two diﬀerent case openings.

Figure A.1: Brand New YubiKey 5C

First by cutting the edge of the product until the plastic case can be opened in half, the result
is shown in Figure A.2. The process takes few minutes, the device is still working. The second
approach takes even less time, we just dig a hole at the right place, this takes few seconds, the
result is shown on Figure A.3.

1For instance, in our previous work on Google Titan Security Key [19], the side-channel acquisition needed

much more care.

84

Figure A.2: YubiKey 5C – First Opening

Figure A.3: YubiKey 5C – Second Opening

In both cases however, the device needs to be re-packaged if the adversary wants to give it

back to legitimate user without him noticing. We did not study further this issue.

85

Appendix B

Inﬁneon Security Microcontrollers

Name

Certificate
Reference

Dates

#Certificates/
#Maintenances

Library
Version

Link

M7820 A11

M7801 A12

BSI-DSZ-CC-0640

BSI-DSZ-CC-0728

BSI-DSZ-CC-0758

BSI-DSZ-CC-0829

BSI-DSZ-CC-0606

BSI-DSZ-CC-0727

M7820 M11

BSI-DSZ-CC-0695

M7892 A21

BSI-DSZ-CC-0813

M7892 B11

BSI-DSZ-CC-0782

M7893 B11

BSI-DSZ-CC-0879

M7892 D11 and G12 BSI-DSZ-CC-0891

M7892 P11

BSI-DSZ-CC-1105

SLB96xx
(TPM)

SLB9665
(TPM)

SLB9670
(TPM)

BSI-DSZ-CC-0844

BSI-DSZ-CC-0965-
2015

BSI-DSZ-CC-1020

BSI-DSZ-CC-1056-
2018

BSI-DSZ-CC-0958

BSI-DSZ-CC-0998-
2016

BSI-DSZ-CC-1021

BSI-DSZ-CC-1057-
2018

BSI-DSZ-CC-1058-
2018

BSI-DSZ-CC-1086-
2018

BSI-DSZ-CC-1100-
2018

2010-
2010

2011-
2011

2012-
2012

2012-
2017

2010-
2010

2011-
2011

2011-
2013

2012-
2012

2012-
2020

2014-
2022

2015-
2024

2020-
2020

2014-
2017

2015-
2015

2016-
2017

2018-
2018

2015-
2017

2016-
2016

2016-
2017

2018-
2018

2018-
2018

2018-
2018

2018-
2018

1/2

1/1

1/1

2/3

1/0

1/0

1/2

1/0

5/1

5/1

7/1

1/0

2/1

1/0

2/1

1/0

2/2

1/1

2/1

1/0

1/0

1/1

1/0

EC v1.1.18

EC v1.02.008

EC v1.02.013

EC v1.02.013

EC v1.1.18

EC v1.02.008

EC v1.02.008

EC v1.02.008

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0640.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0728.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0758.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0829_V2.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0606.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0727.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0695.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0813.html

EC v1.02.013 or
v2.07.003

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0782_0782V2_0782V3_0782V4_
0782V5.html

EC v1.03.006

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0879_0879V2_0879V3_0879V4_
0879V5.html

EC v1.02.013 or
v2.03.008

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0891

EC v2.03.008 or
v2.07.003

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1105.html

v4.43.0257.00,
v4.43.0258.00 and
v4.43.0259.00

v5.51.2098.00

v5.62.3126.00,
v5.62.3127.00

v5.63.3144.00,
v5.63.3149.00,
v5.63.3353.00,
v5.63.3355.00

v6.43.0243.00,
v6.43.0244.00,
v6.43.0245.00 and
v6.43.0246.00

v7.40.2098.00

v7.62.3126.00,
v7.62.3127.00

v7.63.3144.00,
v7.63.3149.00,
v7.63.3353.00,
v7.63.3355.00

v7.83.3358.00,
v7.83.3360.00

v7.85.4555.00,
v7.85.4567.00

v13.11.4555.00

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0844_0844V2.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0965.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1020_1020V2.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1056.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0958_0958V2.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0998.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1021_1021V2.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1057.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1058.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1086_1086ma01.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1100.html

Table B.1: Inﬁneon Security Microcontrollers – M78XX (SLE78) – 16-bit, 90 nm

Name

Certificate
Reference

IFX CCI 000003h

BSI-DSZ-CC-1110

BSI-DSZ-CC-0945

IFX CCI 00000Fh

BSI-DSZ-CC-1079

IFX CCI 00007h

BSI-DSZ-CC-0961

Dates

2019-
2023

2017-
2018

2018-
2023

2017-
2022

#Certificates/
#Maintenances

Library
Version

Link

6/1

3/3

4/1

6/2

EC
or V2.07.003
V2.08.007

V2.06.003
or

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1110.html

EC V2.06.003 or
V2.07.003

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0945_0945V2_0945V3.html

EC
v2.08.007,
v3.33.003

v2.07.003,
or

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1079.html

V2.06.003,

EC
V2.07.003,
V2.08.007

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/0961_0961V2_0961V3_0961V4_
0961V5_0961V6.html

Table B.2: Inﬁneon Security Microcontrollers – IFX CCI 0-0Xh – 16-bit, 65 nm

Name

Certificate
Reference

Dates

#Certificates/
#Maintenances

Library
Version

Link

IFX CCI 000011h

BSI-DSZ-CC-1025

IFX CCI 001Fh
(SLC37)

IFX CCI 00003Fh
(SLC37)

SLB9672/SLB9673

(TPM)

BSI-DSZ-CC-1102

NSCIB-CC-
2200060-01-CR

NSCIB-CC-
0173264-CR3

BSI-DSZ-CC-1113

BSI-DSZ-CC-1178

BSI-DSZ-CC-1179

2018-
2023

2019-
2020

2023-
2023

2021-
2021

2021-
2023

2021-
2023

2021-
2023

5/0

1/1

1/0

1/0

5/0

4/0

4/0

v2.08.006
or

v3.03.003

EC
or
v3.04.001

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1025.html

NA

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1102.html

EC v3.03.003 or
v3.04.001

https://www.trustcb.com/download/nscib- cc- 2200060-
01- cr/

EC v3.03.003

https://www.tuv- nederland.nl/assets/files/
cerfiticaten/2021/12/cc- 21- 0173264- cr3- 1.0.pdf

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1113.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1178_1178V2_1178V3.html

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1179_1179V2_1179V3.html

v15.20.15686.00,
v15.21.16430.00,
v15.22.16832.00
und
v15.23.17664.00

v16.10.16488.00,
v16.12.16858.00
and
v26.10.16688.00

v17.10.16488.00,
v17.12.16858.00,
v17.13.17733.00,
v27.10.16688.00
and
v27.13.17770.00

Table B.3: Inﬁneon Security Microcontrollers – IFX CCI 0-0XYh – ARM SC300, 40 nm

Name

Certificate
Reference

IFX CCI 00007Dh

BSI-DSZ-CC-1229

Dates

2024-
2024

#Certificates/
#Maintenances

Library
Version

Link

1/0

CryptoSuite
v4.06.002

https://www.bsi.bund.de/SharedDocs/Zertifikate_CC/CC/
SmartCards_IC_Cryptolib/1229.html

Table B.4: Inﬁneon Security Microcontrollers – IFX CCI 00007Dh – Armv8-M, 28 nm



=== Content from news.ycombinator.com_e0b4b125_20250111_204542.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D41434500) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [EUCLEAK Side-Channel Attack on the YubiKey 5 Series](https://ninjalab.io/eucleak/) ([ninjalab.io](from?site=ninjalab.io)) | | --- | --- | --- | |  | | 706 points by [GTP](user?id=GTP) [4 months ago](item?id=41434500)  | [hide](hide?id=41434500&goto=item%3Fid%3D41434500) | [past](https://hn.algolia.com/?query=EUCLEAK%20Side-Channel%20Attack%20on%20the%20YubiKey%205%20Series&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=41434500&auth=ddbb1657d4f2062b25eebd6c6f49a58b88f7e08b) | [278 comments](item?id=41434500) |  | |  |  | [edent](user?id=edent) [4 months ago](item?id=41437728)   | [next](#41438149) [–]  As per [https://arstechnica.com/security/2024/09/yubikeys-are-vulner...](https://arstechnica.com/security/2024/09/yubikeys-are-vulnerable-to-cloning-attacks-thanks-to-newly-discovered-side-channel/) An attacker not only needs your username and password, they also need physical access to your key. They then have to disassemble the device. If they want to give it back to you, they'll need to reassemble it. So not exactly trivial! A blob of nail-varnish over a plastic seam might be a useful canary. But this does highlight one weakness of these FIDO tokens - you have to manually maintain a list of where you've registered them. And if your token is lost or stolen, you have to manually revoke every single one. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [panarky](user?id=panarky) [4 months ago](item?id=41438346)   | [parent](#41437728) | [next](#41439904) [–]  It's not just YubiKey. NinjaLab: "All Infineon security microcontrollers (including TPMs) that run the Infineon cryptographic library (as far as we know, any existing version) are vulnerable to the attack." - Chips in e-passports from the US, China, India, Brazil and numerous European and Asian nations - Secure enclaves in Samsung and OnePlus phones - Cryptocurrency hardware wallets like Ledger and Trezor - SIM cards - TPMs in laptops from Lenovo, Dell, and HP - EMV chips in credit and debit cards | | --- | --- | --- | | | |  |  | [madars](user?id=madars) [4 months ago](item?id=41438769)   | [root](#41437728) | [parent](#41438346) | [next](#41439046) [–]  Ledger uses STMicroelectronics secure elements and should not be affected by this. Trezor Safe uses Infineon OPTIGA though. See <https://bitcointalk.org/index.php?topic=5304483.0> for a table with wallets and their respective microcontrollers/secure elements. | | --- | --- | --- | | | |  |  | [notarealllama](user?id=notarealllama) [4 months ago](item?id=41440178)   | [root](#41437728) | [parent](#41438769) | [next](#41441387) [–]  Nice to see a fellow enthusiast here, this is a nice point that different hardware will have different levels of related risk. But this is kind of an entire class of attack where similar paths may be able to be used on these other controllers. Don't gloss over it. On a side note, used to frequent a bar where one of the creators of Ledger also did. Was nice to spend various crypto freely! | | --- | --- | --- | | | |  |  | [rfoo](user?id=rfoo) [4 months ago](item?id=41443020)   | [root](#41437728) | [parent](#41440178) | [next](#41441387) [–]  This is an entire class of attacks known since almost forever. So yeah, some of us already considered this so we'd like to gross over it this time. | | --- | --- | --- | | | |  |  | [pshirshov](user?id=pshirshov) [4 months ago](item?id=41441387)   | [root](#41437728) | [parent](#41438769) | [prev](#41440178) | [next](#41439046) [–]  Ledger literally supports key extraction as a feature and pushes hard the firmware updates. Last S firmware w/o key extraction still works, while the same X version cannot be used anymore. | | --- | --- | --- | | | |  |  | [hadlock](user?id=hadlock) [4 months ago](item?id=41439046)   | [root](#41437728) | [parent](#41438346) | [prev](#41438769) | [next](#41440217) [–]  Passports are kind of a big deal. The customs agent is going to visually verify the photo vs the holder, but the customs agent is going to trust the valid RFID chip probably 100% of the time as it's assumed to be unbreakable. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41439303)   | [root](#41437728) | [parent](#41439046) | [next](#41440217) [–]  I'd be surprised if the chip even gets activated in 50% of all validations, to be honest. | | --- | --- | --- | | | |  |  | [DANmode](user?id=DANmode) [4 months ago](item?id=41439722)   | [root](#41437728) | [parent](#41439303) | [next](#41440217) [–]  All globally? Less than 10. | | --- | --- | --- | | | |  |  | [wongarsu](user?id=wongarsu) [4 months ago](item?id=41439879)   | [root](#41437728) | [parent](#41439722) | [next](#41440217) [–]  However if we look only at border checkpoints (including airports) in first world nations the number is probably *a lot* higher. Not only are agents likely to be using the chip, self-service immigration gates have become really popular at airports around the world and mostly use the RFID chip together with a face scan | | --- | --- | --- | | | |  |  | [iancarroll](user?id=iancarroll) [4 months ago](item?id=41440766)   | [root](#41437728) | [parent](#41439879) | [next](#41440765) [–]  On the bright side, this bug seems to require an ECDSA operation, and I would guess that most ePassports are using RSA. Can't seem to find any statistics but the standards support both. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441200)   | [root](#41437728) | [parent](#41440766) | [next](#41440765) [–]  PACE does use (EC)DH. Not sure if that’s vulnerable as well, or if this is once again a footgun specific to (EC)DSA. | | --- | --- | --- | | | |  |  | [consp](user?id=consp) [4 months ago](item?id=41443475)   | [root](#41437728) | [parent](#41441200) | [next](#41440765) [–]  Since it's a non constant time implementation of a specific part of the EC operation (modular inversion) my guess would be they reused the code for that everywhere and it's probably also present in ecdh and all other algorithms requiring a modular inversion. | | --- | --- | --- | | | |  |  | [stingraycharles](user?id=stingraycharles) [4 months ago](item?id=41440765)   | [root](#41437728) | [parent](#41439879) | [prev](#41440766) | [next](#41440217) [–]  So what would an attack of the RFID chip look like, if the person still is facially identified using a face scan? | | --- | --- | --- | | | |  |  | [notpushkin](user?id=notpushkin) [4 months ago](item?id=41441158)   | [root](#41437728) | [parent](#41440765) | [next](#41440217) [–]  1. Obtain a donor passport, get the chip, dump the Active Authentication key which is used to ensure you can't clone the chip 2. Make a fake passport with your photo (and fingerprints etc.) and add the AA key so that it passes the check You'll still have to somehow fake Passive Authentication (in which your data, including photo, is signed by the country's public key) too, though. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441584)   | [root](#41437728) | [parent](#41441158) | [next](#41440217) [–]  That's assuming that the validation software even has all issuing countries' root keys available. Supposedly it's surprisingly (or maybe not, given how international government relations historically work) difficult for countries to exchange their public keys: Since there isn't any central authority, nor a chain of trust available (a la "this key is signed by France and Switzerland, so it's probably the real thing to us, Germany"), it boils down to n^2/2 key exchanges, and n additional ones every time a single key expires or, worse, has to be rotated on short notice. Then all of that has to be distributed to all border authority systems. Last time I looked into this (10+ years ago), my laptop doing Passive Authentication and Active Authentication using 10 lines of Python and my country's root certificate (it's publicly available) was supposedly more than what most border checks could practically do. | | --- | --- | --- | | | |  |  | [FateOfNations](user?id=FateOfNations) [4 months ago](item?id=41450426)   | [root](#41437728) | [parent](#41441584) | [next](#41447179) [–]  ICAO, the international organization which maintains the standards for travel document interoperability does have a public key directory that a reasonably large number of countries now participate in. The beauty of international organizations is that the individual members don’t all have to be on the best terms with each other. <https://www.icao.int/Security/FAL/PKD/Pages/default.aspx> | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41460601)   | [root](#41437728) | [parent](#41450426) | [next](#41447179) [–]  Oh, that is very neat, thank you! It seems to be publicly accessible too. Maybe I'll add a few lines to my script if I can still find it :) | | --- | --- | --- | | | |  |  | [wbl](user?id=wbl) [4 months ago](item?id=41447179)   | [root](#41437728) | [parent](#41441584) | [prev](#41450426) | [next](#41451917) [–]  Isn't this what the pouch and ambassador is for? | | --- | --- | --- | | | |  |  | [notpushkin](user?id=notpushkin) [4 months ago](item?id=41451917)   | [root](#41437728) | [parent](#41441584) | [prev](#41447179) | [next](#41440217) [–]  Yeah, it’s surprisingly not straightforward. In my home country (Russia), only some biometric passports issued inside the country can be used on the automatic gates – mine was issued in an embassy overseas, so I can’t use them. It works just fine in Malaysia, though! | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41440217)   | [root](#41437728) | [parent](#41438346) | [prev](#41439046) | [next](#41446734) [–]  Fortunately (in this case) the payments card industry only acknowledged the existence of Elliptic Curves in 2021 [1], so most EMV cards should be safe. The most important parts use symmetric keys anyway. [1] [https://www.emvco.com/knowledge-hub/emv-chip-specifications-...](https://www.emvco.com/knowledge-hub/emv-chip-specifications-to-support-elliptic-curve-cryptography/) | | --- | --- | --- | | | |  |  | [xeyownt](user?id=xeyownt) [4 months ago](item?id=41442407)   | [root](#41437728) | [parent](#41440217) | [next](#41446734) [–]  The attack is on elliptic curves... | | --- | --- | --- | | | |  |  | [natpalmer1776](user?id=natpalmer1776) [4 months ago](item?id=41446734)   | [root](#41437728) | [parent](#41438346) | [prev](#41440217) | [next](#41438907) [–]  Sounds like they buried the lede with this one then. Some of the items on that list being 'crackable' seem infinitely more dangerous than a general-purpose device such as a YubiKey. | | --- | --- | --- | | | |  |  | [TacticalCoder](user?id=TacticalCoder) [4 months ago](item?id=41438907)   | [root](#41437728) | [parent](#41438346) | [prev](#41446734) | [next](#41442621) [–]  > - Cryptocurrency hardware wallets like Ledger and Trezor Ledger hardware wallets (which btw can serve as U2F authentication but, AFAIK, not FIDO2) are protected by a PIN: three wrong PINs and the device, unlike a Yubikey, factory resets itself. IIUC the side-channel attack relies on a non constant-time *modinv*. I don't know if there's a way to force that *modinv* to happen on a Ledger without knowing the PIN. I take it we'll have a writeup by Ledger on that attack very soon. | | --- | --- | --- | | | |  |  | [Xylakant](user?id=Xylakant) [4 months ago](item?id=41439068)   | [root](#41437728) | [parent](#41438907) | [next](#41442621) [–]  Yubikeys don’t use a pin by default, but at least the ones I use all have the option to set one. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41440228)   | [root](#41437728) | [parent](#41439068) | [next](#41442621) [–]  Whether a PIN is used is determined by the RP on a per-authentication basis, so unfortunately this attack likely breaks that mechanism. | | --- | --- | --- | | | |  |  | [traceroute66](user?id=traceroute66) [4 months ago](item?id=41443151)   | [root](#41437728) | [parent](#41440228) | [next](#41442621) [–]  > Whether a PIN is used is determined by the RP on a per-authentication basis Ahem, cough... ```     ykman fido config toggle-always-uv ``` | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41444613)   | [root](#41437728) | [parent](#41443151) | [next](#41442621) [–]  Does that work for Yubikeys other than the Yubikey Bio? | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41446290)   | [root](#41437728) | [parent](#41444613) | [next](#41442621) [–]  I just tried it on a 5C NFC (firmware 5.4.3) and got: ```     ERROR: Always Require UV is not supported on this YubiKey.  ``` So I'm really not sure this is an option for non-Bio keys, unless it was introduced quite recently. | | --- | --- | --- | | | |  |  | [mirages](user?id=mirages) [4 months ago](item?id=41442621)   | [root](#41437728) | [parent](#41438346) | [prev](#41438907) | [next](#41439085) [–]  This is at best another forensic tool (unlocking the TPM of a locked laptop/phone for prosecution) and at worst a red herring for security flag. - Clone a passport -> why cloning if you can issue new ones - getting risked being detected while using a clone (2 entries in 2 different countries, and you also need to look like the person) not to mention you have to destroy the passport - Phone enclaves -> see above - Crypto -> Hardware wallets should be kept on eye as badly as your normal wallet - SIM Cards -> Swapping is faster, or if you're the the gov, just an intercept warrant will do the trick - Laptops -> see above - EMV Chips -> If you have those skills and money, I don't think you'll lose time on cloning credit/debit cards | | --- | --- | --- | | | |  |  | [mschuster91](user?id=mschuster91) [4 months ago](item?id=41442992)   | [root](#41437728) | [parent](#41442621) | [next](#41444536) [–]  > - Clone a passport -> why cloning if you can issue new ones - getting risked being detected while using a clone (2 entries in 2 different countries, and you also need to look like the person) not to mention you have to destroy the passport Well... not really. ICAO compliant passports do not require storing a photo embedded in the chip, as long as you can forge the physical part of the passport (or obtain blanks) you just need the digital certificates from a "donor" passport of John Doe, print "John Doe" and his personal data (birth day/place, nationality, issuance/expiry data) on the human readable and MRZ fields, but crucially the photo of the person using the forgery. Also, there are no centralized, cross country stores of entry/departure. Lots of places don't even register it for visa-free border crossings. Some national ID documents, e.g. the Croatian national ID card "osobna iskaznica", do store a photo embedded in the chip, so that indeed restricts a forgery from being used by a non-lookalike. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41460666)   | [root](#41437728) | [parent](#41442992) | [next](#41444536) [–]  > ICAO compliant passports do not require storing a photo embedded in the chip That's completely on the issuing country then, though, just like they e.g. might choose to not use dynamic chip authentication, which also makes the passport subject to trivial chip cloning. I wouldn't be surprised if some e-border gates reject travel documents that don't support chip authentication or don't have a digital version of the photo covered by the issuer signature. | | --- | --- | --- | | | |  |  | [patrakov](user?id=patrakov) [4 months ago](item?id=41444536)   | [root](#41437728) | [parent](#41442621) | [prev](#41442992) | [next](#41460646) [–]  > - Phone enclaves -> see above Well... not really, from the viewpoint of a bank. Look, now the user can extract the key that the bank TOTP app carefully keeps, and transfer it to another (rooted) device, or use without a phone at all, meaning that this app is no longer a "something unclonable that you have" authentication factor. From a risk management and compliance perspective, that's a contract breach: the bank is legally obliged to store that secret securely, so that the user is guaranteed to complain if it could have been used by someone else. | | --- | --- | --- | | | |  |  | [nly](user?id=nly) [4 months ago](item?id=41444771)   | [root](#41437728) | [parent](#41444536) | [next](#41460646) [–]  Two factor auth is often just used to shift blame anyway. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41460646)   | [root](#41437728) | [parent](#41442621) | [prev](#41444536) | [next](#41439085) [–]  > - EMV Chips -> If you have those skills and money, I don't think you'll lose time on cloning credit/debit cards Experience shows that the people having the skills, money, and criminal energy to attack payment card security quite often end up doing just that. In a way, there's an implicit and quite large pending bug bounty for EMV at all times... | | --- | --- | --- | | | |  |  | [cotillion](user?id=cotillion) [4 months ago](item?id=41439085)   | [root](#41437728) | [parent](#41438346) | [prev](#41442621) | [next](#41443543) [–]  Infineon chips are used in some smart tachographs in EU. This is likely to get very messy. Extract those keys and your drivers can ignore all annoying work-time rules and you can just patch the files if you are audited. | | --- | --- | --- | | | |  |  | [PinguTS](user?id=PinguTS) [4 months ago](item?id=41443738)   | [root](#41437728) | [parent](#41439085) | [next](#41443543) [–]  Not really, as it is an expansive procedure which needs to be done on every single device. Very unlikely that this will be done. | | --- | --- | --- | | | |  |  | [crossroadsguy](user?id=crossroadsguy) [4 months ago](item?id=41443543)   | [root](#41437728) | [parent](#41438346) | [prev](#41439085) | [next](#41439069) [–]  > Chips in e-passports from the US, China, India India has e-passports? I am from there and I have one I renewed during the pandemic, so might have missed the news, but I didn't know we have e-passports now. I tried googling and didn't find much (the official page doesn't load). [https://passportindia.gov.in/AppOnlineProject/online/faqEPas...](https://passportindia.gov.in/AppOnlineProject/online/faqEPassport) Also I checked the PDF on Ninjalab port (article linked in this post) and there was no mention of India there. Is it from some other source like Twitter? | | --- | --- | --- | | | |  |  | [panarky](user?id=panarky) [4 months ago](item?id=41453736)   | [root](#41437728) | [parent](#41443543) | [next](#41439069) [–]  India's e-passports [https://passportindia.gov.in/AppOnlineProject/online/faqEPas...](https://passportindia.gov.in/AppOnlineProject/online/faqEPassport) They use Infineon chips [https://www.securetechalliance.org/infineon-ships-security-c...](https://www.securetechalliance.org/infineon-ships-security-chips-to-taiwans-electronic-passport-program/) | | --- | --- | --- | | | |  |  | [trebligdivad](user?id=trebligdivad) [4 months ago](item?id=41439069)   | [root](#41437728) | [parent](#41438346) | [prev](#41443543) | [next](#41444721) [–]  Yeh, it's a bingo list of the news stories to watch out for. I guess some restricted/critical/secret infrastructure stuff as well. | | --- | --- | --- | | | |  |  | [morpheuskafka](user?id=morpheuskafka) [4 months ago](item?id=41444721)   | [root](#41437728) | [parent](#41438346) | [prev](#41439069) | [next](#41448734) [–]  If I remember correctly, Infineon already had a big TPM recall a while back. I remember my T470p had to first install a BIOS update to enable userspace updating of the TPM, then the TPM update itself. And I think some Yubikeys were replaced for free due to the same or similar issue. | | --- | --- | --- | | | |  |  | [numpad0](user?id=numpad0) [4 months ago](item?id=41448734)   | [root](#41437728) | [parent](#41438346) | [prev](#41444721) | [next](#41439904) [–]  Aren't EMV and secure enclaves big deals? | | --- | --- | --- | | | |  |  | [haroldp](user?id=haroldp) [4 months ago](item?id=41439904)   | [parent](#41437728) | [prev](#41438346) | [next](#41444161) [–]  > But this does highlight one weakness of these FIDO tokens - you have to manually maintain a list of where you've registered them. FWIW, I use KeePassXC as my password manager and tag each account that uses my hardware keys, so if lost, stollen or broken, I can quickly get a list of sites from which to remove that key. I always register two keys and keep them physically separate, so I can still login in the event I lose one key. | | --- | --- | --- | | | |  |  | [trueismywork](user?id=trueismywork) [4 months ago](item?id=41452113)   | [root](#41437728) | [parent](#41439904) | [next](#41444161) [–]  3 keys is where it's at. One at office, one at home, one in a bank locker that has a lot of foam. | | --- | --- | --- | | | |  |  | [perlgeek](user?id=perlgeek) [4 months ago](item?id=41444161)   | [parent](#41437728) | [prev](#41439904) | [next](#41440751) [–]  I agree this is not trivial, but yubikeys are (at least sometimes) used in context with very high stakes. This includes access to "crypto" assets, but also more serious situations such as defense contractors. These are scenarios where you have well-resourced, highly motivated attackers, and this is *precisely* what the yubikey is supposed to defend against. So, the fob still provides fishing resistant authentication, but some of the security expectations have been subverted. | | --- | --- | --- | | | |  |  | [throwaway48476](user?id=throwaway48476) [4 months ago](item?id=41440751)   | [parent](#41437728) | [prev](#41444161) | [next](#41439681) [–]  A well resourced attacker could manufacture a replacement backdoored key with your ECDSA key. | | --- | --- | --- | | | |  |  | [dgoldstein0](user?id=dgoldstein0) [4 months ago](item?id=41441152)   | [root](#41437728) | [parent](#41440751) | [next](#41439681) [–]  A small advantage to this attack is they don't need their own manufacturing and can attack keys which are already in use. A supply chain attack of "here a pre-backdoored key I'm pretending it's perfectly secure, go use it" has no need for this exploit if you have manufacturing capability. If you don't, then intercepting new yubikeys in transit, extracting the key, and sending them along the way would also be doable with the exploit described. | | --- | --- | --- | | | |  |  | [MetaWhirledPeas](user?id=MetaWhirledPeas) [4 months ago](item?id=41439681)   | [parent](#41437728) | [prev](#41440751) | [next](#41440831) [–]  > you have to manually maintain a list of where you've registered them For an individual, the answer there might be to limit the usage of the device to your "core" services, and rely on good password hygiene for everything else. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41440131)   | [root](#41437728) | [parent](#41439681) | [next](#41442087) [–]  > rely on good password hygiene for everything else. Usually this means using a password manager, and these days many of them also support WebAuthN in a way not tied to a specific device (or platform/ecosystem). | | --- | --- | --- | | | |  |  | [davidt84](user?id=davidt84) [4 months ago](item?id=41444554)   | [root](#41437728) | [parent](#41440131) | [next](#41442087) [–]  But if you store everything in the password manager, it's no longer two factor. | | --- | --- | --- | | | |  |  | [hypeatei](user?id=hypeatei) [4 months ago](item?id=41444938)   | [root](#41437728) | [parent](#41444554) | [next](#41444644) [–]  It's still two factors regardless of storage. Say you accidentally paste your password into the wrong field and post it on a forum. Whoever gets that still needs the second factor. Sure, if your password vault gets breached then everything is exposed but that's extremely unlikely and you have a lot of work to do in that event regardless. It's an inherent risk to using a password manager: everything is centralized so it's a valuable target. | | --- | --- | --- | | | |  |  | [davidt84](user?id=davidt84) [4 months ago](item?id=41445416)   | [root](#41437728) | [parent](#41444938) | [next](#41444644) [–]  It is not extremely unlikely, all it takes is for you to unlock your password database on a device with some malware. The point of a second *separate* factor is to reduce that risk. | | --- | --- | --- | | | |  |  | [duckmysick](user?id=duckmysick) [4 months ago](item?id=41446928)   | [root](#41437728) | [parent](#41445416) | [next](#41444644) [–]  If there's malware on my device, isn't it game over already? Even if I have a second factor elsewhere, the malware can access session keys to whatever service I logged into from that device, among other things. | | --- | --- | --- | | | |  |  | [Matumio](user?id=Matumio) [4 months ago](item?id=41448960)   | [root](#41437728) | [parent](#41446928) | [next](#41448687) [–]  In theory. But if everything is in the password safe, the malware can just grab that and upload? And cover its traces. As opposed to patching every application/service you might use, and get access only when you use it. | | --- | --- | --- | | | |  |  | [davidt84](user?id=davidt84) [4 months ago](item?id=41448687)   | [root](#41437728) | [parent](#41446928) | [prev](#41448960) | [next](#41444644) [–]  It's certainly not good, but if you require 2FA to, say, change the email address attached to your account, or make withdrawals, or other important actions, it's not game over. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41444644)   | [root](#41437728) | [parent](#41444554) | [prev](#41444938) | [next](#41442087) [–]  Yes, but I don’t need/want 2FA everywhere, and it’s still a strictly better single factor than a password (since WebAuthN is resilient against server-side database leaks and phishing). | | --- | --- | --- | | | |  |  | [remus](user?id=remus) [4 months ago](item?id=41442087)   | [root](#41437728) | [parent](#41439681) | [prev](#41440131) | [next](#41440831) [–]  > For an individual, the answer there might be to limit the usage of the device to your "core" services, and rely on good password hygiene for everything else. What's the advantage here over password + yubikey? Isn't password + yubikey always going to be at least as secure as password, even if the yubikey gets lost/stolen/compromised? | | --- | --- | --- | | | |  |  | [jerieljan](user?id=jerieljan) [4 months ago](item?id=41440831)   | [parent](#41437728) | [prev](#41439681) | [next](#41440401) [–]  > But this does highlight one weakness of these FIDO tokens - you have to manually maintain a list of where you've registered them. And if your token is lost or stolen, you have to manually revoke every single one. I agree. I've been keeping track of FIDO tokens and where they work in my password manager and it's great. I honestly want to extend this idea not just to FIDO tokens, but for anything that would ever need to be revoked and replaced. So stuff like FIDO tokens, 2FA secrets, Passkeys (both already handled by my password manager), payment methods, GPG keys and such. | | --- | --- | --- | | | |  |  | [xyst](user?id=xyst) [4 months ago](item?id=41440401)   | [parent](#41437728) | [prev](#41440831) | [next](#41440460) [–]  > An attacker not only needs your username and password Usernames and passwords are leaked all the time. Many users even re-use these across multiple services. > they also need physical access to your key. With enough practice, a motivated actor could make it seamless enough that you don’t notice. Or stalk the target to find a weak point in schedule and give attacker enough time to perform EUCLEAK. We are creatures of habit after all. > And if your token is lost or stolen, you have to manually revoke every single one. I agree here. No way to easily track. I have to make a manual note for each service in password manager. | | --- | --- | --- | | | |  |  | [colejohnson66](user?id=colejohnson66) [4 months ago](item?id=41440488)   | [root](#41437728) | [parent](#41440401) | [next](#41440460) [–]  > Usernames and passwords are leaked all the time. Many users even re-use these across multiple services. I’d wager that people using TOTP tokens like the YubiKey are more likely to use password managers. | | --- | --- | --- | | | |  |  | [sowbug](user?id=sowbug) [4 months ago](item?id=41440460)   | [parent](#41437728) | [prev](#41440401) | [next](#41439972) [–]  What about passkeys? I think it's possible to sign into a passkey-supporting site with just the physical credential and its PIN. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441503)   | [root](#41437728) | [parent](#41440460) | [next](#41439972) [–]  That's less related to passkeys, and more to what the site (i.e. the Relying Party in WebAuthN parlance) requires in terms of authentication security. User Verification (including PINs) is possible for non-discoverable credentials and vice versa (e.g. Bitwarden's implementation doesn't seem to support user verification at authentication time, but supports discoverable credentials). In any case, note that this particular attack seems to degrade the security of "Yubikey + PIN" from two factors (possession of the key, knowledge of the PIN) to one (possession of the key), as the PIN entry can be bypassed due to how user verification works in WebAuthN/CTAP2. | | --- | --- | --- | | | |  |  | [bbarnett](user?id=bbarnett) [4 months ago](item?id=41439972)   | [parent](#41437728) | [prev](#41440460) | [next](#41440274) [–]  Someone was shipping something and was using sparkle nail polish on the screw holes. They took pics and claimed the pattern was hard to duplicate. I have a nagging memory that someone demonstrated defeating it though. | | --- | --- | --- | | | |  |  | [aidenn0](user?id=aidenn0) [4 months ago](item?id=41440274)   | [parent](#41437728) | [prev](#41439972) | [next](#41440847) [–]  > If they want to give it back to you, they'll need to reassemble it. Or just give you back a different yubikey that is cloned from the original. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [4 months ago](item?id=41440284)   | [root](#41437728) | [parent](#41440274) | [next](#41440295) [–]  You can’t do that without the same assembly issue. Yubikeys don’t let you generate the FIDO2 keys at all and I believe there’s a flag on x509 keys which were imported rather than generated on the device. | | --- | --- | --- | | | |  |  | [xvector](user?id=xvector) [4 months ago](item?id=41440725)   | [root](#41437728) | [parent](#41440284) | [next](#41440295) [–]  You would replace it with a dummy that unlocks that functionality but looks physically the same. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [4 months ago](item?id=41440813)   | [root](#41437728) | [parent](#41440725) | [next](#41440295) [–]  The “looks physically the same” part is the problem I was referring to: this attack needs a lab and some time. If they have to add reprogramming a key and weathering it to look like yours to the task it’s certainly not impossible but it moves even further into “are you at war with a nation-state?” territory where the attacks are both unlikely to be worth the cost or easier than alternatives. I’m not saying it’s not possible but 99% of normal people are really only at risk of online attacks or physical attacks which won’t be sophisticated stealth operations but more along the lines of “you’re sending me Bitcoin or I’m shooting your dog”. | | --- | --- | --- | | | |  |  | [wbl](user?id=wbl) [4 months ago](item?id=41447212)   | [root](#41437728) | [parent](#41440813) | [next](#41440295) [–]  Get Chinese knockoff and some coins in a tumbler | | --- | --- | --- | | | |  |  | [a1o](user?id=a1o) [4 months ago](item?id=41440295)   | [root](#41437728) | [parent](#41440274) | [prev](#41440284) | [next](#41440847) [–]  This is more probable, yes | | --- | --- | --- | | | |  |  | [lallysingh](user?id=lallysingh) [4 months ago](item?id=41440847)   | [parent](#41437728) | [prev](#41440274) | [next](#41438149) [–]  Can they give you back a duplicate? | | --- | --- | --- | | | |  |  | [laserbeam](user?id=laserbeam) [4 months ago](item?id=41441174)   | [root](#41437728) | [parent](#41440847) | [next](#41438149) [–]  Cloning a functional piece of hardware that behaves like the original yubikey doesn’t imply the clone looks and feels like the original. It sounds to me it’s like someone would make a clay copy of a key. I don’t think the attacker gets to replicate the manufacturing process to make an item the same shape and size as the original. | | --- | --- | --- | | | |  |  | [ddtaylor](user?id=ddtaylor) [4 months ago](item?id=41444730)   | [root](#41437728) | [parent](#41441174) | [next](#41438149) [–]  This is inaccurate as clay is not digitally signed. | | --- | --- | --- | | | |  |  | [OptionOfT](user?id=OptionOfT) [4 months ago](item?id=41438149)   | [prev](#41437728) | [next](#41440361) [–]  I think the most annoying part of this is that you cannot just replace a YubiKey. Regardless of whether you're using passkeys or the non-discoverable ones, you need to manually go through each account and replace the YubiKey with a non-vulnerable key before decommissioning this one. And then there is the non-discoverable part. I don't remember where I've used my YubiKey in the past. Also, on the Ars article [0] there is mention of a PIN: > YubiKeys provide optional user authentication protections, including the requirement for a user-supplied PIN code or a fingerprint or face scan. This is not a YubiKey thing, but a FIDO thing [1]. [0]: [https://arstechnica.com/security/2024/09/yubikeys-are-vulner...](https://arstechnica.com/security/2024/09/yubikeys-are-vulnerable-to-cloning-attacks-thanks-to-newly-discovered-side-channel/) [1]: [https://new.reddit.com/r/yubikey/comments/12bv4sv/fido\_pin\_s...](https://new.reddit.com/r/yubikey/comments/12bv4sv/fido_pin_sometimes_not_required/) | | --- | --- | --- | | | |  |  | [cvhc](user?id=cvhc) [4 months ago](item?id=41439645)   | [parent](#41438149) | [next](#41438826) [–]  Another side. I always worry more about being locked out by 2FA (a main use case of non-discoverable FIDO keys) as a consequence of lost/retired-then-forgotten keys. This happened once when the US custom detained my electronics, including a Yubikey. Later I managed to recover many accounts that accept email for 2FA or as the ultimate auth factor (i.e., password/2FA reset). But a few, including AWS, doesn't allow that. Many websites encourage you to enroll 2FA without clarifying the alternative factors and the consequence of lost access. | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [4 months ago](item?id=41440402)   | [root](#41438149) | [parent](#41439645) | [next](#41440205) [–]  > without clarifying the alternative factors This is super annoying. I wish sites would standardize on a simple infographic saying: You will be able to access your account with: \* Username, Password and 2FA device. or \* 5 points from the following list: Username (1), Current password (2), old password (0.5), sms verification (1), mothers maiden name or other secret word (0.5). Email verification (2). 2 factor device (2), Video call with support agent showing government ID matching account name (1), has waited 7 days without successful login, despite notifying all contact addresses (2) For added security, you can adjust the account to require 6, 7 or 8 points from the above list, but please be aware doing so might hinder your ability to access the account if you lose your password or 2FA device. | | --- | --- | --- | | | |  |  | [throwaway48476](user?id=throwaway48476) [4 months ago](item?id=41440791)   | [root](#41438149) | [parent](#41440402) | [next](#41440205) [–]  Unfortunately identity systems have adopted security through obscurity instead. They use IP address, location, time since last login, number of attempts, device etc to determine how easy to make it for you to log in. I lost a Gmail account because I no longer had an old phone number even though my password was correct. | | --- | --- | --- | | | |  |  | [willis936](user?id=willis936) [4 months ago](item?id=41444125)   | [root](#41438149) | [parent](#41440791) | [next](#41440205) [–]  Maintaining a phone number is not security through obscurity. | | --- | --- | --- | | | |  |  | [throwaway48476](user?id=throwaway48476) [4 months ago](item?id=41446156)   | [root](#41438149) | [parent](#41444125) | [next](#41440205) [–]  The obscurity is that you have no idea what is required to log in. | | --- | --- | --- | | | |  |  | [berdario](user?id=berdario) [4 months ago](item?id=41440205)   | [root](#41438149) | [parent](#41439645) | [prev](#41440402) | [next](#41445379) [–]  > the US custom detained my electronics, including a Yubikey Can you elaborate on what happened? I know that it's theoretically possible, but I thought that: 1- They would potentially detain only devices that they can extract information out of (even if encrypted), like a laptop or some hard disk... Yubikey (at least the old U2F-only ones) don't have anything that you can extract 2- They would eventually return the device to you (unless guilty of some national security violation?) Am I mistaken on both counts? | | --- | --- | --- | | | |  |  | [vaylian](user?id=vaylian) [4 months ago](item?id=41442353)   | [root](#41438149) | [parent](#41440205) | [next](#41440427) [–]  > 2- They would eventually return the device to you (unless guilty of some national security violation?) "Eventually" is not good enough. People take things with them on their trips, because they expect to use these things while they are traveling/doing work at a remote location. Imagine you need to do some work on a remote site and you can't log in to your company's network, because the TSA has taken away your key so that they can inspect it. | | --- | --- | --- | | | |  |  | [cvhc](user?id=cvhc) [4 months ago](item?id=41440427)   | [root](#41438149) | [parent](#41440205) | [prev](#41442353) | [next](#41440369) [–]  For 1, tbh I don't know the rules. technically it was a regular model and can store some data. Or maybe they simply suspected it's a usb disk. And 2 was true. But it was after weeks, and of course I didn't wait until then to reset my account credentials. | | --- | --- | --- | | | |  |  | [vanchor3](user?id=vanchor3) [4 months ago](item?id=41440369)   | [root](#41438149) | [parent](#41440205) | [prev](#41440427) | [next](#41440940) [–]  If they just seize it, it will typically be returned at some point. If they decide it's subject to forfeiture, it is now their property. You can contest this with the forfeiture department but I guess if they decide the item is guilty of a crime or other excuses to keep it there's nothing you can do. | | --- | --- | --- | | | |  |  | [plagiarist](user?id=plagiarist) [4 months ago](item?id=41441167)   | [root](#41438149) | [parent](#41440369) | [next](#41440940) [–]  That's right. It will be United States v. Some Person's Yubikey. And you can hire it a lawyer if you want, because they will NOT give it a public defender. Massive violation of Constitutional rights if you ask me. | | --- | --- | --- | | | |  |  | [heavyset\_go](user?id=heavyset_go) [4 months ago](item?id=41440940)   | [root](#41438149) | [parent](#41440205) | [prev](#41440369) | [next](#41445379) [–]  > *Yubikey (at least the old U2F-only ones) don't have anything that you can extract* Newer Yubikeys hold secrets that, if exfiltrated, give you access to accounts. I assume that if it doesn't already exist, there will be a Cellebrite-like device that governments can plug Yubikeys into to dump keys quickly like they're able to with cell phones. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441368)   | [root](#41438149) | [parent](#41440940) | [next](#41445379) [–]  The entire point of Yubikeys is that such a device should be impossible, and vice versa, if such a device were to exist, the Yubikey is nothing but an expensive USB flash drive. | | --- | --- | --- | | | |  |  | [schoen](user?id=schoen) [4 months ago](item?id=41444526)   | [root](#41438149) | [parent](#41441368) | [next](#41445379) [–]  It should also be a dramatically smaller attack surface than a smartphone! | | --- | --- | --- | | | |  |  | [alecco](user?id=alecco) [4 months ago](item?id=41445379)   | [root](#41438149) | [parent](#41439645) | [prev](#41440205) | [next](#41440941) [–]  You should always have more than one 2FA. Especially for anything Google as you'll never ever recover the account (unless you are famous or go viral <1%). | | --- | --- | --- | | | |  |  | [rodgerd](user?id=rodgerd) [4 months ago](item?id=41440941)   | [root](#41438149) | [parent](#41439645) | [prev](#41445379) | [next](#41447394) [–]  There's a reason that Apple won't let you enable FIDO keys without having two of them to enroll. | | --- | --- | --- | | | |  |  | [gabeio](user?id=gabeio) [4 months ago](item?id=41447394)   | [root](#41438149) | [parent](#41439645) | [prev](#41440941) | [next](#41442582) [–]  > But a few, including AWS, doesn't allow that. IAM users you are correct only allow a single 2fa key (their way of deprecating IAM users), but their SSO Users can have as many as they want and are honestly much better than IAM users. Even for my personal account I've moved to using an SSO User. | | --- | --- | --- | | | |  |  | [oasisbob](user?id=oasisbob) [4 months ago](item?id=41447779)   | [root](#41438149) | [parent](#41447394) | [next](#41442582) [–]  I don't think this is accurate - I have multiple MFA devices associated with all my AWS IAM users on multiple accounts of various ages. AWS documentation specifies that users are allowed upto eight MFA devices each: [https://docs.aws.amazon.com/IAM/latest/UserGuide/id\_credenti...](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html) | | --- | --- | --- | | | |  |  | [gabeio](user?id=gabeio) [4 months ago](item?id=41452421)   | [root](#41438149) | [parent](#41447779) | [next](#41442582) [–]  Interesting, last I bothered with IAM users they were limited to a single MFA "device" virtual or otherwise. [https://aws.amazon.com/blogs/security/you-can-now-assign-mul...](https://aws.amazon.com/blogs/security/you-can-now-assign-multiple-mfa-devices-in-iam/) Apparently I haven't bothered with them for a few months and didn't notice, glad they finally added it. | | --- | --- | --- | | | |  |  | [OJFord](user?id=OJFord) [4 months ago](item?id=41473558)   | [root](#41438149) | [parent](#41452421) | [next](#41442582) [–]  Oh I've either overlooked this too (2022, not just a few months) or there's some caveat like 'one of each type' or something. Will have to try again. Presently have a user per key, named with the end of the keys ID so I know which to use, not brilliant but works. | | --- | --- | --- | | | |  |  | [jopsen](user?id=jopsen) [4 months ago](item?id=41442582)   | [root](#41438149) | [parent](#41439645) | [prev](#41447394) | [next](#41438826) [–]  Most sites let you print recovery keys. Print those keys out, and bury them in the backyard (or something like that). Or always add two keys. | | --- | --- | --- | | | |  |  | [mimimi31](user?id=mimimi31) [4 months ago](item?id=41438826)   | [parent](#41438149) | [prev](#41439645) | [next](#41438317) [–]  >I don't remember where I've used my YubiKey in the past. I track this in my password manager. Accounts where the YubiKey is enrolled are tagged "YubiKey (FIDO)". | | --- | --- | --- | | | |  |  | [dotancohen](user?id=dotancohen) [4 months ago](item?id=41439246)   | [root](#41438149) | [parent](#41438826) | [next](#41446895) [–]  This would probably be a good place to suggest to others here to track which accounts you've logged into via Google or other social media oath. I just had to log into stack overflow for the first time in years, and did not remember what I used to previously log in. Once I figured it out that information went into Keepass too. | | --- | --- | --- | | | |  |  | [pjot](user?id=pjot) [4 months ago](item?id=41439751)   | [root](#41438149) | [parent](#41439246) | [next](#41439720) [–]  Just fyi, Google lists sites you’ve used to “sign in with Google” in your account setting page. Apple and GitHub have this as well. | | --- | --- | --- | | | |  |  | [throwaway48476](user?id=throwaway48476) [4 months ago](item?id=41440811)   | [root](#41438149) | [parent](#41439751) | [next](#41439984) [–]  You should assume Google, GitHub, and Apple are hostile and try to limit your blast radius. If you have an account problem they have no customer service to help you. | | --- | --- | --- | | | |  |  | [qingcharles](user?id=qingcharles) [4 months ago](item?id=41442364)   | [root](#41438149) | [parent](#41440811) | [next](#41441621) [–]  I can't get into my Google account that's almost 20 years old because I only have the username, password, recovery email and have all the email forwarded to me, but I no longer have the phone number and they silently enabled 2FA SMS at some point. | | --- | --- | --- | | | |  |  | [quacksilver](user?id=quacksilver) [4 months ago](item?id=41443100)   | [root](#41438149) | [parent](#41442364) | [next](#41442543) [–]  I wonder if you can phone the phone number, explain the situation and offer to venmo/paypal the new assignee money for the 2FA code You could try every 3 - 5 years or so as it gets reassigned again | | --- | --- | --- | | | |  |  | [qingcharles](user?id=qingcharles) [4 months ago](item?id=41446207)   | [root](#41438149) | [parent](#41443100) | [next](#41442543) [–]  I tried this before, but I haven't tried for a couple of years -- you're right, it might have got reassigned -- I will try again! | | --- | --- | --- | | | |  |  | [layla5alive](user?id=layla5alive) [4 months ago](item?id=41442543)   | [root](#41438149) | [parent](#41442364) | [prev](#41443100) | [next](#41441621) [–]  +1 | | --- | --- | --- | | | |  |  | [hamburglar](user?id=hamburglar) [4 months ago](item?id=41441621)   | [root](#41438149) | [parent](#41440811) | [prev](#41442364) | [next](#41439984) [–]  Yes, this is exactly why I won’t use these federated identity features of platforms like this. I have a reasonable amount of trust that they are mostly secure, but I have zero trust that they will be *helpful* if I ever have account troubles. What I don’t need is to have Google (etc) auth problems cascade down to every other account I own. | | --- | --- | --- | | | |  |  | [vantassell](user?id=vantassell) [4 months ago](item?id=41461044)   | [root](#41438149) | [parent](#41441621) | [next](#41442548) [–]  What's the alternative? What do you use for your base "recovery account" email? | | --- | --- | --- | | | |  |  | [hamburglar](user?id=hamburglar) [4 months ago](item?id=41519463)   | [root](#41438149) | [parent](#41461044) | [next](#41442548) [–]  My own domain’s email, which can easily be forwarded wherever I want. | | --- | --- | --- | | | |  |  | [dotancohen](user?id=dotancohen) [4 months ago](item?id=41442548)   | [root](#41438149) | [parent](#41441621) | [prev](#41461044) | [next](#41439984) [–]  Very well stated, concisely. Thank you. | | --- | --- | --- | | | |  |  | [dotancohen](user?id=dotancohen) [4 months ago](item?id=41439984)   | [root](#41438149) | [parent](#41439751) | [prev](#41440811) | [next](#41439720) [–]  Thank you, I should review that. | | --- | --- | --- | | | |  |  | [shepherdjerred](user?id=shepherdjerred) [4 months ago](item?id=41439720)   | [root](#41438149) | [parent](#41439246) | [prev](#41439751) | [next](#41446895) [–]  1Password has this functionality and it's excellent. | | --- | --- | --- | | | |  |  | [nozzlegear](user?id=nozzlegear) [4 months ago](item?id=41446895)   | [root](#41438149) | [parent](#41438826) | [prev](#41439246) | [next](#41438317) [–]  I really wish Bitwarden had more robust tools for organizing, sorting and tagging passwords. The current system of sorting them into folders is practically useless. | | --- | --- | --- | | | |  |  | [i80and](user?id=i80and) [4 months ago](item?id=41438317)   | [parent](#41438149) | [prev](#41438826) | [next](#41438667) [–]  For sites that use a resident webauthn token like GitHub, you can list the known sites on the key. The UX for all this is not where it should be, however. | | --- | --- | --- | | | |  |  | [vaylian](user?id=vaylian) [4 months ago](item?id=41442386)   | [root](#41438149) | [parent](#41438317) | [next](#41438667) [–]  Are you sure that GitHub uses resident keys? I'm fairly sure they use non-resident keys. | | --- | --- | --- | | | |  |  | [bigfatkitten](user?id=bigfatkitten) [4 months ago](item?id=41443065)   | [root](#41438149) | [parent](#41442386) | [next](#41438667) [–]  They do now, but they didn't in the past. | | --- | --- | --- | | | |  |  | [vaylian](user?id=vaylian) [4 months ago](item?id=41443382)   | [root](#41438149) | [parent](#41443065) | [next](#41438667) [–]  Any idea why this was changed? The big advantage of non-residential keys is that they do not take up any space on the Fido token and thus you can have an unlimited number of them. | | --- | --- | --- | | | |  |  | [bigfatkitten](user?id=bigfatkitten) [4 months ago](item?id=41444272)   | [root](#41438149) | [parent](#41443382) | [next](#41438667) [–]  They wanted discoverable credentials to enable the magic username-less "sign in with passkey" auth flow. | | --- | --- | --- | | | |  |  | [vaylian](user?id=vaylian) [4 months ago](item?id=41446854)   | [root](#41438149) | [parent](#41444272) | [next](#41438667) [–]  I really couldn't care less about that. But I do care about the limited space on my fido token. | | --- | --- | --- | | | |  |  | [bigfatkitten](user?id=bigfatkitten) [4 months ago](item?id=41451217)   | [root](#41438149) | [parent](#41446854) | [next](#41438667) [–]  I've used five RK slots out of 25 available on my daily driver keys. Three of those are for SSO providers that provide access to the majority of the other apps I use. I opt in to "sign in with Google" etc wherever I can. I don't see this impacting me personally anytime soon, but that might change when more sites start insisting on rolling their own RKs. Hopefully future Yubikey models will ship with more flash, enabling many more RKs if you so desire. | | --- | --- | --- | | | |  |  | [webstrand](user?id=webstrand) [4 months ago](item?id=41438667)   | [parent](#41438149) | [prev](#41438317) | [next](#41439018) [–]  I've always hated that I couldn't clone or backup my personal yubikey. It's one of the reasons I've avoided using it everywhere. | | --- | --- | --- | | | |  |  | [thadt](user?id=thadt) [4 months ago](item?id=41438913)   | [root](#41438149) | [parent](#41438667) | [next](#41438776) [–]  Good news then, since the article is discussing the discovery of that exact feature. | | --- | --- | --- | | | |  |  | [kyrra](user?id=kyrra) [4 months ago](item?id=41438776)   | [root](#41438149) | [parent](#41438667) | [prev](#41438913) | [next](#41439018) [–]  I mean, that's the security story around it. You solve this and buying multiple yubikeys. Google and others support multiple keys, which gives you the backup story (I have 4 keys in various places). | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441400)   | [root](#41438149) | [parent](#41438776) | [next](#41438948) [–]  There's no fundamental reason it needs to be this difficult. Yubico or really any other manufacturer could totally e.g. release "Yubikey pairs", both a stateless CTAP2 implementation with the same root secret, that would correspondingly work at the same sites without having to synchronize anything. The reason they probably don't is that their entire trust model heavily depends on the perception that nobody, including the manufacturer, has a "reserve key" to any given Yubikey, even though of course the absence of such "linked keys" doesn't demonstrate the absence of any such backdoor. To be clear, I don't have any reason to believe Yubico does this, but it would probably be a harder story to tell, marketing-wise, if they sometimes selectively did, even if it's for a valid use case. | | --- | --- | --- | | | |  |  | [filleokus](user?id=filleokus) [4 months ago](item?id=41442294)   | [root](#41438149) | [parent](#41441400) | [next](#41438948) [–]  I mean you could also design keys to be synchronisable by the user. Generate a key-pair inside of key (2), transfer the public key from (2) to (1). Encrypt the the root key inside of (1) with the public key, transfer it over to (2). (Or just allow the user to generate the root key outside of the device and insert it) I honestly think the interest from customers is just too low. I would bet the majority of Yubico's customers are enterprises where this is not really an issue for most use cases. If you loose your key used for Entra ID / SSO, just go to IT support and get a new one enrolled to your account. Much cheaper than having synchronised hot spares (at 30-50 USD a pop) for thousands of employees. | | --- | --- | --- | | | |  |  | [KAMSPioneer](user?id=KAMSPioneer) [4 months ago](item?id=41444441)   | [root](#41438149) | [parent](#41442294) | [next](#41449145) [–]  But what stops Mallory from simply using this sync method to sync your private key to her Yubikey? I mean, look at the kerfuffle that's been kicked up by this vulnerability, and a key-sharing scheme like the above is much easier to exploit. (The second idea seems better assuming the user nukes the private key once the import is done. Otherwise the weakest link in the security chain will continue to be the opsec you practice with the private key file, in which case why spend the money on the Yubikey?) | | --- | --- | --- | | | |  |  | [filleokus](user?id=filleokus) [4 months ago](item?id=41446399)   | [root](#41438149) | [parent](#41444441) | [next](#41449145) [–]  Yeah of course the operation needs to be (cryptographically) authenticated somehow, I edited my comment in haste while going to work and accidentally messed it up completely. Thanks for pointing it out! The idea I thought of is to essentially use the public key of (2) to seed the generation of the root secret on (1). Meaning the sync-pairing-setup is destructive to the root secret, and can only be done at startup (or if you are willing to reset the device). (A mallory could of course reset it still, unless you have some e-fuse or something, but anyways that's only marginally worse than simply physically destroying it.) | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41449389)   | [root](#41438149) | [parent](#41446399) | [next](#41449145) [–]  > (A mallory could of course reset it still, unless you have some e-fuse or something, but anyways that's only marginally worse than simply physically destroying it.) You can already reset CTAP2-compliant FIDO keys using a (non-PIN-authenticated) command [1], so this wouldn't add anything that isn't already there. I think the real issue here is that users probably don't expect having to reset/initialize a Yubikey once they take possession of it. Given the horror stories of how e.g. Amazon commingles inventory, I wouldn't be surprised if fraudsters could succeed in getting paired keys back into the supply chain. Targeted attacks to friends/family can probably also not be ruled out ("hey, i got this spare yubikey in a black friday sale, want it?"), and unfortunately something like a family member or partner trying to take over somebody's accounts isn't unheard of. There are just too many ways for this to go wrong, and while Yubikey has, I believe, looked into this option in the past (there's a draft design doc for this idea somewhere), they probably came to the same conclusion. [1] [https://fidoalliance.org/specs/fido-v2.1-ps-20210615/fido-cl...](https://fidoalliance.org/specs/fido-v2.1-ps-20210615/fido-client-to-authenticator-protocol-v2.1-ps-errata-20220621.html#authenticatorReset) | | --- | --- | --- | | | |  |  | [filleokus](user?id=filleokus) [4 months ago](item?id=41455749)   | [root](#41438149) | [parent](#41449389) | [next](#41449145) [–]  > You can already reset CTAP2-compliant FIDO keys using a (non-PIN-authenticated) command [1], so this wouldn't add anything that isn't already there. Ah I did not know that, thanks. > There are just too many ways for this to go wrong, and while Yubikey has, I believe, looked into this option in the past (there's a draft design doc for this idea somewhere), they probably came to the same conclusion. Would be interesting to see the draft. But yes of course, there are tradeoffs. Having a LED similar to on the Bio to indicate it's paired could be one way, or selling pairs in a SKU where the user actually have to initialise them (with some clear physical difference to help solve the family/friends case). But it's complicated, and I think Yubico has made the correct decision that it's simply not worth it (not that it's impossible to do in a secure way). However, the lack of a resonable backup solution is keeping me away from Yubikey for any non-enterprise use, where a broken key would actually lock me out of an account for real. | | --- | --- | --- | | | |  |  | [zahllos](user?id=zahllos) [4 months ago](item?id=41449145)   | [root](#41438149) | [parent](#41442294) | [prev](#41444441) | [next](#41438948) [–]  HSMs support these kinds of scenario (high availability clusters, wrapped keys etc) but I agree. For enterprise use there's no interest or need, and for end users the feature would potentially be confusing. I just use multiple tokens, and I knew that the infineon sle78 was an intel 80251 derivative before this report ;) | | --- | --- | --- | | | |  |  | [jzig](user?id=jzig) [4 months ago](item?id=41438948)   | [root](#41438149) | [parent](#41438776) | [prev](#41441400) | [next](#41439018) [–]  You register 4 keys on each website? | | --- | --- | --- | | | |  |  | [DANmode](user?id=DANmode) [4 months ago](item?id=41439748)   | [root](#41438149) | [parent](#41438948) | [next](#41439439) [–]  If you have a hardware key setup for *anything* you want sustainably operated in the future, you register at least two keys, and when one fails or is lost, you pull the emergency backup out of a safe and register new one(s). | | --- | --- | --- | | | |  |  | [nicolas\_17](user?id=nicolas_17) [4 months ago](item?id=41440159)   | [root](#41438149) | [parent](#41439748) | [next](#41439439) [–]  You also have to pull the emergency backup out of the safe when signing up for a new thing. It's highly inconvenient. | | --- | --- | --- | | | |  |  | [throwaway48476](user?id=throwaway48476) [4 months ago](item?id=41440820)   | [root](#41438149) | [parent](#41440159) | [next](#41439439) [–]  Still more convenient than getting locked out. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441418)   | [root](#41438149) | [parent](#41440820) | [next](#41441040) [–]  True, but what's even more convenient than that is to just not use hardware authenticators for anything but the most important accounts/sites, and e.g. use syncing credentials (as provided by many password managers, Google, and Apple). The fraction of people willing to regularly schedule enroll-o-ramas at each of their accounts and each of their backup key locations is probably smaller than a percent of all potential WebAuthN users. | | --- | --- | --- | | | |  |  | [drdaeman](user?id=drdaeman) [4 months ago](item?id=41441040)   | [root](#41438149) | [parent](#41440820) | [prev](#41441418) | [next](#41439439) [–]  It becomes questionable if you’re halfway across the world from your safe. | | --- | --- | --- | | | |  |  | [michaelt](user?id=michaelt) [4 months ago](item?id=41439439)   | [root](#41438149) | [parent](#41438948) | [prev](#41439748) | [next](#41439017) [–]  You register multiple keys on a handful of critically important websites. Password manager. Primary e-mail account. DNS provider. Other than that, it's rarely supported and rarely worth the hassle when it is. | | --- | --- | --- | | | |  |  | [brendoelfrendo](user?id=brendoelfrendo) [4 months ago](item?id=41439548)   | [root](#41438149) | [parent](#41439439) | [next](#41439017) [–]  It *is* really annoying that more sites don't support multiple security keys, though. As far as I can tell, it's not encouraged by the FIDO Alliance and I can't think of a good technical reason for it. | | --- | --- | --- | | | |  |  | [fullstop](user?id=fullstop) [4 months ago](item?id=41439642)   | [root](#41438149) | [parent](#41439548) | [next](#41439619) [–]  I forget which financial institution I was using at the time, but they explicitly only supported *one* key. That is, you add a new one and the old one is expunged. Banks are so slow with this sort of thing, and still require SMS as a fallback option. | | --- | --- | --- | | | |  |  | [vel0city](user?id=vel0city) [4 months ago](item?id=41439619)   | [root](#41438149) | [parent](#41439548) | [prev](#41439642) | [next](#41440642) [–]  The vast majority of sites I've used Yubikeys for have supported multiple. About the only one that I use which still doesn't to my knowledge is Paypal. | | --- | --- | --- | | | |  |  | [brendoelfrendo](user?id=brendoelfrendo) [4 months ago](item?id=41441179)   | [root](#41438149) | [parent](#41439619) | [next](#41440642) [–]  Maybe I'm out of date, then! I don't enroll new keys very often. Paypal is a great example of a service that I would like to support multiple keys, though, so it's disappointing that they still only support one. | | --- | --- | --- | | | |  |  | [beezle](user?id=beezle) [4 months ago](item?id=41440642)   | [root](#41438149) | [parent](#41439548) | [prev](#41439619) | [next](#41439017) [–]  How often do you check to see that those other/backup keys are still secure? This attack becomes easier if the attacker knows of the secondary key(s) location and because of disuse they aren't even necessary to replace. | | --- | --- | --- | | | |  |  | [fragmede](user?id=fragmede) [4 months ago](item?id=41439017)   | [root](#41438149) | [parent](#41438948) | [prev](#41439439) | [next](#41439018) [–]  I mean, not all at once, but (I only have 3) there's the one when I bought a new laptop in 2019 which I setup when I got that laptop and became the old one when I got a new laptop in 2021 and setup a second one. And then the third one is a backup key I made at some point and is stored offsite in case I/my house gets robbed/burgled or my place burns down in a fire. It's inconvenient, sure, but it's more convenient than my bank accounts that are accessible online being cleaned out. | | --- | --- | --- | | | |  |  | [xaduha](user?id=xaduha) [4 months ago](item?id=41439018)   | [parent](#41438149) | [prev](#41438667) | [next](#41438906) [–]  > I don't remember where I've used my YubiKey in the past. I've yet to encounter a site that allows to enroll a FIDO device without setting up some other form of 2FA and for me it's TOTP which are kept in the app. | | --- | --- | --- | | | |  |  | [girvo](user?id=girvo) [4 months ago](item?id=41439713)   | [root](#41438149) | [parent](#41439018) | [next](#41438906) [–]  Yeah I stick to TOTP for the most part which means the YubiCo app has the list. I always enrol two keys though, one back up and one active. | | --- | --- | --- | | | |  |  | [Arch-TK](user?id=Arch-TK) [4 months ago](item?id=41438906)   | [parent](#41438149) | [prev](#41439018) | [next](#41445068) [–]  If you're using a yubikey solely for its PGP key stuff and you have a backup of the key or have a key hierarchy then replacing a yubikey is pretty trivial. (I know because it's my specific usecase.) | | --- | --- | --- | | | |  |  | [lima](user?id=lima) [4 months ago](item?id=41440062)   | [root](#41438149) | [parent](#41438906) | [next](#41445068) [–]  Only if the key is generated off-key | | --- | --- | --- | | | |  |  | [Arch-TK](user?id=Arch-TK) [4 months ago](item?id=41440115)   | [root](#41438149) | [parent](#41440062) | [next](#41445068) [–]  I meant to imply that with this statement: > and you have a backup of the key | | --- | --- | --- | | | |  |  | [duxup](user?id=duxup) [4 months ago](item?id=41445068)   | [parent](#41438149) | [prev](#41438906) | [next](#41439731) [–]  Everything about security / auth sucks in this age. Each time I go down this path with either work or personal stuff it's just people changing passwords all the time / having to re-login all the time ... there's no happy path without a huge hassle. | | --- | --- | --- | | | |  |  | [DANmode](user?id=DANmode) [4 months ago](item?id=41439731)   | [parent](#41438149) | [prev](#41445068) | [next](#41439659) [–]  > you cannot just replace a YubiKey. How would this work? | | --- | --- | --- | | | |  |  | [dboreham](user?id=dboreham) [4 months ago](item?id=41439659)   | [parent](#41438149) | [prev](#41439731) | [next](#41440361) [–]  Sounds like functionality you could implement on a blockchain... | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41440027)   | [root](#41438149) | [parent](#41439659) | [next](#41440361) [–]  You can implement most things on a blockchain, but only very rarely does that make any sense. | | --- | --- | --- | | | |  |  | [xyst](user?id=xyst) [4 months ago](item?id=41440361)   | [prev](#41438149) | [next](#41440291) [–]  > All YubiKey 5 Series (with firmware version below 5.7) are impacted by the attack … Oh, so I just need to update the firmware on the physical hardware token. > YubiKey Firmware is Not Upgradable [https://support.yubico.com/hc/en-us/articles/360013708760-Yu...](https://support.yubico.com/hc/en-us/articles/360013708760-YubiKey-Firmware-is-Not-Upgradable) L. So, Yubico is providing \_free\_ replacements, right? I have a handful of these Yubikeys… | | --- | --- | --- | | | |  |  | [gwbas1c](user?id=gwbas1c) [4 months ago](item?id=41441550)   | [parent](#41440361) | [next](#41440581) [–]  Yubikeys are intended to block phishing. This attack requires physical access. IE: If you're "worth it" to target IRL, you shouldn't use a Yubikey to begin with. Someone can swap your spare and you won't realize it until too late. | | --- | --- | --- | | | |  |  | [hi-v-rocknroll](user?id=hi-v-rocknroll) [4 months ago](item?id=41440581)   | [parent](#41440361) | [prev](#41441550) | [next](#41442509) [–]  5.4.3 5C Nano here. > L. So, Yubico is providing \_free\_ replacements, right? Nope, mitigations. :( [https://support.yubico.com/hc/en-us/articles/15705749884444-...](https://support.yubico.com/hc/en-us/articles/15705749884444-Infineon-ECDSA-Private-Key-Recovery-Customer-Resources) | | --- | --- | --- | | | |  |  | [anilakar](user?id=anilakar) [4 months ago](item?id=41442509)   | [parent](#41440361) | [prev](#41440581) | [next](#41440291) [–]  The last time Infineon chips had a crypto-breaking bug, Estonians got new ID cards for free. Meanwhile my less than two months old Yubikey 4 stopped working as a hardware attested PIV smartcard. | | --- | --- | --- | | | |  |  | [SahAssar](user?id=SahAssar) [4 months ago](item?id=41444255)   | [root](#41440361) | [parent](#41442509) | [next](#41440291) [–]  > Meanwhile my less than two months old Yubikey 4 stopped working as a hardware attested PIV smartcard. As in that the hardware broke? Or software stopped supporting it? | | --- | --- | --- | | | |  |  | [anilakar](user?id=anilakar) [4 months ago](item?id=41453175)   | [root](#41440361) | [parent](#41444255) | [next](#41440291) [–]  Software that keeps revocation lists (or whatever they are called) up to date stopped accepting keys generated on that hardware. The Yubikey itself continued to work just fine, but I had to switch to externally generated keys. | | --- | --- | --- | | | |  |  | [SahAssar](user?id=SahAssar) [4 months ago](item?id=41454600)   | [root](#41440361) | [parent](#41453175) | [next](#41440291) [–]  Unless the software is maintained by yubico I don't think its fair to say that the key "stopped working". | | --- | --- | --- | | | |  |  | [londons\_explore](user?id=londons_explore) [4 months ago](item?id=41440291)   | [prev](#41440361) | [next](#41439176) [–]  > due to a non constant-time modular inversion. That isn't exactly some subtle side channel involving tiny emissions of radio waves... The time depending on the secret data is pretty much the *first* thing that any side channel audit ought to check. It's super simple too - simply verify that all operations always take the same number of clock cycles, no matter the data. Errors too - they should always be thrown after a fixed number of clock cycles, independent of the data. How did auditors miss this? | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441529)   | [parent](#41440291) | [next](#41440764) [–]  > That isn't exactly some subtle side channel involving tiny emissions of radio waves... No, it seems to be exaclty that. What's non-constant-time is not the execution of the algorithm (as that would probably be exploitable even via USB, worst case), but rather the duty cycle of the externally-observeable RF side channel, if I understand the paper correctly. Infineon's implementation doesn't seem to be vulnerable to a pure timing attack, as otherwise that RF side channel wouldn't be needed. They also do implement nonce blinding, but unfortunately with a multiplicative mask significantly smaller than the size of the elliptic curve, so it's brute-forceable. | | --- | --- | --- | | | |  |  | [kayson](user?id=kayson) [4 months ago](item?id=41441701)   | [root](#41440291) | [parent](#41441529) | [next](#41440764) [–]  > What's non-constant-time is not the execution of the algorithm (as that would probably be exploitable even via USB, worst case), but rather the duty cycle of the externally-observeable RF side channel, if I understand the paper correctly. Are you sure? Section 4.3 (pg 52) starts with "The leaked sensitive information relates to the execution time of Algorithms 1 and 4." | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441804)   | [root](#41440291) | [parent](#41441701) | [next](#41440764) [–]  Maybe my terminology is off here, but a "pure time leak" to me would be something like a given operation varying in return time (i.e. execution time/latency being a function of some secret data), whereas this seems more like all operations take constant time, but in that constant time, RF emissions vary in their timing (e.g. on/off, strong/weak etc.) as a function of some secret data. | | --- | --- | --- | | | |  |  | [some\_furry](user?id=some_furry) [4 months ago](item?id=41440764)   | [parent](#41440291) | [prev](#41441529) | [next](#41440509) [–]  It's one of the first things I check for in my reviews of ECDSA code. It's embarrassing for Infineon. | | --- | --- | --- | | | |  |  | [SV\_BubbleTime](user?id=SV_BubbleTime) [4 months ago](item?id=41440509)   | [parent](#41440291) | [prev](#41440764) | [next](#41439176) [–]  Agreed. I was hoping to see something really high end. But it’s a standard timing attack with a fancy probe. The probe is cool though. | | --- | --- | --- | | | |  |  | [gwbas1c](user?id=gwbas1c) [4 months ago](item?id=41439176)   | [prev](#41440291) | [next](#41437630) [–]  > primary goal is to fight the scourge of phishing attacks. The EUCLEAK attack requires physical access to the device Something to consider: If someone is going to go through the effort to get physical access to a Yubikey, they only need to swap it with one that has a similar level of wear and a similar appearance. At that point, the victim will merely believe that their Yubikey is broken; and/or the attacker will have enough time to use the Yubikey. For example, I have two Yubikeys. Someone could sneak into my house, swap my spare, and I wouldn't figure it out until I go to use my spare. Basically: This attack is only "worth it" if your target is so valuable that you can target them in person. At that point, I'd think the target would use something a little more secure than a Yubikey. | | --- | --- | --- | | | |  |  | [SahAssar](user?id=SahAssar) [4 months ago](item?id=41444604)   | [parent](#41439176) | [next](#41439400) [–]  > At that point, the victim will merely believe that their Yubikey is broken; and/or the attacker will have enough time to use the Yubikey. For example, I have two Yubikeys. Someone could sneak into my house, swap my spare, and I wouldn't figure it out until I go to use my spare. You can inspect a yubikeys identity with `ykman list` so you can easily have checks to check if a yubikey is broken or actually swapped. If you have high security requirements you can do this periodically and/or have the physical location of the spare be physically secured. > use something a little more secure than a Yubikey For a hardware authenticator what would that be? | | --- | --- | --- | | | |  |  | [gwbas1c](user?id=gwbas1c) [4 months ago](item?id=41444975)   | [root](#41439176) | [parent](#41444604) | [next](#41439400) [–]  > You can inspect a yubikeys identity with Who's going to do that? Most of the time, when I use my Yubikey, I'm using it in a text field in a website. But, to quote <https://news.ycombinator.com/item?id=41439400> > Seriously, it's trivial to fry a key and swap it with the working spare if you have access to it So all an attacker needs to do is swap my Yubikey with a fried one. *Maybe* someone will figure it out if they're tracking the numbers written on the outside. | | --- | --- | --- | | | |  |  | [SahAssar](user?id=SahAssar) [4 months ago](item?id=41445316)   | [root](#41439176) | [parent](#41444975) | [next](#41439400) [–]  > Who's going to do that? The point is that if you require more security there are tools to check it. For me I'm comfortable enough that an attack requires physical access to my keys, so I don't. > Maybe someone will figure it out if they're tracking the numbers written on the outside. So if your opsec requires it keep track of which keys you have and their identities. If one is fried remove it from all the services you authenticate with. I'm not saying its perfect but you can create practices/procedures that protect (or at least let you know it happened) from most realistic attacks. | | --- | --- | --- | | | |  |  | [malfist](user?id=malfist) [4 months ago](item?id=41439400)   | [parent](#41439176) | [prev](#41444604) | [next](#41443147) [–]  Seriously, it's trivial to fry a key and swap it with the working spare if you have access to it | | --- | --- | --- | | | |  |  | [bigfatkitten](user?id=bigfatkitten) [4 months ago](item?id=41443147)   | [parent](#41439176) | [prev](#41439400) | [next](#41437630) [–]  > Basically: This attack is only "worth it" if your target is so valuable that you can target them in person. At that point, I'd think the target would use something a little more secure than a Yubikey Absolutely. In practice, the Yubikey is almost never going to be the weakest link in the chain. They could target your devices, intercept your communications, or serve warrants on/covertly exploit the services that host your data. | | --- | --- | --- | | | |  |  | [madars](user?id=madars) [4 months ago](item?id=41437630)   | [prev](#41439176) | [next](#41438457) [–]  PDF of the EUCLEAK writeup: [https://ninjalab.io/wp-content/uploads/2024/09/20240903\_eucl...](https://ninjalab.io/wp-content/uploads/2024/09/20240903_eucleak.pdf) Yubico blogpost: [https://www.yubico.com/support/security-advisories/ysa-2024-...](https://www.yubico.com/support/security-advisories/ysa-2024-03/) | | --- | --- | --- | | | |  |  | [shellcromancer](user?id=shellcromancer) [4 months ago](item?id=41438457)   | [prev](#41437630) | [next](#41438274) [–]  Fantastic research by NinjaLab. One of the most interesting parts to me from Yubico's advisory is that the Webauthn protocols attestation [1] is also defeated by this local cloning. Could the protocol have been better designed to resist this local cloning attack? > An attacker could exploit this issue to create a fraudulent YubiKey using the recovered attestation key. This would produce a valid FIDO attestation statement during the make credential resulting in a bypass of an organization’s authenticator model preference controls for affected YubiKey versions. 1. <https://www.w3.org/TR/webauthn-2/#attestation> | | --- | --- | --- | | | |  |  | [sitharus](user?id=sitharus) [4 months ago](item?id=41439280)   | [parent](#41438457) | [next](#41446960) [–]  > Could the protocol have been better designed to resist this local cloning attack? I don't see how, the attacker is cloning the secrets used to sign the request, if they have those secrets there's no way of distinguishing the clone from the original device. The whole security model of secure elements is preventing the keys from being extracted, if you can do that there's no more security than saving the key to a file on your computer. Of course to get the key they need to physically open the device, so unless someone actually takes your key it's more secure than saving them on you computer. | | --- | --- | --- | | | |  |  | [magicalhippo](user?id=magicalhippo) [4 months ago](item?id=41443297)   | [root](#41438457) | [parent](#41439280) | [next](#41440337) [–]  The login service could send not just the request, but also N random bits for the next session. These would be stored by the device and combined with the next sessions' request data before signing. The login site does it's own combining before checking the signature. This way any clone usage would be obvious. If the attacker uses the clone before you, your key wouldn't work for that site anymore. The site could even warn you if it keeps track of previous values. Likewise it limits the timeframe the attacker can use the clone. I guess even just 16 bits of data should make it quite resistant to guessing by the attacker. This requires some non-volatile storage to keep the "future bits", but at 16 bits you can do quite a few logins before having to do a single page erase. Then again, not my field so perhaps there's something I'm missing. | | --- | --- | --- | | | |  |  | [jtvjan](user?id=jtvjan) [4 months ago](item?id=41440337)   | [root](#41438457) | [parent](#41439280) | [prev](#41443297) | [next](#41440622) [–]  Perhaps some kind of rolling key system could've been used? If the key was rewritten on each successful login, either the attacker would have to use their cloned key immediately (alerting the user), or have their cloned key become useless the moment the user logs in again. This would only work with discoverable credentials, and would increase wear on the device's flash storage. | | --- | --- | --- | | | |  |  | [Scaevolus](user?id=Scaevolus) [4 months ago](item?id=41440622)   | [root](#41438457) | [parent](#41439280) | [prev](#41440337) | [next](#41446960) [–]  Even with extraction possible, it's much harder to get the keys from this device than a file on a computer. Security isn't just the binary of "possible" vs "impossible". It's about \*how expensive" that possibility is. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41446960)   | [parent](#41438457) | [prev](#41439280) | [next](#41438274) [–]  Not really, unfortunately, given that attestation practically always depends on some piece of secure hardware being able to guard an issuer-certified secret with which it can authenticate itself to a relying party and thereby bootstrap trust into any derived/stored secrets. If that attestation secret is extractable in any way, nothing prevents an attacker from creating a fake authenticator able to create fraudulent attestations, despite not behaving like an authentic one (i.e. in that it allows extracting stored credentials). You could theoretically try to mitigate the impact of a single leaked attestation secret by using something like e.g. indirect attestation and authenticator-unique attestation keys (rather than attestation keys shared by hundreds of thousands of authenticators, which is what Yubikey does), but it would be a probabilistic mitigation at best. | | --- | --- | --- | | | |  |  | [traceroute66](user?id=traceroute66) [4 months ago](item?id=41438274)   | [prev](#41438457) | [next](#41438069) [–]  I see the Yubico website says 5.7 or greater not affected. Elsewhere on the Yubico website[1] they state that a feature of 5.7 release was ... ```     Migration to Yubico’s own cryptographic library that performs the underlying cryptographic operations (decryption, signing, etc.) for RSA and ECC  ``` Hopefully they've had lots of eyes looking at that ! Not sure why anybody feels the need to write their own crypto libraries these days, there are so many implementations out there, both open and closed source. [1] [https://www.yubico.com/blog/now-available-for-purchase-yubik...](https://www.yubico.com/blog/now-available-for-purchase-yubikey-5-series-and-security-key-series-with-new-5-7-firmware/) | | --- | --- | --- | | | |  |  | [dlgeek](user?id=dlgeek) [4 months ago](item?id=41441300)   | [parent](#41438274) | [next](#41438568) [–]  > Not sure why anybody feels the need to write their own crypto libraries these days Because this is the second time they've had a security issue (the last time was even worse) because of their vendor? When your entire company is based around doing cryptography, it actually makes sense to hire enough applied cryptographers to own your own destiny. | | --- | --- | --- | | | |  |  | [Night\_Thastus](user?id=Night_Thastus) [4 months ago](item?id=41446555)   | [root](#41438274) | [parent](#41441300) | [next](#41438568) [–]  When was the first time? | | --- | --- | --- | | | |  |  | [dlgeek](user?id=dlgeek) [4 months ago](item?id=41451569)   | [root](#41438274) | [parent](#41446555) | [next](#41438568) [–]  2017: [https://www.yubico.com/support/security-advisories/ysa-2017-...](https://www.yubico.com/support/security-advisories/ysa-2017-01/) | | --- | --- | --- | | | |  |  | [vlovich123](user?id=vlovich123) [4 months ago](item?id=41438568)   | [parent](#41438274) | [prev](#41441300) | [next](#41442012) [–]  An embedded platform that hasn’t been ported to and may be impractical to port to because it’s so different. There may be other reasons and for closed source there may be economic considerations especially since this is a migration from a previous closed source (probably source available) vendor to an in house solution. | | --- | --- | --- | | | |  |  | [kevin\_thibedeau](user?id=kevin_thibedeau) [4 months ago](item?id=41438992)   | [root](#41438274) | [parent](#41438568) | [next](#41442012) [–]  MbedTLS has all the crypto primitives and runs anywhere. | | --- | --- | --- | | | |  |  | [bsder](user?id=bsder) [4 months ago](item?id=41439090)   | [root](#41438274) | [parent](#41438992) | [next](#41446984) [–]  And had so many *stupid* bugs that it looked like it was written by summer interns. Everybody I know who actually worries about actual security ran far, far away from it. If, however, you just need https for web pages, it's good enough to get started. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41446984)   | [root](#41438274) | [parent](#41438992) | [prev](#41439090) | [next](#41442012) [–]  Including the very, very limited environment of secure elements, and the capability of interfacing with the sometimes very specialized cryptographic accelerators/coprocessors required for adequate performance? We're talking low double-digit kilobytes of persistent storage, and sometimes single-digit kilobytes of memory here. Also, including a full TLS library seems like complete overkill if you only need some cryptographic primitives. These things are usually certified in expensive code and hardware audits; you essentially have to justify (in terms of adding complexity, and with it the possibility of vulnerabilities) and on top of that pay for every single line of code. | | --- | --- | --- | | | |  |  | [umvi](user?id=umvi) [4 months ago](item?id=41442012)   | [parent](#41438274) | [prev](#41438568) | [next](#41438069) [–]  When was 5.7 released? | | --- | --- | --- | | | |  |  | [ethanol-brain](user?id=ethanol-brain) [4 months ago](item?id=41444812)   | [root](#41438274) | [parent](#41442012) | [next](#41438069) [–]  Around June of this year. | | --- | --- | --- | | | |  |  | [mcwhy](user?id=mcwhy) [4 months ago](item?id=41438069)   | [prev](#41438274) | [next](#41438158) [–]  Infenion strikes again, 7 years ago: <https://en.wikipedia.org/wiki/ROCA_vulnerability> | | --- | --- | --- | | | |  |  | [tptacek](user?id=tptacek) [4 months ago](item?id=41438158)   | [prev](#41438069) | [next](#41437692) [–]  *3. Infineon has already a patch for their cryptographic library, to our knowledge it did not yet pass a Common Criteria certification evaluation.* For what it's worth: this doesn't matter even a little bit. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [4 months ago](item?id=41439032)   | [parent](#41438158) | [next](#41437692) [–]  As distinct from the attack itself? This is an interesting exercise and worth publishing, but in practice I don't see much real world consequence even for a notionally vulnerable device. | | --- | --- | --- | | | |  |  | [bangaladore](user?id=bangaladore) [4 months ago](item?id=41437692)   | [prev](#41438158) | [next](#41446590) [–]  Additionally, it looks like this vulnerability exist on on all Infineon trusted X (platform modules, microcontrollers, etc...) that use the same internal crypto libraries. | | --- | --- | --- | | | |  |  | [winux-arch](user?id=winux-arch) [4 months ago](item?id=41442947)   | [parent](#41437692) | [next](#41446590) [–]  This vulnerability is present when using the affected combination of Infineon Hardware with the infineon cryptolib | | --- | --- | --- | | | |  |  | [bangaladore](user?id=bangaladore) [4 months ago](item?id=41449658)   | [root](#41437692) | [parent](#41442947) | [next](#41446590) [–]  Are you sure about this? My understanding is that Infineon cryptolib causes the hardware vulnerability and that their TPMs, for example, internally use this library to implement the crypto parts of the TPM specification. | | --- | --- | --- | | | |  |  | [nabla9](user?id=nabla9) [4 months ago](item?id=41446590)   | [prev](#41437692) | [next](#41441483) [–]  Daniel J. Bernstein [https://mathstodon.xyz/@djb@cr.yp.to/113079723152809027](https://mathstodon.xyz/%40djb%40cr.yp.to/113079723152809027) > Some tools at different layers that would have stopped timing attacks against ECDSA nonce-inversion software: (1) the safegcd algorithm, <https://gcd.cr.yp.to;> (2) switching from ECDSA to EdDSA, typically Ed25519; (3) using TIMECOP (<https://bench.cr.yp.to/tips.html#timecop>) to scan for leaks. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441483)   | [prev](#41446590) | [next](#41442495) [–]  Does anybody know if plain ECDH (as used by e.g. ICAO biometric passports implementing PACE) or Ed25519 (assuming Infineon's chips/libraries implement that) are impacted? The paper specifically calls out PACE as also using modular inversion, but I don't understand either that or Ed25519 enough to get a sense for how bad this is for algorithms beyond just ECDSA. | | --- | --- | --- | | | |  |  | [tommiegannert](user?id=tommiegannert) [4 months ago](item?id=41442495)   | [prev](#41441483) | [next](#41437620) [–]  > The new YubiKey firmware 5.7 update (May 6th, 2024) switches the YubiKeys from Infineon cryptographic library to Yubico new cryptographic library. To our knowledge, this new cryptographic library is not impacted by our work. Found vuln in library used by many for 14 years. Solution: switch to custom code. That's a bold strategy. I hope it pays off. > Infineon has already a patch for their cryptographic library [---] | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41460683)   | [parent](#41442495) | [next](#41437620) [–]  On the other hand: The commonly-used library contained a vulnerability that went undetected for 14 years. Yubico is also very much in the business of embedded and side-channel-hardened cryptography. This might just be one of the cases where switching to custom code is the right move. | | --- | --- | --- | | | |  |  | [TavsiE9s](user?id=TavsiE9s) [4 months ago](item?id=41437620)   | [prev](#41442495) | [next](#41438645) [–]  Does not sound like they're issuing replacement devices. | | --- | --- | --- | | | |  |  | [rasse](user?id=rasse) [4 months ago](item?id=41437707)   | [parent](#41437620) | [next](#41437937) [–]  They really should. The recovery of the one secret the device is supposed to keep is catastrophic. Sure, the recovery itself might be an edge case, but Yubikey users buy the product to protect themselves from edge cases. | | --- | --- | --- | | | |  |  | [TavsiE9s](user?id=TavsiE9s) [4 months ago](item?id=41437737)   | [root](#41437620) | [parent](#41437707) | [next](#41437937) [–]  IIRC the last time something similar happened they issued replacement devices... I'm a bit baffled that they're not offering a replacement programme. | | --- | --- | --- | | | |  |  | [traceroute66](user?id=traceroute66) [4 months ago](item?id=41437959)   | [root](#41437620) | [parent](#41437737) | [next](#41437937) [–]  > I'm a bit baffled that they're not offering a replacement programme. That was under the previous leadership when Stina Ehrensvärd was CEO. Now they've taken VC money[1], and more recently merged with a listed SPAC[2] I suspect replacement devices will never happen because, you know, shareholders come first. I wish Yubico had some serious competition, but sadly they don't. NitroHSM is not the same thing (plus has flashable firmware, which leads to potential security risks). Tilitis looks interesting, but its far from maturity. [1] [https://www.yubico.com/blog/yubico-adds-new-round-of-investm...](https://www.yubico.com/blog/yubico-adds-new-round-of-investment-and-grows-board-of-directors/) [2] <https://www.yubico.com/blog/yubico-is-merging-with-acq-bure/> | | --- | --- | --- | | | |  |  | [baseballdork](user?id=baseballdork) [4 months ago](item?id=41439027)   | [root](#41437620) | [parent](#41437959) | [next](#41460699) [–]  > I wish Yubico had some serious competition, but sadly they don't. This likely wouldn’t qualify as “serious competition” but I have a few solokeys and they work fine for my use. <https://solokeys.com/> | | --- | --- | --- | | | |  |  | [koito17](user?id=koito17) [4 months ago](item?id=41439294)   | [root](#41437620) | [parent](#41439027) | [next](#41460699) [–]  I have used SoloKeys since v1. Currently own two v2 SoloKeys, and they "just work" for anything involving FIDO2. I specifically use them for storing SSH private keys and WebAuthn credentials. The key can be used on any device with a USB-C port (there is also a variant supporting NFC, but I don't have that variant) Despite being a bit careless with my keys (e.g. leaving them in a pocket and washing said clothing), they still work just fine. I highly recommend SoloKeys to anyone who wants to support open source hardware and firmware. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41460699)   | [root](#41437620) | [parent](#41437959) | [prev](#41439027) | [next](#41441442) [–]  > I wish Yubico had some serious competition, but sadly they don't. Looking at the list of FIDO certified hardware authenticators alone, they definitely do. My country's eID scheme even requires FIDO Level 2 certification, which Yubico hasn't had for a while, so they practically supported *only* non-Yubico authenticators until recently. | | --- | --- | --- | | | |  |  | [pxc](user?id=pxc) [4 months ago](item?id=41441442)   | [root](#41437620) | [parent](#41437959) | [prev](#41460699) | [next](#41443170) [–]  > I wish Yubico had some serious competition, but sadly they don't. NitroHSM is not the same thing What's not the same thing as what? There's no NitroHSM (Nitrokey has 2 different HSM-related products that are different kinds of things from each other, and neither is called that), and most Yubikeys aren't their special HSM devices. | | --- | --- | --- | | | |  |  | [bigfatkitten](user?id=bigfatkitten) [4 months ago](item?id=41443170)   | [root](#41437620) | [parent](#41437959) | [prev](#41441442) | [next](#41441737) [–]  Swissbit[1] is another, but I have no personal experience with their products. [1]<https://www.swissbit.com/en/products/ishield-key/> | | --- | --- | --- | | | |  |  | [toastal](user?id=toastal) [4 months ago](item?id=41441737)   | [root](#41437620) | [parent](#41437959) | [prev](#41443170) | [next](#41438433) [–]  > I wish Yubico had some serious competition, but sadly they don't Also mentioning OnlyKey <<https://onlykey.io>>. You don’t need to be some big corpo to be considered ‘serious’. | | --- | --- | --- | | | |  |  | [traceroute66](user?id=traceroute66) [4 months ago](item?id=41444374)   | [root](#41437620) | [parent](#41441737) | [next](#41438433) [–]  > You don’t need to be some big corpo to be considered ‘serious’. That's not what I meant and I suspect you know that. :) I meant everything from the Yubico hardware (more compact and less bulky than anything else out there) to the Yubico software (extensive featureset with more controllability than most other products out there). Also as I said already, Yubico is one of the few (only ?) one that does not permit firmware flashing. Most competitor keys have firmware flashing capability, which to me is a big no-no as its an attack surface just waiting for an exploit. That's what I meant by 'serious'. | | --- | --- | --- | | | |  |  | [TavsiE9s](user?id=TavsiE9s) [4 months ago](item?id=41438433)   | [root](#41437620) | [parent](#41437959) | [prev](#41441737) | [next](#41437937) [–]  Thank you I was not aware of that. That's unfortunate. | | --- | --- | --- | | | |  |  | [Retr0id](user?id=Retr0id) [4 months ago](item?id=41437937)   | [parent](#41437620) | [prev](#41437707) | [next](#41438159) [–]  I suppose I'm not a regular consumer, but I buy devices like these under the expectation that they will eventually succumb to practical low-cost attacks. I *would* be feeling a bit miffed if I bought one recently, though. | | --- | --- | --- | | | |  |  | [traceroute66](user?id=traceroute66) [4 months ago](item?id=41438025)   | [root](#41437620) | [parent](#41437937) | [next](#41438159) [–]  > I would be feeling a bit miffed if I bought one recently, though. One ? How about corporates who recently bought a batch ? ;) | | --- | --- | --- | | | |  |  | [Retr0id](user?id=Retr0id) [4 months ago](item?id=41438986)   | [root](#41437620) | [parent](#41438025) | [next](#41438159) [–]  Well then it's a mere budget rounding error. But, the overall risk assessment shouldn't have been much different. | | --- | --- | --- | | | |  |  | [zxcvgm](user?id=zxcvgm) [4 months ago](item?id=41438159)   | [parent](#41437620) | [prev](#41437937) | [next](#41437684) [–]  Yeah. That's what I came here to say too. Previously when their Yubikey 4's were found to be suceptible to the ROCA vulnerability [0], they issued replacements [1] for any customers who had affected devices. I had a few of those devices and they were replaced for free. I guess that's a disadvantage of having a non-upgradable firmware. They can't fix these devices that are already out in the field. [0] <https://en.wikipedia.org/wiki/ROCA_vulnerability> [1] [https://support.yubico.com/hc/en-us/articles/360021803580-In...](https://support.yubico.com/hc/en-us/articles/360021803580-Infineon-RSA-Key-Generation-Issue-Customer-Portal) | | --- | --- | --- | | | |  |  | [jcranmer](user?id=jcranmer) [4 months ago](item?id=41438966)   | [root](#41437620) | [parent](#41438159) | [next](#41437684) [–]  As I understand it, the ROCA vulnerability is "the secrets generated by a YubiKey may be susceptible to classic cryptographic breaks", something along the level of "the cipher is inherently weak." This vulnerability, meanwhile, appears to be in the class of "if someone has physical access to your hardware token, and has access to some specialized (expensive) hardware to do side-channel analysis, they might be able to do side-channel on your hardware token." But if someone has physical access to the hardware token... I mean, at that point, most people would consider it compromised anyways and wouldn't expect security guarantees from that point. | | --- | --- | --- | | | |  |  | [tptacek](user?id=tptacek) [4 months ago](item?id=41440839)   | [root](#41437620) | [parent](#41438966) | [next](#41437684) [–]  Yes: the *keys* the Y4 tokens generated were susceptible to attacks; here, it's the *device itself*. | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [4 months ago](item?id=41437684)   | [parent](#41437620) | [prev](#41438159) | [next](#41437831) [–]  Yeah, I see no indication of that on their blog, and you can't flash the firmware. | | --- | --- | --- | | | |  |  | [traceroute66](user?id=traceroute66) [4 months ago](item?id=41438011)   | [root](#41437620) | [parent](#41437684) | [next](#41437831) [–]  > and you can't flash the firmware. Not being able to flash the firmware is a feature, not a bug. :) Its the fundamental reason I won't buy NitroHSM because of the Rumsfelt unkown-unknowns about use of the firmware flash feature on NitroHSMs as a future exploit route. | | --- | --- | --- | | | |  |  | [wiktor-k](user?id=wiktor-k) [4 months ago](item?id=41438592)   | [root](#41437620) | [parent](#41438011) | [next](#41440590) [–]  > Not being able to flash the firmware is a feature, not a bug. :) It is a feature only if they ship replacement devices in case of issues like this. If they don't and you're left with a broken device then I'd rather count it as a "bug". | | --- | --- | --- | | | |  |  | [cryptonector](user?id=cryptonector) [4 months ago](item?id=41440590)   | [root](#41437620) | [parent](#41438011) | [prev](#41438592) | [next](#41437831) [–]  > Not being able to flash the firmware is a feature, not a bug. :) Indeed, but I didn't say otherwise :) | | --- | --- | --- | | | |  |  | [excalibur](user?id=excalibur) [4 months ago](item?id=41437831)   | [parent](#41437620) | [prev](#41437684) | [next](#41438645) [–]  I think it might be a tad early to say whether they will or not. This exploit doesn't even have a CVE yet. | | --- | --- | --- | | | |  |  | [aebeppos](user?id=aebeppos) [4 months ago](item?id=41438607)   | [root](#41437620) | [parent](#41437831) | [next](#41438645) [–]  CVE-2024-45678 | | --- | --- | --- | | | |  |  | [jacekm](user?id=jacekm) [4 months ago](item?id=41438645)   | [prev](#41437620) | [next](#41440822) [–]  If you have a Yubi Key and you are worried, read this part from their report: > the adversary needs to open the device (...) Then the device must be re-packaged and quietly returned to the legitimate user (...) assuming one can find a reliable way to open and close the device, we did not work on this part Yubi Keys are supposed to be tamper-evident and you can also put tamper-evident stickers on them. I am more concerned that a determined attacker may eventually find a way to record the signals without having to remove the casing. | | --- | --- | --- | | | |  |  | [mzs](user?id=mzs) [4 months ago](item?id=41438897)   | [parent](#41438645) | [next](#41440822) [–]  Once it's cloned can't the attacker create a new one for you that looks like the previous one you had? | | --- | --- | --- | | | |  |  | [cvhc](user?id=cvhc) [4 months ago](item?id=41439415)   | [root](#41438645) | [parent](#41438897) | [next](#41440822) [–]  In the FIDO2 case, only the derived keys are extracted. The master key that derives non-resident keys isn't extracted. So I think it's not possible to really copy the key. In the cases of FIDO2 resident keys (passkey) / PIV / GPG, maybe it's possible to extract and copy the exact keys. But I guess it can be detected through attestations. And I just looked at ykman command. It doesn't seem to allow you to import a passkey to a Yubikey. | | --- | --- | --- | | | |  |  | [alienchow](user?id=alienchow) [4 months ago](item?id=41440822)   | [prev](#41438645) | [next](#41440108) [–]  This requires the attacker to steal your key. When that happens, by the time they can get the secret key I've already revoked it. The biggest problem with FIDO keys isn't the fact that people can gain access to your accounts if it's physically stolen. I have redundant keys for backup access. But I have no idea which accounts I used the lost key for, in order to log into them one by one to revoke the key. How does everyone here keep track? A post-it note in the cookie jar? | | --- | --- | --- | | | |  |  | [heavyset\_go](user?id=heavyset_go) [4 months ago](item?id=41440962)   | [parent](#41440822) | [next](#41460722) [–]  >*This requires the attacker to steal your key. When that happens, by the time they can get the secret key I've already revoked it.* You're held in custody, detained, arrested, etc while your keys are dumped and accounts are accessed. You don't have the opportunity to revoke it without risking prison time. This situation can happen if you simply choose to fly or visit another country. | | --- | --- | --- | | | |  |  | [acdha](user?id=acdha) [4 months ago](item?id=41441060)   | [root](#41440822) | [parent](#41440962) | [next](#41443121) [–]  That’s a different situation outside of most people’s reasonable threat model. The police don’t need to clone your Yubikey if they can use it as much as they want, and if they decide to go NYPD on you nothing else you do is going to end in a different outcome unless your MFA check is an in-person confirmation in a location outside of their control. | | --- | --- | --- | | | |  |  | [bigfatkitten](user?id=bigfatkitten) [4 months ago](item?id=41443121)   | [root](#41440822) | [parent](#41440962) | [prev](#41441060) | [next](#41460722) [–]  Though in this scenario, your adversary doesn't need to resort to a technical attack to clone your key. They can compel you to comply, and keep you locked up until you do. | | --- | --- | --- | | | |  |  | [heavyset\_go](user?id=heavyset_go) [4 months ago](item?id=41453895)   | [root](#41440822) | [parent](#41443121) | [next](#41460722) [–]  They can, but assuming the law is actually being followed, you can only be held for so long without charges, and can be compelled to provide so much testimony. Being able to quickly clone keys gives any LEO an opportunity to access your digital life as part of a simple stop versus a full criminal case. | | --- | --- | --- | | | |  |  | [bigfatkitten](user?id=bigfatkitten) [4 months ago](item?id=41464295)   | [root](#41440822) | [parent](#41453895) | [next](#41460722) [–]  There's a whole world out there outside the US. In the UK, s 49 of the Regulatory and Investigatory Powers Act 2000 provides for 2-5 years' imprisonment if you were to fail to do so, depending on the nature of the offence under investigation. In Australia, s 3LA of the Crimes Act 1914 (Cth) imposes a similar obligation with a penalty of 5 or 10 years' imprisonment. If you find yourself in this position in Russia or China, they would just make you disappear for as long as they saw fit. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41460722)   | [parent](#41440822) | [prev](#41440962) | [next](#41447775) [–]  That's not the only possible attack here: FIDO direct attestation requires a key to be shared among either none or at least 100 000 devices (for privacy reasons): > If the authenticator puts the exact identical attestation key into a group of Authenticators (e.g., group of devices, phones, security keys...) so that the attestation key doesn't become a Correlation Handle, then each group of Authenticators MUST be at least 100,000 in number. If less than 100,000 Authenticators are made, then they MUST all have the same attestation key. Yubico, to my knowledge, has chosen the latter route; this means that compromising a single Yubikey's attestation key compromises at least 100k others immediately | | --- | --- | --- | | | |  |  | [WaitWaitWha](user?id=WaitWaitWha) [4 months ago](item?id=41447775)   | [parent](#41440822) | [prev](#41460722) | [next](#41441416) [–]  The article notes "The attack requires physical access to the secure element (few local electromagnetic side-channel acquisitions, i.e. *few minutes, are enough*) in order to extract the ECDSA secret key." (emphasis added) evil maid? | | --- | --- | --- | | | |  |  | [pitaj](user?id=pitaj) [4 months ago](item?id=41441416)   | [parent](#41440822) | [prev](#41447775) | [next](#41440108) [–]  They swap your device with an identical replacement that just appears to be broken. You are none the wiser while they clone your keys. | | --- | --- | --- | | | |  |  | [create-username](user?id=create-username) [4 months ago](item?id=41440108)   | [prev](#41440822) | [next](#41443963) [–]  I’ve created two TOTP 2FA on two different YubiKeys. During the TOPT configuration process, the website gives me a password that I enter on the YubiKey configuration app. Then, I do not store that password. But if I stored it on Bitwarden, I could easily create a YubiKey backup or set it on another app like ente. I have not kept that password because I considered that it could be easily compromise my security. I have kept the backup codes nonetheless. Should I keep the TOTP configuration password that the website gives me when I tell it that I cannot scan the QR code? | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41440165)   | [parent](#41440108) | [next](#41443963) [–]  > But if I stored it on Bitwarden, I could easily create a YubiKey backup or set it on another app like ente. If you do that, you could just use Bitwarden’s TOTP functionality directly. I don’t do that myself for important accounts as it effectively collapses 2FA into a single factor, but it’s an individual security/convenience tradeoff in the end. | | --- | --- | --- | | | |  |  | [create-username](user?id=create-username) [4 months ago](item?id=41442297)   | [root](#41440108) | [parent](#41440165) | [next](#41443963) [–]  I’d rather keep passwords, TOTP and backup keys in different services because I never saw the point of keeping them together with the passwords as you explain. With the YubiKey, TOTP has become more convenient and more secure than it used to be with Authy and then Ente. But maybe I should consider integrating them for most accounts | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41449430)   | [root](#41440108) | [parent](#41442297) | [next](#41443963) [–]  That's reasonable, but then you can't store the TOTP setup code in your regular password manager (and vice versa, if you do, that's not different from just using the PW manager's native TOTP calculation feature). The advantage of using the Yubikey for TOTP is that (I believe) there's no way to extract the setup secret from it, so even if somebody gains temporary access to it, they can't exfiltrate your future OTPs and would have to attempt a log-in right there and then. Storing the secret in a recoverable way negates that property. | | --- | --- | --- | | | |  |  | [nullc](user?id=nullc) [4 months ago](item?id=41443963)   | [prev](#41440108) | [next](#41437672) [–]  It's really easy to blind a variable time modular inverse, assuming you have a random number generator handy: you want the inverse of x, compute instead the inverse of x\*r, then multiply the result with r. So I wonder if some things using the same chip/library are not actually vulnerable because they blinded the operation? It's \*better\* to use a constant time algorithm, but that's harder to do in a curve generic way and has a pretty significant performance impact (particular before the safegcd paper). | | --- | --- | --- | | | |  |  | [fuklief](user?id=fuklief) [4 months ago](item?id=41446693)   | [parent](#41443963) | [next](#41437672) [–]  > It's *better* to use a constant time algorithm, but that's harder to do in a curve generic way and has a pretty significant performance impact (particular before the safegcd paper). Crypto noob here, but isn't modular inverse the same as modular exponentiation through Fermat's little theorem? I.e., x^-1 mod n is the same as computing x^{n - 2} mod n which we know how to do in a constant-time way with a Montgomery ladder. Or is that too slow? | | --- | --- | --- | | | |  |  | [nullc](user?id=nullc) [4 months ago](item?id=41448742)   | [root](#41443963) | [parent](#41446693) | [next](#41437672) [–]  The powering ladder is unfortunately quite slow compared to the obvious vartime algorithm which is what temps these things to have a vartime algorithim in the first place, though too slow depends on the application. It doesn't help that these chips are underpowered to begin with. Aside, for the FLT powering ladder n need needs to be prime, but it isn't when there is a cofactor, though there is a generalization that needs phi(n)... I probably shouldn't have made a comment on the issue of being curve specific since the problem is worse for sqrt(). | | --- | --- | --- | | | |  |  | [noodlesUK](user?id=noodlesUK) [4 months ago](item?id=41437672)   | [prev](#41443963) | [next](#41439079) [–]  From a practical perspective, what protection does the use of a fido2 PIN provide here? Is the EM side channel exposed without knowledge of the PIN? In any case this is a tremendous attack, good job! | | --- | --- | --- | | | |  |  | [sounds](user?id=sounds) [4 months ago](item?id=41437768)   | [parent](#41437672) | [next](#41439079) [–]  Information is light about an actual Proof of Concept here. I have no actual knowledge, and it makes sense to assume the PIN is required to implement the EM side channel attack, as without a valid PIN the old, vulnerable Infineon library most likely does not complete all the steps. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41438354)   | [root](#41437672) | [parent](#41437768) | [next](#41439079) [–]  Requiring/not requiring the PIN is a per-authentication flag that the RP can set though, as far as I know. Since the RP challenge is not authenticated in any way, nothing seems to prevent an attacker from just preparing a "user verification not required" challenge and getting the Yubikey to sign it. | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41440185)   | [root](#41437672) | [parent](#41438354) | [next](#41439079) [–]  Oh, potentially important corollary: This means that this vulnerability allows breaking an “always UV” credential as well: - Do as many UP-only challenges as required on a stolen Yubikey to extract the private key, not involving the RP (or maybe a single incomplete one, to discover the credentialID) - Use the recovered private key in an UV challenge against the RP | | --- | --- | --- | | | |  |  | [Arch-TK](user?id=Arch-TK) [4 months ago](item?id=41439079)   | [prev](#41437672) | [next](#41439483) [–]  Don't have high hopes for this but I just requested a replacement device through their support system as the offered mitigations are not something I would like to consider. | | --- | --- | --- | | | |  |  | [klaussilveira](user?id=klaussilveira) [4 months ago](item?id=41439483)   | [prev](#41439079) | [next](#41444638) [–]  Subdermal Yubikey when? | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41439693)   | [parent](#41439483) | [next](#41439979) [–]  Whenever you're ready! Hardware: <https://dangerousthings.com/product/flexsecure/> Software: <https://github.com/darconeous/u2f-javacard> (or <https://github.com/BryanJacobs/FIDO2Applet> if you're feeling experimentative, which you likely do if you're considering a subdermal Java Card implant) And unlike a Yubikey, this one's even field-updateable :) (At least the applications; not so much the Java Card and OS) | | --- | --- | --- | | | |  |  | [toastal](user?id=toastal) [4 months ago](item?id=41441831)   | [root](#41439483) | [parent](#41439693) | [next](#41442214) [–]  Are they all based on Java? | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41441858)   | [root](#41439483) | [parent](#41441831) | [next](#41442214) [–]  There also seem to be simpler fixed-function implants (e.g. NTAG or similar NDEF-storage-only tags), but I don’t think there’s anything non-Java capable of doing something as complex as CTAP2. For something that potentially needs surgery to remove from your body, I’d go for the most capable secure element you can afford for maximum flexibility and future proofing anyway; usually that’s also Java Card. | | --- | --- | --- | | | |  |  | [inhumantsar](user?id=inhumantsar) [4 months ago](item?id=41442214)   | [root](#41439483) | [parent](#41439693) | [prev](#41441831) | [next](#41439979) [–]  oooo that is tempting | | --- | --- | --- | | | |  |  | [DANmode](user?id=DANmode) [4 months ago](item?id=41439979)   | [parent](#41439483) | [prev](#41439693) | [next](#41444638) [–]  Troll the right ActivityPub posts, you'll find someone(s) who have put an NFC key under their skin. | | --- | --- | --- | | | |  |  | [SV\_BubbleTime](user?id=SV_BubbleTime) [4 months ago](item?id=41440520)   | [root](#41439483) | [parent](#41439979) | [next](#41444638) [–]  I know a guy that did it. Deviant is a lock picking guru, and this is a nerdy trick he does occasionally. | | --- | --- | --- | | | |  |  | [gatestone](user?id=gatestone) [4 months ago](item?id=41444638)   | [prev](#41439483) | [next](#41438264) [–]  Can you explain me, why do you need to be online to extract the private key? Can't you just steal the token, input the nonces offline, and meter timing? Then, crunch out the private key, and only then, if needed, phish the password? | | --- | --- | --- | | | |  |  | [lxgr](user?id=lxgr) [4 months ago](item?id=41447298)   | [parent](#41444638) | [next](#41438264) [–]  Yubikeys and similar FIDO hardware authenticators roughly speaking have two modes of operation: Resident/discoverable credentials are stored on the hardware itself. You can attack these completely offline. Non-discoverable credentials are not stored on the hardware. To get the authenticator to perform a private key operation (which is a prerequisite for being able to exfiltrate the private key using this attack), you need to supply the credential ID to it, which contains the data required for the authenticator to re-derive the private key. Usually (i.e. in the WebAuthN-as-a-second-factor use case), a website will only reveal candidate client IDs upon successfully entering your password. | | --- | --- | --- | | | |  |  | [jenny91](user?id=jenny91) [4 months ago](item?id=41438264)   | [prev](#41444638) | [next](#41442215) [–]  You have to practically destroy the YubiKey in the process of extracting the secret, however. | | --- | --- | --- | | | |  |  | [clysm](user?id=clysm) [4 months ago](item?id=41440943)   | [parent](#41438264) | [next](#41439992) [–]  Doubtful once the attack is refined. Their capture requirement of 200 traces is trivially low. | | --- | --- | --- | | | |  |  | [Pr0ject217](user?id=Pr0ject217) [4 months ago](item?id=41439992)   | [parent](#41438264) | [prev](#41440943) | [next](#41442215) [–]  Is that relevant? The secret is the value. | | --- | --- | --- | | | |  |  | [lima](user?id=lima) [4 months ago](item?id=41440258)   | [root](#41438264) | [parent](#41439992) | [next](#41442215) [–]  Could just steal the key at that point. | | --- | --- | --- | | | |  |  | [globalise83](user?id=globalise83) [4 months ago](item?id=41442215)   | [prev](#41438264) | [next](#41440900) [–]  Infineon is a listed company, not sure how much news will be published on this before German and Austrian markets open in a couple of hours so could be a profitable short selling opportunity. | | --- | --- | --- | | | |  |  | [rasengan0](user?id=rasengan0) [4 months ago](item?id=41440900)   | [prev](#41442215) | [next](#41439814) [–]  gotta bunch of yubis and was about to ask about <https://store.google.com/product/titan_security_key> then found <https://ninjalab.io/a-side-journey-to-titan/> by the same folks | | --- | --- | --- | | | |  |  | [altairprime](user?id=altairprime) [4 months ago](item?id=41439814)   | [prev](#41440900) | [next](#41442580) [–]  > YubiEnterprise Subscription customers can leverage their available replacement entitlements to receive YubiKeys with the new firmware. | | --- | --- | --- | | | |  |  | [jwr](user?id=jwr) [4 months ago](item?id=41442580)   | [prev](#41439814) | [next](#41438196) [–]  Good thing I use my YubiKeys with RSA keys, protected with a PIN, following the most excellent guide by DrDuh. | | --- | --- | --- | | | |  |  | [lawn](user?id=lawn) [4 months ago](item?id=41442965)   | [parent](#41442580) | [next](#41438196) [–]  Be a bit careful with RSA keys as keys shorter than 3072 aren't recommended anymore. | | --- | --- | --- | | | |  |  | [wkat4242](user?id=wkat4242) [4 months ago](item?id=41438196)   | [prev](#41442580) | [next](#41437628) [–]  Huh I thought they used an NXP secure element. But I see now that was the yubikey neo, the 5 is Indeed infineon | | --- | --- | --- | | | |  |  | [tomas789](user?id=tomas789) [4 months ago](item?id=41437628)   | [prev](#41438196) | [next](#41438816) [–]  > This vulnerability – that went unnoticed for 14 years and about 80 highest-level Common Criteria certification evaluations This is yet another example of why you don’t f around with crypto and auth in general. Just use best practices and you *might* be OK. | | --- | --- | --- | | | |  |  | [mistercheph](user?id=mistercheph) [4 months ago](item?id=41437894)   | [parent](#41437628) | [next](#41438816) [–]  Don't ask question about cryptography friend! Just use excellent library that implement best practice elliptic curve parameters chosen (of course) \*completely\* randomly from hat and stop thinking about it! | | --- | --- | --- | | | |  |  | [tomas789](user?id=tomas789) [4 months ago](item?id=41438202)   | [root](#41437628) | [parent](#41437894) | [next](#41438816) [–]  No worries. I trust my government. | | --- | --- | --- | | | |  |  | [AdmiralAsshat](user?id=AdmiralAsshat) [4 months ago](item?id=41438816)   | [prev](#41437628) | [next](#41442458) [–]  Did they verify whether older keys are vulnerable, or did they not bother to test? | | --- | --- | --- | | | |  |  | [visualblind](user?id=visualblind) [4 months ago](item?id=41442458)   | [prev](#41438816) | [next](#41440538) [–]  Looks like the site is down. Appears to be a VPS on Ghandi's platform. | | --- | --- | --- | | | |  |  | [rpncreator](user?id=rpncreator) [4 months ago](item?id=41440538)   | [prev](#41442458) | [next](#41443770) [–]  TIL you need to update the firmware on Yubikeys. | | --- | --- | --- | | | |  |  | [HeatrayEnjoyer](user?id=HeatrayEnjoyer) [4 months ago](item?id=41440658)   | [parent](#41440538) | [next](#41443770) [–]  Update by buying. | | --- | --- | --- | | | |  |  | [badgersnake](user?id=badgersnake) [4 months ago](item?id=41443007)   | [root](#41440538) | [parent](#41440658) | [next](#41442202) [–]  Last time they sent me a replacement for free. This was for a problem with generating ssh keys. | | --- | --- | --- | | | |  |  | [autoexec](user?id=autoexec) [4 months ago](item?id=41442202)   | [root](#41440538) | [parent](#41440658) | [prev](#41443007) | [next](#41443770) [–]  That's convenient for the company selling products that need to be updated to be secure. | | --- | --- | --- | | | |  |  | [hacker\_88](user?id=hacker_88) [4 months ago](item?id=41443770)   | [prev](#41440538) | [next](#41437900) [–]  The happiest are Hollywood writers . | | --- | --- | --- | | | |  |  | [ycombinatrix](user?id=ycombinatrix) [4 months ago](item?id=41437900)   | [prev](#41443770) | [next](#41442743) [–]  i guess this breaks fido attestation for a lot of use cases since most yubikeys can be spoofed now | | --- | --- | --- | | | |  |  | [nicman23](user?id=nicman23) [4 months ago](item?id=41442743)   | [prev](#41437900) | [next](#41437575) [–]  really never got the whole concept of what is basically is a tpm that advertises "money here" software otp in a phone or something that is able to be updated seems to be a better choice | | --- | --- | --- | | | |  |  | [jcfrei](user?id=jcfrei) [4 months ago](item?id=41437575)   | [prev](#41442743) [–]  FYI: This page gets stuck at 99% on firefox (130.0). | | --- | --- | --- | | | |  |  | [bitexploder](user?id=bitexploder) [4 months ago](item?id=41437795)   | [parent](#41437575) | [next](#41439435) [–]  [https://ninjalab.io/wp-content/uploads/2024/09/20240903\_eucl...](https://ninjalab.io/wp-content/uploads/2024/09/20240903_eucleak.pdf) Write up there. | | --- | --- | --- | | | |  |  | [totony](user?id=totony) [4 months ago](item?id=41439435)   | [parent](#41437575) | [prev](#41437795) | [next](#41437605) [–]  I used ublock origin to block the overlay and loading indicator. A loading indicator on a website is bad practice anyway imo | | --- | --- | --- | | | |  |  | [scrlk](user?id=scrlk) [4 months ago](item?id=41437605)   | [parent](#41437575) | [prev](#41439435) | [next](#41443174) [–]  Was quite slow for me, but eventually loaded. Here's the Yubikey security advisory: [https://www.yubico.com/support/security-advisories/ysa-2024-...](https://www.yubico.com/support/security-advisories/ysa-2024-03/) | | --- | --- | --- | | | |  |  | [USiBqidmOOkAqRb](user?id=USiBqidmOOkAqRb) [4 months ago](item?id=41443174)   | [parent](#41437575) | [prev](#41437605) | [next](#41437675) [–]   ```     .pace-overlay{display:none}  ``` I don't get why people add these loaders. | | --- | --- | --- | | | |  |  | [amatecha](user?id=amatecha) [4 months ago](item?id=41437675)   | [parent](#41437575) | [prev](#41443174) [–]  Yeah, same. Not sure why - nothing is loading. Just a broken site theme, I guess. Switching to reader mode in your respective browser should instantly show the post content (or at least it did for me in Firefox). | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |


