- **Root cause of vulnerability**: The `__Secure-zitadel-useragent` cookie, used by ZITADEL to identify user agents and sessions, was accessible on subdomains of the ZITADEL instance.
- **Weaknesses/vulnerabilities present**: The vulnerability is a session fixation issue. The cookie handling allowed access from subdomains, creating an attack vector.
- **Impact of exploitation**: An attacker could gain access to a victim's account by providing a malicious link on a subdomain that forces the user to log in through it. This could lead to account takeover, bypassing MFA if the victim is not already logged in. Once the attacker has the session cookie, they can potentially access the victim's account without further authentication.
- **Attack vectors**: The attack vector is a malicious link on a subdomain of the ZITADEL instance. This requires either the attacker being able to control DNS or a XSS vulnerability in an application hosted on a subdomain.
- **Required attacker capabilities/position**: The attacker needs to:
    1. Control a subdomain of the ZITADEL instance or find an XSS vulnerability on one
    2. Create a malicious link on the subdomain to entice the victim to log in through it.
    3. Have the victim click the link and log in through it, thus setting the malicious cookie on the victim's browser.