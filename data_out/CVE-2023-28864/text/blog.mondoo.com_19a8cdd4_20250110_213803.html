

[![](https://cdn.prod.website-files.com/656db9d2a0a4556c7301b80a/656f17da46fdee5771b1c15a_logo-mondoo.svg)](/)Product

[Mondoo Platform](/platform)[Features and Capabilities](/features-and-capabilities)[Integrations](/integrations)[Pricing](/pricing)[Unified Security Posture Management](/security-posture-management)[Vulnerability Management](/vulnerability-management)[Compliance Automation](/compliance)Solutions

[Financial Services](/case-studies/industries-financial-services)[Manufacturing](/case-studies/industries-manufacturing)[Healthcare](/case-studies/industries-healthcare)Resources

[Blog](/blog)[Whitepaper](/whitepaper)[Support](/support)Open Source

[cnquery](/cnquery)[cnspec](/cnspec)[Log in](https://console.mondoo.com/login)[Get started](/sign-up)[![](https://cdn.prod.website-files.com/656db9d2a0a4556c7301b80a/657057dcfc28f3d8c4af339a_arrow-right-1.svg)Blog home](/blog)Infrastructure as Code
# Chef Infra Server CVE-2023-28864 Impact and Remediation

![](https://cdn.prod.website-files.com/656e21ae2abfbeb6529f9040/65e9a5989a6c42aa1f6f6588_tim.webp)Tim SmithJuly 17, 20233 min read

On June 14th, Progress Software announced the release of Chef Infra Server 15.7. The release includes additional platform support and resolves several OpenJDK CVEs by bundling a new release of OpenJDK. However, a minor yet significant detail might have been overlooked â the resolution of CVE-2023-28864.

At the time of the announcement, an embargo had kept the CVE details hidden on the MITRE CVE page. Now that the embargo has been lifted, we disclose that CVE-2023-28864 is a CVE within Chef Infra Server 12.0-15.6. It has potential to expose sensitive Chef Infra node data to an unprivileged local user.

## Understanding the impact

Chef Infra Server, as a configuration management tool, lies at the heart of your infrastructure. It indexes data across all systems under management. This indexed data can be as harmless as CPU counts or as sensitive as usernames and passwords stored within node attributes.

All node data collected by Chef Infraâs Ohai asset inventory system or set as node attributes are returned to the Chef Infra Server for indexing. The data is then stored in either an embedded Opensearch/Elasticsearch (depending on the release) database or externally in cloud provider equivalents.

Database credentials are stored in a secured configuration file. However, flaws exist in how this configuration file is handled. When an administrator configures Chef Infra Server, they must run the **`chef-server-ctl reconfigure`** command to apply these settings. As part of the execution of this command, any changed configuration files, including the one containing the OpenSearch/Elasticsearch credentials, are backed up into a world-readable backup directory.

A non-privileged local user could read these credentials from the backup directory. With the credentials, they could extract and decode node data from the OpenSearch/Elasticsearch database. This could potentially expose sensitive infrastructure configuration data to attackers, including the credentials for additional internal and external systems.

## Steps for remediation

Chef Infra Server 15.7 improved the security of the backup directory to prevent non-privileged users from reading sensitive configuration data. The best possible remediation step is to immediately upgrade to Chef Infra Server 15.7 or later. This will not only resolve CVE-2023-28864, but also ensure that you are protected against other CVEs in bundled 3rd party components. See [Chef Infra Server release announcements](https://discourse.chef.io/search?expanded=true&q=Chef%20Infra%20Server%20%23chef-release%20order%3Alatest) for more details on these CVEs.

If upgrading your Chef Infra Server is not feasible due to licensing or downtime concerns, you can still protect your system against local attacks by manually securing the backups directory:

`bash chmod 600 /var/opt/opscode/local-mode-cache/backup`

Copy

## Detect if you are vulnerable with cnspec

Determining when systems have been manually remediated and when the correct patch releases have been applied can be challenging. Weâve developed Mondoo security policies for Chef Infra Server and Chef Infra Client to assist with this. These policies allow continuous and agentless evaluation of your Chef Infra Server and Client installationsâ security, helping to keep your infrastructure secure.

Locally evaluate Chef Infra Server against CVE-2023-28864:`â`

```

bash chmod 600 /var/opt/opscode/local-mode-cache/backup

```

â`â`

![Chef Infra Server](https://cdn.prod.website-files.com/656e21ae2abfbeb6529f9040/66c396af04ee4a079a431384_65eadc20d58c9e6e1cdf283d_5E0zNDtXojknMMOZtSaSk0go1gup-pNV2PQgrCOWKm_MdhCRFrTCELGcgKa_r6fT5zc5OXyomn9eeCJBrSGM7x3iTMnW6LV2CiNGMPBIjmrSU5w49GfMo0li703Hh8nAGhE2Eyb0m90gxZJx7tR6uLk.png)

Donât want to install agents on your server? You can remotely evaluate Chef Infra Server using cnspec from your local workstation:`â`

```

bash -c "$(curl -sSL https://install.mondoo.com/sh)"
curl https://raw.githubusercontent.com/mondoohq/cnspec-policies/main/community/chef-infra-server.mql.yaml --output chef-infra-server.mql.yaml
sudo cnspec scan local --policy-bundle chef-infra-server.mql.yaml --share

```
#### Find and fix the security risks that pose the biggest threat to your business.

[Get started![](https://cdn.prod.website-files.com/656db9d2a0a4556c7301b80a/656e3da3a2a221bb7cb98679_arrow-right-1.svg)](/pricing)![]()
## Secure Your Digital Infrastructure Today

Don't leave your systems exposed to threats like CVE-2023-28864. With our open-source solution, cnspec, you can effectively detect and address these vulnerabilities.

Head to [our GitHub page](https://github.com/mondoohq/cnspec) to download cnspec and run the Chef Infra Client and Chef Infra Server policies today.

![](https://cdn.prod.website-files.com/656e21ae2abfbeb6529f9040/65e9a5989a6c42aa1f6f6588_tim.webp)

Tim Smith

Tim Smith is a Product Manager at Mondoo. Heâs been working in web operations and software development roles since 2007 and port scanning class As since 1994. He downloaded his first Linux distro on a 14.4 modem. Tim most recently held positions at Limelight Networks, Cozy Co, and Chef Software.

### You might also like

![](https://cdn.prod.website-files.com/656e21ae2abfbeb6529f9040/676df49fb48837bfbc3c03be_december2024.png)
###### Release Highlights December 2024

Letha DunnTim SmithDecember 26, 2024![](https://cdn.prod.website-files.com/656e21ae2abfbeb6529f9040/67646b8afb869dbb7d2efaa6_defender-blog-post.png)
###### Augment Microsoft Defender for Cloud with Mondoo Exposure Management

Deborah GaleaDecember 19, 2024![](https://cdn.prod.website-files.com/656e21ae2abfbeb6529f9040/674f80f6d367f80cf32baaa1_november%202024%20highlights.png)Releases
###### Mondoo November 2024 Release Highlights

Letha DunnTim SmithNovember 30, 2024![](https://cdn.prod.website-files.com/656db9d2a0a4556c7301b80a/65705863ce85b20bd697519b_flare.svg)
# Stay informed with our news and new articles

Subscribe

Thank you! Your submission has been received!Oops! Something went wrong while submitting the form.Product[Mondoo Platform](/platform)[Features and Capabilities](/features-and-capabilities)[Integrations](/integrations)[Pricing](/pricing)[SystemÂ Status](https://status.mondoo.com/)Solutions[Financial Services](/case-studies/industries-financial-services)[Manufacturing](/case-studies/industries-manufacturing)[Healthcare](/case-studies/industries-healthcare)Open Source[cnquery](/cnquery)[cnspec](/cnspec)Resources[Blog](/blog)[Whitepaper](/whitepaper)[Support](/support)Company[About](/about-us)[Contact](/contact)[Newsroom](/newsroom)[Careers](https://jobs.ashbyhq.com/mondoo)

Â© 2024 Mondoo Inc.

Made by [tonik](http://tonik.com)

[Privacy Policy](/privacy-policy)[Terms of Service](/terms-of-service)Cookie Settings

Â© 2023 Mondoo Inc.

Made by [tonik](http://tonik.com)

By clicking **âAccept All Cookiesâ**, you agree to the storing of cookies on your device to enhance site navigation, analyze site usage, and assist in our marketing efforts. View our [Privacy Policy](/privacy-policy) for more information.PreferencesDenyAccept

Privacy Preference CenterWhen you visit websites, they may store or retrieve data in your browser. This storage is often necessary for the basic functionality of the website. The storage may be used for marketing, analytics, and personalization of the site, such as storing your preferences. Privacy is important to us, so you have the option of disabling certain types of storage that may not be necessary for the basic functioning of the website. Blocking categories may impact your experience on the website.Reject all cookiesAllow all cookiesManage Consent Preferences by CategoryEssential**Always Active**These items are required to enable basic website functionality.MarketingEssentialThese items are used to deliver advertising that is more relevant to you and your interests. They may also be used to limit the number of times you see an advertisement and measure the effectiveness of advertising campaigns. Advertising networks usually place them with the website operatorâs permission.PersonalizationEssentialThese items allow the website to remember choices you make (such as your user name, language, or the region you are in) and provide enhanced, more personal features. For example, a website may provide you with local weather reports or traffic news by storing data about your current location.AnalyticsEssentialThese items help the website operator understand how its website performs, how visitors interact with the site, and whether there may be technical issues. This storage type usually doesnât collect information that identifies a visitor.Confirm my preferences and close

