Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from multiple issues in the `HMIPServer.jar` component of RaspberryMatic/OCCU, specifically within the `FirmwareController` class. The core problem is the lack of session ID checks in the `FirmwareController`, which allows unauthenticated access to the firmware upload functionality, combined with unsanitized file extraction.

**Weaknesses/Vulnerabilities:**

*   **Missing Authentication:** The `FirmwareController` does not verify session IDs, allowing unauthenticated access to the `/pages/jpages/system/DeviceFirmware/addFirmware` endpoint.
*   **Zip Slip Vulnerability:** The `extractFileFromArchive2Tmp` method uses the unsanitized `entry.getName()` from the uploaded archive to create file paths, allowing directory traversal and file overwrite outside of the designated temporary directory. This is a classic Zip Slip vulnerability.
*   **Unsafe file extraction:** The .tgz archive is automatically extracted without any further checks, making the device susceptible to malicious file injections.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** Attackers can achieve RCE by overwriting system files with malicious content through the Zip Slip vulnerability. Specifically, the provided PoC describes overwriting the `watchdog` script, which is executed periodically via a cron job, allowing for arbitrary code execution as the root user.
*   **Full System Compromise:** Successful exploitation can lead to complete compromise of the affected system.

**Attack Vectors:**

*   **Network:** The vulnerability is exploitable over the network.
*   **HTTP Request:** An attacker can trigger the vulnerability by sending a crafted `multipart/form-data` POST request to the `/pages/jpages/system/DeviceFirmware/addFirmware` endpoint with a malicious `.tgz` archive.

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker must have network access to the vulnerable RaspberryMatic/OCCU instance.
*   **No Authentication Required:** The attacker does not need any valid user credentials or session information.
*   **Crafted Payload:** The attacker needs to create a malicious .tgz archive, exploiting the Zip Slip vulnerability to overwrite arbitrary files on the target system.

**Additional Details:**

*   The exploit is triggered by uploading a `.tgz` archive that, when extracted, contains directory traversal sequences (`../`) in its file names, allowing for writing files outside the intended temporary directory.
*   The PoC demonstrates how to generate such a malicious archive using the `evilarc` tool, specifically targeting the `watchdog` script to achieve code execution.
*   The server response to the upload is a `${addDevFirmwareInvalid}` message, which does not indicate failure of the upload or extraction process.
*   The CVSS v3 score is 10.0, indicating critical severity.
*   The vulnerability is categorized under CWE-23 (Relative Path Traversal) and CWE-306 (Missing Authentication for Critical Function).