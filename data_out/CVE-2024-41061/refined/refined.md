The provided content relates to CVE-2024-41061.

**Root cause:** An out-of-bounds read in the `dml2_calculate_rq_and_dlg_params` function in the Linux kernel's AMD display driver. The `out_lowest_state_idx` is used to index the `FCLKChangeSupport` array, and `out_lowest_state_idx` can be greater than 1 leading to an out of bounds read.

**Vulnerability:**
  - **Type:** Array-index-out-of-bounds read
  - **Location:** `drivers/gpu/drm/amd/display/dc/dml2/dml2_utils.c` in the `dml2_calculate_rq_and_dlg_params` function.
  - The `FCLKChangeSupport` array is accessed using `in_ctx->v20.dml_core_ctx.ms.support.FCLKChangeSupport[in_ctx->v20.scratch.mode_support_params.out_lowest_state_idx]`.

**Impact:**
- The vulnerability could lead to a read of memory outside the bounds of the array, potentially causing a crash or other unexpected behavior.
- The impact is considered to be a potential out of bounds access

**Attack vectors:**
- An attacker would need to trigger a specific code path in the AMD display driver that calls the vulnerable function `dml2_calculate_rq_and_dlg_params`.
- This specific code path would need to result in the `out_lowest_state_idx` being greater than the array size for `FCLKChangeSupport` array.

**Required attacker capabilities:**
- The attacker would likely need to be able to control the display configuration in some way to influence the value of `out_lowest_state_idx`
- The attacker would require access to a system with an affected AMD GPU.

**Mitigation:**
- The fix involves using the index `0` instead of `out_lowest_state_idx`, as all elements of the `FCLKChangeSupport` array are identical.

**Additional information:**
- The commit message and diffstat clearly describe the out-of-bounds issue and the fix.
- The provided information contains details on the specific lines of code that were changed to address the vulnerability.
- The fix ensures that the index used to access the `FCLKChangeSupport` array is always within its bounds by hardcoding to 0.