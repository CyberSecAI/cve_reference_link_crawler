- **Root cause of vulnerability**: When a FortiGate device configured with flow-based protection reloads its scanning engine after an update (a nearly instantaneous process), it stops monitoring network sessions that were active at the time of the reload.
- **Weaknesses/vulnerabilities present**: Flow-based protection bypass. The system fails to properly re-establish monitoring of existing network sessions after a scanning engine reload.
- **Impact of exploitation**: Network sessions, especially long-lived ones like SMBv3, may bypass security monitoring after an update, potentially allowing malicious traffic or data to pass without inspection.
- **Attack vectors**: An attacker could exploit this vulnerability by initiating a network session, especially a long-lived one, just before a FortiGate device is updated/engine reloaded, and then perform malicious actions through that session.
- **Required attacker capabilities/position**: The attacker would need to be in a position to initiate network traffic to a FortiGate device and be aware of the timing of updates/engine reloads. They do not require any special privileges.