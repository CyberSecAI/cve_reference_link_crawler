

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3133163%2Fatarim-visual-collaboration%2Ftrunk%2Finc%2Fwpf_function.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3124979/atarim-visual-collaboration/trunk/inc/wpf_function.php "Changeset 3124979 for atarim-visual-collaboration/trunk/inc/wpf_function.php")
* [Next Change](/changeset/3138174/atarim-visual-collaboration/trunk/inc/wpf_function.php "Changeset 3138174 for atarim-visual-collaboration/trunk/inc/wpf_function.php") →

---

# Changeset [3133163](/changeset/3133163 "Show full changeset") for [atarim-visual-collaboration/trunk/inc/wpf\_function.php](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3133163 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/09/2024 11:32:22 AM
([5 months](/timeline?from=2024-08-09T11%3A32%3A22Z&precision=second "See timeline at 08/09/2024 11:32:22 AM") ago)

Author:
wpfeedback
Message:

updated to version 4.0.3

File:

1 edited

* [atarim-visual-collaboration/trunk/inc/wpf\_function.php](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3133163 "Show entry in browser")
  (modified)
  ([6 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [atarim-visual-collaboration/trunk/inc/wpf\_function.php](/changeset/3133163/atarim-visual-collaboration/trunk/inc/wpf_function.php "Show the changeset 3133163 restricted to atarim-visual-collaboration/trunk/inc/wpf_function.php")

  | [r3124979](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3124979#L143 "Show revision 3124979 of this file in browser") | [r3133163](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3133163#L143 "Show revision 3133163 of this file in browser") |  |
  | --- | --- | --- |
  | 143 | 143 | if ( ! function\_exists( 'process\_wpfeedback\_options' ) ) { |
  | 144 | 144 | function process\_wpfeedback\_options() { |
  |  | 145 | if ( !check\_if\_allowed\_to\_save\_settings() ) { |
  |  | 146 | wp\_die( 'Unauthorized access' ); |
  |  | 147 | } |
  | 145 | 148 | $options = []; |
  | 146 | 149 | // Check that user has proper security level |
  | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3124979#L208) | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3133163#L211) |  |
  | 208 | 211 | } |
  | 209 | 212 | update\_site\_data( $parms ); |
  | 210 |  | wp\_redirect( add\_query\_arg( 'page', '~~wpfeedback~~\_page\_settings&wpf\_setting=1', admin\_url( 'admin.php' ) ) ); |
  |  | 213 | wp\_redirect( add\_query\_arg( 'page', 'collaboration\_page\_settings&wpf\_setting=1', admin\_url( 'admin.php' ) ) ); |
  | 211 | 214 | exit; |
  | 212 | 215 | } |
  | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3124979#L222) | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3133163#L225) |  |
  | 222 | 225 | if ( ! function\_exists( 'process\_wpfeedback\_misc\_options' ) ) { |
  | 223 | 226 | function process\_wpfeedback\_misc\_options() { |
  |  | 227 | if ( !check\_if\_allowed\_to\_save\_settings() ) { |
  |  | 228 | wp\_die( 'Unauthorized access' ); |
  |  | 229 | } |
  | 224 | 230 | $options = []; |
  | 225 | 231 | if ( isset( $\_POST['wpf\_license\_deactivate'] ) ) { |
  | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3124979#L334) | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3133163#L340) |  |
  | 334 | 340 | } |
  | 335 | 341 | } |
  | 336 |  | wp\_redirect( add\_query\_arg( 'page', '~~wpfeedback~~\_page\_permissions', admin\_url( 'admin.php' ) ) ); |
  |  | 342 | wp\_redirect( add\_query\_arg( 'page', 'collaboration\_page\_permissions', admin\_url( 'admin.php' ) ) ); |
  | 337 | 343 | exit; |
  | 338 | 344 | } |
  | 339 | 345 | } |
  | 340 | 346 | add\_action( 'admin\_post\_save\_wpfeedback\_misc\_options', 'process\_wpfeedback\_misc\_options' ); |
  |  | 347 |  |
  |  | 348 | // This function checks if the user is allowed to change the plugin settings or not. |
  |  | 349 | function check\_if\_allowed\_to\_save\_settings() { |
  |  | 350 | // Verify nonce |
  |  | 351 | if ( ! isset( $\_POST['\_wpnonce'] ) || ! wp\_verify\_nonce( $\_POST['\_wpnonce'], 'wpfeedback' ) ) { |
  |  | 352 | return false; |
  |  | 353 | } |
  |  | 354 | if ( is\_user\_logged\_in() ) { |
  |  | 355 | // Get the current logged-in user ID |
  |  | 356 | $user\_id = get\_current\_user\_id(); |
  |  | 357 |  |
  |  | 358 | // Retrieve the user meta value |
  |  | 359 | $user\_meta\_value = get\_user\_meta( $user\_id, 'wpf\_user\_type', true ); |
  |  | 360 |  |
  |  | 361 | // Check if the user is Webmaster or not. |
  |  | 362 | if ( $user\_meta\_value === 'advisor' ) { |
  |  | 363 | return true; |
  |  | 364 | } |
  |  | 365 | return false; |
  |  | 366 | } |
  |  | 367 | } |
  | 341 | 368 |  |
  | 342 | 369 | /\* |
  | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3124979#L1762) | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3133163#L1789) |  |
  | 1762 | 1789 | if ( is\_admin() == 1 ) { |
  | 1763 | 1790 | $approve\_btn = ""; |
  | 1764 |  | ~~}~~ |
  | 1765 |  |  |
  | 1766 |  | ~~$agency\_menu\_item    = '';~~ |
  | 1767 |  | ~~if ( $wpf\_current\_role == 'advisor' || ( $wpf\_current\_role == '' && current\_user\_can( 'administrator' ) ) ) {~~ |
  | 1768 |  | ~~$agency\_menu\_item = '<li class="pro"> <a href="' . WPF\_APP\_SITE\_URL . '/login" target="\_blank" title="' . \_\_( "Atarim Dashboard", 'atarim-visual-collaboration' ) . '">' . get\_wpf\_pro\_icon() . '<span>' . \_\_( "Agency", 'atarim-visual-collaboration' ) . '</span> </a></li>';~~ |
  | 1769 | 1791 | } |
  | 1770 | 1792 |  |
  | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3124979#L2344) | […](/browser/atarim-visual-collaboration/trunk/inc/wpf_function.php?rev=3133163#L2366) |  |
  | 2344 | 2366 | $wpf\_current\_screen = get\_current\_screen(); |
  | 2345 | 2367 | $wpf\_current\_screen = $wpf\_current\_screen->id; |
  | 2346 |  | if ( $wpf\_current\_screen == 'collaborate\_page\_~~wpfeedback\_page\_permissions' || $wpf\_current\_screen == 'collaborate\_page\_wpfeedback\_page\_settings' || $wpf\_current\_screen == 'toplevel\_page\_wpfeedback\_page\_tasks' || $wpf\_current\_screen == 'collaborate\_page\_wpfeedback~~\_page\_integrate' ) { |
  |  | 2368 | if ( $wpf\_current\_screen == 'collaborate\_page\_collaboration\_page\_permissions' || $wpf\_current\_screen == 'collaborate\_page\_collaboration\_page\_settings' || $wpf\_current\_screen == 'toplevel\_page\_collaboration\_page\_tasks' || $wpf\_current\_screen == 'collaborate\_page\_collaboration\_page\_integrate' ) { |
  | 2347 | 2369 | return true; |
  | 2348 | 2370 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3133163)
* [Zip Archive](?format=zip&new=3133163)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

