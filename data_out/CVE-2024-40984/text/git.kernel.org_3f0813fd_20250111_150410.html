

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Raju Rangoju <Raju.Rangoju@amd.com> | 2024-06-14 19:31:49 +0530 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-27 13:52:25 +0200 |
| commit | [e21a4c9129c72fa54dd00f5ebf71219b41d43c04](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04)) | |
| tree | [4a852545048c4db65a6e5a79fea05b80c9f2f53e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04) | |
| parent | [067bf62e73c2d7fa3697765989dfed01896c2504](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=067bf62e73c2d7fa3697765989dfed01896c2504) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04&id2=067bf62e73c2d7fa3697765989dfed01896c2504)) | |
| download | [linux-e21a4c9129c72fa54dd00f5ebf71219b41d43c04.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e21a4c9129c72fa54dd00f5ebf71219b41d43c04.tar.gz) | |

ACPICA: Revert "ACPICA: avoid Info: mapping multiple BARs. Your kernel is fine."[ Upstream commit a83e1385b780d41307433ddbc86e3c528db031f0 ]
Undo the modifications made in commit d410ee5109a1 ("ACPICA: avoid
"Info: mapping multiple BARs. Your kernel is fine.""). The initial
purpose of this commit was to stop memory mappings for operation
regions from overlapping page boundaries, as it can trigger warnings
if different page attributes are present.
However, it was found that when this situation arises, mapping
continues until the boundary's end, but there is still an attempt to
read/write the entire length of the map, leading to a NULL pointer
deference. For example, if a four-byte mapping request is made but
only one byte is mapped because it hits the current page boundary's
end, a four-byte read/write attempt is still made, resulting in a NULL
pointer deference.
Instead, map the entire length, as the ACPI specification does not
mandate that it must be within the same page boundary. It is
permissible for it to be mapped across different regions.
Link: <https://github.com/acpica/acpica/pull/954>
Closes: https://bugzilla.kernel.org/show\_bug.cgi?id=218849
Fixes: d410ee5109a1 ("ACPICA: avoid "Info: mapping multiple BARs. Your kernel is fine."")
Co-developed-by: Sanath S <Sanath.S@amd.com>
Signed-off-by: Sanath S <Sanath.S@amd.com>
Signed-off-by: Raju Rangoju <Raju.Rangoju@amd.com>
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04)

| -rw-r--r-- | [drivers/acpi/acpica/exregion.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/acpi/acpica/exregion.c?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04) | 23 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 21 deletions

| diff --git a/drivers/acpi/acpica/exregion.c b/drivers/acpi/acpica/exregion.cindex 8907b8bf42672a..c49b9f8de723d8 100644--- a/[drivers/acpi/acpica/exregion.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/acpi/acpica/exregion.c?id=067bf62e73c2d7fa3697765989dfed01896c2504)+++ b/[drivers/acpi/acpica/exregion.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/acpi/acpica/exregion.c?id=e21a4c9129c72fa54dd00f5ebf71219b41d43c04)@@ -44,7 +44,6 @@ acpi\_ex\_system\_memory\_space\_handler(u32 function, struct acpi\_mem\_mapping \*mm = mem\_info->cur\_mm; u32 length; acpi\_size map\_length;- acpi\_size page\_boundary\_map\_length; #ifdef ACPI\_MISALIGNMENT\_NOT\_SUPPORTED u32 remainder; #endif@@ -138,26 +137,8 @@ acpi\_ex\_system\_memory\_space\_handler(u32 function, map\_length = (acpi\_size) ((mem\_info->address + mem\_info->length) - address); - /\*- \* If mapping the entire remaining portion of the region will cross- \* a page boundary, just map up to the page boundary, do not cross.- \* On some systems, crossing a page boundary while mapping regions- \* can cause warnings if the pages have different attributes- \* due to resource management.- \*- \* This has the added benefit of constraining a single mapping to- \* one page, which is similar to the original code that used a 4k- \* maximum window.- \*/- page\_boundary\_map\_length = (acpi\_size)- (ACPI\_ROUND\_UP(address, ACPI\_DEFAULT\_PAGE\_SIZE) - address);- if (page\_boundary\_map\_length == 0) {- page\_boundary\_map\_length = ACPI\_DEFAULT\_PAGE\_SIZE;- }-- if (map\_length > page\_boundary\_map\_length) {- map\_length = page\_boundary\_map\_length;- }+ if (map\_length > ACPI\_DEFAULT\_PAGE\_SIZE)+ map\_length = ACPI\_DEFAULT\_PAGE\_SIZE;  /\* Create a new mapping starting at the address given \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 15:02:48 +0000

