

[HashiCorp Discuss](/)

# [HCSEC-2022-23 - Vagrant NFS sudoers Configuration Allows for Local Privilege Escalation](/t/hcsec-2022-23-vagrant-nfs-sudoers-configuration-allows-for-local-privilege-escalation/45423)

[Security](/c/security/52)

[eastebry](https://discuss.hashicorp.com/u/eastebry)

October 10, 2022, 11:52pm

1

**Bulletin ID:** HCSEC-2022-23

**Affected Products / Versions:** Vagrant <2.3.1

**Publication Date:** October 10, 2022

**Summary**

Optional sudoers configuration for Vagrant NFS shared folders allows for local privilege escalation

**Background**

The [documentation](https://www.vagrantup.com/docs/synced-folders/nfs) associated with Vagrant’s NFS driver for Linux suggested configuring a Vagrant host with a specific sudoers configuration, which removed the need for vagrant users to type their password every time they started a Vagrant guest. This additional configuration is optional, and must be enabled by the user installing Vagrant on a host.

**Details**

The recommended sudoers configuration for Vagrant on linux is insecure. If the host has been configured according to this documentation, non-privileged users on the host can leverage a wildcard in the sudoers configuration to execute arbitrary commands as root. New recommendations have been published to the Vagrant documentation website, and the necessary changes to support these recommendations are available in Vagrant 2.3.1. This issue has been assigned CVE-2022-42717.

**Remediation**

Linux Vagrant users should update to version 2.3.1, and follow the new instructions in our documentation for configuring their host’s sudoers file.

The updated documentation is available [here](https://www.vagrantup.com/docs/synced-folders/nfs).

**Acknowledgement**

Hashicorp would like to thank Bastien Secher of Nameshield for discovering and reporting this vulnerability.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security.>*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2023-31 - Vagrant’s Windows Installer Allowed Directory Junction Write](https://discuss.hashicorp.com/t/hcsec-2023-31-vagrant-s-windows-installer-allowed-directory-junction-write/59568)  [Security](/c/security/52) [security-vagrant](https://discuss.hashicorp.com/tag/security-vagrant) | 0 | 7434 | October 27, 2023 |
| [HCSEC-2024-25 - Vagrant VMware Utility installation files vulnerable to modification by unprivileged user](https://discuss.hashicorp.com/t/hcsec-2024-25-vagrant-vmware-utility-installation-files-vulnerable-to-modification-by-unprivileged-user/71012)  [Security](/c/security/52) [security-vagrant](https://discuss.hashicorp.com/tag/security-vagrant) | 0 | 717 | October 29, 2024 |
| [HCSEC-2020-23 - Nomad File Sandbox Escape via Container Volume Mount](https://discuss.hashicorp.com/t/hcsec-2020-23-nomad-file-sandbox-escape-via-container-volume-mount/18108)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 4337 | November 25, 2020 |
| [Vagrants synced folders over NFS do not work with libvirt provider](https://discuss.hashicorp.com/t/vagrants-synced-folders-over-nfs-do-not-work-with-libvirt-provider/33262)  [Vagrant](/c/vagrant/24) | 1 | 2066 | December 16, 2021 |
| [HCSEC-2022-02 - Nomad alloc Filesystem and Container Escape](https://discuss.hashicorp.com/t/hcsec-2022-02-nomad-alloc-filesystem-and-container-escape/35560)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 7190 | February 11, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

