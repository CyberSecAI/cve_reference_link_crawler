<!doctype html>

<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US" >

  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    

    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,600,700" rel="stylesheet"> 
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!--INCLUDE SQS SCRIPTS, META TAGS AND USER CONTENT FROM THE CODE INJECTION TAB-->

    <!-- This is Squarespace. --><!-- brian-gorenc -->
<base href="">
<meta charset="utf-8" />
<title>Zero Day Initiative &mdash; CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome </title>
<meta http-equiv="Accept-CH" content="Sec-CH-UA-Platform-Version, Sec-CH-UA-Model" /><link rel="icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1487670157237-HOXHMI54TA0SZP21OY7C/favicon.ico"/>
<link rel="canonical" href="https://www.thezdi.com/blog/2024/5/2/cve-2024-2887-a-pwn2own-winning-bug-in-google-chrome"/>
<meta property="og:site_name" content="Zero Day Initiative"/>
<meta property="og:title" content="Zero Day Initiative &mdash; CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome "/>
<meta property="og:url" content="https://www.thezdi.com/blog/2024/5/2/cve-2024-2887-a-pwn2own-winning-bug-in-google-chrome"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="In this guest blog from Master of Pwn winner Manfred Paul, he details CVE-2024-2887 – a type confusion bug that occurs in both Google Chrome and Microsoft Edge (Chromium). He used this bug as a part of his winning exploit that led to code execution in the renderer of both browsers. This bug was quic"/>
<meta property="og:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/6633b93d81f8ef5916e65fcf/1714677570950/Holding+Image-1.png?format=1500w"/>
<meta property="og:image:width" content="960"/>
<meta property="og:image:height" content="540"/>
<meta itemprop="name" content="Zero Day Initiative — CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome "/>
<meta itemprop="url" content="https://www.thezdi.com/blog/2024/5/2/cve-2024-2887-a-pwn2own-winning-bug-in-google-chrome"/>
<meta itemprop="description" content="In this guest blog from Master of Pwn winner Manfred Paul, he details CVE-2024-2887 – a type confusion bug that occurs in both Google Chrome and Microsoft Edge (Chromium). He used this bug as a part of his winning exploit that led to code execution in the renderer of both browsers. This bug was quic"/>
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/6633b93d81f8ef5916e65fcf/1714677570950/Holding+Image-1.png?format=1500w"/>
<link rel="image_src" href="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/6633b93d81f8ef5916e65fcf/1714677570950/Holding+Image-1.png?format=1500w" />
<meta itemprop="image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/6633b93d81f8ef5916e65fcf/1714677570950/Holding+Image-1.png?format=1500w"/>
<meta itemprop="author" content="Guest Blogger"/>
<meta itemprop="datePublished" content="2024-05-02T11:14:11-0500"/>
<meta itemprop="dateModified" content="2024-05-02T14:19:30-0500"/>
<meta itemprop="headline" content="CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome "/>
<meta itemprop="publisher" content="Zero Day Initiative"/>
<meta name="twitter:title" content="Zero Day Initiative — CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome "/>
<meta name="twitter:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/6633b93d81f8ef5916e65fcf/1714677570950/Holding+Image-1.png?format=1500w"/>
<meta name="twitter:url" content="https://www.thezdi.com/blog/2024/5/2/cve-2024-2887-a-pwn2own-winning-bug-in-google-chrome"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:description" content="In this guest blog from Master of Pwn winner Manfred Paul, he details CVE-2024-2887 – a type confusion bug that occurs in both Google Chrome and Microsoft Edge (Chromium). He used this bug as a part of his winning exploit that led to code execution in the renderer of both browsers. This bug was quic"/>
<meta name="description" content="" />
<link rel="preconnect" href="https://images.squarespace-cdn.com">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;1,100;1,300;1,700">
<script type="text/javascript" crossorigin="anonymous" nomodule="nomodule" src="//assets.squarespace.com/@sqs/polyfiller/1.6/legacy.js"></script>
<script type="text/javascript" crossorigin="anonymous" src="//assets.squarespace.com/@sqs/polyfiller/1.6/modern.js"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-ffed9a176c3c301d4d51-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-ffed9a176c3c301d4d51-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-6c569122bfa66a51a056-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-6c569122bfa66a51a056-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-907dfe7701e90c1e5cbd-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-907dfe7701e90c1e5cbd-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-61293f01d648eef165fc-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-61293f01d648eef165fc-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-9d885b2cbf9c1a563d68-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-vendors-9d885b2cbf9c1a563d68-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-90d56bf4db61aee7cf50-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/common-90d56bf4db61aee7cf50-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/user-account-core-acf65942ef2451d36951-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/user-account-core-acf65942ef2451d36951-min.en-US.js" ></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].css = ["//assets.squarespace.com/universal/styles-compressed/user-account-core-b6e8cafbf34b05da5c2b-min.en-US.css"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<link rel="stylesheet" type="text/css" href="//assets.squarespace.com/universal/styles-compressed/user-account-core-b6e8cafbf34b05da5c2b-min.en-US.css"><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-4c8c839071c8825c9584-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="//assets.squarespace.com/universal/scripts-compressed/performance-4c8c839071c8825c9584-min.en-US.js" defer ></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"betaFeatureFlags":["campaigns_global_uc_ab","i18n_beta_website_locales","marketing_landing_page","contacts_and_campaigns_redesign","commerce_site_visitor_metrics","accounting_orders_sync","campaigns_discount_section_in_blasts","campaigns_import_discounts","order_status_page_checkout_landing_enabled","enable_css_variable_tweaks","campaigns_discount_section_in_automations","campaigns_thumbnail_layout","commerce_clearpay","marketing_automations","campaigns_new_image_layout_picker"],"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-468c960caeade4e0ef78-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-ef238f99d44a3bdc6fbe-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-20cdd7bbff202c9ade3e-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-8ec841cacfb75d4282f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-93d51fbe4a919163e8fd-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-10dac239e5ffd3b32e9c-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-8eaef28684aecf472054-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-9e75b5d75bb5cb4c1f67-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-4e8b59438f101c9b69b4-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-a0d9356d7c1596ab2c53-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-549a1a8ecd5cab5f10fc-min.en-US.js"},"squarespace-custom-css-popup":{"css":"//assets.squarespace.com/universal/styles-compressed/custom-css-popup-936ce46433fbe5263143-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/custom-css-popup-5455d9e8f44ec0f0cf39-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-2dcac307baebe70727dc-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-0bc530b249391caa4dc1-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-10dac239e5ffd3b32e9c-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-387a105ae421f13a265e-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-4d2c5cbc75074ffd6660-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-b952cddb94c5d471b8d3-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-7d3b0e9422ec0394430b-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-8ec841cacfb75d4282f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-8ab6d60c33aaa9220d48-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-8ec841cacfb75d4282f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-fde0b4da7f2332d3851c-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-8ec841cacfb75d4282f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-acbd45498d53e95639e9-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-e89b4cc96c222ed66c64-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-e142b74a5284da4e4388-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-2f87c3dcb76ca485179d-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-de9200210dc165e7c226-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-8ec841cacfb75d4282f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-921b8aa24f5746dfa032-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-8ec841cacfb75d4282f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-52403235629e0d8a003b-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-917382e71b023cec7555-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-36274fddfc902ef52e8f-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-16f2afd196dfeee984e8-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-4279cc7bb78333b8db43-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-cede7154e30542cabab1-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-3a7d186e7e5e3b30911b-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-48ea0949077e3b1b72e6-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-8ec841cacfb75d4282f4-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-d99ab3a90176704b3781-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-efd3c12d460f58781eb3-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-157a4d5a69fbdfde7b53-min.en-US.js"}},"pageType":50,"website":{"id":"5894c269e4fcb5e65a1ed623","identifier":"brian-gorenc","websiteType":1,"contentModifiedOn":1729701545723,"cloneable":false,"hasBeenCloneable":false,"developerMode":true,"siteStatus":{},"language":"en-US","timeZone":"America/Chicago","machineTimeZoneOffset":-21600000,"timeZoneOffset":-21600000,"timeZoneAbbr":"CST","siteTitle":"Zero Day Initiative","fullSiteTitle":"Zero Day Initiative \u2014 CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome ","siteDescription":"","shareButtonOptions":{"1":true,"3":true,"2":true,"6":true,"4":true},"authenticUrl":"https://www.thezdi.com","internalUrl":"https://brian-gorenc.squarespace.com","baseUrl":"https://www.thezdi.com","primaryDomain":"www.thezdi.com","sslSetting":3,"socialAccounts":[{"serviceId":4,"userId":"86973588","userName":"thezdi","screenname":"Zero Day Initiative","addedOn":1492718968086,"profileUrl":"https://twitter.com/thezdi","iconUrl":"http://pbs.twimg.com/profile_images/626740860508442632/dC1lsJPl_normal.png","collectionId":"58f91578e58c6231c1daf261","iconEnabled":true,"serviceName":"twitter"},{"serviceId":11,"userId":"UChbH7B5YhXANmlMYJRHpw0g","screenname":"TippingPoint Zero Day Initiative","addedOn":1492722141068,"profileUrl":"https://www.youtube.com/channel/UChbH7B5YhXANmlMYJRHpw0g","iconUrl":"https://yt3.ggpht.com/-5tyoeQlg_Jk/AAAAAAAAAAI/AAAAAAAAAAA/lrjg7w8bQgA/s88-c-k-no-mo-rj-c0xffffff/photo.jpg","iconEnabled":true,"serviceName":"youtube"}],"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"a0a901f81f08cc6c7c9e5108d43c513fa4847e74de2b39c335909e3f8dd88d34","showOwnerLogin":false},"websiteSettings":{"id":"5894c269e4fcb5e65a1ed625","websiteId":"5894c269e4fcb5e65a1ed623","subjects":[],"country":"US","state":"TX","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":false,"contactPhoneNumber":"","storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":1,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsSuccessText":"","restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"minimumOrderSubtotalEnabled":false,"minimumOrderSubtotal":{"currency":"USD","value":"0.00"},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"ampEnabled":false,"userAccountsSettings":{"loginAllowed":false,"signupAllowed":false}},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":"","cookieBannerHasOptOut":false,"cookieBannerHasManageCookies":true,"cookieBannerManageCookiesLabel":"","cookieBannerSavedPreferencesText":"","cookieBannerSavedPreferencesLayout":"PILL"},"websiteCloneable":false,"collection":{"title":"Blog","id":"58a5b38cb3db2bd67b608658","fullUrl":"/blog","type":1,"permissionType":1},"item":{"title":"CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome ","id":"6633b93d81f8ef5916e65fcf","fullUrl":"/blog/2024/5/2/cve-2024-2887-a-pwn2own-winning-bug-in-google-chrome","publicCommentCount":0,"commentState":2,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":false,"tweakJSON":{"aspect-ratio":"Auto","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Slideshow","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"350px","gridSpacing":"20px","product-gallery-auto-crop":"true","product-image-auto-crop":"true","tweak-v1-related-products-title-spacing":"50px"},"templateId":"58a5cc48579fb3f464465a0c","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/5894c269e4fcb5e65a1ed623/46/scripts/","impersonatedSession":false,"tzData":{"zones":[[-360,"US","C%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false,"recaptchaEnterpriseContext":{"recaptchaEnterpriseSiteKey":"6LdDFQwjAAAAAPigEvvPgEVbb7QBm-TkVJdDTlAv"},"i18nContext":{"timeZoneData":{"id":"America/Chicago","name":"Central Time"}},"env":"PRODUCTION"};</script><script>Squarespace.load(window);</script>
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.thezdi.com/blog?format=rss" />
<script type="application/ld+json">{"url":"https://www.thezdi.com","name":"Zero Day Initiative","description":"","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"name":"Zero Day Initiative \u2014 CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome ","url":"https://www.thezdi.com/blog/2024/5/2/cve-2024-2887-a-pwn2own-winning-bug-in-google-chrome","datePublished":"2024-05-02T11:14:11-0500","dateModified":"2024-05-02T14:19:30-0500","headline":"CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome ","author":"Guest Blogger","publisher":{"name":"Zero Day Initiative","logo":{"@type":"ImageObject"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/6633b93d81f8ef5916e65fcf/1714677570950/Holding+Image-1.png?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="https://static1.squarespace.com/static/sitecss/5894c269e4fcb5e65a1ed623/51/58a5cc48579fb3f464465a0c/58a5cc48579fb3f464465a0e/46/site.css"/><script>
if (window.location.host == "www.thezdi.com") {window.location = "https://www.zerodayinitiative.com" + window.location.pathname}</script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-93169700-1"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-93169700-1');</script><!-- End of Squarespace Headers -->
    <link rel="stylesheet" href="https://www.zerodayinitiative.com/css/main.css">


  </head>

  <body id="item-6633b93d81f8ef5916e65fcf" class="event-show-past-events event-thumbnails event-thumbnail-size-32-standard event-date-label  event-list-show-cats event-list-date event-list-time event-list-address   event-icalgcal-links  event-excerpts      gallery-design-slideshow aspect-ratio-auto lightbox-style-dark gallery-navigation-bullets gallery-info-overlay-show-on-hover gallery-aspect-ratio-32-standard gallery-arrow-style-no-background gallery-transitions-fade gallery-show-arrows gallery-auto-crop   product-list-titles-under product-list-alignment-left product-item-size-11-square product-image-auto-crop product-gallery-size-11-square product-gallery-auto-crop show-product-price show-product-item-nav product-social-sharing tweak-v1-related-products-image-aspect-ratio-11-square tweak-v1-related-products-details-alignment-center newsletter-style-dark hide-opentable-icons opentable-style-dark small-button-style-solid small-button-shape-square medium-button-style-solid medium-button-shape-square large-button-style-solid large-button-shape-square image-block-poster-text-alignment-center image-block-card-dynamic-font-sizing image-block-card-content-position-center image-block-card-text-alignment-left image-block-overlap-dynamic-font-sizing image-block-overlap-content-position-center image-block-overlap-text-alignment-left image-block-collage-dynamic-font-sizing image-block-collage-content-position-top image-block-collage-text-alignment-left image-block-stack-dynamic-font-sizing image-block-stack-text-alignment-left button-style-solid button-corner-style-square tweak-product-quick-view-button-style-floating tweak-product-quick-view-button-position-bottom tweak-product-quick-view-lightbox-excerpt-display-truncate tweak-product-quick-view-lightbox-show-arrows tweak-product-quick-view-lightbox-show-close-button tweak-product-quick-view-lightbox-controls-weight-light native-currency-code-usd collection-58a5b38cb3db2bd67b608658 view-item collection-type-blog collection-layout-default mobile-style-available">

    <div id="outerWrapper">

      <div id="bgOverlay"></div>

      <!--HEADER-->

      <header id="header">

        <!--MAIN NAVIGATION-->
            <!-- Begin Off Canvas Menu-->
    <div class="off-canvas">
        <nav class="off-canvas__list" role="main-navigation2">
            <div class="js-mobile-nav-toggle">Menu</div>
            <ul class="topMenu">
                <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy">PRIVACY</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about">WHO WE ARE</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits">HOW IT WORKS</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog">BLOG</a></li>
                <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories">ADVISORIES</a></li>
                <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal">LOG IN</a></li>
                <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal/register">SIGN UP</a></li>
            </ul>
            <ul class="bottomMenu">
                <li class="nav__tier1 logo"><a href="https://www.zerodayinitiative.com/"><img src="https://www.zerodayinitiative.com/images/logo.svg" width="125" height="37" alt="thezdi"/></a></li>
                <li class="nav__tier1"><a href="https://www.trendmicro.com/">Trend Micro</a></li>
            </ul>
        </nav>
    </div>
    <!-- End Off Canvas Menu -->
            <div id="nav" class="group">
        <div id="navContent">
            <div class="nav__container">
                <div class="nav__header">
                    <div class="global-header__logo">
                        <a href="https://www.zerodayinitiative.com/"><img src="https://www.zerodayinitiative.com/images/logo.svg" alt="thezdi"/></a>
                    </div>
                    <div id="mobileNavIcon" class="js-mobile-nav-toggle">Menu</div>
                    <div id="mobileOverlay"></div>
                </div>
                <nav class="nav__list" role="main-navigation">
                    <ul class="list-no-bullets">
                        <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy">PRIVACY</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about">WHO WE ARE</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits">HOW IT WORKS</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog">BLOG</a></li>
                        <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories">ADVISORIES</a></li>
                        <li class="nav__tier1 userActions">
                            <a href="https://www.zerodayinitiative.com/portal/">LOG IN</a>
                            <a href="https://www.zerodayinitiative.com/portal/register">SIGN UP</a>
                            </li><li>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>


      </header>

      <!--SITE TITLE OR LOGO-->
      <div id="innerWrapper">

      <!--CONTENT INJECTION POINT-->
        <section id="content">
          <div class="main-content-wrapper cf" data-content-field="main-content">
            <!-- CATEGORY NAV -->
            
            <div id="mainContent" class="blogDetails group subscribeAbs">
    <div id="imageMasthead" class="smaller">
        <div class="content">
            
                <h1 class="title" data-content-field="title">
                  
                    CVE-2024-2887: A Pwn2Own Winning Bug in Google Chrome 
                  
                </h1>
                <data>May 02, 2024  |  Guest Blogger</data>
            
        </div>
    </div>

    <div class="blog-listing blog-details">
        <div class="subscribe-container">
            <a href="https://www.zerodayinitiative.com/rss/" class="btn subscribe rounded">SUBSCRIBE</a>
        </div>
        <div class="section">
            <div class="contentBlock">
                <div class="contentBlockCopy">
                    
                      <div class="group">
                        <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1714665928245" id="item-6633b93d81f8ef5916e65fcf"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-076abe012212acd02e1c"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;"><em>In this guest blog from Master of Pwn winner Manfred Paul, he details CVE-2024-2887 – a type confusion bug that occurs in both Google Chrome and Microsoft Edge (Chromium). He used this bug as a part of his winning exploit that led to code execution in the renderer of both browsers. This bug was quickly patched by both </em><a href="https://chromereleases.googleblog.com/2024/03/stable-channel-update-for-desktop_26.html"><em>Google</em></a><em> and </em><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-2887"><em>Microsoft</em></a><em>. Manfred has graciously provided this detailed write-up of the vulnerability and how he exploited it at the contest.</em></p>
</div>




















  
  



</div></div><div class="sqs-block horizontalrule-block sqs-block-horizontalrule" data-block-type="47" id="block-yui_3_17_2_1_1714665780773_11979"><div class="sqs-block-content"><hr /></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1714665780773_12578"><div class="sqs-block-content"><p>In this blog, I describe a means of exploiting the V8 JavaScript and WebAssembly engine to gain execution of arbitrary shellcode inside the renderer process. This includes a bypass of the V8 memory sandbox (<a href="https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/edit#heading=h.xzptrog8pyxf">Ubercage</a>), though code execution is still constrained by the process isolation-based browser sandbox. For demonstration purposes, this limitation can be removed by running the browser with the <code>--no- sandbox</code> flag. </p>
<p><b data-preserve-html-node="true">Root Cause of the WebAssembly Universal Type Confusion</b></p>
<p>A WebAssembly module may contain a <code>type</code> section that defines a list of custom “heap types”. In the base specification, this is used only to declare function types, but with the adoption of the garbage collection (GC) <a href="https://webassembly.github.io/gc/core/_download/WebAssembly.pdf">proposal</a> [PDF], this section can additionally define struct types, allowing for the use of composite, heap-allocated types in WebAssembly. </p>
<p>Normally, a struct declared in this section may only reference structs that precede it  (structs with a lower type index). To support mutually recursive data structures, a feature called recursive type groups is available. Instead of declaring the (potentially) mutually recursive types as individual entries in the type section, a recursive group is declared as a single type section entry. Within this group, individual types are declared, which are thereby allowed to reference each other.</p>
<p>With this in mind, consider the function responsible for parsing the <code>type</code> section from the binary WebAssembly format in <code>v8/src/wasm/module-decoder-impl.h</code>: </p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="&#123;&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;customThumbEnabled&quot;:false,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/zdi-team/96e778db2e9cdd48754a4331c4021041.js\&quot;&gt;&lt;/script&gt;&quot;&#125;" data-block-type="22" id="block-yui_3_17_2_1_1714665780773_24465"><div class="sqs-block-content"><script src="https://gist.github.com/zdi-team/96e778db2e9cdd48754a4331c4021041.js"></script></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1714665780773_24919"><div class="sqs-block-content"><p>At (1), the limit <code>kV8MaxWasmTypes</code> (currently equal to 1,000,000) is passed as a maximum to <code>consume_count()</code>, ensuring that at most this many entries are read from the <code>type</code> section. When recursive type groups were added, this check became insufficient. While this code will permit only <code>kV8MaxWasmTypes</code> entries of the <code>type</code> section to be read, each of those can potentially be a recursive type group containing more than one individual type definition. </p>
<p>This insufficiency was clearly noticed at the time of this change, as together with recursive type groups a second check was added at (2). Here, for each recursive type group, it is checked that the addition of the constituent types would not exceed the <code>kV8MaxWasmTypes</code> limit. </p>
<p>However, this second check is still not enough. While it protects the indices of each type allocated inside a recursive group, the presence of those groups also has implications for types declared outside this group, as each recursive group adds to the total count of declared types. </p>
<p>To make this clearer, imagine a type section consisting of two entries: one recursive group containing<code>kV8MaxWasmTypes</code> entries, and following that group, one non-recursive type. The check at (1) is passed, as the section only has two entries. While processing the recursive group, the check at (2) is also passed, as the section has exactly <code>kV8MaxWasmTypes</code> entries. For the following single type, there is no further check: at (3) the type is simply allocated at the next free index. In this case, the index will be  <code>kV8MaxWasmTypes</code>, exceeding the usual maximum of <code>kV8MaxWasmTypes-1</code>. If there were more than one non-recursive type at the end of the <code>type</code> section, they would similarly get assigned <code>kV8MaxWasmTypes+1</code>, <code>kV8MaxWasmTypes+2</code>, and so forth, as type indices. </p>
<p><b data-preserve-html-node="true">Impact of the Root Cause</b></p>
<p>Exceeding the maximal number of declared heap types might seem like a very harmless resource exhaustion bug at first. However, due to some internal details of how V8 handles WebAssembly heap types, it directly allows constructing some very powerful exploit primitives. </p>
<p>In <code>v8/src/wasm/value-type.h</code>, the encoding of heap types is defined: </p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="&#123;&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;customThumbEnabled&quot;:false,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/zdi-team/673ca14c8db338b0ef782c7d84fbeab2.js\&quot;&gt;&lt;/script&gt;&quot;&#125;" data-block-type="22" id="block-yui_3_17_2_1_1714665780773_26898"><div class="sqs-block-content"><script src="https://gist.github.com/zdi-team/673ca14c8db338b0ef782c7d84fbeab2.js"></script></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1714665780773_27362"><div class="sqs-block-content"><p>Here, V8 assumes that all user-defined heap types will be assigned indices smaller than <code>kV8MaxWasmTypes</code>. Larger indices are reserved for fixed, internal heap types (beginning with <code>kFunc</code>). This results in our own type declarations aliasing one of these internal types, leading to many opportunities for type confusion. </p>
<p><b data-preserve-html-node="true">Universal WebAssembly Type Confusion</b></p>
<p>To leverage this encoding ambiguity into a full type confusion, let’s first consider the <code>struct.new</code> opcode, which produces a reference to a new struct created from fields given on the stack. The caller specifies the desired struct type by passing its type index. The relevant check on the type index can be found in <code>v8/src/wasm/function-body-decoder-impl.h</code>:</p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="&#123;&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;customThumbEnabled&quot;:false,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/zdi-team/9c2b19543362eca7da031237ddd718f5.js\&quot;&gt;&lt;/script&gt;&quot;&#125;" data-block-type="22" id="block-yui_3_17_2_1_1714665780773_28707"><div class="sqs-block-content"><script src="https://gist.github.com/zdi-team/9c2b19543362eca7da031237ddd718f5.js"></script></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1714665780773_29166"><div class="sqs-block-content"><p>Following the validation logic into the <code>has_struct()</code> method from <code>v8/src/wasm/wasm-module.h</code>: </p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="&#123;&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;customThumbEnabled&quot;:false,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/zdi-team/377656c0cc61df7a8f9c1b02a97d6552.js\&quot;&gt;&lt;/script&gt;&quot;&#125;" data-block-type="22" id="block-yui_3_17_2_1_1714665780773_29882"><div class="sqs-block-content"><script src="https://gist.github.com/zdi-team/377656c0cc61df7a8f9c1b02a97d6552.js"></script></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1714665780773_30345"><div class="sqs-block-content"><p>Since we can make <code>types.size()</code>  exceed the usual limit of <code>kV8MaxWasmTypes</code>, we can make the check pass even if when passing an index larger than this value. This allows us to create a reference of an arbitrary internal type that points to the struct we can freely define. </p>
<p>On the other hand, consider now the handling of the <code>ref.cast</code> instruction: </p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="&#123;&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;customThumbEnabled&quot;:false,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/zdi-team/351f77ac7888f95f3b7215ccb6fc45d0.js\&quot;&gt;&lt;/script&gt;&quot;&#125;" data-block-type="22" id="block-yui_3_17_2_1_1714665780773_31119"><div class="sqs-block-content"><script src="https://gist.github.com/zdi-team/351f77ac7888f95f3b7215ccb6fc45d0.js"></script></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1714665780773_31575"><div class="sqs-block-content"><p>Here, a <code>type</code> check elimination is performed. If <code>TypeCheckAlwaysSucceeds</code> returns true, then no actual <code>type</code> check is emitted and the value is simply reinterpreted as the target <code>type</code>.</p>
<p>The function <code>TypeCheckAlwaysSucceeds</code> ultimately calls <code>IsHeapSubtypeOfImpl</code> defined in <code>v8/src/wasm/wasm-subtyping.cc</code>:</p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="&#123;&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;customThumbEnabled&quot;:false,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/zdi-team/ac0c5b2a98f27cd11b11a6ba31eb4e99.js\&quot;&gt;&lt;/script&gt;&quot;&#125;" data-block-type="22" id="block-yui_3_17_2_1_1714665780773_32437"><div class="sqs-block-content"><script src="https://gist.github.com/zdi-team/ac0c5b2a98f27cd11b11a6ba31eb4e99.js"></script></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1714665780773_45083"><div class="sqs-block-content"><p>This means that if our declared type index aliases the constant <code>HeapType::kNone</code>, the type check will always be elided if we cast to any non-function, non-external reference. In combination, we can use this to turn any reference type into any other by the following steps: </p>
<ol>
<li><p>   In the type section, define a structure type with a single field of type <code>anyref</code>, and make this struct have a type index equal to <code>HeapType::kNone</code> using the bug described above. </p>
</li>
<li><p>   Place a non-null reference value of any type on the top of the stack and call <code>struct.new</code> with the type index set to <code>HeapType::kNone</code>. This will succeed, as <code>has_struct()</code> validates the index against the index established via the previous step. </p>
</li>
<li><p>   Also, declare a struct with a normal type index lower than <code>kV8MaxWasmTypes</code> with a single field of the target reference type. Call <code>ref.cast</code> with this  this struct’s type index. The engine will not perform any type check, as the input value is at this point understood to be reference type <code>HeapType::kNone</code>.</p>
</li>
<li><p>   Finally, read back the reference stored in the struct by executing <code>struct.get</code>.</p>
</li>
</ol>
<p>This arbitrary casting of reference types allows transmuting any value type into any other by referencing it, changing the reference type, and then dereferencing it – a universal type confusion. </p>
<p>In particular, this directly contains nearly all usual JavaScript engine exploitation primitives as special cases:</p>
<p>•	Transmuting <code>int</code> to <code>int*</code> and then dereferencing results in an arbitrary read.</p>
<p>•	Transmuting <code>int</code> to <code>int*</code> and then writing to that reference results in an arbitrary write.</p>
<p>•	Transmuting <code>externref</code>to <code>int</code> is the <code>addrOf()</code> primitive, obtaining the address of a JavaScript object.</p>
<p>•	Transmuting <code>int</code> to <code>externref</code> is the <code>fakeObj()</code> primitive, forcing the engine to treat an arbitrary value as a pointer to a JavaScript object. </p>
<p>While casting from <code>HeapType::kNone</code> to an <code>externref</code> is not allowed, remember that we are actually operating on one more level of indirection - transmuting to <code>externref</code> involves casting to a reference to a struct containing one <code>externref</code> member.</p>
<p>Note however that these “arbitrary” reads and writes are still contained in the V8 memory sandbox, as all involved pointers to heap-allocated structures are tagged, compressed pointers inside the heap cage, not full 64-bit raw pointers. </p>
<p><b data-preserve-html-node="true">Integer Underflow Leading to V8 Sandbox Escape</b> </p>
<p>The primitives described above allow for freely manipulating and faking most JavaScript objects. However, all of this happens inside the limited memory space of the V8 sandbox. “Trusted” objects such as WebAssembly instance data cannot yet be manipulated. We will now turn our attention to a bug that can be used to escape the memory sandbox.</p>
<p>An often-used object for JavaScript engine exploits is <code>ArrayBuffer</code> and its corresponding views, (i.e. typed arrays), as it allows for direct, untagged access to some region of memory. </p>
<p>To prevent access to pointers outside the V8 sandbox, sandboxed pointers are used to designate a typed array’s corresponding backing store. Similarly, an ArrayBuffer’s length field is always loaded as a “bounded size access”, inherently limiting its value to a maximum of 235 − 1. </p>
<p>However, in modern JavaScript, the handling of typed arrays has become quite complex due to the introduction of resizable ArrayBuffers (RABs) and their sharable variant, growable SharedArrayBuffers (GSABs). Both variants feature the ability to change their length after the object has been created with the shared variant being restricted to never shrink. In particular, for typed arrays with these kinds of buffers, the array length can never be cached and must be recomputed on each access.</p>
<p>Additionally, ArrayBuffers also feature an offset field, describing the start of the data in the 
actual underlying backing store. This offset must be taken into account when computing the length. </p>
<p>Let’s now look at the code responsible for building a TypedArray’s length access in the optimizing Turbofan compiler. It can be found in <code>v8/src/compiler/graph-assembler.cc</code>. Note that most non-RAB/GSAB cases and the code responsible for dispatching are omitted for simplicity: </p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="&#123;&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;customThumbEnabled&quot;:false,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/zdi-team/5fa99cc879b94e174dc570837d3eb603.js\&quot;&gt;&lt;/script&gt;&quot;&#125;" data-block-type="22" id="block-yui_3_17_2_1_1714665780773_60425"><div class="sqs-block-content"><script src="https://gist.github.com/zdi-team/5fa99cc879b94e174dc570837d3eb603.js"></script></div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1714665780773_60904"><div class="sqs-block-content"><p>For arrays backed by a resizable ArrayBuffer, we can see at (1) that the length is computed as <code>floor((byte_length - byte_offset) / element_size)</code>. Crucially, there is an underflow check. If <code>byte_offset</code> exceeds <code>byte_length</code>, then 0 is returned instead. </p>
<p>Curiously though, in the case of a GSAB-backed array, the corresponding underflow check is missing. Thus, if <code>byte_offset</code> is larger than <code>byte_length</code>, an underflow occurs and the subtraction wraps around to something close to the maximum unsigned 64-bit integer 264. As both of these fields are found in the (by now) attacker-controlled array object, we can easily trigger this using the sandboxed arbitrary read/write primitives discussed previously. This results in access to the whole 64-bit address space, as the length computed by this function is used to bound any typed array accesses (in JIT-compiled code). </p>
<p><b data-preserve-html-node="true">Exploitation for Arbitrary Shellcode Execution</b></p>
<p>Using the two bugs described above, exploitation becomes fairly straightforward. The primitives described in the Universal WebAssembly Type Confusion section directly give arbitrary reads and writes within the V8 memory sandbox. This can then be used to manipulate a growable <code>SharedArrayBuffer</code> to have an offset greater than its length. A previously JIT-compiled read/write function can then be used to access and overwrite data anywhere in the process’s address space. An appropriate target for overwrite is the compiled code of a <code>WebAssembly</code> module, since that resides in an RWX (read-write-execute) page and can be overwritten with shellcode.</p>

</div></div><div class="sqs-block horizontalrule-block sqs-block-horizontalrule" data-block-type="47" id="block-yui_3_17_2_1_1714665780773_62579"><div class="sqs-block-content"><hr /></div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" id="block-yui_3_17_2_1_1714665780773_62866"><div class="sqs-block-content">

<div class="sqs-html-content">
  <p class="" style="white-space:pre-wrap;"><em>Thanks again to Manfred for providing this thorough write-up. He has contributed multiple bugs to the ZDI program over the last few years, and we certainly hope to see more submissions from him in the future. Until then, follow the team on </em><a href="https://www.twitter.com/thezdi"><em>Twitter</em></a><em>, </em><a href="https://infosec.exchange/@thezdi"><em>Mastodon</em></a><em>, </em><a href="https://www.linkedin.com/company/zerodayinitiative"><em>LinkedIn</em></a><em>, or </em><a href="https://www.instagram.com/thezdi"><em>Instagram</em></a><em> for the latest in exploit techniques and security patches.</em></p>
</div>




















  
  



</div></div></div></div></div>
                      </div>

                       
                        <ul class="blog-tags">
                          
                            <!--TAGS-->
                            
                              <li><a class="tag" href="/blog?tag=Pwn2Own">Pwn2Own</a></li>
                            
                              <li><a class="tag" href="/blog?tag=Chrome">Chrome</a></li>
                            
                              <li><a class="tag" href="/blog?tag=Edge">Edge</a>
                          
                        </ul>
                      
                   
                    
                </div>
                <div class="contentBlockImage">
                    <div class="blog-actions">
                        <a href="/blog" class="btn mediumButton back-btn">BACK TO THE BLOG</a>
                        <ul class="social-share">
                            <a class="icon-heart" title="Like this">
  <span class="sqs-simple-like" data-item-id="" data-like-count="">
    <span class="like-icon"></span>
    <span class="like-count"></span>
  </span>
</a>
                            <a class="icon-share" title="Share"><span class="squarespace-social-buttons inline-style" data-system-data-id="" data-asset-url="" data-record-type="" data-full-url="" data-title=""></span></a>

                            <!-- <li><a href="#" class="twitter-share"><img src="/assets/twitterIcon.svg" alt="Twitter" /></a></li>
                            <li><a href="#" class="facebook-share"><img src="/assets/facebookIcon.svg" alt="Facebook" /></a></li>
                            <li><a href="#" class="linkedin-share"><img src="/assets/linkedinIcon.svg" alt="Linkedin" /></a></li> -->
                        </ul>
                    </div>  
                </div>
            </div><!-- /. contentBlock -->
        </div>

        <div class="section blog-listing-details">
            <div class="threeCols">

                <!-- get recent blog post -->
                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="/blog/2025/1/9/looking-at-the-attack-surfaces-of-the-sony-xav-ax8500-part-2"  style="background: url('https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1736456767968-81FWDKZ9DQPPZNJI9DVG/car-automotive-vehicle-digital-technology-futuristic-1575621-pxhere.com.jpg') no-repeat;"></a>
                                

                              </a>
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="/blog/2025/1/9/looking-at-the-attack-surfaces-of-the-sony-xav-ax8500-part-2">Looking at the Attack Surfaces of the Sony XAV-AX8500 Part 2</a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="/?tag=Automotive">Automotive</a>,
                              
                                <a class="tag" href="/?tag=Sony">Sony</a>,
                              
                                <a class="tag" href="/?tag=Attack+Surface">Attack Surface</a>
                            
                          </div>
                        
                      </div>

                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="/blog/2025/1/8/looking-at-the-attack-surfaces-of-the-sony-xav-ax8500"  style="background: url('https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1736369747604-2S7UV4VZGHYOEQZ07FQ7/car-automotive-vehicle-digital-technology-futuristic-1575621-pxhere.com.jpg') no-repeat;"></a>
                                

                              </a>
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="/blog/2025/1/8/looking-at-the-attack-surfaces-of-the-sony-xav-ax8500">Looking at the Attack Surfaces of the Sony XAV-AX8500</a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="/?tag=Sony">Sony</a>,
                              
                                <a class="tag" href="/?tag=Automotive">Automotive</a>,
                              
                                <a class="tag" href="/?tag=Attack+Surface">Attack Surface</a>
                            
                          </div>
                        
                      </div>

                  

                      <div class="column">
                        <div class="content">
                          <div class="thumb">
                              
                                
                                    <a href="/blog/2025/1/8/zdi-threat-hunting-2024-highlights-trends-amp-challenges"  style="background: url('https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1736355653962-HBHQEUUOQBQ6UJWA5456/light-sunset-road-car-night-automobile-72295-pxhere.com.jpg') no-repeat;"></a>
                                

                              </a>
                          </div>
                        </div>
                        <h3 class="title" data-content-field="title">
                          
                            <a href="/blog/2025/1/8/zdi-threat-hunting-2024-highlights-trends-amp-challenges">ZDI Threat Hunting 2024: Highlights, Trends, &amp; Challenges</a>
                          
                        </h3>
                         
                          <div class="listing-tags">
                            
                              <!--TAGS-->
                              
                                <a class="tag" href="/?tag=Threat+Hunting">Threat Hunting</a>,
                              
                                <a class="tag" href="/?tag=Retrospective">Retrospective</a>
                            
                          </div>
                        
                      </div>

                  

            </div>
        </div>
    </div><!-- /. blog-listing -->
</div>
          </div>
        </section>

        
        
        

        

        <!--FOOTER WITH OPEN BLOCK FIELD-->
        <footer id="footer">
          <div id="footerContact">
    <div class="content">
        <div class="footerContactBox">
            <h3>General Inquiries</h3>
            <a href="mailto:zdi@trendmicro.com">zdi@trendmicro.com</a>
        </div>
        <div class="footerContactBox">
            <h3>Find us on X</h3>
            <a href="https://twitter.com/thezdi">@thezdi</a>
        </div>
        <div class="footerContactBox">
            <h3>Find us on Mastodon</h3>
            <a rel="me" href="https://infosec.exchange/@thezdi">Mastodon</a>
        </div>
        <div class="footerContactBox">
            <h3>Media Inquiries</h3>
            <a href="mailto:media_relations@trendmicro.com">media_relations@trendmicro.com</a>
        </div>
        <div class="footerContactBox">
            <h3>Sensitive Email Communications</h3>
            <a href="https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc" target="_blank">PGP Key</a>
        </div>
    </div>
</div>

<div id="footerMenu">
    <div id="footerMiddleSection" class="group">
        <div id="footerLinks">
            <div class="content">
                <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/about" class="footerTitleLink">WHO WE ARE</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/about">Our Mission</a></li>
                                <li><a href="https://www.trendmicro.com">Trend Micro</a></li>
                                <li><a href="https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html">TippingPoint IPS</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/about/benefits" class="footerTitleLink">HOW IT WORKS</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/about/benefits#process">Process</a></li>
                                <li><a href="https://www.zerodayinitiative.com/about/benefits#researcher-rewards">Researcher Rewards</a></li>
                                <li><a href="https://www.zerodayinitiative.com/about/faq">FAQS</a></li>
                                <li><a href="https://www.trendmicro.com/privacy">Privacy</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/advisories" class="footerTitleLink">ADVISORIES</a>
                            <ul>
                                <li><a href="https://www.zerodayinitiative.com/advisories/published">Published Advisories</a></li>
                                <li><a href="https://www.zerodayinitiative.com/advisories/upcoming">Upcoming Advisories</a></li>
                                <li><a href="https://www.zerodayinitiative.com/rss">RSS Feeds</a></li>
                            </ul>
                        </div>
                        <div class="footerLinkBox">
                            <a href="https://www.zerodayinitiative.com/blog" class="footerTitleLink">BLOG</a>
                        </div>

                        <div class="footerLogo">
                            <a href="https://www.zerodayinitiative.com/"><img src="https://www.zerodayinitiative.com/images/logo-footer.svg" alt="thezdi"/></a>
                        </div>
            </div>
        </div>
    </div>
</div>

        </footer>

        

    <!--INJECTION POINT FOR TRACKING SCRIPTS AND USER CONTENT FROM THE CODE INJECTION TAB-->

    <script data-sqs-type="imageloader-bootstrapper">if(window.ImageLoader) window.ImageLoader.bootstrap({}, document);</script><script>Squarespace.afterBodyLoad(Y);</script><svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none" data-usage="social-icons-svg"><symbol id="twitter-icon" viewBox="0 0 64 64"><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"/></symbol><symbol id="twitter-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M44.7,25.5c0,0.3,0,0.6,0,0.8C44.7,35,38.1,45,26.1,45c-3.7,0-7.2-1.1-10.1-2.9 c0.5,0.1,1,0.1,1.6,0.1c3.1,0,5.9-1,8.2-2.8c-2.9-0.1-5.3-2-6.1-4.6c0.4,0.1,0.8,0.1,1.2,0.1c0.6,0,1.2-0.1,1.7-0.2 c-3-0.6-5.3-3.3-5.3-6.4c0,0,0-0.1,0-0.1c0.9,0.5,1.9,0.8,3,0.8c-1.8-1.2-2.9-3.2-2.9-5.5c0-1.2,0.3-2.3,0.9-3.3 c3.2,4,8.1,6.6,13.5,6.9c-0.1-0.5-0.2-1-0.2-1.5c0-3.6,2.9-6.6,6.6-6.6c1.9,0,3.6,0.8,4.8,2.1c1.5-0.3,2.9-0.8,4.2-1.6 c-0.5,1.5-1.5,2.8-2.9,3.6c1.3-0.2,2.6-0.5,3.8-1C47.1,23.4,46,24.5,44.7,25.5z"/></symbol><symbol id="youtube-icon" viewBox="0 0 64 64"><path d="M46.7,26c0,0-0.3-2.1-1.2-3c-1.1-1.2-2.4-1.2-3-1.3C38.3,21.4,32,21.4,32,21.4h0 c0,0-6.3,0-10.5,0.3c-0.6,0.1-1.9,0.1-3,1.3c-0.9,0.9-1.2,3-1.2,3S17,28.4,17,30.9v2.3c0,2.4,0.3,4.9,0.3,4.9s0.3,2.1,1.2,3 c1.1,1.2,2.6,1.2,3.3,1.3c2.4,0.2,10.2,0.3,10.2,0.3s6.3,0,10.5-0.3c0.6-0.1,1.9-0.1,3-1.3c0.9-0.9,1.2-3,1.2-3s0.3-2.4,0.3-4.9 v-2.3C47,28.4,46.7,26,46.7,26z M28.9,35.9l0-8.4l8.1,4.2L28.9,35.9z"/></symbol><symbol id="youtube-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M47,33.1c0,2.4-0.3,4.9-0.3,4.9s-0.3,2.1-1.2,3c-1.1,1.2-2.4,1.2-3,1.3 C38.3,42.5,32,42.6,32,42.6s-7.8-0.1-10.2-0.3c-0.7-0.1-2.2-0.1-3.3-1.3c-0.9-0.9-1.2-3-1.2-3S17,35.6,17,33.1v-2.3 c0-2.4,0.3-4.9,0.3-4.9s0.3-2.1,1.2-3c1.1-1.2,2.4-1.2,3-1.3c4.2-0.3,10.5-0.3,10.5-0.3h0c0,0,6.3,0,10.5,0.3c0.6,0.1,1.9,0.1,3,1.3 c0.9,0.9,1.2,3,1.2,3s0.3,2.4,0.3,4.9V33.1z M28.9,35.9l8.1-4.2l-8.1-4.2L28.9,35.9z"/></symbol></svg>
    </div> <!-- end #innerWrapper -->
    </div> <!-- end #outerWrapper -->
    <script src="https://www.zerodayinitiative.com/js/main.js"/>
  </body>

</html>
