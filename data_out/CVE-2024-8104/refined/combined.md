=== Content from plugins.trac.wordpress.org_9d0b800f_20250111_080001.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwpextended%2Ftrunk%2Fincludes%2Flibraries%2Fwpext_export%2Fwpext_export.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3193235 "Revision 3193235")
* Next Revision →
* [Blame](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php)

---

# [source:](/browser?order=name "Go to repository root") [wpextended](/browser/wpextended?order=name "View wpextended")/[trunk](/browser/wpextended/trunk?order=name "View trunk")/[includes](/browser/wpextended/trunk/includes?order=name "View includes")/[libraries](/browser/wpextended/trunk/includes/libraries?order=name "View libraries")/[wpext\_export](/browser/wpextended/trunk/includes/libraries/wpext_export?order=name "View wpext_export")/[wpext\_export.php](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?order=name "View wpext_export.php")

View diff against:

View revision:

| [Last change](/changeset/3220003/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php "View differences") on this file was [3220003](/changeset/3220003/ "View changeset 3220003"), checked in by wpextended, [26 hours ago](/timeline?from=2025-01-10T05%3A41%3A46Z&precision=second "See timeline at 01/10/2025 05:41:46 AM") |
| --- |
| Fix: Login Attempts Module - Unauthenticated SQL Injection and sanitization and uses values. Fix: Duplication module, There is an issue with the post-duplication module with a block theme. Security Fix: The esc\_url is missing in the export for posts/pages/users export. |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 5.5 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Export helper class |
| [4](#L4) | \*/ |
| [5](#L5) |  |
| [6](#L6) |  |
| [7](#L7) | class Wp\_Extended\_Export extends Wp\_Extended { |
| [8](#L8) |  |
| [9](#L9) | public $formats = array( 'csv' ); |
| [10](#L10) | public $action = 'wpext-export'; |
| [11](#L11) | public $action\_download = 'wpext-export-download'; |
| [12](#L12) |  |
| [13](#L13) | public function \_\_construct() { |
| [14](#L14) | parent::\_\_construct(); |
| [15](#L15) |  |
| [16](#L16) | add\_action( 'admin\_enqueue\_scripts', array( 'Wp\_Extended\_Export', 'admin\_scripts') ); |
| [17](#L17) | } |
| [18](#L18) |  |
| [19](#L19) | public static function init(){ |
| [20](#L20) | static $instance = null; |
| [21](#L21) |  |
| [22](#L22) | if ( is\_null( $instance ) ) { |
| [23](#L23) | $instance = new Wp\_Extended\_Export( get\_called\_class(), WP\_EXTENDED\_VERSION ); |
| [24](#L24) | } |
| [25](#L25) |  |
| [26](#L26) | return $instance; |
| [27](#L27) | } // init |
| [28](#L28) |  |
| [29](#L29) |  |
| [30](#L30) | public function add\_export\_action( $actions, $object ) { |
| [31](#L31) |  |
| [32](#L32) | foreach( $this->formats as $format ) { |
| [33](#L33) | $url = add\_query\_arg( |
| [34](#L34) | array( |
| [35](#L35) | 'action' => $this->action, |
| [36](#L36) | 'id'     => $object->ID, |
| [37](#L37) | 'format' => $format |
| [38](#L38) | ), |
| [39](#L39) | admin\_url( 'admin-ajax.php' ) |
| [40](#L40) | ); |
| [41](#L41) |  |
| [42](#L42) | $action = sprintf( |
| [43](#L43) | '<a href="%1$s&wpext\_nonce='.wp\_create\_nonce('wpext-ajax-nonce').'" target="\_blank"> |
| [44](#L44) | Download |
| [45](#L45) | %2$s |
| [46](#L46) | </a>', |
| [47](#L47) | esc\_url( $url ), |
| [48](#L48) | esc\_html( \_\_( strtoupper( $format ), WP\_EXTENDED\_TEXT\_DOMAIN ) ) |
| [49](#L49) | ); |
| [50](#L50) |  |
| [51](#L51) | $actions[ 'export\_' . $format ] = apply\_filters( 'wpext-export-action', $action ); |
| [52](#L52) | } |
| [53](#L53) |  |
| [54](#L54) | return $actions; |
| [55](#L55) | } // add\_export\_action |
| [56](#L56) |  |
| [57](#L57) |  |
| [58](#L58) | public function add\_bulk\_action( $actions ){ |
| [59](#L59) |  |
| [60](#L60) | foreach( $this->formats as $format ) { |
| [61](#L61) | if( !isset( $actions[ 'wpext\_export\_' . $format ] ) ) { |
| [62](#L62) | $actions[ 'wpext\_export\_' . $format ] = \_\_( 'Export to ' . strtoupper( $format ), WP\_EXTENDED\_TEXT\_DOMAIN ); |
| [63](#L63) | } |
| [64](#L64) | } |
| [65](#L65) |  |
| [66](#L66) | return $actions; |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) |  |
| [70](#L70) | /\* |
| [71](#L71) | Saves assoc array as csv file to tmp folder |
| [72](#L72) | returns filepath on success, null on failure |
| [73](#L73) | \*/ |
| [74](#L74) | public function export\_csv( $data = array() ){ |
| [75](#L75) |  |
| [76](#L76) | $data = apply\_filters( 'wpext-export-data', $data, 'csv' ); |
| [77](#L77) |  |
| [78](#L78) | // make tmp dir |
| [79](#L79) | $dir = $this->\_get\_files\_dir(); |
| [80](#L80) |  |
| [81](#L81) | do { |
| [82](#L82) | $fname = uniqid(); |
| [83](#L83) |  |
| [84](#L84) | $tmp\_path = "{$dir}/{$fname}.csv"; |
| [85](#L85) | } |
| [86](#L86) | while( file\_exists( $tmp\_path ) ); |
| [87](#L87) |  |
| [88](#L88) |  |
| [89](#L89) | $tmp\_path = apply\_filters( 'wpext-export-tmp-path', $tmp\_path, 'csv' ); |
| [90](#L90) |  |
| [91](#L91) |  |
| [92](#L92) | // save csv |
| [93](#L93) | $file = fopen( $tmp\_path, 'w'); |
| [94](#L94) | if( !$file ) { |
| [95](#L95) | // error creating file |
| [96](#L96) | return null; |
| [97](#L97) | } |
| [98](#L98) |  |
| [99](#L99) | // put column names |
| [100](#L100) | $names = array\_keys( (array) $data[0] ); |
| [101](#L101) | fputcsv($file, $names); |
| [102](#L102) |  |
| [103](#L103) | foreach ($data as $row) { |
| [104](#L104) | fputcsv($file, $row ); |
| [105](#L105) | } |
| [106](#L106) |  |
| [107](#L107) | fclose( $file ); |
| [108](#L108) |  |
| [109](#L109) | return $tmp\_path; |
| [110](#L110) | } // \_export\_csv |
| [111](#L111) |  |
| [112](#L112) |  |
| [113](#L113) | public function \_get\_files\_dir(){ |
| [114](#L114) | $dir = plugin\_dir\_path( \_\_FILE\_\_ ); |
| [115](#L115) | $dir .= 'tmp'; |
| [116](#L116) |  |
| [117](#L117) | if( !is\_dir( $dir ) ) { |
| [118](#L118) | mkdir( $dir ); |
| [119](#L119) | } |
| [120](#L120) |  |
| [121](#L121) | return $dir; |
| [122](#L122) | } // \_get\_files\_dir |
| [123](#L123) |  |
| [124](#L124) |  |
| [125](#L125) | public function download\_file\_ajax(){ |
| [126](#L126) | $filename = isset($\_GET['filename']) ? sanitize\_file\_name($\_GET['filename']) : ''; |
| [127](#L127) |  |
| [128](#L128) | $sent = $this->download\_file( $filename ); |
| [129](#L129) |  |
| [130](#L130) | if( $sent !== true ) { |
| [131](#L131) | wp\_send\_json( $sent ); |
| [132](#L132) | } |
| [133](#L133) |  |
| [134](#L134) | wp\_die(); |
| [135](#L135) | } // download\_file\_ajax |
| [136](#L136) |  |
| [137](#L137) |  |
| [138](#L138) | public function download\_file( $filename ){ |
| [139](#L139) |  |
| [140](#L140) | try { |
| [141](#L141) | $dir = $this->\_get\_files\_dir(); |
| [142](#L142) |  |
| [143](#L143) |  |
| [144](#L144) | $file\_path = $dir . "/" . $filename; |
| [145](#L145) |  |
| [146](#L146) |  |
| [147](#L147) | if( !file\_exists( $file\_path ) ) { |
| [148](#L148) | throw new \Exception( "File not found" ); |
| [149](#L149) | } |
| [150](#L150) |  |
| [151](#L151) | $content\_type = mime\_content\_type( $file\_path ); |
| [152](#L152) | $size = filesize($file\_path); |
| [153](#L153) |  |
| [154](#L154) | // send response to browser |
| [155](#L155) | if( !headers\_sent() ) { |
| [156](#L156) | header('Content-type: ' . $content\_type ); |
| [157](#L157) | header('Content-Disposition: attachment; filename="'. $filename .'"'); |
| [158](#L158) | header('Expires: 0'); |
| [159](#L159) | header('Cache-Control: must-revalidate'); |
| [160](#L160) | header('Pragma: public'); |
| [161](#L161) | header('Content-Length: ' . $size ); |
| [162](#L162) | } |
| [163](#L163) |  |
| [164](#L164) | readfile($file\_path); |
| [165](#L165) |  |
| [166](#L166) | return true; |
| [167](#L167) | } |
| [168](#L168) | catch( \Exception $e ) { |
| [169](#L169) | return $e->getMessage(); |
| [170](#L170) | } |
| [171](#L171) |  |
| [172](#L172) | } // download\_file |
| [173](#L173) |  |
| [174](#L174) |  |
| [175](#L175) | public static function admin\_scripts(){ |
| [176](#L176) | static $done = false; |
| [177](#L177) |  |
| [178](#L178) | if( $done ) { |
| [179](#L179) | return; |
| [180](#L180) | } |
| [181](#L181) |  |
| [182](#L182) | $screen = get\_current\_screen(); |
| [183](#L183) |  |
| [184](#L184) | // this script is used for posts / pages / users export |
| [185](#L185) | wp\_enqueue\_script( 'wpext-export', |
| [186](#L186) | plugins\_url("wpext-export.js", \_\_FILE\_\_ ), |
| [187](#L187) | array(), |
| [188](#L188) | filemtime( plugin\_dir\_path( \_\_FILE\_\_ ) . "wpext-export.js" ), |
| [189](#L189) | true |
| [190](#L190) | ); |
| [191](#L191) |  |
| [192](#L192) | if( !empty($\_GET['wpext-export']) ) { |
| [193](#L193) | wp\_add\_inline\_script('wpext-export', 'const wpext\_download\_url = "' . esc\_url($\_GET['wpext-export']) . '";', 'before'); |
| [194](#L194) | } |
| [195](#L195) |  |
| [196](#L196) | $done = true; |
| [197](#L197) |  |
| [198](#L198) | } // admin\_scripts |
| [199](#L199) |  |
| [200](#L200) |  |
| [201](#L201) |  |
| [202](#L202) | public function do\_bulk\_action( $sendback, $doaction, $ids ){ |
| [203](#L203) |  |
| [204](#L204) | $format = preg\_replace( '/^wpext\_export\_/', '', $doaction ); |
| [205](#L205) |  |
| [206](#L206) | if( method\_exists( $this, "get\_items" ) |
| [207](#L207) | && method\_exists( $this, "export\_{$format}" ) ) { |
| [208](#L208) |  |
| [209](#L209) | $items = $this->get\_items( $ids ); |
| [210](#L210) |  |
| [211](#L211) | $filepath = $this->{"export\_{$format}"}( $items ); |
| [212](#L212) |  |
| [213](#L213) | if( $filepath ) { |
| [214](#L214) | $download\_url = add\_query\_arg( |
| [215](#L215) | array( |
| [216](#L216) | 'action'    => $this->action\_download, |
| [217](#L217) | 'filename'  => basename( $filepath ) |
| [218](#L218) | ), |
| [219](#L219) | admin\_url( 'admin-ajax.php' ) |
| [220](#L220) | ); |
| [221](#L221) |  |
| [222](#L222) | $sendback = add\_query\_arg( array( 'wpext-export' => urlencode( $download\_url ) ), $sendback ); |
| [223](#L223) | } |
| [224](#L224) | } |
| [225](#L225) |  |
| [226](#L226) | return $sendback; |
| [227](#L227) | } // do\_bulk\_action |
| [228](#L228) |  |
| [229](#L229) |  |
| [230](#L230) | public function check\_formats(){ |
| [231](#L231) |  |
| [232](#L232) | $clean = array(); |
| [233](#L233) |  |
| [234](#L234) | $formats = apply\_filters( 'wpext-export-formats-before-check', $this->formats ); |
| [235](#L235) |  |
| [236](#L236) | foreach( $formats as $format ) { |
| [237](#L237) | if( !method\_exists( $this, "export\_{$format}" ) ) { |
| [238](#L238) | continue; |
| [239](#L239) | } |
| [240](#L240) |  |
| [241](#L241) | $clean[] = $format; |
| [242](#L242) | } |
| [243](#L243) |  |
| [244](#L244) | $clean = apply\_filters( 'wpext-export-formats', $clean ); |
| [245](#L245) |  |
| [246](#L246) | $this->formats = $clean; |
| [247](#L247) | } // check\_formats |
| [248](#L248) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?format=txt)
* [Original Format](/export/3220616/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_6008f119_20250111_080001.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3145430%2540wpextended%252Ftrunk%26old%3D3134345%2540wpextended%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3134345/wpextended/trunk?old=3145430&old_path=%2Fwpextended%2Ftrunk)

---

# Changes in [wpextended/trunk](/browser/wpextended/trunk?rev=3145430 "Show entry in browser") [[3134345:3145430]](/log/wpextended/trunk?rev=3145430&stop_rev=3134345 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[wpextended/trunk](/browser/wpextended/trunk?rev=3145430)
Files:

23 edited

* [admin/class-wp-extended-admin.php](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [admin/js/wp\_extended-admin.js](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file1 "Show differences"))
* [admin/partials/wp-extend-admin-display.php](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [includes/libraries/wpext\_export/wpext\_export.php](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [includes/modules/core\_extensions/wpext\_block\_user\_name\_admin/wpext\_block\_user\_name\_admin.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [includes/modules/core\_extensions/wpext\_change\_wp\_admin\_url/wpext\_change\_wp\_admin\_url.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [includes/modules/core\_extensions/wpext\_duplicate\_menu/wpext\_duplicate\_menu.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [includes/modules/core\_extensions/wpext\_duplicator/wpext\_duplicator.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file7 "Show differences"))
* [includes/modules/core\_extensions/wpext\_export\_users/wpext\_export\_users.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [includes/modules/core\_extensions/wpext\_external\_permalinks/wpext\_external\_permalinks.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [includes/modules/core\_extensions/wpext\_hide\_admin\_bar/wpext\_hide\_admin\_bar.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [includes/modules/core\_extensions/wpext\_limit\_login\_attempts/wpext\_limit\_login\_attempts.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [includes/modules/core\_extensions/wpext\_maintenance\_mode/wpext\_maintenance\_mode.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [includes/modules/core\_extensions/wpext\_pixel\_tag\_manager/wpext\_pixel\_tag\_manager.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [includes/modules/core\_extensions/wpext\_post\_order/wpext\_post\_order.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [includes/modules/core\_extensions/wpext\_smtp\_email/wpext\_smtp\_email.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/old/wpext\_snippets.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/wp-extend-module-listing.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393 "Show entry in browser")
  (modified)
  ([3 diffs](#file17 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/wpext\_snippets.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file18 "Show differences"))
* [includes/modules/core\_extensions/wpext\_tidy\_nav/wpext\_tidy\_nav.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file19 "Show differences"))
* [includes/modules/core\_extensions/wpext\_user\_sections/wpext\_user\_sections.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [readme.txt](/browser/wpextended/trunk/readme.txt?rev=3145393 "Show entry in browser")
  (modified)
  ([3 diffs](#file21 "Show differences"))
* [wp-extended.php](/browser/wpextended/trunk/wp-extended.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file22 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wpextended/trunk/admin/class-wp-extended-admin.php](/changeset/3145393/wpextended/trunk/admin/class-wp-extended-admin.php?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fclass-wp-extended-admin.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/class-wp-extended-admin.php")

  | [r3134345](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3131199#L41 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393#L41 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 41 | 41 | add\_action('admin\_enqueue\_scripts', array( $this, 'enqueue\_styles' ) ); |
  | 42 | 42 | add\_action('admin\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ), 99 ); |
  | 43 |  |  |
  | 44 | 43 | add\_action('wp\_ajax\_wp-extended-module-toggle',   array( $this, 'module\_toggle\_ajax') ); |
  | 45 |  | ~~add\_action('wp\_ajax\_wp-extended-module-all-toggle',   array( $this, 'module\_all\_toggle\_ajax') );~~ |
  | 46 | 44 | add\_action('wpext\_plugin\_sidebar', array( $this, 'admin\_plugin\_info\_sidebar' ), 100 ); |
  | 47 | 45 | add\_action('admin\_plugin\_top\_info', array( $this, 'wpext\_admin\_plugin\_top\_info' ), 100 ); |
  | […](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3131199#L255) | […](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393#L253) |  |
  | 255 | 253 | include \_\_DIR\_\_ . '/partials/wp-extend-admin-display.php'; |
  | 256 | 254 | } // admin\_display |
  | 257 |  |  |
  | 258 |  | /\* |
  | 259 |  | \* AJAX endpoint for all module activation/dectivation |
  | 260 |  | \*/ |
  | 261 |  |  |
  | 262 |  | public function module\_all\_toggle\_ajax(){ |
  | 263 |  |  |
  | 264 |  | $status = $\_POST['status']; |
  | 265 |  | $allaction = $\_POST['allaction']; |
  | 266 |  |  |
  | 267 |  | $groups = $this->groups(); |
  | 268 |  | $modules = $this->modules(); |
  | 269 |  |  |
  | 270 |  | update\_option( $allaction, $status); |
  | 271 |  | $response = get\_option( $allaction); |
  | 272 |  |  |
  | 273 |  | foreach ($modules['core\_extensions'] as  $modulename) { |
  | 274 |  | $module = $modulename['dirname']; |
  | 275 |  | if ($modulename['available']){ |
  | 276 |  | $this->module\_toggle( $module, $status ); |
  | 277 |  | } |
  | 278 |  | } |
  | 279 |  | wp\_send\_json( $response ); |
  | 280 |  | die('0'); |
  | 281 |  | } |
  |  | 255 |  |
  | 282 | 256 | /\* |
  | 283 | 257 | \* AJAX endpoint for module activation |
* ## [wpextended/trunk/admin/js/wp\_extended-admin.js](/changeset/3145393/wpextended/trunk/admin/js/wp_extended-admin.js?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fjs%2Fwp_extended-admin.js "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/js/wp_extended-admin.js")

  | [r3134345](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L541 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L541 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 541 | 541 | .attr('onclick') |
  | 542 | 542 | .match(/'([^']+)'/)[1]; |
  | 543 |  |  |
  |  | 543 |  |
  | 544 | 544 | jQuery('.item.list-group-item, .item.grid-group-item').each(function () { |
  | 545 | 545 | var checkbox = jQuery(this).find('.form-check-input'); |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L582) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L582) |  |
  | 582 | 582 |  |
  | 583 | 583 | var urlParams = new URLSearchParams(window.location.search); |
  | 584 |  | if (urlParams.get('page') === 'wp-extended') { |
  |  | 584 | if (urlParams.get('page') === 'wp-extended') { |
  | 585 | 585 | // Attach the change event listener to the Active Modules checkbox |
  | 586 | 586 | jQuery('#wpext\_active\_modules').change(function () { |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L595) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L595) |  |
  | 595 | 595 | } |
  | 596 | 596 |  |
  |  | 597 | // Delay the visibility toggle when the page reloads |
  |  | 598 | setTimeout(function() { |
  |  | 599 | toggleItemsVisibility(); |
  |  | 600 | }, 100); |
  |  | 601 |  |
  | 597 | 602 | jQuery('#wpext\_active\_modules').on('change', function () { |
  | 598 | 603 | var isChecked = this.checked; |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L608) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L613) |  |
  | 608 | 613 | }); |
  | 609 | 614 | }); |
  |  | 615 |  |
  |  | 616 | /\*Hide show active module \*/ |
  |  | 617 | jQuery(document).ready(function($) { |
  |  | 618 | // Function to toggle visibility of the container based on checkboxes' state |
  |  | 619 | function toggleActiveModulesContainer() { |
  |  | 620 | var $checkboxes = $('.wpext\_toggle\_settings .card-footer input[type="checkbox"]'); |
  |  | 621 | var $activeModulesContainer = $('.wpext\_toggle\_settings .wpext\_active\_modules\_container'); |
  |  | 622 | var anyChecked = $checkboxes.is(':checked'); |
  |  | 623 | if (anyChecked) { |
  |  | 624 | $activeModulesContainer.show(); |
  |  | 625 | } else { |
  |  | 626 | $activeModulesContainer.hide(); |
  |  | 627 | } |
  |  | 628 | } |
  |  | 629 | $('.wpext\_toggle\_settings .card-footer input[type="checkbox"]').click(function() { |
  |  | 630 | toggleActiveModulesContainer(); |
  |  | 631 | }); |
  |  | 632 |  |
  |  | 633 | // Initial call to set the correct visibility based on checkbox states |
  |  | 634 | toggleActiveModulesContainer(); |
  |  | 635 | }); |
  |  | 636 | /\*Hide show active module end here \*/ |
* ## [wpextended/trunk/admin/partials/wp-extend-admin-display.php](/changeset/3145393/wpextended/trunk/admin/partials/wp-extend-admin-display.php?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fpartials%2Fwp-extend-admin-display.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/partials/wp-extend-admin-display.php")

  | [r3134345](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3131199#L72 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3145393#L72 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 72 | 72 | </div> |
  | 73 | 73 | <div class="wpext\_active\_modules\_container me-lg-3"> |
  | 74 |  | <label for="wpext\_active\_modules" class="mt-1"><?php \_e('Active Modules',WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
  | 75 |  | <div class="field form-check form-switch form-switch-md"> |
  | 76 |  | <?php |
  | 77 |  | $action\_module\_status = get\_option('wpext\_active\_modules\_status'); |
  | 78 |  |  |
  | 79 |  | if($action\_module\_status == 'true'){ |
  | 80 |  | $status = 'checked'; |
  | 81 |  | }else{ |
  | 82 |  | $status = ''; |
  | 83 |  | } |
  | 84 |  | ?> |
  | 85 |  | <input id="wpext\_active\_modules" name="wpext\_active\_modules" type="checkbox" class="form-check-input" <?php echo $status; ?> role="switch"> |
  | 86 |  | </div> |
  | 87 |  | </div> |
  |  | 74 | <?php |
  |  | 75 | $wpext\_module\_status = get\_option('wp-extended-modules'); |
  |  | 76 | $has\_displayed = false; |
  |  | 77 | foreach($wpext\_module\_status as $key => $module\_status) { |
  |  | 78 | if(!empty($module\_status) && !$has\_displayed) { ?> |
  |  | 79 | <label for="wpext\_active\_modules" class="mt-1"><?php \_e('Active Modules', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
  |  | 80 | <div class="field form-check form-switch form-switch-md"> |
  |  | 81 | <?php |
  |  | 82 | $action\_module\_status = get\_option('wpext\_active\_modules\_status'); |
  |  | 83 | if($action\_module\_status == 'true'){ |
  |  | 84 | $status = 'checked'; |
  |  | 85 | } else { |
  |  | 86 | $status = ''; |
  |  | 87 | } |
  |  | 88 | ?> |
  |  | 89 | <input id="wpext\_active\_modules" name="wpext\_active\_modules" type="checkbox" class="form-check-input" <?php echo $status; ?>  role="switch"> |
  |  | 90 | </div> |
  |  | 91 | <?php |
  |  | 92 | $has\_displayed = true; // Set the flag to true to prevent further display |
  |  | 93 | } |
  |  | 94 | } ?> |
  |  | 95 | </div> |
  | 88 | 96 | </div> |
  | 89 | 97 | <!-- end grid section --> |
* ## [wpextended/trunk/includes/libraries/wpext\_export/wpext\_export.php](/changeset/3145393/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?old=3134252&old_path=wpextended%2Ftrunk%2Fincludes%2Flibraries%2Fwpext_export%2Fwpext_export.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/libraries/wpext_export/wpext_export.php")

  | [r3134345](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3134252#L136 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393#L136 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 136 | 136 |  |
  | 137 | 137 | public function download\_file\_ajax(){ |
  | 138 |  | $filename = $\_GET['filename']; |
  | 139 |  |  |
  |  | 138 |  |
  |  | 139 | /\* Security Issues fixed \*/ |
  |  | 140 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 141 | wp\_send\_json\_error( \_\_( 'You do not have permission to access this file.', WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 142 | wp\_die(); |
  |  | 143 | } |
  |  | 144 | // Verify the nonce for security. |
  |  | 145 | check\_ajax\_referer( 'wpext-ajax-nonce', 'wpext\_nonce' ); |
  |  | 146 |  |
  |  | 147 | // Sanitize the filename. |
  |  | 148 | $filename = isset( $\_GET['filename'] ) ? sanitize\_file\_name( $\_GET['filename'] ) : ''; |
  |  | 149 |  |
  |  | 150 | if ( empty( $filename ) ) { |
  |  | 151 | wp\_send\_json\_error( \_\_( 'Invalid file request.', WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 152 | wp\_die(); |
  |  | 153 | } |
  |  | 154 | /\* Security Issues fixed end here\*/ |
  |  | 155 |  |
  | 140 | 156 | $sent = $this->download\_file( $filename ); |
  | 141 |  |  |
  | 142 | 157 | if( $sent !== true ) { |
  | 143 | 158 | wp\_send\_json( $sent ); |
  | […](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3134252#L152) | […](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393#L167) |  |
  | 152 | 167 | try { |
  | 153 | 168 | $dir = $this->\_get\_files\_dir(); |
  | 154 |  |  |
  | 155 |  |  |
  | 156 |  | $file\_path = $dir . "/" . $filename; |
  | 157 |  |  |
  | 158 |  |  |
  |  | 169 | $file\_path = realpath( $dir . '/' . $filename ); |
  |  | 170 |  |
  | 159 | 171 | if( !file\_exists( $file\_path ) ) { |
  | 160 | 172 | throw new \Exception( "File not found" ); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_block\_user\_name\_admin/wpext\_block\_user\_name\_admin.php](/changeset/3145430/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_block_user_name_admin%2Fwpext_block_user_name_admin.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3099195#L21 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430#L21 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | } |
  | 22 | 22 |  |
  | 23 |  | public function wpext\_check\_the\_current\_username(){ |
  | 24 |  | $admin\_user = get\_user\_by('login', 'admin'); |
  | 25 |  | if ($admin\_user) { |
  | 26 |  | add\_action('admin\_notices', array($this, 'wpext\_admin\_notice')); |
  | 27 |  | } |
  |  | 23 | public function wpext\_check\_the\_current\_username() { |
  |  | 24 | $admin\_user = get\_user\_by('login', 'admin'); |
  |  | 25 | $user = wp\_get\_current\_user(); |
  |  | 26 | $roles = is\_array($user->roles) ? $user->roles : array(); |
  |  | 27 | // Validate that the current user is an administrator and the 'admin' user exists |
  |  | 28 | if ($admin\_user && isset($roles[0]) && sanitize\_text\_field($roles[0]) === 'administrator') { |
  |  | 29 | add\_action('admin\_notices', array($this, 'wpext\_admin\_notice')); |
  |  | 30 | } |
  | 28 | 31 | } |
  | 29 | 32 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3099195#L49) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430#L52) |  |
  | 49 | 52 | public function wpext\_change\_admin\_name(){ |
  | 50 | 53 | global $wpdb; |
  | 51 |  | if( ! wp\_verify\_nonce(sanitize\_text\_field($\_REQUEST['nonce']), 'wpext-nonce' ) ) { |
  | 52 |  | $result = array( |
  | 53 |  | 'status' => false, |
  | 54 |  | 'error' => \_\_( 'Invalid nonce!', WP\_EXTENDED\_TEXT\_DOMAIN ) |
  | 55 |  | ); |
  | 56 |  | wp\_send\_json( $result ); |
  | 57 |  | die(); |
  |  | 54 |  |
  |  | 55 | // Verify nonce |
  |  | 56 |  |
  |  | 57 | if ( ! isset( $\_REQUEST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_text\_field( $\_REQUEST['nonce'] ), 'wpext-nonce' ) ) { |
  |  | 58 | wp\_send\_json( array( 'status' => false, 'error' => \_\_( 'Invalid nonce!', WP\_EXTENDED\_TEXT\_DOMAIN ) ) ); |
  |  | 59 | die(); |
  | 58 | 60 | } |
  |  | 61 |  |
  |  | 62 | // Capability check: Allow only administrators |
  |  | 63 |  |
  |  | 64 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 65 | wp\_send\_json( array( 'status' => false, 'error' => \_\_( 'You do not have sufficient permissions to perform this action.', WP\_EXTENDED\_TEXT\_DOMAIN ) ) ); |
  |  | 66 | die(); |
  |  | 67 | } |
  |  | 68 |  |
  | 59 | 69 | $new\_username = sanitize\_text\_field($\_POST['username']); |
  | 60 | 70 | $admin\_user = get\_user\_by('login', 'admin'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_change\_wp\_admin\_url/wpext\_change\_wp\_admin\_url.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_change_wp_admin_url%2Fwpext_change_wp_admin_url.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3099195#L93 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3145393#L93 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 93 | 93 | $slug = 'wp-extended-changes-wp-admin-url'; |
  | 94 | 94 | $callback = [ get\_called\_class(), 'settings\_changes\_wp\_admin\_url']; |
  | 95 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 95 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 96 | 96 | add\_rewrite\_rule('^wp-extended-changes-wp-admin-url/?', 'index.php?wp\_extended\_changes\_wp\_admin-url=1', 'top'); |
  | 97 | 97 | add\_rewrite\_tag('%wp\_extended\_changes\_wp\_admin%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_duplicate\_menu/wpext\_duplicate\_menu.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_duplicate_menu%2Fwpext_duplicate_menu.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3112929#L62 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3145393#L62 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | $capability = 'manage\_options'; |
  | 63 | 63 | $callback = [get\_called\_class(), 'settings\_duplicate\_menu']; |
  | 64 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 64 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 65 | 65 | add\_rewrite\_rule('^wp-extended-duplicate-menu/?', 'index.php?wp\_extended\_duplicate\_menu=1', 'top'); |
  | 66 | 66 | add\_rewrite\_tag('%wp\_extended\_duplicate\_menu%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_duplicator/wpext\_duplicator.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_duplicator%2Fwpext_duplicator.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L24 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L24 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 |  |
  | 25 | 25 | try { |
  | 26 |  | if ( ! wp\_verify\_nonce( $\_REQUEST['wpext\_nonce'], 'wpext-ajax-nonce' ) ) { |
  | 27 |  | throw new \Exception( "Invalid nonce!" ); |
  | 28 |  | } |
  | 29 |  | $post\_ID = intval($\_REQUEST['post\_ID']); |
  | 30 |  | if( empty($post\_ID) ) { |
  | 31 |  | throw new \Exception( "Post ID not specified" ); |
  | 32 |  | } |
  | 33 |  | $duplicate = $this->duplicate\_post( $post\_ID ); |
  | 34 |  | if( is\_wp\_error( $duplicate ) ) { |
  | 35 |  | throw new \Exception( $duplicate->get\_error\_message() ); |
  | 36 |  | } |
  | 37 |  | $duplicate->url = get\_the\_permalink( $duplicate->ID ); |
  | 38 |  | $duplicate->edit\_url = get\_edit\_post\_link( $duplicate, 'json' ); |
  | 39 |  | $result = array( 'status' => true, 'duplicate' => $duplicate ); |
  |  | 26 | if ( ! current\_user\_can( 'edit\_post', $post\_ID ) ) { |
  |  | 27 | throw new \Exception( \_\_( "You are not allowed to duplicate this post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 28 | } |
  |  | 29 | if ( ! wp\_verify\_nonce( $\_REQUEST['wpext\_nonce'], 'wpext-ajax-nonce' ) ) { |
  |  | 30 | throw new \Exception( "Invalid nonce!" ); |
  |  | 31 | } |
  |  | 32 | $post\_ID = intval($\_REQUEST['post\_ID']); |
  |  | 33 | if( empty($post\_ID) ) { |
  |  | 34 | throw new \Exception( "Post ID not specified" ); |
  |  | 35 | } |
  |  | 36 | $duplicate = $this->duplicate\_post( $post\_ID ); |
  |  | 37 | if( is\_wp\_error( $duplicate ) ) { |
  |  | 38 | throw new \Exception( $duplicate->get\_error\_message() ); |
  |  | 39 | } |
  |  | 40 | $duplicate->url = get\_the\_permalink( $duplicate->ID ); |
  |  | 41 | $duplicate->edit\_url = get\_edit\_post\_link( $duplicate, 'json' ); |
  |  | 42 | $result = array( 'status' => true, 'duplicate' => $duplicate ); |
  | 40 | 43 | } |
  | 41 | 44 | catch( \Exception $e ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L47) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L50) |  |
  | 47 | 50 |  |
  | 48 | 51 | public function duplicate\_post( $post\_ID ) { |
  |  | 52 |  |
  | 49 | 53 | try { |
  | 50 |  | if~~( !current\_user\_can('edit\_posts'~~) ) { |
  | 51 |  | throw new \Exception( ~~"Not allowed"~~ ); |
  |  | 54 | if ( ! current\_user\_can( 'edit\_post', $post\_ID ) ) { |
  |  | 55 | throw new \Exception( \_\_( "You are not allowed to duplicate this post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  | 52 | 56 | } |
  | 53 | 57 | if( empty($post\_ID) ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L58) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L62) |  |
  | 58 | 62 | throw new \Exception( "Source post not found" ); |
  | 59 | 63 | } |
  |  | 64 | // Ensure that contributors can't duplicate password-protected posts. |
  |  | 65 | if ( 'private' === $post->post\_status && ! current\_user\_can( 'read\_private\_posts' ) ) { |
  |  | 66 | throw new \Exception( \_\_( "You cannot duplicate this private post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 67 | } |
  |  | 68 |  |
  | 60 | 69 | // copy |
  | 61 | 70 | $newPost = json\_decode( json\_encode($post), true ); |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L64) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L73) |  |
  | 64 | 73 | 'comment\_status' => $post->comment\_status, |
  | 65 | 74 | 'ping\_status'    => $post->ping\_status, |
  | 66 |  | 'post\_author'    => ~~$new\_post\_author~~, |
  |  | 75 | 'post\_author'    => get\_current\_user\_id(), |
  | 67 | 76 | 'post\_content'   => $post->post\_content, |
  | 68 | 77 | 'post\_excerpt'   => $post->post\_excerpt, |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_export\_users/wpext\_export\_users.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_export_users%2Fwpext_export_users.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3112929#L53 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393#L53 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 53 | 53 | } // get\_items |
  | 54 | 54 | public function download\_user\_ajax(){ |
  |  | 55 | check\_ajax\_referer('wpext-ajax-nonce', 'wpext\_nonce'); |
  |  | 56 | if (!current\_user\_can('export')) { |
  |  | 57 | wp\_send\_json\_error(\_\_('You do not have permission to export users.', WP\_EXTENDED\_TEXT\_DOMAIN)); |
  |  | 58 | wp\_die(); |
  |  | 59 | } |
  | 55 | 60 | try { |
  | 56 |  | $id = $\_GET['id']; |
  | 57 |  | $format = !empty($\_GET['format']) ? $\_GET['format'] : 'csv'; |
  |  | 61 | $id = isset($\_GET['id']) ? intval($\_GET['id']) : 0; |
  |  | 62 | $format = !empty($\_GET['format']) ? sanitize\_text\_field($\_GET['format']) : 'csv'; |
  |  | 63 |  |
  | 58 | 64 | $user = get\_userdata( $id ); |
  | 59 | 65 | if( !$user ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3112929#L79) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393#L85) |  |
  | 79 | 85 | wp\_die(); |
  | 80 | 86 | } // download\_user\_ajax |
  |  | 87 |  |
  | 81 | 88 | public function profile\_button( $user ) { |
  |  | 89 | if (!current\_user\_can('edit\_user', $user->ID)) { |
  |  | 90 | return; |
  |  | 91 | } |
  | 82 | 92 | $actions = $this->add\_export\_action( array(), $user ); |
  | 83 | 93 | ?> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_external\_permalinks/wpext\_external\_permalinks.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?old=3105485&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_external_permalinks%2Fwpext_external_permalinks.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3105485#L58 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3145393#L58 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 58 | 58 | $slug = 'wp-extended-external\_permalink'; |
  | 59 | 59 | $callback = [ get\_called\_class(), 'wpext\_external\_permalink\_interface']; |
  | 60 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 60 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 61 | 61 | add\_rewrite\_rule('^wp-extended-external\_permalink/?', 'index.php?wp\_extended\_external\_permalink=1', 'top'); |
  | 62 | 62 | add\_rewrite\_tag('%wp\_extended\_external\_permalink%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_hide\_admin\_bar/wpext\_hide\_admin\_bar.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_hide_admin_bar%2Fwpext_hide_admin_bar.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3099195#L48 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3145393#L48 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | $slug = 'wp-extended-hide-adminbar'; |
  | 49 | 49 | $callback = [ get\_called\_class(), 'settings\_hide\_admin\_bar']; |
  | 50 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 50 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 51 | 51 | add\_rewrite\_rule('^wp-extended-hide-adminbar/?', 'index.php?wp\_extended\_hide\_adminbar=1', 'top'); |
  | 52 | 52 | add\_rewrite\_tag('%wp\_extended\_hide\_adminbar%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_limit\_login\_attempts/wpext\_limit\_login\_attempts.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?old=3109167&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_limit_login_attempts%2Fwpext_limit_login_attempts.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3109167#L56 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3145393#L56 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 56 | 56 | $slug = 'wp-extended\_login\_attempt'; |
  | 57 | 57 | $callback = [ get\_called\_class(), 'settings\_admin\_login\_attempt']; |
  | 58 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 58 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 59 | 59 | add\_rewrite\_rule('^wp-extended\_login\_attempt/?', 'index.php?wp\_extended\_login\_attempt=1', 'top'); |
  | 60 | 60 | add\_rewrite\_tag('%wp\_extended\_login\_attempt%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_maintenance\_mode/wpext\_maintenance\_mode.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_maintenance_mode%2Fwpext_maintenance_mode.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3112929#L92 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3145393#L92 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 92 | 92 | $slug = 'wp-extended-maintenance-mode'; |
  | 93 | 93 | $callback = [ get\_called\_class(), 'settings\_admin\_maintenance\_mode']; |
  | 94 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 94 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 95 | 95 | add\_rewrite\_rule('^wp-extended-maintenance-mode/?', 'index.php?wp\_extended\_maintenance\_mode=1', 'top'); |
  | 96 | 96 | add\_rewrite\_tag('%wp\_extended\_maintenance\_mode%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_pixel\_tag\_manager/wpext\_pixel\_tag\_manager.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_pixel_tag_manager%2Fwpext_pixel_tag_manager.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3099195#L48 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3145393#L48 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | $capability = 'manage\_options'; |
  | 49 | 49 | $callback = [get\_called\_class(), 'settings\_pixel\_tag\_manager']; |
  | 50 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 50 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 51 | 51 | add\_rewrite\_rule('^wp-extended-pixel-tag-manager/?', 'index.php?wp\_extended\_pixel\_tag\_manager=1', 'top'); |
  | 52 | 52 | add\_rewrite\_tag('%wp\_extended\_pixel\_tag\_manager%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_post\_order/wpext\_post\_order.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_post_order%2Fwpext_post_order.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3099195#L80 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3145393#L80 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 80 | 80 | $query .= ( $query ? "&" : "" ) . $extra; |
  | 81 | 81 | $url = $path . "?" . $query; |
  | 82 |  | wp\_redirect( $url, 302, 'WP-Extended-Post-order' ); |
  | 83 |  | exit; |
  |  | 82 | if($screen->post\_type != 'page'){ |
  |  | 83 | wp\_redirect($url, 302, 'WP-Extended-Post-order'); |
  |  | 84 | exit; |
  |  | 85 | } |
  | 84 | 86 | } |
  | 85 | 87 | else if( $\_REQUEST['orderby'] === 'menu\_order' ) { |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_smtp\_email/wpext\_smtp\_email.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?old=3131199&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_smtp_email%2Fwpext_smtp_email.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3131199#L37 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3145393#L37 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 37 | 37 | $callback = [$this, 'wp\_extended\_smtp\_settings\_page']; |
  | 38 | 38 | $icon = 'dashicons-admin-plugins'; |
  | 39 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 39 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 40 | 40 | add\_rewrite\_rule('^wp-extended\_smtp-settings/?', 'index.php?wp\_extended\_smtp-settings=1', 'top'); |
  | 41 | 41 | add\_rewrite\_tag('%wp\_extended\_smtp-settings%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/old/wpext\_snippets.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?old=3128457&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fold%2Fwpext_snippets.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3128457#L42 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393#L42 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 42 | 42 | if((isset($menustatus) && $menustatus == 'true') && !empty($flagfavorite) ) { |
  | 43 | 43 | add\_submenu\_page( |
  | 44 |  | ~~null~~, |
  |  | 44 | '', |
  | 45 | 45 | \_\_( 'Code Snippets Old', WP\_EXTENDED\_TEXT\_DOMAIN ), // page title |
  | 46 | 46 | \_\_( 'Code Snippets Old', WP\_EXTENDED\_TEXT\_DOMAIN ), // menu title |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3128457#L52) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393#L52) |  |
  | 52 | 52 | $slug = 'wp-extended-snippets-old'; |
  | 53 | 53 | $callback = [ $this, 'page\_cb\_old']; |
  | 54 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 54 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 55 | 55 | add\_rewrite\_rule('^wp-extended-snippets-old/?', 'index.php?wp\_extended\_snippets=1', 'top'); |
  | 56 | 56 | add\_rewrite\_tag('%wp\_extended\_snippets%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/wp-extend-module-listing.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?old=3134252&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fwp-extend-module-listing.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L113 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L113 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 113 | 113 | if ('duplicate' === $this->current\_action() && isset($\_GET['snippet\_id'])) { |
  | 114 | 114 | $nonce = $\_REQUEST['\_wpnonce']; |
  | 115 |  | if (~~!wp\_verify\_nonce($nonce, 'duplicate\_snippet\_' . $\_GET['snippet\_id'])~~) { |
  |  | 115 | if ( !wp\_verify\_nonce( $nonce, 'duplicate\_snippet\_' . sanitize\_text\_field( $\_GET['snippet\_id'] ) ) ) { |
  | 116 | 116 | die('Security check failed'); |
  | 117 | 117 | } |
  | 118 |  | $this->duplicate\_snippet(~~$\_GET['snippet\_id']~~); |
  |  | 118 | $this->duplicate\_snippet( sanitize\_text\_field($\_GET['snippet\_id']) ); |
  | 119 | 119 | } |
  | 120 | 120 | } |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L155) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L155) |  |
  | 155 | 155 | public function current\_action() { |
  | 156 | 156 | if (isset($\_REQUEST['action']) && $\_REQUEST['action'] !== -1) { |
  | 157 |  | return ~~$\_REQUEST['action']~~; |
  |  | 157 | return sanitize\_key($\_REQUEST['action']); |
  | 158 | 158 | } |
  | 159 | 159 |  |
  | 160 | 160 | if (isset($\_REQUEST['action2']) && $\_REQUEST['action2'] !== -1) { |
  | 161 |  | return ~~$\_REQUEST['action2']~~; |
  |  | 161 | return sanitize\_key($\_REQUEST['action2']); |
  | 162 | 162 | } |
  | 163 | 163 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L214) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L214) |  |
  | 214 | 214 | $items = $custom\_list\_table->get\_items(); ?> |
  | 215 | 215 | <form method="get"> |
  | 216 |  | <input type="hidden" name="page" value="<?php echo ~~$\_REQUEST['page']~~; ?>"> |
  |  | 216 | <input type="hidden" name="page" value="<?php echo esc\_attr( sanitize\_text\_field( $\_REQUEST['page'] ) ); ?>"> |
  | 217 | 217 | <?php $custom\_list\_table->search\_box('Search Snippets', 'search\_id'); ?> |
  | 218 | 218 | </form> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/wpext\_snippets.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?old=3128457&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fwpext_snippets.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L104 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L104 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 104 | 104 | $slug = 'wp-extended-snippets'; |
  | 105 | 105 | $callback = [ $this, 'list\_snippets\_page']; |
  | 106 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 106 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 107 | 107 | add\_rewrite\_rule('^wp-extended-snippets/?', 'index.php?wp\_extended\_snippets=1', 'top'); |
  | 108 | 108 | add\_rewrite\_tag('%wp\_extended\_snippets%', '([^&]+)'); |
  | 109 | 109 | } |
  | 110 |  | add\_submenu\_page(~~null~~, \_\_('Add New Snippet', 'wp-extended-snippets'), \_\_('Add New Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-add-snippet', array($this, 'wpext\_add\_snippet\_page')); |
  | 111 |  | add\_submenu\_page(~~null~~, \_\_('Edit Snippet', 'wp-extended-snippets'), \_\_('Edit Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-edit-snippet', array($this, 'edit\_snippet\_page')); |
  |  | 110 | add\_submenu\_page('', \_\_('Add New Snippet', 'wp-extended-snippets'), \_\_('Add New Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-add-snippet', array($this, 'wpext\_add\_snippet\_page')); |
  |  | 111 | add\_submenu\_page('', \_\_('Edit Snippet', 'wp-extended-snippets'), \_\_('Edit Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-edit-snippet', array($this, 'edit\_snippet\_page')); |
  | 112 | 112 | } |
  | 113 | 113 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L291) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L291) |  |
  | 291 | 291 | <div class="wpext\_snippet\_top\_section d-flex mb-3"> |
  | 292 | 292 | <div class="col-3"> |
  | 293 |  | <h2 class="wpext\_snippet\_title"> <?php echo $selected\_option = isset($\_GET['selected\_option']) ? $\_GET['selected\_option'] : ''; ?></h2> |
  |  | 293 | <h2 class="wpext\_snippet\_title"> |
  |  | 294 | <?php |
  |  | 295 | $selected\_option = isset($\_GET['selected\_option']) ? sanitize\_text\_field($\_GET['selected\_option']) : ''; |
  |  | 296 | echo esc\_html($selected\_option); |
  |  | 297 | ?> |
  |  | 298 | </h2> |
  | 294 | 299 | <?php self::wpext\_custom\_css\_content($selected\_option); ?> |
  | 295 | 300 | <input type="hidden" name="snippet\_position" value="<?php echo $selected\_option; ?>" id="snippet\_code\_type"> |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L548) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L553) |  |
  | 548 | 553 | } |
  | 549 | 554 | // Additional check for the specific snippets page |
  | 550 |  | if ($pagenow === 'admin.php' && isset($\_GET['page']) && ~~$\_GET['page']~~ === 'wp-extended-snippets') { |
  |  | 555 | if ($pagenow === 'admin.php' && isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) === 'wp-extended-snippets') { |
  | 551 | 556 | return false; |
  | 552 | 557 | } |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L680) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L685) |  |
  | 680 | 685 | <div class="col-lg-6 wp\_brand\_sub\_header\_right mx-lg-0 px-2"> |
  | 681 | 686 | <div class="wpext-return-module-wrap wpext\_snippet\_action"> |
  | 682 |  | <?php if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-snippets') { ?> |
  |  | 687 | <?php if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-snippets') { ?> |
  | 683 | 688 | <button class="page-title-action wp-ext-btn-prim" ><?php \_e('Add New', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
  | 684 | 689 | <?php } ?> |
  | 685 |  | <?php if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-add-snippet') { ?> |
  |  | 690 | <?php if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-add-snippet') { ?> |
  | 686 | 691 | <a href='<?php echo admin\_url('admin.php?page=wp-extended-snippets'); ?>' class="wp-ext-btn-sec"><?php \_e('Back to Snippets', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
  | 687 | 692 | <button class="wpext\_module\_action wp-ext-btn-prim wpext\_save\_snippet" ><?php \_e('Save', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
  | 688 | 693 | <?php } |
  | 689 |  | if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-edit-snippet') { ?> |
  |  | 694 | if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-edit-snippet') { ?> |
  | 690 | 695 | <a href='<?php echo admin\_url('admin.php?page=wp-extended-snippets'); ?>' class="wp-ext-btn-sec"><?php \_e('Back to Snippets', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
  | 691 | 696 | <button class="wpext\_module\_action wp-ext-btn-prim wpext\_updeate\_code\_snippets" ><?php \_e('Save', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_tidy\_nav/wpext\_tidy\_nav.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_tidy_nav%2Fwpext_tidy_nav.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3112929#L79 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3145393#L79 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 79 | 79 | $slug = 'wp-extended-tidymenu'; |
  | 80 | 80 | $callback = [ get\_called\_class(), 'settings\_tidy\_menu']; |
  | 81 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 81 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 82 | 82 | add\_rewrite\_rule('^wp-extended-tidymenu/?', 'index.php?wp\_extended\_tidymenu=1', 'top'); |
  | 83 | 83 | add\_rewrite\_tag('%wp\_extended\_tidymenu%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_user\_sections/wpext\_user\_sections.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_user_sections%2Fwpext_user_sections.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3099195#L76 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3145393#L76 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 76 | 76 | $slug = 'wp-extended-user-sections'; |
  | 77 | 77 | $callback = [ $this, 'page\_cb']; |
  | 78 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 78 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 79 | 79 | add\_rewrite\_rule('^wp-extended-user-sections/?', 'index.php?wp\_extended\_user\_sections=1', 'top'); |
  | 80 | 80 | add\_rewrite\_tag('%wp\_extended\_user\_sections%', '([^&]+)'); |
* ## [wpextended/trunk/readme.txt](/changeset/3145393/wpextended/trunk/readme.txt?old=3134345&old_path=wpextended%2Ftrunk%2Freadme.txt "Show the [3134345:3145430] differences restricted to wpextended/trunk/readme.txt")

  | [r3134345](/browser/wpextended/trunk/readme.txt?rev=3134345#L4 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/readme.txt?rev=3145393#L4 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.6 |
  | 5 | 5 | Tested up to: 6.6.1 |
  | 6 |  | Stable tag: 3.0.~~8~~ |
  |  | 6 | Stable tag: 3.0.9 |
  | 7 | 7 | Requires PHP: 7.4 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/wpextended/trunk/readme.txt?rev=3134345#L141) | […](/browser/wpextended/trunk/readme.txt?rev=3145393#L141) |  |
  | 141 | 141 | == Changelog == |
  | 142 | 142 |  |
  |  | 143 | = 3.0.9 - 02 September 2024 = |
  |  | 144 | \* Improvement: Hide "Active Modules" until enabled any one module. |
  |  | 145 | \* Update: Part of the Patchstack VDP Program. |
  |  | 146 | \* Fix: Post Type Order - Post type order not working with hierarchical parent/children. |
  |  | 147 | \* Fix: Warnings fixed for PHP 8.\* |
  |  | 148 | \* Security Fix: Code snippet module - Escaping and sanitising output. |
  |  | 149 | \* Security Fix: Duplicate Duplicate Pages/Posts module - Added user capability checks. |
  |  | 150 | \* Security Fix: Block username module - Added user capability checks. |
  |  | 151 |  |
  | 143 | 152 | = 3.0.8 - 12 August 2024 = |
  | 144 | 153 | \* Improvement: Code snippet - Duplicate functionality. |
  | 145 |  | \* Improvement:  Quick Add Post - Updated module description. |
  |  | 154 | \* Improvement: Hide "Active Modules" until active any one module. |
  |  | 155 | \* Improvement:  Quick Add Post - Updated module description |
  | 146 | 156 | \* Fix: mkdir issue on some servers. |
  | 147 |  | \* Fix: Duplicate Menu - Updated correct Read Documentation link~~.~~ |
  |  | 157 | \* Fix: Duplicate Menu - Updated correct Read Documentation link |
  | 148 | 158 |  |
  | 149 | 159 | = 3.0.7 - 5 August 2024 = |
  | […](/browser/wpextended/trunk/readme.txt?rev=3134345#L409) | […](/browser/wpextended/trunk/readme.txt?rev=3145393#L419) |  |
  | 409 | 419 | The "Disable Blog" module is designed for websites that don't require a blog feature. By disabling blog-related functionalities, this module helps streamline your admin area. |
  | 410 | 420 |  |
  |  | 421 | = How can I report security bugs? = |
  |  | 422 |  |
  |  | 423 | You can report security bugs through the Patchstack Vulnerability Disclosure Program. The Patchstack team help validate, triage and handle any security vulnerabilities. [Report a security vulnerability.](https://patchstack.com/database/vdp/wpextended) |
* ## [wpextended/trunk/wp-extended.php](/changeset/3145393/wpextended/trunk/wp-extended.php?old=3134252&old_path=wpextended%2Ftrunk%2Fwp-extended.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/wp-extended.php")

  | [r3134345](/browser/wpextended/trunk/wp-extended.php?rev=3134252#L4 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/wp-extended.php?rev=3145393#L4 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/wpextended |
  | 5 | 5 | \* Description: Many of your favourite plugins rolled up into 1 modular plugin making your WordPress faster and easier to manage. |
  | 6 |  | \* Version: 3.0.~~8~~ |
  |  | 6 | \* Version: 3.0.9 |
  | 7 | 7 | \* Requires at least: 5.6 |
  | 8 | 8 | \* Requires PHP:      7.4 |
  | […](/browser/wpextended/trunk/wp-extended.php?rev=3134252#L28) | […](/browser/wpextended/trunk/wp-extended.php?rev=3145393#L28) |  |
  | 28 | 28 |  |
  | 29 | 29 | }else{ |
  | 30 |  | define( 'WP\_EXTENDED\_VERSION', '3.0.~~8~~' ); |
  |  | 30 | define( 'WP\_EXTENDED\_VERSION', '3.0.9' ); |
  | 31 | 31 | define( 'WP\_EXTENDED\_TEXT\_DOMAIN', 'wp-extended' ); |
  | 32 | 32 | define( 'WP\_EXTENDED\_PATH', plugin\_dir\_path( \_\_FILE\_\_ ) ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3145430&old=3134345&new_path=%2Fwpextended%2Ftrunk&old_path=%2Fwpextended%2Ftrunk)
* [Zip Archive](?format=zip&new=3145430&old=3134345&new_path=%2Fwpextended%2Ftrunk&old_path=%2Fwpextended%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_f353f4b8_20250111_080003.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# The Ultimate WordPress Toolkit – WP Extended <= 3.0.8 - Directory Traversal to Authenticated (Subscriber+) Arbitrary File Download

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   The Ultimate WordPress Toolkit – WP Extended <= 3.0.8 - Directory Traversal to Authenticated (Subscriber+) Arbitrary File Download

8.8

**Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-8104](https://www.cve.org/CVERecord?id=CVE-2024-8104) |
| --- | --- |
| CVSS | 8.8 (High) |
| Publicly Published | September 3, 2024 |
| Last Updated | September 4, 2024 |
| Researcher | [Marco Wotschka - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/marco-wotschka) |

### Description

The The Ultimate WordPress Toolkit – WP Extended plugin for WordPress is vulnerable to Directory Traversal in all versions up to, and including, 3.0.8 via the download\_file\_ajax function. This makes it possible for authenticated attackers, with subscriber access and above, to read the contents of arbitrary files on the server, which can contain sensitive information.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php#L137)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3145430%40wpextended%2Ftrunk&old=3134345%40wpextended%2Ftrunk&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-directory-traversal-to-authenticated-subscriber-arbitrary-file-download&t=The%20Ultimate%20WordPress%20Toolkit%20%E2%80%93%20WP%20Extended%20%3C%3D%203.0.8%20-%20Directory%20Traversal%20to%20Authenticated%20%28Subscriber%2B%29%20Arbitrary%20File%20Download "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-directory-traversal-to-authenticated-subscriber-arbitrary-file-download&text=The%20Ultimate%20WordPress%20Toolkit%20%E2%80%93%20WP%20Extended%20%3C%3D%203.0.8%20-%20Directory%20Traversal%20to%20Authenticated%20%28Subscriber%2B%29%20Arbitrary%20File%20Download "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-directory-traversal-to-authenticated-subscriber-arbitrary-file-download "LinkedIn")
Email

## Vulnerability Details for The Ultimate WordPress Toolkit – WP Extended

#### [The Ultimate WordPress Toolkit – WP Extended](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpextended)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wpextended [(view on wordpress.org)](https://wordpress.org/plugins/wpextended) |
| Patched? | Yes |
| Remediation | Update to version 3.0.9, or a newer patched version |
| Affected Version | * <= 3.0.8 |
| Patched Version | * 3.0.9 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


