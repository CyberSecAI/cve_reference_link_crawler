
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2Fea3eb2ac736bb63e47c654e14e3ec556)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2Fea3eb2ac736bb63e47c654e14e3ec556&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2Fea3eb2ac736bb63e47c654e14e3ec556) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2Fea3eb2ac736bb63e47c654e14e3ec556&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@QUICTester](https://avatars.githubusercontent.com/u/137782456?s=64&v=4)](/QUICTester)

# [QUICTester](/QUICTester)/**[gist:ea3eb2ac736bb63e47c654e14e3ec556](/QUICTester/ea3eb2ac736bb63e47c654e14e3ec556)**

Last active
May 26, 2024 03:28

Show Gist options

* [Download ZIP](/QUICTester/ea3eb2ac736bb63e47c654e14e3ec556/archive/153f29c51bcc43c4ce40b64e87380b9c8c4562fe.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2Fea3eb2ac736bb63e47c654e14e3ec556)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2Fea3eb2ac736bb63e47c654e14e3ec556)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/QUICTester/ea3eb2ac736bb63e47c654e14e3ec556.js&quot;&gt;&lt;/script&gt;
* Save QUICTester/ea3eb2ac736bb63e47c654e14e3ec556 to your computer and use it in GitHub Desktop.

[Code](/QUICTester/ea3eb2ac736bb63e47c654e14e3ec556)
[Revisions
2](/QUICTester/ea3eb2ac736bb63e47c654e14e3ec556/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/QUICTester/ea3eb2ac736bb63e47c654e14e3ec556.js&quot;&gt;&lt;/script&gt;

Save QUICTester/ea3eb2ac736bb63e47c654e14e3ec556 to your computer and use it in GitHub Desktop.

[Download ZIP](/QUICTester/ea3eb2ac736bb63e47c654e14e3ec556/archive/153f29c51bcc43c4ce40b64e87380b9c8c4562fe.zip)

No state machine in Kwik TLS engine.

 [Raw](/QUICTester/ea3eb2ac736bb63e47c654e14e3ec556/raw/153f29c51bcc43c4ce40b64e87380b9c8c4562fe/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | This vulnerability was found in Kwik (https://github.com/ptrd/kwik) which is using Agent15 (https://github.com/ptrd/agent15) |
| --- | --- |
|  | as the TLS engine. |
|  |  |
|  | For Kwik (QUIC implementation): |
|  | Found in 745fd4e2d8d104b9cf1e8342d150ff8967c65892 |
|  | Fixed in 11862d54d72de63abd0b76ca6bb9df56e634212c |
|  |  |
|  | For Agent15 (TLS implementation): |
|  | Found in bcaf02e6f75cc14b1aff7cbaa8ea28188f1398b0 |
|  | Fixed in d6b46538cbfd60a66ef58848212ec2204d00e535 |
|  |  |
|  | Affected Component: Client-Server QUIC connections. |
|  | Attack Type: Remote |
|  | Impact: Denial of Service and potential connection hijack. |
|  |  |
|  | Vulnerability details: |
|  | The TLS engine (Agent 15) Kwik uses does not have a state machine. In other words, the TLS engine does not track the current |
|  | state of the connection. If a Client Hello TLS message is sent twice, the cryptographic parameter in the latter Client Hello |
|  | will overwrite the previously computed cryptographic parameter from the first Client Hello message. The overwrite behavior |
|  | can happen at any connection state, including after the connection is established. This also applies to the Finished TLS |
|  | message. |
|  | Combine with CVE-2024-22588 (https://nvd.nist.gov/vuln/detail/CVE-2024-22588), An attacker can use the unused Initial key to |
|  | send an Initial packet with a malicous Client Hello TLS message to overwrite victim-server connection parameters and state on |
|  | the server. Then, the attacker can potentially hijack the connection from the victim by completing the overwritten connection |
|  | with a Finished TLS message. |
|  |  |
|  | Exploitation steps: |
|  | 1) The attacker must be able to sniff the network traffic. |
|  | 2) Capture the first QUIC packets sent by a QUIC client (victim). |
|  | 3) Compute the Initial encryption key as described in https://www.rfc-editor.org/rfc/rfc9001.html#name-keys. |
|  | 4) Send an Initial packet with a Client Hello TLS message to the server to overwrite the victim's connection parameters |
|  | and state on the server. |
|  | 5) Because the server does not discard the Initial keys, it will decrypt and process the Initial packet sent in (4) even |
|  | after the QUIC handshake is completed. This will overwrite the victim-server connection parameters and state on the |
|  | server. The victim is now desynchronised (not able to communicate) with the server. |
|  | 6) The attacker may complete the overwritten connection with a Finished TLS message. |
|  |  |
|  | Reference: |
|  | https://nvd.nist.gov/vuln/detail/CVE-2024-22588 |
|  | https://github.com/ptrd/kwik/issues/32 |
|  | https://www.rfc-editor.org/rfc/rfc9001#name-discarding-unused-keys |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2Fea3eb2ac736bb63e47c654e14e3ec556)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

