
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frjbs%2FEmail-MIME%2Fissues%2F66)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frjbs%2FEmail-MIME%2Fissues%2F66)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=rjbs%2FEmail-MIME)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rjbs](/rjbs)
/
**[Email-MIME](/rjbs/Email-MIME)**
Public

* [Notifications](/login?return_to=%2Frjbs%2FEmail-MIME) You must be signed in to change notification settings
* [Fork
  30](/login?return_to=%2Frjbs%2FEmail-MIME)
* [Star
   20](/login?return_to=%2Frjbs%2FEmail-MIME)

* [Code](/rjbs/Email-MIME)
* [Issues
  13](/rjbs/Email-MIME/issues)
* [Pull requests
  3](/rjbs/Email-MIME/pulls)
* [Actions](/rjbs/Email-MIME/actions)
* [Projects
  0](/rjbs/Email-MIME/projects)
* [Security](/rjbs/Email-MIME/security)
* [Insights](/rjbs/Email-MIME/pulse)

Additional navigation options

* [Code](/rjbs/Email-MIME)
* [Issues](/rjbs/Email-MIME/issues)
* [Pull requests](/rjbs/Email-MIME/pulls)
* [Actions](/rjbs/Email-MIME/actions)
* [Projects](/rjbs/Email-MIME/projects)
* [Security](/rjbs/Email-MIME/security)
* [Insights](/rjbs/Email-MIME/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frjbs%2FEmail-MIME%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frjbs%2FEmail-MIME%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# DoS on excessive or deeply nested parts #66

Closed

[carnil](/carnil) opened this issue
May 9, 2020
· 7 comments
 · Fixed by [#80](https://github.com/rjbs/Email-MIME/pull/80)

Closed

# [DoS on excessive or deeply nested parts](#top) #66

[carnil](/carnil) opened this issue
May 9, 2020
· 7 comments
 · Fixed by [#80](https://github.com/rjbs/Email-MIME/pull/80)

## Comments

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [May 9, 2020](#issue-615111080)

| Hi,  We have the following bug reported to the Debian package of Email-MIME, c.f. <https://bugs.debian.org/960062>  ------8<-----------8<-----------8<-----------8<-----------8<-----  ``` Package: libemail-mime-perl Version: 1.946-1 Severity: important Tags: upstream  Messages with too many tiny MIME parts can OOM on split().  Messages with many nested MIME parts can also fail on deep recursion (Email::MIME->new calls ->subparts, ->subparts calls ->new, ad infinitum).  Smallish messages can generate these, since the a boundary only needs to be 4 bytes "--a\n" and the header+body of each part can just be 4 bytes "x:y\n\n", too.  Perl takes 42 bytes to represent a 4 byte string on 64-bit:  	use Devel::Size; say Devel::Size::total_size("--\n\n")  This affects many other MIME parsers, too.    ```  ------8<-----------8<-----------8<-----------8<-----------8<-----  Thanks for considering, Salvatore Bonaccorso, Debian Perl Group |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@rjbs](https://avatars.githubusercontent.com/u/30682?s=80&u=2ae5e6cad4a8509b701b0a8678d938d01f3b7339&v=4)](/rjbs)

Copy link

Owner

### **[rjbs](/rjbs)** commented [May 10, 2020](#issuecomment-626260473)

| Thanks, I had received a similar notice a few weeks ago and today set aside a little time to do something. I don't care for the fix that's now in master, but it puts a limit on things. I will make a release of this in the future and, if possible, make more systemic fixes. |
| --- |

All reactions

Sorry, something went wrong.

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

Author

### **[carnil](/carnil)** commented [Aug 25, 2020](#issuecomment-680104546)

| [@rjbs](https://github.com/rjbs) any news on this issue? |
| --- |

All reactions

Sorry, something went wrong.

[![@slyon](https://avatars.githubusercontent.com/u/63956?s=80&u=0b8e85f3191426781099dd3fde61e369f83ed8d9&v=4)](/slyon)

Copy link

### **[slyon](/slyon)** commented [Aug 29, 2023](#issuecomment-1697355089) • edited Loading

| [@rjbs](https://github.com/rjbs) Can you confirm that this got fixed/mitigated in this version?  ```         1.947 2020-05-09 14:30:06-04:00 America/New_York (TRIAL RELEASE)         - add $Email::MIME::MAX_DEPTH and refuse to parse deeper than that many           parts; current default: 10  ```  As an Ubuntu "main" inclusion reviewer, I'm considering this package to enter Ubuntu's "main" component of the archive (5-10 years of support by the Ubuntu team). But this DoS issue could be a blocker for main inclusion. |
| --- |

All reactions

Sorry, something went wrong.

[![@mirespace](https://avatars.githubusercontent.com/u/35487509?s=40&v=4)](/mirespace)
[mirespace](/mirespace)
mentioned this issue
[Dec 12, 2023](#ref-issue-2037727850)

[use MIME::Entity and MIME::Parser from MIME::Tools instead of Email::MIME
msimerson/mail-dmarc#216](/msimerson/mail-dmarc/issues/216)

Closed

[![@eslerm](https://avatars.githubusercontent.com/u/16212934?s=80&u=010b081004465e0194f7df90161433e65ed19f7f&v=4)](/eslerm)

Copy link

### **[eslerm](/eslerm)** commented [Mar 25, 2024](#issuecomment-2019041975) • edited Loading

| [@slyon](https://github.com/slyon) this issue appears to be fixed: [3a12edd](https://github.com/rjbs/Email-MIME/commit/3a12edd119e493156a5a05e45dd50f4e36b702e8) [7e96ecf](https://github.com/rjbs/Email-MIME/commit/7e96ecfa1da44914a407f82ae98ba817bba08f2d) [02bf3e2](https://github.com/rjbs/Email-MIME/commit/02bf3e26812c8f38a86a33c168571f9783365df2)  ``` eslerm@mino:~/code/Email-MIME$ git tag --contains 3a12edd 1.947 1.948 1.949 1.950 1.951 1.952 1.953 3a12edd119e493156a5a05e45dd50f4e36b702e8  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@mpurg](https://avatars.githubusercontent.com/u/2342756?s=80&v=4)](/mpurg)

Copy link

### **[mpurg](/mpurg)** commented [Mar 27, 2024](#issuecomment-2024085120) • edited Loading

| Hi [@rjbs](https://github.com/rjbs)  I believe only part of this issue was resolved, namely, the deeply nested parts. Below is a proof of concept script which creates a ~40MB message with 10M tiny mime parts. On my test system (Ubuntu 23.10), it consumes the entire RAM (4GB) and SWAP (4GB) and is killed by OOM.  ``` use Email::MIME;  $asd = <<EOT; MIME-Version: 1.0 Content-Type: multipart/alternative;     boundary=a  EOT $asd .= "--a\n" x 10000000; $asd .= "a--\n";  my $email = Email::MIME->new($asd); ```  The MIME parser uses around 1GB of RAM per 2MB of email message size. |
| --- |

All reactions

Sorry, something went wrong.

[![@rjbs](https://avatars.githubusercontent.com/u/30682?s=40&u=2ae5e6cad4a8509b701b0a8678d938d01f3b7339&v=4)](/rjbs)
[rjbs](/rjbs)
mentioned this issue
[Apr 23, 2024](#ref-pullrequest-2257679469)

[do not allow an excessive number of parts
#80](/rjbs/Email-MIME/pull/80)
 Merged

[![@rjbs](https://avatars.githubusercontent.com/u/30682?s=80&u=2ae5e6cad4a8509b701b0a8678d938d01f3b7339&v=4)](/rjbs)

Copy link

Owner

### **[rjbs](/rjbs)** commented [Apr 23, 2024](#issuecomment-2072887337)

| The patch in [#80](https://github.com/rjbs/Email-MIME/pull/80) doesn't make me very happy, but solves this problem by dying early. Any thoughts before I ship it? (I'm going to look for a max number that seems safe. 100 was picked arbitrarily.) |
| --- |

 🎉
1
 eslerm reacted with hooray emoji

All reactions

* 🎉
  1 reaction

Sorry, something went wrong.

[![@eslerm](https://avatars.githubusercontent.com/u/16212934?s=80&u=010b081004465e0194f7df90161433e65ed19f7f&v=4)](/eslerm)

Copy link

### **[eslerm](/eslerm)** commented [May 2, 2024](#issuecomment-2091492347)

| The multipart MIME issue described in [#66](https://github.com/rjbs/Email-MIME/issues/66) and [#80](https://github.com/rjbs/Email-MIME/pull/80)) has been assigned [CVE-2024-4140](https://www.cve.org/CVERecord?id=CVE-2024-4140)  The full patch-set will be released in 1.954.  A big thank you to [@rjbs](https://github.com/rjbs) and to everyone who helped resolve this 🎉 |
| --- |

All reactions

Sorry, something went wrong.

[![@rjbs](https://avatars.githubusercontent.com/u/30682?s=40&u=2ae5e6cad4a8509b701b0a8678d938d01f3b7339&v=4)](/rjbs)
[rjbs](/rjbs)
closed this as [completed](/rjbs/Email-MIME/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#80](/rjbs/Email-MIME/pull/80)
[May 2, 2024](#event-12689318426)

[![@briandfoy](https://avatars.githubusercontent.com/u/22255?s=40&v=4)](/briandfoy)
[briandfoy](/briandfoy)
mentioned this issue
[May 3, 2024](#ref-pullrequest-2278007211)

[Add entry for CVE-2024-4140
briandfoy/cpan-security-advisory#153](/briandfoy/cpan-security-advisory/pull/153)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frjbs%2FEmail-MIME%2Fissues%2F66)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [do not allow an excessive number of parts](/rjbs/Email-MIME/pull/80)
 [rjbs/Email-MIME](/rjbs/Email-MIME)

5 participants

[![@rjbs](https://avatars.githubusercontent.com/u/30682?s=52&v=4)](/rjbs) [![@slyon](https://avatars.githubusercontent.com/u/63956?s=52&v=4)](/slyon) [![@carnil](https://avatars.githubusercontent.com/u/773068?s=52&v=4)](/carnil) [![@mpurg](https://avatars.githubusercontent.com/u/2342756?s=52&v=4)](/mpurg) [![@eslerm](https://avatars.githubusercontent.com/u/16212934?s=52&v=4)](/eslerm)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

