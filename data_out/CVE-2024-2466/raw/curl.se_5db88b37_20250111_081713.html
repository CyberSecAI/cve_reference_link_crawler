<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head> <title>curl - TLS certificate check bypass with mbedTLS - CVE-2024-2466</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="/curl.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/logo/curl-symbol.svg" type="image/svg+xml">
<link rel="alternate" type="application/rss+xml" title="cURL Releases" href="https://github.com/curl/curl/releases.atom">
<link rel="stylesheet" type="text/css" href="/manpage.css">
<style>
code {
    padding: 0px 4px 0px 4px;
    background-color: #f0f0f0;
}
 (prefers-color-scheme: dark) {
    code {
        padding: 0px 4px 0px 4px;
        background-color: #101010;
    }
}
</style>
</head>
<body>
<div class="main">
<div class="menu">
<a href="/docs/" class="menuitem" title="Documentation Overview">Docs Overview</a>
<div class="dropdown">
  <a class="dropbtn" href="/docs/projdocs.html">Project</a>
  <div class="dropdown-content">
    <a href="/docs/bugbounty.html">Bug Bounty</a>
    <a href="/docs/bugs.html">Bug Report</a>
    <a href="/docs/code-of-conduct.html">Code of conduct</a>
    <a href="/docs/libs.html">Dependencies</a>
    <a href="/donation.html">Donate</a>
    <a href="/docs/faq.html">FAQ</a>
    <a href="/docs/features.html">Features</a>
    <a href="/docs/governance.html">Governance</a>
    <a href="/docs/history.html">History</a>
    <a href="/docs/install.html">Install</a>
    <a href="/docs/knownbugs.html">Known Bugs</a>
    <a href="/logo/">Logo</a>
    <a href="/docs/todo.html">TODO</a>
    <a href="/about.html">website Info</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/protdocs.html">Protocols</a>
  <div class="dropdown-content">
    <a href="/docs/caextract.html">CA Extract</a>
    <a href="/docs/http-cookies.html">HTTP cookies</a>
    <a href="/docs/http3.html">HTTP/3</a>
    <a href="/docs/mqtt.html">MQTT</a>
    <a href="/docs/sslcerts.html">SSL certs</a>
    <a href="/docs/ssl-compared.html">SSL libs compared</a>
    <a href="/docs/url-syntax.html">URL syntax</a>
    <a href="/docs/websocket.html">WebSocket</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/reldocs.html">Releases</a>
  <div class="dropdown-content">
    <a href="/ch/">Changelog</a>
    <a href="/docs/security.html">curl CVEs</a>
    <a href="/docs/releases.html">Release Table</a>
    <a href="/docs/versions.html">Version Numbering</a>
    <a href="/docs/vulnerabilities.html">Vulnerabilities</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/tooldocs.html">Tool</a>
  <div class="dropdown-content">
    <a href="/docs/comparison-table.html">Comparison Table</a>
    <a href="/docs/manpage.html">curl man page</a>
    <a href="/docs/httpscripting.html">HTTP Scripting</a>
    <a href="/docs/mk-ca-bundle.html">mk-ca-bundle</a>
    <a href="/docs/tutorial.html">Tutorial</a>
    <a href="optionswhen.html">When options were added</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/whodocs.html">Who and Why</a>
  <div class="dropdown-content">
    <a href="/docs/companies.html">Companies</a>
    <a href="/docs/copyright.html">Copyright</a>
    <a href="/sponsors.html">Sponsors</a>
    <a href="/docs/thanks.html">Thanks</a>
    <a href="/docs/thename.html">The name</a>
  </div>
</div>
</div>
<div class="contents">
<div class="where"><a href="/">curl</a> / <a href="/docs/">Docs</a> / <a href="/docs/security.html">curl CVEs</a> / <b>TLS certificate check bypass with mbedTLS</b></div>
<div class="relatedbox">
<b>Related:</b>
<br><a href="audits.html">Audits</a>
<br><a href="/docs/bugbounty.html">Bug Bounty</a>
<br><a href="/ch/">Changelog</a>
<br><a href="security.html">curl CVEs</a>
<br><a href="CVE-2024-2466.json">JSON metadata</a>
<br><a href="https://hackerone.com/reports/2416725">Original report</a>
<br><a href="/dev/vuln-disclosure.html">Vulnerability Disclosure</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<div class="relatedbox">
Awarded 2540 USD<br>
</div>
<h2>CVE-2024-2466</h2>
<h1 id="tls-certificate-check-bypass-with-mbedtls">TLS certificate check
bypass with mbedTLS</h1>
<p>Project curl Security Advisory, March 27th 2024 - <a
href="https://curl.se/docs/CVE-2024-2466.html">Permalink</a></p>
<h2 id="vulnerability">VULNERABILITY</h2>
<p>libcurl did not check the server certificate of TLS connections done
to a host specified as an IP address, when built to use mbedTLS.</p>
<p>libcurl would wrongly avoid using the set hostname function when the
specified hostname was given as an IP address, therefore completely
skipping the certificate check. This affects all uses of TLS protocols
(HTTPS, FTPS, IMAPS, POPS3, SMTPS, etc).</p>
<h2 id="info">INFO</h2>
<p>Since the SNI field is not set when using a hostname set as an IP
address, many requests fail to communicate with the correct endpoint or
get the correct data. Somewhat lessening the possible impact.</p>
<p>Not all versions of mbedTLS supports server certificate checks for IP
addresses, so when this issue is fixed all attempts to connect directly
to an IP address over TLS might fail.</p>
<p>This vulnerability is similar to a past curl vulnerability identified
as CVE-2016-3739.</p>
<p>This flaw also affects the curl command line tool.</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2024-2466 to this issue.</p>
<p>CWE-297: Improper Validation of Certificate with Host Mismatch</p>
<p>Severity: Medium</p>
<h2 id="affected-versions">AFFECTED VERSIONS</h2>
<p>This flaw is relevant for curl and libcurl built to use mbedTLS.</p>
<ul>
<li>Affected versions: curl <a href="vuln-8.5.0.html">8.5.0</a> to and including <a href="vuln-8.6.0.html">8.6.0</a></li>
<li>Not affected versions: curl &lt; <a href="vuln-8.5.0.html">8.5.0</a> and &gt;= <a href="vuln-8.7.0.html">8.7.0</a></li>
<li>Introduced-in: <a
href="https://github.com/curl/curl/commit/fa714830e92cba7b16b9d3f">https://github.com/curl/curl/commit/fa714830e92cba7b16b9d3f</a></li>
</ul>
<p>libcurl is used by many applications, but not always advertised as
such!</p>
<h2 id="solution">SOLUTION</h2>
<ul>
<li>Fixed-in: <a
href="https://github.com/curl/curl/commit/3d0fd382a29b95561b90b7ea3e7e">https://github.com/curl/curl/commit/3d0fd382a29b95561b90b7ea3e7e</a></li>
</ul>
<h2 id="recommendations">RECOMMENDATIONS</h2>
<p>We suggest you take one of the following actions immediately, in
order of preference:</p>
<p>A - Upgrade curl and libcurl to version <a href="vuln-8.7.0.html">8.7.0</a></p>
<p>B - Apply the patch to your version and rebuild</p>
<p>C - Build your libcurl with another TLS backend</p>
<h2 id="timeline">TIMELINE</h2>
<p>This issue was reported to the curl project on March 14, 2024. We
contacted distros@openwall on March 19, 2024.</p>
<p>curl <a href="vuln-8.7.0.html">8.7.0</a> was released on March 27 2024 around 07:00 UTC,
coordinated with the publication of this advisory.</p>
<h2 id="credits">CREDITS</h2>
<ul>
<li>Reported-by: Frank Yueh</li>
<li>Patched-by: Stefan Eissing</li>
</ul>
<p>Thanks a lot!</p>
</div>
</div>
</body> </html>
