

* [Skip to content](#fw-content)
* Skip to search
* [Skip to footer](#fw-footer-v2)

* [Cisco.com Worldwide](https://www.cisco.com/site/us/en/index.html)
* [Products and Services](/c/en/us/products/index.html)
* [Solutions](https://www.cisco.com/site/us/en/solutions/index.html)
* [Support](/c/en/us/support/index.html)
* [Learn](/c/en/us/training-events.html)
* [Explore Cisco](//www.cisco.com/c/en/us/about/sitemap.html)
* [How to Buy](/c/en/us/buy.html)
* [Partners Home](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)
* [Partner Program](https://www.cisco.com/site/us/en/partners/cisco-partner-program/index.html?ccid=cc000864&dtid=odiprc001129)
* [Support](https://www.cisco.com/site/us/en/partners/support-help/index.html)
* [Tools](https://www.cisco.com/site/us/en/partners/tools/index.html?dtid=odiprc001129)
* [Find a Cisco Partner](https://locatr.cloudapps.cisco.com/WWChannels/LOCATR/pf/index.jsp#/)
* [Meet our Partners](https://www.cisco.com/site/us/en/partners/connect-with-a-partner/index.html?ccid=cc000864&dtid=odiprc001129)
* [Become a Cisco Partner](https://www.cisco.com/site/us/en/partners/index.html?dtid=odicdc001129)

* [Home](/c/en/us/index.html)
* [Support](/c/en/us/support/index.html)
* [Product Support](/c/en/us/support/all-products.html)
* [Switches](/c/en/us/support/switches/category.html)
* [Cisco Nexus 9000 Series Switches](/c/en/us/support/switches/nexus-9000-series-switches/series.html)
* [Programming Guides](/c/en/us/support/switches/nexus-9000-series-switches/products-programming-reference-guides-list.html)
# Cisco Nexus 9000 Series NX-OS Programmability Guide, Release 10.5(x)

Bias-Free Language

### Bias-Free Language

The documentation set for this product strives to use bias-free language. For the purposes of this documentation set, bias-free is defined as language that does not imply discrimination based on age, disability, gender, racial identity, ethnic identity, sexual orientation, socioeconomic status, and intersectionality. Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product. [Learn more](https://www.cisco.com/c/en/us/about/social-justice/inclusive-language-policy.html) about how Cisco is using Inclusive Language.

Book Contents

Book Contents

* [New and Changed Information](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-new-and-changed-information-105x.html)
* [Platform Support for Programmability Features](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-supported-platforms-programmability.html)
* [Overview](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-overview-101x.html)
* Shells and Scripting
  + [Shells and Scripting](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-bash-101x.html)
  + [Guest Shell](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-guest-shell-101x.html)
  + [Broadcom Shell](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-broadcom-shell-101x.html)
  + [Barefoot Shell](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-barefoot-shell-101x.html)
  + [Python API](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-python-api-101x.html)
  + [Scripting with Tcl](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-scripting-tcl-101x.html)
  + [iPXE](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-ipxe-101x.html)
  + [Kernel Stack](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-kernel-stack-101x.html)
* Applications
  + [Third-Party Applications](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-third-party-applications-101x.html)
  + [Using Ansible with Cisco NX-OS](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-ansible-101x.html)
  + [Puppet Agent](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-puppet-agent-101x.html)
  + [Using Chef Client with Cisco NX-OS](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-using-chef-client-with-cisco-nx-os-101x.html)
  + [Nexus Application Development - Yocto](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-nexus-application-development-yocto-10x.html)
  + [Nexus Application Development - SDK](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-nexus-application-development-sdk-101x.html)
  + [NX-SDK](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-nx-sdk-101x.html)
  + [Using Docker with Cisco NX-OS](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-using-docker-with-cisco-nx-os-101x.html)
* Application Hosting
  + [Application Hosting](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-application-hosting.html)
  + [ThousandEyes Enterprise Agent](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-te.html)
* NX-API
  + [NX-API CLI](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-nx-api-cli-101x.html)
  + [NX-API REST](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-nx-api-rest-101x.html)
  + [NX-API Developer Sandbox](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-nx-api-developer-sandbox-101x.html)
* Model-Driven Programmability
  + [Overview](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/chapter-1.html)
  + [Original and OpenConfig YANG](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-yang.html)
  + [NETCONF Agent](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-netconf-agent.html)
  + [RESTCONF Agent](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/chapter-2.html)
  + [gRPC Agent](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-grpc-agent.html)
  + [gNMI - Management Interface](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-gnmi.html)
  + [gNOI - Operation Interface](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/gnoi---operation-interface.html)
  + [gRPC Tunnel](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-grpc-tunnel.html)
  + [Telemetry](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/chapter-3.html)
  + [Diagnosis and Serviceability](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-diagnosis-and-serviceability.html)
* XML Management Interface
  + [XML Management Interface](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-xml-management-interface-101x.html)
* [Streaming Telemetry Sources](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-streaming-telemetry-sources-101x.html)
* [Websocket Subscription](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-websocket-subscription-101x.html)
* [Programmability RFCs](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-programmability-rfcs-101x.html)
* [Index](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/cisco-nexus-9000-series-nx-os-programmability-guide-105x_index.html)

Search

Find Matches in This Book

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

Save

[Log in](/c/login/index.html?referer=/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-python-api-101x.html) to Save Content

Available Languages

Download

Download Options

### Book Title Cisco Nexus 9000 Series NX-OS Programmability Guide, Release 10.5(x) Chapter Title Python API

* [PDF - Complete Book
  (6.78 MB)](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x.pdf)
  [PDF - This Chapter (1.1 MB)](/c/en/us/td/docs/dcn/nx-os/nexus9000/105x/programmability/cisco-nexus-9000-series-nx-os-programmability-guide-105x/m-n9k-python-api-101x.pdf)

  View with Adobe Reader on a variety of devices

Print

![Clear Contents of Search](/etc/designs/cdc/fw/i/ic_clear_gray.png)

## Results

Updated: November 27, 2024

## Chapter: Python API

Chapter Contents

* [Python API](#Cisco_Generic_Topic.dita_35f06d22-474e-4a76-af28-73581a284741)
* [Using Python](#topic_5AF10C22001644AE8583D89A68FE38FB)
  + [Cisco Python Package](#concept_8A4F5751B22D45008B089E73CF491956)
  + [Using the CLI Command APIs](#concept_6414B967674E46A5B13EC9CF61C88880)
  + [Invoking the Python Interpreter from the CLI](#concept_17DAEF691C7B4A069BCDC43B241962A0)
  + [Display Formats](#concept_625FA2B8E7ED4F3C949A84E09A4CB974)
  + [Non-Interactive Python](#concept_0E0DA3A80E734516B50AD6901F0142D8)
  + [Running Scripts with Embedded Event Manager](#concept_3B13FE65D40D4251BAE1AE074A0539C2)
  + [Python Integration with Cisco NX-OS Network Interfaces](#concept_AC41A84BC6DE41B68660AC91DE0EC047)
  + [Cisco NX-OS Security with Python](#concept_A2CFF094ADCB414C983EA06AD8E9A410)
    - [Examples of Security and User Authority](#concept_BC6D75F431E248E7948818C8A5CE7EF0)
    - [Example of Running Script with Scheduler](#concept_9AEE2791EDBB46F88E216CD46EC95C33)

Close

# Python API

* [Using Python](#topic_5AF10C22001644AE8583D89A68FE38FB)

## Using Python

This section
describes how to write and execute Python scripts.

* [Cisco Python Package](#concept_8A4F5751B22D45008B089E73CF491956)
* [Using the CLI Command APIs](#concept_6414B967674E46A5B13EC9CF61C88880)
* [Invoking the Python Interpreter from the CLI](#concept_17DAEF691C7B4A069BCDC43B241962A0)
* [Display Formats](#concept_625FA2B8E7ED4F3C949A84E09A4CB974)
* [Non-Interactive Python](#concept_0E0DA3A80E734516B50AD6901F0142D8)
* [Running Scripts with Embedded Event Manager](#concept_3B13FE65D40D4251BAE1AE074A0539C2)
* [Python Integration with Cisco NX-OS Network Interfaces](#concept_AC41A84BC6DE41B68660AC91DE0EC047)
* [Cisco NX-OS Security with Python](#concept_A2CFF094ADCB414C983EA06AD8E9A410)

### Cisco Python Package

Cisco NX-OS provides a Cisco Python package that enables access to many core network-device modules, such as interfaces, VLANs,
VRFs, ACLs, and routes. You can display the details of the Cisco Python package by entering the help()  command. To obtain additional information about the classes and methods in a module, you can run the help command for a specific
module. For example, help(cisco.interface)  displays the properties of the cisco.interface module.

For more Python modules, you can install the python-modules-nxos RPM (python-modules-nxos-1.0.0-9.2.1.lib32\_x86.rpm) from <https://devhub.cisco.com/artifactory/open-nxos/9.2.1/x86_64/>. Refer to the "Manage Feature RPMs" section for instructions on installing an RPM.

The following is an example of how to display information about the Cisco Python package:

```
>>> import cisco
>>> help(cisco)
Help on package cisco:

NAME
    cisco

FILE
    /isan/python/scripts/cisco/__init__.py

PACKAGE CONTENTS
    acl
    bgp
    cisco_secret
    cisco_socket
    feature
    interface
    key
    line_parser
    md5sum
    nxcli
    ospf
    routemap
    routes
    section_parser
    ssh
    system
    tacacs
    vrf

CLASSES
     __builtin__.object
        cisco.cisco_secret.CiscoSecret
        cisco.interface.Interface
        cisco.key.Key

```

The following is an example of how to display information about the Cisco Python Package for Python 3:

```
switch# python3
Python 3.7.3 (default, Nov 20 2019, 14:38:01)
[GCC 5.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import cisco
>>> help(cisco)
Help on package cisco:

NAME
cisco

PACKAGE CONTENTS
acl
bgp
buffer_depth_monitor
check_port_discards
cisco_secret
feature
historys
interface
ipaddress
key
line_parser
mac_address_table
md5sum
nxcli
nxos_cli
ospf
routemap
routes
section_parser
ssh
system
tacacs
transfer
vlan
vrf

CLASSES
builtins.dict(builtins.object)
cisco.history.History
builtins.object
cisco.cisco_secret.CiscoSecret
cisco.interface.Interface
cisco.key.Key
```

### Using the CLI Command APIs

The Python
programming language uses three APIs that can execute CLI commands. The APIs
are available from the Python CLI module.

These APIs are listed in the following table. You must enable the APIs with the from cli import
\*  command. The arguments for these APIs are strings of CLI commands. To execute a CLI command through the Python interpreter,
you enter the CLI command as an argument string of one of the following APIs:

Table 1. CLI Command
APIs

| **API** | **Description** |
| --- | --- |
| cli() Example:  ``` string = cli (“cli-command”) ``` | Returns the raw output of CLI commands, including control or special characters.   | **Note** | The interactive Python interpreter prints control or special characters 'escaped'. A carriage return is printed as '\n' and gives results that can be difficult to read. The clip() API gives results that are more readable. | | --- | --- | |
| clid() Example:  ``` json_string = clid (“cli-command”)  ``` | Returns JSON output for cli-command, if XML support exists for the command, otherwise an exception is thrown.   | **Note** | This API can be useful when searching the output of show commands. | | --- | --- | |
| clip() Example:  ``` clip (“cli-command”) ``` | Prints the output of the CLI command directly to stdout and returns nothing to Python.   | **Note** | ``` clip (“cli-command”) ``` is equivalent to ``` r=cli(“cli-command”) print r ``` | | --- | --- | |

When two or more
commands are run individually, the state is not persistent from one command to
subsequent commands.

In the following
example, the second command fails because the state from the first command does
not persist for the second command:

```
>>> cli("conf t")
>>> cli("interface eth4/1")

```

When two or more
commands are run together, the state is persistent from one command to
subsequent commands.

In the following
example, the second command is successful because the state persists for the
second and third commands:

```
>>> cli("conf t ; interface eth4/1 ; shut")
```

| **Note** | ---   Commands are separated with " ; " as shown in the example. The semicolon ( ; ) must be surrounded with single blank characters.   --- |
| --- | --- |

### Invoking the Python Interpreter from the CLI

The following example shows how to invoke Python 2 from the CLI:

| **Note** | ---   The Python interpreter is designated with the ">>>" or "…" prompt.   --- |
| --- | --- |

| **Important** | ---   Python 2.7 is End of Support, Future NX-OS software deprecates Python 2.7 support. We recommend for new scripts to use python3 ' instead. Type python3  to use the new shell.   --- |
| --- | --- |

The following example shows how to invoke Python 3 from the CLI:

```
switch# python3
Python 3.7.3 (default, Nov 20 2019, 14:38:01)
[GCC 5.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>>
>>> from cli import *
>>> import json
>>> cli('configure terminal ; interface loopback 1 ; no shut')
''
>>> intflist=json.loads(clid('show interface brief'))
>>> i=0
>>> while i < len(intflist['TABLE_interface']['ROW_interface']):
...     intf=intflist['TABLE_interface']['ROW_interface'][i]
...     i=i+1
...     if intf['state'] == 'up':
...         print(intf['interface'])
...
mgmt0
loopback1
>>>

```

### Display Formats

The following
examples show various display formats using the Python APIs:

Example 1:

```
>>> from cli import *
>>> cli("conf ; interface loopback 1")
''
>>> clip('where detail')
  mode:
  username:            admin
  vdc:                 switch
  routing-context vrf: default

```

Example 2:

```
>>> from cli import *
>>> cli("conf ; interface loopback 1")
''
>>> cli('where detail')
'  mode:                \n  username:            admin\n  vdc:
 switch\n  routing-context vrf: default\n'
>>>

```

Example 3:

```
>>> r = cli('where detail')
>>> print(r)
mode:
username: admin
vdc: switch
routing-context vrf: default

>>>

```

Example 4:

```
>>> from cli import *
>>> import json
>>> out=json.loads(clid('show version'))
>>> for k in out.keys():
... print("%30s - %s" % (k,out[k]))
...
header_str - Cisco Nexus Operating System (NX-OS) Software
TAC support: http://www.cisco.com/tac
Copyright (C) 2002-2020, Cisco and/or its affiliates.
All rights reserved.
The copyrights to certain works contained in this software are
owned by other third parties and used and distributed under their own
licenses, such as open source. This software is provided "as is," and unless
otherwise stated, there is no warranty, express or implied, including but not
limited to warranties of merchantability and fitness for a particular purpose.
Certain components of this software are licensed under
the GNU General Public License (GPL) version 2.0 or
GNU General Public License (GPL) version 3.0 or the GNU
Lesser General Public License (LGPL) Version 2.1 or
Lesser General Public License (LGPL) Version 2.0.
A copy of each such license is available at
http://www.opensource.org/licenses/gpl-2.0.php and
http://opensource.org/licenses/gpl-3.0.html and
http://www.opensource.org/licenses/lgpl-2.1.php and
http://www.gnu.org/licenses/old-licenses/library.txt.
bios_ver_str - 07.67
kickstart_ver_str - 9.3(5) [build 9.3(4)IIL9(0.879)]
nxos_ver_str - 9.3(5) [build 9.3(4)IIL9(0.879)]
bios_cmpl_time - 01/29/2020
kick_file_name - bootflash:///nxos.9.3.4.IIL9.0.879.bin
nxos_file_name - bootflash:///nxos.9.3.4.IIL9.0.879.bin
kick_cmpl_time - 5/10/2020 21:00:00
nxos_cmpl_time - 5/10/2020 21:00:00
kick_tmstmp - 05/12/2020 07:08:44
nxos_tmstmp - 05/12/2020 07:08:44
chassis_id - Nexus9000 93180YC-EX chassis
cpu_name - Intel(R) Xeon(R) CPU @ 1.80GHz
memory - 24632252
mem_type - kB
proc_board_id - FDO22280FFK
host_name - switch
bootflash_size - 53298520
kern_uptm_days - 0
kern_uptm_hrs - 0
kern_uptm_mins - 19
kern_uptm_secs - 34
rr_usecs - 641967
rr_ctime - Tue May 12 09:52:28 2020
rr_reason - Reset Requested by CLI command reload
rr_sys_ver - 9.4(1)
rr_service - None
plugins - Core Plugin, Ethernet Plugin
manufacturer - Cisco Systems, Inc.
>>>

```

### Non-Interactive Python

A Python script can run in non-interactive mode by providing the Python script name as an argument to the Python CLI command.
Python scripts must be placed under the bootflash or volatile scheme. A maximum of 32 command-line arguments for the Python
script are allowed with the Python CLI command.

The switch also supports the source CLI command for running Python scripts. The bootflash:scripts directory is the default script directory for the source CLI command.

This example shows the script first and then executing it. Saving is like bringing any file to the bootflash.

```
switch# show file bootflash:scripts/deltaCounters.py
#!/isan/bin/python3
from cli import *
import sys, time
ifName = sys.argv[1]
delay = float(sys.argv[2])
count = int(sys.argv[3])
cmd = 'show interface ' + ifName + ' counters'
out = json.loads(clid(cmd))
rxuc = int(out['TABLE_rx_counters']['ROW_rx_counters'][0]['eth_inucast'])
rxmc = int(out['TABLE_rx_counters']['ROW_rx_counters'][1]['eth_inmcast'])
rxbc = int(out['TABLE_rx_counters']['ROW_rx_counters'][1]['eth_inbcast'])
txuc = int(out['TABLE_tx_counters']['ROW_tx_counters'][0]['eth_outucast'])
txmc = int(out['TABLE_tx_counters']['ROW_tx_counters'][1]['eth_outmcast'])
txbc = int(out['TABLE_tx_counters']['ROW_tx_counters'][1]['eth_outbcast'])
print ('row rx_ucast rx_mcast rx_bcast tx_ucast tx_mcast tx_bcast')
print ('=========================================================')
print (' %8d %8d %8d %8d %8d %8d' % (rxuc, rxmc, rxbc, txuc, txmc, txbc))
print ('=========================================================')
i = 0
while (i < count):
    time.sleep(delay)
    out = json.loads(clid(cmd))
    rxucNew = int(out['TABLE_rx_counters']['ROW_rx_counters'][0]['eth_inucast'])
    rxmcNew = int(out['TABLE_rx_counters']['ROW_rx_counters'][1]['eth_inmcast'])
    rxbcNew = int(out['TABLE_rx_counters']['ROW_rx_counters'][1]['eth_inbcast'])
    txucNew = int(out['TABLE_tx_counters']['ROW_tx_counters'][0]['eth_outucast'])
    txmcNew = int(out['TABLE_tx_counters']['ROW_tx_counters'][1]['eth_outmcast'])
    txbcNew = int(out['TABLE_tx_counters']['ROW_tx_counters'][1]['eth_outbcast'])
    i += 1
    print ('%-3d %8d %8d %8d %8d %8d %8d' % (i, rxucNew - rxuc, rxmcNew - rxmc, rxbcNew - rxbc, txucNew - txuc, txmcNew - txmc, txbcNew - txbc))
```
```
switch# python bootflash:scripts/deltaCounters.py mgmt0 1 5
row rx_ucast rx_mcast rx_bcast tx_ucast tx_mcast tx_bcast
=========================================================
      291     8233     1767      185       57        2
=========================================================
1          1        4        1        1        0        0
2          2        5        1        2        0        0
3          3        9        1        3        0        0
4          4       12        1        4        0        0
5          5       17        1        5        0        0
switch#

```

The following example shows how a source command specifies command-line arguments. In the example, policy-map  is an argument to the `cgrep python` script. The example also shows that a source command can follow the pipe operator ("|").

```
switch# show running-config | source sys/cgrep policy-map

policy-map type network-qos nw-pfc
policy-map type network-qos no-drop-2
policy-map type network-qos wred-policy
policy-map type network-qos pause-policy
policy-map type qos foo
policy-map type qos classify
policy-map type qos cos-based
policy-map type qos no-drop-2
policy-map type qos pfc-tor-port

```

### Running Scripts with Embedded Event Manager

On Cisco Nexus switches, Embedded Event Manager (EEM) policies support Python scripts.

The following example
shows how to run a Python script as an EEM action:

* An EEM applet can include a Python script with an action command.
  ```
  switch# show running-config eem

  !Command: show running-config eem
  !Running configuration last done at: Thu Jun 25 15:29:38 2020
  !Time: Thu Jun 25 15:33:19 2020

  version 9.3(5) Bios:version 07.67
  event manager applet a1
    event cli match "show clock"
    action 1 cli python bootflash:pydate.py

  switch# show file logflash:vdc_1/event_archive_1 | last 33

  eem_event_time:06/25/2020,15:34:24 event_type:cli event_id:24 slot:active(1) vdc
  :1 severity:minor applets:a1
  eem_param_info:command = "exshow clock"
  Starting with policy a1
  stty: standard input: Inappropriate ioctl for device
  Executing the following commands succeeded:
            python bootflash:pydate.py
  Completed executing policy a1
  Event Id:24 event type:10241 handling completed

  ```
* You can search for the action that is triggered by the event in the log file by running the show file
  logflash:event\_archive\_1  command.
  ```
  switch# show file logflash:event_archive_1 | last 33

  eem_event_time:05/01/2011,19:40:28 event_type:cli event_id:8 slot:active(1)
  vdc:1 severity:minor applets:a1
  eem_param_info:command = "exshow clock"
  Starting with policy a1
  Python

  2011-05-01 19:40:28.644891
  Executing the following commands succeeded:
            python bootflash:pydate.py

  PC_VSH_CMD_TLV(7679) with q

  ```

### Python Integration with Cisco NX-OS Network Interfaces

On Cisco Nexus switches, Python is integrated with the underlying Cisco NX-OS network interfaces. You can switch from one
virtual routing context to another by setting up a context through the cisco.vrf.set\_global\_vrf() API.

The following example shows how to retrieve an HTML document over the management interface of a device. You can also establish
a connection to an external entity over the in-band interface by switching to a desired virtual routing context.

```
switch# python

Warning: Python 2.7 is End of Support, and future NXOS software will deprecate
python 2.7 support. It is recommended for new scripts to use 'python3' instead.
Type "python3" to use the new shell.

Python 2.7.11 (default, Jun  4 2020, 09:48:24)
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import urllib2
>>> from cisco.vrf import *
>>> set_global_vrf('management')
>>> page=urllib2.urlopen('http://172.23.40.211:8000/welcome.html')
>>> print page.read()
Hello Cisco Nexus 9000
>>>
>>> import cisco
>>> help(cisco.vrf.set_global_vrf)
Help on function set global vrf in module cisco.vrf:
set global vrf(vrf)
Sets the global vrf. Any new sockets that are created (using socket.socket)
will automatically get set to this vrf (including sockets used by other
python libraries).
Arguments:
vrf: VRF name (string) or the VRF ID (int).
Returns: Nothing
>>>
```

### Cisco NX-OS Security with Python

Cisco NX-OS resources
are protected by the Cisco NX-OS Sandbox layer of software and by the CLI
role-based access control (RBAC).

All users who are associated with a Cisco NX-OS network-admin or dev-ops role are privileged users. Users who are granted
access to Python with a custom role are regarded as nonprivileged users. Nonprivileged users have limited access to Cisco
NX-OS resources, such as the file system, guest shell, and Bash commands. Privileged users have greater access to all the
resources of Cisco NX-OS.

* [Examples of Security and User Authority](#concept_BC6D75F431E248E7948818C8A5CE7EF0)
* [Example of Running Script with Scheduler](#concept_9AEE2791EDBB46F88E216CD46EC95C33)

#### Examples of Security and User Authority

The following example
shows how a privileged user runs commands:

Python 3 example.

```
switch# python3
Python 3.7.3 (default, Nov 20 2019, 14:38:01)
[GCC 5.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.system('whoami')
admin
0
>>> f=open('/tmp/test','w')
>>> f.write('hello from python')
17
>>> f.close()
>>> r=open('/tmp/test','r')
>>> print(r.read())
hello from python
>>> r.close()
>>>

```

The following example shows a nonprivileged user being denied access:

```
switch# python3
Python 3.7.3 (default, Nov 20 2019, 14:38:01)
[GCC 5.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.system('whoami')
system(whoami): rejected!
-1
>>> f=open('/tmp/test','w')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
PermissionError: [Errno 13] Permission denied: '/tmp/test'
>>>

```

RBAC controls CLI
access based on the login user privileges. A login user's identity is given to
Python that is invoked from the CLI shell or from Bash. Python passes the login
user's identity to any subprocess that is invoked from Python.

The following is an
example for a privileged user:

```
>>> from cli import *
>>> cli('show clock')
'Warning: No NTP peer/server configured. Time may be out of sync.\n15:39:39.513 UTC Thu Jun 25 2020\nTime source is NTP\n'
>>> cli('configure terminal ; vrf context myvrf')
''
>>> clip('show running-config l3vm')

!Command: show running-config l3vm
!Running configuration last done at: Thu Jun 25 15:39:49 2020
!Time: Thu Jun 25 15:39:55 2020

version 9.3(5) Bios:version 07.67

interface mgmt0
  vrf member management
vrf context blue
vrf context management
vrf context myvrf

```

The following is an example for a nonprivileged user:

```
>>> from cli import *
>>> cli('show clock')
'11:18:47.482 AM UTC Sun May 08 2011\n'
>>> cli('configure terminal ; vrf context myvrf2')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/isan/python/scripts/cli.py", line 20, in cli
    raise cmd_exec_error(msg)
errors.cmd_exec_error: '% Permission denied for the role\n\nCmd exec error.\n'

```

The following example
shows an RBAC configuration:

```
switch# show user-account
user:admin
        this user account has no expiry date
        roles:network-admin
user:pyuser
        this user account has no expiry date
        roles:network-operator python-role
switch# show role name python-role

```

#### Example of Running Script with Scheduler

The following example
shows a Python script that is running the script with the scheduler feature:

```
#!/bin/env python
from cli import *
from nxos import *
import os

switchname = cli("show switchname")
try:
    user = os.environ['USER']
except:
    user = "No user"
    pass

msg = user + " ran " + __file__ + " on : " + switchname
print msg
py_syslog(1, msg)
# Save this script in bootflash:///scripts

```

Python 3 example.

```
#!/bin/env python3
from cli import *
from nxos import *
import os

switchname = cli("show switchname")
try:
    user = os.environ['USER']
except:
    user = "No user"
    pass

msg = user + " ran " + __file__ + " on : " + switchname
print(msg)
py_syslog(1, msg)

# Save this script in bootflash:///scripts

switch# conf t
Enter configuration commands, one per line. End with CNTL/Z.
switch(config)# feature scheduler
switch(config)# scheduler job name testplan
switch(config-job)# python bootflash:///scripts/test.py
switch(config-job)# exit
switch(config)# scheduler schedule name testplan
switch(config-schedule)# job name testplan
switch(config-schedule)# time start now repeat 0:0:4
Schedule starts from Sat Jun 13 04:29:38 2020
switch# 2020 Jun 13 04:29:41 switch %USER-1-SYSTEM_MSG: No user ran /bootflash/scripts/test.py on : switch - nxpython
switch# show scheduler schedule
Schedule Name : testplan
------------------------------
User Name : admin
Schedule Type : Run every 0 Days 0 Hrs 4 Mins
Start Time : Sat Jun 13 04:29:38 2020
Last Execution Time : Sat Jun 13 04:29:38 2020
Last Completion Time: Sat Jun 13 04:29:41 2020
Execution count : 1
-----------------------------------------------
Job Name Last Execution Status
-----------------------------------------------
testplan Success (0)
==============================================================================
switch#

```
```
switch# conf t
Enter configuration commands, one per line.  End with CNTL/Z.
switch(config)# feature scheduler
switch(config)# scheduler job name testplan
switch(config-job)# python bootflash:///scripts/testplan.py
switch(config-job)# exit
switch(config)# scheduler schedule name testplan
switch(config-schedule)# job name testplan
switch(config-schedule)# time start now repeat 0:0:4
Schedule starts from Mon Mar 14 16:40:03 2011
switch(config-schedule)# end
switch# term mon
2011 Mar 14 16:38:03 switch %VSHD-5-VSHD_SYSLOG_CONFIG_I: Configured from vty by admin on 10.19.68.246@pts/2
switch# show scheduler schedule
Schedule Name       : testplan
------------------------------
User Name           : admin
Schedule Type       : Run every 0 Days 0 Hrs 4 Mins
Start Time          : Mon Mar 14 16:40:03 2011
Last Execution Time : Yet to be executed
-----------------------------------------------
     Job Name            Last Execution Status
-----------------------------------------------
    testplan                              -NA-
==============================================================================
switch#
switch# 2011 Mar 14 16:40:04 switch  %USER-1-SYSTEM_MSG: No user ran /bootflash/scripts/testplan.py on : switch   - nxpython
2011 Mar 14 16:44:04 switch last message repeated 1 time
switch#

```

### Was this Document Helpful?

Yes
No

![Feedback](//www.cisco.com/c/dam/cdc/i/Feedback_OceanBlue.png "Feedback")Feedback

### Contact Cisco

* [Open a Support Case](https://mycase.cloudapps.cisco.com/start?prodDocUrl=)![login required](/etc/designs/cdc/fw/i/icon_lock_small.png)
* (Requires a [Cisco Service Contract](//www.cisco.com/c/en/us/services/order-services.html))

![](//cisco.112.2o7.net/b/ss/cisco-mobile/5/12345)
