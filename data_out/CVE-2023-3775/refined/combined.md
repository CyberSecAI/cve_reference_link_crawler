=== Content from discuss.hashicorp.com_a15fb831_20250110_142610.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-29 - Vault Enterprise’s Sentinel RGP Policies Allowed For Cross-Namespace Denial of Service](/t/hcsec-2023-29-vault-enterprise-s-sentinel-rgp-policies-allowed-for-cross-namespace-denial-of-service/58653)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

September 28, 2023, 11:08pm

1

**Bulletin ID:** HCSEC-2023-29

**Affected Products / Versions:** Vault Enterprise since 0.11.0; fixed in 1.15.0, 1.14.4, and 1.13.8.

**Publication Date:** September 28, 2023

**Summary**

A Vault Enterprise Sentinel Role Governing Policy created by an operator to restrict access to resources in one namespace can be applied to requests outside in another non-descendant namespace, potentially resulting in denial of service. This vulnerability, CVE-2023-3775, is fixed in Vault Enterprise 1.15.0, 1.14.4, and 1.13.8.

**Background**

[Namespaces](https://developer.hashicorp.com/vault/docs/enterprise/namespaces) are self-managed isolated environments within Vault, isolating data such as secret engines, auth methods, and policies from other namespaces. Namespaces can contain other (child) namespaces, where policies and identities can be shared through the parent/child relationship.

[Sentinel in Vault Enterprise](https://docs.hashicorp.com/sentinel/vault) augments Vault’s built-in ACL policy system by providing Role Governing Policies (tied to entities or groups) and Endpoint Governing Policies (tied to paths). Sentinel policies are [evaluated and enforced](https://developer.hashicorp.com/vault/docs/enterprise/sentinel#policy-evaluation) by Vault, allowing operators to more granularly define when to grant access to certain resources.

**Details**

An external party reported that it was possible for a Role Governing Policy (RGP) of one namespace to be used to restrict resources in another, non-child namespace. This issue only affects RGPs. Sentinel Endpoint Governing Policies (EGPs) or Vault’s ACLs are not affected.

Sentinel RGP’s can be set by users authorized to write to the `/sys/policies/rgp` endpoint. These policies can be used to restrict or deny access to resources, but cannot grant additional access. As a result, this vulnerability is limited to denial of service.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault Enterprise 1.15.0, 1.14.4, 1.13.8, or newer. Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by Marc Billow of Indeed who reported it to HashiCorp.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2020-24 - Vault Enterprise’s Sentinel EGP Policies May Impact Parent or Sibling Namespaces](https://discuss.hashicorp.com/t/hcsec-2020-24-vault-enterprise-s-sentinel-egp-policies-may-impact-parent-or-sibling-namespaces/18983)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7272 | December 16, 2020 |
| [HCSEC-2023-23 - Vault Enterprise Namespace Creation May Lead to Denial of Service](https://discuss.hashicorp.com/t/hcsec-2023-23-vault-enterprise-namespace-creation-may-lead-to-denial-of-service/56617)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7927 | July 28, 2023 |
| [HCSEC-2020-07 - Vault Enterprise Prefixed Mount Policies May Result In Unauthorized Namespace Access](https://discuss.hashicorp.com/t/hcsec-2020-07-vault-enterprise-prefixed-mount-policies-may-result-in-unauthorized-namespace-access/18090)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4117 | November 25, 2020 |
| [HCSEC-2020-03 - Vault Enterprise’s Dynamic Secrets May Persist After Namespace Deletion](https://discuss.hashicorp.com/t/hcsec-2020-03-vault-enterprise-s-dynamic-secrets-may-persist-after-namespace-deletion/18086)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4210 | November 25, 2020 |
| [HCSEC-2024-21 - Vault Operators in Root Namespace May Elevate Their Privileges](https://discuss.hashicorp.com/t/hcsec-2024-21-vault-operators-in-root-namespace-may-elevate-their-privileges/70565)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 2373 | October 10, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


