=== Content from metacpan.org_db3debbd_20250111_150648.html ===


* [About](/about)
* [Sponsor](/about/sponsors)
* [grep::cpan](https://grep.metacpan.org/)
* [Recent](/recent)
* [FAQ](/about/faq)
* [Tools](/tools)
* [API](https://fastapi.metacpan.org/)

* + [Identities](/account/identities)
  + [Profile](/account/profile)
  + [Favorites](/account/favorite/list)
  + Logout
* + [GitHub](/login/github)
  + [Twitter](/login/twitter)
  + [Google](/login/google)

* 04 Apr 2021 21:03:12 UTC
* Distribution: [Net-CIDR-Lite](/dist/Net-CIDR-Lite)
* Module version: 0.22
* [Source](/dist/Net-CIDR-Lite/source/Lite.pm)
  ([raw](/dist/Net-CIDR-Lite/source/Lite.pm?raw=1))
* [Browse](/dist/Net-CIDR-Lite/source)
  ([raw](/dist/Net-CIDR-Lite/source?raw=1))
* [Changes](/dist/Net-CIDR-Lite/changes)
* [How to Contribute](/dist/Net-CIDR-Lite/contribute)
* [Issues](https://rt.cpan.org/Public/Dist/Display.html?Name=Net-CIDR-Lite)
  (4)
* [Testers](http://matrix.cpantesters.org/?dist=Net-CIDR-Lite+0.22 "Matrix")
  ([1839](https://www.cpantesters.org/distro/N/Net-CIDR-Lite.html?oncpan=1&distmat=1&version=0.22&grade=2) / [0](https://www.cpantesters.org/distro/N/Net-CIDR-Lite.html?oncpan=1&distmat=1&version=0.22&grade=3) / [0](https://www.cpantesters.org/distro/N/Net-CIDR-Lite.html?oncpan=1&distmat=1&version=0.22&grade=4))
* [Kwalitee](http://cpants.cpanauthors.org/release/STIGTSP/Net-CIDR-Lite-0.22)
* Bus factor: 0
* [85.20% Coverage](http://cpancover.com/latest/Net-CIDR-Lite-0.22/index.html)
* License: unknown
* Activity
* ![](/dist/Net-CIDR-Lite/activity.svg?res=month)
  24 month
* Tools
* [Download (10.57KB)](https://cpan.metacpan.org/authors/id/S/ST/STIGTSP/Net-CIDR-Lite-0.22.tar.gz)
* [MetaCPAN Explorer](https://explorer.metacpan.org/?url=%2Fmodule%2FSTIGTSP%2FNet-CIDR-Lite-0.22%2FLite.pm)
* [Permissions](/dist/Net-CIDR-Lite/permissions)
* [Subscribe to distribution](/dist/Net-CIDR-Lite/releases.rss)
* Install Instructions
* Jump to version
  0.22
  (STIGTSP on 2021-04-04)
  0.21
  (DOUGW on 2010-03-26)
  0.20
  (DOUGW on 2006-02-14)
  '
  0.19
  (DOUGW on 2006-01-30)
  0.18
  (DOUGW on 2005-05-21)
  0.17
  (DOUGW on 2005-05-18)
  0.16
  (DOUGW on 2005-05-18)
  0.15
  (DOUGW on 2003-04-16)
  0.14
  (DOUGW on 2002-07-15)
  0.13
  (DOUGW on 2002-07-15)
  0.12
  (DOUGW on 2002-07-15)
  0.11
  (DOUGW on 2002-04-16)
  0.10
  (DOUGW on 2001-11-27)
  0.09
  (DOUGW on 2001-11-27)
  0.08
  (DOUGW on 2001-11-26)
  0.07
  (DOUGW on 2001-10-31)
  0.06
  (DOUGW on 2001-10-31)
  0.05
  (DOUGW on 2001-10-25)
  0.04
  (DOUGW on 2001-10-24)
  0.03
  (DOUGW on 2001-10-24)
  0.02
  (DOUGW on 2001-10-23)
* Diff with version
  0.22
  (STIGTSP on 2021-04-04)
  0.21
  (DOUGW on 2010-03-26)
  0.20
  (DOUGW on 2006-02-14)
  '
  0.19
  (DOUGW on 2006-01-30)
  0.18
  (DOUGW on 2005-05-21)
  0.17
  (DOUGW on 2005-05-18)
  0.16
  (DOUGW on 2005-05-18)
  0.15
  (DOUGW on 2003-04-16)
  0.14
  (DOUGW on 2002-07-15)
  0.13
  (DOUGW on 2002-07-15)
  0.12
  (DOUGW on 2002-07-15)
  0.11
  (DOUGW on 2002-04-16)
  0.10
  (DOUGW on 2001-11-27)
  0.09
  (DOUGW on 2001-11-27)
  0.08
  (DOUGW on 2001-11-26)
  0.07
  (DOUGW on 2001-10-31)
  0.06
  (DOUGW on 2001-10-31)
  0.05
  (DOUGW on 2001-10-25)
  0.04
  (DOUGW on 2001-10-24)
  0.03
  (DOUGW on 2001-10-24)
  0.02
  (DOUGW on 2001-10-23)
* + Dependencies
  + *unknown*
  + ---
  + [Reverse dependencies](/module/Net%3A%3ACIDR%3A%3ALite/requires)
  + [CPAN Testers List](http://deps.cpantesters.org/?module=Net%3A%3ACIDR%3A%3ALite)
  + [Dependency graph](https://cpandeps.grinnz.com/?dist=Net-CIDR-Lite)
* Permalinks
* [This version](/release/STIGTSP/Net-CIDR-Lite-0.22/view/Lite.pm)
* [Latest version](/pod/Net%3A%3ACIDR%3A%3ALite)
* ++ed by:
  [![HOUSTON](https://www.gravatar.com/avatar/8a7fc78696cc68640d9287ca4ca65693?d=identicon&s=20 "HOUSTON")](/author/HOUSTON)
  [![PERLBOY](https://www.gravatar.com/avatar/8553a87a00c8d2efcd77fb16e6eb73c9?d=identicon&s=20 "PERLBOY")](/author/PERLBOY)
  [![SREZIC](https://www.gravatar.com/avatar/5fa5a4e5ffdf883a1fcb1840c915d485?d=identicon&s=20 "SREZIC")](/author/SREZIC)
  [![CURTIS](https://www.gravatar.com/avatar/04d129ebd1821b5c3e2c56783fb38b3a?d=identicon&s=20 "CURTIS")](/author/CURTIS)
  [![RORYRJB](https://www.gravatar.com/avatar/a0e1cae3abdc11be9fdc1ca0509f77c3?d=identicon&s=20 "RORYRJB")](/author/RORYRJB)

  [6 PAUSE users](/dist/Net-CIDR-Lite/plussers)

  2 non-PAUSE users
* and 1 contributors
  + [![](https://www.gravatar.com/avatar/6a3d7506a5557bdaec8f889cfa71f196?d=identicon&s=20)](/author/DOUGW)

[Stig Palmquist](/author/STIGTSP)

Â /

0.22
(STIGTSP on 2021-04-04)
0.21
(DOUGW on 2010-03-26)
0.20
(DOUGW on 2006-02-14)
'
0.19
(DOUGW on 2006-01-30)
0.18
(DOUGW on 2005-05-21)
0.17
(DOUGW on 2005-05-18)
0.16
(DOUGW on 2005-05-18)
0.15
(DOUGW on 2003-04-16)
0.14
(DOUGW on 2002-07-15)
0.13
(DOUGW on 2002-07-15)
0.12
(DOUGW on 2002-07-15)
0.11
(DOUGW on 2002-04-16)
0.10
(DOUGW on 2001-11-27)
0.09
(DOUGW on 2001-11-27)
0.08
(DOUGW on 2001-11-26)
0.07
(DOUGW on 2001-10-31)
0.06
(DOUGW on 2001-10-31)
0.05
(DOUGW on 2001-10-25)
0.04
(DOUGW on 2001-10-24)
0.03
(DOUGW on 2001-10-24)
0.02
(DOUGW on 2001-10-23)

[Net-CIDR-Lite-0.22](/dist/Net-CIDR-Lite)

 River stage two
â€¢ 23 direct dependents
â€¢ 35 total dependents

8 ++

8 ++

/ Net::CIDR::Lite

**Contents**

* [NAME](#NAME)
* [SYNOPSIS](#SYNOPSIS)
* [DESCRIPTION](#DESCRIPTION)
* [METHODS](#METHODS)
* [CAVEATS](#CAVEATS)
* [AUTHOR](#AUTHOR)
* [MAINTAINER](#MAINTAINER)
* [COPYRIGHT](#COPYRIGHT)
* [SEE ALSO](#SEE-ALSO)

# NAME

Net::CIDR::Lite - Perl extension for merging IPv4 or IPv6 CIDR addresses

# SYNOPSIS

```
use Net::CIDR::Lite;

my $cidr = Net::CIDR::Lite->new;
$cidr->add($cidr_address);
@cidr_list = $cidr->list;
@ip_ranges = $cidr->list_range;
```
# DESCRIPTION

Faster alternative to Net::CIDR when merging a large number of CIDR address ranges. Works for IPv4 and IPv6 addresses.

# METHODS

new()
```
$cidr = Net::CIDR::Lite->new
$cidr = Net::CIDR::Lite->new(@args)
```

Creates an object to represent a list of CIDR address ranges. No particular format is set yet; once an add method is called with a IPv4 or IPv6 format, only that format may be added for this cidr object. Any arguments supplied are passed to add\_any() (see below).

add()
```
$cidr->add($cidr_address)
```

Adds a CIDR address range to the list.

add\_range()
```
$cidr->add_range($ip_range)
```

Adds a hyphenated IP address range to the list.

add\_cidr()
```
$cidr1->add_cidr($cidr2)
```

Adds address ranges from one object to another object.

add\_ip()
```
$cidr->add_ip($ip_address)
```

Adds a single IP address to the list.

add\_any()
```
$cidr->add_any($cidr_or_range_or_address);
```

Determines format of range or single ip address and calls add(), add\_range(), add\_cidr(), or add\_ip() as appropriate.

$cidr->clean()
```
$cidr->clean;
```

If you are going to call the list method more than once on the same data, then for optimal performance, you can call this to purge null nodes in overlapping ranges from the list. Boundary nodes in contiguous ranges are automatically purged during add(). Only useful when ranges overlap or when contiguous ranges are added out of order.

$cidr->list()
```
@cidr_list = $cidr->list;
$list_ref  = $cidr->list;
```

Returns a list of the merged CIDR addresses. Returns an array if called in list context, an array reference if not.

$cidr->list\_range()
```
@cidr_list = $cidr->list_range;
$list_ref  = $cidr->list_range;
```

Returns a list of the merged addresses, but in hyphenated range format. Returns an array if called in list context, an array reference if not.

$cidr->list\_short\_range()
```
@cidr_list = $cidr->list_short_range;
$list_ref  = $cidr->list_short_range;
```

Returns a list of the C subnet merged addresses, in short hyphenated range format. Returns an array if called in list context, an array reference if not.

Example:

```
1.1.1.1-2
1.1.1.5-7
1.1.1.254-255
1.1.2.0-2
1.1.3.5
1.1.3.7
```

$cidr->find()
```
$found = $cidr->find($ip);
```

Returns true if the ip address is found in the CIDR range. False if not. Not extremely efficient, is O(n\*log(n)) to sort the ranges in the cidr object O(n) to search through the ranges in the cidr object. The sort is cached on the first call and used in subsequent calls, but if more addresses are added to the cidr object, prep\_find() must be called on the cidr object.

$cidr->bin\_find()

Same as find(), but forces a binary search. See also prep\_find.

$cidr->prep\_find()
```
$cidr->prep_find($num);
```

Caches the result of sorting the ip addresses. Implicitly called on the first find call, but must be explicitly called if more addresses are added to the cidr object. find() will do a binary search if the number of ranges is greater than or equal to $num (default 20);

$cidr->spanner()
```
$spanner = $cidr1->spanner($label1, $cidr2, $label2, ...);
```

Creates a spanner object to find out if multiple ip addresses are within multiple labeled address ranges. May also be called as (with or without any arguments):

```
Net::CIDR::Lite::Span->new($cidr1, $label1, $cidr2, $label2, ...);
```

$spanner->add()
```
$spanner->add($cidr1, $label1, $cidr2, $label2,...);
```

Adds labeled address ranges to the spanner object. The 'address range' may be a Net::CIDR::Lite object, a single CIDR address range, a single hyphenated IP address range, or a single IP address.

$spanner->find()
```
$href = $spanner->find(@ip_addresses);
```

Look up which range(s) ip addresses are in, and return a lookup table of the results, with the keys being the ip addresses, and the value a hash reference of which address ranges the ip address is in.

$spanner->bin\_find()

Same as find(), but forces a binary search. See also prep\_find.

$spanner->prep\_find()
```
$spanner->prep_find($num);
```

Called implicitly the first time $spanner->find(..) is called, must be called again if more cidr objects are added to the spanner object. Will do a binary search if ratio of the number of ip addresses to the number of ranges is less than $num percent (default 4).

$spanner->clean()
```
$clean_address = $spanner->clean($ip_address);
```

Validates and returns a cleaned up version of an ip address (which is what you will find as the key in the result from the $spanner->find(..), not necessarily what the original argument looked like). E.g. removes unnecessary leading zeros, removes null blocks from IPv6 addresses, etc.

# CAVEATS

Garbage in/garbage out. This module does do validation, but maybe not enough to suit your needs.

# AUTHOR

Douglas Wilson, <dougw@cpan.org> w/numerous hints and ideas borrowed from Tye McQueen.

# MAINTAINER

Stig Palmquist <stig@stig.io>

# COPYRIGHT

```
This module is free software; you can redistribute it and/or
modify it under the same terms as Perl itself.
```
# SEE ALSO

[Net::CIDR](/pod/Net%3A%3ACIDR).

Ã—
#### Module Install Instructions

To install Net::CIDR::Lite, copy and paste the appropriate command in to your terminal.

[cpanm](/dist/App-cpanminus/view/bin/cpanm)

```
cpanm Net::CIDR::Lite
```

[CPAN shell](/pod/CPAN)

```
perl -MCPAN -e shell
install Net::CIDR::Lite
```

For more information on module installation, please visit [the detailed CPAN module installation guide](https://www.cpan.org/modules/INSTALL.html).

Close

[![MetaCPAN](/static/images/metacpan-logo.svg)](/)

[About](/about)

[Sponsor](/about/sponsors)

[grep::cpan](https://grep.metacpan.org)

[Recent](/recent)

[FAQ](/about/faq)

[Tools](/tools)

[API](https://fastapi.metacpan.org/)

[Perl.org](https://www.perl.org/)

[![Bytemark logo](/static/images/sponsors/bytemark_logo.svg)](https://www.bytemark.co.uk/)
[![liquidweb logo](/static/images/sponsors/liquidweb_logo.png)](https://www.liquidweb.com/)
[![Deriv logo](/static/images/sponsors/deriv.svg)](https://deriv.com/careers/)
[![Geocode logo](/static/images/sponsors/geocodelogo.svg)](https://geocode.xyz)
[![Fastly logo](/static/images/sponsors/fastly_logo.svg)](https://www.fastly.com/)
[![OpenCage logo](/static/images/sponsors/open-cage.svg)](https://opencagedata.com)

[![Elastic logo](/static/images/sponsors/elastic.svg)](https://www.elastic.co/)

[![Route4Me logo](/static/images/sponsors/route4me.png)](https://route4me.com/)

Ã—
#### Keyboard Shortcuts

|  | Global |
| --- | --- |
| `s` | Focus search bar |
| `?` | Bring up this help dialog |

|  | GitHub |
| --- | --- |
| `g` `p` | Go to pull requests |
| `g` `i` | go to github issues (only if github is preferred repository) |

|  | POD |
| --- | --- |
| `g` `a` | Go to author |
| `g` `c` | Go to changes |
| `g` `i` | Go to issues |
| `g` `d` | Go to dist |
| `g` `r` | Go to repository/SCM |
| `g` `s` | Go to source |
| `g` `b` | Go to file browse |

|  | Search terms |
| --- | --- |
| *module:* (e.g. [module:Plugin](/search?q=module%3APlugin)) |
| *distribution:* (e.g. [distribution:Dancer auth](/search?q=distribution%3ADancer+auth)) |
| *author:* (e.g. [author:SONGMU Redis](/search?q=author%3ASONGMU+Redis)) |
| *version:* (e.g. [version:1.00](/search?q=version%3A1.00)) |



=== Content from github.com_9116c381_20250111_150643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstigtsp%2FNet-CIDR-Lite%2Fcommit%2F23b6ff0590dc279521863a502e890ef19a5a76fc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstigtsp%2FNet-CIDR-Lite%2Fcommit%2F23b6ff0590dc279521863a502e890ef19a5a76fc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=stigtsp%2FNet-CIDR-Lite)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[stigtsp](/stigtsp)
/
**[Net-CIDR-Lite](/stigtsp/Net-CIDR-Lite)**
Public

* [Notifications](/login?return_to=%2Fstigtsp%2FNet-CIDR-Lite) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fstigtsp%2FNet-CIDR-Lite)
* [Star
   1](/login?return_to=%2Fstigtsp%2FNet-CIDR-Lite)

* [Code](/stigtsp/Net-CIDR-Lite)
* [Issues
  0](/stigtsp/Net-CIDR-Lite/issues)
* [Pull requests
  0](/stigtsp/Net-CIDR-Lite/pulls)
* [Actions](/stigtsp/Net-CIDR-Lite/actions)
* [Projects
  0](/stigtsp/Net-CIDR-Lite/projects)
* [Security](/stigtsp/Net-CIDR-Lite/security)
* [Insights](/stigtsp/Net-CIDR-Lite/pulse)

Additional navigation options

* [Code](/stigtsp/Net-CIDR-Lite)
* [Issues](/stigtsp/Net-CIDR-Lite/issues)
* [Pull requests](/stigtsp/Net-CIDR-Lite/pulls)
* [Actions](/stigtsp/Net-CIDR-Lite/actions)
* [Projects](/stigtsp/Net-CIDR-Lite/projects)
* [Security](/stigtsp/Net-CIDR-Lite/security)
* [Insights](/stigtsp/Net-CIDR-Lite/pulse)

## Commit

[Permalink](/stigtsp/Net-CIDR-Lite/commit/23b6ff0590dc279521863a502e890ef19a5a76fc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Security: Prevent leading zeroes in ipv4 octets

[Browse files](/stigtsp/Net-CIDR-Lite/tree/23b6ff0590dc279521863a502e890ef19a5a76fc)
Browse the repository at this point in the history

```
This prevents prevents octal ipv4 addresses from being incorrectly
handled by not supporting leading zeroes.

010.0.0.1 was incorrectly treated as 10.0.0.1, rather than 8.0.0.1

More information is availabe here:
<https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/>
```

* Loading branch information

[![@stigtsp](https://avatars.githubusercontent.com/u/75371?s=40&v=4)](/stigtsp)

[stigtsp](/stigtsp/Net-CIDR-Lite/commits?author=stigtsp "View all commits by stigtsp")
committed
Mar 31, 2021

1 parent
[60faf1d](/stigtsp/Net-CIDR-Lite/commit/60faf1d92fd403656e9314e1580d395a6dbef7da)

commit 23b6ff0

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**13 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Lite.pm
  [Lite.pm](#diff-4843112f680852a1d497e6527d38423caa45fba7173db944ddb6699adacb3ec4)
* t

  + t/base.t
    [base.t](#diff-2f7cb91fc14eea85167567fed1324b0cf975f938b367870eedaae4046a4e4faa)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[Lite.pm](#diff-4843112f680852a1d497e6527d38423caa45fba7173db944ddb6699adacb3ec4 "Lite.pm")

Show comments

[View file](/stigtsp/Net-CIDR-Lite/blob/23b6ff0590dc279521863a502e890ef19a5a76fc/Lite.pm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -181,7 +181,7 @@ sub \_pack\_ipv4 { |
|  |  | my @nums = split /\./, shift(), -1; |
|  |  | return unless @nums == 4; |
|  |  | for (@nums) { |
|  |  | return unless /^\d{1,3}$/ and $\_ <= 255; |
|  |  | return unless /^\d{1,3}$/ and !/^0\d{1,2}$/ and $\_ <= 255; |
|  |  | } |
|  |  | pack("CC\*", 0, @nums); |
|  |  | } |
| Expand Down | |  |

13 changes: 12 additions & 1 deletion

13
[t/base.t](#diff-2f7cb91fc14eea85167567fed1324b0cf975f938b367870eedaae4046a4e4faa "t/base.t")

Show comments

[View file](/stigtsp/Net-CIDR-Lite/blob/23b6ff0590dc279521863a502e890ef19a5a76fc/t/base.t)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,7 +8,7 @@ |
|  |  | use Test; |
|  |  | use strict; |
|  |  | $|++; |
|  |  | BEGIN { plan tests => 39 }; |
|  |  | BEGIN { plan tests => 42 }; |
|  |  | use Net::CIDR::Lite; |
|  |  | ok(1); # If we made it this far, we are ok. |
|  |  |  |
| Expand Down  Expand Up | | @@ -133,3 +133,14 @@ ok(join(', ', @list\_short\_range), '10.0.0.1-2, 10.0.0.5'); |
|  |  | })->list\_short\_range; |
|  |  | ok(join(', ', @list\_short\_range), '10.0.0.250-255, 10.0.1.0-20, 10.0.1.22, 10.0.2.250-255, 10.0.3.0-255, 10.0.4.0-255, 10.0.5.0-8'); |
|  |  |  |
|  |  |  |
|  |  | # Tests for vulnerability: https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/ |
|  |  | eval { Net::CIDR::Lite->new("010.0.0.0/8") }; |
|  |  | ok($@=~/Can't determine ip format/); |
|  |  |  |
|  |  | my $err\_octal = Net::CIDR::Lite->new; |
|  |  | eval { $err\_octal->add("010.0.0.0/8") }; |
|  |  | ok($@=~/Can't determine ip format/); |
|  |  |  |
|  |  | eval { $err\_octal->add("10.01.0.0/8") }; |
|  |  | ok($@=~/Can't determine ip format/); |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `23b6ff0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstigtsp%2FNet-CIDR-Lite%2Fcommit%2F23b6ff0590dc279521863a502e890ef19a5a76fc) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from blog.urth.org_4360737e_20250111_150642.html ===
[House Absolute(ly Pointless)](/)

* [Home](https://blog.urth.org/)
* [Archives](https://blog.urth.org/posts/)
* [About](https://blog.urth.org/about)
XSearch[House Absolute(ly Pointless)](/)

* [Home](/)
* [Archives](/posts/)
* [About](/about)
# Security Issues in Perl IP Address distros

2021-03-29

*Edit on 2021-03-29 21:40(ish) UTC:* Added Net-Subnet (appears unaffected) and reordered the details
to match the list at the top of the post.

*Edit on 2021-03-30 14:50(ish) UTC:* Added Net-Works (appears unaffected).

*Edit on 2021-03-30 15:40(ish) UTC:* Added Net-CIDR (some functions are affected).

*Edit on 2021-03-31 01:05(ish) UTC:* Added Net-IPv4Addr (affected).

*Edit on 2021-04-05 01:21(ish) UTC:* Net-CIDR-Lite 0.22 contains a remediation.

*Edit on 2021-04-05 19:30(ish) UTC:* Net-IPAddress-Util 5.000 contains a remediation.

warning

**TLDR: Some Perl modules for working with IP addresses and netmasks have
bugs with potential security applications.** See below for more details on the bug and which modules
are affected.

* Net-IPv4Addr: Affected.
* Net-CIDR-Lite: Vulnerable before the 0.22 release. Upgrade now.
* Net-Netmask: Vulnerable before the 2.00000 release. Upgrade now.
* Net-IPAddress-Util: Vulnerable before the 5.000 release. Upgrade now.
* Data-Validate-IP: Depends on exactly how itâ€™s used. See below for details.
* Net-CIDR: Depends on exactly how itâ€™s used. See below for details.
* Socket: Appears unaffected.
* Net-DNS: Appears unaffected.
* NetAddr-IP: Appears unaffected.
* Net-Works: Appears unaffected.
* Net-Subnet: Appears unaffected.
* Net-Patricia: Appears unaffected.

Yesterday,
[a security issue with the NPM package `netmask` was published](https://sick.codes/universal-netmask-npm-package-used-by-270000-projects-vulnerable-to-octal-input-data-server-side-request-forgery-remote-file-inclusion-local-file-inclusion-and-more-cve-2021-28918/)[1](#fn:1).

The issue itself is pretty straightforward. Your OS will allow an IP address like `010.0.0.1` or a
netmask like `010.0.0.0/8`. That `010` is treated **as an octal number, not a base-10 number with a
leading zero!** That means that `010.0.0.1` is actually `8.0.0.1`. We can confirm this with `ping`:

| ``` 1 2  ``` | ``` ping 010.0.0.1 PING 010.0.0.1 (8.0.0.1) 56(84) bytes of data.  ``` |
| --- | --- |

But the NPM `netmask` package would treat this as `10.0.0.1`. This confusion means that an
application could be tricked into thinking a public IP - `8.0.0.1` - was part of a private subnet -
`10.0.0.0/8`. And conversely, you could trick it into thinking a private IP - `10.0.0.1` written as
`012.0.0.1` - was part of a public subnet - `12.0.0.1`.

This has security implications for any application that is trying to distinguish between public and
private IP addresses or networks for access control, firewalling, etc.

As I was reading about this I checked out
[the Git repo for the `netmask` package](https://github.com/rs/node-netmask). Its README says â€œThis
module is highly inspired by Perl [Net::Netmask](http://search.cpan.org/dist/Net-Netmask/) module.â€

And at that point I realized that it was quite possible that this affected Perl code as well! So I
started digging into this by looking at various CPAN modules for working with IP addresses,
networks, and netmasks.

Hereâ€™s the current state of CPAN modules, ordered roughly by their position in
[The River of CPAN](https://neilb.org/2015/04/20/river-of-cpan.html) (which basically means how many
modules depend on them).

## [`Net-IPv4Addr`](https://metacpan.org/release/Net-IPv4Addr)

warning**This distribution is affected by this issue. In addition, this module is
almost certainly no longer being maintained. Emails to the author bounce.**

This distribution has 4 direct dependents and 12 total dependents.

| ``` 1 2 3  ``` | ``` perl -MNet::IPv4Addr=:all -E 'say $_ for ipv4_network("010.0.0.1")' 10.0.0.0 8  ``` |
| --- | --- |

## [`Net-CIDR-Lite`](https://metacpan.org/release/Net-CIDR-Lite)

info**This distribution was vulnerable prior to its 0.22 release made on 2021-04-04.
Thanks to Stig Palmquist for taking this distro over and releasing a fix!**

This distribution has 24 direct dependents and 36 total dependents.

| ``` 1 2 3  ``` | ``` perl -MNet::CIDR::Lite -E 'my $c = Net::CIDR::Lite->new; $c->add("010.0.0.0/8"); say $_ for $c->list_range' Can't determine ip format at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/CIDR/Lite.pm line 38. 	Net::CIDR::Lite::add(Net::CIDR::Lite=HASH(0x55fe55ade740), "010.0.0.0/8") called at -e line 1  ``` |
| --- | --- |

## [`Net-Netmask`](https://metacpan.org/release/Net-Netmask)

info**This distribution was vulnerable prior to its 2.0000 release earlier today.
Great job on the quick response, Joelle Maslak!**

This distribution has 22 direct dependents and 30 total dependents.

So for versions before 2.0000 we see this:

| ``` 1 2  ``` | ``` perl -MNet::Netmask -E 'say defined Net::Netmask->new2(q{010.0.0.0/8}) ? 1 : 0' 0  ``` |
| --- | --- |

Note the use of the `new2` constructor. The old `new` constructor cannot be changed to return
`undef` for backwards compatibility reasons. Fortunately, itâ€™s probably not vulnerable in any
exploitable way, as it returns a 0-length subnet:

| ``` 1 2  ``` | ``` perl -MNet::Netmask -E 'say Net::Netmask->new(q{010.0.0.0/8})' 0.0.0.0/0  ``` |
| --- | --- |

## [`Net-IPAddress-Util`](https://metacpan.org/release/Net-IPAddress-Util)

info**This distribution was vulnerable prior to its 5.000 release made on
2021-04-04. Thanks to Paul W Bennett for the fix!**

This distribution has no dependents.

| ``` 1 2  ``` | ``` perl -MNet::IPAddress::Util=IP -E 'say IP(q{010.0.0.1})' 8.0.0.1  ``` |
| --- | --- |

## [`Data-Validate-IP`](https://metacpan.org/release/Data-Validate-IP)

info**This distribution doesnâ€™t misparse octal numbers, but you could be affected
depending on exactly how your code uses this distro. See below for details.**

This distribution has 21 direct dependents and 60 total dependents.

This distribution returns false for any `is_*_ipv4` method that includes an octal number. So both
`is_private_ipv4('010.0.0.1')` and `is_public_ipv4('010.0.0.1')` return false. **Depending on how
youâ€™re using this module, itâ€™s *possible* that this could lead to bugs, including bugs with security
implications.**

I
[updated the documentation](https://metacpan.org/pod/Data%3A%3AValidate%3A%3AIP#USAGE-AND-SECURITY-RECOMMENDATIONS)
to explicitly recommend that you **always call `is_ipv4()` in addition to calling a method like
`is_private_ipv4()`**. The `is_ipv4()` method will always return false for IP addresses with octal
numbers.

While this isnâ€™t strictly POSIX-correct, this seems like the safest behavior for a module like this.
Itâ€™s better to be too strict if this eliminates a potential footgun.

**If you are using this distribution, I highly encourage you to audit your use of it in a security
context!**

## [`Net-CIDR`](https://metacpan.org/release/Net-CIDR)

info**This distribution is affected, but it has a function to validate CIDR strings
that you should use before calling any other functions.**

This distribution has 17 direct dependents and 25 total dependents.

The distribution provides a number of functions for working with networks and IP addresses. Most of
these are not affected. However, two are:

| ```  1  2  3  4  5  6  7  8  9 10 11  ``` | ``` perl -MNet::CIDR -E 'say for Net::CIDR::addr2cidr("010.0.0.1")' 010.0.0.1/32 010.0.0.0/31 ... 010.0.0.0/8 10.0.0.0/7 8.0.0.0/6 ... perl -MNet::CIDR -E 'say Net::CIDR::cidrlookup("10.0.0.1", "010.0.0.0/8")' 1  ``` |
| --- | --- |

However, this distribution also contains a `cidrvalidate` function that will return false for any
CIDR string with a leading 0 in an octet. The documentation explicitly tells you to use this before
passing the data to other functions.

**If you are using this distribution, I highly encourage you to audit your use of it in a security
context!**

## [`Socket`](https://metacpan.org/release/Socket)

note**This distribution appears to be unaffected by this issue.**

This distribution has 275 direct dependents and 9,936 total dependents.

| ``` 1 2 3 4 5  ``` | ``` perl -MSocket -E 'say inet_ntoa(inet_aton(q{010.0.0.1}))' 8.0.0.1 perl -MSocket=inet_pton,inet_ntop,AF_INET -E 'say inet_ntop(AF_INET, inet_pton(AF_INET, q{010.0.0.1}))' Bad address length for Socket::inet_ntop on AF_INET; got 0, should be 4 at -e line 1.  ``` |
| --- | --- |

The `inet_pton()` function is just returning `undef` for this octal-formatted address.

## [`Net-DNS`](https://metacpan.org/release/Net-DNS)

note**This distribution appears to be unaffected by this issue.**

This distribution has 104 direct dependents and 561 total dependents.

If you try to resolve an IP address, it turns this into a reverse lookup, but it treats the IP as
text:

| ```  1  2  3  4  5  6  7  8  9 10 11  ``` | ``` perl ./demo/perldig 010.0.0.1 ;; Response received from 127.0.0.53 (40 octets) ;; HEADER SECTION ;;	id = 6342 ;;	qr = 1	aa = 0	tc = 0	rd = 1	opcode = QUERY ;;	ra = 1	z  = 0	ad = 0	cd = 0	rcode  = NXDOMAIN ;;	qdcount = 1	ancount = 0	nscount = 0	arcount = 0 ;;	do = 0 ;; QUESTION SECTION (1 record) ;; 1.0.0.010.in-addr.arpa.	IN	A  ``` |
| --- | --- |

So itâ€™s not a useful answer, but itâ€™s not looking up the *wrong* address.

## [`NetAddr-IP`](https://metacpan.org/release/NetAddr-IP)

note**This distribution appears to be unaffected by this issue.**

This distribution has 36 direct dependents and 110 total dependents.

| ``` 1 2  ``` | ``` perl -MNetAddr::IP -E 'say NetAddr::IP->new(q{010.0.0.024})' 8.0.0.20/32  ``` |
| --- | --- |

## [`Net-Works`](https://metacpan.org/release/Net-Works)

note**This distribution appears to be unaffected by this issue.**

This distribution has 3 direct dependents and 7 total dependents.

| ``` 1 2 3 4 5 6 7 8  ``` | ``` perl -MNet::Works::Network -E 'say Net::Works::Network->new_from_string(string => q{010.0.0.1/8})' 010.0.0.1/8 is not a valid IP network at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Network.pm line 120. 	Net::Works::Network::new_from_string("Net::Works::Network", "string", "010.0.0.1/8") called at -e line 1 perl -MNet::Works::Address -E 'say Net::Works::Address->new_from_string(string => q{010.0.0.1})' 010.0.0.1 is not a valid IPv6 address at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Util.pm line 70. 	Net::Works::Util::_validate_ip_string("010.0.0.1", 6) called at /home/autarch/.perlbrew/libs/perl-5.30.1@dev/lib/perl5/Net/Works/Address.pm line 74 	Net::Works::Address::new_from_string("Net::Works::Address", "string", "010.0.0.1") called at -e line 1  ``` |
| --- | --- |

Thanks to Stig Palmquist for checking this one and letting me know.

## [`Net-Subnet`](https://metacpan.org/release/Net-Subnet)

note**This distribution appears to be unaffected by this issue.**

This distribution has 3 direct dependents and 7 total dependents.

| ``` 1 2 3 4 5  ``` | ``` perl -MNet::Subnet -E 'my $m = subnet_matcher(q{10.0.0.0/8}); say $m->(q{012.0.0.1}) ? 1 : 0' 1 perl -MNet::Subnet -E 'my $m = subnet_matcher(q{012.0.0.0/8}); say $m->(q{10.0.0.1}) ? 1 : 0' 1  ``` |
| --- | --- |

## [`Net-Patricia`](https://metacpan.org/release/Net-Patricia)

note**This distribution appears to be unaffected by this issue.**

This distribution has 1 direct dependent and 1 total dependent.

| ``` 1 2 3 4 5  ``` | ``` perl -MNet::Patricia -E 'my $p = Net::Patricia->new; $p->add_string("010.0.0.0/8"); say $p->match_string("8.0.0.1") ? 1 : 0' 1 perl -MNet::Patricia -E 'my $p = Net::Patricia->new; $p->add_string("8.0.0.0/8"); say $p->match_string("010.0.0.1") ? 1 : 0' 1  ``` |
| --- | --- |

---

1. One of the most ridiculous URL paths Iâ€™ve ever seen.Â [â†©ï¸Ž](#fnref:1)
[Down the Golang nil Rabbit Hole
Next](/2021/03/27/down-the-golang-nil-rabbit-hole/)[API Design and the Recent IP Address Module Issues
Prev](/2021/04/03/api-design-and-the-recent-ip-address-module-issues/)

---

Found a typo? Fix it by [editing this page on GitHub](https://github.com/autarch/blog.urth.org/edit/master/content/posts/2021-03-29-security-issues-in-perl-ip-address-distros.md).

Comments?

Discuss this post on:

* [/r/perl](https://www.reddit.com/r/perl/comments/mfzxuh/security_issues_in_perl_ip_address_distros/)
* [/r/programming](https://www.reddit.com/r/programming/comments/mg0s73/security_issues_in_perl_ip_address_distros/)
* [Hacker News](https://news.ycombinator.com/item?id=26628827)

You can
also email me directly.

Powered by [Hugo](https://gohugo.io)
|
Theme - [Jane](https://github.com/xianmin/hugo-theme-jane)
Â©
2007 -
2024
Dave Rolsky

[This work](https://blog.urth.org/) by David Rolsky is licensed under [CC BY-SA 4.0![](https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1)![](https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1)![](https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1)](http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1)



=== Content from lists.debian.org_fad22377_20250111_150643.html ===


---

[[Date Prev](msg00022.html)][[Date Next](msg00024.html)]
[[Thread Prev](msg00022.html)][[Thread Next](msg00024.html)]
[[Date Index](maillist.html#00023)]
[[Thread Index](threads.html#00023)]

# [SECURITY] [DLA 3770-1] libnet-cidr-lite-perl security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3770-1] libnet-cidr-lite-perl security update
* *From*: Thorsten Alteholz <debian@alteholz.de>
* *Date*: Sat, 23 Mar 2024 16:25:38 +0000 (UTC)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/alpine.DEB.2.21.2403231620490.4745%40postfach.intern.alteholz.me)Â [alpine.DEB.2.21.2403231620490.4745@postfach.intern.alteholz.me](msg00023.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3770-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                    Thorsten Alteholz
March 23, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : libnet-cidr-lite-perl
Version        : 0.21-2+debu10u1
CVE ID         : CVE-2021-47154

```
An issue has been found in libnet-cidr-lite-perl, a module for merging
IPv4 or IPv6 CIDR address ranges.
```

Extraneous zero characters at the beginning of an IP address string

```
might allow attackers to bypass access control that is based on IP
addresses.
```

```
Please check your application whether it accidentally allows such leading
zero characters (that are normally meant to indicate octal numbers).
```

For Debian 10 buster, this problem has been fixed in version
0.21-2+debu10u1.

We recommend that you upgrade your libnet-cidr-lite-perl packages.

For the detailed security status of libnet-cidr-lite-perl please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/libnet-cidr-lite-perl>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEEYgH7/9u94Hgi6ruWlvysDTh7WEcFAmX/AoJfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDYy
MDFGQkZGREJCREUwNzgyMkVBQkI5Njk2RkNBQzBEMzg3QjU4NDcACgkQlvysDTh7
WEeS0w//X6qyxaGb0ZhA+WYIaIDfs+WXjnR5MR0tAy8wubXm+Wq1CJrbRcxLhCpr
Lg0Q3OoGqR8pWt0a5/f1Z2DtowmWspwvnwdV3E23mER0xjOLYmQhpjRrHbDy+s4z
n5qp2pmJhstyepXV17ElkKghHLzQDb7ZYbOAl/YhbP1kkVTcqxetM5TOKpyEn+dL
8NQnErFsQ6cyOuqbdf3i1lwpA1NjNKa3LwLPou6u6X6oBqxAI1otHbkpsJglGNgS
E5m3ZWZCym984/C88gO3zXMmNEbfrEoypy+hTVtoXNCtOh9yX1D0VLwiVpnLKUT2
X1UoiH9Sxzx0K5WbclbsEkL++HmXEgHrhMXyAkv80aEDvdIzgGGO3OrlOUmVFRwq
jeyP+XtAozveufK+BDRIYAArZzyNOROWJ3IK1xL5EbXUJs60Y3oh3W/9E0Hs4SGR
O51XS47LiSzPMf6yJ2eShpLJ+BLg1VDYIAtcsjcKWPlJsSvAaG2JPJf4Xn+Nwvs2
yYKeCEkGXif/7xPfftvaHce0p8Av7Zi1MJ/myK7E6PcdIPouZuJhRsZZ3CDoDQHm
KdmaVr05rQxUlMQoKGgYmnwxRo0dtfk73p1xHEBoX69mwqxHQMP8MVO/XDWfCs7k
xN7IFnOH74nS10VkBigxoC2WzhyuAR0e/uP6m/Bu+GOuMaA9S6s=
=kE+i
-----END PGP SIGNATURE-----

```

---



=== Content from metacpan.org_c57a0594_20250111_150648.html ===


* [About](/about)
* [Sponsor](/about/sponsors)
* [grep::cpan](https://grep.metacpan.org/)
* [Recent](/recent)
* [FAQ](/about/faq)
* [Tools](/tools)
* [API](https://fastapi.metacpan.org/)

* + [Identities](/account/identities)
  + [Profile](/account/profile)
  + [Favorites](/account/favorite/list)
  + Logout
* + [GitHub](/login/github)
  + [Twitter](/login/twitter)
  + [Google](/login/google)

* Tools
* [Release Info](/release/STIGTSP/Net-CIDR-Lite-0.22)
* [Author](/author/STIGTSP)
* [Raw code](https://fastapi.metacpan.org/source/STIGTSP/Net-CIDR-Lite-0.22/Changes)
* [Permalink](/release/STIGTSP/Net-CIDR-Lite-0.22/source/Changes)
* [Download](/release/STIGTSP/Net-CIDR-Lite-0.22/raw/Changes?download=1)
* HideShow Pod
* Info
* 98 lines of code
* 0 lines of pod
* 5.08K bytes

[STIGTSP / Net-CIDR-Lite-0.22](/release/STIGTSP/Net-CIDR-Lite-0.22/source)
/ Changes

```
Revision history for Perl extension Net::CIDR::Lite.

0.22  2021-04-04
    - Security: IPv4 octets with leading zeroes are no longer allowed.
      https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/
0.21  Wed Mar 28 14:34:18 2007
    - Fix RT Tickets:
    - 14535: Fix spanner clean() docs (reported by carbon at pobox.com).
    - 25898: Undef dereference with empty object (patch by Adam Tomason).
    - 30777: Add short_list_range() method (patch by Josef Kutej).
    - 48308: clean() or list() before add() causes error (reported by David Cawley).
    - 50042: spanner add() did not accept non-object (patch by Tomo.M).
    - 52571: "::" not accepted as valid IPv6 address (reported by Tim Wilde).
0.20  Sun Feb 12 01:00:00 2006
    - Fix error message on mask values.
0.19  Sat Jan 30 01:00:00 2006
    - Allow net mask of zero.
0.18  Sat May 20 01:00:00 2005
    - Documented bin_find().
    - Added pod tests. Watch my kwalitee go up! Woohoo!
0.17  Wed May 18 12:00:00 2005
    - Fixed last fix and corresponding test.
0.16  Wed May 18 10:00:00 2005
    - Fixed divide by zero on find with empty spanner.
      Reported by jgmyers via rt.cpan.org.
    - Fixed pod errors.
0.15  Wed Apr 16 13:00:00 2003
    - Fixed # of tests in test.pl. Thanks to CPAN testers.
    - Squelched '-w' warning about doubly declared lexical variable.
      Thanks to Jan Pieter Cornet.
0.14  Mon Jul 14 09:00:00 2002
    - Fixed list_range for '0.0.0.0/32' (and '::0/32').
      Besides, I needed to get past lucky version 13.
0.13  Mon Jul 14 02:30:00 2002
    - internal _add_bit method was never meant to overflow, but previous
      fix made it necessary, but it wasn't doing it correctly, so I
      had to change the internal data structure to store N+1 bytes
      (5 bytes for 32 bit IPv4, and 17 bytes for IPv6), and change the
      rest of the program to deal with it.
0.12  Sun Jul 14 22:00:00 2002
    - Fixed off by one error on end of range in list_range method.
      found by Allen Smith. added test.
    - binary find was not working when target address was beginning
      of a range. Also found by Allen Smith. added another test.
0.11  Mon Apr 15 21:05:00 2002
    - Fixed infinite loop in list() when 0.0.0.0/x was given as an address.
      found by Allen Smith. added test.
0.10  Tue Nov 27 09:05:00 2001
    - Allow whitespace around '-' in add_range. So that what I posted
      in a dead newsgroup on Usenet will actually work :-)
    - Document add_any() method.
0.09  Mon Nov 26 21:05:00 2001
    - Fixed warning in add_range().
0.08  Mon Nov 26 10:05:00 2001
    - Fixed docs.
0.07  Wed Oct 31 10:05:00 2001
    - Lifted some code from Array::IntSpan and tweaked it for my
      purposes to do a binary search on a find() if the (# of IP addresses)/(the
      # of ranges) is below some percentage (default 4%). The initial
      search setup is still O(n*log(n)) for the sort, but it can speed up
      subsequent searches for IP addresses. I haven't benchmarked
      any of this, so for you Benchmark fanatics who use this module,
      let me know some stats, please :-)
    - Added binary search capability to N::C::L find method.
    - Fixed NCL::Span find method (never trust version 1 of this stuff).
0.06  Tue Oct 30 10:05:00 2001
    - Add find methods, one for ip lookup within a single cidr object, and
      another as an Array::IntSpan style lookup, but for looking up addresses
      in labeled cidr objects. Both are moderately inefficient for looking up
      single ip addresses multiple times, but the latter is fairly efficient
      at looking up many ip addresses all at once.
0.05  Thu Oct 25 10:05:00 2001
    - Changed some unpack/pack code to use vec(). Thanks to Tye
      for the knowledge and know-how (especially on how to efficiently use
      the little-endian vec function on a big-endian string).
      Unpack/pack w/operations on strings is sometimes faster
      than the vec() method for some strings, but probably not
      in the common case.
0.04  Tue Oct 23 18:05:00 2001
    - bug in add_range() wasn't entering the end ip correctly.
    - added list_range() function. Not sure if its useful since
      it doesn't output ranges in CIDR netblocks. Could be changed
      if desired, let me know either way.
0.03  Tue Oct 23 17:05:00 2001
    - _compress_ipv6() was not stripping leading zeros within a block.
0.02  Tue Oct 23 14:45:00 2001
    - Do addition with pseudo-bit manipulation (thanks to Tye for
      initial idea, may go to complete binary operations in the future).
    - Added IPv6 support.
    - Clean up null nodes on 'as you go' on contiguous ranges (thanks
      again to Tye for the idea and directly lifted code).
    - Added more methods to simulate functionality of Net::CIDR and then
      some (e.g. added add_range() function). Still don't have
      octets function.
0.01  Tue Oct 16 09:26:01 2001
    - Basic idea to use a hash to store the ranges improves speed
      over Net::CIDR ( O(n*n) vs. O(n*log(n)) for you big O fans).
      (created in answer to a 'challenge' posted by Dominus on perlmonks).
	- original version; created by h2xs 1.21 with options
		-A -X -n Net::CIDR::Lite

```

[![MetaCPAN](/static/images/metacpan-logo.svg)](/)

[About](/about)

[Sponsor](/about/sponsors)

[grep::cpan](https://grep.metacpan.org)

[Recent](/recent)

[FAQ](/about/faq)

[Tools](/tools)

[API](https://fastapi.metacpan.org/)

[Perl.org](https://www.perl.org/)

[![Bytemark logo](/static/images/sponsors/bytemark_logo.svg)](https://www.bytemark.co.uk/)
[![liquidweb logo](/static/images/sponsors/liquidweb_logo.png)](https://www.liquidweb.com/)
[![Deriv logo](/static/images/sponsors/deriv.svg)](https://deriv.com/careers/)
[![Geocode logo](/static/images/sponsors/geocodelogo.svg)](https://geocode.xyz)
[![Fastly logo](/static/images/sponsors/fastly_logo.svg)](https://www.fastly.com/)
[![OpenCage logo](/static/images/sponsors/open-cage.svg)](https://opencagedata.com)

[![Elastic logo](/static/images/sponsors/elastic.svg)](https://www.elastic.co/)

[![Route4Me logo](/static/images/sponsors/route4me.png)](https://route4me.com/)

Ã—
#### Keyboard Shortcuts

|  | Global |
| --- | --- |
| `s` | Focus search bar |
| `?` | Bring up this help dialog |

|  | GitHub |
| --- | --- |
| `g` `p` | Go to pull requests |
| `g` `i` | go to github issues (only if github is preferred repository) |

|  | POD |
| --- | --- |
| `g` `a` | Go to author |
| `g` `c` | Go to changes |
| `g` `i` | Go to issues |
| `g` `d` | Go to dist |
| `g` `r` | Go to repository/SCM |
| `g` `s` | Go to source |
| `g` `b` | Go to file browse |

|  | Search terms |
| --- | --- |
| *module:* (e.g. [module:Plugin](/search?q=module%3APlugin)) |
| *distribution:* (e.g. [distribution:Dancer auth](/search?q=distribution%3ADancer+auth)) |
| *author:* (e.g. [author:SONGMU Redis](/search?q=author%3ASONGMU+Redis)) |
| *version:* (e.g. [version:1.00](/search?q=version%3A1.00)) |


