```
{
  "vulnerability": {
    "root_cause": "The MessagePack library was vulnerable to hash collision attacks when deserializing data from untrusted sources. This is because the library used a non-cryptographic hash function which allowed an attacker to craft inputs that cause excessive hash collisions. Additionally, there was a stack overflow risk during deserialization of deeply nested data structures.",
    "weaknesses": [
      "CWE-328: Use of a Broken or Risky Cryptographic Algorithm"
    ],
    "impact": "A denial-of-service (DoS) attack can occur by sending specially crafted data that leads to high CPU usage due to hash collisions, or stack overflow due to deeply nested data.",
    "attack_vectors": "The vulnerability is triggered when deserializing messagepack data from an untrusted source.",
    "required_attacker_capabilities": "The attacker needs to be able to send crafted messagepack data to a system using the vulnerable library.",
     "details": "The vulnerability stems from the usage of a non-collision resistant hash algorithm within the MessagePack library when handling untrusted data. Specifically, the library uses the `GetHashCollisionResistantEqualityComparer` method that did not adequately prevent hash collisions and the stack overflow was due to the deserialization process when handling deeply nested data structures. An attacker can exploit this by crafting messagepack data that forces the hash function to generate many collisions, causing a significant performance degradation and potential for denial of service. The fix includes using the SipHash algorithm to provide collision resistance. Additionally, a patch was released to address the stack overflow issue when deserializing deeply nested data. The patched versions use a collision-resistant hash algorithm and provide checks for maximum allowed depth of the data structure to prevent excessive stack usage during deserialization."
  }
}
```