=== Content from github.com_71ed5dd7_20250111_004240.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMessagePack-CSharp%2FMessagePack-CSharp%2Fsecurity%2Fadvisories%2FGHSA-4qm4-8hg2-g2xm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMessagePack-CSharp%2FMessagePack-CSharp%2Fsecurity%2Fadvisories%2FGHSA-4qm4-8hg2-g2xm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=MessagePack-CSharp%2FMessagePack-CSharp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MessagePack-CSharp](/MessagePack-CSharp)
/
**[MessagePack-CSharp](/MessagePack-CSharp/MessagePack-CSharp)**
Public

* [Notifications](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp) You must be signed in to change notification settings
* [Fork
  710](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp)
* [Star
   5.9k](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp)

* [Code](/MessagePack-CSharp/MessagePack-CSharp)
* [Issues
  76](/MessagePack-CSharp/MessagePack-CSharp/issues)
* [Pull requests
  1](/MessagePack-CSharp/MessagePack-CSharp/pulls)
* [Discussions](/MessagePack-CSharp/MessagePack-CSharp/discussions)
* [Actions](/MessagePack-CSharp/MessagePack-CSharp/actions)
* [Security](/MessagePack-CSharp/MessagePack-CSharp/security)
* [Insights](/MessagePack-CSharp/MessagePack-CSharp/pulse)

Additional navigation options

* [Code](/MessagePack-CSharp/MessagePack-CSharp)
* [Issues](/MessagePack-CSharp/MessagePack-CSharp/issues)
* [Pull requests](/MessagePack-CSharp/MessagePack-CSharp/pulls)
* [Discussions](/MessagePack-CSharp/MessagePack-CSharp/discussions)
* [Actions](/MessagePack-CSharp/MessagePack-CSharp/actions)
* [Security](/MessagePack-CSharp/MessagePack-CSharp/security)
* [Insights](/MessagePack-CSharp/MessagePack-CSharp/pulse)

# Untrusted data can lead to DoS attack due to hash collisions and stack overflow, round 2

Moderate

[AArnott](/AArnott)
published
GHSA-4qm4-8hg2-g2xm
Oct 17, 2024

## Package

nuget

MessagePack
([NuGet](/advisories?query=ecosystem%3Anuget))

## Affected versions

< 2.5.187
>= 2.6.95-alpha, < 3.0.214-rc.1

## Patched versions

2.5.187
3.0.214-rc.1

## Description

### Impact

When this library is used to deserialize messagepack data from an untrusted source, there is a risk of a denial of service attack by an attacker that sends data contrived to produce hash collisions, leading to large CPU consumption disproportionate to the size of the data being deserialized.

This is similar to [a prior advisory](https://github.com/MessagePack-CSharp/MessagePack-CSharp/security/advisories/GHSA-7q36-4xx7-xcxf), which provided an inadequate fix for the hash collision part of the vulnerability.

### Patches

The following steps are required to mitigate this risk.

1. Upgrade to a version of the library where a fix is available. If upgrading from v1, check out [our migration guide](https://github.com/MessagePack-CSharp/MessagePack-CSharp/blob/master/doc/migration.md).
2. Review the steps in [this previous advisory](https://github.com/MessagePack-CSharp/MessagePack-CSharp/security/advisories/GHSA-7q36-4xx7-xcxf) to ensure you have your application configured for untrusted data.

### Workarounds

If upgrading MessagePack to a patched version is not an option for you, you may apply a manual workaround as follows:

1. Declare a class that derives from `MessagePackSecurity`.
2. Override the `GetHashCollisionResistantEqualityComparer<T>` method to provide a collision-resistant hash function of your own and avoid calling `base.GetHashCollisionResistantEqualityComparer<T>()`.
3. Configure a `MessagePackSerializerOptions` with an instance of your derived type by calling `WithSecurity` on an existing options object.
4. Use your custom options object for all deserialization operations. This may be by setting the `MessagePackSerializer.DefaultOptions` static property, if you call methods that rely on this default property, and/or by passing in the options object explicitly to any `Deserialize` method.

### References

* Learn more about best security practices when reading untrusted data with [MessagePack 1.x](https://github.com/MessagePack-CSharp/MessagePack-CSharp/tree/v1.x#security) or [MessagePack 2.x](https://github.com/MessagePack-CSharp/MessagePack-CSharp#security).
* The .NET team's [discussion on hash collision vulnerabilities of their `HashCode` struct](https://github.com/GrabYourPitchforks/runtime/blob/threat_models/docs/design/security/System.HashCode.md) (or in [the pull request that merges this into the dotnet org](https://github.com/dotnet/runtime/pull/108864)).

### For more information

If you have any questions or comments about this advisory:

* [Start a public discussion](https://github.com/MessagePack-CSharp/MessagePack-CSharp/discussions)
* Email us privately

### Severity

Moderate

### CVE ID

CVE-2024-48924

### Weaknesses

[CWE-328](/advisories?query=cwe%3A328)

### Credits

* [![@AArnott](https://avatars.githubusercontent.com/u/3548?s=40&v=4)](/AArnott)
  [AArnott](/AArnott)
  Remediation developer
* [![@neuecc](https://avatars.githubusercontent.com/u/46207?s=40&v=4)](/neuecc)
  [neuecc](/neuecc)
  Remediation reviewer
* [![@GrabYourPitchforks](https://avatars.githubusercontent.com/u/1746272?s=40&v=4)](/GrabYourPitchforks)
  [GrabYourPitchforks](/GrabYourPitchforks)
  Remediation reviewer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_13ccbed7_20250111_004240.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMessagePack-CSharp%2FMessagePack-CSharp%2Fcommit%2Ff8d40b3ad0be01c6e56cb51ecea81f59d98c192d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMessagePack-CSharp%2FMessagePack-CSharp%2Fcommit%2Ff8d40b3ad0be01c6e56cb51ecea81f59d98c192d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=MessagePack-CSharp%2FMessagePack-CSharp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MessagePack-CSharp](/MessagePack-CSharp)
/
**[MessagePack-CSharp](/MessagePack-CSharp/MessagePack-CSharp)**
Public

* [Notifications](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp) You must be signed in to change notification settings
* [Fork
  710](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp)
* [Star
   5.9k](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp)

* [Code](/MessagePack-CSharp/MessagePack-CSharp)
* [Issues
  76](/MessagePack-CSharp/MessagePack-CSharp/issues)
* [Pull requests
  1](/MessagePack-CSharp/MessagePack-CSharp/pulls)
* [Discussions](/MessagePack-CSharp/MessagePack-CSharp/discussions)
* [Actions](/MessagePack-CSharp/MessagePack-CSharp/actions)
* [Security](/MessagePack-CSharp/MessagePack-CSharp/security)
* [Insights](/MessagePack-CSharp/MessagePack-CSharp/pulse)

Additional navigation options

* [Code](/MessagePack-CSharp/MessagePack-CSharp)
* [Issues](/MessagePack-CSharp/MessagePack-CSharp/issues)
* [Pull requests](/MessagePack-CSharp/MessagePack-CSharp/pulls)
* [Discussions](/MessagePack-CSharp/MessagePack-CSharp/discussions)
* [Actions](/MessagePack-CSharp/MessagePack-CSharp/actions)
* [Security](/MessagePack-CSharp/MessagePack-CSharp/security)
* [Insights](/MessagePack-CSharp/MessagePack-CSharp/pulse)

## Commit

[Permalink](/MessagePack-CSharp/MessagePack-CSharp/commit/f8d40b3ad0be01c6e56cb51ecea81f59d98c192d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#2014](https://github.com/MessagePack-CSharp/MessagePack-CSharp/pull/2014) from MessagePack-CSharp/secureHash

[Browse files](/MessagePack-CSharp/MessagePack-CSharp/tree/f8d40b3ad0be01c6e56cb51ecea81f59d98c192d)
Browse the repository at this point in the history

```
Use a collision-resistant hash algorithm for untrusted data
```

* Loading branch information

[![@AArnott](https://avatars.githubusercontent.com/u/3548?s=40&v=4)](/AArnott)

[AArnott](/MessagePack-CSharp/MessagePack-CSharp/commits?author=AArnott "View all commits by AArnott")
authored
Oct 17, 2024

2 parents
[3a90034](/MessagePack-CSharp/MessagePack-CSharp/commit/3a90034c2b1d2a0f6e1205bdc68c43c98faf7f9e)
+
[ad2d135](/MessagePack-CSharp/MessagePack-CSharp/commit/ad2d135fd90de69f83904fde958653e38b0c220c)

commit f8d40b3

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**541 additions**
and
**131 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* sandbox/DynamicCodeDumper

  + sandbox/DynamicCodeDumper/DynamicCodeDumper.csproj
    [DynamicCodeDumper.csproj](#diff-3d3bd5aa3e6dfc3bb6ddcd3ec2d1406ef22af48dc6c78f0bad9baff9a51be405)
* src/MessagePack.UnityClient/Assets/Scripts

  + MessagePack

    - src/MessagePack.UnityClient/Assets/Scripts/MessagePack/MessagePackSecurity.cs
      [MessagePackSecurity.cs](#diff-2a64ed8a894381c12aea4b4800ac865b1c0345d0d85c46dfff41d4bc9a8ce264)
    - src/MessagePack.UnityClient/Assets/Scripts/MessagePack/SipHash.cs
      [SipHash.cs](#diff-92e9bb389673d4796e7d879de7465ed9ba60a1b8158e3882db46a0b0eafcc241)
    - src/MessagePack.UnityClient/Assets/Scripts/MessagePack/SipHash.cs.meta
      [SipHash.cs.meta](#diff-34ca8da77c7c1b6f3d9fb01c84010730b8d3fb71ab2ddf51520d03d38dc5303c)
  + Tests/ShareTests

    - src/MessagePack.UnityClient/Assets/Scripts/Tests/ShareTests/MessagePackSecurityTests.cs
      [MessagePackSecurityTests.cs](#diff-161574006d959c9eb019e2cb0aa8e7d07e8455d2fe70fe58a309909bd8185b34)
    - src/MessagePack.UnityClient/Assets/Scripts/Tests/ShareTests/SipHashTests.cs
      [SipHashTests.cs](#diff-aa439e38dc148d4bb653ad0ee873fe6436ceac9786e429dc809788654f7ce3bb)
    - src/MessagePack.UnityClient/Assets/Scripts/Tests/ShareTests/SipHashTests.cs.meta
      [SipHashTests.cs.meta](#diff-523567789be0abe1ad34bff08f03e95da84a98f5f5b179b91fa206be2a196b26)
* tests/MessagePack.Tests

  + tests/MessagePack.Tests/MessagePack.Tests.csproj
    [MessagePack.Tests.csproj](#diff-03c1d75ac19160c6939e4bd67e3dbaabf54c143c1d155b42d1aa36235fdf970c)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[sandbox/DynamicCodeDumper/DynamicCodeDumper.csproj](#diff-3d3bd5aa3e6dfc3bb6ddcd3ec2d1406ef22af48dc6c78f0bad9baff9a51be405 "sandbox/DynamicCodeDumper/DynamicCodeDumper.csproj")

Show comments

[View file](/MessagePack-CSharp/MessagePack-CSharp/blob/f8d40b3ad0be01c6e56cb51ecea81f59d98c192d/sandbox/DynamicCodeDumper/DynamicCodeDumper.csproj)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -79,6 +79,9 @@ |
|  |  | <Compile Include="..\..\src\MessagePack.UnityClient\Assets\Scripts\MessagePack\MessagePackSecurity.cs"> |
|  |  | <Link>Code\MessagePackSecurity.cs</Link> |
|  |  | </Compile> |
|  |  | <Compile Include="..\..\src\MessagePack.UnityClient\Assets\Scripts\MessagePack\SipHash.cs"> |
|  |  | <Link>Code\SipHash.cs</Link> |
|  |  | </Compile> |
|  |  | <Compile Include="..\..\src\MessagePack.UnityClient\Assets\Scripts\MessagePack\MonoProtection.cs"> |
|  |  | <Link>Code\MonoProtection.cs</Link> |
|  |  | </Compile> |
| Expand Down | |  |

235 changes: 109 additions & 126 deletions

235
[src/MessagePack.UnityClient/Assets/Scripts/MessagePack/MessagePackSecurity.cs](#diff-2a64ed8a894381c12aea4b4800ac865b1c0345d0d85c46dfff41d4bc9a8ce264 "src/MessagePack.UnityClient/Assets/Scripts/MessagePack/MessagePackSecurity.cs")

Show comments

[View file](/MessagePack-CSharp/MessagePack-CSharp/blob/f8d40b3ad0be01c6e56cb51ecea81f59d98c192d/src/MessagePack.UnityClient/Assets/Scripts/MessagePack/MessagePackSecurity.cs)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

287 changes: 287 additions & 0 deletions

287
[src/MessagePack.UnityClient/Assets/Scripts/MessagePack/SipHash.cs](#diff-92e9bb389673d4796e7d879de7465ed9ba60a1b8158e3882db46a0b0eafcc241 "src/MessagePack.UnityClient/Assets/Scripts/MessagePack/SipHash.cs")

Show comments

[View file](/MessagePack-CSharp/MessagePack-CSharp/blob/f8d40b3ad0be01c6e56cb51ecea81f59d98c192d/src/MessagePack.UnityClient/Assets/Scripts/MessagePack/SipHash.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,287 @@ |
|  |  | ﻿// Copyright (c) All contributors. All rights reserved. |
|  |  | // Licensed under the MIT license. See LICENSE file in the project root for full license information. |
|  |  |  |
|  |  | //// Originally from: https://github.com/paya-cz/siphash |
|  |  | //// Author: Pavel Werl |
|  |  | //// License: Public Domain |
|  |  | //// SipHash website: https://131002.net/siphash/ |
|  |  |  |
|  |  | using System; |
|  |  | using System.Buffers; |
|  |  | using System.Buffers.Binary; |
|  |  | using System.Runtime.CompilerServices; |
|  |  | using System.Runtime.InteropServices; |
|  |  | using System.Security.Cryptography; |
|  |  |  |
|  |  | namespace MessagePack |
|  |  | { |
|  |  | /// <summary> |
|  |  | /// Implements the <see href="https://en.wikipedia.org/wiki/SipHash">SipHash pseudo-random function</see>. |
|  |  | /// </summary> |
|  |  | /// <remarks> |
|  |  | /// This class is immutable and thread-safe. |
|  |  | /// </remarks> |
|  |  | internal class SipHash |
|  |  | { |
|  |  | /// <summary> |
|  |  | /// Part of the initial 256-bit internal state. |
|  |  | /// </summary> |
|  |  | private readonly ulong initialState0; |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Part of the initial 256-bit internal state. |
|  |  | /// </summary> |
|  |  | private readonly ulong initialState1; |
|  |  |  |
|  |  | /// <summary>Initializes a new instance of the <see cref="SipHash"/> class using a random key.</summary> |
|  |  | public SipHash() |
|  |  | { |
|  |  | using RandomNumberGenerator rng = RandomNumberGenerator.Create(); |
|  |  | #if SPAN\_BUILTIN |
|  |  | Span<byte> key = stackalloc byte[16]; |
|  |  | rng.GetBytes(key); |
|  |  | #else |
|  |  | byte[] buffer = ArrayPool<byte>.Shared.Rent(16); |
|  |  | rng.GetBytes(buffer, 0, 16); |
|  |  | Span<byte> key = buffer; |
|  |  | #endif |
|  |  |  |
|  |  | this.initialState0 = 0x736f6d6570736575UL ^ BinaryPrimitives.ReadUInt64LittleEndian(key); |
|  |  | this.initialState1 = 0x646f72616e646f6dUL ^ BinaryPrimitives.ReadUInt64LittleEndian(key.Slice(sizeof(ulong))); |
|  |  |  |
|  |  | #if !SPAN\_BUILTIN |
|  |  | ArrayPool<byte>.Shared.Return(buffer); |
|  |  | #endif |
|  |  | } |
|  |  |  |
|  |  | /// <summary>Initializes a new instance of the <see cref="SipHash"/> class using the specified 128-bit key.</summary> |
|  |  | /// <param name="key">Key for the SipHash pseudo-random function. Must be exactly 16 bytes long.</param> |
|  |  | /// <exception cref="ArgumentException">Thrown when <paramref name="key"/> is not exactly 16 bytes long (128 bits).</exception> |
|  |  | public SipHash(ReadOnlySpan<byte> key) |
|  |  | { |
|  |  | if (key.Length != 16) |
|  |  | { |
|  |  | throw new ArgumentException("SipHash key must be exactly 128-bit long (16 bytes).", nameof(key)); |
|  |  | } |
|  |  |  |
|  |  | this.initialState0 = 0x736f6d6570736575UL ^ BinaryPrimitives.ReadUInt64LittleEndian(key); |
|  |  | this.initialState1 = 0x646f72616e646f6dUL ^ BinaryPrimitives.ReadUInt64LittleEndian(key.Slice(sizeof(ulong))); |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Gets a 128-bit SipHash key. |
|  |  | /// </summary> |
|  |  | /// <param name="key">The 16-byte buffer that receives the key originally provided to the constructor.</param> |
|  |  | public void GetKey(Span<byte> key) |
|  |  | { |
|  |  | if (key.Length != 16) |
|  |  | { |
|  |  | throw new ArgumentException("SipHash key must be exactly 128-bit long (16 bytes).", nameof(key)); |
|  |  | } |
|  |  |  |
|  |  | BinaryPrimitives.WriteUInt64LittleEndian(key, this.initialState0 ^ 0x736f6d6570736575UL); |
|  |  | BinaryPrimitives.WriteUInt64LittleEndian(key.Slice(sizeof(ulong)), this.initialState1 ^ 0x646f72616e646f6dUL); |
|  |  | } |
|  |  |  |
|  |  | /// <summary>Computes 64-bit SipHash tag for the specified message.</summary> |
|  |  | /// <param name="data">The byte array for which to computer SipHash tag.</param> |
|  |  | /// <returns>Returns 64-bit (8 bytes) SipHash tag.</returns> |
|  |  | public long Compute(ReadOnlySpan<byte> data) |
|  |  | { |
|  |  | unchecked |
|  |  | { |
|  |  | // SipHash internal state |
|  |  | ulong v0 = this.initialState0; |
|  |  | ulong v1 = this.initialState1; |
|  |  |  |
|  |  | // It is faster to load the initialStateX fields from memory again than to reference v0 and v1: |
|  |  | ulong v2 = 0x1F160A001E161714UL ^ this.initialState0; |
|  |  | ulong v3 = 0x100A160317100A1EUL ^ this.initialState1; |
|  |  |  |
|  |  | // We process data in 64-bit blocks |
|  |  | ulong block; |
|  |  |  |
|  |  | // The last 64-bit block of data |
|  |  | int finalBlockPosition = data.Length & ~7; |
|  |  |  |
|  |  | // Process the input data in blocks of 64 bits |
|  |  | for (int blockPosition = 0; blockPosition < finalBlockPosition; blockPosition += sizeof(ulong)) |
|  |  | { |
|  |  | block = MemoryMarshal.Read<ulong>(data.Slice(blockPosition)); |
|  |  |  |
|  |  | v3 ^= block; |
|  |  |  |
|  |  | // Round 1 |
|  |  | v0 += v1; |
|  |  | v2 += v3; |
|  |  | v1 = v1 << 13 | v1 >> 51; |
|  |  | v3 = v3 << 16 | v3 >> 48; |
|  |  | v1 ^= v0; |
|  |  | v3 ^= v2; |
|  |  | v0 = v0 << 32 | v0 >> 32; |
|  |  | v2 += v1; |
|  |  | v0 += v3; |
|  |  | v1 = v1 << 17 | v1 >> 47; |
|  |  | v3 = v3 << 21 | v3 >> 43; |
|  |  | v1 ^= v2; |
|  |  | v3 ^= v0; |
|  |  | v2 = v2 << 32 | v2 >> 32; |
|  |  |  |
|  |  | // Round 2 |
|  |  | v0 += v1; |
|  |  | v2 += v3; |
|  |  | v1 = v1 << 13 | v1 >> 51; |
|  |  | v3 = v3 << 16 | v3 >> 48; |
|  |  | v1 ^= v0; |
|  |  | v3 ^= v2; |
|  |  | v0 = v0 << 32 | v0 >> 32; |
|  |  | v2 += v1; |
|  |  | v0 += v3; |
|  |  | v1 = v1 << 17 | v1 >> 47; |
|  |  | v3 = v3 << 21 | v3 >> 43; |
|  |  | v1 ^= v2; |
|  |  | v3 ^= v0; |
|  |  | v2 = v2 << 32 | v2 >> 32; |
|  |  |  |
|  |  | v0 ^= block; |
|  |  | } |
|  |  |  |
|  |  | // Load the remaining bytes |
|  |  | block = (ulong)data.Length << 56; |
|  |  | switch (data.Length & 7) |
|  |  | { |
|  |  | case 7: |
|  |  | block |= MemoryMarshal.Read<uint>(data.Slice(finalBlockPosition)) | (ulong)MemoryMarshal.Read<ushort>(data.Slice(finalBlockPosition + 4)) << 32 | (ulong)data[finalBlockPosition + 6] << 48; |
|  |  | break; |
|  |  | case 6: |
|  |  | block |= MemoryMarshal.Read<uint>(data.Slice(finalBlockPosition)) | (ulong)MemoryMarshal.Read<ushort>(data.Slice(finalBlockPosition + 4)) << 32; |
|  |  | break; |
|  |  | case 5: |
|  |  | block |= MemoryMarshal.Read<uint>(data.Slice(finalBlockPosition)) | (ulong)data[finalBlockPosition + 4] << 32; |
|  |  | break; |
|  |  | case 4: |
|  |  | block |= MemoryMarshal.Read<uint>(data.Slice(finalBlockPosition)); |
|  |  | break; |
|  |  | case 3: |
|  |  | block |= MemoryMarshal.Read<ushort>(data.Slice(finalBlockPosition)) | (ulong)data[finalBlockPosition + 2] << 16; |
|  |  | break; |
|  |  | case 2: |
|  |  | block |= MemoryMarshal.Read<ushort>(data.Slice(finalBlockPosition)); |
|  |  | break; |
|  |  | case 1: |
|  |  | block |= data[finalBlockPosition]; |
|  |  | break; |
|  |  | } |
|  |  |  |
|  |  | // Process the final block |
|  |  | { |
|  |  | v3 ^= block; |
|  |  |  |
|  |  | // Round 1 |
|  |  | v0 += v1; |
|  |  | v2 += v3; |
|  |  | v1 = v1 << 13 | v1 >> 51; |
|  |  | v3 = v3 << 16 | v3 >> 48; |
|  |  | v1 ^= v0; |
|  |  | v3 ^= v2; |
|  |  | v0 = v0 << 32 | v0 >> 32; |
|  |  | v2 += v1; |
|  |  | v0 += v3; |
|  |  | v1 = v1 << 17 | v1 >> 47; |
|  |  | v3 = v3 << 21 | v3 >> 43; |
|  |  | v1 ^= v2; |
|  |  | v3 ^= v0; |
|  |  | v2 = v2 << 32 | v2 >> 32; |
|  |  |  |
|  |  | // Round 2 |
|  |  | v0 += v1; |
|  |  | v2 += v3; |
|  |  | v1 = v1 << 13 | v1 >> 51; |
|  |  | v3 = v3 << 16 | v3 >> 48; |
|  |  | v1 ^= v0; |
|  |  | v3 ^= v2; |
|  |  | v0 = v0 << 32 | v0 >> 32; |
|  |  | v2 += v1; |
|  |  | v0 += v3; |
|  |  | v1 = v1 << 17 | v1 >> 47; |
|  |  | v3 = v3 << 21 | v3 >> 43; |
|  |  | v1 ^= v2; |
|  |  | v3 ^= v0; |
|  |  | v2 = v2 << 32 | v2 >> 32; |
|  |  |  |
|  |  | v0 ^= block; |
|  |  | v2 ^= 0xff; |
|  |  | } |
|  |  |  |
|  |  | // 4 finalization rounds |
|  |  | { |
|  |  | // Round 1 |
|  |  | v0 += v1; |
|  |  | v2 += v3; |
|  |  | v1 = v1 << 13 | v1 >> 51; |
|  |  | v3 = v3 << 16 | v3 >> 48; |
|  |  | v1 ^= v0; |
|  |  | v3 ^= v2; |
|  |  | v0 = v0 << 32 | v0 >> 32; |
|  |  | v2 += v1; |
|  |  | v0 += v3; |
|  |  | v1 = v1 << 17 | v1 >> 47; |
|  |  | v3 = v3 << 21 | v3 >> 43; |
|  |  | v1 ^= v2; |
|  |  | v3 ^= v0; |
|  |  | v2 = v2 << 32 | v2 >> 32; |
|  |  |  |
|  |  | // Round 2 |
|  |  | v0 += v1; |
|  |  | v2 += v3; |
|  |  | v1 = v1 << 13 | v1 >> 51; |
|  |  | v3 = v3 << 16 | v3 >> 48; |
|  |  | v1 ^= v0; |
|  |  | v3 ^= v2; |
|  |  | v0 = v0 << 32 | v0 >> 32; |
|  |  | v2 += v1; |
|  |  | v0 += v3; |
|  |  | v1 = v1 << 17 | v1 >> 47; |
|  |  | v3 = v3 << 21 | v3 >> 43; |
|  |  | v1 ^= v2; |
|  |  | v3 ^= v0; |
|  |  | v2 = v2 << 32 | v2 >> 32; |
|  |  |  |
|  |  | // Round 3 |
|  |  | v0 += v1; |
|  |  | v2 += v3; |
|  |  | v1 = v1 << 13 | v1 >> 51; |
|  |  | v3 = v3 << 16 | v3 >> 48; |
|  |  | v1 ^= v0; |
|  |  | v3 ^= v2; |
|  |  | v0 = v0 << 32 | v0 >> 32; |
|  |  | v2 += v1; |
|  |  | v0 += v3; |
|  |  | v1 = v1 << 17 | v1 >> 47; |
|  |  | v3 = v3 << 21 | v3 >> 43; |
|  |  | v1 ^= v2; |
|  |  | v3 ^= v0; |
|  |  | v2 = v2 << 32 | v2 >> 32; |
|  |  |  |
|  |  | // Round 4 |
|  |  | v0 += v1; |
|  |  | v2 += v3; |
|  |  | v1 = v1 << 13 | v1 >> 51; |
|  |  | v3 = v3 << 16 | v3 >> 48; |
|  |  | v1 ^= v0; |
|  |  | v3 ^= v2; |
|  |  | v0 = v0 << 32 | v0 >> 32; |
|  |  | v2 += v1; |
|  |  | v0 += v3; |
|  |  | v1 = v1 << 17 | v1 >> 47; |
|  |  | v3 = v3 << 21 | v3 >> 43; |
|  |  | v1 ^= v2; |
|  |  | v3 ^= v0; |
|  |  | v2 = v2 << 32 | v2 >> 32; |
|  |  | } |
|  |  |  |
|  |  | return (long)((v0 ^ v1) ^ (v2 ^ v3)); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |

11 changes: 11 additions & 0 deletions

11
[src/MessagePack.UnityClient/Assets/Scripts/MessagePack/SipHash.cs.meta](#diff-34ca8da77c7c1b6f3d9fb01c84010730b8d3fb71ab2ddf51520d03d38dc5303c "src/MessagePack.UnityClient/Assets/Scripts/MessagePack/SipHash.cs.meta")

Show comments

[View file](/MessagePack-CSharp/MessagePack-CSharp/blob/f8d40b3ad0be01c6e56cb51ecea81f59d98c192d/src/MessagePack.UnityClient/Assets/Scripts/MessagePack/SipHash.cs.meta)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

7 changes: 2 additions & 5 deletions

7
[src/MessagePack.UnityClient/Assets/Scripts/Tests/ShareTests/MessagePackSecurityTests.cs](#diff-161574006d959c9eb019e2cb0aa8e7d07e8455d2fe70fe58a309909bd8185b34 "src/MessagePack.UnityClient/Assets/Scripts/Tests/ShareTests/MessagePackSecurityTests.cs")

Show comments

[View file](/MessagePack-CSharp/MessagePack-CSharp/blob/f8d40b3ad0be01c6e56cb51ecea81f59d98c192d/src/MessagePack.UnityClient/Assets/Scripts/Tests/ShareTests/MessagePackSecurityTests.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -125,11 +125,8 @@ public void EqualityComparer\_Enums() |
|  |  | Assert.NotNull(MessagePackSecurity.UntrustedData.GetEqualityComparer<SomeUInt16Enum>()); |
|  |  | Assert.NotNull(MessagePackSecurity.UntrustedData.GetEqualityComparer<SomeInt32Enum>()); |
|  |  | Assert.NotNull(MessagePackSecurity.UntrustedData.GetEqualityComparer<SomeUInt32Enum>()); |
|  |  |  |
|  |  | // Supporting enums with backing integers that exceed 32-bits would likely require Ref.Emit of new types |
|  |  | // since C# doesn't let us cast T to the underlying int type. |
|  |  | Assert.Throws<TypeAccessException>(() => MessagePackSecurity.UntrustedData.GetEqualityComparer<SomeInt64Enum>()); |
|  |  | Assert.Throws<TypeAccessException>(() => MessagePackSecurity.UntrustedData.GetEqualityComparer<SomeUInt64Enum>()); |
|  |  | Assert.NotNull(MessagePackSecurity.UntrustedData.GetEqualityComparer<SomeInt64Enum>()); |
|  |  | Assert.NotNull(MessagePackSecurity.UntrustedData.GetEqualityComparer<SomeUInt64Enum>()); |
|  |  | } |
|  |  |  |
|  |  | [Fact] |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f8d40b3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMessagePack-CSharp%2FMessagePack-CSharp%2Fcommit%2Ff8d40b3ad0be01c6e56cb51ecea81f59d98c192d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_babc2744_20250111_004238.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMessagePack-CSharp%2FMessagePack-CSharp%2Fcommit%2F8e599af0798b45008f8b293a7f233e4878f11ed5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMessagePack-CSharp%2FMessagePack-CSharp%2Fcommit%2F8e599af0798b45008f8b293a7f233e4878f11ed5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=MessagePack-CSharp%2FMessagePack-CSharp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MessagePack-CSharp](/MessagePack-CSharp)
/
**[MessagePack-CSharp](/MessagePack-CSharp/MessagePack-CSharp)**
Public

* [Notifications](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp) You must be signed in to change notification settings
* [Fork
  710](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp)
* [Star
   5.9k](/login?return_to=%2FMessagePack-CSharp%2FMessagePack-CSharp)

* [Code](/MessagePack-CSharp/MessagePack-CSharp)
* [Issues
  76](/MessagePack-CSharp/MessagePack-CSharp/issues)
* [Pull requests
  1](/MessagePack-CSharp/MessagePack-CSharp/pulls)
* [Discussions](/MessagePack-CSharp/MessagePack-CSharp/discussions)
* [Actions](/MessagePack-CSharp/MessagePack-CSharp/actions)
* [Security](/MessagePack-CSharp/MessagePack-CSharp/security)
* [Insights](/MessagePack-CSharp/MessagePack-CSharp/pulse)

Additional navigation options

* [Code](/MessagePack-CSharp/MessagePack-CSharp)
* [Issues](/MessagePack-CSharp/MessagePack-CSharp/issues)
* [Pull requests](/MessagePack-CSharp/MessagePack-CSharp/pulls)
* [Discussions](/MessagePack-CSharp/MessagePack-CSharp/discussions)
* [Actions](/MessagePack-CSharp/MessagePack-CSharp/actions)
* [Security](/MessagePack-CSharp/MessagePack-CSharp/security)
* [Insights](/MessagePack-CSharp/MessagePack-CSharp/pulse)

## Commit

[Permalink](/MessagePack-CSharp/MessagePack-CSharp/commit/8e599af0798b45008f8b293a7f233e4878f11ed5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#2015](https://github.com/MessagePack-CSharp/MessagePack-CSharp/pull/2015) from MessagePack-CSharp/secureHash\_v3

[Browse files](/MessagePack-CSharp/MessagePack-CSharp/tree/8e599af0798b45008f8b293a7f233e4878f11ed5)
Browse the repository at this point in the history

```
Use a collision-resistant hash algorithm for untrusted data
```

* Loading branch information

[![@AArnott](https://avatars.githubusercontent.com/u/3548?s=40&v=4)](/AArnott)

[AArnott](/MessagePack-CSharp/MessagePack-CSharp/commits?author=AArnott "View all commits by AArnott")
authored
Oct 17, 2024

2 parents
[9be3584](/MessagePack-CSharp/MessagePack-CSharp/commit/9be35840b831fae041e6cf8acc864ec34e4b7d50)
+
[eb114ac](/MessagePack-CSharp/MessagePack-CSharp/commit/eb114acb0b883546aa607aeb8ec4ec62638bb426)

commit 8e599af

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**519 additions**
and
**131 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* sandbox/DynamicCodeDumper

  + sandbox/DynamicCodeDumper/DynamicCodeDumper.csproj
    [DynamicCodeDumper.csproj](#diff-3d3bd5aa3e6dfc3bb6ddcd3ec2d1406ef22af48dc6c78f0bad9baff9a51be405)
* src/MessagePack

  + src/MessagePack/MessagePackSecurity.cs
    [MessagePackSecurity.cs](#diff-8a34ec4aeb61fdea3b12343384025b01a5d55a4b7808269a9217cf31c252fcf7)
  + src/MessagePack/SipHash.cs
    [SipHash.cs](#diff-91dd0b649651cca65abbcb14a5dc0e56734e25d86c9d9ad552a5cb927cc68ef0)
* tests/MessagePack.Tests

  + tests/MessagePack.Tests/MessagePack.Tests.csproj
    [MessagePack.Tests.csproj](#diff-03c1d75ac19160c6939e4bd67e3dbaabf54c143c1d155b42d1aa36235fdf970c)
  + tests/MessagePack.Tests/MessagePackSecurityTests.cs
    [MessagePackSecurityTests.cs](#diff-31e753c4086d321329243f63137ee6ad70a729990348c9bc190f7e4ac34c03bf)
  + tests/MessagePack.Tests/SipHashTests.cs
    [SipHashTests.cs](#diff-4bd774c3397c98ef1a1ec1acc4c279eb886775e918d97d230213f09299832683)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[sandbox/DynamicCodeDumper/DynamicCodeDumper.csproj](#diff-3d3bd5aa3e6dfc3bb6ddcd3ec2d1406ef22af48dc6c78f0bad9baff9a51be405 "sandbox/DynamicCodeDumper/DynamicCodeDumper.csproj")

Show comments

[View file](/MessagePack-CSharp/MessagePack-CSharp/blob/8e599af0798b45008f8b293a7f233e4878f11ed5/sandbox/DynamicCodeDumper/DynamicCodeDumper.csproj)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -124,6 +124,9 @@ |
|  |  | <Compile Include="..\..\src\MessagePack\SafeBitConverter.cs"> |
|  |  | <Link>Code\SafeBitConverter.cs</Link> |
|  |  | </Compile> |
|  |  | <Compile Include="..\..\src\MessagePack\SipHash.cs"> |
|  |  | <Link>Code\SipHash.cs</Link> |
|  |  | </Compile> |
|  |  | <Compile Include="..\..\src\MessagePack\MessagePackCode.cs"> |
|  |  | <Link>Code\MessagePackCode.cs</Link> |
|  |  | </Compile> |
| Expand Down | |  |

235 changes: 109 additions & 126 deletions

235
[src/MessagePack/MessagePackSecurity.cs](#diff-8a34ec4aeb61fdea3b12343384025b01a5d55a4b7808269a9217cf31c252fcf7 "src/MessagePack/MessagePackSecurity.cs")

Show comments

[View file](/MessagePack-CSharp/MessagePack-CSharp/blob/8e599af0798b45008f8b293a7f233e4878f11ed5/src/MessagePack/MessagePackSecurity.cs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,7 +6,9 @@ |
|  |  | using System.Collections.Generic; |
|  |  | using System.Linq; |
|  |  | using System.Reflection; |
|  |  | using System.Runtime.CompilerServices; |
|  |  | using System.Runtime.ExceptionServices; |
|  |  | using System.Runtime.InteropServices; |
|  |  | using MessagePack.Formatters; |
|  |  | using MessagePack.Internal; |
|  |  |  |
| Expand All | | @@ -31,6 +33,8 @@ public class MessagePackSecurity |
|  |  | MaximumObjectGraphDepth = 500, |
|  |  | }; |
|  |  |  |
|  |  | private static readonly SipHash Hash = new(); |
|  |  |  |
|  |  | private readonly ObjectFallbackEqualityComparer objectFallbackEqualityComparer; |
|  |  |  |
|  |  | private MessagePackSecurity() |
| Expand Down  Expand Up | | @@ -138,62 +142,72 @@ public IEqualityComparer GetEqualityComparer() |
|  |  | return this.HashCollisionResistant ? GetHashCollisionResistantEqualityComparer() : EqualityComparer<object>.Default; |
|  |  | } |
|  |  |  |
|  |  | private class HashResistantCache<T> |
|  |  | { |
|  |  | internal static readonly IEqualityComparer<T>? EqualityComparer; |
|  |  |  |
|  |  | static HashResistantCache() |
|  |  | { |
|  |  | // We have to specially handle some 32-bit types (e.g. float) where multiple in-memory representations should hash to the same value. |
|  |  | // Any type supported by the PrimitiveObjectFormatter should be added here if supporting it as a key in a collection makes sense. |
|  |  | EqualityComparer = |
|  |  | typeof(T) == typeof(bool) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<bool>.Instance : |
|  |  | typeof(T) == typeof(char) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<char>.Instance : |
|  |  | typeof(T) == typeof(sbyte) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<sbyte>.Instance : |
|  |  | typeof(T) == typeof(byte) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<byte>.Instance : |
|  |  | typeof(T) == typeof(short) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<short>.Instance : |
|  |  | typeof(T) == typeof(ushort) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<ushort>.Instance : |
|  |  | typeof(T) == typeof(int) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<int>.Instance : |
|  |  | typeof(T) == typeof(uint) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<uint>.Instance : |
|  |  | typeof(T) == typeof(long) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<long>.Instance : |
|  |  | typeof(T) == typeof(ulong) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<ulong>.Instance : |
|  |  | typeof(T) == typeof(Guid) ? (IEqualityComparer<T>)CollisionResistantHasherUnmanaged<Guid>.Instance : |
|  |  |  |
|  |  | // Data types that are managed or have multiple in-memory representations for equivalent values: |
|  |  | typeof(T) == typeof(float) ? (IEqualityComparer<T>)SingleEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(double) ? (IEqualityComparer<T>)DoubleEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(string) ? (IEqualityComparer<T>)StringEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(DateTime) ? (IEqualityComparer<T>)DateTimeEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(DateTimeOffset) ? (IEqualityComparer<T>)DateTimeOffsetEqualityComparer.Instance : |
|  |  |  |
|  |  | // Call out each primitive behind an enum explicitly to avoid dynamically generating code. |
|  |  | typeof(T).GetTypeInfo().IsEnum && typeof(T).GetTypeInfo().GetEnumUnderlyingType() is Type underlying ? ( |
|  |  | underlying == typeof(byte) ? CollisionResistantEnumHasher<T, byte>.Instance : |
|  |  | underlying == typeof(sbyte) ? CollisionResistantEnumHasher<T, sbyte>.Instance : |
|  |  | underlying == typeof(ushort) ? CollisionResistantEnumHasher<T, ushort>.Instance : |
|  |  | underlying == typeof(short) ? CollisionResistantEnumHasher<T, short>.Instance : |
|  |  | underlying == typeof(uint) ? CollisionResistantEnumHasher<T, uint>.Instance : |
|  |  | underlying == typeof(int) ? CollisionResistantEnumHasher<T, int>.Instance : |
|  |  | underlying == typeof(ulong) ? CollisionResistantEnumHasher<T, ulong>.Instance : |
|  |  | underlying == typeof(long) ? CollisionResistantEnumHasher<T, long>.Instance : |
|  |  | null) : |
|  |  |  |
|  |  | // Failsafe. If we don't recognize the type, don't assume we have a good, secure hash function for it. |
|  |  | null; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// Returns a hash collision resistant equality comparer. |
|  |  | /// </summary> |
|  |  | /// <typeparam name="T">The type of key that will be hashed in the collection.</typeparam> |
|  |  | /// <returns>A hash collision resistant equality comparer.</returns> |
|  |  | protected virtual IEqualityComparer<T> GetHashCollisionResistantEqualityComparer<T>() |
|  |  | { |
|  |  | IEqualityComparer<T>? result = null; |
|  |  | if (typeof(T).GetTypeInfo().IsEnum) |
|  |  | if (HashResistantCache<T>.EqualityComparer is { } result) |
|  |  | { |
|  |  | Type underlyingType = typeof(T).GetTypeInfo().GetEnumUnderlyingType(); |
|  |  | result = |
|  |  | underlyingType == typeof(sbyte) ? CollisionResistantHasher<T>.Instance : |
|  |  | underlyingType == typeof(byte) ? CollisionResistantHasher<T>.Instance : |
|  |  | underlyingType == typeof(short) ? CollisionResistantHasher<T>.Instance : |
|  |  | underlyingType == typeof(ushort) ? CollisionResistantHasher<T>.Instance : |
|  |  | underlyingType == typeof(int) ? CollisionResistantHasher<T>.Instance : |
|  |  | underlyingType == typeof(uint) ? CollisionResistantHasher<T>.Instance : |
|  |  | null; |
|  |  | return result; |
|  |  | } |
|  |  | else |
|  |  |  |
|  |  | if (typeof(T) == typeof(object)) |
|  |  | { |
|  |  | // For anything 32-bits and under, our fallback base secure hasher is usually adequate since it makes the hash unpredictable. |
|  |  | // We should have special implementations for any value that is larger than 32-bits in order to make sure |
|  |  | // that all the data gets hashed securely rather than trivially and predictably compressed into 32-bits before being hashed. |
|  |  | // We also have to specially handle some 32-bit types (e.g. float) where multiple in-memory representations should hash to the same value. |
|  |  | // Any type supported by the PrimitiveObjectFormatter should be added here if supporting it as a key in a collection makes sense. |
|  |  | result = |
|  |  |  |
|  |  | // 32-bits or smaller: |
|  |  | typeof(T) == typeof(bool) ? CollisionResistantHasher<T>.Instance : |
|  |  | typeof(T) == typeof(char) ? CollisionResistantHasher<T>.Instance : |
|  |  | typeof(T) == typeof(sbyte) ? CollisionResistantHasher<T>.Instance : |
|  |  | typeof(T) == typeof(byte) ? CollisionResistantHasher<T>.Instance : |
|  |  | typeof(T) == typeof(short) ? CollisionResistantHasher<T>.Instance : |
|  |  | typeof(T) == typeof(ushort) ? CollisionResistantHasher<T>.Instance : |
|  |  | typeof(T) == typeof(int) ? CollisionResistantHasher<T>.Instance : |
|  |  | typeof(T) == typeof(uint) ? CollisionResistantHasher<T>.Instance : |
|  |  |  |
|  |  | // Larger than 32-bits (or otherwise require special handling): |
|  |  | typeof(T) == typeof(long) ? (IEqualityComparer<T>)Int64EqualityComparer.Instance : |
|  |  | typeof(T) == typeof(ulong) ? (IEqualityComparer<T>)UInt64EqualityComparer.Instance : |
|  |  | typeof(T) == typeof(float) ? (IEqualityComparer<T>)SingleEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(double) ? (IEqualityComparer<T>)DoubleEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(string) ? (IEqualityComparer<T>)StringEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(Guid) ? (IEqualityComparer<T>)GuidEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(DateTime) ? (IEqualityComparer<T>)DateTimeEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(DateTimeOffset) ? (IEqualityComparer<T>)DateTimeOffsetEqualityComparer.Instance : |
|  |  | typeof(T) == typeof(object) ? (IEqualityComparer<T>)this.objectFallbackEqualityComparer : |
|  |  | null; |
|  |  | return (IEqualityComparer<T>)this.objectFallbackEqualityComparer; |
|  |  | } |
|  |  |  |
|  |  | // Any type we don't explicitly whitelist here shouldn't be allowed to use as the key in a hash-based collection since it isn't known to be hash resistant. |
|  |  | // This method can of course be overridden to add more hash collision resistant type support, or the deserializing party can indicate that the data is Trusted |
|  |  | // so that this method doesn't even get called. |
|  |  | return result ?? throw new TypeAccessException($"No hash-resistant equality comparer available for type: {typeof(T)}"); |
|  |  | throw new TypeAccessException($"No hash-resistant equality comparer available for type: {typeof(T)}"); |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
| Expand Down  Expand Up | | @@ -233,25 +247,41 @@ public void DepthStep(ref MessagePackReader reader) |
|  |  | /// </remarks> |
|  |  | protected virtual MessagePackSecurity Clone() => new MessagePackSecurity(this); |
|  |  |  |
|  |  | private static int SecureHash<T>(T value) |
|  |  | where T : unmanaged |
|  |  | { |
|  |  | Span<T> span = stackalloc T[1]; |
|  |  | span[0] = value; |
|  |  | return unchecked((int)Hash.Compute(MemoryMarshal.Cast<T, byte>(span))); |
|  |  | } |
|  |  |  |
|  |  | private static int SecureHash(ReadOnlySpan<byte> data) => unchecked((int)Hash.Compute(data)); |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// A hash collision resistant implementation of <see cref="IEqualityComparer{T}"/>. |
|  |  | /// </summary> |
|  |  | /// <typeparam name="T">The type of key that will be hashed.</typeparam> |
|  |  | private class CollisionResistantHasher<T> : IEqualityComparer<T>, IEqualityComparer |
|  |  | private abstract class CollisionResistantHasher<T> : IEqualityComparer<T>, IEqualityComparer |
|  |  | { |
|  |  | internal static readonly CollisionResistantHasher<T> Instance = new CollisionResistantHasher<T>(); |
|  |  |  |
|  |  | public bool Equals(T? x, T? y) => EqualityComparer<T?>.Default.Equals(x, y); |
|  |  |  |
|  |  | bool IEqualityComparer.Equals(object? x, object? y) => ((IEqualityComparer)EqualityComparer<T>.Default).Equals(x, y); |
|  |  |  |
|  |  | public int GetHashCode(object obj) => this.GetHashCode((T)obj); |
|  |  |  |
|  |  | public virtual int GetHashCode(T value) => HashCode.Combine(value); |
|  |  | public abstract int GetHashCode(T value); |
|  |  | } |
|  |  |  |
|  |  | private class CollisionResistantHasherUnmanaged<T> : CollisionResistantHasher<T> |
|  |  | where T : unmanaged |
|  |  | { |
|  |  | internal static readonly CollisionResistantHasherUnmanaged<T> Instance = new(); |
|  |  |  |
|  |  | public override int GetHashCode(T value) => SecureHash(value); |
|  |  | } |
|  |  |  |
|  |  | /// <summary> |
|  |  | /// A special hash-resistent equality comparer that defers picking the actual implementation |
|  |  | /// A special hash-resistant equality comparer that defers picking the actual implementation |
|  |  | /// till it can check the runtime type of each value to be hashed. |
|  |  | /// </summary> |
|  |  | private class ObjectFallbackEqualityComparer : IEqualityComparer<object>, IEqualityComparer |
| Expand Down  Expand Up | | @@ -304,116 +334,69 @@ public int GetHashCode(object value) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | private class UInt64EqualityComparer : CollisionResistantHasher<ulong> |
|  |  | private class SingleEqualityComparer : CollisionResistantHasherUnmanaged<float> |
|  |  | { |
|  |  | internal static new readonly UInt64EqualityComparer Instance = new UInt64EqualityComparer(); |
|  |  |  |
|  |  | public override int GetHashCode(ulong value) => HashCode.Combine((uint)(value >> 32), unchecked((uint)value)); |
|  |  | } |
|  |  |  |
|  |  | private class Int64EqualityComparer : CollisionResistantHasher<long> |
|  |  | { |
|  |  | internal static new readonly Int64EqualityComparer Instance = new Int64EqualityComparer(); |
|  |  |  |
|  |  | public override int GetHashCode(long value) => HashCode.Combine((int)(value >> 32), unchecked((int)value)); |
|  |  | } |
|  |  |  |
|  |  | private class SingleEqualityComparer : CollisionResistantHasher<float> |
|  |  | { |
|  |  | internal static new readonly SingleEqualityComparer Instance = new SingleEqualityComparer(); |
|  |  | internal static new readonly SingleEqualityComparer Instance = new(); |
|  |  |  |
|  |  | public override unsafe int GetHashCode(float value) |
|  |  | { |
|  |  | // Special check for 0.0 so that the hash of 0.0 and -0.0 will equal. |
|  |  | if (value == 0.0f) |
|  |  | => base.GetHashCode(value switch |
|  |  | { |
|  |  | return HashCode.Combine(0); |
|  |  | } |
|  |  |  |
|  |  | // Standardize on the binary representation of NaN prior to hashing. |
|  |  | if (float.IsNaN(value)) |
|  |  | { |
|  |  | value = float.NaN; |
|  |  | } |
|  |  |  |
|  |  | int l = \*(int\*)&value; |
|  |  | return l; |
|  |  | } |
|  |  | 0.0f => 0, // Special check for 0.0 so that the hash of 0.0 and -0.0 will equal. |
|  |  | float.NaN => float.NaN, // Standardize on the binary representation of NaN prior to hashing. |
|  |  | \_ => value, |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | private class DoubleEqualityComparer : CollisionResistantHasher<double> |
|  |  | private class DoubleEqualityComparer : CollisionResistantHasherUnmanaged<double> |
|  |  | { |
|  |  | internal static new readonly DoubleEqualityComparer Instance = new DoubleEqualityComparer(); |
|  |  | internal static new readonly DoubleEqualityComparer Instance = new(); |
|  |  |  |
|  |  | public override unsafe int GetHashCode(double value) |
|  |  | { |
|  |  | // Special check for 0.0 so that the hash of 0.0 and -0.0 will equal. |
|  |  | if (value == 0.0) |
|  |  | => base.GetHashCode(value switch |
|  |  | { |
|  |  | return HashCode.Combine(0); |
|  |  | } |
|  |  | 0.0 => 0, // Special check for 0.0 so that the hash of 0.0 and -0.0 will equal. |
|  |  | double.NaN => double.NaN, // Standardize on the binary representation of NaN prior to hashing. |
|  |  | \_ => value, |
|  |  | }); |
|  |  | } |
|  |  |  |
|  |  | // Standardize on the binary representation of NaN prior to hashing. |
|  |  | if (double.IsNaN(value)) |
|  |  | { |
|  |  | value = double.NaN; |
|  |  | } |
|  |  | private class DateTimeEqualityComparer : CollisionResistantHasherUnmanaged<DateTime> |
|  |  | { |
|  |  | internal static new readonly DateTimeEqualityComparer Instance = new(); |
|  |  |  |
|  |  | long l = \*(long\*)&value; |
|  |  | return HashCode.Combine((int)(l >> 32), unchecked((int)l)); |
|  |  | } |
|  |  | public override unsafe int GetHashCode(DateTime value) => SecureHash(value.Ticks); |
|  |  | } |
|  |  |  |
|  |  | private class GuidEqualityComparer : CollisionResistantHasher<Guid> |
|  |  | private class DateTimeOffsetEqualityComparer : CollisionResistantHasherUnmanaged<DateTimeOffset> |
|  |  | { |
|  |  | internal static new readonly GuidEqualityComparer Instance = new GuidEqualityComparer(); |
|  |  |  |
|  |  | public override unsafe int GetHashCode(Guid value) |
|  |  | { |
|  |  | var hash = default(HashCode); |
|  |  | int\* pGuid = (int\*)&value; |
|  |  | for (int i = 0; i < sizeof(Guid) / sizeof(int); i++) |
|  |  | { |
|  |  | hash.Add(pGuid[i]); |
|  |  | } |
|  |  | internal static new readonly DateTimeOffsetEqualityComparer Instance = new(); |
|  |  |  |
|  |  | return hash.ToHashCode(); |
|  |  | } |
|  |  | public override unsafe int GetHashCode(DateTimeOffset value) => SecureHash(value.UtcDateTime.Ticks); |
|  |  | } |
|  |  |  |
|  |  | private class StringEqualityComparer : CollisionResistantHasher<string> |
|  |  | { |
|  |  | internal static new readonly StringEqualityComparer Instance = new StringEqualityComparer(); |
|  |  | internal static readonly StringEqualityComparer Instance = new(); |
|  |  |  |
|  |  | public override int GetHashCode(string value) |
|  |  | { |
|  |  | #if NETCOREAPP |
|  |  | // .NET Core already has a secure string hashing function. Just use it. |
|  |  | return value?.GetHashCode() ?? 0; |
|  |  | #else |
|  |  | var hash = default(HashCode); |
|  |  | for (int i = 0; i < value.Length; i++) |
|  |  | { |
|  |  | hash.Add(value[i]); |
|  |  | } |
|  |  |  |
|  |  | return hash.ToHashCode(); |
|  |  | #endif |
|  |  | // The Cast call could result in OverflowException at runtime if value is greater than 1bn chars in length. |
|  |  | return SecureHash(MemoryMarshal.Cast<char, byte>(value.AsSpan())); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | private class DateTimeEqualityComparer : CollisionResistantHasher<DateTime> |
|  |  | private class CollisionResistantEnumHasher<TEnum, TUnderlying> : IEqualityComparer<TEnum>, IEqualityComparer |
|  |  | where TUnderlying : unmanaged |
|  |  | { |
|  |  | internal static new readonly DateTimeEqualityComparer Instance = new DateTimeEqualityComparer(); |
|  |  | internal static readonly CollisionResistantEnumHasher<TEnum, TUnderlying> Instance = new(); |
|  |  |  |
|  |  | public override unsafe int GetHashCode(DateTime value) => HashCode.Combine((int)(value.Ticks >> 32), unchecked((int)value.Ticks), value.Kind); |
|  |  | } |
|  |  | public bool Equals(TEnum? x, TEnum? y) => EqualityComparer<TEnum?>.Default.Equals(x, y); |
|  |  |  |
|  |  | private class DateTimeOffsetEqualityComparer : CollisionResistantHasher<DateTimeOffset> |
|  |  | { |
|  |  | internal static new readonly DateTimeOffsetEqualityComparer Instance = new DateTimeOffsetEqualityComparer(); |
|  |  | public int GetHashCode(TEnum obj) => SecureHash(Unsafe.As<TEnum, TUnderlying>(ref obj)); |
|  |  |  |
|  |  | bool IEqualityComparer.Equals(object? x, object? y) => x is TEnum e1 && y is TEnum e2 && Equals(e1, e2); |
|  |  |  |
|  |  | public override unsafe int GetHashCode(DateTimeOffset value) => HashCode.Combine((int)(value.UtcTicks >> 32), unchecked((int)value.UtcTicks)); |
|  |  | int IEqualityComparer.GetHashCode(object obj) => GetHashCode((TEnum)obj); |
|  |  | } |
|  |  | } |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8e599af`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMessagePack-CSharp%2FMessagePack-CSharp%2Fcommit%2F8e599af0798b45008f8b293a7f233e4878f11ed5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


