

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3033889%2540email-encoder-bundle%252Ftrunk%26old%3D3020142%2540email-encoder-bundle%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3020142/email-encoder-bundle/trunk?old=3033889&old_path=%2Femail-encoder-bundle%2Ftrunk)

---

# Changes in [email-encoder-bundle/trunk](/browser/email-encoder-bundle/trunk?rev=3033889 "Show entry in browser") [[3020142:3033889]](/log/email-encoder-bundle/trunk?rev=3033889&stop_rev=3020142 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[email-encoder-bundle/trunk](/browser/email-encoder-bundle/trunk?rev=3033889)
Files:

7 edited

* [core/includes/classes/class-email-encoder-bundle-helpers.php](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-helpers.php?rev=3033889 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [core/includes/classes/class-email-encoder-bundle-run.php](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3033889 "Show entry in browser")
  (modified)
  ([7 diffs](#file1 "Show differences"))
* [core/includes/classes/class-email-encoder-bundle-settings.php](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-settings.php?rev=3033889 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [core/includes/classes/class-email-encoder-bundle-validate.php](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-validate.php?rev=3033889 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [core/includes/integrations/loader.php](/browser/email-encoder-bundle/trunk/core/includes/integrations/loader.php?rev=3033889 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [email-encoder-bundle.php](/browser/email-encoder-bundle/trunk/email-encoder-bundle.php?rev=3033889 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [readme.txt](/browser/email-encoder-bundle/trunk/readme.txt?rev=3033889 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-helpers.php](/changeset/3033889/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-helpers.php?old=2994384&old_path=email-encoder-bundle%2Ftrunk%2Fcore%2Fincludes%2Fclasses%2Fclass-email-encoder-bundle-helpers.php "Show the [3020142:3033889] differences restricted to email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-helpers.php")

  | [r3020142](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-helpers.php?rev=2994384#L268 "Show revision 3020142 of this file in browser") | [r3033889](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-helpers.php?rev=3033889#L268 "Show revision 3033889 of this file in browser") |  |
  | --- | --- | --- |
  | 268 | 268 | $sanitized\_name = sanitize\_key( $match[1] ); // Sanitize the attribute name |
  | 269 | 269 | $sanitized\_value = esc\_attr( trim( $match[2], '"\'' ) ); // Remove quotes and escape the value |
  |  | 270 | $sanitized\_value = str\_replace( '\\', '', $sanitized\_value ); // Remove quotes and escape the value |
  | 270 | 271 |  |
  | 271 | 272 | // Reconstruct the attribute |
* ## [email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php](/changeset/3033889/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?old=3020142&old_path=email-encoder-bundle%2Ftrunk%2Fcore%2Fincludes%2Fclasses%2Fclass-email-encoder-bundle-run.php "Show the [3020142:3033889] differences restricted to email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php")

  | [r3020142](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3020142#L431 "Show revision 3020142 of this file in browser") | [r3033889](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3033889#L431 "Show revision 3033889 of this file in browser") |  |
  | --- | --- | --- |
  | 431 | 431 | public function protect\_content\_shortcode( $atts, $content = null ){ |
  | 432 | 432 | $protect = (int) EEB()->settings->get\_setting( 'protect', true ); |
  |  | 433 | $allowed\_attr\_html = EEB()->settings->get\_safe\_html\_attr(); |
  | 433 | 434 | $protect\_using = (string) EEB()->settings->get\_setting( 'protect\_using', true ); |
  | 434 | 435 | $protection\_activated = ( $protect === 1 || $protect === 2 ) ? true : false; |
  | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3020142#L441) | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3033889#L442) |  |
  | 441 | 442 | $protect\_using = sanitize\_title( $atts['protect\_using'] ); |
  | 442 | 443 | } |
  |  | 444 |  |
  |  | 445 | //Filter content first |
  |  | 446 | $content = wp\_kses( html\_entity\_decode( $content ), $allowed\_attr\_html ); |
  | 443 | 447 |  |
  | 444 | 448 | $content = EEB()->validate->filter\_content( $content, $protect\_using ); |
  | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3020142#L472) | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3033889#L476) |  |
  | 472 | 476 |  |
  | 473 | 477 | $original\_content = $content; |
  |  | 478 | $allowed\_attr\_html = EEB()->settings->get\_safe\_html\_attr(); |
  | 474 | 479 | $show\_encoded\_check = (string) EEB()->settings->get\_setting( 'show\_encoded\_check', true ); |
  | 475 | 480 |  |
  | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3020142#L489) | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3033889#L494) |  |
  | 489 | 494 | $content = do\_shortcode( $content ); |
  | 490 | 495 | } |
  |  | 496 |  |
  |  | 497 | $content = wp\_kses( html\_entity\_decode( $content ), $allowed\_attr\_html ); |
  | 491 | 498 |  |
  | 492 | 499 | switch( $method ){ |
  | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3020142#L554) | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3033889#L561) |  |
  | 554 | 561 | } else { |
  | 555 | 562 | $display = wp\_kses( html\_entity\_decode( $atts['display'] ), $allowed\_attr\_html ); |
  |  | 563 | $display = str\_replace( '\\', '', $display ); //Additionally sanitize unicode |
  | 556 | 564 | } |
  | 557 | 565 |  |
  | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3020142#L560) | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3033889#L568) |  |
  | 560 | 568 | } else { |
  | 561 | 569 | $noscript = wp\_kses( html\_entity\_decode( $atts['noscript'] ), $allowed\_attr\_html ); |
  |  | 570 | $noscript = str\_replace( '\\', '', $noscript ); //Additionally sanitize unicode |
  | 562 | 571 | } |
  | 563 | 572 |  |
  | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3020142#L624) | […](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-run.php?rev=3033889#L633) |  |
  | 624 | 633 | $hash = (string) $\_GET['eeb\_hash']; |
  | 625 | 634 | $secret = EEB()->settings->get\_email\_image\_secret(); |
  |  | 635 |  |
  |  | 636 | if( ! function\_exists( 'imagefontwidth' ) ){ |
  |  | 637 | wp\_die( \_\_('GD Library Not Enabled. Please enable it first.', 'email-encoder-bundle') ); |
  |  | 638 | } |
  | 626 | 639 |  |
  | 627 | 640 | if( EEB()->validate->generate\_email\_signature( $email, $secret ) !== $hash ){ |
* ## [email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-settings.php](/changeset/3033889/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-settings.php?old=3020142&old_path=email-encoder-bundle%2Ftrunk%2Fcore%2Fincludes%2Fclasses%2Fclass-email-encoder-bundle-settings.php "Show the [3020142:3033889] differences restricted to email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-settings.php")

  | [r3020142](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-settings.php?rev=3020142#L148 "Show revision 3020142 of this file in browser") | [r3033889](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-settings.php?rev=3033889#L148 "Show revision 3033889 of this file in browser") |  |
  | --- | --- | --- |
  | 148 | 148 | \*/ |
  | 149 | 149 | private $email\_image\_secret; |
  |  | 150 |  |
  |  | 151 | /\*\* |
  |  | 152 | \* The template tags |
  |  | 153 | \* |
  |  | 154 | \* @var string |
  |  | 155 | \* @since 2.2.1 |
  |  | 156 | \*/ |
  |  | 157 | private $template\_tags; |
  | 150 | 158 |  |
  | 151 | 159 | /\*\* |
* ## [email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-validate.php](/changeset/3033889/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-validate.php?old=3020142&old_path=email-encoder-bundle%2Ftrunk%2Fcore%2Fincludes%2Fclasses%2Fclass-email-encoder-bundle-validate.php "Show the [3020142:3033889] differences restricted to email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-validate.php")

  | [r3020142](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-validate.php?rev=3020142#L992 "Show revision 3020142 of this file in browser") | [r3033889](/browser/email-encoder-bundle/trunk/core/includes/classes/class-email-encoder-bundle-validate.php?rev=3033889#L992 "Show revision 3033889 of this file in browser") |  |
  | --- | --- | --- |
  | 992 | 992 | public function generate\_email\_image\_url( $email ) { |
  | 993 | 993 |  |
  | 994 |  | if( empty( $email ) || ! is\_email( $email ) ){ |
  |  | 994 | if( ! function\_exists( 'imagefontwidth' ) || empty( $email ) || ! is\_email( $email ) ){ |
  | 995 | 995 | return false; |
  | 996 | 996 | } |
* ## [email-encoder-bundle/trunk/core/includes/integrations/loader.php](/changeset/3033889/email-encoder-bundle/trunk/core/includes/integrations/loader.php?old=2930022&old_path=email-encoder-bundle%2Ftrunk%2Fcore%2Fincludes%2Fintegrations%2Floader.php "Show the [3020142:3033889] differences restricted to email-encoder-bundle/trunk/core/includes/integrations/loader.php")

  | [r3020142](/browser/email-encoder-bundle/trunk/core/includes/integrations/loader.php?rev=2930022#L25 "Show revision 3020142 of this file in browser") | [r3033889](/browser/email-encoder-bundle/trunk/core/includes/integrations/loader.php?rev=3033889#L25 "Show revision 3033889 of this file in browser") |  |
  | --- | --- | --- |
  | 25 | 25 | 'oxygen\_builder' => 'oxygen\_builder.php', |
  | 26 | 26 | 'the\_events\_calendar' => 'the\_events\_calendar.php', |
  |  | 27 | 'wpml' => 'wpml.php', |
  | 27 | 28 | ); |
  | 28 | 29 |  |
* ## [email-encoder-bundle/trunk/email-encoder-bundle.php](/changeset/3033889/email-encoder-bundle/trunk/email-encoder-bundle.php?old=3020142&old_path=email-encoder-bundle%2Ftrunk%2Femail-encoder-bundle.php "Show the [3020142:3033889] differences restricted to email-encoder-bundle/trunk/email-encoder-bundle.php")

  | [r3020142](/browser/email-encoder-bundle/trunk/email-encoder-bundle.php?rev=3020142#L2 "Show revision 3020142 of this file in browser") | [r3033889](/browser/email-encoder-bundle/trunk/email-encoder-bundle.php?rev=3033889#L2 "Show revision 3033889 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\*\* |
  | 3 | 3 | \* Plugin Name:    Email Encoder - Protect Email Addresses |
  | 4 |  | \* Version:        2.2.~~0~~ |
  |  | 4 | \* Version:        2.2.1 |
  | 5 | 5 | \* Plugin URI:     https://wordpress.org/plugins/email-encoder-bundle/ |
  | 6 | 6 | \* Description:    Protect email addresses on your site and hide them from spambots. Easy to use & flexible. |
  | […](/browser/email-encoder-bundle/trunk/email-encoder-bundle.php?rev=3020142#L23) | […](/browser/email-encoder-bundle/trunk/email-encoder-bundle.php?rev=3033889#L23) |  |
  | 23 | 23 |  |
  | 24 | 24 | // Plugin version. |
  | 25 |  | define( 'EEB\_VERSION',        '2.2.~~0~~' ); |
  |  | 25 | define( 'EEB\_VERSION',        '2.2.1' ); |
  | 26 | 26 |  |
  | 27 | 27 | // Determines if the plugin is loaded |
* ## [email-encoder-bundle/trunk/readme.txt](/changeset/3033889/email-encoder-bundle/trunk/readme.txt?old=3020142&old_path=email-encoder-bundle%2Ftrunk%2Freadme.txt "Show the [3020142:3033889] differences restricted to email-encoder-bundle/trunk/readme.txt")

  | [r3020142](/browser/email-encoder-bundle/trunk/readme.txt?rev=3020142#L4 "Show revision 3020142 of this file in browser") | [r3033889](/browser/email-encoder-bundle/trunk/readme.txt?rev=3033889#L4 "Show revision 3033889 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 4.7 |
  | 5 | 5 | Requires PHP: 5.1 |
  | 6 |  | Tested up to: 6.4.~~2~~ |
  | 7 |  | Stable tag: 2.2.~~0~~ |
  |  | 6 | Tested up to: 6.4.3 |
  |  | 7 | Stable tag: 2.2.1 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/email-encoder-bundle/trunk/readme.txt?rev=3020142#L126) | […](/browser/email-encoder-bundle/trunk/readme.txt?rev=3033889#L126) |  |
  | 126 | 126 |  |
  | 127 | 127 | == Changelog == |
  |  | 128 |  |
  |  | 129 | = 2.2.1: February 11, 2024 = |
  |  | 130 | \* Tweak: Security Patch |
  |  | 131 | \* Tweak: Provide compatibility if GD Library Not Enabled |
  |  | 132 | \* Tweak: Compatibility with WP 6.4.3 |
  |  | 133 | \* Fix: Fixed some PHP 8.2+ notices |
  |  | 134 | \* Fix: Fixed Automatic Translations for WPML: https://wpml.org/errata/email-encoder-protect-email-addresses-and-phone-numbers-there-is-a-problem-connecting-to-automatic-translation/ |
  | 128 | 135 |  |
  | 129 | 136 | = 2.2.0: January 11, 2024 = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3033889&old=3020142&new_path=%2Femail-encoder-bundle%2Ftrunk&old_path=%2Femail-encoder-bundle%2Ftrunk)
* [Zip Archive](?format=zip&new=3033889&old=3020142&new_path=%2Femail-encoder-bundle%2Ftrunk&old_path=%2Femail-encoder-bundle%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

