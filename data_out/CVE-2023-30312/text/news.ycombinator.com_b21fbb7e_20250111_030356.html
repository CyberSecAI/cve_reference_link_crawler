

| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D40723150) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [Off-path TCP hijacking in NAT-enabled Wi-Fi networks](https://blog.apnic.net/2024/06/18/off-path-tcp-hijacking-in-nat-enabled-wi-fi-networks/) ([apnic.net](from?site=apnic.net)) | | --- | --- | --- | |  | | 211 points by [gtirloni](user?id=gtirloni) [6 months ago](item?id=40723150)  | [hide](hide?id=40723150&goto=item%3Fid%3D40723150) | [past](https://hn.algolia.com/?query=Off-path%20TCP%20hijacking%20in%20NAT-enabled%20Wi-Fi%20networks&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=40723150&auth=3e90c6d03b7f8bb5af2ffb6d8227c50c250ee79b) | [86 comments](item?id=40723150) |  | |  |  | [egberts1](user?id=egberts1) [6 months ago](item?id=40724468)   | [next](#40724573) [–]  A whitepaper detailing this CVE-2022-32296 attack. Vulnerability is in Double-Hash Port Selection (DHPS, IETF RFC 6056) Fixed in Linux 5.17.9 and above using a variant of DHPS. Linux sysctl: net.ipv4.conf.all.rp\_filter = 1 net.ipv4.conf.default.rp\_filter = 1 Also Firefox Only HTTPS must be enabled to prevent JavaScript from performing dwell on hidden unsecure HTTP DOM frame. ---- <https://support.mozilla.org/mk/questions/1359401> <https://arxiv.org/pdf/2209.12993> <https://github.com/0xkol/rfc6056-device-tracker> <https://www.rfc-editor.org/rfc/rfc6056.html> | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [sambazi](user?id=sambazi) [6 months ago](item?id=40726587)   | [parent](#40724468) | [next](#40724573) [–]  there is probably a reason that rp\_filter defaults to off though | | --- | --- | --- | | | |  |  | [chatmasta](user?id=chatmasta) [6 months ago](item?id=40728520)   | [root](#40724468) | [parent](#40726587) | [next](#40724573) [–]  Yes, I think disabling it allows for more hole-punching techniques, since you can basically maintain a TCP connection indefinitely and across network connectivity changes. | | --- | --- | --- | | | |  |  | [sambazi](user?id=sambazi) [6 months ago](item?id=40747128)   | [root](#40724468) | [parent](#40728520) | [next](#40724573) [–]  iirc more like that you basically need the 'loose mode' because most cpe's are bridging wireless and wired networks, but this then won't protect against the more serious shenanigans | | --- | --- | --- | | | |  |  | [blahgeek](user?id=blahgeek) [6 months ago](item?id=40724573)   | [prev](#40724468) | [next](#40729097) [–]  Is it common for routers to create a new mapping for TCP packets that is NOT SYN (in figure 3 in this article)? Is there a legit use case for this behavior? Wouldn't it be simpler and more secure not to do that? | | --- | --- | --- | | | |  |  | [ytch](user?id=ytch) [6 months ago](item?id=40725165)   | [parent](#40724573) | [next](#40727703) [–]  T̶a̶i̶l̶s̶c̶a̶l̶e̶: <https://tailscale.com/blog/how-nat-traversal-works> Libp2p: <https://docs.libp2p.io/concepts/nat/hole-punching/> B̶o̶t̶h̶ (update: Only Libp2p works with TCP) use similar method for hold-punching. Libp2p can use such method for establishing direct connection between hosts behind different NAT networks. | | --- | --- | --- | | | |  |  | [mkj](user?id=mkj) [6 months ago](item?id=40725306)   | [root](#40724573) | [parent](#40725165) | [next](#40727703) [–]  The tailscale one at least isn't TCP, it's UDP | | --- | --- | --- | | | |  |  | [ytch](user?id=ytch) [6 months ago](item?id=40725349)   | [root](#40724573) | [parent](#40725306) | [next](#40727703) [–]  My bad, I forget about this. | | --- | --- | --- | | | |  |  | [Wheaties466](user?id=Wheaties466) [6 months ago](item?id=40727703)   | [parent](#40724573) | [prev](#40725165) | [next](#40725934) [–]  im pretty sure any router that uses fast path does this. its meant to speed up connections and allow for more throughput through a router. | | --- | --- | --- | | | |  |  | [xxpor](user?id=xxpor) [6 months ago](item?id=40730057)   | [root](#40724573) | [parent](#40727703) | [next](#40725934) [–]  Connection tracking != fast path flow tracking in a lot of cases. | | --- | --- | --- | | | |  |  | [Wheaties466](user?id=Wheaties466) [6 months ago](item?id=40731232)   | [root](#40724573) | [parent](#40730057) | [next](#40725934) [–]  well yeah but one of the main reasons for a different path after a syn packet is fast path behavior. fast path changes the packet flow so it doesn't get processed by all firewall rules. just explaining the use case for OPs question. | | --- | --- | --- | | | |  |  | [patrakov](user?id=patrakov) [6 months ago](item?id=40725934)   | [parent](#40724573) | [prev](#40727703) | [next](#40725775) [–]  The legit use case is to pick up connections that were established before the router reboot. | | --- | --- | --- | | | |  |  | [blahgeek](user?id=blahgeek) [6 months ago](item?id=40726223)   | [root](#40724573) | [parent](#40725934) | [next](#40729756) [–]  If the router reboots, it cannot remember the correct mapping of the last connection, right? (The mapped port may not be the original source port) | | --- | --- | --- | | | |  |  | [r1ch](user?id=r1ch) [6 months ago](item?id=40726809)   | [root](#40724573) | [parent](#40726223) | [next](#40727683) [–]  That's why port preservation is the usual behavior. | | --- | --- | --- | | | |  |  | [patrakov](user?id=patrakov) [6 months ago](item?id=40727683)   | [root](#40724573) | [parent](#40726223) | [prev](#40726809) | [next](#40729756) [–]  (edited) Correct, this pickup of ports from the ACKs that the internal host keeps resending only works if the externally mapped port didn't change from the default (same as internal). | | --- | --- | --- | | | |  |  | [semi](user?id=semi) [6 months ago](item?id=40729756)   | [root](#40724573) | [parent](#40725934) | [prev](#40726223) | [next](#40725775) [–]  wouldn't it also work for connections established on another router that then failed or otherwise had traffic shift to it? | | --- | --- | --- | | | |  |  | [damsalor](user?id=damsalor) [6 months ago](item?id=40725775)   | [parent](#40724573) | [prev](#40725934) | [next](#40729097) [–]  The answer to this might be severely unsettling | | --- | --- | --- | | | |  |  | [reflexe](user?id=reflexe) [6 months ago](item?id=40729097)   | [prev](#40724573) | [next](#40723824) [–]  Maybe i am missing something but while it is interesting, I dont think it has any real security impact. Since the threat model is that the attacker and the victim are connected to the same router via the same wifi network, not isolated from each other, in a case where you are using wifi in psk for example, the attacker can already sniff everything from other clients. Therefore, you can spoof packets by just responding to them directly. It is a lot simpler and takes a lot less time (since you just need to respond faster than the server with the right seq and port numbers). Once you are in the same network you can do even crazier stuff like arp spoofing and then let the victim think that you are the router and convince it to send all of its packets to you (<https://en.m.wikipedia.org/wiki/ARP_spoofing>) Edit: on a second thought, maybe in a use case where the victim and the attacker are in different wifi networks (or just configured to be isolated ), the attacker should be able to perform a denial of service for a specific ip:port by sending RST and then ACK with every possible source port. | | --- | --- | --- | | | |  |  | [vass77](user?id=vass77) [6 months ago](item?id=40819241)   | [parent](#40729097) | [next](#40723824) [–]  Also only works with non encrypted conns (ftp, http), that one should not be using. And like you say on open or PSK networks you can do worst stuff (if isolation is not enable arp spoofing the default G will be way worst then this) | | --- | --- | --- | | | |  |  | [theamk](user?id=theamk) [6 months ago](item?id=40723824)   | [prev](#40729097) | [next](#40724627) [–]  Feels much less scary in 2024.. when was the last time you used HTTP for anything important? | | --- | --- | --- | | | |  |  | [supriyo-biswas](user?id=supriyo-biswas) [6 months ago](item?id=40723965)   | [parent](#40723824) | [next](#40724184) [–]  These are not theoretical concerns though. For example, since SSH uses a trust on first use model as opposed to a central trust/web of trust model, they can direct the victim to a different SSH server if they're connecting to a new one, and intercept all traffic. (Edit: Even with HTTPS, there are other ways to MITM a connection because each trusted CA is considered an equal. For example, instead of doing a full-on MITM on a service which is likely to be detected[1], a better solution may be to obtain a certificate and target the specific user.) [1] <http://notes.valdikss.org.ru/jabber.ru-mitm/> | | --- | --- | --- | | | |  |  | [theamk](user?id=theamk) [6 months ago](item?id=40724848)   | [root](#40723824) | [parent](#40723965) | [next](#40727231) [–]  Re SSH: sure, it can happen, but in practice I'd rate this pretty low with most SSH users... (1) You need new host which hasn't been TOFU'd yet, and you need it to be exposed to internet with no VPN/mesh inbetween. (2) You need password-based authentication \_or\_ agent forwarding, otherwise you won't be able to intercept traffic (with key-based auth, you can pretend to be the server, but that won't likely to last long). While I would not say that everyone uses key-based ssh, they should! It's an easy way to significantly increase your SSH security level. As for HTTPs MITM, I don't see how this applies. They had to intercept traffic next to a server to be able to issue certificate - and I am pretty sure no one runs servers from the untrusted coffee shop connection! And you already have access to the server's datacenter, then there is no need to exploit public WiFi, you can intercept the server's traffic directly. | | --- | --- | --- | | | |  |  | [tsimionescu](user?id=tsimionescu) [6 months ago](item?id=40725556)   | [root](#40723824) | [parent](#40724848) | [next](#40725487) [–]  The HTTPS MITM case doesn't need to intercept close to the server, it just needs to know that Victim is trying to talk to a particular server. Then, they obtain a forged certificate, and use the same mechanism shown here to intercept the TLS ClientHello and pretend to be the TLS server, with the legitimate certificate. The reason this works is because in a targetted attack, it's much less likely that the improperly issued certificate would become public and (1) be revoked, and (2) cause problems for the CA that issued it. | | --- | --- | --- | | | |  |  | [tjoff](user?id=tjoff) [6 months ago](item?id=40725487)   | [root](#40723824) | [parent](#40724848) | [prev](#40725556) | [next](#40727231) [–]  2: key based ssh won't really help and isn't the magic bullet people seem to believe. Especially nonencrypted ssh keys which is what the majority uses. | | --- | --- | --- | | | |  |  | [theamk](user?id=theamk) [6 months ago](item?id=40729378)   | [root](#40723824) | [parent](#40725487) | [next](#40727231) [–]  sure it is, as long as you don't have agent forwarding 1. The ssh connection is intercepted, malicious server lets accepts arbitrary user's public key 2. Malicious server tries to connect to real server and fails - original pubkey authentication was channel-bound and cannot be reused 3. Malicious server now has to pretend to be the real server without knowing what the real server looks like. User immediately detects the shell prompt is different, the hostname is wrong, all the files are missing, etc... and disconnects. (You can make some sort of contrived situation, like you only ssh'd to restart service, \_and\_ you used "sudo" with password \_and\_ you used ssh command so you didn't see the prompt \_and\_ this was the first command you did on your new computer... but this seems pretty unlikely) And encrypted vs non-encrypted keys seems completely unrelated to connection interception attacks - who cares how the keys are stored on the computer? It's all the same on the wire. | | --- | --- | --- | | | |  |  | [tjoff](user?id=tjoff) [6 months ago](item?id=40835500)   | [root](#40723824) | [parent](#40729378) | [next](#40727231) [–]  You assume that the server already knows the key though? The assumption was that it is the first time they connect. Which if so would mean that the key was configured out of band, but if we add that possibility you can do the TOFU out of band as well. Yes, it is more common to transfer keys out of band - but it is getting a bit contrived. | | --- | --- | --- | | | |  |  | [themoonisachees](user?id=themoonisachees) [6 months ago](item?id=40727231)   | [root](#40723824) | [parent](#40723965) | [prev](#40724848) | [next](#40724251) [–]  This specific attack is unable to exploit this, because it requires that the TCP connection be already established. By the time the user had gotten the server's public key, you are unable to hijack the connection. | | --- | --- | --- | | | |  |  | [foobiekr](user?id=foobiekr) [6 months ago](item?id=40724251)   | [root](#40723824) | [parent](#40723965) | [prev](#40727231) | [next](#40726044) [–]  [https://www.usenix.org/system/files/login/articles/105484-Gu...](https://www.usenix.org/system/files/login/articles/105484-Gutmann.pdf) Abstract: No. | | --- | --- | --- | | | |  |  | [megous](user?id=megous) [6 months ago](item?id=40726044)   | [root](#40723824) | [parent](#40723965) | [prev](#40724251) | [next](#40723974) [–]  > "since SSH uses a trust on first use model" ...can use... | | --- | --- | --- | | | |  |  | [SebFender](user?id=SebFender) [6 months ago](item?id=40723974)   | [root](#40723824) | [parent](#40723965) | [prev](#40726044) | [next](#40724184) [–]  There's another great example - perfect comment. | | --- | --- | --- | | | |  |  | [fullspectrumdev](user?id=fullspectrumdev) [6 months ago](item?id=40724184)   | [parent](#40723824) | [prev](#40723965) | [next](#40723969) [–]  From recent efforts sniffing packets in public areas to specifically try answer this question: there’s still an assload of plaintext HTTP. | | --- | --- | --- | | | |  |  | [SebFender](user?id=SebFender) [6 months ago](item?id=40723969)   | [parent](#40723824) | [prev](#40724184) | [next](#40724627) [–]  Never think HTTPS will save you from proxies built by attackers... This may make it much simpler... | | --- | --- | --- | | | |  |  | [theamk](user?id=theamk) [6 months ago](item?id=40724872)   | [root](#40723824) | [parent](#40723969) | [next](#40724346) [–]  Sure they will, given Chrome's requirement for CT logs, any attacker-issued certificates will be logged, someone will find the suspicious record, and the method will likely be burned from all the publicity. I have no doubt that there maybe a few dozen people in the entire world who would get attacked this way, but the chances it would be me are pretty much zero. | | --- | --- | --- | | | |  |  | [8organicbits](user?id=8organicbits) [6 months ago](item?id=40727090)   | [root](#40723824) | [parent](#40724872) | [next](#40724346) [–]  How often are you reviewing the CT logs for your domains? I posit that's rare. | | --- | --- | --- | | | |  |  | [immibis](user?id=immibis) [6 months ago](item?id=40727469)   | [root](#40723824) | [parent](#40727090) | [next](#40724346) [–]  BTW this attack actually happened with jabber.ru - "law" "enforcement" physically intercepted their Ethernet port, then they got to use their IP address and could issue new certificates. | | --- | --- | --- | | | |  |  | [8organicbits](user?id=8organicbits) [6 months ago](item?id=40734979)   | [root](#40723824) | [parent](#40727469) | [next](#40728959) [–]  Rare was intended to refer to "the monitoring of CT logs". The CA system doesn't protect against an adversary who has physical control of your system. | | --- | --- | --- | | | |  |  | [debatem1](user?id=debatem1) [6 months ago](item?id=40728959)   | [root](#40723824) | [parent](#40727469) | [prev](#40734979) | [next](#40724346) [–]  Do you happen to have a link or any other information about this? | | --- | --- | --- | | | |  |  | [immibis](user?id=immibis) [6 months ago](item?id=40733810)   | [root](#40723824) | [parent](#40728959) | [next](#40724346) [–]  <https://notes.valdikss.org.ru/jabber.ru-mitm/> <https://news.ycombinator.com/item?id=37961166> | | --- | --- | --- | | | |  |  | [SteveNuts](user?id=SteveNuts) [6 months ago](item?id=40724346)   | [root](#40723824) | [parent](#40723969) | [prev](#40724872) | [next](#40724627) [–]  Wouldn’t there still need to be a major vulnerability with the TLS library your client is using? | | --- | --- | --- | | | |  |  | [supriyo-biswas](user?id=supriyo-biswas) [6 months ago](item?id=40724392)   | [root](#40723824) | [parent](#40724346) | [next](#40724627) [–]  You can obtain a certificate for the domain in question (easier if you are a nation-state) and MITM that specific user. | | --- | --- | --- | | | |  |  | [yjftsjthsd-h](user?id=yjftsjthsd-h) [6 months ago](item?id=40725235)   | [root](#40723824) | [parent](#40724392) | [next](#40724876) [–]  How does one bypass certificate transparency? I tend to exclude state actors from my threat models (1. they tend to be the all-powerful boogeyman that bypasses all threat models anyways, and 2. I doubt that the NSA is going to get you by way of coffee shop wifi) but I'm actually struggling to see how even they would bypass this particular protection; if Chrome only trusts CT-logged certs, even a targeted one-off is likely to be discovered (albeit, AIUI, after the fact). | | --- | --- | --- | | | |  |  | [theamk](user?id=theamk) [6 months ago](item?id=40724876)   | [root](#40723824) | [parent](#40724392) | [prev](#40725235) | [next](#40724627) [–]  ... but you need to MITM server to obtain certificate, and if you can MITM server, why bother with user's wifi? | | --- | --- | --- | | | |  |  | [supriyo-biswas](user?id=supriyo-biswas) [6 months ago](item?id=40725130)   | [root](#40723824) | [parent](#40724876) | [next](#40724627) [–]  Because it’s easier that the server be MITMed for a shorter duration to prevent discovery[1]. It’s also easier if you can just strong arm the CA to issue a certificate or have the shady CA issue it[2][3]. [1] <http://notes.valdikss.org.ru/jabber.ru-mitm/> [2] <https://www.wired.com/2010/03/packet-forensics/> [3] <https://bugzilla.mozilla.org/show_bug.cgi?id=1391063> | | --- | --- | --- | | | |  |  | [fulafel](user?id=fulafel) [6 months ago](item?id=40724627)   | [prev](#40723824) | [next](#40724012) [–]  Always nice to have more security arguments against NAT. | | --- | --- | --- | | | |  |  | [sambazi](user?id=sambazi) [6 months ago](item?id=40726335)   | [parent](#40724627) | [next](#40724012) [–]  because there are so few of them? | | --- | --- | --- | | | |  |  | [orangeboats](user?id=orangeboats) [6 months ago](item?id=40734378)   | [root](#40724627) | [parent](#40726335) | [next](#40724012) [–]  Among all adjectives to describe the security issues of NAT, "few" is not one of them. \_Especially\_ when you remember that many are under the false impression that they are "protected" by NAT. | | --- | --- | --- | | | |  |  | [sambazi](user?id=sambazi) [6 months ago](item?id=40747090)   | [root](#40724627) | [parent](#40734378) | [next](#40724012) [–]  imo the protection is real and a good tradeoff for a research project to become a mass medium (i.e. clients usually don't want incoming connections from the internet[1]) don't get me wrong, i like a global address space as much as the next internet native, but it's not for everyone to pay the price for it and nat makes it easy to opt-out of a large portion of the problem space. [1] my university used to give public-routed v4 to students connecting their winxp laptop to the network; guess what happend | | --- | --- | --- | | | |  |  | [fulafel](user?id=fulafel) [6 months ago](item?id=40760419)   | [root](#40724627) | [parent](#40747090) | [next](#40724012) [–]  This seems to suffer from the common reasoning error of equating addressability with reachability. Your university can disable public reachability without NAT eg using firewalling. | | --- | --- | --- | | | |  |  | [aidenn0](user?id=aidenn0) [6 months ago](item?id=40724012)   | [prev](#40724627) | [next](#40725913) [–]  Anyone know if the MASQUERADE support in Linux iptables is affected by this? Or how I could tell? | | --- | --- | --- | | | |  |  | [zootboy](user?id=zootboy) [6 months ago](item?id=40724222)   | [parent](#40724012) | [next](#40724249) [–]  Well, of the three mitigations suggested in the article: 1 - Random NAT port allocation Seems like the answer is "not by default." According to iptables(8), SNAT defaults to using the pre-translated ports whenever possible, so it's up to the connecting client (victim's TCP stack) to randomly select source ports. There is a "--to-ports" option that lets you limit the usable source ports, but it's not mentioned how the ports are selected in that case. 2 - Reverse Path Validation I'm not really sure how this helps in the described situation. If the attacker and the victim are on the same wifi access point, then both of their traffic will be sourced from the same network interface, so even strict RFC 3704 validation will pass for spoofed packets from the attacker. But for completeness, you can turn that on by setting a sysctl (rp\_filter = 1). 3 - TCP window checking I \_believe\_ that the vanilla linux kernel does check this by default, as the mentioned adjustments to OpenWRT seem to be removing a non-standard option to disable the TCP window checking [https://github.com/openwrt/openwrt/commit/75e78bcaab847557ce...](https://github.com/openwrt/openwrt/commit/75e78bcaab847557ce1782eb2dea9dff9a029171) | | --- | --- | --- | | | |  |  | [fanf2](user?id=fanf2) [6 months ago](item?id=40727065)   | [root](#40724012) | [parent](#40724222) | [next](#40729302) [–]  The attack uses packets sent from the WiFi side to the WAN IP address, which is what reverse path filtering prevents. | | --- | --- | --- | | | |  |  | [zootboy](user?id=zootboy) [6 months ago](item?id=40729088)   | [root](#40724012) | [parent](#40727065) | [next](#40729302) [–]  Ah, yes, that's the detail I missed for why #2 is relevant. So the answer to #2 is "not by default, but easy to enable." Though other comment threads here have discussed the potential for this to impact NAT hole punching. | | --- | --- | --- | | | |  |  | [aidenn0](user?id=aidenn0) [6 months ago](item?id=40729302)   | [root](#40724012) | [parent](#40724222) | [prev](#40727065) | [next](#40724249) [–]  For those looking for rp\_filter it is ```   net.ipv4.conf.all.rp_filter  ``` (or replace "all" with a device name to turn it on for just one device). | | --- | --- | --- | | | |  |  | [Joel\_Mckay](user?id=Joel_Mckay) [6 months ago](item?id=40724249)   | [parent](#40724012) | [prev](#40724222) | [next](#40724198) [–]  In general there are usually rules that prevent cross-forwarding traffic, and thus traffic over wifi is isolated from each client (unless you need to share a home NAS/printer this should remain enabled.) Most if not all modern routers have this feature, and also the ability to turn off the dumpster-fire that is UPnP and flaky port-trigger mods. Additionally, some add packet marking rules, which is often also used to enforce fair bandwidth sharing. Yet note this can be a nonstandard controversial gray-area. One could also use a private cert based VPN + Kerberos with firewall client pre-set rules on any un-trusted/open access points. YMMV, =3 | | --- | --- | --- | | | |  |  | [lathiat](user?id=lathiat) [6 months ago](item?id=40724198)   | [parent](#40724012) | [prev](#40724249) | [next](#40725913) [–]  I would have assumed linux conntrack to do more rigorous "tcp window checking" as an assumption, however the article also notes they received a positive response from OpenWRT who implemented a mitigation, so I am curious to see the details of that mitigation. | | --- | --- | --- | | | |  |  | [taneliv](user?id=taneliv) [6 months ago](item?id=40725230)   | [root](#40724012) | [parent](#40724198) | [next](#40725913) [–]  As user zootboy above comments, OpenWRT removed a patch from their kernels that introduced a "no window checking" option for TCP processing,[1] which I suppose was enabled by default. [1] [https://github.com/openwrt/openwrt/commit/75e78bcaab847557ce...](https://github.com/openwrt/openwrt/commit/75e78bcaab847557ce1782eb2dea9dff9a029171) | | --- | --- | --- | | | |  |  | [xxpor](user?id=xxpor) [6 months ago](item?id=40730125)   | [root](#40724012) | [parent](#40725230) | [next](#40725913) [–]  Note that this means that conntrack's window tracking has to be perfectly in sync with both endpoints (assuming TCP invalids are dropped). Given endpoints tend to be updated more often than middleboxes, this isn't a great assumption to make. | | --- | --- | --- | | | |  |  | [hamilyon2](user?id=hamilyon2) [6 months ago](item?id=40725913)   | [prev](#40724012) | [next](#40726104) [–]  I always found it astonishing that security and integrity of the internet often rests upon “but TCP sequence numbers are unguessable” | | --- | --- | --- | | | |  |  | [suprjami](user?id=suprjami) [6 months ago](item?id=40726272)   | [parent](#40725913) | [next](#40727461) [–]  TCP sequence numbers are not a security mechanism, they are a data ordering mechanism. If you want security, use encryption like IPSec or TLS. This has been the state of things since TCP was invented in 1980. Someone new discovers it all the time. | | --- | --- | --- | | | |  |  | [sambazi](user?id=sambazi) [6 months ago](item?id=40726326)   | [root](#40725913) | [parent](#40726272) | [next](#40727461) [–]  security is never perfect and the bar is rising. sequence numbers were once considered 'good enough' as prime-factors are today | | --- | --- | --- | | | |  |  | [immibis](user?id=immibis) [6 months ago](item?id=40727461)   | [parent](#40725913) | [prev](#40726272) | [next](#40736022) [–]  They are effectively authentication cookies, but the cookies are too short, but at least they turn over frequently and you have to send a few gigabytes of data to guess one. Almost every internet security mechanism relies on nobody guessing secret numbers, but normally they are sized appropriately. | | --- | --- | --- | | | |  |  | [goodpoint](user?id=goodpoint) [6 months ago](item?id=40736022)   | [parent](#40725913) | [prev](#40727461) | [next](#40726104) [–]  That's why we had to invent TLS (and now QUIC) | | --- | --- | --- | | | |  |  | [the8472](user?id=the8472) [6 months ago](item?id=40726104)   | [prev](#40725913) | [next](#40723984) [–]  Since this is caused by many-to-one NATs IPv6 should be immune to this. Migrating to ipv6 should be listed as one of the mitigations. | | --- | --- | --- | | | |  |  | [suprjami](user?id=suprjami) [6 months ago](item?id=40726241)   | [parent](#40726104) | [next](#40723984) [–]  Good thing the IEEE recommended against implementing IPv6 NAT and everyone followed that rec- oh, wait. | | --- | --- | --- | | | |  |  | [the8472](user?id=the8472) [6 months ago](item?id=40726363)   | [root](#40726104) | [parent](#40726241) | [next](#40727708) [–]  IEEE? You mean the IETF? And I explicitly said "many-to-one NATs" to not have to quibble about network-prefix-mapping NATs like NAT66 which are not deployed in coffee shops anyway. | | --- | --- | --- | | | |  |  | [throw0101c](user?id=throw0101c) [6 months ago](item?id=40727708)   | [root](#40726104) | [parent](#40726241) | [prev](#40726363) | [next](#40723984) [–]  Strictly speaking NAT66 does not have any kind of specification, so implementations are 'vendor specific': \* [https://blogs.infoblox.com/ipv6-coe/you-thought-there-was-no...](https://blogs.infoblox.com/ipv6-coe/you-thought-there-was-no-nat-for-ipv6-but-nat-still-exists/) NPTv6 is slightly different in that there really isn't address-port state (though an SPI firewall could track connection state), but the first /64 of the address is swapped about, and everything else should be left alone: \* <https://datatracker.ietf.org/doc/html/rfc6296> (Of course I often get grief in networking forums for mentioning NPTv6 because it's "only" an Experimental RFC, and not Standards track.) The main reason to use these mechanisms is either frequent prefix changes or multi-homing, though documents have been written on how to deal with those situations without translation (often in combination with ULA): \* <https://datatracker.ietf.org/doc/html/rfc7157> \* <https://datatracker.ietf.org/doc/html/rfc8678> | | --- | --- | --- | | | |  |  | [binkHN](user?id=binkHN) [6 months ago](item?id=40723984)   | [prev](#40726104) | [next](#40724037) [–]  Ouch. I bet the majority of coffee shops are affected. | | --- | --- | --- | | | |  |  | [hackernudes](user?id=hackernudes) [6 months ago](item?id=40724080)   | [parent](#40723984) | [next](#40724037) [–]  Would client isolation prevent the attacker at the layer 2 level? | | --- | --- | --- | | | |  |  | [sambazi](user?id=sambazi) [6 months ago](item?id=40726512)   | [root](#40723984) | [parent](#40724080) | [next](#40724037) [–]  i don't think so because attacker-to-client communication is only used to restore the original nat-mapping. otoh ap-isolation isn't really a security feature but enhances spectrum efficiency by suppressing client-to-client communication. most wifi's are susceptible to the 'evil twin' attack. | | --- | --- | --- | | | |  |  | [vzaliva](user?id=vzaliva) [6 months ago](item?id=40724037)   | [prev](#40723984) | [next](#40767927) [–]  I assume a VPN should mitigate these attacks? | | --- | --- | --- | | | |  |  | [bustling-noose](user?id=bustling-noose) [6 months ago](item?id=40724205)   | [parent](#40724037) | [next](#40724257) [–]  You might still experience DOS attacks. | | --- | --- | --- | | | |  |  | [vzaliva](user?id=vzaliva) [6 months ago](item?id=40724438)   | [root](#40724037) | [parent](#40724205) | [next](#40724257) [–]  But only if my VPN is using TCP transport, right? | | --- | --- | --- | | | |  |  | [bustling-noose](user?id=bustling-noose) [6 months ago](item?id=40726090)   | [root](#40724037) | [parent](#40724438) | [next](#40724257) [–]  Yes. With UDP VPN this shouldn’t be a problem I guess. | | --- | --- | --- | | | |  |  | [vzaliva](user?id=vzaliva) [6 months ago](item?id=40729883)   | [root](#40724037) | [parent](#40726090) | [next](#40743678) [–]  I think IPSec is also safe as it neither UDP or TCP. | | --- | --- | --- | | | |  |  | [forrune01](user?id=forrune01) [6 months ago](item?id=40743678)   | [root](#40724037) | [parent](#40726090) | [prev](#40729883) | [next](#40724257) [–]  Ok | | --- | --- | --- | | | |  |  | [johnklos](user?id=johnklos) [6 months ago](item?id=40724257)   | [parent](#40724037) | [prev](#40724205) | [next](#40767927) [–]  No. | | --- | --- | --- | | | |  |  | [Joel\_Mckay](user?id=Joel_Mckay) [6 months ago](item?id=40724312)   | [root](#40724037) | [parent](#40724257) | [next](#40767927) [–]  Kerberos | | --- | --- | --- | | | |  |  | [Xocial](user?id=Xocial) [6 months ago](item?id=40767927)   | [prev](#40724037) | [next](#40727748) [–]  125.135.80.59 | | --- | --- | --- | | | |  |  | [Wheaties466](user?id=Wheaties466) [6 months ago](item?id=40727748)   | [prev](#40767927) | [next](#40724099) [–]  yet another use case for RFC 3704, Reverse path validation. | | --- | --- | --- | | | |  |  | [MacrohardDoors](user?id=MacrohardDoors) [6 months ago](item?id=40724099)   | [prev](#40727748) [–]  If only my iPhone had an ethernet port, I’d be able to go completely wifi free. | | --- | --- | --- | | | |  |  | [khrbtxyz](user?id=khrbtxyz) [6 months ago](item?id=40724120)   | [parent](#40724099) | [next](#40724250) [–]  [https://www.apple.com/shop/product/HMJU2ZM/A/belkin-ethernet...](https://www.apple.com/shop/product/HMJU2ZM/A/belkin-ethernet-power-adapter-with-lightning-connector) | | --- | --- | --- | | | |  |  | [bustling-noose](user?id=bustling-noose) [6 months ago](item?id=40724158)   | [root](#40724099) | [parent](#40724120) | [next](#40724250) [–]  With usb c this is even cheaper and easier. | | --- | --- | --- | | | |  |  | [tichiian](user?id=tichiian) [6 months ago](item?id=40726096)   | [root](#40724099) | [parent](#40724158) | [next](#40724250) [–]  I'd guess apple would invent some "made for iCrap" certification plus parts authentication to keep prices up and skim off some money for themselves. | | --- | --- | --- | | | |  |  | [doublepg23](user?id=doublepg23) [6 months ago](item?id=40730742)   | [root](#40724099) | [parent](#40726096) | [next](#40724250) [–]  What’s the point of getting angry at a fictional product? They sell a generic USB-C Ethernet adapter for $30 <https://store.apple.com/xc/product/HJKF2ZM/A> | | --- | --- | --- | | | |  |  | [eru](user?id=eru) [6 months ago](item?id=40724250)   | [parent](#40724099) | [prev](#40724120) [–]  You can make a local bluetooth network, too. | | --- | --- | --- | | | |  |  | [MacrohardDoors](user?id=MacrohardDoors) [6 months ago](item?id=40739912)   | [root](#40724099) | [parent](#40724250) [–]  I do not like using Bluetooth. As soon as I figured out how to do bluetooth hacking on my Flipper Zero, I stopped using bluetooth - it is completely vulnerable to the same kinds of attacks BadUSB can do. Scary! | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |

