The provided content relates to CVE-2024-39228.

**Root Cause:** The vulnerability stems from the lack of proper sanitization of user-supplied input when handling OpenVPN configuration files through the Ovpn API. Specifically, filenames passed to the `tar` command are not properly validated, allowing for shell command injection.

**Vulnerabilities:**
- **Shell Injection:**  Malicious shell commands can be embedded within the filename of a configuration file, and these are executed when the `tar` utility is used to create an archive.
- **Lack of Input Sanitization:** The application does not sanitize or validate filenames before passing them to the system command.

**Impact:**
- **Arbitrary Code Execution:** Attackers can execute arbitrary shell commands on the vulnerable routers, potentially leading to complete system compromise.
- **Router Manipulation:** The attacker can fully control the router, allowing them to modify settings, steal data, or use the device as part of a botnet.

**Attack Vectors:**
- **Web Application Upload Function:** The primary attack vector involves using the web application's upload function for OpenVPN configuration files.
- **Ovpn API Interface:** The attacker crafts a malicious payload through the interface by including shell commands in filenames.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to access the web interface of the affected router and have the ability to upload OpenVPN configuration files, or have authenticated access to the router's API.
- The attacker needs to be able to create a malicious file with injected shell commands.
- The attacker also needs to have the ability to monitor for connections returning from the compromised device.

**Additional Details:**

- The document provides specific steps to reproduce the vulnerability, including creating a configuration file with a shell command in the filename, creating a tar archive from this file, uploading it via the web interface and listening to incoming connections.
- It lists the affected GL.iNet product models and their vulnerable firmware versions, as well as the fixed versions.
- The exploitation details specify that a valid administrative token may be required as a parameter for successful execution after authentication.