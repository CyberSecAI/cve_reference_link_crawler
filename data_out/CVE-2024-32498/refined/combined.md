=== Content from www.openwall.com_e4e82efa_20250111_111749.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2024/07/03/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240702150121.fxt4445gwlrxwk3r@yuggoth.org>
Date: Tue, 2 Jul 2024 15:01:21 +0000
From: Jeremy Stanley <fungi@...goth.org>
To: oss-security@...ts.openwall.com
Subject: [OSSA-2024-001] OpenStack Cinder, Glance, Nova: Arbitrary file
 access through custom QCOW2 external data (CVE-2024-32498)

=======================================================================
OSSA-2024-001: Arbitrary file access through custom QCOW2 external data
=======================================================================

:Date: July 02, 2024
:CVE: CVE-2024-32498

Affects
~~~~~~~
- Cinder: <22.1.3, >=23.0.0 <23.1.1, ==24.0.0
- Glance: <26.0.1, ==27.0.0, >=28.0.0 <28.0.2
- Nova: <27.3.1, >=28.0.0 <28.1.1, >=29.0.0 <29.0.3

Description
~~~~~~~~~~~
Martin Kaesberger reported a vulnerability in QCOW2 image processing
for Cinder, Glance and Nova. By supplying a specially created QCOW2
image which references a specific data file path, an authenticated
user may convince systems to return a copy of that file's contents
from the server resulting in unauthorized access to potentially
sensitive data. All Cinder deployments are affected; only Glance
deployments with image conversion enabled are affected; all Nova
deployments are affected.

Patches
~~~~~~~
- <https://review.opendev.org/923247> (2023.1/antelope(cinder))
- <https://review.opendev.org/923277> (2023.1/antelope(glance))
- <https://review.opendev.org/923278> (2023.1/antelope(glance))
- <https://review.opendev.org/923279> (2023.1/antelope(glance))
- <https://review.opendev.org/923280> (2023.1/antelope(glance))
- <https://review.opendev.org/923281> (2023.1/antelope(glance))
- <https://review.opendev.org/923282> (2023.1/antelope(glance))
- <https://review.opendev.org/923283> (2023.1/antelope(glance))
- <https://review.opendev.org/923288> (2023.1/antelope(nova))
- <https://review.opendev.org/923289> (2023.1/antelope(nova))
- <https://review.opendev.org/923290> (2023.1/antelope(nova))
- <https://review.opendev.org/923281> (2023.1/antelope(nova))
- <https://review.opendev.org/923246> (2023.2/bobcat(cinder))
- <https://review.opendev.org/923266> (2023.2/bobcat(glance))
- <https://review.opendev.org/923267> (2023.2/bobcat(glance))
- <https://review.opendev.org/923268> (2023.2/bobcat(glance))
- <https://review.opendev.org/923269> (2023.2/bobcat(glance))
- <https://review.opendev.org/923270> (2023.2/bobcat(glance))
- <https://review.opendev.org/923271> (2023.2/bobcat(glance))
- <https://review.opendev.org/923272> (2023.2/bobcat(glance))
- <https://review.opendev.org/923284> (2023.2/bobcat(nova))
- <https://review.opendev.org/923285> (2023.2/bobcat(nova))
- <https://review.opendev.org/923286> (2023.2/bobcat(nova))
- <https://review.opendev.org/923287> (2023.2/bobcat(nova))
- <https://review.opendev.org/923245> (2024.1/caracal(cinder))
- <https://review.opendev.org/923259> (2024.1/caracal(glance))
- <https://review.opendev.org/923260> (2024.1/caracal(glance))
- <https://review.opendev.org/923261> (2024.1/caracal(glance))
- <https://review.opendev.org/923262> (2024.1/caracal(glance))
- <https://review.opendev.org/923263> (2024.1/caracal(glance))
- <https://review.opendev.org/923264> (2024.1/caracal(glance))
- <https://review.opendev.org/923265> (2024.1/caracal(glance))
- <https://review.opendev.org/923273> (2024.1/caracal(nova))
- <https://review.opendev.org/923274> (2024.1/caracal(nova))
- <https://review.opendev.org/923275> (2024.1/caracal(nova))
- <https://review.opendev.org/923276> (2024.1/caracal(nova))
- <https://review.opendev.org/923244> (2024.2/dalmatian(cinder))
- <https://review.opendev.org/923248> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923249> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923250> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923251> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923252> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923253> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923254> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923255> (2024.2/dalmatian(nova))
- <https://review.opendev.org/923256> (2024.2/dalmatian(nova))
- <https://review.opendev.org/923257> (2024.2/dalmatian(nova))
- <https://review.opendev.org/923258> (2024.2/dalmatian(nova))

Credits
~~~~~~~
- Martin Kaesberger (CVE-2024-32498)

References
~~~~~~~~~~
- <https://launchpad.net/bugs/2059809>
- <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-32498>

Notes
~~~~~
- Due to the scope of the problem and complexity of the resulting
  fixes, regressions and additional bypasses were reported in the
  original bug by downstream stakeholders during the coordinated
  disclosure period. As a result, our initially chosen publication
  date was rescheduled, which put the advisory four days past our
  promised ninety day maximum embargo length. Additional revised
  patches and regression fixes were supplied to stakeholders as soon
  as possible, but we understand the unfortunate timing of these
  last-minute changes resulted in a lot of additional work for
  everyone involved.

--
Jeremy Stanley
OpenStack Vulnerability Management Team

Download attachment "[signature.asc](2/1)" of type "application/pgp-signature" (964 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from launchpad.net_72d5848c_20250111_111747.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA-2024-001] Arbitrary file access through QCOW2 external data file (CVE-2024-32498)

Bug #2059809 reported by
[Martin Kaesberger](https://launchpad.net/~mkaesberger)
on 2024-03-29

[376](/%2Bhelp-bugs/bug-heat.html)

This bug affects 5 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Cinder](https://bugs.launchpad.net/cinder) | Fix Released | Critical | [Brian Rosmaita](https://launchpad.net/~brian-rosmaita) |  |
|  | [Glance](https://bugs.launchpad.net/glance) | Fix Released | Critical | [Dan Smith](https://launchpad.net/~danms) |  |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | Critical | [Sylvain Bauza](https://launchpad.net/~sylvain-bauza) |  |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | High | [Jeremy Stanley](https://launchpad.net/~fungi) |  |
|  | [Ubuntu Cloud Archive](https://bugs.launchpad.net/cloud-archive) | Fix Released | Undecided | Unassigned |  |
|  | [Antelope](https://bugs.launchpad.net/cloud-archive/antelope) | Fix Released | Undecided | Unassigned |  |
|  | [Bobcat](https://bugs.launchpad.net/cloud-archive/bobcat) | Fix Released | Undecided | Unassigned |  |
|  | [Caracal](https://bugs.launchpad.net/cloud-archive/caracal) | Fix Released | Undecided | Unassigned |  |
|  | [Ussuri](https://bugs.launchpad.net/cloud-archive/ussuri) | Fix Committed | Undecided | Unassigned |  |
|  | [Yoga](https://bugs.launchpad.net/cloud-archive/yoga) | Fix Released | Undecided | Unassigned |  |

### Bug Description

OpenStack has security vulnerability in Nova or Glance, that allows an authenticated attacker to read arbitrary files.

QCOW2 has two mechanisms to read from another file. The backing file issue was reported and fixed with OSSA-2015-014, but the external data file was not discovered.

Steps to Reproduce:

- Create a disk image: `qemu-img create -f qcow2 -o data\_file=abcdefghigh,data\_file\_raw=on disk.qcow2 1G` with `abcdefghigh` a placeholder of the same length as the file to read. `qemu-img` will zero it.

- Replace the filename in the disk image: `sed -i "s#abcdefghigh#/etc/passwd#" disk.qcow2`.

- Upload/register the disk image: `openstack image create --disk-format qcow2 --container-format bare --file "disk.qcow2" --private "my-image"`.

- Create a new instance: `openstack server create --flavor "nano" --image "my-image" "my-instance"`.

With the non-bootable instance there might be two ways to continue:

Option 1:

- Derive a new image: `openstack server image create --name "my-leak" "my-instance"`

- Download the image: `openstack image save --file "leak.qcow2" "my-leak"`

- The file content starts at guest cluster 0

Option 2: (this is untested because I reproduced it only in a production system)

- Reboot the instance in rescue mode: `openstack server rescue --image "cirros-0.6.2-x86\_64-disk" "my-instance"`.

- Go to the Dashboard, open the console of the instance and login to the instance.

- Extract content from `/dev/sdb` with `cat /dev/sdb | fold -w 1024 | head -n 32`, `xxd -l 1024 -c 32 /dev/sdb` or similar methods.

- It might be possible to write to the host file. If the disk image is mounted with `qemu-nbd`, writes go through to the external data file.

Tags:

[in-unmaintained-wallaby](/nova/%2Bbugs?field.tag=in-unmaintained-wallaby)
[in-unmaintained-xena](/nova/%2Bbugs?field.tag=in-unmaintained-xena)
[in-unmaintained-yoga](/nova/%2Bbugs?field.tag=in-unmaintained-yoga)
[in-unmaintained-zed](/nova/%2Bbugs?field.tag=in-unmaintained-zed)
[verification-ussuri-needed](/nova/%2Bbugs?field.tag=verification-ussuri-needed)

## CVE References

* [2020-10755](/bugs/cve/2020-10755 "An insecure-credentials flaw was foun...")
* [2022-47951](/bugs/cve/2022-47951 "An issue was discovered in OpenStack ...")
* [2023-2088](/bugs/cve/2023-2088 "A flaw was found in OpenStack due to ...")
* [2024-32498](/bugs/cve/2024-32498 "** RESERVED ** This candidate has bee...")
* [2024-4467](/bugs/cve/2024-4467 "** RESERVED ** This candidate has bee...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2024-03-30: |  |  | [#1](/nova/%2Bbug/2059809/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete

security advisory task has been added while the core security

reviewers for the affected project or projects confirm the bug and

discuss the scope of any vulnerability along with potential

solutions.

Since this report concerns a possible security risk, an incomplete
security advisory task has been added while the core security
reviewers for the affected project or projects confirm the bug and
discuss the scope of any vulnerability along with potential
solutions.

| **description**: | updated |
| --- | --- |
| Changed in ossa: | |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2024-03-30: |  |  | [#2](/nova/%2Bbug/2059809/comments/2) |
| --- | --- | --- | --- |

My initial impression is that this seems like a fairly similar situation to <https://security.openstack.org/ossa/OSSA-2023-002.html> in which case we may want to involve the Cinder and Glance security reviewers too, but we'll start with Nova and see where it leads.

My initial impression is that this seems like a fairly similar situation to https://security.openstack.org/ossa/OSSA-2023-002.html in which case we may want to involve the Cinder and Glance security reviewers too, but we'll start with Nova and see where it leads.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-01: |  |  | [#3](/nova/%2Bbug/2059809/comments/3) |
| --- | --- | --- | --- |

It's also similar to an earlier one specifically referring to qcow files. We currently protect against the backing file of a qcow pointing somewhere, but it looks like this data\_file option provides another route to get similar functionality. We will probably need similar mitigations in the same area we currently have them for backing files in nova, glance, and cinder.

It's also similar to an earlier one specifically referring to qcow files. We currently protect against the backing file of a qcow pointing somewhere, but it looks like this data\_file option provides another route to get similar functionality. We will probably need similar mitigations in the same area we currently have them for backing files in nova, glance, and cinder.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-01 (last edit on 2024-04-01): |  |  | [#4](/nova/%2Bbug/2059809/comments/4) |
| --- | --- | --- | --- |

We're also all (I think) now using oslo.utils/imageutils to probe the qcow files. AFAICT, that does not expose the general list of extra options, so we'll need to augment oslo.utils as well.

EDIT: Yeah, it does, under "format-specific"

We're also all (I think) now using oslo.utils/imageutils to probe the qcow files. AFAICT, that does not expose the general list of extra options, so we'll need to augment oslo.utils as well.
EDIT: Yeah, it does, under "format-specific"

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-01: |  |  | [#5](/nova/%2Bbug/2059809/comments/5) |
| --- | --- | --- | --- |

Proposed patch to nova to detect and reject qcow2 images with data-file set

Proposed patch to nova to detect and reject qcow2 images with data-file set

| 1 comments hidden Loading more comments | [view all 455 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-01: |  |  | [#7](/nova/%2Bbug/2059809/comments/7) |
| --- | --- | --- | --- |

Proposed patch to glance to detect and reject qcow2 images with data-file set

Proposed patch to glance to detect and reject qcow2 images with data-file set

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-01: |  |  | [#8](/nova/%2Bbug/2059809/comments/8) |
| --- | --- | --- | --- |

I subscribed Brian Rosmaita who can evaluate the cinder impact and also review the glance patch.

I subscribed Brian Rosmaita who can evaluate the cinder impact and also review the glance patch.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-01: |  |  | [#9](/nova/%2Bbug/2059809/comments/9) |
| --- | --- | --- | --- |

Added Eric Harney for cinder.

Added Eric Harney for cinder.

| 1 comments hidden Loading more comments | [view all 455 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-01: |  |  | [#11](/nova/%2Bbug/2059809/comments/11) |
| --- | --- | --- | --- |

Guess I should state explicitly that this also affects cinder, when it converts an image to raw format to write to a volume.

Guess I should state explicitly that this also affects cinder, when it converts an image to raw format to write to a volume.

| 1 comments hidden Loading more comments | [view all 455 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sylvain Bauza (sylvain-bauza)](https://launchpad.net/~sylvain-bauza) wrote on 2024-04-02: |  |  | [#13](/nova/%2Bbug/2059809/comments/13) |
| --- | --- | --- | --- |

I agree with the design proposal which is about not accepting an image with a data-file set.

Nova doesn't need to use an external disk for a guest, so we could no longer support it.

I'll look at Dan's patch today.

I agree with the design proposal which is about not accepting an image with a data-file set.
Nova doesn't need to use an external disk for a guest, so we could no longer support it.
I'll look at Dan's patch today.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sylvain Bauza (sylvain-bauza)](https://launchpad.net/~sylvain-bauza) wrote on 2024-04-02: |  |  | [#14](/nova/%2Bbug/2059809/comments/14) |
| --- | --- | --- | --- |

Nova's patch proposed by Dan relies on the same mitigation provided in <https://security.openstack.org/ossa/OSSA-2023-002.html> where we rely on a metadata that was added in osloutils's imageutils.py module by <https://github.com/openstack/oslo.utils/commit/2180db82b605cf84902ee379fffc0b34e17e92c7>

This sounds to me the correct approach as we can backport it down to the last Maintained releases but any distro can also backport it further down to Ussuri if they want (exactly like OSSA-2023-002)

+1 on nova-2059809.patch but I'll test it on a dev environment.

Nova's patch proposed by Dan relies on the same mitigation provided in https://security.openstack.org/ossa/OSSA-2023-002.html where we rely on a metadata that was added in osloutils's imageutils.py module by https://github.com/openstack/oslo.utils/commit/2180db82b605cf84902ee379fffc0b34e17e92c7
This sounds to me the correct approach as we can backport it down to the last Maintained releases but any distro can also backport it further down to Ussuri if they want (exactly like OSSA-2023-002)
+1 on nova-2059809.patch but I'll test it on a dev environment.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2024-04-02: |  |  | [#15](/nova/%2Bbug/2059809/comments/15) |
| --- | --- | --- | --- |

Martin Kaesberger: Did you notify any organizations about this other than reporting the bug to us? I just received a request from a public cloud provider for access to the bug report, which means the private embargo has been broken and we probably need to disclose this by switching to our public workflow immediately rather than continuing to work on it in private.

Martin Kaesberger: Did you notify any organizations about this other than reporting the bug to us? I just received a request from a public cloud provider for access to the bug report, which means the private embargo has been broken and we probably need to disclose this by switching to our public workflow immediately rather than continuing to work on it in private.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-02: |  |  | [#16](/nova/%2Bbug/2059809/comments/16) |
| --- | --- | --- | --- |

Updated cinder patch to include a release note.

Updated cinder patch to include a release note.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2024-04-02: |  |  | [#17](/nova/%2Bbug/2059809/comments/17) |
| --- | --- | --- | --- |

For now I'm subscribing some technical representatives from OVH (the provider on whose behalf I was contacted), on the assumption they were the only outside organization notified, so that they might assist with reviewing and testing the proposed fixes.

For now I'm subscribing some technical representatives from OVH (the provider on whose behalf I was contacted), on the assumption they were the only outside organization notified, so that they might assist with reviewing and testing the proposed fixes.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Arnaud Morin (arnaud-morin)](https://launchpad.net/~arnaud-morin) wrote on 2024-04-02: |  |  | [#18](/nova/%2Bbug/2059809/comments/18) |
| --- | --- | --- | --- |

* [nova.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5761287/%2Bfiles/nova.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5761287)
  (2.4 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Arnaud Morin (arnaud-morin)](https://launchpad.net/~arnaud-morin) wrote on 2024-04-02: |  |  | [#19](/nova/%2Bbug/2059809/comments/19) |
| --- | --- | --- | --- |

* [glance.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5761288/%2Bfiles/glance.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5761288)
  (1.4 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Arnaud Morin (arnaud-morin)](https://launchpad.net/~arnaud-morin) wrote on 2024-04-02: |  |  | [#20](/nova/%2Bbug/2059809/comments/20) |
| --- | --- | --- | --- |

* [cinder.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5761289/%2Bfiles/cinder.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5761289)
  (3.0 KiB,
  text/plain)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Kaesberger (mkaesberger)](https://launchpad.net/~mkaesberger) wrote on 2024-04-02: |  |  | [#21](/nova/%2Bbug/2059809/comments/21) |
| --- | --- | --- | --- |

Jeremy Stanley: The reference to the production system the report refers to the fact that it was discovered in the OVHcloud. I reported it to them in private first and was referred here.

Jeremy Stanley: The reference to the production system the report refers to the fact that it was discovered in the OVHcloud. I reported it to them in private first and was referred here.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2024-04-02: |  |  | [#22](/nova/%2Bbug/2059809/comments/22) |
| --- | --- | --- | --- |

Thanks for confirming. In this case it seems like we should be able to continue working on this in private for now, with added assistance from folks at OVH.

Thanks for confirming. In this case it seems like we should be able to continue working on this in private for now, with added assistance from folks at OVH.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-02: |  |  | [#23](/nova/%2Bbug/2059809/comments/23) |
| --- | --- | --- | --- |

Dan's glance-2059809.patch LGTM.

Dan's glance-2059809.patch LGTM.

[Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita)
on 2024-04-03

| Changed in cinder: | |
| --- | --- |
| **status**: | New → In Progress |
| **importance**: | Undecided → Critical |
| **assignee**: | nobody → Brian Rosmaita (brian-rosmaita) |
| Changed in glance: | |
| **status**: | New → In Progress |
| **importance**: | Undecided → Critical |
| **assignee**: | nobody → Dan Smith (danms) |
| Changed in nova: | |
| **status**: | New → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-03: |  |  | [#24](/nova/%2Bbug/2059809/comments/24) |
| --- | --- | --- | --- |

Nova backport for 2024.1

Nova backport for 2024.1

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-03: |  |  | [#25](/nova/%2Bbug/2059809/comments/25) |
| --- | --- | --- | --- |

Nova backport for 2023.2

Nova backport for 2023.2

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-03: |  |  | [#26](/nova/%2Bbug/2059809/comments/26) |
| --- | --- | --- | --- |

Nova backport for 2023.1

Nova backport for 2023.1

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-03: |  |  | [#27](/nova/%2Bbug/2059809/comments/27) |
| --- | --- | --- | --- |

Nova backport for zed

Nova backport for zed

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-03: |  |  | [#28](/nova/%2Bbug/2059809/comments/28) |
| --- | --- | --- | --- |

Glance backport for 2024.1

Glance backport for 2024.1

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-03: |  |  | [#29](/nova/%2Bbug/2059809/comments/29) |
| --- | --- | --- | --- |

Glance backport for 2023.2

Glance backport for 2023.2

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-03: |  |  | [#30](/nova/%2Bbug/2059809/comments/30) |
| --- | --- | --- | --- |

Glance backport for 2023.1

Glance backport for 2023.1

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dan Smith (danms)](https://launchpad.net/~danms) wrote on 2024-04-03: |  |  | [#31](/nova/%2Bbug/2059809/comments/31) |
| --- | --- | --- | --- |

Glance backport for zed

Glance backport for zed

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Eric Harney (eharney)](https://launchpad.net/~eharney) wrote on 2024-04-03: |  |  | [#32](/nova/%2Bbug/2059809/comments/32) |
| --- | --- | --- | --- |

brian-rosmaita's cinder-2059809.patch from comment #16 looks good to me.

brian-rosmaita's cinder-2059809.patch from comment #16 looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-03: |  |  | [#33](/nova/%2Bbug/2059809/comments/33) |
| --- | --- | --- | --- |

Cinder patch for 2024.1 (Caracal)

Cinder patch for 2024.1 (Caracal)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-03: |  |  | [#34](/nova/%2Bbug/2059809/comments/34) |
| --- | --- | --- | --- |

Cinder patch for 2023.2 (Bobcat).

Cinder patch for 2023.2 (Bobcat).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-03: |  |  | [#35](/nova/%2Bbug/2059809/comments/35) |
| --- | --- | --- | --- |

Cinder patch for 2023.1 (Antelope)

Cinder patch for 2023.1 (Antelope)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-03: |  |  | [#36](/nova/%2Bbug/2059809/comments/36) |
| --- | --- | --- | --- |

Cinder patch for Zed.

Cinder patch for Zed.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-03: |  |  | [#37](/nova/%2Bbug/2059809/comments/37) |
| --- | --- | --- | --- |

Cinder patch for unmaintained/yoga, as a courtesy.

Cinder patch for unmaintained/yoga, as a courtesy.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-05: |  |  | [#38](/nova/%2Bbug/2059809/comments/38) |
| --- | --- | --- | --- |

@arnaud-morin: would you mind deleting your patches so that people don't get confused? Thanks!

@arnaud-morin: would you mind deleting your patches so that people don't get confused? Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2024-04-05: |  |  | [#39](/nova/%2Bbug/2059809/comments/39) |
| --- | --- | --- | --- |

Martin Kaesberger: If there's any organization you're affiliated with and you'd like it credited along with your name, please let me know.

Here's a draft impact description, a quick review for any inaccuracies is appreciated so I can request a CVE assignment with it...

title: Arbitrary file access through custom QCOW2 external data

description: >

  Martin Kaesberger reported a vulnerability in QCOW2 image processing for

  Cinder, Glance and Nova. By supplying a specially created QCOW2 image which

  references a specific data file path, an authenticated user may convince

  systems to return a copy of that file's contents from the server resulting in

  unauthorized access to potentially sensitive data. All Cinder deployments are

  affected; only Glance deployments with image conversion enabled are affected;

  all Nova deployments are affected.

affected-products:

  - product: Cinder

    version: '<21.3.3, >=22.0.0 <22.1.2, >=23.0.0 <23.1.1, ==24.0.0'

  - product: Glance

    version: '<25.1.1, ==26.0.0, ==27.0.0, >=28.0.0 <28.0.2'

  - product: Nova

    version: '<26.2.3, >=27.0.0 <27.2.1, >=28.0.0 <28.0.2, >=29.0.0 <29.0.2'

Martin Kaesberger: If there's any organization you're affiliated with and you'd like it credited along with your name, please let me know.
Here's a draft impact description, a quick review for any inaccuracies is appreciated so I can request a CVE assignment with it...
title: Arbitrary file access through custom QCOW2 external data
description: >
Martin Kaesberger reported a vulnerability in QCOW2 image processing for
Cinder, Glance and Nova. By supplying a specially created QCOW2 image which
references a specific data file path, an authenticated user may convince
systems to return a copy of that file's contents from the server resulting in
unauthorized access to potentially sensitive data. All Cinder deployments are
affected; only Glance deployments with image conversion enabled are affected;
all Nova deployments are affected.
affected-products:
- product: Cinder
version: '<21.3.3, >=22.0.0 <22.1.2, >=23.0.0 <23.1.1, ==24.0.0'
- product: Glance
version: '<25.1.1, ==26.0.0, ==27.0.0, >=28.0.0 <28.0.2'
- product: Nova
version: '<26.2.3, >=27.0.0 <27.2.1, >=28.0.0 <28.0.2, >=29.0.0 <29.0.2'

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2024-04-05

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |
| **importance**: | Undecided → High |
| **assignee**: | nobody → Jeremy Stanley (fungi) |
| **status**: | Confirmed → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Rosmaita (brian-rosmaita)](https://launchpad.net/~brian-rosmaita) wrote on 2024-04-05: |  |  | [#40](/nova/%2Bbug/2059809/comments/40) |
| --- | --- | --- | --- |

Draft description LGTM, and the version lists check out.

Draft description LGTM, and the version lists check out.

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2024-04-05

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2024-06-18

| **summary**: | - Arbitrary file access through QCOW2 external data file+ Arbitrary file access through QCOW2 external data file (CVE-2024-32498) |
| --- | --- |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2024-06-25

| **description**: | updated |
| --- | --- |

[Sylvain Bauza (sylvain-bauza)](https://launchpad.net/~sylvain-bauza)
on 2024-06-26

| Changed in nova: | |
| --- | --- |
| **importance**: | Undecided → Critical |
| **assignee**: | nobody → Sylvain Bauza (sylvain-bauza) |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2024-07-02

| **summary**: | - Arbitrary file access through QCOW2 external data file (CVE-2024-32498)+ [OSSA-2024-001] Arbitrary file access through QCOW2 external data file+ (CVE-2024-32498) |
| --- | --- |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2024-07-02

| **description**: | updated |
| --- | --- |
| **information type**: | Private Security → Public Security |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2024-07-02

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2024-07-03

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2024-07-03

| Changed in cinder: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2024-07-04

| Changed in glance: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2024-07-06

| **tags**: | added: in-unmaintained-zed |
| --- | --- |

| 375 comments hidden Loading more comments | [view all 455 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-07-29:  [**Fix proposed to cinder (unmaintained/xena)**](/nova/%2Bbug/2059809/comments/416) |  |  | [#416](/nova/%2Bbug/2059809/comments/416) |
| --- | --- | --- | --- |

Fix proposed to branch: unmaintained/xena

Review: [https://review.opendev.org/c/openstack/cinder/+/925097](https://review.opendev.org/c/openstack/cinder/%2B/925097)

Fix proposed to branch: unmaintained/xena
Review: https://review.opendev.org/c/openstack/cinder/+/925097

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-07-29:  [**Fix proposed to cinder (unmaintained/wallaby)**](/nova/%2Bbug/2059809/comments/417) |  |  | [#417](/nova/%2Bbug/2059809/comments/417) |
| --- | --- | --- | --- |

Fix proposed to branch: unmaintained/wallaby

Review: [https://review.opendev.org/c/openstack/cinder/+/925098](https://review.opendev.org/c/openstack/cinder/%2B/925098)

Fix proposed to branch: unmaintained/wallaby
Review: https://review.opendev.org/c/openstack/cinder/+/925098

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-07-30:  [**Related fix merged to nova (unmaintained/zed)**](/nova/%2Bbug/2059809/comments/418) |  |  | [#418](/nova/%2Bbug/2059809/comments/418) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/nova/+/924241](https://review.opendev.org/c/openstack/nova/%2B/924241)

Committed: <https://opendev.org/openstack/nova/commit/e8f00617ed319aa37f6946cf10883eef6d180612>

Submitter: "Zuul (22348)"

Branch: unmaintained/zed

commit e8f00617ed319aa37f6946cf10883eef6d180612

Author: Sean Mooney <email address hidden>

Date: Thu Jul 4 20:09:31 2024 +0100

Add iso file format inspector

This change includes unit tests for the ISO

    format inspector using mkisofs to generate

    the iso files.

A test for stashing qcow content in the system\_area

    of an iso file is also included.

This change modifies format\_inspector.detect\_file\_format

    to evaluate all inspectors until they are complete and

    raise an InvalidDiskInfo exception if multiple formats

    match.

Related-Bug: #2059809

    Change-Id: I7e12718fb3e1f77eb8d1cfcb9fa64e8ddeb9e712

    (cherry picked from commit b1cc39848ebe9b9cb63141a647bda52a2842ee4b)

    (cherry picked from commit eeda7c333c773216c216159926673874ce4843ba)

    (cherry picked from commit 24628ecbbe9d5fdd4fe6767ca92395f0d3da9e48)

    (cherry picked from commit 65f0789df05e2ba7f11c0eaf2c6959367acbced2)

Reviewed: https://review.opendev.org/c/openstack/nova/+/924241
Committed: https://opendev.org/openstack/nova/commit/e8f00617ed319aa37f6946cf10883eef6d180612
Submitter: "Zuul (22348)"
Branch: unmaintained/zed
commit e8f00617ed319aa37f6946cf10883eef6d180612
Author: Sean Mooney <work@seanmooney.info>
Date: Thu Jul 4 20:09:31 2024 +0100
Add iso file format inspector
This change includes unit tests for the ISO
format inspector using mkisofs to generate
the iso files.
A test for stashing qcow content in the system\_area
of an iso file is also included.
This change modifies format\_inspector.detect\_file\_format
to evaluate all inspectors until they are complete and
raise an InvalidDiskInfo exception if multiple formats
match.
Related-Bug: #2059809
Change-Id: I7e12718fb3e1f77eb8d1cfcb9fa64e8ddeb9e712
(cherry picked from commit b1cc39848ebe9b9cb63141a647bda52a2842ee4b)
(cherry picked from commit eeda7c333c773216c216159926673874ce4843ba)
(cherry picked from commit 24628ecbbe9d5fdd4fe6767ca92395f0d3da9e48)
(cherry picked from commit 65f0789df05e2ba7f11c0eaf2c6959367acbced2)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-07-30: |  |  | [#419](/nova/%2Bbug/2059809/comments/419) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/nova/+/924243](https://review.opendev.org/c/openstack/nova/%2B/924243)

Committed: <https://opendev.org/openstack/nova/commit/11613e7b3244958fa8d0b5253a185287d1ade2d8>

Submitter: "Zuul (22348)"

Branch: unmaintained/zed

commit 11613e7b3244958fa8d0b5253a185287d1ade2d8

Author: Balazs Gibizer <email address hidden>

Date: Thu Jul 11 07:29:40 2024 +0200

Stabilize iso format unit tests

Some version of mkisofs does not properly handle if both the input and

    the output file of the command are the same. So this commit changes the

    unit tests depending on that binary to use a different files.

Related-Bug: #2059809

    Change-Id: I6924eb23ff5804c22a48ec6fabcec25f061906bb

    (cherry picked from commit c6d8c6972d52845774b36acb84cd08a4b2e4dcde)

    (cherry picked from commit a8783a767551df3dd943bd862cdba35c51cdb7a6)

    (cherry picked from commit 02147b36d35e1e462e1405c36a2e67a33de806de)

    (cherry picked from commit 47428f6caf503b94583dac614b59971f60a0ba9c)

Reviewed: https://review.opendev.org/c/openstack/nova/+/924243
Committed: https://opendev.org/openstack/nova/commit/11613e7b3244958fa8d0b5253a185287d1ade2d8
Submitter: "Zuul (22348)"
Branch: unmaintained/zed
commit 11613e7b3244958fa8d0b5253a185287d1ade2d8
Author: Balazs Gibizer <gibi@redhat.com>
Date: Thu Jul 11 07:29:40 2024 +0200
Stabilize iso format unit tests
Some version of mkisofs does not properly handle if both the input and
the output file of the command are the same. So this commit changes the
unit tests depending on that binary to use a different files.
Related-Bug: #2059809
Change-Id: I6924eb23ff5804c22a48ec6fabcec25f061906bb
(cherry picked from commit c6d8c6972d52845774b36acb84cd08a4b2e4dcde)
(cherry picked from commit a8783a767551df3dd943bd862cdba35c51cdb7a6)
(cherry picked from commit 02147b36d35e1e462e1405c36a2e67a33de806de)
(cherry picked from commit 47428f6caf503b94583dac614b59971f60a0ba9c)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-02:  [**Related fix proposed to nova (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/420) |  |  | [#420](/nova/%2Bbug/2059809/comments/420) |
| --- | --- | --- | --- |

Related fix proposed to branch: unmaintained/yoga

Review: [https://review.opendev.org/c/openstack/nova/+/925592](https://review.opendev.org/c/openstack/nova/%2B/925592)

Related fix proposed to branch: unmaintained/yoga
Review: https://review.opendev.org/c/openstack/nova/+/925592

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-02: |  |  | [#421](/nova/%2Bbug/2059809/comments/421) |
| --- | --- | --- | --- |

Related fix proposed to branch: unmaintained/yoga

Review: [https://review.opendev.org/c/openstack/nova/+/925594](https://review.opendev.org/c/openstack/nova/%2B/925594)

Related fix proposed to branch: unmaintained/yoga
Review: https://review.opendev.org/c/openstack/nova/+/925594

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-13:  [**Fix merged to nova (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/422) |  |  | [#422](/nova/%2Bbug/2059809/comments/422) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/nova/+/924081](https://review.opendev.org/c/openstack/nova/%2B/924081)

Committed: <https://opendev.org/openstack/nova/commit/f844c8fe3ccbf5b477c007ac1d2e290c9d74f2e6>

Submitter: "Zuul (22348)"

Branch: unmaintained/yoga

commit f844c8fe3ccbf5b477c007ac1d2e290c9d74f2e6

Author: Dan Smith <email address hidden>

Date: Mon Apr 1 07:32:11 2024 -0700

Reject qcow files with data-file attributes

Change-Id: Ic3fa16f55acc38cf6c1a4ac1dce4487225e66d04

    Closes-Bug: #2059809

    (cherry picked from commit ec9c55cbbc91d1f31e42ced289a7c82cf79dc2a2)

    (cherry picked from commit 58d933eafb3f7164419000700a305c8f75d5cb6e)

    (cherry picked from commit 736328f78fb88b6d567b94b50cd14b3ebef08a5e)

    (cherry picked from commit af4d819c606d6662d0b086365a51f5220b596e48)

    (cherry picked from commit d69d441cf5d82f69d8ed7d555a6af73624866400)

Reviewed: https://review.opendev.org/c/openstack/nova/+/924081
Committed: https://opendev.org/openstack/nova/commit/f844c8fe3ccbf5b477c007ac1d2e290c9d74f2e6
Submitter: "Zuul (22348)"
Branch: unmaintained/yoga
commit f844c8fe3ccbf5b477c007ac1d2e290c9d74f2e6
Author: Dan Smith <dansmith@redhat.com>
Date: Mon Apr 1 07:32:11 2024 -0700
Reject qcow files with data-file attributes
Change-Id: Ic3fa16f55acc38cf6c1a4ac1dce4487225e66d04
Closes-Bug: #2059809
(cherry picked from commit ec9c55cbbc91d1f31e42ced289a7c82cf79dc2a2)
(cherry picked from commit 58d933eafb3f7164419000700a305c8f75d5cb6e)
(cherry picked from commit 736328f78fb88b6d567b94b50cd14b3ebef08a5e)
(cherry picked from commit af4d819c606d6662d0b086365a51f5220b596e48)
(cherry picked from commit d69d441cf5d82f69d8ed7d555a6af73624866400)

| **tags**: | added: in-unmaintained-yoga |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-13: |  |  | [#423](/nova/%2Bbug/2059809/comments/423) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/nova/+/924082](https://review.opendev.org/c/openstack/nova/%2B/924082)

Committed: <https://opendev.org/openstack/nova/commit/b8a3d56f2e27531cc735606fbe92b648a51e8d62>

Submitter: "Zuul (22348)"

Branch: unmaintained/yoga

commit b8a3d56f2e27531cc735606fbe92b648a51e8d62

Author: Dan Smith <email address hidden>

Date: Wed Apr 17 07:06:13 2024 -0700

Check images with format\_inspector for safety

It has been asserted that we should not be calling qemu-img info

    on untrusted files. That means we need to know if they have a

    backing\_file, data\_file or other unsafe configuration \*before\* we use

    qemu-img to probe or convert them.

This grafts glance's format\_inspector module into nova/images so we

    can use it to check the file early for safety. The expectation is that

    this will be moved to oslo.utils (or something) later and thus we will

    just delete the file from nova and change our import when that happens.

NOTE: This includes whitespace changes from the glance version of

    format\_inspector.py because of autopep8 demands.

Conflicts:

      nova/conf/workarounds.py

NOTE(elod.illes): conflict is due to the following patch that is only

    present in zed: Iab92124b5776a799c7f90d07281d28fcf191c8fe

Change-Id: Iaefbe41b4c4bf0cf95d8f621653fdf65062aaa59

    Closes-Bug: #2059809

    (cherry picked from commit 9cdce715945619fc851ab3f43c97fab4bae4e35a)

    (cherry picked from commit f07fa55fd86726eeafcd4c0c687bc49dd4df9f4c)

    (cherry picked from commit 0acf5ee7b5dfb6ff0f9a9745f5ad2a0ed2bf65bf)

    (cherry picked from commit 67e5376dd64407f5aaf1ea5f8c896e356064a2c9)

    (cherry picked from commit da352edceb74dbd715268f94516503042b48cc90)

Reviewed: https://review.opendev.org/c/openstack/nova/+/924082
Committed: https://opendev.org/openstack/nova/commit/b8a3d56f2e27531cc735606fbe92b648a51e8d62
Submitter: "Zuul (22348)"
Branch: unmaintained/yoga
commit b8a3d56f2e27531cc735606fbe92b648a51e8d62
Author: Dan Smith <dansmith@redhat.com>
Date: Wed Apr 17 07:06:13 2024 -0700
Check images with format\_inspector for safety
It has been asserted that we should not be calling qemu-img info
on untrusted files. That means we need to know if they have a
backing\_file, data\_file or other unsafe configuration \*before\* we use
qemu-img to probe or convert them.
This grafts glance's format\_inspector module into nova/images so we
can use it to check the file early for safety. The expectation is that
this will be moved to oslo.utils (or something) later and thus we will
just delete the file from nova and change our import when that happens.
NOTE: This includes whitespace changes from the glance version of
format\_inspector.py because of autopep8 demands.
Conflicts:
nova/conf/workarounds.py
NOTE(elod.illes): conflict is due to the following patch that is only
present in zed: Iab92124b5776a799c7f90d07281d28fcf191c8fe
Change-Id: Iaefbe41b4c4bf0cf95d8f621653fdf65062aaa59
Closes-Bug: #2059809
(cherry picked from commit 9cdce715945619fc851ab3f43c97fab4bae4e35a)
(cherry picked from commit f07fa55fd86726eeafcd4c0c687bc49dd4df9f4c)
(cherry picked from commit 0acf5ee7b5dfb6ff0f9a9745f5ad2a0ed2bf65bf)
(cherry picked from commit 67e5376dd64407f5aaf1ea5f8c896e356064a2c9)
(cherry picked from commit da352edceb74dbd715268f94516503042b48cc90)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-14:  [**Related fix merged to nova (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/424) |  |  | [#424](/nova/%2Bbug/2059809/comments/424) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/nova/+/924084](https://review.opendev.org/c/openstack/nova/%2B/924084)

Committed: <https://opendev.org/openstack/nova/commit/3ba8ee16116e6a721413a382bbd4bcb68355cdf0>

Submitter: "Zuul (22348)"

Branch: unmaintained/yoga

commit 3ba8ee16116e6a721413a382bbd4bcb68355cdf0

Author: Dan Smith <email address hidden>

Date: Mon Jul 1 09:06:40 2024 -0700

Fix vmdk\_allowed\_types checking

This restores the vmdk\_allowed\_types checking in create\_image()

    that was unintentionally lost by tightening the

    qemu-type-matches-glance code in the fetch patch recently. Since we

    are still detecting the format of base images without metadata, we

    would have treated a vmdk file that claims to be raw as raw in fetch,

    but then read it like a vmdk once it was used as a base image for

    something else.

Conflicts:

      nova/tests/unit/virt/libvirt/test\_utils.py

      nova/virt/libvirt/utils.py

NOTE(elod.illes): conflicts are due to patch to consolidate image

    creation functions (I111cfc8a5eae27b15c6312957255fcf973038ddf) is only

    introduced in zed.

Change-Id: I07b332a7edb814f6a91661651d9d24bfd6651ae7

    Related-Bug: #2059809

    (cherry picked from commit 08be7b2a0dc1d7728d8034bc2aab0428c4fb642e)

    (cherry picked from commit 11301e7e3f0d81a3368632f90608e30d9c647111)

    (cherry picked from commit 70a435fd519a0ebcc3ac9ad5254fefbf19c93e48)

    (cherry picked from commit f732f8476851e6272d8ad9937f54b918795844e8)

    (cherry picked from commit a2acb31d790e6cb41c067bfc0343bde274c9428c)

Reviewed: https://review.opendev.org/c/openstack/nova/+/924084
Committed: https://opendev.org/openstack/nova/commit/3ba8ee16116e6a721413a382bbd4bcb68355cdf0
Submitter: "Zuul (22348)"
Branch: unmaintained/yoga
commit 3ba8ee16116e6a721413a382bbd4bcb68355cdf0
Author: Dan Smith <dansmith@redhat.com>
Date: Mon Jul 1 09:06:40 2024 -0700
Fix vmdk\_allowed\_types checking
This restores the vmdk\_allowed\_types checking in create\_image()
that was unintentionally lost by tightening the
qemu-type-matches-glance code in the fetch patch recently. Since we
are still detecting the format of base images without metadata, we
would have treated a vmdk file that claims to be raw as raw in fetch,
but then read it like a vmdk once it was used as a base image for
something else.
Conflicts:
nova/tests/unit/virt/libvirt/test\_utils.py
nova/virt/libvirt/utils.py
NOTE(elod.illes): conflicts are due to patch to consolidate image
creation functions (I111cfc8a5eae27b15c6312957255fcf973038ddf) is only
introduced in zed.
Change-Id: I07b332a7edb814f6a91661651d9d24bfd6651ae7
Related-Bug: #2059809
(cherry picked from commit 08be7b2a0dc1d7728d8034bc2aab0428c4fb642e)
(cherry picked from commit 11301e7e3f0d81a3368632f90608e30d9c647111)
(cherry picked from commit 70a435fd519a0ebcc3ac9ad5254fefbf19c93e48)
(cherry picked from commit f732f8476851e6272d8ad9937f54b918795844e8)
(cherry picked from commit a2acb31d790e6cb41c067bfc0343bde274c9428c)

[James Page (james-page)](https://launchpad.net/~james-page)
on 2024-08-19

| Changed in cloud-archive: | |
| --- | --- |
| **status**: | Fix Released → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Page (james-page)](https://launchpad.net/~james-page) wrote on 2024-08-21: |  |  | [#425](/nova/%2Bbug/2059809/comments/425) |
| --- | --- | --- | --- |

This bug was fixed in the package glance - 2:29.0.0~b2+git2024080717.695fcb67-0ubuntu1~cloud0

---------------

glance (2:29.0.0~b2+git2024080717.695fcb67-0ubuntu1~cloud0) noble-dalmatian; urgency=medium

 .

   \* New upstream release for the Ubuntu Cloud Archive.

 .

 glance (2:29.0.0~b2+git2024080717.695fcb67-0ubuntu1) oracular; urgency=medium

 .

   \* New upstream snapshot for OpenStack Dalmatian.

   \* d/control: Align (Build-)Depends with upstream.

   \* d/p/CVE\*.patch: Drop, included in snapshot.

 .

 glance (2:28.0.1-0ubuntu3) oracular; urgency=medium

 .

   \* SECURITY UPDATE: Arbitrary file access via custom QCOW2 external data

     (LP: [#2059809](/bugs/2059809))

     - debian/patches/CVE-2024-32498-1.patch: reject qcow files with

       data-file attributes.

     - debian/patches/CVE-2024-32498-2.patch: extend format\_inspector for

       QCOW safety.

     - debian/patches/CVE-2024-32498-3.patch: add VMDK safety check.

     - debian/patches/CVE-2024-32498-4.patch: reject unsafe qcow and vmdk

       files.

     - debian/patches/CVE-2024-32498-5.patch: add QED format detection to

       format\_inspector.

     - debian/patches/CVE-2024-32498-6.patch: add file format detection to

       format\_inspector.

     - debian/patches/CVE-2024-32498-7.patch: add safety check and detection

       support to FI tool.

     - CVE-2024-32498

This bug was fixed in the package glance - 2:29.0.0~b2+git2024080717.695fcb67-0ubuntu1~cloud0
---------------
glance (2:29.0.0~b2+git2024080717.695fcb67-0ubuntu1~cloud0) noble-dalmatian; urgency=medium
.
\* New upstream release for the Ubuntu Cloud Archive.
.
glance (2:29.0.0~b2+git2024080717.695fcb67-0ubuntu1) oracular; urgency=medium
.
\* New upstream snapshot for OpenStack Dalmatian.
\* d/control: Align (Build-)Depends with upstream.
\* d/p/CVE\*.patch: Drop, included in snapshot.
.
glance (2:28.0.1-0ubuntu3) oracular; urgency=medium
.
\* SECURITY UPDATE: Arbitrary file access via custom QCOW2 external data
(LP: #2059809)
- debian/patches/CVE-2024-32498-1.patch: reject qcow files with
data-file attributes.
- debian/patches/CVE-2024-32498-2.patch: extend format\_inspector for
QCOW safety.
- debian/patches/CVE-2024-32498-3.patch: add VMDK safety check.
- debian/patches/CVE-2024-32498-4.patch: reject unsafe qcow and vmdk
files.
- debian/patches/CVE-2024-32498-5.patch: add QED format detection to
format\_inspector.
- debian/patches/CVE-2024-32498-6.patch: add file format detection to
format\_inspector.
- debian/patches/CVE-2024-32498-7.patch: add safety check and detection
support to FI tool.
- CVE-2024-32498

| Changed in cloud-archive: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Page (james-page)](https://launchpad.net/~james-page) wrote on 2024-08-21: |  |  | [#426](/nova/%2Bbug/2059809/comments/426) |
| --- | --- | --- | --- |

This bug was fixed in the package nova - 3:29.1.0+git2024080716.bb2d7f9c-0ubuntu1~cloud0

---------------

nova (3:29.1.0+git2024080716.bb2d7f9c-0ubuntu1~cloud0) noble-dalmatian; urgency=medium

 .

   \* New upstream release for the Ubuntu Cloud Archive.

 .

 nova (3:29.1.0+git2024080716.bb2d7f9c-0ubuntu1) oracular; urgency=medium

 .

   \* New upstream snapshot for OpenStack Dalmatian.

   \* d/control: Align (Build-)Depends with upstream.

   \* d/p/test-hacking-compat.patch: Drop, included upstream.

   \* d/p/oslo.versionedobjects-compat.patch: Drop, similar included

     upstream.

   \* d/p/CVE\*.patch: Drop, included in snapshot.

 .

 nova (3:29.0.1-0ubuntu4) oracular; urgency=medium

 .

   \* SECURITY UPDATE: Arbitrary file access via custom QCOW2 external data

     (LP: [#2059809](/bugs/2059809))

     - debian/patches/CVE-2024-32498-1.patch: reject qcow files with

       data-file attributes.

     - debian/patches/CVE-2024-32498-2.patch: check images with

       format\_inspector for safety.

     - debian/patches/CVE-2024-32498-3.patch: additional qemu safety

       checking on base images.

     - debian/patches/CVE-2024-32498-4.patch: fix vmdk\_allowed\_types

       checking.

     - CVE-2024-32498

This bug was fixed in the package nova - 3:29.1.0+git2024080716.bb2d7f9c-0ubuntu1~cloud0
---------------
nova (3:29.1.0+git2024080716.bb2d7f9c-0ubuntu1~cloud0) noble-dalmatian; urgency=medium
.
\* New upstream release for the Ubuntu Cloud Archive.
.
nova (3:29.1.0+git2024080716.bb2d7f9c-0ubuntu1) oracular; urgency=medium
.
\* New upstream snapshot for OpenStack Dalmatian.
\* d/control: Align (Build-)Depends with upstream.
\* d/p/test-hacking-compat.patch: Drop, included upstream.
\* d/p/oslo.versionedobjects-compat.patch: Drop, similar included
upstream.
\* d/p/CVE\*.patch: Drop, included in snapshot.
.
nova (3:29.0.1-0ubuntu4) oracular; urgency=medium
.
\* SECURITY UPDATE: Arbitrary file access via custom QCOW2 external data
(LP: #2059809)
- debian/patches/CVE-2024-32498-1.patch: reject qcow files with
data-file attributes.
- debian/patches/CVE-2024-32498-2.patch: check images with
format\_inspector for safety.
- debian/patches/CVE-2024-32498-3.patch: additional qemu safety
checking on base images.
- debian/patches/CVE-2024-32498-4.patch: fix vmdk\_allowed\_types
checking.
- CVE-2024-32498

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-28:  [**Fix merged to cinder (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/427) |  |  | [#427](/nova/%2Bbug/2059809/comments/427) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/cinder/+/923873](https://review.opendev.org/c/openstack/cinder/%2B/923873)

Committed: <https://opendev.org/openstack/cinder/commit/0c3c65376f1aa46b35bedb4b59eac0bf8cc5979e>

Submitter: "Zuul (22348)"

Branch: unmaintained/yoga

commit 0c3c65376f1aa46b35bedb4b59eac0bf8cc5979e

Author: Brian Rosmaita <email address hidden>

Date: Wed Jun 26 14:09:30 2024 -0400

CVE-2024-32498: Check for external qcow2 data file

Adds code to image\_utils to check for a qcow2 external data

    file, a recent feature of qemu which we do not support and

    which can be used maliciously.

Advice from the qemu-img community is that it is dangerous

    to call qemu-img info on untrusted files, so we copy over

    the format\_inspector module from Glance. This performs basic

    analysis on the image data file so we can detect problematic

    images before we call qemu-img info to get all the image

    attributes. It is expected that this code will eventually be

    added to oslo so it can be consumed by Glance, Cinder, and

    Nova.

Because cinder itself may create qcow2 format images with a

    backing file in nfs-based backends, the glance format\_inspector

    has been modified to optionally allow such files. Since we are

    monkeying with the format\_inspector code, we also copy over

    its unit tests to prevent regressions and to add tests for the

    changed code.

Includes an additional fix to prevent an issue where a user

    could mount a raw volume and write a qcow2 header with a larger

    virtual size on it. On reattaching the volume it would have the

    new larger virtual size avaialable without actually changing

    the size value in cinder. While we cannot prevent this we can

    prevent the user from using this volume again, which makes this

    exploit pointless.

unmaintained/yoga only: The tests

    cinder.tests.unit.volume.drivers.test\_quobyte.QuobyteDriverTestCase.

    \* test\_copy\_volume\_from\_snapshot\_not\_cached\_overlay

    \* test\_copy\_volume\_from\_snapshot

    \* test\_copy\_volume\_from\_snapshot\_not\_cached

    failed as convert\_image mock was not called, remove this mock

    from yoga and on older branches.

With older qemu installed one of the qemu-img

    create commands fails, let's skip it from unmaintained/yoga and

    below that in test\_qcow2\_safety\_checks.

Co-authored-by: Dan Smith <email address hidden>

    Co-authored-by: Felix Huettner <email address hidden>

Change-Id: I65857288b797cde573e7443ac6e7e6f57fedde01

    Closes-bug: #2059809

    (cherry picked from commit 4aa6590a483901de64e0d162fff11f3d2d7f9977)

    (cherry picked from commit d6a186945e03649343af55b46ed8dfe0dd326e40)

    (cherry picked from commit db98dc207060da234c32a563c13cac1edbd62952)

    (cherry picked from commit 9e667b02b2c20b4ada18c1a472be152956284d45)

    (cherry picked from commit 5f5e86e3542866227b7339713148b5169d069f21)

Reviewed: https://review.opendev.org/c/openstack/cinder/+/923873
Committed: https://opendev.org/openstack/cinder/commit/0c3c65376f1aa46b35bedb4b59eac0bf8cc5979e
Submitter: "Zuul (22348)"
Branch: unmaintained/yoga
commit 0c3c65376f1aa46b35bedb4b59eac0bf8cc5979e
Author: Brian Rosmaita <rosmaita.fossdev@gmail.com>
Date: Wed Jun 26 14:09:30 2024 -0400
CVE-2024-32498: Check for external qcow2 data file
Adds code to image\_utils to check for a qcow2 external data
file, a recent feature of qemu which we do not support and
which can be used maliciously.
Advice from the qemu-img community is that it is dangerous
to call qemu-img info on untrusted files, so we copy over
the format\_inspector module from Glance. This performs basic
analysis on the image data file so we can detect problematic
images before we call qemu-img info to get all the image
attributes. It is expected that this code will eventually be
added to oslo so it can be consumed by Glance, Cinder, and
Nova.
Because cinder itself may create qcow2 format images with a
backing file in nfs-based backends, the glance format\_inspector
has been modified to optionally allow such files. Since we are
monkeying with the format\_inspector code, we also copy over
its unit tests to prevent regressions and to add tests for the
changed code.
Includes an additional fix to prevent an issue where a user
could mount a raw volume and write a qcow2 header with a larger
virtual size on it. On reattaching the volume it would have the
new larger virtual size avaialable without actually changing
the size value in cinder. While we cannot prevent this we can
prevent the user from using this volume again, which makes this
exploit pointless.
unmaintained/yoga only: The tests
cinder.tests.unit.volume.drivers.test\_quobyte.QuobyteDriverTestCase.
\* test\_copy\_volume\_from\_snapshot\_not\_cached\_overlay
\* test\_copy\_volume\_from\_snapshot
\* test\_copy\_volume\_from\_snapshot\_not\_cached
failed as convert\_image mock was not called, remove this mock
from yoga and on older branches.
With older qemu installed one of the qemu-img
create commands fails, let's skip it from unmaintained/yoga and
below that in test\_qcow2\_safety\_checks.
Co-authored-by: Dan Smith <dansmith@redhat.com>
Co-authored-by: Felix Huettner <felix.huettner@mail.schwarz>
Change-Id: I65857288b797cde573e7443ac6e7e6f57fedde01
Closes-bug: #2059809
(cherry picked from commit 4aa6590a483901de64e0d162fff11f3d2d7f9977)
(cherry picked from commit d6a186945e03649343af55b46ed8dfe0dd326e40)
(cherry picked from commit db98dc207060da234c32a563c13cac1edbd62952)
(cherry picked from commit 9e667b02b2c20b4ada18c1a472be152956284d45)
(cherry picked from commit 5f5e86e3542866227b7339713148b5169d069f21)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-28:  [**Related fix merged to glance (master)**](/nova/%2Bbug/2059809/comments/428) |  |  | [#428](/nova/%2Bbug/2059809/comments/428) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/glance/+/923676](https://review.opendev.org/c/openstack/glance/%2B/923676)

Committed: <https://opendev.org/openstack/glance/commit/d8de63a5008b811f2e22cc5cdda59bd2cc05b207>

Submitter: "Zuul (22348)"

Branch: master

commit d8de63a5008b811f2e22cc5cdda59bd2cc05b207

Author: Abhishek Kekane <email address hidden>

Date: Mon Jul 8 19:28:38 2024 +0000

Add iso file format inspector

This change excludes image conversion if source image

    format is ISO.

This change includes unit tests for the ISO

    format inspector using mkisofs to generate

    the iso files.

A test for stashing qcow content in the system\_area

    of an iso file is also included.

This change modifies format\_inspector.detect\_file\_format

    to evaluate all inspectors until they are complete and

    raise an InvalidDiskInfo exception if multiple formats

    match.

Related-Bug: #2059809

    Change-Id: Id706480e31687d8ade6f7199b600aff3ad7c68f7

Reviewed: https://review.opendev.org/c/openstack/glance/+/923676
Committed: https://opendev.org/openstack/glance/commit/d8de63a5008b811f2e22cc5cdda59bd2cc05b207
Submitter: "Zuul (22348)"
Branch: master
commit d8de63a5008b811f2e22cc5cdda59bd2cc05b207
Author: Abhishek Kekane <akekane@redhat.com>
Date: Mon Jul 8 19:28:38 2024 +0000
Add iso file format inspector
This change excludes image conversion if source image
format is ISO.
This change includes unit tests for the ISO
format inspector using mkisofs to generate
the iso files.
A test for stashing qcow content in the system\_area
of an iso file is also included.
This change modifies format\_inspector.detect\_file\_format
to evaluate all inspectors until they are complete and
raise an InvalidDiskInfo exception if multiple formats
match.
Related-Bug: #2059809
Change-Id: Id706480e31687d8ade6f7199b600aff3ad7c68f7

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-29:  [**Related fix proposed to glance (stable/2024.1)**](/nova/%2Bbug/2059809/comments/429) |  |  | [#429](/nova/%2Bbug/2059809/comments/429) |
| --- | --- | --- | --- |

Related fix proposed to branch: stable/2024.1

Review: [https://review.opendev.org/c/openstack/glance/+/927459](https://review.opendev.org/c/openstack/glance/%2B/927459)

Related fix proposed to branch: stable/2024.1
Review: https://review.opendev.org/c/openstack/glance/+/927459

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-29:  [**Related fix merged to glance (stable/2024.1)**](/nova/%2Bbug/2059809/comments/430) |  |  | [#430](/nova/%2Bbug/2059809/comments/430) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/glance/+/927459](https://review.opendev.org/c/openstack/glance/%2B/927459)

Committed: <https://opendev.org/openstack/glance/commit/eed2a8aeb7a2e1ba47ff5642a346a97e85b6b0ff>

Submitter: "Zuul (22348)"

Branch: stable/2024.1

commit eed2a8aeb7a2e1ba47ff5642a346a97e85b6b0ff

Author: Abhishek Kekane <email address hidden>

Date: Mon Jul 8 19:28:38 2024 +0000

Add iso file format inspector

This change excludes image conversion if source image

    format is ISO.

This change includes unit tests for the ISO

    format inspector using mkisofs to generate

    the iso files.

A test for stashing qcow content in the system\_area

    of an iso file is also included.

This change modifies format\_inspector.detect\_file\_format

    to evaluate all inspectors until they are complete and

    raise an InvalidDiskInfo exception if multiple formats

    match.

Related-Bug: #2059809

    Change-Id: Id706480e31687d8ade6f7199b600aff3ad7c68f7

    (cherry picked from commit d8de63a5008b811f2e22cc5cdda59bd2cc05b207)

Reviewed: https://review.opendev.org/c/openstack/glance/+/927459
Committed: https://opendev.org/openstack/glance/commit/eed2a8aeb7a2e1ba47ff5642a346a97e85b6b0ff
Submitter: "Zuul (22348)"
Branch: stable/2024.1
commit eed2a8aeb7a2e1ba47ff5642a346a97e85b6b0ff
Author: Abhishek Kekane <akekane@redhat.com>
Date: Mon Jul 8 19:28:38 2024 +0000
Add iso file format inspector
This change excludes image conversion if source image
format is ISO.
This change includes unit tests for the ISO
format inspector using mkisofs to generate
the iso files.
A test for stashing qcow content in the system\_area
of an iso file is also included.
This change modifies format\_inspector.detect\_file\_format
to evaluate all inspectors until they are complete and
raise an InvalidDiskInfo exception if multiple formats
match.
Related-Bug: #2059809
Change-Id: Id706480e31687d8ade6f7199b600aff3ad7c68f7
(cherry picked from commit d8de63a5008b811f2e22cc5cdda59bd2cc05b207)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-30:  [**Related fix proposed to glance (stable/2023.2)**](/nova/%2Bbug/2059809/comments/431) |  |  | [#431](/nova/%2Bbug/2059809/comments/431) |
| --- | --- | --- | --- |

Related fix proposed to branch: stable/2023.2

Review: [https://review.opendev.org/c/openstack/glance/+/927568](https://review.opendev.org/c/openstack/glance/%2B/927568)

Related fix proposed to branch: stable/2023.2
Review: https://review.opendev.org/c/openstack/glance/+/927568

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-30:  [**Related fix merged to glance (stable/2023.2)**](/nova/%2Bbug/2059809/comments/432) |  |  | [#432](/nova/%2Bbug/2059809/comments/432) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/glance/+/927568](https://review.opendev.org/c/openstack/glance/%2B/927568)

Committed: <https://opendev.org/openstack/glance/commit/5b4be5b6f2f67ec8e61bceff8c2ed79b870aace0>

Submitter: "Zuul (22348)"

Branch: stable/2023.2

commit 5b4be5b6f2f67ec8e61bceff8c2ed79b870aace0

Author: Abhishek Kekane <email address hidden>

Date: Mon Jul 8 19:28:38 2024 +0000

Add iso file format inspector

This change excludes image conversion if source image

    format is ISO.

This change includes unit tests for the ISO

    format inspector using mkisofs to generate

    the iso files.

A test for stashing qcow content in the system\_area

    of an iso file is also included.

This change modifies format\_inspector.detect\_file\_format

    to evaluate all inspectors until they are complete and

    raise an InvalidDiskInfo exception if multiple formats

    match.

Related-Bug: #2059809

    Change-Id: Id706480e31687d8ade6f7199b600aff3ad7c68f7

    (cherry picked from commit d8de63a5008b811f2e22cc5cdda59bd2cc05b207)

    (cherry picked from commit eed2a8aeb7a2e1ba47ff5642a346a97e85b6b0ff)

Reviewed: https://review.opendev.org/c/openstack/glance/+/927568
Committed: https://opendev.org/openstack/glance/commit/5b4be5b6f2f67ec8e61bceff8c2ed79b870aace0
Submitter: "Zuul (22348)"
Branch: stable/2023.2
commit 5b4be5b6f2f67ec8e61bceff8c2ed79b870aace0
Author: Abhishek Kekane <akekane@redhat.com>
Date: Mon Jul 8 19:28:38 2024 +0000
Add iso file format inspector
This change excludes image conversion if source image
format is ISO.
This change includes unit tests for the ISO
format inspector using mkisofs to generate
the iso files.
A test for stashing qcow content in the system\_area
of an iso file is also included.
This change modifies format\_inspector.detect\_file\_format
to evaluate all inspectors until they are complete and
raise an InvalidDiskInfo exception if multiple formats
match.
Related-Bug: #2059809
Change-Id: Id706480e31687d8ade6f7199b600aff3ad7c68f7
(cherry picked from commit d8de63a5008b811f2e22cc5cdda59bd2cc05b207)
(cherry picked from commit eed2a8aeb7a2e1ba47ff5642a346a97e85b6b0ff)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-30:  [**Related fix proposed to glance (stable/2023.1)**](/nova/%2Bbug/2059809/comments/433) |  |  | [#433](/nova/%2Bbug/2059809/comments/433) |
| --- | --- | --- | --- |

Related fix proposed to branch: stable/2023.1

Review: [https://review.opendev.org/c/openstack/glance/+/927580](https://review.opendev.org/c/openstack/glance/%2B/927580)

Related fix proposed to branch: stable/2023.1
Review: https://review.opendev.org/c/openstack/glance/+/927580

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-08-30:  [**Related fix merged to glance (stable/2023.1)**](/nova/%2Bbug/2059809/comments/434) |  |  | [#434](/nova/%2Bbug/2059809/comments/434) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/glance/+/927580](https://review.opendev.org/c/openstack/glance/%2B/927580)

Committed: <https://opendev.org/openstack/glance/commit/1427857a7d2a823bb754cf2f12f2b10e7b3df31d>

Submitter: "Zuul (22348)"

Branch: stable/2023.1

commit 1427857a7d2a823bb754cf2f12f2b10e7b3df31d

Author: Abhishek Kekane <email address hidden>

Date: Mon Jul 8 19:28:38 2024 +0000

Add iso file format inspector

This change excludes image conversion if source image

    format is ISO.

This change includes unit tests for the ISO

    format inspector using mkisofs to generate

    the iso files.

A test for stashing qcow content in the system\_area

    of an iso file is also included.

This change modifies format\_inspector.detect\_file\_format

    to evaluate all inspectors until they are complete and

    raise an InvalidDiskInfo exception if multiple formats

    match.

Related-Bug: #2059809

    Change-Id: Id706480e31687d8ade6f7199b600aff3ad7c68f7

    (cherry picked from commit d8de63a5008b811f2e22cc5cdda59bd2cc05b207)

    (cherry picked from commit eed2a8aeb7a2e1ba47ff5642a346a97e85b6b0ff)

    (cherry picked from commit 5b4be5b6f2f67ec8e61bceff8c2ed79b870aace0)

Reviewed: https://review.opendev.org/c/openstack/glance/+/927580
Committed: https://opendev.org/openstack/glance/commit/1427857a7d2a823bb754cf2f12f2b10e7b3df31d
Submitter: "Zuul (22348)"
Branch: stable/2023.1
commit 1427857a7d2a823bb754cf2f12f2b10e7b3df31d
Author: Abhishek Kekane <akekane@redhat.com>
Date: Mon Jul 8 19:28:38 2024 +0000
Add iso file format inspector
This change excludes image conversion if source image
format is ISO.
This change includes unit tests for the ISO
format inspector using mkisofs to generate
the iso files.
A test for stashing qcow content in the system\_area
of an iso file is also included.
This change modifies format\_inspector.detect\_file\_format
to evaluate all inspectors until they are complete and
raise an InvalidDiskInfo exception if multiple formats
match.
Related-Bug: #2059809
Change-Id: Id706480e31687d8ade6f7199b600aff3ad7c68f7
(cherry picked from commit d8de63a5008b811f2e22cc5cdda59bd2cc05b207)
(cherry picked from commit eed2a8aeb7a2e1ba47ff5642a346a97e85b6b0ff)
(cherry picked from commit 5b4be5b6f2f67ec8e61bceff8c2ed79b870aace0)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Page (james-page)](https://launchpad.net/~james-page) wrote on 2024-09-03:  [**Please test proposed package**](/nova/%2Bbug/2059809/comments/435) |  |  | [#435](/nova/%2Bbug/2059809/comments/435) |
| --- | --- | --- | --- |

Hello Martin, or anyone else affected,

Accepted cinder into ussuri-proposed. The package will build now and be available in the Ubuntu Cloud Archive in a few hours, and then in the -proposed repository.

Please help us by testing this new package. To enable the -proposed repository:

sudo add-apt-repository cloud-archive:ussuri-proposed

  sudo apt-get update

Your feedback will aid us getting this update out to other Ubuntu users.

If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested, and change the tag from verification-ussuri-needed to verification-ussuri-done. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-ussuri-failed. In either case, details of your testing will help us make a better decision.

Further information regarding the verification process can be found at <https://wiki.ubuntu.com/QATeam/PerformingSRUVerification> . Thank you in advance!

Hello Martin, or anyone else affected,
Accepted cinder into ussuri-proposed. The package will build now and be available in the Ubuntu Cloud Archive in a few hours, and then in the -proposed repository.
Please help us by testing this new package. To enable the -proposed repository:
sudo add-apt-repository cloud-archive:ussuri-proposed
sudo apt-get update
Your feedback will aid us getting this update out to other Ubuntu users.
If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested, and change the tag from verification-ussuri-needed to verification-ussuri-done. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-ussuri-failed. In either case, details of your testing will help us make a better decision.
Further information regarding the verification process can be found at https://wiki.ubuntu.com/QATeam/PerformingSRUVerification . Thank you in advance!

| **tags**: | added: verification-ussuri-needed |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Page (james-page)](https://launchpad.net/~james-page) wrote on 2024-09-03: |  |  | [#436](/nova/%2Bbug/2059809/comments/436) |
| --- | --- | --- | --- |

Hello Martin, or anyone else affected,

Accepted glance into ussuri-proposed. The package will build now and be available in the Ubuntu Cloud Archive in a few hours, and then in the -proposed repository.

Please help us by testing this new package. To enable the -proposed repository:

sudo add-apt-repository cloud-archive:ussuri-proposed

  sudo apt-get update

Your feedback will aid us getting this update out to other Ubuntu users.

If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested, and change the tag from verification-ussuri-needed to verification-ussuri-done. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-ussuri-failed. In either case, details of your testing will help us make a better decision.

Further information regarding the verification process can be found at <https://wiki.ubuntu.com/QATeam/PerformingSRUVerification> . Thank you in advance!

Hello Martin, or anyone else affected,
Accepted glance into ussuri-proposed. The package will build now and be available in the Ubuntu Cloud Archive in a few hours, and then in the -proposed repository.
Please help us by testing this new package. To enable the -proposed repository:
sudo add-apt-repository cloud-archive:ussuri-proposed
sudo apt-get update
Your feedback will aid us getting this update out to other Ubuntu users.
If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested, and change the tag from verification-ussuri-needed to verification-ussuri-done. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-ussuri-failed. In either case, details of your testing will help us make a better decision.
Further information regarding the verification process can be found at https://wiki.ubuntu.com/QATeam/PerformingSRUVerification . Thank you in advance!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-12:  [**Related fix merged to nova (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/437) |  |  | [#437](/nova/%2Bbug/2059809/comments/437) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/nova/+/925592](https://review.opendev.org/c/openstack/nova/%2B/925592)

Committed: <https://opendev.org/openstack/nova/commit/e7c2281b03a9eb52281ada9273938ad0d5c52202>

Submitter: "Zuul (22348)"

Branch: unmaintained/yoga

commit e7c2281b03a9eb52281ada9273938ad0d5c52202

Author: Sean Mooney <email address hidden>

Date: Thu Jul 4 20:09:31 2024 +0100

Add iso file format inspector

This change includes unit tests for the ISO

    format inspector using mkisofs to generate

    the iso files.

A test for stashing qcow content in the system\_area

    of an iso file is also included.

This change modifies format\_inspector.detect\_file\_format

    to evaluate all inspectors until they are complete and

    raise an InvalidDiskInfo exception if multiple formats

    match.

Related-Bug: #2059809

    Change-Id: I7e12718fb3e1f77eb8d1cfcb9fa64e8ddeb9e712

    (cherry picked from commit b1cc39848ebe9b9cb63141a647bda52a2842ee4b)

    (cherry picked from commit eeda7c333c773216c216159926673874ce4843ba)

    (cherry picked from commit 24628ecbbe9d5fdd4fe6767ca92395f0d3da9e48)

    (cherry picked from commit 65f0789df05e2ba7f11c0eaf2c6959367acbced2)

    (cherry picked from commit e8f00617ed319aa37f6946cf10883eef6d180612)

Reviewed: https://review.opendev.org/c/openstack/nova/+/925592
Committed: https://opendev.org/openstack/nova/commit/e7c2281b03a9eb52281ada9273938ad0d5c52202
Submitter: "Zuul (22348)"
Branch: unmaintained/yoga
commit e7c2281b03a9eb52281ada9273938ad0d5c52202
Author: Sean Mooney <work@seanmooney.info>
Date: Thu Jul 4 20:09:31 2024 +0100
Add iso file format inspector
This change includes unit tests for the ISO
format inspector using mkisofs to generate
the iso files.
A test for stashing qcow content in the system\_area
of an iso file is also included.
This change modifies format\_inspector.detect\_file\_format
to evaluate all inspectors until they are complete and
raise an InvalidDiskInfo exception if multiple formats
match.
Related-Bug: #2059809
Change-Id: I7e12718fb3e1f77eb8d1cfcb9fa64e8ddeb9e712
(cherry picked from commit b1cc39848ebe9b9cb63141a647bda52a2842ee4b)
(cherry picked from commit eeda7c333c773216c216159926673874ce4843ba)
(cherry picked from commit 24628ecbbe9d5fdd4fe6767ca92395f0d3da9e48)
(cherry picked from commit 65f0789df05e2ba7f11c0eaf2c6959367acbced2)
(cherry picked from commit e8f00617ed319aa37f6946cf10883eef6d180612)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-12: |  |  | [#438](/nova/%2Bbug/2059809/comments/438) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/nova/+/925594](https://review.opendev.org/c/openstack/nova/%2B/925594)

Committed: <https://opendev.org/openstack/nova/commit/76c43c4c56221cb836cf07b2df749cd94ec276e1>

Submitter: "Zuul (22348)"

Branch: unmaintained/yoga

commit 76c43c4c56221cb836cf07b2df749cd94ec276e1

Author: Balazs Gibizer <email address hidden>

Date: Thu Jul 11 07:29:40 2024 +0200

Stabilize iso format unit tests

Some version of mkisofs does not properly handle if both the input and

    the output file of the command are the same. So this commit changes the

    unit tests depending on that binary to use a different files.

Related-Bug: #2059809

    Change-Id: I6924eb23ff5804c22a48ec6fabcec25f061906bb

    (cherry picked from commit c6d8c6972d52845774b36acb84cd08a4b2e4dcde)

    (cherry picked from commit a8783a767551df3dd943bd862cdba35c51cdb7a6)

    (cherry picked from commit 02147b36d35e1e462e1405c36a2e67a33de806de)

    (cherry picked from commit 47428f6caf503b94583dac614b59971f60a0ba9c)

    (cherry picked from commit 11613e7b3244958fa8d0b5253a185287d1ade2d8)

Reviewed: https://review.opendev.org/c/openstack/nova/+/925594
Committed: https://opendev.org/openstack/nova/commit/76c43c4c56221cb836cf07b2df749cd94ec276e1
Submitter: "Zuul (22348)"
Branch: unmaintained/yoga
commit 76c43c4c56221cb836cf07b2df749cd94ec276e1
Author: Balazs Gibizer <gibi@redhat.com>
Date: Thu Jul 11 07:29:40 2024 +0200
Stabilize iso format unit tests
Some version of mkisofs does not properly handle if both the input and
the output file of the command are the same. So this commit changes the
unit tests depending on that binary to use a different files.
Related-Bug: #2059809
Change-Id: I6924eb23ff5804c22a48ec6fabcec25f061906bb
(cherry picked from commit c6d8c6972d52845774b36acb84cd08a4b2e4dcde)
(cherry picked from commit a8783a767551df3dd943bd862cdba35c51cdb7a6)
(cherry picked from commit 02147b36d35e1e462e1405c36a2e67a33de806de)
(cherry picked from commit 47428f6caf503b94583dac614b59971f60a0ba9c)
(cherry picked from commit 11613e7b3244958fa8d0b5253a185287d1ade2d8)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-12:  [**Fix merged to glance (unmaintained/zed)**](/nova/%2Bbug/2059809/comments/439) |  |  | [#439](/nova/%2Bbug/2059809/comments/439) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/glance/+/923307](https://review.opendev.org/c/openstack/glance/%2B/923307)

Committed: <https://opendev.org/openstack/glance/commit/63ac35e3248ceed3176a65cdccbbf06f69b3c58e>

Submitter: "Zuul (22348)"

Branch: unmaintained/zed

commit 63ac35e3248ceed3176a65cdccbbf06f69b3c58e

Author: Dan Smith <email address hidden>

Date: Tue Apr 16 11:20:48 2024 -0700

Reject unsafe qcow and vmdk files

This causes us to use the format inspector to pre-examine qcow and

    vmdk files for safe configurations before even using qemu-img

    on them.

Depends-On: [https://review.opendev.org/c/openstack/glance/+/923861](https://review.opendev.org/c/openstack/glance/%2B/923861)

    Change-Id: I0554706368e573e11f649c09569f7c21cbc8634b

    Closes-Bug: #2059809

    (cherry picked from commit a95f335bca1dfdd1c904ae475e9fe8c6806f2c56)

    (cherry picked from commit 55fc42563818fcf88b474233df242a796c918b3a)

    (cherry picked from commit f1f53075d69a9a1c006b3e25506e30eb0210de1f)

    (cherry picked from commit c1c54abeaba91ae0030d4acf01a91339b60a2d7d)

Reviewed: https://review.opendev.org/c/openstack/glance/+/923307
Committed: https://opendev.org/openstack/glance/commit/63ac35e3248ceed3176a65cdccbbf06f69b3c58e
Submitter: "Zuul (22348)"
Branch: unmaintained/zed
commit 63ac35e3248ceed3176a65cdccbbf06f69b3c58e
Author: Dan Smith <dansmith@redhat.com>
Date: Tue Apr 16 11:20:48 2024 -0700
Reject unsafe qcow and vmdk files
This causes us to use the format inspector to pre-examine qcow and
vmdk files for safe configurations before even using qemu-img
on them.
Depends-On: https://review.opendev.org/c/openstack/glance/+/923861
Change-Id: I0554706368e573e11f649c09569f7c21cbc8634b
Closes-Bug: #2059809
(cherry picked from commit a95f335bca1dfdd1c904ae475e9fe8c6806f2c56)
(cherry picked from commit 55fc42563818fcf88b474233df242a796c918b3a)
(cherry picked from commit f1f53075d69a9a1c006b3e25506e30eb0210de1f)
(cherry picked from commit c1c54abeaba91ae0030d4acf01a91339b60a2d7d)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-16:  [**Fix included in openstack/cinder 25.0.0.0rc1**](/nova/%2Bbug/2059809/comments/440) |  |  | [#440](/nova/%2Bbug/2059809/comments/440) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/cinder 25.0.0.0rc1 release candidate.

This issue was fixed in the openstack/cinder 25.0.0.0rc1 release candidate.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-17:  [**Fix proposed to glance (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/441) |  |  | [#441](/nova/%2Bbug/2059809/comments/441) |
| --- | --- | --- | --- |

Fix proposed to branch: unmaintained/yoga

Review: [https://review.opendev.org/c/openstack/glance/+/929666](https://review.opendev.org/c/openstack/glance/%2B/929666)

Fix proposed to branch: unmaintained/yoga
Review: https://review.opendev.org/c/openstack/glance/+/929666

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-17:  [**Fix proposed to nova (unmaintained/xena)**](/nova/%2Bbug/2059809/comments/442) |  |  | [#442](/nova/%2Bbug/2059809/comments/442) |
| --- | --- | --- | --- |

Fix proposed to branch: unmaintained/xena

Review: [https://review.opendev.org/c/openstack/nova/+/929667](https://review.opendev.org/c/openstack/nova/%2B/929667)

Fix proposed to branch: unmaintained/xena
Review: https://review.opendev.org/c/openstack/nova/+/929667

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-17: |  |  | [#443](/nova/%2Bbug/2059809/comments/443) |
| --- | --- | --- | --- |

Fix proposed to branch: unmaintained/xena

Review: [https://review.opendev.org/c/openstack/nova/+/929668](https://review.opendev.org/c/openstack/nova/%2B/929668)

Fix proposed to branch: unmaintained/xena
Review: https://review.opendev.org/c/openstack/nova/+/929668

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-17:  [**Related fix proposed to nova (unmaintained/xena)**](/nova/%2Bbug/2059809/comments/444) |  |  | [#444](/nova/%2Bbug/2059809/comments/444) |
| --- | --- | --- | --- |

Related fix proposed to branch: unmaintained/xena

Review: [https://review.opendev.org/c/openstack/nova/+/929671](https://review.opendev.org/c/openstack/nova/%2B/929671)

Related fix proposed to branch: unmaintained/xena
Review: https://review.opendev.org/c/openstack/nova/+/929671

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-17: |  |  | [#445](/nova/%2Bbug/2059809/comments/445) |
| --- | --- | --- | --- |

Related fix proposed to branch: unmaintained/xena

Review: [https://review.opendev.org/c/openstack/nova/+/929674](https://review.opendev.org/c/openstack/nova/%2B/929674)

Related fix proposed to branch: unmaintained/xena
Review: https://review.opendev.org/c/openstack/nova/+/929674

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-17: |  |  | [#446](/nova/%2Bbug/2059809/comments/446) |
| --- | --- | --- | --- |

Related fix proposed to branch: unmaintained/xena

Review: [https://review.opendev.org/c/openstack/nova/+/929676](https://review.opendev.org/c/openstack/nova/%2B/929676)

Related fix proposed to branch: unmaintained/xena
Review: https://review.opendev.org/c/openstack/nova/+/929676

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-09-20:  [**Fix included in openstack/nova 30.0.0.0rc1**](/nova/%2Bbug/2059809/comments/447) |  |  | [#447](/nova/%2Bbug/2059809/comments/447) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/nova 30.0.0.0rc1 release candidate.

This issue was fixed in the openstack/nova 30.0.0.0rc1 release candidate.

| 1 comments hidden Loading more comments | [view all 455 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-10-07:  [**Fix proposed to glance (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/449) |  |  | [#449](/nova/%2Bbug/2059809/comments/449) |
| --- | --- | --- | --- |

Fix proposed to branch: unmaintained/yoga

Review: [https://review.opendev.org/c/openstack/glance/+/931639](https://review.opendev.org/c/openstack/glance/%2B/931639)

Fix proposed to branch: unmaintained/yoga
Review: https://review.opendev.org/c/openstack/glance/+/931639

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-10-07:  [**Related fix proposed to glance (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/450) |  |  | [#450](/nova/%2Bbug/2059809/comments/450) |
| --- | --- | --- | --- |

Related fix proposed to branch: unmaintained/yoga

Review: [https://review.opendev.org/c/openstack/glance/+/931640](https://review.opendev.org/c/openstack/glance/%2B/931640)

Related fix proposed to branch: unmaintained/yoga
Review: https://review.opendev.org/c/openstack/glance/+/931640

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-10-09:  [**Fix merged to glance (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/451) |  |  | [#451](/nova/%2Bbug/2059809/comments/451) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/glance/+/931639](https://review.opendev.org/c/openstack/glance/%2B/931639)

Committed: <https://opendev.org/openstack/glance/commit/f7f7249b343bb7c1f6425a3dc11d926ecbbd40ba>

Submitter: "Zuul (22348)"

Branch: unmaintained/yoga

commit f7f7249b343bb7c1f6425a3dc11d926ecbbd40ba

Author: Dan Smith <email address hidden>

Date: Mon Apr 1 08:06:31 2024 -0700

Reject qcow files with data-file attributes

Change-Id: I6326a3e85c1ba4cb1da944a4323769f2399ed2c1

    Closes-Bug: #2059809

    (cherry picked from commit 2ca29af4433e9fa99a0a48e230d8d25d6eaa4a87)

    (cherry picked from commit c3586f3a122f6cb0663217b12b52203e74e2e4fa)

    (cherry picked from commit a92c438fb5ba55440b38cae7c8b4361b58daa9dd)

    (cherry picked from commit dba3bdb458aa8a5d0193f12b7f1e374a89ed34a2)

    (cherry picked from commit 6a38aef8baaf5caecbd8c866f1cf922d939dfbcc)

Reviewed: https://review.opendev.org/c/openstack/glance/+/931639
Committed: https://opendev.org/openstack/glance/commit/f7f7249b343bb7c1f6425a3dc11d926ecbbd40ba
Submitter: "Zuul (22348)"
Branch: unmaintained/yoga
commit f7f7249b343bb7c1f6425a3dc11d926ecbbd40ba
Author: Dan Smith <dansmith@redhat.com>
Date: Mon Apr 1 08:06:31 2024 -0700
Reject qcow files with data-file attributes
Change-Id: I6326a3e85c1ba4cb1da944a4323769f2399ed2c1
Closes-Bug: #2059809
(cherry picked from commit 2ca29af4433e9fa99a0a48e230d8d25d6eaa4a87)
(cherry picked from commit c3586f3a122f6cb0663217b12b52203e74e2e4fa)
(cherry picked from commit a92c438fb5ba55440b38cae7c8b4361b58daa9dd)
(cherry picked from commit dba3bdb458aa8a5d0193f12b7f1e374a89ed34a2)
(cherry picked from commit 6a38aef8baaf5caecbd8c866f1cf922d939dfbcc)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-10-09:  [**Related fix merged to glance (unmaintained/yoga)**](/nova/%2Bbug/2059809/comments/452) |  |  | [#452](/nova/%2Bbug/2059809/comments/452) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/glance/+/931640](https://review.opendev.org/c/openstack/glance/%2B/931640)

Committed: <https://opendev.org/openstack/glance/commit/a28d96bb8ca65e50be1efea3f3c0db82eed0bb62>

Submitter: "Zuul (22348)"

Branch: unmaintained/yoga

commit a28d96bb8ca65e50be1efea3f3c0db82eed0bb62

Author: Dan Smith <email address hidden>

Date: Tue Apr 16 10:29:10 2024 -0700

Extend format\_inspector for QCOW safety

This adds two properties to the QcowInspector that makes it able to

    indicate whether the file specifies a backing\_file or data\_file in the

    header. Both conditions are considered unsafe for our usage. To

    ease checking of this condition, a classmethod is added that takes

    a local filename and digests just enough of the file to assert that

    both conditions are false.

Note for yoga backport:With older qemu installed one of the qemu-img

    create commands fails, let's skip it from unmaintained/yoga and

    below that.

Change-Id: Iaf86b525397d41bd116999cabe0954a0a7efac65

    Related-Bug: #2059809

    (cherry picked from commit ae536bb394793c9a7a219cb498e03d5c81dbbbb7)

    (cherry picked from commit 2eba54e0821106097dfeceb424e53943fd090483)

    (cherry picked from commit 89dbbc838d606f461087e1494d19ddbcf9db0a38)

    (cherry picked from commit 4860024286256b028fabc5ed50274934c3dfdd8a)

    (cherry picked from commit f32d5b8ad865113d499a36f7507a085f583514f9)

Reviewed: https://review.opendev.org/c/openstack/glance/+/931640
Committed: https://opendev.org/openstack/glance/commit/a28d96bb8ca65e50be1efea3f3c0db82eed0bb62
Submitter: "Zuul (22348)"
Branch: unmaintained/yoga
commit a28d96bb8ca65e50be1efea3f3c0db82eed0bb62
Author: Dan Smith <dansmith@redhat.com>
Date: Tue Apr 16 10:29:10 2024 -0700
Extend format\_inspector for QCOW safety
This adds two properties to the QcowInspector that makes it able to
indicate whether the file specifies a backing\_file or data\_file in the
header. Both conditions are considered unsafe for our usage. To
ease checking of this condition, a classmethod is added that takes
a local filename and digests just enough of the file to assert that
both conditions are false.
Note for yoga backport:With older qemu installed one of the qemu-img
create commands fails, let's skip it from unmaintained/yoga and
below that.
Change-Id: Iaf86b525397d41bd116999cabe0954a0a7efac65
Related-Bug: #2059809
(cherry picked from commit ae536bb394793c9a7a219cb498e03d5c81dbbbb7)
(cherry picked from commit 2eba54e0821106097dfeceb424e53943fd090483)
(cherry picked from commit 89dbbc838d606f461087e1494d19ddbcf9db0a38)
(cherry picked from commit 4860024286256b028fabc5ed50274934c3dfdd8a)
(cherry picked from commit f32d5b8ad865113d499a36f7507a085f583514f9)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-12-03:  [**Fix merged to cinder (unmaintained/xena)**](/nova/%2Bbug/2059809/comments/453) |  |  | [#453](/nova/%2Bbug/2059809/comments/453) |
| --- | --- | --- | --- |

Reviewed: [https://review.opendev.org/c/openstack/cinder/+/925097](https://review.opendev.org/c/openstack/cinder/%2B/925097)

Committed: <https://opendev.org/openstack/cinder/commit/312d98d74490414902f3379b91b63dfa65f9b622>

Submitter: "Zuul (22348)"

Branch: unmaintained/xena

commit 312d98d74490414902f3379b91b63dfa65f9b622

Author: Brian Rosmaita <email address hidden>

Date: Wed Jun 26 14:09:30 2024 -0400

CVE-2024-32498: Check for external qcow2 data file

Adds code to image\_utils to check for a qcow2 external data

    file, a recent feature of qemu which we do not support and

    which can be used maliciously.

Advice from the qemu-img community is that it is dangerous

    to call qemu-img info on untrusted files, so we copy over

    the format\_inspector module from Glance. This performs basic

    analysis on the image data file so we can detect problematic

    images before we call qemu-img info to get all the image

    attributes. It is expected that this code will eventually be

    added to oslo so it can be consumed by Glance, Cinder, and

    Nova.

Because cinder itself may create qcow2 format images with a

    backing file in nfs-based backends, the glance format\_inspector

    has been modified to optionally allow such files. Since we are

    monkeying with the format\_inspector code, we also copy over

    its unit tests to prevent regressions and to add tests for the

    changed code.

Includes an additional fix to prevent an issue where a user

    could mount a raw volume and write a qcow2 header with a larger

    virtual size on it. On reattaching the volume it would have the

    new larger virtual size avaialable without actually changing

    the size value in cinder. While we cannot prevent this we can

    prevent the user from using this volume again, which makes this

    exploit pointless.

unmaintained/yoga only: The tests

    cinder.tests.unit.volume.drivers.test\_quobyte.QuobyteDriverTestCase.

    \* test\_copy\_volume\_from\_snapshot\_not\_cached\_overlay

    \* test\_copy\_volume\_from\_snapshot

    \* test\_copy\_volume\_from\_snapshot\_not\_cached

    failed as convert\_image mock was not called, remove this mock

    from yoga and on older branches.

With older qemu installed one of the qemu-img

    create commands fails, let's skip it from unmaintained/yoga and

    below that in test\_qcow2\_safety\_checks.

Co-authored-by: Dan Smith <email address hidden>

    Co-authored-by: Felix Huettner <email address hidden>

Change-Id: I65857288b797cde573e7443ac6e7e6f57fedde01

    Closes-bug: #2059809

    (cherry picked from commit 4aa6590a483901de64e0d162fff11f3d2d7f9977)

    (cherry picked from commit d6a186945e03649343af55b46ed8dfe0dd326e40)

    (cherry picked from commit db98dc207060da234c32a563c13cac1edbd62952)

    (cherry picked from commit 9e667b02b2c20b4ada18c1a472be152956284d45)

    (cherry picked from commit 5f5e86e3542866227b7339713148b5169d069f21)

    (cherry picked from commit 0c3c65376f1aa46b35bedb4b59eac0bf8cc5979e)

Reviewed: https://review.opendev.org/c/openstack/cinder/+/925097
Committed: https://opendev.org/openstack/cinder/commit/312d98d74490414902f3379b91b63dfa65f9b622
Submitter: "Zuul (22348)"
Branch: unmaintained/xena
commit 312d98d74490414902f3379b91b63dfa65f9b622
Author: Brian Rosmaita <rosmaita.fossdev@gmail.com>
Date: Wed Jun 26 14:09:30 2024 -0400
CVE-2024-32498: Check for external qcow2 data file
Adds code to image\_utils to check for a qcow2 external data
file, a recent feature of qemu which we do not support and
which can be used maliciously.
Advice from the qemu-img community is that it is dangerous
to call qemu-img info on untrusted files, so we copy over
the format\_inspector module from Glance. This performs basic
analysis on the image data file so we can detect problematic
images before we call qemu-img info to get all the image
attributes. It is expected that this code will eventually be
added to oslo so it can be consumed by Glance, Cinder, and
Nova.
Because cinder itself may create qcow2 format images with a
backing file in nfs-based backends, the glance format\_inspector
has been modified to optionally allow such files. Since we are
monkeying with the format\_inspector code, we also copy over
its unit tests to prevent regressions and to add tests for the
changed code.
Includes an additional fix to prevent an issue where a user
could mount a raw volume and write a qcow2 header with a larger
virtual size on it. On reattaching the volume it would have the
new larger virtual size avaialable without actually changing
the size value in cinder. While we cannot prevent this we can
prevent the user from using this volume again, which makes this
exploit pointless.
unmaintained/yoga only: The tests
cinder.tests.unit.volume.drivers.test\_quobyte.QuobyteDriverTestCase.
\* test\_copy\_volume\_from\_snapshot\_not\_cached\_overlay
\* test\_copy\_volume\_from\_snapshot
\* test\_copy\_volume\_from\_snapshot\_not\_cached
failed as convert\_image mock was not called, remove this mock
from yoga and on older branches.
With older qemu installed one of the qemu-img
create commands fails, let's skip it from unmaintained/yoga and
below that in test\_qcow2\_safety\_checks.
Co-authored-by: Dan Smith <dansmith@redhat.com>
Co-authored-by: Felix Huettner <felix.huettner@mail.schwarz>
Change-Id: I65857288b797cde573e7443ac6e7e6f57fedde01
Closes-bug: #2059809
(cherry picked from commit 4aa6590a483901de64e0d162fff11f3d2d7f9977)
(cherry picked from commit d6a186945e03649343af55b46ed8dfe0dd326e40)
(cherry picked from commit db98dc207060da234c32a563c13cac1edbd62952)
(cherry picked from commit 9e667b02b2c20b4ada18c1a472be152956284d45)
(cherry picked from commit 5f5e86e3542866227b7339713148b5169d069f21)
(cherry picked from commit 0c3c65376f1aa46b35bedb4b59eac0bf8cc5979e)

| **tags**: | added: in-unmaintained-xena |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-12-06:  [**Fix merged to cinder (unmaintained/wallaby)**](/nova/%2Bbug/2059809/comments/454) |  |  | [#454](/nova/%2Bbug/2059809/comments/454) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/nova/%2Bbug/2059809/comments/454/%2Bdownload) (3.2 KiB)

Reviewed: [https://review.opendev.org/c/openstack/cinder/+/925098](https://review.opendev.org/c/openstack/cinder/%2B/925098)

Committed: <https://opendev.org/openstack/cinder/commit/9875e4bc1d6b21be24253a52b5e40deb24748744>

Submitter: "Zuul (22348)"

Branch: unmaintained/wallaby

commit 9875e4bc1d6b21be24253a52b5e40deb24748744

Author: Brian Rosmaita <email address hidden>

Date: Wed Jun 26 14:09:30 2024 -0400

CVE-2024-32498: Check for external qcow2 data file

Adds code to image\_utils to check for a qcow2 external data

    file, a recent feature of qemu which we do not support and

    which can be used maliciously.

Advice from the qemu-img community is that it is dangerous

    to call qemu-img info on untrusted files, so we copy over

    the format\_inspector module from Glance. This performs basic

    analysis on the image data file so we can detect problematic

    images before we call qemu-img info to get all the image

    attributes. It is expected that this code will eventually be

    added to oslo so it can be consumed by Glance, Cinder, and

    Nova.

Because cinder itself may create qcow2 format images with a

    backing file in nfs-based backends, the glance format\_inspector

    has been modified to optionally allow such files. Since we are

    monkeying with the format\_inspector code, we also copy over

    its unit tests to prevent regressions and to add tests for the

    changed code.

Includes an additional fix to prevent an issue where a user

    could mount a raw volume and write a qcow2 header with a larger

    virtual size on it. On reattaching the volume it would have the

    new larger virtual size avaialable without actually changing

    the size value in cinder. While we cannot prevent this we can

    prevent the user from using this volume again, which makes this

    exploit pointless.

unmaintained/yoga only: The tests

    cinder.tests.unit.volume.drivers.test\_quobyte.QuobyteDriverTestCase.

    \* test\_copy\_volume\_from\_snapshot\_not\_cached\_overlay

    \* test\_copy\_volume\_from\_snapshot

    \* test\_copy\_volume\_from\_snapshot\_not\_cached

    failed as convert\_image mock was not called, remove this mock

    from yoga and on older branches.

With older qemu installed one of the qemu-img

    create commands fails, let's skip it from unmaintained/yoga and

    below that in test\_qcow2\_safety\_checks.

Co-authored-by: Dan Smith <email address hidden>

    Co-authored-by: Felix Huettner <email address hidden>

Conflicts:

      cinder/image/image\_utils.py

NOTE(elod.illes): conflict is due to mypy patch was added in xena only:

    Ib32e58125be3a2b6d05488807c83d48e920cf57d

Change-Id: I65857288b797cde573e7443ac6e7e6f57fedde01

    Closes-bug: #2059809

    (cherry picked from commit 4aa6590a483901de64e0d162fff11f3d2d7f9977)

    (cherry picked from commit d6a186945e03649343af55b46ed8dfe0dd326e40)

    (cherry picked from commit db98dc207060da234c32a563c13cac1edbd62952)

    (cherry picked from commit 9e667b02b2c20b4ada18c1a472be152956284d45)

    (cherry picked from commit 5f5e86e3542866227b7339713148b5169d069f21)

    (cherry picked from commit 0c3c65376f1aa46b35bedb4b59eac0bf8cc5979e)

    (cherry picked ...

[Read more...](/nova/%2Bbug/2059809/comments/454)

Reviewed: https://review.opendev.org/c/openstack/cinder/+/925098
Committed: https://opendev.org/openstack/cinder/commit/9875e4bc1d6b21be24253a52b5e40deb24748744
Submitter: "Zuul (22348)"
Branch: unmaintained/wallaby
commit 9875e4bc1d6b21be24253a52b5e40deb24748744
Author: Brian Rosmaita <rosmaita.fossdev@gmail.com>
Date: Wed Jun 26 14:09:30 2024 -0400
CVE-2024-32498: Check for external qcow2 data file
Adds code to image\_utils to check for a qcow2 external data
file, a recent feature of qemu which we do not support and
which can be used maliciously.
Advice from the qemu-img community is that it is dangerous
to call qemu-img info on untrusted files, so we copy over
the format\_inspector module from Glance. This performs basic
analysis on the image data file so we can detect problematic
images before we call qemu-img info to get all the image
attributes. It is expected that this code will eventually be
added to oslo so it can be consumed by Glance, Cinder, and
Nova.
Because cinder itself may create qcow2 format images with a
backing file in nfs-based backends, the glance format\_inspector
has been modified to optionally allow such files. Since we are
monkeying with the format\_inspector code, we also copy over
its unit tests to prevent regressions and to add tests for the
changed code.
Includes an additional fix to prevent an issue where a user
could mount a raw volume and write a qcow2 header with a larger
virtual size on it. On reattaching the volume it would have the
new larger virtual size avaialable without actually changing
the size value in cinder. While we cannot prevent this we can
prevent the user from using this volume again, which makes this
exploit pointless.
unmaintained/yoga only: The tests
cinder.tests.unit.volume.drivers.test\_quobyte.QuobyteDriverTestCase.
\* test\_copy\_volume\_from\_snapshot\_not\_cached\_overlay
\* test\_copy\_volume\_from\_snapshot
\* test\_copy\_volume\_from\_snapshot\_not\_cached
failed as convert\_image mock was not called, remove this mock
from yoga and on older branches.
With older qemu installed one of the qemu-img
create commands fails, let's skip it from unmaintained/yoga and
below that in test\_qcow2\_safety\_checks.
Co-authored-by: Dan Smith <dansmith@redhat.com>
Co-authored-by: Felix Huettner <felix.huettner@mail.schwarz>
Conflicts:
cinder/image/image\_utils.py
NOTE(elod.illes): conflict is due to mypy patch was added in xena only:
Ib32e58125be3a2b6d05488807c83d48e920cf57d
Change-Id: I65857288b797cde573e7443ac6e7e6f57fedde01
Closes-bug: #2059809
(cherry picked from commit 4aa6590a483901de64e0d162fff11f3d2d7f9977)
(cherry picked from commit d6a186945e03649343af55b46ed8dfe0dd326e40)
(cherry picked from commit db98dc207060da234c32a563c13cac1edbd62952)
(cherry picked from commit 9e667b02b2c20b4ada18c1a472be152956284d45)
(cherry picked from commit 5f5e86e3542866227b7339713148b5169d069f21)
(cherry picked from commit 0c3c65376f1aa46b35bedb4b59eac0bf8cc5979e)
(cherry picked from commit 312d98d74490414902f3379b91b63dfa65f9b622)

| **tags**: | added: in-unmaintained-wallaby |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2024-12-06:  [**Fix proposed to cinder (unmaintained/victoria)**](/nova/%2Bbug/2059809/comments/455) |  |  | [#455](/nova/%2Bbug/2059809/comments/455) |
| --- | --- | --- | --- |

Fix proposed to branch: unmaintained/victoria

Review: [https://review.opendev.org/c/openstack/cinder/+/937284](https://review.opendev.org/c/openstack/cinder/%2B/937284)

Fix proposed to branch: unmaintained/victoria
Review: https://review.opendev.org/c/openstack/cinder/+/937284

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Bactivity)

Displaying first 40
and last 40
comments.
[View all 455
comments](/nova/%2Bbug/2059809?comments=all) or [add a comment](/nova/%2Bbug/2059809?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/2059809/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [nova.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5761287/%2Bfiles/nova.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5761287 "Change patch details")
* [glance.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5761288/%2Bfiles/glance.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5761288 "Change patch details")
* [cinder.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5761289/%2Bfiles/cinder.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5761289 "Change patch details")
* [cinder-master-additional-qemu-safety.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792231/%2Bfiles/cinder-master-additional-qemu-safety.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792231 "Change patch details")
* [cinder-master-additional-size-check.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792254/%2Bfiles/cinder-master-additional-size-check.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792254 "Change patch details")
* [cinder-additionals-fixed.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792392/%2Bfiles/cinder-additionals-fixed.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792392 "Change patch details")
* [CVE-2024-32498\_4\_repair\_unit\_tests.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792632/%2Bfiles/CVE-2024-32498_4_repair_unit_tests.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792632 "Change patch details")
* [cinder-2059809-additional-tests-master.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792738/%2Bfiles/cinder-2059809-additional-tests-master.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792738 "Change patch details")
* [nova-master-2059809.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792870/%2Bfiles/nova-master-2059809.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792870 "Change patch details")
* [Nova unified patch for 2024.1](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792871/%2Bfiles/nova-2024.1-2059809.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792871 "Change patch details")
* [Nova unified patch for 2023.2](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792872/%2Bfiles/nova-2023.2-2059809.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792872 "Change patch details")
* [Nova unified patch for 2023.1](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792873/%2Bfiles/nova-2023.1-2059809.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792873 "Change patch details")
* [Glance unified patch for master](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792906/%2Bfiles/glance-master-2058089.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792906 "Change patch details")
* [Glance unified patch for 2024.1](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5793094/%2Bfiles/glance-2024.1-2059809.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5793094 "Change patch details")
* [Glance unified patch for 2023.2](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5793095/%2Bfiles/glance-2023.2-2059809.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5793095 "Change patch details")
* [Glance unified patch for 2023.1](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5793096/%2Bfiles/glance-2023.1-2059809.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5793096 "Change patch details")
* [Train-ish example backport for glance](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5793098/%2Bfiles/glance-train-minimal.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5793098 "Change patch details")
* [late-nova-fix.patch](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5793883/%2Bfiles/late-nova-fix.patch)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5793883 "Change patch details")

* [Add patch](/nova/%2Bbug/2059809/%2Baddcomment?field.patch=on)

## Bug attachments

* [qmp.sh](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5761999/%2Bfiles/qmp.sh)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5761999 "Change attachment details")
* [add-missing-stuff.tar.gz](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792163/%2Bfiles/add-missing-stuff.tar.gz)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792163 "Change attachment details")
* [cinder-2059809-unified-master-v2.txt](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792633/%2Bfiles/cinder-2059809-unified-master-v2.txt)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792633 "Change attachment details")
* [cinder-2059809-unified-stable-2024.1-v2.txt](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792634/%2Bfiles/cinder-2059809-unified-stable-2024.1-v2.txt)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792634 "Change attachment details")
* [cinder-2059809-unified-stable-2023.2-v2.txt](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792637/%2Bfiles/cinder-2059809-unified-stable-2023.2-v2.txt)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792637 "Change attachment details")
* [cinder-2059809-unified-stable-2023.1-v2.txt](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792638/%2Bfiles/cinder-2059809-unified-stable-2023.1-v2.txt)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792638 "Change attachment details")
* [cinder-2059809-unified-unmaintained-zed-v2.txt](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792639/%2Bfiles/cinder-2059809-unified-unmaintained-zed-v2.txt)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792639 "Change attachment details")
* [CVE-2024-32498-glance-victoria.tar.gz](https://bugs.launchpad.net/nova/%2Bbug/2059809/%2Battachment/5792737/%2Bfiles/CVE-2024-32498-glance-victoria.tar.gz)
  [Edit](/nova/%2Bbug/2059809/%2Battachment/5792737 "Change attachment details")

* [Add attachment](/nova/%2Bbug/2059809/%2Baddcomment)

## Remote bug watches

* [redhat-bugs #2278875](https://bugzilla.redhat.com/show_bug.cgi?id=2278875)

  [NEW]
  [Edit](/bugs/2059809/%2Bwatch/160851 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from security.openstack.org_23ae0650_20250111_111749.html ===


Toggle navigation

 Search

* [Software](https://www.openstack.org/software/)
  + [Overview](https://www.openstack.org/software/)
  + [OpenStack Components](https://www.openstack.org/software/project-navigator/openstack-components)
  + [SDKs](https://www.openstack.org/software/project-navigator/sdks)
  + [Deployment Tools](https://www.openstack.org/software/project-navigator/deployment-tools)
  + [OpenStack Map](https://www.openstack.org/assets/software/projectmap/openstack-map.pdf)
  + [Sample Configs](https://www.openstack.org/software/sample-configs/)
* [Use Cases](https://www.openstack.org/use-cases/)
  + [Users in Production](https://www.openstack.org/use-cases/)
  + [Ironic Bare Metal](https://www.openstack.org/use-cases/bare-metal/)
  + [Edge Computing](https://www.openstack.org/use-cases/edge-computing/)
  + [Telecom & NFV](https://www.openstack.org/use-cases/telecoms-and-nfv/)
  + [Science and HPC](https://www.openstack.org/use-cases/science/)
  + [Containers](https://www.openstack.org/use-cases/containers/)
  + [Enterprise](https://www.openstack.org/use-cases/enterprise/)
  + [User Survey](https://www.openstack.org/surveys/landing)
* [Events](https://openinfra.dev/summit)
  + [OpenInfra Summit](https://openinfra.dev/summit)
  + [Project Teams Gathering](https://www.openstack.org/ptg/)
  + [OpenDev](https://www.openstack.org/events/opendev-2020/)
  + [Community Events](https://www.openstack.org/events/community-events/)
  + [OpenStack & OpenInfra Days](https://www.openstack.org/events/openstackdays)
  + [Summit Videos](https://www.openstack.org/videos/)
* [Community](https://www.openstack.org/community/)
  + [Welcome! Start Here](https://www.openstack.org/community/)
  + [OpenStack Technical Committee](https://www.openstack.org/community/tech-committee)
  + [Speakers Bureau](https://www.openstack.org/community/speakers/)
  + [OpenStack Wiki](http://wiki.openstack.org)
  + [Get Certified (COA)](https://www.openstack.org/coa/)
  + [Jobs](https://www.openstack.org/community/jobs/)
  + [Marketing Resources](https://www.openstack.org/marketing/)
  + [Community News](https://www.openstack.org/news/)
  + [Superuser Magazine](http://superuser.openstack.org)
  + [OpenInfra Foundation Supporting Organizations](https://www.openstack.org/community/supporting-organizations/)
  + [OpenInfra Foundation](https://openinfra.dev)
* [Marketplace](https://www.openstack.org/marketplace/)
  + [Training](https://www.openstack.org/marketplace/training/)
  + [Distros & Appliances](https://www.openstack.org/marketplace/distros/)
  + [Public Clouds](https://www.openstack.org/marketplace/public-clouds/)
  + [Hosted Private Clouds](https://www.openstack.org/marketplace/hosted-private-clouds/)
  + [Remotely Managed Private Clouds](https://www.openstack.org/marketplace/remotely-managed-private-clouds/)
  + [Consulting & Integrators](https://www.openstack.org/marketplace/consulting/)
  + [Drivers](https://www.openstack.org/marketplace/drivers/)
* [Blog](https://www.openstack.org/blog/)
* [Docs](http://docs.openstack.org/)
* [Join](https://openinfra.dev/join/)
  + [Sign up for Foundation Membership](https://openinfra.dev/join/)
  + [Sponsor the Foundation](https://openinfra.dev/join/)
  + [More about the Foundation](https://openinfra.dev)
* [Log In](https://www.openstack.org/Security/login/?BackURL=/home/)

# OSSA-2024-001: Arbitrary file access through custom QCOW2 external data

# OSSA-2024-001: Arbitrary file access through custom QCOW2 external data[Â¶](#ossa-2024-001-arbitrary-file-access-through-custom-qcow2-external-data "Link to this heading")

Date:

July 02, 2024

CVE:

CVE-2024-32498

## Affects[Â¶](#affects "Link to this heading")

* Cinder: <22.1.3, >=23.0.0 <23.1.1, ==24.0.0
* Glance: <26.0.1, ==27.0.0, >=28.0.0 <28.0.2
* Nova: <27.3.1, >=28.0.0 <28.1.1, >=29.0.0 <29.0.3

## Description[Â¶](#description "Link to this heading")

Martin Kaesberger reported a vulnerability in QCOW2 image processing for Cinder, Glance and Nova. By supplying a specially created QCOW2 image which references a specific data file path, an authenticated user may convince systems to return a copy of that fileâs contents from the server resulting in unauthorized access to potentially sensitive data. All Cinder deployments are affected; only Glance deployments with image conversion enabled are affected; all Nova deployments are affected.

## Patches[Â¶](#patches "Link to this heading")

* <https://review.opendev.org/923247> (2023.1/antelope(cinder))
* <https://review.opendev.org/923277> (2023.1/antelope(glance))
* <https://review.opendev.org/923278> (2023.1/antelope(glance))
* <https://review.opendev.org/923279> (2023.1/antelope(glance))
* <https://review.opendev.org/923280> (2023.1/antelope(glance))
* <https://review.opendev.org/923281> (2023.1/antelope(glance))
* <https://review.opendev.org/923282> (2023.1/antelope(glance))
* <https://review.opendev.org/923283> (2023.1/antelope(glance))
* <https://review.opendev.org/923288> (2023.1/antelope(nova))
* <https://review.opendev.org/923289> (2023.1/antelope(nova))
* <https://review.opendev.org/923290> (2023.1/antelope(nova))
* <https://review.opendev.org/923281> (2023.1/antelope(nova))
* <https://review.opendev.org/923246> (2023.2/bobcat(cinder))
* <https://review.opendev.org/923266> (2023.2/bobcat(glance))
* <https://review.opendev.org/923267> (2023.2/bobcat(glance))
* <https://review.opendev.org/923268> (2023.2/bobcat(glance))
* <https://review.opendev.org/923269> (2023.2/bobcat(glance))
* <https://review.opendev.org/923270> (2023.2/bobcat(glance))
* <https://review.opendev.org/923271> (2023.2/bobcat(glance))
* <https://review.opendev.org/923272> (2023.2/bobcat(glance))
* <https://review.opendev.org/923284> (2023.2/bobcat(nova))
* <https://review.opendev.org/923285> (2023.2/bobcat(nova))
* <https://review.opendev.org/923286> (2023.2/bobcat(nova))
* <https://review.opendev.org/923287> (2023.2/bobcat(nova))
* <https://review.opendev.org/923245> (2024.1/caracal(cinder))
* <https://review.opendev.org/923259> (2024.1/caracal(glance))
* <https://review.opendev.org/923260> (2024.1/caracal(glance))
* <https://review.opendev.org/923261> (2024.1/caracal(glance))
* <https://review.opendev.org/923262> (2024.1/caracal(glance))
* <https://review.opendev.org/923263> (2024.1/caracal(glance))
* <https://review.opendev.org/923264> (2024.1/caracal(glance))
* <https://review.opendev.org/923265> (2024.1/caracal(glance))
* <https://review.opendev.org/923273> (2024.1/caracal(nova))
* <https://review.opendev.org/923274> (2024.1/caracal(nova))
* <https://review.opendev.org/923275> (2024.1/caracal(nova))
* <https://review.opendev.org/923276> (2024.1/caracal(nova))
* <https://review.opendev.org/923244> (2024.2/dalmatian(cinder))
* <https://review.opendev.org/923248> (2024.2/dalmatian(glance))
* <https://review.opendev.org/923249> (2024.2/dalmatian(glance))
* <https://review.opendev.org/923250> (2024.2/dalmatian(glance))
* <https://review.opendev.org/923251> (2024.2/dalmatian(glance))
* <https://review.opendev.org/923252> (2024.2/dalmatian(glance))
* <https://review.opendev.org/923253> (2024.2/dalmatian(glance))
* <https://review.opendev.org/923254> (2024.2/dalmatian(glance))
* <https://review.opendev.org/923255> (2024.2/dalmatian(nova))
* <https://review.opendev.org/923256> (2024.2/dalmatian(nova))
* <https://review.opendev.org/923257> (2024.2/dalmatian(nova))
* <https://review.opendev.org/923258> (2024.2/dalmatian(nova))

## Credits[Â¶](#credits "Link to this heading")

* Martin Kaesberger from none (CVE-2024-32498)

## References[Â¶](#references "Link to this heading")

* <https://launchpad.net/bugs/2059809>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-32498>

## Notes[Â¶](#notes "Link to this heading")

* Due to the scope of the problem and complexity of the resulting fixes,
  regressions and additional bypasses were reported in the original bug
  by downstream stakeholders during the coordinated disclosure period.
  As a result, our initially chosen publication date was rescheduled,
  which put the advisory four days past our promised ninety day maximum
  embargo length. Additional revised patches and regression fixes were
  supplied to stakeholders as soon as possible, but we understand the
  unfortunate timing of these last-minute changes resulted in a lot of
  additional work for everyone involved.

this page last updated: 2025-01-07 18:17:35

[![Creative Commons Attribution 3.0 License](../_static/images/docs/license.png)](https://creativecommons.org/licenses/by/3.0/)

Except where otherwise noted, this document is licensed under
[Creative Commons
Attribution 3.0 License](https://creativecommons.org/licenses/by/3.0/). See all [OpenStack Legal Documents](https://www.openstack.org/legal).

found an error? report a bug

OpenStack Documentation

* Guides
* [Install Guides](https://docs.openstack.org/index.html#install-guides)
* [User Guides](https://docs.openstack.org/index.html#user-guides)
* [Configuration Guides](https://docs.openstack.org/index.html#configuration-guides)
* [Operations and Administration Guides](https://docs.openstack.org/index.html#ops-and-admin-guides)
* [API Guides](https://docs.openstack.org/index.html#api-guides)
* [Contributor Guides](https://docs.openstack.org/index.html#contributor-guides)
* Languages
* [Deutsch (German)](https://docs.openstack.org/de/)
* [FranÃ§ais (French)](https://docs.openstack.org/fr/)
* [Bahasa Indonesia (Indonesian)](https://docs.openstack.org/id/)
* [Italiano (Italian)](https://docs.openstack.org/it/)
* [æ¥æ¬èª (Japanese)](https://docs.openstack.org/ja/)
* [íêµ­ì´ (Korean)](https://docs.openstack.org/ko_KR/)
* [PortuguÃªs (Portuguese)](https://docs.openstack.org/pt_BR/)
* [TÃ¼rkÃ§e (TÃ¼rkiye)](https://docs.openstack.org/tr_TR/)
* [ç®ä½ä¸­æ (Simplified Chinese)](https://docs.openstack.org/zh_CN/)

#### Contents

* OSSA-2024-001: Arbitrary file access through custom QCOW2 external data
  + [Affects](#affects)
  + [Description](#description)
  + [Patches](#patches)
  + [Credits](#credits)
  + [References](#references)
  + [Notes](#notes)

### OpenStack

* [Projects](https://www.openstack.org/software/project-navigator/)
* [OpenStack Security](https://security.openstack.org/)
* [Blog](https://openstack.org/blog/)
* [News](https://openstack.org/news/)

### Community

* [User Groups](https://www.meetup.com/pro/openinfradev/)
* [Events](https://openstack.org/community/events/)
* [Jobs](https://openstack.org/community/jobs/)
* [Companies](https://openinfra.dev/members/)
* [Contribute](https://docs.openstack.org/contributors)

### Documentation

* [OpenStack Manuals](https://docs.openstack.org)
* [Getting Started](https://openstack.org/software/start/)
* [API Documentation](https://developer.openstack.org)
* [Wiki](https://wiki.openstack.org)

### Branding & Legal

* [Legal Docs](https://openinfra.dev/legal)
* [Logos & Guidelines](https://openstack.org/brand/)
* [Trademark Policy](https://openinfra.dev/legal/trademark-policy)
* [Privacy Policy](https://openinfra.dev/privacy-policy)
* [OpenInfra CLA](https://docs.openstack.org/contributors/common/setup-gerrit.html#individual-contributor-license-agreement)

### Stay In Touch

The OpenStack project is provided under the
[Apache 2.0 license](https://www.apache.org/licenses/LICENSE-2.0). Docs.openstack.org is powered by
[Rackspace Cloud Computing](https://rackspace.com).



=== Content from www.openwall.com_06f2053a_20250111_111745.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2024/07/03/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240702150121.fxt4445gwlrxwk3r@yuggoth.org>
Date: Tue, 2 Jul 2024 15:01:21 +0000
From: Jeremy Stanley <fungi@...goth.org>
To: oss-security@...ts.openwall.com
Subject: [OSSA-2024-001] OpenStack Cinder, Glance, Nova: Arbitrary file
 access through custom QCOW2 external data (CVE-2024-32498)

=======================================================================
OSSA-2024-001: Arbitrary file access through custom QCOW2 external data
=======================================================================

:Date: July 02, 2024
:CVE: CVE-2024-32498

Affects
~~~~~~~
- Cinder: <22.1.3, >=23.0.0 <23.1.1, ==24.0.0
- Glance: <26.0.1, ==27.0.0, >=28.0.0 <28.0.2
- Nova: <27.3.1, >=28.0.0 <28.1.1, >=29.0.0 <29.0.3

Description
~~~~~~~~~~~
Martin Kaesberger reported a vulnerability in QCOW2 image processing
for Cinder, Glance and Nova. By supplying a specially created QCOW2
image which references a specific data file path, an authenticated
user may convince systems to return a copy of that file's contents
from the server resulting in unauthorized access to potentially
sensitive data. All Cinder deployments are affected; only Glance
deployments with image conversion enabled are affected; all Nova
deployments are affected.

Patches
~~~~~~~
- <https://review.opendev.org/923247> (2023.1/antelope(cinder))
- <https://review.opendev.org/923277> (2023.1/antelope(glance))
- <https://review.opendev.org/923278> (2023.1/antelope(glance))
- <https://review.opendev.org/923279> (2023.1/antelope(glance))
- <https://review.opendev.org/923280> (2023.1/antelope(glance))
- <https://review.opendev.org/923281> (2023.1/antelope(glance))
- <https://review.opendev.org/923282> (2023.1/antelope(glance))
- <https://review.opendev.org/923283> (2023.1/antelope(glance))
- <https://review.opendev.org/923288> (2023.1/antelope(nova))
- <https://review.opendev.org/923289> (2023.1/antelope(nova))
- <https://review.opendev.org/923290> (2023.1/antelope(nova))
- <https://review.opendev.org/923281> (2023.1/antelope(nova))
- <https://review.opendev.org/923246> (2023.2/bobcat(cinder))
- <https://review.opendev.org/923266> (2023.2/bobcat(glance))
- <https://review.opendev.org/923267> (2023.2/bobcat(glance))
- <https://review.opendev.org/923268> (2023.2/bobcat(glance))
- <https://review.opendev.org/923269> (2023.2/bobcat(glance))
- <https://review.opendev.org/923270> (2023.2/bobcat(glance))
- <https://review.opendev.org/923271> (2023.2/bobcat(glance))
- <https://review.opendev.org/923272> (2023.2/bobcat(glance))
- <https://review.opendev.org/923284> (2023.2/bobcat(nova))
- <https://review.opendev.org/923285> (2023.2/bobcat(nova))
- <https://review.opendev.org/923286> (2023.2/bobcat(nova))
- <https://review.opendev.org/923287> (2023.2/bobcat(nova))
- <https://review.opendev.org/923245> (2024.1/caracal(cinder))
- <https://review.opendev.org/923259> (2024.1/caracal(glance))
- <https://review.opendev.org/923260> (2024.1/caracal(glance))
- <https://review.opendev.org/923261> (2024.1/caracal(glance))
- <https://review.opendev.org/923262> (2024.1/caracal(glance))
- <https://review.opendev.org/923263> (2024.1/caracal(glance))
- <https://review.opendev.org/923264> (2024.1/caracal(glance))
- <https://review.opendev.org/923265> (2024.1/caracal(glance))
- <https://review.opendev.org/923273> (2024.1/caracal(nova))
- <https://review.opendev.org/923274> (2024.1/caracal(nova))
- <https://review.opendev.org/923275> (2024.1/caracal(nova))
- <https://review.opendev.org/923276> (2024.1/caracal(nova))
- <https://review.opendev.org/923244> (2024.2/dalmatian(cinder))
- <https://review.opendev.org/923248> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923249> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923250> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923251> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923252> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923253> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923254> (2024.2/dalmatian(glance))
- <https://review.opendev.org/923255> (2024.2/dalmatian(nova))
- <https://review.opendev.org/923256> (2024.2/dalmatian(nova))
- <https://review.opendev.org/923257> (2024.2/dalmatian(nova))
- <https://review.opendev.org/923258> (2024.2/dalmatian(nova))

Credits
~~~~~~~
- Martin Kaesberger (CVE-2024-32498)

References
~~~~~~~~~~
- <https://launchpad.net/bugs/2059809>
- <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-32498>

Notes
~~~~~
- Due to the scope of the problem and complexity of the resulting
  fixes, regressions and additional bypasses were reported in the
  original bug by downstream stakeholders during the coordinated
  disclosure period. As a result, our initially chosen publication
  date was rescheduled, which put the advisory four days past our
  promised ninety day maximum embargo length. Additional revised
  patches and regression fixes were supplied to stakeholders as soon
  as possible, but we understand the unfortunate timing of these
  last-minute changes resulted in a lot of additional work for
  everyone involved.

--
Jeremy Stanley
OpenStack Vulnerability Management Team

Download attachment "[signature.asc](2/1)" of type "application/pgp-signature" (964 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.debian.org_7424df99_20250111_111748.html ===


---

[[Date Prev](msg00015.html)][[Date Next](msg00017.html)]
[[Thread Prev](msg00015.html)][[Thread Next](msg00017.html)]
[[Date Index](maillist.html#00016)]
[[Thread Index](threads.html#00016)]

# [SECURITY] [DLA 3872-1] glance security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3872-1] glance security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Thu, 5 Sep 2024 00:34:40 +0200
* *Message-id*: <[[🔎]](/msgid-search/ZtjggJ-syl0pcDWw%40mail.beuc.net) [ZtjggJ-syl0pcDWw@mail.beuc.net](msg00016.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3872-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Thomas Goirand
September 05, 2024                            <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : glance
Version        : 2:21.1.0-1+deb11u2
CVE ID         : CVE-2024-32498
Debian Bug     : 1074761

Martin Kaesberger discovered a vulnerability which affects multiple
OpenStack components (Nova, Glance and Cinder): Malformed QCOW2 disk
images may result in the disclosure of arbitrary files.

For Debian 11 bullseye, this problem has been fixed in version
2:21.1.0-1+deb11u2.

We recommend that you upgrade your glance packages.

For the detailed security status of glance please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/glance>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE1vEOfV7HXWKqBieIDTl9HeUlXjAFAmbY3lgACgkQDTl9HeUl
XjDwahAAlMEncCIdPb2DAXWwu+GnJikF4fZVYy+whCcMGNOXIlb19bfiPsZ/0eyH
CdGqnstnQ7x+CUgH/G1uIgQnLEcWdSYu7EWCLQvGsQERNXMT+Qj0skzZnGxJuMw4
VtBMCDyb1JZHk4Vo69l7nUZaFkwNGdk82QQdZ/ktvIJaaAjIbGbImrvDDMoATtNb
BxrYuKrZBwAhMLou+Qb8axGsoI8hJIA45piFavFduKuwopC2S82jzvCqSIV4bKxc
EUvl+kIZBpjtN9hDw6u3KtUQKTkXRWvzxnY20yTv8CCsheMyW6T/m2GyXTTtJBh3
Px/hljgsVXQST6b+NEUrBxd3FIwc4sj472Uh4ZjMYtzHM458b79ByFEA3FWOH6kp
qDdT17saeS5rcWTsyzQ5CYtvWytGPRw33PSC70L6iHwVuE8jDaaWc9QAe/9bLMi9
A2Hm46nmjS2IBtAzsCYPS7VCodFgjkd9LQ8sJLgKRsS8IdxNWj09cA68dZmnQPeU
UPwjGmsNduaRa9dpAbyE4RYu5lcQ8E98kQYdnkf//MBEEnjJmoIQ+ssaMsQYD7Yv
sQd2A6l52P0fmOASNQzEWoBa//t9wZRo1ynjDw2VC8EjHH8+wWLK2QLQb++PbsHo
XTAN4lAPX624VA6C+nw0U4XbYc4/wmr1tQh3IbQtD9VtGgdKu7Y=
=PJuD
-----END PGP SIGNATURE-----

```

---


