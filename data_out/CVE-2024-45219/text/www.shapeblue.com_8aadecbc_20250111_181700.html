

[Skip to content](#content)
[![](https://www.shapeblue.com/wp-content/uploads/2023/07/Shape_blue_recreated_logo.svg)](https://www.shapeblue.com)

* Apache CloudStack
  Close Apache CloudStack

  Open Apache CloudStack

  ## Apache CloudStack

  [Overview](https://www.shapeblue.com/apache-cloudstack-overview/)

  [Integrations](https://www.shapeblue.com/apache-cloudstack-integrations/)

  [Use Cases](https://www.shapeblue.com/apache-cloudstack-use-cases/)

  [Community](https://www.shapeblue.com/apache-cloudstack-community/)

  [Events](https://www.shapeblue.com/events/)
* Services

  Close Services

  Open Services

  ## Our Services

  [CloudStack Software Engineering](https://www.shapeblue.com/cloudstack-software-engineering/)

  [CloudStack Support](https://www.shapeblue.com/cloudstack-infrastructure-support/)

  [IaaS Design and Build](https://www.shapeblue.com/iaas-cloud-design-and-build/)

  [CloudStack Consulting](https://www.shapeblue.com/cloudstack-consulting/)

  [CloudStack Training](https://www.shapeblue.com/cloudstack-training)

  [VMware Migration](https://www.shapeblue.com/vmware-migration-to-apache-cloudstack/)
* Resources
  Close Resources

  Open Resources

  ## RESOURCES

  [Blogs and News](https://www.shapeblue.com/blogs-news/)

  [Case Studies](https://www.shapeblue.com/case-studies/)

  [CloudStack Packages](https://www.shapeblue.com/cloudstack-packages/)

  [Documents](https://www.shapeblue.com/documents/)
* About

  Close About

  Open About

  ## About ShapeBlue

  [The Company](https://www.shapeblue.com/about/)

  [Careers](https://www.shapeblue.com/careers/)

  [Employee Ownership](https://www.shapeblue.com/employee-ownership/)

  [Leadership Team](https://www.shapeblue.com/leadership-team/)
* Contact

  Close Contact

  Open Contact

  ## Contact

  [Offices](https://www.shapeblue.com/offices/)

  [Support](https://www.shapeblue.com/support/)
* [Get In Touch](https://www.shapeblue.com/get-in-touch/)

* [Blog Home](https://www.shapeblue.com/blogs-news/%20)

* [by Rohit Yadav](https://www.shapeblue.com/author/rohit/)
* 3  min read
* October 15, 2024
* [Advisories](https://www.shapeblue.com/category/advisories/)

Share:

![](https://www.shapeblue.com/wp-content/uploads/2024/10/SA-October.jpg)

## ShapeBlue Security Advisory: Apache CloudStack Security Releases 4.18.2.4 and 4.19.1.2

The Apache CloudStack project has announced an [advisory](https://cloudstack.apache.org/blog/security-release-advisory-4.18.2.4-4.19.1.2/) against CVE-2024-45219 (severity ‘Important’), CVE-2024-45461 (severity ‘Moderate’), CVE-2024-45462 (severity ‘Moderate’) and CVE-2024-45693 (severity ‘Important’), explained below.

### [CVE-2024-45219](https://www.cve.org/CVERecord?id=CVE-2024-45219): Uploaded and registered templates and volumes can abuse KVM-based infrastructure

Account users in Apache CloudStack by default are allowed to upload and register templates for deploying instances and volumes for attaching them as data disks to their existing instances. Due to missing validation checks for KVM-compatible templates or volumes in CloudStack 4.0.0 through 4.18.2.3 and 4.19.0.0 through 4.19.1.1, an attacker that can upload or register templates and volumes, can use them to deploy malicious instances or attach uploaded volumes to their existing instances on KVM-based environments and exploit this to gain access to the host filesystems that could result in the compromise of resource integrity and confidentiality, data loss, denial of service, and availability of KVM-based infrastructure managed by CloudStack.

Additionally, all user uploaded or registered KVM-compatible templates and volumes can be scanned and checked that they are flat files who should not be using any additional or unnecessary features.

### [CVE-2024-45461](https://www.cve.org/CVERecord?id=CVE-2024-45461): Access checks not enforced in Quota

The CloudStack Quota feature allows cloud administrators to implement a quota or usage limit system for cloud resources, and is disabled by default. In environments where the feature is enabled, due to missing access check enforcements, non-administrative CloudStack user accounts are able to access and modify quota-related configurations and data. This issue affects Apache CloudStack from 4.7.0 through 4.18.2.3; and from 4.19.0.0 through 4.19.1.1, where the Quota feature is enabled.

### [CVE-2024-45462](https://www.cve.org/CVERecord?id=CVE-2024-45462): Incomplete session invalidation on web interface logout

The logout operation in the CloudStack web interface does not expire the user session completely which is valid until expiry by time or restart of the backend service. An attacker that has access to a user’s browser can use an unexpired session to gain access to resources owned by the logged out user account.

### [CVE-2024-45693](https://www.cve.org/CVERecord?id=CVE-2024-45693): Request origin validation bypass opens up a possibly leading to account takeover

Users logged into the Apache CloudStack’s web interface can be tricked to submit malicious CSRF requests due to missing validation of the origin of the requests. This can allow an attacker to gain privileges and access to resources of the authenticated users and may lead to account takeover, disruption, exposure of sensitive data and compromise integrity of the resources owned by the user account that are managed by the platform.

### Credits

The CVEs are credited to the following reporters:

* CVE-2024-45219:
  + Daniel Augusto Veronezi Salvador <gu\*\*\*\*\*\*\*\*\*\*@ap\*\*\*\*.org>
* CVE-2024-45461:
  + Fabrício Duarte <fa\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*@gm\*\*\*.com>
* CVE-2024-45462:
  + Arthur Souza
  + Felipe Olivaes
* CVE-2024-45693:
  + Arthur Souza
  + Felipe Olivaes

### Affected versions

* CVE-2024-45219:
  + Apache CloudStack 4.0.0 through 4.18.2.3
  + Apache CloudStack 4.0.0 through 4.19.1.1
* CVE-2024-45461:
  + Apache CloudStack 4.7.0 through 4.18.2.3
  + Apache CloudStack 4.7.0 through 4.19.1.1
* CVE-2024-45462:
  + Apache CloudStack 4.15.1.0 through 4.18.2.3
  + Apache CloudStack 4.15.1.0 through 4.19.1.1
* CVE-2024-45693:
  + Apache CloudStack 4.15.1.0 through 4.18.2.3
  + Apache CloudStack 4.15.1.0 through 4.19.1.1

## Resolution

ShapeBlue, along with the Apache CloudStack community have released security releases [4.18.2.4](https://github.com/apache/cloudstack/releases/tag/4.18.2.4) and [4.19.1.2](https://github.com/apache/cloudstack/releases/tag/4.19.1.2) to address the CVEs listed above. Users are recommended to upgrade to version 4.18.2.4, 4.19.1.2 or later, which addresses these issues. Additionally, users on a version older than 4.19.1.0 are advised to skip 4.19.1.0 and upgrade to 4.19.1.2 instead.

For CVE-2024-45219, all user-uploaded or registered KVM-compatible templates and volumes can be scanned and checked that they are flat files that should not be using any additional or unnecessary features. For example, operators can run this on their secondary storage(s) and inspect output. An empty output for the disk being validated means it has no references to the host filesystems; on the other hand, if the output for the disk being validated is not empty, it might indicate a compromised disk.

`for file in $(find /path/to/storage/ -type f -regex [a-f0-9\-]*.*); do echo "Retrieving file [$file] info. If the output is not empty, that might indicate a compromised disk; check it carefully."; qemu-img info -U $file | grep file: ; printf "\n\n"; done`

The command can also be run for the file-based primary storages; however, bear in mind that (i) volumes created from templates will have references for the templates at first and (ii) volumes can be consolidated while migrating, losing their references to the templates. Therefore, the command execution for the primary storages can show both false positives and false negatives. For checking the whole template/volume features of each disk, operators can run the following command:

`for file in $(find /path/to/storage/ -type f -regex [a-f0-9\-]*.*); do echo "Retrieving file [$file] info."; qemu-img info -U $file; printf "\n\n"; done`

For CVE-2024-45461, users who do not use the Quota feature are advised to disabled the plugin by setting the global setting “quota.enable.service” to “false”.

Please refer to <https://www.shapeblue.com/cloudstack-packages/> for usage of ShapeBlue provided 4.18-based and 4.19-based LTS security patch releases. To apply these patches, use the ShapeBlue CloudStack 4.18 or 4.19 repositories to upgrade packages on the management server hosts and the KVM hosts. Post upgrade, admin users are also advised to destroy and recreate SSVMs in their zones.

## Further information

For ShapeBlue support customers, please get in touch with the support team for further information. For other CloudStack users, please use the [community mailing lists](https://cloudstack.apache.org/mailing-lists).

![Rohit Yadav](https://secure.gravatar.com/avatar/d4b37f873c552c5b3c5e12354e098e06?s=100&d=mm&r=g)[Rohit Yadav](https://www.shapeblue.com/author/rohit/)

Rohit Yadav oversees the Software Engineering function at ShapeBlue, providing leadership and mentorship to our ever-growing Engineering Team. He has been a PMC member of the project since 2015. Rohit is the author & maintainer of the CloudStack CloudMonkey project and has been instrumental in the development of many of CloudStack’s flagship features. Rohit regularly speaks at events, focussing on developer access to the project, and has also mentored Google Summer of Code students.

* [by Rohit Yadav](https://www.shapeblue.com/author/rohit/)
* 3  min read
* October 15, 2024
* [Advisories](https://www.shapeblue.com/category/advisories/)

Share:

### Related Posts:

[![](https://www.shapeblue.com/wp-content/uploads/2024/11/acs-security-release-november-1024x536.jpg)](https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-5-and-4-19-1-3/)

## [ShapeBlue Security Advisory: Apache CloudStack Security Releases 4.18.2.5 and 4.19.1.3](https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-5-and-4-19-1-3/)

* [Ivet Petrova](https://www.shapeblue.com/author/ivet-petrova/)
* November 12, 2024

* Category:
* [Advisories](https://www.shapeblue.com/category/advisories/)

[![](https://www.shapeblue.com/wp-content/uploads/2024/08/SB-Sec-Advisory-1024x536.png)](https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-3-and-4-19-1-1/)

## [ShapeBlue Security Advisory: Apache CloudStack Security Releases 4.18.2.3 and 4.19.1.1](https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-3-and-4-19-1-1/)

* [Rohit Yadav](https://www.shapeblue.com/author/rohit/)
* August 6, 2024

* Category:
* [Advisories](https://www.shapeblue.com/category/advisories/)

## Our Services

* [CloudStack Software Engineering](https://www.shapeblue.com/cloudstack-software-engineering/)
* [CloudStack Support](https://www.shapeblue.com/cloudstack-infrastructure-support/)
* [IAAS Cloud Design & Build](https://www.shapeblue.com/iaas-cloud-design-and-build/)
* [CloudStack Consulting](https://www.shapeblue.com/cloudstack-consulting/)
* [CloudStack Training](https://www.shapeblue.com/cloudstack-training/)

## Apache CloudStack

* [Overview](https://www.shapeblue.com/apache-cloudstack-overview/)
* [Integrations](https://www.shapeblue.com/apache-cloudstack-integrations/)
* [Use Cases](https://www.shapeblue.com/apache-cloudstack-use-cases/)
* [Community](https://www.shapeblue.com/apache-cloudstack-community/)
* [Events](https://www.shapeblue.com/events/)

[![Good Business Charter White Logo](https://www.shapeblue.com/wp-content/uploads/elementor/thumbs/gbc-accredited-stamp-transparent-white-rgb-qkt4y8oxgxbzzhs3mpkbdemggj1zipykifp2biclss.png "gbc-accredited-stamp-transparent-white-rgb")](https://www.shapeblue.com/shapeblue-joins-the-good-business-charter/)

![](https://www.shapeblue.com/wp-content/uploads/2023/07/eoa-proudly-employee-owned-1024x434-1.png)

## Resources

* [Blogs & News](https://www.shapeblue.com/blogs-news/)
* [Case Studies](https://www.shapeblue.com/case-studies/)

## [Contact](https://www.shapeblue.com/offices/)

## [About](https://www.shapeblue.com/about/)

## [CloudStack Packages](https://www.shapeblue.com/cloudstack-packages/)

* eursales@shapeblue.com
* +44(0) 20 3603 0540

[Twitter](https://twitter.com/shapeblue)

[Facebook](https://www.facebook.com/shapeblueltd/)

[Linkedin-in](https://www.linkedin.com/company/shapeblue/)

[![Good Business Charter White Logo](https://www.shapeblue.com/wp-content/uploads/elementor/thumbs/gbc-accredited-stamp-transparent-white-rgb-qkt4y8oxgxbzzhs3mpkbdemggj1zipykifp2biclss.png "gbc-accredited-stamp-transparent-white-rgb")](https://www.shapeblue.com/shapeblue-joins-the-good-business-charter/)

![](https://www.shapeblue.com/wp-content/uploads/2023/07/eoa-proudly-employee-owned-1024x434-1-300x127.png)

![](https://www.shapeblue.com/wp-content/uploads/2023/07/Map-1.svg)
[London](https://www.shapeblue.com/offices#london)
[MOUNTAINVIEW, CA](https://www.shapeblue.com/offices#mountain-view)
[SÃO PAULO](https://www.shapeblue.com/offices#brasil)
[Cape town](https://www.shapeblue.com/offices#cape-town)
[bangalore](https://www.shapeblue.com/offices#india)

[Twitter](https://twitter.com/shapeblue)

[Facebook](https://www.facebook.com/shapeblueltd/)

[Linkedin-in](https://www.linkedin.com/company/shapeblue/)

[Github](https://github.com/shapeblue)

© Copyright – ShapeBlue Ltd 2013-2024. All rights reserved.

ShapeBlue Ltd is a company incorporated in England & Wales. ShapeBlue is a registered trademark.

CloudStack and the CloudStack logo are trademarks of the Apache Software Foundation.

* [ShapeBlue Support Matrix](https://www.shapeblue.com/wp-content/uploads/2024/08/Support-Matrix-August-2024.pdf)
* [Terms and Conditions](https://www.shapeblue.com/terms-and-conditions/)
* [Privacy Policy](https://www.shapeblue.com/privacy-policy/)

![Cleantalk Pixel](https://moderate8-v4.cleantalk.org/pixel/e19df930d596579f9a59f1ec1eb287cc.gif "Cleantalk Pixel")[ShapeBlue](https://www.shapeblue.com/?blackhole=495a18b9c0 "Do NOT follow this link or you will be banned from the site!")

![](https://www.shapeblue.com/wp-content/uploads/2024/04/vmware-to-apache-cloudstack-768x401.png)

#### [**Migration Guide: VMware to Apache CloudStack**](https://www.shapeblue.com/vmware-to-apache-cloudstack-migration-guide/)

Download a step-by-step guide to migrate your existing vSphere environment to a robust IaaS cloud environment based on Apache CloudStack and the KVM Hypervisor, ensuring a smooth, low-friction migration journey.

[Learn more](https://www.shapeblue.com/vmware-to-apache-cloudstack-migration-guide/)

