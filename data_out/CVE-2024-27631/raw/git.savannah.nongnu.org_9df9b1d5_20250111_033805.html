<!DOCTYPE html>
<html lang='en'>
<head>
<title>administration/savane.git - Savannah's Savane</title>
<meta name='generator' content='cgit v1.1'/>
<meta name='robots' content='index, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-css/cgit.css'/>
<link rel='shortcut icon' href='/gitweb/git-favicon.png'/>
<link rel='alternate' title='Atom feed' href='https://git.savannah.nongnu.org/cgit/administration/savane.git/atom/?h=i18n' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.savannah.gnu.org/administration/savane.git' title='administration/savane.git Git repository'/>
<link rel='vcs-git' href='https://git.savannah.gnu.org/git/administration/savane.git' title='administration/savane.git Git repository'/>
<link rel='vcs-git' href='ssh://git.savannah.gnu.org/srv/git/administration/savane.git' title='administration/savane.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/cgit/'><img src='/cgit-css/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/cgit/'>index</a> : <a title='administration/savane.git' href='/cgit/administration/savane.git/'>administration/savane.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='d3962d3feb75467489b869204db98e2dffaaaf09'/><select name='h' onchange='this.form.submit();'>
<option value='frontend'>frontend</option>
<option value='i18n' selected='selected'>i18n</option>
<option value='master'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Savannah's Savane</td><td class='sub right'></td></tr></table>
<table class='tabs'><tr><td>
<a href='/cgit/administration/savane.git/?h=i18n'>summary</a><a href='/cgit/administration/savane.git/refs/?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>refs</a><a href='/cgit/administration/savane.git/log/?h=i18n'>log</a><a href='/cgit/administration/savane.git/tree/?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>tree</a><a class='active' href='/cgit/administration/savane.git/commit/?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>commit</a><a href='/cgit/administration/savane.git/diff/?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>diff</a></td><td class='form'><form class='right' method='get' action='/cgit/administration/savane.git/log/'>
<input type='hidden' name='h' value='i18n'/><input type='hidden' name='id' value='d3962d3feb75467489b869204db98e2dffaaaf09'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='text' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='h' value='i18n'/><input type='hidden' name='id' value='d3962d3feb75467489b869204db98e2dffaaaf09'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Ineiev &lt;ineiev@gnu.org&gt;</td><td class='right'>2024-01-19 19:34:43 +0000</td></tr>
<tr><th>committer</th><td>Ineiev &lt;ineiev@gnu.org&gt;</td><td class='right'>2024-02-05 10:19:28 +0000</td></tr>
<tr><th>commit</th><td colspan='2' class='sha1'><a href='/cgit/administration/savane.git/commit/?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>d3962d3feb75467489b869204db98e2dffaaaf09</a> (<a href='/cgit/administration/savane.git/patch/?id=d3962d3feb75467489b869204db98e2dffaaaf09'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='sha1'><a href='/cgit/administration/savane.git/tree/?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>64d97ec7ec08c8d490b00127582807d7dca00c4f</a></td></tr>
<tr><th>parent</th><td colspan='2' class='sha1'><a href='/cgit/administration/savane.git/commit/?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>dc8aed89037abadb612f2e46dcb703503fcfd7cd</a> (<a href='/cgit/administration/savane.git/diff/?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09&amp;id2=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='sha1'><a href='/cgit/administration/savane.git/snapshot/savane-d3962d3feb75467489b869204db98e2dffaaaf09.tar.gz'>savane-d3962d3feb75467489b869204db98e2dffaaaf09.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>add form_check calls</div><div class='commit-msg'>Replace GET with POST when changes are made in the database
and vice versa.

Reported by Ally Petitt.
</div><div class='diffstat-header'><a href='/cgit/administration/savane.git/diff/?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/NEWS?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>NEWS</a></td><td class='right'>3</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 97.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/account/impersonate.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/impersonate.php</a></td><td class='right'>29</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 15.5%;'/><td class='rem' style='width: 12.6%;'/><td class='none' style='width: 71.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/account/login.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/login.php</a></td><td class='right'>4</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 1.0%;'/><td class='none' style='width: 96.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/account/lostlogin.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/lostlogin.php</a></td><td class='right'>3</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 1.9%;'/><td class='none' style='width: 97.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/account/lostpw-confirm.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/lostpw-confirm.php</a></td><td class='right'>3</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 1.9%;'/><td class='none' style='width: 97.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/account/register.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/register.php</a></td><td class='right'>6</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 2.9%;'/><td class='none' style='width: 94.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/account/verify.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/verify.php</a></td><td class='right'>1</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 99.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/conf-copy.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/conf-copy.php</a></td><td class='right'>1</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 99.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/editqueryforms.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/editqueryforms.php</a></td><td class='right'>42</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 20.4%;'/><td class='rem' style='width: 20.4%;'/><td class='none' style='width: 59.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/field_usage.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/field_usage.php</a></td><td class='right'>37</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 14.6%;'/><td class='rem' style='width: 21.4%;'/><td class='none' style='width: 64.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/field_values.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/field_values.php</a></td><td class='right'>103</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 51.5%;'/><td class='rem' style='width: 48.5%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/field_values_reset.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/field_values_reset.php</a></td><td class='right'>17</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 6.8%;'/><td class='rem' style='width: 9.7%;'/><td class='none' style='width: 83.5%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/field_values_transition-ofields-update.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/field_values_transition-ofields-update.php</a></td><td class='right'>1</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 99.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/notification_settings.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/notification_settings.php</a></td><td class='right'>5</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 1.9%;'/><td class='none' style='width: 95.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/other_settings.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/other_settings.php</a></td><td class='right'>42</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 20.4%;'/><td class='rem' style='width: 20.4%;'/><td class='none' style='width: 59.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/bugs/admin/userperms.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/userperms.php</a></td><td class='right'>7</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 3.9%;'/><td class='none' style='width: 93.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/cvs/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/cvs/admin/index.php</a></td><td class='right'>103</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 55.3%;'/><td class='rem' style='width: 44.7%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/forum/forum.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/forum/forum.php</a></td><td class='right'>1</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 99.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/git/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/git/admin/index.php</a></td><td class='right'>37</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 14.6%;'/><td class='rem' style='width: 21.4%;'/><td class='none' style='width: 64.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/i18n.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/i18n.php</a></td><td class='right'>7</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 3.9%;'/><td class='none' style='width: 93.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/form.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/form.php</a></td><td class='right'>18</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 16.5%;'/><td class='rem' style='width: 1.0%;'/><td class='none' style='width: 82.5%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/html.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/html.php</a></td><td class='right'>11</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 7.8%;'/><td class='rem' style='width: 2.9%;'/><td class='none' style='width: 89.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/my/bookmarks.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/my/bookmarks.php</a></td><td class='right'>41</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 38.8%;'/><td class='rem' style='width: 1.0%;'/><td class='none' style='width: 60.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/news/forum.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/news/forum.php</a></td><td class='right'>4</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.9%;'/><td class='rem' style='width: 1.9%;'/><td class='none' style='width: 96.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/news/general.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/news/general.php</a></td><td class='right'>6</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 2.9%;'/><td class='none' style='width: 94.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/people/general.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/people/general.php</a></td><td class='right'>27</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 10.7%;'/><td class='rem' style='width: 15.5%;'/><td class='none' style='width: 73.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/sendmail.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/sendmail.php</a></td><td class='right'>26</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 9.7%;'/><td class='rem' style='width: 15.5%;'/><td class='none' style='width: 74.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/sitemenu.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/sitemenu.php</a></td><td class='right'>33</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 13.6%;'/><td class='rem' style='width: 18.4%;'/><td class='none' style='width: 68.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/trackers/data.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/trackers/data.php</a></td><td class='right'>18</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 8.7%;'/><td class='rem' style='width: 8.7%;'/><td class='none' style='width: 82.5%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/include/trackers/view-dependencies.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/trackers/view-dependencies.php</a></td><td class='right'>5</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.9%;'/><td class='rem' style='width: 2.9%;'/><td class='none' style='width: 95.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/mail/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/mail/admin/index.php</a></td><td class='right'>4</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 1.0%;'/><td class='none' style='width: 96.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/markup-test.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/markup-test.php</a></td><td class='right'>7</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 5.8%;'/><td class='rem' style='width: 1.0%;'/><td class='none' style='width: 93.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/admin/change.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/change.php</a></td><td class='right'>7</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 3.9%;'/><td class='rem' style='width: 2.9%;'/><td class='none' style='width: 93.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/admin/change_notifications.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/change_notifications.php</a></td><td class='right'>22</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 11.7%;'/><td class='rem' style='width: 9.7%;'/><td class='none' style='width: 78.6%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/admin/editsshkeys.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/editsshkeys.php</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 1.0%;'/><td class='none' style='width: 98.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/index.php</a></td><td class='right'>30</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 13.6%;'/><td class='rem' style='width: 15.5%;'/><td class='none' style='width: 70.9%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/admin/resume.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/resume.php</a></td><td class='right'>60</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 28.2%;'/><td class='rem' style='width: 30.1%;'/><td class='none' style='width: 41.7%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/bookmarks.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/bookmarks.php</a></td><td class='right'>36</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 32.0%;'/><td class='none' style='width: 65.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/groups.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/groups.php</a></td><td class='right'>22</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 11.7%;'/><td class='rem' style='width: 9.7%;'/><td class='none' style='width: 78.6%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/quitproject.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/quitproject.php</a></td><td class='right'>32</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 15.5%;'/><td class='rem' style='width: 15.5%;'/><td class='none' style='width: 68.9%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/my/votes.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/votes.php</a></td><td class='right'>10</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 4.9%;'/><td class='rem' style='width: 4.9%;'/><td class='none' style='width: 90.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/news/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/news/admin/index.php</a></td><td class='right'>22</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 8.7%;'/><td class='rem' style='width: 12.6%;'/><td class='none' style='width: 78.6%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/news/approve.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/news/approve.php</a></td><td class='right'>12</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 5.8%;'/><td class='rem' style='width: 5.8%;'/><td class='none' style='width: 88.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/news/submit.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/news/submit.php</a></td><td class='right'>11</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 4.9%;'/><td class='rem' style='width: 5.8%;'/><td class='none' style='width: 89.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/people/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/people/admin/index.php</a></td><td class='right'>71</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 35.9%;'/><td class='rem' style='width: 33.0%;'/><td class='none' style='width: 31.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/people/createjob.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/people/createjob.php</a></td><td class='right'>3</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 1.9%;'/><td class='none' style='width: 97.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/people/editjob.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/people/editjob.php</a></td><td class='right'>25</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 12.6%;'/><td class='rem' style='width: 11.7%;'/><td class='none' style='width: 75.7%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/project/admin/editgroupfeatures.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/editgroupfeatures.php</a></td><td class='right'>9</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 3.9%;'/><td class='rem' style='width: 4.9%;'/><td class='none' style='width: 91.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/project/admin/editgroupinfo.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/editgroupinfo.php</a></td><td class='right'>32</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 14.6%;'/><td class='rem' style='width: 16.5%;'/><td class='none' style='width: 68.9%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/project/admin/editgroupnotifications.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/editgroupnotifications.php</a></td><td class='right'>9</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 2.9%;'/><td class='rem' style='width: 5.8%;'/><td class='none' style='width: 91.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/project/admin/squadadmin.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/squadadmin.php</a></td><td class='right'>35</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 15.5%;'/><td class='rem' style='width: 18.4%;'/><td class='none' style='width: 66.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/project/admin/useradmin.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/useradmin.php</a></td><td class='right'>17</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 8.7%;'/><td class='rem' style='width: 7.8%;'/><td class='none' style='width: 83.5%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/project/admin/userperms.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/userperms.php</a></td><td class='right'>27</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 12.6%;'/><td class='rem' style='width: 13.6%;'/><td class='none' style='width: 73.8%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/register/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/register/index.php</a></td><td class='right'>9</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 3.9%;'/><td class='rem' style='width: 4.9%;'/><td class='none' style='width: 91.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/register/upload.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/register/upload.php</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.9%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 98.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/sendmessage.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/sendmessage.php</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.9%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 98.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/siteadmin/group_type.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/group_type.php</a></td><td class='right'>8</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 4.9%;'/><td class='rem' style='width: 2.9%;'/><td class='none' style='width: 92.2%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/siteadmin/groupedit.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/groupedit.php</a></td><td class='right'>59</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 33.0%;'/><td class='rem' style='width: 24.3%;'/><td class='none' style='width: 42.7%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/siteadmin/grouplist.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/grouplist.php</a></td><td class='right'>11</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 4.9%;'/><td class='rem' style='width: 5.8%;'/><td class='none' style='width: 89.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/siteadmin/mailman.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/mailman.php</a></td><td class='right'>10</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 5.8%;'/><td class='rem' style='width: 3.9%;'/><td class='none' style='width: 90.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/siteadmin/triggercreation.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/triggercreation.php</a></td><td class='right'>1</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 99.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/siteadmin/user_changepw.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/user_changepw.php</a></td><td class='right'>1</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 1.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 99.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/siteadmin/usergroup.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/usergroup.php</a></td><td class='right'>55</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 34.0%;'/><td class='rem' style='width: 19.4%;'/><td class='none' style='width: 46.6%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/siteadmin/userlist.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/userlist.php</a></td><td class='right'>50</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 3.9%;'/><td class='rem' style='width: 44.7%;'/><td class='none' style='width: 51.5%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/php/testing/sane.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/testing/sane.php</a></td><td class='right'>11</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 4.9%;'/><td class='rem' style='width: 5.8%;'/><td class='none' style='width: 89.3%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/cgit/administration/savane.git/diff/frontend/site-specific/gnu/gpg-sample.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/site-specific/gnu/gpg-sample.php</a></td><td class='right'>9</td><td class='graph'><table summary='file diffstat' width='100%'><tr><td class='add' style='width: 8.7%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 91.3%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>66 files changed, 694 insertions, 680 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/NEWS b/NEWS<br/>index 8a2eaf0..fc3f3bf 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/NEWS?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>NEWS</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/NEWS?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>NEWS</a></div><div class='hunk'>@@ -40,6 +40,9 @@</div><div class='ctx'> </div><div class='ctx'> * News are previewed more realistically, including titles and attributes.</div><div class='ctx'> </div><div class='add'>+* Whenever the user requests an update in the database, the POST method</div><div class='add'>+  is used, and the form_id is checked.</div><div class='add'>+</div><div class='ctx'> * Bug fixes:</div><div class='ctx'> </div><div class='ctx'> ** Email notifications from trackers included a localized</div><div class='head'>diff --git a/frontend/php/account/impersonate.php b/frontend/php/account/impersonate.php<br/>index 5313677..d3a91e3 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/account/impersonate.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/account/impersonate.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/account/impersonate.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/impersonate.php</a></div><div class='hunk'>@@ -40,22 +40,25 @@</div><div class='ctx'> # You should have received a copy of the GNU General Public License</div><div class='ctx'> # along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</div><div class='ctx'> </div><div class='del'>-require_once('../include/init.php');</div><div class='add'>+require_once ('../include/init.php');</div><div class='add'>+if (!user_is_super_user ())</div><div class='add'>+  exit_error (_("You need to be site administrator to use this feature."));</div><div class='ctx'> </div><div class='del'>-if (!user_is_super_user())</div><div class='del'>-  exit_error(_("You need to be site administrator to use this feature."));</div><div class='add'>+extract (sane_import ('post',</div><div class='add'>+  ['name' =&gt; 'user_name', 'internal_uri' =&gt; 'uri', true =&gt; 'impersonate']</div><div class='add'>+));</div><div class='add'>+form_check ('impersonate');</div><div class='ctx'> </div><div class='del'>-extract(sane_import('post', ['name' =&gt; 'user_name', 'internal_uri' =&gt; 'uri']));</div><div class='del'>-</div><div class='del'>-$new_uid = user_getid($user_name);</div><div class='add'>+$new_uid = user_getid ($user_name);</div><div class='ctx'> if ($new_uid == 0)</div><div class='del'>-  exit_error(_("This user doesn't exist."));</div><div class='add'>+  exit_error (_("This user doesn't exist."));</div><div class='ctx'> </div><div class='ctx'> # Modify session information to become the target user.</div><div class='del'>-extract(sane_import('cookie', ['hash' =&gt; 'session_hash']));</div><div class='del'>-$result = db_execute("UPDATE session SET user_id=? WHERE session_hash=?",</div><div class='del'>-                     array($new_uid, $session_hash));</div><div class='del'>-session_cookie('session_uid', $new_uid);</div><div class='del'>-</div><div class='del'>-header("Location: $uri");</div><div class='add'>+extract (sane_import ('cookie', ['hash' =&gt; 'session_hash']));</div><div class='add'>+$result = db_execute (</div><div class='add'>+  "UPDATE session SET user_id = ? WHERE session_hash = ?",</div><div class='add'>+  [$new_uid, $session_hash]</div><div class='add'>+);</div><div class='add'>+session_cookie ('session_uid', $new_uid);</div><div class='add'>+header ("Location: $uri");</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/account/login.php b/frontend/php/account/login.php<br/>index 626d3ab..d3a9ede 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/account/login.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/account/login.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/account/login.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/login.php</a></div><div class='hunk'>@@ -52,7 +52,7 @@ if (user_isloggedin () &amp;&amp; !$from_brother)</div><div class='ctx'>   session_redirect ("{$sys_home}my/");</div><div class='ctx'> </div><div class='ctx'> # Input checks.</div><div class='del'>-extract(sane_import('request',</div><div class='add'>+extract (sane_import('request',</div><div class='ctx'>   [</div><div class='ctx'>     'true' =&gt; ['brotherhood', 'cookie_for_a_year', 'login', 'cookie_test'],</div><div class='ctx'>     'name' =&gt; 'form_loginname',</div><div class='hunk'>@@ -60,6 +60,8 @@ extract(sane_import('request',</div><div class='ctx'>     'internal_uri' =&gt; 'uri'</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+if (!$from_brother)</div><div class='add'>+  form_check ('login');</div><div class='ctx'> </div><div class='ctx'> $stay_in_ssl = session_stay_in_ssl ();</div><div class='ctx'> $uri_enc = utils_urlencode ($uri);</div><div class='head'>diff --git a/frontend/php/account/lostlogin.php b/frontend/php/account/lostlogin.php<br/>index 1756106..bc8a6f8 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/account/lostlogin.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/account/lostlogin.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/account/lostlogin.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/lostlogin.php</a></div><div class='hunk'>@@ -54,8 +54,7 @@ extract (sane_import ('post',</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='ctx'> </div><div class='del'>-if ($update)</div><div class='del'>-  form_check ();</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> $res_lostuser = db_execute (</div><div class='ctx'>   "SELECT * FROM user WHERE confirm_hash = ?", [$confirm_hash]</div><div class='head'>diff --git a/frontend/php/account/lostpw-confirm.php b/frontend/php/account/lostpw-confirm.php<br/>index 1f1b3ee..e3da227 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/account/lostpw-confirm.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/account/lostpw-confirm.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/account/lostpw-confirm.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/lostpw-confirm.php</a></div><div class='hunk'>@@ -46,13 +46,12 @@ foreach (['init', 'sane', 'sendmail', 'random-bytes'] as $inc)</div><div class='ctx'>   require_once ("../include/$inc.php");</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post', ['name' =&gt; 'form_loginname']));</div><div class='add'>+form_check ();</div><div class='ctx'> </div><div class='ctx'> # Logged users have no business here.</div><div class='ctx'> if (user_isloggedin ())</div><div class='ctx'>   session_redirect ("{$sys_home}my/");</div><div class='ctx'> </div><div class='del'>-form_check ();</div><div class='del'>-</div><div class='ctx'> $confirm_hash = md5 (random_bytes (8));</div><div class='ctx'> # Account check.</div><div class='ctx'> $res_user = db_execute ("</div><div class='head'>diff --git a/frontend/php/account/register.php b/frontend/php/account/register.php<br/>index 6247972..da177d6 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/account/register.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/account/register.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/account/register.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/register.php</a></div><div class='hunk'>@@ -50,7 +50,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'name' =&gt; 'form_loginname',</div><div class='ctx'>     'pass' =&gt; ['form_pw', 'form_pw2', 'form_realname', 'form_email'],</div><div class='ctx'>     'digits' =&gt; 'form_year',</div><div class='del'>-    'true' =&gt; ['update', 'form_usepam']</div><div class='add'>+    'true' =&gt; ['update']</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='ctx'> foreach (['form_realname', 'form_email', 'form_year'] as $v)</div><div class='hunk'>@@ -117,9 +117,9 @@ if (!empty ($update))</div><div class='ctx'> </div><div class='ctx'>     if ($form_pw == '')</div><div class='ctx'>       fb (_("You must supply a password."), 1);</div><div class='del'>-    elseif ($form_usepam != 1 &amp;&amp; $form_pw != $form_pw2)</div><div class='add'>+    elseif ($form_pw != $form_pw2)</div><div class='ctx'>       fb (_("Passwords do not match."), 1);</div><div class='del'>-    elseif ($form_usepam != 1 &amp;&amp; !account_pwvalid ($form_pw))</div><div class='add'>+    elseif (!account_pwvalid ($form_pw))</div><div class='ctx'>       {</div><div class='ctx'>         # Feedback included by the check function.</div><div class='ctx'>       }</div><div class='head'>diff --git a/frontend/php/account/verify.php b/frontend/php/account/verify.php<br/>index dfb0844..66032fc 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/account/verify.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/account/verify.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/account/verify.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/account/verify.php</a></div><div class='hunk'>@@ -53,6 +53,7 @@ extract (sane_import ('post',</div><div class='ctx'> # Must accept all ways of providing confirm_hash because in the mail it is a GET</div><div class='ctx'> # but if the form fails (wrong password, etc), it will be a POST.</div><div class='ctx'> extract (sane_import ('request', ['hash' =&gt; 'confirm_hash']));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> # Logged users have no business here.</div><div class='ctx'> if (user_isloggedin ())</div><div class='head'>diff --git a/frontend/php/bugs/admin/conf-copy.php b/frontend/php/bugs/admin/conf-copy.php<br/>index a155291..6a29397 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/conf-copy.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/conf-copy.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/conf-copy.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/conf-copy.php</a></div><div class='hunk'>@@ -48,6 +48,7 @@ require_once ('../../include/trackers/conf.php');</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   ['true' =&gt; 'update', 'digits' =&gt; 'from_group_id']</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='head'>diff --git a/frontend/php/bugs/admin/editqueryforms.php b/frontend/php/bugs/admin/editqueryforms.php<br/>index 1f0290f..638bbf0 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/editqueryforms.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/editqueryforms.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/editqueryforms.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/editqueryforms.php</a></div><div class='hunk'>@@ -45,13 +45,13 @@</div><div class='ctx'> require_once ('../../include/init.php');</div><div class='ctx'> require_once ('../../include/trackers/general.php');</div><div class='ctx'> extract (sane_import ('request', ['digits' =&gt; 'report_id']));</div><div class='del'>-extract (sane_import ('get',</div><div class='del'>-  ['true' =&gt; ['show_report', 'new_report', 'delete_report']]</div><div class='del'>-));</div><div class='add'>+extract (sane_import ('get', ['true' =&gt; ['show_report', 'new_report']]));</div><div class='ctx'> $names = [];</div><div class='del'>-$names['true'] = [</div><div class='del'>-  'post_changes', 'set_default', 'create_report', 'update_report'</div><div class='add'>+$submits = [</div><div class='add'>+  'post_changes', 'set_default', 'create_report', 'update_report',</div><div class='add'>+  'delete_report'</div><div class='ctx'> ];</div><div class='add'>+$names['true'] = $submits;</div><div class='ctx'> $names['specialchars'] = ['rep_name', 'rep_desc'];</div><div class='ctx'> $names['strings'] = [['rep_scope', 'P']];</div><div class='ctx'> </div><div class='hunk'>@@ -80,7 +80,7 @@ foreach ($prefices as $pref)</div><div class='ctx'>     $names['digits'][] = "{$pref}_$suf";</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post', $names));</div><div class='del'>-</div><div class='add'>+form_check ($submits);</div><div class='ctx'> # HELP: what we call now "query form" was previously called "report",</div><div class='ctx'> # that name is still in the database.</div><div class='ctx'> </div><div class='hunk'>@@ -241,7 +241,7 @@ if ($new_report)</div><div class='ctx'>       . "&lt;input type='text' name='rep_name' id='rep_name' value='' size='20' "</div><div class='ctx'>       . "maxlength='20' /&gt;\n&lt;/p&gt;\n&lt;p&gt;&lt;span class='preinput'&gt;"</div><div class='ctx'>       . _("Scope:") . "&lt;/span&gt;&lt;br /&gt;\n";</div><div class='del'>-    print _("Project") . form_hidden (["rep_scope" =&gt; "P"]);</div><div class='add'>+    print _("Group") . form_hidden (["rep_scope" =&gt; "P"]);</div><div class='ctx'>     print "&lt;/p&gt;\n&lt;p&gt;\n&lt;span class='preinput'&gt;&lt;label for='rep_desc'&gt;"</div><div class='ctx'>       . _("Description:") . "&lt;/label&gt;&lt;/span&gt;&lt;br /&gt;\n"</div><div class='ctx'>       . "&lt;input type='text' name='rep_desc' id='rep_desc' value='' size='50' "</div><div class='hunk'>@@ -365,15 +365,16 @@ if ($show_report)</div><div class='ctx'>           "update_report" =&gt; "y", "group_id" =&gt; $group_id,</div><div class='ctx'>           "report_id" =&gt; $report_id, "post_changes" =&gt; "y"</div><div class='ctx'>         ]);</div><div class='del'>-    print '&lt;span class="preinput"&gt;&lt;label for="rep_name"&gt;'</div><div class='add'>+    print '&lt;p&gt;&lt;span class="preinput"&gt;&lt;label for="rep_name"&gt;'</div><div class='ctx'>       . _("Name:") . "&lt;/label&gt;&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;&amp;nbsp;"</div><div class='del'>-      . '&lt;input type="text" name="rep_name" id="rep_name" value="'</div><div class='del'>-      . db_result ($res, 0, 'name') . "\" size='20' maxlength='20' /&gt;\n";</div><div class='add'>+      . form_input ('text', 'rep_name', db_result ($res, 0, 'name'),</div><div class='add'>+          "size='20' maxlength='20'")</div><div class='add'>+      . "\n&lt;/p&gt;\n";</div><div class='ctx'>     print "&lt;p&gt;\n&lt;span class='preinput'&gt;&lt;label for='rep_desc'&gt;"</div><div class='ctx'>       . _("Description:") . "&lt;/label&gt;&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n"</div><div class='del'>-      . '&lt;input type="text" name="rep_desc" id="rep_desc" value="'</div><div class='del'>-      . db_result ($res, 0, 'description')</div><div class='del'>-      . "\" size='50' maxlength='120' /&gt;&lt;/p&gt;\n&lt;p&gt;";</div><div class='add'>+      . form_input ('text', 'rep_desc', db_result ($res, 0, 'description'),</div><div class='add'>+          "size='50' maxlength='120'")</div><div class='add'>+      . "\n&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='ctx'>     print html_build_list_table_top ($title_arr);</div><div class='ctx'>     $i = 0;</div><div class='hunk'>@@ -508,19 +509,18 @@ if ($rows)</div><div class='ctx'> </div><div class='ctx'>         print "\n&lt;td&gt;{$arr['description']}&lt;/td&gt;\n"</div><div class='ctx'>           . "\n&lt;td align=\"center\"&gt;"</div><div class='del'>-          . (($arr['scope'] == 'P')? _("Project"): _("Personal")) . '&lt;/td&gt;'</div><div class='add'>+          . (($arr['scope'] == 'P')? _("Group"): _("Personal")) . '&lt;/td&gt;'</div><div class='ctx'>           . "\n&lt;td align=\"center\"&gt;";</div><div class='ctx'> </div><div class='ctx'>         if (($arr['scope'] == 'P') &amp;&amp; !user_ismember ($group_id, 'A'))</div><div class='ctx'>           print '-';</div><div class='ctx'>         else</div><div class='del'>-          {</div><div class='del'>-            print '&lt;a href="'</div><div class='del'>-              . "$php_self?group=$group"</div><div class='del'>-              . '&amp;amp;delete_report=1&amp;amp;report_id='.$arr['report_id']</div><div class='del'>-              . '&amp;amp;rep_name=' . utils_urlencode ($arr['name']) . '"&gt;'</div><div class='del'>-              .  html_image_trash () . '&lt;/a&gt;';</div><div class='del'>-          }</div><div class='add'>+          print form_tag ()</div><div class='add'>+            . form_hidden([</div><div class='add'>+                'delete_report' =&gt; 1, 'report_id' =&gt; $arr['report_id'],</div><div class='add'>+                'group' =&gt; $group, 'rep_name' =&gt; utils_urlencode ($arr['name'])</div><div class='add'>+              ])</div><div class='add'>+            . form_image_trash ('del_rep') . "&lt;/form&gt;\n";</div><div class='ctx'>         print "&lt;/td&gt;\n&lt;/tr&gt;\n";</div><div class='ctx'>         $i++;</div><div class='ctx'>       }</div><div class='head'>diff --git a/frontend/php/bugs/admin/field_usage.php b/frontend/php/bugs/admin/field_usage.php<br/>index c034521..04421ef 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/field_usage.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/field_usage.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/field_usage.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/field_usage.php</a></div><div class='hunk'>@@ -49,12 +49,10 @@ $is_admin_page = 'y';</div><div class='ctx'> extract (sane_import ('request',</div><div class='ctx'>   ['name' =&gt; 'field', 'true' =&gt; 'update_field']</div><div class='ctx'> ));</div><div class='add'>+$submits = ['post_changes', 'submit', 'reset'];</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt;</div><div class='del'>-      [</div><div class='del'>-        'post_changes', 'submit', 'reset'</div><div class='del'>-      ],</div><div class='add'>+    'true' =&gt; $submits,</div><div class='ctx'>     'specialchars' =&gt; ['label', 'description'],</div><div class='ctx'>     'digits' =&gt;</div><div class='ctx'>       [</div><div class='hunk'>@@ -70,6 +68,7 @@ extract (sane_import ('post',</div><div class='ctx'>        ]</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ($submits);</div><div class='ctx'> </div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='hunk'>@@ -350,32 +349,26 @@ if ($update_field)</div><div class='ctx'>         if (db_numrows ($result) &gt; 0)</div><div class='ctx'>           $transition_default_auth =</div><div class='ctx'>             db_result ($result, 0, 'transition_default_auth');</div><div class='del'>-        $ck_str = ' checked="checked"';</div><div class='ctx'>         $ck = $transition_default_auth !='F';</div><div class='del'>-        $ck1 = $ck? $ck_str: '';</div><div class='del'>-        $ck2 = $ck? '': $ck_str;</div><div class='ctx'>         print "\n\n&lt;p&gt;&amp;nbsp;&lt;/p&gt;\n&lt;h2&gt;"</div><div class='ctx'>           . _("By default, transitions (from one value to another) are:")</div><div class='ctx'>           . "&lt;/h2&gt;\n";</div><div class='del'>-        print '&lt;input type="radio" '</div><div class='del'>-          . "name='form_transition_default_auth'\n"</div><div class='del'>-          . "id='form_transition_default_auth_allowed' value='A'$ck1"</div><div class='del'>-          . ' /&gt;'</div><div class='del'>-          . html_label ("form_transition_default_auth_allowed", _("Allowed"))</div><div class='del'>-          . "&lt;br /&gt;\n&lt;input "</div><div class='del'>-          . "type='radio' id='form_transition_default_auth_forbidden'\n"</div><div class='del'>-          . "name='form_transition_default_auth' value='F'$ck2"</div><div class='del'>-          . ' /&gt;'</div><div class='del'>-          . html_label (</div><div class='del'>-              "form_transition_default_auth_forbidden", _("Forbidden")</div><div class='add'>+        print</div><div class='add'>+          form_radio ('form_transition_default_auth', 'A',</div><div class='add'>+            [ 'checked' =&gt; $ck, 'label' =&gt; _("Allowed"),</div><div class='add'>+              'id' =&gt; 'form_transition_default_auth_allowed']</div><div class='add'>+          )</div><div class='add'>+          . "&lt;br /&gt;\n"</div><div class='add'>+          . form_radio ('form_transition_default_auth', 'F',</div><div class='add'>+              [ 'checked' =&gt; !$ck, 'label' =&gt; _("Forbidden"),</div><div class='add'>+                'id' =&gt; 'form_transition_default_auth_forbidden']</div><div class='ctx'>             )</div><div class='ctx'>           . "\n";</div><div class='ctx'>       }</div><div class='ctx'>     print "\n&lt;p align='center'&gt;"</div><div class='del'>-      . "&lt;input type='submit' name='submit' value=\""</div><div class='del'>-      . _("Update") . "\" /&gt;\n&amp;nbsp;&amp;nbsp;\n&lt;input type='submit' "</div><div class='del'>-      . "name='reset' value=\"" . _("Reset to defaults")</div><div class='del'>-      . "\" /&gt;&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='add'>+      . form_submit (_("Update"), 'submit') . "\n&amp;nbsp;&amp;nbsp;\n"</div><div class='add'>+      . form_submit (_("Reset to defaults"), 'reset')</div><div class='add'>+      . "&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='ctx'>     trackers_footer ();</div><div class='ctx'>     exit (0);</div><div class='ctx'>   } # if ($update_field)</div><div class='head'>diff --git a/frontend/php/bugs/admin/field_values.php b/frontend/php/bugs/admin/field_values.php<br/>index 4461250..8a857e6 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/field_values.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/field_values.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/field_values.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/field_values.php</a></div><div class='hunk'>@@ -64,7 +64,7 @@ extract (sane_import ('get',</div><div class='ctx'> ));</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt; ['post_changes', 'create_value', 'by_field_id'],</div><div class='add'>+    'true' =&gt; ['post_changes', 'create_value', 'by_field_id', 'submit'],</div><div class='ctx'>     'specialchars' =&gt; ['title', 'description', 'body'],</div><div class='ctx'>     'digits' =&gt; ['order_id', 'from', 'to'],</div><div class='ctx'>     'strings' =&gt;</div><div class='hunk'>@@ -75,6 +75,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'preg' =&gt; [['mail_list', '/^[-+_@.,\s\da-zA-Z]*$/']]</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check (['create_value', 'post_changes', 'submit']);</div><div class='ctx'> </div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='hunk'>@@ -234,6 +235,35 @@ $td_select_box = function ($field)</div><div class='ctx'>     &amp;&amp; trackers_data_is_select_box ($field);</div><div class='ctx'> };</div><div class='ctx'> </div><div class='add'>+function print_predefined_val_entry ($fld_val)</div><div class='add'>+{</div><div class='add'>+  extract ($fld_val);</div><div class='add'>+  # Non-active value are not important here.</div><div class='add'>+  if ($status != "A")</div><div class='add'>+    return;</div><div class='add'>+  print "&lt;dt&gt;&lt;b&gt;$value&lt;/b&gt; ($order_id)&lt;/dt&gt;\n";</div><div class='add'>+  print "&lt;dd&gt;$description&lt;/dd&gt;\n";</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+function list_predefined_values ($field)</div><div class='add'>+{</div><div class='add'>+  $res = trackers_data_get_field_predefined_values (</div><div class='add'>+    $field, '100', false, false, false</div><div class='add'>+  );</div><div class='add'>+  if (!db_numrows ($res))</div><div class='add'>+    {</div><div class='add'>+      $msg =</div><div class='add'>+        _("No default values found. You should report this problem to\n"</div><div class='add'>+          . "administrators.");</div><div class='add'>+      fb ($msg, 1);</div><div class='add'>+      return;</div><div class='add'>+    }</div><div class='add'>+  print "&lt;dl&gt;\n";</div><div class='add'>+  while ($fld_val = db_fetch_array ($res))</div><div class='add'>+    print_predefined_val_entry ($fld_val);</div><div class='add'>+  print "&lt;/dl&gt;\n";</div><div class='add'>+}</div><div class='add'>+</div><div class='ctx'> if ($list_value)</div><div class='ctx'>   {</div><div class='ctx'>     # Display the list of values for a given bug field.</div><div class='hunk'>@@ -412,38 +442,7 @@ if ($list_value)</div><div class='ctx'>               . _("For your information, the default active values are:")</div><div class='ctx'>               . "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='del'>-            $default_result = trackers_data_get_field_predefined_values (</div><div class='del'>-              $field, '100', false, false, false</div><div class='del'>-            );</div><div class='del'>-            $default_rows = db_numrows ($default_result);</div><div class='del'>-            $previous = false;</div><div class='del'>-            if ($default_result &amp;&amp; $default_rows &gt; 0)</div><div class='del'>-              {</div><div class='del'>-                while ($fld_val = db_fetch_array ($default_result))</div><div class='del'>-                  {</div><div class='del'>-                    $status = $fld_val['status'];</div><div class='del'>-                    $value = $fld_val['value'];</div><div class='del'>-                    $description = $fld_val['description'];</div><div class='del'>-                    $order = $fld_val['order_id'];</div><div class='del'>-</div><div class='del'>-                    # Non-active value are not important here.</div><div class='del'>-                    if ($status != "A")</div><div class='del'>-                      continue;</div><div class='del'>-</div><div class='del'>-                    if ($previous)</div><div class='del'>-                      print ", ";</div><div class='del'>-</div><div class='del'>-                    print "&lt;b&gt;$value&lt;/b&gt; &lt;span class='smaller'&gt;"</div><div class='del'>-                      . "($order, \"$description\")&lt;/span&gt;";</div><div class='del'>-                    $previous = true;</div><div class='del'>-                  }</div><div class='del'>-              }</div><div class='del'>-            else</div><div class='del'>-              fb (</div><div class='del'>-                _("No default values found. You should report this problem "</div><div class='del'>-                  . "to\nadministrators."),</div><div class='del'>-                1</div><div class='del'>-              );</div><div class='add'>+            list_predefined_values ($field);</div><div class='ctx'>           }</div><div class='ctx'>       }</div><div class='ctx'>     else # ! $td_select_box ($field)</div><div class='hunk'>@@ -587,10 +586,7 @@ if ($list_value)</div><div class='ctx'> </div><div class='ctx'>         print form_tag ([], "#registered");</div><div class='ctx'>         print form_hidden (</div><div class='del'>-          [</div><div class='del'>-            "post_transition_changes" =&gt; "y", "list_value" =&gt; "y",</div><div class='del'>-            "field" =&gt; $field, "group_id" =&gt; $group_id</div><div class='del'>-          ]</div><div class='add'>+          ["list_value" =&gt; "y", "field" =&gt; $field, "group_id" =&gt; $group_id]</div><div class='ctx'>         );</div><div class='ctx'> </div><div class='ctx'>         $result = db_execute ("</div><div class='hunk'>@@ -756,6 +752,25 @@ function print_form_canned ($row = null)</div><div class='ctx'>     . form_textarea ('body', $row['body'], "rows='20' cols='65' wrap='hard'")</div><div class='ctx'>     . form_footer (_("Submit"), 'submit');</div><div class='ctx'> }</div><div class='add'>+</div><div class='add'>+function print_canned_row ($row, $group_id, $i)</div><div class='add'>+{</div><div class='add'>+  global $php_self;</div><div class='add'>+  $id = $row['bug_canned_id'];</div><div class='add'>+  $s_body = utils_cutstring ($row['body'], 360);</div><div class='add'>+  print '&lt;tr class="' . utils_altrow ($i) . '"&gt;'</div><div class='add'>+    . "&lt;td&gt;&lt;a href=\"$php_self?update_canned=1&amp;amp;"</div><div class='add'>+    . "item_canned_id=$id&amp;amp;group_id=$group_id\"&gt;{$row['title']}&lt;/a&gt;&lt;/td&gt;\n"</div><div class='add'>+    . "&lt;td&gt;$s_body&lt;/td&gt;\n&lt;td&gt;{$row['order_id']}&lt;/td&gt;\n"</div><div class='add'>+    . "&lt;td class='center'&gt;";</div><div class='add'>+  print form_tag ()</div><div class='add'>+    . form_hidden (['func' =&gt; 'delcanned', 'item_canned_id' =&gt; $id,</div><div class='add'>+        'group_id' =&gt; $group_id]</div><div class='add'>+      )</div><div class='add'>+    . form_image_trash ('submit') . "&lt;/form&gt;\n";</div><div class='add'>+  print "&lt;/td&gt;&lt;/tr&gt;\n";</div><div class='add'>+}</div><div class='add'>+</div><div class='ctx'> if ($create_canned || $delete_canned)</div><div class='ctx'>   {</div><div class='ctx'>     # Show existing responses and UI form.</div><div class='hunk'>@@ -776,19 +791,7 @@ if ($create_canned || $delete_canned)</div><div class='ctx'>         print html_build_list_table_top ($title_arr);</div><div class='ctx'>         $i = 0;</div><div class='ctx'>         while ($row = db_fetch_array ($result))</div><div class='del'>-          {</div><div class='del'>-            $s_body = substr ($row['body'], 0, 360);</div><div class='del'>-            print '&lt;tr class="' . utils_altrow ($i++) . '"&gt;'</div><div class='del'>-              . "&lt;td&gt;&lt;a href=\"$php_self"</div><div class='del'>-              . "?update_canned=1&amp;amp;item_canned_id={$row['bug_canned_id']}"</div><div class='del'>-              . "&amp;amp;group_id=$group_id\"&gt;{$row['title']}&lt;/a&gt;&lt;/td&gt;\n"</div><div class='del'>-              . "&lt;td&gt;$s_body...&lt;/td&gt;\n&lt;td&gt;{$row['order_id']}&lt;/td&gt;\n"</div><div class='del'>-              . "&lt;td class='center'&gt;&lt;a href=\"$php_self"</div><div class='del'>-              . "?func=delcanned&amp;amp;item_canned_id={$row['bug_canned_id']}"</div><div class='del'>-              . "&amp;amp;group_id=$group_id\"&gt;"</div><div class='del'>-              . html_image_trash (['alt' =&gt; _("Delete this canned response")])</div><div class='del'>-              . "&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n";</div><div class='del'>-          }</div><div class='add'>+          print_canned_row ($row, $group_id, $i++);</div><div class='ctx'>         print "&lt;/table&gt;\n";</div><div class='ctx'>       }</div><div class='ctx'>     else</div><div class='head'>diff --git a/frontend/php/bugs/admin/field_values_reset.php b/frontend/php/bugs/admin/field_values_reset.php<br/>index 7576390..26dfffb 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/field_values_reset.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/field_values_reset.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/field_values_reset.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/field_values_reset.php</a></div><div class='hunk'>@@ -43,19 +43,16 @@</div><div class='ctx'> </div><div class='ctx'> require_once ('../../include/init.php');</div><div class='ctx'> require_once ('../../include/trackers/general.php');</div><div class='del'>-extract (sane_import ('post',</div><div class='del'>-  [</div><div class='del'>-    'name' =&gt; 'field',</div><div class='del'>-    'true' =&gt; ['confirm', 'cancel']</div><div class='del'>-  ]</div><div class='del'>-));</div><div class='add'>+extract (sane_import ('post', ['name' =&gt; 'field', 'true' =&gt; ['confirm', 'cancel']]));</div><div class='add'>+# This page is only accessible with POST; check form_id unconditionally.</div><div class='add'>+form_check ();</div><div class='ctx'> </div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='ctx'> if (!user_ismember ($group_id, 'A'))</div><div class='ctx'>   exit_permission_denied ();</div><div class='ctx'> </div><div class='del'>-trackers_init($group_id);</div><div class='add'>+trackers_init ($group_id);</div><div class='ctx'> </div><div class='ctx'> if (!$field)</div><div class='ctx'>   exit_missing_param ();</div><div class='hunk'>@@ -87,8 +84,8 @@ printf (</div><div class='ctx'>   trackers_data_get_label ($field)</div><div class='ctx'> );</div><div class='ctx'> print '&lt;/span&gt;';</div><div class='del'>-print '&lt;div class="center"&gt;&lt;input type="submit" name="confirm" value="'</div><div class='del'>-  . _("Confirm") . '" /&gt; &lt;input type="submit" name="cancel" value="'</div><div class='del'>-  . _("Cancel") . "\" /&gt;&lt;/div&gt;\n";</div><div class='add'>+print '&lt;div class="center"&gt;'</div><div class='add'>+  . form_submit (_("Confirm"), "confirm") . ' '</div><div class='add'>+  . form_submit (_("Cancel"), "cancel") . "&lt;/div&gt;\n";</div><div class='ctx'> print "&lt;/form&gt;\n";</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/bugs/admin/field_values_transition-ofields-update.php b/frontend/php/bugs/admin/field_values_transition-ofields-update.php<br/>index 64945dc..6440841 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/field_values_transition-ofields-update.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/field_values_transition-ofields-update.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/field_values_transition-ofields-update.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/field_values_transition-ofields-update.php</a></div><div class='hunk'>@@ -73,6 +73,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'digits' =&gt; $name_digits</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> $result = db_execute ("</div><div class='ctx'>   SELECT field_id, from_value_id, to_value_id</div><div class='head'>diff --git a/frontend/php/bugs/admin/notification_settings.php b/frontend/php/bugs/admin/notification_settings.php<br/>index 25f4070..e8d7ca9 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/notification_settings.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/notification_settings.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/notification_settings.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/notification_settings.php</a></div><div class='hunk'>@@ -50,6 +50,7 @@ require_directory ('project');</div><div class='ctx'> $is_admin_page = 'y';</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post', ['true' =&gt; 'submit']));</div><div class='add'>+form_check ('submit');</div><div class='ctx'> </div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='hunk'>@@ -106,7 +107,7 @@ if ($submit)</div><div class='ctx'>         );</div><div class='ctx'>       }</div><div class='ctx'>     else</div><div class='del'>-      fb (_("Update failed"));</div><div class='add'>+      fb (_("Update failed"), 1);</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='ctx'> trackers_header_admin (['title' =&gt; _("Set Notifications")]);</div><div class='hunk'>@@ -114,7 +115,7 @@ trackers_header_admin (['title' =&gt; _("Set Notifications")]);</div><div class='ctx'> print form_tag () . form_hidden (["group_id" =&gt; $group_id]);</div><div class='ctx'> </div><div class='ctx'> if (user_ismember ($group_id, 'A'))</div><div class='del'>-  trackers_data_show_notification_settings ($group_id, ARTIFACT, 1);</div><div class='add'>+  trackers_data_show_notification_settings ($group_id, ARTIFACT);</div><div class='ctx'> </div><div class='ctx'> print "\n&lt;p align='center'&gt;&lt;input type='submit' name='submit' class='bold' "</div><div class='ctx'>   . 'value="' . _("Submit Changes") . "\" /&gt;&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='head'>diff --git a/frontend/php/bugs/admin/other_settings.php b/frontend/php/bugs/admin/other_settings.php<br/>index 8dbcfea..a3112f6 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/other_settings.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/other_settings.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/other_settings.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/other_settings.php</a></div><div class='hunk'>@@ -76,9 +76,9 @@ $form_preambles = $form_pref_preambles;</div><div class='ctx'> $form_preambles[] = 'form_preamble';</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post',</div><div class='del'>-  ['true' =&gt; 'submit', 'specialchars' =&gt; $form_preambles]</div><div class='add'>+  ['true' =&gt; 'update', 'specialchars' =&gt; $form_preambles]</div><div class='ctx'> ));</div><div class='del'>-</div><div class='add'>+form_check ('update');</div><div class='ctx'> require_directory ("project");</div><div class='ctx'> </div><div class='ctx'> $is_admin_page = 'y';</div><div class='hunk'>@@ -126,7 +126,7 @@ fetch_pref_preambles ($group_id);</div><div class='ctx'> $changed = $form_preamble != $current_preamble;</div><div class='ctx'> $pref_changed = !empty ($new_pref_keys);</div><div class='ctx'> </div><div class='del'>-if ($submit &amp;&amp; ($changed || $pref_changed))</div><div class='add'>+if ($update &amp;&amp; ($changed || $pref_changed))</div><div class='ctx'>   {</div><div class='ctx'>     group_add_history ('Changed Tracking System Settings', '', $group_id);</div><div class='ctx'>     $update_failed = false;</div><div class='hunk'>@@ -149,32 +149,34 @@ if ($submit &amp;&amp; ($changed || $pref_changed))</div><div class='ctx'>           $update_failed = true;</div><div class='ctx'>       }</div><div class='ctx'>     if ($update_failed)</div><div class='del'>-      fb (_("Update failed"));</div><div class='add'>+      fb (_("Update failed"), 1);</div><div class='ctx'>     else</div><div class='del'>-      fb (_("SUCCESSFUL UPDATE"));</div><div class='add'>+      fb (_("Updated successfully"));</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='ctx'> trackers_header_admin (['title' =&gt; _("Other Settings")]);</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . _("Item Post Form Preamble") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Item Post Form Preamble"));</div><div class='ctx'> print form_tag () . form_hidden (['group_id' =&gt; $group_id]);</div><div class='del'>-print '&lt;span class="preinput"&gt;&lt;label for="form_preamble"&gt;';</div><div class='del'>-print _("Introductory message showing at the top of the item submission form");</div><div class='del'>-print '&lt;/label&gt; ' . markup_info ("rich")</div><div class='del'>-  . "&lt;/span&gt;\n&lt;br /&gt;\n"</div><div class='del'>-  . "&lt;textarea cols='70' rows='8' wrap='virtual' id='form_preamble'"</div><div class='del'>-  . " name='form_preamble'&gt;$current_preamble&lt;/textarea&gt;\n";</div><div class='add'>+print '&lt;span class="preinput"&gt;'</div><div class='add'>+ . html_label ("form_preamble",</div><div class='add'>+    _("Introductory message showing at the top of the item submission form")</div><div class='add'>+   );</div><div class='add'>+print markup_info ("rich") . "&lt;/span&gt;\n&lt;br /&gt;\n"</div><div class='add'>+  . form_textarea ('form_preamble', $current_preamble,</div><div class='add'>+      "cols='70' rows='8' wrap='virtual'"</div><div class='add'>+    )</div><div class='add'>+  . "\n";</div><div class='ctx'> </div><div class='ctx'> function pref_preamble_input ($form_name, $title, $current)</div><div class='ctx'> {</div><div class='ctx'>   $heading = $title[0]; $info = $title[1];</div><div class='ctx'> </div><div class='del'>-  print "&lt;h2&gt;$heading&lt;/h2&gt;\n";</div><div class='del'>-  print "&lt;span class='preinput'&gt;&lt;label for='$form_name'&gt;";</div><div class='del'>-  print "$info&lt;/label&gt; " . markup_info ("rich")</div><div class='del'>-    . "&lt;/span&gt;\n&lt;br /&gt;\n"</div><div class='del'>-    . "&lt;textarea cols='70' rows='8' wrap='virtual' id='$form_name'"</div><div class='del'>-    . " name='$form_name'&gt;$current&lt;/textarea&gt;\n";</div><div class='add'>+  print html_h (2, $heading);</div><div class='add'>+  print "&lt;span class='preinput'&gt;" . html_label ($form_name, $info);</div><div class='add'>+  print markup_info ("rich") . "&lt;/span&gt;\n&lt;br /&gt;\n"</div><div class='add'>+    . form_textarea ($form_name, $current, "cols='70' rows='8' wrap='virtual'")</div><div class='add'>+    . "\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> foreach ($pref_preamble_titles as $pre =&gt; $title)</div><div class='hunk'>@@ -184,8 +186,6 @@ foreach ($pref_preamble_titles as $pre =&gt; $title)</div><div class='ctx'>     pref_preamble_input ($form_name, $title, $cur_pref_preambles[$name]);</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='del'>-print '&lt;div class="center"&gt;&lt;input type="submit" name="submit" value="'</div><div class='del'>- . _("Submit") . '" /&gt;' . "&lt;/div&gt;\n&lt;/form&gt;\n";</div><div class='del'>-</div><div class='add'>+print form_footer ();</div><div class='ctx'> trackers_footer ();</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/bugs/admin/userperms.php b/frontend/php/bugs/admin/userperms.php<br/>index ece89be..c21873e 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/userperms.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/bugs/admin/userperms.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/bugs/admin/userperms.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/bugs/admin/userperms.php</a></div><div class='hunk'>@@ -59,6 +59,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'true' =&gt; 'update', 'digits' =&gt; [$event1_name, [$event2_name, [0, 99]]]</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> if ($update)</div><div class='ctx'>   {</div><div class='hunk'>@@ -99,7 +100,7 @@ if ($update)</div><div class='ctx'> </div><div class='ctx'> trackers_header_admin (['title' =&gt; _("Set Permissions")]);</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . _("Posting Restrictions") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Posting Restrictions"));</div><div class='ctx'> print form_tag () . form_hidden (["group" =&gt; $group]);</div><div class='ctx'> </div><div class='ctx'> print '&lt;span class="preinput"&gt;'</div><div class='hunk'>@@ -120,8 +121,6 @@ print html_select_restriction_box (</div><div class='ctx'>   ARTIFACT, group_getrestrictions ($group_id, ARTIFACT, TRACKER_EVENT_COMMENT),</div><div class='ctx'>   $group, '', TRACKER_EVENT_COMMENT</div><div class='ctx'> );</div><div class='del'>-print "\n&lt;p align='center'&gt;&lt;input type='submit' name='update' value=\""</div><div class='del'>-  . _("Update Permissions") . "\" /&gt;&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='del'>-</div><div class='add'>+print form_footer (_("Update Permissions"));</div><div class='ctx'> trackers_footer ();</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/cvs/admin/index.php b/frontend/php/cvs/admin/index.php<br/>index 03828d5..02c77b9 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/cvs/admin/index.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/cvs/admin/index.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/cvs/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/cvs/admin/index.php</a></div><div class='hunk'>@@ -61,7 +61,7 @@ function match_type_box ($arr_match_type, $row_match_type)</div><div class='ctx'> # Get current information.</div><div class='ctx'> $res_grp = group_get_result ($group_id);</div><div class='ctx'> </div><div class='del'>-if (db_numrows ($res_grp) &lt; 1)</div><div class='add'>+if (!db_numrows ($res_grp))</div><div class='ctx'>   exit_error (_("Invalid Group"));</div><div class='ctx'> </div><div class='ctx'> session_require (['group' =&gt; $group_id, 'admin_flags' =&gt; 'A']);</div><div class='hunk'>@@ -96,6 +96,7 @@ extract (sane_import ('post',</div><div class='ctx'>       ['arr_enable_diff', [$key_func, ['digits', [1, 1]]]]</div><div class='ctx'>     ]</div><div class='ctx'>   ]));</div><div class='add'>+form_check ('log_accum');</div><div class='ctx'> </div><div class='ctx'> if (isset ($log_accum))</div><div class='ctx'>   {</div><div class='hunk'>@@ -188,54 +189,65 @@ $result =  db_execute ("</div><div class='ctx'>   WHERE group_id = ?", [$group_id]</div><div class='ctx'> );</div><div class='ctx'> </div><div class='del'>-print "&lt;h2&gt;" . _("Current notifications") . "&lt;/h2&gt;\n";</div><div class='del'>-print form_tag ([], "?group=$group");</div><div class='del'>-print "&lt;table&gt;\n";</div><div class='del'>-print html_build_list_table_top (</div><div class='del'>-  [</div><div class='del'>-    html_image_trash (), _('Repo'), _('Match'), _('Modules'), _('Branches'),</div><div class='del'>-    _('Send to'), _('Diff?'), _('Diffs to')</div><div class='del'>-  ]</div><div class='del'>-);</div><div class='del'>-</div><div class='ctx'> $repo_keys =  ['sources', 'web'];</div><div class='ctx'> # TRANSLATORS: this is the type of repository (sources  or web).</div><div class='ctx'> $repo_vals = [_('sources'), _('web')];</div><div class='ctx'> </div><div class='del'>-while ($row = db_fetch_array ($result))</div><div class='del'>-  {</div><div class='del'>-    $cur= $row['hook_id'];</div><div class='del'>-    print "&lt;tr&gt;\n&lt;td&gt;";</div><div class='del'>-    print form_hidden (["arr_id[$cur]" =&gt; "$cur"]);</div><div class='del'>-    print form_checkbox ("arr_remove[$cur]", 0);</div><div class='del'>-    print "&lt;/td&gt;\n&lt;td&gt;";</div><div class='del'>-    print html_build_select_box_from_arrays (</div><div class='del'>-      $repo_keys, $repo_vals, "arr_repo_name[$cur]", $row['repo_name'], false</div><div class='del'>-    );</div><div class='del'>-    print "&lt;/td&gt;\n&lt;td&gt;";</div><div class='del'>-    print match_type_box ("arr_match_type[$cur]", $row['match_type']);</div><div class='del'>-    print "&lt;/td&gt;\n";</div><div class='del'>-    print "&lt;td&gt;&lt;input type='text' name='arr_dir_list[$cur]' "</div><div class='del'>-      . "value='{$row['dir_list']}' size='10' /&gt;&lt;/td&gt;\n";</div><div class='del'>-    print "&lt;td&gt;&lt;input type='text' name='arr_branches[$cur]' "</div><div class='del'>-      . "value='{$row['branches']}' size='10' /&gt;&lt;/td&gt;\n";</div><div class='del'>-    print "&lt;td&gt;&lt;input type='text' name='arr_emails_notif[$cur]' "</div><div class='del'>-      . "value='{$row['emails_notif']}' size='13' /&gt;&lt;/td&gt;\n";</div><div class='del'>-    print "&lt;td&gt;";</div><div class='del'>-    print form_checkbox ("arr_enable_diff[$cur]", $row['enable_diff']);</div><div class='del'>-    print "&lt;/td&gt;\n";</div><div class='del'>-    print "&lt;td&gt;&lt;input type='text' name='arr_emails_diff[$cur]' "</div><div class='del'>-      . "value='{$row['emails_diff']}' size='13' /&gt;&lt;/td&gt;\n";</div><div class='del'>-    print "&lt;/tr&gt;\n";</div><div class='del'>-  }</div><div class='add'>+function current_notifications ($result)</div><div class='add'>+{</div><div class='add'>+  global $repo_keys, $repo_vals;</div><div class='add'>+  $ret = '';</div><div class='add'>+  while ($row = db_fetch_array ($result))</div><div class='add'>+    {</div><div class='add'>+      $cur = $row['hook_id'];</div><div class='add'>+      $ret .= "&lt;tr&gt;\n&lt;td&gt;";</div><div class='add'>+      $ret .= form_hidden (["arr_id[$cur]" =&gt; "$cur"]);</div><div class='add'>+      $ret .= form_checkbox ("arr_remove[$cur]", 0);</div><div class='add'>+      $ret .= "&lt;/td&gt;\n&lt;td&gt;";</div><div class='add'>+      $ret .= html_build_select_box_from_arrays (</div><div class='add'>+        $repo_keys, $repo_vals, "arr_repo_name[$cur]", $row['repo_name'], false</div><div class='add'>+      );</div><div class='add'>+      $ret .= "&lt;/td&gt;\n&lt;td&gt;";</div><div class='add'>+      $ret .= match_type_box ("arr_match_type[$cur]", $row['match_type']);</div><div class='add'>+      $ret .= "&lt;/td&gt;\n";</div><div class='add'>+      $ret .= "&lt;td&gt;&lt;input type='text' name='arr_dir_list[$cur]' "</div><div class='add'>+        . "value='{$row['dir_list']}' size='10' /&gt;&lt;/td&gt;\n";</div><div class='add'>+      $ret .= "&lt;td&gt;&lt;input type='text' name='arr_branches[$cur]' "</div><div class='add'>+        . "value='{$row['branches']}' size='10' /&gt;&lt;/td&gt;\n";</div><div class='add'>+      $ret .= "&lt;td&gt;&lt;input type='text' name='arr_emails_notif[$cur]' "</div><div class='add'>+        . "value='{$row['emails_notif']}' size='13' /&gt;&lt;/td&gt;\n";</div><div class='add'>+      $ret .= "&lt;td&gt;";</div><div class='add'>+      $ret .= form_checkbox ("arr_enable_diff[$cur]", $row['enable_diff']);</div><div class='add'>+      $ret .= "&lt;/td&gt;\n";</div><div class='add'>+      $ret .= "&lt;td&gt;&lt;input type='text' name='arr_emails_diff[$cur]' "</div><div class='add'>+        . "value='{$row['emails_diff']}' size='13' /&gt;&lt;/td&gt;\n";</div><div class='add'>+      $ret .= "&lt;/tr&gt;\n";</div><div class='add'>+    }</div><div class='add'>+  return $ret;</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+function show_current_notifications ($group, $result)</div><div class='add'>+{</div><div class='add'>+  $cur_notif = current_notifications ($result);</div><div class='add'>+  if (empty ($cur_notif))</div><div class='add'>+    return;</div><div class='add'>+  print form_tag () . form_hidden (["group" =&gt; $group]);</div><div class='add'>+  print html_build_list_table_top (</div><div class='add'>+    [</div><div class='add'>+      html_image_trash (), _('Repo'), _('Match'), _('Modules'), _('Branches'),</div><div class='add'>+      _('Send to'), _('Diff?'), _('Diffs to')</div><div class='add'>+    ]</div><div class='add'>+  );</div><div class='add'>+  print $cur_notif;</div><div class='add'>+  print "&lt;/table&gt;\n";</div><div class='add'>+  print form_footer (_("Modify"), 'log_accum');</div><div class='add'>+}</div><div class='ctx'> </div><div class='del'>-print "&lt;/table&gt;\n";</div><div class='del'>-$caption = _("Modify");</div><div class='del'>-print "&lt;input name='log_accum' type='submit' value='$caption' /&gt;\n";</div><div class='del'>-print "&lt;/form&gt;\n";</div><div class='add'>+print html_h (2, _("Current notifications"));</div><div class='add'>+show_current_notifications ($group, $result);</div><div class='ctx'> </div><div class='del'>-print "&lt;h2&gt;" . _("New notification") . "&lt;/h2&gt;\n";</div><div class='del'>-print form_tag ([], "?group=$group");</div><div class='add'>+print html_h (2, _("New notification"));</div><div class='add'>+print form_tag () . form_hidden (["group" =&gt; $group]);</div><div class='ctx'> print "&lt;ol&gt;\n";</div><div class='ctx'> print "&lt;li&gt;" . _("Repository:") . " ";</div><div class='ctx'> print html_build_select_box_from_arrays (</div><div class='hunk'>@@ -263,7 +275,7 @@ print _("Filter by directory: if match is &lt;i&gt;Module list&lt;/i&gt;, enter a list of</div><div class='ctx'> print "&lt;input type='text' name='arr_dir_list[new]' value='' /&gt;";</div><div class='ctx'> print "&lt;/li&gt;\n&lt;li&gt;";</div><div class='ctx'> print _("List of comma-separated emails to send notifications to, e.g.</div><div class='del'>-  winnie@the-pooh.mil, yu@guan.edu):") . "&lt;br /&gt;";</div><div class='add'>+  winnie@the-pooh.mil, yu@guan.edu:") . "&lt;br /&gt;";</div><div class='ctx'> print "&lt;input type='text' name='arr_emails_notif[new]' "</div><div class='ctx'>   . "value='' /&gt;";</div><div class='ctx'> print "&lt;/li&gt;\n&lt;li&gt;";</div><div class='hunk'>@@ -285,8 +297,7 @@ print _("Filter by branch: you will be notified only commits in these branches,</div><div class='ctx'> print "&lt;input type='text' name='arr_branches[new]' value='' /&gt;";</div><div class='ctx'> print "&lt;/li&gt;\n&lt;/ol&gt;\n";</div><div class='ctx'> print form_hidden (['arr_id[new]' =&gt; 'new']);</div><div class='del'>-$caption = _('Add');</div><div class='del'>-print "&lt;input type='submit' name='log_accum' value='$caption' /&gt;\n&lt;/form&gt;\n";</div><div class='add'>+print form_footer (_('Add'), 'log_accum');</div><div class='ctx'> </div><div class='ctx'> print "&lt;p&gt;" . _("The changes come into effect within an hour.") . "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='head'>diff --git a/frontend/php/forum/forum.php b/frontend/php/forum/forum.php<br/>index 6be14c4..776ffe0 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/forum/forum.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/forum/forum.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/forum/forum.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/forum/forum.php</a></div><div class='hunk'>@@ -66,6 +66,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'digits' =&gt; ['is_followup_to', 'thread_id']</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ('post_message');</div><div class='ctx'> </div><div class='ctx'> if ($forum_id)</div><div class='ctx'>   {</div><div class='head'>diff --git a/frontend/php/git/admin/index.php b/frontend/php/git/admin/index.php<br/>index 6893482..20eb9a7 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/git/admin/index.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/git/admin/index.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/git/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/git/admin/index.php</a></div><div class='hunk'>@@ -50,26 +50,24 @@ $vcs = 'git';</div><div class='ctx'> </div><div class='ctx'> $res_grp = group_get_result ($group_id);</div><div class='ctx'> </div><div class='del'>-if (db_numrows ($res_grp) &lt; 1)</div><div class='add'>+if (!db_numrows ($res_grp))</div><div class='ctx'>   exit_error (_("Invalid Group"));</div><div class='ctx'> </div><div class='ctx'> session_require (['group' =&gt; $group_id, 'admin_flags' =&gt; 'A']);</div><div class='del'>-$functions = ['up', 'down'];</div><div class='ctx'> $repos = vcs_get_repos ($vcs, $group_id);</div><div class='ctx'> $desc = $readme = [];</div><div class='del'>-$submit_tarballs = ['submit'];</div><div class='ctx'> $n = count ($repos);</div><div class='ctx'> for ($i = 0; $i &lt; $n; $i++)</div><div class='ctx'>   {</div><div class='ctx'>     $desc[] = "desc$i";</div><div class='ctx'>     $readme[] = "readme$i";</div><div class='del'>-    $submit_tarballs[] = "disable_tarballs$i";</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='del'>-extract (sane_import ('get',</div><div class='del'>-  ['strings' =&gt; [['func', $functions]], 'path' =&gt; ['name']]</div><div class='add'>+extract (sane_import ('get', ['strings' =&gt; [['func', ['up', 'down']]]]));</div><div class='add'>+extract (sane_import ('post',</div><div class='add'>+  ['digits' =&gt; ['repo_no'], 'true' =&gt; ['submit'], 'path' =&gt; ['name']]</div><div class='ctx'> ));</div><div class='del'>-extract (sane_import ('post', ['digits' =&gt; ['repo_no'], 'true' =&gt; ['submit']]));</div><div class='add'>+form_check ('submit');</div><div class='ctx'> </div><div class='ctx'> function page_start ()</div><div class='ctx'> {</div><div class='hunk'>@@ -185,22 +183,21 @@ function show_edit ($name, $label, $val, $repo_no)</div><div class='ctx'>   if (!empty ($show_edit_help[$name]) &amp;&amp; !$repo_no)</div><div class='ctx'>     $help = $show_edit_help[$name];</div><div class='ctx'>   $id = "$name$repo_no";</div><div class='del'>-  print "&lt;p&gt;&lt;label for='$id'&gt;$label&lt;/label&gt; &amp;nbsp; &amp;nbsp;\n";</div><div class='add'>+  print "&lt;p&gt;" . html_label ($id, $label) . " &amp;nbsp; &amp;nbsp;\n";</div><div class='ctx'>   print form_input ("text", "$id", $val, 'size="34" maxlength="102"');</div><div class='ctx'>   print "&lt;/p&gt;\n";</div><div class='ctx'>   if ($help !== null)</div><div class='ctx'>     print "&lt;p class='smaller'&gt;$help&lt;/p&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-function show_disable_tarballs ($repo_no)</div><div class='add'>+function show_disable_tarballs ($repo_no, $name)</div><div class='ctx'> {</div><div class='del'>-  global $group_id, $name, $vcs;</div><div class='add'>+  global $group_id, $vcs;</div><div class='ctx'>   $no_tarball = vcs_tarballs_disabled ($vcs, $group_id, $name);</div><div class='ctx'>   $cb_name = "disable_tarballs$repo_no";</div><div class='ctx'>   print "&lt;p&gt;";</div><div class='ctx'>   print form_checkbox ($cb_name, $no_tarball) . "\n";</div><div class='del'>-  print "&lt;label for='$cb_name'&gt;"</div><div class='del'>-    . _("don't provide links to snapshot tarballs") . "&lt;/label&gt;";</div><div class='add'>+  print html_label ($cb_name, _("don't provide links to snapshot tarballs"));</div><div class='ctx'>   print "&lt;/p&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='hunk'>@@ -212,9 +209,9 @@ function show_repo_form ($r, $repo_no, $name)</div><div class='ctx'>     "desc", _("Description:"),</div><div class='ctx'>     utils_specialchars_decode ($r['desc'], ENT_QUOTES), $repo_no</div><div class='ctx'>   );</div><div class='del'>-  print "&lt;h3&gt;" . _("Web browsing settings") . "&lt;/h3&gt;\n\n";</div><div class='add'>+  print html_h (3, _("Web browsing settings"));</div><div class='ctx'>   show_edit ("readme", _("README file:"), $readme, $repo_no);</div><div class='del'>-  show_disable_tarballs ($repo_no);</div><div class='add'>+  show_disable_tarballs ($repo_no, $name);</div><div class='ctx'>   print form_hidden (['repo_no' =&gt; $repo_no]);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='hunk'>@@ -223,17 +220,13 @@ function show_repo ($r, $repo_no)</div><div class='ctx'>   global $group_name, $anchor, $name;</div><div class='ctx'>   $name = $r['name'];</div><div class='ctx'>   $anchor = repo_html_id ($name);</div><div class='del'>-  $suff = "?group=$group_name&amp;amp;name=$name#$anchor";</div><div class='del'>-  $form_tag = form_tag ([], $suff);</div><div class='ctx'> </div><div class='ctx'>   show_repo_title ($r);</div><div class='del'>-  print $form_tag;</div><div class='add'>+  print form_tag ([], "#$anchor")</div><div class='add'>+    . form_hidden (['group' =&gt; $group_name, 'name' =&gt; $name]);</div><div class='add'>+</div><div class='ctx'>   show_repo_form ($r, $repo_no, $name);</div><div class='del'>-  print form_input (</div><div class='del'>-    'submit', "submit", _("Update"), 'class="' . utils_altrow ($repo_no) . '"'</div><div class='del'>-  );</div><div class='del'>-  if (!($repo_no % 2))</div><div class='del'>-    print "&lt;p&gt; &amp;nbsp;&lt;/p&gt;\n";</div><div class='add'>+  print form_submit (_("Update"), 'submit');</div><div class='ctx'>   print "&lt;/form&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='head'>diff --git a/frontend/php/i18n.php b/frontend/php/i18n.php<br/>index b721fd1..eedcc22 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/i18n.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/i18n.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/i18n.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/i18n.php</a></div><div class='hunk'>@@ -49,9 +49,10 @@ extract (sane_import('request',</div><div class='ctx'>   [</div><div class='ctx'>     'preg' =&gt; [['language', '/^(([a-z]{2}((-[a-z]{2})?))|100)$/']],</div><div class='ctx'>     'internal_uri' =&gt; 'lang_uri',</div><div class='del'>-    'true' =&gt; ['cookie_test', 'cookie_for_a_year']</div><div class='add'>+    'true' =&gt; ['cookie_test', 'cookie_for_a_year', 'update']</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> # Check cookie support.</div><div class='ctx'> if (!isset ($_COOKIE["cookie_probe"]))</div><div class='hunk'>@@ -132,8 +133,6 @@ print "&lt;/p&gt;\n&lt;p&gt;&lt;span class=\"text\"&gt;"</div><div class='ctx'>       . "immediately.")</div><div class='ctx'>   . "&lt;/span&gt;&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='del'>-print '&lt;div class="center"&gt;&lt;input type="submit" name="set" value="'</div><div class='del'>-  . _("Set language") . '" tabindex="1" /&gt;&lt;/div&gt;';</div><div class='del'>-print '&lt;/form&gt;';</div><div class='add'>+print form_footer (_("Set language"));</div><div class='ctx'> $HTML-&gt;footer ([]);</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/include/form.php b/frontend/php/include/form.php<br/>index d354215..2aeb3d8 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/form.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/form.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/form.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/form.php</a></div><div class='hunk'>@@ -262,11 +262,27 @@ function form_reset_form_id ($form_id)</div><div class='ctx'>   return 1;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='add'>+# Return false either if $submit_list is null or any listed</div><div class='add'>+# global variables are set; else return true.</div><div class='add'>+function form_vars_empty ($submit_list)</div><div class='add'>+{</div><div class='add'>+  if ($submit_list === null)</div><div class='add'>+    return false;</div><div class='add'>+  if (!is_array ($submit_list))</div><div class='add'>+    $submit_list = [$submit_list];</div><div class='add'>+  foreach ($submit_list as $var)</div><div class='add'>+    if (!empty ($GLOBALS[$var]))</div><div class='add'>+      return false;</div><div class='add'>+  return true;</div><div class='add'>+}</div><div class='add'>+</div><div class='ctx'> # Check whether this is a duplicate or not: exit when the form_id is absent</div><div class='ctx'> # in the DB, which may mean that it has already been submitted (user's mistake)</div><div class='ctx'> # or has never been registered (CSRF).</div><div class='del'>-function form_check ()</div><div class='add'>+function form_check ($submit_list = null)</div><div class='ctx'> {</div><div class='add'>+  if (form_vars_empty ($submit_list))</div><div class='add'>+    return;</div><div class='ctx'>   $form_id = '';</div><div class='ctx'>   extract (sane_import ('post', ['hash' =&gt; 'form_id']));</div><div class='ctx'>   form_preliminary_check ($form_id);</div><div class='head'>diff --git a/frontend/php/include/html.php b/frontend/php/include/html.php<br/>index 8735425..b62a749 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/html.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/html.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/html.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/html.php</a></div><div class='hunk'>@@ -356,9 +356,14 @@ function html_label ($for, $title)</div><div class='ctx'>   return "&lt;label for='$for'&gt;$title&lt;/label&gt;";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-function html_h ($no, $title)</div><div class='add'>+function html_h ($no, $title, $attr = [])</div><div class='ctx'> {</div><div class='del'>-  return "&lt;h$no&gt;$title&lt;/h$no&gt;\n";</div><div class='add'>+  $extra = '';</div><div class='add'>+  if (!is_array ($attr))</div><div class='add'>+    $attr = ['id' =&gt; $attr];</div><div class='add'>+  foreach ($attr as $k =&gt; $v)</div><div class='add'>+    $extra .= " $k='$v'";</div><div class='add'>+  return "&lt;h$no$extra&gt;$title&lt;/h$no&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> # Start a list table from an array of titles and builds.</div><div class='hunk'>@@ -848,7 +853,7 @@ function site_admin_header ($params)</div><div class='ctx'>   html_header ($params);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-function site_admin_footer ($params)</div><div class='add'>+function site_admin_footer ($params = [])</div><div class='ctx'> {</div><div class='ctx'>   html_footer ($params);</div><div class='ctx'> }</div><div class='head'>diff --git a/frontend/php/include/my/bookmarks.php b/frontend/php/include/my/bookmarks.php<br/>index e8610ed..955531f 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/my/bookmarks.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/my/bookmarks.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/my/bookmarks.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/my/bookmarks.php</a></div><div class='hunk'>@@ -55,7 +55,7 @@ function bookmark_add ($bookmark_url, $bookmark_title = null)</div><div class='ctx'>     print db_error ();</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-function bookmark_edit ($bookmark_id, $bookmark_url, $bookmark_title)</div><div class='add'>+function bookmark_update ($bookmark_id, $bookmark_url, $bookmark_title)</div><div class='ctx'> {</div><div class='ctx'>   db_autoexecute('user_bookmarks',</div><div class='ctx'>     ['bookmark_url' =&gt; $bookmark_url, 'bookmark_title' =&gt; $bookmark_title],</div><div class='hunk'>@@ -71,4 +71,43 @@ function bookmark_delete ($bookmark_id)</div><div class='ctx'>     [$bookmark_id, user_getid ()]</div><div class='ctx'>   );</div><div class='ctx'> }</div><div class='add'>+</div><div class='add'>+function bookmark_edit_form ($bm_id, $result)</div><div class='add'>+{</div><div class='add'>+  $title = db_result ($result, 0, 'bookmark_title');</div><div class='add'>+  $url = db_result ($result, 0, 'bookmark_url');</div><div class='add'>+</div><div class='add'>+  print form_tag ();</div><div class='add'>+  print '&lt;span class="preinput"&gt;' . _("Title:") . "&lt;/span&gt;&lt;br /&gt;\n";</div><div class='add'>+  print '&amp;nbsp;&amp;nbsp;&amp;nbsp;'</div><div class='add'>+    . form_input ('text', 'title', $title, 'size="50"');</div><div class='add'>+  print "&lt;br /&gt;\n&lt;span class='preinput'&gt;"</div><div class='add'>+    . html_label ('url', _("Address:")) . "&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;&amp;nbsp;";</div><div class='add'>+  print form_input ('text', "url",  $url, 'size="50"') . "\n";</div><div class='add'>+  print form_hidden (['edit' =&gt; $bm_id]) . "\n&lt;p&gt;";</div><div class='add'>+  print form_submit (_("Update"), 'update', false, true) . "&lt;/p&gt;\n";</div><div class='add'>+  print "&lt;/form&gt;\n";</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+function bookmark_edit ($edit, $url, $title)</div><div class='add'>+{</div><div class='add'>+  if (!$edit)</div><div class='add'>+    return;</div><div class='add'>+  if ($url &amp;&amp; $title)</div><div class='add'>+    {</div><div class='add'>+      # The URL and title were in the request, we update the database.</div><div class='add'>+      bookmark_update ($edit, $url, $title);</div><div class='add'>+      return;</div><div class='add'>+    }</div><div class='add'>+  $result = db_execute ("</div><div class='add'>+    SELECT * from user_bookmarks WHERE bookmark_id = ? AND user_id = ?",</div><div class='add'>+    [$edit, user_getid ()]</div><div class='add'>+  );</div><div class='add'>+  if (!$result)</div><div class='add'>+    {</div><div class='add'>+      fb (_("Bookmark not found"), 1);</div><div class='add'>+      return;</div><div class='add'>+    }</div><div class='add'>+  bookmark_edit_form ($edit, $result);</div><div class='add'>+}</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/include/news/forum.php b/frontend/php/include/news/forum.php<br/>index e74ee17..2645317 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/news/forum.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/news/forum.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/news/forum.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/news/forum.php</a></div><div class='hunk'>@@ -504,8 +504,8 @@ function show_post_form (</div><div class='ctx'>     . "wrap='SOFT'&gt;&lt;/textarea&gt;\n&lt;/td&gt;&lt;/tr&gt;\n"</div><div class='ctx'>     . "&lt;tr&gt;&lt;td colspan='2' align='middle'&gt;\n&lt;span class='warn'&gt;"</div><div class='ctx'>     . "HTML tags will display in your post as text&lt;/span&gt;\n&lt;br /&gt;\n"</div><div class='del'>-    . '&lt;input type="submit" name="submit" value="' . _("Post Comment")</div><div class='del'>-    . "\" /&gt;\n&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n&lt;/form&gt;\n&lt;/center&gt;\n";</div><div class='add'>+    . form_input ('submit', 'submit', _("Post Comment"))</div><div class='add'>+    . "\n&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n&lt;/form&gt;\n&lt;/center&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> # Take a message id and recurse, deleting all followups.</div><div class='head'>diff --git a/frontend/php/include/news/general.php b/frontend/php/include/news/general.php<br/>index 5d89c0f..cb1a8eb 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/news/general.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/news/general.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/news/general.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/news/general.php</a></div><div class='hunk'>@@ -119,7 +119,7 @@ function news_print_news_list ($result, $group_id, $group)</div><div class='ctx'>   while ($row = db_fetch_array ($result))</div><div class='ctx'>     {</div><div class='ctx'>       print "&lt;li&gt;";</div><div class='del'>-      print "&lt;a href=\"$php_self?approve=1&amp;amp;group=$group&amp;amp;";</div><div class='add'>+      print "&lt;a href=\"$php_self?show=1&amp;amp;group=$group&amp;amp;";</div><div class='ctx'>       print "id={$row['id']}\"&gt;{$row['summary']}&lt;/a&gt;&lt;/li&gt;\n";</div><div class='ctx'>     }</div><div class='ctx'>   print "&lt;/ul&gt;\n";</div><div class='hunk'>@@ -137,10 +137,10 @@ function news_list_news_to_manage ($group_id, $group)</div><div class='ctx'>       $result = news_query_news ($group_id, $set);</div><div class='ctx'>       if (!db_numrows ($result))</div><div class='ctx'>         {</div><div class='del'>-          print "&lt;h2&gt;{$t[1]}&lt;/h2&gt;\n";</div><div class='add'>+          print html_h (2, $t[1]);</div><div class='ctx'>           continue;</div><div class='ctx'>         }</div><div class='del'>-      print "&lt;h2&gt;{$t[0]}&lt;/h2&gt;\n";</div><div class='add'>+      print html_h (2, $t[0]);</div><div class='ctx'>       news_print_news_list ($result, $group_id, $group);</div><div class='ctx'>     }</div><div class='ctx'> }</div><div class='head'>diff --git a/frontend/php/include/people/general.php b/frontend/php/include/people/general.php<br/>index 6437d2f..fffb033 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/people/general.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/people/general.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/people/general.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/people/general.php</a></div><div class='hunk'>@@ -336,9 +336,7 @@ function people_draw_skill_box ($result, $job_id = false, $group_id = false)</div><div class='ctx'>     $infix = 'job';</div><div class='ctx'> </div><div class='ctx'>   $title_arr = [_('Skill'), _('Level'), _('Experience'), _('Action')];</div><div class='del'>-</div><div class='del'>-  $rows = db_numrows ($result);</div><div class='del'>-  if ($rows &lt; 1)</div><div class='add'>+  if (!db_numrows ($result))</div><div class='ctx'>     {</div><div class='ctx'>       print html_build_list_table_top ($title_arr);</div><div class='ctx'>       print "\n&lt;tr&gt;&lt;td colspan='4'&gt;&lt;strong&gt;"</div><div class='hunk'>@@ -363,15 +361,12 @@ function people_draw_skill_box ($result, $job_id = false, $group_id = false)</div><div class='ctx'>         . "&lt;/span&gt;&lt;/td&gt;\n&lt;td&gt;&lt;span class='smaller'&gt;"</div><div class='ctx'>         . people_skill_year_box ('skill_year_id', $row['skill_year_id'])</div><div class='ctx'>         . "&lt;/span&gt;&lt;/td&gt;\n&lt;td nowrap&gt;&lt;span class='smaller'&gt;"</div><div class='del'>-        . "&lt;input type='submit' name='update_{$infix}_inventory' "</div><div class='del'>-        . "value='" . _("Update") . "'&gt; &amp;nbsp;\n"</div><div class='del'>-        . "&lt;input type='submit' name='delete_from_{$infix}_inventory' "</div><div class='del'>-        . "value='" . _("Delete") . "'&gt;&lt;/span&gt;&lt;/td&gt;\n&lt;/tr&gt;&lt;/table&gt;\n"</div><div class='add'>+        . form_submit (_("Update"), "update_{$infix}_inventory") . "&amp;nbsp;\n"</div><div class='add'>+        . form_submit (_("Delete"), "delete_from_{$infix}_inventory")</div><div class='add'>+        . "&lt;/span&gt;&lt;/td&gt;\n&lt;/tr&gt;&lt;/table&gt;\n"</div><div class='ctx'>         . "&lt;/form&gt;\n";</div><div class='ctx'>     }</div><div class='del'>-</div><div class='del'>-  print "\n&lt;h3&gt;" . _("Add a New Skill") . "&lt;/h3&gt;\n";</div><div class='del'>-</div><div class='add'>+  print html_h (3, _("Add a New Skill"));</div><div class='ctx'>   print form_tag ();</div><div class='ctx'>   print html_build_list_table_top ($title_arr);</div><div class='ctx'>   print "\n&lt;tr class='" . utils_altrow (0) . "'&gt;\n&lt;td&gt;";</div><div class='hunk'>@@ -384,9 +379,9 @@ function people_draw_skill_box ($result, $job_id = false, $group_id = false)</div><div class='ctx'>     . people_skill_level_box ('skill_level_id')</div><div class='ctx'>     . "&lt;/span&gt;&lt;/td&gt;\n&lt;td&gt;&lt;span class='smaller'&gt;"</div><div class='ctx'>     . people_skill_year_box ('skill_year_id')</div><div class='del'>-    . "&lt;/span&gt;&lt;/td&gt;\n&lt;td nowrap&gt;&lt;span class='smaller'&gt;&lt;input type='submit' "</div><div class='del'>-    . "name='add_to_{$infix}_inventory'\n value='" . _("Add Skill")</div><div class='del'>-    . "'&gt;&lt;/span&gt;&lt;/td&gt;\n&lt;/tr&gt;&lt;/table&gt;\n&lt;/form&gt;\n";</div><div class='add'>+    . "&lt;/span&gt;&lt;/td&gt;\n&lt;td nowrap&gt;&lt;span class='smaller'&gt;"</div><div class='add'>+    . form_submit (_("Add Skill"), "add_to_{$infix}_inventory")</div><div class='add'>+    . "&lt;/span&gt;&lt;/td&gt;\n&lt;/tr&gt;&lt;/table&gt;\n&lt;/form&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function people_edit_job_inventory ($job_id, $group_id)</div><div class='hunk'>@@ -592,9 +587,9 @@ function people_add_to_skill_inventory (</div><div class='ctx'>     SELECT * FROM people_skill_inventory WHERE user_id = ? AND skill_id = ?",</div><div class='ctx'>     [user_getid (), $skill_id]</div><div class='ctx'>   );</div><div class='del'>-  if (db_numrows ($result) &gt; 0)</div><div class='add'>+  if (db_numrows ($result))</div><div class='ctx'>     {</div><div class='del'>-      fb (_('ERROR - skill already in your inventory'));</div><div class='add'>+      fb (_('ERROR - skill already in your inventory'), 1);</div><div class='ctx'>       return;</div><div class='ctx'>     }</div><div class='ctx'>   $result = db_autoexecute ('people_skill_inventory',</div><div class='hunk'>@@ -604,7 +599,7 @@ function people_add_to_skill_inventory (</div><div class='ctx'>     ],</div><div class='ctx'>     DB_AUTOQUERY_INSERT</div><div class='ctx'>   );</div><div class='del'>-  if ($result &amp;&amp; db_affected_rows ($result) &gt; 0)</div><div class='add'>+  if ($result &amp;&amp; db_affected_rows ($result))</div><div class='ctx'>     {</div><div class='ctx'>       fb (_('Added to skill inventory'));</div><div class='ctx'>       return;</div><div class='head'>diff --git a/frontend/php/include/sendmail.php b/frontend/php/include/sendmail.php<br/>index ecd08ae..eb9fb56 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/sendmail.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/sendmail.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/sendmail.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/sendmail.php</a></div><div class='hunk'>@@ -589,12 +589,6 @@ function sendmail_form_message ($form_action, $user_id, $cc_me = true)</div><div class='ctx'>     # TRANSLATORS: the argument is user's name.</div><div class='ctx'>     sprintf (_("Send a message to %s"), user_getrealname ($user_id))</div><div class='ctx'>   );</div><div class='del'>-  print '&lt;p class="warn"&gt;'</div><div class='del'>-    . _("If you are writing for help, did you read the\nproject documentation "</div><div class='del'>-        . "first? Try to provide any potentially useful information\n"</div><div class='del'>-        . "you can think of.")</div><div class='del'>-     . "&lt;/p&gt;\n";</div><div class='del'>-</div><div class='ctx'>   $pre = '&lt;span class="preinput"&gt;';</div><div class='ctx'>   $post = "&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;&amp;nbsp;";</div><div class='ctx'>   # We do not really bother finding out the realname + email, sendmail_mail ()</div><div class='hunk'>@@ -603,20 +597,20 @@ function sendmail_form_message ($form_action, $user_id, $cc_me = true)</div><div class='ctx'>     . form_hidden ([</div><div class='ctx'>         'touser' =&gt; utils_specialchars ($user_id),</div><div class='ctx'>         'fromuser' =&gt; user_getname ()])</div><div class='del'>-    . "\n$pre" . _("From:") . "$post"</div><div class='add'>+    . "\n$pre" . _("From:") . $post</div><div class='ctx'>     . user_getrealname (user_getid (), 1) . ' &amp;lt;'</div><div class='ctx'>     . user_getemail (user_getid ()) . "&amp;gt;&lt;br /&gt;\n"</div><div class='ctx'>     . $pre . _("Mailer:") . $post</div><div class='ctx'>     . utils_cutstring ($_SERVER['HTTP_USER_AGENT'], "50")</div><div class='del'>-    . "&lt;br /&gt;\n$pre&lt;label for='subject'&gt;" . _("Subject:") . "&lt;/label&gt;$post"</div><div class='del'>-    . '&lt;input type="text" id="subject" name="subject" '</div><div class='del'>-    . "size='60' maxlength='45' value='' /&gt;&lt;br /&gt;\n$pre"</div><div class='del'>-    . form_checkbox ("cc_me", $cc_me, ['value' =&gt; 'cc_me'])</div><div class='del'>-    . " &lt;label for='cc_me'&gt;" . _("Send me a copy") . "&lt;/label&gt;$post"</div><div class='del'>-    . "$pre&lt;label for='body'&gt;" . _("Message:") . "&lt;/label&gt;$post"</div><div class='del'>-    . "&lt;textarea id='body' name='body' rows='20' cols='60'&gt;&lt;/textarea&gt;\n\n"</div><div class='del'>-    . '&lt;p align="center"&gt;&lt;input type="submit" name="send_mail" value="'</div><div class='del'>-    . _('Send Message') . "\" /&gt;&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='add'>+    . "&lt;br /&gt;\n$pre" . html_label ('subject', _("Subject:")) . $post</div><div class='add'>+    . form_input ('text', "subject", '', "size='60' maxlength='45'")</div><div class='add'>+    . "&lt;br /&gt;\n$pre"</div><div class='add'>+    . form_checkbox ("cc_me", $cc_me,</div><div class='add'>+        ['value' =&gt; 'cc_me', 'label' =&gt; _("Send me a copy")]</div><div class='add'>+      )</div><div class='add'>+    . $post . $pre . html_label ('body', _("Message:")) . $post</div><div class='add'>+    . form_textarea ('body', '', "rows='20' cols='60'") . "\n\n"</div><div class='add'>+    . form_footer (_('Send Message'), "send_mail");</div><div class='ctx'>   print $HTML-&gt;box_bottom ();</div><div class='ctx'> }</div><div class='ctx'> </div><div class='head'>diff --git a/frontend/php/include/sitemenu.php b/frontend/php/include/sitemenu.php<br/>index 2d37e0d..b2a2564 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/sitemenu.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/sitemenu.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/sitemenu.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/sitemenu.php</a></div><div class='hunk'>@@ -430,23 +430,24 @@ function sitemenu_help ()</div><div class='ctx'>   $HTML-&gt;menuhtml_bottom ();</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-function menu_loggedin ($page_title, $page_toptab=0, $page_group=0)</div><div class='add'>+function menu_loggedin ($page_title, $page_toptab = 0, $page_group = 0)</div><div class='ctx'> {</div><div class='ctx'>   return sitemenu_loggedin ($page_title, $page_toptab, $page_group);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-function sitemenu_loggedin ($page_title, $page_toptab=0, $page_group=0)</div><div class='add'>+function sitemenu_loggedin ($page_title, $page_toptab = 0, $page_group = 0)</div><div class='ctx'> {</div><div class='ctx'>   global $HTML, $sys_home;</div><div class='add'>+  $uname = user_getname ();</div><div class='add'>+  $req_uri = utils_urlencode ($_SERVER['REQUEST_URI']);</div><div class='ctx'>   # Show links appropriate for logged in people, like account maintenance, etc.</div><div class='ctx'>   if (!user_is_super_user ())</div><div class='ctx'>     # TRANSLATORS: the argument is user's name.</div><div class='del'>-   $HTML-&gt;menuhtml_top (sprintf (_("Logged in as %s"), user_getname ()));</div><div class='add'>+    $HTML-&gt;menuhtml_top (sprintf (_("Logged in as %s"), $uname));</div><div class='ctx'>   else</div><div class='ctx'>     # TRANSLATORS: the argument is user's name.</div><div class='ctx'>     $HTML-&gt;menuhtml_top ('&lt;span class="warn"&gt;'</div><div class='del'>-      . sprintf (_("%s logged in as superuser"), user_getname())</div><div class='del'>-      . '&lt;/span&gt;'</div><div class='add'>+      . sprintf (_("%s logged in as superuser"), $uname) . '&lt;/span&gt;'</div><div class='ctx'>     );</div><div class='ctx'>   if (user_can_be_super_user () &amp;&amp; !user_is_super_user ())</div><div class='ctx'>     $HTML-&gt;menu_entry ("{$sys_home}account/su.php?action=login&amp;amp;uri="</div><div class='hunk'>@@ -456,22 +457,17 @@ function sitemenu_loggedin ($page_title, $page_toptab=0, $page_group=0)</div><div class='ctx'>   if (user_is_super_user ())</div><div class='ctx'>     {</div><div class='ctx'>       print form_tag (['action' =&gt; "{$sys_home}account/impersonate.php"])</div><div class='del'>-        . '&lt;label for="user_name"&gt;' . _("Become this user:")</div><div class='del'>-        . "&lt;/label&gt;&lt;br/&gt;\n";</div><div class='del'>-      print form_hidden (["uri" =&gt; utils_urlencode ($_SERVER['REQUEST_URI'])]);</div><div class='del'>-      print '&lt;input type="text" id="user_name" name="user_name" size=10 '</div><div class='del'>-        . '/&gt;&amp;nbsp;';</div><div class='del'>-      print '&lt;input type="submit" name="impersonate" value="'</div><div class='del'>-        . _("Impersonate") . '" /&gt;';</div><div class='del'>-      print "&lt;/form&gt;\n";</div><div class='add'>+        . html_label ("user_name", _("Become this user:")) . "&lt;br/&gt;\n";</div><div class='add'>+      print form_hidden (["uri" =&gt; $req_uri]);</div><div class='add'>+      print form_input ('text', "user_name", '', 'size=10') . '&amp;nbsp;';</div><div class='add'>+      print form_submit (_("Impersonate"), "impersonate") . "&lt;/form&gt;\n";</div><div class='ctx'>     }</div><div class='ctx'>   $HTML-&gt;menu_entry ("{$sys_home}my/", _("My Incoming Items"), 1,</div><div class='ctx'>     _("What's new for me: new items I should have a look at")</div><div class='ctx'>   );</div><div class='del'>-  $HTML-&gt;menu_entry ("{$sys_home}my/items.php",</div><div class='del'>-                    _("My Items"),</div><div class='del'>-                    1,</div><div class='del'>-                    _("Browse my items (submitted by me or assigned to me)"));</div><div class='add'>+  $HTML-&gt;menu_entry ("{$sys_home}my/items.php", _("My Items"), 1,</div><div class='add'>+    _("Browse my items (submitted by me or assigned to me)")</div><div class='add'>+  );</div><div class='ctx'>   if (user_use_votes ())</div><div class='ctx'>     $HTML-&gt;menu_entry ("{$sys_home}my/votes.php", _("My Votes"), 1,</div><div class='ctx'>       _("Browse items I voted for")</div><div class='hunk'>@@ -491,8 +487,7 @@ function sitemenu_loggedin ($page_title, $page_toptab=0, $page_group=0)</div><div class='ctx'> </div><div class='ctx'>   if (user_is_super_user ())</div><div class='ctx'>     $HTML-&gt;menu_entry (</div><div class='del'>-      "{$sys_home}account/su.php?action=logout&amp;amp;uri="</div><div class='del'>-      . utils_urlencode ($_SERVER['REQUEST_URI']),</div><div class='add'>+      "{$sys_home}account/su.php?action=logout&amp;amp;uri=$req_uri",</div><div class='ctx'>       _("Logout Superuser"), 1,</div><div class='ctx'>       _("End the Superuser session, go back to normal user session")</div><div class='ctx'>     );</div><div class='head'>diff --git a/frontend/php/include/trackers/data.php b/frontend/php/include/trackers/data.php<br/>index dc2e4fa..34a2aee 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/trackers/data.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/trackers/data.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/trackers/data.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/trackers/data.php</a></div><div class='hunk'>@@ -163,10 +163,10 @@ function trackers_data_get_notification_settings ($group_id, $tracker)</div><div class='ctx'>   return $settings;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-function trackers_data_show_notification_settings (</div><div class='del'>-  $group_id, $tracker, $show_intro_msg</div><div class='del'>-)</div><div class='add'>+function trackers_data_show_notification_settings ($group_id, $tracker)</div><div class='ctx'> {</div><div class='add'>+  static $hide_intro = -1;</div><div class='add'>+  $hide_intro++;</div><div class='ctx'>   $grtrsettings = trackers_data_get_notification_settings (</div><div class='ctx'>     $group_id, $tracker</div><div class='ctx'>   );</div><div class='hunk'>@@ -182,7 +182,7 @@ function trackers_data_show_notification_settings (</div><div class='ctx'>   $cat_n = $grtrsettings['nb_categories'];</div><div class='ctx'>   if ($cat_n &gt; 0)</div><div class='ctx'>     {</div><div class='del'>-      if ($show_intro_msg != 0)</div><div class='add'>+      if (!$hide_intro)</div><div class='ctx'>           print '&lt;p&gt;'</div><div class='ctx'>             . _("Here you can decide whether the lists "</div><div class='ctx'>                 . "of persons to be notified on new submissions and updates "</div><div class='hunk'>@@ -206,7 +206,7 @@ function trackers_data_show_notification_settings (</div><div class='ctx'>           ['checked' =&gt; $data[0], 'label' =&gt; $data[1]]</div><div class='ctx'>         )</div><div class='ctx'>         . "&lt;br /&gt;\n";</div><div class='del'>-      print "\n&lt;h2&gt;" . _("Category-related lists") . "&lt;/h2&gt;\n";</div><div class='add'>+      print html_h (2, _("Category-related lists"));</div><div class='ctx'>       print form_hidden (["{$tracker}_nb_categories" =&gt; $cat_n]);</div><div class='ctx'> </div><div class='ctx'>       for ($i = 0; $i &lt; $cat_n ; $i++)</div><div class='hunk'>@@ -225,9 +225,9 @@ function trackers_data_show_notification_settings (</div><div class='ctx'>             . html_label ($cb_name, _("Send on all updates"))</div><div class='ctx'>             . ")&lt;/span&gt;&lt;br /&gt;\n";</div><div class='ctx'>         }</div><div class='del'>-      print '&lt;h2&gt;' . _("Global list") . "&lt;/h2&gt;\n";</div><div class='add'>+      print html_h (2, _("Global list"));</div><div class='ctx'>     }</div><div class='del'>-  elseif ($show_intro_msg != 0)</div><div class='add'>+  elseif (!$hide_intro)</div><div class='ctx'>     print '&lt;p&gt;'</div><div class='ctx'>         . _("Here you can decide whether the lists "</div><div class='ctx'>             . "of persons to be notified on new submissions and updates "</div><div class='hunk'>@@ -245,8 +245,8 @@ function trackers_data_show_notification_settings (</div><div class='ctx'>     . form_checkbox ($cb_name, $grtrsettings['glsendall'])</div><div class='ctx'>     . html_label ($cb_name, _("Send on all updates")). ")&lt;/span&gt;\n";</div><div class='ctx'> </div><div class='del'>-  print "\n&lt;h2&gt;" . _("Exclusions for private items") . "&lt;/h2&gt;\n";</div><div class='del'>-  if ($show_intro_msg != 0)</div><div class='add'>+  print html_h (2, _("Exclusions for private items"));</div><div class='add'>+  if (!$hide_intro)</div><div class='ctx'>     print '&lt;p&gt;'</div><div class='ctx'>       . _("Addresses registered in this list will be excluded from default "</div><div class='ctx'>           . "mail\nnotification for private items.")</div><div class='head'>diff --git a/frontend/php/include/trackers/view-dependencies.php b/frontend/php/include/trackers/view-dependencies.php<br/>index f7ae369..9ab9a7c 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/include/trackers/view-dependencies.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/include/trackers/view-dependencies.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/include/trackers/view-dependencies.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/include/trackers/view-dependencies.php</a></div><div class='hunk'>@@ -249,15 +249,14 @@ function trackers_print_item_list_img ($items, $dependencies)</div><div class='ctx'> function trackers_print_view_deps_controls ()</div><div class='ctx'> {</div><div class='ctx'>   global $include_closed, $chunksz, $offset, $group;</div><div class='del'>-  print form_tag ();</div><div class='add'>+  print form_tag (['method' =&gt; 'get']);</div><div class='ctx'>   print form_hidden (['func' =&gt; 'view-dependencies', 'group' =&gt; $group]);</div><div class='ctx'>   print trackers_chunksz_control ();</div><div class='ctx'>   print "&amp;nbsp; &amp;nbsp;\n";</div><div class='ctx'>   print form_checkbox ('include_closed', !empty ($include_closed),</div><div class='ctx'>     ['label' =&gt; _('Include closed items')]);</div><div class='ctx'>   print " &amp;nbsp; ";</div><div class='del'>-  print form_input ('submit', 'apply', _('Apply'));</div><div class='del'>-  print "&lt;/form&gt;\n";</div><div class='add'>+  print form_input ('submit', 'apply', _('Apply')) . "&lt;/form&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> function trackers_show_dep ($d)</div><div class='ctx'> {</div><div class='head'>diff --git a/frontend/php/mail/admin/index.php b/frontend/php/mail/admin/index.php<br/>index bf85416..5a711ab 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/mail/admin/index.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/mail/admin/index.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/mail/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/mail/admin/index.php</a></div><div class='hunk'>@@ -50,9 +50,10 @@ define ('PUBLIC_UNLINK', 10);</div><div class='ctx'> </div><div class='ctx'> $key_func = ['preg', '/^(\d+|new)$/'];</div><div class='ctx'> $list_name_func = ['name', ['min_len' =&gt; 0, 'max_len' =&gt; 80]];</div><div class='add'>+$submit_buttons = ['post_changes', 'add_list'];</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt; ['post_changes', 'add_list'],</div><div class='add'>+    'true' =&gt; $submit_buttons,</div><div class='ctx'>     'digits' =&gt; 'newlist_format_index',</div><div class='ctx'>     'array' =&gt;</div><div class='ctx'>       [</div><div class='hunk'>@@ -64,6 +65,7 @@ extract (sane_import ('post',</div><div class='ctx'>       ],</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ($submit_buttons);</div><div class='ctx'> </div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='head'>diff --git a/frontend/php/markup-test.php b/frontend/php/markup-test.php<br/>index dc349b2..c8c6e46 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/markup-test.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/markup-test.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/markup-test.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/markup-test.php</a></div><div class='hunk'>@@ -44,10 +44,15 @@ require_once('include/init.php');</div><div class='ctx'> require_once('include/markup.php');</div><div class='ctx'> require_once('include/trackers/general.php');</div><div class='ctx'> </div><div class='add'>+$submit_buttons = ['basic', 'rich', 'full'];</div><div class='ctx'> extract (sane_import ('post',</div><div class='del'>-  ['specialchars' =&gt; 'comment', 'true' =&gt; ['basic', 'rich', 'full']]</div><div class='add'>+  ['specialchars' =&gt; 'comment', 'true' =&gt; $submit_buttons]</div><div class='ctx'> ));</div><div class='ctx'> $text = $comment;</div><div class='add'>+# The request doesn't commit any changes in the database, so we could</div><div class='add'>+# use GET rather than POST, without checking form_id; howerver,</div><div class='add'>+# the user may submit a longer text than GET can pass.</div><div class='add'>+form_check ($submit_buttons);</div><div class='ctx'> </div><div class='ctx'> $HTML-&gt;header (['title' =&gt; _("Test Markup"), 'notopmenu' =&gt; 1]);</div><div class='ctx'> html_feedback_top ();</div><div class='head'>diff --git a/frontend/php/my/admin/change.php b/frontend/php/my/admin/change.php<br/>index 6e144f4..4a88e59 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/change.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/admin/change.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/change.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/change.php</a></div><div class='hunk'>@@ -50,6 +50,7 @@ require_once ('../../include/gpg.php');</div><div class='ctx'> require (utils_get_content_filename ("gpg-sample"));</div><div class='ctx'> </div><div class='ctx'> session_require (['isloggedin' =&gt; '1']);</div><div class='add'>+$submit_buttons = ['update', 'test_gpg_key'];</div><div class='ctx'> extract (sane_import ('request',</div><div class='ctx'>   [</div><div class='ctx'>     'strings' =&gt;</div><div class='hunk'>@@ -60,12 +61,12 @@ extract (sane_import ('request',</div><div class='ctx'>         ],</div><div class='ctx'>         ['step', ['confirm', 'confirm2', 'discard']],</div><div class='ctx'>       ],</div><div class='del'>-    'true' =&gt; ['update', 'test_gpg_key'],</div><div class='add'>+    'true' =&gt; $submit_buttons,</div><div class='ctx'>     'hash' =&gt; ['session_hash', 'confirm_hash'],</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='del'>-if ($update || $test_gpg_key)</div><div class='del'>-  form_check ();</div><div class='add'>+</div><div class='add'>+form_check ($submit_buttons);</div><div class='ctx'> </div><div class='ctx'> if (!$item)</div><div class='ctx'>   exit_missing_param ();</div><div class='head'>diff --git a/frontend/php/my/admin/change_notifications.php b/frontend/php/my/admin/change_notifications.php<br/>index 2849c21..332aef1 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/change_notifications.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/admin/change_notifications.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/change_notifications.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/change_notifications.php</a></div><div class='hunk'>@@ -53,7 +53,6 @@ $notif_arr = [</div><div class='ctx'>   'notify_item_statuschanged', 'skipcc_postcomment',</div><div class='ctx'>   'skipcc_updateitem', 'removecc_notassignee',</div><div class='ctx'> ];</div><div class='del'>-</div><div class='ctx'> $names = [</div><div class='ctx'>   'true' =&gt; ['update'],</div><div class='ctx'>   'digits' =&gt; [['form_frequency', [0, 3]]],</div><div class='hunk'>@@ -64,6 +63,7 @@ foreach ($notif_arr as $n)</div><div class='ctx'>   $names['true'][] = "form_$n";</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post', $names));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> function update_subject_line ($form_subject_line)</div><div class='ctx'> {</div><div class='hunk'>@@ -114,7 +114,7 @@ site_user_header (</div><div class='ctx'>   ['title' =&gt; _("Mail Notification Settings"), 'context' =&gt; 'account']</div><div class='ctx'> );</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . _("Notification Exceptions") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Notification Exceptions"));</div><div class='ctx'> print '&lt;p&gt;'</div><div class='ctx'>   . _("When you post or update an item, you are automatically added to\nits "</div><div class='ctx'>       . "Carbon-Copy list to receive notifications regarding future updates. "</div><div class='hunk'>@@ -135,8 +135,8 @@ print '&amp;nbsp;&amp;nbsp;&lt;span class="preinput"&gt;'</div><div class='ctx'> </div><div class='ctx'> function pref_cbox ($name, $title)</div><div class='ctx'> {</div><div class='del'>-  print form_checkbox ("form_$name", user_get_preference ($name));</div><div class='del'>-  print " &lt;label for=\"form_$name\"&gt;$title&lt;/label&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;";</div><div class='add'>+  print form_checkbox ("form_$name", user_get_preference ($name)) . " ";</div><div class='add'>+  print html_label ("form_$name", $title) . "&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> $pref_arr = [</div><div class='hunk'>@@ -166,7 +166,7 @@ print '&lt;span class="preinput"&gt;' . _("Remove me from Carbon-Copy when:")</div><div class='ctx'> </div><div class='ctx'> pref_cbox ("removecc_notassignee", _("I am no longer assigned to the item"));</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . _("Subject Line") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Subject Line"));</div><div class='ctx'> print '&lt;p&gt;';</div><div class='ctx'> printf (_("The header &amp;ldquo;%s&amp;rdquo; will always be included, and when\n"</div><div class='ctx'>   . "applicable, so will &amp;ldquo;%s,&amp;rdquo; &amp;ldquo;%s,&amp;rdquo; and "</div><div class='hunk'>@@ -183,13 +183,14 @@ printf (_("Another option for message filtering is to configure the prefix "</div><div class='ctx'> );</div><div class='ctx'> print "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='del'>-print '&lt;span class="preinput"&gt;&lt;label for="form_subject_line"&gt;'</div><div class='del'>-  . _("Subject Line:") . "&lt;/label&gt;&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;";</div><div class='add'>+print '&lt;span class="preinput"&gt;'</div><div class='add'>+  . html_label ("form_subject_line", _("Subject Line:"))</div><div class='add'>+  . "&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;";</div><div class='ctx'> print "&lt;input name='form_subject_line' id='form_subject_line' size='50'\n"</div><div class='ctx'>   . "type='text' value=\"" . user_get_preference ("subject_line")</div><div class='ctx'>   . "\" /&gt;\n\n";</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . _("Reminder") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Reminder"));</div><div class='ctx'> print '&lt;p&gt;' . _("You can also receive reminders about opened items assigned to\n"</div><div class='ctx'>   . "you, when their priority is higher than 5.")</div><div class='ctx'>   . "&lt;/p&gt;\n";</div><div class='hunk'>@@ -199,8 +200,9 @@ $frequency = [</div><div class='ctx'>   "0" =&gt; _("Never"), "1" =&gt; _("Daily"), "2" =&gt; _("Weekly"), "3" =&gt; _("Monthly")</div><div class='ctx'> ];</div><div class='ctx'> </div><div class='del'>-print '&lt;span class="preinput"&gt;&lt;label for="form_frequency"&gt;'</div><div class='del'>-  . _("Frequency of reminders:") . "&lt;/label&gt;&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;";</div><div class='add'>+print '&lt;span class="preinput"&gt;'</div><div class='add'>+  . html_label ("form_frequency", _("Frequency of reminders:"))</div><div class='add'>+  . "&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;";</div><div class='ctx'> </div><div class='ctx'> print html_build_select_box_from_array (</div><div class='ctx'>   $frequency, "form_frequency", user_get_preference("batch_frequency")</div><div class='head'>diff --git a/frontend/php/my/admin/editsshkeys.php b/frontend/php/my/admin/editsshkeys.php<br/>index 4358980..ab34b33 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/editsshkeys.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/admin/editsshkeys.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/editsshkeys.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/editsshkeys.php</a></div><div class='hunk'>@@ -54,10 +54,10 @@ $min_keys = 5; # Minumum key fields to show.</div><div class='ctx'> </div><div class='ctx'> $keys = account_get_authorized_keys ();</div><div class='ctx'> $user_id = user_getid ();</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> if ($update)</div><div class='ctx'>   {</div><div class='del'>-    form_check ();</div><div class='ctx'>     $orig_keys = $keys;</div><div class='ctx'>     $keys = [];</div><div class='ctx'>     for ($i = 0; $i &lt; $key_limit; $i++)</div><div class='head'>diff --git a/frontend/php/my/admin/index.php b/frontend/php/my/admin/index.php<br/>index 04e9c4b..7f72f90 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/index.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/admin/index.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/index.php</a></div><div class='hunk'>@@ -39,10 +39,8 @@</div><div class='ctx'> #</div><div class='ctx'> # You should have received a copy of the GNU General Public License</div><div class='ctx'> # along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</div><div class='del'>-</div><div class='del'>-require_once ('../../include/sane.php');</div><div class='del'>-require_once ('../../include/utils.php');</div><div class='del'>-require_once ('../../include/form.php');</div><div class='add'>+foreach (['sane', 'utils', 'form'] as $i)</div><div class='add'>+  require_once ("../../include/$i.php");</div><div class='ctx'> $pref_list = ['email_encrypted', 'nonfixed_feedback', 'keep_only_one_session',</div><div class='ctx'>   'quiet_ssh', 'reverse_comments_order', 'stone_age_menu', 'use_bookmarks'</div><div class='ctx'> ];</div><div class='hunk'>@@ -94,8 +92,12 @@ if ($update)</div><div class='ctx'>         fb (_("Failed to update the database"),1);</div><div class='ctx'>     }</div><div class='ctx'>   }</div><div class='add'>+# FIXME init.php has to be included after parsing POST variables and defining</div><div class='add'>+# update_theme that may be used in theme.php that is included in init.php.</div><div class='add'>+# This isn't the most clear possible way to do these things.</div><div class='ctx'> require_once ('../../include/init.php');</div><div class='ctx'> require_once ('../../include/timezones.php');</div><div class='add'>+form_check ('update');</div><div class='ctx'> extract (sane_import ('request', ['pass' =&gt; 'feedback']));</div><div class='ctx'> session_require (['isloggedin' =&gt; 1]);</div><div class='ctx'> </div><div class='hunk'>@@ -127,7 +129,7 @@ print '&lt;p&gt;' . _("You can change all of your account features from here.")</div><div class='ctx'>   . "&lt;/p&gt;\n";</div><div class='ctx'> utils_get_content ("account/index_intro");</div><div class='ctx'> print form_tag ();</div><div class='del'>-print '&lt;h2&gt;' . _("Significant Arrangements") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Significant Arrangements"));</div><div class='ctx'> </div><div class='ctx'> print $HTML-&gt;box_top (_('Authentication Setup'));</div><div class='ctx'> print '&lt;p&gt;&lt;a href="change.php?item=password"&gt;' . _("Change Password")</div><div class='hunk'>@@ -201,6 +203,9 @@ print '&lt;p class="smaller"&gt;'</div><div class='ctx'>       . "time, killing previous\nsessions each time you log in.");</div><div class='ctx'> print "&lt;/p&gt;\n";</div><div class='ctx'> print $HTML-&gt;box_bottom ();</div><div class='add'>+$update_btn = '&lt;p class="center"&gt;&lt;span class="clearr" /&gt;'</div><div class='add'>+  . form_submit (_("Update")) . "&lt;/span&gt;&lt;/p&gt;\n";</div><div class='add'>+print $update_btn;</div><div class='ctx'> </div><div class='ctx'> print $HTML-&gt;box_top (_('Identity Record'));</div><div class='ctx'> </div><div class='hunk'>@@ -271,12 +276,7 @@ print '&lt;p class="smaller"&gt;' . _("Here, you can cancel all mail notifications.")</div><div class='ctx'> </div><div class='ctx'> print $HTML-&gt;box_bottom ();</div><div class='ctx'> </div><div class='del'>-$update_btn = '&lt;p class="center"&gt;&lt;span class="clearr" /&gt;'</div><div class='del'>-  . '&lt;input type="submit" name="update" value="'</div><div class='del'>-  . _("Update") . "\" /&gt;&lt;/span&gt;&lt;/p&gt;\n";</div><div class='del'>-print $update_btn;</div><div class='del'>-</div><div class='del'>-print "\n&lt;h2&gt;" . _("Secondary Arrangements") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Secondary Arrangements"));</div><div class='ctx'> </div><div class='ctx'> print $HTML-&gt;box_top (_('Optional Features'));</div><div class='ctx'> </div><div class='hunk'>@@ -320,6 +320,7 @@ print '&lt;p class="smaller"&gt;'</div><div class='ctx'>   . "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='ctx'> print $HTML-&gt;box_bottom ();</div><div class='add'>+print $update_btn;</div><div class='ctx'> print $HTML-&gt;box_top (_('Cosmetics Setup'));</div><div class='ctx'> </div><div class='ctx'> # The select box comes before the name of the category so all the clickable</div><div class='hunk'>@@ -414,11 +415,8 @@ print '&lt;p class="smaller"&gt;'</div><div class='ctx'>    . "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='ctx'> print $HTML-&gt;box_bottom ();</div><div class='del'>-</div><div class='del'>-print $update_btn;</div><div class='del'>-print "&lt;/form&gt;\n";</div><div class='del'>-</div><div class='del'>-print "\n&lt;h2&gt;" . _('Account Deletion') . "&lt;/h2&gt;\n";</div><div class='add'>+print "$update_btn&lt;/form&gt;\n";</div><div class='add'>+print html_h (2, _('Account Deletion'));</div><div class='ctx'> </div><div class='ctx'> print '&lt;p&gt;&lt;a href="change.php?item=delete"&gt;' . _("Delete Account")</div><div class='ctx'>   . "&lt;/a&gt;&lt;/p&gt;\n";</div><div class='head'>diff --git a/frontend/php/my/admin/resume.php b/frontend/php/my/admin/resume.php<br/>index 2d5e31e..2cd35e5 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/resume.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/admin/resume.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/admin/resume.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/admin/resume.php</a></div><div class='hunk'>@@ -48,13 +48,13 @@ require_directory ("people");</div><div class='ctx'> if (!user_isloggedin ())</div><div class='ctx'>   exit_not_logged_in ();</div><div class='ctx'> </div><div class='add'>+$submits = [</div><div class='add'>+  'update_profile', 'add_to_skill_inventory', 'update_skill_inventory',</div><div class='add'>+  'delete_from_skill_inventory'</div><div class='add'>+];</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt;</div><div class='del'>-      [</div><div class='del'>-        'update_profile', 'add_to_skill_inventory', 'update_skill_inventory',</div><div class='del'>-        'delete_from_skill_inventory'</div><div class='del'>-      ],</div><div class='add'>+    'true' =&gt; $submits,</div><div class='ctx'>     'digits' =&gt;</div><div class='ctx'>       [</div><div class='ctx'>         'skill_id', 'skill_level_id', 'skill_year_id', 'skill_inventory_id',</div><div class='hunk'>@@ -63,6 +63,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'pass' =&gt; 'people_resume'</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ($submits);</div><div class='ctx'> </div><div class='ctx'> # Check if resume should be editable at all.</div><div class='ctx'> $allow_resume = false;</div><div class='hunk'>@@ -70,9 +71,8 @@ $allow_resume = false;</div><div class='ctx'> $result = db_execute (</div><div class='ctx'>  "SELECT people_resume FROM user WHERE user_id = ?", [user_getid ()]</div><div class='ctx'> );</div><div class='del'>-if (db_numrows ($result) &gt; 0)</div><div class='del'>-  if ('' != db_result ($result, 0, 'people_resume'))</div><div class='del'>-    $allow_resume = true;</div><div class='add'>+if (db_numrows ($result))</div><div class='add'>+  $allow_resume = ('' != db_result ($result, 0, 'people_resume'));</div><div class='ctx'> # Let members of any group edit their resume.</div><div class='ctx'> if (!$allow_resume)</div><div class='ctx'>   {</div><div class='hunk'>@@ -83,8 +83,7 @@ if (!$allow_resume)</div><div class='ctx'>         AND user_id=? AND admin_flags != 'P'</div><div class='ctx'>       LIMIT 1", [user_getid ()]</div><div class='ctx'>     );</div><div class='del'>-    if (db_numrows ($result) &gt; 0)</div><div class='del'>-      $allow_resume = true;</div><div class='add'>+    $allow_resume = db_numrows ($result);</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='ctx'> if ($update_profile)</div><div class='hunk'>@@ -109,7 +108,7 @@ if ($update_profile)</div><div class='ctx'> elseif ($add_to_skill_inventory)</div><div class='ctx'>   {</div><div class='ctx'>     if ($skill_id == 100 || $skill_level_id == 100 || $skill_year_id == 100)</div><div class='del'>-      fb (_("Missing info: fill in all required fields"), 1);</div><div class='add'>+      fb (_("Missing information: fill in all required fields"), 1);</div><div class='ctx'>     else</div><div class='ctx'>       people_add_to_skill_inventory (</div><div class='ctx'>         $skill_id, $skill_level_id, $skill_year_id</div><div class='hunk'>@@ -120,7 +119,7 @@ elseif ($update_skill_inventory)</div><div class='ctx'>     if (</div><div class='ctx'>       $skill_level_id == 100 || $skill_year_id == 100  || !$skill_inventory_id</div><div class='ctx'>     )</div><div class='del'>-      fb (_("Missing info: fill in all required fields"));</div><div class='add'>+      fb (_("Missing information: fill in all required fields"));</div><div class='ctx'>     else</div><div class='ctx'>       {</div><div class='ctx'>         $result = db_execute ("</div><div class='hunk'>@@ -130,8 +129,8 @@ elseif ($update_skill_inventory)</div><div class='ctx'>           [$skill_level_id, $skill_year_id, user_getid (), $skill_inventory_id]</div><div class='ctx'>         );</div><div class='ctx'> </div><div class='del'>-        if (!$result || db_affected_rows ($result) &lt; 1)</div><div class='del'>-          fb (_("User Skill update failed"),1);</div><div class='add'>+        if (!db_affected_rows ($result))</div><div class='add'>+          fb (_("User Skill update failed"), 1);</div><div class='ctx'>         else</div><div class='ctx'>           fb (_("User Skills updated successfully"));</div><div class='ctx'>       }</div><div class='hunk'>@@ -146,8 +145,8 @@ elseif ($delete_from_skill_inventory)</div><div class='ctx'>       WHERE user_id = ? AND skill_inventory_id = ?",</div><div class='ctx'>       [user_getid (), $skill_inventory_id]</div><div class='ctx'>     );</div><div class='del'>-    if (!$result || db_affected_rows ($result) &lt; 1)</div><div class='del'>-      fb (_("User Skill Delete failed"),1);</div><div class='add'>+    if (!db_affected_rows ($result))</div><div class='add'>+      fb (_("User Skill Delete failed"), 1);</div><div class='ctx'>     else</div><div class='ctx'>       fb (_("User Skill Deleted successfully"));</div><div class='ctx'>   }</div><div class='hunk'>@@ -162,33 +161,32 @@ print '&lt;p&gt;'</div><div class='ctx'>   . "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='ctx'> $result = db_execute ("SELECT * FROM user WHERE user_id = ?", [user_getid ()]);</div><div class='del'>-if (db_numrows ($result) &lt; 1)</div><div class='add'>+if (!db_numrows ($result))</div><div class='ctx'>   exit_error (_("No such user"));</div><div class='ctx'> utils_get_content ("people/editresume");</div><div class='ctx'> </div><div class='del'>-$viewableoptions = ["0" =&gt; _("No"), "1" =&gt; _("Yes")];</div><div class='del'>-</div><div class='del'>-print form_tag ()</div><div class='del'>-  . '&lt;h2&gt;' . _("Publicly Viewable") . "&lt;/h2&gt;\n"</div><div class='add'>+print form_tag () . html_h (2, _("Publicly Viewable"))</div><div class='ctx'>   . '&lt;span class="preinput"&gt;' . _("Do you want your resume to be activated?")</div><div class='ctx'>   . '&lt;/span&gt;&amp;nbsp;&amp;nbsp;'</div><div class='ctx'>   . html_build_select_box_from_array (</div><div class='del'>-      $viewableoptions, 'people_view_skills',</div><div class='add'>+      ["0" =&gt; _("No"), "1" =&gt; _("Yes")], 'people_view_skills',</div><div class='ctx'>       db_result ($result, 0, 'people_view_skills'), 0, _("Activate resume")</div><div class='ctx'>     );</div><div class='ctx'> </div><div class='ctx'> if ($allow_resume)</div><div class='del'>-  print '&lt;h2&gt;&lt;label for="people_resume"&gt;'</div><div class='del'>-    . _("Resume - Description of Experience")</div><div class='del'>-    . "&lt;/label&gt;&lt;/h2&gt;\n&lt;p&gt;" . markup_info ("full") . "&lt;/p&gt;\n"</div><div class='del'>-    . '&lt;textarea id="people_resume" name="people_resume" rows="15" '</div><div class='del'>-    . 'cols="60" wrap="soft"&gt;'. db_result ($result, 0, 'people_resume')</div><div class='del'>-    . "&lt;/textarea&gt;\n&lt;br /&gt;&lt;br /&gt;\n";</div><div class='add'>+  print</div><div class='add'>+    html_h (2,</div><div class='add'>+      html_label ("people_resume", _("Resume - Description of Experience"))</div><div class='add'>+    )</div><div class='add'>+    . "&lt;p&gt;" . markup_info ("full") . "&lt;/p&gt;\n"</div><div class='add'>+    . form_textarea ("people_resume",  db_result ($result, 0, 'people_resume'),</div><div class='add'>+        ' rows="15" cols="60" wrap="soft"'</div><div class='add'>+      )</div><div class='add'>+    . "\n&lt;br /&gt;&lt;br /&gt;\n";</div><div class='ctx'> </div><div class='del'>-print '&lt;div class="center"&gt;&lt;input type="submit" name="update_profile" '</div><div class='del'>-  . 'value="' . _("Update Profile") . '" /&gt;&lt;/div&gt;&lt;/form&gt;' . "\n";</div><div class='add'>+print form_footer (_("Update Profile"), 'update_profile');</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . _("Skills") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Skills"));</div><div class='ctx'> # Now show the list of desired skills.</div><div class='ctx'> people_edit_skill_inventory (user_getid ());</div><div class='ctx'> </div><div class='head'>diff --git a/frontend/php/my/bookmarks.php b/frontend/php/my/bookmarks.php<br/>index 9b763d7..3c1d297 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/bookmarks.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/bookmarks.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/bookmarks.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/bookmarks.php</a></div><div class='hunk'>@@ -52,44 +52,14 @@ extract (sane_import ('request',</div><div class='ctx'>   [</div><div class='ctx'>     'digits' =&gt; 'edit', 'pass' =&gt; ['url', 'title']</div><div class='ctx'>   ]));</div><div class='add'>+extract (sane_import ('post', ['true' =&gt; 'update']));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> if ($add &amp;&amp; $url)</div><div class='ctx'>   bookmark_add ($url, $title);</div><div class='ctx'> if ($delete)</div><div class='ctx'>   bookmark_delete ($delete);</div><div class='del'>-if ($edit)</div><div class='del'>-  {</div><div class='del'>-    if ($url &amp;&amp; $title)</div><div class='del'>-      # The url and title were in the request, we update the database.</div><div class='del'>-      bookmark_edit ($edit, $url, $title);</div><div class='del'>-    else</div><div class='del'>-      {</div><div class='del'>-        # No url and title? Print the form.</div><div class='del'>-        $result = db_execute ("</div><div class='del'>-          SELECT * from user_bookmarks WHERE bookmark_id = ? AND user_id = ?",</div><div class='del'>-          [$edit, user_getid ()]</div><div class='del'>-        );</div><div class='del'>-        if ($result)</div><div class='del'>-          {</div><div class='del'>-            $title = db_result ($result, 0, 'bookmark_title');</div><div class='del'>-            $url = db_result ($result, 0, 'bookmark_url');</div><div class='del'>-</div><div class='del'>-            print form_tag ();</div><div class='del'>-            print '&lt;span class="preinput"&gt;' . _("Title:") . "&lt;/span&gt;&lt;br /&gt;\n";</div><div class='del'>-            print '&amp;nbsp;&amp;nbsp;&amp;nbsp;'</div><div class='del'>-              . form_input ('text', 'title', $title, 'size="50"');</div><div class='del'>-            print "&lt;br /&gt;\n" . '&lt;span class="preinput"&gt;';</div><div class='del'>-            print  _("Address:") . "&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;&amp;nbsp;";</div><div class='del'>-            print form_input ('text', "url",  $url, 'size="50"') . "\n";</div><div class='del'>-            print form_hidden (['edit' =&gt; $edit]) . "\n&lt;p&gt;";</div><div class='del'>-            print form_submit (_("Update"), 'update', false, true) . "&lt;/p&gt;\n";</div><div class='del'>-            print "&lt;/form&gt;\n";</div><div class='del'>-          }</div><div class='del'>-        else</div><div class='del'>-          # No result? Gives feedback and print the usual page.</div><div class='del'>-          fb (_("Item not found"), 1);</div><div class='del'>-      }</div><div class='del'>-  }</div><div class='add'>+bookmark_edit ($edit, $url, $title);</div><div class='ctx'> $result = db_execute ("</div><div class='ctx'>   SELECT bookmark_url, bookmark_title, bookmark_id FROM user_bookmarks</div><div class='ctx'>   WHERE user_id = ? ORDER BY bookmark_title",</div><div class='head'>diff --git a/frontend/php/my/groups.php b/frontend/php/my/groups.php<br/>index d36819d..d33f877 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/groups.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/groups.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/groups.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/groups.php</a></div><div class='hunk'>@@ -124,17 +124,17 @@ function send_pending_user_email ($group_id, $user_id, $user_message)</div><div class='ctx'>   );</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-# Request for inclusion.</div><div class='add'>+$submits = ['update', 'searchgroup'];</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt; 'update', 'pass' =&gt; 'form_message',</div><div class='add'>+    'true' =&gt; $submits, 'pass' =&gt; 'form_message',</div><div class='ctx'>     'array' =&gt; [['form_groups', ['digits', 'true']]],</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ($submits);</div><div class='ctx'> </div><div class='ctx'> if ($update)</div><div class='ctx'>   {</div><div class='del'>-    form_check ();</div><div class='ctx'>     $result_upd = db_query ("</div><div class='ctx'>       SELECT group_id FROM groups WHERE status = 'A' AND is_public = '1'</div><div class='ctx'>       ORDER BY group_id"</div><div class='hunk'>@@ -268,7 +268,7 @@ print</div><div class='ctx'>     . "this form.");</div><div class='ctx'> print "&lt;/p&gt;\n\n";</div><div class='ctx'> </div><div class='del'>-print form_tag () . form_hidden (['action' =&gt; 'searchgroup']);</div><div class='add'>+print form_tag () . form_hidden (['searchgroup' =&gt; '1']);</div><div class='ctx'> print form_input ('text', 'words', $words,</div><div class='ctx'>   "title=\"" . _("Group to look for") . "\" size='35'");</div><div class='ctx'> print "&lt;br /&gt;&lt;br /&gt;\n";</div><div class='hunk'>@@ -319,20 +319,22 @@ if ($words)</div><div class='ctx'>                 print _('(already a member)') . "&lt;br /&gt;\n";</div><div class='ctx'>                 continue;</div><div class='ctx'>               }</div><div class='del'>-            print form_checkbox ("form_groups[{$val['group_id']}]")</div><div class='del'>-              . "\n&lt;label for=\"form_groups[{$val['group_id']}]\"&gt;";</div><div class='del'>-            print "{$val['group_name']}&lt;/label&gt;&lt;br /&gt;\n";</div><div class='add'>+            print form_checkbox ("form_groups[{$val['group_id']}]") . "\n"</div><div class='add'>+              . html_label (</div><div class='add'>+                  "form_groups[{$val['group_id']}]", $val['group_name']</div><div class='add'>+                )</div><div class='add'>+              . "&lt;br /&gt;\n";</div><div class='ctx'>           }</div><div class='ctx'> </div><div class='del'>-        print "&lt;br /&gt;\n&lt;label for='form_message'&gt;" . _("Comments (required):")</div><div class='del'>-          . "&lt;/label&gt;&lt;br /&gt;\n"</div><div class='add'>+        print "&lt;br /&gt;\n"</div><div class='add'>+          . html_label ('form_message', _("Comments (required):")) . "&lt;br /&gt;\n"</div><div class='ctx'>           . "&lt;textarea name='form_message' id='form_message' cols='40'\n"</div><div class='ctx'>           . "rows='7'&gt;&lt;/textarea&gt;&lt;br /&gt;&lt;br /&gt;\n";</div><div class='ctx'>         print form_submit (_("Request Inclusion"), 'update');</div><div class='ctx'>         print "&lt;/form&gt;\n";</div><div class='ctx'>       }</div><div class='ctx'>     print "&lt;/div&gt;&lt;!-- end boxitemalt --&gt;\n";</div><div class='del'>-  }</div><div class='add'>+  } # if ($words)</div><div class='ctx'> print $HTML-&gt;box_bottom (1);</div><div class='ctx'> print html_splitpage (2);</div><div class='ctx'> </div><div class='head'>diff --git a/frontend/php/my/quitproject.php b/frontend/php/my/quitproject.php<br/>index 16a5de9..b1a60f4 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/quitproject.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/quitproject.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/quitproject.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/quitproject.php</a></div><div class='hunk'>@@ -48,9 +48,10 @@ require_once ('../include/form.php');</div><div class='ctx'> require_once ('../include/sendmail.php');</div><div class='ctx'> </div><div class='ctx'> session_require (['isloggedin'=&gt;'1']);</div><div class='del'>-</div><div class='add'>+$submits = ['confirm', 'cancel'];</div><div class='ctx'> extract (sane_import ('request', ['digits' =&gt; 'quitting_group_id']));</div><div class='del'>-extract (sane_import ('post', ['true' =&gt; ['confirm', 'cancel']]));</div><div class='add'>+extract (sane_import ('post', ['true' =&gt; $submits]));</div><div class='add'>+form_check ($submits);</div><div class='ctx'> </div><div class='ctx'> $pending = member_check_pending (0, $quitting_group_id);</div><div class='ctx'> </div><div class='hunk'>@@ -116,19 +117,18 @@ if ($confirm || $pending)</div><div class='ctx'>     if (!$pending)</div><div class='ctx'>       notify_admins ($quitting_group_id);</div><div class='ctx'>     session_redirect ($GLOBALS['sys_home'] . "my/groups.php");</div><div class='add'>+    exit (0);</div><div class='ctx'>   }</div><div class='del'>-else</div><div class='del'>-  {</div><div class='del'>-    site_user_header (['title' =&gt; _("Quit a group"), 'context' =&gt; 'mygroups']);</div><div class='del'>-    print form_tag ();</div><div class='del'>-    print form_hidden (["quitting_group_id" =&gt; $quitting_group_id]);</div><div class='del'>-    print '&lt;span class="preinput"&gt;';</div><div class='del'>-    printf (_("You are about to leave the group %s, please confirm:"),</div><div class='del'>-      group_getname ($quitting_group_id)</div><div class='del'>-    );</div><div class='del'>-    print '&lt;/span&gt;';</div><div class='del'>-    print '&lt;div class="center"&gt;&lt;input type="submit" name="confirm" value="'</div><div class='del'>-      . _("Confirm") . '" /&gt; &lt;input type="submit" name="cancel" value="'</div><div class='del'>-      . _("Cancel") . "\" /&gt;&lt;/div&gt;\n&lt;/form&gt;\n";</div><div class='del'>-  }</div><div class='add'>+site_user_header (['title' =&gt; _("Quit a group"), 'context' =&gt; 'mygroups']);</div><div class='add'>+print form_tag ();</div><div class='add'>+print form_hidden (["quitting_group_id" =&gt; $quitting_group_id]);</div><div class='add'>+print '&lt;span class="preinput"&gt;';</div><div class='add'>+printf (_("You are about to leave the group %s, please confirm:"),</div><div class='add'>+  group_getname ($quitting_group_id)</div><div class='add'>+);</div><div class='add'>+print "&lt;/span&gt;\n";</div><div class='add'>+print '&lt;div class="center"&gt;'</div><div class='add'>+  . form_submit (_("Confirm"), "confirm") . "\n"</div><div class='add'>+  . form_submit (_("Cancel"), "cancel")</div><div class='add'>+  . "&lt;/div&gt;\n&lt;/form&gt;\n";</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/my/votes.php b/frontend/php/my/votes.php<br/>index 678bbf8..f4e191a 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/my/votes.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/my/votes.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/my/votes.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/my/votes.php</a></div><div class='hunk'>@@ -47,16 +47,17 @@ require_once ('../include/trackers/votes.php');</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt; 'submit',</div><div class='add'>+    'true' =&gt; 'update',</div><div class='ctx'>     'array' =&gt; [['new_votes', ['digits', 'digits']]],</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> if (!user_isloggedin ())</div><div class='ctx'>   exit_not_logged_in ();</div><div class='ctx'> $remaining_votes = trackers_votes_remaining ();</div><div class='ctx'> </div><div class='del'>-if ($submit)</div><div class='add'>+if ($update)</div><div class='ctx'>   {</div><div class='ctx'>     $result = db_execute ("</div><div class='ctx'>        SELECT vote_id, tracker, item_id FROM user_votes</div><div class='hunk'>@@ -154,9 +155,8 @@ if ($remaining_votes &lt; 100)</div><div class='ctx'>           . group_getname ($res_row['group_id']) . ")&lt;/span&gt;&lt;/a&gt;&lt;/div&gt;\n";</div><div class='ctx'>       }</div><div class='ctx'> </div><div class='del'>-    print "&lt;br /&gt;\n&lt;div align=\"center\" class=\"noprint\"&gt;"</div><div class='del'>-      . '&lt;input type="submit" name="submit" class="bold" value="'</div><div class='del'>-      . _("Submit Changes") . "\" /&gt;&lt;/div&gt;\n&lt;/form&gt;\n";</div><div class='add'>+    print "&lt;br /&gt;\n"</div><div class='add'>+      . form_footer (_("Submit Changes"));</div><div class='ctx'>     print "\n\n" . show_priority_colors_key ();</div><div class='ctx'>   }</div><div class='ctx'> $HTML-&gt;footer ([]);</div><div class='head'>diff --git a/frontend/php/news/admin/index.php b/frontend/php/news/admin/index.php<br/>index 08cfbbf..93d7b18 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/news/admin/index.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/news/admin/index.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/news/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/news/admin/index.php</a></div><div class='hunk'>@@ -51,7 +51,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'preg' =&gt; [['form_news_address', '/^[-+_@.,;\s\da-zA-Z]*$/']],</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='del'>-</div><div class='add'>+form_check ('update');</div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='ctx'> </div><div class='hunk'>@@ -73,24 +73,20 @@ if ($update)</div><div class='ctx'>   }</div><div class='ctx'> site_project_header (['group' =&gt; $group_id, 'context' =&gt; 'anews']);</div><div class='ctx'> </div><div class='del'>-print '&lt;p&gt;'</div><div class='del'>-  . _("You can change all of this tracker configuration from this page.")</div><div class='del'>-  . "&lt;/p&gt;\n";</div><div class='del'>-</div><div class='ctx'> $res_grp = db_execute (</div><div class='ctx'>  "SELECT new_news_address FROM groups WHERE group_id = ?", [$group_id]</div><div class='ctx'> );</div><div class='ctx'> $row_grp = db_fetch_array ($res_grp);</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . _("News Tracker Email Notification Settings") . "&lt;/h2&gt;\n"</div><div class='add'>+print html_h (2, _("News Tracker Email Notification Settings"))</div><div class='ctx'>   . form_tag () . form_hidden (['group_id' =&gt; $group_id])</div><div class='del'>-  . '&lt;span class="preinput"&gt;&lt;label for="form_news_address"&gt;'</div><div class='del'>-  . _("Carbon-Copy List:") . "&lt;/label&gt;&lt;/span&gt;\n&lt;br /&gt;\n"</div><div class='del'>-  . "&amp;nbsp;&amp;nbsp;&lt;input type=\"text\" name=\"form_news_address\" "</div><div class='del'>-  . "id=\"form_news_address\" value=\"{$row_grp['new_news_address']}"</div><div class='del'>-  . "\" size=\"40\" maxlength=\"255\" /&gt;\n"</div><div class='del'>-  . '&lt;p align="center"&gt;&lt;input type="submit" name="update" value="'</div><div class='del'>-  . _("Update") . "\" /&gt;\n&lt;/form&gt;\n";</div><div class='add'>+  . '&lt;span class="preinput"&gt;'</div><div class='add'>+  . html_label ("form_news_address", _("Carbon-Copy List:"))</div><div class='add'>+  . "&lt;/span&gt;\n&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;"</div><div class='add'>+  . form_input ('text', 'form_news_address', $row_grp['new_news_address'],</div><div class='add'>+      "size='40' maxlength='255'"</div><div class='add'>+    )</div><div class='add'>+  . "\n" . form_footer (_("Update"));</div><div class='ctx'> </div><div class='ctx'> site_project_footer ();</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/news/approve.php b/frontend/php/news/approve.php<br/>index 955820d..827f9b8 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/news/approve.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/news/approve.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/news/approve.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/news/approve.php</a></div><div class='hunk'>@@ -45,15 +45,17 @@ require_once ('../include/init.php');</div><div class='ctx'> require_once ('../include/sendmail.php');</div><div class='ctx'> require_once ('../include/news/general.php');</div><div class='ctx'> </div><div class='del'>-extract (sane_import ('all',</div><div class='add'>+$submits = ['post_changes', 'approve'];</div><div class='add'>+extract (sane_import ('request',</div><div class='ctx'>   [</div><div class='ctx'>     'digits' =&gt; ['id', 'status'],</div><div class='ctx'>     'strings' =&gt; [['status', ['0', '4', '5']]],</div><div class='del'>-    'true' =&gt; ['update', 'post_changes', 'approve'],</div><div class='ctx'>     'specialchars' =&gt; ['summary', 'details'],</div><div class='add'>+    'true' =&gt; 'show'</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='del'>-</div><div class='add'>+extract (sane_import ('post', ['true' =&gt; $submits]));</div><div class='add'>+form_check ($submits);</div><div class='ctx'> if (!($group_id &amp;&amp; member_check (0, $group_id, 'N3')))</div><div class='ctx'>   exit_error (_("Action unavailable: only news managers can approve news."));</div><div class='ctx'> </div><div class='hunk'>@@ -63,14 +65,12 @@ if ($post_changes &amp;&amp; $approve)</div><div class='ctx'>     [ 'id' =&gt; $id, 'status' =&gt; $status, 'summary' =&gt; $summary,</div><div class='ctx'>       'details' =&gt; $details]</div><div class='ctx'>   );</div><div class='del'>-if ($post_changes)</div><div class='del'>-  $approve = null;</div><div class='ctx'> </div><div class='ctx'> site_project_header (</div><div class='ctx'>   ['title' =&gt; _("Manage"), 'group' =&gt; $group_id, 'context' =&gt; 'news']</div><div class='ctx'> );</div><div class='ctx'> </div><div class='del'>-if ($approve)</div><div class='add'>+if ($show)</div><div class='ctx'>   {</div><div class='ctx'>     $result = db_execute ("</div><div class='ctx'>       SELECT * FROM news_bytes WHERE id = ? AND group_id = ?", [$id, $group_id]</div><div class='head'>diff --git a/frontend/php/news/submit.php b/frontend/php/news/submit.php<br/>index f67351f..9ab611e 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/news/submit.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/news/submit.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/news/submit.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/news/submit.php</a></div><div class='hunk'>@@ -46,6 +46,7 @@ require_once ('../include/init.php');</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   ['true' =&gt; 'update', 'specialchars' =&gt; ['summary', 'details']]</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> if (!group_restrictions_check ($group_id, "news"))</div><div class='ctx'>   {</div><div class='hunk'>@@ -57,7 +58,6 @@ if (!group_restrictions_check ($group_id, "news"))</div><div class='ctx'> </div><div class='ctx'> if ($update)</div><div class='ctx'>   {</div><div class='del'>-    form_check ();</div><div class='ctx'>     $result = false;</div><div class='ctx'>     if ($summary)</div><div class='ctx'>       {</div><div class='hunk'>@@ -95,11 +95,10 @@ print '&lt;p class="warn"&gt;'</div><div class='ctx'>   . form_header () . form_hidden (["group_id" =&gt; $group_id])</div><div class='ctx'>   . "&lt;span class='preinput'&gt;" . html_label ('summary', _("Subject:"))</div><div class='ctx'>   . "&lt;/span&gt;&lt;br/&gt;&amp;nbsp;&amp;nbsp;\n"</div><div class='del'>-  . "&lt;input type='text' id='summary' name='summary' value=\"$summary\" "</div><div class='del'>-  . "size='65' maxlength='80' /&gt;&lt;br /&gt;\n"</div><div class='del'>-  . "&lt;span class='preinput'&gt;" . html_label ('details', _("Details"))</div><div class='add'>+  . form_input ('text', 'summary', $summary, "size='65' maxlength='80'")</div><div class='add'>+  . "&lt;br /&gt;\n&lt;span class='preinput'&gt;" . html_label ('details', _("Details"))</div><div class='ctx'>   . markup_info ("full") . "&lt;/span&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;\n"</div><div class='del'>-  . "&lt;textarea name='details' id='details' rows='20' cols='65' wrap='soft'&gt;\n"</div><div class='del'>-  . "$details&lt;/textarea&gt;&lt;br /&gt;\n" . form_footer ();</div><div class='add'>+  . form_textarea ('details', $details, "rows='20' cols='65' wrap='soft'")</div><div class='add'>+  . "&lt;br /&gt;\n" . form_footer ();</div><div class='ctx'> site_project_footer ([]);</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/people/admin/index.php b/frontend/php/people/admin/index.php<br/>index 0cab390..e643ad7 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/people/admin/index.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/people/admin/index.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/people/admin/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/people/admin/index.php</a></div><div class='hunk'>@@ -51,38 +51,43 @@ extract (sane_import ('post',</div><div class='ctx'>     'specialchars' =&gt; ['skill_name', 'cat_name'],</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ('post_changes');</div><div class='ctx'> </div><div class='ctx'> # This page is for site admins only.</div><div class='ctx'> if (!user_ismember (1, 'A'))</div><div class='ctx'>   exit_permission_denied ();</div><div class='ctx'> </div><div class='add'>+function report_db_result ($result, $success_msg)</div><div class='add'>+{</div><div class='add'>+  if ($result)</div><div class='add'>+    {</div><div class='add'>+      fb ($success_msg);</div><div class='add'>+      return;</div><div class='add'>+    }</div><div class='add'>+  print db_error ();</div><div class='add'>+  fb (_("Error inserting value"), 1);</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+function add_people_cat ($name)</div><div class='add'>+{</div><div class='add'>+  $result = db_execute (</div><div class='add'>+    "INSERT INTO people_job_category (name) VALUES (?)", [$name]</div><div class='add'>+  );</div><div class='add'>+  report_db_result ($result, _("Category Inserted"));</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+function add_skill ($name)</div><div class='add'>+{</div><div class='add'>+  $result = db_execute ("INSERT INTO people_skill (name) VALUES (?)", [$name]);</div><div class='add'>+  report_db_result ($result, _("Skill Inserted"));</div><div class='add'>+}</div><div class='add'>+</div><div class='ctx'> if ($post_changes)</div><div class='ctx'>   {</div><div class='del'>-    # Update the database.</div><div class='ctx'>     if ($people_cat)</div><div class='del'>-      {</div><div class='del'>-        $result = db_execute (</div><div class='del'>-          "INSERT INTO people_job_category (name) VALUES (?)", [$cat_name]</div><div class='del'>-        );</div><div class='del'>-        if (!$result)</div><div class='del'>-          {</div><div class='del'>-            print db_error();</div><div class='del'>-            fb (_("Error inserting value"));</div><div class='del'>-          }</div><div class='del'>-        fb (_("Category Inserted"));</div><div class='del'>-      }</div><div class='add'>+      add_people_cat ($cat_name);</div><div class='ctx'>     elseif ($people_skills)</div><div class='del'>-      {</div><div class='del'>-        $result = db_execute ("INSERT INTO people_skill (name) VALUES (?)",</div><div class='del'>-           [$skill_name]</div><div class='del'>-        );</div><div class='del'>-        if (!$result)</div><div class='del'>-          {</div><div class='del'>-            print db_error ();</div><div class='del'>-            fb (_("Error inserting value"));</div><div class='del'>-          }</div><div class='del'>-        fb (_("Skill Inserted"));</div><div class='del'>-      }</div><div class='add'>+      add_skill ($skill_name);</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='ctx'> if ($people_cat)</div><div class='hunk'>@@ -97,17 +102,16 @@ if ($people_cat)</div><div class='ctx'>       );</div><div class='ctx'>     else</div><div class='ctx'>       print '&lt;p&gt;' . _("No job categories"). "&lt;/p&gt;\n". db_error ();</div><div class='del'>-    print '&lt;h2&gt;'. _("Add a new job category:"). "&lt;/h2&gt;\n"</div><div class='add'>+    print html_h (2, _("Add a new job category:"))</div><div class='ctx'>       . form_tag ()</div><div class='ctx'>       . form_hidden (['people_cat' =&gt; 'y', 'post_changes' =&gt; 'y'])</div><div class='ctx'>       . "&lt;/p&gt;\n&lt;p&gt;&lt;label for='cat_name'&gt;"</div><div class='ctx'>       . _("New Category Name:") . "&lt;/label&gt;&lt;/p&gt;\n"</div><div class='del'>-      . "&lt;input type='text' name='cat_name' id='cat_name' value='' size='15' "</div><div class='del'>-      . "maxlength='30' /&gt;&lt;br /&gt;\n&lt;p&gt;&lt;strong&gt;&lt;span class='warn'&gt;"</div><div class='add'>+      . form_input ('text', 'cat_name', '', " size='15' maxlength='30'")</div><div class='add'>+      . "&lt;br /&gt;\n&lt;p&gt;&lt;strong&gt;&lt;span class='warn'&gt;"</div><div class='ctx'>       . _("Once you add a category, it cannot be deleted")</div><div class='ctx'>       . "&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;\n"</div><div class='del'>-      . '&lt;input type="submit" name="submit" value="' . _("Add") . "\" /&gt;&lt;/p&gt;\n"</div><div class='del'>-      . "&lt;/form&gt;\n";</div><div class='add'>+      . form_submit (_("Add"), "submit") . "&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='ctx'>   } # $people_cat</div><div class='ctx'> elseif ($people_skills)</div><div class='ctx'>   {</div><div class='hunk'>@@ -125,24 +129,23 @@ elseif ($people_skills)</div><div class='ctx'>         print db_error ();</div><div class='ctx'>         print "&lt;p&gt;" . _("No Skills Found") . "&lt;/p&gt;\n";</div><div class='ctx'>       }</div><div class='del'>-    print '&lt;h2&gt;' . _("Add a new skill:") . "&lt;/h2&gt;\n";</div><div class='add'>+    print html_h (2, _("Add a new skill:"));</div><div class='ctx'>     print "&lt;p&gt;" . form_tag ()</div><div class='ctx'>       . form_hidden (['people_skills' =&gt; 'y', 'post_changes' =&gt; 'y'])</div><div class='ctx'>       . "&lt;/p&gt;\n&lt;p&gt;&lt;label for='skill_name'&gt;"</div><div class='ctx'>       . _("New Skill Name:") . "&lt;/label&gt;&lt;/p&gt;\n"</div><div class='del'>-      . "&lt;input type='text' name='skill_name' id='skill_name' value=''\n"</div><div class='del'>-      . "size='15' maxlength='30' /&gt;&lt;br /&gt;\n"</div><div class='add'>+      . form_input ('text', 'skill_name', '', " size='15' maxlength='30'")</div><div class='add'>+      . "&lt;br /&gt;\n"</div><div class='ctx'>       . '&lt;p&gt;&lt;strong&gt;&lt;span class="warn"&gt;'</div><div class='ctx'>       . _("Once you add a skill, it cannot be deleted")</div><div class='ctx'>       . "&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;\n"</div><div class='del'>-      . '&lt;p&gt;&lt;input type="submit" name="submit" value="' . _("Add")</div><div class='del'>-      . "\" /&gt;&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='add'>+      . form_submit (_("Add"), "submit") . "&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='ctx'>   }</div><div class='ctx'> else # ! $people_skills</div><div class='ctx'>   {</div><div class='ctx'>     # Show main page.</div><div class='ctx'>     site_header (['title' =&gt; _('People Administration')]);</div><div class='del'>-    print '&lt;h1&gt;' . _("Help Wanted Administration") . '&lt;/h1&gt;';</div><div class='add'>+    print html_h (1, _("Help Wanted Administration"));</div><div class='ctx'>     print "&lt;p&gt;&lt;a href=\"$php_self?people_cat=1\"&gt;"</div><div class='ctx'>       . _("Add Job Categories") . "&lt;/a&gt;&lt;br /&gt;\n";</div><div class='ctx'>     print "\n&lt;a href=\"$php_self?people_skills=1\"&gt;"</div><div class='head'>diff --git a/frontend/php/people/createjob.php b/frontend/php/people/createjob.php<br/>index a10377d..f0b8044 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/people/createjob.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/people/createjob.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/people/createjob.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/people/createjob.php</a></div><div class='hunk'>@@ -71,7 +71,6 @@ print form_tag (['action' =&gt; $GLOBALS['sys_home'] . 'people/editjob.php'])</div><div class='ctx'>   . "&lt;/b&gt;&lt;br /&gt;\n"</div><div class='ctx'>   . form_textarea ('description', '', 'rows="10" cols="60" wrap="soft"')</div><div class='ctx'>   . "&lt;/p&gt;\n&lt;p&gt;"</div><div class='del'>-  . '&lt;input type="submit" name="add_job" value="'</div><div class='del'>-  . _("continue &gt;&gt;") . "\" /&gt;\n&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='add'>+  . form_submit (_("continue &gt;&gt;"), "add_job") . "\n&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='ctx'> site_project_footer ([]);</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/people/editjob.php b/frontend/php/people/editjob.php<br/>index be1dc5f..a6c219c 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/people/editjob.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/people/editjob.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/people/editjob.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/people/editjob.php</a></div><div class='hunk'>@@ -47,13 +47,12 @@ require_once ('../include/form.php');</div><div class='ctx'> require_once ('../include/people/general.php');</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('request', ['digits' =&gt; 'job_id']));</div><div class='add'>+$submits = ['add_job', 'update_job', 'add_to_job_inventory',</div><div class='add'>+  'update_job_inventory', 'delete_from_job_inventory',</div><div class='add'>+];</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt;</div><div class='del'>-      [</div><div class='del'>-       'add_job', 'update_job', 'add_to_job_inventory', 'update_job_inventory',</div><div class='del'>-       'delete_from_job_inventory',</div><div class='del'>-      ],</div><div class='add'>+    'true' =&gt; $submits,</div><div class='ctx'>     'digits' =&gt;</div><div class='ctx'>       [</div><div class='ctx'>         'status_id', 'category_id', 'job_inventory_id', 'skill_id',</div><div class='hunk'>@@ -63,6 +62,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'pass' =&gt; 'description',</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ($submits);</div><div class='ctx'> </div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='hunk'>@@ -199,7 +199,6 @@ if ($job_id)</div><div class='ctx'>       {</div><div class='ctx'>         print db_error ();</div><div class='ctx'>         fb (_("POSTING fetch FAILED"));</div><div class='del'>-        print '&lt;h1&gt;' . _("No Such Posting For This Project") . "&lt;/h1&gt;\n";</div><div class='ctx'>       }</div><div class='ctx'>     else</div><div class='ctx'>       {</div><div class='hunk'>@@ -217,17 +216,19 @@ if ($job_id)</div><div class='ctx'>           . people_job_status_box (</div><div class='ctx'>               'status_id', db_result ($result, 0, 'status_id')</div><div class='ctx'>             )</div><div class='del'>-          . "&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;&lt;label for='title'&gt;"</div><div class='del'>-          . _("Short Description:") . "&lt;/label&gt;&lt;/strong&gt;&lt;br /&gt;\n"</div><div class='add'>+          . "&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;"</div><div class='add'>+          . html_label ('title', _("Short Description:"))</div><div class='add'>+          . "&lt;/strong&gt;&lt;br /&gt;\n"</div><div class='ctx'>           . "&lt;input type='text' id='title' name='title' value=\""</div><div class='ctx'>           . db_result ($result, 0, 'title')</div><div class='ctx'>           . "\" size='40' maxlength='60' /&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;"</div><div class='del'>-          . "&lt;label for='description'&gt;" . _("Long Description:")</div><div class='del'>-          . "&lt;/label&gt;&lt;/strong&gt;&lt;br /&gt;\n"</div><div class='add'>+          . html_label ('description', _("Long Description:"))</div><div class='add'>+          . "&lt;/strong&gt;&lt;br /&gt;\n"</div><div class='ctx'>           . "&lt;textarea name='description' id='description' rows='10' "</div><div class='ctx'>           . "cols='60' wrap='soft'&gt;$description&lt;/textarea&gt;\n&lt;/p&gt;\n"</div><div class='del'>-          . '&lt;p&gt;&lt;input type="submit" name="update_job" value="'</div><div class='del'>-          . _("Update Descriptions") . "\" /&gt;\n&lt;/form&gt;\n";</div><div class='add'>+          . '&lt;p&gt;'</div><div class='add'>+          . form_submit (_("Update Descriptions"), "update_job")</div><div class='add'>+          . "\n&lt;/form&gt;\n";</div><div class='ctx'>         print '&lt;p&gt;' . people_edit_job_inventory ($job_id, $group_id)</div><div class='ctx'>           . "&lt;/p&gt;\n&lt;p&gt;[&lt;a href='/people'&gt;" . _("Back to jobs listing")</div><div class='ctx'>           . "&lt;/a&gt;]&lt;/p&gt;\n";</div><div class='head'>diff --git a/frontend/php/project/admin/editgroupfeatures.php b/frontend/php/project/admin/editgroupfeatures.php<br/>index e33b05b..e45d6ea 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/editgroupfeatures.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/project/admin/editgroupfeatures.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/editgroupfeatures.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/editgroupfeatures.php</a></div><div class='hunk'>@@ -42,11 +42,9 @@</div><div class='ctx'> # You should have received a copy of the GNU General Public License</div><div class='ctx'> # along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</div><div class='ctx'> </div><div class='del'>-require_once('../../include/init.php');</div><div class='del'>-require_once('../../include/sane.php');</div><div class='del'>-</div><div class='del'>-session_require(array('group' =&gt; $group_id,</div><div class='del'>-                      'admin_flags' =&gt; 'A'));</div><div class='add'>+require_once ('../../include/init.php');</div><div class='add'>+require_once ('../../include/sane.php');</div><div class='add'>+session_require (['group' =&gt; $group_id, 'admin_flags' =&gt; 'A']);</div><div class='ctx'> </div><div class='ctx'> $post_names = function ()</div><div class='ctx'> {</div><div class='hunk'>@@ -108,6 +106,7 @@ function type_usable ($group, $type, $field_name, $field)</div><div class='ctx'> </div><div class='ctx'> $names = $post_names ();</div><div class='ctx'> extract (sane_import ('post', $names));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> $query = sane_import ('get',</div><div class='ctx'>   ['specialchars' =&gt; 'feedback', 'digits' =&gt; 'error']</div><div class='head'>diff --git a/frontend/php/project/admin/editgroupinfo.php b/frontend/php/project/admin/editgroupinfo.php<br/>index f6d1781..c62d889 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/editgroupinfo.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/project/admin/editgroupinfo.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/editgroupinfo.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/editgroupinfo.php</a></div><div class='hunk'>@@ -48,18 +48,19 @@ require_once ('../../include/gpg.php');</div><div class='ctx'> $gpg_heading_level = 3;</div><div class='ctx'> require (utils_get_content_filename ("gpg-sample"));</div><div class='ctx'> </div><div class='add'>+$submit_buttons = [</div><div class='add'>+  'update', 'update_keyring', 'reset_keyring', 'test_keyring'</div><div class='add'>+];</div><div class='add'>+</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt;</div><div class='del'>-      [</div><div class='del'>-        'update', 'update_keyring', 'reset_keyring', 'test_keyring',</div><div class='del'>-        'upgrade_gpl',</div><div class='del'>-      ],</div><div class='add'>+    'true' =&gt; array_merge (['upgrade_gpl'], $submit_buttons),</div><div class='ctx'>     'pass' =&gt; ['new_keyring', 'form_longdesc'],</div><div class='ctx'>     'specialchars' =&gt; ['form_group_name', 'form_shortdesc'],</div><div class='ctx'>     'digits' =&gt; 'form_devel_status',</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ($submit_buttons);</div><div class='ctx'> </div><div class='ctx'> session_require (['group' =&gt; $group_id, 'admin_flags' =&gt; 'A']);</div><div class='ctx'> </div><div class='hunk'>@@ -130,8 +131,8 @@ $print_preinput = function ($label, $name, $markup = '')</div><div class='ctx'> {</div><div class='ctx'>   if (!empty ($markup))</div><div class='ctx'>     $markup = ' ' . markup_info ($markup);</div><div class='del'>-  print "&lt;p&gt;&lt;span class='preinput'&gt;&lt;label for='$name'&gt;"</div><div class='del'>-    . "$label&lt;/label&gt;$markup&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;&amp;nbsp;";</div><div class='add'>+  print "&lt;p&gt;&lt;span class='preinput'&gt;" . html_label ($name, $label)</div><div class='add'>+    . "$markup&lt;/span&gt;&lt;br /&gt;\n&amp;nbsp;&amp;nbsp;&amp;nbsp;";</div><div class='ctx'> };</div><div class='ctx'> </div><div class='ctx'> $print_preinput (_("Group Name:"), 'form_group_name');</div><div class='hunk'>@@ -186,20 +187,17 @@ if ($project-&gt;getLicense () == 'gpl')</div><div class='ctx'>   {</div><div class='ctx'>     print '&lt;p&gt;&lt;span class="preinput"&gt;' . _("GNU GPL v3:")</div><div class='ctx'>       . "&lt;/span&gt;\n&lt;br /&gt;&amp;nbsp;&amp;nbsp;";</div><div class='del'>-    print form_checkbox ("upgrade_gpl");</div><div class='del'>-    print "\n&lt;label for=\"upgrade_gpl\"&gt;"</div><div class='del'>-      . _("Upgrade license to &amp;quot;GNU GPLv3 or later&amp;quot;");</div><div class='del'>-    print "&lt;/label&gt;&lt;/p&gt;\n";</div><div class='add'>+    print form_checkbox ("upgrade_gpl") . "\n";</div><div class='add'>+    print html_label (</div><div class='add'>+      "upgrade_gpl", _("Upgrade license to &amp;quot;GNU GPLv3 or later&amp;quot;")</div><div class='add'>+    );</div><div class='add'>+    print "&lt;/p&gt;\n";</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='ctx'> print form_submit ();</div><div class='ctx'> </div><div class='del'>-print "\n&lt;h2&gt;" . _("GPG Keys Used for Releases") . "&lt;/h2&gt;\n";</div><div class='del'>-</div><div class='del'>-print $gpg_sample_text;</div><div class='del'>-</div><div class='del'>-if ($project-&gt;getTypeBaseHost () == "savannah.gnu.org")</div><div class='del'>-  print $gpg_gnu_maintainers_note;</div><div class='add'>+print html_h (2, _("GPG Keys Used for Releases"));</div><div class='add'>+gpg_sample_output ();</div><div class='ctx'> </div><div class='ctx'> if (!$new_keyring)</div><div class='ctx'>   $new_keyring = $keyring;</div><div class='head'>diff --git a/frontend/php/project/admin/editgroupnotifications.php b/frontend/php/project/admin/editgroupnotifications.php<br/>index 07ca115..f487946 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/editgroupnotifications.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/project/admin/editgroupnotifications.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/editgroupnotifications.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/editgroupnotifications.php</a></div><div class='hunk'>@@ -54,6 +54,7 @@ extract (sane_import ('post',</div><div class='ctx'>     'digits' =&gt; [['form_frequency', [0, 3]]],</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> if (empty ($form_news_address))</div><div class='ctx'>   $form_news_address = '';</div><div class='hunk'>@@ -87,12 +88,10 @@ site_project_header (</div><div class='ctx'> );</div><div class='ctx'> print form_tag () . form_hidden (['group_id' =&gt; $group_id]);</div><div class='ctx'> </div><div class='del'>-$show_intro = 1;</div><div class='ctx'> foreach ($artifacts as $art =&gt; $label)</div><div class='ctx'>   {</div><div class='ctx'>     print html_h (2, $label);</div><div class='del'>-    trackers_data_show_notification_settings ($group_id, $art, $show_intro);</div><div class='del'>-    $show_intro = 0;</div><div class='add'>+    trackers_data_show_notification_settings ($group_id, $art);</div><div class='ctx'>     print "&lt;br /&gt;\n";</div><div class='ctx'>   }</div><div class='ctx'> print html_h (2, _("News Manager Email Notification Settings"));</div><div class='hunk'>@@ -101,8 +100,6 @@ print '&lt;span class="preinput"&gt;' . _("Carbon-Copy List:")</div><div class='ctx'>   . form_input ('text', 'form_news_address', $row_grp['new_news_address'],</div><div class='ctx'>       "size='40' maxlength='255'")</div><div class='ctx'>   . "&lt;br /&gt;&lt;br /&gt;\n";</div><div class='del'>-</div><div class='del'>-print "\n&lt;p align='center'&gt;&lt;input type='submit' name='update' value='"</div><div class='del'>-  . _("Update") . "' /&gt;\n&lt;/form&gt;\n";</div><div class='add'>+print form_footer (_("Update"));</div><div class='ctx'> site_project_footer ([]);</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/project/admin/squadadmin.php b/frontend/php/project/admin/squadadmin.php<br/>index b665947..39b8bfe 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/squadadmin.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/project/admin/squadadmin.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/squadadmin.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/squadadmin.php</a></div><div class='hunk'>@@ -44,15 +44,14 @@</div><div class='ctx'> require_once ('../../include/init.php');</div><div class='ctx'> require_once ('../../include/account.php');</div><div class='ctx'> </div><div class='add'>+$submit_buttons = [</div><div class='add'>+  'update', 'update_general', 'update_delete_step1', 'update_delete_step2',</div><div class='add'>+  'add_to_squad', 'remove_from_squad'</div><div class='add'>+];</div><div class='ctx'> extract (sane_import ('request', ['digits' =&gt; 'squad_id']));</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='del'>-    'true' =&gt;</div><div class='del'>-      [</div><div class='del'>-        'update', 'update_general', 'update_delete_step1',</div><div class='del'>-        'update_delete_step2', 'deletionconfirmed', 'add_to_squad',</div><div class='del'>-        'remove_from_squad',</div><div class='del'>-      ],</div><div class='add'>+    'true' =&gt; array_merge ($submit_buttons, ['deletionconfirmed']),</div><div class='ctx'>     'array' =&gt; [['user_ids', ['digits', 'digits']]],</div><div class='ctx'>     'digits' =&gt; ['squad_id_to_delete'],</div><div class='ctx'>      # form_realname is sanitized further.</div><div class='hunk'>@@ -66,11 +65,7 @@ session_require (['group' =&gt; $group_id, 'admin_flags' =&gt; 'A']);</div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group ();</div><div class='ctx'> </div><div class='del'>-if (</div><div class='del'>-  $update || $update_general || $add_to_squad || $update_delete_step1</div><div class='del'>-  || $update_delete_step2 || $remove_from_squad</div><div class='del'>-)</div><div class='del'>-  form_check ();</div><div class='add'>+form_check ($submit_buttons);</div><div class='ctx'> </div><div class='ctx'> function finish_page ()</div><div class='ctx'> {</div><div class='hunk'>@@ -187,7 +182,7 @@ if ($squad_id)</div><div class='ctx'>     print form_submit (_("Update"), "update_general") . ' '</div><div class='ctx'>       . form_submit (_("Delete Squad"), "update_delete_step1") . "&lt;/form&gt;\n";</div><div class='ctx'> </div><div class='del'>-    print '&lt;h2&gt;' . _("Removing members") . "&lt;/h2&gt;\n";</div><div class='add'>+    print html_h (2, _("Removing members"));</div><div class='ctx'> </div><div class='ctx'>     $result_delusers = db_execute ("</div><div class='ctx'>       SELECT user.user_id, user.user_name, user.realname</div><div class='hunk'>@@ -216,14 +211,15 @@ if ($squad_id)</div><div class='ctx'>         $already_in_squad[$thisuser['user_id']] = true;</div><div class='ctx'>         $exists = true;</div><div class='ctx'>       }</div><div class='del'>-    $users_none_found = '&lt;h3&gt;' . _("Users") . "&lt;/h3&gt;\n&lt;p&gt;" . _("None found") . "&lt;/p&gt;\n";</div><div class='add'>+    $users_none_found =</div><div class='add'>+      html_h (3, _("Users")) . "\n&lt;p&gt;" . _("None found") . "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='ctx'>     if ($exists)</div><div class='ctx'>       print "$select&lt;/select&gt;&lt;br /&gt;\n";</div><div class='ctx'>     else</div><div class='ctx'>       print $users_none_found;</div><div class='ctx'>     print form_submit (_("Remove Members"), "remove_from_squad") . "&lt;/form&gt;\n";</div><div class='del'>-    print '&lt;h2&gt;' . _("Adding members") . "&lt;/h2&gt;\n";</div><div class='add'>+    print html_h (2, _("Adding members"));</div><div class='ctx'>     $result_addusers =  db_execute ("</div><div class='ctx'>       SELECT user.user_id, user.user_name, user.realname</div><div class='ctx'>       FROM user, user_group</div><div class='hunk'>@@ -257,7 +253,7 @@ if ($squad_id)</div><div class='ctx'>     else</div><div class='ctx'>       print $users_none_found;</div><div class='ctx'>     print form_submit (_("Add Members"), "add_to_squad") . "&lt;/form&gt;\n";</div><div class='del'>-    print '&lt;h2&gt;' . _("Setting permissions") . "&lt;/h2&gt;\n";</div><div class='add'>+    print html_h (2, _("Setting permissions"));</div><div class='ctx'>     print "&lt;p&gt;&lt;a href=\"userperms.php?group=$group#$squad_name\"&gt;"</div><div class='ctx'>       . _("Set Permissions") . "&lt;/a&gt;&lt;/p&gt;\n";</div><div class='ctx'>     finish_page ();</div><div class='hunk'>@@ -369,7 +365,7 @@ print '&lt;p&gt;'</div><div class='ctx'>     . "useful\nif you want to assign some items to several members at once.")</div><div class='ctx'>   . "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='del'>-print '&lt;h2 id="form"&gt;' . _("Squad List") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Squad List"), ['id' =&gt; 'form']);</div><div class='ctx'> </div><div class='ctx'> if ($rows &lt; 1)</div><div class='ctx'>   print '&lt;p class="warn"&gt;' . _("None found") . "&lt;/p&gt;\n";</div><div class='hunk'>@@ -387,7 +383,7 @@ else</div><div class='ctx'> # restriction by creating fake users, but the point is only to incitate</div><div class='ctx'> # to create squads only if necessary, not to really enforce something</div><div class='ctx'> # important).</div><div class='del'>-print '&lt;h2&gt;' . _("Create a New Squad") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, _("Create a New Squad"));</div><div class='ctx'> </div><div class='ctx'> $result = db_execute ("</div><div class='ctx'>   SELECT user_id FROM user_group</div><div class='hunk'>@@ -402,8 +398,9 @@ if ($rows &lt; db_numrows ($result))</div><div class='ctx'>       . _("Squad Login Name:") . "&lt;/label&gt;&lt;/span&gt;\n&lt;br /&gt;&amp;nbsp;&amp;nbsp;";</div><div class='ctx'>     print "$group-" . form_input ("text", "form_loginname", $form_loginname)</div><div class='ctx'>       . "&lt;/p&gt;\n";</div><div class='del'>-    print '&lt;p&gt;&lt;span class="preinput"&gt;&lt;label for="form_realname"&gt;'</div><div class='del'>-      . _("Squad Full Name:") . "&lt;/label&gt;&lt;/span&gt;\n&lt;br /&gt;&amp;nbsp;&amp;nbsp;";</div><div class='add'>+    print '&lt;p&gt;&lt;span class="preinput"&gt;'</div><div class='add'>+      . html_label ("form_realname", _("Squad Full Name:"))</div><div class='add'>+      . "&lt;/span&gt;\n&lt;br /&gt;&amp;nbsp;&amp;nbsp;";</div><div class='ctx'>     print form_input ("text", "form_realname", $form_realname) . "&lt;/p&gt;\n";</div><div class='ctx'>     print form_footer ();</div><div class='ctx'>   }</div><div class='head'>diff --git a/frontend/php/project/admin/useradmin.php b/frontend/php/project/admin/useradmin.php<br/>index e6615a4..bdf4c11 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/useradmin.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/project/admin/useradmin.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/useradmin.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/useradmin.php</a></div><div class='hunk'>@@ -48,6 +48,7 @@ require_once ('../../include/sendmail.php');</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='add'>+    'true' =&gt; 'update',</div><div class='ctx'>     'array' =&gt; [['user_ids', [null, 'digits']]],</div><div class='ctx'>     'pass' =&gt; 'words',</div><div class='ctx'>     'strings' =&gt;</div><div class='hunk'>@@ -62,8 +63,10 @@ extract (sane_import ('post',</div><div class='ctx'>       ],</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='del'>-</div><div class='add'>+form_check ('update');</div><div class='ctx'> session_require (['group' =&gt; $group_id, 'admin_flags' =&gt; 'A']);</div><div class='add'>+if (!$update)</div><div class='add'>+  $action = '';</div><div class='ctx'> </div><div class='ctx'> if (!$group_id)</div><div class='ctx'>   exit_no_group();</div><div class='hunk'>@@ -75,7 +78,7 @@ function usr_string ($usr)</div><div class='ctx'> </div><div class='ctx'> function show_pending_users_list ($result, $group_id)</div><div class='ctx'> {</div><div class='del'>-  print "&lt;h2&gt;" . _("Users Pending for Group") . "&lt;/h2&gt;\n&lt;p&gt;";</div><div class='add'>+  print html_h (2, _("Users Pending for Group")) . "&lt;p&gt;";</div><div class='ctx'>   print html_label ('pending_user_list',</div><div class='ctx'>     _("Users that have requested to be member of the group are listed\n"</div><div class='ctx'>       . "here. To approve their requests, select their names and push "</div><div class='hunk'>@@ -99,14 +102,13 @@ function show_pending_users_list ($result, $group_id)</div><div class='ctx'>     }</div><div class='ctx'> </div><div class='ctx'>   print "$select$options&lt;/select&gt;\n" . form_hidden (['group_id' =&gt; $group_id])</div><div class='del'>-    . "&lt;p&gt;\n&lt;input type=\"submit\" name=\"Submit\" value=\""</div><div class='del'>-    . _("Approve users for group") . "\" /&gt;\n&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='add'>+    . form_footer (_("Approve users for group"));</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function show_all_users_remove_list ($result, $result2, $group_id)</div><div class='ctx'> {</div><div class='ctx'>   $exists = false;</div><div class='del'>-  print "&lt;h2&gt;" . _("Removing users from group") . "&lt;/h2&gt;\n&lt;p&gt;";</div><div class='add'>+  print html_h (2, _("Removing users from group")) . "&lt;p&gt;";</div><div class='ctx'>   print html_label ('rm_user_list',</div><div class='ctx'>     _("To remove users, select their names and push the button\nbelow. "</div><div class='ctx'>       . "The administrators of a project cannot be removed unless they "</div><div class='hunk'>@@ -133,13 +135,12 @@ function show_all_users_remove_list ($result, $result2, $group_id)</div><div class='ctx'>     }</div><div class='ctx'>   print "$select$options&lt;/select&gt;\n&lt;br /&gt;\n";</div><div class='ctx'>   print form_hidden (['group_id' =&gt; $group_id])</div><div class='del'>-    . "&lt;p&gt;\n&lt;input type=\"submit\" name=\"Submit\" value=\""</div><div class='del'>-    . _("Remove users from group") . "\" /&gt;\n&lt;/p&gt;&lt;/form&gt;\n";</div><div class='add'>+    . form_footer (_("Remove users from group"));</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function show_all_users_add_searchbox ($group_id, $previous_search)</div><div class='ctx'> {</div><div class='del'>-  print '&lt;h2 id="searchuser"&gt;' . _("Adding users to group") . "&lt;/h2&gt;\n&lt;p&gt;";</div><div class='add'>+  print html_h (2, _("Adding users to group"), "searchuser") . "\n&lt;p&gt;";</div><div class='ctx'>   print html_label ('words',</div><div class='ctx'>     _("You can search one or several users to add in the whole users\n"</div><div class='ctx'>       . "database with the following search tool. A list of users, "</div><div class='head'>diff --git a/frontend/php/project/admin/userperms.php b/frontend/php/project/admin/userperms.php<br/>index d2a9334..6f216f9 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/userperms.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/project/admin/userperms.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/project/admin/userperms.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/project/admin/userperms.php</a></div><div class='hunk'>@@ -46,14 +46,13 @@</div><div class='ctx'> require_once ('../../include/init.php');</div><div class='ctx'> session_require (['group' =&gt; $group_id, 'admin_flags' =&gt; 'A']);</div><div class='ctx'> </div><div class='del'>-# Internal function to determine if a squad permission must override user perm</div><div class='del'>-# or not.</div><div class='del'>-# * If user got lower rights, we override, because we assume that user has</div><div class='del'>-#   been added to obtain at least the rights given the squad.</div><div class='del'>-# * If user got higher rights, we let as it is because the user may be</div><div class='del'>-#   member of a squad that provides somes rights to its members but being</div><div class='del'>-#   himself someone that have other duties requiring in some cases more</div><div class='del'>-#   rights.</div><div class='add'>+# Internal function to determine if squad's permissions override user's</div><div class='add'>+# permissions.</div><div class='add'>+# * If the user has lower permissions, we override, we assume that the user</div><div class='add'>+#   has been added to obtain at least the permissions given to the squad.</div><div class='add'>+# * If the user has higher permissions, the user may be a member of a squad</div><div class='add'>+#   that provides some permissions to its members, but the user has</div><div class='add'>+#   other duties requiring in some cases more permissions.</div><div class='ctx'> # Return true in the first item when squad permissions will be used.</div><div class='ctx'> # The second item is the actual value.</div><div class='ctx'> function effective_permissions ($squad_perm, $user_perm)</div><div class='hunk'>@@ -86,7 +85,7 @@ function effective_permissions ($squad_perm, $user_perm)</div><div class='ctx'>   if (($user_perm == "1" &amp;&amp; $squad_perm == "3")</div><div class='ctx'>       || ($squad_perm == "1" &amp;&amp; $user_perm == "3"))</div><div class='ctx'>     return [true, "2"];</div><div class='del'>-  # If we end here, nothing conclusive, keep the user's perm.</div><div class='add'>+  # Default to the user's perm.</div><div class='ctx'>   return [false, $user_perm];</div><div class='ctx'> }</div><div class='ctx'> </div><div class='hunk'>@@ -498,7 +497,7 @@ function print_squad_rows ($project, $titles)</div><div class='ctx'> function list_squads ($group_id, $project)</div><div class='ctx'> {</div><div class='ctx'>   global $squad_list;</div><div class='del'>-  print "&lt;h2&gt;" . _("Permissions per squad") . "&lt;/h2&gt;\n";</div><div class='add'>+  print html_h (2, _("Permissions per squad"));</div><div class='ctx'>   if (empty ($squad_list))</div><div class='ctx'>     {</div><div class='ctx'>       print '&lt;p class="warn"&gt;' . _("No Squads Found") . "&lt;/p&gt;\n";</div><div class='hunk'>@@ -578,7 +577,7 @@ function print_member_rows ($project, $titles)</div><div class='ctx'> function list_members ($group_id, $project)</div><div class='ctx'> {</div><div class='ctx'>   global $user_list;</div><div class='del'>-  print "&lt;h2&gt;" . _("Permissions per member") . "&lt;/h2&gt;\n";</div><div class='add'>+  print html_h (2, _("Permissions per member"));</div><div class='ctx'>   if (empty ($user_list))</div><div class='ctx'>     {</div><div class='ctx'>       print '&lt;p class="warn"&gt;' . _("No Members Found") . "&lt;/p&gt;\n";</div><div class='hunk'>@@ -594,7 +593,7 @@ function list_members ($group_id, $project)</div><div class='ctx'> </div><div class='ctx'> function print_group_posting_title ($project)</div><div class='ctx'> {</div><div class='del'>-  print '&lt;h2&gt;' . _("Group trackers posting restrictions") . "&lt;/h2&gt;\n";</div><div class='add'>+  print html_h (2, _("Group trackers posting restrictions"));</div><div class='ctx'>   $titles = [</div><div class='ctx'>     # TRANSLATORS: this is the header for a column with two rows,</div><div class='ctx'>     # "Posting new items" and "Posting comments".</div><div class='hunk'>@@ -656,7 +655,7 @@ function print_group_posting_defaults ($group_id, $project)</div><div class='ctx'> function print_member_defaults ($group_id, $project)</div><div class='ctx'> {</div><div class='ctx'>   global $trackers, $group_permissions;</div><div class='del'>-  print "&lt;h2&gt;" . _("Group Default Permissions") . "&lt;/h2&gt;\n";</div><div class='add'>+  print html_h (2, _("Group Default Permissions"));</div><div class='ctx'>   $titles = [];</div><div class='ctx'>   append_tracker_titles ($titles, $project);</div><div class='ctx'>   member_explain_roles ();</div><div class='hunk'>@@ -691,6 +690,7 @@ function init_data ()</div><div class='ctx'> init_data ();</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post', ['true' =&gt; 'update']));</div><div class='add'>+form_check ('update');</div><div class='ctx'> if ($update)</div><div class='ctx'>   {</div><div class='ctx'>     $feedback_able = $feedback_unable = $feedback_squad_override = '';</div><div class='hunk'>@@ -712,7 +712,6 @@ if ($update)</div><div class='ctx'>     fetch_group_data ($group_id);</div><div class='ctx'>   } # if ($update)</div><div class='ctx'> </div><div class='del'>-</div><div class='ctx'> site_project_header (</div><div class='ctx'>   ['title' =&gt; _("Set Permissions"), 'group' =&gt; $group_id, 'context' =&gt; 'ahome']</div><div class='ctx'> );</div><div class='head'>diff --git a/frontend/php/register/index.php b/frontend/php/register/index.php<br/>index 94516da..db259ee 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/register/index.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/register/index.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/register/index.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/register/index.php</a></div><div class='hunk'>@@ -60,13 +60,12 @@ require_once ('../include/sendmail.php');</div><div class='ctx'> # require maintainance, since some people interrupt registration and</div><div class='ctx'> # try to redoit later with another name.</div><div class='ctx'> # And even if a name clash happens, admins will notice it during approval.</div><div class='del'>-function group_does_not_already_exist ($form_unix_name)</div><div class='add'>+function group_does_not_already_exist ($unix_name)</div><div class='ctx'> {</div><div class='del'>-  $res = db_execute ("</div><div class='del'>-    SELECT group_id FROM groups</div><div class='del'>-    WHERE unix_group_name LIKE ? AND status &lt;&gt; 'I'", [$form_unix_name]</div><div class='add'>+  $res = db_execute (</div><div class='add'>+    "SELECT group_id FROM groups WHERE unix_group_name LIKE ?", [$unix_name]</div><div class='ctx'>   );</div><div class='del'>-  return db_numrows ($res) &lt; 1;</div><div class='add'>+  return !db_numrows ($res);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function license_exists ($form_license)</div><div class='head'>diff --git a/frontend/php/register/upload.php b/frontend/php/register/upload.php<br/>index fb10432..868c44a 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/register/upload.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/register/upload.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/register/upload.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/register/upload.php</a></div><div class='hunk'>@@ -59,6 +59,8 @@ if (empty ($tarball['tmp_name']))</div><div class='ctx'>    exit (0);</div><div class='ctx'>  }</div><div class='ctx'> </div><div class='add'>+form_check ();</div><div class='add'>+</div><div class='ctx'> if (!is_uploaded_file ($tarball['tmp_name']))</div><div class='ctx'>   exit (0);</div><div class='ctx'> if ($tarball['error'] != 0)</div><div class='head'>diff --git a/frontend/php/sendmessage.php b/frontend/php/sendmessage.php<br/>index 158d2fd..25c0d10 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/sendmessage.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/sendmessage.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/sendmessage.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/sendmessage.php</a></div><div class='hunk'>@@ -53,6 +53,8 @@ extract (sane_import ('request',</div><div class='ctx'>   ])</div><div class='ctx'> );</div><div class='ctx'> </div><div class='add'>+form_check ('send_mail');</div><div class='add'>+</div><div class='ctx'> if (!user_isloggedin ())</div><div class='ctx'>   exit_not_logged_in ();</div><div class='ctx'> </div><div class='head'>diff --git a/frontend/php/siteadmin/group_type.php b/frontend/php/siteadmin/group_type.php<br/>index 6941d1c..4e8ea41 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/group_type.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/siteadmin/group_type.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/group_type.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/group_type.php</a></div><div class='hunk'>@@ -80,9 +80,11 @@ function show_checkbox ($title, $field, $row)</div><div class='ctx'>     . "&lt;/p&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='add'>+$submits = ['delete', 'update'];</div><div class='ctx'> extract (sane_import ('request', ['digits' =&gt; 'type_id']));</div><div class='ctx'> extract (sane_import ('get', ['true' =&gt; 'create']));</div><div class='del'>-extract (sane_import ('post', ['true' =&gt; ['delete', 'update']]));</div><div class='add'>+extract (sane_import ('post', ['true' =&gt; $submits]));</div><div class='add'>+form_check ($submits);</div><div class='ctx'> </div><div class='ctx'> $trackers_labelled = [</div><div class='ctx'>   'cookbook' =&gt; no_i18n ("Cookbook Manager"),</div><div class='hunk'>@@ -236,7 +238,7 @@ if (empty ($type_id))</div><div class='ctx'> </div><div class='ctx'>   print "&lt;a href=\"$php_self?type_id=$type&amp;amp;create=1\"&gt;"</div><div class='ctx'>     . no_i18n ('Create new group type') . '&lt;/a&gt;';</div><div class='del'>-  site_admin_footer ([]);</div><div class='add'>+  site_admin_footer ();</div><div class='ctx'>   exit (0);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='hunk'>@@ -702,5 +704,5 @@ foreach ($checkboxes as $k =&gt; $v)</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='ctx'> print "$update_delete_buttons&lt;/form&gt;\n";</div><div class='del'>-site_admin_footer ([]);</div><div class='add'>+site_admin_footer ();</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/siteadmin/groupedit.php b/frontend/php/siteadmin/groupedit.php<br/>index 4c186d2..168711c 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/groupedit.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/siteadmin/groupedit.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/groupedit.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/groupedit.php</a></div><div class='hunk'>@@ -50,14 +50,16 @@ session_require (['group' =&gt; $sys_group_id, 'admin_flags' =&gt; 'A']);</div><div class='ctx'> # We don't internationalize messages in this file because they are</div><div class='ctx'> # for Savannah admins who use English.</div><div class='ctx'> </div><div class='add'>+$submit_buttons = ['update', 'fastok', 'fastdel'];</div><div class='ctx'> $post_names = function ()</div><div class='ctx'> {</div><div class='add'>+  global $submit_buttons;</div><div class='ctx'>   $names = [</div><div class='del'>-    'true' =&gt; 'update',</div><div class='add'>+    'true' =&gt; $submit_buttons,</div><div class='ctx'>     'name' =&gt; 'form_name',</div><div class='ctx'>     'digits' =&gt; ['group_type', 'form_public'],</div><div class='ctx'>     'specialchars' =&gt; ['form_license', 'form_license_other'],</div><div class='del'>-    'preg' =&gt; [['form_status', '/^[A-Z]$/']]</div><div class='add'>+    'strings' =&gt; [['form_status', ['A', 'D']]]</div><div class='ctx'>   ];</div><div class='ctx'>   return $names;</div><div class='ctx'> };</div><div class='hunk'>@@ -78,11 +80,9 @@ if (project_get_object ($group_id)-&gt;getStatus () == 'X')</div><div class='ctx'>   }</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('post', $post_names ()));</div><div class='del'>-extract (sane_import ('get',</div><div class='del'>-  ['true' =&gt; 'updatefast', 'preg' =&gt; [['status', '/^[A-Z]$/']]]</div><div class='del'>-));</div><div class='add'>+form_check ($submit_buttons);</div><div class='ctx'> </div><div class='del'>-if ($update || $updatefast)</div><div class='add'>+if (!form_vars_empty ($submit_buttons))</div><div class='ctx'>   {</div><div class='ctx'>     # Full details update.</div><div class='ctx'>     if ($update)</div><div class='hunk'>@@ -121,9 +121,9 @@ if ($update || $updatefast)</div><div class='ctx'>           DB_AUTOQUERY_UPDATE, "group_id = ?", [$group_id]</div><div class='ctx'>         );</div><div class='ctx'>       } # $update</div><div class='del'>-    if ($updatefast)</div><div class='add'>+    if ($fastok || $fastdel)</div><div class='ctx'>       db_execute ("UPDATE groups SET status = ? WHERE group_id = ?",</div><div class='del'>-        [$status, $group_id]</div><div class='add'>+        [$form_status, $group_id]</div><div class='ctx'>       );</div><div class='ctx'>     fb (no_i18n ("Updating group info"));</div><div class='ctx'>   }</div><div class='hunk'>@@ -151,10 +151,21 @@ print "&lt;a href='../projects/{$row_grp['unix_group_name']}'&gt;"</div><div class='ctx'> print '&lt;/p&gt;</div><div class='ctx'> ';</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . no_i18n ("Registration Management Shortcuts") . "&lt;/h2&gt;\n";</div><div class='del'>-print "&lt;a href=\"$php_self?status=A&amp;amp;updatefast=1&amp;amp;group_id=$group_id\"&gt;"</div><div class='del'>-  . html_image ("bool/ok.orig.png", ['alt' =&gt; no_i18n ("Approve")])</div><div class='del'>-  . '&lt;/a&gt;';</div><div class='add'>+function print_updatefast ($status, $image, $label, $name)</div><div class='add'>+{</div><div class='add'>+  global $group_id;</div><div class='add'>+  print form_tag ();</div><div class='add'>+  print form_hidden ([</div><div class='add'>+    'form_status' =&gt; $status, 'group_id' =&gt; $group_id, $name =&gt; 1</div><div class='add'>+  ]);</div><div class='add'>+  # The variables from &lt;input type="image" /&gt; are ignored, the previously</div><div class='add'>+  # defined &lt;input type="hidden" /&gt; is used instead.</div><div class='add'>+  print form_image ($image, $label, "submit_$name");</div><div class='add'>+  print "\n&lt;/form&gt;\n&lt;br /&gt;\n";</div><div class='add'>+}</div><div class='add'>+</div><div class='add'>+print html_h (2, no_i18n ("Registration Management Shortcuts"));</div><div class='add'>+print_updatefast ('A', 'bool/ok.orig.png', no_i18n ("Approve"), 'fastok');</div><div class='ctx'> $res = db_execute (</div><div class='ctx'>   "SELECT COUNT(group_list_id) AS cnt FROM mail_group_list WHERE group_id = ?",</div><div class='ctx'>   [$group_id]</div><div class='hunk'>@@ -164,10 +175,7 @@ $list_row = db_fetch_array ($res);</div><div class='ctx'> if (!empty ($list_row))</div><div class='ctx'>   $no_lists = $list_row['cnt'] &lt; 1;</div><div class='ctx'> if ($no_lists)</div><div class='del'>-  print "&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=\"$php_self"</div><div class='del'>-    . "?status=D&amp;amp;updatefast=1&amp;amp;group_id=$group_id\"&gt;"</div><div class='del'>-    . html_image ("bool/wrong.orig.png", ['alt' =&gt; no_i18n ("Discard")])</div><div class='del'>-    . '&lt;/a&gt;';</div><div class='add'>+  print_updatefast ('D', 'bool/wrong.orig.png', no_i18n ("Discard"), 'fastdel');</div><div class='ctx'> else</div><div class='ctx'>   {</div><div class='ctx'>     $msg = sprintf (</div><div class='hunk'>@@ -178,9 +186,8 @@ else</div><div class='ctx'>     );</div><div class='ctx'>     print "&lt;br /&gt;\n$msg&lt;br /&gt;\n";</div><div class='ctx'>   }</div><div class='del'>-</div><div class='ctx'> print form_tag ();</div><div class='del'>-print '&lt;h2&gt;' . no_i18n ("Detailed Interface") . "&lt;/h2&gt;\n";</div><div class='add'>+print html_h (2, no_i18n ("Detailed Interface"));</div><div class='ctx'> $HTML-&gt;box1_top (no_i18n ("General Settings"));</div><div class='ctx'> </div><div class='ctx'> print '&lt;p&gt;&lt;span class="preinput"&gt;' . no_i18n ("Group Type:")</div><div class='hunk'>@@ -198,7 +205,7 @@ function next_altrow ()</div><div class='ctx'> $i = 0;</div><div class='ctx'> next_altrow ();</div><div class='ctx'> print '&lt;p&gt;&lt;span class="preinput"&gt;&lt;label for="form_name"&gt;'</div><div class='del'>-  . no_i18n("System Name:") . "&lt;/label&gt;&lt;/span&gt;&lt;br /&gt;\n";</div><div class='add'>+  . no_i18n ("System Name:") . "&lt;/label&gt;&lt;/span&gt;&lt;br /&gt;\n";</div><div class='ctx'> print '&lt;input type="text" name="form_name" id="form_name" value="'</div><div class='ctx'>   . $row_grp['unix_group_name'] . '" /&gt;';</div><div class='ctx'> </div><div class='hunk'>@@ -274,12 +281,14 @@ print '&lt;p&gt;&lt;input type="submit" name="update" value="' . no_i18n ("Update")</div><div class='ctx'> </div><div class='ctx'> $HTML-&gt;box1_bottom ();</div><div class='ctx'> </div><div class='del'>-print "&lt;p&gt;&lt;a href='triggercreation.php?group_id=$group_id'&gt;"</div><div class='del'>-  . no_i18n (</div><div class='del'>-      "Send new group instruction email and trigger group creation "</div><div class='del'>-      . "(should be done only once)"</div><div class='del'>-    )</div><div class='del'>-  . "&lt;/a&gt;&lt;/p&gt;\n";</div><div class='add'>+print "&lt;p&gt;";</div><div class='add'>+print form_tag (['action' =&gt; "triggercreation.php"]);</div><div class='add'>+print form_hidden (['group_id' =&gt; $group_id]);</div><div class='add'>+print form_submit (no_i18n (</div><div class='add'>+  "Send new group instruction email and trigger group creation "</div><div class='add'>+  . "(should be done only once)"</div><div class='add'>+));</div><div class='add'>+print "&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='ctx'> $HTML-&gt;box1_top (no_i18n ("Submitted Information"));</div><div class='ctx'> project_admin_registration_info ($row_grp);</div><div class='head'>diff --git a/frontend/php/siteadmin/grouplist.php b/frontend/php/siteadmin/grouplist.php<br/>index 7a61aff..12369ab 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/grouplist.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/siteadmin/grouplist.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/grouplist.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/grouplist.php</a></div><div class='hunk'>@@ -50,12 +50,13 @@ site_admin_header (</div><div class='ctx'>   ['title' =&gt; no_i18n ("Group List"), 'context' =&gt; 'admgroup']</div><div class='ctx'> );</div><div class='ctx'> </div><div class='del'>-extract (sane_import ('post', ['pass' =&gt; 'search', 'true' =&gt; 'groupsearch']));</div><div class='ctx'> extract (sane_import ('get',</div><div class='ctx'>   [</div><div class='ctx'>     'digits' =&gt; ['offset', 'max_rows'],</div><div class='ctx'>     'name' =&gt; 'group_name_search',</div><div class='ctx'>     'preg' =&gt; [['status', '/^[A-Z]$/']],</div><div class='add'>+    'pass' =&gt; 'search',</div><div class='add'>+    'true' =&gt; 'groupsearch'</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='ctx'> </div><div class='hunk'>@@ -117,12 +118,10 @@ print "&lt;br /&gt;\n"</div><div class='ctx'>   . no_i18n ("or search by group_id, group_unix_name or group_name:");</div><div class='ctx'> </div><div class='ctx'> print "\n"</div><div class='del'>-  . form_tag (['name' =&gt; 'gpsrch'])</div><div class='del'>-  . form_input ('text', 'search', $search,</div><div class='del'>-     'title="' . no_i18n ("Group name") . '"') . "\n"</div><div class='add'>+  . form_tag (['name' =&gt; 'gpsrch', 'method' =&gt; 'get'])</div><div class='add'>+  . form_input ('text', 'search', $search) . "\n"</div><div class='ctx'>   . form_hidden (['groupsearch' =&gt; '1'])</div><div class='del'>-  . "&lt;input type='submit' value=\"" . no_i18n ("Search") . "\" /&gt;\n"</div><div class='del'>-  . "&lt;/form&gt;\n&lt;/p&gt;\n";</div><div class='add'>+  . form_submit (no_i18n ("Search")) . "&lt;/form&gt;\n&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='ctx'> print '&lt;h2&gt;' . no_i18n ("Group List") . "&lt;/h2&gt;\n";</div><div class='ctx'> </div><div class='head'>diff --git a/frontend/php/siteadmin/mailman.php b/frontend/php/siteadmin/mailman.php<br/>index 636cf17..c6833d0 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/mailman.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/siteadmin/mailman.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/mailman.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/mailman.php</a></div><div class='hunk'>@@ -45,12 +45,14 @@ require_once ("../include/mailman.php");</div><div class='ctx'> </div><div class='ctx'> session_require (['group' =&gt; '1', 'admin_flags' =&gt; 'A']);</div><div class='ctx'> </div><div class='add'>+$submits = ['assign', 'confirm'];</div><div class='ctx'> extract (sane_import ('request',</div><div class='ctx'>   [</div><div class='ctx'>     'preg' =&gt; [['list_name', '/^[a-zA-Z0-9-]+$/']],</div><div class='del'>-    'name' =&gt; ['new_group'], 'true' =&gt; ['assign', 'confirm']</div><div class='add'>+    'name' =&gt; ['new_group'], 'true' =&gt; $submits</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ($submits);</div><div class='ctx'> </div><div class='ctx'> if (!empty ($confirm))</div><div class='ctx'>   $assign = null;</div><div class='hunk'>@@ -284,7 +286,7 @@ function show_assign_form ()</div><div class='ctx'>     $label = no_i18n ("Assign list");</div><div class='ctx'>   else</div><div class='ctx'>     $label = no_i18n ("Confirm assignment");</div><div class='del'>-  print "&lt;p&gt;&lt;input type='submit' value=\"$label\" /&gt;&lt;/p&gt;\n";</div><div class='add'>+  print "&lt;p&gt;" . form_submit ($label, 'submit') . "&lt;/p&gt;\n";</div><div class='ctx'>   print "&lt;/form&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='hunk'>@@ -316,10 +318,10 @@ function show_page ($may_assign)</div><div class='ctx'>   $extra = empty ($assign)? '': " disabled='disabled'";</div><div class='ctx'> </div><div class='ctx'>   print form_tag (['name' =&gt; 'search_list']);</div><div class='del'>-  print "&lt;h2&gt;" . no_i18n ('Search for mailing list') . "&lt;/h2&gt;\n";</div><div class='add'>+  print html_h (2, no_i18n ('Search for mailing list'));</div><div class='ctx'>   show_list_input ($extra);</div><div class='ctx'>   display_list_data ();</div><div class='del'>-  print "&lt;h2&gt;" . no_i18n ('Search for group') . "&lt;/h2&gt;\n";</div><div class='add'>+  print html_h (2, no_i18n ('Search for group'));</div><div class='ctx'>   show_group_input ($extra);</div><div class='ctx'>   display_group_found ();</div><div class='ctx'>   show_search_button ();</div><div class='head'>diff --git a/frontend/php/siteadmin/triggercreation.php b/frontend/php/siteadmin/triggercreation.php<br/>index 19cf990..6845e8e 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/triggercreation.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/siteadmin/triggercreation.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/triggercreation.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/triggercreation.php</a></div><div class='hunk'>@@ -61,6 +61,7 @@ $res_type = db_execute (</div><div class='ctx'>   "SELECT * FROM group_type WHERE type_id = ?", [$group_type]</div><div class='ctx'> );</div><div class='ctx'> $user_id = user_getid ();</div><div class='add'>+form_check ();</div><div class='ctx'> </div><div class='ctx'> $to_update = ["homepage", "download", "cvs", "forum", "mailing_list", "task",</div><div class='ctx'>   "news", "support", "bug"</div><div class='head'>diff --git a/frontend/php/siteadmin/user_changepw.php b/frontend/php/siteadmin/user_changepw.php<br/>index e7d7d4a..c8e41d8 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/user_changepw.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/siteadmin/user_changepw.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/user_changepw.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/user_changepw.php</a></div><div class='hunk'>@@ -54,6 +54,7 @@ extract (sane_import ('request', ['digits' =&gt; 'user_id']));</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   ['true' =&gt; 'update', 'pass' =&gt; ['form_pw', 'form_pw2']]</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='ctx'> </div><div class='ctx'> $error = '';</div><div class='ctx'> </div><div class='head'>diff --git a/frontend/php/siteadmin/usergroup.php b/frontend/php/siteadmin/usergroup.php<br/>index b0dc708..97c0227 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/usergroup.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/siteadmin/usergroup.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/usergroup.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/usergroup.php</a></div><div class='hunk'>@@ -55,24 +55,28 @@ require_once ('../include/trackers/data.php');</div><div class='ctx'> session_require (['group' =&gt; '1','admin_flags' =&gt; 'A']);</div><div class='ctx'> </div><div class='ctx'> $actions = ['remove_user_from_group', 'update_user_group',</div><div class='del'>-  'update_user', 'add_user_to_group', 'rename'</div><div class='add'>+  'update_user', 'add_user_to_group', 'rename', 'delete'</div><div class='ctx'> ];</div><div class='ctx'> </div><div class='ctx'> extract (sane_import ('request',</div><div class='ctx'>   [</div><div class='del'>-    'digits' =&gt; ['user_id', 'comment_max_rows', 'comment_offset'],</div><div class='del'>-    'strings' =&gt; [['action', array_merge ($actions, ['delete'])],],</div><div class='add'>+    'digits' =&gt; ['user_id', 'comment_max_rows', 'comment_offset']</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='ctx'> extract (sane_import ('post',</div><div class='ctx'>   [</div><div class='add'>+    'strings' =&gt; [['action', $actions]],</div><div class='ctx'>     'name' =&gt; 'new_name',</div><div class='add'>+    'true' =&gt; 'update',</div><div class='ctx'>     'preg' =&gt; [</div><div class='ctx'>       ['email', '/^[a-zA-Z\d_.+-]+@(([a-zA-Z\d-])+\.)+[a-zA-Z\d]+$/'],</div><div class='ctx'>       ['admin_flags', '/^[A-Z\d]+$/'],</div><div class='del'>-    ],</div><div class='add'>+    ]</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='add'>+form_check ('update');</div><div class='add'>+if (empty ($update))</div><div class='add'>+  $action = null;</div><div class='ctx'> </div><div class='ctx'> if (empty ($comment_max_rows))</div><div class='ctx'>   $comment_max_rows = 50;</div><div class='hunk'>@@ -92,7 +96,7 @@ function print_contribution_heading ($user_id)</div><div class='ctx'> {</div><div class='ctx'>   if ($user_id == 100)</div><div class='ctx'>     return;</div><div class='del'>-  print "&lt;h2&gt;". no_i18n ("Contributions") . "&lt;/h2&gt;\n";</div><div class='add'>+  print html_h (2, no_i18n ("Contributions"));</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function tracker_query ($user_id, $tracker)</div><div class='hunk'>@@ -207,6 +211,11 @@ function report_db_result ($result, $msg_err, $msg_ok)</div><div class='ctx'>     fb ($msg_ok);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='add'>+function action_delete ()</div><div class='add'>+{</div><div class='add'>+  user_delete ($GLOBALS['user_id']);</div><div class='add'>+}</div><div class='add'>+</div><div class='ctx'> function action_remove_user_from_group ()</div><div class='ctx'> {</div><div class='ctx'>   global $user_id, $group_id;</div><div class='hunk'>@@ -277,8 +286,8 @@ function rename_form ($user_id, $user_name)</div><div class='ctx'>     . form_hidden (['action' =&gt; 'rename', 'user_id' =&gt; $user_id])</div><div class='ctx'>     . "&lt;p&gt;Account:\n&lt;input type='text' title=\"" . no_i18n ("New name")</div><div class='ctx'>     . '" name="new_name" size="22"  value="' . $user_name</div><div class='del'>-    . '" maxlength="55"&gt;' . "&amp;nbsp;\n&lt;input type='submit' name='update_name'"</div><div class='del'>-    . ' value="' . no_i18n ('Rename') . "\"&gt;&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='add'>+    . '" maxlength="55"&gt;' . "&amp;nbsp;\n"</div><div class='add'>+    . form_submit (no_i18n ('Rename')) . "&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function email_form ($user_id, $email)</div><div class='hunk'>@@ -287,19 +296,16 @@ function email_form ($user_id, $email)</div><div class='ctx'>     . form_hidden (['action' =&gt; 'update_user', 'user_id' =&gt; $user_id])</div><div class='ctx'>     . "&lt;p&gt;Email:\n&lt;input type='text' size='25' title=\"" . no_i18n ("Email")</div><div class='ctx'>     . "\" name='email' value=\"$email\" maxlength='55'&gt;"</div><div class='del'>-    . "&amp;nbsp;\n" . '&lt;input type="submit" name="update_user" value="'</div><div class='del'>-    . no_i18n ('Update') . "\"&gt;&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='add'>+    . "&amp;nbsp;\n" . form_submit (no_i18n ('Update')) . "&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function add_to_group_form ($user_id)</div><div class='ctx'> {</div><div class='ctx'>   return form_tag ()</div><div class='ctx'>     . form_hidden (["action" =&gt; "add_user_to_group", "user_id" =&gt; $user_id])</div><div class='del'>-    . "&lt;label for='group_id'&gt;\n" . no_i18n ('Add to group (group_id):')</div><div class='del'>-    . "&lt;/label&gt;\n&amp;nbsp;\n"</div><div class='del'>-    . '&lt;input type="text" name="group_id" id="group_id" size="17" '</div><div class='del'>-    . "/&gt;&amp;nbsp;\n" . '&lt;input type="submit" name="Submit" value="'</div><div class='del'>-    . no_i18n ('Submit') . "\" /&gt;\n&lt;/form&gt;\n\n";</div><div class='add'>+    . html_label ('group_id', no_i18n ('Add to group (group_id):'))</div><div class='add'>+    . "\n&amp;nbsp;\n" . form_input ('text', "group_id", '',  'size="17"')</div><div class='add'>+    . "&amp;nbsp;\n" . form_submit (no_i18n ('Update')) . "&lt;/p&gt;\n&lt;/form&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function change_passwd_link ($user_id)</div><div class='hunk'>@@ -310,14 +316,15 @@ function change_passwd_link ($user_id)</div><div class='ctx'> </div><div class='ctx'> function delete_account_link ($user_id)</div><div class='ctx'> {</div><div class='del'>-  return '&lt;a href="/siteadmin/userlist.php?action=delete&amp;amp;user_id='</div><div class='del'>-    . $user_id . '"&gt;' . no_i18n ('[Delete account]') . "&lt;/a&gt;\n\n";</div><div class='add'>+  return form_tag ()</div><div class='add'>+    . form_hidden (["action" =&gt; "delete", "user_id" =&gt; $user_id])</div><div class='add'>+    . form_submit (no_i18n ('Delete account')) . "\n&lt;/form&gt;\n";</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function account_title ($user_id)</div><div class='ctx'> {</div><div class='del'>-  return '&lt;h2&gt;' . no_i18n ('Account info:')</div><div class='del'>-    . " #$user_id &amp;lt;" . user_getname ($user_id) . "&amp;gt;&lt;/h2&gt;\n";</div><div class='add'>+  return html_h (2,  no_i18n ('Account info:')</div><div class='add'>+    . " #$user_id &amp;lt;" . user_getname ($user_id) . "&amp;gt;");</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function account_form ($user_id, $row_user)</div><div class='hunk'>@@ -360,13 +367,13 @@ function group_entry ($user_id, $status, $row_cat)</div><div class='ctx'>   if ($status == 'SQD')</div><div class='ctx'>     return "&lt;p&gt;\n&lt;a href=\"/project/admin/squadadmin.php?"</div><div class='ctx'>       . "squad_id=$user_id&amp;amp;group_id=$grp_id\"&gt;$grp_name&lt;/a&gt;&lt;/p&gt;\n";</div><div class='del'>-  $ret = "\n&lt;h3&gt;$grp_name&lt;/h3&gt;\n";</div><div class='add'>+  $ret = html_h (3, $grp_name);</div><div class='ctx'>   return $ret . user_group_form ($user_id, $grp_id, $row_cat['admin_flags']);</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> function list_groups ($user_id, $status)</div><div class='ctx'> {</div><div class='del'>-  print '&lt;h2&gt;' . no_i18n ('Current Groups') . "&lt;/h2&gt;\n";</div><div class='add'>+  print html_h (2, no_i18n ('Current Groups'));</div><div class='ctx'>   $res_cat = db_execute ("</div><div class='ctx'>     SELECT g.group_name, g.group_id, u.admin_flags FROM groups g, user_group u</div><div class='ctx'>     WHERE u.user_id = ? AND g.group_id = u.group_id", [$user_id]</div><div class='hunk'>@@ -393,6 +400,14 @@ if (in_array ($action, $actions))</div><div class='ctx'> </div><div class='ctx'> $HTML-&gt;header (['title' =&gt; no_i18n ('Admin: Manage user')]);</div><div class='ctx'> $res_user = db_execute ("SELECT * FROM user WHERE user_id = ?", [$user_id]);</div><div class='add'>+if (!db_numrows ($res_user))</div><div class='add'>+  {</div><div class='add'>+    print '&lt;p&gt;';</div><div class='add'>+    printf (no_i18n ('User #%s not found.'), $user_id);</div><div class='add'>+    print "&lt;/p&gt;\n";</div><div class='add'>+    $HTML-&gt;footer ([]);</div><div class='add'>+    exit;</div><div class='add'>+  }</div><div class='ctx'> $row_user = db_fetch_array ($res_user);</div><div class='ctx'> </div><div class='ctx'> print account_form ($user_id, $row_user);</div><div class='head'>diff --git a/frontend/php/siteadmin/userlist.php b/frontend/php/siteadmin/userlist.php<br/>index cbc1a2d..8765809 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/userlist.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/siteadmin/userlist.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/siteadmin/userlist.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/siteadmin/userlist.php</a></div><div class='hunk'>@@ -52,49 +52,17 @@ extract (sane_import ('get',</div><div class='ctx'>   [</div><div class='ctx'>     'digits' =&gt; ['offset', 'user_id'],</div><div class='ctx'>     'specialchars' =&gt; 'text_search',</div><div class='del'>-    'strings' =&gt; [</div><div class='del'>-      ['action', ['delete', 'suspend', 'activate']],</div><div class='del'>-    ],</div><div class='ctx'>     'name' =&gt; 'user_name_search',</div><div class='ctx'>   ]</div><div class='ctx'> ));</div><div class='ctx'> extract (sane_import ('request', ['pass' =&gt; 'search']));</div><div class='ctx'> </div><div class='del'>-# Get user_name and realname as they were before the action to display</div><div class='del'>-# in further feedback.</div><div class='del'>-if ($action)</div><div class='del'>-  $result = db_execute (</div><div class='del'>-    "SELECT user_name, realname FROM user WHERE user_id = ?", [$user_id]</div><div class='del'>-  );</div><div class='del'>-</div><div class='del'>-if ($action == 'delete' || $action == 'suspend')</div><div class='del'>-  {</div><div class='del'>-    user_delete ($user_id);</div><div class='del'>-    $out = no_i18n("DELETE");</div><div class='del'>-  }</div><div class='del'>-if ($action == 'activate')</div><div class='del'>-  {</div><div class='del'>-    db_execute("UPDATE user SET status='A' WHERE user_id=?", array($user_id));</div><div class='del'>-    $out = no_i18n("ACTIVE");</div><div class='del'>-  }</div><div class='del'>-</div><div class='del'>-if ($action)</div><div class='del'>-  {</div><div class='del'>-    print '&lt;h2&gt;' . no_i18n("Action done") . ":&lt;/h2&gt;\n&lt;/p&gt;";</div><div class='del'>-</div><div class='del'>-    $usr = db_fetch_array($result);</div><div class='del'>-    printf(no_i18n('Status updated to %s for user %s %s.'), $out, $user_id,</div><div class='del'>-           utils_user_link ($usr['user_name'], $usr['realname']));</div><div class='del'>-    print "&lt;/p&gt;\n";</div><div class='del'>-    print db_error();</div><div class='del'>-  }</div><div class='del'>-</div><div class='ctx'> $abc_array = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',</div><div class='ctx'>   'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '0', '1',</div><div class='ctx'>   '2', '3', '4', '5', '6', '7', '8', '9', '_'</div><div class='ctx'> ];</div><div class='ctx'> </div><div class='del'>-print '&lt;h2&gt;' . no_i18n ("User Search") . "&lt;/h2&gt;\n&lt;p&gt;"</div><div class='add'>+print html_h (2, no_i18n ("User Search"))</div><div class='ctx'>   . no_i18n ("Display users beginning with:") . ' ';</div><div class='ctx'> </div><div class='ctx'> for ($i = 0; $i &lt; count ($abc_array); $i++)</div><div class='hunk'>@@ -105,7 +73,7 @@ for ($i = 0; $i &lt; count ($abc_array); $i++)</div><div class='ctx'> print "&lt;br /&gt;\n"</div><div class='ctx'>   . no_i18n ("Search by email, username, realname or userid:") . "\n";</div><div class='ctx'> print form_tag (['method' =&gt; 'get', 'name' =&gt; 'usersrch'])</div><div class='del'>-  . "&lt;input type='text' name='text_search' value=\"$text_search\" /&gt;\n"</div><div class='add'>+  . form_input ('text', 'text_search',  $text_search)</div><div class='ctx'>   . form_hidden (['usersearch' =&gt; '1'])</div><div class='ctx'>   . form_submit (no_i18n ("Search")) . "\n&lt;/form&gt;\n&lt;/p&gt;\n";</div><div class='ctx'> </div><div class='hunk'>@@ -172,10 +140,7 @@ print "&lt;/h2&gt;\n";</div><div class='ctx'> $rows = $rows_returned = db_numrows ($result);</div><div class='ctx'> </div><div class='ctx'> print html_build_list_table_top (</div><div class='del'>-  [</div><div class='del'>-    no_i18n ("Id"), no_i18n ("User"), no_i18n ("Status"),</div><div class='del'>-    no_i18n ("Member Profile"), no_i18n ("Action")</div><div class='del'>-  ]</div><div class='add'>+  [no_i18n ("Id"), no_i18n ("User"), no_i18n ("Status"), no_i18n ("Profile")]</div><div class='ctx'> );</div><div class='ctx'> </div><div class='ctx'> function finish_page ()</div><div class='hunk'>@@ -229,14 +194,7 @@ for ($i = 0; $i &lt; $rows; $i++)</div><div class='ctx'>         . no_i18n ("View") . "]&lt;/a&gt;&lt;/td&gt;\n";</div><div class='ctx'>     else</div><div class='ctx'>       print '&lt;td&gt;(' . no_i18n ("Private") . ")&lt;/td&gt;\n";</div><div class='del'>-    print '&lt;td&gt;';</div><div class='del'>-    if ($stat != 'D' &amp;&amp; $stat != 'S' &amp;&amp; $stat != 'SQD')</div><div class='del'>-      print "&lt;a href='?action=delete&amp;user_id=$usr_id'&gt;["</div><div class='del'>-        . no_i18n ("Delete") . "]&lt;/a&gt;\n";</div><div class='del'>-    if ($stat != 'A' &amp;&amp; $stat != 'SQD')</div><div class='del'>-      print "&lt;a href='?action=activate&amp;user_id=$usr_id'&gt;["</div><div class='del'>-        . no_i18n ("Activate") . "]&lt;/a&gt;\n";</div><div class='del'>-    print "&lt;/td&gt;\n&lt;/tr&gt;\n";</div><div class='add'>+    print "\n&lt;/tr&gt;\n";</div><div class='ctx'>   }</div><div class='ctx'> finish_page ()</div><div class='ctx'> ?&gt;</div><div class='head'>diff --git a/frontend/php/testing/sane.php b/frontend/php/testing/sane.php<br/>index 14b2207..8553e90 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/php/testing/sane.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/php/testing/sane.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/php/testing/sane.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/php/testing/sane.php</a></div><div class='hunk'>@@ -2095,23 +2095,22 @@ $reference = 'sendmessage.php';</div><div class='ctx'> </div><div class='ctx'> $reference = 'siteadmin/groupedit.php';</div><div class='ctx'> {</div><div class='del'>-  $names = ['true' =&gt; 'updatefast', 'preg' =&gt; [['status', '/^[A-Z]$/']]];</div><div class='del'>-  $in = $out = ['updatefast' =&gt; 'true', 'status' =&gt; 'P'];</div><div class='del'>-  test_sane_import ($in, $names, $out);</div><div class='ctx'>   $names = [</div><div class='del'>-    'true' =&gt; 'update',</div><div class='add'>+    'true' =&gt; ['update', 'fastok', 'fastdel'],</div><div class='ctx'>     'name' =&gt; 'form_name',</div><div class='ctx'>     'digits' =&gt; ['group_type', 'form_public'],</div><div class='ctx'>     'specialchars' =&gt; ['form_license', 'form_license_other'],</div><div class='del'>-    'preg' =&gt; [['form_status', '/^[A-Z]$/']]</div><div class='add'>+    'strings' =&gt; [['form_status', ['A', 'D']]]</div><div class='ctx'>   ];</div><div class='ctx'>   $dirs = ['cvs', 'arch', 'svn', 'git', 'hg', 'bzr', 'homepage', 'download'];</div><div class='ctx'>   foreach ($dirs as $d)</div><div class='ctx'>     $names['specialchars'][] = "form_dir_$d";</div><div class='ctx'>   $in = $out = [</div><div class='del'>-    'update' =&gt; true, 'form_public' =&gt; 0, 'form_status' =&gt; 'A',</div><div class='add'>+    'update' =&gt; true, 'fastok' =&gt; true,</div><div class='add'>+    'form_public' =&gt; 0, 'form_status' =&gt; 'A',</div><div class='ctx'>     'form_name' =&gt; 'grep', 'group_type' =&gt; 1,</div><div class='ctx'>   ];</div><div class='add'>+  $out['fastdel'] = false;</div><div class='ctx'>   foreach ($names['specialchars'] as $n)</div><div class='ctx'>     $in[$n] = $out[$n] = $n;</div><div class='ctx'>   test_sane_import ($in, $names, $out);</div><div class='head'>diff --git a/frontend/site-specific/gnu/gpg-sample.php b/frontend/site-specific/gnu/gpg-sample.php<br/>index 8d5dfdc..80446f3 100644<br/>--- a/<a href='/cgit/administration/savane.git/tree/frontend/site-specific/gnu/gpg-sample.php?h=i18n&amp;id=dc8aed89037abadb612f2e46dcb703503fcfd7cd'>frontend/site-specific/gnu/gpg-sample.php</a><br/>+++ b/<a href='/cgit/administration/savane.git/tree/frontend/site-specific/gnu/gpg-sample.php?h=i18n&amp;id=d3962d3feb75467489b869204db98e2dffaaaf09'>frontend/site-specific/gnu/gpg-sample.php</a></div><div class='hunk'>@@ -76,4 +76,13 @@ See the GNU Maintainer Information, node</div><div class='ctx'> &lt;a href="%s"&gt;Automated Upload Registration&lt;/a&gt;.'),</div><div class='ctx'> "//www.gnu.org/prep/maintain/maintain.html#Automated-Upload-Registration")</div><div class='ctx'> . "&lt;/p&gt;\n";</div><div class='add'>+</div><div class='add'>+function gpg_sample_output ()</div><div class='add'>+{</div><div class='add'>+  global $project, $gpg_sample_text, $gpg_gnu_maintainers_note;</div><div class='add'>+  print $gpg_sample_text;</div><div class='add'>+</div><div class='add'>+  if ($project-&gt;getTypeBaseHost () == "savannah.gnu.org")</div><div class='add'>+    print $gpg_gnu_maintainers_note;</div><div class='add'>+}</div><div class='ctx'> ?&gt;</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit v1.1</a> at 2025-01-11 03:38:05 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
