
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwasm3%2Fwasm3%2Fissues%2F379)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwasm3%2Fwasm3%2Fissues%2F379)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=wasm3%2Fwasm3)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wasm3](/wasm3)
/
**[wasm3](/wasm3/wasm3)**
Public

* [Notifications](/login?return_to=%2Fwasm3%2Fwasm3) You must be signed in to change notification settings
* [Fork
  473](/login?return_to=%2Fwasm3%2Fwasm3)
* [Star
   7.4k](/login?return_to=%2Fwasm3%2Fwasm3)

* [Code](/wasm3/wasm3)
* [Issues
  54](/wasm3/wasm3/issues)
* [Pull requests
  22](/wasm3/wasm3/pulls)
* [Actions](/wasm3/wasm3/actions)
* [Security](/wasm3/wasm3/security)
* [Insights](/wasm3/wasm3/pulse)

Additional navigation options

* [Code](/wasm3/wasm3)
* [Issues](/wasm3/wasm3/issues)
* [Pull requests](/wasm3/wasm3/pulls)
* [Actions](/wasm3/wasm3/actions)
* [Security](/wasm3/wasm3/security)
* [Insights](/wasm3/wasm3/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fwasm3%2Fwasm3%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fwasm3%2Fwasm3%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# SEGV wasm3/source/m3\_exec.h:1078 in op\_Select\_i32\_srs #379

Closed

[ioo0s](/ioo0s) opened this issue
Aug 29, 2022
· 2 comments

Closed

# [SEGV wasm3/source/m3\_exec.h:1078 in op\_Select\_i32\_srs](#top) #379

[ioo0s](/ioo0s) opened this issue
Aug 29, 2022
· 2 comments

Labels
[wasm-validation](/wasm3/wasm3/labels/wasm-validation)

## Comments

[![@ioo0s](https://avatars.githubusercontent.com/u/82093214?s=80&u=8a658e1c075cc2c323e48a0356aa9bd96fa8cf2d&v=4)](/ioo0s)

Copy link

### **[ioo0s](/ioo0s)** commented [Aug 29, 2022](#issue-1353593173)

| Gdb info  ``` Program received signal SIGSEGV, Segmentation fault. 0x00005555555bbf69 in op_Select_i32_srs (_pc=0x62d0000004c0, _sp=0x631000000800, _mem=0x631000014800, _r0=3840, _fp0=1) at /home/ios/CVE/wasm3/source/m3_exec.h:1078 1078	d_m3Select_i (i32, _r0) LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA ───────────────────────────────────────────────────────[ REGISTERS ]───────────────────────────────────────────────────────  RAX  0x6311556fa980 ◂— 0x0  RBX  0x7fffffffcfa0 ◂— 0x41b58ab3  RCX  0x6311556fa980 ◂— 0x0  RDX  0x0  RDI  0x3  RSI  0x631000000800 ◂— 0x1000000000000  R8   0x5555555bbe20 (op_Select_i32_srs) ◂— endbr64   R9   0x3  R10  0x555555666940 ◂— 0x74726174735f /* '_start' */  R11  0x0  R12  0xffffffff9f4 ◂— 0x0  R13  0x7fffffffcfa0 ◂— 0x41b58ab3  R14  0x7fffffffd340 ◂— 0x41b58ab3  R15  0x0  RBP  0x7fffffffcea0 —▸ 0x7fffffffcef0 —▸ 0x7fffffffcf40 —▸ 0x7fffffffd020 —▸ 0x7fffffffd100 ◂— ...  RSP  0x7fffffffce60 —▸ 0xaffffcf20 ◂— 0x0  RIP  0x5555555bbf69 (op_Select_i32_srs+329) ◂— mov    eax, dword ptr [rcx] ────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────  ► 0x5555555bbf69 <op_Select_i32_srs+329>    mov    eax, dword ptr [rcx]    0x5555555bbf6b <op_Select_i32_srs+331>    mov    dword ptr [rbp - 4], eax    0x5555555bbf6e <op_Select_i32_srs+334>    cmp    dword ptr [rbp - 0xc], 0    0x5555555bbf72 <op_Select_i32_srs+338>    je     op_Select_i32_srs+347                <op_Select_i32_srs+347>      0x5555555bbf74 <op_Select_i32_srs+340>    mov    eax, dword ptr [rbp - 4]    0x5555555bbf77 <op_Select_i32_srs+343>    cdqe       0x5555555bbf79 <op_Select_i32_srs+345>    jmp    op_Select_i32_srs+352                <op_Select_i32_srs+352>     ↓    0x5555555bbf80 <op_Select_i32_srs+352>    mov    qword ptr [rbp - 0x30], rax    0x5555555bbf84 <op_Select_i32_srs+356>    mov    rax, qword ptr [rbp - 0x18]    0x5555555bbf88 <op_Select_i32_srs+360>    mov    rdx, rax    0x5555555bbf8b <op_Select_i32_srs+363>    shr    rdx, 3 ─────────────────────────────────────────────────────[ SOURCE (CODE) ]───────────────────────────────────────────────────── In file: /home/ios/CVE/wasm3/source/m3_exec.h    1073                                                 \    1074     nextOp ();                                  \    1075 }    1076     1077   ► 1078 d_m3Select_i (i32, _r0)    1079 d_m3Select_i (i64, _r0)    1080     1081     1082 #define d_m3Select_f(TYPE, REG, LABEL, SELECTOR)  \    1083 d_m3Op  (Select_##TYPE##_##LABEL##ss)           \ ─────────────────────────────────────────────────────────[ STACK ]───────────────────────────────────────────────────────── 00:0000│ rsp 0x7fffffffce60 —▸ 0xaffffcf20 ◂— 0x0 01:0008│     0x7fffffffce68 ◂— 0x3ff0000000000000 02:0010│     0x7fffffffce70 ◂— 0xf00 03:0018│     0x7fffffffce78 —▸ 0x631000014800 —▸ 0x626000000100 ◂— 0x626000000100 04:0020│     0x7fffffffce80 —▸ 0x631000000800 ◂— 0x1000000000000 05:0028│     0x7fffffffce88 —▸ 0x62d0000004c0 —▸ 0x5555555bdea0 (op_Return) ◂— endbr64  06:0030│     0x7fffffffce90 —▸ 0x141b58ab3 ◂— 0x0 07:0038│     0x7fffffffce98 ◂— 0x555500000f00 ───────────────────────────────────────────────────────[ BACKTRACE ]───────────────────────────────────────────────────────  ► f 0   0x5555555bbf69 op_Select_i32_srs+329    f 1   0x5555555a8fc5 op_f64_Ceil_s+261    f 2   0x5555555a55e6 op_i32_Divide_rs+422    f 3   0x5555555bf506 op_f32_Load_f32_s+838    f 4   0x5555555caca2 op_i32_Store_i32_ss+994    f 5   0x5555555ba807 op_SetSlot_i32+263    f 6   0x5555555b939e op_MemGrow+350    f 7   0x5555555aa330 op_i32_EqualToZero_s+272  ```  Asan Info  ``` AddressSanitizer:DEADLYSIGNAL ================================================================= ==3977==ERROR: AddressSanitizer: SEGV on unknown address 0x63108b682980 (pc 0x55c322d9df69 bp 0x7ffc71ba1260 sp 0x7ffc71ba1220 T0) ==3977==The signal is caused by a READ memory access.     #0 0x55c322d9df68 in op_Select_i32_srs /home/ios/CVE/wasm3/source/m3_exec.h:1078     #1 0x55c322d8afc4 in op_f64_Ceil_s /home/ios/CVE/wasm3/source/m3_exec.h:272     #2 0x55c322d875e5 in op_i32_Divide_rs /home/ios/CVE/wasm3/source/m3_exec.h:231     #3 0x55c322da1505 in op_f32_Load_f32_s /home/ios/CVE/wasm3/source/m3_exec.h:1341     #4 0x55c322dacca1 in op_i32_Store_i32_ss /home/ios/CVE/wasm3/source/m3_exec.h:1449     #5 0x55c322d9c806 in op_SetSlot_i32 /home/ios/CVE/wasm3/source/m3_exec.h:941     #6 0x55c322d9b39d in op_MemGrow /home/ios/CVE/wasm3/source/m3_exec.h:704     #7 0x55c322d8c32f in op_i32_EqualToZero_s /home/ios/CVE/wasm3/source/m3_exec.h:282     #8 0x55c322d9bf1b in op_Entry /home/ios/CVE/wasm3/source/m3_exec.h:808     #9 0x55c322dc168a in RunCode /home/ios/CVE/wasm3/source/m3_exec_defs.h:58     #10 0x55c322dc76cc in m3_CallArgv /home/ios/CVE/wasm3/source/m3_env.c:953     #11 0x55c322d65510 in repl_call /home/ios/CVE/wasm3/platforms/app/main.c:274     #12 0x55c322d682f4 in main /home/ios/CVE/wasm3/platforms/app/main.c:634     #13 0x7fcbd3bff082 in __libc_start_main ../csu/libc-start.c:308     #14 0x55c322d6422d in _start (/home/ios/CVE/wasm3/build/wasm3+0x2e22d)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV /home/ios/CVE/wasm3/source/m3_exec.h:1078 in op_Select_i32_srs ==3977==ABORTING  ```  current commit : `7890a2097569fde845881e0b352d813573e371f9`  Poc [op\_Select\_i32\_srs.wasm.gz](https://github.com/wasm3/wasm3/files/9441091/op_Select_i32_srs.wasm.gz) |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@ioo0s](https://avatars.githubusercontent.com/u/82093214?s=80&u=8a658e1c075cc2c323e48a0356aa9bd96fa8cf2d&v=4)](/ioo0s)

Copy link

Author

### **[ioo0s](/ioo0s)** commented [Aug 29, 2022](#issuecomment-1229675919)

| Add another poc.  current commit : `7890a2097569fde845881e0b352d813573e371f9`  Asan info  ``` AddressSanitizer:DEADLYSIGNAL ================================================================= ==5877==ERROR: AddressSanitizer: SEGV on unknown address 0x6310731b5900 (pc 0x55571cc5f122 bp 0x7fffc6418010 sp 0x7fffc6417fd0 T0) ==5877==The signal is caused by a READ memory access.     #0 0x55571cc5f121 in op_Select_i32_ssr /home/ios/CVE/wasm3/source/m3_exec.h:1078     #1 0x55571cc414bc in op_f32_GreaterThanOrEqual_rs /home/ios/CVE/wasm3/source/m3_exec.h:193     #2 0x55571cc67f00 in op_i64_Load_i32_s /home/ios/CVE/wasm3/source/m3_exec.h:1355     #3 0x55571cc59a62 in op_i32_Reinterpret_f32_s_r /home/ios/CVE/wasm3/source/m3_exec.h:489     #4 0x55571cc59882 in op_i32_Reinterpret_f32_r_s /home/ios/CVE/wasm3/source/m3_exec.h:489     #5 0x55571cc59a62 in op_i32_Reinterpret_f32_s_r /home/ios/CVE/wasm3/source/m3_exec.h:489     #6 0x55571cc4ec0d in op_i32_Trunc_f32_r_s /home/ios/CVE/wasm3/source/m3_exec.h:370     #7 0x55571cc5b21e in op_f64_Reinterpret_i64_s_s /home/ios/CVE/wasm3/source/m3_exec.h:492     #8 0x55571cc4bc43 in op_f64_Abs_s /home/ios/CVE/wasm3/source/m3_exec.h:271     #9 0x55571cc59a62 in op_i32_Reinterpret_f32_s_r /home/ios/CVE/wasm3/source/m3_exec.h:489     #10 0x55571cc59882 in op_i32_Reinterpret_f32_r_s /home/ios/CVE/wasm3/source/m3_exec.h:489     #11 0x55571cc5cf1b in op_Entry /home/ios/CVE/wasm3/source/m3_exec.h:808     #12 0x55571cc8268a in RunCode /home/ios/CVE/wasm3/source/m3_exec_defs.h:58     #13 0x55571cc886cc in m3_CallArgv /home/ios/CVE/wasm3/source/m3_env.c:953     #14 0x55571cc26510 in repl_call /home/ios/CVE/wasm3/platforms/app/main.c:274     #15 0x55571cc292f4 in main /home/ios/CVE/wasm3/platforms/app/main.c:634     #16 0x7f0541953082 in __libc_start_main ../csu/libc-start.c:308     #17 0x55571cc2522d in _start (/home/ios/CVE/wasm3/build/wasm3+0x2e22d)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV /home/ios/CVE/wasm3/source/m3_exec.h:1078 in op_Select_i32_ssr ==5877==ABORTING  ```  POC [op\_Select\_i32\_ssr.zip](https://github.com/wasm3/wasm3/files/9441133/op_Select_i32_ssr.zip) |
| --- |

All reactions

Sorry, something went wrong.

[![@vshymanskyy](https://avatars.githubusercontent.com/u/1506708?s=40&u=03ac130af6ece3d92329b1a690ae65343128fdf8&v=4)](/vshymanskyy)
[vshymanskyy](/vshymanskyy)
added
the
[wasm-validation](/wasm3/wasm3/labels/wasm-validation)
label
[Aug 29, 2022](#event-7277269179)

[![@vshymanskyy](https://avatars.githubusercontent.com/u/1506708?s=40&u=03ac130af6ece3d92329b1a690ae65343128fdf8&v=4)](/vshymanskyy)
[vshymanskyy](/vshymanskyy)
closed this as [completed](/wasm3/wasm3/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Aug 29, 2022](#event-7277274376)

[![@vshymanskyy](https://avatars.githubusercontent.com/u/1506708?s=80&u=03ac130af6ece3d92329b1a690ae65343128fdf8&v=4)](/vshymanskyy)

Copy link

Member

### **[vshymanskyy](/vshymanskyy)** commented [Aug 29, 2022](#issuecomment-1230101409)

| [@ioo0s](https://github.com/ioo0s) sorry I will be closing any fuzzer reports, as this is covered by [#344](https://github.com/wasm3/wasm3/issues/344) |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fwasm3%2Fwasm3%2Fissues%2F379)

Assignees

No one assigned

Labels

[wasm-validation](/wasm3/wasm3/labels/wasm-validation)

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@vshymanskyy](https://avatars.githubusercontent.com/u/1506708?s=52&v=4)](/vshymanskyy) [![@ioo0s](https://avatars.githubusercontent.com/u/82093214?s=52&v=4)](/ioo0s)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

