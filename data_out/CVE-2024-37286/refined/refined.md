- **Root cause of vulnerability:** The APM server logs the Elasticsearch response line on error, and this response line includes the document body in case of `unavailable_shards_exception` during a bulk index request.
- **Weaknesses/vulnerabilities present:**  Sensitive data, specifically the document body from failed bulk index requests, is inadvertently included in the APM server logs.
- **Impact of exploitation:** Sensitive information contained within the document body is leaked into the APM server logs, potentially exposing it to unauthorized access.
- **Attack vectors:**  The vulnerability is not directly exploited but rather occurs due to the logging mechanism of the APM server. An attacker with access to the logs could potentially extract sensitive information.
- **Required attacker capabilities/position:** An attacker needs access to the APM server logs to view the leaked sensitive information. This requires local access on the machine where logs are stored, or access to a system where those logs are forwarded to.

The provided content gives more details than the standard CVE description by specifying the exact error message (`unavailable_shards_exception`) that triggers the logging of the document body and provides the string to search in the logs to detect this issue.