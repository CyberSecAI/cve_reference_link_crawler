

search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#154201

## Microsoft Internet Explorer CButton use-after-free vulnerability

#### Vulnerability Note VU#154201

Original Release Date: 2012-12-29 | Last Revised: 2013-01-14

---

### Overview

Microsoft Internet Explorer contains a use-after-free vulnerability in the CButton object, which can allow a remote, unauthenticated attacker to execute arbitrary code on a vulnerable system.

### Description

| Microsoft Internet Explorer contains a use-after-free vulnerability in the mshtml CButton object. Specially-crafted JavaScript can cause Internet Explorer to free the CButton object without removing a pointer, resulting in a state where Internet Explorer may attempt to call an invalid memory address. This memory address may be under the control of the attacker.  This vulnerability is currently being exploited in the wild, using Adobe Flash to achieve a heap spray and Java to provide Return Oriented Programming (ROP) gadgets. Other proof-of-concept exploits are publicly available that do not use heap spraying. |
| --- |

### Impact

| By convincing a user to view a specially crafted HTML document (e.g., a web page or an HTML email message or attachment), Microsoft Office document, an attacker may be able to execute arbitrary code. |
| --- |

### Solution

| **Apply an Update**Microsoft has released [MS13-008](https://technet.microsoft.com/en-us/security/bulletin/ms13-008) to address this vulnerability. Users should run Windows Update to receive the patch. If a user is unable to update, please consider the following workarounds: |
| --- |

| **Use the Microsoft Enhanced Mitigation Experience Toolkit**The [Microsoft Enhanced Mitigation Experience Toolkit](http://support.microsoft.com/kb/2458544) (EMET) can be used to help prevent exploitation of this vulnerability. CERT/CC has created a [video tutorial for setting up EMET 3.0](http://www.youtube.com/watch?v=28_LUs_g0u4) on Windows 7. Note that platforms that do not support ASLR, such as Windows XP and Windows Server 2003, will not receive the same level of protection that modern Windows platforms will.**Apply the Microsoft Fix It**Microsoft has provided a "Fix it" patch that causes Internet Explorer to safely crash if this vulnerability is attempted to be exploited, rather than resulting in code execution. Please see the [Microsoft SRD blog entry](http://blogs.technet.com/b/srd/archive/2012/12/31/microsoft-quot-fix-it-quot-available-for-internet-explorer-6-7-and-8.aspx) for more details. Note that Windows must be fully-patched for the Fix it to be effective. There is also a report that the Fix it [is insufficient](http://blog.exodusintel.com/2013/01/04/bypassing-microsofts-internet-explorer-0day-fix-it-patch-for-cve-2012-4792/) to completely address the vulnerability.**Disable the Flash ActiveX control in Internet Explorer**While it does not address the underlying vulnerability in Internet Explorer, disabling Flash may break some exploits. The Flash ActiveX control can be disabled in Internet Explorer by setting the kill bit for the following CLSID:   {D27CDB6E-AE6D-11cf-96B8-444553540000} More information about how to set the kill bit is available in [Microsoft Support Document 240797](http://support.microsoft.com/kb/240797). Alternatively, the following text can be saved as a .REG file and imported to set the kill bit for this control:  Windows Registry Editor Version 5.00[HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{D27CDB6E-AE6D-11cf-96B8-444553540000}]"Compatibility Flags"=dword:00000400[HKEY\_LOCAL\_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\ActiveX Compatibility\{D27CDB6E-AE6D-11cf-96B8-444553540000}]"Compatibility Flags"=dword:00000400 **Disable Java in Internet Explorer**While it does not address the underlying vulnerability in Internet Explorer, disabling Java may break some exploits. Starting with Java 7 Update 10, it is possible to disable Java content in web browsers through the Java control panel applet. Please see the [Java documentation](http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/client-security.html#disable) for more details. |
| --- |

### Vendor Information

**Javascript is disabled. Click [here](/vuls/vendor/VU%23154201/) to view vendors.**

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 10 | AV:N/AC:L/Au:N/C:C/I:C/A:C |
| Temporal | 9 | E:H/RL:W/RC:UR |
| Environmental | 9 | CDP:ND/TD:H/CR:ND/IR:ND/AR:ND |

### References

* <https://technet.microsoft.com/en-us/security/bulletin/ms13-008>
* <http://technet.microsoft.com/en-us/security/advisory/2794220>
* <http://blogs.technet.com/b/srd/archive/2012/12/31/microsoft-quot-fix-it-quot-available-for-internet-explorer-6-7-and-8.aspx>
* <http://blogs.technet.com/b/srd/archive/2012/12/29/new-vulnerability-affecting-internet-explorer-8-users.aspx>
* <http://blog.exodusintel.com/2013/01/04/bypassing-microsofts-internet-explorer-0day-fix-it-patch-for-cve-2012-4792/>
* <http://blog.vulnhunt.com/index.php/2012/12/29/new-ie-0day-coming-mshtmlcdwnbindinfo-object-use-after-free-vulnerability/>
* <http://eromang.zataz.com/2012/12/29/attack-and-ie-0day-informations-used-against-council-on-foreign-relations/>
* <http://blog.fireeye.com/research/2012/12/council-foreign-relations-water-hole-attack-details.html>
* <http://labs.alienvault.com/labs/index.php/2012/just-another-water-hole-campaign-using-an-internet-explorer-0day>
* <http://support.microsoft.com/kb/2458544>
* <http://www.youtube.com/watch?v=28_LUs_g0u4>
* <http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/client-security.html#disable>
### Acknowledgements

This vulnerability was described by Eric Romang and FireEye.

This document was written by Will Dormann.

### Other Information

| **CVE IDs:** | [CVE-2012-4792](http://web.nvd.nist.gov/vuln/detail/CVE-2012-4792) |
| --- | --- |
| **Date Public:** | 2012-12-28 |
| **Date First Published:** | 2012-12-29 |
| **Date Last Updated:** | 2013-01-14 21:59 UTC |
| **Document Revision:** | 44 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800

