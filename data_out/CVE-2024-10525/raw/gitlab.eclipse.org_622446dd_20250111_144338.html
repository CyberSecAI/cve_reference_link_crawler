





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header with-system-footer" lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Heap Buffer Overflow in my_subscribe_callback Function in Eclipse Mosquitto v2.0.18-4-g15292b20 (#190) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab</title>
<script>
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.eclipse.org/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="";gon.gitlab_url="https://gitlab.eclipse.org";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="9d81c27eee7";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-d746ae2450a3e9c626d338d77a101b84ff33a47c0c281b676d75c4a6ed2948a4.css";gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=false;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=false;gon.uf_error_prefix="UF";gon.pat_prefix="";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"commentTooltips":false,"glqlIntegration":false,"issueAutocompleteBackendFiltering":false,"workItems":true,"workItemsBeta":false,"workItemsAlpha":false,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"workItemEpics":false};gon.roadmap_epics_limit=1000;gon.licensed_features={"escalationPolicies":true};gon.abilities={"summarizeComments":false};
//]]>
</script>


<script>
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/security/vulnerability-reports/-/issues/190/discussions.json?per_page=20":{},"/security/vulnerability-reports/-/issues/190.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"gQxBZvEc6Qa87xYgFhkwcvEcY6Mt6qNFIv8gwXobncWZZIDKGPJ-N4SE2HFt56xf8yV665qxP-bacw5zSTAa0Q","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.eclipse.org/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-8276cea79ef526c83539dd54f72382f170a49fbe45332e2f2c132a38880e38ff.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-5915182f24062982294a7689b2e490af18508f930186330e5eb94325919258cc.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-6598dbf61fe32a8ddb1b06150f2301451ad41554975581e771efc5f890d0443f.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-013502814f58518ea802ad05cf9775f47c9933e442b9e59dd4ac2f42fd0b71cf.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-985467dc606e2acde1735b642c5ce237ef7e965ad1c35cf33a4c9beb2ecb05b8.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-d9603c98e9259c19bbb47784abf3b63b5cb7ce8d7463608443b907773ab7197d.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-6e9d4ced3f78abb4b0b5d21e2c5069b8c88f8e045babafc20e3c7f57893d3ee1.css" />
<link rel="stylesheet" href="/assets/tailwind-05270112d01c5ef673f3a3a3f57249974bbc904a2fa6b327a35f12eece635a2b.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-9fc2e7ab1cefbb5a525a1e1b06c04b3141c2179a6d572b1d390cf9db8def8104.css" />


<link rel="preload" href="/assets/application_utilities-6e9d4ced3f78abb4b0b5d21e2c5069b8c88f8e045babafc20e3c7f57893d3ee1.css" as="style" type="text/css">
<link rel="preload" href="/assets/application-8276cea79ef526c83539dd54f72382f170a49fbe45332e2f2c132a38880e38ff.css" as="style" type="text/css">
<link rel="preload" href="/assets/highlight/themes/white-9fc2e7ab1cefbb5a525a1e1b06c04b3141c2179a6d572b1d390cf9db8def8104.css" as="style" type="text/css">




<script src="/assets/webpack/runtime.619e248a.bundle.js" defer="defer"></script>
<script src="/assets/webpack/main.bda67b2a.chunk.js" defer="defer"></script>
<script src="/assets/webpack/10.cfcff625.chunk.js" defer="defer"></script>
<script src="/assets/webpack/12.665b0ed5.chunk.js" defer="defer"></script>
<script src="/assets/webpack/13.f9ad3ff9.chunk.js" defer="defer"></script>
<script src="/assets/webpack/14.9cea632a.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.security.policies.edit-pages.groups.security.policies.new-pages.projects.blob.s-823210c2.3552e27d.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-43c0ecf9.cd411fdc.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.ce957725.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.c75bd97e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/super_sidebar.5bd734bb.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-e1be1070.7e2fa462.chunk.js" defer="defer"></script>
<script src="/assets/webpack/pages.projects.issues.show.684d6478.chunk.js" defer="defer"></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Heap Buffer Overflow in my_subscribe_callback Function in Eclipse Mosquitto v2.0.18-4-g15292b20 (#190) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab" property="og:title">
<meta content=" Basic information Project name: Eclipse Mosquitto Project id: mosquitto.org Request type: publication Versions affected: [v2.0.18-4-g15292b20] " property="og:description">
<meta content="https://gitlab.eclipse.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/190" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Heap Buffer Overflow in my_subscribe_callback Function in Eclipse Mosquitto v2.0.18-4-g15292b20 (#190) · Issues · Eclipse Projects Security / vulnerability-reports · GitLab" property="twitter:title">
<meta content=" Basic information Project name: Eclipse Mosquitto Project id: mosquitto.org Request type: publication Versions affected: [v2.0.18-4-g15292b20] " property="twitter:description">
<meta content="https://gitlab.eclipse.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="Qingpeng Du"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Roger Light">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="q99ZIeUopFPITWzi0sTo41VuTA55W7ZirV85SxBI-ACzt5iNDMYzYvAmorOpOnTOV1dVRs4AKsFV0xf5I2N_FA" />
<meta name="csp-nonce" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/uploads/-/system/appearance/favicon/1/favicon.ico" id="favicon" data-original-href="/uploads/-/system/appearance/favicon/1/favicon.ico" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content=" Basic information Project name: Eclipse Mosquitto Project id: mosquitto.org Request type: publication Versions affected: [v2.0.18-4-g15292b20] " name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="security" data-group-full-path="security" data-namespace-id="3675" data-page="projects:issues:show" data-page-type-id="190" data-project="vulnerability-reports" data-project-full-path="security/vulnerability-reports" data-project-id="3804">
<script>
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/security/vulnerability-reports/-/autocomplete_sources/epics","iterations":"/security/vulnerability-reports/-/autocomplete_sources/iterations","vulnerabilities":"/security/vulnerability-reports/-/autocomplete_sources/vulnerabilities","members":"/security/vulnerability-reports/-/autocomplete_sources/members?type=Issue\u0026type_id=190","issues":"/security/vulnerability-reports/-/autocomplete_sources/issues","mergeRequests":"/security/vulnerability-reports/-/autocomplete_sources/merge_requests","labels":"/security/vulnerability-reports/-/autocomplete_sources/labels?type=Issue\u0026type_id=190","milestones":"/security/vulnerability-reports/-/autocomplete_sources/milestones","commands":"/security/vulnerability-reports/-/autocomplete_sources/commands?type=Issue\u0026type_id=190","snippets":"/security/vulnerability-reports/-/autocomplete_sources/snippets","contacts":"/security/vulnerability-reports/-/autocomplete_sources/contacts?type=Issue\u0026type_id=190","wikis":null};


//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" href="/"><img class="brand-header-logo lazy" alt="" data-src="/uploads/-/system/appearance/header_logo/1/ef_logis.png" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" />
</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/security/vulnerability-reports/-/files/main?format=json&quot;,&quot;project_blob_url&quot;:&quot;/security/vulnerability-reports/-/blob/main&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="false" data-root-path="/" data-sidebar="{&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;vulnerability-reports&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:3804,&quot;link&quot;:&quot;/security/vulnerability-reports&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/activity&quot;,&quot;is_active&quot;:false,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/activity&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/project_members&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/labels&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;is_active&quot;:true,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;pill_count&quot;:&quot;0&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/boards&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/milestones&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/cadences&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar&quot;:null,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/ml/models&quot;,&quot;is_active&quot;:false,&quot;pill_count&quot;:null,&quot;items&quot;:[{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;icon&quot;:null,&quot;avatar&quot;:null,&quot;entity_id&quot;:null,&quot;link&quot;:&quot;/security/vulnerability-reports/-/ml/models&quot;,&quot;pill_count&quot;:null,&quot;link_classes&quot;:null,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://wiki.eclipse.org/Gitlab&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:false,&quot;show_version_check&quot;:false,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:3675,&quot;name&quot;:&quot;Eclipse Projects Security&quot;,&quot;full_name&quot;:&quot;Eclipse Projects Security&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/security/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/security/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:3804,&quot;name&quot;:&quot;vulnerability-reports&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/security/vulnerability-reports/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/security/vulnerability-reports/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">

<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">




























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Eclipse Projects Security","item":"https://gitlab.eclipse.org/security"},{"@type":"ListItem","position":2,"name":"vulnerability-reports","item":"https://gitlab.eclipse.org/security/vulnerability-reports"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.eclipse.org/security/vulnerability-reports/-/issues"},{"@type":"ListItem","position":4,"name":"#190","item":"https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/190"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;Eclipse Projects Security&quot;,&quot;href&quot;:&quot;/security&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;vulnerability-reports&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#190&quot;,&quot;href&quot;:&quot;/security/vulnerability-reports/-/issues/190&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/security/vulnerability-reports/-/issues/190&quot;,&quot;new_issue_path&quot;:&quot;/security/vulnerability-reports/-/issues/new?add_related_issue=190&quot;,&quot;project_path&quot;:&quot;security/vulnerability-reports&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:18086,&quot;reported_from_url&quot;:&quot;https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/190&quot;,&quot;submit_as_spam_path&quot;:&quot;/security/vulnerability-reports/-/issues/190/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/security/vulnerability-reports/-/issues/190&quot;,&quot;updateEndpoint&quot;:&quot;/security/vulnerability-reports/-/issues/190.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#190&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/security/vulnerability-reports/-/preview_markdown?target_id=190\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:2,&quot;issuableTemplateNamesPath&quot;:&quot;/security/vulnerability-reports/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Heap Buffer Overflow in my_subscribe_callback Function in Eclipse Mosquitto v2.0.18-4-g15292b20&quot;,&quot;initialTitleText&quot;:&quot;Heap Buffer Overflow in my_subscribe_callback Function in Eclipse Mosquitto v2.0.18-4-g15292b20&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003ch2 data-sourcepos=\&quot;1:1-1:20\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-basic-information\&quot; class=\&quot;anchor\&quot; href=\&quot;#basic-information\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eBasic information\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:65\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eProject name:\u003c/strong\u003e Eclipse Mosquitto \u003cstrong\u003eProject id:\u003c/strong\u003e mosquitto.org\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:29\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eRequest type:\u003c/strong\u003e publication\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;7:1-7:44\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eVersions affected:\u003c/strong\u003e [v2.0.18-4-g15292b20]\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-9:32\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eCommon Weakness Enumeration:\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;11:1-12:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;11:1-12:0\&quot;\u003e\u003ca href=\&quot;https://cwe.mitre.org/data/definitions/122.html\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eCWE-122: Heap-based Buffer Overflow\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-13:42\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eCommon Vulnerability Scoring System:\u003c/strong\u003e -\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;15:1-15:12\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eSummary:\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;17:1-17:354\&quot; dir=\&quot;auto\&quot;\u003eIn Eclipse Mosquitto version v2.0.18-4-g15292b20, a heap-buffer-overflow vulnerability was discovered that can be triggered when the broker processes a specially crafted packet. This vulnerability exists due to a boundary error within the \u003ccode\u003emy_subscribe_callback\u003c/code\u003e function in the \u003ccode\u003esub_client.c\u003c/code\u003e file, which can lead to code execution or denial of service.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;20:1-20:10\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eLinks:\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;22:1-22:329\&quot; dir=\&quot;auto\&quot;\u003eThe project at \&quot;\u003ca href=\&quot;https://github.com/eclipse/mosquitto\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://github.com/eclipse/mosquitto\u003c/a\u003e\&quot; advises against posting discovered bugs directly in the issues section and instead requests the submission of details via the form at \&quot;\u003ca href=\&quot;https://gitlab.eclipse.org/security\&quot;\u003ehttps://gitlab.eclipse.org/security\u003c/a\u003e\&quot;. I apologize for any inconvenience, and so I have documented the method for reproducing the issue here.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;24:1-24:16\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eReproduce：\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;26:1-45:25\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;26:1-35:6\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;26:4-26:123\&quot;\u003eConfigure the building environment with ASan and UBSan by setting the environment variables for the compiler and linker:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;28:4-35:6\&quot; data-canonical-lang=\&quot;bash\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nb\&quot;\u003eexport \u003c/span\u003e\u003cspan class=\&quot;nv\&quot;\u003eCC\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003eclang \u003cspan class=\&quot;nv\&quot;\u003eCXX\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003eclang++\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nb\&quot;\u003eexport \u003c/span\u003e\u003cspan class=\&quot;nv\&quot;\u003eCFLAGS\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e\&quot;-g -fsanitize=address,undefined -fno-omit-frame-pointer\&quot;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nb\&quot;\u003eexport \u003c/span\u003e\u003cspan class=\&quot;nv\&quot;\u003eCXXFLAGS\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e\&quot;-g -fsanitize=address,undefined -fno-omit-frame-pointer\&quot;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nb\&quot;\u003eexport \u003c/span\u003e\u003cspan class=\&quot;nv\&quot;\u003eLDFLAGS\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e\&quot;-fsanitize=address,undefined\&quot;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003emake clean\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003emake \u003cspan class=\&quot;nt\&quot;\u003e-j\u003c/span\u003e 8\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;36:1-40:6\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;36:4-36:66\&quot;\u003eStart the Mosquitto broker server in verbose mode on port 2883:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;38:4-40:6\&quot; data-canonical-lang=\&quot;bash\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003emosquitto/src/mosquitto \u003cspan class=\&quot;nt\&quot;\u003e-v\u003c/span\u003e \u003cspan class=\&quot;nt\&quot;\u003e-p\u003c/span\u003e 2883\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;41:1-45:25\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;41:4-41:113\&quot;\u003eWrite the data transmission from the proxy to the client using a series of hexstream found in \u003ccode\u003ehexstream.txt\u003c/code\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;43:4-45:25\&quot;\u003e\u003ca href=\&quot;/-/project/3804/uploads/abdd422fd21616901eff5f58b225ca65/hexstream.txt\&quot; data-canonical-src=\&quot;/uploads/abdd422fd21616901eff5f58b225ca65/hexstream.txt\&quot; data-link=\&quot;true\&quot; class=\&quot;gfm\&quot;\u003ehexstream.txt\u003c/a\u003e\u0026#x000A;\u003cstrong\u003eCrash Report：\u003c/strong\u003e\u0026#x000A;Here is the client log：\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;46:1-58:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRun topic: test/tp\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRun sub(Qos0) in topic [test/tp]\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRun sub(Qos1) in topic [test/tp]\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRun sub(Qos2) in topic [test/tp]\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRun sub(Qos2) in topic [test/#]\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRun Qos1 sub in topic [test/chat] with qos2 will\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eHit CTRL+C\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003etest/tp qos2\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003etest/tp qos2\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003etest/tp qos2\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003etest/tp qos2\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;59:1-59:24\&quot; dir=\&quot;auto\&quot;\u003eHere is the ASan reprot:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;60:1-117:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eError: Unknown error.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eError: The connection was lost.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e=================================================================\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eError: A network protocol error occurred when communicating with the broker.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e==1400134==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000210 at pc 0x0000004cb0c8 bp 0x7ffeee2abd60 sp 0x7ffeee2abd58\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eREAD of size 4 at 0x602000000210 thread T0\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #0 0x4cb0c7 in my_subscribe_callback mosquitto/client/sub_client.c:150:27\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #1 0x7fb53b7b9b3f in handle__suback mosquitto/lib/handle_suback.c:102:3\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #2 0x7fb53b80512f in handle__packet mosquitto/lib/read_handle.c:59:11\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #3 0x7fb53b7f274a in packet__read mosquitto/lib/packet_mosq.c:566:7\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #4 0x7fb53b7c21f1 in mosquitto_loop_read mosquitto/lib/loop.c:380:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #5 0x7fb53b7c0966 in mosquitto_loop mosquitto/lib/loop.c:149:10\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #6 0x7fb53b7c2785 in mosquitto_loop_forever mosquitto/lib/loop.c:257:9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #7 0x4ca20c in main mosquitto/client/sub_client.c:404:7\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #8 0x7fb53b3c60b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #9 0x41d76d in _start (mosquitto/client/mosquitto_sub+0x41d76d)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0x602000000211 is located 0 bytes to the right of 1-byte region [0x602000000210,0x602000000211)\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eallocated by thread T0 here:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e    #0 0x4989aa in malloc /home/brian/src/llvm_releases/llvm-project/llvm/utils/release/final/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSUMMARY: AddressSanitizer: heap-buffer-overflow mosquitto/client/sub_client.c:150:27 in my_subscribe_callback\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eShadow bytes around the buggy address:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8000: fa fa 00 07 fa fa 00 fa fa fa 00 02 fa fa 00 fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8010: fa fa 00 02 fa fa 00 02 fa fa 00 fa fa fa 00 01\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8020: fa fa 00 02 fa fa 00 00 fa fa fd fd fa fa fd fd\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8030: fa fa 00 00 fa fa fd fa fa fa fd fd fa fa 02 fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e=\u0026gt;0x0c047fff8040: fa fa[01]fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  0x0c047fff8090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eShadow byte legend (one shadow byte represents 8 application bytes):\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC36\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Addressable:           00\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC37\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Partially addressable: 01 02 03 04 05 06 07 \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC38\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Heap left redzone:       fa\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC39\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Freed heap region:       fd\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC40\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack left redzone:      f1\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC41\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack mid redzone:       f2\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC42\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack right redzone:     f3\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC43\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack after return:      f5\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC44\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Stack use after scope:   f8\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC45\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Global redzone:          f9\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC46\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Global init order:       f6\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC47\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Poisoned by user:        f7\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC48\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Container overflow:      fc\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC49\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Array cookie:            ac\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC50\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Intra object redzone:    bb\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC51\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  ASan internal:           fe\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC52\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Left alloca redzone:     ca\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC53\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Right alloca redzone:    cb\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC54\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e  Shadow gap:              cc\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC55\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e==1400134==ABORTING\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC56\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eError: The connection was lost.\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;119:1-119:11\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-tracking\&quot; class=\&quot;anchor\&quot; href=\&quot;#tracking\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eTracking\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;121:1-121:52\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eThis section will completed by the project team\u003c/strong\u003e.\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;123:1-126:0\&quot; class=\&quot;task-list\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;123:1-123:27\&quot; class=\&quot;task-list-item\&quot;\u003e\u0026#x000A;\u003ctask-button\u003e\u003c/task-button\u003e\u003cinput type=\&quot;checkbox\&quot; class=\&quot;task-list-item-checkbox\&quot; disabled\u003e Reserve an entry only\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;124:1-124:101\&quot; class=\&quot;task-list-item\&quot;\u003e\u0026#x000A;\u003ctask-button\u003e\u003c/task-button\u003e\u003cinput type=\&quot;checkbox\&quot; class=\&quot;task-list-item-checkbox\&quot; disabled\u003e We&#39;re ready for this issue to be reported to the central authority (i.e., make this public now)\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;125:1-126:0\&quot; class=\&quot;task-list-item\&quot;\u003e\u0026#x000A;\u003ctask-button\u003e\u003c/task-button\u003e\u003cinput type=\&quot;checkbox\&quot; class=\&quot;task-list-item-checkbox\&quot; disabled\u003e (when applicable) The GitHub Security Advisory is ready to be published now\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;127:1-127:142\&quot; dir=\&quot;auto\&quot;\u003eNote that for those projects that host their repositories on GitHub, the use of GitHub Security Advisories is recommended but is not required.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;129:1-129:46\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eThis section will be completed by the EMO\u003c/strong\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;131:1-131:14\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong\u003eCVE:\u003c/strong\u003e {cve}\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;133:1-137:27\&quot; class=\&quot;task-list\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;133:1-133:42\&quot; class=\&quot;task-list-item\&quot;\u003e\u0026#x000A;\u003ctask-button\u003e\u003c/task-button\u003e\u003cinput type=\&quot;checkbox\&quot; class=\&quot;task-list-item-checkbox\&quot; disabled\u003e All required information is provided\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;134:1-134:18\&quot; class=\&quot;task-list-item\&quot;\u003e\u0026#x000A;\u003ctask-button\u003e\u003c/task-button\u003e\u003cinput type=\&quot;checkbox\&quot; class=\&quot;task-list-item-checkbox\&quot; disabled\u003e CVE Assigned\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;135:1-135:21\&quot; class=\&quot;task-list-item\&quot;\u003e\u0026#x000A;\u003ctask-button\u003e\u003c/task-button\u003e\u003cinput type=\&quot;checkbox\&quot; class=\&quot;task-list-item-checkbox\&quot; disabled\u003e Pushed to Mitre\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;136:1-137:27\&quot; class=\&quot;task-list-item\&quot;\u003e\u0026#x000A;\u003ctask-button\u003e\u003c/task-button\u003e\u003cinput type=\&quot;checkbox\&quot; class=\&quot;task-list-item-checkbox\&quot; disabled\u003e Accepted by Mitre\u0026#x000A;/assign \u003ca href=\&quot;/mbarbero\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;72\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Mikaël Barbero\&quot;\u003e@mbarbero\u003c/a\u003e \u003ca href=\&quot;/mrybczyn\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;624\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Marta Rybczynska\&quot;\u003e@mrybczyn\u003c/a\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;## Basic information\n\n**Project name:** Eclipse Mosquitto **Project id:** mosquitto.org\n\n**Request type:** publication\n\n**Versions affected:** [v2.0.18-4-g15292b20]\n\n**Common Weakness Enumeration:**\n\n- [CWE-122: Heap-based Buffer Overflow](https://cwe.mitre.org/data/definitions/122.html)\n\n**Common Vulnerability Scoring System:** -\n\n**Summary:**\n\nIn Eclipse Mosquitto version v2.0.18-4-g15292b20, a heap-buffer-overflow vulnerability was discovered that can be triggered when the broker processes a specially crafted packet. This vulnerability exists due to a boundary error within the `my_subscribe_callback` function in the `sub_client.c` file, which can lead to code execution or denial of service.\n\n\n**Links:**\n\nThe project at \&quot;https://github.com/eclipse/mosquitto\&quot; advises against posting discovered bugs directly in the issues section and instead requests the submission of details via the form at \&quot;https://gitlab.eclipse.org/security\&quot;. I apologize for any inconvenience, and so I have documented the method for reproducing the issue here.\n\n**Reproduce：**\n\n1. Configure the building environment with ASan and UBSan by setting the environment variables for the compiler and linker:\n\n   ```bash\n   export CC=clang CXX=clang++\n   export CFLAGS=\&quot;-g -fsanitize=address,undefined -fno-omit-frame-pointer\&quot;\n   export CXXFLAGS=\&quot;-g -fsanitize=address,undefined -fno-omit-frame-pointer\&quot;\n   export LDFLAGS=\&quot;-fsanitize=address,undefined\&quot;\n   make clean\n   make -j 8\n   ```\n2. Start the Mosquitto broker server in verbose mode on port 2883:\n\n   ```bash\n   mosquitto/src/mosquitto -v -p 2883\n   ```\n3. Write the data transmission from the proxy to the client using a series of hexstream found in `hexstream.txt`:\n\n   [hexstream.txt](/uploads/abdd422fd21616901eff5f58b225ca65/hexstream.txt)\n**Crash Report：**\nHere is the client log：\n```\nRun topic: test/tp\nRun sub(Qos0) in topic [test/tp]\nRun sub(Qos1) in topic [test/tp]\nRun sub(Qos2) in topic [test/tp]\nRun sub(Qos2) in topic [test/#]\nRun Qos1 sub in topic [test/chat] with qos2 will\nHit CTRL+C\ntest/tp qos2\ntest/tp qos2\ntest/tp qos2\ntest/tp qos2\n```\nHere is the ASan reprot:\n```\nError: Unknown error.\nError: The connection was lost.\n=================================================================\nError: A network protocol error occurred when communicating with the broker.\n==1400134==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000210 at pc 0x0000004cb0c8 bp 0x7ffeee2abd60 sp 0x7ffeee2abd58\nREAD of size 4 at 0x602000000210 thread T0\n    #0 0x4cb0c7 in my_subscribe_callback mosquitto/client/sub_client.c:150:27\n    #1 0x7fb53b7b9b3f in handle__suback mosquitto/lib/handle_suback.c:102:3\n    #2 0x7fb53b80512f in handle__packet mosquitto/lib/read_handle.c:59:11\n    #3 0x7fb53b7f274a in packet__read mosquitto/lib/packet_mosq.c:566:7\n    #4 0x7fb53b7c21f1 in mosquitto_loop_read mosquitto/lib/loop.c:380:9\n    #5 0x7fb53b7c0966 in mosquitto_loop mosquitto/lib/loop.c:149:10\n    #6 0x7fb53b7c2785 in mosquitto_loop_forever mosquitto/lib/loop.c:257:9\n    #7 0x4ca20c in main mosquitto/client/sub_client.c:404:7\n    #8 0x7fb53b3c60b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16\n    #9 0x41d76d in _start (mosquitto/client/mosquitto_sub+0x41d76d)\n\n0x602000000211 is located 0 bytes to the right of 1-byte region [0x602000000210,0x602000000211)\nallocated by thread T0 here:\n    #0 0x4989aa in malloc /home/brian/src/llvm_releases/llvm-project/llvm/utils/release/final/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow mosquitto/client/sub_client.c:150:27 in my_subscribe_callback\nShadow bytes around the buggy address:\n  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c047fff8000: fa fa 00 07 fa fa 00 fa fa fa 00 02 fa fa 00 fa\n  0x0c047fff8010: fa fa 00 02 fa fa 00 02 fa fa 00 fa fa fa 00 01\n  0x0c047fff8020: fa fa 00 02 fa fa 00 00 fa fa fd fd fa fa fd fd\n  0x0c047fff8030: fa fa 00 00 fa fa fd fa fa fa fd fd fa fa 02 fa\n=\u003e0x0c047fff8040: fa fa[01]fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n  Shadow gap:              cc\n==1400134==ABORTING\nError: The connection was lost.\n```\n\n## Tracking\n\n**This section will completed by the project team**.\n\n- [ ] Reserve an entry only\n- [ ] We&#39;re ready for this issue to be reported to the central authority (i.e., make this public now)\n- [ ] (when applicable) The GitHub Security Advisory is ready to be published now\n\nNote that for those projects that host their repositories on GitHub, the use of GitHub Security Advisories is recommended but is not required.\n\n**This section will be completed by the EMO**.\n\n**CVE:** {cve}\n\n- [ ] All required information is provided\n- [ ] CVE Assigned\n- [ ] Pushed to Mitre\n- [ ] Accepted by Mitre\n/assign @mbarbero @mrybczyn&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:7,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;security/vulnerability-reports&quot;,&quot;iid&quot;:190,&quot;issuableId&quot;:624921,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:18086,&quot;authorName&quot;:&quot;Qingpeng Du&quot;,&quot;authorUsername&quot;:&quot;duqingpeng10515&quot;,&quot;authorWebUrl&quot;:&quot;/duqingpeng10515&quot;,&quot;createdAt&quot;:&quot;2024-03-26T13:57:49+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:3804,&quot;projectPath&quot;:&quot;vulnerability-reports&quot;,&quot;projectNamespace&quot;:&quot;security&quot;,&quot;updatedAt&quot;:&quot;2024-03-26T15:45:10+00:00&quot;,&quot;updatedBy&quot;:{&quot;name&quot;:&quot;Qingpeng Du&quot;,&quot;path&quot;:&quot;/duqingpeng10515&quot;},&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Heap Buffer Overflow in my_subscribe_callback Function in Eclipse Mosquitto v2.0.18-4-g15292b20</h1>
</div>
<div class="description">
<div class="md"><h2 data-sourcepos="1:1-1:20" dir="auto">&#x000A;<a id="user-content-basic-information" class="anchor" href="#basic-information" aria-hidden="true"></a>Basic information</h2>&#x000A;<p data-sourcepos="3:1-3:65" dir="auto"><strong>Project name:</strong> Eclipse Mosquitto <strong>Project id:</strong> mosquitto.org</p>&#x000A;<p data-sourcepos="5:1-5:29" dir="auto"><strong>Request type:</strong> publication</p>&#x000A;<p data-sourcepos="7:1-7:44" dir="auto"><strong>Versions affected:</strong> [v2.0.18-4-g15292b20]</p>&#x000A;<p data-sourcepos="9:1-9:32" dir="auto"><strong>Common Weakness Enumeration:</strong></p>&#x000A;<ul data-sourcepos="11:1-12:0" dir="auto">&#x000A;<li data-sourcepos="11:1-12:0"><a href="https://cwe.mitre.org/data/definitions/122.html" rel="nofollow noreferrer noopener" target="_blank">CWE-122: Heap-based Buffer Overflow</a></li>&#x000A;</ul>&#x000A;<p data-sourcepos="13:1-13:42" dir="auto"><strong>Common Vulnerability Scoring System:</strong> -</p>&#x000A;<p data-sourcepos="15:1-15:12" dir="auto"><strong>Summary:</strong></p>&#x000A;<p data-sourcepos="17:1-17:354" dir="auto">In Eclipse Mosquitto version v2.0.18-4-g15292b20, a heap-buffer-overflow vulnerability was discovered that can be triggered when the broker processes a specially crafted packet. This vulnerability exists due to a boundary error within the <code>my_subscribe_callback</code> function in the <code>sub_client.c</code> file, which can lead to code execution or denial of service.</p>&#x000A;<p data-sourcepos="20:1-20:10" dir="auto"><strong>Links:</strong></p>&#x000A;<p data-sourcepos="22:1-22:329" dir="auto">The project at "<a href="https://github.com/eclipse/mosquitto" rel="nofollow noreferrer noopener" target="_blank">https://github.com/eclipse/mosquitto</a>" advises against posting discovered bugs directly in the issues section and instead requests the submission of details via the form at "<a href="https://gitlab.eclipse.org/security">https://gitlab.eclipse.org/security</a>". I apologize for any inconvenience, and so I have documented the method for reproducing the issue here.</p>&#x000A;<p data-sourcepos="24:1-24:16" dir="auto"><strong>Reproduce：</strong></p>&#x000A;<ol data-sourcepos="26:1-45:25" dir="auto">&#x000A;<li data-sourcepos="26:1-35:6">&#x000A;<p data-sourcepos="26:4-26:123">Configure the building environment with ASan and UBSan by setting the environment variables for the compiler and linker:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="28:4-35:6" data-canonical-lang="bash" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell"><span class="nb">export </span><span class="nv">CC</span><span class="o">=</span>clang <span class="nv">CXX</span><span class="o">=</span>clang++</span>&#x000A;<span id="LC2" class="line" lang="shell"><span class="nb">export </span><span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">"-g -fsanitize=address,undefined -fno-omit-frame-pointer"</span></span>&#x000A;<span id="LC3" class="line" lang="shell"><span class="nb">export </span><span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">"-g -fsanitize=address,undefined -fno-omit-frame-pointer"</span></span>&#x000A;<span id="LC4" class="line" lang="shell"><span class="nb">export </span><span class="nv">LDFLAGS</span><span class="o">=</span><span class="s2">"-fsanitize=address,undefined"</span></span>&#x000A;<span id="LC5" class="line" lang="shell">make clean</span>&#x000A;<span id="LC6" class="line" lang="shell">make <span class="nt">-j</span> 8</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;</li>&#x000A;<li data-sourcepos="36:1-40:6">&#x000A;<p data-sourcepos="36:4-36:66">Start the Mosquitto broker server in verbose mode on port 2883:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="38:4-40:6" data-canonical-lang="bash" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell">mosquitto/src/mosquitto <span class="nt">-v</span> <span class="nt">-p</span> 2883</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;</li>&#x000A;<li data-sourcepos="41:1-45:25">&#x000A;<p data-sourcepos="41:4-41:113">Write the data transmission from the proxy to the client using a series of hexstream found in <code>hexstream.txt</code>:</p>&#x000A;<p data-sourcepos="43:4-45:25"><a href="/-/project/3804/uploads/abdd422fd21616901eff5f58b225ca65/hexstream.txt" data-canonical-src="/uploads/abdd422fd21616901eff5f58b225ca65/hexstream.txt" data-link="true" class="gfm">hexstream.txt</a>&#x000A;<strong>Crash Report：</strong>&#x000A;Here is the client log：</p>&#x000A;</li>&#x000A;</ol>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="46:1-58:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">Run topic: test/tp</span>&#x000A;<span id="LC2" class="line" lang="plaintext">Run sub(Qos0) in topic [test/tp]</span>&#x000A;<span id="LC3" class="line" lang="plaintext">Run sub(Qos1) in topic [test/tp]</span>&#x000A;<span id="LC4" class="line" lang="plaintext">Run sub(Qos2) in topic [test/tp]</span>&#x000A;<span id="LC5" class="line" lang="plaintext">Run sub(Qos2) in topic [test/#]</span>&#x000A;<span id="LC6" class="line" lang="plaintext">Run Qos1 sub in topic [test/chat] with qos2 will</span>&#x000A;<span id="LC7" class="line" lang="plaintext">Hit CTRL+C</span>&#x000A;<span id="LC8" class="line" lang="plaintext">test/tp qos2</span>&#x000A;<span id="LC9" class="line" lang="plaintext">test/tp qos2</span>&#x000A;<span id="LC10" class="line" lang="plaintext">test/tp qos2</span>&#x000A;<span id="LC11" class="line" lang="plaintext">test/tp qos2</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="59:1-59:24" dir="auto">Here is the ASan reprot:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="60:1-117:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">Error: Unknown error.</span>&#x000A;<span id="LC2" class="line" lang="plaintext">Error: The connection was lost.</span>&#x000A;<span id="LC3" class="line" lang="plaintext">=================================================================</span>&#x000A;<span id="LC4" class="line" lang="plaintext">Error: A network protocol error occurred when communicating with the broker.</span>&#x000A;<span id="LC5" class="line" lang="plaintext">==1400134==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000210 at pc 0x0000004cb0c8 bp 0x7ffeee2abd60 sp 0x7ffeee2abd58</span>&#x000A;<span id="LC6" class="line" lang="plaintext">READ of size 4 at 0x602000000210 thread T0</span>&#x000A;<span id="LC7" class="line" lang="plaintext">    #0 0x4cb0c7 in my_subscribe_callback mosquitto/client/sub_client.c:150:27</span>&#x000A;<span id="LC8" class="line" lang="plaintext">    #1 0x7fb53b7b9b3f in handle__suback mosquitto/lib/handle_suback.c:102:3</span>&#x000A;<span id="LC9" class="line" lang="plaintext">    #2 0x7fb53b80512f in handle__packet mosquitto/lib/read_handle.c:59:11</span>&#x000A;<span id="LC10" class="line" lang="plaintext">    #3 0x7fb53b7f274a in packet__read mosquitto/lib/packet_mosq.c:566:7</span>&#x000A;<span id="LC11" class="line" lang="plaintext">    #4 0x7fb53b7c21f1 in mosquitto_loop_read mosquitto/lib/loop.c:380:9</span>&#x000A;<span id="LC12" class="line" lang="plaintext">    #5 0x7fb53b7c0966 in mosquitto_loop mosquitto/lib/loop.c:149:10</span>&#x000A;<span id="LC13" class="line" lang="plaintext">    #6 0x7fb53b7c2785 in mosquitto_loop_forever mosquitto/lib/loop.c:257:9</span>&#x000A;<span id="LC14" class="line" lang="plaintext">    #7 0x4ca20c in main mosquitto/client/sub_client.c:404:7</span>&#x000A;<span id="LC15" class="line" lang="plaintext">    #8 0x7fb53b3c60b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16</span>&#x000A;<span id="LC16" class="line" lang="plaintext">    #9 0x41d76d in _start (mosquitto/client/mosquitto_sub+0x41d76d)</span>&#x000A;<span id="LC17" class="line" lang="plaintext"></span>&#x000A;<span id="LC18" class="line" lang="plaintext">0x602000000211 is located 0 bytes to the right of 1-byte region [0x602000000210,0x602000000211)</span>&#x000A;<span id="LC19" class="line" lang="plaintext">allocated by thread T0 here:</span>&#x000A;<span id="LC20" class="line" lang="plaintext">    #0 0x4989aa in malloc /home/brian/src/llvm_releases/llvm-project/llvm/utils/release/final/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3</span>&#x000A;<span id="LC21" class="line" lang="plaintext"></span>&#x000A;<span id="LC22" class="line" lang="plaintext">SUMMARY: AddressSanitizer: heap-buffer-overflow mosquitto/client/sub_client.c:150:27 in my_subscribe_callback</span>&#x000A;<span id="LC23" class="line" lang="plaintext">Shadow bytes around the buggy address:</span>&#x000A;<span id="LC24" class="line" lang="plaintext">  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span>&#x000A;<span id="LC25" class="line" lang="plaintext">  0x0c047fff8000: fa fa 00 07 fa fa 00 fa fa fa 00 02 fa fa 00 fa</span>&#x000A;<span id="LC26" class="line" lang="plaintext">  0x0c047fff8010: fa fa 00 02 fa fa 00 02 fa fa 00 fa fa fa 00 01</span>&#x000A;<span id="LC27" class="line" lang="plaintext">  0x0c047fff8020: fa fa 00 02 fa fa 00 00 fa fa fd fd fa fa fd fd</span>&#x000A;<span id="LC28" class="line" lang="plaintext">  0x0c047fff8030: fa fa 00 00 fa fa fd fa fa fa fd fd fa fa 02 fa</span>&#x000A;<span id="LC29" class="line" lang="plaintext">=&gt;0x0c047fff8040: fa fa[01]fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC30" class="line" lang="plaintext">  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC31" class="line" lang="plaintext">  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC32" class="line" lang="plaintext">  0x0c047fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC33" class="line" lang="plaintext">  0x0c047fff8080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC34" class="line" lang="plaintext">  0x0c047fff8090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span>&#x000A;<span id="LC35" class="line" lang="plaintext">Shadow byte legend (one shadow byte represents 8 application bytes):</span>&#x000A;<span id="LC36" class="line" lang="plaintext">  Addressable:           00</span>&#x000A;<span id="LC37" class="line" lang="plaintext">  Partially addressable: 01 02 03 04 05 06 07 </span>&#x000A;<span id="LC38" class="line" lang="plaintext">  Heap left redzone:       fa</span>&#x000A;<span id="LC39" class="line" lang="plaintext">  Freed heap region:       fd</span>&#x000A;<span id="LC40" class="line" lang="plaintext">  Stack left redzone:      f1</span>&#x000A;<span id="LC41" class="line" lang="plaintext">  Stack mid redzone:       f2</span>&#x000A;<span id="LC42" class="line" lang="plaintext">  Stack right redzone:     f3</span>&#x000A;<span id="LC43" class="line" lang="plaintext">  Stack after return:      f5</span>&#x000A;<span id="LC44" class="line" lang="plaintext">  Stack use after scope:   f8</span>&#x000A;<span id="LC45" class="line" lang="plaintext">  Global redzone:          f9</span>&#x000A;<span id="LC46" class="line" lang="plaintext">  Global init order:       f6</span>&#x000A;<span id="LC47" class="line" lang="plaintext">  Poisoned by user:        f7</span>&#x000A;<span id="LC48" class="line" lang="plaintext">  Container overflow:      fc</span>&#x000A;<span id="LC49" class="line" lang="plaintext">  Array cookie:            ac</span>&#x000A;<span id="LC50" class="line" lang="plaintext">  Intra object redzone:    bb</span>&#x000A;<span id="LC51" class="line" lang="plaintext">  ASan internal:           fe</span>&#x000A;<span id="LC52" class="line" lang="plaintext">  Left alloca redzone:     ca</span>&#x000A;<span id="LC53" class="line" lang="plaintext">  Right alloca redzone:    cb</span>&#x000A;<span id="LC54" class="line" lang="plaintext">  Shadow gap:              cc</span>&#x000A;<span id="LC55" class="line" lang="plaintext">==1400134==ABORTING</span>&#x000A;<span id="LC56" class="line" lang="plaintext">Error: The connection was lost.</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h2 data-sourcepos="119:1-119:11" dir="auto">&#x000A;<a id="user-content-tracking" class="anchor" href="#tracking" aria-hidden="true"></a>Tracking</h2>&#x000A;<p data-sourcepos="121:1-121:52" dir="auto"><strong>This section will completed by the project team</strong>.</p>&#x000A;<ul data-sourcepos="123:1-126:0" class="task-list" dir="auto">&#x000A;<li data-sourcepos="123:1-123:27" class="task-list-item">&#x000A;<task-button></task-button><input type="checkbox" class="task-list-item-checkbox" disabled> Reserve an entry only</li>&#x000A;<li data-sourcepos="124:1-124:101" class="task-list-item">&#x000A;<task-button></task-button><input type="checkbox" class="task-list-item-checkbox" disabled> We're ready for this issue to be reported to the central authority (i.e., make this public now)</li>&#x000A;<li data-sourcepos="125:1-126:0" class="task-list-item">&#x000A;<task-button></task-button><input type="checkbox" class="task-list-item-checkbox" disabled> (when applicable) The GitHub Security Advisory is ready to be published now</li>&#x000A;</ul>&#x000A;<p data-sourcepos="127:1-127:142" dir="auto">Note that for those projects that host their repositories on GitHub, the use of GitHub Security Advisories is recommended but is not required.</p>&#x000A;<p data-sourcepos="129:1-129:46" dir="auto"><strong>This section will be completed by the EMO</strong>.</p>&#x000A;<p data-sourcepos="131:1-131:14" dir="auto"><strong>CVE:</strong> {cve}</p>&#x000A;<ul data-sourcepos="133:1-137:27" class="task-list" dir="auto">&#x000A;<li data-sourcepos="133:1-133:42" class="task-list-item">&#x000A;<task-button></task-button><input type="checkbox" class="task-list-item-checkbox" disabled> All required information is provided</li>&#x000A;<li data-sourcepos="134:1-134:18" class="task-list-item">&#x000A;<task-button></task-button><input type="checkbox" class="task-list-item-checkbox" disabled> CVE Assigned</li>&#x000A;<li data-sourcepos="135:1-135:21" class="task-list-item">&#x000A;<task-button></task-button><input type="checkbox" class="task-list-item-checkbox" disabled> Pushed to Mitre</li>&#x000A;<li data-sourcepos="136:1-137:27" class="task-list-item">&#x000A;<task-button></task-button><input type="checkbox" class="task-list-item-checkbox" disabled> Accepted by Mitre&#x000A;/assign <a href="/mbarbero" data-reference-type="user" data-user="72" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Mikaël Barbero">@mbarbero</a> <a href="/mrybczyn" data-reference-type="user" data-user="624" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Marta Rybczynska">@mrybczyn</a>&#x000A;</li>&#x000A;</ul></div>
</div>
<div class="edited-text gl-mt-4 gl-text-gray-500 gl-text-sm">Edited <time class="js-timeago issue-edited-ago js-issue-edited-ago" title="Mar 26, 2024 3:45pm" datetime="2024-03-26T15:45:10Z" data-toggle="tooltip" data-placement="bottom" data-container="body">Mar 26, 2024</time> by <a class="author-link hover:gl-underline gl-text-gray-700 js-user-link" data-user-id="18086" data-username="duqingpeng10515" data-name="Qingpeng Du" href="/duqingpeng10515"><span class="">Qingpeng Du</span></a></div>
</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/3804/issues/190/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-gray-100 gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="security/vulnerability-reports" data-issuable-id="624921" data-issuable-iid="190" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-default-branch="main" data-wi-epics-list-path="/groups/vulnerability-reports/-/epics" data-wi-full-path="security/vulnerability-reports" data-wi-group-issues-path="/groups/vulnerability-reports/-/issues" data-wi-group-path="security" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/security/vulnerability-reports/-/issues" data-wi-labels-fetch-path="/groups/vulnerability-reports/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/security/vulnerability-reports/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/security/vulnerability-reports/-/issues/190/links" data-full-path="security/vulnerability-reports" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-default-branch="main" data-wi-epics-list-path="/groups/vulnerability-reports/-/epics" data-wi-full-path="security/vulnerability-reports" data-wi-group-issues-path="/groups/vulnerability-reports/-/issues" data-wi-group-path="security" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/security/vulnerability-reports/-/issues" data-wi-labels-fetch-path="/groups/vulnerability-reports/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/security/vulnerability-reports/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="190" data-project-path="security/vulnerability-reports" id="js-related-merge-requests"></div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:624921,&quot;iid&quot;:190,&quot;description&quot;:&quot;## Basic information\n\n**Project name:** Eclipse Mosquitto **Project id:** mosquitto.org\n\n**Request type:** publication\n\n**Versions affected:** [v2.0.18-4-g15292b20]\n\n**Common Weakness Enumeration:**\n\n- [CWE-122: Heap-based Buffer Overflow](https://cwe.mitre.org/data/definitions/122.html)\n\n**Common Vulnerability Scoring System:** -\n\n**Summary:**\n\nIn Eclipse Mosquitto version v2.0.18-4-g15292b20, a heap-buffer-overflow vulnerability was discovered that can be triggered when the broker processes a specially crafted packet. This vulnerability exists due to a boundary error within the `my_subscribe_callback` function in the `sub_client.c` file, which can lead to code execution or denial of service.\n\n\n**Links:**\n\nThe project at \&quot;https://github.com/eclipse/mosquitto\&quot; advises against posting discovered bugs directly in the issues section and instead requests the submission of details via the form at \&quot;https://gitlab.eclipse.org/security\&quot;. I apologize for any inconvenience, and so I have documented the method for reproducing the issue here.\n\n**Reproduce：**\n\n1. Configure the building environment with ASan and UBSan by setting the environment variables for the compiler and linker:\n\n   ```bash\n   export CC=clang CXX=clang++\n   export CFLAGS=\&quot;-g -fsanitize=address,undefined -fno-omit-frame-pointer\&quot;\n   export CXXFLAGS=\&quot;-g -fsanitize=address,undefined -fno-omit-frame-pointer\&quot;\n   export LDFLAGS=\&quot;-fsanitize=address,undefined\&quot;\n   make clean\n   make -j 8\n   ```\n2. Start the Mosquitto broker server in verbose mode on port 2883:\n\n   ```bash\n   mosquitto/src/mosquitto -v -p 2883\n   ```\n3. Write the data transmission from the proxy to the client using a series of hexstream found in `hexstream.txt`:\n\n   [hexstream.txt](/uploads/abdd422fd21616901eff5f58b225ca65/hexstream.txt)\n**Crash Report：**\nHere is the client log：\n```\nRun topic: test/tp\nRun sub(Qos0) in topic [test/tp]\nRun sub(Qos1) in topic [test/tp]\nRun sub(Qos2) in topic [test/tp]\nRun sub(Qos2) in topic [test/#]\nRun Qos1 sub in topic [test/chat] with qos2 will\nHit CTRL+C\ntest/tp qos2\ntest/tp qos2\ntest/tp qos2\ntest/tp qos2\n```\nHere is the ASan reprot:\n```\nError: Unknown error.\nError: The connection was lost.\n=================================================================\nError: A network protocol error occurred when communicating with the broker.\n==1400134==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000210 at pc 0x0000004cb0c8 bp 0x7ffeee2abd60 sp 0x7ffeee2abd58\nREAD of size 4 at 0x602000000210 thread T0\n    #0 0x4cb0c7 in my_subscribe_callback mosquitto/client/sub_client.c:150:27\n    #1 0x7fb53b7b9b3f in handle__suback mosquitto/lib/handle_suback.c:102:3\n    #2 0x7fb53b80512f in handle__packet mosquitto/lib/read_handle.c:59:11\n    #3 0x7fb53b7f274a in packet__read mosquitto/lib/packet_mosq.c:566:7\n    #4 0x7fb53b7c21f1 in mosquitto_loop_read mosquitto/lib/loop.c:380:9\n    #5 0x7fb53b7c0966 in mosquitto_loop mosquitto/lib/loop.c:149:10\n    #6 0x7fb53b7c2785 in mosquitto_loop_forever mosquitto/lib/loop.c:257:9\n    #7 0x4ca20c in main mosquitto/client/sub_client.c:404:7\n    #8 0x7fb53b3c60b2 in __libc_start_main /build/glibc-eX1tMB/glibc-2.31/csu/../csu/libc-start.c:308:16\n    #9 0x41d76d in _start (mosquitto/client/mosquitto_sub+0x41d76d)\n\n0x602000000211 is located 0 bytes to the right of 1-byte region [0x602000000210,0x602000000211)\nallocated by thread T0 here:\n    #0 0x4989aa in malloc /home/brian/src/llvm_releases/llvm-project/llvm/utils/release/final/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:145:3\n\nSUMMARY: AddressSanitizer: heap-buffer-overflow mosquitto/client/sub_client.c:150:27 in my_subscribe_callback\nShadow bytes around the buggy address:\n  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n  0x0c047fff8000: fa fa 00 07 fa fa 00 fa fa fa 00 02 fa fa 00 fa\n  0x0c047fff8010: fa fa 00 02 fa fa 00 02 fa fa 00 fa fa fa 00 01\n  0x0c047fff8020: fa fa 00 02 fa fa 00 00 fa fa fd fd fa fa fd fd\n  0x0c047fff8030: fa fa 00 00 fa fa fd fa fa fa fd fd fa fa 02 fa\n=\u003e0x0c047fff8040: fa fa[01]fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n  0x0c047fff8090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\nShadow byte legend (one shadow byte represents 8 application bytes):\n  Addressable:           00\n  Partially addressable: 01 02 03 04 05 06 07 \n  Heap left redzone:       fa\n  Freed heap region:       fd\n  Stack left redzone:      f1\n  Stack mid redzone:       f2\n  Stack right redzone:     f3\n  Stack after return:      f5\n  Stack use after scope:   f8\n  Global redzone:          f9\n  Global init order:       f6\n  Poisoned by user:        f7\n  Container overflow:      fc\n  Array cookie:            ac\n  Intra object redzone:    bb\n  ASan internal:           fe\n  Left alloca redzone:     ca\n  Right alloca redzone:    cb\n  Shadow gap:              cc\n==1400134==ABORTING\nError: The connection was lost.\n```\n\n## Tracking\n\n**This section will completed by the project team**.\n\n- [ ] Reserve an entry only\n- [ ] We&#39;re ready for this issue to be reported to the central authority (i.e., make this public now)\n- [ ] (when applicable) The GitHub Security Advisory is ready to be published now\n\nNote that for those projects that host their repositories on GitHub, the use of GitHub Security Advisories is recommended but is not required.\n\n**This section will be completed by the EMO**.\n\n**CVE:** {cve}\n\n- [ ] All required information is provided\n- [ ] CVE Assigned\n- [ ] Pushed to Mitre\n- [ ] Accepted by Mitre\n/assign @mbarbero @mrybczyn&quot;,&quot;title&quot;:&quot;Heap Buffer Overflow in my_subscribe_callback Function in Eclipse Mosquitto v2.0.18-4-g15292b20&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:18805,&quot;created_at&quot;:&quot;2024-03-26T13:57:49Z&quot;,&quot;updated_at&quot;:&quot;2024-10-30T11:58:37Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[{&quot;id&quot;:69578,&quot;title&quot;:&quot;cve::published&quot;,&quot;color&quot;:&quot;#cce8b5&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2023-09-07T07:39:18.203Z&quot;,&quot;updated_at&quot;:&quot;2023-09-07T07:39:18.203Z&quot;},{&quot;id&quot;:116747,&quot;title&quot;:&quot;vulnerability::confirmed&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2024-08-22T15:24:38.252Z&quot;,&quot;updated_at&quot;:&quot;2024-08-22T15:24:38.252Z&quot;}],&quot;lock_version&quot;:2,&quot;author_id&quot;:18086,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:744,&quot;username&quot;:&quot;rlight&quot;,&quot;name&quot;:&quot;Roger Light&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/27bd0a8347c124e6ec20403049bd0601eca2c2fea994f50136846d31aa476741?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.eclipse.org/rlight&quot;}],&quot;due_date&quot;:null,&quot;project_id&quot;:3804,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/security/vulnerability-reports/-/issues/190&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/security/vulnerability-reports/notes?target_id=624921\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/security/vulnerability-reports/-/preview_markdown?target_id=190\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:624921,&quot;projectId&quot;:3804,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/security/vulnerability-reports/-/issues/190/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/security/vulnerability-reports/-/issues/190.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/security/vulnerability-reports/-/issues/190.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/security/vulnerability-reports/noteable/issue/624921/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736606618000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-shadow-none gl-block " type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-236e3b687d786d9dfe4709143a94d4c53b8d5a1f235775401e5825148297fa84.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/security/vulnerability-reports/-/issues/190.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="security" data-issue-id="624921" data-issue-iid="190" data-project-path="security/vulnerability-reports"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="190" data-issuable-type="issue" data-labels-fetch-path="/security/vulnerability-reports/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/security/vulnerability-reports/-/labels" data-project-issues-path="/security/vulnerability-reports/-/issues" data-project-path="security/vulnerability-reports" data-selected-labels="[{&quot;id&quot;:69578,&quot;title&quot;:&quot;cve::published&quot;,&quot;color&quot;:&quot;#cce8b5&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2023-09-07T07:39:18.203Z&quot;,&quot;updated_at&quot;:&quot;2023-09-07T07:39:18.203Z&quot;},{&quot;id&quot;:116747,&quot;title&quot;:&quot;vulnerability::confirmed&quot;,&quot;color&quot;:&quot;#6699cc&quot;,&quot;description&quot;:&quot;&quot;,&quot;group_id&quot;:3675,&quot;project_id&quot;:null,&quot;template&quot;:false,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2024-08-22T15:24:38.252Z&quot;,&quot;updated_at&quot;:&quot;2024-08-22T15:24:38.252Z&quot;}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="190" data-project-path="security/vulnerability-reports"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="security" data-issue-id="624921" data-issue-iid="190" data-project-path="security/vulnerability-reports"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="190" data-project-path="security/vulnerability-reports"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="security/vulnerability-reports" data-iid="190" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="js-sidebar-confidential-widget-root"></div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/security/vulnerability-reports/-/issues/190.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/security/vulnerability-reports/-/issues/190/toggle_subscription","moveIssueEndpoint":"/security/vulnerability-reports/-/issues/190/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=3804","editable":"","currentUser":{},"rootPath":"/","fullPath":"security/vulnerability-reports","iid":190,"id":624921,"severity":"unknown","timeTrackingLimitToHours":false,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>

<div class="footer-message" style="background-color: #4c4d4e;color: #ffffff"><p>Copyright © Eclipse Foundation, Inc. All Rights Reserved.     <a style="color:#fff;" href="https://www.eclipse.org/legal/privacy.php" rel="nofollow noreferrer noopener" target="_blank">Privacy Policy</a> | <a style="color:#fff;" href="https://www.eclipse.org/legal/termsofuse.php" rel="nofollow noreferrer noopener" target="_blank">Terms of Use</a> | <a style="color:#fff;" href="https://www.eclipse.org/legal/copyright.php" rel="nofollow noreferrer noopener" target="_blank">Copyright Agent</a></p></div>
<script>
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

