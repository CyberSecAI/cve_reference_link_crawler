
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fnyxfqq%2Fa7242170b1118e78436a62dee4e09e8a)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fnyxfqq%2Fa7242170b1118e78436a62dee4e09e8a&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fnyxfqq%2Fa7242170b1118e78436a62dee4e09e8a) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fnyxfqq%2Fa7242170b1118e78436a62dee4e09e8a&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@nyxfqq](https://avatars.githubusercontent.com/u/168119898?s=64&v=4)](/nyxfqq)

# [nyxfqq](/nyxfqq)/**[gist:a7242170b1118e78436a62dee4e09e8a](/nyxfqq/a7242170b1118e78436a62dee4e09e8a)**

Last active
July 3, 2024 08:20

Show Gist options

* [Download ZIP](/nyxfqq/a7242170b1118e78436a62dee4e09e8a/archive/6cd26dbf1d41e62225077d3c63be912c06c674e8.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnyxfqq%2Fa7242170b1118e78436a62dee4e09e8a)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnyxfqq%2Fa7242170b1118e78436a62dee4e09e8a)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/nyxfqq/a7242170b1118e78436a62dee4e09e8a.js&quot;&gt;&lt;/script&gt;
* Save nyxfqq/a7242170b1118e78436a62dee4e09e8a to your computer and use it in GitHub Desktop.

[Code](/nyxfqq/a7242170b1118e78436a62dee4e09e8a)
[Revisions
3](/nyxfqq/a7242170b1118e78436a62dee4e09e8a/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/nyxfqq/a7242170b1118e78436a62dee4e09e8a.js&quot;&gt;&lt;/script&gt;

Save nyxfqq/a7242170b1118e78436a62dee4e09e8a to your computer and use it in GitHub Desktop.

[Download ZIP](/nyxfqq/a7242170b1118e78436a62dee4e09e8a/archive/6cd26dbf1d41e62225077d3c63be912c06c674e8.zip)

CVE-2024-39223

 [Raw](/nyxfqq/a7242170b1118e78436a62dee4e09e8a/raw/6cd26dbf1d41e62225077d3c63be912c06c674e8/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | [Suggested description] |
| --- | --- |
|  | An authentication bypass in the SSH service of gost v2.11.5 allows |
|  | attackers to intercept communications via a man-in-the-middle attack. |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [VulnerabilityType Other] |
|  | CWE305 |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Vendor of Product] |
|  | https://github.com/ginuerzh/gost |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Affected Product Code Base] |
|  | gost - <=2.11.5 |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Affected Component] |
|  | local/remote TCP port forwarding. |
|  | Integrity of transmission messages |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Attack Type] |
|  | Remote |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Impact Code execution] |
|  | true |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Impact Escalation of Privileges] |
|  | true |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Attack Vectors] |
|  | An attacker could potentially exploit this vulnerability by intercepting SSH connections and performing man-in-the-middle (MITM) attacks without being detected due to the skipping of host fingerprint verification. |
|  | --- |
|  |  |
|  | Description: |
|  | Specifically, in the file `github.com/ginuerzh/gost/ssh.go` at line 229, there is a critical configuration that bypasses host key verification, potentially exposing systems to Man-in-the-Middle (MitM) attacks. |
|  |  |
|  | The relevant code snippet is as follows: |
|  |  |
|  | config := ssh.ClientConfig{ |
|  | Timeout: timeout, |
|  | HostKeyCallback: ssh.InsecureIgnoreHostKey(), // This line disables host key verification |
|  | } |
|  |  |
|  |  |
|  | This configuration sets `HostKeyCallback` to `ssh.InsecureIgnoreHostKey()`, which effectively disables host key verification during the SSH connection establishment. As a result, any server's host key is accepted without validation, making it impossible for `gost` to ensure that it is connecting to the intended and trusted server. |
|  |  |
|  | Potential Impact: |
|  | Disabling host key verification significantly weakens the security of SSH connections managed by `gost`. An attacker could exploit this vulnerability by intercepting the SSH connection and presenting a forged host key, thereby enabling them to perform MitM attacks. This could lead to the theft of sensitive data, unauthorized access to systems, or the execution of malicious actions on behalf of legitimate users. |
|  |  |
|  | Suggested Solution: |
|  | To mitigate this risk, I recommend implementing a secure host key verification mechanism. This could involve using a known host key, or if dynamic host keys are expected, storing and comparing fingerprints against a list of trusted keys. The `HostKeyCallback` should be updated to use a callback function that checks the host key against a list of known or trusted keys. |
|  |  |
|  | For instance, the `HostKeyCallback` could be replaced with: |
|  |  |
|  | HostKeyCallback: func(hostname string, remote net.Addr, key ssh.PublicKey) error { |
|  | // Implement your host key verification logic here |
|  | // Return nil if the host key is trusted, otherwise return an error |
|  | }, |
|  |  |
|  |  |
|  | ------------------------------------------ |
|  |  |
|  | [Discoverer] |
|  | YueXi Zhang |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fnyxfqq%2Fa7242170b1118e78436a62dee4e09e8a)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

