
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Forangecertcc%2Fsecurity-research%2Fsecurity%2Fadvisories%2FGHSA-wmjv-552v-pxjc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Forangecertcc%2Fsecurity-research%2Fsecurity%2Fadvisories%2FGHSA-wmjv-552v-pxjc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=orangecertcc%2Fsecurity-research)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[orangecertcc](/orangecertcc)
/
**[security-research](/orangecertcc/security-research)**
Public

* [Notifications](/login?return_to=%2Forangecertcc%2Fsecurity-research) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Forangecertcc%2Fsecurity-research)
* [Star
   11](/login?return_to=%2Forangecertcc%2Fsecurity-research)

* [Code](/orangecertcc/security-research)
* [Pull requests
  0](/orangecertcc/security-research/pulls)
* [Actions](/orangecertcc/security-research/actions)
* [Security](/orangecertcc/security-research/security)
* [Insights](/orangecertcc/security-research/pulse)

Additional navigation options

* [Code](/orangecertcc/security-research)
* [Pull requests](/orangecertcc/security-research/pulls)
* [Actions](/orangecertcc/security-research/actions)
* [Security](/orangecertcc/security-research/security)
* [Insights](/orangecertcc/security-research/pulse)

# Path Traversal in SD-WAN vEdge (x86 and mips64) routers (CVE-2022-20775)

High

[orange-cert-cc](/orange-cert-cc)
published
GHSA-wmjv-552v-pxjc
Oct 10, 2022

## Package

SD-WAN vEdge (x86 and mips64) routers
(Cisco)

## Affected versions

20.6.1
20.6.2

## Patched versions

20.6.3
20.6.3

## Description

### Overview

A path traveral on `confd_cli_grp` allows to leak `confd_ipc_secret`. This leak gives the ability to connect with any `uid` and `gid` leading to a local privilege escalation to root.

### Impact

This vulnerability allows any local user to escalate to an unconstrained root shell.

### Details

vEdge routers propose a restricted shell access through `vshell` command. From this shell it is possible to launch `confd_cli_grp` which connects to confd in order to deliver a confd CLI session.

When connecting, `confd_cli_grp` provides session configurations (such as `uid` and `gid` and `groups`) once authenticated. The session authentication and configurations signature are based on a secret key stored in file `confd_ipc_secret`.

In order to find out the groups the current user belongs to, `confd_cli_grp` read a file with its name resulting of the concatenation of the directory `/etc/viptela/aaa_auth_grp`,the username and the extension `.external`.

Pseudo code:

```
  snprintf(fname_buffer, 0x200, "%s/%s.external", "/etc/viptela/aaa_auth_grp", username);
```

Once opened, it loaded the file content:

Pseudo code:

```
  fscanf(fd, "%s", aaa_groups_buffer);
```

It then parse the groups list (exemple: `log,admin`) and send it in a signed configuration message.

The problem is that the username is an attacker controlled variable.

It can be set through `USER` environment variable. For instance an attacker can define `USER=/../../../../../tmp/foo` environment variable.

A `getpwnam_r()` call is done to check the user validity. But the library `libnss_viptela.so` (called via `getpwnam_r()`) will consider this user as valid as long as the directory `/tmp/vipnss.` and the file `/tmp/foo` exist.

This is because the library `libnss_viptela.so` has a similar path traversal bug.

Then the groups will be loaded from file `/etc/viptela/aaa_auth_grp/../../../../../tmp/foo.external` which will be solved as `/tmp/foo.external`.

The ability to arbitrary read a file when loading group poses several issues:

* It is possible to set any `gid` group to the user session.
* As the file content is controlled by the attacker, `fscanf()` results in a potential stack buffer overflow.
* We can leak sensitive informations (as `confd_cli_grp` is a S-UID binary) by making `/tmp/foo.external` point to any other file with a symlink. This will be detailed in next chapter.

### Proof of Concept

For the exploitation demonstration we decided to leak `confd_ipc_secret` in order to be able to forge and resign the session configuration sent by `confd_cli_grp` to `confd`  and thus establish a session with `root` privileges.

To better understand, you can find here our observations concerning the sessions establishment between `confd_cli_grp` and `confd`:

```
                      secret:
      ┌───────>   confd_ipc_secret  <────────┐
      │                                      │
      │                                      │
      │                                      │
      │                                      │
confd_cli_grp                              confd

      │             challenge                │
      │<─────────────────────────────────────┤
      │                                      │
      ├─────────────────────────────────────>│
      │       resp:md5(chall + secret)       │
      │                                      │
      │                                      │
      │               nonce                  │
      │<─────────────────────────────────────┤
      │                                      │
      ├─────────────────────────────────────>│
      │   conf + md5(nonce + secret + conf)  │
      │                                      │
      │                                      │
      │ CLI session is starting...           │
      │<────────────────────────────────────>│
      │                                      │

```

The `conf` is a sequence of clear text and integers parameters separated by `;` characters. This configuration is trusted by `confd` as it is signed with the IPC secret key.

Note: It is possible to proxify (Man-in-the-Middle) the communication by setting `CONFD_IPC_PORT` environment variable to a different port.

Our exploit strategy is to use the username `USER=/../../../../tmp/pwn` and symlink `/tmp/pwn.external` to point to `confd_ipc_secret`.

When establishing the connection with this user, `confd_cli_grp` will send the content `confd_ipc_secret` as a `conf` parameter.

Our exploit, in a Man-in-the-Middle situation, intercepts this secret in order to rebuild and sign a valid `conf` with `uid=0` and `gid=0`.

You can find the exploit code in appendix.

```
vedge# vshell
vedge:~$ id
uid=1000(admin) gid=1000(admin) groups=1000(admin),302(log)
vedge:~$ python3 /tmp/exploit.py 1234
[.] PROXY: Connecting local 4565
[.] PROXY: Listenning 0.0.0.0 1234
[.] Launching confd_cli_grp
[.] PROXY: Connection received
[.] PROXY: Poll
[+] Received challenge: b'\xac_\xf7jc\xc6\x1c\xaaN\t\xaa\x97\xccw\x93\xb5'
[+] Leak succeed. Key: b'1550807544-98829'
[.] Signature: 734800704d6ddba3352dac126c8c36bd
Welcome to Viptela CLI
root connected from 127.0.0.1 using console on vedge
vedge# vshell
bash-4.4# id
uid=0(root) gid=0(root) groups=0(root),302(log),1000(admin)
bash-4.4#

```
### Affected versions

This exploitation has been successfully tested on SD-WAN vEdge (x86 and mips64) platforms with 20.6.2 and 20.6.1 versions.

### Solution

#### Security patch

Upgrade to fixed SD-WAN vEdge firmware release 20.6.3 (for other initial releases, please refer to [Cisco Security Advisory](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sd-wan-priv-E6e8tEdF))

### References

<https://nvd.nist.gov/vuln/detail/CVE-2022-20775>

<https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-sd-wan-priv-E6e8tEdF>

### Credits

[Orange CERT-CC](https://cert.orange.com/)

Cyrille CHATRAS at [Orange group](https://www.orange.com/)

### Timeline

**Date reported:** December 16, 2021

**Date fixed:** September 28, 2022

### Severity

High

7.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### CVE ID

CVE-2022-20775

### Weaknesses

[CWE-25](/advisories?query=cwe%3A25)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

