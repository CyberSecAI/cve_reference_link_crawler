- **Root cause of vulnerability:** The `z_erofs_gbuf_growsize()` function in the erofs filesystem lacked proper bounds checking when freeing pages after a partial failure during global buffer growth. Specifically, when `z_erofs_gbuf_growsize()` partially fails due to memory allocation issues or fault injection, it needs to free newly allocated pages. The code compared `tmp_pages` with `gbuf->pages` for freeing, but it did not check if the index `j` was within the bounds of `gbuf->pages`. If `gbuf->pages` was not large enough (specifically, if `j` is greater or equal to `gbuf->nrpages`), an out-of-bounds access could occur.

- **Weaknesses/vulnerabilities present:** Out-of-bounds access in `z_erofs_gbuf_growsize()`.

- **Impact of exploitation:** A successful exploitation could lead to a null-ptr-deref or out-of-bounds access, potentially causing a kernel panic, denial of service, or other undefined behavior due to memory corruption.

- **Attack vectors:** Triggering a partial failure of `z_erofs_gbuf_growsize()`, possibly through memory allocation failures or fault injection.

- **Required attacker capabilities/position:** Ability to trigger the `z_erofs_gbuf_growsize()` function, and potentially influence memory allocation behavior or induce fault conditions within the system.