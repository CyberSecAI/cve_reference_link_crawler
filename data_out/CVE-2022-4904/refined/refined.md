```
{
  "vulnerability": {
    "cve_id": "CVE-2022-4904",
    "description": "A flaw was found in the c-ares package. The ares_set_sortlist is missing checks about the validity of the input string, which allows a possible arbitrary length stack overflow. This issue may cause a denial of service or a limited impact on confidentiality and integrity.",
    "affected_component": "c-ares library",
    "root_cause": "The `ares_set_sortlist` function does not validate the length of the input string before using it in `config_sortlist`. Specifically, the `memcpy` operations within `config_sortlist` do not check the length of the string being copied, leading to a potential buffer overflow on the stack.",
    "vulnerabilities": [
      "Stack-based buffer overflow due to missing input validation in the `config_sortlist` function."
    ],
    "impact": "A successful exploit could lead to denial of service due to a crash from the stack overflow. There is a possibility of limited impact to confidentiality and integrity.",
    "attack_vector": "A network attacker can send a crafted, overly long string to the `ares_set_sortlist` function.",
    "attacker_capabilities": "An attacker needs to control or influence the input string being passed to the `ares_set_sortlist` function. This can be achieved through network traffic manipulation if the application uses DNS resolution in a way that can be influenced by an attacker.",
    "additional_details": [
      "The vulnerable code is within `ares_set_sortlist` and `config_sortlist` functions.",
      "The vulnerability can be triggered by providing an arbitrary length string to the `ares_set_sortlist` function.",
       "The vulnerable memcpy operations are `memcpy(ipbuf, str, q-str);` and `memcpy(ipbufpfx, str, q-str);`",
       "The issue was fixed by adding necessary length checks before memcpy operations.",
       "Red Hat has released errata to address the vulnerability in various products"

    ],
    "remediation": "The vulnerability has been fixed in c-ares version 1.19.0 and later. Users should upgrade to this version to mitigate the risk.",
    "cvss_score": 8.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H",
    "cwe_id": [
      "CWE-20",
      "CWE-119",
      "CWE-1284"
    ]
  }
}
```