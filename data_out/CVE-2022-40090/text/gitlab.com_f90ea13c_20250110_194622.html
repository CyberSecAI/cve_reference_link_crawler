

[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# [security] A crafted TIFF files will cause the program to enter an infinite loop

Summary

When running a maliciously crafted TIFF file, tiffinfo enters an infinite loop, the log and POC are as follows:[poc.tar.gz](/-/project/4720790/uploads/914fe7990d63744392dfbfcaefb0674a/poc.tar.gz)

Version

LIBTIFF, Version 4.4.0

Steps to reproduce

```
$ cmake ../ -DCMAKE_C_COMPILER=clang  -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_C_FLAGS="-fsanitize=memory -U_FORTIFY_SOURCE" -DCMAKE_CXX_FLAGS="-fsanitize=memory -U_FORTIFY_SOURCE"
$ ./tools/tiffinfo id:000000,src:002969,time:22503442,execs:28750636,op:havoc,rep:4
```

Platform

```
Linux firmy-pc 5.15.0-46-generic #49~20.04.2-Ubuntu SMP Fri Aug 12 08:03:17 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
clang version 10.0.0-4ubuntu1
```

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

