

<!DOCTYPE html>
<html lang="en-US">   <head>
    <!-- # block head (placeholder in theme.html) -->
        <!-- # block head (content inherited from layout.html) -->
    <title>
      #10753 (heap-buffer-overflow at libavfilter/f_reverse.c:269:26 in areverse_request_frame in FFmpeg)
          – FFmpeg

    </title>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script>
        if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
        </script><![endif]-->

    <link rel="start"  href="/wiki" />
    <link rel="search"  href="/search" />
    <link rel="help"  href="/wiki/TracGuide" />
    <link rel="stylesheet"  href="/chrome/common/css/trac.css" type="text/css" />
    <link rel="stylesheet"  href="/chrome/common/css/ticket.css" type="text/css" />
    <link rel="stylesheet"  href="/chrome/common/css/jquery-ui/jquery-ui.css" type="text/css" />
    <link rel="stylesheet"  href="/chrome/common/css/jquery-ui-addons.css" type="text/css" />
    <link rel="stylesheet"  href="/chrome/vote/css/tracvote.css" type="text/css" />
    <link rel="icon"  href="/chrome/common/trac.ico" type="image/x-icon" />
    <link rel="first"  href="/ticket/1" title="Ticket #1" />
    <link rel="prev"  href="/ticket/10752" title="Ticket #10752" />
    <link rel="last"  href="/ticket/11411" title="Ticket #11411" />
    <link rel="next"  href="/ticket/10754" title="Ticket #10754" />
    <link rel="alternate"  class="rss" href="/ticket/10753?format=rss" title="RSS Feed" type="application/rss+xml" />
    <link rel="alternate"  class="csv" href="/ticket/10753?format=csv" title="Comma-delimited Text" type="text/csv" />
    <link rel="alternate"  class="tab" href="/ticket/10753?format=tab" title="Tab-delimited Text" type="text/tab-separated-values" />
    <noscript>
      <style>
        .trac-noscript { display: none !important }
      </style>     </noscript>
    <link type="application/opensearchdescription+xml" rel="search"
          href="/search/opensearch"
          title="Search FFmpeg"/>
    <script>
      var comments_prefs={"comments_order":"oldest","show_comments":"true","show_prop_changes":"true"};
      var old_values={"analyzed":"0","blockedby":"","blocking":"","cc":"frankZ","changetime":"2023-12-29T23:58:42Z","component":"avfilter","description":"Summary of the bug:\r\n\r\nDear developers, \r\n\r\nWe found the following heap-buffer-overflow bug on FFmpeg(version N-113007-g8d24a28d06) when using areverse filter, please confirm.\r\n\r\nThe poc file(poc16ffmpeg) will be attached to this ticket.\r\n\r\nHow to reproduce:\r\n{{{\r\ngit clone https://github.com/FFmpeg/FFmpeg.git ffmpeg\r\ncd ffmpeg\r\n./configure --cc=clang --cxx=clang++ --ld=clang --enable-debug --toolchain=clang-asan\r\nmake -j30\r\n\r\n./ffmpeg_g -y -i poc16ffmpeg -filter_complex areverse tmp.mp4\r\n}}}\r\nASAN Log:\r\n{{{\r\n=================================================================x\r\n==809032==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61e000017290 at pc 0x55c70e479a45 bp 0x7f58adff8e90 sp 0x7f58adff8e88\r\nREAD of size 8 at 0x61e000017290 thread T2 (fc0)\r\n    #0 0x55c70e479a44 in areverse_request_frame /ffmpeg/libavfilter/f_reverse.c:269:26\r\n    #1 0x55c70e44a2f6 in ff_request_frame_to_filter /ffmpeg/libavfilter/avfilter.c:482:15\r\n    #2 0x55c70e446560 in ff_filter_activate_default /ffmpeg/libavfilter/avfilter.c:1194:20\r\n    #3 0x55c70e446560 in ff_filter_activate /ffmpeg/libavfilter/avfilter.c:1341:11\r\n    #4 0x55c70e455860 in get_frame_internal /ffmpeg/libavfilter/buffersink.c:139:19\r\n    #5 0x55c70e452ff0 in avfilter_graph_request_oldest /ffmpeg/libavfilter/avfiltergraph.c:1306:17\r\n    #6 0x55c70e350344 in read_frames /ffmpeg/fftools/ffmpeg_filter.c:2426:15\r\n    #7 0x55c70e346e28 in filter_thread /ffmpeg/fftools/ffmpeg_filter.c:2819:15\r\n    #8 0x55c70e388c18 in task_wrapper /ffmpeg/fftools/ffmpeg_sched.c:2200:21\r\n    #9 0x7f58b09e0ac2  (/lib/x86_64-linux-gnu/libc.so.6+0x94ac2) (BuildId: a43bfc8428df6623cd498c9c0caeb91aec9be4f9)\r\n    #10 0x7f58b0a72a3f  (/lib/x86_64-linux-gnu/libc.so.6+0x126a3f) (BuildId: a43bfc8428df6623cd498c9c0caeb91aec9be4f9)\r\n\r\n0x61e000017296 is located 0 bytes to the right of 2582-byte region [0x61e000016880,0x61e000017296)\r\nallocated by thread T2 (fc0) here:\r\n    #0 0x55c70e2ebf46 in __interceptor_realloc (/ffmpeg/ffmpeg_g+0x923f46) (BuildId: 8d6ccf457a75d047d11f9627d0b67208c2215c8c)\r\n    #1 0x55c711958aee in av_realloc /ffmpeg/libavutil/mem.c:162:11\r\n    #2 0x55c711958aee in av_fast_realloc /ffmpeg/libavutil/mem.c:513:11\r\n\r\nThread T2 (fc0) created by T0 here:\r\n    #0 0x55c70e2d4f9c in __interceptor_pthread_create (/ffmpeg/ffmpeg_g+0x90cf9c) (BuildId: 8d6ccf457a75d047d11f9627d0b67208c2215c8c)\r\n    #1 0x55c70e383161 in task_start /ffmpeg/fftools/ffmpeg_sched.c:403:11\r\n    #2 0x55c70e3a1e68 in transcode /ffmpeg/fftools/ffmpeg.c:922:11\r\n    #3 0x55c70e3a1e68 in main /ffmpeg/fftools/ffmpeg.c:1050:11\r\n    #4 0x7f58b0975d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: a43bfc8428df6623cd498c9c0caeb91aec9be4f9)\r\n\r\nSUMMARY: AddressSanitizer: heap-buffer-overflow /ffmpeg/libavfilter/f_reverse.c:269:26 in areverse_request_frame\r\nShadow bytes around the buggy address:\r\n  0x0c3c7fffae00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0c3c7fffae10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0c3c7fffae20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0c3c7fffae30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0c3c7fffae40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n=\u003e0x0c3c7fffae50: 00 00[06]fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c3c7fffae60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c3c7fffae70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c3c7fffae80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x0c3c7fffae90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x0c3c7fffaea0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07\r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n==809032==ABORTING\r\n}}}\r\n\r\nffmpeg version:\r\n{{{\r\n# ./ffmpeg -version\r\nffmpeg version N-113007-g8d24a28d06 Copyright (c) 2000-2023 the FFmpeg developers\r\nbuilt with Ubuntu clang version 14.0.0-1ubuntu1.1\r\nconfiguration: --cc=clang --cxx=clang++ --ld=clang --enable-debug --toolchain=clang-asan\r\nlibavutil      58. 34.100 / 58. 34.100\r\nlibavcodec     60. 35.100 / 60. 35.100\r\nlibavformat    60. 18.100 / 60. 18.100\r\nlibavdevice    60.  4.100 / 60.  4.100\r\nlibavfilter     9. 14.100 /  9. 14.100\r\nlibswscale      7.  6.100 /  7.  6.100\r\nlibswresample   4. 13.100 /  4. 13.100\r\n}}}\r\nCredit:\r\n{{{\r\nDiscovered by Zeng Yunxiang.\r\n}}}\r\nThanks for your time!","id":10753,"keywords":"bugs","owner":"","priority":"important","reporter":"frankZ","reproduced":"0","resolution":"fixed","status":"closed","summary":"heap-buffer-overflow at libavfilter/f_reverse.c:269:26 in areverse_request_frame in FFmpeg","time":"2023-12-21T13:33:30Z","type":"defect","version":"git-master"};
      var changes=[{"author":"frankZ","comment":"POC file","comment_history":{"0":{"author":"frankZ","comment":"POC file","date":1703165639402518}},"date":1703165639402518,"fields":{"attachment":{"label":"Attachment","new":"poc16ffmpeg","old":"","rendered":"\"\u2192 \\u003cspan class=\\\"trac-field-new\\\"\\u003epoc16ffmpeg\\u003c/span\\u003e\""}},"permanent":0},{"author":"michael","cnum":1,"comment":"Fixed by 61e73851a33f0b4cb7662f8578a4695e77bd3c19","comment_history":{"0":{"author":"michael","comment":"Fixed by 61e73851a33f0b4cb7662f8578a4695e77bd3c19","date":1703894322124887}},"date":1703894322124887,"fields":{"resolution":{"label":"Resolution","new":"fixed","old":"","rendered":"\"\u2192 \\u003cspan class=\\\"trac-field-new\\\"\\u003efixed\\u003c/span\\u003e\""},"status":{"label":"Status","new":"closed","old":"new","rendered":"\"\\u003cspan class=\\\"trac-field-old\\\"\\u003enew\\u003c/span\\u003e \u2192 \\u003cspan class=\\\"trac-field-new\\\"\\u003eclosed\\u003c/span\\u003e\""}},"permanent":1}];
      var auto_preview_timeout=2.0;
      var form_token="5cc8e352205c61067abfa952";
      var jquery_ui={"ampm":true,"date_format":"M d, yy","day_names":{"abbreviated":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],"narrow":["S","M","T","W","T","F","S"],"wide":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},"default_timezone":0,"first_week_day":0,"month_names":{"abbreviated":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wide":["January","February","March","April","May","June","July","August","September","October","November","December"]},"period_names":{"am":["AM","AM"],"pm":["PM","PM"]},"show_timezone":false,"time_format":"h:mm:ss TT","timepicker_separator":", ","timezone_iso8601":false,"timezone_list":null};
      var tags={"autocomplete_field":"field-keywords","help_href":null,"help_new_window":false,"keywords":["\"keep","-","-map","-t","-tmcd",".ape",".yuv","/","10","100i","1088","2-pass","2024","264_metadata","3.3.2","302","3221225725","3gpp","404","60000","8","AAC","AIF","AMF","APE","AVI","AVS2","Atmos","Audio","Audiotoolbox","Broken","Build","CC_IDENT","CHUNK","CLosed-caption","CP1252","CSS","ChromaLocation","Crop","D3D11","DASH","DNxHD","DTS","Error","FFREPORT","FFmpeg","FLAC","FPE","G723_1","GPMF","H264","HDS","HLS","HTML","Hevc","ICY","ID3","ID3v2","IDR","IMX","Intel","LCW2","LEAD","LTO","Lyra","METADATA","MP3","MQA","MXF","Metadata","NUT","NVDEC","NVENC","NewTek","No","Non-monotonic","Non-monotonous","Nvidia","OOM","OPUS","PGS","QSV","RDP","RIFF","RTMP","RTP","RTSP","ReplayGain","Rext","SAP","SCTE-35","SDL2","SEEK","SEGFAULT","SIGSEGV","STF","SVQ1","Static","Suffix","TARGETDURATION","TIF","TMCD","Tag","VAAPI","VBK","VPP_QSV","Version","WAV","Widevine","Win32;","Windows","YUV4MPEG2","ZyGo","a","a12v","aac","aax","abort","ac3","ac4","acrossfade","adpcm","aes","afade","aja","alac","alimiter","alive\"","alpha","als","alsa","altivec","amd","amf","amovie","amr","amr_nb","amrnb","amrp","analyzeduration","android","anim","animation","ansi","anull","anullsrc","ape","apng","apple","aptx","arm","art","artifact","asegment","asf","asp","aspect","ass","assertion","astats","astreamselect","async","atmos","atrac","atrac3","atrac3p","audio","audio/video","audiotoolbox","auth","auto","av1","av1_amf","av1_nvenc","av_get_token","av_interleaved_write_frame","av_log","avc","avchroma","avcodec","avfilter","avfoundation","avi","avid","avio","avio_close_dir","avio_open_dir","avio_skip","avisynth","b_adapt","big-endian","binary","bit","bitexact","bitrate","bk2","black","blackmagic","blueiris","blur","bluray","books","bounce","bounty","bpg","bsf","buffer","buffersink","bugs","build","build;","building","bwdif","bytes","cache","caf","callback","caption","capture","carbon","cavs","cc","cc1","cdxl","centos","cfhd","cfr","channel_layout","channelmap","channels","chapters","checksum","chromakey","chunk","clang","clipping","cllc","closed","clv","cmyk","codecpar","coder","colon","color_primaries","color_trc","colorhold","colorspace","command","comment","compilation","compile","concat","concatenate","configuration","conversion","convert","convertion","cook","cookie","copy","copyts","corrupted","coverrect","crash","crc","creation","creation_time","crop","cropdetect","cropping","csf","css","csv","cts","cuda","cues","cursor","curve","curves","cuts","cuvid","d3d11va","d3d12va","dash","dashdec","dashencoder","data","dca","ddagrab","dead","deadlock","debug","decimate","decklink","decode","decoder","decoding","default","delay","demuxer","denoise","deshake","desync","detelecine","device","dicom","direct3d","directio","directshow","disable-x86asm","disconnected","discontinuity","disposition","dither","dithering","divx","djgpp","dn","dnxhd","dnxhr","doc","docs","documentation","dolby_e","dovi","downmix","dplii","dpx","drawtext","drm","drmeter","drop","dropouts","ds2","dshow","dss","dts","dtsshift","dual","duplicate","duration","dv","dvb_subtitle","dvb_teletext","dvbsub","dvcpro50","dvd","dvdsub","dvdsubdec","dvvideo","dwab","dxva2","dynaudnorm","eac3","ease_of_use","easy","ebur128","editlist","edl","edts","eia-608","electronicarts","email","encoder","encoding","encrypt","eof","eq","equirect","error","examples","exif","exit","expression","exr","facebook","failed","faststart","fate","fateclient","fault","fec","fedora","ffjni","ffmetadata","ffmpeg","ffmpeg-vaapi","ffplay","ffpreset","ffprobe","ffreport","ffrprobe","ffserver","fftools","ffv1","ffv1_vulkan","ffvvc","file","filename","filter","filter_complex","filtering","filters","fits","flac","flic","flif","flite","flv","fmp4","font","force_key_frames","format","formatting","fps","fps_mode","frame","frame_num","frame_pts","framerate","frames","framesync","freeze","freezing","frei0r","fsb","fuzz","fuzzer","fuzzing","g722","g726","g729","gamma","gapless","gaps","gaussian","gblur","gdigrab","gif","glob","global","gmp4","gnutls","gpu","gradfun","granule","grayscale","gsm","gsoc","gxf","h.264","h261","h263","h264","h264_amf","h264_mmal","h264_nvenc","h264_omx","h264_qsv","h264_vaapi","h264_vulkan","h265","haiku","handbrake","hang","hardware","hdcd","hdr","header","header.","headers","heif","help","hevc","hevc_amf","hevc_cuvid","hevc_nvenc","hevc_vaapi","hevc_videotoolbox","hevc_vulkan","histogram","hls","htmlsubtitles","http","http_proxy","https","huge","hv60","hw_decode","hwaccel","hwcontext_qsv","hwdownload","hwupload","hwupload_qsv","i686","iXML","iac","id","id3","id3v1","id3v2","iec61883","ieee1394","iff","image2","images","indeo3","indeo4","init","initialization","input","intel","interlaced","interrupt","ios","ip","is","ismindex","itsoffset","ivalid","j2k","jack","join","jpeg2000","jpegls","jump","keyframe","kitty","klfs","klv","kmsgrab","kodi","lame","language","latency","latm","lavf","lavfi","leading","leak","lensfun","libaom","libaom-av1","libass","libatomic","libav","libcdio","libfdk-aac","libiec61883","libjxl","libmp3lame","libndi","libopenh264","libopenjpeg","libopenmpt","libopus","libplacebo","librtmp","libsrt","libsvtav1","libvidstab","libvmaf","libvorbis","libvpx","libx264","libx265","libxvid","libzvbi","linear","links","live","ljpeg","log","logging","login","loglevel","lookahead","loop","loss","lossless","loudness","loudnorm","lowres","lrc","lto","lut3d","lxf","lyrics","m2v","m3u8","m4a","m4b","m4v","macos","manifest","map","matroska","matrox","max_interleave_delta","maxrate","mbedtls","mcdeint","mdec","media","mediacodec","mediafoundation","memleak","memory","mesa","mestimate","metadata","mingw","mips","mismatch","misplaced","missing","mitchell","mjpeg","mka","mkv","mlp","mlv","mmal","mms","mmsh","mmst","monkey's","mosaic","mouse","mov","mov_text","movement","movie","movtomp4","mp1","mp2","mp3","mp4","mp4a","mpc","mpeg2_vaapi","mpeg2video","mpeg4","mpeg4ssp","mpegps","mpegts","mpegtsraw","mpegvideo","mpfilter","mpg123","mpjpeg","mpjpegdec","mpv","msc","msmpeg4","msvc","msvideo1","multi-client","multiple","multivariante","muxer","muxer:","muxing","mvc","mxf","nasm","native","network","nlmeans","nodisp","noexec","nokey","non-existing","normalization","normalize","npp","nsv","null","nullsrc","nut","nvdec","nvenc","nvidia","ocr","ogg","oma","omx","on2avc","oom","op1a","openCL","openal","opencl","opencv","opengl","opus","opw","order","osx","outreachy","overflow","overlay","packed","packet","pad","paf","pal8","palettegen","paletteuse","pan","pass","password","pat","pattern_type","pause","pcm_dvd","pcm_s16le","pcm_s24le","pcm_u8","performance","perspective","pgssub","photocd","pipe","pixels","pixfmt","pkg-config","pkt_duration","plain-text","playback","pmf","pmp","pmt","png","pngdec","pos","postprocessing","powerpc","ppc","ppc64el","premiere","preset","probe","prompeg","prores","protocol","proxy","psf2","psnr","pts","pulldown","pulseaudio","qclp","qcp","qdm2","qdraw","qmax","qmin","qmv","qscale","qsv","qtkit","quality","quick","quicksync","quicktime","r3d","ra28","race","range","rawvideo","rdft","real","reconnect","rectilinear","redirection","reencode","reference","refs","regression","remux","render","report","resampling","resolv","resources","reverb","rfc6381","rhel","rhozet","riff","rotate","rounding","roundup","rpl","rpuenc","rtcp","rtm","rtmp","rtmpe","rtmps","rtp","rtsp","rv10","rv20","rv30","rv40","rw_timeout","s12m","s302m","s337m","sanm","sar","saturation","sbr","scale","scale_cuda","scale_qsv","scaling","scenecut","scpr","screen","screencasting","sdk","sdl","sdp","sdp_file","search","security","seek","seeking","segment","select","sendcmd","separator","sequence","series","server","setpts","sfd","shader","sharpen","sharpen_npp","shorten","shortest","shoutcast","showcqt","showcwt","showspectrumpic","showwaves","showwavespic","shq","sighup","sigint","signaling","signature","sigpipe","silicon","sipr","skip","slide","slideshow","slow","slower","smaf","smartblur","smpl","smush","sn40","snow","sofdec","solaris","spdif","speedhq","speedhqenc","speex","srt","srtdec","srtp","ssegment","ssim","stack-overflow","start_time_realtime","status","stdin","stdout","stream","stream_loop","stream_map","streaming","streamselect","stsd","studio","sub","sub-rip","submitting","subrip","subtitle","subtitles","subviewer","sup","surfaces","svq3","swf","swr_convert","sws_dither","sws_flags","swscale","symbol","sync","synchronous","system;","tags","targa","tcp","tee","template","terminology","test","texi","textfile","thd","the","theora","thumbnail","tif","tiff","time","timecode","timeline","timeout","timescale","timestamp","tiny_psnr","title","tls","tmpdir","to","tpad","track","tracks","tracwiki","transform.trf","transparent","transpose","trim","truehd","truncation","tsan","tta","tunneled","twitch","tx3g","typo","ubsan","udp","underflow","unicode","unix-socket","unsharp","unsupported","url","uspp","ustream","utf16","v360","v4l","v4l2","v4l2loopback","v4l2m2m","va-api","vaapi","variance","vbr","vbv","vc1","vce","vda","vdom","vdpau","vfr","vfwcap","via","video","video4linux2","videolan","videotoolbox","vidstabdetect","vimeo","visual","vobsub","volume","volumedetect","vorbis","voxware","vp3","vp6","vp7","vp8","vp9","vpp_qsv","vqavideo","vs2015","vsx","vsync","vulkan","vvc","wav","waveform","wavpack","webcam","webm","webp","webvtt","wiki","wiki-redirect","win","win10","win32","windows","winrt","with","wma","wmalossless","wmapro","wmav2","wmavoice","wmserver","wmv2","wmv3","wrap","wtv","x11grab","x264","x265","x86","xHE-AAC","xerror","xfade","xml","xmv","xsub","xvba","xvid","xyz","y4v","yadif","youtube","yuv","yuv2rgb","yuv420p","yuv420p10le","yuv422p10le","zip","zmq","zoompan","zvr"],"match_from_start":"","separator":" "};
    </script>
    <script src="/chrome/common/js/jquery.js"></script>
    <script src="/chrome/common/js/babel.js"></script>
    <script src="/chrome/common/js/trac.js"></script>
    <script src="/chrome/common/js/search.js"></script>
    <script src="/chrome/common/js/folding.js"></script>
    <script src="/chrome/common/js/wikitoolbar.js"></script>
    <script src="/chrome/common/js/resizer.js"></script>
    <script src="/chrome/common/js/auto_preview.js"></script>
    <script src="/chrome/common/js/jquery-ui.js"></script>
    <script src="/chrome/common/js/jquery-ui-addons.js"></script>
    <script src="/chrome/common/js/jquery-ui-i18n.js"></script>
    <script src="/chrome/tags/js/autocomplete_tags.js"></script>
    <script>
      jQuery(function($) {
        $(".trac-autofocus").focus();
        $(".trac-target-new").attr("target", "_blank");
        if ($.ui) { /* is jquery-ui added? */
          $(".trac-datepicker:not([readonly])")
            .prop("autocomplete", "off").datepicker();
          // Input current date when today is pressed.
          var _goToToday = $.datepicker._gotoToday;
          $.datepicker._gotoToday = function(id) {
            _goToToday.call(this, id);
            this._selectDate(id)
          };
          $(".trac-datetimepicker:not([readonly])")
            .prop("autocomplete", "off").datetimepicker();
        }
        $(".trac-disable").disableSubmit(".trac-disable-determinant");
        setTimeout(function() { $(".trac-scroll").scrollToTop() }, 1);
        $(".trac-disable-on-submit").disableOnSubmit();
      });
    </script>
    <!--   # include 'site_head.html' (layout.html) -->
    <!--   end of site_head.html -->
    <!-- # endblock head (content inherited from layout.html) -->


    <script src="/chrome/common/js/threaded_comments.js"></script>
    <script>
      jQuery(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6")
          .addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
        $("#attachments").toggleClass("collapsed");
        $("#trac-up-attachments").click(function () {
          $("#attachments").removeClass("collapsed");
          return true;
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() {
          $("#modify").parent().removeClass("collapsed");
        });

        function setRevertHandler() {
          $("button.trac-revert").click(function() {
            var div = $("div", this);
            var field_name = div[0].id.substr(7);
            var field_value = div.text();
            var input = $("#propertyform *[name=field_" + field_name + "]");
            if (input.length > 0) {
              if (input.filter("input[type=radio]").length > 0) {
                input.val([field_value]);
              } else if (input.filter("input[type=checkbox]").length > 0) {
                input.val(field_value == "1" ? [field_value] : []);
              } else {
                input.val(field_value);
              }
            } else { // Special case for CC checkbox
              input = $("#propertyform input[name=cc_update]").val([]);
            }
            input.change();
            // Remove the revert button
            if ($(this).closest("tbody").children("tr").length === 1)
              $(this).closest(".trac-change-panel").remove();
            else
              $(this).closest("tr").remove();
            return false;
          });
        }
        setRevertHandler();

        var comment_focused = false;
        $("#comment").focus(function() { comment_focused = true; })
                     .blur(function() { comment_focused = false; });
        $("#propertyform").autoSubmit({preview: '1'}, function(data, reply) {
          var items = $(reply);
          // Update ticket box
          $("#ticket").replaceWith(items.filter('#ticket'));
          // Replaces content of #changelog, without recreating it
          $("#changelog").empty().append(items.filter("#changelog").contents());
          // Apply comments order and "Show" preferences
          applyCommentsOrder(
            $('#prefs input[name="trac-comments-order"]:checked').val());
          // Show warnings
          var new_changes = $("#changelog .trac-new");
          $("#trac-edit-warning").toggle(new_changes.length != 0);
          if (new_changes.length != 0)
            $("#changelog").parent().show().removeClass("collapsed");
          $("#trac-preview-warning").remove();
          $("#trac-edit-warning").before(items.filter('#trac-preview-warning'));
          // Update view time
          $("#propertyform input[name='view_time']")
            .replaceWith(items.filter("input[name='view_time']"));
          // Update preview
          var preview = $("#ticketchange")
            .html(items.filter('#preview').children());
          var show_preview = preview.children().length != 0;
          $("#ticketchange").toggle(show_preview);
          setRevertHandler();
          // Execute scripts to load stylesheets
          items.filter("script").appendTo("head");
        }, "#ticketchange .trac-loading");
        $("#trac-comment-editor")
            .autoSubmit({preview_comment: '1'}, function(data, reply) {
          var comment = $("#trac-comment-editor")
            .next("div.comment").html(reply);
          comment.toggle(comment.children().length != 0);
        }, "#changelog .trac-loading");

      });
    </script>
    <!-- # endblock head (placeholder in theme.html) -->
  </head> 
  <body>
    <!-- # block body (content inherited from theme.html) -->
    <!--   # include 'site_header.html' (theme.html) -->
    <!--   end of site_header.html -->

    <div id="banner">
      <div id="header">
        <a id="logo"
           href="https://ffmpeg.org">
          <img  alt="FFmpeg" src="/ffmpeg-logo.png" /></a>


      </div>
      <form id="search" action="/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18"
                  value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
          <div id="metanav" class="nav">
      <ul><li  class="first"><a href="/login">Login</a></li><li ><a href="/prefs">Preferences</a></li><li ><a href="/wiki/TracGuide">Help/Guide</a></li><li ><a href="/about">About Trac</a></li><li ><a href="/register">Register</a></li><li  class="last"><a href="/reset_password">Forgot your password?</a></li></ul>
    </div>

    </div>
        <div id="mainnav" class="nav">
      <ul><li  class="first"><a href="/wiki">Wiki</a></li><li ><a href="/timeline">Timeline</a></li><li  class="active"><a href="/report">View Tickets</a></li><li ><a href="/search">Search</a></li><li  class="last"><a accesskey="T" href="/tags">Tags</a></li></ul>
    </div>


    <div id="main"
         >
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li  class="first"><span id="vote" title="Vote count"><img alt="Up-vote" src="/chrome/vote/aupgray.png" /><span id="votes">+0</span><img alt="Down-vote" src="/chrome/vote/adowngray.png" /></span></li>
          <li ><span>&larr; <a class="prev" href="/ticket/10752" title="Ticket #10752">Previous Ticket</a></span></li>
          <li  class="last"><span><a class="next" href="/ticket/10754" title="Ticket #10754">Next Ticket</a> &rarr;</span></li>
        </ul>
        <hr />
      </div>

      

      

      <!-- # block content (placeholder in theme.html) -->
    <div id="content" class="ticket">



<div id="ticket">
  <div id="ticketbox" class="trac-content">
    <div class="date">
      <p>Opened <a class="timeline" href="/timeline?from=2023-12-21T13%3A33%3A30Z&amp;precision=second" title="See timeline at Dec 21, 2023, 1:33:30 PM">13 months ago</a></p>
      <p>Closed <a class="timeline" href="/timeline?from=2023-12-29T23%3A58%3A42Z&amp;precision=second" title="See timeline at Dec 29, 2023, 11:58:42 PM">13 months ago</a></p>
    </div>


    <h2>
      <a href="/ticket/10753" class="trac-id">#10753</a>
      <span class="trac-status">
        <a href="/query?status=closed">closed</a>
      </span>
      <span class="trac-type">
        <a href="/query?status=!closed&amp;type=defect">defect</a>
      </span>
      <span class="trac-resolution">
        (<a href="/query?resolution=fixed&amp;status=closed">fixed</a>)
      </span>
    </h2>

    <h1 id="trac-ticket-title" class="searchable">
      <span class="summary">heap-buffer-overflow at libavfilter/f_reverse.c:269:26 in areverse_request_frame in FFmpeg</span>
    </h1>

    <table class="properties">

      <tr>
        <th id="h_reporter">Reported by:</th>
        <td class="searchable" headers="h_reporter"><a class="trac-author" href="/query?reporter=frankZ&amp;status=!closed">ZengYunxiang</a></td>

        <th id="h_owner" class="missing">Owned by:</th>
        <td headers="h_owner"></td>
      </tr>
      <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
          <a href="/query?priority=important&amp;status=!closed">important</a>
        </td>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
          <a href="/query?component=avfilter&amp;status=!closed">avfilter</a>
        </td>
      </tr>
      <tr>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
          <a href="/query?status=!closed&amp;version=git-master">git-master</a>
        </td>
        <th id="h_keywords">
          Keywords:
        </th>
        <td class="searchable" headers="h_keywords">
          <a href="/query?keywords=~bugs&amp;status=!closed">bugs</a>
        </td>
      </tr>
      <tr>
        <th id="h_cc">
          Cc:
        </th>
        <td class="searchable" headers="h_cc">
          <a href="/query?cc=~frankZ&amp;status=!closed">ZengYunxiang</a>
        </td>
        <th class="missing" id="h_blockedby">
          Blocked By:
        </th>
        <td headers="h_blockedby">
        </td>
      </tr>
      <tr>
        <th class="missing" id="h_blocking">
          Blocking:
        </th>
        <td headers="h_blocking">
        </td>
        <th id="h_reproduced">
          Reproduced by developer:
        </th>
        <td headers="h_reproduced">
          <a href="/query?reproduced=0&amp;status=!closed">no</a>
        </td>
      </tr>
      <tr>
        <th id="h_analyzed">
          Analyzed by developer:
        </th>
        <td headers="h_analyzed">
          <a href="/query?analyzed=0&amp;status=!closed">no</a>
        </td>
        <th class="missing">
        </th>
        <td>
        </td>
      </tr>
    </table>
    <div class="description">
      <h2 id="comment:description">Description
      </h2>



      <script>
        // float left elements like inlinebuttons will be presented in
        // right-to-left order, i.e. those added before #addreply will
        // be on the right, those added after will be on the left
        function insertNearReplyToDescription(content, side) {
          if (side === 'right') {
            $("#ticket .description #addreply").before(content);
          } else if (side === 'rightmost') {
            $("#ticket .description > h2").after(content);
          } else if (side === 'leftmost') {
            $("#ticket .description").children(".searchable, br")
              .before(content);
          } else { // 'left'
            $("#ticket .description #addreply").after(content);
          }
        }
      </script>

      <div class="searchable">
        <p>
Summary of the bug:<br />
</p>
<p>
Dear developers, <br />
</p>
<p>
We found the following heap-buffer-overflow bug on FFmpeg(version N-113007-g8d24a28d06) when using areverse filter, please confirm.<br />
</p>
<p>
The poc file(poc16ffmpeg) will be attached to this ticket.<br />
</p>
<p>
How to reproduce:<br />
</p>
<pre class="wiki">git clone https://github.com/FFmpeg/FFmpeg.git ffmpeg
cd ffmpeg
./configure --cc=clang --cxx=clang++ --ld=clang --enable-debug --toolchain=clang-asan
make -j30

./ffmpeg_g -y -i poc16ffmpeg -filter_complex areverse tmp.mp4
</pre><p>
ASAN Log:<br />
</p>
<pre class="wiki">=================================================================x
==809032==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61e000017290 at pc 0x55c70e479a45 bp 0x7f58adff8e90 sp 0x7f58adff8e88
READ of size 8 at 0x61e000017290 thread T2 (fc0)
    #0 0x55c70e479a44 in areverse_request_frame /ffmpeg/libavfilter/f_reverse.c:269:26
    #1 0x55c70e44a2f6 in ff_request_frame_to_filter /ffmpeg/libavfilter/avfilter.c:482:15
    #2 0x55c70e446560 in ff_filter_activate_default /ffmpeg/libavfilter/avfilter.c:1194:20
    #3 0x55c70e446560 in ff_filter_activate /ffmpeg/libavfilter/avfilter.c:1341:11
    #4 0x55c70e455860 in get_frame_internal /ffmpeg/libavfilter/buffersink.c:139:19
    #5 0x55c70e452ff0 in avfilter_graph_request_oldest /ffmpeg/libavfilter/avfiltergraph.c:1306:17
    #6 0x55c70e350344 in read_frames /ffmpeg/fftools/ffmpeg_filter.c:2426:15
    #7 0x55c70e346e28 in filter_thread /ffmpeg/fftools/ffmpeg_filter.c:2819:15
    #8 0x55c70e388c18 in task_wrapper /ffmpeg/fftools/ffmpeg_sched.c:2200:21
    #9 0x7f58b09e0ac2  (/lib/x86_64-linux-gnu/libc.so.6+0x94ac2) (BuildId: a43bfc8428df6623cd498c9c0caeb91aec9be4f9)
    #10 0x7f58b0a72a3f  (/lib/x86_64-linux-gnu/libc.so.6+0x126a3f) (BuildId: a43bfc8428df6623cd498c9c0caeb91aec9be4f9)

0x61e000017296 is located 0 bytes to the right of 2582-byte region [0x61e000016880,0x61e000017296)
allocated by thread T2 (fc0) here:
    #0 0x55c70e2ebf46 in __interceptor_realloc (/ffmpeg/ffmpeg_g+0x923f46) (BuildId: 8d6ccf457a75d047d11f9627d0b67208c2215c8c)
    #1 0x55c711958aee in av_realloc /ffmpeg/libavutil/mem.c:162:11
    #2 0x55c711958aee in av_fast_realloc /ffmpeg/libavutil/mem.c:513:11

Thread T2 (fc0) created by T0 here:
    #0 0x55c70e2d4f9c in __interceptor_pthread_create (/ffmpeg/ffmpeg_g+0x90cf9c) (BuildId: 8d6ccf457a75d047d11f9627d0b67208c2215c8c)
    #1 0x55c70e383161 in task_start /ffmpeg/fftools/ffmpeg_sched.c:403:11
    #2 0x55c70e3a1e68 in transcode /ffmpeg/fftools/ffmpeg.c:922:11
    #3 0x55c70e3a1e68 in main /ffmpeg/fftools/ffmpeg.c:1050:11
    #4 0x7f58b0975d8f  (/lib/x86_64-linux-gnu/libc.so.6+0x29d8f) (BuildId: a43bfc8428df6623cd498c9c0caeb91aec9be4f9)

SUMMARY: AddressSanitizer: heap-buffer-overflow /ffmpeg/libavfilter/f_reverse.c:269:26 in areverse_request_frame
Shadow bytes around the buggy address:
  0x0c3c7fffae00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3c7fffae10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3c7fffae20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3c7fffae30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3c7fffae40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=&gt;0x0c3c7fffae50: 00 00[06]fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c3c7fffae60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c3c7fffae70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c3c7fffae80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c3c7fffae90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c3c7fffaea0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==809032==ABORTING
</pre><p>
ffmpeg version:<br />
</p>
<pre class="wiki"># ./ffmpeg -version
ffmpeg version N-113007-g8d24a28d06 Copyright (c) 2000-2023 the FFmpeg developers
built with Ubuntu clang version 14.0.0-1ubuntu1.1
configuration: --cc=clang --cxx=clang++ --ld=clang --enable-debug --toolchain=clang-asan
libavutil      58. 34.100 / 58. 34.100
libavcodec     60. 35.100 / 60. 35.100
libavformat    60. 18.100 / 60. 18.100
libavdevice    60.  4.100 / 60.  4.100
libavfilter     9. 14.100 /  9. 14.100
libswscale      7.  6.100 /  7.  6.100
libswresample   4. 13.100 /  4. 13.100
</pre><p>
Credit:<br />
</p>
<pre class="wiki">Discovered by Zeng Yunxiang.
</pre><p>
Thanks for your time!<br />
</p>

      </div>
    </div>
  </div>
</div>






<div id="attachments">
  <h3  class="foldable">
    Attachments
    <span class="trac-count">(1)</span></h3>
  <div class="attachments">
    <dl class="attachments">
      <dt><a href="/attachment/ticket/10753/poc16ffmpeg" title="View attachment">poc16ffmpeg</a><a href="/raw-attachment/ticket/10753/poc16ffmpeg"
          class="trac-rawlink" title="Download">&#8203;</a>
 (<span title="300581 bytes">293.5 KB</span>
) - added by <span class="trac-author">ZengYunxiang</span> <a class="timeline" href="/timeline?from=2023-12-21T13%3A33%3A59Z&amp;precision=second" title="See timeline at Dec 21, 2023, 1:33:59 PM">13 months ago</a>.</dt>
      <dd>POC file</dd>
    </dl>
    <p>
  Download all attachments as:
  <a rel="nofollow" href="/zip-attachment/ticket/10753/">.zip</a>
</p>




  </div>
</div>
      <div>
        <div class="trac-noscript" style="position: relative">
          <form id="prefs" method="get" action="/prefs"
                style="position: absolute; right: 0">
            <div id="trac-comments-order">
              <input type="radio" id="trac-comments-oldest"
                     name="trac-comments-order" value="oldest"
                     checked="checked" />
              <label for="trac-comments-oldest">Oldest first</label>
              <input type="radio" id="trac-comments-newest"
                     name="trac-comments-order" value="newest" />
              <label for="trac-comments-newest">Newest first</label>
              <span id="trac-threaded-toggle" style="display: none">
                <input type="radio" id="trac-comments-threaded"
                       name="trac-comments-order" value="threaded" />
                <label for="trac-comments-threaded">Threaded</label>
              </span>
            </div>
            <div>
              <input id="trac-show-comments-toggle" type="checkbox"
                     checked="checked" />
              <label for="trac-show-comments-toggle">Show comments</label>
              <input id="trac-show-property-changes-toggle" type="checkbox" />
              <label for="trac-show-property-changes-toggle">
                Show property changes</label>
            </div>
          </form>
        </div>

        <h3 class="foldable">
          Change History
          <span class="trac-count">(2)</span></h3>

        <div id="changelog">
          <div class="change">






<h3 class="change">
  <span class="threading">
  </span>
  by <span class="trac-author">ZengYunxiang</span>, <a class="timeline" href="/timeline?from=2023-12-21T13%3A33%3A59Z&amp;precision=second" title="See timeline at Dec 21, 2023, 1:33:59 PM">13 months ago</a>

</h3>

<div class="trac-change-panel">



  <div class="trac-ticket-buttons">
  </div>


  <table class="changes">


    <tr class="trac-field-attachment">
      <th class="trac-field-attachment">Attachment:</th>
      <td>
        <a href="/attachment/ticket/10753/poc16ffmpeg"><em>poc16ffmpeg</em></a><a href="/raw-attachment/ticket/10753/poc16ffmpeg"
                                  title="Download"
                                  class="trac-rawlink">&#8203;</a>
 added      </td>
    </tr>
  </table>
</div>





<div class="comment searchable">
  <p>
POC file<br />
</p>

</div>
          </div>
          <div class="change" id="trac-change-1-1703894322124887">






<h3 class="change" id="comment:1">
  <span class="threading">
  </span>
  <span class="cnum"><a href="#comment:1" class="">comment:1</a>
</span>
  by <span class="trac-author">Michael Niedermayer</span>, <a class="timeline" href="/timeline?from=2023-12-29T23%3A58%3A42Z&amp;precision=second" title="See timeline at Dec 29, 2023, 11:58:42 PM">13 months ago</a>

</h3>

<div class="trac-change-panel">



  <div class="trac-ticket-buttons">
  </div>


  <table class="changes">


    <tr class="trac-field-resolution">
      <th class="trac-field-resolution">Resolution:</th>
      <td>
        → <span class="trac-field-new">fixed</span>
      </td>
    </tr>

    <tr class="trac-field-status">
      <th class="trac-field-status">Status:</th>
      <td>
        <span class="trac-field-old">new</span> → <span class="trac-field-new">closed</span>
      </td>
    </tr>
  </table>
</div>





<div class="comment searchable">
  <p>
Fixed by <a class="changeset" href="/changeset/61e73851a33f0b4cb7662f8578a4695e77bd3c19/ffmpeg" title="avfilter/f_reverse: Apply PTS compensation only when pts is available
 ...">61e73851a33f0b4cb7662f8578a4695e77bd3c19</a><br />
</p>

</div>
          </div>
          <script>
            // inlinebuttons in ticket change are presented in
            // left-to-right order, i.e. those added before
            // #reply-to-comment-n will be on its left, those added
            // after will be on its right
            function insertNearReplyToComment(num, content, side) {
              var $replyto = $("#reply-to-comment-" + num);
              if (side === 'right') {
                $replyto.after(content);
              } else if (side === 'rightmost') {
                $replyto.parent().append(content);
              } else if (side === 'leftmost') {
                $replyto.parent().prepend(content);
              } else { // 'left'
                $replyto.before(content);
              }
            }
          </script>

        </div>
      </div>


<div class="trac-help">
  <strong>Note:</strong>
 See   <a href="/wiki/TracTickets">TracTickets</a>
 for help on using tickets.
</div>
    </div>
        <!-- # block content (content inherited from layout.html) -->
    <script type="text/javascript">
      jQuery("body").addClass("trac-has-js");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/ticket/10753?format=rss"
              class="rss">
            RSS Feed</a>
        </li>
        <li class="">
          <a rel="nofollow" href="/ticket/10753?format=csv"
              class="csv">
            Comma-delimited Text</a>
        </li>
        <li class="last">
          <a rel="nofollow" href="/ticket/10753?format=tab"
              class="tab">
            Tab-delimited Text</a>
        </li>
      </ul>
    </div>
    <!-- # endblock content (content inherited from layout.html) -->

      <!-- # endblock content (placeholder in theme.html) -->
    </div>

    <div id="footer"><hr/>
      <a id="tracpowered" href="https://trac.edgewall.org/"
         ><img src="/chrome/common/trac_logo_mini.png" height="30"
               width="107" alt="Trac Powered"/></a>
      <p class="left">
Powered by         <a href="/about"><strong>Trac 1.6</strong></a>
        <br />
 By         <a href="http://www.edgewall.org/">Edgewall Software</a>
.      </p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
    <!--   # include 'site_footer.html' (theme.html) -->
    <!--   end of site_footer.html -->
    <!-- # endblock body (content inherited from theme.html) -->
  </body> </html>