The provided content relates to CVE-2021-47336.

**Root cause of vulnerability:**
The vulnerability stems from a missing check in the `smk_set_cipso()` function within the Smack security module. Specifically, the check for `count > SMK_CIPSOMAX` was only applied when the format was `SMK_FIXED24_FMT`, but not for other formats, allowing a user-provided `count` value to exceed the buffer size leading to a potential memory corruption via `memdup_user_nul`.

**Weaknesses/vulnerabilities present:**
- Inadequate input validation in `smk_set_cipso()`
- Missing bounds check for user-provided 'count' when format is not `SMK_FIXED24_FMT`
- Potential buffer overflow due to `memdup_user_nul` with an out-of-bounds `count` value.

**Impact of exploitation:**
- Potential for memory corruption.
- Possible denial of service, and/or arbitrary code execution.

**Attack vectors:**
- A local attacker can exploit the vulnerability by writing to a smackfs file with a crafted `count` value to `smk_set_cipso()` using formats other than `SMK_FIXED24_FMT`.

**Required attacker capabilities/position:**
- The attacker needs to be a local user with the ability to write to a smackfs file.