- **Root cause of vulnerability**: The system log, which is normally accessible via the authenticated web UI, becomes accessible without authentication at `https://<router ip>/messages` after an authenticated user has exported the log at least once during the current power cycle of the device.
- **Weaknesses/vulnerabilities present**: Information disclosure due to lack of proper access control on the `/messages` endpoint after an authenticated user has triggered log export.
- **Impact of exploitation**: An attacker can retrieve sensitive information from the device's system log, including details about the deviceâ€™s interfaces, process lists, and errors.
- **Attack vectors**: By sending an HTTP request to `https://<router ip>/messages`, an unauthenticated attacker on the network can access the system log.
- **Required attacker capabilities/position**: The attacker needs to be on the same network as the vulnerable D-LINK DIR-3040 device and the system log must have been exported at least once since the last device power cycle by an authenticated user.