Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**
The root cause of the vulnerability is a memory leak in the `nf_tables_addchain()` function within the Linux kernel's netfilter subsystem. This leak occurs when the `nft_chain_offload_priority()` function returns an error, leading to the per-cpu memory allocated for chain statistics (`stats`) not being freed. The issue was introduced by commit 3bc158f8d0330f0a ("netfilter: nf_tables: map basechain priority to hardware priority").

**Weaknesses/Vulnerabilities:**
- **Memory Leak:** The primary vulnerability is a memory leak of per-cpu memory. When the function `nft_chain_offload_priority()` fails, the allocated per-cpu memory pointed to by 'stats' is not freed. This memory is allocated for tracking chain statistics.

**Impact of Exploitation:**
- **Resource Exhaustion:** Repeatedly triggering the error condition in `nft_chain_offload_priority()` will cause a continuous memory leak. This can lead to resource exhaustion, potentially causing the system to become unstable or crash.

**Attack Vectors:**
- The attack vector involves creating nftables chains in a way that causes `nft_chain_offload_priority()` to return an error. The exact conditions causing this error are not explicitly specified, but they likely involve setting invalid or unsupported configurations that would be caught during the priority mapping phase.

**Required Attacker Capabilities/Position:**
- The attacker requires the ability to configure nftables, which typically requires root or administrative privileges.

**Technical Details:**
- The fix involves adding `free_percpu(stats)` to the error handling path in `nf_tables_addchain()`:
```diff
--- a/net/netfilter/nf_tables_api.c
+++ b/net/netfilter/nf_tables_api.c
@@ -2148,6 +2148,7 @@
 	if (err < 0) {
 		nft_chain_release_hook(&hook);
 		kfree(basechain);
+		free_percpu(stats);
 		return err;
 	}
```
The `free_percpu(stats)` call ensures that the per-cpu memory is released when an error occurs, preventing the memory leak.
- The commit messages in the provided data consistently reference the same issue and solution, confirming the nature of the vulnerability and its fix.