
[Docs Overview](/docs/ "Documentation Overview")
[Project](/docs/projdocs.html)
[Bug Bounty](/docs/bugbounty.html)
[Bug Report](/docs/bugs.html)
[Code of conduct](/docs/code-of-conduct.html)
[Dependencies](/docs/libs.html)
[Donate](/donation.html)
[FAQ](/docs/faq.html)
[Features](/docs/features.html)
[Governance](/docs/governance.html)
[History](/docs/history.html)
[Install](/docs/install.html)
[Known Bugs](/docs/knownbugs.html)
[Logo](/logo/)
[TODO](/docs/todo.html)
[website Info](/about.html)

[Protocols](/docs/protdocs.html)
[CA Extract](/docs/caextract.html)
[HTTP cookies](/docs/http-cookies.html)
[HTTP/3](/docs/http3.html)
[MQTT](/docs/mqtt.html)
[SSL certs](/docs/sslcerts.html)
[SSL libs compared](/docs/ssl-compared.html)
[URL syntax](/docs/url-syntax.html)
[WebSocket](/docs/websocket.html)

[Releases](/docs/reldocs.html)
[Changelog](/ch/)
[curl CVEs](/docs/security.html)
[Release Table](/docs/releases.html)
[Version Numbering](/docs/versions.html)
[Vulnerabilities](/docs/vulnerabilities.html)

[Tool](/docs/tooldocs.html)
[Comparison Table](/docs/comparison-table.html)
[curl man page](/docs/manpage.html)
[HTTP Scripting](/docs/httpscripting.html)
[mk-ca-bundle](/docs/mk-ca-bundle.html)
[Tutorial](/docs/tutorial.html)
[When options were added](optionswhen.html)

[Who and Why](/docs/whodocs.html)
[Companies](/docs/companies.html)
[Copyright](/docs/copyright.html)
[Sponsors](/sponsors.html)
[Thanks](/docs/thanks.html)
[The name](/docs/thename.html)

[curl](/) / [Docs](/docs/) / [curl CVEs](/docs/security.html) / **macidn punycode buffer overread**
**Related:**

[Audits](audits.html)

[Bug Bounty](/docs/bugbounty.html)

[Changelog](/ch/)

[curl CVEs](security.html)

[JSON metadata](CVE-2024-6874.json)

[Original report](https://hackerone.com/reports/2604391)

[Vulnerability Disclosure](/dev/vuln-disclosure.html)

[Vulnerabilities Table](vulnerabilities.html)

Awarded 540 USD

## CVE-2024-6874

# macidn punycode buffer overread

Project curl Security Advisory, July 24th 2024 - [Permalink](https://curl.se/docs/CVE-2024-6874.html)

## VULNERABILITY

libcurl's URL API function [curl\_url\_get()](https://curl.se/libcurl/c/curl_url_get.html)
offers punycode conversions, to and from IDN. Asking to convert a name
that is exactly 256 bytes, libcurl ends up reading outside of a stack
based buffer when built to use the *macidn* IDN backend. The
conversion function then fills up the provided buffer exactly - but does
not null terminate the string.

This flaw can lead to stack contents accidentally getting returned as
part of the converted string.

## INFO

This bug was introduced curl [8.8.0](vuln-8.8.0.html) release and is considered a *C
mistake* (likely to have been avoided had we not been using C).

This flaw does not affect the curl command line tool.

The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2024-6874 to this issue.

CWE-126: Buffer Over-read

Severity: Low

## AFFECTED VERSIONS

The vulnerable code can only be reached when curl is built to use
macidn, the native IDN conversion library bundled with Apple's operating
systems: macOS, iOS, ipadOS etc. Builds using other IDN backends are not
vulnerable.

* Affected version: curl [8.8.0](vuln-8.8.0.html)
* Not affected versions: curl < [8.8.0](vuln-8.8.0.html) and >= [8.9.0](vuln-8.9.0.html)
* Introduced-in: <https://github.com/curl/curl/commit/add22feeef07858307be57>

libcurl is used by many applications, but not always advertised as
such!

## SOLUTION

* Fixed-in: <https://github.com/curl/curl/commit/686d54baf1df6e0775>

## RECOMMENDATIONS

We suggest you take one of the following actions immediately, in
order of preference:

A - Upgrade curl and libcurl to version [8.9.0](vuln-8.9.0.html)

B - Apply the patch to your version and rebuild

C - Build your libcurl with an unaffected IDN backend

## TIMELINE

This issue was reported to the curl project on July 16, 2024.

curl [8.9.0](vuln-8.9.0.html) was released on July 24 2024 around 06:00 UTC, coordinated
with the publication of this advisory.

## CREDITS

* Reported-by: z2\_
* Patched-by: z2\_

Thanks a lot!

