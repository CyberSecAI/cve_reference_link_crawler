- **Root cause of vulnerability**: The Greybus UART driver did not correctly manage the lifetime of its internal state, specifically when a tty device was closed. User space could hold a tty device open indefinitely, while the driver could release the associated data structures before the last user was gone.
- **Weaknesses/vulnerabilities present**: Use-after-free vulnerability. The driver could free the memory associated with the greybus tty state while it was still in use by the tty subsystem.
- **Impact of exploitation**: A use-after-free can lead to arbitrary code execution by corrupting memory. It can also crash the system.
- **Attack vectors**: A user-space application opens a tty device associated with the greybus UART driver. Then the application closes the device after the greybus device is disconnected, triggering the use-after-free if the driver does not properly manage the reference count.
- **Required attacker capabilities/position**: An attacker needs to be able to open and close tty devices and have some control over the lifecycle of the associated greybus device. This could be a local user with access to a system where a greybus uart device is connected.