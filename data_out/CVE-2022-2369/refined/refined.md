Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

*   The YaySMTP plugin lacks capability checks for an AJAX action, specifically `yaysmtp_email_logs`. This means that the plugin does not verify if the user initiating the AJAX request has the necessary permissions to access the email logs.

**Weaknesses/Vulnerabilities Present:**

*   **Missing Authorization:** The primary vulnerability is the absence of proper authorization checks. Any logged-in user, including those with minimal privileges such as a subscriber, can trigger the vulnerable AJAX action.
*   **Insecure AJAX endpoint:** The `admin-ajax.php` endpoint is used without proper access control, leading to the vulnerability.

**Impact of Exploitation:**

*   **Information Disclosure:**  A low-privileged user (e.g., a subscriber) can view the email logs of the plugin. This may contain sensitive information depending on the content of the logs, potentially including email addresses, subjects, and message details.

**Attack Vectors:**

*   **Network-based:** The attack is performed by sending a crafted HTTP POST request to the vulnerable AJAX endpoint (`/wp-admin/admin-ajax.php`).

**Required Attacker Capabilities/Position:**

*   **Logged-in User:** The attacker must have an active account on the WordPress site. Even a subscriber-level account is sufficient to exploit this vulnerability.
*   **Network Access:** The attacker needs to be able to make HTTP requests to the target WordPress site.

**Technical Details:**

*   The vulnerability is triggered by sending a POST request to `/wp-admin/admin-ajax.php` with the following data:
    *   `action=yaysmtp_email_logs`
    *   `nonce=<valid nonce>`
    *   `params[page]=1`
    *   `params[limit]=10`
*   The provided python script shows how to obtain the required nonce by logging into the target site and how to send the malicious request.

**Additional Notes:**
*   The vulnerability is classified as "NO AUTHORISATION"
*   The vulnerability is fixed in version 2.2.1 of the plugin.
*   The vulnerability is categorized under OWASP Top 10 as "A5: Broken Access Control" and CWE-862
*   The CVSS score is 4.3 (Medium) with vector string CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N