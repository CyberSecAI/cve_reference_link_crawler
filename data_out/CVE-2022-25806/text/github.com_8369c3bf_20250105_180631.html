
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fatredispartners%2Fadvisories%2Fblob%2Fmaster%2FATREDIS-2022-0002.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fatredispartners%2Fadvisories%2Fblob%2Fmaster%2FATREDIS-2022-0002.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=atredispartners%2Fadvisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[atredispartners](/atredispartners)
/
**[advisories](/atredispartners/advisories)**
Public

* [Notifications](/login?return_to=%2Fatredispartners%2Fadvisories) You must be signed in to change notification settings
* [Fork
  11](/login?return_to=%2Fatredispartners%2Fadvisories)
* [Star
   54](/login?return_to=%2Fatredispartners%2Fadvisories)

* [Code](/atredispartners/advisories)
* [Issues
  0](/atredispartners/advisories/issues)
* [Pull requests
  0](/atredispartners/advisories/pulls)
* [Actions](/atredispartners/advisories/actions)
* [Projects
  0](/atredispartners/advisories/projects)
* [Security](/atredispartners/advisories/security)
* [Insights](/atredispartners/advisories/pulse)

Additional navigation options

* [Code](/atredispartners/advisories)
* [Issues](/atredispartners/advisories/issues)
* [Pull requests](/atredispartners/advisories/pulls)
* [Actions](/atredispartners/advisories/actions)
* [Projects](/atredispartners/advisories/projects)
* [Security](/atredispartners/advisories/security)
* [Insights](/atredispartners/advisories/pulse)

## Files

 master
## Breadcrumbs

1. [advisories](/atredispartners/advisories/tree/master)
/
# ATREDIS-2022-0002.md

 Blame  Blame
## Latest commit

## History

[History](/atredispartners/advisories/commits/master/ATREDIS-2022-0002.md)157 lines (125 loc) · 6.54 KB master
## Breadcrumbs

1. [advisories](/atredispartners/advisories/tree/master)
/
# ATREDIS-2022-0002.md

Top
## File metadata and controls

* Preview
* Code
* Blame

157 lines (125 loc) · 6.54 KB[Raw](https://github.com/atredispartners/advisories/raw/refs/heads/master/ATREDIS-2022-0002.md)
# Multiple Vulnerabilities in IGEL Universal Management Suite (UMS) v6.07.100

## Vendors

* IGEL

## Affected Products

* Universal Management Suite (UMS) v6.07.100

## Summary

### Superuser/database credentials stored in the HKEY\_LOCAL\_MACHINE registry

IGEL UMS v6.07.100 stores superuser/database credentials in the `HKEY_LOCAL_MACHINE` registry, which allows a low-privileged attacker with Operating System (OS) access to read the encrypted dbpassword value.

### Hardcoded DES key in PrefDBCredentials

A hardcoded DES key in the PrefDBCredentials class in IGEL UMS v6.07.100 allows an attacker with access to an encrypted dbpassword value to decrypt the password and gain superuser/database access to IGEL UMS and its database.

### Transmission of Plaintext Lightweight Directory Access Protocol (LDAP) bind credentials

IGEL UMS v6.07.100 exposes Lightweight Directory Access Protocol (LDAP) bind credentials in encrypted and plaintext forms, which allows a remote, authenticated attacker to obtain access to those credentials.

### Hardcoded DES key in LDAPDesPWEncrypter

A hardcoded DES key in the `LDAPDesPWEncrypter` class in IGEL UMS v6.07.100 allows an attacker with access to encrypted LDAP bind credentials to decrypt the password and obtain access to plaintext LDAP bind credentials.

## Remediation/Mitigation

There are currently no patches to address the findings disclosed here. However, the vendor has provided the following mitigation instructions:

### Superuser/database credentials stored in the HKEY\_LOCAL\_MACHINE registry

Make the UMS Server host accessible only to users that need to access UMS.

### Hardcoded DES key in PrefDBCredentials

Keep UMS database and its backups under strict access control.

### Transmission of Plaintext Lightweight Directory Access Protocol (LDAP) bind credentials

Only use TLS-secured variant of LDAP access.

### Hardcoded DES key in LDAPDesPWEncrypter

Keep UMS database and its backups under strict access control.

## Credit

This issue was found by Nick Nam of Atredis Partners

## References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-25804>
* <https://nvd.nist.gov/vuln/detail/CVE-2022-25805>
* <https://nvd.nist.gov/vuln/detail/CVE-2022-25806>
* <https://nvd.nist.gov/vuln/detail/CVE-2022-25807>
* <https://github.com/atredispartners/advisories/ATREDIS-2022-0002.md>
* <https://www.igel.com/igel-solution-family/universal-management-suite/>
* <https://kb.igel.com/securitysafety/en/isn-2022-13-ums-vulnerabilities-60982590.html>

## Report Timeline

* 2022-01-05: Atredis Partners sent an initial notification to vendor.
* 2022-01-06: Atredis Partners asks vendor for a status update.
* 2022-02-14: Atredis Partners asks vendor for a status update while notifying of pending CVE submission.
* 2022-02-14: Vendor sends GPG key and requests vulnerability details.
* 2022-02-15: Vendor confirms receipt of initial notification and requests advisory.
* 2022-02-16: Atredis Partners sends a draft advisory to vendor.
* 2022-02-18: Vendor requests a disclosure timeline extension and agrees to extend until May 20, 2022.
* 2022-02-23: Vendor provides update on remediation progress.
* 2022-03-04: Vendor and Atredis Partners discuss possible remediation steps.
* 2022-05-20: Atredis Partners requests remediation and mitigation details for public disclosures.
* 2022-05-20: Vendor confirms that vulnerabilities have not been remediated and provides mitigation instructions.
* 2022-05-23: Atredis published this advisory.

## Technical Details

### Superuser/database credentials stored in the HKEY\_LOCAL\_MACHINE registry

The `de.igel.rm.config.PrefDBCredentials` class in `RMGUI.jar` is used to encrypt and decrypt credentials for the UMS superuser. On the Windows operating system, the stored credentials are located in the registry at `HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Prefs\de\igel\rm\config\serverconfig` as `dbuser` and `dbpassword` values.

### Hardcoded DES key the `PrefDBCredentials`

`PrefDBCredentials` instantiates a static byte array with 8 bytes and uses that array as the cryptographic key for the encryption and decryption of the `dbpassword` value.

```
  private static byte[] mat = new byte[] { 5, -88, -123, -1, -10, 52, -28, 70 };

  private Encrypter pwCrypt = (Encrypter)new DESEncrypter(mat);
...
  public String getPassword() {
    String ePw = ServerConfig.getInstance().getValue(ServerConfigParam.dbuserpassword);
    if (ePw == null)
      return null;
    return this.pwCrypt.decrypt(ePw);
  }
...
  public void storePassword(String newPw) {
    try {
      if (newPw == null)
        newPw = "";
      ServerConfig serverConfig = ServerConfig.getInstance();
      if (serverConfig != null) {
        serverConfig.setValue(ServerConfigParam.dbuserpassword, this.pwCrypt.encrypt(newPw));
        serverConfig.flush();
      }
    } catch (BackingStoreException e) {
      log.error(e.getLocalizedMessage(), e);
    }
  }
```

### Transmission of Plaintext Lightweight Directory Access Protocol (LDAP) bind credentials

The `cmd_mgt_load_mgt_tree` command instructs UMS to return data of type `de.igel.rm.mgt.common.data.MgtTreeData` that includes `de.igel.rm.mgt.common.data.ADRootMasterData`. `de.igel.rm.mgt.common.data.ADRootMasterData` contains Active Directory (AD) configuration data including the bind credentials used to search AD.

```
POST /servlet/RMServPut HTTP/1.1
Content-Type: application/json
User-Agent: Java/1.8.0_311
Host: 10.0.0.1:8443
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: close
Content-Length: 115
Cookie: JSESSIONID=8898B3CD46BF8C9686DBFDA246FA8DFD

{
    "host": "10.0.0.1",
    "user": "igelums",
    "password": "the_plaintext_password",
    "command": "cmd_mgt_load_mgt_tree",
    "jackson": ""
}
```

### Hardcoded DES key in LDAPDesPWEncrypter

The AD bind password is encrypted using DES and an 8 byte static key that is known to both UMS and the UMS Console.

```
public class LDAPDesPWEncrypter {
  private static final Log log = LogFactory.getLog(LDAPDesPWEncrypter.class);

  private static byte[] keymaterial = new byte[] { 123, -12, -55, 10, -1, 85, -28, -98 };

  public static String encrypt(String pw) {
    if (pw == null)
      return null;
    try {
      return (new DESEncrypter(keymaterial)).encrypt(pw);
    } catch (GeneralSecurityException e) {
      log.error(e);
      return pw;
    }
  }

  public static String decrypt(String storedPw) {
    if (storedPw == null)
      return null;
    try {
      return (new DESEncrypter(keymaterial)).decrypt(storedPw);
    } catch (GeneralSecurityException e) {
      log.error(e);
      return storedPw;
    }
  }
}
```

`de.igel.rm.ldap.LDAPDesPWEncrypter`

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

