Based on the provided information, here's an analysis of CVE-2023-47114:

**Root Cause of Vulnerability:**
The vulnerability stems from a lack of input validation when generating HTML-formatted Data Subject Rights (DSR) packages in the Fides web application. Data retrieved from connected systems and data stores was directly included in the generated HTML reports without proper sanitization.

**Weaknesses/Vulnerabilities Present:**
- **HTML Injection:** The core vulnerability is an HTML injection flaw (CWE-79). This occurs because user-controlled data from connected systems and data stores is included in the generated HTML output without sanitization. This lack of validation allows an attacker to embed arbitrary HTML code into the DSR package.

**Impact of Exploitation:**
- **Phishing Attacks:** A malicious user could inject HTML that could be used for phishing.
- **Malicious JavaScript Execution:** An attacker could inject malicious JavaScript that would execute when a user opens the HTML files in their browser. The attacker would be limited by the fact that the files are accessed via the `file://` protocol (and not from a website).

**Attack Vectors:**
- **Rogue Admin UI users:** An admin user in the Fides application could approve requests containing malicious data.
- **Malicious connected system / data store users:** A compromised or malicious connected system/data store could inject malicious data into DSRs.
- **Social Engineering:** A data subject user could be tricked into submitting malicious data through a social engineering attack.

**Required Attacker Capabilities/Position:**
- The attacker needs the ability to influence the data that is included in the DSR package. This can be achieved through the following scenarios:
    - Having administrative privileges in the Fides application.
    - Having control over a connected system or data store.
    - Tricking a user into submitting malicious data as part of a data request.

**Additional Notes:**
- The vulnerability only affects deployments configured to use `html` as the package format. Using `json` or `csv` mitigates this issue.
- The fix involved enabling Jinja2's autoescape feature to properly sanitize HTML within the generated reports.
- The vulnerability was reported by RobertKeyser and h0wl.