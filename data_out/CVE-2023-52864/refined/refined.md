The provided content relates to CVE-2023-52864.

**Root cause of vulnerability:**
The vulnerability arises from a flaw in the `wmi_char_open` function within the Linux kernel's WMI driver. Prior to the fix, the driver used the file's `dentry` name to identify the associated WMI device. However, due to changes introduced by commit fa1f68db6ca7, the `filp->private_data` field is no longer NULL when `wmi_char_open()` is called, because the miscdevice now stores a pointer to itself. This could lead to `wmi_char_open` failing to locate the correct driver and potentially using a different driver with the same name or causing memory corruption. This could occur if the WMI device is deleted via `wmi_free_devices()`.

**Weaknesses/vulnerabilities present:**
- Incorrect driver lookup: The `wmi_char_open` function was not correctly retrieving the WMI device data.
- Potential memory corruption: If the driver is not found, it might lead to memory corruption when trying to access the driver data.
- Use of file path: The driver was incorrectly using the file's path to get the driver, which is unreliable.

**Impact of exploitation:**
- Memory corruption:  A malicious actor can potentially trigger memory corruption by opening a char device associated with a WMI device that has been freed
- Incorrect driver usage: Opening a WMI device might lead to unintended operations.

**Attack vectors:**
- Opening a char device: This is the primary method to trigger the vulnerability.

**Required attacker capabilities/position:**
- The attacker needs to be able to open a character device associated with the WMI driver.