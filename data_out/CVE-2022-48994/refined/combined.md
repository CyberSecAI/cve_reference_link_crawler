=== Content from git.kernel.org_5c981f5d_20250110_132923.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e385360705a0b346bdb57ce938249175d0613b8a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e385360705a0b346bdb57ce938249175d0613b8a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e385360705a0b346bdb57ce938249175d0613b8a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e385360705a0b346bdb57ce938249175d0613b8a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2022-11-18 15:23:50 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-12-14 11:26:12 +0100 |
| commit | [e385360705a0b346bdb57ce938249175d0613b8a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e385360705a0b346bdb57ce938249175d0613b8a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e385360705a0b346bdb57ce938249175d0613b8a)) | |
| tree | [60674c741932383a04b7644281fe4cfe52b63fe0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e385360705a0b346bdb57ce938249175d0613b8a) | |
| parent | [992a37d814809e9ea9e10f387f4e86c09e8e3ba9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=992a37d814809e9ea9e10f387f4e86c09e8e3ba9) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e385360705a0b346bdb57ce938249175d0613b8a&id2=992a37d814809e9ea9e10f387f4e86c09e8e3ba9)) | |
| download | [linux-e385360705a0b346bdb57ce938249175d0613b8a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e385360705a0b346bdb57ce938249175d0613b8a.tar.gz) | |

ALSA: seq: Fix function prototype mismatch in snd\_seq\_expand\_var\_event[ Upstream commit 05530ef7cf7c7d700f6753f058999b1b5099a026 ]
With clang's kernel control flow integrity (kCFI, CONFIG\_CFI\_CLANG),
indirect call targets are validated against the expected function
pointer prototype to make sure the call target is valid to help mitigate
ROP attacks. If they are not identical, there is a failure at run time,
which manifests as either a kernel panic or thread getting killed.
seq\_copy\_in\_user() and seq\_copy\_in\_kernel() did not have prototypes
matching snd\_seq\_dump\_func\_t. Adjust this and remove the casts. There
are not resulting binary output differences.
This was found as a result of Clang's new -Wcast-function-type-strict
flag, which is more sensitive than the simpler -Wcast-function-type,
which only checks for type width mismatches.
Reported-by: kernel test robot <lkp@intel.com>
Link: [https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp@intel.com](https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp%40intel.com)
Cc: Jaroslav Kysela <perex@perex.cz>
Cc: Takashi Iwai <tiwai@suse.com>
Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Cc: alsa-devel@alsa-project.org
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: [https://lore.kernel.org/r/20221118232346.never.380-kees@kernel.org](https://lore.kernel.org/r/20221118232346.never.380-kees%40kernel.org)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e385360705a0b346bdb57ce938249175d0613b8a)

| -rw-r--r-- | [sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_memory.c?id=e385360705a0b346bdb57ce938249175d0613b8a) | 11 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 4 deletions

| diff --git a/sound/core/seq/seq\_memory.c b/sound/core/seq/seq\_memory.cindex ab1112e90f88db..6f413c711535e0 100644--- a/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=992a37d814809e9ea9e10f387f4e86c09e8e3ba9)+++ b/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=e385360705a0b346bdb57ce938249175d0613b8a)@@ -126,15 +126,19 @@ EXPORT\_SYMBOL(snd\_seq\_dump\_var\_event); \* expand the variable length event to linear buffer space. \*/ -static int seq\_copy\_in\_kernel(char \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_kernel(void \*ptr, void \*src, int size) {+ char \*\*bufptr = ptr;+ memcpy(\*bufptr, src, size); \*bufptr += size; return 0; } -static int seq\_copy\_in\_user(char \_\_user \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_user(void \*ptr, void \*src, int size) {+ char \_\_user \*\*bufptr = ptr;+ if (copy\_to\_user(\*bufptr, src, size)) return -EFAULT; \*bufptr += size;@@ -163,8 +167,7 @@ int snd\_seq\_expand\_var\_event(const struct snd\_seq\_event \*event, int count, char return newlen; } err = snd\_seq\_dump\_var\_event(event,- in\_kernel ? (snd\_seq\_dump\_func\_t)seq\_copy\_in\_kernel :- (snd\_seq\_dump\_func\_t)seq\_copy\_in\_user,+ in\_kernel ? seq\_copy\_in\_kernel : seq\_copy\_in\_user, &buf); return err < 0 ? err : newlen; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:28:01 +0000



=== Content from git.kernel.org_a723ad28_20250110_132917.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=05530ef7cf7c7d700f6753f058999b1b5099a026)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=05530ef7cf7c7d700f6753f058999b1b5099a026)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=05530ef7cf7c7d700f6753f058999b1b5099a026)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=05530ef7cf7c7d700f6753f058999b1b5099a026)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2022-11-18 15:23:50 -0800 |
| --- | --- | --- |
| committer | Takashi Iwai <tiwai@suse.de> | 2022-11-19 09:20:11 +0100 |
| commit | [05530ef7cf7c7d700f6753f058999b1b5099a026](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=05530ef7cf7c7d700f6753f058999b1b5099a026) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=05530ef7cf7c7d700f6753f058999b1b5099a026)) | |
| tree | [b4f0e3f1dbc81ac8fc2c224eaf33a3596a759caa](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=05530ef7cf7c7d700f6753f058999b1b5099a026) | |
| parent | [1abfd71ee8f3ed99c5d0df5d9843a360541d6808](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1abfd71ee8f3ed99c5d0df5d9843a360541d6808) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=05530ef7cf7c7d700f6753f058999b1b5099a026&id2=1abfd71ee8f3ed99c5d0df5d9843a360541d6808)) | |
| download | [linux-05530ef7cf7c7d700f6753f058999b1b5099a026.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-05530ef7cf7c7d700f6753f058999b1b5099a026.tar.gz) | |

ALSA: seq: Fix function prototype mismatch in snd\_seq\_expand\_var\_eventWith clang's kernel control flow integrity (kCFI, CONFIG\_CFI\_CLANG),
indirect call targets are validated against the expected function
pointer prototype to make sure the call target is valid to help mitigate
ROP attacks. If they are not identical, there is a failure at run time,
which manifests as either a kernel panic or thread getting killed.
seq\_copy\_in\_user() and seq\_copy\_in\_kernel() did not have prototypes
matching snd\_seq\_dump\_func\_t. Adjust this and remove the casts. There
are not resulting binary output differences.
This was found as a result of Clang's new -Wcast-function-type-strict
flag, which is more sensitive than the simpler -Wcast-function-type,
which only checks for type width mismatches.
Reported-by: kernel test robot <lkp@intel.com>
Link: [https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp@intel.com](https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp%40intel.com)
Cc: Jaroslav Kysela <perex@perex.cz>
Cc: Takashi Iwai <tiwai@suse.com>
Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Cc: alsa-devel@alsa-project.org
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: [https://lore.kernel.org/r/20221118232346.never.380-kees@kernel.org](https://lore.kernel.org/r/20221118232346.never.380-kees%40kernel.org)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=05530ef7cf7c7d700f6753f058999b1b5099a026)

| -rw-r--r-- | [sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_memory.c?id=05530ef7cf7c7d700f6753f058999b1b5099a026) | 11 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 4 deletions

| diff --git a/sound/core/seq/seq\_memory.c b/sound/core/seq/seq\_memory.cindex b7aee23fc38765..47ef6bc30c0ee2 100644--- a/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=1abfd71ee8f3ed99c5d0df5d9843a360541d6808)+++ b/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=05530ef7cf7c7d700f6753f058999b1b5099a026)@@ -113,15 +113,19 @@ EXPORT\_SYMBOL(snd\_seq\_dump\_var\_event); \* expand the variable length event to linear buffer space. \*/ -static int seq\_copy\_in\_kernel(char \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_kernel(void \*ptr, void \*src, int size) {+ char \*\*bufptr = ptr;+ memcpy(\*bufptr, src, size); \*bufptr += size; return 0; } -static int seq\_copy\_in\_user(char \_\_user \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_user(void \*ptr, void \*src, int size) {+ char \_\_user \*\*bufptr = ptr;+ if (copy\_to\_user(\*bufptr, src, size)) return -EFAULT; \*bufptr += size;@@ -151,8 +155,7 @@ int snd\_seq\_expand\_var\_event(const struct snd\_seq\_event \*event, int count, char return newlen; } err = snd\_seq\_dump\_var\_event(event,- in\_kernel ? (snd\_seq\_dump\_func\_t)seq\_copy\_in\_kernel :- (snd\_seq\_dump\_func\_t)seq\_copy\_in\_user,+ in\_kernel ? seq\_copy\_in\_kernel : seq\_copy\_in\_user, &buf); return err < 0 ? err : newlen; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:27:54 +0000



=== Content from git.kernel.org_dbd232cb_20250110_132921.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=63badfed200219ca656968725f1a43df293ac936)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=63badfed200219ca656968725f1a43df293ac936)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=63badfed200219ca656968725f1a43df293ac936)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=63badfed200219ca656968725f1a43df293ac936)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2022-11-18 15:23:50 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-12-14 11:30:41 +0100 |
| commit | [63badfed200219ca656968725f1a43df293ac936](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=63badfed200219ca656968725f1a43df293ac936) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=63badfed200219ca656968725f1a43df293ac936)) | |
| tree | [092fe3ed38b0ab6071e0b0838a323f0ea8008724](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=63badfed200219ca656968725f1a43df293ac936) | |
| parent | [8d16d3826ff288d7e5fb97ea0d51eeadbb6bfee5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8d16d3826ff288d7e5fb97ea0d51eeadbb6bfee5) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=63badfed200219ca656968725f1a43df293ac936&id2=8d16d3826ff288d7e5fb97ea0d51eeadbb6bfee5)) | |
| download | [linux-63badfed200219ca656968725f1a43df293ac936.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-63badfed200219ca656968725f1a43df293ac936.tar.gz) | |

ALSA: seq: Fix function prototype mismatch in snd\_seq\_expand\_var\_event[ Upstream commit 05530ef7cf7c7d700f6753f058999b1b5099a026 ]
With clang's kernel control flow integrity (kCFI, CONFIG\_CFI\_CLANG),
indirect call targets are validated against the expected function
pointer prototype to make sure the call target is valid to help mitigate
ROP attacks. If they are not identical, there is a failure at run time,
which manifests as either a kernel panic or thread getting killed.
seq\_copy\_in\_user() and seq\_copy\_in\_kernel() did not have prototypes
matching snd\_seq\_dump\_func\_t. Adjust this and remove the casts. There
are not resulting binary output differences.
This was found as a result of Clang's new -Wcast-function-type-strict
flag, which is more sensitive than the simpler -Wcast-function-type,
which only checks for type width mismatches.
Reported-by: kernel test robot <lkp@intel.com>
Link: [https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp@intel.com](https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp%40intel.com)
Cc: Jaroslav Kysela <perex@perex.cz>
Cc: Takashi Iwai <tiwai@suse.com>
Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Cc: alsa-devel@alsa-project.org
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: [https://lore.kernel.org/r/20221118232346.never.380-kees@kernel.org](https://lore.kernel.org/r/20221118232346.never.380-kees%40kernel.org)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=63badfed200219ca656968725f1a43df293ac936)

| -rw-r--r-- | [sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_memory.c?id=63badfed200219ca656968725f1a43df293ac936) | 11 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 4 deletions

| diff --git a/sound/core/seq/seq\_memory.c b/sound/core/seq/seq\_memory.cindex 65db1a7c77b769..bb76a2dd0a2ff4 100644--- a/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=8d16d3826ff288d7e5fb97ea0d51eeadbb6bfee5)+++ b/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=63badfed200219ca656968725f1a43df293ac936)@@ -112,15 +112,19 @@ EXPORT\_SYMBOL(snd\_seq\_dump\_var\_event); \* expand the variable length event to linear buffer space. \*/ -static int seq\_copy\_in\_kernel(char \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_kernel(void \*ptr, void \*src, int size) {+ char \*\*bufptr = ptr;+ memcpy(\*bufptr, src, size); \*bufptr += size; return 0; } -static int seq\_copy\_in\_user(char \_\_user \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_user(void \*ptr, void \*src, int size) {+ char \_\_user \*\*bufptr = ptr;+ if (copy\_to\_user(\*bufptr, src, size)) return -EFAULT; \*bufptr += size;@@ -149,8 +153,7 @@ int snd\_seq\_expand\_var\_event(const struct snd\_seq\_event \*event, int count, char return newlen; } err = snd\_seq\_dump\_var\_event(event,- in\_kernel ? (snd\_seq\_dump\_func\_t)seq\_copy\_in\_kernel :- (snd\_seq\_dump\_func\_t)seq\_copy\_in\_user,+ in\_kernel ? seq\_copy\_in\_kernel : seq\_copy\_in\_user, &buf); return err < 0 ? err : newlen; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:27:58 +0000



=== Content from git.kernel.org_a5f14a20_20250110_132919.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2022-11-18 15:23:50 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-12-14 11:31:53 +0100 |
| commit | [15c42ab8d43acb73e2eba361ad05822c0af0ecfa](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa)) | |
| tree | [5e991fc35d661a34ac9dab76ab7d4ae908d231f2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa) | |
| parent | [d38e021416b2853b8efa71e79054b9570234431b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d38e021416b2853b8efa71e79054b9570234431b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa&id2=d38e021416b2853b8efa71e79054b9570234431b)) | |
| download | [linux-15c42ab8d43acb73e2eba361ad05822c0af0ecfa.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-15c42ab8d43acb73e2eba361ad05822c0af0ecfa.tar.gz) | |

ALSA: seq: Fix function prototype mismatch in snd\_seq\_expand\_var\_event[ Upstream commit 05530ef7cf7c7d700f6753f058999b1b5099a026 ]
With clang's kernel control flow integrity (kCFI, CONFIG\_CFI\_CLANG),
indirect call targets are validated against the expected function
pointer prototype to make sure the call target is valid to help mitigate
ROP attacks. If they are not identical, there is a failure at run time,
which manifests as either a kernel panic or thread getting killed.
seq\_copy\_in\_user() and seq\_copy\_in\_kernel() did not have prototypes
matching snd\_seq\_dump\_func\_t. Adjust this and remove the casts. There
are not resulting binary output differences.
This was found as a result of Clang's new -Wcast-function-type-strict
flag, which is more sensitive than the simpler -Wcast-function-type,
which only checks for type width mismatches.
Reported-by: kernel test robot <lkp@intel.com>
Link: [https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp@intel.com](https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp%40intel.com)
Cc: Jaroslav Kysela <perex@perex.cz>
Cc: Takashi Iwai <tiwai@suse.com>
Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Cc: alsa-devel@alsa-project.org
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: [https://lore.kernel.org/r/20221118232346.never.380-kees@kernel.org](https://lore.kernel.org/r/20221118232346.never.380-kees%40kernel.org)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa)

| -rw-r--r-- | [sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_memory.c?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa) | 11 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 4 deletions

| diff --git a/sound/core/seq/seq\_memory.c b/sound/core/seq/seq\_memory.cindex 65db1a7c77b769..bb76a2dd0a2ff4 100644--- a/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=d38e021416b2853b8efa71e79054b9570234431b)+++ b/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=15c42ab8d43acb73e2eba361ad05822c0af0ecfa)@@ -112,15 +112,19 @@ EXPORT\_SYMBOL(snd\_seq\_dump\_var\_event); \* expand the variable length event to linear buffer space. \*/ -static int seq\_copy\_in\_kernel(char \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_kernel(void \*ptr, void \*src, int size) {+ char \*\*bufptr = ptr;+ memcpy(\*bufptr, src, size); \*bufptr += size; return 0; } -static int seq\_copy\_in\_user(char \_\_user \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_user(void \*ptr, void \*src, int size) {+ char \_\_user \*\*bufptr = ptr;+ if (copy\_to\_user(\*bufptr, src, size)) return -EFAULT; \*bufptr += size;@@ -149,8 +153,7 @@ int snd\_seq\_expand\_var\_event(const struct snd\_seq\_event \*event, int count, char return newlen; } err = snd\_seq\_dump\_var\_event(event,- in\_kernel ? (snd\_seq\_dump\_func\_t)seq\_copy\_in\_kernel :- (snd\_seq\_dump\_func\_t)seq\_copy\_in\_user,+ in\_kernel ? seq\_copy\_in\_kernel : seq\_copy\_in\_user, &buf); return err < 0 ? err : newlen; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:27:56 +0000



=== Content from git.kernel.org_b4b0f4fe_20250110_132924.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fccd454129f6a0739651f7f58307cdb631fd6e89)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fccd454129f6a0739651f7f58307cdb631fd6e89)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fccd454129f6a0739651f7f58307cdb631fd6e89)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fccd454129f6a0739651f7f58307cdb631fd6e89)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2022-11-18 15:23:50 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-12-14 11:37:16 +0100 |
| commit | [fccd454129f6a0739651f7f58307cdb631fd6e89](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fccd454129f6a0739651f7f58307cdb631fd6e89) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fccd454129f6a0739651f7f58307cdb631fd6e89)) | |
| tree | [f962ab5669a88fd0a1859ab35a99b3b19082b665](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fccd454129f6a0739651f7f58307cdb631fd6e89) | |
| parent | [542a563bb75172ec66d65b367ff8a87a30a6b286](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=542a563bb75172ec66d65b367ff8a87a30a6b286) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fccd454129f6a0739651f7f58307cdb631fd6e89&id2=542a563bb75172ec66d65b367ff8a87a30a6b286)) | |
| download | [linux-fccd454129f6a0739651f7f58307cdb631fd6e89.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fccd454129f6a0739651f7f58307cdb631fd6e89.tar.gz) | |

ALSA: seq: Fix function prototype mismatch in snd\_seq\_expand\_var\_event[ Upstream commit 05530ef7cf7c7d700f6753f058999b1b5099a026 ]
With clang's kernel control flow integrity (kCFI, CONFIG\_CFI\_CLANG),
indirect call targets are validated against the expected function
pointer prototype to make sure the call target is valid to help mitigate
ROP attacks. If they are not identical, there is a failure at run time,
which manifests as either a kernel panic or thread getting killed.
seq\_copy\_in\_user() and seq\_copy\_in\_kernel() did not have prototypes
matching snd\_seq\_dump\_func\_t. Adjust this and remove the casts. There
are not resulting binary output differences.
This was found as a result of Clang's new -Wcast-function-type-strict
flag, which is more sensitive than the simpler -Wcast-function-type,
which only checks for type width mismatches.
Reported-by: kernel test robot <lkp@intel.com>
Link: [https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp@intel.com](https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp%40intel.com)
Cc: Jaroslav Kysela <perex@perex.cz>
Cc: Takashi Iwai <tiwai@suse.com>
Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Cc: alsa-devel@alsa-project.org
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: [https://lore.kernel.org/r/20221118232346.never.380-kees@kernel.org](https://lore.kernel.org/r/20221118232346.never.380-kees%40kernel.org)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fccd454129f6a0739651f7f58307cdb631fd6e89)

| -rw-r--r-- | [sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_memory.c?id=fccd454129f6a0739651f7f58307cdb631fd6e89) | 11 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 4 deletions

| diff --git a/sound/core/seq/seq\_memory.c b/sound/core/seq/seq\_memory.cindex b7aee23fc38765..47ef6bc30c0ee2 100644--- a/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=542a563bb75172ec66d65b367ff8a87a30a6b286)+++ b/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=fccd454129f6a0739651f7f58307cdb631fd6e89)@@ -113,15 +113,19 @@ EXPORT\_SYMBOL(snd\_seq\_dump\_var\_event); \* expand the variable length event to linear buffer space. \*/ -static int seq\_copy\_in\_kernel(char \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_kernel(void \*ptr, void \*src, int size) {+ char \*\*bufptr = ptr;+ memcpy(\*bufptr, src, size); \*bufptr += size; return 0; } -static int seq\_copy\_in\_user(char \_\_user \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_user(void \*ptr, void \*src, int size) {+ char \_\_user \*\*bufptr = ptr;+ if (copy\_to\_user(\*bufptr, src, size)) return -EFAULT; \*bufptr += size;@@ -151,8 +155,7 @@ int snd\_seq\_expand\_var\_event(const struct snd\_seq\_event \*event, int count, char return newlen; } err = snd\_seq\_dump\_var\_event(event,- in\_kernel ? (snd\_seq\_dump\_func\_t)seq\_copy\_in\_kernel :- (snd\_seq\_dump\_func\_t)seq\_copy\_in\_user,+ in\_kernel ? seq\_copy\_in\_kernel : seq\_copy\_in\_user, &buf); return err < 0 ? err : newlen; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:28:02 +0000



=== Content from git.kernel.org_ac11af8a_20250110_132918.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2022-11-18 15:23:50 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-12-14 11:40:47 +0100 |
| commit | [13ee8fb5410b740c8dd2867d3557c7662f7dda2d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d)) | |
| tree | [b931e208af33bc03f53334a35d094f1eee226773](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d) | |
| parent | [3d081949ca8f509d1769b15bf6fd43d843bd35f6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3d081949ca8f509d1769b15bf6fd43d843bd35f6) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d&id2=3d081949ca8f509d1769b15bf6fd43d843bd35f6)) | |
| download | [linux-13ee8fb5410b740c8dd2867d3557c7662f7dda2d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-13ee8fb5410b740c8dd2867d3557c7662f7dda2d.tar.gz) | |

ALSA: seq: Fix function prototype mismatch in snd\_seq\_expand\_var\_event[ Upstream commit 05530ef7cf7c7d700f6753f058999b1b5099a026 ]
With clang's kernel control flow integrity (kCFI, CONFIG\_CFI\_CLANG),
indirect call targets are validated against the expected function
pointer prototype to make sure the call target is valid to help mitigate
ROP attacks. If they are not identical, there is a failure at run time,
which manifests as either a kernel panic or thread getting killed.
seq\_copy\_in\_user() and seq\_copy\_in\_kernel() did not have prototypes
matching snd\_seq\_dump\_func\_t. Adjust this and remove the casts. There
are not resulting binary output differences.
This was found as a result of Clang's new -Wcast-function-type-strict
flag, which is more sensitive than the simpler -Wcast-function-type,
which only checks for type width mismatches.
Reported-by: kernel test robot <lkp@intel.com>
Link: [https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp@intel.com](https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp%40intel.com)
Cc: Jaroslav Kysela <perex@perex.cz>
Cc: Takashi Iwai <tiwai@suse.com>
Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Cc: alsa-devel@alsa-project.org
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: [https://lore.kernel.org/r/20221118232346.never.380-kees@kernel.org](https://lore.kernel.org/r/20221118232346.never.380-kees%40kernel.org)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d)

| -rw-r--r-- | [sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_memory.c?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d) | 11 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 4 deletions

| diff --git a/sound/core/seq/seq\_memory.c b/sound/core/seq/seq\_memory.cindex b7aee23fc38765..47ef6bc30c0ee2 100644--- a/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=3d081949ca8f509d1769b15bf6fd43d843bd35f6)+++ b/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=13ee8fb5410b740c8dd2867d3557c7662f7dda2d)@@ -113,15 +113,19 @@ EXPORT\_SYMBOL(snd\_seq\_dump\_var\_event); \* expand the variable length event to linear buffer space. \*/ -static int seq\_copy\_in\_kernel(char \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_kernel(void \*ptr, void \*src, int size) {+ char \*\*bufptr = ptr;+ memcpy(\*bufptr, src, size); \*bufptr += size; return 0; } -static int seq\_copy\_in\_user(char \_\_user \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_user(void \*ptr, void \*src, int size) {+ char \_\_user \*\*bufptr = ptr;+ if (copy\_to\_user(\*bufptr, src, size)) return -EFAULT; \*bufptr += size;@@ -151,8 +155,7 @@ int snd\_seq\_expand\_var\_event(const struct snd\_seq\_event \*event, int count, char return newlen; } err = snd\_seq\_dump\_var\_event(event,- in\_kernel ? (snd\_seq\_dump\_func\_t)seq\_copy\_in\_kernel :- (snd\_seq\_dump\_func\_t)seq\_copy\_in\_user,+ in\_kernel ? seq\_copy\_in\_kernel : seq\_copy\_in\_user, &buf); return err < 0 ? err : newlen; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:27:55 +0000



=== Content from git.kernel.org_227f8fe4_20250110_132922.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2022-11-18 15:23:50 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-12-14 11:24:32 +0100 |
| commit | [b38486e82ecb9f3046e0184205f6b61408fc40c9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9)) | |
| tree | [eaae8153f0b2fe31455439d2ab17bbe668ea3797](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9) | |
| parent | [25260b24cc325f9bee9786ff76cfd8e5a27c5193](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=25260b24cc325f9bee9786ff76cfd8e5a27c5193) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9&id2=25260b24cc325f9bee9786ff76cfd8e5a27c5193)) | |
| download | [linux-b38486e82ecb9f3046e0184205f6b61408fc40c9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b38486e82ecb9f3046e0184205f6b61408fc40c9.tar.gz) | |

ALSA: seq: Fix function prototype mismatch in snd\_seq\_expand\_var\_event[ Upstream commit 05530ef7cf7c7d700f6753f058999b1b5099a026 ]
With clang's kernel control flow integrity (kCFI, CONFIG\_CFI\_CLANG),
indirect call targets are validated against the expected function
pointer prototype to make sure the call target is valid to help mitigate
ROP attacks. If they are not identical, there is a failure at run time,
which manifests as either a kernel panic or thread getting killed.
seq\_copy\_in\_user() and seq\_copy\_in\_kernel() did not have prototypes
matching snd\_seq\_dump\_func\_t. Adjust this and remove the casts. There
are not resulting binary output differences.
This was found as a result of Clang's new -Wcast-function-type-strict
flag, which is more sensitive than the simpler -Wcast-function-type,
which only checks for type width mismatches.
Reported-by: kernel test robot <lkp@intel.com>
Link: [https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp@intel.com](https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp%40intel.com)
Cc: Jaroslav Kysela <perex@perex.cz>
Cc: Takashi Iwai <tiwai@suse.com>
Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Cc: alsa-devel@alsa-project.org
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: [https://lore.kernel.org/r/20221118232346.never.380-kees@kernel.org](https://lore.kernel.org/r/20221118232346.never.380-kees%40kernel.org)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b38486e82ecb9f3046e0184205f6b61408fc40c9)

| -rw-r--r-- | [sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_memory.c?id=b38486e82ecb9f3046e0184205f6b61408fc40c9) | 11 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 4 deletions

| diff --git a/sound/core/seq/seq\_memory.c b/sound/core/seq/seq\_memory.cindex 4c8cbcd898878a..42f4aa84105194 100644--- a/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=25260b24cc325f9bee9786ff76cfd8e5a27c5193)+++ b/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=b38486e82ecb9f3046e0184205f6b61408fc40c9)@@ -126,15 +126,19 @@ EXPORT\_SYMBOL(snd\_seq\_dump\_var\_event); \* expand the variable length event to linear buffer space. \*/ -static int seq\_copy\_in\_kernel(char \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_kernel(void \*ptr, void \*src, int size) {+ char \*\*bufptr = ptr;+ memcpy(\*bufptr, src, size); \*bufptr += size; return 0; } -static int seq\_copy\_in\_user(char \_\_user \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_user(void \*ptr, void \*src, int size) {+ char \_\_user \*\*bufptr = ptr;+ if (copy\_to\_user(\*bufptr, src, size)) return -EFAULT; \*bufptr += size;@@ -163,8 +167,7 @@ int snd\_seq\_expand\_var\_event(const struct snd\_seq\_event \*event, int count, char return newlen; } err = snd\_seq\_dump\_var\_event(event,- in\_kernel ? (snd\_seq\_dump\_func\_t)seq\_copy\_in\_kernel :- (snd\_seq\_dump\_func\_t)seq\_copy\_in\_user,+ in\_kernel ? seq\_copy\_in\_kernel : seq\_copy\_in\_user, &buf); return err < 0 ? err : newlen; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:27:59 +0000



=== Content from git.kernel.org_8abd9482_20250110_132920.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2022-11-18 15:23:50 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-12-14 11:28:26 +0100 |
| commit | [2f46e95bf344abc4e74f8158901d32a869e0adb6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6)) | |
| tree | [864bdc62fb27861092c481c3ba834860e1890232](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6) | |
| parent | [1a34c9c1bed8adfc005d0ab874a35bf42f274b04](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1a34c9c1bed8adfc005d0ab874a35bf42f274b04) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6&id2=1a34c9c1bed8adfc005d0ab874a35bf42f274b04)) | |
| download | [linux-2f46e95bf344abc4e74f8158901d32a869e0adb6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2f46e95bf344abc4e74f8158901d32a869e0adb6.tar.gz) | |

ALSA: seq: Fix function prototype mismatch in snd\_seq\_expand\_var\_event[ Upstream commit 05530ef7cf7c7d700f6753f058999b1b5099a026 ]
With clang's kernel control flow integrity (kCFI, CONFIG\_CFI\_CLANG),
indirect call targets are validated against the expected function
pointer prototype to make sure the call target is valid to help mitigate
ROP attacks. If they are not identical, there is a failure at run time,
which manifests as either a kernel panic or thread getting killed.
seq\_copy\_in\_user() and seq\_copy\_in\_kernel() did not have prototypes
matching snd\_seq\_dump\_func\_t. Adjust this and remove the casts. There
are not resulting binary output differences.
This was found as a result of Clang's new -Wcast-function-type-strict
flag, which is more sensitive than the simpler -Wcast-function-type,
which only checks for type width mismatches.
Reported-by: kernel test robot <lkp@intel.com>
Link: [https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp@intel.com](https://lore.kernel.org/lkml/202211041527.HD8TLSE1-lkp%40intel.com)
Cc: Jaroslav Kysela <perex@perex.cz>
Cc: Takashi Iwai <tiwai@suse.com>
Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Cc: alsa-devel@alsa-project.org
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: [https://lore.kernel.org/r/20221118232346.never.380-kees@kernel.org](https://lore.kernel.org/r/20221118232346.never.380-kees%40kernel.org)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2f46e95bf344abc4e74f8158901d32a869e0adb6)

| -rw-r--r-- | [sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_memory.c?id=2f46e95bf344abc4e74f8158901d32a869e0adb6) | 11 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 4 deletions

| diff --git a/sound/core/seq/seq\_memory.c b/sound/core/seq/seq\_memory.cindex 5b0388202bac5b..ac854beb8347e3 100644--- a/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=1a34c9c1bed8adfc005d0ab874a35bf42f274b04)+++ b/[sound/core/seq/seq\_memory.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_memory.c?id=2f46e95bf344abc4e74f8158901d32a869e0adb6)@@ -126,15 +126,19 @@ EXPORT\_SYMBOL(snd\_seq\_dump\_var\_event); \* expand the variable length event to linear buffer space. \*/ -static int seq\_copy\_in\_kernel(char \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_kernel(void \*ptr, void \*src, int size) {+ char \*\*bufptr = ptr;+ memcpy(\*bufptr, src, size); \*bufptr += size; return 0; } -static int seq\_copy\_in\_user(char \_\_user \*\*bufptr, const void \*src, int size)+static int seq\_copy\_in\_user(void \*ptr, void \*src, int size) {+ char \_\_user \*\*bufptr = ptr;+ if (copy\_to\_user(\*bufptr, src, size)) return -EFAULT; \*bufptr += size;@@ -163,8 +167,7 @@ int snd\_seq\_expand\_var\_event(const struct snd\_seq\_event \*event, int count, char return newlen; } err = snd\_seq\_dump\_var\_event(event,- in\_kernel ? (snd\_seq\_dump\_func\_t)seq\_copy\_in\_kernel :- (snd\_seq\_dump\_func\_t)seq\_copy\_in\_user,+ in\_kernel ? seq\_copy\_in\_kernel : seq\_copy\_in\_user, &buf); return err < 0 ? err : newlen; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:27:57 +0000


