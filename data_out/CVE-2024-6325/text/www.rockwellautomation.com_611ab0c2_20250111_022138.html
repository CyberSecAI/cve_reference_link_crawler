

Loading

# Unsecured Private Keys in FactoryTalk® System Services

Severity:

Low,

Medium

Advisory ID:

SD1678

Published Date:

July 02, 2024

Last Updated:

December 01, 2024

Revision Number:

1.0

Known Exploited Vulnerability (KEV):

No

Corrected:

Yes

Workaround:

No

CVE IDs

CVE-2024-6325 ,

CVE-2024-6236

Downloads

The following link(s) provide the security advisory in [Vulnerability Exploitability Exchange](https://www.cisa.gov/sites/default/files/2023-01/VEX_Use_Cases_Aprill2022.pdf) format:

JSON

JSON

Summary

Unsecured Private Keys in FactoryTalk® System Services

**Published Date**: July 11, 2024

**Last updated:** July 11, 2024

**Revision Number:** 1.0

**CVSS Score:** v3.1: 6.5/10, 5.9/10 ; v4.0: 6.0/10, 1.8/10

**AFFECTED PRODUCTS AND SOLUTION**

| Affected Product | Affected Version | Corrected Version |
| --- | --- | --- |
| FactoryTalk® System Services (installed via FTPM) | v6.40 | V6.40.01 |
| FactoryTalk® Policy Manager (FTPM) | v6.40 | V6.40.01 |

**VULNERABILITY DETAILS**

Rockwell Automation used version 3.1 and 4.0 of the CVSS scoring system to assess the following vulnerabilities.

**CVE-2024-6325 IMPACT**

The v6.40 release of FactoryTalk® Policy Managerallowedthe private keys to be insecurely stored with read and execute privileges for the Windows group, ‘Everyone’. These keys are used to generate digital certificates and pre-shared keys. This vulnerability could allow a malicious user with access to the machine to obtain private keys. If obtained, a malicious user could impersonate resources on the secured network. For customers using FactoryTalk® Policy Manager v6.40 who mitigated[CVE-2021-22681](https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1550.html) and [CVE-2022-1161](https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html) by implementing CIP security and did not update to the versions of the softwarethat contain the remediation, this vulnerability could allow a threat actor to exploit [CVE-2022-1161](https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html) and [CVE-2022-1161.](https://www.rockwellautomation.com/en-us/trust-center/security-advisories/advisory.PN1585.html)

CVSS Base Score v3.1: 6.5/10

CVSS Vector String: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N

CVSS Base Score v4.0: 6.0/10

CVSS Vector String: CVSS:4.0/AV:L/AC:L/AT:N/PR:L/UI:N/VC:N/VI:N/VA:N/SC:H/SI:N/SA:N

CWE: CWE-269 Improper Privilege Management

**CVE-2024-6236 IMPACT**

An exposure of sensitive information vulnerability exists in the FactoryTalk® System Service. A malicious user could exploit this vulnerability by starting a back-up or restore process, whichtemporarilyexposes private keys, passwords, pre-shared keys, and database folders when they are temporarily copied to an interim folder. This vulnerability is due to the lack of explicit permissions set on the backup folder. If private keys are obtained by a malicious user, they could impersonate resources on the secured network.

CVSS Base Score v3.1: 5.9/10

CVSS Vector String: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N

CVSS Base Score v4.0: 1.8/10

CVSS Vector String: CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:A/VC:N/VI:N/VA:N/SC:H/SI:N/SA:N

CWE-269 Improper Privilege Management

Known Exploited Vulnerability (KEV) database:  No

Users can use [Stakeholder-Specific Vulnerability Categorization](https://www.cisa.gov/ssvc) to generate more environment-specific prioritization.

**Mitigations and Workarounds**

Users using the affected software are encouraged to implement the following steps to invalidate the existing vulnerable private keys/digital certificates and regenerate new secure ones.

·       Clear CIP Security configurations from devices and from FactoryTalk® Policy Manager

·       Update FactoryTalk® System Services and FactoryTalk® Policy Manager to v6.40.01

·       Redeploy CIP Security Policy

Detailed steps are below **(FactoryTalk System Services (FTSS) is updated through the installation of FactoryTalk Policy Manager (FTPM)**

1)      Remove deployed security policy from all devices using FactoryTalk® Policy Manager (FTPM):

a.       Open FTPM.

b.       Document all Zone’s security settings and all Conduit’s settings as you must re-create them after updating FTPM.

c.       Change all devices port’s Policies > Zone values to the “Unassigned” Zone.

d.       Delete all zones and conduits.

e.       Deploy (CIP).  Ensure that all endpoints were reset successfully.

f.        [migrating from v6.40 only] Deploy (OPC UA).  Ensure all endpoints were reset successfully.

i.      For any OPC UA clients, perform whatever steps are required by those clients to remove the previously applied certificates.

g.       Close FTPM

2)      Delete the \FTSS\_backup folder:

a.       c:\ProgramData\Rockwell\RNAServer\Global\RnaStore\FTSS\_Backup

3)      Delete the \keystore folder:

a.       c:\ProgramData\Rockwell Automation\FactoryTalk System Services\keystore

4)      Delete any backup copies of the \keystore folder.  They will be named the same as the \keystore folder but with a suffix appended to it, like:

a.       c:\ProgramData\Rockwell Automation\FactoryTalk System Services\ keystore\_source\_2024\_04\_25\_12\_25\_38\_541566

5)      Delete the PSKs.json file:

a.       c:\ProgramData\Rockwell Automation\FactoryTalk System Services\PSKs.json

6)      Delete any backup copies of the PSKs.json file.  They will be named the same as the PSKs.json file but with a suffix appended to it, like:

a.       c:\ProgramData\Rockwell Automation\FactoryTalk System Services\ PSKs.json\_source\_2024\_05\_17\_07\_38\_25\_200356

7)      Install FactoryTalk® Policy Manager version 6.40.01.

a.       Restart the computer when prompted at the end of the install.

8)      Open FTPM.  FTPM will attempt to connect to the FactoryTalk® System Services web server before proceeding.

9)      If FTPM could not successfully connect to FactoryTalk® System Services (FTSS), it is because the FTSS service hasn’t started yet.  It will eventually start or else you can start the FTSS service manually in Windows Services.

10)   Re-create the original Zones.

11)   Move the devices from the unassigned Zone back to their original zones.

12)   Re-create the original Conduits.

13)   Deploy (CIP endpoints).

14)   [migrating from v6.40 only] Deploy (OPC UA endpoints).

a.       For any OPC UA client endpoints, manually apply the newly generated certificates from this deploy.

Additionally, we encourage customers to implement our suggested security best practices to minimize the risk of vulnerability.

·       [Security Best Practices](https://rockwellautomation.custhelp.com/app/answers/answer_view/a_id/1085012/loc/en_US#__highlight)

**ADDITIONAL RESOURCES**

·       [JSON CVE 2024 6325](https://cveawg.mitre.org/api/cve/CVE-2024-6325)

·       [JSON CVE 2024 6326](https://cveawg.mitre.org/api/cve/CVE-2024-6326)

![Rockwell Automation Home](/content/dam/rockwell-automation/sites/images/logos/2019_Logo_rgb_RA_Bug-LeftText_color.svg)
Copyright ©2022 Rockwell Automation, Inc.

1. Chevron LeftChevron Left

   [Rockwell Automation Home](https://www.rockwellautomation.com/en-us.html)
   Chevron RightChevron Right
2. Chevron LeftChevron Left

   [Trust Center](https://www.rockwellautomation.com/en-us/trust-center.html)
   Chevron RightChevron Right
3. Chevron LeftChevron Left

   [Industrial Security Adv](https://www.rockwellautomation.com/en-us/trust-center/security-advisories.html)
   Chevron RightChevron Right
4. Chevron LeftChevron Left

   Industrial Security Advisory Detail
   Chevron RightChevron Right

✕

Please update your cookie preferences to continue.

This feature requires cookies to enhance your experience. Please update your preferences to allow for these cookies:

* Social Media Cookies
* Functional Cookies
* Performance Cookies
* Marketing Cookies
* All Cookies

You can update your preferences at any time. For more information please see our {0}
[Privacy Policy](https://www.rockwellautomation.com/en-us/company/about-us/legal-notices/privacy-and-cookies-policy.html)

Cancel
Go to Cookie Settings

CloseClose

