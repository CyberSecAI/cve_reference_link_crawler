=== Content from github.com_1ddb540b_20250110_150657.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F8694)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F8694)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls)
* [Issues
  1.2k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  264](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FMbed-TLS%2Fmbedtls%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FMbed-TLS%2Fmbedtls%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# programs/ssl/ssl\_server DoS #8694

Closed

[hey3e](/hey3e) opened this issue
Jan 10, 2024
· 9 comments

Closed

# [programs/ssl/ssl\_server DoS](#top) #8694

[hey3e](/hey3e) opened this issue
Jan 10, 2024
· 9 comments

## Comments

[![@hey3e](https://avatars.githubusercontent.com/u/89211406?s=80&u=359feee63caa28a8bcaad72377935a129766cb58&v=4)](/hey3e)

Copy link

### **[hey3e](/hey3e)** commented [Jan 10, 2024](#issue-2074269016)

| Summary Send a TLS 1.3 ClientHello without extensions cause programs/ssl/ssl\_server and ssl\_server2 DoS. System information Mbed TLS version (number or commit id): 3.4.0 [f1c032a](https://github.com/Mbed-TLS/mbedtls/commit/f1c032adba124fecbb43ff52d3e08f7157ae69e1) Operating system and version: Ubuntu 22.04.2 LTS Configuration (if not default, please attach mbedtls\_config.h): #define MBEDTLS\_SSL\_PROTO\_TLS1\_3 Compiler and options (if you used a pre-built binary, please indicate how you obtained it): default Additional environment information: no Expected behavior Server continue the handshake or at least can not deny other handshakes. Actual behavior Server deny any handshake. Steps to reproduce  1. For client 1, disable tls1.3 client hello extensions. In `/library/ssl_client.c`, modify `if (propose_tls13)` to `if (!propose_tls13)` then `make`. Make client 2 default. 2. `./programs/ssl/ssl_server` 3. client 1: `./programs/ssl/ssl_client2 force_version=tls13`. Handshake failed. 4. client 2: `./programs/ssl/ssl_client2 force_version=tls13` Handshake still failed.  Additional information Similar to issue [#8654](https://github.com/Mbed-TLS/mbedtls/issues/8654). |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=80&u=10e4219c95e09cd9f903faaf7fe99ad39064afbe&v=4)](/yanesca)

Copy link

Contributor

### **[yanesca](/yanesca)** commented [Jan 12, 2024](#issuecomment-1888708302)

| Do you mean that you would expect the handshake to go through without extensions in the client hello?  Also, step 4. is identical to step 3., is that intentional? |
| --- |

All reactions

Sorry, something went wrong.

[![@hey3e](https://avatars.githubusercontent.com/u/89211406?s=80&u=359feee63caa28a8bcaad72377935a129766cb58&v=4)](/hey3e)

Copy link

Author

### **[hey3e](/hey3e)** commented [Jan 12, 2024](#issuecomment-1888898886) • edited Loading

| I can understand handshake in step 3 failed due to the lack of extensions.  However, the ClientHello of client 2 is correct, which means the handshake between server and client 2 should not fail. Apparently the server denies service. |
| --- |

All reactions

Sorry, something went wrong.

[![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=80&u=10e4219c95e09cd9f903faaf7fe99ad39064afbe&v=4)](/yanesca)

Copy link

Contributor

### **[yanesca](/yanesca)** commented [Jan 12, 2024](#issuecomment-1889226216)

| Ah, I missed that part, now I understand, thank you for explaining.  I did the steps like that:   1. compiled two clients, one default (client 2) and one not sending the hello extensions (client 1) 2. started the server (had to use certificate from a later version as the test certificate in 3.4.0 had already expired):   ./programs/ssl/ssl\_server2 debug\_level=1 force\_version=tls13 crt\_file=../mbedtls/tests/data\_files/server5.crt key\_file=../mbedtls/tests/data\_files/server5.key   3. tried to connect with the modified client (client 1)   ./programs/ssl/ssl\_client21 debug\_level=1 force\_version=tls13   4. finally tried to connect with the default one (client 2)   ./programs/ssl/ssl\_client22 debug\_level=1 force\_version=tls13  But I am getting a successful connection in step 4. Can you confirm that you can connect to the server if you skip step 3? |
| --- |

All reactions

Sorry, something went wrong.

[![@hey3e](https://avatars.githubusercontent.com/u/89211406?s=80&u=359feee63caa28a8bcaad72377935a129766cb58&v=4)](/hey3e)

Copy link

Author

### **[hey3e](/hey3e)** commented [Jan 12, 2024](#issuecomment-1889272727)

| Thanks for reply.  Yes, I repeated your steps with cert and the server still refused client 2. client 2 can connect to server if I skip step 3. Is your client 1 and client 2 on the same machine?  I saw updates in issue [#8654](https://github.com/Mbed-TLS/mbedtls/issues/8654). I believe they have some similarities. |
| --- |

All reactions

Sorry, something went wrong.

[![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=80&u=10e4219c95e09cd9f903faaf7fe99ad39064afbe&v=4)](/yanesca)

Copy link

Contributor

### **[yanesca](/yanesca)** commented [Jan 12, 2024](#issuecomment-1889301723)

| Both client 1 and client 2 are on the same machine for me.  Could you please pass `debug_level=3` to the client in step 4. and attach the outcome here in a text file? |
| --- |

 👍
1
 hey3e reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@hey3e](https://avatars.githubusercontent.com/u/89211406?s=80&u=359feee63caa28a8bcaad72377935a129766cb58&v=4)](/hey3e)

Copy link

Author

### **[hey3e](/hey3e)** commented [Jan 12, 2024](#issuecomment-1889313930) • edited Loading

| [hello\_extension.txt](https://github.com/Mbed-TLS/mbedtls/files/13920012/hello_extension.txt) |
| --- |

All reactions

Sorry, something went wrong.

[![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=80&u=10e4219c95e09cd9f903faaf7fe99ad39064afbe&v=4)](/yanesca)

Copy link

Contributor

### **[yanesca](/yanesca)** commented [Jan 12, 2024](#issuecomment-1889411367)

| Managed to reproduce it: [1873d3b](https://github.com/Mbed-TLS/mbedtls/commit/1873d3bfc2da771672bd8e7e8f41f57e0af77f33) (Mbed TLS 3.4.0) - Bug not present [f1c032a](https://github.com/Mbed-TLS/mbedtls/commit/f1c032adba124fecbb43ff52d3e08f7157ae69e1) (commit [@hey3e](https://github.com/hey3e) is using) - Bug present [edb8fec](https://github.com/Mbed-TLS/mbedtls/commit/edb8fec9882084344a314368ac7fd957a187519c) (Mbed TLS 3.5.1) - Bug present [3519cfb](https://github.com/Mbed-TLS/mbedtls/commit/3519cfb3d8d9bfb23e12e157f6fb063d1c6dc885) (development at the time of post) - Bug not present  In summary, it looks like this was a regression in 3.5.1, but has been fixed since then.  [@hey3e](https://github.com/hey3e) can you confirm that you don't experience the issue with the current development head? |
| --- |

All reactions

Sorry, something went wrong.

[![@hey3e](https://avatars.githubusercontent.com/u/89211406?s=80&u=359feee63caa28a8bcaad72377935a129766cb58&v=4)](/hey3e)

Copy link

Author

### **[hey3e](/hey3e)** commented [Jan 13, 2024](#issuecomment-1890227424) • edited Loading

| Thanks for reproduction. Why this issue happens?  The current development head does not have this issuue. |
| --- |

 👍
1
 yanesca reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=80&u=10e4219c95e09cd9f903faaf7fe99ad39064afbe&v=4)](/yanesca)

Copy link

Contributor

### **[yanesca](/yanesca)** commented [Jan 15, 2024](#issuecomment-1892027008)

| This issue was fixed in [#8595](https://github.com/Mbed-TLS/mbedtls/pull/8595) (including non-regression test). |
| --- |

 👍
1
 hey3e reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=40&u=10e4219c95e09cd9f903faaf7fe99ad39064afbe&v=4)](/yanesca)
[yanesca](/yanesca)
closed this as [completed](/Mbed-TLS/mbedtls/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jan 15, 2024](#event-11487328847)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F8694)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=52&v=4)](/yanesca) [![@hey3e](https://avatars.githubusercontent.com/u/89211406?s=52&v=4)](/hey3e)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


