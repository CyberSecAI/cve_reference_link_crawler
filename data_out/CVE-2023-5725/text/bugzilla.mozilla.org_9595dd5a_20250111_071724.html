

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1845739)
* [XML](/show_bug.cgi?ctype=xml&id=1845739)

Closed
[Bug 1845739](/show_bug.cgi?id=1845739)
(CVE-2023-5725)

Opened 1 years ago
Closed 1 year ago

# WebExtension can open Internal pages using windows.create

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

WebExtension can open Internal pages using windows.create

## Categories

### (WebExtensions :: General, defect, P2)

[Product:](/describecomponents.cgi?product=WebExtensions)

WebExtensions
▾

WebExtensions
File feature requests and bugs related to the WebExtension add-on API.
[See Open Bugs in This Product](/buglist.cgi?product=WebExtensions&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=WebExtensions)
Watch This Product

[Component:](/describecomponents.cgi?product=WebExtensions&component=General#General)

General
▾

WebExtensions :: General
All other bugs about WebExtensions
[See Open Bugs in This Component](/buglist.cgi?product=WebExtensions&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=WebExtensions&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=WebExtensions&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### (firefox-esr102 unaffected, firefox-esr115119+ fixed, firefox115 wontfix, firefox116 wontfix, firefox117 wontfix, firefox118 wontfix, firefox119+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

119 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected) |
| firefox-esr115 | [119+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=119%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix) |
| firefox117 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix) |
| firefox118 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix) |
| firefox119 | [+](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | unaffected |
| firefox-esr115 | 119+ | fixed |
| firefox-esr128 | --- | --- |
| firefox115 |  | wontfix |
| firefox116 |  | wontfix |
| firefox117 |  | wontfix |
| firefox118 |  | wontfix |
| firefox119 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

[Blocking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Blocking_Flags)

| webextensions | --- |
| --- | --- |

## People

### (Reporter: fazim.pentester, Assigned: robwu)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/30e26944b9b786ea16fce8b18394c6e4?d=mm&size=40)  [robwu](/user_profile?user_id=447061)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4894f6e6dda807a548d66213399b6dff?d=mm&size=40)  [fazim.pentester](/user_profile?user_id=720428)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/cb15f57474d95eb43c5d903ae3fa34ae?d=mm&size=40)  [rpl](/user_profile?user_id=339062)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

### (Blocks 1 open bug, Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1835484](/show_bug.cgi?id=1835484 "RESOLVED FIXED - browser.windows.create() fails when there are no windows")

[1851824](/show_bug.cgi?id=1851824 "NEW - Expand test coverage of invalid URLs in tabs.create/update / windows.create")

Dependency [tree](/showdependencytree.cgi?id=1845739&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1845739)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1711168](/show_bug.cgi?id=1711168 "RESOLVED FIXED - support extensions in web_accessible_resources")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[mozilla-hub.atlassian.net/browse/WEBE...](https://mozilla-hub.atlassian.net/browse/WEBEXT-1407 "https://mozilla-hub.atlassian.net/browse/WEBEXT-1407")

## Details

### (Keywords: regression, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main119+][adv-ESR115.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-5725

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main119+][adv-ESR115.4+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3471738_1689 "1 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (8 files)

| [poc.zip](/attachment.cgi?id=9346039)  [1 years ago](#c0)  [Shaheen Fazim](/user_profile?user_id=720428)   2.29 MB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9346039&action=edit) |
| --- | --- | --- |
| [demo.mp4](/attachment.cgi?id=9346040)  [1 years ago](#c1)  [Shaheen Fazim](/user_profile?user_id=720428)   2.59 MB, video/mp4 |  | [Details](/attachment.cgi?id=9346040&action=edit) |
| [console.png](/attachment.cgi?id=9346095)  [1 years ago](#c3)  [Shaheen Fazim](/user_profile?user_id=720428)   85.65 KB, image/png |  | [Details](/attachment.cgi?id=9346095&action=edit) |
| [exploit-demo.mp4](/attachment.cgi?id=9346114)  [1 years ago](#c4)  [Shaheen Fazim](/user_profile?user_id=720428)   1.55 MB, video/mp4 |  | [Details](/attachment.cgi?id=9346114&action=edit) |
| [exploit.zip](/attachment.cgi?id=9346115)  [1 years ago](#c5)  [Shaheen Fazim](/user_profile?user_id=720428)   1.30 MB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9346115&action=edit) |
| [Bug 1845739 - windows.create consistent with tabs.create](/attachment.cgi?id=9348836)  [1 year ago](#c9)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-esr115+](#c26 "1 year ago")  dveditz : [sec-approval+](#c12 "1 year ago") | [Details](/attachment.cgi?id=9348836&action=edit) | [Review](/attachment.cgi?id=9348836) |
| [Bug 1845739 - About test case in browser\_ext\_windows\_create\_url.js](/attachment.cgi?id=9348837)  [1 year ago](#c10)  [Rob Wu [:robwu]](/user_profile?user_id=447061)   48 bytes, text/x-phabricator-request | diannaS : [approval-mozilla-esr115+](#a5531055_690067 "1 year ago")  dveditz : [sec-approval+](#a3030621_1689 "1 year ago") | [Details](/attachment.cgi?id=9348837&action=edit) | [Review](/attachment.cgi?id=9348837) |
| [advisory.txt](/attachment.cgi?id=9359579)  [1 year ago](#c28)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   152 bytes, text/plain |  | [Details](/attachment.cgi?id=9359579&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1845739#c0)• 1 years ago |
|  | |

Attached file
[poc.zip](attachment.cgi?id=9346039)
— [Details](attachment.cgi?id=9346039&action=edit)

Using the browser.windows.open() function, a malicious WebExtension can open privileged pages like addons, about, etc., without any restrictions.

Steps to Reproduce:

1. Download and extract poc.zip to a folder
2. Open the Firefox browser and load the extracted files as WebExtention about:debugging#/runtime/this-firefox to begin testing.
Flags: sec-bounty?

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1845739#c1)• 1 years ago |
|  | |

Attached video
[demo.mp4](attachment.cgi?id=9346040)
— [Details](attachment.cgi?id=9346040&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a1013_406194)• 1 years ago |

Component: Security → GeneralProduct: Firefox → WebExtensions

|  | [Luca Greco [:rpl] [:luca] [:lgreco]](/user_profile?user_id=339062) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1845739#c2)• 1 years ago |
|  | |

Technically the behavior shown in the proof of concept looks like the currently intended behavior based on the changes applied from [Bug 1711168](/show_bug.cgi?id=1711168 "RESOLVED FIXED - support extensions in web_accessible_resources"):

* when windows.create is called with only one url, the internals can determine if the url cannot be opened with the extension principal as the triggering url and an appropriate triggering principal should be computed based on the target url (with the logic computing the triggeringPrincipal coming from <https://searchfox.org/mozilla-central/rev/00e6644d0db8acf9372702324151b8077a3d2bb7/browser/components/extensions/parent/ext-windows.js#149-167>)
* when windows.create is called with more than one urls, then the call is rejected if the extension principal is not allowed to access some of the urls passed (and the call gets rejected with a `Illegal URL...` exception)

The extensions would still be unable to access the content of the tab loading an "about:" url that it is not allowed to access, e.g. they are not allowed to inject scripts into that tab, and if I recall correctly the current behavior was chosen to allow existing (non malicious) extensions to still work after we have introduced more restrictions related to loading non web accessible moz-extension urls from other enabled extensions (in particular "windows / tabs manager" extensions).

The poc attached doesn't seem to be demonstrating an actual exploit in the current form (unless I'm misreading it), is it something achievable by combining this (currently expected) behavior with other issues?

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1845739#c3)• 1 years ago |
|  | |

Attached image
[console.png](attachment.cgi?id=9346095)
— [Details](attachment.cgi?id=9346095&action=edit)

(In reply to Luca Greco [:rpl] [:luca] [:lgreco] from [comment #2](/show_bug.cgi?id=1845739#c2 "VERIFIED FIXED - WebExtension can open Internal pages using windows.create"))

> The extensions would still be unable to access the content of the tab loading an "about:" url that it is not allowed to access, e.g. they are not allowed to inject scripts into that tab

Yes, after loading the about: URL, it is not possible to inject a script there, making it non-vulnerable in that case. However, even though I cannot inject a script, I can still log the window object (I am not sure of the security impact). This object provides access to various properties, datatype variables and methods related to the current browsing context.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1845739#c4)• 1 years ago |
|  | |

Attached video
[exploit-demo.mp4](attachment.cgi?id=9346114)
— [Details](attachment.cgi?id=9346114&action=edit)

(In reply to Luca Greco [:rpl] [:luca] [:lgreco] from [comment #2](/show_bug.cgi?id=1845739#c2 "VERIFIED FIXED - WebExtension can open Internal pages using windows.create"))

> The poc attached doesn't seem to be demonstrating an actual exploit in the current form (unless I'm misreading it), is it something achievable by combining this (currently expected) behavior with other issues?

Thank you for suggesting combining different methods. I tried using the captureVisibleTab API, and it is possible to capture screenshots of privileged pages of the victim and send them to the attacker as image data.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1845739#c5)• 1 years ago |
|  | |

Attached file
[exploit.zip](attachment.cgi?id=9346115)
— [Details](attachment.cgi?id=9346115&action=edit)

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a68149_720428)• 1 years ago |

Summary: WebExtension can open Privileged pages using windows.open → WebExtension can open Internal pages using windows.open

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a70988_720428)• 1 years ago |

Summary: WebExtension can open Internal pages using windows.open → WebExtension can open Internal pages using windows.create

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1845739#c6)• 1 years ago |
|  | |

This is a regression caused by <https://hg.mozilla.org/mozilla-central/rev/d0da1be14163>.

I'll fix this.

Assignee: nobody → robSeverity: -- → S3Status: NEW → ASSIGNEDKeywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Priority: -- → P2Regressed by: [1711168](/show_bug.cgi?id=1711168 "RESOLVED FIXED - support extensions in web_accessible_resources")See Also: → <https://mozilla-hub.atlassian.net/browse/WEBEXT-1407>

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1845739#c7)• 1 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1711168](/show_bug.cgi?id=1711168 "RESOLVED FIXED - support extensions in web_accessible_resources")

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=unaffected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a260809_695136)• 1 years ago |

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1845739#c8)• 1 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1711168](/show_bug.cgi?id=1711168 "RESOLVED FIXED - support extensions in web_accessible_resources")

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a992882_690067)• 1 year ago |

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1845739#c9)• 1 year ago |
|  | |

Attached file
[Bug 1845739 - windows.create consistent with tabs.create](attachment.cgi?id=9348836)
— [Details](attachment.cgi?id=9348836&action=edit)

This also fixes [bug 1835484](/show_bug.cgi?id=1835484 "RESOLVED FIXED - browser.windows.create() fails when there are no windows")

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1845739#c10)• 1 year ago |
|  | |

Attached file
[Bug 1845739 - About test case in browser\_ext\_windows\_create\_url.js](attachment.cgi?id=9348837)
— [Details](attachment.cgi?id=9348837&action=edit)

This also refactors the test to improve its reliability and clarity.

Previously, the "fail" test cases ran after the test signaled completion

of the test, which means that it wasn't reliable at detecting expected

failures.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a1550538_447061)• 1 year ago |

Blocks: [1835484](/show_bug.cgi?id=1835484 "RESOLVED FIXED - browser.windows.create() fails when there are no windows")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a1773832_75935)• 1 year ago |

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1845739#c11)• 1 year ago |
|  | |

Comment on [attachment 9348836](/attachment.cgi?id=9348836 "Bug 1845739 - windows.create consistent with tabs.create") [[details]](/attachment.cgi?id=9348836&action=edit "Bug 1845739 - windows.create consistent with tabs.create")

[Bug 1845739](/show_bug.cgi?id=1845739 "VERIFIED FIXED - WebExtension can open Internal pages using windows.create") - windows.create consistent with tabs.create

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easily. The ability to open arbitrary URLs in itself is not an immediate security issue, but combined with other vulnerabilities it can be.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Should apply easily.
* **How likely is this patch to cause regressions; how much testing does it need?**: Not likely; covered by unit tests. Extensions that relied on the original undocumented behavior could unexpectedly break, but that is a necessary change to fix the security issue.
* **Is Android affected?**: No
[Attachment #9348836](/attachment.cgi?id=9348836&action=edit "Bug 1845739 - windows.create consistent with tabs.create") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a3030331_1689)• 1 year ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1845739#c12)• 1 year ago |
|  | |

Comment on [attachment 9348836](/attachment.cgi?id=9348836 "Bug 1845739 - windows.create consistent with tabs.create") [[details]](/attachment.cgi?id=9348836&action=edit "Bug 1845739 - windows.create consistent with tabs.create")

[Bug 1845739](/show_bug.cgi?id=1845739 "VERIFIED FIXED - WebExtension can open Internal pages using windows.create") - windows.create consistent with tabs.create

sec-approval+ = dveditz

The testcase is fine to land with the patch.

[Attachment #9348836](/attachment.cgi?id=9348836&action=edit "Bug 1845739 - windows.create consistent with tabs.create") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a3030621_1689)• 1 year ago |

[Attachment #9348837](/attachment.cgi?id=9348837&action=edit "Bug 1845739 - About test case in browser_ext_windows_create_url.js") -
Flags: sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1845739#c13)• 1 year ago |
|  | |

We should land this on ESR 115 as well

[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected)
[tracking-firefox118](/buglist.cgi?f1=cf_tracking_firefox118&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B)
[tracking-firefox119](/buglist.cgi?f1=cf_tracking_firefox119&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [118+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=118%2B)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1845739#c14)• 1 year ago |
|  | |

Pushed by rob@robwu.nl:
<https://hg.mozilla.org/integration/autoland/rev/aeee2a248682>
windows.create consistent with tabs.create r=zombie
<https://hg.mozilla.org/integration/autoland/rev/bd48139a6966>
About test case in browser\_ext\_windows\_create\_url.js r=zombie

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1845739#c15)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/aeee2a248682>

<https://hg.mozilla.org/mozilla-central/rev/bd48139a6966>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 year ago
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 119 Branch

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1845739#c16)• 1 year ago |
|  | |

Comment on [attachment 9348836](/attachment.cgi?id=9348836 "Bug 1845739 - windows.create consistent with tabs.create") [[details]](/attachment.cgi?id=9348836&action=edit "Bug 1845739 - windows.create consistent with tabs.create")

[Bug 1845739](/show_bug.cgi?id=1845739 "VERIFIED FIXED - WebExtension can open Internal pages using windows.create") - windows.create consistent with tabs.create

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: Fix for security bug.
* **User impact if declined**: Extensions can open URLs that are restricted otherwise.
* **Fix Landed on Version**: 119
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The risk is a bit more than none, because it breaks extensions that try to rely on it to open many URLs (e.g. bookmarks) at once with this mechanism AND when they expect privileged URLs to be loadable in this way. This ability to open arbitrary URLs is however unintentional and not documented, and an intentional behavioral change.
[Attachment #9348836](/attachment.cgi?id=9348836&action=edit "Bug 1845739 - windows.create consistent with tabs.create") -
Flags: approval-mozilla-esr115?

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a3053245_447061)• 1 year ago |

[Attachment #9348837](/attachment.cgi?id=9348837&action=edit "Bug 1845739 - About test case in browser_ext_windows_create_url.js") -
Flags: approval-mozilla-esr115?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1845739#c17)• 1 year ago |
|  | |

:robwu could you add beta uplift requests here also?

This grafts cleanly to beta

Flags: needinfo?(rob)

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1845739#c18)• 1 year ago |
|  | |

This is not a recent regression, so I'm inclined to let it ride the trains in case there are add-ons that relied on the behavior.

Flags: needinfo?(rob)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a3115126_75935)• 1 year ago |

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=wontfix)
[tracking-firefox118](/buglist.cgi?f1=cf_tracking_firefox118&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B) → ---
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
[118+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=118%2B) → [119+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=119%2B)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1845739#c19)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1845739&comment_id=16564204 "1 revision") |
|  | |

Rob, can you please file a follow-up to write tests that enumerate our `about:` URLs and makes sure that none of them work. A `chrome:/` and `resource:/` and `file:` :)

Flags: needinfo?(rob)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a3471738_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1845739#c20)• 1 year ago |
|  | |

Hello, I have reported a separate issue regarding the ["file://" URI](https://bugzilla.mozilla.org/show_bug.cgi?id=1845735) where an attacker can leak arbitrary files by injecting JavaScript into the "file://" URI. If that report turns out to be a duplicate of this one, as [Daniel mentioned](https://bugzilla.mozilla.org/show_bug.cgi?id=1845735#c4), could you please elevate the security level to "high" due to the different methods of exploitation that an attacker can achieve using various URIs from an extension? Thank you.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a3473010_428608)• 1 year ago |

Duplicate of this bug: [1845735](/show_bug.cgi?id=1845735 "RESOLVED FIXED")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1845739#c22)• 1 year ago |
|  | |

Our ratings for Web Extensions are capped to "sec-moderate" because of limited reach: you have to convince people to install an extension (which is already dangerous, even if working as intended), and if the malware spreads it will be discovered and killed. "Sec-high" web page issues, in contrast, can affect all the millions of Firefox users if you can inject the code into a popular site or into an ad network, and even asking someone to click a link is a lower hurdle than installing an extension.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1845739#c23)• 1 year ago |
|  | |

Thank you for clarifying, and thanks for the quick fix and bounty 😄.

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1845739#c24)• 1 year ago |
|  | |

If possible, please mention both of these exploits in the advisory. Thank you.

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1845739#c25)• 1 year ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #19](/show_bug.cgi?id=1845739#c19 "VERIFIED FIXED - WebExtension can open Internal pages using windows.create"))

> Rob, can you please file a follow-up to write tests that enumerate our `about:` URLs and makes sure that none of them work. A `chrome:/` and `resource:/` and `file:` :)

Filed [bug 1851824](/show_bug.cgi?id=1851824 "NEW - Expand test coverage of invalid URLs in tabs.create/update / windows.create").

Blocks: [1851824](/show_bug.cgi?id=1851824 "NEW - Expand test coverage of invalid URLs in tabs.create/update / windows.create")Flags: needinfo?(rob)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a4680807_428608)• 1 year ago |

No longer duplicate of this bug: [1845735](/show_bug.cgi?id=1845735 "RESOLVED FIXED")

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1845739#c26)• 1 year ago |
|  | |

Comment on [attachment 9348836](/attachment.cgi?id=9348836 "Bug 1845739 - windows.create consistent with tabs.create") [[details]](/attachment.cgi?id=9348836&action=edit "Bug 1845739 - windows.create consistent with tabs.create")

[Bug 1845739](/show_bug.cgi?id=1845739 "VERIFIED FIXED - WebExtension can open Internal pages using windows.create") - windows.create consistent with tabs.create

Approved for 115.4esr

[Attachment #9348836](/attachment.cgi?id=9348836&action=edit "Bug 1845739 - windows.create consistent with tabs.create") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a5531055_690067)• 1 year ago |

[Attachment #9348837](/attachment.cgi?id=9348837&action=edit "Bug 1845739 - About test case in browser_ext_windows_create_url.js") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1845739#c27)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/a1167276b906>
<https://hg.mozilla.org/releases/mozilla-esr115/rev/16ab4d61519a>

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a5531723_690067)• 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a6040544_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a7271991_486634)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main119+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a7273852_486634)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main119+] → [reporter-external] [client-bounty-form] [verif?][adv-main119+][adv-ESR115.4+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1845739#c28)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9359579)
— [Details](attachment.cgi?id=9359579&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a7706150_578488)• 1 year ago |

Alias: CVE-2023-5725

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1845739#c29)• 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [Shaheen Fazim](/user_profile?user_id=720428)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a24021245_720428)• 9 months ago |

Status: RESOLVED → VERIFIED

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1845739#a26625875_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1845739&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Shaheen Fazim](/user_profile?user_id=720428)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

