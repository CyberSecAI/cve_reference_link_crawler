Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-21661

**Root Cause:**
- The vulnerability stems from a concurrency issue within the `expireOldFailedAttempts` function in `sessionmanager.go`. This function iterates over a map (`failures`) and simultaneously modifies it by deleting entries based on certain conditions. This operation is not thread-safe.

**Weaknesses/Vulnerabilities:**
- **Unsafe Map Modification:** The core vulnerability lies in the direct modification of a map (`failures`) while iterating over it in a multi-threaded environment. This lack of synchronization leads to a race condition.
- **Concurrency Issue:** Multiple threads can access and modify the `failures` map concurrently, leading to unpredictable behavior and crashes.

**Impact of Exploitation:**
- **Denial of Service (DoS):** An attacker can trigger the vulnerable code path, causing the application to crash repeatedly, making it unavailable to legitimate users. The application becomes unresponsive and unusable.
- **Application Crash:** The concurrent modification of the map results in a runtime error, causing the application pod to crash.

**Attack Vectors:**
- **Network:** The vulnerability can be exploited remotely over the network.
- **Unauthenticated:** The attack does not require any authentication, making it easier to exploit.

**Required Attacker Capabilities/Position:**
- The attacker only needs the ability to send requests that trigger the vulnerable code. No specific privileges or user interaction is needed. An attacker could repeatedly attempt login attempts to trigger the vulnerability.

**Technical Details:**

The vulnerability is located in the following function:

```go
func expireOldFailedAttempts(maxAge time.Duration, failures map[string]LoginAttempts) int {
    expiredCount := 0
    for key, attempt := range failures {
        if time.Since(attempt.LastFailed) > maxAge*time.Second {
            expiredCount += 1
            delete(failures, key) // Vulnerable code
        }
    }
    return expiredCount
}
```

The `expireOldFailedAttempts` function iterates over the `failures` map, and if a login attempt is older than `maxAge`, it deletes the entry directly. This operation is not thread-safe.

The fix for this vulnerability included:
- Adding a read/write mutex `failedLock` to protect access to the `failures` map.
- Modifying `expireOldFailedAttempts` to operate on a copy of the map, rather than the original.

**Additional Notes**
- The vulnerability is present in Argo CD versions <= 2.8.4
- Patched versions are: 2.10.4, 2.9.9, and 2.8.13
- The vulnerability is classified as High severity, with a CVSS score of 7.5