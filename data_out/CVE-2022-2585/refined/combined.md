=== Content from ubuntu.com_97aeb2f9_20250110_122122.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-5567-1: Linux kernel (OEM) vulnerabilities

10 August 2022

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 22.04 LTS](/security/notices?release=jammy)
* [Ubuntu 20.04 LTS](/security/notices?release=focal)

## Packages

* [linux-oem-5.14](/security/cves?package=linux-oem-5.14) - Linux kernel for OEM systems
* [linux-oem-5.17](/security/cves?package=linux-oem-5.17) - Linux kernel for OEM systems

## Details

Zhenpeng Lin discovered that the network packet scheduler implementation in

the Linux kernel did not properly remove all references to a route filter

before freeing it in some situations. A local attacker could use this to

cause a denial of service (system crash) or execute arbitrary code.

([CVE-2022-2588](/security/CVE-2022-2588))

It was discovered that the netfilter subsystem of the Linux kernel did not

prevent one nft object from referencing an nft set in another nft table,

leading to a use-after-free vulnerability. A local attacker could use this

to cause a denial of service (system crash) or execute arbitrary code.

([CVE-2022-2586](/security/CVE-2022-2586))

It was discovered that the implementation of POSIX timers in the Linux

kernel did not properly clean up timers in some situations. A local

attacker could use this to cause a denial of service (system crash) or

execute arbitrary code. ([CVE-2022-2585](/security/CVE-2022-2585))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 22.04

* [linux-image-oem-22.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.17)
  -
  [5.17.0.1015.14](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.17/5.17.0.1015.14)
* [linux-image-oem-22.04a](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.17)
  -
  [5.17.0.1015.14](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.17/5.17.0.1015.14)
* [linux-image-5.17.0-1015-oem](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oem-5.17)
  -
  [5.17.0-1015.16](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oem-5.17/5.17.0-1015.16)

##### Ubuntu 20.04

* [linux-image-oem-20.04c](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.14)
  -
  [5.14.0.1048.44](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.14/5.14.0.1048.44)
* [linux-image-oem-20.04b](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.14)
  -
  [5.14.0.1048.44](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.14/5.14.0.1048.44)
* [linux-image-oem-20.04d](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.14)
  -
  [5.14.0.1048.44](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.14/5.14.0.1048.44)
* [linux-image-oem-20.04](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.14)
  -
  [5.14.0.1048.44](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oem-5.14/5.14.0.1048.44)
* [linux-image-5.14.0-1048-oem](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oem-5.14)
  -
  [5.14.0-1048.55](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oem-5.14/5.14.0-1048.55)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2022-2588](/security/CVE-2022-2588)
* [CVE-2022-2585](/security/CVE-2022-2585)
* [CVE-2022-2586](/security/CVE-2022-2586)

## Related notices

* [USN-5557-1](/security/notices/USN-5557-1)
* [USN-5560-1](/security/notices/USN-5560-1)
* [USN-5560-2](/security/notices/USN-5560-2)
* [USN-5562-1](/security/notices/USN-5562-1)
* [USN-5564-1](/security/notices/USN-5564-1)
* [USN-5565-1](/security/notices/USN-5565-1)
* [USN-5566-1](/security/notices/USN-5566-1)
* [USN-5582-1](/security/notices/USN-5582-1)
* [USN-5588-1](/security/notices/USN-5588-1)
* [LSN-0089-1](/security/notices/LSN-0089-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.openwall.com_f776e3de_20250110_122123.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[thread-next>]](../../../2022/08/18/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <YvKVxLtBs86r6Dmh@quatroqueijos>
Date: Tue, 9 Aug 2022 14:13:40 -0300
From: Thadeu Lima de Souza Cascardo <cascardo@...onical.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2022-2585 - Linux kernel POSIX CPU timer UAF

CVE-2022-2585 - Linux kernel POSIX CPU timer UAF

It was discovered that when exec'ing from a non-leader thread, armed POSIX
CPU timers would be left on a list but freed, leading to a use-after-free.

An independent security researcher working with SSD Secure Disclosure
discovered that this vulnerability could be exploited for Local Privilege
Escalation.

This bug was introduced by commit 55e8c8eb2c7b ("posix-cpu-timers: Store a
reference to a pid not a task"), which is present since v5.7-rc1.

This has been assigned CVE-2022-2585.

A PoC that will trigger KASAN is going to be posted in a week.

A fix has been sent to linux-kernel@...r.kernel.org and is at
[https://lore.kernel.org/lkml/20220809170751.164716-1-cascardo@canonical.com/T/#u](https://lore.kernel.org/lkml/20220809170751.164716-1-cascardo%40canonical.com/T/#u).

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lore.kernel.org_b74f3227_20250110_122051.html ===

```
[linux-kernel.vger.kernel.org archive mirror](../../?t=20220809190409)
 [help](../../_/text/help/) / [color](../../_/text/color/) / [mirror](../../_/text/mirror/) / [Atom feed](../../new.atom)
```
```
[*](#e5c4553178873e23e12b922e61d085062df919e36) [PATCH] posix-cpu-timers: Cleanup CPU timers before freeing them during exec
@ 2022-08-09 17:07 Thadeu Lima de Souza Cascardo
  2022-08-09 18:04 ` [[tip: timers/urgent]](#ma2ac0b6a40455935dc247aeaf5aae39b0b5e0f20) " tip-bot2 for Thadeu Lima de Souza Cascardo
  2022-08-09 18:37 ` [[PATCH]](#m435d719d7ca7277d48e055671a3dfceb17c2dcd8) " Eric W. Biederman
  [0 siblings, 2 replies; 3+ messages in thread](#r5c4553178873e23e12b922e61d085062df919e36)
From: Thadeu Lima de Souza Cascardo @ 2022-08-09 17:07 UTC ([permalink](../../20220809170751.164716-1-cascardo%40canonical.com/) / [raw](../../20220809170751.164716-1-cascardo%40canonical.com/raw))
  To: [linux-kernel](../../../lkml/?t=20220809170913)
  Cc: Eric Biederman, Thadeu Lima de Souza Cascardo, Thomas Gleixner,
	[stable](../../../stable/?t=20220809170913)

Commit 55e8c8eb2c7b ("posix-cpu-timers: Store a reference to a pid not a
task") started looking up tasks by PID when deleting a CPU timer.

When a non-leader thread calls execve, it will switch PIDs with the leader
process. Then, as it calls exit_itimers, posix_cpu_timer_del cannot find
the task because the timer still points out to the old PID.

That means that armed timers won't be disarmed, that is, they won't be
removed from the timerqueue_list. exit_itimers will still release their
memory, and when that list is later processed, it leads to a
use-after-free.

Clean up the timers from the de-threaded task before freeing them. This
prevents a reported use-after-free.

Fixes: 55e8c8eb2c7b ("posix-cpu-timers: Store a reference to a pid not a task")
Signed-off-by: Thadeu Lima de Souza Cascardo <cascardo@canonical.com>
Reviewed-by: Thomas Gleixner <tglx@linutronix.de>
Cc: "Eric W. Biederman" <ebiederm@xmission.com>
Cc: <stable@vger.kernel.org>
---
 [fs/exec.c](#Z2e.:..:20220809170751.164716-1-cascardo::40canonical.com:1fs:exec.c) | 3 +++
 1 file [changed](#e5c4553178873e23e12b922e61d085062df919e36), 3 insertions(+)

[diff](#iZ2e.:..:20220809170751.164716-1-cascardo::40canonical.com:1fs:exec.c) --git a/fs/exec.c b/fs/exec.c
index 778123259e42..1c6b477dad69 100644
--- a/fs/exec.c
+++ b/fs/exec.c
@@ -1301,6 +1301,9 @@ int begin_new_exec(struct linux_binprm * bprm)
 	bprm->mm = NULL;

 #ifdef CONFIG_POSIX_TIMERS
+	spin_lock_irq(&me->sighand->siglock);
+	posix_cpu_timers_exit(me);
+	spin_unlock_irq(&me->sighand->siglock);
 	exit_itimers(me);
 	flush_itimer_signals();
 #endif
--
2.34.1

[^](#m5c4553178873e23e12b922e61d085062df919e36) [permalink](../../20220809170751.164716-1-cascardo%40canonical.com/) [raw](../../20220809170751.164716-1-cascardo%40canonical.com/raw) [reply](../../20220809170751.164716-1-cascardo%40canonical.com/#R) [related](../../20220809170751.164716-1-cascardo%40canonical.com/#related)	[[flat](../../20220809170751.164716-1-cascardo%40canonical.com/T/#u)|[nested](../../20220809170751.164716-1-cascardo%40canonical.com/t/#u)] [3+ messages in thread](#r5c4553178873e23e12b922e61d085062df919e36)
```

---

```
[*](#ea2ac0b6a40455935dc247aeaf5aae39b0b5e0f20) [tip: timers/urgent] posix-cpu-timers: Cleanup CPU timers before freeing them during exec
  2022-08-09 17:07 [[PATCH] posix-cpu-timers: Cleanup CPU timers before freeing them during exec](#m5c4553178873e23e12b922e61d085062df919e36) Thadeu Lima de Souza Cascardo
@ 2022-08-09 18:04 ` tip-bot2 for Thadeu Lima de Souza Cascardo
  2022-08-09 18:37 ` [[PATCH]](#m435d719d7ca7277d48e055671a3dfceb17c2dcd8) " Eric W. Biederman
  [1 sibling, 0 replies; 3+ messages in thread](#ra2ac0b6a40455935dc247aeaf5aae39b0b5e0f20)
From: tip-bot2 for Thadeu Lima de Souza Cascardo @ 2022-08-09 18:04 UTC ([permalink](../../166006829371.15455.12477315109108649290.tip-bot2%40tip-bot2/) / [raw](../../166006829371.15455.12477315109108649290.tip-bot2%40tip-bot2/raw))
  To: linux-tip-commits
  Cc: Thadeu Lima de Souza Cascardo, Thomas Gleixner, [stable](../../../stable/?t=20220809181500), x86,
	[linux-kernel](../../../lkml/?t=20220809181500)

The following commit has been merged into the timers/urgent branch of tip:

Commit-ID:     e362359ace6f87c201531872486ff295df306d13
Gitweb:        <https://git.kernel.org/tip/e362359ace6f87c201531872486ff295df306d13>
Author:        Thadeu Lima de Souza Cascardo <cascardo@canonical.com>
AuthorDate:    Tue, 09 Aug 2022 14:07:51 -03:00
Committer:     Thomas Gleixner <tglx@linutronix.de>
CommitterDate: Tue, 09 Aug 2022 20:02:13 +02:00

posix-cpu-timers: Cleanup CPU timers before freeing them during exec

Commit 55e8c8eb2c7b ("posix-cpu-timers: Store a reference to a pid not a
task") started looking up tasks by PID when deleting a CPU timer.

When a non-leader thread calls execve, it will switch PIDs with the leader
process. Then, as it calls exit_itimers, posix_cpu_timer_del cannot find
the task because the timer still points out to the old PID.

That means that armed timers won't be disarmed, that is, they won't be
removed from the timerqueue_list. exit_itimers will still release their
memory, and when that list is later processed, it leads to a
use-after-free.

Clean up the timers from the de-threaded task before freeing them. This
prevents a reported use-after-free.

Fixes: 55e8c8eb2c7b ("posix-cpu-timers: Store a reference to a pid not a task")
Signed-off-by: Thadeu Lima de Souza Cascardo <cascardo@canonical.com>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Reviewed-by: Thomas Gleixner <tglx@linutronix.de>
Cc: <stable@vger.kernel.org>
Link: [https://lore.kernel.org/r/20220809170751.164716-1-cascardo@canonical.com](https://lore.kernel.org/r/20220809170751.164716-1-cascardo%40canonical.com)

---
 [fs/exec.c](#Z2e.:..:166006829371.15455.12477315109108649290.tip-bot2::40tip-bot2:1fs:exec.c) | 3 +++
 1 file [changed](#ea2ac0b6a40455935dc247aeaf5aae39b0b5e0f20), 3 insertions(+)

[diff](#iZ2e.:..:166006829371.15455.12477315109108649290.tip-bot2::40tip-bot2:1fs:exec.c) --git a/fs/exec.c b/fs/exec.c
index 5fd7391..f793221 100644
--- a/fs/exec.c
+++ b/fs/exec.c
@@ -1304,6 +1304,9 @@ int begin_new_exec(struct linux_binprm * bprm)
 	bprm->mm = NULL;

 #ifdef CONFIG_POSIX_TIMERS
+	spin_lock_irq(&me->sighand->siglock);
+	posix_cpu_timers_exit(me);
+	spin_unlock_irq(&me->sighand->siglock);
 	exit_itimers(me);
 	flush_itimer_signals();
 #endif

[^](#ma2ac0b6a40455935dc247aeaf5aae39b0b5e0f20) [permalink](../../166006829371.15455.12477315109108649290.tip-bot2%40tip-bot2/) [raw](../../166006829371.15455.12477315109108649290.tip-bot2%40tip-bot2/raw) [reply](../../166006829371.15455.12477315109108649290.tip-bot2%40tip-bot2/#R) [related](../../166006829371.15455.12477315109108649290.tip-bot2%40tip-bot2/#related)	[[flat](../../166006829371.15455.12477315109108649290.tip-bot2%40tip-bot2/T/#u)|[nested](../../166006829371.15455.12477315109108649290.tip-bot2%40tip-bot2/t/#u)] [3+ messages in thread](#ra2ac0b6a40455935dc247aeaf5aae39b0b5e0f20)
```

---

```
[*](#e435d719d7ca7277d48e055671a3dfceb17c2dcd8) Re: [PATCH] posix-cpu-timers: Cleanup CPU timers before freeing them during exec
  2022-08-09 17:07 [[PATCH] posix-cpu-timers: Cleanup CPU timers before freeing them during exec](#m5c4553178873e23e12b922e61d085062df919e36) Thadeu Lima de Souza Cascardo
  2022-08-09 18:04 ` [[tip: timers/urgent]](#ma2ac0b6a40455935dc247aeaf5aae39b0b5e0f20) " tip-bot2 for Thadeu Lima de Souza Cascardo
@ 2022-08-09 18:37 ` Eric W. Biederman
  [1 sibling, 0 replies; 3+ messages in thread](#r435d719d7ca7277d48e055671a3dfceb17c2dcd8)
From: Eric W. Biederman @ 2022-08-09 18:37 UTC ([permalink](../../87wnbhxnz9.fsf%40email.froward.int.ebiederm.org/) / [raw](../../87wnbhxnz9.fsf%40email.froward.int.ebiederm.org/raw))
  To: Thadeu Lima de Souza Cascardo; +Cc: [linux-kernel](../../../lkml/?t=20220809190409), Thomas Gleixner, [stable](../../../stable/?t=20220809190409)

Thadeu Lima de Souza Cascardo <cascardo@canonical.com> writes:

> Commit 55e8c8eb2c7b ("posix-cpu-timers: Store a reference to a pid not a
> task") started looking up tasks by PID when deleting a CPU timer.
>
> When a non-leader thread calls execve, it will switch PIDs with the leader
> process. Then, as it calls exit_itimers, posix_cpu_timer_del cannot find
> the task because the timer still points out to the old PID.

I think this description is missing something.

Looking at how clock_pid_type selects which task to go through
to obtain the sighand lock, and the fact that the sighand_struct
can change during exec all make me think that this change isn't
necessarily wrong, I am just trying to understand what is going
on that makes this necessary.

The function cpu_timer_task_rcu should return the one remaining task if
it is process wide timer, as all of the other threads have been reaped
after de_thread.

For a per thread timer for the surviving thread I can see exchange_tids
causing clock_pid_type to returning the threads old pid, and which
exchange_tids attached to a task that de_thread has freed with
release_task.

If that analysis is correct I think your change is safe only
because posix_cpu_timers_exit does not do anything with the pids.

Perhaps it would be better to do something like the diff below.  That
is always call posix_cpu_timers_exit before exchange_tids can run.  That
way there is nothing clever going on for us to stumble over later.

Once long ago I tried to remove the pid swap but unfortunately the
glibc pthread relies on the fact that getpid() == gettid() for the
first thread after exec.  Sigh.

diff --git a/fs/exec.c b/fs/exec.c
index 45914e57c0d5..a2a0b3faf603 100644
--- a/fs/exec.c
+++ b/fs/exec.c
@@ -1072,6 +1072,10 @@ static int de_thread(struct task_struct *tsk)
 	if (!thread_group_leader(tsk))
 		sig->notify_count--;

+#ifdef CONFIG_POSIX_TIMERS
+	/* Cleanup the per thread timers before the pid changes */
+	posix_cpu_timers_exit(tsk);
+#endif
 	while (sig->notify_count) {
 		__set_current_state(TASK_KILLABLE);
 		spin_unlock_irq(lock);
diff --git a/kernel/exit.c b/kernel/exit.c
index 4f7424523bac..f7e19b73cf6c 100644
--- a/kernel/exit.c
+++ b/kernel/exit.c
@@ -104,7 +104,6 @@ static void __exit_signal(struct task_struct *tsk)
 	spin_lock(&sighand->siglock);

 #ifdef CONFIG_POSIX_TIMERS
-	posix_cpu_timers_exit(tsk);
 	if (group_dead)
 		posix_cpu_timers_exit_group(tsk);
 #endif
@@ -772,6 +771,12 @@ void __noreturn do_exit(long code)
 	if (tsk->mm)
 		sync_mm_rss(tsk->mm);
 	acct_update_integrals(tsk);
+#ifdef CONFIG_POSIX_TIMERS
+	/* Cleanup the per thread timers before de_thread can change the pid */
+	spin_lock_irq(&tsk->sighand->siglock);
+	posix_cpu_timers_exit(tsk);
+	spin_unlock_irq(&tsk->sighand->siglock);
+#endif
 	group_dead = atomic_dec_and_test(&tsk->signal->live);
 	if (group_dead) {
 		/*

Eric

[^](#m435d719d7ca7277d48e055671a3dfceb17c2dcd8) [permalink](../../87wnbhxnz9.fsf%40email.froward.int.ebiederm.org/) [raw](../../87wnbhxnz9.fsf%40email.froward.int.ebiederm.org/raw) [reply](../../87wnbhxnz9.fsf%40email.froward.int.ebiederm.org/#R) [related](../../87wnbhxnz9.fsf%40email.froward.int.ebiederm.org/#related)	[[flat](../../87wnbhxnz9.fsf%40email.froward.int.ebiederm.org/T/#u)|[nested](../../87wnbhxnz9.fsf%40email.froward.int.ebiederm.org/t/#u)] [3+ messages in thread](#r435d719d7ca7277d48e055671a3dfceb17c2dcd8)
```

---

```
end of thread, other threads:[[~2022-08-09 19:04 UTC](../../?t=20220809190409) | [newest](../../)]

Thread overview: 3+ messages (download: [mbox.gz](../t.mbox.gz) follow: [Atom feed](../t.atom)
-- links below jump to the message on this page --
2022-08-09 17:07 [[PATCH] posix-cpu-timers: Cleanup CPU timers before freeing them during exec](#m5c4553178873e23e12b922e61d085062df919e36) Thadeu Lima de Souza Cascardo
2022-08-09 18:04 ` [[tip: timers/urgent]](#ma2ac0b6a40455935dc247aeaf5aae39b0b5e0f20) " tip-bot2 for Thadeu Lima de Souza Cascardo
2022-08-09 18:37 ` [[PATCH]](#m435d719d7ca7277d48e055671a3dfceb17c2dcd8) " Eric W. Biederman

```

---

```
This is a public inbox, see [mirroring instructions](../../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from ubuntu.com_a719dc3a_20250110_122051.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-5564-1: Linux kernel (Intel IoTG) vulnerabilities

10 August 2022

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 22.04 LTS](/security/notices?release=jammy)

## Packages

* [linux-intel-iotg](/security/cves?package=linux-intel-iotg) - Linux kernel for Intel IoT platforms

## Details

Zhenpeng Lin discovered that the network packet scheduler implementation in

the Linux kernel did not properly remove all references to a route filter

before freeing it in some situations. A local attacker could use this to

cause a denial of service (system crash) or execute arbitrary code.

([CVE-2022-2588](/security/CVE-2022-2588))

It was discovered that the netfilter subsystem of the Linux kernel did not

prevent one nft object from referencing an nft set in another nft table,

leading to a use-after-free vulnerability. A local attacker could use this

to cause a denial of service (system crash) or execute arbitrary code.

([CVE-2022-2586](/security/CVE-2022-2586))

It was discovered that the implementation of POSIX timers in the Linux

kernel did not properly clean up timers in some situations. A local

attacker could use this to cause a denial of service (system crash) or

execute arbitrary code. ([CVE-2022-2585](/security/CVE-2022-2585))

It was discovered that the eBPF implementation in the Linux kernel did not

properly prevent writes to kernel objects in BPF\_BTF\_LOAD commands. A

privileged local attacker could use this to cause a denial of service

(system crash) or possibly execute arbitrary code. ([CVE-2022-0500](/security/CVE-2022-0500))

Minh Yuan discovered that the floppy disk driver in the Linux kernel

contained a race condition, leading to a use-after-free vulnerability. A

local attacker could possibly use this to cause a denial of service (system

crash) or execute arbitrary code. ([CVE-2022-1652](/security/CVE-2022-1652))

It was discovered that the Atheros ath9k wireless device driver in the

Linux kernel did not properly handle some error conditions, leading to a

use-after-free vulnerability. A local attacker could use this to cause a

denial of service (system crash) or possibly execute arbitrary code.

([CVE-2022-1679](/security/CVE-2022-1679))

It was discovered that the Marvell NFC device driver implementation in the

Linux kernel did not properly perform memory cleanup operations in some

situations, leading to a use-after-free vulnerability. A local attacker

could possibly use this to cause a denial of service (system crash) or

execute arbitrary code. ([CVE-2022-1734](/security/CVE-2022-1734))

Yongkang Jia discovered that the KVM hypervisor implementation in the Linux

kernel did not properly handle guest TLB mapping invalidation requests in

some situations. An attacker in a guest VM could use this to cause a denial

of service (system crash) in the host OS. ([CVE-2022-1789](/security/CVE-2022-1789))

Duoming Zhou discovered a race condition in the NFC subsystem in the Linux

kernel, leading to a use-after-free vulnerability. A privileged local

attacker could use this to cause a denial of service (system crash) or

possibly execute arbitrary code. ([CVE-2022-1974](/security/CVE-2022-1974))

Duoming Zhou discovered that the NFC subsystem in the Linux kernel did not

properly prevent context switches from occurring during certain atomic

context operations. A privileged local attacker could use this to cause a

denial of service (system crash). ([CVE-2022-1975](/security/CVE-2022-1975))

Felix Fu discovered that the Sun RPC implementation in the Linux kernel did

not properly handle socket states, leading to a use-after-free

vulnerability. A remote attacker could possibly use this to cause a denial

of service (system crash) or execute arbitrary code. ([CVE-2022-28893](/security/CVE-2022-28893))

Johannes Wikner and Kaveh Razavi discovered that for some AMD x86-64

processors, the branch predictor could by mis-trained for return

instructions in certain circumstances. A local attacker could possibly use

this to expose sensitive information. ([CVE-2022-29900](/security/CVE-2022-29900))

Johannes Wikner and Kaveh Razavi discovered that for some Intel x86-64

processors, the Linux kernel's protections against speculative branch

target injection attacks were insufficient in some circumstances. A local

attacker could possibly use this to expose sensitive information.

([CVE-2022-29901](/security/CVE-2022-29901))

Minh Yuan discovered that the floppy driver in the Linux kernel contained a

race condition in some situations, leading to a use-after-free

vulnerability. A local attacker could use this to cause a denial of service

(system crash) or possibly execute arbitrary code. ([CVE-2022-33981](/security/CVE-2022-33981))

Arthur Mongodin discovered that the netfilter subsystem in the Linux kernel

did not properly perform data validation. A local attacker could use this

to escalate privileges in certain situations. ([CVE-2022-34918](/security/CVE-2022-34918))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 22.04

* [linux-image-5.15.0-1013-intel-iotg](https://launchpad.net/ubuntu/%2Bsource/linux-signed-intel-iotg)
  -
  [5.15.0-1013.17](https://launchpad.net/ubuntu/%2Bsource/linux-signed-intel-iotg/5.15.0-1013.17)
* [linux-image-intel-iotg](https://launchpad.net/ubuntu/%2Bsource/linux-meta-intel-iotg)
  -
  [5.15.0.1013.13](https://launchpad.net/ubuntu/%2Bsource/linux-meta-intel-iotg/5.15.0.1013.13)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2022-1734](/security/CVE-2022-1734)
* [CVE-2022-2585](/security/CVE-2022-2585)
* [CVE-2022-29900](/security/CVE-2022-29900)
* [CVE-2022-29901](/security/CVE-2022-29901)
* [CVE-2022-33981](/security/CVE-2022-33981)
* [CVE-2022-0500](/security/CVE-2022-0500)
* [CVE-2022-1974](/security/CVE-2022-1974)
* [CVE-2022-28893](/security/CVE-2022-28893)
* [CVE-2022-1789](/security/CVE-2022-1789)
* [CVE-2022-1975](/security/CVE-2022-1975)
* [CVE-2022-34918](/security/CVE-2022-34918)
* [CVE-2022-2586](/security/CVE-2022-2586)
* [CVE-2022-2588](/security/CVE-2022-2588)
* [CVE-2022-1652](/security/CVE-2022-1652)
* [CVE-2022-1679](/security/CVE-2022-1679)

## Related notices

* [USN-5471-1](/security/notices/USN-5471-1)
* [USN-5500-1](/security/notices/USN-5500-1)
* [USN-5505-1](/security/notices/USN-5505-1)
* [USN-5513-1](/security/notices/USN-5513-1)
* [USN-5518-1](/security/notices/USN-5518-1)
* [USN-5560-1](/security/notices/USN-5560-1)
* [USN-5560-2](/security/notices/USN-5560-2)
* [USN-5562-1](/security/notices/USN-5562-1)
* [USN-5582-1](/security/notices/USN-5582-1)
* [USN-5565-1](/security/notices/USN-5565-1)
* [USN-5566-1](/security/notices/USN-5566-1)
* [USN-5567-1](/security/notices/USN-5567-1)
* [LSN-0089-1](/security/notices/LSN-0089-1)
* [USN-5854-1](/security/notices/USN-5854-1)
* [USN-5861-1](/security/notices/USN-5861-1)
* [USN-5862-1](/security/notices/USN-5862-1)
* [USN-5865-1](/security/notices/USN-5865-1)
* [USN-5883-1](/security/notices/USN-5883-1)
* [USN-5924-1](/security/notices/USN-5924-1)
* [USN-5975-1](/security/notices/USN-5975-1)
* [USN-6007-1](/security/notices/USN-6007-1)
* [USN-5728-1](/security/notices/USN-5728-1)
* [USN-5728-2](/security/notices/USN-5728-2)
* [USN-5728-3](/security/notices/USN-5728-3)
* [USN-6221-1](/security/notices/USN-6221-1)
* [USN-5514-1](/security/notices/USN-5514-1)
* [USN-5539-1](/security/notices/USN-5539-1)
* [USN-6001-1](/security/notices/USN-6001-1)
* [USN-6013-1](/security/notices/USN-6013-1)
* [USN-6014-1](/security/notices/USN-6014-1)
* [USN-5544-1](/security/notices/USN-5544-1)
* [USN-5529-1](/security/notices/USN-5529-1)
* [USN-5540-1](/security/notices/USN-5540-1)
* [USN-5545-1](/security/notices/USN-5545-1)
* [USN-5557-1](/security/notices/USN-5557-1)
* [USN-5588-1](/security/notices/USN-5588-1)
* [USN-5517-1](/security/notices/USN-5517-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from ubuntu.com_9b72b5d8_20250110_122121.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-5566-1: Linux kernel vulnerabilities

10 August 2022

Several security issues were fixed in the Linux kernel.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 22.04 LTS](/security/notices?release=jammy)
* [Ubuntu 20.04 LTS](/security/notices?release=focal)

## Packages

* [linux-aws](/security/cves?package=linux-aws) - Linux kernel for Amazon Web Services (AWS) systems
* [linux-aws-5.15](/security/cves?package=linux-aws-5.15) - Linux kernel for Amazon Web Services (AWS) systems
* [linux-azure](/security/cves?package=linux-azure) - Linux kernel for Microsoft Azure Cloud systems
* [linux-azure-5.15](/security/cves?package=linux-azure-5.15) - Linux kernel for Microsoft Azure cloud systems
* [linux-gcp](/security/cves?package=linux-gcp) - Linux kernel for Google Cloud Platform (GCP) systems
* [linux-gcp-5.15](/security/cves?package=linux-gcp-5.15) - Linux kernel for Google Cloud Platform (GCP) systems
* [linux-gke](/security/cves?package=linux-gke) - Linux kernel for Google Container Engine (GKE) systems
* [linux-gke-5.15](/security/cves?package=linux-gke-5.15) - Linux kernel for Google Container Engine (GKE) systems
* [linux-ibm](/security/cves?package=linux-ibm) - Linux kernel for IBM cloud systems
* [linux-kvm](/security/cves?package=linux-kvm) - Linux kernel for cloud environments
* [linux-oracle](/security/cves?package=linux-oracle) - Linux kernel for Oracle Cloud systems
* [linux-raspi](/security/cves?package=linux-raspi) - Linux kernel for Raspberry Pi systems

## Details

Zhenpeng Lin discovered that the network packet scheduler implementation in

the Linux kernel did not properly remove all references to a route filter

before freeing it in some situations. A local attacker could use this to

cause a denial of service (system crash) or execute arbitrary code.

([CVE-2022-2588](/security/CVE-2022-2588))

It was discovered that the netfilter subsystem of the Linux kernel did not

prevent one nft object from referencing an nft set in another nft table,

leading to a use-after-free vulnerability. A local attacker could use this

to cause a denial of service (system crash) or execute arbitrary code.

([CVE-2022-2586](/security/CVE-2022-2586))

It was discovered that the implementation of POSIX timers in the Linux

kernel did not properly clean up timers in some situations. A local

attacker could use this to cause a denial of service (system crash) or

execute arbitrary code. ([CVE-2022-2585](/security/CVE-2022-2585))

Minh Yuan discovered that the floppy disk driver in the Linux kernel

contained a race condition, leading to a use-after-free vulnerability. A

local attacker could possibly use this to cause a denial of service (system

crash) or execute arbitrary code. ([CVE-2022-1652](/security/CVE-2022-1652))

It was discovered that the Atheros ath9k wireless device driver in the

Linux kernel did not properly handle some error conditions, leading to a

use-after-free vulnerability. A local attacker could use this to cause a

denial of service (system crash) or possibly execute arbitrary code.

([CVE-2022-1679](/security/CVE-2022-1679))

Felix Fu discovered that the Sun RPC implementation in the Linux kernel did

not properly handle socket states, leading to a use-after-free

vulnerability. A remote attacker could possibly use this to cause a denial

of service (system crash) or execute arbitrary code. ([CVE-2022-28893](/security/CVE-2022-28893))

Johannes Wikner and Kaveh Razavi discovered that for some AMD x86-64

processors, the branch predictor could by mis-trained for return

instructions in certain circumstances. A local attacker could possibly use

this to expose sensitive information. ([CVE-2022-29900](/security/CVE-2022-29900))

Johannes Wikner and Kaveh Razavi discovered that for some Intel x86-64

processors, the Linux kernel's protections against speculative branch

target injection attacks were insufficient in some circumstances. A local

attacker could possibly use this to expose sensitive information.

([CVE-2022-29901](/security/CVE-2022-29901))

Arthur Mongodin discovered that the netfilter subsystem in the Linux kernel

did not properly perform data validation. A local attacker could use this

to escalate privileges in certain situations. ([CVE-2022-34918](/security/CVE-2022-34918))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 22.04

* [linux-image-5.15.0-1016-kvm](https://launchpad.net/ubuntu/%2Bsource/linux-signed-kvm)
  -
  [5.15.0-1016.19](https://launchpad.net/ubuntu/%2Bsource/linux-signed-kvm/5.15.0-1016.19)
* [linux-image-5.15.0-1012-ibm](https://launchpad.net/ubuntu/%2Bsource/linux-signed-ibm)
  -
  [5.15.0-1012.14](https://launchpad.net/ubuntu/%2Bsource/linux-signed-ibm/5.15.0-1012.14)
* [linux-image-5.15.0-1016-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gcp)
  -
  [5.15.0-1016.21](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gcp/5.15.0-1016.21)
* [linux-image-aws](https://launchpad.net/ubuntu/%2Bsource/linux-meta-aws)
  -
  [5.15.0.1017.17](https://launchpad.net/ubuntu/%2Bsource/linux-meta-aws/5.15.0.1017.17)
* [linux-image-5.15.0-1013-raspi-nolpae](https://launchpad.net/ubuntu/%2Bsource/linux-raspi)
  -
  [5.15.0-1013.15](https://launchpad.net/ubuntu/%2Bsource/linux-raspi/5.15.0-1013.15)
* [linux-image-gke-5.15](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke)
  -
  [5.15.0.1014.17](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke/5.15.0.1014.17)
* [linux-image-ibm](https://launchpad.net/ubuntu/%2Bsource/linux-meta-ibm)
  -
  [5.15.0.1012.11](https://launchpad.net/ubuntu/%2Bsource/linux-meta-ibm/5.15.0.1012.11)
* [linux-image-azure](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure)
  -
  [5.15.0.1017.16](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure/5.15.0.1017.16)
* [linux-image-raspi-nolpae](https://launchpad.net/ubuntu/%2Bsource/linux-meta-raspi)
  -
  [5.15.0.1013.12](https://launchpad.net/ubuntu/%2Bsource/linux-meta-raspi/5.15.0.1013.12)
* [linux-image-5.15.0-1017-aws](https://launchpad.net/ubuntu/%2Bsource/linux-signed-aws)
  -
  [5.15.0-1017.21](https://launchpad.net/ubuntu/%2Bsource/linux-signed-aws/5.15.0-1017.21)
* [linux-image-gke](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke)
  -
  [5.15.0.1014.17](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke/5.15.0.1014.17)
* [linux-image-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gcp)
  -
  [5.15.0.1016.14](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gcp/5.15.0.1016.14)
* [linux-image-5.15.0-1014-gke](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gke)
  -
  [5.15.0-1014.17](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gke/5.15.0-1014.17)
* [linux-image-5.15.0-1016-oracle](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oracle)
  -
  [5.15.0-1016.20](https://launchpad.net/ubuntu/%2Bsource/linux-signed-oracle/5.15.0-1016.20)
* [linux-image-oracle](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oracle)
  -
  [5.15.0.1016.14](https://launchpad.net/ubuntu/%2Bsource/linux-meta-oracle/5.15.0.1016.14)
* [linux-image-5.15.0-1013-raspi](https://launchpad.net/ubuntu/%2Bsource/linux-raspi)
  -
  [5.15.0-1013.15](https://launchpad.net/ubuntu/%2Bsource/linux-raspi/5.15.0-1013.15)
* [linux-image-5.15.0-1017-azure](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure)
  -
  [5.15.0-1017.20](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure/5.15.0-1017.20)
* [linux-image-raspi](https://launchpad.net/ubuntu/%2Bsource/linux-meta-raspi)
  -
  [5.15.0.1013.12](https://launchpad.net/ubuntu/%2Bsource/linux-meta-raspi/5.15.0.1013.12)
* [linux-image-kvm](https://launchpad.net/ubuntu/%2Bsource/linux-meta-kvm)
  -
  [5.15.0.1016.14](https://launchpad.net/ubuntu/%2Bsource/linux-meta-kvm/5.15.0.1016.14)

##### Ubuntu 20.04

* [linux-image-5.15.0-1017-azure](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure-5.15)
  -
  [5.15.0-1017.20~20.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-azure-5.15/5.15.0-1017.20~20.04.1)
* [linux-image-azure](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure-5.15)
  -
  [5.15.0.1017.20~20.04.10](https://launchpad.net/ubuntu/%2Bsource/linux-meta-azure-5.15/5.15.0.1017.20~20.04.10)
* [linux-image-5.15.0-1017-aws](https://launchpad.net/ubuntu/%2Bsource/linux-signed-aws-5.15)
  -
  [5.15.0-1017.21~20.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-aws-5.15/5.15.0-1017.21~20.04.1)
* [linux-image-5.15.0-1016-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gcp-5.15)
  -
  [5.15.0-1016.21~20.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gcp-5.15/5.15.0-1016.21~20.04.1)
* [linux-image-aws](https://launchpad.net/ubuntu/%2Bsource/linux-meta-aws-5.15)
  -
  [5.15.0.1017.21~20.04.9](https://launchpad.net/ubuntu/%2Bsource/linux-meta-aws-5.15/5.15.0.1017.21~20.04.9)
* [linux-image-gcp](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gcp-5.15)
  -
  [5.15.0.1016.21~20.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gcp-5.15/5.15.0.1016.21~20.04.1)
* [linux-image-gke-5.15](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke-5.15)
  -
  [5.15.0.1014.17~20.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-meta-gke-5.15/5.15.0.1014.17~20.04.1)
* [linux-image-5.15.0-1014-gke](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gke-5.15)
  -
  [5.15.0-1014.17~20.04.1](https://launchpad.net/ubuntu/%2Bsource/linux-signed-gke-5.15/5.15.0-1014.17~20.04.1)

After a standard system update you need to reboot your computer to make

all the necessary changes.

ATTENTION: Due to an unavoidable ABI change the kernel updates have

been given a new version number, which requires you to recompile and

reinstall all third party kernel modules you might have installed.

Unless you manually uninstalled the standard kernel metapackages

(e.g. linux-generic, linux-generic-lts-RELEASE, linux-virtual,

linux-powerpc), a standard system upgrade will automatically perform

this as well.

## References

* [CVE-2022-2586](/security/CVE-2022-2586)
* [CVE-2022-29901](/security/CVE-2022-29901)
* [CVE-2022-34918](/security/CVE-2022-34918)
* [CVE-2022-29900](/security/CVE-2022-29900)
* [CVE-2022-2585](/security/CVE-2022-2585)
* [CVE-2022-2588](/security/CVE-2022-2588)
* [CVE-2022-1652](/security/CVE-2022-1652)
* [CVE-2022-1679](/security/CVE-2022-1679)
* [CVE-2022-28893](/security/CVE-2022-28893)

## Related notices

* [USN-5557-1](/security/notices/USN-5557-1)
* [USN-5560-1](/security/notices/USN-5560-1)
* [USN-5560-2](/security/notices/USN-5560-2)
* [USN-5562-1](/security/notices/USN-5562-1)
* [USN-5564-1](/security/notices/USN-5564-1)
* [USN-5565-1](/security/notices/USN-5565-1)
* [USN-5567-1](/security/notices/USN-5567-1)
* [USN-5582-1](/security/notices/USN-5582-1)
* [LSN-0089-1](/security/notices/LSN-0089-1)
* [USN-5728-1](/security/notices/USN-5728-1)
* [USN-5728-2](/security/notices/USN-5728-2)
* [USN-5728-3](/security/notices/USN-5728-3)
* [USN-5854-1](/security/notices/USN-5854-1)
* [USN-5861-1](/security/notices/USN-5861-1)
* [USN-5862-1](/security/notices/USN-5862-1)
* [USN-5865-1](/security/notices/USN-5865-1)
* [USN-5883-1](/security/notices/USN-5883-1)
* [USN-5924-1](/security/notices/USN-5924-1)
* [USN-5975-1](/security/notices/USN-5975-1)
* [USN-6007-1](/security/notices/USN-6007-1)
* [USN-6221-1](/security/notices/USN-6221-1)
* [USN-5540-1](/security/notices/USN-5540-1)
* [USN-5544-1](/security/notices/USN-5544-1)
* [USN-5545-1](/security/notices/USN-5545-1)
* [USN-5588-1](/security/notices/USN-5588-1)
* [USN-5500-1](/security/notices/USN-5500-1)
* [USN-5505-1](/security/notices/USN-5505-1)
* [USN-5513-1](/security/notices/USN-5513-1)
* [USN-5529-1](/security/notices/USN-5529-1)
* [USN-5517-1](/security/notices/USN-5517-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


