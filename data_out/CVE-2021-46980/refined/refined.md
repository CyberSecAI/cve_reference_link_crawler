```
{
  "vulnerability": {
    "root_cause": "The UCSI driver only retrieves the first 4 Power Data Objects (PDOs) from a connected PD source due to message length limitations. However, a PD source can advertise up to 7 PDOs. If the Power Policy Manager (PPM) negotiates a contract using a PDO beyond the 4th index, an out-of-bounds access occurs when indexing the `src_pdos` array in `ucsi_psy_get_voltage_now()` using `rdo_index()`.",
    "weaknesses": [
      "Out-of-bounds access due to insufficient PDO retrieval.",
      "Incorrect array indexing"
    ],
    "impact": "Kernel crash due to out-of-bounds memory access, leading to a denial of service.",
    "attack_vectors": "Connecting a USB PD source that advertises more than 4 PDOs and having the PPM negotiate a contract with a PDO at an index greater than 3.",
    "required_capabilities": "Physical access to the machine to connect a malicious USB PD source that advertises more than 4 PDOs."
  },
  "additional_details": {
        "UBSAN_detection": "The vulnerability was detected using the UBSAN `-fsanitize=array-bounds` checker.",
    "trigger": "The issue is triggered when the PPM enters a contract using the 5th PDO and then `ucsi_psy_get_voltage_now()` tries to access it.",
     "fix": "The fix involves retrieving and storing up to 7 PDOs, requiring two calls to the `GET_PDOS` command. The `src_pdos` array size was increased to `PDO_MAX_OBJECTS` which is 7."
  }
}
```