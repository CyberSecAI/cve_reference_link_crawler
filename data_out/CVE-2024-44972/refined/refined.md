The provided content relates to CVE-2024-44972.

**Root cause of vulnerability:**
The vulnerability stems from an incorrect clearing of page dirty flags within the `extent_write_locked_range()` function in the Btrfs filesystem driver. Specifically, `clear_page_dirty_for_io()` was being called on pages that were not the originally locked page, leading to a desynchronization between subpage dirty flags and the page dirty flag. This desynchronization prevents the proper writeback of certain dirty ranges, resulting in a leak of reserved data/metadata space.

**Weaknesses/vulnerabilities present:**
- Incorrect page dirty flag management in `extent_write_locked_range()`.
- Desynchronization between page-level dirty flags and subpage dirty flags.
- Failure to write back all dirty data due to the desynchronization.
- Resulting in reserved space not being released.

**Impact of exploitation:**
- Reserved data and metadata space leak.
- Potential filesystem corruption if the leaked space is critical for operations.
- Unspecified warnings in kernel logs related to the data leak.
- The leaked reserved space could cause issues when the filesystem attempts to allocate or manage space.

**Attack vectors:**
-  A combination of buffered writes and direct I/O operations on a Btrfs filesystem mounted on a zoned block device with subpage support.
- Specific workload using `fsstress` to trigger the race condition between buffered writes and direct I/O operations.

**Required attacker capabilities/position:**
- Ability to mount a Btrfs filesystem on a zoned block device.
- Ability to execute commands on the system to create and modify files using `fsstress`.
- Need to trigger a specific sequence of buffered writes followed by direct I/O.