<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>strongSwan - strongSwan Vulnerability (CVE-2022-4967)</title>
    <meta name="author" content="strongSwan project">
    <meta name="description" content="">
    <meta property="og:image" content="https://www.strongswan.org/images/strongswan_square_large.png" />
    <meta property="og:image:width" content="800" />
    <meta property="og:image:height" content="800" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#d70f37">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/fa/css/fontawesome.min.css">
    <link rel="stylesheet" href="/css/fa/css/brands.min.css">
    <link rel="stylesheet" href="/css/fa/css/solid.min.css">
    <base target="_top">
  </head>
  <body class="has-navbar-fixed-top">
    <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
      <div class="container">
        <div class="navbar-brand">
          <a class="navbar-item" href="/">
            <img src="/images/logo.svg" alt="strongSwan Logo" width="170">
          </a>
          <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>
        </div>

        <div id="mainNav" class="navbar-menu">
          <div class="navbar-start">
          </div>

          <div class="navbar-end">
            <a class="navbar-item" href="/documentation.html">
              Documentation
            </a>
            <a class="navbar-item" href="/support.html">
              Support
            </a>
            <a class="navbar-item" href="/license.html">
              License
            </a>
            <a class="navbar-item" href="/about.html">
              About
            </a>
            <div class="navbar-item">
              <div class="buttons">
                <a class="button is-primary is-inverted is-rounded" href="/blog/">
                  <strong>Blog</strong>
                </a>
                <a class="button is-primary is-rounded" href="/download.html">
                  <strong>Download</strong>
                </a>
                <a class="button is-light is-rounded" href="https://github.com/strongswan">
                  <span class="icon-text">
                    <span class="icon">
                      <i class="fa-brands fa-github"></i>
                    </span>
                    <span><strong>GitHub</strong></span>
                  </span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>

<section class="hero is-medium has-background-img" style="background-image: url(/images/bg-0.svg);">
    <div class="hero-body">
        <div class="container">
      <h1 class="title">
        Blog
      </h1>
      <h2 class="subtitle">
        Release and vulnerability announcements for strongSwan
      </h2>
    </div>
    </div>
</section>




<section class="section py-0">

<div class="container"><nav aria-label="breadcrumbs" class="breadcrumb is-small"><ul>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/blog/2024">2024</a></li>
    <li class="is-active"><a href="/blog/2024/05/13/strongswan-vulnerability-(cve-2022-4967).html" aria-current="page">strongSwan Vulnerability (CVE-2022-4967)</a></li>
</ul></nav></div>



</section>

<section class="section">
      <div class="container content">

  <h2 class="title">strongSwan Vulnerability (CVE-2022-4967)</h2>
  <p class="subtitle is-5"><time datetime="2024-05-13" class="date">May 13, 2024</time></p>
  <p class="is-size-5">
      This advisory reclassifies an old bug in our TLS library as a potential authorization bypass vulnerability in order to get the fix applied to affected distribution packages. The bug is contained in versions 5.9.2 through 5.9.5 and was fixed with 5.9.6, which was released in August 2022.
  </p>
  
      <div class="tags"><a href="/blog/tags/5.9.x" class="tag">5.9.x</a><a href="/blog/tags/security+fix" class="tag">security fix</a></div>
  
</div>
</section>

<section class="section">
      <div class="container content">
  <div class="content">
<p>An old bug in our TLS library that caused IKE/EAP identities to not get matched against certificates in TLS-based EAP methods can possibly lead to an authorization bypass vulnerability. This bug was fixed with 5.9.6. However, there are still vulnerable versions packaged by distributions.</p>
<h3>Potential Authorization Bypass With TLS-based EAP Methods</h3>
<p>When certificates are used to authenticate clients in TLS-based EAP methods, the IKE or EAP identity supplied by a client is not enforced to be contained in the client's certificate. &nbsp;So clients can authenticate with any trusted certificate and claim an arbitrary IKE/EAP identity as their own. This is problematic if the identity is used to make policy decisions. Affected are strongSwan versions 5.9.2 through 5.9.5.</p>
<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-4967">CVE-2022-4967</a>&nbsp;has&nbsp;been assigned for this vulnerability.</p>
<h4>Wrong Identity Used in Lookup for Client Certificate</h4>
<p>The changes that added TLS 1.3 to our TLS library (<code>libtls</code>) with 5.9.2 refactored the lookup for trusted client certificates on the server. Instead of continuing to use the IKE or EAP identity supplied by the client to find a matching certificate, the lookup was done with the client certificate's subject DN, which will always succeed as long as the certificate is trusted. So the client could claim an arbitrary IKE/EAP identity that would not have to be contained in its certificate.</p>
<p>This is a problem if that identity is used to make policy decisions either via strongSwan's configuration (e.g. switching between multiple connections that allow access to different networks) or via plugins/scripts that match the identity (e.g. via the <a href="https://docs.strongswan.org/docs/5.9/plugins/ext-auth.html">ext-auth</a>, <a href="https://docs.strongswan.org/docs/5.9/plugins/updown.html">updown</a>, or <a href="https://docs.strongswan.org/docs/5.9/plugins/whitelist.html">whitelist</a> plugins).</p>
<p>Remote code execution is not possible due to this issue.</p>
<p>Credit to Jan Schermer for pointing out the issue with matching IKE identities in vulnerable versions and reporting it responsibly.</p>
<h3>Mitigation</h3>
<p>Again, setups that use strongSwan versions older than 5.9.2 or newer than 5.9.5 are not affected.</p>
<p>Setups that don't match client identities when using TLS-based EAP methods are also not vulnerable as clients still have to use a trusted certificate.</p>
<p>For affected releases, we <a href="https://download.strongswan.org/security/CVE-2022-4967">provide patches</a> that fix the vulnerability and should apply with appropriate hunk offsets.</p>
<p>&nbsp;</p>
</div>
</div>
</section>

<link rel="stylesheet" href="/js/highlight/styles/github.min.css">
<script src="/js/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
<footer class="footer">
      <div class="container">
        <div class="columns">
          <div class="column">
            <strong>strongSwan Project</strong>
            <ul>
              <li><a href="/download.html">Downloads</a></li>
              <li><a href="/license.html">License</a></li>
              <li><a href="/about.html">About</a></li>
              <li><a href="/blog/">Blog</a> (<a href="/blog/feed.rss">RSS</a>)</li>
            </ul>
          </div>
          <div class="column">
            <strong>Help</strong>
            <ul>
              <li><a href="/documentation.html">Documentation</a></li>
              <li><a href="/support.html">Support</a></li>
            </ul>
          </div>
          <div class="column">
            <strong>Social</strong>
            <ul>
              <li><a href="https://github.com/strongswan">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fa-brands fa-github"></i>
                  </span>
                  GitHub
                </span>
              </a></li>
              <li><a href="https://bsky.app/profile/strongswan.org">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fa-brands fa-bluesky"></i>
                  </span>
                  Bluesky
                </span>
              </a></li>
              <li><a href="https://x.com/strongswan">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fa-brands fa-x-twitter"></i>
                  </span>
                  X/Twitter
                </span>
              </a></li>
              <li><a href="https://www.facebook.com/pages/strongSwan/222380261260881">
                <span class="icon-text">
                  <span class="icon">
                    <i class="fa-brands fa-facebook"></i>
                  </span>
                  Facebook
                </span>
              </a></li>
            </ul>
          </div>
          <div class="column is-2 is-three-fifths-mobile">
            <strong class="block is-block">Main Sponsors</strong>
            <a class="block is-block" href="https://www.secunet.com/"><img src="/images/secunet_logo_neg.svg" alt="secunet"></a>
            <a class="block is-block" href="https://www.codelabs.ch/"><img src="/images/codelabs_logo_rgb_neg.png" alt="codelabs"></a>
          </div>
        </div>
        <div class="columns mt-6">
          <div class="column">
            <p>
              <strong>&copy; 2025</strong> by The strongSwan Team
            </p>
          </div>
          <div class="column has-text-right-tablet">
            <p>
              <a class="block is-block" href="/imprint.html">Imprint</a>
            </p> 
          </div>
        </div>
      </div>
    </footer>
  </body>
  <script src="/js/jquery-3.6.1.min.js"></script>
  <script src="/js/site.js"></script>
</html>