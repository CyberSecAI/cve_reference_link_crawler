=== Content from github.com_54a3a2a8_20250110_164332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcvat-ai%2Fcvat%2Fcommit%2Ff2346934c80bd91740f55c2788ef7d535a291d4c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcvat-ai%2Fcvat%2Fcommit%2Ff2346934c80bd91740f55c2788ef7d535a291d4c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=cvat-ai%2Fcvat)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cvat-ai](/cvat-ai)
/
**[cvat](/cvat-ai/cvat)**
Public

* [Notifications](/login?return_to=%2Fcvat-ai%2Fcvat) You must be signed in to change notification settings
* [Fork
  3.1k](/login?return_to=%2Fcvat-ai%2Fcvat)
* [Star
   12.9k](/login?return_to=%2Fcvat-ai%2Fcvat)

* [Code](/cvat-ai/cvat)
* [Issues
  522](/cvat-ai/cvat/issues)
* [Pull requests
  43](/cvat-ai/cvat/pulls)
* [Discussions](/cvat-ai/cvat/discussions)
* [Actions](/cvat-ai/cvat/actions)
* [Projects
  4](/cvat-ai/cvat/projects)
* [Wiki](/cvat-ai/cvat/wiki)
* [Security](/cvat-ai/cvat/security)
* [Insights](/cvat-ai/cvat/pulse)

Additional navigation options

* [Code](/cvat-ai/cvat)
* [Issues](/cvat-ai/cvat/issues)
* [Pull requests](/cvat-ai/cvat/pulls)
* [Discussions](/cvat-ai/cvat/discussions)
* [Actions](/cvat-ai/cvat/actions)
* [Projects](/cvat-ai/cvat/projects)
* [Wiki](/cvat-ai/cvat/wiki)
* [Security](/cvat-ai/cvat/security)
* [Insights](/cvat-ai/cvat/pulse)

## Commit

[Permalink](/cvat-ai/cvat/commit/f2346934c80bd91740f55c2788ef7d535a291d4c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-q684-4jjh-83g6](https://github.com/cvat-ai/cvat/security/advisories/GHSA-q684-4jjh-83g6 "GHSA-q684-4jjh-83g6")

[Browse files](/cvat-ai/cvat/tree/f2346934c80bd91740f55c2788ef7d535a291d4c)
Browse the repository at this point in the history

```
S3 storages support user-specified endpoint URLs, and Azure storages support
user-specified connection strings (which can contain endpoint URLs), so they
are susceptible to SSRF. Make S3 and Azure requests go through smokescreen
to fix this.

AFAIK, there is no way to configure a custom URL for Google Cloud storages,
so those aren't vulnerable.

Co-authored-by: Nikita Manovich <nikita@cvat.ai>
```

* Loading branch information

[![@SpecLad](https://avatars.githubusercontent.com/u/2391761?s=40&v=4)](/SpecLad) [![@nmanovic](https://avatars.githubusercontent.com/u/40690625?s=40&v=4)](/nmanovic)

[SpecLad](/cvat-ai/cvat/commits?author=SpecLad "View all commits by SpecLad")
and
[nmanovic](/cvat-ai/cvat/commits?author=nmanovic "View all commits by nmanovic")
authored
Jun 13, 2024

1 parent
[cf2f329](/cvat-ai/cvat/commit/cf2f32969fa4809a1f62961689ac4684e6df40e9)

commit f234693

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**31 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* changelog.d

  + changelog.d/20240610\_143947\_roman\_ssrf\_s3.md
    [20240610\_143947\_roman\_ssrf\_s3.md](#diff-343c24fd3bb27b7b89d781c09670577252dc7c98fa5666e24a3cd1a1ca8c69d5)
* cvat/apps/engine

  + cvat/apps/engine/cloud\_provider.py
    [cloud\_provider.py](#diff-6e105610cb381d30dc34e2ace82f8bb3ced20b2a7daa52549e7bb4f89d7529ab)
* supervisord

  + supervisord/worker.export.conf
    [worker.export.conf](#diff-a4a22896043231faff86db50686a8c53f55dfaf51c19deffafed89a5393637ff)
* tests

  + tests/allow\_minio.sh
    [allow\_minio.sh](#diff-ae63bacf9995ae6c98aaaa940a3ef2f2a390a9580f130b82a47a0400c0f78a6d)
  + tests/docker-compose.minio.yml
    [docker-compose.minio.yml](#diff-9910517800e83b4bcff18873fe3c8cff98f76d750643aec0c108669593f6bc07)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[changelog.d/20240610\_143947\_roman\_ssrf\_s3.md](#diff-343c24fd3bb27b7b89d781c09670577252dc7c98fa5666e24a3cd1a1ca8c69d5 "changelog.d/20240610_143947_roman_ssrf_s3.md")

Show comments

[View file](/cvat-ai/cvat/blob/f2346934c80bd91740f55c2788ef7d535a291d4c/changelog.d/20240610_143947_roman_ssrf_s3.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,4 @@ |
|  |  | ### Security |
|  |  |  |
|  |  | - Fixed an SSRF vulnerability with custom cloud storage endpoints |
|  |  | (<https://github.com/cvat-ai/cvat/security/advisories/GHSA-q684-4jjh-83g6>) |

15 changes: 11 additions & 4 deletions

15
[cvat/apps/engine/cloud\_provider.py](#diff-6e105610cb381d30dc34e2ace82f8bb3ced20b2a7daa52549e7bb4f89d7529ab "cvat/apps/engine/cloud_provider.py")

Show comments

[View file](/cvat-ai/cvat/blob/f2346934c80bd91740f55c2788ef7d535a291d4c/cvat/apps/engine/cloud_provider.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,6 +18,7 @@ |
|  |  | from azure.storage.blob import BlobServiceClient, ContainerClient, PublicAccess |
|  |  | from azure.storage.blob.\_list\_blobs\_helper import BlobPrefix |
|  |  | from boto3.s3.transfer import TransferConfig |
|  |  | from botocore.client import Config |
|  |  | from botocore.exceptions import ClientError |
|  |  | from botocore.handlers import disable\_signing |
|  |  | from datumaro.util import take\_by # can be changed to itertools.batched after migration to python3.12 |
| Expand All | | @@ -32,6 +33,7 @@ |
|  |  | from cvat.apps.engine.log import ServerLogManager |
|  |  | from cvat.apps.engine.models import CloudProviderChoice, CredentialsTypeChoice |
|  |  | from cvat.apps.engine.utils import get\_cpu\_number |
|  |  | from cvat.utils.http import PROXIES\_FOR\_UNTRUSTED\_URLS |
|  |  |  |
|  |  | class NamedBytesIO(BytesIO): |
|  |  | @property |
| Expand Down  Expand Up | | @@ -442,7 +444,9 @@ def \_\_init\_\_(self, |
|  |  | kwargs[key] = arg\_v |
|  |  |  |
|  |  | session = boto3.Session(\*\*kwargs) |
|  |  | self.\_s3 = session.resource("s3", endpoint\_url=endpoint\_url) |
|  |  | self.\_s3 = session.resource("s3", endpoint\_url=endpoint\_url, |
|  |  | config=Config(proxies=PROXIES\_FOR\_UNTRUSTED\_URLS or {}), |
|  |  | ) |
|  |  |  |
|  |  | # anonymous access |
|  |  | if not any([access\_key\_id, secret\_key, session\_token]): |
| Expand Down  Expand Up | | @@ -644,11 +648,14 @@ def \_\_init\_\_( |
|  |  | super().\_\_init\_\_(prefix=prefix) |
|  |  | self.\_account\_name = account\_name |
|  |  | if connection\_string: |
|  |  | self.\_blob\_service\_client = BlobServiceClient.from\_connection\_string(connection\_string) |
|  |  | self.\_blob\_service\_client = BlobServiceClient.from\_connection\_string( |
|  |  | connection\_string, proxies=PROXIES\_FOR\_UNTRUSTED\_URLS) |
|  |  | elif sas\_token: |
|  |  | self.\_blob\_service\_client = BlobServiceClient(account\_url=self.account\_url, credential=sas\_token) |
|  |  | self.\_blob\_service\_client = BlobServiceClient( |
|  |  | account\_url=self.account\_url, credential=sas\_token, proxies=PROXIES\_FOR\_UNTRUSTED\_URLS) |
|  |  | else: |
|  |  | self.\_blob\_service\_client = BlobServiceClient(account\_url=self.account\_url) |
|  |  | self.\_blob\_service\_client = BlobServiceClient( |
|  |  | account\_url=self.account\_url, proxies=PROXIES\_FOR\_UNTRUSTED\_URLS) |
|  |  | self.\_client = self.\_blob\_service\_client.get\_container\_client(container) |
|  |  |  |
|  |  | @property |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[supervisord/worker.export.conf](#diff-a4a22896043231faff86db50686a8c53f55dfaf51c19deffafed89a5393637ff "supervisord/worker.export.conf")

Show comments

[View file](/cvat-ai/cvat/blob/f2346934c80bd91740f55c2788ef7d535a291d4c/supervisord/worker.export.conf)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,3 +25,6 @@ environment=VECTOR\_EVENT\_HANDLER="SynchronousLogstashHandler",CVAT\_POSTGRES\_APPL |
|  |  | numprocs=%(ENV\_NUMPROCS)s |
|  |  | process\_name=%(program\_name)s-%(process\_num)d |
|  |  | autorestart=true |
|  |  |  |
|  |  | [program:smokescreen] |
|  |  | command=smokescreen --listen-ip=127.0.0.1 %(ENV\_SMOKESCREEN\_OPTS)s |

3 changes: 3 additions & 0 deletions

3
[tests/allow\_minio.sh](#diff-ae63bacf9995ae6c98aaaa940a3ef2f2a390a9580f130b82a47a0400c0f78a6d "tests/allow_minio.sh")

Show comments

[View file](/cvat-ai/cvat/blob/f2346934c80bd91740f55c2788ef7d535a291d4c/tests/allow_minio.sh)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,3 @@ |
|  |  | # Same as allow\_webhooks\_receiver.sh, but for minio. |
|  |  | minio\_ip\_addr="$(getent hosts minio | head -1 | awk '{ print $1 }')" |
|  |  | export SMOKESCREEN\_OPTS="$SMOKESCREEN\_OPTS --allow-address=\"$minio\_ip\_addr\"" |

10 changes: 10 additions & 0 deletions

10
[tests/docker-compose.minio.yml](#diff-9910517800e83b4bcff18873fe3c8cff98f76d750643aec0c108669593f6bc07 "tests/docker-compose.minio.yml")

Show comments

[View file](/cvat-ai/cvat/blob/f2346934c80bd91740f55c2788ef7d535a291d4c/tests/docker-compose.minio.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,14 @@ |
|  |  | x-allow-minio: &allow-minio |
|  |  | depends\_on: |
|  |  | - minio |
|  |  | volumes: |
|  |  | - ./tests/allow\_minio.sh:/etc/cvat/init.d/allow\_minio.sh:ro |
|  |  |  |
|  |  | services: |
|  |  | cvat\_server: \*allow-minio |
|  |  | cvat\_worker\_export: \*allow-minio |
|  |  | cvat\_worker\_import: \*allow-minio |
|  |  |  |
|  |  | minio: |
|  |  | image: quay.io/minio/minio:RELEASE.2022-09-17T00-09-45Z |
|  |  | hostname: minio |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f234693`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcvat-ai%2Fcvat%2Fcommit%2Ff2346934c80bd91740f55c2788ef7d535a291d4c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0f57b48b_20250110_164333.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcvat-ai%2Fcvat%2Fsecurity%2Fadvisories%2FGHSA-q684-4jjh-83g6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcvat-ai%2Fcvat%2Fsecurity%2Fadvisories%2FGHSA-q684-4jjh-83g6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=cvat-ai%2Fcvat)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cvat-ai](/cvat-ai)
/
**[cvat](/cvat-ai/cvat)**
Public

* [Notifications](/login?return_to=%2Fcvat-ai%2Fcvat) You must be signed in to change notification settings
* [Fork
  3.1k](/login?return_to=%2Fcvat-ai%2Fcvat)
* [Star
   12.9k](/login?return_to=%2Fcvat-ai%2Fcvat)

* [Code](/cvat-ai/cvat)
* [Issues
  522](/cvat-ai/cvat/issues)
* [Pull requests
  43](/cvat-ai/cvat/pulls)
* [Discussions](/cvat-ai/cvat/discussions)
* [Actions](/cvat-ai/cvat/actions)
* [Projects
  4](/cvat-ai/cvat/projects)
* [Wiki](/cvat-ai/cvat/wiki)
* [Security](/cvat-ai/cvat/security)
* [Insights](/cvat-ai/cvat/pulse)

Additional navigation options

* [Code](/cvat-ai/cvat)
* [Issues](/cvat-ai/cvat/issues)
* [Pull requests](/cvat-ai/cvat/pulls)
* [Discussions](/cvat-ai/cvat/discussions)
* [Actions](/cvat-ai/cvat/actions)
* [Projects](/cvat-ai/cvat/projects)
* [Wiki](/cvat-ai/cvat/wiki)
* [Security](/cvat-ai/cvat/security)
* [Insights](/cvat-ai/cvat/pulse)

# SSRF via custom cloud storage endpoints

High

[SpecLad](/SpecLad)
published
GHSA-q684-4jjh-83g6
Jun 13, 2024

## Package

CVAT

## Affected versions

2.1.0-2.14.2

## Patched versions

2.14.3

## Description

### Impact

CVAT allows users to supply custom endpoint URLs for cloud storages based on Amazon S3 and Azure Blob Storage.

An attacker with a CVAT account can exploit this feature by specifying URLs whose host part is an intranet IP address or an internal domain name. By doing this, the attacker may be able to probe the network that the CVAT backend runs in for HTTP(S) servers.

In addition, if there is a web server on this network that is

1. sufficiently API-compatible with an Amazon S3 or Azure Blob Storage endpoint, and
2. either allows anonymous access, or allows authentication with credentials that are known by the attacker

then the attacker may be able to create a cloud storage linked to this server. They may then be able to:

1. List files on the server.
2. Extract files from the server, if these files are of a type that CVAT supports reading from cloud storage (media data (such as images/videos/archives), importable annotations or datasets, task/project backups).
3. Overwrite files on this server with exported annotations/datasets/backups.

The exact capabilities of the attacker will depend on how the internal server is configured.

### Patches

Upgrade to CVAT 2.14.3.

In this release, the existing SSRF mitigation measures are applied to requests to cloud providers, with access to intranet IP addresses prohibited by default.

### Workarounds

* Use network security solutions such as virtual networks or firewalls to prohibit network access from the CVAT backend to unrelated servers on your internal network.
* Require authentication for access to internal servers.

### References

Fix commit: [f234693](https://github.com/cvat-ai/cvat/commit/f2346934c80bd91740f55c2788ef7d535a291d4c)

### Severity

High

7.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
Low

User interaction
None

Scope
Changed

Confidentiality
Low

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:H/A:N

### CVE ID

CVE-2024-37164

### Weaknesses

[CWE-918](/advisories?query=cwe%3A918)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


