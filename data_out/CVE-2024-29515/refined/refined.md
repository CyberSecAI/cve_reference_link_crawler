Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-29515 (Based on the provided description, not official CVE description)

**Affected Product:** lepton-cms

**Affected Version:** 7.1.0

**Root Cause of Vulnerability:**
The vulnerability stems from insufficient filtering of allowed file types during upload. Specifically, the system allows an authenticated user to modify the list of allowed file extensions, which is stored in the database. This setting is then used to determine which file types can be uploaded. The system does not perform any sanitization of this list, allowing an attacker to add dangerous extensions such as "php". This leads to arbitrary code execution via file upload, because the system subsequently allows the upload of PHP files, which can then be executed.

**Weaknesses/Vulnerabilities Present:**
*   **Unrestricted File Upload:** The system permits the upload of arbitrary file types.
*   **Insufficient Input Validation:** The application fails to properly validate and sanitize user-provided data when setting allowed file extensions.
*   **Direct Use of User Input in Configuration:**  The user-supplied file extension list is directly used in the application's configuration without proper checks.

**Impact of Exploitation:**
*   **Arbitrary Code Execution:** Attackers can upload and execute arbitrary PHP code on the server, leading to complete compromise of the system.
*   **Full System Compromise:** Successful exploitation can lead to a wide range of malicious activities such as data breaches, website defacement, malware distribution, etc.

**Attack Vectors:**
*   **File Upload:** The vulnerability is triggered by uploading a malicious file (in this case a PHP file).
*   **Settings Modification:** An attacker needs to modify the list of allowed file extensions via the settings panel before uploading the malicious file.

**Required Attacker Capabilities/Position:**
*   **Authentication:** The attacker must have valid user credentials to log into the backend and modify the settings.
*   **Access to Settings Panel:** The attacker must have the permission to access and modify the settings related to allowed file extensions.