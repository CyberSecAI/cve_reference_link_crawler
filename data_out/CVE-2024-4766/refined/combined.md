=== Content from bugzilla.mozilla.org_9ba9a91f_20250110_144745.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1871214)
* [XML](/show_bug.cgi?ctype=xml&id=1871214)

Closed
[Bug 1871214](/show_bug.cgi?id=1871214)
(CVE-2024-4766)

Opened 1 year ago
Closed 9 months ago

# Android- Webshare dialog hides fullscreen notification lead to spoof

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Android- Webshare dialog hides fullscreen notification lead to spoof

## Categories

### (Fenix :: General, defect, P1)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### (firefox125 wontfix, firefox126+ fixed, firefox127+ fixed, firefox132 verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

127 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |
| firefox127 | [+](/buglist.cgi?f1=cf_tracking_firefox127&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed) |
| firefox132 | --- | [verified](/buglist.cgi?f1=cf_status_firefox132&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox125 |  | wontfix |
| firefox126 | + | fixed |
| firefox127 | + | fixed |
| firefox132 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: pollymce)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f22c2b42f92dc0a72f0ba9d0a212764e?d=mm&size=40)  [pollymce](/user_profile?user_id=750904)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1878043](/show_bug.cgi?id=1878043 "RESOLVED DUPLICATE - Android Full Screen Notification Bypass with webshare dialog"), [1883468](/show_bug.cgi?id=1883468 "RESOLVED DUPLICATE - WebShare API Can Hide Fullscreen Notifications on Android"), [1885793](/show_bug.cgi?id=1885793 "RESOLVED DUPLICATE - When calling fullscreen mode and navigator share, the warning can be covered.")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [group4][qa-triaged] [adv-main126+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-4766

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [group4][qa-triaged] [adv-main126+]

Change Request:

---

Bug Flags:

| [tjr](/user_profile?user_id=578488) | [sec-bounty](#a11970707_578488 "1 year ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 1 obsolete file)

| [document\_6273567736090069881.mp4](/attachment.cgi?id=9369784)  [1 year ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   2.02 MB, video/mp4 |  | [Details](/attachment.cgi?id=9369784&action=edit) |
| --- | --- | --- |
| [webshare.html](/attachment.cgi?id=9369785)  [1 year ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   945 bytes, text/html |  | [Details](/attachment.cgi?id=9369785&action=edit) |
| [Bug 1871214 - improve share interaction with fullscreen](/attachment.cgi?id=9398329)  [9 months ago](#c8)  [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)   48 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#c12 "9 months ago") | [Details](/attachment.cgi?id=9398329&action=edit) | [Review](/attachment.cgi?id=9398329) |
| [WIP: Bug 1871214 - improve share interaction with fullscreen](/attachment.cgi?id=9399368)  [9 months ago](#c20)  [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9399368&action=edit) | [Review](/attachment.cgi?id=9399368) |
| [Bug 1871214 - improve share interaction with fullscreen](/attachment.cgi?id=9399369)  [9 months ago](#c21)  [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a11354449_600971 "9 months ago") | [Details](/attachment.cgi?id=9399369&action=edit) | [Review](/attachment.cgi?id=9399369) |
| [advisory.txt](/attachment.cgi?id=9401092)  [8 months ago](#c24)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   338 bytes, text/plain |  | [Details](/attachment.cgi?id=9401092&action=edit) |
| [az\_recorder\_20240923\_145155\_edited.mp4](/attachment.cgi?id=9426465)  [4 months ago](#c25)  [Mira Lobontiu (Android QA)](/user_profile?user_id=621020)   1.67 MB, video/mp4 |  | [Details](/attachment.cgi?id=9426465&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1871214#c0)• 1 year ago |
|  | |

Attached video
[document\_6273567736090069881.mp4](attachment.cgi?id=9369784)
— [Details](attachment.cgi?id=9369784&action=edit)

I found a vulnerability in firefox android where a webshare dialog can cover fullscreen notifications which can lead to spoofs.

steps to produce

1. open <http://103.186.0.20/webshare.html> or webshare.html
2. double tap on button

OS: Android 12 (Samsung M31)

Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1871214#c1)• 1 year ago |
|  | |

Attached file
[webshare.html](attachment.cgi?id=9369785)
— [Details](attachment.cgi?id=9369785&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1871214#c2)• 1 year ago |
|  | |

steps to produce

1. open <https://103.186.0.20/webshare.html> or webshare.html
2. double tap on button

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a19904_159069)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → FenixSee Also: → [1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1871214#c3)• 1 year ago |
|  | |

I'll mark this sec-high for now, but it kind of feels like the same basic issue as [bug 1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"), because we've got a system prompt that is doing the overlapping.

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a2468558_430528)• 1 year ago |

Priority: -- → P2

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a2468570_430528)• 1 year ago |

Severity: -- → S2

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a4208560_406194)• 11 months ago |

Duplicate of this bug: [1878043](/show_bug.cgi?id=1878043 "RESOLVED DUPLICATE - Android Full Screen Notification Bypass with webshare dialog")

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1871214#c5)• 11 months ago |
|  | |

Titouan's fix for [bug 1874795](/show_bug.cgi?id=1874795 "NEW") is expected to also fix this bug. Assigning this bug to Titouan as a reminder to test this bug's STR.

Assignee: nobody → tthibaudWhiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [group4]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a6442707_406194)• 10 months ago |

Duplicate of this bug: [1883468](/show_bug.cgi?id=1883468 "RESOLVED DUPLICATE - WebShare API Can Hide Fullscreen Notifications on Android")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a7588709_1689)• 10 months ago |

Duplicate of this bug: [1885793](/show_bug.cgi?id=1885793 "RESOLVED DUPLICATE - When calling fullscreen mode and navigator share, the warning can be covered.")

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1871214#c8)• 9 months ago |
|  | |

Attached file
[Bug 1871214 - improve share interaction with fullscreen](attachment.cgi?id=9398329)
— [Details](attachment.cgi?id=9398329&action=edit)

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a10829915_750904)• 9 months ago |

[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected)
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected)

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1871214#c9)• 9 months ago |
|  | |

Comment on [attachment 9398329](/attachment.cgi?id=9398329 "Bug 1871214 - improve share interaction with fullscreen") [[details]](/attachment.cgi?id=9398329&action=edit "Bug 1871214 - improve share interaction with fullscreen")

[Bug 1871214](/show_bug.cgi?id=1871214 "VERIFIED FIXED - Android- Webshare dialog hides fullscreen notification lead to spoof") - improve share interaction with fullscreen

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: It would be quite difficult. It's a one line change to exit fullscreen before the share dialog is shown and there is no indication in the code as to why we are doing that.

  Even if a malicious actor figured out how to exploit this, it would be a lot of work to take advantage of it. They would need to build a website that perfectly mimicked the firefox android chrome. It would be difficult to get something web based that looked exactly like the android native ui components across a range of android OS versions and manufacturers, where there are a lot of visual differences.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which branches (beta, release, and/or ESR) are affected by this flaw, and do the release status flags reflect this affected/unaffected state correctly?**: all of these, and yes
* **If not all supported branches, which bug introduced the flaw?**: n/a
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: It's a very small change and we don't think it's very risky, but would be great to test a bit around sharing.
* **Is the patch ready to land after security approval is given?**: Yes
* **Is Android affected?**: Yes
[Attachment #9398329](/attachment.cgi?id=9398329&action=edit "Bug 1871214 - improve share interaction with fullscreen") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a10840080_75935)• 9 months ago |

[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a10840381_406194)• 9 months ago |

Assignee: tthibaud → polly

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1871214#c10)• 9 months ago |
|  | |

Priority P1 because this bug has been assigned to a squad/group.

Priority: P2 → P1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1871214#c11)• 9 months ago |
|  | |

Why do we have the fullscreen toast buried at the bottom of the screen? If it were at the top it wouldn't be behind many of the OS permission prompts (though that could change on different Android versions). And on modern tall-and-skinny Android phones it's very easy to miss things happening at the other end of the phone from where your attention is. We don't want what is supposed to be an attention-grabbing notification playing wallflower near the edge of the screen—it could move more toward the center. And consider making the placement depend on where the user is interacting with the content and show the toast at the top or bottom according to which is closer to that interaction.

There's no OS where people double-click on buttons. The need for two clicks means you need to construct an engaging spoof and that limits the impact to those who will engage with the content; sec-high bugs require "normal web interaction". I'm lowering the severity here to sec-moderate.

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1871214#c12)• 9 months ago |
|  | |

Comment on [attachment 9398329](/attachment.cgi?id=9398329 "Bug 1871214 - improve share interaction with fullscreen") [[details]](/attachment.cgi?id=9398329&action=edit "Bug 1871214 - improve share interaction with fullscreen")

[Bug 1871214](/show_bug.cgi?id=1871214 "VERIFIED FIXED - Android- Webshare dialog hides fullscreen notification lead to spoof") - improve share interaction with fullscreen

sec-approval+ = dveditz

[Attachment #9398329](/attachment.cgi?id=9398329&action=edit "Bug 1871214 - improve share interaction with fullscreen") -
Flags: sec-approval? → sec-approval+

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1871214#c13)• 9 months ago |
|  | |

Thanks Daniel for the update!

We could move the full screen notification message, we provide this ui in the Fenix code. However, on Android it is more common to get important system notification messages delivered to the bottom of the screen, as this is usually where a user's eyes and thumbs are focused - [see material design docs here](https://m1.material.io/components/snackbars-toasts.html). So I am inclined to leave it where it is.

It's an interesting idea to place it based on where the user is interacting most with the content, but i'm not sure how we would best determine the location of maximal interaction, and i wonder if it would have as much impact if the notification moved between top or bottom of the screen.

I am hoping this is ok as you have already given sec approval but happy to discuss further if you would like!

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1871214#c14)• 9 months ago |
|  | |

Pushed by pmceldowney@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/04a668ef9c90>
improve share interaction with fullscreen r=android-reviewers,twhite

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1871214#c15)• 9 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/04a668ef9c90>

Group: mobile-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 9 months ago
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 127 Branch

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11274859_695136)• 9 months ago |

[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)
[tracking-firefox127](/buglist.cgi?f1=cf_tracking_firefox127&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox127&o1=equals&v1=%2B)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1871214#c16)• 9 months ago |
|  | |

The patch landed in nightly and beta is affected.

:pollymce, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox126` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(polly)

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1871214#c17)• 9 months ago |
|  | |

I think based on Daniel's comment above: <https://bugzilla.mozilla.org/show_bug.cgi?id=1871214#c11>

this probably doesn't require an uplift as it's been marked sec-moderate. But please chip in if you disagree!

Flags: needinfo?(polly) → needinfo?(dveditz)

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11344463_750904)• 9 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=wontfix)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) → ---

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1871214#c18)• 9 months ago |
|  | |

(In reply to Polly McEldowney [:pollymce] from [comment #17](/show_bug.cgi?id=1871214#c17 "VERIFIED FIXED - Android- Webshare dialog hides fullscreen notification lead to spoof"))

> I think based on Daniel's comment above: <https://bugzilla.mozilla.org/show_bug.cgi?id=1871214#c11>
>
> this probably doesn't require an uplift as it's been marked sec-moderate. But please chip in if you disagree!

For security bugs, we aim to uplift them to beta so the delta of exposure is lowered. (difference in time landing in central to being released)

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1871214#c19)• 9 months ago |
|  | |

ah ok - thanks for the clarification Donal! i'll sort that out now :)

Flags: needinfo?(dveditz)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11349902_695136)• 9 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=wontfix) → [affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1871214#c20)• 9 months ago |
|  | |

Attached file
[WIP: Bug 1871214 - improve share interaction with fullscreen](attachment.cgi?id=9399368) (obsolete)
— [Details](attachment.cgi?id=9399368&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D208465>

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1871214#c21)• 9 months ago |
|  | |

Attached file
[Bug 1871214 - improve share interaction with fullscreen](attachment.cgi?id=9399369)
— [Details](attachment.cgi?id=9399369&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D208465>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11350223_600971)• 9 months ago |

[Attachment #9399369](/attachment.cgi?id=9399369&action=edit "Bug 1871214 - improve share interaction with fullscreen") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1871214#c22)• 9 months ago |
|  | |

### beta Uplift Approval Request

* **User impact if declined**: sec bug would still exist
* **Code covered by automated testing**: no
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: yes
* **Steps to reproduce for manual QE testing**: described in bug
* **Risk associated with taking this patch**: low
* **Explanation of risk level**: it's a small one line change
* **String changes made/needed**: no
* **Is Android affected?**: yes
Flags: qe-verify+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11350565_600971)• 9 months ago |

[Attachment #9399368](/attachment.cgi?id=9399368&action=edit "WIP: Bug 1871214 - improve share interaction with fullscreen") -
Attachment is obsolete: true

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11354449_600971)• 8 months ago |

[Attachment #9399369](/attachment.cgi?id=9399369&action=edit "Bug 1871214 - improve share interaction with fullscreen") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11354709_640478)• 8 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1871214#c23)• 8 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/5bec81248e06>

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11486944_488993)• 8 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [group4] → [reporter-external] [client-bounty-form] [verif?] [group4][qa-triaged]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a11970707_578488)• 8 months ago |

Flags: sec-bounty? → sec-bounty+

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a12151315_486733)• 8 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [group4][qa-triaged] → [reporter-external] [client-bounty-form] [verif?] [group4][qa-triaged] [adv-main126+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1871214#c24)• 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401092)
— [Details](attachment.cgi?id=9401092&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a12226169_578488)• 8 months ago |

Alias: CVE-2024-4766

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a13956616_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a23577204_1689)• 4 months ago |

Group: core-security-release

|  | [Mira Lobontiu (Android QA)](/user_profile?user_id=621020) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1871214#c25)• 4 months ago |
|  | |

Attached video
[az\_recorder\_20240923\_145155\_edited.mp4](attachment.cgi?id=9426465)
— [Details](attachment.cgi?id=9426465&action=edit)

Verified as fixed on the Fenix Nightly 132.0a1 from 9/23 with Google Pixel 6 (Andorid 15).

|  | [Mira Lobontiu (Android QA)](/user_profile?user_id=621020) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871214#a23957477_621020)• 4 months ago |

Status: RESOLVED → VERIFIED
[status-firefox132](/buglist.cgi?f1=cf_status_firefox132&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox132&o1=equals&v1=verified)Flags: qe-verify+
You need to [log in](/show_bug.cgi?id=1871214&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_127421ec_20250110_144746.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1871217)
* [XML](/show_bug.cgi?ctype=xml&id=1871217)

Closed
[Bug 1871217](/show_bug.cgi?id=1871217)

Opened 1 year ago
Closed 9 months ago

# Android-permission prompt obscured fullscreen notification lead to spoof

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Android-permission prompt obscured fullscreen notification lead to spoof

## Categories

### (Fenix :: General, defect, P1)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### (firefox124 wontfix, firefox125 wontfix, firefox126+ verified, firefox127+ verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

127 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=verified) |
| firefox127 | [+](/buglist.cgi?f1=cf_tracking_firefox127&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox124 |  | wontfix |
| firefox125 |  | wontfix |
| firefox126 | + | verified |
| firefox127 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: titouan)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/968f8efd6bc3bd81eaf677cd2184bc5b?d=mm&size=40)  [titouan](/user_profile?user_id=719807)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1881902](/show_bug.cgi?id=1881902 "RESOLVED DUPLICATE - Permission Dialog allows to conduct Full Screen Spoof attack without notification on Android Firefox Nightly")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2024-4766](/show_bug.cgi?id=1871214 "VERIFIED FIXED - Android- Webshare dialog hides fullscreen notification lead to spoof"), [1821906](/show_bug.cgi?id=1821906 "RESOLVED FIXED - Geolocation permission hide notification fullscreen")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [group4] [adv-main126+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [group4] [adv-main126+]

Change Request:

---

Bug Flags:

| [tjr](/user_profile?user_id=578488) | [sec-bounty](#a11969486_578488 "1 year ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [permissionfullscreen.html](/attachment.cgi?id=9369788)  [1 year ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   422 bytes, text/html |  | [Details](/attachment.cgi?id=9369788&action=edit) |
| --- | --- | --- |
| [document\_6061956479827578398.mp4](/attachment.cgi?id=9369789)  [1 year ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   1.27 MB, video/mp4 |  | [Details](/attachment.cgi?id=9369789&action=edit) |
| [Bug 1871217: Improve permission handling in Fullscreen](/attachment.cgi?id=9395506)  [9 months ago](#c8)  [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)   48 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#c11 "9 months ago") | [Details](/attachment.cgi?id=9395506&action=edit) | [Review](/attachment.cgi?id=9395506) |
| [Bug 1871217: Improve permission handling in Fullscreen](/attachment.cgi?id=9397607)  [9 months ago](#c12)  [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a11282711_600971 "9 months ago") | [Details](/attachment.cgi?id=9397607&action=edit) | [Review](/attachment.cgi?id=9397607) |
| [QA.png](/attachment.cgi?id=9399382)  [8 months ago](#c26)  [Delia Pop (Android QA)](/user_profile?user_id=697911)   175.16 KB, image/png |  | [Details](/attachment.cgi?id=9399382&action=edit) |
| [advisory.txt](/attachment.cgi?id=9401093)  [8 months ago](#c31)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   338 bytes, text/plain |  | [Details](/attachment.cgi?id=9401093&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1871217#c0)• 1 year ago |
|  | |

Attached file
[permissionfullscreen.html](attachment.cgi?id=9369788)
— [Details](attachment.cgi?id=9369788&action=edit)

I found a vulnerability in firefox android where a microphone permission prompt can cover fullscreen notifications which can lead to spoofs.

steps to produce

1 . open <https://103.186.0.20/permissionfullscreen.html> or permissionfullscreen.html

2. click the button.

OS: Android 12 (Samsung M31)

Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1871217#c1)• 1 year ago |
|  | |

Attached video
[document\_6061956479827578398.mp4](attachment.cgi?id=9369789)
— [Details](attachment.cgi?id=9369789&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a18672_159069)• 1 year ago |

See Also: → [CVE-2024-4766](/show_bug.cgi?id=1871214 "VERIFIED FIXED - Android- Webshare dialog hides fullscreen notification lead to spoof")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a18721_159069)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → FenixSee Also: → [1821906](/show_bug.cgi?id=1821906 "RESOLVED FIXED - Geolocation permission hide notification fullscreen")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a1790101_406194)• 1 year ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a2467394_430528)• 1 year ago |

Severity: -- → S2Priority: -- → P2

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1871217#c2)• 11 months ago |
|  | |

Titouan's fix for [bug 1874795](/show_bug.cgi?id=1874795 "NEW") is expected to also fix this bug. Assigning this bug to Titouan as a reminder to test this bug's STR.

Assignee: nobody → tthibaudWhiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [group4]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a7587688_1689)• 10 months ago |

Duplicate of this bug: [1881902](/show_bug.cgi?id=1881902 "RESOLVED DUPLICATE - Permission Dialog allows to conduct Full Screen Spoof attack without notification on Android Firefox Nightly")

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1871217#c4)• 10 months ago |
|  | |

We had some hard time reproducing this bug reliably.

Here is the STR that works for us:

1. Open `about:config` and set `media.devices.insecure.enabled` and `media.getusermedia.insecure.enabled` to `true`
2. Make sure Fenix has Microphone permission set as "Always ask" (from the device's app settings)
3. Force Quit Fenix
4. Open Fenix and navigate to the HTML attachment. (an other solution is to serve this file with `python3 -m http.server` and access it from your device)
5. Click on the "Click" button.

We should then see the Fenix permission request (Android level), click "Only one", then see the website permission request.

The website is already in fullscreen and the snackbar was never visible.

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1871217#c5)• 10 months ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1871217&comment_id=16862134 "1 revision") |
|  | |

The problem we see is: in the case of the HTML attachment provided, the webpage asks for fullscreen and *then* requests the Microphone permission.

So, at the time our code processes the Fullscreen request, we have no way to know that there's a Microphone permission request coming.

An option might be to have a kind of time threshold where we wait some defined amount of time (*x seconds*) before going fullscreen, so that we can process permission requests in that time. But we think that the issue would still exist, the website would only have to wait for *x seconds* before requesting the permission. (Unless we show a kind of warning that you're about to go fullscreen before really going fullscreen).

Another option would be to show the Fullscreen notification somewhere else on the screen, so that we make sure it's visible.

Is there something we are missing?

Does someone have an opinion on how to correctly handle this case?

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1871217#c6)• 10 months ago |
|  | |

We think we have 2 possible avenues to explore here:

1. Do What Chrome Android Does

   Go fullscreen when asked, but don't ask for permissions when fullscreen.

   (NB This could be tricky to implement as we have already looked at this. The previous fix will ignore the site permission request if there is already a dialog showing for full screen permissions. Maybe we could extend this to also look for any pending full screen requests, and just bin the permission request entirely if we are about to go fullscreen?)
2. Do What FF Desktop Does

   Go fullscreen when asked, then if asked for a permission, revert to not full screen and show the permission request.

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1871217#c7)• 10 months ago |
|  | |

Hey :owlish and :dveditz, does any of you have an opinion on what would be the right resolution for this bug?

(:skhan suggested both of you might be helpfull here)

Flags: needinfo?(dveditz)Flags: needinfo?(bugzeeeeee)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1871217#c8)• 9 months ago |
|  | |

Attached file
[Bug 1871217: Improve permission handling in Fullscreen](attachment.cgi?id=9395506)
— [Details](attachment.cgi?id=9395506&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a9435802_600971)• 9 months ago |

[Attachment #9395506](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Attachment description: WIP: Bug 1871217: testing phabricator - temp → Bug 1871217: Improve permission handling in Fullscreen

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1871217#c9)• 9 months ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1871217&comment_id=16881640 "1 revision") |
|  | |

We've gone ahead with option 2, reasoning being:

* it is consistent with ff desktop
* it is more resilient to timing issues than just checking for the existence of the notification dialog
* users might need to action the permission request for the best fullscreen experience, eg. if they are in a video call and need to give microphone permission

Patch is attached above, we also have a unit test that we can submit later

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a9443147_750904)• 9 months ago |

Flags: qe-verify+

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a9447644_719807)• 9 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1871217#c10)• 9 months ago |
|  | |

Comment on [attachment 9395506](/attachment.cgi?id=9395506 "Bug 1871217: Improve permission handling in Fullscreen") [[details]](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen")

[Bug 1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"): Improve permission handling in Fullscreen

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: We think it wouldn't be easy, as the STR we know depends on steps which are not referenced in any way in the patch.

  Even if they knew how to exploit the breach, it seems hard to take advantage of it, mainly because they would need to reproduce the UI of Firefox + the Android Status bar for the specific phone so that they can fool the user into thinking they are not in fullscreen.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which branches (beta, release, and/or ESR) are affected by this flaw, and do the release status flags reflect this affected/unaffected state correctly?**: Beta, Release, ESR. Status reflects that correctly.
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Very easy, we just need to create the backport
* **How likely is this patch to cause regressions; how much testing does it need?**: We think it's not very likely to cause regression.

  It would be good to have some testing around fullscreen and permissions in general.
* **Is the patch ready to land after security approval is given?**: Yes
* **Is Android affected?**: Yes
[Attachment #9395506](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a9490025_75935)• 9 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1871217#c11)• 9 months ago |
|  | |

Comment on [attachment 9395506](/attachment.cgi?id=9395506 "Bug 1871217: Improve permission handling in Fullscreen") [[details]](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen")

[Bug 1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"): Improve permission handling in Fullscreen

sec-approval=dveditz

thanks for waiting while we got the 125 release out. We'll want to uplift this one to beta

Flags: needinfo?(dveditz)
[Attachment #9395506](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a10371312_1689)• 9 months ago |

[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)
[tracking-firefox127](/buglist.cgi?f1=cf_tracking_firefox127&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox127&o1=equals&v1=%2B)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1871217#c12)• 9 months ago |
|  | |

Attached file
[Bug 1871217: Improve permission handling in Fullscreen](attachment.cgi?id=9397607)
— [Details](attachment.cgi?id=9397607&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D206890>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a10404080_600971)• 9 months ago |

[Attachment #9397607](/attachment.cgi?id=9397607&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1871217#c13)• 9 months ago |
|  | |

### beta Uplift Approval Request

* **User impact if declined**: A security issue remains there while the code ships in version 126
* **Code covered by automated testing**: no
* **Fix verified in Nightly**: no
* **Needs manual QE test**: yes
* **Steps to reproduce for manual QE testing**: Follow the STR on Bugzilla
* **Risk associated with taking this patch**: low
* **Explanation of risk level**: small change, but as it's a security bug, the patch hasn't baked in Nightly before this uplift
* **String changes made/needed**: No
* **Is Android affected?**: yes

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1871217#c14)• 9 months ago |
|  | |

:tthibaud adding a reminder next week is the final week of Beta for Fx126.

This will need to land in central before Thursday 2024-05-02 so we can uplift it by the final 126 beta build.

If not earlier since this already has sec-approval.

Flags: needinfo?(tthibaud)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1871217#c15)• 9 months ago |
|  | |

Is there a prefered day for landing? If I understand correctly I should land it as close as possible to Thursday 2024-05-02, so I guess Wednesday 2024-05-02 would be the best? Or is there something I'm missing?

Flags: needinfo?(tthibaud) → needinfo?(dmeehan)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1871217#c16)• 9 months ago |
|  | |

It's up to the sec team to communicate if there are any concerns around timing with landing.

I don't see anything mentioned when they granted sec-approval, that they had concerns or direction on when to land.

At least by Wednesday 2024-05-02 works in terms of uplifting on Thursday before the final beta build.

Flags: needinfo?(dmeehan)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1871217#c17)• 9 months ago |
|  | |

:dveditz, do you have any direction we should follow for landing the patch?

Flags: needinfo?(dveditz)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1871217#c18)• 9 months ago |
|  | |

Priority P1 because this bug has been assigned to a squad/group.

Priority: P2 → P1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1871217#c19)• 9 months ago |
|  | |

no additional instructions beyond the sec-approval. Land as soon as you can unless we explicitly give you a date to wait until.

Flags: needinfo?(dveditz)Priority: P1 → P2Summary: Android - Permission prompt obscured fullscreen notification lead to spoof → Android - Microphone permission prompt obscured fullscreen notification lead to spoof

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a10938843_1689)• 9 months ago |

Priority: P2 → P1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11126724_1689)• 9 months ago |

Summary: Android - Microphone permission prompt obscured fullscreen notification lead to spoof → Android-permission prompt obscured fullscreen notification lead to spoof

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1871217#c20)• 9 months ago |
|  | |

Pushed by tthibaud@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/55189bb1efab>
Improve permission handling in Fullscreen r=android-reviewers,twhite

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1871217#c21)• 9 months ago |
|  | |

The [uplift patch](https://phabricator.services.mozilla.com/D208008) is still pending `release-managers` group approval.

As the first patch is already in the landing queue now, is there something else we should do to get the uplifiting approval?

Flags: needinfo?(dmeehan)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1871217#c22)• 9 months ago |
|  | |

(In reply to Titouan Thibaud [:tthibaud] from [comment #21](/show_bug.cgi?id=1871217#c21 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"))

> The [uplift patch](https://phabricator.services.mozilla.com/D208008) is still pending `release-managers` group approval.
>
> As the first patch is already in the landing queue now, is there something else we should do to get the uplifiting approval?

No nothing else for you to do, we don't uplift until after it lands in central.

Uplifts for security bugs follow the same process as regular uplift requests. It doesn't get approved until we process the uplift.

Flags: needinfo?(dmeehan)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1871217#c23)• 9 months ago |
|  | |

Thanks a lot for the explainations!

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1871217#c24)• 9 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/55189bb1efab>

Group: mobile-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 9 months ago
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 127 Branch

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11282711_600971)• 9 months ago |

[Attachment #9397607](/attachment.cgi?id=9397607&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11282900_640478)• 9 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1871217#c25)• 9 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/d7f460434ca1>

|  | [Delia Pop (Android QA)](/user_profile?user_id=697911) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1871217#c26)• 8 months ago |
|  | |

Attached image
[QA.png](attachment.cgi?id=9399382)
— [Details](attachment.cgi?id=9399382&action=edit)

Verified as fixed on the latest Nightly 127.0a1 from 04/30 and Beta 126.0b7. Fenix exits the full screen mode when the website permission dialogue is displayed.

Tested with Samsung Galaxy Note10 (Android 12) and Motorola Moto G30 (Android 12).

|  | [Delia Pop (Android QA)](/user_profile?user_id=697911) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11352342_697911)• 8 months ago |

Status: RESOLVED → VERIFIED
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=verified)
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11464176_1689)• 8 months ago |

Duplicate of this bug: [1894326](/show_bug.cgi?id=1894326 "RESOLVED FIXED")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1871217#c28)• 8 months ago |
|  | |

tthibaud, in [bug 1894326](/show_bug.cgi?id=1894326 "RESOLVED FIXED") the reporter says this isn't actually fixed on Android beta. I'm not sure how to reconcile that with the verification in this bug. Can you take a look? Thanks.

Flags: needinfo?(tthibaud)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11969486_578488)• 8 months ago |

Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1871217#c29)• 8 months ago |
|  | |

Adding explanation for future context

(Titouan Thibaud [:tthibaud] from [comment #15](/show_bug.cgi?id=1871217#c15 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"))

> Is there a prefered day for landing? If I understand correctly I should land it as close as possible to Thursday 2024-05-02 [ed: that is, the last beta this cycle]

(Daniel Veditz [:dveditz] from [comment #19](/show_bug.cgi?id=1871217#c19 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"))

> no additional instructions beyond the sec-approval. Land as soon as you can unless we explicitly give you a date to wait until.

There's a balance between getting real-world testing in beta (or having time to test at all!) and keeping revealing patches out of the public eye as long as possible. Since our release cycles are so short, lack of testing is often a bigger risk than exposure. We prefer people land most security patches as soon as they are ready. As part of sec-approval we will ask that a subset of fixes delay their landing, weighing the severity of the exploit (e.g. zero- or one-click malware or UXSS), the complexity and likelihood of creating an exploit based on the patch, and the fragility (need for testing) of the patched code. In those cases we will explicitly ask that landing be delayed until a specific date/week.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11986049_1689)• 8 months ago |

No longer duplicate of this bug: [1894326](/show_bug.cgi?id=1894326 "RESOLVED FIXED")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1871217#c30)• 8 months ago |
|  | |

Owlish's needinfo was answered by Polly in [comment 9](/show_bug.cgi?id=1871217#c9 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof")

tthibaud's needinto was moved to [bug 1894326](/show_bug.cgi?id=1894326 "RESOLVED FIXED")

Flags: needinfo?(tthibaud)Flags: needinfo?(bugzeeeeee)

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a12170133_486733)• 8 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [group4] → [reporter-external] [client-bounty-form] [verif?] [group4] [adv-main126+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1871217#c31)• 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401093)
— [Details](attachment.cgi?id=9401093&action=edit)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a13955385_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a23575984_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1871217&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_0af25c4f_20250110_144747.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-21

## Security Vulnerabilities fixed in Firefox 126

Announced
May 14, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 126

*Updated November 6, 2024 to add CVE-2024-10941 which was fixed in Firefox 126 but not included in the original advisory.*

#### [#CVE-2024-4764: Use-after-free when audio input connected with multiple consumers](#CVE-2024-4764)

Reporter
Jan-Ivar Bruaroey
Impact
high
##### Description

Multiple WebRTC threads could have claimed a newly connected audio input leading to use-after-free.

##### References

* [Bug 1879093](https://bugzilla.mozilla.org/show_bug.cgi?id=1879093)

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4765: Web application manifests could have been overwritten via hash collision](#CVE-2024-4765)

Reporter
Dana Keeler
Impact
moderate
##### Description

Web application manifests were stored by using an insecure MD5 hash which allowed for a hash collision to overwrite another application's manifest. This could have been exploited to run arbitrary code in another application's context.
*This issue only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871109](https://bugzilla.mozilla.org/show_bug.cgi?id=1871109)

#### [#CVE-2024-4766: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2024-4766)

Reporter
Hafiizh
Impact
moderate
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871214](https://bugzilla.mozilla.org/show_bug.cgi?id=1871214)
* [Bug 1871217](https://bugzilla.mozilla.org/show_bug.cgi?id=1871217)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Firefox.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4771: Failed allocation could lead to use-after-free](#CVE-2024-4771)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A memory allocation check was missing which would lead to a use-after-free if the allocation failed. This could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1893891](https://bugzilla.mozilla.org/show_bug.cgi?id=1893891)

#### [#CVE-2024-4772: Use of insecure rand() function to generate nonce](#CVE-2024-4772)

Reporter
Hanno Böck
Impact
low
##### Description

An HTTP digest authentication nonce value was generated using `rand()` which could lead to predictable values.

##### References

* [Bug 1870579](https://bugzilla.mozilla.org/show_bug.cgi?id=1870579)

#### [#CVE-2024-4773: URL bar could be cleared after network error](#CVE-2024-4773)

Reporter
Islam
Impact
low
##### Description

When a network error occurred during page load, the prior content could have remained in view with a blank URL bar. This could have been used to obfuscate a spoofed web site.

##### References

* [Bug 1875248](https://bugzilla.mozilla.org/show_bug.cgi?id=1875248)

#### [#CVE-2024-4774: Undefined behavior in ShmemCharMapHashEntry()](#CVE-2024-4774)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShmemCharMapHashEntry()` code was susceptible to potentially undefined behavior by bypassing the move semantics for one of its data members.

##### References

* [Bug 1886598](https://bugzilla.mozilla.org/show_bug.cgi?id=1886598)

#### [#CVE-2024-4775: Invalid memory access in the built-in profiler](#CVE-2024-4775)

Reporter
Lukas Bernhard
Impact
low
##### Description

An iterator stop condition was missing when handling WASM code in the built-in profiler, potentially leading to invalid memory access and undefined behavior. *Note:* This issue only affects the application when the profiler is running.

##### References

* [Bug 1887332](https://bugzilla.mozilla.org/show_bug.cgi?id=1887332)

#### [#CVE-2024-4776: Window may remain disabled after file dialog is shown in full-screen](#CVE-2024-4776)

Reporter
Raphael
Impact
low
##### Description

A file dialog shown while in full-screen mode could have resulted in the window remaining disabled.

##### References

* [Bug 1887343](https://bugzilla.mozilla.org/show_bug.cgi?id=1887343)

#### [#CVE-2024-10941: Browser crash from invalid URI](#CVE-2024-10941)

Reporter
Anthony De Los Santos
Impact
low
##### Description

A malicious website could have included an iframe with an malformed URI resulting in a non-exploitable browser crash.

##### References

* [Bug 1880879](https://bugzilla.mozilla.org/show_bug.cgi?id=1880879)
* [Bug 1887614](https://bugzilla.mozilla.org/show_bug.cgi?id=1887614)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

#### [#CVE-2024-4778: Memory safety bugs fixed in Firefox 126](#CVE-2024-4778)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1838834%2C1889291%2C1889595%2C1890204%2C1891545)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


