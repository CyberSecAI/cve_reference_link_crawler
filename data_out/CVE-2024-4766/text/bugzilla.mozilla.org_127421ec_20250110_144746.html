

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1871217)
* [XML](/show_bug.cgi?ctype=xml&id=1871217)

Closed
[Bug 1871217](/show_bug.cgi?id=1871217)

Opened 1 year ago
Closed 9 months ago

# Android-permission prompt obscured fullscreen notification lead to spoof

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Android-permission prompt obscured fullscreen notification lead to spoof

## Categories

### (Fenix :: General, defect, P1)

[Product:](/describecomponents.cgi?product=Fenix)

Fenix
▾

Fenix
**Firefox for Android**: Fenix is an Android browser built using Android Components that re-imagines how a mobile browser would look if it was built from scratch to demonstrate better design for typical mobile use cases ([more info](https://www.mozilla.org/en-us/firefox/mobile/)).
[See Open Bugs in This Product](/buglist.cgi?product=Fenix&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Fenix)
Watch This Product

[Component:](/describecomponents.cgi?product=Fenix&component=General#General)

General
▾

Fenix :: General
For bugs in Firefox Android which do not fit into other more specific components
[See Open Bugs in This Component](/buglist.cgi?product=Fenix&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Fenix&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Fenix&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### (firefox124 wontfix, firefox125 wontfix, firefox126+ verified, firefox127+ verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

127 Branch

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=verified) |
| firefox127 | [+](/buglist.cgi?f1=cf_tracking_firefox127&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox124 |  | wontfix |
| firefox125 |  | wontfix |
| firefox126 | + | verified |
| firefox127 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: titouan)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/968f8efd6bc3bd81eaf677cd2184bc5b?d=mm&size=40)  [titouan](/user_profile?user_id=719807)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e49a28e5fed7340a3e51d46100902d93?d=mm&size=40)  [boek](/user_profile?user_id=599885)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1881902](/show_bug.cgi?id=1881902 "RESOLVED DUPLICATE - Permission Dialog allows to conduct Full Screen Spoof attack without notification on Android Firefox Nightly")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2024-4766](/show_bug.cgi?id=1871214 "VERIFIED FIXED - Android- Webshare dialog hides fullscreen notification lead to spoof"), [1821906](/show_bug.cgi?id=1821906 "RESOLVED FIXED - Geolocation permission hide notification fullscreen")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [group4] [adv-main126+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [group4] [adv-main126+]

Change Request:

---

Bug Flags:

| [tjr](/user_profile?user_id=578488) | [sec-bounty](#a11969486_578488 "1 year ago") | + |
| --- | --- | --- |
| [tjr](/user_profile?user_id=578488) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [permissionfullscreen.html](/attachment.cgi?id=9369788)  [1 year ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   422 bytes, text/html |  | [Details](/attachment.cgi?id=9369788&action=edit) |
| --- | --- | --- |
| [document\_6061956479827578398.mp4](/attachment.cgi?id=9369789)  [1 year ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   1.27 MB, video/mp4 |  | [Details](/attachment.cgi?id=9369789&action=edit) |
| [Bug 1871217: Improve permission handling in Fullscreen](/attachment.cgi?id=9395506)  [9 months ago](#c8)  [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)   48 bytes, text/x-phabricator-request | dveditz : [sec-approval+](#c11 "9 months ago") | [Details](/attachment.cgi?id=9395506&action=edit) | [Review](/attachment.cgi?id=9395506) |
| [Bug 1871217: Improve permission handling in Fullscreen](/attachment.cgi?id=9397607)  [9 months ago](#c12)  [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a11282711_600971 "9 months ago") | [Details](/attachment.cgi?id=9397607&action=edit) | [Review](/attachment.cgi?id=9397607) |
| [QA.png](/attachment.cgi?id=9399382)  [8 months ago](#c26)  [Delia Pop (Android QA)](/user_profile?user_id=697911)   175.16 KB, image/png |  | [Details](/attachment.cgi?id=9399382&action=edit) |
| [advisory.txt](/attachment.cgi?id=9401093)  [8 months ago](#c31)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   338 bytes, text/plain |  | [Details](/attachment.cgi?id=9401093&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1871217#c0)• 1 year ago |
|  | |

Attached file
[permissionfullscreen.html](attachment.cgi?id=9369788)
— [Details](attachment.cgi?id=9369788&action=edit)

I found a vulnerability in firefox android where a microphone permission prompt can cover fullscreen notifications which can lead to spoofs.

steps to produce

1 . open <https://103.186.0.20/permissionfullscreen.html> or permissionfullscreen.html

2. click the button.

OS: Android 12 (Samsung M31)

Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1871217#c1)• 1 year ago |
|  | |

Attached video
[document\_6061956479827578398.mp4](attachment.cgi?id=9369789)
— [Details](attachment.cgi?id=9369789&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a18672_159069)• 1 year ago |

See Also: → [CVE-2024-4766](/show_bug.cgi?id=1871214 "VERIFIED FIXED - Android- Webshare dialog hides fullscreen notification lead to spoof")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a18721_159069)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → GeneralProduct: Firefox → FenixSee Also: → [1821906](/show_bug.cgi?id=1821906 "RESOLVED FIXED - Geolocation permission hide notification fullscreen")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a1790101_406194)• 1 year ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a2467394_430528)• 1 year ago |

Severity: -- → S2Priority: -- → P2

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1871217#c2)• 11 months ago |
|  | |

Titouan's fix for [bug 1874795](/show_bug.cgi?id=1874795 "NEW") is expected to also fix this bug. Assigning this bug to Titouan as a reminder to test this bug's STR.

Assignee: nobody → tthibaudWhiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [group4]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a7587688_1689)• 10 months ago |

Duplicate of this bug: [1881902](/show_bug.cgi?id=1881902 "RESOLVED DUPLICATE - Permission Dialog allows to conduct Full Screen Spoof attack without notification on Android Firefox Nightly")

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1871217#c4)• 10 months ago |
|  | |

We had some hard time reproducing this bug reliably.

Here is the STR that works for us:

1. Open `about:config` and set `media.devices.insecure.enabled` and `media.getusermedia.insecure.enabled` to `true`
2. Make sure Fenix has Microphone permission set as "Always ask" (from the device's app settings)
3. Force Quit Fenix
4. Open Fenix and navigate to the HTML attachment. (an other solution is to serve this file with `python3 -m http.server` and access it from your device)
5. Click on the "Click" button.

We should then see the Fenix permission request (Android level), click "Only one", then see the website permission request.

The website is already in fullscreen and the snackbar was never visible.

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1871217#c5)• 10 months ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1871217&comment_id=16862134 "1 revision") |
|  | |

The problem we see is: in the case of the HTML attachment provided, the webpage asks for fullscreen and *then* requests the Microphone permission.

So, at the time our code processes the Fullscreen request, we have no way to know that there's a Microphone permission request coming.

An option might be to have a kind of time threshold where we wait some defined amount of time (*x seconds*) before going fullscreen, so that we can process permission requests in that time. But we think that the issue would still exist, the website would only have to wait for *x seconds* before requesting the permission. (Unless we show a kind of warning that you're about to go fullscreen before really going fullscreen).

Another option would be to show the Fullscreen notification somewhere else on the screen, so that we make sure it's visible.

Is there something we are missing?

Does someone have an opinion on how to correctly handle this case?

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1871217#c6)• 10 months ago |
|  | |

We think we have 2 possible avenues to explore here:

1. Do What Chrome Android Does

   Go fullscreen when asked, but don't ask for permissions when fullscreen.

   (NB This could be tricky to implement as we have already looked at this. The previous fix will ignore the site permission request if there is already a dialog showing for full screen permissions. Maybe we could extend this to also look for any pending full screen requests, and just bin the permission request entirely if we are about to go fullscreen?)
2. Do What FF Desktop Does

   Go fullscreen when asked, then if asked for a permission, revert to not full screen and show the permission request.

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1871217#c7)• 10 months ago |
|  | |

Hey :owlish and :dveditz, does any of you have an opinion on what would be the right resolution for this bug?

(:skhan suggested both of you might be helpfull here)

Flags: needinfo?(dveditz)Flags: needinfo?(bugzeeeeee)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1871217#c8)• 9 months ago |
|  | |

Attached file
[Bug 1871217: Improve permission handling in Fullscreen](attachment.cgi?id=9395506)
— [Details](attachment.cgi?id=9395506&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a9435802_600971)• 9 months ago |

[Attachment #9395506](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Attachment description: WIP: Bug 1871217: testing phabricator - temp → Bug 1871217: Improve permission handling in Fullscreen

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1871217#c9)• 9 months ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1871217&comment_id=16881640 "1 revision") |
|  | |

We've gone ahead with option 2, reasoning being:

* it is consistent with ff desktop
* it is more resilient to timing issues than just checking for the existence of the notification dialog
* users might need to action the permission request for the best fullscreen experience, eg. if they are in a video call and need to give microphone permission

Patch is attached above, we also have a unit test that we can submit later

|  | [Polly McEldowney [:pollymce]](/user_profile?user_id=750904) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a9443147_750904)• 9 months ago |

Flags: qe-verify+

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a9447644_719807)• 9 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1871217#c10)• 9 months ago |
|  | |

Comment on [attachment 9395506](/attachment.cgi?id=9395506 "Bug 1871217: Improve permission handling in Fullscreen") [[details]](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen")

[Bug 1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"): Improve permission handling in Fullscreen

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: We think it wouldn't be easy, as the STR we know depends on steps which are not referenced in any way in the patch.

  Even if they knew how to exploit the breach, it seems hard to take advantage of it, mainly because they would need to reproduce the UI of Firefox + the Android Status bar for the specific phone so that they can fool the user into thinking they are not in fullscreen.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which branches (beta, release, and/or ESR) are affected by this flaw, and do the release status flags reflect this affected/unaffected state correctly?**: Beta, Release, ESR. Status reflects that correctly.
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Very easy, we just need to create the backport
* **How likely is this patch to cause regressions; how much testing does it need?**: We think it's not very likely to cause regression.

  It would be good to have some testing around fullscreen and permissions in general.
* **Is the patch ready to land after security approval is given?**: Yes
* **Is Android affected?**: Yes
[Attachment #9395506](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a9490025_75935)• 9 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1871217#c11)• 9 months ago |
|  | |

Comment on [attachment 9395506](/attachment.cgi?id=9395506 "Bug 1871217: Improve permission handling in Fullscreen") [[details]](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen")

[Bug 1871217](/show_bug.cgi?id=1871217 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"): Improve permission handling in Fullscreen

sec-approval=dveditz

thanks for waiting while we got the 125 release out. We'll want to uplift this one to beta

Flags: needinfo?(dveditz)
[Attachment #9395506](/attachment.cgi?id=9395506&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a10371312_1689)• 9 months ago |

[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected)
[tracking-firefox126](/buglist.cgi?f1=cf_tracking_firefox126&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox126&o1=equals&v1=%2B)
[tracking-firefox127](/buglist.cgi?f1=cf_tracking_firefox127&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox127&o1=equals&v1=%2B)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1871217#c12)• 9 months ago |
|  | |

Attached file
[Bug 1871217: Improve permission handling in Fullscreen](attachment.cgi?id=9397607)
— [Details](attachment.cgi?id=9397607&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D206890>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a10404080_600971)• 9 months ago |

[Attachment #9397607](/attachment.cgi?id=9397607&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1871217#c13)• 9 months ago |
|  | |

### beta Uplift Approval Request

* **User impact if declined**: A security issue remains there while the code ships in version 126
* **Code covered by automated testing**: no
* **Fix verified in Nightly**: no
* **Needs manual QE test**: yes
* **Steps to reproduce for manual QE testing**: Follow the STR on Bugzilla
* **Risk associated with taking this patch**: low
* **Explanation of risk level**: small change, but as it's a security bug, the patch hasn't baked in Nightly before this uplift
* **String changes made/needed**: No
* **Is Android affected?**: yes

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1871217#c14)• 9 months ago |
|  | |

:tthibaud adding a reminder next week is the final week of Beta for Fx126.

This will need to land in central before Thursday 2024-05-02 so we can uplift it by the final 126 beta build.

If not earlier since this already has sec-approval.

Flags: needinfo?(tthibaud)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1871217#c15)• 9 months ago |
|  | |

Is there a prefered day for landing? If I understand correctly I should land it as close as possible to Thursday 2024-05-02, so I guess Wednesday 2024-05-02 would be the best? Or is there something I'm missing?

Flags: needinfo?(tthibaud) → needinfo?(dmeehan)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1871217#c16)• 9 months ago |
|  | |

It's up to the sec team to communicate if there are any concerns around timing with landing.

I don't see anything mentioned when they granted sec-approval, that they had concerns or direction on when to land.

At least by Wednesday 2024-05-02 works in terms of uplifting on Thursday before the final beta build.

Flags: needinfo?(dmeehan)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1871217#c17)• 9 months ago |
|  | |

:dveditz, do you have any direction we should follow for landing the patch?

Flags: needinfo?(dveditz)

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1871217#c18)• 9 months ago |
|  | |

Priority P1 because this bug has been assigned to a squad/group.

Priority: P2 → P1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1871217#c19)• 9 months ago |
|  | |

no additional instructions beyond the sec-approval. Land as soon as you can unless we explicitly give you a date to wait until.

Flags: needinfo?(dveditz)Priority: P1 → P2Summary: Android - Permission prompt obscured fullscreen notification lead to spoof → Android - Microphone permission prompt obscured fullscreen notification lead to spoof

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a10938843_1689)• 9 months ago |

Priority: P2 → P1

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11126724_1689)• 9 months ago |

Summary: Android - Microphone permission prompt obscured fullscreen notification lead to spoof → Android-permission prompt obscured fullscreen notification lead to spoof

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1871217#c20)• 9 months ago |
|  | |

Pushed by tthibaud@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/55189bb1efab>
Improve permission handling in Fullscreen r=android-reviewers,twhite

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1871217#c21)• 9 months ago |
|  | |

The [uplift patch](https://phabricator.services.mozilla.com/D208008) is still pending `release-managers` group approval.

As the first patch is already in the landing queue now, is there something else we should do to get the uplifiting approval?

Flags: needinfo?(dmeehan)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1871217#c22)• 9 months ago |
|  | |

(In reply to Titouan Thibaud [:tthibaud] from [comment #21](/show_bug.cgi?id=1871217#c21 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"))

> The [uplift patch](https://phabricator.services.mozilla.com/D208008) is still pending `release-managers` group approval.
>
> As the first patch is already in the landing queue now, is there something else we should do to get the uplifiting approval?

No nothing else for you to do, we don't uplift until after it lands in central.

Uplifts for security bugs follow the same process as regular uplift requests. It doesn't get approved until we process the uplift.

Flags: needinfo?(dmeehan)

|  | [Titouan Thibaud [:titouan]](/user_profile?user_id=719807)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1871217#c23)• 9 months ago |
|  | |

Thanks a lot for the explainations!

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1871217#c24)• 9 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/55189bb1efab>

Group: mobile-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 9 months ago
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 127 Branch

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11282711_600971)• 9 months ago |

[Attachment #9397607](/attachment.cgi?id=9397607&action=edit "Bug 1871217: Improve permission handling in Fullscreen") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11282900_640478)• 9 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1871217#c25)• 9 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/d7f460434ca1>

|  | [Delia Pop (Android QA)](/user_profile?user_id=697911) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1871217#c26)• 8 months ago |
|  | |

Attached image
[QA.png](attachment.cgi?id=9399382)
— [Details](attachment.cgi?id=9399382&action=edit)

Verified as fixed on the latest Nightly 127.0a1 from 04/30 and Beta 126.0b7. Fenix exits the full screen mode when the website permission dialogue is displayed.

Tested with Samsung Galaxy Note10 (Android 12) and Motorola Moto G30 (Android 12).

|  | [Delia Pop (Android QA)](/user_profile?user_id=697911) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11352342_697911)• 8 months ago |

Status: RESOLVED → VERIFIED
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=verified)
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11464176_1689)• 8 months ago |

Duplicate of this bug: [1894326](/show_bug.cgi?id=1894326 "RESOLVED FIXED")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1871217#c28)• 8 months ago |
|  | |

tthibaud, in [bug 1894326](/show_bug.cgi?id=1894326 "RESOLVED FIXED") the reporter says this isn't actually fixed on Android beta. I'm not sure how to reconcile that with the verification in this bug. Can you take a look? Thanks.

Flags: needinfo?(tthibaud)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11969486_578488)• 8 months ago |

Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1871217#c29)• 8 months ago |
|  | |

Adding explanation for future context

(Titouan Thibaud [:tthibaud] from [comment #15](/show_bug.cgi?id=1871217#c15 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"))

> Is there a prefered day for landing? If I understand correctly I should land it as close as possible to Thursday 2024-05-02 [ed: that is, the last beta this cycle]

(Daniel Veditz [:dveditz] from [comment #19](/show_bug.cgi?id=1871217#c19 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof"))

> no additional instructions beyond the sec-approval. Land as soon as you can unless we explicitly give you a date to wait until.

There's a balance between getting real-world testing in beta (or having time to test at all!) and keeping revealing patches out of the public eye as long as possible. Since our release cycles are so short, lack of testing is often a bigger risk than exposure. We prefer people land most security patches as soon as they are ready. As part of sec-approval we will ask that a subset of fixes delay their landing, weighing the severity of the exploit (e.g. zero- or one-click malware or UXSS), the complexity and likelihood of creating an exploit based on the patch, and the fragility (need for testing) of the patched code. In those cases we will explicitly ask that landing be delayed until a specific date/week.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a11986049_1689)• 8 months ago |

No longer duplicate of this bug: [1894326](/show_bug.cgi?id=1894326 "RESOLVED FIXED")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1871217#c30)• 8 months ago |
|  | |

Owlish's needinfo was answered by Polly in [comment 9](/show_bug.cgi?id=1871217#c9 "VERIFIED FIXED - Android-permission prompt obscured fullscreen notification lead to spoof")

tthibaud's needinto was moved to [bug 1894326](/show_bug.cgi?id=1894326 "RESOLVED FIXED")

Flags: needinfo?(tthibaud)Flags: needinfo?(bugzeeeeee)

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a12170133_486733)• 8 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [group4] → [reporter-external] [client-bounty-form] [verif?] [group4] [adv-main126+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1871217#c31)• 8 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9401093)
— [Details](attachment.cgi?id=9401093&action=edit)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a13955385_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1871217#a23575984_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1871217&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

