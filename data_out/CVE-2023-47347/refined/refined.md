- **Root cause of vulnerability:** The vulnerability is caused by the UPF (User Plane Function) crashing due to malformed PFCP (Packet Forwarding Control Protocol) messages, specifically Heartbeat Request messages, where the Sequence Number is mutated to overflow bytes (e.g., `0xFF 0xFF 0xFF 0xFF`). This leads to a slice bounds out of range error during the unmarshalling of the message.
- **Weaknesses/vulnerabilities present:** The UPF lacks proper validation and handling of PFCP messages with mutated sequence numbers, leading to a parsing error that results in a panic and subsequent crash. The vulnerability lies in the `go-pfcp` library's handling of malformed sequence numbers during message parsing, specifically when unmarshalling the `IE` (Information Element).
- **Impact of exploitation:** Exploitation can lead to a Denial of Service (DoS) condition for any UPF instance. The vulnerability can cause resource consumption, leading to frequent crashes.
- **Attack vectors:** The attack vector involves sending malformed PFCP Heartbeat Request messages with an overflowing sequence number to the UPF instance over UDP, specifically on port 8805, as seen in the provided python POC.
- **Required attacker capabilities/position:** An attacker needs the capability to send UDP packets to the UPF's PFCP port (default 8805). The attacker does not need any special authentication or privileges within the system, they only need network access.

The provided information gives more detail than a typical CVE description by showing the specific code snippet that caused the vulnerability as well as the specific type of PFCP message that triggered it.