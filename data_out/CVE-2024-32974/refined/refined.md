- **Root cause of vulnerability**: A use-after-free vulnerability occurs in `EnvoyQuicServerStream::OnInitialHeadersComplete()`. This is triggered when QUICHE (the QUIC implementation used by Envoy) continues to push request headers after `StopReading()` has been called on the stream. The `StopReading()` call may lead to the destruction of the HCM's `ActiveStream`, and subsequent callbacks from QUICHE can then result in a use-after-free when accessing the destroyed object.

- **Weaknesses/vulnerabilities present**: Use-after-free (CWE-416)

- **Impact of exploitation**: A crash occurs due to accessing freed memory, leading to a denial of service.

- **Attack vectors**: The vulnerability is triggered by a malicious QUIC client.

- **Required attacker capabilities/position**: An attacker needs to be able to send QUIC requests to an Envoy server configured with HTTP/3 downstream. The attacker must also be able to manipulate the QUIC stream, specifically by sending a request with headers referencing Qpack dynamic table entries, then send a `STOP_SENDING` frame, while also delaying the Qpack dynamic table entry data. This requires the ability to craft malicious QUIC packets.