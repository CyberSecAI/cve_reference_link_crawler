The provided content relates to CVE-2021-4438.

**Root cause of vulnerability:**
The vulnerability is an Intent Redirection issue. The Android application was not properly registering the `BroadcastReceiver` for SMS retrieval, making it possible for a malicious application to intercept the SMS message intended for the legitimate application.

**Weaknesses/vulnerabilities present:**
- Improper registration of `BroadcastReceiver` for SMS retrieval without specifying the `SmsRetriever.SEND_PERMISSION`.

**Impact of exploitation:**
- A malicious application could intercept the SMS message intended for the vulnerable application. This can lead to the attacker obtaining sensitive information or bypassing security measures that rely on SMS verification.

**Attack vectors:**
- A malicious application can register a `BroadcastReceiver` with the same intent filter (`SmsRetriever.SMS_RETRIEVED_ACTION`) as the vulnerable app but without proper permissions, thus intercepting the SMS.

**Required attacker capabilities/position:**
- The attacker needs to be able to install and run a malicious application on the same device as the vulnerable application.
- The attacker's malicious app needs to be able to register a broadcast receiver for the SMS retrieval intent.

**Additional Details:**
The provided content shows the fix for the vulnerability, which includes:
  - Adding the `SmsRetriever.SEND_PERMISSION` when registering the `BroadcastReceiver`:
  ```kotlin
  reactContext.currentActivity?.registerReceiver(receiver, intentFilter, SmsRetriever.SEND_PERMISSION, null)
  ```
  - Checking for null intents:
  ```kotlin
    if (resultCode == RESULT_OK && intent != null) {
        // Get SMS message content
        val message = intent.getStringExtra(SmsRetriever.EXTRA_SMS_MESSAGE)
  ```
  - The fix was introduced in commit `5423dcb` and released in version `1.1.5` of the `react-native-sms-user-consent` library.