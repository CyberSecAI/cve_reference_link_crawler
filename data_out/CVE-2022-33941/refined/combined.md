=== Content from www.powercms.jp_ddcd9071_20250108_142143.html ===


[![PowerCMS™](/common/images/2018/logo_powercms.svg)](/)

* [お問い合わせ](/inquiry/)
* [PowerCMS ブログ](/blog/)

* [ログイン](https://www.powercms.jp/members/)
* [今すぐ購入](/inquiry/buy.html)

* [PowerCMS](/products/)
* [PowerCMSクラウド](/cloud/)
* [オプションサービス](/options/)
* [事例紹介](/case-studies/)
* [よくあるご質問](/faq/)
* [パートナー](/partner/)

| [ブログ] [PowerCMS 6 でのアップデートまとめ](https://www.powercms.jp/blog/2022/03/powercms_6_overview.html) を追加しました。 |
| --- |
| [ブログ] [展示会「第22回【東京】総務・人事・経理 Week 秋」を見学してきました](https://www.powercms.jp/blog/2024/12/20241004-report.html) を追加しました。 |
| [新着情報] [PowerCMSクラウド環境での設定変更予定のお知らせ](https://www.powercms.jp/news/modify_virtualhost_behavior.html) を追加しました。 |
| [よくあるご質問] [システムログに「タスクを実行するために必要なロックを獲得できませんでした」というログが残っている](https://www.powercms.jp/faq/5691.html) を追加しました。 |

# 新着情報

[ホーム](/) >
[新着情報](https://www.powercms.jp/news/) >
*XMLRPC API におけるコマンド・インジェクションの脆弱性対策 (JVN#7602487)*

* [前の記事](https://www.powercms.jp/news/release-powersync-1331.html)
* [全エントリー一覧](/news/index.html)
* [次の記事](https://www.powercms.jp/news/release-powercms-6022-522-452.html)
## XMLRPC API におけるコマンド・インジェクションの脆弱性対策 (JVN#7602487)

PowerCMS について XMLRPC API おける OS コマンド・インジェクションの脆弱性 ([JVN#7602487](https://jvn.jp/jp/JVN76024879/)) が存在することがわかりました。これまでに XMLRPC API 機能を利用できなくすることで対策を行っている環境について影響はなく、新たに対策を行って頂く必要はございませんが、そうでない場合は当リリースの内容に従って対策をお願いいたします。

お客様にはご迷惑をおかけいたしますこと、深くお詫び申し上げます。

9月2日に公開されました JVN#7602487 は本脆弱性の件です。新たに脆弱性が見つかったわけではございませんので誤解されませんようお願いいたします。 (※2022/09/02 追記)

* [JVN#76024879: PowerCMS の XMLRPC API におけるコマンドインジェクションの脆弱性](https://jvn.jp/jp/JVN76024879/)

なお今回、XMLRPC API 機能のサポートを終了することを決定いたしました。
XMLRPC API 機能のサポート終了につきましては下記ページの案内を参照してください。

* [XMLRPC API のサポート終了および PowerCMS 6.022 / 5.22 / 4.52 の提供開始](https://www.powercms.jp/news/release-powercms-6022-522-452.html)

### 影響を受けない環境

* 過去に XMLRPC API における脆弱性がアナウンスされた際に XMLRPC API 機能を利用できなくすることで対策を行っている環境
* PowerCMS 6.00 / 5.20 / 4.50 以上のバージョンかつ mt-xmlrpc.cgi を PSGI の対象にしていない環境 (※1)
* PowerCMS クラウドの環境 (※2)

脆弱性の対象は XMLRPC API 機能ですので、当該機能の利用を制限されている場合に影響はありません。

※1 これら以降のバージョンでは mt-xmlrpc.cgi の同梱を終了しております

※2 PowerCMS クラウドの全環境では XMLRPC API 機能の利用を制限しております

### 影響を受ける環境

* PowerCMS 6.021/ 5.21 / 4.51 を含む以前のバージョンで XMLRPC API 機能を利用している環境

※ サポートを終了しておりますバージョンについては記載しておりません。

#### XMLRPC API を利用していない場合の対策

XMLRPC API を利用していない場合、XMLRPC API 機能を利用できなくすることで対策が行えますが、PowerCMS を CGI/FastCGI/PSGI で利用しているかによってその方法が異なります。

##### PowerCMS を CGI/FastCGI で利用している場合

下記のファイルについて、サーバーからファイルを削除したりパーミッションを付与しないようにするなど、動作しないようにしてください。

* mt-xmlrpc.cgi

※ PowerCMS の環境変数 [XMLRPCScript](https://www.powercms.jp/products/document/config-directives/xmlrpcscript.html) を設定されている場合、`mt-xmlrpc.cgi` をリネームして利用されている可能性があり、リネーム後のファイルを見つけて対策を行ってください。

##### PowerCMS を PSGI で利用している場合

環境変数 [RestrictedPSGIApp](https://www.powercms.jp/products/document/config-directives/restrictedpsgiapp.html) を設定し、XMLRPC アプリケーションを禁止してください。

```

RestrictedPSGIApp  xmlrpc

```

※ 設定後、PSGI のプロセスを再起動してください。

#### XMLRPC API を利用している場合の対策

修正ファイルをダウンロードして、ご利用の PowerCMS へ適用してください。

* [XMLRPC API におけるコマンド・インジェクションの脆弱性対策](https://www.powercms.jp/members/20220831-005308.html) (ログインが必要です)

修正ファイルを適用できない場合、mt-xmlrpc.cgi へのアクセスを信頼のおけるアクセス元のみに限定したり HTTP 認証を設定するなどアクセスを制限してください。

### 脆弱性を利用した攻撃を受けてしまった場合

脆弱性に対策を行う前に不正アクセスが行われている可能性が見られる場合には下記ページの内容を参考に調査・対応してください。

* [PowerCMS の XMLRPC API における OS コマンド・インジェクションへの対応 | 新着情報](https://www.powercms.jp/news/xmlrpc-api-provision-202111.html.html)

### サポートサイト

サポートサイトへ初めてアクセスされる方は、お手数ですがまず[サインアップ](https://www.powercms.jp/members/)を行ってください(ライセンスコードが必要です)。

公開日
2022年8月31日
更新日
2022年9月2日

## 新着情報

* [重要なお知らせ](https://www.powercms.jp/news/notice/)
* [プレスリリース](https://www.powercms.jp/news/press/)
* [製品リリース情報](https://www.powercms.jp/news/release/)
* [イベント・セミナー情報](https://www.powercms.jp/news/seminar/)
* [トピックス](https://www.powercms.jp/news/topics/)

* [![PowerCMS クラウド](/images/banner/banner_cloud.jpg)](/cloud/)
* [![PowerCMS 8341](/images/banner/banner8341.jpg)](/news/powercms-8341.html)
* [![PowerSync](/images/banner/banner_powersync.jpg)](https://powersync.alfasado.net/)

ページの
先頭へ

* [HOME](/ "HOME")
  + [イベント・セミナー情報](/news/seminar/ "イベント・セミナー情報")
  + [PowerCMS ブログ](/blog/ "PowerCMS ブログ")
* [PowerCMS](/products/ "PowerCMS")
  + [PowerCMSの機能](/products/features/ "PowerCMSの機能")
  + [製品ラインアップ](/products/lineup/ "製品ラインアップ")
  + [価格表](/products/price.html "価格表")
  + [動作環境](/products/document/installation/system.html "動作環境")
  + [製品資料ダウンロード](/products/download.html "製品資料ダウンロード")
  + [ドキュメント](/products/document/ "ドキュメント")
* [PowerCMSクラウド](/cloud/ "PowerCMSクラウド")

* [オプションサービス](/options/ "オプションサービス")
* [事例紹介](/case-studies/ "事例紹介")
  + [導入事例](/case-studies/index.html#anchor1 "導入事例")
  + [パートナー構築事例](/case-studies/index.html#anchor2 "パートナー構築事例")
* [よくあるご質問](/faq/ "よくあるご質問")
* [パートナー紹介](/partner/ "パートナー紹介")
  + [PowerCMS Partner Pro](/partner/index.html#anchor1 "PowerCMS Partner Pro")
  + [PowerCMS Partner SOHO](/partner/index.html#anchor2 "PowerCMS Partner SOHO")
  + [パートナー制度とは](/partner/system.html "パートナー制度とは")
  + [パートナーお申し込み](/inquiry/partner.html "パートナーお申し込み")

* [お問い合わせ](/inquiry/ "お問い合わせ")
* [サポートについて](/support/ "サポートについて")
* [プライバシーポリシー](https://alfasado.net/policy/index.html "プライバシーポリシー")
* [会社概要](/company/ "会社概要")
* [PowerCMSご購入](/inquiry/buy.html "PowerCMSご購入")
  + [特定商取引法に基づく表示](/ordercontract/ "特定商取引法に基づく表示")
  + [クレジットカード決済について](/ordercontract/creditcard.html "クレジットカード決済について")

* **PowerCMS 関連製品**
  + [PowerCMS 8341](/news/powercms-8341.html "PowerCMS 8341")
  + [PowerSync](https://powersync.alfasado.net/ "PowerSync")
  + [VisitorAnalytics](https://visitoranalytics.alfasado.net/ "VisitorAnalytics")
  + [SAML Login](https://www.powercms.jp/news/saml-login.html "SAML Login")
* [PowerCMS X](https://powercmsx.jp/ "PowerCMS X")
* [伝えるウェブ](https://tsutaeru.cloud/ "伝えるウェブ")

Copyright © 2009-2024 Alfasado Inc. All rights reserved.
powered by [![アルファサード株式会社](/common/images/2017/logo_alfasado.svg)](https://alfasado.net/)

* [![W3C Member](/common/images/2017/logo_w3c.png)](https://www.w3.org/)



=== Content from jvn.jp_46e0daa2_20250108_142142.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2022/09/02  Last Updated:2022/09/02
# JVN#76024879 PowerCMS XMLRPC API vulnerable to command injection

## Overview

PowerCMS XMLRPC API contains a command injection vulnerability.

## Products Affected

* PowerCMS 6.021 and earlier (PowerCMS 6 Series)
* PowerCMS 5.21 and earlier (PowerCMS 5 Series)
* PowerCMS 4.51 and earlier (PowerCMS 4 Series)

The developer states that PowerCMS 3 Series and earlier, which are unsupported (End-of-Life, EOL) versions, are affected too.

## Description

PowerCMS XMLRPC API provided by Alfasado Inc. contains a command injection vulnerability ([CWE-74](https://cwe.mitre.org/data/definitions/74.html)).

Sending a specially crafted message by POST method to PowerCMS XMLRPC API may allow arbitrary Perl script execution, and an arbitrary OS command may be executed through it.

According to the developer, it is unable to execute a command with an arbitrary value added to its argument, even if the vulnerability is exploited.

## Impact

An arbitrary Perl script may be executed by a remote attacker. As a result, an arbitrary OS command may be executed.

## Solution

**When XMLRPC API is NOT required: Disable XMLRPC API**

* If XMLRPC API is used as CGI/FastCGI
  + Delete `mt-xmlrpc.cgi` or remove execute permission of `mt-xmlrpc.cgi`
    - According to the developer, when PowerCMS environment variable `XMLRPCScript` is configured, the file may be renamed. In that case, implement this countermeasure to that renamed file
* If XMLRPC API is used as PSGI
  + Configure environment variable `RestrictedPSGIApp` to prohibit XMLRPC application: `RestrictedPSGIApp xmlrpc`

**When XMLRPC API should be kept available: Apply the patch**

Apply the patch according to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| Alfasado Inc. | [Vulnerable](996316/index.html) | 2022/09/02 | [Alfasado Inc. website](https://www.powercms.jp/news/xmlrpc-api-provision-202208.html) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
Base Score:
9.8

| Attack Vector(AV) | Physical (P) | Local (L) | Adjacent (A) | Network (N) |
| --- | --- | --- | --- | --- |
| Attack Complexity(AC) | High (H) | Low (L) |
| Privileges Required(PR) | High (H) | Low (L) | None (N) |
| User Interaction(UI) | Required (R) | None (N) |
| Scope(S) | Unchanged (U) | Changed (C) |
| Confidentiality Impact(C) | None (N) | Low (L) | High (H) |
| Integrity Impact(I) | None (N) | Low (L) | High (H) |
| Availability Impact(A) | None (N) | Low (L) | High (H) |

CVSS v2
AV:N/AC:L/Au:N/C:P/I:P/A:P
Base Score:
7.5

| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) |
| --- | --- | --- | --- |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) |

## Credit

Alfasado Inc. reported this vulnerability to JPCERT/CC to notify users of its solution through JVN. JPCERT/CC and Alfasado Inc. coordinated under the Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2022-33941](https://www.cve.org/CVERecord?id=CVE-2022-33941) |
| JVN iPedia | [JVNDB-2022-000069](https://jvndb.jvn.jp/jvndb/JVNDB-2022-000069) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2022 JPCERT/CC and IPA. All rights reserved.


