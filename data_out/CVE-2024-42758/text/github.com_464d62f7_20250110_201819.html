
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamuelet%2Findexmenu%2Fissues%2F317)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamuelet%2Findexmenu%2Fissues%2F317)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Fshow&source=header-repo&source_repo=samuelet%2Findexmenu)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[samuelet](/samuelet)
/
**[indexmenu](/samuelet/indexmenu)**
Public

* [Notifications](/login?return_to=%2Fsamuelet%2Findexmenu) You must be signed in to change notification settings
* [Fork
  43](/login?return_to=%2Fsamuelet%2Findexmenu)
* [Star
   47](/login?return_to=%2Fsamuelet%2Findexmenu)

* [Code](/samuelet/indexmenu)
* [Issues
  23](/samuelet/indexmenu/issues)
* [Pull requests
  9](/samuelet/indexmenu/pulls)
* [Actions](/samuelet/indexmenu/actions)
* [Projects
  1](/samuelet/indexmenu/projects)
* [Security](/samuelet/indexmenu/security)
* [Insights](/samuelet/indexmenu/pulse)

Additional navigation options

* [Code](/samuelet/indexmenu)
* [Issues](/samuelet/indexmenu/issues)
* [Pull requests](/samuelet/indexmenu/pulls)
* [Actions](/samuelet/indexmenu/actions)
* [Projects](/samuelet/indexmenu/projects)
* [Security](/samuelet/indexmenu/security)
* [Insights](/samuelet/indexmenu/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsamuelet%2Findexmenu%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsamuelet%2Findexmenu%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Multiple Cross-Site Scripting (XSS) Vulnerabilities #317

Open

[1s1ldur](/1s1ldur) opened this issue
Jul 22, 2024
· 1 comment

Open

# [Multiple Cross-Site Scripting (XSS) Vulnerabilities](#top) #317

[1s1ldur](/1s1ldur) opened this issue
Jul 22, 2024
· 1 comment

Labels
[bug](/samuelet/indexmenu/labels/bug)

## Comments

[![@1s1ldur](https://avatars.githubusercontent.com/u/124069385?s=80&v=4)](/1s1ldur)

Copy link

### **[1s1ldur](/1s1ldur)** commented [Jul 22, 2024](#issue-2423192558)

| Hi!  During the penetration testing of DokuWiki, i've identified some vulnerabilities. These vulnerabilities are primarily related to Cross-Site Scripting (XSS) – which would be the A03:2021 – Injection by the OWASP top 10. Those vulnerabilities can lead to stored Cross-Site Scripting (XSS) attacks (due to the nature of DokuWiki architecture), which are a serious security concern.  So let's dive in.  The `fill` method within `indexmenu.js` is designed to load and display child nodes when they're not already available. This method retrieves node data through AJAX and dynamically updates the DOM. However, it fails to sanitize the node data before inserting it into the page. To sanitize this vulnerability i suggest that any content that's added to the DOM is sanitized or using safer methods that do not involve direct HTML insertion.  Next, the `contextmenu` method within `indexmenu.js` shows a context menu when you right-click on a node, it constructs HTML for the menu and inserts it into the DOM, but does not sanitize the node names or other content that could be used for XSS attacks. Again to remediate this vulnerability i would suggest sanitizing the node name or using safer DOM manipulation methods that do not involve injecting HTML directly.  Last but not least, the `arrconcat` function within `contextmenu.js` is responsible for filling the context menu with entries based on configuration arrays, by generating HTML for each menu item and inserting it into the context menu. The problem lies in how the `arrconcat` function handles user-supplied or dynamically generated data without proper sanitization. Specifically, the function constructs HTML anchor tags by concatenating strings, including untrusted data. The use of `eval(entry[1])` to evaluate the content of `entry[1]` as JavaScript code is dangerous and unsafe, so this method allows any injected script within `entry[1]` to execute which is the root problem. Additionally, the function inserts HTML content directly into the DOM by using `innerHTML`. This practice does not sanitize the input, enabling any included script tags or event handlers to execute, which was the case i observed during the penetration test. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Klap-in](https://avatars.githubusercontent.com/u/183250?s=80&v=4)](/Klap-in)

Copy link

Collaborator

### **[Klap-in](/Klap-in)** commented [Jul 23, 2024](#issuecomment-2246437925)

| Thanks for reporting your observations! At first sight these appear to affect mostly the older part of the code, which is due for replacement with recent introduced variant of the tree. Challenge for me is lack of time as I have a newborn which needs a lot of time. I will see how I can address these concerns on short term. Thanks for the report with background. |
| --- |

All reactions

Sorry, something went wrong.

[![@Klap-in](https://avatars.githubusercontent.com/u/183250?s=40&v=4)](/Klap-in)
[Klap-in](/Klap-in)
added
the
[bug](/samuelet/indexmenu/labels/bug)
label
[Jul 23, 2024](#event-13622327700)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamuelet%2Findexmenu%2Fissues%2F317)

Assignees

No one assigned

Labels

[bug](/samuelet/indexmenu/labels/bug)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@Klap-in](https://avatars.githubusercontent.com/u/183250?s=52&v=4)](/Klap-in) [![@1s1ldur](https://avatars.githubusercontent.com/u/124069385?s=52&v=4)](/1s1ldur)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

