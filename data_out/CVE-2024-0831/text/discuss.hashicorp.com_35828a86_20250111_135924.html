

[HashiCorp Discuss](/)

# [HCSEC-2024-01 - Vault May Expose Sensitive Information When Configuring An Audit Log Device](/t/hcsec-2024-01-vault-may-expose-sensitive-information-when-configuring-an-audit-log-device/62311)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[jfinnigan](https://discuss.hashicorp.com/u/jfinnigan)

February 1, 2024, 12:05am

1

**Bulletin ID:** HCSEC-2024-01

**Affected Products / Versions:** Vault and Vault Enterprise 1.15.0 through 1.15.4; fixed in 1.15.5.

**Publication Date:** January 31, 2024

**Summary**

Vault and Vault Enterprise (“Vault”) may expose sensitive information when enabling an audit device which specifies the `log_raw` option, which may log sensitive information to other audit devices, regardless of whether they are configured to use `log_raw`. This vulnerability, CVE-2024-0831, was introduced in Vault 1.15.0 and is fixed in Vault 1.15.5.

**Background**

Audit devices are the components in Vault that collectively keep a detailed log of all requests to Vault, and their responses. Logs entries that are considered sensitive, such as passwords, are hashed with a salt using HMAC-SHA256. An option exists in Vault, `log_raw`, that logs the sensitive information without hashing, in its raw format.

More information on audit devices can be found at <https://developer.hashicorp.com/vault/docs/audit>.

**Details**

When `log_raw` is enabled by setting it to true for an individual audit device, it should only apply to that single specified device. However, in the affected Vault versions, when `log_raw` is set to true it does not only apply to the targeted audit device, but rather is set globally for all audit devices configured in the Vault deployment.

This may result in sensitive data included in the logs to be exposed in clear text to audit devices that were not intended to receive the unhashed logs.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Vault 1.15.5, or newer. Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes. Customers may also refer to the [known issue entry](https://developer.hashicorp.com/vault/docs/upgrading/upgrade-to-1.15.x#audit-devices-could-log-raw-data-despite-configuration).

If this feature has been enabled on a vulnerable version of Vault, customers should also evaluate their audit log devices for sensitive data that may have been captured and consider appropriate actions such as rotation or revocation if necessary.

**Acknowledgement**

This issue was identified by the Vault engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-18 - Vault Leaks Client Token and Token Accessor in Audit Devices](https://discuss.hashicorp.com/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices/69669)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 2364 | August 31, 2024 |
| [HCSEC-2024-10 - Vault Enterprise Leaks Sensitive HTTP Request Headers in Audit Log When Deployed With a Performance Standby Node](https://discuss.hashicorp.com/t/hcsec-2024-10-vault-enterprise-leaks-sensitive-http-request-headers-in-audit-log-when-deployed-with-a-performance-standby-node/66553)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 3775 | April 30, 2024 |
| [HCSEC-2021-19 - Vault’s UI Cached User-Viewed Secrets Between Shared Browser Sessions](https://discuss.hashicorp.com/t/hcsec-2021-19-vault-s-ui-cached-user-viewed-secrets-between-shared-browser-sessions/28166)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7693 | August 12, 2021 |
| [HCSEC-2020-13 - Vault Proxy Environment Variable Was Logged to STDOUT](https://discuss.hashicorp.com/t/hcsec-2020-13-vault-proxy-environment-variable-was-logged-to-stdout/18096)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4128 | November 25, 2020 |
| [HCSEC-2021-33 - Vault’s KV Secrets Engine With Integrated Storage Exposed to Authenticated Denial of Service](https://discuss.hashicorp.com/t/hcsec-2021-33-vault-s-kv-secrets-engine-with-integrated-storage-exposed-to-authenticated-denial-of-service/33157)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7061 | December 14, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

