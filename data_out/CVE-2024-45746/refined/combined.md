=== Content from trustedfirmware-m.readthedocs.io_3a199e29_20250110_211631.html ===

[Trusted Firmware-M
![Logo](../../_static/tf_logo_white.png)](../../index.html)
Unknown

Overview

* [Introduction](../../introduction/index.html)
* [Getting Started](../../getting_started/index.html)
* [Security](../index.html)
  + [Threat Model](../threat_models/index.html)
    - [Threat model](../threat_models/generic_threat_model.html)
  + [Security Advisories](index.html)
    - [Advisory TFMV-1](stack_seal_vulnerability.html)
    - [Advisory TFMV-2](svc_caller_sp_fetching_vulnerability.html)
    - [Advisory TFMV-3](crypto_multi_part_ops_abort_fail.html)
    - [Advisory TFMV-4](profile_small_key_id_encoding_vulnerability.html)
    - [Advisory TFMV-5](fwu_write_vulnerability.html)
    - [Advisory TFMV-6](cc3xx_partial_tag_compare_on_chacha20_poly1305.html)
    - [Advisory TFMV-7](debug_log_vulnerability.html)
    - Advisory TFMV-8
* [Releases](../../releases/index.html)
  + [v2.1.1](../../releases/2.1.1.html)
  + [v2.1.0](../../releases/2.1.0.html)
  + [v2.0.0](../../releases/2.0.0.html)
  + [v1.8.1](../../releases/1.8.1.html)
  + [v1.8.0](../../releases/1.8.0.html)
  + [Release Cadence and Process](../../releases/release_process.html)
* [Roadmap](../../roadmap.html)
* [Glossary](../../glossary.html)

Development

* [Platforms](../../platform/index.html)
  + [Arm](../../platform/arm/index.html)
    - [Corstone-1000](../../platform/arm/corstone1000/readme.html)
    - [Corstone-300 FPGA (AN547 and AN552) and FVP](../../platform/arm/mps3/corstone300/README.html)
    - [Corstone-310 FPGA (AN555) and FVP](../../platform/arm/mps3/corstone310/README.html)
    - [Corstone-315 FVP](../../platform/arm/mps4/corstone315/README.html)
    - [Corstone-320 FVP](../../platform/arm/mps4/corstone320/README.html)
    - [Musca-B1](../../platform/arm/musca_b1/readme.html)
    - [Musca-S1](../../platform/arm/musca_s1/readme.html)
    - [Runtime Security Engine](../../platform/arm/rse/index.html)
  + [ArmChina](../../platform/armchina/index.html)
    - [Alcor FPGA (AN557)](../../platform/armchina/mps3/alcor/README.html)
  + [Cypress](../../platform/cypress/index.html)
    - [PSoC64](../../platform/cypress/psoc64/index.html)
  + [Laird Connectivity](../../platform/lairdconnectivity/index.html)
    - [BL5340](../../platform/lairdconnectivity/bl5340_dvk_cpuapp/README.html)
  + [Nordic](../../platform/nordic_nrf/index.html)
    - [nRF5340](../../platform/nordic_nrf/nrf5340dk_nrf5340_cpuapp/README.html)
    - [nRF9160](../../platform/nordic_nrf/nrf9160dk_nrf9160/README.html)
    - [nRF9161](../../platform/nordic_nrf/nrf9161dk_nrf9161/README.html)
  + [Nuvoton](../../platform/nuvoton/index.html)
    - [NuMaker-PFM-M2351](../../platform/nuvoton/m2351/README.html)
    - [NuMaker-PFM-M2354](../../platform/nuvoton/m2354/README.html)
  + [NXP](../../platform/nxp/index.html)
    - [LPCXpresso55S69](../../platform/nxp/lpcxpresso55s69/README.html)
  + [Raspberry Pi](../../platform/rpi/index.html)
    - [RP2350](../../platform/rpi/rp2350/readme.html)
  + [STMICROELECTRONICS](../../platform/stm/index.html)
    - [STM32H5](../../platform/stm/common/stm32h5xx/readme.html)
    - [STM32L5](../../platform/stm/common/stm32l5xx/readme.html)
    - [STM32U5](../../platform/stm/common/stm32u5xx/readme.html)
    - [NUCLEO\_L552ZE\_Q](../../platform/stm/nucleo_l552ze_q/readme.html)
    - [STM32H573I\_DK](../../platform/stm/stm32h573i_dk/readme.html)
    - [STM32L562E\_DK](../../platform/stm/stm32l562e_dk/readme.html)
    - [B\_U585I\_IOT02A](../../platform/stm/b_u585i_iot02a/readme.html)
* [Build instructions](../../building/tfm_build_instruction.html)
  + [Build Tests](../../building/tests_build_instruction.html)
  + [Run TF-M tests and applications](../../building/run_tfm_examples_on_arm_platforms.html)
  + [Building the documentation](../../building/documentation_generation.html)
  + [IAR toolchain](../../building/tfm_build_instruction_iar.html)
* [Configuration](../../configuration/index.html)
  + [Build configuration](../../configuration/build_configuration.html)
  + [Component configuration](../../configuration/header_file_system.html)
  + [Kconfig](../../configuration/kconfig_system.html)
  + [Profiles](../../configuration/profiles/index.html)
    - [Small](../../configuration/profiles/tfm_profile_small.html)
    - [ARoT-less](../../configuration/profiles/tfm_profile_medium_arot-less.html)
    - [Medium](../../configuration/profiles/tfm_profile_medium.html)
    - [Large](../../configuration/profiles/tfm_profile_large.html)
  + [Tests configuration](../../configuration/test_configuration.html)
* [Integration Guide](../../integration_guide/index.html)
  + [Source Structure](../../integration_guide/source_structure/source_structure.html)
    - [Details for the /platform folder](../../integration_guide/source_structure/platform_folder.html)
    - [Details for the /platform/ext folder](../../integration_guide/source_structure/platform_ext_folder.html)
  + [SPM Backends](../../integration_guide/spm_backends.html)
  + [NS client integration](../../integration_guide/non-secure_client_extension_integration_guide.html)
  + [OS migration to Armv8-M](../../integration_guide/os_migration_guide_armv8m.html)
  + [Floating-Point Support](../../integration_guide/tfm_fpu_support.html)
  + [Secure Interrupt](../../integration_guide/tfm_secure_irq_integration_guide.html)
  + [Platform Provisioning](../../integration_guide/platform_provisioning.html)
  + [Branch Protection](../../integration_guide/branch_protection.html)
  + [Adding a new platform](../../integration_guide/platform/index.html)
    - [Porting TF-M to a New Hardware](../../integration_guide/platform/porting_tfm_to_a_new_hardware.html)
    - [Platform Documentation](../../integration_guide/platform/documenting_platform.html)
    - [Platform deprecation and removal](../../integration_guide/platform/platform_deprecation.html)
  + [Services](../../integration_guide/services/index.html)
    - [Initial Attestation](../../integration_guide/services/tfm_attestation_integration_guide.html)
    - [Crypto](../../integration_guide/services/tfm_crypto_integration_guide.html)
    - [Internal Trusted Storage](../../integration_guide/services/tfm_its_integration_guide.html)
    - [Platform](../../integration_guide/services/tfm_platform_integration_guide.html)
    - [Protected Storage](../../integration_guide/services/tfm_ps_integration_guide.html)
    - [Adding a New Secure Partition](../../integration_guide/services/tfm_secure_partition_addition.html)
    - [Manifest Tool](../../integration_guide/services/tfm_manifest_tool_user_guide.html)
    - [ADAC](../../integration_guide/services/tfm_adac_integration_guide.html)
* [Design Documents](../../design_docs/index.html)
  + [Secure Boot](../../design_docs/booting/tfm_secure_boot.html)
    - [BL1 Immutable bootloader](../../design_docs/booting/bl1.html)
    - [Rollback Protection](../../design_docs/booting/secure_boot_rollback_protection.html)
    - [HW Key integration](../../design_docs/booting/secure_boot_hw_key_integration.html)
  + [Dual CPU](../../design_docs/dual-cpu/index.html)
    - [Booting](../../design_docs/dual-cpu/booting_a_dual_core_system.html)
    - [SPE - NSPE communication](../../design_docs/dual-cpu/communication_prototype_between_nspe_and_spe_in_dual_core_systems.html)
    - [Mailbox](../../design_docs/dual-cpu/mailbox_design_on_dual_core_system.html)
    - [Mailbox update](../../design_docs/dual-cpu/mailbox_ns_agent_update.html)
    - [Memory Access Check](../../design_docs/dual-cpu/tfm_multi_core_access_check.html)
  + [Secure Services](../../design_docs/services/index.html)
    - [Secure Partition Manager](../../design_docs/services/secure_partition_manager.html)
    - [Secure Partition RTL](../../design_docs/services/secure_partition_runtime_library.html)
    - [Inter-Process Communication](../../design_docs/services/tfm_psa_inter_process_communication.html)
    - [Stateless Services](../../design_docs/services/stateless_rot_service.html)
    - [Service Signing](../../design_docs/services/tfm_uniform_secure_service_signature.html)
    - [Crypto](../../design_docs/services/tfm_crypto_design.html)
    - [Initial Attestation](../../design_docs/services/symmetric_initial_attest.html)
    - [Internal Trusted Storage](../../design_docs/services/tfm_its_service.html)
    - [Firmware Update](../../design_docs/services/tfm_fwu_service.html)
    - [PS Key Management](../../design_docs/services/ps_key_management.html)
  + [Software Design](../../design_docs/software/index.html)
    - [Code Sharing](../../design_docs/software/code_sharing.html)
    - [Hardware Abstraction Layer](../../design_docs/software/hardware_abstraction_layer.html)
    - [Cooperative Scheduling](../../design_docs/software/tfm_cooperative_scheduling_rules.html)
    - [Code Templates](../../design_docs/software/tfm_code_generation_with_jinja2.html)
    - [Implicit Typecasting](../../design_docs/software/enum_implicit_casting.html)
  + [Isolation Rules](../../design_docs/ff_isolation.html)
  + [Builtin Keys](../../design_docs/tfm_builtin_keys.html)
  + [Logging system](../../design_docs/tfm_log_system_design_document.html)
  + [Physical Attack Mitigation](../../design_docs/tfm_physical_attack_mitigation.html)

Contribution

* [Guidelines](../../contributing/index.html)
  + [The process](../../contributing/contributing_process.html)
  + [Code review](../../contributing/code_review_guide.html)
  + [Maintainers](../../contributing/maintainers.html)
  + [Code owners](../../contributing/maintainers.html#code-owners)
  + [Issue tracking](../../contributing/issue_tracking.html)
  + [Yet another coding standard :)](../../contributing/coding_guide.html)
  + [Documentation](../../contributing/doc_guidelines.html)
  + [Design proposal](../../contributing/tfm_design_proposal_guideline.html)
* [License](../../contributing/lic.html)
* [DCO](../../contributing/dco.html)

Links

* [TF-M Tests](https://trustedfirmware-m.readthedocs.io/projects/tf-m-tests/en/latest/)
* [TF-M Tools](https://trustedfirmware-m.readthedocs.io/projects/tf-m-tools/en/latest/)
* [TF-M Extras](https://trustedfirmware-m.readthedocs.io/projects/tf-m-extras/en/latest/)
* [API Reference](https://ci.trustedfirmware.org/job/tf-m-build-docs-nightly/lastSuccessfulBuild/artifact/trusted-firmware-m/build/docs/reference_manual/html/index.html)
* [Security Center](https://developer.trustedfirmware.org/w/collaboration/security_center)
* [PSA](https://www.arm.com/architecture/security-features/platform-security)

[Trusted Firmware-M](../../index.html)

* [Security](../index.html)
* [Security Advisories](index.html)
* Advisory TFMV-8

---

# Advisory TFMV-8[](#advisory-tfmv-8 "Permalink to this heading")

| Title | Unchecked user-supplied pointer via mailbox messages may cause write of arbitrary address. |
| --- | --- |
| CVE ID | [CVE-2024-45746](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45746) |
| Public Disclosure Date | October 02, 2024 |
| Versions Affected | All version from TF-Mv1.6.0 up to TF-Mv2.1.0 inclusive |
| Configurations | Platforms with standard mailbox dispatcher `tfm_spe_mailbox`. |
| Impact | The mailbox message could contain arbitrary pointers which, in case of psa\_call failure, would lead to write to a user-specified address in memory. |
| Fix Version | 5ae0a02e8 TF-M v2.1.1 |
| Credit | Infineon Technologies AG, in collaboration with: Tobias Scharnowski, Simon Wörner and Johannes Willbold from fuzzware.io. |

## Background[](#background "Permalink to this heading")

The psa\_call message through the mailbox contains input/output vectors along
with their respective lengths. This message is provided by a NSPE client.
SPE takes the message and pass it to the mailbox dispatcher (tfm\_spe\_mailbox),
which handles the message by performing a copy of the i/o vectors into local
arrays. When either the client\_id translation or the psa\_call fails, the
dispatcher replies immediately to the client. At that moment, the outvec is
written back for its given length, which may not have been sanitized beforehand,
resulting in arbitrary access of memory if the provided length goes beyond the
legit vector size.

## Impact[](#impact "Permalink to this heading")

When the dispatcher in tfm\_spe\_mailbox is used, a user through mailbox could
write into arbitrary address by first placing the malicious data into the local
vectors with a bad message, then subsequently sending a psa\_call with an invalid
vector length. If both calls fail, the reply routine in tfm\_spe\_mailbox could
take the injected data and write it into a desired location specified by the
invalid length.
Note that the above sequence would require sending the two messages through two
different mailbox slots.

## Mitigation[](#mitigation "Permalink to this heading")

Ensure that the outvec is written back only when the psa operation is
successful. Any errors ahead of replying must be taken as a hint to avoid such
write-back since they may be due to wrong supplied user-data in the vectors
(pointers, length etc).
To achieve the above, proper sanitization of input data must also be performed
and related errors propagated to the reply subroutine.

---

*Copyright (c) 2024, Arm Limited. All rights reserved.*

---



=== Content from www.trustedfirmware.org_cdfa137b_20250110_211632.html ===
[![Trusted Firmware Logo](/_astro/TrustedFirmware-Logo_icon.23d65367_Z1CGhFD.webp)](/)Toggle Menu

* About[Overview](/about/)[Join](/join/)[FAQ](/faq/)[Code of Conduct](/coc/)
* News & Blogs[News](/news/)[Blog](/blog/)[Meetings](/meetings/)
[Security Center](https://trusted-firmware-docs.readthedocs.io/en/latest/security_center/index.html)[Contact](/contact/)
# TrustedFirmware-M (TF-M)

TFâM

**Trusted Firmware-M (TF-M) implements the Secure Processing Environment (SPE) for Armv8-M, Armv8.1-M architectures (e.g. the Cortex-M33, Cortex-M23, Cortex-M55, Cortex-M85 processors) or dual-core platforms. It is the platform security architecture reference implementation aligning with PSA Certified guidelines, enabling chips, Real Time Operating Systems and devices to become PSA Certified.**

Contribution guidelines can be found in the documentation.

Please subscribe to the project email list to to participate in development discussions.

A bi-weekly [Technical Forum call](/meetings/tf-m-technical-forum/) is held to discuss technical subjects.

[* documentationTrusted Firmware-M Documentation](https://trustedfirmware-m.readthedocs.io/en/latest/index.html)[* codeView source code](https://git.trustedfirmware.org/TF-M/trusted-firmware-m.git/)[* reviewGerrit review](https://review.trustedfirmware.org/q/project%3ATF-M/trusted-firmware-m)[* subscribeSubscribe to the TF-M mailing list](https://lists.trustedfirmware.org/mailman3/lists/tf-m.lists.trustedfirmware.org/)

* [Contribute/Submit Code](https://tf-m-user-guide.trustedfirmware.org/contributing/contributing_process.html)
* [Join the TF-M Tech Forum](/meetings/tf-m-technical-forum/)
## Other Trusted Firmware Projects

TFâA

MCUboot

TFâRMM

OPâTEE

Mbed TLS

Hafnium

Trusted Services

Open CI

For general and membership enquiries: enquiries@trustedfirmware.org

Harston Mill

Royston Rd, Harston

Cambridge, United Kingdom

CB22 7GG

## Latest News and Blogs

[* Trusted Firmware-A v2.12 released!

  Monday, January 6, 2025](/blog/tf-a-v2-12-release)[* Trusted Firmware OP TEE Release 4.4.0

  Sunday, October 20, 2024](/blog/tf-optee-release-4-4-0)[* Trusted Firmware OP TEE Release 4.3.0

  Friday, July 12, 2024](/blog/tf-optee-release-4-3-0)[* Trusted Firmware-Mâs First Long Term Support (LTS) Release v2.1.0

  Wednesday, May 22, 2024](/blog/tf-m-v2-1-0_lts)[View
on GitHub](https://www.github.com/TrustedFirmware/website)

Copyright Â© 2025 Linaro Limited[FAQ](/faq/)[Contact](/contact/)
[![logo](/_astro/Linaro-logo-white.08c6d219_k2UqS.webp)](/)
