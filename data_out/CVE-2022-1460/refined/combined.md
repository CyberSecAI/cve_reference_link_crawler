=== Content from gitlab.com_5fe1592d_20250108_124737.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-1460.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-1460.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-1460.json)
[Permalink](/gitlab-org/cves/-/blob/c6a6f86828227186d5080abce4d5f88d42571ec9/2022/CVE-2022-1460.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  May 09, 2022

  [3af01dc5](/gitlab-org/cves/-/commit/3af01dc56a73828768c8cad50763d336ac5ba9f9)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/3af01dc56a73828768c8cad50763d336ac5ba9f9)
  ·
  3af01dc5

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 09, 2022

  3af01dc5

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/3af01dc56a73828768c8cad50763d336ac5ba9f9)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored May 09, 2022

Loading



=== Content from gitlab.com_69c06e5f_20250108_124738.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Force maintainer to take ownership of a scheduled CI pipeline before editing it

# Context

This issue was first created via a HackerOne report. The full details of the report have been moved to a [comment](https://gitlab.com/gitlab-org/gitlab/-/issues/118782#note_621678220 "Force maintainer to take ownership of a scheduled CI pipeline before editing it") to keep the description uncluttered.

The worst vulnerability exposed by the report is that a maintainer can execute scheduled pipelines using another maintainer's `CI_JOB_TOKEN`. Fixing this vulnerability is addressed in [#328553 (closed)](https://gitlab.com/gitlab-org/gitlab/-/issues/328553 "Enable secure bot authorization workflows with CI_JOB_TOKEN") and will **not** be addressed by this issue. See [#118782 (comment 575544233)](https://gitlab.com/gitlab-org/gitlab/-/issues/118782#note_575544233 "Force maintainer to take ownership of a scheduled CI pipeline before editing it") for more details.

A lesser vulnerability is that Maintainer B can edit a pipeline schedule created by Maintainer A without Maintainer A's knowledge. This vulnerability will be addressed by this issue.

# Proposed solution

Force maintainer or above user B to take ownership of the pipeline schedule in order to edit it. If Maintainer A then wants to edit the schedule, they must take ownership again or pipelines will keep running as maintainer B.

## Technical details

Disallow updating schedules owned by other users, by making `owner_of_schedule` mandatory in `Ci::PipelineSchedulePolicy` => `:update_pipeline_schedule`. Move `update_pipeline_schedule` into a new policy block so that other policies are not effected by this change

**Note:** this is a breaking change for the pipeline schedule [edit action](https://docs.gitlab.com/ee/api/pipeline_schedules.html#edit-a-pipeline-schedule) in the REST API. Because it is a [security](/gitlab-org/gitlab/-/issues?label_name=security "Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/") fix, the breaking change should be communicated in a security blog post with the release of the fix and not before

Related Security Issue: <https://gitlab.com/gitlab-org/security/gitlab/-/issues/658>

Edited Apr 22, 2022 by [Allison Browne](/allison.browne)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


