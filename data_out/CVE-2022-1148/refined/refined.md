```json
{
  "vulnerability": {
    "root_cause": "The gitlab-pages session cookies are not properly validated to ensure that the requested subdomain is the same as the subdomain to which the session cookie was issued for.",
    "weaknesses": [
      "Improper validation of session cookies",
      "Cross-subdomain usage of session cookies"
    ],
    "impact": "An attacker can steal Gitlab Pages session tokens and access every private Gitlab Pages site that the victim has access to.",
    "attack_vectors": [
      "Service worker interception of requests to the `/auth` endpoint on a Pages site",
      "Bypassing CSRF protection (OAuth2 `state` parameter) by obtaining a valid session cookie and redirection URL from an attacker-controlled website",
       "Interception of the OAuth2 response containing the code and state by an attacker's service worker."
    ],
    "required_capabilities": "The attacker needs to create a private Gitlab Pages site, invite the victim to collaborate on the project, and host an attacker-controlled server to intercept and store the session token."
  }
}
```