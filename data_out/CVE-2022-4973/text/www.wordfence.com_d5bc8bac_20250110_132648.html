

![](https://www.wordfence.com/wp-content/uploads/2022/08/WordPress-Core-6.0.2-Security-Maintenance-Release-What-You-Need-to-Know.png)

[![](https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&d=mm&r=g)Wordfence Author](https://www.wordfence.com/blog/author/wfauthor/)

August 30, 2022

# WordPress Core 6.0.2 Security & Maintenance Release – What You Need to Know

On August 30, 2022, the WordPress core team [released WordPress version 6.0.2](https://wordpress.org/news/2022/08/wordpress-6-0-2-security-and-maintenance-release/), which contains patches for 3 vulnerabilities, including a High Severity SQLi vulnerability in the Links functionality as well as two Medium Severity Cross-Site Scripting vulnerabilities.

These patches have been backported to every version of WordPress since 3.7. WordPress has supported automatic core updates for security releases since WordPress 3.7, and the vast majority of WordPress sites should receive a patch for their major version of WordPress automatically over the next 24 hours. We recommend verifying that your site has been automatically updated to one of the patched versions. Patched versions are available for every major version of WordPress since 3.7, so you can update without risking compatibility issues. If your site has not been updated automatically we recommend updating manually.

## Vulnerability Analysis

As with every WordPress core release containing security fixes, the Wordfence Threat Intelligence team analyzed the code changes in detail to evaluate the impact of these vulnerabilities on our customers, and to ensure our customers remain protected.

We have determined that these vulnerabilities are unlikely to be targeted for exploitation due to the special cases needed to exploit. In most circumstances these vulnerabilities require either elevated privileges, such as those of an administrator, or the presence of a separate vulnerable or malicious plugin. Nonetheless, the Wordfence firewall should protect against any exploits that do not require administrative privileges. In nearly all cases administrators already have the maximum level of access and attackers with that level of access are unlikely to use convoluted and difficult exploits when simpler paths to making configuration changes or obtaining sensitive information are readily available.

---

**Description:** SQL Injection via Links LIMIT clause

**Affected Versions:** WordPress Core < 6.0.2

**Researcher:** FVD

**CVE ID:** Pending

**CVSS Score:** 8.0 (High)

**CVSS Vector:**[CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H)

**Fully Patched Version:** 6.0.2

The WordPress Link functionality, previously known as “Bookmarks”, is no longer enabled by default on new WordPress installations. Older sites may still have the functionality enabled, which means that millions of legacy sites are potentially vulnerable, even if they are running newer versions of WordPress. Fortunately, we found that the vulnerability requires administrative privileges and is difficult to exploit in a default configuration. It is possible that 3rd party plugins or themes might allow this vulnerability to be used by editor-level users or below, and in these cases the Wordfence firewall will block any such exploit attempts.

Vulnerable versions of WordPress [failed to successfully sanitize](https://core.trac.wordpress.org/changeset/53962/) the `limit` argument of the link retrieval query in the `get_bookmarks` function, used to ensure that only a certain number of links were returned. In a default configuration, only the Links legacy widget calls the `get_bookmarks` function in a way that allows this argument to be set by a user. Legacy widgets involve additional safeguards, and the injection point of the query itself poses additional difficulties, making this vulnerability nontrivial to exploit.

---

**Description:** Contributor+ Stored Cross-Site Scripting via use of `the_meta` function

**Affected Versions:** WordPress Core < 6.0.2

**Researcher:** John Blackbourn

**CVE ID:** Pending

**CVSS Score:** 4.9 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Fully Patched Version:** 6.0.2

WordPress content creators, such as Contributors, Editors, Authors, and Administrators, have the ability to add custom fields to any page and post created. The purpose of this is to make it possible for site content creators to add and associate additional data to posts and pages.

WordPress has [several functions available](https://wordpress.org/support/article/custom-fields/#displaying-custom-fields) to site owners to display custom fields created and associated with posts and pages. One of these functions is the `the_meta` function which retrieves the supplied post’s or page’s custom field data, which is stored as post meta data, through the `get_post_custom_keys` and `get_post_custom_values` functions. Once the custom fields for a post/page are retrieved, the function outputs the post meta keys and values data as a list. Unfortunately, [in versions older than 6.0.2 this data was unescaped on output](https://core.trac.wordpress.org/changeset/53961) making it possible for any injected scripts in post meta keys and values to be executed.

Due to the fact that any user with access to the post editor can add custom meta fields, users with access to the editor such as contributors could inject malicious JavaScript that executes on any page or post where this function is called.

WordPress core does not call `the_meta` anywhere in its codebase by default. As such this vulnerability does require a plugin or theme that calls the `the_meta` function, or for this function to have been programmatically added to a PHP file for execution, so the vast majority of site owners are not vulnerable to this issue. The `the_meta` function is considered deprecated as of 6.0.2 and `get_post_meta` is the recommended alternative.

The Wordfence Threat Intelligence Team deployed a firewall rule to help protect [Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Care](https://www.wordfence.com/products/wordfence-care/) & [Response](https://www.wordfence.com/products/wordfence-response/) customers today. Wordfence Free users will receive the same protection in 30 days on September 29, 2022.

---

**Description:** Stored Cross-Site Scripting via Plugin Deactivation and Deletion errors

**Affected Versions:** WordPress Core < 6.0.2

**Researcher:** ​​Khalilov Moe

**CVE ID:** Pending

**CVSS Score:** 4.7 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Fully Patched Version:** 6.0.2

The final vulnerability involves the error messages displayed when a plugin has been deactivated due to an error, or when a plugin can not be deleted due to an error. [As these error messages were not escaped](https://core.trac.wordpress.org/changeset/53963/), any JavaScript present in these error messages would execute in the browser session of an administrator visiting the plugins page. This vulnerability would require a separate malicious or vulnerable plugin or other code to be installed on the site, which would typically require an administrator to install it themselves. In almost all cases where this vulnerability might be exploitable an attacker would already have a firm foothold on the vulnerable site.

Our built-in XSS rule should block any attempts to generate crafted error messages based on user input to a vulnerable plugin, and the Wordfence scanner will detect any malicious plugins uploaded by an administrator.

## **Conclusion**

In today’s article, we covered three vulnerabilities patched in [the WordPress 6.0.2 Security and Maintenance Release](https://wordpress.org/news/2022/08/wordpress-6-0-2-security-and-maintenance-release/). Most actively used WordPress sites should be patched via automatic updates within the next 24 hours, and any sites that remain vulnerable would only be exploitable under very specific circumstances.

We have released a firewall rule to [Wordfence Premium](https://www.wordfence.com/products/wordfence-premium/), [Care](https://www.wordfence.com/products/wordfence-care/), and [Response](https://www.wordfence.com/products/wordfence-response/) users to protect against any exploits targeting the `the_meta` function and this rule should become available to Wordfence free users after 30 days, on on September 29, 2022.

As always, we strongly recommend updating your site to a patched version of WordPress if it hasn’t been updated automatically. As long as you are running a version of WordPress greater than 3.7, an update is available to patch these vulnerabilities while keeping you on the same major version, so you will not need to worry about compatibility issues.

*Props to Khalilov Moe, John Blackbourn, & FVD for discovering and responsibly disclosing these vulnerabilities. Special thanks to Wordfence Threat Intelligence Lead Chloe Chamberland for collaborating on this post.*

*This article was written by Ramuel Gall, a former Wordfence Senior Security Researcher.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F08%2Fwordpress-core-6-0-2-security-maintenance-release-what-you-need-to-know%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F08%2Fwordpress-core-6-0-2-security-maintenance-release-what-you-need-to-know%2F&text=WordPress%20Core%206.0.2%20Security%20%26%20Maintenance%20Release%20%E2%80%93%20What%20You%20Need%20to%20Know&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2022%2F08%2Fwordpress-core-6-0-2-security-maintenance-release-what-you-need-to-know%2F)

## Comments

No Comments

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save

