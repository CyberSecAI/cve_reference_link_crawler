=== Content from bugzilla.mozilla.org_414c22ee_20250110_234531.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/291640)
* [XML](/show_bug.cgi?ctype=xml&id=291640)

Closed
[Bug 291640](/show_bug.cgi?id=291640)
(CVE-2023-37203)

Opened 20 years ago
Closed 2 years ago

# Drag and drop can create shortcuts to local files

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Drag and drop can create shortcuts to local files

## Categories

### (Core :: DOM: Copy & Paste and Drag & Drop, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop#DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)

DOM: Copy & Paste and Drag & Drop
▾

Core :: DOM: Copy & Paste and Drag & Drop
All issues with copy-and-paste and drag-and-drop can be reported here, be it with the web API or the platform backends. This includes clipboard issues.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Copy%20%26%20Paste%20and%20Drag%20%26%20Drop)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

115 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox113 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix) |
| firefox114 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox113 |  | wontfix |
| firefox114 |  | wontfix |
| firefox115 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: pvnick, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/af3c9e40e7f18636e79cdee096632026?d=mm&size=40)  [pvnick](/user_profile?user_id=222137)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/331afc283e18d6d28cb7ebb11b2cf5bb?d=mm&size=40)  [hsinyi](/user_profile?user_id=434964)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

### ( URL )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated"), [1832266](/show_bug.cgi?id=1832266 "RESOLVED FIXED - Add test to check we block drag/drop of file: urls, and a:/c:/d:/ \"url\"s on Windows")

Dependency [tree](/showdependencytree.cgi?id=291640&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=291640)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1828429](/show_bug.cgi?id=1828429 "RESOLVED DUPLICATE - .URL Extension Download Via Drag and Drop")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

javascript:'Drag this broken image to...

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate, Whiteboard: [sg:moderate][adv-main115+] high with cooperation from the victim)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-37203

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:moderate][adv-main115+] high with cooperation from the victim

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jay](/user_profile?user_id=5564) | [blocking-aviary1.0.5](#c6 "20 years ago") | - |
| --- | --- | --- |
| [jay](/user_profile?user_id=5564) | blocking-aviary1.0.5 | - |
| --- | --- | --- |
| [cbeard](/user_profile?user_id=164061) | [blocking-aviary1.0.8](#c0 "20 years ago") | - |
| --- | --- | --- |
| [cbeard](/user_profile?user_id=164061) | blocking-aviary1.0.8 | - |
| --- | --- | --- |
| [asa](/user_profile?user_id=5003) | [blocking1.8b3](#a5087694_5003 "20 years ago") | - |
| --- | --- | --- |
| [asa](/user_profile?user_id=5003) | blocking1.8b3 | - |
| --- | --- | --- |
| [cbeard](/user_profile?user_id=164061) | [blocking1.8b5](#c0 "20 years ago") | - |
| --- | --- | --- |
| [cbeard](/user_profile?user_id=164061) | blocking1.8b5 | - |
| --- | --- | --- |
| [cbeard](/user_profile?user_id=164061) | [blocking-aviary1.5](#c7 "20 years ago") | - |
| --- | --- | --- |
| [cbeard](/user_profile?user_id=164061) | blocking-aviary1.5 | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 3 obsolete files)

| [patch](/attachment.cgi?id=603406)  [13 years ago](#c13)  [Neil Deakin](/user_profile?user_id=6102)   12.48 KB, patch |  | [Details](/attachment.cgi?id=603406&action=edit) | [Diff](/attachment.cgi?id=603406&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=291640&attachment=603406) |
| --- | --- | --- |
| [Patch version 2, fix up test](/attachment.cgi?id=612661)  [13 years ago](#c14)  [Neil Deakin](/user_profile?user_id=6102)   12.45 KB, patch |  | [Details](/attachment.cgi?id=612661&action=edit) | [Diff](/attachment.cgi?id=612661&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=291640&attachment=612661) |
| [Bug 291640, r?emilio](/attachment.cgi?id=9332581)  [2 years ago](#c21)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9332581&action=edit) | [Review](/attachment.cgi?id=9332581) |
| [Bug 291640, r?mak](/attachment.cgi?id=9334582)  [2 years ago](#c26)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9334582&action=edit) | [Review](/attachment.cgi?id=9334582) |
| [advisory.txt](/attachment.cgi?id=9341326)  [2 years ago](#c28)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   308 bytes, text/plain |  | [Details](/attachment.cgi?id=9341326&action=edit) |
| [advisory.txt](/attachment.cgi?id=9341362)  [2 years ago](#c29)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   318 bytes, text/plain |  | [Details](/attachment.cgi?id=9341362&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Paul Nickerson](/user_profile?user_id=222137)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=291640#c0)• 20 years ago |
|  | |

User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.7) Gecko/20050414 Firefox/1.0.3
Build Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.7) Gecko/20050414 Firefox/1.0.3
In the page javascript:'Drag this broken image to the desktop:<img
src="C:/windows/system32/cmd.exe">', dragging the broken image to the desktop
will create a shortcut to cmd.exe, which, when opened, will spawn cmd.exe
Reproducible: Always
Steps to Reproduce:
1.javascript:'Drag this broken image to the desktop:<img
src="C:/windows/system32/cmd.exe">'
2. drag broken image to desktop
3. double click new icon on desktop
Actual Results:
cmd.exe opened
Expected Results:
executable files shouldnt be draggable

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=291640#c1)• 20 years ago |
|  | |

ok, this one is real, and i can make it more dangerous pre sp2.
however, it's all limited to the 1.0 branch, i had someone test for me on trunk
and none of the cases i provided worked.Version: unspecified → 1.0 Branch

|  | [(not currently active) Ted Mielczarek](/user_profile?user_id=39022) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=291640#c2)• 20 years ago |
|  | |

Confirming on 1.0.3. In XPSP2, dragging to the desktop prompts me to add it as
an Active Desktop item, but dragging it to a folder creates a .url shortcut,
which will launch the application when double clicked. In SP2 this has a
security prompt before it actually launches.Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=291640#c3)• 20 years ago |
|  | |

Is there a way to influence the name of the link? If it looks like <blah>cmd.exe
it's kind of on the user if they click it. You're not dragging the exe itself,
just a shortcut. Is there a way to pass parameters? That would certainly make
this more dangerous.Flags: blocking-aviary1.1?Flags: blocking-aviary1.0.4?

|  | [timeless](/user_profile?user_id=15223) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=291640#c4)• 20 years ago |
|  | |

yes there is. i'll explain elsewhere.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a2832440_1689)• 20 years ago |

Blocks: [sbb?](/show_bug.cgi?id=256195 "RESOLVED WORKSFORME - Security Bug Bounty: nominated")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a3890426_1689)• 20 years ago |

Assignee: bugs → dveditzFlags: blocking1.8b3+Flags: blocking-aviary1.1?Flags: blocking-aviary1.1+Flags: blocking-aviary1.0.5?Flags: blocking-aviary1.0.5+Product: Firefox → CoreWhiteboard: [sg:fix]

|  | [Jay Patel [:jay]](/user_profile?user_id=5564) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=291640#c5)• 20 years ago |
|  | |

Not going to make the 1.0.5 train, but need to look into this for future 1.0.x
release.

|  | [Jay Patel [:jay]](/user_profile?user_id=5564) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=291640#c6)• 20 years ago |
|  | |

-'d per drivers meetingFlags: blocking-aviary1.0.5+ → blocking-aviary1.0.5-

|  | [Jay Patel [:jay]](/user_profile?user_id=5564) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a4664522_5564)• 20 years ago |

Flags: blocking-aviary1.0.6+

|  | [Asa Dotzler [:asa]](/user_profile?user_id=5003) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a5087694_5003)• 20 years ago |

Flags: blocking1.8b4+Flags: blocking1.8b3-Flags: blocking1.8b3+

|  | [Chris Beard](/user_profile?user_id=164061) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=291640#c7)• 19 years ago |
|  | |

would be nice to fix, not critical for aviary1.5 (dveditz)
/cb
Flags: blocking1.8b4-Flags: blocking1.8b4+Flags: blocking-aviary1.5-Flags: blocking-aviary1.5+Flags: blocking-aviary1.0.7-Flags: blocking-aviary1.0.7+

|  | [Ali Ebrahim](/user_profile?user_id=96067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a55964183_96067)• 18 years ago |

QA Contact: ali → ian

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=291640#c8)• 18 years ago |
|  | |

Did the patch in [bug 285438](/show_bug.cgi?id=285438 "RESOLVED FIXED - Drag and drop gestures can be hijacked to load priviliged xul") take care of this bug?Whiteboard: [sg:fix] → [sg:moderate] critical with cooperation from the victim

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a118466425_1689)• 16 years ago |

Version: 1.0 Branch → 1.7 Branch

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=291640#c9)• 13 years ago |
|  | |

Is this still an issue? Does it need to remain hidden?

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=291640#c10)• 13 years ago |
|  | |

I just tested this using Windows 7 and the latest trunk nightly and this appears to still be a problem. Dragging the test icon to the desktop creates a shortcut to the executable that will execute without any prompts.
I don't know enough about security expectations with this sort of thing to know how big of a problem this is.

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=291640#c11)• 13 years ago |
|  | |

This is only really a problem in combination with file-planting attacks or other things. But in any case we should fix it, probably doing a checkLoadURIWithPrincipal to see whether the website is allowed to link to that thing.

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a216752310_18821)• 13 years ago |

Version: 1.7 Branch → Trunk

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=291640#c12)• 13 years ago |
|  | |

Neil - can you look into this?Assignee: dveditz → enndeakin

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=291640#c13)• 13 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=603406&action=diff) (obsolete)
— [Details](attachment.cgi?id=603406&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=291640&attachment=603406)

This patch does the basic implementation. There are two issues I am not sure how to deal with:
- the test displays a 'grant privileges dialog'.
- test testcase in the first comment uses a file path not a url.
But this patch is a suitable starting point.

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=291640#c14)• 13 years ago |
|  | |

Attached patch

[Patch version 2, fix up test](attachment.cgi?id=612661&action=diff) (obsolete)
— [Details](attachment.cgi?id=612661&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=291640&attachment=612661)

[Attachment #603406](/attachment.cgi?id=603406&action=edit "patch") -
Attachment is obsolete: true

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=291640#c15)• 13 years ago |
|  | |

Comment on [attachment 612661](/attachment.cgi?id=612661 "Patch version 2, fix up test") [[details]](/attachment.cgi?id=612661&action=edit "Patch version 2, fix up test") [[diff]](/attachment.cgi?id=612661&action=diff "Patch version 2, fix up test") [[review]](/page.cgi?id=splinter.html&ignore=&bug=291640&attachment=612661)
Patch version 2, fix up test
Not sure entirely about this patch as it doesn't fix the reported issue. Wondering if it would be better to have the platform-specific widget layer reject creating links to local files somehow.
[Attachment #612661](/attachment.cgi?id=612661&action=edit "Patch version 2, fix up test") -
Flags: feedback?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=291640#c16)• 13 years ago |
|  | |

Why would it have to be platform-specific?
Couldn't we whitelist the allowed schemes, or at least blacklist javascript: ?

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=291640#c17)• 13 years ago |
|  | |

(In reply to Olli Pettay [:smaug] from [comment #16](/show_bug.cgi?id=291640#c16 "RESOLVED FIXED - Drag and drop can create shortcuts to local files"))
> Why would it have to be platform-specific?
> Couldn't we whitelist the allowed schemes, or at least blacklist javascript:
> ?
'javascript:' isn't used here.
The bug here is in preventing:
event.dataTransfer.setData("text/x-moz-url-data", "c:/builds/");
which isn't actually a URL and Windows translates it in some manner when creating a shortcut.

|  | [Curtis Koenig [:curtisk-use curtis.koenig+bzATgmail.com]]](/user_profile?user_id=406847) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a221779039_406847)• 13 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=291640#c18)• 13 years ago |
|  | |

Comment on [attachment 612661](/attachment.cgi?id=612661 "Patch version 2, fix up test") [[details]](/attachment.cgi?id=612661&action=edit "Patch version 2, fix up test") [[diff]](/attachment.cgi?id=612661&action=diff "Patch version 2, fix up test") [[review]](/page.cgi?id=splinter.html&ignore=&bug=291640&attachment=612661)
Patch version 2, fix up test
Ah, ok. Sounds like widget layer fix is needed.
[Attachment #612661](/attachment.cgi?id=612661&action=edit "Patch version 2, fix up test") -
Flags: feedback?(bugs)

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a326884836_546015)• 9 years ago |

Group: core-security → dom-core-security

|  | [Neil Deakin](/user_profile?user_id=6102) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a329771448_6102)• 9 years ago |

Assignee: enndeakin → nobody

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a352327927_7044)• 9 years ago |

Group: dom-core-security → firefox-core-securityProduct: Core → Firefox

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a548874755_406194)• 2 years ago |

QA Contact: ian

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=291640#c19)• 2 years ago |
|  | |

In the process of [migrating remaining bugs to the new severity system](https://bugzilla.mozilla.org/show_bug.cgi?id=1789259), the severity for this bug cannot be automatically determined. Please retriage this bug using the [new severity system](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity).

Severity: major → --

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a569377885_159069)• 2 years ago |

Duplicate of this bug: [1828429](/show_bug.cgi?id=1828429 "RESOLVED DUPLICATE - .URL Extension Download Via Drag and Drop")

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a569377909_159069)• 2 years ago |

Assignee: nobody → gijskruitbosch+bugs

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=291640#c21)• 2 years ago |
|  | |

Attached file
[Bug 291640, r?emilio](attachment.cgi?id=9332581)
— [Details](attachment.cgi?id=9332581&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a569419121_159069)• 2 years ago |

Group: firefox-core-security → dom-core-securityComponent: File Handling → DOM: Copy & Paste and Drag & DropOS: Windows XP → AllProduct: Firefox → CoreHardware: x86 → Desktop

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a569419207_159069)• 2 years ago |

Blocks: [1832266](/show_bug.cgi?id=1832266 "RESOLVED FIXED - Add test to check we block drag/drop of file: urls, and a:/c:/d:/ \"url\"s on Windows")

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=291640#c22)• 2 years ago |
|  | |

Filed [bug 1832266](/show_bug.cgi?id=1832266 "RESOLVED FIXED - Add test to check we block drag/drop of file: urls, and a:/c:/d:/ \"url\"s on Windows") for tests.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=291640#c23)• 2 years ago |
|  | |

r=emilio

<https://hg.mozilla.org/integration/autoland/rev/c8f66e4894442df742c8b2b29be26a2937c193be>

<https://hg.mozilla.org/mozilla-central/rev/c8f66e489444>

Group: dom-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 2 years ago
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 115 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a569479220_75935)• 2 years ago |

[Attachment #612661](/attachment.cgi?id=612661&action=edit "Patch version 2, fix up test") -
Attachment is obsolete: true

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a569479290_75935)• 2 years ago |

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a569523274_406194)• 2 years ago |

Severity: -- → S2

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=291640#c24)• 2 years ago |
|  | |

This fix works for `file:` but appears to be incomplete for `c:/` links.

Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a569951495_159069)• 2 years ago |

Group: core-security-release → dom-core-security
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=291640#c25)• 2 years ago |
|  | |

Hm, so the reason I didn't catch this originally is that it seems that we are more strict than Windows in how we parse Windows paths into URLs. Specifically, a link that points to: `C:\Users` gets transformed to `file:///C:/Users` (and blocked, on current nightly already) but a link to `C:/Users` does not. This causes problems when we then pass this information to Windows and it *does* then interpret the target as a file path.

The simplest fix is to change the URI fixup parser to also recognize this syntax as a `file` URI, [here](https://searchfox.org/mozilla-central/rev/f60cf6bfa8bd096efd9bb3a445364f5a0f32897a/docshell/base/URIFixup.sys.mjs#918-922). It's worth noting that just setting `attemptFixup` to true in that case is insufficient: our Windows path parsing code will fail to initialize the file when the path is made up of forward slashes instead of backslashes.

I have a patch for this. It passes urlbar and docshell urifixup unit tests without changes... in principle it shouldn't end up impacting any web content because we'd primarily use nsIURI for security checks and navigation, rather than fixup. I think fixing up `C:/Users/` in the URL bar to `file:///C:/Users/` (instead of a search query with the default search provider) is probably a net win, but if we think that may be in doubt we could put it behind a fixup flag and/or pref.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=291640#c26)• 2 years ago |
|  | |

Attached file
[Bug 291640, r?mak](attachment.cgi?id=9334582)
— [Details](attachment.cgi?id=9334582&action=edit)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=291640#c27)• 2 years ago |
|  | |

r=mak

<https://hg.mozilla.org/integration/autoland/rev/d5620d8eb2090ec5a6024d64684b005429066c5c>

<https://hg.mozilla.org/mozilla-central/rev/d5620d8eb209>

Group: dom-core-security → core-security-releaseStatus: REOPENED → RESOLVEDClosed: 2 years ago → 2 years ago
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a573589983_586683)• 2 years ago |

Whiteboard: [sg:moderate] critical with cooperation from the victim → [sg:moderate][adv-main115+] critical with cooperation from the victim

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=291640#c28)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9341326) (obsolete)
— [Details](attachment.cgi?id=9341326&action=edit)

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=291640#c29)• 2 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9341362)
— [Details](attachment.cgi?id=9341362&action=edit)

[Attachment #9341326](/attachment.cgi?id=9341326&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a573682687_578488)• 2 years ago |

Alias: CVE-2023-37203

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a574274853_1689)• 2 years ago |

Whiteboard: [sg:moderate][adv-main115+] critical with cooperation from the victim → [sg:moderate][adv-main115+] high with cooperation from the victim

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=291640#a583308942_1689)• 1 year ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=291640&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Neil Deakin](/user_profile?user_id=6102)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from security.gentoo.org_897e22ca_20250110_234531.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_ecd955a5_20250110_234532.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-22

## Security Vulnerabilities fixed in Firefox 115

Announced
July 4, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 115

#### [#CVE-2023-3482: Block all cookies bypass for localstorage](#CVE-2023-3482)

Reporter
Martin Hostettler
Impact
moderate
##### Description

When Firefox is configured to block storage of all cookies, it was still possible to store data in localstorage by using an iframe with a source of 'about:blank'. This could have led to malicious websites storing tracking data without permission.

##### References

* [Bug 1839464](https://bugzilla.mozilla.org/show_bug.cgi?id=1839464)

#### [#CVE-2023-37201: Use-after-free in WebRTC certificate generation](#CVE-2023-37201)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An attacker could have triggered a use-after-free condition when creating a WebRTC connection over HTTPS.

##### References

* [Bug 1826002](https://bugzilla.mozilla.org/show_bug.cgi?id=1826002)

#### [#CVE-2023-37202: Potential use-after-free from compartment mismatch in SpiderMonkey](#CVE-2023-37202)

Reporter
zx
Impact
high
##### Description

Cross-compartment wrappers wrapping a scripted proxy could have caused objects from other compartments to be stored in the main compartment resulting in a use-after-free.

##### References

* [Bug 1834711](https://bugzilla.mozilla.org/show_bug.cgi?id=1834711)

#### [#CVE-2023-37203: Drag and Drop API may provide access to local system files](#CVE-2023-37203)

Reporter
Paul Nickerson and Ameen Basha M K
Impact
moderate
##### Description

Insufficient validation in the Drag and Drop API in conjunction with social engineering, may have allowed an attacker to trick end-users into creating a shortcut to local system files. This could have been leveraged to execute arbitrary code.

##### References

* [Bug 291640](https://bugzilla.mozilla.org/show_bug.cgi?id=291640)

#### [#CVE-2023-37204: Fullscreen notification obscured via option element](#CVE-2023-37204)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using an option element by introducing lag via an expensive computational function. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832195](https://bugzilla.mozilla.org/show_bug.cgi?id=1832195)

#### [#CVE-2023-37205: URL spoofing in address bar using RTL characters](#CVE-2023-37205)

Reporter
Rohan Sharma
Impact
moderate
##### Description

The use of RTL Arabic characters in the address bar may have allowed for URL spoofing.

##### References

* [Bug 1704420](https://bugzilla.mozilla.org/show_bug.cgi?id=1704420)

#### [#CVE-2023-37206: Insufficient validation of symlinks in the FileSystem API](#CVE-2023-37206)

Reporter
Ameen Basha M K
Impact
moderate
##### Description

Uploading files which contain symlinks may have allowed an attacker to trick a user into submitting sensitive data to a malicious website.

##### References

* [Bug 1813299](https://bugzilla.mozilla.org/show_bug.cgi?id=1813299)

#### [#CVE-2023-37207: Fullscreen notification obscured](#CVE-2023-37207)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1816287](https://bugzilla.mozilla.org/show_bug.cgi?id=1816287)

#### [#CVE-2023-37208: Lack of warning when opening Diagcab files](#CVE-2023-37208)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening Diagcab files, Firefox did not warn the user that these files may contain malicious code.

##### References

* [Bug 1837675](https://bugzilla.mozilla.org/show_bug.cgi?id=1837675)

#### [#CVE-2023-37209: Use-after-free in "NotifyOnHistoryReload"](#CVE-2023-37209)

Reporter
Simon Descarpentries
Impact
moderate
##### Description

A use-after-free condition existed in `NotifyOnHistoryReload` where a `LoadingSessionHistoryEntry` object was freed and a reference to that object remained. This resulted in a potentially exploitable condition when the reference to that object was later reused.

##### References

* [Bug 1837993](https://bugzilla.mozilla.org/show_bug.cgi?id=1837993)

#### [#CVE-2023-37210: Full-screen mode exit prevention](#CVE-2023-37210)

Reporter
Hafiizh
Impact
low
##### Description

A website could prevent a user from exiting full-screen mode via alert and prompt calls. This could lead to user confusion and possible spoofing attacks.

##### References

* [Bug 1821886](https://bugzilla.mozilla.org/show_bug.cgi?id=1821886)

#### [#CVE-2023-37211: Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](#CVE-2023-37211)

Reporter
Andrew McCreight, Matthew Gaudet, Tom Ritter, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 114, Firefox ESR 102.12, and Thunderbird 102.12. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115, Firefox ESR 102.13, and Thunderbird 102.13](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1832306%2C1834862%2C1835886%2C1836550%2C1837450)

#### [#CVE-2023-37212: Memory safety bugs fixed in Firefox 115](#CVE-2023-37212)

Reporter
Andrew McCreight, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 114. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 115](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1750870%2C1825552%2C1826206%2C1827076%2C1828690%2C1833503%2C1835710%2C1838587)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


