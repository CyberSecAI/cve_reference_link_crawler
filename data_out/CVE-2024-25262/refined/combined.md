=== Content from bugs.launchpad.net_e40d7e22_20250111_072342.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[texlive-bin package](https://launchpad.net/ubuntu/%2Bsource/texlive-bin)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/texlive-bin)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/texlive-bin)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/texlive-bin)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/texlive-bin)

# There is a heap buffer overflow in texlive-bin

Bug #2047912 reported by
[DongzhuoZhao](https://launchpad.net/~dongzhuo)
on 2024-01-03

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [texlive-bin (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin "Latest release: 2024.20240313.70630+ds-5build2, uploaded to main on 2025-01-06 04:35:42.065706+00:00 by Matthias Klose (doko), maintained by Debian TeX Maintainers (debian-tex-maint-lists)") | Fix Released | Undecided | Unassigned |  |

### Bug Description

Hello,

  I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can install by apt-get texlive-binaries. I compile lastest texlive-source by clone <https://github.com/TeX-Live/texlive-source/> on unbuntu for debugging.

  The overflow content and size are controlled by input. Exploiting this issue can achive any code excuted

The steps for reproducing the vul on unbuntu:

  (1) sudo apt-get iunstall texlive-binaries

  (2) ttfdump -i poc.ttf

The poc.ttf can view the attachment .ttfdump aborted and prompt "malloc(): corrupted top size" due memory corrupt.

The issue exist in function ttfLoadHDMX :

/\*\*\* function ttfLoadHDMX begin \*\*\*/

static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)

{

    int i;

xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");

hdmx->version = ttfGetUSHORT(fp);

    hdmx->numDevices = ttfGetUSHORT(fp);

    hdmx->size = ttfGetLONG(fp);

hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);

for (i=0;i<hdmx->numDevices;i++)

 {

     hdmx->Records[i].PixelSize = ttfGetBYTE(fp);

     hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);

     hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)

     fread ((hdmx->Records+i)->Width, sizeof(BYTE), hdmx->numGlyphs+1,fp); (2)

 }

}

/\*\*\* function ttfLoadHDMX end \*\*\*/

At above code (1) ,allocte heap buffer for Width according to the parsed hdmx width. And at above code (2) , copy Width content from file and copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.

/\*\*\* debug info \*\*\*/

(gdb) p hdmx->numGlyphs+1

$23 = 4155

(gdb) p hdmx->size

$24 = 1216

/\*\*\* debug info end \*\*\*/

From :

Dongzhuo zhao working with ADLab of Venustech

## CVE References

* [2019-18604](/bugs/cve/2019-18604 "In axohelp.c before 1.3 in axohelp in...")
* [2023-32668](/bugs/cve/2023-32668 "LuaTeX before 1.17.0 allows a documen...")
* [2024-25262](/bugs/cve/2024-25262 "texlive-bin commit c515e was discover...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [DongzhuoZhao (dongzhuo)](https://launchpad.net/~dongzhuo) wrote on 2024-01-03: |  |  | [#1](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/1) |
| --- | --- | --- | --- |

* [used for triggering vul](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Battachment/5735842/%2Bfiles/poc.ttf)
  [Edit](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Battachment/5735842)
  (1.4 MiB,
  font/ttf)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2024-01-19: |  |  | [#2](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/2) |
| --- | --- | --- | --- |

Thanks for reporting this issue. Have you notified the texlive developer so that they can work on a fix? If not, please file a bug with them. Once they have developed a fix, we can include it in Ubuntu. Thanks!

Thanks for reporting this issue. Have you notified the texlive developer so that they can work on a fix? If not, please file a bug with them. Once they have developed a fix, we can include it in Ubuntu. Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [DongzhuoZhao (dongzhuo)](https://launchpad.net/~dongzhuo) wrote on 2024-01-22:  [**Re: [Bug 2047912] Re: There is a heap buffer overflow in texlive-bin**](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/3) |  |  | [#3](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/3) |
| --- | --- | --- | --- |

I haven't notified them and I will try. Thanks for your replying😀

Marc Deslauriers <email address hidden> 于2024年1月20日周六 03:56写道：

> Thanks for reporting this issue. Have you notified the texlive developer

> so that they can work on a fix? If not, please file a bug with them.

> Once they have developed a fix, we can include it in Ubuntu. Thanks!

>

> --

> You received this bug notification because you are subscribed to the bug

> report.

> <https://bugs.launchpad.net/bugs/2047912>

>

> Title:

> There is a heap buffer overflow in texlive-bin

>

> Status in texlive-bin package in Ubuntu:

> New

>

> Bug description:

> Hello,

> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can

> install by apt-get texlive-binaries. I compile lastest texlive-source by

> clone <https://github.com/TeX-Live/texlive-source/> on unbuntu for

> debugging.

> The overflow content and size are controlled by input. Exploiting

> this issue can achive any code excuted

>

> The steps for reproducing the vul on unbuntu:

> (1) sudo apt-get iunstall texlive-binaries

> (2) ttfdump -i poc.ttf

>

>

> The poc.ttf can view the attachment .ttfdump aborted and prompt

> "malloc(): corrupted top size" due memory corrupt.

>

> The issue exist in function ttfLoadHDMX :

>

> /\*\*\* function ttfLoadHDMX begin \*\*\*/

>

> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)

> {

> int i;

>

> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");

>

> hdmx->version = ttfGetUSHORT(fp);

> hdmx->numDevices = ttfGetUSHORT(fp);

> hdmx->size = ttfGetLONG(fp);

>

> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);

>

> for (i=0;i<hdmx->numDevices;i++)

> {

> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);

> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);

> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)

> fread ((hdmx->Records+i)->Width, sizeof(BYTE),

> hdmx->numGlyphs+1,fp); (2)

> }

> }

>

>

> /\*\*\* function ttfLoadHDMX end \*\*\*/

>

>

> At above code (1) ,allocte heap buffer for Width according to the

> parsed hdmx width. And at above code (2) , copy Width content from file and

> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size

> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.

>

> /\*\*\* debug info \*\*\*/

> (gdb) p hdmx->numGlyphs+1

> $23 = 4155

> (gdb) p hdmx->size

> $24 = 1216

> /\*\*\* debug info end \*\*\*/

>

>

> From :

>

> Dongzhuo zhao working with ADLab of Venustech

>

> To manage notifications about this bug go to:

>

> [https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912/+subscriptions](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Bsubscriptions)

>

>

I haven't notified them and I will try. Thanks for your replying😀
Marc Deslauriers <2047912@bugs.launchpad.net> 于2024年1月20日周六 03:56写道：
> Thanks for reporting this issue. Have you notified the texlive developer
> so that they can work on a fix? If not, please file a bug with them.
> Once they have developed a fix, we can include it in Ubuntu. Thanks!
>
> --
> You received this bug notification because you are subscribed to the bug
> report.
> https://bugs.launchpad.net/bugs/2047912
>
> Title:
> There is a heap buffer overflow in texlive-bin
>
> Status in texlive-bin package in Ubuntu:
> New
>
> Bug description:
> Hello,
> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can
> install by apt-get texlive-binaries. I compile lastest texlive-source by
> clone https://github.com/TeX-Live/texlive-source/ on unbuntu for
> debugging.
> The overflow content and size are controlled by input. Exploiting
> this issue can achive any code excuted
>
> The steps for reproducing the vul on unbuntu:
> (1) sudo apt-get iunstall texlive-binaries
> (2) ttfdump -i poc.ttf
>
>
> The poc.ttf can view the attachment .ttfdump aborted and prompt
> "malloc(): corrupted top size" due memory corrupt.
>
> The issue exist in function ttfLoadHDMX :
>
> /\*\*\* function ttfLoadHDMX begin \*\*\*/
>
> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)
> {
> int i;
>
> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");
>
> hdmx->version = ttfGetUSHORT(fp);
> hdmx->numDevices = ttfGetUSHORT(fp);
> hdmx->size = ttfGetLONG(fp);
>
> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);
>
> for (i=0;i<hdmx->numDevices;i++)
> {
> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);
> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);
> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)
> fread ((hdmx->Records+i)->Width, sizeof(BYTE),
> hdmx->numGlyphs+1,fp); (2)
> }
> }
>
>
> /\*\*\* function ttfLoadHDMX end \*\*\*/
>
>
> At above code (1) ,allocte heap buffer for Width according to the
> parsed hdmx width. And at above code (2) , copy Width content from file and
> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size
> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.
>
> /\*\*\* debug info \*\*\*/
> (gdb) p hdmx->numGlyphs+1
> $23 = 4155
> (gdb) p hdmx->size
> $24 = 1216
> /\*\*\* debug info end \*\*\*/
>
>
> From :
>
> Dongzhuo zhao working with ADLab of Venustech
>
> To manage notifications about this bug go to:
>
> https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912/+subscriptions
>
>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Eduardo Barretto (ebarretto)](https://launchpad.net/~ebarretto) wrote on 2024-02-01: |  |  | [#4](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/4) |
| --- | --- | --- | --- |

Hi DongzhuoZhao,

Did you get any feedback from texlive developers?

Could you also add here the link to your bug report, if there's one.

Thanks

Hi DongzhuoZhao,
Did you get any feedback from texlive developers?
Could you also add here the link to your bug report, if there's one.
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [DongzhuoZhao (dongzhuo)](https://launchpad.net/~dongzhuo) wrote on 2024-02-02: |  |  | [#5](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/5) |
| --- | --- | --- | --- |

Hello!

The texlive developer have fixed the bug ! Please referer following links:

<https://tug.org/svn/texlive/trunk/Build/source/texk/ttfdump/ChangeLog?revision=69605&view=co>

<https://github.com/TeX-Live/texlive-source/pull/63>

Eduardo Barretto <email address hidden> 于2024年2月1日周四 21:02写道：

> Hi DongzhuoZhao,

>

> Did you get any feedback from texlive developers?

> Could you also add here the link to your bug report, if there's one.

>

> Thanks

>

> --

> You received this bug notification because you are subscribed to the bug

> report.

> <https://bugs.launchpad.net/bugs/2047912>

>

> Title:

> There is a heap buffer overflow in texlive-bin

>

> Status in texlive-bin package in Ubuntu:

> New

>

> Bug description:

> Hello,

> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can

> install by apt-get texlive-binaries. I compile lastest texlive-source by

> clone <https://github.com/TeX-Live/texlive-source/> on unbuntu for

> debugging.

> The overflow content and size are controlled by input. Exploiting

> this issue can achive any code excuted

>

> The steps for reproducing the vul on unbuntu:

> (1) sudo apt-get iunstall texlive-binaries

> (2) ttfdump -i poc.ttf

>

>

> The poc.ttf can view the attachment .ttfdump aborted and prompt

> "malloc(): corrupted top size" due memory corrupt.

>

> The issue exist in function ttfLoadHDMX :

>

> /\*\*\* function ttfLoadHDMX begin \*\*\*/

>

> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)

> {

> int i;

>

> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");

>

> hdmx->version = ttfGetUSHORT(fp);

> hdmx->numDevices = ttfGetUSHORT(fp);

> hdmx->size = ttfGetLONG(fp);

>

> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);

>

> for (i=0;i<hdmx->numDevices;i++)

> {

> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);

> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);

> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)

> fread ((hdmx->Records+i)->Width, sizeof(BYTE),

> hdmx->numGlyphs+1,fp); (2)

> }

> }

>

>

> /\*\*\* function ttfLoadHDMX end \*\*\*/

>

>

> At above code (1) ,allocte heap buffer for Width according to the

> parsed hdmx width. And at above code (2) , copy Width content from file and

> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size

> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.

>

> /\*\*\* debug info \*\*\*/

> (gdb) p hdmx->numGlyphs+1

> $23 = 4155

> (gdb) p hdmx->size

> $24 = 1216

> /\*\*\* debug info end \*\*\*/

>

>

> From :

>

> Dongzhuo zhao working with ADLab of Venustech

>

> To manage notifications about this bug go to:

>

> [https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912/+subscriptions](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Bsubscriptions)

>

>

Hello!
The texlive developer have fixed the bug ! Please referer following links:
https://tug.org/svn/texlive/trunk/Build/source/texk/ttfdump/ChangeLog?revision=69605&view=co
https://github.com/TeX-Live/texlive-source/pull/63
Eduardo Barretto <2047912@bugs.launchpad.net> 于2024年2月1日周四 21:02写道：
> Hi DongzhuoZhao,
>
> Did you get any feedback from texlive developers?
> Could you also add here the link to your bug report, if there's one.
>
> Thanks
>
> --
> You received this bug notification because you are subscribed to the bug
> report.
> https://bugs.launchpad.net/bugs/2047912
>
> Title:
> There is a heap buffer overflow in texlive-bin
>
> Status in texlive-bin package in Ubuntu:
> New
>
> Bug description:
> Hello,
> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can
> install by apt-get texlive-binaries. I compile lastest texlive-source by
> clone https://github.com/TeX-Live/texlive-source/ on unbuntu for
> debugging.
> The overflow content and size are controlled by input. Exploiting
> this issue can achive any code excuted
>
> The steps for reproducing the vul on unbuntu:
> (1) sudo apt-get iunstall texlive-binaries
> (2) ttfdump -i poc.ttf
>
>
> The poc.ttf can view the attachment .ttfdump aborted and prompt
> "malloc(): corrupted top size" due memory corrupt.
>
> The issue exist in function ttfLoadHDMX :
>
> /\*\*\* function ttfLoadHDMX begin \*\*\*/
>
> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)
> {
> int i;
>
> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");
>
> hdmx->version = ttfGetUSHORT(fp);
> hdmx->numDevices = ttfGetUSHORT(fp);
> hdmx->size = ttfGetLONG(fp);
>
> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);
>
> for (i=0;i<hdmx->numDevices;i++)
> {
> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);
> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);
> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)
> fread ((hdmx->Records+i)->Width, sizeof(BYTE),
> hdmx->numGlyphs+1,fp); (2)
> }
> }
>
>
> /\*\*\* function ttfLoadHDMX end \*\*\*/
>
>
> At above code (1) ,allocte heap buffer for Width according to the
> parsed hdmx width. And at above code (2) , copy Width content from file and
> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size
> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.
>
> /\*\*\* debug info \*\*\*/
> (gdb) p hdmx->numGlyphs+1
> $23 = 4155
> (gdb) p hdmx->size
> $24 = 1216
> /\*\*\* debug info end \*\*\*/
>
>
> From :
>
> Dongzhuo zhao working with ADLab of Venustech
>
> To manage notifications about this bug go to:
>
> https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912/+subscriptions
>
>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Eduardo Barretto (ebarretto)](https://launchpad.net/~ebarretto) wrote on 2024-02-02: |  |  | [#6](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/6) |
| --- | --- | --- | --- |

Thanks for sharing the links!

Was this issue assigned a CVE?

Thanks for sharing the links!
Was this issue assigned a CVE?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [DongzhuoZhao (dongzhuo)](https://launchpad.net/~dongzhuo) wrote on 2024-02-02: |  |  | [#7](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/7) |
| --- | --- | --- | --- |

Hello!

This didn't have assigned a CVE Number. May I please you apply a CVE number

for this ?

Thank you!

Eduardo Barretto <email address hidden> 于2024年2月2日周五 16:26写道：

> Thanks for sharing the links!

> Was this issue assigned a CVE?

>

> --

> You received this bug notification because you are subscribed to the bug

> report.

> <https://bugs.launchpad.net/bugs/2047912>

>

> Title:

> There is a heap buffer overflow in texlive-bin

>

> Status in texlive-bin package in Ubuntu:

> New

>

> Bug description:

> Hello,

> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can

> install by apt-get texlive-binaries. I compile lastest texlive-source by

> clone <https://github.com/TeX-Live/texlive-source/> on unbuntu for

> debugging.

> The overflow content and size are controlled by input. Exploiting

> this issue can achive any code excuted

>

> The steps for reproducing the vul on unbuntu:

> (1) sudo apt-get iunstall texlive-binaries

> (2) ttfdump -i poc.ttf

>

>

> The poc.ttf can view the attachment .ttfdump aborted and prompt

> "malloc(): corrupted top size" due memory corrupt.

>

> The issue exist in function ttfLoadHDMX :

>

> /\*\*\* function ttfLoadHDMX begin \*\*\*/

>

> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)

> {

> int i;

>

> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");

>

> hdmx->version = ttfGetUSHORT(fp);

> hdmx->numDevices = ttfGetUSHORT(fp);

> hdmx->size = ttfGetLONG(fp);

>

> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);

>

> for (i=0;i<hdmx->numDevices;i++)

> {

> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);

> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);

> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)

> fread ((hdmx->Records+i)->Width, sizeof(BYTE),

> hdmx->numGlyphs+1,fp); (2)

> }

> }

>

>

> /\*\*\* function ttfLoadHDMX end \*\*\*/

>

>

> At above code (1) ,allocte heap buffer for Width according to the

> parsed hdmx width. And at above code (2) , copy Width content from file and

> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size

> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.

>

> /\*\*\* debug info \*\*\*/

> (gdb) p hdmx->numGlyphs+1

> $23 = 4155

> (gdb) p hdmx->size

> $24 = 1216

> /\*\*\* debug info end \*\*\*/

>

>

> From :

>

> Dongzhuo zhao working with ADLab of Venustech

>

> To manage notifications about this bug go to:

>

> [https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912/+subscriptions](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Bsubscriptions)

>

>

Hello!
This didn't have assigned a CVE Number. May I please you apply a CVE number
for this ?
Thank you!
Eduardo Barretto <2047912@bugs.launchpad.net> 于2024年2月2日周五 16:26写道：
> Thanks for sharing the links!
> Was this issue assigned a CVE?
>
> --
> You received this bug notification because you are subscribed to the bug
> report.
> https://bugs.launchpad.net/bugs/2047912
>
> Title:
> There is a heap buffer overflow in texlive-bin
>
> Status in texlive-bin package in Ubuntu:
> New
>
> Bug description:
> Hello,
> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can
> install by apt-get texlive-binaries. I compile lastest texlive-source by
> clone https://github.com/TeX-Live/texlive-source/ on unbuntu for
> debugging.
> The overflow content and size are controlled by input. Exploiting
> this issue can achive any code excuted
>
> The steps for reproducing the vul on unbuntu:
> (1) sudo apt-get iunstall texlive-binaries
> (2) ttfdump -i poc.ttf
>
>
> The poc.ttf can view the attachment .ttfdump aborted and prompt
> "malloc(): corrupted top size" due memory corrupt.
>
> The issue exist in function ttfLoadHDMX :
>
> /\*\*\* function ttfLoadHDMX begin \*\*\*/
>
> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)
> {
> int i;
>
> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");
>
> hdmx->version = ttfGetUSHORT(fp);
> hdmx->numDevices = ttfGetUSHORT(fp);
> hdmx->size = ttfGetLONG(fp);
>
> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);
>
> for (i=0;i<hdmx->numDevices;i++)
> {
> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);
> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);
> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)
> fread ((hdmx->Records+i)->Width, sizeof(BYTE),
> hdmx->numGlyphs+1,fp); (2)
> }
> }
>
>
> /\*\*\* function ttfLoadHDMX end \*\*\*/
>
>
> At above code (1) ,allocte heap buffer for Width according to the
> parsed hdmx width. And at above code (2) , copy Width content from file and
> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size
> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.
>
> /\*\*\* debug info \*\*\*/
> (gdb) p hdmx->numGlyphs+1
> $23 = 4155
> (gdb) p hdmx->size
> $24 = 1216
> /\*\*\* debug info end \*\*\*/
>
>
> From :
>
> Dongzhuo zhao working with ADLab of Venustech
>
> To manage notifications about this bug go to:
>
> https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912/+subscriptions
>
>

[George-Andrei Iosif (iosifache)](https://launchpad.net/~iosifache)
on 2024-02-07

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [George-Andrei Iosif (iosifache)](https://launchpad.net/~iosifache) wrote on 2024-02-07: |  |  | [#8](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/8) |
| --- | --- | --- | --- |

I have marked this bug as public because the public domain already contains information about this TeX Live issue (as seen in the GitHub issue and upstream changelog).

@dongzhuo, could you please contact the upstream (either in the existing PR or via their mailing list) to confirm that they (1) recognize this issue as a vulnerability impacting the security of their software (and not just a functional bug), and (2) do not have any other CVE ID assignment process already established? The latter is important because some projects prefer contacting MITRE for the assignment.

I have marked this bug as public because the public domain already contains information about this TeX Live issue (as seen in the GitHub issue and upstream changelog).
@dongzhuo, could you please contact the upstream (either in the existing PR or via their mailing list) to confirm that they (1) recognize this issue as a vulnerability impacting the security of their software (and not just a functional bug), and (2) do not have any other CVE ID assignment process already established? The latter is important because some projects prefer contacting MITRE for the assignment.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [DongzhuoZhao (dongzhuo)](https://launchpad.net/~dongzhuo) wrote on 2024-02-19: |  |  | [#9](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/9) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/9/%2Bdownload) (3.2 KiB)

Hello，I have reported this issue to TexLive and the maintenance team have

confirmed this issue and fixed it. they want me reuest CVE ID by myself.

And Iasrequest a CVE ID, but do not get answer for this moment. If you

could accelerate this requesting process, that would be great!

George-Andrei Iosif <email address hidden> 于2024年2月7日周三 16:29写道：

> I have marked this bug as public because the public domain already

> contains information about this TeX Live issue (as seen in the GitHub

> issue and upstream changelog).

>

> @dongzhuo, could you please contact the upstream (either in the existing

> PR or via their mailing list) to confirm that they (1) recognize this

> issue as a vulnerability impacting the security of their software (and

> not just a functional bug), and (2) do not have any other CVE ID

> assignment process already established? The latter is important because

> some projects prefer contacting MITRE for the assignment.

>

> --

> You received this bug notification because you are subscribed to the bug

> report.

> <https://bugs.launchpad.net/bugs/2047912>

>

> Title:

> There is a heap buffer overflow in texlive-bin

>

> Status in texlive-bin package in Ubuntu:

> New

>

> Bug description:

> Hello,

> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can

> install by apt-get texlive-binaries. I compile lastest texlive-source by

> clone <https://github.com/TeX-Live/texlive-source/> on unbuntu for

> debugging.

> The overflow content and size are controlled by input. Exploiting

> this issue can achive any code excuted

>

> The steps for reproducing the vul on unbuntu:

> (1) sudo apt-get iunstall texlive-binaries

> (2) ttfdump -i poc.ttf

>

>

> The poc.ttf can view the attachment .ttfdump aborted and prompt

> "malloc(): corrupted top size" due memory corrupt.

>

> The issue exist in function ttfLoadHDMX :

>

> /\*\*\* function ttfLoadHDMX begin \*\*\*/

>

> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)

> {

> int i;

>

> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");

>

> hdmx->version = ttfGetUSHORT(fp);

> hdmx->numDevices = ttfGetUSHORT(fp);

> hdmx->size = ttfGetLONG(fp);

>

> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);

>

> for (i=0;i<hdmx->numDevices;i++)

> {

> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);

> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);

> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)

> fread ((hdmx->Records+i)->Width, sizeof(BYTE),

> hdmx->numGlyphs+1,fp); (2)

> }

> }

>

>

> /\*\*\* function ttfLoadHDMX end \*\*\*/

>

>

> At above code (1) ,allocte heap buffer for Width according to the

> parsed hdmx width. And at above code (2) , copy Width content from file and

> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size

> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.

>

> /\*\*\* debug info \*\*\*/

> (gdb) p hdmx->numGlyphs+1

> $23 = 4155

> (gdb) p hdmx->size

> $24 = 1216

> /\*\*\* debug info end \*\*\*/

>

>

> From :

>

> Dongzhuo zhao working with ADLab of Venustech

>

> To manage notifi...

[Read more...](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/9)

Hello，I have reported this issue to TexLive and the maintenance team have
confirmed this issue and fixed it. they want me reuest CVE ID by myself.
And Iasrequest a CVE ID, but do not get answer for this moment. If you
could accelerate this requesting process, that would be great!
George-Andrei Iosif <2047912@bugs.launchpad.net> 于2024年2月7日周三 16:29写道：
> I have marked this bug as public because the public domain already
> contains information about this TeX Live issue (as seen in the GitHub
> issue and upstream changelog).
>
> @dongzhuo, could you please contact the upstream (either in the existing
> PR or via their mailing list) to confirm that they (1) recognize this
> issue as a vulnerability impacting the security of their software (and
> not just a functional bug), and (2) do not have any other CVE ID
> assignment process already established? The latter is important because
> some projects prefer contacting MITRE for the assignment.
>
> --
> You received this bug notification because you are subscribed to the bug
> report.
> https://bugs.launchpad.net/bugs/2047912
>
> Title:
> There is a heap buffer overflow in texlive-bin
>
> Status in texlive-bin package in Ubuntu:
> New
>
> Bug description:
> Hello,
> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can
> install by apt-get texlive-binaries. I compile lastest texlive-source by
> clone https://github.com/TeX-Live/texlive-source/ on unbuntu for
> debugging.
> The overflow content and size are controlled by input. Exploiting
> this issue can achive any code excuted
>
> The steps for reproducing the vul on unbuntu:
> (1) sudo apt-get iunstall texlive-binaries
> (2) ttfdump -i poc.ttf
>
>
> The poc.ttf can view the attachment .ttfdump aborted and prompt
> "malloc(): corrupted top size" due memory corrupt.
>
> The issue exist in function ttfLoadHDMX :
>
> /\*\*\* function ttfLoadHDMX begin \*\*\*/
>
> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)
> {
> int i;
>
> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");
>
> hdmx->version = ttfGetUSHORT(fp);
> hdmx->numDevices = ttfGetUSHORT(fp);
> hdmx->size = ttfGetLONG(fp);
>
> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);
>
> for (i=0;i<hdmx->numDevices;i++)
> {
> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);
> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);
> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)
> fread ((hdmx->Records+i)->Width, sizeof(BYTE),
> hdmx->numGlyphs+1,fp); (2)
> }
> }
>
>
> /\*\*\* function ttfLoadHDMX end \*\*\*/
>
>
> At above code (1) ,allocte heap buffer for Width according to the
> parsed hdmx width. And at above code (2) , copy Width content from file and
> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size
> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.
>
> /\*\*\* debug info \*\*\*/
> (gdb) p hdmx->numGlyphs+1
> $23 = 4155
> (gdb) p hdmx->size
> $24 = 1216
> /\*\*\* debug info end \*\*\*/
>
>
> From :
>
> Dongzhuo zhao working with ADLab of Venustech
>
> To manage notifications about this bug go to:
>
> https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912/+subscriptions
>
>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [DongzhuoZhao (dongzhuo)](https://launchpad.net/~dongzhuo) wrote on 2024-02-21: |  |  | [#10](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/10) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/10/%2Bdownload) (3.5 KiB)

Hello!

I got the CVE ID (CVE-2024-25262) for this issue.

Thanks

dongzhuo zhao <email address hidden> 于2024年2月19日周一 11:03写道：

> Hello，I have reported this issue to TexLive and the maintenance team have

> confirmed this issue and fixed it. they want me reuest CVE ID by myself.

> And Iasrequest a CVE ID, but do not get answer for this moment. If you

> could accelerate this requesting process, that would be great!

>

> George-Andrei Iosif <email address hidden> 于2024年2月7日周三 16:29写道：

>

>> I have marked this bug as public because the public domain already

>> contains information about this TeX Live issue (as seen in the GitHub

>> issue and upstream changelog).

>>

>> @dongzhuo, could you please contact the upstream (either in the existing

>> PR or via their mailing list) to confirm that they (1) recognize this

>> issue as a vulnerability impacting the security of their software (and

>> not just a functional bug), and (2) do not have any other CVE ID

>> assignment process already established? The latter is important because

>> some projects prefer contacting MITRE for the assignment.

>>

>> --

>> You received this bug notification because you are subscribed to the bug

>> report.

>> <https://bugs.launchpad.net/bugs/2047912>

>>

>> Title:

>> There is a heap buffer overflow in texlive-bin

>>

>> Status in texlive-bin package in Ubuntu:

>> New

>>

>> Bug description:

>> Hello,

>> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can

>> install by apt-get texlive-binaries. I compile lastest texlive-source by

>> clone <https://github.com/TeX-Live/texlive-source/> on unbuntu for

>> debugging.

>> The overflow content and size are controlled by input. Exploiting

>> this issue can achive any code excuted

>>

>> The steps for reproducing the vul on unbuntu:

>> (1) sudo apt-get iunstall texlive-binaries

>> (2) ttfdump -i poc.ttf

>>

>>

>> The poc.ttf can view the attachment .ttfdump aborted and prompt

>> "malloc(): corrupted top size" due memory corrupt.

>>

>> The issue exist in function ttfLoadHDMX :

>>

>> /\*\*\* function ttfLoadHDMX begin \*\*\*/

>>

>> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)

>> {

>> int i;

>>

>> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");

>>

>> hdmx->version = ttfGetUSHORT(fp);

>> hdmx->numDevices = ttfGetUSHORT(fp);

>> hdmx->size = ttfGetLONG(fp);

>>

>> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);

>>

>> for (i=0;i<hdmx->numDevices;i++)

>> {

>> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);

>> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);

>> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)

>> fread ((hdmx->Records+i)->Width, sizeof(BYTE),

>> hdmx->numGlyphs+1,fp); (2)

>> }

>> }

>>

>>

>> /\*\*\* function ttfLoadHDMX end \*\*\*/

>>

>>

>> At above code (1) ,allocte heap buffer for Width according to the

>> parsed hdmx width. And at above code (2) , copy Width content from file and

>> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size

>> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.

>>

>> ...

[Read more...](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/10)

Hello!
I got the CVE ID (CVE-2024-25262) for this issue.
Thanks
dongzhuo zhao <dongzhuozhaosec123@gmail.com> 于2024年2月19日周一 11:03写道：
> Hello，I have reported this issue to TexLive and the maintenance team have
> confirmed this issue and fixed it. they want me reuest CVE ID by myself.
> And Iasrequest a CVE ID, but do not get answer for this moment. If you
> could accelerate this requesting process, that would be great!
>
> George-Andrei Iosif <2047912@bugs.launchpad.net> 于2024年2月7日周三 16:29写道：
>
>> I have marked this bug as public because the public domain already
>> contains information about this TeX Live issue (as seen in the GitHub
>> issue and upstream changelog).
>>
>> @dongzhuo, could you please contact the upstream (either in the existing
>> PR or via their mailing list) to confirm that they (1) recognize this
>> issue as a vulnerability impacting the security of their software (and
>> not just a functional bug), and (2) do not have any other CVE ID
>> assignment process already established? The latter is important because
>> some projects prefer contacting MITRE for the assignment.
>>
>> --
>> You received this bug notification because you are subscribed to the bug
>> report.
>> https://bugs.launchpad.net/bugs/2047912
>>
>> Title:
>> There is a heap buffer overflow in texlive-bin
>>
>> Status in texlive-bin package in Ubuntu:
>> New
>>
>> Bug description:
>> Hello,
>> I found a heap-buffer overflow in function ttfLoadHDMX; ttfdump can
>> install by apt-get texlive-binaries. I compile lastest texlive-source by
>> clone https://github.com/TeX-Live/texlive-source/ on unbuntu for
>> debugging.
>> The overflow content and size are controlled by input. Exploiting
>> this issue can achive any code excuted
>>
>> The steps for reproducing the vul on unbuntu:
>> (1) sudo apt-get iunstall texlive-binaries
>> (2) ttfdump -i poc.ttf
>>
>>
>> The poc.ttf can view the attachment .ttfdump aborted and prompt
>> "malloc(): corrupted top size" due memory corrupt.
>>
>> The issue exist in function ttfLoadHDMX :
>>
>> /\*\*\* function ttfLoadHDMX begin \*\*\*/
>>
>> static void ttfLoadHDMX (FILE \*fp,HDMXPtr hdmx,ULONG offset)
>> {
>> int i;
>>
>> xfseek(fp, offset, SEEK\_SET, "ttfLoadHDMX");
>>
>> hdmx->version = ttfGetUSHORT(fp);
>> hdmx->numDevices = ttfGetUSHORT(fp);
>> hdmx->size = ttfGetLONG(fp);
>>
>> hdmx->Records = XCALLOC (hdmx->numDevices, DeviceRecord);
>>
>> for (i=0;i<hdmx->numDevices;i++)
>> {
>> hdmx->Records[i].PixelSize = ttfGetBYTE(fp);
>> hdmx->Records[i].MaxWidth = ttfGetBYTE(fp);
>> hdmx->Records[i].Width = XCALLOC (hdmx->size, BYTE); (1)
>> fread ((hdmx->Records+i)->Width, sizeof(BYTE),
>> hdmx->numGlyphs+1,fp); (2)
>> }
>> }
>>
>>
>> /\*\*\* function ttfLoadHDMX end \*\*\*/
>>
>>
>> At above code (1) ,allocte heap buffer for Width according to the
>> parsed hdmx width. And at above code (2) , copy Width content from file and
>> copy size decided by controlled hdmx->numGlyphs. In the poc , hdmx->size
>> eaqual to 1216 and hdmx->numGlyphs+1 is 4155,which get heap buffer overflow.
>>
>> /\*\*\* debug info \*\*\*/
>> (gdb) p hdmx->numGlyphs+1
>> $23 = 4155
>> (gdb) p hdmx->size
>> $24 = 1216
>> /\*\*\* debug info end \*\*\*/
>>
>>
>> From :
>>
>> Dongzhuo zhao working with ADLab of Venustech
>>
>> To manage notifications about this bug go to:
>>
>> https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912/+subscriptions
>>
>>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2024-03-14: |  |  | [#11](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/11) |
| --- | --- | --- | --- |

This bug was fixed in the package texlive-bin - 2023.20230311.66589-6ubuntu0.1

---------------

texlive-bin (2023.20230311.66589-6ubuntu0.1) mantic-security; urgency=medium

\* SECURITY UPDATE: heap overflow in ttfdump (LP: [#2047912](/bugs/2047912))

    - debian/patches/CVE-2024-25262.diff: add overflow check to

      texk/ttfdump/libttf/hdmx.c.

    - CVE-2024-25262

-- Marc Deslauriers <email address hidden> Wed, 13 Mar 2024 10:05:52 -0400

This bug was fixed in the package texlive-bin - 2023.20230311.66589-6ubuntu0.1
---------------
texlive-bin (2023.20230311.66589-6ubuntu0.1) mantic-security; urgency=medium
\* SECURITY UPDATE: heap overflow in ttfdump (LP: #2047912)
- debian/patches/CVE-2024-25262.diff: add overflow check to
texk/ttfdump/libttf/hdmx.c.
- CVE-2024-25262
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Wed, 13 Mar 2024 10:05:52 -0400

| Changed in texlive-bin (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2024-03-14: |  |  | [#12](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/12) |
| --- | --- | --- | --- |

This bug was fixed in the package texlive-bin - 2021.20210626.59705-1ubuntu0.2

---------------

texlive-bin (2021.20210626.59705-1ubuntu0.2) jammy-security; urgency=medium

\* SECURITY UPDATE: arbitrary network requests via socket library

    - debian/patches/CVE-2023-32668.patch: disable socket library by

      default in texk/web2c/luatexdir/lua/loslibext.c,

      texk/web2c/luatexdir/lua/luainit.c,

      texk/web2c/luatexdir/lua/luastuff.c,

      texk/web2c/luatexdir/lua/luatex-api.h,

      texk/web2c/luatexdir/luasocket/src/lua\_preload.c.

    - CVE-2023-32668

  \* SECURITY UPDATE: heap overflow in ttfdump (LP: [#2047912](/bugs/2047912))

    - debian/patches/CVE-2024-25262.diff: add overflow check to

      texk/ttfdump/libttf/hdmx.c.

    - CVE-2024-25262

-- Marc Deslauriers <email address hidden> Wed, 13 Mar 2024 10:11:46 -0400

This bug was fixed in the package texlive-bin - 2021.20210626.59705-1ubuntu0.2
---------------
texlive-bin (2021.20210626.59705-1ubuntu0.2) jammy-security; urgency=medium
\* SECURITY UPDATE: arbitrary network requests via socket library
- debian/patches/CVE-2023-32668.patch: disable socket library by
default in texk/web2c/luatexdir/lua/loslibext.c,
texk/web2c/luatexdir/lua/luainit.c,
texk/web2c/luatexdir/lua/luastuff.c,
texk/web2c/luatexdir/lua/luatex-api.h,
texk/web2c/luatexdir/luasocket/src/lua\_preload.c.
- CVE-2023-32668
\* SECURITY UPDATE: heap overflow in ttfdump (LP: #2047912)
- debian/patches/CVE-2024-25262.diff: add overflow check to
texk/ttfdump/libttf/hdmx.c.
- CVE-2024-25262
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Wed, 13 Mar 2024 10:11:46 -0400

| Changed in texlive-bin (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2024-03-14: |  |  | [#13](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/comments/13) |
| --- | --- | --- | --- |

This bug was fixed in the package texlive-bin - 2019.20190605.51237-3ubuntu0.2

---------------

texlive-bin (2019.20190605.51237-3ubuntu0.2) focal-security; urgency=medium

\* SECURITY UPDATE: sprintf mishandling in axohelp

    - debian/patches/CVE-2019-18604.patch: fix overflow bugs in

      utils/axodraw2/\*.

    - CVE-2019-18604

  \* SECURITY UPDATE: arbitrary network requests via socket library

    - debian/patches/CVE-2023-32668.patch: disable socket library by

      default in texk/web2c/luatexdir/lua/loslibext.c,

      texk/web2c/luatexdir/lua/luainit.c,

      texk/web2c/luatexdir/lua/luastuff.c,

      texk/web2c/luatexdir/lua/luatex-api.h,

      texk/web2c/luatexdir/luasocket/src/lua\_preload.c.

    - CVE-2023-32668

  \* SECURITY UPDATE: heap overflow in ttfdump (LP: [#2047912](/bugs/2047912))

    - debian/patches/CVE-2024-25262.diff: add overflow check to

      texk/ttfdump/libttf/hdmx.c.

    - CVE-2024-25262

-- Marc Deslauriers <email address hidden> Wed, 13 Mar 2024 10:19:47 -0400

This bug was fixed in the package texlive-bin - 2019.20190605.51237-3ubuntu0.2
---------------
texlive-bin (2019.20190605.51237-3ubuntu0.2) focal-security; urgency=medium
\* SECURITY UPDATE: sprintf mishandling in axohelp
- debian/patches/CVE-2019-18604.patch: fix overflow bugs in
utils/axodraw2/\*.
- CVE-2019-18604
\* SECURITY UPDATE: arbitrary network requests via socket library
- debian/patches/CVE-2023-32668.patch: disable socket library by
default in texk/web2c/luatexdir/lua/loslibext.c,
texk/web2c/luatexdir/lua/luainit.c,
texk/web2c/luatexdir/lua/luastuff.c,
texk/web2c/luatexdir/lua/luatex-api.h,
texk/web2c/luatexdir/luasocket/src/lua\_preload.c.
- CVE-2023-32668
\* SECURITY UPDATE: heap overflow in ttfdump (LP: #2047912)
- debian/patches/CVE-2024-25262.diff: add overflow check to
texk/ttfdump/libttf/hdmx.c.
- CVE-2024-25262
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Wed, 13 Mar 2024 10:19:47 -0400

| Changed in texlive-bin (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/texlive-bin/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [used for triggering vul](https://bugs.launchpad.net/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Battachment/5735842/%2Bfiles/poc.ttf)
  [Edit](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Battachment/5735842 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/texlive-bin/%2Bbug/2047912/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from tug.org_f75e866e_20250111_072353.html ===
2024-01-21 Karl Berry
\* libttf/hdmx.c (ttfLoadHDMX): calloc the number of widths that we
actually read, namely numGlyphs+1. I don't understand why this
is numGlyphs+1 and not numGlyphs, per
https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6hdmx.html
but since the program has always read numGlyphs+1, just leaving it.
Report from Dongzhuozhao, working with ADlab of Venustech,
https://bugs.launchpad.net/ubuntu/+source/texlive-bin/+bug/2047912
and also reported (with alternate fix) from attackoncs,
https://github.com/TeX-Live/texlive-source/pull/63.
2023-08-13 TANAKA Takuji
\* tests/ttfdump.test: Make easier to test on Windows.
2021-02-06 TANAKA Takuji
\* src/ttfdump.c, configure.ac:
Show TeX Live version number and bug report address in usage.
2019-02-26 Hironobu Yamashita
\* src/ttfdump.c: Forbid too long file name.
2017-06-24 Akira Kakuto
\* src/ttfdump.c: allow a suffix .TTC for ttc fonts.
2017-06-23 Hironobu Yamashita
\* src/ttfdump.c: avoid segmentation fault when the requested
ttc font is not found.
2016-07-15 Adrian Johnson
\* libttf/cmap.c,
\* libttf/name.c,
\* libttf/post.c: check for null before dereferencing in case
of missing cmap/name/post tables.
tex-live mail of 9 Jul 2016 18:17:16.
2015-07-07 Peter Breitenlohner
\* Makefile.am: Better dependencies for 'make check'.
2015-03-17 Peter Breitenlohner
\* include/ttc.h, libttf/ttc.c: Avoid segfault (NULL filename).
\* tests/ttfdump.gasp, tests/ttfdump.maxp: Adapt.
2015-02-27 Peter Breitenlohner
\* ac/withenable.ac: Require kpathsea.
2015-02-24 Peter Breitenlohner
\* tests/ttfdump.test: Add a TrueType Collection test.
\* tests/test.ttc (new): Additional test input.
\* tests/ttfdump.gasp, tests/ttfdump.maxp (new): Expected output.
\* Makefile.am: Adapted.
2014-12-10 Peter Breitenlohner
\* libttf/pclt.c: Repalce "%02hx" => "%02x" for unsigned char.
2014-06-16 Peter Breitenlohner
\* Makefile.am: Drop the obsolete ACLOCAL\_AMFLAGS.
2013-06-30 Peter Breitenlohner
\* Include  first in all C files and never in headers.
2013-04-03 Akira Kakuto
\* src/ttfdump.c [KPATHSEA]: Recover #include
for WIN32 to avoid compiling error.
2013-04-03 Karl Berry
\* src/ttfdump.c [KPATHSEA]: #include  rather than
. Otherwise optarg is NULL on 32-bit MacOSX
and thus all options-with-arguments fail. Report and patch from
Dick Koch.
2013-02-01 Peter Breitenlohner
\* libttf/os2.c: Index checking for string array elements.
\* tests/ttfdump.test: Add a test case for invalid array indices.
\* tests/bad.otf (new): Additional test input.
\* tests/ttfdump.bad (new): Expected output.
\* Makefile.am: Adapted.
2013-01-31 Akihiro Sagawa
\* include/os2\_P.h: Added missing commas to fix an ancient bug.
2012-11-19 Peter Breitenlohner
\* Makefile.am: Avoid use of deprecated INCLUDES.
2012-09-09 Peter Breitenlohner
\* include/tables.h, libttf/os2.c: Handle fields present only in
versions 1 and 2 of OS/2 table.
\* tests/ttfdump.test: Add a test case for OS/2 table.
\* tests/texmfhome.otf (new): Test input.
\* tests/ttfdump.os\_2 (new): Expected output.
\* Makefile.am: Adapted.
2012-09-07 Peter Breitenlohner
\* include/protos.h: Move prototypes for functions in
libttf/stack.c from here ...
\* include/stack.h: ... to this new (and unused) file.
\* Makefile.am (EXTRA\_DIST): Add the new file.
2012-07-14 Peter Breitenlohner
\* Makefile.am, configure.ac, include/ttf.h, include/ttfutil.h,
libttf/font.c, libttf/ttc.c, libttf/ttfutil.c, src/ttfdump.c:
Use libkpathsea instead of copying xmalloc() & Co (from W32TeX).
\* tests/ttfdump.test [WIN32]: Also test binary mode for stdout.
2012-03-13 Peter Breitenlohner
\* include/ttfutil.h: Declare ttfError() with attribute noreturn.
2011-12-01 Peter Breitenlohner
\* libttf/otfcommon.c: Improved output strings.
\* include/gpos.h, libttf/gpos.c: Support ValueRecords with
device parts (ppem dependent fine tuning).
2011-12-01 Peter Breitenlohner
\* include/gpos.h (new): GPOS table format.
\* include/gsub.h (new): GSUB table format.
\* include/otftables.h (new): OpenType common table formats.
\* libttf/gpos.c (new): Load, print, and free GPOS table.
\* libttf/gsub.c (new): Load, print, and free GSUB table.
\* libttf/otfcommon.c (new): Handle common table formats.
\* include/loadtable.h, include/tables.h, include/ttf.h,
libttf/font.c, src/ttfdump.c: Add GPOS and GSUB tables.
\* Makefile.am (libttf\_a\_SOURCES): Add the new files.
\* docs/ttfdump.1: Mention GPOS and GSUB tables.
\* tests/ttfdump.test: Add tests for GPOS and GSUB tables.
\* tests/ttfdump.{gpos,gsub} (new): Expected output.
\* Makefile.am: Adapted.
2011-11-21 Peter Breitenlohner
Additional 'cmap' SubTable Formats.
\* include/tables.h: Declare data structures for 'cmap' SubTable
Formats 8, 10, 12, 13, and 14.
\* libttf/cmap.c: Separate Encoding Records from SubTables;
several Encodings may refer to the same SubTable.
Add support for SubTable Formats 8, 10, 12, 13, and 14.
FIXME: Format 14 is not yet implemented.
\* include/loadtable.h, include/ttf.h, libttf/glyf.c: Adapted.
2011-11-10 Peter Breitenlohner
\* include/tables.h, libttf/head.c: Print created and modified.
\* libttf/font.c: Index to location ('loca') table is optional.
\* libttf/loca.c: Avoid segfault for missing 'loca' table.
\* src/ttfdump.c: Avoid segfault for missing 'loca' table (do not
try to print glyphs). Print sfnt version.
\* tests/ttfdump.test: Perform all sub-tests and report failed ones.
2011-11-08 Peter Breitenlohner
Major update.
\* include/\*, libttf/\*, src/ttfdump.c: Drop  and vcid.
Copy or adapt xfseek(), xmalloc(), xcalloc(), and xstrdup() from
kpathsea. Add functions to allocate and/or read arrays.
Add FT\_MAKE\_TAG macro as used in freetype2. Drop unused funcs().
Require sizeof(int)==4. Fix various typos.
\* configure.ac: Drop AC\_C\_BIGENDIAN, AC\_CHECK\_SIZEOF([long]),
and AC\_CHECK\_SIZEOF([long long]).
\* Makefile.am: Adapt.
\* docs/ttfdump.1: Fix typos.
2011-05-12 Peter Breitenlohner
\* tests/ttfdump.test: Use 'diff -b' for Dos line endings.
2011-05-04 Peter Breitenlohner
docs/ttfdump.1, tests/ttfdump.test: Assume a posixly correct
getopt() without non-options followed by options.
2011-04-25 Peter Breitenlohner
\* tests/ttfdump.test (new): Shell script for a test case.
\* tests/FonetikaDaniaIwonaeRegular.ttf (new): Test input.
\* tests/ttfdump.{glyf,head} (new): Expected output.
\* Makefile.am: Adapted.
2011-04-25 Peter Breitenlohner
\* libttf/tabledir.c: Fix typo "chechsum" -> "checksum".
2010-12-08 Peter Breitenlohner
\* configure.ac: Remove duplicate checks (done by KPSE\_COMMON).
2010-02-20 Peter Breitenlohner
\* libttf/tabledir.c (ttfPrintTableDir): Use memcpy, not bcopy.
\* src/ttfdump.c [WIN32]: Replace #include
by #include .
2009-10-30 Peter Breitenlohner
\* Makefile.am, configure.ac, ac/withenable.ac: Remove dependency
on kpathsea.
2009-08-23 Peter Breitenlohner
Avoid maximal compiler warnings.
\* include/os2\_P.h: Constify all global string arrays.
\* include/ttfutil.h, src/ttfutil.c: Constify param of ttfError().
2009-07-17 Peter Breitenlohner
\* cmap.c (ttfPrintCMAP4) cast USHORT/sizeof() to int for printing.
\* cvt.c (ttfPrintCVT): cast USHORT\*sizeof() to int for printing.
2009-06-18 Peter Breitenlohner
\* Makefile.am (AM\_CFLAGS): enable compiler warnings.
\* libttf/font.c (ttfCloneFont): not used.
\* libttf/gcache.c (ttfInitCacheData): avoid ambiguous "cur = cur++".
(merge): only used #ifdef MERGEDELETE.
\* libttf/stack.c (GetLONG): unused.
\* libttf/tabledir.c (ttfCalcTableCheckSum): unused.
\* src/ttfdump.c (dialog, add\_suffix): unused.
(Strdup): declare as static.
(main): silence 'used uninitialized' warning.
avoid unused variables.
2009-06-03 Karl Berry
\* libttf/ttfread.c (ttfGetBYTE): do not make inline, just in case.
\* include/ttf.h (ttfGetBYTE): replace [non-inline] definition
here with declaration, referring to the definition in
libttf/ttfread.c. Report from vvv, tlbuild 02 Jun 2009 23:48:52.
2009-05-27 Peter Breitenlohner
Adapt to TL2009 build system.
2008-01-31 Peter Breitenlohner
Convert from autoconf-2.13 to autoconf-2.59+:
\* Makefile.in, libttf/Makefile.in, src/Makefile.in: Add
@configure\_input@ lines.
\* configure.in: Autoupdated.
\* configure: Regenerated (autoconf).
Mon Jul 6 06:07:01 1998 Werner Lemberg
\* include/gcache.h,
include/gstate.h,
include/loadtable.h,
include/os2\_P.h,
include/tables.h,
include/ttc.h,
include/ttf.h,
include/ttfutil.h,
libttf/os2.c,
src/Attic/action.c,
src/Attic/mkttfdir.c,
src/Attic/rasben.c:
action.c, mkttfdir.c, rasben.c are empty.
Correcting spelling errors, formatting.
Sat Jul 4 13:17:52 1998 Werner Lemberg
\* src/ttfdump.c,
Makefile.in,
include/ttc.h,
include/ttf.h,
libttf/Makefile.in,
libttf/tabledir.c,
libttf/ttfread.c,
src/Makefile.in:
Diffs from Nelson Beebe:
new target `check' for Makefile, `install' improved
#include  in ttf.h
ttfread.c: workaround for egcs bug
ttfdump.c: `int main' instead of `void main'
use of EXIT\_SUCCESS and EXIT\_FAILURE
added Strdup() since strdup() doesn't exist everywhere
formatting of ttfdump.c
Sat Jun 6 12:55:53 1998 Werner Lemberg
\* libttf/post.c: Oops! Not 26.6 but 16.16 format. Added comment.
\* libttf/post.c: fixed overflow bugs and a wrong 26.6 number.
Sat Jan 4 19:23:56 1997
\* libttf/cmap.c (ttfLoadCMAP6): Fixed a fatal bug cause segment fault
\* src/ttfdump.c (main): add TrueType collection support
Fri Nov 29 15:34:29 1996
\* ttfdump :
Unrecoverable disaster had happened. The old developing version was
destroyed during Red Hat Linux upgrading (it is my fault :~~(. ).
Resume to the public releease version.
Tue Sep 24 21:47:05 1996 Li-Da Lho
\* font.c (ttfInitFont): The final layer of abstraction is complete.
Application programs only need to do the fellowing things to use
True Type Font:
1. Load the font by calling ttfInitFont(char \*font\_filename)
2. choose a encoding scheme.
3. load the glyf by ttfLoadGlyphIndex or ttfLoadglyphCode
4. do anythings the application wants about the outline data
(i.e. rendering ,showing).
4. after all this, release the font by ttfFreeFont(TTFontPtr font).
\* gcache.c: The implementation of glyph cache is completed. Start to
add the final layer of TTFont abstraction.
\* glyf.c: It has been proved that av\*.ttf is created by brain damaged
programmers. Lots of LOCA entries point to End Of File.
Benchmark: All Glyf data are loaded but not printed.
time ttfdump times.ttf >/dev/null
0.080u 0.000s 0:00.19 42.1% 0+0k 0+0io 91pf+0w
time ttfdump /mnt/dos/windows/fonts/dftt-fs.ttf > /dev/null
2.410u 0.560s 0:03.53 84.1% 0+0k 0+0io 70pf+0w
time ttfdump /mnt/dos/windows/fonts/dftt-sk5.ttf > /dev/null
2.850u 0.550s 0:03.95 86.0% 0+0k 0+0io 70pf+0w
time ttfdump /mnt/dos/windows/fonts/kai.ttf > /dev/null
1.920u 0.530s 0:02.85 85.9% 0+0k 0+0io 70pf+0w
time ttfdump /mnt/dos/windows/fonts/Dflihm.ttf > /dev/null
2.850u 0.460s 0:03.87 85.5% 0+0k 0+0io 70pf+0w
Thu Aug 1 21:11:36 1996 Li-Da Lho
\* glyf.c: composite glyph added but not completed yet,does not works
on av\*.ttf any more but fine for others (is it a bug in av\*.ttf or
my fault ??)
\* glyf.c (ttfLoadGlyphIndex): removed the offset parameter
and add the glyphOffset entry in TTFont structure,which contain
the address of the start of glyf table, almost the same speed.
Tue Jul 30 08:37:59 1996 Li-Da Lho
\* post.c : created
add postscript information,format 2.0 ,2.5 not implemented yet
\* Release Version 0.4:
Almost all required tables in True Type Font Specitication are
implemented, except "post", "OS/2" and format 2,4,6 of "cmap".
Composite glyph and instruction disassembler are not supported yet.
Works fine on times.ttf,dftt-fs.ttf, unexpected EOF on avbbv.ttf,
avov.ttf. (possible wrong ttf file)
There are still some possible memory leak, clean then up when
freezing stage.
Benchmark:
time ttfdump times.ttf > /dev/null
0.680u 0.020s 0:00.80 87.5% 0+0k 0+0io 94pf+0w
time ttfdump /mnt/dos/ttf/avov.ttf > /dev/null
276.210u 1.710s 4:50.43 95.6% 0+0k 0+0io 73pf+0w
time ttfdump /mnt/dos/windows/fonts/dftt-fs.ttf > /dev/null
27.440u 0.700s 0:29.49 95.4% 0+0k 0+0io 73pf+0w
time ttfdump /mnt/dos/windows/fonts/dflihm.ttf > /dev/null
105.400u 0.830s 1:49.17 97.3% 0+0k 0+0io 73pf+0w

