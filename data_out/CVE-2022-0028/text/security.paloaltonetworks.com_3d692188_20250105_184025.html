

* [Get support](https://support.paloaltonetworks.com/support)
* [Security advisories](/)
* [Report vulnerabilities](/report)
* [Subscribe](https://support.paloaltonetworks.com/SupportAccount/Preferences)
* [RSS feed](/rss.xml)
[Palo Alto Networks Security Advisories](/) /
CVE-2022-0028
## CVE-2022-0028 PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering

047910
[Severity
8.6 ·
HIGH](https://cvssjs.github.io/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H "CVSS-B: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H")Attack Vector
**NETWORK**Scope
**CHANGED**Attack Complexity
**LOW**Confidentiality Impact
**NONE**Privileges Required
**NONE**Integrity Impact
**NONE**User Interaction
**NONE**Availability Impact
**HIGH**[CVE](https://www.cve.org/CVERecord?id=CVE-2022-0028 "See CVE.org record")
[JSON](/json/CVE-2022-0028 "Download the information in this advisory in CVE-JSON format")
[CSAF](/csaf/CVE-2022-0028 "Download the information in this advisory in CSAF format")

 Published
**2022-08-10** Updated
**2022-08-19**Reference
**PAN-192999**Discovered
**externally**
### Description

A PAN-OS URL filtering policy misconfiguration could allow a network-based attacker to conduct reflected and amplified TCP denial-of-service (RDoS) attacks. The DoS attack would appear to originate from a Palo Alto Networks PA-Series (hardware), VM-Series (virtual) and CN-Series (container) firewall against an attacker-specified target.

To be misused by an external attacker, the firewall configuration must have a URL filtering profile with one or more blocked categories assigned to a security rule with a source zone that has an external facing network interface. This configuration is not typical for URL filtering and, if set, is likely unintended by the administrator.

If exploited, this issue would not impact the confidentiality, integrity, or availability of our products. However, the resulting denial-of-service (DoS) attack may help obfuscate the identity of the attacker and implicate the firewall as the source of the attack.

We have taken prompt action to address this issue in our PAN-OS software. All PAN-OS software updates for this issue are now available. This issue does not impact Panorama M-Series or Panorama virtual appliances.

This issue has been resolved for all Cloud NGFW and Prisma Access customers and no additional action is required from them.

### Product Status

| Versions | Affected | Unaffected |
| Cloud NGFW | None | All |
| PAN-OS 10.2 | < 10.2.2-h2 | >= 10.2.2-h2 |
| PAN-OS 10.1 | < 10.1.6-h6 | >= 10.1.6-h6 |
| PAN-OS 10.0 | < 10.0.11-h1 | >= 10.0.11-h1 |
| PAN-OS 9.1 | < 9.1.14-h4 | >= 9.1.14-h4 |
| PAN-OS 9.0 | < 9.0.16-h3 | >= 9.0.16-h3 |
| PAN-OS 8.1 | < 8.1.23-h1 | >= 8.1.23-h1 |
| Prisma Access 3.1 | None | All |
| Prisma Access 3.0 | None | All |
| Prisma Access 2.2 | None | All |
| Prisma Access 2.1 | None | All |

### Required Configuration for Exposure

The firewall configuration must have a URL filtering profile with one or more blocked categories assigned to a security rule with a source zone that has an external facing interface for this issue to be misused by an external attacker. This configuration is not typical for URL filtering and is likely unintended by the administrator.

This issue is applicable to PA-Series (hardware), VM-Series (virtual), and CN-Series (container) firewalls only when all three of the following conditions are true:

1. The security policy on the firewall that allows traffic to pass from Zone A to Zone B includes a URL filtering profile with one or more blocked categories;

AND

2. Packet-based attack protection is not enabled in a Zone Protection profile for Zone A including both (Packet Based Attack Protection > TCP Drop > TCP Syn With Data) and (Packet Based Attack Protection > TCP Drop > Strip TCP Options > TCP Fast Open);

AND

3. Flood protection through SYN cookies is not enabled in a Zone Protection profile for Zone A (Flood Protection > SYN > Action > SYN Cookie) with an activation threshold of 0 connections.

### Severity: HIGH

CVSSv3.1
Base Score:
8.6 ([CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H](https://cvssjs.github.io/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H))

### Exploitation Status

Palo Alto Networks recently learned that an attempted reflected denial-of-service (RDoS) attack was identified by a service provider. This attempted attack took advantage of susceptible firewalls from multiple vendors, including Palo Alto Networks. We immediately started to root cause and remediate this issue.

Exploitation of this issue does not impact the confidentiality, integrity, or availability of our products.

### Weakness Type

[CWE-406 Insufficient Control of Network Message Volume (Network Amplification)](https://cwe.mitre.org/data/definitions/406 "More at https://cwe.mitre.org/data/definitions/406")

### Solution

We identified workarounds to prevent the denial-of-service (DoS) attacks that result from this issue in certain Palo Alto Networks firewalls, with this policy configuration.

This issue is fixed in PAN-OS 8.1.23-h1, PAN-OS 9.0.16-h3, PAN-OS 9.1.14-h4, PAN-OS 10.0.11-h1, PAN-OS 10.1.6-h6, PAN-OS 10.2.2-h2, and all later PAN-OS versions for PA-Series, VM-Series and CN-Series firewalls.

All PAN-OS software updates for this issue are now available.

### Workarounds and Mitigations

If you have a URL filtering policy with one or more blocked categories assigned to a security rule with a source zone that has an external facing interface, removing this configuration will prevent this issue from being exploited by remote attackers to conduct reflected DoS.

To prevent denial-of-service (DoS) attacks resulting from this issue from all sources, you can configure your Palo Alto Networks firewalls by enabling one of two zone protection mitigations on all Security zones with an assigned Security policy that includes a URL filtering profile:

1. Packet-based attack protection including both (Packet Based Attack Protection > TCP Drop > TCP SYN with Data) and (Packet Based Attack Protection > TCP Drop > Strip TCP Options > TCP Fast Open);

OR

2. Flood protection (Flood Protection > SYN > Action > SYN Cookie) with an activation threshold of 0 connections.

NOTES:

It is not necessary nor advantageous to apply both the attack and flood protections.

(Palo Alto Networks Aporeto software only) You should not enable either of these protections if using Aporeto software; instead, wait for and install a fixed version of PAN-OS software.

Packet-Based Attack Protection Workaround (Recommended)

Follow the technical documentation to configure packet-based attack protection options for all defined Security zones with URL filtering enabled in the Security profile for that zone:

<https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/configure-zone-protection-to-increase-network-security/configure-packet-based-attack-protection>

The packet-based attack protection workaround will prevent the firewall from establishing TCP sessions in impacted zones when the TCP SYN packet contains data in the three-way handshake for a TCP session. Please note that this workaround may disrupt applications that use TCP Fast Open in the zone.

Flood Protection (Alternate) Workaround

If you instead decide to enable the flood protection workaround, first make sure you understand how enabling SYN cookies will change traffic flow in the impacted zones:

<https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/zone-defense/zone-protection-profiles/flood-protection>

### Acknowledgments

This issue was responsibly reported to Palo Alto Networks by Excellium-Services S.A. CSIRT, CERT-XLM.
### Frequently Asked Questions

#### Q. How is this a high severity vulnerability if it does not impact the security of the firewall?

> Though exploitation of this issue does not impact the confidentiality, integrity, or availability of your firewall or appliance, the resulting denial-of-service (DoS) attack can potentially result in a loss of availability for the attacker-specified target if that target lacks sufficient DoS protection.

#### Q. Why is this considered a misconfiguration or unintended configuration?

> Palo Alto Networks URL filtering solution allows you to monitor and control the sites users can access, to prevent phishing attacks by controlling the sites to which users can submit valid corporate credentials, and to enforce safe search for search engines like Google and Bing.
>
> The URL filtering policies are intended to be triggered when a user inside a protected network requests to visit dangerous or disallowed sites on the Internet in traffic destined to the Internet. Such requests are blocked and the browser displays a “Web Page Blocked” message.
>
> Such URL filtering is not meant to be used in the other direction for traffic coming from the Internet to the protected network. URL filtering in that direction offers no benefits. Hence any firewall configuration that is doing this is likely unintentional and considered a misconfiguration.

#### Q. Why is this fixed with software updates if this is due to a misconfiguration?

> The misconfiguration exposes the vulnerability which enables remote network based attackers to conduct reflected denial of service (RDoS) attacks. The PAN-OS fixes resolve this vulnerability eliminating this RDoS risk for the misconfigured firewalls and from internal threats.

#### Q. How do I know if my firewall(s) are being misused for conducting DoS attacks?

> An abnormal increase in URL Filtering Logs with a block action that has a large number of retries by the same set of external source IP addresses is an indicator of this misuse.

### Timeline

2022-08-19
PAN-OS 9.0.16-h3, PAN-OS 9.1.14-h4, and PAN-OS 10.0.11-h1 fixed versions are now available.2022-08-18
PAN-OS 10.2.2-h2 fixed version is now available.2022-08-16
PAN-OS 8.1.23-h1 fixed version is now available.2022-08-12
An update to the acknowledgements section of the advisory.2022-08-10
PAN-OS 10.1.6-h6 fixed version is now available. Updated ETA for PAN-OS 8.1.23-h1. Clarified URL filtering assignment language.2022-08-10
Initial publication[Terms of use](https://www.paloaltonetworks.com/legal-notices/terms-of-use)[Privacy](https://www.paloaltonetworks.com/legal-notices/privacy)[Product Security Assurance and Vulnerability Disclosure Policy](https://paloaltonetworks.com/product-security-assurance)[Report vulnerabilities](/report)[Manage subscriptions](https://support.paloaltonetworks.com/SupportAccount/Preferences)© 2024 Palo Alto Networks, Inc. All rights reserved.