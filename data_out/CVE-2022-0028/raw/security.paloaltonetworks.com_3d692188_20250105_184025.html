<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><head><title>CVE-2022-0028 PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="keywords" content="psirt, PANW, PAN, CVE, Report Vulnerabilities, Palo Alto Networks"><meta name="og:site_name" content="Palo Alto Networks Product Security Assurance"><meta name="theme-color" content="#f0f8ff"><meta property="og:type" content="website"><link rel="apple-touch-icon" sizes="180x180" href="/icon-180x180.png"><link rel="icon" type="image/png" href="/icon-180x180.png" sizes="180x180"><link rel="shortcut icon" href="/favicon.ico"><link href="https://fonts.googleapis.com/css?family=Montserrat:700&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/min.css"><script src="https://assets.adobedtm.com/9273d4aedcd2/fde2d38db50b/launch-4c3207301e79.min.js" async></script><meta name="description" content="Palo Alto Networks Security Advisory: CVE-2022-0028 PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering A PAN-OS URL filtering policy misconfiguration could allow a network-based attacker to conduct reflected and amplified TCP denial-of-service (RDoS) attacks. The DoS attack would appear to originate from a Palo Alto Networks PA-Series (hardware), VM-Series (virtual) and CN-Series (container) firewall against an attacker-specified target.

To be misused by an external attacker, the firewall configuration must have a URL filtering profile with one or more blocked categories assigned to a security rule with a source zone that has an external facing network interface. This configuration is not typical for URL filtering and, if set, is likely unintended by the administrator.

If exploited, this issue would not impact the confidentiality, integrity, or availability of our products. However, the resulting denial-of-service (DoS) attack may help obfuscate the identity of the attacker and implicate the firewall as the source of the attack.

We have taken prompt action to address this issue in our PAN-OS software. All PAN-OS software updates for this issue are now available. This issue does not impact Panorama M-Series or Panorama virtual appliances.

This issue has been resolved for all Cloud NGFW and Prisma Access customers and no additional action is required from them."><meta property="og:title" content="CVE-2022-0028 PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering"><meta property="og:description" content="A PAN-OS URL filtering policy misconfiguration could allow a network-based attacker to conduct reflected and amplified TCP denial-of-service (RDoS) attacks. The DoS attack would appear to originate fr..."><meta property="og:type" content="article"><meta property="article:publisher" content="Palo Alto Networks Product Security Assurance"><meta property="article:author" content="PAN PSIRT"><meta property="article:published_time" content="2022-08-10T16:00:00.000Z"><meta name="twitter:card" contet="summary"><meta name="twitter:label1" content="Severity"><meta name="twitter:label2" content="Published"><meta name="twitter:data2" content="2022-08-10"></head><body id="body"><nav id="nav"><a class="ico logo tsz" href="https://www.paloaltonetworks.com"></a><input class="hid" id="menu" type="checkbox"><label class="rt ico menu nsz" for="menu" onclick></label><ul><li><a href="https://support.paloaltonetworks.com/support" target="_blank" nav-track="true" nav-track-breadcrumb="nav:support">Get support</a></li><li><a href="/">Security advisories</a></li><li><a href="/report">Report vulnerabilities</a></li><li><a href="https://support.paloaltonetworks.com/SupportAccount/Preferences"><span class="ico eml"></span>
<span>Subscribe</span></a></li><li><a href="/rss.xml"><span class="ico rss"></span>
<span>RSS feed</span></a></li></ul></nav><div class="pad" id="content"><a href="/">Palo Alto Networks Security Advisories</a> /
<a href="">CVE-2022-0028</a><h2>CVE-2022-0028 PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering</h2><div class="sa_summary"><div class="pad rnd bg-blu sa_cvss"><br><style>@keyframes rotate{0%{transform: rotate(0deg);} 100%{transform: rotate(261deg);} }</style><svg id="CVSSSVG" width="42mm" height="42mm" version="1.1" viewbox="0 0 42 42" xmlns="http://www.w3.org/2000/svg"><circle cx="21" cy="21" r="18.5" fill="#fff" fill-rule="evenodd" stroke="#000" stroke-width="1"></circle><g fill-rule="evenodd" shape-rendering="auto"><path d="m15.383 32.46-1.8893 3.5011c0.5329 0.26616 1.0775 0.5058 1.634 0.71365l1.2842-3.7672c-0.34867-0.13443-0.69246-0.28245-1.0289-0.44752z" fill="#00CC66"></path><path d="m27.258 32.107c-3.1418 1.7714-6.7034 2.0742-9.9002 1.1219l-1.2842 3.7651c4.2936 1.3207 9.1009 0.93103 13.285-1.4785z" fill="#dedede"></path><path d="m31.982 27.496c-0.94261 1.5912-2.245 2.9961-3.8731 4.0861l2.1001 3.4075c2.2361-1.4705 4.0115-3.4052 5.2772-5.6022z" fill="#FA582D"></path><path d="m35.515 12.642-3.4091 2.1006c2.1467 3.8069 2.1408 8.2319 0.35398 11.875l3.5011 1.8893c2.4288-4.8643 2.4604-10.818-0.44597-15.865z" fill="#FD911A"></path><path d="m11.792 7.0094c-7.3432 4.8289-9.7459 14.66-5.2968 22.366 1.5194 2.6317 3.6551 4.6912 6.119 6.1107l1.8914-3.5042c-1.824-1.0806-3.4064-2.6318-4.5465-4.6064-3.3873-5.8669-1.6124-13.247 3.9331-16.959z" fill="#BFCB1E"></path><path d="m21.353 4.2607c-2.9582-0.068747-5.9687 0.64401-8.7111 2.2231l2.1006 3.4091c5.8474-3.2966 13.152-1.5088 16.839 3.9992l3.4081-2.1001c-3.1076-4.7254-8.2855-7.407-13.637-7.5313z" fill="#FFCB06"></path></g><path d="m9.1779 41.476" fill="none" stroke="#000"></path><g fill="#b2b2b2" font-family="Montserrat,Arial" font-size="3px" font-weight="bold"><text x="15.7" y="32">0</text><text x="14.1" y="13.3">4</text><text x="29.2" y="17">7</text><text x="29.6" y="27">9</text><text x="24.6" y="31">10</text></g><g id="ndg"><path id="needle" d="m20.59 15.532-4.4675 16.877 9.1162-14.889-2.6053-0.33678z" fill="#000" transform="rotate(261 21 21)"></path><circle cx="21" cy="21" r="2" fill="#f5f5f5" stroke="#000"></circle></g></svg><br><a class="rnd tag CVSS HIGH" href="https://cvssjs.github.io/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H" title="CVSS-B: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H">Severity
8.6 ·
HIGH</a></div><div class="rnd pad1 bg-blu sa_vector v3"><div title="Worst: The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable at the protocol level one or more network hops away (e.g., across one or more routers)."><small>Attack Vector
</small><b>NETWORK</b></div><div title="Worst: An exploited vulnerability can affect resources beyond the security scope managed by the security authority of the vulnerable component. In this case, the vulnerable component and the impacted component are different and managed by different security authorities."><small>Scope
</small><b>CHANGED</b></div><div title="Worst: Specialized access conditions or extenuating circumstances do not exist. An attacker can expect repeatable success when attacking the vulnerable component."><small>Attack Complexity
</small><b>LOW</b></div><div title="Good: There is no loss of confidentiality within the impacted component."><small>Confidentiality Impact
</small><b>NONE</b></div><div title="Worst: The attacker is unauthorized before the attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack."><small>Privileges Required
</small><b>NONE</b></div><div title="Good: There is no loss of integrity within the impacted component."><small>Integrity Impact
</small><b>NONE</b></div><div title="Worst: The vulnerable system can be exploited without interaction from any user."><small>User Interaction
</small><b>NONE</b></div><div title="Worst: There is a total loss of availability, resulting in the attacker being able to fully deny access to resources in the impacted component; this loss is either sustained (while the attacker continues to deliver the attack) or persistent (the condition persists even after the attack has completed). Alternatively, the attacker can deny some availability, but the loss of availability presents a direct, serious consequence to the impacted component (e.g., the attacker cannot disrupt existing connections, but can prevent new connections; the attacker can repeatedly exploit a vulnerability that, in each instance of a successful attack, leaks an only small amount of memory, but after repeated exploitation causes a service to become completely unavailable)."><small>Availability Impact
</small><b>HIGH</b></div></div><div class="rnd pad1 bg-blu sa_expand"><div class="sa_links pull_right"><span><a class="tag blue" href="https://www.cve.org/CVERecord?id=CVE-2022-0028" target="_blank" title="See CVE.org record">CVE</a>
<a class="tag orange" href="/json/CVE-2022-0028" title="Download the information in this advisory in CVE-JSON format">JSON</a>
<a class="tag csaf" href="/csaf/CVE-2022-0028" title="Download the information in this advisory in CSAF format">CSAF</a>
<a class="btn blue" href="/CVE-2022-0028" title="Permanent link to this advisory"><span class="ico link"></span></a>
<a class="btn" title="Share this advisory in email" href="mailto:?subject=CVE-2022-0028 PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering&amp;body=CVE-2022-0028 PAN-OS: Reflected Amplification Denial-of-Service (DoS) Vulnerability in URL Filtering%0A%0Ahttps://security.paloaltonetworks.com/CVE-2022-0028"><span class="ico eml"></span></a></span><div><span class="ico date"></span><small> Published
</small><b><span class="date-tt" data-date="2022-08-10T16:00:00.000Z">2022-08-10</span></b></div><div><span class="ico date"></span><small> Updated
</small><b><span class="date-tt" data-date="2022-08-19T16:22:00.000Z">2022-08-19</span></b></div><div><small>Reference
</small><b>PAN-192999</b></div><div title="This issue was found during external security research or testing."><small>Discovered
</small><b>externally</b></div></div></div></div><h3>Description</h3><p>A PAN-OS URL filtering policy misconfiguration could allow a network-based attacker to conduct reflected and amplified TCP denial-of-service (RDoS) attacks. The DoS attack would appear to originate from a Palo Alto Networks PA-Series (hardware), VM-Series (virtual) and CN-Series (container) firewall against an attacker-specified target.</p><p>To be misused by an external attacker, the firewall configuration must have a URL filtering profile with one or more blocked categories assigned to a security rule with a source zone that has an external facing network interface. This configuration is not typical for URL filtering and, if set, is likely unintended by the administrator.</p><p>If exploited, this issue would not impact the confidentiality, integrity, or availability of our products. However, the resulting denial-of-service (DoS) attack may help obfuscate the identity of the attacker and implicate the firewall as the source of the attack.</p><p>We have taken prompt action to address this issue in our PAN-OS software. All PAN-OS software updates for this issue are now available. This issue does not impact Panorama M-Series or Panorama virtual appliances.</p><p>This issue has been resolved for all Cloud NGFW and Prisma Access customers and no additional action is required from them.</p><h3>Product Status</h3><table class="neat card"><colgroup><col><col class="affectedCol"></colgroup><tr><th>Versions</th><th>Affected</th><th>Unaffected</th></tr><tr><td>Cloud NGFW </td><td>None</td><td>All</td></tr><tr><td>PAN-OS 10.2</td><td>&lt; 10.2.2-h2</td><td>&gt;= 10.2.2-h2</td></tr><tr><td>PAN-OS 10.1</td><td>&lt; 10.1.6-h6</td><td>&gt;= 10.1.6-h6</td></tr><tr><td>PAN-OS 10.0</td><td>&lt; 10.0.11-h1</td><td>&gt;= 10.0.11-h1</td></tr><tr><td>PAN-OS 9.1</td><td>&lt; 9.1.14-h4</td><td>&gt;= 9.1.14-h4</td></tr><tr><td>PAN-OS 9.0</td><td>&lt; 9.0.16-h3</td><td>&gt;= 9.0.16-h3</td></tr><tr><td>PAN-OS 8.1</td><td>&lt; 8.1.23-h1</td><td>&gt;= 8.1.23-h1</td></tr><tr><td>Prisma Access 3.1</td><td>None</td><td>All</td></tr><tr><td>Prisma Access 3.0</td><td>None</td><td>All</td></tr><tr><td>Prisma Access 2.2</td><td>None</td><td>All</td></tr><tr><td>Prisma Access 2.1</td><td>None</td><td>All</td></tr></table><h3>Required Configuration for Exposure</h3><p>The firewall configuration must have a URL filtering profile with one or more blocked categories assigned to a security rule with a source zone that has an external facing interface for this issue to be misused by an external attacker. This configuration is not typical for URL filtering and is likely unintended by the administrator.</p><p>This issue is applicable to PA-Series (hardware), VM-Series (virtual), and CN-Series (container) firewalls only when all three of the following conditions are true:</p><p>1. The security policy on the firewall that allows traffic to pass from Zone A to Zone B includes a URL filtering profile with one or more blocked categories;</p><p>AND</p><p>2. Packet-based attack protection is not enabled in a Zone Protection profile for Zone A including both (Packet Based Attack Protection &gt; TCP Drop &gt; TCP Syn With Data) and (Packet Based Attack Protection &gt; TCP Drop &gt; Strip TCP Options &gt; TCP Fast Open);</p><p>AND</p><p>3. Flood protection through SYN cookies is not enabled in a Zone Protection profile for Zone A (Flood Protection &gt; SYN &gt; Action &gt; SYN Cookie) with an activation threshold of 0 connections.</p><h3>Severity:
HIGH</h3><p>CVSSv3.1
Base Score:
8.6 (<a href="https://cvssjs.github.io/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H</a>)</p><h3>Exploitation Status</h3><p>Palo Alto Networks recently learned that an attempted reflected denial-of-service (RDoS) attack was identified by a service provider. This attempted attack took advantage of susceptible firewalls from multiple vendors, including Palo Alto Networks. We immediately started to root cause and remediate this issue.</p><p>Exploitation of this issue does not impact the confidentiality, integrity, or availability of our products.</p><h3>Weakness Type</h3><p><a href="https://cwe.mitre.org/data/definitions/406" target="_blank" title="More at https://cwe.mitre.org/data/definitions/406">CWE-406 Insufficient Control of Network Message Volume (Network Amplification)</a></p><h3>Solution</h3><p>We identified workarounds to prevent the denial-of-service (DoS) attacks that result from this issue in certain Palo Alto Networks firewalls, with this policy configuration.</p><p>This issue is fixed in PAN-OS 8.1.23-h1, PAN-OS 9.0.16-h3, PAN-OS 9.1.14-h4, PAN-OS 10.0.11-h1, PAN-OS 10.1.6-h6, PAN-OS 10.2.2-h2, and all later PAN-OS versions for PA-Series, VM-Series and CN-Series firewalls.</p><p>All PAN-OS software updates for this issue are now available.</p><h3>Workarounds and Mitigations</h3><p>If you have a URL filtering policy with one or more blocked categories assigned to a security rule with a source zone that has an external facing interface, removing this configuration will prevent this issue from being exploited by remote attackers to conduct reflected DoS.</p><p>To prevent denial-of-service (DoS) attacks resulting from this issue from all sources, you can configure your Palo Alto Networks firewalls by enabling one of two zone protection mitigations on all Security zones with an assigned Security policy that includes a URL filtering profile:</p><p>1. Packet-based attack protection including both (Packet Based Attack Protection &gt; TCP Drop &gt; TCP SYN with Data) and (Packet Based Attack Protection &gt; TCP Drop &gt; Strip TCP Options &gt; TCP Fast Open);</p><p>OR</p><p>2. Flood protection (Flood Protection &gt; SYN &gt; Action &gt; SYN Cookie) with an activation threshold of 0 connections.</p><p>NOTES:</p><p>It is not necessary nor advantageous to apply both the attack and flood protections. </p><p>(Palo Alto Networks Aporeto software only) You should not enable either of these protections if using Aporeto software; instead, wait for and install a fixed version of PAN-OS software.</p><p>Packet-Based Attack Protection Workaround (Recommended)</p><p>Follow the technical documentation to configure packet-based attack protection options for all defined Security zones with URL filtering enabled in the Security profile for that zone:</p><p><a href="https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/configure-zone-protection-to-increase-network-security/configure-packet-based-attack-protection" class="linkified" target="_blank">https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/configure-zone-protection-to-increase-network-security/configure-packet-based-attack-protection</a></p><p>The packet-based attack protection workaround will prevent the firewall from establishing TCP sessions in impacted zones when the TCP SYN packet contains data in the three-way handshake for a TCP session. Please note that this workaround may disrupt applications that use TCP Fast Open in the zone.</p><p>Flood Protection (Alternate) Workaround</p><p>If you instead decide to enable the flood protection workaround, first make sure you understand how  enabling SYN cookies will change traffic flow in the impacted zones:</p><p><a href="https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/zone-defense/zone-protection-profiles/flood-protection" class="linkified" target="_blank">https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/zone-protection-and-dos-protection/zone-defense/zone-protection-profiles/flood-protection</a></p><h3>Acknowledgments</h3><div class="pad rnd bg-wht flx"><div class="tsz ico credit"></div><div class="pad1"><div>This issue was responsibly reported to Palo Alto Networks by Excellium-Services S.A. CSIRT, CERT-XLM.</div></div></div><h3>Frequently Asked Questions</h3><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
How is this a high severity vulnerability if it does not impact the security of the firewall?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p>Though exploitation of this issue does not impact the confidentiality, integrity, or availability of your firewall or appliance, the resulting denial-of-service (DoS) attack can potentially result in a loss of availability for the attacker-specified target if that target lacks sufficient DoS protection.<br></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
Why is this considered a misconfiguration or unintended configuration?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><p>Palo Alto Networks URL filtering solution allows you to monitor and control the sites users can access, to prevent phishing attacks by controlling the sites to which users can submit valid corporate credentials, and to enforce safe search for search engines like Google and Bing.</p><p>The URL filtering policies are intended to be triggered when a user inside a protected network requests to visit dangerous or disallowed sites on the Internet in traffic destined to the Internet. Such requests are blocked and the browser displays a “Web Page Blocked” message.</p><p>Such URL filtering is not meant to be used in the other direction for traffic coming from the Internet to the protected network. URL filtering in that direction offers no benefits. Hence any firewall configuration that is doing this is likely unintentional and considered a misconfiguration.</p></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
Why is this fixed with software updates if this is due to a misconfiguration?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><span style="background-color: rgb(255, 255, 255);">The misconfiguration exposes the vulnerability which enables remote network based attackers to conduct reflected denial of service (RDoS) attacks. The PAN-OS fixes resolve this vulnerability eliminating this RDoS risk for the misconfigured firewalls and from internal threats.</span><br></p></blockquote><div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question"></div><h4 itemprop="name">Q.
How do I know if my firewall(s) are being misused for conducting DoS attacks?</h4><blockquote itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer"><p><span style="background-color: rgb(255, 255, 255);">An abnormal increase in URL Filtering Logs with a block action that has a large number of retries by the same set of external source IP addresses is an indicator of this misuse.</span><br></p></blockquote><h3>Timeline</h3><div class="timeline"><div><label><span class="date-tt" data-date="2022-08-19T16:22:00.000Z">2022-08-19</span></label>
<span class="t">PAN-OS 9.0.16-h3, PAN-OS 9.1.14-h4, and PAN-OS 10.0.11-h1 fixed versions are now available.</span></div><div><label><span class="date-tt" data-date="2022-08-18T23:38:00.000Z">2022-08-18</span></label>
<span class="t">PAN-OS 10.2.2-h2 fixed version is now available.</span></div><div><label><span class="date-tt" data-date="2022-08-16T00:42:00.000Z">2022-08-16</span></label>
<span class="t">PAN-OS 8.1.23-h1 fixed version is now available.</span></div><div><label><span class="date-tt" data-date="2022-08-12T02:45:00.000Z">2022-08-12</span></label>
<span class="t">An update to the acknowledgements section of the advisory.</span></div><div><label><span class="date-tt" data-date="2022-08-10T23:10:00.000Z">2022-08-10</span></label>
<span class="t">PAN-OS 10.1.6-h6 fixed version is now available. Updated ETA for PAN-OS 8.1.23-h1. Clarified URL filtering assignment language.</span></div><div><label><span class="date-tt" data-date="2022-08-10T16:00:00.000Z">2022-08-10</span></label>
<span class="t">Initial publication</span></div></div><script>function localiseDates() {
  document.querySelectorAll("span[data-date]").forEach((elem) => {
    let localDate = new Date(elem.getAttribute("data-date"));
    let isoLocalDate = new Date(localDate.getTime() - localDate.getTimezoneOffset() * 60000).toISOString().slice(0, 10);
    elem.textContent = isoLocalDate;
    let fmtOpts = { dateStyle: "long", timeStyle: "long" };
    elem.setAttribute("title", new Intl.DateTimeFormat(undefined, fmtOpts).format(localDate));
  });
}

window.addEventListener("load", localiseDates);
</script></div><div class="footer"><a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use">Terms of use</a><a href="https://www.paloaltonetworks.com/legal-notices/privacy">Privacy</a><a href="https://paloaltonetworks.com/product-security-assurance">Product Security Assurance and Vulnerability Disclosure Policy</a><a href="/report">Report vulnerabilities</a><a href="https://support.paloaltonetworks.com/SupportAccount/Preferences">Manage subscriptions</a></div><div class="pad bg-blu"><div class="btop">© 2024 Palo Alto Networks, Inc. All rights reserved.</div></div></body></html>