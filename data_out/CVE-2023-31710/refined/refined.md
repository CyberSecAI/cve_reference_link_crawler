Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   A heap-based buffer overflow vulnerability exists in the `/usr/lib/libtmpv2.so` component of TP-Link Archer AX21 routers.
*   The vulnerability stems from using an attacker-controlled `content_length` variable to determine the size of data read into a buffer (`v7`). The size of the buffer `v7` is fixed and smaller than the maximum allowed value of `content_length`, leading to a buffer overflow.

**Weaknesses/Vulnerabilities Present:**

*   **Heap-based buffer overflow:** The vulnerability lies in the improper handling of the `content_length` when receiving data into the `v7` buffer on the heap, which leads to writing past the allocated memory.
*   **Lack of input validation:** The application fails to validate the `content_length` value, allowing an attacker to provide a value larger than the buffer.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** Successful exploitation of this vulnerability allows an attacker to execute arbitrary code on the affected router. This can lead to complete control over the device and compromise the network.

**Attack Vectors:**

*   The attack vector is through network communication by sending crafted TMP packets with malicious `content_length` values.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be on the LAN side of the router (local network access) to send the malicious crafted TMP packets.

**Additional Details:**

*   The content provides specific details about the vulnerable component (`/usr/lib/libtmpv2.so`), the vulnerable function, and the involved variables like `content_length` and buffer `v7`.
*   It lists the specific affected firmware versions and corresponding patched versions.
*   It also provides a link to the official TP-Link firmware download page for patching.
*   A video (`exploit.mp4`) demonstrating the exploit is referenced but not provided in the document.