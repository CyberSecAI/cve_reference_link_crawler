- **Root cause of vulnerability:** The application uses user-supplied data to create HQL queries without proper sanitization. Specifically, the `label` parameter in the `listDocument` endpoint is directly incorporated into an HQL query.
- **Weaknesses/vulnerabilities present:** HQL injection vulnerability. User-provided input is not sanitized before being used in a Hibernate Query Language (HQL) query.
- **Impact of exploitation:** An attacker can inject malicious HQL code that could lead to SQL injection in the underlying database. This could result in unauthorized access to sensitive data, such as account credentials or business information. In the provided example, the attacker injects code to call the MySQL `sleep` function, causing a delayed response and demonstrating the vulnerability.
- **Attack vectors:** The vulnerability is exploited through a network attack by sending a specially crafted HTTP request to the `/knowage/restful-services/2.0/documents/listDocument` endpoint.
- **Required attacker capabilities/position:** The attacker needs to be authenticated and have low privileges to exploit the vulnerability, and needs to be able to send HTTP requests to the application.

The content provides more details than the official CVE description, including:
- Specific vulnerable endpoint and parameter
- Example of exploitation using the `sleep` function in MySQL
- List of other potential vulnerable locations in the codebase.
- CVSS score and metrics