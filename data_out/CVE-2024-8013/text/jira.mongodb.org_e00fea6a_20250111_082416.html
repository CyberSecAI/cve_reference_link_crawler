

[Log in](/login.jsp?os_destination=%2Fbrowse%2FSERVER-96254)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![MongoDB Jira](/s/ub562g/9160001/fy41z4/_/jira-logo-scaled.png)](https://jira.mongodb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [eazyBI](/plugins/servlet/eazybi)

* Give feedback to Atlassian
* [Help](/secure/ViewKeyboardShortcuts%21default.jspa "Help")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FSERVER-96254)
  + [Acknowledged notifications](/plugins/servlet/wittified/profile/notifications)

![Uploaded image for project: 'Core Server'](https://jira.mongodb.org/secure/projectavatar?pid=10000&avatarId=13900)

1. [Core Server](/browse/SERVER)
2. [SERVER-96254](/browse/SERVER-96254)

## CSFLE and Queryable Encryption self-lookup may fail to encrypt values in subpipelines

Schedule Issue[Undo Transition](/secure/UndoTransition%21default.jspa?id=2833688)ClosedExportnullXMLWordPrintableJSON
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Duplicate
* **Priority:**
  ![Icon: Major - P3](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.") Major - P3
* **Fix Version/s:**
  None
* **Affects Version/s:**
  None
* **Component/s:**
  None
* **Labels:**
  None

* **Operating System:**
  ALL

### Description

**CVE ID:**

CVE-2024-8013

**Title:**

CSFLE and Queryable Encryption self-lookup may fail to encrypt values in subpipelines

**Description:**

A bug in query analysis of certain complex self-referential $lookup subpipelines may result in literal values in expressions for encrypted fields to be sent to the server as plaintext instead of ciphertext. Should this occur, no documents would be returned or written. This issue affects mongocryptd binary (v5.0 versions prior to 5.0.29, v6.0 versions prior to 6.0.17, v7.0 versions prior to 7.0.12 and v7.3 versions prior to 7.3.4) and mongo\_crypt\_v1.so shared libraries (v6.0 versions prior to 6.0.17, v7.0 versions prior to 7.0.12 and v7.3 versions prior to 7.3.4) released alongside MongoDB Enterprise Server versions.

**CVSS Score:**

2.2 - <https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N>

**List all affected product versions:**

mongocryptd v5.0 versions prior to 5.0.29

mongocryptd v6.0 versions prior to 6.0.17

mongocryptd v7.0 versions prior to 7.0.12

mongocryptd v7.3 versions prior to 7.3.4

Mongo\_crypt\_v1.so v6.0 versions prior to 6.0.17

Mongo\_crypt\_v1.so v7.0 versions prior to 7.0.12

Mongo\_crypt\_v1.so v7.3 versions prior to 7.3.4

**CWE:**

CWE-319: Cleartext Transmission of Sensitive Information

### Attachments

### Activity

### People

Assignee:
![karman.liu@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=17820)
Karman Liu

Reporter:
![karman.liu@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=17820)
Karman Liu

Participants:

[Karman Liu](/secure/IssueNavigator.jspa?reset=true&customfield_10051=karman.liu%40mongodb.com "Find all issues Karman Liu participated in")

Votes:
0
Vote for this issue

Watchers:
3
Start watching this issue

### Dates

Created:

Oct 28 2024 12:47:22 PM UTC

Updated:

Oct 29 2024 10:31:10 AM UTC

Resolved:

Oct 28 2024 12:48:24 PM UTC

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MongoDB. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

