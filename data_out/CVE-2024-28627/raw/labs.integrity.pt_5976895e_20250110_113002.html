<!DOCTYPE html>
<html class="no-js" lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>CVE-2024-28627 - Password protection bypass with javascript tampering | INTEGRITY Labs</title>
    <meta name="Description" content="">
    <link rel="icon" href="/images/favicon.ico">
    <link rel='prev' title='CVE-2024-25697 - Cross-site Scripting vulnerability in Portal for ArcGIS' href='/advisories/cve-2024-25697/index.html' />
    <link rel='next' title='' href='' />
    <link rel='canonical' href='/advisories/cve-2024-28627/index.html' />
    <link rel="alternate" type="application/rss+xml" title="INTEGRITY Labs &raquo; Feed" href="/feed.xml" />
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Gugi&family=Red+Hat+Mono:wght@400;500&display=swap" />
    <link rel='stylesheet' href="/assets/css/bootstrap.min.css" type='text/css' media='screen' />
	<link rel='stylesheet' href="/assets/css/font-awesome.min.css" type='text/css' media='screen' />
	<link rel='stylesheet' href="/assets/main.css" type='text/css' media='screen' />
</head>

<body>
    <div class="switcher form-check form-switch ms-auto mt-3 me-3">
        <label class="form-check-label ms-3" for="lightSwitch">
		  <svg
			xmlns="http://www.w3.org/2000/svg"
			width="25"
			height="25"
			fill="currentColor"
			class="bi bi-brightness-high"
			viewBox="0 0 16 16"
		  >
			<path
			  d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"
			/>
		  </svg>
		</label>
        <input class="form-check-input" type="checkbox" id="lightSwitch" />
    </div>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="/"><img src="/images/logo-black.svg" alt="Logo" width="265" height="70"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMenu" aria-controls="navbarMenu" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
            <div class="collapse navbar-collapse" id="navbarMenu">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link " href="/">Home</a>
                    </li>
					<li class="nav-item">
                        <a class="nav-link " href="/articles/">Articles</a>
                    </li>
					<li class="nav-item">
                        <a class="nav-link " href="/advisories/">Advisories</a>
                    </li>
					<li class="nav-item">
                        <a class="nav-link" href="https://github.com/devoteam-cybertrust/" target="_blank">Tools</a>
                    </li>
					<li class="nav-item">
                        <a class="nav-link " href="/vdp/">VDP</a>
                    </li>
					<li class="nav-item">
                        <a class="nav-link" href="https://www.integrity.pt/" target="_blank">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
		<div class="row">
            

				
<section class="wrapper">
    <time datetime="2024-04-11 00:00:00 +0000" pubdate>April 11, 2024</time>
    <h1>CVE-2024-28627 - Password protection bypass with javascript tampering</h1>
    <h2 id="1-vulnerability-properties">1. Vulnerability Properties</h2>
<p><strong>Title:</strong> Password protection bypass with javascript tampering<br />
<strong>CVE ID:</strong> CVE-2024-28627<br />
<strong>CVSSv3 Base Score:</strong> 7.5 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)<br />
<strong>Vendor:</strong> Flipsnack<br />
<strong>Products:</strong> Flipsnack<br />
<strong>Advisory Release Date:</strong> 11-04-24<br />
<strong>Advisory URL:</strong> https://labs.integrity.pt/advisories/cve-2024-28627/<br />
<strong>Credits:</strong> Discovery by Gil Correia &lt;gil.correia[at]devoteam.com&gt;</p>

<h2 id="2-vulnerability-summary">2. Vulnerability Summary</h2>

<p>This vulnerability consists in bypassing the password control over a document.</p>

<p>When a password is introduced, no request was made to the backend. 
This led to javascript analysis and Iâve came across with an interesting function called âisCorrectPasswordâ on the file reader.gz.js which returns the comparison between the original password hash which is sent in data.json and the password inserted by the user.</p>

<p>Since the evaluation is on client side and not on server side, this protection is easily bypassed by modifying the return values from this function to âtrueâ.</p>

<p>A more straightforward way to modify the javascript and reload it on the browser, would be to create a rule on the Burp Proxy Match and Replace Rules to modify the javascript right before it would reach the browser.
If these rules are enabled, all password protected files would accept any kind of password introduced by the attacker.</p>

<h2 id="3-vulnerable-versions">3. Vulnerable Versions</h2>
<ul>
  <li>Flipsnack reader.gz.js file until 18/03/2024</li>
</ul>

<h2 id="4-solution">4. Solution</h2>
<ul>
  <li>Guarantee that the aplication is using the most recent reader.gz.js file.</li>
</ul>

<h2 id="5-vulnerability-timeline">5. Vulnerability Timeline</h2>
<ul>
  <li>05/03/24â- Bug reported to vendor</li>
  <li>05/03/24 - Bug validated by vendor</li>
  <li>18/03/24 - Patch released by vendor</li>
  <li>11/04/24 - Advisory released</li>
</ul>

<h2 id="6-references">6. References</h2>
<ul>
  <li>https://cwe.mitre.org/data/definitions/603.html</li>
  <li>https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-28627</li>
  <li>https://www.flipsnack.com/</li>
</ul>

    <div class="container nav_wrapper">
        <div class="row">
            
            <div class="col-6 text-center">
                <i class="fas fa-chevron-left"></i>
                <a href="/advisories/cve-2024-25697/index.html" rel="prev">CVE-2024-25697 - Cross-site Scripting vulnerability in Portal for ArcGIS</a>
            </div>
            
            
        </div>
    </div>
</section>

<hr class="my-5">
<div class="col-6">
    <section>
        <h3 class="category_title">Latest Advisories</h3>
        <ul>
            
            
            
              
                
                <li class="category_item"><a title="CVE-2024-28627 - Password protection bypass with javascript tampering" href="/advisories/cve-2024-28627/">CVE-2024-28627 - Password protection bypass with javascript tampering</a></li>
              
            
              
                
                <li class="category_item"><a title="CVE-2024-25697 - Cross-site Scripting vulnerability in Portal for ArcGIS" href="/advisories/cve-2024-25697/">CVE-2024-25697 - Cross-site Scripting vulnerability in Portal for ArcGIS</a></li>
              
            
              
                
                <li class="category_item"><a title="CVE-2024-0396 - Missing Server-Side Input Validation leads to computational errors and potential denial of service in Progress MOVEit Transfer" href="/advisories/cve-2024-0396/">CVE-2024-0396 - Missing Server-Side Input Validation leads to computational errors and potential denial of service in Progress MOVEit Transfer</a></li>
              
            
              
                
                <li class="category_item"><a title="CVE-2023-48166 - Path Traversal vulnerability in Atos Unify OpenScape Voice" href="/advisories/cve-2023-48166/">CVE-2023-48166 - Path Traversal vulnerability in Atos Unify OpenScape Voice</a></li>
              
            
              
                
                <li class="category_item"><a title="CVE-2023-26218 - Cross-site Scripting vulnerabilities in TIBCO Nimbus" href="/advisories/cve-2023-26218/">CVE-2023-26218 - Cross-site Scripting vulnerabilities in TIBCO Nimbus</a></li>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
        </ul>
    </section>
</div>
<div class="col-6">
    <section>
        <h3 class="category_title">Latest Articles</h3>
        <ul>
            
            
            <li class="category_item"><a title="The Curious Case of Apple iOS IKEv2 VPN On Demand" href="/articles/the-curious-case-of-apple-ios-ikev2-vpn-on-demand/">The Curious Case of Apple iOS IKEv2 VPN On Demand</a></li>
            
            <li class="category_item"><a title="Gmail Android app insecure Network Security Configuration." href="/articles/Gmail-Android-app-insecure-Network-Security-Configuration/">Gmail Android app insecure Network Security Configuration.</a></li>
            
            <li class="category_item"><a title="Reviewing Android Webviews fileAccess attack vectors." href="/articles/review-android-webviews-fileaccess-attack-vectors/">Reviewing Android Webviews fileAccess attack vectors.</a></li>
            
            <li class="category_item"><a title="Droidstat-X, Android Applications Security Analyser Xmind Generator" href="/articles/droidstatx/">Droidstat-X, Android Applications Security Analyser Xmind Generator</a></li>
            
            <li class="category_item"><a title="Uber Hacking: How we found out who you are, where you are and where you went! " href="/articles/uber-hacking-how-we-found-out-who-you-are-where-you-are-and-where-you-went/">Uber Hacking: How we found out who you are, where you are and where you went! </a></li>
            
        </ul>
    </section>
</div>
	</div>
	<div class="row">
		<div class="col-12">
			<hr>
		</div>
	</div>
	<div class="row">
		<div class="col-8">
			<p><small>&copy; 2024 INTEGRITY S.A. All rights reserved. | <a href="/pdf/Politica_de_Privacidade.pdf" target="_blank">Cookie Policy</a></small></p>
		</div>
		<div class="col-4 text-center">
			<a class="social" href="https://www.linkedin.com/company/integrity-s.a." target="_blank"><i class="fab fa-linkedin-in"></i></a>
			<a class="social" href="https://www.youtube.com/channel/UC-109Z2JCpy6blf6ZFw907g" target="_blank"><i class="fab fa-youtube"></i></a>
		</div>
	</div>
</div>

<div id="cookiePopup">
    <h4>Cookie Consent <span id="hideConsent">X</span></h4>
    <p>Integrity S.A. uses cookies for analytical and more personalized information presentation purposes, based on your browsing habits and profile. For more detailed information, see our <a href="/pdf/PL114r1-website-cookies-policy.pdf" target="_blank">Cookie Policy</a>.</p>
    <button id="acceptCookie">Accept</button>
</div>

<script type='text/javascript' src='/assets/js/jquery-3.6.0.min.js'></script>
<script type='text/javascript' src='/assets/js/bootstrap.bundle.min.js'></script>
<script type='text/javascript' src="/assets/js/switch.js"></script>
<script type='text/javascript' src='/assets/js/main.js'></script>

<script type="text/javascript">
var cookieName = "Integrity Consent Cookie";
    var cookieValue = "true";
    var cookieExpireDays = 180;

    let acceptCookie = document.getElementById("acceptCookie");
    acceptCookie.onclick = function() {
        createCookie(cookieName, cookieValue, cookieExpireDays);
    }

    let hideCookie = document.getElementById("hideConsent");
    hideCookie.onclick = function() {
        cookieValue = "hide";
        createCookie(cookieName, cookieValue, cookieExpireDays);
    }

    let createCookie = function(cookieName, cookieValue, cookieExpireDays) {
        let currentDate = new Date();
        currentDate.setTime(currentDate.getTime() + (cookieExpireDays * 24 * 60 * 60 * 1000));
        let expires = "expires=" + currentDate.toGMTString();
        document.cookie = cookieName + "=" + cookieValue + ";" + expires + ";path=/";
        if (document.cookie) {
            document.getElementById("cookiePopup").style.display = "none";
            if (cookieValue == "true") {
                activateCookies();
            }
        } else {
            alert("Unable to set cookie. Please allow all cookies site from cookie setting of your browser");
        }

    }

    let retrieveCookie = function(cookieName) {
            let name = cookieName + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

    let checkCookie = function() {
        let check = retrieveCookie(cookieName);
        if (check == "") {
            document.getElementById("cookiePopup").style.display = "block";
            deactivateCookies();
        } else {
            document.getElementById("cookiePopup").style.display = "none";
            if (check == "true") {
                activateCookies();
            }
        }
    }
    
    let activateCookies = function() {
        var body = document.getElementsByTagName('body')[0]; 
        // Google
        var js = document.createElement("script");
        js.async = true;
		js.id = 'ganalytics';
		let source = 
			"(function(i, s, o, g, r, a, m) {" +
				"i['GoogleAnalyticsObject'] = r;" +
				"i[r] = i[r] || function() {" +
				"	(i[r].q = i[r].q || []).push(arguments)" +
				"}, i[r].l = 1 * new Date();" +
				"a = s.createElement(o)," +
				"	m = s.getElementsByTagName(o)[0];" +
				"a.async = 1;" +
				"a.src = g;" +
				"m.parentNode.insertBefore(a, m)" +
			"})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');" +
			"ga('create', 'UA-27538162-4', 'auto');" +
			"ga('send', 'pageview');"
        js.text = source; 
        body.appendChild(js);
    }

    let deactivateCookies = function() {
        var cookies = document.cookie.split("; ");
        for (var c = 0; c < cookies.length; c++) {
            var d = window.location.hostname.split(".");
            while (d.length > 0) {
                var cookieBase = encodeURIComponent(cookies[c].split(";")[0].split("=")[0]) + '=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain=' + d.join('.') + ' ;path=';
                var p = location.pathname.split('/');
                document.cookie = cookieBase + '/';
                while (p.length > 0) {
                    document.cookie = cookieBase + p.join('/');
                    p.pop();
                };
                d.shift();
            }
        }
        $('#ganalytics').remove();
    }
    
    window.addEventListener("load", function(){
        checkCookie();
    });
</script>

</body>

</html>



