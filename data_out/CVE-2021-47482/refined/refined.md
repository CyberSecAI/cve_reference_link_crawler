```
{
  "cveId": "CVE-2021-47482",
  "description": "The provided commits fix an error handling issue in the batman-adv module of the Linux kernel. The `batadv_mesh_init` function was previously calling `batadv_mesh_free()` in case of any `batadv_*_init()` call failures. This could lead to cleaning up uninitialized fields, and potentially cause a General Protection Fault (GPF) due to a NULL hash pointer. This issue is fixed by unwinding the `batadv_*_init()` calls one by one and open-coding `batadv_mesh_free` with the proper order to avoid touching uninitialized fields.",
  "vulnerability": {
    "rootCause": "Incorrect error handling in `batadv_mesh_init()`. When any of the `batadv_*_init()` functions failed, `batadv_mesh_free()` was called to deallocate resources. However, this function was not aware of which parts of the batman-adv module had been successfully initialized, leading to attempts to free uninitialized fields.",
    "weaknesses": [
      "Incorrect error handling",
      "Use of uninitialized fields"
    ],
    "impact": "A General Protection Fault (GPF) could occur, potentially leading to a denial-of-service.",
    "attackVectors": [
      "Triggering a failure in one of the `batadv_*_init()` functions during the initialization of the batman-adv mesh interface."
    ],
    "requiredCapabilities": "An attacker would need to be able to create or manipulate network configurations in such a way that causes the initialization of the batman-adv mesh interface to fail."
  },
    "fixes": [
      "The patch modifies `batadv_mesh_init()` to unwind `batadv_*_init()` calls one by one in the error handling path, ensuring proper cleanup of allocated memory before returning an error.",
       "Individual `batadv_*_init` functions now clean up their own allocated memory if they fail, so that subsequent `batadv_*_free` functions are not called on uninitialized data.",
       "The `batadv_mesh_free` has been open-coded with the proper order to avoid touching uninitialized fields."
    ]
}
```