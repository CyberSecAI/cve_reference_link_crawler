

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Import via git protocol allows to bypass checks on repository

### Problem

When pushing via the git protocol to GitLab there are certain checks in place to stop people to push or commit "dangerous" things like branch names which look like commit hashes (40 hex characters) or files like `.git/config` within a repository.
The UI also doesn't allow to create such branches or files.

However when importing a repo via the `git://` protocol those checks are not enforced and such odd repositories can be cerated.
As a proof of concept I've imported such a repo to gitlab.com, the branches can be seen at <https://gitlab.com/gitlab-com/gl-security/security-research/branchname40hex/-/branches>

A repository which contains a `.git` directory can also be imported that way, I've only verified this locally.
[![image](data:image/gif;base64...)](/-/project/278964/uploads/f501bf56b4f58a00bff95c214c3284f5/image.png)

### Proposed solution

The same checks should be applied to imports via the `git://` protocol which are applied to normal push operations. This includes a `git fsck` to catch for instance `.git` directories and the `prohibited_branch_checks` in `lib/gitlab/checks/branch_check.rb`.

cc [@gitlab-com/gl-security/appsec](/gitlab-com/gl-security/appsec "GitLab.com / GitLab Security Department / Application Security") for initial triage and [@nmalcolm](/nmalcolm "Nick Malcolm") as the SC for [devopsmanage](/gitlab-org/gitlab/-/issues?label_name=devops%3A%3Amanage "<span class='font-weight-bold scoped-label-tooltip-title'>Scoped label</span><br>Issues for the Manage stage of the DevOps lifecycle (e.g. Audit Management, Cycle Analytics)") ~"group::import"

This issue is part of a two-step solution:

1. Ensure that `git fsck` is applied after importing import projects via the `git://` protocol (**out of scope here**, will be implemented by [groupgitaly](/gitlab-org/gitlab/-/issues?label_name=group%3A%3Agitaly "<span class='font-weight-bold scoped-label-tooltip-title'>Scoped label</span><br>Issues belonging to the Gitaly group of the Systems stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/categories/#gitaly-group") via <https://gitlab.com/gitlab-org/gitaly/-/issues/4323>)
2. Ensure that we run a clean-up task after the import is completed to delete all prohibited branches (this issue)

Edited Jul 01, 2022 by [Martin Wortschack](/wortschi)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

