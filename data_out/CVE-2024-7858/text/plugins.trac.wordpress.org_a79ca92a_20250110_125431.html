

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3143036%2540media-library-plus%26old%3D3143036%2540media-library-plus)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3143035/media-library-plus "Changeset 3143035 for media-library-plus")
* [Next Change](/changeset/3177028/media-library-plus "Changeset 3177028 for media-library-plus") →

---

# Changeset [3143036](/changeset/3143036 "Show full changeset") for [media-library-plus](/browser/media-library-plus?rev=3143036 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/28/2024 03:23:21 PM
([4 months](/timeline?from=2024-08-28T15%3A23%3A21Z&precision=second "See timeline at 08/28/2024 03:23:21 PM") ago)

Author:
AlanP57
Message:

Update 8.2.4

Location:
[media-library-plus/trunk](/browser/media-library-plus/trunk?rev=3143036)
Files:

4 edited

* [js/mlfp-media.js](/browser/media-library-plus/trunk/js/mlfp-media.js?rev=3143036 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [media-library-plus.php](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036 "Show entry in browser")
  (modified)
  ([37 diffs](#file1 "Show differences"))
* [mlp-reset.php](/browser/media-library-plus/trunk/mlp-reset.php?rev=3143036 "Show entry in browser")
  (modified)
  ([4 diffs](#file2 "Show differences"))
* [readme.txt](/browser/media-library-plus/trunk/readme.txt?rev=3143036 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [media-library-plus/trunk/js/mlfp-media.js](/changeset/3143036/media-library-plus/trunk/js/mlfp-media.js "Show the changeset 3143036 restricted to media-library-plus/trunk/js/mlfp-media.js")

  | [r2945399](/browser/media-library-plus/trunk/js/mlfp-media.js?rev=2945399#L9 "Show revision 2945399 of this file in browser") | [r3143036](/browser/media-library-plus/trunk/js/mlfp-media.js?rev=3143036#L9 "Show revision 3143036 of this file in browser") |  |
  | --- | --- | --- |
  | 9 | 9 | }, |
  | 10 | 10 | refresh : function(){ |
  | 11 |  | ~~//new\_folder\_check();~~ |
  | 12 | 11 | //mlfp\_display\_folder\_tree(); |
  | 13 | 12 | //console.log('starting folder id', mlfpmedia.new\_folder\_id) |
* ## [media-library-plus/trunk/media-library-plus.php](/changeset/3143036/media-library-plus/trunk/media-library-plus.php "Show the changeset 3143036 restricted to media-library-plus/trunk/media-library-plus.php")

  | [r3139954](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L4 "Show revision 3139954 of this file in browser") | [r3143036](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L4 "Show revision 3143036 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: http://maxgalleria.com |
  | 5 | 5 | Description: Gives you the ability to adds folders and move files in the WordPress Media Library. |
  | 6 |  | Version: 8.2.~~3~~ |
  |  | 6 | Version: 8.2.4 |
  | 7 | 7 | Author: Max Foundry |
  | 8 | 8 | Author URI: http://maxfoundry.com |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L76) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L76) |  |
  | 76 | 76 | public function set\_global\_constants() { |
  | 77 | 77 | define('MAXGALLERIA\_MEDIA\_LIBRARY\_VERSION\_KEY', 'maxgalleria\_media\_library\_version'); |
  | 78 |  | define('MAXGALLERIA\_MEDIA\_LIBRARY\_VERSION\_NUM', '8.2.~~3~~'); |
  |  | 78 | define('MAXGALLERIA\_MEDIA\_LIBRARY\_VERSION\_NUM', '8.2.4'); |
  | 79 | 79 | define('MAXGALLERIA\_MEDIA\_LIBRARY\_IGNORE\_NOTICE', 'maxgalleria\_media\_library\_ignore\_notice'); |
  | 80 | 80 | define('MAXGALLERIA\_MEDIA\_LIBRARY\_PLUGIN\_NAME', trim(dirname(plugin\_basename(\_\_FILE\_\_)), '/')); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L208) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L208) |  |
  | 208 | 208 | add\_action('wp\_ajax\_upload\_attachment', array($this, 'upload\_attachment')); |
  | 209 | 209 |  |
  | 210 |  | add\_action('wp\_ajax\_nopriv\_copy\_media', array($this, 'copy\_media')); |
  | 211 |  | add\_action('wp\_ajax\_copy\_media', array($this, 'copy\_media')); |
  | 212 |  |  |
  | 213 |  | add\_action('wp\_ajax\_nopriv\_move\_media', array($this, 'move\_media')); |
  | 214 |  | add\_action('wp\_ajax\_move\_media', array($this, 'move\_media')); |
  |  | 210 | // not used |
  |  | 211 | //add\_action('wp\_ajax\_nopriv\_copy\_media', array($this, 'copy\_media')); |
  |  | 212 | //add\_action('wp\_ajax\_copy\_media', array($this, 'copy\_media')); |
  |  | 213 |  |
  |  | 214 | //add\_action('wp\_ajax\_nopriv\_move\_media', array($this, 'move\_media')); |
  |  | 215 | //add\_action('wp\_ajax\_move\_media', array($this, 'move\_media')); |
  | 215 | 216 |  |
  | 216 | 217 | add\_action('wp\_ajax\_nopriv\_add\_to\_max\_gallery', array($this, 'add\_to\_max\_gallery')); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L242) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L243) |  |
  | 242 | 243 | //add\_action('wp\_ajax\_nopriv\_max\_sync\_contents', array($this, 'max\_sync\_contents')); |
  | 243 | 244 | //add\_action('wp\_ajax\_max\_sync\_contents', array($this, 'max\_sync\_contents')); |
  | 244 |  |  |
  | 245 |  | add\_action('wp\_ajax\_nopriv\_mlp\_tb\_load\_folder', array($this, 'mlp\_tb\_load\_folder')); |
  | 246 |  | add\_action('wp\_ajax\_mlp\_tb\_load\_folder', array($this, 'mlp\_tb\_load\_folder')); |
  | 247 |  |  |
  |  | 245 |  |
  | 248 | 246 | add\_action('wp\_ajax\_nopriv\_mlp\_load\_folder', array($this, 'mlp\_load\_folder')); |
  | 249 | 247 | add\_action('wp\_ajax\_mlp\_load\_folder', array($this, 'mlp\_load\_folder')); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L261) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L259) |  |
  | 261 | 259 | add\_action('wp\_ajax\_mlpp\_create\_new\_ng\_gallery', array($this, 'mlpp\_create\_new\_ng\_gallery')); |
  | 262 | 260 |  |
  | 263 |  | ~~add\_action('wp\_ajax\_nopriv\_mg\_add\_to\_ng\_gallery', array($this, 'mg\_add\_to\_ng\_gallery'));~~ |
  | 264 |  | ~~add\_action('wp\_ajax\_mg\_add\_to\_ng\_gallery', array($this, 'mg\_add\_to\_ng\_gallery'));~~ |
  | 265 |  |  |
  | 266 |  | ~~add\_action('wp\_ajax\_nopriv\_mgmlp\_add\_to\_gallery', array($this, 'mgmlp\_add\_to\_gallery'));~~ |
  | 267 |  | ~~add\_action('wp\_ajax\_mgmlp\_add\_to\_gallery', array($this, 'mgmlp\_add\_to\_gallery'));~~ |
  | 268 |  |  |
  | 269 | 261 | add\_action('wp\_ajax\_nopriv\_display\_folder\_nav\_ajax', array($this, 'display\_folder\_nav\_ajax')); |
  | 270 | 262 | add\_action('wp\_ajax\_mgmlp\_display\_folder\_nav\_ajax', array($this, 'display\_folder\_nav\_ajax')); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L291) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L283) |  |
  | 291 | 283 | add\_action('wp\_ajax\_mlf\_hide\_info', array($this, 'mlf\_hide\_info')); |
  | 292 | 284 |  |
  | 293 |  | ~~add\_action('wp\_ajax\_nopriv\_set\_floating\_filetree', array($this, 'set\_floating\_filetree'));~~ |
  | 294 |  | ~~add\_action('wp\_ajax\_set\_floating\_filetree', array($this, 'set\_floating\_filetree'));~~ |
  | 295 |  |  |
  | 296 | 285 | add\_action('wp\_ajax\_nopriv\_mlfp\_set\_scaling', array($this, 'mlfp\_set\_scaling')); |
  | 297 | 286 | add\_action('wp\_ajax\_mlfp\_set\_scaling', array($this, 'mlfp\_set\_scaling')); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L455) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L444) |  |
  | 455 | 444 | } |
  | 456 | 445 |  |
  |  | 446 | // Check if the current user has the capability to upload files |
  |  | 447 | if(!current\_user\_can('upload\_files')){ |
  |  | 448 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 449 | } |
  |  | 450 |  |
  | 457 | 451 | if ((isset($\_POST['src'])) && (strlen(trim($\_POST['src'])) > 0)) |
  | 458 | 452 | $download\_file = trim(sanitize\_url($\_POST['src'])); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L498) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L492) |  |
  | 498 | 492 | } |
  | 499 | 493 |  |
  |  | 494 | // Check if the current user has the capability to upload files |
  |  | 495 | if(!current\_user\_can('upload\_files')){ |
  |  | 496 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 497 | } |
  |  | 498 |  |
  | 500 | 499 | if ((isset($\_POST['src'])) && (strlen(trim($\_POST['src'])) > 0)) |
  | 501 | 500 | $download\_file = trim(sanitize\_url($\_POST['src'])); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L532) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L531) |  |
  | 532 | 531 | exit(esc\_html\_\_('Missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 533 | 532 | } |
  |  | 533 |  |
  |  | 534 | // Check if the current user has the capability to upload files |
  |  | 535 | if(!current\_user\_can('upload\_files')){ |
  |  | 536 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 537 | } |
  |  | 538 |  |
  | 534 | 539 |  |
  | 535 | 540 | $this->remove\_protected\_folders(); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L1709) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L1714) |  |
  | 1709 | 1714 | //$folders\_found = false; |
  | 1710 | 1715 |  |
  |  | 1716 | // Check if the current user has the capability to upload files |
  |  | 1717 | if(!current\_user\_can('upload\_files')){ |
  |  | 1718 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 1719 | } |
  |  | 1720 |  |
  | 1711 | 1721 | $sort\_order = get\_option(MAXGALLERIA\_MEDIA\_LIBRARY\_SORT\_ORDER); |
  | 1712 | 1722 | $sort\_type = trim(get\_option( MAXGALLERIA\_MLF\_SORT\_TYPE )); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L1768) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L1778) |  |
  | 1768 | 1778 |  |
  | 1769 | 1779 | global $wpdb; |
  |  | 1780 |  |
  |  | 1781 | // Check if the current user has the capability to upload files |
  |  | 1782 | if(!current\_user\_can('upload\_files')){ |
  |  | 1783 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 1784 | } |
  | 1770 | 1785 |  |
  | 1771 | 1786 | $sort\_order = get\_option(MAXGALLERIA\_MEDIA\_LIBRARY\_SORT\_ORDER); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L1821) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L1836) |  |
  | 1821 | 1836 | } |
  | 1822 | 1837 |  |
  |  | 1838 | // Check if the current user has the capability to upload files |
  |  | 1839 | if(!current\_user\_can('upload\_files')){ |
  |  | 1840 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 1841 | } |
  |  | 1842 |  |
  | 1823 | 1843 | if ((isset($\_POST['current\_folder\_id'])) && (strlen(trim($\_POST['current\_folder\_id'])) > 0)) |
  | 1824 | 1844 | $current\_folder\_id = intval(trim(sanitize\_text\_field($\_POST['current\_folder\_id']))); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L1839) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L1859) |  |
  | 1839 | 1859 | exit(esc\_html\_\_('missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 1840 | 1860 | } |
  |  | 1861 |  |
  |  | 1862 | // Check if the current user has the capability to upload files |
  |  | 1863 | if(!current\_user\_can('upload\_files')){ |
  |  | 1864 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 1865 | } |
  | 1841 | 1866 |  |
  | 1842 | 1867 | if ((isset($\_POST['current\_folder\_id'])) && (strlen(trim($\_POST['current\_folder\_id'])) > 0)) |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L2913) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L2938) |  |
  | 2913 | 2938 | } |
  | 2914 | 2939 |  |
  |  | 2940 | // Check if the current user has the capability to upload files |
  |  | 2941 | if(!current\_user\_can('upload\_files')){ |
  |  | 2942 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 2943 | } |
  |  | 2944 |  |
  | 2915 | 2945 | if ((isset($\_POST['serial\_gallery\_image\_ids'])) && (strlen(trim($\_POST['serial\_gallery\_image\_ids'])) > 0)) |
  | 2916 | 2946 | $serial\_gallery\_image\_ids = trim(stripslashes(strip\_tags($\_POST['serial\_gallery\_image\_ids']))); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L2967) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L2997) |  |
  | 2967 | 2997 | } |
  | 2968 | 2998 |  |
  |  | 2999 | // Check if the current user has the capability to upload files |
  |  | 3000 | if(!current\_user\_can('upload\_files')){ |
  |  | 3001 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 3002 | } |
  |  | 3003 |  |
  | 2969 | 3004 | if ((isset($\_POST['search\_value'])) && (strlen(trim($\_POST['search\_value'])) > 0)) |
  | 2970 | 3005 | $search\_value = trim(sanitize\_text\_field($\_POST['search\_value'])); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L3491) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L3526) |  |
  | 3491 | 3526 | } |
  | 3492 | 3527 |  |
  |  | 3528 | // Check if the current user has the capability to upload files |
  |  | 3529 | if(!current\_user\_can('upload\_files')){ |
  |  | 3530 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 3531 | } |
  |  | 3532 |  |
  | 3493 | 3533 | if ((isset($\_POST['parent\_folder'])) && (strlen(trim($\_POST['parent\_folder'])) > 0)) |
  | 3494 | 3534 | $parent\_folder\_id = intval(trim(sanitize\_text\_field($\_POST['parent\_folder']))); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L4008) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L4048) |  |
  | 4008 | 4048 | } |
  | 4009 | 4049 |  |
  |  | 4050 | // Check if the current user has the capability to upload files |
  |  | 4051 | if(!current\_user\_can('upload\_files')){ |
  |  | 4052 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 4053 | } |
  |  | 4054 |  |
  | 4010 | 4055 | if ((isset($\_POST['folder'])) && (strlen(trim($\_POST['folder'])) > 0)) |
  | 4011 | 4056 | $current\_folder\_id = intval(trim(sanitize\_textarea\_field($\_POST['folder']))); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L4368) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L4413) |  |
  | 4368 | 4413 | exit(esc\_html\_\_('missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 4369 | 4414 | } |
  | 4370 |  |  |
  |  | 4415 |  |
  |  | 4416 | // Check if the current user has the capability to upload files |
  |  | 4417 | if(!current\_user\_can('upload\_files')){ |
  |  | 4418 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 4419 | } |
  |  | 4420 |  |
  | 4371 | 4421 | update\_option('mlpp\_show\_template\_ad', "off"); |
  | 4372 | 4422 |  |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L4458) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L4508) |  |
  | 4458 | 4508 | exit( esc\_html\_\_('missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 4459 | 4509 | } |
  |  | 4510 |  |
  |  | 4511 | // Check if the current user has the capability to upload files |
  |  | 4512 | if(!current\_user\_can('upload\_files')){ |
  |  | 4513 | exit(esc\_html\_\_('You do not have the capability to regenerate thumbnail images.','maxgalleria-media-library')); |
  |  | 4514 | } |
  | 4460 | 4515 |  |
  | 4461 | 4516 | if ((isset($\_POST['serial\_image\_ids'])) && (strlen(trim($\_POST['serial\_image\_ids'])) > 0)) |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L4806) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L4861) |  |
  | 4806 | 4861 | global $is\_IIS; |
  | 4807 | 4862 |  |
  |  | 4863 | // Check if the current user has the capability to upload files |
  |  | 4864 | if(!current\_user\_can('upload\_files')){ |
  |  | 4865 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 4866 | } |
  |  | 4867 |  |
  | 4808 | 4868 | @error\_reporting( 0 ); // Don't break the JSON result |
  | 4809 | 4869 |  |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L4874) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L4934) |  |
  | 4874 | 4934 | } |
  | 4875 | 4935 |  |
  |  | 4936 | // Check if the current user has the capability to upload files |
  |  | 4937 | if(!current\_user\_can('upload\_files')){ |
  |  | 4938 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 4939 | } |
  |  | 4940 |  |
  | 4876 | 4941 | if(get\_option(MLFP\_BDA\_AUTO\_PROTECT\_DISABLED, 'off') == 'on') { |
  | 4877 | 4942 | $this->bdp\_autoprotect = 'on'; |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L4888) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L4953) |  |
  | 4888 | 4953 | exit(esc\_html\_\_('missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 4889 | 4954 | } |
  | 4890 |  |  |
  |  | 4955 |  |
  |  | 4956 | // Check if the current user has the capability to upload files |
  |  | 4957 | if(!current\_user\_can('upload\_files')){ |
  |  | 4958 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 4959 | } |
  |  | 4960 |  |
  | 4891 | 4961 | if ((isset($\_POST['checked'])) && (strlen(trim($\_POST['checked'])) > 0)) |
  | 4892 | 4962 | $checked = trim(sanitize\_text\_field($\_POST['checked'])); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L5052) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L5122) |  |
  | 5052 | 5122 | } |
  | 5053 | 5123 |  |
  |  | 5124 | // Check if the current user has the capability to upload files |
  |  | 5125 | if(!current\_user\_can('upload\_files')){ |
  |  | 5126 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 5127 | } |
  |  | 5128 |  |
  | 5054 | 5129 | if ((isset($\_POST['folder\_id'])) && (strlen(trim($\_POST['folder\_id'])) > 0)) |
  | 5055 | 5130 | $folder\_id = intval(trim(sanitize\_text\_field($\_POST['folder\_id']))); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L5194) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L5269) |  |
  | 5194 | 5269 | exit(esc\_html\_\_('missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 5195 | 5270 | } |
  | 5196 |  |  |
  |  | 5271 |  |
  |  | 5272 | // Check if the current user has the capability to upload files |
  |  | 5273 | if(!current\_user\_can('upload\_files')){ |
  |  | 5274 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 5275 | } |
  |  | 5276 |  |
  | 5197 | 5277 | $current\_user\_id = get\_current\_user\_id(); |
  | 5198 | 5278 |  |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L5206) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L5286) |  |
  | 5206 | 5286 | exit(esc\_html\_\_('missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 5207 | 5287 | } |
  |  | 5288 |  |
  |  | 5289 | // Check if the current user has the capability to upload files |
  |  | 5290 | if(!current\_user\_can('upload\_files')){ |
  |  | 5291 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 5292 | } |
  | 5208 | 5293 |  |
  | 5209 | 5294 | if ((isset($\_POST['scaling\_status'])) && (strlen(trim($\_POST['scaling\_status'])) > 0)) |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L5393) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L5478) |  |
  | 5393 | 5478 | exit(esc\_html\_\_('missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 5394 | 5479 | } |
  | 5395 |  |  |
  |  | 5480 |  |
  |  | 5481 | // Check if the current user has the capability to upload files |
  |  | 5482 | if(!current\_user\_can('upload\_files')){ |
  |  | 5483 | exit(esc\_html\_\_('You do not have the capability to sync files.','maxgalleria-media-library')); |
  |  | 5484 | } |
  |  | 5485 |  |
  | 5396 | 5486 | if ((isset($\_POST['phase'])) && (strlen(trim($\_POST['phase'])) > 0)) |
  | 5397 | 5487 | $phase = trim(sanitize\_text\_field($\_POST['phase'])); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L5530) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L5620) |  |
  | 5530 | 5620 | exit(esc\_html\_\_('missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 5531 | 5621 | } |
  |  | 5622 |  |
  |  | 5623 | // Check if the current user has the capability to upload files |
  |  | 5624 | if(!current\_user\_can('upload\_files')){ |
  |  | 5625 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 5626 | } |
  | 5532 | 5627 |  |
  | 5533 | 5628 | if ((isset($\_POST['phase'])) && (strlen(trim($\_POST['phase'])) > 0)) |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L6182) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L6277) |  |
  | 6182 | 6277 | exit(esc\_html\_\_('Missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 6183 | 6278 | } |
  | 6184 |  | //error\_log("mlfp\_process\_bdp 1"); |
  | 6185 |  |  |
  |  | 6279 |  |
  |  | 6280 | // Check if the current user has the capability to upload files |
  |  | 6281 | if(!current\_user\_can('upload\_files')){ |
  |  | 6282 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 6283 | } |
  |  | 6284 |  |
  | 6186 | 6285 | $activate\_mlfp\_bdp = $this->get\_ajax\_paramater('activate\_mlfp\_bdp'); |
  | 6187 | 6286 | $disable\_listing = $this->get\_ajax\_paramater('disable\_listing'); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L6306) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L6405) |  |
  | 6306 | 6405 | exit(esc\_html\_\_('Missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 6307 | 6406 | } |
  |  | 6407 |  |
  |  | 6408 | // Check if the current user has the capability to upload files |
  |  | 6409 | if(!current\_user\_can('upload\_files')){ |
  |  | 6410 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 6411 | } |
  |  | 6412 |  |
  | 6308 | 6413 | $no\_access\_page\_id = intval($this->get\_ajax\_paramater('no\_access\_page\_id')); |
  | 6309 | 6414 | $no\_access\_page\_name = $this->get\_ajax\_paramater('no\_access\_page\_name'); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L6365) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L6470) |  |
  | 6365 | 6470 | } |
  | 6366 | 6471 |  |
  |  | 6472 | // Check if the current user has the capability to upload files |
  |  | 6473 | if(!current\_user\_can('upload\_files')){ |
  |  | 6474 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 6475 | } |
  |  | 6476 |  |
  | 6367 | 6477 | $next\_id = intval($this->get\_ajax\_paramater('file\_id', '')); |
  | 6368 | 6478 |  |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L6695) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L6805) |  |
  | 6695 | 6805 | exit(esc\_html\_\_('Missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 6696 | 6806 | } |
  | 6697 |  |  |
  |  | 6807 |  |
  |  | 6808 | // Check if the current user has the capability to upload files |
  |  | 6809 | if(!current\_user\_can('upload\_files')){ |
  |  | 6810 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 6811 | } |
  |  | 6812 |  |
  | 6698 | 6813 | if ((isset($\_POST['image\_id'])) && (strlen(trim($\_POST['image\_id'])) > 0)) |
  | 6699 | 6814 | $image\_id = intval(trim(sanitize\_text\_field($\_POST['image\_id']))); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L6774) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L6889) |  |
  | 6774 | 6889 | exit(esc\_html\_\_('Missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 6775 | 6890 | } |
  |  | 6891 |  |
  |  | 6892 | // Check if the current user has the capability to upload files |
  |  | 6893 | if(!current\_user\_can('upload\_files')){ |
  |  | 6894 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 6895 | } |
  | 6776 | 6896 |  |
  | 6777 | 6897 | $image\_id = intval($this->get\_ajax\_paramater('image\_id', 0)); |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L6828) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L6948) |  |
  | 6828 | 6948 | } |
  | 6829 | 6949 |  |
  |  | 6950 | // Check if the current user has the capability to upload files |
  |  | 6951 | if(!current\_user\_can('upload\_files')){ |
  |  | 6952 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 6953 | } |
  |  | 6954 |  |
  | 6830 | 6955 | $image\_id = intval($this->get\_ajax\_paramater('image\_id', 0)); |
  | 6831 | 6956 |  |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L6890) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L7015) |  |
  | 6890 | 7015 | } |
  | 6891 | 7016 |  |
  |  | 7017 | // Check if the current user has the capability to upload files |
  |  | 7018 | if(!current\_user\_can('upload\_files')){ |
  |  | 7019 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 7020 | } |
  |  | 7021 |  |
  | 6892 | 7022 | $page\_id = intval($this->get\_ajax\_paramater('page\_id', 0)); |
  | 6893 | 7023 |  |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L6969) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L7099) |  |
  | 6969 | 7099 | exit(esc\_html\_\_('Missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 6970 | 7100 | } |
  | 6971 |  |  |
  |  | 7101 |  |
  |  | 7102 | // Check if the current user has the capability to upload files |
  |  | 7103 | if(!current\_user\_can('upload\_files')){ |
  |  | 7104 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 7105 | } |
  |  | 7106 |  |
  | 6972 | 7107 | $new\_block\_ip = $this->get\_ajax\_paramater('new\_block\_ip'); |
  | 6973 | 7108 |  |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L7025) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L7160) |  |
  | 7025 | 7160 | } |
  | 7026 | 7161 |  |
  |  | 7162 | // Check if the current user has the capability to upload files |
  |  | 7163 | if(!current\_user\_can('upload\_files')){ |
  |  | 7164 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 7165 | } |
  |  | 7166 |  |
  | 7027 | 7167 | $data = $this->get\_blocked\_ips(); |
  | 7028 | 7168 |  |
  | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3139954#L7042) | […](/browser/media-library-plus/trunk/media-library-plus.php?rev=3143036#L7182) |  |
  | 7042 | 7182 | } |
  | 7043 | 7183 |  |
  |  | 7184 | // Check if the current user has the capability to upload files |
  |  | 7185 | if(!current\_user\_can('upload\_files')){ |
  |  | 7186 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 7187 | } |
  |  | 7188 |  |
  | 7044 | 7189 | if ((isset($\_POST['serial\_ips'])) && (strlen(trim($\_POST['serial\_ips'])) > 0)) { |
  | 7045 | 7190 | $unblock\_ips = trim(stripslashes(sanitize\_text\_field($\_POST['serial\_ips']))); |
* ## [media-library-plus/trunk/mlp-reset.php](/changeset/3143036/media-library-plus/trunk/mlp-reset.php "Show the changeset 3143036 restricted to media-library-plus/trunk/mlp-reset.php")

  | [r3139954](/browser/media-library-plus/trunk/mlp-reset.php?rev=3139954#L6 "Show revision 3139954 of this file in browser") | [r3143036](/browser/media-library-plus/trunk/mlp-reset.php?rev=3143036#L6 "Show revision 3143036 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Author: Max Foundry |
  | 7 | 7 | Author URI: http://maxfoundry.com |
  | 8 |  | Version: 8.2.~~3~~ |
  |  | 8 | Version: 8.2.4 |
  | 9 | 9 | Copyright 2015-2021 Max Foundry, LLC (http://maxfoundry.com) |
  | 10 | 10 | Text Domain: mlp-reset |
  | […](/browser/media-library-plus/trunk/mlp-reset.php?rev=3139954#L52) | […](/browser/media-library-plus/trunk/mlp-reset.php?rev=3143036#L52) |  |
  | 52 | 52 | add\_action('wp\_ajax\_nopriv\_mlfr\_remove\_tables', 'mlfr\_remove\_tables'); |
  | 53 | 53 | add\_action('wp\_ajax\_mlfr\_remove\_tables', 'mlfr\_remove\_tables'); |
  |  | 54 |  |
  |  | 55 | // run to ensure we can check user capability |
  |  | 56 | add\_action('init', 'mlfr\_get\_upload\_status'); |
  |  | 57 |  |
  |  | 58 | function mlfr\_get\_upload\_status() { |
  |  | 59 | $data = get\_userdata(get\_current\_user\_id()); |
  |  | 60 | } |
  | 54 | 61 |  |
  | 55 | 62 | function mlp\_reset\_menu() { |
  | […](/browser/media-library-plus/trunk/mlp-reset.php?rev=3139954#L147) | […](/browser/media-library-plus/trunk/mlp-reset.php?rev=3143036#L154) |  |
  | 147 | 154 | exit(esc\_html\_\_('Missing nonce! Please refresh this page.','maxgalleria-media-library')); |
  | 148 | 155 | } |
  | 149 |  |  |
  |  | 156 |  |
  |  | 157 | // Check if the current user has the capability to upload files |
  |  | 158 | if(!current\_user\_can('upload\_files')){ |
  |  | 159 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 160 | } |
  |  | 161 |  |
  | 150 | 162 | $sql = "delete from $wpdb->options where option\_name = 'mgmlp\_upload\_folder\_name'"; |
  | 151 | 163 | $wpdb->query($sql); |
  | […](/browser/media-library-plus/trunk/mlp-reset.php?rev=3139954#L481) | […](/browser/media-library-plus/trunk/mlp-reset.php?rev=3143036#L493) |  |
  | 481 | 493 | } |
  | 482 | 494 |  |
  |  | 495 | // Check if the current user has the capability to upload files |
  |  | 496 | if(!current\_user\_can('upload\_files')){ |
  |  | 497 | exit(esc\_html\_\_('You do not have the capability to upload files.','maxgalleria-media-library')); |
  |  | 498 | } |
  |  | 499 |  |
  | 483 | 500 | $mlfr\_bda = false; |
  | 484 | 501 | $mlfr\_bda\_ips = false; |
* ## [media-library-plus/trunk/readme.txt](/changeset/3143036/media-library-plus/trunk/readme.txt "Show the changeset 3143036 restricted to media-library-plus/trunk/readme.txt")

  | [r3139954](/browser/media-library-plus/trunk/readme.txt?rev=3139954#L4 "Show revision 3139954 of this file in browser") | [r3143036](/browser/media-library-plus/trunk/readme.txt?rev=3143036#L4 "Show revision 3143036 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 4.0 |
  | 5 | 5 | Tested up to: 6.6 |
  | 6 |  | Stable tag: 8.2.~~3~~ |
  |  | 6 | Stable tag: 8.2.4 |
  | 7 | 7 | License: GPLv2 or later |
  | 8 | 8 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/media-library-plus/trunk/readme.txt?rev=3139954#L198) | […](/browser/media-library-plus/trunk/readme.txt?rev=3143036#L198) |  |
  | 198 | 198 |  |
  | 199 | 199 | == Changelog == |
  |  | 200 | = 8.2.4 = |
  |  | 201 | \* Additional security enhancements added |
  |  | 202 |  |
  | 200 | 203 | = 8.2.3 = |
  | 201 | 204 | \* Security enhancements added |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3143036)
* [Zip Archive](?format=zip&new=3143036)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

