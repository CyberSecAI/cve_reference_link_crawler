=== Content from github.com_64c842c6_20250110_110332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenobserve%2Fopenobserve%2Fsecurity%2Fadvisories%2FGHSA-hx23-g7m8-h76j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenobserve%2Fopenobserve%2Fsecurity%2Fadvisories%2FGHSA-hx23-g7m8-h76j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=openobserve%2Fopenobserve)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openobserve](/openobserve)
/
**[openobserve](/openobserve/openobserve)**
Public

* [Notifications](/login?return_to=%2Fopenobserve%2Fopenobserve) You must be signed in to change notification settings
* [Fork
  520](/login?return_to=%2Fopenobserve%2Fopenobserve)
* [Star
   14k](/login?return_to=%2Fopenobserve%2Fopenobserve)

* [Code](/openobserve/openobserve)
* [Issues
  440](/openobserve/openobserve/issues)
* [Pull requests
  23](/openobserve/openobserve/pulls)
* [Discussions](/openobserve/openobserve/discussions)
* [Actions](/openobserve/openobserve/actions)
* [Projects
  0](/openobserve/openobserve/projects)
* [Security](/openobserve/openobserve/security)
* [Insights](/openobserve/openobserve/pulse)

Additional navigation options

* [Code](/openobserve/openobserve)
* [Issues](/openobserve/openobserve/issues)
* [Pull requests](/openobserve/openobserve/pulls)
* [Discussions](/openobserve/openobserve/discussions)
* [Actions](/openobserve/openobserve/actions)
* [Projects](/openobserve/openobserve/projects)
* [Security](/openobserve/openobserve/security)
* [Insights](/openobserve/openobserve/pulse)

# Stored XSS may lead to complete account takeover

High

[prabhatsharma](/prabhatsharma)
published
GHSA-hx23-g7m8-h76j
Jul 25, 2024

## Package

OpenObserve
(All release candidates)

## Affected versions

0.9.1

## Patched versions

None

## Description

## Details

*Discussions about the issue being disclosed, the underlying behaviour at fault, etc*

The OpenObserve platform provides the ability to filter logs in a dashboard by the values uploaded in a given log. The platform however does not sanitize user input in the filter selection menu which may result in complete account takeover.

It has been noted that the front-end uses `DOMPurify` or Vue templating to escape XSS extensively, however certain areas of the front end lack this XSS protection. When combining the missing protection with the insecure authentication handling that the front-end uses, a malicious user may be able to take over any victims account provided they meet the exploitation steps.

### PoC

*Complete instructions, including specific configuration details, to reproduce the vulnerability.*

The following Python script can be used to upload a log which leaks the username and password via the base64 encoded string stored in localstorage under the key `access_token`. This PoC could be expanded upon further by an attacker to send the access token to an attacker controlled source resulting in complete account takeover.

```
import json

import httpx

payload = {
    "level": "info",
    "ingestion": "<img src=null onerror=\"javascript:alert(localStorage.getItem(\'access_token\'))\"></img>"
}

auth = httpx.BasicAuth(username="REDACTED", password="REDACTED")
client = httpx.Client(auth=auth)
resp = client.post(
    "http://DOMAIN_HERE/api/default/default/_json",
    content=f'[{json.dumps(payload)}]'
)

print(resp.text)
```
#### Reproduction steps

1. Modify the above script to have valid authentication credentials and an OpenObserve url
2. Run script provided above to insert the malicious log into a stream
3. Within the OpenObserve instance, complete the following actions:
4. Open the "Dashboards" sidebar
5. Create a new panel using the "Add panel" button
6. Add the "ingestion" label as a Filter
7. Under the filters section, click on "ingestion"
8. Select the filters drop down
9. Observe the XSS executing and displaying the current `username` and `password` encoded using base64

Exploitation of this issue can in be seen in the video below:

[Screencast from 16-03-24 14:39:58.webm](https://github.com/openobserve/openobserve/assets/47520067/e850f03d-b2ba-47b7-b795-441e593d59f5)

##### Account takeover

By having access to the user's `username` and `password`, a malicious user could then simply sign in to the platform and change the user's password. By doing this, a malicious user could lock the legitimate user out of the platform while maintaining access themselves.

## Impact

*What is the impact of the issue being disclosed.*

An attacker could abuse this vulnerability to retrieve the `username` and `password` of any user. These details could be abused in a way which would then result in complete account takeover.

## Likelihood

*What is the exploit likelihood of the issue being disclosed.*

As this vulnerability exists under the following conditions:

* The malicious JavaScript can be included in any field in a log from an end application
* The JavaScript is executed when the filter drop down is populated, without the user clicking on the malicious payload

I consider this to be a likely possibility of exploitation. Further, I'd consider setting filters for a dashboard to be a part of the standard usage flow for this software which further increases the likelihood of exploitation.

Further to this, as the malicious payloads can be uploaded via logs this may be able to be done unauthenticated by a malicious user who has access to an end application which provides logs to an OpenObserve instance.

## Mitigations

The storage of the users `username` and `password` in local storage as a base64 encoded blob which is easily retrieved constitutes a critical security flaw in the underlying authentication and authorization of the platform. Modifying client side session storage to use something like a session token would help to mitigate account takeover by removing the ability for a malicious attacker to know the user's password in the event of compromise.

Further to this, ensuring all areas of the platform which accept user input are correctly sanitized would help to reduce the attack surface and possibly exploitation in OpenObserve. The below list is a non-exhaustive list of comprised areas retrieved using the tool `semgrep`:

* `Line 653┆ <div v-html="opt"></div> in DashboardMapQueryBuilder.vue`
* `Line 855┆ <div v-html="opt"></div> in DashboardQueryBuilder.vue`
* `Line 653┆ <div v-html="opt"></div> in DashboardSankeyChartBuilder.vue`

These methods could be likely be replaced with something along the following lines to mitigate the XSS:

* `v-html="DOMPurify.sanitize(htmlContent)"`

Further areas that may also be vulnerable can be found using the following command, `semgrep scan --config auto`. I have not investigated whether or not further issues highlighted in the output are vulnerable to XSS.

I would like to note that sanitizing XSS on the front end does not fix the underlying issues in regard to how the platform handles session storage. While resolving this disclosure, consideration should be given to the proposed changes to passwords being stored in plaintext in a user's browser.

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CVE ID

CVE-2024-41808

### Weaknesses

No CWEs

### Credits

* [![@Skelmis](https://avatars.githubusercontent.com/u/47520067?s=40&v=4)](/Skelmis)
  [Skelmis](/Skelmis)
  Reporter
* [![@omkarK06](https://avatars.githubusercontent.com/u/127078473?s=40&v=4)](/omkarK06)
  [omkarK06](/omkarK06)
  Remediation developer
* [![@oasisk](https://avatars.githubusercontent.com/u/35160958?s=40&v=4)](/oasisk)
  [oasisk](/oasisk)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


