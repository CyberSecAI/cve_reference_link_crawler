
# [febiNJ](https://febin0x4e4a.wordpress.com/)

## InfoSec Enthusiast

Menu
[Skip to content](#content)

* [Home](https://febin0x4e4a.wordpress.com/)
* [About](https://febin0x4e4a.wordpress.com/about/)

Search

Search for:

# Stored XSS in FileBrowser leads to Admin account Takeover + RCE

[15th September 202318th September 2023](https://febin0x4e4a.wordpress.com/2023/09/15/xss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser/) / [FebiNJ](https://febin0x4e4a.wordpress.com/author/febin0x4e4a/)

**CVE-2023-39612**

### Description

A Cross-Site Scripting vulnerability is discovered in FileBrowser *below v2.25.0* in which an attacker with a non-admin user account inside the FileBrowser instance can create malicious HTML & JS files, craft them in a specific way, and send the HTML file’s link to the Admin to achieve Account takeover via XSS bypassing the Content-Security-Policy.

**Proof-Of-Concept**:

// *xss.js*

```

alert(document.cookie);

```

// *xss.htm*

```

<script src="/api/raw/poc/xss.js?auth=[jwt_token of the Low Privileged user]"></script>

```

1. Create a folder named “poc” as the non-admin user.
2. Create the 2 files as above (xss.htm and xss.js) under the poc folder.
3. Craft the XSS URL as below and open it as the Admin user to verify the XSS.

```

http://your_filebrowser_ip:port//api/raw/poc/xss.htm?auth=[non-admin user's jwt token]&inline=true

```

It will trigger an alert pop-up with Admin’s Cookie.

#### Explanation

* The parameter “?auth=[non-admin token]” is added in the URL so that when the Admin opens the URL it will fetch those HTML/js files that are created by the non-admin user, otherwise FileBrowser will use the Admin’s original jwt token that’s been stored as Cookie thus leading to a “404 Not Found” Error. This is because those files are created by the non-admin user, so if the API tries to fetch them with Admin’s token it will lead to an error, the API also accepts the jwt token inside a URL get parameter “?auth=”. So, the non-admin user can deliberately supply his own JWT token in the malicious URL for a successful exploitation
* The “?inline=true” parameter is included in the crafted URL because without that parameter FileBrowser will treat the HTML file as an attachment and will download it as a file, so by having “inline=true” the HTML file will be treated as an webpage, and execute the javascript.
* Content-Security-Policy(CSP) is bypassed because FileBrowser sets CSP “default-src” to ‘self’. As the malicious JS is also loaded from the same site, it will get executed.

### Impact

This vulnerability is capable of Admin account takeover. Admin can even run system shell commands and access the filesystem, thus leading to Arbitrary Command execution.

**Fix**:

They fixed the vulnerability by adding a CSP that blocks any Javascript from executing on /api/raw endpoint.

<https://github.com/filebrowser/filebrowser/commit/b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30>

Update to the latest version if you are using Filebrowser.

**Filebrowser v2.25.0 is released**

<https://github.com/filebrowser/filebrowser/releases>

### Share this:

* [Twitter](https://febin0x4e4a.wordpress.com/2023/09/15/xss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser/?share=twitter "Click to share on Twitter")
* [Facebook](https://febin0x4e4a.wordpress.com/2023/09/15/xss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

[Uncategorized](https://febin0x4e4a.wordpress.com/category/uncategorised/)

# Post navigation

[← XSS vulnerability in Koha integrated library system](https://febin0x4e4a.wordpress.com/2023/01/11/xss-vulnerability-in-koha-integrated-library-system/)[Stored-XSS to Admin Account Takeover/RCE in Bludit CMS [CRITICAL] →](https://febin0x4e4a.wordpress.com/2023/10/06/stored-xss-to-admin-account-takeover-rce-critical/)

### Leave a comment [Cancel reply](/2023/09/15/xss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser/#respond)

Δ

Search for:

# Recent Posts

* [Privilege Escalation Vulnerability in Balena Etcher Software](https://febin0x4e4a.wordpress.com/2024/08/22/privilege-escalation-vulnerability-in-balena-etcher-software/)
* [CVE-2024-28739, CVE-2024-28740: XSS to One-Click RCE in Koha ILS](https://febin0x4e4a.wordpress.com/2024/03/07/xss-to-one-click-rce-in-koha-ils/)
* [CVE-2023-44452, CVE-2023-51698: CBT File Parsing Argument Injection that affected Popular Linux Distros](https://febin0x4e4a.wordpress.com/2024/01/17/cve-2023-44452-cve-2023-51698-cbt-file-parsing-argument-injection-that-affected-popular-linux-distros/)
* [CVE-2023-44451, CVE-2023-52076: EPUB File Parsing Directory Traversal RCE Vulnerability affecting popular distros](https://febin0x4e4a.wordpress.com/2024/01/17/cve-2023-44451-cve-2023-52076-epub-file-parsing-directory-traversal-rce-vulnerability-affecting-popular-distros/)
* [Zip Path Traversal in Asus Smartphone’s default FileManager App.](https://febin0x4e4a.wordpress.com/2024/01/10/zip-path-traversal-in-asus-smartphones-default-filemanager-app/)
# Recent Comments

# Archives

* [August 2024](https://febin0x4e4a.wordpress.com/2024/08/)
* [March 2024](https://febin0x4e4a.wordpress.com/2024/03/)
* [January 2024](https://febin0x4e4a.wordpress.com/2024/01/)
* [December 2023](https://febin0x4e4a.wordpress.com/2023/12/)
* [October 2023](https://febin0x4e4a.wordpress.com/2023/10/)
* [September 2023](https://febin0x4e4a.wordpress.com/2023/09/)
* [January 2023](https://febin0x4e4a.wordpress.com/2023/01/)
* [March 2022](https://febin0x4e4a.wordpress.com/2022/03/)
* [January 2022](https://febin0x4e4a.wordpress.com/2022/01/)
# Categories

* [Uncategorized](https://febin0x4e4a.wordpress.com/category/uncategorised/)

[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* [Comment](https://febin0x4e4a.wordpress.com/2023/09/15/xss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://febin0x4e4a.wordpress.com/wp-content/uploads/2022/01/cropped-hacker-operate-laptop-cartoon-illustration_188898-166.jpg?w=50) febiNJ](https://febin0x4e4a.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Ffebin0x4e4a.wordpress.com%2F2023%2F09%2F15%2Fxss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser%2F&signup_flow=account)
* Privacy
* + [![](https://febin0x4e4a.wordpress.com/wp-content/uploads/2022/01/cropped-hacker-operate-laptop-cartoon-illustration_188898-166.jpg?w=50) febiNJ](https://febin0x4e4a.wordpress.com)
  + [Customize](https://febin0x4e4a.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Ffebin0x4e4a.wordpress.com%2F2023%2F09%2F15%2Fxss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser%2F)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Ffebin0x4e4a.wordpress.com%2F2023%2F09%2F15%2Fxss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/pdF9Nn-1q)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://febin0x4e4a.wordpress.com/2023/09/15/xss-in-filebrowser-leads-to-admin-account-takeover-in-filebrowser/)
  + [View post in Reader](https://wordpress.com/read/blogs/201901473/posts/88)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)

