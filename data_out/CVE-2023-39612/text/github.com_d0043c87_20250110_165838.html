
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffilebrowser%2Ffilebrowser%2Fissues%2F2570)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffilebrowser%2Ffilebrowser%2Fissues%2F2570)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=filebrowser%2Ffilebrowser)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[filebrowser](/filebrowser)
/
**[filebrowser](/filebrowser/filebrowser)**
Public

* [Notifications](/login?return_to=%2Ffilebrowser%2Ffilebrowser) You must be signed in to change notification settings
* [Fork
  3.1k](/login?return_to=%2Ffilebrowser%2Ffilebrowser)
* [Star
   27.5k](/login?return_to=%2Ffilebrowser%2Ffilebrowser)

* [Code](/filebrowser/filebrowser)
* [Issues
  71](/filebrowser/filebrowser/issues)
* [Pull requests
  11](/filebrowser/filebrowser/pulls)
* [Discussions](/filebrowser/filebrowser/discussions)
* [Actions](/filebrowser/filebrowser/actions)
* [Security](/filebrowser/filebrowser/security)
* [Insights](/filebrowser/filebrowser/pulse)

Additional navigation options

* [Code](/filebrowser/filebrowser)
* [Issues](/filebrowser/filebrowser/issues)
* [Pull requests](/filebrowser/filebrowser/pulls)
* [Discussions](/filebrowser/filebrowser/discussions)
* [Actions](/filebrowser/filebrowser/actions)
* [Security](/filebrowser/filebrowser/security)
* [Insights](/filebrowser/filebrowser/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ffilebrowser%2Ffilebrowser%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ffilebrowser%2Ffilebrowser%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Potential XSS in FileBrowser leads to Admin account takeover in Filebrowser #2570

Closed

[febinrev](/febinrev) opened this issue
Jul 25, 2023
¬∑ 4 comments

Closed

# [Potential XSS in FileBrowser leads to Admin account takeover in Filebrowser](#top) #2570

[febinrev](/febinrev) opened this issue
Jul 25, 2023
¬∑ 4 comments

## Comments

[![@febinrev](https://avatars.githubusercontent.com/u/52229330?s=80&u=8803aca8e71c1e4b0d01b5e664fa682d026df1be&v=4)](/febinrev)

Copy link

### **[febinrev](/febinrev)** commented [Jul 25, 2023](#issue-1819677416) ‚Ä¢ edited Loading

| Description A Cross-Site Scripting vulnerability is discovered in FileBrowser in which an attacker with a non-admin user account inside the FileBrowser instance can create malicious HTML & JS files, craft them in a specific way and send the HTML file's link to the Admin to achieve Account takeover via XSS bypassing the Content-Security-Policy. Proof of Concept  // xss.js  ``` alert(document.cookie);  ```  // xss.htm  ``` <script src="/api/raw/poc/xss.js?auth=[jwt_token of the Low Privileged user]"></script>"  ```  1. Create a folder named "poc" as the non-admin user. 2. Create the 2 files as above (xss.htm and xss.js) under the poc folder. 3. Craft the XSS URL as below and open it as the Admin user to verify the XSS.  ``` http://your_filebrowser_ip:port//api/raw/poc/xss.htm?auth=[non-admin user's jwt token]&inline=true  ```  It will trigger an alert pop-up with Admin's Cookie. Explanation  * The parameter "?auth=[non-admin token]" is added in the URL so that when the Admin opens the URL it will fetch those html/js files that are created by the non-admin user, otherwise FileBrowser will use the Admin's original jwt token that's been stored as Cookie thus leading to a "404 Not Found" Error. This is because those files are created by the non-admin user, so if the API tries to fetch them with Admin's token it will lead to an error, the API also accepts the jwt token inside a URL get parameter "?auth=". So, the non-admin user can deliberately supply his own JWT token in the malicious URL for a successful exploitation * The "?inline=true" parameter is included in the crafted URL because without that parameter FileBrowser will treat the HTML file as an attachment and will download it as a file, so by having "inline=true" the HTML file will be treated as a webpage, and execute the javascript. * Content-Security-Policy(CSP) is bypassed because of the fact that FileBrowser sets CSP "default-src" to 'self'. As the malicious JS is also loaded from the same site, it will get executed.  Impact This vulnerability is capable of Admin account takeover. Admin can even run system shell commands and access filesystem, thus leads to Arbitrary Command execution. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
3
 IceWreck, lukasMega, and xabru reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

[![@IceWreck](https://avatars.githubusercontent.com/u/18102790?s=80&u=4f092605e4f2a220e84373c5c953a94f47bd280b&v=4)](/IceWreck)

Copy link

Contributor

### **[IceWreck](/IceWreck)** commented [Jul 26, 2023](#issuecomment-1650864371)

| Huh, shouldn't this be reported in private ? |
| --- |

 üëç
2
 febinrev and blackthorne reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

[![@febinrev](https://avatars.githubusercontent.com/u/52229330?s=80&u=8803aca8e71c1e4b0d01b5e664fa682d026df1be&v=4)](/febinrev)

Copy link

Author

### **[febinrev](/febinrev)** commented [Jul 26, 2023](#issuecomment-1651016511)

| Huh, shouldn't this be reported in private ?   1. I did, i did report it through huntr.dev and also created a github issue with the huntr.dev link to the private report without disclosing anything publicly, I even tried mentioning the devs in comments, they didn't even notice. 2. This Attack has a slightly high complexity, certain conditions has to be met in order for a successful attack. Those conditions include: Attacker with a low privileged user account, a user-interaction is required from the Admin i.e., admin needs to click a crafted URL/link. So, this is not a critical vulnerability, this is a Medium one.    By keeping this in mind, I thought to create a public issue so that the devs will fix it immediately and also the users of Filebrowser can be aware of such attacks and never click on links without examining.   I am sorry and I had no other way to report this privately. |
| --- |

All reactions

Sorry, something went wrong.

[![@IceWreck](https://avatars.githubusercontent.com/u/18102790?s=80&u=4f092605e4f2a220e84373c5c953a94f47bd280b&v=4)](/IceWreck)

Copy link

Contributor

### **[IceWreck](/IceWreck)** commented [Jul 26, 2023](#issuecomment-1651027638) ‚Ä¢ edited Loading

| I was able to reproduce and fix it, will submit an MR for the fix ASAP. |
| --- |

 üëç
1
 febinrev reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[IceWreck](/IceWreck)
added a commit
to IceWreck/filebrowser
that referenced
this issue
[Jul 26, 2023](#ref-commit-8d7a926)
[![@IceWreck](https://avatars.githubusercontent.com/u/18102790?s=40&u=4f092605e4f2a220e84373c5c953a94f47bd280b&v=4)](/IceWreck)

`[fix: xss vulnerability in /api/raw (](/IceWreck/filebrowser/commit/8d7a926095aaa21f339b9e74b407f02ef8d21d4d "fix: xss vulnerability in /api/raw (#2570)")[filebrowser#2570](https://github.com/filebrowser/filebrowser/issues/2570)[)](/IceWreck/filebrowser/commit/8d7a926095aaa21f339b9e74b407f02ef8d21d4d "fix: xss vulnerability in /api/raw (#2570)")`

`[8d7a926](/IceWreck/filebrowser/commit/8d7a926095aaa21f339b9e74b407f02ef8d21d4d)`

[![@IceWreck](https://avatars.githubusercontent.com/u/18102790?s=40&u=4f092605e4f2a220e84373c5c953a94f47bd280b&v=4)](/IceWreck)
[IceWreck](/IceWreck)
mentioned this issue
[Jul 26, 2023](#ref-pullrequest-1821646906)

[fix: xss vulnerability in /api/raw (#2570)
#2572](/filebrowser/filebrowser/pull/2572)
 Merged

5 tasks

[![@febinrev](https://avatars.githubusercontent.com/u/52229330?s=80&u=8803aca8e71c1e4b0d01b5e664fa682d026df1be&v=4)](/febinrev)

Copy link

Author

### **[febinrev](/febinrev)** commented [Jul 26, 2023](#issuecomment-1651036761)

| I was able to reproduce and fix it, will submit an MR for the fix ASAP.  That's appreciated. Thanks. |
| --- |

All reactions

Sorry, something went wrong.

[o1egl](/o1egl)
pushed a commit
that referenced
this issue
[Jul 27, 2023](#ref-commit-b508ac3)
[![@IceWreck](https://avatars.githubusercontent.com/u/18102790?s=40&u=4f092605e4f2a220e84373c5c953a94f47bd280b&v=4)](/IceWreck)

`[fix: xss vulnerability in /api/raw (](/filebrowser/filebrowser/commit/b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30 "fix: xss vulnerability in /api/raw (#2570) (#2572)")[#2570](https://github.com/filebrowser/filebrowser/issues/2570)[) (](/filebrowser/filebrowser/commit/b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30 "fix: xss vulnerability in /api/raw (#2570) (#2572)")[#2572](https://github.com/filebrowser/filebrowser/pull/2572)[)](/filebrowser/filebrowser/commit/b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30 "fix: xss vulnerability in /api/raw (#2570) (#2572)")`

`[b508ac3](/filebrowser/filebrowser/commit/b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30)`

[![@febinrev](https://avatars.githubusercontent.com/u/52229330?s=40&u=8803aca8e71c1e4b0d01b5e664fa682d026df1be&v=4)](/febinrev)
[febinrev](/febinrev)
closed this as [completed](/filebrowser/filebrowser/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 27, 2023](#event-9933979382)

[![@Hariama](https://avatars.githubusercontent.com/u/18269973?s=40&v=4)](/Hariama)
[Hariama](/Hariama)
mentioned this issue
[Jul 29, 2023](#ref-issue-1776644828)

[unWanted behaviour
#2520](/filebrowser/filebrowser/issues/2520)

Closed

[langren1353](/langren1353)
pushed a commit
to langren1353/filebrowser-player
that referenced
this issue
[Jul 31, 2023](#ref-commit-21056e6)
[![@IceWreck](https://avatars.githubusercontent.com/u/18102790?s=40&u=4f092605e4f2a220e84373c5c953a94f47bd280b&v=4)](/IceWreck) [![@langren1353](https://avatars.githubusercontent.com/u/14857127?s=40&v=4)](/langren1353)

`[fix: xss vulnerability in /api/raw (](/langren1353/filebrowser-player/commit/21056e613a5bf6fdd964ab5b375f1227c89c70e1 "fix: xss vulnerability in /api/raw (#2570) (#2572)

(cherry picked from commit b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30)")[filebrowser#2570](https://github.com/filebrowser/filebrowser/issues/2570)[) (](/langren1353/filebrowser-player/commit/21056e613a5bf6fdd964ab5b375f1227c89c70e1 "fix: xss vulnerability in /api/raw (#2570) (#2572)

(cherry picked from commit b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30)")[filebrowser#2572](https://github.com/filebrowser/filebrowser/pull/2572)[)](/langren1353/filebrowser-player/commit/21056e613a5bf6fdd964ab5b375f1227c89c70e1 "fix: xss vulnerability in /api/raw (#2570) (#2572)

(cherry picked from commit b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30)")`
‚Ä¶

`[21056e6](/langren1353/filebrowser-player/commit/21056e613a5bf6fdd964ab5b375f1227c89c70e1)`

```
(cherry picked from commit [b508ac3](https://github.com/langren1353/filebrowser-player/commit/b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30))
```

[langren1353](/langren1353)
pushed a commit
to langren1353/filebrowser-player
that referenced
this issue
[Jul 31, 2023](#ref-commit-64507a8)
[![@IceWreck](https://avatars.githubusercontent.com/u/18102790?s=40&u=4f092605e4f2a220e84373c5c953a94f47bd280b&v=4)](/IceWreck) [![@langren1353](https://avatars.githubusercontent.com/u/14857127?s=40&v=4)](/langren1353)

`[fix: xss vulnerability in /api/raw (](/langren1353/filebrowser-player/commit/64507a8648895f6e5173ded784771e68b72d2031 "fix: xss vulnerability in /api/raw (#2570) (#2572)

(cherry picked from commit b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30)")[filebrowser#2570](https://github.com/filebrowser/filebrowser/issues/2570)[) (](/langren1353/filebrowser-player/commit/64507a8648895f6e5173ded784771e68b72d2031 "fix: xss vulnerability in /api/raw (#2570) (#2572)

(cherry picked from commit b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30)")[filebrowser#2572](https://github.com/filebrowser/filebrowser/pull/2572)[)](/langren1353/filebrowser-player/commit/64507a8648895f6e5173ded784771e68b72d2031 "fix: xss vulnerability in /api/raw (#2570) (#2572)

(cherry picked from commit b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30)")`
‚Ä¶

`[64507a8](/langren1353/filebrowser-player/commit/64507a8648895f6e5173ded784771e68b72d2031)`

```
(cherry picked from commit [b508ac3](https://github.com/langren1353/filebrowser-player/commit/b508ac3d4f7f0f75d6b49c99bdc661a6d2173f30))
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ffilebrowser%2Ffilebrowser%2Fissues%2F2570)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@IceWreck](https://avatars.githubusercontent.com/u/18102790?s=52&v=4)](/IceWreck) [![@febinrev](https://avatars.githubusercontent.com/u/52229330?s=52&v=4)](/febinrev)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

