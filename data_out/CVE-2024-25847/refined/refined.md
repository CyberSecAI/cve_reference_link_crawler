The provided content is related to CVE-2024-25847.

- **Root cause of vulnerability**: The `Send::__construct()` and `importProducts::_addDataToDb` methods in the "Product Catalog (CSV, Excel) Import" module (simpleimportproduct) for PrestaShop have SQL calls that are vulnerable to SQL injection. Input values are not properly sanitized before being used in SQL queries.

- **Weaknesses/vulnerabilities present**:
  - SQL Injection (CWE-89): The module is vulnerable to SQL injection due to improper sanitization of input parameters before constructing SQL queries. Specifically, the `key` parameter in `Send::__construct` and `id_task` in `importProducts::_addDataToDb` are not properly escaped, allowing an attacker to inject malicious SQL code.

- **Impact of exploitation**:
  - Obtain admin access
  - Remove data from the associated PrestaShop database
  - Expose tokens and unlock admin's ajax scripts by copying/pasting data from sensitive tables to the frontend.
  - Hijack emails by rewriting SMTP settings
  - Complete compromise of the database

- **Attack vectors**:
  - Network: The vulnerability can be exploited remotely over the network via HTTP requests.
  - A trivial HTTP call can be used to trigger the vulnerable code.

- **Required attacker capabilities/position**:
  - No specific privileges or user interaction is required to exploit the vulnerability. The attacker can be an unauthenticated guest.

- **Additional details**:
    - The vulnerability was present in versions up to 6.5.0 of the module.
    - Version 6.7.1 includes a fix.
    - The provided patch shows that the fix includes escaping the `key` parameter in the SQL query using `pSQL()` and casting the `id_task` parameter to an integer using `(int)`.
    - The module author has moved its exposed ajax script to the front controller under an unpredictable token. While not eliminating the vulnerability completely, it reduces the attack surface.
    - The advisory warns that even with the fix, SQL injection attacks that use the UNION clause to steal data may still be possible.
    - Recommendations for mitigation include upgrading the module, upgrading PrestaShop to the latest version, changing the default database prefix, and activating OWASP 942's rules on a WAF.