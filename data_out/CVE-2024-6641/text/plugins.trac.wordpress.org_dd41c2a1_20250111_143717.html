

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3151308%2Fwp-security-hardening)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3124437/wp-security-hardening "Changeset 3124437 for wp-security-hardening")
* [Next Change](/changeset/3151313/wp-security-hardening "Changeset 3151313 for wp-security-hardening") →

---

# Changeset [3151308](/changeset/3151308 "Show full changeset") for [wp-security-hardening](/browser/wp-security-hardening?rev=3151308 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/13/2024 10:20:53 AM
([4 months](/timeline?from=2024-09-13T10%3A20%3A53Z&precision=second "See timeline at 09/13/2024 10:20:53 AM") ago)

Author:
astrasecuritysuite
Message:

Update to version 1.2.7 from GitHub

Location:
[wp-security-hardening](/browser/wp-security-hardening?rev=3151308)
Files:

6 edited
1 copied

* [tags/1.2.7](/browser/wp-security-hardening/tags/1.2.7?rev=3151308 "Show entry in browser")
  (copied)
  *(copied from [wp-security-hardening/trunk](/browser/wp-security-hardening/trunk?rev=3124437 "Show original file (revision 3151307)"))*
* [tags/1.2.7/modules/functions.php](/browser/wp-security-hardening/tags/1.2.7/modules/functions.php?rev=3151308 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/1.2.7/modules/hooks.php](/browser/wp-security-hardening/tags/1.2.7/modules/hooks.php?rev=3151308 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [tags/1.2.7/readme.txt](/browser/wp-security-hardening/tags/1.2.7/readme.txt?rev=3151308 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [trunk/modules/functions.php](/browser/wp-security-hardening/trunk/modules/functions.php?rev=3151308 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [trunk/modules/hooks.php](/browser/wp-security-hardening/trunk/modules/hooks.php?rev=3151308 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [trunk/readme.txt](/browser/wp-security-hardening/trunk/readme.txt?rev=3151308 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wp-security-hardening/tags/1.2.7/modules/functions.php](/changeset/3151308/wp-security-hardening/tags/1.2.7/modules/functions.php "Show the changeset 3151308 restricted to wp-security-hardening/tags/1.2.7/modules/functions.php")

  | [r2802042](/browser/wp-security-hardening/trunk/modules/functions.php?rev=2802042#L372 "Show revision 2802042 of this file in browser") | [r3151308](/browser/wp-security-hardening/tags/1.2.7/modules/functions.php?rev=3151308#L372 "Show revision 3151308 of this file in browser") |  |
  | --- | --- | --- |
  | 372 | 372 | 'wp-cerber/wp-cerber.php', |
  | 373 | 373 | 'better-wp-security/better-wp-security.php', |
  |  | 374 | 'getastra-premium/bridge-wordpress.php', |
  | 374 | 375 | ); |
  | 375 | 376 |  |
* ## [wp-security-hardening/tags/1.2.7/modules/hooks.php](/changeset/3151308/wp-security-hardening/tags/1.2.7/modules/hooks.php "Show the changeset 3151308 restricted to wp-security-hardening/tags/1.2.7/modules/hooks.php")

  | [r3124437](/browser/wp-security-hardening/trunk/modules/hooks.php?rev=3124437#L129 "Show revision 3124437 of this file in browser") | [r3151308](/browser/wp-security-hardening/tags/1.2.7/modules/hooks.php?rev=3151308#L129 "Show revision 3151308 of this file in browser") |  |
  | --- | --- | --- |
  | 129 | 129 | function shapeSpace\_check\_enum($redirect, $request) { |
  | 130 | 130 | // permalink URL format |
  | 131 |  | if (!empty( $\_GET['author'] ) && is\_string( $\_GET['author'] ) && preg\_match( '|^[0-9]+$|', $\_GET['author'])) { |
  | 132 |  | die("Not allowed"); |
  | 133 |  | } |
  | 134 |  |  |
  | 135 |  | return $redirect; |
  |  | 131 | if (preg\_match('/\?author=([0-9]\*)(\/\*)/i', $request)) die(); |
  |  | 132 | else return $redirect; |
  | 136 | 133 | } |
  | 137 | 134 |  |
  | […](/browser/wp-security-hardening/trunk/modules/hooks.php?rev=3124437#L202) | […](/browser/wp-security-hardening/tags/1.2.7/modules/hooks.php?rev=3151308#L199) |  |
  | 202 | 199 | if (!is\_admin()) { |
  | 203 | 200 | // default URL format |
  | 204 |  |  |
  | 205 |  | if (!empty( $\_GET['author'] ) && is\_string( $\_GET['author'] ) && preg\_match( '|^[0-9]+$|', $\_GET['author'] )) { |
  | 206 |  | wp\_redirect( get\_option('home'), 302 ); exit; |
  | 207 |  | } |
  | 208 |  |  |
  |  | 201 | if (isset($\_SERVER['QUERY\_STRING']) && preg\_match('/author=([0-9]\*)/i', $\_SERVER['QUERY\_STRING'])){ |
  |  | 202 | wp\_redirect( get\_option('home'), 302 ); exit; |
  |  | 203 | } |
  | 209 | 204 | add\_filter('redirect\_canonical', 'shapeSpace\_check\_enum', 10, 2); |
  | 210 | 205 | } |
* ## [wp-security-hardening/tags/1.2.7/readme.txt](/changeset/3151308/wp-security-hardening/tags/1.2.7/readme.txt "Show the changeset 3151308 restricted to wp-security-hardening/tags/1.2.7/readme.txt")

  | [r3124437](/browser/wp-security-hardening/trunk/readme.txt?rev=3124437#L12 "Show revision 3124437 of this file in browser") | [r3151308](/browser/wp-security-hardening/tags/1.2.7/readme.txt?rev=3151308#L12 "Show revision 3151308 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | The WP Hardening is a one-click tool to fix standard security recommendations on your WordPress website. |
  | 13 | 13 |  |
  | 14 |  | == ~~IMPORTANT: This plugin is discontinued~~ == |
  |  | 14 | == Discontinuation Notice == |
  | 15 | 15 |  |
  | 16 |  | <strong>This is to inform you that this plugin is no longer being maintained or updated. We have placed a discontinuation request with the WordPress team, and the plugin will soon be 'closed' for new installations. |
  |  | 16 | <strong>IMPORTANT: This plugin is discontinued</strong> |
  |  | 17 |  |
  |  | 18 | This is to inform you that this plugin is no longer being maintained or updated. We have placed a discontinuation request with the WordPress team, and the plugin will soon be 'closed' for new installations. |
  | 17 | 19 |  |
  | 18 | 20 | This plugin was launched as a side project and has sadly reached the end of its journey. Thank you for your understanding and for using our plugin. We apologize for any inconvenience this may cause. |
  | […](/browser/wp-security-hardening/trunk/readme.txt?rev=3124437#L24) | […](/browser/wp-security-hardening/tags/1.2.7/readme.txt?rev=3151308#L26) |  |
  | 24 | 26 | </ol> |
  | 25 | 27 |  |
  | 26 |  | We recommend that you deactivate and delete this plugin from your WordPress site as soon as possible. Please seek alternative plugins to replace the functionality provided by this plugin.~~</strong>~~ |
  |  | 28 | We recommend that you deactivate and delete this plugin from your WordPress site as soon as possible. Please seek alternative plugins to replace the functionality provided by this plugin. |
  | 27 | 29 |  |
  | 28 | 30 | == Description == |
* ## [wp-security-hardening/trunk/modules/functions.php](/changeset/3151308/wp-security-hardening/trunk/modules/functions.php "Show the changeset 3151308 restricted to wp-security-hardening/trunk/modules/functions.php")

  | [r2802042](/browser/wp-security-hardening/trunk/modules/functions.php?rev=2802042#L372 "Show revision 2802042 of this file in browser") | [r3151308](/browser/wp-security-hardening/trunk/modules/functions.php?rev=3151308#L372 "Show revision 3151308 of this file in browser") |  |
  | --- | --- | --- |
  | 372 | 372 | 'wp-cerber/wp-cerber.php', |
  | 373 | 373 | 'better-wp-security/better-wp-security.php', |
  |  | 374 | 'getastra-premium/bridge-wordpress.php', |
  | 374 | 375 | ); |
  | 375 | 376 |  |
* ## [wp-security-hardening/trunk/modules/hooks.php](/changeset/3151308/wp-security-hardening/trunk/modules/hooks.php "Show the changeset 3151308 restricted to wp-security-hardening/trunk/modules/hooks.php")

  | [r3124437](/browser/wp-security-hardening/trunk/modules/hooks.php?rev=3124437#L129 "Show revision 3124437 of this file in browser") | [r3151308](/browser/wp-security-hardening/trunk/modules/hooks.php?rev=3151308#L129 "Show revision 3151308 of this file in browser") |  |
  | --- | --- | --- |
  | 129 | 129 | function shapeSpace\_check\_enum($redirect, $request) { |
  | 130 | 130 | // permalink URL format |
  | 131 |  | if (!empty( $\_GET['author'] ) && is\_string( $\_GET['author'] ) && preg\_match( '|^[0-9]+$|', $\_GET['author'])) { |
  | 132 |  | die("Not allowed"); |
  | 133 |  | } |
  | 134 |  |  |
  | 135 |  | return $redirect; |
  |  | 131 | if (preg\_match('/\?author=([0-9]\*)(\/\*)/i', $request)) die(); |
  |  | 132 | else return $redirect; |
  | 136 | 133 | } |
  | 137 | 134 |  |
  | […](/browser/wp-security-hardening/trunk/modules/hooks.php?rev=3124437#L202) | […](/browser/wp-security-hardening/trunk/modules/hooks.php?rev=3151308#L199) |  |
  | 202 | 199 | if (!is\_admin()) { |
  | 203 | 200 | // default URL format |
  | 204 |  |  |
  | 205 |  | if (!empty( $\_GET['author'] ) && is\_string( $\_GET['author'] ) && preg\_match( '|^[0-9]+$|', $\_GET['author'] )) { |
  | 206 |  | wp\_redirect( get\_option('home'), 302 ); exit; |
  | 207 |  | } |
  | 208 |  |  |
  |  | 201 | if (isset($\_SERVER['QUERY\_STRING']) && preg\_match('/author=([0-9]\*)/i', $\_SERVER['QUERY\_STRING'])){ |
  |  | 202 | wp\_redirect( get\_option('home'), 302 ); exit; |
  |  | 203 | } |
  | 209 | 204 | add\_filter('redirect\_canonical', 'shapeSpace\_check\_enum', 10, 2); |
  | 210 | 205 | } |
* ## [wp-security-hardening/trunk/readme.txt](/changeset/3151308/wp-security-hardening/trunk/readme.txt "Show the changeset 3151308 restricted to wp-security-hardening/trunk/readme.txt")

  | [r3124437](/browser/wp-security-hardening/trunk/readme.txt?rev=3124437#L12 "Show revision 3124437 of this file in browser") | [r3151308](/browser/wp-security-hardening/trunk/readme.txt?rev=3151308#L12 "Show revision 3151308 of this file in browser") |  |
  | --- | --- | --- |
  | 12 | 12 | The WP Hardening is a one-click tool to fix standard security recommendations on your WordPress website. |
  | 13 | 13 |  |
  | 14 |  | == ~~IMPORTANT: This plugin is discontinued~~ == |
  |  | 14 | == Discontinuation Notice == |
  | 15 | 15 |  |
  | 16 |  | <strong>This is to inform you that this plugin is no longer being maintained or updated. We have placed a discontinuation request with the WordPress team, and the plugin will soon be 'closed' for new installations. |
  |  | 16 | <strong>IMPORTANT: This plugin is discontinued</strong> |
  |  | 17 |  |
  |  | 18 | This is to inform you that this plugin is no longer being maintained or updated. We have placed a discontinuation request with the WordPress team, and the plugin will soon be 'closed' for new installations. |
  | 17 | 19 |  |
  | 18 | 20 | This plugin was launched as a side project and has sadly reached the end of its journey. Thank you for your understanding and for using our plugin. We apologize for any inconvenience this may cause. |
  | […](/browser/wp-security-hardening/trunk/readme.txt?rev=3124437#L24) | […](/browser/wp-security-hardening/trunk/readme.txt?rev=3151308#L26) |  |
  | 24 | 26 | </ol> |
  | 25 | 27 |  |
  | 26 |  | We recommend that you deactivate and delete this plugin from your WordPress site as soon as possible. Please seek alternative plugins to replace the functionality provided by this plugin.~~</strong>~~ |
  |  | 28 | We recommend that you deactivate and delete this plugin from your WordPress site as soon as possible. Please seek alternative plugins to replace the functionality provided by this plugin. |
  | 27 | 29 |  |
  | 28 | 30 | == Description == |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3151308)
* [Zip Archive](?format=zip&new=3151308)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

