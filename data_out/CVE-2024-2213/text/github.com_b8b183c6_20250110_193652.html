
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2F58cb3d987372c91eb605853c35325701733337c2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2F58cb3d987372c91eb605853c35325701733337c2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=zenml-io%2Fzenml)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zenml-io](/zenml-io)
/
**[zenml](/zenml-io/zenml)**
Public

* [Notifications](/login?return_to=%2Fzenml-io%2Fzenml) You must be signed in to change notification settings
* [Fork
  465](/login?return_to=%2Fzenml-io%2Fzenml)
* [Star
   4.3k](/login?return_to=%2Fzenml-io%2Fzenml)

* [Code](/zenml-io/zenml)
* [Issues
  22](/zenml-io/zenml/issues)
* [Pull requests
  15](/zenml-io/zenml/pulls)
* [Actions](/zenml-io/zenml/actions)
* [Projects
  0](/zenml-io/zenml/projects)
* [Security](/zenml-io/zenml/security)
* [Insights](/zenml-io/zenml/pulse)

Additional navigation options

* [Code](/zenml-io/zenml)
* [Issues](/zenml-io/zenml/issues)
* [Pull requests](/zenml-io/zenml/pulls)
* [Actions](/zenml-io/zenml/actions)
* [Projects](/zenml-io/zenml/projects)
* [Security](/zenml-io/zenml/security)
* [Insights](/zenml-io/zenml/pulse)

## Commit

[Permalink](/zenml-io/zenml/commit/58cb3d987372c91eb605853c35325701733337c2)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Check old password during password change and add missing CLI commands (

[Browse files](/zenml-io/zenml/tree/58cb3d987372c91eb605853c35325701733337c2)
Browse the repository at this point in the history

```
[#2587](https://github.com/zenml-io/zenml/pull/2587))

* Check old password during password change and add missing CLI commands

* Fix docstrings

* Ask to re-enter password during CLI password change

* Auto-update of E2E template

* Auto-update of LLM Finetuning template

* Auto-update of NLP template

---------

Co-authored-by: GitHub Actions <actions@github.com>
```

* Loading branch information

[![@stefannica](https://avatars.githubusercontent.com/u/3963946?s=40&v=4)](/stefannica) [![@actions-user](https://avatars.githubusercontent.com/u/65916846?s=40&v=4)](/actions-user)

[stefannica](/zenml-io/zenml/commits?author=stefannica "View all commits by stefannica")
and
[actions-user](/zenml-io/zenml/commits?author=actions-user "View all commits by actions-user")
authored
Apr 9, 2024

1 parent
[31e6fec](/zenml-io/zenml/commit/31e6fec8e70962abf7665f68fb29abe82f1cdb4d)

commit 58cb3d9

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**273 additions**
and
**34 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/zenml

  + cli

    - src/zenml/cli/server.py
      [server.py](#diff-34f8ef29b09a3219d54fa56c17927054196d2860535f95d64ae64910184a3827)
    - src/zenml/cli/user\_management.py
      [user\_management.py](#diff-a73a481b9242f3c823a4fb7b324395e2565dd023493f4df726db081c1f864135)
  + src/zenml/client.py
    [client.py](#diff-84b93992959735eed85ebcb2fed105598c4e421f5d0a1d964cf69f7ba0c33994)
  + models/v2/core

    - src/zenml/models/v2/core/user.py
      [user.py](#diff-e0fd6255a51cb63d6096cfe38642efc383d1176a3cfde4e29725ae74c247d50b)
  + zen\_server/routers

    - src/zenml/zen\_server/routers/users\_endpoints.py
      [users\_endpoints.py](#diff-7f777d6044b383af2530b7e1da1532f55539efbad97353b8c1e915d1b70ae6fb)
  + zen\_stores

    - src/zenml/zen\_stores/rest\_zen\_store.py
      [rest\_zen\_store.py](#diff-3a628ce66ca926b13989f8f4d174484564ece5281da3b6a46d15f4f841abbc40)
    - schemas

      * src/zenml/zen\_stores/schemas/user\_schemas.py
        [user\_schemas.py](#diff-5be43543d3740d7a531e99e60a2ae41b492d1c67b3f0ea14ac811085f01cf4b2)

## There are no files selected for viewing

39 changes: 19 additions & 20 deletions

39
[src/zenml/cli/server.py](#diff-34f8ef29b09a3219d54fa56c17927054196d2860535f95d64ae64910184a3827 "src/zenml/cli/server.py")

Show comments

[View file](/zenml-io/zenml/blob/58cb3d987372c91eb605853c35325701733337c2/src/zenml/cli/server.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,7 +32,7 @@ |
|  |  | from zenml.config.global\_config import GlobalConfiguration |
|  |  | from zenml.console import console |
|  |  | from zenml.enums import ServerProviderType, StoreType |
|  |  | from zenml.exceptions import IllegalOperationError |
|  |  | from zenml.exceptions import AuthorizationException, IllegalOperationError |
|  |  | from zenml.logger import get\_logger |
|  |  | from zenml.utils import terraform\_utils, yaml\_utils |
|  |  | from zenml.zen\_server.utils import get\_active\_deployment |
| Expand Down  Expand Up | | @@ -624,12 +624,6 @@ def status() -> None: |
|  |  | required=False, |
|  |  | type=str, |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--workspace", |
|  |  | help="The workspace to use when connecting to the ZenML server.", |
|  |  | required=False, |
|  |  | type=str, |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--no-verify-ssl", |
|  |  | is\_flag=True, |
| Expand Down  Expand Up | | @@ -661,7 +655,6 @@ def connect( |
|  |  | username: Optional[str] = None, |
|  |  | password: Optional[str] = None, |
|  |  | api\_key: Optional[str] = None, |
|  |  | workspace: Optional[str] = None, |
|  |  | no\_verify\_ssl: bool = False, |
|  |  | ssl\_ca\_cert: Optional[str] = None, |
|  |  | config: Optional[str] = None, |
| Expand All | | @@ -677,8 +670,6 @@ def connect( |
|  |  | server. |
|  |  | api\_key: The API key that is used to authenticate with the ZenML |
|  |  | server. |
|  |  | workspace: The active workspace that is used to connect to the ZenML |
|  |  | server. |
|  |  | no\_verify\_ssl: Whether to verify the server's TLS certificate. |
|  |  | ssl\_ca\_cert: A path to a CA bundle to use to verify the server's TLS |
|  |  | certificate or the CA bundle value itself. |
| Expand All | | @@ -689,6 +680,12 @@ def connect( |
|  |  | from zenml.config.store\_config import StoreConfiguration |
|  |  | from zenml.zen\_stores.base\_zen\_store import BaseZenStore |
|  |  |  |
|  |  | if password is not None: |
|  |  | cli\_utils.warning( |
|  |  | "Supplying password values in the command line is not safe. " |
|  |  | "Please consider using the prompt option." |
|  |  | ) |
|  |  |  |
|  |  | # Raise an error if a local server is running when trying to connect to |
|  |  | # another server |
|  |  | active\_deployment = get\_active\_deployment(local=True) |
| Expand Down  Expand Up | | @@ -767,6 +764,16 @@ def connect( |
|  |  | username = click.prompt("Username", type=str) |
|  |  |  |
|  |  | if username: |
|  |  | cli\_utils.warning( |
|  |  | "Connecting to a ZenML server using a username and password is " |
|  |  | "not recommended because the password is locally stored on your " |
|  |  | "filesystem. You should consider using the web login workflow by " |
|  |  | "omitting the `--username` and `--password` flags. An alternative " |
|  |  | "for non-interactive environments is to create and use a service " |
|  |  | "account API key (see https://docs.zenml.io/user-guide/advanced-guide/configuring-zenml/connecting-to-zenml#using-service-accounts-to-connect-to-a-deployed-zenml-server " |
|  |  | "for more information)." |
|  |  | ) |
|  |  |  |
|  |  | store\_dict["username"] = username |
|  |  |  |
|  |  | if password is None: |
| Expand All | | @@ -790,16 +797,8 @@ def connect( |
|  |  | f"User '{username}' does not have sufficient permissions to " |
|  |  | f"access the server at '{url}'." |
|  |  | ) |
|  |  |  |
|  |  | if workspace: |
|  |  | try: |
|  |  | Client().set\_active\_workspace(workspace\_name\_or\_id=workspace) |
|  |  | except KeyError: |
|  |  | cli\_utils.warning( |
|  |  | f"The workspace {workspace} does not exist or is not accessible. " |
|  |  | f"Please set another workspace by running `zenml " |
|  |  | f"workspace set`." |
|  |  | ) |
|  |  | except AuthorizationException as e: |
|  |  | cli\_utils.warning(f"Authorization error: {e}") |
|  |  |  |
|  |  |  |
|  |  | @cli.command("disconnect", help="Disconnect from a ZenML server.") |
| Expand Down | |  |

161 changes: 148 additions & 13 deletions

161
[src/zenml/cli/user\_management.py](#diff-a73a481b9242f3c823a4fb7b324395e2565dd023493f4df726db081c1f864135 "src/zenml/cli/user_management.py")

Show comments

[View file](/zenml-io/zenml/blob/58cb3d987372c91eb605853c35325701733337c2/src/zenml/cli/user_management.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,9 +21,14 @@ |
|  |  | from zenml.cli.cli import TagGroup, cli |
|  |  | from zenml.cli.utils import is\_sorted\_or\_filtered, list\_options |
|  |  | from zenml.client import Client |
|  |  | from zenml.config.global\_config import GlobalConfiguration |
|  |  | from zenml.console import console |
|  |  | from zenml.enums import CliCategories, StoreType |
|  |  | from zenml.exceptions import EntityExistsError, IllegalOperationError |
|  |  | from zenml.exceptions import ( |
|  |  | AuthorizationException, |
|  |  | EntityExistsError, |
|  |  | IllegalOperationError, |
|  |  | ) |
|  |  | from zenml.models import UserFilter |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -156,6 +161,11 @@ def create\_user( |
|  |  | default="", |
|  |  | hide\_input=True, |
|  |  | ) |
|  |  | else: |
|  |  | cli\_utils.warning( |
|  |  | "Supplying password values in the command line is not safe. " |
|  |  | "Please consider using the prompt option." |
|  |  | ) |
|  |  |  |
|  |  | try: |
|  |  | new\_user = client.create\_user( |
| Expand Down  Expand Up | | @@ -204,14 +214,6 @@ def create\_user( |
|  |  | required=False, |
|  |  | help="New user email.", |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--password", |
|  |  | "-p", |
|  |  | "updated\_password", |
|  |  | type=str, |
|  |  | required=False, |
|  |  | help="New user password.", |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--admin", |
|  |  | "-a", |
| Expand All | | @@ -230,14 +232,22 @@ def create\_user( |
|  |  | default=None, |
|  |  | help="Whether the user should be a regular user.", |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--active", |
|  |  | "active", |
|  |  | type=bool, |
|  |  | required=False, |
|  |  | default=None, |
|  |  | help="Use to activate or deactivate a user account.", |
|  |  | ) |
|  |  | def update\_user( |
|  |  | user\_name\_or\_id: str, |
|  |  | updated\_name: Optional[str] = None, |
|  |  | updated\_full\_name: Optional[str] = None, |
|  |  | updated\_email: Optional[str] = None, |
|  |  | updated\_password: Optional[str] = None, |
|  |  | make\_admin: Optional[bool] = None, |
|  |  | make\_user: Optional[bool] = None, |
|  |  | active: Optional[bool] = None, |
|  |  | ) -> None: |
|  |  | """Update an existing user. |
|  |  |  |
| Expand All | | @@ -246,9 +256,9 @@ def update\_user( |
|  |  | updated\_name: The name of the user to create. |
|  |  | updated\_full\_name: The name of the user to create. |
|  |  | updated\_email: The name of the user to create. |
|  |  | updated\_password: The name of the user to create. |
|  |  | make\_admin: Whether the user should be an admin. |
|  |  | make\_user: Whether the user should be a regular user. |
|  |  | active: Use to activate or deactivate a user account. |
|  |  | """ |
|  |  | if make\_admin is not None and make\_user is not None: |
|  |  | cli\_utils.error( |
| Expand All | | @@ -260,7 +270,8 @@ def update\_user( |
|  |  | ) |
|  |  | if current\_user.is\_admin and make\_user: |
|  |  | confirmation = cli\_utils.confirmation( |
|  |  | f"Currently user `{current\_user.name}` is an admin. Are you sure you want to make them a regular user?" |
|  |  | f"Currently user `{current\_user.name}` is an admin. Are you " |
|  |  | "sure you want to make them a regular user?" |
|  |  | ) |
|  |  | if not confirmation: |
|  |  | cli\_utils.declare("User update canceled.") |
| Expand All | | @@ -276,13 +287,137 @@ def update\_user( |
|  |  | updated\_name=updated\_name, |
|  |  | updated\_full\_name=updated\_full\_name, |
|  |  | updated\_email=updated\_email, |
|  |  | updated\_password=updated\_password, |
|  |  | updated\_is\_admin=updated\_is\_admin, |
|  |  | active=active, |
|  |  | ) |
|  |  | except (KeyError, IllegalOperationError) as err: |
|  |  | cli\_utils.error(str(err)) |
|  |  |  |
|  |  |  |
|  |  | @user.command( |
|  |  | "change-password", |
|  |  | help="Change the password for the current user account.", |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--password", |
|  |  | help=( |
|  |  | "The new user password. If omitted, a prompt will be shown to enter " |
|  |  | "the password." |
|  |  | ), |
|  |  | required=False, |
|  |  | type=str, |
|  |  | ) |
|  |  | @click.option( |
|  |  | "--old-password", |
|  |  | help=( |
|  |  | "The old user password. If omitted, a prompt will be shown to enter " |
|  |  | "the old password." |
|  |  | ), |
|  |  | required=False, |
|  |  | type=str, |
|  |  | ) |
|  |  | def change\_user\_password( |
|  |  | password: Optional[str] = None, old\_password: Optional[str] = None |
|  |  | ) -> None: |
|  |  | """Change the password of the current user. |
|  |  |  |
|  |  | Args: |
|  |  | password: The new password for the current user. |
|  |  | old\_password: The old password for the current user. |
|  |  | """ |
|  |  | active\_user = Client().active\_user |
|  |  |  |
|  |  | if old\_password is not None or password is not None: |
|  |  | cli\_utils.warning( |
|  |  | "Supplying password values in the command line is not safe. " |
|  |  | "Please consider using the prompt option." |
|  |  | ) |
|  |  |  |
|  |  | if old\_password is None: |
|  |  | old\_password = click.prompt( |
|  |  | f"Current password for user {active\_user.name}", |
|  |  | hide\_input=True, |
|  |  | ) |
|  |  | if password is None: |
|  |  | password = click.prompt( |
|  |  | f"New password for user {active\_user.name}", |
|  |  | hide\_input=True, |
|  |  | ) |
|  |  | password\_again = click.prompt( |
|  |  | f"Please re-enter the new password for user {active\_user.name}", |
|  |  | hide\_input=True, |
|  |  | ) |
|  |  | if password != password\_again: |
|  |  | cli\_utils.error("Passwords do not match.") |
|  |  |  |
|  |  | try: |
|  |  | Client().update\_user( |
|  |  | name\_id\_or\_prefix=active\_user.id, |
|  |  | old\_password=old\_password, |
|  |  | updated\_password=password, |
|  |  | ) |
|  |  | except (KeyError, IllegalOperationError, AuthorizationException) as err: |
|  |  | cli\_utils.error(str(err)) |
|  |  |  |
|  |  | cli\_utils.declare( |
|  |  | f"Successfully updated password for active user '{active\_user.name}'." |
|  |  | ) |
|  |  |  |
|  |  | store = GlobalConfiguration().store\_configuration |
|  |  | if store.type == StoreType.REST: |
|  |  | from zenml.zen\_stores.rest\_zen\_store import RestZenStoreConfiguration |
|  |  |  |
|  |  | assert isinstance(store, RestZenStoreConfiguration) |
|  |  |  |
|  |  | if store.password is not None: |
|  |  | cli\_utils.declare( |
|  |  | "You may need to log in again with your new password by " |
|  |  | "running `zenml connect`." |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | @user.command( |
|  |  | "deactivate", |
|  |  | help="Generate an activation token to reset the password for a user account", |
|  |  | ) |
|  |  | @click.argument("user\_name\_or\_id", type=str, required=True) |
|  |  | def deactivate\_user( |
|  |  | user\_name\_or\_id: str, |
|  |  | ) -> None: |
|  |  | """Reset the password of a user. |
|  |  |  |
|  |  | Args: |
|  |  | user\_name\_or\_id: The name or ID of the user to reset the password for. |
|  |  | """ |
|  |  | client = Client() |
|  |  |  |
|  |  | store = GlobalConfiguration().store\_configuration |
|  |  | if store.type != StoreType.REST: |
|  |  | cli\_utils.error( |
|  |  | "Deactivating users is only supported when connected to a ZenML " |
|  |  | "server." |
|  |  | ) |
|  |  |  |
|  |  | try: |
|  |  | if not client.active\_user.is\_admin: |
|  |  | cli\_utils.error( |
|  |  | "Only admins can reset the password of other users." |
|  |  | ) |
|  |  |  |
|  |  | user = client.deactivate\_user( |
|  |  | name\_id\_or\_prefix=user\_name\_or\_id, |
|  |  | ) |
|  |  | except (KeyError, IllegalOperationError) as err: |
|  |  | cli\_utils.error(str(err)) |
|  |  |  |
|  |  | cli\_utils.declare( |
|  |  | f"Successfully deactivated user account '{user.name}'." |
|  |  | f"To reactivate the account, please visit the dashboard at the " |
|  |  | "following URL:\n" |
|  |  | f"{client.zen\_store.url}/signup?user={str(user.id)}&username={user.name}&token={user.activation\_token}\n" |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | @user.command("delete") |
|  |  | @click.argument("user\_name\_or\_id", type=str, required=True) |
|  |  | def delete\_user(user\_name\_or\_id: str) -> None: |
| Expand Down | |  |

32 changes: 32 additions & 0 deletions

32
[src/zenml/client.py](#diff-84b93992959735eed85ebcb2fed105598c4e421f5d0a1d964cf69f7ba0c33994 "src/zenml/client.py")

Show comments

[View file](/zenml-io/zenml/blob/58cb3d987372c91eb605853c35325701733337c2/src/zenml/client.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -814,7 +814,9 @@ def update\_user( |
|  |  | updated\_email\_opt\_in: Optional[bool] = None, |
|  |  | updated\_hub\_token: Optional[str] = None, |
|  |  | updated\_password: Optional[str] = None, |
|  |  | old\_password: Optional[str] = None, |
|  |  | updated\_is\_admin: Optional[bool] = None, |
|  |  | active: Optional[bool] = None, |
|  |  | ) -> UserResponse: |
|  |  | """Update a user. |
|  |  |  |
| Expand All | | @@ -826,10 +828,17 @@ def update\_user( |
|  |  | updated\_email\_opt\_in: The new email opt-in status of the user. |
|  |  | updated\_hub\_token: Update the hub token |
|  |  | updated\_password: The new password of the user. |
|  |  | old\_password: The old password of the user. Required for password |
|  |  | update. |
|  |  | updated\_is\_admin: Whether the user should be an admin. |
|  |  | active: Use to activate or deactivate the user. |
|  |  |  |
|  |  | Returns: |
|  |  | The updated user. |
|  |  |  |
|  |  | Raises: |
|  |  | ValidationError: If the old password is not provided when updating |
|  |  | the password. |
|  |  | """ |
|  |  | user = self.get\_user( |
|  |  | name\_id\_or\_prefix=name\_id\_or\_prefix, allow\_name\_prefix\_match=False |
| Expand All | | @@ -848,13 +857,36 @@ def update\_user( |
|  |  | user\_update.hub\_token = updated\_hub\_token |
|  |  | if updated\_password is not None: |
|  |  | user\_update.password = updated\_password |
|  |  | if old\_password is None: |
|  |  | raise ValidationError( |
|  |  | "Old password is required to update the password." |
|  |  | ) |
|  |  | user\_update.old\_password = old\_password |
|  |  | if updated\_is\_admin is not None: |
|  |  | user\_update.is\_admin = updated\_is\_admin |
|  |  | if active is not None: |
|  |  | user\_update.active = active |
|  |  |  |
|  |  | return self.zen\_store.update\_user( |
|  |  | user\_id=user.id, user\_update=user\_update |
|  |  | ) |
|  |  |  |
|  |  | @\_fail\_for\_sql\_zen\_store |
|  |  | def deactivate\_user(self, name\_id\_or\_prefix: str) -> "UserResponse": |
|  |  | """Deactivate a user and generate an activation token. |
|  |  |  |
|  |  | Args: |
|  |  | name\_id\_or\_prefix: The name or ID of the user to reset. |
|  |  |  |
|  |  | Returns: |
|  |  | The deactivated user. |
|  |  | """ |
|  |  | from zenml.zen\_stores.rest\_zen\_store import RestZenStore |
|  |  |  |
|  |  | user = self.get\_user(name\_id\_or\_prefix, allow\_name\_prefix\_match=False) |
|  |  | assert isinstance(self.zen\_store, RestZenStore) |
|  |  | return self.zen\_store.deactivate\_user(user\_name\_or\_id=user.name) |
|  |  |  |
|  |  | def delete\_user(self, name\_id\_or\_prefix: str) -> None: |
|  |  | """Delete a user. |
|  |  |  |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[src/zenml/models/v2/core/user.py](#diff-e0fd6255a51cb63d6096cfe38642efc383d1176a3cfde4e29725ae74c247d50b "src/zenml/models/v2/core/user.py")

Show comments

[View file](/zenml-io/zenml/blob/58cb3d987372c91eb605853c35325701733337c2/src/zenml/models/v2/core/user.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -201,6 +201,12 @@ class UserUpdate(UserBase, BaseZenModel): |
|  |  | active: Optional[bool] = Field( |
|  |  | default=None, title="Whether the account is active." |
|  |  | ) |
|  |  | old\_password: Optional[str] = Field( |
|  |  | default=None, |
|  |  | title="The previous password for the user. Only relevant for user " |
|  |  | "accounts. Required when updating the password.", |
|  |  | max\_length=STR\_FIELD\_MAX\_LENGTH, |
|  |  | ) |
|  |  |  |
|  |  | @root\_validator |
|  |  | def user\_email\_updates(cls, values: Dict[str, Any]) -> Dict[str, Any]: |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `58cb3d9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzenml-io%2Fzenml%2Fcommit%2F58cb3d987372c91eb605853c35325701733337c2) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

