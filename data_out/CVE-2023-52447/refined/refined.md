```
{
  "Root cause of vulnerability": "When updating or deleting an inner map in map array or map htab, the map may still be accessed by non-sleepable program or sleepable program. bpf_map_fd_put_ptr() decreases the ref-counter of the inner map directly through bpf_map_put(). If the ref-counter is the last one, the inner map will be freed by ops->map_free() in a kworker. However, most .map_free() callbacks don't use synchronize_rcu() or its variants to wait for the elapse of a RCU grace period, leading to use-after-free.",
  "Weaknesses/vulnerabilities present": "Use-after-free vulnerability due to incorrect handling of inner map freeing in the BPF subsystem.",
  "Impact of exploitation": "A bpf program accessing the inner map after it has been freed may incur use-after-free problem.",
  "Attack vectors": "By updating or deleting an inner map in map array or map htab while a bpf program is accessing the inner map.",
  "Required attacker capabilities/position": "An attacker needs to be able to trigger the update or deletion of an inner map while a BPF program is accessing it."
}
```