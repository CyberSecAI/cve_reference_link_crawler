

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Sensitive information disclosure via value stream analytics controller (leaks undisclosed security vulnerabilities in Gitlab)

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2012073](https://hackerone.com/reports/2012073)** by `pwnie` on 2023-06-04, assigned to [@ngeorge1](/ngeorge1 "Nikhil George"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Sensitive information can be disclosed via the value stream analytics feature of Gitlab. Some examples are viewing a private repository's merge requests and confidential issues.

##### Steps to reproduce (Example attacks)

**Viewing confidential issues**

1. Go to [https://gitlab.com/gitlab-org/gitlab/-/value\_stream\_analytics?created\_after=2023-05-06&created\_before=2023-06-04&value\_stream\_id=3160&label\_name[]=HackerOne&stage\_id=12787&sort=end\_event&direction=desc&page=1](https://gitlab.com/gitlab-org/gitlab/-/value_stream_analytics?created_after=2023-05-06&created_before=2023-06-04&value_stream_id=3160&label_name%5B%5D=HackerOne&stage_id=12787&sort=end_event&direction=desc&page=1)
2. You can view undisclosed security issues for Gitlab

**Viewing merge requests of a private repository**

1. Create a project and change the repository visibility to project members only
2. Create a new branch and a new merge request
3. Close that merge request
4. Go to the value stream analytics page on a different account
5. Create a new value stream with any name with the following settings:

   [![Screenshot_2023-06-03_at_7.58.49_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/8aaefbbab5c3f494cf413927571446ed2378f801/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61646433663966612d393138342d343238352d386162662d3162616266663632613962382f53637265656e73686f745f323032332d30362d30335f61745f372e35382e34395f504d2e706e67)
6. Wait for the merge request to appear in the new value stream and stage you just created

##### Impact

Information disclosure of critical nature, for example undisclosed security vulnerabilities. Since the information disclosed pertains to different components, I am marking the scope as `changed`. For example I can use this bug to disclose every other vulnerability in Gitlab, and escalate from there.

##### What is the current *bug* behavior?

Value stream analytics controllers don't implement access control

##### What is the expected *correct* behavior?

Proper access control

##### Output of checks

This bug happens on GitLab.com

#### Impact

Information disclosure of critical nature, for example undisclosed security vulnerabilities. Since the information disclosed pertains to different components, I am marking the scope as `changed`. For example I can use this bug to disclose every other vulnerability in Gitlab, and escalate from there.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2023-06-03\_at\_7.58.49\_PM.png](https://h1.sec.gitlab.net/a/add3f9fa-9184-4285-8abf-1babff62a9b8/Screenshot_2023-06-03_at_7.58.49_PM.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

