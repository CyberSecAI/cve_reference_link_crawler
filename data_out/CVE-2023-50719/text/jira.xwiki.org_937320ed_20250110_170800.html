

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21208)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21208)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-21208](/browse/XWIKI-21208)

# Solr search discloses password hashes of all users

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21208 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Solved By
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [15.5.2](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.5.2 "15.5.2 "), [15.7-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.7-rc-1 "15.7-rc-1 "), [14.10.15](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.15 "14.10.15 ")
* **Affects Version/s:**
  7.2-milestone-2
* **Component/s:**
  [Search - Solr](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Search+-+Solr%22 "Search - Solr ")
* **Labels:**
  + [attack\_dataleak](/issues/?jql=labels+%3D+attack_dataleak "attack_dataleak")
  + [attacker\_view](/issues/?jql=labels+%3D+attacker_view "attacker_view")
  + [regression](/issues/?jql=labels+%3D+regression "regression")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Unit
* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce:**

Open <xwiki-host>/xwiki/bin/view/Main/Search?sort=score&sortOrder=desc&highlight=true&facet=true&r=1&f\_type=OBJECT\_PROPERTY&f\_locale=en&f\_locale=&text=propertyvalue%3Ahash\* where <xwiki-host> is the URL of your XWiki installation.

**Expected result:**

No password hashes are displayed.

**Actual result:**

The password hashes of all users are displayed.

This allows efficient, offline password cracking attacks against in particular weak passwords. This shouldn't affect wikis that use external authentication (SSO) - however, in many cases, external authentication is used in a combination with local accounts and can be overridden.

From what I can see, this vulnerability has been introduced in [~~XWIKI-8689~~](https://jira.xwiki.org/browse/XWIKI-8689 "Add Solr indexing daemon thread to handle the automatic indexing of documents as they are queued for indexing.") as the original Solr indexing code before that change had a check to not to index password properties.

#### Attachments

#### Issue Links

is caused by

![Task - A task that needs to be done.](/secure/viewavatar?size=xsmall&avatarId=13518&avatarType=issuetype "Task - A task that needs to be done.")
[XWIKI-12380](/browse/XWIKI-12380)
Add basic support for nested spaces to the Solr Search API

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-20371](/browse/XWIKI-20371)
Solr search disclosed email addresses of users

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Security Advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p6cp-6r35-32mh)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

07/Aug/23 10:24

Updated:

15/Dec/23 15:26

Resolved:

10/Aug/23 12:30

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

