
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbareos%2Fbareos%2Fpull%2F1875)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbareos%2Fbareos%2Fpull%2F1875)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=bareos%2Fbareos)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bareos](/bareos)
/
**[bareos](/bareos/bareos)**
Public

* [Notifications](/login?return_to=%2Fbareos%2Fbareos) You must be signed in to change notification settings
* [Fork
  273](/login?return_to=%2Fbareos%2Fbareos)
* [Star
   1k](/login?return_to=%2Fbareos%2Fbareos)

* [Code](/bareos/bareos)
* [Issues
  46](/bareos/bareos/issues)
* [Pull requests
  29](/bareos/bareos/pulls)
* [Discussions](/bareos/bareos/discussions)
* [Actions](/bareos/bareos/actions)
* [Projects
  0](/bareos/bareos/projects)
* [Security](/bareos/bareos/security)
* [Insights](/bareos/bareos/pulse)

Additional navigation options

* [Code](/bareos/bareos)
* [Issues](/bareos/bareos/issues)
* [Pull requests](/bareos/bareos/pulls)
* [Discussions](/bareos/bareos/discussions)
* [Actions](/bareos/bareos/actions)
* [Projects](/bareos/bareos/projects)
* [Security](/bareos/bareos/security)
* [Insights](/bareos/bareos/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbareos%2Fbareos%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbareos%2Fbareos%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix multiple ACL handling bugs #1875

 Merged

[BareosBot](/BareosBot)
merged 23 commits into
[bareos:master](/bareos/bareos/tree/master "bareos/bareos:master")
from
[joergsteffens:dev/joergs/master/acl-fix](/joergsteffens/bareos/tree/dev/joergs/master/acl-fix "joergsteffens/bareos:dev/joergs/master/acl-fix")

Jul 12, 2024

 Merged

# [Fix multiple ACL handling bugs](#top) #1875

[BareosBot](/BareosBot)
merged 23 commits into
[bareos:master](/bareos/bareos/tree/master "bareos/bareos:master")
from
[joergsteffens:dev/joergs/master/acl-fix](/joergsteffens/bareos/tree/dev/joergs/master/acl-fix "joergsteffens/bareos:dev/joergs/master/acl-fix")

Jul 12, 2024

[Conversation
23](/bareos/bareos/pull/1875)
[Commits
23](/bareos/bareos/pull/1875/commits)
[Checks
0](/bareos/bareos/pull/1875/checks)
[Files changed](/bareos/bareos/pull/1875/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=60&v=4)](/joergsteffens)

Copy link

Member

### @joergsteffens **[joergsteffens](/joergsteffens)** commented [Jul 1, 2024](#issue-2384509874) • edited Loading

ACL handling for commands have been wrong.

The UA detect a command, if all typed chars matches the start of a

command string. E.g. "w" => "whoami", ".cons" => ".consoles", ...

The ACL check also only used the typed part of the command,

so if your ACL denies the command ".consoles",

you could execute it with ".cons" (or ".co").

Now we check with the full command string against the ACL.

Fix handling ACL profiles

When using negative ACLs (ACLs starting with '!')

profiles could have overwritten this entries,

as the code did not distringuish between negative ACL and not found.

Now the ACL checking can have three states:

positive match found,

negative match found,

no match found.

Also unifies the ACL checking

and adding the ACL directive `!*all*`

to deny all (before a regex must be used (`!.*`).

#### Please check

* Short description and the purpose of this PR is present *above this paragraph*
* Your name is present in the AUTHORS file (optional)

If you have any questions or problems, please give a comment in the PR.

### Helpful documentation and best practices

* [Git Workflow](https://docs.bareos.org/DeveloperGuide/gitworkflow.html)
* [Automatic Sourcecode Formatting](https://docs.bareos.org/DeveloperGuide/generaldevel.html#automatic-sourcecode-formatting)
* [Check your commit messages](https://docs.bareos.org/DeveloperGuide/gitworkflow.html#commits)
* [Boy Scout Rule](https://docs.bareos.org/DeveloperGuide/generaldevel.html#boy-scout-rule)

### Checklist for the *reviewer* of the PR (will be processed by the Bareos team)

Make sure you check/merge the PR using `devtools/pr-tool` to have some simple automated checks run and a proper changelog record added.

##### General

* Is the PR title usable as CHANGELOG entry?
* Purpose of the PR is understood
* Commit descriptions are understandable and well formatted
* Required backport PRs have been created
* Correct milestone is set

##### Source code quality

* Source code changes are understandable
* Variable and function names are meaningful
* Code comments are correct (logically and spelling)
* Required documentation changes are present and part of the PR

##### Tests

* Decision taken that a test is required (if not, then remove this paragraph)
* The choice of the type of test (unit test or systemtest) is reasonable
* Testname matches exactly what is being tested
* On a fail, output of the test leads quickly to the origin of the fault

Sorry, something went wrong.

All reactions

[![@arogge](https://avatars.githubusercontent.com/u/22479968?s=40&v=4)](/arogge)
[arogge](/arogge)
assigned [joergsteffens](/joergsteffens)
[Jul 2, 2024](#event-13363678755)

[![@arogge](https://avatars.githubusercontent.com/u/22479968?s=40&v=4)](/arogge)
[arogge](/arogge)
added
the
[bugfix](/bareos/bareos/labels/bugfix)
label
[Jul 2, 2024](#event-13363724971)

 [![@arogge](https://avatars.githubusercontent.com/u/22479968?s=40&v=4)](/arogge)
[arogge](/arogge)
requested a review
from [sebsura](/sebsura)
[July 2, 2024 10:30](#event-13363745195)

[![@arogge](https://avatars.githubusercontent.com/u/22479968?s=40&v=4)](/arogge)
[arogge](/arogge)
added
[requires backport to 21](/bareos/bareos/labels/requires%20backport%20to%2021)
[requires backport to 22](/bareos/bareos/labels/requires%20backport%20to%2022)
[requires backport to 23](/bareos/bareos/labels/requires%20backport%20to%2023)
labels
[Jul 2, 2024](#event-13363779084)

 [![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)
[joergsteffens](/joergsteffens)
[force-pushed](/bareos/bareos/compare/8500660eb1e436ccff7bcff9cd9155333ad15f79..587c4c07fb20dfaba3c30fa012457b82890a1f99)
the
dev/joergs/master/acl-fix

branch
from
[`8500660`](/bareos/bareos/commit/8500660eb1e436ccff7bcff9cd9155333ad15f79) to
[`587c4c0`](/bareos/bareos/commit/587c4c07fb20dfaba3c30fa012457b82890a1f99)  [Compare](/bareos/bareos/compare/8500660eb1e436ccff7bcff9cd9155333ad15f79..587c4c07fb20dfaba3c30fa012457b82890a1f99)
[July 2, 2024 13:26](#event-13366171708)

[![sebsura](https://avatars.githubusercontent.com/u/124262655?s=60&v=4)](/sebsura)

**[sebsura](/sebsura)**
requested changes
[Jul 8, 2024](#pullrequestreview-2153945641)

 [View reviewed changes](/bareos/bareos/pull/1875/files)

Copy link

Contributor

### @sebsura **[sebsura](/sebsura)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Nice changes! I found some issues that i would like to see fixed.

Sorry, something went wrong.

All reactions

[core/src/dird/ua\_acl.cc](/bareos/bareos/pull/1875/files#diff-d0ee5c2530a094fd2e715f1137bdeeac8485a31cf87243e3cf6b01e87c08acc5)
Outdated

Show resolved

Hide resolved

[core/src/dird/ua\_acl.cc](/bareos/bareos/pull/1875/files#diff-d0ee5c2530a094fd2e715f1137bdeeac8485a31cf87243e3cf6b01e87c08acc5)
Outdated

Show resolved

Hide resolved

[core/src/dird/ua\_acl.cc](/bareos/bareos/pull/1875/files#diff-d0ee5c2530a094fd2e715f1137bdeeac8485a31cf87243e3cf6b01e87c08acc5)
Outdated

Show resolved

Hide resolved

[core/src/dird/ua\_acl.cc](/bareos/bareos/pull/1875/files#diff-d0ee5c2530a094fd2e715f1137bdeeac8485a31cf87243e3cf6b01e87c08acc5)
Outdated

Show resolved

Hide resolved

[core/src/dird/ua\_cmds.cc](/bareos/bareos/pull/1875/files#diff-8fe96011cf6f2e7490e42e829d974cfb7d8519160ffc34607fc20b6606392e5a)
Outdated

Show resolved

Hide resolved

[systemtests/tests/python-bareos/test\_acl.py](/bareos/bareos/pull/1875/files#diff-49c3a685ec77fa81330d09b1c9e5c4ff4e8abd7403981ddfbc87a942335d7fa4)
Outdated

Show resolved

Hide resolved

[core/src/dird/ua\_acl.cc](/bareos/bareos/pull/1875/files#diff-d0ee5c2530a094fd2e715f1137bdeeac8485a31cf87243e3cf6b01e87c08acc5)
Outdated

Show resolved

Hide resolved

 [![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)
[joergsteffens](/joergsteffens)
[force-pushed](/bareos/bareos/compare/b37a33dc6af8831483c2af8be9e865449fc89452..07b29354bab45cb76f606c4f03bc3b1a369bcf94)
the
dev/joergs/master/acl-fix

branch
from
[`b37a33d`](/bareos/bareos/commit/b37a33dc6af8831483c2af8be9e865449fc89452) to
[`07b2935`](/bareos/bareos/commit/07b29354bab45cb76f606c4f03bc3b1a369bcf94)  [Compare](/bareos/bareos/compare/b37a33dc6af8831483c2af8be9e865449fc89452..07b29354bab45cb76f606c4f03bc3b1a369bcf94)
[July 9, 2024 15:52](#event-13442644415)

 [![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)
[joergsteffens](/joergsteffens)
requested a review
from [sebsura](/sebsura)
[July 9, 2024 15:53](#event-13442654664)

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)
[joergsteffens](/joergsteffens)
mentioned this pull request
[Jul 10, 2024](#ref-pullrequest-2380858202)

[Update ReaR documentation
#1871](/bareos/bareos/pull/1871)
 Merged

11 tasks

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=80&v=4)](/joergsteffens)

Copy link

Member

Author

### **[joergsteffens](/joergsteffens)** commented [Jul 10, 2024](#issuecomment-2221555814)

| The test `config-syntax-crash` will now fail, as the Director will now produce a proper config error on invalid ACLs, instead of just ignoring them as before. The test have been introduced because of <https://bugs.bareos.org/view.php?id=1175>, leading to [#410](https://github.com/bareos/bareos/pull/410). [@arogge](https://github.com/arogge) do you remember, if there is anything more to this test? Otherwise I replaced the test with a small extra python-bareos test. |
| --- |

All reactions

Sorry, something went wrong.

 [![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)
[joergsteffens](/joergsteffens)
[force-pushed](/bareos/bareos/compare/78f3e2ff9db53e19bdc2c39303b73c46bef19c45..ba910ad077585dba969c271ea77e3284660d0e6e)
the
dev/joergs/master/acl-fix

branch
4 times, most recently
from
[`78f3e2f`](/bareos/bareos/commit/78f3e2ff9db53e19bdc2c39303b73c46bef19c45) to
[`ba910ad`](/bareos/bareos/commit/ba910ad077585dba969c271ea77e3284660d0e6e)  [Compare](/bareos/bareos/compare/78f3e2ff9db53e19bdc2c39303b73c46bef19c45..ba910ad077585dba969c271ea77e3284660d0e6e)
[July 11, 2024 07:38](#event-13467451543)

[![sebsura](https://avatars.githubusercontent.com/u/124262655?s=60&v=4)](/sebsura)

**[sebsura](/sebsura)**
requested changes
[Jul 11, 2024](#pullrequestreview-2171777775)

 [View reviewed changes](/bareos/bareos/pull/1875/files)

Copy link

Contributor

### @sebsura **[sebsura](/sebsura)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I have not checked everything yet but these are things i noticed

Sorry, something went wrong.

All reactions

[systemtests/python-modules/bareos\_unittest/json.py](/bareos/bareos/pull/1875/files#diff-747088d65d9aaa89eed73cb58ae617f446af137e05698f30e87b94fe1ca9b900)
Outdated

Show resolved

Hide resolved

[core/src/dird/ua\_cmds.cc](/bareos/bareos/pull/1875/files#diff-8fe96011cf6f2e7490e42e829d974cfb7d8519160ffc34607fc20b6606392e5a)
Outdated

Show resolved

Hide resolved

[core/src/dird/ua\_run.cc](/bareos/bareos/pull/1875/files#diff-d3488d8c66150524f490d47e95c35d69283b91f7302fa679f478514156de45af)

Show resolved

Hide resolved

 [![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)
[joergsteffens](/joergsteffens)
[force-pushed](/bareos/bareos/compare/71c9a0c0ffdf5765169836417915c59099de9342..5631ca19f3925716b802f8dd925598b949bdac54)
the
dev/joergs/master/acl-fix

branch
from
[`71c9a0c`](/bareos/bareos/commit/71c9a0c0ffdf5765169836417915c59099de9342) to
[`5631ca1`](/bareos/bareos/commit/5631ca19f3925716b802f8dd925598b949bdac54)  [Compare](/bareos/bareos/compare/71c9a0c0ffdf5765169836417915c59099de9342..5631ca19f3925716b802f8dd925598b949bdac54)
[July 11, 2024 15:27](#event-13473635312)

 [![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)
[joergsteffens](/joergsteffens)
requested a review
from [sebsura](/sebsura)
[July 11, 2024 15:29](#event-13473671171)

[![sebsura](https://avatars.githubusercontent.com/u/124262655?s=60&v=4)](/sebsura)

**[sebsura](/sebsura)**
approved these changes
[Jul 12, 2024](#pullrequestreview-2173862968)

 [View reviewed changes](/bareos/bareos/pull/1875/files)

Copy link

Contributor

### @sebsura **[sebsura](/sebsura)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for your work!

Sorry, something went wrong.

All reactions

[![@sebsura](https://avatars.githubusercontent.com/u/124262655?s=40&v=4)](/sebsura)
[sebsura](/sebsura)
added this to the [24.0.0](/bareos/bareos/milestone/1) milestone
[Jul 12, 2024](#event-13481737241)

This was referenced Jul 12, 2024

[Fix multiple ACL handling bugs
#1890](/bareos/bareos/pull/1890)
 Merged

[Fix multiple ACL handling bugs
#1891](/bareos/bareos/pull/1891)
 Merged

[Fix multiple ACL handling bugs
#1892](/bareos/bareos/pull/1892)
 Merged

 [joergsteffens](/joergsteffens)
and others
added 6 commits
[July 12, 2024 14:41](#commits-pushed-45c7445)

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[acl: fix command ACL handling](/bareos/bareos/pull/1875/commits/45c74452d4059ebd819b8a52a976ba016239f89a "acl: fix command ACL handling

ACL handling for commands have been wrong.
The UA detect a command, if all typed chars matches the start of a
command string. E.g. \"w\" => \"whoami\", \".cons\" => \".consoles\", ...
The ACL check also only used the typed part of the command,
so if your ACL denies the command \".consoles\",
you could execute it with \".cons\" (or \".co\").
Now we check with the full command string against the ACL.")`
 …

`[45c7445](/bareos/bareos/pull/1875/commits/45c74452d4059ebd819b8a52a976ba016239f89a)`

```
ACL handling for commands have been wrong.
The UA detect a command, if all typed chars matches the start of a
command string. E.g. "w" => "whoami", ".cons" => ".consoles", ...
The ACL check also only used the typed part of the command,
so if your ACL denies the command ".consoles",
you could execute it with ".cons" (or ".co").
Now we check with the full command string against the ACL.
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[acl: fix handling profiles](/bareos/bareos/pull/1875/commits/c609dd1834cfd24af597ade94bf5a200129a73ac "acl: fix handling profiles

When using negative ACLs (ACLs starting with '!')
profiles could have overwritten this entries,
as the code did not distringuish between negative ACL and not found.

Now the ACL checking can have three states:
positive match found,
negative match found,
no match found.

Also unifies the ACL checking
and adding the ACL directive \"!*all*\"
to deny all (before a regex must be used (\"!.*\").")`
 …

`[c609dd1](/bareos/bareos/pull/1875/commits/c609dd1834cfd24af597ade94bf5a200129a73ac)`

```
When using negative ACLs (ACLs starting with '!')
profiles could have overwritten this entries,
as the code did not distringuish between negative ACL and not found.

Now the ACL checking can have three states:
positive match found,
negative match found,
no match found.

Also unifies the ACL checking
and adding the ACL directive "!*all*"
to deny all (before a regex must be used ("!.*").
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[gitignore: ignore __pycache__ everywhere](/bareos/bareos/pull/1875/commits/26b86b70b48a6fe7901bf96bc52241d89b98451a "gitignore: ignore __pycache__ everywhere")`

`[26b86b7](/bareos/bareos/pull/1875/commits/26b86b70b48a6fe7901bf96bc52241d89b98451a)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[systemtests python-bareos: adapt list_unittests.py](/bareos/bareos/pull/1875/commits/f96a56c385e8ab60ecc41bf4690107871b10e47e "systemtests python-bareos: adapt list_unittests.py

Make it work again with current python versions")`
 …

`[f96a56c](/bareos/bareos/pull/1875/commits/f96a56c385e8ab60ecc41bf4690107871b10e47e)`

```
Make it work again with current python versions
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[systemtests: adding more ACL tests](/bareos/bareos/pull/1875/commits/2af8a4ed4e74239304f5c5025f63c8445e721750 "systemtests: adding more ACL tests")`

`[2af8a4e](/bareos/bareos/pull/1875/commits/2af8a4ed4e74239304f5c5025f63c8445e721750)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@sebsura](https://avatars.githubusercontent.com/u/124262655?s=40&v=4)](/sebsura) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[Apply suggestions from code review](/bareos/bareos/pull/1875/commits/982c4cfb398719bb1fa5d59b05ffb750f7d1080c "Apply suggestions from code review

Co-authored-by: Sebastian Sura <124262655+sebsura@users.noreply.github.com>")`
 …

`[982c4cf](/bareos/bareos/pull/1875/commits/982c4cfb398719bb1fa5d59b05ffb750f7d1080c)`

```
Co-authored-by: Sebastian Sura <124262655+sebsura@users.noreply.github.com>
```

 [joergsteffens](/joergsteffens)
and others
added 17 commits
[July 12, 2024 14:41](#commits-pushed-1aa8fe2)

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[systemtests python-bareos: extend ACL test](/bareos/bareos/pull/1875/commits/1aa8fe29f0c78dd513655094c5dda37516b38c05 "systemtests python-bareos: extend ACL test")`

`[1aa8fe2](/bareos/bareos/pull/1875/commits/1aa8fe29f0c78dd513655094c5dda37516b38c05)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[fix output format](/bareos/bareos/pull/1875/commits/942311fb6690dc192a7cb95918d2d9776b0625c7 "fix output format")`

`[942311f](/bareos/bareos/pull/1875/commits/942311fb6690dc192a7cb95918d2d9776b0625c7)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[core: remove manual format chars in cmd usage](/bareos/bareos/pull/1875/commits/0d983a9abdcc29a7e74e8942d4954ddccec01e8e "core: remove manual format chars in cmd usage

The usage strings are rewarped anyway,
so manual formating chars (\"\n\", \"\t\") are only misleading.")`
 …

`[0d983a9](/bareos/bareos/pull/1875/commits/0d983a9abdcc29a7e74e8942d4954ddccec01e8e)`

```
The usage strings are rewarped anyway,
so manual formating chars ("\n", "\t") are only misleading.
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[core: fix ACL parsing error handling](/bareos/bareos/pull/1875/commits/a14322cda1c443730aba803e260dabe30507b1f5 "core: fix ACL parsing error handling

Before an invalid ACL emits and error but has than be igorned.
Now parsing stops at an error and mark the whole configuration as
invalid.")`
 …

`[a14322c](/bareos/bareos/pull/1875/commits/a14322cda1c443730aba803e260dabe30507b1f5)`

```
Before an invalid ACL emits and error but has than be igorned.
Now parsing stops at an error and mark the whole configuration as
invalid.
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[core: WhereACL: adding missing check when modify job](/bareos/bareos/pull/1875/commits/65a5502d4d17e12ed727e2d23f229377b6bc815a "core: WhereACL: adding missing check when modify job")`

`[65a5502](/bareos/bareos/pull/1875/commits/65a5502d4d17e12ed727e2d23f229377b6bc815a)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[core: cleanup](/bareos/bareos/pull/1875/commits/ea241197f5ac660c37e910b094ce5099162b6149 "core: cleanup")`

`[ea24119](/bareos/bareos/pull/1875/commits/ea241197f5ac660c37e910b094ce5099162b6149)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[core: empty Where_ACL allows restoring everywhere](/bareos/bareos/pull/1875/commits/57ab8b254cbd5b44dc50ed2a312b7195c790ba00 "core: empty Where_ACL allows restoring everywhere

This is now implemented like it has been documented.")`
 …

`[57ab8b2](/bareos/bareos/pull/1875/commits/57ab8b254cbd5b44dc50ed2a312b7195c790ba00)`

```
This is now implemented like it has been documented.
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[core: handle WhereACL like all other ACLs](/bareos/bareos/pull/1875/commits/a74c18fe6aaee843f3231c1dd2a34239e742fba3 "core: handle WhereACL like all other ACLs

The documenation and code comments have described that
an empty WhereACL would accept all input, like \"*all*\".
In fact, that has never (?) been implemented in that way,
therefore we removed this special case
and handle the WhereACL like all other ACLs.")`
 …

`[a74c18f](/bareos/bareos/pull/1875/commits/a74c18fe6aaee843f3231c1dd2a34239e742fba3)`

```
The documenation and code comments have described that
an empty WhereACL would accept all input, like "*all*".
In fact, that has never (?) been implemented in that way,
therefore we removed this special case
and handle the WhereACL like all other ACLs.
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[docs: regenerate autogenerated files](/bareos/bareos/pull/1875/commits/3e59d0e4d1db7596117e11feb6d829fd231155a0 "docs: regenerate autogenerated files")`

`[3e59d0e](/bareos/bareos/pull/1875/commits/3e59d0e4d1db7596117e11feb6d829fd231155a0)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[systemtests python-bareos: reuse operator profile](/bareos/bareos/pull/1875/commits/1dcc26236eae737b1beb1104d35a615648a234c7 "systemtests python-bareos: reuse operator profile")`

`[1dcc262](/bareos/bareos/pull/1875/commits/1dcc26236eae737b1beb1104d35a615648a234c7)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[systemtests python-bareos: check WhereACL](/bareos/bareos/pull/1875/commits/d3eaeb352b7a6b81adff5a8bc2ec1d0933139b52 "systemtests python-bareos: check WhereACL")`

`[d3eaeb3](/bareos/bareos/pull/1875/commits/d3eaeb352b7a6b81adff5a8bc2ec1d0933139b52)`

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[systemtests: prevent problems with WhereACL path](/bareos/bareos/pull/1875/commits/faa34dbeadef51f1defe45bb879c9ebab776bd97 "systemtests: prevent problems with WhereACL path

In some automated systemtests, the path did contain the \"~\",
which is considerd invalid in a WhereACL.
Changed the WhereACL to circumvent that.")`
 …

`[faa34db](/bareos/bareos/pull/1875/commits/faa34dbeadef51f1defe45bb879c9ebab776bd97)`

```
In some automated systemtests, the path did contain the "~",
which is considerd invalid in a WhereACL.
Changed the WhereACL to circumvent that.
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[systemtests: replace config-syntax-crash test](/bareos/bareos/pull/1875/commits/16e2fbf8167a6f572f61b50629057926848dcee2 "systemtests: replace config-syntax-crash test

Invalid chars in WhereAcls are now properly marked as configuration
errors. Therefore in the original test config-syntax-crash, the Bareos
Director refuses to start (with a proper error message), instead of just
ignoring the invalid entry.
Instead of adapting the config-syntax-crash, the test for invalid chars
is now added to the python-bareos tests and the config-syntax-crash
removed.")`
 …

`[16e2fbf](/bareos/bareos/pull/1875/commits/16e2fbf8167a6f572f61b50629057926848dcee2)`

```
Invalid chars in WhereAcls are now properly marked as configuration
errors. Therefore in the original test config-syntax-crash, the Bareos
Director refuses to start (with a proper error message), instead of just
ignoring the invalid entry.
Instead of adapting the config-syntax-crash, the test for invalid chars
is now added to the python-bareos tests and the config-syntax-crash
removed.
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@sebsura](https://avatars.githubusercontent.com/u/124262655?s=40&v=4)](/sebsura) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[Update systemtests/python-modules/bareos_unittest/json.py](/bareos/bareos/pull/1875/commits/fc4a8a2fc02a3154045b2ff47f6b9cf17a2f1a1d "Update systemtests/python-modules/bareos_unittest/json.py

Co-authored-by: Sebastian Sura <124262655+sebsura@users.noreply.github.com>")`
 …

`[fc4a8a2](/bareos/bareos/pull/1875/commits/fc4a8a2fc02a3154045b2ff47f6b9cf17a2f1a1d)`

```
Co-authored-by: Sebastian Sura <124262655+sebsura@users.noreply.github.com>
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[core: always allow 'exit' cmd](/bareos/bareos/pull/1875/commits/84dbca4f63682bd5f7042a9dc8b88d051e69a670 "core: always allow 'exit' cmd

exit is an alias to quit,
so handle exit identical as quit.")`
 …

`[84dbca4](/bareos/bareos/pull/1875/commits/84dbca4f63682bd5f7042a9dc8b88d051e69a670)`

```
exit is an alias to quit,
so handle exit identical as quit.
```

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[core: handle PluginOptionsACL and regexwhere](/bareos/bareos/pull/1875/commits/c38a9ac2b8faf7cb39d45df75d1facb519d6ef43 "core: handle PluginOptionsACL and regexwhere

On ModifyJobParameters,
check PluginOptionsACL
and the WhereACL also for regexwhere.")`
 …

`[c38a9ac](/bareos/bareos/pull/1875/commits/c38a9ac2b8faf7cb39d45df75d1facb519d6ef43)`

```
On ModifyJobParameters,
check PluginOptionsACL
and the WhereACL also for regexwhere.
```

[![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[Update CHANGELOG.md](/bareos/bareos/pull/1875/commits/af86d445fb389917d2410f1eaca4ff2af62debb1 "Update CHANGELOG.md")`

`[af86d44](/bareos/bareos/pull/1875/commits/af86d445fb389917d2410f1eaca4ff2af62debb1)`

 [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&u=c0379adb38ce0547fac3a9ed872306dba203baa5&v=4)](/BareosBot)
[BareosBot](/BareosBot)
[force-pushed](/bareos/bareos/compare/4fd5ecc745e18102b26a80ef77c8c3f375fa4564..af86d445fb389917d2410f1eaca4ff2af62debb1)
the
dev/joergs/master/acl-fix

branch
from
[`4fd5ecc`](/bareos/bareos/commit/4fd5ecc745e18102b26a80ef77c8c3f375fa4564) to
[`af86d44`](/bareos/bareos/commit/af86d445fb389917d2410f1eaca4ff2af62debb1)  [Compare](/bareos/bareos/compare/4fd5ecc745e18102b26a80ef77c8c3f375fa4564..af86d445fb389917d2410f1eaca4ff2af62debb1)
[July 12, 2024 14:41](#event-13488404427)

[![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&u=c0379adb38ce0547fac3a9ed872306dba203baa5&v=4)](/BareosBot)
[BareosBot](/BareosBot)
merged commit [`2a02669`](/bareos/bareos/commit/2a026698b87d13bd1c6275726b5e826702f81dd5)
into
bareos:master

[Jul 12, 2024](https://github.com/bareos/bareos/pull/1875#event-13488405578)

[joergsteffens](/joergsteffens)
added a commit
to joergsteffens/bareos
that referenced
this pull request
[Jul 12, 2024](#ref-commit-6971823)
[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)

`[docs rear: use rear profile](/joergsteffens/bareos/commit/6971823ec69bf19d48523e4a8c42c888a7bda8ca "docs rear: use rear profile

As https://github.com/bareos/bareos/pull/1875 and its backports (down
to bareos-21) have been merged, we could simply the ReaR configuration
by using a standard Profile.")`
…

`[6971823](/joergsteffens/bareos/commit/6971823ec69bf19d48523e4a8c42c888a7bda8ca)`

```
As [bareos#1875](https://github.com/bareos/bareos/pull/1875) and its backports (down
to bareos-21) have been merged, we could simply the ReaR configuration
by using a standard Profile.
```

[joergsteffens](/joergsteffens)
added a commit
to joergsteffens/bareos
that referenced
this pull request
[Jul 12, 2024](#ref-commit-7dcd940)
[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)

`[docs rear: use rear profile](/joergsteffens/bareos/commit/7dcd9405f7d3f1c222bfdc6b51e677986e0a804a "docs rear: use rear profile

As https://github.com/bareos/bareos/pull/1875 and its backports (down
to bareos-21) have been merged, we could simplify the ReaR configuration
by using a standard Profile.")`
…

`[7dcd940](/joergsteffens/bareos/commit/7dcd9405f7d3f1c222bfdc6b51e677986e0a804a)`

```
As [bareos#1875](https://github.com/bareos/bareos/pull/1875) and its backports (down
to bareos-21) have been merged, we could simplify the ReaR configuration
by using a standard Profile.
```

[joergsteffens](/joergsteffens)
added a commit
to joergsteffens/bareos
that referenced
this pull request
[Jul 12, 2024](#ref-commit-a90071a)
[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)

`[docs rear: use rear profile](/joergsteffens/bareos/commit/a90071a451987e67e2d08e619e7e1a33f1b63cfb "docs rear: use rear profile

As https://github.com/bareos/bareos/pull/1875 and its backports (down
to bareos-21) have been merged, we could simplify the ReaR configuration
by using a standard Profile.")`
…

`[a90071a](/joergsteffens/bareos/commit/a90071a451987e67e2d08e619e7e1a33f1b63cfb)`

```
As [bareos#1875](https://github.com/bareos/bareos/pull/1875) and its backports (down
to bareos-21) have been merged, we could simplify the ReaR configuration
by using a standard Profile.
```

[BareosBot](/BareosBot)
pushed a commit
to joergsteffens/bareos
that referenced
this pull request
[Jul 12, 2024](#ref-commit-986be40)
[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=40&v=4)](/BareosBot)

`[docs rear: use rear profile](/joergsteffens/bareos/commit/986be40b34a7b4341679da46b4f7d7c35c138dcf "docs rear: use rear profile

As https://github.com/bareos/bareos/pull/1875 and its backports (down
to bareos-21) have been merged, we could simplify the ReaR configuration
by using a standard Profile.")`
…

`[986be40](/joergsteffens/bareos/commit/986be40b34a7b4341679da46b4f7d7c35c138dcf)`

```
As [bareos#1875](https://github.com/bareos/bareos/pull/1875) and its backports (down
to bareos-21) have been merged, we could simplify the ReaR configuration
by using a standard Profile.
```

 [![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens)
[joergsteffens](/joergsteffens)
deleted the
dev/joergs/master/acl-fix

branch
[September 25, 2024 15:49](#event-14401565275)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fbareos%2Fbareos%2Fpull%2F1875)

Reviewers

[![@sebsura](https://avatars.githubusercontent.com/u/124262655?s=40&v=4)](/sebsura) [sebsura](/sebsura)

sebsura approved these changes

Assignees

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=40&v=4)](/joergsteffens) [joergsteffens](/joergsteffens)

Labels

[bugfix](/bareos/bareos/labels/bugfix)
[requires backport to 21](/bareos/bareos/labels/requires%20backport%20to%2021)
[requires backport to 22](/bareos/bareos/labels/requires%20backport%20to%2022)
[requires backport to 23](/bareos/bareos/labels/requires%20backport%20to%2023)

Projects

None yet

Milestone

 [**24.0.0**](/bareos/bareos/milestone/1 "24.0.0")

Development

Successfully merging this pull request may close these issues.

4 participants

[![@joergsteffens](https://avatars.githubusercontent.com/u/2428180?s=52&v=4)](/joergsteffens) [![@sebsura](https://avatars.githubusercontent.com/u/124262655?s=52&v=4)](/sebsura) [![@arogge](https://avatars.githubusercontent.com/u/22479968?s=52&v=4)](/arogge) [![@BareosBot](https://avatars.githubusercontent.com/u/102356597?s=52&v=4)](/BareosBot)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

