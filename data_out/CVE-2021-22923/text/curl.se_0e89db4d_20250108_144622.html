
[Docs Overview](/docs/ "Documentation Overview")
[Project](/docs/projdocs.html)
[Bug Bounty](/docs/bugbounty.html)
[Bug Report](/docs/bugs.html)
[Code of conduct](/docs/code-of-conduct.html)
[Dependencies](/docs/libs.html)
[Donate](/donation.html)
[FAQ](/docs/faq.html)
[Features](/docs/features.html)
[Governance](/docs/governance.html)
[History](/docs/history.html)
[Install](/docs/install.html)
[Known Bugs](/docs/knownbugs.html)
[Logo](/logo/)
[TODO](/docs/todo.html)
[website Info](/about.html)

[Protocols](/docs/protdocs.html)
[CA Extract](/docs/caextract.html)
[HTTP cookies](/docs/http-cookies.html)
[HTTP/3](/docs/http3.html)
[MQTT](/docs/mqtt.html)
[SSL certs](/docs/sslcerts.html)
[SSL libs compared](/docs/ssl-compared.html)
[URL syntax](/docs/url-syntax.html)
[WebSocket](/docs/websocket.html)

[Releases](/docs/reldocs.html)
[Changelog](/ch/)
[curl CVEs](/docs/security.html)
[Release Table](/docs/releases.html)
[Version Numbering](/docs/versions.html)
[Vulnerabilities](/docs/vulnerabilities.html)

[Tool](/docs/tooldocs.html)
[Comparison Table](/docs/comparison-table.html)
[curl man page](/docs/manpage.html)
[HTTP Scripting](/docs/httpscripting.html)
[mk-ca-bundle](/docs/mk-ca-bundle.html)
[Tutorial](/docs/tutorial.html)
[When options were added](optionswhen.html)

[Who and Why](/docs/whodocs.html)
[Companies](/docs/companies.html)
[Copyright](/docs/copyright.html)
[Sponsors](/sponsors.html)
[Thanks](/docs/thanks.html)
[The name](/docs/thename.html)

[curl](/) / [Docs](/docs/) / [curl CVEs](/docs/security.html) / **Metalink download sends credentials**
**Related:**

[Audits](audits.html)

[Bug Bounty](/docs/bugbounty.html)

[Changelog](/ch/)

[curl CVEs](security.html)

[JSON metadata](CVE-2021-22923.json)

[Original report](https://hackerone.com/reports/1213181)

[Vulnerability Disclosure](/dev/vuln-disclosure.html)

[Vulnerabilities Table](vulnerabilities.html)

Awarded 700 USD

## CVE-2021-22923

# Metalink download sends credentials

Project curl Security Advisory, July 21th 2021 - [Permalink](https://curl.se/docs/CVE-2021-22923.html)

## VULNERABILITY

When curl is instructed to get content using the Metalink feature,
and a user name and password are used to download the Metalink XML file,
those same credentials are then subsequently passed on to each of the
servers from which curl downloads or tries to download the contents
from. Often contrary to the user's expectations and intentions and
without telling the user it happened.

## INFO

This flaw exists only in the curl tool. libcurl is not affected.

The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2021-22923 to this issue.

CWE-522: Insufficiently Protected Credentials

Severity: Medium

## AFFECTED VERSIONS

* Affected versions: curl [7.27.0](vuln-7.27.0.html) to and including [7.77.0](vuln-7.77.0.html)
* Not affected versions: curl < [7.27.0](vuln-7.27.0.html) and curl >= [7.78.0](vuln-7.78.0.html)
* Introduced-in: <https://github.com/curl/curl/commit/b5fdbe848bc3d>

## SOLUTION

curl has completely removed the Metalink feature as of [7.78.0](vuln-7.78.0.html). No fix
for this flaw is produced by the curl project.

The fix for earlier versions is to rebuild curl with the Metalink
support switched off!

* Fixed-in: <https://github.com/curl/curl/commit/265b14d6b37c4298bd5556>

## RECOMMENDATIONS

A - Upgrade curl to version [7.78.0](vuln-7.78.0.html)

B - Make sure you do not use Metalink with curl

C - Disable Metalink in your build

## TIMELINE

This issue was reported to the curl project on May 30, 2021.

This advisory was posted on Jul 21, 2021.

## CREDITS

* Reported-by: Harry Sintonen
* Patched-by: Daniel Stenberg

Thanks a lot!

