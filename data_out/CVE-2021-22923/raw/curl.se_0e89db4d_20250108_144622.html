<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head> <title>curl - Metalink download sends credentials - CVE-2021-22923</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="/curl.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/logo/curl-symbol.svg" type="image/svg+xml">
<link rel="alternate" type="application/rss+xml" title="cURL Releases" href="https://github.com/curl/curl/releases.atom">
<link rel="stylesheet" type="text/css" href="/manpage.css">
<style>
code {
    padding: 0px 4px 0px 4px;
    background-color: #f0f0f0;
}
 (prefers-color-scheme: dark) {
    code {
        padding: 0px 4px 0px 4px;
        background-color: #101010;
    }
}
</style>
</head>
<body>
<div class="main">
<div class="menu">
<a href="/docs/" class="menuitem" title="Documentation Overview">Docs Overview</a>
<div class="dropdown">
  <a class="dropbtn" href="/docs/projdocs.html">Project</a>
  <div class="dropdown-content">
    <a href="/docs/bugbounty.html">Bug Bounty</a>
    <a href="/docs/bugs.html">Bug Report</a>
    <a href="/docs/code-of-conduct.html">Code of conduct</a>
    <a href="/docs/libs.html">Dependencies</a>
    <a href="/donation.html">Donate</a>
    <a href="/docs/faq.html">FAQ</a>
    <a href="/docs/features.html">Features</a>
    <a href="/docs/governance.html">Governance</a>
    <a href="/docs/history.html">History</a>
    <a href="/docs/install.html">Install</a>
    <a href="/docs/knownbugs.html">Known Bugs</a>
    <a href="/logo/">Logo</a>
    <a href="/docs/todo.html">TODO</a>
    <a href="/about.html">website Info</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/protdocs.html">Protocols</a>
  <div class="dropdown-content">
    <a href="/docs/caextract.html">CA Extract</a>
    <a href="/docs/http-cookies.html">HTTP cookies</a>
    <a href="/docs/http3.html">HTTP/3</a>
    <a href="/docs/mqtt.html">MQTT</a>
    <a href="/docs/sslcerts.html">SSL certs</a>
    <a href="/docs/ssl-compared.html">SSL libs compared</a>
    <a href="/docs/url-syntax.html">URL syntax</a>
    <a href="/docs/websocket.html">WebSocket</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/reldocs.html">Releases</a>
  <div class="dropdown-content">
    <a href="/ch/">Changelog</a>
    <a href="/docs/security.html">curl CVEs</a>
    <a href="/docs/releases.html">Release Table</a>
    <a href="/docs/versions.html">Version Numbering</a>
    <a href="/docs/vulnerabilities.html">Vulnerabilities</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/tooldocs.html">Tool</a>
  <div class="dropdown-content">
    <a href="/docs/comparison-table.html">Comparison Table</a>
    <a href="/docs/manpage.html">curl man page</a>
    <a href="/docs/httpscripting.html">HTTP Scripting</a>
    <a href="/docs/mk-ca-bundle.html">mk-ca-bundle</a>
    <a href="/docs/tutorial.html">Tutorial</a>
    <a href="optionswhen.html">When options were added</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/whodocs.html">Who and Why</a>
  <div class="dropdown-content">
    <a href="/docs/companies.html">Companies</a>
    <a href="/docs/copyright.html">Copyright</a>
    <a href="/sponsors.html">Sponsors</a>
    <a href="/docs/thanks.html">Thanks</a>
    <a href="/docs/thename.html">The name</a>
  </div>
</div>
</div>
<div class="contents">
<div class="where"><a href="/">curl</a> / <a href="/docs/">Docs</a> / <a href="/docs/security.html">curl CVEs</a> / <b>Metalink download sends credentials</b></div>
<div class="relatedbox">
<b>Related:</b>
<br><a href="audits.html">Audits</a>
<br><a href="/docs/bugbounty.html">Bug Bounty</a>
<br><a href="/ch/">Changelog</a>
<br><a href="security.html">curl CVEs</a>
<br><a href="CVE-2021-22923.json">JSON metadata</a>
<br><a href="https://hackerone.com/reports/1213181">Original report</a>
<br><a href="/dev/vuln-disclosure.html">Vulnerability Disclosure</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<div class="relatedbox">
Awarded 700 USD<br>
</div>
<h2>CVE-2021-22923</h2>
<h1 id="metalink-download-sends-credentials">Metalink download sends
credentials</h1>
<p>Project curl Security Advisory, July 21th 2021 - <a
href="https://curl.se/docs/CVE-2021-22923.html">Permalink</a></p>
<h2 id="vulnerability">VULNERABILITY</h2>
<p>When curl is instructed to get content using the Metalink feature,
and a user name and password are used to download the Metalink XML file,
those same credentials are then subsequently passed on to each of the
servers from which curl downloads or tries to download the contents
from. Often contrary to the user's expectations and intentions and
without telling the user it happened.</p>
<h2 id="info">INFO</h2>
<p>This flaw exists only in the curl tool. libcurl is not affected.</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2021-22923 to this issue.</p>
<p>CWE-522: Insufficiently Protected Credentials</p>
<p>Severity: Medium</p>
<h2 id="affected-versions">AFFECTED VERSIONS</h2>
<ul>
<li>Affected versions: curl <a href="vuln-7.27.0.html">7.27.0</a> to and including <a href="vuln-7.77.0.html">7.77.0</a></li>
<li>Not affected versions: curl &lt; <a href="vuln-7.27.0.html">7.27.0</a> and curl &gt;= <a href="vuln-7.78.0.html">7.78.0</a></li>
<li>Introduced-in: <a
href="https://github.com/curl/curl/commit/b5fdbe848bc3d">https://github.com/curl/curl/commit/b5fdbe848bc3d</a></li>
</ul>
<h2 id="solution">SOLUTION</h2>
<p>curl has completely removed the Metalink feature as of <a href="vuln-7.78.0.html">7.78.0</a>. No fix
for this flaw is produced by the curl project.</p>
<p>The fix for earlier versions is to rebuild curl with the Metalink
support switched off!</p>
<ul>
<li>Fixed-in: <a
href="https://github.com/curl/curl/commit/265b14d6b37c4298bd5556">https://github.com/curl/curl/commit/265b14d6b37c4298bd5556</a></li>
</ul>
<h2 id="recommendations">RECOMMENDATIONS</h2>
<p>A - Upgrade curl to version <a href="vuln-7.78.0.html">7.78.0</a></p>
<p>B - Make sure you do not use Metalink with curl</p>
<p>C - Disable Metalink in your build</p>
<h2 id="timeline">TIMELINE</h2>
<p>This issue was reported to the curl project on May 30, 2021.</p>
<p>This advisory was posted on Jul 21, 2021.</p>
<h2 id="credits">CREDITS</h2>
<ul>
<li>Reported-by: Harry Sintonen</li>
<li>Patched-by: Daniel Stenberg</li>
</ul>
<p>Thanks a lot!</p>
</div>
</div>
</body> </html>
