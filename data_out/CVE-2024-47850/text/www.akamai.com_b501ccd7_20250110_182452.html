

Twitter
LinkedIn
Email

![](data:image/png;base64...)

Close

X

Skip to main content

Need cloud computing?
[Get started now](https://www.linode.com/)

Close Button

[![Akamai logo](/site/ko/images/logo/akamai-logo1.svg)](/)

+1-8774252624

+1-8774252624

Login
[Control Center

Access the Akamai platform](https://control.akamai.com/)

[Cloud Manager

Manage your cloud resources](https://login.linode.com/login)

en

* [English](/blog/security-research/october-cups-ddos-threat "English")
* [Deutsch](/de/blog/security-research/october-cups-ddos-threat " Deutsch")
* [Español](/es/blog/security-research/october-cups-ddos-threat "Español")
* [Français](/fr/blog/security-research/october-cups-ddos-threat "Français")
* [Italiano](/it/blog/security-research/october-cups-ddos-threat "Italiano")
* [Português](/pt/blog/security-research/october-cups-ddos-threat " Português")
* [中文](/zh/blog/security-research/october-cups-ddos-threat "中文")
* [日本語](/ja/blog/security-research/october-cups-ddos-threat "日本語")
* [한국어](/ko/blog/security-research/october-cups-ddos-threat "한국어")

[Try Akamai](/products#free-trials)

[Under Attack?](/why-akamai/stop-cyberthreats)

Back

1. Products
2. Solutions
3. Why Akamai
4. Resources
5. Partners
6. Contact Us

+1-8774252624

Back

#### Products

Back

1. Security
2. Cloud Computing
3. Content Delivery
4. [All Products and Trials](/products)
5. [Global Services](/global-services)

+1-8774252624

Back

#### Security

### Security

[Learn more](/solutions/security)

###### App and API Security

 [API Security](/products/api-security)

Discover and monitor API behavior to respond to threats and abuse

 [App & API Protector](/products/app-and-api-protector)

Protect web apps and APIs from DDoS, bots, and OWASP Top 10 exploits

 [Client-Side Protection & Compliance](/products/client-side-protection-compliance)

Assist with PCI compliance and protect against client-side attacks

###### Zero Trust Security

 [Akamai Guardicore Platform](/products/akamai-guardicore-platform)

One Zero Trust platform for coverage, visibility, and granular control.

 [Akamai Guardicore Segmentation](/products/akamai-guardicore-segmentation)

Mitigate risk in your network with granular, flexible segmentation

 [Secure Internet Access](/products/secure-internet-access-enterprise)

Proactively protect against zero-day malware and phishing

 [Hunt](/products/hunt)

Stop the most evasive threats with proactive threat hunting

 [Enterprise Application Access](/products/enterprise-application-access)

Granular application access based on identity and context

 [Akamai MFA](/products/akamai-mfa)

Harden against account takeovers and data breaches with phish-proof MFA

###### Bot & Abuse Protection

 [Account Protector](/products/account-protector)

Mitigate account abuse and grow your digital business

 [Content Protector](/products/content-protector)

Stop scrapers, protect intellectual property, and increase conversion

 [Brand Protector](/products/brand-protector)

Detect and mitigate fraudulent representations of your brand

 [Bot Manager](/products/bot-manager)

Welcome the bots you want and mitigate those you don’t

 [Identity Cloud](/products/identity-cloud)

Add secure, cloud-based identity management to your websites or apps

###### INFRASTRUCTURE SECURITY

 [Edge DNS](/products/edge-dns)

External authoritative solution for your DNS infrastructure

 [Prolexic](/products/prolexic-solutions)

Protect your infrastructure from distributed denial-of-service attacks

 [IP Accelerator](/products/ip-accelerator)

Boost network performance and security for IP-based applications

#### Cloud Computing

### Cloud Computing

[Learn more](/solutions/cloud-computing)

[Create a Cloud Account](/create-account)

Compute

Build, release, and scale faster with VMs for every workload

[See all](/solutions/cloud-computing/compute)

Networking

Secure your network, balance traffic, control your infrastructure

[See all](/solutions/cloud-computing/networking)

Containers

Efficiently orchestrate containerized applications

[See all](/solutions/cloud-computing/containers)

Developer Tools

Get the most out of your applications with advanced management tools

[See all](/solutions/cloud-computing/developer-tools)

Storage

Deploy dependable, easily accessible storage and management

[See all](/solutions/cloud-computing/storage)

Databases

Scale easily with simple and reliable managed databases

[See all](/solutions/cloud-computing/databases)

[Create a Cloud Account](/create-account)

#### Content Delivery

### Content Delivery

[Learn more](/solutions/content-delivery-network)

###### APPLICATION PERFORMANCE

 [Ion](/products/web-performance-optimization)

Improve the performance and reliability of your website at scale

 [API Acceleration](/products/api-acceleration)

Improve the performance and reliability of your APIs at scale

 [IP Accelerator](/products/ip-accelerator)

Boost network performance and security for IP-based applications

###### MEDIA DELIVERY

 [Adaptive Media Delivery](/products/adaptive-media-delivery)

High-quality video delivery for any screen to global audiences

 [Download Delivery](/products/download-delivery)

Deliver large file downloads flawlessly, every time, at global scale

###### EDGE APPLICATIONS

 [EdgeWorkers](/products/serverless-computing-edgeworkers)

Execute custom JavaScript at the edge, near users, to optimize UX

 [EdgeKV](/products/edgekv)

Distributed key-value store database at the edge

 [Image & Video Manager](/products/image-and-video-manager)

Automatically optimize images and video for every user, on any device

 [Cloudlets](/products/cloudlets)

Predefined apps that run at the edge for specific business needs

 [Cloud Wrapper](/products/cloud-wrapper)

Use an efficient caching layer to improve origin offload

 [Global Traffic Management](/products/global-traffic-management)

Optimize performance with intelligent load balancing

###### MONITORING, REPORTING, AND TESTING

 [DataStream](/products/datastream)

Low-latency data feed for visibility and ingest into third-party tools

 [mPulse](/products/mpulse-real-user-monitoring)

Measure the business impact of real user experiences in real time

 [CloudTest](/products/cloudtest)

Site and application load testing at global scale

#### Solutions

Back

1. Use Cases
2. Industry Solutions

+1-8774252624

Back

#### Use Cases

## CLOUD COMPUTING

 [Media](/solutions/cloud-computing/media)

Deliver an engaging, interactive video experience

 [SaaS](/solutions/cloud-computing/saas)

Build with portability, performance, and efficiency from cloud to client

 [Gaming](/solutions/cloud-computing/gaming)

Improve the gamer experience with low latency and high availability

## SECURITY

 [Ransomware Protection](/solutions/ransomware-protection)

Mitigate attacks by limiting malware ingress and stopping lateral movement

 [Apps and APIs](/solutions/security/app-and-api-security)

Protect your brand by securing apps and APIs from persistent threats

 [Zero Trust](/solutions/security/zero-trust-security)

Solutions for comprehensive coverage, visibility and control

 [DDoS Protection](/solutions/security/ddos-protection)

Protect your infrastructure from DDoS and DNS attacks

 [Bot & Abuse Protection](/solutions/security/bot-and-abuse-protection)

Stop account abuse, sophisticated bot attacks, and brand impersonation

## CONTENT DELIVERY

 [App and API Performance](/solutions/content-delivery-network/app-and-api-performance)

Improve user engagement through app & API optimization

 [Media Delivery](/solutions/content-delivery-network/media-delivery)

Deliver seamless streaming and download experiences to any device

 [Edge Compute](/solutions/edge)

Build and deploy on the world’s most distributed edge platform

#### Industry Solutions

 [Media and Entertainment](/solutions/industries/media)

 [Retail, Travel, and Hospitality](/solutions/industries/retail-travel-hospitality)

 [Financial Services](/solutions/industries/financial-services)

 [Healthcare and Life Sciences](/solutions/industries/health-care-life-sciences)

 [Public Sector](/solutions/industries/public-sector)

 [Games](/solutions/industries/games)

 [iGaming and Sports Betting](/solutions/industries/online-sports-betting)

 [Publishing](/solutions/industries/publishing)

 [Service Providers](/solutions/industries/service-providers)

#### Why Akamai

Why Akamai

Discover Akamai Connected Cloud

[Learn more](/why-akamai)

Our Platform

Explore our global infrastructure

[Learn more](/why-akamai/global-infrastructure)

Company

See how we power and protect life online

[Learn more](/company)

#### Resources

Back

1. Library
2. Learn
3. Security Research
4. [TechDocs](https://techdocs.akamai.com/home)
5. [Developer Resources](/developer)
6. [Blog](/blog)
7. [Events](/resources/events)

+1-8774252624

Back

#### Library

### Library

[See all](/resources)

 [Product Briefs](/resources/product-brief)

 [Reference Architectures](/resources/reference-architecture)

 [Customer Stories](/resources/customer-story)

 [Ebooks](/resources/ebook)

 [White Papers](/resources/white-paper)

 [Webinars](/resources/webinar)

 [Videos](/resources/video)

#### Learn

 [Learning Hub](/learn)

Educational resources and training for Akamai products and services

 [Glossary](/glossary)

Key concepts in security, cloud computing, and content delivery

#### Security Research

 [Akamai Security Research](/security-research)

Insights and intelligence from the Akamai Security Intelligence Group

 [State of the Internet (SOTI) Reports](/security-research/the-state-of-the-internet)

In-depth analysis of the latest cybersecurity research and trends

#### Partners

Back

1. Find a Partner
2. Become a Partner
3. [Cloud Computing Marketplace](https://www.linode.com/marketplace/)

+1-8774252624

Back

#### Find a Partner

 [Why Choose an Akamai Partner](/partners/overview)

Learn about our industry-leading ecosystem of partners

 [Partner Directory](/partners/partner-directory)

Find a channel or technology partner

#### Become a Partner

 [Channel Partners](/partners/channel)

Unlock more profit, focus on what matters, and deliver with confidence

 [Technology Partners](/partners/technology)

Create more value for joint customers with seamless integrations

#### Contact Us

Contact Sales

Have questions? We can help.

[Contact us](/why-akamai/contact-us/contact-sales)

Customer Support

Need technical support? We are here 24/7.

[Get support](/global-services/support)

Login
[Control Center

Access the Akamai platform](https://control.akamai.com/)

[Cloud Manager

Manage your cloud resources](https://login.linode.com/login)

en

* [English](/blog/security-research/october-cups-ddos-threat "English")
* [Deutsch](/de/blog/security-research/october-cups-ddos-threat " Deutsch")
* [Español](/es/blog/security-research/october-cups-ddos-threat "Español")
* [Français](/fr/blog/security-research/october-cups-ddos-threat "Français")
* [Italiano](/it/blog/security-research/october-cups-ddos-threat "Italiano")
* [Português](/pt/blog/security-research/october-cups-ddos-threat " Português")
* [中文](/zh/blog/security-research/october-cups-ddos-threat "中文")
* [日本語](/ja/blog/security-research/october-cups-ddos-threat "日本語")
* [한국어](/ko/blog/security-research/october-cups-ddos-threat "한국어")

1. [Blog](/blog)
2. [Security Research](/blog/security-research)
3. When CUPS Runneth Over: The Threat of DDoS

# When CUPS Runneth Over: The Threat of DDoS

![Akamai Wave Blue](/site/en/images/blog/userpics/akamai-wave-blog-author.png)

Written by

[Larry Cashdollar](/blog?author=larry_cashdollar), [Kyle Lefton](/blog?author=kyle-lefton), and [Chad Seaman](/blog?author=chad_seaman)

October 01, 2024

![Larry Cashdollar](/site/en/images/blog/userpics/larry-cashdollar.jpeg)

Written by

[Larry Cashdollar](/blog?author=larry_cashdollar)

Larry Cashdollar has been working in the security field as a vulnerability researcher for more than 20 years and is currently a Principal Security Researcher on the Security Intelligence Response Team at Akamai. He studied computer science at the University of Southern Maine. Larry has documented more than 300 CVEs and has presented his research at BotConf, BSidesBoston, OWASP Rhode Island, and DEF CON. He enjoys the outdoors and rebuilding small engines in his spare time.

![Akamai Wave Blue](/site/en/images/blog/userpics/akamai-wave-blog-author.png)

Written by

[Kyle Lefton](/blog?author=kyle-lefton)

Kyle Lefton is a security researcher on Akamai's Security Intelligence Response Team. Formerly an intelligence analyst for the Department of Defense, Kyle has experience in cyber defense, threat research, and counter-intelligence, spanning several years. He takes pride in investigating emerging threats, vulnerability research, and threat group mapping. In his free time, he enjoys spending time with friends and family, strategy games, and hiking in the great outdoors.

![Chad Seaman headshot](/site/en/images/blog/userpics/userpic-666-100x100.png)

Written by

[Chad Seaman](/blog?author=chad_seaman)

Chad Seaman is a Principal Security Researcher and Team Lead of Akamai’s Security Intelligence Response Team. He proudly refers to himself as an “Internet Dumpster Diver,” and enjoys looking through the muck and mire he finds there. Chad began his career as a programmer, and after being exposed to security, exploitation, and forensics via breach investigations, security quickly became his preferred work. He now spends his time engulfed in malware investigations, reverse engineering, vulnerability research, DDoS, and cybercrime investigations. He likes flying airplanes, poking holes in paper at a distance, and spending time in nature, preferably in the woods, on a trail, or on a dirt bike.

Share

![It would take an attacker mere seconds to co-opt every vulnerable CUPS service currently exposed on the internet.](/site/en/images/blog/2024/thumbnails/edge-1080x608-1.png)
It would take an attacker mere seconds to co-opt every vulnerable CUPS service currently exposed on the internet.

Editorial and additional commentary by Tricia Howard

## Executive summary

* Akamai researchers have confirmed a new attack vector using CUPS that could be leveraged to stage distributed denial-of-service (DDoS) attacks. (CVE-2024-47850)
* Research shows that, to begin the attack, the attacking system only needs to send a single packet to a vulnerable and exposed CUPS service with internet connectivity.
* The Akamai Security Intelligence and Response Team (SIRT) found that more than 198,000 devices are vulnerable to this attack vector and are accessible on the public internet; roughly 34% of those could be used for DDoS abuse (58,000+).
* Of the 58,000+ vulnerable devices, hundreds exhibited an “infinite loop” of requests.
* The limited resources required to initiate a successful attack highlights the danger: **It would take an attacker mere seconds to co-opt every vulnerable CUPS service currently exposed on the internet and cost the attacker less than a single US cent on modern hyperscaler platforms**.

[Jump to mitigations](#cups)

## The CVEs

On September 26, 2024, security researcher evilsocket [disclosed](https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/) remote code execution (RCE) vulnerabilities within the Common Unix Printing System (CUPS). In short, an attacker could [manipulate Internet Printing Protocol (IPP) URLs remotely](/blog/security-research/guidance-on-critical-cups-rce) to execute malicious commands. This could be done by chaining together four different vulnerabilities.

1. **CVE-2024-47176** in *cups-browsed*, which coerces a request to an attacker-controlled address
2. **CVE-2024-47076** in *libcupsfilters*, which does not validate or sanitize data returned from the attacker’s server, and passes it to the rest of the CUPS system
3. **CVE-2024-47175** in *libppd*, which again involves not sanitizing input, and writing it to a temporary file
4. **CVE-2024-47177** in *cups-filters*, which allows for an arbitrary command execution

## More to the CUPS story

While reviewing the technical write-up about the vulnerabilities, we discovered that another attack vector was not discussed: [DDoS](https://nvd.nist.gov/vuln/detail/CVE-2024-47850). DDoS continues to be a viable attack vector used to harass and disrupt victims across the internet, from major industries and governments to small content creators, online shops, and gamers. Although the original analysis focused on the RCE, which could have a more severe outcome, DDoS amplification is also easily abused in this case.

The problem arises when an attacker sends a crafted packet specifying the address of a target as a printer to be added. For each packet sent, the vulnerable CUPS server will generate a larger and partially attacker-controlled IPP/HTTP request directed at the specified target. **As a result, not only is the target affected, but the host of the CUPS server also becomes a victim, as the attack consumes its network bandwidth and CPU resources**.

## Exploitation

A simple script can be used to send the malicious UDP packet to a vulnerable instance of CUPS. The crafted payload directs CUPS to send an IPP/HTTP request to the target and port specified by the attacker. **The vulnerability appears when *cups-browsed* attempts to fetch the URI specified to download the IPP attributes file**.

This PPD file URI is somewhat arbitrary and can be modified by the attacker. In testing, we found this URI payload can be padded out to 989 bytes. This padding will be included twice in the IPP/HTTP request: once in the HTTP headers, and again in the POST data that will be directed at the targeted system.

By using this padding technique, attackers could further exacerbate the impact of CUPS-supported DDoS attacks by consuming additional bandwidth and resources on the targeted networks and systems. Figure 1 is a visual representation of what this would look like.

![ Figure 1 is a visual representation of what this would look like.](/site/en/images/blog/2024/october-cups-ddos-threat-one.jpg)
Fig. 1: Network diagram of attack flow

### Attacking system

One of the more troubling facets of this threat is how few resources are needed by the attacker to execute it. Figures 2 and 3 show **the attacking system only needs to send a single packet to a vulnerable and exposed CUPS service with internet connectivity to cause the system running CUPS to begin the attack.**

```

  ./cups.py [CUPS_IP] [TARGET_IP]:1337 attacker_controlled-payload%20goes.here

  Sending UDP Payload to target [TARGET_IP] and port 1337
  Bytes Sent: 78

```
Copy

Fig. 2: Staging exploit

```

    09:05:03.072432 IP 192.168.12.143.43937 > X.X.X.X.631: UDP, length 78
	0x0000:  4500 006a 1991 4000 4011 2ed5 c0a8 0c8f  E..j..@.@.......
	0x0010:  xxxx xxxx aba1 0277 0056 bb25 3020 3000  .......w.V.%0.0.
	0x0020:  6874 7470 3a2f 2fxx xxxx 2exx xx2e xxxx  http://xxx.xx.xx
	0x0030:  2exx xxxx 3a31 3333 372f 7072 696e 7465  .xxx:1337/printe
	0x0040:  7273 2f61 7474 6163 6b65 725f 636f 6e74  rs/attacker_cont
	0x0050:  726f 6c6c 6564 2d70 6179 6c6f 6164 2532  rolled-payload%2
	0x0060:  3067 6f65 732e 6865 7265                 0goes.here

```
Copy

Fig. 3: Outgoing UDP packet (modified to be a nonfunctional payload)

### Target system

What we end up with is the CUPS service attempting to fetch what it believes to be an IPP attributes file, but is, in reality, whatever the attacker had specified. The target specified in the UDP packet will start to receive incoming TCP connections from the system running CUPS (Figure 4).

![The target specified in the UDP packet will start to receive incoming TCP connections from the system running CUPS (Figure 4). ](/site/en/images/blog/2024/october-cups-ddos-threat-two.png)
Fig. 4: CUPS service establishing a connection to the target

If we look closer at the two received packets that contained the actual request data, we can see the raw IPP request, and the accompanying POST data, partially attacker-controlled, coming from the CUPS service (Figure 5).

![If we look closer at the two received packets that contained the actual request data, we can see the raw IPP request, and the accompanying POST data, partially attacker-controlled, coming from the CUPS service (Figure 5).](/site/en/images/blog/2024/october-cups-ddos-threat-three.png)
Fig. 5: IPP/HTTP request received by the target

We can see from the logs for the cups-browsed daemon that the browsed attempts at fetching the IPP attributes are ultimately what generates these requests directed at the targeted host (Figure 6).

![We can see from the logs for the cups-browsed daemon that the browsed attempts at fetching the IPP attributes are ultimately what generates these requests directed at the targeted host (Figure 6). ](/site/en/images/blog/2024/october-cups-ddos-threat-four.jpg)
Fig. 6: Cups-browsed logs

## Impact and exposure

To ensure a well-rounded analysis, we tested and observed different patterns from machines both in the controlled lab and across the internet. These patterns greatly impact the attack scenarios and amplification factors.

The Akamai SIRT scanned and analyzed the global internet for devices that are vulnerable to this flaw and are accessible on the public internet (198,000+), based on data provided to us from evilsocket. Based on that data, we found that approximately 34% of those devices (58,000+) were vulnerable to this attack.

Additionally, our testing found that **some of these active CUPS servers will beacon back repeatedly after receiving the initial requests, with some of them appearing to do it endlessly in response to HTTP/404 responses**. Hundreds of these systems in the wild individually established thousands of requests and sent them to our testing systems.

This shows that the potential amplification from this vulnerability is quite large and could cause significant issues for organizations who run these affected servers. We also confirmed through our testing that some of the vulnerable CUPS servers were able to complete Transport Layer Security (TLS) handshakes from our probing attempts against valid HTTPS protected websites. The possibility of affecting TLS also adds more fuel to the fire, as it creates further strain on server hardware and resource consumption overhead due to the handshake and encryption/decryption processing.

### Outdated technology strikes again

We should note that many of these identified machines were running on very old versions of CUPS, such as version 1.3, which was initially released in 2007. It isn’t uncommon for some organizations to leave machines running on extremely outdated hardware and software, and it is unlikely that such devices will be updated anytime soon. **This presents a prime opportunity for malicious threat actors: They can take advantage of the outdated hardware for DDoS amplification, or (given the RCE in this scenario) build botnets for many purposes, including DDoS**.

### Amplification estimates

Amplification rates can vary significantly so we have covered both an average scenario and a worst-case scenario to help readers assess the potential threat.

Ultimately, the targeting directive dictates the size of this payload, but for baseline calculations we’ll use a minimum viable UDP packet size of 30 bytes and a maximally padded 1028-byte UDP packet for the worst case. This packet uses the IPP URI directive and fills it with 989 bytes (the maximum found during testing), which is duplicated and included in the resulting attack traffic.

**In the worst-case scenario, we observed what appeared to be an endless stream of attempted connections and requests as a result of a single probe**. These flows appear to have no end, and will continue until the daemon is killed or restarted. This could be considered an infinite amplification in this scenario. During testing of the 58,000+ responders, a few hundred exhibited this pattern.

**Roughly 62% (35,900+) of systems sent at least 10 TCP/IPP/HTTP requests to our target system in response to our UDP packet**. Overall, the response rate across the 58,000+ responders (including time-scoped infinite responders) averaged 45 responses, which is what we’ll use to further calculate potential amplification rates.

In the minimum viable probe (30 bytes) scenario, we see that the target machine received a full TCP connection and two packets with payloads. The first packet contains the HTTP request and headers; the second contains the POST data for the request (Figure 7).

![The first packet contains the HTTP request and headers; the second contains the POST data for the request (Figure 7).](/site/en/images/blog/2024/october-cups-ddos-threat-five.png)
Fig. 7: Minimal viable amplification flow

These packets (226 bytes and 174 bytes) total 400 bytes. If we assume that we’ll get these connections and requests 45 times per CUPS reflector, that’s 18,000 bytes of resulting traffic per each 30-byte probe, or roughly a 600x amplification factor on an *average* attempt.

### Lower amplification doesn’t mean lower impact

The worst-case scenario has different results outside of packet size. If we run this same exercise using maximally padded UDP payloads of 1,028 bytes (Figure 8), we see much larger flows directed at the target, but lower amplification.

![The worst-case scenario has different results outside of packet size. If we run this same exercise using maximally padded UDP payloads of 1,028 bytes (Figure 8), we see much larger flows directed at the target, but lower amplification. ](/site/en/images/blog/2024/october-cups-ddos-threat-six.png)
Fig. 8: Maximally padded attack payloads arriving at the target

In this scenario, our two-packet payload still arrives, but the respective sizes are now 1,217 bytes and 1,164 bytes, totaling 2,381 bytes. Assuming the same average of 45 responses per reflector, we end up with a total of 107,000 bytes of traffic per 1,028-byte probe, and our amplification rate drops to 104x.

Although the amplification rate dropped, **the bandwidth consumed on the target network is nearly 6x the minimally viable payload**. This would also result in the targeted HTTP server needing to allocate resources for handling and processing these requests. So, although it doesn’t improve amplification rates, this scenario does present a more problematic (and realistic) attack for defenders.

### Scaling these possibilities

If we assume all 58,000+ identified CUPS hosts were corralled into the same campaign, it could result in a deluge of 1 GB of incoming attack traffic per UDP packet from the minimally padded example. A maximally padded scenario could result in a 6-GB flood of traffic. Although these bandwidth numbers may not be considered earth-shattering, they would still result in the target’s need to handle roughly 2.6 million TCP connections and HTTP requests in either scenario.

## DDoS options in CUPS

Attacks of this nature are part of the troubling trend of an ever-decreasing technical barrier to entry for threat actors to conduct such attacks — directing vulnerable systems across the internet to send sustained floods of traffic to victims. To make matters worse, this can be achieved by sending a single packet to internet-exposed CUPS services. **It would take an attacker mere seconds to co-opt every vulnerable CUPS service currently exposed on the internet and cost the attacker less than a single US cent on modern hyperscaler platforms**.

As evilsocket’s research pointed out, there are slightly more than 198,000 devices found on the internet that respond back to UDP probes — and of those, the SIRT found that roughly 34% (58,000+) reacted to our UDP probe in a manner that could be easily abused for DDoS.

A remote attacker using a crafted payload could exploit this vulnerability to get the *cups-browsed* daemon to make outbound TCP connections to a third party. If said target happens to be running an HTTPS server on the targeted port, the server will have to spend cycles and resources trying to parse and handle these requests and data, potentially making the attack even more impactful. In the case of CDNs and caching, it’s unlikely that the URLs being specified in the POST request will exist, resulting in a 404 error that bypasses cache hits and forwards these payloads on to the origin servers.

Based on the research conducted by evilsocket, many distributions and versions of CUPS were impacted. Ultimately, the vulnerability lies in “*cups-browsed*” packaged with “*cups-filters*” when receiving a request to add a printer via UDP.  There appear to be mitigations from several Linux distributions that bind *cups-browsed* to *localhost* or disable cups-browsed from listening entirely.

## CUPS vulnerabilities mitigations

The decision to update to the latest version of CUPS or remove it entirely depends on your system's specific needs. If your system relies on printing functionality, updating to the latest version of CUPS ensures improved security, performance, and support for modern devices. However, if printing is unnecessary for your setup, removing CUPS can simplify your system, reduce potential vulnerabilities, and save resources.

Ultimately, this decision should be based on how essential printing capabilities are for your environment and on the importance of maintaining an up-to-date, secure system. At the very least, if removing or updating the CUPS software isn’t viable, defenders should firewall the service ports (UDP/631), especially if they’re accessible from the broader internet.

Threat actors are often quick to leverage newly reported vulnerabilities, with many new releases being exploited within just seven days after initial disclosure. Patching takes time, and hackers are eager to take advantage of that vulnerable transition period. Many organizations also neglect to update some of their older software, which may make it especially lucrative for hackers to jump on the bandwagon of exploiting new vulnerabilities such as this.

## DDoS mitigation for victims

For victims of a DDoS attack launched from vulnerable CUPS systems, there are some traits of the traffic to help alert, confirm, and drop attack traffic on the network or at the [web application firewall (WAF)](/glossary/what-is-a-waf).

All requests coming from the CUPS service begin with *POST /printers/*or *POST /classes/* and while the payload after the */printers/* string is attacker controllable, the initial part of the payload is not.  Additionally, the CUPS *User-Agent* strings are very informative and use the format *CUPS/[VERSION]*, as well as a reference to IPP.  These are very unique strings in the UA and are not typically observed in organic traffic.

There are also static elements in HTTP headers and POST data. The *Content-Type* header of *application/ipp* and payload *printer-uri* in the POST data are both static values we identified during testing (Figure 9).

![There are also static elements in HTTP headers and POST data. The Content-Type header of application/ipp and payload printer-uri in the POST data are both static values we identified during testing (Figure 9).](/site/en/images/blog/2024/october-cups-ddos-threat-seven.png)
Fig. 9: Highlighted values in observed traffic that could aid in detection and blocking

To aid defenders we’ve also included a Snort rule that should help identify these flows coming into your network over plaintext sockets (Figure 10).

```

  alert http any any -> any any (msg:"CUPS Reflected DDoS IPP Request";
pcre:"/POST \/printers\/|POST \/classes\//"; http_method;
content:"Content-Type: application/ipp"; http_header;
content:"User-Agent: CUPS/"; http_header;
content:"printer-uri"; http_client_body;
metadata:service http;
reference:url,https://akamai.com/blog/security-research/2024/october-cups-ddos-threat;
sid:100004; rev:2;)

```
Copy

Fig. 10: Snort rule for CUPS attack traffic

As mentioned, we found systems in the wild that would complete HTTPS handshakes before delivering their HTTP payloads, so defenders that use HTTPS should consider implementing these matching rules in their WAF configurations rather than on their network monitoring systems.

## Conclusion

New DDoS attack vectors are sometimes found, and often quickly abused, by low-skilled opportunistic attackers. This vulnerability in CUPS and the large population of devices that could be abused in this manner lead us to believe that it’s likely that defenders may encounter CUPS-based attacks.

Until messaging and cleanup efforts get traction to reduce the number of devices that are vulnerable and exposed on the internet (currently 58,000+), we suspect this vector will see abuse in the wild. We’re hoping that defenders, network operators, and system administrators will get the message and, for the sake of everyone, handle their respective exposures quickly, or at least be prepared to identify and fend off attackers that may leverage the exposures in the future.

**We would like to thank [evilsocket (Simone Margaritelli)](https://x.com/evilsocket) for his valuable assistance and input. ♥️**

[See more research](/security-research)

---

* [Threat Intelligence](/blog?filter=blogs/threat-intelligence)
* [Security Research](/blog?filter=blogs/security-research)
* [Cyber Security](/blog?filter=blogs/cyber-security)
* [DDoS](/blog?filter=blogs/ddos)
* [Research](/blog?filter=blogs/research)

Share

---

![Akamai Wave Blue](/site/en/images/blog/userpics/akamai-wave-blog-author.png)

Written by

[Larry Cashdollar](/blog?author=larry_cashdollar), [Kyle Lefton](/blog?author=kyle-lefton), and [Chad Seaman](/blog?author=chad_seaman)

October 01, 2024

![Larry Cashdollar](/site/en/images/blog/userpics/larry-cashdollar.jpeg)

Written by

[Larry Cashdollar](/blog?author=larry_cashdollar)

Larry Cashdollar has been working in the security field as a vulnerability researcher for more than 20 years and is currently a Principal Security Researcher on the Security Intelligence Response Team at Akamai. He studied computer science at the University of Southern Maine. Larry has documented more than 300 CVEs and has presented his research at BotConf, BSidesBoston, OWASP Rhode Island, and DEF CON. He enjoys the outdoors and rebuilding small engines in his spare time.

![Akamai Wave Blue](/site/en/images/blog/userpics/akamai-wave-blog-author.png)

Written by

[Kyle Lefton](/blog?author=kyle-lefton)

Kyle Lefton is a security researcher on Akamai's Security Intelligence Response Team. Formerly an intelligence analyst for the Department of Defense, Kyle has experience in cyber defense, threat research, and counter-intelligence, spanning several years. He takes pride in investigating emerging threats, vulnerability research, and threat group mapping. In his free time, he enjoys spending time with friends and family, strategy games, and hiking in the great outdoors.

![Chad Seaman headshot](/site/en/images/blog/userpics/userpic-666-100x100.png)

Written by

[Chad Seaman](/blog?author=chad_seaman)

Chad Seaman is a Principal Security Researcher and Team Lead of Akamai’s Security Intelligence Response Team. He proudly refers to himself as an “Internet Dumpster Diver,” and enjoys looking through the muck and mire he finds there. Chad began his career as a programmer, and after being exposed to security, exploitation, and forensics via breach investigations, security quickly became his preferred work. He now spends his time engulfed in malware investigations, reverse engineering, vulnerability research, DDoS, and cybercrime investigations. He likes flying airplanes, poking holes in paper at a distance, and spending time in nature, preferably in the woods, on a trail, or on a dirt bike.

## Related Blog Posts

[![The malware samples we identified were Mirai-based malware variants that were distributed in a variety of architectures.](/site/en/images/blog/2024/thumbnails/edge-1080x608-1.png)
The malware samples we identified were Mirai-based malware variants that were distributed in a variety of architectures.](/blog/security-research/digiever-fix-that-iot-thing)

## DigiEver Fix That IoT Thing!

December 19, 2024
A vulnerability in DigiEver DS-2105 Pro DVRs is being exploited to spread a Mirai variant that has been modified to use improved encryption algorithms.
by Kyle Lefton, Daniel Messing, and Larry Cashdollar
[Read more](/blog/security-research/digiever-fix-that-iot-thing)

[![This month, there are 71 total CVEs across 32 different components. Of those CVEs, 17 are critical and one was seen in the wild.](/site/en/images/blog/2024/thumbnails/edge-1080x608-1.png)
This month, there are 71 total CVEs across 32 different components. Of those CVEs, 17 are critical and one was seen in the wild.](/blog/security-research/akamai-perspective-patch-tuesday-december-2024)

## Akamai’s Perspective on December’s Patch Tuesday 2024

December 13, 2024
Hope you left some room after Thanksgiving — we’re stuffing CVEs while waiting for our stockings. This month, we’ve got 71 total CVEs; one seen in the wild.
by Akamai Security Intelligence Group
[Read more](/blog/security-research/akamai-perspective-patch-tuesday-december-2024)

[![This analysis is an unfortunate example of how technology created for good can be hijacked for malicious purposes.](/site/en/images/blog/2024/thumbnails/edge-1080x608-1.png)
This analysis is an unfortunate example of how technology created for good can be hijacked for malicious purposes.](/blog/security-research/2024-december-windows-ui-automation-attack-technique-evades-edr)

## Teaching an Old Framework New Tricks: The Dangers of Windows UI Automation

December 11, 2024
Microsoft’s UI Automation framework has some great features, but in the wrong hands, it can lead to bad outcomes — and even evade your EDR.
by Tomer Peled
[Read more](/blog/security-research/2024-december-windows-ui-automation-attack-technique-evades-edr)

### Products

* [Cloud Computing](/solutions/cloud-computing)
* [Security](/solutions/security)
* [Content Delivery](/solutions/content-delivery-network)
* [All Products and Trials](/products)
* [Global Services](/global-services)

### company

* [About Us](/company)
* [History](/company/company-history)
* [Leadership](/company/leadership)
* [Facts and Figures](/company/facts-figures)
* [Awards](/company/our-awards)
* [Board of Directors](/company/leadership/board-of-directors)
* [Investor Relations](https://www.ir.akamai.com)
* [Corporate Responsibility](/company/corporate-responsibility)
* [Ethics](/company/ethics-and-compliance)
* [Locations](/company/locations)
* [Vulnerability Reporting](/global-services/support/vulnerability-reporting)

### Careers

* [Careers](/careers)
* [Working at Akamai](/careers/working-at-akamai)
* [Students and Recent Grads](/careers/students-and-recent-graduates)
* [Workplace Diversity](/careers/workplace-diversity)
* [Search Jobs](https://akamaicareers.inflightcloud.com/search?searchable=%5B%5D§ion=aka_ext)
* [Culture Blog](/blog/culture)

### newsroom

* [Newsroom](/newsroom)
* [Press Releases](/newsroom/press-release)
* [In the News](/newsroom/in-the-news)
* [Media Resources](/newsroom/media-resources)

### Legal & compliance

* [Legal](/legal)
* [Information Security Compliance](/legal/compliance)
* [Privacy Trust Center](/legal/compliance/privacy-trust-center)
* [Cookie Settings](/legal/manage-cookie-preferences)
* [EU Digital Services Act (DSA)](/legal/eu-digital-services-act)

### Glossary

* [What Is API Security?](/glossary/what-is-api-security)
* [What Is a CDN?](/glossary/what-is-a-cdn)
* [What Is Cloud Computing?](/glossary/what-is-cloud-computing)
* [What Is Cybersecurity?](/glossary/what-is-cybersecurity)
* [What Is a DDoS attack?](/glossary/what-is-ddos)
* [What Is Microsegmentation?](/glossary/what-is-microsegmentation)
* [What Is WAAP?](/glossary/what-is-waap)
* [What Is Zero Trust?](/glossary/what-is-zero-trust)
* [See all](/glossary)

[Twitter](https://twitter.com/Akamai)
[Facebook](https://www.facebook.com/AkamaiTechnologies/)
[Youtube](https://www.youtube.com/user/akamaitechnologies)
[Linkedin](https://www.linkedin.com/company/akamai-technologies)

* [EMEA Legal Notice](/legal/emea-legal-notices)
* [Service Status](/why-akamai/stop-cyberthreats)
* [Contact Us](/why-akamai/contact-us)

---

* [EMEA Legal Notice](/legal/emea-legal-notices)
* [Service Status](https://www.akamaistatus.com/)
* [Contact Us](/why-akamai/contact-us)

* en
  + [English](/blog/security-research/october-cups-ddos-threat "English")
  + [Deutsch](/de/blog/security-research/october-cups-ddos-threat " Deutsch")
  + [Español](/es/blog/security-research/october-cups-ddos-threat "Español")
  + [Français](/fr/blog/security-research/october-cups-ddos-threat "Français")
  + [Italiano](/it/blog/security-research/october-cups-ddos-threat "Italiano")
  + [Português](/pt/blog/security-research/october-cups-ddos-threat " Português")
  + [中文](/zh/blog/security-research/october-cups-ddos-threat "中文")
  + [日本語](/ja/blog/security-research/october-cups-ddos-threat "日本語")
  + [한국어](/ko/blog/security-research/october-cups-ddos-threat "한국어")

©2025 Akamai Technologies

