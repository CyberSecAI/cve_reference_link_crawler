=== Content from www.openwall.com_9d4cf882_20250110_182448.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2024/10/03/6) [[next>]](2) [[<thread-prev]](../../../2024/10/03/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1728044852.266451931@f125.i.mail.ru>
Date: Fri, 04 Oct 2024 15:27:32 +0300
From: larry0@...com
To: oss-security@...ts.openwall.com
Subject: Re[2]: cups-browsed vulnerable to DDoS amplification attack

Hello oss-security,

Thursday, October 3, 2024 at 2:58 PM -04:00 from peter@...ts.nl  <peter@...ts.nl>:
>Hello,
>
>On Thu, Oct 3, 2024, at 19:54, Larry Cashdollar wrote:
>> I've requested a CVE ID to be able to discern between the RCE and the DoS vulnerability.
>
>I reported this as  <https://github.com/OpenPrinting/cups-filters/security/advisories/GHSA-rq86-c7g6-r2h8> last week, and in the edits at the top (by upstream, above the Summary heading) it looks like they did not want (or did not consider) to request a separate CVE for this. Please do coordinate with them if you decide to go ahead with this request.
>
>(I did notice, and can see value in, Will Dormann's suggestion in the other thread that it might make sense to have more fine-grained CVEs for this collection of problems.)
>
>--
>  Peter van Dijk
>   peter@...ts.nl
This vulnerability has been assigned CVE-2024-47850.

Thanks,
Larry C$
```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_cc9d6f71_20250110_182450.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenPrinting%2Fcups-filters%2Fsecurity%2Fadvisories%2FGHSA-rq86-c7g6-r2h8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenPrinting%2Fcups-filters%2Fsecurity%2Fadvisories%2FGHSA-rq86-c7g6-r2h8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=OpenPrinting%2Fcups-filters)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenPrinting](/OpenPrinting)
/
**[cups-filters](/OpenPrinting/cups-filters)**
Public

* [Notifications](/login?return_to=%2FOpenPrinting%2Fcups-filters) You must be signed in to change notification settings
* [Fork
  129](/login?return_to=%2FOpenPrinting%2Fcups-filters)
* [Star
   165](/login?return_to=%2FOpenPrinting%2Fcups-filters)

* [Code](/OpenPrinting/cups-filters)
* [Issues
  97](/OpenPrinting/cups-filters/issues)
* [Pull requests
  2](/OpenPrinting/cups-filters/pulls)
* [Discussions](/OpenPrinting/cups-filters/discussions)
* [Actions](/OpenPrinting/cups-filters/actions)
* [Projects
  0](/OpenPrinting/cups-filters/projects)
* [Wiki](/OpenPrinting/cups-filters/wiki)
* [Security](/OpenPrinting/cups-filters/security)
* [Insights](/OpenPrinting/cups-filters/pulse)

Additional navigation options

* [Code](/OpenPrinting/cups-filters)
* [Issues](/OpenPrinting/cups-filters/issues)
* [Pull requests](/OpenPrinting/cups-filters/pulls)
* [Discussions](/OpenPrinting/cups-filters/discussions)
* [Actions](/OpenPrinting/cups-filters/actions)
* [Projects](/OpenPrinting/cups-filters/projects)
* [Wiki](/OpenPrinting/cups-filters/wiki)
* [Security](/OpenPrinting/cups-filters/security)
* [Insights](/OpenPrinting/cups-filters/pulse)

# cups-browsed can be made to endlessly spam HTTP requests to a chosen endpoint

High

[tillkamppeter](/tillkamppeter)
published
GHSA-rq86-c7g6-r2h8
Sep 27, 2024

## Package

cups-filters

## Affected versions

1.28.17-3 (Debian), 1.x 2076627 (git)

## Patched versions

None

## Description

**Update: There is now a separate CVE assigned to this advisory.**

**The solution (remove CUPS browsing) and quick mitigation (turn off CUPS browsing in `cups-browsed.conf`) are the same as for [CVE-2024-47176](https://github.com/OpenPrinting/cups-browsed/security/advisories/GHSA-rj88-6mr5-rcw8), so the methods applied there also cover this one.**

**Mitigation:**

**1. Edit `/etc/cups/cups-browsed.conf`

2. Search for the `BrowseRemoteProtocols` configuration option

3. Set the option to `dnssd` (the default value is `dnssd cups`, remove `cups`)

4. Restart cups-browsed using `sudo systemctl restart cups-browsed`**

### Summary

When cups-browsed, running with the default configuration (on Debian at least), receives a well-formed packet to UDP 631 containing the http port 80 URL of any popular website that just serves redirects on that port, it will send HTTP requests in a tight loop. This does not appear to stop until `kill -9`.

### Details

Example exploit:

```
printf '00 00 ipp://example.x:80/printers/ "XXlocation" "XXinfo" "XXmake-and-model"\n' | nc -u 192.0.2.1 631`

```

(example.x is not a real hostname; the IP is fake too; I have tried with a few web servers under my control to verify the behaviour)

### PoC

See Details.

### Impact

A client doing requests in a tight loop might impact availability of a server. Several such clients together might make it worse.

### Relevant details

I have confirmed this behaviour with a packet from an untrusted source over the Internet, in `cups-browsed` `1.28.17-3` as shipped in Debian 12.

I have also confirmed this behaviour with a packet from localhost in a fresh compile of <https://github.com/OpenPrinting/cups-filters> on branch `1.x` as of just now (commit [2076627](https://github.com/OpenPrinting/cups-filters/commit/2076627d33477212f21352ad39e9d305adb63af3))

### Additional context

I am aware of recent rumours around RCE in cups-browsed. Based on just public information, I decided to look at cups myself, and quickly noticed that cups-browsed listens to the world in at least some setups. That is how I found this problem.

I suspect, but in no way can currently prove, that the RCE rumours also involve this UDP socket. A lot of code is executed for a received packet that is well-formed.

It would not surprise me if the problem I am reporting here, that is not RCE, has also recently become known to you, either from `evilsocket` or from somebody else who recently felt inclined to audit parts of CUPS.

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2024-47850

### Weaknesses

No CWEs

### Credits

* [![@Habbie](https://avatars.githubusercontent.com/u/525838?s=40&v=4)](/Habbie)
  [Habbie](/Habbie)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.netapp.com_8061ad61_20250110_182450.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2024-47850 CUPS Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20241011-0002)

## CVE-2024-47850 CUPS Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20241011-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20241011-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20241011-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20241011-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20241011-0002
**Version:**
6.0

**Last updated:**
12/20/2024

**Status:**
Interim.

**CVEs:** CVE-2024-47850

Overview
#### Summary

Multiple NetApp products incorporate CUPS. Versions of cups-browsed prior to 2.5b1 are susceptible to a vulnerability which when successfully exploited could lead to Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2024-47850](https://nvd.nist.gov/vuln/detail/CVE-2024-47850) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.akamai.com/blog/security-research/october-cups-ddos-threat>

Affected Products
#### Affected Products

* ONTAP tools for VMware vSphere 10

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF Baseboard Management Controller (BMC) - A700s
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP
* Workload Factory for VMware

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20241011-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20241011 | Initial Public Release |
| 2.0 | 20241014 | Element JAVA SDK moved to Products Not Affected |
| 3.0 | 20241022 | ONTAP tools for VMware vSphere 9 moved to Products Not Affected |
| 4.0 | 20241024 | Active IQ Unified Manager for VMware vSphere moved to Products Not Affected |
| 5.0 | 20241122 | OnCommand Insight moved to Products Not Affected |
| 6.0 | 20241220 | ONTAP tools for VMware vSphere 10 moved to Affected Products |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from github.com_7f717cfb_20250110_182449.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenPrinting%2Fcups)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FOpenPrinting%2Fcups)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=OpenPrinting%2Fcups)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[OpenPrinting](/OpenPrinting)
/
**[cups](/OpenPrinting/cups)**
Public

* [Notifications](/login?return_to=%2FOpenPrinting%2Fcups) You must be signed in to change notification settings
* [Fork
  208](/login?return_to=%2FOpenPrinting%2Fcups)
* [Star
   1.1k](/login?return_to=%2FOpenPrinting%2Fcups)

OpenPrinting CUPS Sources

[openprinting.github.io/cups](https://openprinting.github.io/cups "https://openprinting.github.io/cups")

### License

[Apache-2.0 license](/OpenPrinting/cups/blob/master/LICENSE)

[1.1k
stars](/OpenPrinting/cups/stargazers) [208
forks](/OpenPrinting/cups/forks) [Branches](/OpenPrinting/cups/branches) [Tags](/OpenPrinting/cups/tags) [Activity](/OpenPrinting/cups/activity)
 [Star](/login?return_to=%2FOpenPrinting%2Fcups)

 [Notifications](/login?return_to=%2FOpenPrinting%2Fcups) You must be signed in to change notification settings

* [Code](/OpenPrinting/cups)
* [Issues
  27](/OpenPrinting/cups/issues)
* [Pull requests
  11](/OpenPrinting/cups/pulls)
* [Discussions](/OpenPrinting/cups/discussions)
* [Actions](/OpenPrinting/cups/actions)
* [Projects
  0](/OpenPrinting/cups/projects)
* [Wiki](/OpenPrinting/cups/wiki)
* [Security](/OpenPrinting/cups/security)
* [Insights](/OpenPrinting/cups/pulse)

Additional navigation options

* [Code](/OpenPrinting/cups)
* [Issues](/OpenPrinting/cups/issues)
* [Pull requests](/OpenPrinting/cups/pulls)
* [Discussions](/OpenPrinting/cups/discussions)
* [Actions](/OpenPrinting/cups/actions)
* [Projects](/OpenPrinting/cups/projects)
* [Wiki](/OpenPrinting/cups/wiki)
* [Security](/OpenPrinting/cups/security)
* [Insights](/OpenPrinting/cups/pulse)

# OpenPrinting/cups

    master[Branches](/OpenPrinting/cups/branches)[Tags](/OpenPrinting/cups/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[3,944 Commits](/OpenPrinting/cups/commits/master/) | | |
| [.github](/OpenPrinting/cups/tree/master/.github ".github") | | [.github](/OpenPrinting/cups/tree/master/.github ".github") |  |  |
| [backend](/OpenPrinting/cups/tree/master/backend "backend") | | [backend](/OpenPrinting/cups/tree/master/backend "backend") |  |  |
| [berkeley](/OpenPrinting/cups/tree/master/berkeley "berkeley") | | [berkeley](/OpenPrinting/cups/tree/master/berkeley "berkeley") |  |  |
| [cgi-bin](/OpenPrinting/cups/tree/master/cgi-bin "cgi-bin") | | [cgi-bin](/OpenPrinting/cups/tree/master/cgi-bin "cgi-bin") |  |  |
| [conf](/OpenPrinting/cups/tree/master/conf "conf") | | [conf](/OpenPrinting/cups/tree/master/conf "conf") |  |  |
| [config-scripts](/OpenPrinting/cups/tree/master/config-scripts "config-scripts") | | [config-scripts](/OpenPrinting/cups/tree/master/config-scripts "config-scripts") |  |  |
| [cups](/OpenPrinting/cups/tree/master/cups "cups") | | [cups](/OpenPrinting/cups/tree/master/cups "cups") |  |  |
| [data](/OpenPrinting/cups/tree/master/data "data") | | [data](/OpenPrinting/cups/tree/master/data "data") |  |  |
| [desktop](/OpenPrinting/cups/tree/master/desktop "desktop") | | [desktop](/OpenPrinting/cups/tree/master/desktop "desktop") |  |  |
| [doc](/OpenPrinting/cups/tree/master/doc "doc") | | [doc](/OpenPrinting/cups/tree/master/doc "doc") |  |  |
| [examples](/OpenPrinting/cups/tree/master/examples "examples") | | [examples](/OpenPrinting/cups/tree/master/examples "examples") |  |  |
| [filter](/OpenPrinting/cups/tree/master/filter "filter") | | [filter](/OpenPrinting/cups/tree/master/filter "filter") |  |  |
| [locale](/OpenPrinting/cups/tree/master/locale "locale") | | [locale](/OpenPrinting/cups/tree/master/locale "locale") |  |  |
| [man](/OpenPrinting/cups/tree/master/man "man") | | [man](/OpenPrinting/cups/tree/master/man "man") |  |  |
| [monitor](/OpenPrinting/cups/tree/master/monitor "monitor") | | [monitor](/OpenPrinting/cups/tree/master/monitor "monitor") |  |  |
| [notifier](/OpenPrinting/cups/tree/master/notifier "notifier") | | [notifier](/OpenPrinting/cups/tree/master/notifier "notifier") |  |  |
| [packaging](/OpenPrinting/cups/tree/master/packaging "packaging") | | [packaging](/OpenPrinting/cups/tree/master/packaging "packaging") |  |  |
| [ppdc](/OpenPrinting/cups/tree/master/ppdc "ppdc") | | [ppdc](/OpenPrinting/cups/tree/master/ppdc "ppdc") |  |  |
| [scheduler](/OpenPrinting/cups/tree/master/scheduler "scheduler") | | [scheduler](/OpenPrinting/cups/tree/master/scheduler "scheduler") |  |  |
| [scripts](/OpenPrinting/cups/tree/master/scripts "scripts") | | [scripts](/OpenPrinting/cups/tree/master/scripts "scripts") |  |  |
| [systemv](/OpenPrinting/cups/tree/master/systemv "systemv") | | [systemv](/OpenPrinting/cups/tree/master/systemv "systemv") |  |  |
| [templates](/OpenPrinting/cups/tree/master/templates "templates") | | [templates](/OpenPrinting/cups/tree/master/templates "templates") |  |  |
| [test](/OpenPrinting/cups/tree/master/test "test") | | [test](/OpenPrinting/cups/tree/master/test "test") |  |  |
| [tools](/OpenPrinting/cups/tree/master/tools "tools") | | [tools](/OpenPrinting/cups/tree/master/tools "tools") |  |  |
| [vcnet](/OpenPrinting/cups/tree/master/vcnet "vcnet") | | [vcnet](/OpenPrinting/cups/tree/master/vcnet "vcnet") |  |  |
| [xcode](/OpenPrinting/cups/tree/master/xcode "xcode") | | [xcode](/OpenPrinting/cups/tree/master/xcode "xcode") |  |  |
| [.dockerignore](/OpenPrinting/cups/blob/master/.dockerignore ".dockerignore") | | [.dockerignore](/OpenPrinting/cups/blob/master/.dockerignore ".dockerignore") |  |  |
| [.gitattributes](/OpenPrinting/cups/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/OpenPrinting/cups/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/OpenPrinting/cups/blob/master/.gitignore ".gitignore") | | [.gitignore](/OpenPrinting/cups/blob/master/.gitignore ".gitignore") |  |  |
| [.mailmap](/OpenPrinting/cups/blob/master/.mailmap ".mailmap") | | [.mailmap](/OpenPrinting/cups/blob/master/.mailmap ".mailmap") |  |  |
| [CHANGES.md](/OpenPrinting/cups/blob/master/CHANGES.md "CHANGES.md") | | [CHANGES.md](/OpenPrinting/cups/blob/master/CHANGES.md "CHANGES.md") |  |  |
| [CONTRIBUTING.md](/OpenPrinting/cups/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/OpenPrinting/cups/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [CREDITS.md](/OpenPrinting/cups/blob/master/CREDITS.md "CREDITS.md") | | [CREDITS.md](/OpenPrinting/cups/blob/master/CREDITS.md "CREDITS.md") |  |  |
| [DEVELOPING.md](/OpenPrinting/cups/blob/master/DEVELOPING.md "DEVELOPING.md") | | [DEVELOPING.md](/OpenPrinting/cups/blob/master/DEVELOPING.md "DEVELOPING.md") |  |  |
| [DOCKER.md](/OpenPrinting/cups/blob/master/DOCKER.md "DOCKER.md") | | [DOCKER.md](/OpenPrinting/cups/blob/master/DOCKER.md "DOCKER.md") |  |  |
| [Dockerfile](/OpenPrinting/cups/blob/master/Dockerfile "Dockerfile") | | [Dockerfile](/OpenPrinting/cups/blob/master/Dockerfile "Dockerfile") |  |  |
| [INSTALL.md](/OpenPrinting/cups/blob/master/INSTALL.md "INSTALL.md") | | [INSTALL.md](/OpenPrinting/cups/blob/master/INSTALL.md "INSTALL.md") |  |  |
| [LICENSE](/OpenPrinting/cups/blob/master/LICENSE "LICENSE") | | [LICENSE](/OpenPrinting/cups/blob/master/LICENSE "LICENSE") |  |  |
| [Makedefs.in](/OpenPrinting/cups/blob/master/Makedefs.in "Makedefs.in") | | [Makedefs.in](/OpenPrinting/cups/blob/master/Makedefs.in "Makedefs.in") |  |  |
| [Makefile](/OpenPrinting/cups/blob/master/Makefile "Makefile") | | [Makefile](/OpenPrinting/cups/blob/master/Makefile "Makefile") |  |  |
| [NOTICE](/OpenPrinting/cups/blob/master/NOTICE "NOTICE") | | [NOTICE](/OpenPrinting/cups/blob/master/NOTICE "NOTICE") |  |  |
| [README.md](/OpenPrinting/cups/blob/master/README.md "README.md") | | [README.md](/OpenPrinting/cups/blob/master/README.md "README.md") |  |  |
| [REPORTING\_ISSUES.md](/OpenPrinting/cups/blob/master/REPORTING_ISSUES.md "REPORTING_ISSUES.md") | | [REPORTING\_ISSUES.md](/OpenPrinting/cups/blob/master/REPORTING_ISSUES.md "REPORTING_ISSUES.md") |  |  |
| [SECURITY.md](/OpenPrinting/cups/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/OpenPrinting/cups/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [config.guess](/OpenPrinting/cups/blob/master/config.guess "config.guess") | | [config.guess](/OpenPrinting/cups/blob/master/config.guess "config.guess") |  |  |
| [config.h.in](/OpenPrinting/cups/blob/master/config.h.in "config.h.in") | | [config.h.in](/OpenPrinting/cups/blob/master/config.h.in "config.h.in") |  |  |
| [config.sub](/OpenPrinting/cups/blob/master/config.sub "config.sub") | | [config.sub](/OpenPrinting/cups/blob/master/config.sub "config.sub") |  |  |
| [configure](/OpenPrinting/cups/blob/master/configure "configure") | | [configure](/OpenPrinting/cups/blob/master/configure "configure") |  |  |
| [configure.ac](/OpenPrinting/cups/blob/master/configure.ac "configure.ac") | | [configure.ac](/OpenPrinting/cups/blob/master/configure.ac "configure.ac") |  |  |
| [cups-config.in](/OpenPrinting/cups/blob/master/cups-config.in "cups-config.in") | | [cups-config.in](/OpenPrinting/cups/blob/master/cups-config.in "cups-config.in") |  |  |
| [cups.pc.in](/OpenPrinting/cups/blob/master/cups.pc.in "cups.pc.in") | | [cups.pc.in](/OpenPrinting/cups/blob/master/cups.pc.in "cups.pc.in") |  |  |
| [docker-compose.yaml](/OpenPrinting/cups/blob/master/docker-compose.yaml "docker-compose.yaml") | | [docker-compose.yaml](/OpenPrinting/cups/blob/master/docker-compose.yaml "docker-compose.yaml") |  |  |
| [install-sh](/OpenPrinting/cups/blob/master/install-sh "install-sh") | | [install-sh](/OpenPrinting/cups/blob/master/install-sh "install-sh") |  |  |
| View all files | | |

## Repository files navigation

* README
* Apache-2.0 license
* Security
# OpenPrinting CUPS v2.5b1

[![Version](https://camo.githubusercontent.com/18ee1ab6d66f2abe331c5346aee9de4ab931f08789791bff40e5678cc20574a6/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f6f70656e7072696e74696e672f637570733f696e636c7564655f70726572656c6561736573)](https://camo.githubusercontent.com/18ee1ab6d66f2abe331c5346aee9de4ab931f08789791bff40e5678cc20574a6/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f6f70656e7072696e74696e672f637570733f696e636c7564655f70726572656c6561736573)
[![Apache 2.0](https://camo.githubusercontent.com/0e12bcfe637179587f50ad1f770fe78687895f249d2b4fb08d5cf32bae95968a/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6f70656e7072696e74696e672f63757073)](https://camo.githubusercontent.com/0e12bcfe637179587f50ad1f770fe78687895f249d2b4fb08d5cf32bae95968a/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6f70656e7072696e74696e672f63757073)
[![Build and Test](https://github.com/OpenPrinting/cups/workflows/Build%20and%20Test/badge.svg)](https://github.com/OpenPrinting/cups/actions/workflows/build.yml)
[![Coverity Scan](https://camo.githubusercontent.com/21b7b357ccf07d3ee1db92425645e45b2d848ee5f16293dac4eed33e35cd61c3/68747470733a2f2f696d672e736869656c64732e696f2f636f7665726974792f7363616e2f3233383036)](https://scan.coverity.com/projects/openprinting-cups)

> *Note:* This branch is tracking a future CUPS 2.5.x feature release. Check
> out the "2.4.x" branch for CUPS 2.4.x.

## Introduction

OpenPrinting CUPS is the most current version of CUPS, a standards-based, open
source printing system for Linux® and other Unix®-like operating systems. CUPS
supports printing to:

* [AirPrint™](https://support.apple.com/en-us/HT201311) and [IPP Everywhere™](https://www.pwg.org/printers) printers,
* Network and local (USB) printers with Printer Applications, and
* Network and local (USB) printers with (legacy) PPD-based printer drivers.

CUPS provides the System V ("lp") and Berkeley ("lpr") command-line interfaces,
a configurable web interface, a C API, and common print filters, drivers, and
backends for printing. The [cups-filters](https://github.com/openprinting/cups-filters) project provides additional
filters and drivers.

CUPS is licensed under the Apache License Version 2.0 with an exception to allow
linking against GNU GPL2-only software. See the files `LICENSE` and `NOTICE`
for more information.

> Note: Apple maintains a separate repository for the CUPS that ships with macOS
> and iOS at <https://github.com/apple/cups>.

## Reading the Documentation

Initial documentation to get you started is provided in the root directory of
the CUPS sources:

* `CHANGES.md`: A list of changes in the current major release of CUPS.
* `CONTRIBUTING.md`: Guidelines for contributing to the CUPS project.
* `CREDITS.md`: A list of past contributors to the CUPS project.
* `DEVELOPING.md`: Guidelines for developing code for the CUPS project.
* `INSTALL.md`: Instructions for building and installing CUPS.
* `LICENSE`: The CUPS license agreement (Apache 2.0).
* `NOTICE`: Copyright notices and exceptions to the CUPS license agreement.
* `README.md`: This file.
* `REPORTING_ISSUES.md`: Instructions what information to provide when reporting an issue.

Once you have installed the software you can access the documentation (and a
bunch of other stuff) online at <http://localhost:631/> and using the `man`
command, for example `man cups`.

If you're having trouble getting that far, the documentation is located under
the `doc/help` and `man` directories.

*Please read the documentation before asking questions.*

## Setting Up Printers

CUPS includes a web-based administration tool that allows you to manage
printers, classes, and jobs on your server. Open <http://localhost:631/admin/>
in your browser to access the printer administration tools. You will be asked
for the administration password (root or any other user in the "sys", "system",
"root", "admin", or "lpadmin" group on your system) when performing any
administrative function.

The `lpadmin` command is used to manage printers from the command-line. For
example, the following command creates a print queue called "myprinter" for an
IPP Everywhere printer at address "11.22.33.44":

```
lpadmin -p myprinter -E -v "ipp://11.22.33.44/ipp/print" -m everywhere

```

The `-p` option specifies the printer name. The `-E` option enables the printer
and accepts new print jobs immediately. The `-v` option specifies the *device
URI* for the printer, which tells CUPS how to communicate with the printer. And
the `-m` option specifies the model (driver) to use, in this case the IPP
Everywhere ("everywhere") driver that is used for AirPrint and IPP Everywhere
printers as well as shared printers and printers supported through Printer
Applications.

Legacy printers are supported using PPD (PostScript Printer Description) files
that describe printer capabilities and driver programs needed for each printer.
CUPS includes several sample PPD files for common legacy printers:

| Driver | PPD Name |
| --- | --- |
| Dymo Label Printers | drv:///sample.drv/dymo.ppd |
| Intellitech Intellibar | drv:///sample.drv/intelbar.ppd |
| EPSON 9-pin Series | drv:///sample.drv/epson9.ppd |
| EPSON 24-pin Series | drv:///sample.drv/epson24.ppd |
| Generic PCL Laser Printer | drv:///sample.drv/generpcl.ppd |
| Generic PostScript Printer | drv:///sample.drv/generic.ppd |
| HP DeskJet Series | drv:///sample.drv/deskjet.ppd |
| HP LaserJet Series | drv:///sample.drv/laserjet.ppd |
| OKIDATA 9-Pin Series | drv:///sample.drv/okidata9.ppd |
| OKIDATA 24-Pin Series | drv:///sample.drv/okidat24.ppd |
| Zebra CPCL Label Printer | drv:///sample.drv/zebracpl.ppd |
| Zebra EPL1 Label Printer | drv:///sample.drv/zebraep1.ppd |
| Zebra EPL2 Label Printer | drv:///sample.drv/zebraep2.ppd |
| Zebra ZPL Label Printer | drv:///sample.drv/zebra.ppd |

The sample drivers provide basic printing capabilities, but generally do not
exercise the full potential of the printers or CUPS. Other drivers provide
greater printing capabilities.

You can run the `lpinfo -m` command to list all of the available drivers:

```
lpinfo -m

```

Similarly, the `lpinfo -v` command lists the available printers and their device
URIs:

```
lpinfo -v

```

Once you know the device URI and driver name, add the printer using the
`lpadmin` command:

```
lpadmin -p PRINTER-NAME -E -v "DEVICE-URI" -m DRIVER-NAME

```

## Printing Files

CUPS provides both the System V `lp` and Berkeley `lpr` commands for printing:

```
lp FILENAME
lpr FILENAME

```

Both the `lp` and `lpr` commands support printing options:

```
lp -o media=A4 -o resolution=600dpi FILENAME
lpr -o media=A4 -o resolution=600dpi FILENAME

```

CUPS recognizes many types of images files as well as PDF, PostScript, and text
files, so you can print those files directly rather than through an application.

If you have an application that generates output specifically for your printer
then you need to use the `-oraw` or `-l` options:

```
lp -o raw FILENAME
lpr -l FILENAME

```

This will prevent the filters from misinterpreting your print file.

## Contributing Code and Translations

Code contributions should be submitted as pull requests on the Github site:

```
http://github.com/OpenPrinting/cups/pulls

```

See the file "CONTRIBUTING.md" for more details.

CUPS uses [Weblate](https://hosted.weblate.org) to manage the localization of the web interface,
command-line programs, and common IPP attributes and values, and those likewise
end up as pull requests on Github.

## Legal Stuff

Copyright © 2020-2025 by OpenPrinting

Copyright © 2007-2020 by Apple Inc.

Copyright © 1997-2007 by Easy Software Products.

CUPS is provided under the terms of the Apache License, Version 2.0 with
exceptions for GPL2/LGPL2 software. A copy of this license can be found in the
file `LICENSE`. Additional legal information is provided in the file `NOTICE`.

Unless required by applicable law or agreed to in writing, software distributed
under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for the
specific language governing permissions and limitations under the License.

## About

OpenPrinting CUPS Sources

[openprinting.github.io/cups](https://openprinting.github.io/cups "https://openprinting.github.io/cups")

### Topics

[linux](/topics/linux "Topic: linux")
[printing](/topics/printing "Topic: printing")
[bsd](/topics/bsd "Topic: bsd")
[ipp](/topics/ipp "Topic: ipp")

### Resources

[Readme](#readme-ov-file)
### License

[Apache-2.0 license](#Apache-2.0-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/OpenPrinting/cups/activity)
[Custom properties](/OpenPrinting/cups/custom-properties)
### Stars

[**1.1k**
stars](/OpenPrinting/cups/stargazers)
### Watchers

[**33**
watching](/OpenPrinting/cups/watchers)
### Forks

[**208**
forks](/OpenPrinting/cups/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FOpenPrinting%2Fcups&report=OpenPrinting+%28user%29)

## [Releases 16](/OpenPrinting/cups/releases)

[v2.4.11
Latest

Sep 30, 2024](/OpenPrinting/cups/releases/tag/v2.4.11)
[+ 15 releases](/OpenPrinting/cups/releases)

## [Packages 0](/orgs/OpenPrinting/packages?repo_name=cups)

No packages published

## [Contributors 100](/OpenPrinting/cups/graphs/contributors)

* [![@michaelrsweet](https://avatars.githubusercontent.com/u/488103?s=64&v=4)](https://github.com/michaelrsweet)
* [![@zdohnal](https://avatars.githubusercontent.com/u/17822565?s=64&v=4)](https://github.com/zdohnal)
* [![@AZero13](https://avatars.githubusercontent.com/u/83477269?s=64&v=4)](https://github.com/AZero13)
* [![@tillkamppeter](https://avatars.githubusercontent.com/u/1244825?s=64&v=4)](https://github.com/tillkamppeter)
* [![@jschwender](https://avatars.githubusercontent.com/u/18614180?s=64&v=4)](https://github.com/jschwender)
* [![@OdyX](https://avatars.githubusercontent.com/u/417403?s=64&v=4)](https://github.com/OdyX)
* [![@scootergrisen](https://avatars.githubusercontent.com/u/1836590?s=64&v=4)](https://github.com/scootergrisen)
* [![@bmasonrh](https://avatars.githubusercontent.com/u/15787501?s=64&v=4)](https://github.com/bmasonrh)
* [![@surajkulriya](https://avatars.githubusercontent.com/u/45878143?s=64&v=4)](https://github.com/surajkulriya)
* [![@hardfalcon](https://avatars.githubusercontent.com/u/2605882?s=64&v=4)](https://github.com/hardfalcon)
* [![@evanmiller](https://avatars.githubusercontent.com/u/134711?s=64&v=4)](https://github.com/evanmiller)
* [![@Atalanttore](https://avatars.githubusercontent.com/u/628474?s=64&v=4)](https://github.com/Atalanttore)
* [![@yetamrra](https://avatars.githubusercontent.com/u/7664079?s=64&v=4)](https://github.com/yetamrra)
* [![@benlees](https://avatars.githubusercontent.com/u/30915554?s=64&v=4)](https://github.com/benlees)

[+ 86 contributors](/OpenPrinting/cups/graphs/contributors)

## Languages

* [C
  92.6%](/OpenPrinting/cups/search?l=c)
* [C++
  4.0%](/OpenPrinting/cups/search?l=c%2B%2B)
* [Makefile
  1.1%](/OpenPrinting/cups/search?l=makefile)
* [M4
  1.1%](/OpenPrinting/cups/search?l=m4)
* [Shell
  0.9%](/OpenPrinting/cups/search?l=shell)
* [Roff
  0.3%](/OpenPrinting/cups/search?l=roff)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.akamai.com_b501ccd7_20250110_182452.html ===


Twitter
LinkedIn
Email

![](data:image/png;base64...)

Close

X

Skip to main content

Need cloud computing?
[Get started now](https://www.linode.com/)

Close Button

[![Akamai logo](/site/ko/images/logo/akamai-logo1.svg)](/)

+1-8774252624

+1-8774252624

Login
[Control Center

Access the Akamai platform](https://control.akamai.com/)

[Cloud Manager

Manage your cloud resources](https://login.linode.com/login)

en

* [English](/blog/security-research/october-cups-ddos-threat "English")
* [Deutsch](/de/blog/security-research/october-cups-ddos-threat " Deutsch")
* [Español](/es/blog/security-research/october-cups-ddos-threat "Español")
* [Français](/fr/blog/security-research/october-cups-ddos-threat "Français")
* [Italiano](/it/blog/security-research/october-cups-ddos-threat "Italiano")
* [Português](/pt/blog/security-research/october-cups-ddos-threat " Português")
* [中文](/zh/blog/security-research/october-cups-ddos-threat "中文")
* [日本語](/ja/blog/security-research/october-cups-ddos-threat "日本語")
* [한국어](/ko/blog/security-research/october-cups-ddos-threat "한국어")

[Try Akamai](/products#free-trials)

[Under Attack?](/why-akamai/stop-cyberthreats)

Back

1. Products
2. Solutions
3. Why Akamai
4. Resources
5. Partners
6. Contact Us

+1-8774252624

Back

#### Products

Back

1. Security
2. Cloud Computing
3. Content Delivery
4. [All Products and Trials](/products)
5. [Global Services](/global-services)

+1-8774252624

Back

#### Security

### Security

[Learn more](/solutions/security)

###### App and API Security

 [API Security](/products/api-security)

Discover and monitor API behavior to respond to threats and abuse

 [App & API Protector](/products/app-and-api-protector)

Protect web apps and APIs from DDoS, bots, and OWASP Top 10 exploits

 [Client-Side Protection & Compliance](/products/client-side-protection-compliance)

Assist with PCI compliance and protect against client-side attacks

###### Zero Trust Security

 [Akamai Guardicore Platform](/products/akamai-guardicore-platform)

One Zero Trust platform for coverage, visibility, and granular control.

 [Akamai Guardicore Segmentation](/products/akamai-guardicore-segmentation)

Mitigate risk in your network with granular, flexible segmentation

 [Secure Internet Access](/products/secure-internet-access-enterprise)

Proactively protect against zero-day malware and phishing

 [Hunt](/products/hunt)

Stop the most evasive threats with proactive threat hunting

 [Enterprise Application Access](/products/enterprise-application-access)

Granular application access based on identity and context

 [Akamai MFA](/products/akamai-mfa)

Harden against account takeovers and data breaches with phish-proof MFA

###### Bot & Abuse Protection

 [Account Protector](/products/account-protector)

Mitigate account abuse and grow your digital business

 [Content Protector](/products/content-protector)

Stop scrapers, protect intellectual property, and increase conversion

 [Brand Protector](/products/brand-protector)

Detect and mitigate fraudulent representations of your brand

 [Bot Manager](/products/bot-manager)

Welcome the bots you want and mitigate those you don’t

 [Identity Cloud](/products/identity-cloud)

Add secure, cloud-based identity management to your websites or apps

###### INFRASTRUCTURE SECURITY

 [Edge DNS](/products/edge-dns)

External authoritative solution for your DNS infrastructure

 [Prolexic](/products/prolexic-solutions)

Protect your infrastructure from distributed denial-of-service attacks

 [IP Accelerator](/products/ip-accelerator)

Boost network performance and security for IP-based applications

#### Cloud Computing

### Cloud Computing

[Learn more](/solutions/cloud-computing)

[Create a Cloud Account](/create-account)

Compute

Build, release, and scale faster with VMs for every workload

[See all](/solutions/cloud-computing/compute)

Networking

Secure your network, balance traffic, control your infrastructure

[See all](/solutions/cloud-computing/networking)

Containers

Efficiently orchestrate containerized applications

[See all](/solutions/cloud-computing/containers)

Developer Tools

Get the most out of your applications with advanced management tools

[See all](/solutions/cloud-computing/developer-tools)

Storage

Deploy dependable, easily accessible storage and management

[See all](/solutions/cloud-computing/storage)

Databases

Scale easily with simple and reliable managed databases

[See all](/solutions/cloud-computing/databases)

[Create a Cloud Account](/create-account)

#### Content Delivery

### Content Delivery

[Learn more](/solutions/content-delivery-network)

###### APPLICATION PERFORMANCE

 [Ion](/products/web-performance-optimization)

Improve the performance and reliability of your website at scale

 [API Acceleration](/products/api-acceleration)

Improve the performance and reliability of your APIs at scale

 [IP Accelerator](/products/ip-accelerator)

Boost network performance and security for IP-based applications

###### MEDIA DELIVERY

 [Adaptive Media Delivery](/products/adaptive-media-delivery)

High-quality video delivery for any screen to global audiences

 [Download Delivery](/products/download-delivery)

Deliver large file downloads flawlessly, every time, at global scale

###### EDGE APPLICATIONS

 [EdgeWorkers](/products/serverless-computing-edgeworkers)

Execute custom JavaScript at the edge, near users, to optimize UX

 [EdgeKV](/products/edgekv)

Distributed key-value store database at the edge

 [Image & Video Manager](/products/image-and-video-manager)

Automatically optimize images and video for every user, on any device

 [Cloudlets](/products/cloudlets)

Predefined apps that run at the edge for specific business needs

 [Cloud Wrapper](/products/cloud-wrapper)

Use an efficient caching layer to improve origin offload

 [Global Traffic Management](/products/global-traffic-management)

Optimize performance with intelligent load balancing

###### MONITORING, REPORTING, AND TESTING

 [DataStream](/products/datastream)

Low-latency data feed for visibility and ingest into third-party tools

 [mPulse](/products/mpulse-real-user-monitoring)

Measure the business impact of real user experiences in real time

 [CloudTest](/products/cloudtest)

Site and application load testing at global scale

#### Solutions

Back

1. Use Cases
2. Industry Solutions

+1-8774252624

Back

#### Use Cases

## CLOUD COMPUTING

 [Media](/solutions/cloud-computing/media)

Deliver an engaging, interactive video experience

 [SaaS](/solutions/cloud-computing/saas)

Build with portability, performance, and efficiency from cloud to client

 [Gaming](/solutions/cloud-computing/gaming)

Improve the gamer experience with low latency and high availability

## SECURITY

 [Ransomware Protection](/solutions/ransomware-protection)

Mitigate attacks by limiting malware ingress and stopping lateral movement

 [Apps and APIs](/solutions/security/app-and-api-security)

Protect your brand by securing apps and APIs from persistent threats

 [Zero Trust](/solutions/security/zero-trust-security)

Solutions for comprehensive coverage, visibility and control

 [DDoS Protection](/solutions/security/ddos-protection)

Protect your infrastructure from DDoS and DNS attacks

 [Bot & Abuse Protection](/solutions/security/bot-and-abuse-protection)

Stop account abuse, sophisticated bot attacks, and brand impersonation

## CONTENT DELIVERY

 [App and API Performance](/solutions/content-delivery-network/app-and-api-performance)

Improve user engagement through app & API optimization

 [Media Delivery](/solutions/content-delivery-network/media-delivery)

Deliver seamless streaming and download experiences to any device

 [Edge Compute](/solutions/edge)

Build and deploy on the world’s most distributed edge platform

#### Industry Solutions

 [Media and Entertainment](/solutions/industries/media)

 [Retail, Travel, and Hospitality](/solutions/industries/retail-travel-hospitality)

 [Financial Services](/solutions/industries/financial-services)

 [Healthcare and Life Sciences](/solutions/industries/health-care-life-sciences)

 [Public Sector](/solutions/industries/public-sector)

 [Games](/solutions/industries/games)

 [iGaming and Sports Betting](/solutions/industries/online-sports-betting)

 [Publishing](/solutions/industries/publishing)

 [Service Providers](/solutions/industries/service-providers)

#### Why Akamai

Why Akamai

Discover Akamai Connected Cloud

[Learn more](/why-akamai)

Our Platform

Explore our global infrastructure

[Learn more](/why-akamai/global-infrastructure)

Company

See how we power and protect life online

[Learn more](/company)

#### Resources

Back

1. Library
2. Learn
3. Security Research
4. [TechDocs](https://techdocs.akamai.com/home)
5. [Developer Resources](/developer)
6. [Blog](/blog)
7. [Events](/resources/events)

+1-8774252624

Back

#### Library

### Library

[See all](/resources)

 [Product Briefs](/resources/product-brief)

 [Reference Architectures](/resources/reference-architecture)

 [Customer Stories](/resources/customer-story)

 [Ebooks](/resources/ebook)

 [White Papers](/resources/white-paper)

 [Webinars](/resources/webinar)

 [Videos](/resources/video)

#### Learn

 [Learning Hub](/learn)

Educational resources and training for Akamai products and services

 [Glossary](/glossary)

Key concepts in security, cloud computing, and content delivery

#### Security Research

 [Akamai Security Research](/security-research)

Insights and intelligence from the Akamai Security Intelligence Group

 [State of the Internet (SOTI) Reports](/security-research/the-state-of-the-internet)

In-depth analysis of the latest cybersecurity research and trends

#### Partners

Back

1. Find a Partner
2. Become a Partner
3. [Cloud Computing Marketplace](https://www.linode.com/marketplace/)

+1-8774252624

Back

#### Find a Partner

 [Why Choose an Akamai Partner](/partners/overview)

Learn about our industry-leading ecosystem of partners

 [Partner Directory](/partners/partner-directory)

Find a channel or technology partner

#### Become a Partner

 [Channel Partners](/partners/channel)

Unlock more profit, focus on what matters, and deliver with confidence

 [Technology Partners](/partners/technology)

Create more value for joint customers with seamless integrations

#### Contact Us

Contact Sales

Have questions? We can help.

[Contact us](/why-akamai/contact-us/contact-sales)

Customer Support

Need technical support? We are here 24/7.

[Get support](/global-services/support)

Login
[Control Center

Access the Akamai platform](https://control.akamai.com/)

[Cloud Manager

Manage your cloud resources](https://login.linode.com/login)

en

* [English](/blog/security-research/october-cups-ddos-threat "English")
* [Deutsch](/de/blog/security-research/october-cups-ddos-threat " Deutsch")
* [Español](/es/blog/security-research/october-cups-ddos-threat "Español")
* [Français](/fr/blog/security-research/october-cups-ddos-threat "Français")
* [Italiano](/it/blog/security-research/october-cups-ddos-threat "Italiano")
* [Português](/pt/blog/security-research/october-cups-ddos-threat " Português")
* [中文](/zh/blog/security-research/october-cups-ddos-threat "中文")
* [日本語](/ja/blog/security-research/october-cups-ddos-threat "日本語")
* [한국어](/ko/blog/security-research/october-cups-ddos-threat "한국어")

1. [Blog](/blog)
2. [Security Research](/blog/security-research)
3. When CUPS Runneth Over: The Threat of DDoS

# When CUPS Runneth Over: The Threat of DDoS

![Akamai Wave Blue](/site/en/images/blog/userpics/akamai-wave-blog-author.png)

Written by

[Larry Cashdollar](/blog?author=larry_cashdollar), [Kyle Lefton](/blog?author=kyle-lefton), and [Chad Seaman](/blog?author=chad_seaman)

October 01, 2024

![Larry Cashdollar](/site/en/images/blog/userpics/larry-cashdollar.jpeg)

Written by

[Larry Cashdollar](/blog?author=larry_cashdollar)

Larry Cashdollar has been working in the security field as a vulnerability researcher for more than 20 years and is currently a Principal Security Researcher on the Security Intelligence Response Team at Akamai. He studied computer science at the University of Southern Maine. Larry has documented more than 300 CVEs and has presented his research at BotConf, BSidesBoston, OWASP Rhode Island, and DEF CON. He enjoys the outdoors and rebuilding small engines in his spare time.

![Akamai Wave Blue](/site/en/images/blog/userpics/akamai-wave-blog-author.png)

Written by

[Kyle Lefton](/blog?author=kyle-lefton)

Kyle Lefton is a security researcher on Akamai's Security Intelligence Response Team. Formerly an intelligence analyst for the Department of Defense, Kyle has experience in cyber defense, threat research, and counter-intelligence, spanning several years. He takes pride in investigating emerging threats, vulnerability research, and threat group mapping. In his free time, he enjoys spending time with friends and family, strategy games, and hiking in the great outdoors.

![Chad Seaman headshot](/site/en/images/blog/userpics/userpic-666-100x100.png)

Written by

[Chad Seaman](/blog?author=chad_seaman)

Chad Seaman is a Principal Security Researcher and Team Lead of Akamai’s Security Intelligence Response Team. He proudly refers to himself as an “Internet Dumpster Diver,” and enjoys looking through the muck and mire he finds there. Chad began his career as a programmer, and after being exposed to security, exploitation, and forensics via breach investigations, security quickly became his preferred work. He now spends his time engulfed in malware investigations, reverse engineering, vulnerability research, DDoS, and cybercrime investigations. He likes flying airplanes, poking holes in paper at a distance, and spending time in nature, preferably in the woods, on a trail, or on a dirt bike.

Share

![It would take an attacker mere seconds to co-opt every vulnerable CUPS service currently exposed on the internet.](/site/en/images/blog/2024/thumbnails/edge-1080x608-1.png)
It would take an attacker mere seconds to co-opt every vulnerable CUPS service currently exposed on the internet.

Editorial and additional commentary by Tricia Howard

## Executive summary

* Akamai researchers have confirmed a new attack vector using CUPS that could be leveraged to stage distributed denial-of-service (DDoS) attacks. (CVE-2024-47850)
* Research shows that, to begin the attack, the attacking system only needs to send a single packet to a vulnerable and exposed CUPS service with internet connectivity.
* The Akamai Security Intelligence and Response Team (SIRT) found that more than 198,000 devices are vulnerable to this attack vector and are accessible on the public internet; roughly 34% of those could be used for DDoS abuse (58,000+).
* Of the 58,000+ vulnerable devices, hundreds exhibited an “infinite loop” of requests.
* The limited resources required to initiate a successful attack highlights the danger: **It would take an attacker mere seconds to co-opt every vulnerable CUPS service currently exposed on the internet and cost the attacker less than a single US cent on modern hyperscaler platforms**.

[Jump to mitigations](#cups)

## The CVEs

On September 26, 2024, security researcher evilsocket [disclosed](https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/) remote code execution (RCE) vulnerabilities within the Common Unix Printing System (CUPS). In short, an attacker could [manipulate Internet Printing Protocol (IPP) URLs remotely](/blog/security-research/guidance-on-critical-cups-rce) to execute malicious commands. This could be done by chaining together four different vulnerabilities.

1. **CVE-2024-47176** in *cups-browsed*, which coerces a request to an attacker-controlled address
2. **CVE-2024-47076** in *libcupsfilters*, which does not validate or sanitize data returned from the attacker’s server, and passes it to the rest of the CUPS system
3. **CVE-2024-47175** in *libppd*, which again involves not sanitizing input, and writing it to a temporary file
4. **CVE-2024-47177** in *cups-filters*, which allows for an arbitrary command execution

## More to the CUPS story

While reviewing the technical write-up about the vulnerabilities, we discovered that another attack vector was not discussed: [DDoS](https://nvd.nist.gov/vuln/detail/CVE-2024-47850). DDoS continues to be a viable attack vector used to harass and disrupt victims across the internet, from major industries and governments to small content creators, online shops, and gamers. Although the original analysis focused on the RCE, which could have a more severe outcome, DDoS amplification is also easily abused in this case.

The problem arises when an attacker sends a crafted packet specifying the address of a target as a printer to be added. For each packet sent, the vulnerable CUPS server will generate a larger and partially attacker-controlled IPP/HTTP request directed at the specified target. **As a result, not only is the target affected, but the host of the CUPS server also becomes a victim, as the attack consumes its network bandwidth and CPU resources**.

## Exploitation

A simple script can be used to send the malicious UDP packet to a vulnerable instance of CUPS. The crafted payload directs CUPS to send an IPP/HTTP request to the target and port specified by the attacker. **The vulnerability appears when *cups-browsed* attempts to fetch the URI specified to download the IPP attributes file**.

This PPD file URI is somewhat arbitrary and can be modified by the attacker. In testing, we found this URI payload can be padded out to 989 bytes. This padding will be included twice in the IPP/HTTP request: once in the HTTP headers, and again in the POST data that will be directed at the targeted system.

By using this padding technique, attackers could further exacerbate the impact of CUPS-supported DDoS attacks by consuming additional bandwidth and resources on the targeted networks and systems. Figure 1 is a visual representation of what this would look like.

![ Figure 1 is a visual representation of what this would look like.](/site/en/images/blog/2024/october-cups-ddos-threat-one.jpg)
Fig. 1: Network diagram of attack flow

### Attacking system

One of the more troubling facets of this threat is how few resources are needed by the attacker to execute it. Figures 2 and 3 show **the attacking system only needs to send a single packet to a vulnerable and exposed CUPS service with internet connectivity to cause the system running CUPS to begin the attack.**

```

  ./cups.py [CUPS_IP] [TARGET_IP]:1337 attacker_controlled-payload%20goes.here

  Sending UDP Payload to target [TARGET_IP] and port 1337
  Bytes Sent: 78

```
Copy

Fig. 2: Staging exploit

```

    09:05:03.072432 IP 192.168.12.143.43937 > X.X.X.X.631: UDP, length 78
	0x0000:  4500 006a 1991 4000 4011 2ed5 c0a8 0c8f  E..j..@.@.......
	0x0010:  xxxx xxxx aba1 0277 0056 bb25 3020 3000  .......w.V.%0.0.
	0x0020:  6874 7470 3a2f 2fxx xxxx 2exx xx2e xxxx  http://xxx.xx.xx
	0x0030:  2exx xxxx 3a31 3333 372f 7072 696e 7465  .xxx:1337/printe
	0x0040:  7273 2f61 7474 6163 6b65 725f 636f 6e74  rs/attacker_cont
	0x0050:  726f 6c6c 6564 2d70 6179 6c6f 6164 2532  rolled-payload%2
	0x0060:  3067 6f65 732e 6865 7265                 0goes.here

```
Copy

Fig. 3: Outgoing UDP packet (modified to be a nonfunctional payload)

### Target system

What we end up with is the CUPS service attempting to fetch what it believes to be an IPP attributes file, but is, in reality, whatever the attacker had specified. The target specified in the UDP packet will start to receive incoming TCP connections from the system running CUPS (Figure 4).

![The target specified in the UDP packet will start to receive incoming TCP connections from the system running CUPS (Figure 4). ](/site/en/images/blog/2024/october-cups-ddos-threat-two.png)
Fig. 4: CUPS service establishing a connection to the target

If we look closer at the two received packets that contained the actual request data, we can see the raw IPP request, and the accompanying POST data, partially attacker-controlled, coming from the CUPS service (Figure 5).

![If we look closer at the two received packets that contained the actual request data, we can see the raw IPP request, and the accompanying POST data, partially attacker-controlled, coming from the CUPS service (Figure 5).](/site/en/images/blog/2024/october-cups-ddos-threat-three.png)
Fig. 5: IPP/HTTP request received by the target

We can see from the logs for the cups-browsed daemon that the browsed attempts at fetching the IPP attributes are ultimately what generates these requests directed at the targeted host (Figure 6).

![We can see from the logs for the cups-browsed daemon that the browsed attempts at fetching the IPP attributes are ultimately what generates these requests directed at the targeted host (Figure 6). ](/site/en/images/blog/2024/october-cups-ddos-threat-four.jpg)
Fig. 6: Cups-browsed logs

## Impact and exposure

To ensure a well-rounded analysis, we tested and observed different patterns from machines both in the controlled lab and across the internet. These patterns greatly impact the attack scenarios and amplification factors.

The Akamai SIRT scanned and analyzed the global internet for devices that are vulnerable to this flaw and are accessible on the public internet (198,000+), based on data provided to us from evilsocket. Based on that data, we found that approximately 34% of those devices (58,000+) were vulnerable to this attack.

Additionally, our testing found that **some of these active CUPS servers will beacon back repeatedly after receiving the initial requests, with some of them appearing to do it endlessly in response to HTTP/404 responses**. Hundreds of these systems in the wild individually established thousands of requests and sent them to our testing systems.

This shows that the potential amplification from this vulnerability is quite large and could cause significant issues for organizations who run these affected servers. We also confirmed through our testing that some of the vulnerable CUPS servers were able to complete Transport Layer Security (TLS) handshakes from our probing attempts against valid HTTPS protected websites. The possibility of affecting TLS also adds more fuel to the fire, as it creates further strain on server hardware and resource consumption overhead due to the handshake and encryption/decryption processing.

### Outdated technology strikes again

We should note that many of these identified machines were running on very old versions of CUPS, such as version 1.3, which was initially released in 2007. It isn’t uncommon for some organizations to leave machines running on extremely outdated hardware and software, and it is unlikely that such devices will be updated anytime soon. **This presents a prime opportunity for malicious threat actors: They can take advantage of the outdated hardware for DDoS amplification, or (given the RCE in this scenario) build botnets for many purposes, including DDoS**.

### Amplification estimates

Amplification rates can vary significantly so we have covered both an average scenario and a worst-case scenario to help readers assess the potential threat.

Ultimately, the targeting directive dictates the size of this payload, but for baseline calculations we’ll use a minimum viable UDP packet size of 30 bytes and a maximally padded 1028-byte UDP packet for the worst case. This packet uses the IPP URI directive and fills it with 989 bytes (the maximum found during testing), which is duplicated and included in the resulting attack traffic.

**In the worst-case scenario, we observed what appeared to be an endless stream of attempted connections and requests as a result of a single probe**. These flows appear to have no end, and will continue until the daemon is killed or restarted. This could be considered an infinite amplification in this scenario. During testing of the 58,000+ responders, a few hundred exhibited this pattern.

**Roughly 62% (35,900+) of systems sent at least 10 TCP/IPP/HTTP requests to our target system in response to our UDP packet**. Overall, the response rate across the 58,000+ responders (including time-scoped infinite responders) averaged 45 responses, which is what we’ll use to further calculate potential amplification rates.

In the minimum viable probe (30 bytes) scenario, we see that the target machine received a full TCP connection and two packets with payloads. The first packet contains the HTTP request and headers; the second contains the POST data for the request (Figure 7).

![The first packet contains the HTTP request and headers; the second contains the POST data for the request (Figure 7).](/site/en/images/blog/2024/october-cups-ddos-threat-five.png)
Fig. 7: Minimal viable amplification flow

These packets (226 bytes and 174 bytes) total 400 bytes. If we assume that we’ll get these connections and requests 45 times per CUPS reflector, that’s 18,000 bytes of resulting traffic per each 30-byte probe, or roughly a 600x amplification factor on an *average* attempt.

### Lower amplification doesn’t mean lower impact

The worst-case scenario has different results outside of packet size. If we run this same exercise using maximally padded UDP payloads of 1,028 bytes (Figure 8), we see much larger flows directed at the target, but lower amplification.

![The worst-case scenario has different results outside of packet size. If we run this same exercise using maximally padded UDP payloads of 1,028 bytes (Figure 8), we see much larger flows directed at the target, but lower amplification. ](/site/en/images/blog/2024/october-cups-ddos-threat-six.png)
Fig. 8: Maximally padded attack payloads arriving at the target

In this scenario, our two-packet payload still arrives, but the respective sizes are now 1,217 bytes and 1,164 bytes, totaling 2,381 bytes. Assuming the same average of 45 responses per reflector, we end up with a total of 107,000 bytes of traffic per 1,028-byte probe, and our amplification rate drops to 104x.

Although the amplification rate dropped, **the bandwidth consumed on the target network is nearly 6x the minimally viable payload**. This would also result in the targeted HTTP server needing to allocate resources for handling and processing these requests. So, although it doesn’t improve amplification rates, this scenario does present a more problematic (and realistic) attack for defenders.

### Scaling these possibilities

If we assume all 58,000+ identified CUPS hosts were corralled into the same campaign, it could result in a deluge of 1 GB of incoming attack traffic per UDP packet from the minimally padded example. A maximally padded scenario could result in a 6-GB flood of traffic. Although these bandwidth numbers may not be considered earth-shattering, they would still result in the target’s need to handle roughly 2.6 million TCP connections and HTTP requests in either scenario.

## DDoS options in CUPS

Attacks of this nature are part of the troubling trend of an ever-decreasing technical barrier to entry for threat actors to conduct such attacks — directing vulnerable systems across the internet to send sustained floods of traffic to victims. To make matters worse, this can be achieved by sending a single packet to internet-exposed CUPS services. **It would take an attacker mere seconds to co-opt every vulnerable CUPS service currently exposed on the internet and cost the attacker less than a single US cent on modern hyperscaler platforms**.

As evilsocket’s research pointed out, there are slightly more than 198,000 devices found on the internet that respond back to UDP probes — and of those, the SIRT found that roughly 34% (58,000+) reacted to our UDP probe in a manner that could be easily abused for DDoS.

A remote attacker using a crafted payload could exploit this vulnerability to get the *cups-browsed* daemon to make outbound TCP connections to a third party. If said target happens to be running an HTTPS server on the targeted port, the server will have to spend cycles and resources trying to parse and handle these requests and data, potentially making the attack even more impactful. In the case of CDNs and caching, it’s unlikely that the URLs being specified in the POST request will exist, resulting in a 404 error that bypasses cache hits and forwards these payloads on to the origin servers.

Based on the research conducted by evilsocket, many distributions and versions of CUPS were impacted. Ultimately, the vulnerability lies in “*cups-browsed*” packaged with “*cups-filters*” when receiving a request to add a printer via UDP.  There appear to be mitigations from several Linux distributions that bind *cups-browsed* to *localhost* or disable cups-browsed from listening entirely.

## CUPS vulnerabilities mitigations

The decision to update to the latest version of CUPS or remove it entirely depends on your system's specific needs. If your system relies on printing functionality, updating to the latest version of CUPS ensures improved security, performance, and support for modern devices. However, if printing is unnecessary for your setup, removing CUPS can simplify your system, reduce potential vulnerabilities, and save resources.

Ultimately, this decision should be based on how essential printing capabilities are for your environment and on the importance of maintaining an up-to-date, secure system. At the very least, if removing or updating the CUPS software isn’t viable, defenders should firewall the service ports (UDP/631), especially if they’re accessible from the broader internet.

Threat actors are often quick to leverage newly reported vulnerabilities, with many new releases being exploited within just seven days after initial disclosure. Patching takes time, and hackers are eager to take advantage of that vulnerable transition period. Many organizations also neglect to update some of their older software, which may make it especially lucrative for hackers to jump on the bandwagon of exploiting new vulnerabilities such as this.

## DDoS mitigation for victims

For victims of a DDoS attack launched from vulnerable CUPS systems, there are some traits of the traffic to help alert, confirm, and drop attack traffic on the network or at the [web application firewall (WAF)](/glossary/what-is-a-waf).

All requests coming from the CUPS service begin with *POST /printers/*or *POST /classes/* and while the payload after the */printers/* string is attacker controllable, the initial part of the payload is not.  Additionally, the CUPS *User-Agent* strings are very informative and use the format *CUPS/[VERSION]*, as well as a reference to IPP.  These are very unique strings in the UA and are not typically observed in organic traffic.

There are also static elements in HTTP headers and POST data. The *Content-Type* header of *application/ipp* and payload *printer-uri* in the POST data are both static values we identified during testing (Figure 9).

![There are also static elements in HTTP headers and POST data. The Content-Type header of application/ipp and payload printer-uri in the POST data are both static values we identified during testing (Figure 9).](/site/en/images/blog/2024/october-cups-ddos-threat-seven.png)
Fig. 9: Highlighted values in observed traffic that could aid in detection and blocking

To aid defenders we’ve also included a Snort rule that should help identify these flows coming into your network over plaintext sockets (Figure 10).

```

  alert http any any -> any any (msg:"CUPS Reflected DDoS IPP Request";
pcre:"/POST \/printers\/|POST \/classes\//"; http_method;
content:"Content-Type: application/ipp"; http_header;
content:"User-Agent: CUPS/"; http_header;
content:"printer-uri"; http_client_body;
metadata:service http;
reference:url,https://akamai.com/blog/security-research/2024/october-cups-ddos-threat;
sid:100004; rev:2;)

```
Copy

Fig. 10: Snort rule for CUPS attack traffic

As mentioned, we found systems in the wild that would complete HTTPS handshakes before delivering their HTTP payloads, so defenders that use HTTPS should consider implementing these matching rules in their WAF configurations rather than on their network monitoring systems.

## Conclusion

New DDoS attack vectors are sometimes found, and often quickly abused, by low-skilled opportunistic attackers. This vulnerability in CUPS and the large population of devices that could be abused in this manner lead us to believe that it’s likely that defenders may encounter CUPS-based attacks.

Until messaging and cleanup efforts get traction to reduce the number of devices that are vulnerable and exposed on the internet (currently 58,000+), we suspect this vector will see abuse in the wild. We’re hoping that defenders, network operators, and system administrators will get the message and, for the sake of everyone, handle their respective exposures quickly, or at least be prepared to identify and fend off attackers that may leverage the exposures in the future.

**We would like to thank [evilsocket (Simone Margaritelli)](https://x.com/evilsocket) for his valuable assistance and input. ♥️**

[See more research](/security-research)

---

* [Threat Intelligence](/blog?filter=blogs/threat-intelligence)
* [Security Research](/blog?filter=blogs/security-research)
* [Cyber Security](/blog?filter=blogs/cyber-security)
* [DDoS](/blog?filter=blogs/ddos)
* [Research](/blog?filter=blogs/research)

Share

---

![Akamai Wave Blue](/site/en/images/blog/userpics/akamai-wave-blog-author.png)

Written by

[Larry Cashdollar](/blog?author=larry_cashdollar), [Kyle Lefton](/blog?author=kyle-lefton), and [Chad Seaman](/blog?author=chad_seaman)

October 01, 2024

![Larry Cashdollar](/site/en/images/blog/userpics/larry-cashdollar.jpeg)

Written by

[Larry Cashdollar](/blog?author=larry_cashdollar)

Larry Cashdollar has been working in the security field as a vulnerability researcher for more than 20 years and is currently a Principal Security Researcher on the Security Intelligence Response Team at Akamai. He studied computer science at the University of Southern Maine. Larry has documented more than 300 CVEs and has presented his research at BotConf, BSidesBoston, OWASP Rhode Island, and DEF CON. He enjoys the outdoors and rebuilding small engines in his spare time.

![Akamai Wave Blue](/site/en/images/blog/userpics/akamai-wave-blog-author.png)

Written by

[Kyle Lefton](/blog?author=kyle-lefton)

Kyle Lefton is a security researcher on Akamai's Security Intelligence Response Team. Formerly an intelligence analyst for the Department of Defense, Kyle has experience in cyber defense, threat research, and counter-intelligence, spanning several years. He takes pride in investigating emerging threats, vulnerability research, and threat group mapping. In his free time, he enjoys spending time with friends and family, strategy games, and hiking in the great outdoors.

![Chad Seaman headshot](/site/en/images/blog/userpics/userpic-666-100x100.png)

Written by

[Chad Seaman](/blog?author=chad_seaman)

Chad Seaman is a Principal Security Researcher and Team Lead of Akamai’s Security Intelligence Response Team. He proudly refers to himself as an “Internet Dumpster Diver,” and enjoys looking through the muck and mire he finds there. Chad began his career as a programmer, and after being exposed to security, exploitation, and forensics via breach investigations, security quickly became his preferred work. He now spends his time engulfed in malware investigations, reverse engineering, vulnerability research, DDoS, and cybercrime investigations. He likes flying airplanes, poking holes in paper at a distance, and spending time in nature, preferably in the woods, on a trail, or on a dirt bike.

## Related Blog Posts

[![The malware samples we identified were Mirai-based malware variants that were distributed in a variety of architectures.](/site/en/images/blog/2024/thumbnails/edge-1080x608-1.png)
The malware samples we identified were Mirai-based malware variants that were distributed in a variety of architectures.](/blog/security-research/digiever-fix-that-iot-thing)

## DigiEver Fix That IoT Thing!

December 19, 2024
A vulnerability in DigiEver DS-2105 Pro DVRs is being exploited to spread a Mirai variant that has been modified to use improved encryption algorithms.
by Kyle Lefton, Daniel Messing, and Larry Cashdollar
[Read more](/blog/security-research/digiever-fix-that-iot-thing)

[![This month, there are 71 total CVEs across 32 different components. Of those CVEs, 17 are critical and one was seen in the wild.](/site/en/images/blog/2024/thumbnails/edge-1080x608-1.png)
This month, there are 71 total CVEs across 32 different components. Of those CVEs, 17 are critical and one was seen in the wild.](/blog/security-research/akamai-perspective-patch-tuesday-december-2024)

## Akamai’s Perspective on December’s Patch Tuesday 2024

December 13, 2024
Hope you left some room after Thanksgiving — we’re stuffing CVEs while waiting for our stockings. This month, we’ve got 71 total CVEs; one seen in the wild.
by Akamai Security Intelligence Group
[Read more](/blog/security-research/akamai-perspective-patch-tuesday-december-2024)

[![This analysis is an unfortunate example of how technology created for good can be hijacked for malicious purposes.](/site/en/images/blog/2024/thumbnails/edge-1080x608-1.png)
This analysis is an unfortunate example of how technology created for good can be hijacked for malicious purposes.](/blog/security-research/2024-december-windows-ui-automation-attack-technique-evades-edr)

## Teaching an Old Framework New Tricks: The Dangers of Windows UI Automation

December 11, 2024
Microsoft’s UI Automation framework has some great features, but in the wrong hands, it can lead to bad outcomes — and even evade your EDR.
by Tomer Peled
[Read more](/blog/security-research/2024-december-windows-ui-automation-attack-technique-evades-edr)

### Products

* [Cloud Computing](/solutions/cloud-computing)
* [Security](/solutions/security)
* [Content Delivery](/solutions/content-delivery-network)
* [All Products and Trials](/products)
* [Global Services](/global-services)

### company

* [About Us](/company)
* [History](/company/company-history)
* [Leadership](/company/leadership)
* [Facts and Figures](/company/facts-figures)
* [Awards](/company/our-awards)
* [Board of Directors](/company/leadership/board-of-directors)
* [Investor Relations](https://www.ir.akamai.com)
* [Corporate Responsibility](/company/corporate-responsibility)
* [Ethics](/company/ethics-and-compliance)
* [Locations](/company/locations)
* [Vulnerability Reporting](/global-services/support/vulnerability-reporting)

### Careers

* [Careers](/careers)
* [Working at Akamai](/careers/working-at-akamai)
* [Students and Recent Grads](/careers/students-and-recent-graduates)
* [Workplace Diversity](/careers/workplace-diversity)
* [Search Jobs](https://akamaicareers.inflightcloud.com/search?searchable=%5B%5D§ion=aka_ext)
* [Culture Blog](/blog/culture)

### newsroom

* [Newsroom](/newsroom)
* [Press Releases](/newsroom/press-release)
* [In the News](/newsroom/in-the-news)
* [Media Resources](/newsroom/media-resources)

### Legal & compliance

* [Legal](/legal)
* [Information Security Compliance](/legal/compliance)
* [Privacy Trust Center](/legal/compliance/privacy-trust-center)
* [Cookie Settings](/legal/manage-cookie-preferences)
* [EU Digital Services Act (DSA)](/legal/eu-digital-services-act)

### Glossary

* [What Is API Security?](/glossary/what-is-api-security)
* [What Is a CDN?](/glossary/what-is-a-cdn)
* [What Is Cloud Computing?](/glossary/what-is-cloud-computing)
* [What Is Cybersecurity?](/glossary/what-is-cybersecurity)
* [What Is a DDoS attack?](/glossary/what-is-ddos)
* [What Is Microsegmentation?](/glossary/what-is-microsegmentation)
* [What Is WAAP?](/glossary/what-is-waap)
* [What Is Zero Trust?](/glossary/what-is-zero-trust)
* [See all](/glossary)

[Twitter](https://twitter.com/Akamai)
[Facebook](https://www.facebook.com/AkamaiTechnologies/)
[Youtube](https://www.youtube.com/user/akamaitechnologies)
[Linkedin](https://www.linkedin.com/company/akamai-technologies)

* [EMEA Legal Notice](/legal/emea-legal-notices)
* [Service Status](/why-akamai/stop-cyberthreats)
* [Contact Us](/why-akamai/contact-us)

---

* [EMEA Legal Notice](/legal/emea-legal-notices)
* [Service Status](https://www.akamaistatus.com/)
* [Contact Us](/why-akamai/contact-us)

* en
  + [English](/blog/security-research/october-cups-ddos-threat "English")
  + [Deutsch](/de/blog/security-research/october-cups-ddos-threat " Deutsch")
  + [Español](/es/blog/security-research/october-cups-ddos-threat "Español")
  + [Français](/fr/blog/security-research/october-cups-ddos-threat "Français")
  + [Italiano](/it/blog/security-research/october-cups-ddos-threat "Italiano")
  + [Português](/pt/blog/security-research/october-cups-ddos-threat " Português")
  + [中文](/zh/blog/security-research/october-cups-ddos-threat "中文")
  + [日本語](/ja/blog/security-research/october-cups-ddos-threat "日本語")
  + [한국어](/ko/blog/security-research/october-cups-ddos-threat "한국어")

©2025 Akamai Technologies


