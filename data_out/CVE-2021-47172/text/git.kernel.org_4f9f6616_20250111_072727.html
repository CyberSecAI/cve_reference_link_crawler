

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jonathan Cameron <Jonathan.Cameron@huawei.com> | 2021-05-13 15:07:42 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-03 09:09:30 +0200 |
| commit | [26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc)) | |
| tree | [853826865ca29f34213dd07f47d1dc4c2ff6bb6d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc) | |
| parent | [af7d9165fbb8ed80fcda8b744c1b7258fc7ef38b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=af7d9165fbb8ed80fcda8b744c1b7258fc7ef38b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc&id2=af7d9165fbb8ed80fcda8b744c1b7258fc7ef38b)) | |
| download | [linux-26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc.tar.gz) | |

iio: adc: ad7124: Fix potential overflow due to non sequential channel numberscommit f2a772c51206b0c3f262e4f6a3812c89a650191b upstream.
Channel numbering must start at 0 and then not have any holes, or
it is possible to overflow the available storage. Note this bug was
introduced as part of a fix to ensure we didn't rely on the ordering
of child nodes. So we need to support arbitrary ordering but they all
need to be there somewhere.
Note I hit this when using qemu to test the rest of this series.
Arguably this isn't the best fix, but it is probably the most minimal
option for backporting etc.
Alexandru's sign-off is here because he carried this patch in a larger
set that Jonathan then applied.
Fixes: d7857e4ee1ba6 ("iio: adc: ad7124: Fix DT channel configuration")
Reviewed-by: Alexandru Ardelean <ardeleanalex@gmail.com>
Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
Signed-off-by: Alexandru Ardelean <aardelean@deviqon.com>
Cc: <Stable@vger.kernel.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc)

| -rw-r--r-- | [drivers/iio/adc/ad7124.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/iio/adc/ad7124.c?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 0 deletions

| diff --git a/drivers/iio/adc/ad7124.c b/drivers/iio/adc/ad7124.cindex c0d0870a29ffba..9c2401c5848ece 100644--- a/[drivers/iio/adc/ad7124.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/iio/adc/ad7124.c?id=af7d9165fbb8ed80fcda8b744c1b7258fc7ef38b)+++ b/[drivers/iio/adc/ad7124.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/iio/adc/ad7124.c?id=26da8040eccc6c6b0e415e9a3baf72fd39eb2fdc)@@ -616,6 +616,13 @@ static int ad7124\_of\_parse\_channel\_config(struct iio\_dev \*indio\_dev, if (ret) goto err; + if (channel >= indio\_dev->num\_channels) {+ dev\_err(indio\_dev->dev.parent,+ "Channel index >= number of channels\n");+ ret = -EINVAL;+ goto err;+ }+ ret = of\_property\_read\_u32\_array(child, "diff-channels", ain, 2); if (ret) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 07:26:04 +0000

