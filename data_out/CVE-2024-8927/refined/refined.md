- **Root cause of vulnerability:** The `cgi.force_redirect` security feature in PHP, designed to prevent direct access to PHP scripts via URLs like `http://host.example/cgi-bin/php/secretdir/script.php`, can be bypassed. This occurs because the code checks for the presence of the `REDIRECT_STATUS` or `HTTP_REDIRECT_STATUS` environment variables, which are normally set by web servers when handling redirects. However, the `Redirect-Status` HTTP header is unexpectedly converted to the `HTTP_REDIRECT_STATUS` environment variable, allowing attackers to set this variable and bypass the intended restriction.
- **Weaknesses/vulnerabilities present:** The vulnerability is a bypass of the `cgi.force_redirect` security mechanism due to the improper handling of the `Redirect-Status` HTTP header. Specifically, the code incorrectly relies on the presence of `REDIRECT_STATUS` or `HTTP_REDIRECT_STATUS` environment variables without properly sanitizing their source (i.e. directly from headers).
- **Impact of exploitation:** Successful exploitation allows an attacker to directly access PHP scripts that are intended to be protected by `cgi.force_redirect`. In most configurations, this bypass has limited impact. However, in specific configurations that modify the `SCRIPT_FILENAME` environment variable, this could lead to arbitrary file inclusion, where an attacker could include malicious files on the server.
- **Attack vectors:** The attack vector is network-based. An attacker can send HTTP requests with the `Redirect-Status` header to the PHP CGI binary directly, bypassing the `cgi.force_redirect` check.
- **Required attacker capabilities/position:** The attacker needs the ability to send HTTP requests to the vulnerable PHP CGI binary. No special privileges or user interaction is required.

This content provides more detail than the official CVE description, explaining the technical mechanism behind the bypass.