[![](../../../../static.files/rust-logo-9a9549ea.svg)](../../../../std/index.html)[![logo](../../../../static.files/rust-logo-9a9549ea.svg)](../../../../std/index.html)
## [std](../../../../std/index.html)1.84.0

(9fc6b4312 2025-01-07)
## CommandExt

### [Required Methods](#required-methods)

* [async\_pipes](#tymethod.async_pipes "async_pipes")
* [creation\_flags](#tymethod.creation_flags "creation_flags")
* [force\_quotes](#tymethod.force_quotes "force_quotes")
* [raw\_arg](#tymethod.raw_arg "raw_arg")
* [raw\_attribute](#tymethod.raw_attribute "raw_attribute")
* [show\_window](#tymethod.show_window "show_window")

### [Dyn Compatibility](#dyn-compatibility)

### [Implementors](#implementors)

## [In std::os::windows::process](index.html)

[std](../../../index.html)::[os](../../index.html)::[windows](../index.html)::[process](index.html)
# Trait CommandExtCopy item path

1.16.0 Â· [Source](../../../../src/std/os/windows/process.rs.html#174-371)
```
pub trait CommandExt: Sealed {
    // Required methods
    fn [creation_flags](#tymethod.creation_flags)(&mut self, flags: [u32](../../../primitive.u32.html)) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command");
    fn [show_window](#tymethod.show_window)(&mut self, cmd_show: [u16](../../../primitive.u16.html)) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command");
    fn [force_quotes](#tymethod.force_quotes)(&mut self, enabled: [bool](../../../primitive.bool.html)) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command");
    fn [raw_arg](#tymethod.raw_arg)<S: [AsRef](../../../convert/trait.AsRef.html "trait std::convert::AsRef")<[OsStr](../../../ffi/struct.OsStr.html "struct std::ffi::OsStr")>>(
        &mut self,
        text_to_append_as_is: S,
    ) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command");
    fn [async_pipes](#tymethod.async_pipes)(&mut self, always_async: [bool](../../../primitive.bool.html)) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command");
    unsafe fn [raw_attribute](#tymethod.raw_attribute)<T: [Copy](../../../marker/trait.Copy.html "trait std::marker::Copy") + [Send](../../../marker/trait.Send.html "trait std::marker::Send") + [Sync](../../../marker/trait.Sync.html "trait std::marker::Sync") + 'static>(
        &mut self,
        attribute: [usize](../../../primitive.usize.html),
        value: T,
    ) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command");
}
```
Available on **Windows** only.Expand description

Windows-specific extensions to the [`process::Command`](../../../process/struct.Command.html "struct std::process::Command") builder.

This trait is sealed: it cannot be implemented outside the standard library.
This is so that future additional methods are not breaking changes.

## Required Methods[Â§](#required-methods)

1.16.0 Â· [Source](../../../../src/std/os/windows/process.rs.html#181)
#### fn [creation\_flags](#tymethod.creation_flags)(&mut self, flags: [u32](../../../primitive.u32.html)) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command")

Sets the [process creation flags](https://docs.microsoft.com/en-us/windows/win32/procthread/process-creation-flags) to be passed to `CreateProcess`.

These will always be ORed with `CREATE_UNICODE_ENVIRONMENT`.

[Source](../../../../src/std/os/windows/process.rs.html#189)
#### fn [show\_window](#tymethod.show_window)(&mut self, cmd\_show: [u16](../../../primitive.u16.html)) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command")

ð¬This is a nightly-only experimental API. (`windows_process_extensions_show_window` [#127544](https://github.com/rust-lang/rust/issues/127544))

Sets the field `wShowWindow` of [STARTUPINFO](https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfow) that is passed to `CreateProcess`.
Allowed values are the ones listed in
<https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-showwindow>

[Source](../../../../src/std/os/windows/process.rs.html#205)
#### fn [force\_quotes](#tymethod.force_quotes)(&mut self, enabled: [bool](../../../primitive.bool.html)) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command")

ð¬This is a nightly-only experimental API. (`windows_process_extensions_force_quotes` [#82227](https://github.com/rust-lang/rust/issues/82227))

Forces all arguments to be wrapped in quote (`"`) characters.

This is useful for passing arguments to [MSYS2/Cygwin](https://github.com/msys2/MSYS2-packages/issues/2176) based
executables: these programs will expand unquoted arguments containing
wildcard characters (`?` and `*`) by searching for any file paths
matching the wildcard pattern.

Adding quotes has no effect when passing arguments to programs
that use [msvcrt](https://msdn.microsoft.com/en-us/library/17w5ykft.aspx). This includes programs built with both
MinGW and MSVC.

1.62.0 Â· [Source](../../../../src/std/os/windows/process.rs.html#265)
#### fn [raw\_arg](#tymethod.raw_arg)<S: [AsRef](../../../convert/trait.AsRef.html "trait std::convert::AsRef")<[OsStr](../../../ffi/struct.OsStr.html "struct std::ffi::OsStr")>>(&mut self, text\_to\_append\_as\_is: S) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command")

Append literal text to the command line without any quoting or escaping.

This is useful for passing arguments to applications that donât follow
the standard C run-time escaping rules, such as `cmd.exe /c`.

##### [Â§](#batch-files)Batch files

Note the `cmd /c` command line has slightly different escaping rules than batch files
themselves. If possible, it may be better to write complex arguments to a temporary
`.bat` file, with appropriate escaping, and simply run that using:

```
let output = Command::new("cmd").args(["/c", &format!("\"{temp_bat_file}\"")]).output();
```
##### [Â§](#example)Example

Run a batch script using both trusted and untrusted arguments.

```
#[cfg(windows)]
// `my_script_path` is a path to known bat file.
// `user_name` is an untrusted name given by the user.
fn run_script(
    my_script_path: &str,
    user_name: &str,
) -> Result<std::process::Output, std::io::Error> {
    use std::io::{Error, ErrorKind};
    use std::os::windows::process::CommandExt;
    use std::process::Command;

    // Create the command line, making sure to quote the script path.
    // This assumes the fixed arguments have been tested to work with the script we're using.
    let mut cmd_args = format!(r#""{my_script_path}" "--features=[a,b,c]""#);

    // Make sure the user name is safe. In particular we need to be
    // cautious of ascii symbols that cmd may interpret specially.
    // Here we only allow alphanumeric characters.
    if !user_name.chars().all(|c| c.is_alphanumeric()) {
        return Err(Error::new(ErrorKind::InvalidInput, "invalid user name"));
    }

    // now we have validated the user name, let's add that too.
    cmd_args.push_str(" --user ");
    cmd_args.push_str(user_name);

    // call cmd.exe and return the output
    Command::new("cmd.exe")
        .arg("/c")
        // surround the entire command in an extra pair of quotes, as required by cmd.exe.
        .raw_arg(&format!("\"{cmd_args}\""))
        .output()
}
```

[Source](../../../../src/std/os/windows/process.rs.html#296)
#### fn [async\_pipes](#tymethod.async_pipes)(&mut self, always\_async: [bool](../../../primitive.bool.html)) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command")

ð¬This is a nightly-only experimental API. (`windows_process_extensions_async_pipes` [#98289](https://github.com/rust-lang/rust/issues/98289))

When [`process::Command`](../../../process/struct.Command.html "struct std::process::Command") creates pipes, request that our side is always async.

By default [`process::Command`](../../../process/struct.Command.html "struct std::process::Command") may choose to use pipes where both ends
are opened for synchronous read or write operations. By using
`async_pipes(true)`, this behavior is overridden so that our side is
always async.

This is important because if doing async I/O a pipe or a file has to be
opened for async access.

The end of the pipe sent to the child process will always be synchronous
regardless of this option.

##### [Â§](#example-1)Example

```
#![feature(windows_process_extensions_async_pipes)]
use std::os::windows::process::CommandExt;
use std::process::{Command, Stdio};

Command::new(program)
    .async_pipes(true)
    .stdin(Stdio::piped())
    .stdout(Stdio::piped())
    .stderr(Stdio::piped());
```

[Source](../../../../src/std/os/windows/process.rs.html#366-370)
#### unsafe fn [raw\_attribute](#tymethod.raw_attribute)<T: [Copy](../../../marker/trait.Copy.html "trait std::marker::Copy") + [Send](../../../marker/trait.Send.html "trait std::marker::Send") + [Sync](../../../marker/trait.Sync.html "trait std::marker::Sync") + 'static>( &mut self, attribute: [usize](../../../primitive.usize.html), value: T, ) -> &mut [Command](../../../process/struct.Command.html "struct std::process::Command")

ð¬This is a nightly-only experimental API. (`windows_process_extensions_raw_attribute` [#114854](https://github.com/rust-lang/rust/issues/114854))

Set a raw attribute on the command, providing extended configuration options for Windows
processes.

This method allows you to specify custom attributes for a child process on Windows systems
using raw attribute values. Raw attributes provide extended configurability for process
creation, but their usage can be complex and potentially unsafe.

The `attribute` parameter specifies the raw attribute to be set, while the `value`
parameter holds the value associated with that attribute. Please refer to the
[`windows-rs` documentation](https://microsoft.github.io/windows-docs-rs/doc/windows/) or the [Win32 API documentation](https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) for detailed information
about available attributes and their meanings.

##### [Â§](#note)Note

The maximum number of raw attributes is the value of [`u32::MAX`](../../../primitive.u32.html#associatedconstant.MAX "associated constant u32::MAX").
If this limit is exceeded, the call to [`process::Command::spawn`](../../../process/struct.Command.html#method.spawn "method std::process::Command::spawn") will return an `Error`
indicating that the maximum number of attributes has been exceeded.

##### [Â§](#safety)Safety

The usage of raw attributes is potentially unsafe and should be done with caution.
Incorrect attribute values or improper configuration can lead to unexpected behavior or
errors.

##### [Â§](#example-2)Example

The following example demonstrates how to create a child process with a specific parent
process ID using a raw attribute.

```
#![feature(windows_process_extensions_raw_attribute)]
use std::os::windows::{process::CommandExt, io::AsRawHandle};
use std::process::Command;

let parent = Command::new("cmd").spawn()?;

let mut child_cmd = Command::new("cmd");

const PROC_THREAD_ATTRIBUTE_PARENT_PROCESS: usize = 0x00020000;

unsafe {
    child_cmd.raw_attribute(PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, parent.as_raw_handle() as isize);
}

let mut child = child_cmd.spawn()?;

```
##### [Â§](#safety-note)Safety Note

Remember that improper use of raw attributes can lead to undefined behavior or security
vulnerabilities. Always consult the documentation and ensure proper attribute values are
used.

## Dyn Compatibility[Â§](#dyn-compatibility)

This trait is **not** [dyn compatible](https://doc.rust-lang.org/1.84.0/reference/items/traits.html#object-safety).

*In older versions of Rust, dyn compatibility was called "object safety", so this trait is not object safe.*

## Implementors[Â§](#implementors)

1.16.0 Â· [Source](../../../../src/std/os/windows/process.rs.html#374-412)[Â§](#impl-CommandExt-for-Command)
### impl [CommandExt](trait.CommandExt.html "trait std::os::windows::process::CommandExt") for [Command](../../../process/struct.Command.html "struct std::process::Command")

