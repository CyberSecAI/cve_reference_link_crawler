```
{
  "vulnerability": {
    "root_cause": "The `tipc_mon_rcv` function in the Linux kernel's TIPC module does not validate that the `member_cnt` field in a received `tipc_mon_domain` structure is below `MAX_MON_DOMAIN` before allocating memory. This allows an attacker to send a crafted packet with a large `member_cnt` value, leading to a stack overflow when a later, valid domain record is processed via memcpy.",
    "weaknesses": [
      "Improper bounds check",
      "Stack-based buffer overflow"
    ],
    "impact": "A remote attacker can cause a denial of service (kernel panic) by triggering a stack overflow. Without stack canaries or with a canary leak, this can lead to arbitrary code execution.",
    "attack_vectors": "A malicious actor can send a crafted `STATE_MSG` with a `tipc_mon_domain` that has a `member_cnt` larger than `MAX_MON_DOMAIN`. This crafted message can be sent remotely or locally if the system uses the TIPC protocol. If the TIPC module is loaded, the vulnerability can be triggered.",
    "required_capabilities": "The attacker needs the ability to send network packets as if it's a TIPC peer node, establishing a connection with the target system that is running a vulnerable kernel with the TIPC module loaded. The attacker must have the ability to manipulate the content of the messages sent, setting up an initial malicious message and then a trigger message."
  },
  "additional_details": {
    "affected_versions": "Linux kernel versions 4.8 and later prior to the fix (commit 9aa422ad3266)",
    "mitigations": "Disabling the TIPC module if not needed or updating to a patched kernel. If TIPC is required, network configurations should be reviewed to prevent unauthorized nodes from interacting with the cluster. It is also noted that with `CONFIG_FORTIFY_SRC=y` set there is a hard mitigation which will cause a kernel panic.",
        "additional_references": [
          "https://www.openwall.com/lists/oss-security/2022/02/10/1",
           "https://www.sentinelone.com/labs/tipc-remote-linux-kernel-heap-overflow-allows-arbitrary-code-execution/",
           "https://haxx.in/posts/pwning-tipc/",
            "https://git.centos.org/rpms/kernel/c/7ae59b72bcca86907a4a14fadbea4d30dfeef357?branch=c8s",
           "https://access.redhat.com/errata/RHSA-2022:0771",
            "https://access.redhat.com/errata/RHSA-2022:0772",
            "https://access.redhat.com/errata/RHSA-2022:0777",
           "https://access.redhat.com/errata/RHSA-2022:0819",
           "https://access.redhat.com/errata/RHSA-2022:0825",
            "https://access.redhat.com/errata/RHSA-2022:0841",
            "https://access.redhat.com/errata/RHSA-2022:0849",
          "https://access.redhat.com/errata/RHSA-2022:1186",
           "https://access.redhat.com/errata/RHSA-2022:1209",
          "https://access.redhat.com/errata/RHSA-2022:1213",
            "https://access.redhat.com/errata/RHSA-2022:1589",
            "https://access.redhat.com/errata/RHSA-2022:1619",
            "https://security.netapp.com/advisory/ntap-20220602-0001",
           "https://bugzilla.redhat.com/show_bug.cgi?id=2048738"
       ]
  }
}
```