=== Content from www.wordfence.com_b56187f8_20250111_001815.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Contact Form Plugin by Fluent Forms for Quiz, Survey, and Drag & Drop WP Form Builder <= 5.1.18 - Missing Authorization to Authenticated (Subscriber+) Mailchimp Integration Modification

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Contact Form Plugin by Fluent Forms for Quiz, Survey, and Drag & Drop WP Form Builder <= 5.1.18 - Missing Authorization to Authenticated (Subscriber+) Mailchimp Integration Modification

4.2

**Improper Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)

| CVE | [CVE-2024-5053](https://www.cve.org/CVERecord?id=CVE-2024-5053) |
| --- | --- |
| CVSS | 4.2 (Medium) |
| Publicly Published | August 31, 2024 |
| Last Updated | September 1, 2024 |
| Researcher | [Tobias Weißhaar (kun\_19)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/tobias-weisshaar-kun-19) |

### Description

The Contact Form Plugin by Fluent Forms for Quiz, Survey, and Drag & Drop WP Form Builder plugin for WordPress is vulnerable to unauthorized Malichimp API key update due to an insufficient capability check on the verifyRequest function in all versions up to, and including, 5.1.18. This makes it possible for Form Managers with a Subscriber-level access and above to modify the Mailchimp API key used for integration. At the same time, missing Mailchimp API key validation allows the redirect of the integration requests to the attacker-controlled server.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/fluentform/trunk/app/Http/Routes/api.php#L91)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/fluentform/trunk/app/Http/Policies/FormPolicy.php#L17)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/fluentform/trunk/app/Services/Integrations/MailChimp/MailChimp.php#L40)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffluentform%2Fcontact-form-plugin-by-fluent-forms-for-quiz-survey-and-drag-drop-wp-form-builder-5118-subscriber-improper-authorization-leading-to-unauthorized-mailchimp-integration-modification&t=Contact%20Form%20Plugin%20by%20Fluent%20Forms%20for%20Quiz%2C%20Survey%2C%20and%20Drag%20%26%20Drop%20WP%20Form%20Builder%20%3C%3D%205.1.18%20-%20%20Missing%20Authorization%20to%20Authenticated%20%28Subscriber%2B%29%20Mailchimp%20Integration%20Modification "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffluentform%2Fcontact-form-plugin-by-fluent-forms-for-quiz-survey-and-drag-drop-wp-form-builder-5118-subscriber-improper-authorization-leading-to-unauthorized-mailchimp-integration-modification&text=Contact%20Form%20Plugin%20by%20Fluent%20Forms%20for%20Quiz%2C%20Survey%2C%20and%20Drag%20%26%20Drop%20WP%20Form%20Builder%20%3C%3D%205.1.18%20-%20%20Missing%20Authorization%20to%20Authenticated%20%28Subscriber%2B%29%20Mailchimp%20Integration%20Modification "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Ffluentform%2Fcontact-form-plugin-by-fluent-forms-for-quiz-survey-and-drag-drop-wp-form-builder-5118-subscriber-improper-authorization-leading-to-unauthorized-mailchimp-integration-modification "LinkedIn")
Email

## Vulnerability Details for Fluent Forms – Customizable Contact Forms, Survey, Quiz, & Conversational Form Builder

#### [Fluent Forms – Customizable Contact Forms, Survey, Quiz, & Conversational Form Builder](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/fluentform)

| Software Type | Plugin |
| --- | --- |
| Software Slug | fluentform [(view on wordpress.org)](https://wordpress.org/plugins/fluentform) |
| Patched? | Yes |
| Remediation | Update to version 5.1.19, or a newer patched version |
| Affected Version | * <= 5.1.18 |
| Patched Version | * 5.1.19 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_ec2a6f33_20250111_001814.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Ffluentform%2Ftrunk%2Fapp%2FServices%2FIntegrations%2FMailChimp%2FMailChimp.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/fluentform/trunk/app/Services/Integrations/MailChimp/MailChimp.php?rev=2679134 "Revision 2679134")
* Next Revision →
* [Blame](/browser/fluentform/trunk/app/Services/Integrations/MailChimp/MailChimp.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/fluentform/trunk/app/Services/Integrations/MailChimp/MailChimp.php)

---

# [source:](/browser?order=name "Go to repository root") [fluentform](/browser/fluentform?order=name "View fluentform")/[trunk](/browser/fluentform/trunk?order=name "View trunk")/[app](/browser/fluentform/trunk/app?order=name "View app")/[Services](/browser/fluentform/trunk/app/Services?order=name "View Services")/[Integrations](/browser/fluentform/trunk/app/Services/Integrations?order=name "View Integrations")/[MailChimp](/browser/fluentform/trunk/app/Services/Integrations/MailChimp?order=name "View MailChimp")/[MailChimp.php](/browser/fluentform/trunk/app/Services/Integrations/MailChimp/MailChimp.php?order=name "View MailChimp.php")

View diff against:

View revision:

| [Last change](/changeset/2799597/fluentform/trunk/app/Services/Integrations/MailChimp/MailChimp.php "View differences") on this file was [2799597](/changeset/2799597/ "View changeset 2799597"), checked in by adreastrian, [2 years ago](/timeline?from=2022-10-16T13%3A42%3A18Z&precision=second "See timeline at 10/16/2022 01:42:18 PM") |
| --- |
| releasing v4.3.16 |
| **File size:** 14.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | namespace FluentForm\App\Services\Integrations\MailChimp; |
| [4](#L4) |  |
| [5](#L5) | /\*\* |
| [6](#L6) | \* Super-simple, minimum abstraction MailChimp API v3 wrapper |
| [7](#L7) | \* MailChimp API v3: http://developer.mailchimp.com |
| [8](#L8) | \* This wrapper: https://github.com/drewm/mailchimp-api |
| [9](#L9) | \* |
| [10](#L10) | \* @author Drew McLellan <drew.mclellan@gmail.com> |
| [11](#L11) | \* |
| [12](#L12) | \* @version 2.4 |
| [13](#L13) | \*/ |
| [14](#L14) | class MailChimp |
| [15](#L15) | { |
| [16](#L16) | private $api\_key; |
| [17](#L17) | private $api\_endpoint = 'https://<dc>.api.mailchimp.com/3.0'; |
| [18](#L18) |  |
| [19](#L19) | public const TIMEOUT = 10; |
| [20](#L20) |  |
| [21](#L21) | /\*  SSL Verification |
| [22](#L22) | Read before disabling: |
| [23](#L23) | http://snippets.webaware.com.au/howto/stop-turning-off-curlopt\_ssl\_verifypeer-and-fix-your-php-config/ |
| [24](#L24) | \*/ |
| [25](#L25) | public $verify\_ssl = true; |
| [26](#L26) |  |
| [27](#L27) | private $request\_successful = false; |
| [28](#L28) | private $last\_error = ''; |
| [29](#L29) | private $last\_response = []; |
| [30](#L30) | private $last\_request = []; |
| [31](#L31) |  |
| [32](#L32) | /\*\* |
| [33](#L33) | \* Create a new instance |
| [34](#L34) | \* |
| [35](#L35) | \* @param string $api\_key      Your MailChimp API key |
| [36](#L36) | \* @param string $api\_endpoint Optional custom API endpoint |
| [37](#L37) | \* |
| [38](#L38) | \* @throws \Exception |
| [39](#L39) | \*/ |
| [40](#L40) | public function \_\_construct($api\_key, $api\_endpoint = null) |
| [41](#L41) | { |
| [42](#L42) | $this->api\_key = $api\_key; |
| [43](#L43) |  |
| [44](#L44) | if (null === $api\_endpoint) { |
| [45](#L45) | if (false === strpos($this->api\_key, '-')) { |
| [46](#L46) | throw new \Exception("Invalid Mailchimp API key `{$api\_key}` supplied."); |
| [47](#L47) | } |
| [48](#L48) | list(, $data\_center) = explode('-', $this->api\_key); |
| [49](#L49) | $this->api\_endpoint = str\_replace('<dc>', $data\_center, $this->api\_endpoint); |
| [50](#L50) | } else { |
| [51](#L51) | $this->api\_endpoint = $api\_endpoint; |
| [52](#L52) | } |
| [53](#L53) |  |
| [54](#L54) | $this->last\_response = ['headers' => null, 'body' => null]; |
| [55](#L55) | } |
| [56](#L56) |  |
| [57](#L57) | /\*\* |
| [58](#L58) | \* @return string The url to the API endpoint |
| [59](#L59) | \*/ |
| [60](#L60) | public function getApiEndpoint() |
| [61](#L61) | { |
| [62](#L62) | return $this->api\_endpoint; |
| [63](#L63) | } |
| [64](#L64) |  |
| [65](#L65) | /\*\* |
| [66](#L66) | \* Convert an email address into a 'subscriber hash' for identifying the subscriber in a method URL |
| [67](#L67) | \* |
| [68](#L68) | \* @param string $email The subscriber's email address |
| [69](#L69) | \* |
| [70](#L70) | \* @return string Hashed version of the input |
| [71](#L71) | \*/ |
| [72](#L72) | public function subscriberHash($email) |
| [73](#L73) | { |
| [74](#L74) | return md5(strtolower($email)); |
| [75](#L75) | } |
| [76](#L76) |  |
| [77](#L77) | /\*\* |
| [78](#L78) | \* Was the last request successful? |
| [79](#L79) | \* |
| [80](#L80) | \* @return bool True for success, false for failure |
| [81](#L81) | \*/ |
| [82](#L82) | public function success() |
| [83](#L83) | { |
| [84](#L84) | return $this->request\_successful; |
| [85](#L85) | } |
| [86](#L86) |  |
| [87](#L87) | /\*\* |
| [88](#L88) | \* Get the last error returned by either the network transport, or by the API. |
| [89](#L89) | \* If something didn't work, this should contain the string describing the problem. |
| [90](#L90) | \* |
| [91](#L91) | \* @return string|false describing the error |
| [92](#L92) | \*/ |
| [93](#L93) | public function getLastError() |
| [94](#L94) | { |
| [95](#L95) | return $this->last\_error ?: false; |
| [96](#L96) | } |
| [97](#L97) |  |
| [98](#L98) | /\*\* |
| [99](#L99) | \* Get an array containing the HTTP headers and the body of the API response. |
| [100](#L100) | \* |
| [101](#L101) | \* @return array Assoc array with keys 'headers' and 'body' |
| [102](#L102) | \*/ |
| [103](#L103) | public function getLastResponse() |
| [104](#L104) | { |
| [105](#L105) | return $this->last\_response; |
| [106](#L106) | } |
| [107](#L107) |  |
| [108](#L108) | /\*\* |
| [109](#L109) | \* Get an array containing the HTTP headers and the body of the API request. |
| [110](#L110) | \* |
| [111](#L111) | \* @return array Assoc array |
| [112](#L112) | \*/ |
| [113](#L113) | public function getLastRequest() |
| [114](#L114) | { |
| [115](#L115) | return $this->last\_request; |
| [116](#L116) | } |
| [117](#L117) |  |
| [118](#L118) | /\*\* |
| [119](#L119) | \* Make an HTTP DELETE request - for deleting data |
| [120](#L120) | \* |
| [121](#L121) | \* @param string $method  URL of the API request method |
| [122](#L122) | \* @param array  $args    Assoc array of arguments (if any) |
| [123](#L123) | \* @param int    $timeout Timeout limit for request in seconds |
| [124](#L124) | \* |
| [125](#L125) | \* @return array|false Assoc array of API response, decoded from JSON |
| [126](#L126) | \*/ |
| [127](#L127) | public function delete($method, $args = [], $timeout = self::TIMEOUT) |
| [128](#L128) | { |
| [129](#L129) | return $this->makeRequest('delete', $method, $args, $timeout); |
| [130](#L130) | } |
| [131](#L131) |  |
| [132](#L132) | /\*\* |
| [133](#L133) | \* Make an HTTP GET request - for retrieving data |
| [134](#L134) | \* |
| [135](#L135) | \* @param string $method  URL of the API request method |
| [136](#L136) | \* @param array  $args    Assoc array of arguments (usually your data) |
| [137](#L137) | \* @param int    $timeout Timeout limit for request in seconds |
| [138](#L138) | \* |
| [139](#L139) | \* @return array|false Assoc array of API response, decoded from JSON |
| [140](#L140) | \*/ |
| [141](#L141) | public function get($method, $args = [], $timeout = self::TIMEOUT) |
| [142](#L142) | { |
| [143](#L143) | return $this->makeRequest('get', $method, $args, $timeout); |
| [144](#L144) | } |
| [145](#L145) |  |
| [146](#L146) | /\*\* |
| [147](#L147) | \* Make an HTTP PATCH request - for performing partial updates |
| [148](#L148) | \* |
| [149](#L149) | \* @param string $method  URL of the API request method |
| [150](#L150) | \* @param array  $args    Assoc array of arguments (usually your data) |
| [151](#L151) | \* @param int    $timeout Timeout limit for request in seconds |
| [152](#L152) | \* |
| [153](#L153) | \* @return array|false Assoc array of API response, decoded from JSON |
| [154](#L154) | \*/ |
| [155](#L155) | public function patch($method, $args = [], $timeout = self::TIMEOUT) |
| [156](#L156) | { |
| [157](#L157) | return $this->makeRequest('patch', $method, $args, $timeout); |
| [158](#L158) | } |
| [159](#L159) |  |
| [160](#L160) | /\*\* |
| [161](#L161) | \* Make an HTTP POST request - for creating and updating items |
| [162](#L162) | \* |
| [163](#L163) | \* @param string $method  URL of the API request method |
| [164](#L164) | \* @param array  $args    Assoc array of arguments (usually your data) |
| [165](#L165) | \* @param int    $timeout Timeout limit for request in seconds |
| [166](#L166) | \* |
| [167](#L167) | \* @return array|false Assoc array of API response, decoded from JSON |
| [168](#L168) | \*/ |
| [169](#L169) | public function post($method, $args = [], $timeout = self::TIMEOUT) |
| [170](#L170) | { |
| [171](#L171) | return $this->makeRequest('post', $method, $args, $timeout); |
| [172](#L172) | } |
| [173](#L173) |  |
| [174](#L174) | /\*\* |
| [175](#L175) | \* Make an HTTP PUT request - for creating new items |
| [176](#L176) | \* |
| [177](#L177) | \* @param string $method  URL of the API request method |
| [178](#L178) | \* @param array  $args    Assoc array of arguments (usually your data) |
| [179](#L179) | \* @param int    $timeout Timeout limit for request in seconds |
| [180](#L180) | \* |
| [181](#L181) | \* @return array|false Assoc array of API response, decoded from JSON |
| [182](#L182) | \* |
| [183](#L183) | \* @throws \Exception |
| [184](#L184) | \*/ |
| [185](#L185) | public function put($method, $args = [], $timeout = self::TIMEOUT) |
| [186](#L186) | { |
| [187](#L187) | return $this->makeRequest('put', $method, $args, $timeout); |
| [188](#L188) | } |
| [189](#L189) |  |
| [190](#L190) | /\*\* |
| [191](#L191) | \* Performs the underlying HTTP request. Not very exciting. |
| [192](#L192) | \* |
| [193](#L193) | \* @param string $http\_verb The HTTP verb to use: get, post, put, patch, delete |
| [194](#L194) | \* @param string $method    The API method to be called |
| [195](#L195) | \* @param array  $args      Assoc array of parameters to be passed |
| [196](#L196) | \* @param int    $timeout |
| [197](#L197) | \* |
| [198](#L198) | \* @return array|false Assoc array of decoded result |
| [199](#L199) | \* |
| [200](#L200) | \* @throws \Exception |
| [201](#L201) | \*/ |
| [202](#L202) | private function makeRequest($http\_verb, $method, $args = [], $timeout = self::TIMEOUT) |
| [203](#L203) | { |
| [204](#L204) | if (! function\_exists('curl\_init') || ! function\_exists('curl\_setopt')) { |
| [205](#L205) | throw new \Exception("cURL support is required, but can't be found."); |
| [206](#L206) | } |
| [207](#L207) |  |
| [208](#L208) | $url = $this->api\_endpoint . '/' . $method; |
| [209](#L209) |  |
| [210](#L210) | $response = $this->prepareStateForRequest($http\_verb, $method, $url, $timeout); |
| [211](#L211) |  |
| [212](#L212) | $httpHeader = [ |
| [213](#L213) | 'Accept: application/vnd.api+json', |
| [214](#L214) | 'Content-Type: application/vnd.api+json', |
| [215](#L215) | 'Authorization: apikey ' . $this->api\_key, |
| [216](#L216) | ]; |
| [217](#L217) |  |
| [218](#L218) | if (isset($args['language'])) { |
| [219](#L219) | $httpHeader[] = 'Accept-Language: ' . $args['language']; |
| [220](#L220) | } |
| [221](#L221) |  |
| [222](#L222) | $ch = curl\_init(); |
| [223](#L223) | curl\_setopt($ch, CURLOPT\_URL, $url); |
| [224](#L224) | curl\_setopt($ch, CURLOPT\_HTTPHEADER, $httpHeader); |
| [225](#L225) | curl\_setopt($ch, CURLOPT\_USERAGENT, 'DrewM/MailChimp-API/3.0 (github.com/drewm/mailchimp-api)'); |
| [226](#L226) | curl\_setopt($ch, CURLOPT\_RETURNTRANSFER, true); |
| [227](#L227) | curl\_setopt($ch, CURLOPT\_VERBOSE, true); |
| [228](#L228) | curl\_setopt($ch, CURLOPT\_HEADER, true); |
| [229](#L229) | curl\_setopt($ch, CURLOPT\_TIMEOUT, $timeout); |
| [230](#L230) | curl\_setopt($ch, CURLOPT\_SSL\_VERIFYPEER, $this->verify\_ssl); |
| [231](#L231) | curl\_setopt($ch, CURLOPT\_HTTP\_VERSION, CURL\_HTTP\_VERSION\_1\_0); |
| [232](#L232) | curl\_setopt($ch, CURLOPT\_ENCODING, ''); |
| [233](#L233) | curl\_setopt($ch, CURLINFO\_HEADER\_OUT, true); |
| [234](#L234) |  |
| [235](#L235) | switch ($http\_verb) { |
| [236](#L236) | case 'post': |
| [237](#L237) | curl\_setopt($ch, CURLOPT\_POST, true); |
| [238](#L238) | $this->attachRequestPayload($ch, $args); |
| [239](#L239) | break; |
| [240](#L240) |  |
| [241](#L241) | case 'get': |
| [242](#L242) | $query = http\_build\_query($args, '', '&'); |
| [243](#L243) | curl\_setopt($ch, CURLOPT\_URL, $url . '?' . $query); |
| [244](#L244) | break; |
| [245](#L245) |  |
| [246](#L246) | case 'delete': |
| [247](#L247) | curl\_setopt($ch, CURLOPT\_CUSTOMREQUEST, 'DELETE'); |
| [248](#L248) | break; |
| [249](#L249) |  |
| [250](#L250) | case 'patch': |
| [251](#L251) | curl\_setopt($ch, CURLOPT\_CUSTOMREQUEST, 'PATCH'); |
| [252](#L252) | $this->attachRequestPayload($ch, $args); |
| [253](#L253) | break; |
| [254](#L254) |  |
| [255](#L255) | case 'put': |
| [256](#L256) | curl\_setopt($ch, CURLOPT\_CUSTOMREQUEST, 'PUT'); |
| [257](#L257) | $this->attachRequestPayload($ch, $args); |
| [258](#L258) | break; |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | $responseContent = curl\_exec($ch); |
| [262](#L262) | $response['headers'] = curl\_getinfo($ch); |
| [263](#L263) | $response = $this->setResponseState($response, $responseContent, $ch); |
| [264](#L264) | $formattedResponse = $this->formatResponse($response); |
| [265](#L265) |  |
| [266](#L266) | curl\_close($ch); |
| [267](#L267) |  |
| [268](#L268) | $this->determineSuccess($response, $formattedResponse, $timeout); |
| [269](#L269) |  |
| [270](#L270) | return $formattedResponse; |
| [271](#L271) | } |
| [272](#L272) |  |
| [273](#L273) | /\*\* |
| [274](#L274) | \* @param string  $http\_verb |
| [275](#L275) | \* @param string  $method |
| [276](#L276) | \* @param string  $url |
| [277](#L277) | \* @param integer $timeout |
| [278](#L278) | \*/ |
| [279](#L279) | private function prepareStateForRequest($http\_verb, $method, $url, $timeout) |
| [280](#L280) | { |
| [281](#L281) | $this->last\_error = ''; |
| [282](#L282) |  |
| [283](#L283) | $this->request\_successful = false; |
| [284](#L284) |  |
| [285](#L285) | $this->last\_response = [ |
| [286](#L286) | 'headers'     => null, // array of details from curl\_getinfo() |
| [287](#L287) | 'httpHeaders' => null, // array of HTTP headers |
| [288](#L288) | 'body'        => null, // content of the response |
| [289](#L289) | ]; |
| [290](#L290) |  |
| [291](#L291) | $this->last\_request = [ |
| [292](#L292) | 'method'  => $http\_verb, |
| [293](#L293) | 'path'    => $method, |
| [294](#L294) | 'url'     => $url, |
| [295](#L295) | 'body'    => '', |
| [296](#L296) | 'timeout' => $timeout, |
| [297](#L297) | ]; |
| [298](#L298) |  |
| [299](#L299) | return $this->last\_response; |
| [300](#L300) | } |
| [301](#L301) |  |
| [302](#L302) | /\*\* |
| [303](#L303) | \* Get the HTTP headers as an array of header-name => header-value pairs. |
| [304](#L304) | \* |
| [305](#L305) | \* The "Link" header is parsed into an associative array based on the |
| [306](#L306) | \* rel names it contains. The original value is available under |
| [307](#L307) | \* the "\_raw" key. |
| [308](#L308) | \* |
| [309](#L309) | \* @param string $headersAsString |
| [310](#L310) | \* |
| [311](#L311) | \* @return array |
| [312](#L312) | \*/ |
| [313](#L313) | private function getHeadersAsArray($headersAsString) |
| [314](#L314) | { |
| [315](#L315) | $headers = []; |
| [316](#L316) |  |
| [317](#L317) | foreach (explode("\r\n", $headersAsString) as $i => $line) { |
| [318](#L318) | if (0 === $i) { // HTTP code |
| [319](#L319) | continue; |
| [320](#L320) | } |
| [321](#L321) |  |
| [322](#L322) | $line = trim($line); |
| [323](#L323) | if (empty($line)) { |
| [324](#L324) | continue; |
| [325](#L325) | } |
| [326](#L326) |  |
| [327](#L327) | list($key, $value) = explode(': ', $line); |
| [328](#L328) |  |
| [329](#L329) | if ('Link' == $key) { |
| [330](#L330) | $value = array\_merge( |
| [331](#L331) | ['\_raw' => $value], |
| [332](#L332) | $this->getLinkHeaderAsArray($value) |
| [333](#L333) | ); |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) | $headers[$key] = $value; |
| [337](#L337) | } |
| [338](#L338) |  |
| [339](#L339) | return $headers; |
| [340](#L340) | } |
| [341](#L341) |  |
| [342](#L342) | /\*\* |
| [343](#L343) | \* Extract all rel => URL pairs from the provided Link header value |
| [344](#L344) | \* |
| [345](#L345) | \* Mailchimp only implements the URI reference and relation type from |
| [346](#L346) | \* RFC 5988, so the value of the header is something like this: |
| [347](#L347) | \* |
| [348](#L348) | \* 'https://us13.api.mailchimp.com/schema/3.0/Lists/Instance.json; rel="describedBy", <https://us13.admin.mailchimp.com/lists/members/?id=XXXX>; rel="dashboard"' |
| [349](#L349) | \* |
| [350](#L350) | \* @param string $linkHeaderAsString |
| [351](#L351) | \* |
| [352](#L352) | \* @return array |
| [353](#L353) | \*/ |
| [354](#L354) | private function getLinkHeaderAsArray($linkHeaderAsString) |
| [355](#L355) | { |
| [356](#L356) | $urls = []; |
| [357](#L357) |  |
| [358](#L358) | if (preg\_match\_all('/<(.\*?)>\s\*;\s\*rel="(.\*?)"\s\*/', $linkHeaderAsString, $matches)) { |
| [359](#L359) | foreach ($matches[2] as $i => $relName) { |
| [360](#L360) | $urls[$relName] = $matches[1][$i]; |
| [361](#L361) | } |
| [362](#L362) | } |
| [363](#L363) |  |
| [364](#L364) | return $urls; |
| [365](#L365) | } |
| [366](#L366) |  |
| [367](#L367) | /\*\* |
| [368](#L368) | \* Encode the data and attach it to the request |
| [369](#L369) | \* |
| [370](#L370) | \* @param resource $ch   cURL session handle, used by reference |
| [371](#L371) | \* @param array    $data Assoc array of data to attach |
| [372](#L372) | \*/ |
| [373](#L373) | private function attachRequestPayload(&$ch, $data) |
| [374](#L374) | { |
| [375](#L375) | $encoded = json\_encode($data); |
| [376](#L376) | $this->last\_request['body'] = $encoded; |
| [377](#L377) | curl\_setopt($ch, CURLOPT\_POSTFIELDS, $encoded); |
| [378](#L378) | } |
| [379](#L379) |  |
| [380](#L380) | /\*\* |
| [381](#L381) | \* Decode the response and format any error messages for debugging |
| [382](#L382) | \* |
| [383](#L383) | \* @param array $response The response from the curl request |
| [384](#L384) | \* |
| [385](#L385) | \* @return array|false The JSON decoded into an array |
| [386](#L386) | \*/ |
| [387](#L387) | private function formatResponse($response) |
| [388](#L388) | { |
| [389](#L389) | $this->last\_response = $response; |
| [390](#L390) |  |
| [391](#L391) | if (! empty($response['body'])) { |
| [392](#L392) | return json\_decode($response['body'], true); |
| [393](#L393) | } |
| [394](#L394) |  |
| [395](#L395) | return false; |
| [396](#L396) | } |
| [397](#L397) |  |
| [398](#L398) | /\*\* |
| [399](#L399) | \* Do post-request formatting and setting state from the response |
| [400](#L400) | \* |
| [401](#L401) | \* @param array  $response        The response from the curl request |
| [402](#L402) | \* @param string $responseContent The body of the response from the curl request |
| [403](#L403) | \* |
| [404](#L404) | \* \* @return array    The modified response |
| [405](#L405) | \*/ |
| [406](#L406) | private function setResponseState($response, $responseContent, $ch) |
| [407](#L407) | { |
| [408](#L408) | if (false === $responseContent) { |
| [409](#L409) | $this->last\_error = curl\_error($ch); |
| [410](#L410) | } else { |
| [411](#L411) | $headerSize = $response['headers']['header\_size']; |
| [412](#L412) |  |
| [413](#L413) | $response['httpHeaders'] = $this->getHeadersAsArray(substr($responseContent, 0, $headerSize)); |
| [414](#L414) | $response['body'] = substr($responseContent, $headerSize); |
| [415](#L415) |  |
| [416](#L416) | if (isset($response['headers']['request\_header'])) { |
| [417](#L417) | $this->last\_request['headers'] = $response['headers']['request\_header']; |
| [418](#L418) | } |
| [419](#L419) | } |
| [420](#L420) |  |
| [421](#L421) | return $response; |
| [422](#L422) | } |
| [423](#L423) |  |
| [424](#L424) | /\*\* |
| [425](#L425) | \* Check if the response was successful or a failure. If it failed, store the error. |
| [426](#L426) | \* |
| [427](#L427) | \* @param array       $response          The response from the curl request |
| [428](#L428) | \* @param array|false $formattedResponse The response body payload from the curl request |
| [429](#L429) | \* @param int         $timeout           The timeout supplied to the curl request. |
| [430](#L430) | \* |
| [431](#L431) | \* @return bool If the request was successful |
| [432](#L432) | \*/ |
| [433](#L433) | private function determineSuccess($response, $formattedResponse, $timeout) |
| [434](#L434) | { |
| [435](#L435) | $status = $this->findHTTPStatus($response, $formattedResponse); |
| [436](#L436) |  |
| [437](#L437) | if ($status >= 200 && $status <= 299) { |
| [438](#L438) | $this->request\_successful = true; |
| [439](#L439) | return true; |
| [440](#L440) | } |
| [441](#L441) |  |
| [442](#L442) | if (isset($formattedResponse['detail'])) { |
| [443](#L443) | $this->last\_error = sprintf('%d: %s', $formattedResponse['status'], $formattedResponse['detail']); |
| [444](#L444) | return false; |
| [445](#L445) | } |
| [446](#L446) |  |
| [447](#L447) | if ($timeout > 0 && $response['headers'] && $response['headers']['total\_time'] >= $timeout) { |
| [448](#L448) | $this->last\_error = sprintf('Request timed out after %f seconds.', $response['headers']['total\_time']); |
| [449](#L449) | return false; |
| [450](#L450) | } |
| [451](#L451) |  |
| [452](#L452) | $this->last\_error = 'Unknown error, call getLastResponse() to find out what happened.'; |
| [453](#L453) | return false; |
| [454](#L454) | } |
| [455](#L455) |  |
| [456](#L456) | /\*\* |
| [457](#L457) | \* Find the HTTP status code from the headers or API response body |
| [458](#L458) | \* |
| [459](#L459) | \* @param array       $response          The response from the curl request |
| [460](#L460) | \* @param array|false $formattedResponse The response body payload from the curl request |
| [461](#L461) | \* |
| [462](#L462) | \* @return int HTTP status code |
| [463](#L463) | \*/ |
| [464](#L464) | private function findHTTPStatus($response, $formattedResponse) |
| [465](#L465) | { |
| [466](#L466) | if (! empty($response['headers']) && isset($response['headers']['http\_code'])) { |
| [467](#L467) | return (int) $response['headers']['http\_code']; |
| [468](#L468) | } |
| [469](#L469) |  |
| [470](#L470) | if (! empty($response['body']) && isset($formattedResponse['status'])) { |
| [471](#L471) | return (int) $formattedResponse['status']; |
| [472](#L472) | } |
| [473](#L473) |  |
| [474](#L474) | return 418; |
| [475](#L475) | } |
| [476](#L476) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/fluentform/trunk/app/Services/Integrations/MailChimp/MailChimp.php?format=txt)
* [Original Format](/export/3220494/fluentform/trunk/app/Services/Integrations/MailChimp/MailChimp.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_23073293_20250111_001758.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Ffluentform%2Ftrunk%2Fapp%2FHttp%2FRoutes%2Fapi.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/fluentform/trunk/app/Http/Routes/api.php?rev=3159848 "Revision 3159848")
* Next Revision →
* [Blame](/browser/fluentform/trunk/app/Http/Routes/api.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/fluentform/trunk/app/Http/Routes/api.php)

---

# [source:](/browser?order=name "Go to repository root") [fluentform](/browser/fluentform?order=name "View fluentform")/[trunk](/browser/fluentform/trunk?order=name "View trunk")/[app](/browser/fluentform/trunk/app?order=name "View app")/[Http](/browser/fluentform/trunk/app/Http?order=name "View Http")/[Routes](/browser/fluentform/trunk/app/Http/Routes?order=name "View Routes")/[api.php](/browser/fluentform/trunk/app/Http/Routes/api.php?order=name "View api.php")

View diff against:

View revision:

| [Last change](/changeset/3191791/fluentform/trunk/app/Http/Routes/api.php "View differences") on this file was [3191791](/changeset/3191791/ "View changeset 3191791"), checked in by pyrobd, [8 weeks ago](/timeline?from=2024-11-19T05%3A09%3A39Z&precision=second "See timeline at 11/19/2024 05:09:39 AM") |
| --- |
| Release version 5.2.5 |
| **File size:** 6.0 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* @var $router \FluentForm\Framework\Http\Router |
| [5](#L5) | \*/ |
| [6](#L6) |  |
| [7](#L7) | /\* |
| [8](#L8) | \* Forms resource |
| [9](#L9) | \*/ |
| [10](#L10) | $router->prefix('forms')->withPolicy('FormPolicy')->group(function ($router) { |
| [11](#L11) | $router->get('/', 'FormController@index'); |
| [12](#L12) | $router->post('/', 'FormController@store'); |
| [13](#L13) | $router->get('templates', 'FormController@templates'); |
| [14](#L14) | $router->get('ping', 'FormController@ping'); |
| [15](#L15) |  |
| [16](#L16) | $router->prefix('{form\_id}')->group(function ($router) { |
| [17](#L17) | $router->get('/', 'FormController@find'); |
| [18](#L18) | $router->post('/', 'FormController@update'); |
| [19](#L19) | $router->delete('/', 'FormController@delete'); |
| [20](#L20) | $router->post('duplicate', 'FormController@duplicate'); |
| [21](#L21) | $router->post('convert', 'FormController@convert'); |
| [22](#L22) | $router->get('resources', 'FormController@resources'); |
| [23](#L23) | $router->get('pages', 'FormController@pages'); |
| [24](#L24) | $router->get('fields', 'FormController@fields'); |
| [25](#L25) | $router->get('shortcodes', 'FormController@shortcodes'); |
| [26](#L26) | $router->get('findShortCodePage', 'FormController@findShortCodePage'); |
| [27](#L27) | $router->get('editHistory', 'FormController@formEditHistory'); |
| [28](#L28) | $router->post('clearHistory', 'FormController@clearEditHistory'); |
| [29](#L29) | }); |
| [30](#L30) | }); |
| [31](#L31) |  |
| [32](#L32) | /\* |
| [33](#L33) | \* Form Settings |
| [34](#L34) | \*/ |
| [35](#L35) | $router->prefix('settings')->withPolicy('FormPolicy')->group(function ($router) { |
| [36](#L36) | $router->prefix('{form\_id}')->group(function ($router) { |
| [37](#L37) | $router->get('/', 'FormSettingsController@index'); |
| [38](#L38) | $router->post('/', 'FormSettingsController@store'); |
| [39](#L39) | $router->delete('/', 'FormSettingsController@remove'); |
| [40](#L40) |  |
| [41](#L41) | $router->get('general', 'FormSettingsController@general'); |
| [42](#L42) | $router->post('general', 'FormSettingsController@saveGeneral'); |
| [43](#L43) |  |
| [44](#L44) | $router->get('customizer', 'FormSettingsController@customizer'); |
| [45](#L45) | $router->post('customizer', 'FormSettingsController@storeCustomizer'); |
| [46](#L46) |  |
| [47](#L47) | $router->post('entry-columns', 'FormSettingsController@storeEntryColumns'); |
| [48](#L48) |  |
| [49](#L49) | $router->get('conversational-design', 'FormSettingsController@conversationalDesign'); |
| [50](#L50) | $router->post('store-conversational-design', 'FormSettingsController@storeConversationalDesign'); |
| [51](#L51) | $router->get('preset', 'FormSettingsController@getPreset'); |
| [52](#L52) | $router->post('save-preset', 'FormSettingsController@savePreset'); |
| [53](#L53) | }); |
| [54](#L54) | }); |
| [55](#L55) | /\* |
| [56](#L56) | \* Form Submissions |
| [57](#L57) | \*/ |
| [58](#L58) | $router->prefix('submissions')->withPolicy('SubmissionPolicy')->group(function ($router) { |
| [59](#L59) | $router->get('/', 'SubmissionController@index'); |
| [60](#L60) | $router->get('resources', 'SubmissionController@resources'); |
| [61](#L61) | $router->post('bulk-actions', 'SubmissionController@handleBulkActions'); |
| [62](#L62) | $router->get('print', 'SubmissionController@print'); |
| [63](#L63) | $router->get('all', 'SubmissionController@all'); |
| [64](#L64) | $router->delete('/{entry\_id}', 'SubmissionController@remove'); |
| [65](#L65) |  |
| [66](#L66) | $router->prefix('{entry\_id}')->group(function ($router) { |
| [67](#L67) | $router->get('/', 'SubmissionController@find'); |
| [68](#L68) |  |
| [69](#L69) | $router->post('status', 'SubmissionController@updateStatus'); |
| [70](#L70) | $router->post('is-favorite', 'SubmissionController@toggleIsFavorite'); |
| [71](#L71) |  |
| [72](#L72) | $router->get('logs', 'SubmissionLogController@get'); |
| [73](#L73) | $router->delete('logs', 'SubmissionLogController@remove'); |
| [74](#L74) |  |
| [75](#L75) | $router->get('notes', 'SubmissionNoteController@get'); |
| [76](#L76) | $router->post('notes', 'SubmissionNoteController@store'); |
| [77](#L77) |  |
| [78](#L78) | $router->get('submission-users','SubmissionController@submissionUsers'); |
| [79](#L79) | $router->post('update-submission-user','SubmissionController@updateSubmissionUser'); |
| [80](#L80) | }); |
| [81](#L81) | }); |
| [82](#L82) |  |
| [83](#L83) | /\* |
| [84](#L84) | \* Logs |
| [85](#L85) | \*/ |
| [86](#L86) | $router->prefix('logs')->withPolicy('SubmissionPolicy')->group(function ($router) { |
| [87](#L87) | $router->get('/', 'LogController@get'); |
| [88](#L88) | $router->delete('/', 'LogController@remove'); |
| [89](#L89) | $router->get('/filters', 'LogController@getFilters'); |
| [90](#L90) | }); |
| [91](#L91) | /\* |
| [92](#L92) | \* Global Integrations |
| [93](#L93) | \*/ |
| [94](#L94) | $router->prefix('integrations')->withPolicy('FormPolicy')->group(function ($router) { |
| [95](#L95) | $router->get('/', 'GlobalIntegrationController@index'); |
| [96](#L96) | $router->post('/', 'GlobalIntegrationController@updateIntegration'); |
| [97](#L97) | $router->post('update-status', 'GlobalIntegrationController@updateModuleStatus'); |
| [98](#L98) |  |
| [99](#L99) | /\* |
| [100](#L100) | \* Form Integrations |
| [101](#L101) | \*/ |
| [102](#L102) | $router->prefix('{form\_id}')->group(function ($router) { |
| [103](#L103) | $router->get('/form-integrations', 'FormIntegrationController@index'); |
| [104](#L104) | $router->get('/', 'FormIntegrationController@find'); |
| [105](#L105) | $router->post('/', 'FormIntegrationController@update'); |
| [106](#L106) | $router->delete('/', 'FormIntegrationController@delete'); |
| [107](#L107) |  |
| [108](#L108) | $router->get('/integration-list-id', 'FormIntegrationController@integrationListComponent'); |
| [109](#L109) | }); |
| [110](#L110) | }); |
| [111](#L111) | /\* |
| [112](#L112) | \* Global Settings |
| [113](#L113) | \*/ |
| [114](#L114) | $router->prefix('global-settings')->withPolicy('GlobalSettingsPolicy')->group(function ($router) { |
| [115](#L115) | $router->get('/', 'GlobalSettingsController@index'); |
| [116](#L116) | $router->post('/', 'GlobalSettingsController@store'); |
| [117](#L117) | }); |
| [118](#L118) | /\* |
| [119](#L119) | \* Permission Roles |
| [120](#L120) | \*/ |
| [121](#L121) | $router->prefix('roles')->withPolicy('RoleManagerPolicy')->group(function ($router) { |
| [122](#L122) | $router->get('/', 'RolesController@index'); |
| [123](#L123) | $router->post('/', 'RolesController@addCapability'); |
| [124](#L124) | }); |
| [125](#L125) | /\* |
| [126](#L126) | \* Permission Managers |
| [127](#L127) | \*/ |
| [128](#L128) | $router->prefix('managers')->withPolicy('RoleManagerPolicy')->group(function ($router) { |
| [129](#L129) | $router->get('/', 'ManagersController@index'); |
| [130](#L130) | $router->post('/', 'ManagersController@addManager'); |
| [131](#L131) | $router->delete('/', 'ManagersController@removeManager'); |
| [132](#L132) | }); |
| [133](#L133) | /\* |
| [134](#L134) | \* Form Analytics |
| [135](#L135) | \*/ |
| [136](#L136) | $router->prefix('analytics')->withPolicy('FormPolicy')->group(function ($router) { |
| [137](#L137) | $router->post('/{form\_id}/reset', 'AnalyticsController@reset'); |
| [138](#L138) | }); |
| [139](#L139) |  |
| [140](#L140) | /\* |
| [141](#L141) | \* Form Submission Handler |
| [142](#L142) | \*/ |
| [143](#L143) | $router->post('form-submit', 'SubmissionHandlerController@submit')->withPolicy('SubmissionPolicy'); |
| [144](#L144) | /\* |
| [145](#L145) | \* Form Report |
| [146](#L146) | \*/ |
| [147](#L147) | $router->prefix('report')->withPolicy('ReportPolicy')->group(function ($router) { |
| [148](#L148) | $router->post('/submissions', 'ReportController@submissions'); |
| [149](#L149) | $router->get('/forms/{form\_id}', 'ReportController@form'); |
| [150](#L150) | }); |
| [151](#L151) | /\* |
| [152](#L152) | \* Review Query |
| [153](#L153) | \*/ |
| [154](#L154) | $router->post('notice', 'AdminNoticeController@noticeActions')->withPolicy('FormPolicy'); |
| [155](#L155) |  |
| [156](#L156) | /\* |
| [157](#L157) | \* Global Query |
| [158](#L158) | \*/ |
| [159](#L159) | $router->get('global-search', 'GlobalSearchController@index')->withPolicy('FormPolicy'); |
| [160](#L160) |  |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/fluentform/trunk/app/Http/Routes/api.php?format=txt)
* [Original Format](/export/3220494/fluentform/trunk/app/Http/Routes/api.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_167ad643_20250111_001756.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Ffluentform%2Ftrunk%2Fapp%2FHttp%2FPolicies%2FFormPolicy.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/fluentform/trunk/app/Http/Policies/FormPolicy.php?rev=3103032 "Revision 3103032")
* Next Revision →
* [Blame](/browser/fluentform/trunk/app/Http/Policies/FormPolicy.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/fluentform/trunk/app/Http/Policies/FormPolicy.php)

---

# [source:](/browser?order=name "Go to repository root") [fluentform](/browser/fluentform?order=name "View fluentform")/[trunk](/browser/fluentform/trunk?order=name "View trunk")/[app](/browser/fluentform/trunk/app?order=name "View app")/[Http](/browser/fluentform/trunk/app/Http?order=name "View Http")/[Policies](/browser/fluentform/trunk/app/Http/Policies?order=name "View Policies")/[FormPolicy.php](/browser/fluentform/trunk/app/Http/Policies/FormPolicy.php?order=name "View FormPolicy.php")

View diff against:

View revision:

| [Last change](/changeset/3159848/fluentform/trunk/app/Http/Policies/FormPolicy.php "View differences") on this file was [3159848](/changeset/3159848/ "View changeset 3159848"), checked in by pyrobd, [3 months ago](/timeline?from=2024-09-30T12%3A28%3A25Z&precision=second "See timeline at 09/30/2024 12:28:25 PM") |
| --- |
| Released 5.2.3 free & Pro |
| **File size:** 1.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | namespace FluentForm\App\Http\Policies; |
| [4](#L4) |  |
| [5](#L5) | use FluentForm\App\Modules\Acl\Acl; |
| [6](#L6) | use FluentForm\Framework\Request\Request; |
| [7](#L7) | use FluentForm\Framework\Foundation\Policy; |
| [8](#L8) |  |
| [9](#L9) | class FormPolicy extends Policy |
| [10](#L10) | { |
| [11](#L11) | /\*\* |
| [12](#L12) | \* Check permission for any method |
| [13](#L13) | \* |
| [14](#L14) | \* @param  \FluentForm\Framework\Request\Request $request |
| [15](#L15) | \* @return bool |
| [16](#L16) | \*/ |
| [17](#L17) | public function verifyRequest(Request $request) |
| [18](#L18) | { |
| [19](#L19) | return Acl::hasPermission('fluentform\_forms\_manager', $request->get('form\_id')); |
| [20](#L20) | } |
| [21](#L21) |  |
| [22](#L22) | public function index(Request $request) |
| [23](#L23) | { |
| [24](#L24) | return Acl::hasPermission('fluentform\_dashboard\_access', $request->get('form\_id')); |
| [25](#L25) | } |
| [26](#L26) |  |
| [27](#L27) | public function templates(Request $request) |
| [28](#L28) | { |
| [29](#L29) | return Acl::hasAnyFormPermission($request->get('form\_id')); |
| [30](#L30) | } |
| [31](#L31) |  |
| [32](#L32) | public function updateModuleStatus(Request $request) |
| [33](#L33) | { |
| [34](#L34) | return Acl::hasPermission('fluentform\_settings\_manager', $request->get('form\_id')); |
| [35](#L35) | } |
| [36](#L36) | public function updateIntegration(Request $request) |
| [37](#L37) | { |
| [38](#L38) | return Acl::hasPermission('fluentform\_settings\_manager', $request->get('form\_id')); |
| [39](#L39) | } |
| [40](#L40) |  |
| [41](#L41) | public function ping() |
| [42](#L42) | { |
| [43](#L43) | return Acl::hasAnyFormPermission(); |
| [44](#L44) | } |
| [45](#L45) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/fluentform/trunk/app/Http/Policies/FormPolicy.php?format=txt)
* [Original Format](/export/3220494/fluentform/trunk/app/Http/Policies/FormPolicy.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


