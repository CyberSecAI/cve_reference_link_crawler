
[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Libtirpc: Denial of Service — GLSA **202210-33**

A vulnerability has been discovered in Libtirpc which could result in denial of service.

### Affected packages

| Package | **net-libs/libtirpc** on all architectures |
| --- | --- |
| Affected versions | < **1.3.2** |
| Unaffected versions | >= **1.3.2** |

### Background

Libtirpc is a port of Sun's Transport-Independent RPC library to Linux.

### Description

Currently svc\_run does not handle poll timeout and rendezvous\_request
does not handle EMFILE error returned from accept(2 as it used to.
These two missing functionality were removed by commit b2c9430f46c4.
The effect of not handling poll timeout allows idle TCP conections
to remain ESTABLISHED indefinitely. When the number of connections
reaches the limit of the open file descriptors (ulimit -n) then
accept(2) fails with EMFILE. Since there is no handling of EMFILE
error this causes svc\_run() to get in a tight loop calling accept(2).
This resulting in the RPC service of svc\_run is being down, it's
no longer able to service any requests.
Due to a lack of handling of certain error cases, connections to Libtirpc could remain ESTABLISHED indefinitely.

### Impact

Denial of service can be achieved via establishing enough connections to Libtirpc to reach the limit of open file descriptors for the process.

### Workaround

There is no known workaround at this time.

### Resolution

All Libtirpc users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-libs/libtirpc-1.3.2"

```
### References

* [CVE-2021-46828](https://nvd.nist.gov/vuln/detail/CVE-2021-46828)

**Release date**

October 31, 2022

**Latest revision**

October 31, 2022: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [859634](https://bugs.gentoo.org/show_bug.cgi?id=859634)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**

