=== Content from www.microsoft.com_085de490_20250111_100218.html ===


Skip to main content

[![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/UHFbanner-MSlogo?fmt=png-alpha&bfc=off&qlt=100,1)
Microsoft](https://www.microsoft.com)

Microsoft Security

[Microsoft Security](https://www.microsoft.com/en-us/security)

Microsoft Security

* [Home](https://www.microsoft.com/en-us/security)
* Solutions
  + [AI-powered cybersecurity](https://www.microsoft.com/en-us/security/business/solutions/generative-ai-cybersecurity)
  + [Cloud security](https://www.microsoft.com/en-us/security/business/solutions/cloud-security)
  + [Data security](https://www.microsoft.com/en-us/security/business/solutions/data-security)
  + [Identity & network access](https://www.microsoft.com/en-us/security/business/solutions/identity-access)
  + [Privacy & risk management](https://www.microsoft.com/en-us/security/business/solutions/privacy-risk-management)
  + [Security for AI](https://www.microsoft.com/en-us/security/business/solutions/security-for-ai%20%20%20)
  + [Unified SecOps](https://www.microsoft.com/en-us/security/business/solutions/ai-powered-unified-secops-platform)
  + [Zero Trust](https://www.microsoft.com/en-us/security/business/zero-trust)
* Products
  + Product families
    Product families
    - [Microsoft Defender](https://www.microsoft.com/en-us/security/business/microsoft-defender)
    - [Microsoft Entra](https://www.microsoft.com/en-us/security/business/microsoft-entra)
    - [Microsoft Intune](https://www.microsoft.com/en-us/security/business/microsoft-Intune)
    - [Microsoft Priva](https://www.microsoft.com/en-us/security/business/microsoft-priva)
    - [Microsoft Purview](https://www.microsoft.com/en-us/security/business/microsoft-purview)
    - [Microsoft Sentinel](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-sentinel)
  + Security AI
    Security AI
    - [Microsoft Security Copilot](https://www.microsoft.com/en-us/security/business/ai-machine-learning/microsoft-security-copilot)
  + Identity & access
    Identity & access
    - [Microsoft Entra ID (Azure Active Directory)](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-id)
    - [Microsoft Entra External ID](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-external-id)
    - [Microsoft Entra ID Governance](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-id-governance)
    - [Microsoft Entra ID Protection](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-id-protection%20)
    - [Microsoft Entra Internet Access](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-internet-access)
    - [Microsoft Entra Private Access](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-private-access)
    - [Microsoft Entra Permissions Management](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-permissions-management%20)
    - [Microsoft Entra Verified ID](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-verified-id)
    - [Microsoft Entra Workload ID](https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-workload-id)
    - [Microsoft Entra Domain Services](https://azure.microsoft.com/en-us/products/microsoft-entra-ds)
    - [Azure Key Vault](https://azure.microsoft.com/en-us/products/key-vault/)
  + SIEM & XDR
    SIEM & XDR
    - [Microsoft Sentinel](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-sentinel)
    - [Microsoft Defender for Cloud](https://www.microsoft.com/en-us/security/business/cloud-security/microsoft-defender-cloud)
    - [Microsoft Defender XDR](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-defender-xdr)
    - [Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-endpoint)
    - [Microsoft Defender for Office 365](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-defender-office-365)
    - [Microsoft Defender for Identity](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-defender-for-identity)
    - [Microsoft Defender for Cloud Apps](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-defender-cloud-apps)
    - [Microsoft Security Exposure Management](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-security-exposure-management)
    - [Microsoft Defender Vulnerability Management](https://www.microsoft.com/en-us/security/business/threat-protection/microsoft-defender-vulnerability-management%20)
    - [Microsoft Defender Threat Intelligence](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-defender-threat-intelligence)
  + Cloud security
    Cloud security
    - [Microsoft Defender for Cloud](https://www.microsoft.com/en-us/security/business/cloud-security/microsoft-defender-cloud)
    - [Microsoft Defender Cloud Security Posture Mgmt](https://www.microsoft.com/en-us/security/business/cloud-security/microsoft-defender-cloud-security-posture-management)
    - [Microsoft Defender External Attack Surface Management](https://www.microsoft.com/security/business/cloud-security/microsoft-defender-external-attack-surface-management)
    - [Azure Firewall](https://azure.microsoft.com/en-us/services/azure-firewall/)
    - [Azure Web App Firewall](https://azure.microsoft.com/en-us/products/web-application-firewall/)
    - [Azure DDoS Protection](https://azure.microsoft.com/en-us/products/ddos-protection/)
    - [GitHub Advanced Security](https://github.com/features/security)
  + Endpoint security & management
    Endpoint security & management
    - [Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-endpoint)
    - [Microsoft Defender XDR](https://www.microsoft.com/en-us/security/business/siem-and-xdr/microsoft-defender-xdr)
    - [Microsoft Defender for Business](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-business)
    - [Microsoft Intune core capabilities](https://www.microsoft.com/en-us/security/business/endpoint-management/microsoft-intune)
    - [Microsoft Defender for IoT](https://www.microsoft.com/en-us/security/business/endpoint-security/microsoft-defender-iot)
    - [Microsoft Defender Vulnerability Management](https://www.microsoft.com/en-us/security/business/threat-protection/microsoft-defender-vulnerability-management%20)
    - [Microsoft Intune Advanced Analytics](https://www.microsoft.com/en-us/security/business/endpoint-management/microsoft-intune-advanced-analytics)
    - [Microsoft Intune Endpoint Privilege Management​](https://www.microsoft.com/en-us/security/business/endpoint-management/microsoft-intune-endpoint-privilege-management)
    - [Microsoft Intune Enterprise Application Management](https://www.microsoft.com/en-us/security/business/endpoint-management/microsoft-intune-enterprise-application-management)
    - [Microsoft Intune Remote Help](https://www.microsoft.com/en-us/security/business/endpoint-management/microsoft-intune-remote-help)
    - [Microsoft Cloud PKI](https://www.microsoft.com/en-us/security/business/endpoint-management/microsoft-cloud-pki)
  + Compliance & privacy
    Compliance & privacy
    - [Microsoft Purview Communication Compliance](https://www.microsoft.com/en-us/security/business/risk-management/microsoft-purview-communication-compliance)
    - [Microsoft Purview Compliance Manager](https://www.microsoft.com/en-us/security/business/risk-management/microsoft-purview-compliance-manager)
    - [Microsoft Purview Data Lifecycle Management](https://www.microsoft.com/en-us/security/business/information-protection/microsoft-purview-data-lifecycle-management)
    - [Microsoft Purview eDiscovery](https://www.microsoft.com/en-us/security/business/risk-management/microsoft-purview-ediscovery)
    - [Microsoft Purview Audit](https://www.microsoft.com/en-us/security/business/risk-management/microsoft-purview-audit)
    - [Microsoft Priva Risk Management](https://www.microsoft.com/en-us/security/business/privacy/microsoft-priva-risk-management)
    - [Microsoft Priva Subject Rights Requests](https://www.microsoft.com/en-us/security/business/privacy/microsoft-priva-subject-rights-requests)
  + Data security & governance
    Data security & governance
    - [Microsoft Purview Information Protection](https://www.microsoft.com/en-us/security/business/information-protection/microsoft-purview-information-protection)
    - [Microsoft Purview Insider Risk Management](https://www.microsoft.com/en-us/security/business/risk-management/microsoft-purview-insider-risk-management)
    - [Microsoft Purview Data Loss Prevention](https://www.microsoft.com/en-us/security/business/information-protection/microsoft-purview-data-loss-prevention)
    - [Microsoft Purview Data Governance](https://www.microsoft.com/en-us/security/business/risk-management/microsoft-purview-data-governance)
* Services
  + [Microsoft Security Experts](https://www.microsoft.com/en-us/security/business/services)
  + [Microsoft Defender Experts for XDR](https://www.microsoft.com/en-us/security/business/services/microsoft-defender-experts-xdr)
  + [Microsoft Defender Experts for Hunting](https://www.microsoft.com/en-us/security/business/services/microsoft-defender-experts-hunting)
  + [Microsoft Incident Response](https://www.microsoft.com/en-us/security/business/microsoft-incident-response)
  + [Microsoft Security Enterprise Services](https://www.microsoft.com/en-us/security/business/services/microsoft-security-enterprise-services)
* [Partners](https://www.microsoft.com/en-us/security/business/partnerships)
* Resources
  + Get started
    Get started
    - [Cybersecurity awareness](https://www.microsoft.com/en-us/security/business/cybersecurity-awareness)
    - [Customer stories](https://customers.microsoft.com/en-us/search?sq=Microsoft%20Security&ff=&p=0&so=story_publish_date%20desc)
    - [Security 101](https://www.microsoft.com/en-us/security/business/security-101)
    - [Product trials](https://www.microsoft.com/en-us/security/business/get-started/start-free-trial)
    - [How we protect Microsoft](https://www.microsoft.com/en-us/insidetrack)
  + Reports and analysis
    Reports and analysis
    - [Industry recognition](https://www.microsoft.com/en-us/security/business/reports-analysis/industry-recognized-cybersecurity-leader)
    - [Microsoft Security Insider](https://www.microsoft.com/en-us/security/security-insider/)
    - [Microsoft Digital Defense Report](https://www.microsoft.com/en-us/security/security-insider/intelligence-reports/microsoft-digital-defense-report-2024)
    - [Security Response Center](https://www.microsoft.com/en-us/msrc/)
  + Community
    Community
    - [Microsoft Security Blog](https://www.microsoft.com/en-us/security/blog/)
    - [Microsoft Security Events](https://events.microsoft.com/en-us/allevents/?language=English&clientTimeZone=1&search=security)
    - [Microsoft Tech Community](https://techcommunity.microsoft.com/t5/security-compliance-and-identity/ct-p/MicrosoftSecurityandCompliance)
  + Documentation and training
    Documentation and training
    - [Documentation](https://learn.microsoft.com/en-us/security/)
    - [Technical Content Library](https://learn.microsoft.com/en-us/security)
    - [Training & certifications](https://learn.microsoft.com/en-us/learn/topics/sci?wt.mc_id=techcom_header-webpage-m365)
  + Additional sites
    Additional sites
    - [Compliance Program for Microsoft Cloud](https://www.microsoft.com/en-us/security/business/services/compliance-program-microsoft-cloud)
    - [Microsoft Trust Center](https://www.microsoft.com/en-us/trust-center)
    - [Security Engineering Portal](https://www.microsoft.com/en-us/securityengineering)
    - [Service Trust Portal](https://servicetrust.microsoft.com/)
    - [Microsoft Secure Future Initiative](https://www.microsoft.com/en-us/trust-center/security/secure-future-initiative)
    - [Business Solutions Hub](https://www.microsoft.com/en-us/microsoft-cloud/solutions)
* [Contact Sales](https://www.microsoft.com/en-us/security/business/get-started/contact-us)
* [Start free trial](https://www.microsoft.com/en-us/security/business/get-started/start-free-trial)
* More

* All Microsoft
  + ## Global

    - [Microsoft Security](https://www.microsoft.com/en-us/security)
    - [Azure](https://azure.microsoft.com/en-us/)
    - [Dynamics 365](https://dynamics.microsoft.com/en-us/)
    - [Microsoft 365](https://www.microsoft.com/en-us/microsoft-365/business/)
    - [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
    - [Windows 365](https://www.microsoft.com/en-us/windows-365)
  + Tech & innovation
    Tech & innovation
    - [Microsoft Cloud](https://www.microsoft.com/en-us/microsoft-cloud)
    - [AI](https://www.microsoft.com/en-us/ai)
    - [Azure Space](https://azure.microsoft.com/en-us/solutions/space/)
    - [Mixed reality](https://www.microsoft.com/en-us/mixed-reality/windows-mixed-reality)
    - [Microsoft HoloLens](https://www.microsoft.com/en-us/hololens)
    - [Microsoft Viva](https://www.microsoft.com/en-us/microsoft-viva)
    - [Quantum computing](https://azure.microsoft.com/en-us/solutions/quantum-computing/)
    - [Sustainability](https://www.microsoft.com/en-us/sustainability/)
  + Industries
    Industries
    - [Education](https://www.microsoft.com/en-us/education)
    - [Automotive](https://www.microsoft.com/en-us/industry/automotive)
    - [Financial services](https://www.microsoft.com/en-us/industry/financial-services/banking)
    - [Government](https://www.microsoft.com/en-us/industry/government)
    - [Healthcare](https://www.microsoft.com/en-us/industry/health/microsoft-cloud-for-healthcare)
    - [Manufacturing](https://www.microsoft.com/en-us/industry/manufacturing/microsoft-cloud-for-manufacturing)
    - [Retail](https://www.microsoft.com/en-us/industry/consumer-goods)
    - [All industries](https://www.microsoft.com/en-us/industry)
  + Partners
    Partners
    - [Find a partner](https://partner.microsoft.com/en-US/)
    - [Become a partner](https://partner.microsoft.com/en-US/membership/cloud-solution-provider)
    - [Partner Network](https://partner.microsoft.com/en-us/membership)
    - [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/)
    - [AppSource](https://appsource.microsoft.com/en-us/)
  + Resources
    Resources
    - [Blog](https://blogs.microsoft.com/)
    - [Microsoft Advertising](https://about.ads.microsoft.com/en-us?s_cid=dig-src_uhfcomm)
    - [Developer Center](https://developer.microsoft.com/en-us/)
    - [Documentation](https://learn.microsoft.com/docs/)
    - [Events](https://www.microsoft.com/en-us/events)
    - [Licensing](https://www.microsoft.com/en-us/licensing/)
    - [Microsoft Learn](https://learn.microsoft.com/)
    - [Microsoft Research](https://www.microsoft.com/en-us/research/)
  + [View Sitemap](https://www.microsoft.com/en-us/sitemap)

Search
Search Microsoft Security

* No results

Cancel

1. [Blog home](https://www.microsoft.com/en-us/security/blog/)
2. Threat intelligence

Search the Microsoft security blog

Submit

![Young businesswoman holding a phone, looking out her office window overlooking the city.](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/05/Featured-image-1024x683.jpg)

* [Research](https://www.microsoft.com/en-us/security/blog/content-type/research/)
* [Threat intelligence](https://www.microsoft.com/en-us/security/blog/topic/threat-intelligence/)
* [Microsoft Defender](https://www.microsoft.com/en-us/security/blog/products/microsoft-defender/)
* [Vulnerabilities and exploits](https://www.microsoft.com/en-us/security/blog/threat-intelligence/vulnerabilities-and-exploits/)

15 min read
# “Dirty stream” attack: Discovering and mitigating a common vulnerability pattern in Android apps

* By
  [Microsoft Threat Intelligence](https://www.microsoft.com/en-us/security/blog/author/microsoft-security-threat-intelligence/)

May 1, 2024

* [Microsoft Defender for Endpoint](https://www.microsoft.com/en-us/security/blog/products/microsoft-defender-for-endpoint/)
* [Microsoft Defender Vulnerability Management](https://www.microsoft.com/en-us/security/blog/products/microsoft-defender-vulnerability-management/)
* [Mobile threats](https://www.microsoft.com/en-us/security/blog/threat-intelligence/mobile-threats/)
* [Android](https://www.microsoft.com/en-us/security/blog/tag/android/)
* [Credential theft](https://www.microsoft.com/en-us/security/blog/tag/credential-theft/)
* [Remote code execution](https://www.microsoft.com/en-us/security/blog/tag/remote-code-execution/)

Microsoft discovered a path traversal-affiliated vulnerability pattern in multiple popular Android applications that could enable a malicious application to overwrite files in the vulnerable application’s home directory. The implications of this vulnerability pattern include arbitrary code execution and token theft, depending on an application’s implementation. Arbitrary code execution can provide a threat actor with full control over an application’s behavior. Meanwhile, token theft can provide a threat actor with access to the user’s accounts and sensitive data.

We identified several vulnerable applications in the Google Play Store that represented over four billion installations. We anticipate that the vulnerability pattern could be found in other applications. We’re sharing this research so developers and publishers can check their apps for similar issues, fix as appropriate, and prevent introducing such vulnerabilities into new apps or releases.  As threats across all platforms continue to evolve, industry collaboration among security researchers, security vendors, and the broader security community is essential in improving security for all. Microsoft remains committed to working with the security community to share vulnerability discoveries and threat intelligence to protect users across platforms.

After discovering this issue, we identified several vulnerable applications. As part of our responsible disclosure policy, we notified application developers through [Coordinated Vulnerability Disclosure](https://www.microsoft.com/msrc/cvd) (CVD) via [Microsoft Security Vulnerability Research](https://www.microsoft.com/msrc/msvr) (MSVR) and worked with them to address the issue. We would like to thank the Xiaomi, Inc. and WPS Office security teams for investigating and fixing the issue. As of February 2024, fixes have been deployed for the aforementioned apps, and users are advised to keep their device and installed applications up to date.

Recognizing that more applications could be affected, we acted to increase developer awareness of the issue by collaborating with Google to publish [an article on the Android Developers website](https://developer.android.com/privacy-and-security/risks/untrustworthy-contentprovider-provided-filename), providing guidance in a high-visibility location to help developers avoid introducing this vulnerability pattern into their applications. We also wish to thank Google’s Android Application Security Research team for their partnership in resolving this issue.

In this blog post, we continue to raise developer and user awareness by giving a general overview of the vulnerability pattern, and then focusing on [Android share targets](https://developer.android.com/training/sharing/send), as they are the most prone to these types of attacks. We go through an actual code execution case study where we demonstrate impact that extends beyond the mobile device’s scope and could even affect a local network. Finally, we provide guidance to users and application developers and illustrate the importance of collaboration to improve security for all.

## Overview: Data and file sharing on Android

The Android operating system enforces isolation by assigning each application its own dedicated data and memory space. To facilitate data and file sharing, Android provides a component called a content provider, which acts as an interface for managing and exposing data to the rest of the installed applications in a secure manner. When used correctly, a content provider provides a reliable solution. However, improper implementation can introduce vulnerabilities that could enable bypassing of read/write restrictions within an application’s home directory.

The Android software development kit (SDK) includes the [*FileProvider*](https://developer.android.com/reference/androidx/core/content/FileProvider) class, a subclass of *ContentProvider* that enables file sharing between installed applications. An application that needs to share its files with other applications can declare a *FileProvider* in its app manifest and declare the specific paths to share.

Every file provider has a property called *authority*, which identifies it system-wide, and can be used by the consumer (the app that wants to access the shared files) as a form of address. This content-based model bears a strong resemblance to the web model, but instead of the *http* scheme, consumers utilize the *content* scheme along with the *authority*, followed by a pseudo-path to the file that they want to access.

For example, assuming that the application *com.example.server* shares some files under the *file:///data/data/com.example.server/files/images* directory that it has previously declared as shared using the name *shared\_images,* a consumer can use the *content://[authority]/shared\_images/[sub-path]/[filename] URI* to index these files.

Access is given by the data sharing application most commonly using the [*grantUriPermissions*](https://developer.android.com/guide/topics/manifest/provider-element#gprmsn) attribute of the Android manifest, in combination with special flags that are used to define a read or write mode of operation. The data sharing application creates and sends an intent to the consumer that provides temporary fine-grained access to a file.  Finally, when a provider receives a file access request, it resolves the actual file path that corresponds to the incoming URI and returns a file descriptor to it.

### Implementation pitfalls

This content provider-based model provides a well-defined file-sharing mechanism, enabling a serving application to share its files with other applications in a secure manner with fine-grained control. However, we have frequently encountered cases where the consuming application doesn’t validate the content of the file that it receives and, most concerning, it uses the filename provided by the serving application to cache the received file within the consuming application’s internal data directory. If the serving application implements its own malicious version of *FileProvider*, it may be able to cause the consuming application to overwrite critical files.

### Share targets

In simple terms, a share target is an Android app that declares itself to handle data and files sent by other apps. Common application categories that can be share targets include mail clients, social networking apps, messaging apps, file editors, browsers, and so on. In a common scenario, when a user clicks on a file, the Android operating system triggers the share-sheet dialog asking the user to select the component that the file should be sent to:

![Android share sheet dialog displaying apps such as OneDrive, OneNote, Outlook, and others.](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-1.-The-Android-share-sheet-dialog-1.webp)

*Figure 1. The Android share sheet dialog*

While this type of guided file-sharing interaction itself may not trigger a successful attack against a share target, a malicious Android application can create a custom, [explicit intent](https://developer.android.com/guide/components/intents-filters#Types) and send a file directly to a share target with a malicious filename and without the user’s knowledge or approval. Essentially, the malicious application is substituting its own malicious *FileProvider* implementation and provides a filename that is improperly trusted by the consuming application.

![Diagram displaying the distry stream attack steps between the malicious app and a share target APK. First, the request to process file is sent to the APK, which replies with a request for the file name. The malicious app replies with the name, the APK allows it, granting the malicious app the ability to deliver the final malicious payload.](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-2.-Dirty-stream-attack-1024x249.webp)

*Figure 2. Dirty stream attack*

In Figure 2, the malicious app, on the left, creates an explicit intent that targets the file processing component of the share target, on the right, and attaches a content URI as an intent’s extra. It then sends this intent to the share target using the *startActivity* API call.

After this point, most of the share targets that we have reviewed seem to follow a specific code pattern that includes the following steps:

1. Request the actual filename from the remote file provider
2. Use this filename to initialize a file that is subsequently used to initialize a file output stream
3. Create an input stream using the incoming content URI
4. Copy the input stream to the output stream

Since the rogue app controls the name as well as the content of the file, by blindly trusting this input, a share target may overwrite critical files in its private data space, which may lead to serious consequences.

### Impact

We identified this vulnerability pattern in the then-current versions of several Android applications published on the Google Play Store, including at least four with more than 500 million installations each. In each case, we responsibly disclosed to the vendor. Two example vulnerable applications that we identified are [Xiaomi Inc.’s File Manager](https://play.google.com/store/apps/details?id=com.mi.android.globalFileexplorer) (1B+ installs) and [WPS Office](https://play.google.com/store/apps/details?id=cn.wps.moffice_eng) (500M+ installs).

In Xiaomi Inc.’s File Manager, we were able to obtain arbitrary code execution in version V1-210567. After our disclosure, Xiaomi published version V1-210593, and we verified that the vulnerability has been addressed. In WPS Office, we were able to obtain arbitrary code execution in version 16.8.1. After our disclosure, WPS published and informed us that the vulnerability has been addressed as of version 17.0.0.

The potential impact varies depending on implementation specifics. For example, it’s very common for Android applications to read their server settings from the *shared\_prefs* directory. In such cases, the malicious app can overwrite these settings, causing the vulnerable app to communicate with an attacker-controlled server and send the user’s authentication tokens or other sensitive information.

In a worst-case (and not so uncommon) scenario, the vulnerable application might load native libraries from its data directory (as opposed to the more secure */data/app-lib* directory, where the libraries are [protected from modification](https://googlesamples.github.io/android-custom-lint-rules/checks/UnsafeDynamicallyLoadedCode.md.html)). In this case, the malicious application can overwrite a native library with malicious code that gets executed when the library is loaded. In the following section, we use Xiaomi Inc.’s File Manager to illustrate this case. We demonstrated the ability for a malicious application to overwrite the application’s shared preferences, write a native library to the application’s internal storage, and cause the application to load the library. These actions provided arbitrary code execution with the file manager’s user ID and permissions.

In the following sections, we focus on this case and delve into the technical details of this vulnerability pattern.

## Case study: Xiaomi Inc.’s File Manager

Xiaomi Inc.’s File Manager is the default file manager application for Xiaomi devices and is [published under the package name *com.mi.android.globalFileexplorer* on the Google Play Store](https://play.google.com/store/apps/details?id=com.mi.android.globalFileexplorer), where it has been installed over one billion times.

![Xiaomi’s File Manager profile according to Android rank](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-3.-Xiaomis-File-Manager-profile-according-to-Android-rank-1-1024x461.webp)

*Figure 3. Xiaomi’s File Manager profile according to Android rank (source: [File Manager](https://androidrank.org/application/file_manager/com.mi.android.globalFileexplorer))*

Besides having full access to the device’s external storage, the application requests many permissions, including the ability to install other applications:

![Screenshot of code displaying the app's permissions](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-4.-A-snapshot-of-the-applications-permissions-2.webp)

*Figure 4. A snapshot of the application’s permissions*

Further, it offers a junk files cleaner plugin as well as the ability to connect to remote FTP and SMB shares:

![Screenshot of using the file manager to connect to remote shares.](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-5.-Connecting-to-remote-shares-using-the-file-manager-1024x730.webp)

*Figure 5. Connecting to remote shares using the file manager*

## Vulnerability assessment findings

During our investigation, we identified that the application exports the *CopyFileActivity*, an activity alias of the *com.android.fileexplorer.activity.FileActivity*, which is used to handle copy-from-to file operations:

![Screenshot of the copy to CopyFileActivity event.](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-6.-Triggering-the-copy-to-CopyFileActivity.webp)

*Figure 6. Triggering the copy to CopyFileActivity*

Since this activity is exported, it can be triggered by any application installed on the same device by using an explicit intent of action *SEND* or *SEND\_MULTIPLE* and attaching a content URI corresponding to a file stream.

Upon receiving such an intent, the browser performs a validity check, which we found to be insufficient:

![Screenshot of code displaying the steps for validating an incoming copy file request.](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-7.-Validating-an-incoming-copy-file-request-1024x720.webp)

*Figure 7. Validating an incoming copy file request*

As depicted above, the *initCopyOrMoveIntent* method calls the *checkValid* method passing as an argument a content URI (steps 1 and 2). However, the *checkValid* method is designed to handle a file path, not a content URI. It always returns true for a content URI. Instead, a safer practice is to [parse the string as a URI](https://developer.android.com/privacy-and-security/risks/unsafe-uri-loading), including ensuring the scheme is the expected value (in this case, *file*, not *content*).The *checkValid* method verifies that the copy or move operation doesn’t affect the private directory of the app, by initializing a file object using the incoming string as an argument to the *File* class constructor and comparing its canonical path with the path that corresponds to the home directory of the application (steps 3 and 4). Given a content URI as a path, the *File* constructor normalizes it (following a Unix file system normalization), thus the *getCanonicalPath* method returns a string starting with “*/content:/*“, which will always pass the validity check. More specifically, the app performs a query to the remote content provider for the \_*size*, \_*display*\_*name* and \_*data* columns (see line 48 below). Then it uses the values returned by these rows to initialize the fields of an object of the *com.android.fileexplorer.mode.c* class:

![Screenshot of code getting file metadata from the remote content provider.](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-8.-Getting-file-metadata-from-the-remote-content-provider-2.webp)

*Figure 8. Getting file metadata from the remote content provider*

Given the case that the \_*display*\_*name* and \_*data* values, returned from the external file provider, are relative paths to the destination directory, after exiting from the method above, these class fields will contain values like the ones depicted below:

![Screenshot of code displaying the file model initialized after calling method a](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-9.-The-file-model-initialized-after-calling-the-method-a-2.webp)

*Figure 9. The file model initialized after calling the method a*

As shown above, the paths (variables *d* and *e*) of this file-model point to files within the home directory of the application, thus the file streams attached to the incoming intent are going to be written under the specific locations.

## Getting code execution

As previously mentioned, the application uses a plugin to clean the device’s junk files:

![Screenshot of the junk files cleaner plugin user interface](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-10.-The-junk-files-cleaner-plugin-user-interface.webp)

*Figure 10. The junk files cleaner plugin user interface*

When the application loads this plugin, it makes use of two native libraries: *libixiaomifileu.so*, which fetches from the */data/app* directory, and *libixiaomifileuext.so* from the home directory:

![Screenshot of code displaying the loaded native libraries traced using medusa](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-11.-Tracing-the-loaded-native-libraries-using-medusa-2.webp)

*Figure 11. Tracing the loaded native libraries using medusa*

As apps don’t have write access to the */data/app* folder, the *libixiaomifileu.so* file stored there cannot be replaced. The easiest way to get code execution is to replace the *libixiaomifileuext.so* with a malicious one*.* However, an attempt to do so would fail since **in this particular case, the vulnerability that we described can only be used to write new files within the home directory, not overwrite existing files.** Our next inquiry was to determine how the application loads the *libixiaomifileu.so.*

Our assessment showed that before the application loads this library, it follows the following steps:

1. Calculate the hash of the file *libixiaomifileu.so,* located in the */data/app* directory

2. Compare this hash with the value assigned to the “*libixiaomifileu.so\_hm5*” string, fetched from the *com.mi.android.globalFileexprorer\_preferences.xml* file

![Screenshot of code displaying the com.mi.android.globalFileexprorer_preferences.xml](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-12.-the-com.mi_.android.globalFileexprorer_preferences.xml_-3.webp)

*Figure 12. the com.mi.android.globalFileexprorer\_preferences.xml*

3. If the values don’t match, search for the *libixiaomifileu.so* file in the */files/lib* path in the home directory

4. If the file is found there, calculate its hash and compare it again with the value from the *shared\_preferences* folder

5. If the hashes match, load the file under the */files/lib* using the *System.load* method

Given this behavior, in order to get code execution with the file manager’s user ID, an attacker must take the following steps:

1. Use the path traversal vulnerability to save a malicious library as */files/lib/libixiaomifileu.so* (the file does not already exist in that directory, so overwriting is not an issue)

2. Calculate the hash of this library to replace the value of the *libixiaomifileu.so\_hm5* string

3. Trigger the junk cleaner plugin with an explicit intent, since the activity that loads the native libraries is exported

An acute reader might have noticed that the second step requires the attacker to force the browser to overwrite the *com.mi.android.globalFileexprorer\_preferences.xml,* which, as we already mentioned, was not possible.

To overcome this restriction, we referred to the actual implementation of the *SharedPreferences* class, where we found that when an Android application uses the *getSharedPreferences* API method to retrieve an instance of the *SharedPreferences* class, giving the name of the shared preferences file as an argument, then the constructor of the *SharedPreferencesImpl* class [performs the following steps](https://cs.android.com/android/platform/superproject/%2B/master%3Aframeworks/base/core/java/android/app/SharedPreferencesImpl.java;l=150):

1. Create a new file object using the name provided to the *getSharedPreferences* method, followed by the .xml extension, followed by the .bak extension

2. Check if this file exists, and in case it does, delete the original xml file and replace it with the one created in the first step

Through this behavior, we were able to save the *com.mi.android.globalFileexprorer\_preferences.xml.bak* under the shared preferences folder (as during the application’s runtime it is unlikely to exist), so when the app tried to verify the hash, the original xml file was already replaced by our own copy. After this point, by using a single intent to start the junk cleaner plugin, we were able to trick the application to load the malicious library instead of the one under the */data/app* folder and get code execution with the browser’s user ID.

## Impact

One reason we chose to use this app as a showcase is because the impact extends beyond the user’s mobile device. The application gives the option to connect to remote file shares using the FTP and SMB protocols and the user credentials are saved in clear text in the */data/data/com.mi.android.globalFileexplorer/files/rmt\_i.properties* file:

![Screenshot of code displaying the SMB or FTP credentials being saved in clear text](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-13.-SMB-FTP-credentials-saved-in-clear-text-2.webp)

*Figure 13. SMB/FTP credentials saved in clear text*

If a third party app was able to exploit this vulnerability and obtain code execution, an attacker could retrieve these credentials. The impact would then extend even further, since by the time that a user requests to open a remote share, the browser creates the directory */sdcard/Android/data/com.mi.android.globalFileexplorer/files/usbTemp/* where it saves the files that the user retrieves:

![Screenshot of code displaying the SMB shared files saved in the external storage](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-14.-SMB-shared-files-saved-in-the-external-storage-2.webp)

*Figure 14. SMB shared files, saved in the external storage*

This means that a remote attacker would be able to read or write files to SMB shares of a local network, assuming that the device was connected to it. The same stands for FTP shares as they are handled exactly in the same way:

![Screenshot of code displaying the FTP shared files saved in the external storage](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-15.-FTP-shared-files-saved-in-the-external-storage-2.webp)

*Figure 15. FTP shared files, saved in the external storage*

In summary, the exploitation flow is depicted in the figure below:

![Diagram displaying how the attacker obtains remote access to local shares, as further detailed in text.](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2024/04/Figure-16.-Getting-remote-access-to-local-shares-1-1024x369.webp)

*Figure 16. Getting remote access to local shares*

In **step 1**, the user opens a malicious app that may pose as a file editor, messaging app, mail client, or any app in general and request the user to save a file. By the time that the user attempts to save such a file, no matter what destination path they choose to save it, the malicious app forces the file browser app to write it under its internal */files/lib* folder. Then, the malicious app can start the junk cleaner using an explicit intent (no user interaction is required) and this will lead to code execution with the browser’s ID (**step 2**).

In **step 3,** the attacker uses the arbitrary code execution capability to retrieve the SMB and FTP credentials from the *rmt\_i.properties* file. Subsequently, the attacker can now jump to **step 5** and access the shares directly using the stolen credentials. Alternatively, after retrieving the share credentials, the mobile device can connect to a local network (**step 4**) and access an SMB or FTP share**,** allowing the attacker to access the shared files through the */sdcard/Android/data/com.mi.android.globalFileexplorer/files/usbTemp/* folder (**step 5**).

## Recommendations

Recognizing that this vulnerability pattern may be widespread, we shared our findings with Google’s Android Application Security Research team. We collaborated with Google to [author guidance](https://developer.android.com/privacy-and-security/risks/untrustworthy-contentprovider-provided-filename) for Android application developers to help them recognize and avoid this pattern. We recommend developers and security analysts familiarize themselves with the [excellent Android application security guidance](https://developer.android.com/privacy-and-security/risks) provided by Google as well as make use of the [Android Lint tool](https://developer.android.com/studio/write/lint#gradle) included with the Android SDK and integrated with Android Studio (supplemented with Google’s [additional security-focused checks](https://github.com/google/android-security-lints/)) to identify and avoid potential vulnerabilities. GitHub’s CodeQL also [provides capabilities](https://codeql.github.com/codeql-query-help/java/) to identify vulnerabilities.

To prevent these issues, when handling file streams sent by other applications, the safest solution is to completely ignore the name returned by the remote file provider when caching the received content. Some of the most robust approaches we encountered use randomly generated names, so even in the case that the content of an incoming stream is malformed, it won’t tamper with the application.

In cases where such an approach is not feasible, developers need to take extra steps to ascertain that the cached file is written to a dedicated directory. As an incoming file stream is usually identified by a content URI, the first step is to reliably identify and sanitize the corresponding filename. Besides filtering characters that may lead to a path traversal and before performing any write operation, developers must verify that the cached file is within the dedicated directory by performing a call to the *File.getCanonicalPath* and validating the prefix of the returned value.

Another area to safeguard is in the way developers try to extract a filename from a content URI. Developers often use *Uri.getLastPathSegment(),* which returns the (URL) *decoded* value of the last path URI segment. An attacker can craft a URI with URL encoded characters within this segment, including characters used for path traversal. Using the returned value to cache a file can again render the application vulnerable to this type of attack.

For end users, we recommend keeping mobile applications up to date through the Google Play Store (or other appropriate trusted source) to ensure that updates addressing known vulnerabilities are installed. Users should only install applications from trusted sources to avoid potentially malicious applications. We recommend users who accessed SMB or FTP shares through the Xiaomi app before updates to reset credentials and to investigate for any anomalous behavior. [Microsoft Defender for Endpoint on Android](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-android?view=o365-worldwide) can alert users and enterprises to malicious applications, and [Microsoft Defender Vulnerability Management](https://www.microsoft.com/security/business/threat-protection/microsoft-defender-vulnerability-management) can identify installed applications with known vulnerabilities.

***Dimitrios Valsamaras***

*Microsoft Threat Intelligence*

### References

* <https://www.blackhat.com/asia-23/briefings/schedule/index.html#dirty-stream-attack-turning-android-share-targets-into-attack-vectors-30234>
* <https://developer.android.com/privacy-and-security/risks/untrustworthy-contentprovider-provided-filename>
* <https://developer.android.com/reference/androidx/core/content/FileProvider>
* <https://developer.android.com/guide/topics/manifest/provider-element#gprmsn>
* <https://play.google.com/store/apps/details?id=com.mi.android.globalFileexplorer>
* <https://play.google.com/store/apps/details?id=cn.wps.moffice_eng>
* <https://googlesamples.github.io/android-custom-lint-rules/checks/UnsafeDynamicallyLoadedCode.md.html>
* <https://androidrank.org/application/file_manager/com.mi.android.globalFileexplorer>
* [https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/app/SharedPreferencesImpl.java;l=150](https://cs.android.com/android/platform/superproject/%2B/master%3Aframeworks/base/core/java/android/app/SharedPreferencesImpl.java;l=150)
* <https://developer.android.com/privacy-and-security/risks>
* <https://developer.android.com/studio/write/lint#gradle>
* <https://github.com/google/android-security-lints/>
* <https://codeql.github.com/codeql-query-help/java/>

### Learn more

For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog: <https://aka.ms/threatintelblog>.

To get notified about new publications and to join discussions on social media, follow us on LinkedIn at <https://www.linkedin.com/showcase/microsoft-threat-intelligence>, and on X (formerly Twitter) at <https://twitter.com/MsftSecIntel>.

To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast: <https://thecyberwire.com/podcasts/microsoft-threat-intelligence>.

## Related Posts

* ![a person standing on a table](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2023/11/Mobile-malware-blog-featured-image-336x189.jpg)

  + [Research](https://www.microsoft.com/en-us/security/blog/content-type/research/)
  + [Threat intelligence](https://www.microsoft.com/en-us/security/blog/topic/threat-intelligence/)
  + [Microsoft Defender](https://www.microsoft.com/en-us/security/blog/products/microsoft-defender/)
  + [Mobile threats](https://www.microsoft.com/en-us/security/blog/threat-intelligence/mobile-threats/)
  Published Nov 20, 2023
  9 min read

  ## [Social engineering attacks lure Indian users to install Android banking trojans](https://www.microsoft.com/en-us/security/blog/2023/11/20/social-engineering-attacks-lure-indian-users-to-install-android-banking-trojans/)

  Microsoft has observed ongoing activity from mobile banking trojan campaigns targeting users in India with social media messages and malicious applications designed to impersonate legitimate organizations and steal users’ information for financial fraud scams.
* ![a person standing in front of a building](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2023/03/Featured-image.jpg)

  + [Research](https://www.microsoft.com/en-us/security/blog/content-type/research/)
  + [Threat intelligence](https://www.microsoft.com/en-us/security/blog/topic/threat-intelligence/)
  + [Vulnerabilities and exploits](https://www.microsoft.com/en-us/security/blog/threat-intelligence/vulnerabilities-and-exploits/)
  Published Mar 6, 2023
  6 min read

  ## [Protecting Android clipboard content from unintended exposure](https://www.microsoft.com/en-us/security/blog/2023/03/06/protecting-android-clipboard-content-from-unintended-exposure/)

  Microsoft discovered that the SHEIN Android application periodically read the contents of the Android device clipboard and, if a particular pattern was present, sent the contents of the clipboard to a remote server.
* ![a person sitting on the seat of a car](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2023/04/Quadream-featured-image-1.jpg)

  + [Research](https://www.microsoft.com/en-us/security/blog/content-type/research/)
  + [Threat intelligence](https://www.microsoft.com/en-us/security/blog/topic/threat-intelligence/)
  + [Microsoft Defender](https://www.microsoft.com/en-us/security/blog/products/microsoft-defender/)
  + [Threat actors](https://www.microsoft.com/en-us/security/blog/threat-intelligence/threat-actors/)
  Published Apr 11, 2023
  14 min read

  ## [DEV-0196: QuaDream’s “KingsPawn” malware used to target civil society in Europe, North America, the Middle East, and Southeast Asia](https://www.microsoft.com/en-us/security/blog/2023/04/11/dev-0196-quadreams-kingspawn-malware-used-to-target-civil-society-in-europe-north-america-the-middle-east-and-southeast-asia/)

  Microsoft analyzes a threat group tracked as DEV-0196, the actor’s iOS malware “KingsPawn”, and their link to an Israel-based private sector offensive actor (PSOA) known as QuaDream, which reportedly sells a suite of exploits, malware, and infrastructure called REIGN, that’s designed to exfiltrate data from mobile devices.
* ![](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2022/08/TikTok-featured-image.png)

  + [Research](https://www.microsoft.com/en-us/security/blog/content-type/research/)
  + [Threat intelligence](https://www.microsoft.com/en-us/security/blog/topic/threat-intelligence/)
  + [Vulnerabilities and exploits](https://www.microsoft.com/en-us/security/blog/threat-intelligence/vulnerabilities-and-exploits/)
  Published Aug 31, 2022
  11 min read

  ## [Vulnerability in TikTok Android app could lead to one-click account hijacking](https://www.microsoft.com/en-us/security/blog/2022/08/31/vulnerability-in-tiktok-android-app-could-lead-to-one-click-account-hijacking/)

  Microsoft discovered a high-severity vulnerability in the TikTok Android application, now identified as CVE-2022-28799 and fixed by TikTok, which could have allowed attackers to compromise users' accounts with a single click.

## Get started with Microsoft Security

Microsoft is a leader in cybersecurity, and we embrace our responsibility to make the world a safer place.

[Learn more](https://www.microsoft.com/en-us/security?wt.mc_id=AID730391_QSG_BLOG_319247&ocid=AID730391_QSG_BLOG_319247)

![Banner that reads "protect it all with Microsoft Security"](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2021/06/Security_Blog-banner_900x360.png)

## Connect with us on social

What's new

* [Surface Pro](https://www.microsoft.com/en-us/surface/devices/surface-pro-11th-edition)
* [Surface Laptop](https://www.microsoft.com/en-us/surface/devices/surface-laptop-7th-edition)
* [Surface Laptop Studio 2](https://www.microsoft.com/en-us/d/Surface-Laptop-Studio-2/8rqr54krf1dz)
* [Surface Laptop Go 3](https://www.microsoft.com/en-us/d/Surface-Laptop-Go-3/8p0wwgj6c6l2)
* [Microsoft Copilot](https://www.microsoft.com/en-us/microsoft-copilot)
* [AI in Windows](https://www.microsoft.com/en-us/windows/copilot-ai-features)
* [Explore Microsoft products](https://www.microsoft.com/en-us/microsoft-products-and-apps)
* [Windows 11 apps](https://www.microsoft.com/windows/windows-11-apps)

Microsoft Store

* [Account profile](https://account.microsoft.com/)
* [Download Center](https://www.microsoft.com/en-us/download)
* [Microsoft Store support](https://go.microsoft.com/fwlink/?linkid=2139749)
* [Returns](https://www.microsoft.com/en-us/store/b/returns)
* [Order tracking](https://www.microsoft.com/en-us/store/b/order-tracking)
* [Certified Refurbished](https://www.microsoft.com/en-us/store/b/certified-refurbished-products)
* [Microsoft Store Promise](https://www.microsoft.com/en-us/store/b/why-microsoft-store?icid=footer_why-msft-store_7102020)
* [Flexible Payments](https://www.microsoft.com/en-us/store/b/payment-financing-options?icid=footer_financing_vcc)

Education

* [Microsoft in education](https://www.microsoft.com/en-us/education)
* [Devices for education](https://www.microsoft.com/en-us/education/devices/overview)
* [Microsoft Teams for Education](https://www.microsoft.com/en-us/education/products/teams)
* [Microsoft 365 Education](https://www.microsoft.com/en-us/education/products/microsoft-365)
* [How to buy for your school](https://www.microsoft.com/education/how-to-buy)
* [Educator training and development](https://education.microsoft.com/)
* [Deals for students and parents](https://www.microsoft.com/en-us/store/b/education)
* [Azure for students](https://azure.microsoft.com/en-us/free/students/)

Business

* [Microsoft Cloud](https://www.microsoft.com/en-us/microsoft-cloud)
* [Microsoft Security](https://www.microsoft.com/en-us/security)
* [Dynamics 365](https://www.microsoft.com/en-us/dynamics-365)
* [Microsoft 365](https://www.microsoft.com/en-us/microsoft-365/business)
* [Microsoft Power Platform](https://www.microsoft.com/en-us/power-platform)
* [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
* [Microsoft 365 Copilot](https://www.microsoft.com/en-us/microsoft-365/copilot/copilot-for-work)
* [Small Business](https://www.microsoft.com/en-us/store/b/business?icid=CNavBusinessStore)

Developer & IT

* [Azure](https://azure.microsoft.com/en-us/)
* [Microsoft Developer](https://developer.microsoft.com/en-us/)
* [Documentation](https://learn.microsoft.com/docs/)
* [Microsoft Learn](https://learn.microsoft.com/)
* [Microsoft Tech Community](https://techcommunity.microsoft.com/)
* [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/)
* [AppSource](https://appsource.microsoft.com/en-us/)
* [Visual Studio](https://visualstudio.microsoft.com/)

Company

* [Careers](https://careers.microsoft.com/)
* [About Microsoft](https://www.microsoft.com/about)
* [Company news](https://news.microsoft.com/)
* [Privacy at Microsoft](https://privacy.microsoft.com/en-us)
* [Investors](https://www.microsoft.com/investor/default.aspx)
* [Diversity and inclusion](https://www.microsoft.com/en-us/diversity/)
* [Accessibility](https://www.microsoft.com/en-us/accessibility)
* [Sustainability](https://www.microsoft.com/en-us/sustainability/)

[English (United States)](https://www.microsoft.com/en-us/security/locale)
[Your Privacy Choices Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)
[Your Privacy Choices Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

[Consumer Health Privacy](https://go.microsoft.com/fwlink/?linkid=2259814)

* [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx)
* [Contact Microsoft](https://support.microsoft.com/contactus)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* Manage cookies
* [Terms of use](https://go.microsoft.com/fwlink/?LinkID=206977)
* [Trademarks](https://go.microsoft.com/fwlink/?linkid=2196228)
* [Safety & eco](https://go.microsoft.com/fwlink/?linkid=2196227)
* [Recycling](https://www.microsoft.com/en-us/legal/compliance/recycling)
* [About our ads](https://choice.microsoft.com)
* © Microsoft 2025


