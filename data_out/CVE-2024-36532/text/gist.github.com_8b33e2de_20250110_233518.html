
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F43488e1d41110a5610146b87b2e88a02)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F43488e1d41110a5610146b87b2e88a02&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F43488e1d41110a5610146b87b2e88a02) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F43488e1d41110a5610146b87b2e88a02&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@HouqiyuA](https://avatars.githubusercontent.com/u/138644910?s=64&v=4)](/HouqiyuA)

# [HouqiyuA](/HouqiyuA)/**[gist:43488e1d41110a5610146b87b2e88a02](/HouqiyuA/43488e1d41110a5610146b87b2e88a02)** Secret

Last active
October 18, 2024 09:44

Show Gist options

* [Download ZIP](/HouqiyuA/43488e1d41110a5610146b87b2e88a02/archive/1057ad6d5dc0d2b0fe52e3d3b0d3ebfc9ed71762.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F43488e1d41110a5610146b87b2e88a02)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F43488e1d41110a5610146b87b2e88a02)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/HouqiyuA/43488e1d41110a5610146b87b2e88a02.js&quot;&gt;&lt;/script&gt;
* Save HouqiyuA/43488e1d41110a5610146b87b2e88a02 to your computer and use it in GitHub Desktop.

[Code](/HouqiyuA/43488e1d41110a5610146b87b2e88a02)
[Revisions
2](/HouqiyuA/43488e1d41110a5610146b87b2e88a02/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/HouqiyuA/43488e1d41110a5610146b87b2e88a02.js&quot;&gt;&lt;/script&gt;

Save HouqiyuA/43488e1d41110a5610146b87b2e88a02 to your computer and use it in GitHub Desktop.

[Download ZIP](/HouqiyuA/43488e1d41110a5610146b87b2e88a02/archive/1057ad6d5dc0d2b0fe52e3d3b0d3ebfc9ed71762.zip)

CVE-2024-36532 References

 [Raw](/HouqiyuA/43488e1d41110a5610146b87b2e88a02/raw/1057ad6d5dc0d2b0fe52e3d3b0d3ebfc9ed71762/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | [Description]: |
| --- | --- |
|  | Insecure permissions in kruise v1.6.2 allows attackers to access sensitive data and escalate privileges by obtaining the service account's token. |
|  |  |
|  | [Vulnerability Type]: |
|  | Incorrect Access Control |
|  |  |
|  | [Vendor of Product]: |
|  | https://github.com/openkruise/kruise |
|  |  |
|  | [Affected Product Code Base]: |
|  | kruise v1.6.2 |
|  |  |
|  | [Affected Component]: |
|  | Directly compromise all Secrets components in k8s, further compromise other components in the cluster or even take over the entire kubernetes cluster. |
|  |  |
|  | [Attack Vectors]: |
|  |  |
|  | 1. the attacker stole the token. |
|  | Here is an example of stealing a token：in cncf, there is a project named hwameistor, and the DaemonSet hwameistor-local-disk-manager for that project has a cluster role named hwameistor-admin, which has the `update/patch` verb of `nodes` resource.If a malicious user takes control of a worker node, by default the "hwameistor-local-disk-manager" pod will run on that node and he/she can use that pod to patch/update other nodes and force kruise’s pod to run on the malicious worker node. Then, he/she can stole the token. |
|  | 2. Use the obtained token information to authenticate with the API Server. By including the token in the request, attacker can be recognized as a legitimate user with the ServiceAccount and gain all privileges associated with the ServiceAccount. |
|  | 3. Use the privileges to access all Secrets in the cluster. |
|  | 4. Use the sensitive information in the Secrets to elevate privileges and explore other sensitive resources, and eventually take over the entire cluster. |

[![@furykerry](https://avatars.githubusercontent.com/u/297181?s=80&v=4)](/furykerry)

Copy link

### **[furykerry](/furykerry)** commented [Oct 18, 2024](/HouqiyuA/43488e1d41110a5610146b87b2e88a02?permalink_comment_id=5241575#gistcomment-5241575)

openkruise daemonset had remove cluster-wide secret access privilege, so it is unlikely the attacker can escalate privileges through the kruise-daemon. the kruise-manager still had cluster-wide secret access, but the kruise-manager is usually installed in secured resource pool that is separated from the normal application and daemon. Think kruise-manager as equivalent of kcm of kubernetes. The key is to secure the resource pool that kruise-manager and kcm are running.

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FHouqiyuA%2F43488e1d41110a5610146b87b2e88a02)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

