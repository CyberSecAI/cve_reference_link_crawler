[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Online Matrimonial Project v1.0 - Multiple Unauthenticated SQL Injections (SQLi)

## Summary

|  |  |
| --- | --- |
| **Name** | Online Matrimonial Project v1.0 - Multiple Unauthenticated SQL Injections (SQLi) |
| **Code name** | [Ros](https://en.wikipedia.org/wiki/Sigur_R%C3%B3s) |
| **Product** | Online Matrimonial Project |
| **Vendor** | Projectworlds Pvt. Limited |
| **Affected versions** | Version 1.0 |
| **State** | Public |
| **Release date** | 2023-11-02 |

## Vulnerabilities

|  |  |
| --- | --- |
| **Kind** | Unauthenticated SQL Injections (SQLi) |
| **Rule** | [146. SQL Injection](https://docs.fluidattacks.com/criteria/vulnerabilities/146) |
| **Remote** | Yes |
| **CVSSv3 Vector** | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |
| **CVSSv3 Base Score** | 9.8 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2023-46785](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46785), [CVE-2023-46787](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46787), [CVE-2023-46788](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46788), [CVE-2023-46789](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46789), [CVE-2023-46793](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46793), [CVE-2023-46800](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46800) |

## Description

Online Matrimonial Project v1.0 is vulnerable to
multiple Unauthenticated SQL Injection vulnerabilities.

## Vulnerabilities

### CVE-2023-46785

The 'id' parameter of the partner\_preference.php resource
does not validate the characters received and they
are sent unfiltered to the database. The vulnerable
code is:

```
$id=$_GET['id'];
writepartnerprefs($id);

///reading partnerprefs from db

$sql="SELECT * FROM partnerprefs WHERE custId = $id";
$result=mysqlexec($sql);

```
### CVE-2023-46787

The 'username' parameter of the auth/auth.php resource
does not validate the characters received and they
are sent unfiltered to the database. The vulnerable
code is:

```
$myusername=$_POST['username'];
$mypassword=$_POST['password'];

// To protect MySQL injection (more detail about MySQL injection)
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);

$sql="SELECT * FROM users WHERE username='$myusername' AND password='$mypassword'";
$result=mysqli_query($conn,$sql);

```
### CVE-2023-46788

The 'id' parameter in the 'uploadphoto()'
function of the functions.php resource
does not validate the characters received and they
are sent unfiltered to the database. The vulnerable
code is:

photouploader.php:

```
$id=$_GET['id'];
if(isloggedin()){
 //do nothing stay here
} else{
   header("location:login.php");
}

//calling photo uploader function
if ($_SERVER['REQUEST_METHOD'] == 'POST'){ uploadphoto($id); }

```

functions.php:

```
function uploadphoto($id){
    $target = "profile/". $id ."/";
if (!file_exists($target)) {
    mkdir($target, 0777, true);
}
...
$sql="SELECT id FROM photos WHERE cust_id = '$id'";
$result = mysqlexec($sql);

```
### CVE-2023-46789

The 'filename' attribute of the 'pic1' multipart
parameter of the functions.php resource
does not validate the characters received and they
are sent unfiltered to the database. The vulnerable
code is:

```
// This gets all the other information from the form
$pic1=($_FILES['pic1']['name']);
$pic2=($_FILES['pic2']['name']);
$pic3=($_FILES['pic3']['name']);
$pic4=($_FILES['pic4']['name']);
...
//code part to check weather a photo already exists
if(mysqli_num_rows($result) == 0) {
    // no photo for curret user, do stuff...
    $sql="INSERT INTO photos (id, cust_id, pic1, pic2, pic3, pic4) VALUES ('', '$id', '$pic1' ,'$pic2', '$pic3','$pic4')";
    // Writes the information to the database
    mysqlexec($sql);

} else {
// There is a photo for customer so up
    $sql="UPDATE photos SET pic1 = '$pic1', pic2 = '$pic2', pic3 = '$pic3', pic4 = '$pic4' WHERE cust_id=$id";
    // Writes the information to the database
mysqlexec($sql);
}

```
### CVE-2023-46793

The 'day' parameter in the 'register()'
function of the functions.php resource
does not validate the characters received and they
are sent unfiltered to the database. The vulnerable
code is:

```
function register(){
    if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $uname=$_POST['name'];
    $pass=$_POST['pass'];
    $email=$_POST['email'];
    $day=$_POST['day'];
    $month=$_POST['month'];
    $year=$_POST['year'];
        $day=$_POST['day'];
        $month=$_POST['month'];
        $year=$_POST['year'];
    $dob=$year ."-" . $month . "-" .$day ;
    $gender=$_POST['gender'];
    require_once("includes/dbconn.php");

    $sql = "INSERT
            INTO
               users
               ( profilestat, username, password, email, dateofbirth, gender, userlevel)
            VALUES
               (0, '$uname', '$pass', '$email', '$dob', '$gender', 0)";

    if (mysqli_query($conn,$sql))
...

```
### CVE-2023-46800

The 'id' parameter of the view\_profile.php resource
does not validate the characters received and they
are sent unfiltered to the database. The vulnerable
code is:

```
$id=$_GET['id'];
//safty purpose copy the get id
$profileid=$id;

//getting profile details from db
$sql="SELECT * FROM customer WHERE cust_id = $id";
$result = mysqlexec($sql);

```
## Our security policy

We have reserved the IDs CVE-2023-46785,
CVE-2023-46787, CVE-2023-46788,
CVE-2023-46789,
CVE-2023-46793,
and CVE-2023-46800
to refer to these issues from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Online Matrimonial Project v1.0
* Operating System: Any

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by
[Andres Roldan](https://www.linkedin.com/in/andres-roldan/)
from Fluid Attacks' Offensive Team.

## References

**Vendor page** <https://projectworlds.in/>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-10-26

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-10-26

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-11-02

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)

