=== Content from www.wordfence.com_a3ba47a1_20250111_170544.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Frontend Admin by DynamiApps <= 3.19.4 - Improper Missing Encryption Exception Handling to Form Manipulation

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Frontend Admin by DynamiApps <= 3.19.4 - Improper Missing Encryption Exception Handling to Form Manipulation

9.8

**Not Failing Securely ('Failing Open')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-3729](https://www.cve.org/CVERecord?id=CVE-2024-3729) |
| --- | --- |
| CVSS | 9.8 (Critical) |
| Publicly Published | April 18, 2024 |
| Last Updated | May 2, 2024 |
| Researcher | [István Márton - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/lana-codes) |

### Description

The Frontend Admin by DynamiApps plugin for WordPress is vulnerable to improper missing encryption exception handling on the 'fea\_encrypt' function in all versions up to, and including, 3.19.4. This makes it possible for unauthenticated attackers to manipulate the user processing forms, which can be used to add and edit administrator user for privilege escalation, or to automatically log in users for authentication bypass, or manipulate the post processing form that can be used to inject arbitrary web scripts. This can only be exploited if the 'openssl' php extension is not loaded on the server.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/acf-frontend-form-element/tags/3.18.15/main/helpers.php#L617)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3073379/acf-frontend-form-element#file4)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Facf-frontend-form-element%2Ffrontend-admin-by-dynamiapps-3194-improper-missing-encryption-exception-handling-to-form-manipulation&t=Frontend%20Admin%20by%20DynamiApps%20%3C%3D%203.19.4%20-%20Improper%20Missing%20Encryption%20Exception%20Handling%20to%20Form%20Manipulation "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Facf-frontend-form-element%2Ffrontend-admin-by-dynamiapps-3194-improper-missing-encryption-exception-handling-to-form-manipulation&text=Frontend%20Admin%20by%20DynamiApps%20%3C%3D%203.19.4%20-%20Improper%20Missing%20Encryption%20Exception%20Handling%20to%20Form%20Manipulation "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Facf-frontend-form-element%2Ffrontend-admin-by-dynamiapps-3194-improper-missing-encryption-exception-handling-to-form-manipulation "LinkedIn")
Email

## Vulnerability Details for Frontend Admin by DynamiApps

#### [Frontend Admin by DynamiApps](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/acf-frontend-form-element)

| Software Type | Plugin |
| --- | --- |
| Software Slug | acf-frontend-form-element [(view on wordpress.org)](https://wordpress.org/plugins/acf-frontend-form-element) |
| Patched? | Yes |
| Remediation | Update to version 3.19.5, or a newer patched version |
| Affected Version | * <= 3.19.4 |
| Patched Version | * 3.19.5 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_76480f5f_20250111_170543.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3073379%2Facf-frontend-form-element)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3073133/acf-frontend-form-element "Changeset 3073133 for acf-frontend-form-element")
* [Next Change](/changeset/3073380/acf-frontend-form-element "Changeset 3073380 for acf-frontend-form-element") →

---

# Changeset [3073379](/changeset/3073379 "Show full changeset") for [acf-frontend-form-element](/browser/acf-frontend-form-element?rev=3073379 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
04/18/2024 06:15:49 PM
([9 months](/timeline?from=2024-04-18T18%3A15%3A49Z&precision=second "See timeline at 04/18/2024 06:15:49 PM") ago)

Author:
shabti
Message:

* Fixed modal button showing up if permissions test failed
* Fixed descrypt and encrypt functions
* Added modal button to new widgets

Location:
[acf-frontend-form-element](/browser/acf-frontend-form-element?rev=3073379)
Files:

1 added
6 edited

* [assets/banner-772x250.png](/browser/acf-frontend-form-element/assets/banner-772x250.png?rev=3073379 "Show entry in browser")
  (added)
* [trunk/acf-frontend.php](/browser/acf-frontend-form-element/trunk/acf-frontend.php?rev=3073379 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [trunk/main/elementor/widgets/general/acf-form.php](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/acf-form.php?rev=3073379 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [trunk/main/elementor/widgets/general/nested-form.php](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php?rev=3073379 "Show entry in browser")
  (modified)
  ([3 diffs](#file3 "Show differences"))
* [trunk/main/helpers.php](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3073379 "Show entry in browser")
  (modified)
  ([3 diffs](#file4 "Show differences"))
* [trunk/main/plugin.php](/browser/acf-frontend-form-element/trunk/main/plugin.php?rev=3073379 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [trunk/readme.txt](/browser/acf-frontend-form-element/trunk/readme.txt?rev=3073379 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [acf-frontend-form-element/trunk/acf-frontend.php](/changeset/3073379/acf-frontend-form-element/trunk/acf-frontend.php "Show the changeset 3073379 restricted to acf-frontend-form-element/trunk/acf-frontend.php")

  | [r3073132](/browser/acf-frontend-form-element/trunk/acf-frontend.php?rev=3073132#L4 "Show revision 3073132 of this file in browser") | [r3073379](/browser/acf-frontend-form-element/trunk/acf-frontend.php?rev=3073379#L4 "Show revision 3073379 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/acf-frontend-form-element/ |
  | 5 | 5 | \* Description: This awesome plugin allows you to easily display admin forms to the frontend of your site so your clients can easily edit content on their own from the frontend. |
  | 6 |  | \* Version:     3.19.~~4~~ |
  |  | 6 | \* Version:     3.19.5 |
  | 7 | 7 | \* Author:      Shabti Kaplan |
  | 8 | 8 | \* Author URI:  https://www.dynamiapps.com/ |
* ## [acf-frontend-form-element/trunk/main/elementor/widgets/general/acf-form.php](/changeset/3073379/acf-frontend-form-element/trunk/main/elementor/widgets/general/acf-form.php "Show the changeset 3073379 restricted to acf-frontend-form-element/trunk/main/elementor/widgets/general/acf-form.php")

  | [r3073132](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/acf-form.php?rev=3073132#L503 "Show revision 3073132 of this file in browser") | [r3073379](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/acf-form.php?rev=3073379#L503 "Show revision 3073379 of this file in browser") |  |
  | --- | --- | --- |
  | 503 | 503 | $settings = $this->get\_settings\_for\_display(); |
  | 504 | 504 |  |
  |  | 505 | $settings['id'] = $wg\_id; |
  |  | 506 | $\_settings = apply\_filters( 'frontend\_admin/show\_form', $settings ); |
  |  | 507 |  |
  |  | 508 | if( ! $\_settings ) return; |
  |  | 509 |  |
  | 505 | 510 | $form\_args = apply\_filters( 'frontend\_admin/elementor/form/args', $settings, $wg\_id ); |
  | 506 | 511 |  |
* ## [acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php](/changeset/3073379/acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php "Show the changeset 3073379 restricted to acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php")

  | [r3073132](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php?rev=3073132#L244 "Show revision 3073132 of this file in browser") | [r3073379](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php?rev=3073379#L244 "Show revision 3073379 of this file in browser") |  |
  | --- | --- | --- |
  | 244 | 244 | do\_action( 'frontend\_admin/elementor/actions\_controls', $this, true ); |
  | 245 | 245 | do\_action( 'frontend\_admin/elementor/permissions\_controls', $this, true ); |
  |  | 246 | do\_action( 'frontend\_admin/elementor\_widget/content\_controls', $this ); |
  | 246 | 247 |  |
  | 247 | 248 | } |
  | […](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php?rev=3073132#L360) | […](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php?rev=3073379#L361) |  |
  | 360 | 361 | global $fea\_form, $fea\_instance; |
  | 361 | 362 |  |
  |  | 363 |  |
  | 362 | 364 | $form = $fea\_instance->elementor->get\_form\_args( $settings, $this->get\_id() ); |
  | 363 | 365 | $fea\_form =  $fea\_instance->form\_display->validate\_form( $form ); |
  |  | 366 | do\_action( 'frontend\_admin/elementor/before\_render', $fea\_form ); |
  | 364 | 367 |  |
  | 365 | 368 | $fea\_instance->frontend->enqueue\_scripts( 'frontend\_admin\_form' ); |
  | […](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php?rev=3073132#L419) | […](/browser/acf-frontend-form-element/trunk/main/elementor/widgets/general/nested-form.php?rev=3073379#L422) |  |
  | 419 | 422 |  |
  | 420 | 423 | echo '</form>'; |
  |  | 424 |  |
  |  | 425 | do\_action( 'frontend\_admin/elementor/after\_render', $fea\_form ); |
  |  | 426 |  |
  | 421 | 427 | } |
  | 422 | 428 |  |
* ## [acf-frontend-form-element/trunk/main/helpers.php](/changeset/3073379/acf-frontend-form-element/trunk/main/helpers.php "Show the changeset 3073379 restricted to acf-frontend-form-element/trunk/main/helpers.php")

  | [r3070687](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3070687#L328 "Show revision 3070687 of this file in browser") | [r3073379](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3073379#L328 "Show revision 3073379 of this file in browser") |  |
  | --- | --- | --- |
  | 328 | 328 | $v = implode( ', ', $addresses ); |
  | 329 | 329 | }else{ |
  | 330 |  | $v = wp\_kses\_post($v); |
  | 331 |  | $data[$k] = $v; |
  |  | 330 | if( ! $v ){ |
  |  | 331 | $data[$k] = ''; |
  |  | 332 | }else{ |
  |  | 333 | $v = wp\_kses\_post($v); |
  |  | 334 | $data[$k] = $v; |
  |  | 335 | } |
  | 332 | 336 | } |
  | 333 | 337 | } |
  | […](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3070687#L656) | […](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3073379#L660) |  |
  | 656 | 660 | // bail early if no encrypt function |
  | 657 | 661 | if ( ! function\_exists( 'openssl\_encrypt' ) ) { |
  | 658 |  | ~~return base64\_encode( $data );~~ |
  |  | 662 | wp\_die( 'Please enable the openssl extension in your PHP configuration to use the encryption feature.' ); |
  | 659 | 663 | } |
  | 660 | 664 |  |
  | […](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3070687#L694) | […](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3073379#L698) |  |
  | 694 | 698 | // bail early if no decrypt function |
  | 695 | 699 | if ( ! function\_exists( 'openssl\_decrypt' ) ) { |
  | 696 |  | ~~return json\_decode( base64\_decode( $data ), true~~ ); |
  |  | 700 | wp\_die( 'Please enable the openssl extension in your PHP configuration to use the encryption feature.' ); |
  | 697 | 701 | } |
  | 698 | 702 |  |
* ## [acf-frontend-form-element/trunk/main/plugin.php](/changeset/3073379/acf-frontend-form-element/trunk/main/plugin.php "Show the changeset 3073379 restricted to acf-frontend-form-element/trunk/main/plugin.php")

  | [r3073132](/browser/acf-frontend-form-element/trunk/main/plugin.php?rev=3073132#L66 "Show revision 3073132 of this file in browser") | [r3073379](/browser/acf-frontend-form-element/trunk/main/plugin.php?rev=3073379#L66 "Show revision 3073379 of this file in browser") |  |
  | --- | --- | --- |
  | 66 | 66 | define( 'FEA\_DIR', $data['plugin\_dir'] ); |
  | 67 | 67 | define( 'FEA\_PLUGIN', $data['plugin'] ); |
  | 68 |  | define( 'FEA\_VERSION', '3.19.~~4~~' ); |
  |  | 68 | define( 'FEA\_VERSION', '3.19.5' ); |
  | 69 | 69 |  |
  | 70 | 70 | do\_action( 'front\_end\_admin\_loaded' ); |
* ## [acf-frontend-form-element/trunk/readme.txt](/changeset/3073379/acf-frontend-form-element/trunk/readme.txt "Show the changeset 3073379 restricted to acf-frontend-form-element/trunk/readme.txt")

  | [r3073132](/browser/acf-frontend-form-element/trunk/readme.txt?rev=3073132#L4 "Show revision 3073132 of this file in browser") | [r3073379](/browser/acf-frontend-form-element/trunk/readme.txt?rev=3073379#L4 "Show revision 3073379 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 4.6 |
  | 5 | 5 | Tested up to: 6.4.3 |
  | 6 |  | Stable tag: 3.19.~~4~~ |
  |  | 6 | Stable tag: 3.19.5 |
  | 7 | 7 | Donate link: https://paypal.me/KaplanWebDev |
  | 8 | 8 | Requires PHP: 5.6.0 |
  | […](/browser/acf-frontend-form-element/trunk/readme.txt?rev=3073132#L136) | […](/browser/acf-frontend-form-element/trunk/readme.txt?rev=3073379#L136) |  |
  | 136 | 136 |  |
  | 137 | 137 | == Changelog == |
  |  | 138 | = 3.19.5 - 18-04-2024 = |
  |  | 139 | \* Fixed modal button showing up if permissions test failed |
  |  | 140 | \* Fixed descrypt and encrypt functions |
  |  | 141 |  |
  | 138 | 142 | = 3.19.4 - 18-04-2024 = |
  | 139 | 143 | \* Fixed post to edit field not loading post on initial load |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3073379)
* [Zip Archive](?format=zip&new=3073379)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_9bd36449_20250111_170542.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Facf-frontend-form-element%2Ftags%2F3.18.15%2Fmain%2Fhelpers.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3006156 "Revision 3006156")
* [Next Revision](/browser/acf-frontend-form-element/trunk/main/helpers.php?rev=3070687 "Revision 3070687") →
* [Blame](/browser/acf-frontend-form-element/trunk/main/helpers.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/acf-frontend-form-element/tags/3.18.15/main/helpers.php)

---

# [source:](/browser?order=name "Go to repository root") [acf-frontend-form-element](/browser/acf-frontend-form-element?order=name "View acf-frontend-form-element")/[tags](/browser/acf-frontend-form-element/tags?order=name "View tags")/[3.18.15](/browser/acf-frontend-form-element/tags/3.18.15?order=name "View 3.18.15")/[main](/browser/acf-frontend-form-element/tags/3.18.15/main?order=name "View main")/[helpers.php](/browser/acf-frontend-form-element/tags/3.18.15/main/helpers.php?order=name "View helpers.php")

View diff against:

View revision:

| [Last change](/changeset/3024107/acf-frontend-form-element/trunk/main/helpers.php "View differences") on this file was [3024107](/changeset/3024107/ "View changeset 3024107"), checked in by shabti, [12 months ago](/timeline?from=2024-01-19T13%3A51%3A00Z&precision=second "See timeline at 01/19/2024 01:51:00 PM") |
| --- |
| * Added validation to file uploads * Fixed frontend block editor field not loading |
| **File size:** 25.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | if ( ! defined( 'ABSPATH' ) ) { |
| [4](#L4) | exit; // Exit if accessed directly. |
| [5](#L5) | } |
| [6](#L6) |  |
| [7](#L7) | if ( ! function\_exists( 'fea\_instance' ) ) { |
| [8](#L8) | function fea\_instance() { |
| [9](#L9) | global $fea\_instance; |
| [10](#L10) |  |
| [11](#L11) | if ( ! isset( $fea\_instance ) ) { |
| [12](#L12) | $fea\_instance = new stdClass(); |
| [13](#L13) | } |
| [14](#L14) |  |
| [15](#L15) | return $fea\_instance; |
| [16](#L16) | } |
| [17](#L17) | } |
| [18](#L18) |  |
| [19](#L19) | function feadmin\_form\_types() { |
| [20](#L20) | $form\_types = array( |
| [21](#L21) | 'general'                                 => \_\_( 'Frontend Form', 'acf-frontend-form-element' ), |
| [22](#L22) | \_\_( 'Post', 'acf-frontend-form-element' ) => array( |
| [23](#L23) | 'new\_post'       => \_\_( 'New Post Form', 'acf-frontend-form-element' ), |
| [24](#L24) | 'edit\_post'      => \_\_( 'Edit Post Form', 'acf-frontend-form-element' ), |
| [25](#L25) | 'duplicate\_post' => \_\_( 'Duplicate Post Form', 'acf-frontend-form-element' ), |
| [26](#L26) | 'delete\_post'    => \_\_( 'Delete Post Button', 'acf-frontend-form-element' ), |
| [27](#L27) | 'status\_post'    => \_\_( 'Post Status Button', 'acf-frontend-form-element' ), |
| [28](#L28) | ), |
| [29](#L29) | \_\_( 'User', 'acf-frontend-form-element' ) => array( |
| [30](#L30) | 'new\_user'    => \_\_( 'New User Form', 'acf-frontend-form-element' ), |
| [31](#L31) | 'edit\_user'   => \_\_( 'Edit User Form', 'acf-frontend-form-element' ), |
| [32](#L32) | 'delete\_user' => \_\_( 'Delete User Button', 'acf-frontend-form-element' ), |
| [33](#L33) | ), |
| [34](#L34) | \_\_( 'Term', 'acf-frontend-form-element' ) => array( |
| [35](#L35) | 'new\_term'    => \_\_( 'New Term Form', 'acf-frontend-form-element' ), |
| [36](#L36) | 'edit\_term'   => \_\_( 'Edit Term Form', 'acf-frontend-form-element' ), |
| [37](#L37) | 'delete\_term' => \_\_( 'Delete Term Button', 'acf-frontend-form-element' ), |
| [38](#L38) | ), |
| [39](#L39) | ); |
| [40](#L40) | $form\_types = apply\_filters( 'frontend\_admin/forms/form\_types', $form\_types ); |
| [41](#L41) |  |
| [42](#L42) | return $form\_types; |
| [43](#L43) | } |
| [44](#L44) |  |
| [45](#L45) | function feadmin\_user\_exists( $id ) { |
| [46](#L46) | global $wpdb; |
| [47](#L47) |  |
| [48](#L48) | $count = $wpdb->get\_var( $wpdb->prepare( "SELECT COUNT(\*) FROM $wpdb->users WHERE ID = %d", $id ) ); |
| [49](#L49) |  |
| [50](#L50) | if ( $count == 1 ) { |
| [51](#L51) | return true; |
| [52](#L52) | } |
| [53](#L53) |  |
| [54](#L54) | return false; |
| [55](#L55) |  |
| [56](#L56) | } |
| [57](#L57) |  |
| [58](#L58) | function feadmin\_get\_field\_data( $type = null, $form\_fields = false ) { |
| [59](#L59) | $field\_types = array(); |
| [60](#L60) | if ( ! $form\_fields ) { |
| [61](#L61) | $GLOBALS['only\_acf\_field\_groups'] = 1; |
| [62](#L62) | } |
| [63](#L63) | $acf\_field\_groups                 = acf\_get\_field\_groups(); |
| [64](#L64) | $GLOBALS['only\_acf\_field\_groups'] = 0; |
| [65](#L65) | // bail early if no field groups |
| [66](#L66) | if ( empty( $acf\_field\_groups ) ) { |
| [67](#L67) | die(); |
| [68](#L68) | } |
| [69](#L69) | // loop through array and add to field 'choices' |
| [70](#L70) | if ( $acf\_field\_groups ) { |
| [71](#L71) | foreach ( $acf\_field\_groups as $field\_group ) { |
| [72](#L72) | if ( ! empty( $field\_group['frontend\_admin\_group'] ) ) { |
| [73](#L73) | continue; |
| [74](#L74) | } |
| [75](#L75) | $field\_group\_fields = acf\_get\_fields( $field\_group['key'] ); |
| [76](#L76) | if ( is\_array( $field\_group\_fields ) ) { |
| [77](#L77) | foreach ( $field\_group\_fields as $acf\_field ) { |
| [78](#L78) | if ( $type ) { |
| [79](#L79) | if ( ( is\_array( $type ) && in\_array( $acf\_field['type'], $type, true ) ) || ( ! is\_array( $type ) && $acf\_field['type'] == $type ) ) { |
| [80](#L80) | $field\_types[ $acf\_field['key'] ] = $acf\_field['label']; |
| [81](#L81) | } |
| [82](#L82) | } else { |
| [83](#L83) | $field\_types[ $acf\_field['key'] ]['type']  = $acf\_field['type']; |
| [84](#L84) | $field\_types[ $acf\_field['key'] ]['label'] = $acf\_field['label']; |
| [85](#L85) | $field\_types[ $acf\_field['key'] ]['name']  = $acf\_field['name']; |
| [86](#L86) | } |
| [87](#L87) | } |
| [88](#L88) | } |
| [89](#L89) | } |
| [90](#L90) | } |
| [91](#L91) | return $field\_types; |
| [92](#L92) | } |
| [93](#L93) |  |
| [94](#L94) | function feadmin\_user\_id\_fields() { |
| [95](#L95) | $fields = feadmin\_get\_acf\_field\_choices( array( 'type' => 'user' ) ); |
| [96](#L96) | $keys    = array\_merge( array( '[author]' => \_\_( 'Post Author', 'acf-frontend-form-element' ) ), $fields ); |
| [97](#L97) | return $keys; |
| [98](#L98) | } |
| [99](#L99) |  |
| [100](#L100) | function feadmin\_get\_user\_roles( $exceptions = array(), $all = false ) { |
| [101](#L101) | if ( ! current\_user\_can( 'administrator' ) ) { |
| [102](#L102) | $exceptions[] = 'administrator'; |
| [103](#L103) | } |
| [104](#L104) |  |
| [105](#L105) | $user\_roles = array(); |
| [106](#L106) |  |
| [107](#L107) | if ( $all ) { |
| [108](#L108) | $user\_roles['all'] = \_\_( 'All', 'acf-frontend-form-element' ); |
| [109](#L109) | } |
| [110](#L110) | global $wp\_roles; |
| [111](#L111) | // loop through array and add to field 'choices' |
| [112](#L112) | foreach ( $wp\_roles->roles as $role => $settings ) { |
| [113](#L113) | if ( ! in\_array( strtolower( $role ), $exceptions ) ) { |
| [114](#L114) | $user\_roles[ $role ] = $settings['name']; |
| [115](#L115) | } |
| [116](#L116) | } |
| [117](#L117) | return $user\_roles; |
| [118](#L118) | } |
| [119](#L119) | function feadmin\_get\_user\_caps( $exceptions = array(), $all = false ) { |
| [120](#L120) | $user\_caps = array(); |
| [121](#L121) |  |
| [122](#L122) | $data = get\_userdata( get\_current\_user\_id() ); |
| [123](#L123) |  |
| [124](#L124) | if ( is\_object( $data ) ) { |
| [125](#L125) | $current\_user\_caps = $data->allcaps; |
| [126](#L126) | foreach ( $current\_user\_caps as $cap => $true ) { |
| [127](#L127) | if ( ! in\_array( strtolower( $cap ), $exceptions ) ) { |
| [128](#L128) | $user\_caps[ $cap ] = $cap; |
| [129](#L129) | } |
| [130](#L130) | } |
| [131](#L131) | } |
| [132](#L132) |  |
| [133](#L133) | return $user\_caps; |
| [134](#L134) | } |
| [135](#L135) |  |
| [136](#L136) | function feadmin\_get\_acf\_group\_choices() { |
| [137](#L137) | $field\_group\_choices = array(); |
| [138](#L138) | $acf\_field\_groups    = acf\_get\_field\_groups(); |
| [139](#L139) | // loop through array and add to field 'choices' |
| [140](#L140) | if ( is\_array( $acf\_field\_groups ) ) { |
| [141](#L141) | foreach ( $acf\_field\_groups as $field\_group ) { |
| [142](#L142) | if ( is\_array( $field\_group ) && ! isset( $field\_group['frontend\_admin\_group'] ) ) { |
| [143](#L143) | $field\_group\_choices[ $field\_group['key'] ] = $field\_group['title']; |
| [144](#L144) | } |
| [145](#L145) | } |
| [146](#L146) | } |
| [147](#L147) | return $field\_group\_choices; |
| [148](#L148) | } |
| [149](#L149) |  |
| [150](#L150) | /\* |
| [151](#L151) | add\_filter('acf/get\_fields', function( $fields, $parent ){ |
| [152](#L152) | $group = explode( 'acfef\_', $parent['key'] ); |
| [153](#L153) |  |
| [154](#L154) | if( empty( $group[1] ) ) return $fields; |
| [155](#L155) |  |
| [156](#L156) | return array(); |
| [157](#L157) | }, 5, 2); |
| [158](#L158) | \*/ |
| [159](#L159) |  |
| [160](#L160) | function feadmin\_get\_acf\_field\_choices( $filter = array(), $return = 'label' ) { |
| [161](#L161) | $all\_fields = array(); |
| [162](#L162) | if ( isset( $filter['groups'] ) ) { |
| [163](#L163) | $acf\_field\_groups = $filter['groups']; |
| [164](#L164) | } else { |
| [165](#L165) | $acf\_field\_groups = acf\_get\_field\_groups( $filter ); |
| [166](#L166) | } |
| [167](#L167) |  |
| [168](#L168) | // bail early if no field groups |
| [169](#L169) | if ( empty( $acf\_field\_groups ) ) { |
| [170](#L170) | return array(); |
| [171](#L171) | } |
| [172](#L172) |  |
| [173](#L173) | foreach ( $acf\_field\_groups as $group ) { |
| [174](#L174) | if ( ! is\_array( $group ) ) { |
| [175](#L175) | $group = acf\_get\_field\_group( $group ); |
| [176](#L176) | } |
| [177](#L177) | if ( ! empty( $field\_group['frontend\_admin\_group'] ) ) { |
| [178](#L178) | continue; |
| [179](#L179) | } |
| [180](#L180) |  |
| [181](#L181) | $group\_fields = acf\_get\_fields( $group ); |
| [182](#L182) |  |
| [183](#L183) | if ( is\_array( $group\_fields ) ) { |
| [184](#L184) | foreach ( $group\_fields as $acf\_field ) { |
| [185](#L185) | if ( ! is\_array( $acf\_field ) ) { |
| [186](#L186) | continue; |
| [187](#L187) | } |
| [188](#L188) |  |
| [189](#L189) | $acf\_field\_key = $acf\_field['type'] == 'clone' ? $acf\_field['\_\_key'] : $acf\_field['key']; |
| [190](#L190) | if ( ! empty( $filter['type'] ) && $filter['type'] == $acf\_field['type'] ) { |
| [191](#L191) | $all\_fields[ $acf\_field['name'] ] = $acf\_field[ $return ]; |
| [192](#L192) | } else { |
| [193](#L193) | if ( isset( $filter['groups'] ) ) { |
| [194](#L194) | $all\_fields[ $acf\_field\_key ] = $acf\_field[ $return ]; |
| [195](#L195) | } else { |
| [196](#L196) | $all\_fields[ $acf\_field\_key ] = $acf\_field[ $return ]; |
| [197](#L197) | } |
| [198](#L198) | } |
| [199](#L199) | } |
| [200](#L200) | } |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | return $all\_fields; |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | function feadmin\_get\_post\_type\_choices() { |
| [207](#L207) | $post\_type\_choices = array(); |
| [208](#L208) | $args              = array(); |
| [209](#L209) | $output            = 'names'; // names or objects, note names is the default |
| [210](#L210) | $operator          = 'and'; // 'and' or 'or' |
| [211](#L211) | $post\_types        = get\_post\_types( $args, $output, $operator ); |
| [212](#L212) | // loop through array and add to field 'choices' |
| [213](#L213) | if ( is\_array( $post\_types ) ) { |
| [214](#L214) | foreach ( $post\_types as $post\_type ) { |
| [215](#L215) | $post\_type\_choices[ $post\_type ] = str\_replace( '\_', ' ', ucfirst( $post\_type ) ); |
| [216](#L216) | } |
| [217](#L217) | } |
| [218](#L218) | return $post\_type\_choices; |
| [219](#L219) | } |
| [220](#L220) |  |
| [221](#L221) | function feadmin\_get\_random\_string( $length = 15 ) { |
| [222](#L222) | $characters       = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; |
| [223](#L223) | $charactersLength = strlen( $characters ); |
| [224](#L224) | $randomString     = ''; |
| [225](#L225) | for ( $i = 0; $i < $length; $i++ ) { |
| [226](#L226) | $randomString .= $characters[ rand( 0, $charactersLength - 1 ) ]; |
| [227](#L227) | } |
| [228](#L228) | return $randomString; |
| [229](#L229) | } |
| [230](#L230) |  |
| [231](#L231) |  |
| [232](#L232) | function feadmin\_get\_client\_ip() { |
| [233](#L233) | $server\_ip\_keys = array( |
| [234](#L234) | 'HTTP\_CLIENT\_IP', |
| [235](#L235) | 'HTTP\_X\_FORWARDED\_FOR', |
| [236](#L236) | 'HTTP\_X\_FORWARDED', |
| [237](#L237) | 'HTTP\_X\_CLUSTER\_CLIENT\_IP', |
| [238](#L238) | 'HTTP\_FORWARDED\_FOR', |
| [239](#L239) | 'HTTP\_FORWARDED', |
| [240](#L240) | 'REMOTE\_ADDR', |
| [241](#L241) | ); |
| [242](#L242) |  |
| [243](#L243) | foreach ( $server\_ip\_keys as $key ) { |
| [244](#L244) | if ( isset( $\_SERVER[ $key ] ) && filter\_var( $\_SERVER[ $key ], FILTER\_VALIDATE\_IP ) ) { |
| [245](#L245) | return esc\_html( $\_SERVER[ $key ] ); |
| [246](#L246) | } |
| [247](#L247) | } |
| [248](#L248) |  |
| [249](#L249) | // Fallback local ip. |
| [250](#L250) | return '127.0.0.1'; |
| [251](#L251) | } |
| [252](#L252) |  |
| [253](#L253) | function feadmin\_get\_site\_domain() { |
| [254](#L254) | return str\_ireplace( 'www.', '', parse\_url( home\_url(), PHP\_URL\_HOST ) ); |
| [255](#L255) | } |
| [256](#L256) |  |
| [257](#L257) |  |
| [258](#L258) |  |
| [259](#L259) | function feadmin\_duplicate\_slug( $prefix = '' ) { |
| [260](#L260) | static $i; |
| [261](#L261) | if ( null === $i ) { |
| [262](#L262) | $i = 2; |
| [263](#L263) | } else { |
| [264](#L264) | $i ++; |
| [265](#L265) | } |
| [266](#L266) | $new\_slug = sprintf( '%s\_copy%s', $prefix, $i ); |
| [267](#L267) | if ( ! feadmin\_slug\_exists( $new\_slug ) ) { |
| [268](#L268) | return $new\_slug; |
| [269](#L269) | } else { |
| [270](#L270) | return feadmin\_duplicate\_slug( $prefix ); |
| [271](#L271) | } |
| [272](#L272) | } |
| [273](#L273) |  |
| [274](#L274) | function feadmin\_slug\_exists( $post\_name ) { |
| [275](#L275) | global $wpdb; |
| [276](#L276) | if ( $wpdb->get\_row( "SELECT post\_name FROM $wpdb->posts WHERE post\_name = '$post\_name'", 'ARRAY\_A' ) ) { |
| [277](#L277) | return true; |
| [278](#L278) | } else { |
| [279](#L279) | return false; |
| [280](#L280) | } |
| [281](#L281) | } |
| [282](#L282) |  |
| [283](#L283) | function feadmin\_sanitize\_input ( $data = false ) { |
| [284](#L284) | if( ! $data ) return $data; |
| [285](#L285) | if( is\_array( $data ) ){ |
| [286](#L286) | return feadmin\_sanitize\_array( $data ); |
| [287](#L287) | }else{ |
| [288](#L288) | return wp\_kses\_post( $data ); |
| [289](#L289) | } |
| [290](#L290) | } |
| [291](#L291) | function feadmin\_sanitize\_array ($data = array()) { |
| [292](#L292) | if (!is\_array($data) || !count($data)) { |
| [293](#L293) | return array(); |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | foreach ($data as $k => $v) { |
| [297](#L297) | if (!is\_array($v) && !is\_object($v)) { |
| [298](#L298) | $v = str\_replace( [ '<[', ']>' ], [ '{-', '-}' ], $v ); |
| [299](#L299) | $v = wp\_kses\_post($v); |
| [300](#L300) | $v = str\_replace( [ '{-', '-}' ], [ '<[', ']>' ], $v ); |
| [301](#L301) | $data[$k] = $v; |
| [302](#L302) | } |
| [303](#L303) | if (is\_array($v)) { |
| [304](#L304) | $data[$k] = feadmin\_sanitize\_array($v); |
| [305](#L305) | } |
| [306](#L306) | } |
| [307](#L307) |  |
| [308](#L308) | return $data; |
| [309](#L309) | } |
| [310](#L310) |  |
| [311](#L311) | function feadmin\_parse\_args( $args, $defaults ) { |
| [312](#L312) | $new\_args = (array) $defaults; |
| [313](#L313) |  |
| [314](#L314) | if ( ! is\_array( $args ) ) { |
| [315](#L315) | return $defaults; |
| [316](#L316) | } |
| [317](#L317) | foreach ( $args as $key => $value ) { |
| [318](#L318) | if ( is\_array( $value ) && isset( $new\_args[ $key ] ) ) { |
| [319](#L319) | $new\_args[ $key ] = feadmin\_parse\_args( $value, $new\_args[ $key ] ); |
| [320](#L320) | } else { |
| [321](#L321) | $new\_args[ $key ] = $value; |
| [322](#L322) | } |
| [323](#L323) | } |
| [324](#L324) |  |
| [325](#L325) | return $new\_args; |
| [326](#L326) | } |
| [327](#L327) |  |
| [328](#L328) | function feadmin\_edit\_mode() { |
| [329](#L329) | $edit\_mode = false; |
| [330](#L330) |  |
| [331](#L331) | if ( ! empty( fea\_instance()->elementor ) ) { |
| [332](#L332) | $edit\_mode = \Elementor\Plugin::$instance->editor->is\_edit\_mode(); |
| [333](#L333) | } |
| [334](#L334) |  |
| [335](#L335) | if ( ! empty( $GLOBALS['admin\_form']['preview\_mode'] ) ) { |
| [336](#L336) | $edit\_mode = true; |
| [337](#L337) | } |
| [338](#L338) |  |
| [339](#L339) | $current\_screen = get\_current\_screen(); |
| [340](#L340) | if ( $current\_screen instanceof WP\_Screen && ! empty( $current\_screen->is\_block\_editor ) ) { |
| [341](#L341) | $edit\_mode = true; |
| [342](#L342) | } |
| [343](#L343) |  |
| [344](#L344) | return $edit\_mode; |
| [345](#L345) | } |
| [346](#L346) |  |
| [347](#L347) | function feadmin\_get\_product\_object() { |
| [348](#L348) | if ( isset( $GLOBALS['admin\_form']['save\_to\_product'] ) ) { |
| [349](#L349) | $form = $GLOBALS['admin\_form']; |
| [350](#L350) |  |
| [351](#L351) | if ( $form['save\_to\_product'] == 'edit\_product' ) { |
| [352](#L352) | return wc\_get\_product( $form['product\_id'] ); |
| [353](#L353) | } |
| [354](#L354) | } |
| [355](#L355) | return false; |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | function feadmin\_get\_field\_type\_groups( $type = 'all' ) { |
| [359](#L359) | $fields = array(); |
| [360](#L360) | if ( $type == 'all' ) { |
| [361](#L361) | $fields['acf']    = array( |
| [362](#L362) | 'label'   => \_\_( 'ACF Field', 'acf-frontend-form-element' ), |
| [363](#L363) | 'options' => array( |
| [364](#L364) | 'ACF\_fields'       => \_\_( 'ACF Fields', 'acf-frontend-form-element' ), |
| [365](#L365) | 'ACF\_field\_groups' => \_\_( 'ACF Field Groups', 'acf-frontend-form-element' ), |
| [366](#L366) | ), |
| [367](#L367) | ); |
| [368](#L368) | $fields['layout'] = array( |
| [369](#L369) | 'label'   => \_\_( 'Layout', 'acf-frontend-form-element' ), |
| [370](#L370) | 'options' => array( |
| [371](#L371) | 'message' => \_\_( 'Message', 'acf-frontend-form-element' ), |
| [372](#L372) | 'column'  => \_\_( 'Column', 'acf-frontend-form-element' ), |
| [373](#L373) | // 'tab'  => \_\_( 'Tab', 'acf-frontend-form-element' ), |
| [374](#L374) | ), |
| [375](#L375) | ); |
| [376](#L376) | } |
| [377](#L377) | if ( $type == 'all' || $type == 'post' ) { |
| [378](#L378) | $fields['post'] = array( |
| [379](#L379) | 'label'   => \_\_( 'Post' ), |
| [380](#L380) | 'options' => array( |
| [381](#L381) | 'title'          => \_\_( 'Post Title', 'acf-frontend-form-element' ), |
| [382](#L382) | 'slug'           => \_\_( 'Slug', 'acf-frontend-form-element' ), |
| [383](#L383) | 'content'        => \_\_( 'Post Content', 'acf-frontend-form-element' ), |
| [384](#L384) | 'featured\_image' => \_\_( 'Featured Image', 'acf-frontend-form-element' ), |
| [385](#L385) | 'excerpt'        => \_\_( 'Post Excerpt', 'acf-frontend-form-element' ), |
| [386](#L386) | 'categories'     => \_\_( 'Categories', 'acf-frontend-form-element' ), |
| [387](#L387) | 'tags'           => \_\_( 'Tags', 'acf-frontend-form-element' ), |
| [388](#L388) | 'author'         => \_\_( 'Post Author', 'acf-frontend-form-element' ), |
| [389](#L389) | 'published\_on'   => \_\_( 'Published On', 'acf-frontend-form-element' ), |
| [390](#L390) | 'post\_type'      => \_\_( 'Post Type', 'acf-frontend-form-element' ), |
| [391](#L391) | 'menu\_order'     => \_\_( 'Menu Order', 'acf-frontend-form-element' ), |
| [392](#L392) | 'allow\_comments' => \_\_( 'Allow Comments', 'acf-frontend-form-element' ), |
| [393](#L393) | 'taxonomy'       => \_\_( 'Custom Taxonomy', 'acf-frontend-form-element' ), |
| [394](#L394) | ), |
| [395](#L395) | ); |
| [396](#L396) | } |
| [397](#L397) | if ( $type == 'all' || $type == 'user' ) { |
| [398](#L398) | $fields['user'] = array( |
| [399](#L399) | 'label'   => \_\_( 'User', 'acf-frontend-form-element' ), |
| [400](#L400) | 'options' => array( |
| [401](#L401) | 'username'         => \_\_( 'Username', 'acf-frontend-form-element' ), |
| [402](#L402) | 'password'         => \_\_( 'Password', 'acf-frontend-form-element' ), |
| [403](#L403) | 'confirm\_password' => \_\_( 'Confirm Password', 'acf-frontend-form-element' ), |
| [404](#L404) | 'email'            => \_\_( 'Email', 'acf-frontend-form-element' ), |
| [405](#L405) | 'first\_name'       => \_\_( 'First Name', 'acf-frontend-form-element' ), |
| [406](#L406) | 'last\_name'        => \_\_( 'Last Name', 'acf-frontend-form-element' ), |
| [407](#L407) | 'nickname'         => \_\_( 'Nickname', 'acf-frontend-form-element' ), |
| [408](#L408) | 'display\_name'     => \_\_( 'Display Name', 'acf-frontend-form-element' ), |
| [409](#L409) | 'bio'              => \_\_( 'Biography', 'acf-frontend-form-element' ), |
| [410](#L410) | 'role'             => \_\_( 'Role', 'acf-frontend-form-element' ), |
| [411](#L411) | ), |
| [412](#L412) | ); |
| [413](#L413) | } |
| [414](#L414) | if ( $type == 'all' || $type == 'term' ) { |
| [415](#L415) |  |
| [416](#L416) | $fields['term'] = array( |
| [417](#L417) | 'label'   => \_\_( 'Term', 'acf-frontend-form-element' ), |
| [418](#L418) | 'options' => array( |
| [419](#L419) | 'term\_name'        => \_\_( 'Term Name', 'acf-frontend-form-element' ), |
| [420](#L420) | 'term\_slug'        => \_\_( 'Term Slug', 'acf-frontend-form-element' ), |
| [421](#L421) | 'term\_description' => \_\_( 'Term Description', 'acf-frontend-form-element' ), |
| [422](#L422) | ), |
| [423](#L423) | ); |
| [424](#L424) | } |
| [425](#L425) |  |
| [426](#L426) | $fields = apply\_filters( 'frontend\_admin/form/elementor/field\_select\_options', $fields, $type ); |
| [427](#L427) |  |
| [428](#L428) | return $fields; |
| [429](#L429) | } |
| [430](#L430) |  |
| [431](#L431) |  |
| [432](#L432) | /\* |
| [433](#L433) | \*  get\_selected\_field |
| [434](#L434) | \* |
| [435](#L435) | \*  This function will return the label for a given clone choice |
| [436](#L436) | \* |
| [437](#L437) | \*  @type    function |
| [438](#L438) | \*  @date    17/06/2016 |
| [439](#L439) | \*  @since   5.3.8 |
| [440](#L440) | \* |
| [441](#L441) | \*  @param   $selector (mixed) |
| [442](#L442) | \*  @return  (string) |
| [443](#L443) | \*/ |
| [444](#L444) |  |
| [445](#L445) | function feadmin\_get\_selected\_field( $selector = '', $type = '' ) { |
| [446](#L446) | // bail early no selector |
| [447](#L447) | if ( ! $selector ) { |
| [448](#L448) | return ''; |
| [449](#L449) | } |
| [450](#L450) |  |
| [451](#L451) | if ( is\_numeric( $selector ) ) { |
| [452](#L452) | return get\_post\_field( 'post\_title', $selector ); |
| [453](#L453) | } |
| [454](#L454) | // ajax\_fields |
| [455](#L455) | if ( isset( $\_POST['fields'][ $selector ] ) ) { |
| [456](#L456) | $selector = sanitize\_text\_field( $\_POST['fields'][ $selector ] ); |
| [457](#L457) | return feadmin\_field\_choice( $selector ); |
| [458](#L458) |  |
| [459](#L459) | } |
| [460](#L460) |  |
| [461](#L461) | // field |
| [462](#L462) | if ( acf\_is\_field\_key( $selector ) ) { |
| [463](#L463) |  |
| [464](#L464) | return feadmin\_field\_choice( acf\_get\_field( $selector ) ); |
| [465](#L465) |  |
| [466](#L466) | } |
| [467](#L467) |  |
| [468](#L468) | // group |
| [469](#L469) | if ( acf\_is\_field\_group\_key( $selector ) ) { |
| [470](#L470) |  |
| [471](#L471) | return feadmin\_group\_choice( acf\_get\_field\_group( $selector ) ); |
| [472](#L472) |  |
| [473](#L473) | } |
| [474](#L474) | if ( feadmin\_is\_admin\_form\_key( $selector ) ) { |
| [475](#L475) |  |
| [476](#L476) | return feadmin\_group\_choice( fea\_instance()->form\_display->get\_form( $selector ) ); |
| [477](#L477) |  |
| [478](#L478) | } |
| [479](#L479) |  |
| [480](#L480) | // return |
| [481](#L481) | return $selector; |
| [482](#L482) |  |
| [483](#L483) | } |
| [484](#L484) | /\* |
| [485](#L485) | \*  feadmin\_field\_choice |
| [486](#L486) | \* |
| [487](#L487) | \*  This function will return the text for a field choice |
| [488](#L488) | \* |
| [489](#L489) | \*  @type    function |
| [490](#L490) | \*  @date    20/07/2016 |
| [491](#L491) | \*  @since   5.4.0 |
| [492](#L492) | \* |
| [493](#L493) | \*  @param   $field (array) |
| [494](#L494) | \*  @return  (string) |
| [495](#L495) | \*/ |
| [496](#L496) |  |
| [497](#L497) | function feadmin\_field\_choice( $field ) { |
| [498](#L498) | // bail early if no field |
| [499](#L499) | if ( ! $field ) { |
| [500](#L500) | return \_\_( 'Unknown field', 'acf' ); |
| [501](#L501) | } |
| [502](#L502) |  |
| [503](#L503) | // title |
| [504](#L504) | $title = $field['label'] ? $field['label'] : \_\_( '(no title)', 'acf' ); |
| [505](#L505) |  |
| [506](#L506) | // append type |
| [507](#L507) | $title .= ' (' . $field['type'] . ')'; |
| [508](#L508) |  |
| [509](#L509) | // ancestors |
| [510](#L510) | // - allow for AJAX to send through ancestors count |
| [511](#L511) | $ancestors = isset( $field['ancestors'] ) ? $field['ancestors'] : count( acf\_get\_field\_ancestors( $field ) ); |
| [512](#L512) | $title     = str\_repeat( '- ', $ancestors ) . $title; |
| [513](#L513) |  |
| [514](#L514) | // return |
| [515](#L515) | return $title; |
| [516](#L516) |  |
| [517](#L517) | } |
| [518](#L518) |  |
| [519](#L519) |  |
| [520](#L520) | /\* |
| [521](#L521) | \*  feadmin\_group\_choice |
| [522](#L522) | \* |
| [523](#L523) | \*  This function will return the text for a group choice |
| [524](#L524) | \* |
| [525](#L525) | \*  @type    function |
| [526](#L526) | \*  @date    20/07/2016 |
| [527](#L527) | \*  @since   5.4.0 |
| [528](#L528) | \* |
| [529](#L529) | \*  @param   $field\_group (array) |
| [530](#L530) | \*  @return  (string) |
| [531](#L531) | \*/ |
| [532](#L532) |  |
| [533](#L533) | function feadmin\_group\_choice( $field\_group ) { |
| [534](#L534) | // bail early if no field group |
| [535](#L535) | if ( ! $field\_group ) { |
| [536](#L536) | return \_\_( 'Unknown field group', 'acf' ); |
| [537](#L537) | } |
| [538](#L538) |  |
| [539](#L539) | // return |
| [540](#L540) | return sprintf( \_\_( 'All fields from %s', 'acf-frontend-form-element' ), $field\_group['title'] ); |
| [541](#L541) |  |
| [542](#L542) | } |
| [543](#L543) |  |
| [544](#L544) | /\* |
| [545](#L545) | \*  get\_selected\_fields |
| [546](#L546) | \* |
| [547](#L547) | \*  This function will return an array of choices data for Select2 |
| [548](#L548) | \* |
| [549](#L549) | \*  @type    function |
| [550](#L550) | \*  @date    17/06/2016 |
| [551](#L551) | \*  @since   5.3.8 |
| [552](#L552) | \* |
| [553](#L553) | \*  @param   $value (mixed) |
| [554](#L554) | \*  @return  (array) |
| [555](#L555) | \*/ |
| [556](#L556) |  |
| [557](#L557) | function feadmin\_get\_selected\_fields( $value, $choices = array() ) { |
| [558](#L558) | // bail early if no $value |
| [559](#L559) | if ( empty( $value ) ) { |
| [560](#L560) | return $choices; |
| [561](#L561) | } |
| [562](#L562) |  |
| [563](#L563) | // force value to array |
| [564](#L564) | $value = acf\_get\_array( $value ); |
| [565](#L565) |  |
| [566](#L566) | // loop |
| [567](#L567) | foreach ( $value as $v ) { |
| [568](#L568) |  |
| [569](#L569) | $choices[ $v ] = feadmin\_get\_selected\_field( $v ); |
| [570](#L570) |  |
| [571](#L571) | } |
| [572](#L572) |  |
| [573](#L573) | // return |
| [574](#L574) | return $choices; |
| [575](#L575) |  |
| [576](#L576) | } |
| [577](#L577) | function feadmin\_is\_admin\_form\_key( $id ) { |
| [578](#L578) | if ( is\_string( $id ) && substr( $id, 0, 5 ) === 'form\_' ) { |
| [579](#L579) | return true; |
| [580](#L580) | } |
| [581](#L581) | return false; |
| [582](#L582) | } |
| [583](#L583) |  |
| [584](#L584) | function feadmin\_form\_choices( $choices = array() ) { |
| [585](#L585) | $args = array( |
| [586](#L586) | 'post\_type'      => 'admin\_form', |
| [587](#L587) | 'posts\_per\_page' => '-1', |
| [588](#L588) | 'post\_status'    => 'any', |
| [589](#L589) | ); |
| [590](#L590) |  |
| [591](#L591) | $forms = get\_posts( $args ); |
| [592](#L592) |  |
| [593](#L593) | if ( empty( $forms ) ) { |
| [594](#L594) | return $choices; |
| [595](#L595) | } |
| [596](#L596) |  |
| [597](#L597) | foreach ( $forms as $form ) { |
| [598](#L598) | $choices[ $form->ID ] = $form->post\_title; |
| [599](#L599) | } |
| [600](#L600) |  |
| [601](#L601) | return $choices; |
| [602](#L602) | } |
| [603](#L603) |  |
| [604](#L604) | /\* |
| [605](#L605) | \* fea\_encrypt |
| [606](#L606) | \* |
| [607](#L607) | \*  This function will encrypt an array using PHP |
| [608](#L608) | \*  https://bhoover.com/using-php-openssl\_encrypt-openssl\_decrypt-encrypt-decrypt-data/ |
| [609](#L609) | \* |
| [610](#L610) | \*  @type    function |
| [611](#L611) | \*  @date    02/11/22 |
| [612](#L612) | \*  @since   3.9.11 |
| [613](#L613) | \* |
| [614](#L614) | \*  @param   $data (array) |
| [615](#L615) | \*  @return  (string) |
| [616](#L616) | \*/ |
| [617](#L617) | function fea\_encrypt( $data = array() ) { |
| [618](#L618) | if ( empty( $data ) ) { |
| [619](#L619) | return false; |
| [620](#L620) | } |
| [621](#L621) |  |
| [622](#L622) | $data = json\_encode( $data ); |
| [623](#L623) |  |
| [624](#L624) | // bail early if no encrypt function |
| [625](#L625) | if ( ! function\_exists( 'openssl\_encrypt' ) ) { |
| [626](#L626) | return base64\_encode( $data ); |
| [627](#L627) | } |
| [628](#L628) |  |
| [629](#L629) | // generate a key |
| [630](#L630) | $key = wp\_hash( 'fea\_encrypt' ); |
| [631](#L631) |  |
| [632](#L632) | // Generate an initialization vector |
| [633](#L633) | $iv = openssl\_random\_pseudo\_bytes( openssl\_cipher\_iv\_length( 'aes-256-cbc' ) ); |
| [634](#L634) |  |
| [635](#L635) | // Encrypt the data using AES 256 encryption in CBC mode using our encryption key and initialization vector. |
| [636](#L636) | $encrypted\_data = openssl\_encrypt( $data, 'aes-256-cbc', $key, 0, $iv ); |
| [637](#L637) |  |
| [638](#L638) | // The $iv is just as important as the key for decrypting, so save it with our encrypted data using a unique separator (::) |
| [639](#L639) | return base64\_encode( $encrypted\_data . '::' . $iv ); |
| [640](#L640) |  |
| [641](#L641) | } |
| [642](#L642) |  |
| [643](#L643) | /\* |
| [644](#L644) | \*  fea\_decrypt |
| [645](#L645) | \* |
| [646](#L646) | \*  This function will decrypt an encrypted string using PHP |
| [647](#L647) | \*  https://bhoover.com/using-php-openssl\_encrypt-openssl\_decrypt-encrypt-decrypt-data/ |
| [648](#L648) | \* |
| [649](#L649) | \*  @type    function |
| [650](#L650) | \*  @date    02/11/22 |
| [651](#L651) | \*  @since   3.9.11 |
| [652](#L652) | \* |
| [653](#L653) | \*  @param   $data (string) |
| [654](#L654) | \*  @return  (array) |
| [655](#L655) | \*/ |
| [656](#L656) |  |
| [657](#L657) | function fea\_decrypt( $data = '' ) { |
| [658](#L658) | if ( empty( $data ) ) { |
| [659](#L659) | return false; |
| [660](#L660) | } |
| [661](#L661) |  |
| [662](#L662) | // bail early if no decrypt function |
| [663](#L663) | if ( ! function\_exists( 'openssl\_decrypt' ) ) { |
| [664](#L664) | return json\_decode( base64\_decode( $data ), true ); |
| [665](#L665) | } |
| [666](#L666) |  |
| [667](#L667) | // generate a key |
| [668](#L668) | $key = wp\_hash( 'fea\_encrypt' ); |
| [669](#L669) |  |
| [670](#L670) | // To decrypt, split the encrypted data from our IV - our unique separator used was "::" |
| [671](#L671) | list($encrypted\_data, $iv) = explode( '::', base64\_decode( $data ), 2 ); |
| [672](#L672) |  |
| [673](#L673) | // decrypt |
| [674](#L674) | $data = openssl\_decrypt( $encrypted\_data, 'aes-256-cbc', $key, 0, $iv ); |
| [675](#L675) |  |
| [676](#L676) | return json\_decode( $data, true ); |
| [677](#L677) |  |
| [678](#L678) | } |
| [679](#L679) |  |
| [680](#L680) | /\*\* |
| [681](#L681) | \* feadmin\_get\_time\_input |
| [682](#L682) | \* |
| [683](#L683) | \* Returns the HTML of a text input. |
| [684](#L684) | \* |
| [685](#L685) | \* @date  3/02/2014 |
| [686](#L686) | \* @since 5.0.0 |
| [687](#L687) | \* |
| [688](#L688) | \* @param  array $attrs The array of attrs. |
| [689](#L689) | \* @return string |
| [690](#L690) | \*/ |
| [691](#L691) | function feadmin\_get\_time\_input( $attrs = array() ) { |
| [692](#L692) | $attrs = wp\_parse\_args( |
| [693](#L693) | $attrs, |
| [694](#L694) | array( |
| [695](#L695) | 'type' => 'time', |
| [696](#L696) | ) |
| [697](#L697) | ); |
| [698](#L698) | if ( isset( $attrs['value'] ) && is\_string( $attrs['value'] ) ) { |
| [699](#L699) | $attrs['value'] = htmlspecialchars( $attrs['value'] ); |
| [700](#L700) | } |
| [701](#L701) | return sprintf( '<input %s/>', feadmin\_get\_esc\_attrs( $attrs ) ); |
| [702](#L702) | } |
| [703](#L703) |  |
| [704](#L704) | /\*\* |
| [705](#L705) | \* Determine whether the current user can edit a given user. |
| [706](#L706) | \* |
| [707](#L707) | \* Only administrators and users with the 'frontend\_admin\_manager' metadata field set to the current user's ID can edit a user. |
| [708](#L708) | \* |
| [709](#L709) | \* @param int $user\_id The ID of the user to check. |
| [710](#L710) | \* @param array $form\_args Additional arguments passed to the function. |
| [711](#L711) | \* @return int|bool The user ID if the user can edit it, or false if they cannot. |
| [712](#L712) | \*/ |
| [713](#L713) | function feadmin\_can\_edit\_user( $user\_id, $form\_args ) { |
| [714](#L714) | // Get the current user object |
| [715](#L715) | $active\_user = wp\_get\_current\_user(); |
| [716](#L716) | $can\_edit = false; |
| [717](#L717) |  |
| [718](#L718) | // Check if the user is logged in and the user ID is set |
| [719](#L719) | if ( isset( $user\_id ) && is\_user\_logged\_in() ) { |
| [720](#L720) | // Check if the current user has the 'administrator' role |
| [721](#L721) | if ( is\_array( $active\_user->roles ) ) { |
| [722](#L722) | if ( in\_array( 'administrator', $active\_user->roles ) ) { |
| [723](#L723) | $can\_edit = $user\_id; |
| [724](#L724) | } |
| [725](#L725) | } |
| [726](#L726) |  |
| [727](#L727) | // Check if the current user is the user being edited, or if the 'frontend\_admin\_manager' metadata field is set to the current user's ID |
| [728](#L728) | if ( $active\_user->ID == $user\_id || get\_user\_meta( $user\_id, 'frontend\_admin\_manager', true ) == $active\_user->ID ) { |
| [729](#L729) | $can\_edit = $user\_id; |
| [730](#L730) | } |
| [731](#L731) | } |
| [732](#L732) |  |
| [733](#L733) | // Return the user ID if the user can edit it, or false if they cannot |
| [734](#L734) | return $can\_edit; |
| [735](#L735) | } |
| [736](#L736) |  |
| [737](#L737) | /\*\* |
| [738](#L738) | \* Determine whether the current user can edit a given post. |
| [739](#L739) | \* |
| [740](#L740) | \* Only administrators and the post author can edit a post. |
| [741](#L741) | \* |
| [742](#L742) | \* @param int $post\_id The ID of the post to check. |
| [743](#L743) | \* @param array $form\_args Additional arguments passed to the function. |
| [744](#L744) | \* @return int|bool The post ID if the user can edit it, or false if they cannot. |
| [745](#L745) | \*/ |
| [746](#L746) | function feadmin\_can\_edit\_post( $post\_id, $form\_args ) { |
| [747](#L747) | // Get the current user object |
| [748](#L748) | $current\_user = wp\_get\_current\_user(); |
| [749](#L749) | $can\_edit    = false; |
| [750](#L750) |  |
| [751](#L751) | // Check if the user is logged in and the post ID is set |
| [752](#L752) | if ( isset( $post\_id ) && is\_user\_logged\_in() ) { |
| [753](#L753) | // Get the post object for the given post ID |
| [754](#L754) | $edited\_post = get\_post( $post\_id ); |
| [755](#L755) |  |
| [756](#L756) | // Check if the current user has the 'administrator' role |
| [757](#L757) | if ( is\_array( $current\_user->roles ) ) { |
| [758](#L758) | if ( in\_array( 'administrator', $current\_user->roles ) ) { |
| [759](#L759) | $can\_edit = $post\_id; |
| [760](#L760) | } else { |
| [761](#L761) | // If the user is not an administrator, check if they are the author of the post |
| [762](#L762) | if ( $current\_user->ID == $edited\_post->post\_author ) { |
| [763](#L763) | $can\_edit = $post\_id; |
| [764](#L764) | } |
| [765](#L765) | } |
| [766](#L766) | } |
| [767](#L767) | } |
| [768](#L768) |  |
| [769](#L769) | // Return the post ID if the user can edit it, or false if they cannot |
| [770](#L770) | return $can\_edit; |
| [771](#L771) | } |
| [772](#L772) |  |
| [773](#L773) | /\* |
| [774](#L774) | \*  feadmin\_verify\_nonce |
| [775](#L775) | \* |
| [776](#L776) | \*  This function will look at the $\_POST['\_acf\_nonce'] value and return true or false |
| [777](#L777) | \* |
| [778](#L778) | \*  @type    function |
| [779](#L779) | \*  @date    15/10/13 |
| [780](#L780) | \*  @since   3.12 |
| [781](#L781) | \* |
| [782](#L782) | \*  @param   $nonce (string) |
| [783](#L783) | \*  @return  (boolean) |
| [784](#L784) | \*/ |
| [785](#L785) |  |
| [786](#L786) | function feadmin\_verify\_nonce( $value ) { |
| [787](#L787) |  |
| [788](#L788) | // vars |
| [789](#L789) | $nonce = acf\_maybe\_get\_POST( '\_acf\_nonce' ); |
| [790](#L790) |  |
| [791](#L791) | // bail early nonce does not match (post|user|comment|term) |
| [792](#L792) | if ( ! $nonce || ! wp\_verify\_nonce( $nonce, $value ) ) { |
| [793](#L793) | return false; |
| [794](#L794) | } |
| [795](#L795) |  |
| [796](#L796) | // reset nonce (only allow 1 save) |
| [797](#L797) | $\_POST['\_acf\_nonce'] = false; |
| [798](#L798) |  |
| [799](#L799) | // return |
| [800](#L800) | return true; |
| [801](#L801) |  |
| [802](#L802) | } |
| [803](#L803) |  |
| [804](#L804) |  |
| [805](#L805) | /\* |
| [806](#L806) | \*  feadmin\_verify\_ajax |
| [807](#L807) | \* |
| [808](#L808) | \*  This function will return true if the current AJAX request is valid |
| [809](#L809) | \*  It's action will also allow WPML to set the lang and avoid AJAX get\_posts issues |
| [810](#L810) | \* |
| [811](#L811) | \*  @type    function |
| [812](#L812) | \*  @date    7/08/2015 |
| [813](#L813) | \*  @since   5.2.3 |
| [814](#L814) | \* |
| [815](#L815) | \*  @param   n/a |
| [816](#L816) | \*  @return  (boolean) |
| [817](#L817) | \*/ |
| [818](#L818) |  |
| [819](#L819) | function feadmin\_verify\_ajax() { |
| [820](#L820) |  |
| [821](#L821) | // bail early if not acf nonce |
| [822](#L822) | if ( empty( $\_REQUEST['nonce'] ) || ! wp\_verify\_nonce( $\_REQUEST['nonce'], 'fea\_nonce' ) ) { |
| [823](#L823) | return false; |
| [824](#L824) | } |
| [825](#L825) |  |
| [826](#L826) | // action for 3rd party customization |
| [827](#L827) | do\_action( 'frontend\_admin/verify\_ajax' ); |
| [828](#L828) |  |
| [829](#L829) | // return |
| [830](#L830) | return true; |
| [831](#L831) | } |
| [832](#L832) |  |
| [833](#L833) | /\*\* |
| [834](#L834) | \* feadmin\_get\_esc\_attrs |
| [835](#L835) | \* |
| [836](#L836) | \* Generated valid HTML from an array of attrs. |
| [837](#L837) | \* |
| [838](#L838) | \* @date    11/6/19 |
| [839](#L839) | \* @since   5.8.1 |
| [840](#L840) | \* |
| [841](#L841) | \* @param   array $attrs The array of attrs. |
| [842](#L842) | \* @return  string |
| [843](#L843) | \*/ |
| [844](#L844) | function feadmin\_get\_esc\_attrs( $attrs ) { |
| [845](#L845) | $html = ''; |
| [846](#L846) |  |
| [847](#L847) | // Loop over attrs and validate data types. |
| [848](#L848) | foreach ( $attrs as $k => $v ) { |
| [849](#L849) |  |
| [850](#L850) | // String (but don't trim value). |
| [851](#L851) | if ( is\_string( $v ) && ( $k !== 'value' ) ) { |
| [852](#L852) | $v = trim( $v ); |
| [853](#L853) |  |
| [854](#L854) | // Boolean |
| [855](#L855) | } elseif ( is\_bool( $v ) ) { |
| [856](#L856) | $v = $v ? 1 : 0; |
| [857](#L857) |  |
| [858](#L858) | // Object |
| [859](#L859) | } elseif ( is\_array( $v ) || is\_object( $v ) ) { |
| [860](#L860) | $v = json\_encode( $v ); |
| [861](#L861) | } |
| [862](#L862) |  |
| [863](#L863) | // Generate HTML. |
| [864](#L864) | $html .= sprintf( ' %s="%s"', esc\_attr( $k ), esc\_attr( $v ) ); |
| [865](#L865) | } |
| [866](#L866) |  |
| [867](#L867) | // Return trimmed. |
| [868](#L868) | return trim( $html ); |
| [869](#L869) | } |
| [870](#L870) |  |
| [871](#L871) |  |
| [872](#L872) | /\* |
| [873](#L873) | \*  feadmin\_encode\_choices |
| [874](#L874) | \* |
| [875](#L875) | \*  description |
| [876](#L876) | \* |
| [877](#L877) | \*  @type    function |
| [878](#L878) | \*  @date    4/06/2014 |
| [879](#L879) | \*  @since   5.0.0 |
| [880](#L880) | \* |
| [881](#L881) | \*  @param   $post\_id (int) |
| [882](#L882) | \*  @return  $post\_id (int) |
| [883](#L883) | \*/ |
| [884](#L884) |  |
| [885](#L885) | function feadmin\_encode\_choices( $array = array(), $show\_keys = true ) { |
| [886](#L886) |  |
| [887](#L887) | // bail early if not array (maybe a single string) |
| [888](#L888) | if ( ! is\_array( $array ) ) { |
| [889](#L889) | return $array; |
| [890](#L890) | } |
| [891](#L891) |  |
| [892](#L892) | // bail early if empty array |
| [893](#L893) | if ( empty( $array ) ) { |
| [894](#L894) | return ''; |
| [895](#L895) | } |
| [896](#L896) |  |
| [897](#L897) | // vars |
| [898](#L898) | $string = ''; |
| [899](#L899) |  |
| [900](#L900) | // if allowed to show keys (good for choices, not for default values) |
| [901](#L901) | if ( $show\_keys ) { |
| [902](#L902) |  |
| [903](#L903) | // loop |
| [904](#L904) | foreach ( $array as $k => $v ) { |
| [905](#L905) |  |
| [906](#L906) | // ignore if key and value are the same |
| [907](#L907) | if ( strval( $k ) == strval( $v ) ) { |
| [908](#L908) | continue; |
| [909](#L909) | } |
| [910](#L910) |  |
| [911](#L911) | // show key in the value |
| [912](#L912) | $array[ $k ] = $k . ' : ' . $v; |
| [913](#L913) |  |
| [914](#L914) | } |
| [915](#L915) | } |
| [916](#L916) |  |
| [917](#L917) | // implode |
| [918](#L918) | $string = implode( "\n", $array ); |
| [919](#L919) |  |
| [920](#L920) | // return |
| [921](#L921) | return $string; |
| [922](#L922) |  |
| [923](#L923) | } |
| [924](#L924) |  |
| [925](#L925) | function feadmin\_decode\_choices( $string = '', $array\_keys = false ) { |
| [926](#L926) |  |
| [927](#L927) | // bail early if already array |
| [928](#L928) | if ( is\_array( $string ) ) { |
| [929](#L929) |  |
| [930](#L930) | return $string; |
| [931](#L931) |  |
| [932](#L932) | // allow numeric values (same as string) |
| [933](#L933) | } elseif ( is\_numeric( $string ) ) { |
| [934](#L934) |  |
| [935](#L935) | // do nothing |
| [936](#L936) |  |
| [937](#L937) | // bail early if not a string |
| [938](#L938) | } elseif ( ! is\_string( $string ) ) { |
| [939](#L939) |  |
| [940](#L940) | return array(); |
| [941](#L941) |  |
| [942](#L942) | // bail early if is empty string |
| [943](#L943) | } elseif ( $string === '' ) { |
| [944](#L944) |  |
| [945](#L945) | return array(); |
| [946](#L946) |  |
| [947](#L947) | } |
| [948](#L948) |  |
| [949](#L949) | // vars |
| [950](#L950) | $array = array(); |
| [951](#L951) |  |
| [952](#L952) | // explode |
| [953](#L953) | $lines = explode( "\n", $string ); |
| [954](#L954) |  |
| [955](#L955) | // key => value |
| [956](#L956) | foreach ( $lines as $line ) { |
| [957](#L957) |  |
| [958](#L958) | // vars |
| [959](#L959) | $k = trim( $line ); |
| [960](#L960) | $v = trim( $line ); |
| [961](#L961) |  |
| [962](#L962) | // look for ' : ' |
| [963](#L963) | if ( feadmin\_str\_exists( ' : ', $line ) ) { |
| [964](#L964) |  |
| [965](#L965) | $line = explode( ' : ', $line ); |
| [966](#L966) |  |
| [967](#L967) | $k = trim( $line[0] ); |
| [968](#L968) | $v = trim( $line[1] ); |
| [969](#L969) |  |
| [970](#L970) | } |
| [971](#L971) |  |
| [972](#L972) | // append |
| [973](#L973) | $array[ $k ] = $v; |
| [974](#L974) |  |
| [975](#L975) | } |
| [976](#L976) |  |
| [977](#L977) | // return only array keys? (good for checkbox default\_value) |
| [978](#L978) | if ( $array\_keys ) { |
| [979](#L979) |  |
| [980](#L980) | return array\_keys( $array ); |
| [981](#L981) |  |
| [982](#L982) | } |
| [983](#L983) |  |
| [984](#L984) | // return |
| [985](#L985) | return $array; |
| [986](#L986) |  |
| [987](#L987) | } |
| [988](#L988) |  |
| [989](#L989) |  |
| [990](#L990) | /\*\* |
| [991](#L991) | \* feadmin\_maybe\_get |
| [992](#L992) | \* |
| [993](#L993) | \* This function will return a var if it exists in an array or a default if set |
| [994](#L994) | \* |
| [995](#L995) | \* @since   5.1.5 |
| [996](#L996) | \* |
| [997](#L997) | \* @param   $array (array) the array to look within |
| [998](#L998) | \* @param   $key (key) the array key to look for. Nested values may be found using '/' |
| [999](#L999) | \* @param   $default (mixed) the value returned if not found |
| [1000](#L1000) | \* @return  $value | $default (mixed) |
| [1001](#L1001) | \*/ |
| [1002](#L1002) | function feadmin\_maybe\_get( $array = array(), $key = 0, $default = null ) { |
| [1003](#L1003) |  |
| [1004](#L1004) | return isset( $array[ $key ] ) ? $array[ $key ] : $default; |
| [1005](#L1005) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/acf-frontend-form-element/tags/3.18.15/main/helpers.php?format=txt)
* [Original Format](/export/3220785/acf-frontend-form-element/tags/3.18.15/main/helpers.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


