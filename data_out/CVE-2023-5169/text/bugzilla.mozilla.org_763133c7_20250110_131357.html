

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1846685)
* [XML](/show_bug.cgi?ctype=xml&id=1846685)

Closed
[Bug 1846685](/show_bug.cgi?id=1846685)
(CVE-2023-5169)

Opened 1 years ago
Closed 1 year ago

# Missing buffer size check in NEXT\_PARAMS

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Missing buffer size check in NEXT\_PARAMS

## Categories

### (Core :: Graphics, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics#Graphics)

Graphics
▾

Core :: Graphics
Mapping of cross platform rendering interfaces to various 2D graphics APIs
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

119 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | [118+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=118%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox117 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix) |
| firefox118 | [+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=fixed) |
| firefox119 | [+](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | 118+ | fixed |
| firefox-esr128 | --- | --- |
| firefox117 |  | wontfix |
| firefox118 | + | fixed |
| firefox119 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sonakkbi, Assigned: bobowen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8877ff082c9a902bbf383dc11c1aeffc?d=mm&size=40)  [bobowen](/user_profile?user_id=458623)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/fbcb684d5cd0458d775e9361e0bd6cb6?d=mm&size=40)  [sonakkbi](/user_profile?user_id=698655)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/17436ade8da1b23d42b3df05b9c4fc77?d=mm&size=40)  [bhood](/user_profile?user_id=697075)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1850064](/show_bug.cgi?id=1850064 "RESOLVED DUPLICATE - AddressSanitizer: heap-buffer-overflow [@ mozilla::gfx::PathOps::StreamToSink] with READ of size 4"), [1850065](/show_bug.cgi?id=1850065 "RESOLVED DUPLICATE - AddressSanitizer: heap-buffer-overflow [@ __asan_memcpy] with READ of size 8")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main118+][adv-esr115.3+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-5169

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main118+][adv-esr115.3+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2979227_1689 "1 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a3198324_488993 "1 year ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [ASAN.txt](/attachment.cgi?id=9346862)  [1 years ago](#c0)  [sonakkbi](/user_profile?user_id=698655)   15.09 KB, text/plain |  | [Details](/attachment.cgi?id=9346862&action=edit) |
| --- | --- | --- |
| [index.html](/attachment.cgi?id=9346863)  [1 years ago](#c1)  [sonakkbi](/user_profile?user_id=698655)   1.56 KB, text/html |  | [Details](/attachment.cgi?id=9346863&action=edit) |
| [patch.diff](/attachment.cgi?id=9346864)  [1 years ago](#c2)  [sonakkbi](/user_profile?user_id=698655)   2.91 KB, patch |  | [Details](/attachment.cgi?id=9346864&action=edit) | [Diff](/attachment.cgi?id=9346864&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1846685&attachment=9346864) |
| [Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!](/attachment.cgi?id=9348888)  [1 year ago](#c6)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   48 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c17 "1 year ago")  pascalc : [approval-mozilla-esr115+](#c19 "1 year ago")  dveditz : [sec-approval+](#c11 "1 year ago") | [Details](/attachment.cgi?id=9348888&action=edit) | [Review](/attachment.cgi?id=9348888) |
| [advisory.txt](/attachment.cgi?id=9354370)  [1 year ago](#c21)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   232 bytes, text/plain |  | [Details](/attachment.cgi?id=9354370&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [sonakkbi](/user_profile?user_id=698655)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1846685#c0)• 1 years ago |
|  | |

Attached file
[ASAN.txt](attachment.cgi?id=9346862)
— [Details](attachment.cgi?id=9346862&action=edit)

|PathOps| is used by graphics rendering. In certain situations, |StreamToSink()|, |TransformedCopy()| and |AsCircle()| are called. They all use |NEXT\_PARAMS| MACRO to parse |PathOps|[1](https://searchfox.org/mozilla-central/source/gfx/2d/PathRecording.cpp#18),[2](https://searchfox.org/mozilla-central/source/gfx/2d/PathRecording.cpp#66),[3](https://searchfox.org/mozilla-central/source/gfx/2d/PathRecording.cpp#115). There is no buffer size check before reading. It leads to out-of-bound Read[4](https://searchfox.org/mozilla-central/source/gfx/2d/PathRecording.cpp#14).

REPRODUCE

Operating System: Windows

1.apply \*patch.diff

2.visit index.html

\*: Patch to emulate a compromised content process.

Crash State: see asan file

Flags: sec-bounty?

|  | [sonakkbi](/user_profile?user_id=698655)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1846685#c1)• 1 years ago |
|  | |

Attached file
[index.html](attachment.cgi?id=9346863)
— [Details](attachment.cgi?id=9346863&action=edit)

|  | [sonakkbi](/user_profile?user_id=698655)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1846685#c2)• 1 years ago |
|  | |

Attached patch

[patch.diff](attachment.cgi?id=9346864&action=diff)
— [Details](attachment.cgi?id=9346864&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1846685&attachment=9346864)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a20272_159069)• 1 years ago |

Group: firefox-core-security → gfx-core-securityComponent: Security → GraphicsProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a455740_406194)• 1 year ago |

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1846685#c3)• 1 year ago |
|  | |

If I'm understanding, this bug allows reading unintentional data into the graphics operation, which I presume then gets turned into the image we're creating. Is there any way to get this data back? You can turn a non-tainted canvas back into an image and then try to read it from that. But the images we return have lossy compression -- how well can specific memory values (which might look like image noise) be recoverable?

I'll call it sec-high for now, but with some doubt about whether this is realistic

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [sonakkbi](/user_profile?user_id=698655)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1846685#c4)• 1 year ago |
|  | |

I believe this is a problem worth contemplating.

Leaked data from |NEXT\_PARAMS| is stored in |aPathSink|(|builder|)'s |mSink| and |mCurrentPoint| [1](https://searchfox.org/mozilla-central/source/gfx/2d/PathRecording.cpp#41),[2](https://searchfox.org/mozilla-central/source/gfx/2d/PathD2D.cpp#141). A point to note is that there appears to be a connection between |PathBuilderD2D|'s |mSink| and |mGeometry| [4](https://searchfox.org/mozilla-central/source/gfx/2d/PathD2D.h#25),[5](https://searchfox.org/mozilla-central/source/gfx/2d/PathD2D.cpp#327). Furthermore, the |mGeometry| and |mCurrentPoint| are stored in |Path|'s |mGeometry| and |mEndPoint| [6](https://searchfox.org/mozilla-central/source/gfx/2d/RecordedEventImpl.h#3117),[7](https://searchfox.org/mozilla-central/source/gfx/2d/PathD2D.cpp#280).

|Path|'s |mGeometry| is used in various renderings of DrawTargetD2D1 [8](https://searchfox.org/mozilla-central/source/gfx/2d/DrawTargetD2D1.cpp#747),[9](https://searchfox.org/mozilla-central/source/gfx/2d/DrawTargetD2D1.cpp#770),[10](https://searchfox.org/mozilla-central/source/gfx/2d/DrawTargetD2D1.cpp#973), and these outcomes are assumed to be stored in |mBitmap| [11](https://searchfox.org/mozilla-central/source/gfx/2d/DrawTargetD2D1.cpp#1483). Additionally, |mBitmap| can be passed to |SourceSurfaceD2D1| [12](https://searchfox.org/mozilla-central/source/gfx/2d/DrawTargetD2D1.cpp#118), and the data of |SourceSurface|, finally, can be sent to the Content Process [13](https://searchfox.org/mozilla-central/source/gfx/layers/RecordedCanvasEventImpl.h#347).

This memory leak, unlike [bug 1846686](/show_bug.cgi?id=1846686 "RESOLVED FIXED - heap memory leak in memory shared with compromised content process due to wrong GetPreparedMap"), is not straightforward and cannot be executed in a single step. Nevertheless, it's important to carefully consider that this vulnerability doesn't cause an immediate crash upon an out-of-bound read; theoretically, and under some assumptions, I think it's worth paying attention to the fact that it gives information to the content process in any form in the end.

Moreover, since not every step has been validated, please take into account the possibility of inaccuracies.

|  | [Kelsey Gilbert [:jgilbert]](/user_profile?user_id=419431) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1846685#c5)• 1 year ago |
|  | |

Can you take a look, Bob?

Flags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a1048310_458623)• 1 year ago |

Assignee: nobody → bobowencodeStatus: UNCONFIRMED → ASSIGNEDEver confirmed: trueFlags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1846685#c6)• 1 year ago |
|  | |

Attached file
[Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!](attachment.cgi?id=9348888)
— [Details](attachment.cgi?id=9348888&action=edit)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1846685#c7)• 1 year ago |
|  | |

The severity field is not set for this bug.

:bhood, could you have a look please?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#workflow.2Fno_severity.py).

Flags: needinfo?(bhood)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a2474306_1689)• 1 year ago |

Duplicate of this bug: [1850065](/show_bug.cgi?id=1850065 "RESOLVED DUPLICATE - AddressSanitizer: heap-buffer-overflow [@ __asan_memcpy] with READ of size 8")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a2474320_1689)• 1 year ago |

Duplicate of this bug: [1850064](/show_bug.cgi?id=1850064 "RESOLVED DUPLICATE - AddressSanitizer: heap-buffer-overflow [@ mozilla::gfx::PathOps::StreamToSink] with READ of size 4")

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1846685#c10)• 1 year ago |
|  | |

Comment on [attachment 9348888](/attachment.cgi?id=9348888 "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") [[details]](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!")

[Bug 1846685](/show_bug.cgi?id=1846685 "RESOLVED FIXED - Missing buffer size check in NEXT_PARAMS"): Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: The issue is fairly obvious, although how it might be triggered is less obvious and would require a content process to be compromised.

  Unclear how much useful information might be extracted.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Unknown
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Fairly unlikely, not a totally trivial patch, but it only adds a relatively small number of extra checks. Most of them in a systematic way though a macro.
* **Is Android affected?**: Unknown
[Attachment #9348888](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") -
Flags: sec-approval?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a2625026_75935)• 1 year ago |

[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=wontfix)
[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected)
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox118](/buglist.cgi?f1=cf_tracking_firefox118&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox118&o1=equals&v1=%2B)
[tracking-firefox119](/buglist.cgi?f1=cf_tracking_firefox119&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox119&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [118+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=118%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1846685#c11)• 1 year ago |
|  | |

Comment on [attachment 9348888](/attachment.cgi?id=9348888 "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") [[details]](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!")

[Bug 1846685](/show_bug.cgi?id=1846685 "RESOLVED FIXED - Missing buffer size check in NEXT_PARAMS"): Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!

sec-approval+ = dveditz

[Attachment #9348888](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") -
Flags: sec-approval? → sec-approval+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1846685#c12)• 1 year ago |
|  | |

Pushed by bobowencode@gmail.com:
<https://hg.mozilla.org/integration/autoland/rev/ee62282ee19c>
Add PathOps::CheckedStreamToSink and use for event playback. r=jrmuizel

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1846685#c13)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/ee62282ee19c>

Group: gfx-core-security → core-security-releaseSeverity: -- → S2Status: ASSIGNED → RESOLVEDClosed: 1 year ago
[status-firefox119](/buglist.cgi?f1=cf_status_firefox119&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox119&o1=equals&v1=fixed)Flags: needinfo?(bhood)Resolution: --- → FIXEDTarget Milestone: --- → 119 Branch

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1846685#c14)• 1 year ago |
|  | |

The patch landed in nightly and beta is affected.

:bobowen, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox118` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1846685#c15)• 1 year ago |
|  | |

Comment on [attachment 9348888](/attachment.cgi?id=9348888 "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") [[details]](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!")

[Bug 1846685](/show_bug.cgi?id=1846685 "RESOLVED FIXED - Missing buffer size check in NEXT_PARAMS"): Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!

### Beta/Release Uplift Approval Request

* **User impact if declined**: Possible information leak from gpu process to compromised content process.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Low as not a totally trivial patch, but it only adds a relatively small number of extra checks. Most of them in a systematic way though a macro.
* **String changes made/needed**: None
* **Is Android affected?**: Unknown
Flags: needinfo?(bobowencode)
[Attachment #9348888](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") -
Flags: approval-mozilla-beta?

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1846685#c16)• 1 year ago |
|  | |

Comment on [attachment 9348888](/attachment.cgi?id=9348888 "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") [[details]](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!")

[Bug 1846685](/show_bug.cgi?id=1846685 "RESOLVED FIXED - Missing buffer size check in NEXT_PARAMS"): Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-high
* **User impact if declined**: Possible information leak from gpu process to compromised content process.
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Low as not a totally trivial patch, but it only adds a relatively small number of extra checks. Most of them in a systematic way though a macro.
[Attachment #9348888](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") -
Flags: approval-mozilla-esr115?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a2979227_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1846685#c17)• 1 year ago |
|  | |

Comment on [attachment 9348888](/attachment.cgi?id=9348888 "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") [[details]](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!")

[Bug 1846685](/show_bug.cgi?id=1846685 "RESOLVED FIXED - Missing buffer size check in NEXT_PARAMS"): Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!

Approved for 118.0b6, thanks.

[Attachment #9348888](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1846685#c18)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/fccdb2cd2d2c>

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a3031933_24572)• 1 year ago |

[status-firefox118](/buglist.cgi?f1=cf_status_firefox118&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox118&o1=equals&v1=fixed)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1846685#c19)• 1 year ago |
|  | |

Comment on [attachment 9348888](/attachment.cgi?id=9348888 "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") [[details]](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!")

[Bug 1846685](/show_bug.cgi?id=1846685 "RESOLVED FIXED - Missing buffer size check in NEXT_PARAMS"): Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!

Approved for ESR 115.3, thanks.

[Attachment #9348888](/attachment.cgi?id=9348888&action=edit "Bug 1846685: Add PathOps::CheckedStreamToSink and use for event playback. r=jgilbert!") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1846685#c20)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/b793da058736>

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a3138834_24572)• 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a3198324_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a4347987_578488)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main118+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1846685#c21)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9354370)
— [Details](attachment.cgi?id=9354370&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a4350786_578488)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main118+] → [reporter-external] [client-bounty-form] [verif?][adv-main118+][adv-esr115.3+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a13394362_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a13399410_1689)• 1 year ago |

Alias: CVE-2023-5169

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1846685#a26132879_5898)• 7 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1846685&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [sonakkbi](/user_profile?user_id=698655)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

