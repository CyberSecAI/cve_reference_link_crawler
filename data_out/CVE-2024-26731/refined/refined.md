The provided content is related to CVE-2024-26731.

**Root cause of vulnerability:**
A null pointer dereference vulnerability exists in the `sk_psock_verdict_data_ready()` function within the Linux kernel's networking subsystem. This occurs due to a race condition between `sk_psock_verdict_data_ready()` and `sk_psock_stop_verdict()`.

**Weaknesses/vulnerabilities present:**
- **Race Condition:** Concurrent calls to `sk_psock_verdict_data_ready()` and `sk_psock_stop_verdict()` can lead to `psock->saved_data_ready` becoming NULL.
- **Null Pointer Dereference:** When `psock->saved_data_ready` is NULL, attempting to dereference it in `sk_psock_verdict_data_ready()` causes a kernel null pointer dereference.

**Impact of exploitation:**
- **Kernel crash:** The null pointer dereference leads to a kernel crash, resulting in a denial-of-service.

**Attack vectors:**
- **Concurrent calls:** The vulnerability is triggered by concurrent calls to `sk_psock_verdict_data_ready()` and `sk_psock_stop_verdict()`.

**Required attacker capabilities/position:**
- An attacker needs the ability to trigger the concurrent execution of the vulnerable functions. This could potentially be achieved via crafted network packets or through local system calls.

**Mitigation:**
The fix involves protecting the access to the `saved_data_ready` pointer with a lock, ensuring that it is not accessed after being freed. The patch introduces the `sk_psock_data_ready` helper function and protects it with `sk->sk_callback_lock`.