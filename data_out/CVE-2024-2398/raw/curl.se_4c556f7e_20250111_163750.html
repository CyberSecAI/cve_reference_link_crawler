<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head> <title>curl - HTTP/2 push headers memory-leak - CVE-2024-2398</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="/curl.css">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" href="/logo/curl-symbol.svg" type="image/svg+xml">
<link rel="alternate" type="application/rss+xml" title="cURL Releases" href="https://github.com/curl/curl/releases.atom">
<link rel="stylesheet" type="text/css" href="/manpage.css">
<style>
code {
    padding: 0px 4px 0px 4px;
    background-color: #f0f0f0;
}
 (prefers-color-scheme: dark) {
    code {
        padding: 0px 4px 0px 4px;
        background-color: #101010;
    }
}
</style>
</head>
<body>
<div class="main">
<div class="menu">
<a href="/docs/" class="menuitem" title="Documentation Overview">Docs Overview</a>
<div class="dropdown">
  <a class="dropbtn" href="/docs/projdocs.html">Project</a>
  <div class="dropdown-content">
    <a href="/docs/bugbounty.html">Bug Bounty</a>
    <a href="/docs/bugs.html">Bug Report</a>
    <a href="/docs/code-of-conduct.html">Code of conduct</a>
    <a href="/docs/libs.html">Dependencies</a>
    <a href="/donation.html">Donate</a>
    <a href="/docs/faq.html">FAQ</a>
    <a href="/docs/features.html">Features</a>
    <a href="/docs/governance.html">Governance</a>
    <a href="/docs/history.html">History</a>
    <a href="/docs/install.html">Install</a>
    <a href="/docs/knownbugs.html">Known Bugs</a>
    <a href="/logo/">Logo</a>
    <a href="/docs/todo.html">TODO</a>
    <a href="/about.html">website Info</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/protdocs.html">Protocols</a>
  <div class="dropdown-content">
    <a href="/docs/caextract.html">CA Extract</a>
    <a href="/docs/http-cookies.html">HTTP cookies</a>
    <a href="/docs/http3.html">HTTP/3</a>
    <a href="/docs/mqtt.html">MQTT</a>
    <a href="/docs/sslcerts.html">SSL certs</a>
    <a href="/docs/ssl-compared.html">SSL libs compared</a>
    <a href="/docs/url-syntax.html">URL syntax</a>
    <a href="/docs/websocket.html">WebSocket</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/reldocs.html">Releases</a>
  <div class="dropdown-content">
    <a href="/ch/">Changelog</a>
    <a href="/docs/security.html">curl CVEs</a>
    <a href="/docs/releases.html">Release Table</a>
    <a href="/docs/versions.html">Version Numbering</a>
    <a href="/docs/vulnerabilities.html">Vulnerabilities</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/tooldocs.html">Tool</a>
  <div class="dropdown-content">
    <a href="/docs/comparison-table.html">Comparison Table</a>
    <a href="/docs/manpage.html">curl man page</a>
    <a href="/docs/httpscripting.html">HTTP Scripting</a>
    <a href="/docs/mk-ca-bundle.html">mk-ca-bundle</a>
    <a href="/docs/tutorial.html">Tutorial</a>
    <a href="optionswhen.html">When options were added</a>
  </div>
</div>
<div class="dropdown">
  <a class="dropbtn" href="/docs/whodocs.html">Who and Why</a>
  <div class="dropdown-content">
    <a href="/docs/companies.html">Companies</a>
    <a href="/docs/copyright.html">Copyright</a>
    <a href="/sponsors.html">Sponsors</a>
    <a href="/docs/thanks.html">Thanks</a>
    <a href="/docs/thename.html">The name</a>
  </div>
</div>
</div>
<div class="contents">
<div class="where"><a href="/">curl</a> / <a href="/docs/">Docs</a> / <a href="/docs/security.html">curl CVEs</a> / <b>HTTP/2 push headers memory-leak</b></div>
<div class="relatedbox">
<b>Related:</b>
<br><a href="audits.html">Audits</a>
<br><a href="/docs/bugbounty.html">Bug Bounty</a>
<br><a href="/ch/">Changelog</a>
<br><a href="security.html">curl CVEs</a>
<br><a href="CVE-2024-2398.json">JSON metadata</a>
<br><a href="https://hackerone.com/reports/2402845">Original report</a>
<br><a href="/dev/vuln-disclosure.html">Vulnerability Disclosure</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<div class="relatedbox">
Awarded 2540 USD<br>
</div>
<h2>CVE-2024-2398</h2>
<h1 id="http2-push-headers-memory-leak">HTTP/2 push headers
memory-leak</h1>
<p>Project curl Security Advisory, March 27 2024 - <a
href="https://curl.se/docs/CVE-2024-2398.html">Permalink</a></p>
<h2 id="vulnerability">VULNERABILITY</h2>
<p>When an application tells libcurl it wants to allow HTTP/2 server
push, and the amount of received headers for the push surpasses the
maximum allowed limit (1000), libcurl aborts the server push. When
aborting, libcurl inadvertently does not free all the previously
allocated headers and instead leaks the memory.</p>
<p>Further, this error condition fails silently and is therefore not
easily detected by an application.</p>
<h2 id="info">INFO</h2>
<p>If a server sends many <code>PUSH_PROMISE</code> frames with an
excessive amount of headers, this can lead to multiple megabytes of
memory leaked <em>per response</em>.</p>
<p>HTTP/2 server push is a relatively rarely used feature.</p>
<p>The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2024-2398 to this issue.</p>
<p>CWE-772: Missing Release of Resource after Effective Lifetime</p>
<p>Severity: Medium</p>
<h2 id="affected-versions">AFFECTED VERSIONS</h2>
<ul>
<li>Affected versions: curl <a href="vuln-7.44.0.html">7.44.0</a> to and including <a href="vuln-8.6.0.html">8.6.0</a></li>
<li>Not affected versions: curl &lt; <a href="vuln-7.44.0.html">7.44.0</a> and &gt;= <a href="vuln-8.7.0.html">8.7.0</a></li>
<li>Introduced-in: <a
href="https://github.com/curl/curl/commit/ea7134ac874a66107e54ff9">https://github.com/curl/curl/commit/ea7134ac874a66107e54ff9</a></li>
</ul>
<p>libcurl is used by many applications, but not always advertised as
such!</p>
<p>This flaw is also accessible using the curl command line tool.</p>
<h2 id="solution">SOLUTION</h2>
<p>Starting in curl <a href="vuln-8.7.0.html">8.7.0</a>, the entire set of headers is freed
appropriately on errors.</p>
<ul>
<li>Fixed-in: <a
href="https://github.com/curl/curl/commit/deca8039991886a559b67bcd6">https://github.com/curl/curl/commit/deca8039991886a559b67bcd6</a></li>
</ul>
<h2 id="recommendations">RECOMMENDATIONS</h2>
<p>A - Upgrade curl to version <a href="vuln-8.7.0.html">8.7.0</a></p>
<p>B - Apply the patch to your local version</p>
<p>C - Make sure HTTP/2 push is not used</p>
<h2 id="timeline">TIMELINE</h2>
<p>This issue was reported to the curl project on March 5, 2024. We
contacted distros@openwall on March 19, 2024.</p>
<p>curl <a href="vuln-8.7.0.html">8.7.0</a> was released on March 27 2024 around 07:00 UTC,
coordinated with the publication of this advisory.</p>
<p>The curl security team is not aware of any active exploits using this
vulnerability.</p>
<h2 id="credits">CREDITS</h2>
<ul>
<li>Reported-by: w0x42 on hackerone</li>
<li>Patched-by: Stefan Eissing</li>
</ul>
<p>Thanks a lot!</p>
</div>
</div>
</body> </html>
