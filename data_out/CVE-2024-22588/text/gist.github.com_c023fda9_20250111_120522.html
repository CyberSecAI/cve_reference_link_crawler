
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2F29a1851c2b2a406411f688735526fe2e)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2F29a1851c2b2a406411f688735526fe2e&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2F29a1851c2b2a406411f688735526fe2e) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2F29a1851c2b2a406411f688735526fe2e&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@QUICTester](https://avatars.githubusercontent.com/u/137782456?s=64&v=4)](/QUICTester)

# [QUICTester](/QUICTester)/**[gist:29a1851c2b2a406411f688735526fe2e](/QUICTester/29a1851c2b2a406411f688735526fe2e)**

Last active
May 26, 2024 02:58

Show Gist options

* [Download ZIP](/QUICTester/29a1851c2b2a406411f688735526fe2e/archive/179fb31b44b60dc20af5933e65d71a21b8bdaa91.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2F29a1851c2b2a406411f688735526fe2e)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2F29a1851c2b2a406411f688735526fe2e)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/QUICTester/29a1851c2b2a406411f688735526fe2e.js&quot;&gt;&lt;/script&gt;
* Save QUICTester/29a1851c2b2a406411f688735526fe2e to your computer and use it in GitHub Desktop.

[Code](/QUICTester/29a1851c2b2a406411f688735526fe2e)
[Revisions
7](/QUICTester/29a1851c2b2a406411f688735526fe2e/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/QUICTester/29a1851c2b2a406411f688735526fe2e.js&quot;&gt;&lt;/script&gt;

Save QUICTester/29a1851c2b2a406411f688735526fe2e to your computer and use it in GitHub Desktop.

[Download ZIP](/QUICTester/29a1851c2b2a406411f688735526fe2e/archive/179fb31b44b60dc20af5933e65d71a21b8bdaa91.zip)

Retention of unused encryption keys in Kwik server.

 [Raw](/QUICTester/29a1851c2b2a406411f688735526fe2e/raw/179fb31b44b60dc20af5933e65d71a21b8bdaa91/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | This Vulnerability was found in Kwik (https://github.com/ptrd/kwik). |
| --- | --- |
|  |  |
|  | Found in commit 745fd4e2d8d104b9cf1e8342d150ff8967c65892 |
|  | Fixed in commit 040b0d1327bfb0a8e35c23c2bd612a4a39b721d4 |
|  |  |
|  | Affected Component: Client-Server QUIC connections. |
|  | Attack Type: Remote |
|  | Impact Denial of Service: True |
|  |  |
|  | Vulnerability details: |
|  | Retention of unused Initial encryption keys in https://github.com/ptrd/kwik (commit 745fd4e) implementation allows attackers to disrupt a connection (DoS) by sending a CONNECTION\_CLOSE frame that is encrypted using the Initial key computed via network traffic sniffing. |
|  | This is because the Initial key is not authenticated as explained in https://www.rfc-editor.org/rfc/rfc9001.html#name-discarding-initial-keys. |
|  |  |
|  | Exploitation steps: |
|  | 1) Attackers must be able to sniff the network traffic. |
|  | 2) Capture the first QUIC packets sent by a QUIC client. |
|  | 3) Compute the Initial encryption key as described in https://www.rfc-editor.org/rfc/rfc9001.html#name-keys |
|  | 4) Send a CONNECTION\_CLOSE frame to the server in an initial packet encrypted using the computed initial encryption key. |
|  | 5) Because the server does not discard the Initial keys, it will decrypt and process the Initial packet sent in (4) even after the QUIC handshake is completed. |
|  |  |
|  | Reference: |
|  | https://github.com/ptrd/kwik/issues/31 |
|  | https://www.rfc-editor.org/rfc/rfc9001#name-discarding-unused-keys |
|  |  |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FQUICTester%2F29a1851c2b2a406411f688735526fe2e)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

