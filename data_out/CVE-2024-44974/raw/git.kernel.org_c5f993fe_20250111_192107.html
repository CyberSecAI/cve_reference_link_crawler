<!DOCTYPE html>
<html lang='en'>
<head>
<title>mptcp: pm: avoid possible UaF when selecting endp - kernel/git/stable/linux.git - Linux kernel stable tree</title>
<meta name='generator' content='cgit 1.2.3-korg'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<script type='text/javascript' src='/cgit-data/cgit.js'></script>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a href='/pub/scm/linux/kernel/git/stable/linux.git/'>kernel/git/stable/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='0201d65d9806d287a00e0ba96f0321835631f63f'/><select name='h' onchange='this.form.submit();'>
<option value='linux-2.6.11.y'>linux-2.6.11.y</option>
<option value='linux-2.6.12.y'>linux-2.6.12.y</option>
<option value='linux-2.6.13.y'>linux-2.6.13.y</option>
<option value='linux-2.6.14.y'>linux-2.6.14.y</option>
<option value='linux-2.6.15.y'>linux-2.6.15.y</option>
<option value='linux-2.6.16.y'>linux-2.6.16.y</option>
<option value='linux-2.6.17.y'>linux-2.6.17.y</option>
<option value='linux-2.6.18.y'>linux-2.6.18.y</option>
<option value='linux-2.6.19.y'>linux-2.6.19.y</option>
<option value='linux-2.6.20.y'>linux-2.6.20.y</option>
<option value='linux-2.6.21.y'>linux-2.6.21.y</option>
<option value='linux-2.6.22.y'>linux-2.6.22.y</option>
<option value='linux-2.6.23.y'>linux-2.6.23.y</option>
<option value='linux-2.6.24.y'>linux-2.6.24.y</option>
<option value='linux-2.6.25.y'>linux-2.6.25.y</option>
<option value='linux-2.6.26.y'>linux-2.6.26.y</option>
<option value='linux-2.6.27.y'>linux-2.6.27.y</option>
<option value='linux-2.6.28.y'>linux-2.6.28.y</option>
<option value='linux-2.6.29.y'>linux-2.6.29.y</option>
<option value='linux-2.6.30.y'>linux-2.6.30.y</option>
<option value='linux-2.6.31.y'>linux-2.6.31.y</option>
<option value='linux-2.6.32.y'>linux-2.6.32.y</option>
<option value='linux-2.6.33.y'>linux-2.6.33.y</option>
<option value='linux-2.6.34.y'>linux-2.6.34.y</option>
<option value='linux-2.6.35.y'>linux-2.6.35.y</option>
<option value='linux-2.6.36.y'>linux-2.6.36.y</option>
<option value='linux-2.6.37.y'>linux-2.6.37.y</option>
<option value='linux-2.6.38.y'>linux-2.6.38.y</option>
<option value='linux-2.6.39.y'>linux-2.6.39.y</option>
<option value='linux-3.0.y'>linux-3.0.y</option>
<option value='linux-3.1.y'>linux-3.1.y</option>
<option value='linux-3.10.y'>linux-3.10.y</option>
<option value='linux-3.11.y'>linux-3.11.y</option>
<option value='linux-3.12.y'>linux-3.12.y</option>
<option value='linux-3.13.y'>linux-3.13.y</option>
<option value='linux-3.14.y'>linux-3.14.y</option>
<option value='linux-3.15.y'>linux-3.15.y</option>
<option value='linux-3.16.y'>linux-3.16.y</option>
<option value='linux-3.17.y'>linux-3.17.y</option>
<option value='linux-3.18.y'>linux-3.18.y</option>
<option value='linux-3.19.y'>linux-3.19.y</option>
<option value='linux-3.2.y'>linux-3.2.y</option>
<option value='linux-3.3.y'>linux-3.3.y</option>
<option value='linux-3.4.y'>linux-3.4.y</option>
<option value='linux-3.5.y'>linux-3.5.y</option>
<option value='linux-3.6.y'>linux-3.6.y</option>
<option value='linux-3.7.y'>linux-3.7.y</option>
<option value='linux-3.8.y'>linux-3.8.y</option>
<option value='linux-3.9.y'>linux-3.9.y</option>
<option value='linux-4.0.y'>linux-4.0.y</option>
<option value='linux-4.1.y'>linux-4.1.y</option>
<option value='linux-4.10.y'>linux-4.10.y</option>
<option value='linux-4.11.y'>linux-4.11.y</option>
<option value='linux-4.12.y'>linux-4.12.y</option>
<option value='linux-4.13.y'>linux-4.13.y</option>
<option value='linux-4.14.y'>linux-4.14.y</option>
<option value='linux-4.15.y'>linux-4.15.y</option>
<option value='linux-4.16.y'>linux-4.16.y</option>
<option value='linux-4.17.y'>linux-4.17.y</option>
<option value='linux-4.18.y'>linux-4.18.y</option>
<option value='linux-4.19.y'>linux-4.19.y</option>
<option value='linux-4.2.y'>linux-4.2.y</option>
<option value='linux-4.20.y'>linux-4.20.y</option>
<option value='linux-4.3.y'>linux-4.3.y</option>
<option value='linux-4.4.y'>linux-4.4.y</option>
<option value='linux-4.5.y'>linux-4.5.y</option>
<option value='linux-4.6.y'>linux-4.6.y</option>
<option value='linux-4.7.y'>linux-4.7.y</option>
<option value='linux-4.8.y'>linux-4.8.y</option>
<option value='linux-4.9.y'>linux-4.9.y</option>
<option value='linux-5.0.y'>linux-5.0.y</option>
<option value='linux-5.1.y'>linux-5.1.y</option>
<option value='linux-5.10.y'>linux-5.10.y</option>
<option value='linux-5.11.y'>linux-5.11.y</option>
<option value='linux-5.12.y'>linux-5.12.y</option>
<option value='linux-5.13.y'>linux-5.13.y</option>
<option value='linux-5.14.y'>linux-5.14.y</option>
<option value='linux-5.15.y'>linux-5.15.y</option>
<option value='linux-5.16.y'>linux-5.16.y</option>
<option value='linux-5.17.y'>linux-5.17.y</option>
<option value='linux-5.18.y'>linux-5.18.y</option>
<option value='linux-5.19.y'>linux-5.19.y</option>
<option value='linux-5.2.y'>linux-5.2.y</option>
<option value='linux-5.3.y'>linux-5.3.y</option>
<option value='linux-5.4.y'>linux-5.4.y</option>
<option value='linux-5.5.y'>linux-5.5.y</option>
<option value='linux-5.6.y'>linux-5.6.y</option>
<option value='linux-5.7.y'>linux-5.7.y</option>
<option value='linux-5.8.y'>linux-5.8.y</option>
<option value='linux-5.9.y'>linux-5.9.y</option>
<option value='linux-6.0.y'>linux-6.0.y</option>
<option value='linux-6.1.y'>linux-6.1.y</option>
<option value='linux-6.10.y'>linux-6.10.y</option>
<option value='linux-6.11.y'>linux-6.11.y</option>
<option value='linux-6.12.y'>linux-6.12.y</option>
<option value='linux-6.2.y'>linux-6.2.y</option>
<option value='linux-6.3.y'>linux-6.3.y</option>
<option value='linux-6.4.y'>linux-6.4.y</option>
<option value='linux-6.5.y'>linux-6.5.y</option>
<option value='linux-6.6.y'>linux-6.6.y</option>
<option value='linux-6.7.y'>linux-6.7.y</option>
<option value='linux-6.8.y'>linux-6.8.y</option>
<option value='linux-6.9.y'>linux-6.9.y</option>
<option value='linux-rolling-lts'>linux-rolling-lts</option>
<option value='linux-rolling-stable'>linux-rolling-stable</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel stable tree</td><td class='sub right'>Stable Group</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/stable/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=0201d65d9806d287a00e0ba96f0321835631f63f'>refs</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0201d65d9806d287a00e0ba96f0321835631f63f'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0201d65d9806d287a00e0ba96f0321835631f63f'>commit</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0201d65d9806d287a00e0ba96f0321835631f63f'>diff</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/stable/linux.git/log/'>
<input type='hidden' name='id' value='0201d65d9806d287a00e0ba96f0321835631f63f'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='0201d65d9806d287a00e0ba96f0321835631f63f'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Matthieu Baerts (NGI0) &lt;matttbe@kernel.org&gt;</td><td class='right'>2024-08-19 21:45:32 +0200</td></tr>
<tr><th>committer</th><td>Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;</td><td class='right'>2024-08-29 17:36:12 +0200</td></tr>
<tr><th>commit</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0201d65d9806d287a00e0ba96f0321835631f63f'>0201d65d9806d287a00e0ba96f0321835631f63f</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=0201d65d9806d287a00e0ba96f0321835631f63f'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=0201d65d9806d287a00e0ba96f0321835631f63f'>1be9b82eec77ed975d0c414b3cc53a1593cd9589</a></td></tr>
<tr><th>parent</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9e0223e3fdf7d52aa33b2b34ff3cbd59fc2db168'>9e0223e3fdf7d52aa33b2b34ff3cbd59fc2db168</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0201d65d9806d287a00e0ba96f0321835631f63f&amp;id2=9e0223e3fdf7d52aa33b2b34ff3cbd59fc2db168'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-0201d65d9806d287a00e0ba96f0321835631f63f.tar.gz'>linux-0201d65d9806d287a00e0ba96f0321835631f63f.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>mptcp: pm: avoid possible UaF when selecting endp</div><div class='commit-msg'>commit 48e50dcbcbaaf713d82bf2da5c16aeced94ad07d upstream.

select_local_address() and select_signal_address() both select an
endpoint entry from the list inside an RCU protected section, but return
a reference to it, to be read later on. If the entry is dereferenced
after the RCU unlock, reading info could cause a Use-after-Free.

A simple solution is to copy the required info while inside the RCU
protected section to avoid any risk of UaF later. The address ID might
need to be modified later to handle the ID0 case later, so a copy seems
OK to deal with.

Reported-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
Closes: https://lore.kernel.org/45cd30d3-7710-491c-ae4d-a1368c00beb1@redhat.com
Fixes: 01cacb00b35c ("mptcp: add netlink-based PM")
Cc: stable@vger.kernel.org
Reviewed-by: Mat Martineau &lt;martineau@kernel.org&gt;
Signed-off-by: Matthieu Baerts (NGI0) &lt;matttbe@kernel.org&gt;
Link: <a href="https://patch.msgid.link/20240819-net-mptcp-pm-reusing-id-v1-14-38035d40de5b@kernel.org">https://patch.msgid.link/20240819-net-mptcp-pm-reusing-id-v1-14-38035d40de5b@kernel.org</a>
Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=0201d65d9806d287a00e0ba96f0321835631f63f'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/net/mptcp/pm_netlink.c?id=0201d65d9806d287a00e0ba96f0321835631f63f'>net/mptcp/pm_netlink.c</a></td><td class='right'>64</td><td class='graph'><table summary='file diffstat' width='64%'><tr><td class='add' style='width: 53.1%;'/><td class='rem' style='width: 46.9%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>1 files changed, 34 insertions, 30 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/net/mptcp/pm_netlink.c b/net/mptcp/pm_netlink.c<br/>index a2e37ab1c40fc6..3e4ad801786f2b 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mptcp/pm_netlink.c?id=9e0223e3fdf7d52aa33b2b34ff3cbd59fc2db168'>net/mptcp/pm_netlink.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/net/mptcp/pm_netlink.c?id=0201d65d9806d287a00e0ba96f0321835631f63f'>net/mptcp/pm_netlink.c</a></div><div class='hunk'>@@ -143,11 +143,13 @@ static bool lookup_subflow_by_daddr(const struct list_head *list,</div><div class='ctx'> 	return false;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-static struct mptcp_pm_addr_entry *</div><div class='add'>+static bool</div><div class='ctx'> select_local_address(const struct pm_nl_pernet *pernet,</div><div class='del'>-		     const struct mptcp_sock *msk)</div><div class='add'>+		     const struct mptcp_sock *msk,</div><div class='add'>+		     struct mptcp_pm_addr_entry *new_entry)</div><div class='ctx'> {</div><div class='del'>-	struct mptcp_pm_addr_entry *entry, *ret = NULL;</div><div class='add'>+	struct mptcp_pm_addr_entry *entry;</div><div class='add'>+	bool found = false;</div><div class='ctx'> </div><div class='ctx'> 	msk_owned_by_me(msk);</div><div class='ctx'> </div><div class='hunk'>@@ -159,17 +161,21 @@ select_local_address(const struct pm_nl_pernet *pernet,</div><div class='ctx'> 		if (!test_bit(entry-&gt;addr.id, msk-&gt;pm.id_avail_bitmap))</div><div class='ctx'> 			continue;</div><div class='ctx'> </div><div class='del'>-		ret = entry;</div><div class='add'>+		*new_entry = *entry;</div><div class='add'>+		found = true;</div><div class='ctx'> 		break;</div><div class='ctx'> 	}</div><div class='ctx'> 	rcu_read_unlock();</div><div class='del'>-	return ret;</div><div class='add'>+</div><div class='add'>+	return found;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='del'>-static struct mptcp_pm_addr_entry *</div><div class='del'>-select_signal_address(struct pm_nl_pernet *pernet, const struct mptcp_sock *msk)</div><div class='add'>+static bool</div><div class='add'>+select_signal_address(struct pm_nl_pernet *pernet, const struct mptcp_sock *msk,</div><div class='add'>+		      struct mptcp_pm_addr_entry *new_entry)</div><div class='ctx'> {</div><div class='del'>-	struct mptcp_pm_addr_entry *entry, *ret = NULL;</div><div class='add'>+	struct mptcp_pm_addr_entry *entry;</div><div class='add'>+	bool found = false;</div><div class='ctx'> </div><div class='ctx'> 	rcu_read_lock();</div><div class='ctx'> 	/* do not keep any additional per socket state, just signal</div><div class='hunk'>@@ -184,11 +190,13 @@ select_signal_address(struct pm_nl_pernet *pernet, const struct mptcp_sock *msk)</div><div class='ctx'> 		if (!(entry-&gt;flags &amp; MPTCP_PM_ADDR_FLAG_SIGNAL))</div><div class='ctx'> 			continue;</div><div class='ctx'> </div><div class='del'>-		ret = entry;</div><div class='add'>+		*new_entry = *entry;</div><div class='add'>+		found = true;</div><div class='ctx'> 		break;</div><div class='ctx'> 	}</div><div class='ctx'> 	rcu_read_unlock();</div><div class='del'>-	return ret;</div><div class='add'>+</div><div class='add'>+	return found;</div><div class='ctx'> }</div><div class='ctx'> </div><div class='ctx'> unsigned int mptcp_pm_get_add_addr_signal_max(const struct mptcp_sock *msk)</div><div class='hunk'>@@ -512,9 +520,10 @@ __lookup_addr(struct pm_nl_pernet *pernet, const struct mptcp_addr_info *info)</div><div class='ctx'> </div><div class='ctx'> static void mptcp_pm_create_subflow_or_signal_addr(struct mptcp_sock *msk)</div><div class='ctx'> {</div><div class='del'>-	struct mptcp_pm_addr_entry *local, *signal_and_subflow = NULL;</div><div class='ctx'> 	struct sock *sk = (struct sock *)msk;</div><div class='add'>+	struct mptcp_pm_addr_entry local;</div><div class='ctx'> 	unsigned int add_addr_signal_max;</div><div class='add'>+	bool signal_and_subflow = false;</div><div class='ctx'> 	unsigned int local_addr_max;</div><div class='ctx'> 	struct pm_nl_pernet *pernet;</div><div class='ctx'> 	unsigned int subflows_max;</div><div class='hunk'>@@ -565,23 +574,22 @@ static void mptcp_pm_create_subflow_or_signal_addr(struct mptcp_sock *msk)</div><div class='ctx'> 		if (msk-&gt;pm.addr_signal &amp; BIT(MPTCP_ADD_ADDR_SIGNAL))</div><div class='ctx'> 			return;</div><div class='ctx'> </div><div class='del'>-		local = select_signal_address(pernet, msk);</div><div class='del'>-		if (!local)</div><div class='add'>+		if (!select_signal_address(pernet, msk, &amp;local))</div><div class='ctx'> 			goto subflow;</div><div class='ctx'> </div><div class='ctx'> 		/* If the alloc fails, we are on memory pressure, not worth</div><div class='ctx'> 		 * continuing, and trying to create subflows.</div><div class='ctx'> 		 */</div><div class='del'>-		if (!mptcp_pm_alloc_anno_list(msk, &amp;local-&gt;addr))</div><div class='add'>+		if (!mptcp_pm_alloc_anno_list(msk, &amp;local.addr))</div><div class='ctx'> 			return;</div><div class='ctx'> </div><div class='del'>-		__clear_bit(local-&gt;addr.id, msk-&gt;pm.id_avail_bitmap);</div><div class='add'>+		__clear_bit(local.addr.id, msk-&gt;pm.id_avail_bitmap);</div><div class='ctx'> 		msk-&gt;pm.add_addr_signaled++;</div><div class='del'>-		mptcp_pm_announce_addr(msk, &amp;local-&gt;addr, false);</div><div class='add'>+		mptcp_pm_announce_addr(msk, &amp;local.addr, false);</div><div class='ctx'> 		mptcp_pm_nl_addr_send_ack(msk);</div><div class='ctx'> </div><div class='del'>-		if (local-&gt;flags &amp; MPTCP_PM_ADDR_FLAG_SUBFLOW)</div><div class='del'>-			signal_and_subflow = local;</div><div class='add'>+		if (local.flags &amp; MPTCP_PM_ADDR_FLAG_SUBFLOW)</div><div class='add'>+			signal_and_subflow = true;</div><div class='ctx'> 	}</div><div class='ctx'> </div><div class='ctx'> subflow:</div><div class='hunk'>@@ -592,26 +600,22 @@ subflow:</div><div class='ctx'> 		bool fullmesh;</div><div class='ctx'> 		int i, nr;</div><div class='ctx'> </div><div class='del'>-		if (signal_and_subflow) {</div><div class='del'>-			local = signal_and_subflow;</div><div class='del'>-			signal_and_subflow = NULL;</div><div class='del'>-		} else {</div><div class='del'>-			local = select_local_address(pernet, msk);</div><div class='del'>-			if (!local)</div><div class='del'>-				break;</div><div class='del'>-		}</div><div class='add'>+		if (signal_and_subflow)</div><div class='add'>+			signal_and_subflow = false;</div><div class='add'>+		else if (!select_local_address(pernet, msk, &amp;local))</div><div class='add'>+			break;</div><div class='ctx'> </div><div class='del'>-		fullmesh = !!(local-&gt;flags &amp; MPTCP_PM_ADDR_FLAG_FULLMESH);</div><div class='add'>+		fullmesh = !!(local.flags &amp; MPTCP_PM_ADDR_FLAG_FULLMESH);</div><div class='ctx'> </div><div class='ctx'> 		msk-&gt;pm.local_addr_used++;</div><div class='del'>-		__clear_bit(local-&gt;addr.id, msk-&gt;pm.id_avail_bitmap);</div><div class='del'>-		nr = fill_remote_addresses_vec(msk, &amp;local-&gt;addr, fullmesh, addrs);</div><div class='add'>+		__clear_bit(local.addr.id, msk-&gt;pm.id_avail_bitmap);</div><div class='add'>+		nr = fill_remote_addresses_vec(msk, &amp;local.addr, fullmesh, addrs);</div><div class='ctx'> 		if (nr == 0)</div><div class='ctx'> 			continue;</div><div class='ctx'> </div><div class='ctx'> 		spin_unlock_bh(&amp;msk-&gt;pm.lock);</div><div class='ctx'> 		for (i = 0; i &lt; nr; i++)</div><div class='del'>-			__mptcp_subflow_connect(sk, &amp;local-&gt;addr, &amp;addrs[i]);</div><div class='add'>+			__mptcp_subflow_connect(sk, &amp;local.addr, &amp;addrs[i]);</div><div class='ctx'> 		spin_lock_bh(&amp;msk-&gt;pm.lock);</div><div class='ctx'> 	}</div><div class='ctx'> 	mptcp_pm_nl_check_work_pending(msk);</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2.3-korg</a> (<a href='https://git-scm.com/'>git 2.43.0</a>) at 2025-01-11 19:19:44 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
