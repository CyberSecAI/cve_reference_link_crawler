<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-V9SYWYG92Y"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-V9SYWYG92Y');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Threat Model &mdash; Cilium 1.18.0-dev documentation</title>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=ef282081" />
    <link rel="stylesheet" type="text/css" href="../../_static/parsed-literal.css?v=519ac8c2" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=378031d3" />
    <link rel="stylesheet" type="text/css" href="../../_static/editbutton.css?v=d53c7333" />
    <link rel="stylesheet" type="text/css" href="../../_static/helm-reference.css?v=2d9e6831" />
    <link rel="stylesheet" type="text/css" href="../../_static/wrapped-table.css?v=bc1f8164" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
  <link rel="stylesheet" href="../../_static/css/docsearch.min.css" type="text/css" />
    <link rel="canonical" href="https://docs.cilium.io/en/latest/security/threat-model.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=001c0e96"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../../_static/js/versionwarning.js?v=d4224a34"></script>
        <script src="../../_static/clipboardjs.min.js?v=bf393c17"></script>
        <script src="../../_static/copybutton.js?v=7c37f673"></script>
    <script src="../../_static/js/theme.js"></script>

    <link rel="stylesheet" href="../../_static/css/github-button.css" type="text/css" />
    <script type="text/javascript" src="../../_static/js/github-button.js"></script>
    <script type="text/javascript" src="../../_static/js/docsearch.min.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Network Observability with Hubble" href="../../observability/hubble/" />
    <link rel="prev" title="Caveats" href="../policy/caveats/" /> 

  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:site" content="@ciliumproject"/>
  <meta name="twitter:title" content="Threat Model &mdash; Cilium 1.18.0-dev documentation"/>
  <meta name="twitter:image" content="../../_static/../../_static/logo.svg"/>
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="cilium" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/security/threat-model/" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav">
  <header class="wy-header">
      <div class="wy-header-left">
          
          
          <a href="https://www.cilium.io" class="wy-header-logo-wrapper">
            
              <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a><span class="wy-github-stars">
            <span class="github-btn github-stargazers github-btn-large">
              <a
                class="gh-btn"
                href="https://github.com/cilium/cilium"
                rel="noopener noreferrer"
                target="_blank"
              >
                <span class="gh-ico" aria-hidden="true"></span>
                <span class="gh-text">GitHub Stars</span>
              </a>
              <a
                class="gh-count"
                href="https://github.com/cilium/cilium/stargazers"
                rel="noopener noreferrer"
                target="_blank"
                aria-label={`${this.state.stars} stargazers on GitHub`}
                style="margin-left: 0px;"
              >
              </a>

              <a
                class="gh-btn"
                href="https://cilium.herokuapp.com/"
                rel="noopener noreferrer"
                target="_blank"
                style="margin-left: 15px;"
              >
                <img style="height: 1em;" src="../../_static/icons/slack.inline.svg" alt="slack_icon">
                <span class="gh-text">Join Slack</span>
            </a>
            </span>
        </span>
    </div>

    <nav class="wy-main-nav">
      <input name="wy-main-nav-checkbox" id="wy-main-nav-checkbox" class="wy-main-nav-checkbox" type="checkbox">
      <label for="wy-main-nav-checkbox" class="wy-main-nav-toggle">Menu</label>
      <ul id="#wy-main-nav-menu" class="wy-main-nav-menu">
        <li><a class="w3-hover-text-blue" href="https://cilium.io/enterprise/">Enterprise</a></li>
        <li>
          <div style="background-color: white; font-size: 16px; font-weight: 600; margin-left: 40px" class="w3-dropdown-hover">
            <button class="w3-button w3-white w3-hover-white w3-hover-text-blue">Learn <span class="triangle">▾</span></button>
            <div class="w3-dropdown-content w3-bar-block w3-card-4">
              <a style = "margin-left: 0px; display: inline-flex;" href="https://cilium.io/labs/categories/getting-started" class="w3-bar-item w3-button w3-hover-white w3-hover-text-blue">
                <img style="height: 1.5em; margin-right: .5em" src="../../_static/icons/labs.inline.svg" alt="labs-icon">
                Labs
              </a>
              <a style = "margin-left: 0px; display: inline-flex;" href="https://cilium.io/get-started" class="w3-bar-item w3-button w3-hover-white w3-hover-text-blue">
                <img style="height: 1.5em; margin-right: .5em" src="../../_static/icons/get-started.inline.svg" alt="get-started-icon">
                Get Started
              </a>
              <a style = "margin-left: 0px; display: inline-flex; padding-right: 10px;" href="https://cilium.io/get-involved" class="w3-bar-item w3-button w3-hover-white w3-hover-text-blue">
                <img style="height: 1.5em; margin-right: .5em" src="../../_static/icons/get-involved.inline.svg" alt="get-involved-icon">
                Get Involved
              </a>
              <a style = "margin-left: 0px; display: inline-flex;" href="https://cilium.io/get-help" class="w3-bar-item w3-button w3-hover-white w3-hover-text-blue">
                <img style="height: 1.5em; margin-right: .5em" src="../../_static/icons/get-help.inline.svg" alt="get-help-icon">
                Get Help
              </a>
            </div>
          </div>

        </li>
        <li>
          <div style="background-color: white; font-size: 16px;font-weight: 600; margin-left: 40px" class="w3-dropdown-hover">
            <button class="w3-button w3-white w3-hover-white w3-hover-text-blue">News and media <span class="triangle">▾</span></i></button>
            <div class="w3-dropdown-content w3-bar-block w3-card-4">
              <a style = "margin-left: 0px; display: inline-flex;" href="https://cilium.io/adopters" class="w3-bar-item w3-button w3-hover-white w3-hover-text-blue">
                <img style="height: 1.5em; margin-right: .5em" src="../../_static/icons/adopters.inline.svg" alt="adopters-icon">
                Adopters
              </a>
              <a style = "margin-left: 0px; display: inline-flex;" href="https://cilium.io/blog" class="w3-bar-item w3-button w3-hover-white w3-hover-text-blue">
                <img style="height: 1.5em; margin-right: .5em" src="../../_static/icons/blog.inline.svg" alt="blog-icon">
                Blog
              </a>
              <a style = "margin-left: 0px; display: inline-flex;" href="https://github.com/cncf/artwork/blob/master/examples/incubating.md#cilium-logos" class="w3-bar-item w3-button w3-hover-white w3-hover-text-blue">
                <img style="height: 1.5em; margin-right: .5em" src="../../_static/icons/branding.inline.svg" alt="branding-icon">
                Branding
              </a>
              <a style = "margin-left: 0px; display: inline-flex;" href="https://cilium.io/newsletter" class="w3-bar-item w3-button w3-hover-white w3-hover-text-blue">
                <img style="height: 1.5em; margin-right: .5em" src="../../_static/icons/newsletter.inline.svg" alt="newsletter-icon">
                Newsletter
              </a>
            </div>
          </div>

        </li>
        <li><a class="w3-hover-text-blue" href="https://docs.cilium.io/en/stable/">Documentation</a></li>
      </ul>
    </nav>
  </header> 
  <div class="wy-grid-for-nav">
    <div class="wy-nav-wrapper" data-toggle="wy-nav-shift" >
        <div class="wy-side-nav-search" >
            <!-- -->
<div role="search">
  <div id="rtd-search-form" class="wy-form">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </div>
</div>
        </div>

      <nav class="wy-nav-side">
      <div class="wy-side-scroll"><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/intro/">Introduction to Cilium &amp; Hubble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/component-overview/">Component Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/k8s-install-default/">Cilium Quick Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/demo/">Getting Started with the Star Wars Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/terminology/">Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/gettinghelp/">Getting Help</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation/taints/">Considerations on Node Pool Taints and Unmanaged Pods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/k8s-install-helm/">Installation using Helm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/k8s-install-migration/">Migrating a cluster to Cilium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/k8s-toc/">Installation with K8s distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/external-toc/">External Installers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Networking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../network/concepts/">Networking Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/kubernetes/">Kubernetes Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/bgp-toc/">BGP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/ebpf/">eBPF Datapath</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/clustermesh/">Multi-cluster Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/external-toc/">External networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/egress-gateway-toc/">Egress Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/servicemesh/">Service Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/vtep/">VXLAN Tunnel Endpoint (VTEP) Integration (beta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/l2-announcements/">L2 Announcements / L2 Aware LB (Beta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/node-ipam/">Node IPAM LB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/pod-mac-address/">Use a Specific MAC Address for a Pod</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../network/multicast/">Multicast Support in Cilium (Beta)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Security</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../">Securing Networks with Cilium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/">Overview of Network Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../policy/">Overview of Network Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../restrict-pod-access/">Restricting privileged Cilium pod access</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Threat Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#scope-and-prerequisites">Scope and Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#methodology">Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference-architecture">Reference Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-threat-surface">The Threat Surface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-threat-model">The Threat Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kubernetes-workload-attacker">Kubernetes Workload Attacker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#recommended-controls">Recommended Controls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#limited-privilege-host-attacker">Limited-privilege Host Attacker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Recommended Controls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#root-equivalent-host-attacker">Root-equivalent Host Attacker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Recommended Controls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#man-in-the-middle-attacker">Man-in-the-middle Attacker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">Recommended Controls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#network-attacker">Network Attacker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Recommended Controls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kubernetes-api-server-attacker">Kubernetes API Server Attacker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">Recommended Controls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cilium-key-value-store-attacker">Cilium Key-value Store Attacker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">Recommended Controls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hubble-data-attacker">Hubble Data Attacker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">Recommended Controls</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#overall-recommendations">Overall Recommendations</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Observability</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../observability/hubble/">Network Observability with Hubble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../observability/grafana/">Running Prometheus &amp; Grafana</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../observability/metrics/">Monitoring &amp; Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../observability/visibility/">Layer 7 Protocol Visibility</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Operations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../operations/system_requirements/">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/upgrade/">Upgrade Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/performance/">Performance &amp; Scalability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/troubleshooting/">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../community/governance/">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/community/">Community Meetings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/community/#slack">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/community/#special-interest-groups">Special Interest Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/roadmap/">Roadmap</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributor Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/development/">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/release/">Release Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/testing/">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/docs/">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../grpcapi/">gRPC API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internals/">Internals</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cheatsheet/">Command Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cmdref/">Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../helm-reference/">Helm Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kvstore/">Key-Value Store</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../further_reading/">Further Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../reference-guides/bpf/">BPF and XDP Reference Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference-guides/xfrm/">XFRM Reference Guide</a></li>
</ul>

        </div>
      </div>
      </nav>
    </div>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Cilium</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Threat Model</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="threat-model">
<h1>Threat Model<a class="headerlink" href="#threat-model" title="Permalink to this heading"></a></h1>
<p>This section presents a threat model for Cilium. This threat model
allows interested parties to understand:</p>
<ul class="simple">
<li><p>security-specific implications of Cilium’s architecture</p></li>
<li><p>controls that are in place to secure data flowing through Cilium’s various components</p></li>
<li><p>recommended controls for running Cilium in a production environment</p></li>
</ul>
<section id="scope-and-prerequisites">
<h2>Scope and Prerequisites<a class="headerlink" href="#scope-and-prerequisites" title="Permalink to this heading"></a></h2>
<p>This threat model considers the possible attacks that could affect an
up-to-date version of Cilium running in a production environment; it
will be refreshed when there are significant changes to Cilium’s
architecture or security posture.</p>
<p>This model does not consider supply-chain attacks, such as attacks where
a malicious contributor is able to intentionally inject vulnerable code
into Cilium. For users who are concerned about supply-chain attacks,
Cilium’s <a class="reference external" href="https://github.com/cilium/cilium.io/blob/main/Security-Reports/CiliumSecurityAudit2022.pdf">security audit</a> assessed Cilium’s supply chain controls
against <a class="reference external" href="https://slsa.dev/">the SLSA framework</a>.</p>
<p>In order to understand the following threat model, readers will need
familiarity with basic Kubernetes concepts, as well as a high-level
understanding of Cilium’s <a class="reference internal" href="../../overview/component-overview/#component-overview"><span class="std std-ref">architecture and components</span></a>.</p>
</section>
<section id="methodology">
<h2>Methodology<a class="headerlink" href="#methodology" title="Permalink to this heading"></a></h2>
<p>This threat model considers eight different types of threat
actors, placed at different parts of a typical deployment stack. We will
primarily use Kubernetes as an example but the threat model remains
accurate if deployed with other orchestration systems, or when running
Cilium outside of Kubernetes. The attackers will have different levels
of initial privileges, giving us a broad overview of the security
guarantees that Cilium can provide depending on the nature of the threat
and the extent of a previous compromise.</p>
<p>For each threat actor, this guide uses the <a class="reference external" href="https://en.wikipedia.org/wiki/STRIDE_(security)">the STRIDE methodology</a> to
assess likely attacks. Where one attack type in the STRIDE set can lead to others
(for example, tampering leading to denial of service), we have described the
attack path under the most impactful attack type. For the potential attacks
that we identify, we recommend controls that can be used to reduce the
risk of the identified attacks compromising a cluster. Applying the
recommended controls is strongly advised in order to run Cilium securely
in production.</p>
</section>
<section id="reference-architecture">
<h2>Reference Architecture<a class="headerlink" href="#reference-architecture" title="Permalink to this heading"></a></h2>
<p>For ease of understanding, consider a single Kubernetes
cluster running Cilium, as illustrated below:</p>
<img alt="../../_images/cilium_threat_model_reference_architecture.png" src="../../_images/cilium_threat_model_reference_architecture.png" />
<section id="the-threat-surface">
<h3>The Threat Surface<a class="headerlink" href="#the-threat-surface" title="Permalink to this heading"></a></h3>
<p>In the above scenario, the aim of Cilium’s security controls is to
ensure that all the components of the Cilium platform are operating
correctly, to the extent possible given the abilities of the threat
actor that Cilium is faced with. The key components that need to be
protected are:</p>
<ul class="simple">
<li><p>the Cilium agent running on a node, either as a Kubernetes pod, a host process, or as an entire virtual machine</p></li>
<li><p>Cilium state (either stored via CRDs or via an external key-value store like etcd)</p></li>
<li><p>eBPF programs loaded by Cilium into the kernel</p></li>
<li><p>network packets managed by Cilium</p></li>
<li><p>observability data collected by Cilium and stored by Hubble</p></li>
</ul>
</section>
</section>
<section id="the-threat-model">
<h2>The Threat Model<a class="headerlink" href="#the-threat-model" title="Permalink to this heading"></a></h2>
<p>For each type of attacker, we consider the plausible types of attacks
available to them, how Cilium can be used to protect against these
attacks, as well as the security controls that Cilium provides. For
attacks which might arise as a consequence of the high level of
privileges required by Cilium, we also suggest mitigations that users
should apply to secure their environments.</p>
<section id="kubernetes-workload-attacker">
<span id="id1"></span><h3>Kubernetes Workload Attacker<a class="headerlink" href="#kubernetes-workload-attacker" title="Permalink to this heading"></a></h3>
<p>For the first scenario, consider an attacker who has been able to
gain access to a Kubernetes pod, and is now able to run arbitrary code
inside a container. This could occur, for example, if a vulnerable
service is exposed externally to a network. In this case, let us also
assume that the compromised pod does not have any elevated privileges
(in Kubernetes or on the host) or direct access to host files.</p>
<img alt="../../_images/cilium_threat_model_workload.png" src="../../_images/cilium_threat_model_workload.png" />
<p>In this scenario, there is no potential for compromise of the Cilium
stack; in fact, Cilium provides several features that would allow users
to limit the scope of such an attack:</p>
<table class="wrapped-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Threat surface</p></th>
<th class="head"><p>Identified STRIDE
threats</p></th>
<th class="head"><p>Cilium security benefits</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cilium agent</p></td>
<td><p>Potential denial of
service if the
compromised</p>
<p>Kubernetes workload
does not have
defined resource
limits.</p>
</td>
<td><p>Cilium can enforce
<a class="reference external" href="https://docs.cilium.io/en/stable/network/kubernetes/bandwidth-manager/">bandwidth limitations</a>
on pods to limit the network
resource utilization.</p></td>
</tr>
<tr class="row-odd"><td><p>Cilium
configuration</p></td>
<td><p>None</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Cilium eBPF
programs</p></td>
<td><p>None</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Network data</p></td>
<td><p>None</p></td>
<td><ul class="simple">
<li><p>Cilium’s network policy can
be used to provide
least-privilege isolation
between Kubernetes
workloads, and between
Kubernetes workloads and
“external” endpoints running
outside the Kubernetes
cluster, or running on the
Kubernetes worker nodes.
Users should ideally define
specific allow rules that
only permit expected
communication between
services.</p></li>
<li><p>Cilium’s network
connectivity will prevent an
attacker from observing the
traffic intended for other
workloads, or sending
traffic that “spoofs” the
identity of another pod,
even if transparent
encryption is not in use.
Pods cannot send traffic
that “spoofs” other pods due
to limits on the use of
source IPs and limits on
sending tunneled traffic.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Observability
data</p></td>
<td><p>None</p></td>
<td><p>Cilium’s Hubble flow-event
observability can be used to
provide reliable audit of
the attacker’s L3/L4 and L7
network connectivity.</p></td>
</tr>
</tbody>
</table>
<section id="recommended-controls">
<h4>Recommended Controls<a class="headerlink" href="#recommended-controls" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>Kubernetes workloads should have <a class="reference external" href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">defined resource limits</a>.
This will help in ensuring that Cilium is not starved of resources due to a misbehaving deployment in a cluster.</p></li>
<li><p>Cilium can be given prioritized access to system resources either via
Kubernetes, cgroups, or other controls.</p></li>
<li><p>Runtime security solutions such as <a class="reference external" href="https://github.com/cilium/tetragon">Tetragon</a> should be deployed to
ensure that container compromises can be detected as they occur.</p></li>
</ul>
</section>
</section>
<section id="limited-privilege-host-attacker">
<span id="id2"></span><h3>Limited-privilege Host Attacker<a class="headerlink" href="#limited-privilege-host-attacker" title="Permalink to this heading"></a></h3>
<p>In this scenario, the attacker is someone with the ability to run
arbitrary code with direct access to the host PID or network namespace
(or both), but without “root” privileges that would allow them to
disable Cilium components or undermine the eBPF and other kernel state
Cilium relies on.</p>
<p>This level of access could exist for a variety of reasons, including:</p>
<ul class="simple">
<li><p>Pods or other containers running in the host PID or network
namespace, but not with “root” privileges. This includes
<code class="docutils literal notranslate"><span class="pre">hostNetwork:</span> <span class="pre">true</span></code> and <code class="docutils literal notranslate"><span class="pre">hostPID:</span> <span class="pre">true</span></code> containers.</p></li>
<li><p>Non-“root” SSH or other console access to a node.</p></li>
<li><p>A containerized workload that has “escaped” the container namespace
but as a non-privileged user.</p></li>
</ul>
<img alt="../../_images/cilium_threat_model_non_privileged.png" src="../../_images/cilium_threat_model_non_privileged.png" />
<p>In this case, an attacker would be able to bypass some of Cilium’s
network controls, as described below:</p>
<table class="wrapped-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Threat
surface</strong></p></th>
<th class="head"><p><strong>Identified STRIDE
threats</strong></p></th>
<th class="head"><p><strong>Cilium security
benefits</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cilium agent</p></td>
<td><ul class="simple">
<li><p>If the non-privileged
attacker is able to
access the container
runtime and Cilium is
running as a
container, the
attacker will be able
to tamper with the
Cilium agent running
on the node.</p></li>
<li><p>Denial of service is
also possible via
spawning workloads
directly on the host.</p></li>
</ul>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Cilium
configuration</p></td>
<td><p>Same as for the Cilium
agent.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Cilium eBPF
programs</p></td>
<td><p>Same as for the Cilium
agent.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Network data</p></td>
<td><p>Elevation of
privilege: traffic
sent by the attacker
will no longer be
subject to Kubernetes
or
container-networked
Cilium network
policies.
<a class="reference internal" href="../host-firewall/#host-firewall"><span class="std std-ref">Host-networked
Cilium
policies</span></a>
will continue to
apply. Other traffic
within the cluster
remains unaffected.</p></td>
<td><p>Cilium’s network
connectivity will prevent
an attacker from observing
the traffic intended for
other workloads, or
sending traffic that
spoofs the identity of
another pod, even if
transparent encryption is
not in use.</p></td>
</tr>
<tr class="row-even"><td><p>Observability
data</p></td>
<td><p>None</p></td>
<td><p>Cilium’s Hubble flow-event
observability can be used
to provide reliable audit
of the attacker’s L3/L4
and L7 network
connectivity. Traffic sent
by the attacker will be
attributed to the worker
node, and not to a
specific Kubernetes
workload.</p></td>
</tr>
</tbody>
</table>
<section id="id3">
<h4>Recommended Controls<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<p>In addition to the recommended controls against the <a class="reference internal" href="#kubernetes-workload-attacker"><span class="std std-ref">Kubernetes Workload Attacker</span></a>:</p>
<ul class="simple">
<li><p>Container images should be regularly patched to reduce the chance of
compromise.</p></li>
<li><p>Minimal container images should be used where possible.</p></li>
<li><p>Host-level privileges should be avoided where possible.</p></li>
<li><p>Ensure that the container users do not have access to the underlying
container runtime.</p></li>
</ul>
</section>
</section>
<section id="root-equivalent-host-attacker">
<span id="id4"></span><h3>Root-equivalent Host Attacker<a class="headerlink" href="#root-equivalent-host-attacker" title="Permalink to this heading"></a></h3>
<p>A “root” privilege host attacker has full privileges to do everything on
the local host. This access could exist for several reasons, including:</p>
<ul class="simple">
<li><p>Root SSH or other console access to the Kubernetes worker node.</p></li>
<li><p>A containerized workload that has escaped the container namespace as
a privileged user.</p></li>
<li><p>Pods running with <code class="docutils literal notranslate"><span class="pre">privileged:</span> <span class="pre">true</span></code> or other significant
capabilities like <code class="docutils literal notranslate"><span class="pre">CAP_SYS_ADMIN</span></code> or <code class="docutils literal notranslate"><span class="pre">CAP_BPF</span></code>.</p></li>
</ul>
<img alt="../../_images/cilium_threat_model_root.png" src="../../_images/cilium_threat_model_root.png" />
<table class="wrapped-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Threat
surface</strong></p></th>
<th class="head"><p><strong>Identified STRIDE threats</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cilium agent</p></td>
<td rowspan="5"><p>In this situation, all potential attacks covered
by STRIDE are possible. Of note:</p>
<ul class="simple">
<li><p>The attacker would be able to disable eBPF on
the node, disabling Cilium’s network and
runtime visibility and enforcement. All
further operations by the attacker will be
unlimited and unaudited.</p></li>
<li><p>The attacker would be able to observe network
connectivity across all workloads on the
host.</p></li>
<li><p>The attacker can spoof traffic from the node
such that it appears to come from pods
with any identity.</p></li>
<li><p>If the physical network allows ARP poisoning,
or if any other attack allows a
compromised node to “attract” traffic
destined to other nodes, the attacker can
potentially intercept all traffic in the
cluster, even if this traffic is encrypted
using IPsec, since we use a cluster-wide
pre-shared key.</p></li>
<li><p>The attacker can also use Cilium’s
credentials to <a class="reference internal" href="#kubernetes-api-server-attacker"><span class="std std-ref">attack the Kubernetes
API server</span></a>,
as well as Cilium’s <a class="reference internal" href="#kv-store-attacker"><span class="std std-ref">etcd key-value
store</span></a> (if in use).</p></li>
<li><p>If the compromised node is running the
<code class="docutils literal notranslate"><span class="pre">cilium-operator</span></code> pod, the attacker
would be able to carry out denial of
service attacks against other nodes using
the <code class="docutils literal notranslate"><span class="pre">cilium-operator</span></code> service account
credentials found on the node.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Cilium
configuration</p></td>
</tr>
<tr class="row-even"><td><p>Cilium eBPF
programs</p></td>
</tr>
<tr class="row-odd"><td><p>Network data</p></td>
</tr>
<tr class="row-even"><td><p>Observability
data</p></td>
</tr>
</tbody>
</table>
<p>This attack scenario emphasizes the importance of securing Kubernetes
nodes, minimizing the permissions available to container workloads, and
monitoring for suspicious activity on the node, container, and API
server levels.</p>
<section id="id5">
<h4>Recommended Controls<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h4>
<p>In addition to the controls against a <a class="reference internal" href="#limited-privilege-host-attacker"><span class="std std-ref">Limited-privilege Host Attacker</span></a>:</p>
<ul class="simple">
<li><p>Workloads with privileged access should be reviewed; privileged access should
only be provided to deployments if essential.</p></li>
<li><p>Network policies should be configured to limit connectivity to workloads with
privileged access.</p></li>
<li><p>Kubernetes audit logging should be enabled, with audit logs being sent to a
centralized external location for automated review.</p></li>
<li><p>Detections should be configured to alert on suspicious activity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cilium-operator</span></code> pods should not be scheduled on nodes that run regular
workloads, and should instead be configured to run on control plane nodes.</p></li>
</ul>
</section>
</section>
<section id="man-in-the-middle-attacker">
<span id="mitm-attacker"></span><h3>Man-in-the-middle Attacker<a class="headerlink" href="#man-in-the-middle-attacker" title="Permalink to this heading"></a></h3>
<p>In this scenario, our attacker has access to the underlying network
between Kubernetes worker nodes, but not the Kubernetes worker nodes
themselves. This attacker may inspect, modify, or inject malicious
network traffic.</p>
<img alt="../../_images/cilium_threat_model_mitm.png" src="../../_images/cilium_threat_model_mitm.png" />
<p>The threat matrix for such an attacker is as follows:</p>
<table class="wrapped-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Threat
surface</strong></p></th>
<th class="head"><p><strong>Identified STRIDE threats</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cilium agent</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Cilium
configuration</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>Cilium eBPF
programs</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Network data</p></td>
<td><ul class="simple">
<li><p>Without transparent encryption, an attacker
could inspect traffic between workloads in both
overlay and native routing modes.</p></li>
<li><p>An attacker with knowledge of pod network
configuration (including pod IP addresses and
ports) could inject traffic into a cluster by
forging packets.</p></li>
<li><p>Denial of service could occur depending on the
behavior of the attacker.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Observability
data</p></td>
<td><ul class="simple">
<li><p>TLS is required for all connectivity between
Cilium components, as well as for exporting
data to other destinations, removing the
scope for spoofing or tampering.</p></li>
<li><p>Without transparent encryption, the attacker
could re-create the observability data as
available on the network level.</p></li>
<li><p>Information leakage could occur via an attacker
scraping Hubble Prometheus metrics. These
metrics are disabled by default, and
can contain sensitive information on network
flows.</p></li>
<li><p>Denial of service could occur depending on the
behavior of the attacker.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<section id="id6">
<h4>Recommended Controls<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../network/encryption/#gsg-encryption"><span class="std std-ref">Transparent Encryption</span></a> should be configured to ensure the confidentiality of
communication between workloads.</p></li>
<li><p>TLS should be configured for communication between the Prometheus
metrics endpoints and the Prometheus server.</p></li>
<li><p>Network policies should be configured such that only the Prometheus
server is allowed to scrape <a class="reference internal" href="../../observability/metrics/#metrics"><span class="std std-ref">Hubble metrics</span></a> in particular.</p></li>
</ul>
</section>
</section>
<section id="network-attacker">
<span id="id7"></span><h3>Network Attacker<a class="headerlink" href="#network-attacker" title="Permalink to this heading"></a></h3>
<p>In our threat model, a generic network attacker has access to the same
underlying IP network as Kubernetes worker nodes, but is not inline
between the nodes. The assumption is that this attacker is still able to
send IP layer traffic that reaches a Kubernetes worker node. This is a
weaker variant of the man-in-the-middle attack described above, as the
attacker can only inject traffic to worker nodes, but not see the
replies.</p>
<img alt="../../_images/cilium_threat_model_network_attacker.png" src="../../_images/cilium_threat_model_network_attacker.png" />
<p>For such an attacker, the threat matrix is as follows:</p>
<table class="wrapped-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Threat
surface</strong></p></th>
<th class="head"><p><strong>Identified STRIDE threats</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cilium agent</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Cilium
configuration</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>Cilium eBPF
programs</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Network data</p></td>
<td><ul class="simple">
<li><p>An attacker with knowledge of pod network
configuration (including pod IP addresses and
ports) could inject traffic into a cluster by
forging packets.</p></li>
<li><p>Denial of service could occur depending on the
behavior of the attacker.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Observability
data</p></td>
<td><ul class="simple">
<li><p>Denial of service could occur depending on the
behavior of the attacker.</p></li>
<li><p>Information leakage could occur via an attacker
scraping Cilium or Hubble Prometheus metrics,
depending on the specific metrics enabled.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<section id="id8">
<h4>Recommended Controls<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../network/encryption/#gsg-encryption"><span class="std std-ref">Transparent Encryption</span></a> should be configured to ensure the confidentiality of
communication between workloads.</p></li>
</ul>
</section>
</section>
<section id="kubernetes-api-server-attacker">
<span id="id9"></span><h3>Kubernetes API Server Attacker<a class="headerlink" href="#kubernetes-api-server-attacker" title="Permalink to this heading"></a></h3>
<p>This type of attack could be carried out by any user or code with
network access to the Kubernetes API server and credentials that allow
Kubernetes API requests. Such permissions would allow the user to read
or manipulate the API server state (for example by changing CRDs).</p>
<p>This section is intended to cover any attack that might be exposed via
Kubernetes API server access, regardless of whether the access is full or
limited.</p>
<img alt="../../_images/cilium_threat_model_api_server_attacker.png" src="../../_images/cilium_threat_model_api_server_attacker.png" />
<p>For such an attacker, our threat matrix is as follows:</p>
<table class="wrapped-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Threat
surface</strong></p></th>
<th class="head"><p><strong>Identified STRIDE threats</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cilium agent</p></td>
<td><ul class="simple">
<li><p>A Kubernetes API user with <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">exec</span></code>
access to the pod running Cilium effectively
becomes a <a class="reference internal" href="#root-equivalent-host-attacker"><span class="std std-ref">root-equivalent host
attacker</span></a>,
since Cilium runs as a privileged pod.</p></li>
<li><p>An attacker with permissions to configure
workload settings effectively becomes a
<a class="reference internal" href="#kubernetes-workload-attacker"><span class="std std-ref">Kubernetes Workload Attacker</span></a>.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Cilium
configuration</p></td>
<td><p>The ability to modify the <code class="docutils literal notranslate"><span class="pre">Cilium*</span></code>
CustomResourceDefinitions, as well as any
CustomResource from Cilium, in the cluster could
have the following effects:</p>
<ul class="simple">
<li><p>The ability to create or modify CiliumIdentity
and CiliumEndpoint or CiliumEndpointSlice
resources would allow an attacker to tamper
with the identities of pods.</p></li>
<li><p>The ability to delete Kubernetes or Cilium
NetworkPolicies would remove policy
enforcement.</p></li>
<li><p>Creating a large number of CiliumIdentity
resources could result in denial of service.</p></li>
<li><p>Workloads external to the cluster could be
added to the network.</p></li>
<li><p>Traffic routing settings between workloads
could be modified</p></li>
</ul>
<p>The cumulative effect of such actions could
result in the escalation of a single-node
compromise into a multi-node compromise.</p>
</td>
</tr>
<tr class="row-even"><td><p>Cilium eBPF
programs</p></td>
<td><p>An attacker with <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">exec</span></code> access to the
Cilium agent pod will be able to modify eBPF
programs.</p></td>
</tr>
<tr class="row-odd"><td><p>Network data</p></td>
<td><p>Privileged Kubernetes API server access (<code class="docutils literal notranslate"><span class="pre">exec</span></code>
access to Cilium pods or access to view
Kubernetes secrets) could allow an attacker to
access the pre-shared key used for IPsec. When
used by a <a class="reference internal" href="#mitm-attacker"><span class="std std-ref">man-in-the-middle
attacker</span></a>, this
could undermine the confidentiality and integrity
of workload communication.
<br> <br>
Depending on the attacker’s level of access, the
ability to spoof identities or tamper with policy
enforcement could also allow them to view network
data.</p></td>
</tr>
<tr class="row-even"><td><p>Observability
data</p></td>
<td><p>Users with permissions to configure workload
settings could cause denial of service.</p></td>
</tr>
</tbody>
</table>
<section id="id10">
<h4>Recommended Controls<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">Kubernetes RBAC</a> should be configured to only grant necessary permissions
to users and service accounts. Access to resources in the <code class="docutils literal notranslate"><span class="pre">kube-system</span></code>
and <code class="docutils literal notranslate"><span class="pre">cilium</span></code> namespaces in particular should be highly limited.</p></li>
<li><p>Kubernetes audit logs should be used to automatically review requests
made to the API server, and detections should be configured to
alert on suspicious activity.</p></li>
</ul>
</section>
</section>
<section id="cilium-key-value-store-attacker">
<span id="kv-store-attacker"></span><h3>Cilium Key-value Store Attacker<a class="headerlink" href="#cilium-key-value-store-attacker" title="Permalink to this heading"></a></h3>
<p>Cilium can use <a class="reference internal" href="../../installation/k8s-install-external-etcd/#k8s-install-etcd"><span class="std std-ref">an external key-value store</span></a>
such as etcd to store state. In this scenario, we consider a user with
network access to the Cilium etcd endpoints and credentials to access
those etcd endpoints. The credentials to the etcd endpoints are stored
as Kubernetes secrets; any attacker would first have to compromise these
secrets before gaining access to the key-value store.</p>
<img alt="../../_images/cilium_threat_model_etcd_attacker.png" src="../../_images/cilium_threat_model_etcd_attacker.png" />
<table class="wrapped-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Threat
surface</strong></p></th>
<th class="head"><p><strong>Identified STRIDE threats</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cilium agent</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Cilium
configuration</p></td>
<td><p>The ability to create or modify Identities or
Endpoints in etcd would allow an attacker to
“give” any pod any identity. The ability to spoof
identities in this manner might be used to
escalate a single node compromise to a multi-node
compromise, for example by spoofing identities to
undermine ingress segmentation rules that would
be applied on remote nodes.</p></td>
</tr>
<tr class="row-even"><td><p>Cilium eBPF
programs</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Network data</p></td>
<td><p>An attacker would be able to modify the routing
of traffic within a cluster, and as a consequence
gain the privileges of a <a class="reference internal" href="#mitm-attacker"><span class="std std-ref">Man-in-the-middle Attacker</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>Observability
data</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<section id="id11">
<h4>Recommended Controls<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">etcd</span></code> instance deployed to store Cilium configuration should be independent
of the instance that is typically deployed as part of configuring a Kubernetes
cluster. This separation reduces the risk of a Cilium <code class="docutils literal notranslate"><span class="pre">etcd</span></code> compromise
leading to further cluster-wide impact.</p></li>
<li><p>Kubernetes RBAC controls should be applied to restrict access to Kubernetes
secrets.</p></li>
<li><p>Kubernetes audit logs should be used to detect access to secret data and
alert if such access is suspicious.</p></li>
</ul>
</section>
</section>
<section id="hubble-data-attacker">
<h3>Hubble Data Attacker<a class="headerlink" href="#hubble-data-attacker" title="Permalink to this heading"></a></h3>
<p>This is an attacker with network reachability to Kubernetes worker
nodes, or other systems that store or expose Hubble data, with the goal
of gaining access to potentially sensitive Hubble flow or process data.</p>
<img alt="../../_images/cilium_threat_model_hubble_attacker.png" src="../../_images/cilium_threat_model_hubble_attacker.png" />
<table class="wrapped-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Threat
surface</strong></p></th>
<th class="head"><p><strong>Identified STRIDE threats</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Cilium pods</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Cilium
configuration</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>Cilium eBPF
programs</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>Network data</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p>Observability
data</p></td>
<td><p>None, assuming correct configuration of the
following:</p>
<ul class="simple">
<li><p>Network policy to limit access to
<code class="docutils literal notranslate"><span class="pre">hubble-relay</span></code> or <code class="docutils literal notranslate"><span class="pre">hubble-ui</span></code> services</p></li>
<li><p>Limited access to <code class="docutils literal notranslate"><span class="pre">cilium</span></code>,
<code class="docutils literal notranslate"><span class="pre">hubble-relay</span></code>, or <code class="docutils literal notranslate"><span class="pre">hubble-ui</span></code> pods</p></li>
<li><p>TLS for external data export</p></li>
<li><p>Security controls at the destination of any
exported data</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<section id="id12">
<h4>Recommended Controls<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>Network policies should limit access to the <code class="docutils literal notranslate"><span class="pre">hubble-relay</span></code> and
<code class="docutils literal notranslate"><span class="pre">hubble-ui</span></code> services</p></li>
<li><p>Kubernetes RBAC should be used to limit access to any <code class="docutils literal notranslate"><span class="pre">cilium-*</span></code>
or <code class="docutils literal notranslate"><span class="pre">hubble-`*</span></code> pods</p></li>
<li><p>TLS should be configured for access to the Hubble Relay API and Hubble UI</p></li>
<li><p>TLS should be correctly configured for any data export</p></li>
<li><p>The destination data stores for exported data should be secured (such
as by applying encryption at rest and cloud provider specific RBAC
controls, for example)</p></li>
</ul>
</section>
</section>
</section>
<section id="overall-recommendations">
<h2>Overall Recommendations<a class="headerlink" href="#overall-recommendations" title="Permalink to this heading"></a></h2>
<p>To summarize the recommended controls to be used when configuring a
production Kubernetes cluster with Cilium:</p>
<ol class="arabic simple">
<li><p>Ensure that Kubernetes roles are scoped correctly to the requirements of your
users, and that service account permissions for pods are tightly scoped to
the needs of the workloads. In particular, access to sensitive namespaces,
<code class="docutils literal notranslate"><span class="pre">exec</span></code> actions, and Kubernetes secrets should all be highly controlled.</p></li>
<li><p>Use resource limits for workloads where possible to reduce the chance of
denial of service attacks.</p></li>
<li><p>Ensure that workload privileges and capabilities are only granted when
essential to the functionality of the workload, and ensure that specific
controls to limit and monitor the behavior of the workload are in place.</p></li>
<li><p>Use <a class="reference internal" href="../policy/#network-policy"><span class="std std-ref">network policies</span></a> to ensure that network traffic in Kubernetes is segregated.</p></li>
<li><p>Use <a class="reference internal" href="../network/encryption/#gsg-encryption"><span class="std std-ref">Transparent Encryption</span></a> in Cilium to ensure that communication between
workloads is secured.</p></li>
<li><p>Enable Kubernetes audit logging, forward the audit logs to a centralized
monitoring platform, and define alerting for suspicious activity.</p></li>
<li><p>Enable TLS for access to any externally-facing services, such as Hubble Relay
and Hubble UI.</p></li>
<li><p>Use <a class="reference external" href="https://github.com/cilium/tetragon">Tetragon</a> as a runtime security solution to rapidly detect unexpected
behavior within your Kubernetes cluster.</p></li>
</ol>
<p>If you have questions, suggestions, or would like to help improve Cilium’s security
posture, reach out to <a class="reference external" href="mailto:security&#37;&#52;&#48;cilium&#46;io">security<span>&#64;</span>cilium<span>&#46;</span>io</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../policy/caveats/" class="btn btn-neutral float-left" title="Caveats" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../observability/hubble/" class="btn btn-neutral float-right" title="Network Observability with Hubble" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Cilium Authors.
      <span class="lastupdated">Last updated on Jan 10, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <script>
    setTimeout(() => {
      docsearch({
        indexName: 'cilium_docs',
        apiKey: 'ebd279472edfb5246bababfd1f324a98',
        appId: 'NR0TQZZ2NG', 
        inputSelector: '#rtd-search-form input, #flyout-search-form input',
        debug: false,
        algoliaOptions: {
          'facetFilters': ['version:']
        }
      });
    }, 0);
  </script>

</body>
</html>