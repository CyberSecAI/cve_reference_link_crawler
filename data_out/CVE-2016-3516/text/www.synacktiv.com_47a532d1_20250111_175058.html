Incorrect verification of user identity
in Oracle Enterprise Communications
Broker

Security advisory
01/02/2016

Nicolas Collignon
Sébastien Dudek

www.synacktiv.com

5 rue Sextius Michel 75015 Paris

Vulnerability description

The Oracle Enterprise Communications Broker

The   Oracle   Enterprise   Communication   Broker   is   a   core   communications   controller   used   to   route   SIP  sessions   across
disparate access and application layer network elements, and simplify complex multivendor VoIP networks.

The issue

Synacktiv has identified a vulnerability in the Oracle Enterprise Communication Broker that allows an attacker to retrieve
sensitive files without being authenticated.

The issue is present in the authentication check made only for the verb GET and unsupported for POST. Tempering this verb
during   a   request,   or   crafting   a   HTTP  request,   an   attacker   is   able   to   retrieve   all   files   present   in  /download/  and  /view/
directories.

Affected versions

The following versions are affected:

•

PCZ2.0.0 MR-2 Patch 1 (Build 209)

Mitigation

Install Oracle Critical Patch Update July 2016.

Timeline

Date

01/02/2016

19/07/2016

Advisory sent to Oracle Security.

Action

Vulnerability fixed in Oracle Critical Patch Update July 2016 / CVE-2016-3516 / S0687773

 2/4

Technical description and Proof-of-Concept

Vulnerability discovery

The management HTTP interface normally allows authenticated users to download a backup of the configuration file as
follows:

Illustration 1: Page that allows users to download the configuration file

When  used   through   the  user   interface,   the  HTTP  request   uses   the  verb   GET  and   includes   a  session   identified   in  the
requested URL:

Illustration 2: HTTP request sent when the user download the configuration file

 3/4

The   application   correctly   checks   the   validity   of   the   session   identifier.   Therefore,   the   access   is   denied   if   no   session   is
provided:

Illustration 3: Access denied since the request does not include a session identifier

However, by changing the HTTP verb from GET to POST, the access control is not performed.

Illustration 4: Unauthenticated access to the configuration file

The following entry points are also concerned:

•

•

•

/download/BACKUP_CONFIG/*

/download/LOGS/*.log

/view/LOGS/*.log

An attacker who is able to reach the Enterprise Communications Broker Web administration console can download sensitive
configuration and log files without being authenticated.

 4/4

