


<!DOCTYPE html>
<html>
    <style>
        body {
            background-color: #525659;
            margin: auto;
            max-width: 8.4in;
        }
        h2 {
            font-size: 15px;
            font-weight: bold;
            text-decoration: underline;
        }
        h3 {
            font-size: 14px;
            font-weight: bold;
            text-decoration: underline;
        }
        h4 {
            font-size: 13px;
            font-weight: normal;
            font-style: italic;
            text-decoration: underline;
        }
    </style>
    <head>
        <title>SSA-313313</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    </head>
    <body>
        



<style>
    h2 {
        font-size: 15px;
        font-weight: bold;
        text-decoration: underline;
    }
    h3 {
        font-size: 14px;
        font-weight: bold;
        text-decoration: underline;
    }
    h4 {
        font-size: 13px;
        font-weight: normal;
        font-style: italic;
        text-decoration: underline;
    }
</style>

<link href="/advisoryeditor/static/advisoryeditor/css/advisory.css" rel="stylesheet">

<div class="page main-page-block">

  <div id="header-section">
<div class="adv-header-div">
  


  <label class="header-label">
    
  </label>
  <label>Siemens Security Advisory by Siemens ProductCERT</label>
  
</div>
</div>

  <div id="details-section">

<div class="title-div" id="title">
  <label id="title-field" class="page-title ">
    <span id="title-lbl">SSA-313313: Denial of Service Vulnerability in the FTP Server of Nucleus RTOS</span>
  </label>
  <table class="details-table">
    <tr>
      <td id="publication-field" >
        Publication Date:
      </td>
      <td>
        <div id="publication-field-id-" >
          <label id="published-lbl">2022-10-11</label>
        </div>
      </td>
    </tr>
    <tr>
      <td id="updated-field" >
        Last Update:
      </td>
      <td>
        <div id="updated-field-id-" >
          <label id="updated-lbl">2023-02-14</label>
        </div>
      </td>
    </tr>
    <tr>
      <td id="version-field" >
        Current Version:
      </td>
      <td id="version-lbl">V1.2</td>
    </tr>

    <tr>
      <td>CVSS v3.1 Base Score:</td>
      <td id="cvss-overal-lbl">7.5</td>
    </tr>

  </table>
</div>


<div class="content-div">
  <label id="summary-field" class="page-h2 ">
    SUMMARY
    
  </label>
  <div>
    <label id="summary-lbl" class="summary-label hyphenate"><p>The FTP server of the networking component (Nucleus NET) in Nucleus Real-Time Operating System (RTOS) does not properly release memory resources that were reserved for incomplete connection attempts by FTP clients. This could allow a remote attacker to generate a denial of service condition on devices that incorporate a vulnerable version of the FTP server.</p>
<p>Siemens has released updates for several affected products and recommends to update to the latest versions. Siemens is preparing further updates and recommends specific countermeasures for products where updates are not, or not yet available.</p></label>
  </div>
</div>


</div>


  <div id="affected-products-section">



<div id="affected-products-solutions" class="content-div">
  <label id="affected-products-field-id-bulk"
        class="page-h2 ">
    AFFECTED PRODUCTS AND SOLUTION
  </label>

  <table class="affected-product-table">
    <tr>
      <th scope="col">Affected Product and Versions</th>
      <th scope="col">Remediation</th>
    </tr>
    
      
        
<tr >
   
  <td >
            

    <label class="affected-product-name ">
      <a >
          Nucleus NET for Nucleus PLUS V1</a>
    </label>
    <br/><span style="color: gray;">All versions &lt; V5.2a</span>

    

    

    
  </td>

  
  <td class="hyphenate">
    

    <div>
    
    
      
        <div 
                class=" affected-products-elm">
          Update to V5.2a as available in Nucleus PLUS V1.15 and apply the patch "v2022.11"
        </div>
      
      
      
        <label class="affected-product-item-lbl">
          <a href="https://support.sw.siemens.com/en-US/product/852852095/">https://support.sw.siemens.com/en-US/product/852852095/</a>
        </label>
      
    

    
    
    </div>

    
      <label class="affected-product-item-lbl ap-general-recommendation-lbl">
        See further recommendations from section
        <a href="#mitigations-section">Workarounds and Mitigations</a>
      </label>
    

  </td>
</tr>
      
        
<tr >
   
  <td >
            

    <label class="affected-product-name ">
      <a >
          Nucleus NET for Nucleus PLUS V2</a>
    </label>
    <br/><span style="color: gray;">All versions &lt; V5.4</span>

    

    

    
  </td>

  
  <td class="hyphenate">
    

    <div>
    
    
      
        <div 
                class=" affected-products-elm">
          Update to V5.4 as available in Nucleus PLUS V2.1f and apply the patch "v2022.11"
        </div>
      
      
      
        <label class="affected-product-item-lbl">
          <a href="https://support.sw.siemens.com/en-US/product/852852095/">https://support.sw.siemens.com/en-US/product/852852095/</a>
        </label>
      
    

    
    
    </div>

    
      <label class="affected-product-item-lbl ap-general-recommendation-lbl">
        See further recommendations from section
        <a href="#mitigations-section">Workarounds and Mitigations</a>
      </label>
    

  </td>
</tr>
      
        
<tr >
   
  <td >
            

    <label class="affected-product-name ">
      <a >
          Nucleus ReadyStart V3 V2012</a>
    </label>
    <br/><span style="color: gray;">All versions &lt; V2012.08.1</span>

    

    

    
  </td>

  
  <td class="hyphenate">
    

    <div>
    
    
      
        <div 
                class=" affected-products-elm">
          Update to V2012.08.1 and apply the patch "v2022.11"
        </div>
      
      
      
        <label class="affected-product-item-lbl">
          <a href="https://support.sw.siemens.com/en-US/product/1009925838/">https://support.sw.siemens.com/en-US/product/1009925838/</a>
        </label>
      
    

    
    
    </div>

    
      <label class="affected-product-item-lbl ap-general-recommendation-lbl">
        See further recommendations from section
        <a href="#mitigations-section">Workarounds and Mitigations</a>
      </label>
    

  </td>
</tr>
      
        
<tr >
   
  <td >
            

    <label class="affected-product-name ">
      <a >
          Nucleus ReadyStart V3 V2017</a>
    </label>
    <br/><span style="color: gray;">All versions &lt; V2017.02.4</span>

    

    

    
  </td>

  
  <td class="hyphenate">
    

    <div>
    
    
      
        <div 
                class=" affected-products-elm">
          Update to V2017.02.4 and apply the patch "2017.02.4_patch_CVE-2022-38371"
        </div>
      
      
      
        <label class="affected-product-item-lbl">
          <a href="https://support.sw.siemens.com/en-US/product/1009925838/">https://support.sw.siemens.com/en-US/product/1009925838/</a>
        </label>
      
    

    
    
    </div>

    
      <label class="affected-product-item-lbl ap-general-recommendation-lbl">
        See further recommendations from section
        <a href="#mitigations-section">Workarounds and Mitigations</a>
      </label>
    

  </td>
</tr>
      
        
<tr >
   
  <td >
            

    <label class="affected-product-name ">
      <a >
          Nucleus Source Code</a>
    </label>
    <br/><span style="color: gray;">Versions including affected FTP server</span>

    

    

    
  </td>

  
  <td class="hyphenate">
    

    <div>
    
    
      
        <div 
                class=" affected-products-elm">
          Contact customer support to receive patch and update information
        </div>
      
      
      
    

    
    
    </div>

    
      <label class="affected-product-item-lbl ap-general-recommendation-lbl">
        See further recommendations from section
        <a href="#mitigations-section">Workarounds and Mitigations</a>
      </label>
    

  </td>
</tr>
      
    
  </table>
</div>
</div>

  <div id="mitigations-section">

<div id="mitigations" class="content-div">
  <label class="page-h2">
    <label id="workarounds-field" >WORKAROUNDS</label>
    AND
    <label id="mitigations-field" >MITIGATIONS</label>
  </label>
  
    <label>
        <p>Siemens has identified the following specific workarounds and mitigations that customers can apply to reduce the risk:</p>
    </label>
    <ul class="mitigation-text mitigation-ul">
      
      
        <li >
          Configure <code>TCP_MAX_KEEPALIVES</code> to a lower value such as 3. Additionally, configure <code>TCP_KEEPALIVE_INTERVAL</code> and <code>TCP_KEEPALIVE_DELAY</code> be set to 3 seconds. Rebuild your application.
          
        </li>
      
      
      
    </ul>
  
  <p>
  
  Product-specific remediations or mitigations can be found in the section
  <a href="#affected-products-section">Affected Products and Solution</a>.
  <br>
  
  
  Please follow the <a href="#general-recommendations">General Security Recommendations</a>.
  
</p>
</div>
</div>

  <div id="general-section">
<div id="general-recommendations" class="content-div">
  <label class="page-h2">GENERAL SECURITY RECOMMENDATIONS</label>

  <p class="gsr-lbl"><p>As a general security measure, Siemens strongly recommends to protect network access to devices with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens recommends to configure the environment according to Siemens' operational guidelines for Industrial Security (Download: <a href="https://www.siemens.com/cert/operational-guidelines-industrial-security">https://www.siemens.com/cert/operational-guidelines-industrial-security</a>), and to follow the recommendations in the product manuals.
Additional information on Industrial Security by Siemens can be found at: <a href="https://www.siemens.com/industrialsecurity">https://www.siemens.com/industrialsecurity</a></p></p>
</div>
</div>

  <div id="about-products-section">


  <div id="product-description" class="content-div">
    <label id="about-products-field" class="page-h2 ">
      PRODUCT DESCRIPTION
    </label>


    
      <div >
        <p>
        <label 
            class="about-products-lbl ">
          Nucleus NET module incorporates a wide range of standard-compliant networking
and communication protocols, drivers, and utilities to deliver full-featured
network support in any embedded device. The networking functionality is fully
integrated into the Nucleus RTOS (&quot;Nucleus PLUS&quot;) and supports a variety of processors and MCUs.
        </label>
        
      </div>
    
      <div >
        <p>
        <label 
            class="about-products-lbl ">
          Nucleus ReadyStart is a platform with integrated software IP, tools, and services
ideal for applications where a small footprint, deterministic performance, and small code size are essential.

        </label>
        
      </div>
    
      <div >
        <p>
        <label 
            class="about-products-lbl ">
          Nucleus RTOS is a highly scalable micro-kernel based real-time operating system designed for
scalability and reliability in systems spanning the range of aerospace, industrial, and medical applications.
Since V3, Nucleus RTOS (incl. its modules, e.g. Nucleus NET) is an integral part of the Nucleus ReadyStart platform.
        </label>
        
      </div>
    

  </div>
</div>

  <div id="cves-section">


<div id="vulnerability-classification" class="content-div">
  <label id="cves-field" class="page-h2 ">
    VULNERABILITY CLASSIFICATION
  </label>
  <p>
    The vulnerability classification has been performed by using the CVSS scoring system in version 3.1
    (CVSS v3.1) (<a href='https://www.first.org/cvss/'>https://www.first.org/cvss/</a>). The CVSS environmental score is specific to the customer’s
    environment and will impact the overall CVSS score. The environmental score should therefore be
    individually defined by the customer to accomplish final scoring.
  </p>
  <p>
    An additional classification has been performed using the CWE classification, a community-developed list
    of common software security weaknesses. This serves as a common language and as a baseline for
    weakness identification, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
    <a href='https://cwe.mitre.org/'>https://cwe.mitre.org/</a>.
  </p>

  
    <div class="cve-div ">
      <label 
          class="cve-title ">
        Vulnerability CVE-2022-38371</label>
      <div class="cve-description-div">
        <label class="cve-label">The FTP server does not properly release memory resources that were reserved for incomplete connection attempts by FTP clients. This could allow a remote attacker to generate a denial of service condition on devices that incorporate a vulnerable version of the FTP server.</label>
        <table class="cvss-table">
          <tr>
            <td class="cvss-table-width">CVSS v3.1 Base Score</td>
            <td>7.5</td>
          </tr>
          <tr>
            <td class="cvss-table-element">CVSS Vector</td>
            <td>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C</td>
          </tr>
          <tr>
            <td class="cvss-table-element">CWE</td>
            <td>CWE-400: Uncontrolled Resource Consumption</td>
          </tr>
        </table>
      </div>

      
    </div>
  

</div>
</div>



  
  <div id="acknowledgements-section">

<div id="acknowledgement" class="content-div">
  <label id="acknowledgements-field" class="page-h2 ">
    ACKNOWLEDGMENTS
  </label>
  <div id="acknowledgement-content">
  <p class="acknowledgement-p">
    <label>Siemens thanks the following parties for their efforts:</label>
  </p>
  <ul class="acknowledgement-ul">
    
      <li >
        Kaspersky Lab ICS CERT for coordinated disclosure
        
      </li>
    
      <li >
        WAGO for reporting the vulnerability and coordination efforts
        
      </li>
    
  </ul>
  </div>
</div>

</div>
  



  <div id="additional-info-section">
<div id="additional-information" class="content-div">
  <label id="additional-info-field" class="page-h2 ">ADDITIONAL INFORMATION</label>

  <p>
  
  </p>
  <label>
    For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the Siemens ProductCERT:
  </label>
  <p/>
  <a href="https://www.siemens.com/cert/advisories">https://www.siemens.com/cert/advisories</a>
</div>
</div>



  <div id="history-section">
<div id="history-data" class="content-div">
  <label class="page-h2">HISTORY DATA</label>
  <table class="history-table">
    
    <tr>
      <td ">
        V1.0 (2022-10-11):
        
      </td>
      <td>Publication Date</td>
    </tr>
    
    <tr>
      <td ">
        V1.1 (2022-12-13):
        
      </td>
      <td>Added specific mitigation</td>
    </tr>
    
    <tr>
      <td ">
        V1.2 (2023-02-14):
        
      </td>
      <td>Added fix for Nucleus NET in Nucleus PLUS V1, V2, and for Nucleus ReadyStart V2012</td>
    </tr>
    
  </table>
</div>
</div>

  <div class="content-div" id="terms_of_use">
    <label class="page-h2" id="terms">TERMS OF USE</label>
    <p/>
    <label>
      Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
      license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
      Terms"). To the extent applicable to information, software or documentation made available in or through
      a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (<a href="https://www.siemens.com/terms_of_use">https://www.siemens.com/
      terms_of_use</a>, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
      additionally. In case of conflicts, the License Terms shall prevail over the Terms of Use.
    </label>
  </div>

  <div id="footer-section">
<div class="footer-div content-div">
  <div class="conf-div">
    
  </div>
  <label class="ssa-label">&nbsp;SSA-313313</label>

  <div class="footer-label-div">
    <label id="copyright-lbl" class="footer-label siemens-label-tlp">&#169;
      <label class="copyright-lbl">Siemens 2023</label>
    </label>
  </div>


</div>
</div>

</div>

    </body>
</html>

