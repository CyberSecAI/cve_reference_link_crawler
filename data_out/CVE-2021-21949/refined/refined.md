- **Root cause of vulnerability**: Improper array index validation in the JPEG-JFIF progressive image parser, leading to a type confusion combined with a numeric range comparison without a minimum check. Specifically, the vulnerability stems from using values from the SOS header to index into the huffman tables without proper validation, which allows an attacker to specify arbitrary memory locations to be read, causing type confusion, and later to write outside of a stack allocated buffer.
- **Weaknesses/vulnerabilities present**:
  - Out-of-bounds write vulnerability in the `stack_image_row_temp` buffer within the `process_jpeg_progressive` function.
  - Lack of validation on `AC` and `DC` values from the SOS header which are used as indexes for huffman tables in the `parse_SOS_SOF` function.
  - Signed comparison without minimum check in the `process_jpeg_progressive` function that uses an offset to access the `JPEG_ZIGZAG_MAP` buffer.
- **Impact of exploitation**: An attacker can achieve arbitrary code execution by providing a crafted JPEG file that causes an out-of-bounds write, overwriting the stack.
- **Attack vectors**: The attacker provides a malicious JPEG file to the vulnerable software.
- **Required attacker capabilities/position**: The attacker needs to be able to provide a crafted JPEG file to the vulnerable software.