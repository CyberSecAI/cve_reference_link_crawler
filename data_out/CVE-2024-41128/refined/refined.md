Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
- The vulnerability stems from a flaw in the query parameter filtering logic within the Action Dispatch component of the Ruby on Rails framework. Specifically, the way the `filtered_query_string` method processes and filters query parameters using regular expressions could lead to a denial-of-service condition.

**Weaknesses/Vulnerabilities:**
- **ReDoS (Regular Expression Denial of Service):** The primary vulnerability is a potential ReDoS. The original implementation used a regular expression (`PAIR_RE`) to match key-value pairs in the query string and then used string manipulation, which could cause excessive backtracking in the regular expression engine when processing specially crafted, malicious query strings. This excessive backtracking leads to a denial of service by consuming excessive CPU resources.
- **Inefficient String Processing:** The initial implementation of `filtered_query_string` used `gsub` with `PAIR_RE`, which led to inefficient processing and potential for ReDoS.

**Impact of Exploitation:**
- **Denial of Service (DoS):** By sending specially crafted query parameters, an attacker could cause the Rails application to become unresponsive or very slow. This could effectively deny service to legitimate users.

**Attack Vectors:**
- **HTTP Query Parameters:** The attack vector is through HTTP query parameters. An attacker sends a crafted URL with a malicious query string to a Rails application.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be able to send HTTP requests to the vulnerable Rails application. No specific privileged access is required.
- **Crafted Input:** The attacker needs to be able to craft a malicious query string that triggers the ReDoS vulnerability.

**Technical Details:**

- The vulnerability is located in `actionpack/lib/action_dispatch/http/filter_parameters.rb` within the `filtered_query_string` method and in `actionpack/lib/action_dispatch/http/filter_redirect.rb` within the `parameter_filtered_location` method.
- The original implementation used `query_string.gsub(PAIR_RE)` to filter parameters, which led to the backtracking issue.
- The fix involves splitting the query string into parts based on `&` and `;`, iterating through the parts and applying the parameter filter if the part includes an equals sign (`=`).
- The fix replaces a regular expression based approach with a split/map/join approach to avoid backtracking.

**Mitigations:**
- The vulnerability is mitigated by upgrading to the patched versions of Rails or using Ruby 3.2 or newer which has mitigations for this class of ReDoS vulnerabilities.
- The vulnerability has been assigned CVE-2024-41128 and GHSA-x76w-6vjr-8xgj.

**Affected Versions:**
- actionpack versions >= 3.1.0, < 6.1.7.9
- actionpack versions >= 7.0.0, < 7.0.8.5
- actionpack versions >= 7.1.0, < 7.1.4.1
- actionpack versions >= 7.2.0, < 7.2.1.1

**Patched Versions:**
- 6.1.7.9
- 7.0.8.5
- 7.1.4.1
- 7.2.1.1