

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cde177fa235cd36f981012504a6376315bac03c9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cde177fa235cd36f981012504a6376315bac03c9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cde177fa235cd36f981012504a6376315bac03c9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cde177fa235cd36f981012504a6376315bac03c9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Aleksandr Mishin <amishin@t-argos.ru> | 2024-06-11 11:25:46 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-21 14:35:53 +0200 |
| commit | [cde177fa235cd36f981012504a6376315bac03c9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cde177fa235cd36f981012504a6376315bac03c9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cde177fa235cd36f981012504a6376315bac03c9)) | |
| tree | [0bc74efaf97147b4346ed4d4c85e657438868cb7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cde177fa235cd36f981012504a6376315bac03c9) | |
| parent | [e9c6513cffc068f4c7ca6053bf046d2b8aef7a7c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e9c6513cffc068f4c7ca6053bf046d2b8aef7a7c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cde177fa235cd36f981012504a6376315bac03c9&id2=e9c6513cffc068f4c7ca6053bf046d2b8aef7a7c)) | |
| download | [linux-cde177fa235cd36f981012504a6376315bac03c9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cde177fa235cd36f981012504a6376315bac03c9.tar.gz) | |

bnxt\_en: Adjust logging of firmware messages in case of released token in \_\_hwrm\_send()[ Upstream commit a9b9741854a9fe9df948af49ca5514e0ed0429df ]
In case of token is released due to token->state == BNXT\_HWRM\_DEFERRED,
released token (set to NULL) is used in log messages. This issue is
expected to be prevented by HWRM\_ERR\_CODE\_PF\_UNAVAILABLE error code. But
this error code is returned by recent firmware. So some firmware may not
return it. This may lead to NULL pointer dereference.
Adjust this issue by adding token pointer check.
Found by Linux Verification Center (linuxtesting.org) with SVACE.
Fixes: 8fa4219dba8e ("bnxt\_en: add dynamic debug support for HWRM messages")
Suggested-by: Michael Chan <michael.chan@broadcom.com>
Signed-off-by: Aleksandr Mishin <amishin@t-argos.ru>
Reviewed-by: Wojciech Drewek <wojciech.drewek@intel.com>
Reviewed-by: Michael Chan <michael.chan@broadcom.com>
Link: [https://lore.kernel.org/r/20240611082547.12178-1-amishin@t-argos.ru](https://lore.kernel.org/r/20240611082547.12178-1-amishin%40t-argos.ru)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cde177fa235cd36f981012504a6376315bac03c9)

| -rw-r--r-- | [drivers/net/ethernet/broadcom/bnxt/bnxt\_hwrm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/broadcom/bnxt/bnxt_hwrm.c?id=cde177fa235cd36f981012504a6376315bac03c9) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/net/ethernet/broadcom/bnxt/bnxt\_hwrm.c b/drivers/net/ethernet/broadcom/bnxt/bnxt\_hwrm.cindex 132442f16fe676..7a4e08b5a8c1b9 100644--- a/[drivers/net/ethernet/broadcom/bnxt/bnxt\_hwrm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/broadcom/bnxt/bnxt_hwrm.c?id=e9c6513cffc068f4c7ca6053bf046d2b8aef7a7c)+++ b/[drivers/net/ethernet/broadcom/bnxt/bnxt\_hwrm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/broadcom/bnxt/bnxt_hwrm.c?id=cde177fa235cd36f981012504a6376315bac03c9)@@ -678,7 +678,7 @@ static int \_\_hwrm\_send(struct bnxt \*bp, struct bnxt\_hwrm\_ctx \*ctx) req\_type); else if (rc && rc != HWRM\_ERR\_CODE\_PF\_UNAVAILABLE) hwrm\_err(bp, ctx, "hwrm req\_type 0x%x seq id 0x%x error 0x%x\n",- req\_type, token->seq\_id, rc);+ req\_type, le16\_to\_cpu(ctx->req->seq\_id), rc); rc = \_\_hwrm\_to\_stderr(rc); exit: if (token) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 06:58:23 +0000

