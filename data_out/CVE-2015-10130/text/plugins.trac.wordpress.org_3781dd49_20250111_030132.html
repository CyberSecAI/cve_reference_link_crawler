

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D1269993%2540circle-image-slider-with-lightbox%26old%3D1269993%2540circle-image-slider-with-lightbox)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/1226699/circle-image-slider-with-lightbox "Changeset 1226699 for circle-image-slider-with-lightbox")
* [Next Change](/changeset/1312406/circle-image-slider-with-lightbox "Changeset 1312406 for circle-image-slider-with-lightbox") →

---

# Changeset [1269993](/changeset/1269993 "Show full changeset") for [circle-image-slider-with-lightbox](/browser/circle-image-slider-with-lightbox?rev=1269993 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/21/2015 03:04:30 AM
([9 years](/timeline?from=2015-10-21T03%3A04%3A30Z&precision=second "See timeline at 10/21/2015 03:04:30 AM") ago)

Author:
nik00726
Message:

-Added new js version

-improve security

-readme changes

-image loaded from local

Location:
[circle-image-slider-with-lightbox/trunk](/browser/circle-image-slider-with-lightbox/trunk?rev=1269993)
Files:

3 added
4 edited

* [circle-image-slider-with-lightbox.php](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993 "Show entry in browser")
  (modified)
  ([44 diffs](#file0 "Show differences"))
* [css/images-circle-thumbnail-slider-plus-lighbox-style.css](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993 "Show entry in browser")
  (modified)
  ([14 diffs](#file1 "Show differences"))
* [images/300x250-animated.gif](/browser/circle-image-slider-with-lightbox/trunk/images/300x250-animated.gif?rev=1269993 "Show entry in browser")
  (added)
* [images/300x250.gif](/browser/circle-image-slider-with-lightbox/trunk/images/300x250.gif?rev=1269993 "Show entry in browser")
  (added)
* [images/paypaldonate.jpg](/browser/circle-image-slider-with-lightbox/trunk/images/paypaldonate.jpg?rev=1269993 "Show entry in browser")
  (added)
* [js/images-circle-thumbnail-slider-plus-lightbox-jc.js](/browser/circle-image-slider-with-lightbox/trunk/js/images-circle-thumbnail-slider-plus-lightbox-jc.js?rev=1269993 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [readme.txt](/browser/circle-image-slider-with-lightbox/trunk/readme.txt?rev=1269993 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php](/changeset/1269993/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php "Show the changeset 1269993 restricted to circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php")

  | [r1206457](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L2 "Show revision 1206457 of this file in browser") | [r1269993](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L2 "Show revision 1269993 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | /\* |
  | 3 | 3 | Plugin Name: Circle Image Slider With Lightbox |
  | 4 |  | Plugin URI:http://www.i13websolution.com |
  | 5 |  | Author URI:http://www.i13websolution.com |
  |  | 4 | Plugin URI:http://www.i13websolution.com/wordpress-circle-image-gallery-slider-with-lightbox-pro.html |
  |  | 5 | Author URI:http://www.i13websolution.com/wordpress-circle-image-gallery-slider-with-lightbox-pro.html |
  | 6 | 6 | Description:Circle Image Silder With Lightbox is beautiful responsive circle thumbnail image slider with responsive lightbox.Add any number of images from admin panel. |
  | 7 | 7 | Author:I Thirteen Web Solution |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L64) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L64) |  |
  | 64 | 64 |  |
  | 65 | 65 | $sql = "CREATE TABLE " . $table\_name . " ( |
  | 66 |  | `id` int(10) ~~unsigned~~ NOT NULL AUTO\_INCREMENT, |
  | 67 |  | `title` varchar(1000) ~~COLLATE utf8\_unicode\_ci~~ NOT NULL, |
  | 68 |  | `image\_name` varchar(500) ~~COLLATE utf8\_unicode\_ci~~ NOT NULL, |
  | 69 |  | `image\_description` text ~~COLLATE utf8\_unicode\_ci~~ DEFAULT NULL, |
  |  | 66 | `id` int(10) NOT NULL AUTO\_INCREMENT, |
  |  | 67 | `title` varchar(1000)  NOT NULL, |
  |  | 68 | `image\_name` varchar(500)  NOT NULL, |
  |  | 69 | `image\_description` text  DEFAULT NULL, |
  | 70 | 70 | `image\_order` int(11) NOT NULL DEFAULT '0', |
  | 71 | 71 | `open\_link\_in` tinyint(1) NOT NULL DEFAULT '1', |
  | 72 | 72 | `enable\_light\_box\_img\_desc` tinyint(1) NOT NULL DEFAULT '1', |
  | 73 | 73 | `createdon` datetime NOT NULL, |
  | 74 |  | `custom\_link` varchar(1000) ~~COLLATE utf8\_unicode\_ci~~ DEFAULT NULL, |
  | 75 |  | `post\_id` int(10) ~~unsigned~~ DEFAULT NULL, |
  | 76 |  | `slider\_id` int(10) ~~unsigned~~ NOT NULL DEFAULT '0', |
  |  | 74 | `custom\_link` varchar(1000)  DEFAULT NULL, |
  |  | 75 | `post\_id` int(10)  DEFAULT NULL, |
  |  | 76 | `slider\_id` int(10)  NOT NULL DEFAULT '0', |
  | 77 | 77 | PRIMARY KEY (`id`) |
  | 78 | 78 | );"; |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L132) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L132) |  |
  | 132 | 132 | if(isset($\_POST['btnsave'])){ |
  | 133 | 133 |  |
  | 134 |  | $auto=trim($\_POST['isauto']); |
  |  | 134 | if ( !check\_admin\_referer( 'action\_image\_add\_edit','add\_edit\_image\_nonce')){ |
  |  | 135 |  |
  |  | 136 | wp\_die('Security check fail'); |
  |  | 137 | } |
  |  | 138 |  |
  |  | 139 | $auto=trim(htmlentities(strip\_tags($\_POST['isauto']),ENT\_QUOTES)); |
  | 135 | 140 |  |
  | 136 | 141 | if($auto=='auto') |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L139) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L144) |  |
  | 139 | 144 | $auto=false; |
  | 140 | 145 |  |
  | 141 |  | $speed=(int)trim(~~$\_POST['speed']~~); |
  | 142 |  | $pause=(int)trim(~~$\_POST['pause']~~); |
  |  | 146 | $speed=(int)trim(htmlentities(strip\_tags($\_POST['speed']),ENT\_QUOTES)); |
  |  | 147 | $pause=(int)trim(htmlentities(strip\_tags($\_POST['pause']),ENT\_QUOTES)); |
  | 143 | 148 |  |
  | 144 | 149 | if(isset($\_POST['circular'])) |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L149) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L154) |  |
  | 149 | 154 | //$scrollerwidth=$\_POST['scrollerwidth']; |
  | 150 | 155 |  |
  | 151 |  | $visible=trim(~~$\_POST['visible']~~); |
  | 152 |  |  |
  | 153 |  | $min\_visible=trim(~~$\_POST['min\_visible']~~); |
  |  | 156 | $visible=trim(htmlentities(strip\_tags($\_POST['visible']),ENT\_QUOTES)); |
  |  | 157 |  |
  |  | 158 | $min\_visible=trim(htmlentities(strip\_tags($\_POST['min\_visible']),ENT\_QUOTES)); |
  | 154 | 159 |  |
  | 155 | 160 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L160) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L165) |  |
  | 160 | 165 |  |
  | 161 | 166 |  |
  | 162 |  | $scroll=trim(~~$\_POST['scroll']~~); |
  |  | 167 | $scroll=trim(htmlentities(strip\_tags($\_POST['scroll']),ENT\_QUOTES)); |
  | 163 | 168 |  |
  | 164 | 169 | if($scroll=="") |
  | 165 | 170 | $scroll=1; |
  | 166 | 171 |  |
  | 167 |  | $imageMargin=(int)trim(~~$\_POST['imageMargin']~~); |
  | 168 |  | $imageheight=(int)trim(~~$\_POST['imageheight']~~); |
  | 169 |  | $imagewidth=(int)trim(~~$\_POST['imagewidth']~~); |
  | 170 |  | $show\_caption=~~$\_POST['show\_caption']~~; |
  | 171 |  |  |
  | 172 |  | $scollerBackground=trim(~~$\_POST['scollerBackground']~~); |
  |  | 172 | $imageMargin=(int)trim(htmlentities(strip\_tags($\_POST['imageMargin']),ENT\_QUOTES)); |
  |  | 173 | $imageheight=(int)trim(htmlentities(strip\_tags($\_POST['imageheight']),ENT\_QUOTES)); |
  |  | 174 | $imagewidth=(int)trim(htmlentities(strip\_tags($\_POST['imagewidth']),ENT\_QUOTES)); |
  |  | 175 | $show\_caption=htmlentities(strip\_tags($\_POST['show\_caption']),ENT\_QUOTES); |
  |  | 176 |  |
  |  | 177 | $scollerBackground=trim(htmlentities(strip\_tags($\_POST['scollerBackground']),ENT\_QUOTES)); |
  | 173 | 178 |  |
  | 174 | 179 | if(isset($\_POST['lightbox'])) |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L220) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L225) |  |
  | 220 | 225 | <td> |
  | 221 | 226 | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
  | 222 |  | <img id="help us for free plugin" height="30" width="90" src="~~http://www.i13websolution.com/images/paypaldonate.jpg~~" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  |  | 227 | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  | 223 | 228 | </a> |
  | 224 | 229 | </td> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L478) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L483) |  |
  | 478 | 483 | </div> |
  | 479 | 484 |  |
  |  | 485 | <?php wp\_nonce\_field('action\_image\_add\_edit','add\_edit\_image\_nonce'); ?> |
  | 480 | 486 | <input type="submit"  name="btnsave" id="btnsave" value="Save Changes" class="button-primary">&nbsp;&nbsp;<input type="button" name="cancle" id="cancle" value="Cancel" class="button-primary" onclick="location.href='admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management'"> |
  | 481 | 487 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L565) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L571) |  |
  | 565 | 571 | <h3 class="hndle"><span></span>Access All Themes In One Price</h3> |
  | 566 | 572 | <div class="inside"> |
  | 567 |  | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="http://www.elegantthemes.com/affiliates/banners/300x250.gif" width="250" height="250"></a></center> |
  |  | 573 | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  |  | 574 | <img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"> |
  |  | 575 | </a> |
  |  | 576 | </center> |
  | 568 | 577 |  |
  | 569 | 578 | <div style="margin:10px 5px"> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L574) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L583) |  |
  | 574 | 583 | <h3 class="hndle"><span></span>Recommended WordPress Hostings</h3> |
  | 575 | 584 | <div class="inside"> |
  | 576 |  | <center><a href="http://secure.hostgator.com/~affiliat/cgi-bin/affiliates/clickthru.cgi?id=nik00726-hs-wp"><img src="http://tracking.hostgator.com/img/WordPress\_Hosting/300x250-animated.gif" width="250" height="250" border="0"></a></center> |
  |  | 585 | <center><a href="http://secure.hostgator.com/~affiliat/cgi-bin/affiliates/clickthru.cgi?id=nik00726-hs-wp"> |
  |  | 586 | <img src="<?php echo plugins\_url( 'images/300x250-animated.gif', \_\_FILE\_\_ );?>" width="250" height="250" border="0"> |
  |  | 587 | </a> |
  |  | 588 | </center> |
  | 577 | 589 | <div style="margin:10px 5px"> |
  | 578 | 590 | </div> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L705) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L717) |  |
  | 705 | 717 | <td> |
  | 706 | 718 | <a target="\_blank" title="Donate" href="http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php"> |
  | 707 |  | <img id="help us for free plugin" height="30" width="90" src="~~http://www.i13websolution.com/images/paypaldonate.jpg~~" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  |  | 719 | <img id="help us for free plugin" height="30" width="90" src="<?php echo plugins\_url( 'images/paypaldonate.jpg', \_\_FILE\_\_ );?>" border="0" alt="help us for free plugin" title="help us for free plugin"> |
  | 708 | 720 | </a> |
  | 709 | 721 | </td> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L741) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L753) |  |
  | 741 | 753 | <form method="POST" action="admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management&action=deleteselected"  id="posts-filter"> |
  | 742 | 754 | <div class="alignleft actions"> |
  | 743 |  | <select name="action\_upper"> |
  |  | 755 | <select name="action\_upper" id="action\_upper"> |
  | 744 | 756 | <option selected="selected" value="-1">Bulk Actions</option> |
  | 745 | 757 | <option value="delete">delete</option> |
  | 746 | 758 | </select> |
  | 747 |  | <input type="submit" value="Apply" class="button-secondary action" id="deleteselected" name="deleteselected"> |
  |  | 759 | <input type="submit" value="Apply" class="button-secondary action" id="deleteselected" name="deleteselected" onclick="return confirmDelete\_bulk();"> |
  | 748 | 760 | </div> |
  | 749 | 761 | <br class="clear"> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L782) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L794) |  |
  | 782 | 794 |  |
  | 783 | 795 | global $wp\_rewrite; |
  | 784 |  | $rows\_per\_page = ~~5~~; |
  | 785 |  |  |
  | 786 |  | $current = (isset($\_GET['paged'])) ? (~~$\_GET['paged']~~) : 1; |
  |  | 796 | $rows\_per\_page = 10; |
  |  | 797 |  |
  |  | 798 | $current = (isset($\_GET['paged'])) ? ( (int) htmlentities(strip\_tags($\_GET['paged']),ENT\_QUOTES)) : 1; |
  | 787 | 799 | $pagination\_args = array( |
  | 788 | 800 | 'base' => @add\_query\_arg('paged','%#%'), |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L798) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L810) |  |
  | 798 | 810 | $end = $start + $rows\_per\_page; |
  | 799 | 811 | $end = (sizeof($rows) < $end) ? sizeof($rows) : $end; |
  | 800 |  |  |
  |  | 812 | $delRecNonce=wp\_create\_nonce('delete\_image'); |
  | 801 | 813 | for ($i=$start;$i < $end ;++$i ) { |
  | 802 | 814 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L804) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L816) |  |
  | 804 | 816 | $id=$row['id']; |
  | 805 | 817 | $editlink="admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management&action=addedit&id=$id"; |
  | 806 |  | $deletelink="admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management&action=delete&id=$id"; |
  |  | 818 | $deletelink="admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management&action=delete&id=$id&nonce=$delRecNonce"; |
  | 807 | 819 | $outputimgmain = $baseurl.$row['image\_name']; |
  | 808 | 820 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L810) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L822) |  |
  | 810 | 822 | <tr valign="top" > |
  | 811 | 823 | <td class="alignCenter check-column"   data-title="Select Record" ><input type="checkbox" value="<?php echo $row['id'] ?>" name="thumbnails[]"></td> |
  | 812 |  | <td   data-title="Title" ><strong><?php echo ~~stripslashes($row['title'])~~ ?></strong></td> |
  |  | 824 | <td   data-title="Title" ><strong><?php echo $row['title']; ?></strong></td> |
  | 813 | 825 | <td class="alignCenter"> |
  | 814 | 826 | <img src="<?php echo $outputimgmain;?>" style="width:50px" height="50px"/> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L843) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L855) |  |
  | 843 | 855 | <br/> |
  | 844 | 856 | <div class="alignleft actions"> |
  | 845 |  | <select name="action"> |
  |  | 857 | <select name="action" id="action\_bottom"> |
  | 846 | 858 | <option selected="selected" value="-1">Bulk Actions</option> |
  | 847 | 859 | <option value="delete">delete</option> |
  | 848 | 860 | </select> |
  | 849 |  | <input type="submit" value="Apply" class="button-secondary action" id="deleteselected" name="deleteselected"> |
  |  | 861 |  |
  |  | 862 | <?php wp\_nonce\_field('action\_settings\_mass\_delete','mass\_delete\_nonce'); ?> |
  |  | 863 | <input type="submit" value="Apply" class="button-secondary action" id="deleteselected" name="deleteselected" onclick="return confirmDelete\_bulk();"> |
  | 850 | 864 | </div> |
  | 851 | 865 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L853) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L867) |  |
  | 853 | 867 | <script type="text/JavaScript"> |
  | 854 | 868 |  |
  |  | 869 | function  confirmDelete\_bulk(){ |
  |  | 870 | var topval=document.getElementById("action\_bottom").value; |
  |  | 871 | var bottomVal=document.getElementById("action\_upper").value; |
  |  | 872 |  |
  |  | 873 | if(topval=='delete' || bottomVal=='delete'){ |
  |  | 874 |  |
  |  | 875 |  |
  |  | 876 | var agree=confirm("Are you sure you want to delete selected images ?"); |
  |  | 877 | if (agree) |
  |  | 878 | return true ; |
  |  | 879 | else |
  |  | 880 | return false; |
  |  | 881 | } |
  |  | 882 | } |
  |  | 883 |  |
  | 855 | 884 | function  confirmDelete(){ |
  | 856 | 885 | var agree=confirm("Are you sure you want to delete this image ?"); |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L874) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L903) |  |
  | 874 | 903 | <h3 class="hndle"><span></span>Recommended WordPress Themes</h3> |
  | 875 | 904 | <div class="inside"> |
  | 876 |  | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="http://www.elegantthemes.com/affiliates/banners/300x250.gif" width="250" height="250"></a></center> |
  |  | 905 | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  |  | 906 | <img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ ) ;?>" width="250" height="250"> |
  |  | 907 | </a> |
  |  | 908 | </center> |
  | 877 | 909 | <div style="margin:10px 5px"> |
  | 878 | 910 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L893) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L925) |  |
  | 893 | 925 | if(isset($\_POST['btnsave'])){ |
  | 894 | 926 |  |
  |  | 927 | if ( !check\_admin\_referer( 'action\_image\_add\_edit','add\_edit\_image\_nonce')){ |
  |  | 928 |  |
  |  | 929 | wp\_die('Security check fail'); |
  |  | 930 | } |
  |  | 931 |  |
  | 895 | 932 | $uploads = wp\_upload\_dir(); |
  | 896 | 933 | $baseDir=$uploads['basedir']; |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L903) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L940) |  |
  | 903 | 940 | //add new |
  | 904 | 941 | $location='admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management'; |
  | 905 |  | $title=trim(~~addslashes($\_POST['imagetitle']~~)); |
  | 906 |  | $imageurl=trim(~~$\_POST['imageurl']~~); |
  | 907 |  | $imageid=trim(~~$\_POST['imageid']~~); |
  |  | 942 | $title=trim(htmlentities(strip\_tags($\_POST['imagetitle']),ENT\_QUOTES)); |
  |  | 943 | $imageurl=trim(htmlentities(strip\_tags($\_POST['imageurl']),ENT\_QUOTES)); |
  |  | 944 | $imageid=trim(htmlentities(strip\_tags($\_POST['imageid']),ENT\_QUOTES)); |
  | 908 | 945 | $imagename=""; |
  | 909 |  | $imagename=""; |
  | 910 |  | if($\_FILES["image\_name"]['name']!="" and $\_FILES["image\_name"]['name']!=null){ |
  | 911 |  |  |
  | 912 |  | if ($\_FILES["image\_name"]["error"] > 0) |
  | 913 |  | { |
  | 914 |  | $circle\_image\_carousel=array(); |
  | 915 |  | $circle\_image\_carousel['type']='err'; |
  | 916 |  | $circle\_image\_carousel['message']='Error while file uploading.'; |
  | 917 |  | update\_option('circle\_image\_carousel', $circle\_image\_carousel); |
  | 918 |  |  |
  | 919 |  |  |
  | 920 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 921 |  | exit; |
  | 922 |  |  |
  | 923 |  | } |
  | 924 |  | else{ |
  | 925 |  |  |
  | 926 |  | $wpcurrentdir=dirname(\_\_FILE\_\_); |
  | 927 |  | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
  | 928 |  | $path\_parts = pathinfo($\_FILES["image\_name"]["name"]); |
  | 929 |  | $extension = $path\_parts['extension']; |
  | 930 |  | $imagename=md5(time()).".$extension"; |
  | 931 |  | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
  | 932 |  | move\_uploaded\_file($\_FILES["image\_name"]["tmp\_name"],$imageUploadTo); |
  | 933 |  |  |
  | 934 |  | } |
  | 935 |  |  |
  | 936 |  | } |
  | 937 |  | else if(trim($\_POST['HdnMediaSelection'])!=''){ |
  | 938 |  |  |
  | 939 |  | $postThumbnailID=(int)$\_POST['HdnMediaSelection']; |
  |  | 946 |  |
  |  | 947 | if(trim($\_POST['HdnMediaSelection'])!=''){ |
  |  | 948 |  |
  |  | 949 | $postThumbnailID=(int) htmlentities(strip\_tags($\_POST['HdnMediaSelection']),ENT\_QUOTES); |
  | 940 | 950 | $photoMeta = wp\_get\_attachment\_metadata( $postThumbnailID ); |
  | 941 | 951 | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L998) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1008) |  |
  | 998 | 1008 |  |
  | 999 | 1009 | $location='admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management'; |
  | 1000 |  | $title=trim(~~addslashes($\_POST['imagetitle']~~)); |
  | 1001 |  | $imageurl=trim(~~$\_POST['imageurl']~~); |
  |  | 1010 | $title=trim(htmlentities(strip\_tags($\_POST['imagetitle']),ENT\_QUOTES)); |
  |  | 1011 | $imageurl=trim(htmlentities(strip\_tags($\_POST['imageurl']),ENT\_QUOTES)); |
  | 1002 | 1012 | $createdOn=date('Y-m-d h:i:s'); |
  | 1003 | 1013 | if(function\_exists('date\_i18n')){ |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1011) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1021) |  |
  | 1011 | 1021 | } |
  | 1012 | 1022 |  |
  | 1013 |  | if ($\_FILES["image\_name"]['name']!='' and $\_FILES["image\_name"]["error"] > 0) |
  | 1014 |  | { |
  |  | 1023 |  |
  |  | 1024 | $location='admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management'; |
  |  | 1025 |  |
  |  | 1026 | try{ |
  |  | 1027 |  |
  |  | 1028 | if(trim($\_POST['HdnMediaSelection'])!=''){ |
  |  | 1029 |  |
  |  | 1030 | $postThumbnailID=(int)$\_POST['HdnMediaSelection']; |
  |  | 1031 | $photoMeta = wp\_get\_attachment\_metadata( $postThumbnailID ); |
  |  | 1032 |  |
  |  | 1033 | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
  |  | 1034 |  |
  |  | 1035 | $fileName=$photoMeta['file']; |
  |  | 1036 | $phyPath=ABSPATH; |
  |  | 1037 | $phyPath=str\_replace("\\","/",$phyPath); |
  |  | 1038 |  |
  |  | 1039 | $pathArray=pathinfo($fileName); |
  |  | 1040 |  |
  |  | 1041 | $imagename=$pathArray['basename']; |
  |  | 1042 |  |
  |  | 1043 | $fileUrl=$phyPath.'wp-content/uploads/'.$fileName; |
  |  | 1044 | $fileUrl=str\_replace("\\","/",$fileUrl); |
  |  | 1045 |  |
  |  | 1046 | $wpcurrentdir=dirname(\_\_FILE\_\_); |
  |  | 1047 | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
  |  | 1048 | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
  |  | 1049 |  |
  |  | 1050 | @copy($fileUrl, $imageUploadTo); |
  |  | 1051 |  |
  |  | 1052 | } |
  |  | 1053 |  |
  |  | 1054 | } |
  |  | 1055 | $query = "INSERT INTO ".$wpdb->prefix."circle\_image\_carousel (title, image\_name,createdon,custom\_link) |
  |  | 1056 | VALUES ('$title','$imagename','$createdOn','$imageurl')"; |
  |  | 1057 |  |
  |  | 1058 |  |
  |  | 1059 | $wpdb->query($query); |
  |  | 1060 |  |
  |  | 1061 | $circle\_image\_carousel=array(); |
  |  | 1062 | $circle\_image\_carousel['type']='succ'; |
  |  | 1063 | $circle\_image\_carousel['message']='New image added successfully.'; |
  |  | 1064 | update\_option('circle\_image\_carousel', $circle\_image\_carousel); |
  |  | 1065 |  |
  |  | 1066 |  |
  |  | 1067 | } |
  |  | 1068 | catch(Exception $e){ |
  |  | 1069 |  |
  | 1015 | 1070 | $circle\_image\_carousel=array(); |
  | 1016 | 1071 | $circle\_image\_carousel['type']='err'; |
  | 1017 |  | $circle\_image\_carousel['message']='Error while ~~file uploading~~.'; |
  |  | 1072 | $circle\_image\_carousel['message']='Error while adding image.'; |
  | 1018 | 1073 | update\_option('circle\_image\_carousel', $circle\_image\_carousel); |
  | 1019 |  |  |
  | 1020 |  |  |
  | 1021 |  | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1022 |  | exit; |
  | 1023 |  |  |
  | 1024 |  | } |
  | 1025 |  | else{ |
  | 1026 |  | $location='admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management'; |
  | 1027 |  |  |
  | 1028 |  | try{ |
  | 1029 |  |  |
  | 1030 |  | if(isset($\_FILES["image\_name"]['name']) and $\_FILES["image\_name"]['name']!="" and $\_FILES["image\_name"]['name']!=null){ |
  | 1031 |  |  |
  | 1032 |  | $wpcurrentdir=dirname(\_\_FILE\_\_); |
  | 1033 |  | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
  | 1034 |  | $path\_parts = pathinfo($\_FILES["image\_name"]["name"]); |
  | 1035 |  | $extension = $path\_parts['extension']; |
  | 1036 |  | $imagename=md5(time()).".$extension"; |
  | 1037 |  | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
  | 1038 |  |  |
  | 1039 |  | move\_uploaded\_file($\_FILES["image\_name"]["tmp\_name"],$imageUploadTo ); |
  | 1040 |  |  |
  | 1041 |  | } |
  | 1042 |  | else if(trim($\_POST['HdnMediaSelection'])!=''){ |
  | 1043 |  |  |
  | 1044 |  | $postThumbnailID=(int)$\_POST['HdnMediaSelection']; |
  | 1045 |  | $photoMeta = wp\_get\_attachment\_metadata( $postThumbnailID ); |
  | 1046 |  |  |
  | 1047 |  | if(is\_array($photoMeta) and isset($photoMeta['file'])) { |
  | 1048 |  |  |
  | 1049 |  | $fileName=$photoMeta['file']; |
  | 1050 |  | $phyPath=ABSPATH; |
  | 1051 |  | $phyPath=str\_replace("\\","/",$phyPath); |
  | 1052 |  |  |
  | 1053 |  | $pathArray=pathinfo($fileName); |
  | 1054 |  |  |
  | 1055 |  | $imagename=$pathArray['basename']; |
  | 1056 |  |  |
  | 1057 |  | $fileUrl=$phyPath.'wp-content/uploads/'.$fileName; |
  | 1058 |  | $fileUrl=str\_replace("\\","/",$fileUrl); |
  | 1059 |  |  |
  | 1060 |  | $wpcurrentdir=dirname(\_\_FILE\_\_); |
  | 1061 |  | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
  | 1062 |  | $imageUploadTo=$pathToImagesFolder.'/'.$imagename; |
  | 1063 |  |  |
  | 1064 |  | @copy($fileUrl, $imageUploadTo); |
  | 1065 |  |  |
  | 1066 |  | } |
  | 1067 |  |  |
  | 1068 |  | } |
  | 1069 |  | $query = "INSERT INTO ".$wpdb->prefix."circle\_image\_carousel (title, image\_name,createdon,custom\_link) |
  | 1070 |  | VALUES ('$title','$imagename','$createdOn','$imageurl')"; |
  | 1071 |  |  |
  | 1072 |  |  |
  | 1073 |  | $wpdb->query($query); |
  | 1074 |  |  |
  | 1075 |  | $circle\_image\_carousel=array(); |
  | 1076 |  | $circle\_image\_carousel['type']='succ'; |
  | 1077 |  | $circle\_image\_carousel['message']='New image added successfully.'; |
  | 1078 |  | update\_option('circle\_image\_carousel', $circle\_image\_carousel); |
  | 1079 |  |  |
  | 1080 |  |  |
  | 1081 |  | } |
  | 1082 |  | catch(Exception $e){ |
  | 1083 |  |  |
  | 1084 |  | $circle\_image\_carousel=array(); |
  | 1085 |  | $circle\_image\_carousel['type']='err'; |
  | 1086 |  | $circle\_image\_carousel['message']='Error while adding image.'; |
  | 1087 |  | update\_option('circle\_image\_carousel', $circle\_image\_carousel); |
  | 1088 |  | } |
  | 1089 |  |  |
  | 1090 |  | } |
  |  | 1074 | } |
  |  | 1075 |  |
  |  | 1076 |  |
  | 1091 | 1077 | echo "<script type='text/javascript'> location.href='$location';</script>"; |
  | 1092 |  | exit; |
  |  | 1078 | exit; |
  | 1093 | 1079 | } |
  | 1094 | 1080 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1105) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1091) |  |
  | 1105 | 1091 |  |
  | 1106 | 1092 |  |
  | 1107 |  | $id= ~~$\_GET['id']~~; |
  |  | 1093 | $id= htmlentities(strip\_tags($\_GET['id']),ENT\_QUOTES); |
  | 1108 | 1094 | $query="SELECT \* FROM ".$wpdb->prefix."circle\_image\_carousel WHERE id=$id"; |
  | 1109 | 1095 | $myrow  = $wpdb->get\_row($query); |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1111) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1097) |  |
  | 1111 | 1097 | if(is\_object($myrow)){ |
  | 1112 | 1098 |  |
  | 1113 |  | $title=~~stripslashes($myrow->title)~~; |
  |  | 1099 | $title=$myrow->title; |
  | 1114 | 1100 | $image\_link=$myrow->custom\_link; |
  | 1115 |  | $image\_name=~~stripslashes($myrow->image\_name)~~; |
  |  | 1101 | $image\_name=$myrow->image\_name; |
  | 1116 | 1102 |  |
  | 1117 | 1103 | } |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1143) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1129) |  |
  | 1143 | 1129 | <div><b>Current Image : </b><a id="currImg" href="<?php echo $baseurl.$image\_name; ?>" target="\_new"><?php echo $image\_name; ?></a></div> |
  | 1144 | 1130 | <?php } ?> |
  | 1145 |  | <input type="file" name="image\_name" onchange="reloadfileupload();"  id="image\_name" size="30" /> |
  | 1146 |  | <div style="clear:both"></div> |
  | 1147 |  | <div></div> |
  | 1148 |  | <div class="uploader"> |
  |  | 1131 |  |
  |  | 1132 | <div class="uploader"> |
  | 1149 | 1133 | <br/> |
  | 1150 |  | <b style="margin-left: 50px;">OR</b><div style="clear: both;margin-top: 15px;"></div> |
  | 1151 |  | <?php if(circle\_slider\_plus\_responsive\_lightbox\_get\_wp\_version()>=3.5){ ?> |
  | 1152 |  | <a href="javascript:;" class="niks\_media" id="myMediaUploader"><b>Use WordPress Media Uploader</b></a> |
  | 1153 |  | <?php }?> |
  | 1154 |  | <input id="HdnMediaSelection" name="HdnMediaSelection" type="hidden" value="" /> |
  |  | 1134 |  |
  |  | 1135 | <a href="javascript:;" class="niks\_media" id="myMediaUploader"><b>Click here to add image</b></a> |
  |  | 1136 | <input id="HdnMediaSelection" name="HdnMediaSelection" type="hidden" value="" /> |
  | 1155 | 1137 | <br/> |
  | 1156 | 1138 | </div> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1193) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1175) |  |
  | 1193 | 1175 | validExtensions[2]='png'; |
  | 1194 | 1176 | validExtensions[3]='gif'; |
  | 1195 |  | validExtensions[4]='bmp'; |
  | 1196 |  | validExtensions[5]='tif'; |
  |  | 1177 |  |
  | 1197 | 1178 |  |
  | 1198 | 1179 | var inarr=parseInt($n.inArray( attachment.subtype, validExtensions)); |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1291) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1272) |  |
  | 1291 | 1272 | } |
  | 1292 | 1273 | ?> |
  |  | 1274 | <?php wp\_nonce\_field('action\_image\_add\_edit','add\_edit\_image\_nonce'); ?> |
  | 1293 | 1275 | <input type="submit" onclick="return validateFile();" name="btnsave" id="btnsave" value="Save Changes" class="button-primary">&nbsp;&nbsp;<input type="button" name="cancle" id="cancle" value="Cancel" class="button-primary" onclick="location.href='admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management'"> |
  | 1294 | 1276 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1321) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1303) |  |
  | 1321 | 1303 | }); |
  | 1322 | 1304 |  |
  | 1323 |  | function validateFile(){ |
  | 1324 |  |  |
  | 1325 |  | var $n = jQuery.noConflict(); |
  | 1326 |  | if($n('#currImg').length>0 || $n.trim($n("#HdnMediaSelection").val())!=""){ |
  | 1327 |  | return true; |
  | 1328 |  | } |
  | 1329 |  | var fragment = $n("#image\_name").val(); |
  | 1330 |  | var filename = $n("#image\_name").val().replace(/.+[\\\/]/, ""); |
  | 1331 |  | var imageid=$n("#image\_name").val(); |
  | 1332 |  |  |
  | 1333 |  | if(imageid==""){ |
  | 1334 |  |  |
  | 1335 |  | if(filename!="") |
  |  | 1305 | function validateFile(){ |
  |  | 1306 |  |
  |  | 1307 | var $n = jQuery.noConflict(); |
  |  | 1308 | if($n('#currImg').length>0 || $n.trim($n("#HdnMediaSelection").val())!="" ){ |
  | 1336 | 1309 | return true; |
  |  | 1310 | } |
  | 1337 | 1311 | else |
  | 1338 | 1312 | { |
  | 1339 | 1313 | $n("#err\_daynamic").remove(); |
  | 1340 |  | $n("#~~image\_name").after('<label class="image\_error" id="err\_daynamic">Please select file or use media manager to~~ select file.</label>'); |
  |  | 1314 | $n("#myMediaUploader").after('<br/><label class="image\_error" id="err\_daynamic">Please select file.</label>'); |
  | 1341 | 1315 | return false; |
  | 1342 | 1316 | } |
  | 1343 |  | } |
  | 1344 |  | else{ |
  | 1345 |  | return true; |
  | 1346 |  | } |
  | 1347 |  | } |
  | 1348 |  | function reloadfileupload(){ |
  | 1349 |  |  |
  | 1350 |  | var $n = jQuery.noConflict(); |
  | 1351 |  | var fragment = $n("#image\_name").val(); |
  | 1352 |  | var filename = $n("#image\_name").val().replace(/.+[\\\/]/, ""); |
  | 1353 |  | var validExtensions=new Array(); |
  | 1354 |  | validExtensions[0]='jpg'; |
  | 1355 |  | validExtensions[1]='jpeg'; |
  | 1356 |  | validExtensions[2]='png'; |
  | 1357 |  | validExtensions[3]='gif'; |
  | 1358 |  | validExtensions[4]='bmp'; |
  | 1359 |  | validExtensions[5]='tif'; |
  | 1360 |  |  |
  | 1361 |  | var extension = filename.substr( (filename.lastIndexOf('.') +1) ).toLowerCase(); |
  | 1362 |  |  |
  | 1363 |  | var inarr=parseInt($n.inArray( extension, validExtensions)); |
  | 1364 |  |  |
  | 1365 |  | if(inarr<0){ |
  | 1366 |  |  |
  | 1367 |  | $n("#err\_daynamic").remove(); |
  | 1368 |  | $n('#fileuploaddiv').html($n('#fileuploaddiv').html()); |
  | 1369 |  | $n("#image\_name").after('<label class="image\_error" id="err\_daynamic">Invalid file extension</label>'); |
  | 1370 |  |  |
  | 1371 |  | } |
  | 1372 |  | else{ |
  | 1373 |  | $n("#err\_daynamic").remove(); |
  | 1374 |  |  |
  | 1375 |  | } |
  | 1376 |  |  |
  | 1377 |  |  |
  | 1378 |  | } |
  |  | 1317 |  |
  |  | 1318 | } |
  | 1379 | 1319 | </script> |
  | 1380 | 1320 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1387) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1327) |  |
  | 1387 | 1327 | <h3 class="hndle"><span></span>Access All Themes In One Price</h3> |
  | 1388 | 1328 | <div class="inside"> |
  | 1389 |  | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"><img border="0" src="http://www.elegantthemes.com/affiliates/banners/300x250.gif" width="250" height="250"></a></center> |
  |  | 1329 | <center><a href="http://www.elegantthemes.com/affiliates/idevaffiliate.php?id=11715\_0\_1\_10" target="\_blank"> |
  |  | 1330 | <img border="0" src="<?php echo plugins\_url( 'images/300x250.gif', \_\_FILE\_\_ );?>" width="250" height="250"> |
  |  | 1331 | </a> |
  |  | 1332 | </center> |
  | 1390 | 1333 |  |
  | 1391 | 1334 | <div style="margin:10px 5px"> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1396) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1339) |  |
  | 1396 | 1339 | <h3 class="hndle"><span></span>Best WordPress Hosting </h3> |
  | 1397 | 1340 | <div class="inside"> |
  | 1398 |  | <center><a href="http://secure.hostgator.com/~affiliat/cgi-bin/affiliates/clickthru.cgi?id=nik00726-hs-wp"><img src="http://tracking.hostgator.com/img/WordPress\_Hosting/300x250-animated.gif" width="250" height="250" border="0"></a></center> |
  |  | 1341 | <center><a href="http://secure.hostgator.com/~affiliat/cgi-bin/affiliates/clickthru.cgi?id=nik00726-hs-wp"> |
  |  | 1342 | <img src="<?php echo plugins\_url( 'images/300x250-animated.gif', \_\_FILE\_\_ );?>" width="250" height="250" border="0"> |
  |  | 1343 | </a> |
  |  | 1344 | </center> |
  | 1399 | 1345 |  |
  | 1400 | 1346 | <div style="margin:10px 5px"> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1412) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1358) |  |
  | 1412 | 1358 | else if(strtolower($action)==strtolower('delete')){ |
  | 1413 | 1359 |  |
  |  | 1360 | $retrieved\_nonce = ''; |
  |  | 1361 |  |
  |  | 1362 | if(isset($\_GET['nonce']) and $\_GET['nonce']!=''){ |
  |  | 1363 |  |
  |  | 1364 | $retrieved\_nonce=$\_GET['nonce']; |
  |  | 1365 |  |
  |  | 1366 | } |
  |  | 1367 | if (!wp\_verify\_nonce($retrieved\_nonce, 'delete\_image' ) ){ |
  |  | 1368 |  |
  |  | 1369 |  |
  |  | 1370 | wp\_die('Security check fail'); |
  |  | 1371 | } |
  |  | 1372 |  |
  | 1414 | 1373 | $location='admin.php?page=circle\_thumbnail\_slider\_with\_lightbox\_image\_management'; |
  | 1415 |  | $deleteId=(int)~~$\_GET['id']~~; |
  |  | 1374 | $deleteId=(int) htmlentities(strip\_tags($\_GET['id']),ENT\_QUOTES); |
  | 1416 | 1375 |  |
  | 1417 | 1376 | $uploads = wp\_upload\_dir(); |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1428) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1387) |  |
  | 1428 | 1387 | if(is\_object($myrow)){ |
  | 1429 | 1388 |  |
  | 1430 |  | $image\_name=~~stripslashes($myrow->image\_name)~~; |
  |  | 1389 | $image\_name=$myrow->image\_name; |
  | 1431 | 1390 | $wpcurrentdir=dirname(\_\_FILE\_\_); |
  | 1432 | 1391 | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
  | 1433 |  | ~~$imagename=$\_FILES["image\_name"]["name"];~~ |
  |  | 1392 |  |
  | 1434 | 1393 | $imagetoDel=$pathToImagesFolder.'/'.$image\_name; |
  | 1435 | 1394 | @unlink($imagetoDel); |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1460) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1419) |  |
  | 1460 | 1419 | else if(strtolower($action)==strtolower('deleteselected')){ |
  | 1461 | 1420 |  |
  |  | 1421 | if(!check\_admin\_referer('action\_settings\_mass\_delete','mass\_delete\_nonce')){ |
  |  | 1422 |  |
  |  | 1423 | wp\_die('Security check fail'); |
  |  | 1424 | } |
  |  | 1425 |  |
  | 1462 | 1426 | $uploads = wp\_upload\_dir(); |
  | 1463 | 1427 | $baseDir=$uploads['basedir']; |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1482) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1446) |  |
  | 1482 | 1446 | if(is\_object($myrow)){ |
  | 1483 | 1447 |  |
  | 1484 |  | $image\_name=~~stripslashes($myrow->image\_name)~~; |
  |  | 1448 | $image\_name=$myrow->image\_name; |
  | 1485 | 1449 | $wpcurrentdir=dirname(\_\_FILE\_\_); |
  | 1486 | 1450 | $wpcurrentdir=str\_replace("\\","/",$wpcurrentdir); |
  | 1487 |  | ~~$imagename=$\_FILES["image\_name"]["name"];~~ |
  | 1488 | 1451 | $imagetoDel=$pathToImagesFolder.'/'.$image\_name; |
  | 1489 | 1452 | @unlink($imagetoDel); |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1563) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1526) |  |
  | 1563 | 1526 | <div style="clear: both;"></div> |
  | 1564 | 1527 | <?php $url = plugin\_dir\_url(\_\_FILE\_\_);  ?> |
  | 1565 |  | <div style="postion:relative;margin: 0px auto;" id="divResponsiveSliderPlusLightboxMain\_admin"> |
  |  | 1528 | <div style="postion:relative;margin: 0px auto;visibility: hidden" id="divResponsiveSliderPlusLightboxMain\_admin"> |
  | 1566 | 1529 |  |
  | 1567 | 1530 | <?php if($settings['show\_caption'] and !$settings['auto']):?> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1710) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1673) |  |
  | 1710 | 1673 | $title=""; |
  | 1711 | 1674 | $Caption=""; |
  | 1712 |  | $rowTitle=~~stripslashes($row['title'])~~; |
  |  | 1675 | $rowTitle=$row['title']; |
  | 1713 | 1676 | $rowTitle=str\_replace("'","’",$rowTitle); |
  | 1714 | 1677 | $rowTitle=str\_replace('"','”',$rowTitle); |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1809) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1772) |  |
  | 1809 | 1772 |  |
  | 1810 | 1773 | }); |
  |  | 1774 |  |
  |  | 1775 | $n("#divResponsiveSliderPlusLightboxMain\_admin").css('visibility','visible'); |
  |  | 1776 |  |
  | 1811 | 1777 | <?php if($settings['auto']){?> |
  | 1812 | 1778 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1833) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1799) |  |
  | 1833 | 1799 | function onResize(){ |
  | 1834 | 1800 | slider.reloadSlider(); |
  | 1835 |  | $n("~~.responsiveSliderWithResponsiveLightbox").show(~~); |
  |  | 1801 | $n("#divResponsiveSliderPlusLightboxMain\_admin").css('visibility','visible'); |
  | 1836 | 1802 | } |
  | 1837 | 1803 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1847) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1813) |  |
  | 1847 | 1813 | $n("#divResponsiveSliderPlusLightboxMain\_admin").css('max-width','100%'); |
  | 1848 | 1814 | slider.reloadSlider(); |
  | 1849 |  | $n("~~.responsiveSlider").show(~~); |
  |  | 1815 | $n("#divResponsiveSliderPlusLightboxMain\_admin").css('visibility','visible'); |
  | 1850 | 1816 | } |
  | 1851 | 1817 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L1961) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L1927) |  |
  | 1961 | 1927 | <div style="clear: both;"></div> |
  | 1962 | 1928 | <?php $url = plugin\_dir\_url(\_\_FILE\_\_);  ?> |
  | 1963 |  | <div style="postion:relative;margin: 0px auto;" id="divResponsiveSliderPlusLightboxMain\_admin"> |
  |  | 1929 | <div style="postion:relative;margin: 0px auto;visibility: hidden" id="divResponsiveSliderPlusLightboxMain\_admin"> |
  | 1964 | 1930 |  |
  | 1965 | 1931 | <?php if($settings['show\_caption'] and !$settings['auto']):?> |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L2108) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L2074) |  |
  | 2108 | 2074 | $title=""; |
  | 2109 | 2075 | $Caption=""; |
  | 2110 |  | $rowTitle=~~stripslashes($row['title'])~~; |
  |  | 2076 | $rowTitle=$row['title']; |
  | 2111 | 2077 | $rowTitle=str\_replace("'","’",$rowTitle); |
  | 2112 | 2078 | $rowTitle=str\_replace('"','”',$rowTitle); |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L2207) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L2173) |  |
  | 2207 | 2173 |  |
  | 2208 | 2174 | }); |
  |  | 2175 | $n("#divResponsiveSliderPlusLightboxMain\_admin").css('visibility','visible'); |
  |  | 2176 |  |
  | 2209 | 2177 | <?php if($settings['auto']){?> |
  | 2210 | 2178 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1206457#L2231) | […](/browser/circle-image-slider-with-lightbox/trunk/circle-image-slider-with-lightbox.php?rev=1269993#L2199) |  |
  | 2231 | 2199 | function onResize(){ |
  | 2232 | 2200 | slider.reloadSlider(); |
  | 2233 |  | $n("~~.responsiveSliderWithResponsiveLightbox").show(~~); |
  |  | 2201 | $n("#divResponsiveSliderPlusLightboxMain\_admin").css('visibility','visible'); |
  | 2234 | 2202 | } |
  | 2235 | 2203 |  |
* ## [circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css](/changeset/1269993/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css "Show the changeset 1269993 restricted to circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css")

  | [r1206450](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L15 "Show revision 1206450 of this file in browser") | [r1269993](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L15 "Show revision 1269993 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | ===================================\*/ |
  | 16 | 16 |  |
  | 17 |  | .responsiveSlider{padding: 0px ~~!important;margin: 0px !important~~;} |
  | 18 |  | .responsiveSlider li img{ background: none ~~!important;border: none !important;margin: 0 0px 0px 0 !important;max-width:auto !important; padding: 0px !important~~; } |
  |  | 17 | .responsiveSlider{padding: 0px ;margin: 0px ;} |
  |  | 18 | .responsiveSlider li img{ background: none ;border: none ;margin: 0 0px 0px 0 ;max-width:auto ; padding: 0px ; } |
  | 19 | 19 | .bx-wrapper\_ { |
  | 20 |  | position: relative ~~!important~~; |
  | 21 |  | margin: 0 auto 19px ~~!important~~; |
  | 22 |  | padding: 0 ~~!important~~; |
  | 23 |  | \*zoom: 1 ~~!important~~; |
  |  | 20 | position: relative ; |
  |  | 21 | margin: 0 auto 19px ; |
  |  | 22 | padding: 0 ; |
  |  | 23 | \*zoom: 1 ; |
  | 24 | 24 | } |
  | 25 | 25 |  |
  | 26 | 26 | .bx-wrapper\_ \* {box-sizing:content-box} |
  | 27 |  | .bx-wrapper\_ .bx-viewport\_ {padding: 5px ~~!important;left: -5px !important~~;} |
  |  | 27 | .bx-wrapper\_ .bx-viewport\_ {padding: 5px ;left: -5px ;} |
  | 28 | 28 | .bx-wrapper\_ img { |
  | 29 |  | max-width: 100% ~~!important~~; |
  | 30 |  | display: block ~~!important~~; |
  | 31 |  | border-radius:50% ~~!important~~; |
  |  | 29 | max-width: 100% ; |
  |  | 30 | display: block ; |
  |  | 31 | border-radius:50% ; |
  | 32 | 32 | } |
  | 33 | 33 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L38) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L38) |  |
  | 38 | 38 | .bx-wrapper\_ .bx-pager, |
  | 39 | 39 | .bx-wrapper\_ .bx-controls-auto { |
  | 40 |  | position: absolute ~~!important~~; |
  | 41 |  | bottom: -20px ~~!important~~; |
  | 42 |  | width: 100% ~~!important~~; |
  |  | 40 | position: absolute ; |
  |  | 41 | bottom: -20px ; |
  |  | 42 | width: 100% ; |
  | 43 | 43 | } |
  | 44 | 44 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L47) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L47) |  |
  | 47 | 47 |  |
  | 48 | 48 | .bx-wrapper\_ .bx-loading { |
  | 49 |  | min-height: 50px ~~!important~~; |
  | 50 |  | background: url(../images/bx\_loader.gif) center center no-repeat #fff ~~!important~~; |
  | 51 |  | height: 100% ~~!important~~; |
  | 52 |  | width: 100% ~~!important~~; |
  | 53 |  | position: absolute ~~!important~~; |
  | 54 |  | top: 0 ~~!important~~; |
  | 55 |  | left: 0 ~~!important~~; |
  | 56 |  | z-index: 2000 ~~!important~~; |
  |  | 49 | min-height: 50px ; |
  |  | 50 | background: url(../images/bx\_loader.gif) center center no-repeat #fff ; |
  |  | 51 | height: 100% ; |
  |  | 52 | width: 100% ; |
  |  | 53 | position: absolute ; |
  |  | 54 | top: 0 ; |
  |  | 55 | left: 0 ; |
  |  | 56 | z-index: 2000 ; |
  | 57 | 57 | } |
  | 58 | 58 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L60) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L60) |  |
  | 60 | 60 |  |
  | 61 | 61 | .bx-wrapper\_ .bx-pager { |
  | 62 |  | text-align: center ~~!important~~; |
  | 63 |  | font-size: .85em ~~!important~~; |
  | 64 |  | font-family: Arial ~~!important~~; |
  | 65 |  | font-weight: bold ~~!important~~; |
  | 66 |  | color: #666 ~~!important~~; |
  | 67 |  | padding-top: 20px ~~!important~~; |
  |  | 62 | text-align: center ; |
  |  | 63 | font-size: .85em ; |
  |  | 64 | font-family: Arial ; |
  |  | 65 | font-weight: bold ; |
  |  | 66 | color: #666 ; |
  |  | 67 | padding-top: 20px ; |
  | 68 | 68 | } |
  | 69 | 69 |  |
  | 70 | 70 | .bx-wrapper\_ .bx-pager .bx-pager-item, |
  | 71 | 71 | .bx-wrapper\_ .bx-controls-auto .bx-controls-auto-item { |
  | 72 |  | display: inline-block ~~!important~~; |
  | 73 |  | \*zoom: 1 ~~!important~~; |
  | 74 |  | \*display: inline ~~!important~~; |
  |  | 72 | display: inline-block ; |
  |  | 73 | \*zoom: 1 ; |
  |  | 74 | \*display: inline ; |
  | 75 | 75 | } |
  | 76 | 76 |  |
  | 77 | 77 | .bx-wrapper\_ .bx-pager.bx-default-pager a { |
  | 78 |  | background: #666 ~~!important~~; |
  | 79 |  | text-indent: -9999px ~~!important~~; |
  | 80 |  | display: block ~~!important~~; |
  | 81 |  | width: 10px ~~!important~~; |
  | 82 |  | height: 10px ~~!important~~; |
  | 83 |  | margin: 0 5px ~~!important~~; |
  | 84 |  | outline: 0 ~~!important~~; |
  | 85 |  | -moz-border-radius: 5px ~~!important~~; |
  | 86 |  | -webkit-border-radius: 5px ~~!important~~; |
  | 87 |  | border-radius: 5px ~~!important~~; |
  |  | 78 | background: #666 ; |
  |  | 79 | text-indent: -9999px ; |
  |  | 80 | display: block ; |
  |  | 81 | width: 10px ; |
  |  | 82 | height: 10px ; |
  |  | 83 | margin: 0 5px ; |
  |  | 84 | outline: 0 ; |
  |  | 85 | -moz-border-radius: 5px ; |
  |  | 86 | -webkit-border-radius: 5px ; |
  |  | 87 | border-radius: 5px ; |
  | 88 | 88 | } |
  | 89 | 89 |  |
  | 90 | 90 | .bx-wrapper\_ .bx-pager.bx-default-pager a:hover, |
  | 91 | 91 | .bx-wrapper\_ .bx-pager.bx-default-pager a.active { |
  | 92 |  | background: #000 ~~!important~~; |
  |  | 92 | background: #000 ; |
  | 93 | 93 | } |
  | 94 | 94 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L96) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L96) |  |
  | 96 | 96 |  |
  | 97 | 97 | .bx-wrapper\_ .bx-prev { |
  | 98 |  | left: 7px ~~!important~~; |
  | 99 |  | background: url(../images/controls.png) no-repeat 0 -32px ~~!important~~; |
  |  | 98 | left: 7px ; |
  |  | 99 | background: url(../images/controls.png) no-repeat 0 -32px ; |
  | 100 | 100 | } |
  | 101 | 101 |  |
  | 102 | 102 | .bx-wrapper\_ .bx-next { |
  | 103 |  | right: 7px ~~!important~~; |
  | 104 |  | background: url(../images/controls.png) no-repeat -43px -32px ~~!important~~; |
  |  | 103 | right: 7px ; |
  |  | 104 | background: url(../images/controls.png) no-repeat -43px -32px ; |
  | 105 | 105 | } |
  | 106 | 106 |  |
  | 107 | 107 | .bx-wrapper\_ .bx-prev:hover { |
  | 108 |  | background-position: 0 0 ~~!important~~; |
  |  | 108 | background-position: 0 0 ; |
  | 109 | 109 | } |
  | 110 | 110 |  |
  | 111 | 111 | .bx-wrapper\_ .bx-next:hover { |
  | 112 |  | background-position: -43px 0 ~~!important~~; |
  |  | 112 | background-position: -43px 0 ; |
  | 113 | 113 | } |
  | 114 | 114 |  |
  | 115 | 115 | .bx-wrapper\_ .bx-controls-direction a { |
  | 116 |  | position: absolute ~~!important~~; |
  | 117 |  | top: 50% ~~!important~~; |
  |  | 116 | position: absolute ; |
  |  | 117 | top: 50% ; |
  | 118 | 118 | margin-top: -10px ; |
  | 119 |  | outline: 0 ~~!important~~; |
  | 120 |  | width: 32px ~~!important~~; |
  | 121 |  | height: 32px ~~!important~~; |
  | 122 |  | text-indent: -9999px ~~!important~~; |
  | 123 |  | z-index: 9999 ~~!important~~; |
  |  | 119 | outline: 0 ; |
  |  | 120 | width: 32px ; |
  |  | 121 | height: 32px ; |
  |  | 122 | text-indent: -9999px ; |
  |  | 123 | z-index: 9999 ; |
  | 124 | 124 | } |
  | 125 | 125 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L127) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L127) |  |
  | 127 | 127 | .nextButton\_{ z-index: 10000;float:right;margin-top: -4px} |
  | 128 | 128 | .prevButton\_ .bx-prev{ |
  | 129 |  | height: 32px ~~!important~~; |
  | 130 |  | outline: 0 none ~~!important~~; |
  | 131 |  | position: absolute ~~!important~~; |
  | 132 |  | text-indent: -9999px ~~!important~~; |
  | 133 |  | width: 32px ~~!important~~; |
  | 134 |  | z-index: 1000 ~~!important~~; |
  |  | 129 | height: 32px ; |
  |  | 130 | outline: 0 none ; |
  |  | 131 | position: absolute ; |
  |  | 132 | text-indent: -9999px ; |
  |  | 133 | width: 32px ; |
  |  | 134 | z-index: 1000 ; |
  | 135 | 135 | background: rgba(0, 0, 0, 0) url("../images/controls.png") no-repeat scroll 0 -32px; |
  | 136 | 136 | left: 10px; |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L141) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L141) |  |
  | 141 | 141 |  |
  | 142 | 142 |  |
  | 143 |  | height: 32px ~~!important~~; |
  | 144 |  | outline: 0 none ~~!important~~; |
  | 145 |  | position: absolute ~~!important~~; |
  | 146 |  | text-indent: -9999px ~~!important~~; |
  | 147 |  | width: 32px ~~!important~~; |
  | 148 |  | z-index: 1000 ~~!important~~; |
  |  | 143 | height: 32px ; |
  |  | 144 | outline: 0 none ; |
  |  | 145 | position: absolute ; |
  |  | 146 | text-indent: -9999px ; |
  |  | 147 | width: 32px ; |
  |  | 148 | z-index: 1000 ; |
  | 149 | 149 | background: rgba(0, 0, 0, 0) url("../images/controls.png") no-repeat scroll -43px -32px; |
  | 150 | 150 | right: 10px; |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L152) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L152) |  |
  | 152 | 152 | } |
  | 153 | 153 | .prevButton\_ .bx-prev:hover { |
  | 154 |  | background-position: 0 0 ~~!important~~; |
  |  | 154 | background-position: 0 0 ; |
  | 155 | 155 | } |
  | 156 | 156 | .nextButton\_ .bx-next:hover { |
  | 157 |  | background-position: -43px 0 ~~!important~~; |
  |  | 157 | background-position: -43px 0 ; |
  | 158 | 158 | } |
  | 159 | 159 |  |
  | 160 | 160 | .bx-wrapper\_ .bx-controls-direction a.disabled { |
  | 161 |  | display: none ~~!important~~; |
  |  | 161 | display: none ; |
  | 162 | 162 | } |
  | 163 | 163 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L165) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L165) |  |
  | 165 | 165 |  |
  | 166 | 166 | .bx-wrapper\_ .bx-controls-auto { |
  | 167 |  | text-align: center ~~!important~~; |
  |  | 167 | text-align: center ; |
  | 168 | 168 | } |
  | 169 | 169 |  |
  | 170 | 170 | .bx-wrapper\_ .bx-controls-auto .bx-start { |
  | 171 |  | display: block ~~!important~~; |
  | 172 |  | text-indent: -9999px ~~!important~~; |
  | 173 |  | width: 10px ~~!important~~; |
  | 174 |  | height: 11px ~~!important~~; |
  | 175 |  | outline: 0 ~~!important~~; |
  | 176 |  | background: url(../images/controls.png) -86px -11px no-repeat ~~!important~~; |
  | 177 |  | margin: 0 3px ~~!important~~; |
  |  | 171 | display: block ; |
  |  | 172 | text-indent: -9999px ; |
  |  | 173 | width: 10px ; |
  |  | 174 | height: 11px ; |
  |  | 175 | outline: 0 ; |
  |  | 176 | background: url(../images/controls.png) -86px -11px no-repeat ; |
  |  | 177 | margin: 0 3px ; |
  | 178 | 178 | } |
  | 179 | 179 |  |
  | 180 | 180 | .bx-wrapper\_ .bx-controls-auto .bx-start:hover, |
  | 181 | 181 | .bx-wrapper\_ .bx-controls-auto .bx-start.active { |
  | 182 |  | background-position: -86px 0 ~~!important~~; |
  |  | 182 | background-position: -86px 0 ; |
  | 183 | 183 | } |
  | 184 | 184 |  |
  | 185 | 185 | .bx-wrapper\_ .bx-controls-auto .bx-stop { |
  | 186 |  | display: block ~~!important~~; |
  | 187 |  | text-indent: -9999px ~~!important~~; |
  | 188 |  | width: 9px ~~!important~~; |
  | 189 |  | height: 11px ~~!important~~; |
  | 190 |  | outline: 0 ~~!important~~; |
  | 191 |  | background: url(../images/controls.png) -86px -44px no-repeat ~~!important~~; |
  | 192 |  | margin: 0 3px ~~!important~~; |
  |  | 186 | display: block ; |
  |  | 187 | text-indent: -9999px ; |
  |  | 188 | width: 9px ; |
  |  | 189 | height: 11px ; |
  |  | 190 | outline: 0 ; |
  |  | 191 | background: url(../images/controls.png) -86px -44px no-repeat ; |
  |  | 192 | margin: 0 3px ; |
  | 193 | 193 | } |
  | 194 | 194 |  |
  | 195 | 195 | .bx-wrapper\_ .bx-controls-auto .bx-stop:hover, |
  | 196 | 196 | .bx-wrapper\_ .bx-controls-auto .bx-stop.active { |
  | 197 |  | background-position: -86px -33px ~~!important~~; |
  |  | 197 | background-position: -86px -33px ; |
  | 198 | 198 | } |
  | 199 | 199 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L201) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L201) |  |
  | 201 | 201 |  |
  | 202 | 202 | .bx-wrapper\_ .bx-controls.bx-has-controls-auto.bx-has-pager .bx-pager { |
  | 203 |  | text-align: left ~~!important~~; |
  | 204 |  | width: 80% ~~!important~~; |
  |  | 203 | text-align: left ; |
  |  | 204 | width: 80% ; |
  | 205 | 205 | } |
  | 206 | 206 |  |
  | 207 | 207 | .bx-wrapper\_ .bx-controls.bx-has-controls-auto.bx-has-pager .bx-controls-auto { |
  | 208 |  | right: 0 ~~!important~~; |
  | 209 |  | width: 35px ~~!important~~; |
  |  | 208 | right: 0 ; |
  |  | 209 | width: 35px ; |
  | 210 | 210 | } |
  | 211 | 211 |  |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L213) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L213) |  |
  | 213 | 213 |  |
  | 214 | 214 | .bx-wrapper\_ .bx-caption { |
  | 215 |  | position: absolute ~~!important~~; |
  | 216 |  | bottom: 0 ~~!important~~; |
  | 217 |  | left: 0 ~~!important~~; |
  | 218 |  | background: #666\9 ~~!important~~; |
  | 219 |  | background: rgba(80, 80, 80, 0.75) ~~!important~~; |
  | 220 |  | width: 100% ~~!important~~; |
  |  | 215 | position: absolute ; |
  |  | 216 | bottom: 0 ; |
  |  | 217 | left: 0 ; |
  |  | 218 | background: #666\9 ; |
  |  | 219 | background: rgba(80, 80, 80, 0.75) ; |
  |  | 220 | width: 100% ; |
  | 221 | 221 | border-bottom-left-radius: 5px; |
  | 222 | 222 | border-bottom-right-radius: 5px; |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L225) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L225) |  |
  | 225 | 225 |  |
  | 226 | 226 | .bx-wrapper\_ .bx-caption span { |
  | 227 |  | color: #fff ~~!important~~; |
  | 228 |  | font-family: Arial ~~!important~~; |
  | 229 |  | display: block ~~!important~~; |
  | 230 |  | font-size: .85em ~~!important~~; |
  | 231 |  | padding: 10px ~~!important~~; |
  |  | 227 | color: #fff ; |
  |  | 228 | font-family: Arial ; |
  |  | 229 | display: block ; |
  |  | 230 | font-size: .85em ; |
  |  | 231 | padding: 10px ; |
  | 232 | 232 |  |
  | 233 | 233 | } |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L235) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L235) |  |
  | 235 | 235 | .circle-img { |
  | 236 | 236 | border-radius: 50%; |
  | 237 |  | border:7px solid #cccccc; |
  | 238 |  | } |
  | 239 |  |  |
  |  | 237 |  |
  |  | 238 | } |
  | 240 | 239 | .circle-img img{cursor: pointer} |
  | 241 |  | .image\_error{color:red ~~!important~~;} |
  | 242 |  | .succMsg{background:#E2F3DA  ~~!important;border: 1px solid #9ADF8F !important;color:#556652 !important ;padding:8px 8px 8px 36px !important;text-align:left !important;margin:5px !important;margin-left: 0px !important;margin-top: 30px !important;width:505px !important~~;} |
  | 243 |  | .errMsg{background:#FFCECE  ~~!important;border: 1px solid #DF8F8F !important;color:#665252 !important ;padding:8px 8px 8px 36px !important; text-align:left !important;margin:5px !important;margin-left: 0px !important;margin-top: 30px !important;width:505px !important~~ ;} |
  | 244 |  | .uparrow{text-align: center ~~!important~~ ;} |
  | 245 |  | .uparrow img{cursor: pointer ~~!important;background: none !important;border: none !important;margin: 0 0px 0px 0 !important;padding: 0px !important;max-width: auto !important~~;} |
  |  | 240 | .image\_error{color:red ;} |
  |  | 241 | .succMsg{background:#E2F3DA  ;border: 1px solid #9ADF8F ;color:#556652  ;padding:8px 8px 8px 36px ;text-align:left ;margin:5px ;margin-left: 0px ;margin-top: 30px ;width:505px ;} |
  |  | 242 | .errMsg{background:#FFCECE  ;border: 1px solid #DF8F8F ;color:#665252  ;padding:8px 8px 8px 36px ; text-align:left ;margin:5px ;margin-left: 0px ;margin-top: 30px ;width:505px  ;} |
  |  | 243 | .uparrow{text-align: center  ;} |
  |  | 244 | .uparrow img{cursor: pointer ;background: none ;border: none ;margin: 0 0px 0px 0 ;padding: 0px ;max-width: auto ;} |
  | 246 | 245 | .downarrow{text-align: center } |
  | 247 |  | .downarrow img{cursor: pointer ~~!important;background: none !important ;border: none !important;margin: 0 0px 0px 0 !important;padding: 0px !important;max-width: auto !important~~;} |
  | 248 |  | .verticalmainTable{margin: 0 auto ~~!important~~;} |
  |  | 246 | .downarrow img{cursor: pointer ;background: none  ;border: none ;margin: 0 0px 0px 0 ;padding: 0px ;max-width: auto ;} |
  |  | 247 | .verticalmainTable{margin: 0 auto ;} |
  | 249 | 248 | .verticalmainSliderDiv{} |
  | 250 | 249 | .sliderUl{} |
  | 251 |  | .sliderimgLiVertical{list-style-type:none ~~!important ;padding:0px !important;margin:0px !important;background: none !important~~;} |
  | 252 |  | .sliderimgLiVertical img{background: white ~~!important;border: 1px solid #CCCCCC !important;padding: 12px !important  !important;margin: 7px !important;border-radius:10px !important~~;} |
  | 253 |  | .printCode{background: lightYellow none repeat scroll 0 0 ~~!important;border: 1px inset orange !important;height: 36px !important;margin: 10px !important;overflow: auto !important;padding: 6px !important;text-align: left !important;color: black !important;width:100% !important~~;} |
  |  | 250 | .sliderimgLiVertical{list-style-type:none  ;padding:0px ;margin:0px ;background: none ;} |
  |  | 251 | .sliderimgLiVertical img{background: white ;border: 1px solid #CCCCCC ;padding: 12px   ;margin: 7px ;border-radius:10px ;} |
  |  | 252 | .printCode{background: lightYellow none repeat scroll 0 0 ;border: 1px inset orange ;height: 36px ;margin: 10px ;overflow: auto ;padding: 6px ;text-align: left ;color: black ;width:100% ;} |
  | 254 | 253 | #gridTbl{width: 100%;} |
  | 255 | 254 | .table{width:100%;margin-bottom:18px;}.table th,.table td{padding:8px;line-height:18px;text-align:left;vertical-align:top;border-top:1px solid #E1E1E1} |
  | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1206450#L269) | […](/browser/circle-image-slider-with-lightbox/trunk/css/images-circle-thumbnail-slider-plus-lighbox-style.css?rev=1269993#L268) |  |
  | 269 | 268 | .alignCenter{text-align: center;} |
  | 270 | 269 | .myCaption .mycaption\_title{text-align: center;margin: 6px;cursor: pointer;} |
  | 271 |  | .myCaption .mycaption\_title a{font-size:17px;color:#1d46b7} |
  | 272 |  | .myCaption  .mycaption\_content{text-align: center;  position: relative;margin: 6px;word-wrap: break-word;} |
  | 273 |  | .Captionlink{color:#000000;cursor: pointer;word-wrap: break-word;border: 0px !important} |
  | 274 |  |  |
  |  | 270 | .myCaption  .mycaption\_content{text-align: center;  position: relative;word-wrap: break-word;} |
  |  | 271 | .Captionlink{color:#000000;cursor: pointer;word-wrap: break-word;border: 0px } |
  |  | 272 |  |
* ## [circle-image-slider-with-lightbox/trunk/js/images-circle-thumbnail-slider-plus-lightbox-jc.js](/changeset/1269993/circle-image-slider-with-lightbox/trunk/js/images-circle-thumbnail-slider-plus-lightbox-jc.js "Show the changeset 1269993 restricted to circle-image-slider-with-lightbox/trunk/js/images-circle-thumbnail-slider-plus-lightbox-jc.js")

  | [r1206450](/browser/circle-image-slider-with-lightbox/trunk/js/images-circle-thumbnail-slider-plus-lightbox-jc.js?rev=1206450#L1 "Show revision 1206450 of this file in browser") | [r1269993](/browser/circle-image-slider-with-lightbox/trunk/js/images-circle-thumbnail-slider-plus-lightbox-jc.js?rev=1269993#L1 "Show revision 1269993 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | /\*\* |
  | 2 |  | \* BxSlider v4.1.1 - Fully loaded, responsive content slider |
  | 3 |  | \* http://bxslider.com |
  | 4 |  | \* |
  | 5 |  | \* Copyright 2012, Steven Wanderski - http://stevenwanderski.com - http://bxcreative.com |
  |  | 2 | \* bxSlider v4.2.4 |
  |  | 3 | \* Copyright 2013-2015 Steven Wanderski |
  | 6 | 4 | \* Written while drinking Belgian ales and listening to jazz |
  | 7 |  | \* |
  | 8 |  | \* Released under the WTFPL license - http://sam.zoy.org/wtfpl/ |
  |  | 5 | \* Licensed under MIT (http://opensource.org/licenses/MIT) |
  | 9 | 6 | \*/ |
  | 10 | 7 |  |
  | 11 |  | ;(function($){ |
  | 12 |  |  |
  | 13 |  | var plugin = {}; |
  | 14 |  |  |
  | 15 |  | var defaults = { |
  | 16 |  |  |
  | 17 |  | // GENERAL |
  | 18 |  | mode: 'horizontal', |
  | 19 |  | slideSelector: '', |
  | 20 |  | infiniteLoop: true, |
  | 21 |  | hideControlOnEnd: false, |
  | 22 |  | speed: 500, |
  | 23 |  | easing: null, |
  | 24 |  | slideMargin: 0, |
  | 25 |  | startSlide: 0, |
  | 26 |  | randomStart: false, |
  | 27 |  | captions: false, |
  | 28 |  | ticker: false, |
  | 29 |  | tickerHover: false, |
  | 30 |  | adaptiveHeight: false, |
  | 31 |  | adaptiveHeightSpeed: 500, |
  | 32 |  | video: false, |
  | 33 |  | useCSS: true, |
  | 34 |  | preloadImages: 'visible', |
  | 35 |  | responsive: true, |
  | 36 |  |  |
  | 37 |  | // TOUCH |
  | 38 |  | touchEnabled: true, |
  | 39 |  | swipeThreshold: 50, |
  | 40 |  | oneToOneTouch: true, |
  | 41 |  | preventDefaultSwipeX: true, |
  | 42 |  | preventDefaultSwipeY: false, |
  | 43 |  |  |
  | 44 |  | // PAGER |
  | 45 |  | pager: true, |
  | 46 |  | pagerType: 'full', |
  | 47 |  | pagerShortSeparator: ' / ', |
  | 48 |  | pagerSelector: null, |
  | 49 |  | buildPager: null, |
  | 50 |  | pagerCustom: null, |
  | 51 |  |  |
  | 52 |  | // CONTROLS |
  | 53 |  | controls: true, |
  | 54 |  | nextText: 'Next', |
  | 55 |  | prevText: 'Prev', |
  | 56 |  | nextSelector: null, |
  | 57 |  | prevSelector: null, |
  | 58 |  | autoControls: false, |
  | 59 |  | startText: 'Start', |
  | 60 |  | stopText: 'Stop', |
  | 61 |  | autoControlsCombine: false, |
  | 62 |  | autoControlsSelector: null, |
  | 63 |  |  |
  | 64 |  | // AUTO |
  | 65 |  | auto: false, |
  | 66 |  | pause: 4000, |
  | 67 |  | autoStart: true, |
  | 68 |  | autoDirection: 'next', |
  | 69 |  | autoHover: false, |
  | 70 |  | autoDelay: 0, |
  | 71 |  |  |
  | 72 |  | // CAROUSEL |
  | 73 |  | minSlides: 1, |
  | 74 |  | maxSlides: 1, |
  | 75 |  | moveSlides: 0, |
  | 76 |  | slideWidth: 0, |
  | 77 |  |  |
  | 78 |  | // CALLBACKS |
  | 79 |  | onSliderLoad: function() {}, |
  | 80 |  | onSlideBefore: function() {}, |
  | 81 |  | onSlideAfter: function() {}, |
  | 82 |  | onSlideNext: function() {}, |
  | 83 |  | onSlidePrev: function() {} |
  | 84 |  | } |
  | 85 |  |  |
  | 86 |  | $.fn.bxSlider\_ = function(options){ |
  | 87 |  |  |
  | 88 |  | if(this.length == 0) return this; |
  | 89 |  |  |
  | 90 |  | // support mutltiple elements |
  | 91 |  | if(this.length > 1){ |
  | 92 |  | this.each(function(){$(this).bxSlider\_(options)}); |
  | 93 |  | return this; |
  | 94 |  | } |
  | 95 |  |  |
  | 96 |  | // create a namespace to be used throughout the plugin |
  | 97 |  | var slider = {}; |
  | 98 |  | // set a reference to our slider element |
  | 99 |  | var el = this; |
  | 100 |  | plugin.el = this; |
  | 101 |  |  |
  | 102 |  | /\*\* |
  | 103 |  | \* Makes slideshow responsive |
  | 104 |  | \*/ |
  | 105 |  | // first get the original window dimens (thanks alot IE) |
  | 106 |  | var windowWidth = $(window).width(); |
  | 107 |  | var windowHeight = $(window).height(); |
  | 108 |  |  |
  | 109 |  |  |
  | 110 |  |  |
  | 111 |  | /\*\* |
  | 112 |  | \* =================================================================================== |
  | 113 |  | \* = PRIVATE FUNCTIONS |
  | 114 |  | \* =================================================================================== |
  | 115 |  | \*/ |
  | 116 |  |  |
  | 117 |  | /\*\* |
  | 118 |  | \* Initializes namespace settings to be used throughout plugin |
  | 119 |  | \*/ |
  | 120 |  | var init = function(){ |
  | 121 |  | // merge user-supplied options with the defaults |
  | 122 |  | slider.settings = $.extend({}, defaults, options); |
  | 123 |  | // parse slideWidth setting |
  | 124 |  | slider.settings.slideWidth = parseInt(slider.settings.slideWidth); |
  | 125 |  | // store the original children |
  | 126 |  | slider.children = el.children(slider.settings.slideSelector); |
  | 127 |  | // check if actual number of slides is less than minSlides / maxSlides |
  | 128 |  | if(slider.children.length < slider.settings.minSlides) slider.settings.minSlides = slider.children.length; |
  | 129 |  | if(slider.children.length < slider.settings.maxSlides) slider.settings.maxSlides = slider.children.length; |
  | 130 |  | // if random start, set the startSlide setting to random number |
  | 131 |  | if(slider.settings.randomStart) slider.settings.startSlide = Math.floor(Math.random() \* slider.children.length); |
  | 132 |  | // store active slide information |
  | 133 |  | slider.active = { index: slider.settings.startSlide } |
  | 134 |  | // store if the slider is in carousel mode (displaying / moving multiple slides) |
  | 135 |  | slider.carousel = slider.settings.minSlides > 1 || slider.settings.maxSlides > 1; |
  | 136 |  | // if carousel, force preloadImages = 'all' |
  | 137 |  | if(slider.carousel) slider.settings.preloadImages = 'all'; |
  | 138 |  | // calculate the min / max width thresholds based on min / max number of slides |
  | 139 |  | // used to setup and update carousel slides dimensions |
  | 140 |  | slider.minThreshold = (slider.settings.minSlides \* slider.settings.slideWidth) + ((slider.settings.minSlides - 1) \* slider.settings.slideMargin); |
  | 141 |  | slider.maxThreshold = (slider.settings.maxSlides \* slider.settings.slideWidth) + ((slider.settings.maxSlides - 1) \* slider.settings.slideMargin); |
  | 142 |  | // store the current state of the slider (if currently animating, working is true) |
  | 143 |  | slider.working = false; |
  | 144 |  | // initialize the controls object |
  | 145 |  | slider.controls = {}; |
  | 146 |  | // initialize an auto interval |
  | 147 |  | slider.interval = null; |
  | 148 |  | // determine which property to use for transitions |
  | 149 |  | slider.animProp = slider.settings.mode == 'vertical' ? 'top' : 'left'; |
  | 150 |  | // determine if hardware acceleration can be used |
  | 151 |  | slider.usingCSS = slider.settings.useCSS && slider.settings.mode != 'fade' && (function(){ |
  | 152 |  | // create our test div element |
  | 153 |  | var div = document.createElement('div'); |
  | 154 |  | // css transition properties |
  | 155 |  | var props = ['WebkitPerspective', 'MozPerspective', 'OPerspective', 'msPerspective']; |
  | 156 |  | // test for each property |
  | 157 |  | for(var i in props){ |
  | 158 |  | if(div.style[props[i]] !== undefined){ |
  | 159 |  | slider.cssPrefix = props[i].replace('Perspective', '').toLowerCase(); |
  | 160 |  | slider.animProp = '-' + slider.cssPrefix + '-transform'; |
  | 161 |  | return true; |
  | 162 |  | } |
  | 163 |  | } |
  | 164 |  | return false; |
  | 165 |  | }()); |
  | 166 |  | // if vertical mode always make maxSlides and minSlides equal |
  | 167 |  | if(slider.settings.mode == 'vertical') slider.settings.maxSlides = slider.settings.minSlides; |
  | 168 |  | // save original style data |
  | 169 |  | el.data("origStyle", el.attr("style")); |
  | 170 |  | el.children(slider.settings.slideSelector).each(function() { |
  | 171 |  | $(this).data("origStyle", $(this).attr("style")); |
  | 172 |  | }); |
  | 173 |  | // perform all DOM / CSS modifications |
  | 174 |  | setup(); |
  | 175 |  | } |
  | 176 |  |  |
  | 177 |  | /\*\* |
  | 178 |  | \* Performs all DOM and CSS modifications |
  | 179 |  | \*/ |
  | 180 |  | var setup = function(){ |
  | 181 |  | // wrap el in a wrapper |
  | 182 |  | el.wrap('<div class="bx-wrapper\_"><div class="bx-viewport\_"></div></div>'); |
  | 183 |  | // store a namspace reference to .bx-viewport\_ |
  | 184 |  | slider.viewport = el.parent(); |
  | 185 |  | // add a loading div to display while images are loading |
  | 186 |  | slider.loader = $('<div class="bx-loading" />'); |
  | 187 |  | slider.viewport.prepend(slider.loader); |
  | 188 |  | // set el to a massive width, to hold any needed slides |
  | 189 |  | // also strip any margin and padding from el |
  | 190 |  | el.css({ |
  | 191 |  | width: slider.settings.mode == 'horizontal' ? (slider.children.length \* 100 + 215) + '%' : 'auto', |
  | 192 |  | position: 'relative' |
  | 193 |  | }); |
  | 194 |  | // if using CSS, add the easing property |
  | 195 |  | if(slider.usingCSS && slider.settings.easing){ |
  | 196 |  | el.css('-' + slider.cssPrefix + '-transition-timing-function', slider.settings.easing); |
  | 197 |  | // if not using CSS and no easing value was supplied, use the default JS animation easing (swing) |
  | 198 |  | }else if(!slider.settings.easing){ |
  | 199 |  | slider.settings.easing = 'swing'; |
  | 200 |  | } |
  | 201 |  | var slidesShowing = getNumberSlidesShowing(); |
  | 202 |  | // make modifications to the viewport (.bx-viewport\_) |
  | 203 |  | slider.viewport.css({ |
  | 204 |  | width: '100%', |
  | 205 |  | overflow: 'hidden', |
  | 206 |  | position: 'relative' |
  | 207 |  | }); |
  | 208 |  | slider.viewport.parent().css({ |
  | 209 |  | maxWidth: getViewportMaxWidth() |
  | 210 |  | }); |
  | 211 |  | // make modification to the wrapper (.bx-wrapper\_) |
  | 212 |  | if(!slider.settings.pager) { |
  | 213 |  | slider.viewport.parent().css({ |
  | 214 |  | margin: '0 auto 0px' |
  | 215 |  | }); |
  | 216 |  | } |
  | 217 |  | // apply css to all slider children |
  | 218 |  | slider.children.css({ |
  | 219 |  | 'float': slider.settings.mode == 'horizontal' ? 'left' : 'none', |
  | 220 |  | listStyle: 'none', |
  | 221 |  | position: 'relative' |
  | 222 |  | }); |
  | 223 |  | // apply the calculated width after the float is applied to prevent scrollbar interference |
  | 224 |  | slider.children.css('width', getSlideWidth()); |
  | 225 |  | // if slideMargin is supplied, add the css |
  | 226 |  | if(slider.settings.mode == 'horizontal' && slider.settings.slideMargin > 0) slider.children.css('marginRight', slider.settings.slideMargin); |
  | 227 |  | if(slider.settings.mode == 'vertical' && slider.settings.slideMargin > 0) slider.children.css('marginBottom', slider.settings.slideMargin); |
  | 228 |  | // if "fade" mode, add positioning and z-index CSS |
  | 229 |  | if(slider.settings.mode == 'fade'){ |
  | 230 |  | slider.children.css({ |
  | 231 |  | position: 'absolute', |
  | 232 |  | zIndex: 0, |
  | 233 |  | display: 'none' |
  | 234 |  | }); |
  | 235 |  | // prepare the z-index on the showing element |
  | 236 |  | slider.children.eq(slider.settings.startSlide).css({zIndex: 50, display: 'block'}); |
  | 237 |  | } |
  | 238 |  | // create an element to contain all slider controls (pager, start / stop, etc) |
  | 239 |  | slider.controls.el = $('<div class="bx-controls" />'); |
  | 240 |  | // if captions are requested, add them |
  | 241 |  | if(slider.settings.captions) appendCaptions(); |
  | 242 |  | // check if startSlide is last slide |
  | 243 |  | slider.active.last = slider.settings.startSlide == getPagerQty() - 1; |
  | 244 |  | // if video is true, set up the fitVids plugin |
  | 245 |  | if(slider.settings.video) el.fitVids(); |
  | 246 |  | // set the default preload selector (visible) |
  | 247 |  | var preloadSelector = slider.children.eq(slider.settings.startSlide); |
  | 248 |  | if (slider.settings.preloadImages == "all") preloadSelector = slider.children; |
  | 249 |  | // only check for control addition if not in "ticker" mode |
  | 250 |  | if(!slider.settings.ticker){ |
  | 251 |  | // if pager is requested, add it |
  | 252 |  | if(slider.settings.pager) appendPager(); |
  | 253 |  | // if controls are requested, add them |
  | 254 |  | if(slider.settings.controls) appendControls(); |
  | 255 |  | // if auto is true, and auto controls are requested, add them |
  | 256 |  | if(slider.settings.auto && slider.settings.autoControls) appendControlsAuto(); |
  | 257 |  | // if any control option is requested, add the controls wrapper |
  | 258 |  | if(slider.settings.controls || slider.settings.autoControls || slider.settings.pager) slider.viewport.after(slider.controls.el); |
  | 259 |  | // if ticker mode, do not allow a pager |
  | 260 |  | }else{ |
  | 261 |  | slider.settings.pager = false; |
  | 262 |  | } |
  | 263 |  | // preload all images, then perform final DOM / CSS modifications that depend on images being loaded |
  | 264 |  | loadElements(preloadSelector, start); |
  | 265 |  | } |
  | 266 |  |  |
  | 267 |  | var loadElements = function(selector, callback){ |
  | 268 |  | var total = selector.find('img, iframe').length; |
  | 269 |  | if (total == 0){ |
  | 270 |  | callback(); |
  | 271 |  | return; |
  | 272 |  | } |
  | 273 |  | var count = 0; |
  | 274 |  | selector.find('img, iframe').each(function(){ |
  | 275 |  | if($(this).is('img')) $(this).attr('src', $(this).attr('src') + '?timestamp=' + new Date().getTime()); |
  | 276 |  | $(this).load(function(){ |
  | 277 |  | setTimeout(function(){ |
  | 278 |  | if(++count == total) callback(); |
  | 279 |  | }, 0) |
  | 280 |  | }); |
  | 281 |  | }); |
  | 282 |  | } |
  | 283 |  |  |
  | 284 |  | /\*\* |
  | 285 |  | \* Start the slider |
  | 286 |  | \*/ |
  | 287 |  | var start = function(){ |
  | 288 |  | // if infinite loop, prepare additional slides |
  | 289 |  | if(slider.settings.infiniteLoop && slider.settings.mode != 'fade' && !slider.settings.ticker){ |
  | 290 |  | var slice = slider.settings.mode == 'vertical' ? slider.settings.minSlides : slider.settings.maxSlides; |
  | 291 |  | var sliceAppend = slider.children.slice(0, slice).clone().addClass('bx-clone'); |
  | 292 |  | var slicePrepend = slider.children.slice(-slice).clone().addClass('bx-clone'); |
  | 293 |  | el.append(sliceAppend).prepend(slicePrepend); |
  | 294 |  | } |
  | 295 |  | // remove the loading DOM element |
  | 296 |  | slider.loader.remove(); |
  | 297 |  | // set the left / top position of "el" |
  | 298 |  | setSlidePosition(); |
  | 299 |  | // if "vertical" mode, always use adaptiveHeight to prevent odd behavior |
  | 300 |  | if (slider.settings.mode == 'vertical') slider.settings.adaptiveHeight = true; |
  | 301 |  | // set the viewport height |
  | 302 |  | slider.viewport.height(getViewportHeight()); |
  | 303 |  | // make sure everything is positioned just right (same as a window resize) |
  | 304 |  | el.redrawSlider(); |
  | 305 |  | // onSliderLoad callback |
  | 306 |  | slider.settings.onSliderLoad(slider.active.index); |
  | 307 |  | // slider has been fully initialized |
  | 308 |  | slider.initialized = true; |
  | 309 |  | // bind the resize call to the window |
  | 310 |  | if (slider.settings.responsive) $(window).bind('resize', resizeWindow); |
  | 311 |  | // if auto is true, start the show |
  | 312 |  | if (slider.settings.auto && slider.settings.autoStart) initAuto(); |
  | 313 |  | // if ticker is true, start the ticker |
  | 314 |  | if (slider.settings.ticker) initTicker(); |
  | 315 |  | // if pager is requested, make the appropriate pager link active |
  | 316 |  | if (slider.settings.pager) updatePagerActive(slider.settings.startSlide); |
  | 317 |  | // check for any updates to the controls (like hideControlOnEnd updates) |
  | 318 |  | if (slider.settings.controls) updateDirectionControls(); |
  | 319 |  | // if touchEnabled is true, setup the touch events |
  | 320 |  | if (slider.settings.touchEnabled && !slider.settings.ticker) initTouch(); |
  | 321 |  | } |
  | 322 |  |  |
  | 323 |  | /\*\* |
  | 324 |  | \* Returns the calculated height of the viewport, used to determine either adaptiveHeight or the maxHeight value |
  | 325 |  | \*/ |
  | 326 |  | var getViewportHeight = function(){ |
  | 327 |  | var height = 0; |
  | 328 |  | // first determine which children (slides) should be used in our height calculation |
  | 329 |  | var children = $(); |
  | 330 |  | // if mode is not "vertical" and adaptiveHeight is false, include all children |
  | 331 |  | if(slider.settings.mode != 'vertical' && !slider.settings.adaptiveHeight){ |
  | 332 |  | children = slider.children; |
  | 333 |  | }else{ |
  | 334 |  | // if not carousel, return the single active child |
  | 335 |  | if(!slider.carousel){ |
  | 336 |  | children = slider.children.eq(slider.active.index); |
  | 337 |  | // if carousel, return a slice of children |
  | 338 |  | }else{ |
  | 339 |  | // get the individual slide index |
  | 340 |  | var currentIndex = slider.settings.moveSlides == 1 ? slider.active.index : slider.active.index \* getMoveBy(); |
  | 341 |  | // add the current slide to the children |
  | 342 |  | children = slider.children.eq(currentIndex); |
  | 343 |  | // cycle through the remaining "showing" slides |
  | 344 |  | for (i = 1; i <= slider.settings.maxSlides - 1; i++){ |
  | 345 |  | // if looped back to the start |
  | 346 |  | if(currentIndex + i >= slider.children.length){ |
  | 347 |  | children = children.add(slider.children.eq(i - 1)); |
  | 348 |  | }else{ |
  | 349 |  | children = children.add(slider.children.eq(currentIndex + i)); |
  | 350 |  | } |
  | 351 |  | } |
  | 352 |  | } |
  | 353 |  | } |
  | 354 |  | // if "vertical" mode, calculate the sum of the heights of the children |
  | 355 |  | if(slider.settings.mode == 'vertical'){ |
  | 356 |  | children.each(function(index) { |
  | 357 |  | height += $(this).outerHeight(); |
  | 358 |  | }); |
  | 359 |  | // add user-supplied margins |
  | 360 |  | if(slider.settings.slideMargin > 0){ |
  | 361 |  | height += slider.settings.slideMargin \* (slider.settings.minSlides - 1); |
  | 362 |  | } |
  | 363 |  | // if not "vertical" mode, calculate the max height of the children |
  | 364 |  | }else{ |
  | 365 |  | height = Math.max.apply(Math, children.map(function(){ |
  | 366 |  | return $(this).outerHeight(false); |
  | 367 |  | }).get()); |
  | 368 |  | } |
  | 369 |  | return height; |
  | 370 |  | } |
  | 371 |  |  |
  | 372 |  | /\*\* |
  | 373 |  | \* Returns the calculated width to be used for the outer wrapper / viewport |
  | 374 |  | \*/ |
  | 375 |  | var getViewportMaxWidth = function(){ |
  | 376 |  | var width = '100%'; |
  | 377 |  | if(slider.settings.slideWidth > 0){ |
  | 378 |  | if(slider.settings.mode == 'horizontal'){ |
  | 379 |  | width = (slider.settings.maxSlides \* slider.settings.slideWidth) + ((slider.settings.maxSlides - 1) \* slider.settings.slideMargin); |
  | 380 |  | }else{ |
  | 381 |  | width = slider.settings.slideWidth; |
  | 382 |  | } |
  | 383 |  | } |
  | 384 |  | return width; |
  | 385 |  | } |
  | 386 |  |  |
  | 387 |  | /\*\* |
  | 388 |  | \* Returns the calculated width to be applied to each slide |
  | 389 |  | \*/ |
  | 390 |  | var getSlideWidth = function(){ |
  | 391 |  | // start with any user-supplied slide width |
  | 392 |  | var newElWidth = slider.settings.slideWidth; |
  | 393 |  | // get the current viewport width |
  | 394 |  | var wrapWidth = slider.viewport.width(); |
  | 395 |  | // if slide width was not supplied, or is larger than the viewport use the viewport width |
  | 396 |  | if(slider.settings.slideWidth == 0 || |
  | 397 |  | (slider.settings.slideWidth > wrapWidth && !slider.carousel) || |
  | 398 |  | slider.settings.mode == 'vertical'){ |
  | 399 |  | newElWidth = wrapWidth; |
  | 400 |  | // if carousel, use the thresholds to determine the width |
  | 401 |  | }else if(slider.settings.maxSlides > 1 && slider.settings.mode == 'horizontal'){ |
  | 402 |  | if(wrapWidth > slider.maxThreshold){ |
  | 403 |  | // newElWidth = (wrapWidth - (slider.settings.slideMargin \* (slider.settings.maxSlides - 1))) / slider.settings.maxSlides; |
  | 404 |  | }else if(wrapWidth < slider.minThreshold){ |
  | 405 |  | newElWidth = (wrapWidth - (slider.settings.slideMargin \* (slider.settings.minSlides - 1))) / slider.settings.minSlides; |
  | 406 |  | } |
  | 407 |  | } |
  | 408 |  | return newElWidth; |
  | 409 |  | } |
  | 410 |  |  |
  | 411 |  | /\*\* |
  | 412 |  | \* Returns the number of slides currently visible in the viewport (includes partially visible slides) |
  | 413 |  | \*/ |
  | 414 |  | var getNumberSlidesShowing = function(){ |
  | 415 |  | var slidesShowing = 1; |
  | 416 |  | if(slider.settings.mode == 'horizontal' && slider.settings.slideWidth > 0){ |
  | 417 |  | // if viewport is smaller than minThreshold, return minSlides |
  | 418 |  | if(slider.viewport.width() < slider.minThreshold){ |
  | 419 |  | slidesShowing = slider.settings.minSlides; |
  | 420 |  | // if viewport is larger than minThreshold, return maxSlides |
  | 421 |  | }else if(slider.viewport.width() > slider.maxThreshold){ |
  | 422 |  | slidesShowing = slider.settings.maxSlides; |
  | 423 |  | // if viewport is between min / max thresholds, divide viewport width by first child width |
  | 424 |  | }else{ |
  | 425 |  | var childWidth = slider.children.first().width(); |
  | 426 |  | slidesShowing = Math.floor(slider.viewport.width() / childWidth); |
  | 427 |  | } |
  | 428 |  | // if "vertical" mode, slides showing will always be minSlides |
  | 429 |  | }else if(slider.settings.mode == 'vertical'){ |
  | 430 |  | slidesShowing = slider.settings.minSlides; |
  | 431 |  | } |
  | 432 |  | return slidesShowing; |
  | 433 |  | } |
  | 434 |  |  |
  | 435 |  | /\*\* |
  | 436 |  | \* Returns the number of pages (one full viewport of slides is one "page") |
  | 437 |  | \*/ |
  | 438 |  | var getPagerQty = function(){ |
  | 439 |  | var pagerQty = 0; |
  | 440 |  | // if moveSlides is specified by the user |
  | 441 |  | if(slider.settings.moveSlides > 0){ |
  | 442 |  | if(slider.settings.infiniteLoop){ |
  | 443 |  | pagerQty = slider.children.length / getMoveBy(); |
  | 444 |  | }else{ |
  | 445 |  | // use a while loop to determine pages |
  | 446 |  | var breakPoint = 0; |
  | 447 |  | var counter = 0 |
  | 448 |  | // when breakpoint goes above children length, counter is the number of pages |
  | 449 |  | while (breakPoint < slider.children.length){ |
  | 450 |  | ++pagerQty; |
  | 451 |  | breakPoint = counter + getNumberSlidesShowing(); |
  | 452 |  | counter += slider.settings.moveSlides <= getNumberSlidesShowing() ? slider.settings.moveSlides : getNumberSlidesShowing(); |
  | 453 |  | } |
  | 454 |  | } |
  | 455 |  | // if moveSlides is 0 (auto) divide children length by sides showing, then round up |
  | 456 |  | }else{ |
  | 457 |  | pagerQty = Math.ceil(slider.children.length / getNumberSlidesShowing()); |
  | 458 |  | } |
  | 459 |  | return pagerQty; |
  | 460 |  | } |
  | 461 |  |  |
  | 462 |  | /\*\* |
  | 463 |  | \* Returns the number of indivual slides by which to shift the slider |
  | 464 |  | \*/ |
  | 465 |  | var getMoveBy = function(){ |
  | 466 |  | // if moveSlides was set by the user and moveSlides is less than number of slides showing |
  | 467 |  | if(slider.settings.moveSlides > 0 && slider.settings.moveSlides <= getNumberSlidesShowing()){ |
  | 468 |  | return slider.settings.moveSlides; |
  | 469 |  | } |
  | 470 |  | // if moveSlides is 0 (auto) |
  | 471 |  | return getNumberSlidesShowing(); |
  | 472 |  | } |
  | 473 |  |  |
  | 474 |  | /\*\* |
  | 475 |  | \* Sets the slider's (el) left or top position |
  | 476 |  | \*/ |
  | 477 |  | var setSlidePosition = function(){ |
  | 478 |  | // if last slide, not infinite loop, and number of children is larger than specified maxSlides |
  | 479 |  | if(slider.children.length > slider.settings.maxSlides && slider.active.last && !slider.settings.infiniteLoop){ |
  | 480 |  | if (slider.settings.mode == 'horizontal'){ |
  | 481 |  | // get the last child's position |
  | 482 |  | var lastChild = slider.children.last(); |
  | 483 |  | var position = lastChild.position(); |
  | 484 |  | // set the left position |
  | 485 |  | setPositionProperty(-(position.left - (slider.viewport.width() - lastChild.width())), 'reset', 0); |
  | 486 |  | }else if(slider.settings.mode == 'vertical'){ |
  | 487 |  | // get the last showing index's position |
  | 488 |  | var lastShowingIndex = slider.children.length - slider.settings.minSlides; |
  | 489 |  | var position = slider.children.eq(lastShowingIndex).position(); |
  | 490 |  | // set the top position |
  | 491 |  | setPositionProperty(-position.top, 'reset', 0); |
  | 492 |  | } |
  | 493 |  | // if not last slide |
  | 494 |  | }else{ |
  | 495 |  | // get the position of the first showing slide |
  | 496 |  | var position = slider.children.eq(slider.active.index \* getMoveBy()).position(); |
  | 497 |  | // check for last slide |
  | 498 |  | if (slider.active.index == getPagerQty() - 1) slider.active.last = true; |
  | 499 |  | // set the repective position |
  | 500 |  | if (position != undefined){ |
  | 501 |  | if (slider.settings.mode == 'horizontal') setPositionProperty(-position.left, 'reset', 0); |
  | 502 |  | else if (slider.settings.mode == 'vertical') setPositionProperty(-position.top, 'reset', 0); |
  | 503 |  | } |
  | 504 |  | } |
  | 505 |  | } |
  | 506 |  |  |
  | 507 |  | /\*\* |
  | 508 |  | \* Sets the el's animating property position (which in turn will sometimes animate el). |
  | 509 |  | \* If using CSS, sets the transform property. If not using CSS, sets the top / left property. |
  | 510 |  | \* |
  | 511 |  | \* @param value (int) |
  | 512 |  | \*  - the animating property's value |
  | 513 |  | \* |
  | 514 |  | \* @param type (string) 'slider', 'reset', 'ticker' |
  | 515 |  | \*  - the type of instance for which the function is being |
  | 516 |  | \* |
  | 517 |  | \* @param duration (int) |
  | 518 |  | \*  - the amount of time (in ms) the transition should occupy |
  | 519 |  | \* |
  | 520 |  | \* @param params (array) optional |
  | 521 |  | \*  - an optional parameter containing any variables that need to be passed in |
  | 522 |  | \*/ |
  | 523 |  | var setPositionProperty = function(value, type, duration, params){ |
  | 524 |  | // use CSS transform |
  | 525 |  | if(slider.usingCSS){ |
  | 526 |  | // determine the translate3d value |
  | 527 |  | var propValue = slider.settings.mode == 'vertical' ? 'translate3d(0, ' + value + 'px, 0)' : 'translate3d(' + value + 'px, 0, 0)'; |
  | 528 |  | // add the CSS transition-duration |
  | 529 |  | el.css('-' + slider.cssPrefix + '-transition-duration', duration / 1000 + 's'); |
  | 530 |  | if(type == 'slide'){ |
  | 531 |  | // set the property value |
  | 532 |  | el.css(slider.animProp, propValue); |
  | 533 |  | // bind a callback method - executes when CSS transition completes |
  | 534 |  | el.bind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd', function(){ |
  | 535 |  | // unbind the callback |
  | 536 |  | el.unbind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd'); |
  | 537 |  | updateAfterSlideTransition(); |
  | 538 |  | }); |
  | 539 |  | }else if(type == 'reset'){ |
  | 540 |  | el.css(slider.animProp, propValue); |
  | 541 |  | }else if(type == 'ticker'){ |
  | 542 |  | // make the transition use 'linear' |
  | 543 |  | el.css('-' + slider.cssPrefix + '-transition-timing-function', 'linear'); |
  | 544 |  | el.css(slider.animProp, propValue); |
  | 545 |  | // bind a callback method - executes when CSS transition completes |
  | 546 |  | el.bind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd', function(){ |
  | 547 |  | // unbind the callback |
  | 548 |  | el.unbind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd'); |
  | 549 |  | // reset the position |
  | 550 |  | setPositionProperty(params['resetValue'], 'reset', 0); |
  | 551 |  | // start the loop again |
  | 552 |  | tickerLoop(); |
  | 553 |  | }); |
  | 554 |  | } |
  | 555 |  | // use JS animate |
  | 556 |  | }else{ |
  | 557 |  | var animateObj = {}; |
  | 558 |  | animateObj[slider.animProp] = value; |
  | 559 |  | if(type == 'slide'){ |
  | 560 |  | el.animate(animateObj, duration, slider.settings.easing, function(){ |
  | 561 |  | updateAfterSlideTransition(); |
  | 562 |  | }); |
  | 563 |  | }else if(type == 'reset'){ |
  | 564 |  | el.css(slider.animProp, value) |
  | 565 |  | }else if(type == 'ticker'){ |
  | 566 |  | el.animate(animateObj, speed, 'linear', function(){ |
  | 567 |  | setPositionProperty(params['resetValue'], 'reset', 0); |
  | 568 |  | // run the recursive loop after animation |
  | 569 |  | tickerLoop(); |
  | 570 |  | }); |
  | 571 |  | } |
  | 572 |  | } |
  | 573 |  | } |
  | 574 |  |  |
  | 575 |  | /\*\* |
  | 576 |  | \* Populates the pager with proper amount of pages |
  | 577 |  | \*/ |
  | 578 |  | var populatePager = function(){ |
  | 579 |  | var pagerHtml = ''; |
  | 580 |  | var pagerQty = getPagerQty(); |
  | 581 |  | // loop through each pager item |
  | 582 |  | for(var i=0; i < pagerQty; i++){ |
  | 583 |  | var linkContent = ''; |
  | 584 |  | // if a buildPager function is supplied, use it to get pager link value, else use index + 1 |
  | 585 |  | if(slider.settings.buildPager && $.isFunction(slider.settings.buildPager)){ |
  | 586 |  | linkContent = slider.settings.buildPager(i); |
  | 587 |  | slider.pagerEl.addClass('bx-custom-pager'); |
  | 588 |  | }else{ |
  | 589 |  | linkContent = i + 1; |
  | 590 |  | slider.pagerEl.addClass('bx-default-pager'); |
  | 591 |  | } |
  | 592 |  | // var linkContent = slider.settings.buildPager && $.isFunction(slider.settings.buildPager) ? slider.settings.buildPager(i) : i + 1; |
  | 593 |  | // add the markup to the string |
  | 594 |  | pagerHtml += '<div class="bx-pager-item"><a href="" data-slide-index="' + i + '" class="bx-pager-link">' + linkContent + '</a></div>'; |
  | 595 |  | }; |
  | 596 |  | // populate the pager element with pager links |
  | 597 |  | slider.pagerEl.html(pagerHtml); |
  | 598 |  | } |
  | 599 |  |  |
  | 600 |  | /\*\* |
  | 601 |  | \* Appends the pager to the controls element |
  | 602 |  | \*/ |
  | 603 |  | var appendPager = function(){ |
  | 604 |  | if(!slider.settings.pagerCustom){ |
  | 605 |  | // create the pager DOM element |
  | 606 |  | slider.pagerEl = $('<div class="bx-pager" />'); |
  | 607 |  | // if a pager selector was supplied, populate it with the pager |
  | 608 |  | if(slider.settings.pagerSelector){ |
  | 609 |  | $(slider.settings.pagerSelector).html(slider.pagerEl); |
  | 610 |  | // if no pager selector was supplied, add it after the wrapper |
  | 611 |  | }else{ |
  | 612 |  | slider.controls.el.addClass('bx-has-pager').append(slider.pagerEl); |
  | 613 |  | } |
  | 614 |  | // populate the pager |
  | 615 |  | populatePager(); |
  | 616 |  | }else{ |
  | 617 |  | slider.pagerEl = $(slider.settings.pagerCustom); |
  | 618 |  | } |
  | 619 |  | // assign the pager click binding |
  | 620 |  | slider.pagerEl.delegate('a', 'click', clickPagerBind); |
  | 621 |  | } |
  | 622 |  |  |
  | 623 |  | /\*\* |
  | 624 |  | \* Appends prev / next controls to the controls element |
  | 625 |  | \*/ |
  | 626 |  | var appendControls = function(){ |
  | 627 |  | slider.controls.next = $('<a class="bx-next" href="">' + slider.settings.nextText + '</a>'); |
  | 628 |  | slider.controls.prev = $('<a class="bx-prev" href="">' + slider.settings.prevText + '</a>'); |
  | 629 |  | // bind click actions to the controls |
  | 630 |  | slider.controls.next.bind('click', clickNextBind); |
  | 631 |  | slider.controls.prev.bind('click', clickPrevBind); |
  | 632 |  | // if nextSlector was supplied, populate it |
  | 633 |  | if(slider.settings.nextSelector){ |
  | 634 |  | $(slider.settings.nextSelector).append(slider.controls.next); |
  | 635 |  | } |
  | 636 |  | // if prevSlector was supplied, populate it |
  | 637 |  | if(slider.settings.prevSelector){ |
  | 638 |  | $(slider.settings.prevSelector).append(slider.controls.prev); |
  | 639 |  | } |
  | 640 |  | // if no custom selectors were supplied |
  | 641 |  | if(!slider.settings.nextSelector && !slider.settings.prevSelector){ |
  | 642 |  | // add the controls to the DOM |
  | 643 |  | slider.controls.directionEl = $('<div class="bx-controls-direction" />'); |
  | 644 |  | // add the control elements to the directionEl |
  | 645 |  | slider.controls.directionEl.append(slider.controls.prev).append(slider.controls.next); |
  | 646 |  | // slider.viewport.append(slider.controls.directionEl); |
  | 647 |  | slider.controls.el.addClass('bx-has-controls-direction').append(slider.controls.directionEl); |
  | 648 |  | } |
  | 649 |  | } |
  | 650 |  |  |
  | 651 |  | /\*\* |
  | 652 |  | \* Appends start / stop auto controls to the controls element |
  | 653 |  | \*/ |
  | 654 |  | var appendControlsAuto = function(){ |
  | 655 |  | slider.controls.start = $('<div class="bx-controls-auto-item"><a class="bx-start" href="">' + slider.settings.startText + '</a></div>'); |
  | 656 |  | slider.controls.stop = $('<div class="bx-controls-auto-item"><a class="bx-stop" href="">' + slider.settings.stopText + '</a></div>'); |
  | 657 |  | // add the controls to the DOM |
  | 658 |  | slider.controls.autoEl = $('<div class="bx-controls-auto" />'); |
  | 659 |  | // bind click actions to the controls |
  | 660 |  | slider.controls.autoEl.delegate('.bx-start', 'click', clickStartBind); |
  | 661 |  | slider.controls.autoEl.delegate('.bx-stop', 'click', clickStopBind); |
  | 662 |  | // if autoControlsCombine, insert only the "start" control |
  | 663 |  | if(slider.settings.autoControlsCombine){ |
  | 664 |  | slider.controls.autoEl.append(slider.controls.start); |
  | 665 |  | // if autoControlsCombine is false, insert both controls |
  | 666 |  | }else{ |
  | 667 |  | slider.controls.autoEl.append(slider.controls.start).append(slider.controls.stop); |
  | 668 |  | } |
  | 669 |  | // if auto controls selector was supplied, populate it with the controls |
  | 670 |  | if(slider.settings.autoControlsSelector){ |
  | 671 |  | $(slider.settings.autoControlsSelector).html(slider.controls.autoEl); |
  | 672 |  | // if auto controls selector was not supplied, add it after the wrapper |
  | 673 |  | }else{ |
  | 674 |  | slider.controls.el.addClass('bx-has-controls-auto').append(slider.controls.autoEl); |
  | 675 |  | } |
  | 676 |  | // update the auto controls |
  | 677 |  | updateAutoControls(slider.settings.autoStart ? 'stop' : 'start'); |
  | 678 |  | } |
  | 679 |  |  |
  | 680 |  | /\*\* |
  | 681 |  | \* Appends image captions to the DOM |
  | 682 |  | \*/ |
  | 683 |  | var appendCaptions = function(){ |
  | 684 |  | // cycle through each child |
  | 685 |  | slider.children.each(function(index){ |
  | 686 |  | // get the image title attribute |
  | 687 |  | var title = $(this).find('img:first').attr('alt'); |
  | 688 |  | // append the caption |
  | 689 |  | if (title != undefined && ('' + title).length) { |
  | 690 |  | $(this).append('<div class="bx-caption"><span>' + title + '</span></div>'); |
  | 691 |  | } |
  | 692 |  | }); |
  | 693 |  | } |
  | 694 |  |  |
  | 695 |  | /\*\* |
  | 696 |  | \* Click next binding |
  | 697 |  | \* |
  | 698 |  | \* @param e (event) |
  | 699 |  | \*  - DOM event object |
  | 700 |  | \*/ |
  | 701 |  | var clickNextBind = function(e){ |
  | 702 |  | // if auto show is running, stop it |
  | 703 |  | if (slider.settings.auto) el.stopAuto(); |
  | 704 |  | el.goToNextSlide(); |
  | 705 |  | e.preventDefault(); |
  | 706 |  | } |
  | 707 |  |  |
  | 708 |  | /\*\* |
  | 709 |  | \* Click prev binding |
  | 710 |  | \* |
  | 711 |  | \* @param e (event) |
  | 712 |  | \*  - DOM event object |
  | 713 |  | \*/ |
  | 714 |  | var clickPrevBind = function(e){ |
  | 715 |  | // if auto show is running, stop it |
  | 716 |  | if (slider.settings.auto) el.stopAuto(); |
  | 717 |  | el.goToPrevSlide(); |
  | 718 |  | e.preventDefault(); |
  | 719 |  | } |
  | 720 |  |  |
  | 721 |  | /\*\* |
  | 722 |  | \* Click start binding |
  | 723 |  | \* |
  | 724 |  | \* @param e (event) |
  | 725 |  | \*  - DOM event object |
  | 726 |  | \*/ |
  | 727 |  | var clickStartBind = function(e){ |
  | 728 |  | el.startAuto(); |
  | 729 |  | e.preventDefault(); |
  | 730 |  | } |
  | 731 |  |  |
  | 732 |  | /\*\* |
  | 733 |  | \* Click stop binding |
  | 734 |  | \* |
  | 735 |  | \* @param e (event) |
  | 736 |  | \*  - DOM event object |
  | 737 |  | \*/ |
  | 738 |  | var clickStopBind = function(e){ |
  | 739 |  | el.stopAuto(); |
  | 740 |  | e.preventDefault(); |
  | 741 |  | } |
  | 742 |  |  |
  | 743 |  | /\*\* |
  | 744 |  | \* Click pager binding |
  | 745 |  | \* |
  | 746 |  | \* @param e (event) |
  | 747 |  | \*  - DOM event object |
  | 748 |  | \*/ |
  | 749 |  | var clickPagerBind = function(e){ |
  | 750 |  | // if auto show is running, stop it |
  | 751 |  | if (slider.settings.auto) el.stopAuto(); |
  | 752 |  | var pagerLink = $(e.currentTarget); |
  | 753 |  | var pagerIndex = parseInt(pagerLink.attr('data-slide-index')); |
  | 754 |  | // if clicked pager link is not active, continue with the goToSlide call |
  | 755 |  | if(pagerIndex != slider.active.index) el.goToSlide(pagerIndex); |
  | 756 |  | e.preventDefault(); |
  | 757 |  | } |
  | 758 |  |  |
  | 759 |  | /\*\* |
  | 760 |  | \* Updates the pager links with an active class |
  | 761 |  | \* |
  | 762 |  | \* @param slideIndex (int) |
  | 763 |  | \*  - index of slide to make active |
  | 764 |  | \*/ |
  | 765 |  | var updatePagerActive = function(slideIndex){ |
  | 766 |  | // if "short" pager type |
  | 767 |  | var len = slider.children.length; // nb of children |
  | 768 |  | if(slider.settings.pagerType == 'short'){ |
  | 769 |  | if(slider.settings.maxSlides > 1) { |
  | 770 |  | len = Math.ceil(slider.children.length/slider.settings.maxSlides); |
  | 771 |  | } |
  | 772 |  | slider.pagerEl.html( (slideIndex + 1) + slider.settings.pagerShortSeparator + len); |
  | 773 |  | return; |
  | 774 |  | } |
  | 775 |  | // remove all pager active classes |
  | 776 |  | slider.pagerEl.find('a').removeClass('active'); |
  | 777 |  | // apply the active class for all pagers |
  | 778 |  | slider.pagerEl.each(function(i, el) { |
  | 779 |  |  |
  | 780 |  | if($(el).find('a').length >0){ |
  | 781 |  |  |
  | 782 |  | $(el).find('a').eq(slideIndex).addClass('active'); |
  | 783 |  | } |
  | 784 |  |  |
  |  | 8 | ;(function($) { |
  |  | 9 |  |
  |  | 10 | var defaults = { |
  |  | 11 |  |
  |  | 12 | // GENERAL |
  |  | 13 | mode: 'horizontal', |
  |  | 14 | slideSelector: '', |
  |  | 15 | infiniteLoop: true, |
  |  | 16 | hideControlOnEnd: false, |
  |  | 17 | speed: 500, |
  |  | 18 | easing: null, |
  |  | 19 | slideMargin: 0, |
  |  | 20 | startSlide: 0, |
  |  | 21 | randomStart: false, |
  |  | 22 | captions: false, |
  |  | 23 | ticker: false, |
  |  | 24 | tickerHover: false, |
  |  | 25 | adaptiveHeight: false, |
  |  | 26 | adaptiveHeightSpeed: 500, |
  |  | 27 | video: false, |
  |  | 28 | useCSS: true, |
  |  | 29 | preloadImages: 'visible', |
  |  | 30 | responsive: true, |
  |  | 31 | slideZIndex: 50, |
  |  | 32 | wrapperClass: 'bx-wrapper\_', |
  |  | 33 |  |
  |  | 34 | // TOUCH |
  |  | 35 | touchEnabled: true, |
  |  | 36 | swipeThreshold: 50, |
  |  | 37 | oneToOneTouch: true, |
  |  | 38 | preventDefaultSwipeX: true, |
  |  | 39 | preventDefaultSwipeY: false, |
  |  | 40 |  |
  |  | 41 | // ACCESSIBILITY |
  |  | 42 | ariaLive: true, |
  |  | 43 | ariaHidden: true, |
  |  | 44 |  |
  |  | 45 | // KEYBOARD |
  |  | 46 | keyboardEnabled: false, |
  |  | 47 |  |
  |  | 48 | // PAGER |
  |  | 49 | pager: true, |
  |  | 50 | pagerType: 'full', |
  |  | 51 | pagerShortSeparator: ' / ', |
  |  | 52 | pagerSelector: null, |
  |  | 53 | buildPager: null, |
  |  | 54 | pagerCustom: null, |
  |  | 55 |  |
  |  | 56 | // CONTROLS |
  |  | 57 | controls: true, |
  |  | 58 | nextText: 'Next', |
  |  | 59 | prevText: 'Prev', |
  |  | 60 | nextSelector: null, |
  |  | 61 | prevSelector: null, |
  |  | 62 | autoControls: false, |
  |  | 63 | startText: 'Start', |
  |  | 64 | stopText: 'Stop', |
  |  | 65 | autoControlsCombine: false, |
  |  | 66 | autoControlsSelector: null, |
  |  | 67 |  |
  |  | 68 | // AUTO |
  |  | 69 | auto: false, |
  |  | 70 | pause: 4000, |
  |  | 71 | autoStart: true, |
  |  | 72 | autoDirection: 'next', |
  |  | 73 | stopAutoOnClick: false, |
  |  | 74 | autoHover: false, |
  |  | 75 | autoDelay: 0, |
  |  | 76 | autoSlideForOnePage: false, |
  |  | 77 |  |
  |  | 78 | // CAROUSEL |
  |  | 79 | minSlides: 1, |
  |  | 80 | maxSlides: 1, |
  |  | 81 | moveSlides: 0, |
  |  | 82 | slideWidth: 0, |
  |  | 83 | shrinkItems: false, |
  |  | 84 |  |
  |  | 85 | // CALLBACKS |
  |  | 86 | onSliderLoad: function() { return true; }, |
  |  | 87 | onSlideBefore: function() { return true; }, |
  |  | 88 | onSlideAfter: function() { return true; }, |
  |  | 89 | onSlideNext: function() { return true; }, |
  |  | 90 | onSlidePrev: function() { return true; }, |
  |  | 91 | onSliderResize: function() { return true; } |
  |  | 92 | }; |
  |  | 93 |  |
  |  | 94 | $.fn.bxSlider\_ = function(options) { |
  |  | 95 |  |
  |  | 96 | if (this.length === 0) { |
  |  | 97 | return this; |
  |  | 98 | } |
  |  | 99 |  |
  |  | 100 | // support multiple elements |
  |  | 101 | if (this.length > 1) { |
  |  | 102 | this.each(function() { |
  |  | 103 | $(this).bxSlider\_(options); |
  |  | 104 | }); |
  |  | 105 | return this; |
  |  | 106 | } |
  |  | 107 |  |
  |  | 108 | // create a namespace to be used throughout the plugin |
  |  | 109 | var slider = {}, |
  |  | 110 | // set a reference to our slider element |
  |  | 111 | el = this, |
  |  | 112 | // get the original window dimens (thanks a lot IE) |
  |  | 113 | windowWidth = $(window).width(), |
  |  | 114 | windowHeight = $(window).height(); |
  |  | 115 |  |
  |  | 116 | // Return if slider is already initialized |
  |  | 117 | if ($(el).data('bxSlider')) { return; } |
  |  | 118 |  |
  |  | 119 | /\*\* |
  |  | 120 | \* =================================================================================== |
  |  | 121 | \* = PRIVATE FUNCTIONS |
  |  | 122 | \* =================================================================================== |
  |  | 123 | \*/ |
  |  | 124 |  |
  |  | 125 | /\*\* |
  |  | 126 | \* Initializes namespace settings to be used throughout plugin |
  |  | 127 | \*/ |
  |  | 128 | var init = function() { |
  |  | 129 | // Return if slider is already initialized |
  |  | 130 | if ($(el).data('bxSlider')) { return; } |
  |  | 131 | // merge user-supplied options with the defaults |
  |  | 132 | slider.settings = $.extend({}, defaults, options); |
  |  | 133 | // parse slideWidth setting |
  |  | 134 | slider.settings.slideWidth = parseInt(slider.settings.slideWidth); |
  |  | 135 | // store the original children |
  |  | 136 | slider.children = el.children(slider.settings.slideSelector); |
  |  | 137 | // check if actual number of slides is less than minSlides / maxSlides |
  |  | 138 | if (slider.children.length < slider.settings.minSlides) { slider.settings.minSlides = slider.children.length; } |
  |  | 139 | if (slider.children.length < slider.settings.maxSlides) { slider.settings.maxSlides = slider.children.length; } |
  |  | 140 | // if random start, set the startSlide setting to random number |
  |  | 141 | if (slider.settings.randomStart) { slider.settings.startSlide = Math.floor(Math.random() \* slider.children.length); } |
  |  | 142 | // store active slide information |
  |  | 143 | slider.active = { index: slider.settings.startSlide }; |
  |  | 144 | // store if the slider is in carousel mode (displaying / moving multiple slides) |
  |  | 145 | slider.carousel = slider.settings.minSlides > 1 || slider.settings.maxSlides > 1 ? true : false; |
  |  | 146 | // if carousel, force preloadImages = 'all' |
  |  | 147 | if (slider.carousel) { slider.settings.preloadImages = 'all'; } |
  |  | 148 | // calculate the min / max width thresholds based on min / max number of slides |
  |  | 149 | // used to setup and update carousel slides dimensions |
  |  | 150 | slider.minThreshold = (slider.settings.minSlides \* slider.settings.slideWidth) + ((slider.settings.minSlides - 1) \* slider.settings.slideMargin); |
  |  | 151 | slider.maxThreshold = (slider.settings.maxSlides \* slider.settings.slideWidth) + ((slider.settings.maxSlides - 1) \* slider.settings.slideMargin); |
  |  | 152 | // store the current state of the slider (if currently animating, working is true) |
  |  | 153 | slider.working = false; |
  |  | 154 | // initialize the controls object |
  |  | 155 | slider.controls = {}; |
  |  | 156 | // initialize an auto interval |
  |  | 157 | slider.interval = null; |
  |  | 158 | // determine which property to use for transitions |
  |  | 159 | slider.animProp = slider.settings.mode === 'vertical' ? 'top' : 'left'; |
  |  | 160 | // determine if hardware acceleration can be used |
  |  | 161 | slider.usingCSS = slider.settings.useCSS && slider.settings.mode !== 'fade' && (function() { |
  |  | 162 | // create our test div element |
  |  | 163 | var div = document.createElement('div'), |
  |  | 164 | // css transition properties |
  |  | 165 | props = ['WebkitPerspective', 'MozPerspective', 'OPerspective', 'msPerspective']; |
  |  | 166 | // test for each property |
  |  | 167 | for (var i = 0; i < props.length; i++) { |
  |  | 168 | if (div.style[props[i]] !== undefined) { |
  |  | 169 | slider.cssPrefix = props[i].replace('Perspective', '').toLowerCase(); |
  |  | 170 | slider.animProp = '-' + slider.cssPrefix + '-transform'; |
  |  | 171 | return true; |
  |  | 172 | } |
  |  | 173 | } |
  |  | 174 | return false; |
  |  | 175 | }()); |
  |  | 176 | // if vertical mode always make maxSlides and minSlides equal |
  |  | 177 | if (slider.settings.mode === 'vertical') { slider.settings.maxSlides = slider.settings.minSlides; } |
  |  | 178 | // save original style data |
  |  | 179 | el.data('origStyle', el.attr('style')); |
  |  | 180 | el.children(slider.settings.slideSelector).each(function() { |
  |  | 181 | $(this).data('origStyle', $(this).attr('style')); |
  |  | 182 | }); |
  |  | 183 |  |
  |  | 184 | // perform all DOM / CSS modifications |
  |  | 185 | setup(); |
  |  | 186 | }; |
  |  | 187 |  |
  |  | 188 | /\*\* |
  |  | 189 | \* Performs all DOM and CSS modifications |
  |  | 190 | \*/ |
  |  | 191 | var setup = function() { |
  |  | 192 | var preloadSelector = slider.children.eq(slider.settings.startSlide); // set the default preload selector (visible) |
  |  | 193 |  |
  |  | 194 | // wrap el in a wrapper |
  |  | 195 | el.wrap('<div class="' + slider.settings.wrapperClass + '"><div class="bx-viewport\_"></div></div>'); |
  |  | 196 | // store a namespace reference to .bx-viewport |
  |  | 197 | slider.viewport = el.parent(); |
  |  | 198 |  |
  |  | 199 | // add aria-live if the setting is enabled and ticker mode is disabled |
  |  | 200 | if (slider.settings.ariaLive && !slider.settings.ticker) { |
  |  | 201 | slider.viewport.attr('aria-live', 'polite'); |
  |  | 202 | } |
  |  | 203 | // add a loading div to display while images are loading |
  |  | 204 | slider.loader = $('<div class="bx-loading" />'); |
  |  | 205 | slider.viewport.prepend(slider.loader); |
  |  | 206 | // set el to a massive width, to hold any needed slides |
  |  | 207 | // also strip any margin and padding from el |
  |  | 208 | el.css({ |
  |  | 209 | width: slider.settings.mode === 'horizontal' ? (slider.children.length \* 1000 + 215) + '%' : 'auto', |
  |  | 210 | position: 'relative' |
  |  | 211 | }); |
  |  | 212 | // if using CSS, add the easing property |
  |  | 213 | if (slider.usingCSS && slider.settings.easing) { |
  |  | 214 | el.css('-' + slider.cssPrefix + '-transition-timing-function', slider.settings.easing); |
  |  | 215 | // if not using CSS and no easing value was supplied, use the default JS animation easing (swing) |
  |  | 216 | } else if (!slider.settings.easing) { |
  |  | 217 | slider.settings.easing = 'swing'; |
  |  | 218 | } |
  |  | 219 | // make modifications to the viewport (.bx-viewport) |
  |  | 220 | slider.viewport.css({ |
  |  | 221 | width: '100%', |
  |  | 222 | overflow: 'hidden', |
  |  | 223 | position: 'relative' |
  |  | 224 | }); |
  |  | 225 | slider.viewport.parent().css({ |
  |  | 226 | maxWidth: getViewportMaxWidth() |
  |  | 227 | }); |
  |  | 228 | // make modification to the wrapper (.bx-wrapper) |
  |  | 229 | if (!slider.settings.pager && !slider.settings.controls) { |
  |  | 230 | slider.viewport.parent().css({ |
  |  | 231 | margin: '0 auto 0px' |
  |  | 232 | }); |
  |  | 233 | } |
  |  | 234 | // apply css to all slider children |
  |  | 235 | slider.children.css({ |
  |  | 236 | float: slider.settings.mode === 'horizontal' ? 'left' : 'none', |
  |  | 237 | listStyle: 'none', |
  |  | 238 | position: 'relative' |
  |  | 239 | }); |
  |  | 240 | // apply the calculated width after the float is applied to prevent scrollbar interference |
  |  | 241 | slider.children.css('width', getSlideWidth()); |
  |  | 242 | // if slideMargin is supplied, add the css |
  |  | 243 | if (slider.settings.mode === 'horizontal' && slider.settings.slideMargin > 0) { slider.children.css('marginRight', slider.settings.slideMargin); } |
  |  | 244 | if (slider.settings.mode === 'vertical' && slider.settings.slideMargin > 0) { slider.children.css('marginBottom', slider.settings.slideMargin); } |
  |  | 245 | // if "fade" mode, add positioning and z-index CSS |
  |  | 246 | if (slider.settings.mode === 'fade') { |
  |  | 247 | slider.children.css({ |
  |  | 248 | position: 'absolute', |
  |  | 249 | zIndex: 0, |
  |  | 250 | display: 'none' |
  |  | 251 | }); |
  |  | 252 | // prepare the z-index on the showing element |
  |  | 253 | slider.children.eq(slider.settings.startSlide).css({zIndex: slider.settings.slideZIndex, display: 'block'}); |
  |  | 254 | } |
  |  | 255 | // create an element to contain all slider controls (pager, start / stop, etc) |
  |  | 256 | slider.controls.el = $('<div class="bx-controls" />'); |
  |  | 257 | // if captions are requested, add them |
  |  | 258 | if (slider.settings.captions) { appendCaptions(); } |
  |  | 259 | // check if startSlide is last slide |
  |  | 260 | slider.active.last = slider.settings.startSlide === getPagerQty() - 1; |
  |  | 261 | // if video is true, set up the fitVids plugin |
  |  | 262 | if (slider.settings.video) { el.fitVids(); } |
  |  | 263 | if (slider.settings.preloadImages === 'all' || slider.settings.ticker) { preloadSelector = slider.children; } |
  |  | 264 | // only check for control addition if not in "ticker" mode |
  |  | 265 | if (!slider.settings.ticker) { |
  |  | 266 | // if controls are requested, add them |
  |  | 267 | if (slider.settings.controls) { appendControls(); } |
  |  | 268 | // if auto is true, and auto controls are requested, add them |
  |  | 269 | if (slider.settings.auto && slider.settings.autoControls) { appendControlsAuto(); } |
  |  | 270 | // if pager is requested, add it |
  |  | 271 | if (slider.settings.pager) { appendPager(); } |
  |  | 272 | // if any control option is requested, add the controls wrapper |
  |  | 273 | if (slider.settings.controls || slider.settings.autoControls || slider.settings.pager) { slider.viewport.after(slider.controls.el); } |
  |  | 274 | // if ticker mode, do not allow a pager |
  |  | 275 | } else { |
  |  | 276 | slider.settings.pager = false; |
  |  | 277 | } |
  |  | 278 | loadElements(preloadSelector, start); |
  |  | 279 | }; |
  |  | 280 |  |
  |  | 281 | var loadElements = function(selector, callback) { |
  |  | 282 | var total = selector.find('img:not([src=""]), iframe').length, |
  |  | 283 | count = 0; |
  |  | 284 | if (total === 0) { |
  |  | 285 | callback(); |
  |  | 286 | return; |
  |  | 287 | } |
  |  | 288 | selector.find('img:not([src=""]), iframe').each(function() { |
  |  | 289 | $(this).one('load error', function() { |
  |  | 290 | if (++count === total) { callback(); } |
  |  | 291 | }).each(function() { |
  |  | 292 | if (this.complete) { $(this).load(); } |
  |  | 293 | }); |
  |  | 294 | }); |
  |  | 295 | }; |
  |  | 296 |  |
  |  | 297 | /\*\* |
  |  | 298 | \* Start the slider |
  |  | 299 | \*/ |
  |  | 300 | var start = function() { |
  |  | 301 | // if infinite loop, prepare additional slides |
  |  | 302 | if (slider.settings.infiniteLoop && slider.settings.mode !== 'fade' && !slider.settings.ticker) { |
  |  | 303 | var slice    = slider.settings.mode === 'vertical' ? slider.settings.minSlides : slider.settings.maxSlides, |
  |  | 304 | sliceAppend  = slider.children.slice(0, slice).clone(true).addClass('bx-clone'), |
  |  | 305 | slicePrepend = slider.children.slice(-slice).clone(true).addClass('bx-clone'); |
  |  | 306 | if (slider.settings.ariaHidden) { |
  |  | 307 | sliceAppend.attr('aria-hidden', true); |
  |  | 308 | slicePrepend.attr('aria-hidden', true); |
  |  | 309 | } |
  |  | 310 | el.append(sliceAppend).prepend(slicePrepend); |
  |  | 311 | } |
  |  | 312 | // remove the loading DOM element |
  |  | 313 | slider.loader.remove(); |
  |  | 314 | // set the left / top position of "el" |
  |  | 315 | setSlidePosition(); |
  |  | 316 | // if "vertical" mode, always use adaptiveHeight to prevent odd behavior |
  |  | 317 | if (slider.settings.mode === 'vertical') { slider.settings.adaptiveHeight = true; } |
  |  | 318 | // set the viewport height |
  |  | 319 | slider.viewport.height(getViewportHeight()); |
  |  | 320 | // make sure everything is positioned just right (same as a window resize) |
  |  | 321 | el.redrawSlider(); |
  |  | 322 | // onSliderLoad callback |
  |  | 323 | slider.settings.onSliderLoad.call(el, slider.active.index); |
  |  | 324 | // slider has been fully initialized |
  |  | 325 | slider.initialized = true; |
  |  | 326 | // bind the resize call to the window |
  |  | 327 | if (slider.settings.responsive) { $(window).bind('resize', resizeWindow); } |
  |  | 328 | // if auto is true and has more than 1 page, start the show |
  |  | 329 | if (slider.settings.auto && slider.settings.autoStart && (getPagerQty() > 1 || slider.settings.autoSlideForOnePage)) { initAuto(); } |
  |  | 330 | // if ticker is true, start the ticker |
  |  | 331 | if (slider.settings.ticker) { initTicker(); } |
  |  | 332 | // if pager is requested, make the appropriate pager link active |
  |  | 333 | if (slider.settings.pager) { updatePagerActive(slider.settings.startSlide); } |
  |  | 334 | // check for any updates to the controls (like hideControlOnEnd updates) |
  |  | 335 | if (slider.settings.controls) { updateDirectionControls(); } |
  |  | 336 | // if touchEnabled is true, setup the touch events |
  |  | 337 | if (slider.settings.touchEnabled && !slider.settings.ticker) { initTouch(); } |
  |  | 338 | // if keyboardEnabled is true, setup the keyboard events |
  |  | 339 | if (slider.settings.keyboardEnabled && !slider.settings.ticker) { |
  |  | 340 | $(document).keydown(keyPress); |
  |  | 341 | } |
  |  | 342 | }; |
  |  | 343 |  |
  |  | 344 | /\*\* |
  |  | 345 | \* Returns the calculated height of the viewport, used to determine either adaptiveHeight or the maxHeight value |
  |  | 346 | \*/ |
  |  | 347 | var getViewportHeight = function() { |
  |  | 348 | var height = el.outerHeight(), |
  |  | 349 | currentIndex = null, |
  |  | 350 | // first determine which children (slides) should be used in our height calculation |
  |  | 351 | children = $(); |
  |  | 352 | // if mode is not "vertical" and adaptiveHeight is false, include all children |
  |  | 353 | if (slider.settings.mode !== 'vertical' && !slider.settings.adaptiveHeight) { |
  |  | 354 | children = slider.children; |
  |  | 355 | } else { |
  |  | 356 | // if not carousel, return the single active child |
  |  | 357 | if (!slider.carousel) { |
  |  | 358 | children = slider.children.eq(slider.active.index); |
  |  | 359 | // if carousel, return a slice of children |
  |  | 360 | } else { |
  |  | 361 | // get the individual slide index |
  |  | 362 | currentIndex = slider.settings.moveSlides === 1 ? slider.active.index : slider.active.index \* getMoveBy(); |
  |  | 363 | // add the current slide to the children |
  |  | 364 | children = slider.children.eq(currentIndex); |
  |  | 365 | // cycle through the remaining "showing" slides |
  |  | 366 | for (var i = 1; i <= slider.settings.maxSlides - 1; i++) { |
  |  | 367 | // if looped back to the start |
  |  | 368 | if (currentIndex + i >= slider.children.length) { |
  |  | 369 | children = children.add(slider.children.eq(currentIndex + i - slider.children.length)); |
  |  | 370 | } else { |
  |  | 371 | children = children.add(slider.children.eq(currentIndex + i)); |
  |  | 372 | } |
  |  | 373 | } |
  |  | 374 | } |
  |  | 375 | } |
  |  | 376 | // if "vertical" mode, calculate the sum of the heights of the children |
  |  | 377 | if (slider.settings.mode === 'vertical') { |
  |  | 378 | children.each(function(index) { |
  |  | 379 | height += $(this).outerHeight(); |
  |  | 380 | }); |
  |  | 381 | // add user-supplied margins |
  |  | 382 | if (slider.settings.slideMargin > 0) { |
  |  | 383 | height += slider.settings.slideMargin \* (slider.settings.minSlides - 1); |
  |  | 384 | } |
  |  | 385 | // if not "vertical" mode, calculate the max height of the children |
  |  | 386 | } else { |
  |  | 387 | height = Math.max.apply(Math, children.map(function() { |
  |  | 388 | return $(this).outerHeight(false); |
  |  | 389 | }).get()); |
  |  | 390 | } |
  |  | 391 |  |
  |  | 392 | if (slider.viewport.css('box-sizing') === 'border-box') { |
  |  | 393 | height += parseFloat(slider.viewport.css('padding-top')) + parseFloat(slider.viewport.css('padding-bottom')) + |
  |  | 394 | parseFloat(slider.viewport.css('border-top-width')) + parseFloat(slider.viewport.css('border-bottom-width')); |
  |  | 395 | } else if (slider.viewport.css('box-sizing') === 'padding-box') { |
  |  | 396 | height += parseFloat(slider.viewport.css('padding-top')) + parseFloat(slider.viewport.css('padding-bottom')); |
  |  | 397 | } |
  |  | 398 |  |
  |  | 399 | return height; |
  |  | 400 | }; |
  |  | 401 |  |
  |  | 402 | /\*\* |
  |  | 403 | \* Returns the calculated width to be used for the outer wrapper / viewport |
  |  | 404 | \*/ |
  |  | 405 | var getViewportMaxWidth = function() { |
  |  | 406 | var width = '100%'; |
  |  | 407 | if (slider.settings.slideWidth > 0) { |
  |  | 408 | if (slider.settings.mode === 'horizontal') { |
  |  | 409 | width = (slider.settings.maxSlides \* slider.settings.slideWidth) + ((slider.settings.maxSlides - 1) \* slider.settings.slideMargin); |
  |  | 410 | } else { |
  |  | 411 | width = slider.settings.slideWidth; |
  |  | 412 | } |
  |  | 413 | } |
  |  | 414 | return width; |
  |  | 415 | }; |
  |  | 416 |  |
  |  | 417 | /\*\* |
  |  | 418 | \* Returns the calculated width to be applied to each slide |
  |  | 419 | \*/ |
  |  | 420 | var getSlideWidth = function() { |
  |  | 421 | var newElWidth = slider.settings.slideWidth, // start with any user-supplied slide width |
  |  | 422 | wrapWidth      = slider.viewport.width();    // get the current viewport width |
  |  | 423 | // if slide width was not supplied, or is larger than the viewport use the viewport width |
  |  | 424 | if (slider.settings.slideWidth === 0 || |
  |  | 425 | (slider.settings.slideWidth > wrapWidth && !slider.carousel) || |
  |  | 426 | slider.settings.mode === 'vertical') { |
  |  | 427 | newElWidth = wrapWidth; |
  |  | 428 | // if carousel, use the thresholds to determine the width |
  |  | 429 | } else if (slider.settings.maxSlides > 1 && slider.settings.mode === 'horizontal') { |
  |  | 430 | if (wrapWidth > slider.maxThreshold) { |
  |  | 431 | return newElWidth; |
  |  | 432 | } else if (wrapWidth < slider.minThreshold) { |
  |  | 433 | newElWidth = (wrapWidth - (slider.settings.slideMargin \* (slider.settings.minSlides - 1))) / slider.settings.minSlides; |
  |  | 434 | } else if (slider.settings.shrinkItems) { |
  |  | 435 | newElWidth = Math.floor((wrapWidth + slider.settings.slideMargin) / (Math.ceil((wrapWidth + slider.settings.slideMargin) / (newElWidth + slider.settings.slideMargin))) - slider.settings.slideMargin); |
  |  | 436 | } |
  |  | 437 | } |
  |  | 438 | return newElWidth; |
  |  | 439 | }; |
  |  | 440 |  |
  |  | 441 | /\*\* |
  |  | 442 | \* Returns the number of slides currently visible in the viewport (includes partially visible slides) |
  |  | 443 | \*/ |
  |  | 444 | var getNumberSlidesShowing = function() { |
  |  | 445 | var slidesShowing = 1, |
  |  | 446 | childWidth = null; |
  |  | 447 | if (slider.settings.mode === 'horizontal' && slider.settings.slideWidth > 0) { |
  |  | 448 | // if viewport is smaller than minThreshold, return minSlides |
  |  | 449 | if (slider.viewport.width() < slider.minThreshold) { |
  |  | 450 | slidesShowing = slider.settings.minSlides; |
  |  | 451 | // if viewport is larger than maxThreshold, return maxSlides |
  |  | 452 | } else if (slider.viewport.width() > slider.maxThreshold) { |
  |  | 453 | slidesShowing = slider.settings.maxSlides; |
  |  | 454 | // if viewport is between min / max thresholds, divide viewport width by first child width |
  |  | 455 | } else { |
  |  | 456 | childWidth = slider.children.first().width() + slider.settings.slideMargin; |
  |  | 457 | slidesShowing = Math.floor((slider.viewport.width() + |
  |  | 458 | slider.settings.slideMargin) / childWidth); |
  |  | 459 | } |
  |  | 460 | // if "vertical" mode, slides showing will always be minSlides |
  |  | 461 | } else if (slider.settings.mode === 'vertical') { |
  |  | 462 | slidesShowing = slider.settings.minSlides; |
  |  | 463 | } |
  |  | 464 | return slidesShowing; |
  |  | 465 | }; |
  |  | 466 |  |
  |  | 467 | /\*\* |
  |  | 468 | \* Returns the number of pages (one full viewport of slides is one "page") |
  |  | 469 | \*/ |
  |  | 470 | var getPagerQty = function() { |
  |  | 471 | var pagerQty = 0, |
  |  | 472 | breakPoint = 0, |
  |  | 473 | counter = 0; |
  |  | 474 | // if moveSlides is specified by the user |
  |  | 475 | if (slider.settings.moveSlides > 0) { |
  |  | 476 | if (slider.settings.infiniteLoop) { |
  |  | 477 | pagerQty = Math.ceil(slider.children.length / getMoveBy()); |
  |  | 478 | } else { |
  |  | 479 | // when breakpoint goes above children length, counter is the number of pages |
  |  | 480 | while (breakPoint < slider.children.length) { |
  |  | 481 | ++pagerQty; |
  |  | 482 | breakPoint = counter + getNumberSlidesShowing(); |
  |  | 483 | counter += slider.settings.moveSlides <= getNumberSlidesShowing() ? slider.settings.moveSlides : getNumberSlidesShowing(); |
  |  | 484 | } |
  |  | 485 | } |
  |  | 486 | // if moveSlides is 0 (auto) divide children length by sides showing, then round up |
  |  | 487 | } else { |
  |  | 488 | pagerQty = Math.ceil(slider.children.length / getNumberSlidesShowing()); |
  |  | 489 | } |
  |  | 490 | return pagerQty; |
  |  | 491 | }; |
  |  | 492 |  |
  |  | 493 | /\*\* |
  |  | 494 | \* Returns the number of individual slides by which to shift the slider |
  |  | 495 | \*/ |
  |  | 496 | var getMoveBy = function() { |
  |  | 497 | // if moveSlides was set by the user and moveSlides is less than number of slides showing |
  |  | 498 | if (slider.settings.moveSlides > 0 && slider.settings.moveSlides <= getNumberSlidesShowing()) { |
  |  | 499 | return slider.settings.moveSlides; |
  |  | 500 | } |
  |  | 501 | // if moveSlides is 0 (auto) |
  |  | 502 | return getNumberSlidesShowing(); |
  |  | 503 | }; |
  |  | 504 |  |
  |  | 505 | /\*\* |
  |  | 506 | \* Sets the slider's (el) left or top position |
  |  | 507 | \*/ |
  |  | 508 | var setSlidePosition = function() { |
  |  | 509 | var position, lastChild, lastShowingIndex; |
  |  | 510 | // if last slide, not infinite loop, and number of children is larger than specified maxSlides |
  |  | 511 | if (slider.children.length > slider.settings.maxSlides && slider.active.last && !slider.settings.infiniteLoop) { |
  |  | 512 | if (slider.settings.mode === 'horizontal') { |
  |  | 513 | // get the last child's position |
  |  | 514 | lastChild = slider.children.last(); |
  |  | 515 | position = lastChild.position(); |
  |  | 516 | // set the left position |
  |  | 517 | setPositionProperty(-(position.left - (slider.viewport.width() - lastChild.outerWidth())), 'reset', 0); |
  |  | 518 | } else if (slider.settings.mode === 'vertical') { |
  |  | 519 | // get the last showing index's position |
  |  | 520 | lastShowingIndex = slider.children.length - slider.settings.minSlides; |
  |  | 521 | position = slider.children.eq(lastShowingIndex).position(); |
  |  | 522 | // set the top position |
  |  | 523 | setPositionProperty(-position.top, 'reset', 0); |
  |  | 524 | } |
  |  | 525 | // if not last slide |
  |  | 526 | } else { |
  |  | 527 | // get the position of the first showing slide |
  |  | 528 | position = slider.children.eq(slider.active.index \* getMoveBy()).position(); |
  |  | 529 | // check for last slide |
  |  | 530 | if (slider.active.index === getPagerQty() - 1) { slider.active.last = true; } |
  |  | 531 | // set the respective position |
  |  | 532 | if (position !== undefined) { |
  |  | 533 | if (slider.settings.mode === 'horizontal') { setPositionProperty(-position.left, 'reset', 0); } |
  |  | 534 | else if (slider.settings.mode === 'vertical') { setPositionProperty(-position.top, 'reset', 0); } |
  |  | 535 | } |
  |  | 536 | } |
  |  | 537 | }; |
  |  | 538 |  |
  |  | 539 | /\*\* |
  |  | 540 | \* Sets the el's animating property position (which in turn will sometimes animate el). |
  |  | 541 | \* If using CSS, sets the transform property. If not using CSS, sets the top / left property. |
  |  | 542 | \* |
  |  | 543 | \* @param value (int) |
  |  | 544 | \*  - the animating property's value |
  |  | 545 | \* |
  |  | 546 | \* @param type (string) 'slide', 'reset', 'ticker' |
  |  | 547 | \*  - the type of instance for which the function is being |
  |  | 548 | \* |
  |  | 549 | \* @param duration (int) |
  |  | 550 | \*  - the amount of time (in ms) the transition should occupy |
  |  | 551 | \* |
  |  | 552 | \* @param params (array) optional |
  |  | 553 | \*  - an optional parameter containing any variables that need to be passed in |
  |  | 554 | \*/ |
  |  | 555 | var setPositionProperty = function(value, type, duration, params) { |
  |  | 556 | var animateObj, propValue; |
  |  | 557 | // use CSS transform |
  |  | 558 | if (slider.usingCSS) { |
  |  | 559 | // determine the translate3d value |
  |  | 560 | propValue = slider.settings.mode === 'vertical' ? 'translate3d(0, ' + value + 'px, 0)' : 'translate3d(' + value + 'px, 0, 0)'; |
  |  | 561 | // add the CSS transition-duration |
  |  | 562 | el.css('-' + slider.cssPrefix + '-transition-duration', duration / 1000 + 's'); |
  |  | 563 | if (type === 'slide') { |
  |  | 564 | // set the property value |
  |  | 565 | el.css(slider.animProp, propValue); |
  |  | 566 | // bind a callback method - executes when CSS transition completes |
  |  | 567 | el.bind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd', function(e) { |
  |  | 568 | //make sure it's the correct one |
  |  | 569 | if (!$(e.target).is(el)) { return; } |
  |  | 570 | // unbind the callback |
  |  | 571 | el.unbind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd'); |
  |  | 572 | updateAfterSlideTransition(); |
  |  | 573 | }); |
  |  | 574 | } else if (type === 'reset') { |
  |  | 575 | el.css(slider.animProp, propValue); |
  |  | 576 | } else if (type === 'ticker') { |
  |  | 577 | // make the transition use 'linear' |
  |  | 578 | el.css('-' + slider.cssPrefix + '-transition-timing-function', 'linear'); |
  |  | 579 | el.css(slider.animProp, propValue); |
  |  | 580 | // bind a callback method - executes when CSS transition completes |
  |  | 581 | el.bind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd', function(e) { |
  |  | 582 | //make sure it's the correct one |
  |  | 583 | if (!$(e.target).is(el)) { return; } |
  |  | 584 | // unbind the callback |
  |  | 585 | el.unbind('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd'); |
  |  | 586 | // reset the position |
  |  | 587 | setPositionProperty(params.resetValue, 'reset', 0); |
  |  | 588 | // start the loop again |
  |  | 589 | tickerLoop(); |
  |  | 590 | }); |
  |  | 591 | } |
  |  | 592 | // use JS animate |
  |  | 593 | } else { |
  |  | 594 | animateObj = {}; |
  |  | 595 | animateObj[slider.animProp] = value; |
  |  | 596 | if (type === 'slide') { |
  |  | 597 | el.animate(animateObj, duration, slider.settings.easing, function() { |
  |  | 598 | updateAfterSlideTransition(); |
  |  | 599 | }); |
  |  | 600 | } else if (type === 'reset') { |
  |  | 601 | el.css(slider.animProp, value); |
  |  | 602 | } else if (type === 'ticker') { |
  |  | 603 | el.animate(animateObj, duration, 'linear', function() { |
  |  | 604 | setPositionProperty(params.resetValue, 'reset', 0); |
  |  | 605 | // run the recursive loop after animation |
  |  | 606 | tickerLoop(); |
  |  | 607 | }); |
  |  | 608 | } |
  |  | 609 | } |
  |  | 610 | }; |
  |  | 611 |  |
  |  | 612 | /\*\* |
  |  | 613 | \* Populates the pager with proper amount of pages |
  |  | 614 | \*/ |
  |  | 615 | var populatePager = function() { |
  |  | 616 | var pagerHtml = '', |
  |  | 617 | linkContent = '', |
  |  | 618 | pagerQty = getPagerQty(); |
  |  | 619 | // loop through each pager item |
  |  | 620 | for (var i = 0; i < pagerQty; i++) { |
  |  | 621 | linkContent = ''; |
  |  | 622 | // if a buildPager function is supplied, use it to get pager link value, else use index + 1 |
  |  | 623 | if (slider.settings.buildPager && $.isFunction(slider.settings.buildPager) || slider.settings.pagerCustom) { |
  |  | 624 | linkContent = slider.settings.buildPager(i); |
  |  | 625 | slider.pagerEl.addClass('bx-custom-pager'); |
  |  | 626 | } else { |
  |  | 627 | linkContent = i + 1; |
  |  | 628 | slider.pagerEl.addClass('bx-default-pager'); |
  |  | 629 | } |
  |  | 630 | // var linkContent = slider.settings.buildPager && $.isFunction(slider.settings.buildPager) ? slider.settings.buildPager(i) : i + 1; |
  |  | 631 | // add the markup to the string |
  |  | 632 | pagerHtml += '<div class="bx-pager-item"><a href="" data-slide-index="' + i + '" class="bx-pager-link">' + linkContent + '</a></div>'; |
  |  | 633 | } |
  |  | 634 | // populate the pager element with pager links |
  |  | 635 | slider.pagerEl.html(pagerHtml); |
  |  | 636 | }; |
  |  | 637 |  |
  |  | 638 | /\*\* |
  |  | 639 | \* Appends the pager to the controls element |
  |  | 640 | \*/ |
  |  | 641 | var appendPager = function() { |
  |  | 642 | if (!slider.settings.pagerCustom) { |
  |  | 643 | // create the pager DOM element |
  |  | 644 | slider.pagerEl = $('<div class="bx-pager" />'); |
  |  | 645 | // if a pager selector was supplied, populate it with the pager |
  |  | 646 | if (slider.settings.pagerSelector) { |
  |  | 647 | $(slider.settings.pagerSelector).html(slider.pagerEl); |
  |  | 648 | // if no pager selector was supplied, add it after the wrapper |
  |  | 649 | } else { |
  |  | 650 | slider.controls.el.addClass('bx-has-pager').append(slider.pagerEl); |
  |  | 651 | } |
  |  | 652 | // populate the pager |
  |  | 653 | populatePager(); |
  |  | 654 | } else { |
  |  | 655 | slider.pagerEl = $(slider.settings.pagerCustom); |
  |  | 656 | } |
  |  | 657 | // assign the pager click binding |
  |  | 658 | slider.pagerEl.on('click touchend', 'a', clickPagerBind); |
  |  | 659 | }; |
  |  | 660 |  |
  |  | 661 | /\*\* |
  |  | 662 | \* Appends prev / next controls to the controls element |
  |  | 663 | \*/ |
  |  | 664 | var appendControls = function() { |
  |  | 665 | slider.controls.next = $('<a class="bx-next" href="">' + slider.settings.nextText + '</a>'); |
  |  | 666 | slider.controls.prev = $('<a class="bx-prev" href="">' + slider.settings.prevText + '</a>'); |
  |  | 667 | // bind click actions to the controls |
  |  | 668 | slider.controls.next.bind('click touchend', clickNextBind); |
  |  | 669 | slider.controls.prev.bind('click touchend', clickPrevBind); |
  |  | 670 | // if nextSelector was supplied, populate it |
  |  | 671 | if (slider.settings.nextSelector) { |
  |  | 672 | $(slider.settings.nextSelector).append(slider.controls.next); |
  |  | 673 | } |
  |  | 674 | // if prevSelector was supplied, populate it |
  |  | 675 | if (slider.settings.prevSelector) { |
  |  | 676 | $(slider.settings.prevSelector).append(slider.controls.prev); |
  |  | 677 | } |
  |  | 678 | // if no custom selectors were supplied |
  |  | 679 | if (!slider.settings.nextSelector && !slider.settings.prevSelector) { |
  |  | 680 | // add the controls to the DOM |
  |  | 681 | slider.controls.directionEl = $('<div class="bx-controls-direction" />'); |
  |  | 682 | // add the control elements to the directionEl |
  |  | 683 | slider.controls.directionEl.append(slider.controls.prev).append(slider.controls.next); |
  |  | 684 | // slider.viewport.append(slider.controls.directionEl); |
  |  | 685 | slider.controls.el.addClass('bx-has-controls-direction').append(slider.controls.directionEl); |
  |  | 686 | } |
  |  | 687 | }; |
  |  | 688 |  |
  |  | 689 | /\*\* |
  |  | 690 | \* Appends start / stop auto controls to the controls element |
  |  | 691 | \*/ |
  |  | 692 | var appendControlsAuto = function() { |
  |  | 693 | slider.controls.start = $('<div class="bx-controls-auto-item"><a class="bx-start" href="">' + slider.settings.startText + '</a></div>'); |
  |  | 694 | slider.controls.stop = $('<div class="bx-controls-auto-item"><a class="bx-stop" href="">' + slider.settings.stopText + '</a></div>'); |
  |  | 695 | // add the controls to the DOM |
  |  | 696 | slider.controls.autoEl = $('<div class="bx-controls-auto" />'); |
  |  | 697 | // bind click actions to the controls |
  |  | 698 | slider.controls.autoEl.on('click', '.bx-start', clickStartBind); |
  |  | 699 | slider.controls.autoEl.on('click', '.bx-stop', clickStopBind); |
  |  | 700 | // if autoControlsCombine, insert only the "start" control |
  |  | 701 | if (slider.settings.autoControlsCombine) { |
  |  | 702 | slider.controls.autoEl.append(slider.controls.start); |
  |  | 703 | // if autoControlsCombine is false, insert both controls |
  |  | 704 | } else { |
  |  | 705 | slider.controls.autoEl.append(slider.controls.start).append(slider.controls.stop); |
  |  | 706 | } |
  |  | 707 | // if auto controls selector was supplied, populate it with the controls |
  |  | 708 | if (slider.settings.autoControlsSelector) { |
  |  | 709 | $(slider.settings.autoControlsSelector).html(slider.controls.autoEl); |
  |  | 710 | // if auto controls selector was not supplied, add it after the wrapper |
  |  | 711 | } else { |
  |  | 712 | slider.controls.el.addClass('bx-has-controls-auto').append(slider.controls.autoEl); |
  |  | 713 | } |
  |  | 714 | // update the auto controls |
  |  | 715 | updateAutoControls(slider.settings.autoStart ? 'stop' : 'start'); |
  |  | 716 | }; |
  |  | 717 |  |
  |  | 718 | /\*\* |
  |  | 719 | \* Appends image captions to the DOM |
  |  | 720 | \*/ |
  |  | 721 | var appendCaptions = function() { |
  |  | 722 | // cycle through each child |
  |  | 723 | slider.children.each(function(index) { |
  |  | 724 | // get the image title attribute |
  |  | 725 | var title = $(this).find('img:first').attr('title'); |
  |  | 726 | // append the caption |
  |  | 727 | if (title !== undefined && ('' + title).length) { |
  |  | 728 | $(this).append('<div class="bx-caption"><span>' + title + '</span></div>'); |
  |  | 729 | } |
  |  | 730 | }); |
  |  | 731 | }; |
  |  | 732 |  |
  |  | 733 | /\*\* |
  |  | 734 | \* Click next binding |
  |  | 735 | \* |
  |  | 736 | \* @param e (event) |
  |  | 737 | \*  - DOM event object |
  |  | 738 | \*/ |
  |  | 739 | var clickNextBind = function(e) { |
  |  | 740 | e.preventDefault(); |
  |  | 741 | if (slider.controls.el.hasClass('disabled')) { return; } |
  |  | 742 | // if auto show is running, stop it |
  |  | 743 | if (slider.settings.auto && slider.settings.stopAutoOnClick) { el.stopAuto(); } |
  |  | 744 | el.goToNextSlide(); |
  |  | 745 | }; |
  |  | 746 |  |
  |  | 747 | /\*\* |
  |  | 748 | \* Click prev binding |
  |  | 749 | \* |
  |  | 750 | \* @param e (event) |
  |  | 751 | \*  - DOM event object |
  |  | 752 | \*/ |
  |  | 753 | var clickPrevBind = function(e) { |
  |  | 754 | e.preventDefault(); |
  |  | 755 | if (slider.controls.el.hasClass('disabled')) { return; } |
  |  | 756 | // if auto show is running, stop it |
  |  | 757 | if (slider.settings.auto && slider.settings.stopAutoOnClick) { el.stopAuto(); } |
  |  | 758 | el.goToPrevSlide(); |
  |  | 759 | }; |
  |  | 760 |  |
  |  | 761 | /\*\* |
  |  | 762 | \* Click start binding |
  |  | 763 | \* |
  |  | 764 | \* @param e (event) |
  |  | 765 | \*  - DOM event object |
  |  | 766 | \*/ |
  |  | 767 | var clickStartBind = function(e) { |
  |  | 768 | el.startAuto(); |
  |  | 769 | e.preventDefault(); |
  |  | 770 | }; |
  |  | 771 |  |
  |  | 772 | /\*\* |
  |  | 773 | \* Click stop binding |
  |  | 774 | \* |
  |  | 775 | \* @param e (event) |
  |  | 776 | \*  - DOM event object |
  |  | 777 | \*/ |
  |  | 778 | var clickStopBind = function(e) { |
  |  | 779 | el.stopAuto(); |
  |  | 780 | e.preventDefault(); |
  |  | 781 | }; |
  |  | 782 |  |
  |  | 783 | /\*\* |
  |  | 784 | \* Click pager binding |
  |  | 785 | \* |
  |  | 786 | \* @param e (event) |
  |  | 787 | \*  - DOM event object |
  |  | 788 | \*/ |
  |  | 789 | var clickPagerBind = function(e) { |
  |  | 790 | var pagerLink, pagerIndex; |
  |  | 791 | e.preventDefault(); |
  |  | 792 | if (slider.controls.el.hasClass('disabled')) { |
  |  | 793 | return; |
  |  | 794 | } |
  |  | 795 | // if auto show is running, stop it |
  |  | 796 | if (slider.settings.auto  && slider.settings.stopAutoOnClick) { el.stopAuto(); } |
  |  | 797 | pagerLink = $(e.currentTarget); |
  |  | 798 | if (pagerLink.attr('data-slide-index') !== undefined) { |
  |  | 799 | pagerIndex = parseInt(pagerLink.attr('data-slide-index')); |
  |  | 800 | // if clicked pager link is not active, continue with the goToSlide call |
  |  | 801 | if (pagerIndex !== slider.active.index) { el.goToSlide(pagerIndex); } |
  |  | 802 | } |
  |  | 803 | }; |
  |  | 804 |  |
  |  | 805 | /\*\* |
  |  | 806 | \* Updates the pager links with an active class |
  |  | 807 | \* |
  |  | 808 | \* @param slideIndex (int) |
  |  | 809 | \*  - index of slide to make active |
  |  | 810 | \*/ |
  |  | 811 | var updatePagerActive = function(slideIndex) { |
  |  | 812 | // if "short" pager type |
  |  | 813 | var len = slider.children.length; // nb of children |
  |  | 814 | if (slider.settings.pagerType === 'short') { |
  |  | 815 | if (slider.settings.maxSlides > 1) { |
  |  | 816 | len = Math.ceil(slider.children.length / slider.settings.maxSlides); |
  |  | 817 | } |
  |  | 818 | slider.pagerEl.html((slideIndex + 1) + slider.settings.pagerShortSeparator + len); |
  |  | 819 | return; |
  |  | 820 | } |
  |  | 821 | // remove all pager active classes |
  |  | 822 | slider.pagerEl.find('a').removeClass('active'); |
  |  | 823 | // apply the active class for all pagers |
  |  | 824 | slider.pagerEl.each(function(i, el) { $(el).find('a').eq(slideIndex).addClass('active'); }); |
  |  | 825 | }; |
  |  | 826 |  |
  |  | 827 | /\*\* |
  |  | 828 | \* Performs needed actions after a slide transition |
  |  | 829 | \*/ |
  |  | 830 | var updateAfterSlideTransition = function() { |
  |  | 831 | // if infinite loop is true |
  |  | 832 | if (slider.settings.infiniteLoop) { |
  |  | 833 | var position = ''; |
  |  | 834 | // first slide |
  |  | 835 | if (slider.active.index === 0) { |
  |  | 836 | // set the new position |
  |  | 837 | position = slider.children.eq(0).position(); |
  |  | 838 | // carousel, last slide |
  |  | 839 | } else if (slider.active.index === getPagerQty() - 1 && slider.carousel) { |
  |  | 840 | position = slider.children.eq((getPagerQty() - 1) \* getMoveBy()).position(); |
  |  | 841 | // last slide |
  |  | 842 | } else if (slider.active.index === slider.children.length - 1) { |
  |  | 843 | position = slider.children.eq(slider.children.length - 1).position(); |
  |  | 844 | } |
  |  | 845 | if (position) { |
  |  | 846 | if (slider.settings.mode === 'horizontal') { setPositionProperty(-position.left, 'reset', 0); } |
  |  | 847 | else if (slider.settings.mode === 'vertical') { setPositionProperty(-position.top, 'reset', 0); } |
  |  | 848 | } |
  |  | 849 | } |
  |  | 850 | // declare that the transition is complete |
  |  | 851 | slider.working = false; |
  |  | 852 | // onSlideAfter callback |
  |  | 853 | slider.settings.onSlideAfter.call(el, slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index); |
  |  | 854 | }; |
  |  | 855 |  |
  |  | 856 | /\*\* |
  |  | 857 | \* Updates the auto controls state (either active, or combined switch) |
  |  | 858 | \* |
  |  | 859 | \* @param state (string) "start", "stop" |
  |  | 860 | \*  - the new state of the auto show |
  |  | 861 | \*/ |
  |  | 862 | var updateAutoControls = function(state) { |
  |  | 863 | // if autoControlsCombine is true, replace the current control with the new state |
  |  | 864 | if (slider.settings.autoControlsCombine) { |
  |  | 865 | slider.controls.autoEl.html(slider.controls[state]); |
  |  | 866 | // if autoControlsCombine is false, apply the "active" class to the appropriate control |
  |  | 867 | } else { |
  |  | 868 | slider.controls.autoEl.find('a').removeClass('active'); |
  |  | 869 | slider.controls.autoEl.find('a:not(.bx-' + state + ')').addClass('active'); |
  |  | 870 | } |
  |  | 871 | }; |
  |  | 872 |  |
  |  | 873 | /\*\* |
  |  | 874 | \* Updates the direction controls (checks if either should be hidden) |
  |  | 875 | \*/ |
  |  | 876 | var updateDirectionControls = function() { |
  |  | 877 | if (getPagerQty() === 1) { |
  |  | 878 | slider.controls.prev.addClass('disabled'); |
  |  | 879 | slider.controls.next.addClass('disabled'); |
  |  | 880 | } else if (!slider.settings.infiniteLoop && slider.settings.hideControlOnEnd) { |
  |  | 881 | // if first slide |
  |  | 882 | if (slider.active.index === 0) { |
  |  | 883 | slider.controls.prev.addClass('disabled'); |
  |  | 884 | slider.controls.next.removeClass('disabled'); |
  |  | 885 | // if last slide |
  |  | 886 | } else if (slider.active.index === getPagerQty() - 1) { |
  |  | 887 | slider.controls.next.addClass('disabled'); |
  |  | 888 | slider.controls.prev.removeClass('disabled'); |
  |  | 889 | // if any slide in the middle |
  |  | 890 | } else { |
  |  | 891 | slider.controls.prev.removeClass('disabled'); |
  |  | 892 | slider.controls.next.removeClass('disabled'); |
  |  | 893 | } |
  |  | 894 | } |
  |  | 895 | }; |
  |  | 896 |  |
  |  | 897 | /\*\* |
  |  | 898 | \* Initializes the auto process |
  |  | 899 | \*/ |
  |  | 900 | var initAuto = function() { |
  |  | 901 | // if autoDelay was supplied, launch the auto show using a setTimeout() call |
  |  | 902 | if (slider.settings.autoDelay > 0) { |
  |  | 903 | var timeout = setTimeout(el.startAuto, slider.settings.autoDelay); |
  |  | 904 | // if autoDelay was not supplied, start the auto show normally |
  |  | 905 | } else { |
  |  | 906 | el.startAuto(); |
  |  | 907 |  |
  |  | 908 | //add focus and blur events to ensure its running if timeout gets paused |
  |  | 909 | $(window).focus(function() { |
  |  | 910 | el.startAuto(); |
  |  | 911 | }).blur(function() { |
  |  | 912 | el.stopAuto(); |
  |  | 913 | }); |
  |  | 914 | } |
  |  | 915 | // if autoHover is requested |
  |  | 916 | if (slider.settings.autoHover) { |
  |  | 917 | // on el hover |
  |  | 918 | el.hover(function() { |
  |  | 919 | // if the auto show is currently playing (has an active interval) |
  |  | 920 | if (slider.interval) { |
  |  | 921 | // stop the auto show and pass true argument which will prevent control update |
  |  | 922 | el.stopAuto(true); |
  |  | 923 | // create a new autoPaused value which will be used by the relative "mouseout" event |
  |  | 924 | slider.autoPaused = true; |
  |  | 925 | } |
  |  | 926 | }, function() { |
  |  | 927 | // if the autoPaused value was created be the prior "mouseover" event |
  |  | 928 | if (slider.autoPaused) { |
  |  | 929 | // start the auto show and pass true argument which will prevent control update |
  |  | 930 | el.startAuto(true); |
  |  | 931 | // reset the autoPaused value |
  |  | 932 | slider.autoPaused = null; |
  |  | 933 | } |
  |  | 934 | }); |
  |  | 935 | } |
  |  | 936 | }; |
  |  | 937 |  |
  |  | 938 | /\*\* |
  |  | 939 | \* Initializes the ticker process |
  |  | 940 | \*/ |
  |  | 941 | var initTicker = function() { |
  |  | 942 | var startPosition = 0, |
  |  | 943 | position, transform, value, idx, ratio, property, newSpeed, totalDimens; |
  |  | 944 | // if autoDirection is "next", append a clone of the entire slider |
  |  | 945 | if (slider.settings.autoDirection === 'next') { |
  |  | 946 | el.append(slider.children.clone().addClass('bx-clone')); |
  |  | 947 | // if autoDirection is "prev", prepend a clone of the entire slider, and set the left position |
  |  | 948 | } else { |
  |  | 949 | el.prepend(slider.children.clone().addClass('bx-clone')); |
  |  | 950 | position = slider.children.first().position(); |
  |  | 951 | startPosition = slider.settings.mode === 'horizontal' ? -position.left : -position.top; |
  |  | 952 | } |
  |  | 953 | setPositionProperty(startPosition, 'reset', 0); |
  |  | 954 | // do not allow controls in ticker mode |
  |  | 955 | slider.settings.pager = false; |
  |  | 956 | slider.settings.controls = false; |
  |  | 957 | slider.settings.autoControls = false; |
  |  | 958 | // if autoHover is requested |
  |  | 959 | if (slider.settings.tickerHover) { |
  |  | 960 | if (slider.usingCSS) { |
  |  | 961 | idx = slider.settings.mode === 'horizontal' ? 4 : 5; |
  |  | 962 | slider.viewport.hover(function() { |
  |  | 963 | transform = el.css('-' + slider.cssPrefix + '-transform'); |
  |  | 964 | value = parseFloat(transform.split(',')[idx]); |
  |  | 965 | setPositionProperty(value, 'reset', 0); |
  |  | 966 | }, function() { |
  |  | 967 | totalDimens = 0; |
  |  | 968 | slider.children.each(function(index) { |
  |  | 969 | totalDimens += slider.settings.mode === 'horizontal' ? $(this).outerWidth(true) : $(this).outerHeight(true); |
  | 785 | 970 | }); |
  | 786 |  | } |
  | 787 |  |  |
  | 788 |  | /\*\* |
  | 789 |  | \* Performs needed actions after a slide transition |
  | 790 |  | \*/ |
  | 791 |  | var updateAfterSlideTransition = function(){ |
  | 792 |  | // if infinte loop is true |
  | 793 |  | if(slider.settings.infiniteLoop){ |
  | 794 |  | var position = ''; |
  | 795 |  | // first slide |
  | 796 |  | if(slider.active.index == 0){ |
  | 797 |  | // set the new position |
  | 798 |  | position = slider.children.eq(0).position(); |
  | 799 |  | // carousel, last slide |
  | 800 |  | }else if(slider.active.index == getPagerQty() - 1 && slider.carousel){ |
  | 801 |  | position = slider.children.eq((getPagerQty() - 1) \* getMoveBy()).position(); |
  | 802 |  | // last slide |
  | 803 |  | }else if(slider.active.index == slider.children.length - 1){ |
  | 804 |  | position = slider.children.eq(slider.children.length - 1).position(); |
  | 805 |  | } |
  | 806 |  | if (slider.settings.mode == 'horizontal') { setPositionProperty(-position.left, 'reset', 0);; } |
  | 807 |  | else if (slider.settings.mode == 'vertical') { setPositionProperty(-position.top, 'reset', 0);; } |
  | 808 |  | } |
  | 809 |  | // declare that the transition is complete |
  | 810 |  | slider.working = false; |
  | 811 |  | // onSlideAfter callback |
  | 812 |  | slider.settings.onSlideAfter(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index); |
  | 813 |  | } |
  | 814 |  |  |
  | 815 |  | /\*\* |
  | 816 |  | \* Updates the auto controls state (either active, or combined switch) |
  | 817 |  | \* |
  | 818 |  | \* @param state (string) "start", "stop" |
  | 819 |  | \*  - the new state of the auto show |
  | 820 |  | \*/ |
  | 821 |  | var updateAutoControls = function(state){ |
  | 822 |  | // if autoControlsCombine is true, replace the current control with the new state |
  | 823 |  | if(slider.settings.autoControlsCombine){ |
  | 824 |  | slider.controls.autoEl.html(slider.controls[state]); |
  | 825 |  | // if autoControlsCombine is false, apply the "active" class to the appropriate control |
  | 826 |  | }else{ |
  | 827 |  | slider.controls.autoEl.find('a').removeClass('active'); |
  | 828 |  | slider.controls.autoEl.find('a:not(.bx-' + state + ')').addClass('active'); |
  | 829 |  | } |
  | 830 |  | } |
  | 831 |  |  |
  | 832 |  | /\*\* |
  | 833 |  | \* Updates the direction controls (checks if either should be hidden) |
  | 834 |  | \*/ |
  | 835 |  | var updateDirectionControls = function(){ |
  | 836 |  | if(getPagerQty() == 1){ |
  | 837 |  | slider.controls.prev.addClass('disabled'); |
  | 838 |  | slider.controls.next.addClass('disabled'); |
  | 839 |  | }else if(!slider.settings.infiniteLoop && slider.settings.hideControlOnEnd){ |
  | 840 |  | // if first slide |
  | 841 |  | if (slider.active.index == 0){ |
  | 842 |  | slider.controls.prev.addClass('disabled'); |
  | 843 |  | slider.controls.next.removeClass('disabled'); |
  | 844 |  | // if last slide |
  | 845 |  | }else if(slider.active.index == getPagerQty() - 1){ |
  | 846 |  | slider.controls.next.addClass('disabled'); |
  | 847 |  | slider.controls.prev.removeClass('disabled'); |
  | 848 |  | // if any slide in the middle |
  | 849 |  | }else{ |
  | 850 |  | slider.controls.prev.removeClass('disabled'); |
  | 851 |  | slider.controls.next.removeClass('disabled'); |
  | 852 |  | } |
  | 853 |  | } |
  | 854 |  | } |
  | 855 |  |  |
  | 856 |  | /\*\* |
  | 857 |  | \* Initialzes the auto process |
  | 858 |  | \*/ |
  | 859 |  | var initAuto = function(){ |
  | 860 |  | // if autoDelay was supplied, launch the auto show using a setTimeout() call |
  | 861 |  | if(slider.settings.autoDelay > 0){ |
  | 862 |  | var timeout = setTimeout(el.startAuto, slider.settings.autoDelay); |
  | 863 |  | // if autoDelay was not supplied, start the auto show normally |
  | 864 |  | }else{ |
  | 865 |  | el.startAuto(); |
  | 866 |  | } |
  | 867 |  | // if autoHover is requested |
  | 868 |  | if(slider.settings.autoHover){ |
  | 869 |  | // on el hover |
  | 870 |  | el.hover(function(){ |
  | 871 |  | // if the auto show is currently playing (has an active interval) |
  | 872 |  | if(slider.interval){ |
  | 873 |  | // stop the auto show and pass true agument which will prevent control update |
  | 874 |  | el.stopAuto(true); |
  | 875 |  | // create a new autoPaused value which will be used by the relative "mouseout" event |
  | 876 |  | slider.autoPaused = true; |
  | 877 |  | } |
  | 878 |  | }, function(){ |
  | 879 |  | // if the autoPaused value was created be the prior "mouseover" event |
  | 880 |  | if(slider.autoPaused){ |
  | 881 |  | // start the auto show and pass true agument which will prevent control update |
  | 882 |  | el.startAuto(true); |
  | 883 |  | // reset the autoPaused value |
  | 884 |  | slider.autoPaused = null; |
  | 885 |  | } |
  | 886 |  | }); |
  | 887 |  | } |
  | 888 |  | } |
  | 889 |  |  |
  | 890 |  | /\*\* |
  | 891 |  | \* Initialzes the ticker process |
  | 892 |  | \*/ |
  | 893 |  | var initTicker = function(){ |
  | 894 |  | var startPosition = 0; |
  | 895 |  | // if autoDirection is "next", append a clone of the entire slider |
  | 896 |  | if(slider.settings.autoDirection == 'next'){ |
  | 897 |  | el.append(slider.children.clone().addClass('bx-clone')); |
  | 898 |  | // if autoDirection is "prev", prepend a clone of the entire slider, and set the left position |
  | 899 |  | }else{ |
  | 900 |  | el.prepend(slider.children.clone().addClass('bx-clone')); |
  | 901 |  | var position = slider.children.first().position(); |
  | 902 |  | startPosition = slider.settings.mode == 'horizontal' ? -position.left : -position.top; |
  | 903 |  | } |
  | 904 |  | setPositionProperty(startPosition, 'reset', 0); |
  | 905 |  | // do not allow controls in ticker mode |
  | 906 |  | slider.settings.pager = false; |
  | 907 |  | slider.settings.controls = false; |
  | 908 |  | slider.settings.autoControls = false; |
  | 909 |  | // if autoHover is requested |
  | 910 |  | if(slider.settings.tickerHover && !slider.usingCSS){ |
  | 911 |  | // on el hover |
  | 912 |  | slider.viewport.hover(function(){ |
  | 913 |  | el.stop(); |
  | 914 |  | }, function(){ |
  | 915 |  | // calculate the total width of children (used to calculate the speed ratio) |
  | 916 |  | var totalDimens = 0; |
  | 917 |  | slider.children.each(function(index){ |
  | 918 |  | totalDimens += slider.settings.mode == 'horizontal' ? $(this).outerWidth(true) : $(this).outerHeight(true); |
  | 919 |  | }); |
  | 920 |  | // calculate the speed ratio (used to determine the new speed to finish the paused animation) |
  | 921 |  | var ratio = slider.settings.speed / totalDimens; |
  | 922 |  | // determine which property to use |
  | 923 |  | var property = slider.settings.mode == 'horizontal' ? 'left' : 'top'; |
  | 924 |  | // calculate the new speed |
  | 925 |  | var newSpeed = ratio \* (totalDimens - (Math.abs(parseInt(el.css(property))))); |
  | 926 |  | tickerLoop(newSpeed); |
  | 927 |  | }); |
  | 928 |  | } |
  | 929 |  | // start the ticker loop |
  | 930 |  | tickerLoop(); |
  | 931 |  | } |
  | 932 |  |  |
  | 933 |  | /\*\* |
  | 934 |  | \* Runs a continuous loop, news ticker-style |
  | 935 |  | \*/ |
  | 936 |  | var tickerLoop = function(resumeSpeed){ |
  | 937 |  | speed = resumeSpeed ? resumeSpeed : slider.settings.speed; |
  | 938 |  | var position = {left: 0, top: 0}; |
  | 939 |  | var reset = {left: 0, top: 0}; |
  | 940 |  | // if "next" animate left position to last child, then reset left to 0 |
  | 941 |  | if(slider.settings.autoDirection == 'next'){ |
  | 942 |  | position = el.find('.bx-clone').first().position(); |
  | 943 |  | // if "prev" animate left position to 0, then reset left to first non-clone child |
  | 944 |  | }else{ |
  | 945 |  | reset = slider.children.first().position(); |
  | 946 |  | } |
  | 947 |  | var animateProperty = slider.settings.mode == 'horizontal' ? -position.left : -position.top; |
  | 948 |  | var resetValue = slider.settings.mode == 'horizontal' ? -reset.left : -reset.top; |
  | 949 |  | var params = {resetValue: resetValue}; |
  | 950 |  | setPositionProperty(animateProperty, 'ticker', speed, params); |
  | 951 |  | } |
  | 952 |  |  |
  | 953 |  | /\*\* |
  | 954 |  | \* Initializes touch events |
  | 955 |  | \*/ |
  | 956 |  | var initTouch = function(){ |
  | 957 |  | // initialize object to contain all touch values |
  | 958 |  | slider.touch = { |
  | 959 |  | start: {x: 0, y: 0}, |
  | 960 |  | end: {x: 0, y: 0} |
  | 961 |  | } |
  | 962 |  | slider.viewport.bind('touchstart', onTouchStart); |
  | 963 |  | } |
  | 964 |  |  |
  | 965 |  | /\*\* |
  | 966 |  | \* Event handler for "touchstart" |
  | 967 |  | \* |
  | 968 |  | \* @param e (event) |
  | 969 |  | \*  - DOM event object |
  | 970 |  | \*/ |
  | 971 |  | var onTouchStart = function(e){ |
  | 972 |  | if(slider.working){ |
  | 973 |  | e.preventDefault(); |
  | 974 |  | }else{ |
  | 975 |  | // record the original position when touch starts |
  | 976 |  | slider.touch.originalPos = el.position(); |
  | 977 |  | var orig = e.originalEvent; |
  | 978 |  | // record the starting touch x, y coordinates |
  | 979 |  | slider.touch.start.x = orig.changedTouches[0].pageX; |
  | 980 |  | slider.touch.start.y = orig.changedTouches[0].pageY; |
  | 981 |  | // bind a "touchmove" event to the viewport |
  | 982 |  | slider.viewport.bind('touchmove', onTouchMove); |
  | 983 |  | // bind a "touchend" event to the viewport |
  | 984 |  | slider.viewport.bind('touchend', onTouchEnd); |
  | 985 |  | } |
  | 986 |  | } |
  | 987 |  |  |
  | 988 |  | /\*\* |
  | 989 |  | \* Event handler for "touchmove" |
  | 990 |  | \* |
  | 991 |  | \* @param e (event) |
  | 992 |  | \*  - DOM event object |
  | 993 |  | \*/ |
  | 994 |  | var onTouchMove = function(e){ |
  | 995 |  | var orig = e.originalEvent; |
  | 996 |  | // if scrolling on y axis, do not prevent default |
  | 997 |  | var xMovement = Math.abs(orig.changedTouches[0].pageX - slider.touch.start.x); |
  | 998 |  | var yMovement = Math.abs(orig.changedTouches[0].pageY - slider.touch.start.y); |
  | 999 |  | // x axis swipe |
  | 1000 |  | if((xMovement \* 3) > yMovement && slider.settings.preventDefaultSwipeX){ |
  | 1001 |  | e.preventDefault(); |
  | 1002 |  | // y axis swipe |
  | 1003 |  | }else if((yMovement \* 3) > xMovement && slider.settings.preventDefaultSwipeY){ |
  | 1004 |  | e.preventDefault(); |
  | 1005 |  | } |
  | 1006 |  | if(slider.settings.mode != 'fade' && slider.settings.oneToOneTouch){ |
  | 1007 |  | var value = 0; |
  | 1008 |  | // if horizontal, drag along x axis |
  | 1009 |  | if(slider.settings.mode == 'horizontal'){ |
  | 1010 |  | var change = orig.changedTouches[0].pageX - slider.touch.start.x; |
  | 1011 |  | value = slider.touch.originalPos.left + change; |
  | 1012 |  | // if vertical, drag along y axis |
  | 1013 |  | }else{ |
  | 1014 |  | var change = orig.changedTouches[0].pageY - slider.touch.start.y; |
  | 1015 |  | value = slider.touch.originalPos.top + change; |
  | 1016 |  | } |
  | 1017 |  | setPositionProperty(value, 'reset', 0); |
  | 1018 |  | } |
  | 1019 |  | } |
  | 1020 |  |  |
  | 1021 |  | /\*\* |
  | 1022 |  | \* Event handler for "touchend" |
  | 1023 |  | \* |
  | 1024 |  | \* @param e (event) |
  | 1025 |  | \*  - DOM event object |
  | 1026 |  | \*/ |
  | 1027 |  | var onTouchEnd = function(e){ |
  | 1028 |  | slider.viewport.unbind('touchmove', onTouchMove); |
  | 1029 |  | var orig = e.originalEvent; |
  | 1030 |  | var value = 0; |
  | 1031 |  | // record end x, y positions |
  | 1032 |  | slider.touch.end.x = orig.changedTouches[0].pageX; |
  | 1033 |  | slider.touch.end.y = orig.changedTouches[0].pageY; |
  | 1034 |  | // if fade mode, check if absolute x distance clears the threshold |
  | 1035 |  | if(slider.settings.mode == 'fade'){ |
  | 1036 |  | var distance = Math.abs(slider.touch.start.x - slider.touch.end.x); |
  | 1037 |  | if(distance >= slider.settings.swipeThreshold){ |
  | 1038 |  | slider.touch.start.x > slider.touch.end.x ? el.goToNextSlide() : el.goToPrevSlide(); |
  | 1039 |  | el.stopAuto(); |
  | 1040 |  | } |
  | 1041 |  | // not fade mode |
  | 1042 |  | }else{ |
  | 1043 |  | var distance = 0; |
  | 1044 |  | // calculate distance and el's animate property |
  | 1045 |  | if(slider.settings.mode == 'horizontal'){ |
  | 1046 |  | distance = slider.touch.end.x - slider.touch.start.x; |
  | 1047 |  | value = slider.touch.originalPos.left; |
  | 1048 |  | }else{ |
  | 1049 |  | distance = slider.touch.end.y - slider.touch.start.y; |
  | 1050 |  | value = slider.touch.originalPos.top; |
  | 1051 |  | } |
  | 1052 |  | // if not infinite loop and first / last slide, do not attempt a slide transition |
  | 1053 |  | if(!slider.settings.infiniteLoop && ((slider.active.index == 0 && distance > 0) || (slider.active.last && distance < 0))){ |
  | 1054 |  | setPositionProperty(value, 'reset', 200); |
  | 1055 |  | }else{ |
  | 1056 |  | // check if distance clears threshold |
  | 1057 |  | if(Math.abs(distance) >= slider.settings.swipeThreshold){ |
  | 1058 |  | distance < 0 ? el.goToNextSlide() : el.goToPrevSlide(); |
  | 1059 |  | el.stopAuto(); |
  | 1060 |  | }else{ |
  | 1061 |  | // el.animate(property, 200); |
  | 1062 |  | setPositionProperty(value, 'reset', 200); |
  | 1063 |  | } |
  | 1064 |  | } |
  | 1065 |  | } |
  | 1066 |  | slider.viewport.unbind('touchend', onTouchEnd); |
  | 1067 |  | } |
  | 1068 |  |  |
  | 1069 |  | /\*\* |
  | 1070 |  | \* Window resize event callback |
  | 1071 |  | \*/ |
  | 1072 |  | var resizeWindow = function(e){ |
  | 1073 |  | // get the new window dimens (again, thank you IE) |
  | 1074 |  | var windowWidthNew = $(window).width(); |
  | 1075 |  | var windowHeightNew = $(window).height(); |
  | 1076 |  | // make sure that it is a true window resize |
  | 1077 |  | // \*we must check this because our dinosaur friend IE fires a window resize event when certain DOM elements |
  | 1078 |  | // are resized. Can you just die already?\* |
  | 1079 |  | if(windowWidth != windowWidthNew || windowHeight != windowHeightNew){ |
  | 1080 |  | // set the new window dimens |
  | 1081 |  | windowWidth = windowWidthNew; |
  | 1082 |  | windowHeight = windowHeightNew; |
  | 1083 |  | // update all dynamic elements |
  | 1084 |  | el.redrawSlider(); |
  | 1085 |  | } |
  | 1086 |  | } |
  | 1087 |  |  |
  | 1088 |  | /\*\* |
  | 1089 |  | \* =================================================================================== |
  | 1090 |  | \* = PUBLIC FUNCTIONS |
  | 1091 |  | \* =================================================================================== |
  | 1092 |  | \*/ |
  | 1093 |  |  |
  | 1094 |  | /\*\* |
  | 1095 |  | \* Performs slide transition to the specified slide |
  | 1096 |  | \* |
  | 1097 |  | \* @param slideIndex (int) |
  | 1098 |  | \*  - the destination slide's index (zero-based) |
  | 1099 |  | \* |
  | 1100 |  | \* @param direction (string) |
  | 1101 |  | \*  - INTERNAL USE ONLY - the direction of travel ("prev" / "next") |
  | 1102 |  | \*/ |
  | 1103 |  | el.goToSlide = function(slideIndex, direction){ |
  | 1104 |  | // if plugin is currently in motion, ignore request |
  | 1105 |  | if(slider.working || slider.active.index == slideIndex) return; |
  | 1106 |  | // declare that plugin is in motion |
  | 1107 |  | slider.working = true; |
  | 1108 |  | // store the old index |
  | 1109 |  | slider.oldIndex = slider.active.index; |
  | 1110 |  | // if slideIndex is less than zero, set active index to last child (this happens during infinite loop) |
  | 1111 |  | if(slideIndex < 0){ |
  | 1112 |  | slider.active.index = getPagerQty() - 1; |
  | 1113 |  | // if slideIndex is greater than children length, set active index to 0 (this happens during infinite loop) |
  | 1114 |  | }else if(slideIndex >= getPagerQty()){ |
  | 1115 |  | slider.active.index = 0; |
  | 1116 |  | // set active index to requested slide |
  | 1117 |  | }else{ |
  | 1118 |  | slider.active.index = slideIndex; |
  | 1119 |  | } |
  | 1120 |  | // onSlideBefore, onSlideNext, onSlidePrev callbacks |
  | 1121 |  | slider.settings.onSlideBefore(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index); |
  | 1122 |  | if(direction == 'next'){ |
  | 1123 |  | slider.settings.onSlideNext(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index); |
  | 1124 |  | }else if(direction == 'prev'){ |
  | 1125 |  | slider.settings.onSlidePrev(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index); |
  | 1126 |  | } |
  | 1127 |  | // check if last slide |
  | 1128 |  | slider.active.last = slider.active.index >= getPagerQty() - 1; |
  | 1129 |  | // update the pager with active class |
  | 1130 |  | if(slider.settings.pager) updatePagerActive(slider.active.index); |
  | 1131 |  | // // check for direction control update |
  | 1132 |  | if(slider.settings.controls) updateDirectionControls(); |
  | 1133 |  | // if slider is set to mode: "fade" |
  | 1134 |  | if(slider.settings.mode == 'fade'){ |
  | 1135 |  | // if adaptiveHeight is true and next height is different from current height, animate to the new height |
  | 1136 |  | if(slider.settings.adaptiveHeight && slider.viewport.height() != getViewportHeight()){ |
  | 1137 |  | slider.viewport.animate({height: getViewportHeight()}, slider.settings.adaptiveHeightSpeed); |
  | 1138 |  | } |
  | 1139 |  | // fade out the visible child and reset its z-index value |
  | 1140 |  | slider.children.filter(':visible').fadeOut(slider.settings.speed).css({zIndex: 0}); |
  | 1141 |  | // fade in the newly requested slide |
  | 1142 |  | slider.children.eq(slider.active.index).css('zIndex', 51).fadeIn(slider.settings.speed, function(){ |
  | 1143 |  | $(this).css('zIndex', 50); |
  | 1144 |  | updateAfterSlideTransition(); |
  | 1145 |  | }); |
  | 1146 |  | // slider mode is not "fade" |
  | 1147 |  | }else{ |
  | 1148 |  | // if adaptiveHeight is true and next height is different from current height, animate to the new height |
  | 1149 |  | if(slider.settings.adaptiveHeight && slider.viewport.height() != getViewportHeight()){ |
  | 1150 |  | slider.viewport.animate({height: getViewportHeight()}, slider.settings.adaptiveHeightSpeed); |
  | 1151 |  | } |
  | 1152 |  | var moveBy = 0; |
  | 1153 |  | var position = {left: 0, top: 0}; |
  | 1154 |  | // if carousel and not infinite loop |
  | 1155 |  | if(!slider.settings.infiniteLoop && slider.carousel && slider.active.last){ |
  | 1156 |  | if(slider.settings.mode == 'horizontal'){ |
  | 1157 |  | // get the last child position |
  | 1158 |  | var lastChild = slider.children.eq(slider.children.length - 1); |
  | 1159 |  | position = lastChild.position(); |
  | 1160 |  | // calculate the position of the last slide |
  | 1161 |  | moveBy = slider.viewport.width() - lastChild.outerWidth(); |
  | 1162 |  | }else{ |
  | 1163 |  | // get last showing index position |
  | 1164 |  | var lastShowingIndex = slider.children.length - slider.settings.minSlides; |
  | 1165 |  | position = slider.children.eq(lastShowingIndex).position(); |
  | 1166 |  | } |
  | 1167 |  | // horizontal carousel, going previous while on first slide (infiniteLoop mode) |
  | 1168 |  | }else if(slider.carousel && slider.active.last && direction == 'prev'){ |
  | 1169 |  | // get the last child position |
  | 1170 |  | var eq = slider.settings.moveSlides == 1 ? slider.settings.maxSlides - getMoveBy() : ((getPagerQty() - 1) \* getMoveBy()) - (slider.children.length - slider.settings.maxSlides); |
  | 1171 |  | var lastChild = el.children('.bx-clone').eq(eq); |
  | 1172 |  | position = lastChild.position(); |
  | 1173 |  | // if infinite loop and "Next" is clicked on the last slide |
  | 1174 |  | }else if(direction == 'next' && slider.active.index == 0){ |
  | 1175 |  | // get the last clone position |
  | 1176 |  | position = el.find('> .bx-clone').eq(slider.settings.maxSlides).position(); |
  | 1177 |  | slider.active.last = false; |
  | 1178 |  | // normal non-zero requests |
  | 1179 |  | }else if(slideIndex >= 0){ |
  | 1180 |  | var requestEl = slideIndex \* getMoveBy(); |
  | 1181 |  | position = slider.children.eq(requestEl).position(); |
  | 1182 |  | } |
  | 1183 |  |  |
  | 1184 |  | /\* If the position doesn't exist |
  | 1185 |  | \* (e.g. if you destroy the slider on a next click), |
  | 1186 |  | \* it doesn't throw an error. |
  | 1187 |  | \*/ |
  | 1188 |  | if ("undefined" !== typeof(position)) { |
  | 1189 |  | var value = slider.settings.mode == 'horizontal' ? -(position.left - moveBy) : -position.top; |
  | 1190 |  | // plugin values to be animated |
  | 1191 |  | setPositionProperty(value, 'slide', slider.settings.speed); |
  | 1192 |  | } |
  | 1193 |  | } |
  | 1194 |  | } |
  | 1195 |  |  |
  | 1196 |  | /\*\* |
  | 1197 |  | \* Transitions to the next slide in the show |
  | 1198 |  | \*/ |
  | 1199 |  | el.goToNextSlide = function(){ |
  | 1200 |  | // if infiniteLoop is false and last page is showing, disregard call |
  | 1201 |  | if (!slider.settings.infiniteLoop && slider.active.last) return; |
  | 1202 |  | var pagerIndex = parseInt(slider.active.index) + 1; |
  | 1203 |  | el.goToSlide(pagerIndex, 'next'); |
  | 1204 |  | } |
  | 1205 |  |  |
  | 1206 |  | /\*\* |
  | 1207 |  | \* Transitions to the prev slide in the show |
  | 1208 |  | \*/ |
  | 1209 |  | el.goToPrevSlide = function(){ |
  | 1210 |  | // if infiniteLoop is false and last page is showing, disregard call |
  | 1211 |  | if (!slider.settings.infiniteLoop && slider.active.index == 0) return; |
  | 1212 |  | var pagerIndex = parseInt(slider.active.index) - 1; |
  | 1213 |  | el.goToSlide(pagerIndex, 'prev'); |
  | 1214 |  | } |
  | 1215 |  |  |
  | 1216 |  | /\*\* |
  | 1217 |  | \* Starts the auto show |
  | 1218 |  | \* |
  | 1219 |  | \* @param preventControlUpdate (boolean) |
  | 1220 |  | \*  - if true, auto controls state will not be updated |
  | 1221 |  | \*/ |
  | 1222 |  | el.startAuto = function(preventControlUpdate){ |
  | 1223 |  | // if an interval already exists, disregard call |
  | 1224 |  | if(slider.interval) return; |
  | 1225 |  | // create an interval |
  | 1226 |  | slider.interval = setInterval(function(){ |
  | 1227 |  | slider.settings.autoDirection == 'next' ? el.goToNextSlide() : el.goToPrevSlide(); |
  | 1228 |  | }, slider.settings.pause); |
  | 1229 |  | // if auto controls are displayed and preventControlUpdate is not true |
  | 1230 |  | if (slider.settings.autoControls && preventControlUpdate != true) updateAutoControls('stop'); |
  | 1231 |  | } |
  | 1232 |  |  |
  | 1233 |  | /\*\* |
  | 1234 |  | \* Stops the auto show |
  | 1235 |  | \* |
  | 1236 |  | \* @param preventControlUpdate (boolean) |
  | 1237 |  | \*  - if true, auto controls state will not be updated |
  | 1238 |  | \*/ |
  | 1239 |  | el.stopAuto = function(preventControlUpdate){ |
  | 1240 |  | // if no interval exists, disregard call |
  | 1241 |  | if(!slider.interval) return; |
  | 1242 |  | // clear the interval |
  | 1243 |  | clearInterval(slider.interval); |
  | 1244 |  | slider.interval = null; |
  | 1245 |  | // if auto controls are displayed and preventControlUpdate is not true |
  | 1246 |  | if (slider.settings.autoControls && preventControlUpdate != true) updateAutoControls('start'); |
  | 1247 |  | } |
  | 1248 |  |  |
  | 1249 |  | /\*\* |
  | 1250 |  | \* Returns current slide index (zero-based) |
  | 1251 |  | \*/ |
  | 1252 |  | el.getCurrentSlide = function(){ |
  | 1253 |  | return slider.active.index; |
  | 1254 |  | } |
  | 1255 |  |  |
  | 1256 |  | /\*\* |
  | 1257 |  | \* Returns number of slides in show |
  | 1258 |  | \*/ |
  | 1259 |  | el.getSlideCount = function(){ |
  | 1260 |  | return slider.children.length; |
  | 1261 |  | } |
  | 1262 |  |  |
  | 1263 |  | /\*\* |
  | 1264 |  | \* Update all dynamic slider elements |
  | 1265 |  | \*/ |
  | 1266 |  | el.redrawSlider = function(){ |
  | 1267 |  | // resize all children in ratio to new screen size |
  | 1268 |  | slider.children.add(el.find('.bx-clone')).outerWidth(getSlideWidth()); |
  | 1269 |  | // adjust the height |
  | 1270 |  | slider.viewport.css('height', getViewportHeight()); |
  | 1271 |  | // update the slide position |
  | 1272 |  | if(!slider.settings.ticker) setSlidePosition(); |
  | 1273 |  | // if active.last was true before the screen resize, we want |
  | 1274 |  | // to keep it last no matter what screen size we end on |
  | 1275 |  | if (slider.active.last) slider.active.index = getPagerQty() - 1; |
  | 1276 |  | // if the active index (page) no longer exists due to the resize, simply set the index as last |
  | 1277 |  | if (slider.active.index >= getPagerQty()) slider.active.last = true; |
  | 1278 |  | // if a pager is being displayed and a custom pager is not being used, update it |
  | 1279 |  | if(slider.settings.pager && !slider.settings.pagerCustom){ |
  | 1280 |  | populatePager(); |
  | 1281 |  | updatePagerActive(slider.active.index); |
  | 1282 |  | } |
  | 1283 |  | } |
  | 1284 |  |  |
  | 1285 |  | /\*\* |
  | 1286 |  | \* Destroy the current instance of the slider (revert everything back to original state) |
  | 1287 |  | \*/ |
  | 1288 |  | el.destroySlider = function(){ |
  | 1289 |  | // don't do anything if slider has already been destroyed |
  | 1290 |  | if(!slider.initialized) return; |
  | 1291 |  | slider.initialized = false; |
  | 1292 |  | $('.bx-clone', this).remove(); |
  | 1293 |  | slider.children.each(function() { |
  | 1294 |  | $(this).data("origStyle") != undefined ? $(this).attr("style", $(this).data("origStyle")) : $(this).removeAttr('style'); |
  | 1295 |  | }); |
  | 1296 |  | $(this).data("origStyle") != undefined ? this.attr("style", $(this).data("origStyle")) : $(this).removeAttr('style'); |
  | 1297 |  | $(this).unwrap().unwrap(); |
  | 1298 |  | if(slider.controls.el) slider.controls.el.remove(); |
  | 1299 |  | if(slider.controls.next) slider.controls.next.remove(); |
  | 1300 |  | if(slider.controls.prev) slider.controls.prev.remove(); |
  | 1301 |  | if(slider.pagerEl) slider.pagerEl.remove(); |
  | 1302 |  | $('.bx-caption', this).remove(); |
  | 1303 |  | if(slider.controls.autoEl) slider.controls.autoEl.remove(); |
  | 1304 |  | clearInterval(slider.interval); |
  | 1305 |  | if(slider.settings.responsive) $(window).unbind('resize', resizeWindow); |
  | 1306 |  | } |
  | 1307 |  |  |
  | 1308 |  | /\*\* |
  | 1309 |  | \* Reload the slider (revert all DOM changes, and re-initialize) |
  | 1310 |  | \*/ |
  | 1311 |  | el.reloadSlider = function(settings){ |
  | 1312 |  | if (settings != undefined) options = settings; |
  | 1313 |  | el.destroySlider(); |
  | 1314 |  | init(); |
  | 1315 |  | } |
  | 1316 |  |  |
  | 1317 |  | init(); |
  | 1318 |  |  |
  | 1319 |  | // returns the current jQuery object |
  | 1320 |  | return this; |
  | 1321 |  | } |
  |  | 971 | // calculate the speed ratio (used to determine the new speed to finish the paused animation) |
  |  | 972 | ratio = slider.settings.speed / totalDimens; |
  |  | 973 | // determine which property to use |
  |  | 974 | property = slider.settings.mode === 'horizontal' ? 'left' : 'top'; |
  |  | 975 | // calculate the new speed |
  |  | 976 | newSpeed = ratio \* (totalDimens - (Math.abs(parseInt(value)))); |
  |  | 977 | tickerLoop(newSpeed); |
  |  | 978 | }); |
  |  | 979 | } else { |
  |  | 980 | // on el hover |
  |  | 981 | slider.viewport.hover(function() { |
  |  | 982 | el.stop(); |
  |  | 983 | }, function() { |
  |  | 984 | // calculate the total width of children (used to calculate the speed ratio) |
  |  | 985 | totalDimens = 0; |
  |  | 986 | slider.children.each(function(index) { |
  |  | 987 | totalDimens += slider.settings.mode === 'horizontal' ? $(this).outerWidth(true) : $(this).outerHeight(true); |
  |  | 988 | }); |
  |  | 989 | // calculate the speed ratio (used to determine the new speed to finish the paused animation) |
  |  | 990 | ratio = slider.settings.speed / totalDimens; |
  |  | 991 | // determine which property to use |
  |  | 992 | property = slider.settings.mode === 'horizontal' ? 'left' : 'top'; |
  |  | 993 | // calculate the new speed |
  |  | 994 | newSpeed = ratio \* (totalDimens - (Math.abs(parseInt(el.css(property))))); |
  |  | 995 | tickerLoop(newSpeed); |
  |  | 996 | }); |
  |  | 997 | } |
  |  | 998 | } |
  |  | 999 | // start the ticker loop |
  |  | 1000 | tickerLoop(); |
  |  | 1001 | }; |
  |  | 1002 |  |
  |  | 1003 | /\*\* |
  |  | 1004 | \* Runs a continuous loop, news ticker-style |
  |  | 1005 | \*/ |
  |  | 1006 | var tickerLoop = function(resumeSpeed) { |
  |  | 1007 | var speed = resumeSpeed ? resumeSpeed : slider.settings.speed, |
  |  | 1008 | position = {left: 0, top: 0}, |
  |  | 1009 | reset = {left: 0, top: 0}, |
  |  | 1010 | animateProperty, resetValue, params; |
  |  | 1011 |  |
  |  | 1012 | // if "next" animate left position to last child, then reset left to 0 |
  |  | 1013 | if (slider.settings.autoDirection === 'next') { |
  |  | 1014 | position = el.find('.bx-clone').first().position(); |
  |  | 1015 | // if "prev" animate left position to 0, then reset left to first non-clone child |
  |  | 1016 | } else { |
  |  | 1017 | reset = slider.children.first().position(); |
  |  | 1018 | } |
  |  | 1019 | animateProperty = slider.settings.mode === 'horizontal' ? -position.left : -position.top; |
  |  | 1020 | resetValue = slider.settings.mode === 'horizontal' ? -reset.left : -reset.top; |
  |  | 1021 | params = {resetValue: resetValue}; |
  |  | 1022 | setPositionProperty(animateProperty, 'ticker', speed, params); |
  |  | 1023 | }; |
  |  | 1024 |  |
  |  | 1025 | /\*\* |
  |  | 1026 | \* Check if el is on screen |
  |  | 1027 | \*/ |
  |  | 1028 | var isOnScreen = function(el) { |
  |  | 1029 | var win = $(window), |
  |  | 1030 | viewport = { |
  |  | 1031 | top: win.scrollTop(), |
  |  | 1032 | left: win.scrollLeft() |
  |  | 1033 | }, |
  |  | 1034 | bounds = el.offset(); |
  |  | 1035 |  |
  |  | 1036 | viewport.right = viewport.left + win.width(); |
  |  | 1037 | viewport.bottom = viewport.top + win.height(); |
  |  | 1038 | bounds.right = bounds.left + el.outerWidth(); |
  |  | 1039 | bounds.bottom = bounds.top + el.outerHeight(); |
  |  | 1040 |  |
  |  | 1041 | return (!(viewport.right < bounds.left || viewport.left > bounds.right || viewport.bottom < bounds.top || viewport.top > bounds.bottom)); |
  |  | 1042 | }; |
  |  | 1043 |  |
  |  | 1044 | /\*\* |
  |  | 1045 | \* Initializes keyboard events |
  |  | 1046 | \*/ |
  |  | 1047 | var keyPress = function(e) { |
  |  | 1048 | var activeElementTag = document.activeElement.tagName.toLowerCase(), |
  |  | 1049 | tagFilters = 'input|textarea', |
  |  | 1050 | p = new RegExp(activeElementTag,['i']), |
  |  | 1051 | result = p.exec(tagFilters); |
  |  | 1052 |  |
  |  | 1053 | if (result == null && isOnScreen(el)) { |
  |  | 1054 | if (e.keyCode === 39) { |
  |  | 1055 | clickNextBind(e); |
  |  | 1056 | return false; |
  |  | 1057 | } else if (e.keyCode === 37) { |
  |  | 1058 | clickPrevBind(e); |
  |  | 1059 | return false; |
  |  | 1060 | } |
  |  | 1061 | } |
  |  | 1062 | }; |
  |  | 1063 |  |
  |  | 1064 | /\*\* |
  |  | 1065 | \* Initializes touch events |
  |  | 1066 | \*/ |
  |  | 1067 | var initTouch = function() { |
  |  | 1068 | // initialize object to contain all touch values |
  |  | 1069 | slider.touch = { |
  |  | 1070 | start: {x: 0, y: 0}, |
  |  | 1071 | end: {x: 0, y: 0} |
  |  | 1072 | }; |
  |  | 1073 | slider.viewport.bind('touchstart MSPointerDown pointerdown', onTouchStart); |
  |  | 1074 |  |
  |  | 1075 | //for browsers that have implemented pointer events and fire a click after |
  |  | 1076 | //every pointerup regardless of whether pointerup is on same screen location as pointerdown or not |
  |  | 1077 | slider.viewport.on('click', '.bxslider a', function(e) { |
  |  | 1078 | if (slider.viewport.hasClass('click-disabled')) { |
  |  | 1079 | e.preventDefault(); |
  |  | 1080 | slider.viewport.removeClass('click-disabled'); |
  |  | 1081 | } |
  |  | 1082 | }); |
  |  | 1083 | }; |
  |  | 1084 |  |
  |  | 1085 | /\*\* |
  |  | 1086 | \* Event handler for "touchstart" |
  |  | 1087 | \* |
  |  | 1088 | \* @param e (event) |
  |  | 1089 | \*  - DOM event object |
  |  | 1090 | \*/ |
  |  | 1091 | var onTouchStart = function(e) { |
  |  | 1092 | //disable slider controls while user is interacting with slides to avoid slider freeze that happens on touch devices when a slide swipe happens immediately after interacting with slider controls |
  |  | 1093 | slider.controls.el.addClass('disabled'); |
  |  | 1094 |  |
  |  | 1095 | if (slider.working) { |
  |  | 1096 | e.preventDefault(); |
  |  | 1097 | slider.controls.el.removeClass('disabled'); |
  |  | 1098 | } else { |
  |  | 1099 | // record the original position when touch starts |
  |  | 1100 | slider.touch.originalPos = el.position(); |
  |  | 1101 | var orig = e.originalEvent, |
  |  | 1102 | touchPoints = (typeof orig.changedTouches !== 'undefined') ? orig.changedTouches : [orig]; |
  |  | 1103 | // record the starting touch x, y coordinates |
  |  | 1104 | slider.touch.start.x = touchPoints[0].pageX; |
  |  | 1105 | slider.touch.start.y = touchPoints[0].pageY; |
  |  | 1106 |  |
  |  | 1107 | if (slider.viewport.get(0).setPointerCapture) { |
  |  | 1108 | slider.pointerId = orig.pointerId; |
  |  | 1109 | slider.viewport.get(0).setPointerCapture(slider.pointerId); |
  |  | 1110 | } |
  |  | 1111 | // bind a "touchmove" event to the viewport |
  |  | 1112 | slider.viewport.bind('touchmove MSPointerMove pointermove', onTouchMove); |
  |  | 1113 | // bind a "touchend" event to the viewport |
  |  | 1114 | slider.viewport.bind('touchend MSPointerUp pointerup', onTouchEnd); |
  |  | 1115 | slider.viewport.bind('MSPointerCancel pointercancel', onPointerCancel); |
  |  | 1116 | } |
  |  | 1117 | }; |
  |  | 1118 |  |
  |  | 1119 | /\*\* |
  |  | 1120 | \* Cancel Pointer for Windows Phone |
  |  | 1121 | \* |
  |  | 1122 | \* @param e (event) |
  |  | 1123 | \*  - DOM event object |
  |  | 1124 | \*/ |
  |  | 1125 | var onPointerCancel = function(e) { |
  |  | 1126 | /\* onPointerCancel handler is needed to deal with situations when a touchend |
  |  | 1127 | doesn't fire after a touchstart (this happens on windows phones only) \*/ |
  |  | 1128 | setPositionProperty(slider.touch.originalPos.left, 'reset', 0); |
  |  | 1129 |  |
  |  | 1130 | //remove handlers |
  |  | 1131 | slider.controls.el.removeClass('disabled'); |
  |  | 1132 | slider.viewport.unbind('MSPointerCancel pointercancel', onPointerCancel); |
  |  | 1133 | slider.viewport.unbind('touchmove MSPointerMove pointermove', onTouchMove); |
  |  | 1134 | slider.viewport.unbind('touchend MSPointerUp pointerup', onTouchEnd); |
  |  | 1135 | if (slider.viewport.get(0).releasePointerCapture) { |
  |  | 1136 | slider.viewport.get(0).releasePointerCapture(slider.pointerId); |
  |  | 1137 | } |
  |  | 1138 | }; |
  |  | 1139 |  |
  |  | 1140 | /\*\* |
  |  | 1141 | \* Event handler for "touchmove" |
  |  | 1142 | \* |
  |  | 1143 | \* @param e (event) |
  |  | 1144 | \*  - DOM event object |
  |  | 1145 | \*/ |
  |  | 1146 | var onTouchMove = function(e) { |
  |  | 1147 | var orig = e.originalEvent, |
  |  | 1148 | touchPoints = (typeof orig.changedTouches !== 'undefined') ? orig.changedTouches : [orig], |
  |  | 1149 | // if scrolling on y axis, do not prevent default |
  |  | 1150 | xMovement = Math.abs(touchPoints[0].pageX - slider.touch.start.x), |
  |  | 1151 | yMovement = Math.abs(touchPoints[0].pageY - slider.touch.start.y), |
  |  | 1152 | value = 0, |
  |  | 1153 | change = 0; |
  |  | 1154 |  |
  |  | 1155 | // x axis swipe |
  |  | 1156 | if ((xMovement \* 3) > yMovement && slider.settings.preventDefaultSwipeX) { |
  |  | 1157 | e.preventDefault(); |
  |  | 1158 | // y axis swipe |
  |  | 1159 | } else if ((yMovement \* 3) > xMovement && slider.settings.preventDefaultSwipeY) { |
  |  | 1160 | e.preventDefault(); |
  |  | 1161 | } |
  |  | 1162 | if (slider.settings.mode !== 'fade' && slider.settings.oneToOneTouch) { |
  |  | 1163 | // if horizontal, drag along x axis |
  |  | 1164 | if (slider.settings.mode === 'horizontal') { |
  |  | 1165 | change = touchPoints[0].pageX - slider.touch.start.x; |
  |  | 1166 | value = slider.touch.originalPos.left + change; |
  |  | 1167 | // if vertical, drag along y axis |
  |  | 1168 | } else { |
  |  | 1169 | change = touchPoints[0].pageY - slider.touch.start.y; |
  |  | 1170 | value = slider.touch.originalPos.top + change; |
  |  | 1171 | } |
  |  | 1172 | setPositionProperty(value, 'reset', 0); |
  |  | 1173 | } |
  |  | 1174 | }; |
  |  | 1175 |  |
  |  | 1176 | /\*\* |
  |  | 1177 | \* Event handler for "touchend" |
  |  | 1178 | \* |
  |  | 1179 | \* @param e (event) |
  |  | 1180 | \*  - DOM event object |
  |  | 1181 | \*/ |
  |  | 1182 | var onTouchEnd = function(e) { |
  |  | 1183 | slider.viewport.unbind('touchmove MSPointerMove pointermove', onTouchMove); |
  |  | 1184 | //enable slider controls as soon as user stops interacing with slides |
  |  | 1185 | slider.controls.el.removeClass('disabled'); |
  |  | 1186 | var orig    = e.originalEvent, |
  |  | 1187 | touchPoints = (typeof orig.changedTouches !== 'undefined') ? orig.changedTouches : [orig], |
  |  | 1188 | value       = 0, |
  |  | 1189 | distance    = 0; |
  |  | 1190 | // record end x, y positions |
  |  | 1191 | slider.touch.end.x = touchPoints[0].pageX; |
  |  | 1192 | slider.touch.end.y = touchPoints[0].pageY; |
  |  | 1193 | // if fade mode, check if absolute x distance clears the threshold |
  |  | 1194 | if (slider.settings.mode === 'fade') { |
  |  | 1195 | distance = Math.abs(slider.touch.start.x - slider.touch.end.x); |
  |  | 1196 | if (distance >= slider.settings.swipeThreshold) { |
  |  | 1197 | if (slider.touch.start.x > slider.touch.end.x) { |
  |  | 1198 | el.goToNextSlide(); |
  |  | 1199 | } else { |
  |  | 1200 | el.goToPrevSlide(); |
  |  | 1201 | } |
  |  | 1202 | el.stopAuto(); |
  |  | 1203 | } |
  |  | 1204 | // not fade mode |
  |  | 1205 | } else { |
  |  | 1206 | // calculate distance and el's animate property |
  |  | 1207 | if (slider.settings.mode === 'horizontal') { |
  |  | 1208 | distance = slider.touch.end.x - slider.touch.start.x; |
  |  | 1209 | value = slider.touch.originalPos.left; |
  |  | 1210 | } else { |
  |  | 1211 | distance = slider.touch.end.y - slider.touch.start.y; |
  |  | 1212 | value = slider.touch.originalPos.top; |
  |  | 1213 | } |
  |  | 1214 | // if not infinite loop and first / last slide, do not attempt a slide transition |
  |  | 1215 | if (!slider.settings.infiniteLoop && ((slider.active.index === 0 && distance > 0) || (slider.active.last && distance < 0))) { |
  |  | 1216 | setPositionProperty(value, 'reset', 200); |
  |  | 1217 | } else { |
  |  | 1218 | // check if distance clears threshold |
  |  | 1219 | if (Math.abs(distance) >= slider.settings.swipeThreshold) { |
  |  | 1220 | if (distance < 0) { |
  |  | 1221 | el.goToNextSlide(); |
  |  | 1222 | } else { |
  |  | 1223 | el.goToPrevSlide(); |
  |  | 1224 | } |
  |  | 1225 | el.stopAuto(); |
  |  | 1226 | } else { |
  |  | 1227 | // el.animate(property, 200); |
  |  | 1228 | setPositionProperty(value, 'reset', 200); |
  |  | 1229 | } |
  |  | 1230 | } |
  |  | 1231 | } |
  |  | 1232 | slider.viewport.unbind('touchend MSPointerUp pointerup', onTouchEnd); |
  |  | 1233 | if (slider.viewport.get(0).releasePointerCapture) { |
  |  | 1234 | slider.viewport.get(0).releasePointerCapture(slider.pointerId); |
  |  | 1235 | } |
  |  | 1236 | }; |
  |  | 1237 |  |
  |  | 1238 | /\*\* |
  |  | 1239 | \* Window resize event callback |
  |  | 1240 | \*/ |
  |  | 1241 | var resizeWindow = function(e) { |
  |  | 1242 | // don't do anything if slider isn't initialized. |
  |  | 1243 | if (!slider.initialized) { return; } |
  |  | 1244 | // Delay if slider working. |
  |  | 1245 | if (slider.working) { |
  |  | 1246 | window.setTimeout(resizeWindow, 10); |
  |  | 1247 | } else { |
  |  | 1248 | // get the new window dimens (again, thank you IE) |
  |  | 1249 | var windowWidthNew = $(window).width(), |
  |  | 1250 | windowHeightNew = $(window).height(); |
  |  | 1251 | // make sure that it is a true window resize |
  |  | 1252 | // \*we must check this because our dinosaur friend IE fires a window resize event when certain DOM elements |
  |  | 1253 | // are resized. Can you just die already?\* |
  |  | 1254 | if (windowWidth !== windowWidthNew || windowHeight !== windowHeightNew) { |
  |  | 1255 | // set the new window dimens |
  |  | 1256 | windowWidth = windowWidthNew; |
  |  | 1257 | windowHeight = windowHeightNew; |
  |  | 1258 | // update all dynamic elements |
  |  | 1259 | el.redrawSlider(); |
  |  | 1260 | // Call user resize handler |
  |  | 1261 | slider.settings.onSliderResize.call(el, slider.active.index); |
  |  | 1262 | } |
  |  | 1263 | } |
  |  | 1264 | }; |
  |  | 1265 |  |
  |  | 1266 | /\*\* |
  |  | 1267 | \* Adds an aria-hidden=true attribute to each element |
  |  | 1268 | \* |
  |  | 1269 | \* @param startVisibleIndex (int) |
  |  | 1270 | \*  - the first visible element's index |
  |  | 1271 | \*/ |
  |  | 1272 | var applyAriaHiddenAttributes = function(startVisibleIndex) { |
  |  | 1273 | var numberOfSlidesShowing = getNumberSlidesShowing(); |
  |  | 1274 | // only apply attributes if the setting is enabled and not in ticker mode |
  |  | 1275 | if (slider.settings.ariaHidden && !slider.settings.ticker) { |
  |  | 1276 | // add aria-hidden=true to all elements |
  |  | 1277 | slider.children.attr('aria-hidden', 'true'); |
  |  | 1278 | // get the visible elements and change to aria-hidden=false |
  |  | 1279 | slider.children.slice(startVisibleIndex, startVisibleIndex + numberOfSlidesShowing).attr('aria-hidden', 'false'); |
  |  | 1280 | } |
  |  | 1281 | }; |
  |  | 1282 |  |
  |  | 1283 | /\*\* |
  |  | 1284 | \* =================================================================================== |
  |  | 1285 | \* = PUBLIC FUNCTIONS |
  |  | 1286 | \* =================================================================================== |
  |  | 1287 | \*/ |
  |  | 1288 |  |
  |  | 1289 | /\*\* |
  |  | 1290 | \* Performs slide transition to the specified slide |
  |  | 1291 | \* |
  |  | 1292 | \* @param slideIndex (int) |
  |  | 1293 | \*  - the destination slide's index (zero-based) |
  |  | 1294 | \* |
  |  | 1295 | \* @param direction (string) |
  |  | 1296 | \*  - INTERNAL USE ONLY - the direction of travel ("prev" / "next") |
  |  | 1297 | \*/ |
  |  | 1298 | el.goToSlide = function(slideIndex, direction) { |
  |  | 1299 | // onSlideBefore, onSlideNext, onSlidePrev callbacks |
  |  | 1300 | // Allow transition canceling based on returned value |
  |  | 1301 | var performTransition = true, |
  |  | 1302 | moveBy = 0, |
  |  | 1303 | position = {left: 0, top: 0}, |
  |  | 1304 | lastChild = null, |
  |  | 1305 | lastShowingIndex, eq, value, requestEl; |
  |  | 1306 |  |
  |  | 1307 | // if plugin is currently in motion, ignore request |
  |  | 1308 | if (slider.working || slider.active.index === slideIndex) { return; } |
  |  | 1309 | // declare that plugin is in motion |
  |  | 1310 | slider.working = true; |
  |  | 1311 | // store the old index |
  |  | 1312 | slider.oldIndex = slider.active.index; |
  |  | 1313 | // if slideIndex is less than zero, set active index to last child (this happens during infinite loop) |
  |  | 1314 | if (slideIndex < 0) { |
  |  | 1315 | slider.active.index = getPagerQty() - 1; |
  |  | 1316 | // if slideIndex is greater than children length, set active index to 0 (this happens during infinite loop) |
  |  | 1317 | } else if (slideIndex >= getPagerQty()) { |
  |  | 1318 | slider.active.index = 0; |
  |  | 1319 | // set active index to requested slide |
  |  | 1320 | } else { |
  |  | 1321 | slider.active.index = slideIndex; |
  |  | 1322 | } |
  |  | 1323 |  |
  |  | 1324 | performTransition = slider.settings.onSlideBefore.call(el, slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index); |
  |  | 1325 |  |
  |  | 1326 | if (typeof (performTransition) !== 'undefined' && !performTransition) { |
  |  | 1327 | slider.active.index = slider.oldIndex; // restore old index |
  |  | 1328 | slider.working = false; // is not in motion |
  |  | 1329 | return; |
  |  | 1330 | } |
  |  | 1331 | if (direction === 'next') { |
  |  | 1332 | // Prevent canceling in future functions or lack there-of from negating previous commands to cancel |
  |  | 1333 | if (!slider.settings.onSlideNext.call(el, slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index)) { |
  |  | 1334 | performTransition = false; |
  |  | 1335 | } |
  |  | 1336 | } else if (direction === 'prev') { |
  |  | 1337 | // Prevent canceling in future functions or lack there-of from negating previous commands to cancel |
  |  | 1338 | if (!slider.settings.onSlidePrev.call(el, slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index)) { |
  |  | 1339 | performTransition = false; |
  |  | 1340 | } |
  |  | 1341 | } |
  |  | 1342 |  |
  |  | 1343 | // If transitions canceled, reset and return |
  |  | 1344 | if (typeof (performTransition) !== 'undefined' && !performTransition) { |
  |  | 1345 | slider.active.index = slider.oldIndex; // restore old index |
  |  | 1346 | slider.working = false; // is not in motion |
  |  | 1347 | return; |
  |  | 1348 | } |
  |  | 1349 |  |
  |  | 1350 | // check if last slide |
  |  | 1351 | slider.active.last = slider.active.index >= getPagerQty() - 1; |
  |  | 1352 | // update the pager with active class |
  |  | 1353 | if (slider.settings.pager || slider.settings.pagerCustom) { updatePagerActive(slider.active.index); } |
  |  | 1354 | // // check for direction control update |
  |  | 1355 | if (slider.settings.controls) { updateDirectionControls(); } |
  |  | 1356 | // if slider is set to mode: "fade" |
  |  | 1357 | if (slider.settings.mode === 'fade') { |
  |  | 1358 | // if adaptiveHeight is true and next height is different from current height, animate to the new height |
  |  | 1359 | if (slider.settings.adaptiveHeight && slider.viewport.height() !== getViewportHeight()) { |
  |  | 1360 | slider.viewport.animate({height: getViewportHeight()}, slider.settings.adaptiveHeightSpeed); |
  |  | 1361 | } |
  |  | 1362 | // fade out the visible child and reset its z-index value |
  |  | 1363 | slider.children.filter(':visible').fadeOut(slider.settings.speed).css({zIndex: 0}); |
  |  | 1364 | // fade in the newly requested slide |
  |  | 1365 | slider.children.eq(slider.active.index).css('zIndex', slider.settings.slideZIndex + 1).fadeIn(slider.settings.speed, function() { |
  |  | 1366 | $(this).css('zIndex', slider.settings.slideZIndex); |
  |  | 1367 | updateAfterSlideTransition(); |
  |  | 1368 | }); |
  |  | 1369 | // slider mode is not "fade" |
  |  | 1370 | } else { |
  |  | 1371 | // if adaptiveHeight is true and next height is different from current height, animate to the new height |
  |  | 1372 | if (slider.settings.adaptiveHeight && slider.viewport.height() !== getViewportHeight()) { |
  |  | 1373 | slider.viewport.animate({height: getViewportHeight()}, slider.settings.adaptiveHeightSpeed); |
  |  | 1374 | } |
  |  | 1375 | // if carousel and not infinite loop |
  |  | 1376 | if (!slider.settings.infiniteLoop && slider.carousel && slider.active.last) { |
  |  | 1377 | if (slider.settings.mode === 'horizontal') { |
  |  | 1378 | // get the last child position |
  |  | 1379 | lastChild = slider.children.eq(slider.children.length - 1); |
  |  | 1380 | position = lastChild.position(); |
  |  | 1381 | // calculate the position of the last slide |
  |  | 1382 | moveBy = slider.viewport.width() - lastChild.outerWidth(); |
  |  | 1383 | } else { |
  |  | 1384 | // get last showing index position |
  |  | 1385 | lastShowingIndex = slider.children.length - slider.settings.minSlides; |
  |  | 1386 | position = slider.children.eq(lastShowingIndex).position(); |
  |  | 1387 | } |
  |  | 1388 | // horizontal carousel, going previous while on first slide (infiniteLoop mode) |
  |  | 1389 | } else if (slider.carousel && slider.active.last && direction === 'prev') { |
  |  | 1390 | // get the last child position |
  |  | 1391 | eq = slider.settings.moveSlides === 1 ? slider.settings.maxSlides - getMoveBy() : ((getPagerQty() - 1) \* getMoveBy()) - (slider.children.length - slider.settings.maxSlides); |
  |  | 1392 | lastChild = el.children('.bx-clone').eq(eq); |
  |  | 1393 | position = lastChild.position(); |
  |  | 1394 | // if infinite loop and "Next" is clicked on the last slide |
  |  | 1395 | } else if (direction === 'next' && slider.active.index === 0) { |
  |  | 1396 | // get the last clone position |
  |  | 1397 | position = el.find('> .bx-clone').eq(slider.settings.maxSlides).position(); |
  |  | 1398 | slider.active.last = false; |
  |  | 1399 | // normal non-zero requests |
  |  | 1400 | } else if (slideIndex >= 0) { |
  |  | 1401 | requestEl = slideIndex \* getMoveBy(); |
  |  | 1402 | position = slider.children.eq(requestEl).position(); |
  |  | 1403 | } |
  |  | 1404 |  |
  |  | 1405 | /\* If the position doesn't exist |
  |  | 1406 | \* (e.g. if you destroy the slider on a next click), |
  |  | 1407 | \* it doesn't throw an error. |
  |  | 1408 | \*/ |
  |  | 1409 | if (typeof (position) !== undefined) { |
  |  | 1410 | value = slider.settings.mode === 'horizontal' ? -(position.left - moveBy) : -position.top; |
  |  | 1411 | // plugin values to be animated |
  |  | 1412 | setPositionProperty(value, 'slide', slider.settings.speed); |
  |  | 1413 | } |
  |  | 1414 | } |
  |  | 1415 | if (slider.settings.ariaHidden) { applyAriaHiddenAttributes(slider.active.index \* getMoveBy()); } |
  |  | 1416 | }; |
  |  | 1417 |  |
  |  | 1418 | /\*\* |
  |  | 1419 | \* Transitions to the next slide in the show |
  |  | 1420 | \*/ |
  |  | 1421 | el.goToNextSlide = function() { |
  |  | 1422 | // if infiniteLoop is false and last page is showing, disregard call |
  |  | 1423 | if (!slider.settings.infiniteLoop && slider.active.last) { return; } |
  |  | 1424 | var pagerIndex = parseInt(slider.active.index) + 1; |
  |  | 1425 | el.goToSlide(pagerIndex, 'next'); |
  |  | 1426 | }; |
  |  | 1427 |  |
  |  | 1428 | /\*\* |
  |  | 1429 | \* Transitions to the prev slide in the show |
  |  | 1430 | \*/ |
  |  | 1431 | el.goToPrevSlide = function() { |
  |  | 1432 | // if infiniteLoop is false and last page is showing, disregard call |
  |  | 1433 | if (!slider.settings.infiniteLoop && slider.active.index === 0) { return; } |
  |  | 1434 | var pagerIndex = parseInt(slider.active.index) - 1; |
  |  | 1435 | el.goToSlide(pagerIndex, 'prev'); |
  |  | 1436 | }; |
  |  | 1437 |  |
  |  | 1438 | /\*\* |
  |  | 1439 | \* Starts the auto show |
  |  | 1440 | \* |
  |  | 1441 | \* @param preventControlUpdate (boolean) |
  |  | 1442 | \*  - if true, auto controls state will not be updated |
  |  | 1443 | \*/ |
  |  | 1444 | el.startAuto = function(preventControlUpdate) { |
  |  | 1445 | // if an interval already exists, disregard call |
  |  | 1446 | if (slider.interval) { return; } |
  |  | 1447 | // create an interval |
  |  | 1448 | slider.interval = setInterval(function() { |
  |  | 1449 | if (slider.settings.autoDirection === 'next') { |
  |  | 1450 | el.goToNextSlide(); |
  |  | 1451 | } else { |
  |  | 1452 | el.goToPrevSlide(); |
  |  | 1453 | } |
  |  | 1454 | }, slider.settings.pause); |
  |  | 1455 | // if auto controls are displayed and preventControlUpdate is not true |
  |  | 1456 | if (slider.settings.autoControls && preventControlUpdate !== true) { updateAutoControls('stop'); } |
  |  | 1457 | }; |
  |  | 1458 |  |
  |  | 1459 | /\*\* |
  |  | 1460 | \* Stops the auto show |
  |  | 1461 | \* |
  |  | 1462 | \* @param preventControlUpdate (boolean) |
  |  | 1463 | \*  - if true, auto controls state will not be updated |
  |  | 1464 | \*/ |
  |  | 1465 | el.stopAuto = function(preventControlUpdate) { |
  |  | 1466 | // if no interval exists, disregard call |
  |  | 1467 | if (!slider.interval) { return; } |
  |  | 1468 | // clear the interval |
  |  | 1469 | clearInterval(slider.interval); |
  |  | 1470 | slider.interval = null; |
  |  | 1471 | // if auto controls are displayed and preventControlUpdate is not true |
  |  | 1472 | if (slider.settings.autoControls && preventControlUpdate !== true) { updateAutoControls('start'); } |
  |  | 1473 | }; |
  |  | 1474 |  |
  |  | 1475 | /\*\* |
  |  | 1476 | \* Returns current slide index (zero-based) |
  |  | 1477 | \*/ |
  |  | 1478 | el.getCurrentSlide = function() { |
  |  | 1479 | return slider.active.index; |
  |  | 1480 | }; |
  |  | 1481 |  |
  |  | 1482 | /\*\* |
  |  | 1483 | \* Returns current slide element |
  |  | 1484 | \*/ |
  |  | 1485 | el.getCurrentSlideElement = function() { |
  |  | 1486 | return slider.children.eq(slider.active.index); |
  |  | 1487 | }; |
  |  | 1488 |  |
  |  | 1489 | /\*\* |
  |  | 1490 | \* Returns a slide element |
  |  | 1491 | \* @param index (int) |
  |  | 1492 | \*  - The index (zero-based) of the element you want returned. |
  |  | 1493 | \*/ |
  |  | 1494 | el.getSlideElement = function(index) { |
  |  | 1495 | return slider.children.eq(index); |
  |  | 1496 | }; |
  |  | 1497 |  |
  |  | 1498 | /\*\* |
  |  | 1499 | \* Returns number of slides in show |
  |  | 1500 | \*/ |
  |  | 1501 | el.getSlideCount = function() { |
  |  | 1502 | return slider.children.length; |
  |  | 1503 | }; |
  |  | 1504 |  |
  |  | 1505 | /\*\* |
  |  | 1506 | \* Return slider.working variable |
  |  | 1507 | \*/ |
  |  | 1508 | el.isWorking = function() { |
  |  | 1509 | return slider.working; |
  |  | 1510 | }; |
  |  | 1511 |  |
  |  | 1512 | /\*\* |
  |  | 1513 | \* Update all dynamic slider elements |
  |  | 1514 | \*/ |
  |  | 1515 | el.redrawSlider = function() { |
  |  | 1516 | // resize all children in ratio to new screen size |
  |  | 1517 | slider.children.add(el.find('.bx-clone')).outerWidth(getSlideWidth()); |
  |  | 1518 | // adjust the height |
  |  | 1519 | slider.viewport.css('height', getViewportHeight()); |
  |  | 1520 | // update the slide position |
  |  | 1521 | if (!slider.settings.ticker) { setSlidePosition(); } |
  |  | 1522 | // if active.last was true before the screen resize, we want |
  |  | 1523 | // to keep it last no matter what screen size we end on |
  |  | 1524 | if (slider.active.last) { slider.active.index = getPagerQty() - 1; } |
  |  | 1525 | // if the active index (page) no longer exists due to the resize, simply set the index as last |
  |  | 1526 | if (slider.active.index >= getPagerQty()) { slider.active.last = true; } |
  |  | 1527 | // if a pager is being displayed and a custom pager is not being used, update it |
  |  | 1528 | if (slider.settings.pager && !slider.settings.pagerCustom) { |
  |  | 1529 | populatePager(); |
  |  | 1530 | updatePagerActive(slider.active.index); |
  |  | 1531 | } |
  |  | 1532 | if (slider.settings.ariaHidden) { applyAriaHiddenAttributes(slider.active.index \* getMoveBy()); } |
  |  | 1533 | }; |
  |  | 1534 |  |
  |  | 1535 | /\*\* |
  |  | 1536 | \* Destroy the current instance of the slider (revert everything back to original state) |
  |  | 1537 | \*/ |
  |  | 1538 | el.destroySlider = function() { |
  |  | 1539 | // don't do anything if slider has already been destroyed |
  |  | 1540 | if (!slider.initialized) { return; } |
  |  | 1541 | slider.initialized = false; |
  |  | 1542 | $('.bx-clone', this).remove(); |
  |  | 1543 | slider.children.each(function() { |
  |  | 1544 | if ($(this).data('origStyle') !== undefined) { |
  |  | 1545 | $(this).attr('style', $(this).data('origStyle')); |
  |  | 1546 | } else { |
  |  | 1547 | $(this).removeAttr('style'); |
  |  | 1548 | } |
  |  | 1549 | }); |
  |  | 1550 | if ($(this).data('origStyle') !== undefined) { |
  |  | 1551 | this.attr('style', $(this).data('origStyle')); |
  |  | 1552 | } else { |
  |  | 1553 | $(this).removeAttr('style'); |
  |  | 1554 | } |
  |  | 1555 | $(this).unwrap().unwrap(); |
  |  | 1556 | if (slider.controls.el) { slider.controls.el.remove(); } |
  |  | 1557 | if (slider.controls.next) { slider.controls.next.remove(); } |
  |  | 1558 | if (slider.controls.prev) { slider.controls.prev.remove(); } |
  |  | 1559 | if (slider.pagerEl && slider.settings.controls && !slider.settings.pagerCustom) { slider.pagerEl.remove(); } |
  |  | 1560 | $('.bx-caption', this).remove(); |
  |  | 1561 | if (slider.controls.autoEl) { slider.controls.autoEl.remove(); } |
  |  | 1562 | clearInterval(slider.interval); |
  |  | 1563 | if (slider.settings.responsive) { $(window).unbind('resize', resizeWindow); } |
  |  | 1564 | if (slider.settings.keyboardEnabled) { $(document).unbind('keydown', keyPress); } |
  |  | 1565 | //remove self reference in data |
  |  | 1566 | $(this).removeData('bxSlider'); |
  |  | 1567 | }; |
  |  | 1568 |  |
  |  | 1569 | /\*\* |
  |  | 1570 | \* Reload the slider (revert all DOM changes, and re-initialize) |
  |  | 1571 | \*/ |
  |  | 1572 | el.reloadSlider = function(settings) { |
  |  | 1573 | if (settings !== undefined) { options = settings; } |
  |  | 1574 | el.destroySlider(); |
  |  | 1575 | init(); |
  |  | 1576 | //store reference to self in order to access public functions later |
  |  | 1577 | $(el).data('bxSlider', this); |
  |  | 1578 | }; |
  |  | 1579 |  |
  |  | 1580 | init(); |
  |  | 1581 |  |
  |  | 1582 | $(el).data('bxSlider', this); |
  |  | 1583 |  |
  |  | 1584 | // returns the current jQuery object |
  |  | 1585 | return this; |
  |  | 1586 | }; |
  | 1322 | 1587 |  |
  | 1323 | 1588 | })(jQuery); |
* ## [circle-image-slider-with-lightbox/trunk/readme.txt](/changeset/1269993/circle-image-slider-with-lightbox/trunk/readme.txt "Show the changeset 1269993 restricted to circle-image-slider-with-lightbox/trunk/readme.txt")

  | [r1226699](/browser/circle-image-slider-with-lightbox/trunk/readme.txt?rev=1226699#L4 "Show revision 1226699 of this file in browser") | [r1269993](/browser/circle-image-slider-with-lightbox/trunk/readme.txt?rev=1269993#L4 "Show revision 1269993 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Donate link:http://www.i13websolution.com/donate-wordpress\_image\_thumbnail.php |
  | 5 | 5 | Tags:wordpress circle slider lightbox,wordpress circle slider,wordpress rounded image,wordpress circle gallery,wordpress circle gallery slider,wordpress google like rounded image |
  | 6 |  | Requires at least:3.~~0~~ |
  |  | 6 | Requires at least:3.5 |
  | 7 | 7 | Tested up to:4.3 |
  | 8 | 8 | Version:1.0 |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=1269993)
* [Zip Archive](?format=zip&new=1269993)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

