=== Content from github.com_bdd42b32_20250111_092306.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHankJames%2FVul-Reports%2Fblob%2Fmain%2FFirmwareLeakage%2Fcom.ivyiot.IvySmart%2Fcom.ivyiot.IvySmart.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FHankJames%2FVul-Reports%2Fblob%2Fmain%2FFirmwareLeakage%2Fcom.ivyiot.IvySmart%2Fcom.ivyiot.IvySmart.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=HankJames%2FVul-Reports)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[HankJames](/HankJames)
/
**[Vul-Reports](/HankJames/Vul-Reports)**
Public

* [Notifications](/login?return_to=%2FHankJames%2FVul-Reports) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FHankJames%2FVul-Reports)
* [Star
   1](/login?return_to=%2FHankJames%2FVul-Reports)

* [Code](/HankJames/Vul-Reports)
* [Issues
  0](/HankJames/Vul-Reports/issues)
* [Pull requests
  0](/HankJames/Vul-Reports/pulls)
* [Actions](/HankJames/Vul-Reports/actions)
* [Projects
  0](/HankJames/Vul-Reports/projects)
* [Security](/HankJames/Vul-Reports/security)
* [Insights](/HankJames/Vul-Reports/pulse)

Additional navigation options

* [Code](/HankJames/Vul-Reports)
* [Issues](/HankJames/Vul-Reports/issues)
* [Pull requests](/HankJames/Vul-Reports/pulls)
* [Actions](/HankJames/Vul-Reports/actions)
* [Projects](/HankJames/Vul-Reports/projects)
* [Security](/HankJames/Vul-Reports/security)
* [Insights](/HankJames/Vul-Reports/pulse)

## Files

 main
## Breadcrumbs

1. [Vul-Reports](/HankJames/Vul-Reports/tree/main)
2. /[FirmwareLeakage](/HankJames/Vul-Reports/tree/main/FirmwareLeakage)
3. /[com.ivyiot.IvySmart](/HankJames/Vul-Reports/tree/main/FirmwareLeakage/com.ivyiot.IvySmart)
/
# com.ivyiot.IvySmart.md

Copy path Blame  Blame
## Latest commit

## History

[History](/HankJames/Vul-Reports/commits/main/FirmwareLeakage/com.ivyiot.IvySmart/com.ivyiot.IvySmart.md)53 lines (32 loc) · 4.86 KB main
## Breadcrumbs

1. [Vul-Reports](/HankJames/Vul-Reports/tree/main)
2. /[FirmwareLeakage](/HankJames/Vul-Reports/tree/main/FirmwareLeakage)
3. /[com.ivyiot.IvySmart](/HankJames/Vul-Reports/tree/main/FirmwareLeakage/com.ivyiot.IvySmart)
/
# com.ivyiot.IvySmart.md

Top
## File metadata and controls

* Preview
* Code
* Blame

53 lines (32 loc) · 4.86 KB[Raw](https://github.com/HankJames/Vul-Reports/raw/refs/heads/main/FirmwareLeakage/com.ivyiot.IvySmart/com.ivyiot.IvySmart.md)
### Vulnerability Report

**Product:** **com.ivyiot.IvySmart**

**Vendor:** **IVY Smart**

**Version:** **v4.5.0**

**Vulnerability Type: Incorrect Access Control**

**Severity:** **High**

---

1.**Project Description**

IVY Smart v4.5.0 is an application designed to work with cameras for quick monitoring, historical playback, and wireless security monitoring. The software allows remote connection and configuration of device parameters and supports two-way voice intercom, video playback, and other functionalities.

2.**Vulnerability Description**

Due to the lack of user identity verification mechanisms in the IVY Smart v4.5.0 app, attackers can exploit leaked information from the APK file along with the ID of a real physical device. By combining this with any user ID, they can successfully download the firmware. Specifically, the absence of authentication during the firmware update and download processes allows potential attackers to analyze the APK file's code and data. They can locate methods or classes in the app related to firmware updates and utilize related network request APIs to obtain complete firmware associated with the app without authorization. This poses serious security risks, as attackers can analyze the firmware to extract potentially sensitive data, such as passwords, encryption keys, and configuration files. If leaked, such data could lead to system compromise. Furthermore, attackers could gain access to the firmware source code, modify it, and thereby obtain full control over the device.

3.**Vulnerability Reproduction**

Manual analysis of the APK file using tools like jadx helped identify methods or classes in the app related to firmware updates. By utilizing relevant APIs from files such as AuthIOTFirmwareUpdateEntity.java, information needed for constructing a firmware update network request was obtained, as shown in Figure 2.

[![](https://camo.githubusercontent.com/c7dab5201068aed44a981a9029078b0f93bc63322c1cd8620bcc8da73eac3c2a/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f36755057376832444d4563336267552e706e67)](https://camo.githubusercontent.com/c7dab5201068aed44a981a9029078b0f93bc63322c1cd8620bcc8da73eac3c2a/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f36755057376832444d4563336267552e706e67)

[![](https://camo.githubusercontent.com/f4432a738f29525c861500bc43a3c299050964d05db8d4c0e9a41ef58f2ad526/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f6a6173326776754f7057744b4446332e706e67)](https://camo.githubusercontent.com/f4432a738f29525c861500bc43a3c299050964d05db8d4c0e9a41ef58f2ad526/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f6a6173326776754f7057744b4446332e706e67)

Further extraction and analysis of this information revealed that when requesting firmware updates, the app requires a physical device ID, openid, accessToken, and clientid. By combining this information with findings from the APK file analysis, URLs related to firmware updates or downloads for the current app can be obtained, allowing unauthorized access to the app's firmware.
The physical device ID was acquired by purchasing a real hardware device, specifically the "E3P Video Call Camera," model IPC-D11/WIFI. To ensure compatibility with the app, it was chosen based on its product parameters for "Aiwei IoT," as shown in Figure 3. This successfully retrieved the physical device ID: IC264C52UV2B52463ZZZCJB, illustrated in Figure 4.

[![](https://camo.githubusercontent.com/a51356884fe1efd943435b05c86dfc13e0ee9229d050d912b407c3b2e84469bf/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f78346e66576741334b6a79424f55462e706e67)](https://camo.githubusercontent.com/a51356884fe1efd943435b05c86dfc13e0ee9229d050d912b407c3b2e84469bf/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f78346e66576741334b6a79424f55462e706e67)

[![](https://camo.githubusercontent.com/013802ea88be0b5342dbabef6683de5fcfd8bade6c23475f190383570a660d6a/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f654263716278316e644676484b77442e706e67)](https://camo.githubusercontent.com/013802ea88be0b5342dbabef6683de5fcfd8bade6c23475f190383570a660d6a/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f654263716278316e644676484b77442e706e67)

Openid, accessToken, and clientid can be captured by downloading the app on a mobile testing device, registering an account, and using Canary for packet capture, as shown in Figure 5. Multiple accounts were registered, and packet captures were performed to obtain several valid pieces of information.

[![](https://camo.githubusercontent.com/440213b7a9fa830e0243c0d4376e86e339cfeafa6c412b4c45f49828ebdca0f1/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f4e4b764731644c72576c61783456672e706e67)](https://camo.githubusercontent.com/440213b7a9fa830e0243c0d4376e86e339cfeafa6c412b4c45f49828ebdca0f1/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f4e4b764731644c72576c61783456672e706e67)

With the information obtained, a firmware update network request can be constructed using the known physical device ID and arbitrary user information, allowing firmware download from relevant websites, as shown in Figure 6. This demonstrates that the app's website lacks a user identity verification mechanism, leading to firmware leakage, allowing potential attackers to successfully obtain firmware without authorization.
[![](https://camo.githubusercontent.com/78db179038cfaa4bfe0246849699dd4ba3736391087537109e4996527b85df75/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f6a47534961466743765a58694c32482e706e67)](https://camo.githubusercontent.com/78db179038cfaa4bfe0246849699dd4ba3736391087537109e4996527b85df75/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f6a47534961466743765a58694c32482e706e67)

Using the official URL, the firmware file 1767744531157409792.bin was successfully downloaded, as shown in Figure 7.

[![](https://camo.githubusercontent.com/58d7c8d7579f3a12736ea7f0f13f075850b05d49ba4938461d71ca0fd6780f83/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f676443477659694f4c5a75316f57792e706e67)](https://camo.githubusercontent.com/58d7c8d7579f3a12736ea7f0f13f075850b05d49ba4938461d71ca0fd6780f83/68747470733a2f2f73322e6c6f6c692e6e65742f323032342f31302f31372f676443477659694f4c5a75316f57792e706e67)

4.**Vulnerability Impact**

Due to the server's lack of necessary identity verification mechanisms, attackers can obtain complete firmware from the server. By analyzing the firmware, they may extract potentially sensitive data such as passwords, encryption keys, and configuration files. If leaked, this data could lead to system compromise, and attackers could gain access to the firmware source code, modify it, and thus achieve full control over the device.

5.**Remediation Suggestions**

Implement access control or authentication mechanisms for relevant functions.

Ensure that all requests undergo strict authentication and authorization checks on the server side. Only authorized users should be able to access firmware download links.

Validate firmware download requests by checking request sources, device IDs, user IDs, etc., to ensure that requests come from legitimate devices and users.

The server can dynamically generate firmware download links that have a short expiration time, rendering the links invalid after a set period to prevent abuse.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


