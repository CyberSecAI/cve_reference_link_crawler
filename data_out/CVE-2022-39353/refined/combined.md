=== Content from lists.debian.org_38c79a68_20250108_135315.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 3260-1] node-xmldom security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3260-1] node-xmldom security update
* *From*: Guilhem Moulin <guilhem@debian.org>
* *Date*: Sun, 1 Jan 2023 18:00:48 +0100
* *Message-id*: <[[üîé]](/msgid-search/Y7G8QM4FN8hHgh5B%40debian.org)¬†[Y7G8QM4FN8hHgh5B@debian.org](msg00000.html)>
* *Mail-followup-to*: Guilhem Moulin <guilhem@debian.org>, debian-lts-announce@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3260-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                       Guilhem Moulin
January 01, 2023                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : node-xmldom
Version        : 0.1.27+ds-1+deb10u2
CVE ID         : CVE-2021-21366 CVE-2022-39353
Debian Bug     : 1024736

It was discovered that node-xmldom, a standard XML DOM (Level2 CORE)
implementation in pure javascript, processed ill-formed XML, which may result in
bugs and security holes in downstream applications.

CVE-2021-21366

    xmldom versions 0.4.0 and older do not correctly preserve system
    identifiers, FPIs or namespaces when repeatedly parsing and serializing
    maliciously crafted documents.  This may lead to unexpected syntactic
    changes during XML processing in some downstream applications.

CVE-2022-39353

    Mark Gollnick discovered that xmldom parses XML that is not well-formed
    because it contains multiple top level elements, and adds all root nodes to
    the `childNodes` collection of the `Document`, without reporting or throwing
    any error.  This breaks the assumption that there is only a single root node
    in the tree, and may open security holes such as CVE-2022-39299 in
    downstream applications.

For Debian 10 buster, these problems have been fixed in version
0.1.27+ds-1+deb10u2.

We recommend that you upgrade your node-xmldom packages.

For the detailed security status of node-xmldom please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/node-xmldom>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpKFIQv7nBlJ.pgp)**

*Description:* PGP signature

---



=== Content from github.com_8e665e86_20250108_135315.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fsecurity%2Fadvisories%2FGHSA-crh6-fp67-6883)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxmldom%2Fxmldom%2Fsecurity%2Fadvisories%2FGHSA-crh6-fp67-6883)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=xmldom%2Fxmldom)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xmldom](/xmldom)
/
**[xmldom](/xmldom/xmldom)**
Public

* [Notifications](/login?return_to=%2Fxmldom%2Fxmldom) You must be signed in to change notification settings
* [Fork
  88](/login?return_to=%2Fxmldom%2Fxmldom)
* [Star
   370](/login?return_to=%2Fxmldom%2Fxmldom)

* [Code](/xmldom/xmldom)
* [Issues
  24](/xmldom/xmldom/issues)
* [Pull requests
  3](/xmldom/xmldom/pulls)
* [Discussions](/xmldom/xmldom/discussions)
* [Actions](/xmldom/xmldom/actions)
* [Projects
  1](/xmldom/xmldom/projects)
* [Security](/xmldom/xmldom/security)
* [Insights](/xmldom/xmldom/pulse)

Additional navigation options

* [Code](/xmldom/xmldom)
* [Issues](/xmldom/xmldom/issues)
* [Pull requests](/xmldom/xmldom/pulls)
* [Discussions](/xmldom/xmldom/discussions)
* [Actions](/xmldom/xmldom/actions)
* [Projects](/xmldom/xmldom/projects)
* [Security](/xmldom/xmldom/security)
* [Insights](/xmldom/xmldom/pulse)

# Allows multiple root elements in a DOM tree

Critical

[karfau](/karfau)
published
GHSA-crh6-fp67-6883
Oct 29, 2022

## Package

npm

@xmldom/xmldom
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<0.7.7
>=0.8.0, <0.8.4
>=0.9.0-beta.1, <0.9.0-beta.4

## Patched versions

~0.7.7
~0.8.4
>=0.9.0-beta.4

npm

xmldom
([npm](/advisories?query=ecosystem%3Anpm))

\*

None

## Description

### Impact

xmldom parses XML that is not well-formed because it contains multiple top level elements, and adds all root nodes to the `childNodes` collection of the `Document`, without reporting any error or throwing.

This breaks the assumption that there is only a single root node in the tree, which led to <https://nvd.nist.gov/vuln/detail/CVE-2022-39299> and is a potential issue for dependents.

### Patches

Update to `@xmldom/xmldom@~0.7.7`, `@xmldom/xmldom@~0.8.4` (dist-tag `latest`) or `@xmldom/xmldom@>=0.9.0-beta.4` (dist-tag `next`).

### Workarounds

One of the following approaches might help, depending on your use case:

* Instead of searching for elements in the whole DOM, only search in the `documentElement`.
* Reject a document with a document that has more then 1 `childNode`.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-39299>
* [jindw/xmldom#150](https://github.com/jindw/xmldom/issues/150)

### For more information

If you have any questions or comments about this advisory:

* Email us at security@xmldom.org

### Severity

Critical

### CVE ID

CVE-2022-39353

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20) [CWE-1288](/advisories?query=cwe%3A1288)

### Credits

* [![@frumioj](https://avatars.githubusercontent.com/u/5275?s=40&v=4)](/frumioj)
  [frumioj](/frumioj)
  Analyst
* [![@karfau](https://avatars.githubusercontent.com/u/135657?s=40&v=4)](/karfau)
  [karfau](/karfau)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_5d84870b_20250108_135314.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjindw%2Fxmldom%2Fissues%2F150)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjindw%2Fxmldom%2Fissues%2F150)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=jindw%2Fxmldom)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jindw](/jindw)
/
**[xmldom](/jindw/xmldom)**
Public

* [Notifications](/login?return_to=%2Fjindw%2Fxmldom) You must be signed in to change notification settings
* [Fork
  265](/login?return_to=%2Fjindw%2Fxmldom)
* [Star
   819](/login?return_to=%2Fjindw%2Fxmldom)

* [Code](/jindw/xmldom)
* [Issues
  93](/jindw/xmldom/issues)
* [Pull requests
  45](/jindw/xmldom/pulls)
* [Actions](/jindw/xmldom/actions)
* [Projects
  0](/jindw/xmldom/projects)
* [Wiki](/jindw/xmldom/wiki)
* [Security](/jindw/xmldom/security)
* [Insights](/jindw/xmldom/pulse)

Additional navigation options

* [Code](/jindw/xmldom)
* [Issues](/jindw/xmldom/issues)
* [Pull requests](/jindw/xmldom/pulls)
* [Actions](/jindw/xmldom/actions)
* [Projects](/jindw/xmldom/projects)
* [Wiki](/jindw/xmldom/wiki)
* [Security](/jindw/xmldom/security)
* [Insights](/jindw/xmldom/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjindw%2Fxmldom%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjindw%2Fxmldom%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Missing error for XML documents with multiple root element nodes #150

Open

[markgollnick](/markgollnick) opened this issue
Jan 20, 2016
¬∑ 8 comments

Open

# [Missing error for XML documents with multiple root element nodes](#top) #150

[markgollnick](/markgollnick) opened this issue
Jan 20, 2016
¬∑ 8 comments

## Comments

[![@markgollnick](https://avatars.githubusercontent.com/u/2095665?s=80&v=4)](/markgollnick)

Copy link

### **[markgollnick](/markgollnick)** commented [Jan 20, 2016](#issue-127575968)

| Bug Description: xmldom allows incoming documents to have multiple root element nodes. This appears to me to be a violation of the [W3C DOM Level 2 Core Specification](http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113/DOM2-Core.pdf):  [‚Ä¶] Each document contains zero or one doctype nodes, **one root element node,** and zero or more comments or processing instructions; the root element serves as the root of the element tree for the document. [‚Ä¶]  ‚Äî *from ‚ÄúWhat the Document Object Model is‚Äù (emphasis mine)*  **The root node is the unique node that is not a child of any other node.** All other nodes are children or other descendants of the root node.  ‚Äî *from the Glossary (emphasis mine)*  **However,** the spec *also* says this:  [‚Ä¶] However, **the DOM does not specify that documents must be implemented as a tree or a grove,** nor does it specify how the relationships among objects be implemented. **The DOM is a logical model that may be implemented in any convenient manner.** [‚Ä¶]  ‚Äî *from ‚ÄúWhat the Document Object Model is‚Äù (emphasis mine)*  The children of a `DocumentFragment` node are zero or more nodes representing the tops of any sub-trees defining the structure of the document. `DocumentFragment` nodes do not need to be *well-formed XML documents* (although they do need to follow the rules imposed upon **well-formed XML parsed entities, which can have multiple top nodes**). For example, a `DocumentFragment` might have only one child and that child node could be a `Text` node. Such a structure model represents neither an HTML document nor a well-formed XML document.  ‚Äî *from ¬ß 1.2 / Fundamental Interfaces / Interface DocumentFragment (emphasis mine)*  In light of this, for the record, **I actually don‚Äôt dislike the fact that xmldom can parse such documents.** This comes with a few reservations (outlined below) because it seems like the current behavior is contrary to what the specs (both W3C DOM Level 2 Core *and* [XML 1.1](https://www.w3.org/TR/2006/REC-xml11-20060816/#sec-well-formed)) assert ought to be the case. Bug Reproduction: The following code:  ``` var DOMParser = require('xmldom').DOMParser; var xmlData = '<?xml version="1.0" encoding="UTF-8"?>\n' + '<root>\n' + '  <branch girth="large">\n' + '    <leaf color="green" />\n' + '  </branch>\n' + '</root>\n' + '<root>\n' + '  <branch girth="twig">\n' + '    <leaf color="gold" />\n' + '  </branch>\n' + '</root>\n'; var xmlDOM = new DOMParser().parseFromString(xmlData); console.log(xmlDOM.toString()); ```  ‚Ä¶produces the following output:  ``` <?xml version="1.0" encoding="UTF-8"?><root>   <branch girth="large">     <leaf color="green"/>   </branch> </root> <root>   <branch girth="twig">     <leaf color="gold"/>   </branch> </root>  ```  In contrast to this, [libxmljs](https://www.npmjs.com/package/libxmljs) ‚Äî which relies on [libxml2](http://www.xmlsoft.org/) ‚Äî refuses to parse such documents, opting to throw an error instead:  ``` var xml = require('libxmljs'); var xmlDoc = xml.parseXmlString(xmlData); Error: Extra content at the end of the document ```  Firefox behaves in a similar way, and refuses to parse the document:  ``` console.log(   new XMLSerializer().serializeToString(     new DOMParser().parseFromString(xmlData, 'text/xml'))); ```  ``` <?xml version="1.0" encoding="UTF-8"?> <?xml-stylesheet href="chrome://global/locale/intl.css" type="text/css"?> <parsererror xmlns="http://www.mozilla.org/newlayout/xml/parsererror.xml">XML Parsing Error: junk after document element Location: about:blank Line Number 7, Column 1:<sourcetext>&lt;root&gt; ^</sourcetext></parsererror>  ```  Chrome goes a *little* bit farther in that it is at least willing to parse/render the first root element node:  ``` <?xml version="1.0" encoding="UTF-8"?> <root>   <parsererror xmlns="http://www.w3.org/1999/xhtml" style="display: block; white-space: pre; border: 2px solid #c77; padding: 0 1em 0 1em; margin: 1em; background-color: #fdd; color: black">     <h3>This page contains the following errors:</h3>     <div style="font-family:monospace;font-size:12px">error on line 7 at column 1: Extra content at the end of the document </div>     <h3>Below is a rendering of the page up to the first error.</h3>   </parsererror>   <branch girth="large">     <leaf color="green"/>   </branch> </root>  ``` Expectations/Recommendations/Discussion:  * I expected the above document to fail to parse in xmldom's DOMParser implementation, but it didn‚Äôt. In light of the specs, this seems like it might be a ‚Äúfalse-positive‚Äù bug. However, I think there *is* some utility in being able to parse multiple documents in a single stream, *if* the API can be re-tooled just a bit. More on this below. * In order to be more compliant with the specs, I think that if more than one root node is present in an XML stream ‚Äî especially if they appear without corresponding `<?xml?>` declarations ‚Äî then the DOMParser should, bare-minimum, simply opt to not support such streams, and should raise an error informing the consumer that the given XML stream is invalid. * **Alternatively,** if it is desired to keep the ability to parse multiple documents in a single stream ‚Äî which I think would be useful functionality to retain: the alternative of requiring users to manually split XML documents crammed into a single stream before they can pass them into xmldom seems counter-intuitive to me, as that should be the job of the parser ‚Äî then perhaps the DOMParser API could be re-tooled to return an *array* or a *list* of multiple document objects, each one with a singular root element node (rather than a *single* document object with *multiple root elements,* as is the case today), but *only in the event that multiple root elements are detected within the input stream.* I think that this behavior would help xmldom to be more compliant with the specs, *and* it would help to prevent consumers from accidentally generating poorly formed XML output from their parsed document objects, since each parsed document object would have only *one* root node, as the specs indicate ought to be the case.  Conclusion: On one hand, **I think it is a useful thing to be able to parse streams containing multiple XML documents.**  On the other hand, to do that silently without issuing even so much as a warning to consumers ‚Äî especially when the specs say that root nodes should be unique ‚Äî seems, well, odd. **It seems like the current behavior is more of an artifact or a side-effect of xmldom‚Äôs current architecture than it is an intentional aspect of its design,** hence my writing this up as a bug rather than a feature request. (If I‚Äôm mistaken, do let me know!) Environment/Versions:  * xmldom v0.1.21 |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
2
 shakaIsReal and itonics-tbeauvais reacted with thumbs up emoji
 üëé
1
 frumioj reacted with thumbs down emoji
 ‚ù§Ô∏è
1
 karfau reacted with heart emoji

All reactions

* üëç
  2 reactions
* üëé
  1 reaction
* ‚ù§Ô∏è
  1 reaction

[![@markgollnick](https://avatars.githubusercontent.com/u/2095665?s=80&v=4)](/markgollnick)

Copy link

Author

### **[markgollnick](/markgollnick)** commented [Jan 20, 2016](#issuecomment-173036847)

| Sorry if this has already been documented elsewhere. I searched around and didn‚Äôt see this behavior being discussed anywhere, so I figured I‚Äôd file it here and see where it went. |
| --- |

All reactions

Sorry, something went wrong.

[![@frumioj](https://avatars.githubusercontent.com/u/5275?s=80&u=4651c29cf170eaa5985f969267bb483df6dc1b95&v=4)](/frumioj)

Copy link

### **[frumioj](/frumioj)** commented [Oct 14, 2022](#issuecomment-1279059441)

| Ultimately responsible for this security bug: <https://nvd.nist.gov/vuln/detail/CVE-2022-39299> |
| --- |

All reactions

Sorry, something went wrong.

[frumioj](/frumioj)
referenced
this issue
in node-saml/passport-saml
[Oct 14, 2022](#ref-commit-8b7e3f5)
[![@cjbarth](https://avatars.githubusercontent.com/u/3049726?s=40&u=058d36b239e26b8c55a1eb1d8663707b03a37d66&v=4)](/cjbarth)

`[Merge pull request from](/node-saml/passport-saml/commit/8b7e3f5a91c8e5ac7e890a0c90bc7491ce33155e "Merge pull request from GHSA-m974-647v-whv7") [GHSA-m974-647v-whv7](https://github.com/advisories/GHSA-m974-647v-whv7 "GHSA-m974-647v-whv7")`

`[8b7e3f5](/node-saml/passport-saml/commit/8b7e3f5a91c8e5ac7e890a0c90bc7491ce33155e)`

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

### **[karfau](/karfau)** commented [Oct 14, 2022](#issuecomment-1279181569) ‚Ä¢ edited Loading

| [@frumioj](https://github.com/frumioj) xmldom is currently maintained at <https://github.com/xmldom/xmldom>. What would you suggest that we change in the behavior/implementation (as in what should be the preferred behavior in the context of the issue you linked, what assumption was made, which xmldom didn't fulfill)? Feel free to involve/ping me in an already ongoing discussions elsewhere or to kick off the process following our [security policy](https://github.com/xmldom/xmldom/security/policy). Thx for the information. |
| --- |

All reactions

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

### **[karfau](/karfau)** commented [Oct 29, 2022](#issuecomment-1295997271)

| Fixes have been provided for `@xmldom/xmldom` in the versions 0.7.7, 0.8.4 and 0.9.0-beta.4. For more details see [GHSA-crh6-fp67-6883](https://github.com/xmldom/xmldom/security/advisories/GHSA-crh6-fp67-6883 "GHSA-crh6-fp67-6883") |
| --- |

 üëç
1
 raggzy271 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@MahmoudNafiseh](https://avatars.githubusercontent.com/u/77212063?s=40&v=4)](/MahmoudNafiseh)
[MahmoudNafiseh](/MahmoudNafiseh)
mentioned this issue
[Nov 1, 2022](#ref-pullrequest-1432126626)

[update @xmldom/xmldom package
expo/expo-cli#4585](/expo/expo-cli/pull/4585)
 Closed

[![@alxndrstffn](https://avatars.githubusercontent.com/u/4272481?s=40&v=4)](/alxndrstffn)
[alxndrstffn](/alxndrstffn)
mentioned this issue
[Nov 2, 2022](#ref-issue-1432875183)

[Upgrade to xmldom 0.8.5 (CVE-2022-39299)
mswjs/interceptors#296](/mswjs/interceptors/issues/296)

Closed

[![@alvaldes](https://avatars.githubusercontent.com/u/44712690?s=40&v=4)](/alvaldes)
[alvaldes](/alvaldes)
mentioned this issue
[Nov 3, 2022](#ref-issue-1434980920)

[Dependency Error: xmldom allows multiple root nodes in a DOM
Sesame-Disk/cool-storage-microfrontend#39](/Sesame-Disk/cool-storage-microfrontend/issues/39)

Open

[![@meganwalker-ibm](https://avatars.githubusercontent.com/u/20321922?s=80&u=8216a05941cc95100557be15451aa88490933efa&v=4)](/meganwalker-ibm)

Copy link

### **[meganwalker-ibm](/meganwalker-ibm)** commented [Nov 14, 2022](#issuecomment-1313909285)

| [GHSA-crh6-fp67-6883](https://github.com/xmldom/xmldom/security/advisories/GHSA-crh6-fp67-6883 "GHSA-crh6-fp67-6883") notes that 0.7.7 is both affected and fixed. Can the impacted version ranges be clarified? Affected versions: <=0.7.7 Patched versions: ~0.7.7  I guess that should probably be < not <=? |
| --- |

 üëç
1
 karfau reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@karfau](https://avatars.githubusercontent.com/u/135657?s=80&v=4)](/karfau)

Copy link

### **[karfau](/karfau)** commented [Nov 14, 2022](#issuecomment-1313943006) ‚Ä¢ edited Loading

| Thank you for letting me know, you guessed correctly, I fixed it. |
| --- |

All reactions

Sorry, something went wrong.

[![@adityamohta](https://avatars.githubusercontent.com/u/17517214?s=40&v=4)](/adityamohta)
[adityamohta](/adityamohta)
mentioned this issue
[Dec 2, 2022](#ref-issue-1472419552)

[[Security Issue] xmldom allows multiple root nodes in a DOM
mswjs/interceptors#314](/mswjs/interceptors/issues/314)

Closed

[![@pollyoaks](https://avatars.githubusercontent.com/u/802416?s=40&v=4)](/pollyoaks)
[pollyoaks](/pollyoaks)
mentioned this issue
[Dec 8, 2022](#ref-issue-1485540315)

[Bump dependency on interceptors
mswjs/msw#1493](/mswjs/msw/issues/1493)

Closed

1 task

[![@ffcd00](https://avatars.githubusercontent.com/u/47581761?s=40&v=4)](/ffcd00)
[ffcd00](/ffcd00)
mentioned this issue
[Mar 15, 2023](#ref-issue-1625507491)

[[CVE-2022-39353] Vulnerability in xmldom-instawork
Instawork/hyperview#520](/Instawork/hyperview/issues/520)

Closed

[![@nshimiye](https://avatars.githubusercontent.com/u/2660614?s=80&u=f342d92faf234bdd13f72bb154eaf6bc2206ed7a&v=4)](/nshimiye)

Copy link

### **[nshimiye](/nshimiye)** commented [Jun 14, 2023](#issuecomment-1592076954) ‚Ä¢ edited Loading

| [@frumioj](https://github.com/frumioj) do you have any suggestion on how to reproduce the security issue? (like sample saml or code snippet)  Trying to understand how `xml-crypto`'s [checkSignature](https://github.com/node-saml/passport-saml/blob/8b7e3f5a91c8e5ac7e890a0c90bc7491ce33155e/src/node-saml/xml.ts#LL103C10-L103C28) function would return true if it is given a bad/malformed xml  Asking this here because it looks like the root cause I'm also asking just for curiosity! |
| --- |

All reactions

Sorry, something went wrong.

[![@frumioj](https://avatars.githubusercontent.com/u/5275?s=80&u=4651c29cf170eaa5985f969267bb483df6dc1b95&v=4)](/frumioj)

Copy link

### **[frumioj](/frumioj)** commented [Jun 15, 2023](#issuecomment-1593849755) ‚Ä¢ edited Loading

| [@frumioj](https://github.com/frumioj) do you have any suggestion on how to reproduce the security issue? (like sample saml or code snippet)  Trying to understand how `xml-crypto`'s [checkSignature](https://github.com/node-saml/passport-saml/blob/8b7e3f5a91c8e5ac7e890a0c90bc7491ce33155e/src/node-saml/xml.ts#LL103C10-L103C28) function would return true if it is given a bad/malformed xml  Asking this here because it looks like the root cause I'm also asking just for curiosity!  [#150](https://github.com/jindw/xmldom/issues/150) is where this issue was raised from. Multiple root elements were parsed. Because the SAML specification expects only one root element (because that's what is expected from well-formed XML from the parse tree) this caused a successful injection of an attacker's signature. If you correctly follow the XML specification there should only be one root element in an XML document, and multiple root elements should produce an error from the XML parser. That would have prevented the ability for an attacker to inject a valid signature into the XML. |
| --- |

 üëç
1
 nshimiye reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[eventualbuddha](/eventualbuddha)
added a commit
to votingworks/vxsuite
that referenced
this issue
[Oct 10, 2023](#ref-commit-5b28b30)
[![@eventualbuddha](https://avatars.githubusercontent.com/u/1938?s=40&v=4)](/eventualbuddha)

`[fix(deps): upgrade xmldom](/votingworks/vxsuite/commit/5b28b308246e5bae0c26638fc9fa7752c61cc9ea "fix(deps): upgrade `xmldom`

See https://github.com/jindw/xmldom/issues/150.")`
‚Ä¶

`[5b28b30](/votingworks/vxsuite/commit/5b28b308246e5bae0c26638fc9fa7752c61cc9ea)`

```
See [jindw/xmldom#150](https://github.com/jindw/xmldom/issues/150).
```

[![@eventualbuddha](https://avatars.githubusercontent.com/u/1938?s=40&v=4)](/eventualbuddha)
[eventualbuddha](/eventualbuddha)
mentioned this issue
[Oct 10, 2023](#ref-pullrequest-1936432412)

[fix(deps): upgrade `xmldom`
votingworks/vxsuite#4065](/votingworks/vxsuite/pull/4065)
 Merged

[eventualbuddha](/eventualbuddha)
added a commit
to votingworks/vxsuite
that referenced
this issue
[Oct 11, 2023](#ref-commit-1e9f459)
[![@eventualbuddha](https://avatars.githubusercontent.com/u/1938?s=40&v=4)](/eventualbuddha)

`[fix(deps): upgrade](/votingworks/vxsuite/commit/1e9f459252124987493968da6cb2944d569d311f "fix(deps): upgrade `xmldom` (#4065)

See https://github.com/jindw/xmldom/issues/150.") [xmldom](/votingworks/vxsuite/commit/1e9f459252124987493968da6cb2944d569d311f "fix(deps): upgrade `xmldom` (#4065)

See https://github.com/jindw/xmldom/issues/150.") [(](/votingworks/vxsuite/commit/1e9f459252124987493968da6cb2944d569d311f "fix(deps): upgrade `xmldom` (#4065)

See https://github.com/jindw/xmldom/issues/150.")[#4065](https://github.com/votingworks/vxsuite/pull/4065)[)](/votingworks/vxsuite/commit/1e9f459252124987493968da6cb2944d569d311f "fix(deps): upgrade `xmldom` (#4065)

See https://github.com/jindw/xmldom/issues/150.")`
‚Ä¶

`[1e9f459](/votingworks/vxsuite/commit/1e9f459252124987493968da6cb2944d569d311f)`

```
See [jindw/xmldom#150](https://github.com/jindw/xmldom/issues/150).
```

[eventualbuddha](/eventualbuddha)
added a commit
to votingworks/vxsuite
that referenced
this issue
[Oct 11, 2023](#ref-commit-aa54148)
[![@eventualbuddha](https://avatars.githubusercontent.com/u/1938?s=40&v=4)](/eventualbuddha)

`[chore(deps): remove some unused CRA deps (](/votingworks/vxsuite/commit/aa54148f541f183b1850a62b9375c131853b2f34 "chore(deps): remove some unused CRA deps (#4066)

* fix(deps): upgrade `xmldom`

See https://github.com/jindw/xmldom/issues/150.

* chore(deps): remove some unused CRA deps

- we don't use `webpack`, so no `-loader`s are needed
- we don't use `postcss` except for `postcss-styled-syntax`
- we don't use `ts-pnp`, so we can remove that dependency and the config files
- we use `react-refresh` through `@vitejs/plugin-react`, so we don't need to depend on it directly")[#4066](https://github.com/votingworks/vxsuite/pull/4066)[)](/votingworks/vxsuite/commit/aa54148f541f183b1850a62b9375c131853b2f34 "chore(deps): remove some unused CRA deps (#4066)

* fix(deps): upgrade `xmldom`

See https://github.com/jindw/xmldom/issues/150.

* chore(deps): remove some unused CRA deps

- we don't use `webpack`, so no `-loader`s are needed
- we don't use `postcss` except for `postcss-styled-syntax`
- we don't use `ts-pnp`, so we can remove that dependency and the config files
- we use `react-refresh` through `@vitejs/plugin-react`, so we don't need to depend on it directly")`
‚Ä¶

`[aa54148](/votingworks/vxsuite/commit/aa54148f541f183b1850a62b9375c131853b2f34)`

```
* fix(deps): upgrade `xmldom`

See [jindw/xmldom#150](https://github.com/jindw/xmldom/issues/150).

* chore(deps): remove some unused CRA deps

- we don't use `webpack`, so no `-loader`s are needed
- we don't use `postcss` except for `postcss-styled-syntax`
- we don't use `ts-pnp`, so we can remove that dependency and the config files
- we use `react-refresh` through `@vitejs/plugin-react`, so we don't need to depend on it directly
```

[![@david-nikolai-mueller](https://avatars.githubusercontent.com/u/127196698?s=40&v=4)](/david-nikolai-mueller)
[david-nikolai-mueller](/david-nikolai-mueller)
mentioned this issue
[Jun 3, 2024](#ref-issue-2330784112)

[CVE-2022-39353
dbashford/textract#239](/dbashford/textract/issues/239)

Open

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
mentioned this issue
[Sep 9, 2024](#ref-issue-2513941777)

[Upgrade xmldom | Critical security issue detected by dependabot
voltrue2/in-app-purchase#370](/voltrue2/in-app-purchase/issues/370)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fjindw%2Fxmldom%2Fissues%2F150)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

5 participants

[![@frumioj](https://avatars.githubusercontent.com/u/5275?s=52&v=4)](/frumioj) [![@karfau](https://avatars.githubusercontent.com/u/135657?s=52&v=4)](/karfau) [![@markgollnick](https://avatars.githubusercontent.com/u/2095665?s=52&v=4)](/markgollnick) [![@nshimiye](https://avatars.githubusercontent.com/u/2660614?s=52&v=4)](/nshimiye) [![@meganwalker-ibm](https://avatars.githubusercontent.com/u/20321922?s=52&v=4)](/meganwalker-ibm)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


