The provided content relates to CVE-2021-47043.

**Root Cause of Vulnerability:**
The vulnerability is caused by a resource leak in the error path of the `venus_probe()` function in the Linux kernel driver for the Qualcomm Venus video processing unit. The driver uses `of_icc_get()` to obtain interconnect paths, but if an error occurs after a successful call to `of_icc_get()`, the acquired resource is not released, leading to a leak.

**Weaknesses/Vulnerabilities Present:**
- Resource leak in the `venus_probe()` function's error handling path. Specifically, the interconnect paths obtained using `of_icc_get()` are not released if a subsequent step in the probe function fails.
- Use of `of_icc_get()` which requires manual resource release on error paths.

**Impact of Exploitation:**
- Resource exhaustion due to unreleased interconnect paths, potentially leading to instability or denial of service.

**Attack Vectors:**
- Triggering the error path in `venus_probe()`, which can happen if any of the subsequent initialization steps fail. This could be done via malformed input or system manipulation that causes device probe to fail.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to interact with the Venus driver or manipulate the system in a way that causes the `venus_probe` function to fail after successfully obtaining interconnect paths using `of_icc_get()`.
- This vulnerability is not directly exploitable from a remote position, it is a local denial of service vulnerability.

**Technical Details:**
The fix replaces `of_icc_get()` with `devm_of_icc_get()`, a managed resource allocation function which automatically releases resources on error, thus avoiding the leak. It also removes the manual `icc_put()` calls in the `venus_remove` function because the resources are now managed.
The code changes are as follows:
```diff
--- a/drivers/media/platform/qcom/venus/core.c
+++ b/drivers/media/platform/qcom/venus/core.c
@@ -195,11 +195,11 @@
 static int venus_probe(struct platform_device *pdev)
 
 	if (IS_ERR(core->base))
 		return PTR_ERR(core->base);
-	core->video_path = of_icc_get(dev, "video-mem");
+	core->video_path = devm_of_icc_get(dev, "video-mem");
 	if (IS_ERR(core->video_path))
 		return PTR_ERR(core->video_path);
-	core->cpucfg_path = of_icc_get(dev, "cpu-cfg");
+	core->cpucfg_path = devm_of_icc_get(dev, "cpu-cfg");
 	if (IS_ERR(core->cpucfg_path))
 		return PTR_ERR(core->cpucfg_path);
 
@@ -334,9 +334,6 @@
 static int venus_remove(struct platform_device *pdev)
 {
 	hfi_destroy(core);
-	icc_put(core->video_path);
-	icc_put(core->cpucfg_path);
 	v4l2_device_unregister(&core->v4l2_dev);
 	mutex_destroy(&core->pm_lock);
 	mutex_destroy(&core->lock);
```
The vulnerability was fixed by replacing `of_icc_get()` with `devm_of_icc_get()`.