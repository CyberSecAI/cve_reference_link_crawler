- **Root cause of vulnerability:** The `%post` scriptlet in the `keylime-tpm_cert_store` package used `chown` to change the ownership of files and directories within `/var/lib/keylime` to the `keylime` user. This directory was writable by the `keylime` user, so an attacker with control over this directory could create symlinks that would cause the `chown` command to modify arbitrary files on the system.
- **Weaknesses/vulnerabilities present:**
    - **Uncontrolled path:** The `%post` scriptlet used `chown` on files and directories within `/var/lib/keylime`, a directory writable by the `keylime` user.
    - **Symlink following:** The `chown` command in the script followed symbolic links, allowing the `keylime` user to change the ownership of arbitrary files.
- **Impact of exploitation:** A local attacker with the privileges of the `keylime` user could escalate privileges to root by changing the ownership of arbitrary files on the system, such as `/etc/passwd`.
- **Attack vectors:** The attacker needs to have control over the `/var/lib/keylime` directory, which is writable by the `keylime` user. The attacker could create symlinks within this directory, which when processed by the package's post-install script, would cause `chown` to modify the ownership of the target of the symlink.
- **Required attacker capabilities/position:** The attacker needs to have local access to the system as the `keylime` user.