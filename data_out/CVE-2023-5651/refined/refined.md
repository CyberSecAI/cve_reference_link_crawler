The content is related to CVE-2023-5651.

**Root cause of vulnerability:** The WP Hotel Booking plugin lacks authorization and CSRF checks in its `tp_extra_package_remove` AJAX action. This allows any authenticated user to trigger the deletion of arbitrary posts, even if they do not have the required privileges.

**Weaknesses/vulnerabilities present:**
- Missing authorization checks: The plugin does not verify if the user performing the action has the necessary permissions to delete the specified post.
- Missing CSRF protection: The plugin does not implement CSRF (Cross-Site Request Forgery) protection, which could allow an attacker to trick a logged-in user into deleting a post.
- Insecure direct object reference: The plugin directly uses the `package_id` parameter from the request without proper validation that it is a package, allowing deletion of any post.

**Impact of exploitation:**
- Arbitrary post deletion: A user with subscriber-level privileges or higher can delete any post, including critical pages or content, potentially leading to data loss or disruption of the website.

**Attack vectors:**
- Network-based: The vulnerability can be exploited by sending a crafted HTTP POST request to the `/wp-admin/admin-ajax.php` endpoint.
- Web browser interaction: An attacker can achieve exploitation by injecting the Javascript code provided in the Proof of Concept on the user's browser.

**Required attacker capabilities/position:**
- The attacker needs to have a valid account on the target WordPress site, with at least subscriber privileges.
- The attacker needs to be able to send HTTP requests, either directly through tools or through a web browser, to the target WordPress site.