<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>LKML: Mark Brown: Applied "wcd9335: fix a incorrect use of kstrndup()" to the asoc tree</title><link href="/css/message.css" rel="stylesheet" type="text/css" /><link href="/css/wrap.css" rel="alternate stylesheet" type="text/css" title="wrap" /><link href="/css/nowrap.css" rel="stylesheet" type="text/css" title="nowrap" /><link href="/favicon.ico" rel="shortcut icon" /><script src="/js/simple-calendar.js" type="text/javascript"></script><script src="/js/styleswitcher.js" type="text/javascript"></script><link rel="alternate" type="application/rss+xml" title="lkml.org : last 100 messages" href="/rss.php" /><link rel="alternate" type="application/rss+xml" title="lkml.org : last messages by Mark Brown" href="/groupie.php?aid=" /><!--Matomo--><script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(["setDoNotTrack", true]);
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//m.lkml.org/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script><!--End Matomo Code--></head><body onload="es.jasper.simpleCalendar.init();" itemscope="itemscope" itemtype="http://schema.org/BlogPosting"><table border="0" cellpadding="0" cellspacing="0"><tr><td width="180" align="center"><a href="/"><img style="border:0;width:135px;height:32px" src="/images/toprowlk.gif" alt="lkml.org" /></a></td><td width="32">Â </td><td class="nb"><div><a class="nb" href="/lkml">
     [lkml]</a>
     Â 
<a class="nb" href="/lkml/2019">
     [2019]</a>
     Â 
<a class="nb" href="/lkml/2019/5">
     [May]</a>
     Â 
<a class="nb" href="/lkml/2019/5/29">
     [29]</a>
     Â 
<a class="nb" href="/lkml/last100">
     [last100]</a>
     Â 
<a href="/rss.php"><img src="/images/rss-or.gif" border="0" alt="RSS Feed" /></a></div><div>Views:
<a href="#" class="nowrap" onclick="setActiveStyleSheet('wrap');return false;">[wrap]</a><a href="#" class="wrap" onclick="setActiveStyleSheet('nowrap');return false;">[no wrap]</a>
Â 
<a class="nb" href="/lkml/mheaders/2019/5/29/705" onclick="this.href='/lkml/headers'+'/2019/5/29/705';">[headers]</a>Â 
<a href="/lkml/bounce/2019/5/29/705">[forward]</a>Â 
    </div></td><td width="32">Â </td></tr><tr><td valign="top"><div class="es-jasper-simpleCalendar" baseurl="/lkml/"></div><div class="threadlist">Messages in this thread</div><ul class="threadlist"><li class="root"><a href="/lkml/2019/5/28/1145">First message in thread</a></li><li><a href="/lkml/2019/5/28/1145">Gen Zhang</a><ul><li class="origin"><a href="">Mark Brown</a></li><li><a href="/lkml/2019/6/5/13">Jiri Slaby</a><ul><li><a href="/lkml/2019/6/18/1126">Tyler Hicks</a></li></ul></li></ul></li></ul><div class="threadlist">Patch in this message</div><ul class="threadlist"><li><a href="/lkml/diff/2019/5/29/705/1">Get diff 1</a></li></ul></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerl.gif" width="32" height="32" alt="/" /></td><td class="c" rowspan="2" valign="top" style="padding-top: 1em"><table><tr><td><table><tr><td class="lp">From</td><td class="rp" itemprop="author">Mark Brown &lt;&gt;</td></tr><tr><td class="lp">Subject</td><td class="rp" itemprop="name">Applied "wcd9335: fix a incorrect use of kstrndup()" to the asoc tree</td></tr><tr><td class="lp">Date</td><td class="rp" itemprop="datePublished">Wed, 29 May 2019 16:45:29 +0100 (BST)</td></tr></table></td><td></td></tr></table><pre itemprop="articleBody">The patch<br /><br />   wcd9335: fix a incorrect use of kstrndup()<br /><br />has been applied to the asoc tree at<br /><br />   <a href="https://git.kernel.org/pub/scm/linux/kernel/git/broonie/sound.git">https://git.kernel.org/pub/scm/linux/kernel/git/broonie/sound.git</a> for-5.3<br /><br />All being well this means that it will be integrated into the linux-next<br />tree (usually sometime in the next 24 hours) and sent to Linus during<br />the next merge window (or sooner if it is a bug fix), however if<br />problems are discovered then the patch may be dropped or reverted.  <br /><br />You may get further e-mails resulting from automated or manual testing<br />and review of the tree, please engage with people reporting problems and<br />send followup patches addressing any issues that are reported if needed.<br /><br />If any updates are required or you are submitting further changes they<br />should be sent as incremental updates against current git, existing<br />patches will not be replaced.<br /><br />Please add any relevant lists and maintainers to the CCs when replying<br />to this mail.<br /><br />Thanks,<br />Mark<br /><br />From a54988113985ca22e414e132054f234fc8a92604 Mon Sep 17 00:00:00 2001<br />From: Gen Zhang &lt;blackgod016574&#64;gmail.com&gt;<br />Date: Wed, 29 May 2019 09:53:05 +0800<br />Subject: [PATCH] wcd9335: fix a incorrect use of kstrndup()<br /><br />In wcd9335_codec_enable_dec(), 'widget_name' is allocated by kstrndup().<br />However, according to doc: "Note: Use kmemdup_nul() instead if the size<br />is known exactly." So we should use kmemdup_nul() here instead of<br />kstrndup().<br /><br />Signed-off-by: Gen Zhang &lt;blackgod016574&#64;gmail.com&gt;<br />Signed-off-by: Mark Brown &lt;broonie&#64;kernel.org&gt;<br />---<br /> sound/soc/codecs/wcd9335.c | 2 +-<br /> 1 file changed, 1 insertion(+), 1 deletion(-)<br /><br />diff --git a/sound/soc/codecs/wcd9335.c b/sound/soc/codecs/wcd9335.c<br />index a04a7cedd99d..85737fe54474 100644<br />--- a/sound/soc/codecs/wcd9335.c<br />+++ b/sound/soc/codecs/wcd9335.c<br />&#64;&#64; -2734,7 +2734,7 &#64;&#64; static int wcd9335_codec_enable_dec(struct snd_soc_dapm_widget *w,<br /> 	char *dec;<br /> 	u8 hpf_coff_freq;<br /> <br />-	widget_name = kstrndup(w-&gt;name, 15, GFP_KERNEL);<br />+	widget_name = kmemdup_nul(w-&gt;name, 15, GFP_KERNEL);<br /> 	if (!widget_name)<br /> 		return -ENOMEM;<br /> <br />-- <br />2.20.1<br /></pre></td><td width="32" rowspan="2" class="c" valign="top"><img src="/images/icornerr.gif" width="32" height="32" alt="\" /></td></tr><tr><td align="right" valign="bottom">
 Â 
 </td></tr><tr><td align="right" valign="bottom">Â </td><td class="c" valign="bottom" style="padding-bottom: 0px"><img src="/images/bcornerl.gif" width="32" height="32" alt="\" /></td><td class="c">Â </td><td class="c" valign="bottom" style="padding-bottom: 0px"><img src="/images/bcornerr.gif" width="32" height="32" alt="/" /></td></tr><tr><td align="right" valign="top" colspan="2">
Â 
</td><td class="lm">Last update: 2019-05-29 17:45 Â Â  [from the cache]<br />Â©2003-2020 <a href="http://blog.jasper.es/"><span itemprop="editor">Jasper Spaans</span></a>|hosted at <a href="https://www.digitalocean.com/?refcode=9a8e99d24cf9">Digital Ocean</a> and my Meterkast|<a href="http://blog.jasper.es/categories.html#lkml-ref">Read the blog</a></td><td>Â </td></tr></table><script language="javascript" src="/js/styleswitcher.js" type="text/javascript"></script></body></html>