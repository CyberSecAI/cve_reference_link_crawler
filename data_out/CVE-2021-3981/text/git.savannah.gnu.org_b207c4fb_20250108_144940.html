

| [cgit logo](/cgit/) | [index](/cgit/) : [grub.git](/cgit/grub.git/ "grub.git") | andrey/ext4\_inline\_data arm\_coreboot grub-legacy leiflindholm/arm64 master master-bad-anon-commit multiboot multiboot2 next peter/devmapper pfsmorigo/no-libgcc pfsmorigo/vlantag phcoder/arm phcoder/arrows phcoder/brltty phcoder/c3 phcoder/efi\_compression phcoder/file\_types phcoder/filesize phcoder/gnuroot phcoder/greffs phcoder/newports/s390 phcoder/ports/alpha phcoder/rotate phcoder/scratch phcoder/termux phcoder/verifiers phcoder/xenfixes |
| --- | --- | --- |
| GNU GRUB |  |

| [summary](/cgit/grub.git/)[refs](/cgit/grub.git/refs/?id=0adec29674561034771c13e446069b41ef41e4d4)[log](/cgit/grub.git/log/)[tree](/cgit/grub.git/tree/?id=0adec29674561034771c13e446069b41ef41e4d4)[commit](/cgit/grub.git/commit/?id=0adec29674561034771c13e446069b41ef41e4d4)[diff](/cgit/grub.git/diff/?id=0adec29674561034771c13e446069b41ef41e4d4) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Michael Chang <mchang@suse.com> | 2021-12-03 16:13:28 +0800 |
| --- | --- | --- |
| committer | Daniel Kiper <daniel.kiper@oracle.com> | 2021-12-23 01:43:59 +0100 |
| commit | [0adec29674561034771c13e446069b41ef41e4d4](/cgit/grub.git/commit/?id=0adec29674561034771c13e446069b41ef41e4d4) ([patch](/cgit/grub.git/patch/?id=0adec29674561034771c13e446069b41ef41e4d4)) | |
| tree | [6d8c8252496870713c20d5ed02e17f598ac052ae](/cgit/grub.git/tree/?id=0adec29674561034771c13e446069b41ef41e4d4) | |
| parent | [d0219bffc7c463d313a4481872286fc65fc73a9b](/cgit/grub.git/commit/?id=d0219bffc7c463d313a4481872286fc65fc73a9b) ([diff](/cgit/grub.git/diff/?id=0adec29674561034771c13e446069b41ef41e4d4&id2=d0219bffc7c463d313a4481872286fc65fc73a9b)) | |
| download | [grub-0adec29674561034771c13e446069b41ef41e4d4.tar.gz](/cgit/grub.git/snapshot/grub-0adec29674561034771c13e446069b41ef41e4d4.tar.gz) | |

grub-mkconfig: Restore umask for the grub.cfgThe commit ab2e53c8a (grub-mkconfig: Honor a symlink when generating
configuration by grub-mkconfig) has inadvertently discarded umask for
creating grub.cfg in the process of running grub-mkconfig. The resulting
wrong permission (0644) would allow unprivileged users to read GRUB
configuration file content. This presents a low confidentiality risk
as grub.cfg may contain non-secured plain-text passwords.
This patch restores the missing umask and sets the creation file mode
to 0600 preventing unprivileged access.
Fixes: CVE-2021-3981
Signed-off-by: Michael Chang <mchang@suse.com>
Reviewed-by: Daniel Kiper <daniel.kiper@oracle.com>
[Diffstat](/cgit/grub.git/diff/?id=0adec29674561034771c13e446069b41ef41e4d4)

| -rw-r--r-- | [util/grub-mkconfig.in](/cgit/grub.git/diff/util/grub-mkconfig.in?id=0adec29674561034771c13e446069b41ef41e4d4) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/util/grub-mkconfig.in b/util/grub-mkconfig.inindex c3ea761..62335d0 100644--- a/[util/grub-mkconfig.in](/cgit/grub.git/tree/util/grub-mkconfig.in?id=d0219bffc7c463d313a4481872286fc65fc73a9b)+++ b/[util/grub-mkconfig.in](/cgit/grub.git/tree/util/grub-mkconfig.in?id=0adec29674561034771c13e446069b41ef41e4d4)@@ -301,7 +301,10 @@ and /etc/grub.d/\* files or please file a bug report with exit 1 else # none of the children aborted with error, install the new grub.cfg+ oldumask=$(umask)+ umask 077 cat ${grub\_cfg}.new > ${grub\_cfg}+ umask $oldumask rm -f ${grub\_cfg}.new fi fi |
| --- |

generated by [cgit v1.1](https://git.zx2c4.com/cgit/about/) at 2025-01-08 14:49:40 +0000

