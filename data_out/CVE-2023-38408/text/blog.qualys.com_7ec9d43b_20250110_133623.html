

* [Discussions](https://success.qualys.com/discussions/s/)
  + [Back to main menu](#back)
  + [BROWSE BY TOPIC](https://qualys-secure.force.com/discussions/s/)BROWSE BY TOPIC
  + [Global IT Asset Management](https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRIWA4/asset-management)
  + [IT Security](https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRwWAO/it-security)
  + [Compliance](https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIS1WAO/compliance)
  + [Cloud & Container Security](https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRnWAO/cloud-container)
  + [Web App Security](https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HISCWA4/web-app-security)
  + [Certificate Security & SSL Labs](https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRfWAO/certificate-security)
  + [Developer API](https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIR8WAO/developer)
  + [Cloud Platform](https://qualys-secure.force.com/discussions/s/topic/0TO2L000000HIRAWA4/qualys-cloud-platform)
  + [Start a discussion](https://qualys-secure.force.com/discussions/s/#start-a-discussion)
* [Blog](https://blog.qualys.com/)
* [Training](https://www.qualys.com/training/)
* [Docs](https://www.qualys.com/documentation/)
* [Support](https://success.qualys.com/customersupport/)
* [Trust](https://success.qualys.com/support/s/standards)

[Community](https://community.qualys.com/ "Qualys Community")

[![](https://d1uyme8f6ss6qi.cloudfront.net/image/icon/link-arrow-left.svg)
Blog Home](/)

# CVE-2023-38408: Remote Code Execution in OpenSSH’s forwarded ssh-agent

![Saeed Abbasi](https://secure.gravatar.com/avatar/cf1c318454e3694de9a913fb0313e42c?s=110&d=mm&r=g)
 [Saeed Abbasi](https://blog.qualys.com/author/sabbasi), Product Manager - Threat Research Unit, Qualys
[July 19, 2023July 24, 2023](https://blog.qualys.com/vulnerabilities-threat-research/2023/07/19/cve-2023-38408-remote-code-execution-in-opensshs-forwarded-ssh-agent) - 3 min read

**Last updated on:** *July 24, 2023*

#### Table of Contents

* [About OpenSSHs Agent Forwarding](#about-opensshs-agent-forwarding)
* [Potential Impact of OpenSSHs Agent Forwarding](#potential-impact-of-opensshs-agent-forwarding)
* [Disclosure Timeline](#disclosure-timeline)
* [Technical Details](#technical-details)
* [Qualys QID Coverage](#qualys-qid-coverage)
* [Conclusion](#conclusion)

The Qualys Threat Research Unit (TRU) has discovered a remote code execution vulnerability in OpenSSH’s forwarded ssh-agent. This vulnerability allows a remote attacker to potentially execute arbitrary commands on vulnerable OpenSSH’s forwarded ssh-agent. Given the widespread use of OpenSSH’s forwarded ssh-agent Qualys Research Unit recommends that security teams apply patches for this vulnerability on priority.

## **About OpenSSH’s Agent Forwarding**

The ssh-agent is a background program that caches private keys for SSH public key authentication, reducing the need for regular passphrase input. Initiated at the start of an X or login session, it operates by storing keys in memory and unloading only when the process ends.

It’s instrumental in automation scripts or tasks requiring frequent server connections, as it prevents the need for insecure password storage or constant passphrase input. The connections to ssh-agent may be forwarded from further remote to avoid the need for authentication data to be stored on other machines. Nonetheless, it’s still crucial to secure the keys with robust passphrases.

## **Potential Impact of OpenSSH’s Agent Forwarding**

Successful exploitation of this vulnerability allows a remote attacker to execute arbitrary commands on vulnerable OpenSSH forwarded ssh-agent.  Qualys security researchers have been able to independently verify the vulnerability, develop a PoC exploit on installations of Ubuntu Desktop 22.04 and 21.10. Other Linux distributions are likely vulnerable and probably exploitable.

As soon as the Qualys research team confirmed the vulnerability, Qualys engaged in responsible vulnerability disclosure and coordinated with the vendor, OpenSSH, on this occasion to announce the vulnerability.

## Disclosure Timeline

2023-07-06: Draft advisory and initial patch sent to OpenSSH.

2023-07-07: OpenSSH sent refined patches.

2023-07-09: Feedback on patches sent to OpenSSH.

2023-07-11: Received final patches from OpenSSH; feedback sent.

2023-07-14: OpenSSH plans for security-only release on July 19th.

2023-07-19: Coordinated release.

## **Technical Details**

You can find the technical details of these vulnerabilities at:

<https://www.qualys.com/2023/07/19/cve-2023-38408/rce-openssh-forwarded-ssh-agent.txt>

<https://www.qualys.com/2023/07/19/cve-2023-38408/rce-openssh-forwarded-ssh-agent.tar.gz>

## **Qualys QID Coverage**

Qualys has recently released a single QID 38904, which is available starting from the vulnsigs version VULNSIGS-2.5.820-3.

| QID | Title | Qualys Release Versions |
| --- | --- | --- |
| 38904 | OpenSSH Remote Code Execution (RCE) Vulnerability in its forwarded ssh-agent | VULNSIGS-2.5.820-3 |

## **Conclusion**

This newly uncovered ssh-agent vulnerability underlines the continuous need for rigorous security measures and immediate response. Even robust systems can harbor hidden vulnerabilities, as demonstrated by the shortcomings of the ssh-agent. Proactively rectifying such vulnerabilities through actions such as implementing patches is critical to maintaining the integrity of digital assets.

### *Related*

![Saeed Abbasi](https://secure.gravatar.com/avatar/cf1c318454e3694de9a913fb0313e42c?s=180&d=mm&r=g)

Written by
 [Saeed Abbasi](https://blog.qualys.com/author/sabbasi), Product Manager - Threat Research Unit, Qualys
Write to Saeed at sabbasi@qualys.com

Like
Share

##### Related content

[vulnerabilities](https://blog.qualys.com/tag/vulnerabilities)

Share your Comments
### Comments [Cancel reply](/vulnerabilities-threat-research/2023/07/19/cve-2023-38408-remote-code-execution-in-opensshs-forwarded-ssh-agent#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name

Email

 Save my name, email, and website in this browser for the next time I comment.

Δ

## Join the discussion today!

**Learn** more about Qualys and industry best practices.

**Share** what you know and build a reputation.

**Secure** your systems and improve security for everyone.

[Start a discussion](https://discussions.qualys.com/discussion/create%21input.jspa)

* [Twitter](https://twitter.com/qualys)
* [LinkedIn](https://www.linkedin.com/company/qualys)
* [Facebook](https://www.facebook.com/qualys)
* [YouTube](https://www.youtube.com/user/QualysGuard)
* [Vimeo](https://vimeo.com/qualys)

### Qualys

* [Qualys.com](https://www.qualys.com/ "Information Security and Compliance | Qualys, Inc.")
* [Qualys Community Edition](https://www.qualys.com/community-edition/ "Free Trial | Qualys, Inc.")
* [Qualys Merchandise Store](https://store.qualys.com/)
### Qualys Communities

* [Vulnerability Management](https://community.qualys.com/vulnerability-management/)
* [Policy Compliance](https://community.qualys.com/policy-compliance/)
* [PCI Compliance](https://community.qualys.com/pci-compliance/)
* [Web App Scanning](https://community.qualys.com/web-app-scanning/)
* [Web App Firewall](https://community.qualys.com/web-app-firewall/)
* [Continuous Monitoring](https://community.qualys.com/continuous-monitoring/)
* [Security Assessment Questionnaire](https://community.qualys.com/security-assessment-questionnaire/)
* [Threat Protection](https://community.qualys.com/threat-protection/)
* [Asset Inventory](https://community.qualys.com/asset-inventory/)
* [AssetView](https://community.qualys.com/asset-view/)
* [CMDB Sync](https://community.qualys.com/cmdb-sync/)
* [Endpoint Detection & Response](https://community.qualys.com/endpoint-detection-response/)
* [Security Configuration Assessment](https://community.qualys.com/security-configuration-assessment/)
* [File Integrity Monitoring](https://community.qualys.com/file-integrity-monitoring/)
* [Cloud Inventory](https://community.qualys.com/cloud-inventory/)
* [Certificate Inventory](https://community.qualys.com/certificate-inventory/)
* [Container Security](https://community.qualys.com/container-security/)
* [Cloud Security Assessment](https://community.qualys.com/cloud-security-assessment/)
* [Certificate Assessment](https://community.qualys.com/certificate-assessment/)
* [Out-of-band Configuration Assessment](https://community.qualys.com/out-of-band-configuration-assessment/)
* [Patch Management](https://community.qualys.com/patch-management/)
* [Developer API](https://community.qualys.com/api/)
* [Cloud Agent](https://community.qualys.com/cloud-agent/)
* [Dashboards & Reporting](https://community.qualys.com/reporting/)
### Discussions

* [All discussions](https://discussions.qualys.com/)
* [Global IT Asset Management](https://discussions.qualys.com/community/asset-inventory)
* [IT Security](https://discussions.qualys.com/community/vulnerability-management)
* [Compliance](https://discussions.qualys.com/community/policy-compliance)
* [Cloud & Container Security](https://discussions.qualys.com/community/cloud-security)
* [Web App Security](https://discussions.qualys.com/community/web-application-scanning)
* [Certificate Security & SSL Labs](https://discussions.qualys.com/community/ssllabs)
* [Developer API](https://discussions.qualys.com/community/developer)
### Blog

* [All posts](https://blog.qualys.com/)
* [Qualys Insights](https://blog.qualys.com/qualys-insights)
* [Product and Tech](https://blog.qualys.com/product-tech)
* [Vulnerabilities and Threat Research](https://blog.qualys.com/vulnerabilities-threat-research)
* [Release Notifications](https://notifications.qualys.com/)
### Training

* [Overview](https://www.qualys.com/training/)
* [Certified Courses](https://www.qualys.com/training/#self-paced)
* [Video Library](https://www.qualys.com/training/#video-library)
* [Instructor-led Training](https://www.qualys.com/training/#instructor-led)
### Docs

* [Overview](https://www.qualys.com/documentation/)
* [Release Notes](https://www.qualys.com/documentation/release-notes/)
### Support

* [Support Portal](https://qualys-secure.force.com/customer/s/)

© 2025 Qualys, Inc. All rights reserved. [Privacy Policy](https://www.qualys.com/company/privacy/) . [Accessibility](https://www.qualys.com/company/accessibility/)

![Cleantalk Pixel](https://moderate6-v4.cleantalk.org/pixel/c2fb893108a2a6f9f0405f44b2224aff.gif "Cleantalk Pixel")

