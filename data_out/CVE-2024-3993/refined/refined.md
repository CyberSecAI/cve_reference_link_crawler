- **Root cause of vulnerability:** The AZAN plugin lacks CSRF checks in certain areas and doesn't properly sanitize or escape user inputs.
- **Weaknesses/vulnerabilities:**
    - Cross-Site Request Forgery (CSRF) vulnerability: The absence of CSRF checks allows attackers to induce logged-in administrators to perform unintended actions.
    - Stored Cross-Site Scripting (XSS) vulnerability: Input values are not properly sanitized or escaped, enabling attackers to inject malicious JavaScript code which gets stored in the database and executed in the browser when the page is loaded.
- **Impact of exploitation:** Attackers can inject and execute arbitrary JavaScript code in the context of a logged-in administrator's session. This could lead to various malicious activities, including but not limited to:
    - Stealing sensitive information.
    - Redirecting users to malicious websites.
    - Defacing the website.
    - Taking over administrator accounts.
- **Attack vectors:**
    - CSRF: An attacker crafts a malicious HTML page with a form that submits data to the vulnerable plugin's settings page. If a logged-in administrator opens this HTML page, the form is automatically submitted, triggering the vulnerability.
    - Stored XSS: Once the crafted data is submitted, it is stored in the database and displayed on the website, executing the injected script.
- **Required attacker capabilities/position:**
    - The attacker needs to lure a logged-in administrator into opening a specially crafted HTML page or a link that triggers the CSRF attack.
    - The attacker does not require specific privileges on the server other than tricking an admin into visiting the crafted html page.