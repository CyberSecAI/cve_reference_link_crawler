```
{
  "vulnerability_details": {
    "root_cause": "The commit introduces several access control checks using `AclMain::aclCheckCore` in various PHP files. The changes aim to prevent unauthorized access to different features and functionalities within the OpenEMR application. These checks are performed before rendering the page using Twig. If a user doesn't have the required permissions, they are shown an 'unauthorized' page.",
    "weaknesses": [
      "Missing access control checks in multiple files, allowing unauthorized users to potentially access or modify sensitive data and functionality."
    ],
    "impact": "Unauthorized users can potentially gain access to restricted functionalities or data within OpenEMR. This could lead to data breaches, unauthorized modifications, or disruption of service, depending on the specific resource that is being accessed without proper authorization.",
    "attack_vectors": "An attacker could try to directly access restricted URLs without having the necessary privileges, bypassing the authorization checks that were previously missing.",
     "required_attacker_capabilities": "An attacker needs to know or guess the internal paths and URLs, and they must not be authenticated with a role that grants access to the target page. The attacker can be either an unauthenticated user or an authenticated user with insufficient privileges."
  },
  "files_changed": [
    {
      "file": "controllers/C_Document.class.php",
      "changes": "Added ACL check for document access."
    },
    {
      "file": "controllers/C_PracticeSettings.class.php",
      "changes": "Added ACL check for practice settings."
    },
    {
      "file": "interface/billing/edit_payment.php",
      "changes": "Added ACL checks for payment editing."
    },
     {
      "file": "interface/billing/era_payments.php",
      "changes": "Added ACL checks for ERA posting."
    },
    {
      "file": "interface/billing/indigent_patients_report.php",
       "changes":"Added ACL check for indigent patients report."
    },
    {
      "file": "interface/billing/new_payment.php",
       "changes":"Added ACL checks for new payment."
    },
    {
      "file":"interface/billing/search_payments.php",
      "changes": "Added ACL checks for payment search."
    },
    {
      "file":"interface/billing/sl_eob_search.php",
      "changes":"Added ACL checks for EOB search."
    },
      {
      "file":"interface/billing/sl_receipts_report.php",
        "changes":"Added ACL check for receipts report. Also, limited access to doctor-specific data for non-admin users."
     },
    {
      "file":"interface/main/display_documents.php",
       "changes":"Added ACL check for lab documents."
    },
    {
     "file":"interface/orders/orders_results.php",
     "changes":"Added ACL checks for procedure results. Also added extra unauthorized page to avoid leaking information"
    },
     {
     "file":"interface/orders/pending_orders.php",
       "changes":"Added ACL check for pending orders. Also,  removed redundant authorization check"
    },
    {
      "file":"interface/orders/procedure_stats.php",
      "changes":"Added ACL check for procedure statistics report. Also, removed redundant check"
    },
    {
      "file":"interface/orders/types.php",
      "changes":"Added ACL checks for order types."
    },
    {
      "file": "interface/patient_file/ccr_import.php",
       "changes":"Added ACL check for CCR import."
    },
    {
      "file":"interface/patient_file/ccr_pending_approval.php",
      "changes":"Added ACL check for CCR approval."
    },
    {
      "file": "interface/patient_file/encounter/load_form.php",
      "changes": "Added ACL check for form access, showing a custom error page if unauthorized."
    },
     {
      "file":"interface/patient_file/front_payment.php",
      "changes":"Added ACL checks for front payment access. Different messages based on action type."
    }
  ]
}
```