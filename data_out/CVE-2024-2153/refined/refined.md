- **Root cause of vulnerability**: The application is vulnerable to SQL injection due to unsanitized user-supplied input in the `id` parameter of the `view_order.php` page. Specifically, the value of the `id` parameter is directly inserted into the SQL query without proper sanitization or parameterization.
- **Weaknesses/vulnerabilities present**: SQL injection (CWE-89). The application constructs an SQL query using string concatenation that includes the `$_GET['id']` parameter, making it vulnerable to SQL injection.
- **Impact of exploitation**: An attacker can inject arbitrary SQL queries, allowing them to read, modify, or delete data from the database. In the example provided, the attacker extracts the database version using a union-based SQL injection technique.
- **Attack vectors**: The attacker sends an HTTP GET request to `/mobile_store/admin/?page=orders/view_order` and injects malicious SQL code into the `id` parameter, such as `id=1'+AND+FALSE+UNION+SELECT+1,2,3,4,5,6,7,8,9,10,version()--+-`.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable application. No authentication is mentioned as a requirement for the exploitation.