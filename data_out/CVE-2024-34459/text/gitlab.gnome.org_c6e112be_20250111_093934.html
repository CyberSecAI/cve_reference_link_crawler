

[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# [CVE-2024-34459] Heap buffer overflow with `xmllint --htmlout`

* **Organization Name**: The OSLab of Peking University
* **Tool and Version**
  + xmllint 2.12.6
* **Environment**
  + OS: Ubuntu 18.04.6 LTS x86\_64
  + LLVM: 13.0.1
  + AFLPlusPlus: 4.10c
* **Bug Reproduction Steps**
  + Compile
    - `export FORCE_UNSAFE_CONFIGURE=1`
    - `export AFL_USE_ASAN=1`
    - `cmake -DCMAKE_C_COMPILER=afl-clang-fast -DCMAKE_CXX_COMPILER=afl-clang-fast++ .. && make -j8`
  + Run the command `xmllint --htmlout bug_trigger`
  + File `bug_trigger` and log file are attached
* **Screen Recording**
  [![截屏2024-05-03_17.46.53](data:image/gif;base64...)](/-/project/1665/uploads/4a1c4ea4738618c53e0e7062bc000041/%E6%88%AA%E5%B1%8F2024-05-03_17.46.53.png)
* It seems that the overflow happens at `xmllint.c:563-564` for no boundary check.

```
  while ((*cur == '\n') || (*cur == '\r'))
	cur--;
```

[bug\_trigger](/-/project/1665/uploads/b09e915ed9b297eb65af44c06f8ce440/bug_trigger)
[log.log](/-/project/1665/uploads/aa45f996c976aee4ad67863bbcb6a1a8/log.log)

Assignee
Loading

Time tracking
Loading

