=== Content from security.netapp.com_224c48e1_20250110_171526.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [May 2024 IBM Cognos Analytics Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20240621-0007)

## May 2024 IBM Cognos Analytics Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20240621-0007 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240621-0007 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20240621-0007 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240621-0007 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240621-0007
**Version:**
2.0

**Last updated:**
09/20/2024

**Status:**
Final.

**CVEs:** CVE-2023-44981, CVE-2023-44487, CVE-2023-5072, CVE-2023-34462, CVE-2024-25047, CVE-2022-23540, CVE-2022-23541, CVE-2022-23539, CVE-2023-31484, CVE-2020-15366, CVE-2021-28363

Overview
#### Summary

Multiple NetApp products incorporate IBM Cognos Analytics. IBM Cognos Analytics versions 12.0 through 12.0.2 and 11.2.0 through 11.2.4 FP2 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2020-15366](https://nvd.nist.gov/vuln/detail/CVE-2020-15366) | 5.6 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L |
| [CVE-2021-28363](https://nvd.nist.gov/vuln/detail/CVE-2021-28363) | 5.9 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:N |
| [CVE-2022-23539](https://nvd.nist.gov/vuln/detail/CVE-2022-23539) | 5.9 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:N |
| [CVE-2022-23540](https://nvd.nist.gov/vuln/detail/CVE-2022-23540) | 6.4 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:L |
| [CVE-2022-23541](https://nvd.nist.gov/vuln/detail/CVE-2022-23541) | 5.0 (MEDIUM) | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L |
| [CVE-2023-31484](https://nvd.nist.gov/vuln/detail/CVE-2023-31484) | 7.4 (HIGH) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N |
| [CVE-2023-34462](https://nvd.nist.gov/vuln/detail/CVE-2023-34462) | 6.5 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2023-44981](https://nvd.nist.gov/vuln/detail/CVE-2023-44981) | 8.1 (HIGH) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2023-5072](https://nvd.nist.gov/vuln/detail/CVE-2023-5072) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2024-25047](https://nvd.nist.gov/vuln/detail/CVE-2024-25047) | 8.6 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.ibm.com/support/pages/node/7149874>

Affected Products
#### Affected Products

* OnCommand Insight

#### Products Not Affected

* AFF BIOS - A1K/A70/A90
* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A1K/A70/A90
* AFF Baseboard Management Controller (BMC) - A700s
* AFF LOADER- A1K/A70/A90
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp DataOps Toolkit
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 10
* ONTAP tools for VMware vSphere 9
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG5812/SG5860
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* StorageGRID Baseboard Management Controller (BMC) SG5812/SG5860
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **OnCommand Insight** | <https://mysupport.netapp.com/site/products/all/details/oncommand-insight/downloads-tab/download/60983/7.3.16> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240621-0007>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240621 | Initial Public Release |
| 2.0 | 20240920 | OnCommand Insight added to Software Versions and Fixes, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from security.netapp.com_4898a7a7_20250110_171526.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2023-34462 Apache Netty Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20230803-0001)

## CVE-2023-34462 Apache Netty Vulnerability in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230803-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230803-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230803-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230803-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230803-0001
**Version:**
3.0

**Last updated:**
11/11/2024

**Status:**
Interim.

**CVEs:** CVE-2023-34462

Overview
#### Summary

Multiple NetApp products incorporate Apache Netty. Apache Netty versions prior to 4.1.94 is susceptible to a vulnerability which when successfully exploited could lead to Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2023-34462](https://nvd.nist.gov/vuln/detail/CVE-2023-34462) | 6.5 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://github.com/netty/netty/security/advisories/GHSA-6mjq-h674-j845>

Affected Products
#### Affected Products

* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* OnCommand Workflow Automation

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7600N
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Volumes ONTAP Mediator
* Data Infrastructure Insights Acquisition Unit (formerly Cloud Insights Acquisition Unit)
* Data Infrastructure Insights Storage Workload Security Agent (formerly Cloud Insights Storage Workload Security Agent)
* Data Infrastructure Insights Telegraf Agent (formerly Cloud Insights Telegraf Agent)
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **OnCommand Workflow Automation** | <https://mysupport.netapp.com/site/products/all/details/ocwfa/downloads-tab/download/61550/5.1.1P7> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230803-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230803 | Initial Public Release |
| 2.0 | 20231004 | OnCommand Workflow Automation moved to Affected Products |
| 3.0 | 20241111 | OnCommand Workflow Automation added to Software Versions and Fixes |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from github.com_0c1666f9_20250110_171525.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2F535da17e45201ae4278c0479e6162bb4127d4c32)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2F535da17e45201ae4278c0479e6162bb4127d4c32)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=netty%2Fnetty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[netty](/netty)
/
**[netty](/netty/netty)**
Public

* [Notifications](/login?return_to=%2Fnetty%2Fnetty) You must be signed in to change notification settings
* [Fork
  16k](/login?return_to=%2Fnetty%2Fnetty)
* [Star
   33.7k](/login?return_to=%2Fnetty%2Fnetty)

* [Code](/netty/netty)
* [Issues
  575](/netty/netty/issues)
* [Pull requests
  39](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects
  0](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

Additional navigation options

* [Code](/netty/netty)
* [Issues](/netty/netty/issues)
* [Pull requests](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

## Commit

[Permalink](/netty/netty/commit/535da17e45201ae4278c0479e6162bb4127d4c32)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-6mjq-h674-j845](https://github.com/advisories/GHSA-6mjq-h674-j845 "GHSA-6mjq-h674-j845")

[Browse files](/netty/netty/tree/535da17e45201ae4278c0479e6162bb4127d4c32)
Browse the repository at this point in the history

```
Motivation:

In theory the ClientHello can span multiple records and so reach the length of 16MB. This can result in high memory usage, we should allow the user to define a maximum length.

Modifications:

Add new constructor which allows to limit the maximum length of a ClientHello message.

Result:

Be able to guard against high memory usage when parsing ClientHello messages
```

* Loading branch information

[![@normanmaurer](https://avatars.githubusercontent.com/u/439362?s=40&v=4)](/normanmaurer)

[normanmaurer](/netty/netty/commits?author=normanmaurer "View all commits by normanmaurer")
authored
Jun 20, 2023

1 parent
[1bb825b](/netty/netty/commit/1bb825b7cec563acbb5e1d257f9d48551bbc707d)

commit 535da17

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**127 additions**
and
**11 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* handler/src

  + main/java/io/netty/handler/ssl

    - handler/src/main/java/io/netty/handler/ssl/AbstractSniHandler.java
      [AbstractSniHandler.java](#diff-3517bb83a62e0d779f8895d38da0367464f1115149a5395a2670f832582a6799)
    - handler/src/main/java/io/netty/handler/ssl/SniHandler.java
      [SniHandler.java](#diff-fc17884fef04eaabfaec52238a49d5f06a8471a8f44f0f72e07a22f59e4c94c2)
    - handler/src/main/java/io/netty/handler/ssl/SslClientHelloHandler.java
      [SslClientHelloHandler.java](#diff-1c7c1e64a0afabaa56b28c9fd8a3c9173a8904b2cee64be327563b7d97b69086)
  + test/java/io/netty/handler/ssl

    - handler/src/test/java/io/netty/handler/ssl/SniHandlerTest.java
      [SniHandlerTest.java](#diff-326ca4c4122551045b0842b2d57a2e0e2313fc1fba6d8c1655abe786a03f8bda)

## There are no files selected for viewing

13 changes: 11 additions & 2 deletions

13
[handler/src/main/java/io/netty/handler/ssl/AbstractSniHandler.java](#diff-3517bb83a62e0d779f8895d38da0367464f1115149a5395a2670f832582a6799 "handler/src/main/java/io/netty/handler/ssl/AbstractSniHandler.java")

Show comments

[View file](/netty/netty/blob/535da17e45201ae4278c0479e6162bb4127d4c32/handler/src/main/java/io/netty/handler/ssl/AbstractSniHandler.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -126,14 +126,23 @@ private static String extractSniHostname(ByteBuf in) { |
|  |  | private String hostname; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @param handshakeTimeoutMillis the handshake timeout in milliseconds |
|  |  | \* @param handshakeTimeoutMillis  the handshake timeout in milliseconds |
|  |  | \*/ |
|  |  | protected AbstractSniHandler(long handshakeTimeoutMillis) { |
|  |  | this(0, handshakeTimeoutMillis); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @paramm maxClientHelloLength the maximum length of the client hello message. |
|  |  | \* @param handshakeTimeoutMillis the handshake timeout in milliseconds |
|  |  | \*/ |
|  |  | protected AbstractSniHandler(int maxClientHelloLength, long handshakeTimeoutMillis) { |
|  |  | super(maxClientHelloLength); |
|  |  | this.handshakeTimeoutMillis = checkPositiveOrZero(handshakeTimeoutMillis, "handshakeTimeoutMillis"); |
|  |  | } |
|  |  |  |
|  |  | public AbstractSniHandler() { |
|  |  | this(0L); |
|  |  | this(0, 0L); |
|  |  | } |
|  |  |  |
|  |  | @Override |
| Expand Down | |  |

36 changes: 31 additions & 5 deletions

36
[handler/src/main/java/io/netty/handler/ssl/SniHandler.java](#diff-fc17884fef04eaabfaec52238a49d5f06a8471a8f44f0f72e07a22f59e4c94c2 "handler/src/main/java/io/netty/handler/ssl/SniHandler.java")

Show comments

[View file](/netty/netty/blob/535da17e45201ae4278c0479e6162bb4127d4c32/handler/src/main/java/io/netty/handler/ssl/SniHandler.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -56,10 +56,12 @@ public SniHandler(Mapping<? super String, ? extends SslContext> mapping) { |
|  |  | \* maintained by {@link Mapping} |
|  |  | \* |
|  |  | \* @param mapping the mapping of domain name to {@link SslContext} |
|  |  | \* @param maxClientHelloLength the maximum length of the client hello message |
|  |  | \* @param handshakeTimeoutMillis the handshake timeout in milliseconds |
|  |  | \*/ |
|  |  | public SniHandler(Mapping<? super String, ? extends SslContext> mapping, long handshakeTimeoutMillis) { |
|  |  | this(new AsyncMappingAdapter(mapping), handshakeTimeoutMillis); |
|  |  | public SniHandler(Mapping<? super String, ? extends SslContext> mapping, |
|  |  | int maxClientHelloLength, long handshakeTimeoutMillis) { |
|  |  | this(new AsyncMappingAdapter(mapping), maxClientHelloLength, handshakeTimeoutMillis); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand All | | @@ -80,22 +82,46 @@ public SniHandler(DomainNameMapping<? extends SslContext> mapping) { |
|  |  | \*/ |
|  |  | @SuppressWarnings("unchecked") |
|  |  | public SniHandler(AsyncMapping<? super String, ? extends SslContext> mapping) { |
|  |  | this(mapping, 0L); |
|  |  | this(mapping, 0, 0L); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Creates a SNI detection handler with configured {@link SslContext} |
|  |  | \* maintained by {@link AsyncMapping} |
|  |  | \* |
|  |  | \* @param mapping the mapping of domain name to {@link SslContext} |
|  |  | \* @param maxClientHelloLength the maximum length of the client hello message |
|  |  | \* @param handshakeTimeoutMillis the handshake timeout in milliseconds |
|  |  | \*/ |
|  |  | @SuppressWarnings("unchecked") |
|  |  | public SniHandler(AsyncMapping<? super String, ? extends SslContext> mapping, long handshakeTimeoutMillis) { |
|  |  | super(handshakeTimeoutMillis); |
|  |  | public SniHandler(AsyncMapping<? super String, ? extends SslContext> mapping, |
|  |  | int maxClientHelloLength, long handshakeTimeoutMillis) { |
|  |  | super(maxClientHelloLength, handshakeTimeoutMillis); |
|  |  | this.mapping = (AsyncMapping<String, SslContext>) ObjectUtil.checkNotNull(mapping, "mapping"); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Creates a SNI detection handler with configured {@link SslContext} |
|  |  | \* maintained by {@link Mapping} |
|  |  | \* |
|  |  | \* @param mapping the mapping of domain name to {@link SslContext} |
|  |  | \* @param handshakeTimeoutMillis the handshake timeout in milliseconds |
|  |  | \*/ |
|  |  | public SniHandler(Mapping<? super String, ? extends SslContext> mapping, long handshakeTimeoutMillis) { |
|  |  | this(new AsyncMappingAdapter(mapping), handshakeTimeoutMillis); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Creates a SNI detection handler with configured {@link SslContext} |
|  |  | \* maintained by {@link AsyncMapping} |
|  |  | \* |
|  |  | \* @param mapping the mapping of domain name to {@link SslContext} |
|  |  | \* @param handshakeTimeoutMillis the handshake timeout in milliseconds |
|  |  | \*/ |
|  |  | public SniHandler(AsyncMapping<? super String, ? extends SslContext> mapping, long handshakeTimeoutMillis) { |
|  |  | this(mapping, 0, handshakeTimeoutMillis); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @return the selected hostname |
|  |  | \*/ |
| Expand Down | |  |

32 changes: 32 additions & 0 deletions

32
[handler/src/main/java/io/netty/handler/ssl/SslClientHelloHandler.java](#diff-1c7c1e64a0afabaa56b28c9fd8a3c9173a8904b2cee64be327563b7d97b69086 "handler/src/main/java/io/netty/handler/ssl/SslClientHelloHandler.java")

Show comments

[View file](/netty/netty/blob/535da17e45201ae4278c0479e6162bb4127d4c32/handler/src/main/java/io/netty/handler/ssl/SslClientHelloHandler.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,8 +22,10 @@ |
|  |  | import io.netty.channel.ChannelPromise; |
|  |  | import io.netty.handler.codec.ByteToMessageDecoder; |
|  |  | import io.netty.handler.codec.DecoderException; |
|  |  | import io.netty.handler.codec.TooLongFrameException; |
|  |  | import io.netty.util.concurrent.Future; |
|  |  | import io.netty.util.concurrent.FutureListener; |
|  |  | import io.netty.util.internal.ObjectUtil; |
|  |  | import io.netty.util.internal.PlatformDependent; |
|  |  | import io.netty.util.internal.logging.InternalLogger; |
|  |  | import io.netty.util.internal.logging.InternalLoggerFactory; |
| Expand All | | @@ -36,14 +38,32 @@ |
|  |  | \*/ |
|  |  | public abstract class SslClientHelloHandler<T> extends ByteToMessageDecoder implements ChannelOutboundHandler { |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The maximum length of client hello message as defined by |
|  |  | \* <a href="https://www.rfc-editor.org/rfc/rfc5246#section-6.2.1">RFC5246</a>. |
|  |  | \*/ |
|  |  | public static final int MAX\_CLIENT\_HELLO\_LENGTH = 0xFFFFFF; |
|  |  |  |
|  |  | private static final InternalLogger logger = |
|  |  | InternalLoggerFactory.getInstance(SslClientHelloHandler.class); |
|  |  |  |
|  |  | private final int maxClientHelloLength; |
|  |  | private boolean handshakeFailed; |
|  |  | private boolean suppressRead; |
|  |  | private boolean readPending; |
|  |  | private ByteBuf handshakeBuffer; |
|  |  |  |
|  |  | public SslClientHelloHandler() { |
|  |  | this(MAX\_CLIENT\_HELLO\_LENGTH); |
|  |  | } |
|  |  |  |
|  |  | protected SslClientHelloHandler(int maxClientHelloLength) { |
|  |  | // 16MB is the maximum as per RFC: |
|  |  | // See https://www.rfc-editor.org/rfc/rfc5246#section-6.2.1 |
|  |  | this.maxClientHelloLength = |
|  |  | ObjectUtil.checkInRange(maxClientHelloLength, 0, MAX\_CLIENT\_HELLO\_LENGTH, "maxClientHelloLength"); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | protected void decode(ChannelHandlerContext ctx, ByteBuf in, List<Object> out) throws Exception { |
|  |  | if (!suppressRead && !handshakeFailed) { |
| Expand Down  Expand Up | | @@ -117,6 +137,15 @@ protected void decode(ChannelHandlerContext ctx, ByteBuf in, List<Object> out) t |
|  |  | handshakeLength = in.getUnsignedMedium(readerIndex + |
|  |  | SslUtils.SSL\_RECORD\_HEADER\_LENGTH + 1); |
|  |  |  |
|  |  | if (handshakeLength > maxClientHelloLength && maxClientHelloLength != 0) { |
|  |  | TooLongFrameException e = new TooLongFrameException( |
|  |  | "ClientHello length exceeds " + maxClientHelloLength + |
|  |  | ": " + handshakeLength); |
|  |  | in.skipBytes(in.readableBytes()); |
|  |  | ctx.fireUserEventTriggered(new SniCompletionEvent(e)); |
|  |  | SslUtils.handleHandshakeFailure(ctx, e, true); |
|  |  | throw e; |
|  |  | } |
|  |  | // Consume handshakeType and handshakeLength (this sums up as 4 bytes) |
|  |  | readerIndex += 4; |
|  |  | packetLength -= 4; |
| Expand Down  Expand Up | | @@ -161,6 +190,9 @@ protected void decode(ChannelHandlerContext ctx, ByteBuf in, List<Object> out) t |
|  |  | } catch (NotSslRecordException e) { |
|  |  | // Just rethrow as in this case we also closed the channel and this is consistent with SslHandler. |
|  |  | throw e; |
|  |  | } catch (TooLongFrameException e) { |
|  |  | // Just rethrow as in this case we also closed the channel |
|  |  | throw e; |
|  |  | } catch (Exception e) { |
|  |  | // unexpected encoding, ignore sni and use default |
|  |  | if (logger.isDebugEnabled()) { |
| Expand Down | |  |

57 changes: 53 additions & 4 deletions

57
[handler/src/test/java/io/netty/handler/ssl/SniHandlerTest.java](#diff-326ca4c4122551045b0842b2d57a2e0e2313fc1fba6d8c1655abe786a03f8bda "handler/src/test/java/io/netty/handler/ssl/SniHandlerTest.java")

Show comments

[View file](/netty/netty/blob/535da17e45201ae4278c0479e6162bb4127d4c32/handler/src/test/java/io/netty/handler/ssl/SniHandlerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,11 +25,10 @@ |
|  |  | import java.util.concurrent.atomic.AtomicBoolean; |
|  |  | import java.util.concurrent.atomic.AtomicReference; |
|  |  |  |
|  |  | import javax.net.ssl.HandshakeCompletedEvent; |
|  |  | import javax.net.ssl.SSLContext; |
|  |  | import javax.net.ssl.SSLEngine; |
|  |  | import javax.net.ssl.SSLException; |
|  |  |  |
|  |  | import io.netty.handler.codec.TooLongFrameException; |
|  |  | import io.netty.util.concurrent.Future; |
|  |  |  |
|  |  | import io.netty.bootstrap.Bootstrap; |
| Expand Down  Expand Up | | @@ -715,14 +714,64 @@ private static List<ByteBuf> split(ByteBuf clientHello, int maxSize) { |
|  |  | return result; |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testSniHandlerFailsOnTooBigClientHello() throws Exception { |
|  |  | SniHandler handler = new SniHandler(new Mapping<String, SslContext>() { |
|  |  | @Override |
|  |  | public SslContext map(String input) { |
|  |  | throw new UnsupportedOperationException("Should not be called"); |
|  |  | } |
|  |  | }, 10, 0); |
|  |  |  |
|  |  | final AtomicReference<SniCompletionEvent> completionEventRef = |
|  |  | new AtomicReference<SniCompletionEvent>(); |
|  |  | final EmbeddedChannel ch = new EmbeddedChannel(handler, new ChannelInboundHandlerAdapter() { |
|  |  | @Override |
|  |  | public void userEventTriggered(ChannelHandlerContext ctx, Object evt) { |
|  |  | if (evt instanceof SniCompletionEvent) { |
|  |  | completionEventRef.set((SniCompletionEvent) evt); |
|  |  | } |
|  |  | } |
|  |  | }); |
|  |  | final ByteBuf buffer = ch.alloc().buffer(); |
|  |  | buffer.writeByte(0x16); // Content Type: Handshake |
|  |  | buffer.writeShort((short) 0x0303); // TLS 1.2 |
|  |  | buffer.writeShort((short) 0x0006); // Packet length |
|  |  |  |
|  |  | // 16\_777\_215 |
|  |  | buffer.writeByte((byte) 0x01); // Client Hello |
|  |  | buffer.writeMedium(0xFFFFFF); // Length |
|  |  | buffer.writeShort((short) 0x0303); // TLS 1.2 |
|  |  |  |
|  |  | assertThrows(TooLongFrameException.class, new Executable() { |
|  |  | @Override |
|  |  | public void execute() throws Throwable { |
|  |  | ch.writeInbound(buffer); |
|  |  | } |
|  |  | }); |
|  |  | try { |
|  |  | while (completionEventRef.get() == null) { |
|  |  | Thread.sleep(100); |
|  |  | // We need to run all pending tasks as the handshake timeout is scheduled on the EventLoop. |
|  |  | ch.runPendingTasks(); |
|  |  | } |
|  |  | SniCompletionEvent completionEvent = completionEventRef.get(); |
|  |  | assertNotNull(completionEvent); |
|  |  | assertNotNull(completionEvent.cause()); |
|  |  | assertEquals(TooLongFrameException.class, completionEvent.cause().getClass()); |
|  |  | } finally { |
|  |  | ch.finishAndReleaseAll(); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testSniHandlerFiresHandshakeTimeout() throws Exception { |
|  |  | SniHandler handler = new SniHandler(new Mapping<String, SslContext>() { |
|  |  | @Override |
|  |  | public SslContext map(String input) { |
|  |  | throw new UnsupportedOperationException("Should not be called"); |
|  |  | } |
|  |  | }, 10); |
|  |  | }, 0, 10); |
|  |  |  |
|  |  | final AtomicReference<SniCompletionEvent> completionEventRef = |
|  |  | new AtomicReference<SniCompletionEvent>(); |
| Expand Down  Expand Up | | @@ -758,7 +807,7 @@ public void testSslHandlerFiresHandshakeTimeout(SslProvider provider) throws Exc |
|  |  | public SslContext map(String input) { |
|  |  | return context; |
|  |  | } |
|  |  | }, 100); |
|  |  | }, 0, 100); |
|  |  |  |
|  |  | final AtomicReference<SniCompletionEvent> sniCompletionEventRef = |
|  |  | new AtomicReference<SniCompletionEvent>(); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `535da17`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2F535da17e45201ae4278c0479e6162bb4127d4c32) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b6557df1_20250110_171525.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fsecurity%2Fadvisories%2FGHSA-6mjq-h674-j845)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fsecurity%2Fadvisories%2FGHSA-6mjq-h674-j845)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=netty%2Fnetty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[netty](/netty)
/
**[netty](/netty/netty)**
Public

* [Notifications](/login?return_to=%2Fnetty%2Fnetty) You must be signed in to change notification settings
* [Fork
  16k](/login?return_to=%2Fnetty%2Fnetty)
* [Star
   33.7k](/login?return_to=%2Fnetty%2Fnetty)

* [Code](/netty/netty)
* [Issues
  575](/netty/netty/issues)
* [Pull requests
  39](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects
  0](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

Additional navigation options

* [Code](/netty/netty)
* [Issues](/netty/netty/issues)
* [Pull requests](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

# SniHandler 16MB allocation

Moderate

[normanmaurer](/normanmaurer)
published
GHSA-6mjq-h674-j845
Jun 20, 2023

## Package

maven

io.netty:netty-handler
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 4.1.94.Final

## Patched versions

4.1.94.Final

## Description

### Summary

The `SniHandler` can allocate up to 16MB of heap for each channel during the TLS handshake. When the handler or the channel does not have an idle timeout, it can be used to make a TCP server using the `SniHandler` to allocate 16MB of heap.

### Details

The `SniHandler` class is a handler that waits for the TLS handshake to configure a `SslHandler` according to the indicated server name by the `ClientHello` record. For this matter it allocates a `ByteBuf` using the value defined in the `ClientHello` record.

Normally the value of the packet should be smaller than the handshake packet but there are not checks done here and the way the code is written, it is possible to craft a packet that makes the `SslClientHelloHandler`

1/ allocate a 16MB `ByteBuf`

2/ not fail `decode` method `in` buffer

3/ get out of the loop without an exception

The combination of this without the use of a timeout makes easy to connect to a TCP server and allocate 16MB of heap memory per connection.

### Impact

If the user has no idle timeout handler configured it might be possible for a remote peer to send a client hello packet which lead the server to buffer up to 16MB of data per connection. This could lead to a OutOfMemoryError and so result in a DDOS.

### Severity

Moderate

### CVE ID

CVE-2023-34462

### Weaknesses

No CWEs

### Credits

* [![@vietj](https://avatars.githubusercontent.com/u/225674?s=40&v=4)](/vietj)
  [vietj](/vietj)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.debian.org_9b290962_20250110_171527.html ===


---

[[Date Prev](msg00253.html)][[Date Next](msg00255.html)]
[[Thread Prev](msg00253.html)][[Thread Next](msg00255.html)]
[[Date Index](maillist.html#00254)]
[[Thread Index](threads.html#00254)]

# [SECURITY] [DSA 5558-1] netty security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5558-1] netty security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Sat, 18 Nov 2023 16:33:00 +0000
* *Message-id*: <[[🔎]](/msgid-search/ZVjnPDwqLmwPVamB%40seger.debian.org) [ZVjnPDwqLmwPVamB@seger.debian.org](msg00254.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5558-1                   security@debian.org
<https://www.debian.org/security/>                          Markus Koschany
November 18, 2023                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : netty
CVE ID         : CVE-2023-34462 CVE-2023-44487
Debian Bug     : 1038947 1054234

Two security vulnerabilities have been discovered in Netty, a Java NIO
client/server socket framework.

CVE-2023-34462

    It might be possible for a remote peer to send a client hello packet during
    a TLS handshake which lead the server to buffer up to 16 MB of data per
    connection. This could lead to a OutOfMemoryError and so result in a denial
    of service.

CVE-2023-44487

    The HTTP/2 protocol allowed a denial of service (server resource
    consumption) because request cancellation can reset many streams quickly.
    This problem is also known as Rapid Reset Attack.

For the oldstable distribution (bullseye), these problems have been fixed
in version 1:4.1.48-4+deb11u2.

For the stable distribution (bookworm), these problems have been fixed in
version 1:4.1.48-7+deb12u1.

We recommend that you upgrade your netty packages.

For the detailed security status of netty please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/netty>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAmVY5TZfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeRHiBAAzFhW85Ho37J02wrSDVwhIMTsVjNO9lnA08Pswdohr9K1wxeCJ/hBAx97
UNIrjTxyOfCJWi1Kj5pITXEHBRu6w1fj/5y9yoMpAKEu+oGQroHbSf4CPmqP2Of0
eamkfbGx2Dh7Ug3qYxe+elcqRtU3gu8I8DYcWJnm2VpWq7/pbNJ+9iqtmMjhkPLH
1etLI/5HAkwpPimZSrHzcimn39gEVaIbZLc86ZBAoAPghc+iJR1JFHERmkEutWkB
eAnL3kD1mr6F711eZvDfPaRfEUVorW67ZEpPX68MJExuYHNXd268EhQOhf/ZYv8g
SUSBJuKw4w2OnL4fn8lhqnQgYHUVkcYBtfYii6E9bEVAIPoaT+4gvdSg9zkF6cza
Da8SXkEY2ysaX+A24iVnCNMpCMSOUOxWsFFvkCcfi8A4HxGGqWzVOsBbDJKjktS1
g6FyeqWsGh9QG/CPYeMN7LB7lW1l2XzO6GQ9QR1rzU/whgUVxprkye5wx2BaQmom
rrWVHBijH1cNWd1IbryAm+prduL1l/CNR0785ZPTjB3SsMFPCAtRHf9G976rqVs0
P3jGg+BdeDj+sd3EFHcHnNXQOaETgR07RWzngbjEkgmJYhB2B43hCQ2LwsNlHsmg
O6otUI2k274IF9KHh0T1h1hopbUTU8VPy3dpcLloCzk7KiAv1RI=
=4ExT
-----END PGP SIGNATURE-----

```

---


