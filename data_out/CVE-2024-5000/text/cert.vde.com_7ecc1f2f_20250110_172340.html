

* English
* Deutsch

Everything
Advisories

Blog posts

Bulletins

Cves

Pages

Toggle navigation

Everything
Advisories

Blog posts

Bulletins

Cves

Pages

* |
* [News](/en/blog/)
* |
* [Advisories](/en/advisories/)
* |
* [CNA](/en/cna/)
* |
* [Bulletins](/en/bulletins/)
* |
* [Events](/en/events/)
* |
* [More](/en/more/)
  + [Report a Vulnerability](/en/more/report-a-vulnerability/)
  + [Knowledgebase](/en/more/knowledgebase/)
    - [Guides](/en/more/knowledgebase/psirt-guides/)
    - [Reading Room](/en/more/knowledgebase/reading-room/)
  + [About us](/en/more/certvde/)
    - [RFC2350](/en/more/certvde/rfc2350/)
    - [Disclosure Policy](/en/more/certvde/disclosure-policy/)
    - [Guidelines and Compliance](/en/more/certvde/guidelines-and-compliance/)
    - [Contact](/en/more/certvde/contact/)
  + [Our Partners](/en/more/our-partners/)

* [← VDE-2024-028](/en/advisories/VDE-2024-028/ "ifm: moneo password reset can be exploited")
* [VDE-2024-029 →](/en/advisories/VDE-2024-029/ "Phoenix Contact: Unbounded growth of OpenSSL session cache in multiple FL MGUARD devices")

2024-06-04 08:00 (CEST)
VDE-2024-026

### CODESYS: Vulnerability can cause a DoS on CODESYS OPC UA products

Share:
Email |
[Twitter](https://twitter.com/intent/tweet?url=https://cert.vde.com/en/advisories/VDE-2024-026/&text=CERT@VDE has released a new advisory: VDE-2024-026: CODESYS%3A%20Vulnerability%20can%20cause%20a%20DoS%20on%20CODESYS%20OPC%20UA%20products)

#### ID

VDE-2024-026

#### Published

2024-06-04 08:00 (CEST)

#### Last update

2024-07-10 08:37 (CEST)

#### Vendor(s)

CODESYS GmbH

#### Product(s)

| Article No° | Product Name | Affected Version(s) |
| --- | --- | --- |
|  | CODESYS Control for BeagleBone SL | < 4.12.0.0 |
|  | CODESYS Control for emPC-A/iMX6 SL | < 4.12.0.0 |
|  | CODESYS Control for IOT2000 SL | < 4.12.0.0 |
|  | CODESYS Control for Linux ARM SL | < 4.12.0.0 |
|  | CODESYS Control for Linux SL | < 4.12.0.0 |
|  | CODESYS Control for PFC100 SL | < 4.12.0.0 |
|  | CODESYS Control for PFC200 SL | < 4.12.0.0 |
|  | CODESYS Control for PLCnext SL | < 4.12.0.0 |
|  | CODESYS Control for Raspberry Pi SL | < 4.12.0.0 |
|  | CODESYS Control for WAGO Touch Panels 600 SL | < 4.12.0.0 |
|  | CODESYS Control RTE (for Beckhoff CX) SL | < 3.5.20.10 |
|  | CODESYS Control RTE (SL) | < 3.5.20.10 |
|  | CODESYS Control Win (SL) | < 3.5.20.10 |
|  | CODESYS HMI (SL) | < 3.5.20.10 |
|  | CODESYS Runtime Toolkit | < 3.5.20.10 |

#### Summary

The CODESYS OPC UA stack of the CODESYS Control runtime system may incorrectly calculate the required buffer size for received requests/responses. This can lead to a crash of the CODESYS runtime system during the subsequent initialization of the receive buffer with zero.

Update: 10.07.2024 In the Remediation section, the release date of the update has been deleted as the update is now available.

---

#### CVE ID

[CVE-2024-5000](https://cert.vde.com/en/advisories/weakness/CVE-2024-5000)

#### Last Update:

Aug. 30, 2024, 9:24 a.m.

#### Severity

7.5

[(CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H&version=3.1)

#### Weakness

Incorrect Calculation of Buffer Size [(CWE-131)](https://cwe.mitre.org/data/definitions/131.html)

#### Summary

An unauthenticated remote attacker can use a malicious OPC UA client to send a crafted request to affected CODESYS products which can cause a DoS due to incorrect calculation of buffer size.

#### Details

[cert.vde.com](https://cert.vde.com/en/advisories/weakness/CVE-2024-5000)

---

#### Impact

The CODESYS OPC UA stack, implemented by the CmpOPCUAStack component, is an optional part of the CODESYS runtime system. Both the CODESYS OPC UA Server and the CODESYS OPC UA Client of the CODESYS Control runtime system use the CODESYS OPC UA Stack as a common implementation. The OPC UA protocol enables data exchange between the CODESYS runtime system and OPC UA clients such as SCADA or HMIs, or OPC UA servers such as PLCs or other devices.

If a CODESYS runtime system containing the CmpOPCUAStack component receives a specially crafted request/response, the required buffer size in the CODESYS OPC UA server/client may be incorrectly calculated. This can lead to a crash of the CODESYS runtime system during the subsequent initialization of the receive buffer with zero.

An attacker can exploit this vulnerability by using a malicious OPC UA client to send a crafted request to CODESYS products with an affected CODESYS OPC UA server. Conversely, CODESYS products with an affected CODESYS OPC UA client can be crashed if they have connected to a malicious OPC UA server. CODESYS Control runtime systems usually contain both the OPC UA client and the server. The CODESYS HMI only includes the OPC UA client.

#### Solution

**Mitigation**

Starting from version 3.5.15.0 of the affected products, the incorrect calculation of the buffer size can be avoided if the maximum supported array length of the OPC UA stack of the CODESYS Control runtime system is limited to a value of 10129639 or less.

This can be achieved by adding the following setting in the CODESYS runtime configuration file (e.g. CODESYSControl.cfg):
[CmpOPCUAStack]
Stack.MaxArrayLenth=10129639

**Remediation**

Update the following products to version 3.5.20.10.

* CODESYS Control RTE (SL)
* CODESYS Control RTE (for Beckhoff CX) SL
* CODESYS Control Win (SL)
* CODESYS Runtime Toolkit
* CODESYS HMI (SL)

Update the following products to version 4.12.0.0.

* CODESYS Control for BeagleBone SL
* CODESYS Control for emPC-A/iMX6 SL
* CODESYS Control for IOT2000 SL
* CODESYS Control for Linux ARM SL
* CODESYS Control for Linux SL
* CODESYS Control for PFC100 SL
* CODESYS Control for PFC200 SL
* CODESYS Control for PLCnext SL
* CODESYS Control for Raspberry Pi SL
* CODESYS Control for WAGO Touch Panels 600 SL

The products available as CODESYS add-ons can be downloaded and installed directly with the CODESYS Installer or be downloaded from the CODESYS Store. Alternatively, as well as for all other products, you will find further information on obtaining the software update in the CODESYS download area.

#### Reported by

CERT@VDE coordinated with CODESYS

This issue was reported by ABB Schweiz AG.

## Member of

[![](/static/img/member/cert_verbund.png)](https://www.cert-verbund.de/)

[![](/static/img/member/ti.png)](https://www.trusted-introducer.org/directory/teams/vde.html)

[![](/static/img/member/allianz_fcs.png)](https://www.allianz-fuer-cybersicherheit.de/)

[![](/static/img/member/ama.png)](https://www.ama-sensorik.de/)

---

[Contact](/more/certvde/contact) |
[Imprint](https://www.vde.com/en/legal-notice)
| [Privacy Statement](/more/certvde/privacy-statement) | [Data Protection Notice](/more/certvde/data-protection-notice)

