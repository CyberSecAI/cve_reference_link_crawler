
            Commit Information:
            ------------------
            Author: Yanting Yang <yantingyang@google.com> 1659463330 +0800
            Date: Yanting Yang <yantingyang@google.com> 1660307148 +0000
            Bug ID: Bug: 238745070

            Commit Message:
            --------------
            Check DISALLOW_APPS_CONTROL before performing reset app preferencesWhen DISALLOW_APPS_CONTROL restriction is enabled, users should not beable to enable/disable apps, clear app caches and clear app data.The function of reset app preferences will re-enable the disabled apps,it can let users bypass DISALLOW_APPS_CONTROL to enable an app disabledby IT admin to see sensitive information.To fix this vulnerability, we add a check for DISALLOW_APPS_CONTROLrestriction before users reset app preferences. Once the restriction isenabled, it will show dialog “Blocked by your IT admin” instead.Bug: 238745070Test: Verify change by turning on/off DISALLOW_APPS_CONTROL with TestDPC.Change-Id: Iffee73cf4952b686a78b4c7aaa54747971337d03(cherry picked from commit 4356c9c65361481db16c393906bf46d8a0d44ef7)
            