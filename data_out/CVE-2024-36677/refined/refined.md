- **Root cause of vulnerability**: The `ajax.php` script in the "Login as customer PRO" module allows the exfiltration of direct links to connect to any customer account. This occurs if the module is not installed, or if a secret token (`LOGINASCUSTOMERPRO_TOKEN`) is missing or empty, or if an attacker obtains the secret token.
- **Weaknesses/vulnerabilities present**:
    - Exposure of sensitive information (customer account login links) due to insecure access control in `ajax.php`.
    - Insufficient protection of the secret token used for authentication.
    - The vulnerability is associated with CWE-359, which refers to "Exposure of Private Personal Information to an Unauthorized Actor".
- **Impact of exploitation**:
    - Unauthorized access to customer accounts.
    - Stealing of personal data from customer accounts.
- **Attack vectors**: Network-based attacks through the vulnerable `ajax.php` script.
- **Required attacker capabilities/position**:
    - No specific privileges are needed.
    - No user interaction is needed.
    - An attacker needs to access the `ajax.php` file over the network. The attacker would not need any special access if the module is not installed or if the token is missing or empty. If the token exists, an attacker needs to gain access to the token somehow.