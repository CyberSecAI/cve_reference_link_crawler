

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20869)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20869)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-20869](/browse/XWIKI-20869)

# Users can be tricked to execute scripts as the create action doesn't display the page's title

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-20869 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [15.5-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.5-rc-1 "15.5-rc-1 "), [14.10.12](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.12 "14.10.12 ")
* **Affects Version/s:**
  7.2-milestone-2
* **Component/s:**
  [Web - Templates & Resources](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Web+-+Templates+%26+Resources%22 "Web - Templates & Resources ")
* **Labels:**
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attacker\_edit](/issues/?jql=labels+%3D+attacker_edit "attacker_edit")
  + [attacker\_socialeng](/issues/?jql=labels+%3D+attacker_socialeng "attacker_socialeng")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce:**

1. Get a victim with script or programming right to open <xwiki-host>/xwiki/bin/create/NonExistingSpace/WebHome?title=$services.logging.getLogger(%22foo%22).error(%22Script%20executed!%22) where <xwiki-host> where is the URL of your XWiki installation, making the victim think that this URL should be used to create a document (e.g., by faking a create button). Get the victim to click on the create button on that screen.

**Expected result:**

The victim sees the malicious title such that the victim can correct it before it is executed (or just close the browser's tab).

**Actual result:**

The title is not displayed in the create action, only in the edit action - and at that point, the code has already been executed, demonstrated by a log message with content "Script executed!" in this case. The script execution could easily be used to redirect the victim to another URL to hide the attack. If the victim has programming right, this gives full remote code execution with programming rights.

From what I can see, [~~XWIKI-12316~~](https://jira.xwiki.org/browse/XWIKI-12316 "The Create UI still asking for document location for a top-level space WebHome") is the first change where inputs were hidden while creating documents, thus making this attack possible (in these versions, the name was used as title without escaping from what I can see). This gives a likely affects version of 7.2-milestone-2. The title parameter that is exploited here was introduced in [~~XWIKI-12231~~](https://jira.xwiki.org/browse/XWIKI-12231 "Add support for Nested Documents in the Create UI"), so in 7.2-milestone-3 this is also exploitable with the title parameter.

#### Attachments

#### Issue Links

causes

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-22659](/browse/XWIKI-22659)
createinline template error when clicking on a link to missing top level page

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Security Advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-ghf6-2f42-mjh9)

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

24/Apr/23 18:05

Updated:

14/Nov/24 17:14

Resolved:

31/May/23 14:26

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

