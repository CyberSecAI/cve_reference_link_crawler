

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21769)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21769)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-21769](/browse/XWIKI-21769)

# Self XSS in the attached filename

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21769 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Duplicate
* **Priority:**
  ![](/images/icons/priorities/major.svg "Major - Major loss of function.") Major
* **Fix Version/s:**
  None
* **Affects Version/s:**
  None
* **Component/s:**
  [Web - Templates & Resources](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Web+-+Templates+%26+Resources%22 "Web - Templates & Resources ")
* **Labels:**
  + [attack\_xss](/issues/?jql=labels+%3D+attack_xss "attack_xss")
  + [attacker\_socialeng](/issues/?jql=labels+%3D+attacker_socialeng "attacker_socialeng")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Difficulty:**
  Unknown
* **Similar issues:**

#### Description

An attacker can convince a victim to upload an attachment with a malicious  filename in order to trigger an XSS vulnerability.

Below is a detailed replication guide.

1. Login in the XWiki instance and go to the following path `/bin/view/Main/#Attachments` and click on the **Browse** button. ![](/secure/attachment/42178/42178_image-2024-01-08-13-13-55-687.png)

2. Upload a file with the following filename ***"><img src=x onerror='alert(1)'>.txt*** and it is going to trigger an XSS vulnerability

![](/secure/attachment/42177/42177_image-2024-01-08-13-17-59-614.png)

![](/secure/attachment/42176/42176_image-2024-01-08-13-19-14-017.png)

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-21769?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-21769?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-21769?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-21769?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-21769?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-21769?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/72999.zip "Download all attachments as a ZIP file")

1. [![image-2024-01-08-13-13-55-687.png](https://jira.xwiki.org/secure/thumbnail/42178/_thumb_42178.png)](/secure/attachment/42178/image-2024-01-08-13-13-55-687.png "image-2024-01-08-13-13-55-687.png - Latest 08/Jan/24 12:13 - Georgios Roumeliotis")[image-2024-01-08-13-13-55-687.png](/secure/attachment/42178/image-2024-01-08-13-13-55-687.png "image-2024-01-08-13-13-55-687.png - Latest 08/Jan/24 12:13 - Georgios Roumeliotis")155 kB08/Jan/24 12:13
2. [![image-2024-01-08-13-17-59-614.png](https://jira.xwiki.org/secure/thumbnail/42177/_thumb_42177.png)](/secure/attachment/42177/image-2024-01-08-13-17-59-614.png "image-2024-01-08-13-17-59-614.png - Latest 08/Jan/24 12:18 - Georgios Roumeliotis")[image-2024-01-08-13-17-59-614.png](/secure/attachment/42177/image-2024-01-08-13-17-59-614.png "image-2024-01-08-13-17-59-614.png - Latest 08/Jan/24 12:18 - Georgios Roumeliotis")100 kB08/Jan/24 12:18
3. [![image-2024-01-08-13-19-14-017.png](https://jira.xwiki.org/secure/thumbnail/42176/_thumb_42176.png)](/secure/attachment/42176/image-2024-01-08-13-19-14-017.png "image-2024-01-08-13-19-14-017.png - Latest 08/Jan/24 12:19 - Georgios Roumeliotis")[image-2024-01-08-13-19-14-017.png](/secure/attachment/42176/image-2024-01-08-13-19-14-017.png "image-2024-01-08-13-19-14-017.png - Latest 08/Jan/24 12:19 - Georgios Roumeliotis")142 kB08/Jan/24 12:19
#### Issue Links

duplicates

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19611](/browse/XWIKI-19611)
XSS through attachment filename in uploader

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Closed

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![groumeliotis](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Georgios Roumeliotis

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

08/Jan/24 12:19

Updated:

10/Dec/24 17:10

Resolved:

08/Jan/24 17:11

Date of First Response:

08/Jan/24 5:11 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

