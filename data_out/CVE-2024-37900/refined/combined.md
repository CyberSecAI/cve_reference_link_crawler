=== Content from github.com_a03c4910_20250111_063850.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F910a5018a50039e8b24556573dfe342f143ef949)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F910a5018a50039e8b24556573dfe342f143ef949)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  553](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  134](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-19611: Improve filename escaping in attachment upload

[Browse files](/xwiki/xwiki-platform/tree/910a5018a50039e8b24556573dfe342f143ef949)
Browse the repository at this point in the history

```
* Use escapeHTML() when displaying filenames in upload.js
* Add a test in AttachmentIT to check for proper HTML escaping during upload
```

* Loading branch information

[![@pjeanjean](https://avatars.githubusercontent.com/u/7363343?s=40&v=4)](/pjeanjean) [![@michitux](https://avatars.githubusercontent.com/u/198317?s=40&v=4)](/michitux)

[pjeanjean](/xwiki/xwiki-platform/commits?author=pjeanjean "View all commits by pjeanjean")
authored and
[michitux](/xwiki/xwiki-platform/commits?author=michitux "View all commits by michitux")
committed
Jan 24, 2024

1 parent
[f89c8f4](/xwiki/xwiki-platform/commit/f89c8f47fad6e5cc7e68c69a7e0acde07f5eed5a)

commit 910a501

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**26 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* xwiki-platform-core

  + xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test

    - it/org/xwiki/flamingo/test/docker

      * xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java
        [AttachmentIT.java](#diff-3f54b635e0300e2d82e74b264fc20f33d6a225d08b396c4149f278ad3901308a)
    - resources/AttachmentIT

      * xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt
        [<strong>EscapedAttachment.txt](#diff-fd94a7b27be0c5d227c377164f2197b41a47771f70ae83788e1fa904073c10d9)
  + xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets

    - xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js
      [upload.js](#diff-4590d3dba2eef80ef75b3f5f1390a6ea4fa277fb0fa01c613934fcf25deedec3)

## There are no files selected for viewing

19 changes: 19 additions & 0 deletions

19
[...rm-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java](#diff-3f54b635e0300e2d82e74b264fc20f33d6a225d08b396c4149f278ad3901308a "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/910a5018a50039e8b24556573dfe342f143ef949/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -65,6 +65,8 @@ class AttachmentIT |
|  |  |  |
|  |  | private static final String SECOND\_ATTACHMENT = "SmallAttachment2.txt"; |
|  |  |  |
|  |  | private static final String ESCAPED\_ATTACHMENT = "<strong>EscapedAttachment.txt"; |
|  |  |  |
|  |  | private static final String IMAGE\_ATTACHMENT = "image.gif"; |
|  |  |  |
|  |  | private static final String SMALL\_SIZE\_ATTACHMENT = "SmallSizeAttachment.png"; |
| Expand Down  Expand Up | | @@ -441,6 +443,23 @@ void deleteAttachmentWithSpecialChar(TestUtils setup, TestReference testReferenc |
|  |  | basePage.getXWikiMessageContent()); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | @Order(9) |
|  |  | void checkEscapingInAttachmentName(TestUtils setup, TestReference testReference, |
|  |  | TestConfiguration testConfiguration) |
|  |  | { |
|  |  | setup.loginAsSuperAdmin(); |
|  |  | setup.createPage(testReference, "Empty content"); |
|  |  | AttachmentsPane attachmentsPane = new AttachmentsViewPage().openAttachmentsDocExtraPane(); |
|  |  |  |
|  |  | attachmentsPane.setFileToUpload(getFileToUpload(testConfiguration, ESCAPED\_ATTACHMENT).getAbsolutePath()); |
|  |  | attachmentsPane.waitForUploadToFinish(ESCAPED\_ATTACHMENT); |
|  |  | attachmentsPane.clickHideProgress(); |
|  |  |  |
|  |  | assertTrue(attachmentsPane.attachmentExistsByFileName(ESCAPED\_ATTACHMENT)); |
|  |  | attachmentsPane.deleteAttachmentByFileByName(ESCAPED\_ATTACHMENT); |
|  |  | } |
|  |  |  |
|  |  | private String getAttachmentsMacroContent(DocumentReference docRef) |
|  |  | { |
|  |  | StringBuilder sb = new StringBuilder(); |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[...m-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt](#diff-fd94a7b27be0c5d227c377164f2197b41a47771f70ae83788e1fa904073c10d9 "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt")

Show comments

[View file](/xwiki/xwiki-platform/blob/910a5018a50039e8b24556573dfe342f143ef949/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/%3Cstrong%3EEscapedAttachment.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1 @@ |
|  |  | This is an attachment whose name should be escaped. |

11 changes: 6 additions & 5 deletions

11
[...tform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js](#diff-4590d3dba2eef80ef75b3f5f1390a6ea4fa277fb0fa01c613934fcf25deedec3 "xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js")

Show comments

[View file](/xwiki/xwiki-platform/blob/910a5018a50039e8b24556573dfe342f143ef949/xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -124,7 +124,7 @@ var XWiki = (function(XWiki) { |
|  |  |  |
|  |  | if (this.options.enableFileInfo) { |
|  |  | statusUI.FILE\_INFO = UploadUtils.createDiv('file-info'); |
|  |  | (statusUI.FILE\_NAME = UploadUtils.createSpan('file-name', this.file.name)).title = this.file.type; |
|  |  | (statusUI.FILE\_NAME = UploadUtils.createSpan('file-name', this.file.name.escapeHTML())).title = this.file.type; |
|  |  | statusUI.FILE\_SIZE = UploadUtils.createSpan('file-size', ' (' + UploadUtils.bytesToSize(this.file.size) + ')'); |
|  |  | statusUI.FILE\_CANCEL = UploadUtils.createButton("$services.localization.render('core.widgets.html5upload.item.cancel')", this.cancelUpload.bindAsEventListener(this)); |
|  |  | // TODO MIME type icon? |
| Expand Down  Expand Up | | @@ -295,7 +295,7 @@ var XWiki = (function(XWiki) { |
|  |  | this.statusUI.FILE\_CANCEL.addClassName('hidden'); |
|  |  | } |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: 'UPLOAD\_FINISHING', type: 'inprogress', source: this, |
|  |  | parameters : {name : this.file.name} |
|  |  | parameters : {name : this.file.name.escapeHTML()} |
|  |  | }); |
|  |  | }, |
|  |  |  |
| Expand Down  Expand Up | | @@ -324,7 +324,7 @@ var XWiki = (function(XWiki) { |
|  |  | } |
|  |  | } |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: 'UPLOAD\_FINISHED', type: 'done', source: this, |
|  |  | parameters : {name : this.file.name, size : UploadUtils.bytesToSize(this.file.size)} |
|  |  | parameters : {name : this.file.name.escapeHTML(), size : UploadUtils.bytesToSize(this.file.size)} |
|  |  | }); |
|  |  | this.formData.input.fire('xwiki:html5upload:fileFinished', {source: this}); |
|  |  | clearInterval(this.timer); |
| Expand Down  Expand Up | | @@ -354,7 +354,8 @@ var XWiki = (function(XWiki) { |
|  |  | \*/ |
|  |  | abnormalUploadFinish : function (message) { |
|  |  | clearInterval(this.timer); |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: message, type: 'error', source: this, parameters : {name : this.file.name}}); |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: message, type: 'error', source: this, parameters : |
|  |  | {name : this.file.name.escapeHTML()}}); |
|  |  | this.formData.input.fire('xwiki:html5upload:fileFinished', {source: this}); |
|  |  | } |
|  |  | }); |
| Expand Down  Expand Up | | @@ -517,7 +518,7 @@ var XWiki = (function(XWiki) { |
|  |  | } |
|  |  | } catch (ex) { |
|  |  | this.showMessage(ex, 'error', {size : UploadUtils.bytesToSize(this.options && this.options.maxFilesize), |
|  |  | name : file.name, type: file.type |
|  |  | name : file.name.escapeHTML(), type: file.type |
|  |  | }); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `910a501`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F910a5018a50039e8b24556573dfe342f143ef949) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d7f5c559_20250111_063850.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F8b8a2d80529b9a9c038014c1eb6c2adc08069dfd)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F8b8a2d80529b9a9c038014c1eb6c2adc08069dfd)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  553](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  134](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-19611: Improve filename escaping in attachment upload

[Browse files](/xwiki/xwiki-platform/tree/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd)
Browse the repository at this point in the history

```
* Use escapeHTML() when displaying filenames in upload.js
* Add a test in AttachmentIT to check for proper HTML escaping during upload

(cherry picked from commit [910a501](https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949))
```

* Loading branch information

[![@pjeanjean](https://avatars.githubusercontent.com/u/7363343?s=40&v=4)](/pjeanjean) [![@michitux](https://avatars.githubusercontent.com/u/198317?s=40&v=4)](/michitux)

[pjeanjean](/xwiki/xwiki-platform/commits?author=pjeanjean "View all commits by pjeanjean")
authored and
[michitux](/xwiki/xwiki-platform/commits?author=michitux "View all commits by michitux")
committed
Jan 24, 2024

1 parent
[bb232dd](/xwiki/xwiki-platform/commit/bb232dd3e5cd72a26599dc12880d815e67965fd2)

commit 8b8a2d8

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**26 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* xwiki-platform-core

  + xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test

    - it/org/xwiki/flamingo/test/docker

      * xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java
        [AttachmentIT.java](#diff-3f54b635e0300e2d82e74b264fc20f33d6a225d08b396c4149f278ad3901308a)
    - resources/AttachmentIT

      * xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt
        [<strong>EscapedAttachment.txt](#diff-fd94a7b27be0c5d227c377164f2197b41a47771f70ae83788e1fa904073c10d9)
  + xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets

    - xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js
      [upload.js](#diff-4590d3dba2eef80ef75b3f5f1390a6ea4fa277fb0fa01c613934fcf25deedec3)

## There are no files selected for viewing

19 changes: 19 additions & 0 deletions

19
[...rm-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java](#diff-3f54b635e0300e2d82e74b264fc20f33d6a225d08b396c4149f278ad3901308a "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -65,6 +65,8 @@ class AttachmentIT |
|  |  |  |
|  |  | private static final String SECOND\_ATTACHMENT = "SmallAttachment2.txt"; |
|  |  |  |
|  |  | private static final String ESCAPED\_ATTACHMENT = "<strong>EscapedAttachment.txt"; |
|  |  |  |
|  |  | private static final String IMAGE\_ATTACHMENT = "image.gif"; |
|  |  |  |
|  |  | private static final String SMALL\_SIZE\_ATTACHMENT = "SmallSizeAttachment.png"; |
| Expand Down  Expand Up | | @@ -441,6 +443,23 @@ void deleteAttachmentWithSpecialChar(TestUtils setup, TestReference testReferenc |
|  |  | basePage.getXWikiMessageContent()); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | @Order(9) |
|  |  | void checkEscapingInAttachmentName(TestUtils setup, TestReference testReference, |
|  |  | TestConfiguration testConfiguration) |
|  |  | { |
|  |  | setup.loginAsSuperAdmin(); |
|  |  | setup.createPage(testReference, "Empty content"); |
|  |  | AttachmentsPane attachmentsPane = new AttachmentsViewPage().openAttachmentsDocExtraPane(); |
|  |  |  |
|  |  | attachmentsPane.setFileToUpload(getFileToUpload(testConfiguration, ESCAPED\_ATTACHMENT).getAbsolutePath()); |
|  |  | attachmentsPane.waitForUploadToFinish(ESCAPED\_ATTACHMENT); |
|  |  | attachmentsPane.clickHideProgress(); |
|  |  |  |
|  |  | assertTrue(attachmentsPane.attachmentExistsByFileName(ESCAPED\_ATTACHMENT)); |
|  |  | attachmentsPane.deleteAttachmentByFileByName(ESCAPED\_ATTACHMENT); |
|  |  | } |
|  |  |  |
|  |  | private String getAttachmentsMacroContent(DocumentReference docRef) |
|  |  | { |
|  |  | StringBuilder sb = new StringBuilder(); |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[...m-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt](#diff-fd94a7b27be0c5d227c377164f2197b41a47771f70ae83788e1fa904073c10d9 "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt")

Show comments

[View file](/xwiki/xwiki-platform/blob/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/%3Cstrong%3EEscapedAttachment.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1 @@ |
|  |  | This is an attachment whose name should be escaped. |

11 changes: 6 additions & 5 deletions

11
[...tform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js](#diff-4590d3dba2eef80ef75b3f5f1390a6ea4fa277fb0fa01c613934fcf25deedec3 "xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js")

Show comments

[View file](/xwiki/xwiki-platform/blob/8b8a2d80529b9a9c038014c1eb6c2adc08069dfd/xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -124,7 +124,7 @@ var XWiki = (function(XWiki) { |
|  |  |  |
|  |  | if (this.options.enableFileInfo) { |
|  |  | statusUI.FILE\_INFO = UploadUtils.createDiv('file-info'); |
|  |  | (statusUI.FILE\_NAME = UploadUtils.createSpan('file-name', this.file.name)).title = this.file.type; |
|  |  | (statusUI.FILE\_NAME = UploadUtils.createSpan('file-name', this.file.name.escapeHTML())).title = this.file.type; |
|  |  | statusUI.FILE\_SIZE = UploadUtils.createSpan('file-size', ' (' + UploadUtils.bytesToSize(this.file.size) + ')'); |
|  |  | statusUI.FILE\_CANCEL = UploadUtils.createButton("$services.localization.render('core.widgets.html5upload.item.cancel')", this.cancelUpload.bindAsEventListener(this)); |
|  |  | // TODO MIME type icon? |
| Expand Down  Expand Up | | @@ -295,7 +295,7 @@ var XWiki = (function(XWiki) { |
|  |  | this.statusUI.FILE\_CANCEL.addClassName('hidden'); |
|  |  | } |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: 'UPLOAD\_FINISHING', type: 'inprogress', source: this, |
|  |  | parameters : {name : this.file.name} |
|  |  | parameters : {name : this.file.name.escapeHTML()} |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F8b8a2d80529b9a9c038014c1eb6c2adc08069dfd)       Sorry, something went wrong.           Copy link    Quote reply     @mflorea **[mflorea](/mflorea)** [Oct 23, 2024](#r148258790) Member   I find it strange to escape the file name as HTML in the event data, as if any code that will listen to this event will inject the file name in the HTML. You don't know this. I'd rather escape the file name in the places where it is injected in HTML.      All reactions | | |
|  |  | }); |
|  |  | }, |
|  |  |  |
| Expand Down  Expand Up | | @@ -324,7 +324,7 @@ var XWiki = (function(XWiki) { |
|  |  | } |
|  |  | } |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: 'UPLOAD\_FINISHED', type: 'done', source: this, |
|  |  | parameters : {name : this.file.name, size : UploadUtils.bytesToSize(this.file.size)} |
|  |  | parameters : {name : this.file.name.escapeHTML(), size : UploadUtils.bytesToSize(this.file.size)} |
|  |  | }); |
|  |  | this.formData.input.fire('xwiki:html5upload:fileFinished', {source: this}); |
|  |  | clearInterval(this.timer); |
| Expand Down  Expand Up | | @@ -354,7 +354,8 @@ var XWiki = (function(XWiki) { |
|  |  | \*/ |
|  |  | abnormalUploadFinish : function (message) { |
|  |  | clearInterval(this.timer); |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: message, type: 'error', source: this, parameters : {name : this.file.name}}); |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: message, type: 'error', source: this, parameters : |
|  |  | {name : this.file.name.escapeHTML()}}); |
|  |  | this.formData.input.fire('xwiki:html5upload:fileFinished', {source: this}); |
|  |  | } |
|  |  | }); |
| Expand Down  Expand Up | | @@ -517,7 +518,7 @@ var XWiki = (function(XWiki) { |
|  |  | } |
|  |  | } catch (ex) { |
|  |  | this.showMessage(ex, 'error', {size : UploadUtils.bytesToSize(this.options && this.options.maxFilesize), |
|  |  | name : file.name, type: file.type |
|  |  | name : file.name.escapeHTML(), type: file.type |
|  |  | }); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8b8a2d8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F8b8a2d80529b9a9c038014c1eb6c2adc08069dfd) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_89cd9294_20250111_063852.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F9df46f8e5313af46f93bccd1ebc682e28126573f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F9df46f8e5313af46f93bccd1ebc682e28126573f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  553](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  134](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/9df46f8e5313af46f93bccd1ebc682e28126573f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-19611: Improve filename escaping in attachment upload

[Browse files](/xwiki/xwiki-platform/tree/9df46f8e5313af46f93bccd1ebc682e28126573f)
Browse the repository at this point in the history

```
* Use escapeHTML() when displaying filenames in upload.js
* Add a test in AttachmentIT to check for proper HTML escaping during upload

(cherry picked from commit [910a501](https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949))
```

* Loading branch information

[![@pjeanjean](https://avatars.githubusercontent.com/u/7363343?s=40&v=4)](/pjeanjean) [![@michitux](https://avatars.githubusercontent.com/u/198317?s=40&v=4)](/michitux)

[pjeanjean](/xwiki/xwiki-platform/commits?author=pjeanjean "View all commits by pjeanjean")
authored and
[michitux](/xwiki/xwiki-platform/commits?author=michitux "View all commits by michitux")
committed
Jan 24, 2024

1 parent
[53d22f4](/xwiki/xwiki-platform/commit/53d22f410bb8d936bf3a900c908d2f72cb428c60)

commit 9df46f8

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**26 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* xwiki-platform-core

  + xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test

    - it/org/xwiki/flamingo/test/docker

      * xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java
        [AttachmentIT.java](#diff-3f54b635e0300e2d82e74b264fc20f33d6a225d08b396c4149f278ad3901308a)
    - resources/AttachmentIT

      * xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt
        [<strong>EscapedAttachment.txt](#diff-fd94a7b27be0c5d227c377164f2197b41a47771f70ae83788e1fa904073c10d9)
  + xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets

    - xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js
      [upload.js](#diff-4590d3dba2eef80ef75b3f5f1390a6ea4fa277fb0fa01c613934fcf25deedec3)

## There are no files selected for viewing

19 changes: 19 additions & 0 deletions

19
[...rm-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java](#diff-3f54b635e0300e2d82e74b264fc20f33d6a225d08b396c4149f278ad3901308a "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/9df46f8e5313af46f93bccd1ebc682e28126573f/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -65,6 +65,8 @@ class AttachmentIT |
|  |  |  |
|  |  | private static final String SECOND\_ATTACHMENT = "SmallAttachment2.txt"; |
|  |  |  |
|  |  | private static final String ESCAPED\_ATTACHMENT = "<strong>EscapedAttachment.txt"; |
|  |  |  |
|  |  | private static final String IMAGE\_ATTACHMENT = "image.gif"; |
|  |  |  |
|  |  | private static final String SMALL\_SIZE\_ATTACHMENT = "SmallSizeAttachment.png"; |
| Expand Down  Expand Up | | @@ -446,6 +448,23 @@ void deleteAttachmentWithSpecialChar(TestUtils setup, TestReference testReferenc |
|  |  | basePage.getXWikiMessageContent()); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | @Order(9) |
|  |  | void checkEscapingInAttachmentName(TestUtils setup, TestReference testReference, |
|  |  | TestConfiguration testConfiguration) |
|  |  | { |
|  |  | setup.loginAsSuperAdmin(); |
|  |  | setup.createPage(testReference, "Empty content"); |
|  |  | AttachmentsPane attachmentsPane = new AttachmentsViewPage().openAttachmentsDocExtraPane(); |
|  |  |  |
|  |  | attachmentsPane.setFileToUpload(getFileToUpload(testConfiguration, ESCAPED\_ATTACHMENT).getAbsolutePath()); |
|  |  | attachmentsPane.waitForUploadToFinish(ESCAPED\_ATTACHMENT); |
|  |  | attachmentsPane.clickHideProgress(); |
|  |  |  |
|  |  | assertTrue(attachmentsPane.attachmentExistsByFileName(ESCAPED\_ATTACHMENT)); |
|  |  | attachmentsPane.deleteAttachmentByFileByName(ESCAPED\_ATTACHMENT); |
|  |  | } |
|  |  |  |
|  |  | private String getAttachmentsMacroContent(DocumentReference docRef) |
|  |  | { |
|  |  | StringBuilder sb = new StringBuilder(); |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[...m-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt](#diff-fd94a7b27be0c5d227c377164f2197b41a47771f70ae83788e1fa904073c10d9 "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt")

Show comments

[View file](/xwiki/xwiki-platform/blob/9df46f8e5313af46f93bccd1ebc682e28126573f/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/%3Cstrong%3EEscapedAttachment.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1 @@ |
|  |  | This is an attachment whose name should be escaped. |

11 changes: 6 additions & 5 deletions

11
[...tform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js](#diff-4590d3dba2eef80ef75b3f5f1390a6ea4fa277fb0fa01c613934fcf25deedec3 "xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js")

Show comments

[View file](/xwiki/xwiki-platform/blob/9df46f8e5313af46f93bccd1ebc682e28126573f/xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -124,7 +124,7 @@ var XWiki = (function(XWiki) { |
|  |  |  |
|  |  | if (this.options.enableFileInfo) { |
|  |  | statusUI.FILE\_INFO = UploadUtils.createDiv('file-info'); |
|  |  | (statusUI.FILE\_NAME = UploadUtils.createSpan('file-name', this.file.name)).title = this.file.type; |
|  |  | (statusUI.FILE\_NAME = UploadUtils.createSpan('file-name', this.file.name.escapeHTML())).title = this.file.type; |
|  |  | statusUI.FILE\_SIZE = UploadUtils.createSpan('file-size', ' (' + UploadUtils.bytesToSize(this.file.size) + ')'); |
|  |  | statusUI.FILE\_CANCEL = UploadUtils.createButton("$services.localization.render('core.widgets.html5upload.item.cancel')", this.cancelUpload.bindAsEventListener(this)); |
|  |  | // TODO MIME type icon? |
| Expand Down  Expand Up | | @@ -295,7 +295,7 @@ var XWiki = (function(XWiki) { |
|  |  | this.statusUI.FILE\_CANCEL.addClassName('hidden'); |
|  |  | } |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: 'UPLOAD\_FINISHING', type: 'inprogress', source: this, |
|  |  | parameters : {name : this.file.name} |
|  |  | parameters : {name : this.file.name.escapeHTML()} |
|  |  | }); |
|  |  | }, |
|  |  |  |
| Expand Down  Expand Up | | @@ -324,7 +324,7 @@ var XWiki = (function(XWiki) { |
|  |  | } |
|  |  | } |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: 'UPLOAD\_FINISHED', type: 'done', source: this, |
|  |  | parameters : {name : this.file.name, size : UploadUtils.bytesToSize(this.file.size)} |
|  |  | parameters : {name : this.file.name.escapeHTML(), size : UploadUtils.bytesToSize(this.file.size)} |
|  |  | }); |
|  |  | this.formData.input.fire('xwiki:html5upload:fileFinished', {source: this}); |
|  |  | clearInterval(this.timer); |
| Expand Down  Expand Up | | @@ -354,7 +354,8 @@ var XWiki = (function(XWiki) { |
|  |  | \*/ |
|  |  | abnormalUploadFinish : function (message) { |
|  |  | clearInterval(this.timer); |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: message, type: 'error', source: this, parameters : {name : this.file.name}}); |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: message, type: 'error', source: this, parameters : |
|  |  | {name : this.file.name.escapeHTML()}}); |
|  |  | this.formData.input.fire('xwiki:html5upload:fileFinished', {source: this}); |
|  |  | } |
|  |  | }); |
| Expand Down  Expand Up | | @@ -517,7 +518,7 @@ var XWiki = (function(XWiki) { |
|  |  | } |
|  |  | } catch (ex) { |
|  |  | this.showMessage(ex, 'error', {size : UploadUtils.bytesToSize(this.options && this.options.maxFilesize), |
|  |  | name : file.name, type: file.type |
|  |  | name : file.name.escapeHTML(), type: file.type |
|  |  | }); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9df46f8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F9df46f8e5313af46f93bccd1ebc682e28126573f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from jira.xwiki.org_82908441_20250111_063852.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19602)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19602)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19602](/browse/XWIKI-19602)

# Vulnerability in the XWiki

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19602 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Duplicate
* **Priority:**
  ![](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Fix Version/s:**
  None
* **Affects Version/s:**
  14.2-rc-1
* **Component/s:**
  None
* **Labels:**
  None

* **Difficulty:**
  Unknown
* **Similar issues:**

#### Description

Hello,

My name is Diana. I work as a junior analyst in the Cybersecurity Threat Analysis group at Positive Technologies.

Our researcher has discovered a critical vulnerability in the XWiki product. We strive to inform you as soon as possible about the vulnerabilities we have identified so that you can take appropriate measures to fix your product and protect your customers' systems.

We have already prepared a detailed technical vulnerability research report.

Please indicate in which format it is more convenient and safer for you to communicate: by email or in the tasks section?

If the first option, then we expect it to be the email of the cybersecurity team or the developers of the XWiki product.

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-19602?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-19602?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-19602?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-19602?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-19602?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-19602?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/68386.zip "Download all attachments as a ZIP file")

1. [Report\_Vulnerability\_XWiki.pdf](/secure/attachment/40345/Report_Vulnerability_XWiki.pdf "Report_Vulnerability_XWiki.pdf - Latest 04/Apr/22 10:47 - Diana")1.18 MB04/Apr/22 10:47
#### Issue Links

duplicates

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XRENDERING-663](/browse/XRENDERING-663)
XSS Javascript injection via XWiki 2.x syntax

* ![Blocker - Blocks development and/or testing work, production could not run.](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19611](/browse/XWIKI-19611)
XSS through attachment filename in uploader

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19550](/browse/XWIKI-19550)
Tags can be added and removed without CSRF token validation

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![vlasov](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Diana

Votes:
0
Vote for this issue

Watchers:
4
Start watching this issue

#### Dates

Created:

01/Apr/22 15:28

Updated:

17/Jun/24 12:33

Resolved:

06/Apr/22 11:28

Date of First Response:

02/Apr/22 11:09 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from jira.xwiki.org_cc2f3c90_20250111_063853.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19611)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19611)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-19611](/browse/XWIKI-19611)

# XSS through attachment filename in uploader

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-19611 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.") Critical
* **Fix Version/s:**
  [16.0.0](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+16.0.0 "16.0.0 "), [15.5.5](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.5.5 "15.5.5 "), [15.10.6](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.10.6 "15.10.6 "), [14.10.21](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.21 "14.10.21 ")
* **Affects Version/s:**
  13.10.4, 14.2.1
* **Component/s:**
  [Web - Templates & Resources](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Web+-+Templates+%26+Resources%22 "Web - Templates & Resources ")
* **Labels:**
  + [attack\_xss](/issues/?jql=labels+%3D+attack_xss "attack_xss")
  + [attacker\_socialeng](/issues/?jql=labels+%3D+attacker_socialeng "attacker_socialeng")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Integration
* **Development Priority:**
  Medium
* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce**:

1. Create a file "><img src=1 onerror=alert(1)>.jpg locally (any image will do).
2. Go to any wiki page where you have edit rights, go to the attachments tab and choose the file to upload.

**Expected result**:

1. The file is uploaded and displayed with its full filename.

**Actual result**:

1. Three alerts with "1" as content are displayed. The notification at the bottom of the screen and the progress bar don't display the full name.

I don't really see how the upload can be exploited as this is only temporarily visible to the uploading user but this should be fixed nevertheless.

The affects version currently only reflects the tested versions, I expect that this issue has been introduce with the uploader in [~~XWIKI-8132~~](https://jira.xwiki.org/browse/XWIKI-8132 "New JS Widget for uploading files via XMLHttpRequest"), i.e., XWiki 4.2-milestone-3.

This issue has originally been reported as part of [~~XWIKI-19602~~](https://jira.xwiki.org/browse/XWIKI-19602 "Vulnerability in the XWiki"), found by Aleksey Solovev (Positive Technologies), I'm creating this issue to have clear reproduction steps in the issue itself and to not to mix it with the other issues reported in the original issue.

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-19611?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-19611?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-19611?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-19611?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-19611?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-19611?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/68408.zip "Download all attachments as a ZIP file")

1. [![upload-XSS.png](https://jira.xwiki.org/secure/thumbnail/40352/_thumb_40352.png)](/secure/attachment/40352/upload-XSS.png "upload-XSS.png - Latest 06/Apr/22 09:46 - Michael Hamann")[upload-XSS.png](/secure/attachment/40352/upload-XSS.png "upload-XSS.png - Latest 06/Apr/22 09:46 - Michael Hamann")231 kB06/Apr/22 09:46
#### Issue Links

is duplicated by

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19602](/browse/XWIKI-19602)
Vulnerability in the XWiki

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Closed

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-21769](/browse/XWIKI-21769)
Self XSS in the attached filename

* ![Major - Major loss of function.](/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Security Advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-wf3x-jccf-5g5g)

#### Activity

#### People

Assignee:

![pjeanjean](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Pierre Jeanjean

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Special Allowed Users:

 Diana,  Georgios Roumeliotis

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

06/Apr/22 11:12

Updated:

17/Jun/24 12:31

Resolved:

24/Jan/24 15:32

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from github.com_2b621e34_20250111_063849.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  553](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  134](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

## Commit

[Permalink](/xwiki/xwiki-platform/commit/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

XWIKI-19611: Improve filename escaping in attachment upload

[Browse files](/xwiki/xwiki-platform/tree/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28)
Browse the repository at this point in the history

```
* Use escapeHTML() when displaying filenames in upload.js
* Add a test in AttachmentIT to check for proper HTML escaping during upload

(cherry picked from commit [910a501](https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949))
```

* Loading branch information

[![@pjeanjean](https://avatars.githubusercontent.com/u/7363343?s=40&v=4)](/pjeanjean) [![@michitux](https://avatars.githubusercontent.com/u/198317?s=40&v=4)](/michitux)

[pjeanjean](/xwiki/xwiki-platform/commits?author=pjeanjean "View all commits by pjeanjean")
authored and
[michitux](/xwiki/xwiki-platform/commits?author=michitux "View all commits by michitux")
committed
Jan 24, 2024

1 parent
[a9ccbc2](/xwiki/xwiki-platform/commit/a9ccbc28c0f1c192d61d4c7cca11c6840f2315dd)

commit 6cdd69d

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**26 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* xwiki-platform-core

  + xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test

    - it/org/xwiki/flamingo/test/docker

      * xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java
        [AttachmentIT.java](#diff-3f54b635e0300e2d82e74b264fc20f33d6a225d08b396c4149f278ad3901308a)
    - resources/AttachmentIT

      * xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt
        [<strong>EscapedAttachment.txt](#diff-fd94a7b27be0c5d227c377164f2197b41a47771f70ae83788e1fa904073c10d9)
  + xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets

    - xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js
      [upload.js](#diff-4590d3dba2eef80ef75b3f5f1390a6ea4fa277fb0fa01c613934fcf25deedec3)

## There are no files selected for viewing

19 changes: 19 additions & 0 deletions

19
[...rm-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java](#diff-3f54b635e0300e2d82e74b264fc20f33d6a225d08b396c4149f278ad3901308a "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java")

Show comments

[View file](/xwiki/xwiki-platform/blob/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/AttachmentIT.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -65,6 +65,8 @@ class AttachmentIT |
|  |  |  |
|  |  | private static final String SECOND\_ATTACHMENT = "SmallAttachment2.txt"; |
|  |  |  |
|  |  | private static final String ESCAPED\_ATTACHMENT = "<strong>EscapedAttachment.txt"; |
|  |  |  |
|  |  | private static final String IMAGE\_ATTACHMENT = "image.gif"; |
|  |  |  |
|  |  | private static final String SMALL\_SIZE\_ATTACHMENT = "SmallSizeAttachment.png"; |
| Expand Down  Expand Up | | @@ -447,6 +449,23 @@ void deleteAttachmentWithSpecialChar(TestUtils setup, TestReference testReferenc |
|  |  | basePage.getXWikiMessageContent()); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | @Order(9) |
|  |  | void checkEscapingInAttachmentName(TestUtils setup, TestReference testReference, |
|  |  | TestConfiguration testConfiguration) |
|  |  | { |
|  |  | setup.loginAsSuperAdmin(); |
|  |  | setup.createPage(testReference, "Empty content"); |
|  |  | AttachmentsPane attachmentsPane = new AttachmentsViewPage().openAttachmentsDocExtraPane(); |
|  |  |  |
|  |  | attachmentsPane.setFileToUpload(getFileToUpload(testConfiguration, ESCAPED\_ATTACHMENT).getAbsolutePath()); |
|  |  | attachmentsPane.waitForUploadToFinish(ESCAPED\_ATTACHMENT); |
|  |  | attachmentsPane.clickHideProgress(); |
|  |  |  |
|  |  | assertTrue(attachmentsPane.attachmentExistsByFileName(ESCAPED\_ATTACHMENT)); |
|  |  | attachmentsPane.deleteAttachmentByFileByName(ESCAPED\_ATTACHMENT); |
|  |  | } |
|  |  |  |
|  |  | private String getAttachmentsMacroContent(DocumentReference docRef) |
|  |  | { |
|  |  | StringBuilder sb = new StringBuilder(); |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[...m-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt](#diff-fd94a7b27be0c5d227c377164f2197b41a47771f70ae83788e1fa904073c10d9 "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/<strong>EscapedAttachment.txt")

Show comments

[View file](/xwiki/xwiki-platform/blob/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28/xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/resources/AttachmentIT/%3Cstrong%3EEscapedAttachment.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1 @@ |
|  |  | This is an attachment whose name should be escaped. |

11 changes: 6 additions & 5 deletions

11
[...tform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js](#diff-4590d3dba2eef80ef75b3f5f1390a6ea4fa277fb0fa01c613934fcf25deedec3 "xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js")

Show comments

[View file](/xwiki/xwiki-platform/blob/6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28/xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-war/src/main/webapp/resources/uicomponents/widgets/upload.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -124,7 +124,7 @@ var XWiki = (function(XWiki) { |
|  |  |  |
|  |  | if (this.options.enableFileInfo) { |
|  |  | statusUI.FILE\_INFO = UploadUtils.createDiv('file-info'); |
|  |  | (statusUI.FILE\_NAME = UploadUtils.createSpan('file-name', this.file.name)).title = this.file.type; |
|  |  | (statusUI.FILE\_NAME = UploadUtils.createSpan('file-name', this.file.name.escapeHTML())).title = this.file.type; |
|  |  | statusUI.FILE\_SIZE = UploadUtils.createSpan('file-size', ' (' + UploadUtils.bytesToSize(this.file.size) + ')'); |
|  |  | statusUI.FILE\_CANCEL = UploadUtils.createButton("$services.localization.render('core.widgets.html5upload.item.cancel')", this.cancelUpload.bindAsEventListener(this)); |
|  |  | // TODO MIME type icon? |
| Expand Down  Expand Up | | @@ -295,7 +295,7 @@ var XWiki = (function(XWiki) { |
|  |  | this.statusUI.FILE\_CANCEL.addClassName('hidden'); |
|  |  | } |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: 'UPLOAD\_FINISHING', type: 'inprogress', source: this, |
|  |  | parameters : {name : this.file.name} |
|  |  | parameters : {name : this.file.name.escapeHTML()} |
|  |  | }); |
|  |  | }, |
|  |  |  |
| Expand Down  Expand Up | | @@ -324,7 +324,7 @@ var XWiki = (function(XWiki) { |
|  |  | } |
|  |  | } |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: 'UPLOAD\_FINISHED', type: 'done', source: this, |
|  |  | parameters : {name : this.file.name, size : UploadUtils.bytesToSize(this.file.size)} |
|  |  | parameters : {name : this.file.name.escapeHTML(), size : UploadUtils.bytesToSize(this.file.size)} |
|  |  | }); |
|  |  | this.formData.input.fire('xwiki:html5upload:fileFinished', {source: this}); |
|  |  | clearInterval(this.timer); |
| Expand Down  Expand Up | | @@ -354,7 +354,8 @@ var XWiki = (function(XWiki) { |
|  |  | \*/ |
|  |  | abnormalUploadFinish : function (message) { |
|  |  | clearInterval(this.timer); |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: message, type: 'error', source: this, parameters : {name : this.file.name}}); |
|  |  | this.formData.input.fire('xwiki:html5upload:message', {content: message, type: 'error', source: this, parameters : |
|  |  | {name : this.file.name.escapeHTML()}}); |
|  |  | this.formData.input.fire('xwiki:html5upload:fileFinished', {source: this}); |
|  |  | } |
|  |  | }); |
| Expand Down  Expand Up | | @@ -517,7 +518,7 @@ var XWiki = (function(XWiki) { |
|  |  | } |
|  |  | } catch (ex) { |
|  |  | this.showMessage(ex, 'error', {size : UploadUtils.bytesToSize(this.options && this.options.maxFilesize), |
|  |  | name : file.name, type: file.type |
|  |  | name : file.name.escapeHTML(), type: file.type |
|  |  | }); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `6cdd69d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fcommit%2F6cdd69d31d6bf3caa7f40ec55eb317e4e528ad28) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_63ac91d4_20250111_063852.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-wf3x-jccf-5g5g)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxwiki%2Fxwiki-platform%2Fsecurity%2Fadvisories%2FGHSA-wf3x-jccf-5g5g)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=xwiki%2Fxwiki-platform)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xwiki](/xwiki)
/
**[xwiki-platform](/xwiki/xwiki-platform)**
Public

* [Notifications](/login?return_to=%2Fxwiki%2Fxwiki-platform) You must be signed in to change notification settings
* [Fork
  553](/login?return_to=%2Fxwiki%2Fxwiki-platform)
* [Star
   1k](/login?return_to=%2Fxwiki%2Fxwiki-platform)

* [Code](/xwiki/xwiki-platform)
* [Pull requests
  134](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects
  0](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

Additional navigation options

* [Code](/xwiki/xwiki-platform)
* [Pull requests](/xwiki/xwiki-platform/pulls)
* [Actions](/xwiki/xwiki-platform/actions)
* [Projects](/xwiki/xwiki-platform/projects)
* [Security](/xwiki/xwiki-platform/security)
* [Insights](/xwiki/xwiki-platform/pulse)

# XSS through attachment filename in uploader

Moderate

[michitux](/michitux)
published
GHSA-wf3x-jccf-5g5g
Jul 31, 2024

## Package

maven

org.xwiki.platform:xwiki-platform-web-war
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

>= 4.2-milestone-3, < 14.10.21
>= 15.0-rc-1, < 15.5.5
>= 15.6-rc-1, < 15.10.6
>= 16.0.0-rc-1, < 16.0.0

## Patched versions

14.10.21
15.5.5
15.10.6
16.0.0

## Description

### Impact

When uploading an attachment with a malicious filename, malicious JavaScript code could be executed. This requires a social engineering attack to get the victim into uploading a file with a malicious name. The malicious code is solely executed during the upload and affects only the user uploading the attachment. While this allows performing actions in the name of that user, it seems unlikely that a user wouldn't notice the malicious filename while uploading the attachment.

In order to reproduce, as any user, create a file named `"><img src=1 onerror=alert(1)>.jpg`. Then go to any page where you have edit rights and upload the file in the attachments tab. If alerts appear and display "1", then the instance is vulnerable.

### Patches

This has been patched in XWiki 14.10.21, 15.5.5, 15.10.6 and 16.0.0.

### Workarounds

We're not aware of any workaround except upgrading.

### References

* <https://jira.xwiki.org/browse/XWIKI-19611>
* <https://jira.xwiki.org/browse/XWIKI-21769>
* <https://jira.xwiki.org/browse/XWIKI-19602>
* [910a501](https://github.com/xwiki/xwiki-platform/commit/910a5018a50039e8b24556573dfe342f143ef949)

### Attribution

This vulnerability has been independently reported by Aleksey Solovev (Positive Technologies) and Georgios Roumeliotis for TwelveSec.

### Severity

Moderate

6.4

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
Low

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N

### CVE ID

CVE-2024-37900

### Weaknesses

[CWE-96](/advisories?query=cwe%3A96)

### Credits

* [![@RoboGR00t](https://avatars.githubusercontent.com/u/40581998?s=40&v=4)](/RoboGR00t)
  [RoboGR00t](/RoboGR00t)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from jira.xwiki.org_b60738a7_20250111_063853.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21769)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21769)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-21769](/browse/XWIKI-21769)

# Self XSS in the attached filename

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21769 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Duplicate
* **Priority:**
  ![](/images/icons/priorities/major.svg "Major - Major loss of function.") Major
* **Fix Version/s:**
  None
* **Affects Version/s:**
  None
* **Component/s:**
  [Web - Templates & Resources](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Web+-+Templates+%26+Resources%22 "Web - Templates & Resources ")
* **Labels:**
  + [attack\_xss](/issues/?jql=labels+%3D+attack_xss "attack_xss")
  + [attacker\_socialeng](/issues/?jql=labels+%3D+attacker_socialeng "attacker_socialeng")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Difficulty:**
  Unknown
* **Similar issues:**

#### Description

An attacker can convince a victim to upload an attachment with a malicious  filename in order to trigger an XSS vulnerability.

Below is a detailed replication guide.

1. Login in the XWiki instance and go to the following path `/bin/view/Main/#Attachments` and click on the **Browse** button. ![](/secure/attachment/42178/42178_image-2024-01-08-13-13-55-687.png)

2. Upload a file with the following filename ***"><img src=x onerror='alert(1)'>.txt*** and it is going to trigger an XSS vulnerability

![](/secure/attachment/42177/42177_image-2024-01-08-13-17-59-614.png)

![](/secure/attachment/42176/42176_image-2024-01-08-13-19-14-017.png)

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-21769?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-21769?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-21769?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-21769?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-21769?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-21769?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/72999.zip "Download all attachments as a ZIP file")

1. [![image-2024-01-08-13-13-55-687.png](https://jira.xwiki.org/secure/thumbnail/42178/_thumb_42178.png)](/secure/attachment/42178/image-2024-01-08-13-13-55-687.png "image-2024-01-08-13-13-55-687.png - Latest 08/Jan/24 12:13 - Georgios Roumeliotis")[image-2024-01-08-13-13-55-687.png](/secure/attachment/42178/image-2024-01-08-13-13-55-687.png "image-2024-01-08-13-13-55-687.png - Latest 08/Jan/24 12:13 - Georgios Roumeliotis")155 kB08/Jan/24 12:13
2. [![image-2024-01-08-13-17-59-614.png](https://jira.xwiki.org/secure/thumbnail/42177/_thumb_42177.png)](/secure/attachment/42177/image-2024-01-08-13-17-59-614.png "image-2024-01-08-13-17-59-614.png - Latest 08/Jan/24 12:18 - Georgios Roumeliotis")[image-2024-01-08-13-17-59-614.png](/secure/attachment/42177/image-2024-01-08-13-17-59-614.png "image-2024-01-08-13-17-59-614.png - Latest 08/Jan/24 12:18 - Georgios Roumeliotis")100 kB08/Jan/24 12:18
3. [![image-2024-01-08-13-19-14-017.png](https://jira.xwiki.org/secure/thumbnail/42176/_thumb_42176.png)](/secure/attachment/42176/image-2024-01-08-13-19-14-017.png "image-2024-01-08-13-19-14-017.png - Latest 08/Jan/24 12:19 - Georgios Roumeliotis")[image-2024-01-08-13-19-14-017.png](/secure/attachment/42176/image-2024-01-08-13-19-14-017.png "image-2024-01-08-13-19-14-017.png - Latest 08/Jan/24 12:19 - Georgios Roumeliotis")142 kB08/Jan/24 12:19
#### Issue Links

duplicates

![Bug - A problem which impairs or prevents the functions of the product.](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[XWIKI-19611](/browse/XWIKI-19611)
XSS through attachment filename in uploader

* ![Critical - Crashes, loss of data, severe memory leak.](/images/icons/priorities/critical.svg "Critical - Crashes, loss of data, severe memory leak.")
* Closed

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![groumeliotis](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Georgios Roumeliotis

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

08/Jan/24 12:19

Updated:

10/Dec/24 17:10

Resolved:

08/Jan/24 17:11

Date of First Response:

08/Jan/24 5:11 PM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)


