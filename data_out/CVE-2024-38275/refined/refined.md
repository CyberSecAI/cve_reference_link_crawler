```
{
  "Root cause of vulnerability": "The cURL wrapper in Moodle retained the original request headers when following redirects.",
  "Weaknesses/vulnerabilities present": "The vulnerability lies in the fact that the cURL wrapper does not clear the authorization header when following a redirect. This means that the authorization header from the original request could be inadvertently sent to a different domain.",
  "Impact of exploitation": "The impact is that sensitive information within the authorization header could be exposed to unintended third-party servers through redirects, potentially leading to unauthorized access or compromise of user accounts or other resources that rely on this information.",
  "Attack vectors": "The vulnerability can be exploited if a Moodle instance makes a request to a server that responds with a redirect to a malicious server. If the original request contained an HTTP authorization header, the Moodle cURL wrapper would forward this header along with the redirect request.",
  "Required attacker capabilities/position": "The attacker needs to be able to control the redirect destination in a scenario where Moodle makes an outbound request that would include sensitive authorization headers. This could happen with a variety of requests if the server the Moodle instance is communicating with has been compromised or is under the attackers control. The attacker does not need to be on the same network as the Moodle instance."
}
```