=== Content from github.com_e3cf3afb_20250111_142211.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdelvedor%2Ffind-my-way%2Fcommit%2F5e9e0eb5d8d438e06a185d5e536a896572dd0440)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdelvedor%2Ffind-my-way%2Fcommit%2F5e9e0eb5d8d438e06a185d5e536a896572dd0440)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=delvedor%2Ffind-my-way)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[delvedor](/delvedor)
/
**[find-my-way](/delvedor/find-my-way)**
Public

* [Notifications](/login?return_to=%2Fdelvedor%2Ffind-my-way) You must be signed in to change notification settings
* [Fork
  141](/login?return_to=%2Fdelvedor%2Ffind-my-way)
* [Star
   1.5k](/login?return_to=%2Fdelvedor%2Ffind-my-way)

* [Code](/delvedor/find-my-way)
* [Issues
  12](/delvedor/find-my-way/issues)
* [Pull requests
  3](/delvedor/find-my-way/pulls)
* [Actions](/delvedor/find-my-way/actions)
* [Projects
  0](/delvedor/find-my-way/projects)
* [Security](/delvedor/find-my-way/security)
* [Insights](/delvedor/find-my-way/pulse)

Additional navigation options

* [Code](/delvedor/find-my-way)
* [Issues](/delvedor/find-my-way/issues)
* [Pull requests](/delvedor/find-my-way/pulls)
* [Actions](/delvedor/find-my-way/actions)
* [Projects](/delvedor/find-my-way/projects)
* [Security](/delvedor/find-my-way/security)
* [Insights](/delvedor/find-my-way/pulse)

## Commit

[Permalink](/delvedor/find-my-way/commit/5e9e0eb5d8d438e06a185d5e536a896572dd0440)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge commit from fork

[Browse files](/delvedor/find-my-way/tree/5e9e0eb5d8d438e06a185d5e536a896572dd0440)
Browse the repository at this point in the history

* Loading branch information

[![@blakeembrey](https://avatars.githubusercontent.com/u/1088987?s=40&v=4)](/blakeembrey)

[blakeembrey](/delvedor/find-my-way/commits?author=blakeembrey "View all commits by blakeembrey")
authored
Sep 17, 2024

1 parent
[7e01863](/delvedor/find-my-way/commit/7e018631481498ed392eb9894808c9f7da5f509e)

commit 5e9e0eb

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**31 additions**
and
**8 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* index.js
  [index.js](#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346)
* test

  + test/issue-17.test.js
    [issue-17.test.js](#diff-da39dbb72deec393bfef513ac802a4a3ed647bf4a3d9bbaca31ae9e64c864750)
  + test/optional-params.test.js
    [optional-params.test.js](#diff-547284e60f70c9adf2ceed23c65211c452b537a0b3b174024ed1dd07e3afbc0f)
  + test/regex.test.js
    [regex.test.js](#diff-ef15189a196dd6667c5ab2833b0ea11b24088466345b3aebf3118a596828702f)

## There are no files selected for viewing

17 changes: 13 additions & 4 deletions

17
[index.js](#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346 "index.js")

Show comments

[View file](/delvedor/find-my-way/blob/5e9e0eb5d8d438e06a185d5e536a896572dd0440/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -192,6 +192,8 @@ Router.prototype.\_on = function \_on (method, path, opts, handler, store) { |
|  |  |  |
|  |  | if (isParametricNode) { |
|  |  | let isRegexNode = false |
|  |  | let isParamSafe = true |
|  |  | let backtrack = '' |
|  |  | const regexps = [] |
|  |  |  |
|  |  | let lastParamStartIndex = i + 1 |
| Expand Down  Expand Up | | @@ -219,8 +221,10 @@ Router.prototype.\_on = function \_on (method, path, opts, handler, store) { |
|  |  | regexps.push(trimRegExpStartAndEnd(regexString)) |
|  |  |  |
|  |  | j = endOfRegexIndex + 1 |
|  |  | isParamSafe = true |
|  |  | } else { |
|  |  | regexps.push('(.\*?)') |
|  |  | regexps.push(isParamSafe ? '(.\*?)' : `(${backtrack}|(?:(?!${backtrack}).)\*)`) |
|  |  | isParamSafe = false |
|  |  | } |
|  |  |  |
|  |  | const staticPartStartIndex = j |
| Expand All | | @@ -238,7 +242,7 @@ Router.prototype.\_on = function \_on (method, path, opts, handler, store) { |
|  |  | if (staticPart) { |
|  |  | staticPart = staticPart.split('::').join(':') |
|  |  | staticPart = staticPart.split('%').join('%25') |
|  |  | regexps.push(escapeRegExp(staticPart)) |
|  |  | regexps.push(backtrack = escapeRegExp(staticPart)) |
|  |  | } |
|  |  |  |
|  |  | lastParamStartIndex = j + 1 |
| Expand Down  Expand Up | | @@ -335,6 +339,8 @@ Router.prototype.findRoute = function findNode (method, path, constraints = {}) |
|  |  |  |
|  |  | if (isParametricNode) { |
|  |  | let isRegexNode = false |
|  |  | let isParamSafe = true |
|  |  | let backtrack = '' |
|  |  | const regexps = [] |
|  |  |  |
|  |  | let lastParamStartIndex = i + 1 |
| Expand All | | @@ -344,6 +350,7 @@ Router.prototype.findRoute = function findNode (method, path, constraints = {}) |
|  |  | const isRegexParam = charCode === 40 |
|  |  | const isStaticPart = charCode === 45 || charCode === 46 |
|  |  | const isEndOfNode = charCode === 47 || j === pattern.length |
|  |  |  |
|  |  | if (isRegexParam || isStaticPart || isEndOfNode) { |
|  |  | const paramName = pattern.slice(lastParamStartIndex, j) |
|  |  | params.push(paramName) |
| Expand All | | @@ -361,8 +368,10 @@ Router.prototype.findRoute = function findNode (method, path, constraints = {}) |
|  |  | regexps.push(trimRegExpStartAndEnd(regexString)) |
|  |  |  |
|  |  | j = endOfRegexIndex + 1 |
|  |  | isParamSafe = false |
|  |  | } else { |
|  |  | regexps.push('(.\*?)') |
|  |  | regexps.push(isParamSafe ? '(.\*?)' : `(${backtrack}|(?:(?!${backtrack}).)\*)`) |
|  |  | isParamSafe = false |
|  |  | } |
|  |  |  |
|  |  | const staticPartStartIndex = j |
| Expand All | | @@ -380,7 +389,7 @@ Router.prototype.findRoute = function findNode (method, path, constraints = {}) |
|  |  | if (staticPart) { |
|  |  | staticPart = staticPart.split('::').join(':') |
|  |  | staticPart = staticPart.split('%').join('%25') |
|  |  | regexps.push(escapeRegExp(staticPart)) |
|  |  | regexps.push(backtrack = escapeRegExp(staticPart)) |
|  |  | } |
|  |  |  |
|  |  | lastParamStartIndex = j + 1 |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[test/issue-17.test.js](#diff-da39dbb72deec393bfef513ac802a4a3ed647bf4a3d9bbaca31ae9e64c864750 "test/issue-17.test.js")

Show comments

[View file](/delvedor/find-my-way/blob/5e9e0eb5d8d438e06a185d5e536a896572dd0440/test/issue-17.test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -132,8 +132,8 @@ test('Multi parametric route / 2', t => { |
|  |  | }) |
|  |  |  |
|  |  | findMyWay.on('GET', '/a/:p1-:p2', (req, res, params) => { |
|  |  | t.equal(params.p1, 'foo') |
|  |  | t.equal(params.p2, 'bar-baz') |
|  |  | t.equal(params.p1, 'foo-bar') |
|  |  | t.equal(params.p2, 'baz') |
|  |  | }) |
|  |  |  |
|  |  | findMyWay.on('GET', '/b/:p1.:p2', (req, res, params) => { |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[test/optional-params.test.js](#diff-547284e60f70c9adf2ceed23c65211c452b537a0b3b174024ed1dd07e3afbc0f "test/optional-params.test.js")

Show comments

[View file](/delvedor/find-my-way/blob/5e9e0eb5d8d438e06a185d5e536a896572dd0440/test/optional-params.test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -68,8 +68,8 @@ test('Multi parametric route with optional param', (t) => { |
|  |  |  |
|  |  | findMyWay.on('GET', '/a/:p1-:p2?', (req, res, params) => { |
|  |  | if (params.p1 && params.p2) { |
|  |  | t.equal(params.p1, 'foo') |
|  |  | t.equal(params.p2, 'bar-baz') |
|  |  | t.equal(params.p1, 'foo-bar') |
|  |  | t.equal(params.p2, 'baz') |
|  |  | } |
|  |  | }) |
|  |  |  |
| Expand Down | |  |

14 changes: 14 additions & 0 deletions

14
[test/regex.test.js](#diff-ef15189a196dd6667c5ab2833b0ea11b24088466345b3aebf3118a596828702f "test/regex.test.js")

Show comments

[View file](/delvedor/find-my-way/blob/5e9e0eb5d8d438e06a185d5e536a896572dd0440/test/regex.test.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -255,3 +255,17 @@ test('Disable safe regex check', t => { |
|  |  | } |
|  |  | }) |
|  |  | }) |
|  |  |  |
|  |  | test('prevent back-tracking', (t) => { |
|  |  | t.plan(0) |
|  |  | t.setTimeout(20) |
|  |  |  |
|  |  | const findMyWay = FindMyWay({ |
|  |  | defaultRoute: () => { |
|  |  | t.fail('route not matched') |
|  |  | } |
|  |  | }) |
|  |  |  |
|  |  | findMyWay.on('GET', '/:foo-:bar-', (req, res, params) => {}) |
|  |  | findMyWay.find('GET', '/' + '-'.repeat(16\_000) + 'a', { host: 'fastify.io' }) |
|  |  | }) |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5e9e0eb`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdelvedor%2Ffind-my-way%2Fcommit%2F5e9e0eb5d8d438e06a185d5e536a896572dd0440) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blakeembrey.com_4f186d92_20250111_142210.html ===


[Writing](/)
# ReDoS the web

* Written 4 September 2024

## Background

Ten years ago I took over `path-to-regexp` with the release of `v0.1.0`, used in Express.js 4. Between then and now I've released 8 major versions adding, removing, and refining features. If I knew what I knew today, none of those 8 major versions would have been released. That's story for another day.

This story begins with Express 5. As part of reviving Express we're conducting a security audit, and I woke up on day to the revelation that users of `path-to-regexp` (including Express.js, Next.js, and others) may contain vulnerable regular expressions. It has never been reported, but once you know you know.

Any route using two or more parameters between slashes, where the second parameter does not start with `/` or `.`, is currently vulnerable to ReDoS. Express.js uses a vulnerable example in the [routing guide](https://expressjs.com/en/guide/routing.html): `/flights/:from-:to`. The design flaw goes undetected all the way back to the initial commit. Let's look at the regular expression generated for this route:

```
/^\/flights\/([^\/]+?)-([^\/]+?)\/?$/i
```

This looks reasonable, but if you match against a path like `'/flights/' + '-'.repeat(16_000) + '/x'` it takes 300ms. Holy crap! This *should* take less than a millisecond. If we tweak it slightly, changing the second parameter from `([^\/]+?)` to `([^\/-]+?)`, it takes just 0.07ms. What's gone wrong?

[OWASP](https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS) has a clear explanation. When the `/x` is added to the end of the path, it can no longer be matched (due to `$`, end of string), so it backtracks and tries every possible match of `:from-:to`. The more possible matches, the longer it takes.

## Scope

Thankfully the pattern of using more than one parameter within slashes is extremely rare or non-existent. APIs with multiple inputs usually rely on query parameters or operate in the context of a single object ID. That should limit the impact of this exploit and explains why it hasn't been reported before.

### Across JavaScript

The vulnerability exists in every library using regular expressions with multiple parameters in a segment without backtracking prevention. A quick review shows the problem is exploitable in other JavaScript libraries and specifications. Fortunately this is an uncommon pattern to start with, and some libraries avoid the problem by prohibiting multiple parameters in a segment or avoiding regexes.

### Beyond JavaScript

It's possible this vulnerability exists in any other language with regular expressions that backtrack. Libraries such as [RE2](https://github.com/google/re2/wiki/WhyRE2) can be used to guarantee linear time matches and mitigate the problem, but most default regular expression engines are not linear time. Fortunately the fix is easy: restrict backtracking, remove regex from matching, or limit parameters to safe locations.

## Mitigation

For v0.1, I've released a patch that includes automatic backtracking prevention for these exploitable parameters. It will automatically generate `((?!\-|\/).)+?` for the second parameter above (not `-` or `/`). Due to the loose nature of the v0 "parser" this isn't perfect, and will break some routes that use edge cases in the way the regular expression generates.

For version 8, I've removed regex features. I know this is a huge pain for users of the library and apologize in advance. In discussions with the Express TC we decided that any output of `path-to-regexp` that's exploitable is a vulnerability. Since versions < 8 allowed custom regular expressions to be defined using `(...)` and these can combine together to produce ReDoS vectors, the feature has been removed.

All other versions remain vulnerable, and can be mitigated by manually defining the parameters regular expression when two or more parameters exist in a single segment. For example, `/flights/:from-:to(\\w+)`. As long as the first or second parameter does not include `-` in the match, it is safe.

Lastly, feel free to contact me on how to mitigate the vulnerability in versions where users cannot upgrade. My contact information can be found on [GitHub](https://github.com/blakeembrey). The changes necessary in any version will break *something* for some users and is a trade-off between compatibility and exploitability.

## Other mitigation attempts

### Restrict URL length

Since this exploit gets worse when the URL is longer, restricting the path to some length and throwing a 413 when it exceeds the length would be the simplest mitigation. However, even at 2000 characters in length it's 20x worse than the safe regex. Making matches much shorter than this is bound to break other users.

### Restrict parameter length

Instead of an open ended `+`, use `{1,1000}`. This limits the performance impact (~1ms locally) but could break some users expecting long parameters. It also performs worse than the safe regex.

### RE2

We tried [re2js](https://github.com/le0pard/re2js) and performance was better (~4X) for the long ReDoS URLs, but much worse in every other case. Native bindings would probably be faster but we needed to maintain compatibility as best as possible in Express 4 which is still running node 0.10!

### Rewrite to JavaScript

This was the most promising avenue and provided good performance in limited tests, but I didn't finish. Providing a working mitigation and unblocking Express 5 was higher priority. The one major downside of this is that reintroducing safe regex features in version 8 becomes a lot harder.

## Resources

* [Recheck playground](https://makenowjust-labs.github.io/recheck/playground/) to check for vulnerabilities

---

**Questions?** Find me on [Twitter](https://twitter.com/blakeembrey) or [open an issue](https://github.com/blakeembrey/writing).



=== Content from github.com_05ed3218_20250111_142212.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdelvedor%2Ffind-my-way%2Fsecurity%2Fadvisories%2FGHSA-rrr8-f88r-h8q6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdelvedor%2Ffind-my-way%2Fsecurity%2Fadvisories%2FGHSA-rrr8-f88r-h8q6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=delvedor%2Ffind-my-way)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[delvedor](/delvedor)
/
**[find-my-way](/delvedor/find-my-way)**
Public

* [Notifications](/login?return_to=%2Fdelvedor%2Ffind-my-way) You must be signed in to change notification settings
* [Fork
  141](/login?return_to=%2Fdelvedor%2Ffind-my-way)
* [Star
   1.5k](/login?return_to=%2Fdelvedor%2Ffind-my-way)

* [Code](/delvedor/find-my-way)
* [Issues
  12](/delvedor/find-my-way/issues)
* [Pull requests
  3](/delvedor/find-my-way/pulls)
* [Actions](/delvedor/find-my-way/actions)
* [Projects
  0](/delvedor/find-my-way/projects)
* [Security](/delvedor/find-my-way/security)
* [Insights](/delvedor/find-my-way/pulse)

Additional navigation options

* [Code](/delvedor/find-my-way)
* [Issues](/delvedor/find-my-way/issues)
* [Pull requests](/delvedor/find-my-way/pulls)
* [Actions](/delvedor/find-my-way/actions)
* [Projects](/delvedor/find-my-way/projects)
* [Security](/delvedor/find-my-way/security)
* [Insights](/delvedor/find-my-way/pulse)

# ReDoS vulnerability in multiparametric routes

High

[delvedor](/delvedor)
published
GHSA-rrr8-f88r-h8q6
Sep 18, 2024

## Package

npm

find-my-way
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 8.2.2; 9.0.0

## Patched versions

>= 8.2.2; >= 9.0.1

## Description

### Impact

A bad regular expression is generated any time you have two parameters within a single segment, when adding a `-` at the end, like `/:a-:b-`.

### Patches

Update to find-my-way v8.2.2 or v9.0.1. or subsequent versions.

### Workarounds

No known workarounds.

### References

* [CVE-2024-45296](https://github.com/advisories/GHSA-9wv6-86v2-598j)
* [Detailed blog post about `path-to-regexp` vulnerability](https://blakeembrey.com/posts/2024-09-web-redos/)

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2024-45813

### Weaknesses

[CWE-1333](/advisories?query=cwe%3A1333)

### Credits

* [![@blakeembrey](https://avatars.githubusercontent.com/u/1088987?s=40&v=4)](/blakeembrey)
  [blakeembrey](/blakeembrey)
  Analyst
* [![@mcollina](https://avatars.githubusercontent.com/u/52195?s=40&v=4)](/mcollina)
  [mcollina](/mcollina)
  Coordinator

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


