```
{
  "vulnerability_details": {
    "root_cause": "The `ip_tunnel_rcv` function in the Linux kernel's IPv4 tunneling implementation did not properly ensure that the inner IP header was fully pulled into the skb's head before performing ECN decapsulation. This could result in the use of uninitialized memory.",
    "weaknesses": [
      "Improper handling of skb data",
      "Use of uninitialized values"
    ],
    "impact": "Use of uninitialized memory can lead to unpredictable behavior, including information disclosure, data modification, or denial of service.",
    "attack_vectors": "The vulnerability is triggered during the processing of tunneled IPv4 packets. An attacker could send specially crafted tunneled packets to trigger the vulnerability.",
    "required_attacker_capabilities": "The attacker needs to be able to send tunneled IP packets to the affected system. This might require network access to the system and potentially control over a source within the tunneling infrastructure."
  },
  "additional_details": {
    "fix": "The fix involves saving the offset of the outer IP header relative to the skb's head. This allows the code to correctly recompute the inner IP header pointer after the call to `pskb_inet_may_pull()`, ensuring the inner header is fully loaded in skb->head. The `skb_set_network_header` is set to an offset of `ETH_HLEN` or 0 depending on whether the interface uses ethernet or not respectively. The ECN decapsulation is performed after this operation using the updated inner header pointer.",
      "affected_code": "The vulnerable code is located in the `net/ipv4/ip_tunnel.c` file, specifically within the `ip_tunnel_rcv` function.",
    "vulnerable_versions": "This vulnerability affects multiple versions of the Linux kernel that implement IPv4 tunneling.",
    "reported_by": "The vulnerability was reported by syzbot.",
      "related_commits": [
        "b0ec2abf98267f14d032102551581c833b0659d3",
        "ca914f1cdee8a85799942c9b0ce5015bbd6844e1",
        "60044ab84836359534bd7153b92e9c1584140e4a",
        "5c03387021cfa3336b97e0dcba38029917a8af2a",
        "ec6bb01e02cbd47781dd90775b631a1dc4bd9d2b",
        "f6723d8dbfdc10c784a56748f86a9a3cd410dbd5",
        "77fd5294ea09b21f6772ac954a121b87323cec80",
        "c4c857723b37c20651300b3de4ff25059848b4b0"
    ],
      "affected_products": "NetApp products that incorporate vulnerable versions of the Linux kernel, including:\n\t* FAS/AFF Baseboard Management Controller (BMC) - A900/9500\n\t* FAS/AFF Baseboard Management Controller (BMC) - FAS2820\n\t* ONTAP Select Deploy administration utility\n\nOther NetApp products are under investigation.",
  "cvss_score": "7.8 (HIGH)",
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
  }
}
```