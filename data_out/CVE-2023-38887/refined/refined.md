Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from inconsistent file upload handling between the "DMS/ECM" module and the "REST API" module in Dolibarr.
*   While the "DMS/ECM" module includes a security measure of appending ".noexe" to files with dangerous extensions, the REST API module lacks this protection when handling file uploads.

**Weaknesses/Vulnerabilities:**

*   **Arbitrary File Upload:** The primary vulnerability is the ability of an authenticated user to upload arbitrary files through the REST API without the ".noexe" extension being appended to potentially dangerous file types.
*   **Inconsistent Security Measures:** The application has different security implementations depending on the way the file is uploaded.
*   Lack of file extension verification for API uploads.

**Impact of Exploitation:**

*   **Arbitrary Command Execution:** If the web server is not correctly configured and the "documents" directory is accessible, an attacker can upload a malicious web shell (e.g., a PHP file) and execute it, potentially gaining control of the server.
*   **Malicious File Upload:** Attackers can upload other malicious executable files which can be used to perform other attacks against the server or users.
*   **Compromised User Security:**  Uploaded malicious executable files can compromise user security.

**Attack Vectors:**

*   **REST API:** The vulnerability is exploited through API calls to the Dolibarr REST server.
*   **Authenticated User:** The attacker needs to be an authenticated user within Dolibarr with permissions to submit documents through the DMS/ECM module. This is required to get the API key needed for the API calls.

**Required Attacker Capabilities/Position:**

*   **Dolibarr Access:** The attacker needs an account on the Dolibarr instance.
*   **API Key:** The attacker must obtain their API key associated with their Dolibarr user account.
*   **Module Access:** The "DMS/ECM" and "REST API" modules must be enabled.

**Additional Details:**

*   The vulnerability affects Dolibarr version 17.0.1 and earlier.
*   The fix involves upgrading to the latest version of Dolibarr.
*   The provided CVSS v3.1 score gives the vulnerability a high rating.