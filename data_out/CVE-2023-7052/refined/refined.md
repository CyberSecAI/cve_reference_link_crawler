- **Root cause of vulnerability:** The application lacks proper CSRF protection mechanisms. Specifically, the `/user/profile.php` endpoint does not validate the origin of requests, allowing attackers to forge requests on behalf of authenticated users.
- **Weaknesses/vulnerabilities present:** Cross-Site Request Forgery (CSRF). The application's profile update functionality does not implement CSRF protection, such as CSRF tokens or proper `SameSite` cookie attributes.
- **Impact of exploitation:** An attacker can change the profile details of a logged-in user, such as their name, email, or mobile number, without their knowledge or consent. This manipulation of data can have further impacts on the user and/or application.
- **Attack vectors:** The attack is performed by crafting a malicious HTML page that contains a form that targets the vulnerable `/user/profile.php` endpoint. When a logged-in user visits this malicious page, the browser automatically sends a request to the targeted endpoint including the user's session cookies. This request can be manipulated by the attacker using hidden form fields to change the user's profile information.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to host a malicious HTML page.
    - The attacker must know the structure of the vulnerable POST request to the `/user/profile.php` endpoint, including the names of the parameters.
    - The targeted user must be logged into the vulnerable application and must visit the malicious HTML page.