=== Content from documentation.open-xchange.com_8c3748c5_20250110_123434.html ===
{
"document": {
"category": "csaf\_security\_advisory",
"csaf\_version": "2.0",
"distribution": {
"tlp": {
"label": "GREEN",
"url": "https://www.first.org/tlp/"
}
},
"publisher": {
"category": "vendor",
"name": "Open-Xchange GmbH",
"namespace": "https://open-xchange.com/"
},
"title": "OX Dovecot Pro Security Advisory OXDC-ADV-2024-0003",
"tracking": {
"current\_release\_date": "2024-09-10T00:00:00+00:00",
"id": "OXDC-ADV-2024-0003",
"initial\_release\_date": "2024-09-10T00:00:00+02:00",
"revision\_history": [
{
"date": "2024-09-10T00:00:00+02:00",
"number": "1",
"summary": "Initial release"
},
{
"date": "2024-09-10T00:00:00+00:00",
"number": "2",
"summary": "Public release"
}
],
"status": "final",
"version": "2",
"generator": {
"date": "2024-09-10T14:45:00+00:00",
"engine": {
"version": "1.0.0",
"name": "OX CSAF"
}
}
},
"lang": "en-US",
"references": [
{
"summary": "Canonical CSAF document",
"url": "https://documentation.open-xchange.com/dovecot/security/advisories/csaf/2024/oxdc-adv-2024-0003.json",
"category": "self"
},
{
"summary": "Markdown representation",
"url": "https://documentation.open-xchange.com/dovecot/security/advisories/md/2024/oxdc-adv-2024-0003.md",
"category": "self"
},
{
"summary": "HTML representation",
"url": "https://documentation.open-xchange.com/dovecot/security/advisories/html/2024/oxdc-adv-2024-0003.html",
"category": "self"
},
{
"summary": "Plain-text representation",
"url": "https://documentation.open-xchange.com/dovecot/security/advisories/txt/2024/oxdc-adv-2024-0003.txt",
"category": "self"
}
],
"aggregate\_severity": {
"text": "HIGH"
}
},
"product\_tree": {
"branches": [
{
"category": "vendor",
"name": "Open-Xchange GmbH",
"branches": [
{
"category": "product\_name",
"name": "OX Dovecot Pro core",
"branches": [
{
"category": "product\_version",
"name": "2.3.21",
"product": {
"product\_id": "OXDC-CORE\_2.3.21",
"name": "OX Dovecot Pro core 2.3.21",
"product\_identification\_helper": {
"cpe": "cpe:2.3:a:open-xchange:dovecot:2.3.21:\*:\*:\*:\*:\*:\*:\*"
}
}
},
{
"category": "product\_version",
"name": "2.3.21.1",
"product": {
"product\_id": "OXDC-CORE\_2.3.21.1",
"name": "OX Dovecot Pro core 2.3.21.1",
"product\_identification\_helper": {
"cpe": "cpe:2.3:a:open-xchange:dovecot:2.3.21.1:\*:\*:\*:\*:\*:\*:\*"
}
}
},
{
"category": "product\_version",
"name": "3.0.0",
"product": {
"product\_id": "OXDC-CORE\_3.0.0",
"name": "OX Dovecot Pro core 3.0.0",
"product\_identification\_helper": {
"cpe": "cpe:2.3:a:open-xchange:dovecot:3.0.0:\*:\*:\*:\*:\*:\*:\*"
}
}
}
]
}
]
}
]
},
"vulnerabilities": [
{
"cve": "CVE-2024-23185",
"cwe": {
"id": "CWE-770",
"name": "Allocation of Resources Without Limits or Throttling"
},
"notes": [
{
"category": "description",
"text": "Very large headers can cause resource exhaustion when parsing message. The message-parser normally reads reasonably sized chunks of the message. However, when it feeds them to message-header-parser, it starts building up \"full\_value\" buffer out of the smaller chunks. The full\_value buffer has no size limit, so large headers can cause large memory usage. It doesn't matter whether it's a single long header line, or a single header split into multiple lines. This bug exists in all Dovecot versions."
}
],
"product\_status": {
"last\_affected": [
"OXDC-CORE\_2.3.21"
],
"first\_fixed": [
"OXDC-CORE\_2.3.21.1",
"OXDC-CORE\_3.0.0"
]
},
"discovery\_date": "2024-01-31T11:55:28+01:00",
"ids": [
{
"system\_name": "JIRA OX Bug",
"text": "DOV-6601"
}
],
"remediations": [
{
"category": "vendor\_fix",
"details": "One can implement restrictions on headers on MTA component preceding Dovecot.",
"date": "2024-08-21T08:59:54+02:00",
"product\_ids": [
"OXDC-CORE\_2.3.21"
]
}
],
"scores": [
{
"products": [
"OXDC-CORE\_2.3.21"
],
"cvss\_v3": {
"version": "3.1",
"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
"baseScore": 7.5,
"baseSeverity": "HIGH",
"attackVector": "NETWORK",
"attackComplexity": "LOW",
"privilegesRequired": "NONE",
"userInteraction": "NONE",
"scope": "UNCHANGED",
"confidentialityImpact": "NONE",
"integrityImpact": "NONE",
"availabilityImpact": "HIGH"
}
}
],
"threats": [
{
"category": "impact",
"details": "Incoming mails typically have some size limits set by MTA, so even largest possible header size may still fit into Dovecot's vsz\_limit. So attackers probably can't DoS a victim user this way. A user could APPEND larger mails though, allowing them to DoS themselves (although maybe cause some memory issues for the backend in general)."
},
{
"category": "exploit\_status",
"details": "No publicly available exploits are known."
}
],
"title": "Message headers have no size limit when parsing"
}
]
}

=== Content from www.openwall.com_6950bcde_20250110_123434.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1828138112.288.1723706025422@appsuite-dev.open-xchange.com>
Date: Thu, 15 Aug 2024 10:13:45 +0300 (EEST)
From: Aki Tuomi <aki.tuomi@...ecot.fi>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: Dovecot CVE-2024-23185: Very large headers can cause resource
 exhaustion when parsing message

Affected product: Dovecot IMAP Server
Internal reference: DOV-6601
Vulnerability type: CWE-770 (Allocation of Resources Without Limits or Throttling)
Vulnerable version: 2.2, 2.3
Vulnerable component: lib-mail
Report confidence: Confirmed
Solution status: Fixed in 2.3.21.1
Researcher credits: Vendor internal discovery
Vendor notification: 2024-01-31
CVE reference: CVE-2024-23185
CVSS: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)

Vulnerability Details:
Very large headers can cause resource exhaustion when parsing message. The message-parser normally reads reasonably sized chunks of the message. However, when it feeds them to message-header-parser, it starts building up "full_value" buffer out of the smaller chunks. The full_value buffer has no size limit, so large headers can cause large memory usage. It doesn't matter whether it's a single long header line, or a single header split into multiple lines. This bug exists in all Dovecot versions.

Incoming mails typically have some size limits set by MTA, so even largest possible header size may still fit into Dovecot's vsz_limit. So attackers probably can't DoS a victim user this way. A user could APPEND larger mails though, allowing them to DoS themselves (although maybe cause some memory issues for the backend in general).

Workaround:
One can implement restrictions on headers on MTA component preceding Dovecot.

Fix:
Install non-vulnerable version of Dovecot. Patch can be found at <https://github.com/dovecot/core/compare/f020e13%5E...ce88c33.patch>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from seclists.org_2ffdd816_20250110_123434.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

![](/shared/images/nst-icons.svg#search)

# Dovecot CVE-2024-23185: Very large headers can cause resource exhaustion when parsing message

---

*From*: Aki Tuomi via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 14 Aug 2024 14:13:42 +0300 (EEST)

---

```
Affected product: Dovecot IMAP Server
Internal reference: DOV-6601
Vulnerability type: CWE-770 (Allocation of Resources Without Limits or Throttling)
Vulnerable version: 2.2, 2.3
Vulnerable component: lib-mail
Report confidence: Confirmed
Solution status: Fixed in 2.3.21.1
Researcher credits: Vendor internal discovery
Vendor notification: 2024-01-31
CVE reference: CVE-2024-23185
CVSS: 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H)

Vulnerability Details:
Very large headers can cause resource exhaustion when parsing message. The message-parser normally reads reasonably
sized chunks of the message. However, when it feeds them to message-header-parser, it starts building up "full_value"
buffer out of the smaller chunks. The full_value buffer has no size limit, so large headers can cause large memory
usage. It doesn't matter whether it's a single long header line, or a single header split into multiple lines. This bug
exists in all Dovecot versions.

Incoming mails typically have some size limits set by MTA, so even largest possible header size may still fit into
Dovecot's vsz_limit. So attackers probably can't DoS a victim user this way. A user could APPEND larger mails though,
allowing them to DoS themselves (although maybe cause some memory issues for the backend in general).

Workaround:
One can implement restrictions on headers on MTA component preceding Dovecot.

Fix:
Install non-vulnerable version of Dovecot. Patch can be found at
<https://github.com/dovecot/core/compare/f020e13%5E...ce88c33.patch>
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](19)

### Current thread:

* **Dovecot CVE-2024-23185: Very large headers can cause resource exhaustion when parsing message** *Aki Tuomi via Fulldisclosure (Aug 17)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


