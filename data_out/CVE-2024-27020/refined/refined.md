```
{
  "vulnerability": {
    "root_cause": "A data race can occur when `nft_unregister_expr()` runs concurrently with `__nft_expr_type_get()`. The `__nft_expr_type_get()` function iterates through the `nf_tables_expressions` list without proper protection.",
    "weaknesses": [
      "Data race condition",
      "Lack of synchronization during list iteration"
    ],
    "impact": "Potential memory corruption or undefined behavior due to concurrent access of the `nf_tables_expressions` list.",
    "attack_vectors": "Concurrent execution of `nft_unregister_expr()` and `__nft_expr_type_get()` within the netfilter subsystem.",
     "required_capabilities": "An attacker would need to trigger the concurrent execution of these functions. This likely requires some ability to create or modify nftables rules and expressions."
  },
  "resolution": "The vulnerability was fixed by modifying `__nft_expr_type_get()` to iterate over `nf_tables_expressions` list using `list_for_each_entry_rcu()`. Additionally, a `rcu_read_lock()` was added at the beginning of `nft_expr_type_get()` and an `rcu_read_unlock()` before exiting the function, ensuring the entire type query process is protected.",
  "cve": "CVE-2024-27020"
}
```