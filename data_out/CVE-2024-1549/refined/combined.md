=== Content from lists.debian.org_c4b56b4e_20250111_160311.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 3748-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3748-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Mon, 4 Mar 2024 08:54:14 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20240304075414.84B762A00FC%40andromeda) [20240304075414.84B762A00FC@andromeda](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3748-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
March 04, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.8.0-1~deb10u1
CVE ID         : CVE-2024-1546 CVE-2024-1547 CVE-2024-1548 CVE-2024-1549
                 CVE-2024-1550 CVE-2024-1551 CVE-2024-1552 CVE-2024-1553

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.8.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmXlfiYACgkQnUbEiOQ2
gwLl/w/9EBysc+b7Q29J2AbsVaT9oljBrPTBYLpx0uxJHLM0XM6n9zoDUmi1Adzh
MJktZAV7w+Fio1OwjQhrBraBTP98a3cVlC4kQtEJMkDj5KC91dT9F/1DcvUrb6QX
pK+WvX464Ck/CQJSR7xKYN57lcOZFcw4Q4m8AUp/MqoBEiimBg/obpBdjjEacANN
te8eZpDTzSrAasqcsWhToi2E6ZID/WIjpHvMYuWwReiCrRuE9aNRRbEMZRBHXPfu
+zkUlSa3yF/SjGWL08bqHbuLVxkemWOncqHJ3nc76unkANCPon2rhJaEQIEmGjQy
1s88Fn7mE35MPHuhXHonLjeUTNkVfLUnInn2KPxChPrBlXR6kaVYCY8bZdP0IA5K
+VPKTiuRw22p5XQva/9T5KR23t2FXHlwfpnkMznEQ5TKOHRnPRk53RkukNwf4rLn
+jUeRA4fFgQ7+cbenhjEJ5BdG1KUpC/M2oBIaJy2emu1bpyvqIZ3ie+JAGzky45o
0v8PEIkk+YbMROMX3Xv5ta5movAvY4vYXirKRMHT0T4qeLxO0tcrZ0ehznkdMq05
uopTo1eijcJebUUkpbqeq7wujXT9gmxRXsIakPioR8dv9GMiXiHe3Y7hakMKiIfv
mMgMXmIVIxvk5ilfKXb1BOs0q6h1WsE4Cf15LNQonzCTSqbah+s=
=lUs9
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_e4d048eb_20250111_160311.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1833814)
* [XML](/show_bug.cgi?ctype=xml&id=1833814)

Closed
[Bug 1833814](/show_bug.cgi?id=1833814)
(CVE-2024-1549)

Opened 2 years ago
Closed 1 year ago

# Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)

## Categories

### (Toolkit :: PopupNotifications and Notification Bars, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=PopupNotifications%20and%20Notification%20Bars#PopupNotifications%20and%20Notification%20Bars)

PopupNotifications and Notification Bars
▾

Toolkit :: PopupNotifications and Notification Bars
The underlying mechanism that shows "doorhanger" panels as well as notification bars (sometimes referred to as "message bars").
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=PopupNotifications%20and%20Notification%20Bars&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=PopupNotifications%20and%20Notification%20Bars&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=PopupNotifications%20and%20Notification%20Bars)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

124 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [123+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=123%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox121 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix) |
| firefox122 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix) |
| firefox123 | [+](/buglist.cgi?f1=cf_tracking_firefox123&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=verified) |
| firefox124 | --- | [verified](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 123+ | verified |
| firefox-esr128 | --- | --- |
| firefox121 |  | wontfix |
| firefox122 |  | wontfix |
| firefox123 | + | verified |
| firefox124 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/679f3fb3f1d10ec10892fd611fea5c14?d=mm&size=40)  [hjones](/user_profile?user_id=692246)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

19 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1876009](/show_bug.cgi?id=1876009 "RESOLVED FIXED - tb perma PROCESS-CRASH | application crashed [@ nsPresContext::GetPresShell] | comm/mail/test/browser/openpgp/browser_viewMessageSecurity.js")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1838769](/show_bug.cgi?id=1838769 "RESOLVED DUPLICATE - Permission UI Spoof with custom CSS")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2022-45418](/show_bug.cgi?id=1795815 "VERIFIED FIXED - Css Draw Mouse Cursor to hide omni box"), [1908684](/show_bug.cgi?id=1908684 "NEW - when entering fullscreen mode (by playing a video without source tag) the cursor does not appear leading to clickjacking on permission dialog")

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=1385714 "https://bugs.chromium.org/p/chromium/issues/detail?id=1385714")

## Details

### (Keywords: csectype-clickjacking, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main123+][adv-esr115.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-1549

[Keywords:](/describekeywords.cgi)

[csectype-clickjacking](/buglist.cgi?keywords=csectype-clickjacking&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [adv-main123+][adv-esr115.8+]

QA Whiteboard:

[post-critsmash-triage] [qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a22251586_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files)

| [bandicam 2023-05-18 13-42-20-811.mp4](/attachment.cgi?id=9334775)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   2.05 MB, video/mp4 |  | [Details](/attachment.cgi?id=9334775&action=edit) |
| --- | --- | --- |
| [cursorpointer.html](/attachment.cgi?id=9334776)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   1.41 KB, text/html |  | [Details](/attachment.cgi?id=9334776&action=edit) |
| [128x128.png](/attachment.cgi?id=9334777)  [2 years ago](#c2)  [Hafiizh](/user_profile?user_id=694415)   782 bytes, image/png |  | [Details](/attachment.cgi?id=9334777&action=edit) |
| [Bug 1833814 - change nsIWidget's cursor logic, r?emilio](/attachment.cgi?id=9367077)  [1 year ago](#c22)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c24 "1 year ago") | [Details](/attachment.cgi?id=9367077&action=edit) | [Review](/attachment.cgi?id=9367077) |
| [Bug 1833814 - change nsIWidget's cursor logic,](/attachment.cgi?id=9372854)  [1 year ago](#c26)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-esr115+](#a22817628_600971 "1 year ago") | [Details](/attachment.cgi?id=9372854&action=edit) | [Review](/attachment.cgi?id=9372854) |
| [Bug 1833814 - change nsIWidget's cursor logic, r?emilio](/attachment.cgi?id=9376021)  [1 year ago](#c31)  [:Gijs (he/him)](/user_profile?user_id=159069)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a21698908_600971 "1 year ago") | [Details](/attachment.cgi?id=9376021&action=edit) | [Review](/attachment.cgi?id=9376021) |
| [advisory.txt](/attachment.cgi?id=9380026)  [11 months ago](#c47)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   250 bytes, text/plain |  | [Details](/attachment.cgi?id=9380026&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1833814#c0)• 2 years ago |
|  | |

Attached video
[bandicam 2023-05-18 13-42-20-811.mp4](attachment.cgi?id=9334775)
— [Details](attachment.cgi?id=9334775&action=edit)

I found a vulnerability in firefox 112.0.1 (64-bit) (i tested on windows OS) where Mouse cursor pointer (128x128) can overlap the permissions request prompt which can confuse lead to spoofs.

step to reproduces:

1. open cursorpointer.html
2. click on webpage near the permission request prompt appears
Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1833814#c1)• 2 years ago |
|  | |

Attached file
[cursorpointer.html](attachment.cgi?id=9334776)
— [Details](attachment.cgi?id=9334776&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1833814#c2)• 2 years ago |
|  | |

Attached image
[128x128.png](attachment.cgi?id=9334777)
— [Details](attachment.cgi?id=9334777&action=edit)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1833814#c3)• 2 years ago |
|  | |

i update the poc:

1. open <https://pipabajabakrie.com/upload/cursorpointer.html> or open cursorpointer.html
2. click on webpage near the permission request prompt appears

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21803_159069)• 2 years ago |

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: CSS Object ModelKeywords: [dupeme](/buglist.cgi?keywords=dupeme&resolution=---)OS: Unspecified → AllProduct: Firefox → CoreHardware: Unspecified → DesktopSee Also: → [CVE-2022-45418](/show_bug.cgi?id=1795815 "VERIFIED FIXED - Css Draw Mouse Cursor to hide omni box")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a26000_406194)• 2 years ago |

Group: dom-core-security → layout-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a26661_406194)• 2 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1833814#c4)• 2 years ago |
|  | |

> i update the poc:

The pipabajabakrie.com server seems extremely unreliable from north america. Most of the time I get server not found or a 404 page (noticed in other testcases of yours as well). Can you please attach the update to this bug?

> can overlap the permissions request prompt which can confuse lead to spoofs.

Can you explain or demonstrate what kind of spoof you mean? It doesn't seem like you can fool them into clicking on the prompt (e.g. fake cursor on one button with the real click going to the other) because it turns into the real cursor when you cross into the prompt. You could maybe fool someone into thinking they clicked on the prompt when they really clicked just off it, and then the prompt closes. But I don't see how that gives an attacker any advantage.

Flags: needinfo?(sas.kunz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1833814#c5)• 2 years ago |
|  | |

The permission dialogs are supposed to have an activation delay so you can't play "double-click game" clickjacking, and on mac that seems to hold true for the geolocation prompt used in the example.

I think I get it now (thanks, mccr8). I was moving my cursor too high and the modified one was going away.

The key to this kind of spoof is that the big cursor is usually transparent, with a normal-sized cursor somewhere other than the real pointer. By overlapping these chrome permission dialogs you could have someone click on the "wrong" button. You know users will deny geolocation (or camera, or installing an add-on) so you make an "offset cursor" such that when they try to click deny/block/cancel it will actually allow/approve/install. (you'd have to make a different cursor for different OSs because we change the button order)

We've had this problem a long time ago, especially with the add-on install prompt. The cursor must be reset whenever it overlaps ANY bit of chrome, including doorhanger bits. It cannot simply be based on the normal window border. If it's too much work to get the geometry correct I would accept cancelling custom cursors any time a door-hanger/permission prompt is visible.

Note also to test infobars, though we probably got that one correct.

We allow some grace for cursors <= 32x32, but for an offset cursor attack on these prompt that might still be too much overlap.

I have not tested the add-on install prompt, but I assume it will work the same as the other door-hangers. Based on that I'm rating it sec-high. It could also be sec-high if it worked on the getUserMedia() permission prompt (which I assume it will).

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Summary: Custom Cursor mouse overlap permission request prompt → Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1833814#c6)• 2 years ago |
|  | |

CSSOM seems like the wrong component for this. I guess if you see this as a core bug it could live in layout or DOM events, but it could also be fixed at the UI level.

In general detecting overlap with permission panels (specially from the content process) seems pretty hard, though presumably not impossible.

Group: layout-core-security → firefox-core-securityComponent: DOM: CSS Object Model → Site PermissionsProduct: Core → Firefox

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1833814#c7)• 2 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #6](/show_bug.cgi?id=1833814#c6 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)"))

> CSSOM seems like the wrong component for this. I guess if you see this as a core bug it could live in layout or DOM events, but it could also be fixed at the UI level.

Can you elaborate on how you think it could/should be fixed "at the UI level"?

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1833814#c8)• 2 years ago |
|  | |

I said could, not sure it's a great idea. But avoiding overlapping permission prompt actions on top of content is the obvious... Maybe moving the panels in a way the buttons end up around the urlbar height? It's arguably not great.

Flags: needinfo?(emilio)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1833814#c9)• 2 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #8](/show_bug.cgi?id=1833814#c8 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)"))

> Maybe moving the panels in a way the buttons end up around the urlbar height? It's arguably not great.

I don't think this is feasible given the panels' height, especially for `getUserMedia` (camera/microphone) panels.

Seems like Chrome solves this by doing what dveditz suggested:

(In reply to Daniel Veditz [:dveditz] from [comment #5](/show_bug.cgi?id=1833814#c5 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)"))

> If it's too much work to get the geometry correct I would accept cancelling custom cursors any time a door-hanger/permission prompt is visible.

Emilio, is there a primitive frontend can use for this? In my testing, just setting the CSS `cursor` property on the browser is insufficient. So that would presumably need an additional browsingContext or browser API of sorts... unless I'm missing something?

Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1833814#c10)• 2 years ago |
|  | |

Does `window.setCursor(..)` work?

Flags: needinfo?(emilio) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1833814#c11)• 2 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #10](/show_bug.cgi?id=1833814#c10 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)"))

> Does `window.setCursor(..)` work?

`window.setCursor("default")` doesn't seem to do anything when called on the browser window and `setCursor` does not appear to exist for the content process window (tested w/ multiproc browser console set to the process scope for the tab and then `tabs[0].content.setCursor` which is undefined)

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1833814#c12)• 2 years ago |
|  | |

Hmm, yeah, so `setCursor("pointer")` etc locks the cursor but not when over web content... It's only exposed to privileged chrome windows (<https://searchfox.org/mozilla-central/rev/8dd0d2bebe4c897152da6c86d937e4be80bbaa54/dom/webidl/Window.webidl#639-640>).

Probably we should make `setCursor` work on a privileged window but alternatively we could expose an API to disallow custom cursors temporarily, that should be rather straight-forward I believe...

Flags: needinfo?(emilio)

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1833814#c13)• 2 years ago |
|  | |

Thanks for looking into it! Does either of you have time to take the bug or do you know somebody who could? I'm unfortunately quite swamped currently.

Flags: needinfo?(gijskruitbosch+bugs)Flags: needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1833814#c14)• 2 years ago |
|  | |

Same unfortunately, unless this is super-prioritary I can't take it right now. I can give pointers tho...

Ideally we expose a ChromeOnly API, let's call it `window.allowCustomCursor` which takes a boolean. On setting, we propagate the value to `nsIWidget`, via `nsGlobalWindowOuter::GetMainWidget`.

Then `nsIWidget::SetCursor` implementations take care of checking that and not honor the custom cursor?

Flags: needinfo?(emilio)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a2530335_159069)• 2 years ago |

See Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=1385714>

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a2530427_159069)• 2 years ago |

Duplicate of this bug: [1838769](/show_bug.cgi?id=1838769 "RESOLVED DUPLICATE - Permission UI Spoof with custom CSS")

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1833814#c16)• 2 years ago |
|  | |

Moving it out of Site Permissions since it's not permission prompt specific, but rather a general issue with popup notifications. Please let me know if that doesn't work!

Component: Site Permissions → Notifications and AlertsProduct: Firefox → Toolkit

|  | [Emma Zühlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1833814#c17)• 2 years ago |
|  | |

Mike, you've recently reorganized the bug triages for notifications. Should this still be in Notifications and Alerts or is there a better place?

Flags: needinfo?(mconley)

|  | [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1833814#c18)• 2 years ago |
|  | |

Over to PopupNotifications and Notification Bars! :)

Component: Notifications and Alerts → PopupNotifications and Notification BarsFlags: needinfo?(mconley)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1833814#c19)• 1 years ago |
| advocacy | |

| Comment hidden (advocacy) |  |
| --- | --- |

hello any updates?

Flags: needinfo?(sas.kunz)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1833814#c20)• 1 year ago |
| advocacy | |

| Comment hidden (advocacy) |  |
| --- | --- |

hello any updates?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1833814#c21)• 1 year ago |
| advocacy | |

| Comment hidden (advocacy) |  |
| --- | --- |

hello any updates?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1833814#c22)• 1 year ago |
|  | |

Attached file
[Bug 1833814 - change nsIWidget's cursor logic, r?emilio](attachment.cgi?id=9367077)
— [Details](attachment.cgi?id=9367077&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a17396139_600971)• 1 year ago |

Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNED

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a19903043_600971)• 1 year ago |

[Attachment #9367077](/attachment.cgi?id=9367077&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") -
Attachment description: Bug 1833814 - change nsIWidget's cursor logic, r?emilio → WIP: Bug 1833814 - change nsIWidget's cursor logic, r?emilio

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a19973277_159069)• 1 year ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a19973314_600971)• 1 year ago |

[Attachment #9367077](/attachment.cgi?id=9367077&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") -
Attachment description: WIP: Bug 1833814 - change nsIWidget's cursor logic, r?emilio → Bug 1833814 - change nsIWidget's cursor logic, r?emilio

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1833814#c23)• 1 year ago |
|  | |

Comment on [attachment 9367077](/attachment.cgi?id=9367077 "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") [[details]](/attachment.cgi?id=9367077&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio")

[Bug 1833814](/show_bug.cgi?id=1833814 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") - change nsIWidget's cursor logic, r?emilio

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Reasonably easily. It's clear that there's some connection between the XUL popup manager code and custom cursors. Figuring out the link with permission prompts as such may be less obvious - I'm not sure.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: It's a little iffy, I think, because we're messing with cursors and 3 different widget platforms, so there's a potential for races / edgecases. It's also not something we can really test automatically, unfortunately. So like - I hope not! But it's hard to be sure.
* **Is Android affected?**: No
[Attachment #9367077](/attachment.cgi?id=9367077&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1833814#c24)• 1 year ago |
|  | |

Comment on [attachment 9367077](/attachment.cgi?id=9367077 "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") [[details]](/attachment.cgi?id=9367077&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio")

[Bug 1833814](/show_bug.cgi?id=1833814 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") - change nsIWidget's cursor logic, r?emilio

From a sec-approval POV, I'm okay with this landing now or at the beginning of next cycle. From the size of the patch and the things its touching, relman may want to wait until next cycle.

[Attachment #9367077](/attachment.cgi?id=9367077&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") -
Flags: sec-approval? → sec-approval+

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1833814#c25)• 1 year ago |
|  | |

(In reply to Tom Ritter [:tjr] from [comment #24](/show_bug.cgi?id=1833814#c24 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)"))

> Comment on [attachment 9367077](/attachment.cgi?id=9367077 "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") [[details]](/attachment.cgi?id=9367077&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio")
>
> [Bug 1833814](/show_bug.cgi?id=1833814 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") - change nsIWidget's cursor logic, r?emilio
>
> From a sec-approval POV, I'm okay with this landing now or at the beginning of next cycle. From the size of the patch and the things its touching, relman may want to wait until next cycle.

Last beta is tomorrow. So yeah, let's wait for the next cycle I guess.

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [reminder-landing 2024-01-22]

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1833814#c26)• 1 year ago |
|  | |

Attached file
[Bug 1833814 - change nsIWidget's cursor logic,](attachment.cgi?id=9372854)
— [Details](attachment.cgi?id=9372854&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D195549>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a20936344_600971)• 1 year ago |

[Attachment #9372854](/attachment.cgi?id=9372854&action=edit "Bug 1833814 - change nsIWidget's cursor logic,") -
Flags: approval-mozilla-esr115?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1833814#c27)• 1 year ago |
|  | |

# Uplift Approval Request

* **Code covered by automated testing**: no
* **Is Android affected?**: no
* **Fix verified in Nightly**: no
* **Steps to reproduce for manual QE testing**: see [comment 3](/show_bug.cgi?id=1833814#c3 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") - in fixed builds, the custom cursor should be replaced with a normal mouse cursor as soon as the permission prompt appears (on Linux, Windows and macOS)
* **Explanation of risk level**: . The patch is fairly straightforward and there's a pref to turn things off if we get in a pickle. But unfortunately this isn't easily testable using automated tests
* **User impact if declined**: sec-high
* **Needs manual QE test**: yes
* **Risk associated with taking this patch**: Low to medium
* **String changes made/needed**: No
Flags: qe-verify+

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a20940875_695136)• 1 year ago |

[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix)
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=wontfix)
[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox123](/buglist.cgi?f1=cf_tracking_firefox123&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox123&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [123+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=123%2B)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1833814#c28)• 1 year ago |
|  | |

11 days ago, Gijs placed a reminder on the bug using the whiteboard tag `[reminder-landing 2024-01-22]` .

Gijs, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(gijskruitbosch+bugs)Whiteboard: [reporter-external] [client-bounty-form] [verif?] [reminder-landing 2024-01-22] → [reporter-external] [client-bounty-form] [verif?]

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1833814#c29)• 1 year ago |
|  | |

Pushed by gijskruitbosch@gmail.com:
<https://hg.mozilla.org/integration/autoland/rev/2424d5c30267>
change nsIWidget's cursor logic, r=emilio,win-reviewers,mhowell

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1833814#c30)• 1 year ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/2424d5c30267>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 1 year ago
[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 124 Branch

|  | [BugBot (nomail) [:suhaib / :marco/ :calixte]](/user_profile?user_id=710528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21610470_710528)• 1 year ago |

Keywords: [dupeme](/buglist.cgi?keywords=dupeme&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1833814#c31)• 1 year ago |
|  | |

Attached file
[Bug 1833814 - change nsIWidget's cursor logic, r?emilio](attachment.cgi?id=9376021)
— [Details](attachment.cgi?id=9376021&action=edit)

Original Revision: <https://phabricator.services.mozilla.com/D195549>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21636736_600971)• 1 year ago |

[Attachment #9376021](/attachment.cgi?id=9376021&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1833814#c32)• 1 year ago |
|  | |

# Uplift Approval Request

* **Steps to reproduce for manual QE testing**: see [comment 3](/show_bug.cgi?id=1833814#c3 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") - in fixed builds, the custom cursor should be replaced with a normal mouse cursor as soon as the permission prompt appears (on Linux, Windows and macOS)
* **Code covered by automated testing**: no
* **Is Android affected?**: no
* **Fix verified in Nightly**: no
* **User impact if declined**: sec-high
* **Explanation of risk level**: The patch is fairly straightforward and there's a pref to turn things off if we get in a pickle. Also it's early in the beta cycle. But unfortunately this isn't easily testable using automated tests
* **Needs manual QE test**: yes
* **Risk associated with taking this patch**: Low
* **String changes made/needed**: None

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21637452_159069)• 1 year ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21698908_600971)• 1 year ago |

[Attachment #9376021](/attachment.cgi?id=9376021&action=edit "Bug 1833814 - change nsIWidget's cursor logic, r?emilio") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21699224_640478)• 1 year ago |

[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1833814#c33)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/190710fe87f9>

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21770980_488993)• 1 year ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21785995_551058)• 1 year ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage] [qa-triaged]

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1833814#c34)• 1 year ago |
|  | |

I could not reproduce this issue in Nightly v124.0a1 from 2024-01-22, Beta v123.0b2 or in Release v122.0 in Windows 10, MacOS 11 or Ubuntu 22. The cursor does not change into a different shape or form and the permission dialog does not get covered in any way.

@Gijs: Do you have any idea why it wouldn't reproduce on my side? I have to mention that the test page in [comment 3](/show_bug.cgi?id=1833814#c3 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") is no longer available, while the attached test page in [comment 1](/show_bug.cgi?id=1833814#c1 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") would not show the starred rectangle at all. Thanks!

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1833814#c35)• 1 year ago |
|  | |

(In reply to Daniel Bodea [:danibodea] from [comment #34](/show_bug.cgi?id=1833814#c34 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)"))

> I could not reproduce this issue in Nightly v124.0a1 from 2024-01-22, Beta v123.0b2 or in Release v122.0 in Windows 10, MacOS 11 or Ubuntu 22. The cursor does not change into a different shape or form and the permission dialog does not get covered in any way.
>
> @Gijs: Do you have any idea why it wouldn't reproduce on my side? I have to mention that the test page in [comment 3](/show_bug.cgi?id=1833814#c3 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") is no longer available, while the attached test page in [comment 1](/show_bug.cgi?id=1833814#c1 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") would not show the starred rectangle at all. Thanks!

The testcase requires the 128x128 image file to live in the same directory (and probably requires accessing it through a webserver running either on https or localhost). I can try to get this up for you but currently fighting some webhosting issues and a few other fires. Let me know if you need this setting up for you or you can do it yourself?

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(dbodea)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1833814#c36)• 1 year ago |
|  | |

(In reply to :Gijs (he/him) from [comment #35](/show_bug.cgi?id=1833814#c35 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)"))

> (In reply to Daniel Bodea [:danibodea] from [comment #34](/show_bug.cgi?id=1833814#c34 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)"))
>
> > I could not reproduce this issue in Nightly v124.0a1 from 2024-01-22, Beta v123.0b2 or in Release v122.0 in Windows 10, MacOS 11 or Ubuntu 22. The cursor does not change into a different shape or form and the permission dialog does not get covered in any way.
> >
> > @Gijs: Do you have any idea why it wouldn't reproduce on my side? I have to mention that the test page in [comment 3](/show_bug.cgi?id=1833814#c3 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") is no longer available, while the attached test page in [comment 1](/show_bug.cgi?id=1833814#c1 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") would not show the starred rectangle at all. Thanks!
>
> The testcase requires the 128x128 image file to live in the same directory (and probably requires accessing it through a webserver running either on https or localhost). I can try to get this up for you but currently fighting some webhosting issues and a few other fires. Let me know if you need this setting up for you or you can do it yourself?

Figured my webhost out - <https://gijsk.com/temp/cursorpointer.html> .

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1833814#c37)• 1 year ago |
|  | |

Thank you for the help, Gijs!

I can confirm this reproduction in Release v122.0 as I could reproduce the behavior in the demo video. The fix can be verified in Beta v123.0.b2 and Nightly v124.0a1. The "starred rectangle" that covers the cursor and above is displayed just as long as a permission dialog appears; the rectangle won't cover up the permission dialog. Testing was performed in Windows 10, MacOS 11 and Ubuntu 22.

Status: RESOLVED → VERIFIED
[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=verified)
[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(dbodea)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a21890837_101158)• 1 year ago |

Regressions: [1876009](/show_bug.cgi?id=1876009 "RESOLVED FIXED - tb perma PROCESS-CRASH | application crashed [@ nsPresContext::GetPresShell] | comm/mail/test/browser/openpgp/browser_viewMessageSecurity.js")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1833814#c38)• 1 year ago |
|  | |

The security team thinks `sec-moderate` is more appropriate for this bug due to the user engineering an attack requires.

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a22251586_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a22817628_600971)• 11 months ago |

[Attachment #9372854](/attachment.cgi?id=9372854&action=edit "Bug 1833814 - change nsIWidget's cursor logic,") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1833814#c39)• 11 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/39193ec581e4>

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a22818014_24572)• 11 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1833814#c40)• 11 months ago |
|  | |

Backed out 1 changesets ([bug 1833814](/show_bug.cgi?id=1833814 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)")) for causing build failures on esr branch a=backout

<https://hg.mozilla.org/releases/mozilla-esr115/rev/ca5f8275ec21>

Gijs, the uplift to the esr115 branch is causing build failures:

<https://treeherder.mozilla.org/jobs?repo=mozilla-esr115&resultStatus=testfailed%2Cbusted%2Cexception&classifiedState=unclassified&revision=39193ec581e438ea4e1583e8e00f1fb3b3e8981d&selectedTaskRun=WRJJQgZbRXOPZ6u8etdCLg.0>

is there a dependent uplift missing for the branch maybe? Thanks

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)Flags: needinfo?(gijskruitbosch+bugs)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1833814#c41)• 11 months ago |
|  | |

Emilio, any idea why the ESR uplift is causing build bustage? Thanks

Flags: needinfo?(emilio)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1833814#c42)• 11 months ago |
|  | |

Looks like on ESR nsXULPopupManager.cpp is missing the layout staticprefs include. I'll update the ESR patch.

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1833814#c43)• 11 months ago |
|  | |

I've updated the patch, waiting on try to confirm it works.

Flags: needinfo?(emilio)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1833814#c44)• 11 months ago |
|  | |

# Uplift Approval Request

* **Fix verified in Nightly**: yes
* **Code covered by automated testing**: no
* **String changes made/needed**: no
* **Steps to reproduce for manual QE testing**: see [comment 3](/show_bug.cgi?id=1833814#c3 "VERIFIED FIXED - Custom Cursor mouse overlap permission request prompt (clickjacking on wrong button)") - in fixed builds, the custom cursor should be replaced with a normal mouse cursor as soon as the permission prompt appears (on Linux, Windows and macOS)
* **User impact if declined**: sec-moderate
* **Is Android affected?**: no
* **Needs manual QE test**: yes
* **Risk associated with taking this patch**: low to medium
* **Explanation of risk level**: The patch is fairly straightforward and there's a pref to turn things off if we get in a pickle. But unfortunately this isn't easily testable using automated tests
Flags: qe-verify+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a23106937_640478)• 11 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1833814#c45)• 11 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/428ddcca4f91>

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1833814#c46)• 11 months ago |
|  | |

The fix was also verified in ESR v115.8.0esr in Windows 10 and MacOS 11. The permission dialog cannot be covered by the "starred rectangle" in any way.

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)Flags: qe-verify+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a23465742_578488)• 11 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [adv-main123+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a23466293_578488)• 11 months ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [adv-main123+] → [reporter-external] [client-bounty-form] [verif?] [adv-main123+][adv-esr115.8+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1833814#c47)• 11 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9380026)
— [Details](attachment.cgi?id=9380026&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a23627694_578488)• 11 months ago |

Alias: CVE-2024-1549

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a32700153_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a32985835_1689)• 7 months ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---) → [csectype-clickjacking](/buglist.cgi?keywords=csectype-clickjacking&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a38074004_1689)• 5 months ago |

See Also: → [1908684](/show_bug.cgi?id=1908684 "NEW - when entering fullscreen mode (by playing a video without source tag) the cursor does not appear leading to clickjacking on permission dialog")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1833814#a42078612_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1833814&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_34fd28ef_20250111_160312.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-05

## Security Vulnerabilities fixed in Firefox 123

Announced
February 20, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 123

#### [#CVE-2024-1546: Out-of-bounds memory read in networking channels](#CVE-2024-1546)

Reporter
Alfred Peters
Impact
high
##### Description

When storing and re-accessing data on a networking channel, the length of buffers may have been confused, resulting in an out-of-bounds memory read.

##### References

* [Bug 1843752](https://bugzilla.mozilla.org/show_bug.cgi?id=1843752)

#### [#CVE-2024-1547: Alert dialog could have been spoofed on another site](#CVE-2024-1547)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of API calls and redirects, an attacker-controlled alert dialog could have been displayed on another website (with the victim website's URL shown).

##### References

* [Bug 1877879](https://bugzilla.mozilla.org/show_bug.cgi?id=1877879)

#### [#CVE-2024-1554: fetch could be used to effect cache poisoning](#CVE-2024-1554)

Reporter
scarlet
Impact
moderate
##### Description

The `fetch()` API and navigation incorrectly shared the same cache, as the cache key did not include the optional headers `fetch()` may contain. Under the correct circumstances, an attacker may have been able to poison the local browser cache by priming it with a `fetch()` response controlled by the additional headers. Upon navigation to the same URL, the user would see the cached response instead of the expected response.

##### References

* [Bug 1816390](https://bugzilla.mozilla.org/show_bug.cgi?id=1816390)

#### [#CVE-2024-1548: Fullscreen Notification could have been hidden by select element](#CVE-2024-1548)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a dropdown select input element. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832627](https://bugzilla.mozilla.org/show_bug.cgi?id=1832627)

#### [#CVE-2024-1549: Custom cursor could obscure the permission dialog](#CVE-2024-1549)

Reporter
Hafiizh
Impact
moderate
##### Description

If a website set a large custom cursor, portions of the cursor could have overlapped with the permission dialog, potentially resulting in user confusion and unexpected granted permissions.

##### References

* [Bug 1833814](https://bugzilla.mozilla.org/show_bug.cgi?id=1833814)

#### [#CVE-2024-1550: Mouse cursor re-positioned unexpectedly could have led to unintended permission grants](#CVE-2024-1550)

Reporter
Hafiizh
Impact
moderate
##### Description

A malicious website could have used a combination of exiting fullscreen mode and `requestPointerLock` to cause the user's mouse to be re-positioned unexpectedly, which could have led to user confusion and inadvertently granting permissions they did not intend to grant.

##### References

* [Bug 1860065](https://bugzilla.mozilla.org/show_bug.cgi?id=1860065)

#### [#CVE-2024-1551: Multipart HTTP Responses would accept the Set-Cookie header in response parts](#CVE-2024-1551)

Reporter
Johan Carlsson
Impact
moderate
##### Description

Set-Cookie response headers were being incorrectly honored in multipart HTTP responses. If an attacker could control the Content-Type response header, as well as control part of the response body, they could inject Set-Cookie response headers that would have been honored by the browser.

##### References

* [Bug 1864385](https://bugzilla.mozilla.org/show_bug.cgi?id=1864385)

#### [#CVE-2024-1555: SameSite cookies were not properly respected when opening a website from an external browser](#CVE-2024-1555)

Reporter
Narendra Bhati
Impact
moderate
##### Description

When opening a website using the `firefox://` protocol handler, SameSite cookies were not properly respected.

##### References

* [Bug 1873223](https://bugzilla.mozilla.org/show_bug.cgi?id=1873223)

#### [#CVE-2024-1556: Invalid memory access in the built-in profiler](#CVE-2024-1556)

Reporter
Ronald Crane
Impact
low
##### Description

The incorrect object was checked for NULL in the built-in profiler, potentially leading to invalid memory access and undefined behavior. *Note:* This issue only affects the application when the profiler is running.

##### References

* [Bug 1870414](https://bugzilla.mozilla.org/show_bug.cgi?id=1870414)

#### [#CVE-2024-1552: Incorrect code generation on 32-bit ARM devices](#CVE-2024-1552)

Reporter
Gary Kwong
Impact
low
##### Description

Incorrect code generation could have led to unexpected numeric conversions and potential undefined behavior. *Note:* This issue only affects 32-bit ARM devices.

##### References

* [Bug 1874502](https://bugzilla.mozilla.org/show_bug.cgi?id=1874502)

#### [#CVE-2024-1553: Memory safety bugs fixed in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8](#CVE-2024-1553)

Reporter
Andrew McCreight, Randell Jesup, Gabriele Svelto, Paul Bone, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855686%2C1867982%2C1871498%2C1872296%2C1873521%2C1873577%2C1873597%2C1873866%2C1874080%2C1874740%2C1875795%2C1875906%2C1876425%2C1878211%2C1878286)

#### [#CVE-2024-1557: Memory safety bugs fixed in Firefox 123](#CVE-2024-1557)

Reporter
Andrew McCreight, Randell Jesup, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 122. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 123](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1746471%2C1848829%2C1864011%2C1869175%2C1869455%2C1869938%2C1871606)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_f2a233af_20250111_160313.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-07

## Security Vulnerabilities fixed in Thunderbird 115.8

Announced
February 20, 2024
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.8

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2024-1546: Out-of-bounds memory read in networking channels](#CVE-2024-1546)

Reporter
Alfred Peters
Impact
high
##### Description

When storing and re-accessing data on a networking channel, the length of buffers may have been confused, resulting in an out-of-bounds memory read.

##### References

* [Bug 1843752](https://bugzilla.mozilla.org/show_bug.cgi?id=1843752)

#### [#CVE-2024-1547: Alert dialog could have been spoofed on another site](#CVE-2024-1547)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of API calls and redirects, an attacker-controlled alert dialog could have been displayed on another website (with the victim website's URL shown).

##### References

* [Bug 1877879](https://bugzilla.mozilla.org/show_bug.cgi?id=1877879)

#### [#CVE-2024-1548: Fullscreen Notification could have been hidden by select element](#CVE-2024-1548)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a dropdown select input element. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832627](https://bugzilla.mozilla.org/show_bug.cgi?id=1832627)

#### [#CVE-2024-1549: Custom cursor could obscure the permission dialog](#CVE-2024-1549)

Reporter
Hafiizh
Impact
moderate
##### Description

If a website set a large custom cursor, portions of the cursor could have overlapped with the permission dialog, potentially resulting in user confusion and unexpected granted permissions.

##### References

* [Bug 1833814](https://bugzilla.mozilla.org/show_bug.cgi?id=1833814)

#### [#CVE-2024-1550: Mouse cursor re-positioned unexpectedly could have led to unintended permission grants](#CVE-2024-1550)

Reporter
Hafiizh
Impact
moderate
##### Description

A malicious website could have used a combination of exiting fullscreen mode and `requestPointerLock` to cause the user's mouse to be re-positioned unexpectedly, which could have led to user confusion and inadvertently granting permissions they did not intend to grant.

##### References

* [Bug 1860065](https://bugzilla.mozilla.org/show_bug.cgi?id=1860065)

#### [#CVE-2024-1551: Multipart HTTP Responses would accept the Set-Cookie header in response parts](#CVE-2024-1551)

Reporter
Johan Carlsson
Impact
moderate
##### Description

Set-Cookie response headers were being incorrectly honored in multipart HTTP responses. If an attacker could control the Content-Type response header, as well as control part of the response body, they could inject Set-Cookie response headers that would have been honored by the browser.

##### References

* [Bug 1864385](https://bugzilla.mozilla.org/show_bug.cgi?id=1864385)

#### [#CVE-2024-1552: Incorrect code generation on 32-bit ARM devices](#CVE-2024-1552)

Reporter
Gary Kwong
Impact
low
##### Description

Incorrect code generation could have led to unexpected numeric conversions and potential undefined behavior.*Note:* This issue only affects 32-bit ARM devices.

##### References

* [Bug 1874502](https://bugzilla.mozilla.org/show_bug.cgi?id=1874502)

#### [#CVE-2024-1553: Memory safety bugs fixed in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8](#CVE-2024-1553)

Reporter
Andrew McCreight, Randell Jesup, Gabriele Svelto, Paul Bone, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855686%2C1867982%2C1871498%2C1872296%2C1873521%2C1873577%2C1873597%2C1873866%2C1874080%2C1874740%2C1875795%2C1875906%2C1876425%2C1878211%2C1878286)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_8819f407_20250111_160311.html ===


---

[Date Prev][[Date Next](msg00001.html)]
[Thread Prev][[Thread Next](msg00001.html)]
[[Date Index](maillist.html#00000)]
[[Thread Index](threads.html#00000)]

# [SECURITY] [DLA 3747-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3747-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Mon, 4 Mar 2024 08:52:24 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20240304075224.CE16D2A00FC%40andromeda) [20240304075224.CE16D2A00FC@andromeda](msg00000.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3747-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
March 04, 2024                                <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.8.0esr-1~deb10u1
CVE ID         : CVE-2024-1546 CVE-2024-1547 CVE-2024-1548 CVE-2024-1549
                 CVE-2024-1550 CVE-2024-1551 CVE-2024-1552 CVE-2024-1553

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, information disclosure or spoofing.

For Debian 10 buster, these problems have been fixed in version
115.8.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmXlfbUACgkQnUbEiOQ2
gwICEg//WyCKez7kQj0ncUzW/DKkYtCMkGtqmpyWE8VbuTamlbX2TmclQ0MFU6dx
5jlOI8s2Le0NCh08Le7AepYqOwLk9ypXIXcltGTMzctxQFXPPVBlhwbM2LRl9cka
MMLr54JRi9MKgBbZNmxEiEGOZTu9IRFKJLvC8Lkz5Sx0iJepPuoWWNsHjcOvtuqb
cEoeZd7wj1xCe6ekZJLSj0hxTrH80FBSCInpG80tDztd0gAIkoKLhI4rTmPlQs+A
wDpW3U0qJiOvTBPVXJmUbLHnSwiaUkaRymrRahPRoS7LQ0AbOViY16QDtEre/1Jq
qXCxvKeQiYIuHekFp1cIHNEIhDs7yIjvEptvYp2EnW2DFWA2P8OmVHMwM4UsPFuR
xqnulZcfsZgCO682HL91NI03pe0urFIFR4RbzwvUuuXNtbUcea8lNxjfsXVknjfi
M2vBPY3N/JEk+NRKv4sWhzImjEj1NqN0trLvZ94TxJA5EVAEYOf2Yp7QAN7uK98c
hIUziyQlE1dgUxRqFPfHJ9gVKGyl1W9e176+4ulFo4JRLQemI8PVI5fzTLpAShh4
FiqVfE+L6j02u4qJsbseK7jrP+Ehv/XbKBf2u1b9lNWTPVW7ySPBi7IlXsdXL7yw
SZDBABOMVsRHe96ca1Y5us7rRxTFVSQjOSN72rKAniA4OJVEotc=
=nell
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_59ecc779_20250111_160313.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-06

## Security Vulnerabilities fixed in Firefox ESR 115.8

Announced
February 20, 2024
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.8

#### [#CVE-2024-1546: Out-of-bounds memory read in networking channels](#CVE-2024-1546)

Reporter
Alfred Peters
Impact
high
##### Description

When storing and re-accessing data on a networking channel, the length of buffers may have been confused, resulting in an out-of-bounds memory read.

##### References

* [Bug 1843752](https://bugzilla.mozilla.org/show_bug.cgi?id=1843752)

#### [#CVE-2024-1547: Alert dialog could have been spoofed on another site](#CVE-2024-1547)

Reporter
Irvan Kurniawan
Impact
high
##### Description

Through a series of API calls and redirects, an attacker-controlled alert dialog could have been displayed on another website (with the victim website's URL shown).

##### References

* [Bug 1877879](https://bugzilla.mozilla.org/show_bug.cgi?id=1877879)

#### [#CVE-2024-1548: Fullscreen Notification could have been hidden by select element](#CVE-2024-1548)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the fullscreen notification by using a dropdown select input element. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1832627](https://bugzilla.mozilla.org/show_bug.cgi?id=1832627)

#### [#CVE-2024-1549: Custom cursor could obscure the permission dialog](#CVE-2024-1549)

Reporter
Hafiizh
Impact
moderate
##### Description

If a website set a large custom cursor, portions of the cursor could have overlapped with the permission dialog, potentially resulting in user confusion and unexpected granted permissions.

##### References

* [Bug 1833814](https://bugzilla.mozilla.org/show_bug.cgi?id=1833814)

#### [#CVE-2024-1550: Mouse cursor re-positioned unexpectedly could have led to unintended permission grants](#CVE-2024-1550)

Reporter
Hafiizh
Impact
moderate
##### Description

A malicious website could have used a combination of exiting fullscreen mode and `requestPointerLock` to cause the user's mouse to be re-positioned unexpectedly, which could have led to user confusion and inadvertently granting permissions they did not intend to grant.

##### References

* [Bug 1860065](https://bugzilla.mozilla.org/show_bug.cgi?id=1860065)

#### [#CVE-2024-1551: Multipart HTTP Responses would accept the Set-Cookie header in response parts](#CVE-2024-1551)

Reporter
Johan Carlsson
Impact
moderate
##### Description

Set-Cookie response headers were being incorrectly honored in multipart HTTP responses. If an attacker could control the Content-Type response header, as well as control part of the response body, they could inject Set-Cookie response headers that would have been honored by the browser.

##### References

* [Bug 1864385](https://bugzilla.mozilla.org/show_bug.cgi?id=1864385)

#### [#CVE-2024-1552: Incorrect code generation on 32-bit ARM devices](#CVE-2024-1552)

Reporter
Gary Kwong
Impact
low
##### Description

Incorrect code generation could have led to unexpected numeric conversions and potential undefined behavior.*Note:* This issue only affects 32-bit ARM devices.

##### References

* [Bug 1874502](https://bugzilla.mozilla.org/show_bug.cgi?id=1874502)

#### [#CVE-2024-1553: Memory safety bugs fixed in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8](#CVE-2024-1553)

Reporter
Andrew McCreight, Randell Jesup, Gabriele Svelto, Paul Bone, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855686%2C1867982%2C1871498%2C1872296%2C1873521%2C1873577%2C1873597%2C1873866%2C1874080%2C1874740%2C1875795%2C1875906%2C1876425%2C1878211%2C1878286)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


