Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-4087

**Root Cause:**
The vulnerability stems from insufficient input sanitization and output escaping of user-supplied attributes within the "Back to Top" widget of the Royal Elementor Addons and Templates plugin. Specifically, the `data-settings` attribute was not properly escaped.

**Weaknesses/Vulnerabilities:**
*   **Stored Cross-Site Scripting (XSS):** The plugin fails to properly sanitize user-supplied data, allowing an attacker to inject malicious JavaScript code into the `data-settings` attribute of the back-to-top widget.

**Impact of Exploitation:**
*   **Arbitrary Script Execution:** Successful exploitation allows an attacker to inject and execute arbitrary web scripts in the context of the victim's browser. This could lead to various malicious activities, such as:
    *   Session hijacking
    *   Redirection to malicious sites
    *   Defacement of the website
    *   Data theft
    *   Other client-side attacks.

**Attack Vectors:**
*   The attack vector is through the "Back to Top" widget functionality of the Royal Elementor Addons and Templates plugin. Specifically, by manipulating the settings of the widget.

**Required Attacker Capabilities/Position:**
*   **Authentication:** The attacker must be authenticated with contributor-level access or higher to the WordPress website. This means they have the capability to edit pages or posts.
*   **Plugin Access:** The attacker needs the ability to modify or add the "Back to Top" widget to a page or post.

**Technical Details:**
*   The vulnerability lies in the `render()` function of the `wpr-back-to-top.php` file. In versions up to 1.3.975, the data-settings attribute was not escaped, leading to XSS:
```php
echo "<div class='wpr-stt-btn' data-settings='". wp_json_encode($stt_settings) ."'>";
```
* The fix involves using `esc_attr()` to properly escape the JSON data before output:
```php
echo "<div class='wpr-stt-btn' data-settings='". esc_attr(wp_json_encode($stt_settings)) ."'>";
```
* The vulnerability is present in versions <= 1.3.975 of the plugin and is patched in version 1.3.976.

**Summary**
The identified vulnerability is a Stored XSS vulnerability that can be exploited by authenticated users with contributor access or higher. The root cause is the improper handling of user-provided data in the back-to-top widget's data-settings attribute, allowing attackers to inject malicious code into the page. The impact of a successful exploit can be significant, leading to a wide range of client-side attacks.