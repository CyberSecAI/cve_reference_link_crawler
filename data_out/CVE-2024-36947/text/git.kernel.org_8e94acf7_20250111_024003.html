

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Al Viro <viro@zeniv.linux.org.uk> | 2024-02-25 23:58:42 -0500 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-17 12:14:50 +0200 |
| commit | [02ee394a5d899d9bd2f0759382e9481cab6166f8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8)) | |
| tree | [1e34713a8aaed8df6af2ad49ad9498830fb63a07](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8) | |
| parent | [024f7744bd09cb2a47a0a96b9c8ad08109de99cc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=024f7744bd09cb2a47a0a96b9c8ad08109de99cc) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8&id2=024f7744bd09cb2a47a0a96b9c8ad08109de99cc)) | |
| download | [linux-02ee394a5d899d9bd2f0759382e9481cab6166f8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-02ee394a5d899d9bd2f0759382e9481cab6166f8.tar.gz) | |

qibfs: fix dentry leak[ Upstream commit aa23317d0268b309bb3f0801ddd0d61813ff5afb ]
simple\_recursive\_removal() drops the pinning references to all positives
in subtree. For the cases when its argument has been kept alive by
the pinning alone that's exactly the right thing to do, but here
the argument comes from dcache lookup, that needs to be balanced by
explicit dput().
Fixes: e41d237818598 "qib\_fs: switch to simple\_recursive\_removal()"
Fucked-up-by: Al Viro <viro@zeniv.linux.org.uk>
Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02ee394a5d899d9bd2f0759382e9481cab6166f8)

| -rw-r--r-- | [drivers/infiniband/hw/qib/qib\_fs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/infiniband/hw/qib/qib_fs.c?id=02ee394a5d899d9bd2f0759382e9481cab6166f8) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/infiniband/hw/qib/qib\_fs.c b/drivers/infiniband/hw/qib/qib\_fs.cindex 455e966eeff390..b27791029fa934 100644--- a/[drivers/infiniband/hw/qib/qib\_fs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/infiniband/hw/qib/qib_fs.c?id=024f7744bd09cb2a47a0a96b9c8ad08109de99cc)+++ b/[drivers/infiniband/hw/qib/qib\_fs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/infiniband/hw/qib/qib_fs.c?id=02ee394a5d899d9bd2f0759382e9481cab6166f8)@@ -439,6 +439,7 @@ static int remove\_device\_files(struct super\_block \*sb, return PTR\_ERR(dir); } simple\_recursive\_removal(dir, NULL);+ dput(dir); return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 02:38:41 +0000

