=== Content from github.com_d61b9658_20250110_162611.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjshttp%2Fcookie%2Fsecurity%2Fadvisories%2FGHSA-pxg6-pf52-xh8x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjshttp%2Fcookie%2Fsecurity%2Fadvisories%2FGHSA-pxg6-pf52-xh8x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=jshttp%2Fcookie)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jshttp](/jshttp)
/
**[cookie](/jshttp/cookie)**
Public

* [Notifications](/login?return_to=%2Fjshttp%2Fcookie) You must be signed in to change notification settings
* [Fork
  161](/login?return_to=%2Fjshttp%2Fcookie)
* [Star
   1.4k](/login?return_to=%2Fjshttp%2Fcookie)

* [Code](/jshttp/cookie)
* [Issues
  3](/jshttp/cookie/issues)
* [Pull requests
  6](/jshttp/cookie/pulls)
* [Actions](/jshttp/cookie/actions)
* [Security](/jshttp/cookie/security)
* [Insights](/jshttp/cookie/pulse)

Additional navigation options

* [Code](/jshttp/cookie)
* [Issues](/jshttp/cookie/issues)
* [Pull requests](/jshttp/cookie/pulls)
* [Actions](/jshttp/cookie/actions)
* [Security](/jshttp/cookie/security)
* [Insights](/jshttp/cookie/pulse)

# Cookie name, path, and domain accept out of bounds characters

Low

[blakeembrey](/blakeembrey)
published
GHSA-pxg6-pf52-xh8x
Oct 4, 2024

## Package

npm

cookie
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<0.7.0

## Patched versions

0.7.0

## Description

### Impact

The cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, `serialize("userName=<script>alert('XSS3')</script>; Max-Age=2592000; a", value)` would result in `"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test"`, setting `userName` cookie to `<script>` and ignoring `value`.

A similar escape can be used for `path` and `domain`, which could be abused to alter other fields of the cookie.

### Patches

Upgrade to 0.7.0, which updates the validation for `name`, `path`, and `domain`.

### Workarounds

Avoid passing untrusted or arbitrary values for these fields, ensure they are set by the application instead of user input.

### References

* [#167](https://github.com/jshttp/cookie/pull/167)

### Severity

Low

### CVE ID

CVE-2024-47764

### Weaknesses

No CWEs

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_730da2e7_20250110_162610.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjshttp%2Fcookie%2Fpull%2F167)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjshttp%2Fcookie%2Fpull%2F167)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=jshttp%2Fcookie)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jshttp](/jshttp)
/
**[cookie](/jshttp/cookie)**
Public

* [Notifications](/login?return_to=%2Fjshttp%2Fcookie) You must be signed in to change notification settings
* [Fork
  161](/login?return_to=%2Fjshttp%2Fcookie)
* [Star
   1.4k](/login?return_to=%2Fjshttp%2Fcookie)

* [Code](/jshttp/cookie)
* [Issues
  3](/jshttp/cookie/issues)
* [Pull requests
  6](/jshttp/cookie/pulls)
* [Actions](/jshttp/cookie/actions)
* [Security](/jshttp/cookie/security)
* [Insights](/jshttp/cookie/pulse)

Additional navigation options

* [Code](/jshttp/cookie)
* [Issues](/jshttp/cookie/issues)
* [Pull requests](/jshttp/cookie/pulls)
* [Actions](/jshttp/cookie/actions)
* [Security](/jshttp/cookie/security)
* [Insights](/jshttp/cookie/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fjshttp%2Fcookie%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fjshttp%2Fcookie%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix: narrow the validation of cookies to match RFC6265 #167

 Merged

[blakeembrey](/blakeembrey)
merged 6 commits into
[jshttp:master](/jshttp/cookie/tree/master "jshttp/cookie:master")
from
[bewinsnw:bewins/regexps](/bewinsnw/cookie/tree/bewins/regexps "bewinsnw/cookie:bewins/regexps")

Oct 1, 2024

 Merged

# [fix: narrow the validation of cookies to match RFC6265](#top) #167

[blakeembrey](/blakeembrey)
merged 6 commits into
[jshttp:master](/jshttp/cookie/tree/master "jshttp/cookie:master")
from
[bewinsnw:bewins/regexps](/bewinsnw/cookie/tree/bewins/regexps "bewinsnw/cookie:bewins/regexps")

Oct 1, 2024

+59

‚àí9

[Conversation
9](/jshttp/cookie/pull/167)
[Commits
6](/jshttp/cookie/pull/167/commits)
[Checks
26](/jshttp/cookie/pull/167/checks)
[Files changed
2](/jshttp/cookie/pull/167/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=60&v=4)](/bewinsnw)

Copy link

Contributor

### @bewinsnw **[bewinsnw](/bewinsnw)** commented [Jul 17, 2024](#issue-2414371453)

fixes [#165](https://github.com/jshttp/cookie/issues/165). Previously, validation on serialization used the field-content regexp from RFC7230 to perform all checks. However, that is the regexp for the cookie header as a whole, but each individual part of a cookie has a tighter restriction.

In the bug report [#165](https://github.com/jshttp/cookie/issues/165) I demonstrated that whitespace in names and values was invalid but allowed by the field-content pattern. In this code I started by adding tests for those two cases, then added the expressions derived from the RFC; the relevant portions of the RFC have been inlined as comments.

Removing the field-content regexp unearthed that as well as those two it was being used to validate domain names and paths. Paths are fairly unrestricted (being any ascii character except control characters and semicolon) but the code was wrong here too - it allowed all 8-bit characters not just 7-bit characters.

Domain names have a well recognised pattern, there are only a couple of gotchas: RFC6265 explicitly says RFC1123 applies, so the leading character of a label is allowed to be a digit; and while I wondered for a moment if this should allow things like [::1] the domain matching section of <https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.3> teaches that domain values are *not* ip addresses.

Sorry, something went wrong.

 üëç
3
 q--, treblasft, and albertms10 reacted with thumbs up emoji
 üéâ
5
 travisby, AllanOricil, mirasayon, treblasft, and albertms10 reacted with hooray emoji
 üöÄ
3
 travisby, treblasft, and albertms10 reacted with rocket emoji

All reactions

* üëç
  3 reactions
* üéâ
  5 reactions
* üöÄ
  3 reactions

 [bewinsnw](/bewinsnw)
added 2 commits
[July 17, 2024 20:16](#commits-pushed-b45a9ed)

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=40&v=4)](/bewinsnw)

`[fix: narrow the validation cookies to match RFC6265](/jshttp/cookie/pull/167/commits/b45a9ed44dc8234f0c7871e173571f6fb8fb0266 "fix: narrow the validation cookies to match RFC6265

fixes #165. Previously, validation on serialization used the field-content
regexp from RFC7230 to perform all checks. However, that is the regexp
for the cookie header as a whole, but each individual part of a cookie
has a tighter restriction.

In the bug report #165 I demonstrated that whitespace in names and values
was invalid but allowed by the field-content pattern. In this code I
started by adding tests for those two cases, then added the expressions
derived from the RFC; the relevant portions of the RFC have been inlined
as comments.

Removing the field-content regexp unearthed that as well as those two
it was being used to validate domain names and paths. Paths are fairly
unrestricted (being any ascii character except control characters and
semicolon) but the code was wrong here too - it allowed all 8-bit characters
not just 7-bit characters.

Domain names have a well recognised pattern, there are only a couple of
gotchas: RFC6265 explicitly says RFC1123 applies, so the leading character
of a label is allowed to be a digit; and while I wondered for a moment
if this should allow things like [::1] the domain matching section of
https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.3
teaches that domain values are _not_ ip addresses.")`
 ‚Ä¶

`[b45a9ed](/jshttp/cookie/pull/167/commits/b45a9ed44dc8234f0c7871e173571f6fb8fb0266)`

```
fixes [jshttp#165](https://github.com/jshttp/cookie/issues/165). Previously, validation on serialization used the field-content
regexp from RFC7230 to perform all checks. However, that is the regexp
for the cookie header as a whole, but each individual part of a cookie
has a tighter restriction.

In the bug report [jshttp#165](https://github.com/jshttp/cookie/issues/165) I demonstrated that whitespace in names and values
was invalid but allowed by the field-content pattern. In this code I
started by adding tests for those two cases, then added the expressions
derived from the RFC; the relevant portions of the RFC have been inlined
as comments.

Removing the field-content regexp unearthed that as well as those two
it was being used to validate domain names and paths. Paths are fairly
unrestricted (being any ascii character except control characters and
semicolon) but the code was wrong here too - it allowed all 8-bit characters
not just 7-bit characters.

Domain names have a well recognised pattern, there are only a couple of
gotchas: RFC6265 explicitly says RFC1123 applies, so the leading character
of a label is allowed to be a digit; and while I wondered for a moment
if this should allow things like [::1] the domain matching section of
<https://datatracker.ietf.org/doc/html/rfc6265#section-5.1.3>
teaches that domain values are _not_ ip addresses.
```

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=40&v=4)](/bewinsnw)

`[chore: removing some extra spaces](/jshttp/cookie/pull/167/commits/adf50e45f941cc65a4a17e6e1b24e4da62b601f4 "chore: removing some extra spaces")`

`[adf50e4](/jshttp/cookie/pull/167/commits/adf50e45f941cc65a4a17e6e1b24e4da62b601f4)`

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=40&u=8f32f523c7201d6c8db80f9915c31577dd06de54&v=4)](/bewinsnw)
[bewinsnw](/bewinsnw)
changed the title
~~fix: narrow the validation cookies to match RFC6265~~
fix: narrow the validation of cookies to match RFC6265
[Jul 17, 2024](#event-13542050334)

[![wesleytodd](https://avatars.githubusercontent.com/u/1027776?s=60&v=4)](/wesleytodd)

**[wesleytodd](/wesleytodd)**
requested changes
[Jul 17, 2024](#pullrequestreview-2184012969)

 [View reviewed changes](/jshttp/cookie/pull/167/files/adf50e45f941cc65a4a17e6e1b24e4da62b601f4)

[index.js](/jshttp/cookie/pull/167/files/adf50e45f941cc65a4a17e6e1b24e4da62b601f4#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346)
Outdated

Show resolved

Hide resolved

[![@wesleytodd](https://avatars.githubusercontent.com/u/1027776?s=80&v=4)](/wesleytodd)

Copy link

Member

### **[wesleytodd](/wesleytodd)** commented [Jul 17, 2024](#issuecomment-2234267484)

| Thanks, this VERY well structured from the comments to the new regular expressions, great work. CI is passing, but I want to wait a bit and see if anyone else on the project as opinions on this. My one review comment is not intended to block, so if you feel strongly about that form of regex please tell me. |
| --- |

All reactions

Sorry, something went wrong.

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=40&v=4)](/bewinsnw)

`[chore: reorder regexp per review comment](/jshttp/cookie/pull/167/commits/23187ce118dbdff718f866597dc69631ca73243b "chore: reorder regexp per review comment

The regexp should be in the same order as the RFC grammar, for ease
of checking.")`
 ‚Ä¶

`[23187ce](/jshttp/cookie/pull/167/commits/23187ce118dbdff718f866597dc69631ca73243b)`

```
The regexp should be in the same order as the RFC grammar, for ease
of checking.
```

[![wesleytodd](https://avatars.githubusercontent.com/u/1027776?s=60&v=4)](/wesleytodd)

**[wesleytodd](/wesleytodd)**
approved these changes
[Jul 17, 2024](#pullrequestreview-2184225942)

 [View reviewed changes](/jshttp/cookie/pull/167/files/23187ce118dbdff718f866597dc69631ca73243b)

[![IamLizu](https://avatars.githubusercontent.com/u/26184316?s=60&v=4)](/IamLizu)

**[IamLizu](/IamLizu)**
reviewed
[Jul 18, 2024](#pullrequestreview-2184901770)

 [View reviewed changes](/jshttp/cookie/pull/167/files/23187ce118dbdff718f866597dc69631ca73243b)

Copy link

Member

### @IamLizu **[IamLizu](/IamLizu)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM üëç

Sorry, something went wrong.

All reactions

[![bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=60&v=4)](/bewinsnw)

**[bewinsnw](/bewinsnw)**
commented
[Jul 18, 2024](#pullrequestreview-2185874845)

 [View reviewed changes](/jshttp/cookie/pull/167/files/23187ce118dbdff718f866597dc69631ca73243b)

[index.js](/jshttp/cookie/pull/167/files/23187ce118dbdff718f866597dc69631ca73243b#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346)

Show resolved

Hide resolved

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=40&v=4)](/bewinsnw)

`[chore: document the meaning of CHAR](/jshttp/cookie/pull/167/commits/3963475d2293fdd0a1bc019059103a06a95e2d2c "chore: document the meaning of CHAR")`

`[3963475](/jshttp/cookie/pull/167/commits/3963475d2293fdd0a1bc019059103a06a95e2d2c)`

[![bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=60&v=4)](/bewinsnw)

**[bewinsnw](/bewinsnw)**
commented
[Jul 18, 2024](#pullrequestreview-2185896123)

 [View reviewed changes](/jshttp/cookie/pull/167/files/3963475d2293fdd0a1bc019059103a06a95e2d2c)

[index.js](/jshttp/cookie/pull/167/files/3963475d2293fdd0a1bc019059103a06a95e2d2c#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346)

Show resolved

Hide resolved

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=40&v=4)](/bewinsnw)

`[chore: missing whitespace after comment block](/jshttp/cookie/pull/167/commits/32046d43e378b4403e163b9cfc230aa91c343436 "chore: missing whitespace after comment block")`

`[32046d4](/jshttp/cookie/pull/167/commits/32046d43e378b4403e163b9cfc230aa91c343436)`

[![@wesleytodd](https://avatars.githubusercontent.com/u/1027776?s=80&v=4)](/wesleytodd)

Copy link

Member

### **[wesleytodd](/wesleytodd)** commented [Jul 27, 2024](#issuecomment-2253664386)

| Hey, can we fix up the lint issues? After that I think we can land this and update in both `express` v4 and v5 |
| --- |

All reactions

Sorry, something went wrong.

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=40&v=4)](/bewinsnw)

`[chore: trailing space](/jshttp/cookie/pull/167/commits/22e5f22bf89ecfed48965b68be3ba00f7f7f45f4 "chore: trailing space")`

`[22e5f22](/jshttp/cookie/pull/167/commits/22e5f22bf89ecfed48965b68be3ba00f7f7f45f4)`

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=80&u=8f32f523c7201d6c8db80f9915c31577dd06de54&v=4)](/bewinsnw)

Copy link

Contributor

Author

### **[bewinsnw](/bewinsnw)** commented [Jul 27, 2024](#issuecomment-2254193596)

| Hey, can we fix up the lint issues? After that I think we can land this and update in both `express` v4 and v5  ü§¶ that's what I get for doing those last two commits in the online editor. Fixed, thanks |
| --- |

All reactions

Sorry, something went wrong.

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=80&u=8f32f523c7201d6c8db80f9915c31577dd06de54&v=4)](/bewinsnw)

Copy link

Contributor

Author

### **[bewinsnw](/bewinsnw)** commented [Jul 31, 2024](#issuecomment-2261265857)

| I think that coveralls just glitched out. I can see at <https://coveralls.io/builds/68891763> that the coveralls run was successful, but it looks like it never reported back to github. Just needs a kick. |
| --- |

All reactions

Sorry, something went wrong.

[hdtmccallie](/hdtmccallie)
added a commit
to hdtmccallie/jshttp-cookie
that referenced
this pull request
[Oct 1, 2024](#ref-commit-684d088)
[![@hdtmccallie](https://avatars.githubusercontent.com/u/162155285?s=40&u=e6e95062a59212748fcb474ee9b3ed19940fd95e&v=4)](/hdtmccallie)

`[test(serialize): additional tests for proper name, domain and path RF‚Ä¶](/hdtmccallie/jshttp-cookie/commit/684d088309a84065f22341f0c22d58173563dfbd "test(serialize): additional tests for proper name, domain and path RFC validations

These tests are to help illustrate vulnerabilities in the cookie name, domain and path strings. The lack of filtering delimiters like semicolon and comma is the major concern but other characters can present security problems as well.

[PR #167][1] fixes these vulnerabilities and tests should pass with those new validations added.

[1]: https://github.com/jshttp/cookie/pull/167")`
‚Ä¶

`[684d088](/hdtmccallie/jshttp-cookie/commit/684d088309a84065f22341f0c22d58173563dfbd)`

```
‚Ä¶C validations

These tests are to help illustrate vulnerabilities in the cookie name, domain and path strings. The lack of filtering delimiters like semicolon and comma is the major concern but other characters can present security problems as well.

[PR [jshttp#167](https://github.com/jshttp/cookie/pull/167)][1] fixes these vulnerabilities and tests should pass with those new validations added.

[1]: [jshttp#167](https://github.com/jshttp/cookie/pull/167)
```

[![@hdtmccallie](https://avatars.githubusercontent.com/u/162155285?s=40&u=e6e95062a59212748fcb474ee9b3ed19940fd95e&v=4)](/hdtmccallie)
[hdtmccallie](/hdtmccallie)
mentioned this pull request
[Oct 1, 2024](#ref-pullrequest-2558271458)

[test(serialize): additional tests for proper name, domain and path RFC Validations
hdtmccallie/jshttp-cookie#1](/hdtmccallie/jshttp-cookie/pull/1)
 Closed

 Hide details
View details

[![@blakeembrey](https://avatars.githubusercontent.com/u/1088987?s=40&v=4)](/blakeembrey)
[blakeembrey](/blakeembrey)
merged commit [`e100428`](/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c)
into
jshttp:master

[Oct 1, 2024](https://github.com/jshttp/cookie/pull/167#event-14480451338)
26 checks passed

[hdtmccallie](/hdtmccallie)
added a commit
to hdtmccallie/jshttp-cookie
that referenced
this pull request
[Oct 2, 2024](#ref-commit-f3c7217)
[![@hdtmccallie](https://avatars.githubusercontent.com/u/162155285?s=40&u=e6e95062a59212748fcb474ee9b3ed19940fd95e&v=4)](/hdtmccallie)

`[test(serialize): additional tests for name, domain and path RFC valid‚Ä¶](/hdtmccallie/jshttp-cookie/commit/f3c7217297ff7c391c84deeb72bf9a3112b47f2e "test(serialize): additional tests for name, domain and path RFC validations

These tests better align with the proper RFC rules for the cookie attributes of `name`, `domain`, and `path`.

These test are meant to be implemented along with [PR #167][1] that adds more fine-grained validations based on RFC rules.

[1]: https://github.com/jshttp/cookie/pull/167")`
‚Ä¶

`[f3c7217](/hdtmccallie/jshttp-cookie/commit/f3c7217297ff7c391c84deeb72bf9a3112b47f2e)`

```
‚Ä¶ations

These tests better align with the proper RFC rules for the cookie attributes of `name`, `domain`, and `path`.

These test are meant to be implemented along with [PR [jshttp#167](https://github.com/jshttp/cookie/pull/167)][1] that adds more fine-grained validations based on RFC rules.

[1]: [jshttp#167](https://github.com/jshttp/cookie/pull/167)
```

[![@hdtmccallie](https://avatars.githubusercontent.com/u/162155285?s=40&u=e6e95062a59212748fcb474ee9b3ed19940fd95e&v=4)](/hdtmccallie)
[hdtmccallie](/hdtmccallie)
mentioned this pull request
[Oct 2, 2024](#ref-pullrequest-2560658397)

[test(serialize): additional tests for name, domain and path RFC validations
#171](/jshttp/cookie/pull/171)
 Merged

[![@Nickk4](https://avatars.githubusercontent.com/u/10728166?s=40&v=4)](/Nickk4)
[Nickk4](/Nickk4)
mentioned this pull request
[Oct 4, 2024](#ref-issue-2567347910)

[Cookie dependency needs updating
expressjs/cookie-parser#114](/expressjs/cookie-parser/issues/114)

Closed

[![@klobucar](https://avatars.githubusercontent.com/u/223349?s=40&v=4)](/klobucar)
[klobucar](/klobucar)
mentioned this pull request
[Oct 5, 2024](#ref-pullrequest-2567645683)

[build(deps): bump jshttp/cookie from 0.6.0 to 0.7.1
auth0/nextjs-auth0#1778](/auth0/nextjs-auth0/pull/1778)
 Merged

2 tasks

This was referenced Oct 6, 2024

[[Snyk] Security upgrade cookie from 0.3.1 to 0.7.0
Omrisnyk/npm-lockfiles#192](/Omrisnyk/npm-lockfiles/pull/192)
 Open

[[Snyk] Fix for 3 vulnerabilities
Omrisnyk/ElastiQuill#70](/Omrisnyk/ElastiQuill/pull/70)
 Open

[[Snyk] Security upgrade cookie from 0.3.1 to 0.7.0
Omrisnyk/ElastiQuill#71](/Omrisnyk/ElastiQuill/pull/71)
 Open

[![@ivasilov](https://avatars.githubusercontent.com/u/568291?s=40&v=4)](/ivasilov)
[ivasilov](/ivasilov)
mentioned this pull request
[Oct 7, 2024](#ref-issue-2570087275)

[Bump `cookie` to v0.7.0
bundled-es-modules/cookie#2](/bundled-es-modules/cookie/issues/2)

Closed

[![@hyunbinseo](https://avatars.githubusercontent.com/u/47051820?s=40&v=4)](/hyunbinseo)
[hyunbinseo](/hyunbinseo)
mentioned this pull request
[Oct 8, 2024](#ref-pullrequest-2570785425)

[chore: revert cookie upgrade
sveltejs/kit#12767](/sveltejs/kit/pull/12767)
 Merged

6 tasks

[![@LukasStordeur](https://avatars.githubusercontent.com/u/44098050?s=40&v=4)](/LukasStordeur)
[LukasStordeur](/LukasStordeur)
mentioned this pull request
[Oct 9, 2024](#ref-pullrequest-2575194758)

[security-80 : resolution for cookie dependency
inmanta/web-console#5976](/inmanta/web-console/pull/5976)
 Closed

[djskinner](/djskinner)
added a commit
to djskinner/cookie
that referenced
this pull request
[Oct 9, 2024](#ref-commit-1277bd4)
[![@djskinner](https://avatars.githubusercontent.com/u/2514172?s=40&u=8ffd131b64f4482c00bebd8d33f63e649a0544a4&v=4)](/djskinner)

`[Bump cookie dependency to ^0.7.1](/djskinner/cookie/commit/1277bd4b9f2b0f11b6da3a8136849a3f1621001e "Bump cookie dependency to ^0.7.1

To fix vulnerability https://github.com/jshttp/cookie/pull/167")`
‚Ä¶

`[1277bd4](/djskinner/cookie/commit/1277bd4b9f2b0f11b6da3a8136849a3f1621001e)`

```
To fix vulnerability [jshttp/cookie#167](https://github.com/jshttp/cookie/pull/167)
```

35 hidden items

Load more‚Ä¶

[![@k2xl](https://avatars.githubusercontent.com/u/965260?s=40&v=4)](/k2xl)
[k2xl](/k2xl)
mentioned this pull request
[Nov 1, 2024](#ref-pullrequest-2628336867)

[[Snyk] Upgrade cookie from 0.6.0 to 0.7.2
sspenst/thinky.gg#1196](/sspenst/thinky.gg/pull/1196)
 Merged

[![@NOUIY](https://avatars.githubusercontent.com/u/95175571?s=40&v=4)](/NOUIY)
[NOUIY](/NOUIY)
mentioned this pull request
[Nov 1, 2024](#ref-pullrequest-2629118137)

[[Snyk] Upgrade cookie from 0.5.0 to 0.7.2
NOUIY/next.js#2384](/NOUIY/next.js/pull/2384)
 Open

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Nov 1, 2024](#ref-pullrequest-2629416589)

[chore(deps): update dependency n8n to v1.65.2
uniget-org/tools#8110](/uniget-org/tools/pull/8110)
 Merged

1 task

[![@polishCarealKiller](https://avatars.githubusercontent.com/u/72090354?s=40&v=4)](/polishCarealKiller)
[polishCarealKiller](/polishCarealKiller)
mentioned this pull request
[Nov 3, 2024](#ref-pullrequest-2630978363)

[[Snyk] Upgrade cookie from 0.4.1 to 0.7.2
polishCarealKiller/Tau-Board#102](/polishCarealKiller/Tau-Board/pull/102)
 Open

[![@daeteck](https://avatars.githubusercontent.com/u/1268410?s=40&v=4)](/daeteck)
[daeteck](/daeteck)
mentioned this pull request
[Nov 5, 2024](#ref-issue-2636472873)

[cookie package dependency vulnerability that was fixed in version cookie@0.7.0 but socket.io use cookie@0.4.1
socketio/socket.io#5222](/socketio/socket.io/issues/5222)

Closed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Nov 6, 2024](#ref-pullrequest-2638635379)

[chore(deps): update dependency n8n to v1.66.0
uniget-org/tools#8217](/uniget-org/tools/pull/8217)
 Merged

1 task

[KnisterPeter](/KnisterPeter)
added a commit
to KnisterPeter/remix
that referenced
this pull request
[Nov 7, 2024](#ref-commit-92e9607)
[![@KnisterPeter](https://avatars.githubusercontent.com/u/327445?s=40&v=4)](/KnisterPeter)

`[chore(deps): update cookie library](/KnisterPeter/remix/commit/92e9607289f32213f49e25a418c7c53e5b80e2b5 "chore(deps): update cookie library

The version 0.6.0 of the `cookie` package has a security flaw
described here (https://github.com/jshttp/cookie/pull/167).

This PR does update the library to the closest fixed version.

Closes #10077")`
‚Ä¶

`[92e9607](/KnisterPeter/remix/commit/92e9607289f32213f49e25a418c7c53e5b80e2b5)`

```
The version 0.6.0 of the `cookie` package has a security flaw
described here ([jshttp/cookie#167](https://github.com/jshttp/cookie/pull/167)).

This PR does update the library to the closest fixed version.

Closes [remix-run#10077](https://github.com/remix-run/remix/issues/10077)
```

[![@KnisterPeter](https://avatars.githubusercontent.com/u/327445?s=40&v=4)](/KnisterPeter)
[KnisterPeter](/KnisterPeter)
mentioned this pull request
[Nov 7, 2024](#ref-pullrequest-2641345325)

[chore(server-runtime): update `cookie`
remix-run/remix#10198](/remix-run/remix/pull/10198)
 Closed

[KnisterPeter](/KnisterPeter)
added a commit
to KnisterPeter/remix
that referenced
this pull request
[Nov 7, 2024](#ref-commit-4c87028)
[![@KnisterPeter](https://avatars.githubusercontent.com/u/327445?s=40&v=4)](/KnisterPeter)

`[chore(deps): update cookie library](/KnisterPeter/remix/commit/4c87028da3e5691d2208f28eae41ef04bb279d92 "chore(deps): update cookie library

The version 0.6.0 of the `cookie` package has a security flaw
described here (https://github.com/jshttp/cookie/pull/167).

This PR does update the library to the closest fixed version.

Closes #10077")`
‚Ä¶

`[4c87028](/KnisterPeter/remix/commit/4c87028da3e5691d2208f28eae41ef04bb279d92)`

```
The version 0.6.0 of the `cookie` package has a security flaw
described here ([jshttp/cookie#167](https://github.com/jshttp/cookie/pull/167)).

This PR does update the library to the closest fixed version.

Closes [remix-run#10077](https://github.com/remix-run/remix/issues/10077)
```

[![@X-oss-byte](https://avatars.githubusercontent.com/u/136061549?s=40&v=4)](/X-oss-byte)
[X-oss-byte](/X-oss-byte)
mentioned this pull request
[Nov 8, 2024](#ref-pullrequest-2644199088)

[[Snyk] Upgrade cookie from 0.5.0 to 0.7.2
X-oss-byte/next-auth#131](/X-oss-byte/next-auth/pull/131)
 Open

[![@surajit03](https://avatars.githubusercontent.com/u/110833858?s=40&v=4)](/surajit03)
[surajit03](/surajit03)
mentioned this pull request
[Nov 12, 2024](#ref-pullrequest-2650926324)

[[Snyk] Upgrade cookie from 0.5.0 to 0.7.2
surajit03/accounting#249](/surajit03/accounting/pull/249)
 Open

[![@samueljochem](https://avatars.githubusercontent.com/u/79657472?s=40&v=4)](/samueljochem)
[samueljochem](/samueljochem)
mentioned this pull request
[Nov 12, 2024](#ref-pullrequest-2651039196)

[[Snyk] Upgrade cookie from 0.4.1 to 0.7.2
samueljochem/starter-express-api#31](/samueljochem/starter-express-api/pull/31)
 Open

[![@Cee-Jay-Err0r](https://avatars.githubusercontent.com/u/151012831?s=40&v=4)](/Cee-Jay-Err0r)
[Cee-Jay-Err0r](/Cee-Jay-Err0r)
mentioned this pull request
[Nov 12, 2024](#ref-pullrequest-2651162286)

[[Snyk] Upgrade cookie from 0.5.0 to 0.7.2
Cee-Jay-Err0r/KEITH-MD2#4](/Cee-Jay-Err0r/KEITH-MD2/pull/4)
 Open

This was referenced Nov 14, 2024

[chore(deps): update dependency n8n to v1.67.1
uniget-org/tools#8413](/uniget-org/tools/pull/8413)
 Merged

[express4.17.3
tadashi0713/docker-scout-demo#8](/tadashi0713/docker-scout-demo/pull/8)
 Closed

[Medium severity - Cross-site Scripting (XSS) vulnerability in cookie (package.json)
jordaniac89/juice-shop#242](/jordaniac89/juice-shop/issues/242)

Open

[chore(deps): update dependency n8n to v1.68.0
uniget-org/tools#8558](/uniget-org/tools/pull/8558)
 Merged

[![@DiFuks](https://avatars.githubusercontent.com/u/12777199?s=40&v=4)](/DiFuks)
[DiFuks](/DiFuks)
mentioned this pull request
[Nov 26, 2024](#ref-issue-2694511185)

[A vulnerability has been discovered in the cookie library
single-spa/import-map-overrides#124](/single-spa/import-map-overrides/issues/124)

Open

This was referenced Nov 26, 2024

[chore(deps): update dependency n8n to v1.68.1
uniget-org/tools#8661](/uniget-org/tools/pull/8661)
 Merged

[chore(deps): update dependency n8n to v1.69.2
uniget-org/tools#8694](/uniget-org/tools/pull/8694)
 Merged

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Dec 4, 2024](#ref-pullrequest-2718283604)

[chore(deps): update dependency n8n to v1.70.2
uniget-org/tools#8830](/uniget-org/tools/pull/8830)
 Merged

1 task

[![@shoumikhin](https://avatars.githubusercontent.com/u/426434?s=40&v=4)](/shoumikhin)
[shoumikhin](/shoumikhin)
mentioned this pull request
[Dec 5, 2024](#ref-pullrequest-2710834844)

[Feat/Add a React Native LLaMA demo app for iOS
pytorch/executorch#7134](/pytorch/executorch/pull/7134)
 Merged

[![@ollylowe](https://avatars.githubusercontent.com/u/99962958?s=40&v=4)](/ollylowe)
[ollylowe](/ollylowe)
mentioned this pull request
[Dec 5, 2024](#ref-issue-2585523115)

[Unable to setCookie, when name starting with "/"
bendotcodes/cookies#704](/bendotcodes/cookies/issues/704)

Open

This was referenced Dec 6, 2024

[chore(deps): update dependency n8n to v1.70.3
uniget-org/tools#8870](/uniget-org/tools/pull/8870)
 Merged

[chore(deps): update dependency n8n to v1.70.4
uniget-org/tools#8955](/uniget-org/tools/pull/8955)
 Merged

[chore(deps): update dependency n8n to v1.71.2
uniget-org/tools#8997](/uniget-org/tools/pull/8997)
 Merged

[chore(deps): update dependency n8n to v1.71.3
uniget-org/tools#9022](/uniget-org/tools/pull/9022)
 Merged

[![@jeremiahjordanisaacson](https://avatars.githubusercontent.com/u/777517?s=40&v=4)](/jeremiahjordanisaacson)
[jeremiahjordanisaacson](/jeremiahjordanisaacson)
mentioned this pull request
[Dec 16, 2024](#ref-issue-2743542320)

[Bug Fix Needed - react-scripts@5.0.1 requires cookie@0.6.0 via a transitive dependency on express@4.21.0
NuevoFoundation/nuevofoundation-web#314](/NuevoFoundation/nuevofoundation-web/issues/314)

Closed

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Dec 19, 2024](#ref-pullrequest-2750885203)

[chore(deps): update dependency n8n to v1.72.1
uniget-org/tools#9197](/uniget-org/tools/pull/9197)
 Merged

1 task

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Jan 10, 2025](#ref-pullrequest-2779100411)

[chore(deps): update dependency n8n to v1.73.1
uniget-org/tools#9501](/uniget-org/tools/pull/9501)
 Merged

1 task

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fjshttp%2Fcookie%2Fpull%2F167)

Reviewers

[![@IamLizu](https://avatars.githubusercontent.com/u/26184316?s=40&v=4)](/IamLizu) [IamLizu](/IamLizu)

IamLizu left review comments

[![@wesleytodd](https://avatars.githubusercontent.com/u/1027776?s=40&v=4)](/wesleytodd) [wesleytodd](/wesleytodd)

wesleytodd approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [incorrect validation regexes in serialize](https://github.com/jshttp/cookie/issues/165)

4 participants

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=52&v=4)](/bewinsnw) [![@wesleytodd](https://avatars.githubusercontent.com/u/1027776?s=52&v=4)](/wesleytodd) [![@IamLizu](https://avatars.githubusercontent.com/u/26184316?s=52&v=4)](/IamLizu) [![@blakeembrey](https://avatars.githubusercontent.com/u/1088987?s=52&v=4)](/blakeembrey)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_5da16f1f_20250110_162608.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjshttp%2Fcookie%2Fcommit%2Fe10042845354fea83bd8f34af72475eed1dadf5c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjshttp%2Fcookie%2Fcommit%2Fe10042845354fea83bd8f34af72475eed1dadf5c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jshttp%2Fcookie)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jshttp](/jshttp)
/
**[cookie](/jshttp/cookie)**
Public

* [Notifications](/login?return_to=%2Fjshttp%2Fcookie) You must be signed in to change notification settings
* [Fork
  161](/login?return_to=%2Fjshttp%2Fcookie)
* [Star
   1.4k](/login?return_to=%2Fjshttp%2Fcookie)

* [Code](/jshttp/cookie)
* [Issues
  3](/jshttp/cookie/issues)
* [Pull requests
  6](/jshttp/cookie/pulls)
* [Actions](/jshttp/cookie/actions)
* [Security](/jshttp/cookie/security)
* [Insights](/jshttp/cookie/pulse)

Additional navigation options

* [Code](/jshttp/cookie)
* [Issues](/jshttp/cookie/issues)
* [Pull requests](/jshttp/cookie/pulls)
* [Actions](/jshttp/cookie/actions)
* [Security](/jshttp/cookie/security)
* [Insights](/jshttp/cookie/pulse)

## Commit

[Permalink](/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: narrow the validation of cookies to match RFC6265 ([#167](https://github.com/jshttp/cookie/pull/167))

[Browse files](/jshttp/cookie/tree/e10042845354fea83bd8f34af72475eed1dadf5c)
Browse the repository at this point in the history

* Loading branch information

[![@bewinsnw](https://avatars.githubusercontent.com/u/119598239?s=40&v=4)](/bewinsnw)

[bewinsnw](/jshttp/cookie/commits?author=bewinsnw "View all commits by bewinsnw")
authored
Oct 1, 2024

1 parent
[26031e3](/jshttp/cookie/commit/26031e362d8473112b24a76c7c03b45ef7576d61)

commit e100428

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**59 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* index.js
  [index.js](#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346)
* test

  + test/serialize.js
    [serialize.js](#diff-8842dc6dead869e0d7f0fae9f002c861f5e8366173abbbec2744e48b3caba539)

## There are no files selected for viewing

64 changes: 55 additions & 9 deletions

64
[index.js](#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346 "index.js")

Show comments

[View file](/jshttp/cookie/blob/e10042845354fea83bd8f34af72475eed1dadf5c/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,14 +23,60 @@ exports.serialize = serialize; |
|  |  | var \_\_toString = Object.prototype.toString |
|  |  |  |
|  |  | /\*\* |
|  |  | \* RegExp to match field-content in RFC 7230 sec 3.2 |
|  |  | \* RegExp to match cookie-name in RFC 6265 sec 4.1.1 |
|  |  | \* This refers out to the obsoleted definition of token in RFC 2616 sec 2.2 |
|  |  | \* which has been replaced by the token definition in RFC 7230 appendix B. |
|  |  | \* |
|  |  | \* field-content = field-vchar [ 1\*( SP / HTAB ) field-vchar ] |
|  |  | \* field-vchar = VCHAR / obs-text |
|  |  | \* obs-text = %x80-FF |
|  |  | \* cookie-name = token |
|  |  | \* token = 1\*tchar |
|  |  | \* tchar = "!" / "#" / "$" / "%" / "&" / "'" / |
|  |  | \* "\*" / "+" / "-" / "." / "^" / "\_" / |
|  |  | \* "`" / "|" / "~" / DIGIT / ALPHA |
|  |  | \*/ |
|  |  |  |
|  |  | var fieldContentRegExp = /^[\u0009\u0020-\u007e\u0080-\u00ff]+$/; |
|  |  | var cookieNameRegExp = /^[!#$%&'\*+\-.^\_`|~0-9A-Za-z]+$/; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* RegExp to match cookie-value in RFC 6265 sec 4.1.1 |
|  |  | \* |
|  |  | \* cookie-value = \*cookie-octet / ( DQUOTE \*cookie-octet DQUOTE ) |
|  |  | \* cookie-octet = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E |
|  |  | \* ; US-ASCII characters excluding CTLs, |
|  |  | \* ; whitespace DQUOTE, comma, semicolon, |
|  |  | \* ; and backslash |
|  |  | \*/ |
|  |  |  |
|  |  | var cookieValueRegExp = /^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]\*\1$/; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* RegExp to match domain-value in RFC 6265 sec 4.1.1 |
|  |  | \* |
|  |  | \* domain-value = <subdomain> |
|  |  | \* ; defined in [RFC1034], Section 3.5, as |
|  |  | \* ; enhanced by [RFC1123], Section 2.1 |
|  |  | \* <subdomain> = <label> | <subdomain> "." <label> |
|  |  | \* <label> = <let-dig> [ [ <ldh-str> ] <let-dig> ] |
|  |  | \* Labels must be 63 characters or less. |
|  |  | \* 'let-dig' not 'letter' in the first char, per RFC1123 |
|  |  | \* <ldh-str> = <let-dig-hyp> | <let-dig-hyp> <ldh-str> |
|  |  | \* <let-dig-hyp> = <let-dig> | "-" |
|  |  | \* <let-dig> = <letter> | <digit> |
|  |  | \* <letter> = any one of the 52 alphabetic characters A through Z in |
|  |  | \* upper case and a through z in lower case |
|  |  | \* <digit> = any one of the ten digits 0 through 9 |
|  |  | \*/ |
|  |  |  |
|  |  | var domainValueRegExp = /^([a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)\*$/i; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* RegExp to match path-value in RFC 6265 sec 4.1.1 |
|  |  | \* |
|  |  | \* path-value = <any CHAR except CTLs or ";"> |
|  |  | \* CHAR = %x01-7F |
|  |  | \* ; defined in RFC 5234 appendix B.1 |
|  |  | \*/ |
|  |  |  |
|  |  | var pathValueRegExp = /^[\u0020-\u003A\u003D-\u007E]\*$/; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Parse a cookie header. |
| Expand Down  Expand Up | | @@ -116,13 +162,13 @@ function serialize(name, val, options) { |
|  |  | throw new TypeError('option encode is invalid'); |
|  |  | } |
|  |  |  |
|  |  | if (!fieldContentRegExp.test(name)) { |
|  |  | if (!cookieNameRegExp.test(name)) { |
|  |  | throw new TypeError('argument name is invalid'); |
|  |  | } |
|  |  |  |
|  |  | var value = enc(val); |
|  |  |  |
|  |  | if (value && !fieldContentRegExp.test(value)) { |
|  |  | if (value && !cookieValueRegExp.test(value)) { |
|  |  | throw new TypeError('argument val is invalid'); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -139,15 +185,15 @@ function serialize(name, val, options) { |
|  |  | } |
|  |  |  |
|  |  | if (opt.domain) { |
|  |  | if (!fieldContentRegExp.test(opt.domain)) { |
|  |  | if (!domainValueRegExp.test(opt.domain)) { |
|  |  | throw new TypeError('option domain is invalid'); |
|  |  | } |
|  |  |  |
|  |  | str += '; Domain=' + opt.domain; |
|  |  | } |
|  |  |  |
|  |  | if (opt.path) { |
|  |  | if (!fieldContentRegExp.test(opt.path)) { |
|  |  | if (!pathValueRegExp.test(opt.path)) { |
|  |  | throw new TypeError('option path is invalid'); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[test/serialize.js](#diff-8842dc6dead869e0d7f0fae9f002c861f5e8366173abbbec2744e48b3caba539 "test/serialize.js")

Show comments

[View file](/jshttp/cookie/blob/e10042845354fea83bd8f34af72475eed1dadf5c/test/serialize.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,6 +20,7 @@ describe('cookie.serialize(name, value)', function () { |
|  |  | it('should throw for invalid name', function () { |
|  |  | assert.throws(cookie.serialize.bind(cookie, 'foo\n', 'bar'), /argument name is invalid/) |
|  |  | assert.throws(cookie.serialize.bind(cookie, 'foo\u280a', 'bar'), /argument name is invalid/) |
|  |  | assert.throws(cookie.serialize.bind(cookie, 'foo bar', 'bar'), /argument name is invalid/) |
|  |  | }) |
|  |  | }) |
|  |  |  |
| Expand Down  Expand Up | | @@ -52,6 +53,9 @@ describe('cookie.serialize(name, value, options)', function () { |
|  |  | assert.throws(cookie.serialize.bind(cookie, 'foo', '+ \n', { |
|  |  | encode: function (v) { return v } |
|  |  | }), /argument val is invalid/) |
|  |  | assert.throws(cookie.serialize.bind(cookie, 'foo', 'foo bar', { |
|  |  | encode: function (v) { return v } |
|  |  | }), /argument val is invalid/) |
|  |  | }) |
|  |  | }) |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e100428`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjshttp%2Fcookie%2Fcommit%2Fe10042845354fea83bd8f34af72475eed1dadf5c) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


