- **Root cause of vulnerability:** Missing limit for accepted NTS-KE connections. When ntpd-rs is configured as an NTS server, it accepts TCP connections for the NTS-KE service. If the process has reached the file descriptor limit and tries to accept a new TCP connection, the accept() system call will return with the EMFILE error, causing ntpd-rs to abort.
- **Weaknesses/vulnerabilities present:** Resource exhaustion due to unlimited accepted NTS-KE connections. Specifically, the vulnerability is categorized as CWE-770: Allocation of Resources Without Limits or Throttling.
- **Impact of exploitation:** The ntpd-rs daemon can be made completely unavailable by crashing the service. If ntpd-rs is automatically restarted, an attacker can repeat the attack to prevent it from functioning properly. This affects only NTS-KE server configurations.
- **Attack vectors:** A remote attacker can open a large number of parallel TCP connections to the server to exhaust file descriptors and trigger a crash.
- **Required attacker capabilities/position:** The attacker needs to be able to send network traffic to the affected ntpd-rs server and open multiple TCP connections quickly enough to avoid the `key-exchange-timeout-ms` timeout. No authentication or user interaction is required.