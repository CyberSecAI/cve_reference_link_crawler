- **Root cause of vulnerability:** The `passport-wsfed-saml2` library fails to properly validate signatures on WS-Federation (WSFed) assertions.
- **Weaknesses/vulnerabilities present:** The vulnerability lies in the insufficient signature verification of WSFed tokens, allowing an attacker to bypass authentication by presenting a crafted, signed WSFed assertion.
- **Impact of exploitation:** A remote attacker can bypass WSFed authentication on a website that uses the vulnerable `passport-wsfed-saml2` library. Depending on the Identity Provider (IDP) implementation, this can potentially lead to unauthenticated access by forging signed messages, even without having a valid user account.
- **Attack vectors:** The attacker needs to obtain a signed WSFed assertion from an IDP. The exact mechanism to obtain this assertion can vary depending on the IDP used.
- **Required attacker capabilities/position:** The attacker needs to be able to intercept and modify or craft a WSFed authentication request/response and provide their own signed assertion. They do not need to have valid user credentials at the relying party application (or the IDP if a forged message can be crafted).